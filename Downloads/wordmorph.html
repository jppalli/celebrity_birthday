<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MORPHEUS - Word Transformation Puzzle</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #1a2a6c);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: white;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            width: 100%;
            max-width: 700px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 8px;
            text-shadow: 0 0 12px rgba(255, 255, 255, 0.6);
            letter-spacing: 3px;
            background: linear-gradient(to right, #ffd700, #ff8c00, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes titleGlow {
            0% { text-shadow: 0 0 8px rgba(255, 215, 0, 0.5); }
            100% { text-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
            line-height: 1.5;
            max-width: 600px;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 600px;
            margin-bottom: 20px;
            gap: 15px;
        }
        
        .level-indicator {
            font-size: 1.2rem;
            font-weight: bold;
            padding: 10px 20px;
            background: rgba(255, 215, 0, 0.25);
            border-radius: 25px;
            border: 1px solid rgba(255, 215, 0, 0.4);
            flex: 1;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .score-display {
            font-size: 1.2rem;
            font-weight: bold;
            padding: 10px 20px;
            background: rgba(33, 150, 243, 0.25);
            border-radius: 25px;
            border: 1px solid rgba(33, 150, 243, 0.4);
            flex: 1;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 600px;
            gap: 20px;
        }
        
        .game-info {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            text-align: center;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        .word-pair {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .word-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 1.8rem;
            font-weight: bold;
            letter-spacing: 3px;
            min-width: 150px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .word-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        .arrow {
            font-size: 2.2rem;
            opacity: 0.8;
            animation: pulse 1.5s infinite;
        }
        
        .grid-container {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        .attempt-counter {
            margin-bottom: 20px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
            justify-content: center;
        }
        
        .counter-dots {
            display: flex;
            gap: 8px;
        }
        
        .counter-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .counter-dot.active {
            background: #4CAF50;
            transform: scale(1.3);
            box-shadow: 0 0 8px rgba(76, 175, 80, 0.7);
        }
        
        .grid {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
            width: 100%;
            justify-content: center;
        }
        
        .row {
            display: flex;
            gap: 8px;
            justify-content: center;
        }
        
        .cell {
            width: 50px;
            height: 50px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.7rem;
            font-weight: bold;
            background: rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            text-transform: uppercase;
            cursor: pointer;
        }
        
        .row:nth-child(1) .cell {
            background: rgba(106, 170, 100, 0.3);
            border-color: rgba(106, 170, 100, 0.5);
        }
        
        .cell.filled {
            border-color: rgba(255, 255, 255, 0.8);
            transform: scale(1.05);
        }
        
        .cell.valid {
            background: #2196F3;
            border-color: #1976D2;
            animation: pulse 1s ease;
        }
        
        .cell.correct {
            background: #4CAF50;
            border-color: #388E3C;
            animation: blink 0.5s ease 3, celebrate 0.8s ease;
        }
        
        .cell.incorrect {
            background: #f44336;
            border-color: #d32f2f;
            animation: shake 0.5s;
        }
        
        .cell.hint-letter {
            background: #FFC107;
            border-color: #FFA000;
            animation: pulse 1s infinite;
        }
        
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.3; }
            100% { opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        @keyframes celebrate {
            0% { transform: translateY(0); }
            25% { transform: translateY(-15px); }
            50% { transform: translateY(0); }
            75% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }
        
        .keyboard {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 100%;
            max-width: 550px;
            margin-top: 15px;
        }
        
        .keyboard-row {
            display: flex;
            justify-content: center;
            gap: 6px;
        }
        
        .key {
            height: 45px;
            min-width: 35px;
            padding: 0 12px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.15);
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.25);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            font-size: 1rem;
        }
        
        .key:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }
        
        .key:active {
            transform: scale(0.95);
        }
        
        .key.enter, .key.delete {
            min-width: 60px;
            background: rgba(33, 150, 243, 0.4);
            font-size: 0.9rem;
        }
        
        .key.hint {
            background: rgba(255, 193, 7, 0.4);
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 20px;
            width: 100%;
            justify-content: center;
        }
        
        .btn {
            padding: 12px 20px;
            border-radius: 8px;
            border: none;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 150px;
        }
        
        .btn i {
            font-size: 1.1rem;
        }
        
        .btn.submit {
            background: linear-gradient(to right, #4CAF50, #2E7D32);
            color: white;
        }
        
        .btn.reset {
            background: linear-gradient(to right, #f44336, #c62828);
            color: white;
        }
        
        .btn.level {
            background: linear-gradient(to right, #2196F3, #1565C0);
            color: white;
        }
        
        .btn.hint {
            background: linear-gradient(to right, #FFC107, #FF9800);
            color: #1a2a6c;
        }
        
        .instructions {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            margin-top: 20px;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        .instructions h2 {
            margin-bottom: 15px;
            text-align: center;
            color: #FFD700;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .instructions ul {
            padding-left: 25px;
            margin-bottom: 20px;
        }
        
        .instructions li {
            margin-bottom: 10px;
            line-height: 1.5;
            font-size: 1rem;
        }
        
        .instructions li strong {
            color: #FFD700;
        }
        
        .example {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 1rem;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .win-message {
            font-size: 1.5rem;
            font-weight: bold;
            color: #FFD700;
            margin: 20px 0;
            text-align: center;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            animation: pulse 1.5s infinite;
        }
        
        .hint-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            margin: 15px 0 0;
            text-align: center;
            font-size: 1.1rem;
            display: none;
            animation: fadeIn 0.5s ease;
            border: 1px solid rgba(255, 193, 7, 0.4);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .hint-title {
            font-weight: bold;
            color: #FFC107;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .hint-text {
            line-height: 1.5;
        }
        
        @keyframes shake {
            0% { transform: translateX(0); }
            20% { transform: translateX(-8px); }
            40% { transform: translateX(8px); }
            60% { transform: translateX(-8px); }
            80% { transform: translateX(8px); }
            100% { transform: translateX(0); }
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #f00;
            border-radius: 50%;
            animation: confetti-fall 5s ease-in-out forwards;
        }
        
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #2E7D32);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        /* Mobile-specific styles */
        @media (max-width: 600px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .game-header {
                flex-direction: column;
            }
            
            .word-box {
                font-size: 1.5rem;
                min-width: 120px;
                padding: 12px 18px;
            }
            
            .cell {
                width: 42px;
                height: 42px;
                font-size: 1.5rem;
            }
            
            .key {
                height: 40px;
                min-width: 30px;
                font-size: 0.9rem;
                padding: 0 8px;
            }
            
            .key.enter, .key.delete {
                min-width: 50px;
                font-size: 0.8rem;
            }
            
            .btn {
                padding: 10px 16px;
                font-size: 0.9rem;
                min-width: 130px;
            }
            
            .instructions {
                padding: 15px;
            }
        }
        
        @media (max-width: 400px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .word-box {
                font-size: 1.3rem;
                min-width: 100px;
                padding: 10px 15px;
            }
            
            .cell {
                width: 36px;
                height: 36px;
                font-size: 1.3rem;
            }
            
            .key {
                height: 36px;
                min-width: 26px;
                font-size: 0.85rem;
                padding: 0 6px;
            }
            
            .key.enter, .key.delete {
                min-width: 45px;
                font-size: 0.75rem;
            }
            
            .btn {
                padding: 8px 12px;
                font-size: 0.8rem;
                min-width: 120px;
            }
            
            .controls {
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-sync-alt"></i> MORPHEUS</h1>
        <div class="subtitle">Transform words step by step. Change one letter at a time to morph the start word into the target word!</div>
    </header>
    
    <div class="game-header">
        <div class="level-indicator">Level <span id="level-number">1</span> of 10</div>
        <div class="score-display">Score: <span id="score">0</span></div>
    </div>
    
    <div class="game-container">
        <div class="game-info">
            <div class="word-pair">
                <div class="word-box" id="start-word">COLD</div>
                <div class="arrow">➔</div>
                <div class="word-box" id="target-word">WARM</div>
            </div>
            
            <div class="hint-panel" id="hint-panel">
                <div class="hint-title">Hint:</div>
                <div class="hint-text" id="hint-text"></div>
            </div>
        </div>
        
        <div class="grid-container">
            <div class="attempt-counter">
                <span>Steps:</span>
                <div class="counter-dots" id="counter-dots">
                    <div class="counter-dot"></div>
                    <div class="counter-dot"></div>
                    <div class="counter-dot"></div>
                    <div class="counter-dot"></div>
                    <div class="counter-dot"></div>
                    <div class="counter-dot"></div>
                </div>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
            </div>
            
            <div class="grid" id="game-grid">
                <!-- Game grid will be generated by JavaScript -->
            </div>
            
            <div class="keyboard" id="keyboard">
                <!-- Keyboard will be generated by JavaScript -->
            </div>
            
            <div class="controls">
                <button class="btn submit" id="submit-btn"><i class="fas fa-paper-plane"></i> SUBMIT</button>
                <button class="btn reset" id="reset-btn"><i class="fas fa-redo"></i> RESET</button>
                <button class="btn hint" id="letter-hint-btn"><i class="fas fa-lightbulb"></i> LETTER HINT</button>
                <button class="btn hint" id="word-hint-btn"><i class="fas fa-book"></i> WORD HINT</button>
                <button class="btn level" id="level-btn"><i class="fas fa-arrow-right"></i> NEXT</button>
            </div>
        </div>
        
        <div class="instructions">
            <h2><i class="fas fa-graduation-cap"></i> How to Play</h2>
            <ul>
                <li><strong>Goal:</strong> Transform the start word into the target word in the fewest steps possible</li>
                <li><strong>Rules:</strong> Change one letter per step to form a valid word</li>
                <li><strong>Strategy:</strong> Plan your transformations carefully - each step must be a real word</li>
                <li><strong>Hints:</strong> Use hints when stuck - they show which letter to change or the meaning of next word</li>
                <li><strong>Scoring:</strong> Earn points for each level completed - more points for fewer steps!</li>
            </ul>
            
            <div class="example">
                <div>Level: <span id="level-name">COLD to WARM</span></div>
                <div>Optimal: <span id="optimal-steps">5</span> steps</div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Game levels
            const levels = [
                {
                    level: 1,
                    start: 'COLD',
                    target: 'WARM',
                    optimal: 5,
                    validWords: ['COLD', 'CORD', 'CARD', 'WARD', 'WARP', 'WARM'],
                    definitions: {
                        'COLD': 'Low temperature',
                        'CORD': 'Thin flexible string or rope',
                        'CARD': 'Piece of stiff paper with information',
                        'WARD': 'A separate room in a hospital',
                        'WARP': 'Become bent or twisted out of shape',
                        'WARM': 'Having or giving out moderate heat'
                    }
                },
                {
                    level: 2,
                    start: 'FISH',
                    target: 'DUCK',
                    optimal: 4,
                    validWords: ['FISH', 'DISH', 'DISK', 'DUSK', 'DUCK'],
                    definitions: {
                        'FISH': 'Aquatic animal with gills and fins',
                        'DISH': 'Shallow container for cooking or serving food',
                        'DISK': 'Thin, flat, circular object',
                        'DUSK': 'Darker stage of twilight',
                        'DUCK': 'Waterbird with a broad bill'
                    }
                },
                {
                    level: 3,
                    start: 'MOON',
                    target: 'STAR',
                    optimal: 5,
                    validWords: ['MOON', 'MOAN', 'ROAN', 'ROAR', 'SOAR', 'STAR'],
                    definitions: {
                        'MOON': 'Earth\'s natural satellite',
                        'MOAN': 'Long, low sound of pain or despair',
                        'ROAN': 'Horse with a coat of mixed colors',
                        'ROAR': 'Full, deep, prolonged cry of a lion',
                        'SOAR': 'Fly or rise high in the air',
                        'STAR': 'Luminous point in the night sky'
                    }
                },
                {
                    level: 4,
                    start: 'LOVE',
                    target: 'HATE',
                    optimal: 3,
                    validWords: ['LOVE', 'LAVE', 'LATE', 'HATE'],
                    definitions: {
                        'LOVE': 'Strong affection for another',
                        'LAVE': 'Wash or bathe something',
                        'LATE': 'Doing something after the expected time',
                        'HATE': 'Intense or passionate dislike'
                    }
                },
                {
                    level: 5,
                    start: 'FIRE',
                    target: 'SNOW',
                    optimal: 6,
                    validWords: ['FIRE', 'SIRE', 'SORE', 'SORT', 'SOOT', 'SNOT', 'SNOW'],
                    definitions: {
                        'FIRE': 'Burning with flames and heat',
                        'SIRE': 'Formal address for a king',
                        'SORE': 'Painful or aching',
                        'SORT': 'Category of things sharing characteristics',
                        'SOOT': 'Black powder in smoke',
                        'SNOT': 'Mucus from the nose',
                        'SNOW': 'Atmospheric water vapor frozen into ice crystals'
                    }
                },
                {
                    level: 6,
                    start: 'EAST',
                    target: 'WEST',
                    optimal: 3,
                    validWords: ['EAST', 'PAST', 'PEST', 'WEST'],
                    definitions: {
                        'EAST': 'Direction where the sun rises',
                        'PAST': 'Gone by in time',
                        'PEST': 'Destructive insect or animal',
                        'WEST': 'Direction where the sun sets'
                    }
                },
                {
                    level: 7,
                    start: 'CAKE',
                    target: 'TART',
                    optimal: 3,
                    validWords: ['CAKE', 'CARE', 'TARE', 'TART'],
                    definitions: {
                        'CAKE': 'Sweet baked dessert',
                        'CARE': 'Provide for the needs of someone',
                        'TARE': 'Empty weight of a container',
                        'TART': 'Open pastry case with sweet filling'
                    }
                },
                {
                    level: 8,
                    start: 'LOST',
                    target: 'FIND',
                    optimal: 5,
                    validWords: ['LOST', 'LEST', 'LENT', 'LEND', 'FEND', 'FIND'],
                    definitions: {
                        'LOST': 'Unable to find one\'s way',
                        'LEST': 'To avoid the risk of',
                        'LENT': 'Past tense of lend',
                        'LEND': 'Grant temporary use of something',
                        'FEND': 'Look after and provide for oneself',
                        'FIND': 'Discover something by chance'
                    }
                },
                {
                    level: 9,
                    start: 'DARK',
                    target: 'DAWN',
                    optimal: 3,
                    validWords: ['DARK', 'DARE', 'DARN', 'DAWN'],
                    definitions: {
                        'DARK': 'Absence of light',
                        'DARE': 'Have the courage to do something',
                        'DARN': 'Mend a hole in knitted material',
                        'DAWN': 'First appearance of light in the morning'
                    }
                },
                {
                    level: 10,
                    start: 'HATE',
                    target: 'LOVE',
                    optimal: 3,
                    validWords: ['HATE', 'LATE', 'LAVE', 'LOVE'],
                    definitions: {
                        'HATE': 'Intense or passionate dislike',
                        'LATE': 'Doing something after the expected time',
                        'LAVE': 'Wash or bathe something',
                        'LOVE': 'Strong affection for another'
                    }
                }
            ];
            
            // Game state
            let currentLevel = 0;
            let gameState = {
                currentAttempt: 1,
                currentRow: 1,
                currentCell: 0,
                gameWon: false,
                gameOver: false,
                grid: [],
                score: 0
            };
            
            // DOM elements
            const gameGrid = document.getElementById('game-grid');
            const keyboardContainer = document.getElementById('keyboard');
            const submitBtn = document.getElementById('submit-btn');
            const resetBtn = document.getElementById('reset-btn');
            const levelBtn = document.getElementById('level-btn');
            const startWord = document.getElementById('start-word');
            const targetWord = document.getElementById('target-word');
            const levelNumber = document.getElementById('level-number');
            const levelName = document.getElementById('level-name');
            const optimalSteps = document.getElementById('optimal-steps');
            const counterDotsContainer = document.getElementById('counter-dots');
            const hintPanel = document.getElementById('hint-panel');
            const hintText = document.getElementById('hint-text');
            const letterHintBtn = document.getElementById('letter-hint-btn');
            const wordHintBtn = document.getElementById('word-hint-btn');
            const scoreDisplay = document.getElementById('score');
            const progressFill = document.getElementById('progress-fill');
            
            // Initialize the game
            function initGame() {
                // Load saved progress
                const savedProgress = localStorage.getItem('morpheusProgress');
                if (savedProgress) {
                    const progress = JSON.parse(savedProgress);
                    currentLevel = progress.level || 0;
                    gameState.score = progress.score || 0;
                }
                
                scoreDisplay.textContent = gameState.score;
                loadLevel(currentLevel);
            }
            
            // Load level data
            function loadLevel(levelIndex) {
                currentLevel = levelIndex;
                const level = levels[levelIndex];
                gameState = {
                    currentAttempt: 1,
                    currentRow: 1,
                    currentCell: 0,
                    gameWon: false,
                    gameOver: false,
                    grid: Array(level.optimal + 2).fill().map(() => Array(level.start.length).fill('')),
                    score: gameState.score
                };
                
                // Set start word in grid
                for (let i = 0; i < level.start.length; i++) {
                    gameState.grid[0][i] = level.start[i];
                }
                
                // Update UI
                startWord.textContent = level.start;
                targetWord.textContent = level.target;
                levelNumber.textContent = levelIndex + 1;
                levelName.textContent = `${level.start} to ${level.target}`;
                optimalSteps.textContent = level.optimal;
                progressFill.style.width = '0%';
                
                // Reset buttons
                levelBtn.style.display = 'none';
                levelBtn.textContent = 'NEXT LEVEL';
                hintPanel.style.display = 'none';
                
                // Reset controls
                const controls = document.querySelector('.controls');
                controls.innerHTML = '';
                controls.appendChild(submitBtn);
                controls.appendChild(resetBtn);
                controls.appendChild(letterHintBtn);
                controls.appendChild(wordHintBtn);
                controls.appendChild(levelBtn);
                
                // Recreate grid and keyboard
                createGrid();
                createKeyboard();
                createCounterDots();
                renderGrid();
            }
            
            // Create counter dots
            function createCounterDots() {
                counterDotsContainer.innerHTML = '';
                const maxAttempts = levels[currentLevel].optimal + 2;
                
                for (let i = 0; i < maxAttempts; i++) {
                    const dot = document.createElement('div');
                    dot.className = 'counter-dot';
                    if (i < gameState.currentAttempt) {
                        dot.classList.add('active');
                    }
                    counterDotsContainer.appendChild(dot);
                }
            }
            
            // Create game grid
            function createGrid() {
                gameGrid.innerHTML = '';
                const wordLength = levels[currentLevel].start.length;
                const maxRows = levels[currentLevel].optimal + 2;
                
                for (let row = 0; row < maxRows; row++) {
                    const rowEl = document.createElement('div');
                    rowEl.className = 'row';
                    
                    for (let col = 0; col < wordLength; col++) {
                        const cell = document.createElement('div');
                        cell.className = 'cell';
                        cell.dataset.row = row;
                        cell.dataset.col = col;
                        
                        if (row === 0) {
                            cell.textContent = levels[currentLevel].start[col];
                            cell.classList.add('filled');
                        }
                        
                        rowEl.appendChild(cell);
                    }
                    
                    gameGrid.appendChild(rowEl);
                }
            }
            
            // Create virtual keyboard
            function createKeyboard() {
                const keyboardRows = [
                    ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],
                    ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],
                    ['Z', 'X', 'C', 'V', 'B', 'N', 'M', 'DELETE', 'ENTER']
                ];
                
                keyboardContainer.innerHTML = '';
                
                keyboardRows.forEach(row => {
                    const rowEl = document.createElement('div');
                    rowEl.className = 'keyboard-row';
                    
                    row.forEach(key => {
                        const keyEl = document.createElement('div');
                        keyEl.className = 'key';
                        
                        if (key === 'ENTER' || key === 'DELETE') {
                            keyEl.classList.add(key.toLowerCase());
                            keyEl.innerHTML = key === 'ENTER' ? '<i class="fas fa-arrow-right"></i>' : '<i class="fas fa-backspace"></i>';
                        } else {
                            keyEl.textContent = key;
                        }
                        
                        keyEl.addEventListener('click', () => handleKeyPress(key));
                        rowEl.appendChild(keyEl);
                    });
                    
                    keyboardContainer.appendChild(rowEl);
                });
            }
            
            // Handle keyboard input
            function handleKeyPress(key) {
                if (gameState.gameWon || gameState.gameOver) return;
                
                if (key === 'DELETE') {
                    deleteLetter();
                } else if (key === 'ENTER') {
                    submitAttempt();
                } else if (gameState.currentCell < levels[currentLevel].start.length) {
                    addLetter(key);
                }
            }
            
            // Add letter to grid
            function addLetter(letter) {
                const row = gameState.currentRow;
                const col = gameState.currentCell;
                
                gameState.grid[row][col] = letter;
                gameState.currentCell++;
                
                renderGrid();
            }
            
            // Delete last letter
            function deleteLetter() {
                if (gameState.currentCell > 0) {
                    gameState.currentCell--;
                    gameState.grid[gameState.currentRow][gameState.currentCell] = '';
                    
                    renderGrid();
                }
            }
            
            // Submit current attempt
            function submitAttempt() {
                if (gameState.currentCell !== levels[currentLevel].start.length) {
                    shakeRow();
                    return;
                }
                
                const currentWord = gameState.grid[gameState.currentRow].join('');
                const prevWord = gameState.grid[gameState.currentRow - 1].join('');
                
                // Validate the word
                if (!isValidWord(currentWord)) {
                    markRowInvalid();
                    return;
                }
                
                // Mark the word as valid (intermediate step)
                markRowValid();
                
                // Check if we've reached the target
                if (currentWord === levels[currentLevel].target) {
                    gameState.gameWon = true;
                    
                    // Add blinking effect to winning row
                    const rowEls = document.querySelectorAll(`.row:nth-child(${gameState.currentRow + 1}) .cell`);
                    rowEls.forEach(cell => cell.classList.add('correct', 'blink'));
                    
                    // Calculate and update score
                    const levelScore = Math.max(100, 300 - (gameState.currentAttempt * 20));
                    gameState.score += levelScore;
                    scoreDisplay.textContent = gameState.score;
                    
                    // Save progress
                    saveProgress();
                    
                    // Show win message
                    setTimeout(() => {
                        showWinMessage(levelScore);
                        createConfetti();
                    }, 1500);
                    
                    return;
                }
                
                // Move to next row
                gameState.currentAttempt++;
                gameState.currentRow++;
                gameState.currentCell = 0;
                updateCounter();
                
                // Update progress bar
                const progress = (gameState.currentAttempt / (levels[currentLevel].optimal + 2)) * 100;
                progressFill.style.width = `${progress}%`;
                
                // Check if out of attempts
                if (gameState.currentAttempt > levels[currentLevel].optimal + 1) {
                    gameState.gameOver = true;
                    showGameOver();
                }
            }
            
            // Create confetti effect
            function createConfetti() {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
                const container = document.querySelector('.grid-container');
                
                for (let i = 0; i < 100; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = `${Math.random() * 100}%`;
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
                    container.appendChild(confetti);
                    
                    setTimeout(() => {
                        confetti.remove();
                    }, 5000);
                }
            }
            
            // Validate word
            function isValidWord(word) {
                const level = levels[currentLevel];
                
                // Check word is in our valid words list
                if (!level.validWords.includes(word)) return false;
                
                // Check exactly one letter changed from previous word
                const prevWord = gameState.grid[gameState.currentRow - 1].join('');
                let diffCount = 0;
                
                for (let i = 0; i < word.length; i++) {
                    if (word[i] !== prevWord[i]) diffCount++;
                }
                
                return diffCount === 1;
            }
            
            // Mark row as invalid
            function markRowInvalid() {
                const rowEls = document.querySelectorAll(`.row:nth-child(${gameState.currentRow + 1}) .cell`);
                
                rowEls.forEach(cell => {
                    cell.classList.add('incorrect');
                    setTimeout(() => {
                        cell.classList.remove('incorrect');
                    }, 1000);
                });
                
                shakeRow();
            }
            
            // Mark row as valid (intermediate step)
            function markRowValid() {
                const rowEls = document.querySelectorAll(`.row:nth-child(${gameState.currentRow + 1}) .cell`);
                rowEls.forEach(cell => cell.classList.add('valid'));
            }
            
            // Shake row animation
            function shakeRow() {
                const rowEl = document.querySelector(`.row:nth-child(${gameState.currentRow + 1})`);
                rowEl.style.animation = 'shake 0.5s';
                
                setTimeout(() => {
                    rowEl.style.animation = '';
                }, 500);
            }
            
            // Update attempt counter
            function updateCounter() {
                const dots = document.querySelectorAll('.counter-dot');
                dots.forEach((dot, index) => {
                    if (index < gameState.currentAttempt) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                });
            }
            
            // Show win message
            function showWinMessage(score) {
                const message = document.createElement('div');
                message.className = 'win-message';
                message.innerHTML = `
                    <i class="fas fa-trophy"></i> Level Complete! 
                    <div>Solved in ${gameState.currentAttempt} steps!</div>
                    <div>+${score} points!</div>
                `;
                
                // Show next level button
                levelBtn.style.display = 'block';
                levelBtn.innerHTML = currentLevel < levels.length - 1 ? 
                    '<i class="fas fa-arrow-right"></i> NEXT LEVEL' : 
                    '<i class="fas fa-redo"></i> PLAY AGAIN';
                
                const container = document.querySelector('.controls');
                container.innerHTML = '';
                container.appendChild(message);
                container.appendChild(levelBtn);
            }
            
            // Show game over message
            function showGameOver() {
                const message = document.createElement('div');
                message.className = 'win-message';
                message.innerHTML = `
                    <i class="fas fa-times-circle"></i> Game Over!
                    <div>Solution: ${levels[currentLevel].start} → ${getSolutionPath().join(' → ')}</div>
                `;
                
                const container = document.querySelector('.controls');
                container.innerHTML = '';
                container.appendChild(message);
                container.appendChild(resetBtn);
                container.appendChild(levelBtn);
                levelBtn.textContent = 'TRY AGAIN';
                levelBtn.style.display = 'block';
            }
            
            // Get solution path for current level
            function getSolutionPath() {
                switch (currentLevel) {
                    case 0: return ['COLD', 'CORD', 'CARD', 'WARD', 'WARM'];
                    case 1: return ['FISH', 'DISH', 'DISK', 'DUSK', 'DUCK'];
                    case 2: return ['MOON', 'MOAN', 'ROAN', 'ROAR', 'SOAR', 'STAR'];
                    case 3: return ['LOVE', 'LAVE', 'LATE', 'HATE'];
                    case 4: return ['FIRE', 'SIRE', 'SORE', 'SORT', 'SOOT', 'SNOT', 'SNOW'];
                    case 5: return ['EAST', 'PAST', 'PEST', 'WEST'];
                    case 6: return ['CAKE', 'CARE', 'TARE', 'TART'];
                    case 7: return ['LOST', 'LEST', 'LENT', 'LEND', 'FEND', 'FIND'];
                    case 8: return ['DARK', 'DARE', 'DARN', 'DAWN'];
                    case 9: return ['HATE', 'LATE', 'LAVE', 'LOVE'];
                    default: return [levels[currentLevel].start, levels[currentLevel].target];
                }
            }
            
            // Show letter hint
            function showLetterHint() {
                const solution = getSolutionPath();
                const currentWord = solution[gameState.currentRow - 1];
                const nextWord = solution[gameState.currentRow];
                
                if (!nextWord) return;
                
                // Find which letter needs to be changed
                let changeIndex = -1;
                for (let i = 0; i < currentWord.length; i++) {
                    if (currentWord[i] !== nextWord[i]) {
                        changeIndex = i;
                        break;
                    }
                }
                
                if (changeIndex === -1) return;
                
                // Highlight the letter that needs to be changed
                const rowEls = document.querySelectorAll(`.row:nth-child(${gameState.currentRow + 1}) .cell`);
                if (rowEls[changeIndex]) {
                    rowEls[changeIndex].classList.add('hint-letter');
                    
                    // Remove highlight after a delay
                    setTimeout(() => {
                        rowEls[changeIndex].classList.remove('hint-letter');
                    }, 2000);
                }
                
                // Show hint message
                hintText.textContent = `Change the ${changeIndex + 1}${getOrdinalSuffix(changeIndex + 1)} letter to "${nextWord[changeIndex]}"`;
                hintPanel.style.display = 'block';
                
                // Auto-hide after 3 seconds
                setTimeout(() => {
                    hintPanel.style.display = 'none';
                }, 3000);
                
                // Deduct points for using hint
                gameState.score = Math.max(0, gameState.score - 10);
                scoreDisplay.textContent = gameState.score;
            }
            
            // Helper function for ordinal numbers
            function getOrdinalSuffix(number) {
                if (number > 3 && number < 21) return 'th';
                switch (number % 10) {
                    case 1: return 'st';
                    case 2: return 'nd';
                    case 3: return 'rd';
                    default: return 'th';
                }
            }
            
            // Show word meaning hint
            function showWordMeaningHint() {
                const solution = getSolutionPath();
                const nextWord = solution[gameState.currentRow];
                
                if (!nextWord) return;
                
                const level = levels[currentLevel];
                const definition = level.definitions[nextWord] || 'No definition available';
                
                hintText.textContent = `Next word: ${definition}`;
                hintPanel.style.display = 'block';
                
                // Auto-hide after 4 seconds
                setTimeout(() => {
                    hintPanel.style.display = 'none';
                }, 4000);
                
                // Deduct points for using hint
                gameState.score = Math.max(0, gameState.score - 15);
                scoreDisplay.textContent = gameState.score;
            }
            
            // Render grid based on game state
            function renderGrid() {
                const cells = document.querySelectorAll('.cell');
                
                cells.forEach(cell => {
                    const row = parseInt(cell.dataset.row);
                    const col = parseInt(cell.dataset.col);
                    
                    // Set cell content
                    cell.textContent = gameState.grid[row][col] || '';
                    
                    // Reset classes
                    cell.className = 'cell';
                    
                    // Add filled class if not empty
                    if (gameState.grid[row][col] && row > 0) {
                        cell.classList.add('filled');
                    }
                    
                    // First row styling
                    if (row === 0) {
                        cell.classList.add('filled');
                    }
                });
            }
            
            // Save game progress
            function saveProgress() {
                const progress = {
                    level: currentLevel,
                    score: gameState.score
                };
                localStorage.setItem('morpheusProgress', JSON.stringify(progress));
            }
            
            // Event listeners
            submitBtn.addEventListener('click', submitAttempt);
            resetBtn.addEventListener('click', () => {
                gameState.score = Math.max(0, gameState.score - 30);
                scoreDisplay.textContent = gameState.score;
                loadLevel(currentLevel);
            });
            levelBtn.addEventListener('click', () => {
                if (currentLevel < levels.length - 1) {
                    loadLevel(currentLevel + 1);
                } else {
                    // Reset to first level
                    currentLevel = 0;
                    loadLevel(0);
                }
            });
            
            // Hint event listeners
            letterHintBtn.addEventListener('click', showLetterHint);
            wordHintBtn.addEventListener('click', showWordMeaningHint);
            
            // Keyboard event listener
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    submitAttempt();
                } else if (e.key === 'Backspace') {
                    deleteLetter();
                } else if (e.key.length === 1 && e.key.match(/[a-z]/i)) {
                    handleKeyPress(e.key.toUpperCase());
                }
            });
            
            // Initialize the game
            initGame();
        });
    </script>
</body>
</html>