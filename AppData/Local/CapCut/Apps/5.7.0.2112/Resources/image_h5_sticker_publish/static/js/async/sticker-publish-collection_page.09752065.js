"use strict";(self.webpackChunkartist_op_web=self.webpackChunkartist_op_web||[]).push([[843],{42983:(e,t,i)=>{i.d(t,{Ab:()=>r});let r=function(e){return e[e.WordArt=1]="WordArt",e[e.Sticker=2]="Sticker",e[e.AudioEffect=3]="AudioEffect",e[e.Video=4]="Video",e[e.Music=5]="Music",e[e.TextTemplate=6]="TextTemplate",e[e.Special=7]="Special",e[e.FaceSpecial=8]="FaceSpecial",e[e.Image=9]="Image",e[e.Font=10]="Font",e[e.Timbre=11]="Timbre",e[e.Filter=12]="Filter",e[e.VideoAnimation=13]="VideoAnimation",e[e.Transition=19]="Transition",e[e.SubtitleTemplate=48]="SubtitleTemplate",e[e.Formula=50]="Formula",e[e.WordArtCollection=101]="WordArtCollection",e[e.StickerCollection=102]="StickerCollection",e[e.AudioEffectCollection=103]="AudioEffectCollection",e[e.VideoCollection=104]="VideoCollection",e[e.Emoticons=105]="Emoticons",e[e.TextTemplateCollection=106]="TextTemplateCollection",e[e.FilterCollection=112]="FilterCollection",e[e.MultiLanguageTextTemplate=207]="MultiLanguageTextTemplate",e[e.LocalEffects=-1]="LocalEffects",e}({})},69836:(e,t,i)=>{i.d(t,{Bo:()=>h,LU:()=>v,ir:()=>f});var r=i(50959),o=i(84875),s=i.n(o),l=i(45599),a=i(96426),n=i(85083),c=i(88623),d=i(82346),p=i(84997),m=i(40699),u=i(96305),g=i(11527);const _=e=>{const{className:t,loadingText:i}=e,{t:r}=(0,l.$)(),{handleMouseEnter:o}=(0,p.S)();return(0,g.jsxs)("div",{className:s()(u.Z.root,t),children:[(0,g.jsx)(d.a,{className:u.Z.icon,size:12,arcColor:"var(--grey-1)"}),(0,g.jsx)("div",{className:u.Z.text,onMouseEnter:o,children:i||r("pc_stickers_release_in_web")})]})},S=e=>{const{className:t,tooltip:i}=e,{t:o}=(0,l.$)(),{handleMouseEnter:n}=(0,p.w)({content:i,className:u.Z.tooltip}),c=(0,r.useRef)(null),{setIsMarqueeLoopRunning:d,reactNode:_}=(0,m.J)({text:o("pc_stickers_release_invalid_web"),gap:16,getEllipsisDOM:()=>c.current});return(0,g.jsxs)("div",{className:s()(u.Z.root,t,u.Z.error),onMouseEnter:e=>{d(!0),n(e)},onMouseLeave:()=>d(!1),children:[(0,g.jsx)(a.r,{className:u.Z.icon}),(0,g.jsx)("div",{ref:c,className:u.Z.text,children:_})]})},h=e=>{const{className:t,text:i}=e,{handleMouseEnter:r}=(0,p.S)();return(0,g.jsxs)("div",{className:s()(u.Z.root,t,u.Z.checked),children:[(0,g.jsx)(c.r,{className:u.Z.icon}),(0,g.jsx)("div",{className:u.Z.text,onMouseEnter:r,children:i})]})},v=e=>{const{className:t}=e,{t:i}=(0,l.$)(),{handleMouseEnter:r}=(0,p.S)();return(0,g.jsxs)("div",{className:s()(u.Z.root,t),children:[(0,g.jsx)("div",{className:s()(u.Z.icon,u.Z.yellowIcon),children:(0,g.jsx)("div",{className:u.Z.yellowPoint})}),(0,g.jsx)("div",{className:u.Z.text,onMouseEnter:r,children:i("pc_stickers_release_editing_web")}),(0,g.jsx)(n.r,{className:u.Z.icon})]})},f=e=>{const{className:t,loading:i,invalid:r,errorToolip:o,isInfoComplete:s,title:l,loadingText:a}=e;return i?(0,g.jsx)(_,{className:t,loadingText:a}):r?(0,g.jsx)(S,{className:t,tooltip:o}):s?(0,g.jsx)(h,{className:t,text:l}):(0,g.jsx)(v,{className:t})}},67078:(e,t,i)=>{i.d(t,{$X:()=>s,pn:()=>o});var r=i(94435);function o({isVip:e,isBusiness:t,authFiles:i}){var o;const s=null!==(o=null==i?void 0:i.map((({uri:e})=>({uri:e}))))&&void 0!==o?o:[];return{root:{is_vip:!1,copyright:{copyright_info:[{scene:r.$x.Vip,auth_status:e?r.U9.Authorized:r.U9.Unauthorized,third_party_agreements:[]},{scene:r.$x.Business,auth_status:t?r.U9.Authorized:r.U9.Unauthorized,third_party_agreements:t?s:[]}]}},commonData:{is_business:!1,is_original:Boolean(e||t)}}}function s(e,t){return Boolean(null==e?void 0:e.copyright_info.some((e=>e.scene===t&&e.auth_status===r.U9.Authorized)))}},9679:(e,t,i)=>{i.d(t,{$v:()=>d,Ad:()=>m,DV:()=>n,Sj:()=>c,_4:()=>u,ce:()=>p,iL:()=>l,j2:()=>a});var r=i(17095);function o(e){return void 0===e?e:String(Math.round(e/1024))}function s(e){const{material_category:t,material_type:i,collection_detail:r}=e;return{material_category:t,material_type:i,...r&&"collection"===i&&{collection_detail:r}}}function l(e){const{action:t,extra:i={},material_cnt:o}=e;(0,r.g)({eventName:"personal_page_material_publish_page_action",params:{action:t,material_cnt:o,...s(e),...i}})}function a(e){const{error_report:t,upload_status:i,time:l,isCompressed:a,sizeBeforeCompress:n,sizeAfterCompress:c,resolutionBeforeCompress:d,resolutionAfterCompress:p,extra:m={}}=e;(0,r.g)({eventName:"personal_page_material_upload_status",params:{...s(e),error_report:t,upload_status:i,time:l,is_compressed:a?1:0,...a&&{material_size_before_compress:o(n),material_size_after_compress:o(c),material_resolution_before_compress:d,material_resolution_after_compress:p},...m}})}function n(e){const{error_report:t}=e;(0,r.g)({eventName:"personal_page_material_import_error_report",params:{...s(e),error_report:t}})}function c(e){if(0===e.length)return;const t=function(e){const t={};return e.forEach((e=>{Object.entries(e).forEach((([e,i])=>{const r=i||"";t[e]=t[e]?`${t[e]},${r}`:r}))})),t}(e),i=new Set(t.material_type.split(","));1===i.size&&(t.material_type=i.values().next().value),(0,r.g)({eventName:"personal_page_material_publish_error_report",params:t})}function d(e){const{status:t,material_type:i,material_category:s,title:l,description:a,isOriginal:n,tags:c,material_format:d,material_size:p,resolution:m,error_type:u,cover_type:g,time:_,extra:S={},authorize_range:h,isVipAuthorized:v,isBusinessAuthorized:f,is_official_task:k,task_id:C,material_id:x,material_subcategory:b,effect_type_title:I,effect_type_id:y}=e;return(0,r.g)({eventName:"personal_page_material_publish_status",params:{status:t,material_type:i,material_category:s,material_title:l,material_introduction:a,is_original:n?"1":"0",hashtag:c.join(","),material_format:d,material_size:o(p),resolution:m,authorize_range:h,is_official_task:k,task_id:C,material_id:x,material_subcategory:b,effect_type_title:I,effect_type_id:y,..."fail"===t&&{error_type:u},cover_type:g,time:_,is_subscription_authorized:v?1:0,is_commercial_authorized:f?1:0,...S}})}function p(e){const{action:t,material_category:i,material_type:o,entry_from:s}=e;return(0,r.g)({eventName:"ugc_material_subscription_original_statment",params:{action:t,material_category:i,material_type:o,entry_from:s}})}function m(e){const{action:t,material_category:i,material_type:o,entry_from:s,hasCopyrightAuthorization:l}=e;return(0,r.g)({eventName:"ugc_material_commercial_original_statment",params:{action:t,material_category:i,material_type:o,entry_from:s,..."boolean"==typeof l&&{has_copyright_authorization:l?"1":"0"}}})}function u(e){const{action:t,page_type:i,material_category:o,material_type:s,button_name:l}=e;return(0,r.g)({eventName:"ugc_material_creator_sign_agreement",params:{action:t,page_type:i,material_category:o,material_type:s,...l&&{button_name:l}}})}},5014:(e,t,i)=>{i.d(t,{BI:()=>h,DefaultImportStickerFileRequest:()=>n,Em:()=>p,GR:()=>g,J:()=>d,N7:()=>l,Q0:()=>a,R8:()=>o,S8:()=>_,Us:()=>S,fD:()=>s,mr:()=>c,qb:()=>u,r$:()=>m});var r=i(73224);let o=function(e){return e.Static="static",e.GIF="gif",e.Sequence="sequence",e}({}),s=function(e){return e.Format="format",e.MinImageSize="minImageSize",e.RecommendFileSize="RecommendFileSize",e.SequenceNumber="SequenceNumber",e}({});const l={fps:16,loop:!0},a={maxCount:49,minCount:2,minImageSize:360,maxImageSize:1080,maxFileSize:20971520},n={accept:".png,.jpg,.jpeg,.gif",multiple:!0,enableImportSequence:!0,thumbnailSize:200,minImageSize:360,maxImageSize:800,maxFileSize:20971520},c={fps:16,loop:!0,gen_size:0,gif_gen_opts:[{bg_color:"#242424",width:200,height:200,padding:0},{bg_color:"",width:0,height:0,padding:0}]},d={accept:".png,.gif",minImageSize:320,maxImageSize:1e3,maxFileSize:20971520},p={accept:".png,.gif",minImageSize:320,maxImageSize:1250,maxFileSize:5242880},m=20,u=80,g=4,_=40,S=52,h={[o.Static]:{[s.Format]:r.I18n.t("pc_stickers_release_format_web"),[s.MinImageSize]:r.I18n.t("pc_stickers_release_size_min_web"),[s.RecommendFileSize]:r.I18n.t("pc_stickers_release_recommend_web")},[o.GIF]:{[s.Format]:r.I18n.t("pc_stickers_release_format_gif_web"),[s.MinImageSize]:r.I18n.t("pc_stickers_release_size_min_web"),[s.RecommendFileSize]:r.I18n.t("pc_stickers_release_recommend_web")},[o.Sequence]:{[s.Format]:r.I18n.t("pc_stickers_release_png_groups_web_web"),[s.MinImageSize]:r.I18n.t("pc_stickers_release_reccomend_size_web"),[s.SequenceNumber]:r.I18n.t("pc_stickers_release_amount_web"),[s.RecommendFileSize]:r.I18n.t("pc_stickers_release_recommend_web")}}},76252:(e,t,i)=>{i.d(t,{B3:()=>g,Nf:()=>_,WQ:()=>h,w3:()=>S});var r=i(23073),o=i(50959),s=i(61022),l=i(42983),a=i(25807),n=i(5014),c=i(86439),d=i(97311),p=i(67078),m=i(94435),u=i(11304);function g(e){return e.coverSrc||e.firstFrameCoverSrc}function _(e){return e.isSequence&&Boolean(e.isSequenceSettingsUpdating||e.firstFrameCoverSrc&&!e.coverSrc&&!e.isUploadFailed)}function S(e){return e.isSequence||"gif"===(0,d.lm)(e.path)}function h(e){const t=(0,s.fv)((()=>({stickers:[],scrollAreaRef:(0,o.createRef)(),materialPostConfig:new u.E(l.Ab.Sticker),get hasStickers(){return this.stickers.length>0},selectedId:null,get selectedSticker(){return t.selectedId?t.getSticker(t.selectedId):null},setScrollAreaRef(e){t.scrollAreaRef=e},addStickers(e){t.stickers.push(...e)},getSticker:e=>{var i;return null!==(i=t.stickers.find((t=>t.id===e)))&&void 0!==i?i:null},selectSticker(e){t.selectedId=e,t.selectedSticker&&(t.selectedSticker.hasEverSelected=!0)},updateThumbnailSrc(e,t){e.isSequence?e.firstFrameCoverSrc=t:e.coverSrc=t},updateUploadedData(e,t,i){if(e.uri=t,!e.isSequence)return e.coverUri=t,void(e.largeImageUri=t);if(i){const{gifCover:t,gifLargeImage:r,stickerPackage:o}=i;e.coverUri=t.uri,e.coverSrc=t.blobUrl,e.largeImageUri=r.uri,e.stickerPackage=o,e.isSequenceSettingsUpdating=!1}},updateUnmetRequirements(e,t){e.unmetRequirements=t,e.hasCheckedRequirements=!0},setUploadFailed(e){e.isUploadFailed=!0,e.isSequenceSettingsUpdating=!1},get isAllStickersThumbnailReady(){return t.stickers.length>0&&t.stickers.every((e=>g(e)))},applyForTags:e=>{t.stickers.forEach((t=>{t.formState.tags=e}))},applyAuthSettingsToAll:({isOriginal:e,isBusiness:i,isVip:r})=>{t.stickers.forEach((t=>{t.formState.isOriginal=Boolean(e),t.formState.isBusiness=Boolean(i),t.formState.isVip=Boolean(r)}))},applyPublishDirectionToAll:({postChannel:e,targetedActivityId:i})=>{t.stickers.forEach((t=>{t.formState.postChannel=e,t.formState.targetedActivityId=i}))},makeInitFormState:e=>({title:"",tags:[],isOriginal:!1,isBusiness:!1,isVip:!1,...n.N7,sequenceSettingsApplyToAll:!1,...e}),updateFormState(e,t){Object.assign(e.formState,t)},makeInitSticker(i){const{title:r,isInfoComplete:o,formState:s,path:l="",isSequence:p=!1,...u}=i,g=function(e,t){const i=(0,d.lm)(e);if(t)return n.R8.Sequence;if("gif"===i)return n.R8.GIF;if(["png","jpg","jpeg"].includes(i))return n.R8.Static;throw new Error(`Unsupported suffix ${i}`)}(l,p),_=function(e,t){const i=e.split(/[\\/]/g).pop(),r=t?i:i.replace(/\.\w+?$/g,"");return(0,c.aF)(r,n.S8)}(l,p),S=a.$.isEnableAuthorization,{mustPaidAuth:h}=this.materialPostConfig.authConfig;return{id:"",path:l,get title(){return this.formState.title},fileType:g,width:0,height:0,isSequence:p,firstFrameCoverSrc:"",coverSrc:"",uri:"",coverUri:"",largeImageUri:"",stickerPackage:{uri:"",md5:"",size:0},sequenceSettings:{fps:0,loop:!1,...i.isSequence&&n.N7},hasEverSelected:!1,get isInfoComplete(){const{postChannel:t,targetedActivityId:i}=this.formState;{const o="single"===e,s="single"===e,l=t===m.iu.Open||t===m.iu.Targeted&&Boolean(i);return Boolean(this.title&&this.formState.tags.length>0)&&(r=this.formState.isVip,h&&r||!h||!o)&&(l||!s)}var r},unmetRequirements:[],hasCheckedRequirements:!1,isUploadFailed:!1,isSequenceSettingsUpdating:!1,formState:t.makeInitFormState({title:_,isVip:S}),...u}},reimportSticker(e,i){const r=t.stickers.findIndex((t=>t.id===e));-1!==r&&(t.stickers[r]=i)},startToRetryUploadStickers(e){e.forEach((e=>{const i=t.getSticker(e);i&&(i.isUploadFailed=!1)}))},startToUpdateSequenceSettings(e,t){e.forEach((e=>{e.sequenceSettings=t,e.largeImageUri&&(e.largeImageUri="",e.coverUri="",e.stickerPackage={uri:"",md5:"",size:0},e.isSequenceSettingsUpdating=!0)}))},removeSticker(e){t.stickers=t.stickers.filter((t=>t.id!==e.id))},dragInsert(e,i){const r=t.stickers.splice(e,1),o=e>i?i+1:i;t.stickers.splice(o,0,...r)},get isReadyToPublish(){return t.stickers.every((e=>e.hasCheckedRequirements&&0===e.unmetRequirements.length&&e.isInfoComplete))},get uploadStats(){let e=0,i=0,r=0;return t.stickers.forEach((t=>{if(t.isUploadFailed)return void(i+=1);(t.isSequence?t.largeImageUri:t.uri)?e+=1:r+=1})),{pending:r,succeeded:e,failed:i}},collectLogData:()=>t.stickers.map((e=>({...(0,r.Z)(e,["id","isSequence","isInfoComplete","hasEverSelected","isUploadFailed","uri"]),...e.isSequence&&{isSequenceUpdating:e.isSequenceSettingsUpdating,largeImageUri:e.largeImageUri,...e.sequenceSettings}}))),makePublishItemList:(e={})=>t.stickers.map((t=>{var i;const{id:r,isSequence:o,formState:s,stickerPackage:a}=t,{is_vip:n=Boolean(s.isVip),is_business:c=s.isBusiness,is_original:d=s.isOriginal,postChannel:u=s.postChannel,targetedActivityId:g=s.targetedActivityId,sourceForSimple:_=m.r0.UserPostPc,sourceForSequence:h=m.r0.UserPostPcSequence,authFileUploadServiceManager:v,onResult:f}=e,k=o?h:_,C=(0,p.pn)({isVip:n,isBusiness:c,authFiles:null!==(i=null==v?void 0:v.getUploadedFiles(r))&&void 0!==i?i:[]});return{id:r,req:{effect_type:l.Ab.Sticker,is_vip:n,...C.root,common_data:{title:s.title,description:s.title,icon:{image_uri:t.coverUri},sdk_version:"1.0.0",source:k,tags:[...s.tags],is_original:d,is_business:c,...C.commonData,...o&&{file:{file_uri:a.uri,file_md5:a.md5,size:a.size}},post_channel:u===m.iu.Targeted?`${m.iu.Targeted}_${g}`:u,web_extra:JSON.stringify({targeted_id:g})},sticker:{large_image:{image_uri:t.largeImageUri},sticker_type:S(t)?m.Ic.Dynamic:m.Ic.Static,no_multi_sticker:!1,package_size:0}},onResult:e=>null==f?void 0:f(t,e)}}))})));return t}},13031:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Vt});var r=i(23479),o=i(45599),s=(i(52915),i(68166)),l=i(12390),a=i(67100),n=i(84875),c=i.n(n),d=i(2237),p=i(69836),m=i(84997);const u="root-W9YKLd",g="selected-MfKVC9",_="cover-Sg1bSx",S="icon-NjGS_M",h="textInfo-zYCck9",v="title-PHGLK_",f="description-W4AGHI",k="statusBar-wU3FIA",C="checkedStatusBar-YMzSep";var x=i(11527);const b=({className:e,selected:t,coverSrc:i,title:r,description:s,isInfoComplete:l,onClick:a})=>{const{t:n}=(0,o.$)(),{handleMouseEnter:b}=(0,m.S)();return(0,x.jsxs)("div",{className:c()(e,u,t&&g),onClick:a,children:[(0,x.jsx)("div",{className:_,children:i?(0,x.jsx)("img",{className:S,src:i}):(0,x.jsx)(d.t,{className:S,iconWidth:28})}),(0,x.jsxs)("div",{className:h,children:[(0,x.jsx)("div",{className:v,onMouseEnter:b,children:r||n("pc_stickers_release_group_name_web")}),(0,x.jsx)("div",{className:f,onMouseEnter:b,children:s||n("pc_stickers_release_details_recommend_web")})]}),l?(0,x.jsx)(p.Bo,{className:C,text:n("pc_stickers_release_finish_fill_web")}):(0,x.jsx)(p.LU,{className:k})]})};var I=i(23073),y=i(50959),w=i(84736),F=i(66589),N=i(61022),U=i(73224),j=i(42983),A=i(25807),E=i(18635),q=i(50666),P=i(97662),L=i(76252),T=i(5014),z=i(97311),R=i(74575),M=i(1946),O=i(54847),$=i(60251),B=i(67927),V=i(59787),Z=i(82665),D=i(50279),W=i(8129),X=i(2555),G=i(94435);function J(e){return Boolean(e.id)}class H{constructor(){(0,V.Z)(this,"itemMap",new Map)}getPublishInfo(e){return this.itemMap.get(e)}async batchPublish(e){const t=[];for(const i of(0,Z.Z)(e,10)){const e=await Promise.all(i.map((e=>this.publish(e))));t.push(...e)}return t}async publish(e){var t;const{id:i,onResult:r,onUpdateResult:o}=e,s=JSON.parse(JSON.stringify(e.req));let l=this.itemMap.get(i);if(null!==(t=l)&&void 0!==t&&t.promise&&(0,D.Z)(l.req,s))try{return await l.promise}catch(a){(0,W.c6)("[MaterialPublishService] publish failed, start to retry",{id:i})}return l={promise:null,id:i,req:s,onResult:r,onUpdateResult:o},this.itemMap.set(i,l),l.promise=this.publishImpl(l),l.promise}getErrorText(e){return e?e.message||JSON.stringify(e):""}async publishImpl(e){const t=performance.now(),i=async(i,r)=>{try{const l={error:i,errorText:this.getErrorText(i),time:Math.round(performance.now()-t),resourceId:r};var o,s;if(J(e.req))await(null===(o=e.onUpdateResult)||void 0===o?void 0:o.call(e,{req:e.req,...l}));else await(null===(s=e.onResult)||void 0===s?void 0:s.call(e,{req:e.req,...l}))}catch(l){(0,W.RF)("[MaterialPublishService] callOnResult failed",l)}};let r;try{r=await this.postOrUpdate(e)}catch(o){throw e.promise=null,i(o,""),o}return await i(null,r.resource_id),r}async postOrUpdate(e){return J(e.req)?(await(0,G.Y$)(e.req),{resource_id:e.req.id,source:1}):(0,G.TT)(e.req)}async pollUntilAllInEffectList(e){try{await Promise.race([this.pollUntilAllInEffectListImpl(e),(new X.B).timeout(5e3)])}catch(t){(0,W.RF)("[MaterialPublishService] pollUntilAllInEffectList failed",t)}}async pollUntilAllInEffectListImpl({ids:e,types:t}){const i=performance.now(),r=new X.B,o={count:50,effect_types:t,uid:A.$.userInfo.uid,cursor:0};for(;performance.now()-i<5e3;){const t=await(0,G.Js)(o).catch((()=>null));if(null!=t&&t.effect_item_list){const i=new Set(t.effect_item_list.map((e=>e.common_attr.id)));if(e.every((e=>i.has(e))))return}await r.timeout(500)}}}var Y=i(49737),Q=i(24399),K=i(79668),ee=i(57609),te=i(2514),ie=i(67078),re=i(539),oe=i(46309),se=i(3718),le=i(51654),ae=i(18370);const ne="ImportSticker";function ce(e){return{title:"",description:"",tags:[],isOriginal:!1,isBusiness:!1,isVip:!1,...T.N7,sequenceSettingsApplyToAll:!1,...e}}function de(){const e=(0,L.WQ)("collection"),t=(0,P.WQ)({stickerListStore:e}),i=new Y.YL({itemType:j.Ab.StickerCollection}),r=(0,re.G)({watch:()=>s.isAllUploaded}),o=new $.l,s=(0,N.fv)((()=>({formApi:null,setFormApi:e=>{s.formApi=e},mainFormLayoutAfterLoading:"uploadArea",get mainFormLayout(){return t.isImportLoading?"loading":"uploadArea"===s.mainFormLayoutAfterLoading&&O.appModel.isInitFailed?"error":s.mainFormLayoutAfterLoading},get isImportDisabled(){return e.stickers.length>=T.qb},stickerListStore:e,importLoadingStore:t,importServ:new E.T({api:new q.r,stickerListStore:e,sendLogServ:i,needSaveSequenceGifUrl:!0}),pubServ:new H,sendLogServ:i,authorSignService:new ee.I({signScene:se.d.BusinessArtist}),authFileUploadServiceManager:new te.r({}),performanceTimingCollector:(0,ae.uY)(),getImportMinMaxCount(){const t=e.stickers.length;return{minCount:1,maxCount:Math.max(0,T.qb-t),maxTotalCount:T.qb}},getHasImportedType(){const{stickers:t}=e;return 0===t.length?"":t.every(L.w3)?"dynamic":"static"},getStaticDynamicMixParams:()=>({needCheckStaticDynamicMix:!0,hasImportedType:s.getHasImportedType()}),openStickerFilePicker:()=>o.lock(ne,(async()=>{i.sendUploadActionLog(s),await s.importServ.uploadConfigService.refreshUploadConfigsIfNeeded({logPrefix:"[CollectionStore]",when:"openStickerFilePicker"});const e=await s.importServ.openStickerFilePicker({...s.getImportMinMaxCount(),...s.getStaticDynamicMixParams()});s.addNewStickers(e)})),uploadDroppedStickerFiles:()=>o.lock(ne,(async()=>{i.sendUploadActionLog(s),await s.importServ.uploadConfigService.refreshUploadConfigsIfNeeded({logPrefix:"[CollectionStore]",when:"uploadDroppedStickerFiles"});const e=await s.importServ.uploadDroppedStickerFiles({...s.getImportMinMaxCount(),...s.getStaticDynamicMixParams()});s.addNewStickers(e)})),reimportSticker:t=>o.lock(ne,(async()=>{await s.importServ.uploadConfigService.refreshUploadConfigsIfNeeded({logPrefix:"[CollectionStore]",when:"reimportSticker"});const i=await s.importServ.reimportSticker(t,s.getStaticDynamicMixParams());if(i){const t=e.getSticker(i);s.selectSticker(t)}})),addNewStickers(i){if(0!==i.length)if(e.addStickers(i),"uploadArea"===s.mainFormLayoutAfterLoading){s.selectCollectionCoverCard(),t.showImportLoading(),s.mainFormLayoutAfterLoading="mainForm",s.startCheckGenerateCollectionCover();const e=A.$.isEnableAuthorization;s.collection.formState.isVip=e}else{const t=e.getSticker(i[0].id);s.selectSticker(t)}},collection:{id:(0,M.V)("sticker-collection"),cover:{id:"",url:"",uri:"",needImport:!0,isUploadFailed:!1},exampleImages:[],get title(){return this.formState.title},get description(){return this.formState.description},hasEverSelected:!1,get isInfoComplete(){{const{postChannel:t,targetedActivityId:i}=this.formState,r=t===G.iu.Open||t===G.iu.Targeted&&Boolean(i);return Boolean(this.cover.id&&this.title&&this.formState.tags.length>0)&&(t=>{const{mustPaidAuth:i}=e.materialPostConfig.authConfig;return i&&t||!i})(this.formState.isVip)&&r}},formState:ce({})},isCollectionCoverCardSelected:!0,get field(){return{canOriginal:!0,canBusiness:!1,canVip:!1,canIconBlank:A.$.permissions.includes(A.v.EffectIconBlank),canHighPro:A.$.permissions.includes(A.v.EffectHighPrio),canPackOne:A.$.permissions.includes(A.v.StickerOnePackage),canFpsSetting:e.stickers.some((e=>e.isSequence))}},get permissions(){return A.$.permissions},selectSticker(t){s.isCollectionCoverCardSelected&&(s.isCollectionCoverCardSelected=!1,s.saveCollectionFormState()),s.saveSingleFormState(),e.selectSticker(t.id)},selectCollectionCoverCard(){s.saveSingleFormState(),e.selectSticker(null),s.isCollectionCoverCardSelected=!0,s.collection.hasEverSelected=!0},initCollectionFields(){var e,t;null===(e=s.formApi)||void 0===e||e.reset(),null===(t=s.formApi)||void 0===t||t.setValues({collection:s.collection.formState})},updateCollectionFormState(e){Object.assign(s.collection.formState,e)},saveCollectionFormState(){var e;s.updateCollectionFormState(ce({...null===(e=s.formApi)||void 0===e?void 0:e.getValue("collection")}))},initSingleFields(e){var t,i;null===(t=s.formApi)||void 0===t||t.reset(),null===(i=s.formApi)||void 0===i||i.setValues({single:{...e.formState,...e.sequenceSettings}})},saveSingleFormState(){var t;const{selectedSticker:i}=e;if(!i)return;const r=e.makeInitFormState({...null===(t=s.formApi)||void 0===t?void 0:t.getValue("single"),...i.sequenceSettings,sequenceSettingsApplyToAll:!1});e.updateFormState(i,r)},saveSequenceSettingsForSingle(){var t;const r=e.makeInitFormState({...null===(t=s.formApi)||void 0===t?void 0:t.getValue("single")}),{fps:o,loop:l,sequenceSettingsApplyToAll:a}=r,n={fps:o,loop:l};s.importServ.updateSequenceSettings({newSettings:n,isApplyToAll:a}),i.sendSaveSequenceSettingsLog({collection_detail:"collection_material",sequenceSettings:{fps:o,loop:l,sequenceSettingsApplyToAll:a}})},saveSequenceSettingsForCollection(){var e;const t=ce({...null===(e=s.formApi)||void 0===e?void 0:e.getValue("collection")}),{fps:r,loop:o}=t,l={fps:r,loop:o};s.importServ.updateSequenceSettings({newSettings:l,isApplyToAll:!0}),i.sendSaveSequenceSettingsLog({collection_detail:"collection_all",sequenceSettings:{...t,sequenceSettingsApplyToAll:!0}})},get needConfirmModalOnClose(){return"mainForm"===s.mainFormLayout||e.stickers.length>0},get isReadyToPublish(){const t=e.stickers.length;return Boolean(t>=T.r$&&t<=T.qb&&s.collection.isInfoComplete&&e.isReadyToPublish&&!s.isPublishSucceeded)},get uploadStats(){const t=e.uploadStats;let i=0,r=0,o=0;const{cover:l,exampleImages:a}=s.collection;return[l,...a].forEach((e=>{e.isUploadFailed?o+=1:e.uri?r+=1:i+=1})),{pending:t.pending+i,succeeded:t.succeeded+r,failed:t.failed+o}},collectLogData(){const t=e.collectLogData(),{collection:i,stickersForOnlineImageEditorStats:r,uploadStats:o}=s,{cover:l,exampleImages:a,isInfoComplete:n}=i,c={isInfoComplete:n,stickersCount:t.length,stickersReadyToPublish:e.isReadyToPublish,stickersForOnlineImageEditorStats:r,uploadStats:o,stickers:t,cover:(0,I.Z)(l,["id","uri","needImport","isUploadFailed"]),exampleImages:a.map((e=>(0,I.Z)(e,["id","uri","isUploadFailed"])))};(0,W.c6)("[CollectionStore] collectLogData",c)},get isAllUploaded(){const{pending:e,failed:t}=s.uploadStats;return!e&&!t},isAllUploadedWatcher:r,async uploadAndPublish(e){i.sendPageActionLog({action:"publish"}),s.isAllUploaded||(await s.retryUpload(),null==e||e.show(),await s.isAllUploadedWatcher.start());try{await s.publish()}finally{null==e||e.hide()}},isPublishing:!1,isPublishSucceeded:!1,async publish(){s.isPublishing=!0;try{await s.publishImpl()}catch(e){return w.FN.error(U.I18n.t("pc_sticker_release_failed_retry_web")),(0,F.z)((()=>{s.isPublishing=!1})),void(0,W.RF)("[CollectionStore] publish failed",e)}(0,F.z)((()=>{s.isPublishing=!1,s.isPublishSucceeded=!0})),w.FN.success(U.I18n.t("pc_sticker_release_successful_web")),(0,oe.ZM)({effect_type:j.Ab.StickerCollection}),(0,W.c6)("[CollectionStore] publish success"),setTimeout((()=>(0,oe.Nt)({item_type:j.Ab.StickerCollection})),1e3)},async publishImpl(){s.isCollectionCoverCardSelected?s.saveCollectionFormState():s.saveSingleFormState();const{collection:t}=s,{cover:r,exampleImages:o,formState:l}=t,{title:a,description:n,tags:c,isVip:d,isBusiness:p,isOriginal:m,postChannel:u,targetedActivityId:g}=l,_=(0,ie.pn)({isVip:d,isBusiness:p,authFiles:s.authFileUploadServiceManager.getUploadedFiles(s.collection.id)}),S={effect_type:j.Ab.StickerCollection,is_vip:d,..._.root,common_data:{title:a,description:n,icon:{image_uri:r.uri},source:G.r0.UserPostPcCollection,tags:[...c],is_business:p,is_original:m,web_extra:JSON.stringify({tab_detail_images:o.map((e=>e.uri)),targeted_id:g}),post_channel:u===G.iu.Targeted?`${G.iu.Targeted}_${g}`:u,..._.commonData}},h=e.makePublishItemList({is_vip:d,is_business:p,is_original:m,postChannel:u,targetedActivityId:g,sourceForSimple:G.r0.UserPostPcCollection,sourceForSequence:G.r0.UserPostPcSequenceCollection,onResult:(e,t)=>(0,Q.g)({logPrefix:"[CollectionStore] ",sticker:e,publishResult:t,importServ:s.importServ,sendLogServ:s.sendLogServ})});(0,W.c6)("[CollectionStore] stickers publish start",{ids:h.map((e=>e.id))});const v=(await s.pubServ.batchPublish(h)).map((e=>e.resource_id));S.collection_info={resource_id_list:v},(0,W.c6)("[CollectionStore] collection publish start",{resourceIdList:v});const{resource_id:f}=await s.pubServ.publish({id:t.id,req:S,onResult:({req:e,error:r,errorText:o,time:s,resourceId:l})=>{i.sendStickerPublishStatusLog({error:o,time:s,collectionParams:{collection:t,collectionReqItem:e}}),r?(0,W.RF)("[CollectionStore] collection publish failed",r):(0,W.c6)("[CollectionStore] collection publish success",{resourceId:l})}});(0,W.c6)("[CollectionStore] collection publish done",{resourceId:f}),await s.pubServ.pollUntilAllInEffectList({ids:[f],types:[j.Ab.StickerCollection]}),(0,W.c6)("[SingleStore] poll done")},sendUploadProgressModalShowErrorLog(){const{collection:t}=s,r=e.stickers.filter((e=>e.isUploadFailed)).map((e=>({collection_detail:"collection_material",error_report:s.importServ.getFileStats(e.id).uploadError})));t.cover.id&&t.cover.isUploadFailed&&r.push({collection_detail:"collection_cover",error_report:s.importServ.getFileStats(t.cover.id).uploadError}),t.exampleImages.forEach((e=>{e.isUploadFailed&&r.push({collection_detail:"collection_sample",error_report:s.importServ.getFileStats(e.id).uploadError})})),i.sendStickerPublishErrorLog(r)},async retryUpload(){const e=[];[s.collection.cover,...s.collection.exampleImages].forEach((t=>{t.isUploadFailed&&e.push(t.id)})),await this.importServ.retryUpload(e),(0,F.z)((()=>{[s.collection.cover,...s.collection.exampleImages].forEach((t=>{e.includes(t.id)&&(t.isUploadFailed=!1)}))}))},retryTimesForOnlineImageEditor:0,retryUploadForOnlineImageEditor(){const{pending:e,failed:t}=s.getStickersForOnlineImageEditor();0===e.length&&t.length>0&&(s.retryTimesForOnlineImageEditor+=1,s.retryUpload())},getStickersForOnlineImageEditor(){const t=[],i=[],r=[];return e.stickers.forEach((e=>{if(e.unmetRequirements.length>0)return!1;if(e.isSequence){if(e.isUploadFailed)return void r.push(e);if(e.largeImageUri)return void t.push(e)}else if(e.hasCheckedRequirements)return void t.push(e);i.push(e)})),{pending:i,ready:t,failed:r}},get stickersForOnlineImageEditorStats(){const{pending:e,ready:t,failed:i}=s.getStickersForOnlineImageEditor();return{pending:e.length,ready:t.length,failed:i.length}},generateCollectionCoverWatcher:null,startCheckGenerateCollectionCover(){s.collection.cover.needImport=!1,s.generateCollectionCoverWatcher.start()},stopCheckGenerateCollectionCover(){s.generateCollectionCoverWatcher.stop()},generateCollectionCoverIfNeeded(){const{ready:t,failed:i}=s.getStickersForOnlineImageEditor(),r=new Set(i.map((e=>e.id))),o=new Set(t.map((e=>e.id))),l=e.stickers.slice(0,T.GR);if(l.length!==T.GR||l.some((e=>e.unmetRequirements.length>0||r.has(e.id))))return s.collection.cover.needImport=!0,!0;return!!l.every((e=>o.has(e.id)))&&(s.generateCollectionCover(l),!0)},async generateCollectionCover(e){const t=await s.importServ.generateCollectionCover({collectionId:s.collection.id,stickers:e});s.collection.cover.id?(0,W.c6)("[CollectionStore] generateCollectionCover ignored",{coverId:s.collection.cover.id}):t?s.replaceCover(t,"online_generated"):((0,F.z)((()=>{s.collection.cover.needImport=!0})),(0,W.RF)("[CollectionStore] generateCollectionCover failed"))},replaceCover(e,t){s.collection.cover.id&&s.importServ.removeFile(s.collection.cover.id),s.stopCheckGenerateCollectionCover(),s.collection.cover={id:e,uri:"",url:"",needImport:!1,isUploadFailed:!1,generatedFrom:t},s.importServ.recordFileUploadStart(e),s.importServ.registerThumbnailEvent(e,(t=>{s.collection.cover.id===e?t.base64?(0,F.z)((()=>{const{cover:e}=s.collection;e.url=(0,z.F2)(t.base64)})):(0,W.RF)(`[CollectionStore] cover thumbnail failed {${e}}`):(0,W.c6)(`[CollectionStore] cover thumbnail ignored {${e}}`,{coverId:s.collection.cover.id})})),s.importServ.registerUploadEvent(e,(t=>{if(s.collection.cover.id!==e)return void(0,W.c6)(`[CollectionStore] cover upload ignored {${e}}`,{coverId:s.collection.cover.id});const{cover:i}=s.collection,{uri:r}=t;(0,F.z)((()=>{if(r)i.uri=r,s.importServ.recordFileUploadEnd(e),(0,W.c6)(`[CollectionStore] cover upload success {${e}}`,{uri:r});else{i.isUploadFailed=!0;const r=t.error||"unknown";s.importServ.recordFileUploadEnd(e,r),(0,W.RF)(`[CollectionStore] cover upload failed {${e}}`,null,{error:r})}})),this.sendLogServ.sendCollectionUploadStatusLog({cover:i,stats:s.importServ.getFileStats(e)})}))},replaceExample(e,t){const i=s.collection.exampleImages[0];null!=i&&i.id&&s.importServ.removeFile(null==i?void 0:i.id),s.collection.exampleImages=[{id:e,uri:"",url:"",isUploadFailed:!1,generatedFrom:t}],s.importServ.recordFileUploadStart(e),s.importServ.registerThumbnailEvent(e,(t=>{const i=s.collection.exampleImages.find((t=>t.id===e));i?t.base64?(0,F.z)((()=>{i.url=(0,z.F2)(t.base64)})):(0,W.RF)(`[CollectionStore] exampleImage thumbnail failed {${e}}`):(0,W.c6)(`[CollectionStore] exampleImage thumbnail ignored {${e}}`)})),s.importServ.registerUploadEvent(e,(t=>{const i=s.collection.exampleImages.find((t=>t.id===e));i?((0,F.z)((()=>{const{uri:r}=t;if(r)i.uri=r,s.importServ.recordFileUploadEnd(e),(0,W.c6)(`[CollectionStore] exampleImage upload success {${e}}`,{uri:r});else{i.isUploadFailed=!0;const r=t.error||"unknown";s.importServ.recordFileUploadEnd(e,r),(0,W.RF)(`[CollectionStore] exampleImage upload failed {${e}}`,null,{error:r})}})),this.sendLogServ.sendCollectionUploadStatusLog({exampleImage:i,stats:s.importServ.getFileStats(e)})):(0,W.c6)(`[CollectionStore] exampleImage upload ignored {${e}}`)}))},async openCoverImageEditor(){i.sendPageActionLog({action:"cover_generate_from_online"}),await s.importServ.uploadConfigService.refreshUploadConfigsIfNeeded({logPrefix:"[CollectionStore]",when:"openCoverImageEditor"});const e=s.getStickersForOnlineImageEditor().ready,t=await s.importServ.openStickerOnlineImageEditor({...T.J,collectionId:s.collection.id,type:"CoverImage",stickers:e});t&&s.replaceCover(t,"online_generated")},async localUploadCover(){i.sendPageActionLog({action:"cover_upload_from_local"}),await s.importServ.uploadConfigService.refreshUploadConfigsIfNeeded({logPrefix:"[CollectionStore]",when:"localUploadCover"});const e=await s.importServ.localUploadImage({...T.J}),t=await this.checkLocalUploadRequirements({image:e,collection_detail:"collection_cover",requirements:T.J,i18nKey:{minImageSize:"pc_collection_cover_size_{X}x{X}px_web"}});t&&s.replaceCover(t.id,"local_uploaded")},async openExampleImageEditor(){await s.importServ.uploadConfigService.refreshUploadConfigsIfNeeded({logPrefix:"[CollectionStore]",when:"openExampleImageEditor"});const e=s.getStickersForOnlineImageEditor().ready,t=await s.importServ.openStickerOnlineImageEditor({...T.Em,collectionId:s.collection.id,type:"ExampleImage",stickers:e});t&&s.replaceExample(t,"online_generated")},removeExample(){const e=s.collection.exampleImages[0];null!=e&&e.id&&s.importServ.removeFile(null==e?void 0:e.id),s.collection.exampleImages=[]},async localUploadExample(){await s.importServ.uploadConfigService.refreshUploadConfigsIfNeeded({logPrefix:"[CollectionStore]",when:"localUploadExample"});const e=await s.importServ.localUploadImage({...T.Em}),t=await this.checkLocalUploadRequirements({image:e,collection_detail:"collection_sample",requirements:T.Em,i18nKey:{minImageSize:"pc_sample_smallest_size_{X}x{X}px_web"}});t&&s.replaceExample(t.id,"local_uploaded")},async checkLocalUploadRequirements(e){const{image:t,requirements:r,i18nKey:o,collection_detail:s}=e;if(!t)return null;const{width:l,height:a}=t,{minImageSize:n}=r;return l<n||a<n?(B.Z.warn({mainText:U.I18n.t("pc_stickers_release_failed_web"),subText:U.I18n.t(o.minImageSize,{X:n}),confirmBtnText:U.I18n.t("pc_stickers_release_confirm_web")}),i.sendStickerImportErrorLog({collection_detail:s,error_report:`width or height < ${n}`}),(0,W.c6)(`[CollectionStore] ${s} checkLocalUploadRequirements not passed: minImageSize`,{width:l,height:a,minImageSize:n}),null):t},destroy(){s.stopCheckGenerateCollectionCover()}})),{formApi:!1,generateCollectionCoverWatcher:!1});return s.generateCollectionCoverWatcher=(0,R.e)({watch:()=>s.generateCollectionCoverIfNeeded()}),(0,K.L)({watch:()=>{s.uploadStats,s.isReadyToPublish},collect:s.collectLogData}),(0,le.u)({watch:()=>s.needConfirmModalOnClose}),(0,y.useEffect)((()=>(window.store=s,s.importServ.uploadConfigService.updateCache(),s.authorSignService.init(),s.performanceTimingCollector.addRenderTiming(ae.Pk),()=>{t.destroy(),s.importServ.destroy()})),[]),s}const pe=(0,y.createContext)(null),me=()=>(0,y.useContext)(pe),ue=(0,r.Pi)((e=>{const{className:t}=e,i=me(),{collection:r}=i;return(0,x.jsx)(b,{className:t,selected:i.isCollectionCoverCardSelected,coverSrc:r.cover.url,title:r.title,description:r.description,isInfoComplete:r.isInfoComplete,onClick:i.selectCollectionCoverCard})}));var ge=i(503);const _e="root-krHCkJ",Se="disabled-n2Aq_E",he="percent-uW3VlL",ve=(0,r.Pi)((e=>{const{className:t,onClick:i}=e,r=me(),{t:s}=(0,o.$)(),l=(()=>{const{ready:e,pending:t,failed:i}=r.stickersForOnlineImageEditorStats;return e<4?{tooltip:s("pc_sticker_import_least_{X}_web",{X:4}),percent:null}:0===t&&0===i?null:{tooltip:r.retryTimesForOnlineImageEditor>1?s("pc_sticker_failed_retrying_web"):s("pc_sticker_loading_web"),percent:Math.floor(e/(e+t+i)*100)}})(),{handleMouseEnter:a}=(0,m.w)({content:null==l?void 0:l.tooltip,cursor:"not-allowed"});return(0,x.jsxs)("div",{className:c()(t,_e,l&&Se),onClick:e=>{l?e.stopPropagation():i(e)},onMouseEnter:l?a:void 0,children:[(0,x.jsx)("span",{children:s("pc_stickers_release_online_puzzle_web")}),l&&null!==l.percent&&(0,x.jsxs)("span",{className:he,children:[l.percent,"%"]})]})}));var fe;function ke(){return ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},ke.apply(this,arguments)}const Ce=e=>y.createElement("svg",ke({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16"},e),fe||(fe=y.createElement("path",{fill:"#D4A500",d:"M8 14c3.292 0 6-2.71 6-6.003C14 4.703 11.292 2 8 2S2 4.703 2 7.997C2 11.29 4.708 14 8 14Zm0-5.142c-.391 0-.62-.217-.638-.614l-.09-2.493c-.024-.421.277-.704.722-.704.445 0 .752.289.728.71l-.09 2.48c-.018.404-.247.621-.632.621Zm0 2.047c-.445 0-.794-.283-.794-.71 0-.428.349-.717.794-.717.451 0 .788.29.788.717s-.343.71-.788.71Z"})));var xe=i(82346);const be="root-OOqubc",Ie="loadingText-blkQ9S",ye="errorText-b8vNmn",we="retryText-cBAROb",Fe="warnText-XizvZZ",Ne=e=>{const{className:t,isUploadFailed:i,onRetry:r,needImport:s,loading:l}=e,a=c()(be,t),{t:n}=(0,o.$)();return i?(0,x.jsx)("div",{className:a,children:(0,x.jsx)("span",{className:ye,children:n("pc_stickers_release_error_x_web",{X:(0,x.jsx)("span",{className:we,onClick:r,children:n("pc_stickers_release_click_again_web")},"X")})})}):s?(0,x.jsxs)("div",{className:a,children:[(0,x.jsx)(Ce,{height:14,width:14}),(0,x.jsx)("span",{className:Fe,children:n("pc_stickers_release_add_cover_web")})]}):l?(0,x.jsxs)("div",{className:a,children:[(0,x.jsx)(xe.a,{size:12,arcColor:"var(--grey-1)"}),(0,x.jsx)("span",{className:Ie,children:n("pc_stickers_release_in_web")})]}):(0,x.jsx)("div",{className:a})},Ue="root-SiuXcn",je="icon-pvz0IF",Ae=e=>{const{className:t,src:i}=e,r=c()(Ue,t);return(0,x.jsx)("div",{className:r,children:i?(0,x.jsx)("img",{className:je,src:i}):(0,x.jsx)(d.t,{className:je,iconWidth:28})})};var Ee=i(44704);const qe="root-RGRrw_",Pe="statusBar-g7EX3X",Le="edit-gNJiPH",Te="editMenuItem-Lwrrxl",ze=(0,r.Pi)((e=>{const t=me(),{t:i}=(0,o.$)(),{cover:r}=t.collection;return(0,x.jsxs)("div",{className:qe,children:[(0,x.jsx)(Ae,{src:r.url}),(0,x.jsx)(w.J2,{position:"bottomRight",trigger:"click",className:Ee.i.heycanPopoverWrapperClearStyle,clickToHide:!0,onVisibleChange:e=>{e&&t.retryUploadForOnlineImageEditor()},content:(0,x.jsx)(ge.m,{items:[{key:"openCoverImageEditor",render:({key:e,className:i})=>(0,x.jsx)(ve,{className:i,onClick:t.openCoverImageEditor},e)},{key:"localUploadCover",render:({key:e,className:r})=>(0,x.jsx)("div",{className:c()(r,Te),onClick:t.localUploadCover,children:i("pc_stickers_release_local_web")},e)}]}),children:(0,x.jsx)("div",{className:Le,children:i("pc_stickers_release_cover_edit_web")})}),(0,x.jsx)(Ne,{className:Pe,isUploadFailed:r.isUploadFailed,onRetry:t.retryUpload,needImport:r.needImport,loading:!r.url&&!r.needImport})]})}));var Re=i(63170),Me=i(95968),Oe=(i(74408),i(26758)),$e=i(33831);const Be="rules-dY0ScJ",Ve="item-AGHWKH",Ze="iconDot-j9ob_p",De="iconTick-D79ceF",We="content-g4kRtr",Xe=({className:e,rules:t})=>(0,x.jsx)("div",{className:c()([Be,e]),children:t.map(((e,t)=>(0,x.jsxs)("div",{className:Ve,children:[(void 0===e.status||"normal"===e.status)&&(0,x.jsx)("div",{className:Ze}),"success"===e.status&&(0,x.jsx)($e.Z,{className:De}),(0,x.jsx)("p",{className:We,children:e.content})]},t)))});var Ge=i(79679);const Je="root-E0tpJM",He="title-H2crax",Ye="word-BtnjNE",Qe="help-XAH_LZ",Ke="opt-QOw283",et="highLight-PASzWv",tt="content-SmW56E",it="imgBox-q1y7Qu",rt="img-fx46qr",ot="statusBar-QLDUGu",st="loadingText-uP8NbU",lt="retryText-RzWB7U",at="example-p5VW7t",nt="contextMenuItem-tm8D3m",ct="editMenuItem-COaeTW",dt="failedImg-rOcYXw",pt=()=>{const{t:e}=(0,o.$)();return(0,x.jsxs)("div",{className:Ye,children:[e("pc_sticker_sample_web"),(0,x.jsx)(w.J2,{content:(0,x.jsx)("div",{className:at,children:(0,x.jsx)(Xe,{rules:[{content:`${e("file_format_web")}PNG/GIF`},{content:e("pc_stickers_prompt_w_{X}_h_{Y}_web",{X:"1000px",Y:"1250px"})},{content:e("file_size_limit_web",{X:5})}]})}),children:(0,x.jsx)(Oe.Z,{size:"small",className:Qe})})]})},mt=(0,r.Pi)((({className:e})=>{const t=me(),{t:i}=(0,o.$)(),r=t.collection.exampleImages[0],{handleContextMenu:s}=(0,Ge.D)({content:(0,x.jsx)(ge.m,{items:[{key:"remove",render:({key:e,className:r})=>(0,x.jsx)("div",{className:c()(r,nt),onClick:t.removeExample,children:i("pc_stickers_release_delete_web")},e)}]})}),l=(0,y.useMemo)((()=>{const e=r;return e?null!=e&&e.url?(0,x.jsx)("div",{className:it,children:(0,x.jsx)("img",{className:rt,src:null==e?void 0:e.url,alt:""})}):(0,x.jsx)("div",{className:it,children:(0,x.jsx)(d.t,{className:dt,iconWidth:17})}):null}),[null==r?void 0:r.isUploadFailed,null==r?void 0:r.url]);return(0,x.jsx)("div",{className:c()(Je,e),children:(0,x.jsxs)("div",{className:He,children:[(0,x.jsx)(pt,{}),(0,x.jsx)("div",{className:tt,onContextMenu:e=>{s(e)},children:(0,x.jsxs)(x.Fragment,{children:[l,null!=r&&r.isUploadFailed?(0,x.jsx)("div",{className:ot,children:i("pc_stickers_release_error_x_web",{X:(0,x.jsx)("span",{className:lt,onClick:t.retryUpload,children:i("pc_stickers_release_click_again_web")},"X")})}):null==r||!r.id||null!=r&&r.url?null:(0,x.jsxs)("div",{className:ot,children:[(0,x.jsx)(xe.a,{size:12,arcColor:"var(--grey-1)"}),(0,x.jsx)("span",{className:st,children:i("pc_stickers_release_in_web")})]})]})}),(0,x.jsx)("div",{className:Ke,children:(0,x.jsx)(w.J2,{position:"bottomRight",trigger:"click",clickToHide:!0,content:(0,x.jsx)(ge.m,{items:[{key:"openCoverImageEditor",render:({key:e,className:i})=>(0,x.jsx)(ve,{className:i,onClick:t.openExampleImageEditor},e)},{key:"localUploadCover",render:({key:e,className:r})=>(0,x.jsx)("div",{className:c()(r,ct),onClick:t.localUploadExample,children:i("pc_stickers_release_local_web")},e)}]}),children:(0,x.jsx)("span",{className:et,children:i("pc_sticker_edit_web")})})})]})})}));var ut=i(81860),gt=i(25577),_t=i(14590),St=i(31686),ht=i(45033),vt=i(53803);const ft="root-VsnTC4",kt="label-Bpq1iR",Ct="useAll-TIjXSy",xt="advancedSettingsTitle-eGU9np",bt="exampleImageField-Z2iuTF",It="fpsSettingsField-ADkz4K",yt="input-dtQ3J2",{Label:wt}=w.Form,Ft=(0,r.Pi)((()=>{const{t:e}=(0,o.$)(),t=me(),{importServ:i,collection:r}=t,{stickerListStore:s}=i,{authConfig:l}=s.materialPostConfig,{mustPaidAuth:a}=l,{postChannel:n,targetedActivityId:c}=r.formState,[d,p]=(0,y.useState)([]),{getDisplayLength:m}=(0,ht._)();(0,y.useLayoutEffect)((()=>t.initCollectionFields()),[]),(0,y.useEffect)((()=>{d.length||async function(){return(await(0,G.ip)({effect_type:j.Ab.Sticker})).tasks.map((e=>({label:e.title,value:e.task_id})))}().then((e=>{p(e)}))}),[]);return(0,x.jsxs)("div",{className:ft,children:[(0,x.jsx)(ze,{}),(0,x.jsx)(Re.y,{fieldClassName:yt,label:e("pc_stickers_release_group_name_web"),field:"collection.title",maxLength:T.S8,placeholder:e("pc_stickers_release_xy_name_web",{X:1,Y:m(T.S8)}),rules:[{required:!0,message:""}],onChange:e=>t.updateCollectionFormState({title:e})}),(0,x.jsx)(Re.y,{fieldClassName:yt,label:e("pc_stickers_release_details_recommend_web"),field:"collection.description",maxLength:T.Us,placeholder:e("pc_stickers_release_xy_details_web",{X:1,Y:m(T.Us)}),onChange:e=>t.updateCollectionFormState({description:e})}),(0,x.jsxs)("div",{className:kt,children:[(0,x.jsx)(Me.u,{fieldClassName:yt,label:e("pc_stickers_release_tag_set_web"),placeholder:e("please_enter_the_label_enter_key_to_confirm_the_input_web"),field:"collection.tags",itemType:j.Ab.Sticker,recommendConfig:{title:r.title,uri:r.cover.uri},rules:[{required:!0,message:""}],onChange:e=>t.updateCollectionFormState({tags:e})}),(0,x.jsx)("span",{className:Ct,onClick:()=>{var e,i;const r=null===(e=t.formApi)||void 0===e?void 0:e.getValues();s.applyForTags((null==r||null===(i=r.collection)||void 0===i?void 0:i.tags)||[])},children:e("pc_stickers_release_apply_all_web")})]}),(0,x.jsxs)("div",{className:kt,children:[(0,x.jsx)(wt,{required:!0,text:e("cc_pc_material_visual_effect_publish_creation_type_web")}),(0,x.jsx)(St.Z,{value:{postChannel:n,activityId:c},onChange:e=>{const i={postChannel:e.postChannel,targetedActivityId:e.activityId};t.updateCollectionFormState(i)},taskList:d,loading:!d.length,viewMoreUrl:"https://bytedance.sg.larkoffice.com/docx/PDNEdbBZxoXibnxSGn5l7U7Xgre?open_in_browser=true",onOrientationViewMoreClick:()=>{t.sendLogServ.sendPageActionLog({action:"click_more_official_task"})}})]}),!1,(0,x.jsx)(gt.Z,{required:a,children:(0,x.jsx)("div",{className:vt.Z.authGroup,children:(0,x.jsx)(_t.R,{noLabel:!0,field:"collection.isVip",disabled:A.$.isEnableAuthorization,disabledTooltip:e("cc_pc_material_visual_effect_publish_authorized_hover_web"),tooltip:a?e("cc_pc_material_visual_effect_publish_authorize_hover_web"):"",sendLogService:t.sendLogServ,onChange:e=>{var i,r;e&&(null===(r=t.sendLogServ)||void 0===r||r.sendPageActionLog({action:"choose_subscription_authorize"}));t.updateCollectionFormState({isVip:e}),null===(i=t.formApi)||void 0===i||i.setValue("collection",{...t.formApi.getValue("collection"),isVip:e})}})})}),(0,x.jsx)("div",{className:xt,children:e("pc_stickers_release_higher_settings_web")}),(0,x.jsx)(mt,{className:bt}),t.field.canFpsSetting&&(0,x.jsx)(ut.ZP,{className:It,prefix:"collection",onStartEdit:()=>t.sendLogServ.sendStartEditSequenceSettingsLog({}),onSave:t.saveSequenceSettingsForCollection})]})}));var Nt=i(74195),Ut=i(82725);const jt="collectionCoverCard-Wqf4av",At="stickerList-Opl43w",Et=(0,r.Pi)((e=>{const{className:t}=e,i=me(),{t:r}=(0,o.$)();return(0,Y.pg)(i),(0,l.O)({className:t,layout:i.mainFormLayout,uploadAreaProps:{titleForUploadArea:r("pc_sticker_release_drag_web"),titleForMainForm:r("pc_stickers_release_drag_in_web"),subTitle:r("pc_sticker_release_groups_png_web"),draggingTitle:r("pc_sticker_release_mouse_web"),disabled:i.isImportDisabled,disabledTooltip:r("pc_stickers_release_max_x_web",{X:T.qb}),onClick:i.openStickerFilePicker,onDrop:i.uploadDroppedStickerFiles},importLoadingText:r("pc_sticker_release_loading_web"),setFormApi:i.setFormApi,renderImportArea:e=>(0,x.jsxs)(x.Fragment,{children:[e,(0,x.jsx)(ue,{className:jt}),(0,x.jsx)(a.z,{className:At,importStickerFileService:i.importServ,onSelect:i.selectSticker,onReimport:i.reimportSticker})]}),renderFormArea:()=>{if(i.isCollectionCoverCardSelected)return(0,x.jsx)(Ft,{});const{selectedSticker:e}=i.stickerListStore;return e&&(0,x.jsx)(Nt.E,{importStickerFileService:i.importServ,sticker:e,initFields:i.initSingleFields,onStartEditSequenceSettings:()=>i.sendLogServ.sendStartEditSequenceSettingsLog({collection_detail:"collection_material"}),onSaveSequenceSettings:i.saveSequenceSettingsForSingle})},scrollAreaRef:i.importServ.stickerListStore.scrollAreaRef,onRetry:Ut.cb})}));var qt=i(38803),Pt=i(36775);const Lt=(0,r.Pi)((e=>{const{className:t}=e,i=me(),r=(0,y.useRef)(null),{t:s}=(0,o.$)();return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(qt.P,{className:t,leftText:s("pc_sticker_release_X_web",{X:i.importLoadingStore.isImportLoading?0:i.stickerListStore.stickers.length,Y:T.r$,Z:T.qb}),isPublishDisabled:!i.isReadyToPublish,isPublishing:i.isPublishing,needConfirmModalOnClose:i.needConfirmModalOnClose,onPublish:()=>i.uploadAndPublish(r.current)}),(0,x.jsx)(Pt.q,{ref:r,uploadStats:i.uploadStats,onRetryUpload:i.retryUpload,onCancel:i.isAllUploadedWatcher.stop,onShowUploadFail:i.sendUploadProgressModalShowErrorLog,onPromptConfirmToCancel:i.isAllUploadedWatcher.handlePromptConfirmToCancel})]})}));var Tt=i(12904),zt=i(65546);const Rt="page-bI3zoQ",Mt="content-CkDfjt",Ot="requirement-CWgpLc",$t="mainForm-GIDO1U",Bt="footer-YVeBwr",Vt=(0,r.Pi)((()=>{const e=de(),{t}=(0,o.$)(),{selectedSticker:i}=e.importServ.stickerListStore;return(0,Tt.F)({title:t("pc_stickers_release_ing_web"),pid:"sticker-publish-collection"}),(0,zt.d)(),(0,Y.t9)(e.sendLogServ),(0,x.jsxs)(pe.Provider,{value:e,children:[(0,x.jsxs)("div",{className:Rt,children:[(0,x.jsxs)("div",{className:Mt,children:[(0,x.jsx)(s.n,{className:Ot,sticker:i}),(0,x.jsx)(Et,{className:$t})]}),(0,x.jsx)(Lt,{className:Bt})]}),!1]})}))},17095:(e,t,i)=>{i.d(t,{g:()=>o});var r=i(46309);function o(e){console.log("[sendLog]",e.eventName,e.params),(0,r.qx)(e)}},97311:(e,t,i)=>{i.d(t,{F2:()=>o,J9:()=>r,lm:()=>s});i(96706);const r=async e=>{const t=await fetch(e);return(e=>URL.createObjectURL(e))(await t.blob())},o=(e,t="")=>`data:${t};base64,${e}`;const s=e=>e.toLowerCase().split(".").pop()}}]);