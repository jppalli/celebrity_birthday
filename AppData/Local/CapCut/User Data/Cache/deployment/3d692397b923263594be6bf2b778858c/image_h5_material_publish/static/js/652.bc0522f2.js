"use strict";(self.webpackChunkartist_op_web=self.webpackChunkartist_op_web||[]).push([[652],{97475:(e,t,n)=>{n.d(t,{i:()=>s});const s={macos:"macos",windows:"windows",heycanRatioGroupEllipsis:"heycan-ratio-group-ellipsis",heycanCheckboxEllipsis:"heycan-checkbox-ellipsis",heycanFormFieldEllipsis:"heycan-form-field-ellipsis",heycanPopoverWrapperClearStyle:"heycan-popover-wrapper-clear-style",heycanTextareaThemeGrey:"heycan-textarea-theme-grey",heycanInputThemeGrey:"heycan-input-theme-grey"}},16480:(e,t,n)=>{n.d(t,{vc:()=>a.v,ZP:()=>c,S1:()=>i.Wq});var s=n(50959),o=n(49340),i=n(82725),r=n(11527),a=n(5777);const c=()=>((0,s.useEffect)((()=>{(0,i.ZP)()}),[]),(0,r.jsx)(o.j3,{}))},5777:(e,t,n)=>{n.d(t,{v:()=>i,w:()=>o});let s={};function o(e){s=e}const i=()=>({intl:{clientOptions:{getOverrideOptions:()=>s}}})},25807:(e,t,n)=>{n.d(t,{$:()=>u});var s=n(59787),o=n(66589),i=n(8129),r=n(46309),a=n(54847),c=n(94435),l=n(76706);const u=new class{constructor(){(0,s.Z)(this,"userInfo",{avatar:"",nickname:"",uid:""}),(0,s.Z)(this,"permissions",[]),(0,s.Z)(this,"isEnableAuthorization",!1),(0,s.Z)(this,"initUserInfoPromise",null),(0,o.ky)(this)}async initUserInfo(){return this.initUserInfoPromise||(this.initUserInfoPromise=this.initUserInfoImpl().catch((e=>{throw this.initUserInfoPromise=null,e}))),this.initUserInfoPromise}async refreshUserInfo(){return a.appModel.isInited?this.initUserInfoImpl():this.initUserInfo()}async initUserInfoImpl(){var e;const t=await(0,r.bG)().catch((()=>null));if(!1===(null==t?void 0:t.hasLoggedIn))return(0,o.z)((()=>{this.userInfo.avatar="",this.userInfo.nickname="",this.userInfo.uid="",this.permissions=[],this.isEnableAuthorization=!1})),void(0,i.$G)({userId:""});null!=t&&t.hasLoggedIn&&null!==(e=t.userInfo)&&void 0!==e&&e.userID&&((0,o.z)((()=>{this.userInfo.uid=t.userInfo.userID,this.userInfo.avatar=t.userInfo.avatarURL,this.userInfo.nickname=t.userInfo.nickname})),(0,i.$G)({userId:this.userInfo.uid}));const n=c.rz,[s,a]=await Promise.all([n(),(0,c.YC)()]);(0,o.z)((()=>{var e;null!=s&&s.userID&&(this.userInfo.uid=s.userID,this.userInfo.nickname=s.nickname,this.userInfo.avatar=s.avatarURL),this.permissions=(null===(e=a.enable_list)||void 0===e||null===(e=e.filter((e=>e.is_enable)))||void 0===e?void 0:e.map((e=>e.whitelist_type)))||[]}));{const e=await(0,l.Wr)();(0,o.z)((()=>{this.isEnableAuthorization=e.allow_pro_template_auto_transition}))}(0,i.$G)({userId:this.userInfo.uid})}}},62262:(e,t,n)=>{n.d(t,{w:()=>o});var s=n(59787);class o extends Error{constructor(e,t){super(e),this.context=t,(0,s.Z)(this,"name","HeycanError")}}},76896:(e,t,n)=>{n.d(t,{c:()=>i});var s=n(22310);const{userAgent:o}=navigator,i=(0,s.Z)((()=>/macintosh/i.test(o)&&!/(ipod|iphone|ipad)/i.test(o)));(0,s.Z)((()=>/windows/i.test(o)))},82725:(e,t,n)=>{n.d(t,{Wq:()=>l,ZP:()=>u,cb:()=>c});n(84781);var s=n(97475),o=n(54847),i=n(25807),r=n(76896),a=n(8129);async function c(e){try{await o.appModel.initAppInfo(),await i.$.initUserInfo(),o.appModel.setInited()}catch(t){if((0,a.RF)("initAppAndUserInfo failed",t),o.appModel.setInitFailed(),null!=e&&e.throwOnError)throw t}}async function l(){try{await o.appModel.initAppInfo()}catch(e){(0,a.RF)("tryInitCoreAppInfo failed",e),o.appModel.setInitFailed()}}function u(){document.oncontextmenu=()=>!1,document.ondragover=e=>e.preventDefault(),document.ondrop=e=>e.preventDefault(),document.addEventListener("keydown",(e=>{("w"===e.key&&e.metaKey||"w"===e.key&&e.ctrlKey)&&e.preventDefault()}));const e=(0,r.c)()?s.i.macos:s.i.windows;document.body.classList.add(e),o.appModel.initDebugInfo(),c()}},55425:(e,t,n)=>{n.d(t,{v_:()=>y});var s=n(22310),o=n(80418),i=n(73224),r=n(98052),a=n(54847),c=n(62262),l=n(8129),u=n(46309);let d=!1;const p=(0,s.Z)((async()=>{return"true"===(await async function(e,t){try{return(await(0,u.Gw)({nodeKey:e,keys:t})).nodeKey}catch(n){(0,l.RF)("[getSettings] error",n,{nodeKey:e,keys:t})}return{}}("abtest_use_new_host",["enabled"])).enabled})),h=["/lv/v1/user/","/lv/v1/ad_maker/","/lv/v1/commerce/","/lv/v1/creator/"],m=["/artist/v1/homepage/get_effect_list"];async function f(e,t){const n=await p(),s=n&&d,u=n&&!d,y=e.startsWith("/")?`${function(e,t){{const n=(null==t?void 0:t.useNewHost)||!1;if(e){if(h.some((t=>e.startsWith(t))))return n?"https://feed-api.capcutapi.com":"https://feed-api.capcut.com";if(m.includes(e))return n?"https://heycan-api.capcutapi.com":"https://api-heycan-pc-sg.capcut.com"}return n?"https://editor-api.capcutapi.com":"https://editor-api-sg.capcut.com"}}(e,{useNewHost:u})}${e}`:e,g=o.parseUrl(y),{region:v,language:w,appVersionName:I}=a.appModel.appInfo,_={url:o.stringifyUrl({url:g.url,query:{...!t.disableRegion&&{region:v},language:w,version_name:I,...g.query}}),method:t.method,needCommonParams:!0,header:{"Content-Type":"application/json",...t.headers},header_signing:!0,...t.data&&{data:JSON.stringify(t.data)},...t.timeout&&{timeout_ms:t.timeout}},$=(n,o,i)=>{const r={rawUrl:e,useNewHost:u,disableNewHostByLoginError:s,..._,...i};"error"===n?(0,l.RF)(o,null,r):t.onlyLogOnError||(0,l.c6)(o,r)},b=e=>i.I18n.t("pc_stickers_prompt_failed_{X}",{X:e});$("info",`[request] start - ${e}`);let k=null;const Z=performance.now();try{k=await r.Jn.call("request",_)}catch(U){const n=performance.now()-Z>=(t.timeout||2e4),s=`[request] ${n?"timeout":"failed"} - jsb - ${e}`;throw $("error",s,{code:U.code,errorText:JSON.stringify(U),timeout:n}),new c.w(s,{code:U.code,displayMessage:b("jsb")})}const x={httpCode:k.httpCode,code:k.response.ret,errmsg:k.response.errmsg,logid:k.response.logid||k.response.log_id};if(200!==k.httpCode){const t=`[request] failed - httpCode ${k.httpCode} - ${e}`;throw $("error",t,x),new c.w(t,{...x,displayMessage:b(`http ${k.httpCode}`)})}if("success"!==k.response.errmsg){const n=`[request] failed - ${x.code} ${x.errmsg} - ${e}`;if($("error",n,x),u&&"1015"===String(x.code)&&location.pathname.endsWith("/publish-text-template.html"))return d=!0,f(e,t);throw new c.w(n,{...x,displayMessage:b(`${x.code} ${x.errmsg}`)})}return $("info",`[request] success ${e}`,x),k.response.data}function y(e,t,n){return f(e,{method:"POST",data:t,...n})}},8129:(e,t,n)=>{n.d(t,{$G:()=>m,RF:()=>l,c6:()=>c,hC:()=>f});var s=n(11449),o=n(74637),i=n.n(o);const r=()=>i()().format("MM-DD HH:mm:ss.SSSZ");function a(e,t){try{var n,s;const o=String(e).trim(),i=null!==(n=null===(s=o.match(/^\[\w+\]/))||void 0===s?void 0:s[0])&&void 0!==n?n:"",r=i.slice(1,-1),a=o.slice(i.length).replace(/\{\S*?\}/g,"").trim().replace(/[\s:-]+/g,"-");return{module:r,scene:t.scene?`${a}-${t.scene}`:a}}catch(o){return{module:"",scene:t.scene||""}}}async function c(e,t){const n=`${r()} ${e}`,{module:o,scene:i}=a(e,{...t}),c={...t,module:o,scene:i};(0,s.Z)("sendLog",{level:"info",content:n,extra:c})}async function l(e,t,n){const o="HeycanError"===(null==t?void 0:t.name)?t.context:t;t&&(0,s.Z)("captureException",t,{...o,...n});const i=`${r()} ${e}`,{module:c,scene:l}=a(e,{...o,...n}),u={stack:null==t?void 0:t.stack,message:null==t?void 0:t.message,...o,...n,module:c,scene:l};(0,s.Z)("sendLog",{level:"error",content:i,extra:u}),console.error(`[slardar] ${i}`,{...u}),t&&console.error(t)}const u=[],d=1e3;function p(e){const t=e.post;e.post=n=>{const{success:s,fail:o}=n;t({...n,success:t=>{(()=>{if(0===u.length)return;const t=u.shift();t&&e.post(t)})(),null==s||s(t)},fail:e=>{u.push(n),u.length>d&&u.shift(),null==o||o(e)}})}}let h=!1;function m(e){h||(h=!0,s.Z.on("init",(()=>{var e;const t=null===(e=s.Z.config())||void 0===e?void 0:e.transport;t&&p(t)})));const{ctx:t,...n}=e;(0,s.Z)("config",n),t&&s.Z.context&&(0,s.Z)("context.merge",t)}function f(e){const{module:t,scene:n,metrics:o,categories:i}=e;(0,s.Z)("sendEvent",{name:"heycan_performance_timing",metrics:o,categories:{...i,module:t,scene:n}})}},2555:(e,t,n)=>{n.d(t,{B:()=>o});var s=n(59787);class o{constructor(){(0,s.Z)(this,"timeoutHandle",null)}timeout(e){return this.cancel(),new Promise((t=>{this.timeoutHandle=setTimeout((()=>{this.timeoutHandle=null,t()}),e)}))}cancel(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null)}hasTimeout(){return null!==this.timeoutHandle}}},53649:(e,t,n)=>{n(34415),n(69163),n(40398),n(8971),n(91351),n(28200),n(62824),n(74024),n(10972),n(544),n(24799),n(12021),n(79577),n(40641),n(40413),n(8810),n(63931),n(23645),n(28937),n(33686),n(82313),n(76990),n(48069),n(61113),n(88932),n(61294),n(33180),n(42060),n(61892),n(37469)},44296:()=>{window.__assetPrefix__="."}}]);