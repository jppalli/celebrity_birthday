var TypeScriptModule;(()=>{var e,t,n,o,i,r={19369:(e,t,n)=>{"use strict";var o,i,r=n(43032),a=n(79490),s=n(8520),c=n(94329);!function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(o||(o={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(i||(i={}));var l,u,d,f,p,h,g,v,y,b,m,C,E,I,L,S=void 0,A=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]};!function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.SubFeatureName="SubFeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(d||(d={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.ExtensibilityDialog="ExtensibilityDialog",e.LocalAddinActionExecution="LocalAddinActionExecution"}(f||(f={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(p||(p={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.PodcastFromNudgeTriggered="Podcast_From_Nudge_Triggered",e.DescribeImageFromNudgeTriggered="Describe_Image_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.ExtensibilityDialogLoad="Extensibility_Dialog_Load",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened",e.OpenMOSDialog="Open_MOS_Store_To_Get_Agents",e.MOSStoreDialogResponse="MOS_Store_Dialog_Response",e.VoiceCopilotZQMSubmitted="Voice_Copilot_ZQM_Submitted",e.VoiceCopilotZQMResponseRendered="Voice_Copilot_ZQM_Response_Rendered",e.VoiceCopilotZQMResponseClicked="Voice_Copilot_ZQM_Response_Clicked",e.VoiceCopilotZQMAutoStarted="Voice_Copilot_ZQM_Auto_Started",e.ChatHistorySignalSubmitted="Chat_History_Signal_Submitted",e.ConversationIdUndefined="Conversation_Id_Undefined",e.UpdateChatSessionId="Update_Chat_Session_Id",e.CannotUpdateChatSessionId="Cannot_Update_Chat_Session_Id",e.SubmitOperationUndefined="Submit_Operation_Undefined",e.ConnectionHealth="Connection_Health",e.InsightsCardRelatedFilesResponse="Insights_Card_RelatedFiles_Response",e.AugLoopOfficeCopilotOrchestrationCopilotRelatedFilesError="AugLoop_OfficeCopilotOrchestration_CopilotRelatedFiles_Error",e.InsightsCardRelatedFilesSignalSent="Insights_Card_RelatedFiles_Signal_Sent",e.InsightsCardCocoaSkillResponse="Insights_Card_CocoaSkill_{Skill}_Response",e.InsightsCardCocoaSkillResponseUpdating="Insights_Card_CocoaSkill_{Skill}_Response_Updating",e.InsightsCardCocoaSkillResponseLoaded="Insights_Card_CocoaSkill_{Skill}_Response_Loaded",e.InsightsCardCocoaSkillResponseError="Insights_Card_CocoaSkill_{Skill}_Response_Error",e.InsightsCardCocoaSkillResponseTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_TimedOut",e.InsightsCardCocoaSkillResponseRetryTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_Retry_TimedOut",e.InsightsCardCocoaSkillCardClicked="Insights_Card_CocoaSkill_{Skill}_CardClicked",e.InsightsCardCocoaSkillCardNavigatedTo="Insights_Card_CocoaSkill_{Skill}_CardNavigatedTo",e.LocalAddinActionInvoked="Local_Addin_Action_Invoked",e.LocalAddinExecutionCompletedFromHost="Local_Addin_Action_Completed_From_Host",e.LocalAddinExecutionFailedFromHost="Local_Addin_Action_Failed_From_Host",e.LocalAddinExecutionReceivedMultipleRequests="Local_Addin_Action_Received_Multiple_Requests",e.LocalAddinExecutionReceivedSingleRequest="Local_Addin_Action_Received_Single_Request",e.LocalAddinExecutionStarted="Local_Addin_Action_Started",e.StopGeneratingButtonClickedDuringAddinExecution="Stop_Generating_Button_Clicked_During_Addin_Execution",e.UndoButtonClickedAfterAddinSuccess="Undo_Button_Clicked_After_Addin_Success",e.UndoButtonHiddenOnSubmittingQueryAfterAddinSuccess="Undo_Button_Hidden_On_Submitting_Query_After_Addin_Success",e.UndoButtonShownAfterAddinSuccess="Undo_Button_Shown_After_Addin_Success"}(h||(h={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode",e.ErrorStack="ErrorStack"}(g||(g={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat",e.Extensibility="Extensibility"}(v||(v={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(y||(y={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile",e.AddInActionsForAgents="Add-in Actions for Agents"}(b||(b={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(m||(m={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(C||(C={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(E||(E={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(I||(I={})),function(e){e[e.Warning=400]="Warning",e[e.ASHA=450]="ASHA",e[e.Error=500]="Error",e[e.Critical=600]="Critical"}(L||(L={})),function(e){e.Error="Error",e.UncaughtException="UncaughtException",e.ChatEvents="ChatEvents",e.AssertionFailed="AssertionFailed"}(f||(f={}));var w=function(e){return T(e)/1e3},T=function(e){return(new Date).getTime()-e},P=(function(){function e(){var e=this;this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.resetPersonalizationHITLActionState=function(){e.isPersonalizationHITLResponseCardActive=!1,e.personalizationHITLActionButtonList=[]},this.resetPersonalizationLatencyState=function(){e.personalizationHITLCardActivationTime=0,e.personalizationHITLCardUserInteractionTime=0},this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.personalizationHITLCardActivationTime=0}e.getInstance=function(){return ae(e.personalizationHITLActionStateHandler)&&(e.personalizationHITLActionStateHandler=new e),e.personalizationHITLActionStateHandler},e.prototype.getIsPersonalizationHITLResponseCardActive=function(){return this.isPersonalizationHITLResponseCardActive},e.prototype.setIsPersonalizationHITLResponseCardActive=function(e){this.isPersonalizationHITLResponseCardActive=e},e.prototype.getPersonalizationHITLActionButtonList=function(){return this.personalizationHITLActionButtonList},e.prototype.setPersonalizationHITLActionButtonList=function(e){this.personalizationHITLActionButtonList=e},e.prototype.setPersonalizationHITLCardActivationTime=function(e){this.personalizationHITLCardActivationTime=e},e.prototype.getPersonalizationHITLUserInteractionTime=function(){return this.personalizationHITLCardUserInteractionTime},e.prototype.shouldConsiderPersonalizationHITLUserInteractionLatency=function(){return 0!==this.personalizationHITLCardActivationTime},e.prototype.setPersonalizationHITLUserInteractionTime=function(){this.personalizationHITLCardUserInteractionTime=w(this.personalizationHITLCardActivationTime)}}(),"AugLoopChat".concat(S)),k=function(){function e(){}return e.generateId=function(){return e.operationId++,P+e.operationId.toString()},e.operationId=0,e}(),_=function(){var e=0,t=n(63969);if(void 0!==(null==t?void 0:t.querySubmitTime))return e=t.querySubmitTime;var o=n(81980);return void 0!==(null==o?void 0:o.querySubmitTime)?e=o.querySubmitTime:e},D=function(e,t,n){var o;l.sendErrorTelemetry(x(((o={})[g.ErrorMessage]="".concat(e),o[g.ErrorCategory]=f.CLP,o[g.ErrorCode]=t,o[g.ErrorStack]=n,o)))},O=function(e){var t;l.sendChatEventTelemetry(x(((t={})[p.ChatEventType]=h.OfficeJsApiCallForCLP,t[p.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},x=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};function M(e){l.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function N(e,t){return e+" "+t}var R,H,F,U,q,B,j,z,G,W,Q,J,V,K,Y,Z=function(e,t,n){var o;l.sendLatencyTelemetry(x(((o={})[d.FeatureName]="ExtensibilityDialogLoad",o[d.UserPerceivedLatency]=e,o[d.IsQuerySuccess]=t,o[d.ErrorChatEventType]=t?"":h.ExtensibilityDialogLoad,o[d.ErrorChatEventParameter]=t?"":n,o)),!0)},$=function(e){var t;l.sendErrorTelemetry(x(((t={})[g.ErrorMessage]=e,t[g.ErrorCategory]=f.ExtensibilityDialog,t[g.ErrorCode]="ExtensibilityDialogLoadError",t)))},X="https://login.microsoftonline.com/common",ee=n(37602),te=n(58651),ne=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},oe=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ie=function(){function e(e){this.params=e}return e.prototype.loadMsalBrowser=function(){return ne(this,void 0,void 0,(function(){var e,t,o;return oe(this,(function(i){switch(i.label){case 0:e=1,i.label=1;case 1:if(!(e<=3))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),t=this,[4,n.e(717).then(n.bind(n,19072))];case 3:return t.msalModule=i.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(o=i.sent(),te.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),o),3===e)throw o;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.getAuthorityAsPerEnv=function(){var e;return!!(null===(e=this.params)||void 0===e?void 0:e.appEnvironment)&&this.params.appEnvironment.length>0&&this.params.appEnvironment===ee.D.DOD?"https://login.microsoftonline.us/common":X},e.prototype.createPublicClientApplication=function(e){return ne(this,void 0,void 0,(function(){var t,n,o,i,r;return oe(this,(function(a){return t=null!==(r=null===(i=this.params)||void 0===i?void 0:i.clientId)&&void 0!==r?r:"6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",n=this.params.redirectUri,o=this.getAuthorityAsPerEnv(),[2,new e({auth:{clientId:t,authority:o,redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})]}))}))},e.prototype.getToken=function(e,t,n){return ne(this,void 0,void 0,(function(){var t,o,i,r,a,s;return oe(this,(function(c){switch(c.label){case 0:return A("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:c.sent(),c.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=c.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(s=this.params)||void 0===s?void 0:s.logTelemetry)&&l.sendChatEventTelemetry(x(((a={})[p.ChatEventType]=h.MSALTokenRequested,a))),o=void 0,c.label=4;case 4:return c.trys.push([4,10,,14]),[4,t.initialize()];case 5:return c.sent(),0!==(null==(i=t.getAllAccounts())?void 0:i.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,c.sent()];case 7:return[4,this.getSelectedAccount(i,t)];case 8:if(!(o=c.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[4,this.acquireTokenSilent(e,o,t,n)];case 9:return[2,c.sent()];case 10:return r=c.sent(),A("Failed to get access token: ".concat(null==r?void 0:r.message)),this.msalModule&&r instanceof this.msalModule.InteractionRequiredAuthError?[4,this.acquireTokenPopup(e,o,t)]:[3,12];case 11:return[2,c.sent()];case 12:throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),r;case 13:return[3,14];case 14:return[2]}}))}))},e.prototype.getAccountInfoFromCache=function(){return ne(this,void 0,void 0,(function(){var e,t,n=this;return oe(this,(function(o){switch(o.label){case 0:return this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:o.sent(),o.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(e=o.sent()))throw this.logTokenAcquiredError("Failed to get account info - Could not load msal module"),new Error("Failed to get account info - Could not load msal module");return[4,e.initialize()];case 4:return o.sent(),[2,null!==(t=e.getAllAccounts().find((function(e){var t,o,i;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(i=null===(o=n.params)||void 0===o?void 0:o.userPrincipalName)||void 0===i?void 0:i.toLowerCase())})))&&void 0!==t?t:null]}}))}))},e.prototype.getSelectedAccount=function(e,t){return ne(this,void 0,void 0,(function(){var n,o,i,r,a=this;return oe(this,(function(s){switch(s.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(i=s.sent())?void 0:i.account];case 2:if(!e||0===e.length)return[2,null];if(n=this.params?null!==(r=e.find((function(e){var t,n,o;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(o=null===(n=a.params)||void 0===n?void 0:n.userPrincipalName)||void 0===o?void 0:o.toLowerCase())})))&&void 0!==r?r:null:e[0],n)return[2,n];o=this.params?{loginHint:this.params.userPrincipalName}:void 0,s.label=3;case 3:return s.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(o),[4,this.loginPopupPromise];case 4:return[2,null==(i=s.sent())?void 0:i.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){return ne(this,void 0,void 0,(function(){var n,o,i;return oe(this,(function(r){switch(r.label){case 0:return n={scopes:["".concat(e,"/.default")],loginHint:null===(i=this.params)||void 0===i?void 0:i.userPrincipalName},[4,t.ssoSilent(n)];case 1:return(o=r.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,o]}}))}))},e.prototype.acquireTokenSilent=function(e,t,n,o){return ne(this,void 0,void 0,(function(){var i,r;return oe(this,(function(a){switch(a.label){case 0:return i={scopes:null!=o?o:["".concat(e,"/.default")],account:t},[4,n.acquireTokenSilent(i)];case 1:return(r=a.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,r]}}))}))},e.prototype.acquireTokenPopup=function(e,t,n){return ne(this,void 0,void 0,(function(){var o,i;return oe(this,(function(r){switch(r.label){case 0:return o={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenPopup(o)];case 1:return(i=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,i]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,n;(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&l.sendErrorTelemetry(x(((t={})[g.ErrorCategory]=f.MSAL,t[g.ErrorMessage]=e,t)))},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(R||(R={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(H||(H={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(F||(F={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(U||(U={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(q||(q={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(B||(B={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(j||(j={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}(z||(z={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(G||(G={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(W||(W={})),function(e){e.Image="IMAGE",e.Video="VIDEO"}(Q||(Q={})),function(e){e.KeepIt="KeepIt",e.Undo="Undo",e.Insert="Insert",e.Copy="Copy",e.Custom="Custom",e.CustomiPad="CustomiPad",e.None="None"}(J||(J={})),function(e){e.Activated="Activated",e.Removed="Removed",e.ActivateCopilotAgent="activateCopilotAgent",e.RemoveCopilotAgent="removeCopilotAgent"}(V||(V={})),function(e){e.BizchatHostContextUpdate="BizChatHostContextUpdate"}(K||(K={})),function(e){e[e.LaunchMos=2001]="LaunchMos",e[e.GetFullDocumentHtml=2003]="GetFullDocumentHtml",e[e.InvokeCanvasTool=2004]="InvokeCanvasTool",e[e.ReadAloud=2005]="ReadAloud"}(Y||(Y={}));var re=n(86092);function ae(e){return null==e}var se=function(){return"undefined"!=typeof OfficeaicopilotStrings};var ce,le,ue=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","zh-CN"],de=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","pt-PT","ru-RU","sv-SE","th-TH","tr-TR","uk-UA","zh-TW"],fe=["ar-SA","he-IL"],pe=["ca-ES","cy-GB"],he=["bg-BG","el-GR","et-EE","hr-HR","id-ID","lt-LT","lv-LV","ro-RO","sk-SK","sl-SI","sr-Latn-RS","vi-VN"],ge=["sq-AL","fil-PH","is-IS","kk-KZ","ms-MY","mt-MT","sr-Cyrl-RS"],ve=(ce=function(e,t){return ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ce(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ce(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ve(t,e),t}(function(e){function t(t,n){var o=e.call(this,n)||this;return o.name=t,o}return ve(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(le||(le={}));(function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.isTier4LanguagesEnabled=!1,this.supportedLanguages=[]}Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier4LanguagesEnabled",{set:function(e){this.isTier4LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var n=1;n<t.length-1;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),n=0;n<this.supportedLanguages.length;n++){var o=this.supportedLanguages[n];if(t[0]===o.split("-")[0])return o}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new ye(le.InvalidInput," Display Language is undefined or null");var n=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(n),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.supportedLanguages=ue,this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(de),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(fe))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(he)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(pe)),this.isTier4LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(ge))}})(),n(58651);new(function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}())({iteration:0});var be=function(){function e(){}return e.isWebPlatform=function(){return Office.context.platform===Office.PlatformType.OfficeOnline},e.isMacPlatform=function(){return Office.context.platform===Office.PlatformType.Mac},e.isIOSPlatform=function(){return Office.context.platform===Office.PlatformType.iOS},e.isWin32Platform=function(){return Office.context.platform===Office.PlatformType.PC},e}();be.isWebPlatform,be.isMacPlatform,be.isIOSPlatform;var me,Ce=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Ee=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(){this.apiHandlers=new Map}e.getInstance=function(){return e.PrivateApi||(e.PrivateApi=new e),e.PrivateApi},e.prototype.initializePrivateApi=function(){return Ce(this,arguments,void 0,(function(e){var t,n=this;return void 0===e&&(e=0),Ee(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(t){return Ce(n,void 0,void 0,(function(){var n,o,i;return Ee(this,(function(r){switch(r.label){case 0:return A("PrivateApi event: "+t),e>0?[4,new Promise((function(t){return setTimeout(t,e)}))]:[3,2];case 1:r.sent(),r.label=2;case 2:n=!1;try{o=JSON.parse(t)}catch(e){o=null}return(null==o?void 0:o.eventName)&&(i=this.apiHandlers.get(o.eventName))&&i instanceof Function&&(i(o),n=!0),n||A("Could not dispatch PrivateApi event"),[2]}}))}))}))];case 1:return o.sent(),[3,3];case 2:return t=o.sent(),A("Error initializing PrivateApi: "+t),[3,3];case 3:return[2]}}))}))},e.prototype.openMOSDialog=function(){return Ce(this,void 0,void 0,(function(){var e;return Ee(this,(function(t){switch(t.label){case 0:return e={dispidMethod:Y.LaunchMos},[4,this.execute(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getFullDocumentHtml=function(){return Ce(this,void 0,void 0,(function(){var e;return Ee(this,(function(t){return e={dispidMethod:Y.GetFullDocumentHtml},[2,this.execute(e)]}))}))},e.prototype.execute=function(e){return Ce(this,void 0,void 0,(function(){return Ee(this,(function(t){return[2,OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))]}))}))},e.prototype.triggerReadAloud=function(){return Ce(this,void 0,void 0,(function(){var e;return Ee(this,(function(t){return e={dispidMethod:Y.ReadAloud},[2,this.execute(e)]}))}))},e.prototype.attachPrivateEventHandler=function(e,t){this.apiHandlers.has(e)&&A("Overwriting PrivateApi event handler for "+e),this.apiHandlers.set(e,t)}}();!function(e){e.LAUNCH_WITH_REVIEWERS="LAUNCH_WITH_REVIEWERS",e.LAUNCH_WITHOUT_REVIEWERS="LAUNCH_WITHOUT_REVIEWERS",e.LAUNCH_FROM_TOGGLE="LAUNCH_FROM_TOGGLE"}(me||(me={}));var Ie,Le;!function(e){e.IsCustomGPTsEnabled="IsCustomGPTsEnabled",e.IsAgentDiscoverabilityZQMEnabled="IsAgentDiscoverabilityZQMEnabled",e.IsClickButtonStyleHamburgerEnabled="IsClickButtonStyleHamburgerEnabled",e.ShowAgentMenuNudgeAndTooltip="ShowAgentMenuNudgeAndTooltip",e.ShowAgentMenuExploreBadge="ShowAgentMenuExploreBadge",e.EnableUniqueDateCheckForStoreCardZQPrompt="EnableUniqueDateCheckForStoreCardZQPrompt",e.EnableInsightsCardAgents="EnableInsightsCardAgents",e.ShowAtMentionMenuZQPrompt="ShowAtMentionMenuZQPrompt"}(Ie||(Ie={})),function(e){e.EnableSystemMessageActions="EnableSystemMessageActions",e.IsInsertImageEnabledForDAs="IsInsertImageEnabledForDAs",e.DisableACHorizontalScroll="DisableACHorizontalScroll",e.DisableFooterActionsForAdaptiveCard="DisableFooterActionsForAdaptiveCard",e.EnableDynamicHostWidthForAC="EnableDynamicHostWidthForAC",e.EnableNewRegexForVCPromptExtraction="EnableNewRegexForVCPromptExtraction",e.ShowStoreLauncherZQPrompt="ShowStoreLauncherZQPrompt",e.ShowVisualCreatorZQPrompt="ShowVisualCreatorZQPrompt",e.EnableAgentSwitchInCatalyst="EnableAgentSwitchInCatalyst"}(Le||(Le={}));var Se=n(23212),Ae="HandoffMessageId",we=function(){function e(){}return e.getSettingAsString=function(e){if((0,Se.isTest)())return"TestSetting";var t=Office.context.hostSettings.get(e);return ae(t)?t:t.toString()},e.getSetting=function(e){return Office.context.hostSettings.get(e.toString())},e.removeSetting=function(e){"undefined"!=typeof Office&&Office.context&&Office.context.hostSettings&&Office.context.hostSettings.remove(e)},e.set=function(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setByKey=function(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setHostSettings=function(e){var t=this;Object.keys(e).forEach((function(n){var o,i=("string"==typeof(o=e[n])&&o.length>=2&&o.startsWith('"')&&o.endsWith('"')&&(o=o.slice(1,-1)),o);t.setByKey(n,i)}))},e.IsSettingTrue=function(e){var t=this.getSettingAsString(e);return!!t&&"true"===t.toLowerCase()},e}();var Te,Pe=n(58651),ke=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},_e=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};(function(){function e(e){var t=this;this.theme=void 0,this.platform=Office.context.platform,this.themeChangeObserver=void 0,this.registerThemeChangeEventCallback=function(){return ke(t,void 0,void 0,(function(){var e;return _e(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeEventCallback)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},this.themeChangeEventCallback=function(e){Pe.log("OfficeTheme Changed"),t.theme=t.buildOfficeTheme(e),t.themeChangeObserver.update(t.theme)},this.themeChangeObserver=e,this.platform===F.win32?this.handleDefaultThemeChange():this.platform===F.mac&&this.handleMacThemeChange()}e.getInstance=function(t){return e.instance||(this.instance=new e(t)),e.instance},e.prototype.handleDefaultThemeChange=function(){this.theme=this.buildOfficeTheme(),this.themeChangeObserver.update(this.theme),this.registerThemeChangeEventCallback().catch((function(e){}))},e.prototype.handleMacThemeChange=function(){var e,t,n=this;null===(t=null===(e=Office.context)||void 0===e?void 0:e.themeManager)||void 0===t||t.getOfficeThemeAsync((function(e){"succeeded"===e.status&&(n.theme=n.buildOfficeTheme(e.value),n.themeChangeObserver.update(n.theme),n.registerThemeChangeEventCallback().catch((function(e){})))}))},e.prototype.buildOfficeTheme=function(e){return e?{controlForegroundColor:e.officeTheme.controlForegroundColor,controlBackgroundColor:e.officeTheme.controlBackgroundColor,bodyForegroundColor:e.officeTheme.bodyForegroundColor,bodyBackgroundColor:e.officeTheme.bodyBackgroundColor}:{controlForegroundColor:Office.context.officeTheme.controlForegroundColor,controlBackgroundColor:Office.context.officeTheme.controlBackgroundColor,bodyForegroundColor:Office.context.officeTheme.bodyForegroundColor,bodyBackgroundColor:Office.context.officeTheme.bodyBackgroundColor}}})(),(0,s.createContext)({officePlatform:F.web,officeTheme:void 0}),n(58651);!function(e){e.M365CopilotChat="M365CopilotChat",e.AppChat="AppChat",e.Researcher="Researcher",e.Analyst="Analyst",e.Disabled="Disabled"}(Te||(Te={}));var De,Oe=n(60623);(0,Oe.n)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}});!function(e){e.AutoOpenTTVR="visuallyReady",e.AutoOpenTTFR="functionallyReady"}(De||(De={}));var xe,Me="",Ne="shimmer";!function(e){e.AtMention="AtMention",e.SwitcherMenu="SwitcherMenu",e.FooterButton="FooterButton"}(xe||(xe={}));var Re="Copilot Extensions Dialog",He=function(){return se()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},Fe=n(70034),Ue=n(61714),qe=n(26739),Be=n(88290),je=n(30211),ze=function(e){A("setting ClpOfficeJSApiError to ".concat(e))},Ge=!1;function We(e,t){switch(e){case G.ApplyLabelUnsupportedCrossTenantErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored.";case G.ApplyLabelDocumentReadOnlyErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that can’t be applied when a file is read-only.";case G.ApplyLabelInsufficientPermissionErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file.";case G.ApplyLabelLabelDisabledErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account.";case G.ApplyLabelUnsupportedUdpErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions.";case G.ApplyLabelLabelingDisabledErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account.";case G.ApplyLabelUnsupportedContentTypeErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels.";case G.ApplyLabelUnsupportedDkeErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption.";case G.ApplyLabelLabelNotFoundErrorCode:case G.ErrorCode2147647531:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file.";case G.OsfControlContainerErrorCode:case G.OfficeSolutionFrameworkHostErrorCode:case G.DocCookieErrorCode:case G.HostIntegrationManagerErrorCode:case G.MsoOLDocumentErrorCode:case G.ClpSessionErrorCode:return He();case G.OMWorkflowUserNotFoundErrorCode:return se()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label.";case G.OMOfficePerpetualNotSupportedErrorCode:return se()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels.";case G.LabelingDisabledProtectedViewErrorCode:return se()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View.";case G.LabelingDisabledAppguardErrorCode:return se()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard.";case G.LabelingDisabledPrivacySettingsErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label.";case G.LabelingDisabledUnsupportedLabelClientErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels.";case G.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account.";case G.OMOfficeClientNotLicensedForLabelingErrorCode:return t===z.CLP_Get?Me:se()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account.";case G.PolicyManagerUnavailableErrorCode:return t===z.CLP_Get?Me:He();case G.ApplyLabelNewLabelSensitivityOrderErrorCode:return Me;case G.ErrorCode2147500033:default:return t===z.CLP_Get?Me:He()}}function Qe(e,t,n,o,i){void 0===i&&(i=!0);var r,a={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:qe.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:o?(r=o,r||(r=v.CopilotChat),JSON.stringify({featureName:r})):void 0},s=!0,c=Xe.getInstance();(null==c?void 0:c.getShouldStopLoadingUi)&&(s=c.getShouldStopLoadingUi());var u={chatCardType:Be._.Default,chatMessageData:{defaultMessageProps:{user:je.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:a,stopLoadingUi:s,startAugloopTimerForStreaming:!1,addCardToChatHistory:i};return function(e,t,n){var o,i;void 0===n&&(n=!0);var r={};if(t){l.sendChatEventTelemetry(x(((o={})[p.ChatEventType]=t.chatEventType,o[p.ChatEventParameters]=t.chatEventParam,o[p.ChatErrorType]=t.chatErrorType,o))),(i={})[d.ErrorType]=y.Client,i[d.ErrorParameter]=t.chatEventType,i[d.ErrorChatEventType]=t.chatEventType,i[d.ErrorChatEventParameter]=t.chatEventParam,r=i;var a=t.ashaErrorDetails;a&&M(a)}e&&(A("User Perceived Latency :  ".concat(w(_())," sec")),r[d.UserPerceivedLatency]=w(_()),r[d.IsQuerySuccess]=!1,l.sendLatencyTelemetry(x(r),n))}(t,n,!0),A("CLP error response message: ".concat(u)),u}function Je(e,t,n,o){var i,r,a;if(null===(a=null==e?void 0:e.current)||void 0===a?void 0:a.getIsExecuting()){var s=We(t,n);if(s){Ge&&ze(!0),A("clp error: ".concat(s)),function(e,t){var n,o={chatEventType:h.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:y.Client,ashaErrorDetails:{vetoName:N(E.UnclearIntent,m.UserInputIssue),errorString:I.SensitivityExecutionFailed,featureName:v.CopilotChat}};null===(n=null==e?void 0:e.current)||void 0===n||n.addResponseMessage(Qe(t,!0,o))}(e,s);var c=!0,u=Xe.getInstance();(null==u?void 0:u.getShouldStopLoadingUi)&&(c=u.getShouldStopLoadingUi()),o&&c&&o(),l.sendChatEventTelemetry(x(((i={})[p.ChatEventType]=h.CLPErrorShown,i[p.ChatEventParameters]=n+"_"+t,i)))}else A("clp error string is empty"),l.sendChatEventTelemetry(x(((r={})[p.ChatEventType]=h.CLPErrorIgnored,r[p.ChatEventParameters]=n+"_"+t,r)));return s}return Me}var Ve=function(){return Ve=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ve.apply(this,arguments)},Ke=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Ye=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ze=null,$e=(0,Ue.A)(),Xe=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:Me,tenantId:Me},this.externalDocLabelInfo={labelId:Me,tenantId:Me},this.inDocLabelInfo.labelId=Me,this.inDocLabelInfo.tenantId=Me,this.externalDocLabelInfo.labelId=Me,this.externalDocLabelInfo.tenantId=Me}return e.getInstance=function(t,n,o,i,r){return ae(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),ae(t)||(e.clpSensitivityHandler.setBasicChatProps=t),ae(n)||(e.clpSensitivityHandler.setChatUiProps=n),ae(o)||(e.clpSensitivityHandler.copilotChatRef=o),ae(i)||(e.clpSensitivityHandler.removeCurrentContextId=i),ae(r)||(e.clpSensitivityHandler.getShouldStopLoadingUi=r),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return Ke(this,void 0,void 0,(function(){var e,t,n;return Ye(this,(function(o){switch(o.label){case 0:if(null===(n=u.IsCopilotInBackstageMode)||void 0===n?void 0:n.call(u))return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=o.sent(),this.setInDocSensitivityLabelInfo(e),O("setInDocSensitiveLabelInfoUsingOfcJs"),[3,4];case 3:return t=o.sent(),D("error in getLabel Api: ".concat(t.message),t.code,t.stack),Je(this.copilotChatRef,t.code,z.CLP_Get,this.removeCurrentContextId),A("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return Ke(this,void 0,void 0,(function(){var e,t,n;return Ye(this,(function(o){switch(o.label){case 0:if(A("Getting label"),e={labelId:Me,tenantId:Me},null===(n=u.IsCopilotInBackstageMode)||void 0===n?void 0:n.call(u))return[2,e];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=o.sent(),O("getLabel"),[3,4];case 3:return t=o.sent(),D("error in getLabel Api : ".concat(t.message),t.code,t.stack),Je(this.copilotChatRef,t.code,z.CLP_Get,this.removeCurrentContextId),A("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return A("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;A("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(n){var i,r;return Ve(Ve({},n),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(i=e.description)&&void 0!==i?i:"",badgeText:null!==(r=e.displayName)&&void 0!==r?r:"",iconType:e.encryptionType!==o.None?Fe.JF.Encryption:Fe.JF.NonEncryption}:void 0})})),this.setChatUiProps&&this.shouldShowInDocSensitivityLabel()&&this.setChatUiProps((function(e){return Ve(Ve({},e),{documentSensitivityProps:t.getSensitivity()})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return Ke(this,void 0,void 0,(function(){var t;return Ye(this,(function(n){switch(n.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:Me}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):(A("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:n.sent(),this.labelChangedFromChatHistory=!1,n.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?(A("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return n.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){return Ke(this,arguments,void 0,(function(e,t){var n,o,r,a,s,c,l,d,f=this;return void 0===t&&(t=!1),Ye(this,(function(p){switch(p.label){case 0:if(O("tryUpgradeLabel"),t&&!function(e){var t,n=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;return null!=(null===(t=e.labelId)||void 0===t?void 0:t.match(n))}(e))return A("Invalid label",e),D("Invalid label format id: ".concat(e.labelId),i[i.E_APPLYLABEL_FAIL],""),[2,{status:i[i.E_APPLYLABEL_FAIL],errorMessage:"Invalid label format"}];if(null===(l=u.IsCopilotInBackstageMode)||void 0===l?void 0:l.call(u))return A("Upgrading sensitivity label disabled in backstage mode"),[2,{status:i[i.E_APPLYLABEL_FAIL],errorMessage:"disabled in backstage mode"}];A("Upgrading sensitivity label: ".concat(JSON.stringify(e))),n=i[i.S_APPLYLABEL_OK],o=Me,p.label=1;case 1:return p.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,$e)];case 2:return p.sent(),[2,{status:i[i.S_APPLYLABEL_OK]}];case 3:return r=function(){return Ke(f,void 0,void 0,(function(){return Ye(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,$e)]}catch(e){D("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code,e.stack),o=Je(this.copilotChatRef,e.code,z.CLP_Upgrade,this.removeCurrentContextId),A("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),n=e.message}return[2]}))}))},a=new Promise((function(e){Ze=e})),s=new Promise((function(e,t){setTimeout((function(){return t(new Error("CallbackTimeout"))}),3e4)})),[4,Promise.race([Promise.all([a,r()]),s])];case 4:p.sent(),p.label=5;case 5:return[3,7];case 6:return c=p.sent(),D("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(c.message),c.code,c.stack),Je(this.copilotChatRef,c.code,z.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===c.message?A("Callback Timeout"):A("Exception while upgrading sensitivity label: ".concat(c.message,", error code: ").concat(c.code)),n=null!==(d=i[c.message])&&void 0!==d?d:c.message,[3,7];case 7:return Ze=null,[2,{status:n,errorMessage:o}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){var t;if(null===(t=u.IsCopilotInBackstageMode)||void 0===t?void 0:t.call(u))A("setting label change EventListener disabled in backstage mode");else try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:et),O("Label Change Event Listener"),A("Sensitivity Label Change Event Listener Set")}catch(e){D("error in setting listener for CLP : ".concat(e.message),e.code,e.stack),Je(this.copilotChatRef,e.code,z.CLP_Upgrade,this.removeCurrentContextId),A("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return Ke(this,void 0,void 0,(function(){var t,n,o;return Ye(this,(function(i){switch(i.label){case 0:if(null===(o=u.IsCopilotInBackstageMode)||void 0===o?void 0:o.call(u))return A("update external doc sensitivity label disabled in backstage mode"),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=i.sent(),A("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),O("External Doc HighestSensitivityLabel"),[3,4];case 3:return n=i.sent(),D("error in HighestSensitivityLabel Api : ".concat(n.message),n.code,n.stack),Je(this.copilotChatRef,n.code,z.CLP_Get,this.removeCurrentContextId),A("Error while updating external doc sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return Ke(this,void 0,void 0,(function(){return Ye(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return Ke(this,void 0,void 0,(function(){var t,n,o;return Ye(this,(function(i){switch(i.label){case 0:if(t={labelId:Me,tenantId:Me},null===(o=u.IsCopilotInBackstageMode)||void 0===o?void 0:o.call(u))return A("getHighestDocumentSensitivityInfo disabled in backstage mode"),[2,t];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=i.sent(),A("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),O("HighestSensitivityLabel"),[3,4];case 3:return n=i.sent(),D("error in HighestSensitivityLabel Api : ".concat(n.message),n.code,n.stack),Je(this.copilotChatRef,n.code,z.CLP_Get,this.removeCurrentContextId),A("Error while fetching highest sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return Ke(this,void 0,void 0,(function(){var t;return Ye(this,(function(n){switch(n.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=n.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==o.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){A("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return O("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===Me)),this.externalDocLabelInfo.labelId!==Me&&u.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return O("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===Me)),this.inDocLabelInfo.labelId!==Me&&u.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==o.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==o.None},e}();function et(e,t,n,o){return Ke(this,void 0,void 0,(function(){return Ye(this,(function(r){switch(r.label){case 0:return A("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(o)),O("Label change callback received, context:  ".concat(n)),Ze&&n===$e&&(Ze("ignore"),Ze=null),o!==i.S_APPLYLABEL_OK?(D("error in upgrading label : ".concat(o),o.code,o.stack),[2]):u.IsClpEnabledInEnterpriseForSydney()&&(Xe.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,Xe.getInstance().setSensitivityLabelToHighestSensitivity([Xe.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return r.sent(),[2];case 2:return u.IsApplyLabelUsingTryUpgradeLabelEnabled(),Xe.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}var tt=n(82755),nt=n(46692),ot=n(12163),it=function(){return it=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},it.apply(this,arguments)},rt=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},at=function(){function e(){}return e.prototype.sendTelemetryEvent=function(e){"undefined"!=typeof Office&&Office.sendTelemetryEvent(e)},e}(),st=(function(){function e(){this.alwaysCriticalEvents=null,this.oTelLogger=new tt.M,this.telemSink=new at,this.setupTelemetryLogger(this.oTelLogger)}e.prototype.getDefaultEventFlags=function(){return{dataCategories:nt.o.DataCategories.ProductServicePerformance|nt.o.DataCategories.ProductServiceUsage,diagnosticLevel:nt.o.DiagnosticLevel.RequiredServiceData}},e.prototype.getTelemetrySink=function(){return this.telemSink},e.prototype.sendTelemetryEvent=function(e){this.isAlwaysCriticalEvent(e)&&(e.eventFlags.samplingPolicy=nt.o.SamplingPolicy.CriticalUsage),this.oTelLogger.sendTelemetryEvent(e)},e.prototype.logEvent=function(e,t){this.logTelemetryEvent(e,t)},e.prototype.logUncaughtException=function(e){var t=[],n="";e instanceof Error&&(e.message&&(n=e.message),e.stack&&t.push({key:"Stack",value:e.stack})),this.logTelemetryErrorEvent({eventType:f.UncaughtException,errorMessage:n,logLevel:L.Critical},void 0,t)},e.prototype.logError=function(e,t,n){this.logTelemetryErrorEvent(e,t,n)},e.prototype.isAlwaysCriticalEvent=function(e){return!1},e.prototype.getTelemetryProperties=function(){return{ariaTenantToken:e.AriaTenantToken,nexusTenantToken:e.NexusTenantToken}},e.prototype.getDefaultEventDataFields=function(){return this.getDataFields(this.getDefaultTelemetryData())},e.prototype.getDefaultTelemetryData=function(){return[{key:"UserQueryGuid",value:e.userQueryGuid}]},e.prototype.logTelemetryEvent=function(e,t){var n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?it(it({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:rt(rt([],this.getDefaultEventDataFields(),!0),this.getDataFields(e.eventData||[]),!0)};this.sendTelemetryEvent(n)},e.prototype.getActionAITelemetryErrorEvent=function(e,t,n){return n||(n=[]),n.find((function(e){return"Message"===e.key}))||n.push({key:"Message",value:e.errorMessage}),n.find((function(e){return"LogLevel"===e.key}))||n.push({key:"LogLevel",value:e.logLevel}),{eventName:"Office.Voice.ActionAI."+f.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?it(it({},this.getDefaultEventFlags()),t):this.getDefaultEventFlags(),dataFields:rt(rt([],this.getDefaultEventDataFields(),!0),this.getDataFields(n),!0)}},e.prototype.logTelemetryErrorEvent=function(e,t,n){this.oTelLogger.sendError(this.getActionAITelemetryErrorEvent(e,t,n))},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?(0,ot.ip)(e.key,e.value):"string"==typeof e.value?(0,ot.m9)(e.key,e.value):"boolean"==typeof e.value?(0,ot.LK)(e.key,e.value):(0,ot.m9)(e.key,String(e.value))}))},e.prototype.setupTelemetryLogger=function(t){t.setTenantToken("Office.Voice.ActionAI",e.AriaTenantToken,e.NexusTenantToken),t.setTenantToken("Office.Voice.Copilot",e.AriaTenantToken,e.NexusTenantToken),t.addSink(this.telemSink)},e.prototype.getLogLevelForErrorCategory=function(e){return L.Error},e.AriaTenantToken="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",e.NexusTenantToken=1763,e.userQueryGuid="",e.userQueryOrder=0,e.conversationId=void 0}(),n(56241)),ct=n(18313),lt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ut=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},dt=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(e){function t(t){var n=e.call(this,t)||this;return n.handleRefreshButtonOnClick=function(){window.location.reload()},n.handleCopyErrorButtonOnClick=function(){return ut(n,void 0,void 0,(function(){var e,t,n,o,i,r,a,s;return dt(this,(function(c){switch(c.label){case 0:e=null!==(r=null===(i=this.state.error)||void 0===i?void 0:i.message)&&void 0!==r?r:"No error message",t=null!==(s=null===(a=this.state.error)||void 0===a?void 0:a.stack)&&void 0!==s?s:"No error stack",n="Error Message: "+e+"\n Error Stack: "+t,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(n)];case 2:return c.sent(),[3,4];case 3:return o=c.sent(),A("ErrorBoundary: Error in handleCopyErrorButtonOnClick -> error",o),[3,4];case 4:return[2]}}))}))},n.state={hasError:!1,error:void 0},n}lt(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t.prototype.componentDidCatch=function(e){var t;A("ErrorBoundary caught an error ",e),null===(t=window.document.getElementById(Ne))||void 0===t||t.style.setProperty("display","none"),this.props.errorLogOverride?this.props.errorLogOverride(e):function(e){var t;l.sendChatEventTelemetry(x(((t={})[p.ChatEventType]=h.ErrorBoundaryCaughtError,t[p.ChatEventParameters]=e,t))),M({vetoName:N(E.UnclearIntent,m.UnclassifiedError),errorString:I.UnexpectedFailure,featureName:v.CopilotChat})}(e.name+": "+e.message)},t.prototype.render=function(){return this.state.hasError?s.createElement(ct.q,{theme:this.props.copilotChatTheme,dir:this.props.copilotChatTheme.dir},s.createElement(st.A,{handleRefreshButtonOnClick:this.handleRefreshButtonOnClick,handleErrorButtonOnClick:this.handleCopyErrorButtonOnClick,errorBoundaryImagePath:this.props.errorBoundaryImagePath})):this.props.children}}(s.Component);var ft=n(14168),pt=n(48854),ht=function(e){};(0,ft.mL)(pt.N,{currentLocale:void 0,strings:{},errorHandler:ht,loaders:[],stringMapInitialized:!1});var gt,vt=n(11475);!function(e){e[e.Idle=0]="Idle",e[e.ScopeStarted=1]="ScopeStarted",e[e.HasAction=2]="HasAction",e[e.ShowButton=3]="ShowButton"}(gt||(gt={}));(function(){function e(){this.addinUndoState=gt.Idle,this.isAddinFlowActive=!1}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getCurrentAddinState=function(){return this.addinUndoState},e.prototype.isAddinFlow=function(){return this.isAddinFlowActive},e.prototype.setIsAddinFlow=function(e,t){this.isAddinFlowActive=e,null==t||t()},e.prototype.transitionAddinState=function(e,t){this.addinUndoState!==e&&(this.addinUndoState=e,null==t||t())},e.prototype.checkAndSetIsUndoableActionPresent=function(){this.getCurrentAddinState()===gt.ScopeStarted&&this.transitionAddinState(gt.HasAction)},e})().getInstance(),n(883);var yt=n(63461),bt=n(30743),mt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Ct=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(e,t){this.bizChatALSession=null,this.handoffAnnotationTokens=new Map,this.initStartTime=0,this.sessionCreationTime=0,this.annotationRegistrationStartTime=0,this.handleResponseItem=e,this.config=t}e.prototype.doInitializeBizChatALSession=function(){return mt(this,void 0,void 0,(function(){var e,t,n,o,i,r,a,s,c,l,u,d;return Ct(this,(function(f){switch(f.label){case 0:this.initStartTime=Date.now(),f.label=1;case 1:return f.trys.push([1,8,,9]),this.config.utils.debugLog("Initializing BizChatAL AL session"),this.config.telemetryEventHandler.updateTelemetryChatEventData(((s={})[this.config.constants.ChatEventsKeys.ChatEventType]=this.config.constants.ChatEventType.BizChatALSessionInitializationStarted,s[this.config.constants.ChatEventsKeys.ChatEventParameters]="BizChatAL AL Session Initialization Started",s),this.config.telemetryLogger.getInstance()),e=Date.now(),this.config.sessionProvider?(this.config.utils.debugLog("Using external AL session for BizChatAL"),t=this,[4,this.config.sessionProvider.getALSession()]):[3,3];case 2:return t.bizChatALSession=f.sent(),[3,4];case 3:this.config.utils.debugLog("Creating dedicated AL session for BizChatAL"),n=this.config.hostAppSettings.getSettingAsString(this.config.augloopSharedSessionIDSettingName),this.bizChatALSession=(0,bt.wB)(this.config.utils.isNullOrUndefined(n)?"ALDummySession_BizChatAL":"".concat(n,"_BizChatAL")),f.label=4;case 4:return this.sessionCreationTime=Date.now()-e,this.config.telemetryEventHandler.updateTelemetryLatencyData(((c={})[this.config.constants.LatencyKeys.BizChatALSessionCreationTime]=this.sessionCreationTime/1e3,c),this.config.telemetryLogger.getInstance()),this.bizChatALSession?(this.annotationRegistrationStartTime=Date.now(),[4,this.registerHandoffAnnotations()]):[3,6];case 5:return f.sent(),o=Date.now()-this.initStartTime,i=Date.now()-this.annotationRegistrationStartTime,this.config.telemetryEventHandler.updateTelemetryLatencyData(((l={})[this.config.constants.LatencyKeys.BizChatALTotalInitializationTime]=o/1e3,l[this.config.constants.LatencyKeys.BizChatALAnnotationRegistrationTime]=i/1e3,l[this.config.constants.LatencyKeys.BizChatALHandoffAnnotationCount]=this.handoffAnnotationTokens.size,l),this.config.telemetryLogger.getInstance()),this.config.telemetryEventHandler.updateTelemetryChatEventData(((u={})[this.config.constants.ChatEventsKeys.ChatEventType]=this.config.constants.ChatEventType.BizChatALSessionInitializationCompleted,u[this.config.constants.ChatEventsKeys.ChatEventParameters]=JSON.stringify({totalTimeMs:o,sessionCreationTimeMs:this.sessionCreationTime,annotationRegistrationTimeMs:i,annotationsRegistered:this.handoffAnnotationTokens.size}),u),this.config.telemetryLogger.getInstance()),this.config.utils.debugLog("BizChatAL AL session initialized successfully. Total time: ".concat(o,"ms, Session creation: ").concat(this.sessionCreationTime,"ms, Annotation registration: ").concat(i,"ms")),[3,7];case 6:throw new Error("Failed to create BizChatAL AL session");case 7:return[3,9];case 8:throw r=f.sent(),a=Date.now()-this.initStartTime,this.config.utils.debugLog("Failed to initialize BizChatAL AL session: ".concat(r)),this.config.telemetryEventHandler.updateTelemetryChatEventData(((d={})[this.config.constants.ChatEventsKeys.ChatEventType]=this.config.constants.ChatEventType.BizChatALSessionInitializationFailed,d[this.config.constants.ChatEventsKeys.ChatEventParameters]=JSON.stringify({error:r instanceof Error?r.message:String(r),initTimeMs:a}),d),this.config.telemetryLogger.getInstance()),r;case 9:return[2]}}))}))},e.prototype.registerHandoffAnnotations=function(){return mt(this,void 0,void 0,(function(){var e,t,n,o,i=this;return Ct(this,(function(r){switch(r.label){case 0:if(!this.bizChatALSession)throw new Error("BizChatAL AL session not initialized");this.config.utils.debugLog("Registering handoff annotations for BizChatAL"),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this.bizChatALSession.activateAnnotation(yt.uC.getTypeName(),{callback:function(e){return mt(i,void 0,void 0,(function(){var t,n,o;return Ct(this,(function(i){if(this.config.utils.debugLog("Received HandoffMessage annotation"),e.items)for(t=0,n=e.items;t<n.length;t++)(o=n[t]).body&&yt.uC.typeGuard(o.body)&&(this.config.utils.debugLog("Processing HandoffMessage item"),this.handleResponseItem(o,""));return[2]}))}))}})];case 2:return e=r.sent(),this.handoffAnnotationTokens.set("HandoffMessage",e.token),[4,this.bizChatALSession.activateAnnotation(yt.dF.getTypeName(),{callback:function(e){return mt(i,void 0,void 0,(function(){return Ct(this,(function(e){return this.config.utils.debugLog("Received HandoffDocUrlAnnotation annotation"),[2]}))}))}})];case 3:return t=r.sent(),this.handoffAnnotationTokens.set("HandoffDocUrlAnnotation",t.token),[4,this.bizChatALSession.activateAnnotation(yt.kp.getTypeName(),{callback:function(e){return mt(i,void 0,void 0,(function(){return Ct(this,(function(e){return this.config.utils.debugLog("Received HandoffOutboundMessage annotation"),[2]}))}))}})];case 4:return n=r.sent(),this.handoffAnnotationTokens.set("HandoffOutboundMessage",n.token),this.config.utils.debugLog("Successfully registered ".concat(this.handoffAnnotationTokens.size," handoff annotations for BizChatAL")),[3,6];case 5:throw o=r.sent(),this.config.utils.debugLog("Failed to register handoff annotations: ".concat(o)),o;case 6:return[2]}}))}))},e.prototype.initializeBizChatALSession=function(){return mt(this,void 0,void 0,(function(){return Ct(this,(function(e){return[2,this.doInitializeBizChatALSession()]}))}))},e.prototype.getBizChatALSession=function(){return this.bizChatALSession},e.prototype.isInitialized=function(){return null!==this.bizChatALSession},e.prototype.getPerformanceMetrics=function(){return{sessionCreationTime:this.sessionCreationTime,totalInitTime:this.initStartTime>0?Date.now()-this.initStartTime:0,annotationsCount:this.handoffAnnotationTokens.size}}}();new Set([vt.n3.TriggerConfirmation,vt.n3.TriggerPluginAuth,vt.n3.TriggerPlugin]);var Et,It=n(85659),Lt=n(28515),St=n(84567);!function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(Et||(Et={}));var At,wt;!function(e){e.CrossAppCanvasHandoff="CrossAppCanvasHandoff",e.CrossAppHandoff="CrossAppHandoff",e.InAppHandoff="InAppHandoff"}(At||(At={})),function(e){e.TellMe="TellMe",e.WordCopilotComposeSelection="WordCopilotComposeSelection",e.ContextMenuRewriteClickAction="ContextMenuRewriteClickAction",e.WordCopilotRewriteSelection="WordCopilotRewriteSelection",e.SkittleContextMenuUserClickAction="SkittleContextMenuUserClickAction",e.WordCopilotComprehensionPodcast="WordCopilotComprehensionPodcast",e.ResearcherAgent="ResearcherAgent",e.CopilotContextMenuClickAction="CopilotContextMenuClickAction"}(wt||(wt={}));var Tt=[wt.WordCopilotComprehensionPodcast],Pt=new Map([[wt.TellMe,Te.M365CopilotChat],[wt.WordCopilotComposeSelection,Te.M365CopilotChat],[wt.ContextMenuRewriteClickAction,Te.M365CopilotChat],[wt.WordCopilotRewriteSelection,Te.M365CopilotChat],[wt.SkittleContextMenuUserClickAction,Te.M365CopilotChat],[wt.ResearcherAgent,Te.M365CopilotChat],[wt.CopilotContextMenuClickAction,Te.M365CopilotChat],[wt.WordCopilotComprehensionPodcast,Te.AppChat]]),kt=function(){return kt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},kt.apply(this,arguments)};function _t(e,t){return void 0===t&&(t=!1),!!e&&(!(!t&&e.toLowerCase()===Lt.Ww.NONE)&&Object.values(Lt.Ww).some((function(t){return t===e.toLowerCase()})))}function Dt(e){var t;return kt(kt({scenarioName:Lt.Cu.NONE},e),null!==(t=e.properties)&&void 0!==t?t:{})}function Ot(e,t,n){var o,i,r,a,s;if(!e.isBizChatinSDXEnabled||e.fallbackHandoffsToAppChat||!t)return Te.AppChat;var c=null!==(a=null!==(i=null===(o=null==n?void 0:n.PrimaryUserAccountInfo)||void 0===o?void 0:o.AggregatedLicensedFeatures)&&void 0!==i?i:null===(r=null==n?void 0:n.PrimaryUserAccountInfo)||void 0===r?void 0:r.LicensedFeatures)&&void 0!==a?a:void 0;return!e.shouldCheckUserLicense||(!!(null==c?void 0:c.includes("Copilot"))||!!(null==c?void 0:c.includes("CopilotStarter")))?e.shouldDefaultToBizChat?Tt.includes(t.featureName)?Te.AppChat:Te.M365CopilotChat:null!==(s=Pt.get(t.featureName))&&void 0!==s?s:Te.AppChat:Te.AppChat}var xt=n(15365),Mt=n(87452),Nt=n(62242),Rt=function(e,t,n,o){var i,r;return n?!!o||(e("Conversation ID handoff unsucessful - no submitOperation function defined"),null==t||t.sendChatEventTelemetry(x(((r={})[p.ChatEventType]=h.SubmitOperationUndefined,r))),!1):(e("Unable to update chat session ID, updateChatSessionId is undefined"),null==t||t.sendChatEventTelemetry(x(((i={})[p.ChatEventType]=h.CannotUpdateChatSessionId,i))),!1)},Ht=function(e,t){var n,o,i={pageSize:Ut,syncState:void 0},r={type:xt.S5.GetMessagesOperation,chatSessionId:e,paging:i,setSessionAsCurrent:!0,gptId:(0,Nt.Z)()};return new Mt.T({operation:r,documentURLOrLocalPath:null===(n=t.properties)||void 0===n?void 0:n.destinationDocUrl,timestamp:Date.now(),documentSensitivity:null===(o=t.properties)||void 0===o?void 0:o.sensitivityLabel,orchestratorGroundingMode:void 0,isFluxChatHistoryAnnotationActivated:!1,caller:qt})},Ft=function(e,t){return{operation:new St.g0({parentPath:["Signal",Mt.T.getTypeName()],items:[{id:k.generateId(),body:Ht(e,t)}]}),workflowAnnotationType:Mt.T.getTypeName()}},Ut=10,qt="handoff",Bt=function(){return Bt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Bt.apply(this,arguments)},jt=(function(){function e(e,t){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set,this.flights={};var n=this.getDocumentHandoffMessageId();n&&this.pendingHandoffMessageIds.add(n),this.flights=e.getFlights(),this.telemetryHandler=t}e.prototype.getDocumentHandoffMessageId=function(){var e=we.getSettingAsString(Ae);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var n=(0,Ue.A)(),o=this.getHandoffMessageIdSignal(n,t,e),i=new St.g0({parentPath:["Signal",yt.uC.getTypeName()],items:[{id:k.generateId(),body:o}]});e===It.Q.GET&&this.trackHandoffMessageIdSignal(n,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(o.H_.T_,{operation:i,workflowAnnotationType:yt.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(o)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.getBizChatProperties=function(e){return e},e.prototype.switchChatExperienceIfNeeded=function(e,t,n){this.flights.enableHandoffALBridge&&this.flights.enableBizchatHostContext&&function(e,t,n,o){var i,r=o.useHandoffMessagePropertiesValue?Dt(e):e,a=void 0;try{a=r.context?JSON.parse(r.context):void 0}catch(e){return void n("Handoff context could not be parsed - unable to switch chat experience")}t.setBizChatHostContext&&t.setBizChatHostContext({PrimaryUserAccountInfo:kt(kt({},null===(i=t.bizChatHostContext)||void 0===i?void 0:i.PrimaryUserAccountInfo),{CopilotExperience:Ot(o,a,t.bizChatHostContext)})})}(e,{setBizChatHostContext:t,bizChatHostContext:n},this.HandoffOperations.logDebug,this.flights)},e.prototype.receiveHandoffAnnotation=function(e,t){this.HandoffOperations.onAnnotationReceived(yt.uC.getTypeName(),e,this.handoffMessageIdRequestSubmitTime,t)},e.prototype.handleBizChatHandoffIfEnabled=function(e,t,n){var o;if(this.flights.handoffToBizChatEnabled&&this.flights.enableHandoffALBridge&&n&&e){var i=void 0;if(this.flights.useHandoffMessagePropertiesValue)i=this.getBizChatProperties(Dt(e));else{var r=Bt({scenarioName:Lt.Cu.NONE},e);if(e.properties)for(var a=0,s=Object.keys(e.properties);a<s.length;a++){var c=s[a];void 0===r[c]&&(r[c]=e.properties[c])}i=this.getBizChatProperties(r)}try{var l=JSON.parse(null!==(o=null==i?void 0:i.context)&&void 0!==o?o:"");if(function(e,t,n){return Ot(e,t,n)===Te.M365CopilotChat}(this.flights,l,t))return n(i),!0}catch(e){return!0}}return!1},e.prototype.handleHandoffMessage=function(e,t,n,o,i,r,a){void 0===n&&(n=!1);try{if(!(null==e?void 0:e.body)||!yt.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var s=e.body;if(this.switchChatExperienceIfNeeded(s,i,r),this.receiveHandoffAnnotation(s,t),this.handleBizChatHandoffIfEnabled(s,r,a))return;var c=function(e,t){var n;return void 0===t&&(t=!1),e.scenarioName===Lt.Cu.INAPP||(null===(n=e.properties)||void 0===n?void 0:n.scenarioName)===Lt.Cu.INAPP?At.InAppHandoff:t?At.CrossAppCanvasHandoff:At.CrossAppHandoff}(s,n);switch(c){case At.InAppHandoff:return void this.processHandoffMessage(s);case At.CrossAppCanvasHandoff:return this.renderChatHistory(s,o),this.renderClosingBookending(s),void this.processHandoffMessage(s);case At.CrossAppHandoff:default:return void(this.isHandoffMessageIdSignalTracked(s.queryId)&&this.validateResponse(s)&&(this.renderChatHistory(s,o),this.renderClosingBookending(s),this.processHandoffMessage(s),this.cleanupHandoff(s)))}}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.validateResponse=function(e){return!e.error||(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+e.error),e.error.includes("Unable to download content. The specified blob does not exist")||e.error.includes("Unable to download content. Request failed with status code 500")||this.HandoffOperations.onError(Et.HandoffMessageResponse,"I ran into a problem while completing your request. Please try again."),!1)},e.prototype.renderClosingBookending=function(e){var t,n,o;if((null===(t=e.properties)||void 0===t?void 0:t.sourceApp)&&(null===(n=e.properties)||void 0===n?void 0:n.destinationApp)&&(null===(o=e.properties)||void 0===o?void 0:o.scenarioName)&&(!this.flights.appValueChecksForBookendingEnabled||_t(e.properties.sourceApp)&&_t(e.properties.destinationApp)))switch(e.properties.scenarioName){case Lt.Cu.OPEN:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Opened");break;case Lt.Cu.NEW:case Lt.Cu.GENERATE:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Created")}},e.prototype.cleanupHandoff=function(e){var t=this.getHandoffMessageIdFromSignal(e.queryId);this.sendHandoffMessageId(It.Q.PROCESSED,t),this.completeTrackedHandoffMessageIdSignal(e.queryId)},e.prototype.renderChatHistory=function(e,t){var n,o,i;if(this.flights.renderChatHistoryInHandoffDestination){var r=null===(o=e.properties)||void 0===o?void 0:o.conversationId;r?function(e,t,n,o,i){var r,a,s,c,l,u;Rt(n,o,null===(s=null==i?void 0:i.current)||void 0===s?void 0:s.updateChatSessionId,null===(c=null==i?void 0:i.current)||void 0===c?void 0:c.submitOperation)&&(n("Updating chat session ID with conversationId from source"),null==o||o.sendChatEventTelemetry(x(((r={})[p.ChatEventType]=h.UpdateChatSessionId,r))),null===(l=null==i?void 0:i.current)||void 0===l||l.updateChatSessionId(e),n("Conversation ID handoff successful - submitting chat history signal"),null==o||o.sendChatEventTelemetry(x(((a={})[p.ChatEventType]=h.ChatHistorySignalSubmitted,a))),null===(u=null==i?void 0:i.current)||void 0===u||u.submitOperation(Ft(e,t)))}(r,e,this.HandoffOperations.logDebug,this.telemetryHandler,t):(this.HandoffOperations.logDebug("Cannot render chat history - conversation ID is undefined"),null===(i=this.telemetryHandler)||void 0===i||i.sendChatEventTelemetry(x(((n={})[p.ChatEventType]=h.ConversationIdUndefined,n))))}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)}}(),function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))}),zt=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};(function(){function e(e){this.HandoffOperations=e,this.sentQueryIds=new Set}e.prototype.sendHandoffInternalMessage=function(e){try{var t=this.getHandoffInternalMessageSignal(e);this.sentQueryIds.add(t.queryId);var n=new St.Xr({parentPath:["session","doc"],items:[{id:k.generateId(),body:t}]});this.handoffInternalMessageSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(t.H_.T_,{operation:n,workflowAnnotationType:yt.kp.getTypeName()})}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffInternalMessage signal. "+e.message),e}},e.prototype.handleHandoffOutboundMessage=function(e,t){return jt(this,void 0,void 0,(function(){var n,o,i,r;return zt(this,(function(a){switch(a.label){case 0:if(a.trys.push([0,6,,7]),!e.body||!yt.kp.typeGuard(e.body))throw new Error("Service response not of type HandoffOutboundMessage");return(n=e.body).queryId&&this.sentQueryIds.has(n.queryId)?(this.sentQueryIds.delete(n.queryId),this.HandoffOperations.onAnnotationReceived(yt.kp.getTypeName(),n,this.handoffInternalMessageSubmitTime,t),n.error?(this.HandoffOperations.onError(Et.OutboundMessageResponse,n.error),[3,5]):[3,1]):[2];case 1:return n.message?[3,2]:(this.HandoffOperations.onError(Et.NoResponse),[3,5]);case 2:return n.generatedLinks&&n.generatedLinks.length>0&&n.id?[4,this.renderGeneratedHandoffLinks(n)]:[3,4];case 3:if(a.sent(),n.destinationApp&&n.scenarioName)switch(n.scenarioName){case Lt.Cu.OPEN:this.HandoffOperations.renderBookending(null!==(i=n.sourceApp)&&void 0!==i?i:Lt.Ww.NONE,n.destinationApp,"Opening","Opened");break;case Lt.Cu.NEW:case Lt.Cu.GENERATE:this.HandoffOperations.renderBookending(null!==(r=n.sourceApp)&&void 0!==r?r:Lt.Ww.NONE,n.destinationApp,"Opening","Created")}return[3,5];case 4:this.HandoffOperations.onError(Et.NoGeneratedLinks),a.label=5;case 5:return[3,7];case 6:throw o=a.sent(),this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffOutboundMessage. "+o.message),o;case 7:return[2]}}))}))}})(),se()&&OfficeaicopilotStrings.PromptGuideMenuItemSpeakWithCopilot,se()&&OfficeaicopilotStrings.SpeakWithCopilotText;var Gt,Wt=n(29404),Qt={root:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",gap:Wt.L.spacingVerticalS},spinnerContainer:{justifyContent:"center",width:"100%"}},Jt=((0,Oe.n)(Qt),{root:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",gap:Wt.L.spacingVerticalS},spinnerContainer:{justifyContent:"center",width:"100%"}}),Vt=((0,Oe.n)(Jt),{entityPickerChildGap:{rowGap:"12px"},elementGap:{rowGap:"9px"},entityCardContainer:{paddingBottom:"10px",paddingRight:"6px",borderBottom:"1px solid ".concat(Wt.L.colorNeutralStroke3),":last-child":{borderBottom:"none"}},entityCard:{columnGap:"12px",alignItems:"flex-start"},entityLink:{width:"fit-content",":hover":{textDecoration:"none !important"}},entityIconContainer:{minHeight:"32px",minWidth:"32px",borderRadius:"8px",backgroundColor:Wt.L.colorNeutralStrokeAlpha,display:"flex",justifyContent:"center",alignItems:"center",marginTop:"2px"},entityIconImg:{width:"20px",height:"20px"},entityTextContainer:{display:"flex",flexDirection:"column",flexGrow:1},entityText:{color:Wt.L.colorNeutralForeground1,":hover":{color:Wt.L.colorBrandForegroundLink},display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitBoxOrient:"vertical",WebkitLineClamp:"1",wordBreak:"break-word"},entitySubText:{width:"fit-content",color:Wt.L.colorNeutralForeground2,display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitBoxOrient:"vertical",WebkitLineClamp:"1",wordBreak:"break-word"},entitySparkleIconContainer:{padding:0,minHeight:"32px",minWidth:"32px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",borderRadius:"4px",border:"1px solid transparent",backgroundColor:"transparent",color:Wt.L.colorNeutralForeground1,":hover":{backgroundColor:Wt.L.colorNeutralBackground1Hover,border:"1px solid ".concat(Wt.L.colorNeutralStroke1Hover),borderRadius:"6px",color:Wt.L.colorNeutralForeground1}},entitySparkleIconContainerSelected:{backgroundColor:Wt.L.colorNeutralBackground1Hover},suggestedPromptsPopover:{borderRadius:"8px",padding:"4px",backgroundColor:Wt.L.colorNeutralBackground1,boxShadow:Wt.L.shadow16,width:"175px"},suggestedPromptsContainer:{borderRadius:"4px",padding:"8px",rowGap:"7px"},suggestedPromptsTitle:{overflow:"hidden",color:Wt.L.colorNeutralForeground2,textOverflow:"ellipsis"},suggestedPromptMenuList:{rowGap:"7px"},suggestedPromptMenuItem:{margin:"0px",borderRadius:"8px",border:"1px solid ".concat(Wt.L.colorNeutralStroke2),display:"flex",height:"32px",padding:"0px 12px",alignItems:"center",width:"fit-content",cursor:"pointer",":hover":{border:"1px solid ".concat(Wt.L.colorNeutralStroke2),backgroundColor:"transparent"}},suggestedPrompt:{color:Wt.L.colorNeutralForeground2}});(0,Oe.n)(Vt);!function(e){e.FILE_LINK_CLICKED="file_link_clicked",e.SUGGESTED_PROMPTS_CLICKED="suggested_prompts_clicked"}(Gt||(Gt={}));n(58651),new Map([["docx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg"],["pptx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg"],["xlsx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg"],["pdf","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pdf.svg"],["txt","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg"],["html","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/html.svg"]]);var Kt=n(93536);Object.values(Kt.T).reduce((function(e,t){return e[t.toLowerCase()]=t,e}),{});var Yt=n(9680),Zt=n(91842),$t=function(){return $t=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},$t.apply(this,arguments)};function Xt(e){return{user:"human",message:e,disableLinksProcessing:!1,shouldApplyInputLinkTheme:!0}}s.memo((function(e){var t=e.markdownText,n=e.styles,o=void 0===n?{}:n,i=function(e,t){if(t)for(var n in e)e[n]=(0,re.z)(e[n],t[n]);return e}((0,Yt.bM)(),o);return s.createElement(Zt.A,{styles:i,body:$t({},Xt(t))})}));var en,tn=n(98050);!function(e){e.AnnotationReceived="annotationReceived",e.ContentUpdated="contentUpdated",e.RequestTimedOut="requestTimedOut"}(en||(en={}));tn.x.LOADING;var nn=n(79634),on=n(3218),rn="TaskViewMode",an=80,sn="c0ab8ce9-e9a0-42e7-b064-33d422df41f1",cn=function(){return window.location.href.replace("taskpane.html","msgExtDialog.html")},ln=function(e){var t;if("number"==typeof e)return e;if("string"==typeof e){var n=parseInt(e,10);if(!isNaN(n))return n;return null!==(t={large:-3,medium:-2,small:-1}[e.toLowerCase()])&&void 0!==t?t:-2}return-2},un=function(e,t){return Math.floor(e/t*100)},dn=function(e){var t,n;return null!==(n=((t={})[-1]=35,t[-2]=50,t[-3]=70,t)[e])&&void 0!==n?n:50},fn=function(e){var t,n;return null!==(n=((t={})[-1]=35,t[-2]=50,t[-3]=70,t)[e])&&void 0!==n?n:50},pn=n(95686),hn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},gn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},vn=(function(){function e(){var t=this;this.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},this.dialogProps=void 0,this.startTime=0,this.msalAccountInfo=null,this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},A("ExtensibilityDialogLauncher : Extensibility Dialog closed")},this.logDialogTelemetry=function(e,n){var o=Date.now();Z(o-t.startTime,e,null!=n?n:""),e||$(null!=n?n:"")},this.onMessageCallback=function(n){return hn(t,void 0,void 0,(function(){var t,o,i,r,a,s,c;return gn(this,(function(l){return this.openedDialog.dialog?((t=JSON.parse(n)).type===nn.o.Ack?(o={dialogContent:null===(i=this.dialogProps)||void 0===i?void 0:i.dialogContent,appDefinition:null===(r=this.dialogProps)||void 0===r?void 0:r.appDefinition,clientInfo:null===(a=this.dialogProps)||void 0===a?void 0:a.clientInfo,cardInfo:null===(s=this.dialogProps)||void 0===s?void 0:s.card,hostConfigFlags:null===(c=this.dialogProps)||void 0===c?void 0:c.hostConfigFlags,copilotChatThemev2:e.theme,source:"BizChat",msalAccountInfo:this.msalAccountInfo},this.openedDialog.dialog.messageChild(JSON.stringify(o),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0)):t.type===nn.o.CloseEvent&&this.closeActiveDialog(),[2]):(this.logDialogTelemetry(!1,"ExtensibilityDialogLauncher.onMessageCallback : No active dialog found"),[2])}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return!!t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n,o;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(null===(o=null===(n=t.dialogProps)||void 0===n?void 0:n.action)||void 0===o?void 0:o.title)&&t.openedDialog.triggeringActionTitle&&t.openedDialog.triggeringActionTitle===t.dialogProps.action.title)},this.onDialogError=function(e){var n="Error opening dialog";if(e)try{n=JSON.stringify(e)}catch(e){A("ExtensibilityDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"ExtensibilityDialogLauncher : ".concat(n))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return hn(t,void 0,void 0,(function(){var t,o,i,r,a,s=this;return gn(this,(function(c){switch(c.label){case 0:if(t=null!==(a=null===(r=null===(i=this.dialogProps)||void 0===i?void 0:i.card)||void 0===r?void 0:r.id)&&void 0!==a?a:"",this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return o=cn(),[4,Office.context.ui.displayDialogAsync(o,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return hn(s,void 0,void 0,(function(){var n,o,i,r,a,s=this;return gn(this,(function(c){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(i=null===(o=null===(n=this.dialogProps)||void 0===n?void 0:n.action)||void 0===o?void 0:o.title)&&void 0!==i?i:""},null===(r=this.openedDialog.dialog)||void 0===r||r.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return hn(s,void 0,void 0,(function(){return gn(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),null===(a=this.openedDialog.dialog)||void 0===a||a.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return hn(s,void 0,void 0,(function(){return gn(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return c.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return hn(t,void 0,void 0,(function(){var t,o,i,r,a=this;return gn(this,(function(s){return t=cn(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(r=null===(i=null===(o=this.dialogProps)||void 0===o?void 0:o.dialogContent)||void 0===i?void 0:i.title)&&void 0!==r?r:Re,hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){a.openedDialog.dialog=e})).catch((function(e){a.onDialogError(e),A("ExtensibilityDialogLauncher : Error displaying  Extensibility Dialog",e)})),[2]}))}))},this.launchExtensibilityDialog=function(e){return hn(t,void 0,void 0,(function(){var t,n,o,i,r,a,s,c,l,u,d,f;return gn(this,(function(p){switch(p.label){case 0:return(null==e?void 0:e.clientInfo)?(this.startTime=Date.now(),t=!this.msalAccountInfo||(null===(c=null===(s=this.dialogProps)||void 0===s?void 0:s.clientInfo)||void 0===c?void 0:c.userPrincipalName)!==e.clientInfo.userPrincipalName,this.dialogProps=e,t?(n=new ie({userPrincipalName:null===(l=null==e?void 0:e.clientInfo)||void 0===l?void 0:l.userPrincipalName,redirectUri:new URL(null!==(d=null===(u=null==e?void 0:e.clientInfo)||void 0===u?void 0:u.redirectUri)&&void 0!==d?d:"",window.location.origin).toString(),clientId:sn}),o=this,[4,n.getAccountInfoFromCache()]):[3,2]):(A("ExtensibilityDialogLauncher : Invalid dialog properties provided"),[2]);case 1:o.msalAccountInfo=p.sent(),p.label=2;case 2:return i=function(e){var t,n;if(e.viewMode!==pn.hs.TaskModule)return{dialogHeight:an,dialogWidth:an};var o=ln(null===(t=e.dialogContent)||void 0===t?void 0:t.height),i=ln(null===(n=e.dialogContent)||void 0===n?void 0:n.width),r=!0,a=!0,s=55,c=50;o<=0&&(a=!1,s=fn(o)),i<=0&&(r=!1,c=dn(i));var l=screen.width,u=screen.height;return a&&(s=un(o,u)),r&&(c=un(i,l)),{dialogHeight:s,dialogWidth:c}}(e),r=i.dialogHeight,a=i.dialogWidth,(null===(f=e.clientInfo)||void 0===f?void 0:f.clientType)===on.WK.web?this.openDialogForWebPlatformAsNewWindow(r,a):this.openDialogForNativePlatform(r,a),[2]}}))}))}}e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.setTheme=function(t){e.theme=t}}(),function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))}),yn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},bn=function(){function e(e,t){this.clientInfo=e,this.msalAccountInfo=t,this.findMatchingAccount=function(e,t){return e.find((function(e){return e.username.toLowerCase()===t.toLowerCase()}))}}return e.prototype.getAccount=function(e){return vn(this,void 0,void 0,(function(){var t,n;return yn(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,1,,3]),!(t=this.getAccountSilent(e)))throw A("AccountProvider : No account found in cache, trying interactive login"),new Error("No account found in cache");return[3,3];case 1:return n=o.sent(),A("AccountProvider : Silent account retrieval failed: ".concat(n)),[4,this.getAccountInteractive(e)];case 2:return t=o.sent(),[3,3];case 3:if(!t)throw A("AccountProvider : No account found after both silent and interactive attempts."),new Error("AccountProvider : No account found");return[2,t]}}))}))},e.prototype.getAccountSilent=function(e){var t;if(this.msalAccountInfo)return A("AccountProvider: Using cached MSAL account info"),this.msalAccountInfo;var n=null===(t=this.clientInfo)||void 0===t?void 0:t.userPrincipalName;if(!n)throw A("AccountProvider: No userPrincipalName provided in client info"),new Error("No userPrincipalName provided in client info");var o=e.getAllAccounts();if(0===o.length)throw new Error("No accounts found in MSAL service");o.length>1&&A("AccountProvider: Multiple accounts found (".concat(o.length,"). Using account with UPN: ").concat(n));var i=this.findMatchingAccount(o,n);return i||(A("AccountProvider: No exact match found for UPN: ".concat(n,". Using first available account")),o[0])},e.prototype.getAccountInteractive=function(t){return vn(this,void 0,void 0,(function(){var n;return yn(this,(function(o){return e.signInRequestPromise?(A("AccountProvider: Sign-in request already in progress, waiting for it to complete"),[2,this.resolveSignInRequest()]):(n={loginHint:this.clientInfo.userPrincipalName},A("AccountProvider: Initiating interactive login popup"),e.signInRequestPromise=t.loginPopup(n),[2,this.resolveSignInRequest()])}))}))},e.prototype.resolveSignInRequest=function(){return vn(this,void 0,void 0,(function(){var t,n,o;return yn(this,(function(i){switch(i.label){case 0:if(!e.signInRequestPromise)return A("AccountProvider: No sign-in request promise found"),[2,void 0];i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,e.signInRequestPromise];case 2:return t=i.sent(),(n=null==t?void 0:t.account)?(A("AccountProvider: Interactive login successful for user: ".concat(n.username)),this.msalAccountInfo=n):A("AccountProvider: Interactive login completed but no account returned"),[2,n];case 3:throw o=i.sent(),A("AccountProvider: Interactive login failed: ",o),new Error("Interactive authentication failed: ".concat(o instanceof Error?o.message:"Unknown error"));case 4:return e.signInRequestPromise=void 0,[7];case 5:return[2]}}))}))},e}(),mn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Cn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},En=function(){function e(e,t,n,o){this.msalFor1PResources=e,this.msalFor3PResources=t,this.acquire3PTokenFallback=n,this.accountProvider=o,this.queue=[],this.interactionInProgress=!1}return e.prototype.enqueue=function(e,t,n){var o=this;return new Promise((function(i,r){o.queue.push({request:e,is1PResource:t,fallbackTo3PResource:n,resolve:i,reject:r}),o.processQueue()}))},e.prototype.createPopupRequest=function(e,t){return mn(this,void 0,void 0,(function(){var n;return Cn(this,(function(o){switch(o.label){case 0:return[4,this.accountProvider.getAccount(t)];case 1:if(!(n=o.sent()))throw new Error("InteractiveTokenQueue : No account found for popup request");return[2,{scopes:["".concat(e.resource,"/.default")],account:n}]}}))}))},e.prototype.processQueue=function(){var e=this;if(!this.msalFor1PResources||!this.msalFor3PResources)throw new Error("InteractiveTokenQueue : MSAL instances not initialized.");if(!this.interactionInProgress&&0!==this.queue.length){this.interactionInProgress=!0;mn(e,void 0,void 0,(function(){var e,t,n,o,i,r,a,s,c,l,u,d,f;return Cn(this,(function(p){switch(p.label){case 0:if(!(this.queue.length>0))return[3,12];e=this.queue.shift(),t=e.request,n=e.is1PResource,o=e.fallbackTo3PResource,i=e.resolve,r=e.reject,a=n?this.msalFor1PResources:this.msalFor3PResources,p.label=1;case 1:return p.trys.push([1,4,,11]),[4,this.createPopupRequest(t,a)];case 2:return s=p.sent(),[4,a.acquireTokenPopup(s)];case 3:return c=p.sent(),i({authToken:c.accessToken}),[3,11];case 4:if(l=p.sent(),!o||!n)return[3,9];p.label=5;case 5:return p.trys.push([5,7,,8]),[4,this.acquire3PTokenFallback(t)];case 6:return u=p.sent(),i({authToken:null!==(f=u.authToken)&&void 0!==f?f:""}),[3,8];case 7:return d=p.sent(),r(d),[3,8];case 8:return[3,10];case 9:r(l),p.label=10;case 10:return[3,11];case 11:return[3,0];case 12:return this.interactionInProgress=!1,[2]}}))}))}},e}(),In=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Ln=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Sn=function(){function e(e){this.clientInfo=e,this.initialized=!1}return e.prototype.initialize=function(){return In(this,void 0,void 0,(function(){return Ln(this,(function(e){switch(e.label){case 0:return this.initialized?[2]:[4,this.loadMsalBrowser()];case 1:return e.sent(),this.createMsalInstances(),this.initialized=!0,[2]}}))}))},e.prototype.getMsalModule=function(){if(!this.msalModule)throw new Error("MSAL module not loaded");return this.msalModule},e.prototype.getMsalFor1PResources=function(){if(!this.msalFor1PResources)throw new Error("MSAL 1P instance not initialized");return this.msalFor1PResources},e.prototype.getMsalFor3PResources=function(){if(!this.msalFor3PResources)throw new Error("MSAL 3P instance not initialized");return this.msalFor3PResources},e.prototype.initializeMsalInstances=function(){return In(this,void 0,void 0,(function(){var e,t;return Ln(this,(function(n){switch(n.label){case 0:return e=this.getMsalFor1PResources(),t=this.getMsalFor3PResources(),[4,e.initialize()];case 1:return n.sent(),[4,t.initialize()];case 2:return n.sent(),[2]}}))}))},e.prototype.loadMsalBrowser=function(){return In(this,void 0,void 0,(function(){var e,t,o;return Ln(this,(function(i){switch(i.label){case 0:e=1,i.label=1;case 1:if(!(e<=3))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),t=this,[4,n.e(717).then(n.bind(n,19072))];case 3:return t.msalModule=i.sent(),[2];case 4:if(o=i.sent(),A("Attempt ".concat(e," to load @azure/msal-browser failed:"),o),3===e)throw o;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.createMsalInstances=function(){if(!this.msalModule)throw new Error("MSAL module not loaded");this.msalFor1PResources=this.createPublicClientApplication(this.msalModule.PublicClientApplication,sn),this.msalFor3PResources=this.createPublicClientApplication(this.msalModule.PublicClientApplication,"3068386c-7a16-4f6a-a664-043b6b232816")},e.prototype.createPublicClientApplication=function(e,t){var n,o=null!==(n=this.clientInfo.redirectUri)&&void 0!==n?n:"";return new e({auth:{clientId:t,authority:X,redirectUri:new URL(o,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})},e}(),An=function(){function e(){this.cache=new Map}return e.prototype.get=function(e){var t=this.createKey(e);return this.cache.get(t)},e.prototype.set=function(e,t){var n=this.createKey(e);this.cache.set(n,t)},e.prototype.delete=function(e){var t=this.createKey(e);return this.cache.delete(t)},e.prototype.has=function(e){var t=this.createKey(e);return this.cache.has(t)},e.prototype.createKey=function(e){return"".concat(e.resource,"-").concat(e.claims,"-").concat(e.isSilent)},e}(),wn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Tn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Pn=function(){function e(e,t,n,o){this.msalInstance=e,this.accountProvider=t,this.interactiveTokenQueue=n,this.msalModule=o}return e.prototype.createTokenRequest=function(e,t){return{scopes:["".concat(e,"/.default")],account:t}},e.prototype.acquireToken=function(e){return wn(this,void 0,void 0,(function(){var t,n,o,i,r;return Tn(this,(function(a){switch(a.label){case 0:if(t=this.getResourceType(),!this.msalInstance)throw A("DialogTokenService : Failed to acquire ".concat(t," MSAL instance.")),new Error("DialogTokenService : Failed to acquire ".concat(t," MSAL instance"));a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.accountProvider.getAccount(this.msalInstance)];case 2:if(!(n=a.sent()))throw A("DialogTokenService : No account found for ".concat(t," resource.")),new Error("DialogTokenService : No account found for ".concat(t," resource"));return o=this.createTokenRequest(e.resource,n),[4,this.msalInstance.acquireTokenSilent(o)];case 3:return[2,{authToken:a.sent().accessToken}];case 4:if(i=a.sent(),this.msalModule&&i instanceof this.msalModule.InteractionRequiredAuthError){if(!this.interactiveTokenQueue)throw new Error("DialogTokenService : Interactive token queue not initialized");return r="1P"===t,[2,this.interactiveTokenQueue.enqueue(e,r,this.shouldFallbackTo3PResource())]}throw A("DialogTokenService : Error acquiring ".concat(t," token: ").concat(i)),new Error("DialogTokenService : Error acquiring ".concat(t," token"));case 5:return[2]}}))}))},e}(),kn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),_n=function(e){function t(t,n,o,i,r){var a=e.call(this,t,n,o,i)||this;return a.fallbackTo3PResource=r,a}return kn(t,e),t.prototype.getResourceType=function(){return"1P"},t.prototype.shouldFallbackTo3PResource=function(){return this.fallbackTo3PResource},t}(Pn),Dn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),On=function(e){function t(t,n,o,i){return e.call(this,t,n,o,i)||this}return Dn(t,e),t.prototype.getResourceType=function(){return"3P"},t.prototype.shouldFallbackTo3PResource=function(){return!1},t}(Pn),xn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Mn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Nn=function(){function e(e,t,n,o,i){this.msalFor1PResources=e,this.msalFor3PResources=t,this.accountProvider=n,this.interactiveTokenQueue=o,this.msalModule=i}return e.prototype.create1PTokenAcquisition=function(e){return new _n(this.msalFor1PResources,this.accountProvider,this.interactiveTokenQueue,this.msalModule,e)},e.prototype.create3PTokenAcquisition=function(){return new On(this.msalFor3PResources,this.accountProvider,this.interactiveTokenQueue,this.msalModule)},e.prototype.acquire1PToken=function(e,t){return xn(this,void 0,void 0,(function(){return Mn(this,(function(n){return[2,this.create1PTokenAcquisition(t).acquireToken(e)]}))}))},e.prototype.acquire3PToken=function(e){return xn(this,void 0,void 0,(function(){return Mn(this,(function(t){return[2,this.create3PTokenAcquisition().acquireToken(e)]}))}))},e}(),Rn=n(19495),Hn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Fn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(e,t){this.initialized=!1,this.msalManager=new Sn(e),this.tokenRequestCache=new An,this.accountProvider=new bn(e,t)}e.prototype.ensureInitialized=function(){return Hn(this,void 0,void 0,(function(){return Fn(this,(function(e){switch(e.label){case 0:return this.initialized?[2]:[4,this.msalManager.initialize()];case 1:return e.sent(),[4,this.msalManager.initializeMsalInstances()];case 2:return e.sent(),this.interactiveTokenQueue=new En(this.msalManager.getMsalFor1PResources(),this.msalManager.getMsalFor3PResources(),this.acquire3PToken.bind(this),this.accountProvider),this.tokenAcquisitionFactory=new Nn(this.msalManager.getMsalFor1PResources(),this.msalManager.getMsalFor3PResources(),this.accountProvider,this.interactiveTokenQueue,this.msalManager.getMsalModule()),this.initialized=!0,[2]}}))}))},e.prototype.acquire1PToken=function(e,t){return Hn(this,void 0,void 0,(function(){return Fn(this,(function(n){if(!this.tokenAcquisitionFactory)throw new Error("Token acquisition factory not initialized");return[2,this.tokenAcquisitionFactory.acquire1PToken(e,t)]}))}))},e.prototype.acquire3PToken=function(e){return Hn(this,void 0,void 0,(function(){return Fn(this,(function(t){if(!this.tokenAcquisitionFactory)throw new Error("Token acquisition factory not initialized");return[2,this.tokenAcquisitionFactory.acquire3PToken(e)]}))}))},e.prototype.getTokenInternal=function(e){var t=(0,Rn.p)(e),n=t.is1PResource,o=t.fallbackTo3PResource;return n?this.acquire1PToken(e,o):this.acquire3PToken(e)},e.prototype.getToken=function(e){return Hn(this,void 0,void 0,(function(){var t,n,o;return Fn(this,(function(i){switch(i.label){case 0:return[4,this.ensureInitialized()];case 1:i.sent(),(t=this.tokenRequestCache.get(e))||(t=this.getTokenInternal(e),this.tokenRequestCache.set(e,t)),i.label=2;case 2:return i.trys.push([2,4,5,6]),[4,t];case 3:return[2,i.sent()];case 4:throw n=i.sent(),(o=this.msalManager.getMsalModule())&&n instanceof o.AuthError&&A("DialogTokenService : AuthError encountered: ".concat(n.message)),n;case 5:return this.tokenRequestCache.delete(e),[7];case 6:return[2]}}))}))}}();try{var Un=n(63969);Un.ExternalAuthService,Un.ChannelService,Un.MosAppService}catch(e){try{var qn=n(81980);qn.ExternalAuthService,qn.ChannelService,qn.MosAppService}catch(e){A("Neither @1js/officeaicopilot-chat-core nor @1js/officeaicopilot-chat could be loaded")}}try{var Bn=n(63969);Bn.MsgExtDialogContainer}catch(e){try{var jn=n(81980);jn.MsgExtDialogContainer}catch(e){A("Neither @1js/officeaicopilot-chat-core nor @1js/officeaicopilot-chat could be loaded")}}var zn=n(17185),Gn=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}(),Wn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Qn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Jn=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getToken=function(e){return Wn(this,void 0,void 0,(function(){var t,n,o;return Qn(this,(function(i){switch(i.label){case 0:return t=(0,Ue.A)(),Zn(t,zn.o.AuthService,zn.L.GetToken,{request:e}),n=new Gn,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e}(),Vn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Kn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Yn=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.botInvoke=function(e){return Vn(this,void 0,void 0,(function(){var t,n,o;return Kn(this,(function(i){switch(i.label){case 0:return t=(0,Ue.A)(),Zn(t,zn.o.ChannelService,zn.L.BotInvoke,{request:e}),n=new Gn,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e.prototype.botMessage=function(e){return Vn(this,void 0,void 0,(function(){return Kn(this,(function(e){throw new Error("Method not implemented.")}))}))},e}(),Zn=function(e,t,n,o){Office.context.ui.messageParent(JSON.stringify({requestId:e,type:nn.o.onServiceRequest,serviceName:t,apiName:n,requestData:o}),{targetOrigin:window.location.origin})},$n=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Xn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},eo=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getApp=function(e){return $n(this,void 0,void 0,(function(){var t,n,o;return Xn(this,(function(i){switch(i.label){case 0:return t=(0,Ue.A)(),Zn(t,zn.o.AppService,zn.L.GetApp,{request:e}),n=new Gn,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e.prototype.getApps=function(){return $n(this,void 0,void 0,(function(){var e,t,n;return Xn(this,(function(o){switch(o.label){case 0:return e=(0,Ue.A)(),Zn(e,zn.o.AppService,zn.L.GetApps),t=new Gn,this.requestByQueryId.set(e,t),[4,t.completion];case 1:return n=o.sent(),[2,JSON.parse(n)]}}))}))},e}(),to=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogInfo=function(e){var t=(0,Ue.A)();Zn(t,zn.o.TelemetryService,zn.L.LogInfo,{request:e})},e.prototype.LogError=function(e){var t=(0,Ue.A)();Zn(t,zn.o.TelemetryService,zn.L.LogError,{request:e})},e.prototype.LogException=function(e){var t=(0,Ue.A)();Zn(t,zn.o.TelemetryService,zn.L.LogException,{request:e})},e.prototype.LogWarning=function(e){var t=(0,Ue.A)();Zn(t,zn.o.TelemetryService,zn.L.LogWarning,{request:e})},e.prototype.LogVerbose=function(e){var t=(0,Ue.A)();Zn(t,zn.o.TelemetryService,zn.L.LogVerbose,{request:e})},e.prototype.LogMetric=function(e){var t=(0,Ue.A)();Zn(t,zn.o.TelemetryService,zn.L.LogMetric,{request:e})},e}(),no=function(){return null},oo=no,io=no;try{var ro=n(63969);oo=ro.ExternalAuthService,io=ro.MsgExtDialogContainer}catch(e){try{var ao=n(81980);oo=ao.ExternalAuthService,io=ao.MsgExtDialogContainer}catch(e){A("Neither @1js/officeaicopilot-chat-core nor @1js/officeaicopilot-chat could be loaded")}}s.memo((function(e){var t=e.dialogContent,n=e.appDefinition,o=e.userContext,i=e.hostContext,r=e.clientInfo,a=e.handleCloseButtonClick,c=e.shouldShowDismissIcon,l=e.copilotChatThemeV2,u=e.cardInfo,d=e.hostConfigFlags,f=s.useMemo((function(){return eo.getInstance()}),[]),p=s.useMemo((function(){return Jn.getInstance()}),[]),h=s.useMemo((function(){return Yn.getInstance()}),[]),g=s.useMemo((function(){return to.getInstance()}),[]),v=s.useMemo((function(){return new oo}),[]);return s.createElement(ct.q,{theme:l},s.createElement(io,{dialogContent:t,botService:h,appDefinition:n,tokenService:p,telemetryService:g,userContext:o,hostContext:i,appService:f,externalAuthService:v,clientInfo:r,handleCloseButtonClick:a,shouldShowDismissIcon:c,cardInfo:u,createAndSendSignalsToSubstrate:!1,hostConfigFlags:d}))}));var so=function(e){var t={appId:"",botId:"",cardId:""};if(!(null==e?void 0:e.cardData))return A("msgExtension Utils: cardData is not present in taskModuleProps"),t;try{var n=JSON.parse(e.cardData);t={appId:n.appId,botId:n.botId,cardId:n.cardId}}catch(e){A("msgExtension Utils: Failed to extract cardId from cardData")}return t},co=function(){return co=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},co.apply(this,arguments)},lo=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},uo=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.startTime=0,this.useDimensionsV2=!1,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},A("MsgExtDialogLauncher : Task Module dialog closed")},this.shouldUseDimensionsV2=function(e){t.useDimensionsV2=e},this.logDialogTelemetry=function(e,n){var o=Date.now();Z(o-t.startTime,e,null!=n?n:""),e||$(null!=n?n:"")},this.onMessageCallback=function(n){return lo(t,void 0,void 0,(function(){var t,o,i,r,a,s,c,u,d,v,y,b,m,C;return uo(this,(function(E){switch(E.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(n)).type!==nn.o.Ack?[3,1]:(o=so(this.taskModuleProps),r={dialogContent:null===(v=this.taskModuleProps)||void 0===v?void 0:v.dialogContent,appDefinition:null===(y=this.taskModuleProps)||void 0===y?void 0:y.appDefinition,clientInfo:null===(b=this.taskModuleProps)||void 0===b?void 0:b.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:o,hostConfigFlags:null===(m=this.taskModuleProps)||void 0===m?void 0:m.hostConfigFlags,copilotChatThemev2:e.theme,source:"AppChat"},this.openedDialog.dialog.messageChild(JSON.stringify(r),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0),[3,6]):(this.logDialogTelemetry(!1,"MsgExtDialogLauncher.onMessageCallback : No active dialog found"),[2]);case 1:return t.type!==nn.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==nn.o.onServiceRequest)return[3,6];null===(C=l.setQueryGuid)||void 0===C||C.call(l,t.requestId),A("MsgExtDialogLauncher : Received service request from dialog",t),i={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},l.sendChatEventTelemetry(x(((c={})[p.ChatEventType]=h.TaskModuleServiceRequest,c[p.ChatEventParameters]=JSON.stringify(i),c))),r={requestId:t.requestId,messageType:nn.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},E.label=3;case 3:return E.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(a=E.sent())&&(r.result=a),A("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),l.sendChatEventTelemetry(x(((u={})[p.ChatEventType]=h.TaskModuleServiceResponse,u[p.ChatEventParameters]=JSON.stringify(i),u))),this.openedDialog.dialog.messageChild(JSON.stringify(r),{targetOrigin:window.location.origin}),[3,6];case 5:return s=E.sent(),A("MsgExtDialogLauncher : Error executing plugin operation",s),l.sendErrorTelemetry(x(((d={})[g.ErrorMessage]=JSON.stringify(co(co({},i),{error:s})),d[g.ErrorCategory]=f.ExtensibilityDialog,d[g.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),d))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(n=t.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.onDialogError=function(e){var n="Error opening dialog";if(e)try{n=JSON.stringify(e)}catch(e){A("MsgExtDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"MsgExtDialogLauncher : ".concat(n))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return lo(t,void 0,void 0,(function(){var t,o,i=this;return uo(this,(function(r){switch(r.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=so(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return o=cn(),[4,Office.context.ui.displayDialogAsync(o,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return lo(i,void 0,void 0,(function(){var n,o,i=this;return uo(this,(function(r){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(o=null===(n=this.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)&&void 0!==o?o:""},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return lo(i,void 0,void 0,(function(){return uo(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return lo(i,void 0,void 0,(function(){return uo(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return r.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return lo(t,void 0,void 0,(function(){var t,o,i,r=this;return uo(this,(function(a){return this.shouldDisplayDismissIcon=!1,t=cn(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(i=null===(o=this.taskModuleProps)||void 0===o?void 0:o.dialogTitle)&&void 0!==i?i:Re,hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){r.openedDialog.dialog=e})).catch((function(e){r.onDialogError(e),A("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e){return lo(t,void 0,void 0,(function(){var t,n,o,i,r,a,s;return uo(this,(function(c){return this.startTime=Date.now(),this.taskModuleProps=e,t=0,n=0,this.useDimensionsV2?(i=function(e){var t,n;if(e.viewMode!==rn)return{dialogHeight:an,dialogWidth:an};var o=ln(null===(t=e.dialogContent)||void 0===t?void 0:t.height),i=ln(null===(n=e.dialogContent)||void 0===n?void 0:n.width),r=!0,a=!0,s=55,c=50;o<=0&&(a=!1,s=fn(o)),i<=0&&(r=!1,c=dn(i));var l=screen.width,u=screen.height;return a&&(s=un(o,u)),r&&(c=un(i,l)),{dialogHeight:s,dialogWidth:c}}(e),t=i.dialogHeight,n=i.dialogWidth):(o=null===(a=e.clientInfo)||void 0===a?void 0:a.clientType,r=o===on.WK.web?function(e){var t,n;if(e.viewMode===rn){var o=null===(t=e.dialogContent)||void 0===t?void 0:t.height,i=null===(n=e.dialogContent)||void 0===n?void 0:n.width;if(!o||!i||"number"!=typeof i||"number"!=typeof o)return{dialogHeight:55,dialogWidth:50};var r=screen.width,a=screen.height;return{dialogHeight:Math.floor(o/a*100),dialogWidth:Math.floor(i/r*100)}}return{dialogHeight:an,dialogWidth:an}}(e):function(e){var t,n,o,i,r=e.viewMode,a=r===rn?window.outerWidth:window.innerWidth,s=r===rn?window.outerHeight:window.innerHeight,c=r===rn?5:0,l=r===rn?2:0,u=null===(t=e.dialogContent)||void 0===t?void 0:t.height,d=null===(n=e.dialogContent)||void 0===n?void 0:n.width;try{if("number"==typeof d&&"number"==typeof u&&d<=a&&u<=s){var f=Math.floor(u/s*100),p=Math.floor(d/a*100);o=f+c,i=p+l}else o=55,i=50}catch(e){o=55,i=50}return{dialogHeight:o,dialogWidth:i}}(e),t=r.dialogHeight,n=r.dialogWidth),(null===(s=e.clientInfo)||void 0===s?void 0:s.clientType)===on.WK.web?this.openDialogForWebPlatformAsNewWindow(t,n):this.openDialogForNativePlatform(t,n),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}e.getInstance=function(){return e.instance||new e},e.setTheme=function(t){e.theme=t}}();(0,Oe.n)({button:{width:"100px",height:"24px",opacity:"1",padding:"2px 8px",gap:"4px",border:"1px solid #C8C6C4",borderRadius:"4px",backgroundColor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"row",minHeight:"unset",minWidth:"unset",":hover":{backgroundColor:"rgba(0, 0, 0, 0.03)",border:"1px solid #E1DFDD"},":focus-visible":{outline:"2px solid #605E5C",outlineOffset:"1px"},":disabled":{backgroundColor:"transparent",border:"1px solid #E1DFDD",opacity:"0.6",cursor:"not-allowed"}},icon:{width:"16px",height:"16px"},textWrapper:{width:"60px",height:"18px",opacity:"1",paddingBottom:"2px",display:"flex",alignItems:"center",justifyContent:"center"},text:{fontFamily:"Segoe UI",fontWeight:"400",fontSize:"12px",lineHeight:"16px",color:"#323130",whiteSpace:"nowrap"}});var fo=n(67720);const po="https://graph.microsoft.com",ho=e=>({accessToken:e.accessToken,expirationTime:e?.expiresOn?.getTime()??0});var go=n(58651);class vo{constructor(e){this.params=e}async loadMsalBrowser(){for(let e=1;e<=3;e++)try{return this.msalModule=await n.e(717).then(n.bind(n,89393)),void(this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication))}catch(t){if(go.error(`Attempt ${e} to load @azure/msal-browser failed:`,t),3===e)throw t}}async createPublicClientApplication(e){const t=this.params.clientId,n=this.params.redirectUri;return new e({auth:{clientId:t,authority:"https://login.microsoftonline.com/common",redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})}async getToken(e,t){go.log("MsalTokenService.getToken called for resource: "+e),this.publicClientApplication||await this.loadMsalBrowser();const n=await this.publicClientApplication;if(!n)throw new Error("Failed to acquire token - Could not load msal module");let o;try{await n.initialize();const t=n.getAllAccounts();if(0===t?.length){return await this.ssoSilentNoAccount(e,n)}if(o=await this.getSelectedAccount(t,n),!o)throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return await this.acquireTokenSilent(e,o,n)}catch(t){if(go.log(`Failed to get access token: ${t?.message}`),this.msalModule&&t instanceof this.msalModule.InteractionRequiredAuthError){return await this.acquireTokenPopup(e,o,n)}throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),t}}async getSelectedAccount(e,t){if(this.loginPopupPromise){const e=await this.loginPopupPromise;return e?.account??void 0}if(!e||0===e.length)return;const n=this.params?e.find((e=>e.username?.toLowerCase()===this.params?.userPrincipalName?.toLowerCase()))??null:e[0];if(n)return n;const o=this.params?{loginHint:this.params.userPrincipalName}:void 0;try{this.loginPopupPromise=t.loginPopup(o);const e=await this.loginPopupPromise;return e?.account??void 0}finally{this.loginPopupPromise=void 0}}async ssoSilentNoAccount(e,t){const n={scopes:[`${e}/.default`],loginHint:this.params?.userPrincipalName},o=await t.ssoSilent(n);return o||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),o}async acquireTokenSilent(e,t,n){const o={scopes:[`${e}/.default`],account:t},i=await n.acquireTokenSilent(o);return i||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),i}async acquireTokenPopup(e,t,n){const o={scopes:[`${e}/.default`],account:t},i=await n.acquireTokenPopup(o);return i||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),i}logTokenAcquiredError(e){go.log("AuthTokenService",e)}}var yo=n(35095),bo=n(87866),mo=n(78364),Co=n(23956),Eo=n(79563);const Io=(0,Oe.n)({dialog:{display:"flex",width:"100%",height:"100%",maxWidth:"unset",backgroundColor:Wt.L.colorNeutralBackground4Hover,...Eo.Pt.padding("0px","0px","0px","0px"),border:"none",borderRadius:"0px"},dialogBody:{width:"100%",height:"100%",maxHeight:"100%"},dialogContent:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},spinner:{position:"fixed",left:"50%",top:"50%"},iframe:{width:"97vw",height:"95vh",maxWidth:"100%",maxHeight:"100%",display:"block"}});var Lo=n(58651);function So(e){const{service:t,onItemSelected:n,onDismissDialog:o,onErrorInLoading:i}=e,[r,a]=s.useState(!0),[c,l]=s.useState(null),u=Io();s.useEffect((()=>{const e={pick:async e=>{Lo.log(e),n(e.items)},close:async e=>{o()},pageLoaded:e=>{a(!1)}};if(c){let n;return t.initializePicker(c,e).then((e=>{n=e})).catch((e=>{i()})),()=>n?.()}}),[c,t]);const d=s.useCallback((e=>{l(e&&e.contentWindow||null)}),[]);return s.createElement("div",null,s.createElement(yo.E,{className:u.dialog},s.createElement(bo.R,{className:u.dialogBody},s.createElement(mo.C,{className:u.dialogContent},r&&s.createElement(Co.y,{size:"large",className:u.spinner}),s.createElement("iframe",{title:"File Picker",sandbox:"allow-forms allow-modals allow-popups allow-same-origin allow-scripts",ref:d,className:u.iframe})))))}var Ao=n(58651);const wo=e=>{const{userPrincipalName:t,appName:n,theme:o,locale:i,clientId:r,redirectUri:a,onItemSelected:c,onErrorInLoading:l,onDismissDialog:u,supportedFileExtensionMimeMap:d}=e,f=s.useMemo((()=>new vo({userPrincipalName:t,redirectUri:a,clientId:r})),[t,a,r]),p=s.useCallback((async e=>{try{const t=await f.getToken(e??po);return ho(t)}catch(e){return Ao.error("Error acquiring graph token:",e),{accessToken:"",expirationTime:0}}}),[f]),h=s.useCallback((async e=>{try{const t=await f.getToken(e);return ho(t)}catch(e){return Ao.error("Error acquiring sharepoint token:",e),{accessToken:"",expirationTime:0}}}),[f]),[g,v]=s.useState(void 0);return s.useEffect((()=>{const e=new fo.P(p,h,n,i,o,d);v(e)}),[n,p,i,h,o,d]),s.createElement("div",null,g?s.createElement(So,{service:g,onItemSelected:c,onDismissDialog:u,onErrorInLoading:l}):s.createElement("div",null,"Loading..."))};var To=n(84067),Po=n(26773),ko=n(58651);Office.onReady((0,r._)((function(){return(0,a.__generator)(this,(function(e){return Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,(function(e){var t;try{t=JSON.parse(e.message)}catch(e){ko.error("Failed to parse message from parent:",e),t={}}var n,o,i,r;c.render(s.createElement(ct.q,{theme:t.isDarkMode?To.C:Po.o},s.createElement(wo,{userPrincipalName:null!==(n=t.userPrincipalName)&&void 0!==n?n:"",clientId:null!==(o=t.clientId)&&void 0!==o?o:"",redirectUri:null!==(i=t.redirectUri)&&void 0!==i?i:"",locale:null!==(r=t.locale)&&void 0!==r?r:"",appName:"PowerPoint",onItemSelected:function(e){var t={type:W.OnItemSelected,files:e};Office.context.ui.messageParent(JSON.stringify(t))},onDismissDialog:function(){var e={type:W.CloseEvent};Office.context.ui.messageParent(JSON.stringify(e))},onErrorInLoading:function(){var e={type:W.OnErrorInLoading};Office.context.ui.messageParent(JSON.stringify(e))},theme:t.isDarkMode?"dark":"default"})),document.getElementById("cloud-file-picker-container"))})),Office.context.ui.messageParent(JSON.stringify({type:W.Ack})),[2]}))})))},71100:()=>{}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=r,s.amdO={},e=[],s.O=(t,n,o,i)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){for(var[n,o,i]=e[u],a=!0,c=0;c<n.length;c++)(!1&i||r>=i)&&Object.keys(s.O).every((e=>s.O[e](n[c])))?n.splice(c--,1):(a=!1,i<r&&(r=i));if(a){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var i=Object.create(null);s.r(i);var r={};t=t||[null,n({}),n([]),n(n)];for(var a=2&o&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,s.d(i,r),i},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>(({62:"vendors~sr-latn-rs-ui-strings-json",96:"vendors~fi-fi-ui-strings-json",214:"vendors~mk-mk-ui-strings-json",227:"officeaicopilotchatstrings_sv",269:"vendors~sl-si-ui-strings-json",280:"vendors~uk-ua-ui-strings-json",373:"officeaicopilotchatstrings_te",449:"officeaicopilotchatstrings_ur",526:"augloop",622:"vendors~lv-lv-ui-strings-json",626:"vendors~ca-es-ui-strings-json",640:"officeaicopilotchatstrings_ms",643:"vendors~ko-kr-ui-strings-json",673:"officeaicopilotchatstrings_fr-ca",697:"vendors~ar-sa-ui-strings-json",717:"vendors~auth-msal-browser",787:"vendors~sv-se-ui-strings-json",811:"officeaicopilotchatstrings_pa-in",827:"officeaicopilotchatstrings_ca-es-valencia",935:"officeaicopilotchatstrings_ga-ie",1032:"officeaicopilotchatstrings_sd-arab-pk",1034:"sccserviceciq",1039:"officeaicopilotchatstrings_vi",1093:"vendors~gl-es-ui-strings-json",1103:"officeaicopilotchatstrings_zu-za",1182:"vendors~bs-latn-ba-ui-strings-json",1226:"officeaicopilotchatstrings_sw",1285:"vendors~ug-cn-ui-strings-json",1312:"officeaicopilotchatstrings_sr-cyrl-ba",1361:"officeaicopilotchatstrings_ta",1386:"vendors~en-us-ui-strings-json",1411:"vendors~code-preview-dialog",1414:"vendors~fr-fr-ui-strings-json",1426:"vendors~sk-sk-ui-strings-json",1440:"vendors~it-it-ui-strings-json",1511:"office-iss",1565:"vendors~sccservicevoiceaugloop",1604:"sccciqv2plugin",1634:"vendors~lo-la-ui-strings-json",1642:"vendors~pl-pl-ui-strings-json",1668:"officeaicopilotchatstrings_quz-pe",1713:"vendors~officeaicopilot-voice-realtime",1751:"officeaicopilotchatstrings_ru",1758:"vendors~fr-ca-ui-strings-json",1864:"vendors~ta-in-ui-strings-json",1893:"vendors~cy-gb-ui-strings-json",1921:"vendors~event-link-plugin",1950:"officeaicopilotchatstrings_eu",2019:"vendors~nn-no-ui-strings-json",2054:"vendors~gd-gb-ui-strings-json",2119:"vendors~cs-cz-ui-strings-json",2163:"officeaicopilotchatstrings_zh-hans",2337:"officeaicopilotchatstrings_da",2401:"vendors~sq-al-ui-strings-json",2615:"vendors~officeaicopilot-assistant",2700:"vendors~pa-in-ui-strings-json",2793:"officeaicopilotchatstrings_gd-gb",2820:"vendors~inlinecreationhvcapp",2871:"vendors~nb-no-ui-strings-json",2899:"officeaicopilotchatstrings_mt-mt",2933:"officeaicopilotchatstrings_de",2935:"officeaicopilotchatstrings_ml",3005:"officeaicopilotchatstrings_hi",3036:"officeaicopilotchatstrings_sq",3047:"officeaicopilotchatstrings_sr",3049:"officeaicopilotchatstrings_pt-pt",3071:"officeaicopilotchatstrings_el",3073:"officeaicopilotchatstrings_no",3106:"vendors~lt-lt-ui-strings-json",3124:"vendors~az-latn-az-ui-strings-json",3146:"vendors~fa-ir-ui-strings-json",3151:"vendors~zh-tw-ui-strings-json",3327:"vendors~sr-cyrl-ba-ui-strings-json",3388:"vendors~te-in-ui-strings-json",3431:"officeaicopilotchatstrings_lt",3449:"officeaicopilotchatstrings_mr",3457:"officeaicopilotchatstrings_hu",3494:"vendors~hr-hr-ui-strings-json",3536:"officeaicopilotchatstrings_bn-in",3554:"vendors~nl-nl-ui-strings-json",3561:"officeaicopilotchatstrings_sl",3592:"vendors~ga-ie-ui-strings-json",3601:"officeaicopilotchatstrings_he",3624:"vendors~hu-hu-ui-strings-json",3637:"vendors~ja-jp-ui-strings-json",3670:"officeaicopilotchatstrings_si-lk",3674:"vendors~ml-in-ui-strings-json",3718:"vendors~es-es-ui-strings-json",3790:"vendors~ur-pk-ui-strings-json",3912:"officeaicopilotchatstrings_mk",3936:"vendors~bg-bg-ui-strings-json",3987:"vendors~bn-in-ui-strings-json",4016:"officeaicopilotchatstrings_pt",4121:"officeaicopilotchatstrings_af",4123:"officeaicopilotchatstrings_ja",4135:"vendors~hy-am-ui-strings-json",4156:"officeaicopilotchatstrings_ca",4328:"vendors~ms-my-ui-strings-json",4388:"vendors~uz-latn-uz-ui-strings-json",4445:"officeaicopilotchatstrings_hy",4499:"officeaicopilotchatstrings_it",4569:"people-link-plugin",4692:"officeaicopilotchatstrings_cy",4775:"officeaicopilotchatstrings_be-by",4786:"vendors~af-za-ui-strings-json",4858:"officeaicopilotchatstrings_en-us",4972:"officeaicopilotchatstrings_zh-hant",5016:"vendors~podcastui",5099:"vendors~file-link-plugin",5136:"officeaicopilotchatstrings_th",5202:"vendors~th-th-ui-strings-json",5203:"officeaicopilotchatstrings_kn",5214:"officeaicopilotchatstrings_kk",5273:"officeaicopilotchatstrings_en-gb",5431:"officeaicopilotchatstrings_fa",5501:"officeaicopilotchatstrings_ar",5575:"vendors~am-et-ui-strings-json",5610:"officeaicopilotchatstrings_tr",5612:"officeaicopilotchatstrings_nn-no",5650:"vendors~ka-ge-ui-strings-json",5663:"officeaicopilotchatstrings_fi",5664:"officeaicopilotchatstrings_uk",5717:"vendors~et-ee-ui-strings-json",5756:"vendors~kok-in-ui-strings-json",5812:"officeaicopilotchatstrings_gu",5821:"officeaicopilotchatstrings_kok",5882:"officeaicopilotchatstrings_nl",5905:"vendors~sr-cyrl-rs-ui-strings-json",5939:"officeaicopilotchatstrings_id",5943:"officeaicopilotchatstrings_mi-nz",6008:"editor",6030:"vendors~or-in-ui-strings-json",6102:"vendors~pt-br-ui-strings-json",6121:"officeaicopilotchatstrings_prs",6193:"officeaicopilotchatstrings_fil",6202:"officeaicopilotchatstrings_ko",6223:"vendors~vi-vn-ui-strings-json",6343:"officeaicopilotchatstrings_et",6385:"vendors~lb-lu-ui-strings-json",6470:"officeaicopilotchatstrings_ug-cn",6480:"vendors~ro-ro-ui-strings-json",6746:"officeaicopilotchatstrings_sr-cyrl",6759:"dialog-modal",6814:"vendors~kn-in-ui-strings-json",6852:"vendors~mr-in-ui-strings-json",6862:"officeaicopilotchatstrings_hr",6869:"vendors~tt-ru-ui-strings-json",6932:"officeaicopilotchatstrings_km-kh",6966:"officeaicopilotchatstrings_sk",7033:"officeaicopilotchatstrings_uz",7055:"officeaicopilotchatstrings_az-latn-az",7130:"vendors~pt-pt-ui-strings-json",7153:"officeaicopilotchatstrings_bs-latn-ba",7193:"vendors~sccserviceciq",7288:"officeaicopilotchatstrings_pl",7320:"officeaicopilotchatstrings_es",7358:"vendors~copilotchatdisplay",7392:"vendors~ru-ru-ui-strings-json",7420:"officeaicopilotchatstrings_tt",7490:"officeaicopilotchatstrings_lb-lu",7536:"vendors~id-id-ui-strings-json",7587:"vendors~quz-pe-ui-strings-json",7590:"vendors~he-il-ui-strings-json",7628:"officeaicopilotchatstrings_fr",7676:"vendors~hi-in-ui-strings-json",7876:"vendors~eu-es-ui-strings-json",7965:"officeaicopilotchatstrings_ro",7999:"officeaicopilotchatstrings_bn-bd",8021:"officeaicopilotchatstrings_bg",8063:"officeaicopilotchatstrings_ha-latn-ng",8088:"vendors~ca-es-valencia-ui-strings-json",8108:"vendors~el-gr-ui-strings-json",8224:"officeaicopilotchatstrings_as-in",8261:"vendors~scc-react-markdown-renderer-light-weight-code-block",8287:"vendors~gu-in-ui-strings-json",8294:"vendors~is-is-ui-strings-json",8409:"vendors~spfx-react-component",8499:"vendors~km-kh-ui-strings-json",8533:"vendors~personaimage",8542:"vendors~da-dk-ui-strings-json",8543:"vendors~kk-kz-ui-strings-json",8582:"officeaicopilotchatstrings_ne-np",8656:"vendors~mt-mt-ui-strings-json",8762:"officeaicopilotchatstrings_am",8767:"officeaicopilotchatstrings_mn-mn",8830:"officeaicopilotchatstrings_es-mx",8892:"officeaicopilotchatstrings_is",8908:"vendors~mi-nz-ui-strings-json",9005:"officeaicopilotchatstrings_lo-la",9203:"officeaicopilotchatstrings_or",9206:"officeaicopilotchatstrings_lv",9269:"vendors~es-mx-ui-strings-json",9452:"officeaicopilotchatstrings_ky",9537:"vendors~ne-np-ui-strings-json",9638:"vendors~en-gb-ui-strings-json",9669:"officeaicopilotchatstrings_gl",9675:"vendors~zh-cn-ui-strings-json",9693:"officeaicopilotchatstrings_tk-tm",9761:"vendors~fil-ph-ui-strings-json",9832:"vendors~de-de-ui-strings-json",9918:"officeaicopilotchatstrings_cs",9926:"vendors~tr-tr-ui-strings-json",9983:"vendors~as-in-ui-strings-json",9988:"officeaicopilotchatstrings_ka"}[e]||e)+".js"),s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},i="TypeScriptModule:",s.l=(e,t,n,r)=>{if(o[e])o[e].push(t);else{var a,c;if(void 0!==n)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+n){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",i+n),a.src=e),o[e]=[t];var f=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var i=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j=8654,(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b=document.baseURI||self.location.href;var e={8654:0};s.f.j=(t,n)=>{var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var i=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=i);var r=s.p+s.u(t),a=new Error;s.l(r,(n=>{if(s.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",a.name="ChunkLoadError",a.type=i,a.request=r,o[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[r,a,c]=n,l=0;if(r.some((t=>0!==e[t]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(c)var u=c(s)}for(t&&t(n);l<r.length;l++)i=r[l],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(u)},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0;var c=s.O(void 0,[6105,3062,9037,3341],(()=>s(19369)));c=s.O(c),TypeScriptModule=c})();
//# sourceMappingURL=cloudFilePickerDialog.js.map