"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[9412],{78054:(e,t,n)=>{n.d(t,{E:()=>Zn});var i={};n.r(i),n.d(i,{hasBrowserEnv:()=>pe,hasStandardBrowserEnv:()=>fe,hasStandardBrowserWebWorkerEnv:()=>me,navigator:()=>he,origin:()=>Ee});var s=n(3495);function r(e,t){return function(){return e.apply(t,arguments)}}var o=n(72715);const{toString:a}=Object.prototype,{getPrototypeOf:l}=Object,c=(u=Object.create(null),e=>{const t=a.call(e);return u[t]||(u[t]=t.slice(8,-1).toLowerCase())});var u;const d=e=>(e=e.toLowerCase(),t=>c(t)===e),g=e=>t=>typeof t===e,{isArray:p}=Array,h=g("undefined");const f=d("ArrayBuffer");const m=g("string"),E=g("function"),y=g("number"),v=e=>null!==e&&"object"==typeof e,T=e=>{if("object"!==c(e))return!1;const t=l(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},S=d("Date"),R=d("File"),b=d("Blob"),C=d("FileList"),w=d("URLSearchParams"),[O,I,A,_]=["ReadableStream","Request","Response","Headers"].map(d);function D(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let i,s;if("object"!=typeof e&&(e=[e]),p(e))for(i=0,s=e.length;i<s;i++)t.call(null,e[i],i,e);else{const s=n?Object.getOwnPropertyNames(e):Object.keys(e),r=s.length;let o;for(i=0;i<r;i++)o=s[i],t.call(null,e[o],o,e)}}function P(e,t){t=t.toLowerCase();const n=Object.keys(e);let i,s=n.length;for(;s-- >0;)if(i=n[s],t===i.toLowerCase())return i;return null}const U="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,N=e=>!h(e)&&e!==U;const M=(L="undefined"!=typeof Uint8Array&&l(Uint8Array),e=>L&&e instanceof L);var L;const x=d("HTMLFormElement"),B=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),F=d("RegExp"),k=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};D(n,((n,s)=>{let r;!1!==(r=t(n,s,e))&&(i[s]=r||n)})),Object.defineProperties(e,i)};const H=d("AsyncFunction"),j=(q="function"==typeof setImmediate,G=E(U.postMessage),q?setImmediate:G?(z=`axios@${Math.random()}`,W=[],U.addEventListener("message",(({source:e,data:t})=>{e===U&&t===z&&W.length&&W.shift()()}),!1),e=>{W.push(e),U.postMessage(z,"*")}):e=>setTimeout(e));var q,G,z,W;const $="undefined"!=typeof queueMicrotask?queueMicrotask.bind(U):void 0!==o&&o.nextTick||j,J={isArray:p,isArrayBuffer:f,isBuffer:function(e){return null!==e&&!h(e)&&null!==e.constructor&&!h(e.constructor)&&E(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||E(e.append)&&("formdata"===(t=c(e))||"object"===t&&E(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&f(e.buffer),t},isString:m,isNumber:y,isBoolean:e=>!0===e||!1===e,isObject:v,isPlainObject:T,isReadableStream:O,isRequest:I,isResponse:A,isHeaders:_,isUndefined:h,isDate:S,isFile:R,isBlob:b,isRegExp:F,isFunction:E,isStream:e=>v(e)&&E(e.pipe),isURLSearchParams:w,isTypedArray:M,isFileList:C,forEach:D,merge:function e(){const{caseless:t}=N(this)&&this||{},n={},i=(i,s)=>{const r=t&&P(n,s)||s;T(n[r])&&T(i)?n[r]=e(n[r],i):T(i)?n[r]=e({},i):p(i)?n[r]=i.slice():n[r]=i};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&D(arguments[e],i);return n},extend:(e,t,n,{allOwnKeys:i}={})=>(D(t,((t,i)=>{n&&E(t)?e[i]=r(t,n):e[i]=t}),{allOwnKeys:i}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let s,r,o;const a={};if(t=t||{},null==e)return t;do{for(s=Object.getOwnPropertyNames(e),r=s.length;r-- >0;)o=s[r],i&&!i(o,e,t)||a[o]||(t[o]=e[o],a[o]=!0);e=!1!==n&&l(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:c,kindOfTest:d,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if(p(e))return e;let t=e.length;if(!y(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=n.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:x,hasOwnProperty:B,hasOwnProp:B,reduceDescriptors:k,freezeMethods:e=>{k(e,((t,n)=>{if(E(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];E(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},i=e=>{e.forEach((e=>{n[e]=!0}))};return p(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:P,global:U,isContextDefined:N,isSpecCompliantForm:function(e){return!!(e&&E(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),n=(e,i)=>{if(v(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[i]=e;const s=p(e)?[]:{};return D(e,((e,t)=>{const r=n(e,i+1);!h(r)&&(s[t]=r)})),t[i]=void 0,s}}return e};return n(e,0)},isAsyncFn:H,isThenable:e=>e&&(v(e)||E(e))&&E(e.then)&&E(e.catch),setImmediate:j,asap:$};function V(e,t,n,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}J.inherits(V,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:J.toJSONObject(this.config),code:this.code,status:this.status}}});const Q=V.prototype,K={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{K[e]={value:e}})),Object.defineProperties(V,K),Object.defineProperty(Q,"isAxiosError",{value:!0}),V.from=(e,t,n,i,s,r)=>{const o=Object.create(Q);return J.toFlatObject(e,o,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),V.call(o,e.message,t,n,i,s),o.cause=e,o.name=e.name,r&&Object.assign(o,r),o};const Y=V;var X=n(37542).Buffer;function Z(e){return J.isPlainObject(e)||J.isArray(e)}function ee(e){return J.endsWith(e,"[]")?e.slice(0,-2):e}function te(e,t,n){return e?e.concat(t).map((function(e,t){return e=ee(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const ne=J.toFlatObject(J,{},null,(function(e){return/^is[A-Z]/.test(e)}));const ie=function(e,t,n){if(!J.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=J.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!J.isUndefined(t[e])}))).metaTokens,s=n.visitor||c,r=n.dots,o=n.indexes,a=(n.Blob||"undefined"!=typeof Blob&&Blob)&&J.isSpecCompliantForm(t);if(!J.isFunction(s))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(J.isDate(e))return e.toISOString();if(!a&&J.isBlob(e))throw new Y("Blob is not supported. Use a Buffer instead.");return J.isArrayBuffer(e)||J.isTypedArray(e)?a&&"function"==typeof Blob?new Blob([e]):X.from(e):e}function c(e,n,s){let a=e;if(e&&!s&&"object"==typeof e)if(J.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(J.isArray(e)&&function(e){return J.isArray(e)&&!e.some(Z)}(e)||(J.isFileList(e)||J.endsWith(n,"[]"))&&(a=J.toArray(e)))return n=ee(n),a.forEach((function(e,i){!J.isUndefined(e)&&null!==e&&t.append(!0===o?te([n],i,r):null===o?n:n+"[]",l(e))})),!1;return!!Z(e)||(t.append(te(s,n,r),l(e)),!1)}const u=[],d=Object.assign(ne,{defaultVisitor:c,convertValue:l,isVisitable:Z});if(!J.isObject(e))throw new TypeError("data must be an object");return function e(n,i){if(!J.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),J.forEach(n,(function(n,r){!0===(!(J.isUndefined(n)||null===n)&&s.call(t,n,J.isString(r)?r.trim():r,i,d))&&e(n,i?i.concat(r):[r])})),u.pop()}}(e),t};function se(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function re(e,t){this._pairs=[],e&&ie(e,this,t)}const oe=re.prototype;oe.append=function(e,t){this._pairs.push([e,t])},oe.toString=function(e){const t=e?function(t){return e.call(this,t,se)}:se;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const ae=re;function le(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ce(e,t,n){if(!t)return e;const i=n&&n.encode||le;J.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let r;if(r=s?s(t,n):J.isURLSearchParams(t)?t.toString():new ae(t,n).toString(i),r){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}const ue=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){J.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},de={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ge={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:ae,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},pe="undefined"!=typeof window&&"undefined"!=typeof document,he="object"==typeof navigator&&navigator||void 0,fe=pe&&(!he||["ReactNative","NativeScript","NS"].indexOf(he.product)<0),me="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Ee=pe&&window.location.href||"http://localhost",ye={...i,...ge};const ve=function(e){function t(e,n,i,s){let r=e[s++];if("__proto__"===r)return!0;const o=Number.isFinite(+r),a=s>=e.length;if(r=!r&&J.isArray(i)?i.length:r,a)return J.hasOwnProp(i,r)?i[r]=[i[r],n]:i[r]=n,!o;i[r]&&J.isObject(i[r])||(i[r]=[]);return t(e,n,i[r],s)&&J.isArray(i[r])&&(i[r]=function(e){const t={},n=Object.keys(e);let i;const s=n.length;let r;for(i=0;i<s;i++)r=n[i],t[r]=e[r];return t}(i[r])),!o}if(J.isFormData(e)&&J.isFunction(e.entries)){const n={};return J.forEachEntry(e,((e,i)=>{t(function(e){return J.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),i,n,0)})),n}return null};const Te={transitional:de,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,s=J.isObject(e);s&&J.isHTMLForm(e)&&(e=new FormData(e));if(J.isFormData(e))return i?JSON.stringify(ve(e)):e;if(J.isArrayBuffer(e)||J.isBuffer(e)||J.isStream(e)||J.isFile(e)||J.isBlob(e)||J.isReadableStream(e))return e;if(J.isArrayBufferView(e))return e.buffer;if(J.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let r;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ie(e,new ye.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,i){return ye.isNode&&J.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((r=J.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return ie(r?{"files[]":e}:e,t&&new t,this.formSerializer)}}return s||i?(t.setContentType("application/json",!1),function(e,t,n){if(J.isString(e))try{return(t||JSON.parse)(e),J.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Te.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(J.isResponse(e)||J.isReadableStream(e))return e;if(e&&J.isString(e)&&(n&&!this.responseType||i)){const n=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw Y.from(e,Y.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ye.classes.FormData,Blob:ye.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};J.forEach(["delete","get","head","post","put","patch"],(e=>{Te.headers[e]={}}));const Se=Te,Re=J.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),be=Symbol("internals");function Ce(e){return e&&String(e).trim().toLowerCase()}function we(e){return!1===e||null==e?e:J.isArray(e)?e.map(we):String(e)}function Oe(e,t,n,i,s){return J.isFunction(i)?i.call(this,t,n):(s&&(t=n),J.isString(t)?J.isString(i)?-1!==t.indexOf(i):J.isRegExp(i)?i.test(t):void 0:void 0)}class Ie{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function s(e,t,n){const s=Ce(t);if(!s)throw new Error("header name must be a non-empty string");const r=J.findKey(i,s);(!r||void 0===i[r]||!0===n||void 0===n&&!1!==i[r])&&(i[r||t]=we(e))}const r=(e,t)=>J.forEach(e,((e,n)=>s(e,n,t)));if(J.isPlainObject(e)||e instanceof this.constructor)r(e,t);else if(J.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))r((e=>{const t={};let n,i,s;return e&&e.split("\n").forEach((function(e){s=e.indexOf(":"),n=e.substring(0,s).trim().toLowerCase(),i=e.substring(s+1).trim(),!n||t[n]&&Re[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)})),t})(e),t);else if(J.isHeaders(e))for(const[t,i]of e.entries())s(i,t,n);else null!=e&&s(t,e,n);return this}get(e,t){if(e=Ce(e)){const n=J.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}(e);if(J.isFunction(t))return t.call(this,e,n);if(J.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Ce(e)){const n=J.findKey(this,e);return!(!n||void 0===this[n]||t&&!Oe(0,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function s(e){if(e=Ce(e)){const s=J.findKey(n,e);!s||t&&!Oe(0,n[s],s,t)||(delete n[s],i=!0)}}return J.isArray(e)?e.forEach(s):s(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const s=t[n];e&&!Oe(0,this[s],s,e,!0)||(delete this[s],i=!0)}return i}normalize(e){const t=this,n={};return J.forEach(this,((i,s)=>{const r=J.findKey(n,s);if(r)return t[r]=we(i),void delete t[s];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(s):String(s).trim();o!==s&&delete t[s],t[o]=we(i),n[o]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return J.forEach(this,((n,i)=>{null!=n&&!1!==n&&(t[i]=e&&J.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[be]=this[be]={accessors:{}}).accessors,n=this.prototype;function i(e){const i=Ce(e);t[i]||(!function(e,t){const n=J.toCamelCase(" "+t);["get","set","has"].forEach((i=>{Object.defineProperty(e,i+n,{value:function(e,n,s){return this[i].call(this,t,e,n,s)},configurable:!0})}))}(n,e),t[i]=!0)}return J.isArray(e)?e.forEach(i):i(e),this}}Ie.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),J.reduceDescriptors(Ie.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),J.freezeMethods(Ie);const Ae=Ie;function _e(e,t){const n=this||Se,i=t||n,s=Ae.from(i.headers);let r=i.data;return J.forEach(e,(function(e){r=e.call(n,r,s.normalize(),t?t.status:void 0)})),s.normalize(),r}function De(e){return!(!e||!e.__CANCEL__)}function Pe(e,t,n){Y.call(this,null==e?"canceled":e,Y.ERR_CANCELED,t,n),this.name="CanceledError"}J.inherits(Pe,Y,{__CANCEL__:!0});const Ue=Pe;function Ne(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new Y("Request failed with status code "+n.status,[Y.ERR_BAD_REQUEST,Y.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Me=function(e,t){e=e||10;const n=new Array(e),i=new Array(e);let s,r=0,o=0;return t=void 0!==t?t:1e3,function(a){const l=Date.now(),c=i[o];s||(s=l),n[r]=a,i[r]=l;let u=o,d=0;for(;u!==r;)d+=n[u++],u%=e;if(r=(r+1)%e,r===o&&(o=(o+1)%e),l-s<t)return;const g=c&&l-c;return g?Math.round(1e3*d/g):void 0}};const Le=function(e,t){let n,i,s=0,r=1e3/t;const o=(t,r=Date.now())=>{s=r,n=null,i&&(clearTimeout(i),i=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),a=t-s;a>=r?o(e,t):(n=e,i||(i=setTimeout((()=>{i=null,o(n)}),r-a)))},()=>n&&o(n)]},xe=(e,t,n=3)=>{let i=0;const s=Me(50,250);return Le((n=>{const r=n.loaded,o=n.lengthComputable?n.total:void 0,a=r-i,l=s(a);i=r;e({loaded:r,total:o,progress:o?r/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&r<=o?(o-r)/l:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})}),n)},Be=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},Fe=e=>(...t)=>J.asap((()=>e(...t))),ke=ye.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ye.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ye.origin),ye.navigator&&/(msie|trident)/i.test(ye.navigator.userAgent)):()=>!0,He=ye.hasStandardBrowserEnv?{write(e,t,n,i,s,r){const o=[e+"="+encodeURIComponent(t)];J.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),J.isString(i)&&o.push("path="+i),J.isString(s)&&o.push("domain="+s),!0===r&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function je(e,t,n){let i=!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t);return e&&(i||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const qe=e=>e instanceof Ae?{...e}:e;function Ge(e,t){t=t||{};const n={};function i(e,t,n,i){return J.isPlainObject(e)&&J.isPlainObject(t)?J.merge.call({caseless:i},e,t):J.isPlainObject(t)?J.merge({},t):J.isArray(t)?t.slice():t}function s(e,t,n,s){return J.isUndefined(t)?J.isUndefined(e)?void 0:i(void 0,e,0,s):i(e,t,0,s)}function r(e,t){if(!J.isUndefined(t))return i(void 0,t)}function o(e,t){return J.isUndefined(t)?J.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function a(n,s,r){return r in t?i(n,s):r in e?i(void 0,n):void 0}const l={url:r,method:r,data:r,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(e,t,n)=>s(qe(e),qe(t),0,!0)};return J.forEach(Object.keys(Object.assign({},e,t)),(function(i){const r=l[i]||s,o=r(e[i],t[i],i);J.isUndefined(o)&&r!==a||(n[i]=o)})),n}const ze=e=>{const t=Ge({},e);let n,{data:i,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:o,headers:a,auth:l}=t;if(t.headers=a=Ae.from(a),t.url=ce(je(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),J.isFormData(i))if(ye.hasStandardBrowserEnv||ye.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(n=a.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];a.setContentType([e||"multipart/form-data",...t].join("; "))}if(ye.hasStandardBrowserEnv&&(s&&J.isFunction(s)&&(s=s(t)),s||!1!==s&&ke(t.url))){const e=r&&o&&He.read(o);e&&a.set(r,e)}return t},We="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const i=ze(e);let s=i.data;const r=Ae.from(i.headers).normalize();let o,a,l,c,u,{responseType:d,onUploadProgress:g,onDownloadProgress:p}=i;function h(){c&&c(),u&&u(),i.cancelToken&&i.cancelToken.unsubscribe(o),i.signal&&i.signal.removeEventListener("abort",o)}let f=new XMLHttpRequest;function m(){if(!f)return;const i=Ae.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders());Ne((function(e){t(e),h()}),(function(e){n(e),h()}),{data:d&&"text"!==d&&"json"!==d?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:i,config:e,request:f}),f=null}f.open(i.method.toUpperCase(),i.url,!0),f.timeout=i.timeout,"onloadend"in f?f.onloadend=m:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(m)},f.onabort=function(){f&&(n(new Y("Request aborted",Y.ECONNABORTED,e,f)),f=null)},f.onerror=function(){n(new Y("Network Error",Y.ERR_NETWORK,e,f)),f=null},f.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const s=i.transitional||de;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new Y(t,s.clarifyTimeoutError?Y.ETIMEDOUT:Y.ECONNABORTED,e,f)),f=null},void 0===s&&r.setContentType(null),"setRequestHeader"in f&&J.forEach(r.toJSON(),(function(e,t){f.setRequestHeader(t,e)})),J.isUndefined(i.withCredentials)||(f.withCredentials=!!i.withCredentials),d&&"json"!==d&&(f.responseType=i.responseType),p&&([l,u]=xe(p,!0),f.addEventListener("progress",l)),g&&f.upload&&([a,c]=xe(g),f.upload.addEventListener("progress",a),f.upload.addEventListener("loadend",c)),(i.cancelToken||i.signal)&&(o=t=>{f&&(n(!t||t.type?new Ue(null,e,f):t),f.abort(),f=null)},i.cancelToken&&i.cancelToken.subscribe(o),i.signal&&(i.signal.aborted?o():i.signal.addEventListener("abort",o)));const E=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);E&&-1===ye.protocols.indexOf(E)?n(new Y("Unsupported protocol "+E+":",Y.ERR_BAD_REQUEST,e)):f.send(s||null)}))},$e=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,i=new AbortController;const s=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;i.abort(t instanceof Y?t:new Ue(t instanceof Error?t.message:t))}};let r=t&&setTimeout((()=>{r=null,s(new Y(`timeout ${t} of ms exceeded`,Y.ETIMEDOUT))}),t);const o=()=>{e&&(r&&clearTimeout(r),r=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(s):e.removeEventListener("abort",s)})),e=null)};e.forEach((e=>e.addEventListener("abort",s)));const{signal:a}=i;return a.unsubscribe=()=>J.asap(o),a}},Je=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,s=0;for(;s<n;)i=s+t,yield e.slice(s,i),s=i},Ve=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},Qe=(e,t,n,i)=>{const s=async function*(e,t){for await(const n of Ve(e))yield*Je(n,t)}(e,t);let r,o=0,a=e=>{r||(r=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await s.next();if(t)return a(),void e.close();let r=i.byteLength;if(n){let e=o+=r;n(e)}e.enqueue(new Uint8Array(i))}catch(e){throw a(e),e}},cancel:e=>(a(e),s.return())},{highWaterMark:2})},Ke="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,Ye=Ke&&"function"==typeof ReadableStream,Xe=Ke&&("function"==typeof TextEncoder?(Ze=new TextEncoder,e=>Ze.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Ze;const et=(e,...t)=>{try{return!!e(...t)}catch(e){return!1}},tt=Ye&&et((()=>{let e=!1;const t=new Request(ye.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),nt=Ye&&et((()=>J.isReadableStream(new Response("").body))),it={stream:nt&&(e=>e.body)};var st;Ke&&(st=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!it[e]&&(it[e]=J.isFunction(st[e])?t=>t[e]():(t,n)=>{throw new Y(`Response type '${e}' is not supported`,Y.ERR_NOT_SUPPORT,n)})})));const rt=async(e,t)=>{const n=J.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(J.isBlob(e))return e.size;if(J.isSpecCompliantForm(e)){const t=new Request(ye.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return J.isArrayBufferView(e)||J.isArrayBuffer(e)?e.byteLength:(J.isURLSearchParams(e)&&(e+=""),J.isString(e)?(await Xe(e)).byteLength:void 0)})(t):n},ot=Ke&&(async e=>{let{url:t,method:n,data:i,signal:s,cancelToken:r,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:g}=ze(e);c=c?(c+"").toLowerCase():"text";let p,h=$e([s,r&&r.toAbortSignal()],o);const f=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let m;try{if(l&&tt&&"get"!==n&&"head"!==n&&0!==(m=await rt(u,i))){let e,n=new Request(t,{method:"POST",body:i,duplex:"half"});if(J.isFormData(i)&&(e=n.headers.get("content-type"))&&u.setContentType(e),n.body){const[e,t]=Be(m,xe(Fe(l)));i=Qe(n.body,65536,e,t)}}J.isString(d)||(d=d?"include":"omit");const s="credentials"in Request.prototype;p=new Request(t,{...g,signal:h,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:i,duplex:"half",credentials:s?d:void 0});let r=await fetch(p);const o=nt&&("stream"===c||"response"===c);if(nt&&(a||o&&f)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=r[t]}));const t=J.toFiniteNumber(r.headers.get("content-length")),[n,i]=a&&Be(t,xe(Fe(a),!0))||[];r=new Response(Qe(r.body,65536,n,(()=>{i&&i(),f&&f()})),e)}c=c||"text";let E=await it[J.findKey(it,c)||"text"](r,e);return!o&&f&&f(),await new Promise(((t,n)=>{Ne(t,n,{data:E,headers:Ae.from(r.headers),status:r.status,statusText:r.statusText,config:e,request:p})}))}catch(t){if(f&&f(),t&&"TypeError"===t.name&&/fetch/i.test(t.message))throw Object.assign(new Y("Network Error",Y.ERR_NETWORK,e,p),{cause:t.cause||t});throw Y.from(t,t&&t.code,e,p)}}),at={http:null,xhr:We,fetch:ot};J.forEach(at,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const lt=e=>`- ${e}`,ct=e=>J.isFunction(e)||null===e||!1===e,ut=e=>{e=J.isArray(e)?e:[e];const{length:t}=e;let n,i;const s={};for(let r=0;r<t;r++){let t;if(n=e[r],i=n,!ct(n)&&(i=at[(t=String(n)).toLowerCase()],void 0===i))throw new Y(`Unknown adapter '${t}'`);if(i)break;s[t||"#"+r]=i}if(!i){const e=Object.entries(s).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map(lt).join("\n"):" "+lt(e[0]):"as no adapter specified";throw new Y("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return i};function dt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ue(null,e)}function gt(e){dt(e),e.headers=Ae.from(e.headers),e.data=_e.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return ut(e.adapter||Se.adapter)(e).then((function(t){return dt(e),t.data=_e.call(e,e.transformResponse,t),t.headers=Ae.from(t.headers),t}),(function(t){return De(t)||(dt(e),t&&t.response&&(t.response.data=_e.call(e,e.transformResponse,t.response),t.response.headers=Ae.from(t.response.headers))),Promise.reject(t)}))}const pt="1.8.4";var ht=n(58651);const ft={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{ft[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const mt={};ft.transitional=function(e,t,n){function i(e,t){return"[Axios v1.8.4] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,s,r)=>{if(!1===e)throw new Y(i(s," has been removed"+(t?" in "+t:"")),Y.ERR_DEPRECATED);return t&&!mt[s]&&(mt[s]=!0,ht.warn(i(s," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,s,r)}},ft.spelling=function(e){return(t,n)=>(ht.warn(`${n} is likely a misspelling of ${e}`),!0)};const Et={assertOptions:function(e,t,n){if("object"!=typeof e)throw new Y("options must be an object",Y.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let s=i.length;for(;s-- >0;){const r=i[s],o=t[r];if(o){const t=e[r],n=void 0===t||o(t,r,e);if(!0!==n)throw new Y("option "+r+" must be "+n,Y.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new Y("Unknown option "+r,Y.ERR_BAD_OPTION)}},validators:ft},yt=Et.validators;class vt{constructor(e){this.defaults=e,this.interceptors={request:new ue,response:new ue}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Ge(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:s}=t;void 0!==n&&Et.assertOptions(n,{silentJSONParsing:yt.transitional(yt.boolean),forcedJSONParsing:yt.transitional(yt.boolean),clarifyTimeoutError:yt.transitional(yt.boolean)},!1),null!=i&&(J.isFunction(i)?t.paramsSerializer={serialize:i}:Et.assertOptions(i,{encode:yt.function,serialize:yt.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Et.assertOptions(t,{baseUrl:yt.spelling("baseURL"),withXsrfToken:yt.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let r=s&&J.merge(s.common,s[t.method]);s&&J.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete s[e]})),t.headers=Ae.concat(r,s);const o=[];let a=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,o.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let u,d=0;if(!a){const e=[gt.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,l),u=e.length,c=Promise.resolve(t);d<u;)c=c.then(e[d++],e[d++]);return c}u=o.length;let g=t;for(d=0;d<u;){const e=o[d++],t=o[d++];try{g=e(g)}catch(e){t.call(this,e);break}}try{c=gt.call(this,g)}catch(e){return Promise.reject(e)}for(d=0,u=l.length;d<u;)c=c.then(l[d++],l[d++]);return c}getUri(e){return ce(je((e=Ge(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}J.forEach(["delete","get","head","options"],(function(e){vt.prototype[e]=function(t,n){return this.request(Ge(n||{},{method:e,url:t,data:(n||{}).data}))}})),J.forEach(["post","put","patch"],(function(e){function t(t){return function(n,i,s){return this.request(Ge(s||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}vt.prototype[e]=t(),vt.prototype[e+"Form"]=t(!0)}));const Tt=vt;class St{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const i=new Promise((e=>{n.subscribe(e),t=e})).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e((function(e,i,s){n.reason||(n.reason=new Ue(e,i,s),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new St((function(t){e=t})),cancel:e}}}const Rt=St;const bt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(bt).forEach((([e,t])=>{bt[t]=e}));const Ct=bt;const wt=function e(t){const n=new Tt(t),i=r(Tt.prototype.request,n);return J.extend(i,Tt.prototype,n,{allOwnKeys:!0}),J.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return e(Ge(t,n))},i}(Se);wt.Axios=Tt,wt.CanceledError=Ue,wt.CancelToken=Rt,wt.isCancel=De,wt.VERSION=pt,wt.toFormData=ie,wt.AxiosError=Y,wt.Cancel=wt.CanceledError,wt.all=function(e){return Promise.all(e)},wt.spread=function(e){return function(t){return e.apply(null,t)}},wt.isAxiosError=function(e){return J.isObject(e)&&!0===e.isAxiosError},wt.mergeConfig=Ge,wt.AxiosHeaders=Ae,wt.formToJSON=e=>ve(J.isHTMLForm(e)?new FormData(e):e),wt.getAdapter=ut,wt.HttpStatusCode=Ct,wt.default=wt;const Ot=wt;class It{constructor(e,t){this.defaultRequestTimeoutMS=8e3,this.axiosInstance=It.setAxiosInstance(t),this.clientParams=e,this.lastAbortController=new AbortController}static setAxiosInstance(e){return null!=e?e:Ot.create()}isCancelledByClient(e){return Ot.isCancel(e)}}var At;!function(e){e[e.prod=0]="prod",e[e.edog=1]="edog",e[e.int=2]="int",e[e.local=3]="local",e[e.canary=4]="canary",e[e.euc=5]="euc",e[e.gcc=6]="gcc",e[e.gcc_usge=7]="gcc_usge",e[e.gcc_usgsw=8]="gcc_usgsw",e[e.dod=9]="dod",e[e.edognetcore=10]="edognetcore",e[e.dogfood=11]="dogfood"}(At||(At={}));const _t={AccessToken:"AccessToken",Action:"Action",AudienceGroup:"AudienceGroup",Authorization:"Authorization",Caller:"Caller",ClientBuild:"ClientBuild",ClientId:"ClientId",ClientName:"ClientName",ContainerId:"ContainerId",ContentType:"Content-Type",CorrelationId:"X-Correlation",Correlation_Id:"X-Correlation-ID",DataCenterHint:"X-DC-Hint",DeviceId:"DeviceId",DocId:"DocId",EnableCreditAndPolicyChecksOnDAS:"X-EnableCreditAndPolicyChecksOnDAS",EnableCreditsDevExperience:"X-EnableCreditsDevExperience",EnableFluxExperience:"X-EnableFluxExperience",EnableGptBasedImageGen:"X-EnableGptBasedImageGen",EnvironmentHint:"X-Environment-Hint",ErrorCode:"X-ErrorCode",FailureReason:"X-FailureReason",FileToken:"FileToken",Handler:"Handler",HostApp:"HostApp",InviteCode:"InviteCode",InviteProgram:"InviteProgram",Locale:"Locale",PersistentId:"PersistentId",Platform:"Platform",ReleaseChannel:"ReleaseChannel",SessionId:"SessionId",StatusCode:"StatusCode",ThemeMetadatas:"ThemeMetadatas",Trigger:"Trigger",UploadToStorage:"x-upload-to-storage-das",UserAgent:"User-Agent",UserId:"UserId",UserSessionId:"X-UserSessionId",UserType:"UserType"},Dt={NotEnoughSuggestions:"NotEnoughSuggestions"},Pt="http://localhost:8087",Ut="https://eus2-010.designerapp.edog.officeapps.live.com",Nt="https://designerapp.edog.officeapps.live.com",Mt="https://designerapp.edog.officeapps.live.com:857",Lt="https://designerapp.officeapps.live-int.com",xt="https://canary.designerapp.officeapps.live.com",Bt="https://euc.designerapp.officeapps.live.com",Ft="https://designerapp.gcc.osi.office365.us",kt="https://usge-010.designerapp.gcc.osi.office365.us",Ht="https://usgsw-010.designerapp.gcc.osi.office365.us",jt="https://designerapp.osi.apps.mil",qt="https://designerapp.officeapps.live.com";class Gt{static getBaseUrl(e){switch(e){case At.local:return Pt;case At.edog:return Ut;case At.dogfood:return Nt;case At.edognetcore:return Mt;case At.int:return Lt;case At.canary:return xt;case At.euc:return Bt;case At.gcc:return Ft;case At.gcc_usge:return kt;case At.gcc_usgsw:return Ht;case At.dod:return jt;case At.prod:default:return qt}}static getGettyUsageReportUrl(e){switch(e){case At.euc:return"https://euc.hubblecontent.osi.office.net/contentsvc/api/telemetry/getty";case At.local:case At.edog:case At.dogfood:case At.edognetcore:case At.int:return"https://hubblecontent.df.osi.office.net/contentsvc/api/telemetry/getty";case At.gcc:return"";case At.canary:case At.prod:default:return"https://hubblecontent.osi.office.net/contentsvc/api/telemetry/getty"}}static getDasRing(e){const t=e.toString();if(t===new URL(Pt).toString())return At.local;if(t===new URL(Ut).toString())return At.edog;if(t===new URL(Nt).toString())return At.dogfood;if(t===new URL(Mt).toString())return At.edognetcore;if(t===new URL(Lt).toString())return At.int;if(t===new URL(xt).toString())return At.canary;if(t===new URL(Bt).toString())return At.euc;if(t===new URL(Ft).toString())return At.gcc;if(t===new URL(kt).toString())return At.gcc_usge;if(t===new URL(Ht).toString())return At.gcc_usgsw;if(t===new URL(jt).toString())return At.dod;if(t===new URL(qt).toString())return At.prod;throw new Error("Invalid DAS URL")}static getAccountUrl(e){return this.getBaseUrl(e)+"/designerapp/Account.ashx"}static getAnimationsUrl(e){return this.getBaseUrl(e)+"/designerapp/Animation.ashx"}static getAnimationTemplatesUrl(e){return this.getAnimationsUrl(e)+"?Action=GetAllAnimationTemplates"}static getAppsIntegrationUrl(e){return this.getBaseUrl(e)+"/designerapp/OAuth.ashx"}static getBrandKitEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/BrandKit.ashx"}static getDallEBaseUrl(e){return this.getBaseUrl(e)+"/designerapp/DallE.ashx"}static getDallEImageUrl(e,t){return t?`${t}?action=GetDallEImagesCogSci`:`${this.getDallEBaseUrl(e)}?action=GetDallEImagesCogSci`}static getDallEImageEditsUrl(e,t){return t?`${t}?action=GetDallEImageEdits`:`${this.getDallEBaseUrl(e)}?action=GetDallEImageEdits`}static getDallEReportImageUrl(e){return`${this.getDallEBaseUrl(e)}?action=ReportDallEImage`}static getDocumentEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/Document.ashx"}static getImageTransformUrl(e){return this.getBaseUrl(e)+"/designerapp/imagetransformation.ashx"}static getLoggingUrl(e){return this.getBaseUrl(e)+"/designerapp/RemoteUls.ashx"}static getMediaEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/MediaSuggestions.ashx"}static getMediaUploadUrl(e){return this.getBaseUrl(e)+"/designerapp/Media.ashx"}static getMediaPollUrl(e,t){return this.getBaseUrl(e)+`/designerapp/Media.ashx?action=poll&id=${t}`}static getObjectLevelAnimationUrl(e){return this.getAnimationsUrl(e)+"?Action=ObjectLevelAnimation"}static getPhoneUploadServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/mobileupload.ashx"}static getProactiveSuggestionEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/proactivesuggestions.ashx"}static getPublishUrl(e){return this.getBaseUrl(e)+"/designerapp/Publish.ashx"}static getRealTimeChannelUrl(e){return(this.getBaseUrl(e)+"/designerapp/RealTimeChannel.ashx").replace("http","ws")}static getRecommendedImageServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/FilterRecommendations.ashx"}static getSocialMediaOAuthURL(e,t,n){return this.getBaseUrl(e)+`/designerapp/SocialMedia.ashx?state=${t}&social_media=${n.toLocaleLowerCase()}`}static getStableDiffusionUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx"}static getSAMEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/sam.ashx?Action=SAM"}static getMediaProcessorUrl(e){return this.getBaseUrl(e)+"/designerapp/mediaprocessor.ashx"}static getStableDiffusionGenerativeFontEffectUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx?Action=TextEffects"}static getStableDiffusionObjectRemovalUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx?Action=MIRObjRem"}static getStableDiffusionProductPlacementUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx?Action=ProductPlacement"}static getStableDiffusionReportImageUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx?Action=Report"}static getSubmitTemplateUrl(e){return this.getBaseUrl(e)+"/designerapp/SubmitTemplate.ashx"}static getSuggestionEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/suggestions.ashx"}static getSuggestionThumbnailEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/thumbnail.ashx"}static getSuggestionCompressedThumbnailEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/thumbnail.ashx?action=GetCompressedThumbnail"}static getTraceRequestEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/TraceRequest.ashx"}static getUserAssetsServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/userasset.ashx"}static getWhatsNewEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/notifications.ashx"}static getTryItPromptsUrl(e){return this.getBaseUrl(e)+"/designerapp/TryItPrompts.ashx"}static getOCPSClientUrl(e){return this.getBaseUrl(e)+"/designerapp/OCPSClient.ashx"}static getBotAssetUrl(e,t,n){return this.getBaseUrl(e)+`/designerapp/BotAsset.ashx?chatId=${t}&messageId=${n}`}static getAbuseMonitoringUrl(e){return this.getBaseUrl(e)+"/designerapp/AbuseMonitoring.ashx"}static getTemplateSearchUrl(e){return this.getBaseUrl(e)+"/designerapp/TemplateSearch.ashx"}}var zt=n(61714);var Wt;!function(e){e[e.InProgress=0]="InProgress",e[e.Completed=1]="Completed",e[e.Failed=2]="Failed",e[e.PartiallyCompleted=3]="PartiallyCompleted"}(Wt||(Wt={}));n(8235);Error;var $t=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class Jt{}Jt.tryPopulatePageDataFromUrlForMultiPageSuggestions=(e,t,n,i,s)=>$t(void 0,void 0,void 0,(function*(){var r,o,a,l,c,u,d,g;let p=!0;if(null!=t.multipageSuggestionUrls){const h=yield Promise.all(t.multipageSuggestionUrls.map((t=>e.getSuggestionDataFromFileCacheUrl(t,n,i,s))));for(let e=0;e<h.length;e++)null!=(null===(o=null===(r=h[e])||void 0===r?void 0:r.content)||void 0===o?void 0:o.pageData)?t.multiPageData[e]=null===(l=null===(a=h[e])||void 0===a?void 0:a.content)||void 0===l?void 0:l.pageData:p=!1,null!=(null===(u=null===(c=h[e])||void 0===c?void 0:c.content)||void 0===u?void 0:u.relationshipsData)?t.multiRelationshipsData[e]=null===(g=null===(d=h[e])||void 0===d?void 0:d.content)||void 0===g?void 0:g.relationshipsData:p=!1}return p}));var Vt,Qt,Kt,Yt,Xt,Zt,en,tn=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class nn extends It{constructor(){super(...arguments),this.defaultRequestTimeoutMS=8e3}fetchSuggestions(e,t,n,i){var s,r,o,a,l;return tn(this,void 0,void 0,(function*(){e.cancelLastRequest&&this.lastAbortController.abort();try{this.lastAbortController=new AbortController;const l=dn.createRequestHeaders(this.clientParams,e.requestParams);l["Content-Type"]=e.contentType;const c=n?yield this.fetchSuggestionAsStreamData(e,l,this.lastAbortController,i):yield this.axiosInstance.request({url:this.url,data:e.data,headers:l,method:e.method,params:e.queryParams,timeout:null!==(r=null===(s=e.requestParams)||void 0===s?void 0:s.RequestTimeoutMS)&&void 0!==r?r:this.defaultRequestTimeoutMS,responseType:"arraybuffer",signal:this.lastAbortController.signal}),u=nn.parseDASResponse(c.data,c.headers,c.status,t,n);return(null===(a=null===(o=e.requestParams)||void 0===o?void 0:o.hints)||void 0===a?void 0:a.ShouldPrefetchPictureThumbnails)&&u.then((t=>tn(this,void 0,void 0,(function*(){var n,i,s;(null===(n=null==t?void 0:t.content)||void 0===n?void 0:n.suggestions)&&(yield dn.prefetchThumbnails(t.content.suggestions,null!==(s=null===(i=e.requestParams)||void 0===i?void 0:i.ThumbnailPrefetchTimeoutInMs)&&void 0!==s?s:this.defaultRequestTimeoutMS))})))),yield u}catch(e){const t=this.isCancelledByClient(e),i=n&&"AbortError"===e.name,s=n&&!e.response&&e instanceof DOMException&&(null===(l=e.message)||void 0===l?void 0:l.includes("abort"));if(t||s||i)return{error:Vt.ClientCanceled};throw e}}))}static parseDASResponse(e,t,n,i,s){var r;return tn(this,void 0,void 0,(function*(){if(n){const e=dn.getSuggestionRequestErrorFromStatusCode(n,t);if(e!==Vt.None)return{headers:t,statusCode:n,error:e}}const o=s?dn.validateAndGetContentBody(e):new Uint8Array(e);if(!o||o instanceof Uint8Array&&!o.length)return{headers:t,statusCode:n,error:Vt.NoResponse};const a=null!==(r=t[_t.ContentType])&&void 0!==r?r:t[_t.ContentType.toLowerCase()];if(!a)return{headers:t,statusCode:n,error:Vt.NoResponse};let l={};const c=dn.getContentType(a);return c==Qt.Multipart?l=yield nn.parseMultipartSuggestions(a,o,i,s):c==Qt.JSON&&o instanceof Uint8Array&&(yield mn.parseJSONPart(o,l)),{content:l,headers:t,statusCode:n,error:Vt.None}}))}fetchSuggestionAsStreamData(e,t,n,i){var s,r;return tn(this,void 0,void 0,(function*(){const o=null!==(r=null===(s=e.requestParams)||void 0===s?void 0:s.RequestTimeoutMS)&&void 0!==r?r:this.defaultRequestTimeoutMS;let a;const l=new Promise((e=>a=setTimeout(e,o))),c=fetch(`${this.url}?${e.queryParams.toString()}`,{method:e.method,headers:t,body:e.data,signal:n.signal}),u=yield Promise.race([c,l]);if(!u)throw this.lastAbortController.abort(),new Error(`timeout of ${o}ms exceeded`);if(!u.ok)throw{response:u};a&&clearTimeout(a);const d=u,g=dn.convertHeadersToLowerCase(d.headers);return null==i||i(g),{data:d.body,headers:g,status:d.status}}))}static parseMultipartSuggestions(e,t,n,i){return tn(this,void 0,void 0,(function*(){return n==Kt.SCHEMA_V2?yield Sn.parseMultipartSuggestions(e,t,i):n==Kt.SCHEMA_V1?yield En.parseMultipartSuggestions(e,t,i):yield mn.parseMultipartSuggestions(e,t,i)}))}}class sn extends nn{constructor(){super(...arguments),this.url=Gt.getSuggestionEndpointUrl(this.clientParams.ServiceRing)}getSuggestions(e,t,n,i,s){return tn(this,void 0,void 0,(function*(){const r=JSON.stringify(e),o=new URLSearchParams,a=null==t?void 0:t.DocumentId;return void 0!==a&&o.append("documentId",a),yield this.fetchSuggestions({cancelLastRequest:n,contentType:"application/json",data:r,method:"POST",requestParams:t,queryParams:o},void 0,i,s)}))}shouldKeepPolling(e){var t,n,i,s;return(null===(n=null===(t=e.content)||void 0===t?void 0:t.polling_response)||void 0===n?void 0:n.status)===Yt.InProgress.valueOf()||(null===(s=null===(i=e.content)||void 0===i?void 0:i.polling_response)||void 0===s?void 0:s.status)===Yt.PartiallyCompleted.valueOf()}getPollingSuggestionsPollingUrls(e,t,n,i,s,r,o,a=0){var l,c,u,d,g,p,h;return tn(this,void 0,void 0,(function*(){let f={content:{polling_response:t}},m=0,E=0,y=0,v=0;const T=(new Date).getTime();void 0===e.PollUrl&&(e.PollUrl=null===(l=null==t?void 0:t.polling_meta_data)||void 0===l?void 0:l.poll_url);const S=new URLSearchParams,R=null==i?void 0:i.DocumentId;void 0!==R&&S.append("documentId",R);const b=JSON.stringify(e),C={cancelLastRequest:s,contentType:"application/json",data:b,method:"POST",requestParams:i,queryParams:S};for(;this.shouldKeepPolling(f);){if(y++,m=(new Date).getTime()-T,m>=(null!==(c=null==i?void 0:i.RequestTimeoutMS)&&void 0!==c?c:12e4))throw new Error("Suggestion:Pollimg URL request timeout, while polling for the design suggestions");yield new Promise((e=>{var t,n,i,s;return setTimeout(e,null!==(s=null===(i=null===(n=null===(t=f.content)||void 0===t?void 0:t.polling_response)||void 0===n?void 0:n.polling_meta_data)||void 0===i?void 0:i.poll_interval)&&void 0!==s?s:2e3)}));try{if(f=yield this.fetchSuggestions(C,r,void 0,o),n&&(null===(d=null===(u=f.content)||void 0===u?void 0:u.polling_response)||void 0===d?void 0:d.status)===Yt.PartiallyCompleted.valueOf()&&(null===(g=f.content)||void 0===g?void 0:g.image_urls)&&f.content.image_urls.length>0){v++;const e=null===(h=null===(p=f.content)||void 0===p?void 0:p.image_urls)||void 0===h?void 0:h.map((e=>{var t,n,i;return{ImageUrl:e,CompletionPercentage:null!==(i=null===(n=null===(t=f.content)||void 0===t?void 0:t.polling_response)||void 0===n?void 0:n.version)&&void 0!==i?i:0}}));n(e)}}catch(e){if("Network Error"===e.message&&E<a){E++;continue}throw e}}return f.content&&(f.content.noOfPollingAttempts=y,f.content.noOfPollingProgressiveResults=v),f}))}getMultiPageSuggestions(e,t,n,i,s,r=Kt.SCHEMA_V1){return tn(this,void 0,void 0,(function*(){const o=JSON.stringify(e),a=new URLSearchParams,l=null==t?void 0:t.DocumentId;return void 0!==l&&a.append("documentId",l),yield this.fetchSuggestions({cancelLastRequest:n,contentType:"application/json",data:o,method:"POST",requestParams:t,queryParams:a},r,i,s)}))}getSuggestionDataFromFileCacheUrl(e,t,n,i){var s;return tn(this,void 0,void 0,(function*(){const r=null!=n?n:1,o=null!=i?i:500;let a,l;for(let n=0;n<r;n++)try{const i=yield this.axiosInstance.request({url:`${e}&action=getSuggestionData`,method:"GET",timeout:null!==(s=null==t?void 0:t.RequestTimeoutMS)&&void 0!==s?s:this.defaultRequestTimeoutMS,responseType:"arraybuffer",signal:this.lastAbortController.signal});if(a=yield nn.parseDASResponse(i.data,i.headers,i.status),a.error==Vt.None)return a;n<r-1&&(l&&clearTimeout(l),yield new Promise((e=>{l=setTimeout(e,o)})))}catch(e){n<r-1&&(l&&clearTimeout(l),yield new Promise((e=>{l=setTimeout(e,o)})))}return l&&clearTimeout(l),null!=a?a:{error:Vt.NoResponse}}))}getSuggestionsWithImageContent(e,t,n,i,s){return tn(this,void 0,void 0,(function*(){const r=yield mn.buildMultipartMixedRequest(e),o=new URLSearchParams,a=null==t?void 0:t.DocumentId;return void 0!==a&&o.append("documentId",a),yield this.fetchSuggestions({contentType:r.contentType,cancelLastRequest:n,data:r.body,method:"POST",queryParams:o,requestParams:t},void 0,i,s)}))}getMultiPageSuggestionsWithImageContent(e,t,n,i,s,r=Kt.SCHEMA_V1){return tn(this,void 0,void 0,(function*(){const o=yield mn.buildMultipartMixedRequest(e),a=new URLSearchParams,l=null==t?void 0:t.DocumentId;return void 0!==l&&a.append("documentId",l),yield this.fetchSuggestions({contentType:o.contentType,cancelLastRequest:n,data:o.body,method:"POST",queryParams:a,requestParams:t},r,i,s)}))}static parseSuggestionsResponse(e,t,n){const i=Object.create(null,{parseDASResponse:{get:()=>super.parseDASResponse}});return tn(this,void 0,void 0,(function*(){const s=i.parseDASResponse.call(this,e,t,n);return yield s}))}}!function(e){e.ClientCanceled="Client canceled request",e.None="None",e.NoResults="No Results",e.NoResponse="No Response",e.Timeout="Timeout",e.NotEnoughSuggestions="Not Enough Suggestions",e.RAIError="Request failed with status code 422"}(Vt||(Vt={})),function(e){e[e.Multipart=0]="Multipart",e[e.JSON=1]="JSON",e[e.Default=2]="Default"}(Qt||(Qt={})),function(e){e[e.SCHEMA=0]="SCHEMA",e[e.SCHEMA_V1=1]="SCHEMA_V1",e[e.SCHEMA_V2=2]="SCHEMA_V2"}(Kt||(Kt={})),function(e){e[e.InProgress=0]="InProgress",e[e.Completed=1]="Completed",e[e.Failed=2]="Failed",e[e.PartiallyCompleted=3]="PartiallyCompleted"}(Yt||(Yt={})),function(e){e[e.None=0]="None",e[e.IdeasNetworkError=1]="IdeasNetworkError",e[e.TemplatesNetworkError=2]="TemplatesNetworkError"}(Xt||(Xt={})),function(e){e[e.prod=0]="prod",e[e.edog=1]="edog",e[e.int=2]="int",e[e.local=3]="local",e[e.canary=4]="canary",e[e.euc=5]="euc",e[e.gcc=6]="gcc",e[e.dod=7]="dod",e[e.edognetcore=8]="edognetcore",e[e.dogfood=9]="dogfood"}(Zt||(Zt={})),function(e){e[e.other=0]="other",e[e.mediaSuggestions=1]="mediaSuggestions",e[e.document=2]="document",e[e.rtc=3]="rtc",e[e.traceRequest=4]="traceRequest",e[e.userassets=5]="userassets"}(en||(en={}));const rn="x-designerappservice-third-party";var on,an,ln,cn;!function(e){e.OpenDesignInNewTab="OpenDesignInNewTab",e.ResizeInNewTab="ResizeInNewTab",e.HomePageImageEffectToolAction="HomePageImageEffectToolAction",e.CleanupPostMessageHandler="CleanupPostMessageHandler"}(on||(on={})),function(e){e.PostMessage="PostMessage",e.ReduxPersist="ReduxPersist"}(an||(an={})),function(e){e[e.None=0]="None",e[e.Train=1]="Train",e[e.Resize=2]="Resize",e[e.Edit=3]="Edit",e[e.New=4]="New"}(ln||(ln={})),function(e){e[e.CONTINUE=100]="CONTINUE",e[e.SWITCHING_PROTOCOLS=101]="SWITCHING_PROTOCOLS",e[e.PROCESSING=102]="PROCESSING",e[e.EARLY_HINTS=103]="EARLY_HINTS",e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NON_AUTHORITATIVE_INFORMATION=203]="NON_AUTHORITATIVE_INFORMATION",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.RESET_CONTENT=205]="RESET_CONTENT",e[e.PARTIAL_CONTENT=206]="PARTIAL_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.MULTIPLE_CHOICES=300]="MULTIPLE_CHOICES",e[e.MOVED_PERMANENTLY=301]="MOVED_PERMANENTLY",e[e.MOVED_TEMPORARILY=302]="MOVED_TEMPORARILY",e[e.SEE_OTHER=303]="SEE_OTHER",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.USE_PROXY=305]="USE_PROXY",e[e.TEMPORARY_REDIRECT=307]="TEMPORARY_REDIRECT",e[e.PERMANENT_REDIRECT=308]="PERMANENT_REDIRECT",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.PROXY_AUTHENTICATION_REQUIRED=407]="PROXY_AUTHENTICATION_REQUIRED",e[e.REQUEST_TIMEOUT=408]="REQUEST_TIMEOUT",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_TOO_LONG=413]="REQUEST_TOO_LONG",e[e.REQUEST_URI_TOO_LONG=414]="REQUEST_URI_TOO_LONG",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUESTED_RANGE_NOT_SATISFIABLE=416]="REQUESTED_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.IM_A_TEAPOT=418]="IM_A_TEAPOT",e[e.INSUFFICIENT_SPACE_ON_RESOURCE=419]="INSUFFICIENT_SPACE_ON_RESOURCE",e[e.METHOD_FAILURE=420]="METHOD_FAILURE",e[e.MISDIRECTED_REQUEST=421]="MISDIRECTED_REQUEST",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.LOCKED=423]="LOCKED",e[e.FAILED_DEPENDENCY=424]="FAILED_DEPENDENCY",e[e.UPGRADE_REQUIRED=426]="UPGRADE_REQUIRED",e[e.PRECONDITION_REQUIRED=428]="PRECONDITION_REQUIRED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.REQUEST_HEADER_FIELDS_TOO_LARGE=431]="REQUEST_HEADER_FIELDS_TOO_LARGE",e[e.UNAVAILABLE_FOR_LEGAL_REASONS=451]="UNAVAILABLE_FOR_LEGAL_REASONS",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.HTTP_VERSION_NOT_SUPPORTED=505]="HTTP_VERSION_NOT_SUPPORTED",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.NETWORK_AUTHENTICATION_REQUIRED=511]="NETWORK_AUTHENTICATION_REQUIRED"}(cn||(cn={}));var un=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class dn{static createRequestHeaders(e,t){var n;const i={};i[_t.AudienceGroup]=e.AudienceGroup,i[_t.Caller]=e.Caller,i[_t.ClientId]=e.ClientId,i[_t.SessionId]=e.SessionId,i[_t.UserId]=e.UserId,e.ClientName&&(i[_t.ClientName]=e.ClientName);const s=null!==(n=null==t?void 0:t.CorrelationId)&&void 0!==n?n:(0,zt.A)();return i[_t.CorrelationId]=s,i[_t.Correlation_Id]=s,t&&(t.ContainerId&&(i[_t.ContainerId]=t.ContainerId),t.DocumentId&&(i[_t.DocId]=t.DocumentId),t.FileToken&&(i[_t.FileToken]=t.FileToken),t.AuthToken&&(i[_t.Authorization]=t.AuthToken),t.EnvHint&&(i[_t.EnvironmentHint]=t.EnvHint),t.DcHint&&(i[_t.DataCenterHint]=t.DcHint),t.ClientBuild&&(i[_t.ClientBuild]=t.ClientBuild),t.ClientName&&(i[_t.ClientName]=t.ClientName),t.HostApp&&(i[_t.HostApp]=t.HostApp),t.Platform&&(i[_t.Platform]=t.Platform),t.ReleaseChannel&&(i[_t.ReleaseChannel]=t.ReleaseChannel),t.DesignerappserviceThirdParty&&(i[rn]=t.DesignerappserviceThirdParty)),e.UserType&&(i[_t.UserType]=e.UserType),i["x-req-start"]=String(performance.now()),i}static prefetchThumbnails(e,t){return un(this,void 0,void 0,(function*(){if((null==e?void 0:e.length)>0){const n=new Array;for(const t of e)if(t.relationshipsData){const e=t.relationshipsData;if(null==e?void 0:e.Relationship)for(const t of e.Relationship)t.Thumbnail&&n.push(t.Thumbnail)}n.length>0&&(yield Promise.all(n.map((e=>Ot.get(e,{timeout:t})))))}}))}static getSuggestionRequestErrorFromStatusCode(e,t){var n,i;switch(e){case cn.OK:return Vt.None;case cn.NO_CONTENT:return(null!==(i=null===(n=null==t?void 0:t[_t.FailureReason.toLowerCase()])||void 0===n?void 0:n.toString())&&void 0!==i?i:"").toLowerCase()===Dt.NotEnoughSuggestions.toLowerCase()?Vt.NotEnoughSuggestions:Vt.NoResults;default:return Vt.NoResponse}}static getContentType(e){return-1!=e.indexOf("multipart/mixed")?Qt.Multipart:-1!=e.indexOf("application/json")?Qt.JSON:Qt.Default}static convertHeadersToLowerCase(e){if(!e)return{};const t={};for(const[n,i]of e.entries())t[n.toLowerCase()]=i;return t}static validateAndGetContentBody(e){if(!e)return null;if(e instanceof ArrayBuffer){const t=new Uint8Array(e);return(null==t?void 0:t.length)?t:null}return e instanceof ReadableStream?e.getReader():null}}dn.tryPopulateSuggestionPayloadFromURL=(e,t,n,i,s)=>un(void 0,void 0,void 0,(function*(){var r,o,a;if(t.isMultiPage)return yield Jt.tryPopulatePageDataFromUrlForMultiPageSuggestions(e,t,n,i,s);if(void 0!==(null==t?void 0:t.suggestionUrl)){const l=yield e.getSuggestionDataFromFileCacheUrl(t.suggestionUrl,n,i,s);if(null===(r=null==l?void 0:l.content)||void 0===r?void 0:r.pageData)return t.pageData=null===(o=null==l?void 0:l.content)||void 0===o?void 0:o.pageData,t.relationshipsData=null===(a=null==l?void 0:l.content)||void 0===a?void 0:a.relationshipsData,!0}return!1}));class gn{async processMultipartResponse(e,t,n){if(null==e)throw"multipartContentBuffer is empty";try{const i=new TextDecoder("utf-8").decode(e);this.parseMultipart(i,t).forEach((e=>{const t=this.parseResponsePart(e);n(t)}))}catch(e){const t={Err:new Error(e)};n(t)}}fetchBoundary(e){let t=e.split("boundary=");if(2===t.length)return t[1];throw"No Boundary"}async processMultipartBinaryResponse(e,t,n){if(!e)throw"multipartContentBufferOrStream is empty";let i,s,r="",o=0,a=[],l=null;const c=e instanceof Uint8Array;try{for(;;){if(c)s=e;else{const{done:t,value:n}=await e.read();if(t)break;s=n}for(const e of s){const s=10===e||13===e,c=10===e&&13===l,u=10===l&&13===e;if(a.push(e),s||(r+=String.fromCharCode(e)),0===o&&c)`--${t}`===r&&(o=1,r="",a=[]);else if(1===o&&u)i=new Uint8Array(a),o=2,r="",a=[];else if(2===o&&c)o=3,r="",a=[];else if(3===o){if(r.length>t.length+4&&(r=""),`--${t}`===r){let e=a.length-r.length,t=a.slice(0,e-1);o=1,n({Headers:this.processHeader(i),Body:new Uint8Array(t)}),r="",i=void 0,a=[]}c&&(r="")}l=e}if(c)break}}catch(e){n({Err:new Error(e)})}}parseMultipart(e,t){const n=`--${t}`;return e.split(n).map((e=>e.trim())).filter((e=>""!==e&&"--"!==e))}parseResponsePart(e){const t=this.parseResponseHeaderFromPart(e).split("\n"),n=new Map;t.forEach((e=>{const t=e.split(": ");2===t.length&&n.set(t[0],t[1])}));const i=this.parseResponseBodyFromPart(e),s=(new TextEncoder).encode(i);return{Headers:n,Body:s}}parseResponseBodyFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[1];throw"No response Body"}parseResponseHeaderFromPart(e){const t=e.split("\n\r\n");if(2===t.length)return t[0];throw"No response Headers"}processHeader(e){let t=new Map;if(e){let n="";for(let t=0;t<e.byteLength;t+=1)n+=String.fromCharCode(e[t]);n.split("\n").forEach((e=>{let n=e.split(": ");2===n.length&&t.set(n[0],n[1])}))}return t}}var pn=n(37542).Buffer,hn=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},fn=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};class mn{static buildMultipartMixedRequest(e){var t,n;return hn(this,void 0,void 0,(function*(){const i="...Boundary_Outer";let s="",r=[],o=[];if("ImageFiles"in e&&e.ImageFiles.length>0){const{ImageFiles:t}=e,n=fn(e,["ImageFiles"]);r=t,s=JSON.stringify(n)}else if("ImageBuffers"in e&&e.ImageBuffers.length>0){const{ImageBuffers:t}=e,n=fn(e,["ImageBuffers"]);o=t,s=JSON.stringify(n)}else("ImageUrls"in e&&(null===(t=e.ImageUrls)||void 0===t?void 0:t.length)||(null===(n=e.MediaContent)||void 0===n?void 0:n.length))&&(s=JSON.stringify(e));const a=`--${i}\r\nContent-Type: application/json\r\n\r\n${s}`,l=pn.from(a),c=[];let u=l.length;if(c.push(l),(null==r?void 0:r.length)>0){for(const e of r)if(e.size>0&&e.type.length>0){const t=`\r\n--${i}\r\nContent-Type: ${e.type}\r\n\r\n`,n=pn.from(t),s=yield e.arrayBuffer(),r=new Uint8Array(s);c.push(n),c.push(r),u+=n.length,u+=r.length}}else if(o.length>0)for(const e of o)if(e.buffer.byteLength>0&&e.type.length>0){const t=`\r\n--${i}\r\nContent-Type: ${e.type}\r\n\r\n`,n=pn.from(t);c.push(n),c.push(e.buffer),u+=n.length,u+=e.buffer.length}const d=pn.from(`\r\n--${i}--`);c.push(d),u+=d.length;const g=new Uint8Array(u);let p=0;return c.forEach((e=>{g.set(e,p),p+=e.length})),{contentType:`multipart/mixed; boundary=${i}`,body:g}}))}static parseMultipartSuggestions(e,t,n){return hn(this,void 0,void 0,(function*(){const i={suggestions:[]},s=n?e=>{this.parseSuggestionPartContent(e,i,n)}:void 0,r=yield this.getSuggestionsPartContent(e,t,s);if(!n)for(const e of r)this.parseSuggestionPartContent(e,i);return i}))}static parseSuggestionPartContent(e,t,n){return hn(this,void 0,void 0,(function*(){const{Headers:i,Body:s}=e,r=null==i?void 0:i.get(_t.ContentType);if(s&&r)if(!0===r.startsWith("application/json"))this.parseJSONPart(s,t,n);else this.parseDesignContent(e,t,n)}))}static getSuggestionsPartContent(e,t,n){return hn(this,void 0,void 0,(function*(){const i=new gn,s=i.fetchBoundary(e),r=[];let o="";return yield i.processMultipartBinaryResponse(t,s,(e=>{e.Err?o=`Designer Response: Error parsing response body ${e.Err}`:(null==n||n(e),r.push(e))})),o?Promise.reject(o):r}))}static parseDesignJSONPart(e,t){const n=(new TextDecoder).decode(e),i=JSON.parse(n);if(i&&"object"==typeof i&&"RelationshipsData"in i){const{RelationshipsData:e}=i,n=fn(i,["RelationshipsData"]);t.designData=n,t.designRels=e}else t.designData=i}static parseJSONPart(e,t,n){var i,s,r,o,a;return hn(this,void 0,void 0,(function*(){const l=(new TextDecoder).decode(e),c=JSON.parse(l);if(c.pageIds)return this.parseDesignJSONPart(e,t),void(null==n||n(t));if(c.KeyPhrases&&c.KeyPhrases.length>0)return t.keyphrase=null!==(i=c.KeyPhrases[0].KeyPhraseText)&&void 0!==i?i:"",void(null==n||n(t));if(c.PageLevelDetails&&c.PageLevelDetails.length>0&&(t.suggestionSummary=c.PageLevelDetails.map((e=>({PageId:e.PageId,PageType:e.PageType,PageGenerationPrompt:e.PageGenerationPrompt,Orientation:e.Orientation,UserPrompt:e.UserPrompt,ColorPalette:e.ColorPalette,LanguageSpecified:e.LanguageSpecified,dasDallePollingResponse:e.dasDallePollingResponse}))),null==n||n(t)),c.Metadata){const e=c.Metadata;(null===(s=e.PromptEngineering)||void 0===s?void 0:s.PromptGuidance)&&(t.promptGuidance=e.PromptEngineering.PromptGuidance),(null===(r=e.PromptEngineering)||void 0===r?void 0:r.ParsedHeading)&&(t.parsedHeading=e.PromptEngineering.ParsedHeading),(null===(o=e.Prompt)||void 0===o?void 0:o.DetectedPromptIntent)&&(t.promptIntent=e.Prompt.DetectedPromptIntent)}if(c.PageData&&(t.pageData=c.PageData),c.RelationshipsData&&(t.relationshipsData=c.RelationshipsData),c.polling_response&&(t.polling_response=c.polling_response,t.image_urls=c.image_urls||[]),c.DesignData&&(t.designData=c.DesignData),null==n||n(t),c.DesignId){const e={data:new Uint8Array,metadata:""};this.populateDesignContentFromJson(e,c),null==n||n(e),null===(a=t.suggestions)||void 0===a||a.push(e)}}))}static parseDesignContent(e,t,n){var i;return hn(this,void 0,void 0,(function*(){const{Headers:s,Body:r}=e,o=null==s?void 0:s.get(_t.ContentType);if(!o||!r)return;const a={data:new Uint8Array,metadata:""},l=new gn,c=l.fetchBoundary(o).trim();let u="";if(yield l.processMultipartBinaryResponse(r,c,(e=>{e.Err?u=`error parsing inner response body ${e.Err}`:this.populateDesignContent(e,a)})),u)throw new Error(u);null==n||n(a),null===(i=t.suggestions)||void 0===i||i.push(a)}))}static populateDesignContent(e,t){var n;return hn(this,void 0,void 0,(function*(){const{Headers:i,Body:s}=e,r=null===(n=null==i?void 0:i.get(_t.ContentType))||void 0===n?void 0:n.trim();if(r&&s)if(r.startsWith("application/json")){const e=JSON.parse((new TextDecoder).decode(s));this.populateDesignContentFromJson(t,e)}else if(this.supportedMimeTypesForBinaryData.has(r)){if(s.length<=1)return;t.data=s}}))}}mn.supportedMimeTypesForBinaryData=new Set(["image/jpeg","image/png","image/bmp"]),mn.populateDesignContentFromJson=(e,t)=>{var n,i,s,r,o,a,l,c;t&&(e.metadata=null!==(n=t.Metadata)&&void 0!==n?n:"",e.pageData=null!==(i=t.PageData)&&void 0!==i?i:{},e.relationshipsData=null!==(s=t.RelationshipsData)&&void 0!==s?s:{},e.dimension=t.Dimension,e.slideSize=t.SlideSize,e.highResThumbnailUrl=null!==(r=t.HighResThumbnailUrl)&&void 0!==r?r:"",e.suggestionUrl=t.SuggestionUrl,e.urlIdentifier=t.UrlIdentifier,e.isMotionSuggestion=null!==(o=t.IsMotionSuggestion)&&void 0!==o&&o,t.additionalMetadata&&(e.proactiveSuggestionMetadata=t.additionalMetadata),e.debugInfo=t.DebugInfo,e.isMultiPage=t.IsMultiPage,e.apsEventId=t.ApsEventId,e.designLocale=t.DesignLocale,e.designExperiments=t.DesignExperiments,e.designId=t.DesignId,e.thumbnailUrl=t.SuggestionThumbnailUrl?t.SuggestionThumbnailUrl:t.ThumbnailUrl,e.thirdPartyData=t.ThirdPartyData,e.recipeType=null===(a=t.DesignExtendedInfo)||void 0===a?void 0:a.Recipetype,e.designDescription=null!==(l=t.DesignDescription)&&void 0!==l?l:"",e.designExtendedInfo=null!==(c=t.DesignExtendedInfo)&&void 0!==c?c:{})};class En extends mn{static parseDesignJSONPart(e,t){var n;const i=(new TextDecoder).decode(e),s=JSON.parse(i);t.designData=null!==(n=t.designData)&&void 0!==n?n:[],t.designData.push(s)}}var yn,vn,Tn=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(n[i[s]]=e[i[s]])}return n};class Sn extends mn{static parseDesignJSONPart(e,t){var n;const i=(new TextDecoder).decode(e),s=JSON.parse(i);t.designInfo=null!==(n=t.designInfo)&&void 0!==n?n:[];const{RelationshipsData:r}=s,o={designData:Tn(s,["RelationshipsData"]),designRels:r};t.designInfo.push(o)}}!function(e){e.ClientCanceled="Client canceled request",e.EmptyBody="Empty Body",e.None="None",e.NoResults="No Results",e.NoResponse="No Response"}(yn||(yn={})),function(e){e.ClientCanceled="Client canceled request",e.ContentTypeMissing="Content type header missing",e.EmptyBody="Empty Body",e.None="None",e.NoResults="No Results",e.NoResponse="No Response"}(vn||(vn={}));var Rn=n(27420),bn=n(76916),Cn=n(26529);class wn{constructor(e,t,n){this.targetOrigin=e,this.hostWindow=t,this.iframeid=n,this.boundOnMessage=this.onMessage.bind(this),this.callbacks=new Map,this.hostWindow.addEventListener("message",this.boundOnMessage)}removeMessageHandler(){this.off(),this.hostWindow.removeEventListener("message",this.boundOnMessage)}on(e,t){if(this.callbacks.has(e))throw new Error(`"${e}" already registered`);this.callbacks.set(e,t)}off(e){if(e){if(!this.callbacks.has(e))throw new Error(`"${e}" not registered`);this.callbacks.delete(e)}else this.callbacks.clear()}setTarget(e){this.target=e}send(e,t){if(!this.target)throw new Error("Must call initialize first");this.target.postMessage({type:e,data:t},this.targetOrigin)}destroy(){this.removeMessageHandler(),this.target=void 0,this.hostWindow=void 0}onMessage(e){var t;const{origin:n,data:i}=e,s=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.iframeid;if(new URL(n).origin!==new URL(this.targetOrigin).origin||s&&s!=this.iframeid)return;const{type:r,data:o}=i,a=this.callbacks.get(r);a&&a(o)}}const On=["https://designerappservice.officeapps.live.com/designerappservice.all"],In=["https://designerappserviceppe.officeapps.live.com/designerappservice.all"];class An extends Error{constructor(e,t){super(e),this.canRetry=t}}var _n=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class Dn{constructor(e,t){this.m_appMessageHandler=e,this.m_settings=t}initialize(){this.m_appMessageHandler.on("auth_fetch",this.onAuthMessage.bind(this))}destroy(){this.m_appMessageHandler=void 0,this.m_settings=void 0}onAuthMessage(){return _n(this,void 0,void 0,(function*(){try{const e=yield this.getAuthToken();this.m_appMessageHandler.send("auth_token",e)}catch(e){this.m_appMessageHandler.send("auth_error",e)}}))}getAuthToken(){return _n(this,void 0,void 0,(function*(){if(this.m_settings.hostTokenProvider){const e=!1?In:On;return yield this.m_settings.hostTokenProvider.getToken(e)}throw new An("No host auth callback provided")}))}}var Pn=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class Un{constructor(e,t){this.m_appMessageHandler=e,this.m_hostSessionStorage=t}initialize(){this.m_appMessageHandler.on("dcHint",this.onDcHintMessage.bind(this))}destroy(){this.m_appMessageHandler=void 0,this.m_hostSessionStorage=void 0}onDcHintMessage(e){return Pn(this,void 0,void 0,(function*(){(null==e?void 0:e.dcHint)&&"string"==typeof(null==e?void 0:e.dcHint)&&this.m_hostSessionStorage.setDcHint(null==e?void 0:e.dcHint)}))}}class Nn{constructor(e){var t,n,i;this.fileCacheInfoChangeHandler=null===(t=e.fileCacheInfoConfig)||void 0===t?void 0:t.hostCallback;const s=null===(n=e.fileCacheInfoConfig)||void 0===n?void 0:n.fileCacheInfo;if(s)this.containerId=s.containerId,this.fileToken=s.fileToken,this.dcHint=s.dcHint,Rn.Hv.sendTraceTag(505516771,bn.n.msoulscat_Wac_Telemetry,Cn.k.Info,`HostSessionStorage initialized with dcHint: ${this.dcHint}`);else{const t=null===(i=e.hostTokenProvider)||void 0===i?void 0:i.identityType,n=e.telemetryConfig.clientName.toLowerCase().trim().replaceAll(" ","-");this.containerId=""+("AAD"===t?`aad-${n}-${(0,zt.A)()}`:`${n}-${(0,zt.A)()}`),this.fileToken=(0,zt.A)(),this.fileCacheInfoChangeHandler&&this.fileCacheInfoChangeHandler(this.getFileCacheInfo())}}getContainerId(){return this.containerId}getFileToken(){return this.fileToken}getDcHint(){return this.dcHint}setDcHint(e){Rn.Hv.sendTraceTag(505516770,bn.n.msoulscat_Wac_Telemetry,Cn.k.Info,`HostSessionStorage::setDcHint called with input dcHint: ${e}`),e!==this.dcHint&&(this.dcHint=e,this.fileCacheInfoChangeHandler&&this.fileCacheInfoChangeHandler(this.getFileCacheInfo()))}getFileCacheInfo(){return{containerId:this.containerId,fileToken:this.fileToken,dcHint:this.dcHint}}}const{parseSuggestionsResponse:Mn}=sn;var Ln,xn,Bn,Fn,kn;!function(e){e.DownloadDesign="downloadDesign",e.GenerateImage="generateImage",e.UpdateDesignDescription="updateDesignDescription",e.UploadImage="uploadImage",e.LoadThumbnails="loadThumbnails",e.CompleteBoot="completeBoot",e.OpenMini="openMini",e.CloseMini="closeMini"}(Ln||(Ln={})),function(e){e[e.Like=0]="Like",e[e.Dislike=1]="Dislike"}(xn||(xn={})),function(e){e.Pane="pane",e.Chat="chat"}(Bn||(Bn={})),function(e){e.Auto="auto",e.Dark="dark",e.Light="light",e.HighContrast="highContrast"}(Fn||(Fn={})),function(e){e[e.Done=0]="Done",e[e.Insert=1]="Insert"}(kn||(kn={}));var Hn=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};const jn=new Map([["image/jpeg","jpg"],["image/png","png"],["image/x-png","png"],["image/webp","webp"],["image/heic","heic"]]);var qn=function(e,t,n,i){return new(n||(n=Promise))((function(s,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class Gn{constructor(e){var t,n;this.m_settings=e,this.axiosInstance=Ot.create(),this.iframeid=(0,zt.A)(),this.m_hostWindow=null!==(n=null===(t=e.container.ownerDocument)||void 0===t?void 0:t.defaultView)&&void 0!==n?n:window,this.m_appMessageHandler=new wn(this.m_settings.miniURL.origin,this.m_hostWindow,this.iframeid),this.m_authMessageHandler=new Dn(this.m_appMessageHandler,this.m_settings),this.m_iframe=this.createAppFrame(),this.m_hostSessionStorage=new Nn(this.m_settings),this.m_dcHintMessageHandler=new Un(this.m_appMessageHandler,this.m_hostSessionStorage);this.axiosInstance.interceptors.response.use((e=>{const t=e.headers[_t.DataCenterHint.toLowerCase()];return t&&this.m_hostSessionStorage.setDcHint(t),e}))}getSuggestions(e,t,n,i,s,r){var o,a,l;return qn(this,void 0,void 0,(function*(){if(!this.m_suggestionClient){const e=null===(o=this.m_settings.hostTokenProvider)||void 0===o?void 0:o.identityType,t=null===(a=this.m_settings.hostTokenProvider)||void 0===a?void 0:a.accountInfo.userId,n=this.m_settings.telemetryConfig.clientId,i=t?"AAD"===e?t:function(e,t){if(36===(null==e?void 0:e.length))return e.substr(19,4)+e.substr(24);return 16===(null==e?void 0:e.length)&&!0===t?e:(Rn.Hv.sendTraceTag(507873103,bn.n.msoulscat_Wac_Telemetry,Cn.k.Error,"Unexpected localAccountId length"),"")}(t):n;this.m_suggestionClient=new sn({AudienceGroup:this.m_settings.telemetryConfig.audienceGroup,Caller:"DesignerEcosystem",ClientId:this.m_settings.telemetryConfig.clientId,ClientName:this.m_settings.telemetryConfig.clientName,ServiceRing:this.getDesignerEnvironment(this.m_settings.serviceBaseURL),SessionId:this.m_settings.telemetryConfig.sessionId,UserId:i},this.axiosInstance)}const c=this.m_hostSessionStorage.getFileCacheInfo(),u={ContainerId:c.containerId,FileToken:c.fileToken,DcHint:c.dcHint},d={Title:{Text:""},SubTitle:{Text:""},Expectations:{Dimension:t,TypeMetadata:[null!==(l=this.m_settings.preferredImageOutputFormat)&&void 0!==l?l:"jpg","oxsd"],MinCount:n,MaxCount:i||(g=this.m_settings.viewConfig.view,g===Bn.Chat?4:14)},Hints:{DesignQuery:e,Trigger:"DesignFromScratch",DisableMotionSuggestions:"true",image2HeadingsForDFS:"true"},Scenario:r};var g;if(null==s?void 0:s.length){if("string"==typeof s[0]){const e=yield Promise.all(s.map((e=>{return t=e,Hn(void 0,void 0,void 0,(function*(){try{const e=yield fetch(t),i=yield e.blob(),s=jn.get(i.type)||"jpg";let r=n;if(!r){const e=new URL(t).pathname.split("/").pop();r=(null==e?void 0:e.slice(0,e.lastIndexOf(".")))||(0,zt.A)()}return new File([i],r+"."+s,{type:i.type})}catch(e){throw new Error(`Failed to fetch image: ${e.message}`)}}));var t,n})));return yield this.m_suggestionClient.getSuggestionsWithImageContent(Object.assign(Object.assign({},d),{ImageFiles:e}),u)}return yield this.m_suggestionClient.getSuggestionsWithImageContent(Object.assign(Object.assign({},d),{ImageBuffers:s}),u)}return yield this.m_suggestionClient.getSuggestions(d,u)}))}initialize(e){return qn(this,void 0,void 0,(function*(){const t=Date.now();this.m_authMessageHandler.initialize(),this.m_dcHintMessageHandler.initialize();const n=new Promise(((n,i)=>{this.m_appMessageHandler.on("ready",(()=>{try{this.m_appMessageHandler.send("initialize",{designerEnvironment:this.getDesignerEnvironment(this.m_settings.serviceBaseURL),telemetryConfig:this.m_settings.telemetryConfig,packageVersion:"0.23.9",appStartTimestamp:t,config:{insertMode:this.m_settings.insertMode,useDoneCta:this.m_settings.ctaButtonLabel===kn.Done,hideSizeSelector:this.m_settings.hideSizeSelector,preferredImageOutputFormat:this.m_settings.preferredImageOutputFormat,disableOptionalConnectedExperiences:this.m_settings.disableOptionalConnectedExperiences,hostCanProvideAuthToken:!!this.m_settings.hostTokenProvider,hostAuthConfig:this.m_settings.hostTokenProvider?{hostAccountInfo:this.m_settings.hostTokenProvider.accountInfo,hostIdentityType:this.m_settings.hostTokenProvider.identityType,hostCanProvideAuthToken:!0,isEUDBUser:this.m_settings.hostTokenProvider.isEUDBUser}:void 0,useEnterpriseTOULink:this.m_settings.useEnterpriseTOULink,isSovereignUser:this.m_settings.isSovereignUser,hideGenImageEntryPoint:this.m_settings.hideGenImageEntryPoint},suggestionsConfig:e,viewConfig:this.m_settings.viewConfig,fileCacheInfo:this.m_hostSessionStorage.getFileCacheInfo()}),this.m_appMessageHandler.off("ready"),n()}catch(e){i(e)}})),this.m_iframe.onerror=e=>{i(new Error(`Error loading iframe: ${e}`))}}));this.m_settings.container.appendChild(this.m_iframe),this.m_iframe.contentWindow&&this.m_appMessageHandler.setTarget(this.m_iframe.contentWindow),yield n}))}update(e){this.m_appMessageHandler.send("update",e)}updateAfterSignIn(){this.m_appMessageHandler.send("update_after_sign_in")}destroy(){this.m_appMessageHandler.destroy(),this.m_authMessageHandler.destroy(),this.m_dcHintMessageHandler.destroy(),this.m_iframe.remove(),this.m_hostWindow=void 0,this.m_settings=void 0}on(e,t){this.m_appMessageHandler.on(e,t)}off(e){this.m_appMessageHandler.off(e)}toggleInsertMode(e){this.m_appMessageHandler.send("insert_mode",e)}switchDesignerMiniAppTheme(e){this.m_appMessageHandler.send("switch_theme",e)}enableRedirectAuth(e){this.m_appMessageHandler.send("enable_redirect_auth",e)}createAppFrame(){var e,t,n;const i=new URL(this.m_settings.miniURL.toString());i.searchParams.append("view",null===(e=this.m_settings.viewConfig)||void 0===e?void 0:e.view),i.searchParams.append("theme",null!==(n=null===(t=this.m_settings.viewConfig)||void 0===t?void 0:t.theme)&&void 0!==n?n:"auto"),i.searchParams.append("sessionId",this.m_settings.telemetryConfig.sessionId),i.searchParams.append("clientId",this.m_settings.telemetryConfig.clientId),i.searchParams.append("clientName",this.m_settings.telemetryConfig.clientName),i.searchParams.append("iframeid",this.iframeid),this.m_settings.lng&&i.searchParams.append("lng",this.m_settings.lng),this.m_settings.loginHint&&i.searchParams.append("loginHint",this.m_settings.loginHint);const s=this.m_hostWindow.document.createElement("iframe");return s.allow="clipboard-write",s.width="100%",s.height="100%",s.style.border="none",s.name="Microsoft Designer",s.src=i.toString(),this.m_settings.enableSandboxing&&s.sandbox.add("allow-scripts","allow-same-origin","allow-downloads","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation"),this.m_settings.disableEmbeddedCSPEnforcement||s.setAttribute("csp","object-src 'none'; base-uri 'none'; require-trusted-types-for 'script'; trusted-types default; "),s}getDesignerEnvironment(e){return Gt.getDasRing(e)}}const{parseSuggestionsResponse:zn}=sn;var Wn=n(8520);const $n=(0,n(14168).Ex)("officeaicopilot-designer.DesignerStrings.DesignerPreviewLabel");var Jn=n(73362);var Vn=n(80428),Qn=n(58651);const Kn=(0,n(98549).l8)({lightThemeWithChatCard:{backgroundColor:"#FFFFFF"},darkThemeWithChatCard:{backgroundColor:"#292929"}});var Yn=n(58651);const Xn={designerPreviewAriaLabel:$n},Zn=e=>{const t=Wn.useMemo((()=>(0,zt.A)()),[]),n=Wn.useRef(),i=Wn.useRef(!1),r=(0,s.kQ)(Xn);Yn.log("Designer Log: historyEventData sent to Designer",e.historyEventData);const{initializeDesignerMini:o,designerMiniSettings:a}=(e=>{const{clientSettings:t,hostTokenProvider:n,isAuthEnabled:i,isRehydration:s,turnId:r,hostCallback:o,fileCacheInfo:a,isPlugAndPlay:l,historyEventData:c}=e,u=(0,Vn.eR)(e.clientSettings?.selectedDesignerEnv,i),d=(0,Vn.iK)(t?.selectedDesignerEnv,n?.isEUDBUser),g=t?.clientId||(0,zt.A)(),p=t?.sessionId||(0,zt.A)(),h=t?.correlationId||(0,zt.A)(),f=t?.hostAppName,m=t?.scenarioName||"Other",E=t?.platformType,y=t?.hostBuildVersion,v=`${f}-${E}`,T=t?.audienceGroup;Qn.log("Designer Log: is Plug and Play enabled: ",l);const{parentContainerIdentifier:S}=e,R=Wn.useMemo((()=>{return{miniURL:u,serviceBaseURL:d,viewConfig:{view:Bn.Chat,theme:t?.designerTheme??Fn.Light,showFeedbackSection:t?.showFeedBackSection??!1,tempPlugNPlay:l},fileCacheInfoConfig:{hostCallback:o??(e=>{Qn.log(`FileCacheInfo updated: ${JSON.stringify(e)}`)}),fileCacheInfo:a},telemetryConfig:{audienceGroup:T??Jn.EW.Other,clientId:g,clientName:f??"unknown",hostBuildVersion:y??"unknown",hostEnvironment:v,isMicrosoftInternal:!0,optionalDiagnosticsAllowed:!0,sessionId:p,correlationId:h,platform:(i=t?.platformType??Jn.lt.Web,i===Jn.lt.iOS?{platform:"iOS"}:i===Jn.lt.Web?{platform:"Web"}:i===Jn.lt.MacOS?{platform:"MacOS"}:{platform:"Web"}).platform,tenantId:n?.accountInfo.tenantId??""},container:document.getElementById(S),insertMode:t?.insertMode??!0,enableSandboxing:!0,ctaButtonLabel:e.preferredCtaButtonLabel??kn.Insert,hideSizeSelector:!0,preferredImageOutputFormat:e.preferredImageFormat??"png",hostTokenProvider:n,lng:t?.uiLanguage??"en-US"};var i}),[u,d,t?.designerTheme,t?.platformType,t?.uiLanguage,t?.insertMode,o,a,g,f,y,v,p,h,S,e.preferredCtaButtonLabel,e.preferredImageFormat,n]),b=Wn.useCallback((async(e,t,n,i,o,a,l,u,d,g)=>{const p=new Gn({...R,container:document.getElementById(e)});return await p.initialize({turnId:r,isRehydration:s,scenario:m,minCount:3,maxCount:4,...t??{},historyEventData:c}),n&&p.on("done",n),i&&p.on("customize",i),a&&p.on("feedback",a),o&&p.on("AnswerCardResize",o),l&&p.on("persist_results",l),u&&p.on("error",u),d&&p.on("telemetry",d),g&&p.on("keyboardEvent",g),p}),[R,c,s,m,r]);return{designerMiniSettings:R,initializeDesignerMini:b}})({clientSettings:e.clientSettings,hostTokenProvider:e.hostTokenProvider,isAuthEnabled:e.isAuthEnabled,turnId:e.turnId,isRehydration:e.isRehydration,parentContainerIdentifier:t,hostCallback:e.hostCallback,fileCacheInfo:e.fileCacheInfo,isPlugAndPlay:e.isPlugAndPlay,historyEventData:e.historyEventData});Yn.log("Designer Log: Designer Mini initialized with settings: ",a);const l=Wn.useCallback((async t=>{if(t.options?.isUrl&&t.uri)e.insertImagesInCanvas?.(t.uri,{...t.options,altText:t.altText,sourceUrl:t.uri},t.correlationId,t.imageType);else{const n=await function(e,t){const n=Array.from(e),i=new Blob([new Uint8Array(n)],{type:t||"image/png"}),s=new FileReader;return s.readAsDataURL(i),new Promise(((e,t)=>{s.onload=function(){const t=s.result;e(t)},s.onerror=function(){t(s.error)}}))}(t.media,t.mimeType);e.insertImagesInCanvas?.(n,{...t.options,altText:t.altText,sourceUrl:t.options?.isUrl?t.uri:void 0},t.correlationId,t.imageType)}}),[e]),c=Wn.useCallback((e=>{const n=document.getElementById(t);n&&(n.style.height=`${e.height}px`)}),[t]),u=Wn.useCallback((t=>{e?.onDesignerCustomize?.(t,a)}),[a,e]),d=Wn.useCallback((t=>{((e,t,n,i)=>{e===xn.Like?i?t?.(i):t?.():e===xn.Dislike&&(i?n?.(i):n?.())})(t.type,e.handleThumbsUpClick,e.handleThumbsDownClick,e.feedbackData)}),[e]),g=Wn.useCallback((t=>{Yn.log("Designer Log: data received after image generation",t),e?.persistentChatHistoryCallback?.(t)}),[e]),p=Wn.useCallback((t=>{e?.handleDesignerError?.(t)}),[e]),h=Wn.useCallback((t=>{e?.handleDesignerTelemetry?.(t)}),[e]),f=Wn.useCallback((e=>{if("Escape"===e.key){const e=document.getElementById(t)?.closest("."+Jn.lc.CopilotMessage),n=document.getElementsByClassName(Jn.lc.UserMessage)[0];n?.focus({preventScroll:!0}),e?.focus()}}),[e]),m=Wn.useMemo((()=>{const t={imageType:e.imageType};return e.isStockQuery?{...t,stockContent:e.stockImages,artifactType:Jn.FR.DesignSuggestions,companyName:e.companyName}:"banner"===e.imageType?.toLowerCase()?{...t,dimensions:e.dimensions,text:e.userInput.trim(),artifactType:Jn.FR.DesignSuggestions}:{...t,text:e.userInput.trim(),artifactType:Jn.FR.DallEImages,enableImageGen4o:e.enableImageGen4o??!1}}),[e.companyName,e.dimensions,e.imageType,e.isStockQuery,e.stockImages,e.userInput,e.enableImageGen4o]);return Wn.useEffect((()=>{i.current?Yn.log(`Designer Log: Designer Mini already initialized, skipping initializeDesignerMini. doneInitializing: ${null!==n.current}`):(i.current=!0,Yn.log("Designer Log: Calling initializeDesignerMini"),o(t,m,l,u,c,d,g,p,h,f).then((e=>{n.current=e})).catch((e=>{i.current=!1,Yn.error(e)})))}),[m,o,c,u,l,d,t,g,p,h,f]),Wn.useEffect((()=>{e.clientSettings?.designerTheme&&n.current&&n.current.switchDesignerMiniAppTheme(e.clientSettings.designerTheme)}),[e.clientSettings?.designerTheme]),Wn.createElement(Wn.Fragment,null,Wn.createElement("div",{id:t,key:t,className:`${e.clientSettings?.designerTheme===Fn.Dark?Kn.darkThemeWithChatCard:Kn.lightThemeWithChatCard}`,tabIndex:-1,"aria-label":r.designerPreviewAriaLabel()}))}}}]);
//# sourceMappingURL=vendors~lazyloadeddesigner.js.map