/*! For license information please see vendors~copilotchatdisplay.js.LICENSE.txt */
(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[7358],{3415:e=>{"use strict";e.exports=function(e,t,n){var r,s,i,a,o=-1,l=e.posMax,c=e.pos;for(e.pos=t+1,r=1;e.pos<l;){if(93===(i=e.src.charCodeAt(e.pos))&&0===--r){s=!0;break}if(a=e.pos,e.md.inline.skipToken(e),91===i)if(a===e.pos-1)r++;else if(n)return e.pos=c,-1}return s&&(o=e.pos),e.pos=c,o}},3796:(e,t,n)=>{"use strict";var r=n(87423).normalizeReference,s=n(87423).isSpace;e.exports=function(e,t){var n,i,a,o,l,c,u,d,h="",p="",g=e.pos,m=e.posMax,f=e.pos,y=!0;if(91!==e.src.charCodeAt(e.pos))return!1;if(l=e.pos+1,(o=e.md.helpers.parseLinkLabel(e,e.pos,!0))<0)return!1;if((c=o+1)<m&&40===e.src.charCodeAt(c)){for(y=!1,c++;c<m&&(i=e.src.charCodeAt(c),s(i)||10===i);c++);if(c>=m)return!1;if(f=c,(u=e.md.helpers.parseLinkDestination(e.src,c,e.posMax)).ok){for(h=e.md.normalizeLink(u.str),e.md.validateLink(h)?c=u.pos:h="",f=c;c<m&&(i=e.src.charCodeAt(c),s(i)||10===i);c++);if(u=e.md.helpers.parseLinkTitle(e.src,c,e.posMax),c<m&&f!==c&&u.ok)for(p=u.str,c=u.pos;c<m&&(i=e.src.charCodeAt(c),s(i)||10===i);c++);}(c>=m||41!==e.src.charCodeAt(c))&&(y=!0),c++}if(y){if(void 0===e.env.references)return!1;if(c<m&&91===e.src.charCodeAt(c)?(f=c+1,(c=e.md.helpers.parseLinkLabel(e,c))>=0?a=e.src.slice(f,c++):c=o+1):c=o+1,a||(a=e.src.slice(l,o)),!(d=e.env.references[r(a)]))return e.pos=g,!1;h=d.href,p=d.title}return t||(e.pos=l,e.posMax=o,e.push("link_open","a",1).attrs=n=[["href",h]],p&&n.push(["title",p]),e.md.inline.tokenize(e),e.push("link_close","a",-1)),e.pos=c,e.posMax=m,!0}},5253:(e,t,n)=>{"use strict";var r=n(85542),s=[["normalize",n(86143)],["block",n(54353)],["inline",n(76263)],["linkify",n(50358)],["replacements",n(44975)],["smartquotes",n(24176)]];function i(){this.ruler=new r;for(var e=0;e<s.length;e++)this.ruler.push(s[e][0],s[e][1])}i.prototype.process=function(e){var t,n,r;for(t=0,n=(r=this.ruler.getRules("")).length;t<n;t++)r[t](e)},i.prototype.State=n(73627),e.exports=i},5732:(e,t,n)=>{"use strict";function r(e){return Array.prototype.slice.call(arguments,1).forEach((function(t){t&&Object.keys(t).forEach((function(n){e[n]=t[n]}))})),e}function s(e){return Object.prototype.toString.call(e)}function i(e){return"[object Function]"===s(e)}function a(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var o={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};var l={"http:":{validate:function(e,t,n){var r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){var r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&":"===e[t-3]||t>=3&&"/"===e[t-3]?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){var r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},c="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф".split("|");function u(e){var t=e.re=n(96663)(e.__opts__),r=e.__tlds__.slice();function o(e){return e.replace("%TLDS%",t.src_tlds)}e.onCompile(),e.__tlds_replaced__||r.push("a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]"),r.push(t.src_xn),t.src_tlds=r.join("|"),t.email_fuzzy=RegExp(o(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(o(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(o(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(o(t.tpl_host_fuzzy_test),"i");var l=[];function c(e,t){throw new Error('(LinkifyIt) Invalid schema "'+e+'": '+t)}e.__compiled__={},Object.keys(e.__schemas__).forEach((function(t){var n=e.__schemas__[t];if(null!==n){var r={validate:null,link:null};if(e.__compiled__[t]=r,"[object Object]"===s(n))return!function(e){return"[object RegExp]"===s(e)}(n.validate)?i(n.validate)?r.validate=n.validate:c(t,n):r.validate=function(e){return function(t,n){var r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}(n.validate),void(i(n.normalize)?r.normalize=n.normalize:n.normalize?c(t,n):r.normalize=function(e,t){t.normalize(e)});!function(e){return"[object String]"===s(e)}(n)?c(t,n):l.push(t)}})),l.forEach((function(t){e.__compiled__[e.__schemas__[t]]&&(e.__compiled__[t].validate=e.__compiled__[e.__schemas__[t]].validate,e.__compiled__[t].normalize=e.__compiled__[e.__schemas__[t]].normalize)})),e.__compiled__[""]={validate:null,normalize:function(e,t){t.normalize(e)}};var u=Object.keys(e.__compiled__).filter((function(t){return t.length>0&&e.__compiled__[t]})).map(a).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><｜]|"+t.src_ZPCc+"))("+u+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><｜]|"+t.src_ZPCc+"))("+u+")","ig"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),function(e){e.__index__=-1,e.__text_cache__=""}(e)}function d(e,t){var n=e.__index__,r=e.__last_index__,s=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=s,this.text=s,this.url=s}function h(e,t){var n=new d(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function p(e,t){if(!(this instanceof p))return new p(e,t);var n;t||(n=e,Object.keys(n||{}).reduce((function(e,t){return e||o.hasOwnProperty(t)}),!1)&&(t=e,e={})),this.__opts__=r({},o,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=r({},l,e),this.__compiled__={},this.__tlds__=c,this.__tlds_replaced__=!1,this.re={},u(this)}p.prototype.add=function(e,t){return this.__schemas__[e]=t,u(this),this},p.prototype.set=function(e){return this.__opts__=r(this.__opts__,e),this},p.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;var t,n,r,s,i,a,o,l;if(this.re.schema_test.test(e))for((o=this.re.schema_search).lastIndex=0;null!==(t=o.exec(e));)if(s=this.testSchemaAt(e,t[2],o.lastIndex)){this.__schema__=t[2],this.__index__=t.index+t[1].length,this.__last_index__=t.index+t[0].length+s;break}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test))>=0&&(this.__index__<0||l<this.__index__)&&null!==(n=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))&&(i=n.index+n[1].length,(this.__index__<0||i<this.__index__)&&(this.__schema__="",this.__index__=i,this.__last_index__=n.index+n[0].length)),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&e.indexOf("@")>=0&&null!==(r=e.match(this.re.email_fuzzy))&&(i=r.index+r[1].length,a=r.index+r[0].length,(this.__index__<0||i<this.__index__||i===this.__index__&&a>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=i,this.__last_index__=a)),this.__index__>=0},p.prototype.pretest=function(e){return this.re.pretest.test(e)},p.prototype.testSchemaAt=function(e,t,n){return this.__compiled__[t.toLowerCase()]?this.__compiled__[t.toLowerCase()].validate(e,n,this):0},p.prototype.match=function(e){var t=0,n=[];this.__index__>=0&&this.__text_cache__===e&&(n.push(h(this,t)),t=this.__last_index__);for(var r=t?e.slice(t):e;this.test(r);)n.push(h(this,t)),r=r.slice(this.__last_index__),t+=this.__last_index__;return n.length?n:null},p.prototype.tlds=function(e,t){return e=Array.isArray(e)?e:[e],t?(this.__tlds__=this.__tlds__.concat(e).sort().filter((function(e,t,n){return e!==n[t-1]})).reverse(),u(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,u(this),this)},p.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),"mailto:"!==e.schema||/^mailto:/i.test(e.url)||(e.url="mailto:"+e.url)},p.prototype.onCompile=function(){},e.exports=p},6148:(e,t,n)=>{"use strict";t.parseLinkLabel=n(3415),t.parseLinkDestination=n(62273),t.parseLinkTitle=n(28451)},6468:e=>{e.exports=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/},7618:e=>{"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},7754:(e,t,n)=>{"use strict";var r=n(87423),s=n(6148),i=n(13107),a=n(5253),o=n(22849),l=n(35703),c=n(5732),u=n(48954),d=n(32040),h={default:n(33032),zero:n(78683),commonmark:n(85557)},p=/^(vbscript|javascript|file|data):/,g=/^data:image\/(gif|png|jpeg|webp);/;function m(e){var t=e.trim().toLowerCase();return!p.test(t)||!!g.test(t)}var f=["http:","https:","mailto:"];function y(e){var t=u.parse(e,!0);if(t.hostname&&(!t.protocol||f.indexOf(t.protocol)>=0))try{t.hostname=d.toASCII(t.hostname)}catch(e){}return u.encode(u.format(t))}function v(e){var t=u.parse(e,!0);if(t.hostname&&(!t.protocol||f.indexOf(t.protocol)>=0))try{t.hostname=d.toUnicode(t.hostname)}catch(e){}return u.decode(u.format(t),u.decode.defaultChars+"%")}function b(e,t){if(!(this instanceof b))return new b(e,t);t||r.isString(e)||(t=e||{},e="default"),this.inline=new l,this.block=new o,this.core=new a,this.renderer=new i,this.linkify=new c,this.validateLink=m,this.normalizeLink=y,this.normalizeLinkText=v,this.utils=r,this.helpers=r.assign({},s),this.options={},this.configure(e),t&&this.set(t)}b.prototype.set=function(e){return r.assign(this.options,e),this},b.prototype.configure=function(e){var t,n=this;if(r.isString(e)&&!(e=h[t=e]))throw new Error('Wrong `markdown-it` preset "'+t+'", check name');if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&n.set(e.options),e.components&&Object.keys(e.components).forEach((function(t){e.components[t].rules&&n[t].ruler.enableOnly(e.components[t].rules),e.components[t].rules2&&n[t].ruler2.enableOnly(e.components[t].rules2)})),this},b.prototype.enable=function(e,t){var n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach((function(t){n=n.concat(this[t].ruler.enable(e,!0))}),this),n=n.concat(this.inline.ruler2.enable(e,!0));var r=e.filter((function(e){return n.indexOf(e)<0}));if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this},b.prototype.disable=function(e,t){var n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach((function(t){n=n.concat(this[t].ruler.disable(e,!0))}),this),n=n.concat(this.inline.ruler2.disable(e,!0));var r=e.filter((function(e){return n.indexOf(e)<0}));if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this},b.prototype.use=function(e){var t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this},b.prototype.parse=function(e,t){if("string"!=typeof e)throw new Error("Input data should be a String");var n=new this.core.State(e,this,t);return this.core.process(n),n.tokens},b.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)},b.prototype.parseInline=function(e,t){var n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens},b.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)},e.exports=b},9789:(e,t,n)=>{"use strict";var r=n(87423).normalizeReference,s=n(87423).isSpace;e.exports=function(e,t,n,i){var a,o,l,c,u,d,h,p,g,m,f,y,v,b,C,w,S=0,E=e.bMarks[t]+e.tShift[t],x=e.eMarks[t],I=t+1;if(e.sCount[t]-e.blkIndent>=4)return!1;if(91!==e.src.charCodeAt(E))return!1;for(;++E<x;)if(93===e.src.charCodeAt(E)&&92!==e.src.charCodeAt(E-1)){if(E+1===x)return!1;if(58!==e.src.charCodeAt(E+1))return!1;break}for(c=e.lineMax,C=e.md.block.ruler.getRules("reference"),m=e.parentType,e.parentType="reference";I<c&&!e.isEmpty(I);I++)if(!(e.sCount[I]-e.blkIndent>3||e.sCount[I]<0)){for(b=!1,d=0,h=C.length;d<h;d++)if(C[d](e,I,c,!0)){b=!0;break}if(b)break}for(x=(v=e.getLines(t,I,e.blkIndent,!1).trim()).length,E=1;E<x;E++){if(91===(a=v.charCodeAt(E)))return!1;if(93===a){g=E;break}(10===a||92===a&&++E<x&&10===v.charCodeAt(E))&&S++}if(g<0||58!==v.charCodeAt(g+1))return!1;for(E=g+2;E<x;E++)if(10===(a=v.charCodeAt(E)))S++;else if(!s(a))break;if(!(f=e.md.helpers.parseLinkDestination(v,E,x)).ok)return!1;if(u=e.md.normalizeLink(f.str),!e.md.validateLink(u))return!1;for(o=E=f.pos,l=S+=f.lines,y=E;E<x;E++)if(10===(a=v.charCodeAt(E)))S++;else if(!s(a))break;for(f=e.md.helpers.parseLinkTitle(v,E,x),E<x&&y!==E&&f.ok?(w=f.str,E=f.pos,S+=f.lines):(w="",E=o,S=l);E<x&&(a=v.charCodeAt(E),s(a));)E++;if(E<x&&10!==v.charCodeAt(E)&&w)for(w="",E=o,S=l;E<x&&(a=v.charCodeAt(E),s(a));)E++;return!(E<x&&10!==v.charCodeAt(E))&&(!!(p=r(v.slice(1,g)))&&(i||(void 0===e.env.references&&(e.env.references={}),void 0===e.env.references[p]&&(e.env.references[p]={title:w,href:u}),e.parentType=m,e.line=t+S+1),!0))}},10038:e=>{"use strict";function t(e,t){var n,r,s,i,a,o;for(n=t.length-1;n>=0;n--)95!==(r=t[n]).marker&&42!==r.marker||-1!==r.end&&(s=t[r.end],o=n>0&&t[n-1].end===r.end+1&&t[n-1].marker===r.marker&&t[n-1].token===r.token-1&&t[r.end+1].token===s.token+1,a=String.fromCharCode(r.marker),(i=e.tokens[r.token]).type=o?"strong_open":"em_open",i.tag=o?"strong":"em",i.nesting=1,i.markup=o?a+a:a,i.content="",(i=e.tokens[s.token]).type=o?"strong_close":"em_close",i.tag=o?"strong":"em",i.nesting=-1,i.markup=o?a+a:a,i.content="",o&&(e.tokens[t[n-1].token].content="",e.tokens[t[r.end+1].token].content="",n--))}e.exports.q=function(e,t){var n,r,s=e.pos,i=e.src.charCodeAt(s);if(t)return!1;if(95!==i&&42!==i)return!1;for(r=e.scanDelims(e.pos,42===i),n=0;n<r.length;n++)e.push("text","",0).content=String.fromCharCode(i),e.delimiters.push({marker:i,length:r.length,token:e.tokens.length-1,end:-1,open:r.can_open,close:r.can_close});return e.pos+=r.length,!0},e.exports.g=function(e){var n,r=e.tokens_meta,s=e.tokens_meta.length;for(t(e,e.delimiters),n=0;n<s;n++)r[n]&&r[n].delimiters&&t(e,r[n].delimiters)}},11562:e=>{"use strict";e.exports=function(e,t){var n,r,s,i,a,o,l=t+1,c=e.md.block.ruler.getRules("paragraph"),u=e.lineMax;for(o=e.parentType,e.parentType="paragraph";l<u&&!e.isEmpty(l);l++)if(!(e.sCount[l]-e.blkIndent>3||e.sCount[l]<0)){for(r=!1,s=0,i=c.length;s<i;s++)if(c[s](e,l,u,!0)){r=!0;break}if(r)break}return n=e.getLines(t,l,e.blkIndent,!1).trim(),e.line=l,(a=e.push("paragraph_open","p",1)).map=[t,e.line],(a=e.push("inline","",0)).content=n,a.map=[t,e.line],a.children=[],a=e.push("paragraph_close","p",-1),e.parentType=o,!0}},13107:(e,t,n)=>{"use strict";var r=n(87423).assign,s=n(87423).unescapeAll,i=n(87423).escapeHtml,a={};function o(){this.rules=r({},a)}a.code_inline=function(e,t,n,r,s){var a=e[t];return"<code"+s.renderAttrs(a)+">"+i(e[t].content)+"</code>"},a.code_block=function(e,t,n,r,s){var a=e[t];return"<pre"+s.renderAttrs(a)+"><code>"+i(e[t].content)+"</code></pre>\n"},a.fence=function(e,t,n,r,a){var o,l,c,u,d,h=e[t],p=h.info?s(h.info).trim():"",g="",m="";return p&&(g=(c=p.split(/(\s+)/g))[0],m=c.slice(2).join("")),0===(o=n.highlight&&n.highlight(h.content,g,m)||i(h.content)).indexOf("<pre")?o+"\n":p?(l=h.attrIndex("class"),u=h.attrs?h.attrs.slice():[],l<0?u.push(["class",n.langPrefix+g]):(u[l]=u[l].slice(),u[l][1]+=" "+n.langPrefix+g),d={attrs:u},"<pre><code"+a.renderAttrs(d)+">"+o+"</code></pre>\n"):"<pre><code"+a.renderAttrs(h)+">"+o+"</code></pre>\n"},a.image=function(e,t,n,r,s){var i=e[t];return i.attrs[i.attrIndex("alt")][1]=s.renderInlineAsText(i.children,n,r),s.renderToken(e,t,n)},a.hardbreak=function(e,t,n){return n.xhtmlOut?"<br />\n":"<br>\n"},a.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?"<br />\n":"<br>\n":"\n"},a.text=function(e,t){return i(e[t].content)},a.html_block=function(e,t){return e[t].content},a.html_inline=function(e,t){return e[t].content},o.prototype.renderAttrs=function(e){var t,n,r;if(!e.attrs)return"";for(r="",t=0,n=e.attrs.length;t<n;t++)r+=" "+i(e.attrs[t][0])+'="'+i(e.attrs[t][1])+'"';return r},o.prototype.renderToken=function(e,t,n){var r,s="",i=!1,a=e[t];return a.hidden?"":(a.block&&-1!==a.nesting&&t&&e[t-1].hidden&&(s+="\n"),s+=(-1===a.nesting?"</":"<")+a.tag,s+=this.renderAttrs(a),0===a.nesting&&n.xhtmlOut&&(s+=" /"),a.block&&(i=!0,1===a.nesting&&t+1<e.length&&("inline"===(r=e[t+1]).type||r.hidden||-1===r.nesting&&r.tag===a.tag)&&(i=!1)),s+=i?">\n":">")},o.prototype.renderInline=function(e,t,n){for(var r,s="",i=this.rules,a=0,o=e.length;a<o;a++)void 0!==i[r=e[a].type]?s+=i[r](e,a,t,n,this):s+=this.renderToken(e,a,t);return s},o.prototype.renderInlineAsText=function(e,t,n){for(var r="",s=0,i=e.length;s<i;s++)"text"===e[s].type?r+=e[s].content:"image"===e[s].type?r+=this.renderInlineAsText(e[s].children,t,n):"softbreak"===e[s].type&&(r+="\n");return r},o.prototype.render=function(e,t,n){var r,s,i,a="",o=this.rules;for(r=0,s=e.length;r<s;r++)"inline"===(i=e[r].type)?a+=this.renderInline(e[r].children,t,n):void 0!==o[i]?a+=o[e[r].type](e,r,t,n,this):a+=this.renderToken(e,r,t,n);return a},e.exports=o},13802:e=>{"use strict";var t={};function n(e,r,s){var i,a,o,l,c,u="";for("string"!=typeof r&&(s=r,r=n.defaultChars),void 0===s&&(s=!0),c=function(e){var n,r,s=t[e];if(s)return s;for(s=t[e]=[],n=0;n<128;n++)r=String.fromCharCode(n),/^[0-9a-z]$/i.test(r)?s.push(r):s.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2));for(n=0;n<e.length;n++)s[e.charCodeAt(n)]=e[n];return s}(r),i=0,a=e.length;i<a;i++)if(o=e.charCodeAt(i),s&&37===o&&i+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3)))u+=e.slice(i,i+3),i+=2;else if(o<128)u+=c[o];else if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<a&&(l=e.charCodeAt(i+1))>=56320&&l<=57343){u+=encodeURIComponent(e[i]+e[i+1]),i++;continue}u+="%EF%BF%BD"}else u+=encodeURIComponent(e[i]);return u}n.defaultChars=";/?:@&=+$,-_.!~*'()#",n.componentChars="-_.!~*'()",e.exports=n},13894:e=>{"use strict";var t={};function n(e,r){var s;return"string"!=typeof r&&(r=n.defaultChars),s=function(e){var n,r,s=t[e];if(s)return s;for(s=t[e]=[],n=0;n<128;n++)r=String.fromCharCode(n),s.push(r);for(n=0;n<e.length;n++)s[r=e.charCodeAt(n)]="%"+("0"+r.toString(16).toUpperCase()).slice(-2);return s}(r),e.replace(/(%[a-f0-9]{2})+/gi,(function(e){var t,n,r,i,a,o,l,c="";for(t=0,n=e.length;t<n;t+=3)(r=parseInt(e.slice(t+1,t+3),16))<128?c+=s[r]:192==(224&r)&&t+3<n&&128==(192&(i=parseInt(e.slice(t+4,t+6),16)))?(c+=(l=r<<6&1984|63&i)<128?"��":String.fromCharCode(l),t+=3):224==(240&r)&&t+6<n&&(i=parseInt(e.slice(t+4,t+6),16),a=parseInt(e.slice(t+7,t+9),16),128==(192&i)&&128==(192&a))?(c+=(l=r<<12&61440|i<<6&4032|63&a)<2048||l>=55296&&l<=57343?"���":String.fromCharCode(l),t+=6):240==(248&r)&&t+9<n&&(i=parseInt(e.slice(t+4,t+6),16),a=parseInt(e.slice(t+7,t+9),16),o=parseInt(e.slice(t+10,t+12),16),128==(192&i)&&128==(192&a)&&128==(192&o))?((l=r<<18&1835008|i<<12&258048|a<<6&4032|63&o)<65536||l>1114111?c+="����":(l-=65536,c+=String.fromCharCode(55296+(l>>10),56320+(1023&l))),t+=9):c+="�";return c}))}n.defaultChars=";/?:@&=+$,#",n.componentChars="",e.exports=n},14267:e=>{"use strict";e.exports=function(e,t,n){var r,s=" ",i=e.level,a=e.dataLevel,o=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&o&&o.$data;if(h?(s+=" var schema"+i+" = "+e.util.getData(o.$data,a,e.dataPathArr)+"; ",r="schema"+i):r=o,!h&&"number"!=typeof o)throw new Error(t+" must be number");var p="maxLength"==t?">":"<";s+="if ( ",h&&(s+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),!1===e.opts.unicode?s+=" "+d+".length ":s+=" ucs2length("+d+") ",s+=" "+p+" "+r+") { ";var g=t,m=m||[];m.push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(g||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==e.opts.messages&&(s+=" , message: 'should NOT be ",s+="maxLength"==t?"longer":"shorter",s+=" than ",s+=h?"' + "+r+" + '":""+o,s+=" characters' "),e.opts.verbose&&(s+=" , schema:  ",s+=h?"validate.schema"+l:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),s+=" } "):s+=" {} ";var f=s;return s=m.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+f+"]); ":s+=" validate.errors = ["+f+"]; return false; ":s+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",u&&(s+=" else { "),s}},16277:e=>{e.exports=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4E\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDF55-\uDF59]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD806[\uDC3B\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/},17366:(e,t,n)=>{"use strict";var r=n(95906),s=n(70408),i=n(77043),a=n(21400),o=n(87789),l=s.ucs2length,c=n(97288),u=i.Validation;function d(e,t,n){var r=p.call(this,e,t,n);return r>=0?{index:r,compiling:!0}:(r=this._compilations.length,this._compilations[r]={schema:e,root:t,baseId:n},{index:r,compiling:!1})}function h(e,t,n){var r=p.call(this,e,t,n);r>=0&&this._compilations.splice(r,1)}function p(e,t,n){for(var r=0;r<this._compilations.length;r++){var s=this._compilations[r];if(s.schema==e&&s.root==t&&s.baseId==n)return r}return-1}function g(e,t){return"var pattern"+e+" = new RegExp("+s.toQuotedString(t[e])+");"}function m(e){return"var default"+e+" = defaults["+e+"];"}function f(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function y(e){return"var customRule"+e+" = customRules["+e+"];"}function v(e,t){if(!e.length)return"";for(var n="",r=0;r<e.length;r++)n+=t(r,e);return n}e.exports=function e(t,n,p,b){var C=this,w=this._opts,S=[void 0],E={},x=[],I={},A=[],P={},k=[];n=n||{schema:t,refVal:S,refs:E};var T=d.call(this,t,n,b),D=this._compilations[T.index];if(T.compiling)return D.callValidate=function e(){var t=D.validate,n=t.apply(this,arguments);return e.errors=t.errors,n};var M=this._formats,L=this.RULES;try{var R=O(t,n,p,b);D.validate=R;var N=D.callValidate;return N&&(N.schema=R.schema,N.errors=null,N.refs=R.refs,N.refVal=R.refVal,N.root=R.root,N.$async=R.$async,w.sourceCode&&(N.source=R.source)),R}finally{h.call(this,t,n,b)}function O(t,a,d,h){var p=!a||a&&a.schema==t;if(a.schema!=n.schema)return e.call(C,t,a,d,h);var b,I=!0===t.$async,P=o({isTop:!0,schema:t,isRoot:p,baseId:h,root:a,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:i.MissingRef,RULES:L,validate:o,util:s,resolve:r,resolveRef:_,usePattern:U,useDefault:H,useCustomRule:z,opts:w,formats:M,logger:C.logger,self:C});P=v(S,f)+v(x,g)+v(A,m)+v(k,y)+P,w.processCode&&(P=w.processCode(P,t));try{b=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",P)(C,L,M,n,S,A,k,c,l,u),S[0]=b}catch(e){throw C.logger.error("Error compiling schema, function code:",P),e}return b.schema=t,b.errors=null,b.refs=E,b.refVal=S,b.root=p?b:a,I&&(b.$async=!0),!0===w.sourceCode&&(b.source={code:P,patterns:x,defaults:A}),b}function _(t,s,i){s=r.url(t,s);var a,o,l=E[s];if(void 0!==l)return F(a=S[l],o="refVal["+l+"]");if(!i&&n.refs){var c=n.refs[s];if(void 0!==c)return F(a=n.refVal[c],o=B(s,a))}o=B(s);var u=r.call(C,O,n,s);if(void 0===u){var d=p&&p[s];d&&(u=r.inlineRef(d,w.inlineRefs)?d:e.call(C,d,n,p,t))}if(void 0!==u)return function(e,t){var n=E[e];S[n]=t}(s,u),F(u,o);!function(e){delete E[e]}(s)}function B(e,t){var n=S.length;return S[n]=t,E[e]=n,"refVal"+n}function F(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function U(e){var t=I[e];return void 0===t&&(t=I[e]=x.length,x[t]=e),"pattern"+t}function H(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return s.toQuotedString(e);case"object":if(null===e)return"null";var t=a(e),n=P[t];return void 0===n&&(n=P[t]=A.length,A[n]=e),"default"+n}}function z(e,t,n,r){if(!1!==C._opts.validateSchema){var s=e.definition.dependencies;if(s&&!s.every((function(e){return Object.prototype.hasOwnProperty.call(n,e)})))throw new Error("parent schema must have all required keywords: "+s.join(","));var i=e.definition.validateSchema;if(i)if(!i(t)){var a="keyword schema is invalid: "+C.errorsText(i.errors);if("log"!=C._opts.validateSchema)throw new Error(a);C.logger.error(a)}}var o,l=e.definition.compile,c=e.definition.inline,u=e.definition.macro;if(l)o=l.call(C,t,n,r);else if(u)o=u.call(C,t,n,r),!1!==w.validateSchema&&C.validateSchema(o,!0);else if(c)o=c.call(C,r,e.keyword,t,n);else if(!(o=e.definition.validate))return;if(void 0===o)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var d=k.length;return k[d]=o,{code:"customRule"+d,validate:o}}}},18338:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="valid"+s,h="errs__"+s,p=e.util.copy(e),g="";p.level++;var m="valid"+p.level,f=p.baseId,y="prevValid"+s,v="passingSchemas"+s;r+="var "+h+" = errors , "+y+" = false , "+d+" = false , "+v+" = null; ";var b=e.compositeRule;e.compositeRule=p.compositeRule=!0;var C=a;if(C)for(var w,S=-1,E=C.length-1;S<E;)w=C[S+=1],(e.opts.strictKeywords?"object"==typeof w&&Object.keys(w).length>0||!1===w:e.util.schemaHasRules(w,e.RULES.all))?(p.schema=w,p.schemaPath=o+"["+S+"]",p.errSchemaPath=l+"/"+S,r+="  "+e.validate(p)+" ",p.baseId=f):r+=" var "+m+" = true; ",S&&(r+=" if ("+m+" && "+y+") { "+d+" = false; "+v+" = ["+v+", "+S+"]; } else { ",g+="}"),r+=" if ("+m+") { "+d+" = "+y+" = true; "+v+" = "+S+"; }";return e.compositeRule=p.compositeRule=b,r+=g+"if (!"+d+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { passingSchemas: "+v+" } ",!1!==e.opts.messages&&(r+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+="} else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }",e.opts.allErrors&&(r+=" } "),r}},18691:e=>{"use strict";function t(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}e.exports=function(e,n){for(var r=e.pos;r<e.posMax&&!t(e.src.charCodeAt(r));)r++;return r!==e.pos&&(n||(e.pending+=e.src.slice(e.pos,r)),e.pos=r,!0)}},18788:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||"");if(!1===e.opts.format)return c&&(r+=" if (true) { "),r;var d,h=e.opts.$data&&a&&a.$data;h?(r+=" var schema"+s+" = "+e.util.getData(a.$data,i,e.dataPathArr)+"; ",d="schema"+s):d=a;var p=e.opts.unknownFormats,g=Array.isArray(p);if(h){r+=" var "+(m="format"+s)+" = formats["+d+"]; var "+(f="isObject"+s)+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+(y="formatType"+s)+" = "+f+" && "+m+".type || 'string'; if ("+f+") { ",e.async&&(r+=" var async"+s+" = "+m+".async; "),r+=" "+m+" = "+m+".validate; } if (  ",h&&(r+=" ("+d+" !== undefined && typeof "+d+" != 'string') || "),r+=" (","ignore"!=p&&(r+=" ("+d+" && !"+m+" ",g&&(r+=" && self._opts.unknownFormats.indexOf("+d+") == -1 "),r+=") || "),r+=" ("+m+" && "+y+" == '"+n+"' && !(typeof "+m+" == 'function' ? ",e.async?r+=" (async"+s+" ? await "+m+"("+u+") : "+m+"("+u+")) ":r+=" "+m+"("+u+") ",r+=" : "+m+".test("+u+"))))) {"}else{var m;if(!(m=e.formats[a])){if("ignore"==p)return e.logger.warn('unknown format "'+a+'" ignored in schema at path "'+e.errSchemaPath+'"'),c&&(r+=" if (true) { "),r;if(g&&p.indexOf(a)>=0)return c&&(r+=" if (true) { "),r;throw new Error('unknown format "'+a+'" is used in schema at path "'+e.errSchemaPath+'"')}var f,y=(f="object"==typeof m&&!(m instanceof RegExp)&&m.validate)&&m.type||"string";if(f){var v=!0===m.async;m=m.validate}if(y!=n)return c&&(r+=" if (true) { "),r;if(v){if(!e.async)throw new Error("async format in sync schema");r+=" if (!(await "+(b="formats"+e.util.getProperty(a)+".validate")+"("+u+"))) { "}else{r+=" if (! ";var b="formats"+e.util.getProperty(a);f&&(b+=".validate"),r+="function"==typeof m?" "+b+"("+u+") ":" "+b+".test("+u+") ",r+=") { "}}var C=C||[];C.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { format:  ",r+=h?""+d:""+e.util.toQuotedString(a),r+="  } ",!1!==e.opts.messages&&(r+=" , message: 'should match format \"",r+=h?"' + "+d+" + '":""+e.util.escapeQuotes(a),r+="\"' "),e.opts.verbose&&(r+=" , schema:  ",r+=h?"validate.schema"+o:""+e.util.toQuotedString(a),r+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var w=r;return r=C.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+w+"]); ":r+=" validate.errors = ["+w+"]; return false; ":r+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",c&&(r+=" else { "),r}},19247:e=>{e.exports=/[\0-\x1F\x7F-\x9F]/},21400:e=>{"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,r="boolean"==typeof t.cycles&&t.cycles,s=t.cmp&&(n=t.cmp,function(e){return function(t,r){var s={key:t,value:e[t]},i={key:r,value:e[r]};return n(s,i)}}),i=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,a;if(Array.isArray(t)){for(a="[",n=0;n<t.length;n++)n&&(a+=","),a+=e(t[n])||"null";return a+"]"}if(null===t)return"null";if(-1!==i.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var o=i.push(t)-1,l=Object.keys(t).sort(s&&s(t));for(a="",n=0;n<l.length;n++){var c=l[n],u=e(t[c]);u&&(a&&(a+=","),a+=JSON.stringify(c)+":"+u)}return i.splice(o,1),"{"+a+"}"}}(e)}},21967:(e,t,n)=>{"use strict";var r=n(41759),s=n(87423).isWhiteSpace,i=n(87423).isPunctChar,a=n(87423).isMdAsciiPunct;function o(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1}o.prototype.pushPending=function(){var e=new r("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e},o.prototype.push=function(e,t,n){this.pending&&this.pushPending();var s=new r(e,t,n),i=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),s.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],i={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(s),this.tokens_meta.push(i),s},o.prototype.scanDelims=function(e,t){var n,r,o,l,c,u,d,h,p,g=e,m=!0,f=!0,y=this.posMax,v=this.src.charCodeAt(e);for(n=e>0?this.src.charCodeAt(e-1):32;g<y&&this.src.charCodeAt(g)===v;)g++;return o=g-e,r=g<y?this.src.charCodeAt(g):32,d=a(n)||i(String.fromCharCode(n)),p=a(r)||i(String.fromCharCode(r)),u=s(n),(h=s(r))?m=!1:p&&(u||d||(m=!1)),u?f=!1:d&&(h||p||(f=!1)),t?(l=m,c=f):(l=m&&(!f||d),c=f&&(!m||p)),{can_open:l,can_close:c,length:o}},o.prototype.Token=r,e.exports=o},22849:(e,t,n)=>{"use strict";var r=n(85542),s=[["table",n(69764),["paragraph","reference"]],["code",n(88667)],["fence",n(34241),["paragraph","reference","blockquote","list"]],["blockquote",n(49745),["paragraph","reference","blockquote","list"]],["hr",n(88436),["paragraph","reference","blockquote","list"]],["list",n(23138),["paragraph","reference","blockquote"]],["reference",n(9789)],["html_block",n(92293),["paragraph","reference","blockquote"]],["heading",n(49449),["paragraph","reference","blockquote"]],["lheading",n(49724)],["paragraph",n(11562)]];function i(){this.ruler=new r;for(var e=0;e<s.length;e++)this.ruler.push(s[e][0],s[e][1],{alt:(s[e][2]||[]).slice()})}i.prototype.tokenize=function(e,t,n){for(var r,s=this.ruler.getRules(""),i=s.length,a=t,o=!1,l=e.md.options.maxNesting;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n))&&!(e.sCount[a]<e.blkIndent);){if(e.level>=l){e.line=n;break}for(r=0;r<i&&!s[r](e,a,n,!1);r++);e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),(a=e.line)<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}},i.prototype.parse=function(e,t,n,r){var s;e&&(s=new this.State(e,t,n,r),this.tokenize(s,s.line,s.lineMax))},i.prototype.State=n(84283),e.exports=i},23138:(e,t,n)=>{"use strict";var r=n(87423).isSpace;function s(e,t){var n,s,i,a;return s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],42!==(n=e.src.charCodeAt(s++))&&45!==n&&43!==n||s<i&&(a=e.src.charCodeAt(s),!r(a))?-1:s}function i(e,t){var n,s=e.bMarks[t]+e.tShift[t],i=s,a=e.eMarks[t];if(i+1>=a)return-1;if((n=e.src.charCodeAt(i++))<48||n>57)return-1;for(;;){if(i>=a)return-1;if(!((n=e.src.charCodeAt(i++))>=48&&n<=57)){if(41===n||46===n)break;return-1}if(i-s>=10)return-1}return i<a&&(n=e.src.charCodeAt(i),!r(n))?-1:i}e.exports=function(e,t,n,r){var a,o,l,c,u,d,h,p,g,m,f,y,v,b,C,w,S,E,x,I,A,P,k,T,D,M,L,R,N=!1,O=!0;if(e.sCount[t]-e.blkIndent>=4)return!1;if(e.listIndent>=0&&e.sCount[t]-e.listIndent>=4&&e.sCount[t]<e.blkIndent)return!1;if(r&&"paragraph"===e.parentType&&e.sCount[t]>=e.blkIndent&&(N=!0),(k=i(e,t))>=0){if(h=!0,D=e.bMarks[t]+e.tShift[t],v=Number(e.src.slice(D,k-1)),N&&1!==v)return!1}else{if(!((k=s(e,t))>=0))return!1;h=!1}if(N&&e.skipSpaces(k)>=e.eMarks[t])return!1;if(y=e.src.charCodeAt(k-1),r)return!0;for(f=e.tokens.length,h?(R=e.push("ordered_list_open","ol",1),1!==v&&(R.attrs=[["start",v]])):R=e.push("bullet_list_open","ul",1),R.map=m=[t,0],R.markup=String.fromCharCode(y),C=t,T=!1,L=e.md.block.ruler.getRules("list"),E=e.parentType,e.parentType="list";C<n;){for(P=k,b=e.eMarks[C],d=w=e.sCount[C]+k-(e.bMarks[t]+e.tShift[t]);P<b;){if(9===(a=e.src.charCodeAt(P)))w+=4-(w+e.bsCount[C])%4;else{if(32!==a)break;w++}P++}if((u=(o=P)>=b?1:w-d)>4&&(u=1),c=d+u,(R=e.push("list_item_open","li",1)).markup=String.fromCharCode(y),R.map=p=[t,0],h&&(R.info=e.src.slice(D,k-1)),A=e.tight,I=e.tShift[t],x=e.sCount[t],S=e.listIndent,e.listIndent=e.blkIndent,e.blkIndent=c,e.tight=!0,e.tShift[t]=o-e.bMarks[t],e.sCount[t]=w,o>=b&&e.isEmpty(t+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,t,n,!0),e.tight&&!T||(O=!1),T=e.line-t>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=S,e.tShift[t]=I,e.sCount[t]=x,e.tight=A,(R=e.push("list_item_close","li",-1)).markup=String.fromCharCode(y),C=t=e.line,p[1]=C,o=e.bMarks[t],C>=n)break;if(e.sCount[C]<e.blkIndent)break;if(e.sCount[t]-e.blkIndent>=4)break;for(M=!1,l=0,g=L.length;l<g;l++)if(L[l](e,C,n,!0)){M=!0;break}if(M)break;if(h){if((k=i(e,C))<0)break;D=e.bMarks[C]+e.tShift[C]}else if((k=s(e,C))<0)break;if(y!==e.src.charCodeAt(k-1))break}return(R=h?e.push("ordered_list_close","ol",-1):e.push("bullet_list_close","ul",-1)).markup=String.fromCharCode(y),m[1]=C,e.line=C,e.parentType=E,O&&function(e,t){var n,r,s=e.level+2;for(n=t+2,r=e.tokens.length-2;n<r;n++)e.tokens[n].level===s&&"paragraph_open"===e.tokens[n].type&&(e.tokens[n+2].hidden=!0,e.tokens[n].hidden=!0,n+=2)}(e,f),!0}},24176:(e,t,n)=>{"use strict";var r=n(87423).isWhiteSpace,s=n(87423).isPunctChar,i=n(87423).isMdAsciiPunct,a=/['"]/,o=/['"]/g;function l(e,t,n){return e.substr(0,t)+n+e.substr(t+1)}function c(e,t){var n,a,c,u,d,h,p,g,m,f,y,v,b,C,w,S,E,x,I,A,P;for(I=[],n=0;n<e.length;n++){for(a=e[n],p=e[n].level,E=I.length-1;E>=0&&!(I[E].level<=p);E--);if(I.length=E+1,"text"===a.type){d=0,h=(c=a.content).length;e:for(;d<h&&(o.lastIndex=d,u=o.exec(c));){if(w=S=!0,d=u.index+1,x="'"===u[0],m=32,u.index-1>=0)m=c.charCodeAt(u.index-1);else for(E=n-1;E>=0&&("softbreak"!==e[E].type&&"hardbreak"!==e[E].type);E--)if(e[E].content){m=e[E].content.charCodeAt(e[E].content.length-1);break}if(f=32,d<h)f=c.charCodeAt(d);else for(E=n+1;E<e.length&&("softbreak"!==e[E].type&&"hardbreak"!==e[E].type);E++)if(e[E].content){f=e[E].content.charCodeAt(0);break}if(y=i(m)||s(String.fromCharCode(m)),v=i(f)||s(String.fromCharCode(f)),b=r(m),(C=r(f))?w=!1:v&&(b||y||(w=!1)),b?S=!1:y&&(C||v||(S=!1)),34===f&&'"'===u[0]&&m>=48&&m<=57&&(S=w=!1),w&&S&&(w=y,S=v),w||S){if(S)for(E=I.length-1;E>=0&&(g=I[E],!(I[E].level<p));E--)if(g.single===x&&I[E].level===p){g=I[E],x?(A=t.md.options.quotes[2],P=t.md.options.quotes[3]):(A=t.md.options.quotes[0],P=t.md.options.quotes[1]),a.content=l(a.content,u.index,P),e[g.token].content=l(e[g.token].content,g.pos,A),d+=P.length-1,g.token===n&&(d+=A.length-1),h=(c=a.content).length,I.length=E;continue e}w?I.push({token:n,pos:u.index,single:x,level:p}):S&&x&&(a.content=l(a.content,u.index,"’"))}else x&&(a.content=l(a.content,u.index,"’"))}}}}e.exports=function(e){var t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)"inline"===e.tokens[t].type&&a.test(e.tokens[t].content)&&c(e.tokens[t].children,e)}},25681:e=>{"use strict";var t="<[A-Za-z][A-Za-z0-9\\-]*(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^\"'=<>`\\x00-\\x20]+|'[^']*'|\"[^\"]*\"))?)*\\s*\\/?>",n="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",r=new RegExp("^(?:"+t+"|"+n+"|\x3c!----\x3e|\x3c!--(?:-?[^>-])(?:-?[^-])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Z]+\\s+[^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)"),s=new RegExp("^(?:"+t+"|"+n+")");e.exports.l=r,e.exports.p=s},25812:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="valid"+s,h=e.opts.$data&&a&&a.$data;h&&(r+=" var schema"+s+" = "+e.util.getData(a.$data,i,e.dataPathArr)+"; "),h||(r+=" var schema"+s+" = validate.schema"+o+";"),r+="var "+d+" = equal("+u+", schema"+s+"); if (!"+d+") {   ";var p=p||[];p.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValue: schema"+s+" } ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to constant' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var g=r;return r=p.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+g+"]); ":r+=" validate.errors = ["+g+"]; return false; ":r+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",c&&(r+=" else { "),r}},28451:(e,t,n)=>{"use strict";var r=n(87423).unescapeAll;e.exports=function(e,t,n){var s,i,a=0,o=t,l={ok:!1,pos:0,lines:0,str:""};if(t>=n)return l;if(34!==(i=e.charCodeAt(t))&&39!==i&&40!==i)return l;for(t++,40===i&&(i=41);t<n;){if((s=e.charCodeAt(t))===i)return l.pos=t+1,l.lines=a,l.str=r(e.slice(o+1,t)),l.ok=!0,l;if(40===s&&41===i)return l;10===s?a++:92===s&&t+1<n&&(t++,10===e.charCodeAt(t)&&a++),t++}return l}},30949:e=>{"use strict";e.exports=function(e){var t,n,r=0,s=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)s[t].nesting<0&&r--,s[t].level=r,s[t].nesting>0&&r++,"text"===s[t].type&&t+1<i&&"text"===s[t+1].type?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}},32040:e=>{"use strict";const t=2147483647,n=36,r=/^xn--/,s=/[^\0-\x7F]/,i=/[\x2E\u3002\uFF0E\uFF61]/g,a={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},o=Math.floor,l=String.fromCharCode;function c(e){throw new RangeError(a[e])}function u(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]);const s=function(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}((e=e.replace(i,".")).split("."),t).join(".");return r+s}function d(e){const t=[];let n=0;const r=e.length;for(;n<r;){const s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){const r=e.charCodeAt(n++);56320==(64512&r)?t.push(((1023&s)<<10)+(1023&r)+65536):(t.push(s),n--)}else t.push(s)}return t}const h=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},p=function(e,t,r){let s=0;for(e=r?o(e/700):e>>1,e+=o(e/t);e>455;s+=n)e=o(e/35);return o(s+36*e/(e+38))},g=function(e){const r=[],s=e.length;let i=0,a=128,l=72,u=e.lastIndexOf("-");u<0&&(u=0);for(let t=0;t<u;++t)e.charCodeAt(t)>=128&&c("not-basic"),r.push(e.charCodeAt(t));for(let h=u>0?u+1:0;h<s;){const u=i;for(let r=1,a=n;;a+=n){h>=s&&c("invalid-input");const u=(d=e.charCodeAt(h++))>=48&&d<58?d-48+26:d>=65&&d<91?d-65:d>=97&&d<123?d-97:n;u>=n&&c("invalid-input"),u>o((t-i)/r)&&c("overflow"),i+=u*r;const p=a<=l?1:a>=l+26?26:a-l;if(u<p)break;const g=n-p;r>o(t/g)&&c("overflow"),r*=g}const g=r.length+1;l=p(i-u,g,0==u),o(i/g)>t-a&&c("overflow"),a+=o(i/g),i%=g,r.splice(i++,0,a)}var d;return String.fromCodePoint(...r)},m=function(e){const r=[],s=(e=d(e)).length;let i=128,a=0,u=72;for(const t of e)t<128&&r.push(l(t));const g=r.length;let m=g;for(g&&r.push("-");m<s;){let s=t;for(const t of e)t>=i&&t<s&&(s=t);const d=m+1;s-i>o((t-a)/d)&&c("overflow"),a+=(s-i)*d,i=s;for(const s of e)if(s<i&&++a>t&&c("overflow"),s===i){let e=a;for(let t=n;;t+=n){const s=t<=u?1:t>=u+26?26:t-u;if(e<s)break;const i=e-s,a=n-s;r.push(l(h(s+i%a,0))),e=o(i/a)}r.push(l(h(e,0))),u=p(a,d,m===g),a=0,++m}++a,++i}return r.join("")},f={version:"2.3.1",ucs2:{decode:d,encode:e=>String.fromCodePoint(...e)},decode:g,encode:m,toASCII:function(e){return u(e,(function(e){return s.test(e)?"xn--"+m(e):e}))},toUnicode:function(e){return u(e,(function(e){return r.test(e)?g(e.slice(4).toLowerCase()):e}))}};e.exports=f},32399:e=>{e.exports=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/},32506:e=>{"use strict";var t=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,n){for(var r=0;r<n.length;r++){e=JSON.parse(JSON.stringify(e));var s,i=n[r].split("/"),a=e;for(s=1;s<i.length;s++)a=a[i[s]];for(s=0;s<t.length;s++){var o=t[s],l=a[o];l&&(a[o]={anyOf:[l,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return e}},33032:e=>{"use strict";e.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}}},33544:e=>{"use strict";function t(e,t){var n,r,s,i,a,o,l,c,u={},d=t.length;if(d){var h=0,p=-2,g=[];for(n=0;n<d;n++)if(s=t[n],g.push(0),t[h].marker===s.marker&&p===s.token-1||(h=n),p=s.token,s.length=s.length||0,s.close){for(u.hasOwnProperty(s.marker)||(u[s.marker]=[-1,-1,-1,-1,-1,-1]),a=u[s.marker][(s.open?3:0)+s.length%3],o=r=h-g[h]-1;r>a;r-=g[r]+1)if((i=t[r]).marker===s.marker&&i.open&&i.end<0&&(l=!1,(i.close||s.open)&&(i.length+s.length)%3==0&&(i.length%3==0&&s.length%3==0||(l=!0)),!l)){c=r>0&&!t[r-1].open?g[r-1]+1:0,g[n]=n-r+c,g[r]=c,s.open=!1,i.end=n,i.close=!1,o=-1,p=-2;break}-1!==o&&(u[s.marker][(s.open?3:0)+(s.length||0)%3]=o)}}}e.exports=function(e){var n,r=e.tokens_meta,s=e.tokens_meta.length;for(t(0,e.delimiters),n=0;n<s;n++)r[n]&&r[n].delimiters&&t(0,r[n].delimiters)}},34241:e=>{"use strict";e.exports=function(e,t,n,r){var s,i,a,o,l,c,u,d=!1,h=e.bMarks[t]+e.tShift[t],p=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(h+3>p)return!1;if(126!==(s=e.src.charCodeAt(h))&&96!==s)return!1;if(l=h,(i=(h=e.skipChars(h,s))-l)<3)return!1;if(u=e.src.slice(l,h),a=e.src.slice(h,p),96===s&&a.indexOf(String.fromCharCode(s))>=0)return!1;if(r)return!0;for(o=t;!(++o>=n)&&!((h=l=e.bMarks[o]+e.tShift[o])<(p=e.eMarks[o])&&e.sCount[o]<e.blkIndent);)if(e.src.charCodeAt(h)===s&&!(e.sCount[o]-e.blkIndent>=4||(h=e.skipChars(h,s))-l<i||(h=e.skipSpaces(h))<p)){d=!0;break}return i=e.sCount[t],e.line=o+(d?1:0),(c=e.push("fence","code",0)).info=a,c.content=e.getLines(t+1,o,i,!0),c.markup=u,c.map=[t,e.line],!0}},35703:(e,t,n)=>{"use strict";var r=n(85542),s=[["text",n(18691)],["newline",n(74666)],["escape",n(41467)],["backticks",n(60513)],["strikethrough",n(98409).q],["emphasis",n(10038).q],["link",n(3796)],["image",n(80151)],["autolink",n(94223)],["html_inline",n(85445)],["entity",n(92355)]],i=[["balance_pairs",n(33544)],["strikethrough",n(98409).g],["emphasis",n(10038).g],["text_collapse",n(30949)]];function a(){var e;for(this.ruler=new r,e=0;e<s.length;e++)this.ruler.push(s[e][0],s[e][1]);for(this.ruler2=new r,e=0;e<i.length;e++)this.ruler2.push(i[e][0],i[e][1])}a.prototype.skipToken=function(e){var t,n,r=e.pos,s=this.ruler.getRules(""),i=s.length,a=e.md.options.maxNesting,o=e.cache;if(void 0===o[r]){if(e.level<a)for(n=0;n<i&&(e.level++,t=s[n](e,!0),e.level--,!t);n++);else e.pos=e.posMax;t||e.pos++,o[r]=e.pos}else e.pos=o[r]},a.prototype.tokenize=function(e){for(var t,n,r=this.ruler.getRules(""),s=r.length,i=e.posMax,a=e.md.options.maxNesting;e.pos<i;){if(e.level<a)for(n=0;n<s&&!(t=r[n](e,!1));n++);if(t){if(e.pos>=i)break}else e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()},a.prototype.parse=function(e,t,n,r){var s,i,a,o=new this.State(e,t,n,r);for(this.tokenize(o),a=(i=this.ruler2.getRules("")).length,s=0;s<a;s++)i[s](o)},a.prototype.State=n(21967),e.exports=a},38174:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="valid"+s,h="errs__"+s,p=e.util.copy(e);p.level++;var g="valid"+p.level,m="i"+s,f=p.dataLevel=e.dataLevel+1,y="data"+f,v=e.baseId,b=e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all);if(r+="var "+h+" = errors;var "+d+";",b){var C=e.compositeRule;e.compositeRule=p.compositeRule=!0,p.schema=a,p.schemaPath=o,p.errSchemaPath=l,r+=" var "+g+" = false; for (var "+m+" = 0; "+m+" < "+u+".length; "+m+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers,!0);var w=u+"["+m+"]";p.dataPathArr[f]=m;var S=e.validate(p);p.baseId=v,e.util.varOccurences(S,y)<2?r+=" "+e.util.varReplace(S,y,w)+" ":r+=" var "+y+" = "+w+"; "+S+" ",r+=" if ("+g+") break; }  ",e.compositeRule=p.compositeRule=C,r+="  if (!"+g+") {"}else r+=" if ("+u+".length == 0) {";var E=E||[];E.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should contain a valid item' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var x=r;return r=E.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+x+"]); ":r+=" validate.errors = ["+x+"]; return false; ":r+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { ",b&&(r+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } "),e.opts.allErrors&&(r+=" } "),r}},39489:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="valid"+s,h=e.opts.$data&&a&&a.$data;h&&(r+=" var schema"+s+" = "+e.util.getData(a.$data,i,e.dataPathArr)+"; ");var p="schema"+s;if(!h)if(a.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var g=[],m=a;if(m)for(var f,y=-1,v=m.length-1;y<v;){f=m[y+=1];var b=e.schema.properties[f];b&&(e.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0||!1===b:e.util.schemaHasRules(b,e.RULES.all))||(g[g.length]=f)}}else g=a;if(h||g.length){var C=e.errorPath,w=h||g.length>=e.opts.loopRequired,S=e.opts.ownProperties;if(c)if(r+=" var missing"+s+"; ",w){h||(r+=" var "+p+" = validate.schema"+o+"; ");var E="' + "+(T="schema"+s+"["+(A="i"+s)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(C,T,e.opts.jsonPointers)),r+=" var "+d+" = true; ",h&&(r+=" if (schema"+s+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+s+")) "+d+" = false; else {"),r+=" for (var "+A+" = 0; "+A+" < "+p+".length; "+A+"++) { "+d+" = "+u+"["+p+"["+A+"]] !== undefined ",S&&(r+=" &&   Object.prototype.hasOwnProperty.call("+u+", "+p+"["+A+"]) "),r+="; if (!"+d+") break; } ",h&&(r+="  }  "),r+="  if (!"+d+") {   ",(k=k||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var x=r;r=k.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+x+"]); ":r+=" validate.errors = ["+x+"]; return false; ":r+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else{r+=" if ( ";var I=g;if(I)for(var A=-1,P=I.length-1;A<P;){M=I[A+=1],A&&(r+=" || "),r+=" ( ( "+(O=u+(N=e.util.getProperty(M)))+" === undefined ",S&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(M)+"') "),r+=") && (missing"+s+" = "+e.util.toQuotedString(e.opts.jsonPointers?M:N)+") ) "}r+=") {  ";var k;E="' + "+(T="missing"+s)+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(C,T,!0):C+" + "+T),(k=k||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";x=r;r=k.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+x+"]); ":r+=" validate.errors = ["+x+"]; return false; ":r+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else { "}else if(w){h||(r+=" var "+p+" = validate.schema"+o+"; ");var T;E="' + "+(T="schema"+s+"["+(A="i"+s)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(C,T,e.opts.jsonPointers)),h&&(r+=" if ("+p+" && !Array.isArray("+p+")) {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+p+" !== undefined) { "),r+=" for (var "+A+" = 0; "+A+" < "+p+".length; "+A+"++) { if ("+u+"["+p+"["+A+"]] === undefined ",S&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", "+p+"["+A+"]) "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",h&&(r+="  }  ")}else{var D=g;if(D)for(var M,L=-1,R=D.length-1;L<R;){M=D[L+=1];var N=e.util.getProperty(M),O=(E=e.util.escapeQuotes(M),u+N);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(C,M,e.opts.jsonPointers)),r+=" if ( "+O+" === undefined ",S&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(M)+"') "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+E+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+E+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=C}else c&&(r+=" if (true) {");return r}},39601:(e,t,n)=>{"use strict";var r=n(68559),s=n(70408).toHash;e.exports=function(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=s(t),e.types=s(["number","integer","string","array","object","boolean","null"]),e.forEach((function(n){n.rules=n.rules.map((function(n){var s;if("object"==typeof n){var i=Object.keys(n)[0];s=n[i],n=i,s.forEach((function(n){t.push(n),e.all[n]=!0}))}return t.push(n),e.all[n]={keyword:n,code:r[n],implements:s}})),e.all.$comment={keyword:"$comment",code:r.$comment},n.type&&(e.types[n.type]=n)})),e.keywords=s(t.concat(["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}},40723:e=>{"use strict";var t=e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),n(t,"function"==typeof(r=t.cb||r)?r:r.pre||function(){},r.post||function(){},e,"",e)};function n(e,r,s,i,a,o,l,c,u,d){if(i&&"object"==typeof i&&!Array.isArray(i)){for(var h in r(i,a,o,l,c,u,d),i){var p=i[h];if(Array.isArray(p)){if(h in t.arrayKeywords)for(var g=0;g<p.length;g++)n(e,r,s,p[g],a+"/"+h+"/"+g,o,a,h,i,g)}else if(h in t.propsKeywords){if(p&&"object"==typeof p)for(var m in p)n(e,r,s,p[m],a+"/"+h+"/"+m.replace(/~/g,"~0").replace(/\//g,"~1"),o,a,h,i,m)}else(h in t.keywords||e.allKeys&&!(h in t.skipKeywords))&&n(e,r,s,p,a+"/"+h,o,a,h,i)}s(i,a,o,l,c,u,d)}}t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},41467:(e,t,n)=>{"use strict";for(var r=n(87423).isSpace,s=[],i=0;i<256;i++)s.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach((function(e){s[e.charCodeAt(0)]=1})),e.exports=function(e,t){var n,i=e.pos,a=e.posMax;if(92!==e.src.charCodeAt(i))return!1;if(++i<a){if((n=e.src.charCodeAt(i))<256&&0!==s[n])return t||(e.pending+=e.src[i]),e.pos+=2,!0;if(10===n){for(t||e.push("hardbreak","br",0),i++;i<a&&(n=e.src.charCodeAt(i),r(n));)i++;return e.pos=i,!0}}return t||(e.pending+="\\"),e.pos++,!0}},41759:e=>{"use strict";function t(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}t.prototype.attrIndex=function(e){var t,n,r;if(!this.attrs)return-1;for(n=0,r=(t=this.attrs).length;n<r;n++)if(t[n][0]===e)return n;return-1},t.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]},t.prototype.attrSet=function(e,t){var n=this.attrIndex(e),r=[e,t];n<0?this.attrPush(r):this.attrs[n]=r},t.prototype.attrGet=function(e){var t=this.attrIndex(e),n=null;return t>=0&&(n=this.attrs[t][1]),n},t.prototype.attrJoin=function(e,t){var n=this.attrIndex(e);n<0?this.attrPush([e,t]):this.attrs[n][1]=this.attrs[n][1]+" "+t},e.exports=t},44975:e=>{"use strict";var t=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,n=/\((c|tm|r|p)\)/i,r=/\((c|tm|r|p)\)/gi,s={c:"©",r:"®",p:"§",tm:"™"};function i(e,t){return s[t.toLowerCase()]}function a(e){var t,n,s=0;for(t=e.length-1;t>=0;t--)"text"!==(n=e[t]).type||s||(n.content=n.content.replace(r,i)),"link_open"===n.type&&"auto"===n.info&&s--,"link_close"===n.type&&"auto"===n.info&&s++}function o(e){var n,r,s=0;for(n=e.length-1;n>=0;n--)"text"!==(r=e[n]).type||s||t.test(r.content)&&(r.content=r.content.replace(/\+-/g,"±").replace(/\.{2,}/g,"…").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/gm,"$1—").replace(/(^|\s)--(?=\s|$)/gm,"$1–").replace(/(^|[^-\s])--(?=[^-\s]|$)/gm,"$1–")),"link_open"===r.type&&"auto"===r.info&&s--,"link_close"===r.type&&"auto"===r.info&&s++}e.exports=function(e){var r;if(e.md.options.typographer)for(r=e.tokens.length-1;r>=0;r--)"inline"===e.tokens[r].type&&(n.test(e.tokens[r].content)&&a(e.tokens[r].children),t.test(e.tokens[r].content)&&o(e.tokens[r].children))}},46668:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="valid"+s,h="errs__"+s,p=e.util.copy(e),g="";p.level++;var m="valid"+p.level,f=a.every((function(t){return e.opts.strictKeywords?"object"==typeof t&&Object.keys(t).length>0||!1===t:e.util.schemaHasRules(t,e.RULES.all)}));if(f){var y=p.baseId;r+=" var "+h+" = errors; var "+d+" = false;  ";var v=e.compositeRule;e.compositeRule=p.compositeRule=!0;var b=a;if(b)for(var C,w=-1,S=b.length-1;w<S;)C=b[w+=1],p.schema=C,p.schemaPath=o+"["+w+"]",p.errSchemaPath=l+"/"+w,r+="  "+e.validate(p)+" ",p.baseId=y,r+=" "+d+" = "+d+" || "+m+"; if (!"+d+") { ",g+="}";e.compositeRule=p.compositeRule=v,r+=" "+g+" if (!"+d+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else c&&(r+=" if (true) { ");return r}},46825:e=>{"use strict";function t(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var n=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,i=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),a=["'"].concat(i),o=["%","/","?",";","#"].concat(a),l=["/","?","#"],c=/^[+a-z0-9A-Z_-]{0,63}$/,u=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},h={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};t.prototype.parse=function(e,t){var r,i,a,p,g,m=e;if(m=m.trim(),!t&&1===e.split("#").length){var f=s.exec(m);if(f)return this.pathname=f[1],f[2]&&(this.search=f[2]),this}var y=n.exec(m);if(y&&(a=(y=y[0]).toLowerCase(),this.protocol=y,m=m.substr(y.length)),(t||y||m.match(/^\/\/[^@\/]+@[^@\/]+/))&&(!(g="//"===m.substr(0,2))||y&&d[y]||(m=m.substr(2),this.slashes=!0)),!d[y]&&(g||y&&!h[y])){var v,b,C=-1;for(r=0;r<l.length;r++)-1!==(p=m.indexOf(l[r]))&&(-1===C||p<C)&&(C=p);for(-1!==(b=-1===C?m.lastIndexOf("@"):m.lastIndexOf("@",C))&&(v=m.slice(0,b),m=m.slice(b+1),this.auth=v),C=-1,r=0;r<o.length;r++)-1!==(p=m.indexOf(o[r]))&&(-1===C||p<C)&&(C=p);-1===C&&(C=m.length),":"===m[C-1]&&C--;var w=m.slice(0,C);m=m.slice(C),this.parseHost(w),this.hostname=this.hostname||"";var S="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!S){var E=this.hostname.split(/\./);for(r=0,i=E.length;r<i;r++){var x=E[r];if(x&&!x.match(c)){for(var I="",A=0,P=x.length;A<P;A++)x.charCodeAt(A)>127?I+="x":I+=x[A];if(!I.match(c)){var k=E.slice(0,r),T=E.slice(r+1),D=x.match(u);D&&(k.push(D[1]),T.unshift(D[2])),T.length&&(m=T.join(".")+m),this.hostname=k.join(".");break}}}}this.hostname.length>255&&(this.hostname=""),S&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}var M=m.indexOf("#");-1!==M&&(this.hash=m.substr(M),m=m.slice(0,M));var L=m.indexOf("?");return-1!==L&&(this.search=m.substr(L),m=m.slice(0,L)),m&&(this.pathname=m),h[a]&&this.hostname&&!this.pathname&&(this.pathname=""),this},t.prototype.parseHost=function(e){var t=r.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},e.exports=function(e,n){if(e&&e instanceof t)return e;var r=new t;return r.parse(e,n),r}},46903:(e,t,n)=>{"use strict";t.Any=n(95850),t.Cc=n(19247),t.Cf=n(6468),t.P=n(16277),t.Z=n(32399)},46919:(e,t,n)=>{"use strict";var r=n(58651),s=n(17366),i=n(95906),a=n(49242),o=n(86725),l=n(21400),c=n(73890),u=n(39601),d=n(32506),h=n(70408);e.exports=v,v.prototype.validate=function(e,t){var n;if("string"==typeof e){if(!(n=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var r=this._addSchema(e);n=r.validate||this._compile(r)}var s=n(t);!0!==n.$async&&(this.errors=n.errors);return s},v.prototype.compile=function(e,t){var n=this._addSchema(e,void 0,t);return n.validate||this._compile(n)},v.prototype.addSchema=function(e,t,n,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)this.addSchema(e[s],void 0,n,r);return this}var a=this._getId(e);if(void 0!==a&&"string"!=typeof a)throw new Error("schema id must be string");return x(this,t=i.normalizeId(t||a)),this._schemas[t]=this._addSchema(e,n,r,!0),this},v.prototype.addMetaSchema=function(e,t,n){return this.addSchema(e,t,n,!0),this},v.prototype.validateSchema=function(e,t){var n=e.$schema;if(void 0!==n&&"string"!=typeof n)throw new Error("$schema must be a string");if(!(n=n||this._opts.defaultMeta||function(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(m)?m:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var r=this.validate(n,e);if(!r&&t){var s="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(s);this.logger.error(s)}return r},v.prototype.getSchema=function(e){var t=b(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function(e,t){var n=i.schema.call(e,{schema:{}},t);if(n){var r=n.schema,a=n.root,l=n.baseId,c=s.call(e,r,a,void 0,l);return e._fragments[t]=new o({ref:t,fragment:!0,schema:r,root:a,baseId:l,validate:c}),c}}(this,e)}},v.prototype.removeSchema=function(e){if(e instanceof RegExp)return C(this,this._schemas,e),C(this,this._refs,e),this;switch(typeof e){case"undefined":return C(this,this._schemas),C(this,this._refs),this._cache.clear(),this;case"string":var t=b(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var n=this._opts.serialize,r=n?n(e):e;this._cache.del(r);var s=this._getId(e);s&&(s=i.normalizeId(s),delete this._schemas[s],delete this._refs[s])}return this},v.prototype.addFormat=function(e,t){"string"==typeof t&&(t=new RegExp(t));return this._formats[e]=t,this},v.prototype.errorsText=function(e,t){if(!(e=e||this.errors))return"No errors";for(var n=void 0===(t=t||{}).separator?", ":t.separator,r=void 0===t.dataVar?"data":t.dataVar,s="",i=0;i<e.length;i++){var a=e[i];a&&(s+=r+a.dataPath+" "+a.message+n)}return s.slice(0,-n.length)},v.prototype._addSchema=function(e,t,n,r){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var s=this._opts.serialize,a=s?s(e):e,l=this._cache.get(a);if(l)return l;r=r||!1!==this._opts.addUsedSchema;var c=i.normalizeId(this._getId(e));c&&r&&x(this,c);var u,d=!1!==this._opts.validateSchema&&!t;d&&!(u=c&&c==i.normalizeId(e.$schema))&&this.validateSchema(e,!0);var h=i.ids.call(this,e),p=new o({id:c,schema:e,localRefs:h,cacheKey:a,meta:n});"#"!=c[0]&&r&&(this._refs[c]=p);this._cache.put(a,p),d&&u&&this.validateSchema(e,!0);return p},v.prototype._compile=function(e,t){if(e.compiling)return e.validate=i,i.schema=e.schema,i.errors=null,i.root=t||i,!0===e.schema.$async&&(i.$async=!0),i;var n,r;e.compiling=!0,e.meta&&(n=this._opts,this._opts=this._metaOpts);try{r=s.call(this,e.schema,t,e.localRefs)}catch(t){throw delete e.validate,t}finally{e.compiling=!1,e.meta&&(this._opts=n)}return e.validate=r,e.refs=r.refs,e.refVal=r.refVal,e.root=r.root,r;function i(){var t=e.validate,n=t.apply(this,arguments);return i.errors=t.errors,n}},v.prototype.compileAsync=n(57306);var p=n(64671);v.prototype.addKeyword=p.add,v.prototype.getKeyword=p.get,v.prototype.removeKeyword=p.remove,v.prototype.validateKeyword=p.validate;var g=n(77043);v.ValidationError=g.Validation,v.MissingRefError=g.MissingRef,v.$dataMetaSchema=d;var m="http://json-schema.org/draft-07/schema",f=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],y=["/properties"];function v(e){if(!(this instanceof v))return new v(e);e=this._opts=h.copy(e)||{},function(e){var t=e._opts.logger;if(!1===t)e.logger={log:I,warn:I,error:I};else{if(void 0===t&&(t=r),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=c(e.format),this._cache=e.cache||new a,this._loadingSchemas={},this._compilations=[],this.RULES=u(),this._getId=function(e){switch(e.schemaId){case"auto":return E;case"id":return w;default:return S}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=l),this._metaOpts=function(e){for(var t=h.copy(e._opts),n=0;n<f.length;n++)delete t[f[n]];return t}(this),e.formats&&function(e){for(var t in e._opts.formats){var n=e._opts.formats[t];e.addFormat(t,n)}}(this),e.keywords&&function(e){for(var t in e._opts.keywords){var n=e._opts.keywords[t];e.addKeyword(t,n)}}(this),function(e){var t;e._opts.$data&&(t=n(91248),e.addMetaSchema(t,t.$id,!0));if(!1===e._opts.meta)return;var r=n(7618);e._opts.$data&&(r=d(r,y));e.addMetaSchema(r,m,!0),e._refs["http://json-schema.org/schema"]=m}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),e.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),function(e){var t=e._opts.schemas;if(!t)return;if(Array.isArray(t))e.addSchema(t);else for(var n in t)e.addSchema(t[n],n)}(this)}function b(e,t){return t=i.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function C(e,t,n){for(var r in t){var s=t[r];s.meta||n&&!n.test(r)||(e._cache.del(s.cacheKey),delete t[r])}}function w(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function S(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function E(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function x(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function I(){}},47018:function(e){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),s=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var s=e.getVersionPrecision(t),i=e.getVersionPrecision(n),a=Math.max(s,i),o=0,l=e.map([t,n],(function(t){var n=a-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(o=a-Math.min(s,i)),a-=1;a>=o;){if(l[0][a]>l[1][a])return 1;if(l[0][a]===l[1][a]){if(a===o)return 0;a-=1}else if(l[0][a]<l[1][a])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var s=e[n];if(t(s,n))return s}},e.assign=function(e){for(var t,n,r=e,s=arguments.length,i=new Array(s>1?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[e].concat(i));var o=function(){var e=i[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=i.length;t<n;t+=1)o();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=s,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,s=(r=n(91))&&r.__esModule?r:{default:r},i=n(18);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){}var t,n,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new s.default(e,t)},e.parse=function(e){return new s.default(e).getResult()},t=e,r=[{key:"BROWSER_MAP",get:function(){return i.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return i.ENGINE_MAP}},{key:"OS_MAP",get:function(){return i.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return i.PLATFORMS_MAP}}],(n=null)&&a(t.prototype,n),r&&a(t,r),e}();t.default=o,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=l(n(92)),s=l(n(93)),i=l(n(94)),a=l(n(95)),o=l(n(17));function l(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=o.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=o.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=o.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=o.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return o.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,s={},i=0;if(Object.keys(e).forEach((function(t){var a=e[t];"string"==typeof a?(s[t]=a,i+=1):"object"==typeof a&&(n[t]=a,r+=1)})),r>0){var a=Object.keys(n),l=o.default.find(a,(function(e){return t.isOS(e)}));if(l){var c=this.satisfies(n[l]);if(void 0!==c)return c}var u=o.default.find(a,(function(e){return t.isPlatform(e)}));if(u){var d=this.satisfies(n[u]);if(void 0!==d)return d}}if(i>0){var h=Object.keys(s),p=o.default.find(h,(function(e){return t.isBrowser(e,!0)}));if(void 0!==p)return this.compareVersion(s[p])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),s=o.default.getBrowserTypeByAlias(r);return t&&s&&(r=s.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,s=this.getBrowserVersion();if("string"==typeof s)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(o.default.compareVersions(s,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=c,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,s=(r=n(17))&&r.__esModule?r:{default:r},i=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=s.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=s.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=s.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=s.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=s.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=s.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=s.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=s.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=s.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=s.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=s.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=s.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=s.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=s.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=s.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=s.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=s.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=s.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=s.default.getFirstMatch(i,e)||s.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=s.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=s.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=s.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=s.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=s.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=s.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=s.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=s.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=s.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=s.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:s.default.getFirstMatch(t,e),version:s.default.getSecondMatch(t,e)}}}];t.default=a,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,s=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:[/Roku\/DVP/],describe:function(e){var t=s.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=s.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=s.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=s.default.getWindowsVersionName(t);return{name:i.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:i.OS_MAP.iOS},n=s.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=s.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=s.default.getMacOSVersionName(t),r={name:i.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=s.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=s.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=s.default.getAndroidVersionName(t),r={name:i.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=s.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:i.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=s.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||s.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||s.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=s.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=s.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:i.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:i.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=s.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.PlayStation4,version:t}}}];t.default=a,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,s=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=s.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:i.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=s.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:i.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}}];t.default=a,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,s=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),a=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:i.ENGINE_MAP.Blink};var t=s.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:i.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:i.ENGINE_MAP.Trident},n=s.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:i.ENGINE_MAP.Presto},n=s.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:i.ENGINE_MAP.Gecko},n=s.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:i.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:i.ENGINE_MAP.WebKit},n=s.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=a,e.exports=t.default}})},48954:(e,t,n)=>{"use strict";e.exports.encode=n(13802),e.exports.decode=n(13894),e.exports.format=n(74251),e.exports.parse=n(46825)},49242:e=>{"use strict";var t=e.exports=function(){this._cache={}};t.prototype.put=function(e,t){this._cache[e]=t},t.prototype.get=function(e){return this._cache[e]},t.prototype.del=function(e){delete this._cache[e]},t.prototype.clear=function(){this._cache={}}},49449:(e,t,n)=>{"use strict";var r=n(87423).isSpace;e.exports=function(e,t,n,s){var i,a,o,l,c=e.bMarks[t]+e.tShift[t],u=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(35!==(i=e.src.charCodeAt(c))||c>=u)return!1;for(a=1,i=e.src.charCodeAt(++c);35===i&&c<u&&a<=6;)a++,i=e.src.charCodeAt(++c);return!(a>6||c<u&&!r(i))&&(s||(u=e.skipSpacesBack(u,c),(o=e.skipCharsBack(u,35,c))>c&&r(e.src.charCodeAt(o-1))&&(u=o),e.line=t+1,(l=e.push("heading_open","h"+String(a),1)).markup="########".slice(0,a),l.map=[t,e.line],(l=e.push("inline","",0)).content=e.src.slice(c,u).trim(),l.map=[t,e.line],l.children=[],(l=e.push("heading_close","h"+String(a),-1)).markup="########".slice(0,a)),!0)}},49724:e=>{"use strict";e.exports=function(e,t,n){var r,s,i,a,o,l,c,u,d,h,p=t+1,g=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;for(h=e.parentType,e.parentType="paragraph";p<n&&!e.isEmpty(p);p++)if(!(e.sCount[p]-e.blkIndent>3)){if(e.sCount[p]>=e.blkIndent&&(l=e.bMarks[p]+e.tShift[p])<(c=e.eMarks[p])&&(45===(d=e.src.charCodeAt(l))||61===d)&&(l=e.skipChars(l,d),(l=e.skipSpaces(l))>=c)){u=61===d?1:2;break}if(!(e.sCount[p]<0)){for(s=!1,i=0,a=g.length;i<a;i++)if(g[i](e,p,n,!0)){s=!0;break}if(s)break}}return!!u&&(r=e.getLines(t,p,e.blkIndent,!1).trim(),e.line=p+1,(o=e.push("heading_open","h"+String(u),1)).markup=String.fromCharCode(d),o.map=[t,e.line],(o=e.push("inline","",0)).content=r,o.map=[t,e.line-1],o.children=[],(o=e.push("heading_close","h"+String(u),-1)).markup=String.fromCharCode(d),e.parentType=h,!0)}},49745:(e,t,n)=>{"use strict";var r=n(87423).isSpace;e.exports=function(e,t,n,s){var i,a,o,l,c,u,d,h,p,g,m,f,y,v,b,C,w,S,E,x,I=e.lineMax,A=e.bMarks[t]+e.tShift[t],P=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(62!==e.src.charCodeAt(A++))return!1;if(s)return!0;for(l=p=e.sCount[t]+1,32===e.src.charCodeAt(A)?(A++,l++,p++,i=!1,C=!0):9===e.src.charCodeAt(A)?(C=!0,(e.bsCount[t]+p)%4==3?(A++,l++,p++,i=!1):i=!0):C=!1,g=[e.bMarks[t]],e.bMarks[t]=A;A<P&&(a=e.src.charCodeAt(A),r(a));)9===a?p+=4-(p+e.bsCount[t]+(i?1:0))%4:p++,A++;for(m=[e.bsCount[t]],e.bsCount[t]=e.sCount[t]+1+(C?1:0),u=A>=P,v=[e.sCount[t]],e.sCount[t]=p-l,b=[e.tShift[t]],e.tShift[t]=A-e.bMarks[t],S=e.md.block.ruler.getRules("blockquote"),y=e.parentType,e.parentType="blockquote",h=t+1;h<n&&(x=e.sCount[h]<e.blkIndent,!((A=e.bMarks[h]+e.tShift[h])>=(P=e.eMarks[h])));h++)if(62!==e.src.charCodeAt(A++)||x){if(u)break;for(w=!1,o=0,c=S.length;o<c;o++)if(S[o](e,h,n,!0)){w=!0;break}if(w){e.lineMax=h,0!==e.blkIndent&&(g.push(e.bMarks[h]),m.push(e.bsCount[h]),b.push(e.tShift[h]),v.push(e.sCount[h]),e.sCount[h]-=e.blkIndent);break}g.push(e.bMarks[h]),m.push(e.bsCount[h]),b.push(e.tShift[h]),v.push(e.sCount[h]),e.sCount[h]=-1}else{for(l=p=e.sCount[h]+1,32===e.src.charCodeAt(A)?(A++,l++,p++,i=!1,C=!0):9===e.src.charCodeAt(A)?(C=!0,(e.bsCount[h]+p)%4==3?(A++,l++,p++,i=!1):i=!0):C=!1,g.push(e.bMarks[h]),e.bMarks[h]=A;A<P&&(a=e.src.charCodeAt(A),r(a));)9===a?p+=4-(p+e.bsCount[h]+(i?1:0))%4:p++,A++;u=A>=P,m.push(e.bsCount[h]),e.bsCount[h]=e.sCount[h]+1+(C?1:0),v.push(e.sCount[h]),e.sCount[h]=p-l,b.push(e.tShift[h]),e.tShift[h]=A-e.bMarks[h]}for(f=e.blkIndent,e.blkIndent=0,(E=e.push("blockquote_open","blockquote",1)).markup=">",E.map=d=[t,0],e.md.block.tokenize(e,t,h),(E=e.push("blockquote_close","blockquote",-1)).markup=">",e.lineMax=I,e.parentType=y,d[1]=e.line,o=0;o<b.length;o++)e.bMarks[o+t]=g[o],e.tShift[o+t]=b[o],e.sCount[o+t]=v[o],e.bsCount[o+t]=m[o];return e.blkIndent=f,!0}},50338:e=>{"use strict";e.exports=function(e,t,n){var r,s=" ",i=e.level,a=e.dataLevel,o=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&o&&o.$data;if(h?(s+=" var schema"+i+" = "+e.util.getData(o.$data,a,e.dataPathArr)+"; ",r="schema"+i):r=o,!h&&"number"!=typeof o)throw new Error(t+" must be number");s+="var division"+i+";if (",h&&(s+=" "+r+" !== undefined && ( typeof "+r+" != 'number' || "),s+=" (division"+i+" = "+d+" / "+r+", ",e.opts.multipleOfPrecision?s+=" Math.abs(Math.round(division"+i+") - division"+i+") > 1e-"+e.opts.multipleOfPrecision+" ":s+=" division"+i+" !== parseInt(division"+i+") ",s+=" ) ",h&&(s+="  )  "),s+=" ) {   ";var p=p||[];p.push(s),s="",!1!==e.createErrors?(s+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { multipleOf: "+r+" } ",!1!==e.opts.messages&&(s+=" , message: 'should be multiple of ",s+=h?"' + "+r:r+"'"),e.opts.verbose&&(s+=" , schema:  ",s+=h?"validate.schema"+l:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),s+=" } "):s+=" {} ";var g=s;return s=p.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+g+"]); ":s+=" validate.errors = ["+g+"]; return false; ":s+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",u&&(s+=" else { "),s}},50358:(e,t,n)=>{"use strict";var r=n(87423).arrayReplaceAt;function s(e){return/^<\/a\s*>/i.test(e)}e.exports=function(e){var t,n,i,a,o,l,c,u,d,h,p,g,m,f,y,v,b,C,w=e.tokens;if(e.md.options.linkify)for(n=0,i=w.length;n<i;n++)if("inline"===w[n].type&&e.md.linkify.pretest(w[n].content))for(m=0,t=(a=w[n].children).length-1;t>=0;t--)if("link_close"!==(l=a[t]).type){if("html_inline"===l.type&&(C=l.content,/^<a[>\s]/i.test(C)&&m>0&&m--,s(l.content)&&m++),!(m>0)&&"text"===l.type&&e.md.linkify.test(l.content)){for(d=l.content,b=e.md.linkify.match(d),c=[],g=l.level,p=0,u=0;u<b.length;u++)f=b[u].url,y=e.md.normalizeLink(f),e.md.validateLink(y)&&(v=b[u].text,v=b[u].schema?"mailto:"!==b[u].schema||/^mailto:/i.test(v)?e.md.normalizeLinkText(v):e.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):e.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,""),(h=b[u].index)>p&&((o=new e.Token("text","",0)).content=d.slice(p,h),o.level=g,c.push(o)),(o=new e.Token("link_open","a",1)).attrs=[["href",y]],o.level=g++,o.markup="linkify",o.info="auto",c.push(o),(o=new e.Token("text","",0)).content=v,o.level=g,c.push(o),(o=new e.Token("link_close","a",-1)).level=--g,o.markup="linkify",o.info="auto",c.push(o),p=b[u].lastIndex);p<d.length&&((o=new e.Token("text","",0)).content=d.slice(p),o.level=g,c.push(o)),w[n].children=a=r(a,t,c)}}else for(t--;a[t].level!==l.level&&"link_open"!==a[t].type;)t--}},52211:(e,t,n)=>{"use strict";e.exports=n(98614)},53197:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.schema[t],i=e.schemaPath+e.util.getProperty(t),a=e.errSchemaPath+"/"+t,o=!e.opts.allErrors,l=e.util.copy(e),c="";l.level++;var u="valid"+l.level,d=l.baseId,h=!0,p=s;if(p)for(var g,m=-1,f=p.length-1;m<f;)g=p[m+=1],(e.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0||!1===g:e.util.schemaHasRules(g,e.RULES.all))&&(h=!1,l.schema=g,l.schemaPath=i+"["+m+"]",l.errSchemaPath=a+"/"+m,r+="  "+e.validate(l)+" ",l.baseId=d,o&&(r+=" if ("+u+") { ",c+="}"));return o&&(r+=h?" if (true) { ":" "+c.slice(0,-1)+" "),r}},53638:(e,t,n)=>{"use strict";n.d(t,{t:()=>a});var r=n(8520),s=n(71491),i=n(58651);class a extends r.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){i.error("CopilotInlineCreationHVC:: ErrorBoundary caught an error",e,t)}render(){return this.state.hasError?r.createElement("h1",null,s.CX):this.props.children}}},53856:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="valid"+s,h="errs__"+s,p=e.util.copy(e);p.level++;var g="valid"+p.level,m=e.schema.then,f=e.schema.else,y=void 0!==m&&(e.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0||!1===m:e.util.schemaHasRules(m,e.RULES.all)),v=void 0!==f&&(e.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0||!1===f:e.util.schemaHasRules(f,e.RULES.all)),b=p.baseId;if(y||v){var C;p.createErrors=!1,p.schema=a,p.schemaPath=o,p.errSchemaPath=l,r+=" var "+h+" = errors; var "+d+" = true;  ";var w=e.compositeRule;e.compositeRule=p.compositeRule=!0,r+="  "+e.validate(p)+" ",p.baseId=b,p.createErrors=!0,r+="  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; }  ",e.compositeRule=p.compositeRule=w,y?(r+=" if ("+g+") {  ",p.schema=e.schema.then,p.schemaPath=e.schemaPath+".then",p.errSchemaPath=e.errSchemaPath+"/then",r+="  "+e.validate(p)+" ",p.baseId=b,r+=" "+d+" = "+g+"; ",y&&v?r+=" var "+(C="ifClause"+s)+" = 'then'; ":C="'then'",r+=" } ",v&&(r+=" else { ")):r+=" if (!"+g+") { ",v&&(p.schema=e.schema.else,p.schemaPath=e.schemaPath+".else",p.errSchemaPath=e.errSchemaPath+"/else",r+="  "+e.validate(p)+" ",p.baseId=b,r+=" "+d+" = "+g+"; ",y&&v?r+=" var "+(C="ifClause"+s)+" = 'else'; ":C="'else'",r+=" } "),r+=" if (!"+d+") {   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { failingKeyword: "+C+" } ",!1!==e.opts.messages&&(r+=" , message: 'should match \"' + "+C+" + '\" schema' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),r+=" }   ",c&&(r+=" else { ")}else c&&(r+=" if (true) { ");return r}},54353:e=>{"use strict";e.exports=function(e){var t;e.inlineMode?((t=new e.Token("inline","",0)).content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}},57306:(e,t,n)=>{"use strict";var r=n(77043).MissingRef;e.exports=function e(t,n,s){var i=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof n&&(s=n,n=void 0);var a=o(t).then((function(){var e=i._addSchema(t,void 0,n);return e.validate||l(e)}));s&&a.then((function(e){s(null,e)}),s);return a;function o(t){var n=t.$schema;return n&&!i.getSchema(n)?e.call(i,{$ref:n},!0):Promise.resolve()}function l(e){try{return i._compile(e)}catch(t){if(t instanceof r)return function(t){var r=t.missingSchema;if(c(r))throw new Error("Schema "+r+" is loaded but "+t.missingRef+" cannot be resolved");var s=i._loadingSchemas[r];s||(s=i._loadingSchemas[r]=i._opts.loadSchema(r)).then(a,a);return s.then((function(e){if(!c(r))return o(e).then((function(){c(r)||i.addSchema(e,r,void 0,n)}))})).then((function(){return l(e)}));function a(){delete i._loadingSchemas[r]}function c(e){return i._refs[e]||i._schemas[e]}}(t);throw t}}}},57770:e=>{"use strict";e.exports=function(e,t,n){var r,s,i=" ",a=e.level,o=e.dataLevel,l=e.schema[t],c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(o||""),h="valid"+a;if("#"==l||"#/"==l)e.isRoot?(r=e.async,s="validate"):(r=!0===e.root.schema.$async,s="root.refVal[0]");else{var p=e.resolveRef(e.baseId,l,e.isRoot);if(void 0===p){var g=e.MissingRefError.message(e.baseId,l);if("fail"==e.opts.missingRefs){e.logger.error(g),(v=v||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { ref: '"+e.util.escapeQuotes(l)+"' } ",!1!==e.opts.messages&&(i+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(l)+"' "),e.opts.verbose&&(i+=" , schema: "+e.util.toQuotedString(l)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),i+=" } "):i+=" {} ";var m=i;i=v.pop(),!e.compositeRule&&u?e.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(i+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,l,g);e.logger.warn(g),u&&(i+=" if (true) { ")}}else if(p.inline){var f=e.util.copy(e);f.level++;var y="valid"+f.level;f.schema=p.schema,f.schemaPath="",f.errSchemaPath=l,i+=" "+e.validate(f).replace(/validate\.schema/g,p.code)+" ",u&&(i+=" if ("+y+") { ")}else r=!0===p.$async||e.async&&!1!==p.$async,s=p.code}if(s){var v;(v=v||[]).push(i),i="",e.opts.passContext?i+=" "+s+".call(this, ":i+=" "+s+"( ",i+=" "+d+", (dataPath || '')",'""'!=e.errorPath&&(i+=" + "+e.errorPath);var b=i+=" , "+(o?"data"+(o-1||""):"parentData")+" , "+(o?e.dataPathArr[o]:"parentDataProperty")+", rootData)  ";if(i=v.pop(),r){if(!e.async)throw new Error("async schema referenced by sync schema");u&&(i+=" var "+h+"; "),i+=" try { await "+b+"; ",u&&(i+=" "+h+" = true; "),i+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",u&&(i+=" "+h+" = false; "),i+=" } ",u&&(i+=" if ("+h+") { ")}else i+=" if (!"+b+") { if (vErrors === null) vErrors = "+s+".errors; else vErrors = vErrors.concat("+s+".errors); errors = vErrors.length; } ",u&&(i+=" else { ")}return i}},57842:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="errs__"+s,h=e.util.copy(e),p="";h.level++;var g="valid"+h.level,m="key"+s,f="idx"+s,y=h.dataLevel=e.dataLevel+1,v="data"+y,b="dataProperties"+s,C=Object.keys(a||{}).filter(R),w=e.schema.patternProperties||{},S=Object.keys(w).filter(R),E=e.schema.additionalProperties,x=C.length||S.length,I=!1===E,A="object"==typeof E&&Object.keys(E).length,P=e.opts.removeAdditional,k=I||A||P,T=e.opts.ownProperties,D=e.baseId,M=e.schema.required;if(M&&(!e.opts.$data||!M.$data)&&M.length<e.opts.loopRequired)var L=e.util.toHash(M);function R(e){return"__proto__"!==e}if(r+="var "+d+" = errors;var "+g+" = true;",T&&(r+=" var "+b+" = undefined;"),k){if(r+=T?" "+b+" = "+b+" || Object.keys("+u+"); for (var "+f+"=0; "+f+"<"+b+".length; "+f+"++) { var "+m+" = "+b+"["+f+"]; ":" for (var "+m+" in "+u+") { ",x){if(r+=" var isAdditional"+s+" = !(false ",C.length)if(C.length>8)r+=" || validate.schema"+o+".hasOwnProperty("+m+") ";else{var N=C;if(N)for(var O=-1,_=N.length-1;O<_;)Y=N[O+=1],r+=" || "+m+" == "+e.util.toQuotedString(Y)+" "}if(S.length){var B=S;if(B)for(var F=-1,U=B.length-1;F<U;)ie=B[F+=1],r+=" || "+e.usePattern(ie)+".test("+m+") "}r+=" ); if (isAdditional"+s+") { "}if("all"==P)r+=" delete "+u+"["+m+"]; ";else{var H=e.errorPath,z="' + "+m+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers)),I)if(P)r+=" delete "+u+"["+m+"]; ";else{r+=" "+g+" = false; ";var j=l;l=e.errSchemaPath+"/additionalProperties",(ne=ne||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { additionalProperty: '"+z+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is an invalid additional property":r+="should NOT have additional properties",r+="' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var V=r;r=ne.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+V+"]); ":r+=" validate.errors = ["+V+"]; return false; ":r+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=j,c&&(r+=" break; ")}else if(A)if("failing"==P){r+=" var "+d+" = errors;  ";var q=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.schema=E,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var W=u+"["+m+"]";h.dataPathArr[y]=m;var Q=e.validate(h);h.baseId=D,e.util.varOccurences(Q,v)<2?r+=" "+e.util.varReplace(Q,v,W)+" ":r+=" var "+v+" = "+W+"; "+Q+" ",r+=" if (!"+g+") { errors = "+d+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+u+"["+m+"]; }  ",e.compositeRule=h.compositeRule=q}else{h.schema=E,h.schemaPath=e.schemaPath+".additionalProperties",h.errSchemaPath=e.errSchemaPath+"/additionalProperties",h.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);W=u+"["+m+"]";h.dataPathArr[y]=m;Q=e.validate(h);h.baseId=D,e.util.varOccurences(Q,v)<2?r+=" "+e.util.varReplace(Q,v,W)+" ":r+=" var "+v+" = "+W+"; "+Q+" ",c&&(r+=" if (!"+g+") break; ")}e.errorPath=H}x&&(r+=" } "),r+=" }  ",c&&(r+=" if ("+g+") { ",p+="}")}var G=e.opts.useDefaults&&!e.compositeRule;if(C.length){var Z=C;if(Z)for(var Y,K=-1,J=Z.length-1;K<J;){var X=a[Y=Z[K+=1]];if(e.opts.strictKeywords?"object"==typeof X&&Object.keys(X).length>0||!1===X:e.util.schemaHasRules(X,e.RULES.all)){var $=e.util.getProperty(Y),ee=(W=u+$,G&&void 0!==X.default);h.schema=X,h.schemaPath=o+$,h.errSchemaPath=l+"/"+e.util.escapeFragment(Y),h.errorPath=e.util.getPath(e.errorPath,Y,e.opts.jsonPointers),h.dataPathArr[y]=e.util.toQuotedString(Y);Q=e.validate(h);if(h.baseId=D,e.util.varOccurences(Q,v)<2){Q=e.util.varReplace(Q,v,W);var te=W}else{te=v;r+=" var "+v+" = "+W+"; "}if(ee)r+=" "+Q+" ";else{if(L&&L[Y]){r+=" if ( "+te+" === undefined ",T&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),r+=") { "+g+" = false; ";H=e.errorPath,j=l;var ne,re=e.util.escapeQuotes(Y);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(H,Y,e.opts.jsonPointers)),l=e.errSchemaPath+"/required",(ne=ne||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { missingProperty: '"+re+"' } ",!1!==e.opts.messages&&(r+=" , message: '",e.opts._errorDataPathProperty?r+="is a required property":r+="should have required property \\'"+re+"\\'",r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";V=r;r=ne.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+V+"]); ":r+=" validate.errors = ["+V+"]; return false; ":r+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l=j,e.errorPath=H,r+=" } else { "}else c?(r+=" if ( "+te+" === undefined ",T&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),r+=") { "+g+" = true; } else { "):(r+=" if ("+te+" !== undefined ",T&&(r+=" &&   Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(Y)+"') "),r+=" ) { ");r+=" "+Q+" } "}}c&&(r+=" if ("+g+") { ",p+="}")}}if(S.length){var se=S;if(se)for(var ie,ae=-1,oe=se.length-1;ae<oe;){X=w[ie=se[ae+=1]];if(e.opts.strictKeywords?"object"==typeof X&&Object.keys(X).length>0||!1===X:e.util.schemaHasRules(X,e.RULES.all)){h.schema=X,h.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(ie),h.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(ie),r+=T?" "+b+" = "+b+" || Object.keys("+u+"); for (var "+f+"=0; "+f+"<"+b+".length; "+f+"++) { var "+m+" = "+b+"["+f+"]; ":" for (var "+m+" in "+u+") { ",r+=" if ("+e.usePattern(ie)+".test("+m+")) { ",h.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);W=u+"["+m+"]";h.dataPathArr[y]=m;Q=e.validate(h);h.baseId=D,e.util.varOccurences(Q,v)<2?r+=" "+e.util.varReplace(Q,v,W)+" ":r+=" var "+v+" = "+W+"; "+Q+" ",c&&(r+=" if (!"+g+") break; "),r+=" } ",c&&(r+=" else "+g+" = true; "),r+=" }  ",c&&(r+=" if ("+g+") { ",p+="}")}}}return c&&(r+=" "+p+" if ("+d+" == errors) {"),r}},58545:e=>{"use strict";e.exports=function(e,t,n){var r,s=" ",i=e.level,a=e.dataLevel,o=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h="valid"+i,p=e.opts.$data&&o&&o.$data;if(p?(s+=" var schema"+i+" = "+e.util.getData(o.$data,a,e.dataPathArr)+"; ",r="schema"+i):r=o,(o||p)&&!1!==e.opts.uniqueItems){p&&(s+=" var "+h+"; if ("+r+" === false || "+r+" === undefined) "+h+" = true; else if (typeof "+r+" != 'boolean') "+h+" = false; else { "),s+=" var i = "+d+".length , "+h+" = true , j; if (i > 1) { ";var g=e.schema.items&&e.schema.items.type,m=Array.isArray(g);if(!g||"object"==g||"array"==g||m&&(g.indexOf("object")>=0||g.indexOf("array")>=0))s+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+d+"[i], "+d+"[j])) { "+h+" = false; break outer; } } } ";else{s+=" var itemIndices = {}, item; for (;i--;) { var item = "+d+"[i]; ";var f="checkDataType"+(m?"s":"");s+=" if ("+e.util[f](g,"item",e.opts.strictNumbers,!0)+") continue; ",m&&(s+=" if (typeof item == 'string') item = '\"' + item; "),s+=" if (typeof itemIndices[item] == 'number') { "+h+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}s+=" } ",p&&(s+="  }  "),s+=" if (!"+h+") {   ";var y=y||[];y.push(s),s="",!1!==e.createErrors?(s+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(s+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(s+=" , schema:  ",s+=p?"validate.schema"+l:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),s+=" } "):s+=" {} ";var v=s;s=y.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+v+"]); ":s+=" validate.errors = ["+v+"]; return false; ":s+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } ",u&&(s+=" else { ")}else u&&(s+=" if (true) { ");return s}},59583:e=>{"use strict";e.exports=function(e,t,n){var r,s=" ",i=e.level,a=e.dataLevel,o=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&o&&o.$data;h?(s+=" var schema"+i+" = "+e.util.getData(o.$data,a,e.dataPathArr)+"; ",r="schema"+i):r=o;var p="maximum"==t,g=p?"exclusiveMaximum":"exclusiveMinimum",m=e.schema[g],f=e.opts.$data&&m&&m.$data,y=p?"<":">",v=p?">":"<",b=void 0;if(!h&&"number"!=typeof o&&void 0!==o)throw new Error(t+" must be number");if(!f&&void 0!==m&&"number"!=typeof m&&"boolean"!=typeof m)throw new Error(g+" must be number or boolean");if(f){var C=e.util.getData(m.$data,a,e.dataPathArr),w="exclusive"+i,S="exclType"+i,E="exclIsNumber"+i,x="' + "+(P="op"+i)+" + '";s+=" var schemaExcl"+i+" = "+C+"; ",s+=" var "+w+"; var "+S+" = typeof "+(C="schemaExcl"+i)+"; if ("+S+" != 'boolean' && "+S+" != 'undefined' && "+S+" != 'number') { ";var I;b=g;(I=I||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(b||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(s+=" , message: '"+g+" should be boolean' "),e.opts.verbose&&(s+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),s+=" } "):s+=" {} ";var A=s;s=I.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+A+"]); ":s+=" validate.errors = ["+A+"]; return false; ":s+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } else if ( ",h&&(s+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),s+=" "+S+" == 'number' ? ( ("+w+" = "+r+" === undefined || "+C+" "+y+"= "+r+") ? "+d+" "+v+"= "+C+" : "+d+" "+v+" "+r+" ) : ( ("+w+" = "+C+" === true) ? "+d+" "+v+"= "+r+" : "+d+" "+v+" "+r+" ) || "+d+" !== "+d+") { var op"+i+" = "+w+" ? '"+y+"' : '"+y+"='; ",void 0===o&&(b=g,c=e.errSchemaPath+"/"+g,r=C,h=f)}else{x=y;if((E="number"==typeof m)&&h){var P="'"+x+"'";s+=" if ( ",h&&(s+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),s+=" ( "+r+" === undefined || "+m+" "+y+"= "+r+" ? "+d+" "+v+"= "+m+" : "+d+" "+v+" "+r+" ) || "+d+" !== "+d+") { "}else{E&&void 0===o?(w=!0,b=g,c=e.errSchemaPath+"/"+g,r=m,v+="="):(E&&(r=Math[p?"min":"max"](m,o)),m===(!E||r)?(w=!0,b=g,c=e.errSchemaPath+"/"+g,v+="="):(w=!1,x+="="));P="'"+x+"'";s+=" if ( ",h&&(s+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),s+=" "+d+" "+v+" "+r+" || "+d+" !== "+d+") { "}}b=b||t,(I=I||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(b||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { comparison: "+P+", limit: "+r+", exclusive: "+w+" } ",!1!==e.opts.messages&&(s+=" , message: 'should be "+x+" ",s+=h?"' + "+r:r+"'"),e.opts.verbose&&(s+=" , schema:  ",s+=h?"validate.schema"+l:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),s+=" } "):s+=" {} ";A=s;return s=I.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+A+"]); ":s+=" validate.errors = ["+A+"]; return false; ":s+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } ",u&&(s+=" else { "),s}},60044:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CopilotChatDisplay:()=>$Q,resetLocalVariableInCopilotChatDisplay:()=>eG});var r,s=n(92615),i=n(50269),a=n(88290),o=n(26739),l=n(40632);!function(e){e[e.InsertAtCursor=0]="InsertAtCursor",e[e.Replace=1]="Replace"}(r||(r={}));var c=n(2317),u=n(95686);const d=18e4;class h{constructor(e,t,n){this.telemetryService=e,this.tag=t,this.name=n,this.start=Date.now(),this.isLoggingDone=!1,this.scenario=c.oc.Default,this.timeoutId=setTimeout((()=>{this.log({type:c.FY.LogMetric,tag:this.tag,name:this.name,success:c.YE.Timeout,duration:d,diagnosticsData:`Ended with Timeout , Scenario: ${this.scenario}`}),this.isLoggingDone=!0}),d)}setScenario(e){this.scenario=e}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:c.FY.LogMetric,tag:this.tag,name:this.name,success:c.YE.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:c.FY.LogMetric,tag:this.tag,name:this.name,success:c.YE.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}class p{constructor(e,t){this.telemetryService=e,this.onConfirmationButtonClicked=t}handleOpenUrl(e){throw new Error("Action.OpenUrl is not allowed for Confirmation Card.")}handleActionExecute(e){throw new Error("Action Execute is not allowed for Confirmation Card.")}handleActionSubmit(e){var t,n;const r=new h(this.telemetryService,c.yx.CardService,c.xe.ActionSubmit);try{if(this.onConfirmationButtonClicked&&e.data){const n=e.data,s="message";if(!(s in n)||!n[s])return r.logMetricEndWithError({diagnosticsData:"Message is not present in request object for confirmation card Action.Submit call"},null===(t=e.cardData)||void 0===t?void 0:t.cardId),Promise.resolve({status:u.yl.Error});this.onConfirmationButtonClicked(n[s])}}catch(t){return r.logMetricEndWithError({diagnosticsData:"Error occurred in Confirmation Card Action.Submit call"},null===(n=e.cardData)||void 0===n?void 0:n.cardId),Promise.resolve({status:u.yl.Error})}return Promise.resolve({status:u.yl.Success})}getAppDefinition(e){throw new Error("getAppDefinition is not supported for Confirmation Card.")}}var g=n(49671),m=n(46443),f=n(26567),y=n(79490),v=n(37753),b=n(21220),C=n(91055),w=n(3218),S=n(83855),E=n(76037),x=n(90285),I=n(74864),A=n(89901);class P{constructor(e,t,n){this.channelService=e,this.appService=t,this.telemetryService=n}handleActionExecute(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,u,d,h,p,g,m,f,y,w,S,E,x,P,k,T,D,M,L,R;const N=new b.k(this.telemetryService,c.yx.CardService,c.xe.ActionExecute),O={},_={cardData:e.cardData,botId:e.botId,appId:e.appId,requestBody:{name:"adaptiveCard/action",type:"invoke",value:{action:{type:"Action.Execute",id:e.actionId,verb:e.actionVerb,data:e.actionData},trigger:null!==(t=e.trigger)&&void 0!==t?t:"manual"}}};e.authCode&&(_.requestBody.value.state=e.authCode),e.authToken&&(_.requestBody.value.authentication={token:e.authToken}),(e.conversationId||(null===(n=e.cardData)||void 0===n?void 0:n.conversationId))&&(_.requestBody.conversation={id:null!==(i=null!==(r=e.conversationId)&&void 0!==r?r:null===(s=e.cardData)||void 0===s?void 0:s.conversationId)&&void 0!==i?i:""});const B=yield null===(a=this.channelService)||void 0===a?void 0:a.botInvoke(_);let F;if((null==B?void 0:B.type)===v.t.Error||!(null==B?void 0:B.value)){const e=B.value;return new I.H0(e.errorCode,e.errorMessage)}const U=B.value;switch(null==U?void 0:U.statusCode){case A.kG.Ok:F=new I.G3(JSON.stringify(U.value),U.type),O[c.vP.ActionExecuteResponseType]=c.Ve.Result,N.logMetricEnd({props:O,diagnosticsData:`TypeOfCard: ${null===(o=null==e?void 0:e.cardData)||void 0===o?void 0:o.contentType}, cardId : ${null===(l=null==e?void 0:e.cardData)||void 0===l?void 0:l.cardId}, cardsize: ${null===(d=null===(u=null==e?void 0:e.cardData)||void 0===u?void 0:u.content)||void 0===d?void 0:d.length}, Appid: ${(0,C.n)(null===(h=null==e?void 0:e.cardData)||void 0===h?void 0:h.titleId,null===(p=null==e?void 0:e.cardData)||void 0===p?void 0:p.appId)}`},null===(g=e.cardData)||void 0===g?void 0:g.cardId);break;case A.kG.Unauthorized:if(B.value){F=new I.BF(JSON.stringify(U.value),U.type),O[c.vP.ActionExecuteResponseType]=c.Ve.AuthError,N.logMetricEnd({props:O,diagnosticsData:`TypeOfCard: ${null===(m=null==e?void 0:e.cardData)||void 0===m?void 0:m.contentType}, cardId : ${null===(f=null==e?void 0:e.cardData)||void 0===f?void 0:f.cardId}, cardsize: ${null===(w=null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.content)||void 0===w?void 0:w.length}, Appid: ${(0,C.n)(null===(S=null==e?void 0:e.cardData)||void 0===S?void 0:S.titleId,null===(E=null==e?void 0:e.cardData)||void 0===E?void 0:E.appId)}`},null===(x=e.cardData)||void 0===x?void 0:x.cardId);break}F=new I.H0(500,"response is empty"),O[c.vP.ActionExecuteResponseType]=c.Ve.Error,N.logMetricEndWithError({props:O,diagnosticsData:`Error: Action Execute failed. Bot response is empty or error, Appid: ${(0,C.n)(null===(P=null==e?void 0:e.cardData)||void 0===P?void 0:P.titleId,null===(k=null==e?void 0:e.cardData)||void 0===k?void 0:k.appId)}`},null===(T=e.cardData)||void 0===T?void 0:T.cardId);break;default:F=new I.H0(null!==(D=null==U?void 0:U.statusCode)&&void 0!==D?D:500,JSON.stringify(null==U?void 0:U.value)),O[c.vP.ActionExecuteResponseType]=c.Ve.Error,N.logMetricEndWithError({props:O,diagnosticsData:`Error: Action Execute failed. Bot response status code is not supported, Appid: ${(0,C.n)(null===(M=null==e?void 0:e.cardData)||void 0===M?void 0:M.titleId,null===(L=null==e?void 0:e.cardData)||void 0===L?void 0:L.appId)}`},null===(R=e.cardData)||void 0===R?void 0:R.cardId)}return F}))}getAppDefinition(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){return yield this.appService.getApp({id:e.id})}))}}class k extends P{constructor(e,t,n,r){super(t,n,r),this.hostService=e,this.channelService=t,this.appService=n,this.telemetryService=r}handleOpenUrl(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,d,h,p,g,m,f,y,v,w,S;const x=new b.k(this.telemetryService,c.yx.CardService,c.xe.OpenUrl),I={};try{let v,b={type:E.p.Unhandled,params:{url:new URL(e.url)}};switch(e.disableDeepLinkProcessing||(b=(0,E.G)(null==e?void 0:e.url)),b.type){case E.p.StageView:I[c.vP.ModalViewType]=c.lp.StageView,v={cardData:e.cardData,botId:null!==(t=e.botId)&&void 0!==t?t:"",appId:null!==(r=null===(n=e.cardData)||void 0===n?void 0:n.appId)&&void 0!==r?r:b.params.appId,stageInfo:b.params.stageInfo},e.conversationId&&(v.conversationId=e.conversationId),yield null===(s=this.hostService)||void 0===s?void 0:s.openStageView(v);break;case E.p.TaskModule:I[c.vP.ModalViewType]=c.lp.TaskModule,v={cardData:e.cardData,botId:null!==(i=e.botId)&&void 0!==i?i:"",appId:null!==(o=null===(a=e.cardData)||void 0===a?void 0:a.appId)&&void 0!==o?o:b.params.appId,taskInfo:b.params.taskInfo},e.conversationId&&(v.conversationId=e.conversationId),yield null===(l=this.hostService)||void 0===l?void 0:l.openTaskModule(v);break;default:v={cardData:e.cardData,url:e.url},e.conversationId&&(v.conversationId=e.conversationId),yield this.hostService.openUrl(v)}return x.logMetricEnd({props:I,diagnosticsData:`TypeOfCard: ${null===(d=null==e?void 0:e.cardData)||void 0===d?void 0:d.contentType}, cardId : ${null===(h=null==e?void 0:e.cardData)||void 0===h?void 0:h.cardId}, cardsize: ${null===(g=null===(p=null==e?void 0:e.cardData)||void 0===p?void 0:p.content)||void 0===g?void 0:g.length}, Appid: ${(0,C.n)(null===(m=null==e?void 0:e.cardData)||void 0===m?void 0:m.titleId,null===(f=null==e?void 0:e.cardData)||void 0===f?void 0:f.appId)}`},null===(y=e.cardData)||void 0===y?void 0:y.cardId),{status:u.yl.Success,linkType:b.type}}catch(t){return x.logMetricEndWithError({props:I,diagnosticsData:`Error: OpenUrl failed. ErrorMessage: ${(null==t?void 0:t.message)||t},  Appid: ${(0,C.n)(null===(v=null==e?void 0:e.cardData)||void 0===v?void 0:v.titleId,null===(w=null==e?void 0:e.cardData)||void 0===w?void 0:w.appId)}`},null===(S=e.cardData)||void 0===S?void 0:S.cardId),Promise.reject(t)}}))}handleActionSubmit(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,d,h,p,g,m,f,y,E,I,A,P,k,T,D,M,L,R,N,O,_,B,F,U,H,z,j,V,q,W;const Q=new b.k(this.telemetryService,c.yx.CardService,c.xe.ActionSubmit),G={};try{if(!e.data||!e.appId)return Q.logMetricEndWithError({props:G,diagnosticsData:`Error: ActionSubmit failed as data or appId is undefined, Appid: ${(0,C.n)(null===(t=null==e?void 0:e.cardData)||void 0===t?void 0:t.titleId,null===(n=null==e?void 0:e.cardData)||void 0===n?void 0:n.appId)}`},null===(r=e.cardData)||void 0===r?void 0:r.cardId),Promise.reject("Data or appId is undefined");if((0,S.Kl)(e.data)&&(null===(s=e.data)||void 0===s?void 0:s.msteams.value.tabInfo)){G[c.vP.ModalViewType]=c.lp.StageView;const t=Object.assign(Object.assign({},e.data.msteams.value.tabInfo),{triggeringActionTitle:e.triggeringActionTitle}),n={cardData:e.cardData,botId:e.botId,appId:e.appId,stageInfo:t,frameContext:w.E2.content};e.conversationId&&(n.conversationId=e.conversationId),yield this.hostService.openStageView(n)}else if((0,S.wY)(e.data)){G[c.vP.ActionType]=c.X2.ImBack;const t={type:"imBack",cardData:e.cardData,prompt:e.data.msteams.value};t.appId=null===(i=e.cardData)||void 0===i?void 0:i.appId,yield this.channelService.botMessage(t)}else if((0,S.Sr)(e.data)||(0,S.R1)(e)){let t;if(G[c.vP.ModalViewType]=c.lp.TaskModule,null===(l=null===(o=null===(a=e.data)||void 0===a?void 0:a.msteams)||void 0===o?void 0:o.value)||void 0===l?void 0:l.tabInfo){const n=Object.assign(Object.assign({},e.data.msteams.value.tabInfo),{triggeringActionTitle:e.triggeringActionTitle});t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:n,frameContext:w.E2.task},e.conversationId&&(t.conversationId=e.conversationId)}else if("task/fetch"===(null===(p=null===(h=null===(d=e.data)||void 0===d?void 0:d.msteams)||void 0===h?void 0:h.value)||void 0===p?void 0:p.type)||"task/fetch"===(null===(m=null===(g=e.data)||void 0===g?void 0:g.msteams)||void 0===m?void 0:m.type)||(0,S.R1)(e)){G[c.vP.IsTaskFetch]=1;const n=(0,S.Sr)(e.data)?"task/fetch":"task/submit",r=(0,x.U)(e.data),s={appId:e.appId,botId:e.botId,requestBody:{name:n,value:{data:r}}};e.conversationId&&s.requestBody&&(s.requestBody.conversation={id:e.conversationId});const i=yield this.channelService.botInvoke(s);if(i.type===v.t.Error||!i.value)return Q.logMetricEndWithError({props:G,diagnosticsData:`Error: Bot invoke failed. Bot response is empty or error, Appid: ${(0,C.n)(null===(f=null==e?void 0:e.cardData)||void 0===f?void 0:f.titleId,null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.appId)}`},null===(E=e.cardData)||void 0===E?void 0:E.cardId),Promise.reject("Bot invoke failed");if((null==i?void 0:i.type)===v.t.Result){const n=i.value;if(!(null===(I=n.task)||void 0===I?void 0:I.value))return Q.logMetricEndWithError({props:G,diagnosticsData:`Error: Task info is not present in bot response, Appid: ${(0,C.n)(null===(A=null==e?void 0:e.cardData)||void 0===A?void 0:A.titleId,null===(P=null==e?void 0:e.cardData)||void 0===P?void 0:P.appId)}`},null===(k=e.cardData)||void 0===k?void 0:k.cardId),Promise.reject("Task info is not present in bot response");const r=Object.assign(Object.assign({},null===(T=n.task)||void 0===T?void 0:T.value),{triggeringActionTitle:e.triggeringActionTitle});t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:r,frameContext:w.E2.task},e.conversationId&&(t.conversationId=e.conversationId)}}t&&(yield this.hostService.openTaskModule(t))}else{if(!(0,S.DO)(e.data))return Q.logMetricEndWithError({props:G,diagnosticsData:`Error: ActionSubmit failed as passed action submit type is not supported, Appid: ${(0,C.n)(null===(R=null==e?void 0:e.cardData)||void 0===R?void 0:R.titleId,null===(N=null==e?void 0:e.cardData)||void 0===N?void 0:N.appId)}`},null===(O=e.cardData)||void 0===O?void 0:O.cardId),{status:u.yl.Failure};{G[c.vP.ActionType]=c.X2.Invoke;const t=(0,x.U)(e.data),n={appId:e.appId,botId:e.botId,requestBody:{name:"invoke",value:t}};e.conversationId&&n.requestBody&&(n.requestBody.conversation={id:e.conversationId});const r=yield this.channelService.botInvoke(n);if(r.type===v.t.Error||!r.value)return Q.logMetricEndWithError({props:G,diagnosticsData:`Error: Bot invoke failed. Bot response is empty or error, Appid: ${(0,C.n)(null===(D=null==e?void 0:e.cardData)||void 0===D?void 0:D.titleId,null===(M=null==e?void 0:e.cardData)||void 0===M?void 0:M.appId)}`},null===(L=e.cardData)||void 0===L?void 0:L.cardId),Promise.reject("Bot invoke failed")}}Q.logMetricEnd({props:G,diagnosticsData:`TypeOfCard: ${null===(_=null==e?void 0:e.cardData)||void 0===_?void 0:_.contentType}, cardId : ${null===(B=null==e?void 0:e.cardData)||void 0===B?void 0:B.cardId}, cardsize: ${null===(U=null===(F=null==e?void 0:e.cardData)||void 0===F?void 0:F.content)||void 0===U?void 0:U.length}, Appid: ${(0,C.n)(null===(H=null==e?void 0:e.cardData)||void 0===H?void 0:H.titleId,null===(z=null==e?void 0:e.cardData)||void 0===z?void 0:z.appId)}`},null===(j=e.cardData)||void 0===j?void 0:j.cardId)}catch(t){return Q.logMetricEndWithError({props:G,diagnosticsData:`Error: ActionSubmit failed. ErrorMessage: ${(null==t?void 0:t.message)||t}, Appid: ${(0,C.n)(null===(V=null==e?void 0:e.cardData)||void 0===V?void 0:V.titleId,null===(q=null==e?void 0:e.cardData)||void 0===q?void 0:q.appId)}`},null===(W=e.cardData)||void 0===W?void 0:W.cardId),{status:u.yl.Error}}return{status:u.yl.Success}}))}}var T=n(97039),D=n(11559),M=n(12223),L=n(67329),R=n(63590),N=n(8520);const O="https://urlp.asm.skype.com/v1/url/content?url=",_=/.*\.teams\.microsoft\.com\/urlp\/v1\/url\/content\?url=.*/,B=/.*\.teams\.microsoft\.com\/v1\/objects\/.*\/views\/img_preview/,F=/^data:image\/[a-zA-Z+.-]+;base64,/;function U(e){return F.test(e)}var H=n(29218),z=n(18686),j=n(98909),V=n(34131),q=n(3138),W=n(71271),Q=n(43121);const G=(0,n(8329).s)("persona-image",(()=>Promise.all([n.e(9037),n.e(8533)]).then(n.bind(n,49210)).then((e=>({default:e.PersonaImage})))),"PersonaImage"),Z=({persona:e,size:t,disableFocus:n,tokenService:r,telemetryService:s,hostContext:i,userContext:a})=>{const o=(e=>{const t=e.userContext?.userPrincipalName??"",n=e.hostContext?.host.name??"",r=e.hostContext?.host.clientType??"",s=e.tokenService,i=N.useCallback((async n=>{if(!s)return null;const r=await s.getToken({resource:Q.PP});if(!r||!r.authToken)return null;const i=0===n.indexOf("https:")?n:`${(0,j.Tm)()?Q.YX:Q.e9}/${n}`,a=r?(0,W.z)(r.authToken,t,!1):void 0;return{uri:i,headers:{Authorization:`Bearer ${r}`,"X-Application":Q.m_,"X-ApplicationRing":e.userContext?.dataResidency??"prod","X-ApplicationScenario":Q.pi,...a}}}),[t,s]),a=N.useCallback((async t=>{if(!s)return null;const i=await s.getToken({resource:Q.OF});if(!i||!i.authToken)return null;const a={sessionId:e.hostContext?.sessionId??"",locale:e.hostContext?.locale??"en-us",version:"1.0",hostAppSource:n,hostAppPlatform:r,clientFeature:e.clientFeature,clientScenario:e.clientScenario},o=await(0,V.H)({authToken:i.authToken,appParams:a});return o&&o.lokiUrl?{uri:`${o.lokiUrl}${o.lokiUrl.endsWith("/")||!t||t.startsWith("/")?"":"/"}${t}`,headers:(0,q.B)(a,i.authToken)}:null}),[n,r,e.clientFeature,e.clientScenario,s,e.hostContext?.locale]);return N.useCallback((async e=>{if(0===e.indexOf("PeoplePredictionsB2")||e.startsWith(Q.e9)){const t=await i(e);if(t)return t}if(e.startsWith(Q.hR)||e.startsWith(Q.lp)){const t=await a(e);if(t)return t}return{uri:e}}),[i,a])})({clientFeature:H.$F,clientScenario:z.Bu,tokenService:r,telemetryService:s,hostContext:i,userContext:a});return N.createElement(G,{person:e,serverImage:o,size:t,disableMouseInteract:!0,disableFocus:n,telemetryService:s})},Y=["People"];var K,J;!function(e){e.PERSON="Person",e.OTHER="Other"}(K||(K={})),function(e){e.ORGANIZATION_USER="OrganizationUser",e.GUEST="Guest",e.ORGANIZATION_CONTACT="OrganizationContact"}(J||(J={}));const X=["Mailbox","Directory"],$=!0;function ee(e,t){return{Scenario:{Name:e.scenario},EntityRequests:Y.map((t=>{return n=t,r=e.queryString,s=e.size,Object.assign({EntityType:n,Query:{QueryString:r},Size:s},"People"===n&&{Filter:{And:[{Or:[{Term:{PeopleType:K.PERSON}},{Term:{PeopleType:K.OTHER}}]},{Or:[{Term:{PeopleSubtype:J.ORGANIZATION_USER}},{Term:{PeopleSubtype:J.GUEST}},{Term:{PeopleSubtype:J.ORGANIZATION_CONTACT}}]}]},Provenances:X,From:0,ServeNoEmailContacts:$,Size:s});var n,r,s})),TextDecorations:"Forward",TimeZone:"UTC",LogicalId:e.logicalId,Cvid:(null==t?void 0:t.conversationId)||(0,f.DA)()}}var te=n(72709);var ne=n(20911);class re extends Error{constructor(e,t,n,r){super(e),this.metadata=t,this.name="peopleSearchSuggestionsProviderError",this.statusCode=n,this.serviceErrorMessage=r,Object.setPrototypeOf(this,re.prototype)}}const se=e=>e instanceof Error?e.message:String("object"==typeof e&&null!==e&&"message"in e?e.message:e);const ie=async({suggestionParams:e,requestBody:t,clientRequestId:n,additionalProperties:r})=>{var s,i;const a=(new Date).getTime(),{anchorMailBox:o,clientSessionId:l,locale:u,logicalId:d,queryString:p,serviceUrl:g,telemetryService:m,tokenService:y,accountEnvironment:v}=e,b=new h(m,c.yx.GetPeopleSearchSuggestions,c.xe.SearchPeopleFrom3SSuggestionService);try{let e;const h=await(null==y?void 0:y.getToken({resource:"https://substrate.office.com/search"})),C=(null==h?void 0:h.authToken)||"",w=()=>(async(e,t)=>{var n,r;const s=null!==(n=null==t?void 0:t.serviceUrl)&&void 0!==n?n:"DoD"===(null==t?void 0:t.accountEnvironment)?"https://substrate-dod.office365.us/search/api/v1/suggestions":"https://substrate.office.com/search/api/v1/suggestions",i=await fetch(`${s}?domain=People`,{method:"POST",body:JSON.stringify(t.requestBody),headers:Object.assign({Authorization:`Bearer ${e}`,Accept:"application/json","Content-Type":"application/json","X-Client-Language":null!==(r=t.locale)&&void 0!==r?r:"en-US","X-Client-Localtime":(0,te.p)(new Date),"Client-Request-Id":(null==t?void 0:t.clientRequestId)||(0,f.DA)(),"Client-Session-Id":(null==t?void 0:t.clientSessionId)||(0,f.DA)()},(null==t?void 0:t.anchorMailBox)?{"X-AnchorMailbox":t.anchorMailBox}:{})});if(!i.ok&&i.status>=500)throw new re(`SERVER_ERROR_${i.status}`,{logicalId:t.clientRequestId,startTime:(new Date).getTime(),traceId:t.clientRequestId,statusCode:i.status});return i})(C,{requestBody:t,clientRequestId:n,clientSessionId:l,anchorMailBox:o,locale:u,serviceUrl:g,accountEnvironment:v}),S=(e=>async()=>{try{return await e()}catch(e){if(e instanceof re&&(void 0===e.statusCode||"number"==typeof e.statusCode&&e.statusCode>=500))throw e;throw e}})(w),E=((e,t,{clientRequestId:n,logicalId:r,conversationId:s})=>(0,ne.b)(e,((e,i)=>{const a={};a[c.vP.IsPeopleSearchRetry]=e<2?1:0,null==t||t.LogInfo({type:c.FY.LogInfo,tag:c.m2.PeoplePickerSearchService,name:c.ru.PeoplePickerSearchServiceRequestRetry,correlationVector:null!=n?n:"",conversationId:s,diagnosticsData:`Error message: ${se(i)}. Retries left: ${e} LogicalId: ${r}`,props:a})}),2,1e3))(S,m,{clientRequestId:n,clientSessionId:l,logicalId:d,conversationId:(null==r?void 0:r.conversationId)||""}),x=await E(),I=x.status;e=await(async(e,t)=>{const n=e.headers.get("content-type");if(!n||!n.includes("application/json"))throw new re("Received non-JSON response",t,e.status,"Received non-JSON response");try{return await e.json()}catch(n){throw new re("Unparseable JSON response",t,e.status,"Unparseable JSON response")}})(x,{logicalId:d,startTime:a,traceId:n});const A=(null===(s=null==e?void 0:e.Instrumentation)||void 0===s?void 0:s.TraceId)||n;if(!e)throw null==b||b.logMetricEndWithError({diagnosticsData:`No parse response received: ${I}, traceId : ${A}, logicalId: ${d}`}),new re("No parsed response received",{logicalId:d,startTime:a,traceId:A},I);const P={startTime:a,logicalId:d,sessionId:l,traceId:A,queryString:p};if(200===I&&(null==b||b.logMetricEnd({diagnosticsData:`Response received status: ${I}, traceId : ${A}, logicalId: ${d}`})),200!==I)throw null==b||b.logMetricEndWithError({diagnosticsData:` Suggestion call failed with status: ${I} traceId : ${A}, logicalId: ${d}`}),new re(`Suggestions call failed: ${A}`,P,I,null===(i=null==e?void 0:e.error)||void 0===i?void 0:i.message);return{metadata:P,searchResponse:e}}catch(e){const t=e instanceof Error?e.message:String(e),n=e instanceof re?e.metadata:{logicalId:d,startTime:a,traceId:""},r=e instanceof re?e.statusCode:void 0,s=e instanceof re?e.serviceErrorMessage:void 0;throw null==b||b.logMetricEndWithError({diagnosticsData:`Suggestion call failed with error ${t}, logicalId: ${d}, traceId: ${n.traceId}`}),new re(t,n,r,s)}};async function ae({suggestionParams:e,additionalProperties:t}){const n=(0,f.DA)(),r=ee(e,t);return await ie({suggestionParams:e,requestBody:r,clientRequestId:n,additionalProperties:t})}const oe="GlobalApp",le="UserApp",ce="TenantApp",ue="";function de(e,t){const n=function(e){return(null==e?void 0:e.startsWith("P_"))?oe:(null==e?void 0:e.startsWith("U_"))?le:(null==e?void 0:e.startsWith("T_"))?ce:ue}(e);switch(n){case oe:return t?function(e){const t=e.match(/(P_[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})/);return t?t[1]:""}(t):null;case le:return le;case ce:return ce;default:return ue}}var he=n(19728);var pe="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:n.g;function ge(){return pe.__satchelGlobalContext}function me(e,t){var n=ge().subscriptions;n[e]||(n[e]=[]),n[e].push(t)}function fe(e){var t=be(e),n=ge().subscriptions[t];if(n){for(var r=[],s=0,i=n;s<i.length;s++){var a=(0,i[s])(e);a&&r.push(a)}if(r.length)return 1==r.length?r[0]:Promise.all(r)}}function ye(e,t){return ve(e,t,!0)}function ve(e,t,n){var r=(ge().nextActionId++).toString(),s=function(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];var a=t?t.apply(null,s):{};if(a.type)throw new Error("Action creators should not include the type property.");return a.type=e,Ce(a,r),n&&function(e){var t=ge().currentMutator;if(t)throw new Error("Mutator ("+t+") may not dispatch action ("+e.type+")");var n=ge().dispatchWithMiddleware||fe;(0,he.transaction)(n.bind(null,e))}(a),a};return Ce(s,r),function(e,t){e.__SATCHELJS_ACTION_TYPE=t}(s,e),s}function be(e){return e.__SATCHELJS_ACTION_ID}function Ce(e,t){e.__SATCHELJS_ACTION_ID=t}function we(){return ge().rootStore}pe.__satchelGlobalContext?function(){if(3!=pe.__satchelGlobalContext.schemaVersion)throw new Error("Detected incompatible SatchelJS versions loaded.")}():pe.__satchelGlobalContext={schemaVersion:3,rootStore:he.observable.map({}),nextActionId:0,subscriptions:{},dispatchWithMiddleware:null,currentMutator:null,legacyInDispatch:0,legacyDispatchWithMiddleware:null,legacyTestMode:!1};var Se=(0,he.action)("createStore",(function(e,t){if(we().get(e))throw new Error("A store named "+e+" has already been created.");we().set(e,t)}));function Ee(e,t){return Se(e,t),function(){return we().get(e)}}function xe(e,t){var n=be(e);if(!n)throw new Error("Mutators can only subscribe to action creators.");var r=function(e){return e.__SATCHELJS_ACTION_TYPE||"unknown action"}(e),s=(0,he.action)(r,(function(e){var n=ge();try{n.currentMutator=r,t(e),n.currentMutator=null}catch(e){throw n.currentMutator=null,e}}));return me(n,s),t}function Ie(e,t){var n=be(e);if(!n)throw new Error("Orchestrators can only subscribe to action creators.");return me(n,t),t}var Ae,Pe,ke=(Ae=xe,function(e,t){var n=ye(e,(function(){return{args:arguments}}));return Ae(n,(function(e){return t.apply(null,e.args)})),n});Pe=!0,(0,he.configure)({enforceActions:Pe?"observed":"never"});const Te=()=>{const e="MsgExtCardStoreActionPolicy";if(we().get(e))return we().get(e);return Ee(e,{cardsMap:new he.ObservableMap})()},De=ke("updateActionabilityStatus",((e,t)=>{var n,r,s;const i=null===(r=null===(n=Te())||void 0===n?void 0:n.cardsMap)||void 0===r?void 0:r.get(e);i?i.actionabilityStatus=t:null===(s=Te().cardsMap)||void 0===s||s.set(e,{actionabilityStatus:t})})),Me=ye("initializeMsgExtCardState",((e,t,n,r,s)=>({cardDetails:e,renderingMode:t,appService:n,channelService:r,actionabilityStatus:s}))),Le=()=>{const e="MsgExtCardStoreVnext";if(we().get(e))return we().get(e);return Ee(e,{cardsMap:new he.ObservableMap})()},Re=(xe(Me,(e=>{const t={cardDetails:e.cardDetails,renderingMode:e.renderingMode};Le().cardsMap.set(e.cardDetails.cardId,t)})),ye("updateMsgExtAppInfo",((e,t,n)=>({cardId:e,appInfo:t,channelService:n})))),Ne=(xe(Re,(e=>{const t=Le().cardsMap.get(e.cardId);t&&(t.appInfo=e.appInfo)})),ke("updateMsgExtCardDetails",((e,t)=>{const n=Le().cardsMap.get(e);n&&(n.cardDetails=t)})));var Oe=n(70661);Ie(Me,(e=>(0,y.__awaiter)(void 0,void 0,void 0,(function*(){let t;try{const n=e.cardDetails;if(n&&n.appId){const r=yield e.appService.getApp({id:n.appId});r&&(r.titleInfo?t=(0,Oe.P)(r.titleInfo):r.appDefinition&&(t=r.appDefinition))}}catch(e){}Re(e.cardDetails.cardId,t,e.channelService)}))));var _e=n(27167);const Be=ke("updateDisabledActionabilityReason",((e,t)=>{var n,r;const s=null===(r=null===(n=Te())||void 0===n?void 0:n.cardsMap)||void 0===r?void 0:r.get(e);s&&(s.reason=t)}));var Fe,Ue;!function(e){e[e.error=0]="error",e[e.info=1]="info",e[e.warning=2]="warning"}(Fe||(Fe={})),function(e){e[e.AppNotInstalled=0]="AppNotInstalled",e[e.AppNotAvailable=1]="AppNotAvailable",e[e.ComposeScenario=2]="ComposeScenario"}(Ue||(Ue={}));Ie(Re,(e=>{var t,n,r,s,i,a,o;let l;const c=function(e){var t,n;return null===(n=null===(t=null==Le?void 0:Le().cardsMap)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.renderingMode}(e.cardId),u=function(e){var t;const n=null===(t=Le().cardsMap.get(e))||void 0===t?void 0:t.appInfo;if(n&&n.state)switch(n.state){case"InstalledAndDeprecated":case"Featured":case"InstalledAndHidden":case"NotInstalled":case"PreConsented":return _e.iV.NotInstalled;case"Installed":case"AdminPreInstalled":case"InstalledAndPermanent":return _e.iV.Installed;case"RequireConsent":return _e.iV.NeedsConsentForUpgrade;default:return _e.iV.NotAvailable}return _e.iV.NotAvailable}(e.cardId);let d=_e.nc.None;u===_e.iV.Installed?d=_e.nc.Full:("compose"===c&&(d=_e.nc.Limited,l={type:Ue.ComposeScenario,messageType:Fe.info}),u===_e.iV.NotInstalled?l={type:Ue.AppNotInstalled,messageType:Fe.error}:u===_e.iV.NotAvailable&&(l={type:Ue.AppNotAvailable,messageType:Fe.error}));const h=null!==(s=null===(r=null===(n=null===(t=e.appInfo)||void 0===t?void 0:t.bots)||void 0===n?void 0:n[0])||void 0===r?void 0:r.id)&&void 0!==s?s:null===(o=null===(a=null===(i=e.appInfo)||void 0===i?void 0:i.inputExtensions)||void 0===a?void 0:a[0])||void 0===o?void 0:o.botId;if(h){const t=function(e){var t,n;return null===(n=null===(t=null==Le?void 0:Le().cardsMap)||void 0===t?void 0:t.get(e))||void 0===n?void 0:n.cardDetails}(e.cardId);t&&(t.botId=h,Ne(e.cardId,t))}De(e.cardId,d),Be(e.cardId,l)}));function He(e){var t,n,r;return null===(r=null===(n=null===(t=Te())||void 0===t?void 0:t.cardsMap)||void 0===n?void 0:n.get(e))||void 0===r?void 0:r.actionabilityStatus}function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function je(e,t){var n,r,s,i,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(s=a.trys,(s=s.length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){a.label=i[1];break}if(6===i[0]&&a.label<s[1]){a.label=s[1],s=i;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(i);break}s[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}}var Ve=function(){function e(t,n,r,s,i,a,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.telemetryService=t,this.userContext=n,this.appInfo=r,this.tokenService=s,this.sourceHostName=i,this.enableAMSProxy=a,this.hostCommunication=o,this.hostContext={locale:this.appInfo.locale,theme:this.appInfo.theme,version:this.appInfo.host.version,clientType:this.appInfo.host.clientType,name:this.appInfo.host.name,sourceHostName:this.sourceHostName}}var t,n,r;return t=e,n=[{key:"handleImageInsert",value:function(e){var t;null===(t=this.hostCommunication)||void 0===t||t.submitHostCommands([{name:"OnInsertImageAction",args:e}])}},{key:"copyCard",value:function(e){var t,n,r,s,i,a,o,l,u,d,p,g,m=new h(this.telemetryService,c.yx.APIPluginHostService,c.xe.CopyCard),f=void 0,y=e.cardDetails;if(y){var v=JSON.parse(y.content);if(v){var b=null===(t=v.metadata)||void 0===t?void 0:t.webUrl;b?((0,R.eM)(b,document),m.logMetricEnd({diagnosticsData:"TypeOfCard: ".concat(null===(n=null==e?void 0:e.cardDetails)||void 0===n?void 0:n.contentType,", cardId : ").concat(null===(r=null==e?void 0:e.cardDetails)||void 0===r?void 0:r.cardId," cardsize: ").concat(null===(i=null===(s=null==e?void 0:e.cardDetails)||void 0===s?void 0:s.content)||void 0===i?void 0:i.length,", Appid: ").concat(de(null===(a=null==e?void 0:e.cardDetails)||void 0===a?void 0:a.titleId,null===(o=null==e?void 0:e.cardDetails)||void 0===o?void 0:o.appId),", actionabilityStatus: ").concat(He(null===(l=null==e?void 0:e.cardDetails)||void 0===l?void 0:l.cardId))},null===(u=e.cardDetails)||void 0===u?void 0:u.cardId)):f="webUrl not found"}else f="content not found"}else f="cardDetails not found";f&&m.logMetricEndWithError({diagnosticsData:"Error: OpenUrl failed. ErrorMessage: ".concat(f,", Appid: ").concat(de(null===(d=null==e?void 0:e.cardDetails)||void 0===d?void 0:d.titleId,null===(p=null==e?void 0:e.cardDetails)||void 0===p?void 0:p.appId))},null===(g=e.cardDetails)||void 0===g?void 0:g.cardId)}},{key:"openUrl",value:function(e){throw new Error("Method not implemented.")}},{key:"handleAuth",value:function(e){throw new Error("Method not implemented.")}},{key:"handleJITInstall",value:function(e){throw new Error("Method not implemented.")}},{key:"openTaskModule",value:function(e){throw new Error("Method not implemented.")}},{key:"openStageView",value:function(e){throw new Error("Method not implemented.")}},{key:"openLaunchPage",value:function(e){throw new Error("Method not implemented.")}},{key:"launchActionDialog",value:function(e){throw new Error("launchActionDialog Method not implemented.")}},{key:"logTelemetry",value:function(e){throw new Error("Method not implemented.")}},{key:"getHostContext",value:function(){return Promise.resolve(this.hostContext)}},{key:"getImage",value:function(e){return U(e.url)?Promise.resolve({url:e.url,isCachedImage:!1}):function(e,t,n,r,s,i){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var a;const o=new h(i,c.yx.GetImage,c.xe.GetImageProxyUrl),l=yield caches.open("m365-image-cache"),u=e,d=yield l.match(u);if(d){const e=URL.createObjectURL(yield d.blob());return o.logMetricEnd({diagnosticsData:"isCachedImage: true"}),Promise.resolve({url:e,isCachedImage:!0})}if(void 0===r)throw o.logMetricEndWithError({diagnosticsData:'GetImage request failed with error: "User principal name is not defined"'}),new Error("User principal name is not defined");try{const t=new URL(e);if("http:"!==t.protocol&&"https:"!==t.protocol)throw o.logMetricEndWithError({diagnosticsData:'GetImage request failed with error: "URL must use http or https"'}),new Error("URL must use http or https")}catch(e){throw o.logMetricEndWithError({diagnosticsData:`GetImage request failed with error: "URL is not valid": ${e}`}),e}let p,g;if(s)p=e.includes(O)||e.match(_)||e.match(B)?e:`${O}${encodeURIComponent(e)}`,g=e.match(B)?yield n.getToken({resource:"https://ic3.teams.office.com"}):yield n.getToken({resource:"https://urlp-v2.asm.skype.com"});else{const s="Orange"===t||"Office"===t?"https://outlook.office.com/actionsb2netcore":"/actionsb2netcore";p=r?`${s}/${r}/th?u=${encodeURIComponent(e)}`:`${s}/th?u=${encodeURIComponent(e)}`,g=yield n.getToken({resource:"https://outlook.office365.com/connectors"})}const m=null==g?void 0:g.authToken;if(!m)throw o.logMetricEndWithError({diagnosticsData:"GetImage request failed with error: Unable to fetch token for image proxy"}),new Error("Unable to fetch token for image proxy");const f=new Headers;f.set("Authorization",`Bearer ${m}`),f.set("X-RoutingParameter-SessionKey",r),f.set("X-AnchorMailbox",r);const y={method:"GET",headers:f};try{const e=yield fetch(p,y);if(e.ok&&0===(null===(a=e.headers.get("Content-Type"))||void 0===a?void 0:a.indexOf("image"))){yield l.put(u,e.clone());const t=URL.createObjectURL(yield e.blob());return o.logMetricEnd({diagnosticsData:`isCachedImage: false, isAMSProxyEnabled: ${s}`}),Promise.resolve({url:t,isCachedImage:!1})}return o.logMetricEndWithError({diagnosticsData:`FetchImage request failed with status: ${e.status} or content type: ${e.headers.get("Content-Type")}`}),Promise.reject({status:e.status,statusText:e.statusText,message:`FetchImage request failed with status: ${e.status} or content type: ${e.headers.get("Content-Type")}`})}catch(e){throw o.logMetricEndWithError({diagnosticsData:`GetImage request failed with error: ${e}`}),new Error("Failed to get image via proxy. Error: "+String(e))}}))}(e.url,this.appInfo.host.name,this.tokenService,this.userContext.userPrincipalName,this.enableAMSProxy,this.telemetryService)}},{key:"getPersonaImageComponent",value:function(){return{personaRenderer:Z,hostContext:this.appInfo,userContext:this.userContext}}},{key:"getPeopleSearchQueryResponse",value:function(e){return(0,y.__awaiter)(this,void 0,void 0,(function(){var t,n,r,s,i,a,o,l;return je(this,(function(c){switch(c.label){case 0:n={queryString:e.searchQuery,scenario:e.scenario,logicalId:e.logicalId,tokenService:this.tokenService,telemetryService:null==e?void 0:e.telemetryService,locale:null==e?void 0:e.locale,size:null==e?void 0:e.peopleEntityResponseSize,clientSessionId:null==e?void 0:e.clientSessionId},r={suggestionParams:n,additionalProperties:{}},s=[],c.label=1;case 1:return c.trys.push([1,3,,4]),[4,ae(r)];case 2:return(i=c.sent())&&(a=i.searchResponse,null===(t=a.Groups)||void 0===t||t.forEach((function(e){var t;null===(t=e.Suggestions)||void 0===t||t.forEach((function(e){var t,n,r,i,a={id:e.Id,displayName:null!==(t=null==e?void 0:e.DisplayName)&&void 0!==t?t:"",userPrincipalName:(null==e?void 0:e.QueryText)||"",jobTitle:null!==(n=null==e?void 0:e.JobTitle)&&void 0!==n?n:"",alias:null!==(r=null==e?void 0:e.Alias)&&void 0!==r?r:(i=null==e?void 0:e.ImAddress,i&&i&&-1!==i.indexOf("@")&&-1!==i.indexOf(":")?i.split(new RegExp("[:@]"))[1]:"")};s.push(a)}))}))),[3,4];case 3:return o=c.sent(),u=o,(null!=(d=re)&&"undefined"!=typeof Symbol&&d[Symbol.hasInstance]?d[Symbol.hasInstance](u):u instanceof d)?(l=o,[2,{query:e.searchQuery,validPeople:s,error:l.message}]):[2,{query:e.searchQuery,validPeople:s,error:"Failed to fetch people search suggestions"}];case 4:return[2,{query:e.searchQuery,validPeople:s}]}var u,d}))}))}}],n&&ze(t.prototype,n),r&&ze(t,r),e}();class qe{LogInfo(e){}LogError(e){}LogException(e){}LogWarning(e){}LogVerbose(e){}LogMetric(e){}}const We={};class Qe extends Ve{constructor(e,t,n,r,s,i=!1,a){super(null!=s?s:new qe,e,t,n),this.defaultHostService=r,this.enableInMemoryCacheForACImages=i,this.hostWindowObject=a}openUrl(e){return new Promise(((t,n)=>{var r;try{const n=null!==(r=this.hostWindowObject)&&void 0!==r?r:window;if(!n.open(e.url,"_blank"))throw new Error("Failed to open window");t({status:"Success"})}catch(e){n(e)}}))}openTaskModule(e){return this.callDefaultHostService((t=>t.openTaskModule(e)))}openStageView(e){return this.callDefaultHostService((t=>{var n;const r=(null===(n=e.cardData)||void 0===n?void 0:n.appId)?Object.assign(Object.assign({},e),{appId:e.cardData.appId}):e;return t.openStageView(r)}))}openLaunchPage(e){return this.callDefaultHostService((t=>t.openLaunchPage(e)))}launchActionDialog(e){return this.callDefaultHostService((t=>t.launchActionDialog(e)))}logTelemetry(e){this.callDefaultHostService((t=>(t.logTelemetry(e),Promise.resolve())))}getHostContext(){return this.defaultHostService?this.callDefaultHostService((e=>e.getHostContext())):Promise.resolve(this.hostContext)}getImage(e){const t=Object.create(null,{getImage:{get:()=>super.getImage}});return(0,y.__awaiter)(this,void 0,void 0,(function*(){if(this.isBase64ImageUrl(e.url))return{url:e.url,isCachedImage:!1};if(this.enableInMemoryCacheForACImages){if(We[e.url])return{url:We[e.url],isCachedImage:!0};const n=yield t.getImage.call(this,e);return n.url&&(We[e.url]=n.url),n}return t.getImage.call(this,e)}))}callDefaultHostService(e){return this.defaultHostService?e(this.defaultHostService):Promise.reject("Default Host Service is not available")}isBase64ImageUrl(e){return/^data:image\/(jpeg|jpg|png|gif|bmp);base64,/.test(e)}}var Ge=n(17352),Ze=n(8256);class Ye extends Ge.Au{constructor(e){super(),this.hostService=e}parseElement(e,t,n,r){var s;const i=super.parseElement(e,t,n,r);i instanceof Ze._&&i.url&&(null===(s=this.hostService)||void 0===s||s.getImage({url:i.url}))}}var Ke=n(76535),Je=n(76533);class Xe{constructor(e,t,n,r,s,i){this.hostService=e,this.channelService=t,this.hubSdk=n,this.telemetryService=r,this.handleAPIPluginCardImageInsert=s,this.enableOpenUrlDialogAction=i,this.cardActionCapability=null,this.hubSdk&&i&&(this.cardActionCapability=this.hubSdk.getCapability("ExternalAppCardActionsForDA"))}handleOpenUrl(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,d,h,p,g,m,f;const y=new b.k(this.telemetryService,c.yx.APIPluginCardService,c.xe.OpenUrl),v={};try{let g,m={type:E.p.Unhandled,params:{url:new URL(e.url)}};switch(e.disableDeepLinkProcessing||(m=(0,E.G)(null==e?void 0:e.url)),m.type){case E.p.StageView:v[c.vP.ModalViewType]=c.lp.StageView,g={cardData:e.cardData,botId:null!==(t=e.botId)&&void 0!==t?t:"",appId:m.params.appId,stageInfo:m.params.stageInfo},yield null===(n=this.hostService)||void 0===n?void 0:n.openStageView(g);break;case E.p.TaskModule:v[c.vP.ModalViewType]=c.lp.TaskModule,g={cardData:e.cardData,botId:null!==(r=e.botId)&&void 0!==r?r:"",appId:m.params.appId,taskInfo:m.params.taskInfo},yield null===(s=this.hostService)||void 0===s?void 0:s.openTaskModule(g);break;default:g={cardData:e.cardData,url:e.url},yield this.hostService.openUrl(g)}return y.logMetricEnd({props:v,diagnosticsData:`TypeOfCard: ${null===(i=null==e?void 0:e.cardData)||void 0===i?void 0:i.contentType}, cardId : ${null===(a=null==e?void 0:e.cardData)||void 0===a?void 0:a.cardId}, cardsize: ${null===(l=null===(o=null==e?void 0:e.cardData)||void 0===o?void 0:o.content)||void 0===l?void 0:l.length}, Appid: ${(0,C.n)(null===(d=null==e?void 0:e.cardData)||void 0===d?void 0:d.titleId,null===(h=null==e?void 0:e.cardData)||void 0===h?void 0:h.appId)}`},null===(p=e.cardData)||void 0===p?void 0:p.cardId),{status:u.yl.Success,linkType:m.type}}catch(t){return y.logMetricEndWithError({props:v,diagnosticsData:`Error: OpenUrl failed. ErrorMessage: ${(null==t?void 0:t.message)||t},  Appid: ${(0,C.n)(null===(g=null==e?void 0:e.cardData)||void 0===g?void 0:g.titleId,null===(m=null==e?void 0:e.cardData)||void 0===m?void 0:m.appId)}`},null===(f=e.cardData)||void 0===f?void 0:f.cardId),Promise.reject(t)}}))}handleActionExecute(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){throw new Error("Action Execute is not allowed for API Plugin Card.")}))}handleActionSubmit(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,d,h,p,g,m,f,y,v,w,E,x,I,A,P;const k=new b.k(this.telemetryService,c.yx.APIPluginCardService,c.xe.ActionSubmit),T={};try{if(!e.data||!e.appId)return k.logMetricEndWithError({props:T,diagnosticsData:`Error: ActionSubmit failed as data or appId is undefined, Appid: ${(0,C.n)(null===(t=null==e?void 0:e.cardData)||void 0===t?void 0:t.titleId,null===(n=null==e?void 0:e.cardData)||void 0===n?void 0:n.appId)}`},null===(r=e.cardData)||void 0===r?void 0:r.cardId),Promise.reject("Data or appId is undefined");if((0,S.Kl)(e.data)&&(null===(s=e.data)||void 0===s?void 0:s.msteams.value.tabInfo)){T[c.vP.ModalViewType]=c.lp.StageView;const t=Object.assign(Object.assign({},e.data.msteams.value.tabInfo),{triggeringActionTitle:e.triggeringActionTitle}),n={cardData:e.cardData,botId:e.botId,appId:e.appId,stageInfo:t};yield this.hostService.openStageView(n)}else if((0,S.wY)(e.data)){T[c.vP.ActionType]=c.X2.ImBack;const t={type:"imBack",cardData:e.cardData,prompt:e.data.msteams.value,appId:null===(i=e.cardData)||void 0===i?void 0:i.appId,appType:"GPT"};yield null===(a=this.channelService)||void 0===a?void 0:a.botMessage(t)}else{if(!(0,S.Sr)(e.data)&&!(0,S.R1)(e))return k.logMetricEndWithError({props:T,diagnosticsData:`Error: ActionSubmit failed as passed action submit type is not supported, Appid: ${(0,C.n)(null===(h=null==e?void 0:e.cardData)||void 0===h?void 0:h.titleId,null===(p=null==e?void 0:e.cardData)||void 0===p?void 0:p.appId)}`},null===(g=e.cardData)||void 0===g?void 0:g.cardId),{status:u.yl.Failure};{let t;if(T[c.vP.ModalViewType]=c.lp.TaskModule,null===(d=null===(l=null===(o=e.data)||void 0===o?void 0:o.msteams)||void 0===l?void 0:l.value)||void 0===d?void 0:d.tabInfo){const n=Object.assign(Object.assign({},e.data.msteams.value.tabInfo),{triggeringActionTitle:e.triggeringActionTitle});t={cardData:e.cardData,botId:e.botId,appId:e.appId,taskInfo:n}}t&&(yield this.hostService.openTaskModule(t))}}k.logMetricEnd({props:T,diagnosticsData:`TypeOfCard: ${null===(m=null==e?void 0:e.cardData)||void 0===m?void 0:m.contentType}, cardId : ${null===(f=null==e?void 0:e.cardData)||void 0===f?void 0:f.cardId}, cardsize: ${null===(v=null===(y=null==e?void 0:e.cardData)||void 0===y?void 0:y.content)||void 0===v?void 0:v.length}, Appid: ${(0,C.n)(null===(w=null==e?void 0:e.cardData)||void 0===w?void 0:w.titleId,null===(E=null==e?void 0:e.cardData)||void 0===E?void 0:E.appId)}`},null===(x=e.cardData)||void 0===x?void 0:x.cardId)}catch(t){return k.logMetricEndWithError({props:T,diagnosticsData:`Error: ActionSubmit failed. ErrorMessage: ${(null==t?void 0:t.message)||t}, Appid: ${(0,C.n)(null===(I=null==e?void 0:e.cardData)||void 0===I?void 0:I.titleId,null===(A=null==e?void 0:e.cardData)||void 0===A?void 0:A.appId)}`},null===(P=e.cardData)||void 0===P?void 0:P.cardId),{status:u.yl.Error}}return{status:u.yl.Success}}))}getAppDefinition(e){throw new Error("getAppDefinition is not supported for API Plugin Card.")}handleActionInsertImage(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,d,h,p;const g=new b.k(this.telemetryService,c.yx.APIPluginCardService,c.xe.ActionInsertImage),m={};try{if(this.handleAPIPluginCardImageInsert&&e.url){const c=yield null===(t=this.hostService)||void 0===t?void 0:t.getImage({url:e.url});return this.handleAPIPluginCardImageInsert({triggeringActionTitle:e.triggeringActionTitle,cardData:e.cardData,url:c.url,altText:e.altText,insertPosition:e.insertPosition,isCachedImage:c.isCachedImage}),g.logMetricEnd({props:m,diagnosticsData:`TypeOfCard: ${null===(n=null==e?void 0:e.cardData)||void 0===n?void 0:n.contentType}, cardId : ${null===(r=null==e?void 0:e.cardData)||void 0===r?void 0:r.cardId}, cardsize: ${null===(i=null===(s=null==e?void 0:e.cardData)||void 0===s?void 0:s.content)||void 0===i?void 0:i.length}, Appid: ${(0,C.n)(null===(a=null==e?void 0:e.cardData)||void 0===a?void 0:a.titleId,null===(o=null==e?void 0:e.cardData)||void 0===o?void 0:o.appId)}`},null===(l=e.cardData)||void 0===l?void 0:l.cardId),{status:u.yl.Success}}}catch(t){return g.logMetricEndWithError({props:m,diagnosticsData:`Error: ActionCanvasInteraction failed. ErrorMessage: ${(null==t?void 0:t.message)||t}, Appid: ${(0,C.n)(null===(d=null==e?void 0:e.cardData)||void 0===d?void 0:d.titleId,null===(h=null==e?void 0:e.cardData)||void 0===h?void 0:h.appId)}`},null===(p=e.cardData)||void 0===p?void 0:p.cardId),{status:u.yl.Error}}return{status:u.yl.Success}}))}handleActionOpenUrlDialog(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,d,h,p,g;const m=new b.k(this.telemetryService,c.yx.NativeAPIPluginCardService,c.xe.ActionOpenUrlDialog),y={};y[c.vP.ActionType]=c.X2.OpenUrlDialog,y[c.vP.ModalViewType]=c.lp.UrlBasedDialog;const v=(0,f.DA)();try{if(!e.appId)return m.logMetricEndWithError({props:y,diagnosticsData:`Error: ActionOpenUrlDialog failed as appId is undefined, Appid: ${(0,C.n)(null===(t=null==e?void 0:e.cardData)||void 0===t?void 0:t.titleId,null===(n=null==e?void 0:e.cardData)||void 0===n?void 0:n.appId)}`},v),Promise.reject("AppId is undefined");if(!(null===(r=this.cardActionCapability)||void 0===r?void 0:r.actionOpenUrlDialog))throw new Error("actionOpenUrlDialog is undefined");{const t={url:new URL(e.url),title:e.dialogTitle,size:(w=e.dialogHeight,S=e.dialogWidth,{height:w,width:S}),card:{id:(null===(s=e.cardData)||void 0===s?void 0:s.cardId)||""},action:{title:e.triggeringActionTitle||""}};yield this.cardActionCapability.actionOpenUrlDialog(new Ke.l(e.appId),t,new Je.k(v))}m.logMetricEnd({props:y,diagnosticsData:`TypeOfCard: ${null===(i=null==e?void 0:e.cardData)||void 0===i?void 0:i.contentType}, cardId : ${null===(a=null==e?void 0:e.cardData)||void 0===a?void 0:a.cardId}, cardsize: ${null===(l=null===(o=null==e?void 0:e.cardData)||void 0===o?void 0:o.content)||void 0===l?void 0:l.length}, Appid: ${(0,C.n)(null===(d=null==e?void 0:e.cardData)||void 0===d?void 0:d.titleId,null===(h=null==e?void 0:e.cardData)||void 0===h?void 0:h.appId)}`},v)}catch(t){return m.logMetricEndWithError({props:y,diagnosticsData:`Error: ActionOpenUrlDialog failed. ErrorMessage: ${(null==t?void 0:t.message)||t}, Appid: ${(0,C.n)(null===(p=null==e?void 0:e.cardData)||void 0===p?void 0:p.titleId,null===(g=null==e?void 0:e.cardData)||void 0===g?void 0:g.appId)}`},v),{status:u.yl.Error}}var w,S;return{status:u.yl.Success}}))}}var $e=n(58651);class et{constructor(e){this.cardProps=e}isValidMessageForAPIPluginCard(e){return!!(0!==(e||[]).length&&this.cardProps.appService&&this.cardProps.tokenService&&this.cardProps.channelService)&&e.some((e=>!!e.adaptiveCardJson))}getCardReferences(e){var t,n,r,s,i,a,o,l,c,u,d,h,p,g,m;const f=this.getAPIPluginCardService();if(!this.isValidMessageForAPIPluginCard(e))return[];const y=new T.a({isInsertImageEnabledForDAs:null!==(n=null===(t=this.cardProps.featureFlags)||void 0===t?void 0:t.isInsertImageEnabledForDAs)&&void 0!==n&&n,enableCustomWidthPropOnAC:null!==(s=null===(r=this.cardProps.featureFlags)||void 0===r?void 0:r.enableCustomWidthPropOnAC)&&void 0!==s&&s,avoidAdaptiveCardRerender:null!==(a=null===(i=this.cardProps.featureFlags)||void 0===i?void 0:i.avoidAdaptiveCardRerender)&&void 0!==a&&a,disableACHorizontalScroll:null!==(l=null===(o=this.cardProps.featureFlags)||void 0===o?void 0:o.disableACHorizontalScroll)&&void 0!==l&&l,enableAdaptiveCardEnhancements:null!==(u=null===(c=this.cardProps.featureFlags)||void 0===c?void 0:c.enableAdaptiveCardEnhancements)&&void 0!==u&&u,enableAdaptiveCardCharts:null!==(h=null===(d=this.cardProps.featureFlags)||void 0===d?void 0:d.enableAdaptiveCardCharts)&&void 0!==h&&h,enableOpenUrlDialogAction:null!==(g=null===(p=this.cardProps.featureFlags)||void 0===p?void 0:p.enableOpenUrlDialogAction)&&void 0!==g&&g},null,null===(m=this.cardProps.clientInfo)||void 0===m?void 0:m.locale,"",this.cardProps.copilotThemeInfo.isHighContrast?"contrast":this.cardProps.copilotThemeInfo.isDarkTheme?"dark":"light");return e.map(((e,t)=>({index:t+1,card:this.parseAPIPluginCardContent(e),serviceProvider:f,content:e.adaptiveCardJson,config:y})))}parseAPIPluginCardContent(e){var t,n,r,s,i,a;let o;if(e.referenceMetadata){const l=JSON.parse(e.referenceMetadata);if(l&&l.dataSource&&(e.adaptiveCardJson||""===e.adaptiveCardJson)){const c=JSON.parse(l.dataSource);if((null===(t=c.data)||void 0===t?void 0:t.PluginType)&&this.checkAPIPluginCard(c.data.PluginType))try{const t=JSON.parse(e.adaptiveCardJson);if(1===t.length){const l=t[0],u={content:{title:e.providerDisplayName,subtitle:e.providerDisplayDescription}},d=null!==(r=null!==(n=null==e?void 0:e.cardId)&&void 0!==n?n:null==e?void 0:e.id)&&void 0!==r?r:(0,f.DA)(),h=(null===(s=c.data)||void 0===s?void 0:s.MetaOSAppId)||"";o={content:l,preview:u,appId:h,cardId:d,titleId:(null===(i=null==c?void 0:c.data)||void 0===i?void 0:i.MetaOSTitleId)||"",contentUrl:null,name:null},(null===(a=this.cardProps.featureFlags)||void 0===a?void 0:a.prefetchACImages)&&this.prefetchImages(l)}}catch(e){o={content:{},preview:{},appId:"",cardId:"",contentUrl:null,name:null,titleId:null}}}}return o}prefetchImages(e){try{(0,g.n_x)();const t=new m.hq,n=this.getAPIPluginCardService(),r=new Ye(n.hostService);t.parse(e,r)}catch(e){$e.error("Error while prefetching images for adaptive card",e)}}checkAPIPluginCard(e){return e===D.QE.DataVerse||e===D.QE.OpenAIPlugin||e===D.QE.PowerPlatform}getAPIPluginCardService(){var e,t,n,r;const s=this.cardProps.tokenService,i=this.cardProps.appService,a=this.cardProps.channelService,o=this.cardProps.clientInfo;let l=null===(e=this.cardProps)||void 0===e?void 0:e.telemetryService;const c={host:{clientType:o.clientType,name:o.hubName,sessionId:o.sessionId,version:L.V0},locale:o.locale,sessionId:o.sessionId,theme:this.cardProps.copilotThemeInfo.isHighContrast?w.BD.highContrast:this.cardProps.copilotThemeInfo.isDarkTheme?w.BD.dark:w.BD.default},u={dataResidency:M.jI.Public,id:o.aadUserId,displayName:o.userName,userPrincipalName:o.userPrincipalName};l||(l=new qe);const d=new Qe(u,c,s,this.cardProps.defaultHostService,l,null===(t=this.cardProps.featureFlags)||void 0===t?void 0:t.enableInMemoryCacheForACImages,o.hostWindowObject);return{hostService:d,tokenService:s,appService:i,cardService:(null===(n=this.cardProps.featureFlags)||void 0===n?void 0:n.isInsertImageEnabledForDAs)?new Xe(d,a,this.cardProps.hubSdk,l,this.cardProps.handleAPIPluginCardImageInsert,null===(r=this.cardProps.featureFlags)||void 0===r?void 0:r.enableOpenUrlDialogAction):new k(d,a,i),telemetryService:l,channelService:a}}}var tt=n(49302);class nt{LogInfo(e){}LogError(e){}LogException(e){}LogWarning(e){}LogVerbose(e){}LogMetric(e){}}class rt{constructor(e){this.cardProps=e}getDisplayExternalUrlWarning(){var e;const t=null!==(e=this.cardProps.clientInfo.hostWindowObject)&&void 0!==e?e:window;return e=>new Promise(((n,r)=>{e?t.setTimeout((()=>n()),2e3):r("CardId is missing")}))}isValidMessageForMsgExtCard(e){return!!(0!==(e||[]).length&&this.cardProps.appService&&this.cardProps.tokenService&&this.cardProps.channelService)&&e.some((e=>!!e.cardJson))}getCardReferences(e){var t,n,r,s,i,a,o,l;const c=this.getMsgExtCardService();if(!this.isValidMessageForMsgExtCard(e))return[];const u=new T.a({shouldACUseInlinePopup:!0,enableCustomWidthPropOnAC:!0,enableAdaptiveCardEnhancements:null!==(r=null===(n=null===(t=this.cardProps)||void 0===t?void 0:t.featureFlags)||void 0===n?void 0:n.enableAdaptiveCardEnhancements)&&void 0!==r&&r,enableAdaptiveCardCharts:null!==(a=null===(i=null===(s=this.cardProps)||void 0===s?void 0:s.featureFlags)||void 0===i?void 0:i.enableAdaptiveCardCharts)&&void 0!==a&&a},void 0,null!==(l=null===(o=this.cardProps.clientInfo)||void 0===o?void 0:o.locale)&&void 0!==l?l:"","",this.cardProps.copilotThemeInfo.isHighContrast?"contrast":this.cardProps.copilotThemeInfo.isDarkTheme?"dark":"light");return e.map(((e,t)=>{var n;return{index:t+1,card:e.cardJson?JSON.parse(e.cardJson):void 0,context:c,content:null!==(n=e.cardJson)&&void 0!==n?n:"",config:u}}))}getCardServiceProps(){return this.cardProps}getMsgExtCardService(){var e,t,n,r,s;const i=this.cardProps.tokenService,a=this.cardProps.appService,o=this.cardProps.channelService,l=this.cardProps.clientInfo;let c=null===(e=this.cardProps)||void 0===e?void 0:e.telemetryService;const u=this.cardProps.taskModuleLauncher,d=null!==(n=null===(t=this.cardProps)||void 0===t?void 0:t.taskModuleDialogTitle)&&void 0!==n?n:"",h=null!==(r=l.hostWindowObject)&&void 0!==r?r:window,p={host:{clientType:l.clientType,name:l.hubName,sessionId:l.sessionId,version:L.V0},locale:l.locale,sessionId:l.sessionId,theme:this.cardProps.copilotThemeInfo.isHighContrast?w.BD.highContrast:this.cardProps.copilotThemeInfo.isDarkTheme?w.BD.dark:w.BD.default},g={dataResidency:M.jI.Public,id:l.aadUserId,displayName:l.userName,userPrincipalName:l.userPrincipalName};c||(c=new nt);const m=h.document.createElement("div"),f=new tt.Q(u,l,(()=>m),g,p,a,i,(()=>{throw new Error("Not implemented")}),o,d,void 0,this.getDisplayExternalUrlWarning(),null===(s=this.cardProps)||void 0===s?void 0:s.featureFlags);return{hostService:f,tokenService:i,appService:a,cardService:new k(f,o,a,c),telemetryService:c,channelService:o}}}class st{constructor(e){this.props=e,this._defaultHostService=null}get appService(){return this.props.appService}get tokenService(){return this.props.tokenService}get channelService(){return this.props.channelService}get clientInfo(){return this.props.clientInfo}get cardTelemetryService(){return this.props.cardTelemetryService}get authTelemetryService(){return this.props.authTelemetryService}get activityProvider(){return this.props.activityProvider}get copilotThemeInfo(){return this.props.copilotThemeInfo}get msgExtCardServiceProvider(){var e;return null!==(e=this._msgExtCardServiceProvider)&&void 0!==e||(this._msgExtCardServiceProvider=new rt({appService:this.appService,tokenService:this.tokenService,channelService:this.channelService,clientInfo:this.clientInfo,telemetryService:this.cardTelemetryService,taskModuleDialogTitle:this.props.taskModuleDialogTitle,taskModuleLauncher:this.props.taskModuleLauncher,featureFlags:this.props.featureFlags,copilotThemeInfo:this.props.copilotThemeInfo})),this._msgExtCardServiceProvider}get defaultHostService(){if(!this._defaultHostService)try{this._defaultHostService=this.msgExtCardServiceProvider.getMsgExtCardService().hostService}catch(e){}return this._defaultHostService}get apiPluginCardServiceProvider(){var e;return null!==(e=this._apiPluginCardServiceProvider)&&void 0!==e||(this._apiPluginCardServiceProvider=new et({appService:this.appService,tokenService:this.tokenService,channelService:this.channelService,clientInfo:this.clientInfo,telemetryService:this.cardTelemetryService,defaultHostService:this.defaultHostService,handleAPIPluginCardImageInsert:this.props.handleAPIPluginCardImageInsert,featureFlags:this.props.featureFlags,copilotThemeInfo:this.props.copilotThemeInfo,hubSdk:this.props.hubSdk})),this._apiPluginCardServiceProvider}get confirmationCardService(){var e;return null!==(e=this._confirmationCardService)&&void 0!==e||(this._confirmationCardService=this.createConfirmationCardService(this.props.onConfirmationCardButtonClicked)),this._confirmationCardService}createConfirmationCardService(e){return new p(this.cardTelemetryService,e)}}var it=n(3495),at=n(11942),ot=n(34148),lt=n(80337),ct=n(10282),ut=n(19269),dt=n(16115),ht=n(12800),pt=n(9513),gt=n(79563),mt=n(60623),ft=n(19328);const yt={freCard:{...gt.Pt.borderRadius("12px"),maxWidth:"288px"},freHeaderText:{fontFamily:"-apple-system",lineHeight:"normal"},freDescriptionText:{marginTop:"12px",fontFamily:"-apple-system",lineHeight:"normal"},freButton:{...gt.Pt.padding("16px"),...gt.Pt.borderRadius("12px"),minHeight:"52px",height:"auto",fontFamily:"-apple-system",fontWeight:"600",fontSize:"17px",justifyContent:"center"}},vt=(0,mt.n)({root:(bt=yt).root??{},freCard:bt.freCard??{},freImage:bt.freImage??{},freHeaderText:bt.freHeaderText??{},freDescriptionText:bt.freDescriptionText??{},freButton:bt.freButton??{}});var bt;const Ct=(0,pt.Q)(ft.tR),wt={freCard:{},root:{...gt.Pt.padding("12px","16px"),alignItems:"center",textAlign:"center",color:Ct.neutralPrimary,backgroundColor:Ct.neutralLight,boxShadow:Ct.shadow4,...gt.Pt.margin("1px","16px","none"),...gt.Pt.border("1px","solid",Ct.neutralLight),...gt.Pt.borderRadius("8px")},freImage:{height:"64px",width:"64px"},freHeaderText:{marginTop:"8px"},freDescriptionText:{textAlign:"center",whiteSpace:"pre-wrap",...gt.Pt.padding("1px"),...gt.Pt.margin("20px","0px","0px")},freButton:{color:Ct.neutralLight,width:"100%",...gt.Pt.padding("5px","12px"),...gt.Pt.margin("20px","0px","0px"),...gt.Pt.borderRadius("4px"),"@media (forced-colors: none)":{backgroundColor:Ct.themePrimary,...gt.Pt.border("none"),":hover":{color:Ct.neutralLight,backgroundColor:Ct.themePrimary,...gt.Pt.border("none")},":active":{color:Ct.neutralLight,backgroundColor:Ct.themePrimary,...gt.Pt.border("none")}}}},St=(0,mt.n)(wt),Et={freSharedButtonText:ut.DKo,freSharedDescriptionID:ut.JmL,freSharedHeader:ut.zTz,freSharedHeaderID:ut.eG8},xt=({headerText:e,descriptionText:t,freImagePath:n,handleFreButtonClick:r=()=>{},shouldFocusOnComponentMount:a=!1,hideGetStartedButton:o=!1,getStartedButtonText:l,overrideStyles:c})=>{const u=(()=>{const e=St(),t=vt();(0,i.xp)()===s.Y.IOS&&(0,dt.bt)(e,t);return e})(),d=(e=>{const t=(0,it.kQ)(Et);return N.useMemo((()=>({...t,headerText:()=>e.headerText??t.freSharedHeader(),buttonText:()=>e.getStartedButtonText??t.freSharedButtonText()})),[t,e.headerText,e.getStartedButtonText])})({headerText:e,getStartedButtonText:l});(0,dt.bt)(u,c);const h=" "+d.headerText()+" ",p=" "+t+" ";return(0,N.useEffect)((()=>{a&&document.getElementById("FreSharedId")?.focus()})),N.createElement(ht.W,{style:u.root,customProperties:{role:dt.eg.GROUP,"aria-labelledby":d.freSharedHeaderID()}},N.createElement(at._,{src:n,className:u.freImage,role:"presentation"}),N.createElement(ot.M,{id:d.freSharedHeaderID(),className:u.freHeaderText},h),N.createElement(lt.c,{id:d.freSharedDescriptionID(),className:u.freDescriptionText},p),o?null:N.createElement(ct.$,{className:u.freButton,onClick:r},d.buttonText()))};var It;!function(e){e.LOADING="LOADING",e.LOADING_TIMEDOUT="LOADING_TIMEDOUT",e.LOADING_NOT_APPLICABLE="LOADING_NOT_APPLICABLE",e.IC_CONTAINER_LOADED="INTERACTIVE_CARD_CONTAINER_LOADED",e.AUTO_OPENED_PANE_LOADING_TIMEOUT="AUTO_OPENED_PANE_LOADING_TIMEOUT"}(It||(It={}));var At=n(9937),Pt=n(29404),kt=n(61355);const Tt={welcomeScreenContainer:{gap:Pt.L.spacingVerticalXXS,...gt.Pt.padding(Pt.L.spacingVerticalNone,Pt.L.spacingVerticalM,Pt.L.spacingVerticalM,Pt.L.spacingVerticalNone)},agentIconContainer:{height:"48px"},agentScreenContainer:{gap:Pt.L.spacingVerticalM,...gt.Pt.padding(Pt.L.spacingVerticalNone,Pt.L.spacingVerticalM,Pt.L.spacingVerticalM,Pt.L.spacingVerticalNone),display:"flex",flexDirection:"row",alignItems:"center"},agentBrandingLogo:{height:"48px",width:"48px"},loadingBarContainer:{marginTop:Pt.L.spacingVerticalM},loadingBar:{backgroundImage:`linear-gradient(90.5deg, var(--fai-chatLoadColorBrandFlair1) 10%,  var(--fai-chatLoadColorBrandFlair2) 32%,  var(--fai-chatLoadColorBrandFlair3) 55%, var(--fai-chatLoadColorBrandFlair4) 72%, ${Pt.L.colorNeutralBackground6} 100%)`,backgroundColor:Pt.L.colorNeutralBackground6,height:"100%","@media screen and (prefers-reduced-motion: reduce)":{maxWidth:"100%",width:"100%",animationIterationCount:"infinite",animationDuration:"3s",animationName:{"0%":{opacity:".2"},"50%":{opacity:"1"},"100%":{opacity:".2"}}}},welcomeString:{textAlign:"left",...kt.g.body2,color:Pt.L.colorNeutralForeground4},greetingContainer:{gap:Pt.L.spacingVerticalS,display:"flex",alignItems:"center"},greeting:{textAlign:"left",height:Pt.L.spacingVerticalXXXL,...kt.g.subtitle1,whiteSpace:"nowrap",overflow:"hidden",margin:Pt.L.spacingVerticalNone}},Dt=(0,mt.n)(Tt),Mt={welcomeScreenFinalString:ut.sHv,welcomeScreenOneNoteFileType:ut.FZL,welcomeScreenExcelFileType:ut.ma_,welcomeScreenWordFileType:ut.Zs,welcomeScreenPPTFileType:ut.XEp,welcomeScreenFinalStringForAutoOpenedPane:ut.uZW,welcomeScreenFinalStringForAutoOpenedPanePpt:ut.fbU,copilotLogoAltText:ut.eAH},Lt={welcomeScreenGreetingString:ut.fHb,welcomeScreenLoadingString:ut.oPk,welcomeScreenProactiveGreetingString:ut.j9j,welcomeScreenFinalStringForBackstage:ut.uHc},Rt=N.memo((({userName:e="",appName:t="",loadingState:n,isDeclarativeCopilot:r,brandingUrl:s,wasAutoOpenedPane:i=!1,isCopilotInBackstageMode:a=!1,areZQMsAvailable:o=!0,customMessage:l})=>{const c=Dt(),u=(()=>{const e=(0,it.kQ)(Mt),t=(0,it.mY)(Lt);return N.useMemo((()=>({...e,...t})),[e,t])})(),d=(e=>{switch(e.toLowerCase()){case"powerpoint":return u.welcomeScreenPPTFileType();case"word":return u.welcomeScreenWordFileType();case"excel":return u.welcomeScreenExcelFileType();case"onenote":return u.welcomeScreenOneNoteFileType();default:return""}})(t);let h="";switch(n){case It.LOADING:h=u.welcomeScreenLoadingString({fileType:d});break;case It.AUTO_OPENED_PANE_LOADING_TIMEOUT:if("PowerPoint"===t)h=u.welcomeScreenFinalStringForAutoOpenedPanePpt();else{if(l){h=l;break}h=u.welcomeScreenFinalStringForAutoOpenedPane();const e=h.indexOf(",")+1;h=h.substring(e)}break;default:if(l){h=l;break}if(a){h=u.welcomeScreenFinalStringForBackstage({fileType:d});break}h=u.welcomeScreenFinalString()}const p=N.createElement(ht.W,{style:c.agentScreenContainer},N.createElement("div",{className:c.agentIconContainer},N.createElement(at._,{className:c.agentBrandingLogo,src:s,alt:u.copilotLogoAltText()})),N.createElement("div",null,N.createElement("h2",{className:c.greeting},i?u.welcomeScreenProactiveGreetingString({userDisplayName:e}):u.welcomeScreenGreetingString({userName:e})),o&&N.createElement("div",{className:c.welcomeString,"data-testid":"welcomeString"},h))),g=N.createElement(ht.W,{style:c.welcomeScreenContainer},N.createElement("div",{className:c.greetingContainer,"data-testid":"greetingContainer"},N.createElement("h2",{className:c.greeting},i?u.welcomeScreenProactiveGreetingString({userDisplayName:e}):u.welcomeScreenGreetingString({userName:e}))),!(r&&!1===o)&&N.createElement("div",{className:c.welcomeString,"data-testid":"welcomeString"},h),n===It.LOADING&&!r&&N.createElement("div",{className:c.loadingBarContainer},N.createElement(At.z,{bar:{className:c.loadingBar},role:"none",thickness:"large",shape:"rounded"})));return r&&s?p:g}));var Nt=n(98050),Ot=n(43685),_t=n(53515),Bt=n(86092),Ft=n(7722),Ut=n(19791),Ht=n(34432),zt=n(40100),jt=n(51022),Vt=n(2293),qt=n(59459),Wt=n(19130);const Qt=N.forwardRef(((e,t)=>{var n;const[r,s]=function(){const e={position:"above",align:"end",offset:{crossAxis:0,mainAxis:2},fallbackPositions:["below-end","after","after-top","before","before-top"],autoSize:!0},{targetRef:t,containerRef:n}=(0,qt.T)(e);return[n,t]}(),i=(0,Ht.P)(e,t);i.message.ref=(0,Wt.a)(i.message.ref,s);const a=(0,Wt.a)(null===(n=i.actionBar)||void 0===n?void 0:n.ref,r);return i.actionBar&&(i.actionBar.ref=a),(0,zt.j)(i),(0,jt.$e)("useUserMessageStyles")(i),(0,Vt.o)(i)}));Qt.displayName="UserMessage";var Gt=n(43364),Zt=n(29211),Yt=n(55559),Kt=n(36204),Jt=n(91915),Xt=n(38687);const $t=({referenceList:e,sensitivityIndicator:t})=>{var n,r,s,i,a,o;const l=(0,it.Lh)(Xt.FM),c={maxVisibleReferences:e&&e.references.length>0?e.maxVisibleReferences:Ut._3,showLessButton:N.createElement(Jt.m,{content:null!==(n=null==e?void 0:e.showLessButtonLabel)&&void 0!==n?n:l,relationship:"label",withArrow:!0},N.createElement(Gt.q,null,null!==(r=null==e?void 0:e.showLessButtonLabel)&&void 0!==r?r:l)),showMoreButton:N.createElement(Gt.q,{text:e=>`+${e}`})};return N.createElement(N.Fragment,null,t&&N.createElement(Zt.z,{heading:t.sensitivityLabel,message:null===(s=t.sensitivityTooltipProps)||void 0===s?void 0:s.message,withBackplate:!0},N.createElement(Yt.T,{"aria-label":t.sensitivityLabel,withLock:null===(i=t.sensitivityIconProps)||void 0===i?void 0:i.withLock,fillColor:null!==(o=null===(a=t.sensitivityIconProps)||void 0===a?void 0:a.fillColor)&&void 0!==o?o:Ut.C5})),e&&e.references.length>0&&N.createElement(Kt.a,Object.assign({},c),e.references.map(((e,t)=>N.createElement(e,{key:t})))),(null==e?void 0:e.customReferences)&&e.customReferences.length>0&&N.createElement(Kt.a,null,e.customReferences))};var en=n(38569);function tn(e){const t=(0,it.Lh)(Xt.sn);return N.createElement(en.$,Object.assign({},e),t)}function nn(e){return N.createElement(at._,{src:"https://res-2-sdf.cdn.office.net/files/fabric-cdn-prod_20240411.001/assets/brand-icons/product/svg/copilot_20x1.svg",height:20,width:20,alt:e})}function rn({messageProps:e}){let t;const n=(0,it.Lh)(Xt.cr);if("CopilotMessageV2"===e.type){let s,{name:i=Ut.zM,avatar:a=nn(n),disclaimer:o,references:l,sensitivityIndicator:c,showDefaultCopilotBranding:u=!0,showAiDisclaimer:d=!0}=e.props;s=Object.assign(Object.assign({},e),{props:Object.assign(Object.assign({},e.props),{name:u?i:Ut.bQ,avatar:u?a:N.createElement(N.Fragment,null),disclaimer:d?null!=o?o:N.createElement(tn,null):Ut.bQ})}),(l||c)&&(s.props.footnote=(r={referenceList:l,sensitivityIndicator:c},N.createElement($t,Object.assign({},r)))),t={messageProps:s}}else t={messageProps:Object.assign(Object.assign({},e),{props:Object.assign({},e.props)})};var r;return t}const sn=N.forwardRef(((e,t)=>{const n=rn(e),{props:r,type:s}=n.messageProps;return"CopilotMessageV2"===s?N.createElement(Ft.g,Object.assign({ref:t},r)):N.createElement(Qt,Object.assign({ref:t},r))}));sn.displayName=Ut.Nr;var an=n(43835),on=n(86768),ln=n(56406),cn=n(96831),un=n(74809),dn=n(94282),hn=n(67499);const pn="opacity 0.5s linear, transform 0.5s linear",gn={carouselNav:{backgroundColor:Pt.L.colorTransparentBackground,gap:Pt.L.spacingVerticalS,opacity:0,transform:"translateY(-10px)",transition:pn},carouselCard:{flex:"0 0 100%",display:"flex",justifyContent:"center",height:"fit-content"},carouselSlider:{gap:Pt.L.spacingVerticalL},carouselHeaderControls:{display:"flex",justifyContent:"space-between",alignItems:"center",alignSelf:"end"},carouselHeader:{...kt.g.body1Strong,color:Pt.L.colorNeutralForeground2,height:Pt.L.spacingVerticalXL,paddingLeft:Pt.L.spacingHorizontalS},carouselElementsTransition:{opacity:1,transform:"translateY(0)"},carouselNavControls:{gap:Pt.L.spacingHorizontalS,display:"flex",alignItems:"center",marginRight:Pt.L.spacingHorizontalXXS,opacity:0,transform:"translateY(-10px)",transition:pn},carouselNavControlIndex:{...kt.g.caption1,height:Pt.L.spacingVerticalXL,alignContent:"center"},carouselNavControlButtons:{border:`1px solid ${Pt.L.colorNeutralStroke1}`,borderRadius:Pt.L.borderRadiusMedium,padding:Pt.L.spacingHorizontalNone,maxWidth:"unset",minWidth:"unset","&:hover":{border:`1px solid ${Pt.L.colorNeutralStroke1Hover}`}},carouselContainer:{gap:Pt.L.spacingVerticalXS,display:"flex",flexDirection:"column",overflow:"hidden"},carouselAppear:{maxHeight:"0",overflow:"hidden",transition:"maxHeight 0.5s ease-out"},carouselVisible:{maxHeight:"1000px"},carouselContent:{flex:"1 1 auto",display:"flex",flexDirection:"column",gap:Pt.L.spacingVerticalXS,justifyContent:"space-between",paddingBottom:"1px"},carouselNavContainer:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center"},carouselNavButton:{padding:`${Pt.L.spacingVerticalS} ${Pt.L.spacingVerticalNone}`,outline:"unset",'[aria-selected="false"]':{opacity:"30%"},"::after":{backgroundColor:Pt.L.colorBrandForeground1}},carouselChatOutput:{display:"block"}},mn=(0,mt.n)(gn),fn={carouselNextCardText:ut.LW7,carouselNextButton:ut.kAI,carouselPrevButton:ut.gw_},yn={carouselNavigationDots:ut.DfT},vn=N.memo((({cardHeader:e,selectedIndex:t,cardsArray:n,renderCard:r,styles:s,onCardChange:i})=>{const a=(0,it.kQ)(fn),o=(0,it.mY)(yn),l=mn();(0,dt.bt)(l,s);const[c,u]=N.useState(t??0),d=N.useMemo((()=>n.length<1?null:N.createElement(an.F,{className:l.carouselContainer,groupSize:1,activeIndex:c,onActiveIndexChange:(e,t)=>{i&&t.index!==c&&i(t.index,(()=>u(t.index)))}},N.createElement("div",{className:l.carouselHeaderControls},e&&N.createElement("div",{className:l.carouselHeader},e),N.createElement("div",{className:(0,Bt.z)(l.carouselNavControls,n.length>1&&l.carouselElementsTransition)},c<n.length-1&&N.createElement("div",{className:l.carouselNavControlIndex},N.createElement(on.W,null,a.carouselNextCardText())," ",n[c+1].title," "),n.length>1&&N.createElement(N.Fragment,null,N.createElement(Jt.m,{content:a.carouselPrevButton(),relationship:"label",withArrow:!0},N.createElement(ln.t,{navType:"prev","aria-label":a.carouselPrevButton(),className:l.carouselNavControlButtons})),N.createElement(Jt.m,{content:a.carouselNextButton(),relationship:"label",withArrow:!0},N.createElement(ln.t,{navType:"next","aria-label":a.carouselNextButton(),className:l.carouselNavControlButtons}))))),N.createElement("div",{className:l.carouselContent},N.createElement(cn.q,{className:l.carouselSlider},n?.map(((e,t)=>N.createElement(un.j,{"aria-label":`carouselCard_${t+1}`,key:`contentCard-${t}`,className:l.carouselCard},N.createElement(N.Fragment,null,r(e,t)))))),n.length>1&&N.createElement(dn.q,{className:(0,Bt.z)(l.carouselNav,n.length>1&&l.carouselElementsTransition)},(e=>N.createElement(hn.a,{className:l.carouselNavButton,"aria-label":o.carouselNavigationDots({index:String(e)}),"data-tabster":null})))))),[n,c,e,a,i,r,o]);return N.createElement(sn,{messageProps:{type:"CopilotMessageV2",props:{name:"",avatar:"",showAiDisclaimer:!1,disclaimer:"",loadingState:"none",announcement:"",children:d,className:l.carouselChatOutput}}})}));var bn=n(9898),Cn=n(2954),wn=n(71703);const Sn=N.memo((({copyButton:e,feedbackButtons:t,sensitivityProps:n,additionalButtons:r})=>{const[s,i]=(0,N.useState)(!0),a=(0,N.useRef)(null),o=(0,Cn.hy)(),l=(0,Cn.t$)();(0,N.useEffect)((()=>{if(!a.current)return;const e=new ResizeObserver((e=>{for(const t of e)i(t.contentRect.width>400)}));return e.observe(a.current),()=>e.disconnect()}),[]);let c={sensitivityLabel:n?.displayName??"",sensitivityTooltipProps:{message:n?.tooltip},sensitivityIconProps:{fillColor:n?.color,withLock:n?.isEncrypted}};return N.createElement(N.Fragment,null,r?N.createElement(ht.W,{style:l.footerContainer,"data-testid":wn.m},N.createElement(ht.W,{horizontal:!0,style:l.buttonRow1,"data-testid":wn.jS},e&&N.createElement("div",{"data-testid":wn.l8},e),t&&N.createElement("div",{"data-testid":wn.yG},t)),N.createElement("div",{className:l.buttonRow2,style:{flexDirection:s?"row":"column"},ref:a,"data-testid":wn.JR},r?.map(((e,t)=>N.createElement(N.Fragment,{key:t},N.createElement("div",{"data-testid":`${wn.FE}-${t}`},e)))))):N.createElement(N.Fragment,null,N.createElement(bn.c,{className:o.divider,"data-testid":wn.Cd}),N.createElement(ht.W,{horizontal:!0,style:o.cardFooter,"data-testid":wn.Mj},e&&N.createElement("div",{className:o.copyButton,"data-testid":wn.l8},e),N.createElement("div",{className:o.feedbackAndDisclaimer,"data-testid":wn.Kb},n&&n.displayName&&N.createElement($t,{sensitivityIndicator:c}),N.createElement(tn,null),t))))}));var En=n(40404);const xn={suggestedQnATitle:ut.ADT,summaryTitle:ut.hZW,showMoreText:ut.urG},In=N.memo((({tabs:e,actionBarButtons:t,cardContentElementId:n,onTabChange:r,onFirstCardRendered:s,sensitivityProps:i,isWorkspaceMode:a=!1,styles:o,onShowMoreClicked:l})=>{const[c,u]=(0,N.useState)([]),d=(0,N.useRef)([]),h=(0,it.kQ)(xn).showMoreText(),p=(0,N.useRef)(e),g=(0,Ot.Y$)(),m=(0,Cn.np)();(0,dt.bt)(m,o);const{isExpanded:f,divRefs:y,onShowMoreButtonClick:v,handleCardChange:b}=function(e,t,n,r){const[s,i]=(0,N.useState)(Array(e).fill(!1)),[a,o]=(0,N.useState)(En.y8),l=(0,N.useRef)([]),c=(0,N.useRef)(void 0);(0,N.useEffect)((()=>{l.current=t.map(((e,t)=>l.current[t]||N.createRef()));const e=t.map(((e,n)=>{const r=l.current[n]?.current?.clientHeight||0;return s[n]?s[n]:t[n].contentState===Nt.x.LOADED&&r>0&&r<=En.Km}));i(e)}),[t]),(0,N.useEffect)((()=>{c.current&&(c.current(),c.current=void 0)}),[s]);const u=(0,N.useCallback)((e=>{i((r=>(r[e]||n?.(t?.[e]?.value),r.map(((t,n)=>n===e&&!t||t)))))}),[n,t]),d=(0,N.useCallback)(((e,n)=>{null!==a&&e!==a&&i((e=>e.map(((e,t)=>t===a?(l.current[t]?.current?.clientHeight??0)<=En.Km:e)))),r?.(t?.[e]?.value),o(e),c.current=n}),[a,r,t]);return{isExpanded:s,divRefs:l,handleCardChange:d,onShowMoreButtonClick:u}}(e?.length,c,l,r);(0,N.useEffect)((()=>{const e=setTimeout((()=>{const e=p.current;e?.forEach((e=>{e.contentState===Nt.x.LOADING&&e.onTabLoadTimeout?.()}))}),g.interactiveCardLoadingTimeout);return()=>{clearTimeout(e)}}),[]),(0,N.useEffect)((()=>{p.current=e,e.forEach((e=>{const t=d.current.findIndex((t=>t.value===e.value));e.contentState!==Nt.x.LOADED&&e.contentState!==Nt.x.UPDATING||(-1===t?(0===d.current.length&&s?.(e.value),d.current.push(e)):d.current[t]=e)})),u([...d.current])}),[e]);return N.createElement(vn,{selectedIndex:En.y8,cardsArray:c,renderCard:(e,r)=>N.createElement(_t.Z,{className:m.chatCard,"data-testid":`${wn.YE}-${e.value}`},N.createElement("header",null,N.createElement("div",{className:m.title,"data-testid":`${wn.ZV}-${e.value}`},e.title)),N.createElement("div",{ref:y.current[r],className:(0,Bt.z)(m.cardContent,f[r]?m.cardContentExpanded:m.cardContentCollapsed),onClick:()=>v(r),id:`${n}_${e.value}`,"data-testid":`${wn.Ud}-${e.value}`},e.content),t&&t.length>1&&f[r]&&N.createElement(Sn,{copyButton:t[0],feedbackButtons:t[1],sensitivityProps:i,additionalButtons:a&&t?.length>2?t.slice(2).filter((e=>null!==e)):void 0,"data-testid":`${wn.Mj}-${e.value}`}),!f[r]&&N.createElement(ct.$,{className:m.showMoreButton,onClick:()=>v(r),"data-testid":`${wn.lt}-${e.value}`},h)),onCardChange:b,"data-testid":wn.lc})}));var An=n(64554),Pn=n(60066),kn=n(30787);const Tn=N.memo((({contentState:e,onTryAgain:t})=>{const n={interactiveCardErrorRetryButtonText:ut.WHj,interactiveCardTimedOutErrorText:ut.H7p,interactiveCardTimedOutRetryMessage:ut.fNX,interactiveCardErrorText:ut.skO},r=(()=>{const e=(0,it.kQ)(n);return N.useMemo((()=>({...e})),[e])})(),s=(0,Cn.cQ)(),i=e===Nt.x.TIMEDOUT?r.interactiveCardTimedOutErrorText()??"":r.interactiveCardErrorText()??"",a=e===Nt.x.TIMEDOUT&&t?r.interactiveCardTimedOutRetryMessage()??"":"",o=r.interactiveCardErrorRetryButtonText()??"";return N.createElement("div",{className:s.errorContainer},N.createElement("div",{className:s.headContainer},N.createElement("div",{className:s.headerText},i),N.createElement("div",{className:s.content},a)),t&&e!==Nt.x.FATAL_ERROR&&N.createElement("div",{className:s.buttonText,onClick:()=>t?.()},o))}));var Dn=n(31787),Mn=n(64235);const Ln=N.memo((()=>{const e=(0,Cn.ZM)(),t=[{type:Dn.w.line,width:"100%",height:18}],n=[{type:Dn.w.line,width:"80%",height:18},{type:Dn.w.gap,width:"20%"}],r=[{type:Dn.w.line,width:"60%",height:18},{type:Dn.w.gap,width:"40%"}];return N.createElement("div",{className:e.shimmerListContainer},N.createElement(Mn.W,{className:e.shimmerClass,shimmerElements:t}),N.createElement(Mn.W,{className:e.shimmerClass,shimmerElements:t}),N.createElement(Mn.W,{className:e.shimmerClass,shimmerElements:n}),N.createElement(Mn.W,{className:e.shimmerClass,shimmerElements:r}))}));var Rn=n(77480);const Nn={suggestedQnATitle:ut.ADT,summaryTitle:ut.hZW,showMoreText:ut.urG},On=N.memo((({tabs:e,actionBarButtons:t,cardContentElementId:n,onTabChange:r,sensitivityProps:s,isWorkspaceMode:i=!1,styles:a,onShowMoreClicked:o})=>{const l=(0,it.kQ)(Nn).showMoreText(),c=(0,dt.bt)((0,Cn.hy)(),a),[u,d]=(0,N.useState)(e[0]),[h,p]=(0,N.useState)(!e[0].isFixedHeightTab),g=(0,N.useRef)(null),m=(0,N.useRef)(e),f=(0,Ot.Y$)(),y=(0,An.Mb)().hostAppSettings.window??window;(0,N.useEffect)((()=>{m.current=e}),[e]),(0,N.useEffect)((()=>{const e=y.setTimeout((()=>{m.current.forEach((e=>{e.contentState===Nt.x.LOADING&&e.onTabLoadTimeout?.()}))}),f.interactiveCardLoadingTimeout);return()=>{clearTimeout(e)}}),[]);const v=()=>{p(!0)};return(0,N.useEffect)((()=>{const t=e.find((e=>e.value===u.value));t&&d(t)}),[e]),N.createElement(N.Fragment,null,N.createElement(_t.Z,{className:c.chatCard},N.createElement("header",null,N.createElement(Pn.w,{color:"brand",appearance:"subtle-circular",size:"small",selectedValue:u.value,onTabSelect:(t,n)=>{const s=e.find((e=>e.value===n.value));s&&(d(s),r&&r(n.value))},className:c.tabList,"data-tabster":void 0},e.map(((e,t)=>N.createElement(kn.o,{key:t,className:c.tabElement,value:e.value},e.title))))),N.createElement("div",{ref:g,className:u.isFixedHeightTab?(0,Bt.z)(c.cardWrapper,u.contentState===Nt.x.LOADING||u.contentState===Nt.x.TIMEDOUT||(0,Rn.ZD)(u.contentState)?void 0:h?c.cardWrapperExpanded:c.cardWrapperCollapsed):void 0,onClick:()=>v()},N.createElement("div",{className:c.cardContent,id:`${n}_${u.value}`},(0,Rn.ZD)(u.contentState)||u.contentState===Nt.x.TIMEDOUT?N.createElement(Tn,{contentState:u.contentState,onTryAgain:u.onRetry?()=>{(e=>{u.onRetry?.();const t=y.setTimeout((()=>{const t=m.current.find((t=>t.value===e&&t.contentState===Nt.x.LOADING));t?.onTabLoadTimeout?.(!0)}),f.interactiveCardRetryTimeout)})(u.value)}:void 0}):u.contentState===Nt.x.LOADING?N.createElement(Ln,null):u.content),t&&t.length>1&&u.contentState!==Nt.x.LOADING&&u.contentState!==Nt.x.TIMEDOUT&&!(0,Rn.ZD)(u.contentState)&&N.createElement(Sn,{copyButton:t[0],feedbackButtons:t[1],sensitivityProps:s,additionalButtons:i&&t?.length>2?t.slice(2).filter((e=>null!==e)):void 0}),!h&&u.contentState!==Nt.x.LOADING&&u.contentState!==Nt.x.TIMEDOUT&&!(0,Rn.ZD)(u.contentState)&&u.isFixedHeightTab&&N.createElement(ct.$,{className:c.showMoreButton,onClick:()=>(v(),void(o&&o(u.value)))},l||En.w0))))}));var _n=n(42012),Bn=n(77338),Fn=n(75326),Un=n(84514),Hn=n(55);const zn="zero-query-prompt";var jn=n(62113);const Vn=(0,pt.Q)(ft.tR),qn={root:{maxWidth:"288px",...gt.Pt.padding(Vn.spacingVerticalM,Vn.spacingHorizontalL),fontFamily:"-apple-system",...gt.Pt.margin(Vn.spacingVerticalNone,Vn.spacingHorizontalL,Vn.spacingVerticalS),boxShadow:Vn.shadow2},cardHeader:{fontFamily:"-apple-system",lineHeight:"normal"},buttonStack:{...gt.Pt.gap(Vn.spacingVerticalS)},zeroQueryButton:{...gt.Pt.padding(Vn.spacingVerticalL,Vn.spacingHorizontalXL),minHeight:"40px",...gt.Pt.borderRadius(Vn.borderRadiusXLarge),fontFamily:"-apple-system",fontWeight:400,fontSize:"17px",height:"auto",textAlign:"left",lineHeight:"normal",[`& .${jn.h.icon}`]:{...gt.Pt.margin("0px","11px","0px","0px")}},zeroQuerySkillText:{...gt.Pt.borderRadius("4px"),backgroundColor:Pt.L.colorNeutralBackground3,color:Pt.L.colorNeutralForeground2,...gt.Pt.padding("3px"),"&:hover":{backgroundColor:Pt.L.colorNeutralBackground2Hover,color:Pt.L.colorNeutralForeground1Hover}}},Wn=(0,mt.n)(function(e){return{root:e.root??{},rootHighContrast:{},buttonStack:e.buttonStack??{},cardHeader:e.cardHeader??{},zeroQueryButton:e.zeroQueryButton??{},zeroQueryButtonDisabled:{},zeroQuerySkillText:e.zeroQuerySkillText??{},zeroQuerySpanWrapping:e.zeroQuerySpanWrapping??{}}}(qn)),Qn=(0,pt.Q)(ft.tR),Gn={root:{...gt.Pt.padding("12px"),...gt.Pt.borderRadius("8px"),...gt.Pt.margin("16px",0),boxShadow:Qn.shadow4,color:Qn.neutralPrimary,backgroundColor:Qn.neutralLight},rootHighContrast:{...gt.Pt.border("1px","solid",Qn.neutralLighterAlt)},buttonStack:{...gt.Pt.gap("4px"),marginTop:"8px"},cardHeader:{...kt.g.body1,whiteSpace:"pre-wrap"},zeroQueryButton:{justifyContent:"flex-start",height:"fit-content",textAlign:"start",backgroundColor:Qn.neutralLight,...gt.Pt.border("1px","solid",Qn.neutralLighterAlt),...kt.g.body1,[`&:hover .${jn.h.icon}`]:{color:Qn.themePrimary}},zeroQueryButtonDisabled:{color:Qn.neutralQuaternary,[`&:hover .${jn.h.icon}`]:{filter:"invert(75%) sepia(18%) saturate(5%) hue-rotate(318deg) brightness(94%) contrast(104%)"}},zeroQuerySkillText:{...gt.Pt.borderRadius("4px"),backgroundColor:Pt.L.colorNeutralBackground3,color:Pt.L.colorNeutralForeground2,...gt.Pt.padding("3px"),"&:hover":{backgroundColor:Pt.L.colorNeutralBackground2Hover,color:Pt.L.colorNeutralForeground1Hover}},zeroQuerySpanWrapping:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"flex-start"}},Zn=(0,mt.n)(Gn);var Yn=n(58651);const Kn=N.memo((({overrideStyles:e,promptSuggestions:t,headerText:n,isHVCAppChatV2Enabled:r,hvcPromptStringsList:a,isCardSpanWrappingEnabled:o,handleButtonClick:c=e=>{Yn.log("suggestion clicked:"+e)}})=>{const u=(()=>{let e=Zn();const t=Wn();(0,i.xp)()===s.Y.IOS&&(e=(0,dt.bt)(e,t));return e})(),d=(0,l.R2)(),h=(0,it.Lh)(ut.C33);(0,dt.bt)(u,e),u.zeroQueryButtonDisabled=(0,Bt.z)(u.zeroQueryButton,u.zeroQueryButtonDisabled),u.rootHighContrast=(0,Bt.z)(u.root,u.rootHighContrast);const p=(e,t)=>{const n=(0,Un.A)(t,e);return N.createElement(n,null)},g=e=>e.map(((e,t)=>e.promptType===Bn.t.Skill?N.createElement("span",{className:u.zeroQuerySkillText,key:t},e.promptText):N.createElement("span",{key:t},e.promptText)));return N.createElement(_n.g,{className:d?u.rootHighContrast:u.root,"aria-labelledby":h},N.createElement(Hn.l,null,N.createElement(Fn.E,{id:h,className:u.cardHeader},n)),N.createElement(ht.W,{style:u.buttonStack,customProperties:{role:dt.eg.MENU}},t.map(((e,n)=>{let s=[];if(r&&a?.length>0){const t=(0,dt.c9)(e.promptSuggestion,a);s=(0,dt.L5)(e.promptSuggestion,t)}return N.createElement(ct.$,{id:`${zn}-${n}`,size:"large",role:dt.eg.MENU_ITEM,icon:p(e.iconRegular,e.iconHover),key:n,disabled:e.isDisabled,"aria-posinset":n+1,"aria-setsize":t.length,className:e.isDisabled?u.zeroQueryButtonDisabled:u.zeroQueryButton,onClick:()=>{c(e.promptSuggestion)}},r&&s.length>0?o?N.createElement("div",{className:u.zeroQuerySpanWrapping},g(s)):g(s):e.promptSuggestion)}))))}));var Jn=n(1035),Xn=n(47889),$n=n(63601),er=n(52568),tr=n(36801),nr=n(47207),rr=n(76728),sr=n(87150),ir=n(48711),ar=n(86156);function or(e){return{root:e.root??{},zeroQueryV2Button:e.zeroQueryV2Button??{},zeroQueryV2ButtonContainer:e.zeroQueryV2ButtonContainer??{},zeroQueryHintText:e.zeroQueryHintText??{},zeroQueryHighlightText:e.zeroQueryHighlightText??{},zeroQueryIcon:e.zeroQueryIcon??{},zeroQuerySkillText:e.zeroQuerySkillText??{},zeroQueryPromptStack:e.zeroQueryPromptStack??{},zeroQueryBrandingStack:e.zeroQueryBrandingStack??{},zeroQueryBrandingTitle:e.zeroQueryBrandingTitle??{},zeroQueryBrandingTagline:e.zeroQueryBrandingTagline??{},zeroQueryBrandingDescription:e.zeroQueryBrandingDescription??{},zeroQueryBrandingIcon:e.zeroQueryBrandingIcon??{},inlineBrandingText:e.inlineBrandingText??{},inlineBrandingIcon:e.inlineBrandingIcon??{},refreshButton:e.refreshButton??{},refreshButtonIcon:e.refreshButtonIcon??{},refreshTooltip:e.refreshTooltip??{},zeroQueryIconV9:e.zeroQueryIconV9??{},refreshButtonV9:e.refreshButtonV9??{}}}const lr={zeroQueryV2Button:{fontFamily:"-apple-system",lineHeight:"normal"},zeroQuerySkillText:{fontFamily:"-apple-system",lineHeight:"normal"},zeroQueryHintText:{fontFamily:"-apple-system",lineHeight:"normal"},zeroQueryBrandingTitle:{fontFamily:"-apple-system",lineHeight:"normal"},zeroQueryBrandingTagline:{fontFamily:"-apple-system",lineHeight:"normal"},zeroQueryBrandingDescription:{fontFamily:"-apple-system",lineHeight:"normal"}},cr={...lr,zeroQueryBrandingIcon:{},zeroQueryBrandingStack:{}},ur=(0,mt.n)(or(lr)),dr=((0,mt.n)(or(cr)),(0,pt.Q)(ft.tR)),hr={root:{...gt.Pt.padding("16px",0),...gt.Pt.gap("8px")},zeroQueryV2ButtonContainer:{display:"flex",flexDirection:"row",flexWrap:"wrap",rowGap:Pt.L.spacingVerticalS,justifyContent:"center",columnGap:Pt.L.spacingHorizontalS,alignSelf:"center"},zeroQueryV2Button:{textAlign:"start",flexGrow:1,flexBasis:"80%",flexDirection:"column",backgroundColor:Pt.L.colorNeutralBackground1,...gt.Pt.padding("12px","16px"),...gt.Pt.borderRadius("8px"),...gt.Pt.gap("8px"),...kt.g.body1,boxShadow:Pt.L.shadow2,"&:hover":{boxShadow:Pt.L.shadow8,backgroundColor:Pt.L.colorNeutralBackground1},[`& .${ar.S.prompt}`]:{gridColumnStart:"icon"}},zeroQuerySkillText:{...gt.Pt.borderRadius("4px"),backgroundColor:Pt.L.colorNeutralBackground3,color:Pt.L.colorNeutralForeground2,...gt.Pt.padding("3px"),"&:hover":{backgroundColor:Pt.L.colorNeutralBackground2Hover,color:Pt.L.colorNeutralForeground1Hover}},zeroQueryHintText:{color:Pt.L.colorNeutralForeground4},zeroQueryHighlightText:{color:Pt.L.colorBrandForeground1},zeroQueryIcon:{color:dr.themePrimary},zeroQueryIconV9:{color:Pt.L.colorBrandForeground1},refreshButton:{minWidth:"fit-content","@media (forced-colors: none)":{[`&:hover .${jn.h.icon}`]:{color:dr.themePrimary}}},refreshButtonV9:{minWidth:"fit-content","@media (forced-colors: none)":{[`&:hover .${jn.h.icon}`]:{color:Pt.L.colorBrandForeground1}}},refreshButtonIcon:{width:"14px",height:"14px"},refreshTooltip:{},zeroQueryBrandingStack:{paddingBottom:Pt.L.spacingVerticalL,rowGap:Pt.L.spacingHorizontalXS},zeroQueryPromptStack:{...gt.Pt.gap("8px")},zeroQueryBrandingTitle:{alignItems:"center",textAlign:"center",justifyContent:"center",horizontalAlign:"center",verticalAlign:"center",columnGap:Pt.L.spacingVerticalS},zeroQueryBrandingTagline:{textAlign:"center",color:Pt.L.colorNeutralForeground4},zeroQueryBrandingDescription:{textAlign:"center",marginTop:Pt.L.spacingVerticalS},zeroQueryBrandingIcon:{height:Pt.L.spacingVerticalXXXL,width:Pt.L.spacingHorizontalXXXL},inlineBrandingText:{color:Pt.L.colorNeutralForeground4,display:"inline-flex",...gt.Pt.gap(Pt.L.spacingHorizontalXXS),...gt.Pt.padding(Pt.L.spacingVerticalNone,Pt.L.spacingHorizontalNone,Pt.L.spacingVerticalNone,Pt.L.spacingHorizontalXS)},inlineBrandingIcon:{height:Pt.L.spacingVerticalXL,width:Pt.L.spacingHorizontalXL}},pr={zeroQueryV2ButtonContainer:{display:"flex",flexDirection:"column",flexWrap:"nowrap",rowGap:Pt.L.spacingVerticalMNudge},zeroQueryV2Button:{height:"auto",width:"fit-content",textAlign:"start",alignItems:"center",flexGrow:1,flexBasis:"80%",flexDirection:"column",backgroundColor:Pt.L.colorTransparentBackground,...kt.g.body1,padding:Pt.L.spacingVerticalM,borderRadius:"12px",border:`1px solid ${Pt.L.colorNeutralStroke2}`,"&:hover":{boxShadow:Pt.L.shadow8,backgroundColor:Pt.L.colorNeutralBackground1Hover,border:`1px solid ${Pt.L.colorBrandStroke2}`},"&:active":{backgroundColor:Pt.L.colorNeutralBackground1Pressed,boxShadow:Pt.L.shadow4,border:`1px solid ${Pt.L.colorBrandStroke2}`},"&:focus":{backgroundColor:Pt.L.colorNeutralBackground1,border:`2px solid ${Pt.L.colorStrokeFocus2}`},[`& .${ar.S.prompt}`]:{gridColumnStart:"icon"}},zeroQueryHintText:{color:Pt.L.colorBrandForeground1},refreshButtonAppChatGlow:{width:"fit-content"},root:{...gt.Pt.gap(Pt.L.spacingVerticalL),paddingBottom:Pt.L.spacingVerticalL},inlineBrandingText:{color:Pt.L.colorNeutralForeground1,display:"inline-flex",...gt.Pt.gap(Pt.L.spacingHorizontalXXS),...gt.Pt.padding(Pt.L.spacingVerticalNone,Pt.L.spacingHorizontalNone,Pt.L.spacingVerticalNone,Pt.L.spacingHorizontalXS)}},gr={zeroQueryV2Button:{alignItems:"center",textAlign:"start",flexGrow:1,flexBasis:"80%",flexDirection:"column",backgroundColor:Pt.L.colorNeutralBackground1,...gt.Pt.padding("12px","16px"),...gt.Pt.borderRadius("8px"),...gt.Pt.gap("8px"),...kt.g.body1,boxShadow:Pt.L.shadow2,"&:hover":{boxShadow:Pt.L.shadow8,backgroundColor:Pt.L.colorNeutralBackground1},[`& .${ar.S.prompt}`]:{gridColumnStart:"icon"},"@media (min-width: 640px)":{flexBasis:"50%",maxWidth:"49%"},"@media (min-width: 920px)":{flexBasis:"32%",maxWidth:"32%"}}},mr=(0,mt.n)(hr),fr=(0,mt.n)(pr),yr=(0,mt.n)(gr),vr=(0,mt.n)({shimmerClass:{padding:"0",width:"100%",height:"16px"},shimmerElement:{width:"100%",padding:"0",margin:"0"},shimmerWrapper:{width:"100%",display:"flex",alignItems:"center",minHeight:"20px"},zqmPillShimmer:{alignItems:"center",textAlign:"start",width:"80%",backgroundColor:Pt.L.colorTransparentBackground,...kt.g.body1,padding:Pt.L.spacingVerticalM,borderRadius:"12px",border:`1px solid ${Pt.L.colorNeutralStroke2}`,boxSizing:"border-box",height:"46px","&:hover":{boxShadow:Pt.L.shadow8,backgroundColor:Pt.L.colorNeutralBackground1Hover,border:`1px solid ${Pt.L.colorBrandStroke2}`}}}),br=N.memo((()=>{const e=vr(),t=[{type:Dn.w.line,width:"60%",height:16}];return N.createElement("div",{className:e.zqmPillShimmer,"data-testid":"zqm-shimmer-pill"},N.createElement("div",{className:e.shimmerWrapper,"data-testid":"zqm-shimmer-wrapper"},N.createElement("div",{className:e.shimmerElement,"data-testid":"zqm-shimmer-element"},N.createElement(Mn.W,{className:e.shimmerClass,shimmerElements:t,"data-testid":"zqm-shimmer-component"}))))})),Cr=N.memo((({overrideStyles:e,promptSuggestions:t,isHVCAppChatV2Enabled:n,hvcPromptStringsList:r,handleButtonClick:a,showBranding:o,brandingInfo:c,showRefreshButton:u=!1,handleRefreshButtonClick:d=()=>{},wasChatPaneAutoOpened:h=!1,userDisplayName:p=ir.u1,isSQNALoading:g=!1})=>{const m=(0,Xn.zK)(),f=(()=>{const e=mr(),t=ur();(0,i.xp)()===s.Y.IOS&&(0,dt.bt)(e,t);return e})(),y=fr(),v=yr(),b=(0,Ot.Y$)(),C=b.isZQMColumnStackingEnabled?v.zeroQueryV2Button:b.isAppChatGlowUXEnabled||h?y.zeroQueryV2Button:f.zeroQueryV2Button,w=b.isAppChatGlowUXEnabled||h?y.root:f.root,S=b.isAppChatGlowUXEnabled?y.zeroQueryV2ButtonContainer:f.zeroQueryV2ButtonContainer,E=(0,i.dD)()?{lineHeight:"normal"}:{},x=b.enableHighlightedKeywordsInZQMPrompts,I=(0,An.Mb)().hostAppSettings.environment,[A,P]=N.useState(!1),k=m?.getDeclarativeAgentsList?.()??[];(0,dt.bt)(f,e);const T=(0,l.kF)()??!1,D=e=>{const t=e;return N.createElement(t,{className:T?f.zeroQueryIconV9:f.zeroQueryIcon})},M=(0,it.kQ)({zeroQueryBrandingTaglineString:ut.kq6,zeroQueryBrandingTitleString:ut.waK,zeroQueryBrandingIconLabel:ut.eAH,zeroQueryMoreExamplesButtonLabel:ut.b6S,copilotBrandingTaglineForProactiveZQM:ut.uZW,declarativeAgentsZQMInlineBrandingText:ut.iV0,newPromptsAvailableAnnouncement:ut.F4g}),L=(0,it.mY)({copilotBrandingTaglineForProactiveZQMWithName:ut.j9j});return(0,N.useEffect)((()=>{A&&P(!1)}),[A,t]),N.createElement(ht.W,{style:w},o&&N.createElement(ht.W,{customProperties:{role:dt.eg.GROUP},style:f.zeroQueryBrandingStack},N.createElement(ht.W,{horizontal:!0,style:f.zeroQueryBrandingTitle},N.createElement(at._,{title:c?.iconName?c.iconName:c?.title?c.title:M.zeroQueryBrandingIconLabel(),className:f.zeroQueryBrandingIcon,src:c?.iconUrl?c.iconUrl:(0,er.K_)(er.qw.Copilot,I)}),!h&&N.createElement(tr.M,{style:E},c?.title?c.title:M.zeroQueryBrandingTitleString())),N.createElement(lt.c,{className:f.zeroQueryBrandingTagline},c?.title?c?.tagline??"":h?p&&p!==ir.u1?L.copilotBrandingTaglineForProactiveZQMWithName({userDisplayName:p}):M.copilotBrandingTaglineForProactiveZQM():M.zeroQueryBrandingTaglineString()),c?.description&&N.createElement(nr.M,{className:f.zeroQueryBrandingDescription,style:E},c.description)),N.createElement(ht.W,{customProperties:{role:dt.eg.MENU},style:f.zeroQueryPromptStack},N.createElement("div",{id:"zeroQueryV2ButtonContainer",className:S,"aria-live":"polite","aria-atomic":"true","aria-relevant":"additions","aria-label":A?M.newPromptsAvailableAnnouncement():void 0},t.map(((e,s)=>{if(g&&b.shouldShowNewSQNAZQM&&s>=t.length-2)return N.createElement(br,{key:`shimmer-${s}`});if(e.isHidden)return null;let i="",o="",l="",c="",u=[];const d=e.source===$n.L.Agent?(0,dt.JY)(k,e.agentInvocationProps):void 0;if(n)if(r?.length>0){const t=(0,dt.c9)(e.promptSuggestionText,r);u=(0,dt.L5)(e.promptSuggestionText,t,d,x)}else{const t=(0,dt.kT)(e.promptSuggestionText);l=t?.prefixText??"",c=t?.skillText??"",i=t?.inputText??"",o=t?.hintText??""}else u=(0,dt.L5)(e.promptSuggestionText,void 0,d,x);return N.createElement(Jn.S,{id:`${zn}-${s}`,role:dt.eg.MENU_ITEM,icon:b.isAppChatGlowUXEnabled||h?N.createElement(N.Fragment,null):e.iconUrl?N.createElement(at._,{src:e.iconUrl,alt:e.iconUrlName?e.iconUrlName:e.promptSuggestionCategory,className:f.inlineBrandingIcon}):D(e.iconRegular),key:s,disabled:e.isDisabled||!1,"aria-posinset":s+1,"aria-setsize":t.length,className:C,category:b.isAppChatGlowUXEnabled||h?N.createElement(N.Fragment,null):e.promptSuggestionCategory,prompt:0===u.length?N.createElement(lt.c,{style:E},n&&l,n&&c.length>0&&N.createElement("span",{className:f.zeroQuerySkillText},c),i,N.createElement("span",{className:b.isAppChatGlowUXEnabled||h?y.zeroQueryHintText:f.zeroQueryHintText},o)):N.createElement(lt.c,{style:E},u.map(((e,t)=>{switch(e.promptType){case Bn.t.Ghost:return N.createElement("span",{key:t,className:b.isAppChatGlowUXEnabled||h?y.zeroQueryHintText:f.zeroQueryHintText},e.promptText);case Bn.t.Highlight:return N.createElement("span",{key:t,className:f.zeroQueryHighlightText},e.promptText);case Bn.t.Skill:return N.createElement("span",{key:t,className:f.zeroQuerySkillText},e.promptText);case Bn.t.File:return N.createElement("span",{key:t,className:b.isAppChatGlowUXEnabled||h?y.zeroQueryHintText:void 0},e.promptText);case Bn.t.InlineBranding:return N.createElement("span",{key:t,className:b.isAppChatGlowUXEnabled||h?y.inlineBrandingText:f.inlineBrandingText},`[${M.declarativeAgentsZQMInlineBrandingText()} `,N.createElement(at._,{src:e.inlineBrandingInfo?.iconUrl,alt:e.inlineBrandingInfo?.iconUrl,className:f.inlineBrandingIcon,"aria-hidden":!0}),`${e.inlineBrandingInfo?.name}]`);case Bn.t.Regular:default:return N.createElement("span",{key:t},e.promptText)}}))),onClick:()=>{let t=i;c.length>0&&(t=l+c+t),u.length>0&&(t=u.map((e=>e.promptType===Bn.t.Ghost||e.promptType===Bn.t.File||e.promptType===Bn.t.InlineBranding?"":e.promptText)).join("")),a(t,e.promptSuggestionText)}})})))),u&&N.createElement(ct.$,{appearance:b.isAppChatGlowUXEnabled?"transparent":"outline",...!b.isAppChatGlowUXEnabled&&{shape:"circular"},className:(0,Bt.z)(T?f.refreshButtonV9:f.refreshButton,b.isAppChatGlowUXEnabled&&y.refreshButtonAppChatGlow),onClick:()=>{d(),P(!0)},icon:{className:f.refreshButtonIcon,children:b.isAppChatGlowUXEnabled?N.createElement(rr.M5p,null):N.createElement(sr.wm0,null)},role:dt.eg.BUTTON,id:"refresh-prompt-suggestions-button",style:E},M.zeroQueryMoreExamplesButtonLabel()))}));var wr=n(21479),Sr=n(41603),Er=n(47853);const xr="suggestion-prompt-button",Ir=(0,mt.n)({root:{justifyContent:"flex-start"}}),Ar={suggestionPaneLabel:ut.wsC,suggestionPaneRefreshButtonLabel:ut.lQN},Pr=({stylesToOverride:e,suggestionList:t,handleSuggestionPillClick:n,showRefreshButton:r=!1,handleRefreshButtonClick:s=()=>{}})=>{const i=Ir();(0,dt.bt)(i,e);const a=(0,it.kQ)(Ar),o=(0,An.Mb)().hostAppSettings.window??window,l=N.createElement(wr.j,{className:i.root,action:r?N.createElement(Jt.m,{key:"refresh-button",content:a.suggestionPaneRefreshButtonLabel(),relationship:"label",positioning:"above"},N.createElement(ct.$,{appearance:"subtle",onClick:()=>{s();const e=o.document.getElementById(`${xr}-0`);e&&"function"==typeof e.focus&&e.focus()},icon:{children:N.createElement(Er.DXr,null)},role:dt.eg.BUTTON,id:"refresh-suggestion-prompt-button","data-testid":"refresh-button"})):null},t.map(((e,t)=>N.createElement("div",{id:`suggestionContainer-${t}`,key:t,dir:"auto"},N.createElement(Jt.m,{key:t,content:e,relationship:"label",positioning:"above",withArrow:!0},N.createElement(Sr.V,{onClick:()=>n(e),id:`${xr}-${t}`,role:dt.eg.BUTTON},e))))));return N.createElement(ht.W,{horizontal:!0,customProperties:{role:dt.eg.GROUP,tabIndex:0,"aria-label":a.suggestionPaneLabel()}},l)};var kr;!function(e){e.Start="start",e.End="end"}(kr||(kr={}));const Tr="suggestion-pane-button";var Dr=n(75421);function Mr(e){return{root:e.root??{},button:e.button??{},suggestionContainer:e.suggestionContainer??{},refreshButton:e.refreshButton??{},refreshButtonIcon:e.refreshButtonIcon??{},tooltip:e.tooltip??{}}}const Lr=(0,pt.Q)(ft.tR),Rr={root:{justifyContent:"flex-start",flexWrap:"nowrap",backgroundColor:"transparent",minHeight:"67px",...gt.Pt.padding("12px","0px"),...gt.Pt.margin(Lr.spacingVerticalNone),"> *:not(.ms-StackItem)":{flexShrink:0},overflowX:"auto",overflowY:"hidden"},suggestionContainer:{minHeight:"67px",...gt.Pt.overflow("hidden"),...gt.Pt.padding("12px")},button:{...gt.Pt.borderRadius("8px"),display:"flex",...gt.Pt.padding("0px","8px"),fontFamily:"-apple-system",lineHeight:"normal",fontStyle:"normal",fontWeight:"400",fontSize:"14px",alignItems:"center",order:"0",textOverflow:"ellipsis",overflowX:"auto",overflowY:"hidden",whiteSpace:"nowrap",textAlign:"start"},refreshButton:{...gt.Pt.border("1px","solid",Lr.themeMedium),backgroundColor:"transparent",...gt.Pt.borderRadius("50%"),...gt.Pt.padding("2px"),...gt.Pt.margin("4px"),verticalAlign:"middle",minWidth:"40px",height:"40px",order:-1},tooltip:{fontFamily:"-apple-system",lineHeight:"normal"}},Nr=(0,mt.n)(Mr(Rr)),Or={suggestionContainer:{fontFamily:"-apple-system",lineHeight:"normal"},button:{fontFamily:"-apple-system",lineHeight:"normal"},refreshButton:{fontFamily:"-apple-system",lineHeight:"normal"},refreshButtonIcon:{fontFamily:"-apple-system",lineHeight:"normal"},tooltip:{fontFamily:"-apple-system",lineHeight:"normal"}},_r=(0,mt.n)(Mr(Or)),Br={root:{justifyContent:"flex-end",flexWrap:"wrap",...gt.Pt.margin(0,"auto"),maxWidth:Dr.tu,minWidth:Dr.Z$},suggestionContainer:{...gt.Pt.margin(0,Dr.nT),alignSelf:"center",width:"-webkit-fill-available"},button:{textAlign:"start",color:Pt.L.colorNeutralForeground1,backgroundColor:"transparent",...gt.Pt.border("1px","solid",Pt.L.colorBrandBackground2Hover),...kt.g.caption1,...gt.Pt.borderRadius(Pt.L.borderRadiusXLarge),...gt.Pt.padding(Pt.L.spacingVerticalSNudge,Pt.L.spacingHorizontalS),...gt.Pt.margin(Pt.L.spacingVerticalXS),"@media (forced-colors: none)":{"&:hover":{backgroundColor:Pt.L.colorBrandBackground2,...gt.Pt.border("1px","solid",Pt.L.colorBrandStroke2Hover)},"&:hover :active":{backgroundColor:Pt.L.colorBrandBackground2,...gt.Pt.border("1px","solid",Pt.L.colorBrandStroke2Hover)}}},refreshButton:{minWidth:"fit-content",...gt.Pt.border("1px","solid",Pt.L.colorBrandBackground2Hover),"@media (forced-colors: none)":{"&:hover":{backgroundColor:Pt.L.colorBrandBackground2,...gt.Pt.border("1px","solid",Pt.L.colorBrandStroke2Hover)},[`&:hover .${jn.h.icon}`]:{color:Pt.L.colorCompoundBrandForeground1}}},refreshButtonIcon:{width:"14px",height:"14px"},tooltip:{}},Fr=(0,mt.n)(Br),Ur=(0,pt.Q)(ft.tR),Hr={root:{justifyContent:"flex-end",flexWrap:"wrap",...gt.Pt.margin(0,"auto"),maxWidth:Dr.tu,minWidth:Dr.Z$},suggestionContainer:{...gt.Pt.margin(0,Dr.nT),alignSelf:"center",width:"-webkit-fill-available"},button:{textAlign:"start",color:Ur.neutralPrimary,backgroundColor:"transparent",...gt.Pt.border("1px","solid",Ur.themeMedium),...kt.g.caption1,...gt.Pt.borderRadius(Ur.borderRadiusXLarge),...gt.Pt.padding(Ur.spacingVerticalSNudge,Ur.spacingHorizontalS),...gt.Pt.margin(Ur.spacingVerticalXS),"@media (forced-colors: none)":{"&:hover":{backgroundColor:Ur.themeLight,...gt.Pt.border("1px","solid",Ur.themeDarker)},"&:hover :active":{backgroundColor:Ur.themeLight,...gt.Pt.border("1px","solid",Ur.themeDarker)}}},refreshButton:{minWidth:"fit-content","@media (forced-colors: none)":{[`&:hover .${jn.h.icon}`]:{color:Ur.themePrimary}}},refreshButtonIcon:{width:"14px",height:"14px"},tooltip:{}},zr=(0,mt.n)(Hr),jr=()=>{const e=zr(),t=(()=>{const e=Fr(),t=_r();(0,i.xp)()===s.Y.IOS&&(0,dt.bt)(e,t);return e})(),n=(0,l.kF)()?t:e;n.refreshButton=(0,Bt.z)(n.button,n.refreshButton);const r=Nr();if((0,i.xp)()===s.Y.IOS)(0,dt.bt)(n,r);return n},Vr={suggestionPaneLabel:ut.wsC,suggestionPaneRefreshButtonLabel:ut.lQN},qr=({stylesToOverride:e,suggestionList:t,handleSuggestionPillClick:n,showRefreshButton:r=!1,handleRefreshButtonClick:s=()=>{},refreshButtonPosition:i=kr.End})=>{const a=jr();(0,dt.bt)(a,e);const o=(0,it.kQ)(Vr),l=(0,An.Mb)().hostAppSettings.window??window,c=[...t.map(((e,t)=>N.createElement(Jt.m,{key:t,content:e,relationship:"label",positioning:"above",withArrow:!0},N.createElement(ct.$,{size:"small",appearance:"subtle",className:a.button,onClick:()=>n(e),role:dt.eg.BUTTON,id:`${Tr}-${t}`},e)))),r&&N.createElement(Jt.m,{key:"refresh-button",content:N.createElement("span",{className:a.tooltip},o.suggestionPaneRefreshButtonLabel()),relationship:"label",positioning:"above"},N.createElement(ct.$,{appearance:"subtle",className:a.refreshButton,onClick:()=>{s();const e=l.document.getElementById(`${Tr}-0`);e&&"function"==typeof e.focus&&e.focus()},icon:{className:a.refreshButtonIcon,children:N.createElement(Er.DXr,null)},role:dt.eg.BUTTON,id:"refresh-suggestion-pill-button"}))];return r&&c.length>1&&i===kr.Start&&c.unshift(c.pop()),N.createElement("div",{className:a.suggestionContainer},N.createElement(ht.W,{style:a.root,horizontal:!0,customProperties:{role:dt.eg.GROUP,tabIndex:0,"aria-label":o.suggestionPaneLabel()}},c))},Wr=(0,mt.n)({container:{height:"calc(100vh - 50px)",marginLeft:"20px",width:"calc(100vw - 50px)",marginRight:"20px"},card:{margin:"auto",marginLeft:"20px",width:"calc(100vw - 50px)",marginRight:"20px",maxWidth:"100%",height:"112px",marginTop:"40px",border:"3px",borderRadius:"12px"},header:{marginLeft:"20px",width:"calc(100vw - 50px)",marginRight:"20px",height:"22px",gap:"0px",opacity:"0px",leftMargin:"20px",bottomMargin:"20px",color:"#000",fontFamily:'var(--Font-family-Base, "Segoe UI")',fontSize:"var(--Font-size-400, 16px)",fontStyle:"normal",fontWeight:600,lineHeight:"var(--Line-height-400, 22px)",marginTop:"20px"},backButton:{border:"none",fontFamily:"var(--Font-familyBase)",fontWeight:"600",fontSize:"12px",lineHeight:"16px",height:"16px",width:"180px",gap:"8px",justifyContent:"left",paddingLeft:"0px",backgroundColor:"transparent"}}),Qr=({podcastUIProps:e,changeView:t,interactiveCardProps:r})=>{const s=N.useMemo((()=>N.lazy((()=>Promise.all([n.e(9037),n.e(3341),n.e(5016)]).then(n.bind(n,67082)).then((e=>({default:e.ComprehensionPodcastUI})))))),[]),i=Wr();return N.createElement("div",{className:i.container},N.createElement("div",{style:{display:"flex",flexDirection:"column"}},N.createElement(ct.$,{onClick:()=>t("chat"),icon:N.createElement(rr.l_X,null),className:i.backButton},"Back to Chat"),N.createElement(Fn.E,{className:i.header}," ","Understand with Copilot"," ")),N.createElement(_t.Z,{className:i.card},N.createElement(N.Suspense,{fallback:N.createElement("div",null,"Loading...")},N.createElement(s,{...e}))),N.createElement("div",{className:i.card},r&&N.createElement(On,{...r})))};var Gr=n(12516);const Zr={root:{...gt.Pt.margin(0)}},Yr=(0,mt.n)(Zr),Kr=({label:e,checked:t,disabled:n,onChange:r})=>{const s=Yr();return N.createElement(Gr.d,{className:s.root,onChange:r,checked:t,label:e,disabled:n,labelPosition:"after"})},Jr={buttonStack:{...gt.Pt.margin("0px","0px","0px","15px")},buttonStackItem:{...gt.Pt.margin("0px","5px","0px","0px")}},Xr=(0,mt.n)(Jr);var $r=n(1895),es=n(35095),ts=n(87866),ns=n(71558),rs=n(32617),ss=n(78364),is=n(91067),as=n(63179),os=n(45504),ls=n(18990),cs=n(41359);const us=(()=>{const e=(0,pt.Q)(ft.tR);return{itemCell:{...gt.Pt.padding("5px"),...gt.Pt.borderBottom("1px","solid",e.themePrimary),minHeight:"30px",boxSizing:"border-box",display:"flex",selectors:{"&:hover":{backgroundColor:e.neutralLight}}},itemContent:{...gt.Pt.overflow("hidden"),...gt.Pt.margin("0px","0px","0px","5px"),flexGrow:1},itemName:{...gt.Pt.overflow("hidden"),whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"500"},itemValue:{fontSize:"14px",fontWeight:"400"},accordionBody:{...gt.Pt.margin("0px","10px")},metricAccordionHeaderText:{...gt.Pt.overflow("auto"),overflowWrap:"anywhere",fontSize:"16px",fontWeight:"500"}}})(),ds=(0,mt.n)(us);const hs=function(e){const[t,n]=N.useState([]),[r,s]=N.useState([]),[i,a]=N.useState(""),o=ds();return(0,N.useEffect)((()=>{(t=>{if(a(t),""!==i){const t=e.telemetry.metrics?.filter((e=>e.serviceName.toLowerCase().includes(i.toLowerCase())));s(t)}else s(e.telemetry.metrics)})(e.searchValue)}),[e.searchValue]),N.createElement(is.n,{openItems:t,onToggle:(e,t)=>{n(t.openItems)},multiple:!0,collapsible:!0,className:o.accordionBody},r.map(((e,t)=>N.createElement(as.A,{key:t,value:(t+1).toString()},N.createElement(os.u,null,N.createElement(Fn.E,{className:o.metricAccordionHeaderText},`${e.serviceName}`)),N.createElement(ls.v,null,Object.keys(e).filter((e=>"serviceName"!==e)).map(((t,n)=>N.createElement("div",{key:n,className:o.itemCell,"data-is-focusable":!0},N.createElement("div",{className:o.itemContent},N.createElement(Fn.E,{block:!0,className:o.itemName},t.toString()),N.createElement(Fn.E,{block:!0,className:o.itemValue},String(e[t])))))))))))};var ps;!function(e){e.COPIED="Copied",e.COPY_ERROR="Copy Error",e.COPY_DEBUG_LOGS="Copy Debug Logs"}(ps||(ps={}));const gs={dialogTitle:{...gt.Pt.padding("5px","0px","5px","10px")},queryAccordionHeaderText:{...gt.Pt.overflow("auto"),fontSize:"16px",fontWeight:"600",overflowWrap:"anywhere"},queryAccordionText:{fontSize:"16px",fontWeight:"400"},searchBox:{width:"90%",marginLeft:"5%"},searchBoxContainer:{paddingBottom:"10px"}},ms=(0,mt.n)(gs);const fs=function(e){const[t,n]=N.useState([]),[r,s]=N.useState(""),i=ms();return N.createElement($r.l,{open:e.isModalOpen,onOpenChange:(t,n)=>{e.setIsModalOpen(n.open)}},N.createElement(es.E,null,N.createElement(ts.R,null,N.createElement(ns.L,{action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":"close",icon:N.createElement(cs.Jtj,null)})),className:i.dialogTitle},"Sydney Telemetry Debug Panel"),N.createElement(ss.C,null,N.createElement("div",{className:i.searchBoxContainer},N.createElement("input",{placeholder:"Search Telemetry",onChange:e=>s(e.target.value),className:i.searchBox})),N.createElement(is.n,{openItems:t,onToggle:(e,t)=>{n(t.openItems)},multiple:!0,collapsible:!0},e.telemetryData.map(((e,t)=>N.createElement(as.A,{key:t,value:(t+1).toString()},N.createElement(os.u,null,N.createElement(ht.W,null,N.createElement(Fn.E,{block:!0,className:i.queryAccordionHeaderText},`[ ${(t+1).toString()} ] Query ID :`),N.createElement(Fn.E,{className:i.queryAccordionText},e.queryId))),N.createElement(ls.v,null,N.createElement(hs,{telemetry:e.telemetry,searchValue:r}))))))))))};var ys=n(58651);const vs=function(e){const[t,n]=(0,N.useState)(!1),[r,s]=(0,N.useState)(!1),[i,a]=(0,N.useState)(!1),[o,l]=(0,N.useState)(!1),c=Xr(),u=r?ps.COPIED:i?ps.COPY_ERROR:ps.COPY_DEBUG_LOGS,d={checked:t,disabled:!1,onChange:(e,t)=>{const r=t?.checked;n(r??!1),r||(s(!1),a(!1))},label:"Debug Tools"};return N.createElement(ht.W,null,N.createElement(Kr,{...d}),N.createElement(ht.W,{horizontal:!0,style:c.buttonStack},N.createElement(Hn.l,{style:c.buttonStackItem},t&&N.createElement(ct.$,{appearance:"outline",onClick:async()=>{try{const t=e.getLogs();t&&await navigator.clipboard.writeText(t),s(!0)}catch(e){ys.log("An error occurred while copying text to clipboard:",e.message),a(!0)}},size:"small",title:u},u)),N.createElement(Hn.l,{style:c.buttonStackItem},t&&""!=e.conversationId&&N.createElement(ct.$,{appearance:"outline",onClick:()=>{e.conversationId&&window.open("https://sdf.cortana.ai/turingbot/ui?debug=true&enableDebugButton=&allowedMessageTypes=Any&variants=UseIc3ForConversationStorage&sourceConversationId="+e.conversationId,"_blank")},size:"small",title:"Replay Conversation"},"Replay Conversation")),N.createElement(Hn.l,{style:c.buttonStackItem},t&&e.telemetryData&&N.createElement(ct.$,{appearance:"outline",onClick:()=>{l(!o)},size:"small",title:"Show Telemetry Panel",disabled:0===e.telemetryData.length},"Show Telemetry Panel"))),t&&e.telemetryData&&o&&N.createElement(fs,{telemetryData:e.telemetryData,isModalOpen:o,setIsModalOpen:l}))};var bs=n(50239),Cs=n(85498),ws=n(83076),Ss=n(299),Es=n(65396),xs=n(48238),Is=n(98383),As=n(60484),Ps=n(4623),ks=n(87458),Ts=n(75900),Ds=n(88363),Ms=n(50576),Ls=n(2402),Rs=n(86148);const Ns="Client Conversation Logs",Os="Client Console Logs",_s="CIP Results",Bs="On VPN, open CIP Tree Visualizer",Fs="View CIP Tree JSON",Us="Performance",Hs="Session Info",zs="Augloop Workflow Logs",js="Chat Event Logs",Vs="Session Id",qs="Session Key",Ws="Option Sets",Qs="AL Inspector Link",Gs="App Name",Zs="App Platform",Ys="SDX Version",Ks="https://web.augloop-tools.officeppe.com/inspector/",Js="https://turingbot.sdf-master.substrate-turing-turingbot.westus3-sdf.cosmic-ppe.office.net/turingbot/ui?debug=true&sourceConversationId=",Xs="_blank",$s="N/A",ei="undefined",ti="Close",ni="Session STK Scorecard",ri="ASHA Logs Overview";var si=n(30874),ii=n(35480),ai=n(86949),oi=n(93720);const li={table:{backgroundColor:Pt.L.colorNeutralBackground1,marginLeft:Pt.L.spacingHorizontalM,width:"-webkit-fill-available"},tableRow:{display:"flex",justifyContent:"space-between"},tableCell:{flex:1},errorStringCell:{display:"flex",alignItems:"center"},icon:{marginRight:Pt.L.spacingHorizontalS},accordianPillar:{backgroundColor:Pt.L.colorNeutralBackground2,...gt.Pt.margin(Pt.L.spacingVerticalS),paddingBottom:Pt.L.spacingVerticalXXS,borderRadius:Pt.L.borderRadiusMedium,...gt.Pt.border(Pt.L.strokeWidthThick,"solid",Pt.L.colorNeutralBackground1Pressed)},accordionVeto:{backgroundColor:Pt.L.colorNeutralBackground2,...gt.Pt.margin(Pt.L.spacingVerticalS),paddingBottom:Pt.L.spacingVerticalXXS,borderRadius:Pt.L.borderRadiusMedium},accordionFeature:{backgroundColor:Pt.L.colorNeutralBackground2Hover,...gt.Pt.margin(Pt.L.spacingVerticalS),paddingBottom:Pt.L.spacingVerticalXXS,borderRadius:Pt.L.borderRadiusMedium},accordianHeader:{...kt.g.body1Strong}},ci=(0,mt.n)(li),ui=({data:e})=>{const t=ci();return N.createElement(is.n,{collapsible:!0,multiple:!0},e?.map(((e,n)=>N.createElement(as.A,{className:t.accordianPillar,key:n,value:"Pillar"+n},N.createElement(os.u,{icon:N.createElement(Ls.CXO,null)},N.createElement(Fn.E,{className:t.accordianHeader},e.pillarName)),N.createElement(ls.v,null,N.createElement(is.n,{collapsible:!0,multiple:!0},e.pillarAshaData.map(((e,n)=>N.createElement(as.A,{className:t.accordionFeature,key:n,value:"Feature Name"+n},N.createElement(os.u,{icon:N.createElement(Rs.T0n,null)},N.createElement(Fn.E,{className:t.accordianHeader},e.featureName)),N.createElement(ls.v,null,N.createElement(is.n,{collapsible:!0,multiple:!0},e.vetos.map(((e,n)=>N.createElement(as.A,{className:t.accordionVeto,key:n,value:"Veto"+n},N.createElement(os.u,{icon:N.createElement(Ds.kNN,null)},N.createElement(Fn.E,{className:t.accordianHeader},e.vetoName)),N.createElement(ls.v,null,N.createElement(si.X,{className:t.table},N.createElement(ii.B,null,e.errorStrings.map(((e,n)=>N.createElement(ai.H,{className:t.tableRow,key:n},N.createElement(oi.n,{className:t.errorStringCell},N.createElement(cs.Pe6,{className:t.icon}),e.string),N.createElement(oi.n,null,e.count)," "))))))))))))))))))))},di=({isModalOpen:e,setIsModalOpen:t,ashaLogObject:n})=>N.createElement($r.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},N.createElement(es.E,null,N.createElement(ts.R,null,N.createElement(ns.L,{action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":ti,icon:N.createElement(cs.Jtj,null)}))},ri),N.createElement(ss.C,null,n&&n.length>0&&N.createElement(ui,{data:n}))))),hi={dialogTitle:{...gt.Pt.padding("5px","0px","5px","10px")},queryAccordionHeaderText:{...gt.Pt.overflow("auto"),fontSize:"16px",fontWeight:"600",overflowWrap:"anywhere"},queryAccordionText:{fontSize:"16px",fontWeight:"400"},itemName:{...gt.Pt.overflow("hidden"),whiteSpace:"nowrap",textOverflow:"ellipsis",fontSize:"14px",fontWeight:"500"},itemValue:{fontSize:"14px",fontWeight:"400"}},pi=(0,mt.n)(hi),gi=({isModalOpen:e,setIsModalOpen:t,cipTree:n})=>{const r=pi(),[s,i]=N.useState([]);return N.createElement($r.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},N.createElement(es.E,null,N.createElement(ts.R,null,N.createElement(ns.L,{action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":ti,icon:N.createElement(cs.Jtj,null)}))},_s),N.createElement(ss.C,null,N.createElement(is.n,{openItems:s,onToggle:(e,t)=>{i(t.openItems)},multiple:!0,collapsible:!0},n?.semanticTree&&N.createElement(as.A,{key:"0",value:"0"},N.createElement(os.u,null,N.createElement(ht.W,null,N.createElement(Fn.E,{block:!0,className:r.queryAccordionHeaderText},"Semantic Tree"))),N.createElement(ls.v,null,n.semanticTree)),n?.contentTree&&N.createElement(as.A,{key:"1",value:"1"},N.createElement(os.u,null,N.createElement(ht.W,null,N.createElement(Fn.E,{block:!0,className:r.queryAccordionHeaderText},"Content Tree"))),N.createElement(ls.v,null,n.contentTree)),n?.topicTree&&N.createElement(as.A,{key:"2",value:"2"},N.createElement(os.u,null,N.createElement(ht.W,null,N.createElement(Fn.E,{block:!0,className:r.queryAccordionHeaderText},"Topic Tree"))),N.createElement(ls.v,null,n.topicTree)))))))},mi=({isModalOpen:e,setIsModalOpen:t,conversationLogObject:n})=>{const r=pi(),[s,i]=N.useState([]),a=(e,t)=>N.createElement(as.A,{key:t,value:(t+1).toString()},N.createElement(os.u,null,N.createElement(ht.W,null,N.createElement(Fn.E,{block:!0,className:r.queryAccordionHeaderText},`[ ${(t+1).toString()} ] Query`))),N.createElement(ls.v,null,(e=>{const t=[];return Object.keys(e).forEach((function(n){t.push(N.createElement("div",{className:r.itemName},n,":")),t.push(N.createElement("div",{className:r.itemValue},JSON.stringify(e[n])))})),t})(e)));return N.createElement($r.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},N.createElement(es.E,null,N.createElement(ts.R,null,N.createElement(ns.L,{action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":ti,icon:N.createElement(cs.Jtj,null)}))},Ns),N.createElement(ss.C,null,N.createElement(is.n,{openItems:s,onToggle:(e,t)=>{i(t.openItems)},multiple:!0,collapsible:!0},n?.map(((e,t)=>a(e,t))))))))},fi=({isModalOpen:e,setIsModalOpen:t,getLogs:n})=>N.createElement($r.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},N.createElement(es.E,null,N.createElement(ts.R,null,N.createElement(ns.L,{action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":ti,icon:N.createElement(cs.Jtj,null)}))},Os),N.createElement(ss.C,null,n?n():"")))),yi=({isModalOpen:e,setIsModalOpen:t,debugMessageInfoObject:n})=>{const r=pi();return N.createElement($r.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},N.createElement(es.E,null,N.createElement(ts.R,null,N.createElement(ns.L,{action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":ti,icon:N.createElement(cs.Jtj,null)}))},"Debug Info"),N.createElement(ss.C,null,n?(e=>{const t=[];return Object.keys(e).forEach((function(n){t.push(N.createElement("div",{className:r.itemName},n,":")),t.push(N.createElement("div",{className:r.itemValue},JSON.stringify(e[n])??ei))})),t})(n):""))))},vi={toolbar:{justifyContent:"space-between",marginRight:"5px",...gt.Pt.padding("2px")}},bi=(0,mt.n)(vi),Ci=({isModalOpen:e,setIsModalOpen:t,chatPaneLoadTime:n,chatInputLoadTime:r,chatHistoryLoadTime:s,taskPaneLoadTime:i})=>{const a=pi();return N.createElement($r.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},N.createElement(es.E,null,N.createElement(ts.R,null,N.createElement(ns.L,{action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":ti,icon:N.createElement(cs.Jtj,null)}))},Us),N.createElement(ss.C,null,i&&N.createElement("div",{className:a.itemName},"SDX Resources Load Time: "),i&&N.createElement("div",{className:a.itemValue},`${i}s`),N.createElement("div",{className:a.itemName},"Chat History Load Time: "),N.createElement("div",{className:a.itemValue},`${s}s`),N.createElement("div",{className:a.itemName},"Chat Pane Load Time: "),N.createElement("div",{className:a.itemValue},`${n}s`),N.createElement("div",{className:a.itemName},"Ready to Interact: "),N.createElement("div",{className:a.itemValue},`${r}s`)))))};var wi=n(25274);const Si=({isModalOpen:e,setIsModalOpen:t,sessionId:n,conversationLogObject:r,appName:s,appPlatform:i,augloopKustoQueryURL:a,clientKustoQueryURL:o,sdxVersion:l,sessionKey:c,conversationId:u})=>{const d=pi();return N.createElement($r.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},N.createElement(es.E,null,N.createElement(ts.R,null,N.createElement(ns.L,{action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":ti,icon:N.createElement(cs.Jtj,null)}))},Hs),N.createElement(ss.C,null,N.createElement("div",{className:d.itemName},`${Vs}: `),N.createElement("div",{className:d.itemValue},n||""),N.createElement("div",{className:d.itemName},`${qs}: `),N.createElement("div",{className:d.itemValue},c||$s),N.createElement("div",{className:d.itemName},`${Gs}: `),N.createElement("div",{className:d.itemValue},s||""),N.createElement("div",{className:d.itemName},`${Zs}: `),N.createElement("div",{className:d.itemValue},i||""),N.createElement("div",{className:d.itemName},`${Ys}: `),N.createElement("div",{className:d.itemValue},l||""),N.createElement("div",{className:d.itemName},`${Ws}: `),N.createElement("div",{className:d.itemValue},r&&r.length>0&&r[0].optionSets?r[0].optionSets:$s),N.createElement("div",{className:d.itemName},"Conversation Id: "),N.createElement("div",{className:d.itemValue},u||$s),N.createElement("div",{className:d.itemName},"Dev UI Link: "),N.createElement("div",{className:d.itemValue},N.createElement(wi.N,{onClick:()=>{const e=`${Js}${u}`;window.open(e,Xs)}},`${Js}${u}`)),N.createElement("div",{className:d.itemName},`${Qs}: `),N.createElement("div",{className:d.itemValue},N.createElement(wi.N,{onClick:()=>{const e=`${Ks}${c}`;window.open(e,Xs)}},`${Ks}${c}`)),N.createElement("div",{className:d.itemName},`${zs}: `),N.createElement("div",{className:d.itemValue},N.createElement(wi.N,{onClick:()=>{window.open(a,Xs)}},a)),N.createElement("div",{className:d.itemName},`${js}: `),N.createElement("div",{className:d.itemValue},N.createElement(wi.N,{onClick:()=>{window.open(o,Xs)}},o))))))};var Ei=n(24595),xi=n(88979),Ii=n(70289);const Ai={tableContainer:{horizontalScroll:"auto"},table:{minWidth:Pt.L.spacingHorizontalXXL},headerCell:{alignItems:"center"},subItemCell:{paddingLeft:Pt.L.spacingHorizontalXXL}},Pi=(0,mt.n)(Ai),ki=({data:e})=>{const t=Pi(),[n,r]=(0,N.useState)(new Set);return N.createElement("div",{className:t.tableContainer},N.createElement(si.X,{className:t.table},N.createElement(Ei.A,null,N.createElement(ai.H,null,N.createElement(xi.M,{className:t.headerCell},"Feature Name"),N.createElement(xi.M,{className:t.headerCell},"Seen"),N.createElement(xi.M,{className:t.headerCell},"Tried"),N.createElement(xi.M,{className:t.headerCell},"Kept"))),N.createElement(ii.B,null,e.map((e=>N.createElement(N.Fragment,{key:e.verbName},N.createElement(ai.H,null,N.createElement(oi.n,null,N.createElement(ct.$,{icon:n.has(e.verbName)?N.createElement(Ii.rLf,null):N.createElement(Ii.nb6,null),appearance:"subtle",onClick:()=>{return t=e.verbName,void r((e=>{const n=new Set(e);return n.has(t)?n.delete(t):n.add(t),n}));var t}}),e.verbName)),n.has(e.verbName)&&e.featureItems.map((e=>N.createElement(ai.H,{key:e.featureName},N.createElement(oi.n,{className:t.subItemCell},e.featureName),N.createElement(oi.n,null,e.seen),N.createElement(oi.n,null,e.tried),N.createElement(oi.n,null,e.kept))))))))))},Ti=({isModalOpen:e,setIsModalOpen:t,stkLogObject:n})=>N.createElement($r.l,{open:e,onOpenChange:(e,n)=>{t(n.open)}},N.createElement(es.E,null,N.createElement(ts.R,null,N.createElement(ns.L,{action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":ti,icon:N.createElement(cs.Jtj,null)}))},ni),N.createElement(ss.C,null,n&&n.length>0&&N.createElement(ki,{data:n}))))),Di=e=>{const[t,n]=(0,N.useState)(!1),[r,s]=(0,N.useState)(!1),[i,a]=(0,N.useState)(!1),[o,l]=(0,N.useState)(!1),[c,u]=(0,N.useState)(!1),[d,h]=(0,N.useState)(!1),[p,g]=(0,N.useState)(!1),[m,f]=(0,N.useState)(!1),[y,v]=(0,N.useState)(!1),[b,C]=(0,N.useState)(!1),w=bi(),S=t=>e?.cipTree?t:"No CIP data yet. Wait or make sure file is unprotected",E=(e,t)=>{const n=t.currentTarget,r=S(e);n.removeAttribute("title"),setTimeout((()=>n.setAttribute("title",r)),0)};(0,N.useEffect)((()=>{g(e.showDebugInfoMessage)}),[e.showDebugInfoMessage]);const x=(0,Ot.Y$)(),I=(0,bs.fP)(),A=x.isRealtimeVoiceEnabled;(0,N.useEffect)((()=>{I.enableTracing()}),[]);return N.createElement("div",null,N.createElement(Cs.M,{className:w.toolbar},N.createElement(ws.$,null,N.createElement(Kr,{label:"Debug Menu",onChange:(e,t)=>{const r=t?.checked;n(r)},checked:t,disabled:!1})),t&&N.createElement(ws.$,null,N.createElement(Ss.I,{icon:N.createElement(Ds.tmO,null),onClick:()=>{const t=e.conversationLogObject&&e.conversationLogObject[0].optionSets?e.conversationLogObject[0].optionSets:$s;let n=`<ul> <li><strong>${Vs}:</strong> ${e.sessionId??ei} </li>\n    <li><strong>${qs}:</strong> ${e.sessionKey??ei} </li>\n    <li><strong>${Qs}:</strong> ${Ks}${e.sessionKey}</li>\n    <li><strong>${Gs}:</strong> ${e.appName}</li>\n    <li><strong>${Zs}: </strong> ${e.appPlatform}</li>\n    <li><strong>${Ys}: </strong> ${e.sdxVersion} </li>\n    <li><strong>${Ws}: </strong> ${t} </li></ul>`+"<br/> Please upload console and sydney logs from debug panel<br/>",r=`https://office.visualstudio.com/OC/_workitems/create/Bug?[System.Title]=[${e.appName}+Copilot]:&[System.Description]=${n}&[System.Area]=OC\\Office+AI+Exp\\Chat&[System.Tags]=UserFeedback`;r=r.replace(/\n/g,""),window.open(r,Xs)}}),N.createElement(Es.W,null,N.createElement(xs.c,{disableButtonEnhancement:!0},N.createElement(Is.I,{icon:N.createElement(cs.mZD,null),appearance:"subtle"})),N.createElement(As.b,null,N.createElement(Ps.c,null,N.createElement(ks.D,{onClick:()=>{l(!0)}},Hs),N.createElement(ks.D,{onClick:()=>{a(!0)}},Us)))),N.createElement(Es.W,null,N.createElement(xs.c,{disableButtonEnhancement:!0},N.createElement(Is.I,{icon:N.createElement(Ms.DxV,null),appearance:"subtle"})),N.createElement(As.b,null,N.createElement(Ps.c,null,N.createElement(Ts.v,null,N.createElement(ks.D,null,Os),N.createElement(ct.$,{icon:N.createElement(Er.wx,null),appearance:"subtle",onClick:async()=>{const t=e.getLogs?.(),n=new Blob([JSON.stringify(t)],{type:"application/json"}),r=window.URL.createObjectURL(n),s=document.createElement("a");s.href=r,s.download="consoleLogs-"+(e.conversationId??"")+".json",s.click()}}),N.createElement(ct.$,{icon:N.createElement(Ls.nwp,null),appearance:"subtle",onClick:()=>{s(!0)}})),N.createElement(Ts.v,null,N.createElement(ks.D,null,Ns),N.createElement(ct.$,{icon:N.createElement(Er.wx,null),appearance:"subtle",onClick:()=>{if(e?.conversationLogObject){const t=new Blob([JSON.stringify(e.conversationLogObject)],{type:"application/json"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="chatConversationLogs-"+(e.conversationId??"")+".json",r.click()}}}),N.createElement(ct.$,{icon:N.createElement(Ls.nwp,null),appearance:"subtle",onClick:()=>{u(!0)}})),N.createElement(Ts.v,null,N.createElement(ks.D,null,"Sydney Conversation Logs"),N.createElement(ct.$,{icon:N.createElement(Er.wx,null),appearance:"subtle",onClick:()=>{if(e?.sydneyConversationObject){const t=new Blob([JSON.stringify(e.sydneyConversationObject)],{type:"application/json"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="chatHistory-"+(e.conversationId??"")+".json",r.click()}}}),N.createElement(ct.$,{icon:N.createElement(Ls.nwp,null),appearance:"subtle",onClick:()=>{h(!d)}})),A&&N.createElement(Ts.v,null,N.createElement(ks.D,null,"Realtime voice client trace"),N.createElement(ct.$,{icon:N.createElement(Er.wx,null),appearance:"subtle",onClick:()=>{I.tracer?.downloadCsv()}})),e?.isCipTreeDebugEnabled&&N.createElement(Ts.v,null,N.createElement(ks.D,null,_s),N.createElement(ct.$,{icon:N.createElement(Er.wx,null),appearance:"subtle",onClick:async()=>{if(e?.cipTree){const t=new Blob([JSON.stringify(e.cipTree)],{type:"application/json"}),n=window.URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="cipTree-"+(e.conversationId??"")+".json",r.click()}}}),N.createElement(ct.$,{icon:N.createElement(Ls.nwp,null),appearance:"subtle",onClick:()=>{f(!0)},onMouseEnter:e=>{E(Fs,e)},title:S(Fs)}),N.createElement(ct.$,{icon:N.createElement(Ls.vS8,null),appearance:"subtle",onClick:()=>{const t="https://ciptreevisualizerapp.azurewebsites.net";if(e?.cipTree){const n=JSON.stringify(e.cipTree),r=window.open(t,"_blank"),s=setInterval((()=>{r&&(r.postMessage(n,t),clearInterval(s))}),100)}},onMouseEnter:e=>{E(Bs,e)},title:S(Bs)})),e?.stkLogObject&&N.createElement(Ts.v,null,N.createElement(ks.D,null,ni),N.createElement(ct.$,{icon:N.createElement(Ls.nwp,null),appearance:"subtle",onClick:()=>{v(!0)}})),e?.ashaLogObject&&N.createElement(Ts.v,null,N.createElement(ks.D,null,ri),N.createElement(ct.$,{icon:N.createElement(Ls.nwp,null),appearance:"subtle",onClick:()=>{C(!0)}}))))),N.createElement(Es.W,null,N.createElement(xs.c,{disableButtonEnhancement:!0},N.createElement(Is.I,{icon:N.createElement(Ls.ebB,null),appearance:"subtle"})),N.createElement(As.b,null,N.createElement(Ps.c,null,N.createElement(ks.D,{onClick:()=>{window.open(e.augloopKustoQueryURL??"",Xs)}},zs),N.createElement(ks.D,{onClick:()=>{window.open(e.clientKustoQueryURL??"",Xs)}},js)))))),d&&e?.telemetryData&&N.createElement(fs,{telemetryData:e?.telemetryData,isModalOpen:d,setIsModalOpen:h}),r&&N.createElement(fi,{isModalOpen:r,setIsModalOpen:s,getLogs:e.getLogs}),o&&N.createElement(Si,{isModalOpen:o,setIsModalOpen:l,sessionId:e.sessionId,conversationLogObject:e.conversationLogObject,appName:e.appName,appPlatform:e.appPlatform,augloopKustoQueryURL:e.augloopKustoQueryURL,clientKustoQueryURL:e.clientKustoQueryURL,sdxVersion:e.sdxVersion,sessionKey:e.sessionKey,conversationId:e.conversationId}),i&&N.createElement(Ci,{isModalOpen:i,setIsModalOpen:a,chatInputLoadTime:e.chatInputLoadTime,chatPaneLoadTime:e.chatPaneLoadTime,chatHistoryLoadTime:e.chatHistoryLoadTime,taskPaneLoadTime:e.taskPaneLoadTime}),c&&N.createElement(mi,{isModalOpen:c,setIsModalOpen:u,conversationLogObject:e.conversationLogObject}),y&&N.createElement(Ti,{isModalOpen:y,setIsModalOpen:v,stkLogObject:e.stkLogObject}),b&&N.createElement(di,{isModalOpen:b,setIsModalOpen:C,ashaLogObject:e.ashaLogObject}),p&&N.createElement(yi,{isModalOpen:p,setIsModalOpen:e?.setShowDebugInfoOnMessage??g,debugMessageInfoObject:e.debugMessageInfoObject}),m&&N.createElement(gi,{isModalOpen:m,setIsModalOpen:f,cipTree:e.cipTree}))};var Mi=n(54630),Li=n(11604),Ri=n(11112),Ni=n(90480),Oi=n(23559),_i=n(27439);const Bi={restrictiveSearchMessageBodyText:ut.wOW,restrictiveSearchMessageTitleText:ut.Uno,restrictiveSearchLearnMoreString:ut.Y$l},Fi=({handleRestrictiveMsgDismissClick:e})=>{const[t,n]=N.useState(!0),r=N.useRef(null),s=(0,it.kQ)(Bi),i=()=>{n(!t)};return N.createElement(Ri.y,null,N.createElement(Ni.n,{intent:"info",ref:r},(()=>{if(t){const e=Math.round(.2*r.current?.offsetWidth);let t=s.restrictiveSearchMessageTitleText(),n=s.restrictiveSearchMessageBodyText();if(t.length<e){const r=e-t.length;n=n.substring(0,r)+"..."}else t=t.substring(0,e),n="...";return N.createElement(Mi.R,null,N.createElement(Li.V,null,t),n)}return N.createElement(Mi.R,null,N.createElement(Li.V,null,s.restrictiveSearchMessageTitleText()),s.restrictiveSearchMessageBodyText(),ir.HY,N.createElement(wi.N,{href:"https://go.microsoft.com/fwlink/p/?linkid=2260808"},s.restrictiveSearchLearnMoreString()))})(),N.createElement(Oi.Q,{containerAction:N.createElement("div",null,N.createElement(ct.$,{appearance:"transparent",icon:t?N.createElement(Ii.geq,null):N.createElement(Ii.nbk,null),onClick:i}),N.createElement(ct.$,{appearance:"transparent",icon:N.createElement(_i.BEt,null),onClick:e}))})))};var Ui=n(23268),Hi=n(30962);const zi=["Step 1","Step 2","Step 3","Step 4","Step 5"],ji=N.memo((({overrideStyles:e,stages:t,gotoNextStageString:n,index:r,lastEnabledStep:s,handleButtonClick:i,allowForwardNavigation:a=!1,displayStatusIcon:o=!0})=>{const l=(0,Hi.q)();(0,dt.bt)(l,e);const[c,u]=(0,N.useState)(0),[d,h]=(0,N.useState)(!1),[p,g]=(0,N.useState)(!0),m=t||zi,f=()=>{h(!d)},y=(e,t,n={})=>{const r=(0,Un.A)(t,e);return N.createElement(r,{style:n})};return(0,N.useEffect)((()=>{u(r)}),[r]),N.createElement(_n.g,{className:l.root,"aria-labelledby":m[0],style:{backgroundColor:"#ecf3fc",margin:"0px",borderRadius:"0px",boxShadow:"none",position:"fixed",width:"-webkit-fill-available",zIndex:"2"}},N.createElement(ht.W,null,N.createElement(ct.$,{size:"large",role:dt.eg.MENU_ITEM,key:c,disabled:!1,"aria-posinset":1,"aria-setsize":m[c]?.length,className:l.userContentButton,style:{backgroundColor:"#ebf3fc",border:"none",padding:"0px 10px",height:"fit-content",display:"flex",justifyContent:"space-between"}},N.createElement("div",{style:{display:"flex",alignItems:"left"}},N.createElement("b",null," ",m[c]),N.createElement("div",{onClick:()=>{f()},style:{paddingLeft:"8px"}},d?y(Ii.nbk,Ii.XYO):y(Ii.geq,Ii.aj1))),p&&N.createElement("div",{style:{display:"flex",alignItems:"right"}},N.createElement(ct.$,{onClick:()=>{(e=>{u(e),i(e),e===m.length-1?g(!1):g(!0)})(c+1)}},n[c+1]?n[c+1]:"Go to next step",y(Ii.V1C,Ii.V1C))))),d&&N.createElement("div",{style:{overflow:"auto",maxHeight:"100vh"}},N.createElement(ht.W,{style:l.workflowStepStack},m.map(((e,t)=>N.createElement(ct.$,{size:"large",role:dt.eg.MENU_ITEM,key:t,disabled:!1,"aria-posinset":t+1,"aria-setsize":e.length,className:l.userContentButtonItem,onClick:()=>{(t<=s||a)&&(e=>{u(e),h(!d),i(e),e===m.length-1?g(!1):g(!0)})(t)},icon:o&&(t<s?y(Ui.RaO,Ui.RaO,{color:"green"}):t===s?y(Ii.YmK,Ii.EgI,{color:"black"}):y(Ii.s81,Ii.Kni,{color:"black"})),style:{border:"none",borderRadius:"8px",boxShadow:t===c?"0 0 2px rgba(0,0,0,0.12), 0 2px 4px rgba(0,0,0,0.14)":"none",justifyContent:"flex-start"}},t===c?N.createElement("b",null,e):e))))))}));var Vi=n(74727);const qi={loader:{display:"inline",...gt.Pt.padding("0px"),...gt.Pt.borderRadius("12px")},progressBarStyle:{height:"4px"},stackStopText:{display:"flex"}},Wi=(0,mt.n)(function(e){return{root:e.root??{},loader:e.loader??{},loaderHighContrast:{},progressBarStyle:e.progressBarStyle??{},headerStyle:e.headerStyle??{},stopButtonStyle:e.stopButtonStyle??{},stopButtonIconStyle:e.stopButtonIconStyle??{},inlineStopIcon:e.inlineStopIcon??{},stackStopText:e.stackStopText??{}}}(qi)),Qi=(0,pt.Q)(ft.tR),Gi={root:{alignItems:"center",...gt.Pt.margin(Qi.spacingVerticalNone,Qi.spacingHorizontalNone,Qi.spacingVerticalM),...gt.Pt.gap(Qi.spacingVerticalM)},loader:{minHeight:"48px",backgroundColor:Qi.neutralLight,boxShadow:Qi.shadow4,transformOrigin:"bottom",width:"100%",...gt.Pt.overflow("hidden"),...gt.Pt.borderRadius(Qi.borderRadiusXLarge)},loaderHighContrast:{...gt.Pt.border("1px","solid",Qi.neutralLighterAlt)},progressBarStyle:{backgroundImage:`linear-gradient(90.5deg, ${Qi.themeLight} 10%, ${Qi.themeDarkAlt} 32%, ${Qi.themeLighterAlt} 55%, ${Qi.themeLighter} 72%, ${Qi.neutralLighter} 100%)`,backgroundColor:Qi.neutralLight,height:"100%","@media screen and (prefers-reduced-motion: reduce)":{maxWidth:"100%",width:"100%",animationIterationCount:"infinite",animationDuration:"3s",animationName:{"0%":{opacity:".2"},"50%":{opacity:"1"},"100%":{opacity:".2"}}}},headerStyle:{fontWeight:Qi.fontWeightSemibold,...gt.Pt.padding(Qi.spacingVerticalM),lineHeight:"143%",color:Qi.neutralPrimary},stopButtonStyle:{fontFamily:Qi.fontFamilyBase,fontSize:Qi.fontSizeBase200,width:"fit-content","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},[`&:hover .${jn.h.icon}`]:{color:Qi.themePrimary},[`&:hover:active .${jn.h.icon}`]:{color:Qi.themePrimary}},stopButtonIconStyle:{},stackStopText:{},inlineStopIcon:{...gt.Pt.padding("10px"),...gt.Pt.margin(Qi.spacingVerticalNone,Qi.spacingHorizontalNone,Qi.spacingVerticalNone,Qi.spacingHorizontalS),...gt.Pt.border("0px"),height:"44px",width:"44px",[`&:hover .${jn.h.icon}`]:{color:Qi.themePrimary},[`&:hover:active .${jn.h.icon}`]:{color:Qi.themePrimary},"@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}}},Zi=(0,mt.n)(Gi);var Yi=n(65916);const Ki={root:{alignItems:"center",...gt.Pt.margin(Yi.L.spacingVerticalNone,Yi.L.spacingHorizontalNone,Yi.L.spacingVerticalM),...gt.Pt.gap(Yi.L.spacingVerticalM)},loader:{minHeight:"48px",backgroundColor:Yi.L.colorNeutralBackground1,boxShadow:Yi.L.shadow4,transformOrigin:"bottom",width:"100%",...gt.Pt.overflow("hidden"),...gt.Pt.borderRadius(Yi.L.borderRadiusXLarge)},loaderHighContrast:{...gt.Pt.border("1px","solid",Yi.L.colorNeutralBackground1)},progressBarStyle:{backgroundImage:`linear-gradient(90.5deg, var(--chatLoadColorBrandFlair1) 10%,  var(--chatLoadColorBrandFlair2) 32%,  var(--chatLoadColorBrandFlair3) 55%, var(--chatLoadColorBrandFlair4) 72%, ${Yi.L.colorNeutralBackground6} 100%)`,backgroundColor:"white",height:"100%","@media screen and (prefers-reduced-motion: reduce)":{maxWidth:"100%",width:"100%",animationIterationCount:"infinite",animationDuration:"3s",animationName:{"0%":{opacity:".2"},"50%":{opacity:"1"},"100%":{opacity:".2"}}}},headerStyle:{fontWeight:Yi.L.fontWeightSemibold,...gt.Pt.padding(Yi.L.spacingVerticalM),lineHeight:"143%",color:Yi.L.colorNeutralForeground1},stopButtonStyle:{fontFamily:Yi.L.fontFamilyBase,fontSize:Yi.L.fontSizeBase200,width:"fit-content","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},[`&:hover .${jn.h.icon}`]:{color:Yi.L.colorBrandBackground4Static},[`&:hover:active .${jn.h.icon}`]:{color:Yi.L.colorBrandBackground4Static}},stopButtonIconStyle:{},stackStopText:{},inlineStopIcon:{...gt.Pt.padding("10px"),...gt.Pt.margin(Yi.L.spacingVerticalNone,Yi.L.spacingHorizontalNone,Yi.L.spacingVerticalNone,Yi.L.spacingHorizontalS),...gt.Pt.border("0px"),height:"44px",width:"44px",[`&:hover .${jn.h.icon}`]:{color:Yi.L.colorBrandBackground4Static},[`&:hover:active .${jn.h.icon}`]:{color:Yi.L.colorBrandBackground4Static},"@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:focus":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}}}},Ji=(0,mt.n)(Ki),Xi={loadingUiTextID:ut.qd3,stopGeneratingButtonText:ut.JrD},$i=N.memo((({stylesToOverride:e,loadingUiStrings:t,stringChangeIntervalDuration:n=3500,showStopButton:r=!1,showInlineStopButton:a=!1,handleStopButtonOnClick:o,isAutoScrollingEnabled:c})=>{const u=(0,l.R2)(),d=(()=>{const e=(0,it.kQ)(Xi),t="ProgressBar";return N.useMemo((()=>({...e,progressBarTitleText:()=>t})),[e,t])})(),h=(()=>{const e=Zi(),t=Wi();(0,i.xp)()===s.Y.IOS&&(0,dt.bt)(e,t);return e})(),p=(()=>{const e=Ji(),t=Wi();(0,i.xp)()===s.Y.IOS&&(0,dt.bt)(e,t);return e})(),g=(0,Ot.Y$)(),m=(0,l.kF)()?p:h;(0,dt.bt)(m,e);const f=(0,Bt.z)(m.loaderHighContrast,m.loader),[y,v]=(0,N.useState)(0),b=(0,N.useRef)(null);(0,N.useEffect)((()=>{r&&null!==b.current&&c&&c()&&b.current.focus()}),[c,r]),(0,N.useEffect)((()=>{v(0)}),[JSON.stringify(t)]),(0,N.useEffect)((()=>{const e=setInterval((()=>{const n=y+1;n===t.length?clearInterval(e):v(n)}),n);return()=>clearInterval(e)}),[y,n,t.length]);return N.createElement(ht.W,{style:m.root},N.createElement(ht.W,{style:u?f:m.loader,customProperties:{role:dt.eg.ALERT,"aria-live":"assertive","aria-atomic":!0}},N.createElement(ht.W,{horizontal:!0,style:m.stackStopText},!g.enableStopGeneratingButtonInChatInput&&a&&N.createElement(ct.$,{appearance:"subtle",className:m.inlineStopIcon,icon:N.createElement(cs.rsL,null),onClick:o,"aria-label":d.stopGeneratingButtonText(),title:d.stopGeneratingButtonText()}),N.createElement(Fn.E,{id:d.loadingUiTextID(),className:m.headerStyle},t[y])),N.createElement(At.z,{bar:{className:m.progressBarStyle},role:"none",thickness:"large",shape:"rounded",title:d.progressBarTitleText()})),!g.enableStopGeneratingButtonInChatInput&&r&&N.createElement(ct.$,{appearance:"subtle",className:m.stopButtonStyle,icon:N.createElement(Vi.p9J,null),ref:b,onClick:o,size:"small","aria-live":"assertive",id:"stop-generating-button"},d.stopGeneratingButtonText()))}));var ea;!function(e){e.NEXT_STAGE="NextStage",e.NEXT_CARD="NextCard",e.OPEN_EDITOR="OpenEditor",e.ADD_TOPIC="AddTopic"}(ea||(ea={}));var ta=n(9371),na=n(51471),ra=n(58651);const sa=N.forwardRef((({overrideStyles:e,messageButtonContent:t,headerText:n,addActionButtonProps:r,handleEditorOpenButtonClick:s,buttonText:i="Start Generating",buttonTextInEnabledState:a="",buttonTextInDisabledState:o="",buttonRole:c,enableCheckBox:u=!0,cardIndex:d=0,allowItemAddition:h=!1,dialogTitle:p="New Entry",onSelectCheckBox:g=(e,t)=>{},handleOnClickItemAddition:m=e=>{},handleButtonClick:f=e=>{},handleClientButtonClick:y=e=>{},shouldDisableButtonAtBottom:v=!1},b)=>{const C=(0,Hi.q)(),w=(0,l.R2)(),S=a||i,E=o||i,x=(0,it.Lh)(ut.jO8);(0,dt.bt)(C,e),C.userContentButtonDisabled=(0,Bt.z)(C.userContentButton,C.userContentButtonDisabled),C.rootHighContrast=(0,Bt.z)(C.root,C.rootHighContrast);const[I,A]=(0,N.useState)(t),[P,k]=(0,N.useState)(!0),[T,D]=(0,N.useState)(S),[M,L]=(0,N.useState)(!1),[R,O]=(0,N.useState)(""),_=(0,An.Mb)().hostAppSettings.window??window,B=e=>{L(!0),m(e)},F=(e,t=!0)=>{const n=[...I],r=[...z];n.length>0&&n[n.length-1].isAddItemButton?(n.splice(n.length-1,0,e),r.splice(r.length-1,0,t)):(n.push(e),r.push(t)),g(t,e.boldText??""),A(n),j(r)};(0,N.useImperativeHandle)(b,(()=>({addUserContentMessageItem(e,t=!0){F(e,t)}})));const U=(e,t,n={})=>{const r=(0,Un.A)(t,e);return N.createElement(r,{style:n})},H=new Array(t?.length).fill(!1),[z,j]=(0,N.useState)(H);return N.createElement(_n.g,{className:w?C.rootHighContrast:C.root,"aria-labelledby":x},n&&N.createElement(Hn.l,null,N.createElement(Fn.E,{id:x,className:C.cardHeader},n)),I&&N.createElement(ht.W,{style:C.buttonStack,customProperties:{role:dt.eg.MENU}},I.map(((e,t)=>N.createElement(ct.$,{size:"large",role:dt.eg.MENU_ITEM,key:t,disabled:e.isDisabled,"aria-posinset":t+1,"aria-setsize":I.length,className:e.isDisabled?C.userContentButtonDisabled:C.userContentButton,style:e.isAddItemButton?{borderBlockStyle:"dashed"}:{},onClick:()=>{e.onSelectButton&&e.onSelectButton(),e.isAddItemButton&&B()}},N.createElement("div",{style:{display:"flex",alignItems:"center"}},u&&!e.isAddItemButton&&N.createElement("div",{onClick:()=>{const n=(e=>{const t=[...z];return t[e]=!t[e],j(t),k(!0),D(S),t[e]})(t);e.onSelectCheckBox&&e.onSelectCheckBox(n,e.boldText),g&&g(n,e.boldText)}},z[t]?U(Ii.BPd,Ii.BPd,{color:"green"}):U(Vi.Scu,Vi.Scu)),e.iconUrl&&N.createElement("img",{className:C.thumbnail,src:e.iconUrl,alt:"",height:20,width:20}),e.boldText?N.createElement("div",null,N.createElement("p",{className:C.leftAlignedText,title:e.buttonHyperLinkToolTip?e.buttonHyperLinkToolTip:"",onClick:e.buttonHyperLink?()=>_.open(e.buttonHyperLink,"_blank"):()=>ra.log("Link not available for button")},N.createElement("b",null," ",e.boldText," ")," ",e.message)):N.createElement("p",null,e.message))))),N.createElement($r.l,{modalType:"modal",open:M},N.createElement(es.E,{className:C.root,tabIndex:0},N.createElement(ts.R,null,N.createElement(ns.L,{className:C.buttonStack,action:N.createElement(rs.z,{action:"close"},N.createElement(ct.$,{appearance:"subtle","aria-label":"close",icon:N.createElement(cs.Jtj,null),onClick:()=>L(!1)}))},p??"Add Item"),N.createElement(ss.C,null,N.createElement(ta.A,{onChange:(e,t)=>O(t),className:C.root,styles:{fieldGroup:{borderColor:"transparent"}}})),N.createElement(na.i,{className:C.buttonStack},N.createElement(ct.$,{className:C.buttonStack,appearance:"primary",onClick:()=>{if(t.length-2<0||0===R.length)return;const e={boldText:R};L(!1),F(e,!0)}},"Submit")))))),N.createElement(ht.W,{horizontal:!0,style:C.actionButtonStack},r&&N.createElement(Hn.l,null,N.createElement(ct.$,{appearance:r.appearance??void 0,onClick:()=>{r.isEditorNeedToOpen?s&&s():B()}},r.text)),i.length>0&&N.createElement(Hn.l,null,N.createElement(ct.$,{appearance:c??void 0,disabled:!P||I?.length>0&&u&&!z.some((e=>e)),onClick:()=>{var e;v||(e=d,k(!1),D(E),f&&f(e),y&&y(e))}},T))))})),ia=N.memo(sa),aa=N.forwardRef((({onClickNextStage:e=e=>{},onClickNext:t=e=>{},stageIndex:n=1,data:r={}},s)=>{let i=r?.componentRenderData;const a=(0,N.useRef)();return(0,N.useImperativeHandle)(s,(()=>({addUserContentMessageItem(e,t){a.current?.addUserContentMessageItem(e,t)}}))),N.createElement(ht.W,null,i.map(((r,s)=>(r.handleButtonClick=()=>{t(n),e(n)},N.createElement(ia,{ref:a,key:s,cardIndex:1,...r})))))})),oa=N.forwardRef((({stageHeader:e,onClientInteractionData:t=e=>{},getComponentRenderData:n=e=>{},shouldEnableNext:r=()=>!1,onClickNext:s=e=>{},isHTMLEditorUpdateRequired:i=!1,stageIndex:a=0,onClickNextStage:o=e=>{},data:l={}},c)=>{const u=function(e){let t=0;for(const n of e){if(n.buttonAction==ea.NEXT_CARD)return t;t++}return t}(l?.componentRenderData),d=new Set,h=N.useRef(),[p,g]=N.useState(d);N.useImperativeHandle(c,(()=>({addUserContentMessageItem(e,t){h.current?.addUserContentMessageItem(e,t)}})));const[m,f]=N.useState(u),y=e=>{if(f(e+1),t){const e=[...p];t(e)}};let v=l?.componentRenderData?l?.componentRenderData:[];return N.createElement(ht.W,null,v.map(((e,t)=>{let n={...e};if(n.onSelectCheckBox=(e,t)=>{((e,t)=>{const n=new Set(p);n.has(t)&&!e?n.delete(t):!n.has(t)&&e&&n.add(t),g(n)})(e,t)},e.buttonAction===ea.NEXT_STAGE?n.handleButtonClick=()=>{s(a),o(a)}:e.buttonAction===ea.NEXT_CARD&&(n.handleButtonClick=()=>y(t)),t<=m)return N.createElement(ia,{ref:h,key:t,cardIndex:a,...n})})))})),la=N.forwardRef((({workflowName:e="Default Workflow",workflowStages:t=[],handleEditorOpenButtonClick:n,enableALSession:r=!1,workflowLoadingUiStrings:s=["Working on it..."],allowForwardNavigation:i=!1,displayStatusIconInStepper:a=!0},o)=>{const[l,c]=N.useState(0),[u,d]=N.useState(!0),[h,p]=N.useState(0),g=N.useRef(),m=N.useRef(),f=(0,An.Mb)().hostAppSettings.window??window;N.useImperativeHandle(o,(()=>({addUserContentMessageItem(e,t){u?g.current?.addUserContentMessageItem(e,t):m.current?.addUserContentMessageItem(e,t)}}))),N.useEffect((()=>{t.map(((e,t)=>{e.data?.componentRenderData&&e.data?.componentRenderData?.map(((e,t)=>{e.addActionButtonProps&&e.addActionButtonProps?.isEditorNeedToOpen&&(e.handleEditorOpenButtonClick=n)}))}))})),N.useEffect((()=>{l>h&&p(l)}),[l,h]),N.useEffect((()=>{}),[l]);const[y,v]=N.useState(!1);N.useEffect((()=>{y&&(t[l].shouldEnableNext&&t[l].shouldEnableNext()?v(!1):r||f.setTimeout((()=>{v(!1)}),2e3))}));const b=e=>{v(!0),t[e+1]?.getComponentRenderData&&t[e+1]?.getComponentRenderData(),c(e)},C=e=>{S[l]?.onClickNext&&S[l].onClickNext(e),e>l&&(v(!0),t[e+1]?.getComponentRenderData&&t[e+1]?.getComponentRenderData()),c(e)},w={loadingUiStrings:s},S=t.slice(1),E=function(e){const t=[];return e.forEach(((e,n)=>{t.push(e.useCompleteStageHeader?e.stageHeader:"Step "+(n+1)+": "+e.stageHeader)})),t}(S),x=t.map((e=>e.gotoNextStageString)),I=t[0];return I.onClickNextStage=()=>{d(!1)},I.stageIndex=0,u?N.createElement(ht.W,null,N.createElement(aa,{ref:g,...I})):N.createElement(ht.W,null,N.createElement("div",{style:{height:"46px"}}),N.createElement(ji,{stages:E,gotoNextStageString:x,handleButtonClick:C,index:l,lastEnabledStep:h,allowForwardNavigation:i,displayStatusIcon:a}),S.map(((e,t)=>{if(t===l){if(y)return N.createElement($i,{key:t,...w});{const n=e;return e.stageIndex=t+1,e.onClickNextStage=b,N.createElement(oa,{ref:m,key:t,...n})}}})))}));var ca=n(88482),ua=n(2437);const da=(0,pt.Q)(ft.zQ),ha={root:{...gt.Pt.overflow("visible"),backgroundColor:"inherit","@media (forced-colors: none)":{"&:hover":{backgroundColor:da.colorNeutralBackground3Hover},"&:hover:active":{backgroundColor:da.colorNeutralBackground3Hover}}}},pa={root:{...gt.Pt.border("none")}},ga=(0,mt.n)(ha),ma=(0,mt.n)(pa),fa=(0,pt.Q)(ft.zQ),ya={ShowChatHistoryAllButton:{...gt.Pt.margin("0px",fa.spacingHorizontalL),"&:disabled":{...gt.Pt.borderColor(fa.neutralPrimaryAlt),color:fa.neutralQuaternary,backgroundColor:fa.neutralTertiary}},ShowChatHistoryButtonInSwitcherMenu:{justifyContent:"space-between",alignItems:"center",width:"100%",height:"32px",display:"flex",padding:"0px"},ShowChatHistoryButtonInSwitcherMenuLeftContainer:{display:"flex",alignItems:"center",...gt.Pt.padding("0px","0px","0px","6px"),fontWeight:fa.fontWeightRegular},ShowChatHistoryMenuIcon:{...gt.Pt.padding("0px","4px","0px","0px")},ShowChatHistoryIcon:{fontSize:fa.fontSizeBase500,marginRight:fa.spacingHorizontalXS}},va=(0,mt.n)(ya),ba=(N.memo((({onClick:e,customStyles:t,fromGoBackButton:n,setFromGoBackButton:r})=>{const s=(0,it.Lh)(ut.SGR),i=N.useRef(null);return N.useEffect((()=>{i.current&&n&&(i.current.focus(),r(!1))}),[]),N.createElement(ct.$,{className:(0,Bt.z)(ga().root,va().ShowChatHistoryButtonInSwitcherMenu,ma().root,t),onClick:e,"aria-label":s,role:"menu",ref:i},N.createElement("div",{className:(0,Bt.z)(va().ShowChatHistoryButtonInSwitcherMenuLeftContainer)},N.createElement(ua.tBH,{className:va().ShowChatHistoryIcon}),s),N.createElement(Ii.KOR,{className:va().ShowChatHistoryMenuIcon}))})),N.memo((({onClick:e,customStyles:t,customIconStyles:n,isDisabled:r})=>{const s=(0,it.Lh)(ut.SGR);return N.createElement(ct.$,{className:(0,Bt.z)(ga().root,va().ShowChatHistoryAllButton,t),icon:N.createElement(ca.nT,{className:n}),onClick:e,"aria-label":s,disabled:r},s)})));const Ca=(0,pt.Q)(ft.zQ),wa={CreditBalanceButton:{...gt.Pt.margin("0px",Ca.spacingHorizontalL),"&:disabled":{...gt.Pt.borderColor(Ca.neutralPrimaryAlt),color:Ca.neutralQuaternary,backgroundColor:Ca.neutralTertiary}}},Sa=(0,mt.n)(wa),Ea=N.memo((({onClick:e,customStyles:t,customIconStyles:n,isDisabled:r})=>{const s=ga().root,i=Sa().CreditBalanceButton,a=(0,it.Lh)(ut.nK3);return N.createElement(ct.$,{className:(0,Bt.z)(s,i,t),icon:N.createElement(_i.ALn,{className:n}),onClick:e,"aria-label":a,disabled:r},a)}));var xa=n(87115);n(58651);const Ia=N.createContext({overrideChatCardRenderer:e=>({message:e,cardRenderer:null})});var Aa=n(13390),Pa=n(44482),ka=n(66880),Ta=n(69808);const Da={stack:{flexFlow:"wrap"},accordionCardFooter:{fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontWeight:Pt.L.fontWeightRegular,fontSize:Pt.L.fontSizeBase200,lineHeight:Pt.L.lineHeightBase200,display:"flex",alignItems:"center",color:Pt.L.colorNeutralForeground1,columnGap:Pt.L.spacingHorizontalS,rowGap:Pt.L.spacingHorizontalS,flexDirection:"row",marginTop:Pt.L.spacingVerticalM,flexWrap:"wrap"},accordionCardButton:{height:"24px",minWidth:"20px",...gt.Pt.padding(Pt.L.spacingVerticalXS,Pt.L.spacingHorizontalS),...kt.g.caption1,backgroundColor:Pt.L.colorTransparentBackground,...gt.Pt.border(Pt.L.strokeWidthThin,"solid",Pt.L.colorNeutralStroke1),borderRadius:Pt.L.borderRadiusMedium}},Ma=(0,mt.n)(Da),La=(0,pt.Q)(ft.tR),Ra={stack:{flexFlow:"wrap"},accordionCardFooter:{fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontWeight:"400",fontSize:"12px",lineHeight:"16px",display:"flex",alignItems:"center",color:La.neutralPrimary,columnGap:"8px",rowGap:"8px",flexDirection:"row",marginTop:"12px",flexWrap:"wrap"},accordionCardButton:{height:"24px",minWidth:"20px",...gt.Pt.padding("4px","8px"),...kt.g.caption1,backgroundColor:La.neutralLight,...gt.Pt.border("1px","solid",La.neutralLighterAlt),...gt.Pt.borderRadius(La.borderRadiusMedium)}},Na=(0,mt.n)(Ra),Oa=({styles:e,cardButtons:t})=>{const n=(0,dt.bt)((()=>{const e=Na(),t=Ma();return(0,l.kF)()?t:e})(),e),r=(0,Ta.jd)(),s=(0,Bt.z)(r.defaultButton,r.combinedButton),i=(0,Bt.z)(s,n.accordionCardButton);return N.createElement(ht.W,{horizontal:!0,style:n.stack},N.createElement(ht.W,{horizontal:!0,style:n.accordionCardFooter},t?.map(((e,t)=>{const n=N.createElement(ct.$,{tabIndex:0,className:i,icon:e.icon,title:e.buttonTitle,onClick:e.handleButtonOnClick,disabled:e.isDisabled,onMouseEnter:e?.handleOnMouseEnter,onMouseLeave:e?.handleOnMouseLeave,onFocus:e?.handleOnMouseEnter,onBlur:e?.handleOnMouseLeave},e.buttonText);return e.popoverText&&e.popoverText.length>0?N.createElement(Pa.K,{key:e.buttonText,popoverDuration:ka.s,popoverTitle:e.popoverText},n):N.cloneElement(n,{key:e.buttonText})}))))};const _a=(0,mt.n)(function(e){return{stack:e.stack??{},contentCard:e.contentCard??{},contentHeader:e.contentHeader??{}}}({contentHeader:{fontFamily:"-apple-system",lineHeight:"normal"}})),Ba={stack:{"> *":{marginBottom:Pt.L.spacingVerticalM}},contentCard:{...gt.Pt.border(Pt.L.strokeWidthThin,"solid",Pt.L.colorNeutralStroke1),...gt.Pt.margin(Pt.L.spacingVerticalS,Pt.L.spacingVerticalXL,Pt.L.spacingVerticalS,"15px"),...gt.Pt.padding(Pt.L.spacingVerticalS),boxShadow:Pt.L.shadow4,backgroundColor:Pt.L.colorTransparentBackground,...gt.Pt.borderRadius(Pt.L.borderRadiusXLarge),overflowWrap:"anywhere",color:Pt.L.colorNeutralForeground1},contentHeader:{...kt.g.body1,marginBottom:Pt.L.spacingVerticalM}},Fa=(0,mt.n)(Ba),Ua=(0,pt.Q)(ft.tR),Ha={stack:{"> *":{marginBottom:"12px"}},contentCard:{...gt.Pt.border("1px","solid",Ua.neutralLighterAlt),...gt.Pt.margin("8px","20px","8px","15px"),...gt.Pt.padding("8px"),boxShadow:Ua.shadow4,backgroundColor:Ua.neutralLight,...gt.Pt.borderRadius(Ua.borderRadiusXLarge),overflowWrap:"anywhere",color:Ua.neutralPrimary},contentHeader:{...kt.g.body1,marginBottom:"12px"}},za=(0,mt.n)(Ha),ja=()=>{const e=za(),t=Fa(),n=(0,l.kF)()?t:e,r=_a();if((0,i.xp)()===s.Y.IOS)(0,dt.bt)(n,r);return e};function Va(e,t){return N.createElement(Oa,{styles:e,cardButtons:t})}const qa=({styles:e,body:t})=>{const n=(0,dt.bt)(ja(),e),r=t.renderHeader?t.renderHeader((()=>{})):t.cardContent?.contentHeader?N.createElement(Fn.E,{className:n.contentHeader},t.cardContent.contentHeader):void 0,s=()=>t.cardContent?.contentBody,i=t.renderBody?t.renderBody((()=>s(t.cardContent))):s(t.cardContent),a=t.renderFooter?t.renderFooter((()=>Va(e,t.cardContent?.cardButtons))):t.cardContent?.cardButtons?Va(e,t.cardContent?.cardButtons):void 0;return N.createElement(ht.W,{style:n.contentCard,customProperties:{tabIndex:-1}},r,i,a)},Wa=(0,pt.Q)(ft.tR),Qa=(0,mt.n)({accordionCardRoot:{paddingTop:"5px",marginBottom:"8px",fontFamily:'-apple-system, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',fontStyle:"normal",fontSize:"14px",fontWeight:"400",lineHeight:"20px"},accordionCard:{flexWrap:"wrap",backgroundColor:Wa.neutralLight,...gt.Pt.border("1px","solid",Wa.neutralLighterAlt),...gt.Pt.borderRadius("8px"),marginLeft:"15px",marginRight:"20px",...gt.Pt.gap("4px"),...gt.Pt.padding("8px"),boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)","> *":{marginBottom:"12px"}},cardHeader:{fontWeight:"600",fontSize:"16px",lineHeight:"22px",...gt.Pt.margin("12px 12px 0 12px")},contentHeader:{fontWeight:"600",fontSize:"16px",lineHeight:"22px",...gt.Pt.margin("4px")},contentTitleGroup:{display:"block",width:"auto","> button":{marginLeft:"10px",marginTop:"5px",width:"16px",height:"16px",color:Wa.black,top:"0",zIndex:"1",float:"right",selectors:{":hover":{backgroundColor:"transparent",color:Wa.black},":focus":{backgroundColor:"transparent",color:Wa.black}},"> i":{fontSize:"12px"}}}}),Ga=e=>{const t=e.index,n=N.useRef(),[r,s]=N.useState(!1),i=Qa(),a=e=>{s(!r),n.current?.focus(),e.stopPropagation(),e.preventDefault()},l={styles:e.styles,feedbackSectionPosition:o.O.None,shouldShowAIGeneratedIndicator:!0,body:{cardContent:e.cardContent,renderHeader:n=>{if(void 0===e.cardContent)return;const s=N.createElement(ct.$,{id:`RelatedQuestionExpand${t}`,icon:N.createElement(Ii.rLf,null),onClick:a,"data-is-focusable":!1,tabIndex:-1,"aria-label":""});return N.createElement(ht.W,null,N.createElement(ht.W,{style:(0,Bt.z)(i.contentTitleGroup,e.styles.contentTitleGroup)},N.createElement(Fn.E,{className:i.contentHeader},e.cardContent.contentHeader),s),r&&e.cardContent.contentBody?n():void 0)},renderBody:t=>{if(r&&e.cardContent.contentBody)return t()},renderFooter:t=>r&&e.cardContent.contentBody?t():null}};return N.createElement(qa,{key:t,styles:e.styles,...l})},Za=(e,t)=>{if(!t.cardContent.length)return null;try{if(1===t.cardContent.length){const n=()=>N.createElement(Fn.E,{className:e.contentHeader},t.cardContent[0].contentHeader),r={styles:e,feedbackSectionPosition:o.O.None,body:{cardContent:t.cardContent[0],renderHeader:n}};return N.createElement(ht.W,null,N.createElement(qa,{key:0,...r}))}return N.createElement(ht.W,null,t.cardContent.map(((t,n)=>N.createElement(Ga,{key:n,index:n,styles:e,cardContent:t}))))}catch(e){return null}},Ya=({styles:e,body:t})=>{const n=Qa(),r={role:dt.eg.LIST_ITEM,"aria-live":"assertive",tabIndex:0};return N.createElement(ht.W,{style:(0,Bt.z)(n.accordionCardRoot,e.accordionCardRoot),customProperties:r},N.createElement(ht.W,{style:(0,Bt.z)(n.accordionCard,e.accordionCard),customProperties:{tabIndex:-1}},N.createElement(ht.W,null,N.createElement(Fn.E,{className:n.cardHeader},t.cardHeader),Za(n,t))))};var Ka=n(91381);const Ja=(0,pt.Q)(ft.tR),Xa={adaptiveCardRoot:{...kt.g.body1,color:Ja.black,"& pre":{whiteSpace:"pre-wrap"},"& table,tr,td,th":{...gt.Pt.border("1px","solid",Ja.neutralQuaternaryAlt)},"& p":{display:"inline"},"& .ac-textBlock":{overflowWrap:"anywhere",display:"inline !important"},"& .ac-adaptiveCard":{display:"inline !important"}},...(0,Ka.mO)()},$a=(0,mt.n)(Xa);var eo=n(43003),to=n(44198),no=n(51991),ro=n(9348);const so=({message:e,title:t,occurance:n})=>N.createElement(N.Fragment,null,N.createElement("div",null,e),N.createElement("br",null),N.createElement(ht.W,{horizontal:!0},N.createElement(Hn.l,null,N.createElement(ro.CtC,null),N.createElement("span",null,t)),N.createElement(Hn.l,null,N.createElement(to.m,{disabled:!1,defaultValue:"Weekly"},["Daily","Weekly","Monthly"].map((e=>N.createElement(no.c,{text:e,key:e},N.createElement(ht.W,{horizontal:!0},N.createElement(rr.uEE,null),e))))))),N.createElement("br",null));var io=n(20170),ao=n(7751),oo=n(37744),lo=n(20961),co=n(65136),uo=n(97006),ho=n(97574);const po=({id:e,openItem:t,icon:n,title:r,taskProperties:s})=>{let i=null;return i="People"===n?N.createElement(ho.ymm,null):"Word"===n?N.createElement(cs.f7e,null):"PowerPoint"===n?N.createElement(Vi.alc,null):"Mail"===n?N.createElement(ca.JQC,null):N.createElement(rr.E82,null),N.createElement(as.A,{value:e,style:{boxShadow:"0 0 3px #ccc"}},N.createElement(os.u,{size:"large",expandIcon:null},N.createElement(ao.a,{image:i,header:N.createElement(lt.c,null,r),action:s?N.createElement(ct.$,{appearance:"transparent",style:{alignItems:"left"},icon:t===e?N.createElement(_i.LKJ,null):N.createElement(_i.yuG,null),"aria-label":"More options"}):null})),N.createElement(ls.v,null,s?s.map((t=>{if("People"===t.type){const n=t.value.split(",");return N.createElement(N.Fragment,{key:t.name},N.createElement("div",null,t.name),n.map((t=>{const n=t.split("@")[0];return N.createElement(oo.v,{key:e+n,shape:"circular",media:N.createElement(lo.e,{name:n})},n)})),N.createElement("br",null))}return"Date"===t.type?N.createElement(co.D,{label:t.name,key:e+"_Due_on"},N.createElement(io.l,{showWeekNumbers:!0,firstWeekOfYear:1,showMonthPickerAsOverlay:!0,placeholder:"Select a date..."})):N.createElement(N.Fragment,{key:t.name},N.createElement(co.D,{label:t.name,id:t.name},N.createElement(uo.T,{id:t.value,value:t.value})),N.createElement("br",null),N.createElement("br",null))})):null))},go=({styles:e,body:t})=>{const[n,r]=N.useState(-1),s=N.useCallback(((e,t)=>{r(t.value)}),[]),i=N.createElement("div",null,N.createElement(is.n,{onToggle:s},t.tasks.map(((e,t)=>N.createElement(N.Fragment,{key:t},N.createElement(po,{id:t,openItem:n,icon:e.icon,title:e.title,taskProperties:e.taskProperties}),N.createElement("br",null))))));return N.createElement("div",{style:{backgroundColor:"transparent"}},N.createElement(so,{message:t.chatMessage,title:"Agent Plan",occurance:"Weekly"}),i,N.createElement(eo.Y,{text:"Start Task",onClick:t.handleStartClicked.bind(t,t.tasks)}))};function mo({renderData:e,fallbackElement:t,customMessageRenderers:n}){if(!e||!n)return N.createElement(N.Fragment,null,t);const r=n.renderers[e.component];return r?N.createElement(r,{...e.props}):n.renderFallback(e)}const fo=N.memo(mo,((e,t)=>e.copilotThemeInfo?.isDarkTheme===t.copilotThemeInfo?.isDarkTheme&&e.copilotThemeInfo?.isHighContrast===t.copilotThemeInfo?.isHighContrast&&e.renderData?.props===t.renderData?.props&&!!e.renderData?.shouldMemoizeComponent&&!!t.renderData?.shouldMemoizeComponent));var yo=n(66313),vo=n(52997),bo=n(61714),Co=n(89244),wo=n(54725),So=n(28422),Eo=n(46555);const xo={root:{columnGap:"4px",rowGap:"4px",flexDirection:"row",flexWrap:"wrap",alignItems:"center",paddingBottom:"8px"},icon:{width:"16px",height:"16px",borderRadius:"4px"},name:{color:Pt.L.colorNeutralForeground3}},Io=(0,mt.n)(xo),Ao=({name:e,icon:t,iconUrl:n})=>{const r=Io();return N.createElement(ht.W,{horizontal:!0,style:r.root},t&&(e=>{const t=e;return N.createElement(t,{className:r.icon})})(t),n&&N.createElement(at._,{src:n,alt:e,className:r.icon}),N.createElement(Eo.T,{className:r.name},e))};var Po=n(42570),ko=n(85389),To=n(77921),Do=n(34694),Mo=n(27373);const Lo={titleText:{fontFamily:"-apple-system",lineHeight:"normal"},popoverText:{fontFamily:"-apple-system",lineHeight:"normal"}},Ro=(0,mt.n)(function(e){const t=(e=>({titleText:e.titleText??{},popoverText:e.popoverText??{},headerStack:e.headerStack??{},icon:e.icon??{}}))(e);return t}(Lo)),No=(0,pt.Q)(ft.tR),Oo={titleText:{...kt.g.caption2,color:No.neutralSecondaryAlt,wordWrap:"break-word"},popoverText:{...kt.g.caption1,wordWrap:"break-word",...gt.Pt.margin("0px","12px")},headerStack:{alignItems:"center",...gt.Pt.gap("2px")},icon:{display:"grid",justifyItems:"center",alignItems:"center"}},_o=(0,mt.n)(Oo),Bo=(e,t)=>{if(t)for(const n in e)e[n]=(0,Bt.z)(e[n],t[n])},Fo=({styles:e,chatMessageHeaderData:t})=>{const n=(()=>{const e=_o(),t=Ro();(0,i.xp)()===s.Y.IOS&&Bo(e,t);return e})();return Bo(n,e),N.createElement(ht.W,{horizontal:!0,style:n.headerStack},N.createElement(Eo.T,{className:n.titleText},t.titleText),t.popoverText?N.createElement(Po.l,{closeOnScroll:!0,positioning:"below",size:"small",trapFocus:!0,withArrow:!0},N.createElement(ko.b,null,N.createElement("span",{className:n.icon},t.customPreviewIconRegular?t.customPreviewIconHover?((e,t)=>{const n=(0,Un.A)(e,t);return N.createElement(n,null)})(t.customPreviewIconHover,t.customPreviewIconRegular):N.createElement(t.customPreviewIconRegular,null):N.createElement(Do.c8N,null))),N.createElement(To.e,{tabIndex:-1},N.createElement(ht.W,{style:n.popoverText},N.createElement(Mo.$,{linkTarget:"_blank"},t.popoverText)))):null)};var Uo=n(59310),Ho=n(29930);var zo=n(14168),jo=n(39639),Vo=n(95299),qo=n(83159),Wo=n(40796),Qo=n(57863);const Go={paddingTop:"0px !important",paddingBottom:"0px !important",paddingLeft:"0px !important",paddingRight:"0px !important"},Zo="inherit",Yo="inherit",Ko=(0,Qo.Q)("ConfirmationCard",(0,mt.n)({root:Object.assign(Object.assign({},gt.Pt.overflow("hidden")),{"& .ac-container.ac-adaptiveCard":Object.assign({},Go)}),acContainerWithoutPadding:{"& .ac-container":Object.assign({},Go)},fluentProvider:{backgroundColor:Pt.L.colorTransparentBackground}})),Jo=(0,mt.n)({button:Object.assign(Object.assign(Object.assign({},gt.Pt.borderRadius("4px")),gt.Pt.borderWidth("1px")),gt.Pt.borderStyle("solid"))});function Xo(e){var t;const n=N.useMemo((()=>new qo.e),[]);N.useMemo((()=>{(0,g.n_x)(),Ho.oC.showBorderProperty.isSerializationEnabled=!0}),[]);const{cardData:r,serviceProvider:s,config:i}=e,a=null===(t=null==i?void 0:i.featureFlags)||void 0===t?void 0:t.enableNewUXForConfirmationDialog,o=Ko(),l=N.useMemo((()=>{const e=(0,jo.N)(null==i?void 0:i.themeMode,null==i?void 0:i.locale,null==i?void 0:i.featureFlags);return e.fontTypes&&(e.fontTypes.default.fontFamily=Yo,e.fontTypes.monospace.fontFamily=Yo,e.fontTypes.default.fontSizes.default=16,e.fontTypes.monospace.fontSizes.default=16),e.fontWeights&&(e.fontWeights.bolder=600),e.containerStyles.default.backgroundColor=Zo,e.containerStyles.emphasis.backgroundColor=Zo,e}),[i]);N.useEffect((()=>{var e;const t=(0,zo.U5)(null!==(e=l.locale)&&void 0!==e?e:"en-us");(0,zo.ex)().then((e=>{e!==t&&(0,zo.Gd)(t)}))}),[l]);const c={useButtonStyles_unstable:e=>{const t=e;t.root.className=(0,Bt.z)(t.root.className,Jo().button)}};return N.createElement(Wo.q,{customStyleHooks_unstable:c,className:o.fluentProvider},N.createElement("div",{className:(0,Bt.z)(o.root,a?o.acContainerWithoutPadding:""),"data-testid":"ConfirmationCard",onKeyDown:t=>{var n,r,s;"Escape"===t.key&&((s=t).preventDefault(),s.stopPropagation(),null===(r=null===(n=e.confirmationCardRef)||void 0===n?void 0:n.current)||void 0===r||r.focus())},tabIndex:0,role:"button","aria-pressed":"false"},N.createElement(Vo.v,{cardData:r,hostConfig:l,uxRegistry:n,serviceProvider:s,onPrepareRuntimeActivityRequest:void 0,onRuntimeActivityResponse:void 0})))}const $o=new(n(11397).EventEmitter);var el=n(73449);const tl=({body:e,...t})=>{const{pluginCardServiceProvider:n}=(0,el.gW)(),[r,s]=N.useState(e),i=(0,N.useMemo)((()=>JSON.stringify(r)),[r]);N.useEffect((()=>{const e=e=>{s(e.content)};return $o.removeAllListeners("updateConfirmationDialog"),$o.on("updateConfirmationDialog",e),()=>{$o.off("updateConfirmationDialog",e)}}),[]);const a=(0,N.useMemo)((()=>"onConfirmationCardButtonClicked"in t?n?.createConfirmationCardService(t.onConfirmationCardButtonClicked):n?.confirmationCardService),[n,t]),o=n?.cardTelemetryService,l=n?.clientInfo,c=(0,N.useMemo)((()=>({cardService:a,telemetryService:o})),[a,o]),u=(0,Ot.Y$)(),d=(0,N.useMemo)((()=>new T.a({enableCustomWidthPropOnAC:u?.enableCustomWidthPropOnAC??!1},void 0,l?.locale,void 0,n?.copilotThemeInfo?.isHighContrast?"contrast":n?.copilotThemeInfo?.isDarkTheme?"dark":"light")),[n?.copilotThemeInfo,l]);return N.createElement(Xo,{serviceProvider:c,config:d,cardData:{appId:"",cardId:"",contentType:Uo.z.AdaptiveCard,content:i}})};var nl=n(11083);const rl=(0,pt.Q)(ft.tR),sl={root:{flexShrink:0,backgroundColor:rl.colorNeutralStencil1,color:rl.colorNeutralForeground1,...gt.Pt.padding(rl.spacingVerticalNone,rl.spacingHorizontalXS,rl.spacingVerticalXXS,rl.spacingHorizontalS),...kt.g.caption2,...gt.Pt.border(0),...gt.Pt.borderStyle("solid"),...gt.Pt.borderTop("2px"),...gt.Pt.borderColor(rl.colorNeutralStencil1)},green:{...gt.Pt.borderColor(rl.colorPaletteGreenBackground3)},neutral:{...gt.Pt.borderColor(rl.colorNeutralStencil1)},yellow:{...gt.Pt.borderColor(rl.colorPaletteYellowBackground3)},red:{...gt.Pt.borderColor(rl.colorPaletteRedBackground3)}},il=(0,mt.n)(sl),al=({valueMs:e,title:t,limits:n})=>{const r=il(),s=ol(e),i=ll(e,n.greenMs,r.green)??ll(e,n.neutralMs,r.neutral)??ll(e,n.yellowMs,r.yellow)??function(e,t,n){return e&&t>0&&e>t?n:null}(e,n.yellowMs,r.red),a=i?(0,Bt.z)(r.root,i):r.root,o={content:`${t} [green:${ol(n.greenMs,0)} yellow:${ol(n.yellowMs,0)}]`,relationship:"description",appearance:"inverted",withArrow:!0};return N.createElement(Jt.m,{...o},N.createElement("div",{className:a},s))};function ol(e,t=void 0){return function(e,t){const{value:n,decimals:r,unit:s}=e,i=t??r;return n?`${n.toLocaleString(void 0,{minimumFractionDigits:i,maximumFractionDigits:r})}${s}`:"n/a"}(function(e){if(!e)return{value:void 0,decimals:0,unit:null};if(e>=1e3)return{value:e/1e3,decimals:2,unit:"s"};return{value:e,decimals:0,unit:"ms"}}(e),t)}function ll(e,t,n){return e&&t>0&&e<=t?n:null}const cl={root:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",alignSelf:"flex-end",gap:(0,pt.Q)(ft.tR).spacingHorizontalS}},ul=(0,mt.n)(cl);const dl=e=>{const t=ul(),n=e.perfCounterBoxProps.map((e=>N.createElement(al,{key:e.title,...e})));return N.createElement("div",{className:t.root},n)};var hl=n(70034),pl=n(23956);function gl(e){return{root:e.root??{},loader:e.loader??{},loadingMessage:e.loadingMessage??{},labelText:e.labelText??{},button:e.button??{},buttonText:e.buttonText??{},failureIcon:e.failureIcon??{},failureIconContainer:e.failureIconContainer??{},failureMessage:e.failureMessage??{},failureMessageLabel:e.failureMessageLabel??{},spinner:e.spinner??{}}}const ml={loader:{fontFamily:"-apple-system",lineHeight:"normal"},loadingMessage:{fontFamily:"-apple-system",lineHeight:"normal"},failureMessageLabel:{fontFamily:"-apple-system",lineHeight:"normal"},labelText:{fontFamily:"-apple-system",lineHeight:"normal"},button:{fontFamily:"-apple-system",lineHeight:"normal"},failureMessage:{fontFamily:"-apple-system",lineHeight:"normal"}},fl=(0,mt.n)(gl(ml)),yl={root:{flexShrink:0,height:"fit-content",...gt.Pt.margin("12px","0px","0px","0px")},loader:{flexShrink:0,height:"fit-content",...gt.Pt.padding("12px","29px","12px","16px"),...gt.Pt.border("1px","solid",Pt.L.colorNeutralStroke1),...gt.Pt.borderRadius(Pt.L.borderRadiusMedium)},loadingMessage:{...gt.Pt.padding("8px","0px","8px","0px"),...kt.g.caption1Strong},failureMessageLabel:{...gt.Pt.padding("0px","8px","2px","8px"),...kt.g.caption1,color:Pt.L.colorNeutralForeground3},labelText:{display:"flex",flexDirection:"row",alignItems:"flex-start",...gt.Pt.padding("0px","8px","2px","8px"),height:"fit-content",order:1,flexGrow:0,...kt.g.caption1,color:Pt.L.colorNeutralForeground3},button:{width:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",...gt.Pt.margin("8px","0px"),...gt.Pt.padding("2px","8px")},spinner:{color:Pt.L.colorNeutralStroke2,backgroundImage:`linear-gradient(to right, ${Pt.L.colorBrandForeground1}, var(--fai-chatLoadColorBrandFlair3), var(--fai-chatLoadColorBrandFlair4), ${Pt.L.colorBrandForeground2})`},failureIconContainer:{height:"20px"},failureIcon:{width:"20px",height:"20px",order:0,flexGrow:0,"> path":{fill:Pt.L.colorNeutralStroke1Selected}},failureMessage:{flexShrink:0,height:"fit-content",...gt.Pt.padding("12px","19px","12px","12px"),...gt.Pt.border("1px","solid",Pt.L.colorNeutralStroke1),...gt.Pt.borderRadius(Pt.L.borderRadiusMedium)}},vl=(0,mt.n)(gl(yl)),bl=(0,pt.Q)(ft.tR),Cl={root:{flexShrink:0,height:"fit-content",...gt.Pt.margin("12px","0px","0px","0px")},loader:{flexShrink:0,height:"fit-content",...gt.Pt.padding("12px","29px","12px","16px"),...gt.Pt.border("1px","solid",bl.neutralLighterAlt),...gt.Pt.borderRadius(bl.borderRadiusMedium)},loadingMessage:{...gt.Pt.padding("8px","0px","8px","0px"),...kt.g.caption1Strong},failureMessageLabel:{...gt.Pt.padding("0px","8px","2px","8px"),...kt.g.caption1,color:bl.neutralSecondary},labelText:{display:"flex",flexDirection:"row",alignItems:"flex-start",...gt.Pt.padding("0px","8px","2px","8px"),height:"fit-content",order:1,flexGrow:0,...kt.g.caption1,color:bl.neutralSecondary},button:{width:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",...gt.Pt.margin("8px","0px"),...gt.Pt.padding("2px","8px")},spinner:{color:bl.neutralPrimaryAlt,backgroundImage:`linear-gradient(to right, ${bl.themePrimary}, ${bl.themeLighterAlt}, ${bl.themeLighter}, ${bl.themeSecondary})`},failureIconContainer:{height:"20px"},failureIcon:{width:"20px",height:"20px",order:0,flexGrow:0,"> path":{fill:bl.neutralQuaternary}},failureMessage:{flexShrink:0,height:"fit-content",...gt.Pt.padding("12px","19px","12px","12px"),...gt.Pt.border("1px","solid",bl.neutralLighterAlt),...gt.Pt.borderRadius(bl.borderRadiusMedium)}},wl=(0,mt.n)(gl(Cl)),Sl=(e,t)=>{if(t)for(const n in e)e[n]=(0,Bt.z)(e[n],t[n])},El=({styles:e,loadingSpinnerLabel:t="",successButtonProps:n,failureText:r,loadingState:a,loadingMessage:o,failureIcon:c=Do.WXH,telemetryData:u})=>{const d=(()=>{const e=wl(),t=vl(),n=fl(),r=(0,l.kF)()?t:e;(0,i.xp)()===s.Y.IOS&&Sl(r,n);return r})(),h=(0,Ot.Y$)();Sl(d,e);const p={tabIndex:0},g=(e,t)=>{const n=(0,Un.A)(t,e);return N.createElement(n,null)},m=e=>{return N.createElement(ht.W,{horizontal:!0,style:d.failureMessage,customProperties:p},N.createElement(Hn.l,{style:d.failureIconContainer},(t=c,N.createElement(t,{className:d.failureIcon}))),N.createElement(Hn.l,{style:d.failureMessageLabel},e));var t},f=N.createElement(ht.W,{style:d.root,customProperties:p},(e=>{switch(e){case hl.Kg.InProgress:return((e,t)=>N.createElement(N.Fragment,null,N.createElement(Fn.E,{tabIndex:0,className:d.loadingMessage},t),N.createElement(ht.W,{horizontal:!0,style:d.loader},N.createElement("span",null,N.createElement(pl.y,{size:"tiny",labelPosition:"after",spinner:{className:d.spinner}})),N.createElement(Fn.E,{className:d.labelText},e))))(t,o);case hl.Kg.Success:return N.createElement(ct.$,{className:d.button,appearance:h.isOutputV2Enabled?"outline":void 0,"aria-label":n.successButtonText,role:dt.eg.BUTTON,disabled:n.isDisabled,size:"small",tabIndex:0,onClick:()=>{n.successButtonOnClick&&!n.isDisabled&&n.successButtonOnClick(u)},title:n.successButtonText,icon:g(n.successButtonIconRegular,n.successButtonIconHover)},n.successButtonText);case hl.Kg.Failure:return m(r);case hl.Kg.Hidden:default:return N.createElement(N.Fragment,null)}})(a));return f};var xl=n(71351),Il=n(33239);const Al=(e,t)=>{if(e)return N.createElement(lo.e,{size:20,image:{src:e,style:{backgroundColor:"transparent"}},style:{borderRadius:0}});if(t){const e=t;return N.createElement(e,null)}return N.createElement(N.Fragment,null)},Pl=({styles:e,body:t,feedbackData:n,shouldShowAIGeneratedIndicator:r=!0,shouldShowAIPoweredIndicator:s,shouldShowFeedbackButtons:a=!0,shouldShowProgressSpinner:c=!0,shouldSupportCitationsInAvalon:u=!1,feedbackSectionPosition:d=o.O.None,actionBarHeaderProps:h,showAnimation:p=!0,handleThumbsDownClick:g,handleThumbsUpClick:m,handleSendFeedbackClick:f,actionBarButtons:y,chatCardIndex:v,showMinifiedUI:b=!1,strikeThroughText:C=!1,references:w=[],clpSensitivityIndicatorData:S,telemetryData:E="",pluginAuthError:x,msgExtCardProps:I,confirmationCardProps:A,apiPluginCardProps:P,useFluentAIGeneratedIndicator:k=!1,chatMessageHeaderData:T,progressSpinnerData:D,feedbackCategory:M=o.E.Success,messageAttributionProps:L,debugInfo:R,outputV2Props:O,readAloudActionButtonProps:_,isResponseStreaming:B=!1,messageId:F,overrideDirection:U})=>{const H=(0,Ka.yv)(),z=(0,Ot.Y$)(),j=(0,Ka.A8)(),V=(0,i.dD)()&&z.enableUseIOSAccessibilityTextStyles?[j.iosContent]:[],{getAgentIconDetails:q}=(0,Co.i)(),W=t.user??"chat",Q=z.isLoadingInOutputEnabled,G="human"!==t.user&&p,[Z,Y]=(0,N.useState)(G),[K,J]=(0,N.useState)("human"!==W&&B);(0,N.useEffect)((()=>{G&&Y(!0)}),[G]),(0,N.useEffect)((()=>{"human"!==W&&J(B)}),[B]),(0,N.useEffect)((()=>{Z&&Y(!1)}),[Z]);const X=(0,l.R2)(),{pluginCardServiceProvider:$}=(0,el.gW)(),ee=(0,So.i)(x),te=z.isOutputV2Enabled,ne=(y?.length>0||ee||_?.isReadAloudEnabled)&&"human"!==W,re=(d==o.O.Header||d==o.O.Footer&&(0,i.dD)())&&"human"!==W&&M===o.E.Success,se=!re&&(d==o.O.Footer||M===o.E.Error)&&"human"!==W,ie=$?.msgExtCardServiceProvider;let ae=[];I?.attributions.length>0&&ie&&(ae=ie.getCardReferences(I.attributions));const oe=$?.apiPluginCardServiceProvider;let le=[];P?.attributions.length>0&&oe&&(le=oe.getCardReferences(P.attributions));const ce=w.length>0&&(0,dt.vy)(w.length,ae.length,le.length),ue=!w?.length&&z.isInfoIconEnabledInFooter,de=O?.contentElementId??(0,bo.A)(),he=y?.filter((e=>e.position===vo.SC.FeedbackSection)),pe=y?.filter((e=>e.position!==vo.SC.FeedbackSection)),ge={actionBarButtons:pe,styles:e,messageContentElementId:de,chatCardIndex:v,telemetryData:E,pluginAuthButtonProps:ee,readAloudButtonProps:_,actionBarHeaderProps:h},me={styles:e,feedbackData:n,shouldShowAIGeneratedIndicator:r,shouldShowAIPoweredIndicator:s,shouldShowFeedbackButtons:a,displayPosition:d,handleThumbsDownClick:g,handleThumbsUpClick:m,handleSendFeedbackClick:f,showMinifiedUI:!!(0,i.dD)()||b,clpSensitivityIndicatorData:S,telemetryData:E,actionBarProps:{actionBarButtons:he,styles:{...e},messageContentElementId:de,chatCardIndex:v,telemetryData:E},useFluentAIGeneratedIndicator:k,htmlMessageContentElementId:de,feedbackCategory:M,shouldShowNoReferenceLabelRenderer:ue},fe={styles:e,chatMessageHeaderData:T},ye={styles:e,...D,telemetryData:E},ve=A&&N.createElement(tl,{...A}),be=(0,Ka.gN)(e,W,X,C,te),Ce={...L,styles:e},we=ne&&M===o.E.Success&&N.createElement(wo.D,{...ge}),Se=R?.shouldShowPerfCounters&&"human"!==W?function(e){if(!e)return null;const t={greenMs:0,neutralMs:0,yellowMs:0},n=[];return e.FCFR&&n.push({valueMs:e.FCFR,title:"First Frame Rendered",limits:e.FCFRgoals??t}),e.LCFR&&n.push({valueMs:e.LCFR,title:"Last Frame Rendered",limits:e.LCFRgoals??t}),n.length>0?{perfCounterBoxProps:n}:null}(R):null,Ee=Se?N.createElement(dl,{...Se}):null,xe=z.isTextDirectionEnabled&&U?"ltr"===U?"left":"right":void 0,Ie=N.createElement(N.Fragment,null,Ee,!te&&L&&!re&&N.createElement(Ao,{...Ce}),T&&!re&&N.createElement(Fo,{...fe}),!te&&re&&N.createElement(nl.A,{...me}),!te&&h&&we,N.createElement("div",{id:`${de}`,className:(0,Bt.z)(be.strikeThroughText,...V),style:xe?{textAlign:xe,direction:U,unicodeBidi:"isolate"}:{}},t.element),ve,!te&&!h&&we,D&&c&&N.createElement(El,{...ye}),se&&!te&&N.createElement(nl.A,{...me}),ce&&!te&&N.createElement(xl.d,{references:w,msgExtCardReferences:ae,apiPluginCardReferences:le,styles:e,telemetryData:E,shouldSupportCitationsInAvalon:u})),Ae=te?{children:Ie,className:H.contentStyles}:Ie,Pe=te&&O?"CopilotMessageV2"===O.messageProps.type?{messageProps:{...O.messageProps,props:{...O.messageProps.props,content:Ae,"aria-live":"polite"}}}:{messageProps:{...O.messageProps,props:{...O.messageProps.props,message:Ie,style:{wordBreak:"break-word"}}}}:void 0;if(Pe&&"CopilotMessageV2"===Pe.messageProps.type&&O?.agentId){const{agentName:e,agentAvatar:t}=((e,t)=>{if(!e?.agentId)return{agentName:"",agentAvatar:void 0};let n,r,s="",i="";if(e?.agentId===Il.I)s=Il.C,n=Ls.i9m;else{const n=t(e?.agentId);n&&(s=n?.agentName,i=n?.agentIcon)}return n?r=Al(void 0,n):i&&(r=Al(i)),{agentName:s,agentAvatar:r}})(O,q);e&&(Pe.messageProps.props.name=e),t&&(Pe.messageProps.props.avatar=t)}const ke="human"===W?N.createElement(yo.R,{className:be.chatCard},Ie):N.createElement(_n.g,{isLoading:Q?K:Z,"aria-live":"polite",className:be.chatCard,progress:Q?{value:void 0}:void 0},Ie);return te?N.createElement(sn,{...Pe}):ke},kl=(0,pt.Q)(ft.tR),Tl={card:{backgroundColor:kl.colorTransparentBackground},task:{boxShadow:kl.shadow4},taskButton:{alignItems:"left"}},Dl=(0,mt.n)(Tl),Ml=({id:e,openItem:t,icon:n,title:r,description:s,taskProperties:i,changePropertyValue:a})=>{let o=null;o="People"===n?N.createElement(ho.ymm,null):"Word"===n?N.createElement(cs.f7e,null):"PowerPoint"===n?N.createElement(Vi.alc,null):"Mail"===n?N.createElement(ca.JQC,null):N.createElement(rr.E82,null);const l=Dl();return N.createElement(as.A,{value:e,className:l.task},N.createElement(os.u,{size:"large",expandIcon:null},N.createElement(ao.a,{image:o,header:N.createElement(lt.c,null,r),title:s,action:i&&i.length>0&&(e=>e.some((e=>"var"!==e.type)))(i)?N.createElement(ct.$,{appearance:"transparent",className:l.taskButton,icon:t===e?N.createElement(_i.LKJ,null):N.createElement(_i.yuG,null),"aria-label":"More options"}):null},s||"")),N.createElement(ls.v,null,i?i.map(((e,t)=>{if("var"!==e.type)return N.createElement(N.Fragment,{key:t},N.createElement(co.D,{label:e.name,id:e.name},e.enumOptions?N.createElement(to.m,{id:t.toString(),value:e.value,onOptionSelect:(e,n)=>a(t,n.optionText)},e.enumOptions.map((e=>N.createElement(no.c,{key:e},e)))):N.createElement(uo.T,{id:t.toString(),value:e.value,onChange:e=>a(t,e?.target?.value)})),N.createElement("br",null),N.createElement("br",null))})):null))},Ll=({styles:e,body:t,finalButtonText:n})=>{const r=Dl(),[s,i]=N.useState(-1),[a,o]=N.useState(t.tasks),l=N.useCallback(((e,t)=>{i(t.value)}),[]),c=N.createElement("div",{className:e.root},N.createElement(is.n,{onToggle:l},a.map(((e,t)=>N.createElement(N.Fragment,{key:t},N.createElement(Ml,{id:t,openItem:s,icon:e.icon,title:d(e.title),description:e.description||"",taskProperties:e.taskProperties,changePropertyValue:u.bind(void 0,t)}),N.createElement("br",null))))));return N.createElement("div",{className:r.card},c,N.createElement(ct.$,{onClick:t.handleStartClicked.bind(t,a)},n));function u(e,t,n){const r=[...a];r[e].taskProperties[t].value=n,o(r)}function d(e){const t=e.split(/(?=[A-Z])|[_\s]/).join(" ");return t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()}};var Rl=n(99493),Nl=n(85477);const Ol=({styles:e={},onClickShowMeButton:t,onClickHelpButton:n})=>{const r=(0,it.Lh)(ut.bK7),s=(0,Nl.LW)(),i=e.combinedButton,a=e.showMeButton;return N.createElement(ht.W,{style:e.showMeButtonBarRoot,customProperties:{tabIndex:-1}},N.createElement(ct.$,{tabIndex:0,"aria-label":r,className:(0,Bt.z)(i,a),onClick:t},r),n&&N.createElement(ct.$,{tabIndex:0,"aria-label":s,className:(0,Bt.z)(i,a),icon:N.createElement(Rl.XLu,null),onClick:n},s))};var _l=n(16561);const Bl=({styles:e,richText:t,renderTextWithCitation:n=e=>null,references:r=[]})=>{t.linkText&&t.linkText.linkSuffix?.includes("%s")&&(t.text+=t.linkText.linkSuffix.substring(0,t.linkText.linkSuffix.indexOf("%s")),t.linkText.linkSuffix=t.linkText.linkSuffix.substring(t.linkText.linkSuffix.indexOf("%s")+2));return N.createElement("span",null,N.createElement(Fn.E,{block:!0,className:(0,Bt.z)(e.text,e.richTextRoot)},t.text?(0,dt.mj)(t.text,r)?n(t.text):t.text:"",t.linkText&&N.createElement(wi.N,{target:t.linkText.linkUrl?"_blank":"",href:t.linkText.linkUrl??"#",className:(0,Bt.z)(e.linkText,t.linkText.linkUrl?"":e.linkButton),onClick:()=>{t.linkText.linkUrl||t.linkText.linkOnClick()}},t.linkText.text),t.linkText?.linkSuffix?(0,dt.mj)(t.linkText?.linkSuffix,r)?n(t.linkText?.linkSuffix):t.linkText?.linkSuffix:""))};var Fl=n(39305);const Ul={messageHeader:{fontFamily:"-apple-system",lineHeight:"normal"},messageFooter:{fontFamily:"-apple-system",lineHeight:"normal"},listStackStyle:{fontFamily:"-apple-system",lineHeight:"normal"},pillsItem:{fontFamily:"-apple-system",lineHeight:"normal"},list:{fontFamily:"-apple-system",lineHeight:"normal"},listHeader:{fontFamily:"-apple-system",lineHeight:"normal"},listFooter:{fontFamily:"-apple-system",lineHeight:"normal"},linkText:{fontFamily:"-apple-system",lineHeight:"normal"},linkButton:{fontFamily:"-apple-system",lineHeight:"normal"},listItemTitle:{fontFamily:"-apple-system",lineHeight:"normal"},richTextRoot:{fontFamily:"-apple-system",lineHeight:"normal"}},Hl=(0,mt.n)((e=>({rootStack:e.rootStack??{},messageHeader:e.messageHeader??{},messageFooter:e.messageFooter??{},listStackStyle:e.listStackStyle??{},pillsItem:e.listStackStyle??{},pillsContainer:e.listStackStyle??{},list:e.list??{},listHeader:e.listHeader??{},listFooter:e.listFooter??{},linkText:e.linkText??{},linkButton:e.linkButton??{},listItemTitle:e.listItemTitle??{},richTextRoot:e.richTextRoot??{},...(0,Fl.J)(e)}))(Ul));var zl=n(21177);const jl={rootStack:{textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"},...gt.Pt.gap("12px")},messageHeader:{},messageFooter:{},listStackStyle:{...gt.Pt.gap("4px"),...gt.Pt.gap("12px")},pillsContainer:{alignItems:"flex-start"},pillsItem:{backgroundColor:Pt.L.colorNeutralBackground3,color:Pt.L.colorNeutralForeground2,"&:hover":{backgroundColor:Pt.L.colorNeutralBackground2Hover,color:Pt.L.colorNeutralForeground1Hover},marginBottom:"10px",width:"fit-content",textAlign:"left",...gt.Pt.border("transparent"),...gt.Pt.borderColor(Pt.L.colorNeutralBackground3),display:"inline-block",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px",...gt.Pt.borderRadius("4px"),...gt.Pt.gap("4px"),...gt.Pt.gap("12px")},list:{...gt.Pt.margin("0px"),...gt.Pt.gap("4px")},listHeader:{fontWeight:600},listFooter:{},linkText:{...kt.g.body1,color:Pt.L.colorBrandForeground1,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:Pt.L.colorBrandForeground1}}},linkButton:{fontWeight:"bold",textDecorationLine:"none","&:hover:active":{textDecorationLine:"none"},"&:hover":{textDecorationLine:"none"}},listItemTitle:{fontWeight:600},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"},...(0,zl.r)()},Vl=(0,mt.n)(jl),ql=(0,pt.Q)(ft.tR),Wl={rootStack:{textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"},...gt.Pt.gap("12px")},messageHeader:{},messageFooter:{},listStackStyle:{...gt.Pt.gap("4px"),...gt.Pt.gap("12px")},pillsContainer:{alignItems:"flex-start"},pillsItem:{backgroundColor:Pt.L.colorNeutralBackground3,color:Pt.L.colorNeutralForeground2,"&:hover":{backgroundColor:Pt.L.colorNeutralBackground2Hover,color:Pt.L.colorNeutralForeground1Hover},marginBottom:"10px",width:"fit-content",textAlign:"left",...gt.Pt.border("transparent"),...gt.Pt.borderColor(Pt.L.colorNeutralBackground3),display:"inline-block",paddingTop:"4px",paddingBottom:"4px",paddingLeft:"8px",paddingRight:"8px",...gt.Pt.borderRadius("4px"),...gt.Pt.gap("4px"),...gt.Pt.gap("12px")},list:{...gt.Pt.margin("0px"),...gt.Pt.gap("4px")},listHeader:{fontWeight:600},listFooter:{},linkText:{...kt.g.body1,color:ql.themePrimary,textDecorationLine:"underline","@media (forced-colors: none)":{"&:hover":{color:ql.themePrimary}}},linkButton:{fontWeight:"bold",textDecorationLine:"none","&:hover:active":{textDecorationLine:"none"},"&:hover":{textDecorationLine:"none"}},listItemTitle:{fontWeight:600},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"},...(0,Ka.mO)()},Ql=(0,mt.n)(Wl),Gl=()=>{const e=Ql(),t=Vl(),n=(0,l.kF)()?t:e,r=Hl();if((0,i.xp)()===s.Y.IOS)(0,dt.bt)(n,r);return n},Zl=({styles:e,body:t,strikeThroughText:n=!1,references:r=[],pillsList:s=[],handlePillOnClick:i=null,handleShowMeOnClick:a=null,telemetryData:o="",shouldSupportCitationsInAvalon:l,warningActionButtons:c=[]})=>{const u=(0,Ot.Y$)();let d=(0,Bt.z)(e.text,e.rootStack);n&&(d=(0,Bt.z)(e.text,e.strikeThroughText,e.rootStack));const h=Gl(),p={styles:e,onClickShowMeButton:a,onClickHelpButton:null},g=e=>(0,dt.Iw)(e,r).map(((e,t)=>N.createElement("span",{key:t},e.message,e.references&&e.references.map(((e,t)=>N.createElement(_l.A,{...e,key:t,telemetryData:o,shouldSupportCitationsInAvalon:l}))))));return N.createElement(ht.W,{style:d},t.messageHeader&&(t.messageHeader.text||t.messageHeader.linkText)&&N.createElement(ht.W,{style:e.messageHeader},N.createElement(Bl,{styles:e,richText:t.messageHeader,references:r,renderTextWithCitation:g})),t.embeddedLists&&t.embeddedLists.map(((t,n)=>N.createElement(ht.W,{key:n,style:e.listStackStyle},t.listHeader&&N.createElement(Fn.E,{className:(0,Bt.z)(e.text,e.listHeader)},(0,dt.mj)(t.listHeader,r)?g(t.listHeader):t.listHeader),t.listItems&&t.listItems.length>0&&N.createElement("ul",{className:e.list},t.listItems.map(((t,n)=>N.createElement(Fn.E,{block:!0,key:n,className:e.text},N.createElement("li",null,t.title&&N.createElement("span",{className:e.listItemTitle},(0,dt.mj)(t.title,r)?g(t.title):t.title),(0,dt.mj)(t.text,r)?g(t.text):t.text))))),t.listFooter&&(t.listFooter.text||t.listFooter.linkText)&&N.createElement(ht.W,{style:e.listFooter},N.createElement(Bl,{styles:e,richText:t.listFooter,references:r,renderTextWithCitation:g}))))),t.messageFooter&&(t.messageFooter.text||t.messageFooter.linkText)&&N.createElement(ht.W,{style:e.messageFooter},N.createElement(Bl,{styles:e,richText:t.messageFooter,references:r,renderTextWithCitation:g})),c&&c.length>0&&c.map(((t,n)=>N.createElement(ct.$,{key:n,appearance:u?.isOutputV2Enabled?"outline":void 0,className:e?.warningActionButton,"aria-label":t.buttonTitle,onClick:t.handleButtonOnClick,disabled:t.isDisabled},t.buttonText))),a&&N.createElement(Ol,{...p}),s&&s.length>0&&N.createElement(ht.W,{style:h.pillsContainer},s.map(((e,t)=>N.createElement(ct.$,{key:t,className:h.pillsItem,onClick:()=>{i&&i(e)}},e.data)))))},Yl={feedbackNudgeContent:ut.ZFT,feedbackNudgeContentTitle:ut.hU1,feedbackNudgeHeader:ut.vBL,feedbackMsInternal:ut.mF3},Kl=({body:e,styles:t={}})=>{const n=(e=>{const t=(0,it.kQ)(Yl);return N.useMemo((()=>({...t,cardHeader:()=>e.cardHeader??t.feedbackNudgeHeader(),cardContent:()=>e.cardContent??t.feedbackNudgeContent()})),[t,e.cardHeader,e.cardContent])})({cardHeader:e.cardHeader,cardContent:e.cardContent}),r=e.imageSrc;return N.createElement(ht.W,{style:t.feedbackNudgeRootStack},N.createElement(ht.W,{style:t.msInternalContainer},N.createElement(Fn.E,{title:n.feedbackMsInternal(),className:t.msInternalHeader},n.feedbackMsInternal())),N.createElement(at._,{src:r,className:t.cardIllustration}),N.createElement(Fn.E,{title:n.feedbackNudgeHeader(),className:t.feedbackCardHeader},n.cardHeader()),N.createElement(Fn.E,{title:n.feedbackNudgeContentTitle(),className:(0,Bt.z)(t.text,t.feedbackCardContent)},n.cardContent()))};const Jl={msInternalHeader:{lineHeight:"normal"},feedbackCardHeader:{lineHeight:"14px"},feedbackCardContent:{lineHeight:"14px"},...(0,Ka.mO)()},Xl=(0,mt.n)(function(e){const t=(e=>({feedbackNudgeRootStack:{},msInternalContainer:e.msInternalContainer??{},msInternalHeader:e.msInternalHeader??{},feedbackCardHeader:e.feedbackCardHeader??{},feedbackCardContent:e.feedbackCardContent??{},cardIllustration:e.cardIllustration??{},...(0,Fl.J)(e)}))(e);return t}(Jl)),$l=(0,pt.Q)(ft.tR),ec={feedbackNudgeRootStack:{alignItems:"center",...gt.Pt.gap("4px")},msInternalContainer:{alignItems:"center",width:"100%"},msInternalHeader:{height:"16px",...gt.Pt.borderRadius($l.borderRadiusXLarge),backgroundColor:$l.neutralTertiary,...gt.Pt.padding("0px","12px"),...kt.g.caption2Strong,display:"flex",justifyContent:"center",alignItems:"center"},feedbackCardHeader:{marginTop:"12px",width:"100%",textAlign:"center",...kt.g.subtitle2,color:$l.themePrimary},feedbackCardContent:{marginTop:"12px"},cardIllustration:{},...(0,Ka.mO)()},tc=(0,mt.n)(ec),nc=N.memo((function({interstitialMessages:e}){const t=(0,el.lc)();if(!e)return N.createElement(N.Fragment,null);const n=t?.renderSkill(e);return n}));var rc=n(91842),sc=n(9680),ic=n(26057),ac=n(16413);const oc=({styles:e,handleApplyOnClick:t,handleApplyAllOnClick:n})=>{const r=(0,Nl.Kp)(),s=(0,Nl.XU)(),i=(0,Nl.n_)(),a=(0,Nl.WV)(),[o,l]=(0,N.useState)(!1),[c,u]=(0,N.useState)(!1),d=async()=>{l(!0),c?await n():await t(),l(!1)};return o?N.createElement(Jt.m,{content:a,relationship:"label"},N.createElement(ct.$,{className:(0,Bt.z)(e.spinnerButton,e.combinedButton),onClick:d,disabled:!0,icon:N.createElement(Vi.kJ9,{className:e.spinnerIcon})})):N.createElement(Es.W,{positioning:"below-end"},N.createElement(xs.c,{disableButtonEnhancement:!0},(t=>N.createElement(Jt.m,{content:i,relationship:"label"},N.createElement(ac.f,{menuButton:t,primaryActionButton:{onClick:d},size:"small",className:e.applyButton},c?r:s)))),N.createElement(As.b,null,N.createElement(Ps.c,null,N.createElement(ks.D,{onClick:()=>{u((e=>!e))}},c?s:r))))},lc=({styles:e={},body:t})=>{const n=(()=>{const e=(0,Nl.ls)(),t=(0,Nl.E)(),n=(0,Nl.FG)(),r=(0,Nl.mQ)(),s=(0,Nl.wP)(),i=(0,Nl.HA)();return{applyUpdatesText:()=>e,locateTextIndexTooltip:()=>t,noResultFoundMessage:()=>n,paginationNextTooltip:()=>r,paginationPreviousTooltip:()=>s,removeTooltip:()=>i}})(),[r,s]=(0,N.useState)(0),[i,a]=(0,N.useState)([...t.textIndices]),[o,l]=(0,N.useState)(!1);(0,N.useEffect)((()=>{r>=i.length&&s(i.length-1)}),[i]);const c=()=>s((e=>e-1)),u=()=>s((e=>e+1)),d=async()=>{l(!0),await t.locateTextIndex(i[r]),l(!1)},h=()=>{a((e=>{const t=[...e];return t.splice(r,1),t}))},p={styles:e,handleApplyOnClick:async()=>{await t.handleApplyOnClick(i[r])},handleApplyAllOnClick:async()=>{await t.handleApplyAllOnClick(i)}};return N.createElement(ht.W,{style:e.stack,customProperties:{tabIndex:-1}},i.length?N.createElement(N.Fragment,null,n.applyUpdatesText(),N.createElement("div",{className:e.contentBox},N.createElement("div",{className:e.contentBoxButtonGroup},N.createElement("div",{className:o?e.disabledContentBoxIcon:e.contentBoxIcon},o?N.createElement(Vi.xM0,{className:e.spinnerIcon}):N.createElement(Jt.m,{content:n.locateTextIndexTooltip(),relationship:"label"},N.createElement(Ms.TRI,{onClick:d}))),o?N.createElement(N.Fragment,null):N.createElement("div",{className:(0,Bt.z)(e.contentBoxIcon,e.dismissIcon)},N.createElement(Jt.m,{content:n.removeTooltip(),relationship:"label"},N.createElement(Ls.aYy,{onClick:h})))),N.createElement("div",{className:e.contentBoxText},r<i.length&&t.extractTextToDisplay(i[r]))),N.createElement("div",{className:e.footer},N.createElement("div",null,N.createElement(oc,{...p})),N.createElement("div",{className:e.pagination},N.createElement("div",{className:e.paginationNumberBox},r+1,"/",i.length),N.createElement("div",null,N.createElement(N.Fragment,null,N.createElement(Jt.m,{content:n.paginationPreviousTooltip(),relationship:"label"},N.createElement(ct.$,{icon:N.createElement(ic.QWq,null),onClick:c,disabled:0==r,className:e.paginationButton})),N.createElement(Jt.m,{content:n.paginationNextTooltip(),relationship:"label"},N.createElement(ct.$,{icon:N.createElement(ic.Bxo,null),onClick:u,disabled:r+1>=i.length,className:e.paginationButton}))))))):N.createElement(N.Fragment,null,n.noResultFoundMessage()))},cc=(0,pt.Q)(ft.tR),uc={stack:{textAlign:"start",textOverflow:"clip",...gt.Pt.gap("12px")},contentBox:{backgroundColor:cc.neutralLight,minHeight:"50px",position:"relative",...gt.Pt.padding("12px"),...gt.Pt.border("1px","solid",cc.neutralLighterAlt),...gt.Pt.borderRadius(cc.borderRadiusMedium)},footer:{width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",...gt.Pt.gap("12px")},pagination:{flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap",...gt.Pt.gap("10px")},paginationButton:{backgroundColor:cc.neutralLight,height:"24px",...gt.Pt.border("none"),"&:hover":{color:cc.themePrimary}},spinnerButton:{backgroundColor:cc.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:cc.themePrimary}},paginationNumberBox:{textAlign:"center",backgroundColor:cc.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box",...gt.Pt.border("1px","solid",cc.neutralLighterAlt),...gt.Pt.borderRadius(cc.borderRadiusMedium),...kt.g.caption1,...gt.Pt.padding("4px","8px")},dismissIcon:{marginLeft:"8px"},contentBoxIcon:{":hover":{color:cc.themePrimary,cursor:"pointer"}},disabledContentBoxIcon:{":hover":{color:cc.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:cc.themePrimary},contentBoxText:{marginBottom:"20px"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"},...(0,Ka.mO)()},dc=(0,mt.n)(uc),hc=()=>N.createElement("svg",{width:"37",height:"37",viewBox:"0 0 37 37",fill:"none",xmlns:"http://www.w3.org/2000/svg"},N.createElement("path",{d:"M0.25 8.91699C0.25 4.49871 3.83172 0.916992 8.25 0.916992H28.25C32.6683 0.916992 36.25 4.49871 36.25 8.91699V28.917C36.25 33.3353 32.6683 36.917 28.25 36.917H8.25C3.83172 36.917 0.25 33.3353 0.25 28.917V8.91699Z",fill:"#EBEFFF"}),N.createElement("path",{d:"M12.5 8.91699C11.2574 8.91699 10.25 9.92435 10.25 11.167V26.667C10.25 27.9096 11.2574 28.917 12.5 28.917H24C25.2426 28.917 26.25 27.9096 26.25 26.667V11.167C26.25 9.92435 25.2426 8.91699 24 8.91699H12.5ZM11.75 11.167C11.75 10.7528 12.0858 10.417 12.5 10.417H24C24.4142 10.417 24.75 10.7528 24.75 11.167V26.667C24.75 27.0812 24.4142 27.417 24 27.417H12.5C12.0858 27.417 11.75 27.0812 11.75 26.667V11.167ZM14 13.417C13.5858 13.417 13.25 13.7528 13.25 14.167C13.25 14.5812 13.5858 14.917 14 14.917H22.5C22.9142 14.917 23.25 14.5812 23.25 14.167C23.25 13.7528 22.9142 13.417 22.5 13.417H14ZM13.25 23.167C13.25 22.7528 13.5858 22.417 14 22.417H22.5C22.9142 22.417 23.25 22.7528 23.25 23.167C23.25 23.5812 22.9142 23.917 22.5 23.917H14C13.5858 23.917 13.25 23.5812 13.25 23.167ZM14 17.917C13.5858 17.917 13.25 18.2528 13.25 18.667C13.25 19.0812 13.5858 19.417 14 19.417H22.5C22.9142 19.417 23.25 19.0812 23.25 18.667C23.25 18.2528 22.9142 17.917 22.5 17.917H14Z",fill:"#242424"})),pc=({styles:e={},body:t})=>N.createElement(ht.W,{style:e.stack,horizontal:!1},N.createElement(Hn.l,{style:e.headerContainer},N.createElement("div",{className:e.cardIcon},N.createElement(hc,null)),N.createElement("div",{className:e.headerGroupContent},N.createElement("div",{className:e.header},t.heading),N.createElement("div",{className:e.subHeaderContainer},N.createElement(Do.c8N,null),N.createElement("div",{className:e.subheading},t.subheading)))),N.createElement(Hn.l,null,N.createElement(Fn.E,{className:e.contentBoxText},t.content))),gc={stack:{textAlign:"start",textOverflow:"clip",...gt.Pt.gap(Pt.L.spacingVerticalM)},headerContainer:{display:"flex",height:"38px",padding:Pt.L.spacingVerticalXXS,flexDirection:"row",alignItems:"center"},headerGroupContent:{margin:Pt.L.spacingVerticalXXS},header:{display:"flex",flexDirection:"row",alignItems:"center",height:"22px",margin:Pt.L.spacingHorizontalXXS,...kt.g.subtitle1},subHeaderContainer:{display:"flex",flexDirection:"row",height:"22px",alignItems:"center",...gt.Pt.gap(Pt.L.spacingHorizontalXS)},subHeader:{...kt.g.subtitle2},contentBoxText:{...kt.g.body1},cardIcon:{marginRight:Pt.L.spacingHorizontalM,borderRadius:Pt.L.borderRadiusMedium},...(0,Ka.mO)()},mc=(0,mt.n)(gc);var fc=n(21577);const yc={proactiveSuggestionApplyBtnText:ut.uCe,proactiveSuggestionBodyText:ut.k7M,proactiveSuggestionIconText:ut.tEu,proactiveSuggestionImgAltText:ut.M2N,proactiveSuggestionTitleText:ut._Nr},vc=({styles:e={},body:t})=>{const n=(0,it.kQ)(yc),[r,s]=N.useState(!1);return N.createElement(ht.W,{style:e.rootStack},N.createElement("div",{className:e.container,onMouseOver:()=>{t.handleMouseOver()},onMouseLeave:()=>{t.handleMouseLeave()},onFocus:()=>{t.handleMouseLeave()}},N.createElement("div",null,N.createElement(Fn.E,{className:e.title},n.proactiveSuggestionTitleText()),N.createElement(fc.E,{className:e.badge,size:"large",appearance:"outline",color:"subtle",icon:N.createElement(Vi.OzC,null)},n.proactiveSuggestionIconText())),N.createElement(Fn.E,{className:e.body},n.proactiveSuggestionBodyText()),N.createElement(at._,{className:e.image,bordered:!0,shadow:!0,shape:"rounded",alt:n.proactiveSuggestionImgAltText(),src:t.imageSrc}),N.createElement(ct.$,{disabled:r,className:e.applyButton,onClick:()=>{s(!0),t.handleApplyClicked()},icon:N.createElement(Er.wYX,null)},n.proactiveSuggestionApplyBtnText())))},bc=(0,pt.Q)(ft.tR),Cc={rootStack:{...gt.Pt.gap("4px")},container:{display:"flex",flexDirection:"column"},title:{fontWeight:"600"},badge:{float:"right",...gt.Pt.borderColor(bc.themeMedium)},body:{marginTop:"15px"},image:{marginTop:"15px"},applyButton:{marginTop:"15px",width:"104px"},...(0,Ka.mO)()},wc=(0,mt.n)(Cc);var Sc,Ec;!function(e){e.EntryPointCard="EntryPointCard",e.ConfirmInvitationCard="ConfirmInvitationCard",e.SuggestionCard="SuggestionCard",e.ReviewStatusCard="ReviewStatusCard"}(Sc||(Sc={})),function(e){e.PEOPLE_PICKER="PEOPLE_PICKER",e.TEXT_AREA="TEXT_AREA",e.DATE_PICKER="DATE_PICKER",e.DROP_DOWN="DROP_DOWN",e.SUBMIT="SUBMIT"}(Ec||(Ec={}));var xc=n(27263);const Ic=({styles:e,label:t,icon:n,text:r,disabled:s,isFormReadyForSubmission:i,onSubmit:a})=>{const o=(0,Nl.$4)();return N.createElement("div",{className:e.buttonStyle},N.createElement(ct.$,{appearance:"primary",icon:s?N.createElement(Ui.N5_,null):N.createElement(Ms.qC3,null),onClick:a,disabled:!i,size:"small",className:e.buttonItemsStyle},N.createElement(nr.M,null,s?o:r)))},Ac=((0,pt.Q)(ft.zQ),{buttonTextStyle:{},buttonStyle:{display:"flex",flexDirection:"column",rowGap:"8px"},buttonItemsStyle:{width:"fit-content"},...(0,Ka.mO)()}),Pc=(0,mt.n)(Ac);var kc=n(40379);const Tc=({styles:e,label:t,selectedDate:n,disabled:r,onDateChange:s})=>N.createElement(co.D,{label:N.createElement(kc.Z,null,t," ")},N.createElement(io.l,{showMonthPickerAsOverlay:!0,showGoToToday:!1,value:n,onSelectDate:e=>{s&&s(e)},disabled:r,minDate:new Date})),Dc=(0,pt.Q)(ft.zQ),Mc={datePickerLabelStyle:{},datePickerInputStyle:{...gt.Pt.border("1px","solid",Dc.colorNeutralStroke1),...gt.Pt.borderRadius("4px")},datePickerIconStyle:{},...(0,Ka.mO)()},Lc=(0,mt.n)(Mc);var Rc=n(58651);const Nc=({styles:e,label:t,selectedValue:n,displayValue:r,options:s,disabled:i,onItemSelected:a})=>N.createElement(ht.W,null,N.createElement(co.D,{label:N.createElement(kc.Z,null,t)},N.createElement(to.m,{onOptionSelect:(e,t)=>{return n=t.optionText,Rc.log(n),void(a&&a(n));var n},className:e.dropDownInputStyle,value:r??n,disabled:i},s.map((e=>N.createElement(no.c,{key:e},e)))))),Oc=(0,pt.Q)(ft.zQ),_c={dropDownLabelStyle:{},dropDownInputStyle:{...gt.Pt.border("1px","solid",Oc.colorNeutralStroke1),...gt.Pt.borderRadius("4px")},dropDownFlyoutStyle:{},...(0,Ka.mO)()},Bc=(0,mt.n)(_c);var Fc=n(28666);const Uc=({styles:e,label:t,suggestions:n,inputComponent:r,onPeopleAdded:s,disabled:i,onPeopleRemoved:a})=>N.createElement(ht.W,null,N.createElement(co.D,{label:N.createElement(kc.Z,null,t)},N.createElement(ht.W,{style:e.peoplePickerInputStyle},n&&n.length>0&&N.createElement(Hn.l,{style:e.peoplePickerInputContainerStyle},N.createElement(Fc.C,{onDismiss:(e,{value:t})=>{a&&a({mail:t,displayName:t})},className:e.peoplePickerTagGroupStyle},n.map(((e,t)=>N.createElement(oo.v,{shape:"circular",media:N.createElement(lo.e,{name:e.displayName,shape:"circular"}),dismissible:!e.isReadOnly,dismissIcon:e.isReadOnly?void 0:{"aria-label":"remove"},key:t,size:"extra-small",value:e.mail,disabled:i},e.displayName))))),!i&&N.createElement(Hn.l,{style:e.peoplePickerInputContainerStyle},r)))),Hc=(0,pt.Q)(ft.zQ),zc={peoplePickerLabelStyle:{},peoplePickerInputStyle:{...gt.Pt.borderRadius("4px"),...gt.Pt.border("1px","solid",Hc.colorNeutralStroke1),display:"flex"},peoplePickerInputContainerStyle:{...gt.Pt.margin("2px","8px","2px","8px")},peoplePickerTagGroupStyle:{flexWrap:"wrap",rowGap:"8px"},peoplePickerSwitchStyle:{},...(0,Ka.mO)()},jc=(0,mt.n)(zc),Vc=({styles:e,label:t,message:n,disabled:r,onMessageChange:s})=>{const[i,a]=N.useState(n);return N.createElement(ht.W,null,N.createElement(co.D,{label:N.createElement(kc.Z,null,t)},N.createElement(uo.T,{value:i,onChange:(e,t)=>{s&&s(t.value),a(t.value)},disabled:r,rows:4},N.createElement(lt.c,null,i))))},qc=(0,pt.Q)(ft.zQ),Wc={textAreaLabelStyle:{},textAreaInputStyle:{...gt.Pt.borderRadius("4px"),...gt.Pt.border("1px","solid",qc.colorNeutralStroke1)},...(0,Ka.mO)()},Qc=(0,mt.n)(Wc),Gc=(0,pt.Q)(ft.zQ),Zc={elementStyles:{display:"flex",flexDirection:"column",...gt.Pt.gap("16px")},footerAIGeneratedStyles:{color:Gc.neutralSecondaryAlt},...(0,Ka.mO)()},Yc=(0,mt.n)(Zc),Kc={aiGeneratedDisclaimer:ut.ydw},Jc=({styles:e,body:t})=>{const n=t.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,r=n.isCardSubmitted??!1,s=Yc(),i=jc(),a=Qc(),o=Bc(),l=Lc(),c=Pc(),u=(()=>{const e=(0,it.kQ)(Kc),t=(0,Nl.jS)(),n=(0,Nl.hl)();return N.useMemo((()=>({...e,invitationText:()=>t,detailsHeaderText:()=>n})),[e,t,n])})();return N.createElement(ht.W,{style:s.elementStyles},N.createElement(xc.F,null,N.createElement(N.Fragment,null,n.headerText??(n.isEditDetailsRequest?u.detailsHeaderText():u.invitationText()))),Object.keys(n.individualComponentPropsMap).map(((t,s)=>N.createElement(Hn.l,{key:s},((e,t,n)=>{if(!t)return null;let s,u=null;switch(e){case Ec.PEOPLE_PICKER:s=(0,dt.bt)(i,n),u=Uc;break;case Ec.TEXT_AREA:s=(0,dt.bt)(a,n),u=Vc;break;case Ec.DROP_DOWN:s=(0,dt.bt)(o,n),u=Nc;break;case Ec.DATE_PICKER:s=(0,dt.bt)(l,n),u=Tc;break;case Ec.SUBMIT:t.isFormReadyForSubmission=t.isFormReadyForSubmission??!0,s=(0,dt.bt)(c,n),u=Ic;break;default:return null}return N.createElement(u,{...t,styles:s,disabled:r})})(t,n.individualComponentPropsMap[t],e)))),N.createElement(Eo.T,{className:s.footerAIGeneratedStyles},u.aiGeneratedDisclaimer()))};var Xc=n(10474);const $c=()=>N.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},N.createElement("rect",{width:"20",height:"20",rx:"10",fill:"url(#pattern0)"}),N.createElement("defs",null,N.createElement("pattern",{id:"pattern0",patternContentUnits:"objectBoundingBox",width:"1",height:"1"},N.createElement("use",{xlinkHref:"#image0_6409_5011",transform:"scale(0.0033557)"})),N.createElement("image",{id:"image0_6409_5011",width:"298",height:"298",xlinkHref:"data:image/png;base64,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"}))),eu=({styles:e,body:t})=>{const[n,r]=(0,N.useState)(!1),s=(t.reviewAgentIndividualCardProps??{reviewAgentCardType:Sc.EntryPointCard,reviewAgentInternalCardProps:{onAddDetailsButtonClick:()=>{},onStartReviewButtonClick:()=>{}}}).reviewAgentInternalCardProps,i=s.isTriggeredFromReviewerAgentPane??!1,a=s.isSecondHeaderHidden??!1,o=s.isIconHidden??!1,l=(e=>{const t=(0,Nl.YG)(),n=(0,Nl.ub)(),r=(0,Nl.Lo)(),s=(0,Nl.Tg)(),i=(0,Nl.aY)();return(0,N.useMemo)((()=>({addDetailButtonText:e.addDetailButtonText??t,descriptionText:e.descriptionText??n,headerText:e.headerText??r,secondHeaderText:e.secondHeaderText??s,startReviewButtonText:e.startReviewButtonText??i})),[t,n,r,s,i,e.addDetailButtonText,e.descriptionText,e.headerText,e.secondHeaderText,e.startReviewButtonText])})({addDetailButtonText:s.buttonRightText,descriptionText:s.reviewAgentDescriptionText,headerText:s.headerText,secondHeaderText:s.reviewSyncText,startReviewButtonText:s.buttonLeftText});return N.createElement(ht.W,{style:e.reviewAgentEntryCardStyle},i?null:N.createElement(lt.c,null,l.headerText),N.createElement(Hn.l,{style:e.reviewAgentEntryCardDescriptionStyle},N.createElement(ht.W,{horizontal:!0,style:e.reviewAgentEntryCardElementStyle},N.createElement(Hn.l,null,o?null:s.reviewAgentIcon??N.createElement($c,null)),a?null:N.createElement(Xc.V,null,l.secondHeaderText)),N.createElement(nr.M,null,l.descriptionText)),N.createElement(Hn.l,null,N.createElement(ht.W,{horizontal:!0,style:e.reviewAgentEntryCardElementStyle},N.createElement(Hn.l,null,N.createElement(ct.$,{onClick:()=>{s.onStartReviewButtonClick(),r(!0)},size:"small",disabled:n},N.createElement(nr.M,null,l.startReviewButtonText))),N.createElement(Hn.l,null,N.createElement(ct.$,{onClick:()=>{s.onAddDetailsButtonClick(),r(!0)},size:"small",disabled:n},N.createElement(nr.M,null,l.addDetailButtonText))))))},tu=((0,pt.Q)(ft.zQ),{reviewAgentEntryCardStyle:{display:"flex",flexDirection:"column",...gt.Pt.gap("16px")},reviewAgentEntryCardElementStyle:{display:"flex",flexDirection:"row",...gt.Pt.gap("8px")},reviewAgentEntryCardSecondHeaderStyle:{},reviewAgentEntryCardDescriptionStyle:{display:"flex",flexDirection:"column",...gt.Pt.gap("8px")},reviewAgentEntryCardButtonStyle:{},reviewAgentEntryCardReviewSyncIcon:{},reviewAgentEntryCardContinueIcon:{},...(0,Ka.mO)()}),nu=(0,mt.n)(tu);var ru;!function(e){e.Rewrite="Rewrite",e.Insert="Insert",e.Reply="Reply"}(ru||(ru={}));const su={aiGeneratedDisclaimer:ut.ydw};function iu(e){switch(e?.toLowerCase()){case"word":case"powerpoint":default:return"line";case"excel":return"cell"}}const au=({styles:e={},body:t})=>{const n=(()=>{const e=(0,it.kQ)(su),t=(0,Nl.XU)(),n=(0,Nl.FG)(),r=(0,Nl.mQ)(),s=(0,Nl.wP)(),i=(0,Nl.Ks)();return N.useMemo((()=>({...e,applyBtnText:()=>t,noResultFoundMessage:()=>n,paginationNextTooltip:()=>r,paginationPreviousTooltip:()=>s,reviewerAgentSuggestion:()=>i})),[e,t,n,r,s,i])})(),r=t.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,[s,i]=(0,N.useState)(0),[a,o]=(0,N.useState)([...r.suggestionIndices]),l=r.suggestionIndices[s].changeType,c=r.suggestionIndices[s].appName;(0,N.useEffect)((()=>{a[s].onSuggestionCardNavigation(a[s].commentId)}),[]),(0,N.useEffect)((()=>{s>=a.length&&i(a.length-1),a[s]?.onSuggestionCardNavigation(a[s]?.commentId)}),[s,a.length]);const u=()=>{a[s-1]?.onSuggestionCardNavigation(a[s-1]?.commentId),i((e=>e-1))},d=()=>{a[s+1]?.onSuggestionCardNavigation(a[s+1]?.commentId),i((e=>e+1))},h=function(e,t){let n="excel"===t?.toLowerCase()?"Replace":e;switch(e){case ru.Reply:return e+" on the comment";case ru.Insert:return n+" in "+iu(t);case ru.Rewrite:return e+" the "+iu(t);default:return n}}(l,c);return N.createElement(ht.W,{style:e.stack,customProperties:{tabIndex:-1}},a.length?N.createElement(N.Fragment,null,N.createElement(kc.Z,null,`${n.reviewerAgentSuggestion()} ${s+1} of ${a.length}`),N.createElement("div",null,N.createElement(lt.c,null,h," "),N.createElement(lt.c,null,N.createElement("i",null,'"',r.suggestionIndices[s].initialText,'"'),l===ru.Insert?",":" to,"),N.createElement("br",null),N.createElement(Xc.V,null,r.suggestionIndices[s].suggestedText)),N.createElement("div",{className:e.footer},N.createElement(ct.$,{disabled:r.suggestionIndices[s].disabled,size:"small",icon:N.createElement(Ui.N5_,null),key:s,onClick:async()=>{o((e=>{const t=[...e];return t[s].disabled=!0,t})),await a[s].onApplySuggestion(a[s].commentId,a[s].suggestedText,a[s].changeType)}},n.applyBtnText()),N.createElement("div",{className:e.pagination},N.createElement("div",null,N.createElement(N.Fragment,null,N.createElement(Jt.m,{content:n.paginationPreviousTooltip(),relationship:"label"},N.createElement(ct.$,{icon:N.createElement(Ii.bP_,null),onClick:u,disabled:0==s,className:e.paginationButton})),N.createElement(Jt.m,{content:n.paginationNextTooltip(),relationship:"label"},N.createElement(ct.$,{icon:N.createElement(Ii.KOR,null),onClick:d,disabled:s+1>=a.length,className:e.paginationButton})))))),N.createElement("div",{className:e.contentBoxIcon},n.aiGeneratedDisclaimer())):N.createElement(N.Fragment,null,n.noResultFoundMessage()))},ou=(0,pt.Q)(ft.tR),lu={stack:{...gt.Pt.gap("16px")},header:{fontWeight:"600"},contentBox:{backgroundColor:ou.neutralLight,minHeight:"50px",position:"relative",...gt.Pt.padding("12px"),...gt.Pt.border("1px","solid",ou.neutralLighterAlt),...gt.Pt.borderRadius(ou.borderRadiusMedium)},footer:{width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",...gt.Pt.gap("12px")},pagination:{flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap",...gt.Pt.gap("10px")},paginationButton:{backgroundColor:ou.neutralLight,height:"24px",...gt.Pt.border("none"),"&:hover":{color:ou.themePrimary}},spinnerButton:{backgroundColor:ou.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:ou.themePrimary},"&:disabled":{color:ou.neutralLighterAlt,"&:hover":{color:ou.neutralLighterAlt}}},paginationNumberBox:{textAlign:"center",backgroundColor:ou.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box",...gt.Pt.border("1px","solid",ou.neutralLighterAlt),...gt.Pt.borderRadius(ou.borderRadiusMedium),...kt.g.caption1,...gt.Pt.padding("4px","8px")},dismissIcon:{marginLeft:"8px"},contentBoxIcon:{...kt.g.caption2,color:ou.neutralSecondaryAlt},disabledContentBoxIcon:{":hover":{color:ou.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:ou.themePrimary},contentBoxText:{marginBottom:"20px"},tableHeader:{fontWeight:"bold"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"},...(0,Ka.mO)()},cu=(0,mt.n)(lu);var uu=n(99130);const du=({styles:e,body:t})=>{const{headerText:n,reviewersWithAction:r,statusMessage:s,labelForReviewedPeople:i,labelForPendingPeople:a,commentsSummaryHeader:o,commentsSummaries:l}=t.reviewAgentIndividualCardProps.reviewAgentInternalCardProps,c=r.filter((e=>e.responded)).length,u=r.length-c,d=(0,it.Lh)(ut.ydw);return N.createElement(ht.W,{style:e.reviewStatusCardStyle},N.createElement(uu.D,null,n),N.createElement(lt.c,null,s),c>0&&hu(r,!0,i,e),u>0&&hu(r,!1,a,e),l.length>0&&l[0].length>0&&N.createElement("div",null,N.createElement(kc.Z,null,o),l.map(((e,t)=>N.createElement("p",{key:t},N.createElement(lt.c,{key:t},e))))),N.createElement(Eo.T,{className:e.footerAIGeneratedStyles},d))},hu=(e,t,n,r)=>N.createElement("div",{className:r.reviewSStatusReviewersListStyle},N.createElement(kc.Z,null,n),N.createElement(Fc.C,{"aria-label":"Reviewers List",className:r.reviewStatusCardWrapperStyle},e.map(((e,n)=>e.responded===t&&N.createElement(oo.v,{shape:"circular",media:N.createElement(lo.e,{name:e.suggestion.displayName,shape:"circular"}),dismissible:!1,key:n,size:"extra-small",value:e.suggestion.mail},e.suggestion.displayName))))),pu={reviewStatusCardStyle:{rowGap:"17px",display:"flex",flexDirection:"column"},reviewSStatusReviewersListStyle:{rowGap:"8px",display:"flex",flexDirection:"column"},reviewStatusCardWrapperStyle:{flexWrap:"wrap",rowGap:"8px"},footerAIGeneratedStyles:{color:(0,pt.Q)(ft.zQ).neutralSecondaryAlt},...(0,Ka.mO)()},gu=(0,mt.n)(pu),mu=({styles:e,body:t})=>{const n=t.reviewAgentIndividualCardProps.reviewAgentCardType,r=nu(),s=cu(),i=gu();let a,o;switch(n){case Sc.EntryPointCard:a=(0,dt.bt)(r,e),o=eu;break;case Sc.ConfirmInvitationCard:a=(0,dt.bt)({},e),o=Jc;break;case Sc.SuggestionCard:a=(0,dt.bt)(s,e),o=au;break;case Sc.ReviewStatusCard:a=(0,dt.bt)(i,e),o=du;break;default:a=(0,dt.bt)({},e),o=()=>N.createElement("div",null,"Invalid Card Type")}return N.createElement(o,{body:t,styles:a})};var fu=n(45998);const yu=({styles:e,handleApplyOnClick:t,handleApplyAllOnClick:n})=>{const r=(0,Nl.Kp)(),s=(0,Nl.XU)(),i=(0,Nl.n_)(),a=(0,Nl.WV)(),[o,l]=(0,N.useState)(!1),[c,u]=(0,N.useState)(!1),d=async()=>{l(!0),c?await n():await t(),l(!1)};return o?N.createElement(Jt.m,{content:a,relationship:"label"},N.createElement(ct.$,{className:(0,Bt.z)(e.spinnerButton,e.combinedButton),onClick:d,disabled:!0,icon:N.createElement(Vi.kJ9,{className:e.spinnerIcon})})):N.createElement(Es.W,{positioning:"below-end"},N.createElement(xs.c,{disableButtonEnhancement:!0},(t=>N.createElement(Jt.m,{content:r,relationship:"label"},N.createElement(ac.f,{menuButton:t,primaryActionButton:{onClick:d},size:"small",className:e.applyButton},c?i:s)))),N.createElement(As.b,null,N.createElement(Ps.c,null,N.createElement(ks.D,{onClick:()=>{u((e=>!e))}},c?s:i))))},vu=[{columnKey:"old",label:"Old Comment"},{columnKey:"new",label:"New Comment"}],bu=({styles:e={},body:t})=>{const n={changeSummary:(0,Nl.g1)(),locateTextIndexTooltip:(0,Nl.E)(),noResultFoundMessage:(0,Nl.FG)(),paginationNextTooltip:(0,Nl.mQ)(),paginationPreviousTooltip:(0,Nl.wP)(),removeTooltip:(0,Nl.HA)()},[r,s]=(0,N.useState)(0),[i,a]=(0,N.useState)([...t.commentIndices]),[o,l]=(0,N.useState)(!1);(0,N.useEffect)((()=>{r>=i.length&&s(i.length-1)}),[r,i.length]);const c=()=>s((e=>e-1)),u=()=>s((e=>e+1)),d=async()=>{l(!0),await t.locateTextIndex(i[r]),l(!1)},h=()=>{a((e=>{const t=[...e];return t.splice(r,1),t}))},p={styles:e,handleApplyOnClick:async()=>{await t.handleApplyOnClick(i[r])},handleApplyAllOnClick:async()=>{await t.handleApplyAllOnClick(i)}};return N.createElement(ht.W,{style:e.stack,customProperties:{tabIndex:-1}},i.length?N.createElement(N.Fragment,null,N.createElement("div",{className:e.header},n.changeSummary),N.createElement(si.X,{"aria-label":"2X2 table"},N.createElement("div",{className:e.header},N.createElement("p",null,"Author Email : ",t.commentIndices[r].authorEmail)),N.createElement(Ei.A,null,N.createElement(ai.H,null,vu.map((t=>N.createElement(xi.M,{key:t.columnKey,className:e.tableHeader},t.label))))),N.createElement(ii.B,null,N.createElement(ai.H,null,N.createElement(oi.n,null,N.createElement(fu.D,null,t.commentIndices[r].oldCommentText)),N.createElement(oi.n,null,N.createElement(fu.D,null,t.commentIndices[r].newCommentText))))),N.createElement("div",{className:e.contentBox},N.createElement("div",{className:e.contentBoxButtonGroup},N.createElement("div",{className:o?e.disabledContentBoxIcon:e.contentBoxIcon},o?N.createElement(Vi.xM0,{className:e.spinnerIcon}):N.createElement(Jt.m,{content:n.locateTextIndexTooltip,relationship:"label"},N.createElement(Ms.TRI,{onClick:d}))),o?N.createElement(N.Fragment,null):N.createElement("div",{className:(0,Bt.z)(e.contentBoxIcon,e.dismissIcon)},N.createElement(Jt.m,{content:n.removeTooltip,relationship:"label"},N.createElement(Ls.aYy,{onClick:h})))),N.createElement("div",{className:e.contentBoxText},r<i.length&&t.commentIndices[r].comment)),N.createElement("div",{className:e.footer},N.createElement("div",null,N.createElement(yu,{...p})),N.createElement("div",{className:e.pagination},N.createElement("div",{className:e.paginationNumberBox},r+1,"/",i.length),N.createElement("div",null,N.createElement(N.Fragment,null,N.createElement(Jt.m,{content:n.paginationPreviousTooltip,relationship:"label"},N.createElement(ct.$,{icon:N.createElement(ic.QWq,null),onClick:c,disabled:0==r,className:e.paginationButton})),N.createElement(Jt.m,{content:n.paginationNextTooltip,relationship:"label"},N.createElement(ct.$,{icon:N.createElement(ic.Bxo,null),onClick:u,disabled:r+1>=i.length,className:e.paginationButton}))))))):N.createElement(N.Fragment,null,n.noResultFoundMessage))},Cu=(0,pt.Q)(ft.tR),wu={stack:{textAlign:"start",textOverflow:"clip",...gt.Pt.gap("12px")},header:{fontWeight:"bold"},contentBox:{backgroundColor:Cu.neutralLight,minHeight:"50px",position:"relative",...gt.Pt.padding("12px"),...gt.Pt.border("1px","solid",Cu.neutralLighterAlt),...gt.Pt.borderRadius(Cu.borderRadiusMedium)},footer:{width:"100%",flexDirection:"row",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",...gt.Pt.gap("12px")},pagination:{flexDirection:"row",display:"flex",alignItems:"center",flexWrap:"wrap",...gt.Pt.gap("10px")},paginationButton:{backgroundColor:Cu.neutralLight,height:"24px",...gt.Pt.border("none"),"&:hover":{color:Cu.themePrimary}},spinnerButton:{backgroundColor:Cu.neutralLight},applyButton:{marginRight:"20px","&:hover":{color:Cu.themePrimary}},paginationNumberBox:{textAlign:"center",backgroundColor:Cu.neutralLight,marginRight:"8px",minWidth:"48px",height:"24px",boxSizing:"border-box",...gt.Pt.border("1px","solid",Cu.neutralLighterAlt),...gt.Pt.borderRadius(Cu.borderRadiusMedium),...kt.g.caption1,...gt.Pt.padding("4px","8px")},dismissIcon:{marginLeft:"8px"},contentBoxIcon:{":hover":{color:Cu.themePrimary,cursor:"pointer"}},disabledContentBoxIcon:{":hover":{color:Cu.themePrimary}},spinnerIcon:{animationIterationCount:"infinite",animationDuration:"2s",animationName:{"0%":{opacity:".2",transform:"rotate(0deg)"},"50%":{opacity:".6"},"100%":{opacity:".2",transform:"rotate(-360deg)"}},color:Cu.themePrimary},contentBoxText:{marginBottom:"20px"},tableHeader:{fontWeight:"bold"},contentBoxButtonGroup:{position:"absolute",bottom:0,right:0,transform:"translateX(-5px)",display:"flex"},...(0,Ka.mO)()},Su=(0,mt.n)(wu);class Eu{}Eu.Default="default",Eu.Emphasis="emphasis",Eu.Accent="accent",Eu.Good="good",Eu.Attention="attention",Eu.Warning="warning";class xu{}xu.Default="default",xu.Positive="positive",xu.Destructive="destructive";class Iu{}var Au,Pu,ku,Tu,Du,Mu,Lu,Ru,Nu,Ou,_u,Bu,Fu,Uu,Hu,zu,ju,Vu,qu,Wu,Qu,Gu,Zu,Yu,Ku,Ju,Xu,$u;Iu.Primary="primary",Iu.Secondary="secondary",function(e){e[e.Auto=0]="Auto",e[e.Stretch=1]="Stretch",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(Au||(Au={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(Pu||(Pu={})),function(e){e[e.Default=0]="Default",e[e.Stacked=1]="Stacked",e[e.Grid=2]="Grid"}(ku||(ku={})),function(e){e[e.Weight=0]="Weight",e[e.Pixel=1]="Pixel"}(Tu||(Tu={})),function(e){e[e.Small=0]="Small",e[e.Default=1]="Default",e[e.Medium=2]="Medium",e[e.Large=3]="Large",e[e.ExtraLarge=4]="ExtraLarge"}(Du||(Du={})),function(e){e[e.RevealOnHover=0]="RevealOnHover",e[e.Default=1]="Default"}(Mu||(Mu={})),function(e){e[e.Lighter=0]="Lighter",e[e.Default=1]="Default",e[e.Bolder=2]="Bolder"}(Lu||(Lu={})),function(e){e[e.Default=0]="Default",e[e.Monospace=1]="Monospace"}(Ru||(Ru={})),function(e){e[e.None=0]="None",e[e.Small=1]="Small",e[e.Default=2]="Default",e[e.Medium=3]="Medium",e[e.Large=4]="Large",e[e.ExtraLarge=5]="ExtraLarge",e[e.Padding=6]="Padding"}(Nu||(Nu={})),function(e){e[e.Default=0]="Default",e[e.Dark=1]="Dark",e[e.Light=2]="Light",e[e.Accent=3]="Accent",e[e.Good=4]="Good",e[e.Warning=5]="Warning",e[e.Attention=6]="Attention"}(Ou||(Ou={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(_u||(_u={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom"}(Bu||(Bu={})),function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right",e[e.Stretch=3]="Stretch"}(Fu||(Fu={})),function(e){e[e.Default=0]="Default",e[e.Person=1]="Person"}(Uu||(Uu={})),function(e){e[e.Inline=0]="Inline",e[e.Popup=1]="Popup"}(Hu||(Hu={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(zu||(zu={})),function(e){e[e.Cover=0]="Cover",e[e.RepeatHorizontally=1]="RepeatHorizontally",e[e.RepeatVertically=2]="RepeatVertically",e[e.Repeat=3]="Repeat"}(ju||(ju={})),function(e){e[e.LeftOfTitle=0]="LeftOfTitle",e[e.AboveTitle=1]="AboveTitle"}(Vu||(Vu={})),function(e){e[e.Text=0]="Text",e[e.Tel=1]="Tel",e[e.Url=2]="Url",e[e.Email=3]="Email",e[e.Password=4]="Password"}(qu||(qu={})),function(e){e[e.Inline=0]="Inline",e[e.Above=1]="Above"}(Wu||(Wu={})),function(e){e[e.Parse=0]="Parse",e[e.ToJSON=1]="ToJSON",e[e.Validation=2]="Validation"}(Qu||(Qu={})),function(e){e[e.Hint=0]="Hint",e[e.ActionTypeNotAllowed=1]="ActionTypeNotAllowed",e[e.CollectionCantBeEmpty=2]="CollectionCantBeEmpty",e[e.Deprecated=3]="Deprecated",e[e.ElementTypeNotAllowed=4]="ElementTypeNotAllowed",e[e.InteractivityNotAllowed=5]="InteractivityNotAllowed",e[e.InvalidPropertyValue=6]="InvalidPropertyValue",e[e.MissingCardType=7]="MissingCardType",e[e.PropertyCantBeNull=8]="PropertyCantBeNull",e[e.TooManyActions=9]="TooManyActions",e[e.UnknownActionType=10]="UnknownActionType",e[e.UnknownElementType=11]="UnknownElementType",e[e.UnsupportedCardVersion=12]="UnsupportedCardVersion",e[e.DuplicateId=13]="DuplicateId",e[e.UnsupportedProperty=14]="UnsupportedProperty",e[e.RequiredInputsShouldHaveLabel=15]="RequiredInputsShouldHaveLabel",e[e.RequiredInputsShouldHaveErrorMessage=16]="RequiredInputsShouldHaveErrorMessage",e[e.Other=17]="Other"}(Gu||(Gu={})),function(e){e[e.FullyInContainer=0]="FullyInContainer",e[e.Overflowing=1]="Overflowing",e[e.FullyOutOfContainer=2]="FullyOutOfContainer"}(Zu||(Zu={})),function(e){e[e.UnknownType=0]="UnknownType",e[e.ForbiddenType=1]="ForbiddenType"}(Yu||(Yu={})),function(e){e[e.Disabled=0]="Disabled",e[e.Manual=1]="Manual",e[e.Automatic=2]="Automatic"}(Ku||(Ku={})),function(e){e[e.Info=0]="Info",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(Ju||(Ju={})),function(e){e[e.NavigationNext=0]="NavigationNext",e[e.NavigationPrevious=1]="NavigationPrevious",e[e.Pagination=2]="Pagination",e[e.Autoplay=3]="Autoplay"}(Xu||(Xu={})),function(e){e[e.Button=0]="Button",e[e.Link=1]="Link",e[e.Tab=2]="Tab",e[e.Menu=3]="Menu",e[e.MenuItem=4]="MenuItem"}($u||($u={}));class ed{}ed.useAdvancedTextBlockTruncation=!0,ed.useAdvancedCardBottomTruncation=!1,ed.useMarkdownInRadioButtonAndCheckbox=!0,ed.allowMarkForTextHighlighting=!1,ed.alwaysBleedSeparators=!1,ed.enableFullJsonRoundTrip=!1,ed.displayInputValidationErrors=!0,ed.allowPreProcessingPropertyValues=!1,ed.setTabIndexAtCardRoot=!0,ed.enableFallback=!0,ed.useWebkitLineClamp=!0,ed.allowMoreThanMaxActionsInOverflowMenu=!1,ed.removePaddingFromContainersWithBackgroundImage=!1,ed.resetInputsDirtyStateAfterActionExecution=!0,ed.applets={logEnabled:!0,logLevel:Ju.Error,maximumRetryAttempts:3,defaultTimeBetweenRetryAttempts:3e3,authPromptWidth:400,authPromptHeight:600,refresh:{mode:Ku.Manual,timeBetweenAutomaticRefreshes:3e3,maximumConsecutiveAutomaticRefreshes:3,allowManualRefreshesAfterAutomaticRefreshes:!0}};const td="application/json",nd="application/x-www-form-urlencoded";class rd{constructor(){this._isProcessed=!1}getReferencedInputs(e,t){if(!t)throw new Error("The referencedInputs parameter cannot be null.");if(this._original)for(const n of e){null!=new RegExp("\\{{2}("+n.id+").value\\}{2}","gi").exec(this._original)&&n.id&&(t[n.id]=n)}}substituteInputValues(e,t){if(this._processed=this._original,this._original){const n=/\{{2}([a-z0-9_$@]+).value\}{2}/gi;let r;for(;null!==(r=n.exec(this._original))&&this._processed;)for(const n of Object.keys(e))if(n.toLowerCase()===r[1].toLowerCase()){const s=e[n];let i="";s.value&&(i=s.value),t===td?(i=JSON.stringify(i),i=i.slice(1,-1)):t===nd&&(i=encodeURIComponent(i)),this._processed=this._processed.replace(r[0],i);break}}this._isProcessed=!0}getOriginal(){return this._original}get(){return this._isProcessed?this._processed:this._original}set(e){this._original=e,this._isProcessed=!1}}class sd{constructor(e=0,t=0,n=0,r=0){this.left=0,this.top=0,this.right=0,this.bottom=0,this.top=e,this.right=t,this.bottom=n,this.left=r}}class id{constructor(e=Nu.None,t=Nu.None,n=Nu.None,r=Nu.None){this.top=Nu.None,this.right=Nu.None,this.bottom=Nu.None,this.left=Nu.None,this.top=e,this.right=t,this.bottom=n,this.left=r}}class ad{static parse(e,t=!1){const n=new ad(0,Tu.Weight);if("number"==typeof e)return n.physicalSize=e,n;if("string"==typeof e){const r=/^([0-9]+)(px|\*)?$/g.exec(e),s=t?3:2;if(r&&r.length>=s)return n.physicalSize=parseInt(r[1]),3===r.length&&"px"===r[2]&&(n.unit=Tu.Pixel),n}throw new Error("Invalid size: "+e)}constructor(e,t){this.physicalSize=e,this.unit=t}}class od{static generate(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return od.lut[255&e]+od.lut[e>>8&255]+od.lut[e>>16&255]+od.lut[e>>24&255]+"-"+od.lut[255&t]+od.lut[t>>8&255]+"-"+od.lut[t>>16&15|64]+od.lut[t>>24&255]+"-"+od.lut[63&n|128]+od.lut[n>>8&255]+"-"+od.lut[n>>16&255]+od.lut[n>>24&255]+od.lut[255&r]+od.lut[r>>8&255]+od.lut[r>>16&255]+od.lut[r>>24&255]}static initialize(){for(let e=0;e<256;e++)od.lut[e]=(e<16?"0":"")+e.toString(16)}}var ld;function cd(){return"__ac-"+od.generate()}function ud(e,t){t&&e.appendChild(t)}function dd(e,t){return"string"==typeof e?e:t}function hd(e,t){return"number"==typeof e?e:t}function pd(e,t){if("boolean"==typeof e)return e;if("string"==typeof e)switch(e.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}return t}function gd(e,t){for(const n in e){const r=parseInt(n,10);if(r>=0){const s=e[n];if(s&&"string"==typeof s&&s.toLowerCase()===t.toLowerCase())return r}}}function md(e){if(e){const t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi.exec(e);if(t&&t[4]){const e=parseInt(t[1],16)/255;return"rgba("+parseInt(t[2],16)+","+parseInt(t[3],16)+","+parseInt(t[4],16)+","+e+")"}}return e}function fd(e,t,n,r,s){const i=()=>t-e.scrollHeight>=-1;if(i())return;const a=function(e){const t=[];let n=yd(e,-1);for(;n<e.length;)" "===e[n]&&t.push(n),n=yd(e,n);return t}(n);let o=0,l=a.length,c=0;for(;o<l;){const e=Math.floor((o+l)/2);r(n,a[e]),i()?(c=a[e],o=e+1):l=e}if(r(n,c),s&&t-e.scrollHeight>=s-1){let e=yd(n,c);for(;e<n.length&&(r(n,e),i());)c=e,e=yd(n,e);r(n,c)}}od.lut=[],od.initialize();"undefined"==typeof window||null===(ld=window.trustedTypes)||void 0===ld||ld.createPolicy("adaptivecards#deprecatedExportedFunctionPolicy",{createHTML:e=>e});function yd(e,t){for(t+=1;t<e.length&&"<"===e[t];)for(;t<e.length&&">"!==e[t++];);return t}function vd(){return window.pageXOffset}function bd(){return window.pageYOffset}class Cd{}Cd.errors={unknownElementType:e=>`Unknown element type "${e}". Fallback will be used if present.`,unknownActionType:e=>`Unknown action type "${e}". Fallback will be used if present.`,elementTypeNotAllowed:e=>`Element type "${e}" is not allowed in this context.`,actionTypeNotAllowed:e=>`Action type "${e}" is not allowed in this context.`,invalidPropertyValue:(e,t)=>`Invalid value "${e}" for property "${t}".`,showCardMustHaveCard:()=>'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.',invalidColumnWidth:e=>`Invalid column width "${e}" - defaulting to "auto".`,invalidCardVersion:e=>`Invalid card version. Defaulting to "${e}".`,invalidVersionString:e=>`Invalid version string "${e}".`,propertyValueNotSupported:(e,t,n,r)=>`Value "${e}" for property "${t}" is supported in version ${n}, but you are using version ${r}.`,propertyNotSupported:(e,t,n)=>`Property "${e}" is supported in version ${t}, but you are using version ${n}.`,indexOutOfRange:e=>`Index out of range (${e}).`,elementCannotBeUsedAsInline:()=>"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline.",inlineAlreadyParented:()=>"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock.",interactivityNotAllowed:()=>"Interactivity is not allowed.",inputsMustHaveUniqueId:()=>"All inputs must have a unique Id.",choiceSetMustHaveAtLeastOneChoice:()=>"An Input.ChoiceSet must have at least one choice defined.",choiceSetChoicesMustHaveTitleAndValue:()=>"All choices in an Input.ChoiceSet must have their title and value properties set.",propertyMustBeSet:e=>`Property "${e}" must be set.`,actionHttpHeadersMustHaveNameAndValue:()=>"All headers of an Action.Http must have their name and value properties set.",tooManyActions:e=>`Maximum number of actions exceeded (${e}).`,tooLittleTimeDelay:e=>`Autoplay Delay is too short (${e}).`,tooManyCarouselPages:e=>`Maximum number of Carousel pages exceeded (${e}).`,invalidInitialPageIndex:e=>`InitialPage for carousel is invalid (${e}).`,columnAlreadyBelongsToAnotherSet:()=>"This column already belongs to another ColumnSet.",invalidCardType:()=>'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".',unsupportedCardVersion:(e,t)=>`The specified card version (${e}) is not supported or still in preview. The latest released card version is ${t}.`,duplicateId:e=>`Duplicate Id "${e}".`,markdownProcessingNotEnabled:()=>"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown",processMarkdownEventRemoved:()=>"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.",elementAlreadyParented:()=>"The element already belongs to another container.",actionAlreadyParented:()=>"The action already belongs to another element.",elementTypeNotStandalone:e=>`Elements of type ${e} cannot be used as standalone elements.`,invalidInputLabelWidth:()=>"Invalid input label width. Defaulting to label width from host config."},Cd.magicCodeInputCard={tryAgain:()=>"That didn't work... let's try again.",pleaseLogin:()=>'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"',enterMagicCode:()=>"Enter magic code",pleaseEnterMagicCodeYouReceived:()=>"Please enter the magic code you received.",submit:()=>"Submit",cancel:()=>"Cancel",somethingWentWrong:()=>"Something went wrong. This action can't be handled.",authenticationFailed:()=>"Authentication failed."},Cd.runtime={automaticRefreshPaused:()=>"Automatic refresh paused.",clckToRestartAutomaticRefresh:()=>"Click to restart.",refreshThisCard:()=>"Refresh this card"},Cd.hints={dontUseWeightedAndStrecthedColumnsInSameSet:()=>"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."},Cd.defaults={inlineActionTitle:()=>"Inline Action",overflowButtonText:()=>"...",overflowButtonTooltip:()=>"More options",emptyElementText:e=>`Empty ${e}`,mediaPlayerAriaLabel:()=>"Media content",mediaPlayerPlayMedia:()=>"Play media",youTubeVideoPlayer:()=>"YouTube video player",vimeoVideoPlayer:()=>"Vimeo video player",dailymotionVideoPlayer:()=>"Dailymotion video player",carouselNavigationPreviousTooltip:()=>"Previous carousel page",carouselNavigationNextTooltip:()=>"Next carousel page"};class wd{constructor(e=1,t=1,n){this._isValid=!0,this._major=e,this._minor=t,this._label=n}static parse(e,t){if(!e)return;const n=new wd;n._versionString=e;const r=/(\d+).(\d+)/gi.exec(e);return null!=r&&3===r.length?(n._major=parseInt(r[1]),n._minor=parseInt(r[2])):n._isValid=!1,n._isValid||t.logParseEvent(void 0,Gu.InvalidPropertyValue,Cd.errors.invalidVersionString(n._versionString)),n}toString(){return this._isValid?this._major+"."+this._minor:this._versionString}toJSON(){return this.toString()}compareTo(e){if(!this.isValid||!e.isValid)throw new Error("Cannot compare invalid version.");return this.major>e.major?1:this.major<e.major?-1:this.minor>e.minor?1:this.minor<e.minor?-1:0}get label(){return this._label?this._label:this.toString()}get major(){return this._major}get minor(){return this._minor}get isValid(){return this._isValid}}class Sd{static getAllDeclaredVersions(){const e=Sd,t=[];for(const n in e)if(n.match(/^v[0-9_]*$/))try{const r=e[n];r instanceof wd&&t.push(r)}catch(e){}return t.sort(((e,t)=>e.compareTo(t)))}}Sd.v1_0=new wd(1,0),Sd.v1_1=new wd(1,1),Sd.v1_2=new wd(1,2),Sd.v1_3=new wd(1,3),Sd.v1_4=new wd(1,4),Sd.v1_5=new wd(1,5),Sd.v1_6=new wd(1,6),Sd.latest=Sd.v1_6;class Ed{constructor(e=Sd.latest){this._validationEvents=[],this.targetVersion=e}isTemplateString(e){return"string"==typeof e&&e.startsWith("${")}tryDeleteValue(e,t){ed.enableFullJsonRoundTrip||delete e[t]}tryDeleteDefaultValue(e,t){ed.enableFullJsonRoundTrip&&this.isTemplateString(e[t])||delete e[t]}serializeValue(e,t,n,r=void 0,s=!1){null==n?ed.enableFullJsonRoundTrip&&!s||delete e[t]:n===r?ed.enableFullJsonRoundTrip&&!s&&this.isTemplateString(e[t])||delete e[t]:e[t]=n}serializeString(e,t,n,r){null==n?this.tryDeleteValue(e,t):n===r?this.tryDeleteDefaultValue(e,t):e[t]=n}serializeBool(e,t,n,r){null==n?this.tryDeleteValue(e,t):n===r?this.tryDeleteDefaultValue(e,t):e[t]=n}serializeNumber(e,t,n,r){null==n||isNaN(n)?this.tryDeleteValue(e,t):n===r?this.tryDeleteDefaultValue(e,t):e[t]=n}serializeEnum(e,t,n,r,s=void 0){null==r?this.tryDeleteValue(t,n):r===s?this.tryDeleteDefaultValue(t,n):t[n]=e[r]}serializeArray(e,t,n){const r=[];if(n)for(const e of n){let t;t=e instanceof _d?e.toJSON(this):e.toJSON?e.toJSON():e,void 0!==t&&r.push(t)}0===r.length?e.hasOwnProperty(t)&&Array.isArray(e[t])&&delete e[t]:this.serializeValue(e,t,r)}clearEvents(){this._validationEvents=[]}logEvent(e,t,n,r){this._validationEvents.push({source:e,phase:t,event:n,message:r})}logParseEvent(e,t,n){this.logEvent(e,Qu.Parse,t,n)}getEventAt(e){return this._validationEvents[e]}get eventCount(){return this._validationEvents.length}}class xd extends Ed{}class Id{getInternalName(){return this.name}parse(e,t,n){return t[this.name]}toJSON(e,t,n,r){r.serializeValue(t,this.name,n,this.defaultValue)}constructor(e,t,n,r){this.targetVersion=e,this.name=t,this.defaultValue=n,this.onGetInitialValue=r,this.isSerializationEnabled=!0,this.sequentialNumber=Id._sequentialNumber,Id._sequentialNumber++}}Id._sequentialNumber=0;class Ad extends Id{parse(e,t,n){const r=dd(t[this.name],this.defaultValue);if(!(void 0===r||""===r&&this.treatEmptyAsUndefined)&&void 0!==this.regEx){if(!this.regEx.exec(r))return void n.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.invalidPropertyValue(r,this.name))}return r}toJSON(e,t,n,r){r.serializeString(t,this.name,""===n&&this.treatEmptyAsUndefined?void 0:n,this.defaultValue)}constructor(e,t,n=!0,r,s,i){super(e,t,s,i),this.targetVersion=e,this.name=t,this.treatEmptyAsUndefined=n,this.regEx=r,this.defaultValue=s,this.onGetInitialValue=i}}class Pd extends Id{parse(e,t,n){return pd(t[this.name],this.defaultValue)}toJSON(e,t,n,r){r.serializeBool(t,this.name,n,this.defaultValue)}constructor(e,t,n,r){super(e,t,n,r),this.targetVersion=e,this.name=t,this.defaultValue=n,this.onGetInitialValue=r}}class kd extends Id{parse(e,t,n){return hd(t[this.name],this.defaultValue)}toJSON(e,t,n,r){r.serializeNumber(t,this.name,n,this.defaultValue)}constructor(e,t,n,r){super(e,t,n,r),this.targetVersion=e,this.name=t,this.defaultValue=n,this.onGetInitialValue=r}}class Td extends Id{isValidValue(e,t){for(const n of this.values)if(e.toLowerCase()===n.value.toLowerCase()){return(n.targetVersion?n.targetVersion:this.targetVersion).compareTo(t.targetVersion)<=0}return!1}parse(e,t,n){const r=t[this.name];if(void 0===r)return this.defaultValue;if("string"==typeof r)for(const t of this.values)if(r.toLowerCase()===t.value.toLowerCase()){const s=t.targetVersion?t.targetVersion:this.targetVersion;return s.compareTo(n.targetVersion)<=0?t.value:(n.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.propertyValueNotSupported(r,this.name,s.toString(),n.targetVersion.toString())),this.defaultValue)}return n.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.invalidPropertyValue(r,this.name)),this.defaultValue}toJSON(e,t,n,r){let s=!1;if(void 0!==n){s=!0;for(const t of this.values)if(t.value===n){const i=t.targetVersion?t.targetVersion:this.targetVersion;if(i.compareTo(r.targetVersion)<=0){s=!1;break}r.logEvent(e,Qu.ToJSON,Gu.InvalidPropertyValue,Cd.errors.propertyValueNotSupported(n,this.name,i.toString(),r.targetVersion.toString()))}}s||r.serializeValue(t,this.name,n,this.defaultValue,!0)}constructor(e,t,n,r,s){super(e,t,r,s),this.targetVersion=e,this.name=t,this.values=n,this.defaultValue=r,this.onGetInitialValue=s}}class Dd extends Id{parse(e,t,n){const r=t[this.name];if("string"!=typeof r)return this.defaultValue;const s=gd(this.enumType,r);if(void 0!==s)for(const t of this.values)if(t.value===s){const i=t.targetVersion?t.targetVersion:this.targetVersion;return i.compareTo(n.targetVersion)<=0?s:(n.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.propertyValueNotSupported(r,this.name,i.toString(),n.targetVersion.toString())),this.defaultValue)}return n.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.invalidPropertyValue(r,this.name)),this.defaultValue}toJSON(e,t,n,r){let s=!1;if(void 0!==n){s=!0;for(const t of this.values)if(t.value===n){if((t.targetVersion?t.targetVersion:this.targetVersion).compareTo(r.targetVersion)<=0){s=!1;break}r.logEvent(e,Qu.ToJSON,Gu.InvalidPropertyValue,Cd.errors.invalidPropertyValue(n,this.name))}}s||r.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)}constructor(e,t,n,r,s,i){if(super(e,t,r,i),this.targetVersion=e,this.name=t,this.enumType=n,this.defaultValue=r,this.onGetInitialValue=i,this._values=[],s)this._values=s;else for(const e in n){const t=parseInt(e,10);t>=0&&this._values.push({value:t})}}get values(){return this._values}}class Md extends Id{parse(e,t,n){const r=t[this.name];if(void 0===r)return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue;const s=new this.objectType;return s.parse(r,n),s}toJSON(e,t,n,r){let s;void 0===n||n.hasAllDefaultValues()||(s=n.toJSON(r)),"object"==typeof s&&0===Object.keys(s).length&&(s=void 0),r.serializeValue(t,this.name,s,this.defaultValue,!0)}constructor(e,t,n,r=!1,s){super(e,t,s,(e=>this.nullable?void 0:new this.objectType)),this.targetVersion=e,this.name=t,this.objectType=n,this.nullable=r}}class Ld extends Id{parse(e,t,n){const r=[],s=t[this.name];if(Array.isArray(s))for(const t of s){const s=new this.objectType;s.parse(t,n),r.push(s),this.onItemAdded&&this.onItemAdded(e,s)}return r.length>0?r:this.onGetInitialValue?this.onGetInitialValue(e):void 0}toJSON(e,t,n,r){r.serializeArray(t,this.name,n)}constructor(e,t,n,r){super(e,t,void 0,(e=>[])),this.targetVersion=e,this.name=t,this.objectType=n,this.onItemAdded=r}}class Rd extends Id{parse(e,t,n){return this.onParse(e,this,t,n)}toJSON(e,t,n,r){this.onToJSON(e,this,t,n,r)}constructor(e,t,n,r,s,i){if(super(e,t,s,i),this.targetVersion=e,this.name=t,this.onParse=n,this.onToJSON=r,this.defaultValue=s,this.onGetInitialValue=i,!this.onParse)throw new Error("CustomPropertyDefinition instances must have an onParse handler.");if(!this.onToJSON)throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.")}}class Nd{constructor(){this._properties=[]}indexOf(e){for(let t=0;t<this._properties.length;t++)if(this._properties[t]===e)return t;return-1}add(...e){for(const t of e)-1===this.indexOf(t)&&this._properties.push(t)}remove(...e){for(const t of e)for(;;){const e=this.indexOf(t);if(!(e>=0))break;this._properties.splice(e,1)}}getItemAt(e){return this._properties[e]}getCount(){return this._properties.length}}function Od(e){return function(t,n){const r=Object.getOwnPropertyDescriptor(t,n)||{};r.get||r.set||(r.get=function(){return this.getValue(e)},r.set=function(t){this.setValue(e,t)},Object.defineProperty(t,n,r))}}class _d{getDefaultSerializationContext(){return new xd}populateSchema(e){const t=this.constructor,n=[];for(const e in t)try{const r=t[e];r instanceof Id&&n.push(r)}catch(e){}if(n.length>0){const t=n.sort(((e,t)=>e.sequentialNumber>t.sequentialNumber?1:e.sequentialNumber<t.sequentialNumber?-1:0));e.add(...t)}_d.onRegisterCustomProperties&&_d.onRegisterCustomProperties(this,e)}getValue(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue}setValue(e,t){null==t?delete this._propertyBag[e.getInternalName()]:this._propertyBag[e.getInternalName()]=t}internalParse(e,t){if(this._propertyBag={},this._rawProperties=ed.enableFullJsonRoundTrip&&e||{},e){const n=this.getSchema();for(let r=0;r<n.getCount();r++){const s=n.getItemAt(r);if(s.isSerializationEnabled){let n=s.onGetInitialValue?s.onGetInitialValue(this):void 0;e.hasOwnProperty(s.name)&&(s.targetVersion.compareTo(t.targetVersion)<=0?n=s.parse(this,e,t):t.logParseEvent(this,Gu.UnsupportedProperty,Cd.errors.propertyNotSupported(s.name,s.targetVersion.toString(),t.targetVersion.toString()))),this.setValue(s,n)}}}else this.resetDefaultValues()}internalToJSON(e,t){const n=this.getSchema(),r=[];for(let s=0;s<n.getCount();s++){const i=n.getItemAt(s);i.isSerializationEnabled&&i.targetVersion.compareTo(t.targetVersion)<=0&&-1===r.indexOf(i.name)&&(i.toJSON(this,e,this.getValue(i),t),r.push(i.name))}}shouldSerialize(e){return!0}constructor(){this._propertyBag={},this._rawProperties={},this.maxVersion=_d.defaultMaxVersion;const e=this.getSchema();for(let t=0;t<e.getCount();t++){const n=e.getItemAt(t);n.onGetInitialValue&&this.setValue(n,n.onGetInitialValue(this))}}parse(e,t){this.internalParse(e,t||new xd)}toJSON(e){let t;if(e&&e instanceof Ed?t=e:(t=this.getDefaultSerializationContext(),t.toJSONOriginalParam=e),this.shouldSerialize(t)){let e;return e=ed.enableFullJsonRoundTrip&&this._rawProperties&&"object"==typeof this._rawProperties?this._rawProperties:{},this.internalToJSON(e,t),e}}hasDefaultValue(e){return this.getValue(e)===e.defaultValue}hasAllDefaultValues(){const e=this.getSchema();for(let t=0;t<e.getCount();t++){const n=e.getItemAt(t);if(!this.hasDefaultValue(n))return!1}return!0}resetDefaultValues(){const e=this.getSchema();for(let t=0;t<e.getCount();t++){const n=e.getItemAt(t);this.setValue(n,n.defaultValue)}}setCustomProperty(e,t){"string"==typeof t&&!t||null==t?delete this._rawProperties[e]:this._rawProperties[e]=t}getCustomProperty(e){return this._rawProperties[e]}getSchema(){let e=_d._schemaCache[this.getSchemaKey()];return e||(e=new Nd,this.populateSchema(e),_d._schemaCache[this.getSchemaKey()]=e),e}}_d.defaultMaxVersion=Sd.latest,_d._schemaCache={};class Bd extends _d{constructor(){super(...arguments),this._capabilities={}}getSchemaKey(){return"HostCapabilities"}internalParse(e,t){if(super.internalParse(e,t),e)for(const n in e){const r=e[n];if("string"==typeof r)if("*"===r)this.addCapability(n,"*");else{const e=wd.parse(r,t);(null==e?void 0:e.isValid)&&this.addCapability(n,e)}}}internalToJSON(e,t){super.internalToJSON(e,t);for(const t in this._capabilities)e[t]=this._capabilities[t]}addCapability(e,t){this._capabilities[e]=t}removeCapability(e){delete this._capabilities[e]}clear(){this._capabilities={}}hasCapability(e,t){return!!this._capabilities.hasOwnProperty(e)&&("*"===t||"*"===this._capabilities[e]||t.compareTo(this._capabilities[e])<=0)}areAllMet(e){for(const t in this._capabilities)if(!e.hasCapability(t,this._capabilities[t]))return!1;return!0}}function Fd(e,t,n){if("string"==typeof t){const r=function(e,t,n){if(!t)return n;const r=gd(e,t);return void 0!==r?r:n}(e,t,n);return void 0!==r?r:n}return"number"==typeof t?t:n}class Ud{constructor(e,t){this.default="#000000",this.subtle="#666666",e&&(this.default=e),t&&(this.subtle=t)}parse(e){e&&(this.default=e.default||this.default,this.subtle=e.subtle||this.subtle)}}class Hd extends Ud{constructor(){super(...arguments),this.highlightColors=new Ud("#22000000","#11000000")}parse(e){super.parse(e),e&&this.highlightColors.parse(e.highlightColors)}}class zd{constructor(e){this.allowCustomStyle=!1,e&&(this.allowCustomStyle=e.allowCustomStyle||this.allowCustomStyle)}}class jd{constructor(e){this.imageSize=Au.Medium,this.maxImageHeight=100,e&&(this.imageSize=null!=e.imageSize?e.imageSize:this.imageSize,this.maxImageHeight=hd(e.maxImageHeight,100))}toJSON(){return{imageSize:Au[this.imageSize],maxImageHeight:this.maxImageHeight}}}class Vd{constructor(e){this.allowInlinePlayback=!0,e&&(this.defaultPoster=e.defaultPoster,this.allowInlinePlayback=e.allowInlinePlayback||this.allowInlinePlayback)}toJSON(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}}}class qd{constructor(e){this.cellSpacing=8,e&&(this.cellSpacing=e.cellSpacing&&"number"==typeof e.cellSpacing?e.cellSpacing:this.cellSpacing)}toJSON(){return{cellSpacing:this.cellSpacing}}}class Wd{constructor(e){this.size=Du.Default,this.color=Ou.Default,this.isSubtle=!1,this.weight=Lu.Default,this.parse(e)}parse(e){e&&(this.size=Fd(Du,e.size,this.size),this.color=Fd(Ou,e.color,this.color),this.isSubtle=void 0!==e.isSubtle&&"boolean"==typeof e.isSubtle?e.isSubtle:this.isSubtle,this.weight=Fd(Lu,e.weight,this.getDefaultWeight()))}getDefaultWeight(){return Lu.Default}toJSON(){return{size:Du[this.size],color:Ou[this.color],isSubtle:this.isSubtle,weight:Lu[this.weight]}}}class Qd extends Wd{constructor(){super(...arguments),this.fontType=Ru.Default}parse(e){super.parse(e),e&&(this.fontType=Fd(Ru,e.fontType,this.fontType))}}class Gd{constructor(e){this.default=new Qd,this.heading=new Qd({size:"Large",weight:"Bolder"}),this.columnHeader=new Qd({weight:"Bolder"}),e&&(this.heading.parse(e.heading),this.columnHeader.parse(e.columnHeader))}getStyleByName(e){switch(e.toLowerCase()){case"heading":return this.heading;case"columnHeader":return this.columnHeader;default:return this.default}}}class Zd{constructor(e){e&&(this.headingLevel=hd(e.headingLevel))}}class Yd extends Wd{constructor(){super(...arguments),this.suffix=" *",this.suffixColor=Ou.Attention}parse(e){super.parse(e),e&&(this.suffix=e.suffix||this.suffix,this.suffixColor=Fd(Ou,e.suffixColor,this.suffixColor))}toJSON(){const e=super.toJSON();return e.suffix=this.suffix,e.suffixColor=Ou[this.suffixColor],e}}class Kd{constructor(e){this.inputSpacing=Nu.Small,this.width=30,this.requiredInputs=new Yd,this.optionalInputs=new Wd,e&&(this.inputSpacing=Fd(Nu,e.inputSpacing,this.inputSpacing),this.requiredInputs=new Yd(e.requiredInputs),this.optionalInputs=new Wd(e.optionalInputs),this.width=null!=e.width?e.width:this.width)}}class Jd{constructor(e){this.label=new Kd,this.errorMessage=new Wd({color:Ou.Attention}),this.debounceTimeInMilliSeconds=0,this.allowDynamicallyFilteredChoiceSet=!0,this.allowRevealOnHoverStyle=!1,e&&(this.label=new Kd(e.label),this.errorMessage=new Wd(e.errorMessage),this.allowRevealOnHoverStyle=e.allowRevealOnHoverStyle||this.allowRevealOnHoverStyle,this.allowDynamicallyFilteredChoiceSet=e.allowDynamicallyFilteredChoiceSet||this.allowDynamicallyFilteredChoiceSet,this.debounceTimeInMilliSeconds=e.debounceTimeInMilliSeconds||this.debounceTimeInMilliSeconds)}}class Xd extends Wd{constructor(){super(...arguments),this.wrap=!0}parse(e){super.parse(e),e&&(this.wrap=null!=e.wrap?e.wrap:this.wrap)}toJSON(){const e=super.toJSON();return e.wrap=this.wrap,e}}class $d extends Xd{constructor(e){super(e),this.maxWidth=150,this.weight=Lu.Bolder,e&&(this.maxWidth=null!=e.maxWidth?e.maxWidth:this.maxWidth,this.weight=Fd(Lu,e.weight,Lu.Bolder))}getDefaultWeight(){return Lu.Bolder}}class eh{constructor(e){this.title=new $d,this.value=new Xd,this.spacing=10,e&&(this.title=new $d(e.title),this.value=new Xd(e.value),this.spacing=e.spacing&&null!=e.spacing?e.spacing&&e.spacing:this.spacing)}}class th{constructor(e){this.actionMode=Hu.Inline,this.inlineTopMargin=16,this.style=Eu.Emphasis,e&&(this.actionMode=Fd(Hu,e.actionMode,Hu.Inline),this.inlineTopMargin=null!=e.inlineTopMargin?e.inlineTopMargin:this.inlineTopMargin,this.style=e.style&&"string"==typeof e.style?e.style:Eu.Emphasis)}toJSON(){return{actionMode:Hu[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}}}class nh{constructor(e){var t;if(this.maxActions=5,this.spacing=Nu.Default,this.buttonSpacing=20,this.showCard=new th,this.preExpandSingleShowCardAction=!1,this.actionsOrientation=zu.Horizontal,this.actionAlignment=Fu.Left,this.iconPlacement=Vu.LeftOfTitle,this.allowTitleToWrap=!1,this.showIconInOverflow=!1,this.iconSize=16,e){this.maxActions=null!=e.maxActions?e.maxActions:this.maxActions,this.spacing=Fd(Nu,e.spacing&&e.spacing,Nu.Default),this.buttonSpacing=null!=e.buttonSpacing?e.buttonSpacing:this.buttonSpacing,this.showCard=new th(e.showCard),this.preExpandSingleShowCardAction=pd(e.preExpandSingleShowCardAction,!1),this.actionsOrientation=Fd(zu,e.actionsOrientation,zu.Horizontal),this.actionAlignment=Fd(Fu,e.actionAlignment,Fu.Left),this.iconPlacement=Fd(Vu,e.iconPlacement,Vu.LeftOfTitle),this.allowTitleToWrap=null!=e.allowTitleToWrap?e.allowTitleToWrap:this.allowTitleToWrap,this.showIconInOverflow=null!==(t=e.showIconInOverflow)&&void 0!==t?t:this.showIconInOverflow;try{const t=ad.parse(e.iconSize);t.unit===Tu.Pixel&&(this.iconSize=t.physicalSize)}catch(e){}}}toJSON(){return{maxActions:this.maxActions,spacing:Nu[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:zu[this.actionsOrientation],actionAlignment:Fu[this.actionAlignment]}}}class rh{parseSingleColor(e,t){e&&this[t].parse(e[t])}constructor(e){this.default=new Hd,this.dark=new Hd,this.light=new Hd,this.accent=new Hd,this.good=new Hd,this.warning=new Hd,this.attention=new Hd,this.parse(e)}parse(e){e&&(this.parseSingleColor(e,"default"),this.parseSingleColor(e,"dark"),this.parseSingleColor(e,"light"),this.parseSingleColor(e,"accent"),this.parseSingleColor(e,"good"),this.parseSingleColor(e,"warning"),this.parseSingleColor(e,"attention"))}}class sh{parse(e){e&&(this.backgroundColor=e.backgroundColor,this.foregroundColors.parse(e.foregroundColors),this.highlightBackgroundColor=e.highlightBackgroundColor,this.highlightForegroundColor=e.highlightForegroundColor,this.borderColor=e.borderColor)}constructor(e){this.foregroundColors=new rh({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}}),this.parse(e)}get isBuiltIn(){return!1}}class ih extends sh{get isBuiltIn(){return!0}}class ah{constructor(e){if(this._allStyles={},this._allStyles[Eu.Default]=new ih,this._allStyles[Eu.Emphasis]=new ih,this._allStyles[Eu.Accent]=new ih,this._allStyles[Eu.Good]=new ih,this._allStyles[Eu.Attention]=new ih,this._allStyles[Eu.Warning]=new ih,e){this._allStyles[Eu.Default].parse(e[Eu.Default]),this._allStyles[Eu.Emphasis].parse(e[Eu.Emphasis]),this._allStyles[Eu.Accent].parse(e[Eu.Accent]),this._allStyles[Eu.Good].parse(e[Eu.Good]),this._allStyles[Eu.Attention].parse(e[Eu.Attention]),this._allStyles[Eu.Warning].parse(e[Eu.Warning]);const t=e.customStyles;if(t&&Array.isArray(t))for(const e of t)if(e){const t=e.name;t&&"string"==typeof t&&(this._allStyles.hasOwnProperty(t)?this._allStyles[t].parse(e.style):this._allStyles[t]=new sh(e.style))}}}toJSON(){const e=[];Object.keys(this._allStyles).forEach((t=>{this._allStyles[t].isBuiltIn||e.push({name:t,style:this._allStyles[t]})}));const t={default:this.default,emphasis:this.emphasis};return e.length>0&&(t.customStyles=e),t}getStyleByName(e,t){return e&&this._allStyles.hasOwnProperty(e)?this._allStyles[e]:t||this._allStyles[Eu.Default]}get default(){return this._allStyles[Eu.Default]}get emphasis(){return this._allStyles[Eu.Emphasis]}}class oh{constructor(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif",this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26},this.fontWeights={lighter:200,default:400,bolder:600},e&&(this.fontFamily=e)}parse(e){this.fontFamily=e.fontFamily||this.fontFamily,this.fontSizes={small:e.fontSizes&&e.fontSizes.small||this.fontSizes.small,default:e.fontSizes&&e.fontSizes.default||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes.medium||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes.large||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes.extraLarge||this.fontSizes.extraLarge},this.fontWeights={lighter:e.fontWeights&&e.fontWeights.lighter||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights.default||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights.bolder||this.fontWeights.bolder}}}oh.monospace=new oh("'Courier New', Courier, monospace");class lh{constructor(e){this.default=new oh,this.monospace=new oh("'Courier New', Courier, monospace"),e&&(this.default.parse(e.default),this.monospace.parse(e.monospace))}getStyleDefinition(e){switch(e){case Ru.Monospace:return this.monospace;case Ru.Default:default:return this.default}}}class ch{constructor(e){this.maxCarouselPages=10,this.minAutoplayDelay=5e3,e&&(this.maxCarouselPages=null!=e.maxCarouselPages?e.maxCarouselPages:this.maxCarouselPages,this.minAutoplayDelay=null!=e.minAutoplayDelay?e.minAutoplayDelay:this.minAutoplayDelay)}toJSON(){return{maxCarouselPages:this.maxCarouselPages,minAutoplayDelay:this.minAutoplayDelay}}}class uh{constructor(e){this.hostCapabilities=new Bd,this.choiceSetInputValueSeparator=",",this.supportsInteractivity=!0,this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15},this.separator={lineThickness:1,lineColor:"#EEEEEE"},this.imageSizes={small:40,medium:80,large:160},this.containerStyles=new ah,this.inputs=new Jd,this.actions=new nh,this.adaptiveCard=new zd,this.imageSet=new jd,this.media=new Vd,this.factSet=new eh,this.table=new qd,this.textStyles=new Gd,this.textBlock=new Zd,this.carousel=new ch,this.alwaysAllowBleed=!1,e&&(("string"==typeof e||e instanceof String)&&(e=JSON.parse(e)),this.choiceSetInputValueSeparator=e&&"string"==typeof e.choiceSetInputValueSeparator?e.choiceSetInputValueSeparator:this.choiceSetInputValueSeparator,this.supportsInteractivity=e&&"boolean"==typeof e.supportsInteractivity?e.supportsInteractivity:this.supportsInteractivity,this._legacyFontType=new oh,this._legacyFontType.parse(e),e.fontTypes&&(this.fontTypes=new lh(e.fontTypes)),e.lineHeights&&(this.lineHeights={small:e.lineHeights.small,default:e.lineHeights.default,medium:e.lineHeights.medium,large:e.lineHeights.large,extraLarge:e.lineHeights.extraLarge}),this.imageSizes={small:e.imageSizes&&e.imageSizes.small||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes.medium||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes.large||this.imageSizes.large},this.containerStyles=new ah(e.containerStyles),this.spacing={small:e.spacing&&e.spacing.small||this.spacing.small,default:e.spacing&&e.spacing.default||this.spacing.default,medium:e.spacing&&e.spacing.medium||this.spacing.medium,large:e.spacing&&e.spacing.large||this.spacing.large,extraLarge:e.spacing&&e.spacing.extraLarge||this.spacing.extraLarge,padding:e.spacing&&e.spacing.padding||this.spacing.padding},this.separator={lineThickness:e.separator&&e.separator.lineThickness||this.separator.lineThickness,lineColor:e.separator&&e.separator.lineColor||this.separator.lineColor},this.inputs=new Jd(e.inputs||this.inputs),this.actions=new nh(e.actions||this.actions),this.adaptiveCard=new zd(e.adaptiveCard||this.adaptiveCard),this.imageSet=new jd(e.imageSet),this.factSet=new eh(e.factSet),this.textStyles=new Gd(e.textStyles),this.textBlock=new Zd(e.textBlock),this.carousel=new ch(e.carousel))}getFontTypeDefinition(e){return this.fontTypes?this.fontTypes.getStyleDefinition(e):e===Ru.Monospace?oh.monospace:this._legacyFontType}getEffectiveImageSize(e){switch(e){case Au.Small:return this.imageSizes.small;case Au.Large:return this.imageSizes.large;case Au.Medium:default:return this.imageSizes.medium}}getEffectiveSpacing(e){switch(e){case Nu.Small:return this.spacing.small;case Nu.Default:return this.spacing.default;case Nu.Medium:return this.spacing.medium;case Nu.Large:return this.spacing.large;case Nu.ExtraLarge:return this.spacing.extraLarge;case Nu.Padding:return this.spacing.padding;default:return 0}}paddingDefinitionToSpacingDefinition(e){return new sd(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))}makeCssClassNames(...e){const t=[];for(const n of e)t.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+n);return t}makeCssClassName(...e){const t=this.makeCssClassNames(...e).join(" ");return t||""}get fontFamily(){return this._legacyFontType.fontFamily}set fontFamily(e){this._legacyFontType.fontFamily=e}get fontSizes(){return this._legacyFontType.fontSizes}get fontWeights(){return this._legacyFontType.fontWeights}}const dh=new uh({supportsInteractivity:!0,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{weight:Lu.Bolder,suffix:" *",suffixColor:Ou.Attention},optionalInputs:{weight:Lu.Bolder}},errorMessage:{color:Ou.Attention,weight:Lu.Bolder},debounceTimeInMilliSeconds:250},actions:{maxActions:5,spacing:Nu.Default,buttonSpacing:10,showCard:{actionMode:Hu.Inline,inlineTopMargin:16},actionsOrientation:zu.Horizontal,actionAlignment:Fu.Left},adaptiveCard:{allowCustomStyle:!1},imageSet:{imageSize:Au.Medium,maxImageHeight:100},factSet:{title:{color:Ou.Default,size:Du.Default,isSubtle:!1,weight:Lu.Bolder,wrap:!0,maxWidth:150},value:{color:Ou.Default,size:Du.Default,isSubtle:!1,weight:Lu.Default,wrap:!0},spacing:10},carousel:{maxCarouselPages:10,minAutoplayDuration:5e3},textBlock:{headingLevel:2}});class hh{constructor(e){this._regularExpression=e}format(e,t){let n;if(t){let r=t;for(;null!=(n=this._regularExpression.exec(t));)r=r.replace(n[0],this.internalFormat(e,n));return r}return t}}class ph extends hh{internalFormat(e,t){const n=new Date(Date.parse(t[1])),r=void 0!==t[2]?t[2].toLowerCase():"compact";return"compact"!==r?n.toLocaleDateString(e,{day:"numeric",weekday:r,month:r,year:"numeric"}):n.toLocaleDateString()}}class gh extends hh{internalFormat(e,t){return new Date(Date.parse(t[1])).toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})}}function mh(e,t){const n=[new ph(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new gh(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];let r=t;for(const t of n)r=t.format(e,r);return r}var fh=function(e,t,n,r){var s,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(i<3?s(a):i>3?s(t,n,a):s(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};class yh{constructor(){this.allIds={},this.validationEvents=[]}addFailure(e,t,n){this.validationEvents.push({phase:Qu.Validation,source:e,event:t,message:n})}}class vh extends _d{constructor(){super(...arguments),this._shouldFallback=!1}getSchemaKey(){return this.getJsonTypeName()}get requires(){return this.getValue(vh.requiresProperty)}contains(e){return!!this._renderedElement&&this._renderedElement.contains(e)}preProcessPropertyValue(e,t){const n=void 0===t?this.getValue(e):t;if(ed.allowPreProcessingPropertyValues){let t=this;for(;t&&!t.onPreProcessPropertyValue;)t=t.parent;if(t&&t.onPreProcessPropertyValue)return t.onPreProcessPropertyValue(this,e,n)}return n}setParent(e){this._parent=e}setShouldFallback(e){this._shouldFallback=e}shouldFallback(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)}getRootObject(){let e=this;for(;e.parent;)e=e.parent;return e}internalValidateProperties(e){this.id&&(e.allIds.hasOwnProperty(this.id)?(1===e.allIds[this.id]&&e.addFailure(this,Gu.DuplicateId,Cd.errors.duplicateId(this.id)),e.allIds[this.id]+=1):e.allIds[this.id]=1)}validateProperties(){const e=new yh;return this.internalValidateProperties(e),e}findDOMNodeOwner(e){return this.contains(e)?this:void 0}releaseDOMResources(){}get parent(){return this._parent}get renderedElement(){return this._renderedElement}}vh.typeNameProperty=new Ad(Sd.v1_0,"type",void 0,void 0,void 0,(e=>e.getJsonTypeName())),vh.idProperty=new Ad(Sd.v1_0,"id"),vh.requiresProperty=new Md(Sd.v1_2,"requires",Bd,!1,new Bd),fh([Od(vh.idProperty)],vh.prototype,"id",void 0),fh([Od(vh.requiresProperty)],vh.prototype,"requires",null);class bh{constructor(){this._items={}}findByName(e){return this._items.hasOwnProperty(e)?this._items[e]:void 0}clear(){this._items={}}copyTo(e){const t=Object.keys(this._items);for(const n of t){const t=this._items[n];e.register(t.typeName,t.objectType,t.schemaVersion)}}register(e,t,n=Sd.v1_0){let r=this.findByName(e);void 0!==r?r.objectType=t:r={typeName:e,objectType:t,schemaVersion:n},this._items[e]=r}unregister(e){delete this._items[e]}createInstance(e,t){const n=this.findByName(e);return n&&n.schemaVersion.compareTo(t)<=0?new n.objectType:void 0}getItemCount(){return Object.keys(this._items).length}getItemAt(e){return Object.keys(this._items).map((e=>this._items[e]))[e]}}class Ch{static populateWithDefaultElements(e){e.clear(),Ch.defaultElements.copyTo(e)}static populateWithDefaultActions(e){e.clear(),Ch.defaultActions.copyTo(e)}static get elements(){return Ch._elements||(Ch._elements=new bh,Ch.populateWithDefaultElements(Ch._elements)),Ch._elements}static get actions(){return Ch._actions||(Ch._actions=new bh,Ch.populateWithDefaultActions(Ch._actions)),Ch._actions}static reset(){Ch._elements=void 0,Ch._actions=void 0}}Ch.defaultElements=new bh,Ch.defaultActions=new bh;class wh{}wh.keys={tab:"Tab",enter:"Enter",escape:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",delete:"Delete"};class Sh{constructor(){this._items=[]}get(e){return this._items[e]}add(e){this._items.push(e),this.onItemAdded&&this.onItemAdded(e)}remove(e){const t=this._items.indexOf(e);t>=0&&(this._items=this._items.splice(t,1),this.onItemRemoved&&this.onItemRemoved(e))}indexOf(e){return this._items.indexOf(e)}get length(){return this._items.length}}class Eh{constructor(){this._isOpen=!1}keyDown(e){if(e.key===wh.keys.escape)this.closePopup(!0)}render(e){const t=document.createElement("div");return t.tabIndex=0,t.className=this.hostConfig.makeCssClassName("ac-ctrl","ac-ctrl-popup-container"),t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.onkeydown=e=>(this.keyDown(e),!e.cancelBubble),t.appendChild(this.renderContent()),t}focus(){this._popupElement&&this._popupElement.firstElementChild.focus()}popup(e){if(!this._isOpen){this._overlayElement=document.createElement("div"),this._overlayElement.className=this.hostConfig.makeCssClassName("ac-ctrl-overlay"),this._overlayElement.tabIndex=0,this._overlayElement.style.width=document.documentElement.scrollWidth+"px",this._overlayElement.style.height=document.documentElement.scrollHeight+"px",this._overlayElement.onfocus=e=>{this.closePopup(!0)},document.body.appendChild(this._overlayElement);const t=e.getBoundingClientRect();this._popupElement=this.render(t),this._popupElement.classList.remove(...this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight","ac-ctrl-slideRightToLeft","ac-ctrl-slideTopToBottom","ac-ctrl-slideRightToLeft")),window.addEventListener("resize",(e=>{this.closePopup(!0)}));const n=e.getAttribute("aria-label");n&&this._popupElement.setAttribute("aria-label",n),this._overlayElement.appendChild(this._popupElement);const r=this._popupElement.getBoundingClientRect(),s=window.innerHeight-t.bottom,i=t.top,a=window.innerWidth-t.right,o=t.left;let l,c=t.left+vd();if(i<r.height&&s<r.height){const e=Math.min(r.height,window.innerHeight);if(this._popupElement.style.maxHeight=e+"px",l=e<r.height?bd():bd()+t.top+(t.height-e)/2,o<r.width&&a<r.width){const e=Math.min(r.width,window.innerWidth);this._popupElement.style.maxWidth=e+"px",c=e<r.width?vd():vd()+t.left+(t.width-e)/2}else a>=r.width?(c=vd()+t.right,this._popupElement.classList.add(...this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideLeftToRight"))):(c=vd()+t.left-r.width,this._popupElement.classList.add(...this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideRightToLeft")))}else s>=r.height?(l=bd()+t.bottom,this._popupElement.classList.add(...this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideTopToBottom"))):(l=bd()+t.top-r.height,this._popupElement.classList.add(...this.hostConfig.makeCssClassNames("ac-ctrl-slide","ac-ctrl-slideBottomToTop"))),a<r.width&&(c=vd()+t.right-r.width);this._popupElement.style.left=c+"px",this._popupElement.style.top=l+"px",this._popupElement.focus(),this._isOpen=!0}}closePopup(e){this._isOpen&&(document.body.removeChild(this._overlayElement),this._isOpen=!1,this.onClose&&this.onClose(this,e))}get hostConfig(){return this._hostConfig?this._hostConfig:dh}set hostConfig(e){this._hostConfig=e}get isOpen(){return this._isOpen}}class xh extends Eh{constructor(){super(...arguments),this._items=new Sh,this._renderedItems=[],this._selectedIndex=-1}renderContent(){const e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-ctrl ac-popup"),e.setAttribute("role","menu");for(let t=0;t<this._items.length;t++){const n=this._items.get(t).render(this.hostConfig);n.tabIndex=0,e.appendChild(n),0==t&&n.setAttribute("aria-expanded","true"),t===this.selectedIndex&&n.focus(),this._renderedItems.push(n)}return e}keyDown(e){super.keyDown(e);let t=this._selectedIndex;switch(e.key){case wh.keys.tab:this.closePopup(!0);break;case wh.keys.up:t<=0?t=this._renderedItems.length-1:(t--,t<0&&(t=this._renderedItems.length-1)),this.selectedIndex=t,this.removeAriaExpanded(t),e.cancelBubble=!0;break;case wh.keys.down:t<0?t=0:(t++,t>=this._renderedItems.length&&(t=0),this.removeAriaExpanded(t)),this.selectedIndex=t,e.cancelBubble=!0}}get items(){return this._items}get selectedIndex(){return this._selectedIndex}set selectedIndex(e){e>=0&&e<this._renderedItems.length&&(this._renderedItems[e].focus(),this._selectedIndex=e)}removeAriaExpanded(e){"true"===this._renderedItems[e].getAttribute("aria-expanded")&&this._renderedItems[e].removeAttribute("aria-expanded")}}class Ih{click(){this.isEnabled&&this.onClick&&this.onClick(this)}updateCssClasses(){if(this._element){const e=this._hostConfig?this._hostConfig:dh;this._element.className=e.makeCssClassName("ac-ctrl"),this._element.classList.add(e.makeCssClassName(this.isEnabled?"ac-ctrl-dropdown-item":"ac-ctrl-dropdown-item-disabled")),this.isEnabled||this._element.classList.add(e.makeCssClassName("ac-disabled"))}}constructor(e,t,n){this._isEnabled=!0,this.key=e,this._value=t,this._iconUrl=n}toString(){return this.value}render(e){var t,n,r;if(this._hostConfig=e,!this._element){if(this._element=document.createElement("span"),this._element.setAttribute("role","menuitem"),this._element.style.display="flex",this._element.style.alignItems="center",this._element.style.justifyContent="left",this.isEnabled||this._element.setAttribute("aria-disabled","true"),this._iconUrl&&(null===(t=this._hostConfig)||void 0===t?void 0:t.actions.showIconInOverflow)){const e=null!==(r=null===(n=this._hostConfig)||void 0===n?void 0:n.actions.iconSize)&&void 0!==r?r:16,t=document.createElement("img");t.style.width=e+"px",t.style.height=e+"px",t.style.marginRight="6px",t.setAttribute("role","presentation"),t.src=this._iconUrl,this._element.appendChild(t)}const e=document.createElement("span");e.style.flex="0 1 auto",e.innerText=this.value,this._element.appendChild(e),this._element.setAttribute("aria-current","false"),this._element.onmouseup=e=>{this.click()},this._element.onkeydown=e=>{e.key===wh.keys.enter&&(e.stopPropagation(),e.preventDefault(),this.click())},this.updateCssClasses()}return this._element}get value(){return this._value}set value(e){this._value=e,this._element&&(this._element.innerText=e)}get isEnabled(){return this._isEnabled}set isEnabled(e){this._isEnabled!==e&&(this._isEnabled=e,this.updateCssClasses())}}var Ah,Ph,kh,Th=n(58651),Dh=function(e,t,n,r){var s,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(i<3?s(a):i>3?s(t,n,a):s(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},Mh=function(e,t,n,r){return new(n||(n=Promise))((function(s,i){function a(e){try{l(r.next(e))}catch(e){i(e)}}function o(e){try{l(r.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}l((r=r.apply(e,t||[])).next())}))};function Lh(e){var t,n;const r="undefined"==typeof window?"":null!==(n=null===(t=window.trustedTypes)||void 0===t?void 0:t.emptyHTML)&&void 0!==n?n:"";e.innerHTML=r}function Rh(e,t,n){if(t.spacing>0||t.lineThickness&&t.lineThickness>0){const r=document.createElement("div");r.className=e.makeCssClassName("ac-"+(n===zu.Horizontal?"horizontal":"vertical")+"-separator"),r.setAttribute("aria-hidden","true");const s=t.lineColor?md(t.lineColor):"";return n===zu.Horizontal?t.lineThickness?(r.style.paddingTop=t.spacing/2+"px",r.style.marginBottom=t.spacing/2+"px",r.style.borderBottom=t.lineThickness+"px solid "+s):r.style.height=t.spacing+"px":t.lineThickness?(r.style.paddingLeft=t.spacing/2+"px",r.style.marginRight=t.spacing/2+"px",r.style.borderRight=t.lineThickness+"px solid "+s):r.style.width=t.spacing+"px",r.style.overflow="hidden",r.style.flex="0 0 auto",r}}class Nh extends vh{constructor(){super(...arguments),this._truncatedDueToOverflow=!1}get lang(){const e=this.getValue(Nh.langProperty);return e||(this.parent?this.parent.lang:void 0)}set lang(e){this.setValue(Nh.langProperty,e)}get isVisible(){return this.getValue(Nh.isVisibleProperty)}set isVisible(e){ed.useAdvancedCardBottomTruncation&&!e&&this.undoOverflowTruncation(),this.isVisible!==e&&(this.setValue(Nh.isVisibleProperty,e),this.updateRenderedElementVisibility(),this._renderedElement&&Up(this)),this._renderedElement&&this._renderedElement.setAttribute("aria-expanded",e.toString())}internalRenderSeparator(){const e=Rh(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:void 0,lineColor:this.separator?this.hostConfig.separator.lineColor:void 0},this.separatorOrientation);if(ed.alwaysBleedSeparators&&e&&this.separatorOrientation===zu.Horizontal){const t=this.getParentContainer();if(t&&t.getEffectivePadding()){const n=this.hostConfig.paddingDefinitionToSpacingDefinition(t.getEffectivePadding());e.style.marginLeft="-"+n.left+"px",e.style.marginRight="-"+n.right+"px"}}return e}updateRenderedElementVisibility(){const e=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";this._renderedElement&&(e?this._renderedElement.style.display=e:this._renderedElement.style.removeProperty("display")),this._separatorElement&&(this.parent&&this.parent.isFirstElement(this)?this._separatorElement.style.display="none":e?this._separatorElement.style.display=e:this._separatorElement.style.removeProperty("display"))}hideElementDueToOverflow(){this._renderedElement&&this.isVisible&&(this._renderedElement.style.visibility="hidden",this.isVisible=!1,Up(this,!1))}showElementHiddenDueToOverflow(){this._renderedElement&&!this.isVisible&&(this._renderedElement.style.removeProperty("visibility"),this.isVisible=!0,Up(this,!1))}handleOverflow(e){if(this.isVisible||this.isHiddenDueToOverflow()){const t=this.truncateOverflow(e);this._truncatedDueToOverflow=t||this._truncatedDueToOverflow,t?t&&!this.isVisible&&this.showElementHiddenDueToOverflow():this.hideElementDueToOverflow()}}resetOverflow(){let e=!1;return this._truncatedDueToOverflow&&(this.undoOverflowTruncation(),this._truncatedDueToOverflow=!1,e=!0),this.isHiddenDueToOverflow()&&this.showElementHiddenDueToOverflow(),e}getDefaultSerializationContext(){return new Zp}createPlaceholderElement(){const e=md(this.getEffectiveStyleDefinition().foregroundColors.default.subtle),t=document.createElement("div");return t.style.border="1px dashed "+e,t.style.padding="4px",t.style.minHeight="32px",t.style.fontSize="10px",e&&(t.style.color=e),t.innerText=Cd.defaults.emptyElementText(this.getJsonTypeName()),t}adjustRenderedElementSize(e){"auto"===this.height?e.style.flex="0 0 auto":e.style.flex="1 1 auto"}updateInputsVisualState(e){const t=this.getAllInputs(),n=e?kh.MouseEnterOnCard:kh.MouseLeaveOnCard;t.forEach((e=>e.updateVisualState(n)))}isDisplayed(){return void 0!==this._renderedElement&&this.isVisible&&this._renderedElement.offsetHeight>0}overrideInternalRender(){return this.internalRender()}applyPadding(){if(this.separatorElement&&this.separatorOrientation===zu.Horizontal)if(ed.alwaysBleedSeparators&&!this.isBleeding()){const e=new id;this.getImmediateSurroundingPadding(e);const t=this.hostConfig.paddingDefinitionToSpacingDefinition(e);this.separatorElement.style.marginLeft="-"+t.left+"px",this.separatorElement.style.marginRight="-"+t.right+"px"}else this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0"}truncateOverflow(e){return!1}undoOverflowTruncation(){}getDefaultPadding(){return new id}getHasBackground(e=!1){return!1}getHasBorder(){return!1}getPadding(){return this._padding}setPadding(e){this._padding=e}shouldSerialize(e){return void 0!==e.elementRegistry.findByName(this.getJsonTypeName())}get useDefaultSizing(){return!0}get separatorOrientation(){return zu.Horizontal}get defaultStyle(){return Eu.Default}parse(e,t){super.parse(e,t||new Zp)}asString(){return""}isBleeding(){return!1}getEffectiveStyle(){return this.parent?this.parent.getEffectiveStyle():this.defaultStyle}getEffectiveStyleDefinition(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())}getEffectiveTextStyleDefinition(){return this.parent?this.parent.getEffectiveTextStyleDefinition():this.hostConfig.textStyles.default}getForbiddenActionTypes(){return[]}getImmediateSurroundingPadding(e,t=!0,n=!0,r=!0,s=!0){if(this.parent){let i=t&&this.parent.isTopElement(this),a=n&&this.parent.isRightMostElement(this),o=r&&this.parent.isBottomElement(this),l=s&&this.parent.isLeftMostElement(this);const c=this.parent.getEffectivePadding();c&&(i&&c.top!==Nu.None&&(e.top=c.top,i=!1),a&&c.right!==Nu.None&&(e.right=c.right,a=!1),o&&c.bottom!==Nu.None&&(e.bottom=c.bottom,o=!1),l&&c.left!==Nu.None&&(e.left=c.left,l=!1)),(i||a||o||l)&&this.parent.getImmediateSurroundingPadding(e,i,a,o,l)}}getActionCount(){return 0}getActionAt(e){throw new Error(Cd.errors.indexOutOfRange(e))}indexOfAction(e){for(let t=0;t<this.getActionCount();t++)if(this.getActionAt(t)===e)return t;return-1}remove(){return!!(this.parent&&this.parent instanceof Wh)&&this.parent.removeItem(this)}render(){return this._renderedElement=this.overrideInternalRender(),this._separatorElement=this.internalRenderSeparator(),this._renderedElement?(this.id&&(this._renderedElement.id=this.id),this.customCssSelector&&this._renderedElement.classList.add(this.customCssSelector),this._renderedElement.style.boxSizing="border-box",this._defaultRenderedElementDisplayMode=this._renderedElement.style.display?this._renderedElement.style.display:void 0,this.adjustRenderedElementSize(this._renderedElement),this.updateLayout(!1)):this.isDesignMode()&&(this._renderedElement=this.createPlaceholderElement()),this._renderedElement}updateLayout(e=!0){this.updateRenderedElementVisibility(),this.applyPadding()}updateActionsEnabledState(){const e=this.getRootElement().getAllActions();for(let t of e)t.updateEnabledState()}indexOf(e){return-1}isDesignMode(){const e=this.getRootElement();return e instanceof Qp&&e.designMode}isFirstElement(e){return!0}isLastElement(e){return!0}isAtTheVeryLeft(){return!this.parent||this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft()}isAtTheVeryRight(){return!this.parent||this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight()}isAtTheVeryTop(){return!this.parent||this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop()}isAtTheVeryBottom(){return!this.parent||this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom()}isBleedingAtTop(){return!1}isBleedingAtBottom(){return!1}isLeftMostElement(e){return!0}isRightMostElement(e){return!0}isTopElement(e){return this.isFirstElement(e)}isBottomElement(e){return this.isLastElement(e)}isHiddenDueToOverflow(){return void 0!==this._renderedElement&&"hidden"===this._renderedElement.style.visibility}getRootElement(){return this.getRootObject()}getParentContainer(){let e=this.parent;for(;e;){if(e instanceof Rp)return e;e=e.parent}}getAllInputs(e=!0){return[]}getAllActions(){const e=[];for(let t=0;t<this.getActionCount();t++){let n=this.getActionAt(t);n&&e.push(n)}return e}getResourceInformation(){return[]}getElementById(e){return this.id===e?this:void 0}getActionById(e){}getElementByIdFromAction(e){let t;for(let n=0;n<this.getActionCount();n++){const r=this.getActionAt(n);if(r instanceof Ap&&(t=r.card.getElementById(e),t))break}return t}getEffectivePadding(){const e=this.getPadding();return e||this.getDefaultPadding()}getEffectiveHorizontalAlignment(){return void 0!==this.horizontalAlignment?this.horizontalAlignment:this.parent?this.parent.getEffectiveHorizontalAlignment():_u.Left}get hostConfig(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:dh}set hostConfig(e){this._hostConfig=e}get index(){return this.parent?this.parent.indexOf(this):0}get isInteractive(){return!1}get isStandalone(){return!0}get isInline(){return!1}get hasVisibleSeparator(){return!(!this.parent||!this.separatorElement)&&(!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode()))}get separatorElement(){return this._separatorElement}get parent(){return this._parent}}Nh.langProperty=new Ad(Sd.v1_1,"lang",!0,/^[a-z]{2,3}$/gi),Nh.isVisibleProperty=new Pd(Sd.v1_2,"isVisible",!0),Nh.separatorProperty=new Pd(Sd.v1_0,"separator",!1),Nh.heightProperty=new Td(Sd.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto"),Nh.horizontalAlignmentProperty=new Dd(Sd.v1_0,"horizontalAlignment",_u),Nh.spacingProperty=new Dd(Sd.v1_0,"spacing",Nu,Nu.Default),Dh([Od(Nh.horizontalAlignmentProperty)],Nh.prototype,"horizontalAlignment",void 0),Dh([Od(Nh.spacingProperty)],Nh.prototype,"spacing",void 0),Dh([Od(Nh.separatorProperty)],Nh.prototype,"separator",void 0),Dh([Od(Nh.heightProperty)],Nh.prototype,"height",void 0),Dh([Od(Nh.langProperty)],Nh.prototype,"lang",null),Dh([Od(Nh.isVisibleProperty)],Nh.prototype,"isVisible",null);class Oh extends Id{parse(e,t,n){const r=e;return n.parseAction(r,t[this.name],this.forbiddenActionTypes,r.isDesignMode())}toJSON(e,t,n,r){r.serializeValue(t,this.name,n?n.toJSON(r):void 0,void 0,!0)}constructor(e,t,n=[]){super(e,t,void 0),this.targetVersion=e,this.name=t,this.forbiddenActionTypes=n}}class _h extends Nh{populateSchema(e){super.populateSchema(e),e.remove(_h.selectActionProperty)}get text(){return this.getValue(_h.textProperty)}set text(e){this.setText(e)}getFontSize(e){switch(this.effectiveSize){case Du.Small:return e.fontSizes.small;case Du.Medium:return e.fontSizes.medium;case Du.Large:return e.fontSizes.large;case Du.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}}getColorDefinition(e,t){switch(t){case Ou.Accent:return e.accent;case Ou.Dark:return e.dark;case Ou.Light:return e.light;case Ou.Good:return e.good;case Ou.Warning:return e.warning;case Ou.Attention:return e.attention;default:return e.default}}setText(e){this.setValue(_h.textProperty,e)}constructor(e){super(),this.ariaHidden=!1,e&&(this.text=e)}init(e){this.size=e.size,this.weight=e.weight,this.color=e.color,this.isSubtle=e.isSubtle}asString(){return this.text}applyStylesTo(e){const t=this.hostConfig.getFontTypeDefinition(this.effectiveFontType);let n;switch(t.fontFamily&&(e.style.fontFamily=t.fontFamily),this.effectiveSize){case Du.Small:n=t.fontSizes.small;break;case Du.Medium:n=t.fontSizes.medium;break;case Du.Large:n=t.fontSizes.large;break;case Du.ExtraLarge:n=t.fontSizes.extraLarge;break;default:n=t.fontSizes.default}e.style.fontSize=n+"px";const r=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor),s=md(this.effectiveIsSubtle?r.subtle:r.default);let i;switch(s&&(e.style.color=s),this.effectiveWeight){case Lu.Lighter:i=t.fontWeights.lighter;break;case Lu.Bolder:i=t.fontWeights.bolder;break;default:i=t.fontWeights.default}e.style.fontWeight=i.toString(),this.ariaHidden&&e.setAttribute("aria-hidden","true")}getAllActions(){const e=super.getAllActions();return this.selectAction&&e.push(this.selectAction),e}get effectiveColor(){return void 0!==this.color?this.color:this.getEffectiveTextStyleDefinition().color}get effectiveFontType(){return void 0!==this.fontType?this.fontType:this.getEffectiveTextStyleDefinition().fontType}get effectiveIsSubtle(){return void 0!==this.isSubtle?this.isSubtle:this.getEffectiveTextStyleDefinition().isSubtle}get effectiveSize(){return void 0!==this.size?this.size:this.getEffectiveTextStyleDefinition().size}get effectiveWeight(){return void 0!==this.weight?this.weight:this.getEffectiveTextStyleDefinition().weight}}_h.textProperty=new Ad(Sd.v1_0,"text",!0),_h.sizeProperty=new Dd(Sd.v1_0,"size",Du),_h.weightProperty=new Dd(Sd.v1_0,"weight",Lu),_h.colorProperty=new Dd(Sd.v1_0,"color",Ou),_h.isSubtleProperty=new Pd(Sd.v1_0,"isSubtle"),_h.fontTypeProperty=new Dd(Sd.v1_2,"fontType",Ru),_h.selectActionProperty=new Oh(Sd.v1_1,"selectAction",["Action.ShowCard"]),Dh([Od(_h.sizeProperty)],_h.prototype,"size",void 0),Dh([Od(_h.weightProperty)],_h.prototype,"weight",void 0),Dh([Od(_h.colorProperty)],_h.prototype,"color",void 0),Dh([Od(_h.fontTypeProperty)],_h.prototype,"fontType",void 0),Dh([Od(_h.isSubtleProperty)],_h.prototype,"isSubtle",void 0),Dh([Od(_h.textProperty)],_h.prototype,"text",null),Dh([Od(_h.selectActionProperty)],_h.prototype,"selectAction",void 0);class Bh extends _h{constructor(){super(...arguments),this.wrap=!1,this._treatAsPlainText=!0,this.useMarkdown=!0}restoreOriginalContent(){var e,t;if(void 0!==this.renderedElement){this.maxLines&&this.maxLines>0&&(this.renderedElement.style.maxHeight=this._computedLineHeight*this.maxLines+"px");const n=null!==(t=null===(e=Bh._ttRoundtripPolicy)||void 0===e?void 0:e.createHTML(this._originalInnerHtml))&&void 0!==t?t:this._originalInnerHtml;this.renderedElement.innerHTML=n}}truncateIfSupported(e){if(void 0!==this.renderedElement){const t=this.renderedElement.children,n=!t.length;if(n||1===t.length&&"p"===t[0].tagName.toLowerCase()&&!t[0].children.length){return function(e,t,n){fd(e,t,e.innerText,((t,n)=>{e.innerText=t.substring(0,n)+"..."}),n)}(n?this.renderedElement:t[0],e,this._computedLineHeight),!0}}return!1}setText(e){super.setText(e),this._processedText=void 0}internalRender(){var e,t;if(this._processedText=void 0,this.text){const n=this.preProcessPropertyValue(_h.textProperty),r=this.hostConfig;let s;if(this.forElementId){const e=document.createElement("label");e.htmlFor=this.forElementId,s=e}else s=document.createElement("div");if(s.classList.add(r.makeCssClassName("ac-textBlock")),s.style.overflow="hidden",this.applyStylesTo(s),"heading"===this.style){s.setAttribute("role","heading");const e=this.hostConfig.textBlock.headingLevel;void 0!==e&&e>0&&s.setAttribute("aria-level",e.toString())}if(this.selectAction&&r.supportsInteractivity&&(s.onclick=e=>{this.selectAction&&this.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,this.selectAction.execute())},this.selectAction.setupElementForAccessibility(s),this.selectAction.isEffectivelyEnabled()&&s.classList.add(r.makeCssClassName("ac-selectable"))),!this._processedText){this._treatAsPlainText=!0;let e=mh(this.lang,n);if(this.useMarkdown&&e){ed.allowMarkForTextHighlighting&&(e=e.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/"));const t=Qp.applyMarkdown(e);if(t.didProcess&&t.outputHtml){if(this._processedText=t.outputHtml,this._treatAsPlainText=!1,ed.allowMarkForTextHighlighting&&this._processedText){let e="";const t=this.getEffectiveStyleDefinition();t.highlightBackgroundColor&&(e+="background-color: "+t.highlightBackgroundColor+";"),t.highlightForegroundColor&&(e+="color: "+t.highlightForegroundColor+";"),e&&(e='style="'+e+'"'),this._processedText=this._processedText.replace(/===/g,"<mark "+e+">").replace(/\/==\//g,"</mark>")}}else this._processedText=e,this._treatAsPlainText=!0}else this._processedText=e,this._treatAsPlainText=!0}if(this._processedText||(this._processedText=""),this._treatAsPlainText)s.innerText=this._processedText;else{const n=null!==(t=null===(e=Bh._ttMarkdownPolicy)||void 0===e?void 0:e.createHTML(this._processedText))&&void 0!==t?t:this._processedText;s.innerHTML=n}if(s.firstElementChild instanceof HTMLElement){const e=s.firstElementChild;e.style.marginTop="0px",e.style.width="100%",this.wrap||(e.style.overflow="hidden",e.style.textOverflow="ellipsis")}s.lastElementChild instanceof HTMLElement&&(s.lastElementChild.style.marginBottom="0px");const i=s.getElementsByTagName("a");for(const e of Array.from(i))e.classList.add(r.makeCssClassName("ac-anchor")),e.target="_blank",e.onclick=t=>{Bp(this,e,t)&&(t.preventDefault(),t.cancelBubble=!0)},e.oncontextmenu=t=>!Bp(this,e,t)||(t.preventDefault(),t.cancelBubble=!0,!1);return this.wrap?(s.style.wordWrap="break-word",this.maxLines&&this.maxLines>0&&(s.style.overflow="hidden",void 0===window.document.documentMode&&ed.useWebkitLineClamp?(s.style.removeProperty("line-height"),s.style.display="-webkit-box",s.style.webkitBoxOrient="vertical",s.style.webkitLineClamp=this.maxLines.toString()):s.style.maxHeight=this._computedLineHeight*this.maxLines+"px")):(s.style.whiteSpace="nowrap",s.style.textOverflow="ellipsis"),(ed.useAdvancedTextBlockTruncation||ed.useAdvancedCardBottomTruncation)&&(this._originalInnerHtml=s.innerHTML),s}}truncateOverflow(e){return e>=this._computedLineHeight&&this.truncateIfSupported(e)}undoOverflowTruncation(){if(this.restoreOriginalContent(),ed.useAdvancedTextBlockTruncation&&this.maxLines){const e=this._computedLineHeight*this.maxLines;this.truncateIfSupported(e)}}applyStylesTo(e){switch(super.applyStylesTo(e),this.getEffectiveHorizontalAlignment()){case _u.Center:e.style.textAlign="center";break;case _u.Right:e.style.textAlign="end";break;default:e.style.textAlign="start"}const t=this.hostConfig.lineHeights;if(t)switch(this.effectiveSize){case Du.Small:this._computedLineHeight=t.small;break;case Du.Medium:this._computedLineHeight=t.medium;break;case Du.Large:this._computedLineHeight=t.large;break;case Du.ExtraLarge:this._computedLineHeight=t.extraLarge;break;default:this._computedLineHeight=t.default}else this._computedLineHeight=1.33*this.getFontSize(this.hostConfig.getFontTypeDefinition(this.effectiveFontType));e.style.lineHeight=this._computedLineHeight+"px"}getJsonTypeName(){return"TextBlock"}getEffectiveTextStyleDefinition(){return this.style?this.hostConfig.textStyles.getStyleByName(this.style):super.getEffectiveTextStyleDefinition()}updateLayout(e=!1){super.updateLayout(e),ed.useAdvancedTextBlockTruncation&&this.maxLines&&this.isDisplayed()&&(this.restoreOriginalContent(),this.truncateIfSupported(this._computedLineHeight*this.maxLines))}}Bh.wrapProperty=new Pd(Sd.v1_0,"wrap",!1),Bh.maxLinesProperty=new kd(Sd.v1_0,"maxLines"),Bh.styleProperty=new Td(Sd.v1_5,"style",[{value:"default"},{value:"columnHeader"},{value:"heading"}]),Bh._ttMarkdownPolicy="undefined"==typeof window||null===(Ah=window.trustedTypes)||void 0===Ah?void 0:Ah.createPolicy("adaptivecards#markdownPassthroughPolicy",{createHTML:e=>e}),Bh._ttRoundtripPolicy="undefined"==typeof window||null===(Ph=window.trustedTypes)||void 0===Ph?void 0:Ph.createPolicy("adaptivecards#restoreContentsPolicy",{createHTML:e=>e}),Dh([Od(Bh.wrapProperty)],Bh.prototype,"wrap",void 0),Dh([Od(Bh.maxLinesProperty)],Bh.prototype,"maxLines",void 0),Dh([Od(Bh.styleProperty)],Bh.prototype,"style",void 0);class Fh extends _h{constructor(){super(...arguments),this.italic=!1,this.strikethrough=!1,this.highlight=!1,this.underline=!1}populateSchema(e){super.populateSchema(e),e.add(_h.selectActionProperty)}internalRender(){if(this.text){const e=this.preProcessPropertyValue(_h.textProperty),t=this.hostConfig;let n=mh(this.lang,e);n||(n="");const r=document.createElement("span");if(r.classList.add(t.makeCssClassName("ac-textRun")),this.applyStylesTo(r),this.selectAction&&t.supportsInteractivity){const e=document.createElement("a");e.classList.add(t.makeCssClassName("ac-anchor"));const s=this.selectAction.getHref();e.href=s||"",e.target="_blank",e.onclick=e=>{this.selectAction&&this.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,this.selectAction.execute())},this.selectAction.setupElementForAccessibility(e),e.innerText=n,r.appendChild(e)}else r.innerText=n;return r}}applyStylesTo(e){if(super.applyStylesTo(e),this.italic&&(e.style.fontStyle="italic"),this.strikethrough&&(e.style.textDecoration="line-through"),this.highlight){const t=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor),n=md(this.effectiveIsSubtle?t.highlightColors.subtle:t.highlightColors.default);n&&(e.style.backgroundColor=n)}this.underline&&(e.style.textDecoration="underline")}getJsonTypeName(){return"TextRun"}get isStandalone(){return!1}get isInline(){return!0}}Fh.italicProperty=new Pd(Sd.v1_2,"italic",!1),Fh.strikethroughProperty=new Pd(Sd.v1_2,"strikethrough",!1),Fh.highlightProperty=new Pd(Sd.v1_2,"highlight",!1),Fh.underlineProperty=new Pd(Sd.v1_3,"underline",!1),Dh([Od(Fh.italicProperty)],Fh.prototype,"italic",void 0),Dh([Od(Fh.strikethroughProperty)],Fh.prototype,"strikethrough",void 0),Dh([Od(Fh.highlightProperty)],Fh.prototype,"highlight",void 0),Dh([Od(Fh.underlineProperty)],Fh.prototype,"underline",void 0);class Uh extends Nh{constructor(){super(...arguments),this._inlines=[]}internalAddInline(e,t=!1){if(!e.isInline)throw new Error(Cd.errors.elementCannotBeUsedAsInline());if(!(void 0===e.parent||t)&&e.parent!==this)throw new Error(Cd.errors.inlineAlreadyParented());e.setParent(this),this._inlines.push(e)}internalParse(e,t){if(super.internalParse(e,t),this._inlines=[],Array.isArray(e.inlines))for(const n of e.inlines){let e;if("string"==typeof n){const t=new Fh;t.text=n,e=t}else e=t.parseElement(this,n,[],!1);e&&this.internalAddInline(e,!0)}}internalToJSON(e,t){if(super.internalToJSON(e,t),this._inlines.length>0){const n=[];for(const e of this._inlines)n.push(e.toJSON(t));t.serializeValue(e,"inlines",n)}}internalRender(){if(this._inlines.length>0){let e;if(this.forElementId){const t=document.createElement("label");t.htmlFor=this.forElementId,e=t}else e=document.createElement("div");switch(e.className=this.hostConfig.makeCssClassName("ac-richTextBlock"),this.getEffectiveHorizontalAlignment()){case _u.Center:e.style.textAlign="center";break;case _u.Right:e.style.textAlign="end";break;default:e.style.textAlign="start"}let t=0;for(const n of this._inlines){const r=n.render();r&&(e.appendChild(r),t++)}if(t>0)return e}}asString(){let e="";for(const t of this._inlines)e+=t.asString();return e}getJsonTypeName(){return"RichTextBlock"}getInlineCount(){return this._inlines.length}getInlineAt(e){if(e>=0&&e<this._inlines.length)return this._inlines[e];throw new Error(Cd.errors.indexOutOfRange(e))}addInline(e){"string"==typeof e?this.internalAddInline(new Fh(e)):this.internalAddInline(e)}removeInline(e){const t=this._inlines.indexOf(e);return t>=0&&(this._inlines[t].setParent(void 0),this._inlines.splice(t,1),!0)}}class Hh extends _d{getSchemaKey(){return"Fact"}constructor(e,t){super(),this.name=e,this.value=t}}Hh.titleProperty=new Ad(Sd.v1_0,"title"),Hh.valueProperty=new Ad(Sd.v1_0,"value"),Dh([Od(Hh.titleProperty)],Hh.prototype,"name",void 0),Dh([Od(Hh.valueProperty)],Hh.prototype,"value",void 0);class zh extends Nh{get useDefaultSizing(){return!1}internalRender(){let e;const t=this.hostConfig;if(this.facts.length>0){e=document.createElement("table"),e.style.borderWidth="0px",e.style.borderSpacing="0px",e.style.borderStyle="none",e.style.borderCollapse="collapse",e.style.display="block",e.style.overflow="hidden",e.classList.add(t.makeCssClassName("ac-factset")),e.setAttribute("role","presentation");for(let n=0;n<this.facts.length;n++){const r=document.createElement("tr");n>0&&(r.style.marginTop=t.factSet.spacing+"px");let s=document.createElement("td");s.style.padding="0",s.classList.add(t.makeCssClassName("ac-fact-title")),t.factSet.title.maxWidth&&(s.style.maxWidth=t.factSet.title.maxWidth+"px"),s.style.verticalAlign="top";let i=new Bh;i.setParent(this),i.text=!this.facts[n].name&&this.isDesignMode()?"Title":this.facts[n].name,i.size=t.factSet.title.size,i.color=t.factSet.title.color,i.isSubtle=t.factSet.title.isSubtle,i.weight=t.factSet.title.weight,i.wrap=t.factSet.title.wrap,i.spacing=Nu.None,ud(s,i.render()),ud(r,s),s=document.createElement("td"),s.style.width="10px",ud(r,s),s=document.createElement("td"),s.style.padding="0",s.style.verticalAlign="top",s.classList.add(t.makeCssClassName("ac-fact-value")),i=new Bh,i.setParent(this),i.text=this.facts[n].value,i.size=t.factSet.value.size,i.color=t.factSet.value.color,i.isSubtle=t.factSet.value.isSubtle,i.weight=t.factSet.value.weight,i.wrap=t.factSet.value.wrap,i.spacing=Nu.None,ud(s,i.render()),ud(r,s),ud(e,r)}}return e}getJsonTypeName(){return"FactSet"}}zh.factsProperty=new Ld(Sd.v1_0,"facts",Hh),Dh([Od(zh.factsProperty)],zh.prototype,"facts",void 0);class jh extends Id{getInternalName(){return this.internalName}parse(e,t,n){let r;const s=t[this.name];if(void 0===s)return this.defaultValue;let i=!1;if("string"==typeof s){try{const e=ad.parse(s,!0);e.unit===Tu.Pixel&&(r=e.physicalSize,i=!0)}catch(e){}!i&&this.fallbackProperty&&(i=this.fallbackProperty.isValidValue(s,n))}return i||n.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.invalidPropertyValue(s,this.name)),r}toJSON(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")}constructor(e,t,n,r){super(e,t),this.targetVersion=e,this.name=t,this.internalName=n,this.fallbackProperty=r}}class Vh extends Nh{constructor(){super(...arguments),this.size=Au.Auto,this.style=Uu.Default}populateSchema(e){super.populateSchema(e),e.remove(Nh.heightProperty)}applySize(e){if(this.pixelWidth||this.pixelHeight)this.pixelWidth&&(e.style.width=this.pixelWidth+"px"),this.pixelHeight&&(e.style.height=this.pixelHeight+"px");else if(this.maxHeight)e.style.height=this.hostConfig.getEffectiveImageSize(this.size)+"px",e.style.maxHeight=this.maxHeight+"px";else{switch(this.size){case Au.Stretch:e.style.width="100%";break;case Au.Auto:e.style.maxWidth="100%";break;default:e.style.width=this.hostConfig.getEffectiveImageSize(this.size)+"px"}e.style.maxHeight="100%"}}get useDefaultSizing(){return!1}internalRender(){let e;if(this.url){e=document.createElement("div"),e.style.display="flex",e.style.alignItems="flex-start";const t=this.hostConfig;switch(this.getEffectiveHorizontalAlignment()){case _u.Center:e.style.justifyContent="center";break;case _u.Right:e.style.justifyContent="flex-end";break;default:e.style.justifyContent="flex-start"}const n=document.createElement("img");this.renderedImageElement=n,n.onload=e=>{_p(this)},n.onerror=e=>{if(this.renderedElement){const e=this.getRootElement();if(Lh(this.renderedElement),e&&e.designMode){const e=document.createElement("div");e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.backgroundColor="#EEEEEE",e.style.color="black",e.innerText=":-(",e.style.padding="10px",this.applySize(e),this.renderedElement.appendChild(e)}}_p(this)},n.style.minWidth="0",n.classList.add(t.makeCssClassName("ac-image")),this.selectAction&&t.supportsInteractivity&&(n.onkeypress=e=>{this.selectAction&&this.selectAction.isEffectivelyEnabled()&&("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),e.cancelBubble=!0,this.selectAction.execute())},n.onclick=e=>{this.selectAction&&this.selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,this.selectAction.execute())},this.selectAction.setupElementForAccessibility(n),this.selectAction.isEffectivelyEnabled()&&n.classList.add(t.makeCssClassName("ac-selectable"))),this.applySize(n),this.style===Uu.Person&&(n.style.borderRadius="50%",n.style.backgroundPosition="50% 50%",n.style.backgroundRepeat="no-repeat");const r=md(this.backgroundColor);r&&(n.style.backgroundColor=r),this.setImageSource(n);const s=this.preProcessPropertyValue(Vh.altTextProperty);s&&(n.alt=s),e.appendChild(n)}return e}getJsonTypeName(){return"Image"}getAllActions(){const e=super.getAllActions();return this.selectAction&&e.push(this.selectAction),e}getActionById(e){let t=super.getActionById(e);return!t&&this.selectAction&&(t=this.selectAction.getActionById(e)),t}getResourceInformation(){return this.url?[{url:this.url,mimeType:"image"}]:[]}setImageSource(e){const t=new qh(this.forceLoad,this.url);t.configureImage(this),e.src=this.preProcessPropertyValue(Vh.urlProperty),t.resetImage(this)}}Vh.urlProperty=new Ad(Sd.v1_0,"url"),Vh.altTextProperty=new Ad(Sd.v1_0,"altText"),Vh.backgroundColorProperty=new Ad(Sd.v1_1,"backgroundColor"),Vh.styleProperty=new Dd(Sd.v1_0,"style",Uu,Uu.Default),Vh.sizeProperty=new Dd(Sd.v1_0,"size",Au,Au.Auto),Vh.pixelWidthProperty=new jh(Sd.v1_1,"width","pixelWidth"),Vh.pixelHeightProperty=new jh(Sd.v1_1,"height","pixelHeight",Nh.heightProperty),Vh.selectActionProperty=new Oh(Sd.v1_1,"selectAction",["Action.ShowCard"]),Vh.shouldForceLoadProperty=new Pd(Sd.v1_6,"forceLoad",!1),Dh([Od(Vh.urlProperty)],Vh.prototype,"url",void 0),Dh([Od(Vh.altTextProperty)],Vh.prototype,"altText",void 0),Dh([Od(Vh.backgroundColorProperty)],Vh.prototype,"backgroundColor",void 0),Dh([Od(Vh.sizeProperty)],Vh.prototype,"size",void 0),Dh([Od(Vh.styleProperty)],Vh.prototype,"style",void 0),Dh([Od(Vh.pixelWidthProperty)],Vh.prototype,"pixelWidth",void 0),Dh([Od(Vh.pixelHeightProperty)],Vh.prototype,"pixelHeight",void 0),Dh([Od(Vh.selectActionProperty)],Vh.prototype,"selectAction",void 0),Dh([Od(Vh.shouldForceLoadProperty)],Vh.prototype,"forceLoad",void 0);class qh{constructor(e,t){this.doForceLoad=e,this.url=t,t&&t.length&&e&&(this.uniqueHash="?"+Date.now(),this.urlWithForceLoadOption=t+this.uniqueHash)}configureImage(e){this.urlWithForceLoadOption&&this.urlWithForceLoadOption.length&&(e.url=this.urlWithForceLoadOption)}resetImage(e){e.url=this.url}}class Wh extends Nh{constructor(){super(...arguments),this.allowVerticalOverflow=!1}populateSchema(e){super.populateSchema(e),this.isSelectable||e.remove(Wh.selectActionProperty)}isElementAllowed(e){return this.hostConfig.supportsInteractivity||!e.isInteractive}applyPadding(){if(super.applyPadding(),!this.renderedElement)return;let e=new sd;this.getEffectivePadding()&&(e=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=e.top+"px",this.renderedElement.style.paddingRight=e.right+"px",this.renderedElement.style.paddingBottom=e.bottom+"px",this.renderedElement.style.paddingLeft=e.left+"px",this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0"}get isSelectable(){return!1}forbiddenChildElements(){return[]}releaseDOMResources(){super.releaseDOMResources();for(let e=0;e<this.getItemCount();e++)this.getItemAt(e).releaseDOMResources()}internalValidateProperties(e){super.internalValidateProperties(e);for(let t=0;t<this.getItemCount();t++){const n=this.getItemAt(t);!this.hostConfig.supportsInteractivity&&n.isInteractive&&e.addFailure(this,Gu.InteractivityNotAllowed,Cd.errors.interactivityNotAllowed()),this.isElementAllowed(n)||e.addFailure(this,Gu.InteractivityNotAllowed,Cd.errors.elementTypeNotAllowed(n.getJsonTypeName())),n.internalValidateProperties(e)}this._selectAction&&this._selectAction.internalValidateProperties(e)}render(){const e=super.render();if(e){const t=this.hostConfig;this.allowVerticalOverflow&&(e.style.overflowX="hidden",e.style.overflowY="auto"),e&&this.isSelectable&&this._selectAction&&t.supportsInteractivity&&(e.onclick=e=>{this._selectAction&&this._selectAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,this._selectAction.execute())},e.onkeypress=e=>{this._selectAction&&this._selectAction.isEffectivelyEnabled()&&("Enter"===e.code||"Space"===e.code)&&(e.preventDefault(),e.cancelBubble=!0,this._selectAction.execute())},this._selectAction.setupElementForAccessibility(e),this._selectAction.isEffectivelyEnabled()&&e.classList.add(t.makeCssClassName("ac-selectable")))}return e}updateLayout(e=!0){if(super.updateLayout(e),e)for(let e=0;e<this.getItemCount();e++)this.getItemAt(e).updateLayout()}getAllInputs(e=!0){let t=[];for(let n=0;n<this.getItemCount();n++)t.push(...this.getItemAt(n).getAllInputs(e));return t}getAllActions(){const e=super.getAllActions();for(let t=0;t<this.getItemCount();t++)e.push(...this.getItemAt(t).getAllActions());return this._selectAction&&e.push(this._selectAction),e}getResourceInformation(){let e=[];for(let t=0;t<this.getItemCount();t++)e.push(...this.getItemAt(t).getResourceInformation());return e}getElementById(e){let t=super.getElementById(e);if(!t)for(let n=0;n<this.getItemCount()&&(t=this.getItemAt(n).getElementById(e),!t);n++);return t}findDOMNodeOwner(e){var t;let n;for(let t=0;t<this.getItemCount();t++)if(n=this.getItemAt(t).findDOMNodeOwner(e),n)return n;for(let r=0;r<this.getActionCount();r++)if(n=null===(t=this.getActionAt(r))||void 0===t?void 0:t.findDOMNodeOwner(e),n)return n;return super.findDOMNodeOwner(e)}}Wh.selectActionProperty=new Oh(Sd.v1_1,"selectAction",["Action.ShowCard"]),Dh([Od(Wh.selectActionProperty)],Wh.prototype,"_selectAction",void 0);class Qh extends Wh{constructor(){super(...arguments),this._images=[],this.imageSize=Pu.Medium,this.presentationStyle=ku.Default,this.pixelOffset=0}internalRender(){var e;let t;if(this._images.length>0){const n=this.presentationStyle===ku.Grid;let r;switch(t=document.createElement("div"),t.style.display="flex",t.style.flexWrap="wrap",t.classList.add(this.hostConfig.makeCssClassName("ac-imageSet")),t.classList.toggle(this.hostConfig.makeCssClassName("ac-imageSetStyle-grid"),n),t.style.gap="5px",this.imageSize){case Pu.Small:r=Au.Small;break;case Pu.Large:r=Au.Large;break;default:r=Au.Medium}const s=this.hostConfig.getEffectiveImageSize(r);for(const i of this._images){i.maxHeight=this.hostConfig.imageSet.maxImageHeight,n?i.pixelWidth=s:i.size=r;const a=i.render();if(a){if(a.style.display="inline-flex",a.style.margin="0px",n){a.style.flexBasis=s+"px",a.style.height=s+"px",a.style.flexGrow="0",a.style.flexShrink="0";const t=null===(e=i.renderedImageElement)||void 0===e?void 0:e.style;t&&(t.width="100%",t.height="100%",t.objectFit="cover",t.verticalAlign="middle")}ud(t,a)}}this.presentationStyle==ku.Stacked&&this.applyStackedPresentationStyle()}return t}applyStackedPresentationStyle(){if(this._images[0].renderedImageElement){let e=Gh.parseNumericPixelDimension(this._images[0].renderedImageElement.style.height),t=this.getEffectiveBackgroundColor();if(e){new Gh(this.pixelOffset,e,t).configureImagesArrayAsStackedLayout(this._images)}}}getEffectiveBackgroundColor(){let e=this.getParentContainer(),t=null==e?void 0:e.getEffectiveStyle();return md(this.hostConfig.containerStyles.getStyleByName(t,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle)).backgroundColor)}getItemCount(){return this._images.length}getItemAt(e){return this._images[e]}getFirstVisibleRenderedItem(){return this._images&&this._images.length>0?this._images[0]:void 0}getLastVisibleRenderedItem(){return this._images&&this._images.length>0?this._images[this._images.length-1]:void 0}removeItem(e){if(e instanceof Vh){const t=this._images.indexOf(e);if(t>=0)return this._images.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1}getJsonTypeName(){return"ImageSet"}addImage(e){if(e.parent)throw new Error("This image already belongs to another ImageSet");this._images.push(e),e.setParent(this)}indexOf(e){return e instanceof Vh?this._images.indexOf(e):-1}}Qh.imagesProperty=new Ld(Sd.v1_0,"images",Vh,((e,t)=>{t.setParent(e)})),Qh.imageSizeProperty=new Dd(Sd.v1_0,"imageSize",Pu,Pu.Medium),Qh.imagePresentationStyle=new Dd(Sd.v1_6,"style",ku,ku.Default),Qh.pixelOffset=new kd(Sd.v1_6,"offset",0,void 0),Dh([Od(Qh.imagesProperty)],Qh.prototype,"_images",void 0),Dh([Od(Qh.imageSizeProperty)],Qh.prototype,"imageSize",void 0),Dh([Od(Qh.imagePresentationStyle)],Qh.prototype,"presentationStyle",void 0),Dh([Od(Qh.pixelOffset)],Qh.prototype,"pixelOffset",void 0);class Gh{constructor(e,t,n){this.sign45=.7071,this.maxImageCounts=2,this.offset=0,this.normalizationConstant=0,this.border=5,this.dimension=0,this.dimension=t,this.normalizationConstant=2*(t*this.sign45-.5*t),this.offset=this.sign45*(Math.max(e,-t)-this.normalizationConstant),this.style=n||""}moveImageRight(e){e.style.marginLeft=this.offset+"px"}moveImageUp(e){e.style.marginBottom=this.offset+this.dimension+"px"}moveImageDown(e){e.style.marginTop=this.offset+this.dimension+"px"}makeImageRound(e){e.style.borderRadius="50%",e.style.backgroundPosition="50% 50%",e.style.backgroundRepeat="no-repeat"}applyBorder(e){e.style.height=this.dimension+2*this.border+"px",e.style.border=this.border+"px solid "+this.style}configureImageForBottomLeft(e){this.moveImageDown(e),this.makeImageRound(e),this.applyBorder(e),e.style.zIndex="2"}configureImageForTopRight(e){this.moveImageUp(e),this.moveImageRight(e),this.makeImageRound(e),e.style.zIndex="1"}configureImagesArrayAsStackedLayout(e){1==e.length?e[0].renderedImageElement&&this.makeImageRound(e[0].renderedImageElement):e.length<=this.maxImageCounts&&e[0].renderedImageElement&&e[1].renderedImageElement&&(this.configureImageForBottomLeft(e[0].renderedImageElement),this.configureImageForTopRight(e[1].renderedImageElement))}static parseNumericPixelDimension(e){if("px"==(null==e?void 0:e.substring(e.length-2)))return parseInt(e.substring(0,e.length-2))}}class Zh extends _d{constructor(e,t){super(),this.url=e,this.mimeType=t}isValid(){return!(!this.mimeType||!this.url)}}Zh.mimeTypeProperty=new Ad(Sd.v1_1,"mimeType"),Zh.urlProperty=new Ad(Sd.v1_1,"url"),Dh([Od(Zh.mimeTypeProperty)],Zh.prototype,"mimeType",void 0),Dh([Od(Zh.urlProperty)],Zh.prototype,"url",void 0);class Yh extends Zh{constructor(e,t,n){super(e,t),this.label=n}getSchemaKey(){return"CaptionSource"}render(){let e;return this.isValid()&&(e=document.createElement("track"),e.src=this.url,e.kind="captions",e.label=this.label),e}}Yh.labelProperty=new Ad(Sd.v1_6,"label"),Dh([Od(Yh.labelProperty)],Yh.prototype,"label",void 0);class Kh{play(){}get posterUrl(){return this._posterUrl}set posterUrl(e){this._posterUrl=e}get selectedMediaType(){}}class Jh extends Kh{processSources(){this._selectedSources=[],this._captionSources=[],this._selectedMediaType=void 0;for(const e of this.owner.sources){const t=e.mimeType?e.mimeType.split("/"):[];if(2===t.length){if(!this._selectedMediaType){const e=Jh.supportedMediaTypes.indexOf(t[0]);e>=0&&(this._selectedMediaType=Jh.supportedMediaTypes[e])}t[0]===this._selectedMediaType&&this._selectedSources.push(e)}}this._captionSources.push(...this.owner.captionSources)}constructor(e){super(),this.owner=e,this._selectedSources=[],this._captionSources=[],this.processSources()}canPlay(){return this._selectedSources.length>0}fetchVideoDetails(){return Mh(this,void 0,void 0,(function*(){}))}render(){"video"===this._selectedMediaType?this._mediaElement=document.createElement("video"):this._mediaElement=document.createElement("audio"),this._mediaElement.setAttribute("aria-label",this.owner.altText?this.owner.altText:Cd.defaults.mediaPlayerAriaLabel()),this._mediaElement.setAttribute("webkit-playsinline",""),this._mediaElement.setAttribute("playsinline",""),this._mediaElement.setAttribute("crossorigin",""),this._mediaElement.autoplay=!0,this._mediaElement.controls=!0,function(){const e=window.navigator.userAgent;return!!e.match(/Android/i)||!!e.match(/iPad/i)||!!e.match(/iPhone/i)}()&&(this._mediaElement.muted=!0),this._mediaElement.preload="none",this._mediaElement.style.width="100%";for(const e of this.owner.sources){const t=e.render();ud(this._mediaElement,t)}for(const e of this.owner.captionSources)if("vtt"==e.mimeType){const t=e.render();ud(this._mediaElement,t)}return this._mediaElement}play(){this._mediaElement&&this._mediaElement.play()}get selectedMediaType(){return this._selectedMediaType}}Jh.supportedMediaTypes=["audio","video"];class Xh extends Kh{constructor(e){super()}}class $h extends Xh{constructor(e,t){super(e),this.iFrameTitle=t,e.length>=2&&(this._videoId=e[1])}canPlay(){return void 0!==this._videoId}render(){let e=document.createElement("div");e.style.position="relative",e.style.width="100%",e.style.height="0",e.style.paddingBottom="56.25%";let t=document.createElement("iframe");return t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.src=this.getEmbedVideoUrl(),t.frameBorder="0",this.iFrameTitle&&(t.title=this.iFrameTitle),t.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",t.allowFullscreen=!0,e.appendChild(t),e}get videoId(){return this._videoId}}class ep extends $h{fetchVideoDetails(){return Mh(this,void 0,void 0,(function*(){const e=`https://vimeo.com/api/oembed.json?url=${this.getEmbedVideoUrl()}`;let t=yield fetch(e);if(t.ok){let e=yield t.json();this.posterUrl=e.thumbnail_url}}))}getEmbedVideoUrl(){return`https://player.vimeo.com/video/${this.videoId}?autoplay=1`}}class tp extends $h{fetchVideoDetails(){return Mh(this,void 0,void 0,(function*(){const e=`https://api.dailymotion.com/video/${this.videoId}?fields=thumbnail_720_url`;let t=yield fetch(e);if(t.ok){let e=yield t.json();this.posterUrl=e.thumbnail_720_url}}))}getEmbedVideoUrl(){return`https://www.dailymotion.com/embed/video/${this.videoId}?autoplay=1`}}class np extends $h{constructor(e,t){super(e,t),this.iFrameTitle=t,e.length>=3&&void 0!==e[2]&&(this._startTimeIndex=parseInt(e[2]))}fetchVideoDetails(){return Mh(this,void 0,void 0,(function*(){this.posterUrl=this.videoId?`https://img.youtube.com/vi/${this.videoId}/maxresdefault.jpg`:void 0}))}getEmbedVideoUrl(){let e=`https://www.youtube.com/embed/${this.videoId}?autoplay=1`;return void 0!==this._startTimeIndex&&(e+=`&start=${this._startTimeIndex}`),e}}class rp extends Nh{constructor(){super(...arguments),this.sources=[],this.captionSources=[]}createMediaPlayer(){for(let e of rp.customMediaPlayers)for(let t of this.sources)if(t.url)for(let n of e.urlPatterns){let r=n.exec(t.url);if(null!==r)return e.createMediaPlayer(r)}return new Jh(this)}handlePlayButtonInvoke(e){if(this.hostConfig.media.allowInlinePlayback){if(e.preventDefault(),e.cancelBubble=!0,this.renderedElement){const e=this._mediaPlayer.render();Lh(this.renderedElement),this.renderedElement.appendChild(e),this._mediaPlayer.play(),e.focus()}}else rp.onPlay&&(e.preventDefault(),e.cancelBubble=!0,rp.onPlay(this))}displayPoster(){return Mh(this,void 0,void 0,(function*(){if(this.renderedElement){const e=12,t=15,n=document.createElement("div");n.className=this.hostConfig.makeCssClassName("ac-media-poster"),n.setAttribute("role","contentinfo"),n.setAttribute("aria-label",this.altText?this.altText:Cd.defaults.mediaPlayerAriaLabel()),n.style.position="relative",n.style.display="flex";let r=this.poster?this.poster:this._mediaPlayer.posterUrl;if(r||(r=this.hostConfig.media.defaultPoster),r){const e=document.createElement("img");e.style.width="100%",e.style.height="100%",e.setAttribute("role","presentation"),e.onerror=t=>{e.parentNode&&e.parentNode.removeChild(e),n.classList.add("empty"),n.style.minHeight="150px"},e.src=r,n.appendChild(e)}else n.classList.add("empty"),n.style.minHeight="150px";if(this.hostConfig.supportsInteractivity&&this._mediaPlayer.canPlay()){const r=document.createElement("div");r.tabIndex=0,r.setAttribute("role","button"),r.setAttribute("aria-label",Cd.defaults.mediaPlayerPlayMedia()),r.className=this.hostConfig.makeCssClassName("ac-media-playButton"),r.style.display="flex",r.style.alignItems="center",r.style.justifyContent="center",r.onclick=e=>{this.handlePlayButtonInvoke(e)},r.onkeypress=e=>{"Enter"!==e.code&&"Space"!==e.code||this.handlePlayButtonInvoke(e)};const s=document.createElement("div");s.className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow"),s.style.width=e+"px",s.style.height=t+"px",s.style.borderTopWidth=t/2+"px",s.style.borderBottomWidth=t/2+"px",s.style.borderLeftWidth=e+"px",s.style.borderRightWidth="0",s.style.borderStyle="solid",s.style.borderTopColor="transparent",s.style.borderRightColor="transparent",s.style.borderBottomColor="transparent",s.style.transform="translate("+e/10+"px,0px)",r.appendChild(s);const i=document.createElement("div");i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.width="100%",i.style.height="100%",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.appendChild(r),n.appendChild(i)}Lh(this.renderedElement),this.renderedElement.appendChild(n)}}))}internalRender(){const e=document.createElement("div");return e.className=this.hostConfig.makeCssClassName("ac-media"),e}render(){let e=super.render();return e&&(this._mediaPlayer=this.createMediaPlayer(),this._mediaPlayer.fetchVideoDetails().then((()=>this.displayPoster()))),e}releaseDOMResources(){super.releaseDOMResources(),this.displayPoster()}getJsonTypeName(){return"Media"}getResourceInformation(){const e=[];if(this._mediaPlayer){const t=this.poster?this.poster:this.hostConfig.media.defaultPoster;t&&e.push({url:t,mimeType:"image"})}for(const t of this.sources)t.isValid()&&e.push({url:t.url,mimeType:t.mimeType});for(const t of this.captionSources)t.isValid()&&e.push({url:t.url,mimeType:t.mimeType});return e}get selectedMediaType(){return this._mediaPlayer.selectedMediaType}}rp.customMediaPlayers=[{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?youtube.com\/watch\?(?=.*v=([\w\d-_]+))(?=(?:.*t=(\d+))?).*/gi,/^(?:https?:\/\/)?youtu.be\/([\w\d-_]+)(?:\?t=(\d+))?/gi],createMediaPlayer:e=>new np(e,Cd.defaults.youTubeVideoPlayer())},{urlPatterns:[/^(?:https?:\/\/)?vimeo.com\/([\w\d-_]+).*/gi],createMediaPlayer:e=>new ep(e,Cd.defaults.vimeoVideoPlayer())},{urlPatterns:[/^(?:https?:\/\/)?(?:www.)?dailymotion.com\/video\/([\w\d-_]+).*/gi],createMediaPlayer:e=>new tp(e,Cd.defaults.dailymotionVideoPlayer())}],rp.sourcesProperty=new Ld(Sd.v1_1,"sources",class extends Zh{getSchemaKey(){return"MediaSource"}render(){let e;return this.isValid()&&(e=document.createElement("source"),e.src=this.url,e.type=this.mimeType),e}}),rp.captionSourcesProperty=new Ld(Sd.v1_6,"captionSources",Yh),rp.posterProperty=new Ad(Sd.v1_1,"poster"),rp.altTextProperty=new Ad(Sd.v1_1,"altText"),Dh([Od(rp.sourcesProperty)],rp.prototype,"sources",void 0),Dh([Od(rp.captionSourcesProperty)],rp.prototype,"captionSources",void 0),Dh([Od(rp.posterProperty)],rp.prototype,"poster",void 0),Dh([Od(rp.altTextProperty)],rp.prototype,"altText",void 0),function(e){e[e.InitialRender=0]="InitialRender",e[e.MouseEnterOnCard=1]="MouseEnterOnCard",e[e.MouseLeaveOnCard=2]="MouseLeaveOnCard",e[e.FocusLeave=3]="FocusLeave"}(kh||(kh={}));class sp extends Nh{constructor(){super(...arguments),this.inputStyle=Mu.Default}getAllLabelIds(){const e=[];return this.labelledBy&&e.push(this.labelledBy),this._renderedLabelElement&&e.push(this._renderedLabelElement.id),this._renderedErrorMessageElement&&e.push(this._renderedErrorMessageElement.id),e}updateInputControlAriaLabelledBy(){if(this._renderedInputControlElement){const e=this.getAllLabelIds();e.length>0?this._renderedInputControlElement.setAttribute("aria-labelledby",e.join(" ")):this._renderedInputControlElement.removeAttribute("aria-labelledby")}}get isNullable(){return!0}get renderedInputControlElement(){return this._renderedInputControlElement}get inputControlContainerElement(){return this._inputControlContainerElement}overrideInternalRender(){const e=this.hostConfig;this._outerContainerElement=document.createElement("div"),this._outerContainerElement.style.display="flex",this.labelPosition===Wu.Inline?this._outerContainerElement.style.flexDirection="row":this._outerContainerElement.style.flexDirection="column";const t=cd();if(this.label){const n=new Uh;n.setParent(this),n.forElementId=t;const r=new Fh(this.label);if(n.addInline(r),this.isRequired){r.init(e.inputs.label.requiredInputs);const t=new Fh(e.inputs.label.requiredInputs.suffix);t.color=e.inputs.label.requiredInputs.suffixColor,t.ariaHidden=!0,n.addInline(t)}else r.init(e.inputs.label.optionalInputs);this._renderedLabelElement=n.render(),this._renderedLabelElement&&(this._renderedLabelElement.id=cd(),this.labelPosition===Wu.Inline?this._renderedLabelElement.style.alignSelf="center":this._renderedLabelElement.style.marginBottom=e.getEffectiveSpacing(e.inputs.label.inputSpacing)+"px",this._outerContainerElement.appendChild(this._renderedLabelElement))}if(this._inputControlContainerElement=document.createElement("div"),this._inputControlContainerElement.className=e.makeCssClassName("ac-input-container"),this._inputControlContainerElement.style.display="flex","stretch"===this.height&&(this._inputControlContainerElement.style.alignItems="stretch",this._inputControlContainerElement.style.flex="1 1 auto"),this._renderedInputControlElement=this.internalRender(),this._renderedInputControlElement){if(this._renderedInputControlElement.id=t,this._renderedInputControlElement.style.minWidth="0px",this.isNullable&&this.isRequired&&(this._renderedInputControlElement.classList.add(e.makeCssClassName("ac-input-required")),(this._renderedInputControlElement instanceof HTMLInputElement||this._renderedInputControlElement instanceof HTMLSelectElement)&&this._renderedInputControlElement.setAttribute("aria-required","true")),this._inputControlContainerElement.appendChild(this._renderedInputControlElement),this._outerContainerElement.appendChild(this._inputControlContainerElement),this._renderedLabelElement&&this.labelPosition===Wu.Inline)if(this.labelWidth){if(this.labelWidth.unit==Tu.Weight){const e=this.labelWidth.physicalSize;this._renderedLabelElement.style.width=e.toString()+"%",this._inputControlContainerElement.style.width=(100-e).toString()+"%"}else if(this.labelWidth.unit==Tu.Pixel){const e=this.labelWidth.physicalSize;this._renderedLabelElement.style.width=e.toString()+"px"}}else{const t=e.inputs.label.width;this._renderedLabelElement.style.width=t.toString()+"%",this._inputControlContainerElement.style.width=100-t+"%"}return this.updateVisualState(kh.InitialRender),this._renderedInputControlElement&&(this._renderedInputControlElement.onblur=e=>{this.updateVisualState(kh.FocusLeave)}),this.updateInputControlAriaLabelledBy(),this._outerContainerElement}this.resetDirtyState()}valueChanged(){this.getRootElement().updateActionsEnabledState(),this.isValid()&&this.resetValidationFailureCue(),this.onValueChanged&&this.onValueChanged(this),function(e){const t=e.getRootElement(),n=t&&t.onInputValueChanged?t.onInputValueChanged:Qp.onInputValueChanged;n&&n(e)}(this)}resetValidationFailureCue(){this.renderedInputControlElement&&(this instanceof cp&&this.isDynamicTypeahead()?this.removeValidationFailureCue():this.renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.updateInputControlAriaLabelledBy(),this._renderedErrorMessageElement&&(this._outerContainerElement.removeChild(this._renderedErrorMessageElement),this._renderedErrorMessageElement=void 0))}showValidationErrorMessage(){if(this.renderedElement&&this.errorMessage&&ed.displayInputValidationErrors){const e=new Bh;e.setParent(this),e.text=this.errorMessage,e.wrap=!0,e.init(this.hostConfig.inputs.errorMessage),this._renderedErrorMessageElement=e.render(),this._renderedErrorMessageElement&&(this._renderedErrorMessageElement.id=cd(),this._outerContainerElement.appendChild(this._renderedErrorMessageElement),this.updateInputControlAriaLabelledBy())}}get allowRevealOnHoverStyle(){return this.hostConfig.inputs&&this.hostConfig.inputs.allowRevealOnHoverStyle}shouldHideInputAdornersForRevealOnHover(e,t){const n=e===document.activeElement,r=this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onhover"),s=e.classList.contains(r);return t===kh.InitialRender||t===kh.FocusLeave&&!s||t===kh.MouseLeaveOnCard&&!n}updateVisualState(e){this.allowRevealOnHoverStyle&&this._renderedInputControlElement&&this.inputStyle===Mu.RevealOnHover&&(e===kh.InitialRender?this._renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onrender")):e===kh.MouseEnterOnCard?this._renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onhover")):e===kh.MouseLeaveOnCard&&this._renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onhover")))}focus(){this._renderedInputControlElement&&this._renderedInputControlElement.focus()}isValid(){return!0}isDirty(){return this.value!==this._oldValue}resetDirtyState(){this._oldValue=this.value}internalValidateProperties(e){super.internalValidateProperties(e),this.id||e.addFailure(this,Gu.PropertyCantBeNull,Cd.errors.inputsMustHaveUniqueId()),this.isRequired&&(this.label||e.addFailure(this,Gu.RequiredInputsShouldHaveLabel,"Required inputs should have a label"),this.errorMessage||e.addFailure(this,Gu.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message"))}validateValue(){this.resetValidationFailureCue();const e=this.isRequired?this.isSet()&&this.isValid():this.isValid();return!e&&this.renderedInputControlElement&&(this instanceof cp&&this.isDynamicTypeahead()?this.showValidationFailureCue():this.renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed")),this.showValidationErrorMessage()),e}getAllInputs(e=!0){return[this]}render(){let e=super.render();return this.resetDirtyState(),e}get isInteractive(){return!0}}sp.labelProperty=new Ad(Sd.v1_3,"label",!0),sp.isRequiredProperty=new Pd(Sd.v1_3,"isRequired",!1),sp.errorMessageProperty=new Ad(Sd.v1_3,"errorMessage",!0),sp.inputStyleProperty=new Dd(Sd.v1_6,"inputStyle",Mu,Mu.Default,[{value:Mu.RevealOnHover},{value:Mu.Default}]),sp.labelWidthProperty=new Rd(Sd.v1_6,"labelWidth",((e,t,n,r)=>{let s=t.defaultValue;const i=n[t.name];let a=!1;if("number"!=typeof i||isNaN(i))if("string"==typeof i)try{s=ad.parse(i)}catch(e){a=!0}else a=!0;else s=new ad(i,Tu.Weight),(s.physicalSize<0||s.physicalSize>100)&&(a=!0);return a&&(r.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.invalidInputLabelWidth()),s=void 0),s}),((e,t,n,r,s)=>{r instanceof ad&&(r.unit===Tu.Pixel?s.serializeValue(n,"labelWidth",r.physicalSize+"px"):s.serializeNumber(n,"labelWidth",r.physicalSize))}),void 0),sp.labelPositionProperty=new Dd(Sd.v1_6,"labelPosition",Wu,Wu.Above,[{value:Wu.Inline},{value:Wu.Above}]),Dh([Od(sp.labelProperty)],sp.prototype,"label",void 0),Dh([Od(sp.isRequiredProperty)],sp.prototype,"isRequired",void 0),Dh([Od(sp.errorMessageProperty)],sp.prototype,"errorMessage",void 0),Dh([Od(sp.inputStyleProperty)],sp.prototype,"inputStyle",void 0),Dh([Od(sp.labelWidthProperty)],sp.prototype,"labelWidth",void 0),Dh([Od(sp.labelPositionProperty)],sp.prototype,"labelPosition",void 0);class ip extends sp{constructor(){super(...arguments),this.isMultiline=!1,this.style=qu.Text}setupInput(e){e.style.flex="1 1 auto",e.tabIndex=this.isDesignMode()?-1:0,this.placeholder&&(e.placeholder=this.placeholder,e.setAttribute("aria-label",this.placeholder)),this.defaultValue&&(e.value=this.defaultValue),this.maxLength&&this.maxLength>0&&(e.maxLength=this.maxLength),e.oninput=()=>{this.valueChanged()},e.onkeypress=e=>{e.ctrlKey&&"Enter"===e.code&&this.inlineAction&&this.inlineAction.isEffectivelyEnabled()&&this.inlineAction.execute()}}internalRender(){let e;return this.isMultiline&&this.style!==qu.Password?(e=document.createElement("textarea"),e.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline"),"stretch"===this.height&&(e.style.height="initial")):(e=document.createElement("input"),e.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput"),e.type=qu[this.style].toLowerCase()),this.setupInput(e),e}overrideInternalRender(){const e=super.overrideInternalRender();if(this.inlineAction){const e=document.createElement("button");if(e.className=this.hostConfig.makeCssClassName(this.inlineAction.isEffectivelyEnabled()?"ac-inlineActionButton":"ac-inlineActionButton-disabled"),e.onclick=e=>{this.inlineAction&&this.inlineAction.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,this.inlineAction.execute())},this.inlineAction.iconUrl){e.classList.add("iconOnly");const t=document.createElement("img");t.style.height="100%",t.setAttribute("role","presentation"),t.style.display="none",t.onload=()=>{t.style.removeProperty("display")},t.onerror=()=>{e.removeChild(t),e.classList.remove("iconOnly"),e.classList.add("textOnly"),e.textContent=this.inlineAction&&this.inlineAction.title?this.inlineAction.title:Cd.defaults.inlineActionTitle()},t.src=this.inlineAction.iconUrl,e.appendChild(t),e.title=this.inlineAction.title?this.inlineAction.title:Cd.defaults.inlineActionTitle()}else e.classList.add("textOnly"),e.textContent=this.inlineAction.title?this.inlineAction.title:Cd.defaults.inlineActionTitle();this.inlineAction.setupElementForAccessibility(e,!0),e.style.marginLeft="8px",this.inputControlContainerElement.appendChild(e)}return e}updateVisualState(e){this.allowRevealOnHoverStyle&&(this.inlineAction||this.isMultiline||super.updateVisualState(e))}getJsonTypeName(){return"Input.Text"}getAllActions(){const e=super.getAllActions();return this.inlineAction&&e.push(this.inlineAction),e}getActionById(e){let t=super.getActionById(e);return!t&&this.inlineAction&&(t=this.inlineAction.getActionById(e)),t}isSet(){return!!this.value}isValid(){return!this.value||(!this.regex||new RegExp(this.regex,"g").test(this.value))}get value(){return this.renderedInputControlElement?(this.isMultiline,this.renderedInputControlElement.value):void 0}}ip.valueProperty=new Ad(Sd.v1_0,"value"),ip.maxLengthProperty=new kd(Sd.v1_0,"maxLength"),ip.isMultilineProperty=new Pd(Sd.v1_0,"isMultiline",!1),ip.placeholderProperty=new Ad(Sd.v1_0,"placeholder"),ip.styleProperty=new Dd(Sd.v1_0,"style",qu,qu.Text,[{value:qu.Text},{value:qu.Tel},{value:qu.Url},{value:qu.Email},{value:qu.Password,targetVersion:Sd.v1_5}]),ip.inlineActionProperty=new Oh(Sd.v1_0,"inlineAction",["Action.ShowCard"]),ip.regexProperty=new Ad(Sd.v1_3,"regex",!0),Dh([Od(ip.valueProperty)],ip.prototype,"defaultValue",void 0),Dh([Od(ip.maxLengthProperty)],ip.prototype,"maxLength",void 0),Dh([Od(ip.isMultilineProperty)],ip.prototype,"isMultiline",void 0),Dh([Od(ip.placeholderProperty)],ip.prototype,"placeholder",void 0),Dh([Od(ip.styleProperty)],ip.prototype,"style",void 0),Dh([Od(ip.inlineActionProperty)],ip.prototype,"inlineAction",void 0),Dh([Od(ip.regexProperty)],ip.prototype,"regex",void 0);class ap extends sp{constructor(){super(...arguments),this.valueOn="true",this.valueOff="false",this.wrap=!1}updateInputControlAriaLabelledBy(){if(this._checkboxInputElement){let e=this.getAllLabelIds().join(" ");this._checkboxInputLabelElement&&this._checkboxInputLabelElement.id&&(e+=" "+this._checkboxInputLabelElement.id),e?this._checkboxInputElement.setAttribute("aria-labelledby",e):this._checkboxInputElement.removeAttribute("aria-labelledby")}}internalRender(){const e=document.createElement("div");if(e.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput"),e.style.width="100%",e.style.display="flex",e.style.alignItems="center",this._checkboxInputElement=document.createElement("input"),this._checkboxInputElement.id=cd(),this._checkboxInputElement.type="checkbox",this._checkboxInputElement.style.display="inline-block",this._checkboxInputElement.style.verticalAlign="middle",this._checkboxInputElement.style.margin="0",this._checkboxInputElement.style.flex="0 0 auto",this.title&&this._checkboxInputElement.setAttribute("aria-label",this.title),this.isRequired&&this._checkboxInputElement.setAttribute("aria-required","true"),this._checkboxInputElement.tabIndex=this.isDesignMode()?-1:0,this.defaultValue===this.valueOn&&(this._checkboxInputElement.checked=!0),this._oldCheckboxValue=this._checkboxInputElement.checked,this._checkboxInputElement.onchange=()=>{this.valueChanged()},ud(e,this._checkboxInputElement),this.title||this.isDesignMode()){const t=new Bh;if(t.setParent(this),t.forElementId=this._checkboxInputElement.id,t.hostConfig=this.hostConfig,t.text=this.title?this.title:this.getJsonTypeName(),t.useMarkdown=ed.useMarkdownInRadioButtonAndCheckbox,t.wrap=this.wrap,this._checkboxInputLabelElement=t.render(),this._checkboxInputLabelElement){this._checkboxInputLabelElement.id=cd(),this._checkboxInputLabelElement.style.display="inline-block",this._checkboxInputLabelElement.style.flex="1 1 auto",this._checkboxInputLabelElement.style.marginLeft="6px",this._checkboxInputLabelElement.style.verticalAlign="middle";const t=document.createElement("div");t.style.width="6px",ud(e,t),ud(e,this._checkboxInputLabelElement)}}return e}get isNullable(){return!1}updateVisualState(e){}getJsonTypeName(){return"Input.Toggle"}focus(){this._checkboxInputElement&&this._checkboxInputElement.focus()}isSet(){return this.isRequired?this.value===this.valueOn:!!this.value}isDirty(){return!!this._checkboxInputElement&&this._checkboxInputElement.checked!==this._oldCheckboxValue}get value(){return this._checkboxInputElement?this._checkboxInputElement.checked?this.valueOn:this.valueOff:void 0}}ap.valueProperty=new Ad(Sd.v1_0,"value"),ap.titleProperty=new Ad(Sd.v1_0,"title"),ap.valueOnProperty=new Ad(Sd.v1_0,"valueOn",!0,void 0,"true",(e=>"true")),ap.valueOffProperty=new Ad(Sd.v1_0,"valueOff",!0,void 0,"false",(e=>"false")),ap.wrapProperty=new Pd(Sd.v1_2,"wrap",!1),Dh([Od(ap.valueProperty)],ap.prototype,"defaultValue",void 0),Dh([Od(ap.titleProperty)],ap.prototype,"title",void 0),Dh([Od(ap.valueOnProperty)],ap.prototype,"valueOn",void 0),Dh([Od(ap.valueOffProperty)],ap.prototype,"valueOff",void 0),Dh([Od(ap.wrapProperty)],ap.prototype,"wrap",void 0);class op extends _d{getSchemaKey(){return"Choice"}constructor(e,t){super(),this.title=e,this.value=t}}op.titleProperty=new Ad(Sd.v1_0,"title"),op.valueProperty=new Ad(Sd.v1_0,"value"),Dh([Od(op.titleProperty)],op.prototype,"title",void 0),Dh([Od(op.valueProperty)],op.prototype,"value",void 0);class lp extends _d{getSchemaKey(){return"choices.data"}}lp.typeProperty=new Ad(Sd.v1_6,"type",!0,new RegExp("^Data.Query$")),lp.datasetProperty=new Ad(Sd.v1_6,"dataset"),lp.countProperty=new kd(Sd.v1_6,"count"),lp.skipProperty=new kd(Sd.v1_6,"skip"),Dh([Od(lp.typeProperty)],lp.prototype,"type",void 0),Dh([Od(lp.datasetProperty)],lp.prototype,"dataset",void 0),Dh([Od(lp.countProperty)],lp.prototype,"count",void 0),Dh([Od(lp.skipProperty)],lp.prototype,"skip",void 0);class cp extends sp{constructor(){super(...arguments),this.isMultiSelect=!1,this.wrap=!1,this.choices=[]}get isCompact(){return!this.style||"compact"===this.style}set isCompact(e){this.style=e?void 0:"expanded"}static getUniqueCategoryName(){const e="__ac-category"+cp._uniqueCategoryCounter;return cp._uniqueCategoryCounter++,e}isDynamicTypeahead(){return this.hostConfig.inputs.allowDynamicallyFilteredChoiceSet&&!!this.choicesData&&!!this.choicesData.dataset&&"Data.Query"===this.choicesData.type}getFilterForDynamicSearch(){var e;return null===(e=this._textInput)||void 0===e?void 0:e.value}getDropdownElement(){var e;return null===(e=this._filteredChoiceSet)||void 0===e?void 0:e.dropdown}renderChoices(e,t){var n;null===(n=this._filteredChoiceSet)||void 0===n||n.processResponse(e,t)}showLoadingIndicator(){var e;null===(e=this._filteredChoiceSet)||void 0===e||e.showLoadingIndicator()}removeLoadingIndicator(){var e;null===(e=this._filteredChoiceSet)||void 0===e||e.removeLoadingIndicator()}showErrorIndicator(e,t){var n;null===(n=this._filteredChoiceSet)||void 0===n||n.showErrorIndicator(e,t)}showValidationFailureCue(){var e;null===(e=this._textInput)||void 0===e||e.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed"))}removeValidationFailureCue(){var e;null===(e=this._textInput)||void 0===e||e.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed"))}createPlaceholderOptionWhenValueDoesNotExist(){if(!this.value){const e=document.createElement("option");return e.selected=!0,e.disabled=!0,e.hidden=!0,e.value="",this.placeholder&&(e.text=this.placeholder),e}}internalApplyAriaCurrent(){if(this._selectElement){const e=this._selectElement.options;if(e)for(const t of Array.from(e))t.selected?t.setAttribute("aria-current","true"):t.removeAttribute("aria-current")}}renderCompoundInput(e,t,n){const r=document.createElement("div");r.className=this.hostConfig.makeCssClassName("ac-input",e),r.style.width="100%",this._toggleInputs=[],this._labels=[];for(const e of this.choices){const s=document.createElement("input");s.id=cd(),s.type=t,s.style.margin="0",s.style.display="inline-block",s.style.verticalAlign="middle",s.style.flex="0 0 auto",s.name=this.id?this.id:this._uniqueCategoryName,this.isRequired&&s.setAttribute("aria-required","true"),s.tabIndex=this.isDesignMode()?-1:0,e.value&&(s.value=e.value),e.title&&s.setAttribute("aria-label",e.title),n&&e.value&&n.indexOf(e.value)>=0&&(s.checked=!0),s.onchange=()=>{this.valueChanged()},this._toggleInputs.push(s);const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",ud(i,s);const a=new Bh;a.setParent(this),a.forElementId=s.id,a.hostConfig=this.hostConfig,a.text=e.title?e.title:"Choice "+this._toggleInputs.length,a.useMarkdown=ed.useMarkdownInRadioButtonAndCheckbox,a.wrap=this.wrap;const o=a.render();if(this._labels.push(o),o){o.id=cd(),o.style.display="inline-block",o.style.flex="1 1 auto",o.style.marginLeft="6px",o.style.verticalAlign="middle";const e=document.createElement("div");e.style.width="6px",ud(i,e),ud(i,o)}ud(r,i)}return r}updateInputControlAriaLabelledBy(){if((this.isMultiSelect||"expanded"===this.style)&&this._toggleInputs&&this._labels){const e=this.getAllLabelIds();for(let t=0;t<this._toggleInputs.length;t++){let n="";0===t&&(n=e.join(" "));const r=this._labels[t];r&&r.id&&(n+=" "+r.id),""!==n?this._toggleInputs[t].setAttribute("aria-labelledby",n):this._toggleInputs[t].removeAttribute("aria-labelledby")}}else super.updateInputControlAriaLabelledBy()}internalRender(){if(this._uniqueCategoryName=cp.getUniqueCategoryName(),this.isDynamicTypeahead()){const e=new up(cp._uniqueCategoryCounter,this.choices,this.hostConfig);if(e.render(),e.textInput){this._textInput=e.textInput,this.defaultValue&&(this._textInput.value=this.defaultValue),this.placeholder&&!this._textInput.value&&(this._textInput.placeholder=this.placeholder,this._textInput.setAttribute("aria-label",this.placeholder)),this._textInput.tabIndex=this.isDesignMode()?-1:0;const t=function(e,t){let n;return function(...r){n&&clearTimeout(n),n=setTimeout((()=>{e(...r)}),t)}}((()=>{e.processChoices(),this.valueChanged(),this._textInput&&(this.value?(this._textInput.removeAttribute("placeholder"),this._textInput.removeAttribute("aria-label")):this.placeholder&&(this._textInput.placeholder=this.placeholder,this._textInput.setAttribute("aria-label",this.placeholder)))}),this.hostConfig.inputs.debounceTimeInMilliSeconds);this._textInput.onclick=t,this._textInput.oninput=t}return e.parent=this,this._filteredChoiceSet=e,e.renderedElement}if(this.isMultiSelect)return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):void 0);if("expanded"===this.style)return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:void 0);if("filtered"===this.style){const e=document.createElement("div");e.style.width="100%",this._textInput=document.createElement("input"),this._textInput.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-filtered"),this._textInput.type="text",this._textInput.style.width="100%",this._textInput.oninput=()=>{this.valueChanged(),this._textInput&&(this.value?(this._textInput.removeAttribute("placeholder"),this._textInput.removeAttribute("aria-label")):this.placeholder&&(this._textInput.placeholder=this.placeholder,this._textInput.setAttribute("aria-label",this.placeholder)))},this.defaultValue&&(this._textInput.value=this.defaultValue),this.placeholder&&!this._textInput.value&&(this._textInput.placeholder=this.placeholder,this._textInput.setAttribute("aria-label",this.placeholder)),this._textInput.tabIndex=this.isDesignMode()?-1:0;const t=document.createElement("datalist");t.id=cd();for(const e of this.choices){const n=document.createElement("option");e.title&&(n.value=e.title,n.setAttribute("aria-label",e.title)),n.tabIndex=this.isDesignMode()?-1:0,t.appendChild(n)}return this._textInput.setAttribute("list",t.id),e.append(this._textInput,t),e}{this._selectElement=document.createElement("select"),this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact"),this._selectElement.style.width="100%",this._selectElement.tabIndex=this.isDesignMode()?-1:0;const e=this.createPlaceholderOptionWhenValueDoesNotExist();ud(this._selectElement,e);for(const e of this.choices){const t=document.createElement("option");t.value=e.value,e.title&&(t.text=e.title,t.setAttribute("aria-label",e.title)),t.tabIndex=this.isDesignMode()?-1:0,e.value===this.defaultValue&&(t.selected=!0),ud(this._selectElement,t)}return this._selectElement.onchange=()=>{this.internalApplyAriaCurrent(),this.valueChanged()},this.internalApplyAriaCurrent(),this._selectElement}}updateVisualState(e){if(this.allowRevealOnHoverStyle&&!this.isMultiSelect&&this.isCompact&&(super.updateVisualState(e),this._selectElement&&this.inputStyle===Mu.RevealOnHover)){this.shouldHideInputAdornersForRevealOnHover(this._selectElement,e)?(this._selectElement.style.appearance="none",this._selectElement.classList.remove(this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onfocus"))):(this._selectElement.style.appearance="auto",this._selectElement.classList.add(this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onfocus")))}}getJsonTypeName(){return"Input.ChoiceSet"}focus(){this._toggleInputs&&(this.isMultiSelect||"expanded"===this.style)?this._toggleInputs.length>0&&this._toggleInputs[0].focus():this._textInput?this._textInput.focus():super.focus()}internalValidateProperties(e){super.internalValidateProperties(e),0===this.choices.length&&e.addFailure(this,Gu.CollectionCantBeEmpty,Cd.errors.choiceSetMustHaveAtLeastOneChoice());for(const t of this.choices)t.title&&t.value||e.addFailure(this,Gu.PropertyCantBeNull,Cd.errors.choiceSetChoicesMustHaveTitleAndValue())}isSet(){return!!this.value}isValid(){if(this._textInput){if(""===this.value||this.value===this.placeholder)return!0;for(const e of this.choices)if(this.value===e.value)return!0;if(this.dynamicChoices)for(const e of this.dynamicChoices)if(this.value===e)return!0;return!1}return super.isValid()}get value(){if(this.isMultiSelect){if(!this._toggleInputs||0===this._toggleInputs.length)return;let e="";for(const t of this._toggleInputs)t.checked&&(""!==e&&(e+=this.hostConfig.choiceSetInputValueSeparator),e+=t.value);return e||void 0}if(this._selectElement)return this._selectElement.selectedIndex>0?this._selectElement.value:void 0;if(this._textInput){for(const e of this.choices)if(e.title&&this._textInput.value===e.title)return e.value;return this._textInput.value}if(this._toggleInputs&&this._toggleInputs.length>0)for(const e of this._toggleInputs)if(e.checked)return e.value}get dynamicChoices(){var e;return null===(e=this._filteredChoiceSet)||void 0===e?void 0:e.dynamicChoices}}cp.valueProperty=new Ad(Sd.v1_0,"value"),cp.choicesProperty=new Ld(Sd.v1_0,"choices",op),cp.choicesDataProperty=new Md(Sd.v1_6,"choices.data",lp),cp.styleProperty=new Td(Sd.v1_0,"style",[{value:"compact"},{value:"expanded"},{value:"filtered",targetVersion:Sd.v1_5}],"compact"),cp.isMultiSelectProperty=new Pd(Sd.v1_0,"isMultiSelect",!1),cp.placeholderProperty=new Ad(Sd.v1_0,"placeholder"),cp.wrapProperty=new Pd(Sd.v1_2,"wrap",!1),cp._uniqueCategoryCounter=0,Dh([Od(cp.valueProperty)],cp.prototype,"defaultValue",void 0),Dh([Od(cp.styleProperty)],cp.prototype,"style",void 0),Dh([Od(cp.isMultiSelectProperty)],cp.prototype,"isMultiSelect",void 0),Dh([Od(cp.placeholderProperty)],cp.prototype,"placeholder",void 0),Dh([Od(cp.wrapProperty)],cp.prototype,"wrap",void 0),Dh([Od(cp.choicesProperty)],cp.prototype,"choices",void 0),Dh([Od(cp.choicesDataProperty)],cp.prototype,"choicesData",void 0);class up{constructor(e,t,n){this._choiceSetId=e,this._choices=t,this._dynamicChoices=[],this._visibleChoiceCount=0,this._highlightedChoiceId=-1,this._hostConfig=n}render(){const e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-filtered-container"),this._textInput=document.createElement("input"),this._textInput.className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-filtered-textbox"),this._textInput.type="text",this._textInput.onkeydown=e=>{if("ArrowDown"===e.key)e.preventDefault(),this.highlightChoice(this._highlightedChoiceId+1);else if("ArrowUp"===e.key)e.preventDefault(),this.highlightChoice(this._highlightedChoiceId-1);else if("Enter"===e.key){const e=document.getElementById(`ac-choiceSetInput-${this._choiceSetId}-choice-${this._highlightedChoiceId}`);null==e||e.click()}},this._dropdown=document.createElement("div"),this._dropdown.className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-filtered-dropdown"),e.append(this._textInput,this._dropdown),this._renderedElement=e}createChoice(e,t,n){const r=document.createElement("span");r.className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-choice"),r.id=`ac-choiceSetInput-${this._choiceSetId}-choice-${n}`;const s=e.indexOf(t);if(-1===s){const t=document.createElement("span");t.innerText=e,r.appendChild(t)}else{if(s>0){const t=e.substring(0,s),n=document.createElement("span");n.innerText=t,r.appendChild(n)}const n=document.createElement("span");if(n.innerText=t,n.style.fontWeight="bold",r.appendChild(n),s+t.length<e.length){const n=e.substring(s+t.length),i=document.createElement("span");i.innerText=n,r.appendChild(i)}}return r.tabIndex=-1,r.onclick=()=>{r.classList.remove(this.hostConfig.makeCssClassName("ac-choiceSetInput-choice-highlighted")),this._highlightedChoiceId=-1,this._textInput&&(this._textInput.value=r.innerText,this._textInput.focus()),this._dropdown&&this._dropdown.classList.remove(this.hostConfig.makeCssClassName("ac-choiceSetInput-filtered-dropdown-open"))},r.onmousemove=()=>{this._highlightedChoiceId!==n&&this.highlightChoice(n,!1)},r}highlightChoice(e,t=!0){if(this._visibleChoiceCount>0){const n=document.getElementById(`ac-choiceSetInput-${this._choiceSetId}-choice-${this._highlightedChoiceId}`),r=document.getElementById(`ac-choiceSetInput-${this._choiceSetId}-choice-${e}`);r?(null==n||n.classList.remove(this.hostConfig.makeCssClassName("ac-choiceSetInput-choice-highlighted")),r.classList.add(this.hostConfig.makeCssClassName("ac-choiceSetInput-choice-highlighted")),t&&r.scrollIntoView(),this._highlightedChoiceId=e):n&&0!==this._highlightedChoiceId?this.highlightChoice(0):this.highlightChoice(this._visibleChoiceCount-1)}}filterChoices(){var e,t;const n=(null===(e=this._textInput)||void 0===e?void 0:e.value.toLowerCase().trim())||"",r=[...this._choices,...this._dynamicChoices];for(const e of r)if(e.title){const r=e.title.toLowerCase().indexOf(n);if(-1!==r){const s=e.title.substring(r,r+n.length),i=this.createChoice(e.title,s,this._visibleChoiceCount++);null===(t=this._dropdown)||void 0===t||t.appendChild(i)}}}getStatusIndicator(e){if(e){if(!this._errorIndicator){const e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-statusIndicator","ac-choiceSetInput-errorIndicator"),this._errorIndicator=e}return this._errorIndicator.innerText=e,this._errorIndicator}if(!this._loadingIndicator){const e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-input","ac-choiceSetInput-statusIndicator"),this._loadingIndicator=e}return this._loadingIndicator.innerText=0===this._visibleChoiceCount?"Loading...":"Loading more...",this._loadingIndicator}resetDropdown(){this._dropdown&&(!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(this._dropdown),this._visibleChoiceCount=0,this._highlightedChoiceId=-1)}showDropdown(){var e;(null===(e=this._dropdown)||void 0===e?void 0:e.hasChildNodes())&&this._dropdown.classList.add(this.hostConfig.makeCssClassName("ac-choiceSetInput-filtered-dropdown-open"))}processChoices(){this.resetDropdown(),this.filterChoices(),this.showDropdown()}processResponse(e,t){var n;e===(null===(n=this._textInput)||void 0===n?void 0:n.value)&&(this.resetDropdown(),this._dynamicChoices=t,this.filterChoices(),0===this._visibleChoiceCount&&this.showErrorIndicator(e,"No results found"))}showLoadingIndicator(){var e;const t=this.getStatusIndicator();null===(e=this._dropdown)||void 0===e||e.appendChild(t),this.showDropdown()}removeLoadingIndicator(){var e,t;this._loadingIndicator&&(null===(e=this._dropdown)||void 0===e?void 0:e.contains(this._loadingIndicator))&&(null===(t=this._dropdown)||void 0===t||t.removeChild(this._loadingIndicator))}showErrorIndicator(e,t){var n,r;if(e===(null===(n=this._textInput)||void 0===n?void 0:n.value)){this.processChoices();const e=this.getStatusIndicator(t);null===(r=this._dropdown)||void 0===r||r.appendChild(e),e.scrollIntoView()}}get dynamicChoices(){var e;return null===(e=this._dynamicChoices)||void 0===e?void 0:e.map((e=>e.title))}get hostConfig(){return this._hostConfig?this._hostConfig:this.parent?this.parent.hostConfig:dh}set parent(e){this._parent=e}get parent(){return this._parent}get renderedElement(){return this._renderedElement}get textInput(){return this._textInput}get dropdown(){return this._dropdown}}class dp extends sp{internalRender(){return this._numberInputElement=document.createElement("input"),this._numberInputElement.setAttribute("type","number"),void 0!==this.min&&this._numberInputElement.setAttribute("min",this.min.toString()),void 0!==this.max&&this._numberInputElement.setAttribute("max",this.max.toString()),this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput"),this._numberInputElement.style.width="100%",this._numberInputElement.tabIndex=this.isDesignMode()?-1:0,void 0!==this.defaultValue&&(this._numberInputElement.valueAsNumber=this.defaultValue),this.placeholder&&(this._numberInputElement.placeholder=this.placeholder,this._numberInputElement.setAttribute("aria-label",this.placeholder)),this._numberInputElement.oninput=()=>{this.valueChanged()},this._numberInputElement}getJsonTypeName(){return"Input.Number"}isSet(){return void 0!==this.value&&!isNaN(this.value)}isValid(){if(void 0===this.value)return!this.isRequired;let e=!0;return void 0!==this.min&&(e=e&&this.value>=this.min),void 0!==this.max&&(e=e&&this.value<=this.max),e}get value(){return this._numberInputElement?this._numberInputElement.valueAsNumber:void 0}set value(e){e&&this._numberInputElement&&(this._numberInputElement.value=e.toString())}}dp.valueProperty=new kd(Sd.v1_0,"value"),dp.placeholderProperty=new Ad(Sd.v1_0,"placeholder"),dp.minProperty=new kd(Sd.v1_0,"min"),dp.maxProperty=new kd(Sd.v1_0,"max"),Dh([Od(dp.valueProperty)],dp.prototype,"defaultValue",void 0),Dh([Od(dp.minProperty)],dp.prototype,"min",void 0),Dh([Od(dp.maxProperty)],dp.prototype,"max",void 0),Dh([Od(dp.placeholderProperty)],dp.prototype,"placeholder",void 0);class hp extends sp{internalRender(){return this._dateInputElement=document.createElement("input"),this._dateInputElement.setAttribute("type","date"),this.min&&this._dateInputElement.setAttribute("min",this.min),this.max&&this._dateInputElement.setAttribute("max",this.max),this.placeholder&&(this._dateInputElement.placeholder=this.placeholder,this._dateInputElement.setAttribute("aria-label",this.placeholder)),this._dateInputElement.tabIndex=this.isDesignMode()?-1:0,this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput"),this._dateInputElement.style.width="100%",this._dateInputElement.oninput=()=>{this.valueChanged()},this.defaultValue&&(this._dateInputElement.value=this.defaultValue),this._dateInputElement}updateVisualState(e){if(this.allowRevealOnHoverStyle&&(super.updateVisualState(e),this._dateInputElement&&this.inputStyle===Mu.RevealOnHover)){const t=this.shouldHideInputAdornersForRevealOnHover(this._dateInputElement,e);t?this._dateInputElement.classList.remove(this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onfocus")):this._dateInputElement.classList.add(this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onfocus")),Hp(this._dateInputElement,t)}}getJsonTypeName(){return"Input.Date"}isSet(){return!!this.value}isValid(){if(!this.value)return!this.isRequired;const e=new Date(this.value);let t=!0;if(this.min){const n=new Date(this.min);t=t&&e>=n}if(this.max){const n=new Date(this.max);t=t&&e<=n}return t}get value(){return this._dateInputElement?this._dateInputElement.value:void 0}}hp.valueProperty=new Ad(Sd.v1_0,"value"),hp.placeholderProperty=new Ad(Sd.v1_0,"placeholder"),hp.minProperty=new Ad(Sd.v1_0,"min"),hp.maxProperty=new Ad(Sd.v1_0,"max"),Dh([Od(hp.valueProperty)],hp.prototype,"defaultValue",void 0),Dh([Od(hp.minProperty)],hp.prototype,"min",void 0),Dh([Od(hp.maxProperty)],hp.prototype,"max",void 0),Dh([Od(hp.placeholderProperty)],hp.prototype,"placeholder",void 0);class pp extends Rd{constructor(e,t){super(e,t,((e,t,n,r)=>{const s=n[t.name];if("string"==typeof s&&s&&/^[0-9]{2}:[0-9]{2}$/.test(s))return s}),((e,t,n,r,s)=>{s.serializeValue(n,t.name,r)})),this.targetVersion=e,this.name=t}}class gp extends sp{static convertTimeStringToDate(e){return new Date("1973-09-04T"+e+":00Z")}internalRender(){return this._timeInputElement=document.createElement("input"),this._timeInputElement.setAttribute("type","time"),this.min&&this._timeInputElement.setAttribute("min",this.min),this.max&&this._timeInputElement.setAttribute("max",this.max),this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput"),this._timeInputElement.style.width="100%",this._timeInputElement.oninput=()=>{this.valueChanged()},this.placeholder&&(this._timeInputElement.placeholder=this.placeholder,this._timeInputElement.setAttribute("aria-label",this.placeholder)),this._timeInputElement.tabIndex=this.isDesignMode()?-1:0,this.defaultValue&&(this._timeInputElement.value=this.defaultValue),this._timeInputElement}updateVisualState(e){if(this.allowRevealOnHoverStyle&&(super.updateVisualState(e),this._timeInputElement&&this.inputStyle===Mu.RevealOnHover)){const t=this.shouldHideInputAdornersForRevealOnHover(this._timeInputElement,e);t?this._timeInputElement.classList.remove(this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onfocus")):this._timeInputElement.classList.add(this.hostConfig.makeCssClassName("ac-inputStyle-revealOnHover-onfocus")),Hp(this._timeInputElement,t)}}getJsonTypeName(){return"Input.Time"}isSet(){return!!this.value}isValid(){if(!this.value)return!this.isRequired;const e=gp.convertTimeStringToDate(this.value);let t=!0;if(this.min){const n=gp.convertTimeStringToDate(this.min);t=t&&e>=n}if(this.max){const n=gp.convertTimeStringToDate(this.max);t=t&&e<=n}return t}get value(){return this._timeInputElement?this._timeInputElement.value:void 0}}gp.valueProperty=new pp(Sd.v1_0,"value"),gp.placeholderProperty=new Ad(Sd.v1_0,"placeholder"),gp.minProperty=new pp(Sd.v1_0,"min"),gp.maxProperty=new pp(Sd.v1_0,"max"),Dh([Od(gp.valueProperty)],gp.prototype,"defaultValue",void 0),Dh([Od(gp.minProperty)],gp.prototype,"min",void 0),Dh([Od(gp.maxProperty)],gp.prototype,"max",void 0),Dh([Od(gp.placeholderProperty)],gp.prototype,"placeholder",void 0);class mp extends vh{constructor(){super(...arguments),this.style=xu.Default,this.mode=Iu.Primary,this._state=0,this._isFocusable=!0}renderButtonContent(){if(this.renderedElement){const e=this.hostConfig,t=document.createElement("div");if(t.style.overflow="hidden",t.style.textOverflow="ellipsis",e.actions.iconPlacement===Vu.AboveTitle||e.actions.allowTitleToWrap||(t.style.whiteSpace="nowrap"),this.title&&(t.innerText=this.title),this.iconUrl){const n=document.createElement("img");n.src=this.iconUrl,n.style.width=e.actions.iconSize+"px",n.style.height=e.actions.iconSize+"px",n.style.flex="0 0 auto",n.setAttribute("role","presentation"),e.actions.iconPlacement===Vu.AboveTitle?(this.renderedElement.classList.add("iconAbove"),this.renderedElement.style.flexDirection="column",this.title&&(n.style.marginBottom="6px")):(this.renderedElement.classList.add("iconLeft"),n.style.maxHeight="100%",this.title&&(n.style.marginRight="6px")),this.renderedElement.appendChild(n),this.renderedElement.appendChild(t)}else this.renderedElement.classList.add("noIcon"),this.renderedElement.appendChild(t)}}getParentContainer(){return this.parent instanceof Rp?this.parent:this.parent?this.parent.getParentContainer():void 0}isDesignMode(){const e=this.getRootObject();return e instanceof Nh&&e.isDesignMode()}updateCssClasses(){if(this.parent&&this.renderedElement){const e=this.parent.hostConfig;this.renderedElement.className=e.makeCssClassName(this.isEffectivelyEnabled()?"ac-pushButton":"ac-pushButton-disabled");const t=this.getParentContainer();if(t){const e=t.getEffectiveStyle();e&&this.renderedElement.classList.add("style-"+e)}switch(this.renderedElement.tabIndex=!this.isDesignMode()&&this.isFocusable?0:-1,this._state){case 0:break;case 1:this.renderedElement.classList.add(e.makeCssClassName("expanded"));break;case 2:this.renderedElement.classList.add(e.makeCssClassName("subdued"))}this.style&&this.isEffectivelyEnabled()&&(this.style===xu.Positive?this.renderedElement.classList.add(...e.makeCssClassNames("primary","style-positive")):this.renderedElement.classList.add(...e.makeCssClassNames("style-"+this.style.toLowerCase())))}}getDefaultSerializationContext(){return new Zp}internalGetReferencedInputs(){return{}}internalPrepareForExecution(e){}internalValidateInputs(e){const t=[];if(e)for(const n of Object.keys(e)){const r=e[n];r.validateValue()||t.push(r)}return t}shouldSerialize(e){return void 0!==e.actionRegistry.findByName(this.getJsonTypeName())}raiseExecuteActionEvent(){this.onExecute&&this.onExecute(this),function(e){const t=e.parent?e.parent.getRootElement():void 0,n=t&&t.onExecuteAction?t.onExecuteAction:Qp.onExecuteAction;e.prepareForExecution()&&n&&n(e)}(this)}internalAfterExecute(){let e=this.getRootObject();e instanceof Nh&&e.updateActionsEnabledState()}getHref(){return""}getAriaRole(){let e=this.getAriaRoleFromEnum();return null!=e?e:"button"}getAriaRoleFromEnum(){switch(this.role){case $u.Button:return"button";case $u.Link:return"link";case $u.Menu:return"menu";case $u.MenuItem:return"menuitem";case $u.Tab:return"tab";default:return}}setupElementForAccessibility(e,t=!1){e.tabIndex=this.isEffectivelyEnabled()&&!this.isDesignMode()?0:-1,e.setAttribute("role",this.getAriaRole()),e instanceof HTMLButtonElement&&(e.disabled=!this.isEffectivelyEnabled()),this.isEffectivelyEnabled()?(e.removeAttribute("aria-disabled"),e.classList.add(this.hostConfig.makeCssClassName("ac-selectable"))):e.setAttribute("aria-disabled","true"),this.title?(e.setAttribute("aria-label",this.title),e.title=this.title):(e.removeAttribute("aria-label"),e.removeAttribute("title")),this.tooltip&&(t&&!this.title&&e.setAttribute("aria-label",this.tooltip),e.title=this.tooltip)}parse(e,t){return super.parse(e,t||new Zp)}render(){const e=document.createElement("button");e.type="button",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.onclick=e=>{this.isEffectivelyEnabled()&&(e.preventDefault(),e.cancelBubble=!0,this.execute())},this._renderedElement=e,this.renderButtonContent(),this.updateCssClasses(),this.setupElementForAccessibility(e)}execute(){this._actionCollection&&this._actionCollection.actionExecuted(this),this.raiseExecuteActionEvent(),this.internalAfterExecute()}prepareForExecution(){const e=this.getReferencedInputs(),t=this.internalValidateInputs(e);return t.length>0?(t[0].focus(),!1):(this.internalPrepareForExecution(e),!0)}remove(){return!!this._actionCollection&&this._actionCollection.removeAction(this)}getAllInputs(e=!0){return[]}getAllActions(){return[this]}getResourceInformation(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]}getActionById(e){return this.id===e?this:void 0}getReferencedInputs(){return this.internalGetReferencedInputs()}validateInputs(){return this.internalValidateInputs(this.getReferencedInputs())}updateEnabledState(){}isEffectivelyEnabled(){return this.isEnabled}get isPrimary(){return this.style===xu.Positive}set isPrimary(e){e?this.style=xu.Positive:this.style===xu.Positive&&(this.style=xu.Default)}get hostConfig(){return this.parent?this.parent.hostConfig:dh}get parent(){return this._parent}get state(){return this._state}set state(e){this._state!==e&&(this._state=e,this.updateCssClasses())}get isFocusable(){return this._isFocusable}set isFocusable(e){this._isFocusable!==e&&(this._isFocusable=e,this.updateCssClasses())}}mp.titleProperty=new Ad(Sd.v1_0,"title"),mp.iconUrlProperty=new Ad(Sd.v1_1,"iconUrl"),mp.styleProperty=new Td(Sd.v1_2,"style",[{value:xu.Default},{value:xu.Positive},{value:xu.Destructive}],xu.Default),mp.modeProperty=new Td(Sd.v1_5,"mode",[{value:Iu.Primary},{value:Iu.Secondary}],Iu.Primary),mp.tooltipProperty=new Ad(Sd.v1_5,"tooltip"),mp.isEnabledProperty=new Pd(Sd.v1_5,"isEnabled",!0),mp.roleProperty=new Dd(Sd.v1_6,"role",$u),Dh([Od(mp.titleProperty)],mp.prototype,"title",void 0),Dh([Od(mp.iconUrlProperty)],mp.prototype,"iconUrl",void 0),Dh([Od(mp.styleProperty)],mp.prototype,"style",void 0),Dh([Od(mp.modeProperty)],mp.prototype,"mode",void 0),Dh([Od(mp.tooltipProperty)],mp.prototype,"tooltip",void 0),Dh([Od(mp.isEnabledProperty)],mp.prototype,"isEnabled",void 0),Dh([Od(mp.roleProperty)],mp.prototype,"role",void 0);class fp extends mp{constructor(){super(...arguments),this.disabledUnlessAssociatedInputsChange=!1,this._isPrepared=!1,this._areReferencedInputsDirty=!1}internalGetReferencedInputs(){const e={};if("none"!==this.associatedInputs){let t=this.parent,n=[];for(;t;)n.push(...t.getAllInputs(!1)),t=t.parent;for(const t of n)t.id&&(e[t.id]=t)}return e}internalPrepareForExecution(e){if(this._originalData?this._processedData=JSON.parse(JSON.stringify(this._originalData)):this._processedData={},this._processedData&&e)for(const t of Object.keys(e)){const n=e[t];n.id&&n.isSet()&&(this._processedData[n.id]="string"==typeof n.value?n.value:n.value.toString())}this._isPrepared=!0}internalAfterExecute(){ed.resetInputsDirtyStateAfterActionExecution&&this.resetReferencedInputsDirtyState()}resetReferencedInputsDirtyState(){let e=this.getReferencedInputs();if(this._areReferencedInputsDirty=!1,e)for(const t of Object.keys(e)){e[t].resetDirtyState()}}updateEnabledState(){this._areReferencedInputsDirty=!1;let e=this.getReferencedInputs();if(e)for(const t of Object.keys(e)){if(e[t].isDirty()){this._areReferencedInputsDirty=!0;break}}this.updateCssClasses(),this._renderedElement&&this.setupElementForAccessibility(this._renderedElement)}isEffectivelyEnabled(){let e=super.isEffectivelyEnabled();return this.disabledUnlessAssociatedInputsChange?e&&this._areReferencedInputsDirty:e}get data(){return this._isPrepared?this._processedData:this._originalData}set data(e){this._originalData=e,this._isPrepared=!1}}fp.dataProperty=new Id(Sd.v1_0,"data"),fp.associatedInputsProperty=new Rd(Sd.v1_3,"associatedInputs",((e,t,n,r)=>{const s=n[t.name];if(void 0!==s&&"string"==typeof s)return"none"===s.toLowerCase()?"none":"auto"}),((e,t,n,r,s)=>{s.serializeValue(n,t.name,r)})),fp.disabledUnlessAssociatedInputsChangeProperty=new Pd(Sd.v1_6,"disabledUnlessAssociatedInputsChange",!1),Dh([Od(fp.dataProperty)],fp.prototype,"_originalData",void 0),Dh([Od(fp.associatedInputsProperty)],fp.prototype,"associatedInputs",void 0),Dh([Od(fp.disabledUnlessAssociatedInputsChangeProperty)],fp.prototype,"disabledUnlessAssociatedInputsChange",void 0);class yp extends fp{getJsonTypeName(){return yp.JsonTypeName}}yp.JsonTypeName="Action.Submit";class vp extends fp{}class bp extends vp{getJsonTypeName(){return bp.JsonTypeName}}bp.JsonTypeName="Action.Execute",bp.verbProperty=new Ad(Sd.v1_4,"verb"),Dh([Od(bp.verbProperty)],bp.prototype,"verb",void 0);class Cp extends vp{getJsonTypeName(){return Cp.JsonTypeName}get isStandalone(){return!1}}Cp.JsonTypeName="Data.Query",Cp.datasetProperty=new Ad(Sd.v1_6,"dataset"),Cp.filterProperty=new Ad(Sd.v1_6,"filter"),Cp.countProperty=new kd(Sd.v1_6,"count"),Cp.skipProperty=new kd(Sd.v1_6,"skip"),Dh([Od(Cp.datasetProperty)],Cp.prototype,"dataset",void 0),Dh([Od(Cp.filterProperty)],Cp.prototype,"filter",void 0),Dh([Od(Cp.countProperty)],Cp.prototype,"count",void 0),Dh([Od(Cp.skipProperty)],Cp.prototype,"skip",void 0);class wp extends mp{getJsonTypeName(){return wp.JsonTypeName}getAriaRole(){let e=this.getAriaRoleFromEnum();return null!=e?e:"link"}internalValidateProperties(e){super.internalValidateProperties(e),this.url||e.addFailure(this,Gu.PropertyCantBeNull,Cd.errors.propertyMustBeSet("url"))}getHref(){return this.url}}wp.urlProperty=new Ad(Sd.v1_0,"url"),wp.JsonTypeName="Action.OpenUrl",Dh([Od(wp.urlProperty)],wp.prototype,"url",void 0);class Sp extends mp{constructor(){super(...arguments),this.targetElements={}}updateAriaControlsAttribute(){if(this.targetElements){const e=Object.keys(this.targetElements);this._renderedElement&&(e.length>0?this._renderedElement.setAttribute("aria-controls",e.join(" ")):this._renderedElement.removeAttribute("aria-controls"))}}internalValidateProperties(e){super.internalValidateProperties(e),this.targetElements||e.addFailure(this,Gu.PropertyCantBeNull,Cd.errors.propertyMustBeSet("targetElements"))}getJsonTypeName(){return Sp.JsonTypeName}render(){super.render(),this.updateAriaControlsAttribute()}execute(){if(super.execute(),this.parent)for(const e of Object.keys(this.targetElements)){const t=this.parent.getRootElement().getElementById(e);t&&("boolean"==typeof this.targetElements[e]?t.isVisible=this.targetElements[e]:t.isVisible=!t.isVisible)}}addTargetElement(e,t=void 0){this.targetElements[e]=t,this.updateAriaControlsAttribute()}removeTargetElement(e){delete this.targetElements[e],this.updateAriaControlsAttribute()}}Sp.targetElementsProperty=new Rd(Sd.v1_2,"targetElements",((e,t,n,r)=>{const s={};if(Array.isArray(n[t.name]))for(const e of n[t.name])if("string"==typeof e)s[e]=void 0;else if("object"==typeof e){const t=e.elementId;"string"==typeof t&&(s[t]=pd(e.isVisible))}return s}),((e,t,n,r,s)=>{const i=[];for(const e of Object.keys(r))"boolean"==typeof r[e]?i.push({elementId:e,isVisible:r[e]}):i.push(e);s.serializeArray(n,t.name,i)}),{},(e=>({}))),Sp.JsonTypeName="Action.ToggleVisibility",Dh([Od(Sp.targetElementsProperty)],Sp.prototype,"targetElements",void 0);class Ep extends Id{parse(e,t,n){const r=new rd;return r.set(dd(t[this.name])),r}toJSON(e,t,n,r){r.serializeValue(t,this.name,n.getOriginal())}constructor(e,t){super(e,t,void 0,(()=>new rd)),this.targetVersion=e,this.name=t}}class xp extends _d{getSchemaKey(){return"HttpHeader"}constructor(e="",t=""){super(),this.name=e,this.value=t}getReferencedInputs(e,t){this._value.getReferencedInputs(e,t)}prepareForExecution(e){this._value.substituteInputValues(e,nd)}get value(){return this._value.get()}set value(e){this._value.set(e)}}xp.nameProperty=new Ad(Sd.v1_0,"name"),xp.valueProperty=new Ep(Sd.v1_0,"value"),Dh([Od(xp.nameProperty)],xp.prototype,"name",void 0),Dh([Od(xp.valueProperty)],xp.prototype,"_value",void 0);class Ip extends mp{constructor(){super(...arguments),this._ignoreInputValidation=!1}internalGetReferencedInputs(){const e=this.parent?this.parent.getRootElement().getAllInputs():[],t={};this._url.getReferencedInputs(e,t);for(const n of this.headers)n.getReferencedInputs(e,t);return this._body.getReferencedInputs(e,t),t}internalPrepareForExecution(e){if(e){this._url.substituteInputValues(e,nd);let t=td;for(const n of this.headers)n.prepareForExecution(e),n.name&&"content-type"===n.name.toLowerCase()&&(t=n.value);this._body.substituteInputValues(e,t)}}getJsonTypeName(){return Ip.JsonTypeName}internalValidateProperties(e){if(super.internalValidateProperties(e),this.url||e.addFailure(this,Gu.PropertyCantBeNull,Cd.errors.propertyMustBeSet("url")),this.headers.length>0)for(const t of this.headers)t.name||e.addFailure(this,Gu.PropertyCantBeNull,Cd.errors.actionHttpHeadersMustHaveNameAndValue())}get ignoreInputValidation(){return this._ignoreInputValidation}set ignoreInputValidation(e){this._ignoreInputValidation=e}get url(){return this._url.get()}set url(e){this._url.set(e)}get body(){return this._body.get()}set body(e){this._body.set(e)}}Ip.urlProperty=new Ep(Sd.v1_0,"url"),Ip.bodyProperty=new Ep(Sd.v1_0,"body"),Ip.methodProperty=new Ad(Sd.v1_0,"method"),Ip.headersProperty=new Ld(Sd.v1_0,"headers",xp),Ip.ignoreInputValidationProperty=new Pd(Sd.v1_3,"ignoreInputValidation",!1),Ip.JsonTypeName="Action.Http",Dh([Od(Ip.urlProperty)],Ip.prototype,"_url",void 0),Dh([Od(Ip.bodyProperty)],Ip.prototype,"_body",void 0),Dh([Od(Ip.methodProperty)],Ip.prototype,"method",void 0),Dh([Od(Ip.headersProperty)],Ip.prototype,"headers",void 0),Dh([Od(Ip.ignoreInputValidationProperty)],Ip.prototype,"_ignoreInputValidation",void 0);class Ap extends mp{constructor(){super(...arguments),this.card=new Gp}updateCssClasses(){if(super.updateCssClasses(),this.renderedElement){const e=this.parent?this.parent.hostConfig:dh;this.renderedElement.classList.add(e.makeCssClassName("expandable")),this.renderedElement.setAttribute("aria-expanded",(1===this.state).toString())}}internalParse(e,t){super.internalParse(e,t);const n=e.card;n?this.card.parse(n,t):t.logParseEvent(this,Gu.PropertyCantBeNull,Cd.errors.showCardMustHaveCard())}internalToJSON(e,t){super.internalToJSON(e,t),this.card&&t.serializeValue(e,"card",this.card.toJSON(t))}raiseExecuteActionEvent(){this.hostConfig.actions.showCard.actionMode===Hu.Popup&&super.raiseExecuteActionEvent()}releaseDOMResources(){super.releaseDOMResources(),this.card.releaseDOMResources()}getJsonTypeName(){return Ap.JsonTypeName}internalValidateProperties(e){super.internalValidateProperties(e),this.card.internalValidateProperties(e)}setParent(e){super.setParent(e),this.card.setParent(e)}getAllInputs(e=!0){return this.card.getAllInputs(e)}getAllActions(){const e=super.getAllActions();return e.push(...this.card.getAllActions()),e}getResourceInformation(){let e=super.getResourceInformation();return e.push(...this.card.getResourceInformation()),e}getActionById(e){let t=super.getActionById(e);return t||(t=this.card.getActionById(e)),t}}Ap.JsonTypeName="Action.ShowCard";class Pp extends mp{constructor(e){super(),this._actions=e,this.title=Cd.defaults.overflowButtonText(),this.tooltip=Cd.defaults.overflowButtonTooltip()}getActions(){return this._actions}getAllActions(){const e=super.getAllActions();return e.push(...this._actions),e}getJsonTypeName(){return Ap.JsonTypeName}execute(){var e;const t=!function(e,t){const n=e.parent?e.parent.getRootElement():void 0,r=n&&n.onDisplayOverflowActionMenu?n.onDisplayOverflowActionMenu:Qp.onDisplayOverflowActionMenu;return void 0!==r&&r(e.getActions(),t)}(this,this.renderedElement);if(t&&this.renderedElement){const t=new xh;t.hostConfig=this.hostConfig;for(let n=0;n<this._actions.length;n++){const r=new Ih(n.toString(),null!==(e=this._actions[n].title)&&void 0!==e?e:"",this._actions[n].iconUrl);r.isEnabled=this._actions[n].isEnabled,r.onClick=()=>{const e=this._actions[n];t.closePopup(!1),e.isEnabled&&e.execute()},t.items.add(r)}t.onClose=()=>{var e,t;null===(e=this.renderedElement)||void 0===e||e.focus(),null===(t=this.renderedElement)||void 0===t||t.setAttribute("aria-expanded","false")},this.renderedElement.setAttribute("aria-expanded","true"),t.popup(this.renderedElement),t.selectedIndex=0}}setupElementForAccessibility(e,t=!1){super.setupElementForAccessibility(e,t),e.setAttribute("aria-label",Cd.defaults.overflowButtonTooltip()),e.setAttribute("aria-expanded","false")}}Pp.JsonTypeName="Action.Overflow";class kp{isActionAllowed(e){const t=this._owner.getForbiddenActionTypes();if(t)for(const n of t)if(e.constructor===n)return!1;return!0}refreshContainer(){if(Lh(this._actionCardContainer),!this._actionCard)return void(this._actionCardContainer.style.marginTop="0px");this._actionCardContainer.style.marginTop=this.renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";const e=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(e);const t=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(e);this._actionCard&&(this._actionCard.style.paddingLeft=t.left+"px",this._actionCard.style.paddingRight=t.right+"px",this._actionCard.style.marginLeft="-"+t.left+"px",this._actionCard.style.marginRight="-"+t.right+"px",0===t.bottom||this._owner.isDesignMode()||(this._actionCard.style.paddingBottom=t.bottom+"px",this._actionCard.style.marginBottom="-"+t.bottom+"px"),ud(this._actionCardContainer,this._actionCard))}layoutChanged(){this._owner.getRootElement().updateLayout()}showActionCard(e,t=!1,n=!0){e.card.suppressStyle=t;const r=e.card.renderedElement&&!this._owner.isDesignMode()?e.card.renderedElement:e.card.render();this._actionCard=r,this._expandedAction=e,this.refreshContainer(),n&&(this.layoutChanged(),Fp(e,!0))}collapseExpandedAction(){for(const e of this._renderedActions)e.state=0;const e=this._expandedAction;this._expandedAction=void 0,this._actionCard=void 0,this.refreshContainer(),e&&(this.layoutChanged(),Fp(e,!1))}expandShowCardAction(e,t){let n=!1;for(const t of this._renderedActions)this._owner.hostConfig.actions.actionsOrientation==zu.Horizontal&&n&&(t.isFocusable=!1),t!==e?t.state=2:(t.state=1,n=!0,t.renderedElement&&(t.renderedElement.onblur=e=>{for(const e of this._renderedActions)e.isFocusable=!0}));this.showActionCard(e,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),t)}constructor(e){this._items=[],this._renderedActions=[],this._owner=e}releaseDOMResources(){for(let e of this._renderedActions)e.releaseDOMResources()}actionExecuted(e){e instanceof Ap?e===this._expandedAction?this.collapseExpandedAction():this._owner.hostConfig.actions.showCard.actionMode===Hu.Inline&&this.expandShowCardAction(e,!0):this.collapseExpandedAction()}parse(e,t){if(this.clear(),Array.isArray(e))for(const n of e){let e=[];this._owner instanceof zp&&(e=this._owner.getForbiddenActionNames());const r=t.parseAction(this._owner,n,e,!this._owner.isDesignMode());r&&this.addAction(r)}}toJSON(e,t,n){n.serializeArray(e,t,this._items)}getActionAt(e){return this._items[e]}getActionCount(){return this._items.length}getActionById(e){let t;for(const n of this._items)if(t=n.getActionById(e),t)break;return t}validateProperties(e){this._owner.hostConfig.actions.maxActions&&this._items.length>this._owner.hostConfig.actions.maxActions&&e.addFailure(this._owner,Gu.TooManyActions,Cd.errors.tooManyActions(this._owner.hostConfig.actions.maxActions)),this._items.length>0&&!this._owner.hostConfig.supportsInteractivity&&e.addFailure(this._owner,Gu.InteractivityNotAllowed,Cd.errors.interactivityNotAllowed());for(const t of this._items)this.isActionAllowed(t)||e.addFailure(this._owner,Gu.ActionTypeNotAllowed,Cd.errors.actionTypeNotAllowed(t.getJsonTypeName())),t.internalValidateProperties(e)}render(e){const t=this._owner.hostConfig;if(!t.supportsInteractivity)return;const n=document.createElement("div"),r=t.actions.maxActions?Math.min(t.actions.maxActions,this._items.length):this._items.length;if(this._actionCardContainer=document.createElement("div"),this._renderedActions=[],t.actions.preExpandSingleShowCardAction&&1===r&&this._items[0]instanceof Ap&&this.isActionAllowed(this._items[0]))this.showActionCard(this._items[0],!0),this._renderedActions.push(this._items[0]);else{const r=document.createElement("div");if(r.className=t.makeCssClassName("ac-actionSet"),r.style.display="flex",e===zu.Horizontal)if(r.style.flexDirection="row",this._owner.horizontalAlignment&&t.actions.actionAlignment!==Fu.Stretch)switch(this._owner.horizontalAlignment){case _u.Center:r.style.justifyContent="center";break;case _u.Right:r.style.justifyContent="flex-end";break;default:r.style.justifyContent="flex-start"}else switch(t.actions.actionAlignment){case Fu.Center:r.style.justifyContent="center";break;case Fu.Right:r.style.justifyContent="flex-end";break;default:r.style.justifyContent="flex-start"}else if(r.style.flexDirection="column",this._owner.horizontalAlignment&&t.actions.actionAlignment!==Fu.Stretch)switch(this._owner.horizontalAlignment){case _u.Center:r.style.alignItems="center";break;case _u.Right:r.style.alignItems="flex-end";break;default:r.style.alignItems="flex-start"}else switch(t.actions.actionAlignment){case Fu.Center:r.style.alignItems="center";break;case Fu.Right:r.style.alignItems="flex-end";break;case Fu.Stretch:r.style.alignItems="stretch";break;default:r.style.alignItems="flex-start"}const s=this._items.filter(this.isActionAllowed.bind(this));let i=[];const a=[];if(this._owner.isDesignMode())i=s;else{s.forEach((e=>e.mode===Iu.Secondary?a.push(e):i.push(e)));const e=i.splice(t.actions.maxActions);ed.allowMoreThanMaxActionsInOverflowMenu&&a.push(...e);let n=!0;if(a.length>0){this._overflowAction||(this._overflowAction=new Pp(a),this._overflowAction.setParent(this._owner),this._overflowAction._actionCollection=this);const e=this._owner instanceof Qp&&!this._owner.parent;n=!function(e,t){const n=e.parent?e.parent.getRootElement():void 0,r=n&&n.onRenderOverflowActions?n.onRenderOverflowActions:Qp.onRenderOverflowActions;return void 0!==r&&r(e.getActions(),t)}(this._overflowAction,e)}this._overflowAction&&n&&i.push(this._overflowAction)}for(let n=0;n<i.length;n++){const s=i[n];if(s.render(),s.renderedElement&&(t.actions.actionsOrientation===zu.Horizontal&&t.actions.actionAlignment===Fu.Stretch?s.renderedElement.style.flex="0 1 100%":s.renderedElement.style.flex="0 1 auto",r.appendChild(s.renderedElement),this._renderedActions.push(s),n<i.length-1&&t.actions.buttonSpacing>0)){const n=document.createElement("div");e===zu.Horizontal?(n.style.flex="0 0 auto",n.style.width=t.actions.buttonSpacing+"px"):n.style.height=t.actions.buttonSpacing+"px",ud(r,n)}}const o=document.createElement("div");o.style.overflow="hidden",o.appendChild(r),ud(n,o)}ud(n,this._actionCardContainer);for(const e of this._renderedActions)if(1===e.state){this.expandShowCardAction(e,!1);break}return this._renderedActions.length>0?n:void 0}addAction(e){if(!e)throw new Error("The action parameter cannot be null.");if(e.parent&&e.parent!==this._owner||!(this._items.indexOf(e)<0))throw new Error(Cd.errors.actionAlreadyParented());this._items.push(e),e.parent||e.setParent(this._owner),e._actionCollection=this}removeAction(e){this.expandedAction&&this._expandedAction===e&&this.collapseExpandedAction();const t=this._items.indexOf(e);if(t>=0){this._items.splice(t,1),e.setParent(void 0),e._actionCollection=void 0;for(let t=0;t<this._renderedActions.length;t++)if(this._renderedActions[t]===e){this._renderedActions.splice(t,1);break}return!0}return!1}clear(){this._items=[],this._renderedActions=[],this._expandedAction=void 0}getAllInputs(e=!0){let t=[];if(e)for(const e of this._items)t.push(...e.getAllInputs());return t}getResourceInformation(){let e=[];for(const t of this._items)e.push(...t.getResourceInformation());return e}get renderedActionCount(){return this._renderedActions.length}get expandedAction(){return this._expandedAction}}class Tp extends Nh{internalParse(e,t){super.internalParse(e,t),this._actionCollection.parse(e.actions,t)}internalToJSON(e,t){super.internalToJSON(e,t),this._actionCollection.toJSON(e,"actions",t)}internalRender(){return this._actionCollection.render(void 0!==this.orientation?this.orientation:this.hostConfig.actions.actionsOrientation)}constructor(){super(),this._actionCollection=new kp(this)}releaseDOMResources(){super.releaseDOMResources(),this._actionCollection.releaseDOMResources()}isBleedingAtBottom(){return 0===this._actionCollection.renderedActionCount?super.isBleedingAtBottom():1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction}getJsonTypeName(){return"ActionSet"}getActionCount(){return this._actionCollection.getActionCount()}getActionAt(e){return e>=0&&e<this.getActionCount()?this._actionCollection.getActionAt(e):super.getActionAt(e)}getActionById(e){const t=this._actionCollection.getActionById(e);return t||super.getActionById(e)}getAllActions(){const e=super.getAllActions();for(let t=0;t<this.getActionCount();t++){let n=this.getActionAt(t);n&&e.push(n)}return e}internalValidateProperties(e){super.internalValidateProperties(e),this._actionCollection.validateProperties(e)}addAction(e){this._actionCollection.addAction(e)}getAllInputs(e=!0){return e?this._actionCollection.getAllInputs():[]}getResourceInformation(){return this._actionCollection.getResourceInformation()}findDOMNodeOwner(e){let t;for(let n=0;n<this.getActionCount();n++){const r=this.getActionAt(n);if(r&&(t=r.findDOMNodeOwner(e),t))return t}return super.findDOMNodeOwner(e)}getElementById(e){let t=super.getElementById(e);return t||(t=this.getElementByIdFromAction(e)),t}get isInteractive(){return!0}}Tp.orientationProperty=new Dd(Sd.v1_1,"orientation",zu),Dh([Od(Tp.orientationProperty)],Tp.prototype,"orientation",void 0);class Dp extends Wh{get style(){if(this.allowCustomStyle){const e=this.getValue(Dp.styleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e))return e}}set style(e){this.setValue(Dp.styleProperty,e)}get allowCustomStyle(){return!0}get hasExplicitStyle(){return void 0!==this.getValue(Dp.styleProperty)}applyBorder(){}applyBackground(){if(this.renderedElement){const e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(e.backgroundColor){const t=md(e.backgroundColor);t&&(this.renderedElement.style.backgroundColor=t)}}}applyPadding(){if(super.applyPadding(),!this.renderedElement)return;let e=new sd;if(this.getEffectivePadding()&&(e=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())),this.renderedElement.style.paddingTop=e.top+"px",this.renderedElement.style.paddingRight=e.right+"px",this.renderedElement.style.paddingBottom=e.bottom+"px",this.renderedElement.style.paddingLeft=e.left+"px",this.isBleeding()){const e=new id;this.getImmediateSurroundingPadding(e);const t=this.hostConfig.paddingDefinitionToSpacingDefinition(e);this.renderedElement.style.marginRight="-"+t.right+"px",this.renderedElement.style.marginLeft="-"+t.left+"px",this.isDesignMode()||(this.renderedElement.style.marginTop="-"+t.top+"px",this.renderedElement.style.marginBottom="-"+t.bottom+"px"),this.separatorElement&&this.separatorOrientation===zu.Horizontal&&(this.separatorElement.style.marginLeft="-"+t.left+"px",this.separatorElement.style.marginRight="-"+t.right+"px")}else this.renderedElement.style.marginRight="0",this.renderedElement.style.marginLeft="0",this.renderedElement.style.marginTop="0",this.renderedElement.style.marginBottom="0",this.separatorElement&&this.separatorOrientation===zu.Horizontal&&(this.separatorElement.style.marginRight="0",this.separatorElement.style.marginLeft="0")}getHasBackground(e=!1){let t=this.parent;for(;t;){let n=!1;if(n=!e&&(t instanceof Rp&&t.backgroundImage.isValid()),t instanceof Dp&&this.hasExplicitStyle&&(t.getEffectiveStyle()!==this.getEffectiveStyle()||n))return!0;t=t.parent}return!1}getDefaultPadding(){return this.getHasBackground()||this.getHasBorder()?new id(Nu.Padding,Nu.Padding,Nu.Padding,Nu.Padding):super.getDefaultPadding()}internalValidateProperties(e){super.internalValidateProperties(e);const t=this.getValue(Dp.styleProperty);if(void 0!==t){this.hostConfig.containerStyles.getStyleByName(t)||e.addFailure(this,Gu.InvalidPropertyValue,Cd.errors.invalidPropertyValue(t,"style"))}}render(){const e=super.render();return e&&this.getHasBackground()&&this.applyBackground(),this.applyBorder(),e}getEffectiveStyle(){const e=this.style;return e||super.getEffectiveStyle()}}Dp.styleProperty=new class extends Td{constructor(e,t,n,r){super(e,t,[{value:Eu.Default},{value:Eu.Emphasis},{targetVersion:Sd.v1_2,value:Eu.Accent},{targetVersion:Sd.v1_2,value:Eu.Good},{targetVersion:Sd.v1_2,value:Eu.Attention},{targetVersion:Sd.v1_2,value:Eu.Warning}],n,r),this.targetVersion=e,this.name=t,this.defaultValue=n,this.onGetInitialValue=r}}(Sd.v1_0,"style"),Dh([Od(Dp.styleProperty)],Dp.prototype,"style",null);class Mp extends Dp{constructor(){super(...arguments),this._bleed=!1}adjustRenderedElementSize(e){super.adjustRenderedElementSize(e),this.minPixelHeight&&(e.style.minHeight=this.minPixelHeight+"px")}getHasExpandedAction(){return!1}getBleed(){return this._bleed}setBleed(e){this._bleed=e}get renderedActionCount(){return 0}isBleeding(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()}}Mp.bleedProperty=new Pd(Sd.v1_2,"bleed",!1),Mp.minHeightProperty=new class extends Id{parse(e,t,n){let r;const s=t[this.name];if("string"==typeof s){let i=!1;try{const e=ad.parse(s,!0);e.unit===Tu.Pixel&&(r=e.physicalSize,i=!0)}catch(e){}i||n.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.invalidPropertyValue(t[this.name],this.name))}return r}toJSON(e,t,n,r){r.serializeValue(t,this.name,"number"!=typeof n||isNaN(n)?void 0:n+"px")}}(Sd.v1_2,"minHeight"),Dh([Od(Mp.bleedProperty)],Mp.prototype,"_bleed",void 0),Dh([Od(Mp.minHeightProperty)],Mp.prototype,"minPixelHeight",void 0);class Lp extends _d{getSchemaKey(){return"BackgroundImage"}internalParse(e,t){if("string"!=typeof e)return super.internalParse(e,t);this.resetDefaultValues(),this.url=e}apply(e){if(this.url&&e.renderedElement){switch(e.renderedElement.style.backgroundImage="url('"+e.preProcessPropertyValue(Lp.urlProperty,this.url)+"')",this.fillMode){case ju.Repeat:e.renderedElement.style.backgroundRepeat="repeat";break;case ju.RepeatHorizontally:e.renderedElement.style.backgroundRepeat="repeat-x";break;case ju.RepeatVertically:e.renderedElement.style.backgroundRepeat="repeat-y";break;case ju.Cover:default:e.renderedElement.style.backgroundRepeat="no-repeat",e.renderedElement.style.backgroundSize="cover"}switch(this.horizontalAlignment){case _u.Left:break;case _u.Center:e.renderedElement.style.backgroundPositionX="center";break;case _u.Right:e.renderedElement.style.backgroundPositionX="right"}switch(this.verticalAlignment){case Bu.Top:break;case Bu.Center:e.renderedElement.style.backgroundPositionY="center";break;case Bu.Bottom:e.renderedElement.style.backgroundPositionY="bottom"}}}isValid(){return!!this.url}}Lp.urlProperty=new Ad(Sd.v1_0,"url"),Lp.fillModeProperty=new Dd(Sd.v1_2,"fillMode",ju,ju.Cover),Lp.horizontalAlignmentProperty=new Dd(Sd.v1_2,"horizontalAlignment",_u,_u.Left),Lp.verticalAlignmentProperty=new Dd(Sd.v1_2,"verticalAlignment",Bu,Bu.Top),Dh([Od(Lp.urlProperty)],Lp.prototype,"url",void 0),Dh([Od(Lp.fillModeProperty)],Lp.prototype,"fillMode",void 0),Dh([Od(Lp.horizontalAlignmentProperty)],Lp.prototype,"horizontalAlignment",void 0),Dh([Od(Lp.verticalAlignmentProperty)],Lp.prototype,"verticalAlignment",void 0);class Rp extends Mp{constructor(){super(...arguments),this._items=[],this._renderedItems=[]}get backgroundImage(){return this.getValue(Rp.backgroundImageProperty)}insertItemAt(e,t,n){if(e.parent&&!n)throw new Error(Cd.errors.elementAlreadyParented());if(!e.isStandalone)throw new Error(Cd.errors.elementTypeNotStandalone(e.getJsonTypeName()));t<0||t>=this._items.length?this._items.push(e):this._items.splice(t,0,e),e.setParent(this)}getItemsCollectionPropertyName(){return"items"}applyBackground(){this.backgroundImage.isValid()&&this.renderedElement&&this.backgroundImage.apply(this),super.applyBackground()}applyRTL(e){void 0!==this.rtl&&(e.dir=this.rtl?"rtl":"ltr")}internalRender(){this._renderedItems=[];const e=this.hostConfig,t=document.createElement("div");switch(this.applyRTL(t),t.classList.add(e.makeCssClassName("ac-container")),t.style.display="flex",t.style.flexDirection="column",ed.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.getEffectiveVerticalContentAlignment()){case Bu.Center:t.style.justifyContent="center";break;case Bu.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}if(this._items.length>0)for(const e of this._items){const n=this.isElementAllowed(e)?e.render():void 0;n&&(this._renderedItems.length>0&&e.separatorElement&&(e.separatorElement.style.flex="0 0 auto",ud(t,e.separatorElement)),ud(t,n),this._renderedItems.push(e))}else if(this.isDesignMode()){const e=this.createPlaceholderElement();e.style.width="100%",e.style.height="100%",t.appendChild(e)}return t}truncateOverflow(e){if(this.renderedElement){const t=this.renderedElement.offsetTop+e+1,n=e=>{const r=e.renderedElement;if(r)switch(function(e,t){const n=e.offsetTop;return n+e.clientHeight<=t?Zu.FullyInContainer:n<t?Zu.Overflowing:Zu.FullyOutOfContainer}(r,t)){case Zu.FullyInContainer:e.resetOverflow()&&n(e);break;case Zu.Overflowing:const s=t-r.offsetTop;e.handleOverflow(s);break;case Zu.FullyOutOfContainer:e.handleOverflow(0)}};for(const e of this._items)n(e);return!0}return!1}undoOverflowTruncation(){for(const e of this._items)e.resetOverflow()}getHasBackground(e=!1){return!e&&this.backgroundImage.isValid()||super.getHasBackground(e)}internalParse(e,t){super.internalParse(e,t),this.clear(),this.setShouldFallback(!1);let n=e[this.getItemsCollectionPropertyName()];if(Array.isArray(n))for(const e of n){const n=t.parseElement(this,e,this.forbiddenChildElements(),!this.isDesignMode());n&&this.insertItemAt(n,-1,!0)}}internalToJSON(e,t){super.internalToJSON(e,t);const n=this.getItemsCollectionPropertyName();t.serializeArray(e,n,this._items)}get isSelectable(){return!0}getEffectivePadding(){return ed.removePaddingFromContainersWithBackgroundImage&&!this.getHasBackground(!0)?new id:super.getEffectivePadding()}getEffectiveVerticalContentAlignment(){if(void 0!==this.verticalContentAlignment)return this.verticalContentAlignment;const e=this.getParentContainer();return e?e.getEffectiveVerticalContentAlignment():Bu.Top}getItemCount(){return this._items.length}getItemAt(e){return this._items[e]}getFirstVisibleRenderedItem(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(const e of this._renderedItems)if(e.isVisible)return e}getLastVisibleRenderedItem(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0)for(let e=this._renderedItems.length-1;e>=0;e--)if(this._renderedItems[e].isVisible)return this._renderedItems[e]}getJsonTypeName(){return"Container"}isFirstElement(e){const t=this.isDesignMode();for(const n of this._items)if(n.isVisible||t)return n===e;return!1}isLastElement(e){const t=this.isDesignMode();for(let n=this._items.length-1;n>=0;n--)if(this._items[n].isVisible||t)return this._items[n]===e;return!1}isRtl(){if(void 0!==this.rtl)return this.rtl;{const e=this.getParentContainer();return!!e&&e.isRtl()}}isBleedingAtTop(){const e=this.getFirstVisibleRenderedItem();return this.isBleeding()||!!e&&e.isBleedingAtTop()}isBleedingAtBottom(){const e=this.getLastVisibleRenderedItem();return this.isBleeding()||!!e&&(e.isBleedingAtBottom()&&e.getEffectiveStyle()===this.getEffectiveStyle())}indexOf(e){return this._items.indexOf(e)}addItem(e){this.insertItemAt(e,-1,!1)}insertItemBefore(e,t){this.insertItemAt(e,this._items.indexOf(t),!1)}insertItemAfter(e,t){this.insertItemAt(e,this._items.indexOf(t)+1,!1)}removeItem(e){const t=this._items.indexOf(e);return t>=0&&(this._items.splice(t,1),e.setParent(void 0),this.updateLayout(),!0)}clear(){this._items=[],this._renderedItems=[]}getResourceInformation(){const e=super.getResourceInformation();return this.backgroundImage.isValid()&&e.push({url:this.backgroundImage.url,mimeType:"image"}),e}getActionById(e){let t=super.getActionById(e);if(!t&&(this.selectAction&&(t=this.selectAction.getActionById(e)),!t))for(const n of this._items)if(t=n.getActionById(e),t)break;return t}get padding(){return this.getPadding()}set padding(e){this.setPadding(e)}get selectAction(){return this._selectAction}set selectAction(e){this._selectAction=e}get bleed(){return this.getBleed()}set bleed(e){this.setBleed(e)}}Rp.backgroundImageProperty=new Md(Sd.v1_0,"backgroundImage",Lp),Rp.verticalContentAlignmentProperty=new Dd(Sd.v1_1,"verticalContentAlignment",Bu),Rp.rtlProperty=new Pd(Sd.v1_0,"rtl"),Dh([Od(Rp.backgroundImageProperty)],Rp.prototype,"backgroundImage",null),Dh([Od(Rp.verticalContentAlignmentProperty)],Rp.prototype,"verticalContentAlignment",void 0),Dh([Od(Rp.rtlProperty)],Rp.prototype,"rtl",void 0);class Np extends Rp{adjustRenderedElementSize(e){this.isDesignMode()?(e.style.minWidth="20px",e.style.minHeight=(this.minPixelHeight?Math.max(this.minPixelHeight,20):20)+"px"):(e.style.minWidth="0",this.minPixelHeight&&(e.style.minHeight=this.minPixelHeight+"px")),"auto"===this.width?e.style.flex="0 1 auto":"stretch"===this.width?e.style.flex="1 1 50px":this.width instanceof ad&&(this.width.unit===Tu.Pixel?(e.style.flex="0 0 auto",e.style.width=this.width.physicalSize+"px"):e.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:this.width.physicalSize)+"%")}shouldSerialize(e){return!0}get separatorOrientation(){return zu.Vertical}constructor(e="stretch"){super(),this.width="stretch",this._computedWeight=0,this.width=e}getJsonTypeName(){return"Column"}get hasVisibleSeparator(){return!!(this.parent&&this.parent instanceof Op)&&(void 0!==this.separatorElement&&!this.parent.isLeftMostElement(this))}get isStandalone(){return!1}}Np.widthProperty=new Rd(Sd.v1_0,"width",((e,t,n,r)=>{let s=t.defaultValue;const i=n[t.name];let a=!1;if("number"!=typeof i||isNaN(i))if("auto"===i||"stretch"===i)s=i;else if("string"==typeof i)try{s=ad.parse(i),s.unit===Tu.Pixel&&t.targetVersion.compareTo(r.targetVersion)>0&&(a=!0)}catch(e){a=!0}else a=!0;else s=new ad(i,Tu.Weight);return a&&(r.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.invalidColumnWidth(i)),s="auto"),s}),((e,t,n,r,s)=>{r instanceof ad?r.unit===Tu.Pixel?s.serializeValue(n,"width",r.physicalSize+"px"):s.serializeNumber(n,"width",r.physicalSize):s.serializeValue(n,"width",r)}),"stretch"),Dh([Od(Np.widthProperty)],Np.prototype,"width",void 0);class Op extends Mp{constructor(){super(...arguments),this._columns=[]}createColumnInstance(e,t){return t.parseCardObject(this,e,[],!this.isDesignMode(),(e=>e&&"Column"!==e?void 0:new Np),((e,n)=>{t.logParseEvent(void 0,Gu.ElementTypeNotAllowed,Cd.errors.elementTypeNotAllowed(e))}))}internalRender(){if(this._renderedColumns=[],this._columns.length>0){const e=this.hostConfig,t=document.createElement("div");switch(t.className=e.makeCssClassName("ac-columnSet"),t.style.display="flex",ed.useAdvancedCardBottomTruncation&&(t.style.minHeight="-webkit-min-content"),this.getEffectiveHorizontalAlignment()){case _u.Center:t.style.justifyContent="center";break;case _u.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start"}let n=0;for(const e of this._columns)e.width instanceof ad&&e.width.unit===Tu.Weight&&(n+=e.width.physicalSize);for(const e of this._columns){if(e.width instanceof ad&&e.width.unit===Tu.Weight&&n>0){const t=100/n*e.width.physicalSize;e._computedWeight=t}const r=e.render();r&&(this._renderedColumns.length>0&&e.separatorElement&&(e.separatorElement.style.flex="0 0 auto",ud(t,e.separatorElement)),ud(t,r),this._renderedColumns.push(e))}return this._renderedColumns.length>0?t:void 0}}truncateOverflow(e){for(const t of this._columns)t.handleOverflow(e);return!0}undoOverflowTruncation(){for(const e of this._columns)e.resetOverflow()}get isSelectable(){return!0}internalParse(e,t){super.internalParse(e,t),this._columns=[],this._renderedColumns=[];const n=e.columns;if(Array.isArray(n))for(const e of n){const n=this.createColumnInstance(e,t);n&&this._columns.push(n)}}internalToJSON(e,t){super.internalToJSON(e,t),t.serializeArray(e,"columns",this._columns)}isFirstElement(e){for(const t of this._columns)if(t.isVisible)return t===e;return!1}isBleedingAtTop(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(const e of this._columns)if(e.isBleedingAtTop())return!0;return!1}isBleedingAtBottom(){if(this.isBleeding())return!0;if(this._renderedColumns&&this._renderedColumns.length>0)for(const e of this._columns)if(e.isBleedingAtBottom())return!0;return!1}getItemCount(){return this._columns.length}getFirstVisibleRenderedItem(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[0]:void 0}getLastVisibleRenderedItem(){return this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0?this._renderedColumns[this._renderedColumns.length-1]:void 0}getColumnAt(e){return this._columns[e]}getItemAt(e){return this.getColumnAt(e)}getJsonTypeName(){return"ColumnSet"}internalValidateProperties(e){super.internalValidateProperties(e);let t=0,n=0;for(const e of this._columns)"number"==typeof e.width?t++:"stretch"===e.width&&n++;t>0&&n>0&&e.addFailure(this,Gu.Hint,Cd.hints.dontUseWeightedAndStrecthedColumnsInSameSet())}addColumn(e){if(e.parent)throw new Error(Cd.errors.columnAlreadyBelongsToAnotherSet());this._columns.push(e),e.setParent(this)}removeItem(e){if(e instanceof Np){const t=this._columns.indexOf(e);if(t>=0)return this._columns.splice(t,1),e.setParent(void 0),this.updateLayout(),!0}return!1}indexOf(e){return e instanceof Np?this._columns.indexOf(e):-1}isLeftMostElement(e){return 0===this._columns.indexOf(e)}isRightMostElement(e){return this._columns.indexOf(e)===this._columns.length-1}isTopElement(e){return this._columns.indexOf(e)>=0}isBottomElement(e){return this._columns.indexOf(e)>=0}getActionById(e){let t;for(const n of this._columns)if(t=n.getActionById(e),t)break;return t}get bleed(){return this.getBleed()}set bleed(e){this.setBleed(e)}get padding(){return this.getPadding()}set padding(e){this.setPadding(e)}get selectAction(){return this._selectAction}set selectAction(e){this._selectAction=e}}function _p(e){const t=e.getRootElement(),n=t&&t.onImageLoaded?t.onImageLoaded:Qp.onImageLoaded;n&&n(e)}function Bp(e,t,n){const r=e.getRootElement(),s=r&&r.onAnchorClicked?r.onAnchorClicked:Qp.onAnchorClicked;return void 0!==s&&s(e,t,n)}function Fp(e,t){const n=e.parent?e.parent.getRootElement():void 0,r=n&&n.onInlineCardExpanded?n.onInlineCardExpanded:Qp.onInlineCardExpanded;r&&r(e,t)}function Up(e,t=!0){const n=e.getRootElement();t&&n.updateLayout();const r=n,s=r&&r.onElementVisibilityChanged?r.onElementVisibilityChanged:Qp.onElementVisibilityChanged;void 0!==s&&s(e)}function Hp(e,t){t?(e.readOnly=!0,e.required=!0):(e.readOnly=!1,e.required=!1)}class zp extends Rp{internalParse(e,t){super.internalParse(e,t),this.parseActions(e,t)}parseActions(e,t){this._actionCollection.parse(e.actions,t)}internalToJSON(e,t){super.internalToJSON(e,t),this._actionCollection.toJSON(e,"actions",t)}internalRender(){const e=super.internalRender();if(e){const t=this._actionCollection.render(this.hostConfig.actions.actionsOrientation);return t&&(ud(e,Rh(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},zu.Horizontal)),ud(e,t)),this.renderIfEmpty||e.children.length>0?e:void 0}}getHasExpandedAction(){return 0!==this.renderedActionCount&&(1===this.renderedActionCount?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction)}get renderedActionCount(){return this._actionCollection.renderedActionCount}get renderIfEmpty(){return!1}constructor(){super(),this._actionCollection=new kp(this)}releaseDOMResources(){super.releaseDOMResources(),this._actionCollection.releaseDOMResources()}getActionCount(){return this._actionCollection.getActionCount()}getActionAt(e){return e>=0&&e<this.getActionCount()?this._actionCollection.getActionAt(e):super.getActionAt(e)}getActionById(e){const t=this._actionCollection.getActionById(e);return t||super.getActionById(e)}internalValidateProperties(e){super.internalValidateProperties(e),this._actionCollection&&this._actionCollection.validateProperties(e)}isLastElement(e){return super.isLastElement(e)&&0===this._actionCollection.getActionCount()}addAction(e){this._actionCollection.addAction(e)}clear(){super.clear(),this._actionCollection.clear()}getAllInputs(e=!0){let t=super.getAllInputs(e);return e&&t.push(...this._actionCollection.getAllInputs(e)),t}getResourceInformation(){let e=super.getResourceInformation();return e.push(...this._actionCollection.getResourceInformation()),e}isBleedingAtBottom(){return 0===this._actionCollection.renderedActionCount?super.isBleedingAtBottom():1===this._actionCollection.getActionCount()?void 0!==this._actionCollection.expandedAction&&!this.hostConfig.actions.preExpandSingleShowCardAction:void 0!==this._actionCollection.expandedAction}getForbiddenActionNames(){return[]}getElementById(e){let t=super.getElementById(e);return t||(t=this.getElementByIdFromAction(e)),t}get isStandalone(){return!1}}class jp extends _d{get action(){return this.getValue(jp.actionProperty)}set action(e){this.setValue(jp.actionProperty,e),e&&e.setParent(this.parent)}getSchemaKey(){return"RefreshDefinition"}}jp.actionProperty=new class extends Id{parse(e,t,n){const r=n.parseAction(e.parent,t[this.name],[],!1);if(void 0!==r){if(r instanceof bp)return r;n.logParseEvent(e,Gu.ActionTypeNotAllowed,Cd.errors.actionTypeNotAllowed(r.getJsonTypeName()))}n.logParseEvent(e,Gu.PropertyCantBeNull,Cd.errors.propertyMustBeSet("action"))}toJSON(e,t,n,r){r.serializeValue(t,this.name,n?n.toJSON(r):void 0,void 0,!0)}constructor(e,t){super(e,t,void 0),this.targetVersion=e,this.name=t}}(Sd.v1_4,"action"),jp.userIdsProperty=new class extends Id{parse(e,t,n){const r=t[this.name];if(void 0===r||!Array.isArray(r))return this.defaultValue;const s=[];for(const t of r)"string"==typeof t?s.push(t):n.logParseEvent(e,Gu.InvalidPropertyValue,`Invalid array value "${JSON.stringify(t)}" of type "${typeof t}" ignored for "${this.name}".`);return s}toJSON(e,t,n,r){r.serializeArray(t,this.name,n)}constructor(e,t,n,r){super(e,t,n,r),this.targetVersion=e,this.name=t,this.defaultValue=n,this.onGetInitialValue=r}}(Sd.v1_4,"userIds"),Dh([Od(jp.actionProperty)],jp.prototype,"action",null),Dh([Od(jp.userIdsProperty)],jp.prototype,"userIds",void 0);class Vp extends _d{getSchemaKey(){return"AuthCardButton"}}Vp.typeProperty=new Ad(Sd.v1_4,"type"),Vp.titleProperty=new Ad(Sd.v1_4,"title"),Vp.imageProperty=new Ad(Sd.v1_4,"image"),Vp.valueProperty=new Ad(Sd.v1_4,"value"),Dh([Od(Vp.typeProperty)],Vp.prototype,"type",void 0),Dh([Od(Vp.titleProperty)],Vp.prototype,"title",void 0),Dh([Od(Vp.imageProperty)],Vp.prototype,"image",void 0),Dh([Od(Vp.valueProperty)],Vp.prototype,"value",void 0);class qp extends _d{getSchemaKey(){return"TokenExchangeResource"}}qp.idProperty=new Ad(Sd.v1_4,"id"),qp.uriProperty=new Ad(Sd.v1_4,"uri"),qp.providerIdProperty=new Ad(Sd.v1_4,"providerId"),Dh([Od(qp.idProperty)],qp.prototype,"id",void 0),Dh([Od(qp.uriProperty)],qp.prototype,"uri",void 0),Dh([Od(qp.providerIdProperty)],qp.prototype,"providerId",void 0);class Wp extends _d{getSchemaKey(){return"Authentication"}}Wp.textProperty=new Ad(Sd.v1_4,"text"),Wp.connectionNameProperty=new Ad(Sd.v1_4,"connectionName"),Wp.buttonsProperty=new Ld(Sd.v1_4,"buttons",Vp),Wp.tokenExchangeResourceProperty=new Md(Sd.v1_4,"tokenExchangeResource",qp,!0),Dh([Od(Wp.textProperty)],Wp.prototype,"text",void 0),Dh([Od(Wp.connectionNameProperty)],Wp.prototype,"connectionName",void 0),Dh([Od(Wp.buttonsProperty)],Wp.prototype,"buttons",void 0),Dh([Od(Wp.tokenExchangeResourceProperty)],Wp.prototype,"tokenExchangeResource",void 0);class Qp extends zp{constructor(){super(...arguments),this.designMode=!1}get refresh(){return this.getValue(Qp.refreshProperty)}set refresh(e){this.setValue(Qp.refreshProperty,e),e&&(e.parent=this)}static get processMarkdown(){throw new Error(Cd.errors.processMarkdownEventRemoved())}static set processMarkdown(e){throw new Error(Cd.errors.processMarkdownEventRemoved())}static applyMarkdown(e){const t={didProcess:!1};if(Qp.onProcessMarkdown)Qp.onProcessMarkdown(e,t);else if(window.markdownit){const n=window.markdownit;t.outputHtml=n().render(e),t.didProcess=!0}else Qp._haveWarnedAboutNoMarkdownProcessing||(Th.warn(Cd.errors.markdownProcessingNotEnabled),Qp._haveWarnedAboutNoMarkdownProcessing=!0);return t}isVersionSupported(){if(this.bypassVersionCheck)return!0;return!(!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major===this.version.major&&this.maxVersion.minor<this.version.minor)}getDefaultSerializationContext(){return new Zp(this.version)}getItemsCollectionPropertyName(){return"body"}internalParse(e,t){this._fallbackCard=void 0;const n=t.parseElement(void 0,e.fallback,this.forbiddenChildElements(),!this.isDesignMode());n&&(this._fallbackCard=new Qp,this._fallbackCard.addItem(n)),super.internalParse(e,t)}internalToJSON(e,t){this.setValue(Qp.versionProperty,t.targetVersion),super.internalToJSON(e,t)}internalRender(){const e=super.internalRender();return ed.useAdvancedCardBottomTruncation&&e&&e.style.removeProperty("minHeight"),e}getHasBackground(e=!1){return!0}getDefaultPadding(){return new id(Nu.Padding,Nu.Padding,Nu.Padding,Nu.Padding)}shouldSerialize(e){return!0}get renderIfEmpty(){return!0}get bypassVersionCheck(){return!1}get allowCustomStyle(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle}get hasBackground(){return!0}getJsonTypeName(){return"AdaptiveCard"}internalValidateProperties(e){super.internalValidateProperties(e),"AdaptiveCard"!==this.getValue(Nh.typeNameProperty)&&e.addFailure(this,Gu.MissingCardType,Cd.errors.invalidCardType()),this.bypassVersionCheck||this.version?this.isVersionSupported()||e.addFailure(this,Gu.UnsupportedCardVersion,Cd.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString())):e.addFailure(this,Gu.PropertyCantBeNull,Cd.errors.propertyMustBeSet("version"))}render(e){let t;this.shouldFallback()&&this._fallbackCard?(this._fallbackCard.hostConfig=this.hostConfig,t=this._fallbackCard.render()):(t=super.render(),t&&(t.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard")),ed.setTabIndexAtCardRoot&&(t.tabIndex=0),this.speak&&t.setAttribute("aria-label",this.speak),t.onmouseenter=e=>{this.updateInputsVisualState(!0)},t.onmouseleave=e=>{this.updateInputsVisualState(!1)},this.getRootElement().updateActionsEnabledState())),e&&(ud(e,t),this.updateLayout());const n=this.getAllInputs();return document.onclick=e=>{n.forEach((t=>{var n,r;t instanceof cp&&!(null===(n=t.renderedElement)||void 0===n?void 0:n.contains(e.target))&&(null===(r=t.getDropdownElement())||void 0===r||r.classList.remove(this.hostConfig.makeCssClassName("ac-choiceSetInput-filtered-dropdown-open")))}))},t}updateLayout(e=!0){if(super.updateLayout(e),ed.useAdvancedCardBottomTruncation&&this.isDisplayed()){const e=this.hostConfig.getEffectiveSpacing(Nu.Default);this.handleOverflow(this.renderedElement.offsetHeight-e)}}shouldFallback(){return super.shouldFallback()||!this.isVersionSupported()}get hasVisibleSeparator(){return!1}}Qp.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json",Qp.$schemaProperty=new Rd(Sd.v1_0,"$schema",((e,t,n,r)=>Qp.schemaUrl),((e,t,n,r,s)=>{s.serializeValue(n,t.name,Qp.schemaUrl)})),Qp.versionProperty=new Rd(Sd.v1_0,"version",((e,t,n,r)=>{let s=wd.parse(n[t.name],r);return void 0===s&&(s=Sd.latest,r.logParseEvent(e,Gu.InvalidPropertyValue,Cd.errors.invalidCardVersion(s.toString()))),s}),((e,t,n,r,s)=>{void 0!==r&&s.serializeValue(n,t.name,r.toString())}),Sd.v1_0),Qp.fallbackTextProperty=new Ad(Sd.v1_0,"fallbackText"),Qp.speakProperty=new Ad(Sd.v1_0,"speak"),Qp.refreshProperty=new Md(Sd.v1_4,"refresh",jp,!0),Qp.authenticationProperty=new Md(Sd.v1_4,"authentication",Wp,!0),Qp._haveWarnedAboutNoMarkdownProcessing=!1,Dh([Od(Qp.versionProperty)],Qp.prototype,"version",void 0),Dh([Od(Qp.fallbackTextProperty)],Qp.prototype,"fallbackText",void 0),Dh([Od(Qp.speakProperty)],Qp.prototype,"speak",void 0),Dh([Od(Qp.refreshProperty)],Qp.prototype,"refresh",null),Dh([Od(Qp.authenticationProperty)],Qp.prototype,"authentication",void 0);class Gp extends Qp{constructor(){super(...arguments),this.suppressStyle=!1}getSchemaKey(){return"InlineAdaptiveCard"}populateSchema(e){super.populateSchema(e),e.remove(Qp.$schemaProperty,Qp.versionProperty)}getDefaultPadding(){return new id(this.suppressStyle?Nu.None:Nu.Padding,Nu.Padding,this.suppressStyle?Nu.None:Nu.Padding,Nu.Padding)}get bypassVersionCheck(){return!0}get defaultStyle(){return this.suppressStyle?Eu.Default:this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:Eu.Emphasis}render(e){const t=super.render(e);return t&&(t.setAttribute("aria-live","polite"),t.removeAttribute("tabindex")),t}}class Zp extends Ed{constructor(){super(...arguments),this._forbiddenTypes=new Set}internalParseCardObject(e,t,n,r,s,i){let a;if(t&&"object"==typeof t){const o=new Set;this._forbiddenTypes.forEach((e=>{o.add(e)})),n.forEach((e=>{this._forbiddenTypes.add(e)}));const l=dd(t.type);if(l&&this._forbiddenTypes.has(l))i(l,Yu.ForbiddenType);else{let o=!1;if(a=s(l),a?(a.setParent(e),a.parse(t,this),o=ed.enableFallback&&r&&a.shouldFallback()):(o=ed.enableFallback&&r,i(l,Yu.UnknownType)),o){const r=t.fallback;!r&&e&&e.setShouldFallback(!0),"string"==typeof r&&"drop"===r.toLowerCase()?a=void 0:"object"==typeof r&&(a=this.internalParseCardObject(e,r,n,!0,s,i))}}this._forbiddenTypes=o}return a}cardObjectParsed(e,t){e instanceof mp&&this.onParseAction?this.onParseAction(e,t,this):e instanceof Nh&&this.onParseElement&&this.onParseElement(e,t,this)}shouldSerialize(e){return e instanceof mp?void 0!==this.actionRegistry.findByName(e.getJsonTypeName()):!(e instanceof Nh)||void 0!==this.elementRegistry.findByName(e.getJsonTypeName())}parseCardObject(e,t,n,r,s,i){const a=new Set(n),o=this.internalParseCardObject(e,t,a,r,s,i);return void 0!==o&&this.cardObjectParsed(o,t),o}parseElement(e,t,n,r){return this.parseCardObject(e,t,n,r,(e=>this.elementRegistry.createInstance(e,this.targetVersion)),((e,t)=>{t===Yu.UnknownType?this.logParseEvent(void 0,Gu.UnknownElementType,Cd.errors.unknownElementType(e)):this.logParseEvent(void 0,Gu.ElementTypeNotAllowed,Cd.errors.elementTypeNotAllowed(e))}))}parseAction(e,t,n,r){return this.parseCardObject(e,t,n,r,(e=>this.actionRegistry.createInstance(e,this.targetVersion)),((e,t)=>{t===Yu.UnknownType?this.logParseEvent(void 0,Gu.UnknownActionType,Cd.errors.unknownActionType(e)):this.logParseEvent(void 0,Gu.ActionTypeNotAllowed,Cd.errors.actionTypeNotAllowed(e))}))}get elementRegistry(){var e;return null!==(e=this._elementRegistry)&&void 0!==e?e:Ch.elements}setElementRegistry(e){this._elementRegistry=e}get actionRegistry(){var e;return null!==(e=this._actionRegistry)&&void 0!==e?e:Ch.actions}setActionRegistry(e){this._actionRegistry=e}}Ch.defaultElements.register("Container",Rp),Ch.defaultElements.register("TextBlock",Bh),Ch.defaultElements.register("RichTextBlock",Uh,Sd.v1_2),Ch.defaultElements.register("TextRun",Fh,Sd.v1_2),Ch.defaultElements.register("Image",Vh),Ch.defaultElements.register("ImageSet",Qh),Ch.defaultElements.register("Media",rp,Sd.v1_1),Ch.defaultElements.register("FactSet",zh),Ch.defaultElements.register("ColumnSet",Op),Ch.defaultElements.register("ActionSet",Tp,Sd.v1_2),Ch.defaultElements.register("Input.Text",ip),Ch.defaultElements.register("Input.Date",hp),Ch.defaultElements.register("Input.Time",gp),Ch.defaultElements.register("Input.Number",dp),Ch.defaultElements.register("Input.ChoiceSet",cp),Ch.defaultElements.register("Input.Toggle",ap),Ch.defaultActions.register(wp.JsonTypeName,wp),Ch.defaultActions.register(yp.JsonTypeName,yp),Ch.defaultActions.register(Ap.JsonTypeName,Ap),Ch.defaultActions.register(Sp.JsonTypeName,Sp,Sd.v1_2),Ch.defaultActions.register(bp.JsonTypeName,bp,Sd.v1_4);var Yp=n(62614),Kp=n.n(Yp);const Jp=(0,pt.Q)(ft.tR),Xp={...(0,Ka.mO)(),cardRoot:{color:Jp.black,fontSize:Pt.L.fontSizeBase300,"& pre":{whiteSpace:"pre-wrap"},"& table":{...gt.Pt.border("1px","solid",Pt.L.colorNeutralBackground1Pressed),borderCollapse:"collapse"},"& th":{backgroundColor:Pt.L.colorNeutralBackground1Hover,...gt.Pt.padding("1px","5px")},"& td":{...gt.Pt.borderBottom("1px","solid",Pt.L.colorNeutralBackground3Pressed),...gt.Pt.padding("1px","5px")},"& a ":{...{height:Pt.L.lineHeightBase200,gap:Pt.L.spacingHorizontalXS,display:"inline-flex",alignItems:"flex-start",color:Jp.colorBrandForegroundLink,...gt.Pt.padding("0px","0px",Pt.L.spacingVerticalXXS),textDecorationLine:"none",cursor:"pointer","&:hover":{color:Jp.colorBrandForegroundLinkHover,...gt.Pt.textDecoration("underline","solid")},"&:active":{color:Jp.colorBrandForegroundLinkPressed,...gt.Pt.textDecoration("underline","solid")},"&:focus":{color:Jp.colorBrandForegroundLinkSelected,...gt.Pt.textDecoration("underline","solid",Pt.L.colorStrokeFocus2),...gt.Pt.borderBottom("1px","solid",Pt.L.colorStrokeFocus2)},"&:disabled":{color:Pt.L.colorNeutralForegroundDisabled,textDecorationLine:"none",cursor:"default"}}},"& button, .ac-pushButton":{...{display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",fontWeight:Pt.L.fontWeightRegular,color:Pt.L.colorNeutralForeground1,fontSize:Pt.L.fontSizeBase200,...gt.Pt.padding(Pt.L.spacingVerticalXS,Pt.L.spacingHorizontalS),...gt.Pt.borderRadius(Pt.L.borderRadiusMedium),...gt.Pt.border("1px","solid",Pt.L.colorNeutralStroke1),backgroundColor:Pt.L.colorNeutralBackground1,cursor:"pointer","&:hover":{...gt.Pt.borderColor(Pt.L.colorNeutralStroke1Hover),backgroundColor:Pt.L.colorNeutralBackground1Hover,color:Pt.L.colorNeutralForeground1Hover},[`&:hover .${jn.h.icon}`]:{color:Jp.themePrimary},"&:hover:active":{backgroundColor:Pt.L.colorNeutralBackground1Pressed,color:Pt.L.colorNeutralForeground1Pressed,...gt.Pt.borderColor(Pt.L.colorNeutralStroke1Pressed)},"&:disabled":{...gt.Pt.borderColor(Pt.L.colorNeutralStrokeDisabled),color:Pt.L.colorNeutralForegroundDisabled,backgroundColor:Pt.L.colorNeutralBackgroundDisabled,cursor:"default"}}},"& .ac-container":{"& ol, ul":{paddingInlineStart:Pt.L.spacingVerticalXL}},"& .ac-image":{objectFit:"contain"}},decorativeBorder:{...gt.Pt.margin(Pt.L.spacingVerticalS,Pt.L.spacingVerticalNone,Pt.L.spacingVerticalNone),...{...gt.Pt.borderRadius(Pt.L.borderRadiusMedium),...gt.Pt.border("1px","solid",Pt.L.colorNeutralStroke1)}},adaptiveCardWrapper:{...gt.Pt.padding(Pt.L.spacingVerticalS,Pt.L.spacingVerticalM,Pt.L.spacingVerticalM)},cardHeader:{},cardFooter:{},cardSourceLabel:{display:"flex",flexDirection:"row",width:"100%",height:Pt.L.lineHeightBase300,marginBottom:Pt.L.spacingVerticalM,color:Pt.L.colorNeutralForeground4,"& label":{fontSize:Pt.L.fontSizeBase100,marginLeft:Pt.L.spacingVerticalXS,height:Pt.L.lineHeightBase100}}},$p=(0,mt.n)(Xp),eg=({text:e})=>{const t=$p(),n=(0,Bt.z)(t?.cardFooter,t?.footerBar);return e?N.createElement("div",{className:n},N.createElement("span",null,e)):null},tg=({text:e})=>{const t=$p(),n=(0,Bt.z)(t?.cardHeader,t.headerBar);return e?N.createElement("div",{className:n},N.createElement("span",null,e)):null};var ng=n(59721);const rg=({text:e,iconName:t})=>{const n=$p();return e||t?N.createElement(ht.W,{style:n.cardSourceLabel},t&&N.createElement(ng.l8,{iconName:t}),e&&N.createElement("label",null,e)):null};class sg extends mp{static isTelemetryEnabled(e){return e instanceof sg||void 0!==e.executeWithTelemetry}}Qp.onProcessMarkdown=(e,t)=>{t.outputHtml=(new(Kp())).render(e),t.didProcess=!0};const ig=({styles:e,body:t,telemetryData:n=""})=>{const{customActions:r,cardData:s,headerText:i,footerText:a,sourceLabel:o,decorativeBorder:l=!0}=t,c=(0,Bt.z)(e?.adaptiveCardWrapper,l?e?.decorativeBorder:null);return N.createElement(ht.W,{style:e?.cardRoot},N.createElement(tg,{text:i}),N.createElement("div",{className:c},N.createElement(rg,{text:o?.text,iconName:o?.iconName}),N.createElement(ag,{element:og(s,r,n)})),N.createElement(eg,{text:a}))},ag=({element:e})=>{const t=(0,N.useRef)();return(0,N.useEffect)((()=>(e&&t.current&&t.current.appendChild(e),()=>{e&&t.current&&t.current.removeChild(e)})),[e]),N.createElement("span",{ref:t})},og=(e,t,n)=>{let r=new bh;Ch.populateWithDefaultActions(r);for(let e in t)r.register(e,t[e]);let s=new Zp;s.setActionRegistry(r);const i=new Qp;return i.hostConfig=new uh({spacing:{default:"12",padding:"0"},containerStyles:{default:{foregroundColors:{default:{default:Pt.L.colorNeutralForeground1}}},emphasis:{foregroundColors:{default:{default:Pt.L.colorNeutralForeground1}}},accent:{foregroundColors:{default:{default:Pt.L.colorNeutralForeground1}}},warning:{foregroundColors:{default:{default:Pt.L.colorNeutralForeground1}}}}}),i.parse(e,s),i.onExecuteAction=e=>{try{sg.isTelemetryEnabled(e)&&e.executeWithTelemetry(n)}catch(e){}},i.render()},lg=({styles:e,body:t,sketchImageProps:n})=>{const r=(0,Bt.z)(e.text,e.rootStack),[s,i]=N.useState(0);return N.createElement(ht.W,{style:r},t.sketchImageData&&t.sketchImageData.map(((n,r)=>N.createElement(at._,{src:n.imageSrc,key:r,alt:n.altText,className:e.image,shape:"rounded",onClick:()=>{(e=>{i(e)})(r)},shadow:s===r&&t.sketchImageData.length>1,"aria-selected":s===r,tabIndex:0}))),t.messageText&&N.createElement(Fn.E,{block:!0,className:(0,Bt.z)(e.text,e.richTextRoot)},t.messageText),N.createElement(ht.W,{horizontal:!0},t.isInsertionEnabled&&n&&n.imageInsertionHandler&&N.createElement(ct.$,{size:"small",onClick:()=>{const e=t.sketchImageData[s];n?.imageInsertionHandler?.(e)},icon:N.createElement(Er.rz9,null),tabIndex:0},"Insert")))},cg={rootStack:{textAlign:"start",textOverflow:"clip","& ul":{paddingLeft:"15px"},"& li":{whiteSpace:"pre-wrap",marginLeft:"10px"}},richTextRoot:{whiteSpace:"pre-wrap",flexWrap:"wrap"},image:{width:"100%",height:"100%",maxWidth:"200px",maxHeight:"200px",paddingBottom:"6px"},...(0,Ka.mO)()},ug=(0,mt.n)(cg),dg={slideLinksListItemText:ut.VvY,slideLinksMessage1Option1:ut.pL5,slideLinksMessage1Option2:ut.KJM,slideLinksMessage2Part1:ut.YX2,slideLinksMessage2Part2:ut.dGi},hg=({styles:e,body:t})=>{const n=t.slideIndices,r=n.length<=5,s=(0,it.kQ)(dg);return N.createElement(ht.W,{style:e.rootStack},N.createElement("div",{className:e.container},N.createElement(Fn.E,{className:e.headerMessage},t.aIExplanationMessage," ",r?s.slideLinksMessage1Option1():s.slideLinksMessage1Option2()),r&&N.createElement("ul",null,n.map((n=>N.createElement("li",{className:e.listItem,key:n}," ",N.createElement("a",{role:"button",tabIndex:0,onClick:()=>t.handleSlideLinkClicked(Number(n))},s.slideLinksListItemText().replace("{0}",n)))))),N.createElement(Fn.E,{className:e.footerMessage},s.slideLinksMessage2Part1(),N.createElement("strong",null,s.slideLinksMessage2Part2()))))},pg=(0,pt.Q)(ft.tR),gg={rootStack:{...gt.Pt.gap("4px")},container:{display:"flex",flexDirection:"column"},listItem:{color:pg.themeMedium,cursor:"pointer",...gt.Pt.textDecoration("underline")},headerMessage:{marginTop:"15px"},footerMessage:{marginTop:"10px"},...(0,Ka.mO)()},mg={rootStack:{gap:Pt.L.spacingVerticalXS},container:{display:"flex",flexDirection:"column"},listItem:{color:Pt.L.colorNeutralForeground2,cursor:"pointer",...gt.Pt.textDecoration("underline")},headerMessage:{marginTop:"15px"},footerMessage:{marginTop:Pt.L.spacingVerticalMNudge},...(0,zl.r)()},fg=(0,l.kF)()?mg:gg,yg=(0,mt.n)(fg);var vg=n(4831);Qp.onProcessMarkdown=(e,t)=>{t.outputHtml=(new(Kp())).render(e),t.didProcess=!0};const bg=({cardData:e})=>{const t=new Qp;t.hostConfig=new uh({spacing:{padding:"0px"},containerStyles:{default:{foregroundColors:{default:{default:Ja.black}}}}}),t.parse(e);const n=t.render();return N.createElement(Cg,{element:n})},Cg=({element:e})=>{const t=(0,N.useRef)();return(0,N.useEffect)((()=>(e&&t.current&&t.current.appendChild(e),()=>{e&&t.current&&t.current.removeChild(e)})),[e]),N.createElement("span",{ref:t})},wg=({styles:e,body:t,strikeThroughText:n,references:r=[],telemetryData:s=""})=>{const i=(0,N.useRef)(null),{basin:a,uniqueId:o,accessPath:l,value:c}=t;(0,N.useEffect)((()=>{i.current?.scrollIntoView({behavior:"smooth",block:"end"})}),[c]);let u=e.adaptiveCardRoot;if(n&&(u=(0,Bt.z)(e.adaptiveCardRoot,e.strikeThroughText)),a.items&&o&&l){const t=(0,vg.A)(a.items[o],l,null);let n=[];if(r.length>0&&(n=(0,dt.vS)(t,r)),0===n.length&&t)return N.createElement(ht.W,{style:u},N.createElement(bg,{cardData:t}),N.createElement("span",{ref:i}));if(t&&n.length>0)return N.createElement(ht.W,{style:u},n.map(((t,n)=>N.createElement("span",{key:n,className:e.markdownRoot},N.createElement(bg,{cardData:t.adaptiveCard})," ",t.references.map(((e,t)=>N.createElement(_l.A,{...e,key:t,telemetryData:s})))))),N.createElement("span",{ref:i}))}return null};var Sg=n(51395),Eg=n(71830);var xg=n(58651);const Ig=e=>{const t=(e=>{const t=(0,it.kQ)({handoffBookendingWordNounText:Eg.Aj,handoffBookendingExcelNounText:Eg.TD,handoffBookendingPowerpointNounText:Eg.$d,handoffBookendingOutlookEmailNounText:Eg.$3,handoffBookendingOutlookMeetingNounText:Eg.Id,handoffBookendingTeamsNounText:Eg.QJ,handoffBookendingTeamsAppName:Eg.XP,handoffBookendingOutlookAppName:Eg.Us,handoffBookendingWordAppName:Eg.x6,handoffBookendingExcelAppName:Eg.EU,handoffBookendingPowerpointAppName:Eg.Ig,handoffBookendingCopilotLabAppName:Eg.Eh,handoffBookendingBingChatAppName:Eg.ZU,handoffBookendingBizChatAppName:Eg.Iw,handoffBookendingTestingAppName:Eg.Bf,handoffBookendingLoopAppName:Eg.Fx,handoffBookendingLoopNounText:Eg.y7,handoffBookendingFormsAppName:Eg.m1,handoffBookendingFormsNounText:Eg.hk,handoffBookendingOneNoteAppName:Eg.VB,handoffBookendingOneNoteNounText:Eg.uv}),n=(0,it.mY)({handoffBookendingOpenDraftFromMessageText:Eg.K9,handoffBookendingOpenDraftInMessageText:Eg.Py,handoffBookendingCreateDraftInMessageText:Eg.rY,handoffBookendingCreateDraftFromMessageText:Eg._7,handoffBookendingAddDraftFromMessageText:Eg.hd,handoffBookendingAddDraftInMessageText:Eg.wc,handoffIndefiniteArticleTextA:Eg.wu,handoffIndefiniteArticleTextAn:Eg.Eb}),r=e=>0===e.length?"":["a","e","i","o","u"].includes(e[0].toLowerCase())?n.handoffIndefiniteArticleTextAn({AppNounText:e}):n.handoffIndefiniteArticleTextA({AppNounText:e}),s={word:{AppName:t.handoffBookendingWordAppName(),AppNoun:t.handoffBookendingWordNounText()},excel:{AppName:t.handoffBookendingExcelAppName(),AppNoun:t.handoffBookendingExcelNounText()},powerpoint:{AppName:t.handoffBookendingPowerpointAppName(),AppNoun:t.handoffBookendingPowerpointNounText()},outlook:{AppName:t.handoffBookendingOutlookAppName(),AppNoun:t.handoffBookendingOutlookEmailNounText()},teams:{AppName:t.handoffBookendingTeamsAppName(),AppNoun:t.handoffBookendingTeamsNounText()},forms:{AppName:t.handoffBookendingFormsAppName(),AppNoun:t.handoffBookendingFormsNounText()},loop:{AppName:t.handoffBookendingLoopAppName(),AppNoun:t.handoffBookendingLoopNounText()},onenote:{AppName:t.handoffBookendingOneNoteAppName(),AppNoun:t.handoffBookendingOneNoteNounText()},copilotlab:{AppName:t.handoffBookendingCopilotLabAppName()},bingchat:{AppName:t.handoffBookendingBingChatAppName()},bizchat:{AppName:t.handoffBookendingBizChatAppName()},testing:{AppName:t.handoffBookendingTestingAppName()}},{bookendingType:i,actionType:a,sourceDocAppName:o,destinationDocAppName:l}=e,c=s[o.toLowerCase()],u=s[l.toLowerCase()],d={AppNounText:(null==u?void 0:u.AppNoun)||"",AppName:(null==u?void 0:u.AppName)||""},h={AppNounText:(null==u?void 0:u.AppNoun)||"",AppName:(null==c?void 0:c.AppName)||""};"Opened"!==a&&"Added"!==a||(d.AppNounText=r(d.AppNounText),h.AppNounText=r(h.AppNounText));let p="";if("Opening"===i)switch(a){case"Opened":p=n.handoffBookendingOpenDraftInMessageText(d);break;case"Created":p=n.handoffBookendingCreateDraftInMessageText(d);break;case"Added":p=n.handoffBookendingAddDraftInMessageText(d)}else switch(a){case"Opened":p=n.handoffBookendingOpenDraftFromMessageText(h);break;case"Created":p=n.handoffBookendingCreateDraftFromMessageText(h);break;case"Added":p=n.handoffBookendingAddDraftFromMessageText(h)}return p})(e);return{bookendingIcon:N.createElement(Sg.qVy,null),bookendingMessageText:t,bookendingLinkText:"",bookendingLinkOnClick:()=>{xg.log("Handoff Link Clicked")}}};var Ag;!function(e){e.Rendered="Rendered",e.ViewPromptsRendered="ViewPromptsRendered",e.TryNowClicked="TryNowClicked",e.SamplePromptSelected="SamplePromptSelected"}(Ag||(Ag={}));var Pg=n(98637),kg=n(51252),Tg=n(98549),Dg=n(52036);function Mg(e,t){return Pg._.apply(void 0,(0,y.__spreadArray)([function(n){var r=e[n];return(Array.isArray(r)?r:[r]).concat(t[n])}],(0,kg.H)(e),!1))}var Lg={};var Rg=n(66878);const Ng=function(e){return(0,Dg.J9)((function(t){return void 0===t&&(t=Lg),(0,Tg.l8)(Mg(e,t))}))}({icon:{display:"inline-flex",selectors:{[`&:hover .${Rg.$C}`]:{display:"none"},[`&:hover .${Rg.ru}`]:{display:"inline"}}}}),Og=e=>{const t=({className:t,...n})=>{const r=Ng();return N.createElement("span",{className:`${t||""} ${r.icon}`},N.createElement(e,{...n}))};return t.displayName=e.displayName,t},_g=Og((0,Un.A)(Er.vHD,Er.L4_));var Bg=n(61939),Fg=n(98054),Ug=function(){return Ug=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},Ug.apply(this,arguments)};function Hg(e){return N.createElement(Fg.b,Ug({resolveString:function(e,t){return e(t)}},e))}var zg=n(60412),jg=n(17987),Vg=n(29825),qg=n(63397),Wg=n(14979);const Qg=(0,mt.n)({systemMessageContainer:{display:"flex",flexDirection:"row",alignItems:"center"},systemMessageResponsiveContainer:{display:"flex",flexDirection:"row",alignItems:"center",columnGap:"5px"},systemMessageOnOffText:{display:"flex",flexDirection:"row",columnGap:"5px",marginRight:"5px",marginLeft:"5px",alignItems:"center"},label:{paddingBottom:"0px"},appIconContainer:{display:"flex",float:"left",flexDirection:"row",alignItems:"center"},appIcon:{height:"20px",width:"20px"},tryNowButton:{textDecorationLine:"underline",display:"flex"},tryNowResponsiveButton:{textDecorationLine:"underline",display:"inline"},popoverSurface:Object.assign(Object.assign(Object.assign({},gt.Pt.overflow("0px","0px")),gt.Pt.padding("0px")),gt.Pt.borderRadius("8px"))}),Gg=Og((0,Un.A)(Er.Ozq,Er._Jm)),Zg=(0,mt.n)({outerWrapper:Object.assign(Object.assign({display:"flex",flexDirection:"column",rowGap:"12px",alignItems:"flex-start"},gt.Pt.margin("16px")),{maxWidth:"400px"}),contentHeader:{display:"flex",paddingBottom:"0px"},innerWrapper:Object.assign(Object.assign({alignItems:"center",justifyContent:"flex-start",columnGap:"8px",display:"flex"},gt.Pt.margin("0px")),{flexDirection:"row"}),appIcon:{width:"16px",height:"16px",float:"left"}}),Yg=({appName:e,popoverAppIcon:t,selectedPromptCallback:n,samplePrompts:r,disableSamplePrompts:s})=>{const i=Zg(),a=N.useRef(null);N.useEffect((()=>{a.current&&a.current&&a.current.focus()}),[a]);const o=t?N.createElement(at._,{src:t,className:i.appIcon,alt:e}):N.createElement(Gg,null);return N.createElement("div",{className:i.outerWrapper},N.createElement("div",{className:i.innerWrapper},o,N.createElement(kc.Z,{className:i.contentHeader},e)),r.map(((e,t)=>N.createElement(Sr.V,{ref:0===t?a:void 0,key:t,disabled:s,onClick:()=>{n(e,t)}},e))))},Kg=(0,zo.qP)("scc-react-system-message.appNameWithMessage"),Jg=(0,zo.Ex)("scc-react-system-message.GoToSettingsText"),Xg=e=>{var{isPopoverOpen:t,handlePopoverOpenChange:n,appName:r,appId:s,appIcon:i,isRenderPopover:a,message:o,buttonText:l,onClickAction:c,onClickSettings:u,isResponsiveMode:d,customPopoverContent:h,hideIcon:p}=e,g=(0,y.__rest)(e,["isPopoverOpen","handlePopoverOpenChange","appName","appId","appIcon","isRenderPopover","message","buttonText","onClickAction","onClickSettings","isResponsiveMode","customPopoverContent","hideIcon"]);const m=Qg(),f=(0,zg.X)(),{findFirstFocusable:v}=(0,jg.r)(),b=(0,it.mY)({appNameWithMessage:Kg}),C=(0,it.Lh)(Jg),w=!a&&c,S=!a&&u,E=N.useRef(null),x=N.useRef(null),I=N.createElement(Hg,{text:b.appNameWithMessage,placeholders:{appName:N.createElement(kc.Z,{className:m.label},null!=r?r:""),message:N.createElement(nr.M,{className:m.label},o)}}),A=d?N.createElement("span",null,I):N.createElement("div",{className:m.systemMessageOnOffText},I),P=N.createElement(N.Fragment,null,A,a&&N.createElement(Vg.A,{withArrow:!0,open:t,onOpenChange:(e,t)=>{n(t.open||!1),!1===t.open&&setTimeout((()=>{x.current&&x.current.focus()}),200)},trapFocus:!0,closeOnScroll:!0},N.createElement(qg.W,{disableButtonEnhancement:!0},N.createElement(wi.N,Object.assign({ref:x},f,{className:m.tryNowButton,as:"button",onKeyDown:e=>{"Escape"===e.key&&setTimeout((()=>{if(E.current){const e=v(E.current);e&&e.focus()}}),200)}}),N.createElement(nr.M,null,l))),N.createElement(Wg.H,{className:m.popoverSurface},null!=h?h:N.createElement(Yg,Object.assign({appName:r},g)))),w&&N.createElement(wi.N,{className:d?m.tryNowResponsiveButton:m.tryNowButton,as:d?"span":"button",onClick:c},N.createElement(nr.M,null,l)),S&&N.createElement(wi.N,{className:m.tryNowButton,as:"button",onClick:()=>u(s)},N.createElement(nr.M,null,C)));return N.createElement(Bg.t,{icon:null,ref:E,style:{maxWidth:"100%"}},N.createElement("div",{className:d?m.systemMessageResponsiveContainer:m.systemMessageContainer},!p&&N.createElement("div",{className:m.appIconContainer,"aria-labelledby":s,role:"group"},"string"==typeof i?N.createElement(at._,{className:m.appIcon,src:i}):i||N.createElement(_g,null)),d?N.createElement("div",null,P):P))},$g=e=>{var{appId:t,appName:n,samplePrompts:r,setSystemMessagePrompt:s,state:i,telemetryService:a,onClickAction:o,onClickSettings:l,isRenderPopover:c}=e,u=(0,y.__rest)(e,["appId","appName","samplePrompts","setSystemMessagePrompt","state","telemetryService","onClickAction","onClickSettings","isRenderPopover"]);const[d,h]=N.useState(!1);N.useEffect((()=>{null==a||a.logEvent({detail:Ag.Rendered,state:i})}),[]),N.useEffect((()=>{c&&(null==a||a.logEvent({detail:Ag.ViewPromptsRendered,state:i}))}),[c]);const p=N.useCallback(((e,n)=>{s(e,n,t),h(!1)}),[s,h,t]);return N.createElement(Xg,Object.assign({appId:t,appName:n,samplePrompts:r,isPopoverOpen:d,handlePopoverOpenChange:e=>{h(e),!0===e&&(null==a||a.logEvent({detail:Ag.TryNowClicked,state:i}))},selectedPromptCallback:p,onClickAction:o,onClickSettings:l,isRenderPopover:c},u))},em={systemMessageRoot:{...gt.Pt.padding("4px","0px")}},tm=(0,mt.n)(em),nm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.PluginEnabledText"),rm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.PluginEnabledTextUpdated"),sm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.PluginDisabledText"),im=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.PluginDisabledTextUpdated"),am=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.PluginTryText"),om=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.PluginTryTextUpdated"),lm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.PluginEnabledScoped"),cm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.PluginDisabledScoped"),um=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.PluginUnscoped"),dm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.DCScoped"),hm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.DCUnscoped"),pm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.DCScopedUpdated"),gm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.DCUnscopedUpdated"),mm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.VoiceConversationEnded"),fm=(0,zo.Ex)("officeaicopilot-ui.copilotUiStrings.VoiceConversationStarted");var ym=n(89843),vm=n(97691),bm=n(82435),Cm=n(20732);const wm=(0,mt.n)({feedbackPopoverRoot:{display:"flex",flexDirection:"column",padding:"16px",zIndex:"auto"},feedbackFooter:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:"5px",zIndex:"auto"}});var Sm;!function(e){e[e.LIKE=0]="LIKE",e[e.DISLIKE=1]="DISLIKE"}(Sm||(Sm={}));const Em=({feedbackData:e,feedbackProps:t})=>{const{sendFeedback:n}=(0,bs.fP)(),r={feedbackArea:"",contextData:{},invocationTimestamp:Date.now()},s=t=>{n(Sm.LIKE,e??r,t)},i=t=>{n(Sm.DISLIKE,e??r,t)};t&&(t.feedbackClickedCallback=e=>{(e===bm.MW.Frown?i:s).call(void 0)});const a=t?(0,vm.A)(t):(0,ym.J)({handleThumbsUpClick:s,handleThumbsDownClick:i}),o=wm();return N.createElement("div",{className:o.feedbackPopoverRoot},N.createElement(Cm.Q,null,"Was this conversation helpful?"),N.createElement(lt.c,null,"Share feedback to improve future interactions."),N.createElement("div",{className:o.feedbackFooter},N.createElement(en.$,null,"AI-generated content may be incorrect"),a))};const xm=({body:e,onClickAction:t,feedbackData:n,feedbackProps:r})=>{const s=((e,t,n)=>{const{useResponsiveSystemMessage:r}=(0,Ot.Y$)(),s=(0,it.kQ)({pluginEnabledText:nm,pluginDisabledText:sm,pluginTryText:am,enabledPluginMentionedText:lm,disabledPluginMentionedText:cm,pluginRemovedFromBannerText:um,DCMentionedText:dm,DCRemovedFromBannerText:hm,DCMentionedTextUpdated:pm,DCRemovedFromBannerTextUpdated:gm,pluginEnabledTextUpdated:rm,pluginDisabledTextUpdated:im,pluginTryTextUpdated:om,VoiceConversationStarted:fm,VoiceConversationEnded:mm});if("CustomSystemMessage"===e&&null!=n)return n;if(r)switch(e){case"PluginToggle":return t?s.pluginEnabledTextUpdated():s.pluginDisabledTextUpdated();case"PluginMention":return t?s.enabledPluginMentionedText():s.disabledPluginMentionedText();case"PluginRemovedFromBanner":return s.pluginRemovedFromBannerText();case"DCMention":return s.DCMentionedTextUpdated();case"DCRemovedFromBanner":return s.DCRemovedFromBannerTextUpdated();case"RealtimeVoiceSessionStart":return s.VoiceConversationStarted()??"started";case"RealtimeVoiceFeedback":return s.VoiceConversationEnded();default:return""}switch(e){case"PluginToggle":return t?s.pluginEnabledText():s.pluginDisabledText();case"PluginMention":return t?s.enabledPluginMentionedText():s.disabledPluginMentionedText();case"PluginRemovedFromBanner":return s.pluginRemovedFromBannerText();case"DCMention":return s.DCMentionedText();case"DCRemovedFromBanner":return s.DCRemovedFromBannerText();case"RealtimeVoiceSessionStart":return s.VoiceConversationStarted()??"started";case"RealtimeVoiceFeedback":return s.VoiceConversationEnded();default:return""}})(e.scenario,e.isEnabled,e.customMessage),{useResponsiveSystemMessage:i}=(0,Ot.Y$)(),a={appId:e.pluginAppId,appName:e.pluginAppName,appIcon:e.pluginAppIcon,samplePrompts:e.samplePrompts,isEnabled:e.isEnabled,isRenderPopover:e.isEnabled&&e.samplePrompts.length>0,message:s,buttonText:e.buttonText??"",onClickAction:t&&e.buttonText&&e.showActionLink?t:void 0,disableSamplePrompts:!0,setSystemMessagePrompt:e=>{},isResponsiveMode:i,hideIcon:e.hideIcon};if("RealtimeVoiceFeedback"===e.scenario){const e={feedbackData:n,feedbackProps:r};a.customPopoverContent=N.createElement(Em,{...e}),a.isRenderPopover=!0,a.appIcon=N.createElement(cs.C9Q,null)}else if("RealtimeVoiceSessionStart"===e.scenario)a.appIcon=N.createElement(cs.C9Q,null);else if("Handoff"===e.scenario){if(!e.handoffSystemMessageExtendedProps)throw new Error("Handoff: Render bookending system message extended props is missing");const t=e.handoffSystemMessageExtendedProps,n={sourceDocAppName:e.pluginAppName,destinationDocAppName:t.handoffDestinationAppName,bookendingType:t.handoffBookendingType,actionType:t.handoffActionType},r=Ig(n);a.appName="",a.appIcon=r.bookendingIcon,a.message=r.bookendingMessageText,a.buttonText=r.bookendingLinkText,a.onClickAction=r.bookendingLinkOnClick}const o=tm();return N.createElement("div",{className:o.systemMessageRoot},N.createElement($g,{...a}))},Im=({styles:e,body:t,warningActionButtons:n=[]})=>N.createElement(ht.W,{style:e.warningMessageRootStack},N.createElement(Fn.E,{tabIndex:-1},t.warningPrefix,t.warningEmphasizedText&&N.createElement("span",{className:e.warningMessageBoldText},t.warningEmphasizedText),t.warningSuffix),n&&n.length>0&&n.map(((t,n)=>N.createElement(ct.$,{key:n,className:e.warningActionButton,"aria-label":t.buttonTitle,onClick:t.handleButtonOnClick,disabled:t.isDisabled},t.buttonText)))),Am={warningMessageRootStack:{alignItems:"center",gap:Pt.L.spacingVerticalXS},warningMessageBoldText:{...kt.g.body1Stronger},warningActionButton:{width:"100%",height:"28px",backgroundColor:Pt.L.colorNeutralBackground1,...gt.Pt.border("1px","solid",Pt.L.colorNeutralStroke1),borderRadius:Pt.L.borderRadiusMedium,...gt.Pt.padding("0px","0px","4px","0px"),...kt.g.body1},...(0,zl.r)()},Pm=(0,mt.n)(Am),km=(0,pt.Q)(ft.tR),Tm={warningMessageRootStack:{alignItems:"center",...gt.Pt.gap("4px")},warningMessageBoldText:{...kt.g.body1Stronger},warningActionButton:{width:"100%",height:"28px",backgroundColor:km.neutralLight,...gt.Pt.border("1px","solid",km.neutralLighterAlt),...gt.Pt.borderRadius(km.borderRadiusMedium),...gt.Pt.padding("0px","0px","4px","0px"),...kt.g.body1},...(0,Ka.mO)()},Dm=(0,mt.n)(Tm),Mm=({chatMessage:e,chatCardIndex:t,shouldShowFeedbackButtons:n,shouldSupportCitationsInAvalon:r,handleChatCardThumbsDownClick:o,handleChatCardThumbsUpClick:c,handleChatCardSendFeedbackClick:u,customMessageRenderers:d,useFluentAIGeneratedIndicator:h,handleHVCPillClick:p,sketchImageProps:g,onSystemMessageClickAction:m,copilotThemeInfo:f,sccTelemetryLogger:y,shouldShowSideQuestUI:v})=>{const b=$a(),C=(0,Ka.dQ)(),w=ja(),S=Gl(),E=(()=>{const e=tc(),t=Xl();(0,i.xp)()===s.Y.IOS&&(0,dt.bt)(e,t);return e})(),x=(0,sc.bM)(),I=dc(),A=mc(),P=wc(),k=Su(),T=$p(),D=yg(),M=(()=>{const e=Dm(),t=Pm();return(0,l.kF)()?t:e})(),L=(0,el.lc)(),R=(0,Nl.XU)(),O=(0,Ot.Y$)(),_=O?.isChatCardRendererMemoizationEnabled?fo:mo,B=O.isFeatureRegistryCardRenderingEnabled,{overrideChatCardRenderer:F}=N.useContext(Ia),{message:U,cardRenderer:H}=F(e),z=B?U:e,{messageType:j,body:V,styles:q}=z,W={handleThumbsDownClick:o,handleThumbsUpClick:c,handleSendFeedbackClick:u,shouldShowFeedbackButtons:n,shouldSupportCitationsInAvalon:r,shouldShowProgressSpinner:z.shouldShowProgressSpinner,chatCardIndex:t,feedbackSectionPosition:z.feedbackSectionPosition,feedbackCategory:z.feedbackCategory,shouldShowAIGeneratedIndicator:z.shouldShowAIGeneratedIndicator,shouldShowAIPoweredIndicator:z.shouldShowAIPoweredIndicator,useFluentAIGeneratedIndicator:h,actionBarButtons:z.actionBarButtons,actionBarHeaderProps:z.actionBarHeaderProps,feedbackData:z.feedbackData,showAnimation:z.showAnimation,strikeThroughText:z.strikeThroughText,showMinifiedUI:z.showMinifiedUI??!1,references:z.references,annotationReferences:z.annotationReferences,pillsList:z.pillsList,handleShowMeOnClick:z.handleShowMeOnClick,warningActionButtons:z.warningActionButtons??[],clpSensitivityIndicatorData:z.clpSensitivityIndicatorData??void 0,telemetryData:z.telemetryData??"",msgExtCardProps:z.msgExtCardProps,apiPluginCardProps:z.apiPluginCardProps,confirmationCardProps:z.confirmationCardProps,pluginAuthError:z.pluginAuthError,chatMessageHeaderData:z.chatMessageHeaderData??void 0,progressSpinnerData:z.progressSpinnerData??void 0,messageAttributionProps:z.messageAttributionProps??void 0,debugInfo:z.debugInfo,outputV2Props:z.outputV2Props??void 0,readAloudActionButtonProps:z.readAloudActionButtonProps,messageId:z.messageId,isChatHistoryRehydration:z.isChatHistoryRehydration,entityAnnotations:z.entityAnnotations,isResponseStreaming:z.isResponseStreaming,overrideDirection:z.overrideDirection??void 0,shouldShowSideQuestUI:v};let Q;switch(j){case a._.Default:W.styles=(0,dt.bt)(S,q),Q=N.createElement(Zl,{body:V,handlePillOnClick:p,...W});break;case a._.PaginatedCard:W.styles=(0,dt.bt)(I,q),Q=N.createElement(lc,{body:V,...W});break;case a._.AccordionCard:Q=N.createElement(Ya,{styles:q,body:V,...W});break;case a._.ContentCard:W.styles=(0,dt.bt)(w,q),Q=N.createElement(qa,{body:V,...W});break;case a._.ChatCardWrapper:W.styles=(0,dt.bt)(C,q),V.renderData&&W.isChatHistoryRehydration&&(V.renderData.props.isChatHistoryRehydration=W.isChatHistoryRehydration),Q=N.createElement(_,{renderData:V.renderData,fallbackElement:V.element,customMessageRenderers:d,copilotThemeInfo:f});break;case a._.FeedbackNudge:W.styles=(0,dt.bt)(E,q),Q=N.createElement(Kl,{body:V,...W});break;case a._.MarkdownCard:W.styles=(0,dt.bt)(x,q),Q=N.createElement(rc.A,{body:V,sccTelemetryLogger:y,...W});break;case a._.SelfHelpAdaptiveCard:W.styles=(0,dt.bt)(T,q),Q=N.createElement(ig,{body:V,...W});break;case a._.StreamingAdaptiveCard:W.styles=(0,dt.bt)(b,q),Q=N.createElement(wg,{body:V,...W});break;case a._.WarningMessage:W.styles=(0,dt.bt)(M,q),Q=N.createElement(Im,{body:V,...W});break;case a._.ProactiveSuggestionCard:W.styles=(0,dt.bt)(P,q),Q=N.createElement(vc,{body:V,...W});break;case a._.SlideLinksCard:W.styles=(0,dt.bt)(D,q),Q=N.createElement(hg,{body:V,...W});break;case a._.CopilotWorkflowMessage:return N.createElement(Aa.m,{launchText:V.launchText,buttonText:V.buttonText,onLaunch:V.onLaunch});case a._.ReviewerSummaryCard:W.styles=(0,dt.bt)(k,q),Q=N.createElement(bu,{body:V,...W});break;case a._.ReviewAgentCard:W.styles=(0,dt.bt)({},q),Q=N.createElement(mu,{body:V,...W});break;case a._.AgentPlanBuilderCard:W.styles=(0,dt.bt)({},q),Q=N.createElement(go,{body:V,...W});break;case a._.PlanBuilderCard:W.styles=(0,dt.bt)({},q),Q=N.createElement(Ll,{body:V,...W,finalButtonText:R});break;case a._.SystemMessage:return N.createElement(xm,{body:V,onClickAction:()=>{m?.(V.pluginAppId)},feedbackData:W.feedbackData,feedbackProps:e.feedbackProps});case a._.SketchImageCard:W.styles=(0,dt.bt)(ug(),q),Q=N.createElement(lg,{body:V,sketchImageProps:g,...W});break;case a._.InterstitialMessage:W.styles=(0,dt.bt)({},q);const t=V;Q=O.isMultipleConfirmationDialogFlowEnabled?N.createElement(nc,{interstitialMessages:t.interstitialMessages}):L?.renderSkill(t.interstitialMessages);break;case a._.PostEditCard:W.styles=(0,dt.bt)(A,q),Q=N.createElement(pc,{body:V,...W});break;case a._.HiddenCard:return null;default:Q=null}return B&&H&&(Q=H),N.createElement(Pl,{body:{user:V?.user,element:Q},...W})},Lm=N.memo(Mm,((e,t)=>{if(e.chatMessage.messageType===a._.ChatCardWrapper&&t.chatMessage.messageType===a._.ChatCardWrapper){const n=e.chatMessage.body.renderData?.shouldMemoizeComponent??t.chatMessage.body.renderData?.shouldMemoizeComponent,r=e.chatMessage.body.renderData?.props,s=t.chatMessage.body.renderData?.props;return e.copilotThemeInfo?.isDarkTheme===t.copilotThemeInfo?.isDarkTheme&&e.copilotThemeInfo?.isHighContrast===t.copilotThemeInfo?.isHighContrast&&(!!n&&r===s)}return!1})),Rm=(0,pt.Q)(ft.tR),Nm={root:{paddingTop:"5px",backgroundColor:"transparent",marginBottom:"5px",marginTop:"auto"},elementStack:{verticalAlign:"end",...gt.Pt.gap("10px")},chatCardsStack:{verticalAlign:"end",...gt.Pt.padding("0px","0px","5px"),...gt.Pt.gap("10px")}},Om=(Rm.themeDarkAlt,Rm.themeLighterAlt,Rm.themeLighter,Rm.themeDarkAltTransparent,Rm.themeLighterAltTransparent,Rm.themeLighterTransparent,(0,mt.n)(Nm)),_m=({children:e,chatLog:t,styles:n,elementsBeforeChatLog:r,shouldShowFeedbackButtons:s=!0,shouldSupportCitationsInAvalon:i=!1,handleChatCardThumbsDownClick:a,handleChatCardThumbsUpClick:o,handleChatCardSendFeedbackClick:l,customMessageRenderers:c,useFluentAIGeneratedIndicator:u,handleHVCPillClick:d,copilotThemeInfo:h,sketchImageProps:p,onSystemMessageClickAction:g,sccTelemetryLogger:m,shouldShowSideQuestUI:f=!1})=>{const y=(0,it.Lh)(ut.mcd),v=(0,Ot.Y$)(),b=Om(),C=(0,dt.bt)(b,n),w=v.isChatCardFactoryMemoizationEnabled?Lm:Mm,{handleOpenSafeLink:S}=(0,xa.V)();N.useEffect((()=>{S&&v?.isSafeLinksEnabled&&el.Qk.setHandler(S)}),[S,v?.isSafeLinksEnabled]);return N.createElement(ht.W,{style:C.root,reverse:!0},N.createElement(ht.W,{style:C.elementStack},r,N.createElement(ht.W,{style:C.chatCardsStack,customProperties:{id:Nl.dK,role:dt.eg.LIST,"aria-label":y,"aria-setsize":t.length}},t.map(((e,t)=>N.createElement(w,{key:t,chatCardIndex:t,chatMessage:e,useFluentAIGeneratedIndicator:u,shouldShowFeedbackButtons:s,shouldSupportCitationsInAvalon:i,handleChatCardThumbsDownClick:a,handleChatCardThumbsUpClick:o,handleChatCardSendFeedbackClick:l,handleHVCPillClick:d,customMessageRenderers:c,copilotThemeInfo:h,sketchImageProps:p,onSystemMessageClickAction:g,sccTelemetryLogger:m,shouldShowSideQuestUI:f})))),e))},Bm=(0,pt.Q)(ft.zQ),Fm={root:{...gt.Pt.padding("10px"),...gt.Pt.margin(Bm.spacingVerticalNone,Bm.spacingHorizontalNone,Bm.spacingVerticalS,Bm.spacingHorizontalS),alignContent:"center",...gt.Pt.border("0px"),width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},[`&:hover .${jn.h.icon}`]:{color:Bm.themePrimary},[`&:hover:active .${jn.h.icon}`]:{color:Bm.themePrimary}}},Um=(0,mt.n)(Fm),Hm=({buttonText:e,icon:t,onClick:n})=>N.createElement(ct.$,{appearance:"subtle",className:Um().root,icon:t,onClick:n,size:"small"},e),zm=(0,pt.Q)(ft.zQ),jm={root:{...gt.Pt.padding("10px"),...gt.Pt.margin(zm.spacingVerticalNone,zm.spacingHorizontalNone,zm.spacingVerticalS,zm.spacingHorizontalS),alignContent:"center",...gt.Pt.border("0px"),width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},[`&:hover .${jn.h.icon}`]:{color:zm.themePrimary},[`&:hover:active .${jn.h.icon}`]:{color:zm.themePrimary}}},Vm=(0,mt.n)(jm);const qm=N.memo((({handleChangeTopicButtonClick:e})=>{const t=(0,it.Lh)(ut._VK),n=Vm();return N.createElement(ct.$,{appearance:"subtle",className:n.root,icon:N.createElement(Ui.Urf,null),onClick:e,size:"small"},t)})),Wm=(0,pt.Q)(ft.zQ),Qm={root:{...gt.Pt.padding("10px"),...gt.Pt.margin(Wm.spacingVerticalNone,Wm.spacingHorizontalNone,Wm.spacingVerticalM,Wm.spacingHorizontalS),alignContent:"center",...gt.Pt.border("10px"),width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},[`&:hover .${jn.h.icon}`]:{color:Wm.themePrimary},[`&:hover:active .${jn.h.icon}`]:{color:Wm.themePrimary}}},Gm=(0,mt.n)(Qm),Zm=N.memo((({handlePythonExitAnalysisButtonClick:e})=>{const t=(0,it.Lh)(ut.tBK);return N.createElement(ct.$,{appearance:"subtle",className:Gm().root,icon:N.createElement(Er.uQe,null),onClick:e,size:"small"},t)})),Ym=(0,pt.Q)(ft.zQ),Km={root:{...gt.Pt.padding("0px"),...gt.Pt.margin(Ym.spacingVerticalNone,Ym.spacingHorizontalNone,Ym.spacingVerticalS,Ym.spacingHorizontalS),paddingBottom:"12px",minHeight:"26px",alignContent:"center",...gt.Pt.border("0px"),width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},[`&:hover .${jn.h.icon}`]:{color:Ym.themePrimary},[`&:hover:active .${jn.h.icon}`]:{color:Ym.themePrimary}}},Jm=(0,mt.n)(Km),Xm={root:{...gt.Pt.padding("0px"),...gt.Pt.margin(Pt.L.spacingVerticalNone,Pt.L.spacingHorizontalNone,Pt.L.spacingVerticalS,Pt.L.spacingHorizontalS),paddingBottom:"12px",minHeight:"26px",alignContent:"center",...gt.Pt.border("0px"),width:"fit-content",alignSelf:"center","@media (forced-colors: none)":{"&:hover":{backgroundColor:"transparent"},"&:hover:active":{backgroundColor:"transparent"}},[`&:hover .${jn.h.icon}`]:{color:Pt.L.colorBrandBackground4Static},[`&:hover:active .${jn.h.icon}`]:{color:Pt.L.colorBrandBackground4Static}}},$m=(0,mt.n)(Xm),ef=N.memo((e=>{const t=Jm(),n=$m(),r=(0,l.kF)()?n:t;return e.menuProps?N.createElement(Es.W,null,N.createElement(xs.c,{disableButtonEnhancement:!0},N.createElement(Is.I,{appearance:"subtle",className:r.root,icon:N.createElement(Er.uQe,null),size:"small"},e.buttonText)),N.createElement(As.b,null,N.createElement(Ps.c,null,e.menuProps.map((t=>N.createElement(ks.D,{key:t.key,onClick:()=>e.onClick(t)},t.text)))))):N.createElement(ct.$,{appearance:"subtle",className:r.root,icon:N.createElement(Er.uQe,null),onClick:()=>e.onClick(),size:"small"},e.buttonText)}));const tf={root:{fontFamily:"-apple-system",lineHeight:"normal"},headerText:{fontFamily:"-apple-system",lineHeight:"normal"},descriptionText:{fontFamily:"-apple-system",lineHeight:"normal"}},nf=(0,mt.n)(function(e){return{root:e.root??{},rootHighContrast:{},headerText:e.headerText??{},descriptionText:e.descriptionText??{}}}(tf)),rf=(0,pt.Q)(ft.tR),sf={root:{boxShadow:rf.shadow4,backgroundColor:rf.neutralLight,...gt.Pt.borderRadius(rf.borderRadiusXLarge),...gt.Pt.margin(rf.spacingVerticalNone,rf.spacingHorizontalL,rf.spacingVerticalXXS),...gt.Pt.padding(rf.spacingVerticalM)},rootHighContrast:{...gt.Pt.border("1px","solid",rf.neutralLighterAlt)},headerText:{fontWeight:rf.fontWeightSemibold,color:rf.themePrimary},descriptionText:{color:rf.neutralQuaternaryAlt}},af=(0,mt.n)(sf),of=(e,t)=>{if(t)for(const n in e)e[n]=(0,Bt.z)(e[n],t[n]);e.rootHighContrast=(0,Bt.z)(e.root,e.rootHighContrast)},lf={hintCardDescriptionID:ut.svN,hintCardHeaderID:ut.rGz},cf=N.memo((({overrideStyles:e,headerText:t,descriptionText:n})=>{const r=(0,l.R2)(),a=(()=>{const e=af(),t=nf();(0,i.xp)()===s.Y.IOS&&of(e,t);return e})(),o=(0,it.kQ)(lf);return of(a,e),N.createElement(ht.W,{style:r?a.rootHighContrast:a.root,customProperties:{role:dt.eg.GROUP,"aria-labelledby":o.hintCardHeaderID(),"aria-describedby":o.hintCardDescriptionID(),"aria-live":"polite"}},N.createElement(Fn.E,{id:o.hintCardHeaderID(),className:a.headerText},t),N.createElement(Fn.E,{id:o.hintCardDescriptionID(),className:a.descriptionText},n))}));var uf,df,hf=n(52723),pf=n(99387),gf=n(15365),mf=n(37319),ff=n(51973),yf=n(42449),vf=n(15398),bf=n(86377),Cf=n(46564),wf=n(13316),Sf=n(24193),Ef=n(14727),xf=n(51083),If=n(42347);!function(e){e[e.NotShown=0]="NotShown",e[e.ClaimsChallenge=1]="ClaimsChallenge",e[e.UserInteractionRequired=2]="UserInteractionRequired"}(uf||(uf={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Enabled=2]="Enabled",e[e.Disabled=3]="Disabled"}(df||(df={}));var Af=n(30211),Pf=n(98463),kf=n(57468),Tf=n(67952),Df=n(64880),Mf=n(24663),Lf=n(38276),Rf=n(85121);const Nf=class{getProps(e,t){return{headerText:t.headerText,descriptionText:t.descriptionText,freImagePath:t.freImagePath,handleFreButtonClick:()=>{e()},hideGetStartedButton:t.hideGetStartedButton,getStartedButtonText:t.getStartedButtonText}}};class Of{constructor(e){this.promptSuggestionHintCardMap=e?.promptSuggestionHintCardMap??{}}shouldShowHintCard(e){return!!this.promptSuggestionHintCardMap[e]}getProps(e){const t={headerText:Df.u1,descriptionText:Df.u1};if(this.promptSuggestionHintCardMap[e]){const n=this.promptSuggestionHintCardMap[e].descriptionTextList;t.headerText=this.promptSuggestionHintCardMap[e].headerText,t.descriptionText=n[Math.floor(Math.random()*n.length)]}return t}}var _f=n(59760);const Bf={workingOnIt:_f.Ou,gettingReady:_f.eB,finishingUp:_f.RY,workingOnRequest:_f.gE,gatheringResources:_f.js,craftingContent:_f.yz,gettingEverythingReady:_f.T1,finishingTouches:_f.vH},Ff=()=>{const e=(0,it.kQ)(Bf);return N.useMemo((()=>[e.workingOnIt(),e.gettingReady(),e.finishingUp(),e.workingOnRequest(),e.gatheringResources(),e.craftingContent(),e.gettingEverythingReady(),e.finishingTouches()]),[e])},Uf={loadingConversation:_f._f,createNewConversation:_f.aU},Hf=()=>{const e=(0,it.kQ)(Uf);return N.useMemo((()=>[e.loadingConversation(),e.createNewConversation()]),[e])};var zf=n(42542),jf=n(32356),Vf=n(37583),qf=n(99192),Wf=n(90094),Qf=n(70217);const Gf=class{constructor(e,t,n,r,s,i,a,o,l){this.isCitationsSupportEnabled=!1,this.executeSuggestionPill=(e,t)=>{if(this.chatInputRef.current?.setInputText(Df.u1),this.chatInputRef.current?.setGhostText(this.chatPlaceHolderMessage),!this.isCitationsSupportEnabled&&e in this.suggestedQnAsList)this.setSuggestionClickChatCardsFromCacheSuggestion(e,this.suggestedQnAsList[e]),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache());else if(this.isCitationsSupportEnabled&&e in this.suggestedQnAListV2){const{answer:t,citations:n}=this.suggestedQnAListV2[e];this.setSuggestionClickChatCardsFromCacheSuggestion(e,t,n),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache())}else this.handleSubmit({text:e,telemetryData:Pf.a5.SuggestionPaneSuggestionClicked,requestMetaData:t})},this.componentId=l,this.chatInputRef=e,this.handleSubmit=t,this.chatPlaceHolderMessage=n,this.setChatMessage=r,this.loggingEventHandler=zf.A.getInstance(l,a),this.suggestedQnAsList={},this.suggestedQnAListV2={},this.isCitationsSupportEnabled=i,this.setCachedSuggestionPillList=s,this.telemetryLoggerUtils=Wf.j.getInstance(this.componentId),this.featureFlags=o}setSuggestedQnAListV2(e){this.suggestedQnAListV2={},e.forEach((e=>{this.suggestedQnAListV2[e.question]={answer:e.answer,citations:e.citations}})),e.length>0&&this.telemetryLoggerUtils.logSeenEvent([],Pf.Nx,Pf.Z_.ChatQnA,Pf.rf.QAandSummaries,Pf.RX.Ask,Pf.EF.BasicChat),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache())}setSuggestedQnAList(e){if(this.isCitationsSupportEnabled)return this.setSuggestedQnAListV2(e);this.suggestedQnAsList={},e.forEach((e=>{this.suggestedQnAsList[e.question]=e.answer})),e.length>0&&this.telemetryLoggerUtils.logSeenEvent([],Pf.Nx,Pf.Z_.ChatQnA,Pf.rf.QAandSummaries,Pf.RX.Ask,Pf.EF.BasicChat),this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache())}getSuggestedQnAsList(){return this.isCitationsSupportEnabled?Object.keys(this.suggestedQnAListV2):Object.keys(this.suggestedQnAsList)}getSuggestionPillListFromCache(){let e=this.isCitationsSupportEnabled?Object.keys(this.suggestedQnAListV2):Object.keys(this.suggestedQnAsList);return e=(0,Vf.R3)(e),e.slice(0,2)}setSuggestionClickChatCardsFromCacheSuggestion(e,t,n){const r=(0,bo.A)();this.telemetryLoggerUtils.setUserQueryGuid(r),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.SuggestionPaneSuggestionClicked}]),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.QuerySubmittedByUser}]),this.setChatMessage(a._.Default,{defaultMessageProps:{user:"human",messageHeader:{text:e}}}),this.setChatMessage(a._.MarkdownCard,{markDownCardProps:{user:"chat",message:t}},{shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:o.O.Footer,isFailure:!1,actionButtonList:this.featureFlags.isOutputV2Enabled?void 0:[jf.U.getInstance(this.componentId).getCopyButton()],references:n?jf.U.getInstance(this.componentId).getMarkdownReferences(n):void 0,feedbackData:jf.U.getInstance(this.componentId).getFeedbackData(),clpSensitivityIndicatorData:jf.U.getInstance(this.componentId).getBasicChatProps()?.sensitivityIndicatorData,telemetryData:JSON.stringify({correlationId:r,featureName:Pf.Z_.ChatQnA}),shouldShowCopyButton:this.featureFlags.isOutputV2Enabled,shouldShowReadAloudButton:this.featureFlags.isOutputV2Enabled,shouldShowHandoffButton:this.featureFlags.isOutputV2Enabled}),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.CachedBasicChatResponseShown},{key:Pf.h3.IsFromCache,value:!0}]),this.telemetryLoggerUtils.logTriedEvent([],Pf.Nx,Pf.Z_.ChatQnA,Pf.rf.QAandSummaries,void 0,Pf.RX.Ask,Pf.EF.BasicChat),this.telemetryLoggerUtils.setUserQueryGuid(Df.u1)}getProps(e,t,n){return{suggestionList:e.suggestionList.length>0?e.suggestionList:t,showRefreshButton:e?.showRefreshButton,handleSuggestionPillClick:async t=>{this.loggingEventHandler.sendLoggingEventToClient(Tf.Yk.SuggestionPillClicked,{suggestionClicked:t}),(0,Qf.$w)(Df.u1),this.executeSuggestionPill(t,e?.requestMetaData?.[t]),(0,qf.cY)(t,"officeaicopilot-chat: onClickSuggestionPill")},handleRefreshButtonClick:async()=>{this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.RefreshPillsButtonClicked}]),this.getSuggestedQnAsList().length>0?(this.setCachedSuggestionPillList(this.getSuggestionPillListFromCache()),this.telemetryLoggerUtils.logSeenEvent([],Pf.Nx,Pf.Z_.ChatQnA,Pf.rf.QAandSummaries,Pf.RX.Ask,Pf.EF.BasicChat)):e?.onRefreshButtonClicked?.(),(0,qf.cY)("officeaicopilot-chat: onClickRefreshButton")},refreshButtonPosition:n}}};var Zf=n(34470);class Yf{constructor(e,t,n,r,s,i,a,o,l,c){this.getTransformFileSuggestionText=()=>{if(this.zqmProps)for(const e of this.zqmProps.promptSuggestionList)if(e.shouldLaunchCIQOnSelection)return e.suggestionText;return Df.u1},this.componentId=c,this.chatInputRef=e,this.handleSubmit=t,this.updateHintCard=n,this.isExecuting=r,e.current?.getChatEditorService&&(this.editorService=e.current?.getChatEditorService()),this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=s,this.telemetryLoggerUtils=Wf.j.getInstance(this.componentId),this.isHVCAppChatV2Enabled=i??!1,this.hvcPromptStringsList=a??[],this.isCardSpanWrappingEnabled=o??!1,this.selectedCopilotId=l??""}async handleZQMButtonClick(e){if(this.isExecuting)return;(0,Qf.$w)(Df.u1),zf.A.getInstance(this.componentId).sendLoggingEventToClient(Tf.Yk.ZQMButtonItemClicked),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMButtonClicked},{key:Pf.h3.SelectedSwitcherMenuItemId,value:this.selectedCopilotId}]);let t=e,n=Df.u1;e.endsWith(Df.Gr)&&(t=t.slice(0,-Df.Gr.length)+" ");const r=this.zqmProps.promptSuggestionList.find((t=>t.suggestionText===e));if(r?.inputAreaText&&(t=r.inputAreaText),r?.promptClickHandledByClient)return(0,qf.cY)("ZQM Prompt click handled by client"),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMClickHandledByClient},{key:Pf.h3.SelectedSwitcherMenuItemId,value:this.selectedCopilotId}]),void r?.promptClickHandledByClient?.(t,r);if(r?.shouldSubmitQueryOnClick)await this.handleSubmit({text:t,telemetryData:Pf.a5.ZQMButtonClicked,requestMetaData:r?.requestMetaData});else{if(this.updateHintCard(e),(r.shouldLaunchCIQOnSelection&&r.scopedEntity===Tf.ck.File||e===this.transformFileSuggestionText)&&(n=this.transformFilePlaceholderText),!this.editorService&&this.chatInputRef.current?.getChatEditorService&&(this.editorService=this.chatInputRef.current?.getChatEditorService()),(r.shouldLaunchCIQOnSelection&&r.scopedEntity||e===this.transformFileSuggestionText)&&this.editorService){const e=r.scopedEntity??Tf.ck.File;(0,qf.cY)("scopedEntity",e),this.editorService.setEntityScope(e),r.unSupportedEntities&&(this.editorService.setUnsupportedEntities(r.unSupportedEntities),(0,qf.cY)("UnSupportedEntites:",r.unSupportedEntities))}this.chatInputRef.current?.setInputText(t),this.chatInputRef.current?.setFocus(),(r.shouldLaunchCIQOnSelection||e===this.transformFileSuggestionText)&&this.editorService&&setTimeout((()=>this.chatInputRef.current?.updateInputText(Df.O8,Zf.v.InsertAtCursor)),1),this.chatInputRef.current?.setGhostText(n)}}getProps(e){return this.zqmProps=e,this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{headerText:this.zqmProps.headerText,promptSuggestions:this.zqmProps.promptSuggestionList.map((e=>({promptSuggestion:e.suggestionText,iconRegular:e.iconRegular,iconHover:e.iconHover,isDisabled:e.isDisabled??!1,requestMetaData:e?.requestMetaData}))),handleButtonClick:this.handleZQMButtonClick,isHVCAppChatV2Enabled:this.isHVCAppChatV2Enabled,hvcPromptStringsList:this.hvcPromptStringsList,isCardSpanWrappingEnabled:this.isCardSpanWrappingEnabled}}}const Kf=class{getTrySydneyProps(e,t,n){return{checked:e.trySydneyToggleChecked,disabled:t,onChange:e.trySydneyToggleOnChange,label:n}}getTryEnterpriseSearchProps(e,t,n){return{checked:e.tryEnterpriseSearchToggleChecked,disabled:t,onChange:e.tryEnterpriseSearchToggleOnChange,label:n}}getTryWebChatProps(e,t,n){return{checked:e,onChange:t,label:n,disabled:!1}}getTryReviewerAgentProps(e,t,n){return{checked:e.tryReviewerAgentToggleChecked,disabled:t,onChange:e.tryReviewerAgentToggleOnChange,label:n}}getFastModeReviewerAgentProps(e,t,n){return{checked:e.FastModeReviewerAgentToggleChecked,disabled:t,onChange:e.FastModeReviewerAgentToggleOnChange,label:n}}};var Jf,Xf=n(75776),$f=n(91254),ey=n(78102),ty=n(23156),ny=n(90301),ry=n(3487),sy=n(4905),iy=n(49188),ay=n(76487),oy=n(50267);!function(e){e.TriggerPlugin="TriggerPlugin"}(Jf||(Jf={}));var ly=n(24411);const cy=(e,t,n)=>({handleSubstrateResponseCallback:(0,N.useCallback)(((r=[],s,i,a)=>{s===ly.p.UserPrompts?i===ly.y.GET&&r.length>0?t(r):a&&i===ly.y.DELETE?t((e=>e.filter((e=>e.PromptId!==a)))):i===ly.y.POST&&r.length>0&&t((e=>{const t=r.filter((t=>!e.some((e=>e.PromptId===t.PromptId))));return[...e,...t]})):s===ly.p.UserActivity?(e?.isSaveSharePromptEnabled||e?.isSavePromptEnabled)&&r.forEach((e=>{n((t=>t.map((t=>(t.PromptId===e.PromptId&&(t.UserActivity.Favorite.IsFavorite=e.UserActivity.Favorite.IsFavorite,t.UserActivity.Favorite.ActivityDateTimeInUtc=e.UserActivity.Favorite.ActivityDateTimeInUtc),t)))))})):n(r)}),[])}),uy={inactiveChatBannerString:_f.aK,disableChatOnUserInteractionRequiredToSignInString:_f.X6,disableChatOnClaimsChallengeToSignInString:_f.LB,paneLoadingWarningString:_f.Fj},dy=(e,t,n,r,s,i)=>{const a=(0,it.kQ)(uy),o=(0,Ot.Y$)(),l=(0,N.useMemo)((()=>{const r=e.isFeatureGateEnabledFromClient(Af.WT.IsDisableChatInputWhenAlSessionCloseEnabled),s=o?.disableChatWhenUserInteractionRequiredCardIsShown,i=n!==uf.NotShown,l=r&&t||s&&i||!1;let c=a.paneLoadingWarningString();return l&&(c=t?a.inactiveChatBannerString():n===uf.ClaimsChallenge?a.disableChatOnClaimsChallengeToSignInString():a.disableChatOnUserInteractionRequiredToSignInString()),{isInactiveChatBannerVisible:l,chatInputBannerString:c}}),[e,t,n]);return(0,N.useEffect)((()=>{if(r(l.isInactiveChatBannerVisible),l.isInactiveChatBannerVisible){""!==s.current?.getInputText()&&s.current?.setInputText("");const e=((e,t)=>e?Pf.a5.ChatInputDisabledAndBannerShownForInActiveChatSession:t===uf.ClaimsChallenge?Pf.a5.ChatInputDisabledAndBannerShownForClaimsChallenge:Pf.a5.ChatInputDisabledAndBannerShownForUserInteractionCard)(t,n);i.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:e}])}}),[l.isInactiveChatBannerVisible,t,n]),{...l}};var hy=n(20853);const py=(0,mt.n)({headerMessageCardContainer:{marginTop:Pt.L.spacingVerticalM}});var gy=n(97624),my=n(53322),fy=n(52536);let yy=0;class vy{constructor(e,t,n,r,s,i,a,o,l,c,u,d,h,p){this.onTryAgainClicked=()=>{yy=(new Date).getTime(),(0,gy.WY)(this.isMicrophoneListening,Df.l3,this.setShouldShowMicrophonePermissionRetryDialog,this.setMicrophoneState,this.setMicrophoneListeningStatus)},this.handleMicrophoneButtonOnClick=async e=>{const t=Wf.j.getInstance();if(!this.setPaneLoadMessageIfApplicable(Af.Ku.Microphone)){e?.stopPropagation();try{this.isMicrophoneListening?(t.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.MicrophonePauseClicked}]),this.chatInputRef.current?.getGhostText()!=Df.u1&&this.chatInputRef.current?.getGhostText()!=this.chatPlaceHolderMessage&&this.chatInputRef.current?.getGhostText()?.trim()!=this.micListeningGhostText&&(this.chatInputRef.current?.setInputText(this.chatInputRef.current?.getInputText()+this.chatInputRef.current?.getGhostText()),this.chatInputRef.current?.setGhostText("")),await(0,gy.WT)(this.setMicrophoneListeningStatus),(0,qf.cY)("Microphone Paused")):(t.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.MicrophonePlayClicked}]),this.microphoneState===df.Uninitialized&&this.setMicrophoneState(df.Loading),yy=(new Date).getTime(),await fy.X.GetInstance().Resume(),this.setShouldShowMicrophonePermissionRetryDialog(!1),this.setMicrophoneListeningStatus(!this.isMicrophoneListening),this.setMicrophoneState(df.Enabled),await(0,gy.Uk)(Df.l3,this.setMicrophoneListeningStatus),(0,qf.cY)("Microphone Resumed"))}catch(e){const n=`Error occurred while fetching mic permissions - : ${e}`;return(0,qf.cY)(n),ny.Gs?.logError({eventType:kf.S2.Microphone,errorMessage:n}),"ErrorAudioPermissionDeniedError"==e&&(await fy.X.GetInstance().Pause(),this.setShouldShowMicrophonePermissionRetryDialog(!0),t.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.MicrophonePermissionDenied}])),void this.setMicrophoneState(df.Uninitialized)}}},this.isMicrophoneListening=e,this.shouldShowMicPermissionRetryDialog=t,this.microphoneState=n,this.microphonePermissionErrorTitle=r,this.microphonePermissionErrorMessage=s,this.setShouldShowMicrophonePermissionRetryDialog=i,this.setMicrophoneState=a,this.setMicrophoneListeningStatus=o,this.chatInputRef=l,this.chatPlaceHolderMessage=c,this.micListeningGhostText=u,this.microphonePermissionErrorImagePath=d,this.showMicrophonePermissionHelpLink=h,this.setPaneLoadMessageIfApplicable=p}getMicrophoneButtonProps(){return{isMicrophoneListening:this.isMicrophoneListening,microphoneState:this.microphoneState,handleMicrophoneButtonOnClick:this.handleMicrophoneButtonOnClick,micPermissionRetryDialogProps:{shouldShowMicPermissionRetryDialog:this.shouldShowMicPermissionRetryDialog,microphonePermissionErrorTitle:this.microphonePermissionErrorTitle,microphonePermissionErrorMessage:this.microphonePermissionErrorMessage,tryAgainOnClickHandler:()=>{this.onTryAgainClicked()},notNowOnClickHandler:()=>{this.setShouldShowMicrophonePermissionRetryDialog(!1)},microphonePermissionErrorImagePath:this.microphonePermissionErrorImagePath,showHelpLink:this.showMicrophonePermissionHelpLink}}}}var by,Cy;!function(e){e.APOLOGY="apology",e.BASIC_CHAT="generate_response",e.CANNED_RESPONSE="annrules",e.DEBUG_COMMAND="debug_command",e.DEEPLEO_SYDNEY="deepleo",e.DESIGNER_INSERT_GRAPHIC="insert_graphic",e.EDIT_DOCUMENT="edit_document",e.IMAGE_CHAT="image-chat",e.SUMMARIZE="summarize",e.SUMMARIZE_SINGLE_SHOT="wordsummarizeskillsingleshot",e.TRANSFORM_CONTENT="transform_content",e.UNKNOWN="Unknown"}(by||(by={})),function(e){e.Summary="Summary",e.BasicChat="BasicChat",e.Sydney="Sydney",e.HandOff="HandOff",e.Unset=""}(Cy||(Cy={}));var wy=n(11475);const Sy=new Set([wy.n3.TriggerConfirmation,wy.n3.TriggerPluginAuth]);var Ey,xy,Iy;function Ay(e){return"bot"===e.author&&e.messageType===wy.n3.Disengaged}function Py(e){return"user"===e.author&&e.messageType===wy.n3.Chat}!function(e){e.FCFR="FCFR",e.LCFR="LCFR"}(Ey||(Ey={})),function(e){e.Summary="Summary",e.BasicChat="BasicChat",e.Sydney="Sydney"}(xy||(xy={})),function(e){e.CopilotChat="CopilotChat",e.ChatQnA="Chat QnA"}(Iy||(Iy={}));function ky(e){return e.messageType===wy.n3.InternalSearchQuery||e.messageType===wy.n3.InternalLoaderMessage}function Ty(e){return"bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType||e.messageType===wy.n3.RenderCardRequest||e.messageType===wy.n3.RequireHumanInTheLoop)||!1}function Dy(e){const t=e?.adaptiveCards?.[0]??null;let n="";if(t){const e=t.body;for(const t of e)"TextBlock"===t.type&&(n+=t.text)}return n}const My=e=>{if((e.gptIdentifiers||[]).length>0){const t=e.gptIdentifiers[0].id;return t?{id:t,name:""}:void 0}};function Ly(e){const t={feature:Iy.CopilotChat,subFeature:void 0};if(!e||!e.length)return t;const n={feature:Iy.ChatQnA};switch(e.toLowerCase()){case by.APOLOGY:case by.DEEPLEO_SYDNEY:return{...n,subFeature:xy.Sydney};case by.BASIC_CHAT:return{...n,subFeature:xy.BasicChat};case by.SUMMARIZE:return{...n,subFeature:xy.Summary}}return t}const Ry={[Ey.FCFR]:{greenMs:8e3,neutralMs:0,yellowMs:1e4},[Ey.LCFR]:{greenMs:0,neutralMs:2e4,yellowMs:3e4}};function Ny(e,t){if(t)try{const e=t.split("|").map(Number);if(Array.isArray(e)&&3==e.length&&e.every((e=>!isNaN(e))))return{greenMs:1e3*e[0],neutralMs:1e3*e[1],yellowMs:1e3*e[2]}}catch(e){}return Ry[e]}function Oy(e,t,n,r,s,i){const a={},o=!(!i&&!s);a.skill=a.skill??Cy.Sydney,t.getSessionKey()||n.chatResponse?.sessionKey&&t.setSessionKey(n.chatResponse.sessionKey),a.sessionId=t.getSessionKey(),a.status=n.chatResponse?.status,a.queryId=a.queryId??n.queryId,i?(t.addAnnotationResponses({annotationType:n.H_?.T_,responseTime:(0,Vf.WU)(r),isStreamingAnnotation:!1,status:n.status}),a.messageType=a.messageType??"null",a.error=n.error):s&&(a.queryId=a.queryId??s.queryId,a.messageType=s.messageType,a.timestamp=s.timestamp,a.sensitivity=s.sensitivityLabel?.displayName,a.groundingDataCount=s.groundingDataCount),a.resultType=n.chatResponse?.resultType,a.optionSets=n.chatResponse?.optionsSets,a.annotationResponses=t.getAnnotationResponses(),a.signals=t.getSignal(),o&&(a.LCFR=1e3*(0,Vf.WU)(r),a.FCFR??(a.FCFR=a.LCFR),a.FCFRgoals=Ny(Ey.FCFR,e.perfCounterGoalsFCFR),a.LCFRgoals=Ny(Ey.LCFR,e.perfCounterGoalsLCFR),a.shouldShowPerfCounters=!0,e.addDebugInfoToMessage&&s&&(s.debugInfo=a)),t.setDebugInfo({...t.getDebugInfo(),...a})}const _y=e=>{const t=(0,Ot.Y$)(),n=(0,N.useRef)((t=>{const n=t.messages??[],r=n[n.length-1];return!(0===n.length||(s=r,!Sy.has(s?.messageType)))&&(e.responseHandlerParams.addResponseMessage({chatCardType:a._.InterstitialMessage,stopLoadingUi:!0,chatMessageData:{interstitialMessageProps:{user:"chat",interstitialMessages:n}},chatMessageBodyData:{messageId:r.messageId},addCardToChatHistory:!1}),!0);var s}));return{processFinalPart:(0,N.useCallback)((r=>{if(r.chatResponse&&n.current(r.chatResponse))return void e.responseState.reset();const s=e.responseState.getStreamChunkAnnotation();for(const t of s)e.responseState.addAnnotationResponses({annotationType:t.annotationType,responseTime:t.responseTime,isStreamingAnnotation:!0,status:t.status});e.responseState.addAnnotationResponses({annotationType:r.H_?.T_,responseTime:(0,Vf.WU)(ny.qD),isStreamingAnnotation:!1,status:r.chatResponse?.status});const i=r.chatResponse?.messages?.find((t=>(t?.locale&&e.responseState.setLocale(t.locale),Ty(t))));r?.queryId&&e.responseState.setDebugInfo({...e.responseState.getDebugInfo(),queryId:r.queryId}),t.isDebugSectionV2Enabled&&Oy(t,e.responseState,r,ny.qD,i);const l=r.chatMessageHeader;if(e.responseState.getIsDisengagedError()){e.responseHandlerParams.addResponseMessage({chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:Af.Q9.Chat,messageHeader:{text:"Disengaged error"}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:o.O.Footer,showAnimation:!1,isFailure:!0},stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!0}),e.responseState.reset();const t={workflowAnnotationType:""};return void e.copilotCommunicationHandler.sendEventToClient(Tf.PV.FluxResponseHandlingErroredOut,t)}const c=i?.contentOrigin===by.EDIT_DOCUMENT;e.responseState.setIsODSLResponseMessage(c);let u=!1;const d=i?.offense&&i.offense!==wy.h2.None&&i.offense!==wy.h2.Unknown;i&&(u=d||void 0!==r?.error||i?.messageType===wy.gL.ApologyResponseReturned||i?.contentOrigin===by.APOLOGY);let h=!1;if(e.responseState.getMessageId())if(i&&(i.messageId===e.responseState.getMessageId()||c)){const t=e.fluxServiceContainer.clpService.fetchCLPInfo(i.sensitivityLabel);e.responseUtils.updateLastRenderedMessage(i,e.fluxServiceContainer.clientInfoService.getClientInfo(),e.fluxServiceContainer.actionButtonService,e.responseState,t,!0,e.responseState.getPluginAuthError(),l,e.responseState.getConfirmationCardProps())}else h=!0;else{const t=e.responseHandlerParams.getLastMessage(!1),n=t?.messageType??a._.MarkdownCard,r=t?.body.user;if(t&&r===Af.Q9.Chat){const r={...e.responseState.getDebugInfo()},s=e.fluxServiceContainer.actionButtonService.fetchDebugActionButtons(r);if(s.length>0){const e=t.actionBarButtons?.slice();e?.push(...s),t.actionBarButtons=e}e.responseHandlerParams.updateLastMessage({chatCardType:n,chatMessageBodyData:{},stopLoadingUi:!0,addCardToChatHistory:!1})}else h=!0}if(h&&i&&function(e){const t=e?.contentOrigin?.toLowerCase();return t===by.CANNED_RESPONSE||t===by.DEBUG_COMMAND||t===by.SUMMARIZE_SINGLE_SHOT||t===by.TRANSFORM_CONTENT||t===by.IMAGE_CHAT||t===by.DESIGNER_INSERT_GRAPHIC}(i)&&i?.text)e.responseUtils.showMarkdownResponseCard(i?.text,i.messageId,i.contentOrigin,e.fluxServiceContainer.clpService.fetchCLPInfo(i.sensitivityLabel));else{const t=Ly(i?.contentOrigin),n=e.responseHandlerParams.getLastMessage(!1);if(n&&n.body.user===Af.Q9.Human)if(i?.text)e.responseUtils.addResponseMarkdownMessageCard(i?.text??"",i?.messageId??e.responseState.getMessageId(),void 0,!0,i?.contentOrigin,l),e.responseState.addQueryIdInProgress(e.responseState.getQueryId());else{let n;try{const e=r?.error?.json?JSON.parse(r?.error?.json):void 0,t=(r?.error?.category??"")+"_"+(e?e.code:"");n=t||"UnClassifiedError"}catch(e){n="UnClassifiedError"}const s={errorMessage:Df.BF,errorType:n,featureName:t.feature,subFeatureName:t.subFeature};e.responseHandlerParams.addResponseMessage({chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:Af.Q9.Chat,messageHeader:{text:Df.BF}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:o.O.Footer,showAnimation:!1,isFailure:!0,feedbackData:e.fluxServiceContainer.feedbackService.getFeedbackData({...s,conversationId:e.responseState.getConversationId(),sydneyEndpoint:e.responseState.getSydneyEndpoint(),locale:e.responseState.getLocale()}),telemetryData:JSON.stringify({featureName:t.feature,correlationId:void 0,subFeatureName:t.subFeature})},stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!0})}}e.responseState.reset();e.copilotCommunicationHandler.sendEventToClient(Tf.PV.FluxResponseHandlingCompleted,{workflowAnnotationType:""})}),[e.responseState,e.copilotCommunicationHandler,e.responseHandlerParams,e.fluxServiceContainer.actionButtonService,e.fluxServiceContainer.clpService,e.fluxServiceContainer.clientInfoService,e.fluxServiceContainer.feedbackService,e.responseUtils,t]),setHandleInterstitialMessages:e=>{n.current=e}}};function By(e,t,n){let r;const s=function(e){return 0===(e||[]).length?0:e.filter((e=>!!e.adaptiveCardJson)).length}(e);return s>0&&(r={attributions:e,clientInfo:t,hideSingleCitation:n}),r}const Fy="Annotation";var Uy;!function(e){e.Citation="Citation",e.Annotation="Annotation"}(Uy||(Uy={}));const Hy=e=>e?'"'+(e.length>18?e.slice(0,18).trim():e)+'..."':null;function zy(e){return e.path?void 0:e.seeMoreUrl}function jy(e){if(void 0!==e)return Object.values(hl._R).includes(e)?e:void 0}const Vy=(e,t,n,r)=>e.filter((e=>r?e.sourceType===Fy:e.sourceType!==Fy)).map(((e,r)=>{let s;e.referenceMetadata&&(s=JSON.parse(e.referenceMetadata));const i=function(e,t){return t?.path?hl._2.Internal:e===wy.YA.Web||void 0===e?hl._2.External:void 0!==e&&Object.values(hl._R).includes(e)?hl._2.CrossApp:hl._2.External}(s?.type,e),a=i===hl._2.Internal?Hy(s?.snippet??"")??i:Hy(e.providerDisplayName)??i,o=i===hl._2.Internal?t:s?.typeDescription??"",l=s?.iconUrl?.replace(/\/$/,""),c=(e=>e.sourceType===Fy?Uy.Annotation:Uy.Citation)(e);return{referenceIndex:r+1,referenceProps:{title:a,primarySubtitle:o,secondarySubtitle:s?.context??zy(e),snippet:(u=s?.snippet??"",u.length>150?u.substring(0,150)+'..."':u),referenceType:i,iconAppName:i===hl._2.CrossApp||i===hl._2.Internal?jy(s?.type):void 0,url:zy(e),path:[e.path].filter((e=>void 0!==e)),onClickCitationLink:n,sensitivityLabel:s?.sensitivityLabel?.displayName,iconUrl:l,linkType:c},isFlux:!0,isCitedInResponse:"true"===e.isCitedInResponse?.toLowerCase()};var u})),qy=(e,t,n,r)=>{return{referenceIndex:e.contentIndex,referenceProps:{title:Hy(e.content)??"",primarySubtitle:t,snippet:(s=e.content,'"'+(s.length>150?s.slice(0,150)+"...":s)+'"'),referenceType:hl._2.Internal,iconAppName:e.type,citationPosition:e.position,onClickCitationLink:n,path:e.path,sensitivityLabel:r}};var s};function Wy(e,t,n){let r;const s=function(e){return 0===(e||[]).length?0:e.filter((e=>!!e.cardJson)).length}(e);return s>0&&(r={attributions:e,clientInfo:t,hideSingleCitation:n}),r}const Qy=e=>{const t=e?.adaptiveCards?.[0];return t?{body:t}:void 0},Gy=e=>"bot"===e.author&&"ConfirmationCard"===e.messageType;var Zy=n(58919);var Yy=n(70001);const Ky={contentOrigins:[{contentOrigin:by.BASIC_CHAT},{contentOrigin:by.DEEPLEO_SYDNEY}],shouldHandleGptResponse:!1,shouldHandleOdslResponse:!1,shouldHandleError:!1};function Jy(e){const t=e?.body;return!!t&&(!(!Ky.shouldHandleOdslResponse||!t.odslResponse)||(!(!Ky.shouldHandleError||!t.error)||(!(!Ky.shouldHandleGptResponse||!function(e){const t=e.chatResponse?.messages?.find((e=>Ty(e)));return(t?.gptIdentifiers||[]).length>0}(t))||!!Ky.contentOrigins.some((e=>function(e,t){const n=e.chatResponse?.messages||e.chatResponse?.messagesToAddOrReplace||[];return n.some((e=>function(e,t){return"bot"===e.author&&(!e.messageType||"Chat"===e.messageType)&&e.contentOrigin?.toLowerCase()===t.contentOrigin.toLowerCase()||ky(e)}(e,t)))}(t,e))))))}const Xy=e=>{const t=(()=>{const e=(0,N.useRef)([]),t=(0,N.useRef)(!0),n=(0,N.useRef)(!1),r=(0,N.useRef)(""),s=(0,N.useRef)(!0),i=(0,N.useRef)(void 0),a=(0,N.useRef)(void 0),o=(0,N.useRef)(new Yy.Basin),l=(0,N.useRef)(new Map),c=(0,N.useRef)(""),u=(0,N.useRef)(""),d=(0,N.useRef)(""),h=(0,N.useRef)(new Set),p=(0,N.useRef)(""),g=(0,N.useRef)(""),m=(0,N.useRef)({}),f=(0,N.useRef)(""),y=(0,N.useRef)([]),v=(0,N.useRef)([]),b=(0,N.useRef)([]),C=(0,N.useRef)(!1),w=(0,N.useCallback)((e=>{C.current=e}),[]),S=(0,N.useCallback)((()=>C.current),[]),E=(0,N.useCallback)((e=>{e&&!h.current.has(e)&&h.current.add(e)}),[]),x=(0,N.useCallback)((e=>h.current.has(e)),[]),I=(0,N.useCallback)((e=>{g.current=e}),[]),A=(0,N.useCallback)((()=>g.current),[]),P=(0,N.useCallback)((e=>{p.current=e}),[]),k=(0,N.useCallback)((()=>p.current),[]),T=(0,N.useCallback)((t=>null!=t&&(t=t.replace("\\n","\n"),e.current.push(t),!0)),[]),D=(0,N.useCallback)((t=>null!=t&&(t=t.replace("\\n","\n"),e.current=[t],!0)),[]),M=(0,N.useCallback)((()=>e.current.join("")),[]),L=(0,N.useCallback)((()=>t.current),[]),R=(0,N.useCallback)((e=>{t.current=e}),[]),O=(0,N.useCallback)((()=>n.current),[]),_=(0,N.useCallback)((e=>{n.current=e}),[]),B=(0,N.useCallback)((()=>r.current),[]),F=(0,N.useCallback)((e=>{r.current=e}),[]),U=(0,N.useCallback)((()=>s.current),[]),H=(0,N.useCallback)((e=>{s.current=e}),[]),z=(0,N.useCallback)((()=>i.current),[]),j=(0,N.useCallback)((e=>{i.current=e}),[]),V=(0,N.useCallback)((()=>a.current),[]),q=(0,N.useCallback)((e=>{a.current=e}),[]),W=(0,N.useCallback)((()=>o.current),[]),Q=(0,N.useCallback)((e=>{o.current.items[e.messageId]=e}),[]),G=(0,N.useCallback)((e=>{delete o.current.items[e]}),[]);return{addQueryIdInProgress:E,shouldProcessQueryId:x,addUserMessage:I,getUserMessage:A,setQueryId:P,getQueryId:k,addResponsePart:T,replaceResponsePart:D,getFinalResponse:M,getIsFirstResponse:L,setIsFirstResponse:R,getIsDisengagedError:O,setIsDisengagedError:_,getMessageId:B,setMessageId:F,getIsFirstStreamChunk:U,setIsFirstStreamChunk:H,getConfirmationCardProps:z,setConfirmationCardProps:j,getPluginAuthError:V,setPluginAuthError:q,getBasin:W,deleteMessage:G,setCursor:(0,N.useCallback)((e=>{o.current.setCursor(e)}),[]),writeBasin:(0,N.useCallback)((e=>{o.current.write(e)}),[]),getBasinItem:(0,N.useCallback)((()=>o.current.items[r.current]),[]),setBasinItem:Q,setCitationPathDataIndexMap:(0,N.useCallback)(((e,t)=>{l.current.set(e,t)}),[]),getCitationPathData:(0,N.useCallback)((e=>l.current.get(e)||[]),[]),clearCitationPathData:(0,N.useCallback)((()=>{l.current.clear()}),[]),getConversationId:(0,N.useCallback)((()=>c.current),[]),setConversationId:(0,N.useCallback)((e=>{c.current=e}),[]),getSydneyEndpoint:(0,N.useCallback)((()=>u.current),[]),setSydneyEndpoint:(0,N.useCallback)((e=>{u.current=e}),[]),getLocale:(0,N.useCallback)((()=>d.current),[]),setLocale:(0,N.useCallback)((e=>{d.current=e}),[]),setDebugInfo:(0,N.useCallback)((e=>{m.current={...e}}),[]),getDebugInfo:(0,N.useCallback)((()=>m.current),[]),getSessionKey:(0,N.useCallback)((()=>f.current),[]),setSessionKey:(0,N.useCallback)((e=>{f.current=e}),[]),getSignal:(0,N.useCallback)((()=>y.current),[]),addSignal:(0,N.useCallback)((e=>{y.current.push(e)}),[]),getAnnotationResponses:(0,N.useCallback)((()=>v.current),[]),addAnnotationResponses:(0,N.useCallback)((e=>{v.current.push(e)}),[]),pushStreamChunkAnnotation:(0,N.useCallback)((e=>{b.current.push(e)}),[]),getStreamChunkAnnotation:(0,N.useCallback)((()=>b.current),[]),getIsODSLResponseMessage:S,setIsODSLResponseMessage:w,reset:(0,N.useCallback)((()=>{t.current=!0,n.current=!1,r.current="",s.current=!0,e.current=[],i.current=void 0,a.current=void 0,o.current=new Yy.Basin,c.current="",u.current="",d.current="",h.current.delete(p.current),p.current="",g.current="",m.current={},y.current=[],v.current=[],b.current=[],C.current=!1,f.current=""}),[])}})(),n=function(e){const t=(0,N.useCallback)(((t,s)=>{const i=[];if(!((t.citations||[]).length>0))return n(t);{const n=t.citations;for(const t of n)i.push(qy(t,e.citationTitle,r,s))}return{references:i}}),[]),n=(0,N.useCallback)((t=>{let n,s,i=[];return(t.sourceAttributions||[]).length>0&&(i=Vy(t.sourceAttributions,e.citationTitle,r),n=Vy(t.sourceAttributions,e.citationTitle,r,!0),s=t.sourceAttributions?(0,Zy.yt)(t).entityAnnotations??[]:[]),{references:i,annotationReferences:n,entityAnnotations:s}}),[]),r=async(t,n,r)=>{await e.handleCitationClick(n??[])};return{getCitations:t,getReferences:n}}(e.fluxServiceContainer.citationService),r=(e=>{const t=(0,N.useCallback)((e=>{if(null!=e)return{titleText:e?.title??"",popoverText:e?.expandedTitle??void 0}}),[]);return{updateLastRenderedMessage:(0,N.useCallback)(((n,r,s,i,l,c=!0,u,d,h)=>{const p=l?l.displayName:void 0,g=n.suggestedResponses;if(g&&g.length>0){const t=function(e){const t=[];for(const n of e)"Suggestion"===n.messageType&&t.push(n.text);return t}(g),n={suggestionPills:t,workflowAnnotationType:""};e.copilotCommunicationHandler.sendEventToClient(Tf.PV.NewSuggestionPills,n)}const m=[],f=s.fetchActionButtons(n,i);f.length>0&&m.push(...f);const y={...e.responseState.getDebugInfo()},v=s.fetchDebugActionButtons(y);v.length>0&&m?.push(...v);const{references:b,annotationReferences:C,entityAnnotations:w}=e.citationUtils.getCitations(n,p);let S="";(n.gptIdentifiers||[]).length>0&&(S=n.gptIdentifiers[0].id);const E=Wy(n.sourceAttributions,r,!0),x=By(n.sourceAttributions,r,!0);let I={};if(n?.contentOrigin){const{feature:e,subFeature:t}=Ly(n?.contentOrigin);I={...I,featureName:e,subFeatureName:t}}I={...I,conversationId:e.responseState.getConversationId(),sydneyEndpoint:e.responseState.getSydneyEndpoint(),locale:e.responseState.getLocale()},e.responseHandlerParams.updateLastMessage({chatCardType:a._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:n.text,allowImages:!1,enableLinkDataDownload:!1,disableLinksProcessing:!1}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:o.O.Footer,actionButtonList:m,isFailure:!1,references:b&&b.length>0?b:void 0,annotationReferences:C&&C.length>0?C:void 0,entityAnnotations:w&&w.length>0?w:void 0,clpSensitivityIndicatorData:l,msgExtCardProps:E,apiPluginCardProps:x,confirmationCardProps:h,pluginAuthError:u,feedbackData:e.feedbackService.getFeedbackData(I),telemetryData:void 0,chatMessageHeaderData:t(d),messageAttributionProps:S?{id:S,name:""}:void 0,shouldShowCopyButton:!h&&s.getConfig().showCopyButton,shouldShowHandoffButton:!h&&s.getConfig().showHandOffButton,shouldShowReadAloudButton:!h&&s.getConfig().showReadAloudButton,debugInfo:n.debugInfo},stopLoadingUi:c,addCardToChatHistory:void 0===E})}),[t,e.citationUtils,e.copilotCommunicationHandler,e.feedbackService,e.responseHandlerParams,e.responseState]),addResponseMarkdownMessageCard:(0,N.useCallback)(((n,r,s=void 0,i,l,c=void 0,u=void 0)=>{const d=a._.MarkdownCard,h={markDownCardProps:{user:"chat",message:n,disableLinksProcessing:l?.toLowerCase()===by.CANNED_RESPONSE}};if(l){const{feature:e,subFeature:t}=Ly(l);u={...u,featureName:e,subFeatureName:t}}u={...u,conversationId:e.responseState.getConversationId(),sydneyEndpoint:e.responseState.getSydneyEndpoint(),locale:e.responseState.getLocale()},e.responseHandlerParams.addResponseMessage({chatCardType:d,chatMessageData:h,chatMessageBodyData:{actionButtonList:[],shouldShowAIGeneratedIndicator:!0,clpSensitivityIndicatorData:s,feedbackSectionPosition:o.O.Footer,feedbackData:e.feedbackService.getFeedbackData(u),telemetryData:void 0,showAnimation:!0,isFailure:!1,messageId:r,chatMessageHeaderData:t(c)},stopLoadingUi:i,startAugloopTimerForStreaming:!0,addCardToChatHistory:!1})}),[t,e.feedbackService,e.responseHandlerParams,e.responseState]),updateResponseMarkdownMessageCard:(0,N.useCallback)(((n,r,s=void 0,i=void 0,o)=>{const l=a._.MarkdownCard,c={markDownCardProps:{user:"chat",message:n}};if(o){const{feature:e,subFeature:t}=Ly(o);i={...i,featureName:e,subFeatureName:t}}i={...i,conversationId:e.responseState.getConversationId(),sydneyEndpoint:e.responseState.getSydneyEndpoint(),locale:e.responseState.getLocale()},e.responseHandlerParams.updateLastMessage({chatCardType:l,chatMessageData:c,chatMessageBodyData:{...r,chatMessageHeaderData:t(s),actionButtonList:[],feedbackData:e.feedbackService.getFeedbackData(i),telemetryData:void 0},stopLoadingUi:!1,startAugloopTimerForStreaming:!0,addCardToChatHistory:!1})}),[e.responseState,e.responseHandlerParams,e.feedbackService,t]),showMarkdownResponseCard:(0,N.useCallback)(((n,r,s,i=void 0,l=!0,c=!0,u=!0,d=!0,h,p=void 0)=>{const g=s?.toLowerCase()===by.CANNED_RESPONSE;if(g&&(n=n.replace(/['"]+/g,"")),s){const{feature:e,subFeature:t}=Ly(s);p={...p,featureName:e,subFeatureName:t}}p={...p,conversationId:e.responseState.getConversationId(),sydneyEndpoint:e.responseState.getSydneyEndpoint(),locale:e.responseState.getLocale()},e.responseHandlerParams.addResponseMessage({chatCardType:a._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:n,disableLinksProcessing:g}},chatMessageBodyData:{actionButtonList:[],shouldShowAIGeneratedIndicator:u,clpSensitivityIndicatorData:i,feedbackSectionPosition:o.O.Footer,feedbackData:e.feedbackService.getFeedbackData(p),telemetryData:void 0,showAnimation:d,isFailure:!1,messageId:r,chatMessageHeaderData:t(h)},stopLoadingUi:l,addCardToChatHistory:c})}),[t,e.feedbackService,e.responseHandlerParams,e.responseState])}})({copilotCommunicationHandler:e.copilotCommunicationHandler,responseHandlerParams:e.responseHandlerParams,citationUtils:n,feedbackService:e.fluxServiceContainer.feedbackService,responseState:t}),s={copilotCommunicationHandler:e.copilotCommunicationHandler,responseHandlerParams:e.responseHandlerParams,responseState:t,responseUtils:r,citationUtils:n,fluxServiceContainer:e.fluxServiceContainer},{processPartialPart:i}=(e=>{const t=(0,N.useRef)((t=>{for(const n of t){if(Ay(n)||e.responseState.getIsDisengagedError())return void e.responseState.setIsDisengagedError(!0);if(Ty(n)){if(n?.locale&&e.responseState.setLocale(n.locale),n.messageId!==e.responseState.getMessageId()){e.responseState.setMessageId(n.messageId),e.responseState.getIsFirstStreamChunk()&&e.responseState.setIsFirstStreamChunk(!1);const t=Dy(n);e.responseState.addResponsePart(t||n.text)&&e.responseUtils.addResponseMarkdownMessageCard(e.responseState.getFinalResponse(),n.messageId,e.fluxServiceContainer.clpService.fetchCLPInfo(n.sensitivityLabel)),e.responseState.addQueryIdInProgress(e.responseState.getQueryId())}else{const t=e.fluxServiceContainer.clientInfoService.getClientInfo(),{references:r,annotationReferences:s,entityAnnotations:i}=e.citationUtils.getReferences(n),a=n.sourceAttributions?Wy(n.sourceAttributions,t,!0):void 0,o=n.sourceAttributions?By(n.sourceAttributions.map((e=>({...e,adaptiveCardJson:"",providerDisplayDescription:"",seeMoreUrl:e.seeMoreUrl||""}))),t,!0):void 0,l=Dy(n);e.responseState.replaceResponsePart(l||n.text)&&e.responseUtils.updateResponseMarkdownMessageCard(e.responseState.getFinalResponse(),{references:r,annotationReferences:s,entityAnnotations:i,msgExtCardProps:1===a?.attributions.length?void 0:a,apiPluginCardProps:1===o?.attributions.length?void 0:o,messageAttributionProps:My(n),messageId:n.messageId})}e.responseState.setBasinItem(n)}else ky(n)?e.responseHandlerParams.updateLoadingComponentProps({loadingUiStringList:[n.text]}):Gy(n)?e.responseState.setConfirmationCardProps(Qy(n)):n.authErrors&&n.authErrors.length>0&&n.authErrors[0]?e.responseState.setPluginAuthError(n.authErrors[0]):Py(n)&&e.responseState.addUserMessage(n.text)}})),n=(0,N.useRef)((t=>{for(const n of t){if(e.responseState.getIsDisengagedError())return;n.messageId===e.responseState.getMessageId()&&e.responseState.addResponsePart(n.appendText)&&e.responseUtils.updateResponseMarkdownMessageCard(e.responseState.getFinalResponse(),{messageId:n.messageId})}})),r=(0,N.useRef)((t=>{for(const n of t)e.responseHandlerParams.deleteMessage({chatCardType:a._.MarkdownCard,messageIdToDelete:n}),e.responseState.deleteMessage(n)})),s=(0,N.useRef)((t=>{const n=JSON.parse(t);e.responseState.writeBasin(n);const r=Dy(e.responseState.getBasinItem());e.responseState.replaceResponsePart(r||n)&&e.responseUtils.updateResponseMarkdownMessageCard(e.responseState.getFinalResponse(),{messageId:e.responseState.getMessageId()})})),i=(0,N.useRef)((t=>{const n=t?JSON.parse(t):null;e.responseState.setCursor(n)}));return{processPartialPart:(0,N.useCallback)((a=>{const o=a.basinCursor,l=a.basinWrite,c=a.messagesToAddOrReplace,u=a.messagesToDelete,d=a.messagesToUpdate;u&&r.current(u),o&&i.current(o),c&&c.length>0&&t.current(c),d&&d.length>0&&n.current(d),null==l||e.responseState.getIsDisengagedError()||s.current(l)}),[e.responseState]),setAddOrReplaceMessage:e=>{t.current=e},setUpdateMessage:e=>{n.current=e},setDeleteMessage:e=>{r.current=e},setCursor:e=>{i.current=e},setWriteBasin:e=>{s.current=e}}})(s),l={copilotCommunicationHandler:e.copilotCommunicationHandler,responseHandlerParams:e.responseHandlerParams,responseState:t,responseUtils:r,fluxServiceContainer:e.fluxServiceContainer},{processFinalPart:c}=_y(l),u=(0,Ot.Y$)(),d=e=>{const n=e?.body;return!!n&&!(!n.queryId||!t.shouldProcessQueryId(n.queryId))};return{fluxAugloopResponseProcessor:(e,n)=>{const r=e?.body;if(r&&(Jy(e)||d(e))&&(t.getIsFirstResponse()&&(t.setConversationId(r.conversationId??""),t.setSydneyEndpoint(r.sydneyEndpoint??""),t.setQueryId(r.queryId??""),t.setIsFirstResponse(!1)),r.chatResponse))if(u.isDebugSectionV2Enabled&&Oy(u,t,r,ny.qD),r.chatResponse.status===Af.lC.Success)c(r);else if(r.chatResponse.status===Af.lC.PartialResult){const e={annotationType:r.H_?.T_??"",responseTime:(0,ny.WU)(ny.qD),status:r.chatResponse.status};t.pushStreamChunkAnnotation(e),i(r.chatResponse)}},isQueryIdInSharedProcessingList:d,addQueryIdInSharedProcessingList:e=>{const n=e?.body;n&&n.queryId&&t.addQueryIdInProgress(n.queryId)},updateInputSignalInFluxHandler:e=>{e&&t.addSignal(e)}}};var $y=n(21548),ev=n(97218);const tv={copyButtonLabel:_f.Vv,copyButtonPopovertext:_f.d7};var nv=n(68279);const rv=(e,t,n,r,s)=>{const i=new Map;let a=!1;return e?.forEach((e=>{Nt.E.QNA===e?.tabType&&(Wf.j.getInstance(s).sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.InsightsCardQnAHandled},{key:Pf.h3.UserQueryGuid,value:r??Df.u1}]),t.forEach((e=>{const t=e.citations?jf.U.getInstance().getMarkdownReferences(e.citations):[];i.set(e.question,t)})),e?.updateContent?.({suggestedQnAs:t,qnACitationsReferencesMap:i},n),a=!0)})),a},sv=(e,t,n,r,s,i,a,o)=>{const l=t?.body,c=l.suggestedQnAs,u=l.error,d=l.queryId,h=Wf.j.getInstance(e),p=jf.U.getInstance(e).getSuggestedQnaSignalSubmitTime();if((0,qf.cY)("received suggestedQnaList",c),h.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ResponseReceivedFromAL},{key:Pf.h3.ChatEventParameters,value:yf.pK.getTypeName()},{key:Pf.h3.UserQueryGuid,value:d},{key:Pf.h3.Cv,value:a}]),h.sendTelemetryLatencyData([{key:Pf.CT.SuggestedQnAResponseTime,value:(0,ny.WU)(p)},{key:Pf.h3.UserQueryGuid,value:d}]),jf.U.getInstance(e).sendLoggingEventToClient(Tf.Yk.AugloopResponseReceived,{annotationName:yf.pK.getTypeName(),timeInMs:(0,ny.xJ)(p)}),!(0,Vf.hX)(u)&&!(0,Vf.hX)(u?.category)){let t="";const n=yf.pK.getTypeName();if(!(0,Vf.hX)(u.errorDetailsJson))try{t=JSON.parse(u.errorDetailsJson).code}catch(e){(0,qf.cY)("Error parsing error code from basic chat error",e.message)}return(0,qf.cY)("Received error from DynamicQuestionGeneratorSuggestedQnAAnnotation Workflow"),jf.U.getInstance(e).sendLoggingEventToClient(Tf.Yk.AugloopErrorReceived,{annotationName:n,timeInMs:(0,ny.xJ)(p),chatEventParams:JSON.stringify({errorCategory:u.category,errorCode:t})}),void h.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:`${n}_Error`},{key:Pf.h3.ChatEventParameters,value:`${u.category}_${t}`},{key:Pf.h3.ChatErrorType,value:Pf.q0.Server},{key:Pf.h3.UserQueryGuid,value:d}])}c&&((e,t,n,r,s,i,a,o)=>{t.setSuggestedQnAList(e),r(e);const l=o?.shouldShowNewSQNAZQM??!1,c=o?.enableSQNAZQMWhenNotInCC??!1;let u=!1;if(s)if(l&&e.length>3){const t=e.slice(0,3),r=e.slice(3);(0,qf.cY)(`Sending ${t.length} QnAs to interactive card out of ${e.length} total`),rv(s,t,Nt.x.LOADED,i,a),n(r)}else(0,qf.cY)(`Sending all ${e.length} QnAs to interactive card`),u=rv(s,e,Nt.x.LOADED,i,a),!l&&c&&n(e,u);else n(e)})(c,n,r,s,i,d,e,o)};const iv=class{getDebugSectionProps(e,t,n){return{conversationId:t,getLogs:e,telemetryData:n}}};var av=n(11589),ov=n(45672),lv=n(72721),cv=n(84567),uv=n(83813),dv=n(7449);class hv{constructor(){this.getProps=e=>({handleChangeTopicButtonClick:e})}}var pv,gv=n(72613),mv=n(72128);!function(e){e.None="None",e.UserInstalled="UserInstalled",e.TenantInstalled="TenantInstalled"}(pv||(pv={}));var fv=n(2259),yv=n(58900),vv=n(60800),bv=n(67624),Cv=n(64200),wv=n(81852),Sv=Math.min;const Ev=function(e,t,n){for(var r=n?bv.A:vv.A,s=e[0].length,i=e.length,a=i,o=Array(i),l=1/0,c=[];a--;){var u=e[a];a&&t&&(u=(0,fv.A)(u,(0,Cv.A)(t))),l=Sv(u.length,l),o[a]=!n&&(t||s>=120&&u.length>=120)?new yv.A(a&&u):void 0}u=e[0];var d=-1,h=o[0];e:for(;++d<s&&c.length<l;){var p=u[d],g=t?t(p):p;if(p=n||0!==p?p:0,!(h?(0,wv.A)(h,g):r(c,g,n))){for(a=i;--a;){var m=o[a];if(!(m?(0,wv.A)(m,g):r(e[a],g,n)))continue e}h&&h.push(g),c.push(p)}}return c};var xv=n(78561);const Iv=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var Av=Math.max;const Pv=function(e,t,n){return t=Av(void 0===t?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=Av(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=n(a),Iv(e,this,o)}};const kv=function(e){return function(){return e}};var Tv=n(69471);const Dv=function(){try{var e=(0,Tv.A)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();const Mv=Dv?function(e,t){return Dv(e,"toString",{configurable:!0,enumerable:!1,value:kv(t),writable:!0})}:xv.A;var Lv=Date.now;const Rv=function(e){var t=0,n=0;return function(){var r=Lv(),s=16-(r-n);if(n=r,s>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Mv);const Nv=function(e,t){return Rv(Pv(e,t,xv.A),e+"")};var Ov=n(39197),_v=n(7231);const Bv=function(e){return(0,_v.A)(e)&&(0,Ov.A)(e)};const Fv=function(e){return Bv(e)?e:[]};const Uv=Nv((function(e){var t=(0,fv.A)(e,Fv);return t.length&&t[0]===e[0]?Ev(t):[]}));var Hv,zv,jv,Vv,qv,Wv,Qv,Gv,Zv;!function(e){e[e.None=0]="None",e[e.TokenFetchFailed=1]="TokenFetchFailed",e[e.ErrorResponse=2]="ErrorResponse",e[e.PluginStateUpdateFailed=3]="PluginStateUpdateFailed",e[e.PluginFetchFailed=4]="PluginFetchFailed",e[e.GetHeaderFailed=5]="GetHeaderFailed",e[e.AuthFlowFailedOnPluginToggle=6]="AuthFlowFailedOnPluginToggle",e[e.AuthExecutionFailedOnPluginToggle=7]="AuthExecutionFailedOnPluginToggle",e[e.MorePluginsClickFailed=8]="MorePluginsClickFailed",e[e.MorePluginsClickHostHandled=9]="MorePluginsClickHostHandled",e[e.ManagePluginsClickFailed=10]="ManagePluginsClickFailed",e[e.ManagePluginsClickHostHandled=11]="ManagePluginsClickHostHandled",e[e.GetCopilotPluginsIdsFailed=12]="GetCopilotPluginsIdsFailed",e[e.StoreFrontPluginsFetchFailed=13]="StoreFrontPluginsFetchFailed",e[e.StoreFrontCopilotPluginPermissionsClickHostHandled=14]="StoreFrontCopilotPluginPermissionsClickHostHandled",e[e.StoreFrontCopilotPluginPermissionsClickFailed=15]="StoreFrontCopilotPluginPermissionsClickFailed",e[e.StoreFrontCopilotPluginItemInstallSucceeded=16]="StoreFrontCopilotPluginItemInstallSucceeded",e[e.StoreFrontCopilotPluginItemInstallFailed=17]="StoreFrontCopilotPluginItemInstallFailed",e[e.PowerPlatformConnectorFlyoutDismissed=18]="PowerPlatformConnectorFlyoutDismissed",e[e.PowerPlatformConnectorFlyoutOpen=19]="PowerPlatformConnectorFlyoutOpen",e[e.SetPluginsHandled=20]="SetPluginsHandled",e[e.SetPluginsFailed=21]="SetPluginsFailed"}(Hv||(Hv={})),function(e){e[e.PluginDataProvider=0]="PluginDataProvider",e[e.MsgExtViewModel=1]="MsgExtViewModel",e[e.CopilotPluginFlyoutTeachingPopover=2]="CopilotPluginFlyoutTeachingPopover",e[e.CopilotPluginFlyoutTeachingUI=3]="CopilotPluginFlyoutTeachingUI",e[e.CopilotPluginStoreFrontUI=4]="CopilotPluginStoreFrontUI"}(zv||(zv={})),function(e){e[e.LaunchPluginFlyout=0]="LaunchPluginFlyout",e[e.TogglePlugin=1]="TogglePlugin",e[e.GetPluginsState=2]="GetPluginsState",e[e.PluginRender=3]="PluginRender",e[e.InstalledPlugins=4]="InstalledPlugins",e[e.SelectedPlugins=5]="SelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePlugins=7]="MorePlugins",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePlugins=10]="ManagePlugins",e[e.StoreFrontCopilotPluginPermissions=11]="StoreFrontCopilotPluginPermissions",e[e.StoreFrontCopilotPluginIds=12]="StoreFrontCopilotPluginIds",e[e.StoreFrontCopilotPlugins=13]="StoreFrontCopilotPlugins",e[e.GetStoreFrontPluginsState=14]="GetStoreFrontPluginsState",e[e.InstallStoreFrontCopilotPlugin=15]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginItem=16]="StoreFrontCopilotPluginItem",e[e.PowerPlatformConnector=17]="PowerPlatformConnector",e[e.SetPlugins=18]="SetPlugins",e[e.ExtensionSettings=19]="ExtensionSettings"}(jv||(jv={})),function(e){e[e.GetHeader=0]="GetHeader",e[e.GetPlugins=2]="GetPlugins",e[e.GetAppDefinition=3]="GetAppDefinition",e[e.GetBotInvokeRequest=4]="GetBotInvokeRequest",e[e.HandleAuthLinkClick=5]="HandleAuthLinkClick",e[e.OnToggle=6]="OnToggle",e[e.NextButtonClick=7]="NextButtonClick",e[e.GotItButtonClick=8]="GotItButtonClick",e[e.GetStoreFrontPlugins=9]="GetStoreFrontPlugins"}(Vv||(Vv={})),function(e){e[e.CopilotPluginFlyout=0]="CopilotPluginFlyout",e[e.OnToggle=1]="OnToggle",e[e.GetPlugins=2]="GetPlugins",e[e.PluginFlyoutItemRender=3]="PluginFlyoutItemRender",e[e.GetInstalledPlugins=4]="GetInstalledPlugins",e[e.GetSelectedPlugins=5]="GetSelectedPlugins",e[e.AuthActivity=6]="AuthActivity",e[e.MorePluginsClick=7]="MorePluginsClick",e[e.TeachingUIV8=8]="TeachingUIV8",e[e.TeachingUIV9=9]="TeachingUIV9",e[e.ManagePluginsClick=10]="ManagePluginsClick",e[e.GetStoreFrontCopilotPluginIds=11]="GetStoreFrontCopilotPluginIds",e[e.GetStoreFrontCopilotPlugins=12]="GetStoreFrontCopilotPlugins",e[e.GetStoreFrontPlugins=13]="GetStoreFrontPlugins",e[e.InstallStoreFrontCopilotPlugin=14]="InstallStoreFrontCopilotPlugin",e[e.StoreFrontCopilotPluginPermissionClick=15]="StoreFrontCopilotPluginPermissionClick",e[e.StoreFrontCopilotPluginItemClick=16]="StoreFrontCopilotPluginItemClick",e[e.PowerPlatformConnectorClick=17]="PowerPlatformConnectorClick",e[e.SetPlugins=18]="SetPlugins",e[e.GetSelectedPluginsFromExtensionSettings=19]="GetSelectedPluginsFromExtensionSettings",e[e.WriteSelectedPluginsToExtensionSettings=20]="WriteSelectedPluginsToExtensionSettings"}(qv||(qv={})),function(e){e.IsCached="IsCached",e.FetchByNetwork="FetchByNetwork",e.TotalPluginCount="TotalPluginCount",e.TypeOfOperation="TypeOfOperation",e.TypeOfAuthFlow="TypeOfAuthFlow",e.IsAuthFlowAutomatic="isAuthFlowAutomatic",e.PluginType="PluginType",e.SelectedPluginCount="SelectedPluginsCount",e.UnselectedPluginCount="UnselectedPluginsCount",e.UnsupportedPluginCount="UnsupportedPluginsCount",e.IsPluginIconAvailable="IsPluginIconAvailable",e.IsPluginGroupsAvailable="IsPluginGroupsAvailable",e.SelectedISVPluginCount="SelectedISVPluginCount",e.TotalISVPluginCount="TotalISVPluginCount",e.TotalMEPluginCount="TotalMEPluginCount",e.SelectedMEPluginCount="SelectedMEPluginCount",e.IsStoreFrontCopilotPluginIdsAvailable="IsStoreFrontCopilotPluginIdsAvailable",e.IsStoreFrontPluginInstallSuccess="IsStoreFrontCopilotPluginInstallationSuccess",e.IsStoreFrontCopilotPluginsAvailable="IsStoreFrontCopilotPluginsAvailable",e.TotalStoreFrontPluginsCount="TotalStoreFrontPluginsCount",e.NewlyInstalledPlugins="NewlyInstalledPlugins"}(Wv||(Wv={})),function(e){e[e.EnablePlugin=0]="EnablePlugin",e[e.DisablePlugin=1]="DisablePlugin"}(Qv||(Qv={})),function(e){e[e.MsgExt=0]="MsgExt",e[e.FirstParty=1]="FirstParty",e[e.Unsupported=2]="Unsupported",e[e.PowerPlatform=3]="PowerPlatform",e[e.DataVerse=4]="DataVerse",e[e.Undefined=5]="Undefined"}(Gv||(Gv={})),function(e){e[e.Default=0]="Default",e[e.UserSettingsForGetSelectedPlugins=1]="UserSettingsForGetSelectedPlugins",e[e.TokenFetchForGetSelectedPlugins=2]="TokenFetchForGetSelectedPlugins",e[e.GetChatsForGetSelectedPlugins=3]="GetChatsForGetSelectedPlugins",e[e.TokenFetchForGetSelectedPluginsFromUserSettings=4]="TokenFetchForGetSelectedPluginsFromUserSettings",e[e.GetUserSettingsUrlForGetSelectedPluginsFromUserSettings=5]="GetUserSettingsUrlForGetSelectedPluginsFromUserSettings"}(Zv||(Zv={}));class Yv{constructor(e,t,n,r){this.tag=e,this.name=t,this.telemetryService=n,this.correlationVector=r,this.scenario=Zv.Default,this.start=Date.now(),this.isTimeout=!1,this.timeoutId=setTimeout((()=>{this.log({type:mv.FY.LogMetric,tag:this.tag,name:this.name,success:mv.YE.Timeout,duration:6e4,diagnosticsData:`Ended with Timeout, Scenario: ${this.scenario}`,correlationVector:this.correlationVector}),this.isTimeout=!0}),6e4)}setScenario(e){this.scenario=e}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:mv.FY.LogMetric,tag:this.tag,name:this.name,success:mv.YE.Successful,duration:n,correlationVector:t||this.correlationVector}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isTimeout){const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{type:mv.FY.LogMetric,tag:this.tag,name:this.name,success:mv.YE.Failure,duration:n,correlationVector:t||this.correlationVector}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}class Kv{constructor(e,t,n,r,s,i){var a;if(this.dataProvider=e,this.plugin=t,this.addPlugin=n,this.removePlugin=r,this.isNewlyInstalled=s,this.telemetryService=i,t.isEnabled){let e;switch(t.autoEnabledSystemMessageType){case pv.UserInstalled:e="UserInstalledAutoEnabled";break;case pv.TenantInstalled:e="TenantInstalledAutoEnabled";break;default:e=void 0}null===(a=this.addPlugin)||void 0===a||a.call(this,t,e)}}onToggle(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n;this.telemetryService&&this.telemetryService.LogPluginToggleClicked&&this.telemetryService.LogPluginToggleClicked(),this.plugin.isEnabled=e,e?null===(t=this.addPlugin)||void 0===t||t.call(this,this.plugin,"UserToggle"):null===(n=this.removePlugin)||void 0===n||n.call(this,this.plugin,"UserToggle"),yield this.dataProvider.setPlugin(this.plugin)}))}}class Jv extends Kv{constructor(e,t,n,r,s,i){super(e,t,n,r,s,i),this.plugin=t,this.addPlugin=n,this.removePlugin=r,this.isNewlyInstalled=s,this.telemetryService=i}onInstall(){throw new Error("Method not implemented.")}}class Xv extends Kv{constructor(e,t,n,r,s,i){super(e,t,n,r,s,i),this.plugin=t,this.addPlugin=n,this.removePlugin=r,this.isNewlyInstalled=s,this.telemetryService=i}onInstall(){throw new Error("Method not implemented.")}}class $v extends Kv{constructor(e,t,n,r,s,i){super(e,t,n,r,s,i),this.plugin=t,this.addPlugin=n,this.removePlugin=r,this.isNewlyInstalled=s,this.telemetryService=i}onInstall(){throw new Error("Method not implemented.")}}var eb=n(32034),tb=n(76517),nb=n(61630),rb=n(31406),sb=n(50698);let ib=0;class ab extends Kv{constructor(e,t,n,r,s,i,a,o,l){super(t,e,s,i),this.plugin=e,this.dataProvider=t,this.authActivityProvider=n,this.appService=r,this.addPlugin=s,this.removePlugin=i,this.telemetryService=a,this.correlationVector=o,this.isNewlyInstalled=l,this.pluginInfoForLogging="",this.authActivityProvider&&(this.authRuntime=new eb.B(this.authActivityProvider)),this.pluginInfoForLogging=function(e){var t;return(null!==(t=e.titleId)&&void 0!==t?t:"").startsWith("P_")}(e)?`, PluginId: ${this.plugin.id}, PluginName: ${this.plugin.name}, PluginSource: ${this.plugin.source}`:e.titleId?", LOB Plugin":", TitleId not found"}handleAuthLinkClick(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t;const n=null===(t=this.plugin.authRequest)||void 0===t?void 0:t.type;try{"silentAuth"!==n&&ib++;const t=yield this.executeAuthRequest(!1);this.updatePluginStatus(t,e)}catch(e){}"silentAuth"!==n&&ib>0&&ib--}))}onToggle(e,t,n){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var r,s,i;this.telemetryService&&this.telemetryService.LogPluginToggleClicked&&this.telemetryService.LogPluginToggleClicked();try{if(!e||"AtMention"===n)return void this.toggleAndUpdatePluginStatus("processed",e,t);if(!this.authRuntime||!this.plugin.metaOSAppId){const n=this.authRuntime?"metaOSAppId is undefined":"AuthRuntime is undefined";return null===(r=this.telemetryService)||void 0===r||r.LogError({type:mv.FY.LogError,tag:mv.m2.MsgExtViewModel,name:mv.ru.onToggle,message:mv.FG.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${n}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),void this.toggleAndUpdatePluginStatus("processed",e,t)}this.updatePluginStatus("processing",t),this.plugin.authRequest=yield this.getAuthRuntimeRequest();const s=yield this.executeAuthRequest(!0);if("pendingAuth"===s&&0===ib)return this.toggleAndUpdatePluginStatus(s,e,t),void(yield this.handleAuthLinkClick(t));this.toggleAndUpdatePluginStatus(s,e,t)}catch(n){null===(s=this.telemetryService)||void 0===s||s.LogError({type:mv.FY.LogError,tag:mv.m2.MsgExtViewModel,name:mv.ru.onToggle,message:mv.FG.AuthFlowFailedOnPluginToggle,diagnosticsData:`Error: Error occurred in the auth flow on plugin toggle. ErrorMessage: ${(null==n?void 0:n.message)||n}${this.pluginInfoForLogging}`,correlationVector:this.correlationVector}),"processed"===(null===(i=this.plugin)||void 0===i?void 0:i.status)&&this.plugin.isEnabled===e||this.toggleAndUpdatePluginStatus("processed",e,t)}}))}executeAuthRequest(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s;if(this.plugin.authRequest){const i=new Yv(mv.yx.AuthActivity,mv.xe.AuthActivity,this.telemetryService),a={};try{switch(this.plugin.authRequest.type){case"botInvoke":a[mv.vP.TypeOfAuthFlow]=mv._$.BotInvokeForAuthCheck;break;case"silentAuth":a[mv.vP.TypeOfAuthFlow]=mv._$.SilentAuth;break;case"auth":a[mv.vP.TypeOfAuthFlow]=mv._$.Auth;break;case"config":a[mv.vP.TypeOfAuthFlow]=mv._$.Config}a[mv.vP.isAuthFlowAutomatic]=e?1:0;const o=yield null===(t=this.authRuntime)||void 0===t?void 0:t.execute(this.plugin.authRequest);if(o)return i.logMetricEnd({props:a,message:mv.FG.None,diagnosticsData:`Auth request executed successfully${this.pluginInfoForLogging}`},this.correlationVector),this.plugin.authRequest=(0,tb.XW)(this.plugin.authRequest,o),"auth"===(null===(n=this.plugin.authRequest)||void 0===n?void 0:n.type)||"config"===(null===(r=this.plugin.authRequest)||void 0===r?void 0:r.type)||"silentAuth"===(null===(s=this.plugin.authRequest)||void 0===s?void 0:s.type)?"pendingAuth":"processed";i.logMetricEndWithError({props:a,message:mv.FG.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: AuthSDK execute returned undefined response${this.pluginInfoForLogging}`},this.correlationVector)}catch(e){if(i.logMetricEndWithError({props:a,message:mv.FG.ErrorResponse,diagnosticsData:`Error: Failed to execute auth request, ErrorMessage: ${(null==e?void 0:e.message)||JSON.stringify(e)}${this.pluginInfoForLogging}`},this.correlationVector),(null==e?void 0:e.message)===rb.$){const e=this.plugin.authRequest;return e&&(e.isSilent=!0,this.plugin.authRequest=e),"pendingAuth"}return Promise.reject(`Could not execute auth request as ${e.message||e}`)}}return Promise.reject("Could not execute auth request as auth request is not available")}))}getAuthRuntimeRequest(){return(0,y.__awaiter)(this,void 0,void 0,(function*(){if(!this.appService||!this.plugin.metaOSAppId)return Promise.reject("AppId or serviceProvider is undefined");const e=yield this.getAppDefinition(this.appService,this.plugin.metaOSAppId);if(!e)return Promise.reject("Could not find app definition");if(!(0,sb.V)(e))return Promise.reject("Could not find command with initial run enabled");const t=this.getBotInvokeRequest(e);if(!t)return Promise.reject("Could not find bot invoke request");const n=Object.assign(Object.assign({type:"botInvoke"},t),{onActivityCompletion:this.getOnAuthActivityCompletion(this.plugin)});return Promise.resolve(n)}))}getOnAuthActivityCompletion(e){return t=>{if("object"==typeof t){if(e.authRequest){const n=(0,nb.u)(t);if("auth"===n||"config"===n)return e.authRequest=(0,tb.XW)(e.authRequest,t),e.status="pendingAuth",Promise.resolve(!0)}return Promise.resolve(!1)}return Promise.resolve(!1)}}onInstall(){throw new Error("Method not implemented.")}getAppDefinition(e,t){return(0,y.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.getApp({id:t});if(!n||!n.appDefinition&&!n.titleInfo)return;let r;return(null==n?void 0:n.appDefinition)?r=n.appDefinition:(null==n?void 0:n.titleInfo)&&(r=(0,Oe.P)(n.titleInfo)),r}))}getBotInvokeRequest(e){var t,n,r,s,i,a,o,l;const c=null!==(r=null===(n=null===(t=e.bots)||void 0===t?void 0:t[0])||void 0===n?void 0:n.id)&&void 0!==r?r:null===(i=null===(s=e.inputExtensions)||void 0===s?void 0:s[0])||void 0===i?void 0:i.botId,u=this.plugin.metaOSAppId,d=null===(l=null===(o=null===(a=e.inputExtensions)||void 0===a?void 0:a[0].commands)||void 0===o?void 0:o[0])||void 0===l?void 0:l.id;if(!c||!u||!d){throw new Error(`Could not construct bot invoke request. ErrorMessage: ${c?u?"CommandId is undefined":"AppId is undefined":"BotId is undefined"}`)}return{appId:u,botId:c,requestBody:{name:"composeExtension/query",appName:e.name,value:{commandId:d,parameters:[{name:"initialRun",value:"true"}],queryOptions:{skip:0,count:25}}}}}toggleAndUpdatePluginStatus(e,t,n){const r=Object.create(null,{onToggle:{get:()=>super.onToggle}});return(0,y.__awaiter)(this,void 0,void 0,(function*(){yield r.onToggle.call(this,t),this.updatePluginStatus(e,n),this.telemetryService&&this.telemetryService.LogPluginToggled&&this.telemetryService.LogPluginToggled()}))}updatePluginStatus(e,t){return(0,y.__awaiter)(this,void 0,void 0,(function*(){this.plugin.status=e,null==t||t()}))}}class ob extends Kv{constructor(e,t,n,r,s,i){super(e,t,n,r,s,i),this.plugin=t,this.addPlugin=n,this.removePlugin=r,this.isNewlyInstalled=s,this.telemetryService=i}onInstall(){throw new Error("Method not implemented.")}}class lb{constructor(e,t,n){this.dataProvider=e,this.plugin=t,this.telemetryService=n}onInstall(){return(0,y.__awaiter)(this,void 0,void 0,(function*(){return this.telemetryService&&this.telemetryService.LogPluginSuggestedItemClicked&&this.telemetryService.LogPluginSuggestedItemClicked(),this.dataProvider.installStoreFrontPlugin(this.plugin)}))}}class cb{constructor(e,t,n,r,s,i,a,o){this.dataProvider=e,this.authActivityProvider=t,this.addPlugin=n,this.removePlugin=r,this.telemetryService=s,this.appService=i,this.enlistPlugins=a,this.showSystemMessagesForAutoEnabledPlugins=o,this.supportedPluginTypes=["MsgExt","FirstParty","PowerPlatform","DataVerse","OpenAIPlugin","Undefined"]}getPlugins(e,t,n,r,s){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var i,a;if(n)return this.getPluginsGrouped(e,t,r,s);const o=new Yv(mv.yx.GetPluginsState,mv.xe.GetPlugins,this.telemetryService),l={};try{const n=this.getSupportedPluginTypes(e),r=yield null===(i=this.dataProvider)||void 0===i?void 0:i.getPlugins(t);null===(a=this.enlistPlugins)||void 0===a||a.call(this,r);let c=0,u=0,d=0,h=0,p=0,g=0,m=0,f=0,y=0,v=0;const b=null==r?void 0:r.reduce(((e,r)=>{var i;if(r.type&&n.includes(r.type)){const n=!!r.metaOSAppId&&!!s&&s===r.metaOSAppId;switch(r.isEnabled?c++:u++,(null===(i=r.titleId)||void 0===i?void 0:i.startsWith("P_"))&&(d++,r.isEnabled&&h++),n&&v++,r.type){case"MsgExt":p++,r.isEnabled&&g++,e.push(new ab(r,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t,n));break;case"FirstParty":e.push(new Xv(this.dataProvider,r,this.addPlugin,this.removePlugin,n,this.telemetryService));break;case"PowerPlatform":m++,r.isEnabled&&f++,this.logPowerPlatformPluginTelemetry(r,t),""!==r.source&&(y++,e.push(new ob(this.dataProvider,r,this.addPlugin,this.removePlugin,n,this.telemetryService)));break;case"DataVerse":e.push(new Jv(this.dataProvider,r,this.addPlugin,this.removePlugin,n,this.telemetryService));break;case"OpenAIPlugin":case"Undefined":e.push(new $v(this.dataProvider,r,this.addPlugin,this.removePlugin,n,this.telemetryService))}}return e}),[]);return l[mv.vP.TotalPluginCount]=b.length,l[mv.vP.TotalISVPluginCount]=d,l[mv.vP.SelectedPluginCount]=c,l[mv.vP.UnselectedPluginCount]=u,l[mv.vP.UnsupportedPluginCount]=r.length-b.length,l[mv.vP.SelectedISVPluginCount]=h,l[mv.vP.TotalMEPluginCount]=p,l[mv.vP.SelectedMEPluginCount]=g,l[mv.vP.TotalPPConnectorsCount]=m,l[mv.vP.SelectedPPConnectorsCount]=f,l[mv.vP.ConnectedPPConnectorsCount]=y,l[mv.vP.NewlyInstalledPlugins]=v,o.logMetricEnd({props:l},t),this.updateUserSettingsIfSystemMessageIsShown(b,t),this.shuffleNewlyInstalledVMToTop(b)}catch(e){o.logMetricEndWithError({props:l,message:mv.FG.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}logPowerPlatformPluginTelemetry(e,t){var n;const r={};r[mv.vP.MetaOSAppId]=e.metaOSAppId,r[mv.vP.PowerPlatformConnectionExists]=""!==e.source,r[mv.vP.PluginId]=e.id,null===(n=this.telemetryService)||void 0===n||n.LogInfo({type:mv.FY.LogInfo,tag:mv.m2.PluginDataProvider,name:mv.ru.getPlugins,props:r,correlationVector:t})}getPluginsGrouped(e,t,n,r){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var s,i,a,o,l,c;const u=new Yv(mv.yx.GetPluginsState,mv.xe.GetPlugins,this.telemetryService),d={};try{const m=this.getSupportedPluginTypes(e),f=[],v=yield null===(l=this.dataProvider)||void 0===l?void 0:l.getPluginsGrouped(t,n),b=v.map((e=>e.plugins.map((t=>{var n;return Object.assign(Object.assign({},t),{icon:null!==(n=e.groupHeaderPlugin.icon)&&void 0!==n?n:t.icon})})))).reduce(((e,t)=>e.concat(t)),[]);null===(c=this.enlistPlugins)||void 0===c||c.call(this,b);let C=0,w=0,S=0,E=0,x=0,I=0,A=0,P=0,k=0,T=0,D=0;try{for(var h,p=!0,g=(0,y.__asyncValues)(v);!(s=(h=yield g.next()).done);p=!0){o=h.value,p=!1;const e=o,n=e.groupHeaderPlugin;if(n.type&&m.includes(n.type)){const s=!!n.metaOSAppId&&!!r&&r===n.metaOSAppId;let i,a=0,o=0,l=0,c=0,u=0,d=0;if("PowerPlatform"===n.type)i=new ob(this.dataProvider,n,this.addPlugin,this.removePlugin,s,this.telemetryService);else i=new Xv(this.dataProvider,n,this.addPlugin,this.removePlugin,s,this.telemetryService);const h=e.plugins.reduce(((e,n)=>{var r;switch(T++,n.isEnabled?a++:o++,(null===(r=n.titleId)||void 0===r?void 0:r.startsWith("P_"))&&(l++,n.isEnabled&&c++),n.type){case"MsgExt":u++,n.isEnabled&&d++,e.push(new ab(n,this.dataProvider,this.authActivityProvider,this.appService,this.addPlugin,this.removePlugin,this.telemetryService,t,s));break;case"FirstParty":e.push(new Xv(this.dataProvider,n,this.addPlugin,this.removePlugin,s,this.telemetryService));break;case"PowerPlatform":A++,n.isEnabled&&P++,this.logPowerPlatformPluginTelemetry(n,t),""!==n.source&&(k++,e.push(new ob(this.dataProvider,n,this.addPlugin,this.removePlugin,s,this.telemetryService)));break;case"DataVerse":e.push(new Jv(this.dataProvider,n,this.addPlugin,this.removePlugin,s,this.telemetryService));break;case"OpenAIPlugin":case"Undefined":e.push(new $v(this.dataProvider,n,this.addPlugin,this.removePlugin,s,this.telemetryService))}return e}),[]);s&&D++,C+=a,w+=o,S+=l,E+=c,x+=u,I+=d,f.push({groupPlugins:h,parentPlugin:i})}}}catch(e){i={error:e}}finally{try{p||s||!(a=g.return)||(yield a.call(g))}finally{if(i)throw i.error}}d[mv.vP.TotalPluginCount]=f.length,d[mv.vP.TotalISVPluginCount]=S,d[mv.vP.SelectedPluginCount]=C,d[mv.vP.UnselectedPluginCount]=w,d[mv.vP.UnsupportedPluginCount]=T-f.length,d[mv.vP.SelectedISVPluginCount]=E,d[mv.vP.TotalMEPluginCount]=x,d[mv.vP.SelectedMEPluginCount]=I,d[mv.vP.TotalPPConnectorsCount]=A,d[mv.vP.SelectedPPConnectorsCount]=P,d[mv.vP.ConnectedPPConnectorsCount]=k,d[mv.vP.NewlyInstalledPlugins]=D,u.logMetricEnd({props:d},t);const M=f.reduce(((e,t)=>e.concat(t.groupPlugins)),[]);return this.updateUserSettingsIfSystemMessageIsShown(M,t),this.shuffleNewlyInstalledVMGroupToTop(f)}catch(e){u.logMetricEndWithError({props:d,message:mv.FG.PluginFetchFailed,diagnosticsData:`Error: ${e.message||e}`},t)}}))}setPlugin(e,t,n){return(0,y.__awaiter)(this,void 0,void 0,(function*(){const r=new Yv(mv.yx.SetPlugins,mv.xe.SetPlugins,this.telemetryService),s={};let i,a;try{if(i=yield this.getPluginsGrouped(void 0,void 0,"cache-first"),a=(null!=i?i:[]).map((e=>e.groupPlugins)).reduce(((e,t)=>e.concat(t)),[]).find((t=>t.plugin.id===e)),a||(i=yield this.getPluginsGrouped(void 0,void 0,"network-only"),s[mv.vP.FetchByNetwork]=1,a=(null!=i?i:[]).map((e=>e.groupPlugins)).reduce(((e,t)=>e.concat(t)),[]).find((t=>t.plugin.id===e))),s[mv.vP.TotalPluginCount]=(null!=i?i:[]).length,a)return yield a.onToggle(t,void 0,n),void r.logMetricEnd({props:s,message:mv.FG.SetPluginsHandled});r.logMetricEndWithError({props:s,message:mv.FG.SetPluginsFailed,diagnosticsData:`Error: Could not find plugin with id: ${e}`})}catch(e){r.logMetricEndWithError({props:s,message:mv.FG.SetPluginsFailed,diagnosticsData:`Error: ${e.message||e}`})}}))}getStoreFrontPlugins(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t;const n=new Yv(mv.yx.GetStoreFrontPluginsState,mv.xe.GetStoreFrontPlugins,this.telemetryService),r={};try{const s=yield null===(t=this.dataProvider)||void 0===t?void 0:t.getStoreFrontPlugins(e),i=[];return s.forEach((e=>{const t=new lb(this.dataProvider,e,this.telemetryService);i.push(t)})),r[mv.vP.TotalStoreFrontPluginsCount]=i.length,n.logMetricEnd({props:r},e),i}catch(t){n.logMetricEndWithError({props:r,message:mv.FG.StoreFrontPluginsFetchFailed,diagnosticsData:`Error: ${t.message||t}`},e)}}))}getSupportedPluginTypes(e){return e?Uv(this.supportedPluginTypes,e):this.supportedPluginTypes}shuffleNewlyInstalledVMToTop(e){return[...e.filter((e=>"BingWebSearch"===e.plugin.id)),...e.filter((e=>e.isNewlyInstalled&&"BingWebSearch"!==e.plugin.id)),...e.filter((e=>!e.isNewlyInstalled&&"BingWebSearch"!==e.plugin.id))]}shuffleNewlyInstalledVMGroupToTop(e){return[...e.filter((e=>"BingWebSearch"===e.parentPlugin.plugin.id)),...e.filter((e=>e.parentPlugin.isNewlyInstalled&&"BingWebSearch"!==e.parentPlugin.plugin.id)),...e.filter((e=>!e.parentPlugin.isNewlyInstalled&&"BingWebSearch"!==e.parentPlugin.plugin.id))]}updateUserSettingsIfSystemMessageIsShown(e,t){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var n,r;if(!1===(null===(n=this.showSystemMessagesForAutoEnabledPlugins)||void 0===n?void 0:n.call(this)))return;let s=!1;e.forEach((e=>{const t=e.plugin;s=s||t.autoEnabledSystemMessageType===pv.UserInstalled||t.autoEnabledSystemMessageType===pv.TenantInstalled,t.autoEnabledSystemMessageType=void 0})),s&&(yield null===(r=this.dataProvider)||void 0===r?void 0:r.updateUserSettingsPostSystemMessageDisplayed(t))}))}}var ub=n(66256),db=n(72672);class hb{constructor(e,t,n,r,s,i,a,o,l=!1,c=Df.u1,u,d){this.getTransformFileSuggestionText=()=>{if(this.zqmProps)for(const e of this.zqmProps.promptSuggestionList)if(e.shouldLaunchCIQOnSelection)return e.suggestionText;return Df.u1},this.componentId=d,this.chatInputRef=e,this.handleSubmit=t,this.isExecuting=n,e.current?.getChatEditorService&&(this.editorService=e.current?.getChatEditorService()),this.handleZQMButtonClick=this.handleZQMButtonClick.bind(this),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),this.transformFilePlaceholderText=r,this.isHVCAppChatV2Enabled=s??!1,this.hvcPromptStringsList=i??[],this.telemetryLoggerUtils=Wf.j.getInstance(this.componentId),this.selectedCopilotId=a??"",o&&(this.setChatInputZQMRef=o),this.wasChatPaneAutoOpened=l,this.userDisplayName=c,this.handleZQMAgentInvocation=u}async handleZQMButtonClick(e,t){if(this.isExecuting)return;(0,Qf.$w)(Df.u1),zf.A.getInstance(this.componentId).sendLoggingEventToClient(Tf.Yk.ZQMButtonItemClicked);const n=this.zqmProps.promptSuggestionList.find((e=>e.suggestionText==t));if(n&&this.handleZQMAgentInvocation&&this.handleZQMAgentInvocation(n?.agentInvocationProps),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMButtonV2Clicked},{key:Pf.h3.ChatEventParameters,value:n?.source??$n.L.Static},{key:Pf.h3.SelectedSwitcherMenuItemId,value:this.selectedCopilotId}]),n?.suggestionId&&n?.suggestionId!==Df.u1&&this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMClickedPrompt},{key:Pf.h3.ChatEventParameters,value:n?.suggestionId}]),n?.notifyClientOnZQMClicked?.(n),n?.promptClickHandledByClient)return(0,qf.cY)("ZQM Prompt click handled by client"),this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMClickHandledByClient},{key:Pf.h3.ChatEventParameters,value:n?.source??$n.L.Static},{key:Pf.h3.SelectedSwitcherMenuItemId,value:this.selectedCopilotId}]),void n?.promptClickHandledByClient?.(e,n);let r=e,s=Df.u1;if(this.setChatInputZQMRef&&this.setChatInputZQMRef(!0),n?.shouldSubmitQueryOnClick)return this.isHVCAppChatV2Enabled&&(r=r.replace(/{|}/g,"")),void this.handleSubmit({text:r,telemetryData:Pf.a5.ZQMButtonClicked,requestMetaData:n?.requestMetaData});if((n.shouldLaunchCIQOnSelection&&n.scopedEntity===Tf.ck.File||t===this.transformFileSuggestionText)&&(s=this.transformFilePlaceholderText),!this.editorService&&this.chatInputRef.current?.getChatEditorService&&(this.editorService=this.chatInputRef.current?.getChatEditorService()),n?.shouldLaunchCIQOnSelection&&n?.scopedEntity===Tf.ck.CopilotPlugin)this.chatInputRef.current?.setInputText(ub.Tb);else{if((n.shouldLaunchCIQOnSelection&&n.scopedEntity||t===this.transformFileSuggestionText)&&this.editorService){const e=n.scopedEntity??Tf.ck.File;(0,qf.cY)("scopedEntity",e),this.editorService.setEntityScope(e),n.unSupportedEntities&&(this.editorService.setUnsupportedEntities(n.unSupportedEntities),(0,qf.cY)("UnSupportedEntites:",n.unSupportedEntities))}this.chatInputRef.current?.setInputText(r,!0),this.chatInputRef.current?.setFocus(),n?.shouldLaunchImageInputMenuOnSelection&&this.chatInputRef.current?.openImageInputMenu&&this.chatInputRef.current.openImageInputMenu(),(n.shouldLaunchCIQOnSelection||t===this.transformFileSuggestionText)&&this.editorService&&setTimeout((()=>this.chatInputRef.current?.updateInputText(Df.O8,Zf.v.InsertAtCursor)),1),this.chatInputRef.current?.setGhostText(s)}}getProps(e,t){return this.zqmProps=(0,db.SF)(e,t),this.transformFileSuggestionText=this.getTransformFileSuggestionText(),{showBranding:this.zqmProps.showBranding,brandingInfo:this.zqmProps.brandingInfo,promptSuggestions:this.zqmProps.promptSuggestionList.map((e=>({promptSuggestionCategory:e.suggestionCategory,promptSuggestionText:e.suggestionText,promptSuggestionId:e.suggestionId??Df.u1,isDisabled:e.isDisabled??!1,iconRegular:e.iconRegular,iconUrl:e.iconUrl,iconUrlName:e.iconUrlName,source:e.source??$n.L.Static,agentInvocationProps:e.agentInvocationProps,telemetryData:e.telemetryData,isHidden:e.isHidden,requestMetaData:e?.requestMetaData}))),isHVCAppChatV2Enabled:this.isHVCAppChatV2Enabled,handleButtonClick:this.handleZQMButtonClick,hvcPromptStringsList:this.hvcPromptStringsList,showRefreshButton:this.zqmProps?.showRefreshButton,handleRefreshButtonClick:async()=>{this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMRefreshButtonClicked}]),this.zqmProps?.handleRefreshButtonClick?.()},wasChatPaneAutoOpened:this.wasChatPaneAutoOpened,userDisplayName:this.userDisplayName}}}var pb=n(3612),gb=n(39054);class mb{constructor(){this.getProps=e=>({handleRestrictiveMsgDismissClick:e})}}const fb=class{getDebugSectionProps(e,t,n,r,s,i,a,o,l,c,u,d,h,p,g,m,f,y,v,b,C,w,S){return{conversationId:t,getLogs:e,telemetryData:n,sessionId:r,conversationLogObject:s,debugMessageInfoObject:i,showDebugInfoMessage:a,setShowDebugInfoOnMessage:o,chatPaneLoadTime:l,chatInputLoadTime:c,sydneyConversationObject:u,augloopKustoQueryURL:d,clientKustoQueryURL:h,appName:p,appPlatform:g,sdxVersion:m,sessionKey:f,chatHistoryLoadTime:y,taskPaneLoadTime:v,isCipTreeDebugEnabled:b,cipTree:C,stkLogObject:w,ashaLogObject:S}}};var yb=n(56369);const vb=(0,mt.n)({deleteAllButton:{width:"100%"}}),bb={deleteAllChatHistoryButtonTextDesc:ut.nyS},Cb=N.memo((({onClick:e,customStyles:t,customIconStyles:n})=>{const r=(0,it.kQ)(bb);return N.createElement(ct.$,{className:(0,Bt.z)(ga().root,vb().deleteAllButton,t),icon:N.createElement(yb.h7G,{className:n}),onClick:e,"aria-label":r.deleteAllChatHistoryButtonTextDesc()},r.deleteAllChatHistoryButtonTextDesc())}));var wb=n(21705);const Sb=N.forwardRef((({onClick:e,customStyles:t,customIconStyles:n},r)=>{const s=(0,it.Lh)(ut.wYo);return N.createElement(Jt.m,{content:s,relationship:"label",withArrow:!0},N.createElement(ct.$,{ref:r,className:(0,Bt.z)(ga().root,ma().root,t),icon:N.createElement(_i.nUb,{className:n}),onClick:e}))})),Eb=N.memo(Sb),xb={newChatButtonTextDesc:ut.xoo,newConversationButtonTextDesc:ut.kdH,newConversationAriaLabelDesc:ut.yxV},Ib=(N.memo((({onClick:e,customStyles:t,customIconStyles:n})=>{const r=(0,it.kQ)(xb);return N.createElement(ct.$,{className:(0,Bt.z)(ga().root,ma().root,t),icon:N.createElement(_i.Eqz,{className:n}),onClick:e,"aria-label":r.newConversationAriaLabelDesc()})})),N.memo((({onClick:e,customStyles:t,customIconStyles:n})=>{const r=(0,it.kQ)(xb);return N.createElement(ct.$,{className:(0,Bt.z)(ga().root,t),icon:N.createElement(_i.Eqz,{className:n}),onClick:e,"aria-label":r.newConversationAriaLabelDesc(),size:"small"},r.newChatButtonTextDesc())}))),Ab={Root:{justifyContent:"space-between",...gt.Pt.padding("0px","16px","10px","0px")},label:{...gt.Pt.padding("3px")},icon:{fontSize:"16px"},toolbarGroup:{display:"flex"}},Pb=(0,mt.n)(Ab),kb=N.memo((({title:e,backButtonProps:t,newConversationButtonProps:n})=>{const r=Pb(),s=(0,N.useRef)(null),i=(0,Ot.Y$)(),a=(0,it.Lh)(ut.kHI);return(0,N.useEffect)((()=>{s.current&&s.current.focus()}),[]),N.createElement(Cs.M,{"aria-label":a,className:r.Root},N.createElement(ws.$,{role:"presentation",className:r.toolbarGroup},N.createElement(Eb,{ref:s,customIconStyles:r.icon,onClick:t.onClick}),N.createElement(wb.J,{className:r.label,size:"large"},e)),i.newChatInHeaderControl?null:N.createElement(ws.$,{role:"presentation"},N.createElement(Ib,{customIconStyles:r.icon,onClick:n.onClick})))})),Tb=N.memo(kb);var Db=n(74160),Mb=n(14779),Lb=n(57760),Rb=n(46962),Nb=n(41612);const Ob=(0,pt.Q)(ft.tR),_b={LoadingSkeletonStyle:{width:"inherit",alignItems:"center",display:"flex",paddingTop:"5px",paddingBottom:"5px",position:"relative",...gt.Pt.gap("5px")},EmptyConversationListTextStyle:{justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column",paddingTop:"30px",paddingBottom:"30px"},TreeItemStyle:{paddingLeft:"12px","& > div:first-child":{...gt.Pt.overflow("hidden"),textOverflow:"ellipsis",whiteSpace:"nowrap"}},TreeItemButtonStyle:{"@media (forced-colors: none)":{"&:hover":{backgroundColor:Ob.colorNeutralBackground1Hover},"&:hover:active":{backgroundColor:Ob.colorNeutralBackground3Pressed}}},VisuallyHiddenStyle:{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}},Bb=(0,mt.n)(_b),Fb={chatHistoryDeleteButtonAriaLabel:ut.EYm,conversationListErrorStateText:ut.Tov,conversationListErrorStateTitle:ut.gVZ,emptyConversationListText:ut.Zze,chatHistoryListSecondaryButtonAriaLabel:ut.Ovj},Ub={deletedConversationAnnouncement:ut.a3q},Hb=N.memo((({isInErrorState:e,isChatHistoryListLoading:t,conversationOnClick:n,deleteOnClick:r,conversations:s})=>{const i=Bb(),a=(0,it.kQ)(Fb),o=(0,it.mY)(Ub),l=N.useRef([]),[c,u]=N.useState(null),d=N.useRef(null);return N.createElement(Db.P,null,t?N.createElement(Mb.E,{role:"menuitem"},N.createElement("div",{className:i.LoadingSkeletonStyle},N.createElement(Lb.H,{shape:"circle",size:16}),N.createElement(Lb.H,{shape:"rectangle",size:16})),N.createElement("div",{className:i.LoadingSkeletonStyle},N.createElement(Lb.H,{shape:"circle",size:16}),N.createElement(Lb.H,{shape:"rectangle",size:16})),N.createElement("div",{className:i.LoadingSkeletonStyle},N.createElement(Lb.H,{shape:"circle",size:16}),N.createElement(Lb.H,{shape:"rectangle",size:16}))):e?N.createElement("div",{className:i.EmptyConversationListTextStyle},N.createElement("div",null,N.createElement(wb.J,{size:"large"},a.conversationListErrorStateTitle())),N.createElement("div",null,N.createElement(wb.J,null,a.conversationListErrorStateText()))):0===s.length?N.createElement(wb.J,{className:i.EmptyConversationListTextStyle},a.emptyConversationListText()):s.map(((e,t)=>N.createElement(Rb.y,{key:`conversation-history-${t}`,itemType:"leaf",onClick:()=>n(e),"aria-label":`${e.conversationName}. ${e.timeOfCreation}. ${a.chatHistoryListSecondaryButtonAriaLabel()}`,tabIndex:0===t?0:-1,ref:e=>l.current[t]=e,onKeyDown:e=>((e,t)=>{l.current&&("ArrowDown"===e.key&&t<l.current.length-1?l.current[t+1]?.focus():"ArrowUp"===e.key&&t>0&&l.current[t-1]?.focus())})(e,t)},N.createElement(Nb.c,{className:i.TreeItemStyle,aside:N.createElement("span",null,e.timeOfCreation),actions:N.createElement(Jt.m,{content:a.chatHistoryDeleteButtonAriaLabel(),relationship:"label",withArrow:!0},N.createElement(ct.$,{key:`delete-conversation-${t}`,className:i.TreeItemButtonStyle,onClick:n=>((e,t,n)=>{if(r(t),u(o.deletedConversationAnnouncement({conversationName:t.conversationName})),setTimeout((()=>u(null)),2e3),e.stopPropagation(),l.current.length>1){const e=n>=l.current.length-1?n-1:n;e>=0&&l.current[e]&&l.current[e]?.focus()}})(n,e,t),icon:N.createElement(_i.Sz$,null),"aria-label":`${a.chatHistoryDeleteButtonAriaLabel()}`,appearance:"subtle"}))},N.createElement("span",null,e.conversationName))))),N.createElement("div",{ref:d,"aria-live":"polite",className:i.VisuallyHiddenStyle},c))})),zb={Root:{display:"flex",flexDirection:"column",...gt.Pt.padding("0px","3px"),justifyContent:"space-between",height:"100%"},ChatHistoryPanelBodyStyle:{overflowY:"auto",flexGrow:1,...gt.Pt.padding("5px",Dr.nT)},DeleteButtonContainerStyle:{alignSelf:"flex-end",width:"95%",...gt.Pt.margin("10px","auto")},DeprecationWarningWrapper:{...gt.Pt.padding("12px","16px"),...gt.Pt.borderRadius("8px"),marginBottom:"16px"}},jb=(0,mt.n)(zb),Vb={chatHistoryDeprecationWarningText:ut.uEZ},qb=N.forwardRef((({headerProps:e,conversationListProps:t,deleteButtonProps:n,deprecationProps:r},s)=>{const i=jb(),a=(0,it.Lh)(ut.ZlT),o=(0,it.mY)(Vb);return N.createElement("div",{className:i.Root},N.createElement(Tb,{title:e.title,backButtonProps:e.backButtonProps,newConversationButtonProps:e.newConversationButtonProps}),N.createElement("div",{ref:s,className:i.ChatHistoryPanelBodyStyle,"aria-label":a},r?.shouldShowDeprecationMessage&&(()=>{const e=r.deprecationDate??"2025-12-31",t=new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"});return N.createElement("div",{className:i.DeprecationWarningWrapper},N.createElement(Ni.n,{intent:"warning"},N.createElement(Mi.R,null,o.chatHistoryDeprecationWarningText({deprecationDate:t}))))})(),N.createElement(Hb,{isChatHistoryListLoading:t.isChatHistoryListLoading,conversationOnClick:t.conversationOnClick,deleteOnClick:t.deleteOnClick,conversations:t.conversations,isInErrorState:t.isInErrorState})),N.createElement("div",{className:i.DeleteButtonContainerStyle},N.createElement(Cb,{onClick:n.onClick})))})),Wb=N.memo(qb);var Qb=n(37602);const Gb={chatHistoryPanelTitle:_f.k8,emptyChatName:_f.hD},Zb=e=>{const{setChatLog:t,currentChatId:n,setIsExecuting:r,setLoadingComponentProps:s,suggestionPillsBuilderRef:i,createAndSubmitChatHistorySignal:a,resetToNewConversation:o,setChatHistoryMenuData:l,handleChatHistoryPanelClose:c,isSwitchingConversation:u,isChatHistoryMenuLoading:d,chatHistoryMenuData:h,isChatHistoryPanelFetchingMoreChats:p,setIsChatHistoryPanelFetchingMoreChats:g,isEndOfChatHistory:m,isChatHistoryMenuLoadingFailed:f,chatHistoryTelemetryHooks:y,copilotCommunicationHandler:v,currentGptId:b,setCachedSuggestionPillList:C,chatUIProps:w,submitOperation:S,clearOperationListForResubmit:E,setIsSideQuestMode:x,shouldShowDeprecationMessage:I,deprecationDate:A}=e,P=Hf(),k=(0,N.useRef)(null),T=(0,N.useRef)(150),D=(0,Ot.Y$)(),M=(0,Xn.zK)();(0,N.useEffect)((()=>{p&&!m&&(y.setActionStart(Pf.a5.LoadMoreConversations),a({op:gf.S5.GetAllChatsOperation,submitOperation:D?.isALHookEnabled?S:void 0,clearOperationListForResubmit:D.isALHookEnabled?E:void 0}))}),[p]),(0,N.useEffect)((()=>{const e=k.current;return e&&e.addEventListener("scroll",L),()=>{e&&e.removeEventListener("scroll",L),l([])}}),[]),(0,N.useEffect)((()=>{if(y.isMeasuring&&!d&&!p)switch(y.measureTarget.current){case Pf.a5.LoadChatHistoryPanel:y.logChatHistoryActionLatency(Pf.a5.LoadChatHistoryPanel);break;case Pf.a5.LoadMoreConversations:y.logChatHistoryActionLatency(Pf.a5.LoadMoreConversations)}}),[d,p,h]);const L=e=>{!(e.target.scrollHeight-(e.target.scrollTop+e.target.clientHeight)<T.current)||p||m||g(!0)},R=N.useCallback((async()=>{y.setActionStart(Pf.a5.ChatHistoryNewConversationButtonClicked),(0,qf.cY)("Change Topic Button Clicked."),i.current.setSuggestedQnAList([]),C?.([]),w?.suggestionPillsUiProps&&(w.suggestionPillsUiProps.suggestionList=[]),(0,ny.$m)(!0),x(!1),s((e=>({...e,loadingUiStringList:[P[1]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1}))),v.sendEventToClient(Tf.PV.NewChatButtonClicked);const e={gptId:b};await a({op:gf.S5.AddChatOperation,gptInfo:e,submitOperation:D?.isALHookEnabled?S:void 0,clearOperationListForResubmit:D.isALHookEnabled?E:void 0}),r(!0),c(!0,!0)}),[b,i,s,P[1],a]),O=N.useCallback((e=>{if(y.setActionStart(Pf.a5.ChatHistoryConversationClicked),x(!1),n!==e.conversationId){u.current=!0;const t={gptId:e.gptId};if(v.sendEventToClient(Tf.PV.DifferentChatOpened),!((e,t,n)=>{const r=n?.getAgentInfo(e);return r?.isDisabled?!!t:r?e!==t:!!t})(e.gptId,b,M))return(0,qf.cY)(`Chat Clicked for non-GPTs or same gptId. conversation.gptId: ${e.gptId} currentGptId: ${b}`),a({op:gf.S5.GetMessagesOperation,conversationId:e.conversationId,gptInfo:t,submitOperation:D?.isALHookEnabled?S:void 0,clearOperationListForResubmit:D.isALHookEnabled?E:void 0}),s((e=>({...e,loadingUiStringList:[P[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1}))),r(!0),void c(!0,!0);(0,qf.cY)(`Chat Clicked for switching to GPT. conversation.gptId: ${e.gptId} currentGptId: ${b}`),M?.copilotChatConversationSelectedContext?.handleChatHistoryConversationClick(e.gptId,e.conversationId)}c(void 0,!0)}),[n,b,a,s,P[0]]),_=N.useCallback((e=>{a({op:gf.S5.DeleteChatOperation,conversationId:e.conversationId,submitOperation:D?.isALHookEnabled?S:void 0,clearOperationListForResubmit:D.isALHookEnabled?E:void 0}),l(h.filter((t=>t.sessionId!==e.conversationId))),e.conversationId===n&&(x(!1),o(),t([])),y.logChatHistoryActionEvent(Pf.a5.ChatHistoryDeleteButtonClicked)}),[a,h,n]),B=N.useCallback((()=>{y.logChatHistoryActionEvent(Pf.a5.ChatHistoryBackButtonClicked),c(void 0,!1)}),[c]),F=N.useCallback((()=>{y.logChatHistoryActionEvent(Pf.a5.ChatHistoryDeleteAllButtonClicked);const e=v.getHostSettings();let t=Df.zT;if(e.environment===Qb.D.DOD)t=Df.nV;else t=Df.zT;window.open(t,"_blank")}),[]),U=(0,it.kQ)(Gb);return N.createElement(Wb,{ref:k,headerProps:{title:U.chatHistoryPanelTitle(),backButtonProps:{onClick:B},newConversationButtonProps:{onClick:R}},conversationListProps:{isChatHistoryListLoading:d,conversationOnClick:O,deleteOnClick:_,conversations:h.map((e=>({conversationName:e.chatName&&""!==e.chatName?e.chatName:U.emptyChatName(),conversationId:e.sessionId,timeOfCreation:`${String(new Date(e.createTimeUtc).getMonth()+1).padStart(2,"0")}/${String(new Date(e.createTimeUtc).getDate()).padStart(2,"0")}/${new Date(e.createTimeUtc).getFullYear()}`,gptId:e?.gptIdentifier?.id}))),isInErrorState:f},deprecationProps:{shouldShowDeprecationMessage:I??!1,deprecationDate:A??""},deleteButtonProps:{onClick:F}})};class Yb{constructor(){this.getProps=e=>({handlePythonExitAnalysisButtonClick:e})}}class Kb{constructor(){this.getProps=({buttonText:e,icon:t,onClick:n})=>({buttonText:e,icon:t,onClick:n})}}var Jb=n(6304),Xb=n(51181);var $b=n(82938),eC=n(47942),tC=n(73847),nC=n(53638);const rC={root:{...gt.Pt.padding("5px")},collapsed:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box","-webkit-line-clamp":"2","-webkit-box-orient":"vertical",...gt.Pt.padding("5px")}},sC=(0,mt.n)(rC),iC=({handleMsgDismissClick:e,titleText:t,bodyText:n,linkText:r,linkClickHandler:s})=>{const[i,a]=N.useState(!0),o=N.useRef(null),l=N.useRef(null),c=sC(),u=(0,it.kQ)({creditBannerCloseButtonAriaLabel:ut.$aJ}).creditBannerCloseButtonAriaLabel(),d=()=>{a(!i)},h=()=>{s?.(),e?.()};return N.createElement(Ri.y,null,N.createElement(Ni.n,{intent:"warning",ref:o},N.createElement(Fn.E,{className:i?c.collapsed:c.root,ref:l},N.createElement(Mi.R,{role:"alert"},N.createElement(Li.V,null,t),n," ",N.createElement(wi.N,{onClick:h,inline:!0},r))),N.createElement(Oi.Q,{containerAction:N.createElement("div",null,(()=>{const e=l?.current?.scrollHeight,t=o?.current?.clientHeight;if(e&&t)return!!(i&&e===t&&e>50)||e>t})()&&N.createElement(ct.$,{appearance:"transparent",icon:i?N.createElement(Ii.cmU,null):N.createElement(Ii.NaX,null),onClick:d}),N.createElement(ct.$,{appearance:"transparent",icon:N.createElement(cs.Jtj,null),onClick:e,"aria-label":u}))})))};var aC=n(2539),oC=n(5469),lC=n(23359),cC=n(1171),uC=n(42490),dC=n(39122);const hC=e=>(e?.filter((e=>e.state==dC.p.Enabled))?.map((e=>e.id))??[]).concat([Af.un.WEB_SEARCH]),pC=(e,t,n,r,s,i)=>{const o=(0,ry.D)(),l=(e?.isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled&&!uC.n.getInstance(n,o)?.isInErrorState())??!1,[c,u]=(0,N.useState)((()=>{if(l){const e=uC.n.getInstance(n,o),t=e?.getChatMessages()??[];return iy.c.sessionStorageService=e,t}return[]})),d=(0,N.useCallback)((()=>{u([]),uC.n.getInstance(n,o)?.setChatMessagesAndPlugins([],[]),i?.setEnabledPluginIds(hC(s))}),[u,n,i,s]);return(0,N.useEffect)((()=>{i?.setEnabledPluginIds((uC.n.getInstance(n,o)?.getEnabledPlugins()??[]).concat(hC(s)))}),[i,n,s]),(0,N.useEffect)((()=>{if(l&&!t){const e=((e,t,n)=>{const r=uC.n.getInstance(t,n)?.getEnabledPlugins()??[];return e.forEach((e=>{const t=e?.body?.pluginAppId;e?.messageType===a._.SystemMessage&&t&&"PluginToggle"==e?.body?.scenario&&(e?.body?.isEnabled?r.includes(t)||r.push(t):r.includes(t)&&r.splice(r.indexOf(t),1))})),r})(c,n,o);uC.n.getInstance(n,o)?.setChatMessagesAndPlugins(c.filter((e=>e.messageType!==a._.SystemMessage&&!e.skipChatHistoryPersistence)),e)}}),[l,i,c,n,t]),(0,N.useEffect)((()=>{l&&(r.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.CopilotChatHistorySessionStorageUsed},{key:Pf.h3.ChatEventParameters,value:l}]),r.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMEarlyLoadUsingCache},{key:Pf.h3.ChatEventParameters,value:(new Date).getTime().toString()}]))}),[l,r]),{chatLog:c,setChatLog:u,resetChatLog:d,isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled:l}};var gC,mC,fC,yC,vC,bC,CC=n(358),wC=36e5,SC=function(){function e(e,t,n){var r=this;this.telemetryService=e,this.tag=t,this.name=n,this.start=Date.now(),this.isLoggingDone=!1,this.timeoutId=setTimeout((function(){r.log({eventId:CC.Bw.ClientSkill,type:CC.FY.LogMetric,tag:r.tag,name:r.name,success:CC.YE.Timeout,duration:wC,diagnosticsData:"Ended with Timeout"}),r.isLoggingDone=!0}),wC)}return e.prototype.logMetricEnd=function(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;var n=Date.now()-this.start;this.log((0,y.__assign)((0,y.__assign)({},e),{eventId:CC.Bw.ClientSkill,type:CC.FY.LogMetric,tag:this.tag,name:this.name,success:CC.YE.Successful,duration:n,correlationVector:t}))}},e.prototype.logMetricEndWithError=function(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;var n=Date.now()-this.start;this.log((0,y.__assign)((0,y.__assign)({},e),{eventId:CC.Bw.ClientSkill,type:CC.FY.LogMetric,tag:this.tag,name:this.name,success:CC.YE.Failure,duration:n,correlationVector:t}))}},e.prototype.log=function(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)},e}();!function(e){e.SearchMessageExtension="SearchMessageExtension",e.ActionMessageExtension="ActionMessageExtension",e.ConfirmationDialog="ConfirmationDialog",e.InterstitialAuth="InterstitialAuth",e.CEAInterstitialAuth="CEAInterstitialAuth",e.TriggerPlugin="TriggerPlugin",e.Undefined="Undefined"}(gC||(gC={})),function(e){e[e.None=0]="None",e[e.ClientSkillExecutor=1]="ClientSkillExecutor",e[e.SilentAuthSkill=2]="SilentAuthSkill",e[e.ActionMsgExtSkill=3]="ActionMsgExtSkill"}(mC||(mC={})),function(e){e[e.None=0]="None",e[e.ClientSkillExecutor=1]="ClientSkillExecutor",e[e.ActionMsgExtSkill=2]="ActionMsgExtSkill",e[e.SilentAuthSkill=3]="SilentAuthSkill",e[e.ConfirmationDialogSkill=4]="ConfirmationDialogSkill",e[e.APIPluginsAuthSkill=5]="APIPluginsAuthSkill",e[e.InterstitialAuthSkill=6]="InterstitialAuthSkill",e[e.TriggerAddInLocalPluginSkill=7]="TriggerAddInLocalPluginSkill"}(fC||(fC={})),function(e){e[e.None=0]="None",e[e.ExecuteSkill=1]="ExecuteSkill"}(yC||(yC={})),function(e){e[e.None=0]="None",e[e.Execute=1]="Execute",e[e.ExecuteSkill=2]="ExecuteSkill",e[e.ResponseParser=3]="ResponseParser",e[e.ConfirmationButtonClicked=4]="ConfirmationButtonClicked",e[e.RenderSkill=5]="RenderSkill",e[e.AuthButtonClicked=6]="AuthButtonClicked"}(vC||(vC={})),function(e){e.HttpStatusCode="HttpStatusCode",e.SkillType="SkillType",e.NumberOfRequests="NumberOfRequests"}(bC||(bC={}));var EC=n(84625);const xC="Not a list of functions in FluxV3 method invocation.",IC="Method invocation string is null or empty";class AC{static tryParseMethodNameFromChatCompletionsFunctionInvocation(e){var t,n,r;if(!(null==e?void 0:e.trim()))throw new Error(IC);const s=e.trim();if(!s.startsWith("[")||!s.endsWith("]"))throw new Error(xC);let i;try{i=JSON.parse(s)}catch(e){throw new Error("Failed to deserialize method invocation in FluxV3 method invocation.")}if(!Array.isArray(i)||0===i.length)throw new Error(xC);const a=null===(r=null===(n=null===(t=i[0])||void 0===t?void 0:t.function)||void 0===n?void 0:n.name)||void 0===r?void 0:r.trim();if(!a)throw new Error("Method name null in FluxV3 method invocation.");return a}static parseMethodName(e){if(!(null==e?void 0:e.trim()))throw new Error(IC);const t=e.trim(),n=t.indexOf("(");return-1!==n?t.substring(0,n):t}static extractActionName(e){try{return this.tryParseMethodNameFromChatCompletionsFunctionInvocation(e)}catch(t){return this.parseMethodName(e)}}}class PC{constructor(e,t,n,r){this.telemetryService=e,this.onSkillExecuteCompletion=t,this.renderConfirmationCard=n,this.isMultipleConfirmationDialogFlowEnabled=r,this.currentConfirmationDialogIndex=0,this.invokeActionMessages=[],this.alwaysAllowedConfirmationActions=new Set,this.onConfirmationButtonClicked=e=>{var t,n;const r=new SC(this.telemetryService,fC.ConfirmationDialogSkill,vC.ConfirmationButtonClicked);try{if(!this.confirmationButtonClickedForLatestMessage(e))return void r.logMetricEndWithError({diagnosticsData:"onConfirmationButtonClicked - button click was not done for latest message"});if(this.invokeActionMessages.push(e),this.isMultipleConfirmationDialogFlowEnabled){if(this.currentConfirmationDialogIndex++,(null==e?void 0:e.confirmationOption)===EC.Ei.AlwaysAllow&&e.actionId){const t=AC.extractActionName(e.actionId);t&&this.alwaysAllowedConfirmationActions.add(t)}this.setAllowForAlwaysAllowedConfirmationActions()}if(this.onSkillExecuteCompletion)if(this.isMultipleConfirmationDialogFlowEnabled&&this.confirmationMessages&&this.currentConfirmationDialogIndex<this.confirmationMessages.length){const e=this.getCurrentConfirmationCard();e&&$o.emit("updateConfirmationDialog",e.card)}else{if(!this.isMultipleConfirmationDialogFlowEnabled){const e=this.getCancellationMessages();this.invokeActionMessages=this.invokeActionMessages.concat(e)}const s={text:"confirmation response",messageType:EC.n3.ResumeInvokeAction,sourceRequestId:null===(t=this.confirmationMessages)||void 0===t?void 0:t[0].sourceRequestId,actionId:null===(n=this.confirmationMessages)||void 0===n?void 0:n[0].actionId,author:EC.nC.Bot,invokeActionMessages:this.invokeActionMessages};r.logMetricEnd({diagnosticsData:`onConfirmationButtonClicked, confirmation option: ${e.confirmationOption}`}),this.onSkillExecuteCompletion(s)}else r.logMetricEndWithError({diagnosticsData:"onConfirmationButtonClicked - onSkillExecuteCompletion is not defined"})}catch(e){e&&r.logMetricEndWithError({diagnosticsData:`onConfirmationButtonClicked - error details: ${e}`})}}}executeSkill(e){throw new Error("Method not implemented for ConfirmationSkill, we will change this once ActionME code is in sync with new design")}renderSkill(e){const t=new SC(this.telemetryService,fC.ConfirmationDialogSkill,vC.RenderSkill);try{if(this.currentConfirmationDialogIndex=0,this.confirmationMessages=this.getConfirmationDialogSkillMessages(e),this.invokeActionMessages=[],this.alwaysAllowedConfirmationActions=new Set,null==this.confirmationMessages)throw new Error("Error occurred while running renderSkill method: confirmationMessages is undefined");const n=this.getCurrentConfirmationCard(),r=this.renderCurrentConfirmationCard(n);return t.logMetricEnd({diagnosticsData:"renderSkill ran successfully"}),r}catch(e){return t.logMetricEndWithError({diagnosticsData:`Error occurred while running renderSkill method: ${e}`}),null}}getMessageType(){return gC.ConfirmationDialog}renderCurrentConfirmationCard(e){if(!this.renderConfirmationCard||!e)throw new Error("Error occurred while running renderConfirmationCard method: renderConfirmationCard or confirmationCardRef is undefined");return this.renderConfirmationCard({card:e.card,onConfirmationButtonClickedCallback:this.onConfirmationButtonClicked})}getConfirmationDialogSkillMessages(e){const t=[];for(let n=e.length-1;n>=0;n--){const r=e[n];if(!(r.messageType===EC.n3.TriggerConfirmation&&r.adaptiveCards&&r.adaptiveCards.length>0))break;t.unshift(r)}return t.length>0?t:void 0}getCurrentConfirmationCard(){if(null==this.confirmationMessages||0===this.confirmationMessages.length||this.currentConfirmationDialogIndex>=this.confirmationMessages.length)throw new Error("Error occurred while running getCurrentConfirmationCard method: confirmationMessages is undefined");const e=this.confirmationMessages[this.currentConfirmationDialogIndex];if(null==e)throw new Error("Error occurred while running getCurrentConfirmationCard method: confirmationMessage is missing");const t=e.adaptiveCards;if(null==t||0===t.length)throw new Error(`Error occurred while running getCurrentConfirmationCard method: triggerConfirmation - adaptiveCard is missing. MessageId: ${e.messageId}`);const n=t[0];return{card:{isConsequential:e.isConsequential,content:n}}}setAllowForAlwaysAllowedConfirmationActions(){var e;if(!this.confirmationMessages)return[];for(let t=this.currentConfirmationDialogIndex;t<this.confirmationMessages.length;t++){let n=!1;const r=this.confirmationMessages[t].adaptiveCards;if(r&&r.length>0){const t=r[0],s=null==t?void 0:t.actions;if(s&&s.length>0)for(const t of s){const r=null===(e=t.data)||void 0===e?void 0:e.message;if(r&&r.actionId){const e=AC.extractActionName(r.actionId);if(e&&r.confirmationOption===EC.Ei.Allow&&this.alwaysAllowedConfirmationActions.has(e)){this.invokeActionMessages.push(r),n=!0;break}}}if(!n)break;this.currentConfirmationDialogIndex++}}}getCancellationMessages(){var e,t,n;if(!this.confirmationMessages)return[];const r=[];for(let s=1;s<this.confirmationMessages.length;s++){const i=this.confirmationMessages[s].adaptiveCards;if(i&&i.length>0){const s=i[0],a=null==s?void 0:s.actions;if(a&&a.length>0)for(const s of a)if((null===(t=null===(e=s.data)||void 0===e?void 0:e.message)||void 0===t?void 0:t.confirmationOption)===EC.Ei.Deny){r.push(null===(n=s.data)||void 0===n?void 0:n.message);break}}}return r}confirmationButtonClickedForLatestMessage(e){var t,n;if(!e||!e.sourceRequestId)return!1;if(this.confirmationMessages&&this.confirmationMessages.length>0){const r=this.confirmationMessages[0].adaptiveCards;if(r&&r.length>0){const s=r[0],i=null==s?void 0:s.actions;if(i&&i.length>0){if((null===(n=null===(t=i[0].data)||void 0===t?void 0:t.message)||void 0===n?void 0:n.sourceRequestId)===e.sourceRequestId)return!0}}}return!1}}const kC=({card:e,onConfirmationButtonClickedCallback:t})=>N.createElement(tl,{body:e.content,onConfirmationCardButtonClicked:t}),TC=(0,zo.Ex)("scc-react-interstitial-auth-skill.cancelAuthText"),DC=(0,Qo.Q)("CancelButton",(0,mt.n)({buttonContainer:{display:"flex",gap:"8px",flexWrap:"wrap"},cancelButton:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({width:"auto",height:"32px",backgroundColor:Pt.L.colorNeutralBackground1},gt.Pt.borderRadius("4px")),gt.Pt.borderWidth("1px")),gt.Pt.borderColor(Pt.L.colorNeutralStroke1)),gt.Pt.gap("4px")),gt.Pt.padding("5px 12px 5px 12px"))}));const MC=function(e){const{error:t,onInterstitialAuthCompletionCallback:n,renderAuthErrorButton:r,renderAuthErrorText:s}=e,i=DC(),a=(0,it.kQ)({cancelAuthText:TC}).cancelAuthText();return r&&s?N.createElement(N.Fragment,null,s({error:t}),N.createElement("div",{className:i.buttonContainer},r({error:t,onInterstitialAuthCompletionCallback:n}),N.createElement(ct.$,{className:i.cancelButton,onClick:()=>null==n?void 0:n("Cancel"),disabled:t.isSessionMessage},a))):N.createElement(N.Fragment,null)};class LC{constructor(e,t,n,r){this.telemetryService=e,this.onSkillExecuteCompletion=t,this.renderAuthErrorButton=n,this.renderAuthErrorText=r,this.onAuthButtonClicked=e=>{var t,n;const r=new SC(this.telemetryService,fC.InterstitialAuthSkill,vC.AuthButtonClicked);if(this.onSkillExecuteCompletion){const s={messageType:EC.n3.ResumePluginAuth,sourceRequestId:null===(t=this.interstitialAuthMessageProps)||void 0===t?void 0:t.sourceRequestId,actionId:null===(n=this.interstitialAuthMessageProps)||void 0===n?void 0:n.actionId,author:EC.nC.Bot};r.logMetricEnd({diagnosticsData:`onAuthButtonClicked, actionType: ${e}`}),this.onSkillExecuteCompletion(s)}else r.logMetricEndWithError({diagnosticsData:"onAuthButtonClicked - onSkillExecuteCompletion is not defined"})}}executeSkill(e){throw new Error("Method not implemented for AuthSkill")}renderSkill(e){const t=new SC(this.telemetryService,fC.InterstitialAuthSkill,vC.RenderSkill);try{const n=this.getInterstitialAuthSkillMessages(e),r=null==n?void 0:n[0],s=null==r?void 0:r.authError;if(!s)throw new Error("triggerPluginAuthError is not defined.");return this.interstitialAuthMessageProps={sourceRequestId:r.sourceRequestId,actionId:r.actionId},t.logMetricEnd({diagnosticsData:"renderSkill ran successfully"}),this.renderAuthErrorButton&&this.renderAuthErrorText?N.createElement(MC,{error:s,onInterstitialAuthCompletionCallback:this.onAuthButtonClicked,renderAuthErrorText:this.renderAuthErrorText,renderAuthErrorButton:this.renderAuthErrorButton}):null}catch(e){return t.logMetricEndWithError({diagnosticsData:`Error occurred while running renderSkill method: ${e}`}),null}}getMessageType(){return gC.InterstitialAuth}getInterstitialAuthSkillMessages(e){const t=[];for(let n=e.length-1;n>=0;n--){const r=e[n];if(r.messageType!==EC.n3.TriggerPluginAuth||!r.authError)break;t.unshift(r)}return t.length>0?t:void 0}}var RC=n(83112),NC=n(61150);function OC(e){const{error:t,onInterstitialAuthCompletionCallback:n}=e,r=(0,l.$x)(),s=(0,So.i)(t);return s&&s.requestType?N.createElement(RC.N,{...s,onInterstitialAuthCompletionCallback:n,apiPluginsAuthSkillEnabled:!0,msgExtAuthSkillEnabled:!0,theme:r===NC.G.defaultBlack?"dark":"light"}):N.createElement(N.Fragment,null)}var _C=n(4699),BC=n(33);function FC(e){const{error:t}=e,{pluginCardServiceProvider:n}=(0,el.gW)(),{requestType:r,appId:s}=N.useMemo((()=>(0,BC.m)(t)),[t]);return r&&s&&n&&n.appService?N.createElement(_C.q,{requestType:r,appId:s,appService:n.appService,apiPluginsAuthSkillEnabled:!0,msgExtAuthSkillEnabled:!0}):N.createElement(N.Fragment,null)}var UC;!function(e){e.Text="text/plain",e.AdaptiveCard="text/adaptivecardtemplate"}(UC||(UC={}));var HC="The operation did not succeed. Something went wrong.";const zC=404;class jC{constructor(e,t,n,r){this.telemetryService=e,this.invokeAddInLocalPluginAction=t,this.invokeAddInLocalPluginActions=n,this.onSkillExecuteCompletion=r}executeSkill(e){const{perfMarkerForSkill:t,propMap:n,resultId:r}=this.initializeCommonVariables([e]);return new Promise(((s,i)=>{var a;null===(a=this.invokeAddInLocalPluginAction)||void 0===a||a.call(this,e,((a,o)=>{o?this.handleError(t,n,r,e.correlationId,i):this.handleSuccess(a,r,e.sourceRequestId,e.actionId,s)})),this.invokeAddInLocalPluginAction||this.handleFeatureUnavailable(t,n,r,e.correlationId,i)}))}executeSkills(e){const{perfMarkerForSkill:t,propMap:n,resultId:r}=this.initializeCommonVariables(e);return new Promise(((s,i)=>{var a;null===(a=this.invokeAddInLocalPluginActions)||void 0===a||a.call(this,e,((a,o)=>{o?this.handleError(t,n,r,e.length?e[0].correlationId:"",i):this.handleSuccess(a,r,e.length?e[0].sourceRequestId:"",e.length?e[0].actionId:"",s)})),this.invokeAddInLocalPluginAction||this.handleFeatureUnavailable(t,n,r,e.length?e[0].correlationId:"",i)}))}initializeCommonVariables(e){const t=new SC(this.telemetryService,fC.TriggerAddInLocalPluginSkill,vC.Execute),n={},r=(0,f.DA)();return n[bC.NumberOfRequests]=e.length,{perfMarkerForSkill:t,propMap:n,resultId:r}}handleError(e,t,n,r,s){t[bC.HttpStatusCode]=zC,e.logMetricEndWithError({props:t,correlationId:r,diagnosticsData:"Error in TriggerAddInLocalPluginSkill"}),s({statusCode:zC,payload:{id:n,type:UC.Text,data:HC}})}handleFeatureUnavailable(e,t,n,r,s){t[bC.HttpStatusCode]=zC,e.logMetricEndWithError({props:t,correlationId:r,diagnosticsData:`Error in TriggerAddInLocalPluginSkill, correlationId : ${r}`}),s({statusCode:zC,payload:{id:n,type:UC.Text,data:"The operation did not succeed. The feature is not available for the user."}})}handleSuccess(e,t,n,r,s){var i;const a={text:"triggered plugin response",messageType:EC.n3.CompletePlugin,sourceRequestId:n,actionId:r,author:EC.nC.Bot,response:e};null===(i=this.onSkillExecuteCompletion)||void 0===i||i.call(this,a),s({statusCode:200,payload:{id:t,type:UC.Text,data:JSON.stringify(e)}})}renderSkill(e){throw new Error("Method not implemented for TriggerAddInLocalPluginSkill as it's not required")}getMessageType(){return gC.TriggerPlugin}}function VC(e,t){const n=null==e?void 0:e[e.length-1];return(null==n?void 0:n.messageType)==t}class qC{constructor(e,t,n){this.skills=e,this.lazySkillsInitializer=t,this.telemetryService=n}async initializeLazySkills(){await this.lazySkillsInitializer()}async executeSkills(e){const t=new SC(this.telemetryService,fC.ClientSkillExecutor,vC.Execute);if(0===e.length)throw new Error("No skill requests to execute.");const n=e[0],r=(0,f.DA)(),s={},i=n.correlationId;s[bC.NumberOfRequests]=e.length;try{const a=function(e,t){if(!t){const t=new Error(`Mandatory param localEndpoint missing. correlationId: ${e}`);throw t.name="InsufficientData",t}const n=null==t?void 0:t.split("/");switch(n[0]){case"MessageExtension":case"InvokeAddInLocalPlugin":case"CustomEngineAgent":return n[1];default:{const t=new Error(`Unsupported pluginType, correlationId: ${e}`);throw t.name="Unsupported pluginType",t}}}(i,n.localEndpoint),o=this.skills.find((e=>e.getMessageType()===a));if(!o)return s[bC.HttpStatusCode]=404,t.logMetricEndWithError({props:s,correlationId:i,diagnosticsData:"Unable to find relevant skill to handle event of type"}),{statusCode:404,payload:{id:r,type:UC.Text,data:HC}};if(e.length>1){if(!o.executeSkills)throw new Error("Skill is unable to execute multiple requests.");const n=await o.executeSkills(e);return s[bC.HttpStatusCode]=n.statusCode,t.logMetricEnd({props:s,correlationId:i}),n}{const e=await o.executeSkill(n);return s[bC.HttpStatusCode]=e.statusCode,t.logMetricEnd({props:s,correlationId:i}),e}}catch(e){return s[bC.HttpStatusCode]=500,t.logMetricEndWithError({props:s,correlationId:i,diagnosticsData:`Error: ${null==e?void 0:e.message}`}),{statusCode:500,payload:{id:r,type:UC.Text,data:HC}}}}async execute(e){return this.executeSkills([e])}async executeRequests(e){if(0===e.length)throw new Error("No skill requests to execute.");return this.executeSkills(e)}renderSkill(e){const t=new SC(this.telemetryService,fC.ClientSkillExecutor,vC.RenderSkill);try{const r=VC(n=e,EC.n3.TriggerConfirmation)?gC.ConfirmationDialog:VC(n,EC.n3.TriggerPluginAuth)?gC.InterstitialAuth:VC(n,EC.n3.TriggerCEASilentAuth)?gC.CEAInterstitialAuth:VC(n,EC.n3.TriggerPlugin)?gC.TriggerPlugin:gC.Undefined,s=this.skills.find((e=>e.getMessageType()===r));if(!s)return t.logMetricEndWithError({diagnosticsData:`Unable to find relevant skill to handle event of type ${r}`}),null;const i=s.renderSkill(e);return t.logMetricEnd({diagnosticsData:`renderSkill ran successfully for skillType : ${r}`}),i}catch(e){return t.logMetricEndWithError({diagnosticsData:`Error occurred while running renderSkill error : ${null==e?void 0:e.message}`}),null}var n}}var WC=n(48234),QC=n(72730);class GC{constructor(e,t){this.telemetryLogger=e,this.traceId=t}LogInfo(e){this.log(e)}LogError(e){this.log(e)}LogException(e){this.log(e)}LogWarning(e){this.log(e)}LogVerbose(e){this.log(e)}LogMetric(e){this.log(e)}log(e){var t;const{eventId:n,tag:r,name:s,type:i,conversationId:a,duration:o,message:l}=e,c=(0,y.__rest)(e,["eventId","tag","name","type","conversationId","duration","message"]);null===(t=this.telemetryLogger)||void 0===t||t.logEvent({eventId:n,detail:`${r}_${s}_${i}`,metaData:JSON.stringify(c),latency:o,message:l,traceId:this.traceId,conversationId:a})}}var ZC=n(84944);const YC=(e,t,n)=>{const r=(0,Ot.Y$)(),s=(0,it.kQ)({augLoopErrorMessage:_f.Ao}),i=(0,N.useMemo)((()=>((e,t,n)=>async r=>{(0,qf.cY)("getRequestContinuationHandler",r),(0,QC.UU)(e);const s=JC(r);KC(new Wf.j,s);try{await t(s)}catch(t){e((e=>[...e,{messageType:a._.Default,body:{user:Af.Q9.Chat,messageHeader:{text:n}}}]))}})(n,t,s.augLoopErrorMessage())),[t,n]),o=ZC.L.getInstance(),l=(0,N.useMemo)((()=>new GC(o)),[o]);return(0,N.useMemo)((()=>{const t=[];if(r.isInterstitialConfirmationEnabled&&t.push(new PC(l,i,kC,r.isMultipleConfirmationDialogFlowEnabled)),r.isInterstitialAuthEnabled&&t.push(new LC(l,i,OC,FC)),r.areAddinLocalPluginActionsEnabled&&t.push(new jC(l,((t,n)=>e.sendEventToClient(Tf.PV.AddInLocalPluginActionInvoked,{workflowAnnotationType:"",skillRequest:t,callback:n})),((t,n)=>e.sendEventToClient(Tf.PV.AddInLocalPluginActionsInvoked,{workflowAnnotationType:"",skillRequests:t,callback:n})),i)),0!==t.length)return new qC(t,(()=>Promise.resolve()),l)}),[r,i,l,e])},KC=(e,t)=>{let n={};if(t.type===WC.NQ.ResumeInvokeAction){const r=t,s=r?.invokeActionMessages??[];n={type:t.type,totalInvokeActions:s.length,actionPerConfOption:s.reduce(((e,t)=>{const n=t.confirmationOption;return e[n]||(e[n]=[]),e[n].push({action:t.action,actionId:t.actionId,isCancelOption:t.isCancelOption}),e}),{})},(0,qf.cY)("logTelemetryContinuationMessage",n),e.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.RequestContinuationMessageSent},{key:Pf.h3.ChatEventParameters,value:JSON.stringify(n)}])}},JC=e=>{switch(e.messageType){case wy.n3.ResumeInvokeAction:{const t=e;return{type:WC.NQ.ResumeInvokeAction,actionId:t.actionId??"",sourceRequestId:t.sourceRequestId??"",invokeActionMessages:(t.invokeActionMessages??[]).map((({action:e,actionId:t,sourceRequestId:n,confirmationOption:r,isCancelOption:s,pluginInfo:i})=>({action:e,actionId:t,sourceRequestId:n,confirmationOption:r??WC.Pf.None,isCancelOption:s,pluginInfo:i})))}}case wy.n3.ResumePluginAuth:{const t=e;return{type:WC.NQ.ResumePluginAuth,actionId:t.actionId??"",sourceRequestId:t.sourceRequestId??""}}case wy.n3.CompletePlugin:{const n=e;return{type:WC.NQ.CompletePlugin,actionId:n.actionId??"",sourceRequestId:n.sourceRequestId??"",response:n.response?(t=n.response,{result:t.result.map((e=>({id:e.id,type:e.type,data:e.data,descriptionForModel:e.description_for_model,informationProtectionLabelId:e.information_protection_label,schema:e.schema,subtitle:e.subtitle,title:e.title,url:e.url,thumbnailUrl:e.thumbnail_url})))}):void 0}}default:throw new Error(`Unsupported continuation message type: ${e.messageType}`)}var t};var XC=n(28777);const $C=(e,t,n)=>{const r=e.promptSuggestionList.length>4?3:2,s=e.promptSuggestionList.slice(0,r);s.forEach((e=>{e.source=e.source??$n.L.Static}));const i=t.map((e=>({suggestionCategory:n,suggestionText:e.question,suggestionId:$n.L.SuggestedQnA,iconRegular:Do.uJg,shouldSubmitQueryOnClick:!0,source:$n.L.SuggestedQnA}))).slice(0,2),a=[...s,...i];return{...e,promptSuggestionList:a}},ew=(e,t,n,r,s=!1,i,a=!1)=>({showBranding:e.showBranding,brandingInfo:e.brandingInfo,promptSuggestions:e.promptSuggestionList.map((e=>({promptSuggestionCategory:e.suggestionCategory,promptSuggestionText:e.suggestionText,promptSuggestionId:e.suggestionId,isDisabled:e.isDisabled??!1,iconRegular:e.iconRegular,iconUrl:e.iconUrl,iconUrlName:e.iconUrlName,source:e.source??$n.L.Static,agentInvocationProps:e.agentInvocationProps,telemetryData:e.telemetryData,isHidden:e.isHidden,requestMetaData:e.requestMetaData}))),isHVCAppChatV2Enabled:n,handleButtonClick:t,hvcPromptStringsList:r,showRefreshButton:e?.showRefreshButton,handleRefreshButtonClick:e?.handleRefreshButtonClick,wasChatPaneAutoOpened:s,userDisplayName:i,isSQNALoading:a}),tw=(e,t)=>{const n=e.map((e=>({question:e.question,answer:e.answer,citations:t?e.citations:void 0})));return(0,Vf.q6)(n)},nw=(e,t)=>e.find((e=>e.question===t)),rw=(e,t,n,r,s,i,l)=>{const c=(0,bo.A)();r.setUserQueryGuid(c),r.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.SuggestionPaneSuggestionClicked}]),r.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.QuerySubmittedByUser}]),r.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMQuerySubmittedDirectly},{key:Pf.h3.ChatEventParameters,value:$n.L.SuggestedQnA}]),r.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMSubmittedPrompt},{key:Pf.h3.ChatEventParameters,value:$n.L.SuggestedQnA}]),n(a._.Default,{defaultMessageProps:{user:"human",messageHeader:{text:e}}}),n(a._.MarkdownCard,{markDownCardProps:{user:"chat",message:t}},{shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:o.O.Footer,isFailure:!1,actionButtonList:s?void 0:[jf.U.getInstance(l).getCopyButton()],references:i?jf.U.getInstance(l).getMarkdownReferences(i):void 0,feedbackData:jf.U.getInstance(l).getFeedbackData(),clpSensitivityIndicatorData:jf.U.getInstance(l).getBasicChatProps()?.sensitivityIndicatorData,telemetryData:JSON.stringify({correlationId:c,featureName:Pf.Z_.ChatQnA}),shouldShowCopyButton:s,shouldShowReadAloudButton:s}),r.logTriedEvent([],Pf.Nx,Pf.Z_.ChatQnA,void 0,void 0,Pf.RX.Ask,$n.L.SuggestedQnA),r.setUserQueryGuid(Df.u1)},sw=(e,t,n,r,s,i)=>{const{question:a,answer:o,citations:l}=e;rw(a,o,r,s,t,n?l:void 0,i)},iw=(e,t)=>{t?t(jf.U.getInstance(e).getSuggestedQnaScenarioSignalOperation(),yf.pK.getTypeName()):Cf.E.getInstance(e)?.submitOperation(jf.U.getInstance(e).getSuggestedQnaScenarioSignalOperation(),yf.pK.getTypeName()),(0,qf.cY)("Received preloaded pane show event")},aw=(e,t,n,r,s,i,a,o)=>{const l=(0,ry.D)(),c=e?.getPreloadSignal?.(XC.U.HidePane),u=e?.getPreloadSignal?.(XC.U.ShowPane),d=(0,Ot.Y$)(),{submitOperation:h}=(0,sy.G)();N.useEffect((()=>{if(c){const e=c.subscribe((()=>{(0,qf.cY)("Subscribing handlers to preloadHideSignal"),o(),i&&((e,t)=>{e.current&&e.current.length>0&&(t(e.current),(0,qf.cY)("Updated ZQM prompts on preloaded pane hide event."))})(t,n),(0,qf.cY)("Called updateIsPaneVisibleForIntentHandling(false) on preload hide signal."),a(!1)}));return()=>{e()}}}),[]),N.useEffect((()=>{if(i&&u){const e=d.isALHookEnabled?u.subscribe((()=>iw(l,h))):u.subscribe((()=>iw(l)));return()=>{e()}}}),[]),N.useEffect((()=>{if(d?.isZQMShownSourceTelemetryEnabled&&u){const e=u.subscribe((()=>{(0,qf.cY)("Called logZQMShownSourceTelemetry and updateInsightsCardShownSourceStatus on preload show signal."),r(),s()}));return()=>{e()}}if(u){const e=u.subscribe((()=>{a(!0)}));return()=>{e()}}}),[])};var ow=n(81469),lw=n(89796),cw=n(62570);var uw=n(37582);const dw={authenticactionErrorMessage:_f.fE,ciqPlaceholderText:_f.qe,changeTopicButtonText:_f._V,claimChallengeChatMessage:_f.FG,copilotLabMenuItemText:_f.KQ,copyButtonPopOverText:_f.d7,copyButtonText:_f.Vv,creditBannerTitle:_f.aM,creditBannerBody:_f.Kr,creditBannerLinkText:_f.xM,defaultCiqPlaceholderText:_f.qe,inactiveChatBannerString:_f.aK,disableChatOnUserInteractionRequiredToSignInString:_f.X6,disableChatOnClaimsChallengeToSignInString:_f.LB,libbieButtonText:_f.LU,libbieTitle:_f.pG,licenseValidationErrorMessageString:_f.VX,micListeningGhostText:_f.iP,missingServicePlanBYOAErrorText:_f.fz,paneLoadingWarningString:_f.Fj,signInButtonLabel:_f.ix,signInButtonPopover:_f.S5,taskModuleDialogTitle:_f.xr,verifyAccessButtonLabel:_f.wX,verifyAccessButtonPopover:_f.S5,systemMessageActionButtonText:_f.Mc,promptGuideMenuSectionUnderstand:_f.hf,viewcodeButtonLabel:_f.Ky,viewcodeButtonPopovertext:_f.I3,augLoopErrorMessage:_f.Ao,podcastUnavailableErrorMessage:_f.SI.PODCAST_UNAVAILABLE};class hw{constructor(e){this.sessionKey=e,this.storage=sessionStorage,this.isError=!1,this.sessionKey?this.validateSessionStorageObject():(this.isError=!0,this.clearSessionStorageObject(!0))}validateSessionStorageObject(){const e=this.getSessionStorageObject();this.sessionKey||this.clearSessionStorageObject(!0),e?.sessionKey!==this.sessionKey?this.clearSessionStorageObject(!1):this.isError=e?.isError??!1}static getInstance(e){try{hw.instance||(hw.instance=new hw(e))}catch(e){(0,qf.cY)("Session storage object creation failed",e)}return hw.instance}getSessionStorageObject(){try{const e=this.storage?.getItem(hw.SESSION_STORAGE_KEY);return e?JSON.parse(e):{sessionKey:"",suggestedQnAList:[],isError:!0}}catch(e){return(0,qf.cY)("Parse session storage failed",e),this.isError=!0,{sessionKey:this.sessionKey,suggestedQnAList:[],isError:!0}}}clearSessionStorageObject(e){this.isError=e;try{this.storage?.setItem(hw.SESSION_STORAGE_KEY,JSON.stringify({sessionKey:this.sessionKey,suggestedQnAList:[],isError:e}))}catch(e){(0,qf.cY)("Clear session storage failed")}}setSessionStorageObject(e){this.storage?.setItem(hw.SESSION_STORAGE_KEY,JSON.stringify(e))}setErrorState(e){this.isError=e,this.clearSessionStorageObject(e)}get(){if(this.isError)return[];try{return this.getSessionStorageObject().suggestedQnAList}catch(e){return(0,qf.cY)("Get session storage failed",e),this.clearSessionStorageObject(!0),[]}}set(e){if(!this.isError)try{const t=e.slice(0,2),n={sessionKey:this.sessionKey,suggestedQnAList:t};this.setSessionStorageObject(n)}catch(e){(0,qf.cY)("Set session storage failed",e),this.clearSessionStorageObject(!0)}}isInErrorState(){return this.isError}}hw.SESSION_STORAGE_KEY="CopilotProactiveZQMSessionStorageObject";var pw=n(34189),gw=n(82308),mw=n(23049),fw=n(18385);class yw{constructor(e){this.featureName="AudioCast",this.getFeatureName=()=>this.featureName,this.telemetryLoggerUtils=Wf.j.getInstance(e)}static getInstance(e){return fw.T.getFeatureFlags()?.isSingletonInstanceManagerEnabled&&e?fw.T.getSingleton(yw,e,(()=>new yw(e))):(yw.instance||(yw.instance=new yw),yw.instance)}static resetInstance(e){yw.instance=void 0,e&&fw.T.resetSingleton(yw,e)}setQuerySubmitTime(e){this.querySubmitTime=e}setFeatureName(e){this.featureName=e}audioCastALResponseReceived(e,t){const n=JSON.stringify({seqId:`${e.seqId}_${e.subSeq}`,nextExpectedSeqId:t,error:e.error,isConversationScript:!!e.conversationScript,audioSize:e.blob?.sizeBytes,annotationType:gw.q.getTypeName()});this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ResponseReceivedFromAL},{key:Pf.h3.UserQueryGuid,value:e.queryId||""},{key:Pf.h3.ChatEventParameters,value:n}])}audioCastCompleted(e,t){const n=JSON.stringify({audioCastSize:t});this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AudioCastResponseCompleted},{key:Pf.h3.UserQueryGuid,value:e},{key:Pf.h3.ChatEventParameters,value:n}]),this.audioCastFinalChunkLatency(e)}audioCastFinalChunkLatency(e){this.querySubmitTime&&this.telemetryLoggerUtils.sendTelemetryLatencyData([{key:Pf.CT.AudioCastFinalChunkLatency,value:(0,Vf.WU)(this.querySubmitTime)},{key:Pf.h3.UserQueryGuid,value:e},{key:Pf.CT.FeatureName,value:this.featureName}],!0)}audioCastFirstChunk(e){this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AudioCastFirstChunkReceived},{key:Pf.h3.UserQueryGuid,value:e}]),this.audioCastUserPerceivedLatency(e)}audioCastUserPerceivedLatency(e,t=!0){this.querySubmitTime&&this.telemetryLoggerUtils.sendTelemetryLatencyData([{key:Pf.CT.UserPerceivedLatency,value:(0,Vf.WU)(this.querySubmitTime)},{key:Pf.h3.UserQueryGuid,value:e},{key:Pf.CT.FeatureName,value:this.featureName},{key:Pf.CT.IsQuerySuccess,value:t}],!0)}audioCastError(e,t){this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AudioCastError},{key:Pf.h3.UserQueryGuid,value:t},{key:Pf.h3.ChatEventParameters,value:e}]),this.audioCastUserPerceivedLatency(t,!1)}audioCastRetry(e,t){this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AudioCastRetry},{key:Pf.h3.UserQueryGuid,value:e},{key:Pf.h3.ChatEventParameters,value:t}])}audioCastQueueProcessing(e,t=""){this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AudioCastQueueProcessing},{key:Pf.h3.UserQueryGuid,value:e},{key:Pf.h3.ChatEventParameters,value:t}])}}const vw=(0,N.lazy)((()=>Promise.all([n.e(9037),n.e(3341),n.e(5016)]).then(n.bind(n,67082)).then((e=>({default:e.PodcastUI}))))),bw=(e,t,n,r,s,i)=>{const l=(0,ry.D)(),[c,u]=(0,N.useState)(!1),[d,h]=(0,N.useState)(void 0),p=(0,N.useRef)(!0),g=(0,N.useRef)(!1),m=(0,N.useRef)(),f=(0,N.useRef)(0),y=(0,N.useRef)(0),v=(0,N.useRef)(),b=(0,N.useRef)(new Map),C=(0,mw.pU)(),w="I've created a Podcast based on the main themes in this document. Click below to listen. Enjoy your podcast, and feel free to ask any questions you may have in Chat below.",S=(0,Ot.Y$)(),{submitOperation:E}=(0,sy.G)(),{isAudioCastPlayerEnabled:x,isAudioCastDownloadEnabled:I}=S,A=e=>{let t=new Uint8Array([]);if(e.blob.sizeBytes<=2e6){const n=e.blob.data.data,r=e.response,i=e.conversationScript,a=e.isFinal,o=M(r??""),c=e.queryId||"",d=e.blob.sizeBytes,g=e.seqId;if((0,qf.cY)(`AudioPlayer: handleAudioCastResponse seqId: ${g} isFirsResponse: ${p.current} isFinal: ${a} queryId: ${c} size ${d} caption: ${i}`),void 0!==n){t=new Uint8Array(n),u(!0);const r={id:(0,bo.A)(),heading:"Podcast",content:w,blobData:t,uiStates:"LOADING",caption:i};if(h(r),p.current)v.current=R(t,o,"STREAMING_START",i),p.current=!1,f.current=e.seqId??0,yw.getInstance(l).audioCastFirstChunk(c),y.current=d;else{y.current+=d;let e="STREAMING_UPDATE";a&&(e="STREAMING_END"),O(v.current,r,e,i)}a&&((0,qf.cY)("AudioPlayer AudioCast Final response received"),yw.getInstance(l).audioCastCompleted(c,y.current),P()),s(!1)}}else(0,qf.cY)("AudioCast response is too large")},P=()=>{(0,qf.cY)("AudioPlayer: resetAudioCastState"),p.current=!0,g.current=!1,f.current=0,v.current=void 0,b.current.clear(),y.current=0},k=e=>{(0,qf.cY)(`AudioPlayer: Processing audioCastResponse received chunk ${e.seqId} with nextExpectedChunk: ${f.current} QueryId; ${e.queryId}`);const s=e.seqId??f.current;s<f.current?(0,qf.cY)("audioCastResponse is already processed",s):s===f.current?(A(e),e.isFinal?f.current=0:f.current++,T(e.queryId)):((0,qf.cY)(`Storing audioCastResponse in buffer with seqId: ${s}`),b.current.set(s,e),g.current||((0,qf.cY)("AudioCast retryAudioCastRequest queryId ",e.queryId),D(e.queryId,r,E,S,t,n,i),g.current=!0))},T=e=>{for(;b.current.has(f.current);){const t=b.current.get(f.current);(0,qf.cY)(`processAudioCastResponseQueue audioCastResponse in buffer with seqId: ${f.current} queryId: ${t.queryId}`),yw.getInstance(l).audioCastQueueProcessing(e,t.queryId),A(t),b.current.delete(f.current),t.isFinal&&(m.current=e)}},D=async(e,t,n,r,s,i,a)=>{try{const o=s.isFeatureGateEnabledFromClient(Af.WT.IsCopilotPluginEnabled)?i.getEnabledPlugins():[],c=(0,bo.A)();(0,qf.cY)(`AudioCast retryAudioCastRequest retryRequestId ${c} currentRequestId: ${e}`);const u=await s.getDefaultSignalOperation("Generate a podcast from this document",c,iy.c.currentChatId??void 0,void 0,void 0,o,void 0,void 0,void 0,void 0,void 0,void 0,t.current?.getRawCanvasSelections?.(),void 0,void 0,a),{operation:d,workflowAnnotationType:h}=u;wf._.getInstance(l).setAugloopResponseTimer(h),r.isALHookEnabled?n(d,h):Cf.E.getInstance(l).submitOperation(d,h),yw.getInstance(l).audioCastRetry(e,c)}catch(e){throw(0,qf.cY)("AudioCast retry: Exception:"+JSON.stringify(e)),s.updateCopilotState(Tf.SG.QUERY_SUBMITTED_FAILED),wf._.getInstance(l).clearAugloopResponseTimer(),e}},M=e=>{try{return JSON.parse(e).message||""}catch(e){return""}},L=(e,t,n,r,s,i)=>N.createElement(N.Suspense,{fallback:N.createElement("div",null,"Loading...")},N.createElement(vw,{id:e,content:t,heading:n,blobData:r,type:x?"AUDIO_CAST":"DEFAULT",streamingState:s,isAudioCastDownloadEnabled:I,caption:i})),R=(t,n,r,s)=>{const i=(0,bo.A)(),l={messageId:i,feedbackSectionPosition:o.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:"Podcast Card",contextData:{cardMetaData:JSON.stringify({})}}},c=w;return e.setChatMessageData(a._.ChatCardWrapper,{chatCardWrapperProps:{user:"chat",element:L(i,c,"Podcast",t,r,s)}},l,!1),i},O=(t,n,r,s)=>{const i={messageId:t,feedbackSectionPosition:o.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:"Podcast Card",contextData:{cardMetaData:JSON.stringify({})}}};e.updateMessage(a._.ChatCardWrapper,{chatCardWrapperProps:{user:"chat",element:L(t,n.content,n.heading,n.blobData,r,s)}},i,!1)},_=t=>{e.setChatMessageData(a._.Default,{defaultMessageProps:{user:Af.Q9.Chat,messageHeader:{text:t}}}),s(!1)};return{showPodcastAudioPlayer:c,podcastUIProps:d,audiocastAugloopResponseHandler:(e,t,n)=>{!Mf.A.getInstance(l).isAugloopResponseTimeoutRequired(e.body?.H_?.T_)||S.isALHookEnabled&&S.isALRequestResponseEnabled||wf._.getInstance(l).clearAugloopResponseTimer();const r=e.body;yw.getInstance(l).audioCastALResponseReceived(r,`${f.current}`),yw.getInstance(l).setQuerySubmitTime(t),(0,qf.cY)(`AudioPlayer: audiocastAugloopResponseHandler SeqId: ${r.seqId} QueryId: ${r.queryId}`),m.current!=r.queryId?0===r.status?r.blob&&k(r):((e,t)=>{(0,qf.cY)("AudioPlayer: audioCast response is empty or error occurred ",e);const{message:n}=C(e);yw.getInstance(l).audioCastError(JSON.stringify(e),t),_(n),P(),m.current=t})(r.error,r.queryId):(0,qf.cY)("Discard previous request audioCastResponse",m.current)}}};var Cw=n(28461);const ww=(e,t,n,r,s,i,l)=>{const c=(0,ry.D)(),u=Wf.j.getInstance(c),[d,h]=(0,N.useState)(!1),[p,g]=(0,N.useState)(void 0),[m,f]=(0,N.useState)(void 0),{getSsmlScript:y,getConversationScript:v,appendSsmlScript:b,appendConversationScript:C}=(()=>{const e=(0,N.useRef)({});return{getSsmlScript:t=>e.current[t].ssmlScript,getConversationScript:t=>e.current[t].conversationScript,appendSsmlScript:(t,n)=>{n&&t&&(e.current[t]||(e.current[t]={ssmlScript:"",conversationScript:""}),e.current[t].ssmlScript+="\n"+n)},appendConversationScript:(t,n)=>{n&&t&&(e.current[t]||(e.current[t]={ssmlScript:"",conversationScript:""}),e.current[t].conversationScript+="\n"+n)}}})(),w=(0,N.useRef)(!0),S=(0,N.useRef)(!1),E=(0,N.useRef)(!1),x=(0,N.useRef)(),I=(0,N.useRef)(0),A=(0,N.useRef)(0),P=(0,N.useRef)(0),k=(0,N.useRef)(""),T=(0,N.useRef)(!1),D=(0,N.useRef)([]),M=(0,N.useRef)(),L=(0,N.useRef)(new Map),R=(0,N.useRef)(),O=(0,N.useRef)(null),_=(0,mw.pU)();const B=(0,it.Lh)(_f.h3)||"I’ve created an audio overview based on the main themes in this document. Click below to listen and feel free to ask me any questions you may have.",F=(0,Ot.Y$)(),{submitOperation:U}=(0,sy.G)(),H=(0,N.useRef)([]),{isAudioCastDownloadEnabled:z,isAudioCastPinningEnabled:j,isAudioCastAutoPlayEnabled:V,isSaveToOneDriveEnabled:q,isAudioCastConfigureEnabled:W,isAudioCastRaiseHandEnabled:Q,isAudioCastOpenFullScreenEnabled:G}=F,Z=(e,t,n)=>{let r=new Uint8Array([]);if(e.blob){const i=e.blob.data.data,a=e.conversationScript;S.current=e.isFinal;const o=e.fileSensitivityInfo,l=!!(o&&o[0].errorMsg&&o[0].errorCode),u=o?o[0].fileName:void 0,d=e.queryId||"";k.current=d;const p=e.blob.sizeBytes,y=e.seqId,v=e.subSeq;if(D.current=o?.filter((e=>e&&e?.webUrl?.trim())).map((e=>e.webUrl))||[],(0,qf.cY)(`AudioPlayer: handleAudioCastResponse seqId: ${y} ${v} isFirsResponse: ${w.current} isFinal: ${S.current} queryId: ${k.current} size ${p} caption: ${a} filename: ${u}`),void 0!==i){r=new Uint8Array(i);const e=Y(r,"audio/mp3");h(!0);const y={id:(0,bo.A)(),heading:"Podcast",content:B,blobData:r,uiStates:"LOADING",caption:a};if(g(y),w.current)(0,qf.cY)("AudioPlayer AudioCast First response received"),f(o?.[0]?.toolTip&&o?.[0]?.toolTip?.length>0?te({id:o?.[0]?.sensitivityId??"",displayName:o?.[0]?.sensitivityLabel,tooltip:o?.[0]?.toolTip,color:o?.[0]?.color,isEncrypted:o?.[0]?.isEncrypted,priority:0}):n&&n.tooltip?.length>0?te(n):void 0),t?(T.current=!0,M.current=t,re(M.current,"STREAMING_START",e,a,u,d,m,S.current,l)):(T.current=!1,M.current=ne(e,a,u,d,m,S.current,l)),w.current=!1,yw.getInstance(c).audioCastFirstChunk(d),P.current=p;else{(0,qf.cY)("AudioPlayer AudioCast Update response received"),P.current+=p;let t="STREAMING_UPDATE";S.current&&(t="STREAMING_END"),re(M.current,t,e,a,u,d,m,S.current)}S.current&&((0,qf.cY)("AudioPlayer AudioCast Final response received"),yw.getInstance(c).audioCastCompleted(d,P.current),K()),s(!1)}}else(0,qf.cY)("AudioCast response is too large")},Y=(e,t)=>{let n="";for(let t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return`data:${t};base64,${btoa(n)}`},K=()=>{(0,qf.cY)("AudioPlayer: resetAudioCastState"),w.current=!0,E.current=!1,I.current=0,A.current=0,M.current=void 0,L.current.clear(),P.current=0,H.current=[]},J=async(e,s,a)=>{const o=e.seqId??I.current,l=e.subSeq??0,c=e.isFinal??!1,u=I.current,d=A.current;if((0,qf.cY)(`AudioPlayer: Processing audioCastResponse Received chunk ${o}_${l}, expected chunk ${u}_${d}  QueryId; ${e.queryId}`),o<u-1||o==u-1&&l<d||S.current&&e.queryId==k.current)return void(0,qf.cY)(`audioCastResponse is already processed ${o}_${l}`);const h=o===u&&0===l,p=o===u-1&&l===d,g=c;if((0,qf.cY)(`AudioPlayer isNextSeqIdMatch ${h}, isSameSeqNextSubSeqMatch ${p}, isFinalReset ${g}`),h||p||g)Z(e,s,a),g?(I.current=0,A.current=0):h?(I.current+=1,A.current=1):p&&(A.current+=1),(0,qf.cY)(`AudioPlayer nextExpectedChunk ${I.current} nextExpectedSubSeq current ${A.current}`),X(e.queryId,s,a);else{(0,qf.cY)(`Storing audioCastResponse in buffer with seqId: ${o}`);const s=`${o}_${l}`;L.current.set(s,e),E.current||((0,qf.cY)("AudioCast retryAudioCastRequest queryId ",e.queryId),$(e.queryId,r,U,F,t,n,i),E.current=!0)}},X=(e,t,n)=>{for(;;){const r=`${I.current}_${A.current}`,s=L.current[r];if(!s)break;(0,qf.cY)(`processAudioCastResponseQueue audioCastResponse in buffer with key: ${r} queryId: ${s.queryId}`),yw.getInstance(c).audioCastQueueProcessing(e,s.queryId),Z(s,t,n),L.current.delete(s),s.isFinal&&(x.current=e)}},$=async(e,t,n,r,s,i,a)=>{try{const o=s.isFeatureGateEnabledFromClient(Af.WT.IsCopilotPluginEnabled)?i.getEnabledPlugins():[],l=(0,bo.A)();(0,qf.cY)(`AudioCast retryAudioCastRequest retryRequestId ${l} currentRequestId: ${e}`);const u=await s.getDefaultSignalOperation("Generate an audio overview from this document",l,iy.c.currentChatId??void 0,void 0,void 0,o,void 0,void 0,void 0,void 0,void 0,void 0,t.current?.getRawCanvasSelections?.(),void 0,a),{operation:d,workflowAnnotationType:h}=u;wf._.getInstance(c).setAugloopResponseTimer(h),r.isALHookEnabled?n(d,h):Cf.E.getInstance(c).submitOperation(d,h),yw.getInstance(c).audioCastRetry(e,l)}catch(e){throw(0,qf.cY)("AudioCast retry: Exception:"+JSON.stringify(e)),s.updateCopilotState(Tf.SG.QUERY_SUBMITTED_FAILED),wf._.getInstance(c).clearAugloopResponseTimer(),e}},ee=(e,n,r,s,i,a,o,l,c,u,d)=>({audioId:n,audioUrls:H.current,isBuffering:!o,content:e,fileName:r,audioPlayerError:a?{name:a.name,message:a.message,stack:a.stack}:void 0,downloadFileName:r,isPinningEnabled:j,isDownloadAllowed:z&&!d,isSaveToOneDriveEnabled:q&&void 0!==r&&!d,isFullScreenEnabled:G,isConfigureEnabled:W,isQueueVisible:!1,isAskQuestionAllowed:!1,isRaiseHandAllowed:Q,isContentVisible:!0,shouldPlay:s??!1,userQueryGuid:i,isDebugEnvironment:t.getHostSettings().devBuild??!1,documentUrl:D.current,ssml:{ssmlScript:y(i),conversationScript:v(i)},hostAppInfo:{name:t.getHostSettings().appName,platform:t.getHostSettings().appPlatform??""},feedbackData:l?JSON.stringify(l):void 0,telemetryData:JSON.stringify(c),fullPaneErrorInfo:u});function te({id:e,displayName:t,tooltip:n,color:r,isEncrypted:s}){return{iconType:s?hl.JF.Encryption:hl.JF.NonEncryption,tooltipText:n??"",labelId:e,badgeText:t,color:r}}const ne=(t,n,r,s,i,l,u)=>{const d=(0,bo.A)();t&&H.current.push(t);const h={feedbackArea:"Podcast Card",contextData:{cardMetaData:JSON.stringify({})}},p={correlationId:s,featureName:yw.getInstance(c).getFeatureName()},g=JSON.stringify(p),m={messageId:d,clpSensitivityIndicatorData:i,feedbackSectionPosition:o.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:h,telemetryData:g},f=ee(B,d,r,l,s,void 0,l,h,p,void 0,u);return e.setChatMessageData(a._.ChatCardWrapper,{chatCardWrapperProps:{user:Af.Q9.Chat,renderData:{shouldMemoizeComponent:!0,component:"PodcastUI",props:f},textContent:""}},m,!1),O.current={audioPlayerProps:f,chatMessageData:m,fileName:r,queryId:s,clpSensitivityIndicatorData:i,isFinalResponse:l},R.current=d,d},re=(t,n,r,s,i,l,u,d,h)=>{const p={feedbackArea:"Podcast Card",contextData:{cardMetaData:JSON.stringify({})}},g={correlationId:l,featureName:yw.getInstance(c).getFeatureName()},m={messageId:t,clpSensitivityIndicatorData:u,feedbackSectionPosition:o.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:p,telemetryData:JSON.stringify(g)};H.current.push(r||"");const f=ee(B,t,i,V??!1,l,void 0,d,p,g,void 0,h);e.updateMessage(a._.ChatCardWrapper,{chatCardWrapperProps:{user:Af.Q9.Chat,renderData:{shouldMemoizeComponent:!0,component:"PodcastUI",props:f},textContent:"This is a podcast audio cast generator card"}},m,"STREAMING_END"===n&&!T.current),"STREAMING_END"===n&&d&&(R.current=t,O.current={audioPlayerProps:f,chatMessageData:m,fileName:i,queryId:l,clpSensitivityIndicatorData:u,isFinalResponse:d})},se=(t,n,r,i,u,d)=>{if(w.current)((t,n,r,s)=>{const i=[];let c=t;if(F?.enableReadAloudAlternativeForPodcast&&l?.errorMapping){const e=l.errorMapping[r];e?.errorUXString&&(c=e.errorUXString),e?.actionButton&&i.push(e.actionButton)}""!==n?e.updateMessage(a._.Default,{defaultMessageProps:{user:Af.Q9.Chat,messageHeader:{text:t}}},{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,feedbackData:{feedbackArea:"Podcast Card",contextData:{cardMetaData:JSON.stringify({})}},isFailure:!0,showAnimation:!1,actionButtonList:i.length>0?i:void 0},!T.current):e.setChatMessageData(a._.Default,{defaultMessageProps:{user:Af.Q9.Chat,messageHeader:{text:c}}},{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,feedbackData:{feedbackArea:"Podcast Card",contextData:{cardMetaData:JSON.stringify({})}},isFailure:!0,showAnimation:!1,actionButtonList:i.length>0?i:void 0},!T.current),ie(r,t,s)})(i,n,r,u);else{((t,n,r,s,i,l,u)=>{const d=new Cw.g(n);d.message=r;const h={feedbackArea:"Podcast Card",contextData:{cardMetaData:JSON.stringify({})}},p={correlationId:i,featureName:yw.getInstance(c).getFeatureName()},g={messageId:s,clpSensitivityIndicatorData:l,feedbackSectionPosition:o.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:h,telemetryData:JSON.stringify(p)};e.updateMessage(a._.ChatCardWrapper,{chatCardWrapperProps:{user:Af.Q9.Chat,renderData:{shouldMemoizeComponent:!0,component:"PodcastUI",props:ee(t,"","",!1,i,d,void 0,h,p,u)},textContent:"This is a podcast audio cast generator card"}},g,!T.current)})(t,r,i,n,u,d,{errorType:r,errorMessage:i,userQueryGuid:u})}s(!1)},ie=(t,n,r)=>{if(R.current&&O.current){const s={errorType:t,errorMessage:n,userQueryGuid:r},i=O.current,o={...i.audioPlayerProps,fullPaneErrorInfo:s};e.updateMessage(a._.ChatCardWrapper,{chatCardWrapperProps:{user:Af.Q9.Chat,renderData:{shouldMemoizeComponent:!0,component:"PodcastUI",props:o},textContent:"This is a podcast audio cast generator card"}},i.chatMessageData,!1)}};return{showPodcastAudioPlayer:d,podcastUIProps:p,audiocastAugloopResponseHandlerV2:async(e,t,n,r,s)=>{!Mf.A.getInstance(c).isAugloopResponseTimeoutRequired(e.body?.H_?.T_)||F.isALHookEnabled&&F.isALRequestResponseEnabled||wf._.getInstance(c).clearAugloopResponseTimer(),r&&(T.current=!0);const i=e.body;yw.getInstance(c).audioCastALResponseReceived(i,`${I.current}_${A.current}`),yw.getInstance(c).setQuerySubmitTime(t),(0,qf.cY)(`AudioPlayer: audiocastAugloopResponseHandlerV2 SeqId: ${i.seqId} ${i.subSeq} QueryId: ${i.queryId}`),x.current!=i.queryId?0===i.status?(i.blob&&((0,qf.cY)("AudioPlayer: audiocastAugloopResponseHandlerV2 blob received"),J(i,r,s)),i.ssml&&b(i.queryId||"",i.ssml),!i.blob&&i.conversationScript&&C(i.queryId||"",i.conversationScript)):((e,t,n)=>{(0,qf.cY)("AudioPlayer: audioCast response is empty or error occurred ",e);const{errorType:r,message:s}=_(e,w.current);u.logErrorWithAshaVetoAndError([{key:Pf.qN,value:t}],Pf.Z_.AudioOverview,"",Pf.G8.AudioOverviewCreationFailed,r,!1,Pf.RX.Listen),yw.getInstance(c).audioCastError(JSON.stringify(e),t),se(B,n??M.current??"",r,s,t,m),K(),x.current=t})(i.error,i.queryId,r):(0,qf.cY)("AudioPlayer Discard previous request audioCastResponse",x.current)}}};var Sw=n(67179);const Ew=(0,N.lazy)((()=>Promise.all([n.e(9037),n.e(3341),n.e(5016)]).then(n.bind(n,67082)).then((e=>({default:e.PodcastUI}))))),xw=(e,t,n)=>{const r=(0,ry.D)(),[s,i]=(0,N.useState)(!1),[l,c]=(0,N.useState)(void 0),u=(0,N.useRef)(!0),d=(0,N.useRef)(),h="I've created a Podcast based on the main themes in this document. Click below to listen. Enjoy your podcast, and feel free to ask any questions you may have in Chat below.",p=e=>{try{return JSON.parse(e).message||""}catch(e){return""}},g=(e,t,r,s,i)=>N.createElement(N.Suspense,{fallback:N.createElement("div",null,"Loading...")},N.createElement(Ew,{id:e,content:t,heading:r,blobData:s,type:n?"AUDIO_CAST":"DEFAULT",streamingState:i})),m=(t,n,r)=>{const s=(0,bo.A)(),i={messageId:s,feedbackSectionPosition:o.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:"Podcast Card",contextData:{cardMetaData:JSON.stringify({})}}},l=h;return e.setChatMessageData(a._.ChatCardWrapper,{chatCardWrapperProps:{user:"chat",element:g(s,l,"Podcast",t,r)}},i,!1),s},f=(t,n,r)=>{const s={messageId:t,feedbackSectionPosition:o.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:"Podcast Card",contextData:{cardMetaData:JSON.stringify({})}}};e.updateMessage(a._.ChatCardWrapper,{chatCardWrapperProps:{user:"chat",element:g(n.id,n.content,n.heading,n.blobData,r)}},s,!1)},y=n=>{e.setChatMessageData(a._.Default,{defaultMessageProps:{user:Af.Q9.Chat,messageHeader:{text:n}}}),t(!1)};return{showPodcastAudioPlayer:s,podcastUIProps:l,podcastAugloopResponseHandler:(e,n)=>{(0,qf.cY)("Podcast podcastAugloopResponseHandler"),Mf.A.getInstance(r).isAugloopResponseTimeoutRequired(e.body?.H_?.T_)&&wf._.getInstance(r).clearAugloopResponseTimer();const s=e.body;s.requestType===Sw.d2.PODCAST_CREATION&&(s.podcastResponse?((0,qf.cY)("Podcast response received",s),(e=>{let n=new Uint8Array([]);if(e.blob.sizeBytes<=2e6){(0,qf.cY)("Podcast response is within bounds");const r=e.blob.data.data,s=e.response,a=e.isFinal,o=p(s??"");if((0,qf.cY)("Podcast response message",o),void 0!==r){n=new Uint8Array(r),(0,qf.cY)("speechData ",n),(0,qf.cY)(" blobData ",r),i(!0);const e={id:(0,bo.A)(),heading:"Podcast",content:h,blobData:n,uiStates:"LOADING"};if(c(e),(0,qf.cY)("officeai isFirstResponse",u.current),(0,qf.cY)("officeai isFinalResponse",a.current),u.current)d.current=m(n,o,"STREAMING_START"),u.current=!1;else{let t="STREAMING_UPDATE";a&&(t="STREAMING_END"),f(d.current,e,t)}a&&(u.current=!0,d.current=void 0),t(!1)}}else(0,qf.cY)("Podcast response is too large");(0,qf.cY)("Speech data blob",n)})(s.podcastResponse)):s.error&&((0,qf.cY)("Podcast response is empty or error occurred"),y(Df.i7)))}}},Iw={wrapperMargin:{...gt.Pt.padding(0,Dr.nT)},wrapperContainer:{...gt.Pt.margin(0,"auto"),maxWidth:Dr.tu,minWidth:Dr.Z$}},Aw=(0,mt.n)(Iw);var Pw=n(14553),kw=n(24707),Tw=n(79780),Dw=n(54264);const Mw=function(e,t,n){var r=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return(0,Dw.A)(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),(0,Tw.A)(e,t,{leading:r,maxWait:t,trailing:s})};var Lw=n(53355),Rw=n(246),Nw=n(88818);const Ow=(0,mt.n)({toaster:{width:"max-content",maxWidth:"302px",zIndex:10}}),_w=()=>{const e=Ow();return N.createElement(Rw.l,{className:e.toaster,toasterId:Nw.hU,shortcuts:{focus:e=>e.ctrlKey&&"m"===e.key},position:"top",pauseOnHover:!0,timeout:Nw.Fl,limit:Nw.nw,offset:{horizontal:Nw.my,vertical:Nw.c}})};class Bw{constructor(e){this.clientInfo=e}getUserContext(){if(!this.userInfo){const e=this.clientInfo;this.userInfo={dataResidency:this.getDataResidency(e.physicalRing),id:e.aadUserId,displayName:e.userName}}return this.userInfo}getHostContext(){if(!this.hostInfo){const e=this.clientInfo;this.hostInfo={host:{clientType:e.clientType,name:w.UH.office,sessionId:e.sessionId,version:"1.0"},locale:e.locale,sessionId:e.sessionId,theme:w.BD.default}}return this.hostInfo}getDataResidency(e){switch(e){case"dod":return M.jI.DOD;case"doj":return M.jI.DOJ;default:return M.jI.Public}}}const Fw=e=>{const[t,n]=(0,N.useState)(!1),[r,s]=(0,N.useState)({id:"1",heading:"Podcast",content:"",blobData:new Uint8Array([]),type:"AUDIO_CAST",streamingState:"STREAMING_INIT"}),i=(0,ry.D)(),a=(0,N.useRef)(!0),o=(0,N.useRef)(),l=(0,Ot.Y$)(),c=e=>{try{return JSON.parse(e).message||""}catch(e){return""}};return{showPodcastAudioPlayer:t,ComphrehensionPodcastUIProps:r,comprehensionPodcastResponseHandler:(t,u)=>{(0,qf.cY)("Podcast comprehensionPodcastResponseHandler"),!Mf.A.getInstance(i).isAugloopResponseTimeoutRequired(t.body?.H_?.T_)||l.isALHookEnabled&&l.isALRequestResponseEnabled||wf._.getInstance(i).clearAugloopResponseTimer();const d=t.body;d.requestType===Sw.d2.PODCAST_CREATION&&d.podcastResponse&&((0,qf.cY)("Podcast response received",d),(t=>{let i=new Uint8Array([]);if(t.blob.sizeBytes<=2e6){(0,qf.cY)("Podcast response is within bounds");const l=t.blob.data.data;let u;const d=t.response,h=t.isFinal,p=c(d??"");(0,qf.cY)("Podcast response message",p),void 0!==l&&(i=new Uint8Array(l),(0,qf.cY)("speechData ",i),(0,qf.cY)(" blobData ",l),n(!0),(0,qf.cY)("officeai isFirstResponse",a.current),(0,qf.cY)("officeai isFinalResponse",h.current),a.current?(u="STREAMING_START",a.current=!1):(u="STREAMING_UPDATE",h&&(u="STREAMING_END")),s({...r,blobData:i,streamingState:u}),h&&(a.current=!0,o.current=void 0),e(!1))}else(0,qf.cY)("Podcast response is too large");(0,qf.cY)("Speech data blob",i)})(d.podcastResponse))}}};var Uw=n(20255),Hw=n(54954),zw=n(79431);const jw=!0,Vw=(e,t=!1)=>{if((0,qf.cY)(" SuggestionPrompts shown from suggestedqna cache"),!e||e.length<2)return[];return(t?(0,Vf.q6)([...e]):[...e]).slice(0,2).map((e=>e.question))},qw=(e,t,n,r,s,i,a,o,l,c,u,d)=>{const h=(0,ry.D)(),p=Wf.j.getInstance(h),[g,m]=(0,N.useState)([]),f=(0,N.useRef)([]),y=(0,N.useRef)(zf.A.getInstance(h,n)),v=(0,N.useCallback)(((n,s)=>{e.current?.setInputText(Df.u1);const i=nw(f.current,n);if(n&&i)return sw(i,b?.isOutputV2Enabled??!1,r??!1,d,p,h),p.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.SuggestionPaneSuggestionClicked}]),p.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.QuerySubmittedByUser}]),p.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.CachedBasicChatResponseShown},{key:Pf.h3.IsFromCache,value:!0}]),p.logTriedEvent([],Pf.Nx,Pf.Z_.ChatQnA,Pf.rf.QAandSummaries,void 0,Pf.RX.Ask,Pf.EF.BasicChat),p.setUserQueryGuid(Df.u1),void m(Vw(f.current,jw));t({text:n,telemetryData:Pf.a5.SuggestionPaneSuggestionClicked,requestMetaData:s})}),[t]),b=(0,Ot.Y$)(),C=(0,N.useCallback)((e=>{if(!Array.isArray(e)||!b.showPromptSuggestionsWithOutput)return;const t=tw(e,r);t?.length>0&&(f.current=t,m(Vw(f.current,jw)))}),[]);return{getProps:(0,N.useCallback)(((e={suggestionList:[],showRefreshButton:!1},t)=>{const n=e?.suggestionList.length>0;n?(0,qf.cY)(" SuggestionPrompts shown from AL"):!c.current&&g.length>0&&p.logSeenEvent([],Pf.Nx,Pf.Z_.ChatQnA,Pf.rf.QAandSummaries,Pf.RX.Ask,Pf.EF.BasicChat);return{suggestionList:n?e.suggestionList:c.current?[]:g,showRefreshButton:n&&e?.showRefreshButton||!c.current&&g.length>0,handleSuggestionPillClick:async t=>{y.current.sendLoggingEventToClient(Tf.Yk.SuggestionPillClicked,{suggestionClicked:t}),(0,Qf.$w)(Df.u1),v(t,e?.requestMetaData?.[t]),(0,qf.cY)(t,"officeaicopilot-chat: onClickSuggestionPill")},handleRefreshButtonClick:async()=>{if(p.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.RefreshPillsButtonClicked}]),!n&&f.current.length>0){const e=Vw(f.current,jw);m(e)}else e?.onRefreshButtonClicked?.();(0,qf.cY)("officeaicopilot-chat: onClickRefreshButton")},refreshButtonPosition:t}}),[g,v]),updateSuggestedQnAForCachedSuggestedPrompts:C,shouldShowSuggestionPrompts:()=>{const e=u?.suggestionPillsUiProps?.suggestionList,t=e&&e.length>0&&!(0,qf.hX)(e[0]),n=!s&&(t||f.current.length>0);return n&&(0,qf.cY)("Suggestion Prompts are shown"),(!i&&a||o)&&!l&&n}}};var Ww=n(73448);class Qw{constructor(e){this.telemetryLoggerUtils=Wf.j.getInstance(e)}static getInstance(e){return fw.T.getFeatureFlags()?.isSingletonInstanceManagerEnabled&&e?fw.T.getSingleton(Qw,e,(()=>new Qw(e))):(Qw.instance||(Qw.instance=new Qw),Qw.instance)}getRecord(e){let t="";if(e.props)try{t=JSON.stringify(e.props)}catch(e){(0,qf.cY)("CopilotExtAuth Error while stringifying requestProps:",e)}let n="",r="";return e.correlationVector?(n=Ww.FG[e.tag].toString()??"",r=Ww.Ih[e.name]?.toString()??""):(n=Ww.d7[e.tag].toString()??"",r=Ww.kA[e.name]?.toString()??""),{tag:n,name:r,duration:e.duration??"",success:e.success??"",correlationVector:e.correlationVector??"",diagnosticData:e.diagnosticsData??"",props:t,eventId:e.eventId}}LogEvent(e){if((0,qf.cY)("CopilotExtAuth Info: ",e),!e.type||!e.tag||!e.name)return;const t=this.getRecord(e);let n="";try{n=JSON.stringify(t)}catch(e){return void(0,qf.cY)("CopilotExtAuth Error while stringifying chatEventData:",e)}switch(e.type){case CC.FY.LogInfo:case CC.FY.LogMetric:this.logInfo(n);break;case CC.FY.LogError:case CC.FY.LogException:this.logError(n)}}logInfo(e){this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ExtAuthPerformed},{key:Pf.h3.ChatEventParameters,value:e}])}logError(e){this.telemetryLoggerUtils.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:e},{key:Pf.IC.ErrorType,value:Pf.q0.Client},{key:Pf.IC.ErrorCode,value:Af.O4.ExtAuthError},{key:Pf.IC.ErrorCategory,value:kf.S2.ChatEvents}])}}class Gw{constructor(e){this.telemetryLogger=Qw.getInstance(e)}static getInstance(e){return fw.T.getFeatureFlags()?.isSingletonInstanceManagerEnabled&&e?fw.T.getSingleton(Gw,e,(()=>new Gw(e))):(Gw.instance||(Gw.instance=new Gw),this.instance)}LogInfo(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)}LogError(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)}LogException(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)}LogWarning(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)}LogVerbose(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)}LogMetric(e){this.telemetryLogger&&this.telemetryLogger.LogEvent(e)}}var Zw=n(67682),Yw=n(29605);const Kw={Root:{padding:"30px 0px",height:"100%",overflow:"auto",display:"flex",width:"92%",maxWidth:Dr.tu,...gt.Pt.margin("auto",Dr.nT),alignSelf:"center",flexDirection:"column"},UserPromptStyle:{display:"flex",justifyContent:"flex-end",marginLeft:"auto",marginBottom:"20px",backgroundColor:Pt.L.colorBrandBackground2,width:"fit-content",borderRadius:Pt.L.borderRadiusXLarge,...gt.Pt.padding("7px","15px")},LoopCardContainerStyle:{display:"flex",flexDirection:"column",maxHeight:"auto",background:Pt.L.colorNeutralBackground1,borderRadius:"10px",boxShadow:`0 4px 8px ${Pt.L.colorNeutralStroke2}`,paddingTop:"10px",paddingBottom:"10px",zIndex:"1",flexGrow:"4",overflow:"auto",...gt.Pt.margin("0px","10px","10px","7px")},ExpandButtonStyle:{justifyContent:"flex-end",marginLeft:"auto"},FooterButtonsStyle:{...gt.Pt.margin("0px","5px"),backgroundColor:"inherit"},FooterContainerStyle:{display:"flex",...gt.Pt.padding("10px"),maxHeight:"20px",backgroundColor:Pt.L.colorNeutralBackground3,borderBottomLeftRadius:"10px",borderBottomRightRadius:"10px",zIndex:"0",flexGrow:"4",rowGap:Pt.L.spacingVerticalS,columnGap:Pt.L.spacingHorizontalXS},DividerStyle:{...gt.Pt.padding("0px"),alignItems:"center",flexGrow:"0"},LoadingContainerStyle:{width:"95%",maxHeight:"auto",height:"100%",marginRight:"1vw"},LoadingItemStyle:{...gt.Pt.margin("20px","0px","20px","25px"),maxWidth:"100%"},NavigationContainerStyle:{display:"flex",justifyContent:"space-between"},NavigationButtonStyle:{...gt.Pt.margin("0px","5px"),height:"30px"},SuggestionsContainerStyle:{marginLeft:Dr.nT},ShowOriginalLoopCardStyle:{display:"flex",flexDirection:"column",marginBottom:"10px",maxHeight:"auto",height:"100%",background:Pt.L.colorNeutralBackground6,borderRadius:"10px",boxShadow:`0 4px 8px ${Pt.L.colorNeutralStroke2}`,...gt.Pt.padding("30px","35px"),overflow:"auto"},LoadingContainerStyleWithStreaming:{marginTop:"-20px",position:"sticky",bottom:0,...gt.Pt.padding("0px","20px")},SuggestionsHiddenStyle:{...gt.Pt.margin("19px")}},Jw={SuggestionsContainerStyle:{marginLeft:Dr.nT,marginRight:Dr.nT,maxWidth:Dr.tu,width:"92%",alignSelf:"center"},FooterContainerStyle:{backgroundColor:"inherit"}},Xw=(0,mt.n)(Kw),$w=(0,mt.n)({...Kw,...Jw}),eS=(e,t)=>!e||t,tS=N.memo((({loopCard:e,userMessage:t,suggestionPills:n,onCloseLoopCard:r,isExecuting:a,chatLog:o,hasPrevMessages:l,hasNextMessages:c,currentMessageIndex:u,viewMessageTurnAtIndex:d,onCopyClick:h,onInsertClick:p,botMessage:g,onShowOriginalClick:m,showOriginalLoopCard:f,isStreamingEnabled:y,handoffButton:v})=>{const b=(()=>{const e=Xw(),t=$w();(0,i.xp)()===s.Y.win32&&(0,dt.bt)(e,t);return e})(),C=(0,it.kQ)({sideQuestInsertButtonLabel:ut.HdM,sideQuestEditButtonLabel:ut.AeU,sideQuestCollapseButtonTooltip:ut.qxv,sideQuestShowEditsButtonLabel:ut.KQN,sideQuestShowOriginalButtonLabel:ut.aIG,sideQuestCopyButtonTooltip:ut.OY5}),w=C.sideQuestInsertButtonLabel(),S=C.sideQuestCollapseButtonTooltip(),E=C.sideQuestShowOriginalButtonLabel(),x=C.sideQuestShowEditsButtonLabel(),I=C.sideQuestCopyButtonTooltip(),A=(0,sc.bM)(),[P,k]=N.useState(!1),[T,D]=N.useState(!1),M=N.useRef(null),L=N.useRef(null),R=N.useRef(null),O=N.useRef(null),_=()=>{k(!0)},B=()=>{k(!1)},F=()=>{D(!0)},U=()=>{D(!1)};return N.useEffect((()=>{M.current&&R.current?.setTarget(M.current),L.current&&O.current?.setTarget(L.current)}),[M,L,R,O]),N.createElement(N.Fragment,null,N.createElement("div",{className:b.Root},N.createElement("div",{className:b.NavigationContainerStyle},N.createElement(ct.$,{size:"small",icon:N.createElement(_i.nUb,null),disabled:!l,className:b.NavigationButtonStyle,onClick:()=>{d&&d(u-2)},onMouseEnter:_,onMouseLeave:B,ref:M}),N.createElement(Es.W,{open:P&&l,positioning:{positioningRef:R}},N.createElement(As.b,{onMouseEnter:_,onMouseLeave:B},N.createElement(Ps.c,null,o&&o.length>0&&o.map(((e,t)=>{if("human"===e.body.user&&t<u&&t!==u-1)return N.createElement(ks.D,{key:t,onClick:()=>{d&&d(t+1),k(!1)}},e.body.message)}))))),N.createElement(ct.$,{size:"small",icon:N.createElement(_i.Crl,null),disabled:!c,className:b.NavigationButtonStyle,onClick:()=>{d&&d(u+2)},onMouseEnter:F,onMouseLeave:U,ref:L}),N.createElement(Es.W,{open:T&&c,positioning:{positioningRef:O}},N.createElement(As.b,{onMouseEnter:F,onMouseLeave:U},N.createElement(Ps.c,null,o&&o.length>0&&o.map(((e,t)=>{if("human"===e.body.user&&t>u)return N.createElement(ks.D,{key:t,onClick:()=>{d&&d(t+1),D(!1)}},e.body.message)}))))),N.createElement("div",{className:b.UserPromptStyle},N.createElement(rc.A,{styles:A,body:{...(0,Rn.u8)(t),user:"human"}}))),N.createElement("div",{className:f?b.ShowOriginalLoopCardStyle:b.LoopCardContainerStyle},!y&&eS(e,a)&&N.createElement(Mb.E,{className:b.LoadingContainerStyle},N.createElement(Lb.H,{size:24,className:b.LoadingItemStyle}),N.createElement(Lb.H,{size:24,className:b.LoadingItemStyle}),N.createElement(Lb.H,{size:24,className:b.LoadingItemStyle})),f&&N.createElement(rc.A,{styles:A,body:{...g?.body,message:g?.body?.originalMessage??g?.body?.message,showOriginalMessage:!0,showEditedView:!1},references:g?.references,annotationReferences:g?.annotationReferences}),(y||!eS(e,a))&&!f&&e,y&&a&&N.createElement("div",{className:b.LoadingContainerStyleWithStreaming},N.createElement($i,{loadingUiStrings:["Loading..."]}))),N.createElement(Cs.M,{className:b.FooterContainerStyle},N.createElement(Jt.m,{content:w,relationship:"label"},N.createElement(ct.$,{className:b.FooterButtonsStyle,icon:N.createElement(ca.o9b,null),onClick:p,disabled:a},w)),v,N.createElement(Jt.m,{content:I,relationship:"label"},N.createElement(ct.$,{size:"small",icon:N.createElement(_i.Qvr,null),onClick:h,appearance:"subtle",className:b.FooterButtonsStyle,disabled:a})),N.createElement(Jt.m,{content:f?x:E,relationship:"label"},N.createElement(ct.$,{icon:f?N.createElement(ca.wLW,null):N.createElement(ca.OBi,null),appearance:"subtle",className:b.ExpandButtonStyle,onClick:m,disabled:a},f?x:E)),N.createElement(bn.c,{vertical:!0,className:b.DividerStyle}),N.createElement(Jt.m,{content:S,relationship:"label"},N.createElement(ct.$,{icon:N.createElement(rr.up$,null),onClick:()=>r?r():{},appearance:"subtle",disabled:a},S)))),N.createElement("div",{className:n?b.SuggestionsContainerStyle:b.SuggestionsHiddenStyle},n))}));var nS;function rS(){const e=(0,ry.D)();return{logSideQuestEvent:(t,n)=>{(0,qf.cY)(`logSideQuestEvent: ${t}, parameter: ${n}`),Wf.j.getInstance(e).sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:t},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()},{key:Pf.h3.ChatEventParameters,value:n||""}])},logKeptEvent:t=>{const n=(e=>{try{return JSON.parse(e)}catch(e){(0,qf.cY)("Error parsing telemetry data ",e.message)}return{}})(t);(0,qf.cY)("logSideQuestKeptEvent: ",n),Wf.j.getInstance(e).logKeptEvent([{key:Pf.qN,value:n.correlationId||""}],Pf.Nx,n.featureName,(0,ev.A9)(n.featureName),void 0,(0,ev._w)(n.featureName))}}}!function(e){e.Start="Start",e.Flush="Flush",e.Append="Append",e.NoStream="NoStream"}(nS||(nS={}));var sS=n(89742);const iS=e=>{const{chatLog:t,setChatLog:n,suggestionPills:r,scrollToBottom:s,setIsSideQuestMode:i,currMessageIndex:o,getSideQuestEditor:l,isExecuting:c,loopComponentRef:u,setCurrentMessageIndex:d,insertOnClick:h,setChatInputDisabled:p,copilotCommunicationHandler:g,chatContainerBuilder:m,theme:f}=e,y=(0,Ot.Y$)(),v=(0,An.Mb)().hostAppSettings.window,b=(0,ry.D)(),C=v??window,{submitOperation:w,clearOperationListForResubmit:S}=(0,sy.G)(),E=(0,N.useRef)(!1),x=y?.isSideQuestMarkdownEnabled||y?.isSideQuestStreamingEnabled,I=rS(),[A,P]=(0,N.useState)(!1);(0,N.useEffect)((()=>{p(!!A)}),[A]);const k=async()=>{let e;return e=x?u?.current?.getLatestHtmlWithTables?await u.current.getLatestHtmlWithTables():"":"function"==typeof u?.current?.getLatestHtml?u.current.getLatestHtml():void 0,e},T=()=>"function"==typeof u?.current?.getLatestText?u.current.getLatestText():"",D=async()=>"function"==typeof u?.current?.getLatestMarkdown?await u.current.getLatestMarkdown():"",M=(e,t)=>{n(-1!==o?n=>{const r=[...n],s=r[o];s.body.message=e;const i=s.body.message!==s.body.originalMessage;return s.body.showEditedView=i,uS(t,r[o],y,w,S),r}:n=>{const r=[...n],s=cS(r,"chat");if(s){const n=r[s.body.chatCardIndex??r.length-1];n.body.message=e;const i=n.body.message!==n.body.originalMessage;n.body.showEditedView=i,uS(t,s,y,w,S)}return r})};let L,R;-1!==o?(L=t[o],R=lS(t,"human",o),L.body.chatCardIndex=o):(L=cS(t,"chat"),R=cS(t,"human"),L.body.chatCardIndex=L.chatCardIndex),L.body.showSideQuestView=!0,L.body.editButtonCallback=e=>{if(d(e),i(!0),I.logSideQuestEvent(Pf.a5.SideQuestEditButtonClicked),I.logKeptEvent(L.telemetryData),y?.enableClientEventsForSideQuest){const e={workflowAnnotationType:Df.u1,type:"ExpandPaneForSideQuest"};g?.sendEventToClient(Tf.PV.GenericMessageEvent,e)}else C.parent.postMessage({type:"ExpandPaneForSideQuest"},C.document.referrer)},L.body.originalMessage||(L.body.originalMessage=L.body.message);const O={isHandoffGetAnnotationsEnabled:y.isHandoffGetAnnotationsEnabled??!1,isHandoffInteractiveSummaryAndContentCallbackEnabled:y.isHandoffInteractiveSummaryAndContentCallbackEnabled??!0,renderChatHistoryInHandoffDestination:y.renderChatHistoryInHandoffDestination??!1,isHandoffEditInButtonSplit:y.isHandoffEditInButtonSplit??!0,openInWordMinimumForHeuristic:y.openInWordMinimumForHeuristic??5,isHandoffRTLEnabled:y.isHandoffRTLEnabled??!1,isSideQuestEnabled:y.isSideQuestEnabled??!1,isHandoffLoadingPageEnabled:y.isHandoffLoadingPageEnabled??!1},_=y.isHandoffBookendingEnabled?e=>{m.setChatMessageData(a._.SystemMessage,(0,sS.IZ)("",e,"Opening","Created"))}:void 0,B=(0,sS.Go)(L,(()=>g.getALSession()),O,"",O.renderChatHistoryInHandoffDestination?iy.c.chatSessionId??void 0:void 0,_,v?.document,D,b),F=L.body.chatCardIndex-2,U=L.body.chatCardIndex+2;let H,z;y?.isSideQuestStreamingEnabled?(H=c||E.current?c&&!E.current?nS.Start:!c&&E.current?nS.Flush:nS.Append:nS.NoStream,z=l?.("",u,H,aS(L?.body?.message,y)??"",f.isDarkTheme),E.current=c):z=y?.isSideQuestMarkdownEnabled?c?l?.("",u):l?.("",u,nS.NoStream,aS(L?.body?.message,y)??"",f.isDarkTheme):c?l?.("",u):l?.(oS(L?.body?.message??""),u);const j=F>0&&!c,V=U<t.length&&!c&&L.body.chatCardIndex!==t.length-1;return N.createElement(tS,{loopCard:z,userMessage:R?.body?.message,suggestionPills:r,onCloseLoopCard:async()=>{const e=x?await D():await k();if(e&&M(e,T()),i(!1),s(),p(!1),I.logSideQuestEvent(Pf.a5.SideQuestCloseButtonClicked),y?.enableClientEventsForSideQuest){const e={workflowAnnotationType:Df.u1,type:"ResetPaneForSideQuest"};g?.sendEventToClient(Tf.PV.GenericMessageEvent,e)}else C.parent.postMessage({type:"ResetPaneForSideQuest"},C.document.referrer)},isExecuting:c,chatLog:t,hasPrevMessages:j,hasNextMessages:V,currentMessageIndex:L.body.chatCardIndex,viewMessageTurnAtIndex:async e=>{o>e||-1===o?I.logSideQuestEvent(Pf.a5.SideQuestLeftNavigationButtonClicked):I.logSideQuestEvent(Pf.a5.SideQuestRightNavigationButtonClicked);const t=x?await D():await k();t&&M(t,T()),d(e),p(!1),P(!1)},onCopyClick:async()=>{const e=await k()??"",t=T();A?(0,dt.Cu)("",void 0,oS(L.body.originalMessage)??"",v?.document,t):(0,dt.Cu)("",void 0,e,v?.document,t),I.logSideQuestEvent(Pf.a5.SideQuestCopyButtonClicked)},onInsertClick:async()=>{const e=await k()??"";if(I.logSideQuestEvent(Pf.a5.SideQuestInsertButtonClicked),I.logKeptEvent(L.telemetryData),h)try{A?await h(oS(L.body.originalMessage)??""):await h(e)}catch(e){(0,qf.cY)("Error inserting HTML content:",e)}else(0,qf.cY)("Insert handler is undefined.")},botMessage:L,onShowOriginalClick:async()=>{if(!A){const e=x?await D():await k();M(e,T())}P(!A),I.logSideQuestEvent(Pf.a5.SideQuestShowOriginalButtonClicked)},showOriginalLoopCard:A,isStreamingEnabled:y?.isSideQuestStreamingEnabled,handoffButton:B.handoffButton})},aS=(e,t)=>{if(!e)return"";const n=e.match(/<span class="main-info-start">\n*\n*(.*?)\n*\n*<\/span>/s);return n&&(e=n[1]),t?.showCitationsInSideQuest||(e=e.replace(/\[.*?\]\(.*?\)/g,"")),e},oS=e=>{let t=aS(e);return[{regex:/^### (.*$)/gim,replacement:"<h3>$1</h3>"},{regex:/^## (.*$)/gim,replacement:"<h2>$1</h2>"},{regex:/^# (.*$)/gim,replacement:"<h1>$1</h1>"},{regex:/\*\*(.*)\*\*/gim,replacement:"<b>$1</b>"},{regex:/\*(.*)\*/gim,replacement:"<i>$1</i>"},{regex:/\[(.*?)\]\((.*?)\)/gim,replacement:""}].forEach((({regex:e,replacement:n})=>{t=t.replace(e,n)})),t=t.replace(/(^- .*$|^\d+\. .*$)(\n^- .*$|^\n\d+\. .*$)*/gm,(e=>{const t=e.split("\n").map((e=>e.match(/^\d+\./)?e.replace(/^\d+\.\s(.*$)/,"<li>$1</li>"):e.replace(/^- (.*$)/,"<li>$1</li>"))).join("\n");return e.match(/^\d+\./)?`<ol>${t}</ol>`:`<ul>${t}</ul>`})),t=t.replace(/^(?!<h[1-3]>|\d+\.\s|<li(?:\s[^>]*)?>|<ul(?:\s[^>]*)?>|<ol(?:\s[^>]*)?>)(\n*)(.+?)(\n|$)/gm,((e,t,n)=>{const r=t.replace(/\n(?!<h[1-3]>|\d+\.\s|<li(?:\s[^>]*)?>|<ul(?:\s[^>]*)?>|<ol(?:\s[^>]*)?>)/g,'<br class="scriptor-paragraph" style="direction: ltr; text-align: left;">');return/^(<h[1-3]>|\d+\.\s|<li(?:\s[^>]*)?>|<ul(?:\s[^>]*)?>|<ol(?:\s[^>]*)?>)/.test(n)?`${r}${n}`:`${r}<div class="scriptor-paragraph">${n}</div>`})),t=t.replace(/\n\n/g,"<br>"),t.trim()},lS=(e,t,n)=>{for(let r=n-1;r>=0;r--)if(e[r].body?.user===t)return e[r];return null},cS=(e,t)=>e.slice().reverse().find((e=>e.body?.user===t)),uS=(e,t,n,r,s)=>{const{chatMessageForRichText:i,images:a}=(0,ey.Su)(t,n);let o="";try{o=JSON.stringify(i)}catch(e){(0,qf.cY)("error while stringify chat card props error:",e.message)}const l={content:e,entry:gf.CY.Pane,userRole:gf.gG.System,format:gf.Go.RichText,timestamp:Date.now(),messageId:(0,bo.A)(),status:gf.nW.Success,richTextJson:o,requestId:t.sideQuestMessageCorrelationId,images:a,messageType:wy.n3.AttachmentAction};(0,Sf.a_)({op:gf.S5.AddMessageOperation,copilotMessage:l,submitOperation:n?.isALHookEnabled?r:void 0,clearOperationListForResubmit:n?.isALHookEnabled?s:void 0})};var dS=n(34130),hS=n(29664);class pS{fetchCLPInfo(e){return{iconType:e?.isEncrypted?hl.JF.Encryption:hl.JF.NonEncryption,tooltipText:e?.tooltip??"",badgeText:e?.displayName??""}}}class gS{constructor(e,t,n){this.chatContainerBuilder=e,this.copilotCommunicationHandler=t,this.featureFlags=n}getFeedbackData(e){const t=this.copilotCommunicationHandler.getHostSettings().appName,n=this.copilotCommunicationHandler.getHostSettings().appPlatform,r=(0,pb.ZQ)(),s=(new Date).toISOString(),i={feedbackArea:(0,Df.rp)(t),contextData:{cardMetaData:JSON.stringify({prompt:e?.userMessage,promptId:e?.queryId,enabledPlugins:e?.enabledPluginsList?.map((e=>e.id)),errorMessage:e?.errorMessage,errorType:e?.errorType}),feedbackContextData:{prompt:e?.userMessage||"",promptId:this.featureFlags?.invokeTenantFeedbackServiceFromFeedbackSDK?"":e?.queryId||"",errorMessage:e?.errorMessage,errorType:e?.errorType,interactionId:this.featureFlags?.invokeTenantFeedbackServiceFromFeedbackSDK?(0,tC.Xf)():void 0},sydneyContextData:{requestId:e?.userMessage,utteranceTimeStamp:s,feedbackMessageId:(0,tC.Xf)(),conversationId:e?.conversationId||"",sydneyEndpoint:e?.sydneyEndpoint||"",locale:e?.locale},groundingSource:r,featureName:e?.featureName,subFeatureName:e?.subFeatureName,entryPoint:dS.K.Chat,enabledPlugins:e?.enabledPluginsList,feedbackClientAppName:this.featureFlags?.invokeTenantFeedbackServiceFromFeedbackSDK?t+n+"CopilotOCV":void 0}};return this.chatContainerBuilder.getRawFeedbackData(i.feedbackArea??"Copilot",i.contextData)}}class mS{constructor(){this.citationTitle="This document"}handleCitationClick(e){}}class fS{getClientInfo(){return(0,dt.XG)()}}class yS extends hS.k{constructor(){super({})}fetchActionButtons(e,t){return[]}fetchDebugActionButtons(e){return[]}}function vS(e,t,n,r){return{...{clpService:new pS,feedbackService:new gS(e,t,r),citationService:new mS,clientInfoService:new fS,actionButtonService:new yS},...n}}const bS=async(e,t,n,r=!1,s=!1,i,a)=>{const o=await t.getPlugins()??[];(0,pb.uX)(o,a),i?.setEnabledPlugins?.(o.map((e=>e.id)));if(n({pluginsInfo:o,workflowAnnotationType:ff.BN.getTypeName()}),0===o.length)return;const l=e=>{const t=o.filter((t=>t.id===(e=>{switch(e){case dC.$.Work:return Af.un.ENTERPRISE_SEARCH;case dC.$.Web:return Af.un.WEB_SEARCH}return""})(e.id)));return t.length?t[0]:void 0},c=[];e?.map((e=>{const t=e.state,n=l(e);let o=(e=>e?"blocked"===e.state?dC.p.Blocked:e.isEnabled?dC.p.Enabled:dC.p.Disabled:dC.p.Disabled)(n);o!=dC.p.Blocked&&n&&(e.id===dC.$.Work&&s||e.id===dC.$.Web&&r)&&(o=dC.p.Enabled),o===dC.p.Blocked?(t===dC.p.Enabled&&((0,qf.cY)(`Plugin is blocked by admin, turning off ${e.id} plugin Ux`),e.onToggle(!1,!0)),e.id===dC.$.Web&&i?.setWebSearchState(!0,r),c?.push(e.id),(0,pb.gE)(`${e.id}:AdminBlocked`,a)):(e.id===dC.$.Web&&o===dC.p.Enabled&&i?.setWebSearchState(!1,r),e.onToggle(o===dC.p.Enabled,!0),(0,pb.gE)(`${e.id}:${o===dC.p.Enabled?"AutoOn":"AutoOff"}`,a))}));const u=l({id:dC.$.Work,state:dC.p.Disabled,onToggle:()=>{}});return u&&u.state===Df.hi&&s&&i?.setEnterpriseSearchState(!1),c};var CS;!function(e){e[e.Podcast=0]="Podcast",e[e.Summary=1]="Summary"}(CS||(CS={}));var wS=n(17762),SS=n(42667);var ES=n(43574);class xS{constructor(){this.getProps=(e,t,n,r,s)=>({handleMsgDismissClick:e,titleText:t,bodyText:n,linkText:r,linkClickHandler:s})}}var IS=n(73087),AS=n(70090),PS=n(60145);var kS=n(2976);class TS extends kS.U{constructor(e,t){super(),this.tokenService=e,this.userInfo=t}acquireToken(e,t,n){return(0,y.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==r?void 0:r.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}class DS extends TS{constructor(e,t,n,r,s){super(n,r),this.notifySuccess=e,this.notifyFailure=t,this.externalAuthService=s}}class MS{constructor(e,t,n,r,s,i){this.userContext=e,this.hostContext=t,this.tokenService=n,this.telemetryService=r,this.hostWindow=s,this.externalAuthService=i}authenticate(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{var r,s;const i={user:this.userContext,app:this.hostContext,page:{id:(null===(r=e.appDefinition)||void 0===r?void 0:r.id)||"",frameContext:w.E2.authentication}},a=e=>(r,s)=>e?(t({code:r}),Promise.resolve()):(n(r),Promise.resolve()),o=new DS(a(!0),a(!1),this.tokenService,this.userContext,this.externalAuthService);(function(e,t,n,r,s){return(0,y.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((i,a)=>{var o,l;const c=(0,AS.z)(Object.assign(Object.assign({},t.appDefinition),{version:null!==(o=t.appDefinition.version)&&void 0!==o?o:"",appId:t.appDefinition.id,manifestVersion:null!==(l=t.appDefinition.manifestVersion)&&void 0!==l?l:""})),u={url:t.signInUrl,width:800,height:600,left:e.screen.availWidth/2-400,top:e.screen.availHeight/2-300};new PS.I(e,u,c,n,r,{log:function(e,t,n,r){}},s)?i(void 0):a("Unable to initialize auth extension")}))}))})(null!==(s=this.hostWindow)&&void 0!==s?s:window,e,o,i,this.telemetryService).catch((e=>{}))}))}))}getToken(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){return this.tokenService.getToken(e)}))}}var LS=n(5528);function RS(e,t){return(0,y.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.botInvoke(e);return Object.assign({},n)}))}class NS{constructor(e){this.serviceProvider=e}execute(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){const t=e,n=yield this.executeConfigOrAuthRequest(t,this.serviceProvider.telemetryService),r=Object.assign({},t.originalInvokeRequest);return n&&(r.requestBody.value.state=n,delete r.requestBody.value.authentication),yield RS(r,this.serviceProvider.channelService)}))}executeConfigOrAuthRequest(e,t){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var n;const r=e.originalInvokeRequest.appId,s=null===(n=e.originalInvokeRequest.requestBody.conversation)||void 0===n?void 0:n.id,i=yield this.serviceProvider.appService.getApp({id:r});let a;if(null==i?void 0:i.appDefinition)a=i.appDefinition;else{if(!(null==i?void 0:i.titleInfo))return null==t||t.LogError({eventId:CC.Bw.AuthSDK,type:CC.FY.LogError,name:Ww.kA.ExecuteConfigOrAuthRequest,tag:Ww.d7.AuthConfigRuntimeActivity,success:CC.YE.Failure,conversationId:s,diagnosticsData:"App Definition not found"}),Promise.reject("App Definition not found");a=(0,Oe.P)(i.titleInfo)}const o=yield this.serviceProvider.authService.authenticate({appDefinition:a,signInUrl:e.url});return null==o?void 0:o.code}))}}class OS{constructor(e){this.serviceProvider=e}execute(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,c;const u=e;if(!u.resource){const e=yield this.serviceProvider.appService.getApp({id:u.originalInvokeRequest.appId});u.resource=null!==(s=null!==(t=u.resource)&&void 0!==t?t:null===(r=null===(n=null==e?void 0:e.appDefinition)||void 0===n?void 0:n.webApplicationInfo)||void 0===r?void 0:r.resource)&&void 0!==s?s:null===(o=null===(a=null===(i=null==e?void 0:e.titleInfo)||void 0===i?void 0:i.titleDefinition)||void 0===a?void 0:a.webApplicationInfo)||void 0===o?void 0:o.resource}const d=yield this.executeSilentAuthRequest(u),h=null===(l=u.originalInvokeRequest.requestBody.conversation)||void 0===l?void 0:l.id;if(!d)return null===(c=this.serviceProvider.telemetryService)||void 0===c||c.LogError({eventId:CC.Bw.AuthSDK,type:CC.FY.LogError,name:Ww.kA.Execute,tag:Ww.d7.SilentAuthRuntimeActivity,success:CC.YE.Failure,conversationId:h,diagnosticsData:"Failed to fetch Auth token for the request"}),Promise.reject("Failed to fetch Auth token for the request");const p=Object.assign({},u.originalInvokeRequest);return p.requestBody.value.authentication={token:d},yield RS(p,this.serviceProvider.channelService)}))}executeSilentAuthRequest(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){if(!e.resource)return Promise.reject("Resource is undefined");const t=yield this.serviceProvider.authService.getToken({resource:e.resource,claims:e.claims,isSilent:e.isSilent});return Promise.resolve(null==t?void 0:t.authToken)}))}}class _S{constructor(e){this.serviceProvider=e}execute(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n;const r=e,s=null===(t=r.requestBody.conversation)||void 0===t?void 0:t.id;return this.serviceProvider.channelService?yield RS(r,this.serviceProvider.channelService):(null===(n=this.serviceProvider.telemetryService)||void 0===n||n.LogError({eventId:CC.Bw.AuthSDK,type:CC.FY.LogError,name:Ww.kA.Execute,tag:Ww.d7.BotInvokeRuntimeActivity,success:CC.YE.Failure,conversationId:s,diagnosticsData:"Channel service is not available"}),Promise.reject("Channel service is not available"))}))}}class BS{constructor(e,t){this.serviceProvider=e,this.authService=t}execute(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t;const n=e;if(!n.oauthConfigId&&n.url)window.open(n.url);else{const e={titleId:null==n?void 0:n.titleId,authConfigId:null==n?void 0:n.oauthConfigId,width:800,height:600};yield null===(t=this.authService)||void 0===t?void 0:t.authenticateWithOAuth2(e)}}))}}class FS{constructor(e,t,n,r,s){this.telemetryService=e,this.tag=t,this.name=n,this.start=Date.now(),this.isLoggingDone=!1,this.eventId=r,this.scenario=s,this.timeoutId=setTimeout((()=>{this.log({eventId:this.eventId,type:CC.FY.LogMetric,tag:this.tag,name:this.name,success:CC.YE.Timeout,duration:6e4,diagnosticsData:`Ended with Timeout , Scenario: ${this.scenario}`}),this.isLoggingDone=!0}),6e4)}setScenario(e){this.scenario=e}logMetricEnd(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{eventId:this.eventId,type:CC.FY.LogMetric,tag:this.tag,name:this.name,success:CC.YE.Successful,duration:n,correlationVector:t}))}}logMetricEndWithError(e,t){if(clearTimeout(this.timeoutId),!this.isLoggingDone){this.isLoggingDone=!0;const n=Date.now()-this.start;this.log(Object.assign(Object.assign({},e),{eventId:this.eventId,type:CC.FY.LogMetric,tag:this.tag,name:this.name,success:CC.YE.Failure,duration:n,correlationVector:t}))}}log(e){var t;null===(t=this.telemetryService)||void 0===t||t.LogMetric(e)}}var US,HS,zS,jS,VS,qS,WS,QS,GS;!function(e){e[e.None=0]="None",e[e.AppDefinitionIsUndefined=1]="AppDefinitionIsUndefined",e[e.AttributedDataNotFound=2]="AttributedDataNotFound",e[e.UserPrincipalNameIsNotAvailable=3]="UserPrincipalNameIsNotAvailable",e[e.HostLocaleIsUndefined=4]="HostLocaleIsUndefined",e[e.CardContentParseError=5]="CardContentParseError"}(US||(US={})),function(e){e[e.None=0]="None",e[e.MsgExtCardHeader=1]="MsgExtCardHeader",e[e.GetAppDataException=2]="GetAppDataException",e[e.VerifyCardException=3]="VerifyCardException",e[e.CreateMsgExtContext=4]="CreateMsgExtContext",e[e.GetAppDataForAPIPlugins=5]="GetAppDataForAPIPlugins"}(HS||(HS={})),function(e){e[e.None=0]="None",e[e.CardRender=1]="CardRender",e[e.CardActions=2]="CardActions",e[e.BotInvoke=3]="BotInvoke",e[e.GetApp=4]="GetApp",e[e.GetImage=5]="GetImage",e[e.OpenDialog=6]="OpenDialog",e[e.CitationOrEntityControl=7]="CitationOrEntityControl",e[e.ReferenceContainer=8]="ReferenceContainer",e[e.GetUserConfig=9]="GetUserConfig",e[e.FindAcquisition=10]="FindAcquisition",e[e.GetAndCacheAcquisition=11]="GetAndCacheAcquisition",e[e.CardService=12]="CardService",e[e.BrokeredCardService=13]="BrokeredCardService",e[e.APIPluginCardService=14]="APIPluginCardService",e[e.APIPluginHostService=15]="APIPluginHostService",e[e.APIPluginOAuth2Service=16]="APIPluginOAuth2Service",e[e.NativeCEACardService=17]="NativeCEACardService",e[e.NativeCEAAuthenticationService=18]="NativeCEAAuthenticationService",e[e.NativeCEAAuthRuntimeActivity=19]="NativeCEAAuthRuntimeActivity",e[e.CEACardService=20]="CEACardService",e[e.ExtCEACardService=21]="ExtCEACardService",e[e.ExtCEAChannelService=22]="ExtCEAChannelService",e[e.ExtAppCardActionsForDAService=23]="ExtAppCardActionsForDAService"}(zS||(zS={})),function(e){e[e.None=0]="None",e[e.GetHeaderOptions=1]="GetHeaderOptions",e[e.MsgExtCardReference=2]="MsgExtCardReference",e[e.MsgExtCard=3]="MsgExtCard",e[e.APIPluginCardReference=4]="APIPluginCardReference",e[e.APIPluginCard=5]="APIPluginCard",e[e.GetAppDataForAPIPlugins=6]="GetAppDataForAPIPlugins"}(jS||(jS={})),function(e){e[e.None=0]="None",e[e.M365CardRenderer=1]="M365CardRenderer",e[e.OpenUrlActivityRequest=2]="OpenUrlActivityRequest",e[e.ActionExecuteActivityRequest=3]="ActionExecuteActivityRequest",e[e.SigninActionActivityRequest=4]="SigninActionActivityRequest",e[e.SubmitActionActivityRequest=5]="SubmitActionActivityRequest",e[e.BotInvokeRequest=6]="BotInvokeRequest",e[e.BotInvokeFetchToken=7]="BotInvokeFetchToken",e[e.GetAppFromMOS3=8]="GetAppFromMOS3",e[e.GetImageProxyUrl=9]="GetImageProxyUrl",e[e.OpenStageView=10]="OpenStageView",e[e.OpenTaskModule=11]="OpenTaskModule",e[e.MsgExtCardPreview=12]="MsgExtCardPreview",e[e.MsgExtCitationOrEntityControl=13]="MsgExtCitationOrEntityControl",e[e.MsgExtCardReferenceContainer=14]="MsgExtCardReferenceContainer",e[e.GetUserConfigFrom3S=15]="GetUserConfigFrom3S",e[e.FindAcquisitionforMOS=16]="FindAcquisitionforMOS",e[e.GetAndCacheAcquisitionFromMOS3=17]="GetAndCacheAcquisitionFromMOS3",e[e.M365CardParser=18]="M365CardParser",e[e.OpenUrl=19]="OpenUrl",e[e.ActionSubmit=20]="ActionSubmit",e[e.ActionExecute=21]="ActionExecute",e[e.CopyCard=22]="CopyCard",e[e.APIPluginCardReferenceContainer=23]="APIPluginCardReferenceContainer",e[e.APIPluginSignInButton=24]="APIPluginSignInButton",e[e.GetAndCacheAcquisitionFromLaunchInfo=25]="GetAndCacheAcquisitionFromLaunchInfo",e[e.GetAppFromHybrid=26]="GetAppFromHybrid",e[e.GetBotId=27]="GetBotId",e[e.CECCardRenderer=28]="CECCardRenderer",e[e.ResponseCardRenderer=29]="ResponseCardRenderer",e[e.OAuthCode=30]="OAuthCode",e[e.SSOBotToken=31]="SSOBotToken",e[e.ActionOpenUrlDialog=32]="ActionOpenUrlDialog"}(VS||(VS={})),function(e){e.Intent="Intent",e.Client="Client",e.AppId="AppId",e.ActionType="ActionType",e.RetryCount="RetryCount",e.RuntimeActivityResponseMethod="RuntimeActivityResponseMethod",e.RequestName="RequestName",e.HttpStatusCode="HttpStatusCode",e.DialogContentType="DialogContentType",e.HasURL="HasURL",e.CitationIndex="citationIndex",e.ActionErrorType="ActionErrorType",e.ModalViewType="ModalViewType",e.IsTaskFetch="IsTaskFetch",e.ActionExecuteResponseType="ActionExecuteResponseType"}(qS||(qS={})),function(e){e[e.Unknown=0]="Unknown",e[e.StageView=1]="StageView",e[e.TaskModule=2]="TaskModule",e[e.DeepLinkStageView=3]="DeepLinkStageView",e[e.DeepLinkDialog=4]="DeepLinkDialog",e[e.DeepLinkOther=5]="DeepLinkOther",e[e.IMBack=6]="IMBack",e[e.MessageBack=7]="MessageBack",e[e.Invoke=8]="Invoke"}(WS||(WS={})),function(e){e[e.Execute=0]="Execute",e[e.OnCompletion=1]="OnCompletion"}(QS||(QS={})),function(e){e[e.Others=0]="Others",e[e.BotInvokeError=1]="BotInvokeError"}(GS||(GS={}));class ZS{constructor(e,t){this.telemetryService=e,this.authService=t}execute(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,c,u,d,h,p,g;const m=new FS(this.telemetryService,zS.NativeCEAAuthRuntimeActivity,Ww.Ih.OAuth,CC.Bw.CustomAgent);try{const f=e,y={appId:null!==(t=f.appId)&&void 0!==t?t:null===(n=f.originalInvokeRequest)||void 0===n?void 0:n.appId,conversationId:null!==(r=f.threadId)&&void 0!==r?r:null===(a=null===(i=null===(s=f.originalInvokeRequest)||void 0===s?void 0:s.requestBody)||void 0===i?void 0:i.conversation)||void 0===a?void 0:a.id,url:new URL(f.url),isExternal:null!==(l=null===(o=f.authenticateParameters)||void 0===o?void 0:o.isExternal)&&void 0!==l&&l,width:null!==(u=null===(c=f.authenticateParameters)||void 0===c?void 0:c.width)&&void 0!==u?u:800,height:null!==(h=null===(d=f.authenticateParameters)||void 0===d?void 0:d.height)&&void 0!==h?h:600};this.authService||(m.logMetricEndWithError({diagnosticsData:`NativeCEAOAuthRuntimeActivity: Error in authenticateWithOAuthCEA. ErrorMessage: authService is missing. AppId: ${y.appId}`}),Promise.reject("authService is missing")),yield null===(g=null===(p=this.authService)||void 0===p?void 0:p.authenticateWithOAuthCEA)||void 0===g?void 0:g.call(p,y),m.logMetricEnd({diagnosticsData:`NativeCEAOAuthRuntimeActivity: Successfully executed authenticateWithOAuthCEA. AppId: ${y.appId}`}),Promise.resolve()}catch(e){return m.logMetricEndWithError({diagnosticsData:`NativeCEAOAuthRuntimeActivity: Error in authenticateWithOAuthCEA. ErrorMessage: - ${e}`}),Promise.reject(e)}}))}}class YS{constructor(e,t){this.telemetryService=e,this.authService=t}execute(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i,a,o,l,c,u,d,h,p,g;const m=new FS(this.telemetryService,zS.NativeCEAAuthRuntimeActivity,Ww.Ih.SSO,CC.Bw.CustomAgent);try{const f=e,y={appId:null!==(t=f.appId)&&void 0!==t?t:null===(n=f.originalInvokeRequest)||void 0===n?void 0:n.appId,conversationId:null!==(r=f.threadId)&&void 0!==r?r:null===(a=null===(i=null===(s=f.originalInvokeRequest)||void 0===s?void 0:s.requestBody)||void 0===i?void 0:i.conversation)||void 0===a?void 0:a.id,claims:null===(o=f.authTokenRequest)||void 0===o?void 0:o.claims,silent:null===(l=f.authTokenRequest)||void 0===l?void 0:l.silent,connectionName:null!==(u=null===(c=f.authTokenRequest)||void 0===c?void 0:c.connectionName)&&void 0!==u?u:"",authId:null!==(h=null===(d=f.authTokenRequest)||void 0===d?void 0:d.authId)&&void 0!==h?h:""};this.authService||(m.logMetricEndWithError({diagnosticsData:`NativeCEASSORuntimeActivity: Error in NativeCEASSORuntimeActivity. ErrorMessage: authService is missing. AppId: ${y.appId}`}),Promise.reject("authService is missing")),yield null===(g=null===(p=this.authService)||void 0===p?void 0:p.authenticateWithSSOCEA)||void 0===g?void 0:g.call(p,y),m.logMetricEnd({diagnosticsData:`NativeCEASSORuntimeActivity: Successfully executed authenticateWithSSOCEA. AppId: ${y.appId}`}),Promise.resolve()}catch(e){return m.logMetricEndWithError({diagnosticsData:`NativeCEASSORuntimeActivity: Error in authenticateWithSSOCEA. ErrorMessage - ${e}`}),Promise.reject(e)}}))}}class KS{constructor(e,t,n,r,s){const i={authService:e,appService:t,channelService:n,telemetryService:r};this.authConfigActivity=new NS(i),this.silentAuthActivity=new OS(i),this.botInvokeActivity=new _S(i),this.apiPluginAuthActivity=new BS(i,s),this.ceaOAuthActivity=new ZS(r),this.ceaSSOActivity=new YS(r)}}var JS,XS=n(36299),$S=n(68124),eE=n(14976);class tE{constructor(e,t,n){this.mosAppService=e,this.augloopAppService=t,this.componentId=n,this.logAugloopFailure=e=>{this.telemetryLoggerUtils.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:e},{key:Pf.IC.ErrorType,value:Pf.q0.Server},{key:Pf.IC.ErrorCode,value:Af.O4.AugloopPluginProviderFailure},{key:Pf.IC.ErrorCategory,value:kf.S2.AppDefinition}])},this.logMosFailure=e=>{this.telemetryLoggerUtils.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:e},{key:Pf.IC.ErrorType,value:Pf.q0.Server},{key:Pf.IC.ErrorCode,value:Af.O4.MosProviderFailure},{key:Pf.IC.ErrorCategory,value:kf.S2.AppDefinition}])},this.telemetryLoggerUtils=Wf.j.getInstance(this.componentId)}async getApp(e){const t=await this.tryGetAppFromMos(e);if(t?.titleInfo)return t;this.logMosFailure("Unable to get app definition from MOS, trying augloop.");const n=await this.tryGetAppFromAugloop(e);return n?.titleInfo?n:(this.logAugloopFailure("Unable to get app definition from Augloop, returning empty response."),{titleInfo:void 0})}async tryGetAppFromMos(e){if(!this.mosAppService)return this.logMosFailure("MosAppService is not available"),{titleInfo:void 0};try{return await this.mosAppService.getApp(e)}catch(e){return this.logMosFailure("Exception getting app definition from MOS"+e?.message),{titleInfo:void 0}}}async tryGetAppFromAugloop(e){try{return await this.augloopAppService.getApp(e)}catch(e){return this.logAugloopFailure("Exception getting app definition from Augloop"+e?.message),{titleInfo:void 0}}}}!function(e){e.ExternalAppAuthentication="ExternalAppAuthentication",e.ExternalAppAuthenticationForCEA="ExternalAppAuthenticationForCEA",e.ExternalAppCardActions="ExternalAppCardActions",e.ExternalAppCardActionsForCEA="ExternalAppCardActionsForCEA",e.ExternalAppCardActionsForDA="ExternalAppCardActionsForDA",e.ExternalAppCommands="ExternalAppCommands"}(JS||(JS={}));var nE=n(97803),rE=n(67391),sE=n(25566),iE=n(82358),aE=n(49798),oE=n(62368);const lE={[JS.ExternalAppAuthentication]:function(e,t){var n;if(t.externalAppChannelService&&t.externalAppInfoService&&t.authenticationService)return new rE.Q(e,t.authenticationService,t.externalAppInfoService,t.externalAppChannelService,null!==(n=t.externalAppOauth2Service)&&void 0!==n?n:t.mos3TokenGenerationService,e.getTelemetryService(),e.getLogger());throw new Error("ExternalAppAuthentication capability requires authenticationService, externalAppChannelService and externalAppInfoService")},[JS.ExternalAppAuthenticationForCEA]:function(e,t){if(t.botAuthenticationService&&t.externalAppChannelForCEAService&&t.externalAppInfoService&&t.authenticationService)return new nE.M(e,t.authenticationService,t.botAuthenticationService,t.externalAppInfoService,t.externalAppChannelForCEAService,e.getTelemetryService(),e.getLogger());throw new Error("ExternalAppAuthenticationForCEA capability requires authenticationService, botAuthenticationService, externalAppChannelForCEAService and externalAppInfoService")},[JS.ExternalAppCardActions]:function(e,t){if(t.externalAppCardActionsService&&t.externalAppInfoService)return new sE.J(t.externalAppCardActionsService,t.externalAppInfoService,e.getTelemetryService(),e.getLogger());throw new Error("ExternalAppCardActions capability requires externalAppCardActionsService and externalAppInfoService")},[JS.ExternalAppCardActionsForCEA]:function(e,t){if(t.externalAppCardActionsForCEAService&&t.externalAppInfoService)return new iE.F(t.externalAppCardActionsForCEAService,t.externalAppInfoService,e.getTelemetryService(),e.getLogger());throw new Error("ExternalAppCardActionsForCEA capability requires externalAppCardActionsForCEAService and externalAppInfoService")},[JS.ExternalAppCardActionsForDA]:function(e,t){if(t.externalAppCardActionsForDAService&&t.externalAppInfoService)return new aE.T(t.externalAppCardActionsForDAService,t.externalAppInfoService,e.getTelemetryService(),e.getLogger());throw new Error("ExternalAppCardActionsForDA capability requires externalAppCardActionsForDAService and externalAppInfoService")},[JS.ExternalAppCommands]:function(e,t){if(t.externalAppCommandsService&&t.externalAppInfoService)return new oE.G(t.externalAppCommandsService,t.externalAppInfoService,e.getTelemetryService(),e.getLogger());throw new Error("ExternalAppCommands capability requires externalAppCommandsService and externalAppInfoService")}};var cE=n(36620);class uE{constructor(e,t,n,r){var s;this.hostWindow=e,this.context=t,this.logger=n,this.customTelemetryService=r,this.telemetryService=new cE.u7(this.getHubInfo(),t,this.customTelemetryService),this.userClickTime=null!==(s=this.context.app.userClickTime)&&void 0!==s?s:Date.now(),this.userClickTimeV2=this.context.app.userClickTimeV2}getContext(){return this.context}getHubInfo(){return{name:this.context.app.host.name,version:this.context.app.host.version,clientType:this.context.app.host.clientType,sessionId:this.context.app.host.sessionId}}getLogger(){return this.logger}getHostWindow(){return this.hostWindow}getTelemetryService(){return this.telemetryService}getUserClickTime(){return this.userClickTime}getUserClickTimeV2(){return this.userClickTimeV2}}class dE{constructor(e,t,n,r,s=lE){this.hubServices=r,this.capabilityFactory=s,this.capabilityExecutors=new Map,this.directWebContentService=new uE(e,{app:t,user:n},r.logger,r.telemetryService)}getCapability(e){const t=this.capabilityExecutors.get(e);if(t)return t;{const t=this.capabilityFactory[e](this.directWebContentService,this.hubServices);return this.capabilityExecutors.set(e,t),t}}}class hE extends kS.U{constructor(e,t,n){super(),this.tokenService=e,this.userInfo=t,this.externalAuthService=n}acquireToken(e,t,n){return(0,y.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.tokenService.getToken({resource:e,claims:t,isSilent:n});return{token:null==r?void 0:r.authToken}}))}getUser(){var e;return Promise.resolve({profile:{oid:this.userInfo.id,tid:null===(e=this.userInfo.tenant)||void 0===e?void 0:e.id,upn:this.userInfo.userPrincipalName,displayName:this.userInfo.displayName}})}}var pE=n(54731);const gE=e=>{var t;return!!(null===(t=e.composeExtensions)||void 0===t?void 0:t[0])};class mE{constructor(e,t){this.channelService=e,this.appService=t}sendRequestWithAuth(e,t,n){return(0,y.__awaiter)(this,void 0,void 0,(function*(){const r=yield function(e,t){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var n,r;const s=yield e.getApp({id:t});let i;if(s.appDefinition||s.titleInfo){const e=null!==(n=s.appDefinition)&&void 0!==n?n:(0,Oe.P)(s.titleInfo);if(gE(e)&&(i=null===(r=e.composeExtensions)||void 0===r?void 0:r[0].botId,!i))return Promise.reject("Unable to find botId for given app")}return i}))}(this.appService,e);if(!r)return Promise.reject("Unable to find botId for given app");const s=this.getBotInvokeRequestObject(r,e,t,n),i=yield this.channelService.botInvoke(s);if(i.type===v.t.Error)throw new Error(`ErrorCode: ${i.value.errorCode}, ErrorMessage: ${i.value.errorMessage}`);return this.convertBotInvokeResponse(t.requestType,i)}))}convertBotInvokeCard(e){if(e)return{content:JSON.parse(JSON.stringify(e.content)),contentType:e.contentType,fallbackHtml:e.fallbackHtml,signature:e.signature}}convertBotInvokeResponse(e,t){var n;if(e===pE.FH.QueryMessageExtensionRequest){const e=null===(n=null==t?void 0:t.value)||void 0===n?void 0:n.composeExtension;return{responseType:pE.ci.QueryMessageExtensionResponse,composeExtension:{attachmentLayout:null==e?void 0:e.attachmentLayout,type:null==e?void 0:e.type,text:null==e?void 0:e.text,attachments:(null==e?void 0:e.attachments)?e.attachments.map((e=>Object.assign(Object.assign({},this.convertBotInvokeCard(e)),{preview:this.convertBotInvokeCard(e.preview)}))):void 0}}}{const e=t.value;return{responseType:pE.ci.ActionExecuteInvokeResponse,statusCode:e.statusCode,type:e.type,value:JSON.parse(JSON.stringify(e.value)),signature:e.signature}}}getBotInvokeRequestObject(e,t,n,r){var s;const i=null===(s=null==r?void 0:r.token)||void 0===s?void 0:s.token;if(n.requestType===pE.FH.QueryMessageExtensionRequest){return{botId:e,appId:t,requestBody:{name:"composeExtension/query",value:{commandId:n.commandId,parameters:n.parameters,queryOpeions:n.queryOptions},authCode:null==r?void 0:r.secret_code,authToken:null!=i?i:void 0}}}if(n.requestType===pE.FH.ActionExecuteInvokeRequest){return{botId:e,appId:t,requestBody:{name:"adaptiveCard/action",type:"invoke",value:{action:{type:n.type,id:n.id,verb:n.verb,data:"string"==typeof n.data?JSON.parse(n.data):n.data}},authCode:r.secret_code,authToken:null!=i?i:void 0}}}throw new Error("Invalid request type")}}class fE{constructor(e){this.appService=e}getAppDefinition(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r;const s=yield this.getAppExtensibilityAppDefinition(e);if(!s)throw new Error("App manifest not found");return(0,AS.z)(Object.assign(Object.assign({},s),{version:null!==(t=s.version)&&void 0!==t?t:"",appId:null!==(n=s.id)&&void 0!==n?n:"",manifestVersion:null!==(r=null==s?void 0:s.manifestVersion)&&void 0!==r?r:""}))}))}isAppAllowed(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.appService.getApp({id:e});return!!this.isAppInstalled(t)}))}getAppExtensibilityAppDefinition(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.appService.getApp({id:e});let n=t.appDefinition;if(null==n?void 0:n.composeExtensions){const e=n.composeExtensions.map((e=>{var t;return{botId:e.botId,type:null!==(t=null==e?void 0:e.type)&&void 0!==t?t:"BotBased",commands:null==e?void 0:e.commands}}));n.composeExtensions=e}return(null==t?void 0:t.titleInfo)&&(n=(0,Oe.P)(t.titleInfo)),n}))}isAppInstalled(e){return!(!(null==e?void 0:e.appDefinition)||"AdminPreInstalled"!==e.appDefinition.state&&"Installed"!==e.appDefinition.state&&"InstalledAndPermanent"!==e.appDefinition.state)||!(!(null==e?void 0:e.titleInfo)||"acquired"!==e.titleInfo.acquisitionState)}}class yE{constructor(e){this.tokenService=e}acquireToken(e,t,n){return(0,y.__awaiter)(this,void 0,void 0,(function*(){try{return{token:(yield this.tokenService.getToken({resource:e,claims:t})).authToken}}catch(e){return{token:void 0}}}))}acquireTokenNew(e,t,n){return(0,y.__awaiter)(this,void 0,void 0,(function*(){try{return{token:(yield this.tokenService.getToken({resource:e,claims:t})).authToken}}catch(e){return{token:void 0}}}))}}class vE{constructor(e,t){this.hostService=e,this.sccTelemetryService=t}handleActionOpenUrlDialog(e,t,n){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var r;const s=new FS(this.sccTelemetryService,zS.ExtAppCardActionsForDAService,VS.ActionOpenUrlDialog,CC.Bw.DeclarativeAgent);try{const i={appId:e.toString(),openUrlDialogInfo:t};if(null==(null===(r=this.hostService)||void 0===r?void 0:r.openUrlDialog))return s.logMetricEndWithError({diagnosticsData:`ExternalAppCardActionsForDAService: openUrlDialog is undefined. TraceId: ${n}`}),Promise.reject("openUrlDialog is undefined");const a=yield this.hostService.openUrlDialog(i);if(a.status!==u.yl.Success)return s.logMetricEndWithError({diagnosticsData:`ExternalAppCardActionsForDAService: Error in handleActionOpenUrlDialog. ErrorMessage: ${a}. TraceId: ${n}`}),Promise.reject("handleActionOpenUrlDialog failed")}catch(e){return s.logMetricEndWithError({diagnosticsData:`ExternalAppCardActionsForDAService: Error in handleActionOpenUrlDialog. ErrorMessage: ${e}. TraceId: ${n}`}),Promise.reject(e)}}))}}class bE{log(e,t,n,r){(0,qf.cY)(`${t}_${e} ${n}`,r)}}class CE{constructor(e,t){this.capability=e.getCapability("ExternalAppAuthentication"),this.telemetryLoggerUtils=Wf.j.getInstance(t)}async authenticateWithOAuth2(e){try{if(this.capability&&e.authConfigId&&e.titleId)return await this.capability.authenticateWithOauth2(e.titleId,e.authConfigId,e.width,e.height),Promise.resolve();const t=this.capability?wE(e):"Capability is missing";return this.telemetryLoggerUtils.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:t},{key:Pf.IC.ErrorType,value:Pf.q0.Client},{key:Pf.IC.ErrorCode,value:Af.O4.APIPluginSignInError},{key:Pf.IC.ErrorCategory,value:kf.S2.Error}]),Promise.reject(t)}catch(e){return this.telemetryLoggerUtils.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:`Error occurred: ${JSON.stringify(e)}`},{key:Pf.IC.ErrorType,value:Pf.q0.Client},{key:Pf.IC.ErrorCode,value:Af.O4.APIPluginSignInError},{key:Pf.IC.ErrorCategory,value:kf.S2.Error}]),Promise.reject(e)}}}const wE=e=>e.titleId?e.authConfigId?"Error occurred while authenticating with OAuth2":"Auth Config Id is missing":"Title Id is missing";var SE=n(29502);class EE extends Ve{constructor(e,t,n,r,s){const i={dataResidency:M.jI.Public,id:e.aadUserId,displayName:e.userName,userPrincipalName:e.userPrincipalName},a={host:{clientType:e.clientType,name:e.hubName,sessionId:e.sessionId,version:L.V0},locale:e.locale,sessionId:e.sessionId,theme:n.isHighContrast?w.BD.highContrast:n.isDarkTheme?w.BD.dark:w.BD.default};super(new qe,i,a,t),this.clientInfo=e,this.appService=r,this.taskModuleLauncher=s}checkForValidOpenUrlRequest(e){return!!(e.openUrlDialogInfo.url&&e.openUrlDialogInfo.size&&e.openUrlDialogInfo.size.width&&e.openUrlDialogInfo.size.height&&e.appId)}prepareStageViewProps(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,s,i;if(!this.checkForValidOpenUrlRequest(e))throw new Error("DAActionsDialogHostService : Invalid request to launch OpenUrlDialog");const a={url:e.openUrlDialogInfo.url.toString(),width:e.openUrlDialogInfo.size.width,height:e.openUrlDialogInfo.size.height,type:SE.g.Url},o=yield this.appService.getApp({id:e.appId});let l=null==o?void 0:o.appDefinition;if(!l&&(null==o?void 0:o.titleInfo)&&(l=(0,Oe.P)(o.titleInfo)),!l)throw new Error("DAActionsDialogHostService : App definition not found");return{dialogContent:a,appDefinition:l,viewMode:"TaskViewMode",dialogTitle:null!==(t=e.openUrlDialogInfo.title)&&void 0!==t?t:"",triggeringActionTitle:null!==(r=null===(n=e.openUrlDialogInfo.action)||void 0===n?void 0:n.title)&&void 0!==r?r:"",clientInfo:this.clientInfo,cardData:JSON.stringify({appId:e.appId,botId:"",cardId:null!==(i=null===(s=e.openUrlDialogInfo.card)||void 0===s?void 0:s.id)&&void 0!==i?i:""})}}))}openUrlDialog(e){return(0,y.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this.prepareStageViewProps(e);if(this.taskModuleLauncher){return{status:(yield this.taskModuleLauncher(t)).status}}throw new Error("DAActionsDialogHostService : TaskModuleLauncher is not available")}catch(e){throw new Error(`DAActionsDialogHostService : Error in openUrlDialog. ErrorMessage: ${e}`)}}))}}const xE=e=>{const{arePluginServicesRequired:t,pluginConfigService:n,clientInfo:r,hostTokenProviders:s,msgExtTelemetryService:i,handleSubmitPrompt:a,copilotThemeInfo:o,taskModuleLauncher:l,extTelemetryServiceV2:c}=e,{hostAppAuthToken:u}=(0,An.Mb)(),d=N.useMemo((()=>new IS.O(n)),[n]),h=N.useMemo((()=>new eE.R),[]),p=(0,Ot.Y$)(),g=(0,ry.D)(),m=N.useMemo((()=>new $S.x(r,s,u,g)),[r,s,u]),f=(0,Xn.zK)(),y=N.useMemo((()=>f?.getDeclarativeAgentsList?.()||[]),[f]),{appService:v,authContextProvider:b,channelService:C,authService:w}=N.useMemo((()=>{if(!t)return{appService:null,authContextProvider:null,channelService:null};const e=IE({augloopAppService:d,tokenService:m,locale:r?.locale,telemetryService:i,componentId:g}),s=new Bw(r),o=new XS.m(n,a,y,!!p.enableImBackActions),l=new MS(s.getUserContext(),s.getHostContext(),m,void 0,void 0,h);return{appService:e,authContextProvider:s,channelService:o,authService:l}}),[t,d,m,r,i,n,a,y,h]),{activityProvider:S,hubSdk:E}=N.useMemo((()=>{if(!t||!v||!C)return{activityProvider:null,hubSdk:null};let e=r;e||(e=(0,dt.XG)());const n=new EE(e,m,o,v,l),s=(e=>{const{appService:t,channelService:n,tokenService:r,authContextProvider:s,externalAuthService:i,hostService:a,extTelemetryServiceV2:o}=e,l=new hE(r,s.getUserContext(),i),c=new mE(n,t),u=new fE(t),d=new yE(r),h=new vE(a,o);return new dE(window,s.getHostContext(),s.getUserContext(),{authenticationService:l,logger:new bE,externalAppInfoService:u,externalAppChannelService:c,mos3TokenGenerationService:d,externalAppCardActionsForDAService:h})})({channelService:C,appService:v,tokenService:m,authContextProvider:b,externalAuthService:h,hostService:n,extTelemetryServiceV2:c}),i=new CE(s,g);return{activityProvider:new KS(w,v,C,void 0,i),hubSdk:s}}),[t,v,C,h,m,o,l,r,b,c,w]);return{externalAuthService:h,copilotAgentServices:{appService:v,authContextProvider:b,channelService:C,tokenService:m,activityProvider:S},hubSdk:E}},IE=e=>{const{augloopAppService:t,tokenService:n,locale:r,telemetryService:s,componentId:i}=e,a=new LS.Q(n,r,s);return new tE(a,t,i)};var AE=n(15158),PE=n(69915),kE=n(79693),TE=n(2378),DE=n(61834);const ME=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};const LE=Nv((function(e){var t=ME(e);return Bv(t)&&(t=void 0),(0,DE.A)((0,kE.A)(e,1,Bv,!0),(0,TE.A)(t,2))}));function RE(e,t,n){if(!t?.CopilotPluginInfo.Id&&!e.PowerPlatformConnectorId)return;const r=t?.DisplayName??e.DisplayName;if(!r)return;const s=e.PluginDescriptions.length>1,i=n?.get(e.MetaOSAppId);return{icon:s?"":e.IconUrl??e.IconBase64??t?.IconUrl??t?.IconBase64??i?.icon??"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAR3SURBVHhe7dt/aFVlHMfxj/du5tYi+vVnNTWmQlFgElTLtHLqGJI6CH9s0mS5Ag3ZMMsFpSK2IebKVrpsKjIzkxlbWipBo/1jEPaHU2pZ0T9pWbmm4e697Tn3e+daE+7uvef5nHP2ff2z5znKhfu8Oec899eYSz29MSiakPxVJBqATAOQaQAyDUCmAcg0AJkGINMAZBqATAOQaQAyDUCmAcg0AJkGINMAZBqATAOQaQAyDUCmAcg0AFmgvxd09WofGne14LPjHTj30y+YmH8X5sx6DMvLFiIcDsv/4gpsgPMXfsOyqpfRdfZ7OXLN/fdOxs63NuLWW26WIzyBDGAWf1FFNbrP/SxH/m9ywQTsea+OHiFw94Chi5+VFcara15A57EWvLS6EqFQ/Cl3ne3G0soa/H7xT2fOEqgzYLjF31ZXi6KZjzpzo7XtOKrXbUY0GnXm7DMhMGdAMotvzCt+AvUb1njmTLB+BsRiMby/5yAOt5/Ame+6nZ1KsnJzxqHw4WmYNfMRlMyZMbCTSXbxB/PKmWA1gFn8ZVVr0dF5Uo6krnzR0861PZXFT/BCBKsBdjYfwKYt78osfWtXP4f9H7entPgJ7AhWAxSXVjrXXGN5eSlWrShDbm6OM09GT08v6hqasLelVY5ck8riJzAjWAtgntykqbOdv+YGeKrzE+SMu0H+NXkX//gLD06fL7O4dBY/YWiEB+6bggO73xy4WbvF2i4oGo0NPLlwOJTS4hs35d0oo7hMLL4xdHf0zbennc2C23y/Da2teT7txU8wEapXVsgMOHLsSxm5x/cB5hY9LqPMKB70eD/8GL+5u8n3AdqPfiGjzGgb9Hjj775TRu7xfYD1ddtx9ESHzNJjbsT125pkBsx+slBG7vF9gL6+CFbWrE87wnC7oGeXLnDGbvJ9ACPdCMO9DtjRsMH1Lajh6wBmgSbkx6/TqUZgvggzfB3AvJ7Y11SfcgT24hu+vwTdcfttKUXwwuIbgbgHjDSCVxbfCEQAI9kIXlp8IzABjOtFaN53CL+ev4AdzR96avENa++GmsWYNLVIZt7wSvWK/r3+QplxBOoMGKmN9Y14bfPbiEQicsS+UR3A2N1/efr0c/ff9bweyiUoOzsLXSePOOORysTjDP1kbW7RdDS8UeuMbRuVZ0BeXi5erCqXGdDx1dcysm/UXoIGf7J2+coVGdk36u8BbBqATAOQaQAyDUCmAcg0AJkGINMAZBqAzFqAUGjMwNc8IpFo/8v/f5wxy6Wev2Vk3tTLlpF9FgOEUHBPvjM2n0ht3f4BensvO3PbzLuhW99plpn5ZGy8jOyz/AuZj7BpS6PMvOP1dauwuLREZnZZvQdUlC3AjMKHZOYN5qvtrMU3rJ4Bhvmh3q69B9HaNvJfSWbK2LHZmFIwEfNLnsKSZ+bJUQ7rAdR/6TaUTAOQaQAyDUCmAcg0AJkGINMAZBqATAOQaQAyDUCmAcg0AJkGINMAZBqATAOQaQAyDUCmAcg0AJkGINMAZBqATANQAf8CedccD7q6MJIAAAAASUVORK5CYII=",name:r,metaOSAppId:e.MetaOSAppId,id:t?.CopilotPluginInfo.Id??e.MetaOSAppId,state:e.IsDisabledByAdmin?"blocked":"acquired",source:t?.CopilotPluginInfo.Source??"",type:(a=t?.CopilotPluginInfo.Id,o=e.PowerPlatformConnectorId,o||a?.includes("PowerPlatform")?"PowerPlatform":a?a.includes("EnterpriseSearch")?"Unsupported":a.includes("MessageExtension")?"MsgExt":a.includes("BingWebSearch")?"FirstParty":a.includes("DataVerse")?"DataVerse":NE(a)?"Undefined":"Unsupported":"Unsupported"),isEnabled:!1,rank:0,powerPlatformConnectorId:e.PowerPlatformConnectorId};var a,o}function NE(e){return e?.includes("OpenAIPlugin")??!1}class OE{constructor(e,t,n){this.pluginConfigService=e,this.pluginParams=t,this.plugins=void 0,this.pluginsLoadingPromise=void 0,this.logFailure=e=>{this.telemetryLoggerUtils.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:e},{key:Pf.IC.ErrorType,value:Pf.q0.Server},{key:Pf.IC.ErrorCode,value:Af.O4.AugloopPluginProviderFailure},{key:Pf.IC.ErrorCategory,value:kf.S2.Augloop}])},this.componentId=n,this.telemetryLoggerUtils=Wf.j.getInstance(this.componentId)}async getPlugins(e){return await this.getOrLoadPlugins()}async getStoreFrontPlugins(){throw new Error("Method not implemented.")}async installStoreFrontPlugin(){throw new Error("Method not implemented.")}async updateUserSettingsPostSystemMessageDisplayed(){throw new Error("Method not implemented.")}async getPluginsGrouped(e){return(await this.getOrLoadPlugins()).map((e=>({groupHeaderPlugin:e,plugins:[e]})))}async setPlugin(e){return this.plugins=LE(this.plugins,[e],"id"),this.pluginParams.logGroundingSourceEvent&&(0,pb.hU)(e,e.isEnabled?"On":"Off",this.componentId),Promise.resolve()}async setEnabledPluginIds(e){if(this.plugins&&e)for(const t of this.plugins){const n=e.findIndex((e=>e===t.id));t.isEnabled=-1!==n,this.pluginParams.logGroundingSourceEvent&&(0,pb.hU)(t,-1!==n?"On":"Off",this.componentId)}return Promise.resolve()}async setEnabledPlugins(e){if(this.plugins&&e)for(const t of this.plugins){const n=e.findIndex((e=>e.id===t.id));t.isEnabled=-1!==n,this.pluginParams.logGroundingSourceEvent&&(0,pb.hU)(t,-1!==n?"On":"Off",this.componentId)}return Promise.resolve()}getEnabledPlugins(){return this.plugins?this.plugins.filter((e=>e.isEnabled)).map((e=>({id:e.id,source:e.source}))):[]}async getOrLoadPlugins(){if(this.plugins)return this.plugins;if(this.pluginsLoadingPromise)return this.pluginsLoadingPromise;this.pluginsLoadingPromise=this.loadPlugins();const e=await this.pluginsLoadingPromise;return this.plugins=e,this.pluginsLoadingPromise=void 0,e}isPluginEnabled(e){return this.plugins?.find((t=>t.metaOSAppId&&t.metaOSAppId===e))?.isEnabled??!1}getRestrictedSearchMode(){return this.restrictedSearchConfigResponse?.RestrictedSearchMode}async loadPlugins(){const e=await this.getInstalledPlugins();if(!e)return;const t=this.filterPlugins(e);return t.forEach((e=>{"acquired"===e.state?(e.id===Af.un.WEB_SEARCH&&this.pluginParams.isWebSearchDefaultOn&&(e.isEnabled=!0),this.pluginParams.logGroundingSourceEvent&&(0,pb.hU)(e,e.isEnabled?"AutoOn":"AutoOff",this.componentId)):this.pluginParams.logGroundingSourceEvent&&(0,pb.hU)(e,"AdminBlocked",this.componentId)})),t}filterPlugins(e){return e.filter((e=>!function(e){const t=NE(e.id),n=(r=e.id,s=e.powerPlatformConnectorId,(r?.includes("PowerPlatform")||!!s)??!1);var r,s;return t||n}(e)))}async getInstalledPlugins(){try{const e=await this.pluginConfigService.executeOperation({type:PE.S.GetPluginConfig});if("Success"!==e?.status)return void this.logFailure("GetPluginConfig operation failed");return e.installedPlugins?.PluginGroups.findIndex((e=>!e.IsDisabledByAdmin&&e.PluginDescriptions?.findIndex((e=>e.CopilotPluginInfo.Id===Af.un.ENTERPRISE_SEARCH))>=0))>=0&&(this.restrictedSearchConfigResponse=e.pluginProperties?.enterpriseRestrictedSearch),e.installedPlugins?.PluginGroups.flatMap((e=>function(e,t){const n=[];return 0===e?.PluginDescriptions.length&&e.PowerPlatformConnectorId?n.push(RE(e,void 0,t)):0!==e?.PluginDescriptions.length&&e.PluginDescriptions.forEach((r=>{const s=RE(e,r,t);s&&n.push(s)})),n}(e)))??[]}catch(e){return void this.logFailure("Exception in getInstalledPlugins: "+e.message)}}}class _E{constructor(e){this.telemetryLoggerUtils=Wf.j.getInstance(e)}static getInstance(e){return fw.T.getFeatureFlags()?.isSingletonInstanceManagerEnabled&&e?fw.T.getSingleton(_E,e,(()=>new _E(e))):(_E.instance||(_E.instance=new _E),this.instance)}getTelemetryPayload(e){const{eventId:t,tag:n,name:r,type:s,duration:i,message:a,...o}=e;let l="";try{l=JSON.stringify({eventId:t,detail:`${n}_${r}_${s}`,metaData:JSON.stringify(o),latency:i,message:a})}catch(e){l="ExtensibilityTelemetryServiceV2 : Error while stringifying requestProps"}return l}logSuccess(e){const t=this.getTelemetryPayload(e);this.telemetryLoggerUtils.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ExtensibilityServices},{key:Pf.h3.ChatEventParameters,value:t}])}logError(e){const t=this.getTelemetryPayload(e);this.telemetryLoggerUtils.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:t},{key:Pf.IC.ErrorType,value:Pf.q0.Client},{key:Pf.IC.ErrorCode,value:Af.O4.ExtensibilityServicesError},{key:Pf.IC.ErrorCategory,value:kf.S2.ChatEvents}])}LogInfo(e){this.telemetryLoggerUtils&&this.logSuccess(e)}LogError(e){this.telemetryLoggerUtils&&this.logError(e)}LogException(e){this.telemetryLoggerUtils&&this.logError(e)}LogWarning(e){this.telemetryLoggerUtils&&this.logSuccess(e)}LogVerbose(e){this.telemetryLoggerUtils&&this.logSuccess(e)}LogMetric(e){this.telemetryLoggerUtils&&this.logSuccess(e)}}var BE=n(3830);var FE=new Map;function UE(e,t,n,r){!function(e,t,n){var r=FE.get(n)||new Map;r.set(e,t),FE.set(n,r)}(e,t,n),r?function(e,t){try{(null===window||void 0===window?void 0:window.localStorage)&&window.localStorage.setItem(e,t)}catch(e){}}(e,t):function(e,t){try{window.sessionStorage&&window.sessionStorage.setItem(e,t)}catch(e){}}(e,t)}function HE(e,t,n){var r=n?function(e){try{if(null===window||void 0===window?void 0:window.localStorage){var t=window.localStorage.getItem(e);return null===t?void 0:t}}catch(e){}}(e):function(e){try{if(window.sessionStorage){var t=window.sessionStorage.getItem(e);return null===t?void 0:t}return}catch(e){return}}(e);return void 0!==r?r:function(e,t){var n=FE.get(t);return n?n.get(e):void 0}(e,t)}function zE(e,t,n){!function(e,t){var n=FE.get(t);n&&n.delete(e)}(e,t),n?function(e){try{window.localStorage&&window.localStorage.removeItem(e)}catch(e){}}(e):function(e){try{window.sessionStorage&&window.sessionStorage.removeItem(e)}catch(e){}}(e)}const jE="SafelinksPolicy",VE=2e3;function qE(e){return new Promise((t=>setTimeout((()=>t()),e)))}function WE(e,t,n){return QE(e,[],t,n)}function QE(e,t,n,r){const s=new AbortController,{signal:i}=s;let a;const o=[e(t.length,i).then((e=>(a=e,!1)))];return n&&n.timeoutMs>0&&o.push(qE(n.timeoutMs).then((()=>(s.abort("Timeout"),!0)))),Promise.race(o).then((s=>(s&&n&&(a=n.onTimeout()),!r||!r.filter(a)||t.length>=r.maxRetries?{result:a,tries:t}:qE(r.backOffFn(t.length)).then((()=>(t.push(a),QE(e,t,n,r)))))))}var GE=n(77798);function ZE(e,t,n=0,r){return WE(((n,r)=>(0,y.__awaiter)(this,void 0,void 0,(function*(){const n=performance.now();try{let s=r;(null==t?void 0:t.signal)&&(s=AbortSignal.any([r,t.signal]));const i=Object.assign(Object.assign({},t),{signal:s}),a=yield fetch(e,i);return a.durationMs=Math.round(performance.now()-n),a}catch(e){let t;return e instanceof Error?t=e.message:"string"==typeof e&&(t=e),{status:window.navigator.onLine?GE.k.FetchFailureStatusCode:GE.k.OfflineFetchFailureStatusCode,ok:!1,durationMs:Math.round(performance.now()-n),fetchError:t}}}))),{timeoutMs:n,onTimeout:()=>({status:GE.k.FetchTimeoutStatusCode,ok:!1,durationMs:n})},r)}const YE=function(e){return t=>!!t&&(e instanceof Array?e.includes(t.status):e.min<=e.max&&(t.status>=e.min&&t.status<=e.max))};function KE(e){return t=>e}const JE=async({getAuthToken:e})=>{if(!e)return{error:"MissingGetAuthTokenCallback"};try{const t=await e();return t?.trim()?{token:t}:{error:"EmptyAuthToken"}}catch{return{error:"FetchAuthTokenFailed"}}},XE=e=>{if(!e)return"";const t=e.split(" ")[0].toLowerCase();return"msauth1.0"==t||"bearer"==t?e:`Bearer ${e}`},$E=(e,{durationMs:t,fetchError:n,status:r},s)=>({correlationId:e,durationMs:t,fetchError:n,status:r,tries:s.length+1}),ex=(e,{durationMs:t,fetchError:n,status:r},s)=>({correlationId:{value:e,logToClientTelemetryOnly:!1},durationMs:{value:t,logToClientTelemetryOnly:!1},fetchError:{value:n,logToClientTelemetryOnly:!1},status:{value:r,logToClientTelemetryOnly:!1},tries:{value:s.length+1,logToClientTelemetryOnly:!1}}),tx="SafeLinksGetServiceLocator";let nx=0;const rx=async e=>{const{workloadId:t,callerApp:n,clientCorrelationId:r,telemetryLogger:s,maxRetries:i}=e,a=(0,f.DA)();if(nx>2)r&&s?.logDiagnosticEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:tx,message:"RetriesExhausted"});else try{const o=await JE(e);if("error"in o)return void(r&&s?.logDiagnosticEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:tx,message:o.error}));const{result:l,tries:c}=await ZE((({getServiceLocatorHost:e,tenantId:t})=>`${e??"https://safelinks.protection.outlook.com"}/api/GetServiceLocator?TenantId=${t}`)(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:XE(o.token),"X-WorkloadId":t,"X-CorrelationId":a,"X-CallerApp":n}},0,{maxRetries:i??2,filter:YE({min:429,max:799}),backOffFn:KE(VE)}),u=JSON.stringify($E(a,l,c)),d=ex(a,l,c);if(l.ok)try{const e=await l.json();if("getPolicyAffinitizedUrl"in e)return r&&s?.logEventV2?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:tx,metaData:"Completed",message:u}),e.getPolicyAffinitizedUrl;r&&s?.logCopilotErrorEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:tx,errorMessage:"NoGetPolicyAffinitizedUrlInResponse",metaData:d})}catch{r&&s?.logCopilotErrorEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:tx,errorMessage:"JSONParseError",metaData:d})}else{if(401===l.status)return r&&s?.logDiagnosticEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:tx,metaData:"InvalidAuthToken",message:u}),nx++,await rx(e);r&&s?.logCopilotErrorEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:tx,errorMessage:"NonOkResponseStatus",metaData:d})}}catch{r&&s?.logDiagnosticEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:tx,message:"ExceptionThrown",metaData:JSON.stringify({correlationId:{value:a,logToClientTelemetryOnly:!1}})})}};let sx;let ix=0,ax=0;const ox="SafeLinksGetPolicy",lx=async(e,t)=>{const{workloadId:n,callerApp:r,clientCorrelationId:s,telemetryLogger:i,maxRetries:a}=t,o=(0,f.DA)();if(ix>2)return s&&i?.logDiagnosticEvent?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,message:"RedirectsExhausted"}),{error:"RedirectsExhausted"};if(ax>2)return s&&i?.logDiagnosticEvent?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,message:"RetriesExhausted"}),{error:"RetriesExhausted"};try{const l=await JE(t);if("error"in l)return s&&i?.logDiagnosticEvent?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,message:l.error}),{error:l.error};const{result:c,tries:u}=await ZE(e,{method:"GET",headers:{"Content-Type":"application/json",Authorization:XE(l.token),"X-WorkloadId":n,"X-CorrelationId":o,"X-CallerApp":r},credentials:"include"},0,{maxRetries:a??2,filter:YE({min:429,max:799}),backOffFn:KE(VE)}),d=JSON.stringify($E(o,c,u)),h=ex(o,c,u);if(!c.ok){if(302===c.status||307===c.status){const e=c.headers?.get("Location");return e?(ix++,s&&i?.logDiagnosticEvent?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,metaData:"Redirect",message:d}),await lx(e,t)):(s&&i?.logCopilotErrorEvent?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,errorMessage:"InvalidLocationHeader",metaData:h}),{error:"InvalidLocationHeader"})}return 401===c.status?(s&&i?.logDiagnosticEvent?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,metaData:"InvalidAuthToken",message:d}),ax++,await lx(e,t)):(s&&i?.logCopilotErrorEvent?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,errorMessage:"NonOkResponseStatus",metaData:h}),{error:"NonOkResponseStatus"})}try{const e=await c.json();return s&&i?.logEventV2?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,metaData:"Completed",message:d}),e}catch{return s&&i?.logCopilotErrorEvent?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,errorMessage:"JSONParseError",metaData:h}),{error:"JSONParseError"}}}catch{return s&&i?.logDiagnosticEvent?.({clientCorrelationId:s,eventScope:"SafeLinks",eventId:ox,message:"ExceptionThrown",metaData:JSON.stringify({correlationId:{value:o,logToClientTelemetryOnly:!1}})}),{error:"ExceptionThrown"}}};let cx;const ux=async e=>{if(cx)return cx;const t=await(async e=>{if(sx)return sx;nx=0,sx=rx(e);try{return await sx}finally{sx=void 0}})(e);if(!t)return{error:"InvalidGetPolicyRequestUrl"};ix=0,ax=0,cx=lx(t,e);try{return await cx}finally{cx=void 0}},dx=e=>{try{return JSON.parse(HE(`${jE}_${e}`,e,!0)??"")}catch{return{error:"PolicyParseFailed"}}},hx=e=>isNaN(e)||Date.now()>=e,px=e=>{if("error"in e)return!1;const{affinitizedUrl:t,expirationDateTimeInMillis:n,refreshDateTimeInMillis:r}=e;return t&&!(hx(n)||hx(r))},gx="SafeLinksRefreshPolicy",mx=async e=>{const{cacheAppId:t,telemetryLogger:n,clientCorrelationId:r}=e;try{const s=dx(t);if(s&&px(s))return r&&n?.logDiagnosticEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:gx,metaData:"PolicyInCache"}),"NotNeeded";const i=(e=>!e||"error"in e?{error:e?.error??"PolicyFetchFailed"}:{userPolicyProperties:e.userPolicyProperties,affinitizedUrl:e.affinitizedUrl,refreshDateTimeInMillis:Date.now()+6e4*e.policyRefreshIntervalInMinutes,expirationDateTimeInMillis:Date.now()+6e4*e.policyTTL})(await ux(e));if(i&&!("error"in i))return UE(`${jE}_${t}`,JSON.stringify(i),t,!0),r&&n?.logEventV2?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:gx,metaData:"Completed"}),"Completed"}catch{r&&n?.logDiagnosticEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:gx,message:"ExceptionThrown"})}return zE(`${jE}_${t}`,t,!0),"Failed"};let fx;const yx=async e=>{if(fx)return fx;fx=mx(e);try{return await fx}finally{fx=void 0}};let vx=0,bx=0;const Cx="SafeLinksGetURLReputation",wx=async(e,t,n,r,s,i)=>{const{cacheAppId:a,clientCorrelationId:o,telemetryLogger:l,maxRetries:c}=n;if(vx>2)return void(o&&l?.logDiagnosticEvent?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,message:"RedirectsExhausted"}));if(bx>2)return void(o&&l?.logDiagnosticEvent?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,message:"RetriesExhausted"}));const u=t.CorrelationId;try{const{result:d,tries:h}=await ZE(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t),credentials:"include"},0,{maxRetries:c??2,filter:YE({min:429,max:799}),backOffFn:KE(VE)}),p=JSON.stringify($E(u,d,h)),g={...ex(u,d,h),safeLinksScenario:{value:s,logToClientTelemetryOnly:!1},safeLinksSubScenario:{value:i,logToClientTelemetryOnly:!1}};if(d.ok)try{const e=await d.json();return o&&l?.logEventV2?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,metaData:"Completed",message:p}),e}catch{o&&l?.logCopilotErrorEvent?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,errorMessage:"JSONParseError",metaData:g})}else{if(302===d.status||307===d.status){const e=d.headers?.get("Location");return e?(vx++,o&&l?.logDiagnosticEvent?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,metaData:"Redirect",message:p}),await wx(e,t,n,r,s,i)):void(o&&l?.logCopilotErrorEvent?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,errorMessage:"InvalidLocationHeader",metaData:g}))}if(401===d.status){o&&l?.logDiagnosticEvent?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,metaData:"InvalidCookie",message:p}),zE(`${jE}_${a}`,a,!0);return"Failed"===await yx(n)?void(o&&l?.logCopilotErrorEvent?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,errorMessage:"PolicyRefreshFailed",metaData:g})):(bx++,await wx(e,t,n,r,s,i))}o&&l?.logCopilotErrorEvent?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,errorMessage:"NonOkResponseStatus",metaData:g})}}catch{o&&l?.logDiagnosticEvent?.({clientCorrelationId:o,eventScope:"SafeLinks",eventId:Cx,message:"ExceptionThrown",metaData:JSON.stringify({correlationId:{value:u,logToClientTelemetryOnly:!1},safeLinksScenario:{value:s,logToClientTelemetryOnly:!1},safeLinksSubScenario:{value:i,logToClientTelemetryOnly:!1}})})}},Sx=async(e,t,n,r,s)=>{const{cacheAppId:i,workloadId:a,fallbackWorkloadId:o,callerApp:l,userEmail:c,tenantId:u,clientCorrelationId:d,telemetryLogger:h}=n,p=dx(i);if(!p||!px(p)||"error"in p){d&&h?.logDiagnosticEvent?.({clientCorrelationId:d,eventScope:"SafeLinks",eventId:Cx,metaData:"InvalidPolicyInCache",message:JSON.stringify({safeLinksScenario:r,safeLinksSubScenario:s})});return"Failed"===await yx(n)?void(d&&h?.logCopilotErrorEvent?.({clientCorrelationId:d,eventScope:"SafeLinks",eventId:Cx,errorMessage:"PolicyRefreshFailed",metaData:{safeLinksScenario:{value:r,logToClientTelemetryOnly:!1},safeLinksSubScenario:{value:s,logToClientTelemetryOnly:!1}}})):await Sx(e,t,n,r,s)}const g=`${p.affinitizedUrl}GetUrlReputation`,m=!p?.userPolicyProperties?.enableSafeLinksForOffice,y={UrlList:e,WorkloadId:m?o:a,CallerApp:l,CorrelationId:(0,f.DA)(),Source:t,User:c,TenantId:u};vx=0,bx=0;const v=await wx(g,y,n,m,r,s);return v?.reputationResults?.map(((e,t)=>({...e,isFallback:m,originalUrl:y.UrlList[t]})))};class Ex{constructor(e){this.safeLinksManagerParams=e}static shouldCreateNewInstance(e){return!Ex.instance||e.cacheAppId!==Ex.instance.safeLinksManagerParams.cacheAppId||e.workloadId!==Ex.instance.safeLinksManagerParams.workloadId||e.tenantId!==Ex.instance.safeLinksManagerParams.tenantId||e.callerApp!==Ex.instance.safeLinksManagerParams.callerApp}static getInstance(e){return this.shouldCreateNewInstance(e)&&(Ex.instance=new Ex(e)),Ex.instance}async performInitialization(e){this.initializationStatus="InProgress";try{const t=await yx({...this.safeLinksManagerParams,clientCorrelationId:e});this.initializationStatus="NotNeeded"===t?"Completed":t}catch{this.initializationStatus="Failed"}}async initialize(e,t){const{telemetryLogger:n}=this.safeLinksManagerParams;if("Completed"!==this.initializationStatus){if(this.initializationPromise)return this.initializationPromise;this.initializationPromise=this.performInitialization(t);try{await this.initializationPromise}finally{this.initializationPromise=void 0}}else t&&n?.logDiagnosticEvent?.({clientCorrelationId:t,eventScope:"SafeLinks",eventId:"SafeLinksInitialization",metaData:JSON.stringify({trigger:e,status:this.initializationStatus})})}async ensureInitialized(e){if("Completed"!==this.initializationStatus){if(this.initializationPromise)return this.initializationPromise;this.initializationPromise=this.initialize("OpenLink",e);try{await this.initializationPromise}finally{this.initializationPromise=void 0}}}async getUrlReputation(e,t,n,r){this.listener?.({status:"InProgress"});try{if(await this.ensureInitialized(r),"Failed"===this.initializationStatus)return void this.listener?.({status:"Failed"});const{sourceType:s}=this.safeLinksManagerParams,i=await Sx([e],s,{...this.safeLinksManagerParams,clientCorrelationId:r},t,n),a=i?.[0];a?this.listener?.({status:"Completed",...a}):this.listener?.({status:"Failed"})}catch{this.listener?.({status:"Failed"})}}addListener(e){return this.listener=e,()=>{this.listener=void 0}}}var xx,Ix;!function(e){e.Copilot="Copilot",e.Email="Email",e.Office="Office",e.Other="Other",e.Teams="Teams"}(xx||(xx={})),function(e){e[e.Undefined=0]="Undefined",e[e.Good=1]="Good",e[e.Bad=2]="Bad",e[e.Error=3]="Error"}(Ix||(Ix={}));var Ax=n(57329),Px=n(48055),kx=n(26970),Tx=n(73655),Dx=n(48224),Mx=n(18251),Lx=n(58651);const Rx=e=>{switch(e){case 0:return Ix.Good;case 1:return Ix.Bad;default:return e>=-9&&e<=-1?Ix.Error:Ix.Undefined}},Nx=(0,zo.Ex)("scc-react-safelinks-provider.SafeLinksErrorPopup.unableToVerifyLink"),Ox=(0,zo.Ex)("scc-react-safelinks-provider.SafeLinksErrorPopup.unsafeLink"),_x=(0,zo.Ex)("scc-react-safelinks-provider.SafeLinksErrorPopup.trustWarningInternalError"),Bx=(0,zo.Ex)("scc-react-safelinks-provider.SafeLinksErrorPopup.trustWarningContextInternalError"),Fx=(0,zo.Ex)("scc-react-safelinks-provider.SafeLinksErrorPopup.trustWarningUnsafeLink"),Ux=(0,zo.Ex)("scc-react-safelinks-provider.SafeLinksErrorPopup.trustWarningContextUnsafeLink"),Hx=(0,zo.Ex)("scc-react-safelinks-provider.SafeLinksErrorPopup.continueAnyway"),zx=(0,zo.Ex)("scc-react-safelinks-provider.SafeLinksErrorPopup.close"),jx=(0,Qo.Q)("SafeLinksErrorPopup",(0,mt.n)({iconWarning:{color:Pt.L.colorStatusWarningForeground1},iconDanger:{color:Pt.L.colorStatusDangerForeground1},dialogContainer:{display:"flex",width:"fit-content",flexDirection:"column",alignItems:"flex-start",borderRadius:Pt.L.borderRadiusXLarge,backgroundColor:Pt.L.colorNeutralBackground1,boxShadow:Pt.L.shadow16},dialogBackdrop:{background:Pt.L.colorSubtleBackgroundInvertedSelected},dialogBody:{gridTemplateColumns:"none"},dialogTitleContainer:{display:"flex",height:"32px",columnGap:Pt.L.spacingHorizontalS,justifyContent:"space-between",alignItems:"center",alignSelf:"stretch"},dialogTitleContent:{marginRight:"auto",color:Pt.L.colorNeutralForeground1},dialogContent:{padding:"0",margin:"0"},warningDisplay:{display:"flex",marginTop:Pt.L.spacingHorizontalM,marginBottom:Pt.L.spacingVerticalM,color:Pt.L.colorNeutralForeground2},warningContext:{display:"flex",marginTop:Pt.L.spacingVerticalM,marginBottom:Pt.L.spacingVerticalXL,color:Pt.L.colorNeutralForeground2},urlDisplay:{backgroundColor:Pt.L.colorNeutralBackground2,paddingInlineStart:Pt.L.spacingHorizontalXL,paddingInlineEnd:Pt.L.spacingHorizontalXL,paddingBlockStart:Pt.L.spacingVerticalL,paddingBlockEnd:Pt.L.spacingVerticalL,borderRadius:Pt.L.borderRadiusXLarge,...gt.Pt.border("1px","solid",Pt.L.colorTransparentStroke),columnGap:Pt.L.spacingHorizontalMNudge,display:"flex",justifyContent:"center",alignItems:"center",alignSelf:"stretch",overflowWrap:"anywhere"},urlContent:{flex:"1 0 0"},actionsContainer:{display:"flex",justifyContent:"flex-end",paddingBlockStart:Pt.L.spacingVerticalL,padding:"0"}})),Vx=e=>"Completed"===e?.status&&Rx(e.verdict)===Ix.Bad,qx=({url:e,urlReputationFetchStatus:t,telemetryLogger:n,clientCorrelationId:r,safeLinksScenario:s,safeLinksSubScenario:i,onOpenChange:a})=>{const{dialogContainer:o,dialogBackdrop:l,dialogBody:c,dialogTitleContainer:u,iconDanger:d,iconWarning:h,dialogTitleContent:p,dialogContent:g,warningDisplay:m,warningContext:f,urlDisplay:y,urlContent:v,actionsContainer:b}=jx(),C=(0,it.kQ)({close:zx,continueAnyway:Hx,trustWarningContextInternalError:Bx,trustWarningContextUnsafeLink:Ux,trustWarningInternalError:_x,trustWarningUnsafeLink:Fx,unableToVerifyLink:Nx,unsafeLink:Ox}),{scheme:w,authority:S,remainingPath:E}=(e=>{try{const{protocol:t,hostname:n,port:r,pathname:s,search:i,hash:a}=new URL(e);return{scheme:t,authority:r?`${n}:${r}`:n,remainingPath:s+i+a}}catch{Lx.error("Error while extracting URL parts")}})(e)??{};return S?N.createElement($r.l,{defaultOpen:!0,onOpenChange:a},N.createElement(es.E,{className:o,backdrop:{"aria-hidden":!0,className:l}},N.createElement(ts.R,{className:c},N.createElement(ns.L,{className:u},Vx(t)?N.createElement(Ms.EYU,{className:d}):N.createElement(Ms.eAS,{className:h}),N.createElement(Xc.V,{className:p},Vx(t)?C.unsafeLink():C.unableToVerifyLink())),N.createElement(ss.C,{className:g},Vx(t)?N.createElement(N.Fragment,null,N.createElement(lt.c,{className:m},C.trustWarningUnsafeLink()),N.createElement(lt.c,{className:f},C.trustWarningContextUnsafeLink())):N.createElement(N.Fragment,null,N.createElement(lt.c,{className:m},C.trustWarningInternalError()),N.createElement(lt.c,{className:f},C.trustWarningContextInternalError())),N.createElement("div",{className:y},N.createElement("div",{className:v},N.createElement(Mx.j,null,`${w}//`),N.createElement(xc.F,null,S),N.createElement(Mx.j,null,E)))),N.createElement(na.i,{className:b},N.createElement(rs.z,{disableButtonEnhancement:!0,action:"open"},N.createElement(Dx.$,{appearance:"secondary",icon:N.createElement(yb.rD4,null)},N.createElement(Xc.V,null,C.continueAnyway()))),N.createElement(rs.z,{disableButtonEnhancement:!0,action:"close"},N.createElement(Dx.$,{appearance:"primary"},N.createElement(Xc.V,null,C.close()))))))):(r&&n?.logDiagnosticEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:"SafeLinksGetURLReputation",metaData:"InvalidRequestUrl",message:JSON.stringify({safeLinksScenario:{value:s,logToClientTelemetryOnly:!1},safeLinksSubScenario:{value:i,logToClientTelemetryOnly:!1},codeLocation:{value:"SafeLinksErrorPopup",logToClientTelemetryOnly:!1}})}),null)},Wx=(0,zo.Ex)("scc-react-safelinks-provider.SafeLinksToast.verifyingLink"),Qx=(0,zo.qP)("scc-react-safelinks-provider.SafeLinksToast.verifyingLinkCount"),Gx=(0,Qo.Q)("SafeLinksToast",(0,mt.n)({container:{position:"absolute",boxShadow:Pt.L.shadow16},media:{paddingTop:"0px"}})),Zx=({children:e,value:{safeLinksManagerParams:t,initClientCorrelationId:n,openLink:r}})=>{const s=N.useMemo((()=>t?Ex.getInstance(t):void 0),[t]);N.useEffect((()=>{s?.initialize("Boot",n)}),[n,s]);const[i,a]=N.useState();N.useEffect((()=>{const e=s?.addListener((e=>{a(e)}));return e}),[s]);const[o,l]=N.useState([]),[c,u]=N.useState(),[d,h]=N.useState(0),[p,g]=N.useState(!0),[m,y]=N.useState(!1),v=(0,it.kQ)({verifyingLink:Wx}),b=(0,it.mY)({verifyingLinkCount:Qx}),{container:C,media:w}=Gx(),S=(0,Ax.Bi)("safeLinksToaster"),{dispatchToast:E,dismissToast:x,updateToast:I}=(0,Px.J)(S),A=N.useCallback((e=>{r?r(e):window.open(e,"_blank")}),[r]),P=N.useCallback((()=>{if(o.length>0&&!c){const[e,...t]=o;u(e),l(t),h((e=>e+1));const{url:n,safeLinksScenario:r,safeLinksSubScenario:i,clientCorrelationId:a}=e;s?.getUrlReputation(n,r,i,a)}0===o.length&&h(0)}),[c,o,s]);N.useEffect((()=>{if(!c)return void P();const{id:e,onOpenLink:t}=c;if("InProgress"!==i?.status){if("Completed"===i?.status){const e=Rx(i.verdict);i.isFallback&&e===Ix.Good||!i.isFallback&&e!==Ix.Error?(A(i.navigateUrl),t?.(),u(void 0)):y(!0)}else y(!0);x(e)}else{const t=N.createElement(kx.y,{className:C},N.createElement(Tx.S,{media:{children:N.createElement(pl.y,{size:"tiny"}),className:w}},1===d&&0===o.length?v.verifyingLink():b.verifyingLinkCount({count:d.toString(),total:(d+o.length).toString()})));p?(g(!1),E(t,{politeness:"assertive",toastId:e,onStatusChange:(e,{status:t})=>{g("unmounted"===t)}})):I({content:t,politeness:"assertive",toastId:e})}}),[v,b,c,C,x,E,d,o.length,w,A,P,p,I,i]);const{getSharedCopilotLogger:k}=(0,BE.k_)()??{},T=k?.(),D=N.useMemo((()=>({handleOpenSafeLink:({url:e,safeLinksScenario:t,safeLinksSubScenario:n,clientCorrelationId:r,onOpenLink:s})=>{(e=>{try{return new URL(e),!0}catch{return!1}})(e)?(l((i=>[...i,{id:(0,f.DA)(),url:e,safeLinksScenario:t,safeLinksSubScenario:n,clientCorrelationId:r,onOpenLink:s}])),r&&T?.logCopilotActionEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:"SafeLinksOpenLinkTriggered",metaData:{safeLinksScenario:{value:t,logToClientTelemetryOnly:!1},safeLinksSubScenario:{value:n,logToClientTelemetryOnly:!1}}})):r&&T?.logDiagnosticEvent?.({clientCorrelationId:r,eventScope:"SafeLinks",eventId:"SafeLinksGetURLReputation",metaData:"InvalidRequestUrl",message:JSON.stringify({safeLinksScenario:{value:t,logToClientTelemetryOnly:!1},safeLinksSubScenario:{value:n,logToClientTelemetryOnly:!1},codeLocation:{value:"handleOpenSafeLink",logToClientTelemetryOnly:!1}})})}})),[T]),{clientCorrelationId:M}=c||{};return N.createElement(xa.B,{value:D},N.createElement(Rw.l,{toasterId:S,position:"top",timeout:-1,limit:1,offset:{vertical:80}}),c&&m&&N.createElement(qx,{url:c.url,urlReputationFetchStatus:i,telemetryLogger:T,clientCorrelationId:M,safeLinksScenario:c.safeLinksScenario,safeLinksSubScenario:c.safeLinksSubScenario,onOpenChange:(e,{open:t})=>{t?(M&&T?.logCopilotActionEvent?.({clientCorrelationId:M,eventScope:"SafeLinks",eventId:"SafeLinksErrorPopupContinue",metaData:{safeLinksScenario:{value:c.safeLinksScenario,logToClientTelemetryOnly:!1},safeLinksSubScenario:{value:c.safeLinksSubScenario,logToClientTelemetryOnly:!1}}}),A(c.url),c.onOpenLink?.()):M&&T?.logCopilotActionEvent?.({clientCorrelationId:M,eventScope:"SafeLinks",eventId:"SafeLinksErrorPopupClosed",metaData:{safeLinksScenario:{value:c.safeLinksScenario,logToClientTelemetryOnly:!1},safeLinksSubScenario:{value:c.safeLinksSubScenario,logToClientTelemetryOnly:!1}}}),u(void 0),y(!1)}}),e)},Yx=e=>{switch(e){case"SDFV2":case"Dogfood":return"https://nam99.safelinks.protection.outlook.com";case"MSIT":return"https://nam06.safelinks.protection.outlook.com";default:return"https://safelinks.protection.outlook.com"}};function Kx(e){const t=(0,Ot.Y$)(),n=(()=>{const e=(0,An.Mb)(),t=e.hostAppAuthToken?.safeLinksTokenProvider,n=N.useCallback((async()=>{if(!t)throw new Error("SafeLinks token provider not available");const e=(await t())?.accessToken;return e}),[t]);return t?n:void 0})(),r=e?.physicalRing||"MSIT",s=e?.isEnterpriseUser||!1,i=e?.clientCorrelationId||"temp-id",a=e?.cacheAppId||"temp-app-id",o=t.isSafeLinksEnabled&&s,[l,c]=N.useState(void 0);return N.useEffect((()=>{o&&e.getTenantId&&e.getTenantId().then((e=>{c(e)}))}),[o,e]),N.useMemo((()=>({safeLinksManagerParams:o&&l?{getServiceLocatorHost:r?Yx(r):void 0,getAuthToken:n,cacheAppId:a,workloadId:Df.Rk,fallbackWorkloadId:Df.y2,tenantId:l,callerApp:(0,QC.MZ)(a),sourceType:xx.Copilot}:void 0,initClientCorrelationId:i})),[a,o,i,r,l,n])}class Jx{constructor(){this.addResponse=void 0,this.updateMessage=void 0,this.isOperatorExecuting=!1,this.cuaHostUrl="ws://localhost:9002"}static getInstance(){return void 0===this.sInstance&&(this.sInstance=new Jx),this.sInstance}initialize(e,t,n,r){this.cuaHostUrl=e,this.setIsExecutingCallback=t,this.addResponse=n,this.updateMessage=r,this.isOperatorExecuting=!1}disconnect(){void 0!==this.ws&&(this.ws.close(),this.ws=void 0)}submitOperation(e,t=""){const n="Host:",r="Token:",s="Open URL:";e.startsWith(n)?(this.cuaHostUrl=e.substring(5),this.disconnect(),this.initWebSocket()):e.startsWith(r)?this.updateToken(e.substring(6)):"Ping"===e?this.ping():"NewSession"===e?this.newSession():e.startsWith(s)?this.openURL(e.substring(9)):e.startsWith("Stop operating")?this.stopOperating():this.sendTextMessage(e,t)}isExecuting(){return this.isOperatorExecuting}initWebSocket(){void 0===this.ws&&(this.ws=new WebSocket(this.cuaHostUrl),this.ws.onopen=()=>{if((0,qf.cY)("CUA: Connected to WebSocket server"),void 0!==this.initDataBuffer){for(const e of this.initDataBuffer)this.sendSocketData(e);this.completeExecutionOnBufferClear&&this.setIsExecuting?.(!1),this.initDataBuffer=void 0,this.completeExecutionOnBufferClear=void 0}},this.ws.onmessage=e=>{if((0,qf.cY)("CUA: Received message from WebSocket server:",e.data),void 0!==this.addResponse){const t=JSON.parse(e.data);"text"===t.type?t.textType&&"REASONING_SUMMARY"===t.textType?this.updateMessage?.(t.text):(this.setIsExecuting?.(!1),this.addResponse(t.text)):"error"===t.type&&(this.setIsExecuting?.(!1),(0,qf.cY)("CUA: add response error: "+t.error),this.addResponse(t.error))}},this.ws.onclose=()=>{this.setIsExecuting?.(!1),(0,qf.cY)("CUA: WebSocket connection closed"),this.ws=void 0},this.ws.onerror=e=>{this.setIsExecuting?.(!1),(0,qf.cY)("CUA: WebSocket error:",e),void 0!==this.addResponse&&this.addResponse("CUA: WebSocket error: "+e)})}sendSocketData(e){void 0!==this.ws&&this.ws.readyState===WebSocket.OPEN?(this.ws.send(e),this.isOperatorExecuting=!0):(0,qf.cY)("CUA: WebSocket is not open.")}sendTextMessage(e,t){void 0!==t&&t.length>0&&this.updateToken(t,!1);const n=JSON.stringify({type:"text",text:e});if(void 0===this.ws||this.ws.readyState!==WebSocket.OPEN)return this.appendToInitBuffer(n,!1),void this.initWebSocket();this.sendSocketData(n)}openURL(e){if(!e||0===e.length)return this.setIsExecuting?.(!1),void(void 0!==this.addResponse&&this.addResponse("CUA: Unable to open URL"));const t={type:"command",command:"OPEN_URL",payload:e},n=JSON.stringify(t);if(void 0===this.ws||this.ws.readyState!==WebSocket.OPEN)return this.appendToInitBuffer(n,!0),void this.initWebSocket();this.sendSocketData(n),this.setIsExecuting?.(!1)}updateToken(e,t=!0){const n={type:"command",command:"UPDATE_TOKEN",payload:e},r=JSON.stringify(n);if(void 0===this.ws||this.ws.readyState!==WebSocket.OPEN)return this.appendToInitBuffer(r,!0),void this.initWebSocket();this.sendSocketData(r),t&&this.setIsExecuting?.(!1)}ping(){const e=JSON.stringify({type:"command",command:"PING"});if(void 0===this.ws||this.ws.readyState!==WebSocket.OPEN)return this.appendToInitBuffer(e,!0),void this.initWebSocket();this.sendSocketData(e),this.setIsExecuting?.(!1)}newSession(){const e=JSON.stringify({type:"command",command:"NEW_SESSION"});if(void 0===this.ws||this.ws.readyState!==WebSocket.OPEN)return this.appendToInitBuffer(e,!0),void this.initWebSocket();this.sendSocketData(e),this.setIsExecuting?.(!1)}stopOperating(){const e=JSON.stringify({type:"command",command:"STOP_OPERATING"});if(void 0===this.ws||this.ws.readyState!==WebSocket.OPEN)return this.appendToInitBuffer(e,!0),void this.initWebSocket();this.sendSocketData(e),this.setIsExecuting?.(!1)}appendToInitBuffer(e,t){void 0===this.initDataBuffer&&(this.initDataBuffer=[]),this.initDataBuffer.push(e),!1!==this.completeExecutionOnBufferClear&&(this.completeExecutionOnBufferClear=t)}setIsExecuting(e){this.isOperatorExecuting=e,void 0!==this.setIsExecutingCallback&&this.setIsExecutingCallback(e)}}async function Xx(e){const{signalOperationData:t,messageText:n,setIsExecuting:r,addResponse:s,updateMessage:i,cuaTokenProvider:a,featureFlags:o}=e;if(!(t.operation.items.length>0&&void 0!==t.operation.items[0].body&&"CUA"==t.operation.items[0].body?.gptId))return!1;const l=a?await a():void 0;return function(e,t,n,r,s,i){Jx.getInstance().initialize(e,r,s,i),Jx.getInstance().submitOperation(n,t)}(o.cuaOperatorUrl??"",l??"",n,r,s,i),!0}class $x{constructor(e,t,n){this.addResponse=e,this.debugLog=t,this.chatLogLevel=n}log(e){this.debugLog(e),this.chatLogLevel>=2&&this.addResponse(e)}logToConsole(e){this.debugLog(e)}}const eI="0.32.1";let tI,nI,rI,sI,iI,aI,oI=!1,lI=null,cI=null,uI=null,dI=null,hI=null,pI=null,gI=null;class mI{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}tI||function(e,t={auto:!1}){if(oI)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${e.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(tI)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${e.kind}'\` after \`import '@anthropic-ai/sdk/shims/${tI}'\``);oI=t.auto,tI=e.kind,nI=e.fetch,lI=e.Request,cI=e.Response,uI=e.Headers,dI=e.FormData,hI=e.Blob,rI=e.File,sI=e.ReadableStream,pI=e.getMultipartRequestOptions,iI=e.getDefaultAgent,aI=e.fileFromPath,gI=e.isFsReadStream}(function({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import … from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(e){throw new Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new mI(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0});class fI extends Error{}class yI extends fI{constructor(e,t,n,r){super(`${yI.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["request-id"],this.error=t}static makeMessage(e,t,n){const r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e)return new bI({message:n,cause:gA(t)});const s=t;return 400===e?new wI(e,s,n,r):401===e?new SI(e,s,n,r):403===e?new EI(e,s,n,r):404===e?new xI(e,s,n,r):409===e?new II(e,s,n,r):422===e?new AI(e,s,n,r):429===e?new PI(e,s,n,r):e>=500?new kI(e,s,n,r):new yI(e,s,n,r)}}class vI extends yI{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}}class bI extends yI{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}}class CI extends bI{constructor({message:e}={}){super({message:e??"Request timed out."})}}class wI extends yI{constructor(){super(...arguments),this.status=400}}class SI extends yI{constructor(){super(...arguments),this.status=401}}class EI extends yI{constructor(){super(...arguments),this.status=403}}class xI extends yI{constructor(){super(...arguments),this.status=404}}class II extends yI{constructor(){super(...arguments),this.status=409}}class AI extends yI{constructor(){super(...arguments),this.status=422}}class PI extends yI{constructor(){super(...arguments),this.status=429}}class kI extends yI{}var TI=n(37542).Buffer;class DI{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];const n=DI.NEWLINE_CHARS.has(t[t.length-1]||"");let r=t.split(DI.NEWLINE_REGEXP);return n&&r.pop(),1!==r.length||n?(this.buffer.length>0&&(r=[this.buffer.join("")+r[0],...r.slice(1)],this.buffer=[]),n||(this.buffer=[r.pop()||""]),r):(this.buffer.push(r[0]),[])}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if(void 0!==TI){if(e instanceof TI)return e.toString();if(e instanceof Uint8Array)return TI.from(e).toString();throw new fI(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new fI(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new fI("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}DI.NEWLINE_CHARS=new Set(["\n","\r"]),DI.NEWLINE_REGEXP=/\r\n|[\n\r]/g;var MI=n(58651);class LI{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;return new LI((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const n of async function*(e,t){if(!e.body)throw t.abort(),new fI("Attempted to iterate over a response with no body");const n=new NI,r=new DI,s=OI(e.body);for await(const e of async function*(e){let t=new Uint8Array;for await(const n of e){if(null==n)continue;const e=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?(new TextEncoder).encode(n):n;let r,s=new Uint8Array(t.length+e.length);for(s.set(t),s.set(e,t.length),t=s;-1!==(r=RI(t));)yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}(s))for(const t of r.decode(e)){const e=n.decode(t);e&&(yield e)}for(const e of r.flush()){const t=n.decode(e);t&&(yield t)}}(e,t)){if("completion"===n.event)try{yield JSON.parse(n.data)}catch(e){throw MI.error("Could not parse message into JSON:",n.data),MI.error("From chunk:",n.raw),e}if("message_start"===n.event||"message_delta"===n.event||"message_stop"===n.event||"content_block_start"===n.event||"content_block_delta"===n.event||"content_block_stop"===n.event)try{yield JSON.parse(n.data)}catch(e){throw MI.error("Could not parse message into JSON:",n.data),MI.error("From chunk:",n.raw),e}if("ping"!==n.event&&"error"===n.event)throw yI.generate(void 0,`SSE Error: ${n.data}`,n.data,tA(e.headers))}r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}}),t)}static fromReadableStream(e,t){let n=!1;return new LI((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const t of async function*(){const t=new DI,n=OI(e);for await(const e of n)for(const n of t.decode(e))yield n;for(const e of t.flush())yield e}())r||t&&(yield JSON.parse(t));r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}}),t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new LI((()=>r(e)),this.controller),new LI((()=>r(t)),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new sI({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:r,done:s}=await t.next();if(s)return e.close();const i=n.encode(JSON.stringify(r)+"\n");e.enqueue(i)}catch(t){e.error(t)}},async cancel(){await(t.return?.())}})}}function RI(e){for(let t=0;t<e.length-2;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}class NI{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=function(e,t){const n=e.indexOf(t);if(-1!==n)return[e.substring(0,n),t,e.substring(n+t.length)];return[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}function OI(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}var _I=n(37542).Buffer;const BI=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,FI=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&UI(e),UI=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function HI(e,t,n){if(e=await e,FI(e))return e;if(BI(e)){const r=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const s=UI(r)?[await r.arrayBuffer()]:[r];return new rI(s,t,n)}const r=await async function(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(UI(e))t.push(await e.arrayBuffer());else{if(!jI(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}(e)}`);for await(const n of e)t.push(n)}return t}(e);if(t||(t=function(e){return zI(e.name)||zI(e.filename)||zI(e.path)?.split(/[\\/]/).pop()}(e)??"unknown_file"),!n?.type){const e=r[0]?.type;"string"==typeof e&&(n={...n,type:e})}return new rI(r,t,n)}const zI=e=>"string"==typeof e?e:void 0!==_I&&e instanceof _I?String(e):void 0,jI=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],VI=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag];var qI,WI=n(37542).Buffer,QI=n(72715),GI=n(58651),ZI=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},YI=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};async function KI(e){const{response:t}=e;if(e.options.stream)return bA("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):LI.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type");if(n?.includes("application/json")||n?.includes("application/vnd.api+json")){const e=await t.json();return bA("response",t.status,t.url,t.headers,e),e}const r=await t.text();return bA("response",t.status,t.url,t.headers,r),r}class JI extends Promise{constructor(e,t=KI){super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new JI(this.responsePromise,(async t=>e(await this.parseResponse(t),t)))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class XI{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:s}){this.baseURL=e,this.maxRetries=pA("maxRetries",t),this.timeout=pA("timeout",n),this.httpAgent=r,this.fetch=s??nI}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...lA(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${CA()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((async n=>{const r=n&&UI(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}})))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"==typeof e){if(void 0!==WI)return WI.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder){return(new TextEncoder).encode(e).length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const{method:n,path:r,query:s,headers:i={}}=e,a=ArrayBuffer.isView(e.body)||e.__binaryRequest&&"string"==typeof e.body?e.body:VI(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,o=this.calculateContentLength(a),l=this.buildURL(r,s);"timeout"in e&&pA("timeout",e.timeout);const c=e.timeout??this.timeout,u=e.httpAgent??this.httpAgent??iI(l),d=c+1e3;"number"==typeof u?.options?.timeout&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&"get"!==n&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);return{req:{method:n,...a&&{body:a},headers:this.buildHeaders({options:e,headers:i,contentLength:o,retryCount:t}),...u&&{agent:u},signal:e.signal??null},url:l,timeout:c}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const s={};n&&(s["content-length"]=n);const i=this.defaultHeaders(e);return vA(s,i),vA(s,t),VI(e.body)&&"node"!==tI&&delete s["content-type"],void 0===wA(i,"x-stainless-retry-count")&&void 0===wA(t,"x-stainless-retry-count")&&(s["x-stainless-retry-count"]=String(r)),this.validateHeaders(s,t),s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,n,r){return yI.generate(e,t,n,r)}request(e,t=null){return new JI(this.makeRequest(e,t))}async makeRequest(e,t){const n=await e,r=n.maxRetries??this.maxRetries;null==t&&(t=r),await this.prepareOptions(n);const{req:s,url:i,timeout:a}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(s,{url:i,options:n}),bA("request",i,n,s.headers),n.signal?.aborted)throw new vI;const o=new AbortController,l=await this.fetchWithTimeout(i,s,a,o).catch(gA);if(l instanceof Error){if(n.signal?.aborted)throw new vI;if(t)return this.retryRequest(n,t);if("AbortError"===l.name)throw new CI;throw new bI({cause:l})}const c=tA(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){return bA(`response (error; ${`retrying, ${t} attempts remaining`})`,l.status,i,c),this.retryRequest(n,t,c)}const e=await l.text().catch((e=>gA(e).message)),r=cA(e),s=r?void 0:e;bA(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,c,s);throw this.makeStatusError(l.status,r,s,c)}return{response:l,options:n,controller:o}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new eA(this,n,e)}buildURL(e,t){const n=dA(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return fA(r)||(t={...r,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new fI(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:s,...i}=t||{};s&&s.addEventListener("abort",(()=>r.abort()));const a=setTimeout((()=>r.abort()),n);return this.getRequestClient().fetch.call(void 0,e,{signal:r.signal,...i}).finally((()=>{clearTimeout(a)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,n){let r;const s=n?.["retry-after-ms"];if(s){const e=parseFloat(s);Number.isNaN(e)||(r=e)}const i=n?.["retry-after"];if(i&&!r){const e=parseFloat(i);r=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(r&&0<=r&&r<6e4)){const n=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,n)}return await hA(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${eI}`}}class $I{constructor(e,t,n,r){qI.set(this,void 0),ZI(this,qI,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new fI("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,r]of n)e.url.searchParams.set(t,r);t.query=void 0,t.path=e.url.toString()}return await YI(this,qI,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(qI=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class eA extends JI{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await KI(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}const tA=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),nA={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},rA=e=>"object"==typeof e&&null!==e&&!fA(e)&&Object.keys(e).every((e=>yA(nA,e))),sA=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":aA(Deno.build.os),"X-Stainless-Arch":iA(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":QI.version};if("[object process]"===Object.prototype.toString.call(void 0!==QI?QI:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":aA(QI.platform),"X-Stainless-Arch":iA(QI.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":QI.version};const e=function(){if("undefined"==typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const iA=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",aA=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let oA;const lA=()=>oA??(oA=sA()),cA=e=>{try{return JSON.parse(e)}catch(e){return}},uA=new RegExp("^(?:[a-z]+:)?//","i"),dA=e=>uA.test(e),hA=e=>new Promise((t=>setTimeout(t,e))),pA=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new fI(`${e} must be an integer`);if(t<0)throw new fI(`${e} must be a positive integer`);return t},gA=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return new Error(JSON.stringify(e))}catch{}return new Error(String(e))},mA=e=>void 0!==QI?QI.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function fA(e){if(!e)return!0;for(const t in e)return!1;return!0}function yA(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function vA(e,t){for(const n in t){if(!yA(t,n))continue;const r=n.toLowerCase();if(!r)continue;const s=t[n];null===s?delete e[r]:void 0!==s&&(e[r]=s)}}function bA(e,...t){void 0!==QI&&"true"===QI?.env?.DEBUG&&GI.log(`Anthropic:DEBUG:${e}`,...t)}const CA=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),wA=(e,t)=>{const n=t.toLowerCase();if((e=>"function"==typeof e?.get)(e)){const r=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,((e,t,n)=>t+n.toUpperCase()));for(const s of[t,n,t.toUpperCase(),r]){const t=e.get(s);if(t)return t}}for(const[r,s]of Object.entries(e))if(r.toLowerCase()===n)return Array.isArray(s)?(s.length<=1||GI.warn(`Received ${s.length} entries for the ${t} header, using the first entry.`),s[0]):s};class SA{constructor(e){this._client=e}}class EA extends SA{create(e,t){return this._client.post("/v1/complete",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}}const xA=e=>{if(0===e.length)return e;let t=e[e.length-1];switch(t.type){case"separator":return e=e.slice(0,e.length-1),xA(e);case"number":let n=t.value[t.value.length-1];if("."===n||"-"===n)return e=e.slice(0,e.length-1),xA(e);case"string":let r=e[e.length-2];if("delimiter"===r?.type)return e=e.slice(0,e.length-1),xA(e);if("brace"===r?.type&&"{"===r.value)return e=e.slice(0,e.length-1),xA(e);break;case"delimiter":return e=e.slice(0,e.length-1),xA(e)}return e},IA=e=>JSON.parse((e=>{let t="";return e.map((e=>{"string"===e.type?t+='"'+e.value+'"':t+=e.value})),t})((e=>{let t=[];return e.map((e=>{"brace"===e.type&&("{"===e.value?t.push("}"):t.splice(t.lastIndexOf("}"),1)),"paren"===e.type&&("["===e.value?t.push("]"):t.splice(t.lastIndexOf("]"),1))})),t.length>0&&t.reverse().map((t=>{"}"===t?e.push({type:"brace",value:"}"}):"]"===t&&e.push({type:"paren",value:"]"})})),e})(xA((e=>{let t=0,n=[];for(;t<e.length;){let r=e[t];if("\\"===r){t++;continue}if("{"===r){n.push({type:"brace",value:"{"}),t++;continue}if("}"===r){n.push({type:"brace",value:"}"}),t++;continue}if("["===r){n.push({type:"paren",value:"["}),t++;continue}if("]"===r){n.push({type:"paren",value:"]"}),t++;continue}if(":"===r){n.push({type:"separator",value:":"}),t++;continue}if(","===r){n.push({type:"delimiter",value:","}),t++;continue}if('"'===r){let s="",i=!1;for(r=e[++t];'"'!==r;){if(t===e.length){i=!0;break}if("\\"===r){if(t++,t===e.length){i=!0;break}s+=r+e[t],r=e[++t]}else s+=r,r=e[++t]}r=e[++t],i||n.push({type:"string",value:s});continue}if(r&&/\s/.test(r)){t++;continue}let s=/[0-9]/;if(r&&s.test(r)||"-"===r||"."===r){let i="";for("-"===r&&(i+=r,r=e[++t]);r&&s.test(r)||"."===r;)i+=r,r=e[++t];n.push({type:"number",value:i});continue}let i=/[a-z]/i;if(r&&i.test(r)){let s="";for(;r&&i.test(r)&&t!==e.length;)s+=r,r=e[++t];if("true"!=s&&"false"!=s&&"null"!==s){t++;continue}n.push({type:"name",value:s})}else t++}return n})(e)))));var AA,PA,kA,TA,DA,MA,LA,RA,NA,OA,_A,BA,FA,UA,HA,zA,jA,VA,qA,WA,QA=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},GA=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};const ZA="__json_buf";class YA{constructor(){AA.add(this),this.messages=[],this.receivedMessages=[],PA.set(this,void 0),this.controller=new AbortController,kA.set(this,void 0),TA.set(this,(()=>{})),DA.set(this,(()=>{})),MA.set(this,void 0),LA.set(this,(()=>{})),RA.set(this,(()=>{})),NA.set(this,{}),OA.set(this,!1),_A.set(this,!1),BA.set(this,!1),FA.set(this,!1),zA.set(this,(e=>{if(QA(this,_A,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new vI),e instanceof vI)return QA(this,BA,!0,"f"),this._emit("abort",e);if(e instanceof fI)return this._emit("error",e);if(e instanceof Error){const t=new fI(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new fI(String(e)))})),QA(this,kA,new Promise(((e,t)=>{QA(this,TA,e,"f"),QA(this,DA,t,"f")})),"f"),QA(this,MA,new Promise(((e,t)=>{QA(this,LA,e,"f"),QA(this,RA,t,"f")})),"f"),GA(this,kA,"f").catch((()=>{})),GA(this,MA,"f").catch((()=>{}))}static fromReadableStream(e){const t=new YA;return t._run((()=>t._fromReadableStream(e))),t}static createMessage(e,t,n){const r=new YA;for(const e of t.messages)r._addMessageParam(e);return r._run((()=>r._createMessage(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}_run(e){e().then((()=>{this._emitFinal(),this._emit("end")}),GA(this,zA,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),GA(this,AA,"m",jA).call(this);const s=await e.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const e of s)GA(this,AA,"m",VA).call(this,e);if(s.controller.signal?.aborted)throw new vI;GA(this,AA,"m",qA).call(this)}_connected(){this.ended||(GA(this,TA,"f").call(this),this._emit("connect"))}get ended(){return GA(this,OA,"f")}get errored(){return GA(this,_A,"f")}get aborted(){return GA(this,BA,"f")}abort(){this.controller.abort()}on(e,t){return(GA(this,NA,"f")[e]||(GA(this,NA,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=GA(this,NA,"f")[e];if(!n)return this;const r=n.findIndex((e=>e.listener===t));return r>=0&&n.splice(r,1),this}once(e,t){return(GA(this,NA,"f")[e]||(GA(this,NA,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,n)=>{QA(this,FA,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)}))}async done(){QA(this,FA,!0,"f"),await GA(this,MA,"f")}get currentMessage(){return GA(this,PA,"f")}async finalMessage(){return await this.done(),GA(this,AA,"m",UA).call(this)}async finalText(){return await this.done(),GA(this,AA,"m",HA).call(this)}_emit(e,...t){if(GA(this,OA,"f"))return;"end"===e&&(QA(this,OA,!0,"f"),GA(this,LA,"f").call(this));const n=GA(this,NA,"f")[e];if(n&&(GA(this,NA,"f")[e]=n.filter((e=>!e.once)),n.forEach((({listener:e})=>e(...t)))),"abort"===e){const e=t[0];return GA(this,FA,"f")||n?.length||Promise.reject(e),GA(this,DA,"f").call(this,e),GA(this,RA,"f").call(this,e),void this._emit("end")}if("error"===e){const e=t[0];GA(this,FA,"f")||n?.length||Promise.reject(e),GA(this,DA,"f").call(this,e),GA(this,RA,"f").call(this,e),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",GA(this,AA,"m",UA).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),GA(this,AA,"m",jA).call(this),this._connected();const r=LI.fromReadableStream(e,this.controller);for await(const e of r)GA(this,AA,"m",VA).call(this,e);if(r.controller.signal?.aborted)throw new vI;GA(this,AA,"m",qA).call(this)}[(PA=new WeakMap,kA=new WeakMap,TA=new WeakMap,DA=new WeakMap,MA=new WeakMap,LA=new WeakMap,RA=new WeakMap,NA=new WeakMap,OA=new WeakMap,_A=new WeakMap,BA=new WeakMap,FA=new WeakMap,zA=new WeakMap,AA=new WeakSet,UA=function(){if(0===this.receivedMessages.length)throw new fI("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},HA=function(){if(0===this.receivedMessages.length)throw new fI("stream ended without producing a Message with role=assistant");const e=this.receivedMessages.at(-1).content.filter((e=>"text"===e.type)).map((e=>e.text));if(0===e.length)throw new fI("stream ended without producing a content block with type=text");return e.join(" ")},jA=function(){this.ended||QA(this,PA,void 0,"f")},VA=function(e){if(this.ended)return;const t=GA(this,AA,"m",WA).call(this,e);switch(this._emit("streamEvent",e,t),e.type){case"content_block_delta":{const n=t.content.at(-1);"text_delta"===e.delta.type&&"text"===n.type?this._emit("text",e.delta.text,n.text||""):"input_json_delta"===e.delta.type&&"tool_use"===n.type&&n.input&&this._emit("inputJson",e.delta.partial_json,n.input);break}case"message_stop":this._addMessageParam(t),this._addMessage(t,!0);break;case"content_block_stop":this._emit("contentBlock",t.content.at(-1));break;case"message_start":QA(this,PA,t,"f")}},qA=function(){if(this.ended)throw new fI("stream has ended, this shouldn't happen");const e=GA(this,PA,"f");if(!e)throw new fI("request ended without sending any chunks");return QA(this,PA,void 0,"f"),e},WA=function(e){let t=GA(this,PA,"f");if("message_start"===e.type){if(t)throw new fI(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!t)throw new fI(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":case"content_block_stop":return t;case"message_delta":return t.stop_reason=e.delta.stop_reason,t.stop_sequence=e.delta.stop_sequence,t.usage.output_tokens=e.usage.output_tokens,t;case"content_block_start":return t.content.push(e.content_block),t;case"content_block_delta":{const n=t.content.at(e.index);if("text"===n?.type&&"text_delta"===e.delta.type)n.text+=e.delta.text;else if("tool_use"===n?.type&&"input_json_delta"===e.delta.type){let t=n[ZA]||"";t+=e.delta.partial_json,Object.defineProperty(n,ZA,{value:t,enumerable:!1,writable:!0}),t&&(n.input=IA(t))}return t}}},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("streamEvent",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new LI(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}var KA=n(58651);class JA extends SA{create(e,t){return e.model in XA&&KA.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${XA[e.model]}\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:e,timeout:this._client._options.timeout??6e5,...t,stream:e.stream??!1})}stream(e,t){return YA.createMessage(this,e,t)}}const XA={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024"};class $A extends $I{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1,this.first_id=n.first_id||null,this.last_id=n.last_id||null}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){if(this.options.query?.before_id){const e=this.first_id;return e?{params:{before_id:e}}:null}const e=this.last_id;return e?{params:{after_id:e}}:null}}class eP{constructor(e,t){this.iterator=e,this.controller=t}async*decoder(){const e=new DI;for await(const t of this.iterator)for(const n of e.decode(t))yield JSON.parse(n);for(const t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body)throw t.abort(),new fI("Attempted to iterate over a response with no body");return new eP(OI(e.body),t)}}class tP extends SA{create(e,t){const{betas:n,...r}=e;return this._client.post("/v1/messages/batches?beta=true",{body:r,...t,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...t?.headers}})}retrieve(e,t={},n){if(rA(t))return this.retrieve(e,{},t);const{betas:r}=t;return this._client.get(`/v1/messages/batches/${e}?beta=true`,{...n,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}list(e={},t){if(rA(e))return this.list({},e);const{betas:n,...r}=e;return this._client.getAPIList("/v1/messages/batches?beta=true",nP,{query:r,...t,headers:{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),...t?.headers}})}cancel(e,t={},n){if(rA(t))return this.cancel(e,{},t);const{betas:r}=t;return this._client.post(`/v1/messages/batches/${e}/cancel?beta=true`,{...n,headers:{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString(),...n?.headers}})}async results(e,t={},n){if(rA(t))return this.results(e,{},t);const r=await this.retrieve(e);if(!r.results_url)throw new fI(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);const{betas:s}=t;return this._client.get(r.results_url,{...n,headers:{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString(),...n?.headers},__binaryResponse:!0})._thenUnwrap(((e,t)=>eP.fromResponse(t.response,t.controller)))}}class nP extends $A{}tP.BetaMessageBatchesPage=nP;class rP extends SA{constructor(){super(...arguments),this.batches=new tP(this._client)}create(e,t){const{betas:n,...r}=e;return this._client.post("/v1/messages?beta=true",{body:r,timeout:this._client._options.timeout??6e5,...t,headers:{...null!=n?.toString()?{"anthropic-beta":n?.toString()}:void 0,...t?.headers},stream:e.stream??!1})}countTokens(e,t){const{betas:n,...r}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:r,...t,headers:{"anthropic-beta":[...n??[],"token-counting-2024-11-01"].toString(),...t?.headers}})}}rP.Batches=tP,rP.BetaMessageBatchesPage=nP;var sP,iP,aP,oP,lP,cP,uP,dP,hP,pP,gP,mP,fP,yP,vP,bP,CP,wP,SP,EP,xP=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},IP=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};const AP="__json_buf";class PP{constructor(){sP.add(this),this.messages=[],this.receivedMessages=[],iP.set(this,void 0),this.controller=new AbortController,aP.set(this,void 0),oP.set(this,(()=>{})),lP.set(this,(()=>{})),cP.set(this,void 0),uP.set(this,(()=>{})),dP.set(this,(()=>{})),hP.set(this,{}),pP.set(this,!1),gP.set(this,!1),mP.set(this,!1),fP.set(this,!1),bP.set(this,(e=>{if(xP(this,gP,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new vI),e instanceof vI)return xP(this,mP,!0,"f"),this._emit("abort",e);if(e instanceof fI)return this._emit("error",e);if(e instanceof Error){const t=new fI(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new fI(String(e)))})),xP(this,aP,new Promise(((e,t)=>{xP(this,oP,e,"f"),xP(this,lP,t,"f")})),"f"),xP(this,cP,new Promise(((e,t)=>{xP(this,uP,e,"f"),xP(this,dP,t,"f")})),"f"),IP(this,aP,"f").catch((()=>{})),IP(this,cP,"f").catch((()=>{}))}static fromReadableStream(e){const t=new PP;return t._run((()=>t._fromReadableStream(e))),t}static createMessage(e,t,n){const r=new PP;for(const e of t.messages)r._addPromptCachingBetaMessageParam(e);return r._run((()=>r._createPromptCachingBetaMessage(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}_run(e){e().then((()=>{this._emitFinal(),this._emit("end")}),IP(this,bP,"f"))}_addPromptCachingBetaMessageParam(e){this.messages.push(e)}_addPromptCachingBetaMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createPromptCachingBetaMessage(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),IP(this,sP,"m",CP).call(this);const s=await e.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const e of s)IP(this,sP,"m",wP).call(this,e);if(s.controller.signal?.aborted)throw new vI;IP(this,sP,"m",SP).call(this)}_connected(){this.ended||(IP(this,oP,"f").call(this),this._emit("connect"))}get ended(){return IP(this,pP,"f")}get errored(){return IP(this,gP,"f")}get aborted(){return IP(this,mP,"f")}abort(){this.controller.abort()}on(e,t){return(IP(this,hP,"f")[e]||(IP(this,hP,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=IP(this,hP,"f")[e];if(!n)return this;const r=n.findIndex((e=>e.listener===t));return r>=0&&n.splice(r,1),this}once(e,t){return(IP(this,hP,"f")[e]||(IP(this,hP,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,n)=>{xP(this,fP,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)}))}async done(){xP(this,fP,!0,"f"),await IP(this,cP,"f")}get currentMessage(){return IP(this,iP,"f")}async finalMessage(){return await this.done(),IP(this,sP,"m",yP).call(this)}async finalText(){return await this.done(),IP(this,sP,"m",vP).call(this)}_emit(e,...t){if(IP(this,pP,"f"))return;"end"===e&&(xP(this,pP,!0,"f"),IP(this,uP,"f").call(this));const n=IP(this,hP,"f")[e];if(n&&(IP(this,hP,"f")[e]=n.filter((e=>!e.once)),n.forEach((({listener:e})=>e(...t)))),"abort"===e){const e=t[0];return IP(this,fP,"f")||n?.length||Promise.reject(e),IP(this,lP,"f").call(this,e),IP(this,dP,"f").call(this,e),void this._emit("end")}if("error"===e){const e=t[0];IP(this,fP,"f")||n?.length||Promise.reject(e),IP(this,lP,"f").call(this,e),IP(this,dP,"f").call(this,e),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalPromptCachingBetaMessage",IP(this,sP,"m",yP).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),IP(this,sP,"m",CP).call(this),this._connected();const r=LI.fromReadableStream(e,this.controller);for await(const e of r)IP(this,sP,"m",wP).call(this,e);if(r.controller.signal?.aborted)throw new vI;IP(this,sP,"m",SP).call(this)}[(iP=new WeakMap,aP=new WeakMap,oP=new WeakMap,lP=new WeakMap,cP=new WeakMap,uP=new WeakMap,dP=new WeakMap,hP=new WeakMap,pP=new WeakMap,gP=new WeakMap,mP=new WeakMap,fP=new WeakMap,bP=new WeakMap,sP=new WeakSet,yP=function(){if(0===this.receivedMessages.length)throw new fI("stream ended without producing a PromptCachingBetaMessage with role=assistant");return this.receivedMessages.at(-1)},vP=function(){if(0===this.receivedMessages.length)throw new fI("stream ended without producing a PromptCachingBetaMessage with role=assistant");const e=this.receivedMessages.at(-1).content.filter((e=>"text"===e.type)).map((e=>e.text));if(0===e.length)throw new fI("stream ended without producing a content block with type=text");return e.join(" ")},CP=function(){this.ended||xP(this,iP,void 0,"f")},wP=function(e){if(this.ended)return;const t=IP(this,sP,"m",EP).call(this,e);switch(this._emit("streamEvent",e,t),e.type){case"content_block_delta":{const n=t.content.at(-1);"text_delta"===e.delta.type&&"text"===n.type?this._emit("text",e.delta.text,n.text||""):"input_json_delta"===e.delta.type&&"tool_use"===n.type&&n.input&&this._emit("inputJson",e.delta.partial_json,n.input);break}case"message_stop":this._addPromptCachingBetaMessageParam(t),this._addPromptCachingBetaMessage(t,!0);break;case"content_block_stop":this._emit("contentBlock",t.content.at(-1));break;case"message_start":xP(this,iP,t,"f")}},SP=function(){if(this.ended)throw new fI("stream has ended, this shouldn't happen");const e=IP(this,iP,"f");if(!e)throw new fI("request ended without sending any chunks");return xP(this,iP,void 0,"f"),e},EP=function(e){let t=IP(this,iP,"f");if("message_start"===e.type){if(t)throw new fI(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!t)throw new fI(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":case"content_block_stop":return t;case"message_delta":return t.stop_reason=e.delta.stop_reason,t.stop_sequence=e.delta.stop_sequence,t.usage.output_tokens=e.usage.output_tokens,t;case"content_block_start":return t.content.push(e.content_block),t;case"content_block_delta":{const n=t.content.at(e.index);if("text"===n?.type&&"text_delta"===e.delta.type)n.text+=e.delta.text;else if("tool_use"===n?.type&&"input_json_delta"===e.delta.type){let t=n[AP]||"";t+=e.delta.partial_json,Object.defineProperty(n,AP,{value:t,enumerable:!1,writable:!0}),t&&(n.input=IA(t))}return t}}},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("streamEvent",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new LI(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class kP extends SA{create(e,t){const{betas:n,...r}=e;return this._client.post("/v1/messages?beta=prompt_caching",{body:r,timeout:this._client._options.timeout??6e5,...t,headers:{"anthropic-beta":[...n??[],"prompt-caching-2024-07-31"].toString(),...t?.headers},stream:e.stream??!1})}stream(e,t){return PP.createMessage(this,e,t)}}class TP extends SA{constructor(){super(...arguments),this.messages=new kP(this._client)}}TP.Messages=kP;class DP extends SA{constructor(){super(...arguments),this.messages=new rP(this._client),this.promptCaching=new TP(this._client)}}var MP;DP.Messages=rP,DP.PromptCaching=TP;class LP extends XI{constructor({baseURL:e=mA("ANTHROPIC_BASE_URL"),apiKey:t=mA("ANTHROPIC_API_KEY")??null,authToken:n=mA("ANTHROPIC_AUTH_TOKEN")??null,...r}={}){const s={apiKey:t,authToken:n,...r,baseURL:e||"https://api.anthropic.com"};if(!s.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new fI("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew Anthropic({ apiKey, dangerouslyAllowBrowser: true });\n\nTODO: link!\n");super({baseURL:s.baseURL,timeout:s.timeout??6e5,httpAgent:s.httpAgent,maxRetries:s.maxRetries,fetch:s.fetch}),this.completions=new EA(this),this.messages=new JA(this),this.beta=new DP(this),this._options=s,this.apiKey=t,this.authToken=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(e,t){if(!(this.apiKey&&e["x-api-key"]||null===t["x-api-key"]||this.authToken&&e.authorization||null===t.authorization))throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(e){const t=this.apiKeyAuth(e),n=this.bearerAuth(e);return null==t||fA(t)?null==n||fA(n)?{}:n:t}apiKeyAuth(e){return null==this.apiKey?{}:{"X-Api-Key":this.apiKey}}bearerAuth(e){return null==this.authToken?{}:{Authorization:`Bearer ${this.authToken}`}}}MP=LP,LP.Anthropic=MP,LP.HUMAN_PROMPT="\n\nHuman:",LP.AI_PROMPT="\n\nAssistant:",LP.DEFAULT_TIMEOUT=6e5,LP.AnthropicError=fI,LP.APIError=yI,LP.APIConnectionError=bI,LP.APIConnectionTimeoutError=CI,LP.APIUserAbortError=vI,LP.NotFoundError=xI,LP.ConflictError=II,LP.RateLimitError=PI,LP.BadRequestError=wI,LP.AuthenticationError=SI,LP.InternalServerError=kI,LP.PermissionDeniedError=EI,LP.UnprocessableEntityError=AI,LP.toFile=HI,LP.fileFromPath=aI;const{HUMAN_PROMPT:RP,AI_PROMPT:NP}=LP;LP.Completions=EA,LP.Messages=JA,LP.Beta=DP;const OP=e=>{switch(e.type){case"text":return{rawOutput:e,type:"output_text",content:[{type:"text",text:e.text}]};case"tool_use":return{rawOutput:e,type:"function_call",name:e.name,arguments:e.input,callId:e.id};default:return{rawOutput:e,type:"unknown"}}};class _P{constructor(e=[]){this.history=e}addStateToRequest(e){const t=this.history.map((e=>"user"===e.role?{role:"user",content:e.rawParam.content}:{role:"assistant",content:e.rawMessage.content}));return e.messages=[...t,...e.messages],e}lastOutputs(){const e=[];for(let t=this.history.length-1;t>=0;t--){const n=this.history[t];if("assistant"!==n.role)break;e.push(n)}e.reverse();const t=[];for(const n of e)for(const e of n.rawMessage.content)t.push(OP(e));return t}}const BP=e=>({name:e.name,description:e.description,input_schema:e.inputSchema,type:"custom"});class FP{constructor(e){if(this.opts=e,!e.apiAuth||0===e.apiAuth.length)throw new Error("API authentication details are missing");this.client=new LP({apiKey:this.opts.apiAuth[0],dangerouslyAllowBrowser:!0})}prepareInput(e){return"string"==typeof e?[{role:"user",content:e}]:e}async makeRequest(e,t,n,r){const s=this.prepareInput(e),i={model:this.opts.modelName,messages:s,tools:t.map(BP),max_tokens:this.opts.maxTokens,stream:this.opts.streaming},a=n??new _P([]);await a.addStateToRequest(i);const o=await this.client.messages.create(i);let l=[];if(this.opts.streaming){const e=o;l=await this.messagesFromStream(e,r)}else l=[o];const c=s.map((e=>({role:"user",rawParam:e}))),u=l.map((e=>({role:"assistant",rawMessage:e})));return new _P([...a.history,...c,...u])}convertToolOutputToBackendInput(e,t){return[{role:"user",content:[{type:"tool_result",tool_use_id:e.callId,content:t}]}]}async messagesFromStream(e,t){const n=[],r=[];for await(const s of e)if("message_start"!==s.type){if("message_stop"!==s.type){if("content_block_start"===s.type&&(r[s.index]=[],n[n.length-1].content.push(s.content_block)),"content_block_delta"===s.type){const e=s.delta;if("text_delta"===e.type){t?.onStreamingOutputText?.(e.text),r[s.index].push(e.text);continue}if("input_json_delta"===e.type){r[s.index].push(e.partial_json);continue}}if("content_block_stop"===s.type){const e=n[n.length-1],t=e.content[e.content.length-1];if("text"===t.type){t.text=r[s.index].join("");continue}if("tool_use"===t.type){t.input=JSON.parse(r[s.index].join(""));continue}}}}else n.push(s.message);return n}}var UP,HP,zP,jP;!function(e){e.HEADER="header",e.QUERY="query"}(UP||(UP={})),function(e){e.HEADER="header",e.QUERY="query"}(HP||(HP={})),function(e){e.HTTP="http",e.HTTPS="https"}(zP||(zP={})),function(e){e.MD5="md5",e.CRC32="crc32",e.CRC32C="crc32c",e.SHA1="sha1",e.SHA256="sha256"}(jP||(jP={}));var VP;!function(e){e[e.HEADER=0]="HEADER",e[e.TRAILER=1]="TRAILER"}(VP||(VP={}));const qP="__smithy_context";var WP,QP;!function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"}(WP||(WP={})),function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"}(QP||(QP={}));class GP{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?":"!==e.protocol.slice(-1)?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?"/"!==e.path.charAt(0)?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new GP({...e,headers:{...e.headers}});var n;return t.query&&(t.query=(n=t.query,Object.keys(n).reduce(((e,t)=>{const r=n[t];return{...e,[t]:Array.isArray(r)?[...r]:r}}),{}))),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&"object"==typeof t.query&&"object"==typeof t.headers}clone(){return GP.clone(this)}}class ZP{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return"number"==typeof t.statusCode&&"object"==typeof t.headers}}const YP={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},KP=e=>({applyToStack:t=>{t.add((e=>t=>async n=>{if(!GP.isInstance(n.request))return t(n);const{request:r}=n,{handlerProtocol:s=""}=e.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!r.headers[":authority"])delete r.headers.host,r.headers[":authority"]=r.hostname+(r.port?":"+r.port:"");else if(!r.headers.host){let e=r.hostname;null!=r.port&&(e+=`:${r.port}`),r.headers.host=e}return t(n)})(e),YP)}}),JP={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0};var XP=n(72715);const $P="X-Amzn-Trace-Id",ek={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},tk=e=>({applyToStack:t=>{t.add((e=>t=>async n=>{const{request:r}=n;if(!GP.isInstance(r)||"node"!==e.runtime)return t(n);const s=Object.keys(r.headers??{}).find((e=>e.toLowerCase()===$P.toLowerCase()))??$P;if(r.headers.hasOwnProperty(s))return t(n);const i=XP.env.AWS_LAMBDA_FUNCTION_NAME,a=XP.env._X_AMZN_TRACE_ID,o=e=>"string"==typeof e&&e.length>0;return o(i)&&o(a)&&(r.headers[$P]=a),t({...n,request:r})})(e),ek)}}),nk=e=>e[qP]||(e[qP]={}),rk=e=>{if("function"==typeof e)return e;const t=Promise.resolve(e);return()=>t};const sk=(e,t)=>(n,r)=>async s=>{const i=((e,t)=>{if(!t||0===t.length)return e;const n=[];for(const r of t)for(const t of e)t.schemeId.split("#")[1]===r&&n.push(t);for(const t of e)n.find((({schemeId:e})=>e===t.schemeId))||n.push(t);return n})(e.httpAuthSchemeProvider(await t.httpAuthSchemeParametersProvider(e,r,s.input)),e.authSchemePreference?await e.authSchemePreference():[]),a=function(e){const t=new Map;for(const n of e)t.set(n.schemeId,n);return t}(e.httpAuthSchemes),o=nk(r),l=[];for(const n of i){const s=a.get(n.schemeId);if(!s){l.push(`HttpAuthScheme \`${n.schemeId}\` was not enabled for this service.`);continue}const i=s.identityProvider(await t.identityProviderConfigProvider(e));if(!i){l.push(`HttpAuthScheme \`${n.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:c={},signingProperties:u={}}=n.propertiesExtractor?.(e,r)||{};n.identityProperties=Object.assign(n.identityProperties||{},c),n.signingProperties=Object.assign(n.signingProperties||{},u),o.selectedHttpAuthScheme={httpAuthOption:n,identity:await i(n.identityProperties),signer:s.signer};break}if(!o.selectedHttpAuthScheme)throw new Error(l.join("\n"));return n(s)},ik={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"};var ak=n(58651);const ok=(e,t)=>(t.find((([t])=>t.match(e)))||[void 0,void 0])[1],lk={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},ck={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function uk(e,t,n){return{applyToStack:r=>{r.add(((e,t)=>(n,r)=>async s=>{const{response:i}=await n(s);try{return{response:i,output:await t(i,e)}}catch(e){if(Object.defineProperty(e,"$response",{value:i}),!("$metadata"in e)){const t="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";try{e.message+="\n  "+t}catch(e){r.logger&&"NoOpLogger"!==r.logger?.constructor?.name?r.logger?.warn?.(t):ak.warn(t)}void 0!==e.$responseBodyText&&e.$response&&(e.$response.body=e.$responseBodyText);try{if(ZP.isInstance(i)){const{headers:t={}}=i,n=Object.entries(t);e.$metadata={httpStatusCode:i.statusCode,requestId:ok(/^x-[\w-]+-request-?id$/,n),extendedRequestId:ok(/^x-[\w-]+-id-2$/,n),cfId:ok(/^x-[\w-]+-cf-id$/,n)}}}catch(e){}}throw e}})(e,n),lk),r.add(((e,t)=>(n,r)=>async s=>{const i=e,a=r.endpointV2?.url&&i.urlParser?async()=>i.urlParser(r.endpointV2.url):i.endpoint;if(!a)throw new Error("No valid endpoint provider available.");const o=await t(s.input,{...e,endpoint:a});return n({...s,request:o})})(e,t),ck)}}}const dk=e=>e=>{throw e},hk=(e,t)=>{},pk={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},gk=e=>({applyToStack:e=>{e.addRelativeTo(((e,t)=>async n=>{if(!GP.isInstance(n.request))return e(n);const r=nk(t).selectedHttpAuthScheme;if(!r)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:s={}},identity:i,signer:a}=r,o=await e({...n,request:await a.sign(n.request,i,s)}).catch((a.errorHandler||dk)(s));return(a.successHandler||hk)(o.response,s),o}),pk)}}),mk=e=>{if("function"==typeof e)return e;const t=Promise.resolve(e);return()=>t},fk={},yk=new Array(64);for(let e=0,t="A".charCodeAt(0),n="Z".charCodeAt(0);e+t<=n;e++){const n=String.fromCharCode(e+t);fk[n]=e,yk[e]=n}for(let e=0,t="a".charCodeAt(0),n="z".charCodeAt(0);e+t<=n;e++){const n=String.fromCharCode(e+t),r=e+26;fk[n]=r,yk[r]=n}for(let e=0;e<10;e++){fk[e.toString(10)]=e+52;const t=e.toString(10),n=e+52;fk[t]=n,yk[n]=t}fk["+"]=62,yk[62]="+",fk["/"]=63,yk[63]="/";const vk=e=>{let t=e.length/4*3;"=="===e.slice(-2)?t-=2:"="===e.slice(-1)&&t--;const n=new ArrayBuffer(t),r=new DataView(n);for(let t=0;t<e.length;t+=4){let n=0,s=0;for(let r=t,i=t+3;r<=i;r++)if("="!==e[r]){if(!(e[r]in fk))throw new TypeError(`Invalid character ${e[r]} in base64 string.`);n|=fk[e[r]]<<6*(i-r),s+=6}else n>>=6;const i=t/4*3;n>>=s%8;const a=Math.floor(s/8);for(let e=0;e<a;e++){const t=8*(a-e-1);r.setUint8(i+e,(n&255<<t)>>t)}}return new Uint8Array(n)},bk=e=>(new TextEncoder).encode(e);function Ck(e){let t;t="string"==typeof e?bk(e):e;const n="object"==typeof t&&"number"==typeof t.length,r="object"==typeof t&&"number"==typeof t.byteOffset&&"number"==typeof t.byteLength;if(!n&&!r)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let e=0;e<t.length;e+=3){let n=0,r=0;for(let s=e,i=Math.min(e+3,t.length);s<i;s++)n|=t[s]<<8*(i-s-1),r+=8;const i=Math.ceil(r/6);n<<=6*i-r;for(let e=1;e<=i;e++){const t=6*(i-e);s+=yk[(n&63<<t)>>t]}s+="==".slice(0,4-i)}return s}const wk=e=>{if("string"==typeof e)return e;if("object"!=typeof e||"number"!=typeof e.byteOffset||"number"!=typeof e.byteLength)throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(e)};class Sk extends Uint8Array{static fromString(e,t="utf-8"){if("string"==typeof e)return function(e,t){return"base64"===t?Sk.mutate(vk(e)):Sk.mutate(bk(e))}(e,t);throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,Sk.prototype),e}transformToString(e="utf-8"){return function(e,t="utf-8"){return"base64"===t?Ck(e):wk(e)}(this,e)}}"function"==typeof ReadableStream&&ReadableStream;n(37542).Buffer;const Ek=e=>encodeURIComponent(e).replace(/[!'()*]/g,xk),xk=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;function Ik(e){const t=[];for(let n of Object.keys(e).sort()){const r=e[n];if(n=Ek(n),Array.isArray(r))for(let e=0,s=r.length;e<s;e++)t.push(`${n}=${Ek(r[e])}`);else{let e=n;(r||"string"==typeof r)&&(e+=`=${Ek(r)}`),t.push(e)}}return t.join("&")}function Ak(e,t){return new Request(e,t)}function Pk(e=0){return new Promise(((t,n)=>{e&&setTimeout((()=>{const t=new Error(`Request did not complete within ${e} ms`);t.name="TimeoutError",n(t)}),e)}))}const kk={supported:void 0};class Tk{static create(e){return"function"==typeof e?.handle?e:new Tk(e)}constructor(e){"function"==typeof e?this.configProvider=e().then((e=>e||{})):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),void 0===kk.supported&&(kk.supported=Boolean("undefined"!=typeof Request&&"keepalive"in Ak("https://[::1]")))}destroy(){}async handle(e,{abortSignal:t}={}){this.config||(this.config=await this.configProvider);const n=this.config.requestTimeout,r=!0===this.config.keepAlive,s=this.config.credentials;if(t?.aborted){const e=new Error("Request aborted");return e.name="AbortError",Promise.reject(e)}let i=e.path;const a=Ik(e.query||{});a&&(i+=`?${a}`),e.fragment&&(i+=`#${e.fragment}`);let o="";if(null!=e.username||null!=e.password){o=`${e.username??""}:${e.password??""}@`}const{port:l,method:c}=e,u=`${e.protocol}//${o}${e.hostname}${l?`:${l}`:""}${i}`,d="GET"===c||"HEAD"===c?void 0:e.body,h={body:d,headers:new Headers(e.headers),method:c,credentials:s};this.config?.cache&&(h.cache=this.config.cache),d&&(h.duplex="half"),"undefined"!=typeof AbortController&&(h.signal=t),kk.supported&&(h.keepalive=r),"function"==typeof this.config.requestInit&&Object.assign(h,this.config.requestInit(e));let p=()=>{};const g=Ak(u,h),m=[fetch(g).then((e=>{const t=e.headers,n={};for(const e of t.entries())n[e[0]]=e[1];return null!=e.body?{response:new ZP({headers:n,reason:e.statusText,statusCode:e.status,body:e.body})}:e.blob().then((t=>({response:new ZP({headers:n,reason:e.statusText,statusCode:e.status,body:t})})))})),Pk(n)];return t&&m.push(new Promise(((e,n)=>{const r=()=>{const e=new Error("Request aborted");e.name="AbortError",n(e)};if("function"==typeof t.addEventListener){const e=t;e.addEventListener("abort",r,{once:!0}),p=()=>e.removeEventListener("abort",r)}else t.onabort=r}))),Promise.race(m).finally(p)}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then((n=>(n[e]=t,n)))}httpHandlerConfigs(){return this.config??{}}}const Dk=async e=>"function"==typeof Blob&&e instanceof Blob||"Blob"===e.constructor?.name?void 0!==Blob.prototype.arrayBuffer?new Uint8Array(await e.arrayBuffer()):async function(e){const t=await function(e){return new Promise(((t,n)=>{const r=new FileReader;r.onloadend=()=>{if(2!==r.readyState)return n(new Error("Reader aborted too early"));const e=r.result??"",s=e.indexOf(","),i=s>-1?s+1:e.length;t(e.substring(i))},r.onabort=()=>n(new Error("Read aborted")),r.onerror=()=>n(r.error),r.readAsDataURL(e)}))}(e),n=vk(t);return new Uint8Array(n)}(e):async function(e){const t=[],n=e.getReader();let r=!1,s=0;for(;!r;){const{done:e,value:i}=await n.read();i&&(t.push(i),s+=i.length),r=e}const i=new Uint8Array(s);let a=0;for(const e of t)i.set(e,a),a+=e.length;return i}(e);const Mk={},Lk={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),Mk[e]=t,Lk[t]=e}function Rk(e){if(e.length%2!=0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const r=e.slice(n,n+2).toLowerCase();if(!(r in Lk))throw new Error(`Cannot decode unrecognized sequence ${r} as hexadecimal`);t[n/2]=Lk[r]}return t}function Nk(e){let t="";for(let n=0;n<e.byteLength;n++)t+=Mk[e[n]];return t}n(58651);class Ok{constructor(e,t=new Map){this.namespace=e,this.schemas=t}static for(e){return Ok.registries.has(e)||Ok.registries.set(e,new Ok(e)),Ok.registries.get(e)}register(e,t){const n=this.normalizeShapeId(e);Ok.for(this.getNamespace(e)).schemas.set(n,t)}getSchema(e){const t=this.normalizeShapeId(e);if(!this.schemas.has(t))throw new Error(`@smithy/core/schema - schema not found for ${t}`);return this.schemas.get(t)}getBaseException(){for(const[e,t]of this.schemas.entries())if(e.startsWith("smithy.ts.sdk.synthetic.")&&e.endsWith("ServiceException"))return t}find(e){return[...this.schemas.values()].find(e)}destroy(){Ok.registries.delete(this.namespace),this.schemas.clear()}normalizeShapeId(e){return e.includes("#")?e:this.namespace+"#"+e}getNamespace(e){return this.normalizeShapeId(e).split("#")[0]}}Ok.registries=new Map;var _k=n(58651);const Bk=e=>{if(null!=e){if("number"==typeof e){if(0!==e&&1!==e||Zk.warn(Gk(`Expected boolean, got ${typeof e}: ${e}`)),0===e)return!1;if(1===e)return!0}if("string"==typeof e){const t=e.toLowerCase();if("false"!==t&&"true"!==t||Zk.warn(Gk(`Expected boolean, got ${typeof e}: ${e}`)),"false"===t)return!1;if("true"===t)return!0}if("boolean"==typeof e)return e;throw new TypeError(`Expected boolean, got ${typeof e}: ${e}`)}},Fk=e=>{if(null!=e){if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&Zk.warn(Gk(`Expected number but observed string: ${e}`)),t}if("number"==typeof e)return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}},Uk=(Math.ceil(2**127*(2-2**-23)),e=>{if(null!=e){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}}),Hk=e=>zk(e,32),zk=(e,t)=>{const n=Uk(e);if(void 0!==n&&jk(n,t)!==n)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return n},jk=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},Vk=e=>{if(null==e)return;if("object"==typeof e&&!Array.isArray(e))return e;const t=Array.isArray(e)?"array":typeof e;throw new TypeError(`Expected object, got ${t}: ${e}`)},qk=e=>{if(null!=e){if("string"==typeof e)return e;if(["boolean","number","bigint"].includes(typeof e))return Zk.warn(Gk(`Expected string, got ${typeof e}: ${e}`)),String(e);throw new TypeError(`Expected string, got ${typeof e}: ${e}`)}},Wk=e=>"string"==typeof e?Qk(e):Fk(e),Qk=e=>{switch(e){case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:throw new Error(`Unable to parse float value: ${e}`)}},Gk=e=>String(new TypeError(e).stack||e).split("\n").slice(0,5).filter((e=>!e.includes("stackTraceWarning"))).join("\n"),Zk={warn:_k.warn};const Yk=function(e){return Object.assign(new String(e),{deserializeJSON:()=>JSON.parse(String(e)),toString:()=>String(e),toJSON:()=>String(e)})};Yk.from=e=>e&&"object"==typeof e&&(e instanceof Yk||"deserializeJSON"in e)?e:"string"==typeof e||Object.getPrototypeOf(e)===String.prototype?Yk(String(e)):Yk(JSON.stringify(e)),Yk.fromObject=Yk.from;Symbol.hasInstance;function Kk(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}class Jk{constructor(e,t){this.input=e,this.context=t,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:e,protocol:t="https",port:n,path:r}=await this.context.endpoint();this.path=r;for(const e of this.resolvePathStack)e(this.path);return new GP({protocol:t,hostname:this.hostname||e,port:n,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(e){return this.hostname=e,this}bp(e){return this.resolvePathStack.push((t=>{this.path=`${t?.endsWith("/")?t.slice(0,-1):t||""}`+e})),this}p(e,t,n,r){return this.resolvePathStack.push((s=>{this.path=((e,t,n,r,s,i)=>{if(null==t||void 0===t[n])throw new Error("No value provided for input HTTP label: "+n+".");{const t=r();if(t.length<=0)throw new Error("Empty value provided for input HTTP label: "+n+".");e=e.replace(s,i?t.split("/").map((e=>Kk(e))).join("/"):Kk(t))}return e})(s,this.input,e,t,n,r)})),this}h(e){return this.headers=e,this}q(e){return this.query=e,this}b(e){return this.body=e,this}m(e){return this.method=e,this}}n(58651);n(58651);class Xk{constructor(e){this.authSchemes=new Map;for(const[t,n]of Object.entries(e))void 0!==n&&this.authSchemes.set(t,n)}getIdentityProvider(e){return this.authSchemes.get(e)}}class $k{async sign(e,t,n){const r=GP.clone(e);if(!t.token)throw new Error("request could not be signed with `token` since the `token` is not defined");return r.headers.Authorization=`Bearer ${t.token}`,r}}const eT=(tT=3e5,e=>nT(e)&&e.expiration.getTime()-Date.now()<tT);var tT;const nT=e=>void 0!==e.expiration,rT=(e,t,n)=>{if(void 0===e)return;const r="function"!=typeof e?async()=>Promise.resolve(e):e;let s,i,a,o=!1;const l=async e=>{i||(i=r(e));try{s=await i,a=!0,o=!1}finally{i=void 0}return s};return void 0===t?async e=>(a&&!e?.forceRefresh||(s=await l(e)),s):async e=>(a&&!e?.forceRefresh||(s=await l(e)),o?s:n(s)?t(s)?(await l(e),s):s:(o=!0,s))};var sT=n(58651);const iT=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),aT=e=>iT.test(e)||e.startsWith("[")&&e.endsWith("]"),oT=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),lT=(e,t=!1)=>{if(!t)return oT.test(e);const n=e.split(".");for(const e of n)if(!lT(e))return!1;return!0},cT={},uT="endpoints";function dT(e){return"object"!=typeof e||null==e?e:"ref"in e?`$${dT(e.ref)}`:"fn"in e?`${e.fn}(${(e.argv||[]).map(dT).join(", ")})`:JSON.stringify(e,null,2)}class hT extends Error{constructor(e){super(e),this.name="EndpointError"}}const pT=(e,t)=>(e=>{const t=e.split("."),n=[];for(const r of t){const t=r.indexOf("[");if(-1!==t){if(r.indexOf("]")!==r.length-1)throw new hT(`Path: '${e}' does not end with ']'`);const s=r.slice(t+1,-1);if(Number.isNaN(parseInt(s)))throw new hT(`Invalid array index: '${s}' in path: '${e}'`);0!==t&&n.push(r.slice(0,t)),n.push(s)}else n.push(r)}return n})(t).reduce(((n,r)=>{if("object"!=typeof n)throw new hT(`Index '${r}' in '${t}' not found in '${JSON.stringify(e)}'`);return Array.isArray(n)?n[parseInt(r)]:n[r]}),e);var gT=n(58651);const mT={[zP.HTTP]:80,[zP.HTTPS]:443},fT={booleanEquals:(e,t)=>e===t,getAttr:pT,isSet:e=>null!=e,isValidHostLabel:lT,not:e=>!e,parseURL:e=>{const t=(()=>{try{if(e instanceof URL)return e;if("object"==typeof e&&"hostname"in e){const{hostname:t,port:n,protocol:r="",path:s="",query:i={}}=e,a=new URL(`${r}//${t}${n?`:${n}`:""}${s}`);return a.search=Object.entries(i).map((([e,t])=>`${e}=${t}`)).join("&"),a}return new URL(e)}catch(e){return null}})();if(!t)return gT.error(`Unable to parse ${JSON.stringify(e)} as a whatwg URL.`),null;const n=t.href,{host:r,hostname:s,pathname:i,protocol:a,search:o}=t;if(o)return null;const l=a.slice(0,-1);if(!Object.values(zP).includes(l))return null;const c=aT(s);return{scheme:l,authority:`${r}${n.includes(`${r}:${mT[l]}`)||"string"==typeof e&&e.includes(`${r}:${mT[l]}`)?`:${mT[l]}`:""}`,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:c}},stringEquals:(e,t)=>e===t,substring:(e,t,n,r)=>t>=n||e.length<n?null:r?e.substring(e.length-n,e.length-t):e.substring(t,n),uriEncode:e=>encodeURIComponent(e).replace(/[!*'()]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},yT=(e,t)=>{const n=[],r={...t.endpointParams,...t.referenceRecord};let s=0;for(;s<e.length;){const t=e.indexOf("{",s);if(-1===t){n.push(e.slice(s));break}n.push(e.slice(s,t));const i=e.indexOf("}",t);if(-1===i){n.push(e.slice(t));break}"{"===e[t+1]&&"}"===e[i+1]&&(n.push(e.slice(t+1,i)),s=i+2);const a=e.substring(t+1,i);if(a.includes("#")){const[e,t]=a.split("#");n.push(pT(r[e],t))}else n.push(r[a]);s=i+1}return n.join("")},vT=(e,t,n)=>{if("string"==typeof e)return yT(e,n);if(e.fn)return bT(e,n);if(e.ref)return(({ref:e},t)=>({...t.endpointParams,...t.referenceRecord}[e]))(e,n);throw new hT(`'${t}': ${String(e)} is not a string, function or reference.`)},bT=({fn:e,argv:t},n)=>{const r=t.map((e=>["boolean","number"].includes(typeof e)?e:vT(e,"arg",n))),s=e.split(".");return s[0]in cT&&null!=s[1]?cT[s[0]][s[1]](...r):fT[e](...r)},CT=({assign:e,...t},n)=>{if(e&&e in n.referenceRecord)throw new hT(`'${e}' is already defined in Reference Record.`);const r=bT(t,n);return n.logger?.debug?.(`${uT} evaluateCondition: ${dT(t)} = ${dT(r)}`),{result:""===r||!!r,...null!=e&&{toAssign:{name:e,value:r}}}},wT=(e=[],t)=>{const n={};for(const r of e){const{result:e,toAssign:s}=CT(r,{...t,referenceRecord:{...t.referenceRecord,...n}});if(!e)return{result:e};s&&(n[s.name]=s.value,t.logger?.debug?.(`${uT} assign: ${s.name} := ${dT(s.value)}`))}return{result:!0,referenceRecord:n}},ST=(e,t)=>Object.entries(e).reduce(((e,[n,r])=>({...e,[n]:r.map((e=>{const r=vT(e,"Header value entry",t);if("string"!=typeof r)throw new hT(`Header '${n}' value '${r}' is not a string`);return r}))})),{}),ET=(e,t)=>{if(Array.isArray(e))return e.map((e=>ET(e,t)));switch(typeof e){case"string":return yT(e,t);case"object":if(null===e)throw new hT(`Unexpected endpoint property: ${e}`);return xT(e,t);case"boolean":return e;default:throw new hT("Unexpected endpoint property type: "+typeof e)}},xT=(e,t)=>Object.entries(e).reduce(((e,[n,r])=>({...e,[n]:ET(r,t)})),{});var IT=n(58651);const AT=(e,t)=>{const n=vT(e,"Endpoint URL",t);if("string"==typeof n)try{return new URL(n)}catch(e){throw IT.error(`Failed to construct URL with ${n}`,e),e}throw new hT("Endpoint URL must be a string, got "+typeof n)},PT=(e,t)=>{const{conditions:n,endpoint:r}=e,{result:s,referenceRecord:i}=wT(n,t);if(!s)return;const a={...t,referenceRecord:{...t.referenceRecord,...i}},{url:o,properties:l,headers:c}=r;return t.logger?.debug?.(`${uT} Resolving endpoint from template: ${dT(r)}`),{...null!=c&&{headers:ST(c,a)},...null!=l&&{properties:xT(l,a)},url:AT(o,a)}},kT=(e,t)=>{const{conditions:n,error:r}=e,{result:s,referenceRecord:i}=wT(n,t);if(s)throw new hT(vT(r,"Error",{...t,referenceRecord:{...t.referenceRecord,...i}}))},TT=(e,t)=>{const{conditions:n,rules:r}=e,{result:s,referenceRecord:i}=wT(n,t);if(s)return DT(r,{...t,referenceRecord:{...t.referenceRecord,...i}})},DT=(e,t)=>{for(const n of e)if("endpoint"===n.type){const e=PT(n,t);if(e)return e}else if("error"===n.type)kT(n,t);else{if("tree"!==n.type)throw new hT(`Unknown endpoint rule: ${n}`);{const e=TT(n,t);if(e)return e}}throw new hT("Rules evaluation failed")},MT=(e,t=!1)=>{if(t){for(const t of e.split("."))if(!MT(t))return!1;return!0}return!!lT(e)&&(!(e.length<3||e.length>63)&&(e===e.toLowerCase()&&!aT(e)))};let LT=JSON.parse('{"partitions":[{"id":"aws","outputs":{"dnsSuffix":"amazonaws.com","dualStackDnsSuffix":"api.aws","implicitGlobalRegion":"us-east-1","name":"aws","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^(us|eu|ap|sa|ca|me|af|il|mx)\\\\-\\\\w+\\\\-\\\\d+$","regions":{"af-south-1":{"description":"Africa (Cape Town)"},"ap-east-1":{"description":"Asia Pacific (Hong Kong)"},"ap-east-2":{"description":"Asia Pacific (Taipei)"},"ap-northeast-1":{"description":"Asia Pacific (Tokyo)"},"ap-northeast-2":{"description":"Asia Pacific (Seoul)"},"ap-northeast-3":{"description":"Asia Pacific (Osaka)"},"ap-south-1":{"description":"Asia Pacific (Mumbai)"},"ap-south-2":{"description":"Asia Pacific (Hyderabad)"},"ap-southeast-1":{"description":"Asia Pacific (Singapore)"},"ap-southeast-2":{"description":"Asia Pacific (Sydney)"},"ap-southeast-3":{"description":"Asia Pacific (Jakarta)"},"ap-southeast-4":{"description":"Asia Pacific (Melbourne)"},"ap-southeast-5":{"description":"Asia Pacific (Malaysia)"},"ap-southeast-7":{"description":"Asia Pacific (Thailand)"},"aws-global":{"description":"AWS Standard global region"},"ca-central-1":{"description":"Canada (Central)"},"ca-west-1":{"description":"Canada West (Calgary)"},"eu-central-1":{"description":"Europe (Frankfurt)"},"eu-central-2":{"description":"Europe (Zurich)"},"eu-north-1":{"description":"Europe (Stockholm)"},"eu-south-1":{"description":"Europe (Milan)"},"eu-south-2":{"description":"Europe (Spain)"},"eu-west-1":{"description":"Europe (Ireland)"},"eu-west-2":{"description":"Europe (London)"},"eu-west-3":{"description":"Europe (Paris)"},"il-central-1":{"description":"Israel (Tel Aviv)"},"me-central-1":{"description":"Middle East (UAE)"},"me-south-1":{"description":"Middle East (Bahrain)"},"mx-central-1":{"description":"Mexico (Central)"},"sa-east-1":{"description":"South America (Sao Paulo)"},"us-east-1":{"description":"US East (N. Virginia)"},"us-east-2":{"description":"US East (Ohio)"},"us-west-1":{"description":"US West (N. California)"},"us-west-2":{"description":"US West (Oregon)"}}},{"id":"aws-cn","outputs":{"dnsSuffix":"amazonaws.com.cn","dualStackDnsSuffix":"api.amazonwebservices.com.cn","implicitGlobalRegion":"cn-northwest-1","name":"aws-cn","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^cn\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-cn-global":{"description":"AWS China global region"},"cn-north-1":{"description":"China (Beijing)"},"cn-northwest-1":{"description":"China (Ningxia)"}}},{"id":"aws-us-gov","outputs":{"dnsSuffix":"amazonaws.com","dualStackDnsSuffix":"api.aws","implicitGlobalRegion":"us-gov-west-1","name":"aws-us-gov","supportsDualStack":true,"supportsFIPS":true},"regionRegex":"^us\\\\-gov\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-us-gov-global":{"description":"AWS GovCloud (US) global region"},"us-gov-east-1":{"description":"AWS GovCloud (US-East)"},"us-gov-west-1":{"description":"AWS GovCloud (US-West)"}}},{"id":"aws-iso","outputs":{"dnsSuffix":"c2s.ic.gov","dualStackDnsSuffix":"c2s.ic.gov","implicitGlobalRegion":"us-iso-east-1","name":"aws-iso","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^us\\\\-iso\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-global":{"description":"AWS ISO (US) global region"},"us-iso-east-1":{"description":"US ISO East"},"us-iso-west-1":{"description":"US ISO WEST"}}},{"id":"aws-iso-b","outputs":{"dnsSuffix":"sc2s.sgov.gov","dualStackDnsSuffix":"sc2s.sgov.gov","implicitGlobalRegion":"us-isob-east-1","name":"aws-iso-b","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^us\\\\-isob\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-b-global":{"description":"AWS ISOB (US) global region"},"us-isob-east-1":{"description":"US ISOB East (Ohio)"}}},{"id":"aws-iso-e","outputs":{"dnsSuffix":"cloud.adc-e.uk","dualStackDnsSuffix":"cloud.adc-e.uk","implicitGlobalRegion":"eu-isoe-west-1","name":"aws-iso-e","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^eu\\\\-isoe\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-e-global":{"description":"AWS ISOE (Europe) global region"},"eu-isoe-west-1":{"description":"EU ISOE West"}}},{"id":"aws-iso-f","outputs":{"dnsSuffix":"csp.hci.ic.gov","dualStackDnsSuffix":"csp.hci.ic.gov","implicitGlobalRegion":"us-isof-south-1","name":"aws-iso-f","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^us\\\\-isof\\\\-\\\\w+\\\\-\\\\d+$","regions":{"aws-iso-f-global":{"description":"AWS ISOF global region"},"us-isof-east-1":{"description":"US ISOF EAST"},"us-isof-south-1":{"description":"US ISOF SOUTH"}}},{"id":"aws-eusc","outputs":{"dnsSuffix":"amazonaws.eu","dualStackDnsSuffix":"amazonaws.eu","implicitGlobalRegion":"eusc-de-east-1","name":"aws-eusc","supportsDualStack":false,"supportsFIPS":true},"regionRegex":"^eusc\\\\-(de)\\\\-\\\\w+\\\\-\\\\d+$","regions":{"eusc-de-east-1":{"description":"EU (Germany)"}}}],"version":"1.1"}'),RT="";const NT={isVirtualHostableS3Bucket:MT,parseArn:e=>{const t=e.split(":");if(t.length<6)return null;const[n,r,s,i,a,...o]=t;if("arn"!==n||""===r||""===s||""===o.join(":"))return null;return{partition:r,service:s,region:i,accountId:a,resourceId:o.map((e=>e.split("/"))).flat()}},partition:e=>{const{partitions:t}=LT;for(const n of t){const{regions:t,outputs:r}=n;for(const[n,s]of Object.entries(t))if(n===e)return{...r,...s}}for(const n of t){const{regionRegex:t,outputs:r}=n;if(new RegExp(t).test(e))return{...r}}const n=t.find((e=>"aws"===e.id));if(!n)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...n.outputs}}};function OT(e,t,n){e.__aws_sdk_context?e.__aws_sdk_context.features||(e.__aws_sdk_context.features={}):e.__aws_sdk_context={features:{}},e.__aws_sdk_context.features[t]=n}cT.aws=NT;const _T=/\d{12}\.ddb/;const BT="user-agent",FT="x-amz-user-agent",UT=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,HT=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g;const zT=e=>(t,n)=>async r=>{const{request:s}=r;if(!GP.isInstance(s))return t(r);const{headers:i}=s,a=n?.userAgent?.map(jT)||[],o=(await e.defaultUserAgentProvider()).map(jT);await async function(e,t,n){const r=n.request;if("rpc-v2-cbor"===r?.headers?.["smithy-protocol"]&&OT(e,"PROTOCOL_RPC_V2_CBOR","M"),"function"==typeof t.retryStrategy){const n=await t.retryStrategy();"function"==typeof n.acquireInitialRetryToken?n.constructor?.name?.includes("Adaptive")?OT(e,"RETRY_MODE_ADAPTIVE","F"):OT(e,"RETRY_MODE_STANDARD","E"):OT(e,"RETRY_MODE_LEGACY","D")}if("function"==typeof t.accountIdEndpointMode){const n=e.endpointV2;switch(String(n?.url?.hostname).match(_T)&&OT(e,"ACCOUNT_ID_ENDPOINT","O"),await(t.accountIdEndpointMode?.())){case"disabled":OT(e,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":OT(e,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":OT(e,"ACCOUNT_ID_MODE_REQUIRED","R")}}const s=e.__smithy_context?.selectedHttpAuthScheme?.identity;if(s?.$source){const t=s;t.accountId&&OT(e,"RESOLVED_ACCOUNT_ID","T");for(const[n,r]of Object.entries(t.$source??{}))OT(e,n,r)}}(n,e,r);const l=n;o.push(`m/${function(e){let t="";for(const n in e){const r=e[n];if(!(t.length+r.length+1<=1024))break;t.length?t+=","+r:t+=r}return t}(Object.assign({},n.__smithy_context?.features,l.__aws_sdk_context?.features))}`);const c=e?.customUserAgent?.map(jT)||[],u=await e.userAgentAppId();u&&o.push(jT([`app/${u}`]));const d=(RT?[RT]:[]).concat([...o,...a,...c]).join(" "),h=[...o.filter((e=>e.startsWith("aws-sdk-"))),...c].join(" ");return"browser"!==e.runtime?(h&&(i[FT]=i[FT]?`${i[BT]} ${h}`:h),i[BT]=d):i[FT]=d,t({...r,request:s})},jT=e=>{const t=e[0].split("/").map((e=>e.replace(UT,"-"))).join("/"),n=e[1]?.replace(HT,"-"),r=t.indexOf("/"),s=t.substring(0,r);let i=t.substring(r+1);return"api"===s&&(i=i.toLowerCase()),[s,i,n].filter((e=>e&&e.length>0)).reduce(((e,t,n)=>{switch(n){case 0:return t;case 1:return`${e}/${t}`;default:return`${e}#${t}`}}),"")},VT={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0};var qT=n(37542).Buffer,WT=void 0!==qT&&qT.from?function(e){return qT.from(e,"utf8")}:e=>(new TextEncoder).encode(e);function QT(e){return e instanceof Uint8Array?e:"string"==typeof e?WT(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}function GT(e){return"string"==typeof e?0===e.length:0===e.byteLength}!function(){function e(){this.crc32=new YT}e.prototype.update=function(e){GT(e)||this.crc32.update(QT(e))},e.prototype.digest=function(){return(0,y.__awaiter)(this,void 0,void 0,(function(){return(0,y.__generator)(this,(function(e){return[2,(t=this.crc32.digest(),new Uint8Array([(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))];var t}))}))},e.prototype.reset=function(){this.crc32=new YT}}();var ZT,YT=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,n;try{for(var r=(0,y.__values)(e),s=r.next();!s.done;s=r.next()){var i=s.value;this.checksum=this.checksum>>>8^KT[255&(this.checksum^i)]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}(),KT=function(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),n=0;n<e.length;)t[n]=e[n],n+=1;return t}return Uint32Array.from(e)}([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);class JT{constructor(e){if(this.bytes=e,8!==e.byteLength)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>0x8000000000000000||e<-0x8000000000000000)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let n=7,r=Math.abs(Math.round(e));n>-1&&r>0;n--,r/=256)t[n]=r;return e<0&&XT(t),new JT(t)}valueOf(){const e=this.bytes.slice(0),t=128&e[0];return t&&XT(e),parseInt(Nk(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function XT(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,0===e[t]);t--);}class $T{constructor(e,t){this.toUtf8=e,this.fromUtf8=t}format(e){const t=[];for(const n of Object.keys(e)){const r=this.fromUtf8(n);t.push(Uint8Array.from([r.byteLength]),r,this.formatHeaderValue(e[n]))}const n=new Uint8Array(t.reduce(((e,t)=>e+t.byteLength),0));let r=0;for(const e of t)n.set(e,r),r+=e.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":const s=new DataView(new ArrayBuffer(3+e.value.byteLength));s.setUint8(0,6),s.setUint16(1,e.value.byteLength,!1);const i=new Uint8Array(s.buffer);return i.set(e.value,3),i;case"string":const a=this.fromUtf8(e.value),o=new DataView(new ArrayBuffer(3+a.byteLength));o.setUint8(0,7),o.setUint16(1,a.byteLength,!1);const l=new Uint8Array(o.buffer);return l.set(a,3),l;case"timestamp":const c=new Uint8Array(9);return c[0]=8,c.set(JT.fromNumber(e.value.valueOf()).bytes,1),c;case"uuid":if(!cD.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const u=new Uint8Array(17);return u[0]=9,u.set(Rk(e.value.replace(/\-/g,"")),1),u}}parse(e){const t={};let n=0;for(;n<e.byteLength;){const r=e.getUint8(n++),s=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,r));switch(n+=r,e.getUint8(n++)){case 0:t[s]={type:eD,value:!0};break;case 1:t[s]={type:eD,value:!1};break;case 2:t[s]={type:tD,value:e.getInt8(n++)};break;case 3:t[s]={type:nD,value:e.getInt16(n,!1)},n+=2;break;case 4:t[s]={type:rD,value:e.getInt32(n,!1)},n+=4;break;case 5:t[s]={type:sD,value:new JT(new Uint8Array(e.buffer,e.byteOffset+n,8))},n+=8;break;case 6:const r=e.getUint16(n,!1);n+=2,t[s]={type:iD,value:new Uint8Array(e.buffer,e.byteOffset+n,r)},n+=r;break;case 7:const i=e.getUint16(n,!1);n+=2,t[s]={type:aD,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,i))},n+=i;break;case 8:t[s]={type:oD,value:new Date(new JT(new Uint8Array(e.buffer,e.byteOffset+n,8)).valueOf())},n+=8;break;case 9:const a=new Uint8Array(e.buffer,e.byteOffset+n,16);n+=16,t[s]={type:lD,value:`${Nk(a.subarray(0,4))}-${Nk(a.subarray(4,6))}-${Nk(a.subarray(6,8))}-${Nk(a.subarray(8,10))}-${Nk(a.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return t}}!function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(ZT||(ZT={}));const eD="boolean",tD="byte",nD="short",rD="integer",sD="long",iD="binary",aD="string",oD="timestamp",lD="uuid",cD=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class uD{constructor(e,t){this.headerMarshaller=new $T(e,t),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),t=this.isEndOfStream;return{getMessage:()=>e,isEndOfStream:()=>t}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const t=this.isEndOfStream;return{getMessages:()=>e,isEndOfStream:()=>t}}encode({headers:e,body:t}){const n=this.headerMarshaller.format(e),r=n.byteLength+t.byteLength+16,s=new Uint8Array(r),i=new DataView(s.buffer,s.byteOffset,s.byteLength),a=new YT;return i.setUint32(0,r,!1),i.setUint32(4,n.byteLength,!1),i.setUint32(8,a.update(s.subarray(0,8)).digest(),!1),s.set(n,12),s.set(t,n.byteLength+12),i.setUint32(r-4,a.update(s.subarray(8,r-4)).digest(),!1),s}decode(e){const{headers:t,body:n}=function({byteLength:e,byteOffset:t,buffer:n}){if(e<16)throw new Error("Provided message too short to accommodate event stream message overhead");const r=new DataView(n,t,e),s=r.getUint32(0,!1);if(e!==s)throw new Error("Reported message length does not match received message length");const i=r.getUint32(4,!1),a=r.getUint32(8,!1),o=r.getUint32(e-4,!1),l=(new YT).update(new Uint8Array(n,t,8));if(a!==l.digest())throw new Error(`The prelude checksum specified in the message (${a}) does not match the calculated CRC32 checksum (${l.digest()})`);if(l.update(new Uint8Array(n,t+8,e-12)),o!==l.digest())throw new Error(`The message checksum (${l.digest()}) did not match the expected value of ${o}`);return{headers:new DataView(n,t+8+4,i),body:new Uint8Array(n,t+8+4+i,s-i-16)}}(e);return{headers:this.headerMarshaller.parse(t),body:n}}formatHeaders(e){return this.headerMarshaller.format(e)}}class dD{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream){const t=this.options.decoder.decode(e);yield t}}}class hD{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const t=this.options.encoder.encode(e);yield t}this.options.includeEndFrame&&(yield new Uint8Array(0))}}class pD{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const t=await this.options.deserializer(e);void 0!==t&&(yield t)}}}class gD{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream){const t=this.options.serializer(e);yield t}}}class mD{messageSigner;eventStreamCodec;systemClockOffsetProvider;constructor(e){this.messageSigner=e.messageSigner,this.eventStreamCodec=new uD(e.utf8Encoder,e.utf8Decoder),this.systemClockOffsetProvider=async()=>e.systemClockOffset??0}async handle(e,t,n={}){const r=t.request,{body:s,headers:i,query:a}=r;if(!(s instanceof ReadableStream))throw new Error("Eventstream payload must be a ReadableStream.");const o=new TransformStream;let l;r.body=o.readable;try{l=await e(t)}catch(e){throw r.body.cancel(),e}const c=((e,t,n,r)=>{let s=e;const i={start(){},async transform(e,i){try{const a=new Date(Date.now()+await r()),o={":date":{type:"timestamp",value:a}},l=await t.sign({message:{body:e,headers:o},priorSignature:s},{signingDate:a});s=l.signature;const c=n.encode({headers:{...o,":chunk-signature":{type:"binary",value:Rk(l.signature)}},body:e});i.enqueue(c)}catch(e){i.error(e)}}};return new TransformStream({...i})})(((i.authorization||"").match(/Signature=([\w]+)$/)||[])[1]||a&&a["X-Amz-Signature"]||"",await this.messageSigner(),this.eventStreamCodec,this.systemClockOffsetProvider);return s.pipeThrough(c).pipeThrough(o),l}}const fD=e=>new mD(e),yD=e=>"ws:"===e.protocol||"wss:"===e.protocol;class vD{signer;constructor(e){this.signer=e.signer}presign(e,t={}){return this.signer.presign(e,t)}async sign(e,t){if(GP.isInstance(e)&&yD(e)){return{...await this.signer.presign({...e,body:""},{...t,expiresIn:60,unsignableHeaders:new Set(Object.keys(e.headers).filter((e=>"host"!==e)))}),body:e.body}}return this.signer.sign(e,t)}}const bD=e=>!!e;function CD(e,t){return async function(n){const{value:r}=n.headers[":message-type"];if("error"===r){const e=new Error(n.headers[":error-message"].value||"UnknownError");throw e.name=n.headers[":error-code"].value,e}if("exception"===r){const r=n.headers[":exception-type"].value,s={[r]:n},i=await e(s);if(i.$unknown){const e=new Error(t(n.body));throw e.name=r,e}throw i[r]}if("event"===r){const t={[n.headers[":event-type"].value]:n},r=await e(t);if(r.$unknown)return;return r}throw Error(`Unrecognizable event type: ${n.headers[":event-type"].value}`)}}class wD{constructor({utf8Encoder:e,utf8Decoder:t}){this.eventStreamCodec=new uD(e,t),this.utfEncoder=e}deserialize(e,t){const n=function(e){let t=0,n=0,r=null,s=null;const i=e=>{if("number"!=typeof e)throw new Error("Attempted to allocate an event message where size was not a number: "+e);t=e,n=4,r=new Uint8Array(e),new DataView(r.buffer).setUint32(0,e,!1)};return{[Symbol.asyncIterator]:async function*(){const a=e[Symbol.asyncIterator]();for(;;){const{value:e,done:o}=await a.next();if(o){if(!t)return;if(t!==n)throw new Error("Truncated event message received.");return void(yield r)}const l=e.length;let c=0;for(;c<l;){if(!r){const t=l-c;s||(s=new Uint8Array(4));const r=Math.min(4-n,t);if(s.set(e.slice(c,c+r),n),n+=r,c+=r,n<4)break;i(new DataView(s.buffer).getUint32(0,!1)),s=null}const a=Math.min(t-n,l-c);r.set(e.slice(c,c+a),n),n+=a,c+=a,t&&t===n&&(yield r,r=null,t=0,n=0)}}}}}(e);return new pD({messageStream:new dD({inputStream:n,decoder:this.eventStreamCodec}),deserializer:CD(t,this.utfEncoder)})}serialize(e,t){return new hD({messageStream:new gD({inputStream:e,serializer:t}),encoder:this.eventStreamCodec,includeEndFrame:!0})}}const SD=e=>({[Symbol.asyncIterator]:async function*(){const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)return;yield n}}finally{t.releaseLock()}}}),ED=e=>{const t=e[Symbol.asyncIterator]();return new ReadableStream({async pull(e){const{done:n,value:r}=await t.next();if(n)return e.close();e.enqueue(r)}})};class xD{constructor({utf8Encoder:e,utf8Decoder:t}){this.universalMarshaller=new wD({utf8Decoder:t,utf8Encoder:e})}deserialize(e,t){const n=ID(e)?SD(e):e;return this.universalMarshaller.deserialize(n,t)}serialize(e,t){const n=this.universalMarshaller.serialize(e,t);return"function"==typeof ReadableStream?ED(n):n}}const ID=e=>"function"==typeof ReadableStream&&e instanceof ReadableStream,AD=e=>new xD(e),PD=2e3;class kD{metadata={handlerProtocol:"websocket/h1.1"};config;configPromise;httpHandler;sockets={};static create(e,t=new Tk){return"function"==typeof e?.handle?e:new kD(e,t)}constructor(e,t=new Tk){this.httpHandler=t,"function"==typeof e?(this.config={},this.configPromise=e().then((e=>this.config=e??{}))):(this.config=e??{},this.configPromise=Promise.resolve(this.config))}destroy(){for(const[e,t]of Object.entries(this.sockets)){for(const e of t)e.close(1e3,"Socket closed through destroy() call");delete this.sockets[e]}}async handle(e){if(!yD(e))return this.httpHandler.handle(e);const t=function(e){const{port:t,query:n}=e;let{protocol:r,path:s,hostname:i}=e;r&&":"!==r.slice(-1)&&(r+=":"),t&&(i+=`:${t}`),s&&"/"!==s.charAt(0)&&(s=`/${s}`);let a=n?Ik(n):"";a&&"?"!==a[0]&&(a=`?${a}`);let o="";null==e.username&&null==e.password||(o=`${e.username??""}:${e.password??""}@`);let l="";return e.fragment&&(l=`#${e.fragment}`),`${r}//${o}${i}${s}${a}${l}`}(e),n=new WebSocket(t);this.sockets[t]||(this.sockets[t]=[]),this.sockets[t].push(n),n.binaryType="arraybuffer",this.config=await this.configPromise;const{connectionTimeout:r=PD}=this.config;await this.waitForReady(n,r);const{body:s}=e,i=TD(s),a=this.connect(n,i),o=DD(a);return{response:new ZP({statusCode:200,body:o})}}updateHttpClientConfig(e,t){this.configPromise=this.configPromise.then((n=>(n[e]=t,n)))}httpHandlerConfigs(){return this.config??{}}removeNotUsableSockets(e){this.sockets[e]=(this.sockets[e]??[]).filter((e=>![WebSocket.CLOSING,WebSocket.CLOSED].includes(e.readyState)))}waitForReady(e,t){return new Promise(((n,r)=>{const s=setTimeout((()=>{this.removeNotUsableSockets(e.url),r({$metadata:{httpStatusCode:500}})}),t);e.onopen=()=>{clearTimeout(s),n()}}))}connect(e,t){let n,r=!1,s=()=>{},i=()=>{};e.onmessage=e=>{i({done:!1,value:new Uint8Array(e.data)})},e.onerror=t=>{r=!0,e.close(),s(t)},e.onclose=()=>{this.removeNotUsableSockets(e.url),r||(n?s(n):i({done:!0,value:void 0}))};const a={[Symbol.asyncIterator]:()=>({next:()=>new Promise(((e,t)=>{i=e,s=t}))})};return(async()=>{try{for await(const n of t)e.send(n)}catch(e){n=e}finally{e.close(1e3)}})(),a}}const TD=e=>e[Symbol.asyncIterator]?e:MD(e)?SD(e):{[Symbol.asyncIterator]:async function*(){yield e}},DD=e=>"function"==typeof ReadableStream?ED(e):e,MD=e=>"function"==typeof ReadableStream&&e instanceof ReadableStream;var LD;!function(e){e.ENV="env",e.CONFIG="shared config entry"}(LD||(LD={}));const RD=e=>"string"==typeof e&&(e.startsWith("fips-")||e.endsWith("-fips")),ND=e=>RD(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e,OD="content-length";const _D={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},BD=e=>({applyToStack:t=>{var n;t.add((n=e.bodyLengthChecker,e=>async t=>{const r=t.request;if(GP.isInstance(r)){const{body:e,headers:t}=r;if(e&&-1===Object.keys(t).map((e=>e.toLowerCase())).indexOf(OD))try{const t=n(e);r.headers={...r.headers,[OD]:String(t)}}catch(e){}}return e({...t,request:r})}),_D)}}),FD=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,UD=/(\d+\.){3}\d+/,HD=/\.\./,zD=e=>FD.test(e)&&!UD.test(e)&&!HD.test(e),jD=e=>{const[t,n,r,,,s]=e.split(":"),i="arn"===t&&e.split(":").length>=6,a=Boolean(i&&n&&r&&s);if(i&&!a)throw new Error(`Invalid ARN: ${e} was an invalid ARN.`);return a},VD=(e,t,n)=>{const r=async()=>{const r=n[e]??n[t];return"function"==typeof r?r():r};return"credentialScope"===e||"CredentialScope"===t?async()=>{const e="function"==typeof n.credentials?await n.credentials():n.credentials;return e?.credentialScope??e?.CredentialScope}:"accountId"===e||"AccountId"===t?async()=>{const e="function"==typeof n.credentials?await n.credentials():n.credentials;return e?.accountId??e?.AccountId}:"endpoint"===e||"endpoint"===t?async()=>{const e=await r();if(e&&"object"==typeof e){if("url"in e)return e.url.href;if("hostname"in e){const{protocol:t,hostname:n,port:r,path:s}=e;return`${t}//${n}${r?":"+r:""}${s}`}}return e}:r},qD=async e=>{};const WD=e=>{if("string"==typeof e)return WD(new URL(e));const{hostname:t,pathname:n,port:r,protocol:s,search:i}=e;let a;return i&&(a=function(e){const t={};if(e=e.replace(/^\?/,""))for(const n of e.split("&")){let[e,r=null]=n.split("=");e=decodeURIComponent(e),r&&(r=decodeURIComponent(r)),e in t?Array.isArray(t[e])?t[e].push(r):t[e]=[t[e],r]:t[e]=r}return t}(i)),{hostname:t,port:r?parseInt(r):void 0,protocol:s,path:n,query:a}},QD=e=>"object"==typeof e?"url"in e?WD(e.url):e:WD(e),GD=async(e,t,n)=>{const r={},s=t?.getEndpointParameterInstructions?.()||{};for(const[t,i]of Object.entries(s))switch(i.type){case"staticContextParams":r[t]=i.value;break;case"contextParams":r[t]=e[i.name];break;case"clientContextParams":case"builtInParams":r[t]=await VD(i.name,t,n)();break;case"operationContextParams":r[t]=i.get(e);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(i))}return 0===Object.keys(s).length&&Object.assign(r,n),"s3"===String(n.serviceId).toLowerCase()&&await(async e=>{const t=e?.Bucket||"";if("string"==typeof e.Bucket&&(e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),jD(t)){if(!0===e.ForcePathStyle)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!zD(t)||-1!==t.indexOf(".")&&!String(e.Endpoint).startsWith("http:")||t.toLowerCase()!==t||t.length<3)&&(e.ForcePathStyle=!0);return e.DisableMultiRegionAccessPoints&&(e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0),e})(r),r},ZD=({config:e,instructions:t})=>(n,r)=>async s=>{e.endpoint&&function(e,t,n){e.__smithy_context?e.__smithy_context.features||(e.__smithy_context.features={}):e.__smithy_context={features:{}},e.__smithy_context.features[t]=n}(r,"ENDPOINT_OVERRIDE","N");const i=await(async(e,t,n,r)=>{if(!n.endpoint){let e;e=n.serviceConfiguredEndpoint?await n.serviceConfiguredEndpoint():await qD(n.serviceId),e&&(n.endpoint=()=>Promise.resolve(QD(e)))}const s=await GD(e,t,n);if("function"!=typeof n.endpointProvider)throw new Error("config.endpointProvider is not set.");return n.endpointProvider(s,r)})(s.input,{getEndpointParameterInstructions:()=>t},{...e},r);r.endpointV2=i,r.authSchemes=i.properties?.authSchemes;const a=r.authSchemes?.[0];if(a){r.signing_region=a.signingRegion,r.signing_service=a.signingName;const e=nk(r),t=e?.selectedHttpAuthScheme?.httpAuthOption;t&&(t.signingProperties=Object.assign(t.signingProperties||{},{signing_region:a.signingRegion,signingRegion:a.signingRegion,signing_service:a.signingName,signingName:a.signingName,signingRegionSet:a.signingRegionSet},a.properties))}return n({...s})},YD={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:ck.name},KD=(e,t)=>({applyToStack:n=>{n.addRelativeTo(ZD({config:e,instructions:t}),YD)}});var JD;!function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"}(JD||(JD={}));const XD=JD.STANDARD,$D=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],eM=["TimeoutError","RequestTimeout","RequestTimeoutException"],tM=[500,502,503,504],nM=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],rM=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"],sM=e=>429===e.$metadata?.httpStatusCode||$D.includes(e.name)||1==e.$retryable?.throttling,iM=(e,t=0)=>(e=>e.$metadata?.clockSkewCorrected)(e)||eM.includes(e.name)||nM.includes(e?.code||"")||rM.includes(e?.code||"")||tM.includes(e.$metadata?.httpStatusCode||0)||(e=>{const t=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);return!!(e&&e instanceof TypeError)&&t.has(e.message)})(e)||void 0!==e.cause&&t<=10&&iM(e.cause,t+1);class aM{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=e?.beta??.7,this.minCapacity=e?.minCapacity??1,this.minFillRate=e?.minFillRate??.5,this.scaleConstant=e?.scaleConstant??.4,this.smooth=e?.smooth??.8;const t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const t=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise((e=>aM.setTimeoutFn(e,t)))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp)return void(this.lastTimestamp=e);const t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),sM(e)){const e=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=e,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(e),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),t=Math.floor(2*e)/2;if(this.requestCount++,t>this.lastTxRateBucket){const e=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(e*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}}getPrecise(e){return parseFloat(e.toFixed(8))}}aM.setTimeoutFn=setTimeout;const oM=100,lM=2e4,cM="amz-sdk-invocation-id",uM="amz-sdk-request",dM=({retryDelay:e,retryCount:t,retryCost:n})=>({getRetryCount:()=>t,getRetryDelay:()=>Math.min(lM,e),getRetryCost:()=>n});var hM=n(58651);class pM{constructor(e){this.maxAttempts=e,this.mode=JD.STANDARD,this.capacity=500,this.retryBackoffStrategy=(()=>{let e=oM;return{computeNextBackoffDelay:t=>Math.floor(Math.min(lM,Math.random()*2**t*e)),setDelayBase:t=>{e=t}}})(),this.maxAttemptsProvider="function"==typeof e?e:async()=>e}async acquireInitialRetryToken(e){return dM({retryDelay:oM,retryCount:0})}async refreshRetryTokenForRetry(e,t){const n=await this.getMaxAttempts();if(this.shouldRetry(e,t,n)){const n=t.errorType;this.retryBackoffStrategy.setDelayBase("THROTTLING"===n?500:oM);const r=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),s=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,r):r,i=this.getCapacityCost(n);return this.capacity-=i,dM({retryDelay:s,retryCount:e.getRetryCount()+1,retryCost:i})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(500,this.capacity+(e.getRetryCost()??1))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch(e){return hM.warn("Max attempts provider could not resolve. Using default of 3"),3}}shouldRetry(e,t,n){return e.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return"TRANSIENT"===e?10:5}isRetryableError(e){return"THROTTLING"===e||"TRANSIENT"===e}}class gM{constructor(e,t){this.maxAttemptsProvider=e,this.mode=JD.ADAPTIVE;const{rateLimiter:n}=t??{};this.rateLimiter=n??new aM,this.standardRetryStrategy=new pM(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}const mM=e=>e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):"string"==typeof e?new Error(e):new Error(`AWS SDK error wrapper for ${e}`);var fM=n(58651);const yM=(e,t)=>{const n=[];if(e&&n.push(e),t)for(const e of t)n.push(e);return n},vM=(e,t)=>`${e||"anonymous"}${t&&t.length>0?` (a.k.a. ${t.join(",")})`:""}`,bM=()=>{let e=[],t=[],n=!1;const r=new Set,s=n=>(e.forEach((e=>{n.add(e.middleware,{...e})})),t.forEach((e=>{n.addRelativeTo(e.middleware,{...e})})),n.identifyOnResolve?.(o.identifyOnResolve()),n),i=e=>{const t=[];return e.before.forEach((e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...i(e))})),t.push(e),e.after.reverse().forEach((e=>{0===e.before.length&&0===e.after.length?t.push(e):t.push(...i(e))})),t},a=(n=!1)=>{const r=[],s=[],a={};e.forEach((e=>{const t={...e,before:[],after:[]};for(const e of yM(t.name,t.aliases))a[e]=t;r.push(t)})),t.forEach((e=>{const t={...e,before:[],after:[]};for(const e of yM(t.name,t.aliases))a[e]=t;s.push(t)})),s.forEach((e=>{if(e.toMiddleware){const t=a[e.toMiddleware];if(void 0===t){if(n)return;throw new Error(`${e.toMiddleware} is not found when adding ${vM(e.name,e.aliases)} middleware ${e.relation} ${e.toMiddleware}`)}"after"===e.relation&&t.after.push(e),"before"===e.relation&&t.before.push(e)}}));const o=(l=r,l.sort(((e,t)=>CM[t.step]-CM[e.step]||wM[t.priority||"normal"]-wM[e.priority||"normal"]))).map(i).reduce(((e,t)=>(e.push(...t),e)),[]);var l;return o},o={add:(t,n={})=>{const{name:s,override:i,aliases:a}=n,o={step:"initialize",priority:"normal",middleware:t,...n},l=yM(s,a);if(l.length>0){if(l.some((e=>r.has(e)))){if(!i)throw new Error(`Duplicate middleware name '${vM(s,a)}'`);for(const t of l){const n=e.findIndex((e=>e.name===t||e.aliases?.some((e=>e===t))));if(-1===n)continue;const r=e[n];if(r.step!==o.step||o.priority!==r.priority)throw new Error(`"${vM(r.name,r.aliases)}" middleware with ${r.priority} priority in ${r.step} step cannot be overridden by "${vM(s,a)}" middleware with ${o.priority} priority in ${o.step} step.`);e.splice(n,1)}}for(const e of l)r.add(e)}e.push(o)},addRelativeTo:(e,n)=>{const{name:s,override:i,aliases:a}=n,o={middleware:e,...n},l=yM(s,a);if(l.length>0){if(l.some((e=>r.has(e)))){if(!i)throw new Error(`Duplicate middleware name '${vM(s,a)}'`);for(const e of l){const n=t.findIndex((t=>t.name===e||t.aliases?.some((t=>t===e))));if(-1===n)continue;const r=t[n];if(r.toMiddleware!==o.toMiddleware||r.relation!==o.relation)throw new Error(`"${vM(r.name,r.aliases)}" middleware ${r.relation} "${r.toMiddleware}" middleware cannot be overridden by "${vM(s,a)}" middleware ${o.relation} "${o.toMiddleware}" middleware.`);t.splice(n,1)}}for(const e of l)r.add(e)}t.push(o)},clone:()=>s(bM()),use:e=>{e.applyToStack(o)},remove:n=>"string"==typeof n?(n=>{let s=!1;const i=e=>{const t=yM(e.name,e.aliases);if(t.includes(n)){s=!0;for(const e of t)r.delete(e);return!1}return!0};return e=e.filter(i),t=t.filter(i),s})(n):(n=>{let s=!1;const i=e=>{if(e.middleware===n){s=!0;for(const t of yM(e.name,e.aliases))r.delete(t);return!1}return!0};return e=e.filter(i),t=t.filter(i),s})(n),removeByTag:n=>{let s=!1;const i=e=>{const{tags:t,name:i,aliases:a}=e;if(t&&t.includes(n)){const e=yM(i,a);for(const t of e)r.delete(t);return s=!0,!1}return!0};return e=e.filter(i),t=t.filter(i),s},concat:e=>{const t=s(bM());return t.use(e),t.identifyOnResolve(n||t.identifyOnResolve()||(e.identifyOnResolve?.()??!1)),t},applyToStack:s,identify:()=>a(!0).map((e=>{const t=e.step??e.relation+" "+e.toMiddleware;return vM(e.name,e.aliases)+" - "+t})),identifyOnResolve:e=>("boolean"==typeof e&&(n=e),n),resolve:(e,t)=>{for(const n of a().map((e=>e.middleware)).reverse())e=n(e,t);return n&&fM.log(o.identify()),e}};return o},CM={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},wM={high:3,normal:2,low:1};class SM{constructor(e){this.config=e,this.middlewareStack=bM()}send(e,t,n){const r="function"!=typeof t?t:void 0,s="function"==typeof t?t:n;let i;if(void 0===r&&!0===this.config.cacheMiddleware){this.handlers||(this.handlers=new WeakMap);const t=this.handlers;t.has(e.constructor)?i=t.get(e.constructor):(i=e.resolveMiddleware(this.middlewareStack,this.config,r),t.set(e.constructor,i))}else delete this.handlers,i=e.resolveMiddleware(this.middlewareStack,this.config,r);if(!s)return i(e).then((e=>e.output));i(e).then((e=>s(null,e.output)),(e=>s(e))).catch((()=>{}))}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}}class EM{constructor(){this.middlewareStack=bM()}static classBuilder(){return new xM}resolveMiddlewareWithContext(e,t,n,{middlewareFn:r,clientName:s,commandName:i,inputFilterSensitiveLog:a,outputFilterSensitiveLog:o,smithyContext:l,additionalContext:c,CommandCtor:u}){for(const s of r.bind(this)(u,e,t,n))this.middlewareStack.use(s);const d=e.concat(this.middlewareStack),{logger:h}=t,p={logger:h,clientName:s,commandName:i,inputFilterSensitiveLog:a,outputFilterSensitiveLog:o,[qP]:{commandInstance:this,...l},...c},{requestHandler:g}=t;return d.resolve((e=>g.handle(e.request,n||{})),p)}}class xM{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=e=>e,this._outputFilterSensitiveLog=e=>e,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,t,n={}){return this._smithyContext={service:e,operation:t,...n},this}c(e={}){return this._additionalContext=e,this}n(e,t){return this._clientName=e,this._commandName=t,this}f(e=e=>e,t=e=>e){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=t,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}sc(e){return this._operationSchema=e,this._smithyContext.operationSchema=e,this}build(){const e=this;let t;return t=class extends EM{static getEndpointParameterInstructions(){return e._ep}constructor(...[t]){super(),this.serialize=e._serializer,this.deserialize=e._deserializer,this.input=t??{},e._init(this),this.schema=e._operationSchema}resolveMiddleware(n,r,s){return this.resolveMiddlewareWithContext(n,r,s,{CommandCtor:t,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog,outputFilterSensitiveLog:e._outputFilterSensitiveLog,smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}const IM="***SensitiveInformation***";class AM extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,Object.getPrototypeOf(this).constructor.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}static isInstance(e){if(!e)return!1;const t=e;return AM.prototype.isPrototypeOf(t)||Boolean(t.$fault)&&Boolean(t.$metadata)&&("client"===t.$fault||"server"===t.$fault)}static[Symbol.hasInstance](e){if(!e)return!1;const t=e;return this===AM?AM.isInstance(e):!!AM.isInstance(e)&&(t.name&&this.name?this.prototype.isPrototypeOf(e)||t.name===this.name:this.prototype.isPrototypeOf(e))}}const PM=(e,t={})=>{Object.entries(t).filter((([,e])=>void 0!==e)).forEach((([t,n])=>{null!=e[t]&&""!==e[t]||(e[t]=n)}));const n=e.message||e.Message||"UnknownError";return e.message=n,delete e.Message,e},kM=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}),TM=e=>{switch(e){case"standard":case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},DM=e=>Object.assign((e=>{const t=[];for(const n in jP){const r=jP[n];void 0!==e[r]&&t.push({algorithmId:()=>r,checksumConstructor:()=>e[r]})}return{addChecksumAlgorithm(e){t.push(e)},checksumAlgorithms:()=>t}})(e),(e=>({setRetryStrategy(t){e.retryStrategy=t},retryStrategy:()=>e.retryStrategy}))(e));class MM{trace(){}debug(){}info(){}warn(){}error(){}}function LM(e,t,n){let r,s,i;if(void 0===t&&void 0===n)r={},i=e;else{if(r=e,"function"==typeof t)return s=t,i=n,NM(r,s,i);i=t}for(const e of Object.keys(i))Array.isArray(i[e])?OM(r,null,i,e):r[e]=i[e];return r}const RM=(e,t)=>{const n={};for(const r in t)OM(n,e,t,r);return n},NM=(e,t,n)=>LM(e,Object.entries(n).reduce(((e,[n,r])=>(Array.isArray(r)?e[n]=r:e[n]="function"==typeof r?[t,r()]:[t,r],e)),{})),OM=(e,t,n,r)=>{if(null!==t){let s=n[r];"function"==typeof s&&(s=[,s]);const[i=_M,a=BM,o=r]=s;return void(("function"==typeof i&&i(t[o])||"function"!=typeof i&&i)&&(e[r]=a(t[o])))}let[s,i]=n[r];if("function"==typeof i){let t;const n=void 0===s&&null!=(t=i()),a="function"==typeof s&&!!s(void 0)||"function"!=typeof s&&!!s;n?e[r]=t:a&&(e[r]=i())}else{const t=void 0===s&&null!=i,n="function"==typeof s&&!!s(i)||"function"!=typeof s&&!!s;(t||n)&&(e[r]=i)}},_M=e=>null!=e,BM=e=>e,FM=e=>{if(e!=e)return"NaN";switch(e){case 1/0:return"Infinity";case-1/0:return"-Infinity";default:return e}},UM=e=>{if(null==e)return{};if(Array.isArray(e))return e.filter((e=>null!=e)).map(UM);if("object"==typeof e){const t={};for(const n of Object.keys(e))null!=e[n]&&(t[n]=UM(e[n]));return t}return e},HM=e=>e?.body instanceof ReadableStream;var zM=n(58651);const jM=e=>void 0!==e.acquireInitialRetryToken&&void 0!==e.refreshRetryTokenForRetry&&void 0!==e.recordSuccess,VM=e=>{const t={error:e,errorType:qM(e)},n=GM(e.$response);return n&&(t.retryAfterHint=n),t},qM=e=>sM(e)?"THROTTLING":iM(e)?"TRANSIENT":(e=>{if(void 0!==e.$metadata?.httpStatusCode){const t=e.$metadata.httpStatusCode;return 500<=t&&t<=599&&!iM(e)}return!1})(e)?"SERVER_ERROR":"CLIENT_ERROR",WM={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},QM=e=>({applyToStack:t=>{t.add((e=>(t,n)=>async r=>{let s=await e.retryStrategy();const i=await e.maxAttempts();if(!jM(s))return s?.mode&&(n.userAgent=[...n.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(t,r);{let e=await s.acquireInitialRetryToken(n.partition_id),a=new Error,o=0,l=0;const{request:c}=r,u=GP.isInstance(c);for(u&&(c.headers[cM]=(0,bo.A)());;)try{u&&(c.headers[uM]=`attempt=${o+1}; max=${i}`);const{response:n,output:a}=await t(r);return s.recordSuccess(e),a.$metadata.attempts=o+1,a.$metadata.totalRetryDelay=l,{response:n,output:a}}catch(t){const r=VM(t);if(a=mM(t),u&&HM(c))throw(n.logger instanceof MM?zM:n.logger)?.warn("An error was encountered in a non-retryable streaming request."),a;try{e=await s.refreshRetryTokenForRetry(e,r)}catch(e){throw a.$metadata||(a.$metadata={}),a.$metadata.attempts=o+1,a.$metadata.totalRetryDelay=l,a}o=e.getRetryCount();const i=e.getRetryDelay();l+=i,await new Promise((e=>setTimeout(e,i)))}}})(e),WM)}}),GM=e=>{if(!ZP.isInstance(e))return;const t=Object.keys(e.headers).find((e=>"retry-after"===e.toLowerCase()));if(!t)return;const n=e.headers[t],r=Number(n);if(!Number.isNaN(r))return new Date(1e3*r);return new Date(n)};const ZM=e=>"string"==typeof e?bk(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e),YM="X-Amz-Date",KM="X-Amz-Signature",JM="X-Amz-Security-Token",XM="authorization",$M=YM.toLowerCase(),eL=[XM,$M,"date"],tL=KM.toLowerCase(),nL="x-amz-content-sha256",rL=JM.toLowerCase(),sL={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},iL=/^proxy-/,aL=/^sec-/,oL="AWS4-HMAC-SHA256",lL="AWS4-HMAC-SHA256-PAYLOAD",cL="aws4_request",uL={},dL=[],hL=(e,t,n)=>`${e}/${t}/${n}/${cL}`,pL=(e,t,n)=>{const r=new e(t);return r.update(ZM(n)),r.digest()},gL=({headers:e},t,n)=>{const r={};for(const s of Object.keys(e).sort()){if(null==e[s])continue;const i=s.toLowerCase();(i in sL||t?.has(i)||iL.test(i)||aL.test(i))&&(!n||n&&!n.has(i))||(r[i]=e[s].trim().replace(/\s+/g," "))}return r},mL=async({headers:e,body:t},n)=>{for(const t of Object.keys(e))if(t.toLowerCase()===nL)return e[t];if(null==t)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if("string"==typeof t||ArrayBuffer.isView(t)||(r=t,"function"==typeof ArrayBuffer&&r instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(r))){const e=new n;return e.update(ZM(t)),Nk(await e.digest())}var r;return"UNSIGNED-PAYLOAD"};class fL{format(e){const t=[];for(const n of Object.keys(e)){const r=bk(n);t.push(Uint8Array.from([r.byteLength]),r,this.formatHeaderValue(e[n]))}const n=new Uint8Array(t.reduce(((e,t)=>e+t.byteLength),0));let r=0;for(const e of t)n.set(e,r),r+=e.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":const s=new DataView(new ArrayBuffer(3+e.value.byteLength));s.setUint8(0,6),s.setUint16(1,e.value.byteLength,!1);const i=new Uint8Array(s.buffer);return i.set(e.value,3),i;case"string":const a=bk(e.value),o=new DataView(new ArrayBuffer(3+a.byteLength));o.setUint8(0,7),o.setUint16(1,a.byteLength,!1);const l=new Uint8Array(o.buffer);return l.set(a,3),l;case"timestamp":const c=new Uint8Array(9);return c[0]=8,c.set(bL.fromNumber(e.value.valueOf()).bytes,1),c;case"uuid":if(!vL.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const u=new Uint8Array(17);return u[0]=9,u.set(Rk(e.value.replace(/\-/g,"")),1),u}}}var yL;!function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(yL||(yL={}));const vL=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;class bL{constructor(e){if(this.bytes=e,8!==e.byteLength)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>0x8000000000000000||e<-0x8000000000000000)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let n=7,r=Math.abs(Math.round(e));n>-1&&r>0;n--,r/=256)t[n]=r;return e<0&&CL(t),new bL(t)}valueOf(){const e=this.bytes.slice(0),t=128&e[0];return t&&CL(e),parseInt(Nk(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function CL(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,0===e[t]);t--);}const wL=e=>{e=GP.clone(e);for(const t of Object.keys(e.headers))eL.indexOf(t.toLowerCase())>-1&&delete e.headers[t];return e},SL=e=>"number"==typeof e?new Date(1e3*e):"string"==typeof e?Number(e)?new Date(1e3*Number(e)):new Date(e):e;class EL{constructor({applyChecksum:e,credentials:t,region:n,service:r,sha256:s,uriEscapePath:i=!0}){this.service=r,this.sha256=s,this.uriEscapePath=i,this.applyChecksum="boolean"!=typeof e||e,this.regionProvider=rk(n),this.credentialProvider=rk(t)}createCanonicalRequest(e,t,n){const r=Object.keys(t).sort();return`${e.method}\n${this.getCanonicalPath(e)}\n${(({query:e={}})=>{const t=[],n={};for(const r of Object.keys(e)){if(r.toLowerCase()===tL)continue;const s=Ek(r);t.push(s);const i=e[r];"string"==typeof i?n[s]=`${s}=${Ek(i)}`:Array.isArray(i)&&(n[s]=i.slice(0).reduce(((e,t)=>e.concat([`${s}=${Ek(t)}`])),[]).sort().join("&"))}return t.sort().map((e=>n[e])).filter((e=>e)).join("&")})(e)}\n${r.map((e=>`${e}:${t[e]}`)).join("\n")}\n\n${r.join(";")}\n${n}`}async createStringToSign(e,t,n,r){const s=new this.sha256;s.update(ZM(n));return`${r}\n${e}\n${t}\n${Nk(await s.digest())}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const t=[];for(const n of e.split("/"))0!==n?.length&&"."!==n&&(".."===n?t.pop():t.push(n));const n=`${e?.startsWith("/")?"/":""}${t.join("/")}${t.length>0&&e?.endsWith("/")?"/":""}`;return Ek(n).replace(/%2F/g,"/")}return e}validateResolvedCredentials(e){if("object"!=typeof e||"string"!=typeof e.accessKeyId||"string"!=typeof e.secretAccessKey)throw new Error("Resolved credential object is not valid")}formatDate(e){const t=(n=e,SL(n).toISOString().replace(/\.\d{3}Z$/,"Z")).replace(/[\-:]/g,"");var n;return{longDate:t,shortDate:t.slice(0,8)}}getCanonicalHeaderList(e){return Object.keys(e).sort().join(";")}}class xL extends EL{constructor({applyChecksum:e,credentials:t,region:n,service:r,sha256:s,uriEscapePath:i=!0}){super({applyChecksum:e,credentials:t,region:n,service:r,sha256:s,uriEscapePath:i}),this.headerFormatter=new fL}async presign(e,t={}){const{signingDate:n=new Date,expiresIn:r=3600,unsignableHeaders:s,unhoistableHeaders:i,signableHeaders:a,hoistableHeaders:o,signingRegion:l,signingService:c}=t,u=await this.credentialProvider();this.validateResolvedCredentials(u);const d=l??await this.regionProvider(),{longDate:h,shortDate:p}=this.formatDate(n);if(r>604800)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const g=hL(p,d,c??this.service),m=((e,t={})=>{const{headers:n,query:r={}}=GP.clone(e);for(const e of Object.keys(n)){const s=e.toLowerCase();("x-amz-"===s.slice(0,6)&&!t.unhoistableHeaders?.has(s)||t.hoistableHeaders?.has(s))&&(r[e]=n[e],delete n[e])}return{...e,headers:n,query:r}})(wL(e),{unhoistableHeaders:i,hoistableHeaders:o});u.sessionToken&&(m.query[JM]=u.sessionToken),m.query["X-Amz-Algorithm"]=oL,m.query["X-Amz-Credential"]=`${u.accessKeyId}/${g}`,m.query[YM]=h,m.query["X-Amz-Expires"]=r.toString(10);const f=gL(m,s,a);return m.query["X-Amz-SignedHeaders"]=this.getCanonicalHeaderList(f),m.query[KM]=await this.getSignature(h,g,this.getSigningKey(u,d,p,c),this.createCanonicalRequest(m,f,await mL(e,this.sha256))),m}async sign(e,t){return"string"==typeof e?this.signString(e,t):e.headers&&e.payload?this.signEvent(e,t):e.message?this.signMessage(e,t):this.signRequest(e,t)}async signEvent({headers:e,payload:t},{signingDate:n=new Date,priorSignature:r,signingRegion:s,signingService:i}){const a=s??await this.regionProvider(),{shortDate:o,longDate:l}=this.formatDate(n),c=hL(o,a,i??this.service),u=await mL({headers:{},body:t},this.sha256),d=new this.sha256;d.update(e);const h=Nk(await d.digest()),p=[lL,l,c,r,h,u].join("\n");return this.signString(p,{signingDate:n,signingRegion:a,signingService:i})}async signMessage(e,{signingDate:t=new Date,signingRegion:n,signingService:r}){return this.signEvent({headers:this.headerFormatter.format(e.message.headers),payload:e.message.body},{signingDate:t,signingRegion:n,signingService:r,priorSignature:e.priorSignature}).then((t=>({message:e.message,signature:t})))}async signString(e,{signingDate:t=new Date,signingRegion:n,signingService:r}={}){const s=await this.credentialProvider();this.validateResolvedCredentials(s);const i=n??await this.regionProvider(),{shortDate:a}=this.formatDate(t),o=new this.sha256(await this.getSigningKey(s,i,a,r));return o.update(ZM(e)),Nk(await o.digest())}async signRequest(e,{signingDate:t=new Date,signableHeaders:n,unsignableHeaders:r,signingRegion:s,signingService:i}={}){const a=await this.credentialProvider();this.validateResolvedCredentials(a);const o=s??await this.regionProvider(),l=wL(e),{longDate:c,shortDate:u}=this.formatDate(t),d=hL(u,o,i??this.service);l.headers[$M]=c,a.sessionToken&&(l.headers[rL]=a.sessionToken);const h=await mL(l,this.sha256);!((e,t)=>{e=e.toLowerCase();for(const n of Object.keys(t))if(e===n.toLowerCase())return!0;return!1})(nL,l.headers)&&this.applyChecksum&&(l.headers[nL]=h);const p=gL(l,r,n),g=await this.getSignature(c,d,this.getSigningKey(a,o,u,i),this.createCanonicalRequest(l,p,h));return l.headers[XM]=`${oL} Credential=${a.accessKeyId}/${d}, SignedHeaders=${this.getCanonicalHeaderList(p)}, Signature=${g}`,l}async getSignature(e,t,n,r){const s=await this.createStringToSign(e,t,r,oL),i=new this.sha256(await n);return i.update(ZM(s)),Nk(await i.digest())}getSigningKey(e,t,n,r){return(async(e,t,n,r,s)=>{const i=`${n}:${r}:${s}:${Nk(await pL(e,t.secretAccessKey,t.accessKeyId))}:${t.sessionToken}`;if(i in uL)return uL[i];for(dL.push(i);dL.length>50;)delete uL[dL.shift()];let a=`AWS4${t.secretAccessKey}`;for(const t of[n,r,s,cL])a=await pL(e,a,t);return uL[i]=a})(this.sha256,e,n,t,r||this.service)}}const IL=e=>{let t,n=e.credentials,r=!!e.credentials;Object.defineProperty(e,"credentials",{set(s){s&&s!==n&&s!==t&&(r=!0),n=s;const i=function(e,{credentials:t,credentialDefaultProvider:n}){let r;r=t?t?.memoized?t:rT(t,eT,nT):n?mk(n(Object.assign({},e,{parentClientConfig:e}))):async()=>{throw new Error("@aws-sdk/core::resolveAwsSdkSigV4Config - `credentials` not provided and no credentialDefaultProvider was configured.")};return r.memoized=!0,r}(e,{credentials:n,credentialDefaultProvider:e.credentialDefaultProvider}),a=function(e,t){if(t.configBound)return t;const n=async n=>t({...n,callerClientConfig:e});return n.memoized=t.memoized,n.configBound=!0,n}(e,i);r&&!a.attributed?(t=async e=>a(e).then((e=>function(e,t,n){return e.$source||(e.$source={}),e.$source[t]=n,e}(e,"CREDENTIALS_CODE","e"))),t.memoized=a.memoized,t.configBound=a.configBound,t.attributed=!0):t=a},get:()=>t,enumerable:!0,configurable:!0}),e.credentials=n;const{signingEscapePath:s=!0,systemClockOffset:i=e.systemClockOffset||0,sha256:a}=e;let o;o=e.signer?mk(e.signer):e.regionInfoProvider?()=>mk(e.region)().then((async t=>[await e.regionInfoProvider(t,{useFipsEndpoint:await e.useFipsEndpoint(),useDualstackEndpoint:await e.useDualstackEndpoint()})||{},t])).then((([t,n])=>{const{signingRegion:r,signingService:i}=t;e.signingRegion=e.signingRegion||r||n,e.signingName=e.signingName||i||e.serviceId;const o={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:a,uriEscapePath:s};return new(e.signerConstructor||xL)(o)})):async t=>{const n=(t=Object.assign({},{name:"sigv4",signingName:e.signingName||e.defaultSigningName,signingRegion:await mk(e.region)(),properties:{}},t)).signingRegion,r=t.signingName;e.signingRegion=e.signingRegion||n,e.signingName=e.signingName||r||e.serviceId;const i={...e,credentials:e.credentials,region:e.signingRegion,service:e.signingName,sha256:a,uriEscapePath:s};return new(e.signerConstructor||xL)(i)};return Object.assign(e,{systemClockOffset:i,signingEscapePath:s,signer:o})};const AL=async(e,t,n)=>({operation:nk(t).operation,region:await rk(e.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});const PL=e=>{const t=[];return e.operation,t.push(function(e){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"bedrock",region:e.region},propertiesExtractor:(e,t)=>({signingProperties:{config:e,context:t}})}}(e)),t.push({schemeId:"smithy.api#httpBearerAuth",propertiesExtractor:({profile:e,filepath:t,configFilepath:n,ignoreCache:r},s)=>({identityProperties:{profile:e,filepath:t,configFilepath:n,ignoreCache:r}})}),t},kL={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},TL="3.842.0";var DL={name:"SHA-256"},ML={name:"HMAC",hash:DL},LL=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const RL={};function NL(){return"undefined"!=typeof window?window:"undefined"!=typeof self?self:RL}var OL=function(){function e(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return e.prototype.update=function(e){if(!GT(e)){var t=QT(e),n=new Uint8Array(this.toHash.byteLength+t.byteLength);n.set(this.toHash,0),n.set(t,this.toHash.byteLength),this.toHash=n}},e.prototype.digest=function(){var e=this;return this.key?this.key.then((function(t){return NL().crypto.subtle.sign(ML,t,e.toHash).then((function(e){return new Uint8Array(e)}))})):GT(this.toHash)?Promise.resolve(LL):Promise.resolve().then((function(){return NL().crypto.subtle.digest(DL,e.toHash)})).then((function(e){return Promise.resolve(new Uint8Array(e))}))},e.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&void 0!==this.secret&&(this.key=new Promise((function(t,n){NL().crypto.subtle.importKey("raw",QT(e.secret),ML,!1,["sign"]).then(t,n)})),this.key.catch((function(){})))},e}(),_L=64,BL=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),FL=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],UL=Math.pow(2,53)-1,HL=function(){function e(){this.state=Int32Array.from(FL),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>UL)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===_L&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%_L>=56){for(var r=this.bufferLength;r<_L;r++)t.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(r=this.bufferLength;r<56;r++)t.setUint8(r,0);t.setUint32(56,Math.floor(e/4294967296),!0),t.setUint32(60,e),this.hashBuffer(),this.finished=!0}var s=new Uint8Array(32);for(r=0;r<8;r++)s[4*r]=this.state[r]>>>24&255,s[4*r+1]=this.state[r]>>>16&255,s[4*r+2]=this.state[r]>>>8&255,s[4*r+3]=this.state[r]>>>0&255;return s},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],r=t[1],s=t[2],i=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=0;u<_L;u++){if(u<16)this.temp[u]=(255&e[4*u])<<24|(255&e[4*u+1])<<16|(255&e[4*u+2])<<8|255&e[4*u+3];else{var d=this.temp[u-2],h=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,p=((d=this.temp[u-15])>>>7|d<<25)^(d>>>18|d<<14)^d>>>3;this.temp[u]=(h+this.temp[u-7]|0)+(p+this.temp[u-16]|0)}var g=(((a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7))+(a&o^~a&l)|0)+(c+(BL[u]+this.temp[u]|0)|0)|0,m=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&r^n&s^r&s)|0;c=l,l=o,o=a,a=i+g|0,i=s,s=r,r=n,n=g+m|0}t[0]+=n,t[1]+=r,t[2]+=s,t[3]+=i,t[4]+=a,t[5]+=o,t[6]+=l,t[7]+=c},e}(),zL=function(){function e(e){this.secret=e,this.hash=new HL,this.reset()}return e.prototype.update=function(e){if(!GT(e)&&!this.error)try{this.hash.update(QT(e))}catch(e){this.error=e}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return(0,y.__awaiter)(this,void 0,void 0,(function(){return(0,y.__generator)(this,(function(e){return[2,this.digestSync()]}))}))},e.prototype.reset=function(){if(this.hash=new HL,this.secret){this.outer=new HL;var e=function(e){var t=QT(e);if(t.byteLength>_L){var n=new HL;n.update(t),t=n.digest()}var r=new Uint8Array(_L);return r.set(t),r}(this.secret),t=new Uint8Array(_L);t.set(e);for(var n=0;n<_L;n++)e[n]^=54,t[n]^=92;this.hash.update(e),this.outer.update(t);for(n=0;n<e.byteLength;n++)e[n]=0}},e}();var jL=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function VL(e){return e&&jL.every((function(t){return"function"==typeof e[t]}))}var qL=function(){function e(e){!function(e){return!(!function(e){return"object"==typeof e&&"object"==typeof e.crypto&&"function"==typeof e.crypto.getRandomValues}(e)||"object"!=typeof e.crypto.subtle)&&VL(e.crypto.subtle)}(NL())?this.hash=new zL(e):this.hash=new OL(e)}return e.prototype.update=function(e,t){this.hash.update(QT(e))},e.prototype.digest=function(){return this.hash.digest()},e.prototype.reset=function(){this.hash.reset()},e}(),WL=n(47018),QL=n.n(WL);const GL=({serviceId:e,clientVersion:t})=>async n=>{const r="undefined"!=typeof window&&window?.navigator?.userAgent?QL().parse(window.navigator.userAgent):void 0,s=[["aws-sdk-js",t],["ua","2.1"],[`os/${r?.os?.name||"other"}`,r?.os?.version],["lang/js"],["md/browser",`${r?.browser?.name??"unknown"}_${r?.browser?.version??"unknown"}`]];e&&s.push([`api/${e}`,t]);const i=await(n?.userAgentAppId?.());return i&&s.push([`app/${i}`]),s},ZL="function"==typeof TextEncoder?new TextEncoder:null,YL=e=>{if("string"==typeof e){if(ZL)return ZL.encode(e).byteLength;let t=e.length;for(let n=t-1;n>=0;n--){const r=e.charCodeAt(n);r>127&&r<=2047?t++:r>2047&&r<=65535&&(t+=2),r>=56320&&r<=57343&&n--}return t}if("number"==typeof e.byteLength)return e.byteLength;if("number"==typeof e.size)return e.size;throw new Error(`Body Length computation failed for ${e}`)},KL=e=>new Date(Date.now()+e),JL=e=>ZP.isInstance(e)?e.headers?.date??e.headers?.Date:void 0,XL=(e,t)=>{const n=Date.parse(e);return((e,t)=>Math.abs(KL(t).getTime()-e)>=3e5)(n,t)?n-Date.now():t},$L=(e,t)=>{if(!t)throw new Error(`Property \`${e}\` is not resolved for AWS SDK SigV4Auth`);return t};class eR{async sign(e,t,n){if(!GP.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const r=await(async e=>{const t=$L("context",e.context),n=$L("config",e.config),r=t.endpointV2?.properties?.authSchemes?.[0],s=$L("signer",n.signer),i=await s(r),a=e?.signingRegion,o=e?.signingRegionSet,l=e?.signingName;return{config:n,signer:i,signingRegion:a,signingRegionSet:o,signingName:l}})(n),{config:s,signer:i}=r;let{signingRegion:a,signingName:o}=r;const l=n.context;if(l?.authSchemes?.length){const[e,t]=l.authSchemes;"sigv4a"===e?.name&&"sigv4"===t?.name&&(a=t?.signingRegion??a,o=t?.signingName??o)}return await i.sign(e,{signingDate:KL(s.systemClockOffset),signingRegion:a,signingService:o})}errorHandler(e){return t=>{const n=t.ServerTime??JL(t.$response);if(n){const r=$L("config",e.config),s=r.systemClockOffset;r.systemClockOffset=XL(n,r.systemClockOffset);r.systemClockOffset!==s&&t.$metadata&&(t.$metadata.clockSkewCorrected=!0)}throw t}}successHandler(e,t){const n=JL(e);if(n){const e=$L("config",t.config);e.systemClockOffset=XL(n,e.systemClockOffset)}}}const tR="required",nR="fn",rR="argv",sR="ref",iR=!0,aR="isSet",oR="booleanEquals",lR="error",cR="endpoint",uR="tree",dR="PartitionResult",hR={[tR]:!1,type:"String"},pR={[tR]:!0,default:!1,type:"Boolean"},gR={[sR]:"Endpoint"},mR={[nR]:oR,[rR]:[{[sR]:"UseFIPS"},!0]},fR={[nR]:oR,[rR]:[{[sR]:"UseDualStack"},!0]},yR={},vR={[nR]:"getAttr",[rR]:[{[sR]:dR},"supportsFIPS"]},bR={[nR]:oR,[rR]:[!0,{[nR]:"getAttr",[rR]:[{[sR]:dR},"supportsDualStack"]}]},CR=[mR],wR=[fR],SR=[{[sR]:"Region"}],ER={version:"1.0",parameters:{Region:hR,UseDualStack:pR,UseFIPS:pR,Endpoint:hR},rules:[{conditions:[{[nR]:aR,[rR]:[gR]}],rules:[{conditions:CR,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:lR},{rules:[{conditions:wR,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:lR},{endpoint:{url:gR,properties:yR,headers:yR},type:cR}],type:uR}],type:uR},{rules:[{conditions:[{[nR]:aR,[rR]:SR}],rules:[{conditions:[{[nR]:"aws.partition",[rR]:SR,assign:dR}],rules:[{conditions:[mR,fR],rules:[{conditions:[{[nR]:oR,[rR]:[iR,vR]},bR],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:yR,headers:yR},type:cR}],type:uR}],type:uR},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:lR}],type:uR},{conditions:CR,rules:[{conditions:[{[nR]:oR,[rR]:[vR,iR]}],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dnsSuffix}",properties:yR,headers:yR},type:cR}],type:uR}],type:uR},{error:"FIPS is enabled but this partition does not support FIPS",type:lR}],type:uR},{conditions:wR,rules:[{conditions:[bR],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:yR,headers:yR},type:cR}],type:uR}],type:uR},{error:"DualStack is enabled but this partition does not support DualStack",type:lR}],type:uR},{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dnsSuffix}",properties:yR,headers:yR},type:cR}],type:uR}],type:uR}],type:uR},{error:"Invalid Configuration: Missing Region",type:lR}],type:uR}]},xR=new class{constructor({size:e,params:t}){this.data=new Map,this.parameters=[],this.capacity=e??50,t&&(this.parameters=t)}get(e,t){const n=this.hash(e);if(!1===n)return t();if(!this.data.has(n)){if(this.data.size>this.capacity+10){const e=this.data.keys();let t=0;for(;;){const{value:n,done:r}=e.next();if(this.data.delete(n),r||++t>10)break}}this.data.set(n,t())}return this.data.get(n)}size(){return this.data.size}hash(e){let t="";const{parameters:n}=this;if(0===n.length)return!1;for(const r of n){const n=String(e[r]??"");if(n.includes("|;"))return!1;t+=n+"|;"}return t}}({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),IR=(e,t={})=>xR.get(e,(()=>((e,t)=>{const{endpointParams:n,logger:r}=t,{parameters:s,rules:i}=e;t.logger?.debug?.(`${uT} Initial EndpointParams: ${dT(n)}`);const a=Object.entries(s).filter((([,e])=>null!=e.default)).map((([e,t])=>[e,t.default]));if(a.length>0)for(const[e,t]of a)n[e]=n[e]??t;const o=Object.entries(s).filter((([,e])=>e.required)).map((([e])=>e));for(const e of o)if(null==n[e])throw new hT(`Missing required parameter: '${e}'`);const l=DT(i,{endpointParams:n,logger:r,referenceRecord:{}});return t.logger?.debug?.(`${uT} Resolved endpoint: ${dT(l)}`),l})(ER,{endpointParams:e,logger:t.logger})));cT.aws=NT;Error;const AR=["in-region","cross-region","mobile","standard","legacy"],PR=()=>{const e="undefined"!=typeof window&&window?.navigator?.userAgent?QL().parse(window.navigator.userAgent):void 0,t=e?.platform?.type;return"tablet"===t||"mobile"===t},kR=e=>{const t=(({defaultsMode:e}={})=>((e,t,n)=>{let r,s,i,a=!1;const o=async()=>{s||(s=e());try{r=await s,i=!0,a=!1}finally{s=void 0}return r};return void 0===t?async e=>(i&&!e?.forceRefresh||(r=await o()),r):async e=>(i&&!e?.forceRefresh||(r=await o()),a?r:n&&!n(r)?(a=!0,r):t(r)?(await o(),r):r)})((async()=>{const t="function"==typeof e?await e():e;switch(t?.toLowerCase()){case"auto":return Promise.resolve(PR()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(t?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${AR.join(", ")}, got ${t}`)}})))(e),n=()=>t().then(TM),r=(e=>({apiVersion:"2023-09-30",base64Decoder:e?.base64Decoder??vk,base64Encoder:e?.base64Encoder??Ck,disableHostPrefix:e?.disableHostPrefix??!1,endpointProvider:e?.endpointProvider??IR,extensions:e?.extensions??[],httpAuthSchemeProvider:e?.httpAuthSchemeProvider??PL,httpAuthSchemes:e?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new eR},{schemeId:"smithy.api#httpBearerAuth",identityProvider:e=>e.getIdentityProvider("smithy.api#httpBearerAuth"),signer:new $k}],logger:e?.logger??new MM,serviceId:e?.serviceId??"Bedrock Runtime",urlParser:e?.urlParser??WD,utf8Decoder:e?.utf8Decoder??bk,utf8Encoder:e?.utf8Encoder??wk}))(e);return{...r,...e,runtime:"browser",defaultsMode:t,bodyLengthChecker:e?.bodyLengthChecker??YL,credentialDefaultProvider:e?.credentialDefaultProvider??(e=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:e?.defaultUserAgentProvider??GL({serviceId:r.serviceId,clientVersion:TL}),eventStreamPayloadHandlerProvider:e?.eventStreamPayloadHandlerProvider??fD,eventStreamSerdeProvider:e?.eventStreamSerdeProvider??AD,maxAttempts:e?.maxAttempts??3,region:e?.region??(s="Region is missing",()=>Promise.reject(s)),requestHandler:kD.create(e?.requestHandler??n,Tk.create(n)),retryMode:e?.retryMode??(async()=>(await n()).retryMode||XD),sha256:e?.sha256??qL,streamCollector:e?.streamCollector??Dk,useDualstackEndpoint:e?.useDualstackEndpoint??(()=>Promise.resolve(false)),useFipsEndpoint:e?.useFipsEndpoint??(()=>Promise.resolve(false))};var s},TR=(e,t)=>{const n=Object.assign((e=>({setRegion(t){e.region=t},region:()=>e.region}))(e),DM(e),(e=>({setHttpHandler(t){e.httpHandler=t},httpHandler:()=>e.httpHandler,updateHttpClientConfig(t,n){e.httpHandler?.updateHttpClientConfig(t,n)},httpHandlerConfigs:()=>e.httpHandler.httpHandlerConfigs()}))(e),(e=>{const t=e.httpAuthSchemes;let n=e.httpAuthSchemeProvider,r=e.credentials,s=e.token;return{setHttpAuthScheme(e){const n=t.findIndex((t=>t.schemeId===e.schemeId));-1===n?t.push(e):t.splice(n,1,e)},httpAuthSchemes:()=>t,setHttpAuthSchemeProvider(e){n=e},httpAuthSchemeProvider:()=>n,setCredentials(e){r=e},credentials:()=>r,setToken(e){s=e},token:()=>s}})(e));return t.forEach((e=>e.configure(n))),Object.assign(e,{region:n.region()},(r=n,Object.assign((e=>{const t={};return e.checksumAlgorithms().forEach((e=>{t[e.algorithmId()]=e.checksumConstructor()})),t})(r),(e=>{const t={};return t.retryStrategy=e.retryStrategy(),t})(r))),{httpHandler:n.httpHandler()},(e=>({httpAuthSchemes:e.httpAuthSchemes(),httpAuthSchemeProvider:e.httpAuthSchemeProvider(),credentials:e.credentials(),token:e.token()}))(n));var r};class DR extends SM{config;constructor(...[e]){const t=kR(e||{});super(t),this.initConfig=t;var n;const r=function(e){const t=mk(e.userAgentAppId??void 0),{customUserAgent:n}=e;return Object.assign(e,{customUserAgent:"string"==typeof n?[[n]]:n,userAgentAppId:async()=>{const n=await t();if(!function(e){return void 0===e||"string"==typeof e&&e.length<=50}(n)){const t="NoOpLogger"!==e.logger?.constructor?.name&&e.logger?e.logger:sT;"string"!=typeof n?t?.warn("userAgentAppId must be a string or undefined."):n.length>50&&t?.warn("The provided userAgentAppId exceeds the maximum length of 50 characters.")}return n}})}((n=t,Object.assign(n,{useDualstackEndpoint:n.useDualstackEndpoint??!1,useFipsEndpoint:n.useFipsEndpoint??!1,defaultSigningName:"bedrock"}))),s=(e=>{const{retryStrategy:t,retryMode:n,maxAttempts:r}=e,s=rk(r??3);return Object.assign(e,{maxAttempts:s,retryStrategy:async()=>t||(await rk(n)()===JD.ADAPTIVE?new gM(s):new pM(s))})})(r),i=(e=>{const{region:t,useFipsEndpoint:n}=e;if(!t)throw new Error("Region is missing");return Object.assign(e,{region:async()=>{if("string"==typeof t)return ND(t);const e=await t();return ND(e)},useFipsEndpoint:async()=>{const e="string"==typeof t?t:await t();return!!RD(e)||("function"!=typeof n?Promise.resolve(!!n):n())}})})(s),a=(e=>{const t=e.tls??!0,{endpoint:n,useDualstackEndpoint:r,useFipsEndpoint:s}=e,i=null!=n?async()=>QD(await rk(n)()):void 0,a=!!n,o=Object.assign(e,{endpoint:i,tls:t,isCustomEndpoint:a,useDualstackEndpoint:rk(r??!1),useFipsEndpoint:rk(s??!1)});let l;return o.serviceConfiguredEndpoint=async()=>(e.serviceId&&!l&&(l=qD(e.serviceId)),l),o})(i);var o;const l=(e=>{const t=rT(e.token,eT,nT),n=IL(e);return Object.assign(n,{authSchemePreference:rk(e.authSchemePreference??[]),token:t})})((o=a,Object.assign(o,{eventStreamMarshaller:o.eventStreamSerdeProvider(o)}))),c=function(e){const t=e.signer,n=e.signer,r=Object.assign(e,{eventSigner:t,messageSigner:n}),s=r.eventStreamPayloadHandlerProvider(r);return Object.assign(r,{eventStreamPayloadHandler:s})}(l),u=(e=>{const{signer:t}=e;return Object.assign(e,{signer:async e=>{const n=await t(e);if(bD(n))return new vD({signer:n});throw new Error("Expected WebsocketSignatureV4 signer, please check the client constructor.")}})})(c),d=TR(u,e?.extensions||[]);var h;this.config=d,this.middlewareStack.use((h=this.config,{applyToStack:e=>{e.add(zT(h),VT)}})),this.middlewareStack.use(QM(this.config)),this.middlewareStack.use(BD(this.config)),this.middlewareStack.use(KP(this.config)),this.middlewareStack.use((this.config,{applyToStack:e=>{e.add(((e,t)=>async n=>{try{const r=await e(n),{clientName:s,commandName:i,logger:a,dynamoDbDocumentClientOptions:o={}}=t,{overrideInputFilterSensitiveLog:l,overrideOutputFilterSensitiveLog:c}=o,u=l??t.inputFilterSensitiveLog,d=c??t.outputFilterSensitiveLog,{$metadata:h,...p}=r.output;return a?.info?.({clientName:s,commandName:i,input:u(n.input),output:d(p),metadata:h}),r}catch(e){const{clientName:r,commandName:s,logger:i,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:o}=a,l=o??t.inputFilterSensitiveLog;throw i?.error?.({clientName:r,commandName:s,input:l(n.input),error:e,metadata:e.$metadata}),e}}),JP)}})),this.middlewareStack.use(tk(this.config)),this.middlewareStack.use(((e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:n})=>({applyToStack:r=>{r.addRelativeTo(sk(e,{httpAuthSchemeParametersProvider:t,identityProviderConfigProvider:n}),ik)}}))(this.config,{httpAuthSchemeParametersProvider:AL,identityProviderConfigProvider:async e=>new Xk({"aws.auth#sigv4":e.credentials,"smithy.api#httpBearerAuth":e.token})})),this.middlewareStack.use(gk(this.config))}destroy(){super.destroy()}}class MR extends AM{constructor(e){super(e),Object.setPrototypeOf(this,MR.prototype)}}class LR extends MR{name="AccessDeniedException";$fault="client";constructor(e){super({name:"AccessDeniedException",$fault:"client",...e}),Object.setPrototypeOf(this,LR.prototype)}}var RR;!function(e){e.visit=(e,t)=>void 0!==e.s3OutputDataConfig?t.s3OutputDataConfig(e.s3OutputDataConfig):t._(e.$unknown[0],e.$unknown[1])}(RR||(RR={}));class NR extends MR{name="InternalServerException";$fault="server";constructor(e){super({name:"InternalServerException",$fault:"server",...e}),Object.setPrototypeOf(this,NR.prototype)}}class OR extends MR{name="ThrottlingException";$fault="client";constructor(e){super({name:"ThrottlingException",$fault:"client",...e}),Object.setPrototypeOf(this,OR.prototype)}}class _R extends MR{name="ValidationException";$fault="client";constructor(e){super({name:"ValidationException",$fault:"client",...e}),Object.setPrototypeOf(this,_R.prototype)}}class BR extends MR{name="ConflictException";$fault="client";constructor(e){super({name:"ConflictException",$fault:"client",...e}),Object.setPrototypeOf(this,BR.prototype)}}class FR extends MR{name="ResourceNotFoundException";$fault="client";constructor(e){super({name:"ResourceNotFoundException",$fault:"client",...e}),Object.setPrototypeOf(this,FR.prototype)}}class UR extends MR{name="ServiceQuotaExceededException";$fault="client";constructor(e){super({name:"ServiceQuotaExceededException",$fault:"client",...e}),Object.setPrototypeOf(this,UR.prototype)}}class HR extends MR{name="ServiceUnavailableException";$fault="server";constructor(e){super({name:"ServiceUnavailableException",$fault:"server",...e}),Object.setPrototypeOf(this,HR.prototype)}}var zR;!function(e){e.visit=(e,t)=>void 0!==e.bytes?t.bytes(e.bytes):t._(e.$unknown[0],e.$unknown[1])}(zR||(zR={}));var jR;!function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):void 0!==e.image?t.image(e.image):t._(e.$unknown[0],e.$unknown[1])}(jR||(jR={}));var VR,qR,WR;!function(e){e.visit=(e,t)=>void 0!==e.documentChar?t.documentChar(e.documentChar):void 0!==e.documentPage?t.documentPage(e.documentPage):void 0!==e.documentChunk?t.documentChunk(e.documentChunk):t._(e.$unknown[0],e.$unknown[1])}(VR||(VR={})),function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):t._(e.$unknown[0],e.$unknown[1])}(qR||(qR={})),function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):t._(e.$unknown[0],e.$unknown[1])}(WR||(WR={}));var QR,GR;!function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):t._(e.$unknown[0],e.$unknown[1])}(QR||(QR={})),function(e){e.visit=(e,t)=>void 0!==e.bytes?t.bytes(e.bytes):void 0!==e.s3Location?t.s3Location(e.s3Location):void 0!==e.text?t.text(e.text):void 0!==e.content?t.content(e.content):t._(e.$unknown[0],e.$unknown[1])}(GR||(GR={}));var ZR;!function(e){e.visit=(e,t)=>void 0!==e.bytes?t.bytes(e.bytes):t._(e.$unknown[0],e.$unknown[1])}(ZR||(ZR={}));var YR;!function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):void 0!==e.image?t.image(e.image):t._(e.$unknown[0],e.$unknown[1])}(YR||(YR={}));var KR,JR;!function(e){e.visit=(e,t)=>void 0!==e.bytes?t.bytes(e.bytes):void 0!==e.s3Location?t.s3Location(e.s3Location):t._(e.$unknown[0],e.$unknown[1])}(KR||(KR={})),function(e){e.visit=(e,t)=>void 0!==e.reasoningText?t.reasoningText(e.reasoningText):void 0!==e.redactedContent?t.redactedContent(e.redactedContent):t._(e.$unknown[0],e.$unknown[1])}(JR||(JR={}));var XR,$R;!function(e){e.visit=(e,t)=>void 0!==e.bytes?t.bytes(e.bytes):void 0!==e.s3Location?t.s3Location(e.s3Location):t._(e.$unknown[0],e.$unknown[1])}(XR||(XR={})),function(e){e.visit=(e,t)=>void 0!==e.json?t.json(e.json):void 0!==e.text?t.text(e.text):void 0!==e.image?t.image(e.image):void 0!==e.document?t.document(e.document):void 0!==e.video?t.video(e.video):t._(e.$unknown[0],e.$unknown[1])}($R||($R={}));var eN;!function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):void 0!==e.image?t.image(e.image):void 0!==e.document?t.document(e.document):void 0!==e.video?t.video(e.video):void 0!==e.toolUse?t.toolUse(e.toolUse):void 0!==e.toolResult?t.toolResult(e.toolResult):void 0!==e.guardContent?t.guardContent(e.guardContent):void 0!==e.cachePoint?t.cachePoint(e.cachePoint):void 0!==e.reasoningContent?t.reasoningContent(e.reasoningContent):void 0!==e.citationsContent?t.citationsContent(e.citationsContent):t._(e.$unknown[0],e.$unknown[1])}(eN||(eN={}));var tN,nN,rN,sN,iN,aN;!function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):t._(e.$unknown[0],e.$unknown[1])}(tN||(tN={})),function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):void 0!==e.guardContent?t.guardContent(e.guardContent):void 0!==e.cachePoint?t.cachePoint(e.cachePoint):t._(e.$unknown[0],e.$unknown[1])}(nN||(nN={})),function(e){e.visit=(e,t)=>void 0!==e.auto?t.auto(e.auto):void 0!==e.any?t.any(e.any):void 0!==e.tool?t.tool(e.tool):t._(e.$unknown[0],e.$unknown[1])}(rN||(rN={})),function(e){e.visit=(e,t)=>void 0!==e.json?t.json(e.json):t._(e.$unknown[0],e.$unknown[1])}(sN||(sN={})),function(e){e.visit=(e,t)=>void 0!==e.toolSpec?t.toolSpec(e.toolSpec):void 0!==e.cachePoint?t.cachePoint(e.cachePoint):t._(e.$unknown[0],e.$unknown[1])}(iN||(iN={})),function(e){e.visit=(e,t)=>void 0!==e.message?t.message(e.message):t._(e.$unknown[0],e.$unknown[1])}(aN||(aN={}));class oN extends MR{name="ModelErrorException";$fault="client";originalStatusCode;resourceName;constructor(e){super({name:"ModelErrorException",$fault:"client",...e}),Object.setPrototypeOf(this,oN.prototype),this.originalStatusCode=e.originalStatusCode,this.resourceName=e.resourceName}}class lN extends MR{name="ModelNotReadyException";$fault="client";$retryable={};constructor(e){super({name:"ModelNotReadyException",$fault:"client",...e}),Object.setPrototypeOf(this,lN.prototype)}}class cN extends MR{name="ModelTimeoutException";$fault="client";constructor(e){super({name:"ModelTimeoutException",$fault:"client",...e}),Object.setPrototypeOf(this,cN.prototype)}}var uN,dN,hN,pN;!function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):void 0!==e.redactedContent?t.redactedContent(e.redactedContent):void 0!==e.signature?t.signature(e.signature):t._(e.$unknown[0],e.$unknown[1])}(uN||(uN={})),function(e){e.visit=(e,t)=>void 0!==e.text?t.text(e.text):void 0!==e.toolUse?t.toolUse(e.toolUse):void 0!==e.reasoningContent?t.reasoningContent(e.reasoningContent):void 0!==e.citation?t.citation(e.citation):t._(e.$unknown[0],e.$unknown[1])}(dN||(dN={})),function(e){e.visit=(e,t)=>void 0!==e.toolUse?t.toolUse(e.toolUse):t._(e.$unknown[0],e.$unknown[1])}(hN||(hN={}));class gN extends MR{name="ModelStreamErrorException";$fault="client";originalStatusCode;originalMessage;constructor(e){super({name:"ModelStreamErrorException",$fault:"client",...e}),Object.setPrototypeOf(this,gN.prototype),this.originalStatusCode=e.originalStatusCode,this.originalMessage=e.originalMessage}}!function(e){e.visit=(e,t)=>void 0!==e.messageStart?t.messageStart(e.messageStart):void 0!==e.contentBlockStart?t.contentBlockStart(e.contentBlockStart):void 0!==e.contentBlockDelta?t.contentBlockDelta(e.contentBlockDelta):void 0!==e.contentBlockStop?t.contentBlockStop(e.contentBlockStop):void 0!==e.messageStop?t.messageStop(e.messageStop):void 0!==e.metadata?t.metadata(e.metadata):void 0!==e.internalServerException?t.internalServerException(e.internalServerException):void 0!==e.modelStreamErrorException?t.modelStreamErrorException(e.modelStreamErrorException):void 0!==e.validationException?t.validationException(e.validationException):void 0!==e.throttlingException?t.throttlingException(e.throttlingException):void 0!==e.serviceUnavailableException?t.serviceUnavailableException(e.serviceUnavailableException):t._(e.$unknown[0],e.$unknown[1])}(pN||(pN={}));var mN,fN,yN;!function(e){e.visit=(e,t)=>void 0!==e.chunk?t.chunk(e.chunk):t._(e.$unknown[0],e.$unknown[1])}(mN||(mN={})),function(e){e.visit=(e,t)=>void 0!==e.chunk?t.chunk(e.chunk):void 0!==e.internalServerException?t.internalServerException(e.internalServerException):void 0!==e.modelStreamErrorException?t.modelStreamErrorException(e.modelStreamErrorException):void 0!==e.validationException?t.validationException(e.validationException):void 0!==e.throttlingException?t.throttlingException(e.throttlingException):void 0!==e.modelTimeoutException?t.modelTimeoutException(e.modelTimeoutException):void 0!==e.serviceUnavailableException?t.serviceUnavailableException(e.serviceUnavailableException):t._(e.$unknown[0],e.$unknown[1])}(fN||(fN={})),function(e){e.visit=(e,t)=>void 0!==e.chunk?t.chunk(e.chunk):void 0!==e.internalServerException?t.internalServerException(e.internalServerException):void 0!==e.modelStreamErrorException?t.modelStreamErrorException(e.modelStreamErrorException):void 0!==e.validationException?t.validationException(e.validationException):void 0!==e.throttlingException?t.throttlingException(e.throttlingException):void 0!==e.modelTimeoutException?t.modelTimeoutException(e.modelTimeoutException):void 0!==e.serviceUnavailableException?t.serviceUnavailableException(e.serviceUnavailableException):t._(e.$unknown[0],e.$unknown[1])}(yN||(yN={}));const vN=e=>void 0!==e.text?{text:e.text}:void 0!==e.image?{image:IM}:void 0!==e.$unknown?{[e.$unknown[0]]:"UNKNOWN"}:void 0,bN=e=>({...e,...e.content&&{content:e.content.map((e=>(e=>void 0!==e.text?{text:e.text}:void 0!==e.image?{image:e.image}:void 0!==e.document?{document:e.document}:void 0!==e.video?{video:e.video}:void 0!==e.toolUse?{toolUse:e.toolUse}:void 0!==e.toolResult?{toolResult:e.toolResult}:void 0!==e.guardContent?{guardContent:vN(e.guardContent)}:void 0!==e.cachePoint?{cachePoint:e.cachePoint}:void 0!==e.reasoningContent?{reasoningContent:IM}:void 0!==e.citationsContent?{citationsContent:e.citationsContent}:void 0!==e.$unknown?{[e.$unknown[0]]:"UNKNOWN"}:void 0)(e)))}}),CN=e=>void 0!==e.text?{text:e.text}:void 0!==e.guardContent?{guardContent:vN(e.guardContent)}:void 0!==e.cachePoint?{cachePoint:e.cachePoint}:void 0!==e.$unknown?{[e.$unknown[0]]:"UNKNOWN"}:void 0,wN=e=>({...e,...e.messages&&{messages:e.messages.map((e=>bN(e)))},...e.system&&{system:e.system.map((e=>CN(e)))},...e.toolConfig&&{toolConfig:e.toolConfig},...e.promptVariables&&{promptVariables:IM},...e.requestMetadata&&{requestMetadata:IM}}),SN=e=>void 0!==e.message?{message:bN(e.message)}:void 0!==e.$unknown?{[e.$unknown[0]]:"UNKNOWN"}:void 0,EN=e=>({...e,...e.output&&{output:SN(e.output)}}),xN=(e,t)=>(async(e=new Uint8Array,t)=>{if(e instanceof Uint8Array)return Sk.mutate(e);if(!e)return Sk.mutate(new Uint8Array);const n=t.streamCollector(e);return Sk.mutate(await n)})(e,t).then((e=>t.utf8Encoder(e))),IN=(e,t)=>xN(e,t).then((e=>{if(e.length)try{return JSON.parse(e)}catch(t){throw"SyntaxError"===t?.name&&Object.defineProperty(t,"$responseBodyText",{value:e}),t}return{}})),AN=async(e,t)=>{const n=await IN(e,t);return n.message=n.message??n.Message,n},PN=e=>{if(null!=e)return"object"==typeof e&&"__type"in e&&delete e.__type,(e=>{if(null==e)return;const t=Vk(e),n=Object.entries(t).filter((([,e])=>null!=e)).map((([e])=>e));if(0===n.length)throw new TypeError("Unions must have exactly one non-null member. None were found.");if(n.length>1)throw new TypeError(`Unions must have exactly one non-null member. Keys ${n} were not null.`);return t})(e)},kN=async(e,t)=>{const n=function(e,t){return new Jk(e,t)}(e,t);let r;return n.bp("/model/{modelId}/converse"),n.p("modelId",(()=>e.modelId),"{modelId}",!1),r=JSON.stringify(RM(e,{additionalModelRequestFields:e=>dO(e,t),additionalModelResponseFieldPaths:e=>UM(e),guardrailConfig:e=>UM(e),inferenceConfig:e=>$N(e,t),messages:e=>eO(e,t),performanceConfig:e=>UM(e),promptVariables:e=>UM(e),requestMetadata:e=>UM(e),system:e=>nO(e,t),toolConfig:e=>rO(e,t)})),n.m("POST").h({"content-type":"application/json"}).b(r),n.build()},TN=async(e,t)=>{if(200!==e.statusCode&&e.statusCode>=300)return DN(e,t);const n=LM({$metadata:OO(e)}),r=((e,t)=>{if(null==e){if(t)throw new TypeError(`Expected a non-null value for ${t}`);throw new TypeError("Expected a non-null value")}return e})(Vk(await IN(e.body,t)),"body"),s=RM(r,{additionalModelResponseFields:e=>NO(e,t),metrics:UM,output:e=>pO(PN(e),t),performanceConfig:UM,stopReason:qk,trace:e=>gO(e,t),usage:UM});return Object.assign(n,s),n},DN=async(e,t)=>{const n={...e,body:await AN(e.body,t)},r=((e,t)=>{const n=(e,t)=>Object.keys(e).find((e=>e.toLowerCase()===t.toLowerCase())),r=e=>{let t=e;return"number"==typeof t&&(t=t.toString()),t.indexOf(",")>=0&&(t=t.split(",")[0]),t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},s=n(e.headers,"x-amzn-errortype");if(void 0!==s)return r(e.headers[s]);if(t&&"object"==typeof t){const e=n(t,"code");if(e&&void 0!==t[e])return r(t[e]);if(void 0!==t.__type)return r(t.__type)}})(e,n.body);switch(r){case"AccessDeniedException":case"com.amazonaws.bedrockruntime#AccessDeniedException":throw await RN(n,t);case"InternalServerException":case"com.amazonaws.bedrockruntime#InternalServerException":throw await ON(n,t);case"ResourceNotFoundException":case"com.amazonaws.bedrockruntime#ResourceNotFoundException":throw await HN(n,t);case"ServiceQuotaExceededException":case"com.amazonaws.bedrockruntime#ServiceQuotaExceededException":throw await zN(n,t);case"ThrottlingException":case"com.amazonaws.bedrockruntime#ThrottlingException":throw await VN(n,t);case"ValidationException":case"com.amazonaws.bedrockruntime#ValidationException":throw await qN(n,t);case"ModelErrorException":case"com.amazonaws.bedrockruntime#ModelErrorException":throw await _N(n,t);case"ModelNotReadyException":case"com.amazonaws.bedrockruntime#ModelNotReadyException":throw await BN(n,t);case"ModelTimeoutException":case"com.amazonaws.bedrockruntime#ModelTimeoutException":throw await UN(n,t);case"ServiceUnavailableException":case"com.amazonaws.bedrockruntime#ServiceUnavailableException":throw await jN(n,t);case"ModelStreamErrorException":case"com.amazonaws.bedrockruntime#ModelStreamErrorException":throw await FN(n,t);case"ConflictException":case"com.amazonaws.bedrockruntime#ConflictException":throw await NN(n,t);default:const s=n.body;return MN({output:e,parsedBody:s,errorCode:r})}},MN=(LN=MR,({output:e,parsedBody:t,errorCode:n})=>{(({output:e,parsedBody:t,exceptionCtor:n,errorCode:r})=>{const s=kM(e),i=s.httpStatusCode?s.httpStatusCode+"":void 0,a=new n({name:t?.code||t?.Code||r||i||"UnknownError",$fault:"client",$metadata:s});throw PM(a,t)})({output:e,parsedBody:t,exceptionCtor:LN,errorCode:n})});var LN;const RN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new LR({$metadata:OO(e),...n});return PM(i,e.body)},NN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new BR({$metadata:OO(e),...n});return PM(i,e.body)},ON=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new NR({$metadata:OO(e),...n});return PM(i,e.body)},_N=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk,originalStatusCode:Hk,resourceName:qk});Object.assign(n,s);const i=new oN({$metadata:OO(e),...n});return PM(i,e.body)},BN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new lN({$metadata:OO(e),...n});return PM(i,e.body)},FN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk,originalMessage:qk,originalStatusCode:Hk});Object.assign(n,s);const i=new gN({$metadata:OO(e),...n});return PM(i,e.body)},UN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new cN({$metadata:OO(e),...n});return PM(i,e.body)},HN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new FR({$metadata:OO(e),...n});return PM(i,e.body)},zN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new UR({$metadata:OO(e),...n});return PM(i,e.body)},jN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new HR({$metadata:OO(e),...n});return PM(i,e.body)},VN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new OR({$metadata:OO(e),...n});return PM(i,e.body)},qN=async(e,t)=>{const n=LM({}),r=e.body,s=RM(r,{message:qk});Object.assign(n,s);const i=new _R({$metadata:OO(e),...n});return PM(i,e.body)},WN=(e,t)=>e.filter((e=>null!=e)).map((e=>((e,t)=>eN.visit(e,{cachePoint:e=>({cachePoint:UM(e)}),citationsContent:e=>({citationsContent:UM(e)}),document:e=>({document:QN(e,t)}),guardContent:e=>({guardContent:ZN(e,t)}),image:e=>({image:JN(e,t)}),reasoningContent:e=>({reasoningContent:tO(e,t)}),text:e=>({text:e}),toolResult:e=>({toolResult:sO(e,t)}),toolUse:e=>({toolUse:lO(e,t)}),video:e=>({video:cO(e,t)}),_:(e,t)=>({[e]:t})}))(e,t))),QN=(e,t)=>RM(e,{citations:UM,context:[],format:[],name:[],source:e=>GN(e,t)}),GN=(e,t)=>GR.visit(e,{bytes:e=>({bytes:t.base64Encoder(e)}),content:e=>({content:UM(e)}),s3Location:e=>({s3Location:UM(e)}),text:e=>({text:e}),_:(e,t)=>({[e]:t})}),ZN=(e,t)=>YR.visit(e,{image:e=>({image:YN(e,t)}),text:e=>({text:UM(e)}),_:(e,t)=>({[e]:t})}),YN=(e,t)=>RM(e,{format:[],source:e=>KN(e,t)}),KN=(e,t)=>ZR.visit(e,{bytes:e=>({bytes:t.base64Encoder(e)}),_:(e,t)=>({[e]:t})}),JN=(e,t)=>RM(e,{format:[],source:e=>XN(e,t)}),XN=(e,t)=>KR.visit(e,{bytes:e=>({bytes:t.base64Encoder(e)}),s3Location:e=>({s3Location:UM(e)}),_:(e,t)=>({[e]:t})}),$N=(e,t)=>RM(e,{maxTokens:[],stopSequences:UM,temperature:FM,topP:FM}),eO=(e,t)=>e.filter((e=>null!=e)).map((e=>((e,t)=>RM(e,{content:e=>WN(e,t),role:[]}))(e,t))),tO=(e,t)=>JR.visit(e,{reasoningText:e=>({reasoningText:UM(e)}),redactedContent:e=>({redactedContent:t.base64Encoder(e)}),_:(e,t)=>({[e]:t})}),nO=(e,t)=>e.filter((e=>null!=e)).map((e=>((e,t)=>nN.visit(e,{cachePoint:e=>({cachePoint:UM(e)}),guardContent:e=>({guardContent:ZN(e,t)}),text:e=>({text:e}),_:(e,t)=>({[e]:t})}))(e,t))),rO=(e,t)=>RM(e,{toolChoice:UM,tools:e=>aO(e,t)}),sO=(e,t)=>RM(e,{content:e=>iO(e,t),status:[],toolUseId:[]}),iO=(e,t)=>e.filter((e=>null!=e)).map((e=>((e,t)=>$R.visit(e,{document:e=>({document:QN(e,t)}),image:e=>({image:JN(e,t)}),json:e=>({json:dO(e,t)}),text:e=>({text:e}),video:e=>({video:cO(e,t)}),_:(e,t)=>({[e]:t})}))(e,t))),aO=(e,t)=>e.filter((e=>null!=e)).map((e=>((e,t)=>iN.visit(e,{cachePoint:e=>({cachePoint:UM(e)}),toolSpec:e=>({toolSpec:oO(e,t)}),_:(e,t)=>({[e]:t})}))(e,t))),oO=(e,t)=>RM(e,{description:[],inputSchema:e=>((e,t)=>sN.visit(e,{json:e=>({json:dO(e,t)}),_:(e,t)=>({[e]:t})}))(e,t),name:[]}),lO=(e,t)=>RM(e,{input:e=>dO(e,t),name:[],toolUseId:[]}),cO=(e,t)=>RM(e,{format:[],source:e=>uO(e,t)}),uO=(e,t)=>XR.visit(e,{bytes:e=>({bytes:t.base64Encoder(e)}),s3Location:e=>({s3Location:UM(e)}),_:(e,t)=>({[e]:t})}),dO=(e,t)=>e,hO=(e,t)=>{const n=(e||[]).filter((e=>null!=e)).map((e=>((e,t)=>null!=e.cachePoint?{cachePoint:UM(e.cachePoint)}:null!=e.citationsContent?{citationsContent:UM(e.citationsContent)}:null!=e.document?{document:mO(e.document,t)}:null!=e.guardContent?{guardContent:wO(PN(e.guardContent),t)}:null!=e.image?{image:IO(e.image,t)}:null!=e.reasoningContent?{reasoningContent:kO(PN(e.reasoningContent),t)}:void 0!==qk(e.text)?{text:qk(e.text)}:null!=e.toolResult?{toolResult:TO(e.toolResult,t)}:null!=e.toolUse?{toolUse:MO(e.toolUse,t)}:null!=e.video?{video:LO(e.video,t)}:{$unknown:Object.entries(e)[0]})(PN(e),t)));return n},pO=(e,t)=>null!=e.message?{message:PO(e.message,t)}:{$unknown:Object.entries(e)[0]},gO=(e,t)=>RM(e,{guardrail:e=>xO(e,t),promptRouter:UM}),mO=(e,t)=>RM(e,{citations:UM,context:qk,format:qk,name:qk,source:e=>fO(PN(e),t)}),fO=(e,t)=>null!=e.bytes?{bytes:t.base64Decoder(e.bytes)}:null!=e.content?{content:UM(e.content)}:null!=e.s3Location?{s3Location:UM(e.s3Location)}:void 0!==qk(e.text)?{text:qk(e.text)}:{$unknown:Object.entries(e)[0]},yO=(e,t)=>RM(e,{contentPolicy:UM,contextualGroundingPolicy:e=>CO(e,t),invocationMetrics:UM,sensitiveInformationPolicy:UM,topicPolicy:UM,wordPolicy:UM}),vO=(e,t)=>{const n=(e||[]).filter((e=>null!=e)).map((e=>yO(e,t)));return n},bO=(e,t)=>{const n=(e||[]).filter((e=>null!=e)).map((e=>(e=>RM(e,{action:qk,detected:Bk,score:Wk,threshold:Wk,type:qk}))(e)));return n},CO=(e,t)=>RM(e,{filters:e=>bO(e)}),wO=(e,t)=>null!=e.image?{image:SO(e.image,t)}:null!=e.text?{text:UM(e.text)}:{$unknown:Object.entries(e)[0]},SO=(e,t)=>RM(e,{format:qk,source:e=>EO(PN(e),t)}),EO=(e,t)=>null!=e.bytes?{bytes:t.base64Decoder(e.bytes)}:{$unknown:Object.entries(e)[0]},xO=(e,t)=>RM(e,{actionReason:qk,inputAssessment:e=>((e,t)=>Object.entries(e).reduce(((e,[n,r])=>(null===r||(e[n]=yO(r,t)),e)),{}))(e,t),modelOutput:UM,outputAssessments:e=>((e,t)=>Object.entries(e).reduce(((e,[n,r])=>(null===r||(e[n]=vO(r,t)),e)),{}))(e,t)}),IO=(e,t)=>RM(e,{format:qk,source:e=>AO(PN(e),t)}),AO=(e,t)=>null!=e.bytes?{bytes:t.base64Decoder(e.bytes)}:null!=e.s3Location?{s3Location:UM(e.s3Location)}:{$unknown:Object.entries(e)[0]},PO=(e,t)=>RM(e,{content:e=>hO(e,t),role:qk}),kO=(e,t)=>null!=e.reasoningText?{reasoningText:UM(e.reasoningText)}:null!=e.redactedContent?{redactedContent:t.base64Decoder(e.redactedContent)}:{$unknown:Object.entries(e)[0]},TO=(e,t)=>RM(e,{content:e=>DO(e,t),status:qk,toolUseId:qk}),DO=(e,t)=>{const n=(e||[]).filter((e=>null!=e)).map((e=>((e,t)=>null!=e.document?{document:mO(e.document,t)}:null!=e.image?{image:IO(e.image,t)}:null!=e.json?{json:NO(e.json,t)}:void 0!==qk(e.text)?{text:qk(e.text)}:null!=e.video?{video:LO(e.video,t)}:{$unknown:Object.entries(e)[0]})(PN(e),t)));return n},MO=(e,t)=>RM(e,{input:e=>NO(e,t),name:qk,toolUseId:qk}),LO=(e,t)=>RM(e,{format:qk,source:e=>RO(PN(e),t)}),RO=(e,t)=>null!=e.bytes?{bytes:t.base64Decoder(e.bytes)}:null!=e.s3Location?{s3Location:UM(e.s3Location)}:{$unknown:Object.entries(e)[0]},NO=(e,t)=>e,OO=e=>({httpStatusCode:e.statusCode,requestId:e.headers["x-amzn-requestid"]??e.headers["x-amzn-request-id"]??e.headers["x-amz-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]});class _O extends(EM.classBuilder().ep(kL).m((function(e,t,n,r){return[uk(n,this.serialize,this.deserialize),KD(n,e.getEndpointParameterInstructions())]})).s("AmazonBedrockFrontendService","Converse",{}).n("BedrockRuntimeClient","ConverseCommand").f(wN,EN).ser(kN).de(TN).build()){}const BO=e=>{if("text"in e)return{rawOutput:e.text,type:"output_text",content:[{type:"text",text:e.text}]};if("toolUse"in e){const t=e.toolUse;return{rawOutput:t,type:"function_call",name:t.name,arguments:t.input,callId:t.toolUseId}}return{rawOutput:e,type:"unknown"}};class FO{constructor(e=[]){this.history=e}addStateToRequest(e){const t=this.history.map((e=>"user"===e.role?{role:"user",content:e.rawParam.content}:{role:"assistant",content:[e.rawMessage]}));return e.messages=[...t,...e.messages],e}lastOutputs(){const e=[];for(let t=this.history.length-1;t>=0;t--){const n=this.history[t];if("assistant"!==n.role)break;e.push(n)}e.reverse();const t=[];for(const n of e)t.push(BO(n.rawMessage));return t}}var UO=n(58651);const HO=e=>({toolSpec:{name:e.name,inputSchema:{json:e.inputSchema},description:e.description}});class zO{constructor(e){if(this.opts=e,!e.apiAuth||2!==e.apiAuth.length)throw new Error("AWS authentication details are incomplete");this.client=new DR({region:this.opts.region,credentials:{accessKeyId:this.opts.apiAuth[0],secretAccessKey:this.opts.apiAuth[1]}})}prepareBedrockInput(e){if("string"==typeof e){return[{role:"user",content:[{text:e}]}]}return e}async makeRequest(e,t,n,r){const s=this.prepareBedrockInput(e),i={modelId:this.opts.modelName,messages:s,toolConfig:{tools:t.map(HO)},inferenceConfig:{maxTokens:this.opts.maxTokens}},a=n??new FO([]);await a.addStateToRequest(i);const o=new _O(i);try{const e=(await this.client.send(o)).output.message,t=s.map((e=>({role:"user",rawParam:e}))),n=e?.content?.map((e=>({role:"assistant",rawMessage:e})));if(void 0===n)throw new Error("No response from aws");return new FO([...a.history,...t,...n])}catch(e){throw UO.error("Error in bedrock call",e),e}}convertToolOutputToBackendInput(e,t){let n=JSON.parse(t);return n?.content||"string"!=typeof t||(n={content:[{type:"text",text:t}]}),[{role:"user",content:[{toolResult:{toolUseId:e.callId,content:[{json:n.content[0]}]}}]}]}}const jO="RFC3986",VO={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:e=>String(e)},qO=(Object.prototype.hasOwnProperty,Array.isArray),WO=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();const QO=1024;function GO(e,t){if(qO(e)){const n=[];for(let r=0;r<e.length;r+=1)n.push(t(e[r]));return n}return t(e)}const ZO=Object.prototype.hasOwnProperty,YO={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},KO=Array.isArray,JO=Array.prototype.push,XO=function(e,t){JO.apply(e,KO(t)?t:[t])},$O=Date.prototype.toISOString,e_={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,n,r,s)=>{if(0===e.length)return e;let i=e;if("symbol"==typeof e?i=Symbol.prototype.toString.call(e):"string"!=typeof e&&(i=String(e)),"iso-8859-1"===n)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));let a="";for(let e=0;e<i.length;e+=QO){const t=i.length>=QO?i.slice(e,e+QO):i,n=[];for(let e=0;e<t.length;++e){let r=t.charCodeAt(e);45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||"RFC1738"===s&&(40===r||41===r)?n[n.length]=t.charAt(e):r<128?n[n.length]=WO[r]:r<2048?n[n.length]=WO[192|r>>6]+WO[128|63&r]:r<55296||r>=57344?n[n.length]=WO[224|r>>12]+WO[128|r>>6&63]+WO[128|63&r]:(e+=1,r=65536+((1023&r)<<10|1023&t.charCodeAt(e)),n[n.length]=WO[240|r>>18]+WO[128|r>>12&63]+WO[128|r>>6&63]+WO[128|63&r])}a+=n.join("")}return a},encodeValuesOnly:!1,format:jO,formatter:VO[jO],indices:!1,serializeDate:e=>$O.call(e),skipNulls:!1,strictNullHandling:!1};const t_={};function n_(e,t,n,r,s,i,a,o,l,c,u,d,h,p,g,m,f,y){let v=e,b=y,C=0,w=!1;for(;void 0!==(b=b.get(t_))&&!w;){const t=b.get(e);if(C+=1,void 0!==t){if(t===C)throw new RangeError("Cyclic object value");w=!0}void 0===b.get(t_)&&(C=0)}if("function"==typeof c?v=c(t,v):v instanceof Date?v=h?.(v):"comma"===n&&KO(v)&&(v=GO(v,(function(e){return e instanceof Date?h?.(e):e}))),null===v){if(i)return l&&!m?l(t,e_.encoder,f,"key",p):t;v=""}if(function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e||"symbol"==typeof e||"bigint"==typeof e}(v)||function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))}(v)){if(l){const e=m?t:l(t,e_.encoder,f,"key",p);return[g?.(e)+"="+g?.(l(v,e_.encoder,f,"value",p))]}return[g?.(t)+"="+g?.(String(v))]}const S=[];if(void 0===v)return S;let E;if("comma"===n&&KO(v))m&&l&&(v=GO(v,l)),E=[{value:v.length>0?v.join(",")||null:void 0}];else if(KO(c))E=c;else{const e=Object.keys(v);E=u?e.sort(u):e}const x=o?String(t).replace(/\./g,"%2E"):String(t),I=r&&KO(v)&&1===v.length?x+"[]":x;if(s&&KO(v)&&0===v.length)return I+"[]";for(let t=0;t<E.length;++t){const b=E[t],w="object"==typeof b&&void 0!==b.value?b.value:v[b];if(a&&null===w)continue;const x=d&&o?b.replace(/\./g,"%2E"):b,A=KO(v)?"function"==typeof n?n(I,x):I:I+(d?"."+x:"["+x+"]");y.set(e,C);const P=new WeakMap;P.set(t_,y),XO(S,n_(w,A,n,r,s,i,a,o,"comma"===n&&m&&KO(v)?null:l,c,u,d,h,p,g,m,f,P))}return S}function r_(e,t={}){let n=e;const r=function(e=e_){if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");const t=e.charset||e_.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=jO;if(void 0!==e.format){if(!ZO.call(VO,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const r=VO[n];let s,i=e_.filter;if(("function"==typeof e.filter||KO(e.filter))&&(i=e.filter),s=e.arrayFormat&&e.arrayFormat in YO?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":e_.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=void 0===e.allowDots?1==!!e.encodeDotInKeys||e_.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:e_.addQueryPrefix,allowDots:a,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:e_.allowEmptyArrays,arrayFormat:s,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:e_.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?e_.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:e_.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:e_.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:e_.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:e_.encodeValuesOnly,filter:i,format:n,formatter:r,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:e_.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:e_.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:e_.strictNullHandling}}(t);let s,i;"function"==typeof r.filter?(i=r.filter,n=i("",n)):KO(r.filter)&&(i=r.filter,s=i);const a=[];if("object"!=typeof n||null===n)return"";const o=YO[r.arrayFormat],l="comma"===o&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const c=new WeakMap;for(let e=0;e<s.length;++e){const t=s[e];r.skipNulls&&null===n[t]||XO(a,n_(n[t],t,o,l,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,c))}const u=a.join(r.delimiter);let d=!0===r.addQueryPrefix?"?":"";return r.charsetSentinel&&("iso-8859-1"===r.charset?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),u.length>0?d+u:""}const s_="4.98.0";let i_,a_,o_,l_,c_,u_,d_,h_,p_,g_=!1,m_=null,f_=null,y_=null,v_=null;class b_{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}const C_=()=>{i_||function(e,t={auto:!1}){if(g_)throw new Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(i_)throw new Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${i_}'\``);g_=t.auto,i_=e.kind,a_=e.fetch,m_=e.Request,f_=e.Response,y_=e.Headers,o_=e.FormData,v_=e.Blob,l_=e.File,c_=e.ReadableStream,u_=e.getMultipartRequestOptions,d_=e.getDefaultAgent,h_=e.fileFromPath,p_=e.isFsReadStream}(function({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(e){throw new Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${t}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${t}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${t}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${t}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${t}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new b_(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0})};C_();class w_ extends Error{}class S_ extends w_{constructor(e,t,n,r){super(`${S_.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r?.["x-request-id"],this.error=t;const s=t;this.code=s?.code,this.param=s?.param,this.type=s?.type}static makeMessage(e,t,n){const r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new x_({message:n,cause:DB(t)});const s=t?.error;return 400===e?new A_(e,s,n,r):401===e?new P_(e,s,n,r):403===e?new k_(e,s,n,r):404===e?new T_(e,s,n,r):409===e?new D_(e,s,n,r):422===e?new M_(e,s,n,r):429===e?new L_(e,s,n,r):e>=500?new R_(e,s,n,r):new S_(e,s,n,r)}}class E_ extends S_{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class x_ extends S_{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class I_ extends x_{constructor({message:e}={}){super({message:e??"Request timed out."})}}class A_ extends S_{}class P_ extends S_{}class k_ extends S_{}class T_ extends S_{}class D_ extends S_{}class M_ extends S_{}class L_ extends S_{}class R_ extends S_{}class N_ extends w_{constructor(){super("Could not parse response content as the length limit was reached")}}class O_ extends w_{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var __,B_=n(37542).Buffer,F_=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},U_=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class H_{constructor(){__.set(this,void 0),this.buffer=new Uint8Array,F_(this,__,null,"f")}decode(e){if(null==e)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?(new TextEncoder).encode(e):e;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const r=[];let s;for(;null!=(s=z_(this.buffer,U_(this,__,"f")));){if(s.carriage&&null==U_(this,__,"f")){F_(this,__,s.index,"f");continue}if(null!=U_(this,__,"f")&&(s.index!==U_(this,__,"f")+1||s.carriage)){r.push(this.decodeText(this.buffer.slice(0,U_(this,__,"f")-1))),this.buffer=this.buffer.slice(U_(this,__,"f")),F_(this,__,null,"f");continue}const e=null!==U_(this,__,"f")?s.preceding-1:s.preceding,t=this.decodeText(this.buffer.slice(0,e));r.push(t),this.buffer=this.buffer.slice(s.index),F_(this,__,null,"f")}return r}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if(void 0!==B_){if(e instanceof B_)return e.toString();if(e instanceof Uint8Array)return B_.from(e).toString();throw new w_(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new w_(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new w_("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode("\n"):[]}}function z_(e,t){for(let n=t??0;n<e.length;n++){if(10===e[n])return{preceding:n,index:n+1,carriage:!1};if(13===e[n])return{preceding:n,index:n+1,carriage:!0}}return null}function j_(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1])return t+2;if(13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return-1}function V_(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){const e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}__=new WeakMap,H_.NEWLINE_CHARS=new Set(["\n","\r"]),H_.NEWLINE_REGEXP=/\r\n|[\n\r]/g;var q_=n(58651);class W_{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;return new W_((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const n of async function*(e,t){if(!e.body)throw t.abort(),new w_("Attempted to iterate over a response with no body");const n=new Q_,r=new H_,s=V_(e.body);for await(const e of async function*(e){let t=new Uint8Array;for await(const n of e){if(null==n)continue;const e=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?(new TextEncoder).encode(n):n;let r,s=new Uint8Array(t.length+e.length);for(s.set(t),s.set(e,t.length),t=s;-1!==(r=j_(t));)yield t.slice(0,r),t=t.slice(r)}t.length>0&&(yield t)}(s))for(const t of r.decode(e)){const e=n.decode(t);e&&(yield e)}for(const e of r.flush()){const t=n.decode(e);t&&(yield t)}}(e,t))if(!r)if(n.data.startsWith("[DONE]"))r=!0;else if(null===n.event||n.event.startsWith("response.")||n.event.startsWith("transcript.")){let t;try{t=JSON.parse(n.data)}catch(e){throw q_.error("Could not parse message into JSON:",n.data),q_.error("From chunk:",n.raw),e}if(t&&t.error)throw new S_(void 0,t.error,void 0,yB(e.headers));yield t}else{let e;try{e=JSON.parse(n.data)}catch(e){throw q_.error("Could not parse message into JSON:",n.data),q_.error("From chunk:",n.raw),e}if("error"==n.event)throw new S_(void 0,e.error,e.message,void 0);yield{event:n.event,data:e}}r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}}),t)}static fromReadableStream(e,t){let n=!1;return new W_((async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(const t of async function*(){const t=new H_,n=V_(e);for await(const e of n)for(const n of t.decode(e))yield n;for(const e of t.flush())yield e}())r||t&&(yield JSON.parse(t));r=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{r||t.abort()}}),t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();e.push(r),t.push(r)}return r.shift()}});return[new W_((()=>r(e)),this.controller),new W_((()=>r(t)),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new c_({async start(){t=e[Symbol.asyncIterator]()},async pull(e){try{const{value:r,done:s}=await t.next();if(s)return e.close();const i=n.encode(JSON.stringify(r)+"\n");e.enqueue(i)}catch(t){e.error(t)}},async cancel(){await(t.return?.())}})}}class Q_{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=function(e,t){const n=e.indexOf(t);if(-1!==n)return[e.substring(0,n),t,e.substring(n+t.length)];return[e,"",""]}(e,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===t?this.event=r:"data"===t&&this.data.push(r),null}}var G_=n(37542).Buffer;const Z_=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,Y_=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&K_(e),K_=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,J_=e=>Y_(e)||Z_(e)||p_(e);async function X_(e,t,n){if(e=await e,Y_(e))return e;if(Z_(e)){const r=await e.blob();t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file");const s=K_(r)?[await r.arrayBuffer()]:[r];return new l_(s,t,n)}const r=await async function(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(K_(e))t.push(await e.arrayBuffer());else{if(!eB(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){const t=Object.getOwnPropertyNames(e);return`[${t.map((e=>`"${e}"`)).join(", ")}]`}(e)}`);for await(const n of e)t.push(n)}return t}(e);if(t||(t=function(e){return $_(e.name)||$_(e.filename)||$_(e.path)?.split(/[\\/]/).pop()}(e)??"unknown_file"),!n?.type){const e=r[0]?.type;"string"==typeof e&&(n={...n,type:e})}return new l_(r,t,n)}const $_=e=>"string"==typeof e?e:void 0!==G_&&e instanceof G_?String(e):void 0,eB=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],tB=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],nB=async e=>{const t=await rB(e.body);return u_(t,e)},rB=async e=>{const t=new o_;return await Promise.all(Object.entries(e||{}).map((([e,n])=>sB(t,e,n)))),t},sB=async(e,t,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)e.append(t,String(n));else if(J_(n)){const r=await X_(n);e.append(t,r)}else if(Array.isArray(n))await Promise.all(n.map((n=>sB(e,t+"[]",n))));else{if("object"!=typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map((([n,r])=>sB(e,`${t}[${n}]`,r))))}}};var iB,aB=n(37542).Buffer,oB=n(72715),lB=n(58651),cB=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},uB=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};async function dB(e){const{response:t}=e;if(e.options.stream)return _B("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller):W_.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;const n=t.headers.get("content-type"),r=n?.split(";")[0]?.trim();if(r?.includes("application/json")||r?.endsWith("+json")){const e=await t.json();return _B("response",t.status,t.url,t.headers,e),hB(e,t)}const s=await t.text();return _B("response",t.status,t.url,t.headers,s),s}function hB(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}C_();class pB extends Promise{constructor(e,t=dB){super((e=>{e(null)})),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new pB(this.responsePromise,(async t=>hB(e(await this.parseResponse(t),t),t.response)))}asResponse(){return this.responsePromise.then((e=>e.response))}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class gB{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:s}){this.baseURL=e,this.maxRetries=TB("maxRetries",t),this.timeout=TB("timeout",n),this.httpAgent=r,this.fetch=s??a_}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...xB(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${BB()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then((async n=>{const r=n&&K_(n?.body)?new DataView(await n.body.arrayBuffer()):n?.body instanceof DataView?n.body:n?.body instanceof ArrayBuffer?new DataView(n.body):n&&ArrayBuffer.isView(n?.body)?new DataView(n.body.buffer):n?.body;return{method:e,path:t,...n,body:r}})))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if("string"==typeof e){if(void 0!==aB)return aB.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder){return(new TextEncoder).encode(e).length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){const n={...e},{method:r,path:s,query:i,headers:a={}}=n,o=ArrayBuffer.isView(n.body)||n.__binaryRequest&&"string"==typeof n.body?n.body:tB(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,l=this.calculateContentLength(o),c=this.buildURL(s,i);"timeout"in n&&TB("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const u=n.httpAgent??this.httpAgent??d_(c),d=n.timeout+1e3;"number"==typeof u?.options?.timeout&&d>(u.options.timeout??0)&&(u.options.timeout=d),this.idempotencyHeader&&"get"!==r&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);return{req:{method:r,...o&&{body:o},headers:this.buildHeaders({options:n,headers:a,contentLength:l,retryCount:t}),...u&&{agent:u},signal:n.signal??null},url:c,timeout:n.timeout}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const s={};n&&(s["content-length"]=n);const i=this.defaultHeaders(e);return NB(s,i),NB(s,t),tB(e.body)&&"node"!==i_&&delete s["content-type"],void 0===FB(i,"x-stainless-retry-count")&&void 0===FB(t,"x-stainless-retry-count")&&(s["x-stainless-retry-count"]=String(r)),void 0===FB(i,"x-stainless-timeout")&&void 0===FB(t,"x-stainless-timeout")&&e.timeout&&(s["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(s,t),s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map((e=>[...e]))):{...e}:{}}makeStatusError(e,t,n,r){return S_.generate(e,t,n,r)}request(e,t=null){return new pB(this.makeRequest(e,t))}async makeRequest(e,t){const n=await e,r=n.maxRetries??this.maxRetries;null==t&&(t=r),await this.prepareOptions(n);const{req:s,url:i,timeout:a}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(s,{url:i,options:n}),_B("request",i,n,s.headers),n.signal?.aborted)throw new E_;const o=new AbortController,l=await this.fetchWithTimeout(i,s,a,o).catch(DB);if(l instanceof Error){if(n.signal?.aborted)throw new E_;if(t)return this.retryRequest(n,t);if("AbortError"===l.name)throw new I_;throw new x_({cause:l})}const c=yB(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){return _B(`response (error; ${`retrying, ${t} attempts remaining`})`,l.status,i,c),this.retryRequest(n,t,c)}const e=await l.text().catch((e=>DB(e).message)),r=IB(e),s=r?void 0:e;_B(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,c,s);throw this.makeStatusError(l.status,r,s,c)}return{response:l,options:n,controller:o}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new fB(this,n,e)}buildURL(e,t){const n=PB(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return LB(r)||(t={...r,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new w_(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:s,...i}=t||{};s&&s.addEventListener("abort",(()=>r.abort()));const a=setTimeout((()=>r.abort()),n),o={signal:r.signal,...i};return o.method&&(o.method=o.method.toUpperCase()),this.fetch.call(void 0,e,o).finally((()=>{clearTimeout(a)}))}shouldRetry(e){const t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||(409===e.status||(429===e.status||e.status>=500)))}async retryRequest(e,t,n){let r;const s=n?.["retry-after-ms"];if(s){const e=parseFloat(s);Number.isNaN(e)||(r=e)}const i=n?.["retry-after"];if(i&&!r){const e=parseFloat(i);r=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(r&&0<=r&&r<6e4)){const n=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,n)}return await kB(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const n=t-e;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${s_}`}}class mB{constructor(e,t,n,r){iB.set(this,void 0),cB(this,iB,e,"f"),this.options=r,this.response=t,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new w_("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[t,r]of n)e.url.searchParams.set(t,r);t.query=void 0,t.path=e.url.toString()}return await uB(this,iB,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(iB=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class fB extends pB{constructor(e,t,n){super(t,(async t=>new n(e,t.response,await dB(t),t.options)))}async*[Symbol.asyncIterator](){const e=await(this);for await(const t of e)yield t}}const yB=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),vB={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},bB=e=>"object"==typeof e&&null!==e&&!LB(e)&&Object.keys(e).every((e=>RB(vB,e))),CB=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":s_,"X-Stainless-OS":SB(Deno.build.os),"X-Stainless-Arch":wB(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":s_,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":oB.version};if("[object process]"===Object.prototype.toString.call(void 0!==oB?oB:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":s_,"X-Stainless-OS":SB(oB.platform),"X-Stainless-Arch":wB(oB.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":oB.version};const e=function(){if("undefined"==typeof navigator||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const e=n.exec(navigator.userAgent);if(e){return{browser:t,version:`${e[1]||0}.${e[2]||0}.${e[3]||0}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":s_,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":s_,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const wB=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",SB=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";let EB;const xB=()=>EB??(EB=CB()),IB=e=>{try{return JSON.parse(e)}catch(e){return}},AB=/^[a-z][a-z0-9+.-]*:/i,PB=e=>AB.test(e),kB=e=>new Promise((t=>setTimeout(t,e))),TB=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new w_(`${e} must be an integer`);if(t<0)throw new w_(`${e} must be a positive integer`);return t},DB=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e)try{return new Error(JSON.stringify(e))}catch{}return new Error(e)},MB=e=>void 0!==oB?oB.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function LB(e){if(!e)return!0;for(const t in e)return!1;return!0}function RB(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function NB(e,t){for(const n in t){if(!RB(t,n))continue;const r=n.toLowerCase();if(!r)continue;const s=t[n];null===s?delete e[r]:void 0!==s&&(e[r]=s)}}const OB=new Set(["authorization","api-key"]);function _B(e,...t){if(void 0!==oB&&"true"===oB?.env?.DEBUG){const n=t.map((e=>{if(!e)return e;if(e.headers){const t={...e,headers:{...e.headers}};for(const n in e.headers)OB.has(n.toLowerCase())&&(t.headers[n]="REDACTED");return t}let t=null;for(const n in e)OB.has(n.toLowerCase())&&(t??(t={...e}),t[n]="REDACTED");return t??e}));lB.log(`OpenAI:DEBUG:${e}`,...n)}}const BB=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),FB=(e,t)=>{const n=t.toLowerCase();if((e=>"function"==typeof e?.get)(e)){const r=t[0]?.toUpperCase()+t.substring(1).replace(/([^\w])(\w)/g,((e,t,n)=>t+n.toUpperCase()));for(const s of[t,n,t.toUpperCase(),r]){const t=e.get(s);if(t)return t}}for(const[r,s]of Object.entries(e))if(r.toLowerCase()===n)return Array.isArray(s)?(s.length<=1||lB.warn(`Received ${s.length} entries for the ${t} header, using the first entry.`),s[0]):s};function UB(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}class HB{constructor(e){this._client=e}}class zB extends HB{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class jB extends HB{list(e,t={},n){return bB(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,GB,{query:t,...n})}}class VB extends mB{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class qB extends mB{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const t=e[e.length-1]?.id;return t?{params:{after:t}}:null}}class WB extends HB{constructor(){super(...arguments),this.messages=new jB(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return bB(e)?this.list({},e):this._client.getAPIList("/chat/completions",QB,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}}class QB extends qB{}class GB extends qB{}WB.ChatCompletionsPage=QB,WB.Messages=jB;class ZB extends HB{constructor(){super(...arguments),this.completions=new WB(this._client)}}ZB.Completions=WB,ZB.ChatCompletionsPage=QB;class YB extends HB{create(e,t){const n=!!e.encoding_format;let r=n?e.encoding_format:"base64";n&&_B("Request","User defined encoding_format:",e.encoding_format);const s=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?s:(_B("response","Decoding base64 embeddings to float32 array"),s._thenUnwrap((e=>(e&&e.data&&e.data.forEach((e=>{const t=e.embedding;e.embedding=(e=>{if(void 0!==aB){const t=aB.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return Array.from(new Float32Array(r.buffer))}})(t)})),e))))}}class KB extends HB{create(e,t){return this._client.post("/files",nB({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return bB(e)?this.list({},e):this._client.getAPIList("/files",JB,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t?.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),s=Date.now();let i=await this.retrieve(e);for(;!i.status||!r.has(i.status);)if(await kB(t),i=await this.retrieve(e),Date.now()-s>n)throw new I_({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}}class JB extends qB{}KB.FileObjectsPage=JB;class XB extends HB{createVariation(e,t){return this._client.post("/images/variations",nB({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",nB({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class $B extends HB{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t?.headers},__binaryResponse:!0})}}class eF extends HB{create(e,t){return this._client.post("/audio/transcriptions",nB({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class tF extends HB{create(e,t){return this._client.post("/audio/translations",nB({body:e,...t,__metadata:{model:e.model}}))}}class nF extends HB{constructor(){super(...arguments),this.transcriptions=new eF(this._client),this.translations=new tF(this._client),this.speech=new $B(this._client)}}nF.Transcriptions=eF,nF.Translations=tF,nF.Speech=$B;class rF extends HB{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class sF extends HB{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",iF,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class iF extends VB{}sF.ModelsPage=iF;class aF extends HB{}class oF extends HB{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}class lF extends HB{constructor(){super(...arguments),this.graders=new oF(this._client)}}lF.Graders=oF;class cF extends HB{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,uF,{body:t,method:"post",...n})}retrieve(e,t={},n){return bB(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}del(e,t,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,n)}}class uF extends VB{}cF.PermissionCreateResponsesPage=uF;class dF extends HB{constructor(){super(...arguments),this.permissions=new cF(this._client)}}dF.Permissions=cF,dF.PermissionCreateResponsesPage=uF;class hF extends HB{list(e,t={},n){return bB(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,pF,{query:t,...n})}}class pF extends qB{}hF.FineTuningJobCheckpointsPage=pF;class gF extends HB{constructor(){super(...arguments),this.checkpoints=new hF(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return bB(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",mF,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return bB(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,fF,{query:t,...n})}pause(e,t){return this._client.post(`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(`/fine_tuning/jobs/${e}/resume`,t)}}class mF extends qB{}class fF extends qB{}gF.FineTuningJobsPage=mF,gF.FineTuningJobEventsPage=fF,gF.Checkpoints=hF,gF.FineTuningJobCheckpointsPage=pF;class yF extends HB{constructor(){super(...arguments),this.methods=new aF(this._client),this.jobs=new gF(this._client),this.checkpoints=new dF(this._client),this.alpha=new lF(this._client)}}yF.Methods=aF,yF.Jobs=gF,yF.FineTuningJobsPage=mF,yF.FineTuningJobEventsPage=fF,yF.Checkpoints=dF,yF.Alpha=lF;class vF extends HB{}class bF extends HB{constructor(){super(...arguments),this.graderModels=new vF(this._client)}}bF.GraderModels=vF;var CF=n(58651);class wF extends HB{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return bB(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,SF,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const s=await this.retrieve(e,t,{...n,headers:r}).withResponse(),i=s.data;switch(i.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=s.response.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await kB(e);break;case"failed":case"completed":return i}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,EF,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class SF extends qB{}class EF extends VB{}wF.VectorStoreFilesPage=SF,wF.FileContentResponsesPage=EF;class xF extends HB{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return bB(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,SF,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:i}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(s.status){case"in_progress":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=i.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await kB(e);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(null==t||0==t.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=r?.maxConcurrency??5,i=Math.min(s,t.length),a=this._client,o=t.values(),l=[...n];const c=Array(i).fill(o).map((async function(e){for(let t of e){const e=await a.files.create({file:t,purpose:"assistants"},r);l.push(e.id)}}));return await(async e=>{const t=await Promise.allSettled(e),n=t.filter((e=>"rejected"===e.status));if(n.length){for(const e of n)CF.error(e.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const e of t)"fulfilled"===e.status&&r.push(e.value);return r})(c),await this.createAndPoll(e,{file_ids:l})}}class IF extends HB{constructor(){super(...arguments),this.files=new wF(this._client),this.fileBatches=new xF(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return bB(e)?this.list({},e):this._client.getAPIList("/vector_stores",AF,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,PF,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class AF extends qB{}class PF extends VB{}IF.VectorStoresPage=AF,IF.VectorStoreSearchResponsesPage=PF,IF.Files=wF,IF.VectorStoreFilesPage=SF,IF.FileContentResponsesPage=EF,IF.FileBatches=xF;class kF extends HB{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(e={},t){return bB(e)?this.list({},e):this._client.getAPIList("/assistants",TF,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class TF extends qB{}function DF(e){return"function"==typeof e.parse}kF.AssistantsPage=TF;const MF=e=>"assistant"===e?.role,LF=e=>"function"===e?.role,RF=e=>"tool"===e?.role;var NF,OF,_F,BF,FF,UF,HF,zF,jF,VF,qF,WF,QF,GF=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},ZF=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class YF{constructor(){NF.add(this),this.controller=new AbortController,OF.set(this,void 0),_F.set(this,(()=>{})),BF.set(this,(()=>{})),FF.set(this,void 0),UF.set(this,(()=>{})),HF.set(this,(()=>{})),zF.set(this,{}),jF.set(this,!1),VF.set(this,!1),qF.set(this,!1),WF.set(this,!1),GF(this,OF,new Promise(((e,t)=>{GF(this,_F,e,"f"),GF(this,BF,t,"f")})),"f"),GF(this,FF,new Promise(((e,t)=>{GF(this,UF,e,"f"),GF(this,HF,t,"f")})),"f"),ZF(this,OF,"f").catch((()=>{})),ZF(this,FF,"f").catch((()=>{}))}_run(e){setTimeout((()=>{e().then((()=>{this._emitFinal(),this._emit("end")}),ZF(this,NF,"m",QF).bind(this))}),0)}_connected(){this.ended||(ZF(this,_F,"f").call(this),this._emit("connect"))}get ended(){return ZF(this,jF,"f")}get errored(){return ZF(this,VF,"f")}get aborted(){return ZF(this,qF,"f")}abort(){this.controller.abort()}on(e,t){return(ZF(this,zF,"f")[e]||(ZF(this,zF,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=ZF(this,zF,"f")[e];if(!n)return this;const r=n.findIndex((e=>e.listener===t));return r>=0&&n.splice(r,1),this}once(e,t){return(ZF(this,zF,"f")[e]||(ZF(this,zF,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise(((t,n)=>{GF(this,WF,!0,"f"),"error"!==e&&this.once("error",n),this.once(e,t)}))}async done(){GF(this,WF,!0,"f"),await ZF(this,FF,"f")}_emit(e,...t){if(ZF(this,jF,"f"))return;"end"===e&&(GF(this,jF,!0,"f"),ZF(this,UF,"f").call(this));const n=ZF(this,zF,"f")[e];if(n&&(ZF(this,zF,"f")[e]=n.filter((e=>!e.once)),n.forEach((({listener:e})=>e(...t)))),"abort"===e){const e=t[0];return ZF(this,WF,"f")||n?.length||Promise.reject(e),ZF(this,BF,"f").call(this,e),ZF(this,HF,"f").call(this,e),void this._emit("end")}if("error"===e){const e=t[0];ZF(this,WF,"f")||n?.length||Promise.reject(e),ZF(this,BF,"f").call(this,e),ZF(this,HF,"f").call(this,e),this._emit("end")}}_emitFinal(){}}function KF(e){return"auto-parseable-response-format"===e?.$brand}function JF(e){return"auto-parseable-tool"===e?.$brand}function XF(e,t){const n=e.choices.map((e=>{if("length"===e.finish_reason)throw new N_;if("content_filter"===e.finish_reason)throw new O_;return{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map((e=>function(e,t){const n=e.tools?.find((e=>e.function?.name===t.function.name));return{...t,function:{...t.function,parsed_arguments:JF(n)?n.$parseRaw(t.function.arguments):n?.function.strict?JSON.parse(t.function.arguments):null}}}(t,e)))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?$F(t,e.message.content):null}}}));return{...e,choices:n}}function $F(e,t){if("json_schema"!==e.response_format?.type)return null;if("json_schema"===e.response_format?.type){if("$parseRaw"in e.response_format){return e.response_format.$parseRaw(t)}return JSON.parse(t)}return null}function eU(e,t){if(!e)return!1;const n=e.tools?.find((e=>e.function?.name===t.function.name));return JF(n)||n?.function.strict||!1}function tU(e){return!!KF(e.response_format)||(e.tools?.some((e=>JF(e)||"function"===e.type&&!0===e.function.strict))??!1)}OF=new WeakMap,_F=new WeakMap,BF=new WeakMap,FF=new WeakMap,UF=new WeakMap,HF=new WeakMap,zF=new WeakMap,jF=new WeakMap,VF=new WeakMap,qF=new WeakMap,WF=new WeakMap,NF=new WeakSet,QF=function(e){if(GF(this,VF,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new E_),e instanceof E_)return GF(this,qF,!0,"f"),this._emit("abort",e);if(e instanceof w_)return this._emit("error",e);if(e instanceof Error){const t=new w_(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new w_(String(e)))};var nU,rU,sU,iU,aU,oU,lU,cU,uU=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};const dU=10;class hU extends YF{constructor(){super(...arguments),nU.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),(LF(e)||RF(e))&&e.content)this._emit("functionCallResult",e.content);else if(MF(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(MF(e)&&e.tool_calls)for(const t of e.tool_calls)"function"===t.type&&this._emit("functionCall",t.function)}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new w_("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),uU(this,nU,"m",rU).call(this)}async finalMessage(){return await this.done(),uU(this,nU,"m",sU).call(this)}async finalFunctionCall(){return await this.done(),uU(this,nU,"m",iU).call(this)}async finalFunctionCallResult(){return await this.done(),uU(this,nU,"m",aU).call(this)}async totalUsage(){return await this.done(),uU(this,nU,"m",oU).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=uU(this,nU,"m",sU).call(this);t&&this._emit("finalMessage",t);const n=uU(this,nU,"m",rU).call(this);n&&this._emit("finalContent",n);const r=uU(this,nU,"m",iU).call(this);r&&this._emit("finalFunctionCall",r);const s=uU(this,nU,"m",aU).call(this);null!=s&&this._emit("finalFunctionCallResult",s),this._chatCompletions.some((e=>e.usage))&&this._emit("totalUsage",uU(this,nU,"m",oU).call(this))}async _createChatCompletion(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),uU(this,nU,"m",lU).call(this,t);const s=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(XF(s,t))}async _runChatCompletion(e,t,n){for(const e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){const r="function",{function_call:s="auto",stream:i,...a}=t,o="string"!=typeof s&&s?.name,{maxChatCompletions:l=dU}=n||{},c={};for(const e of t.functions)c[e.name||e.function.name]=e;const u=t.functions.map((e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description})));for(const e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){const t=await this._createChatCompletion(e,{...a,function_call:s,functions:u,messages:[...this.messages]},n),i=t.choices[0]?.message;if(!i)throw new w_("missing message in ChatCompletion response");if(!i.function_call)return;const{name:l,arguments:d}=i.function_call,h=c[l];if(!h){const e=`Invalid function_call: ${JSON.stringify(l)}. Available options are: ${u.map((e=>JSON.stringify(e.name))).join(", ")}. Please try again`;this._addMessage({role:r,name:l,content:e});continue}if(o&&o!==l){const e=`Invalid function_call: ${JSON.stringify(l)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:r,name:l,content:e});continue}let p;try{p=DF(h)?await h.parse(d):d}catch(e){this._addMessage({role:r,name:l,content:e instanceof Error?e.message:String(e)});continue}const g=await h.function(p,this),m=uU(this,nU,"m",cU).call(this,g);if(this._addMessage({role:r,name:l,content:m}),o)return}}async _runTools(e,t,n){const r="tool",{tool_choice:s="auto",stream:i,...a}=t,o="string"!=typeof s&&s?.function?.name,{maxChatCompletions:l=dU}=n||{},c=t.tools.map((e=>{if(JF(e)){if(!e.$callback)throw new w_("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e})),u={};for(const e of c)"function"===e.type&&(u[e.function.name||e.function.function.name]=e.function);const d="tools"in t?c.map((e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e)):void 0;for(const e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){const t=await this._createChatCompletion(e,{...a,tool_choice:s,tools:d,messages:[...this.messages]},n),i=t.choices[0]?.message;if(!i)throw new w_("missing message in ChatCompletion response");if(!i.tool_calls?.length)return;for(const e of i.tool_calls){if("function"!==e.type)continue;const t=e.id,{name:n,arguments:s}=e.function,i=u[n];if(!i){const e=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(u).map((e=>JSON.stringify(e))).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:t,content:e});continue}if(o&&o!==n){const e=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:r,tool_call_id:t,content:e});continue}let a;try{a=DF(i)?await i.parse(s):s}catch(e){const n=e instanceof Error?e.message:String(e);this._addMessage({role:r,tool_call_id:t,content:n});continue}const l=await i.function(a,this),c=uU(this,nU,"m",cU).call(this,l);if(this._addMessage({role:r,tool_call_id:t,content:c}),o)return}}}}nU=new WeakSet,rU=function(){return uU(this,nU,"m",sU).call(this).content??null},sU=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(MF(t)){const{function_call:e,...n}=t,r={...n,content:t.content??null,refusal:t.refusal??null};return e&&(r.function_call=e),r}}throw new w_("stream ended without producing a ChatCompletionMessage with role=assistant")},iU=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(MF(t)&&t?.function_call)return t.function_call;if(MF(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},aU=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(LF(t)&&null!=t.content)return t.content;if(RF(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some((e=>"assistant"===e.role&&e.tool_calls?.some((e=>"function"===e.type&&e.id===t.tool_call_id)))))return t.content}},oU=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},lU=function(e){if(null!=e.n&&e.n>1)throw new w_("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},cU=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class pU extends hU{static runFunctions(e,t,n){const r=new pU,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,s))),r}static runTools(e,t,n){const r=new pU,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,s))),r}_addMessage(e,t=!0){super._addMessage(e,t),MF(e)&&e.content&&this._emit("content",e.content)}}const gU=1,mU=2,fU=4,yU=8,vU=16,bU=32,CU=64,wU=128,SU=256,EU=511;class xU extends Error{}class IU extends Error{}const AU=(e,t)=>{const n=e.length;let r=0;const s=e=>{throw new xU(`${e} at position ${r}`)},i=e=>{throw new IU(`${e} at position ${r}`)},a=()=>(d(),r>=n&&s("Unexpected end of input"),'"'===e[r]?o():"{"===e[r]?l():"["===e[r]?c():"null"===e.substring(r,r+4)||vU&t&&n-r<4&&"null".startsWith(e.substring(r))?(r+=4,null):"true"===e.substring(r,r+4)||bU&t&&n-r<4&&"true".startsWith(e.substring(r))?(r+=4,!0):"false"===e.substring(r,r+5)||bU&t&&n-r<5&&"false".startsWith(e.substring(r))?(r+=5,!1):"Infinity"===e.substring(r,r+8)||wU&t&&n-r<8&&"Infinity".startsWith(e.substring(r))?(r+=8,1/0):"-Infinity"===e.substring(r,r+9)||SU&t&&1<n-r&&n-r<9&&"-Infinity".startsWith(e.substring(r))?(r+=9,-1/0):"NaN"===e.substring(r,r+3)||CU&t&&n-r<3&&"NaN".startsWith(e.substring(r))?(r+=3,NaN):u()),o=()=>{const a=r;let o=!1;for(r++;r<n&&('"'!==e[r]||o&&"\\"===e[r-1]);)o="\\"===e[r]&&!o,r++;if('"'==e.charAt(r))try{return JSON.parse(e.substring(a,++r-Number(o)))}catch(e){i(String(e))}else if(gU&t)try{return JSON.parse(e.substring(a,r-Number(o))+'"')}catch(t){return JSON.parse(e.substring(a,e.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{r++,d();const i={};try{for(;"}"!==e[r];){if(d(),r>=n&&yU&t)return i;const s=o();d(),r++;try{const e=a();Object.defineProperty(i,s,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(yU&t)return i;throw e}d(),","===e[r]&&r++}}catch(e){if(yU&t)return i;s("Expected '}' at end of object")}return r++,i},c=()=>{r++;const n=[];try{for(;"]"!==e[r];)n.push(a()),d(),","===e[r]&&r++}catch(e){if(fU&t)return n;s("Expected ']' at end of array")}return r++,n},u=()=>{if(0===r){"-"===e&&mU&t&&s("Not sure what '-' is");try{return JSON.parse(e)}catch(n){if(mU&t)try{return"."===e[e.length-1]?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}i(String(n))}}const a=r;for("-"===e[r]&&r++;e[r]&&!",]}".includes(e[r]);)r++;r!=n||mU&t||s("Unterminated number literal");try{return JSON.parse(e.substring(a,r))}catch(n){"-"===e.substring(a,r)&&mU&t&&s("Not sure what '-' is");try{return JSON.parse(e.substring(a,e.lastIndexOf("e")))}catch(e){i(String(e))}}},d=()=>{for(;r<n&&" \n\r\t".includes(e[r]);)r++};return a()},PU=e=>function(e,t=EU){if("string"!=typeof e)throw new TypeError("expecting str, got "+typeof e);if(!e.trim())throw new Error(`${e} is empty`);return AU(e.trim(),t)}(e,EU^mU);var kU,TU,DU,MU,LU,RU,NU,OU,_U,BU,FU,UU,HU=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},zU=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class jU extends hU{constructor(e){super(),kU.add(this),TU.set(this,void 0),DU.set(this,void 0),MU.set(this,void 0),HU(this,TU,e,"f"),HU(this,DU,[],"f")}get currentChatCompletionSnapshot(){return zU(this,MU,"f")}static fromReadableStream(e){const t=new jU(null);return t._run((()=>t._fromReadableStream(e))),t}static createChatCompletion(e,t,n){const r=new jU(t);return r._run((()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createChatCompletion(e,t,n){super._createChatCompletion;const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),zU(this,kU,"m",LU).call(this);const s=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const e of s)zU(this,kU,"m",NU).call(this,e);if(s.controller.signal?.aborted)throw new E_;return this._addChatCompletion(zU(this,kU,"m",BU).call(this))}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),zU(this,kU,"m",LU).call(this),this._connected();const r=W_.fromReadableStream(e,this.controller);let s;for await(const e of r)s&&s!==e.id&&this._addChatCompletion(zU(this,kU,"m",BU).call(this)),zU(this,kU,"m",NU).call(this,e),s=e.id;if(r.controller.signal?.aborted)throw new E_;return this._addChatCompletion(zU(this,kU,"m",BU).call(this))}[(TU=new WeakMap,DU=new WeakMap,MU=new WeakMap,kU=new WeakSet,LU=function(){this.ended||HU(this,MU,void 0,"f")},RU=function(e){let t=zU(this,DU,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},zU(this,DU,"f")[e.index]=t,t)},NU=function(e){if(this.ended)return;const t=zU(this,kU,"m",UU).call(this,e);this._emit("chunk",e,t);for(const n of e.choices){const e=t.choices[n.index];null!=n.delta.content&&"assistant"===e.message?.role&&e.message?.content&&(this._emit("content",n.delta.content,e.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=n.delta.refusal&&"assistant"===e.message?.role&&e.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:e.message.refusal}),null!=n.logprobs?.content&&"assistant"===e.message?.role&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:e.logprobs?.content??[]}),null!=n.logprobs?.refusal&&"assistant"===e.message?.role&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});const r=zU(this,kU,"m",RU).call(this,e);e.finish_reason&&(zU(this,kU,"m",_U).call(this,e),null!=r.current_tool_call_index&&zU(this,kU,"m",OU).call(this,e,r.current_tool_call_index));for(const t of n.delta.tool_calls??[])r.current_tool_call_index!==t.index&&(zU(this,kU,"m",_U).call(this,e),null!=r.current_tool_call_index&&zU(this,kU,"m",OU).call(this,e,r.current_tool_call_index)),r.current_tool_call_index=t.index;for(const t of n.delta.tool_calls??[]){const n=e.message.tool_calls?.[t.index];n?.type&&("function"===n?.type&&this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:t.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:t.function?.arguments??""}))}}},OU=function(e,t){if(zU(this,kU,"m",RU).call(this,e).done_tool_calls.has(t))return;const n=e.message.tool_calls?.[t];if(!n)throw new Error("no tool call snapshot");if(!n.type)throw new Error("tool call snapshot missing `type`");if("function"===n.type){const e=zU(this,TU,"f")?.tools?.find((e=>"function"===e.type&&e.function.name===n.function.name));this._emit("tool_calls.function.arguments.done",{name:n.function.name,index:t,arguments:n.function.arguments,parsed_arguments:JF(e)?e.$parseRaw(n.function.arguments):e?.function.strict?JSON.parse(n.function.arguments):null})}else n.type},_U=function(e){const t=zU(this,kU,"m",RU).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;const n=zU(this,kU,"m",FU).call(this);this._emit("content.done",{content:e.message.content,parsed:n?n.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},BU=function(){if(this.ended)throw new w_("stream has ended, this shouldn't happen");const e=zU(this,MU,"f");if(!e)throw new w_("request ended without sending any chunks");return HU(this,MU,void 0,"f"),HU(this,DU,[],"f"),function(e,t){const{id:n,choices:r,created:s,model:i,system_fingerprint:a,...o}=e,l={...o,id:n,choices:r.map((({message:t,finish_reason:n,index:r,logprobs:s,...i})=>{if(!n)throw new w_(`missing finish_reason for choice ${r}`);const{content:a=null,function_call:o,tool_calls:l,...c}=t,u=t.role;if(!u)throw new w_(`missing role for choice ${r}`);if(o){const{arguments:e,name:l}=o;if(null==e)throw new w_(`missing function_call.arguments for choice ${r}`);if(!l)throw new w_(`missing function_call.name for choice ${r}`);return{...i,message:{content:a,function_call:{arguments:e,name:l},role:u,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:s}}return l?{...i,index:r,finish_reason:n,logprobs:s,message:{...c,role:u,content:a,refusal:t.refusal??null,tool_calls:l.map(((t,n)=>{const{function:s,type:i,id:a,...o}=t,{arguments:l,name:c,...u}=s||{};if(null==a)throw new w_(`missing choices[${r}].tool_calls[${n}].id\n${VU(e)}`);if(null==i)throw new w_(`missing choices[${r}].tool_calls[${n}].type\n${VU(e)}`);if(null==c)throw new w_(`missing choices[${r}].tool_calls[${n}].function.name\n${VU(e)}`);if(null==l)throw new w_(`missing choices[${r}].tool_calls[${n}].function.arguments\n${VU(e)}`);return{...o,id:a,type:i,function:{...u,name:c,arguments:l}}}))}}:{...i,message:{...c,content:a,role:u,refusal:t.refusal??null},finish_reason:n,index:r,logprobs:s}})),created:s,model:i,object:"chat.completion",...a?{system_fingerprint:a}:{}};return function(e,t){return t&&tU(t)?XF(e,t):{...e,choices:e.choices.map((e=>({...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}})))}}(l,t)}(e,zU(this,TU,"f"))},FU=function(){const e=zU(this,TU,"f")?.response_format;return KF(e)?e:null},UU=function(e){var t,n,r,s;let i=zU(this,MU,"f");const{choices:a,...o}=e;i?Object.assign(i,o):i=HU(this,MU,{...o,choices:[]},"f");for(const{delta:a,finish_reason:o,index:l,logprobs:c=null,...u}of e.choices){let e=i.choices[l];if(e||(e=i.choices[l]={finish_reason:o,index:l,message:{},logprobs:c,...u}),c)if(e.logprobs){const{content:r,refusal:s,...i}=c;Object.assign(e.logprobs,i),r&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...r)),s&&((n=e.logprobs).refusal??(n.refusal=[]),e.logprobs.refusal.push(...s))}else e.logprobs=Object.assign({},c);if(o&&(e.finish_reason=o,zU(this,TU,"f")&&tU(zU(this,TU,"f")))){if("length"===o)throw new N_;if("content_filter"===o)throw new O_}if(Object.assign(e,u),!a)continue;const{content:d,refusal:h,function_call:p,role:g,tool_calls:m,...f}=a;if(Object.assign(e.message,f),h&&(e.message.refusal=(e.message.refusal||"")+h),g&&(e.message.role=g),p&&(e.message.function_call?(p.name&&(e.message.function_call.name=p.name),p.arguments&&((r=e.message.function_call).arguments??(r.arguments=""),e.message.function_call.arguments+=p.arguments)):e.message.function_call=p),d&&(e.message.content=(e.message.content||"")+d,!e.message.refusal&&zU(this,kU,"m",FU).call(this)&&(e.message.parsed=PU(e.message.content))),m){e.message.tool_calls||(e.message.tool_calls=[]);for(const{index:t,id:n,type:r,function:i,...a}of m){const o=(s=e.message.tool_calls)[t]??(s[t]={});Object.assign(o,a),n&&(o.id=n),r&&(o.type=r),i&&(o.function??(o.function={name:i.name??"",arguments:""})),i?.name&&(o.function.name=i.name),i?.arguments&&(o.function.arguments+=i.arguments,eU(zU(this,TU,"f"),o)&&(o.function.parsed_arguments=PU(o.function.arguments)))}}}return i},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new W_(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function VU(e){return JSON.stringify(e)}class qU extends jU{static fromReadableStream(e){const t=new qU(null);return t._run((()=>t._fromReadableStream(e))),t}static runFunctions(e,t,n){const r=new qU(null),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run((()=>r._runFunctions(e,t,s))),r}static runTools(e,t,n){const r=new qU(t),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run((()=>r._runTools(e,t,s))),r}}class WU extends HB{parse(e,t){return function(e){for(const t of e??[]){if("function"!==t.type)throw new w_(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new w_(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((t=>XF(t,e)))}runFunctions(e,t){return e.stream?qU.runFunctions(this._client,e,t):pU.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?qU.runTools(this._client,e,t):pU.runTools(this._client,e,t)}stream(e,t){return jU.createChatCompletion(this._client,e,t)}}class QU extends HB{constructor(){super(...arguments),this.completions=new WU(this._client)}}!function(e){e.Completions=WU}(QU||(QU={}));class GU extends HB{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class ZU extends HB{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}}class YU extends HB{constructor(){super(...arguments),this.sessions=new GU(this._client),this.transcriptionSessions=new ZU(this._client)}}YU.Sessions=GU,YU.TranscriptionSessions=ZU;var KU,JU,XU,$U,eH,tH,nH,rH,sH,iH,aH,oH,lH,cH,uH,dH,hH,pH,gH,mH,fH,yH,vH=n(58651),bH=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},CH=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n};class wH extends YF{constructor(){super(...arguments),KU.add(this),JU.set(this,[]),XU.set(this,{}),$U.set(this,{}),eH.set(this,void 0),tH.set(this,void 0),nH.set(this,void 0),rH.set(this,void 0),sH.set(this,void 0),iH.set(this,void 0),aH.set(this,void 0),oH.set(this,void 0),lH.set(this,void 0)}[(JU=new WeakMap,XU=new WeakMap,$U=new WeakMap,eH=new WeakMap,tH=new WeakMap,nH=new WeakMap,rH=new WeakMap,sH=new WeakMap,iH=new WeakMap,aH=new WeakMap,oH=new WeakMap,lH=new WeakMap,KU=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new wH;return t._run((()=>t._fromReadableStream(e))),t}async _fromReadableStream(e,t){const n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const r=W_.fromReadableStream(e,this.controller);for await(const e of r)bH(this,KU,"m",cH).call(this,e);if(r.controller.signal?.aborted)throw new E_;return this._addRun(bH(this,KU,"m",uH).call(this))}toReadableStream(){return new W_(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,s){const i=new wH;return i._run((()=>i._runToolAssistantStream(e,t,n,r,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}}))),i}async _createToolAssistantStream(e,t,n,r,s){const i=s?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort())));const a={...r,stream:!0},o=await e.submitToolOutputs(t,n,a,{...s,signal:this.controller.signal});this._connected();for await(const e of o)bH(this,KU,"m",cH).call(this,e);if(o.controller.signal?.aborted)throw new E_;return this._addRun(bH(this,KU,"m",uH).call(this))}static createThreadAssistantStream(e,t,n){const r=new wH;return r._run((()=>r._threadAssistantStream(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}static createAssistantStream(e,t,n,r){const s=new wH;return s._run((()=>s._runAssistantStream(e,t,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),s}currentEvent(){return bH(this,aH,"f")}currentRun(){return bH(this,oH,"f")}currentMessageSnapshot(){return bH(this,eH,"f")}currentRunStepSnapshot(){return bH(this,lH,"f")}async finalRunSteps(){return await this.done(),Object.values(bH(this,XU,"f"))}async finalMessages(){return await this.done(),Object.values(bH(this,$U,"f"))}async finalRun(){if(await this.done(),!bH(this,tH,"f"))throw Error("Final run was not received.");return bH(this,tH,"f")}async _createThreadAssistantStream(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort())));const s={...t,stream:!0},i=await e.createAndRun(s,{...n,signal:this.controller.signal});this._connected();for await(const e of i)bH(this,KU,"m",cH).call(this,e);if(i.controller.signal?.aborted)throw new E_;return this._addRun(bH(this,KU,"m",uH).call(this))}async _createAssistantStream(e,t,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",(()=>this.controller.abort())));const i={...n,stream:!0},a=await e.create(t,i,{...r,signal:this.controller.signal});this._connected();for await(const e of a)bH(this,KU,"m",cH).call(this,e);if(a.controller.signal?.aborted)throw new E_;return this._addRun(bH(this,KU,"m",uH).call(this))}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let t=e[n];if(null!=t)if("index"!==n&&"type"!==n){if("string"==typeof t&&"string"==typeof r)t+=r;else if("number"==typeof t&&"number"==typeof r)t+=r;else{if(!UB(t)||!UB(r)){if(Array.isArray(t)&&Array.isArray(r)){if(t.every((e=>"string"==typeof e||"number"==typeof e))){t.push(...r);continue}for(const e of r){if(!UB(e))throw new Error(`Expected array delta entry to be an object but got: ${e}`);const n=e.index;if(null==n)throw vH.error(e),new Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);const r=t[n];null==r?t.push(e):t[n]=this.accumulateDelta(r,e)}continue}throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${t}`)}t=this.accumulateDelta(t,r)}e[n]=t}else e[n]=r;else e[n]=r}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,s){return await this._createToolAssistantStream(n,e,t,r,s)}}cH=function(e){if(!this.ended)switch(CH(this,aH,e,"f"),bH(this,KU,"m",pH).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":bH(this,KU,"m",yH).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":bH(this,KU,"m",hH).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":bH(this,KU,"m",dH).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},uH=function(){if(this.ended)throw new w_("stream has ended, this shouldn't happen");if(!bH(this,tH,"f"))throw Error("Final run has not been received");return bH(this,tH,"f")},dH=function(e){const[t,n]=bH(this,KU,"m",mH).call(this,e,bH(this,eH,"f"));CH(this,eH,t,"f"),bH(this,$U,"f")[t.id]=t;for(const e of n){const n=t.content[e.index];"text"==n?.type&&this._emit("textCreated",n.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const n of e.data.delta.content){if("text"==n.type&&n.text){let e=n.text,r=t.content[n.index];if(!r||"text"!=r.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",e,r.text)}if(n.index!=bH(this,nH,"f")){if(bH(this,rH,"f"))switch(bH(this,rH,"f").type){case"text":this._emit("textDone",bH(this,rH,"f").text,bH(this,eH,"f"));break;case"image_file":this._emit("imageFileDone",bH(this,rH,"f").image_file,bH(this,eH,"f"))}CH(this,nH,n.index,"f")}CH(this,rH,t.content[n.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==bH(this,nH,"f")){const t=e.data.content[bH(this,nH,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,bH(this,eH,"f"));break;case"text":this._emit("textDone",t.text,bH(this,eH,"f"))}}bH(this,eH,"f")&&this._emit("messageDone",e.data),CH(this,eH,void 0,"f")}},hH=function(e){const t=bH(this,KU,"m",gH).call(this,e);switch(CH(this,lH,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(const e of n.step_details.tool_calls)e.index==bH(this,sH,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(bH(this,iH,"f")&&this._emit("toolCallDone",bH(this,iH,"f")),CH(this,sH,e.index,"f"),CH(this,iH,t.step_details.tool_calls[e.index],"f"),bH(this,iH,"f")&&this._emit("toolCallCreated",bH(this,iH,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":CH(this,lH,void 0,"f");"tool_calls"==e.data.step_details.type&&bH(this,iH,"f")&&(this._emit("toolCallDone",bH(this,iH,"f")),CH(this,iH,void 0,"f")),this._emit("runStepDone",e.data,t)}},pH=function(e){bH(this,JU,"f").push(e),this._emit("event",e)},gH=function(e){switch(e.event){case"thread.run.step.created":return bH(this,XU,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=bH(this,XU,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=wH.accumulateDelta(t,n.delta);bH(this,XU,"f")[e.data.id]=r}return bH(this,XU,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":bH(this,XU,"f")[e.data.id]=e.data}if(bH(this,XU,"f")[e.data.id])return bH(this,XU,"f")[e.data.id];throw new Error("No snapshot available")},mH=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const e of r.delta.content)if(e.index in t.content){let n=t.content[e.index];t.content[e.index]=bH(this,KU,"m",fH).call(this,e,n)}else t.content[e.index]=e,n.push(e);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},fH=function(e,t){return wH.accumulateDelta(t,e)},yH=function(e){switch(CH(this,oH,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":CH(this,tH,e.data,"f"),bH(this,iH,"f")&&(this._emit("toolCallDone",bH(this,iH,"f")),CH(this,iH,void 0,"f"))}};class SH extends HB{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return bB(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,EH,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class EH extends qB{}SH.MessagesPage=EH;class xH extends HB{retrieve(e,t,n,r={},s){return bB(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t,n={},r){return bB(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,IH,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class IH extends qB{}xH.RunStepsPage=IH;class AH extends HB{constructor(){super(...arguments),this.steps=new xH(this._client)}create(e,t,n){const{include:r,...s}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:s,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},n){return bB(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,PH,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return wH.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const r={...n?.headers,"X-Stainless-Poll-Helper":"true"};for(n?.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:s,response:i}=await this.retrieve(e,t,{...n,headers:{...n?.headers,...r}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let e=5e3;if(n?.pollIntervalMs)e=n.pollIntervalMs;else{const t=i.headers.get("openai-poll-after-ms");if(t){const n=parseInt(t);isNaN(n)||(e=n)}}await kB(e);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,t,n){return wH.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){const s=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,s.id,r)}submitToolOutputsStream(e,t,n,r){return wH.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}}class PH extends qB{}AH.RunsPage=PH,AH.Steps=xH,AH.RunStepsPage=IH;class kH extends HB{constructor(){super(...arguments),this.runs=new AH(this._client),this.messages=new SH(this._client)}create(e={},t){return bB(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return wH.createThreadAssistantStream(e,this._client.beta.threads,t)}}kH.Runs=AH,kH.RunsPage=PH,kH.Messages=SH,kH.MessagesPage=EH;class TH extends HB{constructor(){super(...arguments),this.realtime=new YU(this._client),this.chat=new QU(this._client),this.assistants=new kF(this._client),this.threads=new kH(this._client)}}TH.Realtime=YU,TH.Assistants=kF,TH.AssistantsPage=TF,TH.Threads=kH;class DH extends HB{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return bB(e)?this.list({},e):this._client.getAPIList("/batches",MH,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class MH extends qB{}DH.BatchesPage=MH;class LH extends HB{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,nB({body:t,...n}))}}class RH extends HB{constructor(){super(...arguments),this.parts=new LH(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}function NH(e,t){return t&&function(e){if(KF(e.text?.format))return!0;return!1}(t)?OH(e,t):{...e,output_parsed:null,output:e.output.map((e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map((e=>({...e,parsed:null})))}:e))}}function OH(e,t){const n=e.output.map((e=>{if("function_call"===e.type)return{...e,parsed_arguments:UH(t,e)};if("message"===e.type){const n=e.content.map((e=>"output_text"===e.type?{...e,parsed:_H(t,e.text)}:e));return{...e,content:n}}return e})),r=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||HH(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const e of r.output)if("message"===e.type)for(const t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed;return null}}),r}function _H(e,t){if("json_schema"!==e.text?.format?.type)return null;if("$parseRaw"in e.text?.format){const n=e.text?.format;return n.$parseRaw(t)}return JSON.parse(t)}function BH(e){return"auto-parseable-tool"===e?.$brand}function FH(e,t){return e.find((e=>"function"===e.type&&e.name===t))}function UH(e,t){const n=FH(e.tools??[],t.name);return{...t,...t,parsed_arguments:BH(n)?n.$parseRaw(t.arguments):n?.strict?JSON.parse(t.arguments):null}}function HH(e){const t=[];for(const n of e.output)if("message"===n.type)for(const e of n.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}RH.Parts=LH;class zH extends HB{list(e,t={},n){return bB(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,ez,{query:t,...n})}}var jH,VH,qH,WH,QH,GH,ZH,YH,KH=function(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n},JH=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class XH extends YF{constructor(e){super(),jH.add(this),VH.set(this,void 0),qH.set(this,void 0),WH.set(this,void 0),KH(this,VH,e,"f")}static createResponse(e,t,n){const r=new XH(t);return r._run((()=>r._createResponse(e,t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),r}async _createResponse(e,t,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),JH(this,jH,"m",QH).call(this);const s=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const e of s)JH(this,jH,"m",GH).call(this,e);if(s.controller.signal?.aborted)throw new E_;return JH(this,jH,"m",ZH).call(this)}[(VH=new WeakMap,qH=new WeakMap,WH=new WeakMap,jH=new WeakSet,QH=function(){this.ended||KH(this,qH,void 0,"f")},GH=function(e){if(this.ended)return;const t=JH(this,jH,"m",YH).call(this,e);switch(this._emit("event",e),e.type){case"response.output_text.delta":{const n=t.output[e.output_index];if(!n)throw new w_(`missing output at index ${e.output_index}`);if("message"===n.type){const t=n.content[e.content_index];if(!t)throw new w_(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new w_(`expected content to be 'output_text', got ${t.type}`);this._emit("response.output_text.delta",{...e,snapshot:t.text})}break}case"response.function_call_arguments.delta":{const n=t.output[e.output_index];if(!n)throw new w_(`missing output at index ${e.output_index}`);"function_call"===n.type&&this._emit("response.function_call_arguments.delta",{...e,snapshot:n.arguments});break}default:this._emit(e.type,e)}},ZH=function(){if(this.ended)throw new w_("stream has ended, this shouldn't happen");const e=JH(this,qH,"f");if(!e)throw new w_("request ended without sending any events");KH(this,qH,void 0,"f");const t=function(e,t){return NH(e,t)}(e,JH(this,VH,"f"));return KH(this,WH,t,"f"),t},YH=function(e){let t=JH(this,qH,"f");if(!t){if("response.created"!==e.type)throw new w_(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return t=KH(this,qH,e.response,"f"),t}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{const n=t.output[e.output_index];if(!n)throw new w_(`missing output at index ${e.output_index}`);"message"===n.type&&n.content.push(e.part);break}case"response.output_text.delta":{const n=t.output[e.output_index];if(!n)throw new w_(`missing output at index ${e.output_index}`);if("message"===n.type){const t=n.content[e.content_index];if(!t)throw new w_(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new w_(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{const n=t.output[e.output_index];if(!n)throw new w_(`missing output at index ${e.output_index}`);"function_call"===n.type&&(n.arguments+=e.delta);break}case"response.completed":KH(this,qH,e.response,"f")}return t},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",(n=>{const r=t.shift();r?r.resolve(n):e.push(n)})),this.on("end",(()=>{n=!0;for(const e of t)e.resolve(void 0);t.length=0})),this.on("abort",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),this.on("error",(e=>{n=!0;for(const n of t)n.reject(e);t.length=0})),{next:async()=>{if(!e.length)return n?{value:void 0,done:!0}:new Promise(((e,n)=>t.push({resolve:e,reject:n}))).then((e=>e?{value:e,done:!1}:{value:void 0,done:!0}));return{value:e.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=JH(this,WH,"f");if(!e)throw new w_("stream ended without producing a ChatCompletion");return e}}class $H extends HB{constructor(){super(...arguments),this.inputItems=new zH(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap((e=>("object"in e&&"response"===e.object&&HH(e),e)))}retrieve(e,t={},n){return bB(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...n})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t?.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap((t=>OH(t,e)))}stream(e,t){return XH.createResponse(this._client,e,t)}}class ez extends qB{}$H.InputItems=zH;class tz extends HB{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return bB(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,nz,{query:n,...r})}}class nz extends qB{}tz.OutputItemListResponsesPage=nz;class rz extends HB{constructor(){super(...arguments),this.outputItems=new tz(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return bB(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,sz,{query:t,...n})}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}class sz extends qB{}rz.RunListResponsesPage=sz,rz.OutputItems=tz,rz.OutputItemListResponsesPage=nz;class iz extends HB{constructor(){super(...arguments),this.runs=new rz(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,{body:t,...n})}list(e={},t){return bB(e)?this.list({},e):this._client.getAPIList("/evals",az,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class az extends qB{}iz.EvalListResponsesPage=az,iz.Runs=rz,iz.RunListResponsesPage=sz;var oz,lz=n(72715);class cz extends gB{constructor({baseURL:e=MB("OPENAI_BASE_URL"),apiKey:t=MB("OPENAI_API_KEY"),organization:n=MB("OPENAI_ORG_ID")??null,project:r=MB("OPENAI_PROJECT_ID")??null,...s}={}){if(void 0===t)throw new w_("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:n,project:r,...s,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new w_("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new zB(this),this.chat=new ZB(this),this.embeddings=new YB(this),this.files=new KB(this),this.images=new XB(this),this.audio=new nF(this),this.moderations=new rF(this),this.models=new sF(this),this.fineTuning=new yF(this),this.graders=new bF(this),this.vectorStores=new IF(this),this.beta=new TH(this),this.batches=new DH(this),this.uploads=new RH(this),this.responses=new $H(this),this.evals=new iz(this),this._options=i,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return r_(e,{arrayFormat:"brackets"})}}oz=cz,cz.OpenAI=oz,cz.DEFAULT_TIMEOUT=6e5,cz.OpenAIError=w_,cz.APIError=S_,cz.APIConnectionError=x_,cz.APIConnectionTimeoutError=I_,cz.APIUserAbortError=E_,cz.NotFoundError=T_,cz.ConflictError=D_,cz.RateLimitError=L_,cz.BadRequestError=A_,cz.AuthenticationError=P_,cz.InternalServerError=R_,cz.PermissionDeniedError=k_,cz.UnprocessableEntityError=M_,cz.toFile=X_,cz.fileFromPath=h_,cz.Completions=zB,cz.Chat=ZB,cz.ChatCompletionsPage=QB,cz.Embeddings=YB,cz.Files=KB,cz.FileObjectsPage=JB,cz.Images=XB,cz.Audio=nF,cz.Moderations=rF,cz.Models=sF,cz.ModelsPage=iF,cz.FineTuning=yF,cz.Graders=bF,cz.VectorStores=IF,cz.VectorStoresPage=AF,cz.VectorStoreSearchResponsesPage=PF,cz.Beta=TH,cz.Batches=DH,cz.BatchesPage=MH,cz.Uploads=RH,cz.Responses=$H,cz.Evals=iz,cz.EvalListResponsesPage=az;class uz extends cz{constructor({baseURL:e=MB("OPENAI_BASE_URL"),apiKey:t=MB("AZURE_OPENAI_API_KEY"),apiVersion:n=MB("OPENAI_API_VERSION"),endpoint:r,deployment:s,azureADTokenProvider:i,dangerouslyAllowBrowser:a,...o}={}){if(!n)throw new w_("The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).");if("function"==typeof i&&(a=!0),!i&&!t)throw new w_("Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.");if(i&&t)throw new w_("The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.");if(t??(t=hz),o.defaultQuery={...o.defaultQuery,"api-version":n},e){if(r)throw new w_("baseURL and endpoint are mutually exclusive")}else{if(r||(r=lz.env.AZURE_OPENAI_ENDPOINT),!r)throw new w_("Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable");e=`${r}/openai`}super({apiKey:t,baseURL:e,...o,...void 0!==a?{dangerouslyAllowBrowser:a}:{}}),this.apiVersion="",this._azureADTokenProvider=i,this.apiVersion=n,this.deploymentName=s}buildRequest(e,t={}){if(dz.has(e.path)&&"post"===e.method&&void 0!==e.body){if(!UB(e.body))throw new Error("Expected request body to be an object");const t=this.deploymentName||e.body.model||e.__metadata?.model;void 0===t||this.baseURL.includes("/deployments")||(e.path=`/deployments/${t}${e.path}`)}return super.buildRequest(e,t)}async _getAzureADToken(){if("function"==typeof this._azureADTokenProvider){const e=await this._azureADTokenProvider();if(!e||"string"!=typeof e)throw new w_(`Expected 'azureADTokenProvider' argument to return a string but it returned ${e}`);return e}}authHeaders(e){return{}}async prepareOptions(e){if(e.headers?.["api-key"])return super.prepareOptions(e);const t=await this._getAzureADToken();if(e.headers??(e.headers={}),t)e.headers.Authorization=`Bearer ${t}`;else{if(this.apiKey===hz)throw new w_("Unable to handle auth");e.headers["api-key"]=this.apiKey}return super.prepareOptions(e)}}const dz=new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]),hz="<Missing Key>",pz=e=>({type:"function",name:e.name,description:e.description,parameters:e.inputSchema,strict:!1});class gz{constructor(e){this.previousResponse=e}async addStateToRequest(e){return e.previous_response_id=this.previousResponse.id,e}lastOutputs(){return this.previousResponse.output.map((e=>{if("message"===e.type){const t=e.content.map((t=>({type:"text",text:"output_text"===t.type?t.text:t.refusal,rawOutput:e})));return{type:"output_text",content:t}}return"function_call"===e.type?{type:"function_call",name:e.name,arguments:JSON.parse(e.arguments),callId:e.call_id,rawOutput:e}:"reasoning"===e.type?{type:"reasoning",rawOutput:e}:{type:"unknown",rawOutput:e}}))}}class mz{constructor(e){const{endpoint:t,deployment:n,apiKey:r}=e,s={endpoint:t,apiKey:r,deployment:n,apiVersion:"2025-03-01-preview",dangerouslyAllowBrowser:!0};this.openai=new uz(s),this._modelConfig=e}async makeRequest(e,t,n,r){const s={model:this._modelConfig.modelName,tools:t.map(pz),input:e};return n&&await n.addStateToRequest(s),new gz(await this.openai.responses.create(s))}convertToolOutputToBackendInput(e,t){return[{type:"function_call_output",call_id:e.callId,output:t,status:"completed"}]}}const fz=e=>new mz({apiKey:e,modelName:"gpt-4.1",deployment:"gpt-4.1",endpoint:"https://oai-aman-eastus2.openai.azure.com/"}),yz=e=>new FP({modelName:"claude-3-7-sonnet-latest",apiAuth:[e],maxTokens:64e3,streaming:!0}),vz=e=>new FP({modelName:"claude-sonnet-4-20250514",apiAuth:[e],maxTokens:64e3,streaming:!0}),bz=e=>new zO({modelName:"arn:aws:bedrock:us-east-2:898288999649:inference-profile/us.anthropic.claude-3-7-sonnet-20250219-v1:0",apiAuth:e,region:"us-east-2",maxTokens:64e3,streaming:!0}),Cz=e=>new zO({modelName:"arn:aws:bedrock:us-east-2:898288999649:inference-profile/us.anthropic.claude-sonnet-4-20250514-v1:0",apiAuth:e,region:"us-east-2",maxTokens:64e3,streaming:!0});async function wz(e,t){const n=t?.maxRetries??7;for(let r=0;r<n;r++)try{return await e()}catch(e){const s=r+1<n?t?.onRetry:t?.onFail;s?.(e)}throw Error("Max retries exceeded")}var Sz,Ez;!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),r={};for(const e of n)r[e]=t[e];return e.objectValues(r)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(Sz||(Sz={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(Ez||(Ez={}));const xz=Sz.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Iz=e=>{switch(typeof e){case"undefined":return xz.undefined;case"string":return xz.string;case"number":return isNaN(e)?xz.nan:xz.number;case"boolean":return xz.boolean;case"function":return xz.function;case"bigint":return xz.bigint;case"symbol":return xz.symbol;case"object":return Array.isArray(e)?xz.array:null===e?xz.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?xz.promise:"undefined"!=typeof Map&&e instanceof Map?xz.map:"undefined"!=typeof Set&&e instanceof Set?xz.set:"undefined"!=typeof Date&&e instanceof Date?xz.date:xz.object;default:return xz.unknown}},Az=Sz.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Pz extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},n={_errors:[]},r=e=>{for(const s of e.issues)if("invalid_union"===s.code)s.unionErrors.map(r);else if("invalid_return_type"===s.code)r(s.returnTypeError);else if("invalid_arguments"===s.code)r(s.argumentsError);else if(0===s.path.length)n._errors.push(t(s));else{let e=n,r=0;for(;r<s.path.length;){const n=s.path[r];r===s.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(s))):e[n]=e[n]||{_errors:[]},e=e[n],r++}}};return r(this),n}static assert(e){if(!(e instanceof Pz))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Sz.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},n=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Pz.create=e=>new Pz(e);const kz=(e,t)=>{let n;switch(e.code){case Az.invalid_type:n=e.received===xz.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case Az.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Sz.jsonStringifyReplacer)}`;break;case Az.unrecognized_keys:n=`Unrecognized key(s) in object: ${Sz.joinValues(e.keys,", ")}`;break;case Az.invalid_union:n="Invalid input";break;case Az.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Sz.joinValues(e.options)}`;break;case Az.invalid_enum_value:n=`Invalid enum value. Expected ${Sz.joinValues(e.options)}, received '${e.received}'`;break;case Az.invalid_arguments:n="Invalid function arguments";break;case Az.invalid_return_type:n="Invalid function return type";break;case Az.invalid_date:n="Invalid date";break;case Az.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Sz.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case Az.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case Az.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case Az.custom:n="Invalid input";break;case Az.invalid_intersection_types:n="Intersection results could not be merged";break;case Az.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Az.not_finite:n="Number must be finite";break;default:n=t.defaultError,Sz.assertNever(e)}return{message:n}};let Tz=kz;function Dz(){return Tz}const Mz=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(void 0!==s.message)return{...s,path:i,message:s.message};let o="";const l=r.filter((e=>!!e)).slice().reverse();for(const e of l)o=e(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function Lz(e,t){const n=Dz(),r=Mz({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===kz?void 0:kz].filter((e=>!!e))});e.common.issues.push(r)}class Rz{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if("aborted"===r.status)return Nz;"dirty"===r.status&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const e of t){const t=await e.key,r=await e.value;n.push({key:t,value:r})}return Rz.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:t,value:s}=r;if("aborted"===t.status)return Nz;if("aborted"===s.status)return Nz;"dirty"===t.status&&e.dirty(),"dirty"===s.status&&e.dirty(),"__proto__"===t.value||void 0===s.value&&!r.alwaysSet||(n[t.value]=s.value)}return{status:e.value,value:n}}}const Nz=Object.freeze({status:"aborted"}),Oz=e=>({status:"dirty",value:e}),_z=e=>({status:"valid",value:e}),Bz=e=>"aborted"===e.status,Fz=e=>"dirty"===e.status,Uz=e=>"valid"===e.status,Hz=e=>"undefined"!=typeof Promise&&e instanceof Promise;function zz(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function jz(e,t,n,r,s){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?s.call(e,n):s?s.value=n:t.set(e,n),n}var Vz,qz,Wz;"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(Vz||(Vz={}));class Qz{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Gz=(e,t)=>{if(Uz(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Pz(e.common.issues);return this._error=t,this._error}}};function Zz(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:s};return{errorMap:(t,s)=>{var i,a;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:s.defaultError}:void 0===s.data?{message:null!==(i=null!=o?o:r)&&void 0!==i?i:s.defaultError}:"invalid_type"!==t.code?{message:s.defaultError}:{message:null!==(a=null!=o?o:n)&&void 0!==a?a:s.defaultError}},description:s}}class Yz{get description(){return this._def.description}_getType(e){return Iz(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Iz(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Rz,ctx:{common:e.parent.common,data:e.data,parsedType:Iz(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Hz(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const r={common:{issues:[],async:null!==(n=null==t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Iz(e)},s=this._parseSync({data:e,path:r.path,parent:r});return Gz(r,s)}"~validate"(e){var t,n;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Iz(e)};if(!this["~standard"].async)try{const t=this._parseSync({data:e,path:[],parent:r});return Uz(t)?{value:t.value}:{issues:r.common.issues}}catch(e){(null===(n=null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.toLowerCase())||void 0===n?void 0:n.includes("encountered"))&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then((e=>Uz(e)?{value:e.value}:{issues:r.common.issues}))}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Iz(e)},r=this._parse({data:e,path:n.path,parent:n}),s=await(Hz(r)?r:Promise.resolve(r));return Gz(n,s)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,r)=>{const s=e(t),i=()=>r.addIssue({code:Az.custom,...n(t)});return"undefined"!=typeof Promise&&s instanceof Promise?s.then((e=>!!e||(i(),!1))):!!s||(i(),!1)}))}refinement(e,t){return this._refinement(((n,r)=>!!e(n)||(r.addIssue("function"==typeof t?t(n,r):t),!1)))}_refinement(e){return new Yj({schema:this,typeName:lV.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return Kj.create(this,this._def)}nullable(){return Jj.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Dj.create(this)}promise(){return Zj.create(this,this._def)}or(e){return Rj.create([this,e],this._def)}and(e){return Bj.create(this,e,this._def)}transform(e){return new Yj({...Zz(this._def),schema:this,typeName:lV.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Xj({...Zz(this._def),innerType:this,defaultValue:t,typeName:lV.ZodDefault})}brand(){return new nV({typeName:lV.ZodBranded,type:this,...Zz(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new $j({...Zz(this._def),innerType:this,catchValue:t,typeName:lV.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return rV.create(this,e)}readonly(){return sV.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Kz=/^c[^\s-]{8,}$/i,Jz=/^[0-9a-z]+$/,Xz=/^[0-9A-HJKMNP-TV-Z]{26}$/i,$z=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ej=/^[a-z0-9_-]{21}$/i,tj=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,nj=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,rj=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let sj;const ij=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,aj=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,oj=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,lj=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,cj=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,uj=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dj="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",hj=new RegExp(`^${dj}$`);function pj(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${e.precision?"+":"?"}`}function gj(e){let t=`${dj}T${pj(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function mj(e,t){if(!tj.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return"object"==typeof s&&null!==s&&(!(!s.typ||!s.alg)&&(!t||s.alg===t))}catch(e){return!1}}function fj(e,t){return!("v4"!==t&&t||!aj.test(e))||!("v6"!==t&&t||!lj.test(e))}class yj extends Yz{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==xz.string){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.string,received:t.parsedType}),Nz}const t=new Rz;let n;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const r=e.data.length>i.value,s=e.data.length<i.value;(r||s)&&(n=this._getOrReturnCtx(e,n),r?Lz(n,{code:Az.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):s&&Lz(n,{code:Az.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)rj.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"email",code:Az.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)sj||(sj=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),sj.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"emoji",code:Az.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)$z.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"uuid",code:Az.invalid_string,message:i.message}),t.dirty());else if("nanoid"===i.kind)ej.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"nanoid",code:Az.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)Kz.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"cuid",code:Az.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)Jz.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"cuid2",code:Az.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)Xz.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"ulid",code:Az.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(r){n=this._getOrReturnCtx(e,n),Lz(n,{validation:"url",code:Az.invalid_string,message:i.message}),t.dirty()}else if("regex"===i.kind){i.regex.lastIndex=0;i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"regex",code:Az.invalid_string,message:i.message}),t.dirty())}else if("trim"===i.kind)e.data=e.data.trim();else if("includes"===i.kind)e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty());else if("toLowerCase"===i.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===i.kind)e.data=e.data.toUpperCase();else if("startsWith"===i.kind)e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty());else if("endsWith"===i.kind)e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty());else if("datetime"===i.kind){gj(i).test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.invalid_string,validation:"datetime",message:i.message}),t.dirty())}else if("date"===i.kind){hj.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.invalid_string,validation:"date",message:i.message}),t.dirty())}else if("time"===i.kind){new RegExp(`^${pj(i)}$`).test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.invalid_string,validation:"time",message:i.message}),t.dirty())}else"duration"===i.kind?nj.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"duration",code:Az.invalid_string,message:i.message}),t.dirty()):"ip"===i.kind?(r=e.data,("v4"!==(s=i.version)&&s||!ij.test(r))&&("v6"!==s&&s||!oj.test(r))&&(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"ip",code:Az.invalid_string,message:i.message}),t.dirty())):"jwt"===i.kind?mj(e.data,i.alg)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"jwt",code:Az.invalid_string,message:i.message}),t.dirty()):"cidr"===i.kind?fj(e.data,i.version)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"cidr",code:Az.invalid_string,message:i.message}),t.dirty()):"base64"===i.kind?cj.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"base64",code:Az.invalid_string,message:i.message}),t.dirty()):"base64url"===i.kind?uj.test(e.data)||(n=this._getOrReturnCtx(e,n),Lz(n,{validation:"base64url",code:Az.invalid_string,message:i.message}),t.dirty()):Sz.assertNever(i);var r,s;return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:Az.invalid_string,...Vz.errToObj(n)})}_addCheck(e){return new yj({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Vz.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Vz.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Vz.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Vz.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Vz.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Vz.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Vz.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Vz.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Vz.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Vz.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Vz.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Vz.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Vz.errToObj(e)})}datetime(e){var t,n;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null==e?void 0:e.local)&&void 0!==n&&n,...Vz.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...Vz.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Vz.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Vz.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...Vz.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Vz.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Vz.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Vz.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Vz.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Vz.errToObj(t)})}nonempty(e){return this.min(1,Vz.errToObj(e))}trim(){return new yj({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new yj({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new yj({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isCIDR(){return!!this._def.checks.find((e=>"cidr"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get isBase64url(){return!!this._def.checks.find((e=>"base64url"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function vj(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r;return parseInt(e.toFixed(s).replace(".",""))%parseInt(t.toFixed(s).replace(".",""))/Math.pow(10,s)}yj.create=e=>{var t;return new yj({checks:[],typeName:lV.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Zz(e)})};class bj extends Yz{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==xz.number){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.number,received:t.parsedType}),Nz}let t;const n=new Rz;for(const r of this._def.checks)if("int"===r.kind)Sz.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),Lz(t,{code:Az.invalid_type,expected:"integer",received:"float",message:r.message}),n.dirty());else if("min"===r.kind){(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),Lz(t,{code:Az.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else if("max"===r.kind){(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),Lz(t,{code:Az.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),n.dirty())}else"multipleOf"===r.kind?0!==vj(e.data,r.value)&&(t=this._getOrReturnCtx(e,t),Lz(t,{code:Az.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),Lz(t,{code:Az.not_finite,message:r.message}),n.dirty()):Sz.assertNever(r);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Vz.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Vz.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Vz.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Vz.toString(t))}setLimit(e,t,n,r){return new bj({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Vz.toString(r)}]})}_addCheck(e){return new bj({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Vz.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Vz.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Vz.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Vz.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Vz.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Vz.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Vz.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Vz.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Vz.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&Sz.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}bj.create=e=>new bj({checks:[],typeName:lV.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...Zz(e)});class Cj extends Yz{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch(t){return this._getInvalidInput(e)}if(this._getType(e)!==xz.bigint)return this._getInvalidInput(e);let t;const n=new Rz;for(const r of this._def.checks)if("min"===r.kind){(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),Lz(t,{code:Az.too_small,type:"bigint",minimum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty())}else if("max"===r.kind){(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),Lz(t,{code:Az.too_big,type:"bigint",maximum:r.value,inclusive:r.inclusive,message:r.message}),n.dirty())}else"multipleOf"===r.kind?e.data%r.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),Lz(t,{code:Az.not_multiple_of,multipleOf:r.value,message:r.message}),n.dirty()):Sz.assertNever(r);return{status:n.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.bigint,received:t.parsedType}),Nz}gte(e,t){return this.setLimit("min",e,!0,Vz.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Vz.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Vz.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Vz.toString(t))}setLimit(e,t,n,r){return new Cj({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:Vz.toString(r)}]})}_addCheck(e){return new Cj({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Vz.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Vz.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Vz.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Vz.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Vz.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Cj.create=e=>{var t;return new Cj({checks:[],typeName:lV.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Zz(e)})};class wj extends Yz{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==xz.boolean){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.boolean,received:t.parsedType}),Nz}return _z(e.data)}}wj.create=e=>new wj({typeName:lV.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...Zz(e)});class Sj extends Yz{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==xz.date){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.date,received:t.parsedType}),Nz}if(isNaN(e.data.getTime())){return Lz(this._getOrReturnCtx(e),{code:Az.invalid_date}),Nz}const t=new Rz;let n;for(const r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),t.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(n=this._getOrReturnCtx(e,n),Lz(n,{code:Az.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),t.dirty()):Sz.assertNever(r);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Sj({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Vz.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Vz.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}Sj.create=e=>new Sj({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:lV.ZodDate,...Zz(e)});class Ej extends Yz{_parse(e){if(this._getType(e)!==xz.symbol){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.symbol,received:t.parsedType}),Nz}return _z(e.data)}}Ej.create=e=>new Ej({typeName:lV.ZodSymbol,...Zz(e)});class xj extends Yz{_parse(e){if(this._getType(e)!==xz.undefined){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.undefined,received:t.parsedType}),Nz}return _z(e.data)}}xj.create=e=>new xj({typeName:lV.ZodUndefined,...Zz(e)});class Ij extends Yz{_parse(e){if(this._getType(e)!==xz.null){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.null,received:t.parsedType}),Nz}return _z(e.data)}}Ij.create=e=>new Ij({typeName:lV.ZodNull,...Zz(e)});class Aj extends Yz{constructor(){super(...arguments),this._any=!0}_parse(e){return _z(e.data)}}Aj.create=e=>new Aj({typeName:lV.ZodAny,...Zz(e)});class Pj extends Yz{constructor(){super(...arguments),this._unknown=!0}_parse(e){return _z(e.data)}}Pj.create=e=>new Pj({typeName:lV.ZodUnknown,...Zz(e)});class kj extends Yz{_parse(e){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.never,received:t.parsedType}),Nz}}kj.create=e=>new kj({typeName:lV.ZodNever,...Zz(e)});class Tj extends Yz{_parse(e){if(this._getType(e)!==xz.undefined){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.void,received:t.parsedType}),Nz}return _z(e.data)}}Tj.create=e=>new Tj({typeName:lV.ZodVoid,...Zz(e)});class Dj extends Yz{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==xz.array)return Lz(t,{code:Az.invalid_type,expected:xz.array,received:t.parsedType}),Nz;if(null!==r.exactLength){const e=t.data.length>r.exactLength.value,s=t.data.length<r.exactLength.value;(e||s)&&(Lz(t,{code:e?Az.too_big:Az.too_small,minimum:s?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(Lz(t,{code:Az.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(Lz(t,{code:Az.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>r.type._parseAsync(new Qz(t,e,t.path,n))))).then((e=>Rz.mergeArray(n,e)));const s=[...t.data].map(((e,n)=>r.type._parseSync(new Qz(t,e,t.path,n))));return Rz.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new Dj({...this._def,minLength:{value:e,message:Vz.toString(t)}})}max(e,t){return new Dj({...this._def,maxLength:{value:e,message:Vz.toString(t)}})}length(e,t){return new Dj({...this._def,exactLength:{value:e,message:Vz.toString(t)}})}nonempty(e){return this.min(1,e)}}function Mj(e){if(e instanceof Lj){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Kj.create(Mj(r))}return new Lj({...e._def,shape:()=>t})}return e instanceof Dj?new Dj({...e._def,type:Mj(e.element)}):e instanceof Kj?Kj.create(Mj(e.unwrap())):e instanceof Jj?Jj.create(Mj(e.unwrap())):e instanceof Fj?Fj.create(e.items.map((e=>Mj(e)))):e}Dj.create=(e,t)=>new Dj({type:e,minLength:null,maxLength:null,exactLength:null,typeName:lV.ZodArray,...Zz(t)});class Lj extends Yz{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=Sz.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==xz.object){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.object,received:t.parsedType}),Nz}const{status:t,ctx:n}=this._processInputParams(e),{shape:r,keys:s}=this._getCached(),i=[];if(!(this._def.catchall instanceof kj&&"strip"===this._def.unknownKeys))for(const e in n.data)s.includes(e)||i.push(e);const a=[];for(const e of s){const t=r[e],s=n.data[e];a.push({key:{status:"valid",value:e},value:t._parse(new Qz(n,s,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof kj){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of i)a.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)i.length>0&&(Lz(n,{code:Az.unrecognized_keys,keys:i}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of i){const r=n.data[t];a.push({key:{status:"valid",value:t},value:e._parse(new Qz(n,r,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of a){const n=await t.key,r=await t.value;e.push({key:n,value:r,alwaysSet:t.alwaysSet})}return e})).then((e=>Rz.mergeObjectSync(t,e))):Rz.mergeObjectSync(t,a)}get shape(){return this._def.shape()}strict(e){return Vz.errToObj,new Lj({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var r,s,i,a;const o=null!==(i=null===(s=(r=this._def).errorMap)||void 0===s?void 0:s.call(r,t,n).message)&&void 0!==i?i:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(a=Vz.errToObj(e).message)&&void 0!==a?a:o}:{message:o}}}:{}})}strip(){return new Lj({...this._def,unknownKeys:"strip"})}passthrough(){return new Lj({...this._def,unknownKeys:"passthrough"})}extend(e){return new Lj({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Lj({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:lV.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Lj({...this._def,catchall:e})}pick(e){const t={};return Sz.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new Lj({...this._def,shape:()=>t})}omit(e){const t={};return Sz.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new Lj({...this._def,shape:()=>t})}deepPartial(){return Mj(this)}partial(e){const t={};return Sz.objectKeys(this.shape).forEach((n=>{const r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()})),new Lj({...this._def,shape:()=>t})}required(e){const t={};return Sz.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof Kj;)e=e._def.innerType;t[n]=e}})),new Lj({...this._def,shape:()=>t})}keyof(){return Wj(Sz.objectKeys(this.shape))}}Lj.create=(e,t)=>new Lj({shape:()=>e,unknownKeys:"strip",catchall:kj.create(),typeName:lV.ZodObject,...Zz(t)}),Lj.strictCreate=(e,t)=>new Lj({shape:()=>e,unknownKeys:"strict",catchall:kj.create(),typeName:lV.ZodObject,...Zz(t)}),Lj.lazycreate=(e,t)=>new Lj({shape:e,unknownKeys:"strip",catchall:kj.create(),typeName:lV.ZodObject,...Zz(t)});class Rj extends Yz{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const n=e.map((e=>new Pz(e.ctx.common.issues)));return Lz(t,{code:Az.invalid_union,unionErrors:n}),Nz}));{let e;const r=[];for(const s of n){const n={...t,common:{...t.common,issues:[]},parent:null},i=s._parseSync({data:t.data,path:t.path,parent:n});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:n}),n.common.issues.length&&r.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const s=r.map((e=>new Pz(e)));return Lz(t,{code:Az.invalid_union,unionErrors:s}),Nz}}get options(){return this._def.options}}Rj.create=(e,t)=>new Rj({options:e,typeName:lV.ZodUnion,...Zz(t)});const Nj=e=>e instanceof Vj?Nj(e.schema):e instanceof Yj?Nj(e.innerType()):e instanceof qj?[e.value]:e instanceof Qj?e.options:e instanceof Gj?Sz.objectValues(e.enum):e instanceof Xj?Nj(e._def.innerType):e instanceof xj?[void 0]:e instanceof Ij?[null]:e instanceof Kj?[void 0,...Nj(e.unwrap())]:e instanceof Jj?[null,...Nj(e.unwrap())]:e instanceof nV||e instanceof sV?Nj(e.unwrap()):e instanceof $j?Nj(e._def.innerType):[];class Oj extends Yz{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==xz.object)return Lz(t,{code:Az.invalid_type,expected:xz.object,received:t.parsedType}),Nz;const n=this.discriminator,r=t.data[n],s=this.optionsMap.get(r);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(Lz(t,{code:Az.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Nz)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const r=new Map;for(const n of t){const t=Nj(n.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const s of t){if(r.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);r.set(s,n)}}return new Oj({typeName:lV.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...Zz(n)})}}function _j(e,t){const n=Iz(e),r=Iz(t);if(e===t)return{valid:!0,data:e};if(n===xz.object&&r===xz.object){const n=Sz.objectKeys(t),r=Sz.objectKeys(e).filter((e=>-1!==n.indexOf(e))),s={...e,...t};for(const n of r){const r=_j(e[n],t[n]);if(!r.valid)return{valid:!1};s[n]=r.data}return{valid:!0,data:s}}if(n===xz.array&&r===xz.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let r=0;r<e.length;r++){const s=_j(e[r],t[r]);if(!s.valid)return{valid:!1};n.push(s.data)}return{valid:!0,data:n}}return n===xz.date&&r===xz.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}class Bj extends Yz{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(e,r)=>{if(Bz(e)||Bz(r))return Nz;const s=_j(e.value,r.value);return s.valid?((Fz(e)||Fz(r))&&t.dirty(),{status:t.value,value:s.data}):(Lz(n,{code:Az.invalid_intersection_types}),Nz)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>r(e,t))):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Bj.create=(e,t,n)=>new Bj({left:e,right:t,typeName:lV.ZodIntersection,...Zz(n)});class Fj extends Yz{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==xz.array)return Lz(n,{code:Az.invalid_type,expected:xz.array,received:n.parsedType}),Nz;if(n.data.length<this._def.items.length)return Lz(n,{code:Az.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Nz;!this._def.rest&&n.data.length>this._def.items.length&&(Lz(n,{code:Az.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...n.data].map(((e,t)=>{const r=this._def.items[t]||this._def.rest;return r?r._parse(new Qz(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(r).then((e=>Rz.mergeArray(t,e))):Rz.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new Fj({...this._def,rest:e})}}Fj.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Fj({items:e,typeName:lV.ZodTuple,rest:null,...Zz(t)})};class Uj extends Yz{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==xz.object)return Lz(n,{code:Az.invalid_type,expected:xz.object,received:n.parsedType}),Nz;const r=[],s=this._def.keyType,i=this._def.valueType;for(const e in n.data)r.push({key:s._parse(new Qz(n,e,n.path,e)),value:i._parse(new Qz(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?Rz.mergeObjectAsync(t,r):Rz.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,n){return new Uj(t instanceof Yz?{keyType:e,valueType:t,typeName:lV.ZodRecord,...Zz(n)}:{keyType:yj.create(),valueType:e,typeName:lV.ZodRecord,...Zz(t)})}}class Hj extends Yz{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==xz.map)return Lz(n,{code:Az.invalid_type,expected:xz.map,received:n.parsedType}),Nz;const r=this._def.keyType,s=this._def.valueType,i=[...n.data.entries()].map((([e,t],i)=>({key:r._parse(new Qz(n,e,n.path,[i,"key"])),value:s._parse(new Qz(n,t,n.path,[i,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of i){const r=await n.key,s=await n.value;if("aborted"===r.status||"aborted"===s.status)return Nz;"dirty"!==r.status&&"dirty"!==s.status||t.dirty(),e.set(r.value,s.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of i){const r=n.key,s=n.value;if("aborted"===r.status||"aborted"===s.status)return Nz;"dirty"!==r.status&&"dirty"!==s.status||t.dirty(),e.set(r.value,s.value)}return{status:t.value,value:e}}}}Hj.create=(e,t,n)=>new Hj({valueType:t,keyType:e,typeName:lV.ZodMap,...Zz(n)});class zj extends Yz{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==xz.set)return Lz(n,{code:Az.invalid_type,expected:xz.set,received:n.parsedType}),Nz;const r=this._def;null!==r.minSize&&n.data.size<r.minSize.value&&(Lz(n,{code:Az.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&n.data.size>r.maxSize.value&&(Lz(n,{code:Az.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const s=this._def.valueType;function i(e){const n=new Set;for(const r of e){if("aborted"===r.status)return Nz;"dirty"===r.status&&t.dirty(),n.add(r.value)}return{status:t.value,value:n}}const a=[...n.data.values()].map(((e,t)=>s._parse(new Qz(n,e,n.path,t))));return n.common.async?Promise.all(a).then((e=>i(e))):i(a)}min(e,t){return new zj({...this._def,minSize:{value:e,message:Vz.toString(t)}})}max(e,t){return new zj({...this._def,maxSize:{value:e,message:Vz.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}zj.create=(e,t)=>new zj({valueType:e,minSize:null,maxSize:null,typeName:lV.ZodSet,...Zz(t)});class jj extends Yz{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==xz.function)return Lz(t,{code:Az.invalid_type,expected:xz.function,received:t.parsedType}),Nz;function n(e,n){return Mz({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Dz(),kz].filter((e=>!!e)),issueData:{code:Az.invalid_arguments,argumentsError:n}})}function r(e,n){return Mz({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Dz(),kz].filter((e=>!!e)),issueData:{code:Az.invalid_return_type,returnTypeError:n}})}const s={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof Zj){const e=this;return _z((async function(...t){const a=new Pz([]),o=await e._def.args.parseAsync(t,s).catch((e=>{throw a.addIssue(n(t,e)),a})),l=await Reflect.apply(i,this,o),c=await e._def.returns._def.type.parseAsync(l,s).catch((e=>{throw a.addIssue(r(l,e)),a}));return c}))}{const e=this;return _z((function(...t){const a=e._def.args.safeParse(t,s);if(!a.success)throw new Pz([n(t,a.error)]);const o=Reflect.apply(i,this,a.data),l=e._def.returns.safeParse(o,s);if(!l.success)throw new Pz([r(o,l.error)]);return l.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new jj({...this._def,args:Fj.create(e).rest(Pj.create())})}returns(e){return new jj({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new jj({args:e||Fj.create([]).rest(Pj.create()),returns:t||Pj.create(),typeName:lV.ZodFunction,...Zz(n)})}}class Vj extends Yz{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Vj.create=(e,t)=>new Vj({getter:e,typeName:lV.ZodLazy,...Zz(t)});class qj extends Yz{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Lz(t,{received:t.data,code:Az.invalid_literal,expected:this._def.value}),Nz}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Wj(e,t){return new Qj({values:e,typeName:lV.ZodEnum,...Zz(t)})}qj.create=(e,t)=>new qj({value:e,typeName:lV.ZodLiteral,...Zz(t)});class Qj extends Yz{constructor(){super(...arguments),qz.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return Lz(t,{expected:Sz.joinValues(n),received:t.parsedType,code:Az.invalid_type}),Nz}if(zz(this,qz,"f")||jz(this,qz,new Set(this._def.values),"f"),!zz(this,qz,"f").has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return Lz(t,{received:t.data,code:Az.invalid_enum_value,options:n}),Nz}return _z(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Qj.create(e,{...this._def,...t})}exclude(e,t=this._def){return Qj.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}qz=new WeakMap,Qj.create=Wj;class Gj extends Yz{constructor(){super(...arguments),Wz.set(this,void 0)}_parse(e){const t=Sz.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==xz.string&&n.parsedType!==xz.number){const e=Sz.objectValues(t);return Lz(n,{expected:Sz.joinValues(e),received:n.parsedType,code:Az.invalid_type}),Nz}if(zz(this,Wz,"f")||jz(this,Wz,new Set(Sz.getValidEnumValues(this._def.values)),"f"),!zz(this,Wz,"f").has(e.data)){const e=Sz.objectValues(t);return Lz(n,{received:n.data,code:Az.invalid_enum_value,options:e}),Nz}return _z(e.data)}get enum(){return this._def.values}}Wz=new WeakMap,Gj.create=(e,t)=>new Gj({values:e,typeName:lV.ZodNativeEnum,...Zz(t)});class Zj extends Yz{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==xz.promise&&!1===t.common.async)return Lz(t,{code:Az.invalid_type,expected:xz.promise,received:t.parsedType}),Nz;const n=t.parsedType===xz.promise?t.data:Promise.resolve(t.data);return _z(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}Zj.create=(e,t)=>new Zj({type:e,typeName:lV.ZodPromise,...Zz(t)});class Yj extends Yz{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===lV.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,s={addIssue:e=>{Lz(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===r.type){const e=r.transform(n.data,s);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return Nz;const r=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===r.status?Nz:"dirty"===r.status||"dirty"===t.value?Oz(r.value):r}));{if("aborted"===t.value)return Nz;const r=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===r.status?Nz:"dirty"===r.status||"dirty"===t.value?Oz(r.value):r}}if("refinement"===r.type){const e=e=>{const t=r.refinement(e,s);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const r=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===r.status?Nz:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?Nz:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===r.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Uz(e))return e;const i=r.transform(e.value,s);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>Uz(e)?Promise.resolve(r.transform(e.value,s)).then((e=>({status:t.value,value:e}))):e))}Sz.assertNever(r)}}Yj.create=(e,t,n)=>new Yj({schema:e,typeName:lV.ZodEffects,effect:t,...Zz(n)}),Yj.createWithPreprocess=(e,t,n)=>new Yj({schema:t,effect:{type:"preprocess",transform:e},typeName:lV.ZodEffects,...Zz(n)});class Kj extends Yz{_parse(e){return this._getType(e)===xz.undefined?_z(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Kj.create=(e,t)=>new Kj({innerType:e,typeName:lV.ZodOptional,...Zz(t)});class Jj extends Yz{_parse(e){return this._getType(e)===xz.null?_z(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Jj.create=(e,t)=>new Jj({innerType:e,typeName:lV.ZodNullable,...Zz(t)});class Xj extends Yz{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===xz.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Xj.create=(e,t)=>new Xj({innerType:e,typeName:lV.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Zz(t)});class $j extends Yz{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Hz(r)?r.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Pz(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new Pz(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}$j.create=(e,t)=>new $j({innerType:e,typeName:lV.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Zz(t)});class eV extends Yz{_parse(e){if(this._getType(e)!==xz.nan){const t=this._getOrReturnCtx(e);return Lz(t,{code:Az.invalid_type,expected:xz.nan,received:t.parsedType}),Nz}return{status:"valid",value:e.data}}}eV.create=e=>new eV({typeName:lV.ZodNaN,...Zz(e)});const tV=Symbol("zod_brand");class nV extends Yz{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class rV extends Yz{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?Nz:"dirty"===e.status?(t.dirty(),Oz(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?Nz:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new rV({in:e,out:t,typeName:lV.ZodPipeline})}}class sV extends Yz{_parse(e){const t=this._def.innerType._parse(e),n=e=>(Uz(e)&&(e.value=Object.freeze(e.value)),e);return Hz(t)?t.then((e=>n(e))):n(t)}unwrap(){return this._def.innerType}}function iV(e,t){const n="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof n?{message:n}:n}function aV(e,t={},n){return e?Aj.create().superRefine(((r,s)=>{var i,a;const o=e(r);if(o instanceof Promise)return o.then((e=>{var i,a;if(!e){const e=iV(t,r),o=null===(a=null!==(i=e.fatal)&&void 0!==i?i:n)||void 0===a||a;s.addIssue({code:"custom",...e,fatal:o})}}));if(!o){const e=iV(t,r),o=null===(a=null!==(i=e.fatal)&&void 0!==i?i:n)||void 0===a||a;s.addIssue({code:"custom",...e,fatal:o})}})):Aj.create()}sV.create=(e,t)=>new sV({innerType:e,typeName:lV.ZodReadonly,...Zz(t)});const oV={object:Lj.lazycreate};var lV;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(lV||(lV={}));const cV=yj.create,uV=bj.create,dV=eV.create,hV=Cj.create,pV=wj.create,gV=Sj.create,mV=Ej.create,fV=xj.create,yV=Ij.create,vV=Aj.create,bV=Pj.create,CV=kj.create,wV=Tj.create,SV=Dj.create,EV=Lj.create,xV=Lj.strictCreate,IV=Rj.create,AV=Oj.create,PV=Bj.create,kV=Fj.create,TV=Uj.create,DV=Hj.create,MV=zj.create,LV=jj.create,RV=Vj.create,NV=qj.create,OV=Qj.create,_V=Gj.create,BV=Zj.create,FV=Yj.create,UV=Kj.create,HV=Jj.create,zV=Yj.createWithPreprocess,jV=rV.create,VV={string:e=>yj.create({...e,coerce:!0}),number:e=>bj.create({...e,coerce:!0}),boolean:e=>wj.create({...e,coerce:!0}),bigint:e=>Cj.create({...e,coerce:!0}),date:e=>Sj.create({...e,coerce:!0})},qV=Nz;var WV=Object.freeze({__proto__:null,defaultErrorMap:kz,setErrorMap:function(e){Tz=e},getErrorMap:Dz,makeIssue:Mz,EMPTY_PATH:[],addIssueToContext:Lz,ParseStatus:Rz,INVALID:Nz,DIRTY:Oz,OK:_z,isAborted:Bz,isDirty:Fz,isValid:Uz,isAsync:Hz,get util(){return Sz},get objectUtil(){return Ez},ZodParsedType:xz,getParsedType:Iz,ZodType:Yz,datetimeRegex:gj,ZodString:yj,ZodNumber:bj,ZodBigInt:Cj,ZodBoolean:wj,ZodDate:Sj,ZodSymbol:Ej,ZodUndefined:xj,ZodNull:Ij,ZodAny:Aj,ZodUnknown:Pj,ZodNever:kj,ZodVoid:Tj,ZodArray:Dj,ZodObject:Lj,ZodUnion:Rj,ZodDiscriminatedUnion:Oj,ZodIntersection:Bj,ZodTuple:Fj,ZodRecord:Uj,ZodMap:Hj,ZodSet:zj,ZodFunction:jj,ZodLazy:Vj,ZodLiteral:qj,ZodEnum:Qj,ZodNativeEnum:Gj,ZodPromise:Zj,ZodEffects:Yj,ZodTransformer:Yj,ZodOptional:Kj,ZodNullable:Jj,ZodDefault:Xj,ZodCatch:$j,ZodNaN:eV,BRAND:tV,ZodBranded:nV,ZodPipeline:rV,ZodReadonly:sV,custom:aV,Schema:Yz,ZodSchema:Yz,late:oV,get ZodFirstPartyTypeKind(){return lV},coerce:VV,any:vV,array:SV,bigint:hV,boolean:pV,date:gV,discriminatedUnion:AV,effect:FV,enum:OV,function:LV,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>aV((t=>t instanceof e),t),intersection:PV,lazy:RV,literal:NV,map:DV,nan:dV,nativeEnum:_V,never:CV,null:yV,nullable:HV,number:uV,object:EV,oboolean:()=>pV().optional(),onumber:()=>uV().optional(),optional:UV,ostring:()=>cV().optional(),pipeline:jV,preprocess:zV,promise:BV,record:TV,set:MV,strictObject:xV,string:cV,symbol:mV,transformer:FV,tuple:kV,undefined:fV,union:IV,unknown:bV,void:wV,NEVER:qV,ZodIssueCode:Az,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:Pz});const QV="2025-03-26",GV=[QV,"2024-11-05","2024-10-07"],ZV="2.0",YV=WV.union([WV.string(),WV.number().int()]),KV=WV.string(),JV=WV.object({progressToken:WV.optional(YV)}).passthrough(),XV=WV.object({_meta:WV.optional(JV)}).passthrough(),$V=WV.object({method:WV.string(),params:WV.optional(XV)}),eq=WV.object({_meta:WV.optional(WV.object({}).passthrough())}).passthrough(),tq=WV.object({method:WV.string(),params:WV.optional(eq)}),nq=WV.object({_meta:WV.optional(WV.object({}).passthrough())}).passthrough(),rq=WV.union([WV.string(),WV.number().int()]),sq=WV.object({jsonrpc:WV.literal(ZV),id:rq}).merge($V).strict(),iq=e=>sq.safeParse(e).success,aq=WV.object({jsonrpc:WV.literal(ZV)}).merge(tq).strict(),oq=WV.object({jsonrpc:WV.literal(ZV),id:rq,result:nq}).strict(),lq=e=>oq.safeParse(e).success;var cq;!function(e){e[e.ConnectionClosed=-32e3]="ConnectionClosed",e[e.RequestTimeout=-32001]="RequestTimeout",e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError"}(cq||(cq={}));const uq=WV.object({jsonrpc:WV.literal(ZV),id:rq,error:WV.object({code:WV.number().int(),message:WV.string(),data:WV.optional(WV.unknown())})}).strict(),dq=WV.union([sq,aq,oq,uq]),hq=nq.strict(),pq=tq.extend({method:WV.literal("notifications/cancelled"),params:eq.extend({requestId:rq,reason:WV.string().optional()})}),gq=WV.object({name:WV.string(),version:WV.string()}).passthrough(),mq=WV.object({experimental:WV.optional(WV.object({}).passthrough()),sampling:WV.optional(WV.object({}).passthrough()),roots:WV.optional(WV.object({listChanged:WV.optional(WV.boolean())}).passthrough())}).passthrough(),fq=$V.extend({method:WV.literal("initialize"),params:XV.extend({protocolVersion:WV.string(),capabilities:mq,clientInfo:gq})}),yq=WV.object({experimental:WV.optional(WV.object({}).passthrough()),logging:WV.optional(WV.object({}).passthrough()),completions:WV.optional(WV.object({}).passthrough()),prompts:WV.optional(WV.object({listChanged:WV.optional(WV.boolean())}).passthrough()),resources:WV.optional(WV.object({subscribe:WV.optional(WV.boolean()),listChanged:WV.optional(WV.boolean())}).passthrough()),tools:WV.optional(WV.object({listChanged:WV.optional(WV.boolean())}).passthrough())}).passthrough(),vq=nq.extend({protocolVersion:WV.string(),capabilities:yq,serverInfo:gq,instructions:WV.optional(WV.string())}),bq=tq.extend({method:WV.literal("notifications/initialized")}),Cq=$V.extend({method:WV.literal("ping")}),wq=WV.object({progress:WV.number(),total:WV.optional(WV.number()),message:WV.optional(WV.string())}).passthrough(),Sq=tq.extend({method:WV.literal("notifications/progress"),params:eq.merge(wq).extend({progressToken:YV})}),Eq=$V.extend({params:XV.extend({cursor:WV.optional(KV)}).optional()}),xq=nq.extend({nextCursor:WV.optional(KV)}),Iq=WV.object({uri:WV.string(),mimeType:WV.optional(WV.string())}).passthrough(),Aq=Iq.extend({text:WV.string()}),Pq=Iq.extend({blob:WV.string().base64()}),kq=WV.object({uri:WV.string(),name:WV.string(),description:WV.optional(WV.string()),mimeType:WV.optional(WV.string())}).passthrough(),Tq=WV.object({uriTemplate:WV.string(),name:WV.string(),description:WV.optional(WV.string()),mimeType:WV.optional(WV.string())}).passthrough(),Dq=Eq.extend({method:WV.literal("resources/list")}),Mq=xq.extend({resources:WV.array(kq)}),Lq=Eq.extend({method:WV.literal("resources/templates/list")}),Rq=xq.extend({resourceTemplates:WV.array(Tq)}),Nq=$V.extend({method:WV.literal("resources/read"),params:XV.extend({uri:WV.string()})}),Oq=nq.extend({contents:WV.array(WV.union([Aq,Pq]))}),_q=tq.extend({method:WV.literal("notifications/resources/list_changed")}),Bq=$V.extend({method:WV.literal("resources/subscribe"),params:XV.extend({uri:WV.string()})}),Fq=$V.extend({method:WV.literal("resources/unsubscribe"),params:XV.extend({uri:WV.string()})}),Uq=tq.extend({method:WV.literal("notifications/resources/updated"),params:eq.extend({uri:WV.string()})}),Hq=WV.object({name:WV.string(),description:WV.optional(WV.string()),required:WV.optional(WV.boolean())}).passthrough(),zq=WV.object({name:WV.string(),description:WV.optional(WV.string()),arguments:WV.optional(WV.array(Hq))}).passthrough(),jq=Eq.extend({method:WV.literal("prompts/list")}),Vq=xq.extend({prompts:WV.array(zq)}),qq=$V.extend({method:WV.literal("prompts/get"),params:XV.extend({name:WV.string(),arguments:WV.optional(WV.record(WV.string()))})}),Wq=WV.object({type:WV.literal("text"),text:WV.string()}).passthrough(),Qq=WV.object({type:WV.literal("image"),data:WV.string().base64(),mimeType:WV.string()}).passthrough(),Gq=WV.object({type:WV.literal("audio"),data:WV.string().base64(),mimeType:WV.string()}).passthrough(),Zq=WV.object({type:WV.literal("resource"),resource:WV.union([Aq,Pq])}).passthrough(),Yq=WV.object({role:WV.enum(["user","assistant"]),content:WV.union([Wq,Qq,Gq,Zq])}).passthrough(),Kq=nq.extend({description:WV.optional(WV.string()),messages:WV.array(Yq)}),Jq=tq.extend({method:WV.literal("notifications/prompts/list_changed")}),Xq=WV.object({title:WV.optional(WV.string()),readOnlyHint:WV.optional(WV.boolean()),destructiveHint:WV.optional(WV.boolean()),idempotentHint:WV.optional(WV.boolean()),openWorldHint:WV.optional(WV.boolean())}).passthrough(),$q=WV.object({name:WV.string(),description:WV.optional(WV.string()),inputSchema:WV.object({type:WV.literal("object"),properties:WV.optional(WV.object({}).passthrough()),required:WV.optional(WV.array(WV.string()))}).passthrough(),outputSchema:WV.optional(WV.object({type:WV.literal("object"),properties:WV.optional(WV.object({}).passthrough()),required:WV.optional(WV.array(WV.string()))}).passthrough()),annotations:WV.optional(Xq)}).passthrough(),eW=Eq.extend({method:WV.literal("tools/list")}),tW=xq.extend({tools:WV.array($q)}),nW=nq.extend({content:WV.array(WV.union([Wq,Qq,Gq,Zq])).default([]),structuredContent:WV.object({}).passthrough().optional(),isError:WV.optional(WV.boolean())}),rW=(nW.or(nq.extend({toolResult:WV.unknown()})),$V.extend({method:WV.literal("tools/call"),params:XV.extend({name:WV.string(),arguments:WV.optional(WV.record(WV.unknown()))})})),sW=tq.extend({method:WV.literal("notifications/tools/list_changed")}),iW=WV.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),aW=$V.extend({method:WV.literal("logging/setLevel"),params:XV.extend({level:iW})}),oW=tq.extend({method:WV.literal("notifications/message"),params:eq.extend({level:iW,logger:WV.optional(WV.string()),data:WV.unknown()})}),lW=WV.object({name:WV.string().optional()}).passthrough(),cW=WV.object({hints:WV.optional(WV.array(lW)),costPriority:WV.optional(WV.number().min(0).max(1)),speedPriority:WV.optional(WV.number().min(0).max(1)),intelligencePriority:WV.optional(WV.number().min(0).max(1))}).passthrough(),uW=WV.object({role:WV.enum(["user","assistant"]),content:WV.union([Wq,Qq,Gq])}).passthrough(),dW=$V.extend({method:WV.literal("sampling/createMessage"),params:XV.extend({messages:WV.array(uW),systemPrompt:WV.optional(WV.string()),includeContext:WV.optional(WV.enum(["none","thisServer","allServers"])),temperature:WV.optional(WV.number()),maxTokens:WV.number().int(),stopSequences:WV.optional(WV.array(WV.string())),metadata:WV.optional(WV.object({}).passthrough()),modelPreferences:WV.optional(cW)})}),hW=nq.extend({model:WV.string(),stopReason:WV.optional(WV.enum(["endTurn","stopSequence","maxTokens"]).or(WV.string())),role:WV.enum(["user","assistant"]),content:WV.discriminatedUnion("type",[Wq,Qq,Gq])}),pW=WV.object({type:WV.literal("ref/resource"),uri:WV.string()}).passthrough(),gW=WV.object({type:WV.literal("ref/prompt"),name:WV.string()}).passthrough(),mW=$V.extend({method:WV.literal("completion/complete"),params:XV.extend({ref:WV.union([gW,pW]),argument:WV.object({name:WV.string(),value:WV.string()}).passthrough()})}),fW=nq.extend({completion:WV.object({values:WV.array(WV.string()).max(100),total:WV.optional(WV.number().int()),hasMore:WV.optional(WV.boolean())}).passthrough()}),yW=WV.object({uri:WV.string().startsWith("file://"),name:WV.optional(WV.string())}).passthrough(),vW=$V.extend({method:WV.literal("roots/list")}),bW=nq.extend({roots:WV.array(yW)}),CW=tq.extend({method:WV.literal("notifications/roots/list_changed")});WV.union([Cq,fq,mW,aW,qq,jq,Dq,Lq,Nq,Bq,Fq,rW,eW]),WV.union([pq,Sq,bq,CW]),WV.union([hq,hW,bW]),WV.union([Cq,dW,vW]),WV.union([pq,Sq,oW,Uq,_q,sW,Jq]),WV.union([hq,vq,fW,Kq,Vq,Mq,Rq,Oq,nW,tW]);class wW extends Error{constructor(e,t,n){super(`MCP error ${e}: ${t}`),this.code=e,this.data=n,this.name="McpError"}}class SW{constructor(e){this._options=e,this._requestMessageId=0,this._requestHandlers=new Map,this._requestHandlerAbortControllers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this._timeoutInfo=new Map,this.setNotificationHandler(pq,(e=>{const t=this._requestHandlerAbortControllers.get(e.params.requestId);null==t||t.abort(e.params.reason)})),this.setNotificationHandler(Sq,(e=>{this._onprogress(e)})),this.setRequestHandler(Cq,(e=>({})))}_setupTimeout(e,t,n,r,s=!1){this._timeoutInfo.set(e,{timeoutId:setTimeout(r,t),startTime:Date.now(),timeout:t,maxTotalTimeout:n,resetTimeoutOnProgress:s,onTimeout:r})}_resetTimeout(e){const t=this._timeoutInfo.get(e);if(!t)return!1;const n=Date.now()-t.startTime;if(t.maxTotalTimeout&&n>=t.maxTotalTimeout)throw this._timeoutInfo.delete(e),new wW(cq.RequestTimeout,"Maximum total timeout exceeded",{maxTotalTimeout:t.maxTotalTimeout,totalElapsed:n});return clearTimeout(t.timeoutId),t.timeoutId=setTimeout(t.onTimeout,t.timeout),!0}_cleanupTimeout(e){const t=this._timeoutInfo.get(e);t&&(clearTimeout(t.timeoutId),this._timeoutInfo.delete(e))}async connect(e){this._transport=e,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=e=>{this._onerror(e)},this._transport.onmessage=(e,t)=>{var n;lq(e)||(n=e,uq.safeParse(n).success)?this._onresponse(e):iq(e)?this._onrequest(e,t):(e=>aq.safeParse(e).success)(e)?this._onnotification(e):this._onerror(new Error(`Unknown message type: ${JSON.stringify(e)}`))},await this._transport.start()}_onclose(){var e;const t=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,null===(e=this.onclose)||void 0===e||e.call(this);const n=new wW(cq.ConnectionClosed,"Connection closed");for(const e of t.values())e(n)}_onerror(e){var t;null===(t=this.onerror)||void 0===t||t.call(this,e)}_onnotification(e){var t;const n=null!==(t=this._notificationHandlers.get(e.method))&&void 0!==t?t:this.fallbackNotificationHandler;void 0!==n&&Promise.resolve().then((()=>n(e))).catch((e=>this._onerror(new Error(`Uncaught error in notification handler: ${e}`))))}_onrequest(e,t){var n,r,s,i;const a=null!==(n=this._requestHandlers.get(e.method))&&void 0!==n?n:this.fallbackRequestHandler;if(void 0===a)return void(null===(r=this._transport)||void 0===r||r.send({jsonrpc:"2.0",id:e.id,error:{code:cq.MethodNotFound,message:"Method not found"}}).catch((e=>this._onerror(new Error(`Failed to send an error response: ${e}`)))));const o=new AbortController;this._requestHandlerAbortControllers.set(e.id,o);const l={signal:o.signal,sessionId:null===(s=this._transport)||void 0===s?void 0:s.sessionId,_meta:null===(i=e.params)||void 0===i?void 0:i._meta,sendNotification:t=>this.notification(t,{relatedRequestId:e.id}),sendRequest:(t,n,r)=>this.request(t,n,{...r,relatedRequestId:e.id}),authInfo:null==t?void 0:t.authInfo,requestId:e.id};Promise.resolve().then((()=>a(e,l))).then((t=>{var n;if(!o.signal.aborted)return null===(n=this._transport)||void 0===n?void 0:n.send({result:t,jsonrpc:"2.0",id:e.id})}),(t=>{var n,r;if(!o.signal.aborted)return null===(n=this._transport)||void 0===n?void 0:n.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(t.code)?t.code:cq.InternalError,message:null!==(r=t.message)&&void 0!==r?r:"Internal error"}})})).catch((e=>this._onerror(new Error(`Failed to send response: ${e}`)))).finally((()=>{this._requestHandlerAbortControllers.delete(e.id)}))}_onprogress(e){const{progressToken:t,...n}=e.params,r=Number(t),s=this._progressHandlers.get(r);if(!s)return void this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));const i=this._responseHandlers.get(r),a=this._timeoutInfo.get(r);if(a&&i&&a.resetTimeoutOnProgress)try{this._resetTimeout(r)}catch(e){return void i(e)}s(n)}_onresponse(e){const t=Number(e.id),n=this._responseHandlers.get(t);if(void 0!==n)if(this._responseHandlers.delete(t),this._progressHandlers.delete(t),this._cleanupTimeout(t),lq(e))n(e);else{n(new wW(e.error.code,e.error.message,e.error.data))}else this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`))}get transport(){return this._transport}async close(){var e;await(null===(e=this._transport)||void 0===e?void 0:e.close())}request(e,t,n){const{relatedRequestId:r,resumptionToken:s,onresumptiontoken:i}=null!=n?n:{};return new Promise(((a,o)=>{var l,c,u,d,h;if(!this._transport)return void o(new Error("Not connected"));!0===(null===(l=this._options)||void 0===l?void 0:l.enforceStrictCapabilities)&&this.assertCapabilityForMethod(e.method),null===(c=null==n?void 0:n.signal)||void 0===c||c.throwIfAborted();const p=this._requestMessageId++,g={...e,jsonrpc:"2.0",id:p};(null==n?void 0:n.onprogress)&&(this._progressHandlers.set(p,n.onprogress),g.params={...e.params,_meta:{progressToken:p}});const m=e=>{var t;this._responseHandlers.delete(p),this._progressHandlers.delete(p),this._cleanupTimeout(p),null===(t=this._transport)||void 0===t||t.send({jsonrpc:"2.0",method:"notifications/cancelled",params:{requestId:p,reason:String(e)}},{relatedRequestId:r,resumptionToken:s,onresumptiontoken:i}).catch((e=>this._onerror(new Error(`Failed to send cancellation: ${e}`)))),o(e)};this._responseHandlers.set(p,(e=>{var r;if(!(null===(r=null==n?void 0:n.signal)||void 0===r?void 0:r.aborted)){if(e instanceof Error)return o(e);try{const n=t.parse(e.result);a(n)}catch(e){o(e)}}})),null===(u=null==n?void 0:n.signal)||void 0===u||u.addEventListener("abort",(()=>{var e;m(null===(e=null==n?void 0:n.signal)||void 0===e?void 0:e.reason)}));const f=null!==(d=null==n?void 0:n.timeout)&&void 0!==d?d:6e4;this._setupTimeout(p,f,null==n?void 0:n.maxTotalTimeout,(()=>m(new wW(cq.RequestTimeout,"Request timed out",{timeout:f}))),null!==(h=null==n?void 0:n.resetTimeoutOnProgress)&&void 0!==h&&h),this._transport.send(g,{relatedRequestId:r,resumptionToken:s,onresumptiontoken:i}).catch((e=>{this._cleanupTimeout(p),o(e)}))}))}async notification(e,t){if(!this._transport)throw new Error("Not connected");this.assertNotificationCapability(e.method);const n={...e,jsonrpc:"2.0"};await this._transport.send(n,t)}setRequestHandler(e,t){const n=e.shape.method.value;this.assertRequestHandlerCapability(n),this._requestHandlers.set(n,((n,r)=>Promise.resolve(t(e.parse(n),r))))}removeRequestHandler(e){this._requestHandlers.delete(e)}assertCanSetRequestHandler(e){if(this._requestHandlers.has(e))throw new Error(`A request handler for ${e} already exists, which would be overridden`)}setNotificationHandler(e,t){this._notificationHandlers.set(e.shape.method.value,(n=>Promise.resolve(t(e.parse(n)))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}}var EW=n(46919),xW=n(58651);class IW extends SW{constructor(e,t){var n;super(t),this._clientInfo=e,this._cachedToolOutputValidators=new Map,this._capabilities=null!==(n=null==t?void 0:t.capabilities)&&void 0!==n?n:{},this._ajv=new EW}registerCapabilities(e){if(this.transport)throw new Error("Cannot register capabilities after connecting to transport");var t,n;this._capabilities=(t=this._capabilities,n=e,Object.entries(n).reduce(((e,[t,n])=>(e[t]=n&&"object"==typeof n&&e[t]?{...e[t],...n}:n,e)),{...t}))}assertCapability(e,t){var n;if(!(null===(n=this._serverCapabilities)||void 0===n?void 0:n[e]))throw new Error(`Server does not support ${e} (required for ${t})`)}async connect(e,t){if(await super.connect(e),void 0===e.sessionId)try{const e=await this.request({method:"initialize",params:{protocolVersion:QV,capabilities:this._capabilities,clientInfo:this._clientInfo}},vq,t);if(void 0===e)throw new Error(`Server sent invalid initialize result: ${e}`);if(!GV.includes(e.protocolVersion))throw new Error(`Server's protocol version is not supported: ${e.protocolVersion}`);this._serverCapabilities=e.capabilities,this._serverVersion=e.serverInfo,this._instructions=e.instructions,await this.notification({method:"notifications/initialized"})}catch(e){throw this.close(),e}}getServerCapabilities(){return this._serverCapabilities}getServerVersion(){return this._serverVersion}getInstructions(){return this._instructions}assertCapabilityForMethod(e){var t,n,r,s,i;switch(e){case"logging/setLevel":if(!(null===(t=this._serverCapabilities)||void 0===t?void 0:t.logging))throw new Error(`Server does not support logging (required for ${e})`);break;case"prompts/get":case"prompts/list":if(!(null===(n=this._serverCapabilities)||void 0===n?void 0:n.prompts))throw new Error(`Server does not support prompts (required for ${e})`);break;case"resources/list":case"resources/templates/list":case"resources/read":case"resources/subscribe":case"resources/unsubscribe":if(!(null===(r=this._serverCapabilities)||void 0===r?void 0:r.resources))throw new Error(`Server does not support resources (required for ${e})`);if("resources/subscribe"===e&&!this._serverCapabilities.resources.subscribe)throw new Error(`Server does not support resource subscriptions (required for ${e})`);break;case"tools/call":case"tools/list":if(!(null===(s=this._serverCapabilities)||void 0===s?void 0:s.tools))throw new Error(`Server does not support tools (required for ${e})`);break;case"completion/complete":if(!(null===(i=this._serverCapabilities)||void 0===i?void 0:i.completions))throw new Error(`Server does not support completions (required for ${e})`)}}assertNotificationCapability(e){var t;if("notifications/roots/list_changed"===e)if(!(null===(t=this._capabilities.roots)||void 0===t?void 0:t.listChanged))throw new Error(`Client does not support roots list changed notifications (required for ${e})`)}assertRequestHandlerCapability(e){switch(e){case"sampling/createMessage":if(!this._capabilities.sampling)throw new Error(`Client does not support sampling capability (required for ${e})`);break;case"roots/list":if(!this._capabilities.roots)throw new Error(`Client does not support roots capability (required for ${e})`)}}async ping(e){return this.request({method:"ping"},hq,e)}async complete(e,t){return this.request({method:"completion/complete",params:e},fW,t)}async setLoggingLevel(e,t){return this.request({method:"logging/setLevel",params:{level:e}},hq,t)}async getPrompt(e,t){return this.request({method:"prompts/get",params:e},Kq,t)}async listPrompts(e,t){return this.request({method:"prompts/list",params:e},Vq,t)}async listResources(e,t){return this.request({method:"resources/list",params:e},Mq,t)}async listResourceTemplates(e,t){return this.request({method:"resources/templates/list",params:e},Rq,t)}async readResource(e,t){return this.request({method:"resources/read",params:e},Oq,t)}async subscribeResource(e,t){return this.request({method:"resources/subscribe",params:e},hq,t)}async unsubscribeResource(e,t){return this.request({method:"resources/unsubscribe",params:e},hq,t)}async callTool(e,t=nW,n){const r=await this.request({method:"tools/call",params:e},t,n),s=this.getToolOutputValidator(e.name);if(s){if(!r.structuredContent&&!r.isError)throw new wW(cq.InvalidRequest,`Tool ${e.name} has an output schema but did not return structured content`);if(r.structuredContent)try{if(!s(r.structuredContent))throw new wW(cq.InvalidParams,`Structured content does not match the tool's output schema: ${this._ajv.errorsText(s.errors)}`)}catch(e){if(e instanceof wW)throw e;throw new wW(cq.InvalidParams,`Failed to validate structured content: ${e instanceof Error?e.message:String(e)}`)}}return r}cacheToolOutputSchemas(e){this._cachedToolOutputValidators.clear();for(const t of e)if(t.outputSchema)try{const e=this._ajv.compile(t.outputSchema);this._cachedToolOutputValidators.set(t.name,e)}catch(e){xW.warn(`Failed to compile output schema for tool ${t.name}: ${e}`)}}getToolOutputValidator(e){return this._cachedToolOutputValidators.get(e)}async listTools(e,t){const n=await this.request({method:"tools/list",params:e},tW,t);return this.cacheToolOutputSchemas(n.tools),n}async sendRootsListChanged(){return this.notification({method:"notifications/roots/list_changed"})}}class AW extends Error{constructor(e,t){super(e),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function PW(e){}function kW(e){if("function"==typeof e)throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=PW,onError:n=PW,onRetry:r=PW,onComment:s}=e;let i,a="",o=!0,l="",c="";function u(e){if(""===e)return l.length>0&&t({id:i,event:c||void 0,data:l.endsWith("\n")?l.slice(0,-1):l}),i=void 0,l="",void(c="");if(e.startsWith(":"))return void(s&&s(e.slice(e.startsWith(": ")?2:1)));const n=e.indexOf(":");if(-1===n)d(e,"",e);else{const t=e.slice(0,n),r=" "===e[n+1]?2:1;d(t,e.slice(n+r),e)}}function d(e,t,s){switch(e){case"event":c=t;break;case"data":l=`${l}${t}\n`;break;case"id":i=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?r(parseInt(t,10)):n(new AW(`Invalid \`retry\` value: "${t}"`,{type:"invalid-retry",value:t,line:s}));break;default:n(new AW(`Unknown field "${e.length>20?`${e.slice(0,20)}…`:e}"`,{type:"unknown-field",field:e,value:t,line:s}))}}return{feed:function(e){const t=o?e.replace(/^\xEF\xBB\xBF/,""):e,[n,r]=function(e){const t=[];let n="",r=0;for(;r<e.length;){const s=e.indexOf("\r",r),i=e.indexOf("\n",r);let a=-1;if(-1!==s&&-1!==i?a=Math.min(s,i):-1!==s?a=s:-1!==i&&(a=i),-1===a){n=e.slice(r);break}{const n=e.slice(r,a);t.push(n),r=a+1,"\r"===e[r-1]&&"\n"===e[r]&&r++}}return[t,n]}(`${a}${t}`);for(const e of n)u(e);a=r,o=!1},reset:function(e={}){a&&e.consume&&u(a),o=!0,i=void 0,l="",c="",a=""}}}class TW extends Event{constructor(e,t){var n,r;super(e),this.code=null!=(n=null==t?void 0:t.code)?n:void 0,this.message=null!=(r=null==t?void 0:t.message)?r:void 0}[Symbol.for("nodejs.util.inspect.custom")](e,t,n){return n(MW(this),t)}[Symbol.for("Deno.customInspect")](e,t){return e(MW(this),t)}}function DW(e){return e instanceof Error?"errors"in e&&Array.isArray(e.errors)?e.errors.map(DW).join(", "):"cause"in e&&e.cause instanceof Error?`${e}: ${DW(e.cause)}`:e.message:`${e}`}function MW(e){return{type:e.type,message:e.message,code:e.code,defaultPrevented:e.defaultPrevented,cancelable:e.cancelable,timeStamp:e.timeStamp}}var LW,RW,NW,OW,_W,BW,FW,UW,HW,zW,jW,VW,qW,WW,QW,GW,ZW,YW,KW,JW,XW,$W,eQ,tQ=e=>{throw TypeError(e)},nQ=(e,t,n)=>t.has(e)||tQ("Cannot "+n),rQ=(e,t,n)=>(nQ(e,t,"read from private field"),n?n.call(e):t.get(e)),sQ=(e,t,n)=>t.has(e)?tQ("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),iQ=(e,t,n,r)=>(nQ(e,t,"write to private field"),t.set(e,n),n),aQ=(e,t,n)=>(nQ(e,t,"access private method"),n);class oQ extends EventTarget{constructor(e,t){var n,r;super(),sQ(this,WW),this.CONNECTING=0,this.OPEN=1,this.CLOSED=2,sQ(this,LW),sQ(this,RW),sQ(this,NW),sQ(this,OW),sQ(this,_W),sQ(this,BW),sQ(this,FW),sQ(this,UW,null),sQ(this,HW),sQ(this,zW),sQ(this,jW,null),sQ(this,VW,null),sQ(this,qW,null),sQ(this,GW,(async e=>{var t;rQ(this,zW).reset();const{body:n,redirected:r,status:s,headers:i}=e;if(204===s)return aQ(this,WW,XW).call(this,"Server sent HTTP 204, not reconnecting",204),void this.close();if(iQ(this,NW,r?new URL(e.url):void 0),200!==s)return void aQ(this,WW,XW).call(this,`Non-200 status code (${s})`,s);if(!(i.get("content-type")||"").startsWith("text/event-stream"))return void aQ(this,WW,XW).call(this,'Invalid content type, expected "text/event-stream"',s);if(rQ(this,LW)===this.CLOSED)return;iQ(this,LW,this.OPEN);const a=new Event("open");if(null==(t=rQ(this,qW))||t.call(this,a),this.dispatchEvent(a),"object"!=typeof n||!n||!("getReader"in n))return aQ(this,WW,XW).call(this,"Invalid response body, expected a web ReadableStream",s),void this.close();const o=new TextDecoder,l=n.getReader();let c=!0;do{const{done:e,value:t}=await l.read();t&&rQ(this,zW).feed(o.decode(t,{stream:!e})),e&&(c=!1,rQ(this,zW).reset(),aQ(this,WW,$W).call(this))}while(c)})),sQ(this,ZW,(e=>{iQ(this,HW,void 0),"AbortError"!==e.name&&"aborted"!==e.type&&aQ(this,WW,$W).call(this,DW(e))})),sQ(this,KW,(e=>{"string"==typeof e.id&&iQ(this,UW,e.id);const t=new MessageEvent(e.event||"message",{data:e.data,origin:rQ(this,NW)?rQ(this,NW).origin:rQ(this,RW).origin,lastEventId:e.id||""});rQ(this,VW)&&(!e.event||"message"===e.event)&&rQ(this,VW).call(this,t),this.dispatchEvent(t)})),sQ(this,JW,(e=>{iQ(this,BW,e)})),sQ(this,eQ,(()=>{iQ(this,FW,void 0),rQ(this,LW)===this.CONNECTING&&aQ(this,WW,QW).call(this)}));try{if(e instanceof URL)iQ(this,RW,e);else{if("string"!=typeof e)throw new Error("Invalid URL");iQ(this,RW,new URL(e,function(){const e="document"in globalThis?globalThis.document:void 0;return e&&"object"==typeof e&&"baseURI"in e&&"string"==typeof e.baseURI?e.baseURI:void 0}()))}}catch{throw function(e){const t=globalThis.DOMException;return"function"==typeof t?new t(e,"SyntaxError"):new SyntaxError(e)}("An invalid or illegal string was specified")}iQ(this,zW,kW({onEvent:rQ(this,KW),onRetry:rQ(this,JW)})),iQ(this,LW,this.CONNECTING),iQ(this,BW,3e3),iQ(this,_W,null!=(n=null==t?void 0:t.fetch)?n:globalThis.fetch),iQ(this,OW,null!=(r=null==t?void 0:t.withCredentials)&&r),aQ(this,WW,QW).call(this)}get readyState(){return rQ(this,LW)}get url(){return rQ(this,RW).href}get withCredentials(){return rQ(this,OW)}get onerror(){return rQ(this,jW)}set onerror(e){iQ(this,jW,e)}get onmessage(){return rQ(this,VW)}set onmessage(e){iQ(this,VW,e)}get onopen(){return rQ(this,qW)}set onopen(e){iQ(this,qW,e)}addEventListener(e,t,n){const r=t;super.addEventListener(e,r,n)}removeEventListener(e,t,n){const r=t;super.removeEventListener(e,r,n)}close(){rQ(this,FW)&&clearTimeout(rQ(this,FW)),rQ(this,LW)!==this.CLOSED&&(rQ(this,HW)&&rQ(this,HW).abort(),iQ(this,LW,this.CLOSED),iQ(this,HW,void 0))}}let lQ;async function cQ(e){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._~";let n="";const r=await async function(e){return(await lQ).getRandomValues(new Uint8Array(e))}(e);for(let s=0;s<e;s++){n+=t[r[s]%66]}return n}async function uQ(e){const t=await(await lQ).subtle.digest("SHA-256",(new TextEncoder).encode(e));return btoa(String.fromCharCode(...new Uint8Array(t))).replace(/\//g,"_").replace(/\+/g,"-").replace(/=/g,"")}async function dQ(e){if(e||(e=43),e<43||e>128)throw`Expected a length between 43 and 128. Received ${e}.`;const t=await async function(e){return await cQ(e)}(e);return{code_verifier:t,code_challenge:await uQ(t)}}LW=new WeakMap,RW=new WeakMap,NW=new WeakMap,OW=new WeakMap,_W=new WeakMap,BW=new WeakMap,FW=new WeakMap,UW=new WeakMap,HW=new WeakMap,zW=new WeakMap,jW=new WeakMap,VW=new WeakMap,qW=new WeakMap,WW=new WeakSet,QW=function(){iQ(this,LW,this.CONNECTING),iQ(this,HW,new AbortController),rQ(this,_W)(rQ(this,RW),aQ(this,WW,YW).call(this)).then(rQ(this,GW)).catch(rQ(this,ZW))},GW=new WeakMap,ZW=new WeakMap,YW=function(){var e;const t={mode:"cors",redirect:"follow",headers:{Accept:"text/event-stream",...rQ(this,UW)?{"Last-Event-ID":rQ(this,UW)}:void 0},cache:"no-store",signal:null==(e=rQ(this,HW))?void 0:e.signal};return"window"in globalThis&&(t.credentials=this.withCredentials?"include":"same-origin"),t},KW=new WeakMap,JW=new WeakMap,XW=function(e,t){var n;rQ(this,LW)!==this.CLOSED&&iQ(this,LW,this.CLOSED);const r=new TW("error",{code:t,message:e});null==(n=rQ(this,jW))||n.call(this,r),this.dispatchEvent(r)},$W=function(e,t){var n;if(rQ(this,LW)===this.CLOSED)return;iQ(this,LW,this.CONNECTING);const r=new TW("error",{code:t,message:e});null==(n=rQ(this,jW))||n.call(this,r),this.dispatchEvent(r),iQ(this,FW,setTimeout(rQ(this,eQ),rQ(this,BW)))},eQ=new WeakMap,oQ.CONNECTING=0,oQ.OPEN=1,oQ.CLOSED=2,lQ=globalThis.crypto;const hQ=WV.object({resource:WV.string().url(),authorization_servers:WV.array(WV.string().url()).optional(),jwks_uri:WV.string().url().optional(),scopes_supported:WV.array(WV.string()).optional(),bearer_methods_supported:WV.array(WV.string()).optional(),resource_signing_alg_values_supported:WV.array(WV.string()).optional(),resource_name:WV.string().optional(),resource_documentation:WV.string().optional(),resource_policy_uri:WV.string().url().optional(),resource_tos_uri:WV.string().url().optional(),tls_client_certificate_bound_access_tokens:WV.boolean().optional(),authorization_details_types_supported:WV.array(WV.string()).optional(),dpop_signing_alg_values_supported:WV.array(WV.string()).optional(),dpop_bound_access_tokens_required:WV.boolean().optional()}).passthrough(),pQ=WV.object({issuer:WV.string(),authorization_endpoint:WV.string(),token_endpoint:WV.string(),registration_endpoint:WV.string().optional(),scopes_supported:WV.array(WV.string()).optional(),response_types_supported:WV.array(WV.string()),response_modes_supported:WV.array(WV.string()).optional(),grant_types_supported:WV.array(WV.string()).optional(),token_endpoint_auth_methods_supported:WV.array(WV.string()).optional(),token_endpoint_auth_signing_alg_values_supported:WV.array(WV.string()).optional(),service_documentation:WV.string().optional(),revocation_endpoint:WV.string().optional(),revocation_endpoint_auth_methods_supported:WV.array(WV.string()).optional(),revocation_endpoint_auth_signing_alg_values_supported:WV.array(WV.string()).optional(),introspection_endpoint:WV.string().optional(),introspection_endpoint_auth_methods_supported:WV.array(WV.string()).optional(),introspection_endpoint_auth_signing_alg_values_supported:WV.array(WV.string()).optional(),code_challenge_methods_supported:WV.array(WV.string()).optional()}).passthrough(),gQ=WV.object({access_token:WV.string(),token_type:WV.string(),expires_in:WV.number().optional(),scope:WV.string().optional(),refresh_token:WV.string().optional()}).strip(),mQ=(WV.object({error:WV.string(),error_description:WV.string().optional(),error_uri:WV.string().optional()}),WV.object({redirect_uris:WV.array(WV.string()).refine((e=>e.every((e=>URL.canParse(e)))),{message:"redirect_uris must contain valid URLs"}),token_endpoint_auth_method:WV.string().optional(),grant_types:WV.array(WV.string()).optional(),response_types:WV.array(WV.string()).optional(),client_name:WV.string().optional(),client_uri:WV.string().optional(),logo_uri:WV.string().optional(),scope:WV.string().optional(),contacts:WV.array(WV.string()).optional(),tos_uri:WV.string().optional(),policy_uri:WV.string().optional(),jwks_uri:WV.string().optional(),jwks:WV.any().optional(),software_id:WV.string().optional(),software_version:WV.string().optional()}).strip()),fQ=WV.object({client_id:WV.string(),client_secret:WV.string().optional(),client_id_issued_at:WV.number().optional(),client_secret_expires_at:WV.number().optional()}).strip(),yQ=mQ.merge(fQ);WV.object({error:WV.string(),error_description:WV.string().optional()}).strip(),WV.object({token:WV.string(),token_type_hint:WV.string().optional()}).strip();var vQ=n(58651);class bQ extends Error{constructor(e){super(null!=e?e:"Unauthorized")}}async function CQ(e,{serverUrl:t,authorizationCode:n,scope:r,resourceMetadataUrl:s}){let i=t;try{const e=await async function(e,t){var n;let r,s;r=(null==t?void 0:t.resourceMetadataUrl)?new URL(null==t?void 0:t.resourceMetadataUrl):new URL("/.well-known/oauth-protected-resource",e);try{s=await fetch(r,{headers:{"MCP-Protocol-Version":null!==(n=null==t?void 0:t.protocolVersion)&&void 0!==n?n:QV}})}catch(e){if(!(e instanceof TypeError))throw e;s=await fetch(r)}if(404===s.status)throw new Error("Resource server does not implement OAuth 2.0 Protected Resource Metadata.");if(!s.ok)throw new Error(`HTTP ${s.status} trying to load well-known OAuth protected resource metadata.`);return hQ.parse(await s.json())}(s||t);e.authorization_servers&&e.authorization_servers.length>0&&(i=e.authorization_servers[0])}catch(e){vQ.warn("Could not load OAuth Protected Resource metadata, falling back to /.well-known/oauth-authorization-server",e)}const a=await async function(e,t){var n;const r=new URL("/.well-known/oauth-authorization-server",e);let s;try{s=await fetch(r,{headers:{"MCP-Protocol-Version":null!==(n=null==t?void 0:t.protocolVersion)&&void 0!==n?n:QV}})}catch(e){if(!(e instanceof TypeError))throw e;s=await fetch(r)}if(404===s.status)return;if(!s.ok)throw new Error(`HTTP ${s.status} trying to load well-known OAuth metadata`);return pQ.parse(await s.json())}(i);let o=await Promise.resolve(e.clientInformation());if(!o){if(void 0!==n)throw new Error("Existing OAuth client information is required when exchanging an authorization code");if(!e.saveClientInformation)throw new Error("OAuth client information must be saveable for dynamic registration");const t=await async function(e,{metadata:t,clientMetadata:n}){let r;if(t){if(!t.registration_endpoint)throw new Error("Incompatible auth server: does not support dynamic client registration");r=new URL(t.registration_endpoint)}else r=new URL("/register",e);const s=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!s.ok)throw new Error(`Dynamic client registration failed: HTTP ${s.status}`);return yQ.parse(await s.json())}(i,{metadata:a,clientMetadata:e.clientMetadata});await e.saveClientInformation(t),o=t}if(void 0!==n){const t=await e.codeVerifier(),r=await async function(e,{metadata:t,clientInformation:n,authorizationCode:r,codeVerifier:s,redirectUri:i}){const a="authorization_code";let o;if(t){if(o=new URL(t.token_endpoint),t.grant_types_supported&&!t.grant_types_supported.includes(a))throw new Error(`Incompatible auth server: does not support grant type ${a}`)}else o=new URL("/token",e);const l=new URLSearchParams({grant_type:a,client_id:n.client_id,code:r,code_verifier:s,redirect_uri:String(i)});n.client_secret&&l.set("client_secret",n.client_secret);const c=await fetch(o,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:l});if(!c.ok)throw new Error(`Token exchange failed: HTTP ${c.status}`);return gQ.parse(await c.json())}(i,{metadata:a,clientInformation:o,authorizationCode:n,codeVerifier:t,redirectUri:e.redirectUrl});return await e.saveTokens(r),"AUTHORIZED"}const l=await e.tokens();if(null==l?void 0:l.refresh_token)try{const t=await async function(e,{metadata:t,clientInformation:n,refreshToken:r}){const s="refresh_token";let i;if(t){if(i=new URL(t.token_endpoint),t.grant_types_supported&&!t.grant_types_supported.includes(s))throw new Error(`Incompatible auth server: does not support grant type ${s}`)}else i=new URL("/token",e);const a=new URLSearchParams({grant_type:s,client_id:n.client_id,refresh_token:r});n.client_secret&&a.set("client_secret",n.client_secret);const o=await fetch(i,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:a});if(!o.ok)throw new Error(`Token refresh failed: HTTP ${o.status}`);return gQ.parse({refresh_token:r,...await o.json()})}(i,{metadata:a,clientInformation:o,refreshToken:l.refresh_token});return await e.saveTokens(t),"AUTHORIZED"}catch(e){vQ.error("Could not refresh OAuth tokens:",e)}const c=e.state?await e.state():void 0,{authorizationUrl:u,codeVerifier:d}=await async function(e,{metadata:t,clientInformation:n,redirectUrl:r,scope:s,state:i}){const a="code",o="S256";let l;if(t){if(l=new URL(t.authorization_endpoint),!t.response_types_supported.includes(a))throw new Error(`Incompatible auth server: does not support response type ${a}`);if(!t.code_challenge_methods_supported||!t.code_challenge_methods_supported.includes(o))throw new Error(`Incompatible auth server: does not support code challenge method ${o}`)}else l=new URL("/authorize",e);const c=await dQ(),u=c.code_verifier,d=c.code_challenge;l.searchParams.set("response_type",a),l.searchParams.set("client_id",n.client_id),l.searchParams.set("code_challenge",d),l.searchParams.set("code_challenge_method",o),l.searchParams.set("redirect_uri",String(r)),i&&l.searchParams.set("state",i);s&&l.searchParams.set("scope",s);return{authorizationUrl:l,codeVerifier:u}}(i,{metadata:a,clientInformation:o,state:c,redirectUrl:e.redirectUrl,scope:r||e.clientMetadata.scope});return await e.saveCodeVerifier(d),await e.redirectToAuthorization(u),"REDIRECT"}function wQ(e){const t=e.headers.get("WWW-Authenticate");if(!t)return;const[n,r]=t.split(" ");if("bearer"!==n.toLowerCase()||!r)return void vQ.log("Invalid WWW-Authenticate header format, expected 'Bearer'");const s=/resource_metadata="([^"]*)"/.exec(t);if(s)try{return new URL(s[1])}catch(e){return void vQ.log("Invalid resource metadata url: ",s[1])}}class SQ extends Error{constructor(e,t,n){super(`SSE error: ${t}`),this.code=e,this.event=n}}class EQ{constructor(e,t){this._url=e,this._resourceMetadataUrl=void 0,this._eventSourceInit=null==t?void 0:t.eventSourceInit,this._requestInit=null==t?void 0:t.requestInit,this._authProvider=null==t?void 0:t.authProvider}async _authThenStart(){var e;if(!this._authProvider)throw new bQ("No auth provider");let t;try{t=await CQ(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl})}catch(t){throw null===(e=this.onerror)||void 0===e||e.call(this,t),t}if("AUTHORIZED"!==t)throw new bQ;return await this._startOrAuth()}async _commonHeaders(){const e={};if(this._authProvider){const t=await this._authProvider.tokens();t&&(e.Authorization=`Bearer ${t.access_token}`)}return e}_startOrAuth(){return new Promise(((e,t)=>{var n;this._eventSource=new oQ(this._url.href,null!==(n=this._eventSourceInit)&&void 0!==n?n:{fetch:(e,t)=>this._commonHeaders().then((n=>fetch(e,{...t,headers:{...n,Accept:"text/event-stream"}})))}),this._abortController=new AbortController,this._eventSource.onerror=n=>{var r;if(401===n.code&&this._authProvider)return void this._authThenStart().then(e,t);const s=new SQ(n.code,n.message,n);t(s),null===(r=this.onerror)||void 0===r||r.call(this,s)},this._eventSource.onopen=()=>{},this._eventSource.addEventListener("endpoint",(n=>{var r;const s=n;try{if(this._endpoint=new URL(s.data,this._url),this._endpoint.origin!==this._url.origin)throw new Error(`Endpoint origin does not match connection origin: ${this._endpoint.origin}`)}catch(e){return t(e),null===(r=this.onerror)||void 0===r||r.call(this,e),void this.close()}e()})),this._eventSource.onmessage=e=>{var t,n;const r=e;let s;try{s=dq.parse(JSON.parse(r.data))}catch(e){return void(null===(t=this.onerror)||void 0===t||t.call(this,e))}null===(n=this.onmessage)||void 0===n||n.call(this,s)}}))}async start(){if(this._eventSource)throw new Error("SSEClientTransport already started! If using Client class, note that connect() calls start() automatically.");return await this._startOrAuth()}async finishAuth(e){if(!this._authProvider)throw new bQ("No auth provider");if("AUTHORIZED"!==await CQ(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl}))throw new bQ("Failed to authorize")}async close(){var e,t,n;null===(e=this._abortController)||void 0===e||e.abort(),null===(t=this._eventSource)||void 0===t||t.close(),null===(n=this.onclose)||void 0===n||n.call(this)}async send(e){var t,n,r;if(!this._endpoint)throw new Error("Not connected");try{const r=await this._commonHeaders(),s=new Headers({...r,...null===(t=this._requestInit)||void 0===t?void 0:t.headers});s.set("content-type","application/json");const i={...this._requestInit,method:"POST",headers:s,body:JSON.stringify(e),signal:null===(n=this._abortController)||void 0===n?void 0:n.signal},a=await fetch(this._endpoint,i);if(!a.ok){if(401===a.status&&this._authProvider){this._resourceMetadataUrl=wQ(a);if("AUTHORIZED"!==await CQ(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl}))throw new bQ;return this.send(e)}const t=await a.text().catch((()=>null));throw new Error(`Error POSTing to endpoint (HTTP ${a.status}): ${t}`)}}catch(e){throw null===(r=this.onerror)||void 0===r||r.call(this,e),e}}}class xQ extends TransformStream{constructor({onError:e,onRetry:t,onComment:n}={}){let r;super({start(s){r=kW({onEvent:e=>{s.enqueue(e)},onError(t){"terminate"===e?s.error(t):"function"==typeof e&&e(t)},onRetry:t,onComment:n})},transform(e){r.feed(e)}})}}const IQ={initialReconnectionDelay:1e3,maxReconnectionDelay:3e4,reconnectionDelayGrowFactor:1.5,maxRetries:2};class AQ extends Error{constructor(e,t){super(`Streamable HTTP error: ${t}`),this.code=e}}class PQ{constructor(e,t){var n;this._url=e,this._resourceMetadataUrl=void 0,this._requestInit=null==t?void 0:t.requestInit,this._authProvider=null==t?void 0:t.authProvider,this._sessionId=null==t?void 0:t.sessionId,this._reconnectionOptions=null!==(n=null==t?void 0:t.reconnectionOptions)&&void 0!==n?n:IQ}async _authThenStart(){var e;if(!this._authProvider)throw new bQ("No auth provider");let t;try{t=await CQ(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl})}catch(t){throw null===(e=this.onerror)||void 0===e||e.call(this,t),t}if("AUTHORIZED"!==t)throw new bQ;return await this._startOrAuthSse({resumptionToken:void 0})}async _commonHeaders(){var e;const t={};if(this._authProvider){const e=await this._authProvider.tokens();e&&(t.Authorization=`Bearer ${e.access_token}`)}return this._sessionId&&(t["mcp-session-id"]=this._sessionId),new Headers({...t,...null===(e=this._requestInit)||void 0===e?void 0:e.headers})}async _startOrAuthSse(e){var t,n;const{resumptionToken:r}=e;try{const n=await this._commonHeaders();n.set("Accept","text/event-stream"),r&&n.set("last-event-id",r);const s=await fetch(this._url,{method:"GET",headers:n,signal:null===(t=this._abortController)||void 0===t?void 0:t.signal});if(!s.ok){if(401===s.status&&this._authProvider)return await this._authThenStart();if(405===s.status)return;throw new AQ(s.status,`Failed to open SSE stream: ${s.statusText}`)}this._handleSseStream(s.body,e)}catch(e){throw null===(n=this.onerror)||void 0===n||n.call(this,e),e}}_getNextReconnectionDelay(e){const t=this._reconnectionOptions.initialReconnectionDelay,n=this._reconnectionOptions.reconnectionDelayGrowFactor,r=this._reconnectionOptions.maxReconnectionDelay;return Math.min(t*Math.pow(n,e),r)}_scheduleReconnection(e,t=0){var n;const r=this._reconnectionOptions.maxRetries;if(r>0&&t>=r)return void(null===(n=this.onerror)||void 0===n||n.call(this,new Error(`Maximum reconnection attempts (${r}) exceeded.`)));const s=this._getNextReconnectionDelay(t);setTimeout((()=>{this._startOrAuthSse(e).catch((n=>{var r;null===(r=this.onerror)||void 0===r||r.call(this,new Error(`Failed to reconnect SSE stream: ${n instanceof Error?n.message:String(n)}`)),this._scheduleReconnection(e,t+1)}))}),s)}_handleSseStream(e,t){if(!e)return;const{onresumptiontoken:n,replayMessageId:r}=t;let s;(async()=>{var t,i,a,o;try{const a=e.pipeThrough(new TextDecoderStream).pipeThrough(new xQ).getReader();for(;;){const{value:e,done:o}=await a.read();if(o)break;if(e.id&&(s=e.id,null==n||n(e.id)),!e.event||"message"===e.event)try{const n=dq.parse(JSON.parse(e.data));void 0!==r&&lq(n)&&(n.id=r),null===(t=this.onmessage)||void 0===t||t.call(this,n)}catch(e){null===(i=this.onerror)||void 0===i||i.call(this,e)}}}catch(e){if(null===(a=this.onerror)||void 0===a||a.call(this,new Error(`SSE stream disconnected: ${e}`)),this._abortController&&!this._abortController.signal.aborted&&void 0!==s)try{this._scheduleReconnection({resumptionToken:s,onresumptiontoken:n,replayMessageId:r},0)}catch(e){null===(o=this.onerror)||void 0===o||o.call(this,new Error(`Failed to reconnect: ${e instanceof Error?e.message:String(e)}`))}}})()}async start(){if(this._abortController)throw new Error("StreamableHTTPClientTransport already started! If using Client class, note that connect() calls start() automatically.");this._abortController=new AbortController}async finishAuth(e){if(!this._authProvider)throw new bQ("No auth provider");if("AUTHORIZED"!==await CQ(this._authProvider,{serverUrl:this._url,authorizationCode:e,resourceMetadataUrl:this._resourceMetadataUrl}))throw new bQ("Failed to authorize")}async close(){var e,t;null===(e=this._abortController)||void 0===e||e.abort(),null===(t=this.onclose)||void 0===t||t.call(this)}async send(e,t){var n,r,s,i;try{const{resumptionToken:s,onresumptiontoken:a}=t||{};if(s)return void this._startOrAuthSse({resumptionToken:s,replayMessageId:iq(e)?e.id:void 0}).catch((e=>{var t;return null===(t=this.onerror)||void 0===t?void 0:t.call(this,e)}));const o=await this._commonHeaders();o.set("content-type","application/json"),o.set("accept","application/json, text/event-stream");const l={...this._requestInit,method:"POST",headers:o,body:JSON.stringify(e),signal:null===(n=this._abortController)||void 0===n?void 0:n.signal},c=await fetch(this._url,l),u=c.headers.get("mcp-session-id");if(u&&(this._sessionId=u),!c.ok){if(401===c.status&&this._authProvider){this._resourceMetadataUrl=wQ(c);if("AUTHORIZED"!==await CQ(this._authProvider,{serverUrl:this._url,resourceMetadataUrl:this._resourceMetadataUrl}))throw new bQ;return this.send(e)}const t=await c.text().catch((()=>null));throw new Error(`Error POSTing to endpoint (HTTP ${c.status}): ${t}`)}if(202===c.status)return i=e,void(bq.safeParse(i).success&&this._startOrAuthSse({resumptionToken:void 0}).catch((e=>{var t;return null===(t=this.onerror)||void 0===t?void 0:t.call(this,e)})));const d=(Array.isArray(e)?e:[e]).filter((e=>"method"in e&&"id"in e&&void 0!==e.id)).length>0,h=c.headers.get("content-type");if(d)if(null==h?void 0:h.includes("text/event-stream"))this._handleSseStream(c.body,{onresumptiontoken:a});else{if(!(null==h?void 0:h.includes("application/json")))throw new AQ(-1,`Unexpected content type: ${h}`);{const e=await c.json(),t=Array.isArray(e)?e.map((e=>dq.parse(e))):[dq.parse(e)];for(const e of t)null===(r=this.onmessage)||void 0===r||r.call(this,e)}}}catch(e){throw null===(s=this.onerror)||void 0===s||s.call(this,e),e}}get sessionId(){return this._sessionId}async terminateSession(){var e,t;if(this._sessionId)try{const t=await this._commonHeaders(),n={...this._requestInit,method:"DELETE",headers:t,signal:null===(e=this._abortController)||void 0===e?void 0:e.signal},r=await fetch(this._url,n);if(!r.ok&&405!==r.status)throw new AQ(r.status,`Failed to terminate session: ${r.statusText}`);this._sessionId=void 0}catch(e){throw null===(t=this.onerror)||void 0===t||t.call(this,e),e}}}var kQ=n(36191),TQ=n(73911);const DQ={};function MQ(e,t,n,r,s=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(r){if(s<0||s+16>r.length)throw new RangeError(`UUID byte range ${s}:${s+15} is out of buffer bounds`)}else r=new Uint8Array(16),s=0;return t??=Date.now(),n??=127*e[6]<<24|e[7]<<16|e[8]<<8|e[9],r[s++]=t/1099511627776&255,r[s++]=t/4294967296&255,r[s++]=t/16777216&255,r[s++]=t/65536&255,r[s++]=t/256&255,r[s++]=255&t,r[s++]=112|n>>>28&15,r[s++]=n>>>20&255,r[s++]=128|n>>>14&63,r[s++]=n>>>6&255,r[s++]=n<<2&255|3&e[10],r[s++]=e[11],r[s++]=e[12],r[s++]=e[13],r[s++]=e[14],r[s++]=e[15],r}const LQ=function(e,t,n){let r;if(e)r=MQ(e.random??e.rng?.()??(0,kQ.A)(),e.msecs,e.seq,t,n);else{const e=Date.now(),s=(0,kQ.A)();!function(e,t,n){e.msecs??=-1/0,e.seq??=0,t>e.msecs?(e.seq=n[6]<<23|n[7]<<16|n[8]<<8|n[9],e.msecs=t):(e.seq=e.seq+1|0,0===e.seq&&e.msecs++)}(DQ,e,s),r=MQ(s,DQ.msecs,DQ.seq,t,n)}return t??(0,TQ.k)(r)};var RQ=n(58651);const NQ=async e=>{let t,n;const{serverUrl:r,onToolsChanged:s,onResourcesChanged:i,onConnected:a,onDisconnected:o,onNotification:l,onClientError:c}=e,u=async()=>{if(RQ.log("Connecting to MCP client..."),t=(()=>{const e=new IW({name:"web-mcp-client",version:"1.0.0"});return e.onerror=e=>{RQ.error("Client error:",e)},e})(),t.setNotificationHandler(oW,(e=>{l?.(e),RQ.log(`\nNotification ${e.params.level} - ${e.params.data}`)})),t.setNotificationHandler(_q,(async e=>{RQ.log("\nResource list changed notification received!"),l?.(e),i?.(e)})),t.setNotificationHandler(sW,(async e=>{RQ.log("\nTool list changed notification received!"),l?.(e),s?.(e)})),void 0!==r){try{n=new PQ(new URL(r)),await t.connect(n)}catch(e){RQ.log(`Wasnt able to server using StreamableHTTPClientTransport, trying SSEClientTransport. Error: ${e}`);try{n=(e=>new EQ(new URL(e)))(r),await t.connect(n)}catch(e){return RQ.error("Error connecting to MCP client:",e),RQ.log(JSON.stringify(t,null,2)),RQ.log(JSON.stringify(n,null,2)),void c?.("[system] Error connecting to MCP client: "+e)}}const e=n;a?.(e.sessionId||"NO SESSION ID")}else a?.("NO SESSION ID")};await u();const d=n||void 0;return{sessionId:d?.sessionId||LQ(),client:t,transport:n,reconnect:u,disconnect:async()=>{if(void 0===t)return RQ.error("Client not connected, cannot disconnect."),void c?.("[system] Client not connected, cannot disconnect.");try{void 0!==n&&await n.close(),await t.close(),t=void 0,n=void 0,o?.()}catch(e){RQ.error("Error disconnecting from MCP client:",e)}},api:{tools:{list:async()=>{if(!t)return RQ.error("Client not connected, cannot list tools."),void c?.("[system] Client not connected, cannot list tools.");return await t.request({method:"tools/list",params:{}},tW)},call:async(e,n)=>{if(!t)return RQ.error("Client not connected, cannot call tool."),void c?.("[system] Client not connected, cannot call tool.");const r={method:"tools/call",params:{name:e,arguments:n}};return await t.request(r,nW)}}}}},OQ="fui-MessageBar-Status-Message";let _Q=null;function BQ(){const e=document.querySelector("#copilot-chat-input .fui-MessageBarBody");if(!e)throw Error("ChatInput UI is changed and copilot-chat-input doesn not exit any more. Please update here");const t=e.children[0],n=document.createElement("span");n.id=OQ;return function(e,t){for(const[n,r]of Object.entries(t))e.style[n]=r}(n,{display:"block",backgroundColor:"rgba(0, 0, 0, 0)",color:t.style.color,height:t.style.height,fontSize:t.style.fontSize,textAlign:t.style.textAlign,width:"200px",paddingLeft:"10px"}),e.appendChild(n),n}class FQ{constructor(){this.addResponse=void 0,this.mcpClients=[],this.mcpTools=[],this.chatLogLevel=0}static getInstance(e){return this.sInstances.has(e)||this.sInstances.set(e,new FQ),this.sInstances.get(e)}initialize(e,t,n,r,s,i,a,o){this.mcpTools.length>0||(this.LocalMCPServerUrl=e,this.mcpServerlessClientsProps=t||[],this.mcpModelConfig=n,this.setIsExecutingCallback=r,this.addResponse=s,o&&(this.chatLogLevel=o),this.agentDebugLog=new $x(s,i,this.chatLogLevel),2===a.length&&(this.queryProcessingString=a[0],this.queryProcessingEndString=a[1]),this.agentDebugLog.log("MCP: initialize called"))}async setup(){this.agentDebugLog.log("call setup");let e=[],t=[];if(void 0!==this.LocalMCPServerUrl&&this.LocalMCPServerUrl.length>0&&(e=await Promise.all(this.LocalMCPServerUrl.split(";").map((e=>NQ({serverUrl:e,onConnected:t=>{this.agentDebugLog.log(`MCP: Connected to local server (${e}) with session ID: ${t}`)},onDisconnected:()=>{this.agentDebugLog.log(`MCP: Disconnected from server (${e})`)},onNotification:e=>{this.agentDebugLog.log("MCP Notification: "+e)}}))))),void 0!==this.mcpServerlessClientsProps&&(t=await Promise.all(this.mcpServerlessClientsProps.map((e=>(async e=>{const{getLocalTools:t,callLocalTool:n}=e;return{sessionId:LQ(),client:void 0,transport:void 0,reconnect:void 0,disconnect:void 0,api:{tools:{list:async()=>await t(),call:async(e,t)=>await n(e,t)}}}})(e))))),this.mcpClients=[...e,...t],this.agentDebugLog.log(`MCP: ${this.mcpClients.length} MCP clients connected`),this.mcpClients.length>0&&(this.mcpTools=await Promise.all(this.mcpClients.map((async e=>{const t=await e.api.tools.list();return void 0===t?(this.agentDebugLog.log("MCP: No tools found"),[]):(this.agentDebugLog.log("MCP: Tools in this client: "+t.tools.length),t.tools.map((t=>({...t,clientSessionId:e.sessionId}))))})))),!this.mcpModelConfig.apiAuth||0===this.mcpModelConfig.apiAuth.length)throw new Error("MCP: authentication details are missing");try{this.llmBackend=function(e){switch(e.type){case"anthropic3.7":return yz(e.apiAuth[0]);case"anthropic4.0":return vz(e.apiAuth[0]);case"anthropicAWS3.7":return bz(e.apiAuth);case"anthropicAWS4.0":return Cz(e.apiAuth);case"azure-openai":return fz(e.apiAuth[0]);default:throw new Error("OfficeJS Agent: Unsupported backend type")}}(this.mcpModelConfig),this.agentDebugLog.log("MCP: backend LLM created")}catch(e){this.agentDebugLog.log(`MCP: Failed to create LLM backend: ${e}`)}}async submitToLLM(e){if(0===this.mcpTools.length&&await this.setup(),0===this.mcpTools.length)return void this.agentDebugLog.log("MCP: No tools available");if(void 0===this.llmBackend)return this.mcpClients.forEach((e=>{e.disconnect()})),this.mcpClients=[],this.mcpTools=[],void this.agentDebugLog.log("MCP: LLM backend not initialized, try another query to re-initialize");const t=(e,t)=>{this.agentDebugLog.logToConsole("MCP: Output message: "+e),(t||this.chatLogLevel>=1)&&this.addResponse?.(e)},n=this.mcpTools.map(((e,t)=>e.map((e=>({...e,name:`${t}--${e.name}`}))))).flat();this.agentDebugLog.log(`MCP: pass ${n.length} tools to LLM`),this.conversationState=await(async e=>{const{input:t,llmBackend:n,conversationState:r,tools:s,callbacks:i}=e,a=e.maxLoopIterations??30,o=e.maxRetries??7;let l=t,c=r;for(let t=0;t<a;++t){try{c=await wz((()=>n.makeRequest(l,s||[],c,i)),{maxRetries:o,onRetry:i?.onError,onFail:i?.onError})}catch(e){return void i?.onError?.("LLM backend request is not successful: reached limit of retries of calling llm backend. Force stopping.")}const t=c.lastOutputs(),r=[];for(const s of t)"output_text"===s.type?i?.onOutputText?.(s):"function_call"===s.type?(i?.onFunctionCall?.(s),e.callTool&&r.push(e.callTool(s.name,s.arguments).then((e=>(i?.onToolResult?.(s.name,e),e))).then((e=>n.convertToolOutputToBackendInput(s,e))))):"reasoning"===s.type?i?.onReasoningOutput?.(s):i?.onUnknownOutput?.(s);l=[];for(const e of await Promise.all(r))for(const t of e)l.push(t);if(0===l.length)return c}i?.onError?.("Max agent loop iterations reached. Force stopping.")})({llmBackend:this.llmBackend,input:e,conversationState:this.conversationState,tools:n,callTool:async(e,t)=>{this.agentDebugLog.log(`Calling tool ${e} with ${JSON.stringify(t)}`);const r=n.find((t=>t.name===e));if(!r)throw new Error(`Tool ${e} not found`);const[s,i]=e.split("--"),a=this.mcpClients[parseInt(s)];if(!a)throw new Error(`Client for tool ${e} not found`);this.agentDebugLog.log("callTool - found client and invoke the tool");const o=await a.api.tools.call(i,t);return this.agentDebugLog.log(`Tool call result: ${JSON.stringify(o)}`),JSON.stringify(o)},callbacks:{onOutputText:async e=>{for(const n of e.content)t(`[bot] ${n.text}`,!0)},onFunctionCall:async e=>{t(`[system] Bot asks to call function: ${e.name}(${JSON.stringify(e.arguments)})`,!1)},onUnknownOutput:async e=>{this.agentDebugLog.log(`Unknown output: ${e}`)},onToolResult:async(e,n)=>{t(`[system] Tool "${e}" returned: ${JSON.stringify(n)}`,!1)}}})}async submitOperation(e){let t;try{_Q&&document.getElementById(OQ)||(_Q=BQ()),t=_Q,n=t,r=this.queryProcessingString,n.innerText=r||"Processing ...",this.setIsExecutingCallback?.(!0),await this.submitToLLM(e)}catch(e){!function(e,t,n){t>=1&&n(`MCP query threw exception: ${e}`),n("Failed to process your query. Please try again.")}(e.toString(),this.chatLogLevel,this.addResponse)}finally{!function(e,t){e.innerText=t||"Processing ends"}(t,this.queryProcessingEndString)}var n,r}async stopOperation(){}isExecuting(){return!1}async disconnect(){_Q&&(_Q.innerText=""),this.mcpClients.length>0&&(await Promise.all(this.mcpClients.map((e=>e.disconnect()))),this.mcpTools=[]),this.mcpClients=[],this.agentDebugLog.log("MCP: Disconnected from all servers")}}async function UQ(){FQ.getInstance("azure-openai").isExecuting()&&await FQ.getInstance("azure-openai").stopOperation(),FQ.getInstance("anthropic3.7").isExecuting()&&await FQ.getInstance("anthropic3.7").stopOperation(),FQ.getInstance("anthropic4.0").isExecuting()&&await FQ.getInstance("anthropic4.0").stopOperation(),FQ.getInstance("anthropicAWS3.7").isExecuting()&&await FQ.getInstance("anthropicAWS3.7").stopOperation(),FQ.getInstance("anthropicAWS4.0").isExecuting()&&await FQ.getInstance("anthropicAWS4.0").stopOperation()}async function HQ(e){const{signalOperationData:t,messageText:n,setIsExecuting:r,addResponse:s,shouldRunMCPAgent:i,featureFlags:a}=e;if(!(await(i?.())??1))return function(e){(0,qf.cY)("MCP: Error message: "+Df.Hg),e?.(Df.Hg)}(s),Promise.resolve(!0);if(0===t.operation.items.length||void 0===t.operation.items[0].body)return Promise.resolve(!1);const o=function(e,t){const n=t.commandingFlags?.agentName?.trim()||"Orbis";if(e===`${n} + GPT4.1`)return"azure-openai";if(e===`${n} + Claude`)return"3.7"===t.commandingFlags?.anthropicClaudeModel?t.commandingFlags?.awsAnthropicAuth&&2===t.commandingFlags?.awsAnthropicAuth.length?"anthropicAWS3.7":t.commandingFlags?.anthropicApiKey&&t.commandingFlags?.anthropicApiKey.length>0?"anthropic3.7":void 0:t.commandingFlags?.awsAnthropicAuth&&2===t.commandingFlags?.awsAnthropicAuth.length?"anthropicAWS4.0":t.commandingFlags?.anthropicApiKey&&t.commandingFlags?.anthropicApiKey.length>0?"anthropic4.0":void 0;return}(t.operation.items[0].body?.gptId,a);if(!o)return Promise.resolve(!1);const l=function(e,t){if("azure-openai"===e){if(!t.commandingFlags?.openAIApiKey||0===t.commandingFlags?.openAIApiKey.length)return;return{type:e,apiAuth:[t.commandingFlags?.openAIApiKey]}}if("anthropic3.7"===e||"anthropic4.0"===e){if(!t.commandingFlags?.anthropicApiKey||0===t.commandingFlags?.anthropicApiKey.length)return;return{type:e,apiAuth:[t.commandingFlags?.anthropicApiKey]}}if("anthropicAWS3.7"===e||"anthropicAWS4.0"===e){if(!t.commandingFlags?.awsAnthropicAuth||2!==t.commandingFlags?.awsAnthropicAuth.length)return;return{type:e,apiAuth:t.commandingFlags?.awsAnthropicAuth}}return}(o,a);if(!l)return Promise.resolve(!1);const c=function(e){if(e.featureFlags.commandingFlags?.enableOfficeJSTool){let t=e.orbisProps?.getOfficeJSClientProps;return t||(t=()=>function(e){const{executeOfficeJSCodeForChatInput:t,featureFlags:n}=e;if(!n.commandingFlags?.enableOfficeJSTool||void 0===t)return;const r={name:"OfficeJSExecutor",description:"Executor for OfficeJS code",inputSchema:{type:"object",properties:{officejs:{type:"string",description:n.commandingFlags?.officeJSToolDescription||'Simple javascript code using OfficeJS in the following format "{(async () => {<insert code here>); resolve(<result>)})();}". Should always resolve result that can be used as input for jsonify. Should not print anything to console or use return. Should be used only when alternative tools are unavailable or fail.'}},required:["officejs"],additionalProperties:!1,$schema:"https://json-schema.org/draft-07/schema#"}};return{getLocalTools:()=>({tools:[r]}),callLocalTool:async(e,n)=>{if(e!==r.name)throw new Error(`Unknown tool name: ${e}`);return await t(n.officejs)}}}(e)),t()}return}(e),u=[];c&&u.push(c);const d=function(e){const{orbisProps:t,featureFlags:n}=e;if(n.commandingFlags&&n.commandingFlags.enableComJSTool){const e=t?.getOfficeComJSClientProps||n.commandingFlags.getOfficeComJSClientProps;if(e)return e()}return}(e);return d&&u.push(d),await async function(e,t,n,r,s,i,a,o,l){FQ.getInstance(e).initialize(r,s,t,i,a,qf.cY,o,l),await FQ.getInstance(e).submitOperation(n)}(o,l,n,a.commandingFlags?.localMCPServerURL,u,r,s,[a.commandingFlags?.queryProcessingString,a.commandingFlags?.queryProcessingEndString],a.commandingFlags?.chatLogLevel),Promise.resolve(!0)}async function zQ(e){try{(e.commandingFlags?.localMCPServerURL&&e.commandingFlags?.localMCPServerURL.length>0||e.commandingFlags?.enableOfficeJSTool||e.commandingFlags?.enableComJSTool)&&async function(){await UQ(),FQ.getInstance("azure-openai")&&await FQ.getInstance("azure-openai").disconnect(),FQ.getInstance("anthropic3.7")&&await FQ.getInstance("anthropic3.7").disconnect(),FQ.getInstance("anthropicAWS3.7")&&await FQ.getInstance("anthropicAWS3.7").disconnect(),FQ.getInstance("anthropic4.0").isExecuting()&&await FQ.getInstance("anthropic4.0").stopOperation()}()}catch(e){(0,qf.cY)("Error in disposeLocalAgentOperationIfNeeded: "+e)}}function jQ(e){e.isEnabledLocalCUAAgent&&function(){if(Jx.getInstance().isExecuting()){const e="Stop operating";Jx.getInstance().submitOperation(e)}}(),(e.commandingFlags?.localMCPServerURL&&e.commandingFlags?.localMCPServerURL.length>0||e.commandingFlags?.enableOfficeJSTool||e.commandingFlags?.enableComJSTool)&&UQ()}FQ.sInstances=new Map;const VQ=(0,Qo.m)({SafeLinksToast:(0,mt.n)({container:{left:"50%",transform:"translateX(-50%)"}})});var qQ=n(62897),WQ=n(65724),QQ=n(68792),GQ=n(82372);let ZQ=null,YQ=null,KQ="",JQ="",XQ=0;const $Q=N.forwardRef((({onRender:e,onQuerySubmit:t,isFreVisible:c,setFreVisible:u,isDisabled:d,setIsDisabled:h,isExecuting:p,setIsExecuting:g,copilotChatTheme:m,copilotChatThemeV2:f,updateChangeTopicButtonClickedStatus:y,setTipCardShown:v,updateUserQueryGuid:b,updateUserQuery:C,updateUserQueryOrder:w,setChatInputBannerProps:S,setAtMentionApp:E,atMentionApp:x,setChatInputControlMounted:I,isPaneLoadMessageVisible:A,setPaneLoadMessageVisible:P,inputRef:k,style:T,platformType:D=s.Y.web,copilotCommunicationHandler:M,copilotTelemetryHandler:L=new nv.o,chatUiProps:R,basicChatProps:O,fluxServiceContainer:_,debugProps:B,copilotPluginProps:F,isChatHistoryPanelShown:U,setIsChatHistoryPanelShown:H,chatContainerZoomedIn:z,setChatContainerZoomedIn:j,hideChatHistoryPanelAfterInputDisabled:V,setHideChatHistoryPanelAfterInputDisabled:q,sketchImageProps:W,warmUpQueryIdRef:Q,isStartOfQueryRef:G,pluginDataProviderRef:Z,hostTokenProviders:Y,inlineCreationHVCAppConfig:K,switcherMenuProps:J,wasChatPaneAutoOpened:X,hostSettings:$,assistantApp:ee,setAssistantApp:te,initSideQuestEditor:ne,chatSearchSettings:re,getTenantId:se,executeOfficeJSCodeForChatInput:ie,orbisProps:ae},oe)=>{const le=R.chatInputProps??R.chatInputV2Props,ce=le?.editorConfig,ue=R.chatInputV2Props,de=(0,An.Mb)();ce&&ce.settings&&!ce.settings.appEnvironment&&(ce.settings.appEnvironment=function(e){switch(e){case Uw.D.DEV:return Uw.O.PPE;case Uw.D.PRODUCTION:return Uw.O.Prod;case Uw.D.GCC:return Uw.O.GCC;case Uw.D.GCCHIGH:return Uw.O.GCCHigh;case Uw.D.DOD:return Uw.O.DOD;case Uw.D.DOGFOOD:return Uw.O.DogFood;default:return Uw.O.None}}(de.hostAppSettings.environment));const he=(e=>{const t=(0,it.kQ)(dw),n=Ff();return N.useMemo((()=>{const r={...t,bingChatTitle:()=>Df.F5,chatPlaceholderMessage:()=>Df.nn,chatRestShyPlaceholderMessage:()=>Df.Hn,loadingMessage:()=>Df.Zh,defaultLoadingUiStrings:n};return e.ciqPlaceholderText&&(r.ciqPlaceholderText=()=>e.ciqPlaceholderText),e.chatPlaceholderMessage&&(r.chatPlaceholderMessage=()=>e.chatPlaceholderMessage),e.chatRestShyPlaceholderMessage&&(r.chatRestShyPlaceholderMessage=()=>e.chatRestShyPlaceholderMessage),r}),[t,e.ciqPlaceholderText,e.chatPlaceholderMessage,e.chatRestShyPlaceholderMessage,n])})({ciqPlaceholderText:ce?.ciqPlaceholderText,chatPlaceholderMessage:le?.chatPlaceholderMessage,chatRestShyPlaceholderMessage:le?.chatRestShyPlaceholderMessage??ue?.chatRestShyPlaceholderMessage}),pe=(0,ry.D)(),ge=(0,N.useRef)((new Date).getTime());(0,i.j_)(D);const me=ue?.shouldInitializeEditorInChatInput??!1,fe=le?.voiceInputProps?.handleInChatInput??!1,ye=le?.isHVCAppChatV2Enabled??!1,ve=le?.isCardSpanWrappingEnabled??!1,be=le?.hvcPromptStrings??[],Ce=N.useMemo((()=>le?.hvcPromptStringsList??[]),[le?.hvcPromptStringsList]),we=le?.useSortedHVCTokenList??!1,Se=le?.onChatInputHVCPromptUpdated,Ee=le?.onUserQuerySubmitted??(()=>{}),xe=R.clientInfoProps?R.clientInfoProps.clientInfo:(0,dt.XG)(),Ie=new Bw(xe).getUserContext(),Ae=R.clientInfoProps?R.clientInfoProps?.taskModuleLauncher:void 0,Pe=Wf.j.getInstance(pe),ke=lC.E.getInstance(pe),Te=void 0!==f,De=(0,hy.NZ)(),Me=(0,hy.UN)(),Le=py();let Re=De;const Ne=(0,N.useRef)(!1),Oe=(0,N.useRef)(!1),_e=(0,N.useRef)([]),Be=(0,N.useRef)(0),Fe=(0,N.useRef)(!1),Ue=(0,N.useRef)(re),He=ue?.shouldRunMCPAgent??(()=>Promise.resolve(!0));Re=Te?(0,hy.nJ)(Me,T):(0,hy.nJ)(De,T);const ze=Aw(),je=(0,Ot.Y$)();Pe.setTelemetryDebugLogFlag(je.showTelemetryLogs??!1);const Ve=()=>ue?.pluginsInfo?ue.pluginsInfo:ue?.buttonProps?.groundingButtonEnabled||F?.paneSilhouetteHeaderProps?.enableSettingsPanel?re?.getWebPluginInfo?.()??[]:[],[qe,We]=(0,N.useState)(Ve());ce&&ce.featureFlags&&(ce.featureFlags.hideGptStorefront=je?.enableBizChatInAppChat);const Qe=M.getHostSettings()?.sessionStorageKey,{chatLog:Ge,setChatLog:Ze,resetChatLog:Ye,isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled:Ke}=pC(je,J?.currentSelectedGPTId,Qe,Pe,qe,Z?.current),Je=k,Xe=(0,N.useRef)(null),$e=(0,N.useRef)(null),et=(0,N.useRef)(null),tt=(0,N.useRef)(!1),[nt,rt]=(0,N.useState)(!1),at=(0,N.useRef)(null),ot=(0,N.useRef)(!1),lt=(0,N.useRef)(!1),ct=(0,N.useRef)(!1),ut=(0,N.useRef)(0),ht=(0,N.useRef)(null),[pt,gt]=(0,N.useState)(!1),[mt,ft]=(0,N.useState)(!0),[yt,vt]=(0,N.useState)([]),[bt,Ct]=(0,N.useState)([]),[wt,St]=(0,N.useState)(!1),[Et,At]=(0,N.useState)(!1),[Pt,kt]=(0,N.useState)(""),{handleSubstrateResponseCallback:Tt}=cy(je,Ct,vt),[Dt,Mt]=N.useState(-1),[Lt,_t]=N.useState({}),Bt=(0,N.useRef)(null),Ft=rS(),Ut=(0,N.useRef)(null),Ht=(0,N.useRef)((e=>Promise.resolve().then((()=>{(0,qf.cY)("Insert handler is not passed from client.")})))),[zt,jt]=(0,N.useState)(uf.NotShown),Vt=(0,N.useRef)(ES.e.Default),qt=()=>{const e=!!je.isAddScrollingFreezeEnabled,t=M.getPythonMode();return!e||!t||M.getIsAutoScrollingEnabled()},[Wt,Qt]=(0,N.useState)({loadingUiStringList:[],shouldShowLoadingUi:!0,isAutoScrollingEnabled:qt}),[Gt,Zt]=(0,N.useState)({headerText:Df.u1,descriptionText:Df.u1}),{tipCardProps:Yt}=R,[Kt,Jt]=(0,N.useState)(!1),[Xt,$t]=(0,N.useState)(!1),[en,tn]=(0,N.useState)(df.Uninitialized),[nn,rn]=(0,N.useState)(!1),[sn,an]=(0,N.useState)(!1),on=(0,N.useRef)(!1),ln=(0,N.useRef)(),[cn,un]=(0,N.useState)(!1),[dn,hn]=N.useState([]),[pn,gn]=(0,N.useState)(!1),[mn,fn]=(0,N.useState)(!1),[yn,vn]=(0,N.useState)(),[bn,Cn]=(0,N.useState)(R.copilotWorkflowProps),[wn,Sn]=(0,N.useState)(0),[En,xn]=(0,N.useState)(null),[Pn,kn]=(0,N.useState)(null),Tn=(0,N.useRef)(),Dn=(0,N.useRef)(!0),Mn=(0,N.useRef)(null),Ln=de.hostAppSettings.window,{isAtBottom:Rn,sentinel:Nn}=(0,Zw.R)({sentinelClassName:Re.sentinel}),{getTUIEverShownState:Bn,teachingUIAnnotationHandler:Fn}=(()=>{const{submitOperation:e}=(0,sy.G)(),t=(0,Ot.Y$)(),n=(0,ry.D)(),r=(0,N.useCallback)((r=>{const s=new cv.g0({parentPath:["Signal",ow.kZ.getTypeName()],items:[{id:uv.r.generateId(),body:r}]});(0,qf.cY)(`Submitting signal to Augloop : ${ow.kZ.getTypeName()} with operation type: ${s} and signal: ${JSON.stringify(r)}`),t.isALHookEnabled?e(s,ow.kZ.getTypeName()):Cf.E.getInstance(n).submitOperation(s,ow.kZ.getTypeName())}),[e]),s=(0,N.useCallback)((()=>{const e=new ow.kZ({operation:{type:lw.H.GetTUIEverShownState}});r(e)}),[r]),i=(0,N.useCallback)((e=>{const t=new ow.kZ({operation:{type:lw.H.SetTUIEverShownState,isEverShown:e}});r(t)}),[r]),a=(0,N.useCallback)((async(e,t)=>{const r=e?.body;if(r)switch(r?.operationResponse?.type){case lw.H.GetTUIEverShownState:{const e=r.operationResponse;e?.status===lw.n.Success&&!1===e?.isTUIEverShown?(t?.(),i(!0),Wf.j.getInstance(n).sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.CopilotAppChatTUIShown}])):e?.status===lw.n.Failure&&Wf.j.getInstance(n).sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.CopilotAppChatGetTUIEverShownStateError}]);break}}else(0,qf.cY)(`${cw.TR.getTypeName()} body is undefined.`)}),[i]);return{getTUIEverShownState:s,setTUIEverShownState:i,teachingUIAnnotationHandler:a}})(),{creditBalance:Un,setCreditBalance:Hn,creditLimitType:zn,setCreditLimitType:jn,isCreditUpsellShown:Vn,handleCreditBalanceButtonClick:qn,creditLinkClickHandler:Wn,creditsWarningMessageBuilder:Qn,creditBannerTitle:Gn,creditBannerBody:Zn,creditBannerLinkText:Yn,handleCreditBannerDimissClick:Jn,shouldShowCreditBanner:er,shouldShowCreditUpsellBanner:tr,getUpdatedCreditsUIProps:nr}=function(e,t,n,r,i,a,o){const[l,c]=(0,N.useState)(null),[u,d]=(0,N.useState)(null),[h,p]=(0,N.useState)(!1),[g,m]=(0,N.useState)(!1),[f,y]=(0,N.useState)(!1),v=new xS,b=a.creditBannerTitle(),C=a.creditBannerBody(),w=a.creditBannerLinkText(),S=(0,N.useCallback)((()=>{(o??window).open(`${Df.vj}${xf.w.getAppName()?.toLowerCase()}#credits`,"_blank")}),[]),E=(0,N.useMemo)((()=>{const t=e?.creditsUIProps;return t?.creditBannerLinkUrlForWebOverride?t.creditBannerLinkUrlForWebOverride:t&&t.clientParam&&t.upsellFwdLinkId?`${Df.hN}${t.clientParam}&ocid${t.upsellFwdLinkId}`:Df.hN}),[e?.creditsUIProps]),x=(0,N.useCallback)((()=>{(o??window).open(E,"_blank")}),[E]),I=(0,N.useCallback)((()=>{t===s.Y.web?x():e?.creditsUIProps?.creditUpsellHandler&&e.creditsUIProps.creditUpsellHandler()}),[e.creditsUIProps,x,t]),A=(0,N.useCallback)((()=>{I(),e?.creditsUIProps?.creditUpsellCardBannerProps?.persistOnClick||m(!1)}),[e?.creditsUIProps?.creditUpsellCardBannerProps?.persistOnClick,I]);(0,N.useEffect)((()=>{u===cC.$n.Limited?(l===Df.Sk&&r(),l===Df.Cb?(i.sendEventToClient(Tf.PV.OutOfCredits),m(!0),p(!1)):l&&l<=Df.Ky&&l!==Df.xm&&(i.sendEventToClient(Tf.PV.LowOnCredits),p(!0),m(!1)),e?.creditsUIProps?.setShowCreditsUI&&e?.creditsUIProps?.setShowCreditsUI(!0)):u===cC.$n.Unlimited?(e?.creditsUIProps?.setShowCreditsUI&&e?.creditsUIProps?.setShowCreditsUI(!1),p(!1),m(!1)):u||e?.creditsUIProps?.setShowCreditsUI&&e?.creditsUIProps?.setShowCreditsUI(!1),e?.creditsUIProps?.creditUpsellCardBannerProps?.showOnNotAvailable&&l===Df.xm&&(i.sendEventToClient(Tf.PV.CreditsNotAvailable),m(!0),p(!1))}),[l,u]);const P=(0,N.useCallback)((()=>{let t=e?.creditsUIProps;return t&&(t={creditBannerProps:t.creditBannerProps,creditUpsellCardBannerProps:t.creditUpsellCardBannerProps,upsellFwdLinkId:t.upsellFwdLinkId,clientParam:t.clientParam,setShowCreditsUI:t.setShowCreditsUI,creditUpsellHandler:A}),t}),[e,A]);return{creditBalance:l,setCreditBalance:c,creditLimitType:u,setCreditLimitType:d,isCreditUpsellShown:g,handleCreditBalanceButtonClick:S,creditLinkClickHandler:I,creditsWarningMessageBuilder:v,creditBannerTitle:b,creditBannerBody:C,creditBannerLinkText:w,handleCreditBannerDimissClick:()=>{p(!1),y(!0)},shouldShowCreditBanner:()=>n.isCreditsUIEnabled&&h&&!f&&!e?.creditsUIProps?.creditBannerProps?.hide,shouldShowCreditUpsellBanner:()=>n.isCreditsUIEnabled&&g&&(l===Df.Cb&&u===cC.$n.Limited||l===Df.xm&&!!e?.creditsUIProps?.creditUpsellCardBannerProps?.showOnNotAvailable)&&!e?.creditsUIProps?.creditUpsellCardBannerProps?.hide,getUpdatedCreditsUIProps:P}}(R,D,je,Bn,M,he,Ln),[rr,sr]=(0,N.useState)(!1),[ir,ar]=(0,N.useState)(!1),[or,lr]=(0,N.useState)(!1),[cr,ur]=(0,N.useState)([]),[dr,hr]=(0,N.useState)(!1),[pr,gr]=(0,N.useState)(!1),mr=N.useRef({}),fr=N.useRef(!1),yr=N.useRef(!1),vr=function(){const[e,t]=(0,N.useState)(0),[n,r]=(0,N.useState)(!1),s=(0,N.useRef)(null),i=(0,ry.D)();return{isMeasuring:n,measureTarget:s,setActionStart:e=>{t(Math.floor(performance.now())),r(!0),s.current=e},logChatHistoryActionEvent:e=>{Wf.j.getInstance(i).sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:e}])},logChatHistoryActionLatency:t=>{n&&s.current===t&&(Wf.j.getInstance(i).sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:s.current},{key:Pf.h3.ChatEventParameters,value:Math.floor(performance.now())-e}]),r(!1))}}}(),br=(0,N.useRef)(null),wr=(0,N.useRef)(!1),Sr=(0,N.useRef)(!1),[Er,xr]=(0,N.useState)(),Ir=(0,N.useRef)(void 0),Ar=(0,N.useRef)(!1),Tr=N.useRef(void 0),Dr=N.useMemo((()=>({...xe,hostWindow:Ln})),[xe,Ln]),Mr=new Nf,Lr=R.toggleUiProps?.trySydneyToggleEnabled,Rr=R.toggleUiProps?.tryEnterpriseSearchToggleEnabled,Nr=R.toggleUiProps?.tryWebSearchToggleEnabled,Or=R.toggleUiProps?.tryReviewerAgentToggleEnabled,_r=R.toggleUiProps?.FastModeReviewerAgentToggleEnabled,Br=new Kf,Fr=new iv,Ur=new fb,Hr=new Of(R.hintCardProps),zr=new hv,jr=new Yb,Vr=new mb,Wr=new Kb,Gr=N.useRef(null);let Zr=K;const Yr=(0,Xn.zK)(),[Jr,Xr]=N.useState(!1),$r=F?.paneSilhouetteHeaderProps?Yr.sideQuestUIContext:{isSideQuestMode:Jr,setIsSideQuestMode:Xr},{isSideQuestMode:es,setIsSideQuestMode:ts}=$r,ns=he.systemMessageActionButtonText(),rs=M.isFeatureGateEnabledFromClient(Af.WT.IsCopilotPluginEnabled),ss=je.defaultEnableWebGrounding||M.isFeatureGateEnabledFromClient(Af.WT.IsWebSearchDefaultOn),is=(0,N.useRef)(!1),as=()=>{is.current=!0},{isVoiceModeTriggered:os,setVoiceModeTriggered:ls,setVoiceModeEntry:cs,changeModality:us}=(0,bs.fP)(),{pluginConfigService:ds,pluginDataProvider:hs}=(e=>{const{isWebSearchDefaultOn:t,logGroundingSourceEvent:n=!1}=e,r=(0,Ot.Y$)(),{submitOperation:s}=(0,sy.G)(),{hostAppSettings:i}=(0,An.Mb)(),a=(0,ry.D)(),o=N.useMemo((()=>r.isALHookEnabled?new AE.n(s,i.window,a):new AE.n),[]);N.useEffect((()=>{r.isALHookEnabled&&o.setSubmitOperation(s)}),[s]);const l=N.useMemo((()=>new OE(o,{isWebSearchDefaultOn:t,logGroundingSourceEvent:n},a)),[o,t,n]);return{pluginConfigService:o,pluginDataProvider:l}})({isWebSearchDefaultOn:ss,logGroundingSourceEvent:!qe?.length}),ps=(()=>{const{setLicenseAnnotationActivated:e,resubmitOnLicenseAnnotationActivation:t}=(0,sy.G)(),n=(0,Ot.Y$)(),r=(0,ry.D)();return(0,N.useCallback)((async()=>{(0,qf.cY)("CopilotLicensingAnnotation received");const s=Wf.j.getInstance(r);n.isALHookEnabled?(e(!0),t()):(Cf.E.getInstance(r).setLicenseAnnotationActivated(!0),Cf.E.getInstance(r).resubmitOnLicenseAnnotationActivation()),s.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.CopilotLicensingAnnotationActivated},{key:Pf.h3.ChatEventParameters,value:(new Date).getTime().toString()}])}),[e,t])})(),{createAndSubmitEntityLabelSignal:gs,entityLabelAnnotationProcessor:ms}=(()=>{const{submitOperation:e}=(0,sy.G)(),t=(0,Ot.Y$)(),n=(0,ry.D)();return{createAndSubmitEntityLabelSignal:(0,N.useCallback)((async r=>{const s=Wf.j.getInstance(n),i=new dv.L({type:r.type,id:r.url}),a=new cv.g0({parentPath:["Signal",dv.L.getTypeName()],items:[{id:uv.r.generateId(),body:i}]});(0,qf.cY)(`Submitting signal to Augloop : ${dv.L.getTypeName()} signal: ${JSON.stringify(i)}`),s.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.EntityLabelOperationSubmitted},{key:Pf.h3.ChatEventParameters,value:`${dv.L.getTypeName()}_${a}`}]),t.isALHookEnabled?e(a,dv.L.getTypeName()):Cf.E.getInstance(n).submitOperation(a,dv.L.getTypeName())}),[e]),entityLabelAnnotationProcessor:(0,N.useCallback)((async(e,t,r)=>{const s=e.body?.H_?.T_,i=e?.body,a=i.success,o=i.sensitivityLabel;Wf.j.getInstance(n).sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ResponseReceivedFromAL},{key:Pf.h3.ChatEventParameters,value:`${s}`},{key:Pf.h3.Cv,value:r}]),(0,qf.cY)("received sensitivity label",o),t(a&&o?o:void 0)}),[])}})();Z.current=hs;const{alSession:fs,chatContainerBuilderRef:ys,submitOperation:Cs,isALSessionClosed:ws,isAnnotationActivated:Ss,setIsAnnotationActivated:Es,isAnnotationActivatedRef:xs,releaseActiveAnnotations:Is,setIsALSessionClosed:As,setShouldReinitializeALSession:Ps,activateClientSpecificALAnnotations:ks,clearOperationListForResubmit:Ts,setAugloopResponseHandler:Ds,submitInitialOperations:Ms}=(0,sy.G)(),{codePreviewDialogElement:Rs,onCodePreviewDialogOpen:Ns,loadPreviewDialog:Os}=(()=>{const e=(0,Ot.Y$)().isCodePreviewEnabled,[t,r]=(0,N.useState)(!1),[s,i]=(0,N.useState)(""),[a,o]=(0,N.useState)(),[l,c]=(0,N.useState)(N.createElement(N.Fragment,null)),[u,d]=(0,N.useState)(),h=(0,ry.D)();(0,N.useEffect)((()=>{if(!e||!u)return;let n=N.createElement(pl.y,null);t||(n=N.createElement(N.Fragment,null));const i=N.createElement(N.Suspense,{fallback:n},N.createElement(u,{open:t,onClose:()=>{r(!1)},code:s,stdout:a,telemetryLogger:ZC.L.getInstance()}));c(i)}),[u,e,t,s,a]);const p=(0,N.useCallback)((()=>{if(u)return;const e=(0,N.lazy)((()=>Promise.all([n.e(9037),n.e(3341),n.e(1411)]).then(n.bind(n,77413)).then((e=>({default:e.PreviewCodeDialog})))));d(e)}),[u]),g=(0,N.useCallback)(((t,n)=>{if(e)try{Wf.j.getInstance(h).sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ViewCodeButtonClicked},{key:Pf.h3.ChatEventParameters,value:"true"}]),i(t),r(!0),o(n)}catch(e){Wf.j.getInstance(h).sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:e.message},{key:Pf.IC.ErrorType,value:Pf.q0.Client},{key:Pf.IC.ErrorCode,value:Af.O4.MarkdownDialogRenderingFailure}])}}),[e,p]);return{codePreviewDialogElement:l,onCodePreviewDialogOpen:g,loadPreviewDialog:p}})(),_s=m??f,[Bs,Fs]=(0,N.useState)({isHighContrast:_s?.isHighContrastModeEnabled??!1,isDarkTheme:_s?.isDarkModeEnabled??!1}),{isInactiveChatBannerVisible:Us,chatInputBannerString:Hs}=dy(M,ws,zt,h,Je,Pe);If.q.initialize(pe??"",je,Cs,M);const zs=new Lf.R(Ze,M,hs,je,(()=>Ar.current),(()=>{Ar.current=!1}),J?.currentSelectedGPTId,Yr?.getAgentInfo?.(J?.currentSelectedGPTId??"")?.name??void 0,J?.getBrandingById,je.isALHookEnabled?Cs:void 0,je.isLoadingInOutputEnabled?p:void 0,Ns,Os,{viewcodeButtonLabel:he.viewcodeButtonLabel(),viewcodeButtonPopovertext:he.viewcodeButtonPopovertext(),podcastUnavailableErrorMessage:he.podcastUnavailableErrorMessage()},R.chatContainerUiProps?.showFeedbackButtons,ne,pe,Ln,Ue,mr,f);ys.current=zs;const js=((e,t)=>{const n=(0,ry.D)(),r=(0,it.kQ)(tv),s=(0,Ot.Y$)(),l=(0,$y.cw)(e,t);return(c,u,d)=>{const h=c?.body,p=h?.answer,g=h?.error,m=h?.aiResponse,f=h?.status,y=h?.isBasicChat,v=h?.queryId,b=h?.citation,C=Wf.j.getInstance(n),w=(0,ev.lh)(h?.featureType),S=h?.chatMessageHeader;if(jf.U.getInstance(n).setFeatureName(w),C.setUserQueryGuid(v),jf.U.getInstance(n).setQueryID(v),jf.U.getInstance(n).sendBasicChatProcessingEvent({status:Tf.y2.Started,workflowAnnotationType:yf.KJ.getTypeName(),queryID:v,responseTime:(0,ny.xJ)(u)}),C.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ResponseReceivedFromAL},{key:Pf.h3.ChatEventParameters,value:yf.KJ.getTypeName()},{key:Pf.h3.UserQueryGuid,value:v},{key:Pf.h3.Cv,value:d}]),C.logTriedEvent([{key:Pf.qN,value:v}],Pf.Nx,w,(0,ev.A9)(w),void 0,(0,ev._w)(w),(0,ev.N2)(w)),C.sendTelemetryLatencyData([{key:Pf.CT.FeatureName,value:w}]),jf.U.getInstance(n).sendLoggingEventToClient(Tf.Yk.AugloopResponseReceived,{annotationName:yf.KJ.getTypeName(),timeInMs:(0,ny.xJ)(u)}),!Mf.A.getInstance(n).isAugloopResponseTimeoutRequired(h?.H_?.T_)||s.isALHookEnabled&&s.isALRequestResponseEnabled||wf._.getInstance(n).clearAugloopResponseTimer(),!(0,Vf.hX)(g)&&!(0,Vf.hX)(g?.category))return l(g,f,yf.KJ.getTypeName()),C.sendTelemetryLatencyData([{key:Pf.CT.UserPerceivedLatency,value:(0,ny.WU)(u)},{key:Pf.CT.QnAResponseTime,value:(0,ny.WU)(u)},{key:Pf.CT.IsQuerySuccess,value:!1},{key:Pf.CT.UserQueryGuid,value:v}],!0),jf.U.getInstance(n).sendBasicChatProcessingEvent({status:Tf.y2.Finished,workflowAnnotationType:yf.KJ.getTypeName(),queryID:v,isSuccess:!1,responseTime:(0,ny.xJ)(u)}),jf.U.getInstance(n).setQueryID(Df.u1),C.setUserQueryGuid(Df.u1),jf.U.getInstance(n).setFeatureName(Pf.Z_.ChatQnA),void(jf.U.getInstance(n).getIsFluxFlowEnabled()||((0,qf.cY)("Stopping loading UI"),t(!1)));const E=r.copyButtonLabel(),x=(0,bo.A)(),I={shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,showAnimation:!0,feedbackData:jf.U.getInstance(n).getFeedbackData(),isFailure:!1,messageId:x,actionButtonList:[{type:vo.jA.Default,title:E,text:(0,i.dD)()?"":E,iconRegular:(0,i.dD)()?Ls.c2D:Ls.Jg_,iconHover:(0,i.dD)()?Ls.cAv:Ls.Z1B,position:(0,i.dD)()?vo.SC.FeedbackSection:vo.SC.ActionButtonBar,popoverProps:{popoverTitle:r.copyButtonPopovertext()},handleButtonOnClick:(e,t,r)=>(0,Vf.Dd)(e,t,r,n)}],references:b&&b.length>0&&jf.U.getInstance(n).getBasicChatProps()?.isCitationsEnabled?jf.U.getInstance(n).getMarkdownReferences(b):void 0,clpSensitivityIndicatorData:jf.U.getInstance(n).getBasicChatProps()?.sensitivityIndicatorData??void 0,telemetryData:JSON.stringify({correlationId:v,featureName:w}),chatMessageHeaderData:jf.U.getInstance(n).getChatMessageHeaderData(S)},A=y?a._.MarkdownCard:a._.Default,P=y?{markDownCardProps:{user:"chat",message:p}}:{defaultMessageProps:{user:"chat",messageHeader:{text:p}}};e.setChatMessageData(A,P,I),m&&"suggestions"===m?.type&&m?.value?.suggestions?.length>0&&jf.U.getInstance(n).sendBasicChatSuggestionPillsEvent(m?.value?.suggestions),jf.U.getInstance(n).sendBasicChatProcessingEvent({status:Tf.y2.Finished,workflowAnnotationType:yf.KJ.getTypeName(),queryID:v,isSuccess:!0,responseTime:(0,ny.xJ)(u)}),C.sendTelemetryLatencyData([{key:Pf.CT.UserPerceivedLatency,value:(0,ny.WU)(u)},{key:Pf.CT.QnAResponseTime,value:(0,ny.WU)(u)},{key:Pf.CT.IsQuerySuccess,value:!0},{key:Pf.CT.UserQueryGuid,value:v}],!0),jf.U.getInstance(n).setQueryID(Df.u1),C.setUserQueryGuid(Df.u1),jf.U.getInstance(n).setFeatureName(Pf.Z_.ChatQnA),jf.U.getInstance(n).getIsFluxFlowEnabled()||((0,qf.cY)("Stopping loading UI"),t(!1))}})(zs,g),Vs=((e,t)=>{const n=(0,ry.D)(),r=(0,$y.cw)(e,t),s=(0,Ot.Y$)(),i=async(e,t,r,s,i)=>{if(jf.U.getInstance(n).getIsFirstStreamChunk()&&""===e)return void s.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.EmptyBasicChatResponse},{key:Pf.h3.UserQueryGuid,value:jf.U.getInstance(n).getQueryID()}]);let o=e;o=o.replace("\\n","\n").replace("\\t","\t");let l=jf.U.getInstance(n).getParagraphChunks();l+=o,jf.U.getInstance(n).setParagraphChunks(l);const c={shouldShowAIGeneratedIndicator:!0,showAnimation:!1,feedbackData:jf.U.getInstance(n).getFeedbackData(),isFailure:!1,clpSensitivityIndicatorData:jf.U.getInstance(n).getBasicChatProps()?.sensitivityIndicatorData??void 0,telemetryData:JSON.stringify({correlationId:jf.U.getInstance(n).getQueryID(),featureName:jf.U.getInstance(n).getFeatureName()}),chatMessageHeaderData:jf.U.getInstance(n).getChatMessageHeaderData(i)};jf.U.getInstance(n).updateStreamChunks({augloopResponseTime:(0,ny.WU)(ny.qD)}),jf.U.getInstance(n).getIsFirstStreamChunk()?(r.setChatMessageData(a._.MarkdownCard,{markDownCardProps:{user:"chat",message:o}},c,!1),jf.U.getInstance(n).setIsFirstStreamChunk(!1),s.sendTelemetryLatencyData([{key:Pf.CT.UserPerceivedLatency,value:(0,ny.WU)(ny.qD)}])):r.updateLastMessage(a._.MarkdownCard,{markDownCardProps:{user:"chat",message:l}},void 0,!1),t&&jf.U.getInstance(n).updateCardWithFooter()};return(o,l,c)=>{const u=o?.body,d=u?.answer,h=u?.error,p=u?.aiResponse,g=u?.status,m=u?.citations,f=u?.isStreaming,y=u?.isAnswerCompleted,v=u?.queryId,b=Wf.j.getInstance(n),C=(0,ev.lh)(u?.featureType),w=u?.chatMessageHeader;if((0,qf.cY)(`Getting isStreaming boolean as : ${f} and isAnswerCompleted as : ${y} and answer as : ${d} and featureType as : ${C}`),jf.U.getInstance(n).setFeatureName(C),b.setUserQueryGuid(v),jf.U.getInstance(n).setQueryID(v),jf.U.getInstance(n).getIsFirstStreamChunk()&&(jf.U.getInstance(n).sendBasicChatProcessingEvent({status:Tf.y2.Started,workflowAnnotationType:yf.Ob.getTypeName(),queryID:v,responseTime:(0,ny.xJ)(l)}),b.logTriedEvent([{key:Pf.qN,value:v}],Pf.Nx,C,(0,ev.A9)(C),void 0,(0,ev._w)(C),(0,ev.N2)(C)),b.sendTelemetryLatencyData([{key:Pf.CT.FeatureName,value:C}])),b.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ResponseReceivedFromAL},{key:Pf.h3.ChatEventParameters,value:yf.Ob.getTypeName()},{key:Pf.h3.UserQueryGuid,value:v},{key:Pf.h3.IsStreamingResponse,value:f.toString()},{key:Pf.h3.Cv,value:c}]),jf.U.getInstance(n).sendLoggingEventToClient(Tf.Yk.AugloopResponseReceived,{annotationName:yf.Ob.getTypeName(),timeInMs:(0,ny.xJ)(l)}),s.isALHookEnabled&&s.isALRequestResponseEnabled||wf._.getInstance(n).clearAugloopResponseTimer(),!(0,Vf.hX)(h)&&!(0,Vf.hX)(h?.category))return jf.U.getInstance(n).getIsFirstStreamChunk()||jf.U.getInstance(n).updateCardWithFooter(),r(h,g,yf.Ob.getTypeName()),jf.U.getInstance(n).sendBasicChatProcessingEvent({status:Tf.y2.Finished,workflowAnnotationType:yf.Ob.getTypeName(),queryID:v,isSuccess:!1,responseTime:(0,ny.xJ)(l)}),b.sendTelemetryLatencyData([{key:Pf.CT.UserPerceivedLatency,value:(0,ny.WU)(l)}]),void jf.U.getInstance(n).resetBasicChatStreamingStates(!1,!jf.U.getInstance(n).getIsFluxFlowEnabled());f?(jf.U.getInstance(n).setIsBasicChatStreaming(!0),i(d,y,e,b,w)):jf.U.getInstance(n).resetBasicChatStreamingStates(!0,!jf.U.getInstance(n).getIsFluxFlowEnabled()),m&&m.length>0&&jf.U.getInstance(n).getBasicChatProps().isCitationsEnabled&&(b.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.CitationReceived},{key:Pf.h3.ChatEventParameters,value:m.length.toString()},{key:Pf.h3.UserQueryGuid,value:v}]),e.updateLastMessage(a._.MarkdownCard,void 0,{references:jf.U.getInstance(n).getMarkdownReferences(m)},!1)),p&&"suggestions"===p?.type&&p?.value?.suggestions?.length>0&&jf.U.getInstance(n).sendBasicChatSuggestionPillsEvent(p?.value?.suggestions),f?s.isALHookEnabled&&s.isALRequestResponseEnabled||wf._.getInstance(n).setAugloopResponseTimer(u?.H_?.T_):(jf.U.getInstance(n).sendBasicChatProcessingEvent({status:Tf.y2.Finished,workflowAnnotationType:yf.Ob.getTypeName(),queryID:v,isSuccess:!0,responseTime:(0,ny.xJ)(l)}),jf.U.getInstance(n).getIsFluxFlowEnabled()||((0,qf.cY)("Streaming finished. Stopping loading UI"),t(!1)))}})(zs,g),{podcastAugloopResponseHandler:qs}=xw(zs,g,je.isAudioCastPlayerEnabled??!1),Ws=(0,N.useRef)(),{audiocastAugloopResponseHandlerV2:Qs}=ww(zs,M,hs,Je,g,re?.groundingState,R?.podcastErrorUiProps),{audiocastAugloopResponseHandler:Gs}=bw(zs,M,hs,Je,g,re?.groundingState),{ComphrehensionPodcastUIProps:Zs,comprehensionPodcastResponseHandler:Ys}=Fw(g),Ks=()=>me?Je.current?.getCIQTextRef():ln.current,Js=!!R.copilotWorkflowProps?.enableWorkflowPlugin&&R.copilotWorkflowProps.enableWorkflowPlugin,Xs=R.zeroQueryMessageProps??R.zeroQueryMessageV2Props,$s=R.copilotLabProps,ei=(e=>{const t=(0,it.mY)({addinWorkingOnItText:_f.lY,addinGettingReadyText:_f.rS,addinWorkingOnRequestText:_f.Bb,addinCraftingContentText:_f.zT}),n=(0,it.kQ)(Bf);return N.useMemo((()=>[t.addinWorkingOnItText({addinName:e}),t.addinGettingReadyText({addinName:e}),n.finishingUp(),t.addinWorkingOnRequestText({addinName:e}),n.gatheringResources(),t.addinCraftingContentText({addinName:e}),n.gettingEverythingReady(),n.finishingTouches()]),[n,t,e])})(Pt);function ti(){const e=sessionStorage?.getItem("preloadCopilot");if(e){const{isPreloaded:t,isHidden:n}=JSON.parse(e);return t&&n}return!1}N.useEffect((()=>{Fs({isHighContrast:_s?.isHighContrastModeEnabled??!1,isDarkTheme:_s?.isDarkModeEnabled??!1})}),[_s]),N.useEffect((()=>{""!==Pt&&Qt((e=>({...e,loadingUiStringList:[...ei]})))}),[Pt]);const ni=N.useCallback((()=>{if(ti())return;const e=(Ln?.document??document).getElementById(Df.FK);if(e){e.getBoundingClientRect().height<=0?j(!0):je.isChatContainerZoomedInResetEnabled&&j(!1)}}),[j,je.isChatContainerZoomedInResetEnabled]),ri=N.useCallback((()=>{const e=function(e,t,n){let r;const s=n??window;return(...n)=>{clearTimeout(r),r=s.setTimeout((()=>e(...n)),t)}}(ni,Df.BR,Ln);return e()}),[ni]),si=N.useCallback((e=>{et.current=e,e&&D!==s.Y.IOS&&(ni(),Gr.current=new ResizeObserver((()=>{ri()})),Gr.current.observe(e))}),[ni,ri,D]);(0,N.useEffect)((()=>(!ZC.L.getInstance()&&(0,qf.Nk)(pe)&&ZC.L.createInstance((0,qf.Nk)(pe)),je.isCopilotInBackstageMode&&Pe.setCopilotMode("backstage"),()=>{Gr.current&&et.current&&Gr.current.unobserve(et.current)})),[]),(0,N.useEffect)((()=>{We(Ve())}),[re?.isWebSearchOn,ue?.pluginsInfo]);const ii=()=>{Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AuthMessageReceived},{key:Pf.h3.ChatEventParameters,value:Jb.w.getInstance().getAuthMessageStatus()},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()}])};N.useEffect((()=>{const e=document.getElementById(ub.RD);if(!e)return;const t=new ResizeObserver((()=>{const t=e.getBoundingClientRect(),n=window.innerHeight-t.top+20;_t({position:"absolute",bottom:`${n}px`,left:"50%",transform:"translateX(-50%)"})}));return t.observe(e),()=>{t.disconnect()}}),[]);const ai=e=>{(e&&!lt.current||!e&&!ct.current)&&(e?Jb.w.getInstance().setAuthMessageStatus("ClaimChallenge"):Jb.w.getInstance().setAuthMessageStatus("TokenMissingInteractionRequired"),ii(),Sa({chatCardType:a._.WarningMessage,addCardToChatHistory:!1,chatMessageBodyData:{messageId:e?Df.DB:Df.xO,feedbackSectionPosition:o.O.Footer,shouldShowAIGeneratedIndicator:!1,warningActionButtons:[{buttonTitle:e?he.verifyAccessButtonPopover():he.signInButtonPopover(),buttonText:e?he.verifyAccessButtonLabel():he.signInButtonLabel(),handleButtonOnClick:()=>{Jb.w.getInstance().setAuthMessageStatus("SignInButtonClicked"),ii(),Ws.current.authenticateInteractive().then((async()=>{Jb.w.getInstance().setAuthMessageStatus("SignInSuccess"),ii(),Pa({messageIdToDelete:e?Df.DB:Df.xO,chatCardType:a._.WarningMessage}),e?lt.current=!1:ct.current=!1,jt(uf.NotShown)})).catch((e=>{(0,qf.cY)("error in authenticateInteractive: ",e),Pe.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:e.message},{key:Pf.IC.ErrorType,value:Pf.q0.Server},{key:Pf.IC.ErrorCategory,value:kf.S2.Augloop}])})).finally((()=>{}))}}]},chatMessageData:{warningMessageCardProps:{user:Af.Q9.Chat,warningPrefix:e?he.claimChallengeChatMessage():he.authenticactionErrorMessage()}}}),e?(lt.current=!0,jt(uf.ClaimsChallenge)):(ct.current=!0,jt(uf.UserInteractionRequired)))},oi=()=>{if(!ct.current)try{Jb.w.getInstance().setAuthMessageStatus(Df.ie),ii(),Sa({chatCardType:a._.WarningMessage,addCardToChatHistory:!1,chatMessageBodyData:{messageId:Df.xO,feedbackSectionPosition:o.O.Footer,shouldShowAIGeneratedIndicator:!1,warningActionButtons:[{buttonTitle:he.signInButtonPopover(),buttonText:he.signInButtonLabel(),handleButtonOnClick:async()=>{try{Jb.w.getInstance().setAuthMessageStatus(Df.XZ),ii(),await(Ws.current?.authenticateInteractive()),Jb.w.getInstance().setAuthMessageStatus(Df.qf),ii(),Pa({messageIdToDelete:Df.xO,chatCardType:a._.WarningMessage}),ct.current=!1}catch(e){(0,qf.cY)("error in authenticateInteractive: ",e),Pe.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:e instanceof Error?e.message:String(e)},{key:Pf.IC.ErrorType,value:Pf.q0.Server},{key:Pf.IC.ErrorCategory,value:kf.S2.Augloop}])}}}]},chatMessageData:{warningMessageCardProps:{user:Af.Q9.Chat,warningPrefix:he.authenticactionErrorMessage()}}}),ct.current=!0}catch(e){(0,qf.cY)("Error in addSignInVerificationMessage:",e)}},li=()=>{Sa({chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:Af.Q9.Chat,messageHeader:{text:he.missingServicePlanBYOAErrorText()}}},chatMessageBodyData:{feedbackSectionPosition:o.O.Footer,showAnimation:!0,isFailure:!0},stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!1})};le?.voiceInputProps&&(0,qf.zA)()&&(le.voiceInputProps=void 0);const ci=()=>M.isFeatureGateEnabledFromClient(Af.WT.IsDebugSectionV2Enabled),{ashaLogData:ui,stkLogData:di,updateASHALogData:hi,updateSTKLogData:pi}=(e=>{const t=(0,Ot.Y$)(),[n,r]=(0,N.useState)([]),[s,i]=(0,N.useState)([]),a=(0,N.useCallback)(((s=Pf.Z_.CopilotChat,i=Df.yb,a=Df.w)=>{if(!e&&!t?.isRealtimeTelemetryDebugUIEnabled)return;const o=Object.values(Pf.eA).find((e=>i.includes(e.toString())))||Pf.eA.UnclearIntent;let l=n.find((e=>e.pillarName===o));l||(l={pillarName:o,pillarAshaData:[]},r((e=>[...e,l])));let c=l.pillarAshaData.find((e=>e.featureName===s));c||(c={featureName:s,vetos:[]},l.pillarAshaData.push(c));let u=i.replace(o,"").trim();u=u.replace(s,"").trim();let d=c.vetos.find((e=>e.vetoName===u));d||(d={vetoName:u,errorStrings:[]},c.vetos.push(d));let h=d.errorStrings.find((e=>e.string===a));h?h.count+=1:(h={string:a,count:1},d.errorStrings.push(h))}),[n]),o=(0,N.useCallback)(((n,r,a)=>{if(!e&&!t?.isRealtimeTelemetryDebugUIEnabled)return;let o=s.find((e=>e.verbName===r));o||(o={verbName:r,featureItems:[]},i((e=>[...e,o])));let l=o.featureItems.find((e=>e.featureName===n));l||(l={featureName:n,seen:0,tried:0,kept:0},o.featureItems.push(l)),a===kf.hI.Seen?l.seen+=1:a===kf.hI.Tried?l.tried+=1:a===kf.hI.Kept&&(l.kept+=1)}),[s]);return{ashaLogData:n,stkLogData:s,updateASHALogData:a,updateSTKLogData:o}})(ci());Pe.setUpdateASHAProps(hi),Pe.setUpdateSTKRecord(pi);const gi=()=>M.isFeatureGateEnabledFromClient(Af.WT.IsSuggestedQnACitationsEnabled);xf.w.isDevbuild()&&(B?.isDebugToggleEnabled||ci())&&oy.J.initialize();let mi=!0;const fi=(e,t)=>{if(ut.current>0)return Ge[(0,qf.y6)(Ge,e,t)]};(0,N.useImperativeHandle)(oe,(()=>({addResponseMessage:Sa,updateMessage:xa,resendChatHistorySignal:Ia,updateLastMessage:Aa,deleteMessage:Pa,submitOperation:ka,updateLoadingComponentProps:Ta,addChatMessages:Da,getLastMessage:fi,clearMessages:Ma,hasMessage:La,startLoadingUi:Ra,startReinitializeALSession:Na,setInputAreaText:Oa,setInputFocus:_a,getInputText:Ba,submitUserQuery:Fa,getIsExecuting:Ua,executePluginOperation:Ha,executeClientSkillFromInterstitialMessage:za,updateDraftForEntity:ja,scrollToBottom:()=>{ut.current>0&&Va()},activateClientALAnnotations:Ti,updateAttachmentList:qa,startNewChat:Wa,openRealtimeVoiceCopilot:e=>{e&&cs(e),us(Pw.S.RealtimeVoice)},openPreviewCodeDialog:Ns,openSideQuest:(e,t,n)=>{Ft.logSideQuestEvent(Pf.a5.SideQuestEditButtonClicked),Ft.logKeptEvent(Ge[e].telemetryData??""),Bt.current=t,Ht.current=n??Ht.current,Mt(e),ts(!0)},loadPreviewDialog:Os,switchAtMention:Qa,addSignInVerificationMessage:oi,updateChatSessionId:Ga,getMessageAtIndex:e=>Ge[e],chatSearchSettings:re,updateExecutionStatusForAddInActions:Za,fetchDebugLogs:Ya})));const yi=(e,t,n,r,s)=>{zs.setChatMessageData(e,t,n,r,s)},vi=e=>{e.forEach((e=>{zs.submitRichTextChatMessage(e)}))},bi=e=>{Je.current?.setInputText(e)},Ci=async e=>{if(Ks()){const t=e?await ce.getSensitivityInfo(e):null;gn(!1),Ks().setSensitivity(t),gt(!1)}},wi=async()=>{if(Ks()){const e=await ce.getSensitivityInfo(null);Ks().setSensitivity(e),gn(!1)}},Si=()=>Je.current?.getInputText()||"",Ei=e=>{Je.current?.setGhostText(e)},xi=()=>{Je.current?.removeImages()},Ii=()=>[...Je.current?.getImages()??[]],Ai=N.useCallback(Mw(((e=!1)=>{if((!je.isLatencyArrowEnabled||e)&&ut.current>0&&(qt()||je.isLatencyArrowEnabled&&!e)){const e=je.isInstantScrollEnabled?"instant":"smooth";Xe?.current&&Xe.current.scrollIntoView({behavior:e,block:"end"})}}),je.isInstantScrollEnabled?je.instantScrollToBottomThrottleDelay:je.scrollToBottomThrottleDelay),[]),Pi=(e,t)=>{const n=t?.checked;(0,qf.cY)("Toggling Try Web chat to "+(n?"on":"off")),St(n??!1)},ki=async()=>{const e=(0,bo.A)(),t=M.isFeatureGateEnabledFromClient(Af.WT.IsCopilotPluginEnabled)?hs.getEnabledPlugins():[],n=await M.getDefaultSignalOperation("",e,iy.c.currentChatId,void 0,void 0,t,void 0,J?.currentSelectedGPTId,x,void 0,!0,void 0,void 0,void 0,void 0,re?.groundingState);(0,pb.RJ)(!0,pe),je.isALHookEnabled?Cs(n.operation,n.workflowAnnotationType,!0):Cf.E.getInstance(pe).submitOperation(n.operation,n.workflowAnnotationType,!0),Q.current=e},Ti=async()=>{try{await ks(ti,rt,oo(),io(),J?.shouldClearChatHistory,J?.currentSelectedGPTId,ki,Pl?.(),Eo,R?.interactiveCardProps?.contentProviders)}catch(e){(0,qf.cY)("Exception occurred during initialization of AL"+e.message)}},Mi=e=>{if(e){Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.MicrophoneLoadingTimeInMs},{key:Pf.h3.ChatEventParameters,value:(0,Vf.xJ)(yy)}]);const e=Je.current?.getInputText().length>0&&mi?Df.Gs:Df.u1;Je.current?.setGhostText(e+he.micListeningGhostText())}else Je.current?.getInputText()===Df.u1?Je.current?.setGhostText(he.chatPlaceholderMessage()):Je.current?.getGhostText()?.trim()===he.micListeningGhostText()&&Je.current?.setGhostText(Df.u1);an(e),on.current=e},Li=()=>{Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ProactiveZQMLoad}])},Ri=(e=1)=>{Ze((t=>{if(t.length>=e){return t[t.length-e].isResponseStreaming=!1,[...t]}return t}))};(0,N.useEffect)((()=>{oo()&&$b.g.createInstance(xe?.sessionId,pe)}),[xe?.sessionId]),(0,N.useEffect)((()=>{if(je?.isAgentsLoggingEnabledInShared)return J?.currentSelectedGPTId?Wf.j.setExtensibilityInfo({workflowAnnotationType:"",gptId:J?.currentSelectedGPTId,agentType:(0,Hw.UD)(J?.currentSelectedGPTId),viewMode:"ChatPane"}):Wf.j.setExtensibilityInfo(void 0),()=>{Wf.j.setExtensibilityInfo(void 0)}}),[je.isAgentsLoggingEnabledInShared,J?.currentSelectedGPTId]),(0,N.useEffect)((()=>{if(io()){const e=et.current;if(e){let t=0,n=!0;const r=()=>{et.current.scrollHeight-Math.round(et.current.scrollTop)-Df.sy<=et.current.clientHeight?n=!1:!tt.current&&Sf.W5&&!n&&Math.round(e.scrollTop)<=Math.round(et.current.scrollHeight/Df.HX)&&t!=e.scrollHeight&&iy.c.chatSessionId&&!p&&!wr?.current&&(fn(!0),wr.current=!0,t=e.scrollHeight,Sn(t),(async()=>{Ke||(await(0,Sf.a_)({op:gf.S5.GetMessagesOperation,submitOperation:je.isALHookEnabled?Cs:void 0,clearOperationListForResubmit:je.isALHookEnabled?Ts:void 0,componentId:pe}),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.GetPreviousMessagesForPagination}]))})())};return e.addEventListener("scroll",r),()=>e.removeEventListener("scroll",r)}}}),[et.current,mt]),(0,N.useEffect)((()=>{(0,Sf.zZ)(R.documentSensitivityProps,pe)}),[R.documentSensitivityProps]),(0,N.useEffect)((()=>{Ks()||(gt(!1),gn(!1))}),[Ks]),(0,N.useEffect)((()=>{Cn((e=>({...e,...R.copilotWorkflowProps})))}),[R.copilotWorkflowProps]),(0,N.useEffect)((()=>{Ai()}),[R.streamingUiProps?.cardDataValue,dn,p,Wt,V,R?.suggestionPillsUiProps?.suggestionList]),(0,N.useEffect)((()=>{if(je.isALHookEnabled||Cf.E.getInstance(pe).updateIsExecutingState(p),p)M.sendEventToClient(Tf.PV.QueryExecutionStarted),ny.sU.sendLoggingEventToClient(Tf.Yk.QueryExecutionStarted);else{(0,Qf.$w)(Df.u1),M.sendEventToClient(Tf.PV.QueryExecutionCompleted),ny.sU.sendLoggingEventToClient(Tf.Yk.QueryExecutionCompleted);let e=Df.u1;M.isFeatureGateEnabledFromClient(Af.WT.EnableALCorrelationLogs)&&(e=Jb.w.getInstance().getQueryCv()),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.QueryExecutionCompleted},{key:Pf.h3.Cv,value:e},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()},{key:Pf.h3.IsOutputV2Shown,value:je.isOutputV2Enabled??!1}]),KQ="",Q.current="",b(KQ),je.isLoadingInOutputEnabled&&Ri();try{jf.U.getInstance(pe).getIsBasicChatStreaming()&&jf.U.getInstance(pe).resetBasicChatStreamingStates()}catch(e){(0,qf.cY)("An error was thrown while trying to reset basic chat streaming. "+e)}}}),[p]),(0,N.useEffect)((()=>{!c&&Xs?.promptSuggestionList.length>0&&(je.isZQMSeenTelemetryfromSharedEnabled||ny.sU.sendLoggingEventToClient(Tf.Yk.ZQMLoaded),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMLoaded}]),X&&Li(),ti()||(je?.shouldShowDADiscoverabilityZQM||bl(),vl()))}),[c]),(0,N.useEffect)((()=>{Tr.current=new Gf(Je,sa,le?.chatPlaceholderMessage,yi,hn,gi(),M,je,pe)}),[le?.chatPlaceholderMessage]),(0,N.useEffect)((()=>{Ue.current=re}),[re]);const Ni=N.useCallback((()=>{Tr.current?.setSuggestedQnAList([])}),[]);(0,N.useEffect)((()=>{zi.current.updateLocale(xf.w.getLanguage()),Pe.setTelemetryHandler(L),ke.initTelemetryLatencyObject(),ny.sU.sendLoggingEventToClient(Tf.Yk.ChatPaneInitalized,{timestamp:(new Date).getTime()}),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ChatPaneInitialized},{key:Pf.h3.ChatEventParameters,value:(new Date).getTime().toString()}]);const e=(0,QC.iB)(J?.currentSelectedGPTId);return Mf.A.getInstance(pe).initializeWorkflowDataMap(M,e),(0,qf.UA)(je.enableChatHistoryHandlingByClient,pe)?Ef.P.getInstance(pe,ft,sr,Ln):ft(!1),XQ=0,w(XQ),M.updateCopilotState(Tf.SG.IDLE),Tr.current=new Gf(Je,sa,le?.chatPlaceholderMessage,yi,hn,gi(),M,je,pe),(0,l._X)(void 0!==f),R?.chatInputProps&&Je.current?.setFocus(),re?.clearSuggestionList&&(re.clearSuggestionList.current=Ni),()=>{je.isALHookEnabled&&je.isALRequestResponseEnabled||wf._.getInstance(pe).clearAugloopResponseTimer(),je.isALHookEnabled&&!je.releaseAnnotationsInCopilotChatDisplay&&(Is(),Es(!1),xs.current=!1),je.isALHookEnabled||(Cf.E.getInstance().releaseActiveAnnotations(),Es(!1),xs.current=!1),zQ(je),(0,qf.k1)(),eG(),(0,qf.J)(pe)}}),[]),(0,N.useEffect)((()=>{Ss&&ho()}),[Ss]),(0,N.useEffect)((()=>{var e;Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ExtensibilityConfig},{key:Pf.h3.ChatEventParameters,value:(e=je??{},JSON.stringify({isDeclarativeAgentsEnabled:e?.isCustomGPTsEnabled,enableSwitcherMenuV2:e?.enableSwitcherMenuV2,loadGptListOnCopilotIconClick:e?.loadGptListOnCopilotIconClick,showAgentMenuNudgeAndTooltip:e?.showAgentMenuNudgeAndTooltip,showAgentMenuExploreBadge:e?.showAgentMenuExploreBadge,isSDXRenderingForPreload:!e?.isFocusChatInputOnMount,enableAgentsBasedOnSkill:e?.enableAgentsBasedOnSkill,isClickButtonStyleHamburgerEnabled:e?.isClickButtonStyleHamburgerEnabled,enableAddSelectionForGPTs:e?.enableAddSelectionForGPTs,isMultiSelectionAttachmentForGPTsEnabled:e?.isMultiSelectionAttachmentForGPTsEnabled,isImplicitSelectionEnabledForExtensibilityScenarios:e?.isImplicitSelectionEnabledForExtensibilityScenarios,areAddinLocalPluginActionsEnabled:e?.areAddinLocalPluginActionsEnabled}))}])}),[L]),(0,N.useEffect)((()=>(fs&&((async()=>{await mo()})(),Ws.current=fs),()=>{je.releaseAnnotationsInCopilotChatDisplay&&je.isALHookEnabled&&Is(),Es(!1),xs.current=!1})),[fs]),(0,N.useEffect)((()=>{sn?Je.current?.setFocus():(0,gy.WT)(Mi).catch((e=>{(0,qf.cY)("pauseMicandStopTimer Error"+e)}))}),[sn]),(0,N.useEffect)((()=>{(Ln??window).addEventListener("blur",(()=>{Je.current?.closeMenu(),le?.voiceInputProps&&on.current&&Mi(!1)}))})),(0,N.useEffect)((()=>{wr.current=!1,je.isLoadingInOutputEnabled&&ut.current<Ge.length&&Ge.length>2&&Ge[Ge.length-2].body.user!==Af.Q9.Human&&Ri(2);const e=ut.current;if(ut.current=Ge.length,mn){if(!p&&et?.current){let e=et.current.scrollHeight-wn;et.current.scrollTop>e&&(e=et.current.scrollTop/wn*et.current.scrollHeight),et.current.scrollTo({top:e,left:0,behavior:"instant"})}}else e==Ge.length&&je.disableScrollWhileResponseStreaming||Ai();fn(!1),c&&Ge.length>0&&u(!1)}),[Ge,c]),(0,N.useEffect)((()=>{mt&&!nt||(Ai(),(Ss||nt)&&(rt(!1),Pe.sendTelemetryLatencyData([{key:Pf.CT.CopilotChatLoadTime,value:(0,Vf.WU)(ge.current)}]),M.sendEventToClient(Tf.PV.CopilotChatLoaded,{workflowAnnotationType:"",gptId:J?.currentSelectedGPTId}),ny.sU.sendLoggingEventToClient(Tf.Yk.ChatPaneLoaded,{timestamp:(new Date).getTime()}),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ChatPaneLoaded},{key:Pf.h3.ChatEventParameters,value:(new Date).getTime().toString()}]),!c&&Xs?.promptSuggestionList.length>0&&(je.isZQMSeenTelemetryfromSharedEnabled||ny.sU.sendLoggingEventToClient(Tf.Yk.ZQMLoaded),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMLoaded}]),X&&Li())))}),[mt,Ss,nt]),(0,zw.A)((async()=>{Be.current=Be.current+1;const e=1==Be.current;je.isZQMSeenTelemetryfromSharedEnabled&&Oe.current&&(0,QC.Uj)(Oe,Pe,at,_e,e)})),(0,N.useEffect)((()=>{je.isZQMSeenTelemetryfromSharedEnabled&&Oe.current&&je.isFocusChatInputOnMount&&(0,QC.Uj)(Oe,Pe,at,_e)}),[Oe.current]),(0,N.useEffect)((()=>{if(!mt){br.current=(0,Vf.WU)(Sf.mD),Pe.sendTelemetryLatencyData([{key:Pf.CT.ChatHistoryTimeInLoad,value:br.current}]);(Ln??window).performance.getEntriesByName(Df.Nn).forEach((e=>{kn((e.startTime/1e3).toFixed(2))})),xn((0,Vf.WU)(ZQ)),B?.taskPaneStartTime&&(Mn.current=(0,Vf.WU)(B.taskPaneStartTime),xn((Mn.current+br.current).toFixed(2)))}}),[mt]),(0,N.useEffect)((()=>{rr&&(M.sendEventToClient(Tf.PV.ChatHistoryHydrationFailed),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ChatHistoryHydrationFailed}]),tt.current=rr)}),[rr]),(0,N.useEffect)((()=>{zi.current.updateDarkMode(_s.isDarkModeEnabled)}),[m,f]),(0,N.useEffect)((()=>{(R?.suggestionPillsUiProps?.clearCacheSuggestionPills||R?.suggestionPillsUiProps?.suggestionList&&R?.suggestionPillsUiProps?.suggestionList.length>0)&&dn.length>0&&Tr.current?.setSuggestedQnAList([])}),[R?.suggestionPillsUiProps]),(0,N.useEffect)((()=>{if(!zs||!g||!M)return;jf.U.getInstance(pe,zs,M,g),jf.U.getInstance(pe).setBasicChatProps(O);const e=he.copyButtonText();e.length>0&&jf.U.getInstance(pe).setCopyButtonText(e);const t=he.copyButtonPopOverText();t.length>0&&jf.U.getInstance(pe).setCopyButtonPopoverText(t)}),[O]),(0,N.useEffect)((()=>{cn&&Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.TrySydneyToggle},{key:Pf.h3.ChatEventParameters,value:R.toggleUiProps?.trySydneyToggleChecked?"true":"false"}])}),[cn]),(0,N.useEffect)((()=>{Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.IsSydneyEnabled},{key:Pf.h3.ChatEventParameters,value:R.toggleUiProps?.trySydneyToggleChecked?"true":"false"}])}),[R.toggleUiProps?.trySydneyToggleChecked]),(0,N.useEffect)((()=>{Ss&&!mt&&ht.current&&(sa({text:ht.current?.text,images:ht.current?.images}),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.QuerySubmittedBeforeAnnotationLoad},{key:Pf.h3.ChatEventParameters,value:(0,Vf.xJ)(ht.current?.timestamp)}]),ht.current=null)}),[Ss,mt]),(0,N.useEffect)((()=>{v((Yt?.isError||Yt?.isWarning)&&Yt?.headerText&&!c&&!p)}),[Yt,c,p]),(0,N.useEffect)((()=>{h(p||Yt?.isError||le?.isDisabled||ue?.isDisabled||Us)}),[p,Yt,le,ue,zt]),(0,N.useEffect)((()=>{$s?.copilotLabLink&&zi.current.updateCopilotLabLink($s?.copilotLabLink),$s?.isCopilotLabHeaderDisabled&&zi.current.updateIsHeaderDisabled($s?.isCopilotLabHeaderDisabled),$s?.facets&&zi.current.updateFacets($s?.facets),$s?.handlePromptClick&&zi.current.updateHandlePromptClick($s?.handlePromptClick)}),[$s]),(0,N.useEffect)((()=>{const t=je.isSaveSharePromptEnabled||je.isSavePromptEnabled?[...yt,...bt]:yt;if(zi.current.updatePrompts(t),!$s?.facets){const e=(0,Vf.U)(t);zi.current.updateFacets({displayCategory:e})}e(null,t),(je.isSaveSharePromptEnabled||je.isSavePromptEnabled)&&(0,Lw.bS)(bt)}),[yt,bt]);const Oi=N.useMemo((()=>Ke&&(mt||!Ss)&&Xs?.promptSuggestionList.length>0),[mt,Ss]),_i=N.useMemo((()=>mt||!Ss),[mt,Ss]),Bi=N.useMemo((()=>(mt||!Ss)&&Tr?.current&&Xs?.promptSuggestionList.length>0&&(R.zqmEarlyLoadProps?.isUserTypeUnique&&je.isZQMEarlyLoadingEnabled||je.isCopilotInBackstageMode&&je.isZQMEarlyLoadingEnabledInBackstage)),[mt,Ss,Tr?.current]),Ui=N.useCallback((e=>!((e=>e===Af.Ku.GroundingButton||e===Af.Ku.PromptGuide)(e)||!_i)&&((e=>e===Af.Ku.SubmitButton)(e)?((0,qf.cY)("Queue user query to be submitted once annotations are loaded."),ht.current={text:Si(),images:Ii(),timestamp:Date.now()},h(!0),Ei(le?.chatPlaceholderMessage??he.chatPlaceholderMessage()),bi(Df.u1),Jt(!1),xi()):((0,qf.cY)("Setting pane load warning banner as chat history is still loading."),A||P(!0),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ChatPaneLoadMessageBarShown},{key:Pf.h3.ChatEventParameters,value:e.toString()}])),!0)),[A,_i]),Hi=(0,lv.Zp)(Je),zi=(0,N.useRef)(Hi(he.libbieTitle(),he.libbieButtonText(),_s?.isDarkModeEnabled)),ji=(()=>{const e=(0,An.Mb)(),t=e.hostAppAuthToken?.cognitiveTokenProvider,n=N.useCallback((async()=>{if(!t)throw new Error("Cognitive token provider not available");const e=(await t())?.accessToken;return e}),[t]);return t?n:void 0})();let Vi;const qi=N.useMemo((()=>je.isSideQuestEnabled&&!(0,QC.iB)(J?.currentSelectedGPTId)),[je.isSideQuestEnabled,J?.currentSelectedGPTId]),{getUserQueryGuid:Wi,handleAtMentionAndGptQuery:Qi,handleChangeTopicButtonQuery:Gi,handleExceptionInHandleSubmit:Zi,logFirstQueryTelemetry:Yi,logZQMPromptSubmitTelemetry:Ki,logHandleSubmitTelemetry:Ji,logCopilotLabPromptTelemetry:Xi,setUserMessageForPromptSubmit:ea}=(({isFirstQuery:e,isChatInputZQMRef:t,currentZQMProps:n,warmUpQueryIdRef:r,libbieLoaderDataSource:s,switcherMenuProps:i,atMentionApp:o,chatInputRef:l,setPersistedGPTCopilotContext:c,setLoadingComponentProps:u,setIsExecuting:d,copilotCommunicationHandler:h,isMicInvolvedInQueryRef:p})=>{const g=(0,ry.D)(),m=N.useRef(Wf.j.getInstance(g)),f=(0,Ot.Y$)(),y=(0,Xn.zK)(),{submitOperation:v,clearOperationListForResubmit:b}=(0,sy.G)(),C=(0,it.kQ)({augLoopErrorMessage:_f.Ao}),w=Ff(),S=(0,An.Mb)().hostAppSettings.window,E=N.useCallback((()=>{e.current&&((0,qf.cY)("First Query submitted by User"),m.current.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.FirstQuerySubmitted},{key:Pf.h3.ChatEventParameters,value:(new Date).getTime().toString()}]),m.current.sendTelemetryLatencyData([{key:Pf.CT.IsFirstSdxSessionQuery,value:!0}]),e.current=!1)}),[e]),x=N.useCallback((({text:e,telemetryData:r})=>{if(e&&t.current&&n?.current&&n?.current?.promptSuggestions?.length>0){const t=(0,QC.or)(n?.current?.promptSuggestions,e);t&&(m.current.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:r===Pf.a5.ZQMButtonClicked?Pf.a5.ZQMQuerySubmittedDirectly:Pf.a5.ZQMQuerySubmitted},{key:Pf.h3.ChatEventParameters,value:t.source??$n.L.Static}]),t.promptSuggestionId&&t.promptSuggestionId!==Df.u1&&m.current.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMSubmittedPrompt},{key:Pf.h3.ChatEventParameters,value:t.promptSuggestionId}]))}t.current=!1}),[n,t]),I=N.useCallback((()=>(f.isQueryWarmupSignalEnabled||f.isQueryWarmupSignalEnabledOnChatPaneOpens)&&r.current?r.current:(0,bo.A)()),[f.isQueryWarmupSignalEnabled,f.isQueryWarmupSignalEnabledOnChatPaneOpens,r]),A=N.useCallback((({telemetryData:e})=>{m.current.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:e??Pf.a5.EnterKeyPressed},{key:Pf.h3.ChatEventParameters,value:(new Date).getTime().toString()}]),m.current.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.QuerySubmittedByUser},{key:Pf.h3.IsMicrophoneInvolvedInQueryInput,value:p.current.toString()}]),p.current=!1}),[]),P=N.useCallback((()=>{const e=(0,Qf.xH)(),t=(0,Qf.Q)();if(e!==Df.u1){const n=s.current.getData();m.current.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.CopilotLabPromptSubmitted},{key:Pf.h3.FilterParameters,value:JSON.stringify(n?.selectedFacets??{})},{key:Pf.h3.PromptLibraryPromptId,value:e},{key:Pf.h3.PromptOrigin,value:t?.Origin??Df.u1}])}}),[s]),k=N.useCallback((async({messageImages:e,messageText:t,setChatMessage:n,storedChatHistoryData:r,entityList:s,links:i,isHidden:o})=>{const l=!f.isChatHistorySignalDeferred;if(e.length>0){let s=[];s=await(0,QC.Dg)(e,S,g),n(a._.SketchImageCard,{sketchImageMessageProps:{user:hl.Q9.Human,sketchImageData:s,messageText:t}},void 0,l,r)}else{const e=f.isSaveShareHydratedEntitiesEnabled?s:void 0;n(o?a._.HiddenCard:a._.MarkdownCard,o?{}:{markDownCardProps:(0,qf.ad)(t,i,e)},void 0,l,r)}}),[f.isChatHistorySignalDeferred,f.isSaveShareHydratedEntitiesEnabled]),T=N.useCallback((async({userQueryGuid:e})=>{let t=!1;if(o||(0,QC.iB)(i?.currentSelectedGPTId)){const n={selectedGptId:i?.currentSelectedGPTId,atMentionApp:o,persistedCanvasContext:f.enableAddSelectionForGPTs?l.current?.getRawCanvasSelections?.():void 0};c(n);const r=l.current?.getRawCanvasSelections?.();t=!!f.enableAddSelectionForGPTs&&!!r&&r.length>0&&"[]"!==r,(0,QC.V6)(p.current,t,e,i?.currentSelectedGPTId,o,y?.getCopilotAgentType,g)}return t}),[o,l,f.enableAddSelectionForGPTs,c,y?.getCopilotAgentType,i?.currentSelectedGPTId]),D=N.useCallback((async e=>{e(!0),u((e=>({...e,loadingUiStringList:[w[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})));const t={gptId:i?.currentSelectedGPTId};await(0,Sf.a_)({op:gf.S5.AddChatOperation,gptInfo:t,submitOperation:f.isALHookEnabled?v:void 0,clearOperationListForResubmit:f.isALHookEnabled?b:void 0,componentId:g})}),[g,w,f.isALHookEnabled,u,v,i?.currentSelectedGPTId]),M=N.useCallback((({exception:e,setChatMessage:t,querySubmitTime:n})=>{(0,qf.cY)("CopilotChat Log: Exception:"+JSON.stringify(e)+" Error message: "+e.message),h.updateCopilotState(Tf.SG.QUERY_SUBMITTED_FAILED),f.isALHookEnabled&&f.isALRequestResponseEnabled||wf._.getInstance(g).clearAugloopResponseTimer(),t(a._.Default,{defaultMessageProps:{user:hl.Q9.Chat,messageHeader:{text:C.augLoopErrorMessage()},embeddedLists:[]}}),h.updateCopilotState(Tf.SG.IDLE),m.current.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:"Error in handle submit: "+e.message},{key:Pf.IC.ErrorType,value:Pf.q0.Client},{key:Pf.IC.ErrorCode,value:Af.O4.HandleSubmitError},{key:Pf.IC.ErrorCategory,value:kf.S2.ChatEvents}]),m.current.sendTelemetryLatencyData([{key:Pf.CT.UserPerceivedLatency,value:(0,Vf.WU)(n)},{key:Pf.CT.IsQuerySuccess,value:!1}],!0),d(!1)}),[g,h,f.isALHookEnabled,f.isALRequestResponseEnabled,C,d]);return{getUserQueryGuid:I,handleAtMentionAndGptQuery:T,handleChangeTopicButtonQuery:D,handleExceptionInHandleSubmit:M,logFirstQueryTelemetry:E,logZQMPromptSubmitTelemetry:x,logHandleSubmitTelemetry:A,logCopilotLabPromptTelemetry:P,setUserMessageForPromptSubmit:k}})({isFirstQuery:Dn,isChatInputZQMRef:ot,currentZQMProps:at,warmUpQueryIdRef:Q,libbieLoaderDataSource:zi,switcherMenuProps:J,chatInputRef:Je,setPersistedGPTCopilotContext:xr,atMentionApp:x,setLoadingComponentProps:Qt,setIsExecuting:g,copilotCommunicationHandler:M,isMicInvolvedInQueryRef:is}),ta=N.useRef(p);(0,N.useEffect)((()=>{ta.current=p}),[p]);const na=N.useMemo((()=>{const e=M?.getHostSettings()?.appName,t=M?.getHostSettings()?.appPlatform;let n=t;return"officeonline"===t?.toLowerCase()&&(n="Web"),e&&n?`${e}_${n}_${WQ.$}`:WQ.$}),[M]),ra=N.useCallback((()=>{try{const e=localStorage.getItem(na);if(e){const t=JSON.parse(e),n={...QQ.a,...t};return{format:n.format,style:n.style,duration:n.duration,custom_instructions:n.custom_instructions}}}catch(e){(0,qf.cY)("Error loading saved audio settings:",e),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AudioCastPlayerError},{key:Pf.h3.ChatEventParameters,value:JSON.stringify({name:"FloatingPodcastPlayer.Error.CopilotChatDisplay.RetrieveSavedSettings",resultType:"Failure",resultCode:"RetrieveSavedSettingsFailurePodcast",extraData:{error:e instanceof Error?e.message:String(e)}})},{key:Pf.h3.UserQueryGuid,value:KQ||""}])}return{format:QQ.a.format,style:QQ.a.style,duration:QQ.a.duration,custom_instructions:QQ.a.custom_instructions}}),[na]),sa=N.useCallback((async({text:e,links:r,telemetryData:s,queryAnnotations:i,invokeActionConfirmation:l,images:d,entityList:h,isHidden:p=!1,actionAgentId:m,requestMetaData:f,audioCastSettings:v})=>{if(ay.k.getInstance().getIsLocalAddinFlowExecuting()&&ay.k.getInstance().setIsLocalAddinFlowExecuting(!1),m&&ta.current)throw new Error("Query Execution is in progress. Please wait for the current query to complete.");if("comprehension"===R?.activeView&&Ml("chat"),(!e||0===e.length)&&0===Si().length)return;if(e&&(e=>{const t=M.isFeatureGateEnabledFromClient(Af.WT.EnableInlineCreationHVC),r=M.isFeatureGateEnabledFromClient(Af.WT.EnableInlineCreationHVCV2);if((0,qf.cY)("isInlineCreationEnabled",t),(t||r)&&e.toLowerCase().includes(Df.QJ)){(0,qf.cY)("Inline Creation HVC invoked");const t=N.lazy((()=>Promise.all([n.e(3062),n.e(9037),n.e(3341),n.e(2820)]).then(n.bind(n,93367)).then((e=>({default:e.InlineCreationHVCApp}))))),s=N.lazy((()=>Promise.all([n.e(3062),n.e(9037),n.e(3341),n.e(2820)]).then(n.bind(n,93367)).then((e=>({default:e.InlineCreationHVCAppV2})))));yi(a._.MarkdownCard,{markDownCardProps:(0,qf.ad)(e)});const i=M.isFeatureGateEnabledFromClient(Af.WT.shouldLimitFilesInlineCreationHVC);if((0,qf.cY)("Inline Creation HVC shouldLimitSuggestedFiles: ",i),Zr){if(!Zr?.hostSettings){const e={...$,appName:xf.w.getAppName(),environment:xf.w.getEnvironment(),sessionId:xe?.sessionId,devBuild:xf.w.isDevbuild(),fetchAugloopSession:()=>Ws.current,fetchAugloopAuthToken:()=>M.getAuthToken()};Zr.hostSettings=e}Zr?.userInputData||(Zr.userInputData={userQuery:e})}else r&&(Zr={hostSettings:{...$,appName:xf.w.getAppName(),environment:xf.w.getEnvironment(),sessionId:xe?.sessionId,devBuild:xf.w.isDevbuild(),fetchAugloopSession:()=>Ws.current,fetchAugloopAuthToken:()=>M.getAuthToken()},userInputData:{userQuery:e}});return yi(a._.ChatCardWrapper,{chatCardWrapperProps:{user:Af.Q9.Chat,element:N.createElement(nC.t,null,N.createElement(N.Suspense,{fallback:N.createElement("div",null,he.loadingMessage())},r?N.createElement(s,{...Zr}):N.createElement(t,{workflowType:"blogpost",userQuery:e,alSession:Ws.current,shouldLimitSuggestedFiles:i})))}}),!0}return!1})(e))return;let S;KQ=Wi(),b(KQ),XQ++,w(XQ),YQ=(new Date).getTime(),t(YQ),Ee(),(0,QC.UU)(Ze),kt(""),Yi(),Ji({telemetryData:s}),Ki({text:e,telemetryData:s}),Go(!1),qi&&Mt(-1),Xi(),(0,QC.xU)(Pe,i,h),Qt((e=>je?.clearLoadingMessagesOnHandleSubmit?{...e,loadingUiStringList:he.defaultLoadingUiStrings,showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1}:{...e,showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})),M.updateCopilotState(Tf.SG.QUERY_ENTERED),M.sendEventToClient(Tf.PV.QuerySubmitted),qi&&es&&(S=Ut?.current?.getLatestText(),(async()=>{if(es){const e=je?.isSideQuestMarkdownEnabled||je?.isSideQuestStreamingEnabled?await(Ut?.current?.getLatestMarkdown()):(e=>{let t=e;return t=t.replace(/<ol[^>]*>(.*?)<\/ol>/gims,((e,t)=>{let n=1;return t.replace(/<li[^>]*>(.*?)<\/li>/gims,((e,t)=>`\n${n++}. ${t}`))})),t=t.replace(/<span>(.*?)<\/span>/g,"$1"),[{regex:/<h3[^>]*>(?:<span[^>]*>)?(.*?)(?:<\/span>)?<\/h3>/gim,replacement:"\n### $1"},{regex:/<h2[^>]*>(?:<span[^>]*>)?(.*?)(?:<\/span>)?<\/h2>/gim,replacement:"\n## $1"},{regex:/<h1[^>]*>(?:<span[^>]*>)?(.*?)(?:<\/span>)?<\/h1>/gim,replacement:"\n# $1"},{regex:/<b[^>]*>(.*?)<\/b>/gim,replacement:"**$1**"},{regex:/<i[^>]*>(.*?)<\/i>/gim,replacement:"*$1*"},{regex:/<a[^>]*href="(.*?)"[^>]*>(?:<span[^>]*>)?(.*?)(?:<\/span>)?<\/a>/gim,replacement:"[$2]($1)"},{regex:/<br>/gim,replacement:"\n\n"},{regex:/<br[^>]*>/gim,replacement:"\n"},{regex:/<div[^>]*class="scriptor-paragraph"[^>]*>/gim,replacement:"\n"},{regex:/<\/?div[^>]*>/gim,replacement:""},{regex:/<!--.*?-->/gim,replacement:""},{regex:/<li[^>]*>(.*?)<\/li>/gim,replacement:"\n- $1"},{regex:/<\/?ul[^>]*>/gim,replacement:""},{regex:/<\/?ol[^>]*>/gim,replacement:""},{regex:/<style[^>]*>[\s\S]*?<\/style>/gim,replacement:""}].forEach((({regex:e,replacement:n})=>{t=t.replace(e,n)})),t=t.replace(/\n+/g,(e=>e+"\n")),t.trim()})(Ut?.current?.getLatestHtml()??""),t=Ut?.current?.getLatestText();e&&Ze(-1!==Dt?n=>{const r=[...n],s=r[Dt];s.body.message=e;const i=s.body.message!==s.body.originalMessage;return s.body.showEditedView=i,uS(t??"",r[Dt],je,Cs,Ts),r}:n=>{const r=[...n],s=cS(r,"chat");if(s){const n=s.chatCardIndex??r.length-1,i=r[n];i.body.message=e;const a=i.body.message!==i.body.originalMessage;i.body.showEditedView=a,uS(t??"",r[n],je,Cs,Ts)}return r})}})(),Ft.logSideQuestEvent(Pf.a5.SideQuestQuerySubmitted)),un(!0),le?.voiceInputProps&&Mi(!1);const E=e?e.trim():Si().trim();JQ=E,C(JQ);const I=d??Ii();Ei(he.chatPlaceholderMessage()),xi();const A=Je.current?.getRawCanvasSelections?.();Je.current?.removeSelectionAttachments(),c&&u(!1),(0,qf.cY)(`User query Entered : ${E}`),bi(Df.u1),Jt(!1),$t(!1),g(!0);let P=!0===je.isChatHistorySignalDeferred;const k=[];try{await ea({messageText:E,messageImages:I,links:r,entityList:h,setChatMessage:yi,storedChatHistoryData:k,isHidden:p});let e=!1;e=await Qi({userQueryGuid:KQ});const t=await M.shouldSendRequestToAugloop(E,r,i,KQ);if(Pe.sendTelemetryLatencyData([{key:Pf.CT.SendRequestToALCheckTime,value:(0,Vf.xJ)(YQ)}]),!t)return Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.QuerySubmissionToAugloopAborted}]),void g(!1);if(E===he.changeTopicButtonText()&&!R.changeTopicUiProps?.hideChangeTopicButton)return void await Gi(y);try{Ss||await ks(ti,rt,oo(),io(),J?.shouldClearChatHistory,J?.currentSelectedGPTId,ki,Pl?.(),Eo,R?.interactiveCardProps?.contentProviders);let t=M.isFeatureGateEnabledFromClient(Af.WT.IsCopilotPluginEnabled)?hs.getEnabledPlugins():[];je.isModelSelectorEnabled&&(t=[...t,{id:"Model",source:Vt.current}],(0,qf.cY)("Selected Model: ",Vt.current),(0,qf.cY)("Plugin Info on query submit: ",t));let n=m??J?.currentSelectedGPTId;m||n||x||!ue?.buttonProps?.analyzeDataButtonEnabled||!ee||(n=ee?.id);const s=m??x?.appId??J?.currentSelectedGPTId??n??"";ay.k.getInstance().addQueryIdToMap(KQ,s,Yr?.getAgentInfo(s)?.metaOSTitleId,e),m&&Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ActionAgentIdSubmitted},{key:Pf.h3.ChatEventParameters,value:`actionAgentId: ${m} , userQueryGuid: ${KQ}, gptIdToSendWithSignal: ${n}, atMentionApp: ${x?.appId}`}]);const c=v??ra();(0,qf.cY)("Final settings for audio cast:",c),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AudioCastSettings},{key:Pf.h3.ChatEventParameters,value:JSON.stringify({audioCastSettings:c,isRegenerateQuery:!!v})},{key:Pf.h3.UserQueryGuid,value:KQ}]),qQ.S.getInstance().updateSettingsForQueryId(KQ,c);const u=await ia({userQueryGuid:KQ}),d=u||await M.getDefaultSignalOperation(E,KQ,iy.c.currentChatId,r,i,t,I,n,m?void 0:x,l,!1,void 0,A,void 0,S,re?.groundingState,f,c);if(d.operation.parentPath.length>1&&"Signal"==d.operation.parentPath[0]&&Ja.updateInputSignalInFluxHandler(d.operation.parentPath[1]),Pe.sendTelemetryLatencyData([{key:Pf.CT.SignalReceivedFromClientTime,value:(0,Vf.xJ)(YQ)}]),(0,pb.RJ)(!1,pe),je.isAugloopResponseTimeoutRequiredCheckEnabled?!Mf.A.getInstance(pe).isAugloopResponseTimeoutRequired(d.workflowAnnotationType)||je.isALHookEnabled&&je.isALRequestResponseEnabled||wf._.getInstance(pe).setAugloopResponseTimer(d.workflowAnnotationType):je.isALHookEnabled&&je.isALRequestResponseEnabled||wf._.getInstance(pe).setAugloopResponseTimer(d.workflowAnnotationType),je.isALHookEnabled)je.isALRequestResponseEnabled?(Ir.current=new bf.XO,Cs(d.operation,d.workflowAnnotationType,!1,Ir.current)):Cs(d.operation,d.workflowAnnotationType);else{const e=e=>{Sa({chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:Af.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{feedbackSectionPosition:o.O.Footer,showAnimation:!0,isFailure:!1},stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!1}),wf._.getInstance(pe).clearAugloopResponseTimer()},t=e=>{Ta({loadingUiStringList:[e]})};await async function(e){return await Xx(e)||await HQ(e)}({signalOperationData:d,messageText:E,cuaTokenProvider:ji,setIsExecuting:g,addResponse:e,updateMessage:t,shouldRunMCPAgent:He,featureFlags:je,executeOfficeJSCodeForChatInput:ie,orbisProps:ae})||Cf.E.getInstance(pe).submitOperation(d.operation,d.workflowAnnotationType)}Pe.sendTelemetryLatencyData([{key:Pf.CT.SignalSubmitTime,value:(0,Vf.xJ)(YQ)}]),M.updateCopilotState(Tf.SG.QUERY_SUBMITTED),G.current=!0,(0,qf.cY)("successfully submitted operation to AL : \n\n\n"+JSON.stringify(d.operation)+"\nat Time : "+new Date+"\n\n\n"),P&&(vi(k),P=!1)}catch(e){Zi({exception:e,setChatMessage:yi,querySubmitTime:YQ})}}finally{P&&vi(k),oa.current=void 0}}),[Ss,J,x,hs,Qi,Gi,R,c,Ki,Cs,ee,es,pe,re?.groundingState]);qQ.S.initialize(sa),GQ._.initialize(zs);const{getOperationForIntent:ia,updateIsPaneVisibleForIntentHandling:aa,currentIntentPropsInExecution:oa}=(({handleSubmit:e,isChatHistoryLoading:t,isAnnotationActivated:n,copilotCommunicationHandler:r,copilotChatIntentProps:s,switcherMenuProps:i})=>{const a=(0,it.kQ)({podcastIntentPrompt:_f.RR,summaryIntentPrompt:_f.z_}),o=r?.getPreloadSignal?.(XC.U.ShowPane),[l,c]=N.useState(!o),u=N.useRef(void 0),d=(0,Ot.Y$)(),h=N.useCallback((e=>{c(e)}),[c]),{executedIntentIdList:p}=(0,Xn.zK)(),g=N.useCallback((()=>{if(s)return s.find((e=>void 0!==e.intentId&&null!==e.intentId&&!p.current.includes(e.intentId)))}),[s,p]),m=N.useCallback((()=>{const e=u.current;if(!e)return"";switch(e?.intentType){case CS.Podcast:return a.podcastIntentPrompt();case CS.Summary:return a.summaryIntentPrompt();default:return""}}),[a]),f=N.useCallback((async({userQueryGuid:e})=>{const t=u.current,n={isStreamingRequired:!0,mode:wS.f9.Podcast,files:[{fileUrl:await(r.getHostSettings().getDocumentUrlAsync?.())??""}],voiceIds:QC.CZ,voiceNames:QC.pm,clientConfiguration:(0,QC.jG)(),requiredOutputs:[wS.rS.Audio]},s=t?.intentData?.audioCastPayload??n,i=new SS.B({query:"",queryId:e,audioCastPayload:s});return{operation:new cv.g0({parentPath:["Signal",SS.B.getTypeName()],items:[{id:uv.r.generateId(),body:i}]}),workflowAnnotationType:t?.intentData?.workFlowAnnotationType??gw.q.getTypeName()}}),[r]);N.useEffect((()=>{const r=g();!t&&n&&(l||d.isFocusChatInputOnMount)&&s&&r&&(void 0===i?.currentSelectedGPTId&&void 0===r.intentTargetAgentId||r.intentTargetAgentId===i?.currentSelectedGPTId)&&(p.current.push(r.intentId),u.current=r,e({text:r.intentData?.intentPrompt??m(),telemetryData:Pf.a5.QuerySubmitDueToIntent}))}),[n,t,i?.currentSelectedGPTId,g,l,s,e,m,p,d.isFocusChatInputOnMount]);const y=N.useCallback((()=>{const e=u.current;if(!e)return!0;if(!1===e?.intentData?.shouldSubmitOperation)return!0;switch(e?.intentType){case CS.Podcast:return!1;case CS.Summary:default:return!(e?.intentData?.shouldSubmitOperation&&void 0!==e?.intentData?.operationDataForIntent)}}),[]),v=N.useCallback((async({userQueryGuid:e})=>{const t=u.current;if(t)return t?.intentData?.operationDataForIntent?t?.intentData?.operationDataForIntent:t?.intentType===CS.Podcast?f({userQueryGuid:e}):void 0}),[f]),b=N.useCallback((async({userQueryGuid:e})=>{const t=u.current;return y()?void 0:t?.intentData?.operationDataForIntent??await v({userQueryGuid:e})}),[v,y]);return{shouldRequestClientOperation:y,getOperationForIntent:b,updateIsPaneVisibleForIntentHandling:h,currentIntentPropsInExecution:u}})({isChatHistoryLoading:mt,isAnnotationActivated:Ss,copilotChatIntentProps:R.copilotChatIntentProps,copilotCommunicationHandler:M,handleSubmit:sa,switcherMenuProps:J}),ca=N.useCallback((e=>{F?.imageInsertionHandler&&je?.isInsertImageEnabledForDAs&&F.imageInsertionHandler(e)}),[]),ua=N.useMemo((()=>M.isFeatureGateEnabledFromClient(Af.WT.EnableMsgExtCardTelemetry)?new Xb.$(pe):void 0),[M]),da=Gw.getInstance(pe),ha=N.useMemo((()=>M.isFeatureGateEnabledFromClient(Af.WT.EnableCopilotExtTelemetry)?new uw.U(pe):void 0),[M]),pa=rs||(je.showPluginsAsAgents??!1)||(je.isApiPluginsCardsEnabled??!1),ga=_E.getInstance(pe),{copilotAgentServices:ma,externalAuthService:fa,hubSdk:ya}=xE({pluginConfigService:ds,arePluginServicesRequired:pa,handleSubmitPrompt:sa,copilotThemeInfo:Bs,extTelemetryServiceV2:ga,clientInfo:Dr,hostTokenProviders:Y,taskModuleLauncher:Ae}),va=N.useMemo((()=>ma?{appService:ma.appService,channelService:ma.channelService,pluginConfigService:ds,authService:ma.tokenService,externalAuthService:fa,telemetryService:ua}:null),[ma,fa,ua,ds]),Ca=(({copilotCommunicationHandler:e,pluginDataProvider:t,selectedSwitcherMenuItemId:n,atMentionApp:r,setIsExecuting:s,updateUserQueryGuid:i,canvasSelection:a,groundingState:o})=>{const{submitOperation:l}=(0,sy.G)(),c=(0,ry.D)(),u=(0,Ot.Y$)(),d=(0,Xn.zK)(),h=(0,N.useCallback)((async h=>{try{const p=e.isFeatureGateEnabledFromClient(Af.WT.IsCopilotPluginEnabled)?t.getEnabledPlugins():[],g=(0,bo.A)();ay.k.getInstance().addQueryIdToMap(g,n??r?.appId,d?.getAgentInfo(n??r?.appId??"")?.metaOSTitleId,!!a&&a.length>0&&"[]"!==a),i(g);const m=await e.getDefaultSignalOperation("confirmation response",g,iy.c.currentChatId??void 0,void 0,void 0,p,void 0,n,r,void 0,void 0,h,a,void 0,void 0,o),{operation:f,workflowAnnotationType:y}=m;u.isALHookEnabled&&u.isALRequestResponseEnabled||wf._.getInstance(c).setAugloopResponseTimer(y),u.isALHookEnabled?l(f,y):Cf.E.getInstance(c).submitOperation(f,y),e.updateCopilotState(Tf.SG.QUERY_SUBMITTED),s(!0)}catch(t){throw e.updateCopilotState(Tf.SG.QUERY_SUBMITTED_FAILED),u.isALHookEnabled&&u.isALRequestResponseEnabled||wf._.getInstance(c).clearAugloopResponseTimer(),(0,qf.cY)("CopilotChat Log: Exception:"+JSON.stringify(t)),t}}),[r,e,n,t,s,a,l]);return h})({copilotCommunicationHandler:M,pluginDataProvider:hs,setIsExecuting:g,selectedSwitcherMenuItemId:J?.currentSelectedGPTId??Er?.selectedGptId,atMentionApp:x??Er?.atMentionApp,updateUserQueryGuid:b,canvasSelection:Er?.persistedCanvasContext,groundingState:re?.groundingState}),wa=YC(M,Ca,Ze),{addResponseMessage:Sa,updateMessage:xa,resendChatHistorySignal:Ia,updateLastMessage:Aa,deleteMessage:Pa,submitOperation:ka,updateLoadingComponentProps:Ta,addChatMessages:Da,clearMessages:Ma,hasMessage:La,startLoadingUi:Ra,startReinitializeALSession:Na,setInputAreaText:Oa,setInputFocus:_a,getInputText:Ba,submitUserQuery:Fa,getIsExecuting:Ua,executePluginOperation:Ha,executeClientSkillFromInterstitialMessage:za,updateDraftForEntity:ja,scrollToBottomRefImplementation:Va,updateAttachmentList:qa,startNewChat:Wa,switchAtMention:Qa,updateChatSessionId:Ga,updateExecutionStatusForAddInActions:Za,fetchDebugLogs:Ya}=(({setIsExecuting:e,setLoadingComponentProps:t,handleSubmit:n,chatContainerBuilder:r,chatInputRef:s,setShouldReinitializeALSession:i,isDisabled:a,pluginServices:o,messagesEndRef:l,isExecuting:c,chatHistoryTelemetryHooks:u,suggestionPillsBuilderRef:d,copilotCommunicationHandler:h,setCachedSuggestionPillList:p,currentGptId:g,skillExecutor:m,setAtMentionApp:f,setAddinExecutionName:y})=>{const v=(0,ry.D)(),b=Hf(),C=(0,Ot.Y$)(),{submitOperation:w,clearOperationListForResubmit:S}=(0,sy.G)(),E=(0,An.Mb)(),x=N.useCallback((({chatCardType:t,chatMessageData:n,chatMessageBodyData:s,stopLoadingUi:i=!0,startAugloopTimerForStreaming:a=!1,workflowAnnotationTypeForAugloopTimer:o,addCardToChatHistory:l=!0})=>{if(!n)throw new Error("chatMessageData is null or undefined. set chatMessageData to add response message");jf.U.getInstance(v,r,h,e),r.setChatMessageData(t,n,s,l),a&&(C.isALHookEnabled&&C.isALRequestResponseEnabled||wf._.getInstance(v).setAugloopResponseTimer(o)),i&&e(!1)}),[e]),I=N.useCallback((({chatCardType:t,chatMessageData:n,chatMessageBodyData:s,stopLoadingUi:i=!1,startAugloopTimerForStreaming:a=!1,workflowAnnotationTypeForAugloopTimer:o,addCardToChatHistory:l=!0})=>{r.updateLastMessage(t,n,s,l),a&&(C.isALHookEnabled&&C.isALRequestResponseEnabled||wf._.getInstance(v).setAugloopResponseTimer(o)),i&&e(!1)}),[e,r]),A=N.useCallback((({chatCardType:t,chatMessageData:n,chatMessageBodyData:s,stopLoadingUi:i=!1,startAugloopTimerForStreaming:a=!1,workflowAnnotationTypeForAugloopTimer:o,addCardToChatHistory:l=!0})=>{s?.messageId?(r.updateMessage(t,n,s,l),a&&(C.isALHookEnabled&&C.isALRequestResponseEnabled||wf._.getInstance(v).setAugloopResponseTimer(o)),i&&e(!1)):((0,qf.cY)("updateMessage: messageId is missing in chatMessageBodyData"),x({chatCardType:t,chatMessageData:n,chatMessageBodyData:s,stopLoadingUi:i,startAugloopTimerForStreaming:a,workflowAnnotationTypeForAugloopTimer:o,addCardToChatHistory:l}))}),[e]),P=N.useCallback((e=>{t((t=>({...t,...e})))}),[t]),k=N.useCallback(((t,n=!0)=>{r.addChatMessages(t),n&&e(!1)}),[e]),T=N.useCallback((()=>{e(!0)}),[e]),D=N.useCallback((()=>{i(!0)}),[i]),M=()=>s.current?.getChatEditorService?s.current?.getChatEditorService():void 0,L=N.useCallback((({text:e,links:t,telemetryData:r,queryAnnotations:i,invokeActionConfirmation:o,isHidden:l=!1,requestMetaData:u})=>{(0,qf.cY)("submitUserQuery called for query: ",e),c||a?(0,qf.cY)(`Returning from submitting Query because isExecuting is: ${c} and isDisabled is: ${a}`):(n({text:e,links:t,telemetryData:r,queryAnnotations:i,invokeActionConfirmation:o,isHidden:l,requestMetaData:u}),s.current?.setInputText(Df.u1))}),[s,n,a,c]),R=N.useCallback((()=>{(0,qf.cY)("setInputFocus"),a||s.current?.setFocus()}),[s,a]),O=N.useCallback((()=>{l?.current?.scrollIntoView({behavior:"smooth",block:"end"})}),[l]),_=N.useCallback((()=>c),[c]),B=N.useCallback((async(e,t,n)=>{try{if(!o)throw new Error("Plugin services are not available");return await(0,ty.j)(o,e,t,n,E.hostAppSettings.window)}catch(e){throw(0,qf.cY)("Error executing plugin operation",e),e}}),[o]),F=N.useCallback((async({chatMessageData:t,stopLoadingUi:n=!0})=>{try{if(!t)throw new Error("chatMessageData is null or undefined. set chatMessageData to add response message");const r=(t?.interstitialMessageProps?.interstitialMessages.filter((e=>e.messageType?.toString()==Jf.TriggerPlugin))[0]).pluginInfo.data.PluginName;let s;if(t.interstitialMessageProps?.skillRequests&&t.interstitialMessageProps?.skillRequests?.length>0&&m?.executeRequests){const i=t.interstitialMessageProps?.skillRequests;y&&y(r),s=await(m?.executeRequests(i)),n&&e(!1)}else{if(!t.interstitialMessageProps?.skillRequest)throw new Error("skillRequest is null or empty. set skillRequest to execute client skill");{const i=t.interstitialMessageProps?.skillRequest;y&&y(r),s=await(m?.execute(i)),n&&e(!1)}}if((0,qf.cY)("executeClientSkillFromInterstitialMessage response",s),500===s?.statusCode)throw new Error(s.payload.data)}catch(t){throw e(!1),(0,qf.cY)("Error executing client skill from interstitial message",t),t}}),[e,m]),U=N.useCallback((async()=>{u.setActionStart(Pf.a5.ChatHistoryStartNewChatCalled),(0,qf.cY)("Change Topic Button Clicked."),d.current?.setSuggestedQnAList([]),p([]),(0,ny.$m)(!0),t((e=>({...e,loadingUiStringList:[b[1]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1}))),h.sendEventToClient(Tf.PV.StartNewChatCalled);const n={gptId:g};await(0,Sf.a_)({op:gf.S5.AddChatOperation,gptInfo:n}),e(!0)}),[u,d,p,t,g,e,b]),H=(0,Xn.zK)(),z=N.useCallback((e=>{if(C.isAgentPromptHandoffToAugloopEnabled){const t=(H?.getDeclarativeAgentsList?.()??[]).find((t=>t.id==e));t&&t.copilotType==Xf.NV.CustomGPT&&f?.({appId:t.id,appType:pf.b.GPT,title:t.name,iconUrl:t.menuIconUrl})}}),[f,H]),j=N.useCallback((e=>{iy.c.chatSessionId=e??iy.c.chatSessionId}),[]),V=N.useCallback((e=>{ay.k.getInstance().setIsLocalAddinFlowExecuting(e)}),[]);return{addResponseMessage:x,updateMessage:A,resendChatHistorySignal:(e,t)=>{C.isALHookEnabled?(0,ey.Vq)(e,t,w,S,v):(0,ey.Vq)(e,t,void 0,void 0,v)},updateLastMessage:I,deleteMessage:({chatCardType:e,messageIdToDelete:t})=>{r.deleteMessage(e,t)},submitOperation:(e,t=!1)=>{const{operation:n,workflowAnnotationType:r}=e;return!t&&Mf.A.getInstance(v).isWorkflowRegistered(r)&&Mf.A.getInstance(v).isAugloopResponseTimeoutRequired(r)&&(C.isALHookEnabled&&C.isALRequestResponseEnabled||wf._.getInstance(v).setAugloopResponseTimer(r)),(0,qf.cY)("operation submitted",n),C.isALHookEnabled?w(n,r):Cf.E.getInstance(v).submitOperation(n,r),!0},updateLoadingComponentProps:P,addChatMessages:k,clearMessages:()=>{r.clearMessages()},hasMessage:e=>r.hasMessage(e),startLoadingUi:T,startReinitializeALSession:D,setInputAreaText:e=>{(0,qf.cY)("setInputAreaText",e);let t=e;const{inputSpanText:n,isFileEntityPresent:r}=(0,qf.a9)(e);t=n,(0,qf.cY)(`inputSpanText: ${n}, isFileEntityPresent:`,r),n.endsWith(Df.Gr)&&(t=n.slice(0,-Df.Gr.length)+" "),s.current?.setInputText(t),s.current?.setFocus();const i=E.hostAppSettings.window??window;r&&M()&&(M()?.setEntityScope($f.ck.File),i.setTimeout((()=>s.current?.updateInputText(Df.O8,Zf.v.InsertAtCursor)),1))},setInputFocus:R,getInputText:()=>s.current?.getInputText()??"",submitUserQuery:L,getIsExecuting:_,executePluginOperation:B,executeClientSkillFromInterstitialMessage:F,updateDraftForEntity:e=>{s.current?.updateDraftForEntity(e)},scrollToBottomRefImplementation:O,updateAttachmentList:e=>{s.current?.updateAttachmentList(e)},startNewChat:U,switchAtMention:z,updateChatSessionId:j,updateExecutionStatusForAddInActions:V,fetchDebugLogs:()=>oy.J.getInstance()?.getLogs()??""}})({setIsExecuting:g,setLoadingComponentProps:Qt,handleSubmit:sa,chatContainerBuilder:zs,chatInputRef:Je,setShouldReinitializeALSession:Ps,isDisabled:d,pluginServices:va,messagesEndRef:Xe,isExecuting:p,chatHistoryTelemetryHooks:vr,suggestionPillsBuilderRef:Tr,copilotCommunicationHandler:M,setCachedSuggestionPillList:hn,currentGptId:J?.currentSelectedGPTId,skillExecutor:wa,setAtMentionApp:E,setAddinExecutionName:kt}),Ka={copilotCommunicationHandler:M,responseHandlerParams:{addResponseMessage:Sa,updateMessage:xa,updateLastMessage:Aa,deleteMessage:Pa,updateLoadingComponentProps:Ta,getLastMessage:fi},fluxServiceContainer:vS(zs,M,_,je)},Ja=Xy(Ka);N.useEffect((()=>{Tr.current=new Gf(Je,sa,le?.chatPlaceholderMessage??"",yi,hn,gi(),M,je,pe)}),[sa]),(0,N.useEffect)((()=>{zi.current.updateChatInputRef(k.current)}),[k]),(0,N.useEffect)((()=>{zi.current.updateSetInputAreaTextRef(Oa)}),[Oa]),(0,N.useEffect)((()=>{xe.userPrincipalName&&zi.current.updateAccountInfo({accountUpn:xe.userPrincipalName})}),[xe.userPrincipalName]);const Xa=e=>{Zt(Hr.getProps(e)),Jt(Hr.shouldShowHintCard(e))},$a=()=>{io()?je?.isCustomGPTsEnabled&&je?.enableQueryEndOnGptSwitch&&Sr?.current||Ye():M.sendEventToClient(Tf.PV.ChatTopicChanged),y(!1),J?.setShouldClearChatHistory(!1),Sr?.current||g(!1),Sr.current=!1},eo=N.useCallback(((e,t)=>{t?(lr(!0),ur([])):e.length>0?ur((t=>[...t,...e])):gr(!0),ar(!1),hr(!1)}),[]),to=N.useCallback((e=>{e&&Ze((t=>e(t))),g(!1),fr.current=!1}),[]),no=N.useCallback(((e=!1)=>{e&&!d?q(!0):H(!1),yr.current=!0}),[d]),ro=N.useCallback((e=>(t=!1,n)=>{e?.onPaneClose?.(n)}),[]),so=N.useCallback((()=>{(0,Sf.g_)(),(0,Sf.a_)({op:gf.S5.GetAllChatsOperation,gptInfo:{isGptsEnabled:lo()},submitOperation:je.isALHookEnabled?Cs:void 0,clearOperationListForResubmit:je.isALHookEnabled?Ts:void 0,componentId:pe}),ar(!0),ur([]),gr(!1),hr(!1),ao()||H(!0),vr.logChatHistoryActionEvent(Pf.a5.ShowChatHistoryButtonClicked),vr.setActionStart(Pf.a5.LoadChatHistoryPanel)}),[Cs]),io=N.useCallback((()=>R.chatHistoryUiProps?.enableChatHistoryV2),[R]),ao=N.useCallback((()=>F?.paneSilhouetteHeaderProps?.enableChatHistory&&io()),[R]),oo=N.useCallback((()=>R.chatHistoryUiProps?.enableChatHistoryLocalStorage),[R]),lo=N.useCallback((()=>R.chatHistoryUiProps?.isGptsEnabled),[R]),co=N.useCallback((()=>R.chatHistoryUiProps?.shouldShowDeprecationMessage),[R]);(0,N.useEffect)((()=>{if(vr.isMeasuring&&vr.measureTarget.current&&!p&&!U)switch(vr.measureTarget.current){case Pf.a5.ChatHistoryNewConversationButtonClicked:vr.logChatHistoryActionLatency(Pf.a5.ChatHistoryNewConversationButtonClicked);break;case Pf.a5.ChatHistoryBackButtonClicked:vr.logChatHistoryActionLatency(Pf.a5.ChatHistoryBackButtonClicked);break;case Pf.a5.ChatHistoryConversationClicked:vr.logChatHistoryActionLatency(Pf.a5.ChatHistoryConversationClicked);break;case Pf.a5.ChatHistoryStartNewChatCalled:vr.logChatHistoryActionLatency(Pf.a5.ChatHistoryNewConversationButtonClicked)}}),[U,vr]);const uo=N.useCallback((()=>F?.paneSilhouetteHeaderProps),[R]),ho=((e,t,n,r,s,i,a,o,l,c,u)=>{const d=(0,ry.D)();if(!e)return()=>{};const h=e=>{(0,pb.P1)(!0),r?.isQueryWarmupSignalEnabledOnChatPaneOpens&&r?.isFocusChatInputOnMount&&n();const s=e.pluginsInfo.findIndex((e=>e&&e.id===Af.un.ENTERPRISE_SEARCH&&e.state===Df.hi))>=0,i=e.pluginsInfo.findIndex((e=>e&&e.id===Af.un.WEB_SEARCH&&e.state===Df.hi&&e.isEnabled))>=0;(0,pb.g8)(s,i),t.sendEventToClient(Tf.PV.PluginsStateUpdated,e)};return async()=>{const e=(new Date).getTime();let n;if(t.isFeatureGateEnabledFromClient(Af.WT.IsPersistanceInPhase2UxEnabled))n=await bS(s,a,h,o,r.defaultEnableEnterpriseGrounding||t.isFeatureGateEnabledFromClient(Af.WT.IsEnterpriseSearchDefaultOn),l,d),i.sendTelemetryLatencyData([{key:Pf.CT.PluginsConfig3SFetchTime,value:(0,Vf.WU)(e)}]),(0,qf.cY)("resolved plugins initial state using copilot brokering WF annotations");else{const e=s?.find((e=>e.id===dC.$.Web));e&&o&&(e.onToggle(!0,!0),l?.setWebSearchState(!1,o),(0,pb.gE)(`${e.id}:AutoOn`,d))}c(a.getRestrictedSearchMode()===Df.hD||t.isFeatureGateEnabledFromClient(Af.WT.ShowRestrictiveSearchBanner)),u(n)}})((ue?.buttonProps?.groundingButtonEnabled||F?.paneSilhouetteHeaderProps?.enableSettingsPanel)??!1,M,ki,je,qe,Pe,hs,ss,re,At,vn),po=e=>{Jb.w.getInstance().setAuthMessageStatus(`ClaimsChallengeCallbackCalled-${e.claims}`),ii(),ai(!0)},go=e=>{Jb.w.getInstance().setAuthMessageStatus(eC.f[e]),ii(),e===eC.f.TokenMissingInteractionRequired&&((0,qf.cY)("serverAuthenticationStateChangeCallback: ServerAuthenticationState is TokenMissingInteractionRequired"),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AuthMessageReceived},{key:Pf.h3.ChatEventParameters,value:"TokenMissingInteractionRequired"},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()}]),ai(!1))},mo=async()=>{ZQ=(new Date).getTime(),je.isClaimsChallengeCallbackEnabled&&fs?.setClaimsChallengeCallback(po),je.isServerAuthenticationStateChangeEnabled&&fs?.setServerAuthenticationStateChangeCallback(go),Ef.P.getInstance(pe,ft,sr,Ln),je.isALHookEnabled?((0,qf.cY)("AL Hook is enabled"),wf._.getInstance(pe).initialize(M,wi,Ln,Ts)):(Cf.E.getInstance(pe).initialize(zs,M,fs,g,p,As,he.licenseValidationErrorMessageString(),je,pe),wf._.getInstance(pe).initialize(M,wi,Ln)),jf.U.getInstance(pe,zs,M,g),jf.U.getInstance(pe).setBasicChatProps(O);try{Ds(Co,wo)}catch(e){(0,qf.cY)("Failure in setting AugloopResponseHandler: "+JSON.stringify(e)+" Error message: "+e.message),Pe.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:"Failure in setting AugloopResponseHandler: "+e.message},{key:Pf.IC.ErrorType,value:Pf.q0.Client},{key:Pf.IC.ErrorCode,value:Af.O4.AugloopResponseHandlerInitializationError},{key:Pf.IC.ErrorCategory,value:kf.S2.Augloop}])}try{if(await ks(ti,rt,oo(),io(),J?.shouldClearChatHistory,J?.currentSelectedGPTId,ki,Pl?.(),Eo,R?.interactiveCardProps?.contentProviders),je.isALHookEnabled&&je.isALRequestResponseEnabled&&fs){const e=R?.interactiveCardProps?.contentProviders;let t;e&&(t=(e=>{let t;return e?.forEach((e=>{Nt.E.QNA===e?.tabType&&(t=e?.setQueryMetadata)})),t})(e)),Ms(J?.currentSelectedGPTId,t)}!fe&&fs&&await No(fs)}catch(e){throw(0,qf.cY)("Failure in Augloop Initialization: "+JSON.stringify(e)+" Error message: "+e.message),Pe.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:"Failure in Augloop Initialization: "+e.message},{key:Pf.IC.ErrorType,value:Pf.q0.Client},{key:Pf.IC.ErrorCode,value:Af.O4.AugloopInitializationError},{key:Pf.IC.ErrorCategory,value:kf.S2.Augloop}]),e}};function fo(e){if("InputQueryError"===e?.error?.category){let t;try{t=JSON.parse(e.error?.json)?.code}catch(e){(0,qf.cY)("Error parsing error code error",e.message)}return t===Af.O4.InteractionRequiredError}return!1}function yo(e){if("LicensingError"===e?.error?.category)try{const t=JSON.parse(e.error?.json)?.reason;return t===Af.O4.MissingServicePlanBYOA}catch(e){(0,qf.cY)("Error parsing error code error",e.message)}return!1}async function Co(e,t=Df.u1){(0,qf.cY)("sharedAugloopAnnotationItemsHandler items: ",e),(0,qf.cY)("sharedAugloopAnnotationItemsHandler cv: ",t);for(const n of e){if((0,tC.ei)(n.body,mr),je.isMissingServicePlanBYOAErrorEnabled&&yo(n.body)){Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AuthMessageReceived},{key:Pf.h3.ChatEventParameters,value:"MissingServicePlanBYOAError"},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()}]),li(),!M.shouldClearAugloopResponseTimer(n)||je.isALHookEnabled&&je.isALRequestResponseEnabled||wf._.getInstance(pe).clearAugloopResponseTimer();continue}if(je.isClaimsChallengeMessageInAnnotationEnabled&&fo(n.body)){Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AuthMessageReceived},{key:Pf.h3.ChatEventParameters,value:"ClaimsChallengeMessageInAnnotationCalled"},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()}]),ai(!0),!M.shouldClearAugloopResponseTimer(n)||je.isALHookEnabled&&je.isALRequestResponseEnabled||wf._.getInstance(pe).clearAugloopResponseTimer();continue}const e=n.body?.H_;e?.T_&&Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ALAnnotationReceived},{key:Pf.h3.ChatEventParameters,value:e?.T_},{key:Pf.h3.Cv,value:t},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()}]);const r=Mf.A.getInstance(pe).getFluxAnnotationTypeName();if(r&&e?.T_===r){if(await M.shouldIgnoreResponse(n))return;if(!Ja.isQueryIdInSharedProcessingList(n)){await M.shouldForwardResponseToClient(n)?M.forwardResponseToClient(n,t):Ja.addQueryIdInSharedProcessingList(n)}await Ja.fluxAugloopResponseProcessor(n,t)}else switch(e?.T_){case mf.CT.getTypeName():case mf.tP.getTypeName():case mf.Pd.getTypeName():(0,Sf.UC)(n,Ze,ut.current,M,pe,ny.vD||J?.shouldClearChatHistory?$a:void 0,eo,fr.current?to:void 0,io(),t,je,ki,Sr,je.isALHookEnabled?Cs:void 0);break;case yf.Ob.getTypeName():if(await M.shouldIgnoreResponse(n))return;await Vs(n,YQ,t);break;case yf.KJ.getTypeName():if(await M.shouldIgnoreResponse(n))return;await js(n,YQ,t);break;case yf.pK.getTypeName():if(await M.shouldIgnoreResponse(n))return;await sv(pe,n,Tr.current,rl,fl,R?.interactiveCardProps?.contentProviders,t,je);break;case av.x.getTypeName():await(0,ov.M)(n,Tt,je,t,J?.currentSelectedGPTId??Df.ID,pe,de.hostAppSettings.environment);break;case vf.L.getTypeName():await ms(n,Ci,t);break;case ff.BN.getTypeName():{const e=n.body;ds.onOperationResponse(e.queryId,e.operationResponse);break}case gb.Ml.getTypeName():await ps();break;case oC.d.getTypeName():await(0,aC.h)(n,Hn,jn,pe);break;case cw.TR.getTypeName():await Fn(n,(()=>Yr?.creditUIContext?.setShowCreditsTeachingCallout(!0)));break;case pw.H6.getTypeName():(0,qf.cY)("OfficeaiIncubationAppAnnotation received: ",n),je.isComprehensionViewEnabled?await Ys(n,t):await qs(n,t);break;case gw.q.getTypeName():if(await M.shouldIgnoreResponse(n))return;je.isPodcastV2Enabled?If.q.isPodcastHistoryRequest?(If.q.isPodcastHistoryRequest=!1,await Qs(n,YQ,t,If.q.podcastHistoryResponseMessageId,R?.documentSensitivityProps)):await Qs(n,YQ,t,void 0,R?.documentSensitivityProps):await Gs(n,YQ,t);break}}}async function wo(e,t=Df.u1,n){(0,qf.cY)("clientSpecificAugloopAnnotationItemsHandler items: ",e),(0,qf.cY)("clientSpecificAugloopAnnotationItemsHandler cv: ",t);for(const r of e){const e=r.body?.H_;if(je.isMissingServicePlanBYOAErrorEnabled&&yo(r.body))Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AuthMessageReceived},{key:Pf.h3.ChatEventParameters,value:"MissingServicePlanBYOAError"},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()}]),li(),!M.shouldClearAugloopResponseTimer(r)||je.isALHookEnabled&&je.isALRequestResponseEnabled||wf._.getInstance(pe).clearAugloopResponseTimer();else if(je.isClaimsChallengeMessageInAnnotationEnabled&&fo(r.body))Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.AuthMessageReceived},{key:Pf.h3.ChatEventParameters,value:"ClaimsChallengeMessageInAnnotationCalled"},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()}]),ai(!0),!M.shouldClearAugloopResponseTimer(r)||je.isALHookEnabled&&je.isALRequestResponseEnabled||wf._.getInstance(pe).clearAugloopResponseTimer();else if(e?.T_&&Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ALAnnotationReceived},{key:Pf.h3.ChatEventParameters,value:e?.T_},{key:Pf.h3.Cv,value:t},{key:Pf.h3.ALSessionKey,value:Jb.w.getInstance().getAlSessionKey()}]),Mf.A.getInstance(pe).isWorkflowRegistered(e?.T_)){if(Mf.A.getInstance(pe).isAugloopResponseTimeoutRequired(e?.T_)){if(await M.shouldIgnoreResponse(r))return;!M.shouldClearAugloopResponseTimer(r)||je.isALHookEnabled&&je.isALRequestResponseEnabled||wf._.getInstance(pe).clearAugloopResponseTimer()}(0,tC.ei)(r.body,mr),M.sendResponseToClient(r,t,n)}}}const So=Hf();Yr?.copilotChatConversationSelectedContext?.conversationId?.current&&(fr.current=!0);je?.isRealtimeVoiceEnabled&&je?.isRealtimeVoiceChatHistoryEnabled&&os&&(fr.current=!0,ls(!1));const Eo=()=>{Qt((e=>({...e,loadingUiStringList:[So[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1}))),g(!0)},xo=()=>{je.isALHookEnabled&&je.isALRequestResponseEnabled&&(Ir.current?(Ir.current.cancel(),(0,qf.cY)("Cancelled query execution using cancellationToken"),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.StopGenerationUsingCancellationToken}])):((0,qf.cY)("cancellationToken is undefined"),Pe.sendTelemetryErrorData([{key:Pf.IC.ErrorMessage,value:"Cancellation Token is undefined"},{key:Pf.IC.ErrorType,value:Pf.q0.Client},{key:Pf.IC.ErrorCode,value:Af.O4.CancellationTokenUndefined},{key:Pf.IC.ErrorCategory,value:kf.S2.Augloop}]))),jf.U.getInstance(pe).getIsBasicChatStreaming()&&(jf.U.getInstance(pe).updateCardWithFooter(),Pe.logErrorWithAshaVetoAndError([],jf.U.getInstance(pe).getFeatureName(),Df.u1,Pf.G8.BasicChatUserCancelledResponse,Pf.ym.UserAbortedQueryExecution),jf.U.getInstance(pe).resetBasicChatStreamingStates(!0,!1)),Ar.current=!0,g(!1),M.sendEventToClient(Tf.PV.StopGeneratingButtonClicked),je.isALHookEnabled&&je.isALRequestResponseEnabled||wf._.getInstance(pe).clearAugloopResponseTimer(),je.isALHookEnabled?Ts():Cf.E.getInstance(pe).clearOperationListForResubmit(),jQ(je),M.updateCopilotState(Tf.SG.IDLE),(0,qf.cY)("Stop Generation Button Clicked.")};Yr?.stopGeneratingQuery&&(Yr.stopGeneratingQuery.current=()=>{Il()&&Io()});const Io=()=>{jf.U.getInstance(pe).getIsBasicChatStreaming()&&(Pe.logErrorWithAshaVetoAndError([],jf.U.getInstance(pe).getFeatureName(),Df.u1,Pf.G8.BasicChatUserCancelledResponse,Pf.ym.QueryEndGptSwitch),jf.U.getInstance(pe).resetBasicChatStreamingStates(!0,!1)),g(!1),M.sendEventToClient(Tf.PV.QueryEndOnGptSwitch),(0,qf.cY)("Stop Generation When Gpt Switched.")},Ao=((e,t)=>{const n=Ff();return()=>({loadingUiStrings:0===e.loadingUiStringList.length?n:e.loadingUiStringList,stringChangeIntervalDuration:e.stringChangeIntervalDuration,showStopButton:e.showStopGeneratingButton,showInlineStopButton:e.showInlineStopGeneratingButton,handleStopButtonOnClick:t,isAutoScrollingEnabled:e.isAutoScrollingEnabled})})(Wt,xo),Po=()=>{g(!1),M.sendEventToClient(Tf.PV.PythonExitAnalysisButtonClicked),M.updateCopilotState(Tf.SG.IDLE),(0,qf.cY)("Python Exit Analysis Button Clicked.")},ko=()=>{R?.freUiProps?.onGetStartedButtonClicked?.(),u(!1)},To=()=>!d&&(R?.suggestionPillsUiProps?.suggestionList?.length>0&&!(0,Vf.hX)(R?.suggestionPillsUiProps?.suggestionList[0])||dn.length>0)&&((0,qf.cY)("Suggestion Pills are shown"),!0),Do=()=>M.getPythonMode()&&!p,Mo=e=>(e?.isInSingleMode??!1)&&!p,Lo=e=>{if(!on.current||p||null!=Je.current&&Je.current?.getInputText().length>=(R.chatInputProps?Df.O2:Df.d7))return;is.current=!0;const t=Je.current?.getInputText().length>0&&mi?Df.Gs:Df.u1,n=null!=Je.current?Je.current?.getInputText()+t+e:Df.u1;Je.current?.setInputText(n),Je.current?.setGhostText(Df.u1),Je.current?.setFocus(),(0,qf.cY)("final text passing here: "+e)},Ro=e=>{if(!on.current||p||null!=Je.current&&Je.current?.getInputText().length>=(R.chatInputProps?Df.O2:Df.d7))return;const t=Je.current?.getInputText().length>0&&mi?Df.Gs:Df.u1;Je.current?.setGhostText(t+e),(0,qf.cY)("ghost text passing here: "+e),is.current=!0,e.trim()&&(0,gy.Uk)(Df.l3,Mi),(0,qf.cY)("Voice response - Partial Text: "+e)},No=async e=>{if(le?.voiceInputProps){const t=(new Date).getTime(),n=(0,my.n)(le.voiceInputProps.voiceInputLocale);await(0,gy.N6)(n,Lo,Ro,tn,Mi,e),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.MicrophoneInitializationTimeInMs},{key:Pf.h3.ChatEventParameters,value:(0,Vf.xJ)(t).toString()}]),mi=(0,my.G)((0,my.n)(n)),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.MicrophoneSuccessfullyInitialized}])}},Oo=e=>{M.isFeatureGateEnabledFromClient(Af.WT.IsClpSensitivityInChatInputEnabled)&&"File"===e?.type&&(gn(!0),gt(!0),gs(e))},_o=e=>{if(Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.CommandingErrorCardClicked}]),!p&&Je){Je.current?.setGhostText("");const t=e.data;je.isSpaceRequiredAfterInput&&(0,my.G)(le.editorConfig.settings.hostDefaultLocale)&&t.length>0&&t[t.length-1]!==Df.Gs?Je.current?.setInputText(t+Df.Gs):Je.current?.setInputText(t),Je.current?.setFocus();const n=Ln??window;e.isCiq&&n.setTimeout((()=>Je.current?.updateInputText(Df.O8,r.InsertAtCursor)),1)}},Bo=N.useCallback((()=>new vy(sn,nn,en,le?.voiceInputProps?.microphonePermissionErrorTitle,le?.voiceInputProps?.microphonePermissionErrorMessage,rn,tn,Mi,Je,he.chatPlaceholderMessage(),he.micListeningGhostText(),le?.voiceInputProps?.microphonePermissionImagePath,le?.voiceInputProps?.showMicrophonePermissionHelpLink,Ui)),[sn,nn,en,le,Je,he.micListeningGhostText(),Ui]);if(ma){const{activityProvider:e,appService:t}=ma;Vi=new cb(hs,e??void 0,void 0,void 0,ha,t??void 0)}const Fo=he.taskModuleDialogTitle(),Uo=N.useMemo((()=>{if(!ma)return;const{appService:e,channelService:t,tokenService:n,activityProvider:r}=ma,s=new st({appService:e,channelService:t,tokenService:n,activityProvider:r,clientInfo:Dr,taskModuleLauncher:Ae,cardTelemetryService:ua,authTelemetryService:da,taskModuleDialogTitle:Fo,onConfirmationCardButtonClicked:e=>{sa({text:e.text,invokeActionConfirmation:{actionId:e.actionId,action:e.action,sourceRequestId:e.sourceRequestId,confirmationOption:e.confirmationOption,isCancelOption:e.isCancelOption,pluginInfo:e.pluginInfo}})},handleAPIPluginCardImageInsert:ca,featureFlags:je,copilotThemeInfo:Bs,hubSdk:ya});return zs.setPluginCardServiceProvider(s),s}),[ma,xe,Ae,ua,Fo,ca,je,sa,Bs,ya]),Ho=qe||M.isFeatureGateEnabledFromClient(Af.WT.IsCopilotPluginEnabled)?{plugins:qe?.map((e=>({...e,onToggle:(t,n)=>{(0,pb.gE)(`${e.id}:${t?"On":"Off"}`,pe),e.onToggle&&e.onToggle(t,n),re?.setWebSearchState(!1,t)}})))??[],pluginBlockedInfo:yn,onGroundingButtonClick:()=>{(0,qf.cY)("Grounding button clicked");const e=[{key:Pf.h3.ChatEventType,value:Pf.a5.GroundingButtonClicked}];if(!yn){const t=qe?.map((e=>e.id)).join(",");e.push({key:Pf.h3.ChatEventParameters,value:`Default Blocked: ${t}`})}Pe.sendTelemetryChatEventData(e)},copilotPluginFlyoutProps:M.isFeatureGateEnabledFromClient(Af.WT.IsCopilotPluginEnabled)?{telemetryService:ha}:void 0}:void 0,zo=e=>{const t=Yr?.getDeclarativeAgentsList?.()??[],n=t?.some((t=>t.id===e.appId));je?.isAgentsLoggingEnabledInShared&&(e.appId?Wf.j.setExtensibilityInfo({workflowAnnotationType:"",gptId:e.appId,agentType:(0,Hw.UD)(e.appId),viewMode:"AtMention"}):Wf.j.setExtensibilityInfo(void 0)),E((t=>{if(t&&t.appId!==e.appId&&zs.setChatMessageData(a._.SystemMessage,{systemMessageProps:{user:Af.Q9.Chat,pluginAppId:t.appId,pluginAppName:t.title,pluginAppIcon:t.iconUrl,samplePrompts:[],isEnabled:!0,scenario:t.appType===pf.b.GPT?"DCRemovedFromBanner":"PluginRemovedFromBanner"}},void 0,!1),t&&t.appId===e.appId)return e;const r=hs.isPluginEnabled(e.appId);return zs.setChatMessageData(a._.SystemMessage,{systemMessageProps:{user:Af.Q9.Chat,pluginAppId:e?.appId,pluginAppName:e?.title,pluginAppIcon:e?.iconUrl,samplePrompts:[],isEnabled:r,scenario:e.appType===pf.b.GPT?"DCMention":"PluginMention",buttonText:je?.enableSystemMessageActions&&e?.appType===pf.b.GPT?`${ns} ${e.title}`:"",showActionLink:n}},void 0,!1),e}))},jo=e=>{te((t=>{if(t&&t.id!==e.id){const e=t.icon,n=e?N.createElement(e,null):void 0;zs.setChatMessageData(a._.SystemMessage,{systemMessageProps:{user:Af.Q9.Chat,pluginAppId:t.id,pluginAppName:t.title,pluginAppIcon:t.iconUrl??n,samplePrompts:[],isEnabled:!0,scenario:"DCRemovedFromBanner"}},void 0,!1)}if(t&&t.id===e.id)return e;const n=e.icon,r=n?N.createElement(n,null):void 0;return zs.setChatMessageData(a._.SystemMessage,{systemMessageProps:{user:Af.Q9.Chat,pluginAppId:e?.id,pluginAppName:e?.title,pluginAppIcon:e?.iconUrl??r,samplePrompts:[],isEnabled:!0,scenario:"DCMention"}},void 0,!1),e}))},Vo=N.useCallback((()=>{if(ee){const e=ee.icon,t=e?N.createElement(e,null):void 0;zs.setChatMessageData(a._.SystemMessage,{systemMessageProps:{user:Af.Q9.Chat,pluginAppId:ee.id,pluginAppName:ee.title,pluginAppIcon:ee.iconUrl??t,samplePrompts:[],isEnabled:!0,scenario:"PluginRemovedFromBanner"}},void 0,!1)}te?.(void 0)}),[ee,te]),qo=N.useCallback((e=>{if(!e)return void Cl();const t=Yr?.getDeclarativeAgentsList?.()??[];(0,Vf.u4)(zo,t,e)}),[Yr,zo]),Wo=N.useCallback((()=>{const e=!(!je?.isDeclarativePromptsEnabled||void 0===J?.currentSelectedGPTId)||ue?.buttonProps?.menuButtonEnabled,t={showStopGeneratingButtonOnSubmit:Wt.showStopGeneratingButton||Wt.showInlineStopGeneratingButton,handleStopGeneratingButtonClick:xo},n=f||m,r=n&&(!je.removeFluentProviderFromInputWithThemeV2||!f&&m)?(0,qf.s5)(n):void 0,s=n?.isDarkModeEnabled??!1,i=n?.dir??void 0;return new Rf.c(Je,r,s,i,d,h,pt,c,u,M,ue?.menuProps,sa,Xa,ce?ce.transformFilePlaceholderText?ce.transformFilePlaceholderText:Df.u1:ue?.transfromFileNonCIQPlaceholderMessage?ue?.transfromFileNonCIQPlaceholderMessage:Df.u1,ce?ce.ciqPlaceholderText?ce.ciqPlaceholderText:ce.featureFlags?.disableClientConfigQueryCharacterForEditorService?Df.u1:he.defaultCiqPlaceholderText():Df.u1,I,me?Je.current?.getCIQResponseHandler():void 0,ue?.chatPlaceholderMessage,ue?.chatRestShyPlaceholderMessage,ue?.voiceInputProps?{...ue?.voiceInputProps,alSession:fs,microphoneButtonProps:Bo().getMicrophoneButtonProps()}:void 0,ue?.buttonProps?.ciqButtonEnabled,ue?.buttonProps?.analyzeDataButtonEnabled,ue?.buttonProps?.atMentionButtonEnabled,ue?.buttonProps?.groundingButtonEnabled&&!F?.paneSilhouetteHeaderProps?.enableSettingsPanel,e,ue?.buttonProps?.realtimeVoiceButtonEnabled,ue?.shouldEnablePromptSuggestions,Ho,Ui,me?{editorConfig:ce,alSession:ce?.customAlSession??fs,handleInChatInput:me,postCIQItemSelectionHandler:Oo,fluentv9Theme:ce?.settings.enableVisualRefresh?f:void 0}:void 0,pn,zo,x,Q,G,Z,jo,ue?.chatInputButtons,ue?.characterLimitErrorMessage,ue?.imageInputEnabled,ye,be,Ce,Se,we,ue?.isScreenshotButtonEnabled,ue?.getScreenshot,ue?.activateCopilotPointer,he.copilotLabMenuItemText(),void 0===J?.currentSelectedGPTId||!!je?.isCiqEnabledInDAs,ue?.insertImageFlags,J?.currentSelectedGPTId,je.isALHookEnabled?Cs:void 0,ue?.addMenuOptionsProps,ue?.officeAssistantButtonProps,ue?.copilotResearchButtonProps,ue?.cuaButtonProps,t,pe,Ln,re?.groundingState,as,je.isModelSelectorEnabled?Vt:void 0,ue?.tabsterAttribute,ue?.shouldRunMCPAgent)}),[d,c,m,f,ce,pt,pn,Bo,Ui,le,ue,yn,J,E,x,sa,J?.currentSelectedGPTId,Cs,Wt.showStopGeneratingButton,Wt.showInlineStopGeneratingButton,pe,qe]);N.useEffect((()=>{e(Wo(),null)}),[Wo,le,ue,d,fs,sn,pe,Wt.showStopGeneratingButton]),(0,N.useEffect)((()=>{Ks()?.setLoading(pn)}),[pn]);const Qo=()=>oy.J.getInstance()?.getLogs()??"",Go=e=>{ot.current=e},Zo=N.useMemo((()=>new Yf(Je,sa,Xa,d,ce?ce.transformFilePlaceholderText?ce.transformFilePlaceholderText:Df.u1:ue?.transfromFileNonCIQPlaceholderMessage?ue?.transfromFileNonCIQPlaceholderMessage:Df.u1,ye,Ce,ve,J?.currentSelectedGPTId,pe)),[Je,sa,Xa,d,ce,ue,ye,Ce,ve,J?.currentSelectedGPTId,pe]),Yo=N.useMemo((()=>new hb(Je,sa,d,ce?ce.transformFilePlaceholderText?ce.transformFilePlaceholderText:Df.u1:ue?.transfromFileNonCIQPlaceholderMessage?ue?.transfromFileNonCIQPlaceholderMessage:Df.u1,ye,Ce,J?.currentSelectedGPTId,Go,X,Ie?.displayName,qo,pe)),[Je,sa,d,ce,ue,ye,Ce,J?.currentSelectedGPTId,X,Ie?.displayName,qo,pe]),Ko=N.useMemo((()=>{const e=R.zeroQueryMessageV2Props?.showSuggestedQnA??!1,t=je.enableProactiveZQMWithSuggestedQnA??!1;return e&&t}),[R.zeroQueryMessageV2Props?.showSuggestedQnA,je.enableProactiveZQMWithSuggestedQnA]),{promptBucketInfoList:Jo,handleBucketedPromptRenderCallback:Xo,isPromptBucketUpdated:$o,handleZQMRefresh:tl}=((e,t)=>{const n=N.useRef(new Map),r=(0,Xn.zK)(),s=r?.getDeclarativeAgentsList?.()??[],i=N.useRef(!1),[a,o]=N.useState(!1);return N.useEffect((()=>{if(e){const t=new Map;e.forEach((e=>{const r=n.current.get(e.position);if(r&&r.promptList.length===e.promptList.length){const n=r?.promptList?.map((t=>{const n=e?.promptList?.find((e=>e?.suggestionId===t?.suggestionId));return n??t}));r.promptList=n,(0,qf.cY)("Existing bucket updated:",r),t.set(e.position,r)}else t.set(e.position,{...e,promptList:(0,Vf.q6)(e.promptList)})})),n.current=t,i.current=!0}else o(!0)}),[e]),{promptBucketInfoList:N.useMemo((()=>{if(t)return[];const e=Array.from(n.current.values()).map((e=>({...e,promptList:e.promptList.map((e=>({...e,iconUrl:e.iconUrl??s.find((t=>t.id===e.agentInvocationProps?.agentId))?.menuIconUrl})))})));return i.current&&!a&&o(!0),e}),[n.current,s,t]),handleBucketedPromptRenderCallback:e=>{if(e?.length>0)for(let t=0;t<e.length;t++){const n=e[t];n.source===$n.L.Agent&&r?.agentZQRenderCallback?.(n)}},isPromptBucketUpdated:a,handleZQMRefresh:()=>{(0,qf.cY)("here: Refreshing ZQM Buckets on pane hide"),n.current.forEach((e=>{e.promptList=(0,Vf.q6)(e.promptList)}))}}})(R?.zeroQueryMessageV2Props?.promptBucketInfo,J?.currentSelectedGPTId);N.useEffect((()=>{$o&&!ti()&&je?.shouldShowDADiscoverabilityZQM&&bl()}),[$o]);const{getProps:nl,updateCachedSuggestedQnAList:rl,cachedSuggestedQnAsList:sl,setSuggestedQnAsList:il,proactiveZQMNewConversationHandler:al}=(({chatInputRef:e,handleSubmit:t,isExecuting:n,setChatMessage:r,isHVCAppChatV2Enabled:s=!1,hvcPromptStringsList:i=[],selectedCopilotId:a="",sessionStorageKey:o,setChatInputZQMRef:l,isSuggestedQnACitationsEnabled:c,wasChatPaneAutoOpened:u=!1,userDisplayName:d,showSuggestedQnA:h,handleZQMAgentInvocation:p,copilotCommunicationHandler:g})=>{const m=(0,N.useRef)(null),f=(0,Ot.Y$)(),y=(0,ry.D)(),{submitOperation:v}=(0,sy.G)(),b="default"===f.isPreloadedSDXPaneOpenedBeforeCompletion?!f.isFocusChatInputOnMount:"not_opened"===f.isPreloadedSDXPaneOpenedBeforeCompletion,C=hw.getInstance(o),w=(0,N.useRef)(!1),S=f?.enableSQNAZQMWhenNotInCC??!1,E=(!f?.isOfficeCopilotChatPreloadEnabled||f?.isOfficeCopilotChatPreloadEnabled&&!b)&&h&&!C?.isInErrorState(),[x,I]=(0,N.useState)((()=>E?C?.get()??[]:[])),A=(0,An.Mb)().hostAppSettings.window??window,P=(0,N.useRef)([]),k=Wf.j.getInstance(y),T=(0,N.useRef)(void 0),[D,M]=(0,N.useState)(!1);void 0===T.current&&e.current?.getChatEditorService&&(T.current=e.current.getChatEditorService());const L=(0,N.useCallback)(((e,t=!1)=>{if(!Array.isArray(e))return;const n=tw(e,c);if(S&&t&&((0,qf.cY)("Skipping ProactiveZQMs with SuggestedQnAs: updating CC with LOADED state."),w.current=t),h){if(C?.isInErrorState()||C?.set(n),0===x.length&&P.current&&0===P.current.length&&(f?.shouldShowNewSQNAZQM||b)){I(n);const e=f?.shouldShowNewSQNAZQM?`Updated proactive ZQM with shouldShowNewSQNAZQM enabled. Current cache length: ${n?.length}`:`Updated proactive ZQM for first preloaded pane open. Current cache length: ${n?.length}`;(0,qf.cY)(e)}P.current=n}(0,qf.cY)(`Updated proactive ZQM cache. Current cache length: ${P.current?.length}`)}),[]),R=(0,N.useCallback)((async(i,o)=>{if(n)return;(0,Qf.$w)(Df.u1);const u=m.current?.promptSuggestionList.find((e=>e.suggestionText==o));if(u&&p&&p(u?.agentInvocationProps),zf.A.getInstance(y).sendLoggingEventToClient(Tf.Yk.ZQMButtonItemClicked),k.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMButtonV2Clicked},{key:Pf.h3.ChatEventParameters,value:u?.source??$n.L.Static},{key:Pf.h3.SelectedSwitcherMenuItemId,value:a}]),u?.suggestionId&&u?.suggestionId!==Df.u1&&k.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMClickedPrompt},{key:Pf.h3.ChatEventParameters,value:u?.suggestionId}]),u?.notifyClientOnZQMClicked?.(u),u?.promptClickHandledByClient)return(0,qf.cY)("ZQM Prompt click handled by client"),k.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMClickHandledByClient},{key:Pf.h3.ChatEventParameters,value:u?.source??$n.L.Static},{key:Pf.h3.SelectedSwitcherMenuItemId,value:a}]),void u?.promptClickHandledByClient?.(i,u);const d=nw(x,o);if(u&&d)return sw(d,f?.isOutputV2Enabled??!1,c??!1,r,k,y),(0,qf.cY)("DQG handle submit clicked"),void g.sendEventToClient(Tf.PV.HandleSubmitForDQGCLicked);u?.shouldLaunchImageInputMenuOnSelection&&e.current?.openImageInputMenu&&e.current.openImageInputMenu(),l(!0);let h=i;if(u?.shouldSubmitQueryOnClick)return s&&(h=h.replace(/{|}/g,"")),void t({text:h,telemetryData:Pf.a5.ZQMButtonClicked,requestMetaData:u?.requestMetaData});if(!T.current&&e.current?.getChatEditorService&&(T.current=e.current.getChatEditorService()),u?.shouldLaunchCIQOnSelection&&u?.scopedEntity===Tf.ck.CopilotPlugin)e.current?.setInputText(ub.Tb);else{if(u?.shouldLaunchCIQOnSelection&&u.scopedEntity&&T.current){const e=u.scopedEntity??Tf.ck.File;(0,qf.cY)("scopedEntity",e),T.current.setEntityScope(e),u.unSupportedEntities&&(T.current.setUnsupportedEntities(u.unSupportedEntities),(0,qf.cY)("UnSupportedEntites:",u.unSupportedEntities))}e.current?.setInputText(h,!0),e.current?.setFocus(),u?.shouldLaunchCIQOnSelection&&T.current&&A.setTimeout((()=>e.current?.updateInputText(Df.O8,Zf.v.InsertAtCursor)),1)}}),[n,a,x,s,t]),O=(0,N.useRef)(!1),_={promptGuideMenuSectionUnderstand:_f.hf},B=(0,it.kQ)(_);(0,N.useEffect)((()=>{if(f?.shouldShowNewSQNAZQM&&f?.shouldShowNewSQNAZQM&&x.length>=2&&m.current){M(!0);const e=setTimeout((()=>{m.current&&(m.current=$C(m.current,x,B.promptGuideMenuSectionUnderstand()??"Understand"),O.current=!0),M(!1)}),f?.zqmShimmerTimeout??1500);return()=>clearTimeout(e)}}),[x,B,f?.shouldShowNewSQNAZQM]);const F=(0,N.useCallback)(((e,t)=>e?f?.shouldShowNewSQNAZQM?(O.current||(m.current=(0,db.SF)(e,t)),(0,qf.cY)("New SQNA ZQM props:",x),ew(m.current,R,s,i,u,d,D)):(m.current=(0,db.SF)(e,t),S&&x.length>=2&&!w.current&&(m.current=$C(m.current,x,B.promptGuideMenuSectionUnderstand()??"Understand")),ew(m.current,R,s,i,u,d)):{promptSuggestions:[],showBranding:!1,brandingInfo:{},handleButtonClick:R,wasChatPaneAutoOpened:u,userDisplayName:d}),[x,R,s,i,u,d,f?.shouldShowNewSQNAZQM,B,D]),U=(0,N.useCallback)((()=>{if(P.current&&P.current.length>0){const e=(0,Vf.q6)(P.current);I(e),(0,qf.cY)("Updated proactive ZQM prompts on new conversation.")}f.isALHookEnabled?iw(y,v):iw(y)}),[v]);return{getProps:F,updateCachedSuggestedQnAList:L,cachedSuggestedQnAsList:P,setSuggestedQnAsList:I,proactiveZQMNewConversationHandler:U}})({chatInputRef:Je,handleSubmit:sa,isExecuting:d,setChatMessage:yi,isHVCAppChatV2Enabled:ye,hvcPromptStringsList:Ce,selectedCopilotId:J?.currentSelectedGPTId,sessionStorageKey:Qe,setChatInputZQMRef:Go,isSuggestedQnACitationsEnabled:gi(),wasChatPaneAutoOpened:X,userDisplayName:Ie?.displayName,showSuggestedQnA:Ko,handleZQMAgentInvocation:qo,copilotCommunicationHandler:M}),[ol,ll]=(0,N.useState)(!1),{getProps:cl,isWelcomeScreenLoading:ul}=(({userName:e,brandingUrl:t,isDeclarativeCopilot:n,loadingTimeOutForAutoOpenedChatPane:r,wasAutoOpenedPane:s,isCopilotInBackstageMode:i,areZQMsAvailable:a,customMessage:o})=>{const l=(0,Ot.Y$)(),c=(0,N.useMemo)((()=>l?.showWelcomeExperience&&!n||s?r?It.AUTO_OPENED_PANE_LOADING_TIMEOUT:s?It.LOADING:l?.enableInsightsCard?It.IC_CONTAINER_LOADED:void 0:It.LOADING_NOT_APPLICABLE),[r,n]);return{getProps:(0,N.useCallback)((()=>({userName:e??"",appName:xf.w.getAppName(),loadingState:c,isDeclarativeCopilot:n,brandingUrl:t,wasAutoOpenedPane:s,isCopilotInBackstageMode:i,areZQMsAvailable:a,customMessage:o})),[n,c,e,t,o]),isWelcomeScreenLoading:c===It.LOADING}})({userName:R?.welcomeScreenDisplayName??Ie?.displayName?.split(" ")[0]??"",brandingUrl:(0,QC.iB)(J?.currentSelectedGPTId)?R?.zeroQueryMessageV2Props?.brandingInfo?.iconUrl:void 0,isDeclarativeCopilot:(0,QC.iB)(J?.currentSelectedGPTId),loadingTimeOutForAutoOpenedChatPane:ol,wasAutoOpenedPane:X,isCopilotInBackstageMode:je.isCopilotInBackstageMode,areZQMsAvailable:!!R?.zeroQueryMessageV2Props?.promptSuggestionList?.length,customMessage:R?.welcomeScreenCustomMessage}),{getProps:dl,shouldShowInteractiveCard:gl}=((e,t)=>{const n=(0,Ot.Y$)(),r=(0,ry.D)(),{submitOperation:s}=(0,sy.G)(),i=N.useMemo((()=>((t?.shouldShowContentCard??!1)&&n?.enableInsightsCard&&!e.isDeclarativeCopilot)??!1),[t?.shouldShowContentCard,e.isDeclarativeCopilot]),a=(0,N.useCallback)((e=>{if(Nt.E.QNA===e?.tabType){const t=()=>{n.isALHookEnabled&&s?s(jf.U.getInstance(r).getSuggestedQnaScenarioSignalOperation(),yf.pK.getTypeName()):Cf.E.getInstance(r)?.submitOperation(jf.U.getInstance(r).getSuggestedQnaScenarioSignalOperation(),yf.pK.getTypeName())};return()=>{e?.onRetry?.(t)}}return()=>e?.onRetry?.()}),[s]);return{getProps:()=>{const e=[],n=t?.contentProviders;n?.forEach((t=>{const n=t;e.push({value:n?.tabValue,title:n?.tabTitle,content:n?.content,contentState:n?.contentState,isFixedHeightTab:n?.isFixedHeightTab,onTabLoadTimeout:n?.onTabLoadTimeout,onRetry:a(n)})}));const r={tabs:e,actionBarButtons:t?.actionBarButtons??[],cardContentElementId:t?.cardContentElementId,onTabChange:t?.onTabChange,onFirstCardRendered:t?.onFirstCardRendered,isWorkspaceMode:t?.isWorkspaceMode,styles:t?.styles,onShowMoreClicked:t?.onShowMoreClicked},s=t?.sensitivityProps;return s?{...r,sensitivityProps:s}:r},shouldShowInteractiveCard:i}})({isDeclarativeCopilot:(0,QC.iB)(J?.currentSelectedGPTId)},R?.interactiveCardProps),{getProps:ml,updateSuggestedQnAForCachedSuggestedPrompts:fl,shouldShowSuggestionPrompts:yl}=qw(Je,sa,M,gi(),d,mt,Ss,Bi,ul,Dn,R,yi),vl=()=>{Fe.current=!0},bl=async()=>{if(je.isZQMShownSourceTelemetryEnabled&&Ne.current&&!c&&at?.current?.promptSuggestions&&at?.current?.promptSuggestions?.length>0){Ne.current=!1;const e=(0,QC.Dk)(at.current.promptSuggestions),t=(0,QC.tA)(at.current.promptSuggestions);(0,qf.cY)(`ZQM PromptIds ${t}, ZQM Shown Source Telemetry:`,e),Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMShownSource},{key:Pf.h3.ChatEventParameters,value:JSON.stringify(e)}]),t.length>0&&Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.ZQMShownPrompt},{key:Pf.h3.ChatEventParameters,value:t}])}};aw(M,sl,il,bl,vl,Ko,aa,tl);const Cl=N.useCallback((()=>{x&&zs.setChatMessageData(a._.SystemMessage,{systemMessageProps:{user:Af.Q9.Chat,pluginAppId:x.appId,pluginAppName:x.title,pluginAppIcon:x.iconUrl,samplePrompts:[],isEnabled:!0,scenario:"PluginRemovedFromBanner"}},void 0,!1),E?.(void 0)}),[x,E]);(0,zw.U)(ki);const wl=N.useMemo((()=>{const e=!(0,QC.iB)(J?.currentSelectedGPTId);return Ko&&e}),[Ko,J?.currentSelectedGPTId]),Sl=()=>{const e=je?.shouldShowDADiscoverabilityZQM?Jo:void 0,t=wl?nl(R.zeroQueryMessageV2Props,e):Yo.getProps(R.zeroQueryMessageV2Props,e);if(je.isZQMShownSourceTelemetryEnabled)if(!at.current&&t)Ne.current=!0,Oe.current=!0,at.current={...t};else if(at?.current?.promptSuggestions&&t.promptSuggestions&&(0,QC.LX)(at.current.promptSuggestions,t.promptSuggestions)){Ne.current=!0;const e=(0,QC.kj)(at.current.promptSuggestions,t.promptSuggestions);e.length>0&&(Oe.current=!0,_e.current=e),at.current={...t}}return Xo(t?.promptSuggestions),{...t,showBranding:R.zeroQueryMessageV2Props?.showBranding&&!je?.showWelcomeExperience&&!X}};(0,N.useEffect)((()=>{if(X){const e=(Ln??window).setTimeout((()=>{ll(!0)}),je.autoOpenedPaneLoadingTimeout);return()=>clearTimeout(e)}}),[]),N.useEffect((()=>{Fe.current&&!c&&gl&&(Fe.current=!1,Pe.sendTelemetryChatEventData([{key:Pf.h3.ChatEventType,value:Pf.a5.InsightsCardShown}]))}),[gl]),N.useEffect((()=>{const e=tr()||x||ee||_i&&A||Us&&!p?{chatInputBannerString:Hs,appService:Uo?.appService,atMentionApp:x,onRemoveAtMentionApp:Cl,isCreditsUIShown:tr(),creditsUIProps:nr(),assistantApp:ee,onRemoveAssistantApp:Vo}:void 0;S(e)}),[A,ws,mt,p,Ss,x,Un,zn,Vn,ee,zt]);const El=()=>{At(!1)},xl=()=>!p&&R.showSuggestionButtonProps,Il=()=>je?.isCustomGPTsEnabled&&je?.enableQueryEndOnGptSwitch&&p,Al=N.useCallback((e=>{e&&J?.handleCopilotChange?.(e)}),[J]),Pl=()=>async e=>{(0,qf.cY)("Create New Conversation Button Clicked"),M.sendEventToClient(Tf.PV.CreateNewConversationButtonClicked),Dn.current=!0,Il()&&Io(),Cl?.(),Vo?.(),e?.eventName&&vr.logChatHistoryActionEvent(e.eventName),e?.shouldSetLoadingUIStates&&(y(!0),g(!0),(0,Qf.$w)(Df.u1),Tr.current.setSuggestedQnAList([])),e?.resetChatState&&((0,Sf.Ms)(),je?.isCustomGPTsEnabled&&je?.enableQueryEndOnGptSwitch&&(Ye(),Sr.current=!0)),je?.isRealtimeVoiceEnabled&&je?.isRealtimeVoiceChatHistoryEnabled&&(kw.i.chatSessionId=null),ts(!1),Qt((e=>({...e,loadingUiStringList:[he.defaultLoadingUiStrings[0]],showStopGeneratingButton:!1,showInlineStopGeneratingButton:!1})));const t={gptId:e?.gptId};if(tl(),Ko)try{(0,qf.cY)("Refreshing proactive ZQM with SuggestedQnA on new conversation click"),al()}catch(e){(0,qf.cY)("Error while refreshing proactive ZQM on new conversation",e)}const n=je.sendDocumentURLInChatHistory?await(M.getHostSettings()?.getDocumentUrlAsync?.()):void 0;await(0,Sf.a_)({op:gf.S5.AddChatOperation,documentUrl:n,enableChatHistoryV2:R?.chatHistoryUiProps?.enableChatHistoryV2,gptInfo:t,submitOperation:je.isALHookEnabled?Cs:void 0,clearOperationListForResubmit:je.isALHookEnabled?Ts:void 0,componentId:pe})};(0,N.useEffect)((()=>{ao()&&(Yr?.copilotChatHistoryContext?.setOnClickShowChatHistoryPanel?.((()=>so)),Yr?.copilotChatHistoryContext?.setNewConversationClickHandler?.(Pl),Yr?.copilotChatHistoryContext?.setChatHistoryContainer?.((()=>{const e=e=>N.createElement(Zb,{setChatLog:Ze,currentChatId:iy.c.currentChatId,setIsExecuting:g,setLoadingComponentProps:Qt,suggestionPillsBuilderRef:Tr,createAndSubmitChatHistorySignal:Sf.a_,resetToNewConversation:Sf.Ms,setChatHistoryMenuData:ur,handleChatHistoryPanelClose:ro(e),isSwitchingConversation:fr,isChatHistoryMenuLoading:ir,chatHistoryMenuData:cr,isChatHistoryPanelFetchingMoreChats:dr,setIsChatHistoryPanelFetchingMoreChats:hr,isEndOfChatHistory:pr,isChatHistoryMenuLoadingFailed:or,chatHistoryTelemetryHooks:vr,copilotCommunicationHandler:M,currentGptId:J?.currentSelectedGPTId,setCachedSuggestionPillList:hn,chatUIProps:R,submitOperation:je.isALHookEnabled?Cs:void 0,clearOperationListForResubmit:je.isALHookEnabled?Ts:void 0,shouldShowDeprecationMessage:co(),deprecationDate:R?.chatHistoryUiProps?.deprecationDate,setIsSideQuestMode:ts});return e.displayName="ChatHistoryPanel",e})))}),[g,cr,p,ir,dr]),(0,N.useEffect)((()=>{qi&&(Ze((e=>{if(-1!==Dt){const t=e[Dt];t.body.showSideQuestView=!0,t.body.chatCardIndex=Dt}else if(e.length>0){e[e.length-1].body.chatCardIndex=Dt}return e})),Ai())}),[es,Dt]);const kl=void 0!==R?.activeView&&void 0!==R?.setActiveView,[Tl,Dl]=(0,N.useState)(R?.defaultView??"chat");(0,N.useEffect)((()=>{kl&&Dl(R.activeView??"chat")}),[R?.activeView,kl]);const Ml=e=>{kl?R?.setActiveView?.(e):Dl(e)};let Ll=N.createElement(N.Fragment,null);Ll=je?.isHeaderMessageCardElementEnabled&&R?.getHeaderMessageCardElement?(()=>{const e=R.getHeaderMessageCardElement?.();return e?N.createElement(_n.g,{className:Le.headerMessageCardContainer},e):N.createElement(N.Fragment,null)})():N.createElement(N.Fragment,null,c?N.createElement(xt,{...Mr.getProps(ko,R.freUiProps)}):N.createElement("div",{className:Re.chatHeaderWrapper},(je?.showWelcomeExperience||X)&&N.createElement(Rt,{...cl()}),!ul&&N.createElement("div",{className:Re.zqmAndInteractiveCardWrapper},gl&&(je.enableCarouselForInsightsCard?N.createElement(In,{...dl()}):N.createElement(On,{...dl()})),Xs?.promptSuggestionList&&Xs?.promptSuggestionList.length>0&&(R.zeroQueryMessageProps?N.createElement(Kn,{...Zo.getProps(R.zeroQueryMessageProps)}):N.createElement(Cr,{...Sl()})))));let Rl=null;if(io()&&U&&!ao())Rl=N.createElement(N.Fragment,null,N.createElement(Zb,{setChatLog:Ze,currentChatId:iy.c.currentChatId,setIsExecuting:g,setLoadingComponentProps:Qt,suggestionPillsBuilderRef:Tr,createAndSubmitChatHistorySignal:Sf.a_,resetToNewConversation:Sf.Ms,setChatHistoryMenuData:ur,handleChatHistoryPanelClose:no,isSwitchingConversation:fr,isChatHistoryMenuLoading:ir,chatHistoryMenuData:cr,isChatHistoryPanelFetchingMoreChats:dr,setIsChatHistoryPanelFetchingMoreChats:hr,isEndOfChatHistory:pr,isChatHistoryMenuLoadingFailed:or,chatHistoryTelemetryHooks:vr,copilotCommunicationHandler:M,currentGptId:J?.currentSelectedGPTId,setCachedSuggestionPillList:hn,chatUIProps:R,submitOperation:je.isALHookEnabled?Cs:void 0,clearOperationListForResubmit:je.isALHookEnabled?Ts:void 0,setIsSideQuestMode:ts}));else if(qi&&es){const e=yl()&&je.showPromptSuggestionsWithOutput?N.createElement(Pr,{...ml(R.suggestionPillsUiProps)}):N.createElement(qr,{...Tr.current.getProps(R.suggestionPillsUiProps,dn,D===s.Y.IOS?kr.Start:kr.End)});Rl=N.createElement(iS,{chatLog:Ge,setChatLog:Ze,suggestionPills:To()&&e,scrollToBottom:Ai,setIsSideQuestMode:ts,currMessageIndex:Dt,getSideQuestEditor:Bt.current,loopComponentRef:Ut,isExecuting:p,setCurrentMessageIndex:Mt,insertOnClick:Ht.current,setChatInputDisabled:h,copilotCommunicationHandler:M,chatContainerBuilder:zs,theme:Bs})}else if(je.isComprehensionViewEnabled&&"comprehension"===Tl){const e={...Zs},t={...dl()};Rl=N.createElement(N.Suspense,{fallback:N.createElement(gv.A,{className:""})},N.createElement(Qr,{podcastUIProps:e,changeView:Ml,interactiveCardProps:t}))}else Rl=N.createElement(N.Fragment,null,_i&&!Oi&&!Bi&&N.createElement(gv.A,{className:z?Re.shimmerUiZoom:Re.shimmerUi}),N.createElement("div",{className:ze.wrapperMargin},N.createElement("div",{className:ze.wrapperContainer},Or&&R.toggleUiProps&&N.createElement(Kr,{...Br.getTryReviewerAgentProps(R.toggleUiProps,!1,"Reviewer")}),Nr&&N.createElement(Kr,{...Br.getTryWebChatProps(wt,Pi,"Try Web Chat")}),wt&&N.createElement("iframe",{src:R?.toggleUiProps?.webSearchUrl??Df.Gh,title:he.bingChatTitle(),height:"100%",allow:"clipboard-write;microphone;camera"}))),!wt&&N.createElement(N.Fragment,null,(!mt&&Ss||Bi)&&N.createElement("div",{className:ze.wrapperMargin},N.createElement("div",{className:ze.wrapperContainer},Lr&&R.toggleUiProps&&N.createElement(Kr,{...Br.getTrySydneyProps(R.toggleUiProps,cn,"Try Sydney")}),Rr&&R.toggleUiProps&&N.createElement(Kr,{...Br.getTryEnterpriseSearchProps(R.toggleUiProps,!1,"Enterprise Search Mode")}),xf.w.isDevbuild()&&B?.isDebugToggleEnabled&&!ci()&&N.createElement(vs,{...Fr.getDebugSectionProps(Qo,B?.conversationId??"",B?.telemetryData)}),xf.w.isDevbuild()&&ci()&&N.createElement(Di,{...Ur.getDebugSectionProps(Qo,B?.conversationId??"",B?.telemetryData,B?.sessionId,B?.conversationLogObject,B?.debugMessageInfoObject,B?.showDebugInfoMessage,B?.setShowDebugInfoOnMessage,En,Pn,B?.sydneyConversationObject,B?.augloopKustoQueryURL,B?.clientKustoQueryURL,xf.w.getAppName(),D,B?.sdxVersion,B?.sessionKey,br?.current,Mn?.current,B?.isCipTreeDebugEnabled,B?.cipTree,di,ui)}),_r&&R.toggleUiProps&&N.createElement(Kr,{...Br.getFastModeReviewerAgentProps(R.toggleUiProps,!1,"Quick Review Test Mode")}))),(!mt&&Ss||Oi||Bi)&&N.createElement(N.Fragment,null,er()&&N.createElement(iC,{...Qn.getProps(Jn,Gn,Zn,Yn,Wn)}),Et&&N.createElement(Fi,{...Vr.getProps(El)}),N.createElement("div",{className:z?je.isBundledPackageEnabled?Re.chatFreStackZoomForBundled:Re.chatFreStackZoom:je.isBundledPackageEnabled?Re.chatFreStackForBundled:Re.chatFreStack},N.createElement(hf.z,{id:Df.FK,className:Re.chatFreStackContainer,ref:si},Js&&N.createElement(la,{ref:Tn,...bn}),Ll,io()&&!ao()&&N.createElement(ba,{onClick:so,isDisabled:Oi}),!uo()&&je.isCreditsUIEnabled&&zn===cC.$n.Limited&&!R.creditsUIProps?.creditButtonProps?.hide&&N.createElement(Ea,{onClick:qn}),N.createElement("div",{id:Df.S1,ref:$e}),Ge.length>0&&!ul&&N.createElement(_m,{...zs.getProps(Ge,R.chatContainerUiProps),customMessageRenderers:R.customMessageRenderers,handleHVCPillClick:_o,copilotThemeInfo:Bs,sketchImageProps:W,onSystemMessageClickAction:Al,sccTelemetryLogger:ZC.L.getInstance(),shouldShowSideQuestUI:qi}),!mt&&Ss&&!ul&&N.createElement(N.Fragment,null,xl()&&N.createElement(Hm,{...Wr.getProps(R.showSuggestionButtonProps)}),!p&&Ge.length>0&&!R.changeTopicUiProps?.hideChangeTopicButton&&!io()&&!Do()&&!Mo(R.singleModeProps)&&!xl()&&N.createElement(qm,{...zr.getProps((Nl=Pf.a5.ChatHistoryChangeTopicClicked,()=>{(0,Qf.$w)(Df.u1),(0,qf.cY)("Change Topic Button Clicked."),Tr.current.setSuggestedQnAList([]),sa({text:he.changeTopicButtonText()}),vr.logChatHistoryActionEvent(Nl)}))}),Do()&&N.createElement(Zm,{...jr.getProps(Po)}),Mo(R.singleModeProps)&&N.createElement(ef,{...R.singleModeProps.exitButtonProps}),je.isLatencyArrowEnabled&&Nn,!je.isLoadingInOutputEnabled&&p&&(Wt.shouldShowLoadingUi??!0)&&N.createElement($i,{...Ao()}),N.createElement(N.Fragment,null,yl()&&je.showPromptSuggestionsWithOutput&&N.createElement(Pr,{...ml(R.suggestionPillsUiProps)})),je.isLatencyArrowEnabled&&!Rn&&ut.current>0&&N.createElement(Yw.w,{isGenerating:p,className:Re.scrollDownButton,style:Lt,onClick:()=>{Ai(!0)}}),N.createElement("div",{className:je.isLatencyArrowEnabled?Re.messagesEndRef:"",ref:Xe})),(je.isSaveSharePromptEnabled||je.isSavePromptEnabled||je.isSharePromptEnabled)&&N.createElement(_w,null)))),(!mt&&Ss||Bi)&&!ul&&N.createElement(N.Fragment,null,To()&&!je.showPromptSuggestionsWithOutput&&N.createElement(qr,{...Tr.current.getProps(R.suggestionPillsUiProps,dn,D===s.Y.IOS?kr.Start:kr.End)}),Kt&&N.createElement(cf,{...Gt}))));var Nl;const Ol={cacheAppId:"officeweb",physicalRing:xf.w.getEnvironment(),isEnterpriseUser:xf.w.isEnterpriseUser(),getTenantId:se},_l=N.useMemo((()=>({pluginCardServiceProvider:Uo})),[Uo]),Bl=N.useMemo((()=>({skillExecutor:wa})),[wa]),Fl=Kx(Ol);return N.createElement(el.X7.Provider,{value:_l},N.createElement(el.lU.Provider,{value:Bl},N.createElement(VQ,null,N.createElement(Zx,{key:"SafeLinkProvider",value:Fl},Rl,Rs))))}));$Q.displayName=Df.hy;const eG=()=>{ZQ=null,YQ=null}},60513:e=>{"use strict";e.exports=function(e,t){var n,r,s,i,a,o,l,c,u=e.pos;if(96!==e.src.charCodeAt(u))return!1;for(n=u,u++,r=e.posMax;u<r&&96===e.src.charCodeAt(u);)u++;if(l=(s=e.src.slice(n,u)).length,e.backticksScanned&&(e.backticks[l]||0)<=n)return t||(e.pending+=s),e.pos+=l,!0;for(a=o=u;-1!==(a=e.src.indexOf("`",o));){for(o=a+1;o<r&&96===e.src.charCodeAt(o);)o++;if((c=o-a)===l)return t||((i=e.push("code_inline","code",0)).markup=s,i.content=e.src.slice(u,a).replace(/\n/g," ").replace(/^ (.+) $/,"$1")),e.pos=o,!0;e.backticks[c]=a}return e.backticksScanned=!0,t||(e.pending+=s),e.pos+=l,!0}},62273:(e,t,n)=>{"use strict";var r=n(87423).unescapeAll;e.exports=function(e,t,n){var s,i,a=t,o={ok:!1,pos:0,lines:0,str:""};if(60===e.charCodeAt(t)){for(t++;t<n;){if(10===(s=e.charCodeAt(t)))return o;if(60===s)return o;if(62===s)return o.pos=t+1,o.str=r(e.slice(a+1,t)),o.ok=!0,o;92===s&&t+1<n?t+=2:t++}return o}for(i=0;t<n&&32!==(s=e.charCodeAt(t))&&!(s<32||127===s);)if(92===s&&t+1<n){if(32===e.charCodeAt(t+1))break;t+=2}else{if(40===s&&++i>32)return o;if(41===s){if(0===i)break;i--}t++}return a===t||0!==i||(o.str=r(e.slice(a,t)),o.lines=0,o.pos=t,o.ok=!0),o}},62614:(e,t,n)=>{"use strict";e.exports=n(7754)},64671:(e,t,n)=>{"use strict";var r=/^[a-z_$][a-z0-9_$-]*$/i,s=n(76988),i=n(87581);e.exports={add:function(e,t){var n=this.RULES;if(n.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!r.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){this.validateKeyword(t,!0);var i=t.type;if(Array.isArray(i))for(var a=0;a<i.length;a++)l(e,i[a],t);else l(e,i,t);var o=t.metaSchema;o&&(t.$data&&this._opts.$data&&(o={anyOf:[o,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(o,!0))}function l(e,t,r){for(var i,a=0;a<n.length;a++){var o=n[a];if(o.type==t){i=o;break}}i||(i={type:t,rules:[]},n.push(i));var l={keyword:e,definition:r,custom:!0,code:s,implements:r.implements};i.rules.push(l),n.custom[e]=l}return n.keywords[e]=n.all[e]=!0,this},get:function(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},remove:function(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var n=0;n<t.length;n++)for(var r=t[n].rules,s=0;s<r.length;s++)if(r[s].keyword==e){r.splice(s,1);break}return this},validate:function e(t,n){e.errors=null;var r=this._validateKeyword=this._validateKeyword||this.compile(i,!0);if(r(t))return!0;if(e.errors=r.errors,n)throw new Error("custom keyword definition is invalid: "+this.errorsText(r.errors));return!1}}},67322:e=>{"use strict";e.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},68559:(e,t,n)=>{"use strict";e.exports={$ref:n(57770),allOf:n(53197),anyOf:n(46668),$comment:n(74450),const:n(25812),contains:n(38174),dependencies:n(83786),enum:n(86506),format:n(18788),if:n(53856),items:n(86215),maximum:n(59583),minimum:n(59583),maxItems:n(83659),minItems:n(83659),maxLength:n(14267),minLength:n(14267),maxProperties:n(91766),minProperties:n(91766),multipleOf:n(50338),not:n(82518),oneOf:n(18338),pattern:n(72041),properties:n(57842),propertyNames:n(89700),required:n(39489),uniqueItems:n(58545),validate:n(87789)}},69764:(e,t,n)=>{"use strict";var r=n(87423).isSpace;function s(e,t){var n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.substr(n,r-n)}function i(e){var t,n=[],r=0,s=e.length,i=!1,a=0,o="";for(t=e.charCodeAt(r);r<s;)124===t&&(i?(o+=e.substring(a,r-1),a=r):(n.push(o+e.substring(a,r)),o="",a=r+1)),i=92===t,r++,t=e.charCodeAt(r);return n.push(o+e.substring(a)),n}e.exports=function(e,t,n,a){var o,l,c,u,d,h,p,g,m,f,y,v,b,C,w,S,E,x;if(t+2>n)return!1;if(h=t+1,e.sCount[h]<e.blkIndent)return!1;if(e.sCount[h]-e.blkIndent>=4)return!1;if((c=e.bMarks[h]+e.tShift[h])>=e.eMarks[h])return!1;if(124!==(E=e.src.charCodeAt(c++))&&45!==E&&58!==E)return!1;if(c>=e.eMarks[h])return!1;if(124!==(x=e.src.charCodeAt(c++))&&45!==x&&58!==x&&!r(x))return!1;if(45===E&&r(x))return!1;for(;c<e.eMarks[h];){if(124!==(o=e.src.charCodeAt(c))&&45!==o&&58!==o&&!r(o))return!1;c++}for(p=(l=s(e,t+1)).split("|"),f=[],u=0;u<p.length;u++){if(!(y=p[u].trim())){if(0===u||u===p.length-1)continue;return!1}if(!/^:?-+:?$/.test(y))return!1;58===y.charCodeAt(y.length-1)?f.push(58===y.charCodeAt(0)?"center":"right"):58===y.charCodeAt(0)?f.push("left"):f.push("")}if(-1===(l=s(e,t).trim()).indexOf("|"))return!1;if(e.sCount[t]-e.blkIndent>=4)return!1;if((p=i(l)).length&&""===p[0]&&p.shift(),p.length&&""===p[p.length-1]&&p.pop(),0===(g=p.length)||g!==f.length)return!1;if(a)return!0;for(C=e.parentType,e.parentType="table",S=e.md.block.ruler.getRules("blockquote"),(m=e.push("table_open","table",1)).map=v=[t,0],(m=e.push("thead_open","thead",1)).map=[t,t+1],(m=e.push("tr_open","tr",1)).map=[t,t+1],u=0;u<p.length;u++)m=e.push("th_open","th",1),f[u]&&(m.attrs=[["style","text-align:"+f[u]]]),(m=e.push("inline","",0)).content=p[u].trim(),m.children=[],m=e.push("th_close","th",-1);for(m=e.push("tr_close","tr",-1),m=e.push("thead_close","thead",-1),h=t+2;h<n&&!(e.sCount[h]<e.blkIndent);h++){for(w=!1,u=0,d=S.length;u<d;u++)if(S[u](e,h,n,!0)){w=!0;break}if(w)break;if(!(l=s(e,h).trim()))break;if(e.sCount[h]-e.blkIndent>=4)break;for((p=i(l)).length&&""===p[0]&&p.shift(),p.length&&""===p[p.length-1]&&p.pop(),h===t+2&&((m=e.push("tbody_open","tbody",1)).map=b=[t+2,0]),(m=e.push("tr_open","tr",1)).map=[h,h+1],u=0;u<g;u++)m=e.push("td_open","td",1),f[u]&&(m.attrs=[["style","text-align:"+f[u]]]),(m=e.push("inline","",0)).content=p[u]?p[u].trim():"",m.children=[],m=e.push("td_close","td",-1);m=e.push("tr_close","tr",-1)}return b&&(m=e.push("tbody_close","tbody",-1),b[1]=h),m=e.push("table_close","table",-1),v[1]=h,e.parentType=C,e.line=h,!0}},70408:(e,t,n)=>{"use strict";function r(e,t,n,r){var s=r?" !== ":" === ",i=r?" || ":" && ",a=r?"!":"",o=r?"":"!";switch(e){case"null":return t+s+"null";case"array":return a+"Array.isArray("+t+")";case"object":return"("+a+t+i+"typeof "+t+s+'"object"'+i+o+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+s+'"number"'+i+o+"("+t+" % 1)"+i+t+s+t+(n?i+a+"isFinite("+t+")":"")+")";case"number":return"(typeof "+t+s+'"'+e+'"'+(n?i+a+"isFinite("+t+")":"")+")";default:return"typeof "+t+s+'"'+e+'"'}}e.exports={copy:function(e,t){for(var n in t=t||{},e)t[n]=e[n];return t},checkDataType:r,checkDataTypes:function(e,t,n){if(1===e.length)return r(e[0],t,n,!0);var s="",a=i(e);for(var o in a.array&&a.object&&(s=a.null?"(":"(!"+t+" || ",s+="typeof "+t+' !== "object")',delete a.null,delete a.array,delete a.object),a.number&&delete a.integer,a)s+=(s?" && ":"")+r(o,t,n,!0);return s},coerceToTypes:function(e,t){if(Array.isArray(t)){for(var n=[],r=0;r<t.length;r++){var i=t[r];(s[i]||"array"===e&&"array"===i)&&(n[n.length]=i)}if(n.length)return n}else{if(s[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:i,getProperty:l,escapeQuotes:c,equal:n(97288),ucs2length:n(79001),varOccurences:function(e,t){t+="[^0-9]";var n=e.match(new RegExp(t,"g"));return n?n.length:0},varReplace:function(e,t,n){return t+="([^0-9])",n=n.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),n+"$1")},schemaHasRules:function(e,t){if("boolean"==typeof e)return!e;for(var n in e)if(t[n])return!0},schemaHasRulesExcept:function(e,t,n){if("boolean"==typeof e)return!e&&"not"!=n;for(var r in e)if(r!=n&&t[r])return!0},schemaUnknownRules:function(e,t){if("boolean"==typeof e)return;for(var n in e)if(!t[n])return n},toQuotedString:u,getPathExpr:function(e,t,n,r){return p(e,n?"'/' + "+t+(r?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):r?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function(e,t,n){var r=u(n?"/"+g(t):l(t));return p(e,r)},getData:function(e,t,n){var r,s,i,a;if(""===e)return"rootData";if("/"==e[0]){if(!d.test(e))throw new Error("Invalid JSON-pointer: "+e);s=e,i="rootData"}else{if(!(a=e.match(h)))throw new Error("Invalid JSON-pointer: "+e);if(r=+a[1],"#"==(s=a[2])){if(r>=t)throw new Error("Cannot access property/index "+r+" levels up, current level is "+t);return n[t-r]}if(r>t)throw new Error("Cannot access data "+r+" levels up, current level is "+t);if(i="data"+(t-r||""),!s)return i}for(var o=i,c=s.split("/"),u=0;u<c.length;u++){var p=c[u];p&&(o+=" && "+(i+=l(m(p))))}return o},unescapeFragment:function(e){return m(decodeURIComponent(e))},unescapeJsonPointer:m,escapeFragment:function(e){return encodeURIComponent(g(e))},escapeJsonPointer:g};var s=i(["string","number","integer","boolean","null"]);function i(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return t}var a=/^[a-z$_][a-z$_0-9]*$/i,o=/'|\\/g;function l(e){return"number"==typeof e?"["+e+"]":a.test(e)?"."+e:"['"+c(e)+"']"}function c(e){return e.replace(o,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function u(e){return"'"+c(e)+"'"}var d=/^\/(?:[^~]|~0|~1)*$/,h=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function p(e,t){return'""'==e?t:(e+" + "+t).replace(/([^\\])' \+ '/g,"$1")}function g(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function m(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}},71491:(e,t,n)=>{"use strict";n.d(t,{CX:()=>r,Es:()=>i,T2:()=>o,gY:()=>s,zr:()=>a});const r="Something went wrong.",s="&wdtf=+Microsoft.Office.PowerPointOnline.FA000000129.HandoffEnabled:true;+Microsoft.Office.SharedOnline.HandoffEnabled:true;+Microsoft.Office.PowerPointOnline.FA000000129.HandoffAddOnFeaturesEnabled:true",i="Select the topics",a="Select the topics you want to include in the outline",o="Handoff"},72041:e=>{"use strict";e.exports=function(e,t,n){var r,s=" ",i=e.level,a=e.dataLevel,o=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&o&&o.$data;h?(s+=" var schema"+i+" = "+e.util.getData(o.$data,a,e.dataPathArr)+"; ",r="schema"+i):r=o,s+="if ( ",h&&(s+=" ("+r+" !== undefined && typeof "+r+" != 'string') || "),s+=" !"+(h?"(new RegExp("+r+"))":e.usePattern(o))+".test("+d+") ) {   ";var p=p||[];p.push(s),s="",!1!==e.createErrors?(s+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { pattern:  ",s+=h?""+r:""+e.util.toQuotedString(o),s+="  } ",!1!==e.opts.messages&&(s+=" , message: 'should match pattern \"",s+=h?"' + "+r+" + '":""+e.util.escapeQuotes(o),s+="\"' "),e.opts.verbose&&(s+=" , schema:  ",s+=h?"validate.schema"+l:""+e.util.toQuotedString(o),s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),s+=" } "):s+=" {} ";var g=s;return s=p.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+g+"]); ":s+=" validate.errors = ["+g+"]; return false; ":s+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",u&&(s+=" else { "),s}},73627:(e,t,n)=>{"use strict";var r=n(41759);function s(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}s.prototype.Token=r,e.exports=s},73890:(e,t,n)=>{"use strict";var r=n(70408),s=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=[0,31,28,31,30,31,30,31,31,30,31,30,31],a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,o=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,l=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,c=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,u=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-)*(?:[0-9a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[a-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,d=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,h=/^(?:\/(?:[^~/]|~0|~1)*)*$/,p=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,g=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function m(e){return e="full"==e?"full":"fast",r.copy(m[e])}function f(e){var t=e.match(s);if(!t)return!1;var n=+t[1],r=+t[2],a=+t[3];return r>=1&&r<=12&&a>=1&&a<=(2==r&&function(e){return e%4==0&&(e%100!=0||e%400==0)}(n)?29:i[r])}function y(e,t){var n=e.match(a);if(!n)return!1;var r=n[1],s=n[2],i=n[3],o=n[5];return(r<=23&&s<=59&&i<=59||23==r&&59==s&&60==i)&&(!t||o)}e.exports=m,m.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":c,url:u,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:o,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:w,uuid:d,"json-pointer":h,"json-pointer-uri-fragment":p,"relative-json-pointer":g},m.full={date:f,time:y,"date-time":function(e){var t=e.split(v);return 2==t.length&&f(t[0])&&y(t[1],!0)},uri:function(e){return b.test(e)&&l.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":c,url:u,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:o,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:w,uuid:d,"json-pointer":h,"json-pointer-uri-fragment":p,"relative-json-pointer":g};var v=/t|\s/i;var b=/\/|:/;var C=/[^\\]\\Z/;function w(e){if(C.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}},74251:e=>{"use strict";e.exports=function(e){var t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&-1!==e.hostname.indexOf(":")?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||""}},74450:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.schema[t],i=e.errSchemaPath+"/"+t,a=(e.opts.allErrors,e.util.toQuotedString(s));return!0===e.opts.$comment?r+=" console.log("+a+");":"function"==typeof e.opts.$comment&&(r+=" self._opts.$comment("+a+", "+e.util.toQuotedString(i)+", validate.root.schema);"),r}},74666:(e,t,n)=>{"use strict";var r=n(87423).isSpace;e.exports=function(e,t){var n,s,i,a=e.pos;if(10!==e.src.charCodeAt(a))return!1;if(n=e.pending.length-1,s=e.posMax,!t)if(n>=0&&32===e.pending.charCodeAt(n))if(n>=1&&32===e.pending.charCodeAt(n-1)){for(i=n-1;i>=1&&32===e.pending.charCodeAt(i-1);)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(a++;a<s&&r(e.src.charCodeAt(a));)a++;return e.pos=a,!0}},76263:e=>{"use strict";e.exports=function(e){var t,n,r,s=e.tokens;for(n=0,r=s.length;n<r;n++)"inline"===(t=s[n]).type&&e.md.inline.parse(t.content,e.md,e.env,t.children)}},76988:e=>{"use strict";e.exports=function(e,t,n){var r,s,i=" ",a=e.level,o=e.dataLevel,l=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,h="data"+(o||""),p="valid"+a,g="errs__"+a,m=e.opts.$data&&l&&l.$data;m?(i+=" var schema"+a+" = "+e.util.getData(l.$data,o,e.dataPathArr)+"; ",s="schema"+a):s=l;var f,y,v,b,C,w=this,S="definition"+a,E=w.definition,x="";if(m&&E.$data){C="keywordValidate"+a;var I=E.validateSchema;i+=" var "+S+" = RULES.custom['"+t+"'].definition; var "+C+" = "+S+".validate;"}else{if(!(b=e.useCustomRule(w,l,e.schema,e)))return;s="validate.schema"+c,C=b.code,f=E.compile,y=E.inline,v=E.macro}var A=C+".errors",P="i"+a,k="ruleErr"+a,T=E.async;if(T&&!e.async)throw new Error("async keyword in sync schema");if(y||v||(i+=A+" = null;"),i+="var "+g+" = errors;var "+p+";",m&&E.$data&&(x+="}",i+=" if ("+s+" === undefined) { "+p+" = true; } else { ",I&&(x+="}",i+=" "+p+" = "+S+".validateSchema("+s+"); if ("+p+") { ")),y)E.statements?i+=" "+b.validate+" ":i+=" "+p+" = "+b.validate+"; ";else if(v){var D=e.util.copy(e);x="";D.level++;var M="valid"+D.level;D.schema=b.validate,D.schemaPath="";var L=e.compositeRule;e.compositeRule=D.compositeRule=!0;var R=e.validate(D).replace(/validate\.schema/g,C);e.compositeRule=D.compositeRule=L,i+=" "+R}else{(B=B||[]).push(i),i="",i+="  "+C+".call( ",e.opts.passContext?i+="this":i+="self",f||!1===E.schema?i+=" , "+h+" ":i+=" , "+s+" , "+h+" , validate.schema"+e.schemaPath+" ",i+=" , (dataPath || '')",'""'!=e.errorPath&&(i+=" + "+e.errorPath);var N=o?"data"+(o-1||""):"parentData",O=o?e.dataPathArr[o]:"parentDataProperty",_=i+=" , "+N+" , "+O+" , rootData )  ";i=B.pop(),!1===E.errors?(i+=" "+p+" = ",T&&(i+="await "),i+=_+"; "):i+=T?" var "+(A="customErrors"+a)+" = null; try { "+p+" = await "+_+"; } catch (e) { "+p+" = false; if (e instanceof ValidationError) "+A+" = e.errors; else throw e; } ":" "+A+" = null; "+p+" = "+_+"; "}if(E.modifying&&(i+=" if ("+N+") "+h+" = "+N+"["+O+"];"),i+=""+x,E.valid)d&&(i+=" if (true) { ");else{var B;i+=" if ( ",void 0===E.valid?(i+=" !",i+=v?""+M:""+p):i+=" "+!E.valid+" ",i+=") { ",r=w.keyword,(B=B||[]).push(i),i="",(B=B||[]).push(i),i="",!1!==e.createErrors?(i+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+w.keyword+"' } ",!1!==e.opts.messages&&(i+=" , message: 'should pass \""+w.keyword+"\" keyword validation' "),e.opts.verbose&&(i+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ";var F=i;i=B.pop(),!e.compositeRule&&d?e.async?i+=" throw new ValidationError(["+F+"]); ":i+=" validate.errors = ["+F+"]; return false; ":i+=" var err = "+F+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var U=i;i=B.pop(),y?E.errors?"full"!=E.errors&&(i+="  for (var "+P+"="+g+"; "+P+"<errors; "+P+"++) { var "+k+" = vErrors["+P+"]; if ("+k+".dataPath === undefined) "+k+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+k+".schemaPath === undefined) { "+k+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(i+=" "+k+".schema = "+s+"; "+k+".data = "+h+"; "),i+=" } "):!1===E.errors?i+=" "+U+" ":(i+=" if ("+g+" == errors) { "+U+" } else {  for (var "+P+"="+g+"; "+P+"<errors; "+P+"++) { var "+k+" = vErrors["+P+"]; if ("+k+".dataPath === undefined) "+k+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+k+".schemaPath === undefined) { "+k+'.schemaPath = "'+u+'"; } ',e.opts.verbose&&(i+=" "+k+".schema = "+s+"; "+k+".data = "+h+"; "),i+=" } } "):v?(i+="   var err =   ",!1!==e.createErrors?(i+=" { keyword: '"+(r||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { keyword: '"+w.keyword+"' } ",!1!==e.opts.messages&&(i+=" , message: 'should pass \""+w.keyword+"\" keyword validation' "),e.opts.verbose&&(i+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ",i+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&d&&(e.async?i+=" throw new ValidationError(vErrors); ":i+=" validate.errors = vErrors; return false; ")):!1===E.errors?i+=" "+U+" ":(i+=" if (Array.isArray("+A+")) { if (vErrors === null) vErrors = "+A+"; else vErrors = vErrors.concat("+A+"); errors = vErrors.length;  for (var "+P+"="+g+"; "+P+"<errors; "+P+"++) { var "+k+" = vErrors["+P+"]; if ("+k+".dataPath === undefined) "+k+".dataPath = (dataPath || '') + "+e.errorPath+";  "+k+'.schemaPath = "'+u+'";  ',e.opts.verbose&&(i+=" "+k+".schema = "+s+"; "+k+".data = "+h+"; "),i+=" } } else { "+U+" } "),i+=" } ",d&&(i+=" else { ")}return i}},77043:(e,t,n)=>{"use strict";var r=n(95906);function s(e,t,n){this.message=n||s.message(e,t),this.missingRef=r.url(e,t),this.missingSchema=r.normalizeId(r.fullPath(this.missingRef))}function i(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}e.exports={Validation:i((function(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0})),MissingRef:i(s)},s.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},78683:e=>{"use strict";e.exports={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","text_collapse"]}}}},79001:e=>{"use strict";e.exports=function(e){for(var t,n=0,r=e.length,s=0;s<r;)n++,(t=e.charCodeAt(s++))>=55296&&t<=56319&&s<r&&56320==(64512&(t=e.charCodeAt(s)))&&s++;return n}},80151:(e,t,n)=>{"use strict";var r=n(87423).normalizeReference,s=n(87423).isSpace;e.exports=function(e,t){var n,i,a,o,l,c,u,d,h,p,g,m,f,y="",v=e.pos,b=e.posMax;if(33!==e.src.charCodeAt(e.pos))return!1;if(91!==e.src.charCodeAt(e.pos+1))return!1;if(c=e.pos+2,(l=e.md.helpers.parseLinkLabel(e,e.pos+1,!1))<0)return!1;if((u=l+1)<b&&40===e.src.charCodeAt(u)){for(u++;u<b&&(i=e.src.charCodeAt(u),s(i)||10===i);u++);if(u>=b)return!1;for(f=u,(h=e.md.helpers.parseLinkDestination(e.src,u,e.posMax)).ok&&(y=e.md.normalizeLink(h.str),e.md.validateLink(y)?u=h.pos:y=""),f=u;u<b&&(i=e.src.charCodeAt(u),s(i)||10===i);u++);if(h=e.md.helpers.parseLinkTitle(e.src,u,e.posMax),u<b&&f!==u&&h.ok)for(p=h.str,u=h.pos;u<b&&(i=e.src.charCodeAt(u),s(i)||10===i);u++);else p="";if(u>=b||41!==e.src.charCodeAt(u))return e.pos=v,!1;u++}else{if(void 0===e.env.references)return!1;if(u<b&&91===e.src.charCodeAt(u)?(f=u+1,(u=e.md.helpers.parseLinkLabel(e,u))>=0?o=e.src.slice(f,u++):u=l+1):u=l+1,o||(o=e.src.slice(c,l)),!(d=e.env.references[r(o)]))return e.pos=v,!1;y=d.href,p=d.title}return t||(a=e.src.slice(c,l),e.md.inline.parse(a,e.md,e.env,m=[]),(g=e.push("image","img",0)).attrs=n=[["src",y],["alt",""]],g.children=m,g.content=a,p&&n.push(["title",p])),e.pos=u,e.posMax=b,!0}},82518:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="errs__"+s,h=e.util.copy(e);h.level++;var p="valid"+h.level;if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=o,h.errSchemaPath=l,r+=" var "+d+" = errors;  ";var g,m=e.compositeRule;e.compositeRule=h.compositeRule=!0,h.createErrors=!1,h.opts.allErrors&&(g=h.opts.allErrors,h.opts.allErrors=!1),r+=" "+e.validate(h)+" ",h.createErrors=!0,g&&(h.opts.allErrors=g),e.compositeRule=h.compositeRule=m,r+=" if ("+p+") {   ";var f=f||[];f.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var y=r;r=f.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(r+=" } ")}else r+="  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'should NOT be valid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(r+=" if (false) { ");return r}},83659:e=>{"use strict";e.exports=function(e,t,n){var r,s=" ",i=e.level,a=e.dataLevel,o=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&o&&o.$data;if(h?(s+=" var schema"+i+" = "+e.util.getData(o.$data,a,e.dataPathArr)+"; ",r="schema"+i):r=o,!h&&"number"!=typeof o)throw new Error(t+" must be number");s+="if ( ",h&&(s+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),s+=" "+d+".length "+("maxItems"==t?">":"<")+" "+r+") { ";var p=t,g=g||[];g.push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(p||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==e.opts.messages&&(s+=" , message: 'should NOT have ",s+="maxItems"==t?"more":"fewer",s+=" than ",s+=h?"' + "+r+" + '":""+o,s+=" items' "),e.opts.verbose&&(s+=" , schema:  ",s+=h?"validate.schema"+l:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),s+=" } "):s+=" {} ";var m=s;return s=g.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+m+"]); ":s+=" validate.errors = ["+m+"]; return false; ":s+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",u&&(s+=" else { "),s}},83786:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="errs__"+s,h=e.util.copy(e),p="";h.level++;var g="valid"+h.level,m={},f={},y=e.opts.ownProperties;for(w in a)if("__proto__"!=w){var v=a[w],b=Array.isArray(v)?f:m;b[w]=v}r+="var "+d+" = errors;";var C=e.errorPath;for(var w in r+="var missing"+s+";",f)if((b=f[w]).length){if(r+=" if ( "+u+e.util.getProperty(w)+" !== undefined ",y&&(r+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(w)+"') "),c){r+=" && ( ";var S=b;if(S)for(var E=-1,x=S.length-1;E<x;){D=S[E+=1],E&&(r+=" || "),r+=" ( ( "+(N=u+(R=e.util.getProperty(D)))+" === undefined ",y&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(D)+"') "),r+=") && (missing"+s+" = "+e.util.toQuotedString(e.opts.jsonPointers?D:R)+") ) "}r+=")) {  ";var I="missing"+s,A="' + "+I+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(C,I,!0):C+" + "+I);var P=P||[];P.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(w)+"', missingProperty: '"+A+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==b.length?r+="property "+e.util.escapeQuotes(b[0]):r+="properties "+e.util.escapeQuotes(b.join(", ")),r+=" when property "+e.util.escapeQuotes(w)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var k=r;r=P.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+k+"]); ":r+=" validate.errors = ["+k+"]; return false; ":r+=" var err = "+k+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{r+=" ) { ";var T=b;if(T)for(var D,M=-1,L=T.length-1;M<L;){D=T[M+=1];var R=e.util.getProperty(D),N=(A=e.util.escapeQuotes(D),u+R);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(C,D,e.opts.jsonPointers)),r+=" if ( "+N+" === undefined ",y&&(r+=" || ! Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(D)+"') "),r+=") {  var err =   ",!1!==e.createErrors?(r+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { property: '"+e.util.escapeQuotes(w)+"', missingProperty: '"+A+"', depsCount: "+b.length+", deps: '"+e.util.escapeQuotes(1==b.length?b[0]:b.join(", "))+"' } ",!1!==e.opts.messages&&(r+=" , message: 'should have ",1==b.length?r+="property "+e.util.escapeQuotes(b[0]):r+="properties "+e.util.escapeQuotes(b.join(", ")),r+=" when property "+e.util.escapeQuotes(w)+" is present' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}r+=" }   ",c&&(p+="}",r+=" else { ")}e.errorPath=C;var O=h.baseId;for(var w in m){v=m[w];(e.opts.strictKeywords?"object"==typeof v&&Object.keys(v).length>0||!1===v:e.util.schemaHasRules(v,e.RULES.all))&&(r+=" "+g+" = true; if ( "+u+e.util.getProperty(w)+" !== undefined ",y&&(r+=" && Object.prototype.hasOwnProperty.call("+u+", '"+e.util.escapeQuotes(w)+"') "),r+=") { ",h.schema=v,h.schemaPath=o+e.util.getProperty(w),h.errSchemaPath=l+"/"+e.util.escapeFragment(w),r+="  "+e.validate(h)+" ",h.baseId=O,r+=" }  ",c&&(r+=" if ("+g+") { ",p+="}"))}return c&&(r+="   "+p+" if ("+d+" == errors) {"),r}},84283:(e,t,n)=>{"use strict";var r=n(41759),s=n(87423).isSpace;function i(e,t,n,r){var i,a,o,l,c,u,d,h;for(this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0,this.result="",h=!1,o=l=u=d=0,c=(a=this.src).length;l<c;l++){if(i=a.charCodeAt(l),!h){if(s(i)){u++,9===i?d+=4-d%4:d++;continue}h=!0}10!==i&&l!==c-1||(10!==i&&l++,this.bMarks.push(o),this.eMarks.push(l),this.tShift.push(u),this.sCount.push(d),this.bsCount.push(0),h=!1,u=0,d=0,o=l+1)}this.bMarks.push(a.length),this.eMarks.push(a.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}i.prototype.push=function(e,t,n){var s=new r(e,t,n);return s.block=!0,n<0&&this.level--,s.level=this.level,n>0&&this.level++,this.tokens.push(s),s},i.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]},i.prototype.skipEmptyLines=function(e){for(var t=this.lineMax;e<t&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e},i.prototype.skipSpaces=function(e){for(var t,n=this.src.length;e<n&&(t=this.src.charCodeAt(e),s(t));e++);return e},i.prototype.skipSpacesBack=function(e,t){if(e<=t)return e;for(;e>t;)if(!s(this.src.charCodeAt(--e)))return e+1;return e},i.prototype.skipChars=function(e,t){for(var n=this.src.length;e<n&&this.src.charCodeAt(e)===t;e++);return e},i.prototype.skipCharsBack=function(e,t,n){if(e<=n)return e;for(;e>n;)if(t!==this.src.charCodeAt(--e))return e+1;return e},i.prototype.getLines=function(e,t,n,r){var i,a,o,l,c,u,d,h=e;if(e>=t)return"";for(u=new Array(t-e),i=0;h<t;h++,i++){for(a=0,d=l=this.bMarks[h],c=h+1<t||r?this.eMarks[h]+1:this.eMarks[h];l<c&&a<n;){if(o=this.src.charCodeAt(l),s(o))9===o?a+=4-(a+this.bsCount[h])%4:a++;else{if(!(l-d<this.tShift[h]))break;a++}l++}u[i]=a>n?new Array(a-n+1).join(" ")+this.src.slice(l,c):this.src.slice(l,c)}return u.join("")},i.prototype.Token=r,e.exports=i},85445:(e,t,n)=>{"use strict";var r=n(25681).l;e.exports=function(e,t){var n,s,i,a=e.pos;return!!e.md.options.html&&(i=e.posMax,!(60!==e.src.charCodeAt(a)||a+2>=i)&&(!(33!==(n=e.src.charCodeAt(a+1))&&63!==n&&47!==n&&!function(e){var t=32|e;return t>=97&&t<=122}(n))&&(!!(s=e.src.slice(a).match(r))&&(t||(e.push("html_inline","",0).content=e.src.slice(a,a+s[0].length)),e.pos+=s[0].length,!0))))}},85542:e=>{"use strict";function t(){this.__rules__=[],this.__cache__=null}t.prototype.__find__=function(e){for(var t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1},t.prototype.__compile__=function(){var e=this,t=[""];e.__rules__.forEach((function(e){e.enabled&&e.alt.forEach((function(e){t.indexOf(e)<0&&t.push(e)}))})),e.__cache__={},t.forEach((function(t){e.__cache__[t]=[],e.__rules__.forEach((function(n){n.enabled&&(t&&n.alt.indexOf(t)<0||e.__cache__[t].push(n.fn))}))}))},t.prototype.at=function(e,t,n){var r=this.__find__(e),s=n||{};if(-1===r)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=s.alt||[],this.__cache__=null},t.prototype.before=function(e,t,n,r){var s=this.__find__(e),i=r||{};if(-1===s)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},t.prototype.after=function(e,t,n,r){var s=this.__find__(e),i=r||{};if(-1===s)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null},t.prototype.push=function(e,t,n){var r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null},t.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);var n=[];return e.forEach((function(e){var r=this.__find__(e);if(r<0){if(t)return;throw new Error("Rules manager: invalid rule name "+e)}this.__rules__[r].enabled=!0,n.push(e)}),this),this.__cache__=null,n},t.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach((function(e){e.enabled=!1})),this.enable(e,t)},t.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);var n=[];return e.forEach((function(e){var r=this.__find__(e);if(r<0){if(t)return;throw new Error("Rules manager: invalid rule name "+e)}this.__rules__[r].enabled=!1,n.push(e)}),this),this.__cache__=null,n},t.prototype.getRules=function(e){return null===this.__cache__&&this.__compile__(),this.__cache__[e]||[]},e.exports=t},85557:e=>{"use strict";e.exports={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"“”‘’",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","text_collapse"]}}}},86143:e=>{"use strict";var t=/\r\n?|\n/g,n=/\0/g;e.exports=function(e){var r;r=(r=e.src.replace(t,"\n")).replace(n,"�"),e.src=r}},86215:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="valid"+s,h="errs__"+s,p=e.util.copy(e),g="";p.level++;var m="valid"+p.level,f="i"+s,y=p.dataLevel=e.dataLevel+1,v="data"+y,b=e.baseId;if(r+="var "+h+" = errors;var "+d+";",Array.isArray(a)){var C=e.schema.additionalItems;if(!1===C){r+=" "+d+" = "+u+".length <= "+a.length+"; ";var w=l;l=e.errSchemaPath+"/additionalItems",r+="  if (!"+d+") {   ";var S=S||[];S.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { limit: "+a.length+" } ",!1!==e.opts.messages&&(r+=" , message: 'should NOT have more than "+a.length+" items' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var E=r;r=S.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+E+"]); ":r+=" validate.errors = ["+E+"]; return false; ":r+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } ",l=w,c&&(g+="}",r+=" else { ")}var x=a;if(x)for(var I,A=-1,P=x.length-1;A<P;)if(I=x[A+=1],e.opts.strictKeywords?"object"==typeof I&&Object.keys(I).length>0||!1===I:e.util.schemaHasRules(I,e.RULES.all)){r+=" "+m+" = true; if ("+u+".length > "+A+") { ";var k=u+"["+A+"]";p.schema=I,p.schemaPath=o+"["+A+"]",p.errSchemaPath=l+"/"+A,p.errorPath=e.util.getPathExpr(e.errorPath,A,e.opts.jsonPointers,!0),p.dataPathArr[y]=A;var T=e.validate(p);p.baseId=b,e.util.varOccurences(T,v)<2?r+=" "+e.util.varReplace(T,v,k)+" ":r+=" var "+v+" = "+k+"; "+T+" ",r+=" }  ",c&&(r+=" if ("+m+") { ",g+="}")}if("object"==typeof C&&(e.opts.strictKeywords?"object"==typeof C&&Object.keys(C).length>0||!1===C:e.util.schemaHasRules(C,e.RULES.all))){p.schema=C,p.schemaPath=e.schemaPath+".additionalItems",p.errSchemaPath=e.errSchemaPath+"/additionalItems",r+=" "+m+" = true; if ("+u+".length > "+a.length+") {  for (var "+f+" = "+a.length+"; "+f+" < "+u+".length; "+f+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers,!0);k=u+"["+f+"]";p.dataPathArr[y]=f;T=e.validate(p);p.baseId=b,e.util.varOccurences(T,v)<2?r+=" "+e.util.varReplace(T,v,k)+" ":r+=" var "+v+" = "+k+"; "+T+" ",c&&(r+=" if (!"+m+") break; "),r+=" } }  ",c&&(r+=" if ("+m+") { ",g+="}")}}else if(e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){p.schema=a,p.schemaPath=o,p.errSchemaPath=l,r+="  for (var "+f+" = 0; "+f+" < "+u+".length; "+f+"++) { ",p.errorPath=e.util.getPathExpr(e.errorPath,f,e.opts.jsonPointers,!0);k=u+"["+f+"]";p.dataPathArr[y]=f;T=e.validate(p);p.baseId=b,e.util.varOccurences(T,v)<2?r+=" "+e.util.varReplace(T,v,k)+" ":r+=" var "+v+" = "+k+"; "+T+" ",c&&(r+=" if (!"+m+") break; "),r+=" }"}return c&&(r+=" "+g+" if ("+h+" == errors) {"),r}},86506:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="valid"+s,h=e.opts.$data&&a&&a.$data;h&&(r+=" var schema"+s+" = "+e.util.getData(a.$data,i,e.dataPathArr)+"; ");var p="i"+s,g="schema"+s;h||(r+=" var "+g+" = validate.schema"+o+";"),r+="var "+d+";",h&&(r+=" if (schema"+s+" === undefined) "+d+" = true; else if (!Array.isArray(schema"+s+")) "+d+" = false; else {"),r+=d+" = false;for (var "+p+"=0; "+p+"<"+g+".length; "+p+"++) if (equal("+u+", "+g+"["+p+"])) { "+d+" = true; break; }",h&&(r+="  }  "),r+=" if (!"+d+") {   ";var m=m||[];m.push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { allowedValues: schema"+s+" } ",!1!==e.opts.messages&&(r+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ";var f=r;return r=m.pop(),!e.compositeRule&&c?e.async?r+=" throw new ValidationError(["+f+"]); ":r+=" validate.errors = ["+f+"]; return false; ":r+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" }",c&&(r+=" else { "),r}},86725:(e,t,n)=>{"use strict";var r=n(70408);e.exports=function(e){r.copy(e,this)}},87423:(e,t,n)=>{"use strict";var r=Object.prototype.hasOwnProperty;function s(e,t){return r.call(e,t)}function i(e){return!(e>=55296&&e<=57343)&&(!(e>=64976&&e<=65007)&&(!!(65535&~e&&65534!=(65535&e))&&(!(e>=0&&e<=8)&&(11!==e&&(!(e>=14&&e<=31)&&(!(e>=127&&e<=159)&&!(e>1114111)))))))}function a(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}var o=/\\([!"#$%&'()*+,\-.\/:;<=>?@[\\\]^_`{|}~])/g,l=new RegExp(o.source+"|"+/&([a-z#][a-z0-9]{1,31});/gi.source,"gi"),c=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i,u=n(52211);var d=/[&<>"]/,h=/[&<>"]/g,p={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function g(e){return p[e]}var m=/[.?*+^$[\]\\(){}|-]/g;var f=n(16277);t.lib={},t.lib.mdurl=n(48954),t.lib.ucmicro=n(46903),t.assign=function(e){return Array.prototype.slice.call(arguments,1).forEach((function(t){if(t){if("object"!=typeof t)throw new TypeError(t+"must be object");Object.keys(t).forEach((function(n){e[n]=t[n]}))}})),e},t.isString=function(e){return"[object String]"===function(e){return Object.prototype.toString.call(e)}(e)},t.has=s,t.unescapeMd=function(e){return e.indexOf("\\")<0?e:e.replace(o,"$1")},t.unescapeAll=function(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(l,(function(e,t,n){return t||function(e,t){var n=0;return s(u,t)?u[t]:35===t.charCodeAt(0)&&c.test(t)&&i(n="x"===t[1].toLowerCase()?parseInt(t.slice(2),16):parseInt(t.slice(1),10))?a(n):e}(e,n)}))},t.isValidEntityCode=i,t.fromCodePoint=a,t.escapeHtml=function(e){return d.test(e)?e.replace(h,g):e},t.arrayReplaceAt=function(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))},t.isSpace=function(e){switch(e){case 9:case 32:return!0}return!1},t.isWhiteSpace=function(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1},t.isMdAsciiPunct=function(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}},t.isPunctChar=function(e){return f.test(e)},t.escapeRE=function(e){return e.replace(m,"\\$&")},t.normalizeReference=function(e){return e=e.trim().replace(/\s+/g," "),"Ṿ"==="ẞ".toLowerCase()&&(e=e.replace(/ẞ/g,"ß")),e.toLowerCase().toUpperCase()}},87581:(e,t,n)=>{"use strict";var r=n(7618);e.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:r.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:r.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}},87789:e=>{"use strict";e.exports=function(e,t,n){var r="",s=!0===e.schema.$async,i=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),a=e.self._getId(e.schema);if(e.opts.strictKeywords){var o=e.util.schemaUnknownRules(e.schema,e.RULES.keywords);if(o){var l="unknown keyword: "+o;if("log"!==e.opts.strictKeywords)throw new Error(l);e.logger.warn(l)}}if(e.isTop&&(r+=" var validate = ",s&&(e.async=!0,r+="async "),r+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",a&&(e.opts.sourceCode||e.opts.processCode)&&(r+=" /*# sourceURL="+a+" */ ")),"boolean"==typeof e.schema||!i&&!e.schema.$ref){t="false schema";var c=e.level,u=e.dataLevel,d=e.schema[t],h=e.schemaPath+e.util.getProperty(t),p=e.errSchemaPath+"/"+t,g=!e.opts.allErrors,m="data"+(u||""),f="valid"+c;if(!1===e.schema){e.isTop?g=!0:r+=" var "+f+" = false; ",(K=K||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'false schema' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: {} ",!1!==e.opts.messages&&(r+=" , message: 'boolean schema is false' "),e.opts.verbose&&(r+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";var y=r;r=K.pop(),!e.compositeRule&&g?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?r+=s?" return data; ":" validate.errors = null; return true; ":r+=" var "+f+" = true; ";return e.isTop&&(r+=" }; return validate; "),r}if(e.isTop){var v=e.isTop;c=e.level=0,u=e.dataLevel=0,m="data";if(e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[""],void 0!==e.schema.default&&e.opts.useDefaults&&e.opts.strictDefaults){var b="default is ignored in the schema root";if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}r+=" var vErrors = null; ",r+=" var errors = 0;     ",r+=" if (rootData === undefined) rootData = data; "}else{c=e.level,m="data"+((u=e.dataLevel)||"");if(a&&(e.baseId=e.resolve.url(e.baseId,a)),s&&!e.async)throw new Error("async schema in sync schema");r+=" var errs_"+c+" = errors;"}f="valid"+c,g=!e.opts.allErrors;var C="",w="",S=e.schema.type,E=Array.isArray(S);if(S&&e.opts.nullable&&!0===e.schema.nullable&&(E?-1==S.indexOf("null")&&(S=S.concat("null")):"null"!=S&&(S=[S,"null"],E=!0)),E&&1==S.length&&(S=S[0],E=!1),e.schema.$ref&&i){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(i=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(r+=" "+e.RULES.all.$comment.code(e,"$comment")),S){if(e.opts.coerceTypes)var x=e.util.coerceToTypes(e.opts.coerceTypes,S);var I=e.RULES.types[S];if(x||E||!0===I||I&&!J(I)){h=e.schemaPath+".type",p=e.errSchemaPath+"/type",h=e.schemaPath+".type",p=e.errSchemaPath+"/type";var A=E?"checkDataTypes":"checkDataType";if(r+=" if ("+e.util[A](S,m,e.opts.strictNumbers,!0)+") { ",x){var P="dataType"+c,k="coerced"+c;r+=" var "+P+" = typeof "+m+"; var "+k+" = undefined; ","array"==e.opts.coerceTypes&&(r+=" if ("+P+" == 'object' && Array.isArray("+m+") && "+m+".length == 1) { "+m+" = "+m+"[0]; "+P+" = typeof "+m+"; if ("+e.util.checkDataType(e.schema.type,m,e.opts.strictNumbers)+") "+k+" = "+m+"; } "),r+=" if ("+k+" !== undefined) ; ";var T=x;if(T)for(var D,M=-1,L=T.length-1;M<L;)"string"==(D=T[M+=1])?r+=" else if ("+P+" == 'number' || "+P+" == 'boolean') "+k+" = '' + "+m+"; else if ("+m+" === null) "+k+" = ''; ":"number"==D||"integer"==D?(r+=" else if ("+P+" == 'boolean' || "+m+" === null || ("+P+" == 'string' && "+m+" && "+m+" == +"+m+" ","integer"==D&&(r+=" && !("+m+" % 1)"),r+=")) "+k+" = +"+m+"; "):"boolean"==D?r+=" else if ("+m+" === 'false' || "+m+" === 0 || "+m+" === null) "+k+" = false; else if ("+m+" === 'true' || "+m+" === 1) "+k+" = true; ":"null"==D?r+=" else if ("+m+" === '' || "+m+" === 0 || "+m+" === false) "+k+" = null; ":"array"==e.opts.coerceTypes&&"array"==D&&(r+=" else if ("+P+" == 'string' || "+P+" == 'number' || "+P+" == 'boolean' || "+m+" == null) "+k+" = ["+m+"]; ");r+=" else {   ",(K=K||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",r+=E?""+S.join(","):""+S,r+="' } ",!1!==e.opts.messages&&(r+=" , message: 'should be ",r+=E?""+S.join(","):""+S,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";y=r;r=K.pop(),!e.compositeRule&&g?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } if ("+k+" !== undefined) {  ";var R=u?"data"+(u-1||""):"parentData";r+=" "+m+" = "+k+"; ",u||(r+="if ("+R+" !== undefined)"),r+=" "+R+"["+(u?e.dataPathArr[u]:"parentDataProperty")+"] = "+k+"; } "}else{(K=K||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",r+=E?""+S.join(","):""+S,r+="' } ",!1!==e.opts.messages&&(r+=" , message: 'should be ",r+=E?""+S.join(","):""+S,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";y=r;r=K.pop(),!e.compositeRule&&g?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}r+=" } "}}if(e.schema.$ref&&!i)r+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",g&&(r+=" } if (errors === ",r+=v?"0":"errs_"+c,r+=") { ",w+="}");else{var N=e.RULES;if(N)for(var O=-1,_=N.length-1;O<_;)if(J(I=N[O+=1])){if(I.type&&(r+=" if ("+e.util.checkDataType(I.type,m,e.opts.strictNumbers)+") { "),e.opts.useDefaults)if("object"==I.type&&e.schema.properties){d=e.schema.properties;var B=Object.keys(d);if(B)for(var F,U=-1,H=B.length-1;U<H;){if(void 0!==(V=d[F=B[U+=1]]).default){var z=m+e.util.getProperty(F);if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+z;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else r+=" if ("+z+" === undefined ","empty"==e.opts.useDefaults&&(r+=" || "+z+" === null || "+z+" === '' "),r+=" ) "+z+" = ","shared"==e.opts.useDefaults?r+=" "+e.useDefault(V.default)+" ":r+=" "+JSON.stringify(V.default)+" ",r+="; "}}}else if("array"==I.type&&Array.isArray(e.schema.items)){var j=e.schema.items;if(j){M=-1;for(var V,q=j.length-1;M<q;)if(void 0!==(V=j[M+=1]).default){z=m+"["+M+"]";if(e.compositeRule){if(e.opts.strictDefaults){b="default is ignored for: "+z;if("log"!==e.opts.strictDefaults)throw new Error(b);e.logger.warn(b)}}else r+=" if ("+z+" === undefined ","empty"==e.opts.useDefaults&&(r+=" || "+z+" === null || "+z+" === '' "),r+=" ) "+z+" = ","shared"==e.opts.useDefaults?r+=" "+e.useDefault(V.default)+" ":r+=" "+JSON.stringify(V.default)+" ",r+="; "}}}var W=I.rules;if(W)for(var Q,G=-1,Z=W.length-1;G<Z;)if(X(Q=W[G+=1])){var Y=Q.code(e,Q.keyword,I.type);Y&&(r+=" "+Y+" ",g&&(C+="}"))}if(g&&(r+=" "+C+" ",C=""),I.type&&(r+=" } ",S&&S===I.type&&!x)){r+=" else { ";var K;h=e.schemaPath+".type",p=e.errSchemaPath+"/type";(K=K||[]).push(r),r="",!1!==e.createErrors?(r+=" { keyword: 'type' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(p)+" , params: { type: '",r+=E?""+S.join(","):""+S,r+="' } ",!1!==e.opts.messages&&(r+=" , message: 'should be ",r+=E?""+S.join(","):""+S,r+="' "),e.opts.verbose&&(r+=" , schema: validate.schema"+h+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+m+" "),r+=" } "):r+=" {} ";y=r;r=K.pop(),!e.compositeRule&&g?e.async?r+=" throw new ValidationError(["+y+"]); ":r+=" validate.errors = ["+y+"]; return false; ":r+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",r+=" } "}g&&(r+=" if (errors === ",r+=v?"0":"errs_"+c,r+=") { ",w+="}")}}function J(e){for(var t=e.rules,n=0;n<t.length;n++)if(X(t[n]))return!0}function X(t){return void 0!==e.schema[t.keyword]||t.implements&&function(t){for(var n=t.implements,r=0;r<n.length;r++)if(void 0!==e.schema[n[r]])return!0}(t)}return g&&(r+=" "+w+" "),v?(s?(r+=" if (errors === 0) return data;           ",r+=" else throw new ValidationError(vErrors); "):(r+=" validate.errors = vErrors; ",r+=" return errors === 0;       "),r+=" }; return validate;"):r+=" var "+f+" = errors === errs_"+c+";",r}},88125:function(e,t){!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length>1){t[0]=t[0].slice(0,-1);for(var r=t.length-1,s=1;s<r;++s)t[s]=t[s].slice(1,-1);return t[r]=t[r].slice(1),t.join("")}return t[0]}function n(e){return"(?:"+e+")"}function r(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function s(e){return e.toUpperCase()}function i(e){return null!=e?e instanceof Array?e:"number"!=typeof e.length||e.split||e.setInterval||e.call?[e]:Array.prototype.slice.call(e):[]}function a(e,t){var n=e;if(t)for(var r in t)n[r]=t[r];return n}function o(e){var r="[A-Za-z]",s="[0-9]",i=t(s,"[A-Fa-f]"),a=n(n("%[EFef]"+i+"%"+i+i+"%"+i+i)+"|"+n("%[89A-Fa-f]"+i+"%"+i+i)+"|"+n("%"+i+i)),o="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",l=t("[\\:\\/\\?\\#\\[\\]\\@]",o),c=e?"[\\uE000-\\uF8FF]":"[]",u=t(r,s,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),d=n(r+t(r,s,"[\\+\\-\\.]")+"*"),h=n(n(a+"|"+t(u,o,"[\\:]"))+"*"),p=(n(n("25[0-5]")+"|"+n("2[0-4]"+s)+"|"+n("1"+s+s)+"|"+n("[1-9]"+s)+"|"+s),n(n("25[0-5]")+"|"+n("2[0-4]"+s)+"|"+n("1"+s+s)+"|"+n("0?[1-9]"+s)+"|0?0?"+s)),g=n(p+"\\."+p+"\\."+p+"\\."+p),m=n(i+"{1,4}"),f=n(n(m+"\\:"+m)+"|"+g),y=n(n(m+"\\:")+"{6}"+f),v=n("\\:\\:"+n(m+"\\:")+"{5}"+f),b=n(n(m)+"?\\:\\:"+n(m+"\\:")+"{4}"+f),C=n(n(n(m+"\\:")+"{0,1}"+m)+"?\\:\\:"+n(m+"\\:")+"{3}"+f),w=n(n(n(m+"\\:")+"{0,2}"+m)+"?\\:\\:"+n(m+"\\:")+"{2}"+f),S=n(n(n(m+"\\:")+"{0,3}"+m)+"?\\:\\:"+m+"\\:"+f),E=n(n(n(m+"\\:")+"{0,4}"+m)+"?\\:\\:"+f),x=n(n(n(m+"\\:")+"{0,5}"+m)+"?\\:\\:"+m),I=n(n(n(m+"\\:")+"{0,6}"+m)+"?\\:\\:"),A=n([y,v,b,C,w,S,E,x,I].join("|")),P=n(n(u+"|"+a)+"+"),k=(n(A+"\\%25"+P),n(A+n("\\%25|\\%(?!"+i+"{2})")+P)),T=n("[vV]"+i+"+\\."+t(u,o,"[\\:]")+"+"),D=n("\\["+n(k+"|"+A+"|"+T)+"\\]"),M=n(n(a+"|"+t(u,o))+"*"),L=n(D+"|"+g+"(?!"+M+")|"+M),R=n(s+"*"),N=n(n(h+"@")+"?"+L+n("\\:"+R)+"?"),O=n(a+"|"+t(u,o,"[\\:\\@]")),_=n(O+"*"),B=n(O+"+"),F=n(n(a+"|"+t(u,o,"[\\@]"))+"+"),U=n(n("\\/"+_)+"*"),H=n("\\/"+n(B+U)+"?"),z=n(F+U),j=n(B+U),V="(?!"+O+")",q=(n(U+"|"+H+"|"+z+"|"+j+"|"+V),n(n(O+"|"+t("[\\/\\?]",c))+"*")),W=n(n(O+"|[\\/\\?]")+"*"),Q=n(n("\\/\\/"+N+U)+"|"+H+"|"+j+"|"+V),G=n(d+"\\:"+Q+n("\\?"+q)+"?"+n("\\#"+W)+"?"),Z=n(n("\\/\\/"+N+U)+"|"+H+"|"+z+"|"+V),Y=n(Z+n("\\?"+q)+"?"+n("\\#"+W)+"?");return n(G+"|"+Y),n(d+"\\:"+Q+n("\\?"+q)+"?"),n(n("\\/\\/("+n("("+h+")@")+"?("+L+")"+n("\\:("+R+")")+"?)")+"?("+U+"|"+H+"|"+j+"|"+V+")"),n("\\?("+q+")"),n("\\#("+W+")"),n(n("\\/\\/("+n("("+h+")@")+"?("+L+")"+n("\\:("+R+")")+"?)")+"?("+U+"|"+H+"|"+z+"|"+V+")"),n("\\?("+q+")"),n("\\#("+W+")"),n(n("\\/\\/("+n("("+h+")@")+"?("+L+")"+n("\\:("+R+")")+"?)")+"?("+U+"|"+H+"|"+j+"|"+V+")"),n("\\?("+q+")"),n("\\#("+W+")"),n("("+h+")@"),n("\\:("+R+")"),{NOT_SCHEME:new RegExp(t("[^]",r,s,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",u,o),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",u,o),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",u,o),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",u,o),"g"),NOT_QUERY:new RegExp(t("[^\\%]",u,o,"[\\:\\@\\/\\?]",c),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",u,o,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",u,o),"g"),UNRESERVED:new RegExp(u,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",u,l),"g"),PCT_ENCODED:new RegExp(a,"g"),IPV4ADDRESS:new RegExp("^("+g+")$"),IPV6ADDRESS:new RegExp("^\\[?("+A+")"+n(n("\\%25|\\%(?!"+i+"{2})")+"("+P+")")+"?\\]?$")}}var l=o(!1),c=o(!0),u=function(){function e(e,t){var n=[],r=!0,s=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(r=(a=o.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){s=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(s)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},h=2147483647,p=36,g=1,m=26,f=38,y=700,v=72,b=128,C="-",w=/^xn--/,S=/[^\0-\x7E]/,E=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=p-g,A=Math.floor,P=String.fromCharCode;function k(e){throw new RangeError(x[e])}function T(e,t){for(var n=[],r=e.length;r--;)n[r]=t(e[r]);return n}function D(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+T((e=e.replace(E,".")).split("."),t).join(".")}function M(e){for(var t=[],n=0,r=e.length;n<r;){var s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){var i=e.charCodeAt(n++);56320==(64512&i)?t.push(((1023&s)<<10)+(1023&i)+65536):(t.push(s),n--)}else t.push(s)}return t}var L=function(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:p},R=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},N=function(e,t,n){var r=0;for(e=n?A(e/y):e>>1,e+=A(e/t);e>I*m>>1;r+=p)e=A(e/I);return A(r+(I+1)*e/(e+f))},O=function(e){var t=[],n=e.length,r=0,s=b,i=v,a=e.lastIndexOf(C);a<0&&(a=0);for(var o=0;o<a;++o)e.charCodeAt(o)>=128&&k("not-basic"),t.push(e.charCodeAt(o));for(var l=a>0?a+1:0;l<n;){for(var c=r,u=1,d=p;;d+=p){l>=n&&k("invalid-input");var f=L(e.charCodeAt(l++));(f>=p||f>A((h-r)/u))&&k("overflow"),r+=f*u;var y=d<=i?g:d>=i+m?m:d-i;if(f<y)break;var w=p-y;u>A(h/w)&&k("overflow"),u*=w}var S=t.length+1;i=N(r-c,S,0==c),A(r/S)>h-s&&k("overflow"),s+=A(r/S),r%=S,t.splice(r++,0,s)}return String.fromCodePoint.apply(String,t)},_=function(e){var t=[],n=(e=M(e)).length,r=b,s=0,i=v,a=!0,o=!1,l=void 0;try{for(var c,u=e[Symbol.iterator]();!(a=(c=u.next()).done);a=!0){var d=c.value;d<128&&t.push(P(d))}}catch(e){o=!0,l=e}finally{try{!a&&u.return&&u.return()}finally{if(o)throw l}}var f=t.length,y=f;for(f&&t.push(C);y<n;){var w=h,S=!0,E=!1,x=void 0;try{for(var I,T=e[Symbol.iterator]();!(S=(I=T.next()).done);S=!0){var D=I.value;D>=r&&D<w&&(w=D)}}catch(e){E=!0,x=e}finally{try{!S&&T.return&&T.return()}finally{if(E)throw x}}var L=y+1;w-r>A((h-s)/L)&&k("overflow"),s+=(w-r)*L,r=w;var O=!0,_=!1,B=void 0;try{for(var F,U=e[Symbol.iterator]();!(O=(F=U.next()).done);O=!0){var H=F.value;if(H<r&&++s>h&&k("overflow"),H==r){for(var z=s,j=p;;j+=p){var V=j<=i?g:j>=i+m?m:j-i;if(z<V)break;var q=z-V,W=p-V;t.push(P(R(V+q%W,0))),z=A(q/W)}t.push(P(R(z,0))),i=N(s,L,y==f),s=0,++y}}}catch(e){_=!0,B=e}finally{try{!O&&U.return&&U.return()}finally{if(_)throw B}}++s,++r}return t.join("")},B=function(e){return D(e,(function(e){return w.test(e)?O(e.slice(4).toLowerCase()):e}))},F=function(e){return D(e,(function(e){return S.test(e)?"xn--"+_(e):e}))},U={version:"2.1.0",ucs2:{decode:M,encode:function(e){return String.fromCodePoint.apply(String,d(e))}},decode:O,encode:_,toASCII:F,toUnicode:B},H={};function z(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function j(e){for(var t="",n=0,r=e.length;n<r;){var s=parseInt(e.substr(n+1,2),16);if(s<128)t+=String.fromCharCode(s),n+=3;else if(s>=194&&s<224){if(r-n>=6){var i=parseInt(e.substr(n+4,2),16);t+=String.fromCharCode((31&s)<<6|63&i)}else t+=e.substr(n,6);n+=6}else if(s>=224){if(r-n>=9){var a=parseInt(e.substr(n+4,2),16),o=parseInt(e.substr(n+7,2),16);t+=String.fromCharCode((15&s)<<12|(63&a)<<6|63&o)}else t+=e.substr(n,9);n+=9}else t+=e.substr(n,3),n+=3}return t}function V(e,t){function n(e){var n=j(e);return n.match(t.UNRESERVED)?n:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,n).replace(t.NOT_USERINFO,z).replace(t.PCT_ENCODED,s)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,n).toLowerCase().replace(t.NOT_HOST,z).replace(t.PCT_ENCODED,s)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,n).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,z).replace(t.PCT_ENCODED,s)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,n).replace(t.NOT_QUERY,z).replace(t.PCT_ENCODED,s)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,n).replace(t.NOT_FRAGMENT,z).replace(t.PCT_ENCODED,s)),e}function q(e){return e.replace(/^0*(.*)/,"$1")||"0"}function W(e,t){var n=e.match(t.IPV4ADDRESS)||[],r=u(n,2)[1];return r?r.split(".").map(q).join("."):e}function Q(e,t){var n=e.match(t.IPV6ADDRESS)||[],r=u(n,3),s=r[1],i=r[2];if(s){for(var a=s.toLowerCase().split("::").reverse(),o=u(a,2),l=o[0],c=o[1],d=c?c.split(":").map(q):[],h=l.split(":").map(q),p=t.IPV4ADDRESS.test(h[h.length-1]),g=p?7:8,m=h.length-g,f=Array(g),y=0;y<g;++y)f[y]=d[y]||h[m+y]||"";p&&(f[g-1]=W(f[g-1],t));var v=f.reduce((function(e,t,n){if(!t||"0"===t){var r=e[e.length-1];r&&r.index+r.length===n?r.length++:e.push({index:n,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(v&&v.length>1){var C=f.slice(0,v.index),w=f.slice(v.index+v.length);b=C.join(":")+"::"+w.join(":")}else b=f.join(":");return i&&(b+="%"+i),b}return e}var G=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Z=void 0==="".match(/(){0}/)[1];function Y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=!1!==t.iri?c:l;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var s=e.match(G);if(s){Z?(n.scheme=s[1],n.userinfo=s[3],n.host=s[4],n.port=parseInt(s[5],10),n.path=s[6]||"",n.query=s[7],n.fragment=s[8],isNaN(n.port)&&(n.port=s[5])):(n.scheme=s[1]||void 0,n.userinfo=-1!==e.indexOf("@")?s[3]:void 0,n.host=-1!==e.indexOf("//")?s[4]:void 0,n.port=parseInt(s[5],10),n.path=s[6]||"",n.query=-1!==e.indexOf("?")?s[7]:void 0,n.fragment=-1!==e.indexOf("#")?s[8]:void 0,isNaN(n.port)&&(n.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?s[4]:void 0)),n.host&&(n.host=Q(W(n.host,r),r)),void 0!==n.scheme||void 0!==n.userinfo||void 0!==n.host||void 0!==n.port||n.path||void 0!==n.query?void 0===n.scheme?n.reference="relative":void 0===n.fragment?n.reference="absolute":n.reference="uri":n.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==n.reference&&(n.error=n.error||"URI is not a "+t.reference+" reference.");var i=H[(t.scheme||n.scheme||"").toLowerCase()];if(t.unicodeSupport||i&&i.unicodeSupport)V(n,r);else{if(n.host&&(t.domainHost||i&&i.domainHost))try{n.host=U.toASCII(n.host.replace(r.PCT_ENCODED,j).toLowerCase())}catch(e){n.error=n.error||"Host's domain name can not be converted to ASCII via punycode: "+e}V(n,l)}i&&i.parse&&i.parse(n,t)}else n.error=n.error||"URI can not be parsed.";return n}function K(e,t){var n=!1!==t.iri?c:l,r=[];return void 0!==e.userinfo&&(r.push(e.userinfo),r.push("@")),void 0!==e.host&&r.push(Q(W(String(e.host),n),n).replace(n.IPV6ADDRESS,(function(e,t,n){return"["+t+(n?"%25"+n:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(r.push(":"),r.push(String(e.port))),r.length?r.join(""):void 0}var J=/^\.\.?\//,X=/^\/\.(\/|$)/,$=/^\/\.\.(\/|$)/,ee=/^\/?(?:.|\n)*?(?=\/|$)/;function te(e){for(var t=[];e.length;)if(e.match(J))e=e.replace(J,"");else if(e.match(X))e=e.replace(X,"/");else if(e.match($))e=e.replace($,"/"),t.pop();else if("."===e||".."===e)e="";else{var n=e.match(ee);if(!n)throw new Error("Unexpected dot segment condition");var r=n[0];e=e.slice(r.length),t.push(r)}return t.join("")}function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.iri?c:l,r=[],s=H[(t.scheme||e.scheme||"").toLowerCase()];if(s&&s.serialize&&s.serialize(e,t),e.host)if(n.IPV6ADDRESS.test(e.host));else if(t.domainHost||s&&s.domainHost)try{e.host=t.iri?U.toUnicode(e.host):U.toASCII(e.host.replace(n.PCT_ENCODED,j).toLowerCase())}catch(n){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+n}V(e,n),"suffix"!==t.reference&&e.scheme&&(r.push(e.scheme),r.push(":"));var i=K(e,t);if(void 0!==i&&("suffix"!==t.reference&&r.push("//"),r.push(i),e.path&&"/"!==e.path.charAt(0)&&r.push("/")),void 0!==e.path){var a=e.path;t.absolutePath||s&&s.absolutePath||(a=te(a)),void 0===i&&(a=a.replace(/^\/\//,"/%2F")),r.push(a)}return void 0!==e.query&&(r.push("?"),r.push(e.query)),void 0!==e.fragment&&(r.push("#"),r.push(e.fragment)),r.join("")}function re(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={};return arguments[3]||(e=Y(ne(e,n),n),t=Y(ne(t,n),n)),!(n=n||{}).tolerant&&t.scheme?(r.scheme=t.scheme,r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=te(t.path||""),r.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(r.userinfo=t.userinfo,r.host=t.host,r.port=t.port,r.path=te(t.path||""),r.query=t.query):(t.path?("/"===t.path.charAt(0)?r.path=te(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?r.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:r.path=t.path:r.path="/"+t.path,r.path=te(r.path)),r.query=t.query):(r.path=e.path,void 0!==t.query?r.query=t.query:r.query=e.query),r.userinfo=e.userinfo,r.host=e.host,r.port=e.port),r.scheme=e.scheme),r.fragment=t.fragment,r}function se(e,t,n){var r=a({scheme:"null"},n);return ne(re(Y(e,r),Y(t,r),r,!0),r)}function ie(e,t){return"string"==typeof e?e=ne(Y(e,t),t):"object"===r(e)&&(e=Y(ne(e,t),t)),e}function ae(e,t,n){return"string"==typeof e?e=ne(Y(e,n),n):"object"===r(e)&&(e=ne(e,n)),"string"==typeof t?t=ne(Y(t,n),n):"object"===r(t)&&(t=ne(t,n)),e===t}function oe(e,t){return e&&e.toString().replace(t&&t.iri?c.ESCAPE:l.ESCAPE,z)}function le(e,t){return e&&e.toString().replace(t&&t.iri?c.PCT_ENCODED:l.PCT_ENCODED,j)}var ce={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var n="https"===String(e.scheme).toLowerCase();return e.port!==(n?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},ue={scheme:"https",domainHost:ce.domainHost,parse:ce.parse,serialize:ce.serialize};function de(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var he={scheme:"ws",domainHost:!0,parse:function(e,t){var n=e;return n.secure=de(n),n.resourceName=(n.path||"/")+(n.query?"?"+n.query:""),n.path=void 0,n.query=void 0,n},serialize:function(e,t){if(e.port!==(de(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var n=e.resourceName.split("?"),r=u(n,2),s=r[0],i=r[1];e.path=s&&"/"!==s?s:void 0,e.query=i,e.resourceName=void 0}return e.fragment=void 0,e}},pe={scheme:"wss",domainHost:he.domainHost,parse:he.parse,serialize:he.serialize},ge={},me="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",fe="[0-9A-Fa-f]",ye=n(n("%[EFef]"+fe+"%"+fe+fe+"%"+fe+fe)+"|"+n("%[89A-Fa-f]"+fe+"%"+fe+fe)+"|"+n("%"+fe+fe)),ve="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",be=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),Ce="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",we=new RegExp(me,"g"),Se=new RegExp(ye,"g"),Ee=new RegExp(t("[^]",ve,"[\\.]",'[\\"]',be),"g"),xe=new RegExp(t("[^]",me,Ce),"g"),Ie=xe;function Ae(e){var t=j(e);return t.match(we)?t:e}var Pe={scheme:"mailto",parse:function(e,t){var n=e,r=n.to=n.path?n.path.split(","):[];if(n.path=void 0,n.query){for(var s=!1,i={},a=n.query.split("&"),o=0,l=a.length;o<l;++o){var c=a[o].split("=");switch(c[0]){case"to":for(var u=c[1].split(","),d=0,h=u.length;d<h;++d)r.push(u[d]);break;case"subject":n.subject=le(c[1],t);break;case"body":n.body=le(c[1],t);break;default:s=!0,i[le(c[0],t)]=le(c[1],t)}}s&&(n.headers=i)}n.query=void 0;for(var p=0,g=r.length;p<g;++p){var m=r[p].split("@");if(m[0]=le(m[0]),t.unicodeSupport)m[1]=le(m[1],t).toLowerCase();else try{m[1]=U.toASCII(le(m[1],t).toLowerCase())}catch(e){n.error=n.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}r[p]=m.join("@")}return n},serialize:function(e,t){var n=e,r=i(e.to);if(r){for(var a=0,o=r.length;a<o;++a){var l=String(r[a]),c=l.lastIndexOf("@"),u=l.slice(0,c).replace(Se,Ae).replace(Se,s).replace(Ee,z),d=l.slice(c+1);try{d=t.iri?U.toUnicode(d):U.toASCII(le(d,t).toLowerCase())}catch(e){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}r[a]=u+"@"+d}n.path=r.join(",")}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var p=[];for(var g in h)h[g]!==ge[g]&&p.push(g.replace(Se,Ae).replace(Se,s).replace(xe,z)+"="+h[g].replace(Se,Ae).replace(Se,s).replace(Ie,z));return p.length&&(n.query=p.join("&")),n}},ke=/^([^\:]+)\:(.*)/,Te={scheme:"urn",parse:function(e,t){var n=e.path&&e.path.match(ke),r=e;if(n){var s=t.scheme||r.scheme||"urn",i=n[1].toLowerCase(),a=n[2],o=s+":"+(t.nid||i),l=H[o];r.nid=i,r.nss=a,r.path=void 0,l&&(r=l.parse(r,t))}else r.error=r.error||"URN can not be parsed.";return r},serialize:function(e,t){var n=t.scheme||e.scheme||"urn",r=e.nid,s=n+":"+(t.nid||r),i=H[s];i&&(e=i.serialize(e,t));var a=e,o=e.nss;return a.path=(r||t.nid)+":"+o,a}},De=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Me={scheme:"urn:uuid",parse:function(e,t){var n=e;return n.uuid=n.nss,n.nss=void 0,t.tolerant||n.uuid&&n.uuid.match(De)||(n.error=n.error||"UUID is not valid."),n},serialize:function(e,t){var n=e;return n.nss=(e.uuid||"").toLowerCase(),n}};H[ce.scheme]=ce,H[ue.scheme]=ue,H[he.scheme]=he,H[pe.scheme]=pe,H[Pe.scheme]=Pe,H[Te.scheme]=Te,H[Me.scheme]=Me,e.SCHEMES=H,e.pctEncChar=z,e.pctDecChars=j,e.parse=Y,e.removeDotSegments=te,e.serialize=ne,e.resolveComponents=re,e.resolve=se,e.normalize=ie,e.equal=ae,e.escapeComponent=oe,e.unescapeComponent=le,Object.defineProperty(e,"__esModule",{value:!0})}(t)},88436:(e,t,n)=>{"use strict";var r=n(87423).isSpace;e.exports=function(e,t,n,s){var i,a,o,l,c=e.bMarks[t]+e.tShift[t],u=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(42!==(i=e.src.charCodeAt(c++))&&45!==i&&95!==i)return!1;for(a=1;c<u;){if((o=e.src.charCodeAt(c++))!==i&&!r(o))return!1;o===i&&a++}return!(a<3)&&(s||(e.line=t+1,(l=e.push("hr","hr",0)).map=[t,e.line],l.markup=Array(a+1).join(String.fromCharCode(i))),!0)}},88667:e=>{"use strict";e.exports=function(e,t,n){var r,s,i;if(e.sCount[t]-e.blkIndent<4)return!1;for(s=r=t+1;r<n;)if(e.isEmpty(r))r++;else{if(!(e.sCount[r]-e.blkIndent>=4))break;s=++r}return e.line=s,(i=e.push("code_block","code",0)).content=e.getLines(t,s,4+e.blkIndent,!1)+"\n",i.map=[t,e.line],!0}},89700:e=>{"use strict";e.exports=function(e,t,n){var r=" ",s=e.level,i=e.dataLevel,a=e.schema[t],o=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,c=!e.opts.allErrors,u="data"+(i||""),d="errs__"+s,h=e.util.copy(e);h.level++;var p="valid"+h.level;if(r+="var "+d+" = errors;",e.opts.strictKeywords?"object"==typeof a&&Object.keys(a).length>0||!1===a:e.util.schemaHasRules(a,e.RULES.all)){h.schema=a,h.schemaPath=o,h.errSchemaPath=l;var g="key"+s,m="idx"+s,f="i"+s,y="' + "+g+" + '",v="data"+(h.dataLevel=e.dataLevel+1),b="dataProperties"+s,C=e.opts.ownProperties,w=e.baseId;C&&(r+=" var "+b+" = undefined; "),r+=C?" "+b+" = "+b+" || Object.keys("+u+"); for (var "+m+"=0; "+m+"<"+b+".length; "+m+"++) { var "+g+" = "+b+"["+m+"]; ":" for (var "+g+" in "+u+") { ",r+=" var startErrs"+s+" = errors; ";var S=g,E=e.compositeRule;e.compositeRule=h.compositeRule=!0;var x=e.validate(h);h.baseId=w,e.util.varOccurences(x,v)<2?r+=" "+e.util.varReplace(x,v,S)+" ":r+=" var "+v+" = "+S+"; "+x+" ",e.compositeRule=h.compositeRule=E,r+=" if (!"+p+") { for (var "+f+"=startErrs"+s+"; "+f+"<errors; "+f+"++) { vErrors["+f+"].propertyName = "+g+"; }   var err =   ",!1!==e.createErrors?(r+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { propertyName: '"+y+"' } ",!1!==e.opts.messages&&(r+=" , message: 'property name \\'"+y+"\\' is invalid' "),e.opts.verbose&&(r+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+u+" "),r+=" } "):r+=" {} ",r+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&c&&(e.async?r+=" throw new ValidationError(vErrors); ":r+=" validate.errors = vErrors; return false; "),c&&(r+=" break; "),r+=" } }"}return c&&(r+="  if ("+d+" == errors) {"),r}},91248:e=>{"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON Schema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},91766:e=>{"use strict";e.exports=function(e,t,n){var r,s=" ",i=e.level,a=e.dataLevel,o=e.schema[t],l=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,d="data"+(a||""),h=e.opts.$data&&o&&o.$data;if(h?(s+=" var schema"+i+" = "+e.util.getData(o.$data,a,e.dataPathArr)+"; ",r="schema"+i):r=o,!h&&"number"!=typeof o)throw new Error(t+" must be number");s+="if ( ",h&&(s+=" ("+r+" !== undefined && typeof "+r+" != 'number') || "),s+=" Object.keys("+d+").length "+("maxProperties"==t?">":"<")+" "+r+") { ";var p=t,g=g||[];g.push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(p||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+r+" } ",!1!==e.opts.messages&&(s+=" , message: 'should NOT have ",s+="maxProperties"==t?"more":"fewer",s+=" than ",s+=h?"' + "+r+" + '":""+o,s+=" properties' "),e.opts.verbose&&(s+=" , schema:  ",s+=h?"validate.schema"+l:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),s+=" } "):s+=" {} ";var m=s;return s=g.pop(),!e.compositeRule&&u?e.async?s+=" throw new ValidationError(["+m+"]); ":s+=" validate.errors = ["+m+"]; return false; ":s+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",u&&(s+=" else { "),s}},92293:(e,t,n)=>{"use strict";var r=n(67322),s=n(25681).p,i=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+r.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(s.source+"\\s*$"),/^$/,!1]];e.exports=function(e,t,n,r){var s,a,o,l,c=e.bMarks[t]+e.tShift[t],u=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;if(!e.md.options.html)return!1;if(60!==e.src.charCodeAt(c))return!1;for(l=e.src.slice(c,u),s=0;s<i.length&&!i[s][0].test(l);s++);if(s===i.length)return!1;if(r)return i[s][2];if(a=t+1,!i[s][1].test(l))for(;a<n&&!(e.sCount[a]<e.blkIndent);a++)if(c=e.bMarks[a]+e.tShift[a],u=e.eMarks[a],l=e.src.slice(c,u),i[s][1].test(l)){0!==l.length&&a++;break}return e.line=a,(o=e.push("html_block","",0)).map=[t,a],o.content=e.getLines(t,a,e.blkIndent,!0),!0}},92355:(e,t,n)=>{"use strict";var r=n(52211),s=n(87423).has,i=n(87423).isValidEntityCode,a=n(87423).fromCodePoint,o=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,l=/^&([a-z][a-z0-9]{1,31});/i;e.exports=function(e,t){var n,c,u=e.pos,d=e.posMax;if(38!==e.src.charCodeAt(u))return!1;if(u+1<d)if(35===e.src.charCodeAt(u+1)){if(c=e.src.slice(u).match(o))return t||(n="x"===c[1][0].toLowerCase()?parseInt(c[1].slice(1),16):parseInt(c[1],10),e.pending+=i(n)?a(n):a(65533)),e.pos+=c[0].length,!0}else if((c=e.src.slice(u).match(l))&&s(r,c[1]))return t||(e.pending+=r[c[1]]),e.pos+=c[0].length,!0;return t||(e.pending+="&"),e.pos++,!0}},94223:e=>{"use strict";var t=/^([a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,n=/^([a-zA-Z][a-zA-Z0-9+.\-]{1,31}):([^<>\x00-\x20]*)$/;e.exports=function(e,r){var s,i,a,o,l,c,u=e.pos;if(60!==e.src.charCodeAt(u))return!1;for(l=e.pos,c=e.posMax;;){if(++u>=c)return!1;if(60===(o=e.src.charCodeAt(u)))return!1;if(62===o)break}return s=e.src.slice(l+1,u),n.test(s)?(i=e.md.normalizeLink(s),!!e.md.validateLink(i)&&(r||((a=e.push("link_open","a",1)).attrs=[["href",i]],a.markup="autolink",a.info="auto",(a=e.push("text","",0)).content=e.md.normalizeLinkText(s),(a=e.push("link_close","a",-1)).markup="autolink",a.info="auto"),e.pos+=s.length+2,!0)):!!t.test(s)&&(i=e.md.normalizeLink("mailto:"+s),!!e.md.validateLink(i)&&(r||((a=e.push("link_open","a",1)).attrs=[["href",i]],a.markup="autolink",a.info="auto",(a=e.push("text","",0)).content=e.md.normalizeLinkText(s),(a=e.push("link_close","a",-1)).markup="autolink",a.info="auto"),e.pos+=s.length+2,!0))}},95850:e=>{e.exports=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/},95906:(e,t,n)=>{"use strict";var r=n(88125),s=n(97288),i=n(70408),a=n(86725),o=n(40723);function l(e,t,n){var r=this._refs[n];if("string"==typeof r){if(!this._refs[r])return l.call(this,e,t,r);r=this._refs[r]}if((r=r||this._schemas[n])instanceof a)return g(r.schema,this._opts.inlineRefs)?r.schema:r.validate||this._compile(r);var s,i,o,u=c.call(this,t,n);return u&&(s=u.schema,t=u.root,o=u.baseId),s instanceof a?i=s.validate||e.call(this,s.schema,t,void 0,o):void 0!==s&&(i=g(s,this._opts.inlineRefs)?s:e.call(this,s,t,void 0,o)),i}function c(e,t){var n=r.parse(t),s=v(n),i=y(this._getId(e.schema));if(0===Object.keys(e.schema).length||s!==i){var o=C(s),l=this._refs[o];if("string"==typeof l)return u.call(this,e,l,n);if(l instanceof a)l.validate||this._compile(l),e=l;else{if(!((l=this._schemas[o])instanceof a))return;if(l.validate||this._compile(l),o==C(t))return{schema:l,root:e,baseId:i};e=l}if(!e.schema)return;i=y(this._getId(e.schema))}return h.call(this,n,i,e.schema,e)}function u(e,t,n){var r=c.call(this,e,t);if(r){var s=r.schema,i=r.baseId;e=r.root;var a=this._getId(s);return a&&(i=w(i,a)),h.call(this,n,i,s,e)}}e.exports=l,l.normalizeId=C,l.fullPath=y,l.url=w,l.ids=function(e){var t=C(this._getId(e)),n={"":t},a={"":y(t,!1)},l={},c=this;return o(e,{allKeys:!0},(function(e,t,o,u,d,h,p){if(""!==t){var g=c._getId(e),m=n[u],f=a[u]+"/"+d;if(void 0!==p&&(f+="/"+("number"==typeof p?p:i.escapeFragment(p))),"string"==typeof g){g=m=C(m?r.resolve(m,g):g);var y=c._refs[g];if("string"==typeof y&&(y=c._refs[y]),y&&y.schema){if(!s(e,y.schema))throw new Error('id "'+g+'" resolves to more than one schema')}else if(g!=C(f))if("#"==g[0]){if(l[g]&&!s(e,l[g]))throw new Error('id "'+g+'" resolves to more than one schema');l[g]=e}else c._refs[g]=f}n[t]=m,a[t]=f}})),l},l.inlineRef=g,l.schema=c;var d=i.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function h(e,t,n,r){if(e.fragment=e.fragment||"","/"==e.fragment.slice(0,1)){for(var s=e.fragment.split("/"),a=1;a<s.length;a++){var o=s[a];if(o){if(void 0===(n=n[o=i.unescapeFragment(o)]))break;var l;if(!d[o]&&((l=this._getId(n))&&(t=w(t,l)),n.$ref)){var u=w(t,n.$ref),h=c.call(this,r,u);h&&(n=h.schema,r=h.root,t=h.baseId)}}}return void 0!==n&&n!==r.schema?{schema:n,root:r,baseId:t}:void 0}}var p=i.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function g(e,t){return!1!==t&&(void 0===t||!0===t?m(e):t?f(e)<=t:void 0)}function m(e){var t;if(Array.isArray(e)){for(var n=0;n<e.length;n++)if("object"==typeof(t=e[n])&&!m(t))return!1}else for(var r in e){if("$ref"==r)return!1;if("object"==typeof(t=e[r])&&!m(t))return!1}return!0}function f(e){var t,n=0;if(Array.isArray(e)){for(var r=0;r<e.length;r++)if("object"==typeof(t=e[r])&&(n+=f(t)),n==1/0)return 1/0}else for(var s in e){if("$ref"==s)return 1/0;if(p[s])n++;else if("object"==typeof(t=e[s])&&(n+=f(t)+1),n==1/0)return 1/0}return n}function y(e,t){return!1!==t&&(e=C(e)),v(r.parse(e))}function v(e){return r.serialize(e).split("#")[0]+"#"}var b=/#\/?$/;function C(e){return e?e.replace(b,""):""}function w(e,t){return t=C(t),r.resolve(e,t)}},96663:(e,t,n)=>{"use strict";e.exports=function(e){var t={};t.src_Any=n(95850).source,t.src_Cc=n(19247).source,t.src_Z=n(32399).source,t.src_P=n(16277).source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");var r="[><｜]";return t.src_pseudo_letter="(?:(?![><｜]|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|[><｜]|"+t.src_ZPCc+")(?!-|_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+r+"|[()[\\]{}.,\"'?!\\-;]).|\\[(?:(?!"+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+'|["]).)+\\"|\\\'(?:(?!'+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-]).|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]).|"+(e&&e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+").|;(?!"+t.src_ZCc+").|\\!+(?!"+t.src_ZCc+"|[!]).|\\?(?!"+t.src_ZCc+"|[?]).)+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy='(^|[><｜]|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+t.src_ZPCc+"))((?![$+<=>^`|｜])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|｜]|"+t.src_ZPCc+"))((?![$+<=>^`|｜])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}},98409:e=>{"use strict";function t(e,t){var n,r,s,i,a,o=[],l=t.length;for(n=0;n<l;n++)126===(s=t[n]).marker&&-1!==s.end&&(i=t[s.end],(a=e.tokens[s.token]).type="s_open",a.tag="s",a.nesting=1,a.markup="~~",a.content="",(a=e.tokens[i.token]).type="s_close",a.tag="s",a.nesting=-1,a.markup="~~",a.content="","text"===e.tokens[i.token-1].type&&"~"===e.tokens[i.token-1].content&&o.push(i.token-1));for(;o.length;){for(r=(n=o.pop())+1;r<e.tokens.length&&"s_close"===e.tokens[r].type;)r++;n!==--r&&(a=e.tokens[r],e.tokens[r]=e.tokens[n],e.tokens[n]=a)}}e.exports.q=function(e,t){var n,r,s,i,a=e.pos,o=e.src.charCodeAt(a);if(t)return!1;if(126!==o)return!1;if(s=(r=e.scanDelims(e.pos,!0)).length,i=String.fromCharCode(o),s<2)return!1;for(s%2&&(e.push("text","",0).content=i,s--),n=0;n<s;n+=2)e.push("text","",0).content=i+i,e.delimiters.push({marker:o,length:0,token:e.tokens.length-1,end:-1,open:r.can_open,close:r.can_close});return e.pos+=r.length,!0},e.exports.g=function(e){var n,r=e.tokens_meta,s=e.tokens_meta.length;for(t(e,e.delimiters),n=0;n<s;n++)r[n]&&r[n].delimiters&&t(e,r[n].delimiters)}},98614:e=>{"use strict";e.exports=JSON.parse('{"Aacute":"Á","aacute":"á","Abreve":"Ă","abreve":"ă","ac":"∾","acd":"∿","acE":"∾̳","Acirc":"Â","acirc":"â","acute":"´","Acy":"А","acy":"а","AElig":"Æ","aelig":"æ","af":"⁡","Afr":"𝔄","afr":"𝔞","Agrave":"À","agrave":"à","alefsym":"ℵ","aleph":"ℵ","Alpha":"Α","alpha":"α","Amacr":"Ā","amacr":"ā","amalg":"⨿","amp":"&","AMP":"&","andand":"⩕","And":"⩓","and":"∧","andd":"⩜","andslope":"⩘","andv":"⩚","ang":"∠","ange":"⦤","angle":"∠","angmsdaa":"⦨","angmsdab":"⦩","angmsdac":"⦪","angmsdad":"⦫","angmsdae":"⦬","angmsdaf":"⦭","angmsdag":"⦮","angmsdah":"⦯","angmsd":"∡","angrt":"∟","angrtvb":"⊾","angrtvbd":"⦝","angsph":"∢","angst":"Å","angzarr":"⍼","Aogon":"Ą","aogon":"ą","Aopf":"𝔸","aopf":"𝕒","apacir":"⩯","ap":"≈","apE":"⩰","ape":"≊","apid":"≋","apos":"\'","ApplyFunction":"⁡","approx":"≈","approxeq":"≊","Aring":"Å","aring":"å","Ascr":"𝒜","ascr":"𝒶","Assign":"≔","ast":"*","asymp":"≈","asympeq":"≍","Atilde":"Ã","atilde":"ã","Auml":"Ä","auml":"ä","awconint":"∳","awint":"⨑","backcong":"≌","backepsilon":"϶","backprime":"‵","backsim":"∽","backsimeq":"⋍","Backslash":"∖","Barv":"⫧","barvee":"⊽","barwed":"⌅","Barwed":"⌆","barwedge":"⌅","bbrk":"⎵","bbrktbrk":"⎶","bcong":"≌","Bcy":"Б","bcy":"б","bdquo":"„","becaus":"∵","because":"∵","Because":"∵","bemptyv":"⦰","bepsi":"϶","bernou":"ℬ","Bernoullis":"ℬ","Beta":"Β","beta":"β","beth":"ℶ","between":"≬","Bfr":"𝔅","bfr":"𝔟","bigcap":"⋂","bigcirc":"◯","bigcup":"⋃","bigodot":"⨀","bigoplus":"⨁","bigotimes":"⨂","bigsqcup":"⨆","bigstar":"★","bigtriangledown":"▽","bigtriangleup":"△","biguplus":"⨄","bigvee":"⋁","bigwedge":"⋀","bkarow":"⤍","blacklozenge":"⧫","blacksquare":"▪","blacktriangle":"▴","blacktriangledown":"▾","blacktriangleleft":"◂","blacktriangleright":"▸","blank":"␣","blk12":"▒","blk14":"░","blk34":"▓","block":"█","bne":"=⃥","bnequiv":"≡⃥","bNot":"⫭","bnot":"⌐","Bopf":"𝔹","bopf":"𝕓","bot":"⊥","bottom":"⊥","bowtie":"⋈","boxbox":"⧉","boxdl":"┐","boxdL":"╕","boxDl":"╖","boxDL":"╗","boxdr":"┌","boxdR":"╒","boxDr":"╓","boxDR":"╔","boxh":"─","boxH":"═","boxhd":"┬","boxHd":"╤","boxhD":"╥","boxHD":"╦","boxhu":"┴","boxHu":"╧","boxhU":"╨","boxHU":"╩","boxminus":"⊟","boxplus":"⊞","boxtimes":"⊠","boxul":"┘","boxuL":"╛","boxUl":"╜","boxUL":"╝","boxur":"└","boxuR":"╘","boxUr":"╙","boxUR":"╚","boxv":"│","boxV":"║","boxvh":"┼","boxvH":"╪","boxVh":"╫","boxVH":"╬","boxvl":"┤","boxvL":"╡","boxVl":"╢","boxVL":"╣","boxvr":"├","boxvR":"╞","boxVr":"╟","boxVR":"╠","bprime":"‵","breve":"˘","Breve":"˘","brvbar":"¦","bscr":"𝒷","Bscr":"ℬ","bsemi":"⁏","bsim":"∽","bsime":"⋍","bsolb":"⧅","bsol":"\\\\","bsolhsub":"⟈","bull":"•","bullet":"•","bump":"≎","bumpE":"⪮","bumpe":"≏","Bumpeq":"≎","bumpeq":"≏","Cacute":"Ć","cacute":"ć","capand":"⩄","capbrcup":"⩉","capcap":"⩋","cap":"∩","Cap":"⋒","capcup":"⩇","capdot":"⩀","CapitalDifferentialD":"ⅅ","caps":"∩︀","caret":"⁁","caron":"ˇ","Cayleys":"ℭ","ccaps":"⩍","Ccaron":"Č","ccaron":"č","Ccedil":"Ç","ccedil":"ç","Ccirc":"Ĉ","ccirc":"ĉ","Cconint":"∰","ccups":"⩌","ccupssm":"⩐","Cdot":"Ċ","cdot":"ċ","cedil":"¸","Cedilla":"¸","cemptyv":"⦲","cent":"¢","centerdot":"·","CenterDot":"·","cfr":"𝔠","Cfr":"ℭ","CHcy":"Ч","chcy":"ч","check":"✓","checkmark":"✓","Chi":"Χ","chi":"χ","circ":"ˆ","circeq":"≗","circlearrowleft":"↺","circlearrowright":"↻","circledast":"⊛","circledcirc":"⊚","circleddash":"⊝","CircleDot":"⊙","circledR":"®","circledS":"Ⓢ","CircleMinus":"⊖","CirclePlus":"⊕","CircleTimes":"⊗","cir":"○","cirE":"⧃","cire":"≗","cirfnint":"⨐","cirmid":"⫯","cirscir":"⧂","ClockwiseContourIntegral":"∲","CloseCurlyDoubleQuote":"”","CloseCurlyQuote":"’","clubs":"♣","clubsuit":"♣","colon":":","Colon":"∷","Colone":"⩴","colone":"≔","coloneq":"≔","comma":",","commat":"@","comp":"∁","compfn":"∘","complement":"∁","complexes":"ℂ","cong":"≅","congdot":"⩭","Congruent":"≡","conint":"∮","Conint":"∯","ContourIntegral":"∮","copf":"𝕔","Copf":"ℂ","coprod":"∐","Coproduct":"∐","copy":"©","COPY":"©","copysr":"℗","CounterClockwiseContourIntegral":"∳","crarr":"↵","cross":"✗","Cross":"⨯","Cscr":"𝒞","cscr":"𝒸","csub":"⫏","csube":"⫑","csup":"⫐","csupe":"⫒","ctdot":"⋯","cudarrl":"⤸","cudarrr":"⤵","cuepr":"⋞","cuesc":"⋟","cularr":"↶","cularrp":"⤽","cupbrcap":"⩈","cupcap":"⩆","CupCap":"≍","cup":"∪","Cup":"⋓","cupcup":"⩊","cupdot":"⊍","cupor":"⩅","cups":"∪︀","curarr":"↷","curarrm":"⤼","curlyeqprec":"⋞","curlyeqsucc":"⋟","curlyvee":"⋎","curlywedge":"⋏","curren":"¤","curvearrowleft":"↶","curvearrowright":"↷","cuvee":"⋎","cuwed":"⋏","cwconint":"∲","cwint":"∱","cylcty":"⌭","dagger":"†","Dagger":"‡","daleth":"ℸ","darr":"↓","Darr":"↡","dArr":"⇓","dash":"‐","Dashv":"⫤","dashv":"⊣","dbkarow":"⤏","dblac":"˝","Dcaron":"Ď","dcaron":"ď","Dcy":"Д","dcy":"д","ddagger":"‡","ddarr":"⇊","DD":"ⅅ","dd":"ⅆ","DDotrahd":"⤑","ddotseq":"⩷","deg":"°","Del":"∇","Delta":"Δ","delta":"δ","demptyv":"⦱","dfisht":"⥿","Dfr":"𝔇","dfr":"𝔡","dHar":"⥥","dharl":"⇃","dharr":"⇂","DiacriticalAcute":"´","DiacriticalDot":"˙","DiacriticalDoubleAcute":"˝","DiacriticalGrave":"`","DiacriticalTilde":"˜","diam":"⋄","diamond":"⋄","Diamond":"⋄","diamondsuit":"♦","diams":"♦","die":"¨","DifferentialD":"ⅆ","digamma":"ϝ","disin":"⋲","div":"÷","divide":"÷","divideontimes":"⋇","divonx":"⋇","DJcy":"Ђ","djcy":"ђ","dlcorn":"⌞","dlcrop":"⌍","dollar":"$","Dopf":"𝔻","dopf":"𝕕","Dot":"¨","dot":"˙","DotDot":"⃜","doteq":"≐","doteqdot":"≑","DotEqual":"≐","dotminus":"∸","dotplus":"∔","dotsquare":"⊡","doublebarwedge":"⌆","DoubleContourIntegral":"∯","DoubleDot":"¨","DoubleDownArrow":"⇓","DoubleLeftArrow":"⇐","DoubleLeftRightArrow":"⇔","DoubleLeftTee":"⫤","DoubleLongLeftArrow":"⟸","DoubleLongLeftRightArrow":"⟺","DoubleLongRightArrow":"⟹","DoubleRightArrow":"⇒","DoubleRightTee":"⊨","DoubleUpArrow":"⇑","DoubleUpDownArrow":"⇕","DoubleVerticalBar":"∥","DownArrowBar":"⤓","downarrow":"↓","DownArrow":"↓","Downarrow":"⇓","DownArrowUpArrow":"⇵","DownBreve":"̑","downdownarrows":"⇊","downharpoonleft":"⇃","downharpoonright":"⇂","DownLeftRightVector":"⥐","DownLeftTeeVector":"⥞","DownLeftVectorBar":"⥖","DownLeftVector":"↽","DownRightTeeVector":"⥟","DownRightVectorBar":"⥗","DownRightVector":"⇁","DownTeeArrow":"↧","DownTee":"⊤","drbkarow":"⤐","drcorn":"⌟","drcrop":"⌌","Dscr":"𝒟","dscr":"𝒹","DScy":"Ѕ","dscy":"ѕ","dsol":"⧶","Dstrok":"Đ","dstrok":"đ","dtdot":"⋱","dtri":"▿","dtrif":"▾","duarr":"⇵","duhar":"⥯","dwangle":"⦦","DZcy":"Џ","dzcy":"џ","dzigrarr":"⟿","Eacute":"É","eacute":"é","easter":"⩮","Ecaron":"Ě","ecaron":"ě","Ecirc":"Ê","ecirc":"ê","ecir":"≖","ecolon":"≕","Ecy":"Э","ecy":"э","eDDot":"⩷","Edot":"Ė","edot":"ė","eDot":"≑","ee":"ⅇ","efDot":"≒","Efr":"𝔈","efr":"𝔢","eg":"⪚","Egrave":"È","egrave":"è","egs":"⪖","egsdot":"⪘","el":"⪙","Element":"∈","elinters":"⏧","ell":"ℓ","els":"⪕","elsdot":"⪗","Emacr":"Ē","emacr":"ē","empty":"∅","emptyset":"∅","EmptySmallSquare":"◻","emptyv":"∅","EmptyVerySmallSquare":"▫","emsp13":" ","emsp14":" ","emsp":" ","ENG":"Ŋ","eng":"ŋ","ensp":" ","Eogon":"Ę","eogon":"ę","Eopf":"𝔼","eopf":"𝕖","epar":"⋕","eparsl":"⧣","eplus":"⩱","epsi":"ε","Epsilon":"Ε","epsilon":"ε","epsiv":"ϵ","eqcirc":"≖","eqcolon":"≕","eqsim":"≂","eqslantgtr":"⪖","eqslantless":"⪕","Equal":"⩵","equals":"=","EqualTilde":"≂","equest":"≟","Equilibrium":"⇌","equiv":"≡","equivDD":"⩸","eqvparsl":"⧥","erarr":"⥱","erDot":"≓","escr":"ℯ","Escr":"ℰ","esdot":"≐","Esim":"⩳","esim":"≂","Eta":"Η","eta":"η","ETH":"Ð","eth":"ð","Euml":"Ë","euml":"ë","euro":"€","excl":"!","exist":"∃","Exists":"∃","expectation":"ℰ","exponentiale":"ⅇ","ExponentialE":"ⅇ","fallingdotseq":"≒","Fcy":"Ф","fcy":"ф","female":"♀","ffilig":"ﬃ","fflig":"ﬀ","ffllig":"ﬄ","Ffr":"𝔉","ffr":"𝔣","filig":"ﬁ","FilledSmallSquare":"◼","FilledVerySmallSquare":"▪","fjlig":"fj","flat":"♭","fllig":"ﬂ","fltns":"▱","fnof":"ƒ","Fopf":"𝔽","fopf":"𝕗","forall":"∀","ForAll":"∀","fork":"⋔","forkv":"⫙","Fouriertrf":"ℱ","fpartint":"⨍","frac12":"½","frac13":"⅓","frac14":"¼","frac15":"⅕","frac16":"⅙","frac18":"⅛","frac23":"⅔","frac25":"⅖","frac34":"¾","frac35":"⅗","frac38":"⅜","frac45":"⅘","frac56":"⅚","frac58":"⅝","frac78":"⅞","frasl":"⁄","frown":"⌢","fscr":"𝒻","Fscr":"ℱ","gacute":"ǵ","Gamma":"Γ","gamma":"γ","Gammad":"Ϝ","gammad":"ϝ","gap":"⪆","Gbreve":"Ğ","gbreve":"ğ","Gcedil":"Ģ","Gcirc":"Ĝ","gcirc":"ĝ","Gcy":"Г","gcy":"г","Gdot":"Ġ","gdot":"ġ","ge":"≥","gE":"≧","gEl":"⪌","gel":"⋛","geq":"≥","geqq":"≧","geqslant":"⩾","gescc":"⪩","ges":"⩾","gesdot":"⪀","gesdoto":"⪂","gesdotol":"⪄","gesl":"⋛︀","gesles":"⪔","Gfr":"𝔊","gfr":"𝔤","gg":"≫","Gg":"⋙","ggg":"⋙","gimel":"ℷ","GJcy":"Ѓ","gjcy":"ѓ","gla":"⪥","gl":"≷","glE":"⪒","glj":"⪤","gnap":"⪊","gnapprox":"⪊","gne":"⪈","gnE":"≩","gneq":"⪈","gneqq":"≩","gnsim":"⋧","Gopf":"𝔾","gopf":"𝕘","grave":"`","GreaterEqual":"≥","GreaterEqualLess":"⋛","GreaterFullEqual":"≧","GreaterGreater":"⪢","GreaterLess":"≷","GreaterSlantEqual":"⩾","GreaterTilde":"≳","Gscr":"𝒢","gscr":"ℊ","gsim":"≳","gsime":"⪎","gsiml":"⪐","gtcc":"⪧","gtcir":"⩺","gt":">","GT":">","Gt":"≫","gtdot":"⋗","gtlPar":"⦕","gtquest":"⩼","gtrapprox":"⪆","gtrarr":"⥸","gtrdot":"⋗","gtreqless":"⋛","gtreqqless":"⪌","gtrless":"≷","gtrsim":"≳","gvertneqq":"≩︀","gvnE":"≩︀","Hacek":"ˇ","hairsp":" ","half":"½","hamilt":"ℋ","HARDcy":"Ъ","hardcy":"ъ","harrcir":"⥈","harr":"↔","hArr":"⇔","harrw":"↭","Hat":"^","hbar":"ℏ","Hcirc":"Ĥ","hcirc":"ĥ","hearts":"♥","heartsuit":"♥","hellip":"…","hercon":"⊹","hfr":"𝔥","Hfr":"ℌ","HilbertSpace":"ℋ","hksearow":"⤥","hkswarow":"⤦","hoarr":"⇿","homtht":"∻","hookleftarrow":"↩","hookrightarrow":"↪","hopf":"𝕙","Hopf":"ℍ","horbar":"―","HorizontalLine":"─","hscr":"𝒽","Hscr":"ℋ","hslash":"ℏ","Hstrok":"Ħ","hstrok":"ħ","HumpDownHump":"≎","HumpEqual":"≏","hybull":"⁃","hyphen":"‐","Iacute":"Í","iacute":"í","ic":"⁣","Icirc":"Î","icirc":"î","Icy":"И","icy":"и","Idot":"İ","IEcy":"Е","iecy":"е","iexcl":"¡","iff":"⇔","ifr":"𝔦","Ifr":"ℑ","Igrave":"Ì","igrave":"ì","ii":"ⅈ","iiiint":"⨌","iiint":"∭","iinfin":"⧜","iiota":"℩","IJlig":"Ĳ","ijlig":"ĳ","Imacr":"Ī","imacr":"ī","image":"ℑ","ImaginaryI":"ⅈ","imagline":"ℐ","imagpart":"ℑ","imath":"ı","Im":"ℑ","imof":"⊷","imped":"Ƶ","Implies":"⇒","incare":"℅","in":"∈","infin":"∞","infintie":"⧝","inodot":"ı","intcal":"⊺","int":"∫","Int":"∬","integers":"ℤ","Integral":"∫","intercal":"⊺","Intersection":"⋂","intlarhk":"⨗","intprod":"⨼","InvisibleComma":"⁣","InvisibleTimes":"⁢","IOcy":"Ё","iocy":"ё","Iogon":"Į","iogon":"į","Iopf":"𝕀","iopf":"𝕚","Iota":"Ι","iota":"ι","iprod":"⨼","iquest":"¿","iscr":"𝒾","Iscr":"ℐ","isin":"∈","isindot":"⋵","isinE":"⋹","isins":"⋴","isinsv":"⋳","isinv":"∈","it":"⁢","Itilde":"Ĩ","itilde":"ĩ","Iukcy":"І","iukcy":"і","Iuml":"Ï","iuml":"ï","Jcirc":"Ĵ","jcirc":"ĵ","Jcy":"Й","jcy":"й","Jfr":"𝔍","jfr":"𝔧","jmath":"ȷ","Jopf":"𝕁","jopf":"𝕛","Jscr":"𝒥","jscr":"𝒿","Jsercy":"Ј","jsercy":"ј","Jukcy":"Є","jukcy":"є","Kappa":"Κ","kappa":"κ","kappav":"ϰ","Kcedil":"Ķ","kcedil":"ķ","Kcy":"К","kcy":"к","Kfr":"𝔎","kfr":"𝔨","kgreen":"ĸ","KHcy":"Х","khcy":"х","KJcy":"Ќ","kjcy":"ќ","Kopf":"𝕂","kopf":"𝕜","Kscr":"𝒦","kscr":"𝓀","lAarr":"⇚","Lacute":"Ĺ","lacute":"ĺ","laemptyv":"⦴","lagran":"ℒ","Lambda":"Λ","lambda":"λ","lang":"⟨","Lang":"⟪","langd":"⦑","langle":"⟨","lap":"⪅","Laplacetrf":"ℒ","laquo":"«","larrb":"⇤","larrbfs":"⤟","larr":"←","Larr":"↞","lArr":"⇐","larrfs":"⤝","larrhk":"↩","larrlp":"↫","larrpl":"⤹","larrsim":"⥳","larrtl":"↢","latail":"⤙","lAtail":"⤛","lat":"⪫","late":"⪭","lates":"⪭︀","lbarr":"⤌","lBarr":"⤎","lbbrk":"❲","lbrace":"{","lbrack":"[","lbrke":"⦋","lbrksld":"⦏","lbrkslu":"⦍","Lcaron":"Ľ","lcaron":"ľ","Lcedil":"Ļ","lcedil":"ļ","lceil":"⌈","lcub":"{","Lcy":"Л","lcy":"л","ldca":"⤶","ldquo":"“","ldquor":"„","ldrdhar":"⥧","ldrushar":"⥋","ldsh":"↲","le":"≤","lE":"≦","LeftAngleBracket":"⟨","LeftArrowBar":"⇤","leftarrow":"←","LeftArrow":"←","Leftarrow":"⇐","LeftArrowRightArrow":"⇆","leftarrowtail":"↢","LeftCeiling":"⌈","LeftDoubleBracket":"⟦","LeftDownTeeVector":"⥡","LeftDownVectorBar":"⥙","LeftDownVector":"⇃","LeftFloor":"⌊","leftharpoondown":"↽","leftharpoonup":"↼","leftleftarrows":"⇇","leftrightarrow":"↔","LeftRightArrow":"↔","Leftrightarrow":"⇔","leftrightarrows":"⇆","leftrightharpoons":"⇋","leftrightsquigarrow":"↭","LeftRightVector":"⥎","LeftTeeArrow":"↤","LeftTee":"⊣","LeftTeeVector":"⥚","leftthreetimes":"⋋","LeftTriangleBar":"⧏","LeftTriangle":"⊲","LeftTriangleEqual":"⊴","LeftUpDownVector":"⥑","LeftUpTeeVector":"⥠","LeftUpVectorBar":"⥘","LeftUpVector":"↿","LeftVectorBar":"⥒","LeftVector":"↼","lEg":"⪋","leg":"⋚","leq":"≤","leqq":"≦","leqslant":"⩽","lescc":"⪨","les":"⩽","lesdot":"⩿","lesdoto":"⪁","lesdotor":"⪃","lesg":"⋚︀","lesges":"⪓","lessapprox":"⪅","lessdot":"⋖","lesseqgtr":"⋚","lesseqqgtr":"⪋","LessEqualGreater":"⋚","LessFullEqual":"≦","LessGreater":"≶","lessgtr":"≶","LessLess":"⪡","lesssim":"≲","LessSlantEqual":"⩽","LessTilde":"≲","lfisht":"⥼","lfloor":"⌊","Lfr":"𝔏","lfr":"𝔩","lg":"≶","lgE":"⪑","lHar":"⥢","lhard":"↽","lharu":"↼","lharul":"⥪","lhblk":"▄","LJcy":"Љ","ljcy":"љ","llarr":"⇇","ll":"≪","Ll":"⋘","llcorner":"⌞","Lleftarrow":"⇚","llhard":"⥫","lltri":"◺","Lmidot":"Ŀ","lmidot":"ŀ","lmoustache":"⎰","lmoust":"⎰","lnap":"⪉","lnapprox":"⪉","lne":"⪇","lnE":"≨","lneq":"⪇","lneqq":"≨","lnsim":"⋦","loang":"⟬","loarr":"⇽","lobrk":"⟦","longleftarrow":"⟵","LongLeftArrow":"⟵","Longleftarrow":"⟸","longleftrightarrow":"⟷","LongLeftRightArrow":"⟷","Longleftrightarrow":"⟺","longmapsto":"⟼","longrightarrow":"⟶","LongRightArrow":"⟶","Longrightarrow":"⟹","looparrowleft":"↫","looparrowright":"↬","lopar":"⦅","Lopf":"𝕃","lopf":"𝕝","loplus":"⨭","lotimes":"⨴","lowast":"∗","lowbar":"_","LowerLeftArrow":"↙","LowerRightArrow":"↘","loz":"◊","lozenge":"◊","lozf":"⧫","lpar":"(","lparlt":"⦓","lrarr":"⇆","lrcorner":"⌟","lrhar":"⇋","lrhard":"⥭","lrm":"‎","lrtri":"⊿","lsaquo":"‹","lscr":"𝓁","Lscr":"ℒ","lsh":"↰","Lsh":"↰","lsim":"≲","lsime":"⪍","lsimg":"⪏","lsqb":"[","lsquo":"‘","lsquor":"‚","Lstrok":"Ł","lstrok":"ł","ltcc":"⪦","ltcir":"⩹","lt":"<","LT":"<","Lt":"≪","ltdot":"⋖","lthree":"⋋","ltimes":"⋉","ltlarr":"⥶","ltquest":"⩻","ltri":"◃","ltrie":"⊴","ltrif":"◂","ltrPar":"⦖","lurdshar":"⥊","luruhar":"⥦","lvertneqq":"≨︀","lvnE":"≨︀","macr":"¯","male":"♂","malt":"✠","maltese":"✠","Map":"⤅","map":"↦","mapsto":"↦","mapstodown":"↧","mapstoleft":"↤","mapstoup":"↥","marker":"▮","mcomma":"⨩","Mcy":"М","mcy":"м","mdash":"—","mDDot":"∺","measuredangle":"∡","MediumSpace":" ","Mellintrf":"ℳ","Mfr":"𝔐","mfr":"𝔪","mho":"℧","micro":"µ","midast":"*","midcir":"⫰","mid":"∣","middot":"·","minusb":"⊟","minus":"−","minusd":"∸","minusdu":"⨪","MinusPlus":"∓","mlcp":"⫛","mldr":"…","mnplus":"∓","models":"⊧","Mopf":"𝕄","mopf":"𝕞","mp":"∓","mscr":"𝓂","Mscr":"ℳ","mstpos":"∾","Mu":"Μ","mu":"μ","multimap":"⊸","mumap":"⊸","nabla":"∇","Nacute":"Ń","nacute":"ń","nang":"∠⃒","nap":"≉","napE":"⩰̸","napid":"≋̸","napos":"ŉ","napprox":"≉","natural":"♮","naturals":"ℕ","natur":"♮","nbsp":" ","nbump":"≎̸","nbumpe":"≏̸","ncap":"⩃","Ncaron":"Ň","ncaron":"ň","Ncedil":"Ņ","ncedil":"ņ","ncong":"≇","ncongdot":"⩭̸","ncup":"⩂","Ncy":"Н","ncy":"н","ndash":"–","nearhk":"⤤","nearr":"↗","neArr":"⇗","nearrow":"↗","ne":"≠","nedot":"≐̸","NegativeMediumSpace":"​","NegativeThickSpace":"​","NegativeThinSpace":"​","NegativeVeryThinSpace":"​","nequiv":"≢","nesear":"⤨","nesim":"≂̸","NestedGreaterGreater":"≫","NestedLessLess":"≪","NewLine":"\\n","nexist":"∄","nexists":"∄","Nfr":"𝔑","nfr":"𝔫","ngE":"≧̸","nge":"≱","ngeq":"≱","ngeqq":"≧̸","ngeqslant":"⩾̸","nges":"⩾̸","nGg":"⋙̸","ngsim":"≵","nGt":"≫⃒","ngt":"≯","ngtr":"≯","nGtv":"≫̸","nharr":"↮","nhArr":"⇎","nhpar":"⫲","ni":"∋","nis":"⋼","nisd":"⋺","niv":"∋","NJcy":"Њ","njcy":"њ","nlarr":"↚","nlArr":"⇍","nldr":"‥","nlE":"≦̸","nle":"≰","nleftarrow":"↚","nLeftarrow":"⇍","nleftrightarrow":"↮","nLeftrightarrow":"⇎","nleq":"≰","nleqq":"≦̸","nleqslant":"⩽̸","nles":"⩽̸","nless":"≮","nLl":"⋘̸","nlsim":"≴","nLt":"≪⃒","nlt":"≮","nltri":"⋪","nltrie":"⋬","nLtv":"≪̸","nmid":"∤","NoBreak":"⁠","NonBreakingSpace":" ","nopf":"𝕟","Nopf":"ℕ","Not":"⫬","not":"¬","NotCongruent":"≢","NotCupCap":"≭","NotDoubleVerticalBar":"∦","NotElement":"∉","NotEqual":"≠","NotEqualTilde":"≂̸","NotExists":"∄","NotGreater":"≯","NotGreaterEqual":"≱","NotGreaterFullEqual":"≧̸","NotGreaterGreater":"≫̸","NotGreaterLess":"≹","NotGreaterSlantEqual":"⩾̸","NotGreaterTilde":"≵","NotHumpDownHump":"≎̸","NotHumpEqual":"≏̸","notin":"∉","notindot":"⋵̸","notinE":"⋹̸","notinva":"∉","notinvb":"⋷","notinvc":"⋶","NotLeftTriangleBar":"⧏̸","NotLeftTriangle":"⋪","NotLeftTriangleEqual":"⋬","NotLess":"≮","NotLessEqual":"≰","NotLessGreater":"≸","NotLessLess":"≪̸","NotLessSlantEqual":"⩽̸","NotLessTilde":"≴","NotNestedGreaterGreater":"⪢̸","NotNestedLessLess":"⪡̸","notni":"∌","notniva":"∌","notnivb":"⋾","notnivc":"⋽","NotPrecedes":"⊀","NotPrecedesEqual":"⪯̸","NotPrecedesSlantEqual":"⋠","NotReverseElement":"∌","NotRightTriangleBar":"⧐̸","NotRightTriangle":"⋫","NotRightTriangleEqual":"⋭","NotSquareSubset":"⊏̸","NotSquareSubsetEqual":"⋢","NotSquareSuperset":"⊐̸","NotSquareSupersetEqual":"⋣","NotSubset":"⊂⃒","NotSubsetEqual":"⊈","NotSucceeds":"⊁","NotSucceedsEqual":"⪰̸","NotSucceedsSlantEqual":"⋡","NotSucceedsTilde":"≿̸","NotSuperset":"⊃⃒","NotSupersetEqual":"⊉","NotTilde":"≁","NotTildeEqual":"≄","NotTildeFullEqual":"≇","NotTildeTilde":"≉","NotVerticalBar":"∤","nparallel":"∦","npar":"∦","nparsl":"⫽⃥","npart":"∂̸","npolint":"⨔","npr":"⊀","nprcue":"⋠","nprec":"⊀","npreceq":"⪯̸","npre":"⪯̸","nrarrc":"⤳̸","nrarr":"↛","nrArr":"⇏","nrarrw":"↝̸","nrightarrow":"↛","nRightarrow":"⇏","nrtri":"⋫","nrtrie":"⋭","nsc":"⊁","nsccue":"⋡","nsce":"⪰̸","Nscr":"𝒩","nscr":"𝓃","nshortmid":"∤","nshortparallel":"∦","nsim":"≁","nsime":"≄","nsimeq":"≄","nsmid":"∤","nspar":"∦","nsqsube":"⋢","nsqsupe":"⋣","nsub":"⊄","nsubE":"⫅̸","nsube":"⊈","nsubset":"⊂⃒","nsubseteq":"⊈","nsubseteqq":"⫅̸","nsucc":"⊁","nsucceq":"⪰̸","nsup":"⊅","nsupE":"⫆̸","nsupe":"⊉","nsupset":"⊃⃒","nsupseteq":"⊉","nsupseteqq":"⫆̸","ntgl":"≹","Ntilde":"Ñ","ntilde":"ñ","ntlg":"≸","ntriangleleft":"⋪","ntrianglelefteq":"⋬","ntriangleright":"⋫","ntrianglerighteq":"⋭","Nu":"Ν","nu":"ν","num":"#","numero":"№","numsp":" ","nvap":"≍⃒","nvdash":"⊬","nvDash":"⊭","nVdash":"⊮","nVDash":"⊯","nvge":"≥⃒","nvgt":">⃒","nvHarr":"⤄","nvinfin":"⧞","nvlArr":"⤂","nvle":"≤⃒","nvlt":"<⃒","nvltrie":"⊴⃒","nvrArr":"⤃","nvrtrie":"⊵⃒","nvsim":"∼⃒","nwarhk":"⤣","nwarr":"↖","nwArr":"⇖","nwarrow":"↖","nwnear":"⤧","Oacute":"Ó","oacute":"ó","oast":"⊛","Ocirc":"Ô","ocirc":"ô","ocir":"⊚","Ocy":"О","ocy":"о","odash":"⊝","Odblac":"Ő","odblac":"ő","odiv":"⨸","odot":"⊙","odsold":"⦼","OElig":"Œ","oelig":"œ","ofcir":"⦿","Ofr":"𝔒","ofr":"𝔬","ogon":"˛","Ograve":"Ò","ograve":"ò","ogt":"⧁","ohbar":"⦵","ohm":"Ω","oint":"∮","olarr":"↺","olcir":"⦾","olcross":"⦻","oline":"‾","olt":"⧀","Omacr":"Ō","omacr":"ō","Omega":"Ω","omega":"ω","Omicron":"Ο","omicron":"ο","omid":"⦶","ominus":"⊖","Oopf":"𝕆","oopf":"𝕠","opar":"⦷","OpenCurlyDoubleQuote":"“","OpenCurlyQuote":"‘","operp":"⦹","oplus":"⊕","orarr":"↻","Or":"⩔","or":"∨","ord":"⩝","order":"ℴ","orderof":"ℴ","ordf":"ª","ordm":"º","origof":"⊶","oror":"⩖","orslope":"⩗","orv":"⩛","oS":"Ⓢ","Oscr":"𝒪","oscr":"ℴ","Oslash":"Ø","oslash":"ø","osol":"⊘","Otilde":"Õ","otilde":"õ","otimesas":"⨶","Otimes":"⨷","otimes":"⊗","Ouml":"Ö","ouml":"ö","ovbar":"⌽","OverBar":"‾","OverBrace":"⏞","OverBracket":"⎴","OverParenthesis":"⏜","para":"¶","parallel":"∥","par":"∥","parsim":"⫳","parsl":"⫽","part":"∂","PartialD":"∂","Pcy":"П","pcy":"п","percnt":"%","period":".","permil":"‰","perp":"⊥","pertenk":"‱","Pfr":"𝔓","pfr":"𝔭","Phi":"Φ","phi":"φ","phiv":"ϕ","phmmat":"ℳ","phone":"☎","Pi":"Π","pi":"π","pitchfork":"⋔","piv":"ϖ","planck":"ℏ","planckh":"ℎ","plankv":"ℏ","plusacir":"⨣","plusb":"⊞","pluscir":"⨢","plus":"+","plusdo":"∔","plusdu":"⨥","pluse":"⩲","PlusMinus":"±","plusmn":"±","plussim":"⨦","plustwo":"⨧","pm":"±","Poincareplane":"ℌ","pointint":"⨕","popf":"𝕡","Popf":"ℙ","pound":"£","prap":"⪷","Pr":"⪻","pr":"≺","prcue":"≼","precapprox":"⪷","prec":"≺","preccurlyeq":"≼","Precedes":"≺","PrecedesEqual":"⪯","PrecedesSlantEqual":"≼","PrecedesTilde":"≾","preceq":"⪯","precnapprox":"⪹","precneqq":"⪵","precnsim":"⋨","pre":"⪯","prE":"⪳","precsim":"≾","prime":"′","Prime":"″","primes":"ℙ","prnap":"⪹","prnE":"⪵","prnsim":"⋨","prod":"∏","Product":"∏","profalar":"⌮","profline":"⌒","profsurf":"⌓","prop":"∝","Proportional":"∝","Proportion":"∷","propto":"∝","prsim":"≾","prurel":"⊰","Pscr":"𝒫","pscr":"𝓅","Psi":"Ψ","psi":"ψ","puncsp":" ","Qfr":"𝔔","qfr":"𝔮","qint":"⨌","qopf":"𝕢","Qopf":"ℚ","qprime":"⁗","Qscr":"𝒬","qscr":"𝓆","quaternions":"ℍ","quatint":"⨖","quest":"?","questeq":"≟","quot":"\\"","QUOT":"\\"","rAarr":"⇛","race":"∽̱","Racute":"Ŕ","racute":"ŕ","radic":"√","raemptyv":"⦳","rang":"⟩","Rang":"⟫","rangd":"⦒","range":"⦥","rangle":"⟩","raquo":"»","rarrap":"⥵","rarrb":"⇥","rarrbfs":"⤠","rarrc":"⤳","rarr":"→","Rarr":"↠","rArr":"⇒","rarrfs":"⤞","rarrhk":"↪","rarrlp":"↬","rarrpl":"⥅","rarrsim":"⥴","Rarrtl":"⤖","rarrtl":"↣","rarrw":"↝","ratail":"⤚","rAtail":"⤜","ratio":"∶","rationals":"ℚ","rbarr":"⤍","rBarr":"⤏","RBarr":"⤐","rbbrk":"❳","rbrace":"}","rbrack":"]","rbrke":"⦌","rbrksld":"⦎","rbrkslu":"⦐","Rcaron":"Ř","rcaron":"ř","Rcedil":"Ŗ","rcedil":"ŗ","rceil":"⌉","rcub":"}","Rcy":"Р","rcy":"р","rdca":"⤷","rdldhar":"⥩","rdquo":"”","rdquor":"”","rdsh":"↳","real":"ℜ","realine":"ℛ","realpart":"ℜ","reals":"ℝ","Re":"ℜ","rect":"▭","reg":"®","REG":"®","ReverseElement":"∋","ReverseEquilibrium":"⇋","ReverseUpEquilibrium":"⥯","rfisht":"⥽","rfloor":"⌋","rfr":"𝔯","Rfr":"ℜ","rHar":"⥤","rhard":"⇁","rharu":"⇀","rharul":"⥬","Rho":"Ρ","rho":"ρ","rhov":"ϱ","RightAngleBracket":"⟩","RightArrowBar":"⇥","rightarrow":"→","RightArrow":"→","Rightarrow":"⇒","RightArrowLeftArrow":"⇄","rightarrowtail":"↣","RightCeiling":"⌉","RightDoubleBracket":"⟧","RightDownTeeVector":"⥝","RightDownVectorBar":"⥕","RightDownVector":"⇂","RightFloor":"⌋","rightharpoondown":"⇁","rightharpoonup":"⇀","rightleftarrows":"⇄","rightleftharpoons":"⇌","rightrightarrows":"⇉","rightsquigarrow":"↝","RightTeeArrow":"↦","RightTee":"⊢","RightTeeVector":"⥛","rightthreetimes":"⋌","RightTriangleBar":"⧐","RightTriangle":"⊳","RightTriangleEqual":"⊵","RightUpDownVector":"⥏","RightUpTeeVector":"⥜","RightUpVectorBar":"⥔","RightUpVector":"↾","RightVectorBar":"⥓","RightVector":"⇀","ring":"˚","risingdotseq":"≓","rlarr":"⇄","rlhar":"⇌","rlm":"‏","rmoustache":"⎱","rmoust":"⎱","rnmid":"⫮","roang":"⟭","roarr":"⇾","robrk":"⟧","ropar":"⦆","ropf":"𝕣","Ropf":"ℝ","roplus":"⨮","rotimes":"⨵","RoundImplies":"⥰","rpar":")","rpargt":"⦔","rppolint":"⨒","rrarr":"⇉","Rrightarrow":"⇛","rsaquo":"›","rscr":"𝓇","Rscr":"ℛ","rsh":"↱","Rsh":"↱","rsqb":"]","rsquo":"’","rsquor":"’","rthree":"⋌","rtimes":"⋊","rtri":"▹","rtrie":"⊵","rtrif":"▸","rtriltri":"⧎","RuleDelayed":"⧴","ruluhar":"⥨","rx":"℞","Sacute":"Ś","sacute":"ś","sbquo":"‚","scap":"⪸","Scaron":"Š","scaron":"š","Sc":"⪼","sc":"≻","sccue":"≽","sce":"⪰","scE":"⪴","Scedil":"Ş","scedil":"ş","Scirc":"Ŝ","scirc":"ŝ","scnap":"⪺","scnE":"⪶","scnsim":"⋩","scpolint":"⨓","scsim":"≿","Scy":"С","scy":"с","sdotb":"⊡","sdot":"⋅","sdote":"⩦","searhk":"⤥","searr":"↘","seArr":"⇘","searrow":"↘","sect":"§","semi":";","seswar":"⤩","setminus":"∖","setmn":"∖","sext":"✶","Sfr":"𝔖","sfr":"𝔰","sfrown":"⌢","sharp":"♯","SHCHcy":"Щ","shchcy":"щ","SHcy":"Ш","shcy":"ш","ShortDownArrow":"↓","ShortLeftArrow":"←","shortmid":"∣","shortparallel":"∥","ShortRightArrow":"→","ShortUpArrow":"↑","shy":"­","Sigma":"Σ","sigma":"σ","sigmaf":"ς","sigmav":"ς","sim":"∼","simdot":"⩪","sime":"≃","simeq":"≃","simg":"⪞","simgE":"⪠","siml":"⪝","simlE":"⪟","simne":"≆","simplus":"⨤","simrarr":"⥲","slarr":"←","SmallCircle":"∘","smallsetminus":"∖","smashp":"⨳","smeparsl":"⧤","smid":"∣","smile":"⌣","smt":"⪪","smte":"⪬","smtes":"⪬︀","SOFTcy":"Ь","softcy":"ь","solbar":"⌿","solb":"⧄","sol":"/","Sopf":"𝕊","sopf":"𝕤","spades":"♠","spadesuit":"♠","spar":"∥","sqcap":"⊓","sqcaps":"⊓︀","sqcup":"⊔","sqcups":"⊔︀","Sqrt":"√","sqsub":"⊏","sqsube":"⊑","sqsubset":"⊏","sqsubseteq":"⊑","sqsup":"⊐","sqsupe":"⊒","sqsupset":"⊐","sqsupseteq":"⊒","square":"□","Square":"□","SquareIntersection":"⊓","SquareSubset":"⊏","SquareSubsetEqual":"⊑","SquareSuperset":"⊐","SquareSupersetEqual":"⊒","SquareUnion":"⊔","squarf":"▪","squ":"□","squf":"▪","srarr":"→","Sscr":"𝒮","sscr":"𝓈","ssetmn":"∖","ssmile":"⌣","sstarf":"⋆","Star":"⋆","star":"☆","starf":"★","straightepsilon":"ϵ","straightphi":"ϕ","strns":"¯","sub":"⊂","Sub":"⋐","subdot":"⪽","subE":"⫅","sube":"⊆","subedot":"⫃","submult":"⫁","subnE":"⫋","subne":"⊊","subplus":"⪿","subrarr":"⥹","subset":"⊂","Subset":"⋐","subseteq":"⊆","subseteqq":"⫅","SubsetEqual":"⊆","subsetneq":"⊊","subsetneqq":"⫋","subsim":"⫇","subsub":"⫕","subsup":"⫓","succapprox":"⪸","succ":"≻","succcurlyeq":"≽","Succeeds":"≻","SucceedsEqual":"⪰","SucceedsSlantEqual":"≽","SucceedsTilde":"≿","succeq":"⪰","succnapprox":"⪺","succneqq":"⪶","succnsim":"⋩","succsim":"≿","SuchThat":"∋","sum":"∑","Sum":"∑","sung":"♪","sup1":"¹","sup2":"²","sup3":"³","sup":"⊃","Sup":"⋑","supdot":"⪾","supdsub":"⫘","supE":"⫆","supe":"⊇","supedot":"⫄","Superset":"⊃","SupersetEqual":"⊇","suphsol":"⟉","suphsub":"⫗","suplarr":"⥻","supmult":"⫂","supnE":"⫌","supne":"⊋","supplus":"⫀","supset":"⊃","Supset":"⋑","supseteq":"⊇","supseteqq":"⫆","supsetneq":"⊋","supsetneqq":"⫌","supsim":"⫈","supsub":"⫔","supsup":"⫖","swarhk":"⤦","swarr":"↙","swArr":"⇙","swarrow":"↙","swnwar":"⤪","szlig":"ß","Tab":"\\t","target":"⌖","Tau":"Τ","tau":"τ","tbrk":"⎴","Tcaron":"Ť","tcaron":"ť","Tcedil":"Ţ","tcedil":"ţ","Tcy":"Т","tcy":"т","tdot":"⃛","telrec":"⌕","Tfr":"𝔗","tfr":"𝔱","there4":"∴","therefore":"∴","Therefore":"∴","Theta":"Θ","theta":"θ","thetasym":"ϑ","thetav":"ϑ","thickapprox":"≈","thicksim":"∼","ThickSpace":"  ","ThinSpace":" ","thinsp":" ","thkap":"≈","thksim":"∼","THORN":"Þ","thorn":"þ","tilde":"˜","Tilde":"∼","TildeEqual":"≃","TildeFullEqual":"≅","TildeTilde":"≈","timesbar":"⨱","timesb":"⊠","times":"×","timesd":"⨰","tint":"∭","toea":"⤨","topbot":"⌶","topcir":"⫱","top":"⊤","Topf":"𝕋","topf":"𝕥","topfork":"⫚","tosa":"⤩","tprime":"‴","trade":"™","TRADE":"™","triangle":"▵","triangledown":"▿","triangleleft":"◃","trianglelefteq":"⊴","triangleq":"≜","triangleright":"▹","trianglerighteq":"⊵","tridot":"◬","trie":"≜","triminus":"⨺","TripleDot":"⃛","triplus":"⨹","trisb":"⧍","tritime":"⨻","trpezium":"⏢","Tscr":"𝒯","tscr":"𝓉","TScy":"Ц","tscy":"ц","TSHcy":"Ћ","tshcy":"ћ","Tstrok":"Ŧ","tstrok":"ŧ","twixt":"≬","twoheadleftarrow":"↞","twoheadrightarrow":"↠","Uacute":"Ú","uacute":"ú","uarr":"↑","Uarr":"↟","uArr":"⇑","Uarrocir":"⥉","Ubrcy":"Ў","ubrcy":"ў","Ubreve":"Ŭ","ubreve":"ŭ","Ucirc":"Û","ucirc":"û","Ucy":"У","ucy":"у","udarr":"⇅","Udblac":"Ű","udblac":"ű","udhar":"⥮","ufisht":"⥾","Ufr":"𝔘","ufr":"𝔲","Ugrave":"Ù","ugrave":"ù","uHar":"⥣","uharl":"↿","uharr":"↾","uhblk":"▀","ulcorn":"⌜","ulcorner":"⌜","ulcrop":"⌏","ultri":"◸","Umacr":"Ū","umacr":"ū","uml":"¨","UnderBar":"_","UnderBrace":"⏟","UnderBracket":"⎵","UnderParenthesis":"⏝","Union":"⋃","UnionPlus":"⊎","Uogon":"Ų","uogon":"ų","Uopf":"𝕌","uopf":"𝕦","UpArrowBar":"⤒","uparrow":"↑","UpArrow":"↑","Uparrow":"⇑","UpArrowDownArrow":"⇅","updownarrow":"↕","UpDownArrow":"↕","Updownarrow":"⇕","UpEquilibrium":"⥮","upharpoonleft":"↿","upharpoonright":"↾","uplus":"⊎","UpperLeftArrow":"↖","UpperRightArrow":"↗","upsi":"υ","Upsi":"ϒ","upsih":"ϒ","Upsilon":"Υ","upsilon":"υ","UpTeeArrow":"↥","UpTee":"⊥","upuparrows":"⇈","urcorn":"⌝","urcorner":"⌝","urcrop":"⌎","Uring":"Ů","uring":"ů","urtri":"◹","Uscr":"𝒰","uscr":"𝓊","utdot":"⋰","Utilde":"Ũ","utilde":"ũ","utri":"▵","utrif":"▴","uuarr":"⇈","Uuml":"Ü","uuml":"ü","uwangle":"⦧","vangrt":"⦜","varepsilon":"ϵ","varkappa":"ϰ","varnothing":"∅","varphi":"ϕ","varpi":"ϖ","varpropto":"∝","varr":"↕","vArr":"⇕","varrho":"ϱ","varsigma":"ς","varsubsetneq":"⊊︀","varsubsetneqq":"⫋︀","varsupsetneq":"⊋︀","varsupsetneqq":"⫌︀","vartheta":"ϑ","vartriangleleft":"⊲","vartriangleright":"⊳","vBar":"⫨","Vbar":"⫫","vBarv":"⫩","Vcy":"В","vcy":"в","vdash":"⊢","vDash":"⊨","Vdash":"⊩","VDash":"⊫","Vdashl":"⫦","veebar":"⊻","vee":"∨","Vee":"⋁","veeeq":"≚","vellip":"⋮","verbar":"|","Verbar":"‖","vert":"|","Vert":"‖","VerticalBar":"∣","VerticalLine":"|","VerticalSeparator":"❘","VerticalTilde":"≀","VeryThinSpace":" ","Vfr":"𝔙","vfr":"𝔳","vltri":"⊲","vnsub":"⊂⃒","vnsup":"⊃⃒","Vopf":"𝕍","vopf":"𝕧","vprop":"∝","vrtri":"⊳","Vscr":"𝒱","vscr":"𝓋","vsubnE":"⫋︀","vsubne":"⊊︀","vsupnE":"⫌︀","vsupne":"⊋︀","Vvdash":"⊪","vzigzag":"⦚","Wcirc":"Ŵ","wcirc":"ŵ","wedbar":"⩟","wedge":"∧","Wedge":"⋀","wedgeq":"≙","weierp":"℘","Wfr":"𝔚","wfr":"𝔴","Wopf":"𝕎","wopf":"𝕨","wp":"℘","wr":"≀","wreath":"≀","Wscr":"𝒲","wscr":"𝓌","xcap":"⋂","xcirc":"◯","xcup":"⋃","xdtri":"▽","Xfr":"𝔛","xfr":"𝔵","xharr":"⟷","xhArr":"⟺","Xi":"Ξ","xi":"ξ","xlarr":"⟵","xlArr":"⟸","xmap":"⟼","xnis":"⋻","xodot":"⨀","Xopf":"𝕏","xopf":"𝕩","xoplus":"⨁","xotime":"⨂","xrarr":"⟶","xrArr":"⟹","Xscr":"𝒳","xscr":"𝓍","xsqcup":"⨆","xuplus":"⨄","xutri":"△","xvee":"⋁","xwedge":"⋀","Yacute":"Ý","yacute":"ý","YAcy":"Я","yacy":"я","Ycirc":"Ŷ","ycirc":"ŷ","Ycy":"Ы","ycy":"ы","yen":"¥","Yfr":"𝔜","yfr":"𝔶","YIcy":"Ї","yicy":"ї","Yopf":"𝕐","yopf":"𝕪","Yscr":"𝒴","yscr":"𝓎","YUcy":"Ю","yucy":"ю","yuml":"ÿ","Yuml":"Ÿ","Zacute":"Ź","zacute":"ź","Zcaron":"Ž","zcaron":"ž","Zcy":"З","zcy":"з","Zdot":"Ż","zdot":"ż","zeetrf":"ℨ","ZeroWidthSpace":"​","Zeta":"Ζ","zeta":"ζ","zfr":"𝔷","Zfr":"ℨ","ZHcy":"Ж","zhcy":"ж","zigrarr":"⇝","zopf":"𝕫","Zopf":"ℤ","Zscr":"𝒵","zscr":"𝓏","zwj":"‍","zwnj":"‌"}')}}]);
//# sourceMappingURL=vendors~copilotchatdisplay.js.map