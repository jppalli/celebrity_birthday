var TypeScriptModule;(()=>{var e,t,n,o,i,r={501245:(e,t,n)=>{"use strict";var o,i;!function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(o||(o={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(i||(i={}));var r,a,s,c,l,u,d,f,p,h,g,v,y,b,m,C=void 0,E=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]};!function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.SubFeatureName="SubFeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(s||(s={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.ExtensibilityDialog="ExtensibilityDialog",e.LocalAddinActionExecution="LocalAddinActionExecution"}(c||(c={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(l||(l={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.PodcastFromNudgeTriggered="Podcast_From_Nudge_Triggered",e.DescribeImageFromNudgeTriggered="Describe_Image_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.ExtensibilityDialogLoad="Extensibility_Dialog_Load",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened",e.OpenMOSDialog="Open_MOS_Store_To_Get_Agents",e.MOSStoreDialogResponse="MOS_Store_Dialog_Response",e.VoiceCopilotZQMSubmitted="Voice_Copilot_ZQM_Submitted",e.VoiceCopilotZQMResponseRendered="Voice_Copilot_ZQM_Response_Rendered",e.VoiceCopilotZQMResponseClicked="Voice_Copilot_ZQM_Response_Clicked",e.VoiceCopilotZQMAutoStarted="Voice_Copilot_ZQM_Auto_Started",e.ChatHistorySignalSubmitted="Chat_History_Signal_Submitted",e.ConversationIdUndefined="Conversation_Id_Undefined",e.UpdateChatSessionId="Update_Chat_Session_Id",e.CannotUpdateChatSessionId="Cannot_Update_Chat_Session_Id",e.SubmitOperationUndefined="Submit_Operation_Undefined",e.ConnectionHealth="Connection_Health",e.InsightsCardRelatedFilesResponse="Insights_Card_RelatedFiles_Response",e.AugLoopOfficeCopilotOrchestrationCopilotRelatedFilesError="AugLoop_OfficeCopilotOrchestration_CopilotRelatedFiles_Error",e.InsightsCardRelatedFilesSignalSent="Insights_Card_RelatedFiles_Signal_Sent",e.InsightsCardCocoaSkillResponse="Insights_Card_CocoaSkill_{Skill}_Response",e.InsightsCardCocoaSkillResponseUpdating="Insights_Card_CocoaSkill_{Skill}_Response_Updating",e.InsightsCardCocoaSkillResponseLoaded="Insights_Card_CocoaSkill_{Skill}_Response_Loaded",e.InsightsCardCocoaSkillResponseError="Insights_Card_CocoaSkill_{Skill}_Response_Error",e.InsightsCardCocoaSkillResponseTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_TimedOut",e.InsightsCardCocoaSkillResponseRetryTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_Retry_TimedOut",e.InsightsCardCocoaSkillCardClicked="Insights_Card_CocoaSkill_{Skill}_CardClicked",e.InsightsCardCocoaSkillCardNavigatedTo="Insights_Card_CocoaSkill_{Skill}_CardNavigatedTo",e.LocalAddinActionInvoked="Local_Addin_Action_Invoked",e.LocalAddinExecutionCompletedFromHost="Local_Addin_Action_Completed_From_Host",e.LocalAddinExecutionFailedFromHost="Local_Addin_Action_Failed_From_Host",e.LocalAddinExecutionReceivedMultipleRequests="Local_Addin_Action_Received_Multiple_Requests",e.LocalAddinExecutionReceivedSingleRequest="Local_Addin_Action_Received_Single_Request",e.LocalAddinExecutionStarted="Local_Addin_Action_Started",e.StopGeneratingButtonClickedDuringAddinExecution="Stop_Generating_Button_Clicked_During_Addin_Execution",e.UndoButtonClickedAfterAddinSuccess="Undo_Button_Clicked_After_Addin_Success",e.UndoButtonHiddenOnSubmittingQueryAfterAddinSuccess="Undo_Button_Hidden_On_Submitting_Query_After_Addin_Success",e.UndoButtonShownAfterAddinSuccess="Undo_Button_Shown_After_Addin_Success"}(u||(u={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode",e.ErrorStack="ErrorStack"}(d||(d={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat",e.Extensibility="Extensibility"}(f||(f={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(p||(p={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile",e.AddInActionsForAgents="Add-in Actions for Agents"}(h||(h={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(g||(g={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(v||(v={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(y||(y={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(b||(b={})),function(e){e[e.Warning=400]="Warning",e[e.ASHA=450]="ASHA",e[e.Error=500]="Error",e[e.Critical=600]="Critical"}(m||(m={})),function(e){e.Error="Error",e.UncaughtException="UncaughtException",e.ChatEvents="ChatEvents",e.AssertionFailed="AssertionFailed"}(c||(c={}));var I=function(e){return L(e)/1e3},L=function(e){return(new Date).getTime()-e},S=(function(){function e(){var e=this;this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.resetPersonalizationHITLActionState=function(){e.isPersonalizationHITLResponseCardActive=!1,e.personalizationHITLActionButtonList=[]},this.resetPersonalizationLatencyState=function(){e.personalizationHITLCardActivationTime=0,e.personalizationHITLCardUserInteractionTime=0},this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.personalizationHITLCardActivationTime=0}e.getInstance=function(){return ne(e.personalizationHITLActionStateHandler)&&(e.personalizationHITLActionStateHandler=new e),e.personalizationHITLActionStateHandler},e.prototype.getIsPersonalizationHITLResponseCardActive=function(){return this.isPersonalizationHITLResponseCardActive},e.prototype.setIsPersonalizationHITLResponseCardActive=function(e){this.isPersonalizationHITLResponseCardActive=e},e.prototype.getPersonalizationHITLActionButtonList=function(){return this.personalizationHITLActionButtonList},e.prototype.setPersonalizationHITLActionButtonList=function(e){this.personalizationHITLActionButtonList=e},e.prototype.setPersonalizationHITLCardActivationTime=function(e){this.personalizationHITLCardActivationTime=e},e.prototype.getPersonalizationHITLUserInteractionTime=function(){return this.personalizationHITLCardUserInteractionTime},e.prototype.shouldConsiderPersonalizationHITLUserInteractionLatency=function(){return 0!==this.personalizationHITLCardActivationTime},e.prototype.setPersonalizationHITLUserInteractionTime=function(){this.personalizationHITLCardUserInteractionTime=I(this.personalizationHITLCardActivationTime)}}(),"AugLoopChat".concat(C)),A=function(){function e(){}return e.generateId=function(){return e.operationId++,S+e.operationId.toString()},e.operationId=0,e}(),w=function(){var e=0,t=n(473023);if(void 0!==(null==t?void 0:t.querySubmitTime))return e=t.querySubmitTime;var o=n(625771);return void 0!==(null==o?void 0:o.querySubmitTime)?e=o.querySubmitTime:e},T=function(e,t,n){var o;r.sendErrorTelemetry(k(((o={})[d.ErrorMessage]="".concat(e),o[d.ErrorCategory]=c.CLP,o[d.ErrorCode]=t,o[d.ErrorStack]=n,o)))},P=function(e){var t;r.sendChatEventTelemetry(k(((t={})[l.ChatEventType]=u.OfficeJsApiCallForCLP,t[l.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},k=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};function D(e){r.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function O(e,t){return e+" "+t}var x,_,M,N,R,H,F,U,q,B,z,j,G,W,Q,J=function(e,t,n){var o;r.sendLatencyTelemetry(k(((o={})[s.FeatureName]="ExtensibilityDialogLoad",o[s.UserPerceivedLatency]=e,o[s.IsQuerySuccess]=t,o[s.ErrorChatEventType]=t?"":u.ExtensibilityDialogLoad,o[s.ErrorChatEventParameter]=t?"":n,o)),!0)},V=function(e){var t;r.sendErrorTelemetry(k(((t={})[d.ErrorMessage]=e,t[d.ErrorCategory]=c.ExtensibilityDialog,t[d.ErrorCode]="ExtensibilityDialogLoadError",t)))},K="https://login.microsoftonline.com/common",Y=n(649242),Z=n(758651),$=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},X=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ee=function(){function e(e){this.params=e}return e.prototype.loadMsalBrowser=function(){return $(this,void 0,void 0,(function(){var e,t,o;return X(this,(function(i){switch(i.label){case 0:e=1,i.label=1;case 1:if(!(e<=3))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),t=this,[4,Promise.all([n.e("vendors~shared"),n.e("vendors~auth-msal-browser")]).then(n.bind(n,599807))];case 3:return t.msalModule=i.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(o=i.sent(),Z.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),o),3===e)throw o;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.getAuthorityAsPerEnv=function(){var e;return!!(null===(e=this.params)||void 0===e?void 0:e.appEnvironment)&&this.params.appEnvironment.length>0&&this.params.appEnvironment===Y.D.DOD?"https://login.microsoftonline.us/common":K},e.prototype.createPublicClientApplication=function(e){return $(this,void 0,void 0,(function(){var t,n,o,i,r;return X(this,(function(a){return t=null!==(r=null===(i=this.params)||void 0===i?void 0:i.clientId)&&void 0!==r?r:"6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",n=this.params.redirectUri,o=this.getAuthorityAsPerEnv(),[2,new e({auth:{clientId:t,authority:o,redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})]}))}))},e.prototype.getToken=function(e,t,n){return $(this,void 0,void 0,(function(){var t,o,i,a,s,c;return X(this,(function(d){switch(d.label){case 0:return E("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:d.sent(),d.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=d.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(c=this.params)||void 0===c?void 0:c.logTelemetry)&&r.sendChatEventTelemetry(k(((s={})[l.ChatEventType]=u.MSALTokenRequested,s))),o=void 0,d.label=4;case 4:return d.trys.push([4,10,,14]),[4,t.initialize()];case 5:return d.sent(),0!==(null==(i=t.getAllAccounts())?void 0:i.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,d.sent()];case 7:return[4,this.getSelectedAccount(i,t)];case 8:if(!(o=d.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[4,this.acquireTokenSilent(e,o,t,n)];case 9:return[2,d.sent()];case 10:return a=d.sent(),E("Failed to get access token: ".concat(null==a?void 0:a.message)),this.msalModule&&a instanceof this.msalModule.InteractionRequiredAuthError?[4,this.acquireTokenPopup(e,o,t)]:[3,12];case 11:return[2,d.sent()];case 12:throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),a;case 13:return[3,14];case 14:return[2]}}))}))},e.prototype.getAccountInfoFromCache=function(){return $(this,void 0,void 0,(function(){var e,t,n=this;return X(this,(function(o){switch(o.label){case 0:return this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:o.sent(),o.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(e=o.sent()))throw this.logTokenAcquiredError("Failed to get account info - Could not load msal module"),new Error("Failed to get account info - Could not load msal module");return[4,e.initialize()];case 4:return o.sent(),[2,null!==(t=e.getAllAccounts().find((function(e){var t,o,i;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(i=null===(o=n.params)||void 0===o?void 0:o.userPrincipalName)||void 0===i?void 0:i.toLowerCase())})))&&void 0!==t?t:null]}}))}))},e.prototype.getSelectedAccount=function(e,t){return $(this,void 0,void 0,(function(){var n,o,i,r,a=this;return X(this,(function(s){switch(s.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(i=s.sent())?void 0:i.account];case 2:if(!e||0===e.length)return[2,null];if(n=this.params?null!==(r=e.find((function(e){var t,n,o;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(o=null===(n=a.params)||void 0===n?void 0:n.userPrincipalName)||void 0===o?void 0:o.toLowerCase())})))&&void 0!==r?r:null:e[0],n)return[2,n];o=this.params?{loginHint:this.params.userPrincipalName}:void 0,s.label=3;case 3:return s.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(o),[4,this.loginPopupPromise];case 4:return[2,null==(i=s.sent())?void 0:i.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){return $(this,void 0,void 0,(function(){var n,o,i;return X(this,(function(r){switch(r.label){case 0:return n={scopes:["".concat(e,"/.default")],loginHint:null===(i=this.params)||void 0===i?void 0:i.userPrincipalName},[4,t.ssoSilent(n)];case 1:return(o=r.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,o]}}))}))},e.prototype.acquireTokenSilent=function(e,t,n,o){return $(this,void 0,void 0,(function(){var i,r;return X(this,(function(a){switch(a.label){case 0:return i={scopes:null!=o?o:["".concat(e,"/.default")],account:t},[4,n.acquireTokenSilent(i)];case 1:return(r=a.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,r]}}))}))},e.prototype.acquireTokenPopup=function(e,t,n){return $(this,void 0,void 0,(function(){var o,i;return X(this,(function(r){switch(r.label){case 0:return o={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenPopup(o)];case 1:return(i=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,i]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,n;(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&r.sendErrorTelemetry(k(((t={})[d.ErrorCategory]=c.MSAL,t[d.ErrorMessage]=e,t)))},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(x||(x={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(_||(_={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(M||(M={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(N||(N={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(R||(R={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(H||(H={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(F||(F={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}(U||(U={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(q||(q={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(B||(B={})),function(e){e.Image="IMAGE",e.Video="VIDEO"}(z||(z={})),function(e){e.KeepIt="KeepIt",e.Undo="Undo",e.Insert="Insert",e.Copy="Copy",e.Custom="Custom",e.CustomiPad="CustomiPad",e.None="None"}(j||(j={})),function(e){e.Activated="Activated",e.Removed="Removed",e.ActivateCopilotAgent="activateCopilotAgent",e.RemoveCopilotAgent="removeCopilotAgent"}(G||(G={})),function(e){e.BizchatHostContextUpdate="BizChatHostContextUpdate"}(W||(W={})),function(e){e[e.LaunchMos=2001]="LaunchMos",e[e.GetFullDocumentHtml=2003]="GetFullDocumentHtml",e[e.TriggerAgentAction=2004]="TriggerAgentAction"}(Q||(Q={}));var te=n(486092);function ne(e){return null==e}var oe=function(){return"undefined"!=typeof OfficeaicopilotStrings};var ie,re,ae=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","zh-CN"],se=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","pt-PT","ru-RU","sv-SE","th-TH","tr-TR","uk-UA","zh-TW"],ce=["ar-SA","he-IL"],le=["ca-ES","cy-GB"],ue=["bg-BG","el-GR","et-EE","hr-HR","id-ID","lt-LT","lv-LV","ro-RO","sk-SK","sl-SI","sr-Latn-RS","vi-VN"],de=["sq-AL","fil-PH","is-IS","kk-KZ","ms-MY","mt-MT","sr-Cyrl-RS"],fe=(ie=function(e,t){return ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ie(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ie(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),pe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return fe(t,e),t}(function(e){function t(t,n){var o=e.call(this,n)||this;return o.name=t,o}return fe(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(re||(re={}));!function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.isTier4LanguagesEnabled=!1,this.supportedLanguages=[]}Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier4LanguagesEnabled",{set:function(e){this.isTier4LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var n=1;n<t.length-1;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),n=0;n<this.supportedLanguages.length;n++){var o=this.supportedLanguages[n];if(t[0]===o.split("-")[0])return o}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new pe(re.InvalidInput," Display Language is undefined or null");var n=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(n),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.supportedLanguages=ae,this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(se),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(ce))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(ue)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(le)),this.isTier4LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(de))}}();var he=n(208520);n(758651);new(function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}())({iteration:0});var ge=function(){function e(){}return e.isWebPlatform=function(){return Office.context.platform===Office.PlatformType.OfficeOnline},e.isMacPlatform=function(){return Office.context.platform===Office.PlatformType.Mac},e.isIOSPlatform=function(){return Office.context.platform===Office.PlatformType.iOS},e.isWin32Platform=function(){return Office.context.platform===Office.PlatformType.PC},e}();ge.isWebPlatform,ge.isMacPlatform,ge.isIOSPlatform;var ve,ye=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},be=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(){this.apiHandlers=new Map}e.getInstance=function(){return e.PrivateApi||(e.PrivateApi=new e),e.PrivateApi},e.prototype.initializePrivateApi=function(){return ye(this,arguments,void 0,(function(e){var t,n=this;return void 0===e&&(e=0),be(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(t){return ye(n,void 0,void 0,(function(){var n,o,i;return be(this,(function(r){switch(r.label){case 0:return E("PrivateApi event: "+t),e>0?[4,new Promise((function(t){return setTimeout(t,e)}))]:[3,2];case 1:r.sent(),r.label=2;case 2:n=!1;try{o=JSON.parse(t)}catch(e){o=null}return(null==o?void 0:o.eventName)&&(i=this.apiHandlers.get(o.eventName))&&i instanceof Function&&(i(o),n=!0),n||E("Could not dispatch PrivateApi event"),[2]}}))}))}))];case 1:return o.sent(),[3,3];case 2:return t=o.sent(),E("Error initializing PrivateApi: "+t),[3,3];case 3:return[2]}}))}))},e.prototype.openMOSDialog=function(){return ye(this,void 0,void 0,(function(){var e;return be(this,(function(t){switch(t.label){case 0:return e={dispidMethod:Q.LaunchMos},[4,this.execute(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getFullDocumentHtml=function(){return ye(this,void 0,void 0,(function(){var e;return be(this,(function(t){return e={dispidMethod:Q.GetFullDocumentHtml},[2,this.execute(e)]}))}))},e.prototype.execute=function(e){return ye(this,void 0,void 0,(function(){return be(this,(function(t){return[2,OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))]}))}))},e.prototype.attachPrivateEventHandler=function(e,t){this.apiHandlers.has(e)&&E("Overwriting PrivateApi event handler for "+e),this.apiHandlers.set(e,t)}}();!function(e){e.LAUNCH_WITH_REVIEWERS="LAUNCH_WITH_REVIEWERS",e.LAUNCH_WITHOUT_REVIEWERS="LAUNCH_WITHOUT_REVIEWERS",e.LAUNCH_FROM_TOGGLE="LAUNCH_FROM_TOGGLE"}(ve||(ve={}));var me,Ce;!function(e){e.IsCustomGPTsEnabled="IsCustomGPTsEnabled",e.IsAgentDiscoverabilityZQMEnabled="IsAgentDiscoverabilityZQMEnabled",e.IsClickButtonStyleHamburgerEnabled="IsClickButtonStyleHamburgerEnabled",e.ShowAgentMenuNudgeAndTooltip="ShowAgentMenuNudgeAndTooltip",e.ShowAgentMenuExploreBadge="ShowAgentMenuExploreBadge",e.EnableUniqueDateCheckForStoreCardZQPrompt="EnableUniqueDateCheckForStoreCardZQPrompt",e.EnableInsightsCardAgents="EnableInsightsCardAgents",e.ShowAtMentionMenuZQPrompt="ShowAtMentionMenuZQPrompt"}(me||(me={})),function(e){e.EnableSystemMessageActions="EnableSystemMessageActions",e.IsInsertImageEnabledForDAs="IsInsertImageEnabledForDAs",e.DisableACHorizontalScroll="DisableACHorizontalScroll",e.DisableFooterActionsForAdaptiveCard="DisableFooterActionsForAdaptiveCard",e.EnableDynamicHostWidthForAC="EnableDynamicHostWidthForAC",e.EnableNewRegexForVCPromptExtraction="EnableNewRegexForVCPromptExtraction",e.ShowStoreLauncherZQPrompt="ShowStoreLauncherZQPrompt",e.ShowVisualCreatorZQPrompt="ShowVisualCreatorZQPrompt"}(Ce||(Ce={}));var Ee,Ie=n(260623);(0,Ie.n)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}});!function(e){e.AutoOpenTTVR="visuallyReady",e.AutoOpenTTFR="functionallyReady"}(Ee||(Ee={}));var Le,Se="",Ae="shimmer";!function(e){e.AtMention="AtMention",e.SwitcherMenu="SwitcherMenu",e.FooterButton="FooterButton"}(Le||(Le={}));var we="Copilot Extensions Dialog",Te=function(){return oe()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},Pe=n(784330),ke=n(61714),De=n(434011),Oe=n(30602),xe=n(197297),_e=function(e){E("setting ClpOfficeJSApiError to ".concat(e))},Me=!1;function Ne(e,t){switch(e){case q.ApplyLabelUnsupportedCrossTenantErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored.";case q.ApplyLabelDocumentReadOnlyErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that canâ€™t be applied when a file is read-only.";case q.ApplyLabelInsufficientPermissionErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file.";case q.ApplyLabelLabelDisabledErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account.";case q.ApplyLabelUnsupportedUdpErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions.";case q.ApplyLabelLabelingDisabledErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account.";case q.ApplyLabelUnsupportedContentTypeErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels.";case q.ApplyLabelUnsupportedDkeErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption.";case q.ApplyLabelLabelNotFoundErrorCode:case q.ErrorCode2147647531:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file.";case q.OsfControlContainerErrorCode:case q.OfficeSolutionFrameworkHostErrorCode:case q.DocCookieErrorCode:case q.HostIntegrationManagerErrorCode:case q.MsoOLDocumentErrorCode:case q.ClpSessionErrorCode:return Te();case q.OMWorkflowUserNotFoundErrorCode:return oe()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label.";case q.OMOfficePerpetualNotSupportedErrorCode:return oe()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels.";case q.LabelingDisabledProtectedViewErrorCode:return oe()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View.";case q.LabelingDisabledAppguardErrorCode:return oe()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard.";case q.LabelingDisabledPrivacySettingsErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label.";case q.LabelingDisabledUnsupportedLabelClientErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels.";case q.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account.";case q.OMOfficeClientNotLicensedForLabelingErrorCode:return t===U.CLP_Get?Se:oe()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account.";case q.PolicyManagerUnavailableErrorCode:return t===U.CLP_Get?Se:Te();case q.ApplyLabelNewLabelSensitivityOrderErrorCode:return Se;case q.ErrorCode2147500033:default:return t===U.CLP_Get?Se:Te()}}function Re(e,t,n,o,i){void 0===i&&(i=!0);var a,c={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:De.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:o?(a=o,a||(a=f.CopilotChat),JSON.stringify({featureName:a})):void 0},u=!0,d=je.getInstance();(null==d?void 0:d.getShouldStopLoadingUi)&&(u=d.getShouldStopLoadingUi());var h={chatCardType:Oe._.Default,chatMessageData:{defaultMessageProps:{user:xe.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:c,stopLoadingUi:u,startAugloopTimerForStreaming:!1,addCardToChatHistory:i};return function(e,t,n){var o,i;void 0===n&&(n=!0);var a={};if(t){r.sendChatEventTelemetry(k(((o={})[l.ChatEventType]=t.chatEventType,o[l.ChatEventParameters]=t.chatEventParam,o[l.ChatErrorType]=t.chatErrorType,o))),(i={})[s.ErrorType]=p.Client,i[s.ErrorParameter]=t.chatEventType,i[s.ErrorChatEventType]=t.chatEventType,i[s.ErrorChatEventParameter]=t.chatEventParam,a=i;var c=t.ashaErrorDetails;c&&D(c)}e&&(E("User Perceived Latency :  ".concat(I(w())," sec")),a[s.UserPerceivedLatency]=I(w()),a[s.IsQuerySuccess]=!1,r.sendLatencyTelemetry(k(a),n))}(t,n,!0),E("CLP error response message: ".concat(h)),h}function He(e,t,n,o){var i,a,s;if(null===(s=null==e?void 0:e.current)||void 0===s?void 0:s.getIsExecuting()){var c=Ne(t,n);if(c){Me&&_e(!0),E("clp error: ".concat(c)),function(e,t){var n,o={chatEventType:u.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:p.Client,ashaErrorDetails:{vetoName:O(y.UnclearIntent,g.UserInputIssue),errorString:b.SensitivityExecutionFailed,featureName:f.CopilotChat}};null===(n=null==e?void 0:e.current)||void 0===n||n.addResponseMessage(Re(t,!0,o))}(e,c);var d=!0,h=je.getInstance();(null==h?void 0:h.getShouldStopLoadingUi)&&(d=h.getShouldStopLoadingUi()),o&&d&&o(),r.sendChatEventTelemetry(k(((i={})[l.ChatEventType]=u.CLPErrorShown,i[l.ChatEventParameters]=n+"_"+t,i)))}else E("clp error string is empty"),r.sendChatEventTelemetry(k(((a={})[l.ChatEventType]=u.CLPErrorIgnored,a[l.ChatEventParameters]=n+"_"+t,a)));return c}return Se}var Fe=function(){return Fe=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Fe.apply(this,arguments)},Ue=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},qe=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Be=null,ze=(0,ke.A)(),je=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:Se,tenantId:Se},this.externalDocLabelInfo={labelId:Se,tenantId:Se},this.inDocLabelInfo.labelId=Se,this.inDocLabelInfo.tenantId=Se,this.externalDocLabelInfo.labelId=Se,this.externalDocLabelInfo.tenantId=Se}return e.getInstance=function(t,n,o,i,r){return ne(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),ne(t)||(e.clpSensitivityHandler.setBasicChatProps=t),ne(n)||(e.clpSensitivityHandler.setChatUiProps=n),ne(o)||(e.clpSensitivityHandler.copilotChatRef=o),ne(i)||(e.clpSensitivityHandler.removeCurrentContextId=i),ne(r)||(e.clpSensitivityHandler.getShouldStopLoadingUi=r),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return Ue(this,void 0,void 0,(function(){var e,t,n;return qe(this,(function(o){switch(o.label){case 0:if(null===(n=a.IsCopilotInBackstageMode)||void 0===n?void 0:n.call(a))return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=o.sent(),this.setInDocSensitivityLabelInfo(e),P("setInDocSensitiveLabelInfoUsingOfcJs"),[3,4];case 3:return t=o.sent(),T("error in getLabel Api: ".concat(t.message),t.code,t.stack),He(this.copilotChatRef,t.code,U.CLP_Get,this.removeCurrentContextId),E("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return Ue(this,void 0,void 0,(function(){var e,t,n;return qe(this,(function(o){switch(o.label){case 0:if(E("Getting label"),e={labelId:Se,tenantId:Se},null===(n=a.IsCopilotInBackstageMode)||void 0===n?void 0:n.call(a))return[2,e];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=o.sent(),P("getLabel"),[3,4];case 3:return t=o.sent(),T("error in getLabel Api : ".concat(t.message),t.code,t.stack),He(this.copilotChatRef,t.code,U.CLP_Get,this.removeCurrentContextId),E("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return E("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;E("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(n){var i,r;return Fe(Fe({},n),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(i=e.description)&&void 0!==i?i:"",badgeText:null!==(r=e.displayName)&&void 0!==r?r:"",iconType:e.encryptionType!==o.None?Pe.JF.Encryption:Pe.JF.NonEncryption}:void 0})})),this.setChatUiProps&&this.shouldShowInDocSensitivityLabel()&&this.setChatUiProps((function(e){return Fe(Fe({},e),{documentSensitivityProps:t.getSensitivity()})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return Ue(this,void 0,void 0,(function(){var t;return qe(this,(function(n){switch(n.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:Se}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):(E("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:n.sent(),this.labelChangedFromChatHistory=!1,n.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?(E("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return n.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){return Ue(this,arguments,void 0,(function(e,t){var n,o,r,s,c,l,u,d,f=this;return void 0===t&&(t=!1),qe(this,(function(p){switch(p.label){case 0:if(P("tryUpgradeLabel"),t&&!function(e){var t,n=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;return null!=(null===(t=e.labelId)||void 0===t?void 0:t.match(n))}(e))return E("Invalid label",e),T("Invalid label format id: ".concat(e.labelId),i[i.E_APPLYLABEL_FAIL],""),[2,{status:i[i.E_APPLYLABEL_FAIL],errorMessage:"Invalid label format"}];if(null===(u=a.IsCopilotInBackstageMode)||void 0===u?void 0:u.call(a))return E("Upgrading sensitivity label disabled in backstage mode"),[2,{status:i[i.E_APPLYLABEL_FAIL],errorMessage:"disabled in backstage mode"}];E("Upgrading sensitivity label: ".concat(JSON.stringify(e))),n=i[i.S_APPLYLABEL_OK],o=Se,p.label=1;case 1:return p.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,ze)];case 2:return p.sent(),[2,{status:i[i.S_APPLYLABEL_OK]}];case 3:return r=function(){return Ue(f,void 0,void 0,(function(){return qe(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,ze)]}catch(e){T("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code,e.stack),o=He(this.copilotChatRef,e.code,U.CLP_Upgrade,this.removeCurrentContextId),E("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),n=e.message}return[2]}))}))},s=new Promise((function(e){Be=e})),c=new Promise((function(e,t){setTimeout((function(){return t(new Error("CallbackTimeout"))}),3e4)})),[4,Promise.race([Promise.all([s,r()]),c])];case 4:p.sent(),p.label=5;case 5:return[3,7];case 6:return l=p.sent(),T("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(l.message),l.code,l.stack),He(this.copilotChatRef,l.code,U.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===l.message?E("Callback Timeout"):E("Exception while upgrading sensitivity label: ".concat(l.message,", error code: ").concat(l.code)),n=null!==(d=i[l.message])&&void 0!==d?d:l.message,[3,7];case 7:return Be=null,[2,{status:n,errorMessage:o}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){var t;if(null===(t=a.IsCopilotInBackstageMode)||void 0===t?void 0:t.call(a))E("setting label change EventListener disabled in backstage mode");else try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:Ge),P("Label Change Event Listener"),E("Sensitivity Label Change Event Listener Set")}catch(e){T("error in setting listener for CLP : ".concat(e.message),e.code,e.stack),He(this.copilotChatRef,e.code,U.CLP_Upgrade,this.removeCurrentContextId),E("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return Ue(this,void 0,void 0,(function(){var t,n,o;return qe(this,(function(i){switch(i.label){case 0:if(null===(o=a.IsCopilotInBackstageMode)||void 0===o?void 0:o.call(a))return E("update external doc sensitivity label disabled in backstage mode"),[2];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=i.sent(),E("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),P("External Doc HighestSensitivityLabel"),[3,4];case 3:return n=i.sent(),T("error in HighestSensitivityLabel Api : ".concat(n.message),n.code,n.stack),He(this.copilotChatRef,n.code,U.CLP_Get,this.removeCurrentContextId),E("Error while updating external doc sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return Ue(this,void 0,void 0,(function(){return qe(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return Ue(this,void 0,void 0,(function(){var t,n,o;return qe(this,(function(i){switch(i.label){case 0:if(t={labelId:Se,tenantId:Se},null===(o=a.IsCopilotInBackstageMode)||void 0===o?void 0:o.call(a))return E("getHighestDocumentSensitivityInfo disabled in backstage mode"),[2,t];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=i.sent(),E("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),P("HighestSensitivityLabel"),[3,4];case 3:return n=i.sent(),T("error in HighestSensitivityLabel Api : ".concat(n.message),n.code,n.stack),He(this.copilotChatRef,n.code,U.CLP_Get,this.removeCurrentContextId),E("Error while fetching highest sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return Ue(this,void 0,void 0,(function(){var t;return qe(this,(function(n){switch(n.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=n.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==o.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){E("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return P("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===Se)),this.externalDocLabelInfo.labelId!==Se&&a.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return P("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===Se)),this.inDocLabelInfo.labelId!==Se&&a.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==o.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==o.None},e}();function Ge(e,t,n,o){return Ue(this,void 0,void 0,(function(){return qe(this,(function(r){switch(r.label){case 0:return E("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(o)),P("Label change callback received, context:  ".concat(n)),Be&&n===ze&&(Be("ignore"),Be=null),o!==i.S_APPLYLABEL_OK?(T("error in upgrading label : ".concat(o),o.code,o.stack),[2]):a.IsClpEnabledInEnterpriseForSydney()&&(je.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,je.getInstance().setSensitivityLabelToHighestSensitivity([je.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return r.sent(),[2];case 2:return a.IsApplyLabelUsingTryUpgradeLabelEnabled(),je.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}var We=n(423212),Qe="HandoffMessageId",Je=function(){function e(){}return e.getSettingAsString=function(e){if((0,We.isTest)())return"TestSetting";var t=Office.context.hostSettings.get(e);return ne(t)?t:t.toString()},e.getSetting=function(e){return Office.context.hostSettings.get(e.toString())},e.removeSetting=function(e){"undefined"!=typeof Office&&Office.context&&Office.context.hostSettings&&Office.context.hostSettings.remove(e)},e.set=function(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setByKey=function(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setHostSettings=function(e){var t=this;Object.keys(e).forEach((function(n){var o,i=("string"==typeof(o=e[n])&&o.length>=2&&o.startsWith('"')&&o.endsWith('"')&&(o=o.slice(1,-1)),o);t.setByKey(n,i)}))},e.IsSettingTrue=function(e){var t=this.getSettingAsString(e);return!!t&&"true"===t.toLowerCase()},e}();var Ve=n(182755),Ke=n(46692),Ye=n(12163),Ze=function(){return Ze=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ze.apply(this,arguments)},$e=function(e,t,n){if(n||2===arguments.length)for(var o,i=0,r=t.length;i<r;i++)!o&&i in t||(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},Xe=function(){function e(){}return e.prototype.sendTelemetryEvent=function(e){"undefined"!=typeof Office&&Office.sendTelemetryEvent(e)},e}(),et=(function(){function e(){this.alwaysCriticalEvents=null,this.oTelLogger=new Ve.M,this.telemSink=new Xe,this.setupTelemetryLogger(this.oTelLogger)}e.prototype.getDefaultEventFlags=function(){return{dataCategories:Ke.o.DataCategories.ProductServicePerformance|Ke.o.DataCategories.ProductServiceUsage,diagnosticLevel:Ke.o.DiagnosticLevel.RequiredServiceData}},e.prototype.getTelemetrySink=function(){return this.telemSink},e.prototype.sendTelemetryEvent=function(e){this.isAlwaysCriticalEvent(e)&&(e.eventFlags.samplingPolicy=Ke.o.SamplingPolicy.CriticalUsage),this.oTelLogger.sendTelemetryEvent(e)},e.prototype.logEvent=function(e,t){this.logTelemetryEvent(e,t)},e.prototype.logUncaughtException=function(e){var t=[],n="";e instanceof Error&&(e.message&&(n=e.message),e.stack&&t.push({key:"Stack",value:e.stack})),this.logTelemetryErrorEvent({eventType:c.UncaughtException,errorMessage:n,logLevel:m.Critical},void 0,t)},e.prototype.logError=function(e,t,n){this.logTelemetryErrorEvent(e,t,n)},e.prototype.isAlwaysCriticalEvent=function(e){return!1},e.prototype.getTelemetryProperties=function(){return{ariaTenantToken:e.AriaTenantToken,nexusTenantToken:e.NexusTenantToken}},e.prototype.getDefaultEventDataFields=function(){return this.getDataFields(this.getDefaultTelemetryData())},e.prototype.getDefaultTelemetryData=function(){return[{key:"UserQueryGuid",value:e.userQueryGuid}]},e.prototype.logTelemetryEvent=function(e,t){var n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?Ze(Ze({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:$e($e([],this.getDefaultEventDataFields(),!0),this.getDataFields(e.eventData||[]),!0)};this.sendTelemetryEvent(n)},e.prototype.getActionAITelemetryErrorEvent=function(e,t,n){return n||(n=[]),n.find((function(e){return"Message"===e.key}))||n.push({key:"Message",value:e.errorMessage}),n.find((function(e){return"LogLevel"===e.key}))||n.push({key:"LogLevel",value:e.logLevel}),{eventName:"Office.Voice.ActionAI."+c.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?Ze(Ze({},this.getDefaultEventFlags()),t):this.getDefaultEventFlags(),dataFields:$e($e([],this.getDefaultEventDataFields(),!0),this.getDataFields(n),!0)}},e.prototype.logTelemetryErrorEvent=function(e,t,n){this.oTelLogger.sendError(this.getActionAITelemetryErrorEvent(e,t,n))},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?(0,Ye.ip)(e.key,e.value):"string"==typeof e.value?(0,Ye.m9)(e.key,e.value):"boolean"==typeof e.value?(0,Ye.LK)(e.key,e.value):(0,Ye.m9)(e.key,String(e.value))}))},e.prototype.setupTelemetryLogger=function(t){t.setTenantToken("Office.Voice.ActionAI",e.AriaTenantToken,e.NexusTenantToken),t.setTenantToken("Office.Voice.Copilot",e.AriaTenantToken,e.NexusTenantToken),t.addSink(this.telemSink)},e.prototype.getLogLevelForErrorCategory=function(e){return m.Error},e.AriaTenantToken="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",e.NexusTenantToken=1763,e.userQueryGuid="",e.userQueryOrder=0,e.conversationId=void 0}(),n(752256)),tt=n(635741),nt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),ot=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},it=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(e){function t(t){var n=e.call(this,t)||this;return n.handleRefreshButtonOnClick=function(){window.location.reload()},n.handleCopyErrorButtonOnClick=function(){return ot(n,void 0,void 0,(function(){var e,t,n,o,i,r,a,s;return it(this,(function(c){switch(c.label){case 0:e=null!==(r=null===(i=this.state.error)||void 0===i?void 0:i.message)&&void 0!==r?r:"No error message",t=null!==(s=null===(a=this.state.error)||void 0===a?void 0:a.stack)&&void 0!==s?s:"No error stack",n="Error Message: "+e+"\n Error Stack: "+t,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(n)];case 2:return c.sent(),[3,4];case 3:return o=c.sent(),E("ErrorBoundary: Error in handleCopyErrorButtonOnClick -> error",o),[3,4];case 4:return[2]}}))}))},n.state={hasError:!1,error:void 0},n}nt(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t.prototype.componentDidCatch=function(e){var t;E("ErrorBoundary caught an error ",e),null===(t=window.document.getElementById(Ae))||void 0===t||t.style.setProperty("display","none"),this.props.errorLogOverride?this.props.errorLogOverride(e):function(e){var t;r.sendChatEventTelemetry(k(((t={})[l.ChatEventType]=u.ErrorBoundaryCaughtError,t[l.ChatEventParameters]=e,t))),D({vetoName:O(y.UnclearIntent,g.UnclassifiedError),errorString:b.UnexpectedFailure,featureName:f.CopilotChat})}(e.name+": "+e.message)},t.prototype.render=function(){return this.state.hasError?he.createElement(tt.q,{theme:this.props.copilotChatTheme,dir:this.props.copilotChatTheme.dir},he.createElement(et.A,{handleRefreshButtonOnClick:this.handleRefreshButtonOnClick,handleErrorButtonOnClick:this.handleCopyErrorButtonOnClick,errorBoundaryImagePath:this.props.errorBoundaryImagePath})):this.props.children}}(he.Component);var rt=n(814168),at=n(130431),st=function(e){};(0,rt.mL)(at.N,{currentLocale:void 0,strings:{},errorHandler:st,loaders:[],stringMapInitialized:!1});var ct,lt=n(211475);!function(e){e[e.Idle=0]="Idle",e[e.ScopeStarted=1]="ScopeStarted",e[e.HasAction=2]="HasAction",e[e.ShowButton=3]="ShowButton"}(ct||(ct={}));(function(){function e(){this.addinUndoState=ct.Idle,this.isAddinFlowActive=!1}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getCurrentAddinState=function(){return this.addinUndoState},e.prototype.isAddinFlow=function(){return this.isAddinFlowActive},e.prototype.setIsAddinFlow=function(e,t){this.isAddinFlowActive=e,null==t||t()},e.prototype.transitionAddinState=function(e,t){this.addinUndoState!==e&&(this.addinUndoState=e,null==t||t())},e.prototype.checkAndSetIsUndoableActionPresent=function(){this.getCurrentAddinState()===ct.ScopeStarted&&this.transitionAddinState(ct.HasAction)},e})().getInstance(),n(883);var ut=n(63461),dt=n(330743),ft=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},pt=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(e,t){this.bizChatALSession=null,this.handoffAnnotationTokens=new Map,this.initStartTime=0,this.sessionCreationTime=0,this.annotationRegistrationStartTime=0,this.handleResponseItem=e,this.config=t}e.prototype.doInitializeBizChatALSession=function(){return ft(this,void 0,void 0,(function(){var e,t,n,o,i,r,a,s,c,l,u,d;return pt(this,(function(f){switch(f.label){case 0:this.initStartTime=Date.now(),f.label=1;case 1:return f.trys.push([1,8,,9]),this.config.utils.debugLog("Initializing BizChatAL AL session"),this.config.telemetryEventHandler.updateTelemetryChatEventData(((s={})[this.config.constants.ChatEventsKeys.ChatEventType]=this.config.constants.ChatEventType.BizChatALSessionInitializationStarted,s[this.config.constants.ChatEventsKeys.ChatEventParameters]="BizChatAL AL Session Initialization Started",s),this.config.telemetryLogger.getInstance()),e=Date.now(),this.config.sessionProvider?(this.config.utils.debugLog("Using external AL session for BizChatAL"),t=this,[4,this.config.sessionProvider.getALSession()]):[3,3];case 2:return t.bizChatALSession=f.sent(),[3,4];case 3:this.config.utils.debugLog("Creating dedicated AL session for BizChatAL"),n=this.config.hostAppSettings.getSettingAsString(this.config.augloopSharedSessionIDSettingName),this.bizChatALSession=(0,dt.wB)(this.config.utils.isNullOrUndefined(n)?"ALDummySession_BizChatAL":"".concat(n,"_BizChatAL")),f.label=4;case 4:return this.sessionCreationTime=Date.now()-e,this.config.telemetryEventHandler.updateTelemetryLatencyData(((c={})[this.config.constants.LatencyKeys.BizChatALSessionCreationTime]=this.sessionCreationTime/1e3,c),this.config.telemetryLogger.getInstance()),this.bizChatALSession?(this.annotationRegistrationStartTime=Date.now(),[4,this.registerHandoffAnnotations()]):[3,6];case 5:return f.sent(),o=Date.now()-this.initStartTime,i=Date.now()-this.annotationRegistrationStartTime,this.config.telemetryEventHandler.updateTelemetryLatencyData(((l={})[this.config.constants.LatencyKeys.BizChatALTotalInitializationTime]=o/1e3,l[this.config.constants.LatencyKeys.BizChatALAnnotationRegistrationTime]=i/1e3,l[this.config.constants.LatencyKeys.BizChatALHandoffAnnotationCount]=this.handoffAnnotationTokens.size,l),this.config.telemetryLogger.getInstance()),this.config.telemetryEventHandler.updateTelemetryChatEventData(((u={})[this.config.constants.ChatEventsKeys.ChatEventType]=this.config.constants.ChatEventType.BizChatALSessionInitializationCompleted,u[this.config.constants.ChatEventsKeys.ChatEventParameters]=JSON.stringify({totalTimeMs:o,sessionCreationTimeMs:this.sessionCreationTime,annotationRegistrationTimeMs:i,annotationsRegistered:this.handoffAnnotationTokens.size}),u),this.config.telemetryLogger.getInstance()),this.config.utils.debugLog("BizChatAL AL session initialized successfully. Total time: ".concat(o,"ms, Session creation: ").concat(this.sessionCreationTime,"ms, Annotation registration: ").concat(i,"ms")),[3,7];case 6:throw new Error("Failed to create BizChatAL AL session");case 7:return[3,9];case 8:throw r=f.sent(),a=Date.now()-this.initStartTime,this.config.utils.debugLog("Failed to initialize BizChatAL AL session: ".concat(r)),this.config.telemetryEventHandler.updateTelemetryChatEventData(((d={})[this.config.constants.ChatEventsKeys.ChatEventType]=this.config.constants.ChatEventType.BizChatALSessionInitializationFailed,d[this.config.constants.ChatEventsKeys.ChatEventParameters]=JSON.stringify({error:r instanceof Error?r.message:String(r),initTimeMs:a}),d),this.config.telemetryLogger.getInstance()),r;case 9:return[2]}}))}))},e.prototype.registerHandoffAnnotations=function(){return ft(this,void 0,void 0,(function(){var e,t,n,o,i=this;return pt(this,(function(r){switch(r.label){case 0:if(!this.bizChatALSession)throw new Error("BizChatAL AL session not initialized");this.config.utils.debugLog("Registering handoff annotations for BizChatAL"),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this.bizChatALSession.activateAnnotation(ut.uC.getTypeName(),{callback:function(e){return ft(i,void 0,void 0,(function(){var t,n,o;return pt(this,(function(i){if(this.config.utils.debugLog("Received HandoffMessage annotation"),e.items)for(t=0,n=e.items;t<n.length;t++)(o=n[t]).body&&ut.uC.typeGuard(o.body)&&(this.config.utils.debugLog("Processing HandoffMessage item"),this.handleResponseItem(o,""));return[2]}))}))}})];case 2:return e=r.sent(),this.handoffAnnotationTokens.set("HandoffMessage",e.token),[4,this.bizChatALSession.activateAnnotation(ut.dF.getTypeName(),{callback:function(e){return ft(i,void 0,void 0,(function(){return pt(this,(function(e){return this.config.utils.debugLog("Received HandoffDocUrlAnnotation annotation"),[2]}))}))}})];case 3:return t=r.sent(),this.handoffAnnotationTokens.set("HandoffDocUrlAnnotation",t.token),[4,this.bizChatALSession.activateAnnotation(ut.kp.getTypeName(),{callback:function(e){return ft(i,void 0,void 0,(function(){return pt(this,(function(e){return this.config.utils.debugLog("Received HandoffOutboundMessage annotation"),[2]}))}))}})];case 4:return n=r.sent(),this.handoffAnnotationTokens.set("HandoffOutboundMessage",n.token),this.config.utils.debugLog("Successfully registered ".concat(this.handoffAnnotationTokens.size," handoff annotations for BizChatAL")),[3,6];case 5:throw o=r.sent(),this.config.utils.debugLog("Failed to register handoff annotations: ".concat(o)),o;case 6:return[2]}}))}))},e.prototype.initializeBizChatALSession=function(){return ft(this,void 0,void 0,(function(){return pt(this,(function(e){return[2,this.doInitializeBizChatALSession()]}))}))},e.prototype.getBizChatALSession=function(){return this.bizChatALSession},e.prototype.isInitialized=function(){return null!==this.bizChatALSession},e.prototype.getPerformanceMetrics=function(){return{sessionCreationTime:this.sessionCreationTime,totalInitTime:this.initStartTime>0?Date.now()-this.initStartTime:0,annotationsCount:this.handoffAnnotationTokens.size}}}();new Set([lt.n3.TriggerConfirmation,lt.n3.TriggerPluginAuth,lt.n3.TriggerPlugin]);var ht,gt=n(385659),vt=n(28515),yt=n(758651),bt=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},mt=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};(function(){function e(e){var t=this;this.theme=void 0,this.platform=Office.context.platform,this.themeChangeObserver=void 0,this.registerThemeChangeEventCallback=function(){return bt(t,void 0,void 0,(function(){var e;return mt(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeEventCallback)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},this.themeChangeEventCallback=function(e){yt.log("OfficeTheme Changed"),t.theme=t.buildOfficeTheme(e),t.themeChangeObserver.update(t.theme)},this.themeChangeObserver=e,this.platform===M.win32?this.handleDefaultThemeChange():this.platform===M.mac&&this.handleMacThemeChange()}e.getInstance=function(t){return e.instance||(this.instance=new e(t)),e.instance},e.prototype.handleDefaultThemeChange=function(){this.theme=this.buildOfficeTheme(),this.themeChangeObserver.update(this.theme),this.registerThemeChangeEventCallback().catch((function(e){}))},e.prototype.handleMacThemeChange=function(){var e,t,n=this;null===(t=null===(e=Office.context)||void 0===e?void 0:e.themeManager)||void 0===t||t.getOfficeThemeAsync((function(e){"succeeded"===e.status&&(n.theme=n.buildOfficeTheme(e.value),n.themeChangeObserver.update(n.theme),n.registerThemeChangeEventCallback().catch((function(e){})))}))},e.prototype.buildOfficeTheme=function(e){return e?{controlForegroundColor:e.officeTheme.controlForegroundColor,controlBackgroundColor:e.officeTheme.controlBackgroundColor,bodyForegroundColor:e.officeTheme.bodyForegroundColor,bodyBackgroundColor:e.officeTheme.bodyBackgroundColor}:{controlForegroundColor:Office.context.officeTheme.controlForegroundColor,controlBackgroundColor:Office.context.officeTheme.controlBackgroundColor,bodyForegroundColor:Office.context.officeTheme.bodyForegroundColor,bodyBackgroundColor:Office.context.officeTheme.bodyBackgroundColor}}})(),(0,he.createContext)({officePlatform:M.web,officeTheme:void 0}),n(758651);!function(e){e.M365CopilotChat="M365CopilotChat",e.AppChat="AppChat",e.Researcher="Researcher",e.Analyst="Analyst",e.Disabled="Disabled"}(ht||(ht={}));var Ct,Et=n(784567);!function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(Ct||(Ct={}));var It,Lt;!function(e){e.CrossAppCanvasHandoff="CrossAppCanvasHandoff",e.CrossAppHandoff="CrossAppHandoff",e.InAppHandoff="InAppHandoff"}(It||(It={})),function(e){e.TellMe="TellMe",e.WordCopilotComposeSelection="WordCopilotComposeSelection",e.ContextMenuRewriteClickAction="ContextMenuRewriteClickAction",e.WordCopilotRewriteSelection="WordCopilotRewriteSelection",e.SkittleContextMenuUserClickAction="SkittleContextMenuUserClickAction",e.WordCopilotComprehensionPodcast="WordCopilotComprehensionPodcast",e.ResearcherAgent="ResearcherAgent",e.CopilotContextMenuClickAction="CopilotContextMenuClickAction"}(Lt||(Lt={}));var St=[Lt.WordCopilotComprehensionPodcast],At=new Map([[Lt.TellMe,ht.M365CopilotChat],[Lt.WordCopilotComposeSelection,ht.M365CopilotChat],[Lt.ContextMenuRewriteClickAction,ht.M365CopilotChat],[Lt.WordCopilotRewriteSelection,ht.M365CopilotChat],[Lt.SkittleContextMenuUserClickAction,ht.M365CopilotChat],[Lt.ResearcherAgent,ht.M365CopilotChat],[Lt.CopilotContextMenuClickAction,ht.M365CopilotChat],[Lt.WordCopilotComprehensionPodcast,ht.AppChat]]),wt=function(){return wt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},wt.apply(this,arguments)};function Tt(e,t){return void 0===t&&(t=!1),!!e&&(!(!t&&e.toLowerCase()===vt.Ww.NONE)&&Object.values(vt.Ww).some((function(t){return t===e.toLowerCase()})))}function Pt(e){var t;return wt(wt({scenarioName:vt.Cu.NONE},e),null!==(t=e.properties)&&void 0!==t?t:{})}function kt(e,t,n){var o,i,r,a,s;if(!e.isBizChatinSDXEnabled||e.fallbackHandoffsToAppChat||!t)return ht.AppChat;var c=null!==(a=null!==(i=null===(o=null==n?void 0:n.PrimaryUserAccountInfo)||void 0===o?void 0:o.AggregatedLicensedFeatures)&&void 0!==i?i:null===(r=null==n?void 0:n.PrimaryUserAccountInfo)||void 0===r?void 0:r.LicensedFeatures)&&void 0!==a?a:void 0;return!e.shouldCheckUserLicense||(!!(null==c?void 0:c.includes("Copilot"))||!!(null==c?void 0:c.includes("CopilotStarter")))?e.shouldDefaultToBizChat?St.includes(t.featureName)?ht.AppChat:ht.M365CopilotChat:null!==(s=At.get(t.featureName))&&void 0!==s?s:ht.AppChat:ht.AppChat}var Dt=n(215365),Ot=n(387452),xt=n(999937),_t=function(e,t,n,o){var i,r;return n?!!o||(e("Conversation ID handoff unsucessful - no submitOperation function defined"),null==t||t.sendChatEventTelemetry(k(((r={})[l.ChatEventType]=u.SubmitOperationUndefined,r))),!1):(e("Unable to update chat session ID, updateChatSessionId is undefined"),null==t||t.sendChatEventTelemetry(k(((i={})[l.ChatEventType]=u.CannotUpdateChatSessionId,i))),!1)},Mt=function(e,t){var n,o,i={pageSize:Rt,syncState:void 0},r={type:Dt.S5.GetMessagesOperation,chatSessionId:e,paging:i,setSessionAsCurrent:!0,gptId:(0,xt.Z)()};return new Ot.T({operation:r,documentURLOrLocalPath:null===(n=t.properties)||void 0===n?void 0:n.destinationDocUrl,timestamp:Date.now(),documentSensitivity:null===(o=t.properties)||void 0===o?void 0:o.sensitivityLabel,orchestratorGroundingMode:void 0,isFluxChatHistoryAnnotationActivated:!1,caller:Ht})},Nt=function(e,t){return{operation:new Et.g0({parentPath:["Signal",Ot.T.getTypeName()],items:[{id:A.generateId(),body:Mt(e,t)}]}),workflowAnnotationType:Ot.T.getTypeName()}},Rt=10,Ht="handoff",Ft=function(){return Ft=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ft.apply(this,arguments)},Ut=(function(){function e(e,t){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set,this.flights={};var n=this.getDocumentHandoffMessageId();n&&this.pendingHandoffMessageIds.add(n),this.flights=e.getFlights(),this.telemetryHandler=t}e.prototype.getDocumentHandoffMessageId=function(){var e=Je.getSettingAsString(Qe);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var n=(0,ke.A)(),o=this.getHandoffMessageIdSignal(n,t,e),i=new Et.g0({parentPath:["Signal",ut.uC.getTypeName()],items:[{id:A.generateId(),body:o}]});e===gt.Q.GET&&this.trackHandoffMessageIdSignal(n,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(o.H_.T_,{operation:i,workflowAnnotationType:ut.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(o)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.getBizChatProperties=function(e){return e},e.prototype.switchChatExperienceIfNeeded=function(e,t,n){this.flights.enableHandoffALBridge&&this.flights.enableBizchatHostContext&&function(e,t,n,o){var i,r=o.useHandoffMessagePropertiesValue?Pt(e):e,a=void 0;try{a=r.context?JSON.parse(r.context):void 0}catch(e){return void n("Handoff context could not be parsed - unable to switch chat experience")}t.setBizChatHostContext&&t.setBizChatHostContext({PrimaryUserAccountInfo:wt(wt({},null===(i=t.bizChatHostContext)||void 0===i?void 0:i.PrimaryUserAccountInfo),{CopilotExperience:kt(o,a,t.bizChatHostContext)})})}(e,{setBizChatHostContext:t,bizChatHostContext:n},this.HandoffOperations.logDebug,this.flights)},e.prototype.receiveHandoffAnnotation=function(e,t){this.HandoffOperations.onAnnotationReceived(ut.uC.getTypeName(),e,this.handoffMessageIdRequestSubmitTime,t)},e.prototype.handleBizChatHandoffIfEnabled=function(e,t,n){var o;if(this.flights.handoffToBizChatEnabled&&this.flights.enableHandoffALBridge&&n&&e){var i=void 0;if(this.flights.useHandoffMessagePropertiesValue)i=this.getBizChatProperties(Pt(e));else{var r=Ft({scenarioName:vt.Cu.NONE},e);if(e.properties)for(var a=0,s=Object.keys(e.properties);a<s.length;a++){var c=s[a];void 0===r[c]&&(r[c]=e.properties[c])}i=this.getBizChatProperties(r)}try{var l=JSON.parse(null!==(o=null==i?void 0:i.context)&&void 0!==o?o:"");if(function(e,t,n){return kt(e,t,n)===ht.M365CopilotChat}(this.flights,l,t))return n(i),!0}catch(e){return!0}}return!1},e.prototype.handleHandoffMessage=function(e,t,n,o,i,r,a){void 0===n&&(n=!1);try{if(!(null==e?void 0:e.body)||!ut.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var s=e.body;if(this.switchChatExperienceIfNeeded(s,i,r),this.receiveHandoffAnnotation(s,t),this.handleBizChatHandoffIfEnabled(s,r,a))return;var c=function(e,t){var n;return void 0===t&&(t=!1),e.scenarioName===vt.Cu.INAPP||(null===(n=e.properties)||void 0===n?void 0:n.scenarioName)===vt.Cu.INAPP?It.InAppHandoff:t?It.CrossAppCanvasHandoff:It.CrossAppHandoff}(s,n);switch(c){case It.InAppHandoff:return void this.processHandoffMessage(s);case It.CrossAppCanvasHandoff:return this.renderChatHistory(s,o),this.renderClosingBookending(s),void this.processHandoffMessage(s);case It.CrossAppHandoff:default:return void(this.isHandoffMessageIdSignalTracked(s.queryId)&&this.validateResponse(s)&&(this.renderChatHistory(s,o),this.renderClosingBookending(s),this.processHandoffMessage(s),this.cleanupHandoff(s)))}}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.validateResponse=function(e){return!e.error||(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+e.error),e.error.includes("Unable to download content. The specified blob does not exist")||e.error.includes("Unable to download content. Request failed with status code 500")||this.HandoffOperations.onError(Ct.HandoffMessageResponse,"I ran into a problem while completing your request. Please try again."),!1)},e.prototype.renderClosingBookending=function(e){var t,n,o;if((null===(t=e.properties)||void 0===t?void 0:t.sourceApp)&&(null===(n=e.properties)||void 0===n?void 0:n.destinationApp)&&(null===(o=e.properties)||void 0===o?void 0:o.scenarioName)&&(!this.flights.appValueChecksForBookendingEnabled||Tt(e.properties.sourceApp)&&Tt(e.properties.destinationApp)))switch(e.properties.scenarioName){case vt.Cu.OPEN:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Opened");break;case vt.Cu.NEW:case vt.Cu.GENERATE:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Created")}},e.prototype.cleanupHandoff=function(e){var t=this.getHandoffMessageIdFromSignal(e.queryId);this.sendHandoffMessageId(gt.Q.PROCESSED,t),this.completeTrackedHandoffMessageIdSignal(e.queryId)},e.prototype.renderChatHistory=function(e,t){var n,o,i;if(this.flights.renderChatHistoryInHandoffDestination){var r=null===(o=e.properties)||void 0===o?void 0:o.conversationId;r?function(e,t,n,o,i){var r,a,s,c,d,f;_t(n,o,null===(s=null==i?void 0:i.current)||void 0===s?void 0:s.updateChatSessionId,null===(c=null==i?void 0:i.current)||void 0===c?void 0:c.submitOperation)&&(n("Updating chat session ID with conversationId from source"),null==o||o.sendChatEventTelemetry(k(((r={})[l.ChatEventType]=u.UpdateChatSessionId,r))),null===(d=null==i?void 0:i.current)||void 0===d||d.updateChatSessionId(e),n("Conversation ID handoff successful - submitting chat history signal"),null==o||o.sendChatEventTelemetry(k(((a={})[l.ChatEventType]=u.ChatHistorySignalSubmitted,a))),null===(f=null==i?void 0:i.current)||void 0===f||f.submitOperation(Nt(e,t)))}(r,e,this.HandoffOperations.logDebug,this.telemetryHandler,t):(this.HandoffOperations.logDebug("Cannot render chat history - conversation ID is undefined"),null===(i=this.telemetryHandler)||void 0===i||i.sendChatEventTelemetry(k(((n={})[l.ChatEventType]=u.ConversationIdUndefined,n))))}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)}}(),function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))}),qt=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};(function(){function e(e){this.HandoffOperations=e,this.sentQueryIds=new Set}e.prototype.sendHandoffInternalMessage=function(e){try{var t=this.getHandoffInternalMessageSignal(e);this.sentQueryIds.add(t.queryId);var n=new Et.Xr({parentPath:["session","doc"],items:[{id:A.generateId(),body:t}]});this.handoffInternalMessageSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(t.H_.T_,{operation:n,workflowAnnotationType:ut.kp.getTypeName()})}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffInternalMessage signal. "+e.message),e}},e.prototype.handleHandoffOutboundMessage=function(e,t){return Ut(this,void 0,void 0,(function(){var n,o,i,r;return qt(this,(function(a){switch(a.label){case 0:if(a.trys.push([0,6,,7]),!e.body||!ut.kp.typeGuard(e.body))throw new Error("Service response not of type HandoffOutboundMessage");return(n=e.body).queryId&&this.sentQueryIds.has(n.queryId)?(this.sentQueryIds.delete(n.queryId),this.HandoffOperations.onAnnotationReceived(ut.kp.getTypeName(),n,this.handoffInternalMessageSubmitTime,t),n.error?(this.HandoffOperations.onError(Ct.OutboundMessageResponse,n.error),[3,5]):[3,1]):[2];case 1:return n.message?[3,2]:(this.HandoffOperations.onError(Ct.NoResponse),[3,5]);case 2:return n.generatedLinks&&n.generatedLinks.length>0&&n.id?[4,this.renderGeneratedHandoffLinks(n)]:[3,4];case 3:if(a.sent(),n.destinationApp&&n.scenarioName)switch(n.scenarioName){case vt.Cu.OPEN:this.HandoffOperations.renderBookending(null!==(i=n.sourceApp)&&void 0!==i?i:vt.Ww.NONE,n.destinationApp,"Opening","Opened");break;case vt.Cu.NEW:case vt.Cu.GENERATE:this.HandoffOperations.renderBookending(null!==(r=n.sourceApp)&&void 0!==r?r:vt.Ww.NONE,n.destinationApp,"Opening","Created")}return[3,5];case 4:this.HandoffOperations.onError(Ct.NoGeneratedLinks),a.label=5;case 5:return[3,7];case 6:throw o=a.sent(),this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffOutboundMessage. "+o.message),o;case 7:return[2]}}))}))}})(),oe()&&OfficeaicopilotStrings.PromptGuideMenuItemSpeakWithCopilot,oe()&&OfficeaicopilotStrings.SpeakWithCopilotText;var Bt,zt=n(529404),jt={root:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",gap:zt.L.spacingVerticalS},spinnerContainer:{justifyContent:"center",width:"100%"}},Gt=((0,Ie.n)(jt),{root:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",gap:zt.L.spacingVerticalS},spinnerContainer:{justifyContent:"center",width:"100%"}}),Wt=((0,Ie.n)(Gt),{entityPickerChildGap:{rowGap:"12px"},elementGap:{rowGap:"9px"},entityCardContainer:{paddingBottom:"10px",paddingRight:"6px",borderBottom:"1px solid ".concat(zt.L.colorNeutralStroke3),":last-child":{borderBottom:"none"}},entityCard:{columnGap:"12px",alignItems:"flex-start"},entityLink:{width:"fit-content",":hover":{textDecoration:"none !important"}},entityIconContainer:{minHeight:"32px",minWidth:"32px",borderRadius:"8px",backgroundColor:zt.L.colorNeutralStrokeAlpha,display:"flex",justifyContent:"center",alignItems:"center",marginTop:"2px"},entityIconImg:{width:"20px",height:"20px"},entityTextContainer:{display:"flex",flexDirection:"column",flexGrow:1},entityText:{color:zt.L.colorNeutralForeground1,":hover":{color:zt.L.colorBrandForegroundLink},display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitBoxOrient:"vertical",WebkitLineClamp:"1",wordBreak:"break-word"},entitySubText:{width:"fit-content",color:zt.L.colorNeutralForeground2,display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitBoxOrient:"vertical",WebkitLineClamp:"1",wordBreak:"break-word"},entitySparkleIconContainer:{padding:0,minHeight:"32px",minWidth:"32px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",borderRadius:"4px",border:"1px solid transparent",backgroundColor:"transparent",color:zt.L.colorNeutralForeground1,":hover":{backgroundColor:zt.L.colorNeutralBackground1Hover,border:"1px solid ".concat(zt.L.colorNeutralStroke1Hover),borderRadius:"6px",color:zt.L.colorNeutralForeground1}},entitySparkleIconContainerSelected:{backgroundColor:zt.L.colorNeutralBackground1Hover},suggestedPromptsPopover:{borderRadius:"8px",padding:"4px",backgroundColor:zt.L.colorNeutralBackground1,boxShadow:zt.L.shadow16,width:"175px"},suggestedPromptsContainer:{borderRadius:"4px",padding:"8px",rowGap:"7px"},suggestedPromptsTitle:{overflow:"hidden",color:zt.L.colorNeutralForeground2,textOverflow:"ellipsis"},suggestedPromptMenuList:{rowGap:"7px"},suggestedPromptMenuItem:{margin:"0px",borderRadius:"8px",border:"1px solid ".concat(zt.L.colorNeutralStroke2),display:"flex",height:"32px",padding:"0px 12px",alignItems:"center",width:"fit-content",cursor:"pointer",":hover":{border:"1px solid ".concat(zt.L.colorNeutralStroke2),backgroundColor:"transparent"}},suggestedPrompt:{color:zt.L.colorNeutralForeground2}});(0,Ie.n)(Wt);!function(e){e.FILE_LINK_CLICKED="file_link_clicked",e.SUGGESTED_PROMPTS_CLICKED="suggested_prompts_clicked"}(Bt||(Bt={}));n(758651),new Map([["docx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg"],["pptx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg"],["xlsx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg"],["pdf","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pdf.svg"],["txt","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg"],["html","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/html.svg"]]);var Qt=n(193536);Object.values(Qt.T).reduce((function(e,t){return e[t.toLowerCase()]=t,e}),{});var Jt=n(354247),Vt=n(122843),Kt=function(){return Kt=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Kt.apply(this,arguments)};function Yt(e){return{user:"human",message:e,disableLinksProcessing:!1,shouldApplyInputLinkTheme:!0}}he.memo((function(e){var t=e.markdownText,n=e.styles,o=void 0===n?{}:n,i=function(e,t){if(t)for(var n in e)e[n]=(0,te.z)(e[n],t[n]);return e}((0,Jt.bM)(),o);return he.createElement(Vt.A,{styles:i,body:Kt({},Yt(t))})}));var Zt,$t=n(798050);!function(e){e.AnnotationReceived="annotationReceived",e.ContentUpdated="contentUpdated",e.RequestTimedOut="requestTimedOut"}(Zt||(Zt={}));$t.x.LOADING;var Xt=n(641898),en=n(103218),tn="TaskViewMode",nn=80,on="c0ab8ce9-e9a0-42e7-b064-33d422df41f1",rn=function(){return window.location.href.replace("taskpane.html","msgExtDialog.html")},an=function(e){var t;if("number"==typeof e)return e;if("string"==typeof e){var n=parseInt(e,10);if(!isNaN(n))return n;return null!==(t={large:-3,medium:-2,small:-1}[e.toLowerCase()])&&void 0!==t?t:-2}return-2},sn=function(e,t){return Math.floor(e/t*100)},cn=function(e){var t,n;return null!==(n=((t={})[-1]=35,t[-2]=50,t[-3]=70,t)[e])&&void 0!==n?n:50},ln=function(e){var t,n;return null!==(n=((t={})[-1]=35,t[-2]=50,t[-3]=70,t)[e])&&void 0!==n?n:50},un=n(806141),dn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},fn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},pn=(function(){function e(){var t=this;this.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},this.dialogProps=void 0,this.startTime=0,this.msalAccountInfo=null,this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},E("ExtensibilityDialogLauncher : Extensibility Dialog closed")},this.logDialogTelemetry=function(e,n){var o=Date.now();J(o-t.startTime,e,null!=n?n:""),e||V(null!=n?n:"")},this.onMessageCallback=function(n){return dn(t,void 0,void 0,(function(){var t,o,i,r,a,s,c;return fn(this,(function(l){return this.openedDialog.dialog?((t=JSON.parse(n)).type===Xt.o.Ack?(o={dialogContent:null===(i=this.dialogProps)||void 0===i?void 0:i.dialogContent,appDefinition:null===(r=this.dialogProps)||void 0===r?void 0:r.appDefinition,clientInfo:null===(a=this.dialogProps)||void 0===a?void 0:a.clientInfo,cardInfo:null===(s=this.dialogProps)||void 0===s?void 0:s.card,hostConfigFlags:null===(c=this.dialogProps)||void 0===c?void 0:c.hostConfigFlags,copilotChatThemev2:e.theme,source:"BizChat",msalAccountInfo:this.msalAccountInfo},this.openedDialog.dialog.messageChild(JSON.stringify(o),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0)):t.type===Xt.o.CloseEvent&&this.closeActiveDialog(),[2]):(this.logDialogTelemetry(!1,"ExtensibilityDialogLauncher.onMessageCallback : No active dialog found"),[2])}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return!!t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n,o;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(null===(o=null===(n=t.dialogProps)||void 0===n?void 0:n.action)||void 0===o?void 0:o.title)&&t.openedDialog.triggeringActionTitle&&t.openedDialog.triggeringActionTitle===t.dialogProps.action.title)},this.onDialogError=function(e){var n="Error opening dialog";if(e)try{n=JSON.stringify(e)}catch(e){E("ExtensibilityDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"ExtensibilityDialogLauncher : ".concat(n))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return dn(t,void 0,void 0,(function(){var t,o,i,r,a,s=this;return fn(this,(function(c){switch(c.label){case 0:if(t=null!==(a=null===(r=null===(i=this.dialogProps)||void 0===i?void 0:i.card)||void 0===r?void 0:r.id)&&void 0!==a?a:"",this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return o=rn(),[4,Office.context.ui.displayDialogAsync(o,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return dn(s,void 0,void 0,(function(){var n,o,i,r,a,s=this;return fn(this,(function(c){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(i=null===(o=null===(n=this.dialogProps)||void 0===n?void 0:n.action)||void 0===o?void 0:o.title)&&void 0!==i?i:""},null===(r=this.openedDialog.dialog)||void 0===r||r.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return dn(s,void 0,void 0,(function(){return fn(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),null===(a=this.openedDialog.dialog)||void 0===a||a.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return dn(s,void 0,void 0,(function(){return fn(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return c.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return dn(t,void 0,void 0,(function(){var t,o,i,r,a=this;return fn(this,(function(s){return t=rn(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(r=null===(i=null===(o=this.dialogProps)||void 0===o?void 0:o.dialogContent)||void 0===i?void 0:i.title)&&void 0!==r?r:we,hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){a.openedDialog.dialog=e})).catch((function(e){a.onDialogError(e),E("ExtensibilityDialogLauncher : Error displaying  Extensibility Dialog",e)})),[2]}))}))},this.launchExtensibilityDialog=function(e){return dn(t,void 0,void 0,(function(){var t,n,o,i,r,a,s,c,l,u,d,f;return fn(this,(function(p){switch(p.label){case 0:return(null==e?void 0:e.clientInfo)?(this.startTime=Date.now(),t=!this.msalAccountInfo||(null===(c=null===(s=this.dialogProps)||void 0===s?void 0:s.clientInfo)||void 0===c?void 0:c.userPrincipalName)!==e.clientInfo.userPrincipalName,this.dialogProps=e,t?(n=new ee({userPrincipalName:null===(l=null==e?void 0:e.clientInfo)||void 0===l?void 0:l.userPrincipalName,redirectUri:new URL(null!==(d=null===(u=null==e?void 0:e.clientInfo)||void 0===u?void 0:u.redirectUri)&&void 0!==d?d:"",window.location.origin).toString(),clientId:on}),o=this,[4,n.getAccountInfoFromCache()]):[3,2]):(E("ExtensibilityDialogLauncher : Invalid dialog properties provided"),[2]);case 1:o.msalAccountInfo=p.sent(),p.label=2;case 2:return i=function(e){var t,n;if(e.viewMode!==un.hs.TaskModule)return{dialogHeight:nn,dialogWidth:nn};var o=an(null===(t=e.dialogContent)||void 0===t?void 0:t.height),i=an(null===(n=e.dialogContent)||void 0===n?void 0:n.width),r=!0,a=!0,s=55,c=50;o<=0&&(a=!1,s=ln(o)),i<=0&&(r=!1,c=cn(i));var l=screen.width,u=screen.height;return a&&(s=sn(o,u)),r&&(c=sn(i,l)),{dialogHeight:s,dialogWidth:c}}(e),r=i.dialogHeight,a=i.dialogWidth,(null===(f=e.clientInfo)||void 0===f?void 0:f.clientType)===en.WK.web?this.openDialogForWebPlatformAsNewWindow(r,a):this.openDialogForNativePlatform(r,a),[2]}}))}))}}e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.setTheme=function(t){e.theme=t}}(),n(794329)),hn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},gn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},vn=function(){function e(e,t){this.clientInfo=e,this.msalAccountInfo=t,this.findMatchingAccount=function(e,t){return e.find((function(e){return e.username.toLowerCase()===t.toLowerCase()}))}}return e.prototype.getAccount=function(e){return hn(this,void 0,void 0,(function(){var t,n;return gn(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,1,,3]),!(t=this.getAccountSilent(e)))throw E("AccountProvider : No account found in cache, trying interactive login"),new Error("No account found in cache");return[3,3];case 1:return n=o.sent(),E("AccountProvider : Silent account retrieval failed: ".concat(n)),[4,this.getAccountInteractive(e)];case 2:return t=o.sent(),[3,3];case 3:if(!t)throw E("AccountProvider : No account found after both silent and interactive attempts."),new Error("AccountProvider : No account found");return[2,t]}}))}))},e.prototype.getAccountSilent=function(e){var t;if(this.msalAccountInfo)return E("AccountProvider: Using cached MSAL account info"),this.msalAccountInfo;var n=null===(t=this.clientInfo)||void 0===t?void 0:t.userPrincipalName;if(!n)throw E("AccountProvider: No userPrincipalName provided in client info"),new Error("No userPrincipalName provided in client info");var o=e.getAllAccounts();if(0===o.length)throw new Error("No accounts found in MSAL service");o.length>1&&E("AccountProvider: Multiple accounts found (".concat(o.length,"). Using account with UPN: ").concat(n));var i=this.findMatchingAccount(o,n);return i||(E("AccountProvider: No exact match found for UPN: ".concat(n,". Using first available account")),o[0])},e.prototype.getAccountInteractive=function(t){return hn(this,void 0,void 0,(function(){var n;return gn(this,(function(o){return e.signInRequestPromise?(E("AccountProvider: Sign-in request already in progress, waiting for it to complete"),[2,this.resolveSignInRequest()]):(n={loginHint:this.clientInfo.userPrincipalName},E("AccountProvider: Initiating interactive login popup"),e.signInRequestPromise=t.loginPopup(n),[2,this.resolveSignInRequest()])}))}))},e.prototype.resolveSignInRequest=function(){return hn(this,void 0,void 0,(function(){var t,n,o;return gn(this,(function(i){switch(i.label){case 0:if(!e.signInRequestPromise)return E("AccountProvider: No sign-in request promise found"),[2,void 0];i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,e.signInRequestPromise];case 2:return t=i.sent(),(n=null==t?void 0:t.account)?(E("AccountProvider: Interactive login successful for user: ".concat(n.username)),this.msalAccountInfo=n):E("AccountProvider: Interactive login completed but no account returned"),[2,n];case 3:throw o=i.sent(),E("AccountProvider: Interactive login failed: ",o),new Error("Interactive authentication failed: ".concat(o instanceof Error?o.message:"Unknown error"));case 4:return e.signInRequestPromise=void 0,[7];case 5:return[2]}}))}))},e}(),yn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},bn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},mn=function(){function e(e,t,n,o){this.msalFor1PResources=e,this.msalFor3PResources=t,this.acquire3PTokenFallback=n,this.accountProvider=o,this.queue=[],this.interactionInProgress=!1}return e.prototype.enqueue=function(e,t,n){var o=this;return new Promise((function(i,r){o.queue.push({request:e,is1PResource:t,fallbackTo3PResource:n,resolve:i,reject:r}),o.processQueue()}))},e.prototype.createPopupRequest=function(e,t){return yn(this,void 0,void 0,(function(){var n;return bn(this,(function(o){switch(o.label){case 0:return[4,this.accountProvider.getAccount(t)];case 1:if(!(n=o.sent()))throw new Error("InteractiveTokenQueue : No account found for popup request");return[2,{scopes:["".concat(e.resource,"/.default")],account:n}]}}))}))},e.prototype.processQueue=function(){var e=this;if(!this.msalFor1PResources||!this.msalFor3PResources)throw new Error("InteractiveTokenQueue : MSAL instances not initialized.");if(!this.interactionInProgress&&0!==this.queue.length){this.interactionInProgress=!0;yn(e,void 0,void 0,(function(){var e,t,n,o,i,r,a,s,c,l,u,d,f;return bn(this,(function(p){switch(p.label){case 0:if(!(this.queue.length>0))return[3,12];e=this.queue.shift(),t=e.request,n=e.is1PResource,o=e.fallbackTo3PResource,i=e.resolve,r=e.reject,a=n?this.msalFor1PResources:this.msalFor3PResources,p.label=1;case 1:return p.trys.push([1,4,,11]),[4,this.createPopupRequest(t,a)];case 2:return s=p.sent(),[4,a.acquireTokenPopup(s)];case 3:return c=p.sent(),i({authToken:c.accessToken}),[3,11];case 4:if(l=p.sent(),!o||!n)return[3,9];p.label=5;case 5:return p.trys.push([5,7,,8]),[4,this.acquire3PTokenFallback(t)];case 6:return u=p.sent(),i({authToken:null!==(f=u.authToken)&&void 0!==f?f:""}),[3,8];case 7:return d=p.sent(),r(d),[3,8];case 8:return[3,10];case 9:r(l),p.label=10;case 10:return[3,11];case 11:return[3,0];case 12:return this.interactionInProgress=!1,[2]}}))}))}},e}(),Cn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},En=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},In=function(){function e(e){this.clientInfo=e,this.initialized=!1}return e.prototype.initialize=function(){return Cn(this,void 0,void 0,(function(){return En(this,(function(e){switch(e.label){case 0:return this.initialized?[2]:[4,this.loadMsalBrowser()];case 1:return e.sent(),this.createMsalInstances(),this.initialized=!0,[2]}}))}))},e.prototype.getMsalModule=function(){if(!this.msalModule)throw new Error("MSAL module not loaded");return this.msalModule},e.prototype.getMsalFor1PResources=function(){if(!this.msalFor1PResources)throw new Error("MSAL 1P instance not initialized");return this.msalFor1PResources},e.prototype.getMsalFor3PResources=function(){if(!this.msalFor3PResources)throw new Error("MSAL 3P instance not initialized");return this.msalFor3PResources},e.prototype.initializeMsalInstances=function(){return Cn(this,void 0,void 0,(function(){var e,t;return En(this,(function(n){switch(n.label){case 0:return e=this.getMsalFor1PResources(),t=this.getMsalFor3PResources(),[4,e.initialize()];case 1:return n.sent(),[4,t.initialize()];case 2:return n.sent(),[2]}}))}))},e.prototype.loadMsalBrowser=function(){return Cn(this,void 0,void 0,(function(){var e,t,o;return En(this,(function(i){switch(i.label){case 0:e=1,i.label=1;case 1:if(!(e<=3))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),t=this,[4,Promise.all([n.e("vendors~shared"),n.e("vendors~auth-msal-browser")]).then(n.bind(n,599807))];case 3:return t.msalModule=i.sent(),[2];case 4:if(o=i.sent(),E("Attempt ".concat(e," to load @azure/msal-browser failed:"),o),3===e)throw o;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.createMsalInstances=function(){if(!this.msalModule)throw new Error("MSAL module not loaded");this.msalFor1PResources=this.createPublicClientApplication(this.msalModule.PublicClientApplication,on),this.msalFor3PResources=this.createPublicClientApplication(this.msalModule.PublicClientApplication,"3068386c-7a16-4f6a-a664-043b6b232816")},e.prototype.createPublicClientApplication=function(e,t){var n,o=null!==(n=this.clientInfo.redirectUri)&&void 0!==n?n:"";return new e({auth:{clientId:t,authority:K,redirectUri:new URL(o,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})},e}(),Ln=function(){function e(){this.cache=new Map}return e.prototype.get=function(e){var t=this.createKey(e);return this.cache.get(t)},e.prototype.set=function(e,t){var n=this.createKey(e);this.cache.set(n,t)},e.prototype.delete=function(e){var t=this.createKey(e);return this.cache.delete(t)},e.prototype.has=function(e){var t=this.createKey(e);return this.cache.has(t)},e.prototype.createKey=function(e){return"".concat(e.resource,"-").concat(e.claims,"-").concat(e.isSilent)},e}(),Sn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},An=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},wn=function(){function e(e,t,n,o){this.msalInstance=e,this.accountProvider=t,this.interactiveTokenQueue=n,this.msalModule=o}return e.prototype.createTokenRequest=function(e,t){return{scopes:["".concat(e,"/.default")],account:t}},e.prototype.acquireToken=function(e){return Sn(this,void 0,void 0,(function(){var t,n,o,i,r;return An(this,(function(a){switch(a.label){case 0:if(t=this.getResourceType(),!this.msalInstance)throw E("DialogTokenService : Failed to acquire ".concat(t," MSAL instance.")),new Error("DialogTokenService : Failed to acquire ".concat(t," MSAL instance"));a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.accountProvider.getAccount(this.msalInstance)];case 2:if(!(n=a.sent()))throw E("DialogTokenService : No account found for ".concat(t," resource.")),new Error("DialogTokenService : No account found for ".concat(t," resource"));return o=this.createTokenRequest(e.resource,n),[4,this.msalInstance.acquireTokenSilent(o)];case 3:return[2,{authToken:a.sent().accessToken}];case 4:if(i=a.sent(),this.msalModule&&i instanceof this.msalModule.InteractionRequiredAuthError){if(!this.interactiveTokenQueue)throw new Error("DialogTokenService : Interactive token queue not initialized");return r="1P"===t,[2,this.interactiveTokenQueue.enqueue(e,r,this.shouldFallbackTo3PResource())]}throw E("DialogTokenService : Error acquiring ".concat(t," token: ").concat(i)),new Error("DialogTokenService : Error acquiring ".concat(t," token"));case 5:return[2]}}))}))},e}(),Tn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Pn=function(e){function t(t,n,o,i,r){var a=e.call(this,t,n,o,i)||this;return a.fallbackTo3PResource=r,a}return Tn(t,e),t.prototype.getResourceType=function(){return"1P"},t.prototype.shouldFallbackTo3PResource=function(){return this.fallbackTo3PResource},t}(wn),kn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Dn=function(e){function t(t,n,o,i){return e.call(this,t,n,o,i)||this}return kn(t,e),t.prototype.getResourceType=function(){return"3P"},t.prototype.shouldFallbackTo3PResource=function(){return!1},t}(wn),On=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},xn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_n=function(){function e(e,t,n,o,i){this.msalFor1PResources=e,this.msalFor3PResources=t,this.accountProvider=n,this.interactiveTokenQueue=o,this.msalModule=i}return e.prototype.create1PTokenAcquisition=function(e){return new Pn(this.msalFor1PResources,this.accountProvider,this.interactiveTokenQueue,this.msalModule,e)},e.prototype.create3PTokenAcquisition=function(){return new Dn(this.msalFor3PResources,this.accountProvider,this.interactiveTokenQueue,this.msalModule)},e.prototype.acquire1PToken=function(e,t){return On(this,void 0,void 0,(function(){return xn(this,(function(n){return[2,this.create1PTokenAcquisition(t).acquireToken(e)]}))}))},e.prototype.acquire3PToken=function(e){return On(this,void 0,void 0,(function(){return xn(this,(function(t){return[2,this.create3PTokenAcquisition().acquireToken(e)]}))}))},e}(),Mn=n(419366),Nn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Rn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(e,t){this.initialized=!1,this.msalManager=new In(e),this.tokenRequestCache=new Ln,this.accountProvider=new vn(e,t)}e.prototype.ensureInitialized=function(){return Nn(this,void 0,void 0,(function(){return Rn(this,(function(e){switch(e.label){case 0:return this.initialized?[2]:[4,this.msalManager.initialize()];case 1:return e.sent(),[4,this.msalManager.initializeMsalInstances()];case 2:return e.sent(),this.interactiveTokenQueue=new mn(this.msalManager.getMsalFor1PResources(),this.msalManager.getMsalFor3PResources(),this.acquire3PToken.bind(this),this.accountProvider),this.tokenAcquisitionFactory=new _n(this.msalManager.getMsalFor1PResources(),this.msalManager.getMsalFor3PResources(),this.accountProvider,this.interactiveTokenQueue,this.msalManager.getMsalModule()),this.initialized=!0,[2]}}))}))},e.prototype.acquire1PToken=function(e,t){return Nn(this,void 0,void 0,(function(){return Rn(this,(function(n){if(!this.tokenAcquisitionFactory)throw new Error("Token acquisition factory not initialized");return[2,this.tokenAcquisitionFactory.acquire1PToken(e,t)]}))}))},e.prototype.acquire3PToken=function(e){return Nn(this,void 0,void 0,(function(){return Rn(this,(function(t){if(!this.tokenAcquisitionFactory)throw new Error("Token acquisition factory not initialized");return[2,this.tokenAcquisitionFactory.acquire3PToken(e)]}))}))},e.prototype.getTokenInternal=function(e){var t=(0,Mn.p)(e),n=t.is1PResource,o=t.fallbackTo3PResource;return n?this.acquire1PToken(e,o):this.acquire3PToken(e)},e.prototype.getToken=function(e){return Nn(this,void 0,void 0,(function(){var t,n,o;return Rn(this,(function(i){switch(i.label){case 0:return[4,this.ensureInitialized()];case 1:i.sent(),(t=this.tokenRequestCache.get(e))||(t=this.getTokenInternal(e),this.tokenRequestCache.set(e,t)),i.label=2;case 2:return i.trys.push([2,4,5,6]),[4,t];case 3:return[2,i.sent()];case 4:throw n=i.sent(),(o=this.msalManager.getMsalModule())&&n instanceof o.AuthError&&E("DialogTokenService : AuthError encountered: ".concat(n.message)),n;case 5:return this.tokenRequestCache.delete(e),[7];case 6:return[2]}}))}))}}();try{var Hn=n(473023);Hn.ExternalAuthService,Hn.ChannelService,Hn.MosAppService}catch(e){try{var Fn=n(625771);Fn.ExternalAuthService,Fn.ChannelService,Fn.MosAppService}catch(e){E("Neither @1js/officeaicopilot-chat-core nor @1js/officeaicopilot-chat could be loaded")}}try{var Un=n(473023);Un.MsgExtDialogContainer}catch(e){try{var qn=n(625771);qn.MsgExtDialogContainer}catch(e){E("Neither @1js/officeaicopilot-chat-core nor @1js/officeaicopilot-chat could be loaded")}}var Bn=n(40211),zn=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}(),jn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Gn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Wn=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getToken=function(e){return jn(this,void 0,void 0,(function(){var t,n,o;return Gn(this,(function(i){switch(i.label){case 0:return t=(0,ke.A)(),Kn(t,Bn.o.AuthService,Bn.L.GetToken,{request:e}),n=new zn,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e}(),Qn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Jn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Vn=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.botInvoke=function(e){return Qn(this,void 0,void 0,(function(){var t,n,o;return Jn(this,(function(i){switch(i.label){case 0:return t=(0,ke.A)(),Kn(t,Bn.o.ChannelService,Bn.L.BotInvoke,{request:e}),n=new zn,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e.prototype.botMessage=function(e){return Qn(this,void 0,void 0,(function(){return Jn(this,(function(e){throw new Error("Method not implemented.")}))}))},e}(),Kn=function(e,t,n,o){Office.context.ui.messageParent(JSON.stringify({requestId:e,type:Xt.o.onServiceRequest,serviceName:t,apiName:n,requestData:o}),{targetOrigin:window.location.origin})},Yn=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},Zn=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},$n=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getApp=function(e){return Yn(this,void 0,void 0,(function(){var t,n,o;return Zn(this,(function(i){switch(i.label){case 0:return t=(0,ke.A)(),Kn(t,Bn.o.AppService,Bn.L.GetApp,{request:e}),n=new zn,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return o=i.sent(),[2,JSON.parse(o)]}}))}))},e.prototype.getApps=function(){return Yn(this,void 0,void 0,(function(){var e,t,n;return Zn(this,(function(o){switch(o.label){case 0:return e=(0,ke.A)(),Kn(e,Bn.o.AppService,Bn.L.GetApps),t=new zn,this.requestByQueryId.set(e,t),[4,t.completion];case 1:return n=o.sent(),[2,JSON.parse(n)]}}))}))},e}(),Xn=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogInfo=function(e){var t=(0,ke.A)();Kn(t,Bn.o.TelemetryService,Bn.L.LogInfo,{request:e})},e.prototype.LogError=function(e){var t=(0,ke.A)();Kn(t,Bn.o.TelemetryService,Bn.L.LogError,{request:e})},e.prototype.LogException=function(e){var t=(0,ke.A)();Kn(t,Bn.o.TelemetryService,Bn.L.LogException,{request:e})},e.prototype.LogWarning=function(e){var t=(0,ke.A)();Kn(t,Bn.o.TelemetryService,Bn.L.LogWarning,{request:e})},e.prototype.LogVerbose=function(e){var t=(0,ke.A)();Kn(t,Bn.o.TelemetryService,Bn.L.LogVerbose,{request:e})},e.prototype.LogMetric=function(e){var t=(0,ke.A)();Kn(t,Bn.o.TelemetryService,Bn.L.LogMetric,{request:e})},e}(),eo=function(){return null},to=eo,no=eo;try{var oo=n(473023);to=oo.ExternalAuthService,no=oo.MsgExtDialogContainer}catch(e){try{var io=n(625771);to=io.ExternalAuthService,no=io.MsgExtDialogContainer}catch(e){E("Neither @1js/officeaicopilot-chat-core nor @1js/officeaicopilot-chat could be loaded")}}he.memo((function(e){var t=e.dialogContent,n=e.appDefinition,o=e.userContext,i=e.hostContext,r=e.clientInfo,a=e.handleCloseButtonClick,s=e.shouldShowDismissIcon,c=e.copilotChatThemeV2,l=e.cardInfo,u=e.hostConfigFlags,d=he.useMemo((function(){return $n.getInstance()}),[]),f=he.useMemo((function(){return Wn.getInstance()}),[]),p=he.useMemo((function(){return Vn.getInstance()}),[]),h=he.useMemo((function(){return Xn.getInstance()}),[]),g=he.useMemo((function(){return new to}),[]);return he.createElement(tt.q,{theme:c},he.createElement(no,{dialogContent:t,botService:p,appDefinition:n,tokenService:f,telemetryService:h,userContext:o,hostContext:i,appService:d,externalAuthService:g,clientInfo:r,handleCloseButtonClick:a,shouldShowDismissIcon:s,cardInfo:l,createAndSendSignalsToSubstrate:!1,hostConfigFlags:u}))}));var ro=function(e){var t={appId:"",botId:"",cardId:""};if(!(null==e?void 0:e.cardData))return E("msgExtension Utils: cardData is not present in taskModuleProps"),t;try{var n=JSON.parse(e.cardData);t={appId:n.appId,botId:n.botId,cardId:n.cardId}}catch(e){E("msgExtension Utils: Failed to extract cardId from cardData")}return t},ao=function(){return ao=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ao.apply(this,arguments)},so=function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},co=function(e,t){var n,o,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},a=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return a.next=s(0),a.throw=s(1),a.return=s(2),"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,s[0]&&(r=0)),r;)try{if(n=1,o&&(i=2&s[0]?o.return:s[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,s[1])).done)return i;switch(o=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,o=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!(i=r.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=t.call(e,r)}catch(e){s=[6,e],o=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.startTime=0,this.useDimensionsV2=!1,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},E("MsgExtDialogLauncher : Task Module dialog closed")},this.shouldUseDimensionsV2=function(e){t.useDimensionsV2=e},this.logDialogTelemetry=function(e,n){var o=Date.now();J(o-t.startTime,e,null!=n?n:""),e||V(null!=n?n:"")},this.onMessageCallback=function(n){return so(t,void 0,void 0,(function(){var t,o,i,a,s,f,p,h,g,v,y,b,m,C;return co(this,(function(I){switch(I.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(n)).type!==Xt.o.Ack?[3,1]:(o=ro(this.taskModuleProps),a={dialogContent:null===(v=this.taskModuleProps)||void 0===v?void 0:v.dialogContent,appDefinition:null===(y=this.taskModuleProps)||void 0===y?void 0:y.appDefinition,clientInfo:null===(b=this.taskModuleProps)||void 0===b?void 0:b.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:o,hostConfigFlags:null===(m=this.taskModuleProps)||void 0===m?void 0:m.hostConfigFlags,copilotChatThemev2:e.theme,source:"AppChat"},this.openedDialog.dialog.messageChild(JSON.stringify(a),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0),[3,6]):(this.logDialogTelemetry(!1,"MsgExtDialogLauncher.onMessageCallback : No active dialog found"),[2]);case 1:return t.type!==Xt.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==Xt.o.onServiceRequest)return[3,6];null===(C=r.setQueryGuid)||void 0===C||C.call(r,t.requestId),E("MsgExtDialogLauncher : Received service request from dialog",t),i={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},r.sendChatEventTelemetry(k(((p={})[l.ChatEventType]=u.TaskModuleServiceRequest,p[l.ChatEventParameters]=JSON.stringify(i),p))),a={requestId:t.requestId,messageType:Xt.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},I.label=3;case 3:return I.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(s=I.sent())&&(a.result=s),E("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),r.sendChatEventTelemetry(k(((h={})[l.ChatEventType]=u.TaskModuleServiceResponse,h[l.ChatEventParameters]=JSON.stringify(i),h))),this.openedDialog.dialog.messageChild(JSON.stringify(a),{targetOrigin:window.location.origin}),[3,6];case 5:return f=I.sent(),E("MsgExtDialogLauncher : Error executing plugin operation",f),r.sendErrorTelemetry(k(((g={})[d.ErrorMessage]=JSON.stringify(ao(ao({},i),{error:f})),g[d.ErrorCategory]=c.ExtensibilityDialog,g[d.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),g))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(n=t.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.onDialogError=function(e){var n="Error opening dialog";if(e)try{n=JSON.stringify(e)}catch(e){E("MsgExtDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"MsgExtDialogLauncher : ".concat(n))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return so(t,void 0,void 0,(function(){var t,o,i=this;return co(this,(function(r){switch(r.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=ro(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return o=rn(),[4,Office.context.ui.displayDialogAsync(o,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return so(i,void 0,void 0,(function(){var n,o,i=this;return co(this,(function(r){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(o=null===(n=this.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)&&void 0!==o?o:""},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return so(i,void 0,void 0,(function(){return co(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return so(i,void 0,void 0,(function(){return co(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return r.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return so(t,void 0,void 0,(function(){var t,o,i,r=this;return co(this,(function(a){return this.shouldDisplayDismissIcon=!1,t=rn(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(i=null===(o=this.taskModuleProps)||void 0===o?void 0:o.dialogTitle)&&void 0!==i?i:we,hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){r.openedDialog.dialog=e})).catch((function(e){r.onDialogError(e),E("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e){return so(t,void 0,void 0,(function(){var t,n,o,i,r,a,s;return co(this,(function(c){return this.startTime=Date.now(),this.taskModuleProps=e,t=0,n=0,this.useDimensionsV2?(i=function(e){var t,n;if(e.viewMode!==tn)return{dialogHeight:nn,dialogWidth:nn};var o=an(null===(t=e.dialogContent)||void 0===t?void 0:t.height),i=an(null===(n=e.dialogContent)||void 0===n?void 0:n.width),r=!0,a=!0,s=55,c=50;o<=0&&(a=!1,s=ln(o)),i<=0&&(r=!1,c=cn(i));var l=screen.width,u=screen.height;return a&&(s=sn(o,u)),r&&(c=sn(i,l)),{dialogHeight:s,dialogWidth:c}}(e),t=i.dialogHeight,n=i.dialogWidth):(o=null===(a=e.clientInfo)||void 0===a?void 0:a.clientType,r=o===en.WK.web?function(e){var t,n;if(e.viewMode===tn){var o=null===(t=e.dialogContent)||void 0===t?void 0:t.height,i=null===(n=e.dialogContent)||void 0===n?void 0:n.width;if(!o||!i||"number"!=typeof i||"number"!=typeof o)return{dialogHeight:55,dialogWidth:50};var r=screen.width,a=screen.height;return{dialogHeight:Math.floor(o/a*100),dialogWidth:Math.floor(i/r*100)}}return{dialogHeight:nn,dialogWidth:nn}}(e):function(e){var t,n,o,i,r=e.viewMode,a=r===tn?window.outerWidth:window.innerWidth,s=r===tn?window.outerHeight:window.innerHeight,c=r===tn?5:0,l=r===tn?2:0,u=null===(t=e.dialogContent)||void 0===t?void 0:t.height,d=null===(n=e.dialogContent)||void 0===n?void 0:n.width;try{if("number"==typeof d&&"number"==typeof u&&d<=a&&u<=s){var f=Math.floor(u/s*100),p=Math.floor(d/a*100);o=f+c,i=p+l}else o=55,i=50}catch(e){o=55,i=50}return{dialogHeight:o,dialogWidth:i}}(e),t=r.dialogHeight,n=r.dialogWidth),(null===(s=e.clientInfo)||void 0===s?void 0:s.clientType)===en.WK.web?this.openDialogForWebPlatformAsNewWindow(t,n):this.openDialogForNativePlatform(t,n),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}e.getInstance=function(){return e.instance||new e},e.setTheme=function(t){e.theme=t}}();var lo=n(143567);const uo="https://graph.microsoft.com",fo=e=>({accessToken:e.accessToken,expirationTime:e?.expiresOn?.getTime()??0});var po=n(758651);class ho{constructor(e){this.params=e}async loadMsalBrowser(){for(let e=1;e<=3;e++)try{return this.msalModule=await Promise.all([n.e("vendors~shared"),n.e("vendors~auth-msal-browser")]).then(n.bind(n,789393)),void(this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication))}catch(t){if(po.error(`Attempt ${e} to load @azure/msal-browser failed:`,t),3===e)throw t}}async createPublicClientApplication(e){const t=this.params.clientId,n=this.params.redirectUri;return new e({auth:{clientId:t,authority:"https://login.microsoftonline.com/common",redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"}})}async getToken(e,t){po.log("MsalTokenService.getToken called for resource: "+e),this.publicClientApplication||await this.loadMsalBrowser();const n=await this.publicClientApplication;if(!n)throw new Error("Failed to acquire token - Could not load msal module");let o;try{await n.initialize();const t=n.getAllAccounts();if(0===t?.length){return await this.ssoSilentNoAccount(e,n)}if(o=await this.getSelectedAccount(t,n),!o)throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return await this.acquireTokenSilent(e,o,n)}catch(t){if(po.log(`Failed to get access token: ${t?.message}`),this.msalModule&&t instanceof this.msalModule.InteractionRequiredAuthError){return await this.acquireTokenPopup(e,o,n)}throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),t}}async getSelectedAccount(e,t){if(this.loginPopupPromise){const e=await this.loginPopupPromise;return e?.account??void 0}if(!e||0===e.length)return;const n=this.params?e.find((e=>e.username?.toLowerCase()===this.params?.userPrincipalName?.toLowerCase()))??null:e[0];if(n)return n;const o=this.params?{loginHint:this.params.userPrincipalName}:void 0;try{this.loginPopupPromise=t.loginPopup(o);const e=await this.loginPopupPromise;return e?.account??void 0}finally{this.loginPopupPromise=void 0}}async ssoSilentNoAccount(e,t){const n={scopes:[`${e}/.default`],loginHint:this.params?.userPrincipalName},o=await t.ssoSilent(n);return o||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),o}async acquireTokenSilent(e,t,n){const o={scopes:[`${e}/.default`],account:t},i=await n.acquireTokenSilent(o);return i||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),i}async acquireTokenPopup(e,t,n){const o={scopes:[`${e}/.default`],account:t},i=await n.acquireTokenPopup(o);return i||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),i}logTokenAcquiredError(e){po.log("AuthTokenService",e)}}var go=n(235095),vo=n(87866),yo=n(78364),bo=n(723956),mo=n(379563);const Co=(0,Ie.n)({dialog:{display:"flex",width:"100%",height:"100%",maxWidth:"unset",backgroundColor:zt.L.colorNeutralBackground4Hover,...mo.Pt.padding("0px","0px","0px","0px"),border:"none",borderRadius:"0px"},dialogBody:{width:"100%",height:"100%",maxHeight:"100%"},dialogContent:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},spinner:{position:"fixed",left:"50%",top:"50%"},iframe:{width:"97vw",height:"95vh",maxWidth:"100%",maxHeight:"100%",display:"block"}});var Eo=n(758651);function Io(e){const{service:t,onItemSelected:n,onDismissDialog:o,onErrorInLoading:i}=e,[r,a]=he.useState(!0),[s,c]=he.useState(null),l=Co();he.useEffect((()=>{const e={pick:async e=>{Eo.log(e),n(e.items)},close:async e=>{o()},pageLoaded:e=>{a(!1)}};if(s){let n;return t.initializePicker(s,e).then((e=>{n=e})).catch((e=>{i()})),()=>n?.()}}),[s,t]);const u=he.useCallback((e=>{c(e&&e.contentWindow||null)}),[]);return he.createElement("div",null,he.createElement(go.E,{className:l.dialog},he.createElement(vo.R,{className:l.dialogBody},he.createElement(yo.C,{className:l.dialogContent},r&&he.createElement(bo.y,{size:"large",className:l.spinner}),he.createElement("iframe",{title:"File Picker",sandbox:"allow-forms allow-modals allow-popups allow-same-origin allow-scripts",ref:u,className:l.iframe})))))}var Lo=n(758651);const So=e=>{const{userPrincipalName:t,appName:n,theme:o,locale:i,clientId:r,redirectUri:a,onItemSelected:s,onErrorInLoading:c,onDismissDialog:l,supportedFileExtensionMimeMap:u}=e,d=he.useMemo((()=>new ho({userPrincipalName:t,redirectUri:a,clientId:r})),[t,a,r]),f=he.useCallback((async e=>{try{const t=await d.getToken(e??uo);return fo(t)}catch(e){return Lo.error("Error acquiring graph token:",e),{accessToken:"",expirationTime:0}}}),[d]),p=he.useCallback((async e=>{try{const t=await d.getToken(e);return fo(t)}catch(e){return Lo.error("Error acquiring sharepoint token:",e),{accessToken:"",expirationTime:0}}}),[d]),[h,g]=he.useState(void 0);return he.useEffect((()=>{const e=new lo.P(f,p,n,i,o,u);g(e)}),[n,f,i,p,o,u]),he.createElement("div",null,h?he.createElement(Io,{service:h,onItemSelected:s,onDismissDialog:l,onErrorInLoading:c}):he.createElement("div",null,"Loading..."))};var Ao=n(946217),wo=n(884067),To=n(926773);Office.onReady((async()=>{Office.context.ui.addHandlerAsync(Office.EventType.DialogParentMessageReceived,(e=>{let t;try{t=JSON.parse(e.message)}catch(e){t={}}(0,pn.render)(he.createElement(Ao.q,{theme:t.isDarkMode?wo.C:To.o},he.createElement(So,{userPrincipalName:t.userPrincipalName??"",clientId:t.clientId??"",redirectUri:t.redirectUri??"",locale:t.locale??"",appName:"Excel",onItemSelected:e=>{const t={type:B.OnItemSelected,files:e};Office.context.ui.messageParent(JSON.stringify(t))},onDismissDialog:()=>{const e={type:B.CloseEvent};Office.context.ui.messageParent(JSON.stringify(e))},onErrorInLoading:()=>{const e={type:B.OnErrorInLoading};Office.context.ui.messageParent(JSON.stringify(e))},theme:t.isDarkMode?"dark":"default"})),document.getElementById("cloud-file-picker-container"))})),Office.context.ui.messageParent(JSON.stringify({type:B.Ack}))}))},671100:()=>{}},a={};function s(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}s.m=r,e=[],s.O=(t,n,o,i)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){for(var[n,o,i]=e[u],a=!0,c=0;c<n.length;c++)(!1&i||r>=i)&&Object.keys(s.O).every((e=>s.O[e](n[c])))?n.splice(c--,1):(a=!1,i<r&&(r=i));if(a){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,o,i]},s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var i=Object.create(null);s.r(i);var r={};t=t||[null,n({}),n([]),n(n)];for(var a=2&o&&e;"object"==typeof a&&!~t.indexOf(a);a=n(a))Object.getOwnPropertyNames(a).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,s.d(i,r),i},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},i="TypeScriptModule:",s.l=(e,t,n,r)=>{if(o[e])o[e].push(t);else{var a,c;if(void 0!==n)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==i+n){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",i+n),a.src=e),o[e]=[t];var f=(t,n)=>{a.onerror=a.onload=null,clearTimeout(p);var i=o[e];if(delete o[e],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),s.j="cloudFilePickerDialog",(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{s.b=document.baseURI||self.location.href;var e={cloudFilePickerDialog:0};s.f.j=(t,n)=>{var o=s.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var i=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=i);var r=s.p+s.u(t),a=new Error;s.l(r,(n=>{if(s.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",a.name="ChunkLoadError",a.type=i,a.request=r,o[1](a)}}),"chunk-"+t,t)}},s.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[r,a,c]=n,l=0;if(r.some((t=>0!==e[t]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(c)var u=c(s)}for(t&&t(n);l<r.length;l++)i=r[l],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(u)},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),s.nc=void 0,s.O(void 0,["chunk1jsfluent","chatcore","augloop-chunk","vendors~shared"],(()=>s(653012)));var c=s.O(void 0,["chunk1jsfluent","chatcore","augloop-chunk","vendors~shared"],(()=>s(501245)));c=s.O(c),TypeScriptModule=c})();
//# sourceMappingURL=cloudFilePickerDialog.js.map