"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([["augloop-chunk"],{1171:(e,t,s)=>{var n,o,i;s.d(t,{$n:()=>n,hc:()=>i}),function(e){e.Unknown="Unknown",e.Unlimited="Unlimited",e.Limited="Limited"}(n||(n={})),function(e){e.Unknown="Unknown",e.Substrate="Substrate",e.CopilotAgentBilling="CopilotAgentBilling",e.CopilotAgentBillingPromo="CopilotAgentBillingPromo",e.CopilotAgentBillingPAYG="CopilotAgentBillingPAYG"}(o||(o={})),function(e){e[e.Success=0]="Success",e[e.BadRequest=1]="BadRequest",e[e.Unauthorized=2]="Unauthorized",e[e.ResourcesNotFound=3]="ResourcesNotFound",e[e.Forbidden=4]="Forbidden",e[e.Timeout=5]="Timeout",e[e.InternalServerError=6]="InternalServerError",e[e.ServiceUnavailable=7]="ServiceUnavailable",e[e.Unknown=8]="Unknown",e[e.ErrorInExecution=9]="ErrorInExecution",e[e.OutOfCredits=10]="OutOfCredits",e[e.BypassDeduction=11]="BypassDeduction",e[e.Overloaded=12]="Overloaded",e[e.AgentBillingNotAvailable=13]="AgentBillingNotAvailable"}(i||(i={}))},3722:(e,t,s)=>{function n(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}s.d(t,{v4:()=>n})},8165:(e,t,s)=>{s.d(t,{Cs:()=>u,Td:()=>i,U8:()=>r,f8:()=>p,i2:()=>c,og:()=>a,tj:()=>o,wR:()=>l});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetClaimsChallengeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireClaimsChallengeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetSeedingStatusChangeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireSeedingStatusChangeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_InteractiveAuthMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsResponseBridgeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetHostBridgeSessionRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetHostBridgeSessionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()}},11589:(e,t,s)=>{s.d(t,{x:()=>i});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SuggestionAPIResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SubstrateAPIResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},12651:(e,t,s)=>{var n;s.d(t,{m:()=>n}),function(e){e.FormulaGenerationSkill="FormulaGenerationSkill",e.NonODSLFormulaGenerationSkill="NonODSLFormulaGenerationSkill",e.UnifiedNLToFormulaGenerationSkill="UnifiedNLToFormulaGenerationSkill"}(n||(n={}))},19821:(e,t,s)=>{s.d(t,{m:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Pid=0,e.prototype.ApplicationName="",e.prototype.ServiceName="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ProcessIdentificationEvent"},e}())},28515:(e,t,s)=>{var n,o,i,a,r;s.d(t,{Cu:()=>r,Ww:()=>o,pT:()=>a,v1:()=>n}),function(e){e.MARKDOWN="markdown",e.HTML="html",e.TEXT="text",e.JSON="json",e.BASE64="base64",e.NONE="none"}(n||(n={})),function(e){e.NONE="none",e.TESTING="testing",e.WORD="word",e.EXCEL="excel",e.POWERPOINT="powerpoint",e.OUTLOOK="outlook",e.BIZ_CHAT="bizchat",e.BING_CHAT="bingchat",e.ONENOTE="onenote",e.FORMS="forms",e.LOOP="loop",e.COPILOTLAB="copilotlab",e.ONEDRIVE="OneDriveForBusiness",e.SHAREPOINT="SharePointPages",e.TEAMS="Teams",e.CREATEMODULE="CreateModule"}(o||(o={})),function(e){e.NONE="none",e.APP_CHAT="AppChat",e.CANVAS="Canvas",e.NARRATIVE_BUILDER="NarrativeBuilder",e.DRAFT_COMPOSE="DraftCompose",e.START_COPILOT="StartCopilot"}(i||(i={})),function(e){e.NONE="none",e.WEB="Web",e.Win32="Win32",e.MAC="Mac",e.IOS="iOS",e.ANDROID="Android"}(a||(a={})),function(e){e.NONE="default_scenario",e.NEW="new",e.GENERATE="generate",e.OPEN="open",e.INAPP="inapp",e.EDIT="edit",e.GENERATE_AND_OPEN="generate_and_open"}(r||(r={}))},28961:(e,t,s)=>{var n;s.d(t,{v:()=>n}),function(e){e[e.General=0]="General",e[e.Number=1]="Number",e[e.Text=2]="Text",e[e.Date=3]="Date",e[e.Time=4]="Time",e[e.Currency=5]="Currency",e[e.Accounting=6]="Accounting"}(n||(n={}))},32099:(e,t,s)=>{s.d(t,{xx:()=>o,zi:()=>i});var n=s(985002),o=(function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ConversationalCopilot_ConversationalTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ConversationalCopilot_AudioCopilotTile"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ConversationalCopilot_OAAudioCopilotTile"},e.getBaseTypes=function(){return["AugLoop_ConversationalCopilot_AudioCopilotTile"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();!function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ConversationalCopilot_ActionAudioCopilotTile"},e.getBaseTypes=function(){return["AugLoop_ConversationalCopilot_AudioCopilotTile"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},37410:(e,t,s)=>{s.d(t,{DE:()=>a,aO:()=>r,qO:()=>i});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotOdslSignal"}static getBaseTypes(){return["AugLoop_CopilotOdsl_CopilotOdslSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotProgramResponseSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelHandoffMessageId"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffMessageId","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},41498:(e,t,s)=>{var n,o,i,a,r,c,l,u,p,g,h,d;s.d(t,{Bh:()=>i,RN:()=>u,Uy:()=>d,XJ:()=>r,Y$:()=>a,gd:()=>h,in:()=>c,mk:()=>o,ni:()=>g,ov:()=>p,qW:()=>l,wC:()=>n}),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(n||(n={})),function(e){e.Default="Default",e.Copilot="Copilot"}(o||(o={})),function(e){e[e.None=0]="None",e[e.ContentFiltering_M365Copilot=1]="ContentFiltering_M365Copilot"}(i||(i={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(a||(a={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(r||(r={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(c||(c={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(l||(l={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(u||(u={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(p||(p={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(g||(g={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount",e.ExtensionLimits="ExtensionLimits"}(h||(h={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(d||(d={}))},42667:(e,t,s)=>{s.d(t,{B:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_GenerateAudioCastSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},46029:function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,o)}:function(e,t,s,n){void 0===n&&(n=s),e[n]=t[s]}),o=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),o(s(145097),t),o(s(742315),t)},49279:e=>{e.exports={r:"2.35.2443"}},50233:(e,t,s)=>{var n;s.d(t,{c:()=>n}),function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Folder="Folder",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(n||(n={}))},53403:(e,t,s)=>{t.pR=t.O7=t.i6=t.Jq=t.wS=t._C=void 0;const n=s(887571);var o,i;!function(e){e[e.Person=0]="Person",e[e.NonPerson=1]="NonPerson",e[e.File=2]="File",e[e.WordDocument=3]="WordDocument",e[e.Powerpoint=4]="Powerpoint",e[e.PDF=5]="PDF",e[e.Excel=6]="Excel",e[e.Meeting=7]="Meeting",e[e.Chat=8]="Chat",e[e.Email=9]="Email",e[e.Unknown=10]="Unknown"}(o||(o={})),function(e){e[e.PastMeeting=0]="PastMeeting",e[e.FutureMeeting=1]="FutureMeeting",e[e.Unknown=2]="Unknown"}(i||(i={}));t._C={"whats the latest from":o.Person,"when is my next meeting with":o.Person,"what s the latest from":o.Person,"when s my next meeting with":o.Person,"what did":o.Person,recap:o.Meeting,"draft an email with action items from":o.Meeting,"what are the unresolved issues from":o.Meeting,"help me prepare for my next meeting":o.Meeting,"what were the key takeaways from":o.Meeting,"what are the key takeaways from":o.Meeting,"list key points from":o.File,"create a faq based on":o.File,"propose a new introduction to":o.File,"suggest edits make this more concise":o.File},t.wS={"¿cuáles fueron los problemas abiertos de":i.PastMeeting,"¿cuáles fueron los problemas abiertos de la":i.PastMeeting,"rédige un courriel contenant des notes et des éléments d’action de la":i.PastMeeting,"rédige un e-mail contenant des notes et des éléments d’action de la":i.PastMeeting,"crea una bozza di e-mail con le note e le attività definite durante la":i.PastMeeting,"entwirf eine e-mail mit notizen und aktionselementen aus":i.PastMeeting,"redacta un borrador de correo electrónico con notas y acciones de":i.PastMeeting,使用来自:i.PastMeeting,"draft an email with notes and action items from":i.PastMeeting,"¿cuáles son los elementos de acción de":i.PastMeeting,"elabore um email com anotações e itens de ação":i.PastMeeting,"was waren die offenen fragen in":i.PastMeeting,"what were the open issues from":i.PastMeeting,"quels étaient les problèmes en suspens par rapport à la":i.PastMeeting,"quali sono state le questioni discusse nella":i.PastMeeting,"quais foram os problemas em aberto da":i.PastMeeting,"what are the action items from":i.PastMeeting,"quali sono le attività da svolgere definite nella":i.PastMeeting,"was sind die aktionselemente aus":i.PastMeeting,"quels sont les points d'action issus de la":i.PastMeeting,"quais são os itens de ação da":i.PastMeeting,recap:i.PastMeeting,"resuma a":i.PastMeeting,"récap. la":i.PastMeeting,"resume las conclusiones y elementos de acción de la":i.PastMeeting,"crea un riepilogo della":i.PastMeeting,回顾:i.PastMeeting,récap:i.PastMeeting},t.Jq={"のオープンしている問題は何でしたか?":i.PastMeeting,"を要約し、主要な要点とアクション アイテムを別のセクションとしてまとめ、各責任者を含めます":i.PastMeeting,"中的未解决问题有哪些?":i.PastMeeting,"のアクション アイテムは何ですか?":i.PastMeeting,"中的拟办事项有哪些?":i.PastMeeting,"zusammen, mit ergebnissen/aktionselementen als abschnitten, mit zuständigen.":i.PastMeeting,"のメモとアクション アイテムを含むメールの下書きを作成します":i.PastMeeting},t.i6={"latest from":o.Person,"manager of":o.Person,who:o.Person,"who is":o.Person,message:o.NonPerson,messages:o.NonPerson,summarize:o.NonPerson,concise:o.NonPerson,elaborate:o.NonPerson,"introduction to":o.NonPerson,"points from":o.NonPerson,"items from":o.NonPerson,"issues from":o.NonPerson,"based on":o.NonPerson,in:o.NonPerson,meeting:o.Meeting,event:o.Meeting,meet:o.Meeting,sync:o.Meeting,"sync up":o.Meeting,call:o.Meeting,huddle:o.Meeting,scrum:o.Meeting,conference:o.Meeting,conf:o.Meeting,review:o.Meeting,discussion:o.Meeting,brief:o.Meeting,briefing:o.Meeting,appointment:o.Meeting,recap:o.Meeting,"prepare for":o.Meeting,"prep for":o.Meeting,file:o.File,files:o.File,document:o.WordDocument,documents:o.WordDocument,doc:o.WordDocument,word:o.WordDocument,docx:o.WordDocument,excel:o.Excel,sheet:o.Excel,spreadsheet:o.Excel,"spread sheet":o.Excel,presentation:o.Powerpoint,deck:o.Powerpoint,powerpoint:o.Powerpoint,"power point":o.Powerpoint,ppt:o.Powerpoint,pptx:o.Powerpoint,pdf:o.PDF,email:o.Email,emails:o.Email,"e mail":o.Email,"e mails":o.Email,chat:o.Chat,chats:o.Chat,group:o.Chat,groups:o.Chat,conversation:o.Chat,conversations:o.Chat};const a=new Set(["with","by"]);function r(e){let s=o.Unknown;const n=h(e);if(t._C.hasOwnProperty(n))return t._C[n];const i=n.split(" "),r=i[i.length-1];if(t.i6.hasOwnProperty(r)&&(s=t.i6[r]),i.length>=2){const e=i.slice(Math.max(0,i.length-2)).join(" ");t.i6.hasOwnProperty(e)&&(s=t.i6[e]);const n=i[i.length-2];("from"===r&&t.i6.hasOwnProperty(n)||a.has(r))&&(s=o.Person)}return s}function c(e,s){const n=e.trim().toLowerCase();if(t.wS.hasOwnProperty(n))return t.wS[n];if(s){const e=s.trim().toLowerCase();if(t.Jq.hasOwnProperty(e))return t.Jq[e]}return i.Unknown}function l(e){const s=h(e).split(" "),n=Math.min(s.length,5),o=s.slice(Math.max(0,s.length-n)).join(" ");for(const e in t.O7)if(o.includes(e))return t.O7[e];return i.Unknown}function u(e){const t=[];if(void 0!==e&&e!==o.Unknown)switch(e){case o.Person:t.push({name:"#people#",scope:n.IntentScope.FirstParty,score:1,confidenceLevel:n.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case o.NonPerson:t.push({name:"#people#",scope:n.IntentScope.FirstParty,score:0,confidenceLevel:n.IntentConfidenceLevel.Low,highConfidenceSign:!1});break;case o.File:t.push({name:"#file#",scope:n.IntentScope.FirstParty,score:1,confidenceLevel:n.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case o.WordDocument:t.push({name:"#file#",scope:n.IntentScope.FirstParty,score:1,confidenceLevel:n.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"doc"},{slotName:"file_type",slotValue:"docx"}],highConfidenceSign:!0});break;case o.Powerpoint:t.push({name:"#file#",scope:n.IntentScope.FirstParty,score:1,confidenceLevel:n.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"ppt"},{slotName:"file_type",slotValue:"pptx"}],highConfidenceSign:!0});break;case o.PDF:t.push({name:"#file#",scope:n.IntentScope.FirstParty,score:1,confidenceLevel:n.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"pdf"}],highConfidenceSign:!0});break;case o.Excel:t.push({name:"#file#",scope:n.IntentScope.FirstParty,score:1,confidenceLevel:n.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"xls"},{slotName:"file_type",slotValue:"xlsx"}],highConfidenceSign:!0});break;case o.Meeting:t.push({name:"#event#",scope:n.IntentScope.FirstParty,score:1,confidenceLevel:n.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case o.Chat:t.push({name:"#chat#",scope:n.IntentScope.FirstParty,score:1,confidenceLevel:n.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case o.Email:t.push({name:"#email#",scope:n.IntentScope.FirstParty,score:1,confidenceLevel:n.IntentConfidenceLevel.High,highConfidenceSign:!0})}return t}function p(e,t,s){const o=function(e,t){let s;if(void 0!==e&&e!==i.Unknown)switch(e){case i.FutureMeeting:s={name:"#event#",scope:n.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?n.IntentConfidenceLevel.High:n.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"future"}],highConfidenceSign:!!t};break;case i.PastMeeting:s={name:"#event#",scope:n.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?n.IntentConfidenceLevel.High:n.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"past"}],highConfidenceSign:!!t}}return s}(e,s);if(void 0===o)return;const a=t.find((e=>e.name===o.name));a?(a.score=Math.max(a.score,o.score),a.confidenceLevel=Math.max(a.confidenceLevel,o.confidenceLevel),a.highConfidenceSign=a.highConfidenceSign||o.highConfidenceSign,a.slots=g(a.slots,o.slots)):t.push(o)}function g(e,t){if(t){if(e){const s=t.filter((t=>!e.some((e=>t.slotName===e.slotName))));return[...e,...s]}return t}return e}function h(e){let t=e.toLowerCase().trim().replace(/[^\w\s]/g," ").trim().toLowerCase();return t=t.replace(/\s+/g," "),t}t.O7={"prepare for":i.FutureMeeting,"prep for":i.FutureMeeting,"prepare me for":i.FutureMeeting,"prep me for":i.FutureMeeting,"next meeting":i.FutureMeeting,"next event":i.FutureMeeting,"next sync":i.FutureMeeting,"next call":i.FutureMeeting,upcoming:i.FutureMeeting,"to be discussed":i.FutureMeeting,recap:i.PastMeeting,"last meeting":i.PastMeeting,"previous meeting":i.PastMeeting,summarize:i.PastMeeting,"summary of":i.PastMeeting,"points from":i.PastMeeting,"items from":i.PastMeeting,"takeaways from":i.PastMeeting,discussed:i.PastMeeting,"issues from":i.PastMeeting,"based on":i.PastMeeting},t.pR=function(e,t){var s,n;if((null!==(s=null==e?void 0:e.length)&&void 0!==s?s:0)<=0&&(null!==(n=null==t?void 0:t.length)&&void 0!==n?n:0)<=0)return;const o=u(r(e)),a=c(e,t);return a!==i.Unknown?p(a,o,!0):p(l(e),o),o}},60616:(e,t,s)=>{var n,o;s.d(t,{O:()=>n,o:()=>o}),function(e){e.UnknownError="UnknownError",e.SubstrateSearchError="SubstrateSearchError",e.FailedToProcessFile="FailedToProcessFile",e.FailedToGeneratePowerQueryFormula="FailedToGeneratePowerQueryFormula",e.Timeout="Timeout",e.RAI="RAI",e.FailedToParseRelevancyResponse="FailedToParseRelevancyResponse",e.UserQueryNotFound="UserQueryNotFound",e.NoDataSourcesFound="NoDataSourcesFound",e.DLPPolicyCheckFailed="DLPPolicyCheckFailed"}(n||(n={})),function(e){e.ExcelFile="ExcelFile"}(o||(o={}))},63461:(e,t,s)=>{s.d(t,{dF:()=>r,kp:()=>o,uC:()=>i});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffOutboundMessage"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffMessage"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffEncodedPrompt"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffDocUrlAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffPluginAnswer"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},82133:(e,t,s)=>{var n;s.d(t,{O:()=>n}),function(e){e.Disabled="Disabled",e.Predictive="Predictive",e.UserInitiated="UserInitiated"}(n||(n={}))},83222:(e,t,s)=>{s.d(t,{KL:()=>i,SM:()=>u,Yd:()=>r,aO:()=>o,dV:()=>l,k2:()=>c,uH:()=>a});var n=s(985002),o=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),a=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagAnnotation"},e.getBaseTypes=function(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),u=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();!function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},94470:(e,t,s)=>{s.d(t,{In:()=>u,e3:()=>a,el:()=>c,kQ:()=>l});var n=s(301520),o=s(521409),i=s(297330);function a(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function r(e,t){e.src=t}function c(e,t,s,a,c){const l=new n.I({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});if(l.start(),(0,i.fE)(l)){const e="Browser lacks necessary support for inference service";return l.success=!1,l.resultDescription=e,o.tG.info(540406803,o.nh.CoreDefault,l.stop()),Promise.reject(new Error(e))}return new Promise(((n,o)=>{if("undefined"!=typeof document){const i=document.createElement("script");(c||r)(i,e),i.onload=()=>{p(t,s)?(a&&(t()[s].env.wasm.wasmPaths=a),n()):(i.remove(),o(new Error("ort.Tensor and/or ort.InferenceSession are undefined")))},i.onerror=o,document.body.appendChild(i)}else globalThis.importScripts?(globalThis.importScripts(e),globalThis[s]=self[s],p(t,s)?(a&&(t()[s].env.wasm.wasmPaths=a),n()):o(new Error("ort.Tensor and/or ort.InferenceSession are undefined"))):o(new Error("Unexpected lack of document and importScripts"))})).then((()=>{o.tG.info(540406804,o.nh.CoreDefault,l.stop())})).catch((e=>{throw l.success=!1,l.resultDescription=e.message,o.tG.info(509871835,o.nh.CoreDefault,l.stop()),e}))}function l(e,t,s){return i.Kx.create(e,t,s)}function u(){return i.G0.create()}function p(e,t){const s=globalThis[t];if(s&&s.InferenceSession&&s.Tensor){const n=e();return n&&!n[t]&&(n[t]=s),!0}return!1}},99449:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SessionHealth=t.SessionHealthImpact=t.SessionHealthReason=t.SessionHealthSource=void 0;const n=s(386561),o=s(601317);var i,a,r;!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(i||(t.SessionHealthSource=i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(a||(t.SessionHealthReason=a={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(r||(t.SessionHealthImpact=r={}));class c extends n.SessionHealthEvent{constructor(e,t){var s,n;super({source:i[e.source],reason:a[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:r[e.impact],success:e.success,durationMs:null!==(s=e.durationMs)&&void 0!==s?s:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(n=e.affectedWorkflows)&&void 0!==n?n:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",this.aggregationEnabled=!1,t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=a[e],this}setSource(e){return this.source=i[e],this}setImpact(e){return this.impact=r[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}enableAggregation(){return this.aggregationEnabled=!0,this}shouldBeAggregated(){return this.aggregationEnabled}start(){return this.startTime=(0,o.now)(),this}stop(){const e=(0,o.now)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}t.SessionHealth=c,c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},103694:(e,t,s)=>{s.d(t,{k:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpSocketListEvent"},e}())},109652:(e,t,s)=>{s.d(t,{A:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}())},115398:(e,t,s)=>{s.d(t,{L:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}get metadata(){return this.M_}set metadata(e){this.M_=e}static getTypeName(){return"AugLoop_ObservationalAssistanceAction_EntityLabelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ObservationalAssistanceAction_SensitivityLabel"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},117954:(e,t,s)=>{s.d(t,{L:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}())},124725:(e,t,s)=>{s.d(t,{pW:()=>r,yZ:()=>w});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelMetadata"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Excel_Worksheet"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Excel_WorksheetMetadata"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRange"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapper"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapperAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Excel_BaseExcelBlock"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelBlock"}static getBaseTypes(){return["AugLoop_Excel_BaseExcelBlock","AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelExtendedBlock"}static getBaseTypes(){return["AugLoop_Excel_BaseExcelBlock","AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelMergedCellInfo"}static getBaseTypes(){return["AugLoop_Excel_ExcelRange"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRangeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Excel_PathFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelGridSubtreeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){n.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelRangeSampleFilter"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeFilter","AugLoop_Core_ItemFilter"]}static typeGuard(e){return n.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelTableColumn"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){n.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Excel_BaseExcelTable"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return n.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){n.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelTable"}static getBaseTypes(){return["AugLoop_Excel_BaseExcelTable","AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return n.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){n.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelPivotTable"}static getBaseTypes(){return["AugLoop_Excel_BaseExcelTable","AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return n.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class A{constructor(e){n.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelCell"}static getBaseTypes(){return["AugLoop_Core_GridCell"]}static typeGuard(e){return n.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class v{constructor(e){n.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelMergedCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapper"]}static typeGuard(e){return n.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class I{constructor(e){n.h.assign(I,this,e)}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRangeAddressNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRange"]}static typeGuard(e){return n.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class w{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(w,this,e)}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class N{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelDetectedTableBoundaryPartNew"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class E{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(E,this,e)}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelDetectedTableBoundaryNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class b{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(b,this,e)}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelTableDataGridPartNew"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class k{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelComparisonAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class M{constructor(e){n.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelComparisonItem"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class L{constructor(e){n.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Excel_EcsAccessInfo"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class B{constructor(e){n.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Excel_DirtyRangeSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class D{constructor(e){n.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Excel_DirtyDocumentSignalForClp"}static getBaseTypes(){return["AugLoop_Core_DirtyDocumentSignal","AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class P{constructor(e){n.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Excel_WorkflowLimitsRestoredSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class R{constructor(e){n.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Excel_ExcelWorkflowTriggerParameters"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()}},130149:(e,t,s)=>{s.d(t,{F:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpRequestQueueEvent"},e}())},135340:function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,o)}:function(e,t,s,n){void 0===n&&(n=s),e[n]=t[s]}),o=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.SequencedValueTracker=t.completePromiseWithin=t.getOffsetAndDurationInMs=t.AudioStreamPerfTracker=void 0;var i=s(815881);Object.defineProperty(t,"AudioStreamPerfTracker",{enumerable:!0,get:function(){return i.AudioStreamPerfTracker}}),Object.defineProperty(t,"getOffsetAndDurationInMs",{enumerable:!0,get:function(){return i.getOffsetAndDurationInMs}});var a=s(228339);Object.defineProperty(t,"completePromiseWithin",{enumerable:!0,get:function(){return a.completePromiseWithin}});var r=s(895460);Object.defineProperty(t,"SequencedValueTracker",{enumerable:!0,get:function(){return r.SequencedValueTracker}}),o(s(360678),t)},143033:(e,t,s)=>{var n,o,i,a,r,c;s.d(t,{fq:()=>n,mO:()=>i}),function(e){e[e.Success=0]="Success",e[e.BadRequest=1]="BadRequest",e[e.Unauthorized=2]="Unauthorized",e[e.ResourcesNotFound=3]="ResourcesNotFound",e[e.Forbidden=4]="Forbidden",e[e.Timeout=5]="Timeout",e[e.InternalServerError=6]="InternalServerError",e[e.ServiceUnavailable=7]="ServiceUnavailable",e[e.Unknown=8]="Unknown",e[e.ErrorInExecution=9]="ErrorInExecution",e[e.OutOfCredits=10]="OutOfCredits",e[e.BypassDeduction=11]="BypassDeduction",e[e.Overloaded=12]="Overloaded",e[e.AgentBillingNotAvailable=13]="AgentBillingNotAvailable",e[e.OutOfLimits=14]="OutOfLimits"}(n||(n={})),function(e){e[e.SubstrateMetering=1]="SubstrateMetering",e[e.SubstrateCredit=2]="SubstrateCredit"}(o||(o={})),function(e){e.Credits="Credits",e.FileReference="FileReference",e.VoiceRealTime="VoiceRealTime",e.VisionRealTime="VisionRealTime",e.DeepResearch="DeepResearch",e.CuaCapability="CuaCapability",e.ImagesCapability="ImagesCapability",e.PodcastsRealTime="PodcastsRealTime"}(i||(i={})),function(e){e.NotApplicable="N/A",e.Hourly_1="Hourly-1",e.Daily="Daily",e.Weekly="Weekly",e.Monthly="Monthly"}(a||(a={})),function(e){e.Unmetered="Unmetered",e.LimitEnabled="LimitEnabled",e.LimitUpgrade="LimitUpgrade",e.PayAsYouGo="PayAsYouGo"}(r||(r={})),function(e){e.None="None",e.Limit="Limit",e.Billing="Billing",e.Utilization="Utilization"}(c||(c={}))},145097:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadWasmWebFromModularizeFunction=void 0;const n=s(901039),o=new Set,i=new Map,a="function"==typeof globalThis.importScripts;function r(e,t){e.src=t}function c(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function l(e,t,s,o,i){if(!o)return!1;const a=i||c;return!!a()[e+"Module"]&&(t.resultDescription="Module Loaded From Cache",n.Log.info(538576341,n.LogCategory.WorkflowDefault,t.stop()),s(a()[e+"Module"]),!0)}t.loadWasmWebFromModularizeFunction=async function(e,t,s,u,p,g,h){const d=new n.Operation({operationName:"LoadWasmWebFromModularizeFunction",success:!0,resourceId:s,resultDescription:""}).start();return new Promise(((m,y)=>{if(l(t,d,m,u,g))return;const T=()=>{if(l(t,d,m,u,g))return;if(!self[t])return d.success=!1,d.resultDescription="ModularizeFunction Missing",n.Log.info(538576343,n.LogCategory.WorkflowDefault,d.stop()),void y(new Error("ModularizeFunction Missing"));const e={};void 0!==p&&(e.locateFile=p),e.onAbort=function(e){const t=new n.Operation({operationName:"WasmCrashHappenedOnAbortCalled",resourceId:s}).start();"string"==typeof e&&(t.resultDescription=e),n.Log.error(509154189,n.LogCategory.WorkflowDefault,t.stop())},self[t](e).then((e=>{!function(e,t,s,o,r,u){var p;if(l(e,t,s,o,u))return;a&&(globalThis.top=self);const g=u||c;o&&(g()[e+"Module"]=r,null===(p=i.get(e))||void 0===p||p.forEach((t=>{t.onSuccess(g()[e+"Module"])})),i.set(e,[])),t.dimension0=o.toString(),n.Log.info(512237901,n.LogCategory.WorkflowDefault,t.stop()),s(r)}(t,d,m,u,e,g)})).catch((e=>{var s,o;d.success=!1,d.resultDescription="ModularizeFunction Failed: "+(null!==(s=e.message)&&void 0!==s?s:"Unknown Error Message"),n.Log.info(512237900,n.LogCategory.WorkflowDefault,d.stop()),null===(o=i.get(t))||void 0===o||o.forEach((t=>{t.onError(e)})),i.set(t,[]),y(e)}))},f=e=>{var s;d.success=!1,d.resultDescription="ScriptLoad Failed: "+("string"==typeof e?e:"Unknown Error Message"),n.Log.info(538706265,n.LogCategory.WorkflowDefault,d.stop()),null===(s=i.get(t))||void 0===s||s.forEach((t=>{t.onError(e)})),i.set(t,[]),y(e)};if(u&&o.has(t)){if(l(t,d,m,u,g))return;let e=i.get(t);void 0===e&&(e=[],i.set(t,e)),e.push({onSuccess:e=>m(e),onError:e=>y(e)})}else!function(e,t,s,n){if(a)try{globalThis.importScripts(e),t()}catch(e){s(e)}else{const o=document.createElement("script");(n||r)(o,e),o.onload=function(){t(),o.remove()},o.onerror=function(e){s(e),o.remove()},document.body.appendChild(o)}}(e,T,f,h);u&&o.add(t)}))}},150104:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LoggingAggregator=void 0;const s="n~",n=/\|\~/g;class o{constructor(){this.count=0,this.measureSums=new Map}}t.LoggingAggregator=class{constructor(e,t,i,a,r){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const i=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])i.push(null);else{let o="";"boolean"==typeof e[t]?o="b~":"number"==typeof e[t]&&(o=s),i.push(`${o}${e[t].toString().replace(n,"_")}`)}const a=i.join("|");let r=this.buckets.get(a);if(!r){r=new o,r.traceLevel=e.traceLevel;for(const e of this.avgMeasures)r.measureSums.set(e,0);this.buckets.set(a,r)}r.count++;for(const t of this.avgMeasures)e[t]&&r.measureSums.set(t,r.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const n={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},o=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],i=o[e];0===i.indexOf("b~")?n[t]="b~true"===i:0===i.indexOf(s)?n[t]=parseInt(i.slice(2),10):n[t]=i}for(const t of this.avgMeasures)n[t]=Math.round(e.measureSums.get(t)/e.count);this.log(n,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=i,this.avgMeasures=a,r>0&&(this.interval=setInterval(this.flush,1e3*r))}}},151973:(e,t,s)=>{s.d(t,{BN:()=>o,T9:()=>r});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_CopilotPluginConfigAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_GetPluginConfigOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_GetPluginDefinitionOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_GetBotResultOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_ReadFreFlagOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_WriteFreFlagOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotPluginConfigBrokering_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},165493:(e,t,s)=>{s.d(t,{Yn:()=>a,jR:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotOdslAnnotation"}static getBaseTypes(){return["AugLoop_CopilotOdsl_CopilotOdslAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotOdslImageAnnotation"}static getBaseTypes(){return["AugLoop_CopilotOdsl_CopilotOdslImageAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelCopilot_ExcelHandoffInboundMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffInternalMessage","AugLoop_HandoffSkill_HandoffPropertiesSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},167850:(e,t,s)=>{s.d(t,{I3:()=>l,SB:()=>y,W1:()=>d,hD:()=>m,yo:()=>c});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){n.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){n.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return n.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},178058:(e,t,s)=>{s.d(t,{BG:()=>l,Kh:()=>r,M4:()=>p,NR:()=>u,m9:()=>c});var n=s(184175),o=s(985002),i=s(521409),a=s(691891);const r=e=>{var t,s;if(n.B_.typeGuard(e)){const s=e.ops.filter((e=>o.h.matchesTypesFor(e,["AugLoop_Core_AddOperation"])));for(const e of s)for(const s of e.items)if(s.body&&(null===(t=s.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse))return!0}else if(a.rK.typeGuard(e))return null===(s=e.content)||void 0===s?void 0:s.some((e=>{var t;return null===(t=e.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse}));return!1},c=(e,t,s)=>{var n,o,a,r;s.resultSignature=t,s.resourceId=`${null===(n=e.sourceInfo)||void 0===n?void 0:n.featureId}-${null===(o=e.sourceInfo)||void 0===o?void 0:o.entryPoint}`,s.cv=e.cv,s.setDataFields({AnnotationTypes:null===(a=e.annotationTypes)||void 0===a?void 0:a.toString(),MaxDelayMs:null===(r=e.maxDelayMs)||void 0===r?void 0:r.toString()}),i.tG.info(505455200,i.nh.CoreDefault,s.stop())},l=(e,t,s,n,a)=>{const r=(e=>{const t=e.filter((e=>o.h.matchesTypesFor(e,["AugLoop_Signals_SignalOperation"])));for(const e of t)for(const t of e.items)if(t.body&&o.h.matchesTypesFor(t.body,["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Copilot_CopilotInputSignal"]))return t})(e);r&&(a.setDataField("CurrentTimestamp",s),a.cv=t||"",a.resultSignature=n,a.resourceId=o.h.getTypeNameFor(r.body),r.contextId&&a.setDataField("ContextId",r.contextId),r.sourceTimestamp&&a.setDataField("SourceTimestamp",r.sourceTimestamp),i.tG.info(505983429,i.nh.CoreDefault,a.stop()))},u=(e,t,s,n)=>{l(e.ops,e.cv,t,s,n)},p=(e,t,s,n,o)=>{n&&!r(e)||(o.setDataField("CurrentTimestamp",t),o.cv=e.cv,o.resultSignature=s,o.resourceId=e.annotationType,o.dimension1=`AreApologies: ${e.areApologies}`,i.tG.info(505983428,i.nh.CoreDefault,o.stop()))}},183742:(e,t,s)=>{s.d(t,{Dd:()=>i,bV:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataSourcesMetadataAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataSourcesRelevancyAnnotation"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataSourcesMetadataAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelStartRelevantMetadataAnnotation"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataSourcesRelevancyAnnotation","AugLoop_ExcelImportData_ExcelImportDataSourcesMetadataAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},184175:(e,t,s)=>{s.d(t,{$j:()=>w,B_:()=>R,D0:()=>x,F_:()=>g,GA:()=>N,Gs:()=>U,LQ:()=>y,Ol:()=>b,PR:()=>G,PY:()=>I,Qq:()=>E,Sy:()=>te,TV:()=>W,Tb:()=>L,VR:()=>B,YK:()=>i,Yp:()=>r,Zy:()=>f,_p:()=>p,eE:()=>d,eG:()=>Y,fZ:()=>D,fr:()=>q,g$:()=>X,gy:()=>J,i:()=>a,iT:()=>ie,kd:()=>O,l0:()=>M,lj:()=>Z,n4:()=>v,pr:()=>_,ru:()=>h,ry:()=>T,uN:()=>m,vG:()=>Q,w9:()=>C,wU:()=>ee,z_:()=>S});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionError"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsClientError"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsErrorInfo"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){n.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){n.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){n.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(e){return n.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){n.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){n.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class A{constructor(e){n.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class v{constructor(e){n.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class I{constructor(e){n.h.assign(I,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class w{constructor(e){n.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class N{constructor(e){n.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class E{constructor(e){n.h.assign(E,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class b{constructor(e){n.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class k{constructor(e){n.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class M{constructor(e){n.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class L{constructor(e){n.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class B{constructor(e){n.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class D{constructor(e){n.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class P{constructor(e){n.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class R{constructor(e){n.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class O{constructor(e){n.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class x{constructor(e){n.h.assign(x,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenFailureMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class F{constructor(e){n.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class G{constructor(e){n.h.assign(G,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class W{constructor(e){n.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class H{constructor(e){n.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class U{constructor(e){n.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class q{constructor(e){n.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SeedingStatusChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class V{constructor(e){n.h.assign(V,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class ${constructor(e){n.h.assign($,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[$.getTypeName()])}}$.H_={T_:$.getTypeName(),B_:$.getBaseTypes()};class j{constructor(e){n.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class z{constructor(e){n.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class K{constructor(e){n.h.assign(K,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class Q{constructor(e){n.h.assign(Q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class J{constructor(e){n.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class Y{constructor(e){n.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class Z{constructor(e){n.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class X{constructor(e){n.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class ee{constructor(e){n.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{constructor(e){n.h.assign(te,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ClaimsChallengeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class se{constructor(e){n.h.assign(se,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BlobUploadResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()};class ne{constructor(e){n.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()};class oe{constructor(e){n.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class ie{constructor(e){n.h.assign(ie,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionCorrelatedClientResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[ie.getTypeName()])}}ie.H_={T_:ie.getTypeName(),B_:ie.getBaseTypes()}},186117:(e,t,s)=>{s.d(t,{Nz:()=>n,Xe:()=>o,aU:()=>a,zb:()=>r});var n,o,i=s(917853);!function(e){e[e.OWA_REACT_COMPOSE=0]="OWA_REACT_COMPOSE",e[e.OUTLOOK_WEB_OA=1]="OUTLOOK_WEB_OA",e[e.OWA_PEOPLE_NAME_PRED=2]="OWA_PEOPLE_NAME_PRED",e[e.OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE=3]="OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE",e[e.DYNAMIC_SEARCH_BOX=4]="DYNAMIC_SEARCH_BOX",e[e.WORKPLACE_SEARCH=5]="WORKPLACE_SEARCH",e[e.COPILOT=6]="COPILOT",e[e.COPILOT_POWERPOINT=7]="COPILOT_POWERPOINT",e[e.PEOPLE_FLYOUT=100]="PEOPLE_FLYOUT",e[e.BIZ_CHAT=1e4]="BIZ_CHAT"}(n||(n={})),function(e){e[e.SUBSTRATE_AAD=0]="SUBSTRATE_AAD",e[e.SUBSTRATE_MSA=1]="SUBSTRATE_MSA"}(o||(o={}));const a={emailId:"",puid:"",scenarios:[n.OWA_REACT_COMPOSE],market:"",tenantId:"",substrateAuthTokenType:o.SUBSTRATE_AAD,entityTypes:[i.ck.People,i.ck.File,i.ck.Scope],prefetchOnly:!1},r={wasmRoot:"graph-search-local"}},187437:(e,t,s)=>{var n;s.d(t,{Y:()=>n}),function(e){e[e.Connecting=0]="Connecting",e[e.Listening=1]="Listening",e[e.Thinking=2]="Thinking",e[e.Speaking=3]="Speaking",e[e.Error=4]="Error",e[e.Interrupted=5]="Interrupted",e[e.Disconnected=6]="Disconnected",e[e.Blocked=7]="Blocked",e[e.OnHold=8]="OnHold"}(n||(n={}))},191603:(e,t,s)=>{s.d(t,{G2:()=>h,IW:()=>c,Lm:()=>p,Yc:()=>y,pw:()=>u});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelServerSessionExtensionConfig"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelWorkbookUpdated"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelAccessTokenRefreshed"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelKeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelRetrieveModelRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelRetrieveModelResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelSessionDiagnosticsRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelSessionDiagnosticsResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_AdvanceMockGridState"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ExcelSessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_ObserverStatusAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_FullSeedingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Excel_Session_Protocol_WorkflowProgressAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},193486:(e,t,s)=>{s.d(t,{A:()=>h});var n=s(596374),o=s(929354),i=s(879586),a=s(521409),r=s(827774),c=s(735875),l=s(281076),u=s(61714),p=s(452367);class g{constructor(){this.seqCounter=0,this.lastInput="",this.lastConversationId="",this.lastLogicalId=""}async init(e){}initialize(e){var t,s;!0!==this.initialized&&(this.enableUserInitiatedRequests=null===(t=null==e?void 0:e.flights)||void 0===t?void 0:t.hasFlight("mc-editor-oa-client-ecc"),this.enableSystemInitiatedRequest=null===(s=null==e?void 0:e.flights)||void 0===s?void 0:s.hasFlight("mc-editor-oa-client-predictions"),this.initialized=!0)}async execute(e,t,s){this.executeInner(e,t,s),s.done()}executeInner(e,t,s){var n;if(a.tG.info(526713100,a.nh.WorkflowDefault,"Executing oa-client router workflow"),e&&e.content&&t&&s){if(this.initialize(t),c.Cg.typeGuard(e)||c.qf.typeGuard(e))if(null===(n=null==t?void 0:t.flights)||void 0===n?void 0:n.hasFlight("mc-editor-oa-client-router-refactor"))this.processTextTileInput(e.content,e,s,t);else{if(this.tryGenerateUserInitiatedRequest(e.content,e,s,t))return;this.tryGenerateSystemInitiatedRequest(e.content,e,s,t)}}else a.tG.warn(526713101,a.nh.WorkflowDefault,"unexpected inputs, ignoring request")}dispose(){this.seqCounter=0}processTextTileInput(e,t,s,i){var r,c,l,g,h,d,m;const y=(new Date).toISOString(),T=(0,p.K)("Router_UserInitiated",i).start(),f=i.delta,_=null!==(c=null===(r=null==f?void 0:f.additionalData)||void 0===r?void 0:r.conversationId)&&void 0!==c?c:"",C=null!==(g=null===(l=null==f?void 0:f.additionalData)||void 0===l?void 0:l.logicalId)&&void 0!==g?g:"",S=this.getValidUserInitQuery(t,i,T);if(S){const n=null!==(d=null===(h=null==f?void 0:f.additionalData)||void 0===h?void 0:h.scopeInfo)&&void 0!==d?d:void 0,o=void 0===n&&this.sameAsLastUserInitRequest(e,f),i=null!==(m=null==n?void 0:n.entityType)&&void 0!==m?m:"";return T.setDataFields({hasScope:void 0!==n,entityType:i,repeatedReuquest:o}),this.generateUserInitiatedRequest(e,t,s,S,C,_,n,T),void this.finalizeLogging(T,y,C,_)}if(this.enableUserInitiatedRequests){const e=new n.os({conversationId:null!=_?_:"",entityResults:[],logicalId:null!=C?C:"",status:o.i.EarlyExit});s.setAnnotations(t,n.os.getTypeName(),[e]),T.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"}),this.finalizeLogging(T,y,C,_)}else T.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),this.finalizeLogging(T,y,C,_);const A=(new Date).toISOString(),v=(0,p.K)("Router_SystemInitiated",i).start(),I=(0,u.A)();this.isValidSystemInitQuery(t,i,v)?this.generateSystemInitiatedRequest(e,t,s,I,v):this.enableSystemInitiatedRequest?v.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"}):v.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),a.tG.info(508408097,a.nh.WorkflowDefault,`sending SystemInitiatedRequestClient (${this.seqCounter})`),this.finalizeLogging(v,A,I)}finalizeLogging(e,t,s,n){const o=(new Date).toISOString();n&&e.setDataFields({conversationId:n}),e.setDataFields({startTimeStamp:t,endTimeStamp:o,logicalId:s}),a.tG.info(508356445,a.nh.WorkflowDefault,e.stop())}generateUserInitiatedRequest(e,t,s,n,o,a,r,c){if(!this.enableUserInitiatedRequests)return void c.setDataFields({statusDescription:"Request skipped because required flight is missing"});const l=new i.VP({content:this.sanitizeText(e),logicalId:o,conversationId:a,seq:++this.seqCounter,scope:r,...n});s.setAnnotations(t,i.VP.getTypeName(),[l]),c.setDataFields({statusDescription:"User-Initiated request generated"})}generateSystemInitiatedRequest(e,t,s,n,o){if(!this.enableSystemInitiatedRequest)return void o.setDataFields({statusDescription:"Request skipped because required flight is missing"});const a=new i.JM({content:this.sanitizeText(e),logicalId:n,seq:++this.seqCounter});s.setAnnotations(t,i.JM.getTypeName(),[a]),o.setDataFields({statusDescription:"System-Initiated request generated"})}tryGenerateUserInitiatedRequest(e,t,s,r){var c,l,u,g,h,d,m,y;let T=!1;const f=(new Date).toISOString(),_=(0,p.K)("Router_UserInitiated",r).start(),C=r.delta,S=null!==(l=null===(c=null==C?void 0:C.additionalData)||void 0===c?void 0:c.conversationId)&&void 0!==l?l:"",A=null!==(g=null===(u=null==C?void 0:C.additionalData)||void 0===u?void 0:u.logicalId)&&void 0!==g?g:"";if(null===(h=null==r?void 0:r.flights)||void 0===h?void 0:h.hasFlight("mc-editor-oa-client-ecc")){const a=this.getValidUserInitQuery(t,r,_);if(a){const n=null!==(m=null===(d=null==C?void 0:C.additionalData)||void 0===d?void 0:d.scopeInfo)&&void 0!==m?m:void 0,o=void 0===n&&this.sameAsLastUserInitRequest(e,C),r=null!==(y=null==n?void 0:n.entityType)&&void 0!==y?y:"";_.setDataFields({hasScope:void 0!==n,entityType:r,repeatedReuquest:o});const c=new i.VP({content:this.sanitizeText(e),logicalId:A,conversationId:S,seq:++this.seqCounter,scope:n,...a});s.setAnnotations(t,i.VP.getTypeName(),[c]),_.setDataFields({statusDescription:"User-Initiated request generated"}),T=!0}else{const e=new n.os({conversationId:null!=S?S:"",entityResults:[],logicalId:null!=A?A:"",status:o.i.EarlyExit});s.setAnnotations(t,n.os.getTypeName(),[e]),_.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"})}}else _.setDataFields({statusDescription:"Request skipped because required flight is missing"});const v=(new Date).toISOString();return _.setDataFields({startTimeStamp:f,endTimeStamp:v,conversationId:S,logicalId:A}),a.tG.info(508409808,a.nh.WorkflowDefault,_.stop()),T}tryGenerateSystemInitiatedRequest(e,t,s,n){var o;const r=(new Date).toISOString(),c=(0,p.K)("Router_SystemInitiated",n).start(),l=(0,u.A)();if(null===(o=null==n?void 0:n.flights)||void 0===o?void 0:o.hasFlight("mc-editor-oa-client-predictions")){if(this.isValidSystemInitQuery(t,n,c)){const n=new i.JM({content:this.sanitizeText(e),logicalId:l,seq:++this.seqCounter});s.setAnnotations(t,i.JM.getTypeName(),[n]),c.setDataFields({statusDescription:"System-Initiated request generated"})}else c.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"});a.tG.info(508409807,a.nh.WorkflowDefault,`sending SystemInitiatedRequestClient(${this.seqCounter})`)}else c.setDataFields({statusDescription:"Request skipped because required flight is missing"});const g=(new Date).toISOString();c.setDataFields({startTimeStamp:r,endTimeStamp:g,logicalId:l}),a.tG.info(508409806,a.nh.WorkflowDefault,c.stop())}sanitizeText(e,t){if("number"!=typeof(null==e?void 0:e.length))return"";"\n"===e[e.length-1]&&(e=e.substring(0,e.length-1));const s=e.replace(/\s/g," ");return t?s.trim():s}sameAsLastUserInitRequest(e,t){var s,n,o,i;const a=null!==(n=null===(s=null==t?void 0:t.additionalData)||void 0===s?void 0:s.conversationId)&&void 0!==n?n:"",r=null!==(i=null===(o=null==t?void 0:t.additionalData)||void 0===o?void 0:o.logicalId)&&void 0!==i?i:"";let c=!1;return e===this.lastInput&&a===this.lastConversationId&&r===this.lastLogicalId&&(c=!0),this.lastInput=e,this.lastConversationId=a,this.lastLogicalId=r,c}getValidUserInitQuery(e,t,s){var n,o;if(!c.Cg.typeGuard(e))return void s.setDataFields({statusDescription:"Invalid input type"});const i=e;if((null===(n=t.delta)||void 0===n?void 0:n.unit)!==l.OD.Chars&&this.sanitizeText(i.content,!0).length<1)return void s.setDataFields({statusDescription:"Ignore empty tile"});const a=t.delta;if(a&&(a.unit!==l.OD.Sentence||a.queryRange&&a.content)){const t=e.content;let n;const i=a.queryRange;if(i){const{length:e,start:s}=i,a=null!==(o=i.prefix)&&void 0!==o?o:g.userInitiatedIntentChar;n={query:this.sanitizeText(t.substring(s+a.length,s+e)),queryChar:a,queryCharIndex:s}}else s.setDataFields({statusDescription:"Invalid or non-existent queryRange provided."});if(n){const e={start:n.queryCharIndex,end:n.queryCharIndex+n.query.length+1};return(a.position>=e.start||a.position+a.content.length>=e.start)&&a.position<=e.end?(s.setDataFields({seqCounter:this.seqCounter,querylength:i.length}),n):void s.setDataFields({statusDescription:"Delta outside of query bounds"})}s.setDataFields({statusDescription:"Invalid query to generate user init request."})}else s.setDataFields({statusDescription:"Delta is undefined. Cannot proceed with query detection logic."})}isValidSystemInitQuery(e,t,s){var n;if(!c.Cg.typeGuard(e))return s.setDataFields({statusDescription:"Invalid input type, ignore"}),!1;const o=e.content,i=this.sanitizeText(o,!0),a=t.delta;if(!a)return s.setDataFields({statusDescription:"Delta is undefined."}),!1;{if(a.unit===l.OD.Sentence||a.unit===l.OD.Paragraph)return!1;if(a.unit!==l.OD.Chars&&i.length<1)return s.setDataFields({statusDescription:"Empty tile, ignore"}),!1;const e=o.endsWith("\n")?o.substring(0,o.length-1):o;if((null===(n=null==t?void 0:t.flights)||void 0===n?void 0:n.hasFlight("mc-editor-oa-client-router-refactor"))&&a.position>=e.length-1)return!0;if(a.position>=e.length-1&&g.triggerCharacters.has(i[i.length-1]))return s.setDataFields({statusDescription:"Router should not generate system initiated requests for ECC requests"}),!1}return!0}}g.userInitiatedIntentChar="@",g.triggerCharacters=new Set(["@","/"]);const h=r.z.create("oaClientRouter").setInputTypes([c.qf.getTypeName()]).setOutputTypes([n.os.getTypeName(),i.JM.getTypeName(),i.VP.getTypeName()]).setLambdaType((()=>new g))},193536:(e,t,s)=>{var n;s.d(t,{T:()=>n}),function(e){e.CommentSummarization="CommentSummarization",e.SuggestedQuestions="SuggestedQuestions",e.DocumentSummaryDynamicLength="DocumentSummaryDynamicLength",e.DocumentSummaryGlance="DocumentSummaryGlance",e.DocumentSummaryKeyPoints="DocumentSummaryKeyPoints",e.DocumentSummaryDetailed="DocumentSummaryDetailed",e.DocumentSummaryDynamicLengthNoCitations="DocumentSummaryDynamicLengthNoCitations",e.DocumentSummaryGlanceNoCitations="DocumentSummaryGlanceNoCitations",e.DocumentSummaryKeyPointsNoCitations="DocumentSummaryKeyPointsNoCitations",e.DocumentSummaryDetailedNoCitations="DocumentSummaryDetailedNoCitations",e.DocumentSummaryCachePreload="DocumentSummaryCachePreload",e.ProactiveDocumentSummaryDynamicLength="ProactiveDocumentSummaryDynamicLength",e.ProactiveDocumentSummaryGlance="ProactiveDocumentSummaryGlance",e.ProactiveDocumentSummaryKeyPoints="ProactiveDocumentSummaryKeyPoints",e.ProactiveDocumentSummaryDetailed="ProactiveDocumentSummaryDetailed",e.ProactiveCollapsedDocumentSummaryDynamicLength="ProactiveCollapsedDocumentSummaryDynamicLength",e.ProactiveCollapsedDocumentSummaryGlance="ProactiveCollapsedDocumentSummaryGlance",e.ProactiveCollapsedDocumentSummaryKeyPoints="ProactiveCollapsedDocumentSummaryKeyPoints",e.ProactiveCollapsedDocumentSummaryDetailed="ProactiveCollapsedDocumentSummaryDetailed",e.ShareNative="ShareNative",e.KeyStats="KeyStats",e.DocumentInsights="DocumentInsights",e.DocumentRelevance="DocumentRelevance",e.CollabCatchup="CollabCatchup",e.CollabCatchupThreeDays="CollabCatchupThreeDays",e.CollabCatchupOneWeek="CollabCatchupOneWeek",e.CollabCatchupTwoWeeks="CollabCatchupTwoWeeks",e.CollabCatchupLastSeenTime="CollabCatchupLastSeenTime",e.PersonalizedSummary="PersonalizedSummary",e.SydneyDocumentRelevance="SydneyDocumentRelevance",e.SydneyDocumentInsights="SydneyDocumentInsights",e.SydneyDocumentSummaryByDeclarativeAgent="SydneyDocumentSummaryByDeclarativeAgent",e.ComprehensionPlayground="ComprehensionPlayground",e.SummarizationGrounding="SummarizationGrounding",e.RelatedFiles="RelatedFiles",e.DocumentCommentator="DocumentCommentator",e.TestingAgent="TestingAgent",e.FileSearchTool="FileSearchTool",e.FileDownloadTool="FileDownloadTool",e.ChatCompletionsTestingAgent="ChatCompletionsTestingAgent",e.RecentFilesTool="RecentFilesTool",e.DocumentReplace="DocumentReplace",e.DocumentSummaryServiceCall="DocumentSummaryServiceCall",e.MessageSearchTool="MessageSearchTool",e.PromptSuggestion="PromptSuggestion",e.GetCoaching="GetCoaching",e.DeepKnowledgeSynthesis="DeepKnowledgeSynthesis"}(n||(n={}))},197345:(e,t,s)=>{s.d(t,{Uk:()=>i,sN:()=>a});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataFileMetadataSignal"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelImportDataSourcesRelevancySignal"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelImportData_ExcelStartRelevantMetadataSignal"}static getBaseTypes(){return["AugLoop_ExcelImportData_ExcelImportDataBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},199128:(e,t,s)=>{s.d(t,{N0:()=>o,NC:()=>p,Xv:()=>i,Z8:()=>l,aD:()=>u,f4:()=>g,hl:()=>r,iU:()=>c,ub:()=>a});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentSuggestion"}static getBaseTypes(){return["AugLoop_SmartCompose_Suggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentPrefilterTriggered"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntent"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentHybrid"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_Prefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_FlagWithIntent"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_EntityPrediction"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()}},211475:(e,t,s)=>{var n,o,i,a,r,c,l,u,p,g,h,d,m,y,T,f,_,C,S,A,v,I,w,N,E,b,k,M,L,B,D,P;s.d(t,{YA:()=>o,f$:()=>a,gL:()=>m,h2:()=>x,n3:()=>P}),function(e){e[e.Read=0]="Read",e[e.ReadMetadata=1]="ReadMetadata",e[e.Create=2]="Create"}(n||(n={})),function(e){e.PowerPoint="PowerPoint",e.Excel="Excel",e.Word="Word",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.TeamsMeeting="TeamsMeeting",e.TeamsQueues="TeamsQueues",e.SharePoint="SharePoint",e.Web="Web",e.PDF="PDF",e.Zip="Zip",e.HTML="HTML",e.Visio="Visio",e.Image="Image",e.Fluid="Fluid",e.Video="Video",e.Vector="Vector",e.Txt="Txt",e.ThirdParty="ThirdParty",e.Topic="Topic",e.Loop="Loop",e.Planner="Planner"}(o||(o={})),function(e){e[e.ChatResponse=0]="ChatResponse",e[e.GetMessagesResponse=1]="GetMessagesResponse",e[e.GetConversationResponse=2]="GetConversationResponse",e[e.GetSharedMessagesResponse=3]="GetSharedMessagesResponse",e[e.CopyConversationResponse=4]="CopyConversationResponse",e[e.SerpCachedResponse=5]="SerpCachedResponse",e[e.CaptchaResponse=6]="CaptchaResponse"}(i||(i={})),function(e){e.Default="Default",e.Early="Early",e.OnUse="OnUse",e.Never="Never"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(r||(r={})),function(e){e.Quiet="0",e.Verbose="1"}(c||(c={})),function(e){e.TurnBased="turnbased",e.Realtime="realtime",e.All="all"}(l||(l={})),function(e){e.Full="Full",e.Concise="Concise",e.ConciseWithPadding="ConciseWithPadding"}(u||(u={})),function(e){e.Text="text",e.Video="video",e.Voice="voice"}(p||(p={})),function(e){e.Unknown="Unknown",e.TeamsToolKit="TeamsToolKit",e.CopilotStudioFamily="CopilotStudioFamily",e.SharePoint="SharePoint",e.CopilotStudio="CopilotStudio",e.EmbeddedCopilotStudio="EmbeddedCopilotStudio",e.Notebook="Notebook"}(g||(g={})),function(e){e.WordDraftingAgent="WordDraftingAgent"}(h||(h={})),function(e){e.SharePoint="SharePoint",e.OneDrive="OneDrive",e.OneDriveAndSharePoint="OneDriveAndSharePoint",e.DeepResearch="DeepResearch",e.DeepResearchWork="DeepResearchWork",e.RegisteredPlugins="RegisteredPlugins",e.FirstPartyAgent="FirstPartyAgent",e.WebSearch="WebSearch",e.EnterpriseGrounding="EnterpriseGrounding"}(d||(d={})),function(e){e.Unknown="Unknown",e.Success="Success",e.InternalError="InternalError",e.InvalidSession="InvalidSession",e.ConfigurationError="ConfigurationError",e.InvalidRequest="InvalidRequest",e.ProcessingMessage="ProcessingMessage",e.UnauthorizedRequest="UnauthorizedRequest",e.UnexpectedError="UnexpectedError",e.Canceled="Canceled",e.CaptchaChallenge="CaptchaChallenge",e.Throttled="Throttled",e.NotFound="NotFound",e.NoResponseReturned="NoResponseReturned",e.ThrottledByLLM="ThrottledByLLM",e.NoResponseText="NoResponseText",e.ApologyResponseReturned="ApologyResponseReturned",e.NoValidMessageTypePresentInBotResponse="NoValidMessageTypePresentInBotResponse",e.ServiceNotEnabled="ServiceNotEnabled",e.ContentForbidden="ContentForbidden",e.ContentNotFound="ContentNotFound",e.InvalidLicense="InvalidLicense",e.NotEnoughContext="NotEnoughContext",e.OutOfCredits="OutOfCredits",e.VoiceSystemSignal="VoiceSystemSignal"}(m||(m={})),function(e){e.Success="Success",e.Failure="Failure",e.Pending="Pending",e.BotTurnStarting="BotTurnStarting"}(y||(y={})),function(e){e.Audio="audio",e.Text="text"}(T||(T={})),function(e){e.SearchWeb="SearchWeb",e.EnterpriseFileSearch="EnterpriseFileSearch",e.CodeInterpreter="CodeInterpreter"}(f||(f={})),function(e){e.Error="Error",e.Warning="Warning"}(_||(_={})),function(e){e[e.None=0]="None",e[e.MessagesDeleted=1]="MessagesDeleted"}(C||(C={})),function(e){e.MissingName="MissingName",e.TooLongName="TooLongName",e.InvalidCharacterInName="InvalidCharacterInName",e.MissingDescription="MissingDescription",e.TooLongDescription="TooLongDescription",e.InvalidCharacterInDescription="InvalidCharacterInDescription",e.MissingInstructions="MissingInstructions",e.TooLongInstructions="TooLongInstructions",e.InvalidCharacterInInstructions="InvalidCharacterInInstructions",e.InvalidIconUrl="InvalidIconUrl",e.InvalidGptId="InvalidGptId",e.TooManyConversationStarters="TooManyConversationStarters",e.InvalidCharacterInConversationStarter="InvalidCharacterInConversationStarter",e.InvalidConversationStarterImageUrl="InvalidConversationStarterImageUrl",e.TooLongConversationStarter="TooLongConversationStarter",e.MissingPluginShortName="MissingPluginShortName",e.TooLongShortName="TooLongShortName",e.InvalidCharacterInShortName="InvalidCharacterInShortName",e.MissingPluginLongName="MissingPluginLongName",e.TooLongLongName="TooLongLongName",e.InvalidCharacterInLongName="InvalidCharacterInLongName",e.MissingPluginShortDescription="MissingPluginShortDescription",e.TooLongShortDescription="TooLongShortDescription",e.InvalidCharacterInShortDescription="InvalidCharacterInShortDescription",e.MissingPluginFullDescription="MissingPluginFullDescription",e.TooLongFullDescription="TooLongFullDescription",e.InvalidCharacterInFullDescription="InvalidCharacterInFullDescription",e.MissingPluginFunction="MissingPluginFunction",e.MissingFunctionId="MissingFunctionId",e.TooLongFunctionId="TooLongFunctionId",e.InvalidCharacterInFunctionId="InvalidCharacterInFunctionId",e.MissingFunctionTitle="MissingFunctionTitle",e.TooLongFunctionTitle="TooLongFunctionTitle",e.InvalidCharacterInFunctionTitle="InvalidCharacterInFunctionTitle",e.MissingFunctionDescription="MissingFunctionDescription",e.TooLongFunctionDescription="TooLongFunctionDescription",e.InvalidCharacterInFunctionDescription="InvalidCharacterInFunctionDescription",e.MissingParameterName="MissingParameterName",e.TooLongParameterName="TooLongParameterName",e.InvalidCharacterInParameterName="InvalidCharacterInParameterName",e.MissingParameterDescription="MissingParameterDescription",e.TooLongParameterDescription="TooLongParameterDescription",e.InvalidCharacterInParameterDescription="InvalidCharacterInParameterDescription",e.MissingParameterTitle="MissingParameterTitle",e.TooLongParameterTitle="TooLongParameterTitle",e.InvalidCharacterInParameterTitle="InvalidCharacterInParameterTitle",e.InvalidTeamsMessagesCapabilityUrl="InvalidTeamsMessagesCapabilityUrl",e.OffensiveContent="OffensiveContent",e.Jailbreak="Jailbreak",e.RAIViolation="RAIViolation"}(S||(S={})),function(e){e.None="None",e.Limit="Limit",e.Billing="Billing"}(A||(A={})),function(e){e.ActionMETaskModule="ActionMETaskModule",e.AuthenticationCard="AuthenticationCard",e.CodeInterpreter="CodeInterpreter",e.ConfirmationCard="ConfirmationCard",e.GraphicArt="GraphicArt",e.MultiMessageResponse="MultiMessageResponse"}(v||(v={})),function(e){e.User="User",e.Tenant="Tenant",e.System="System"}(I||(I={})),function(e){e.Unknown="Unknown",e.User="User",e.Tenant="Tenant",e.System="System"}(w||(w={})),function(e){e.Active="Active",e.Draft="Draft",e.Deleted="Deleted",e.Blocked="Blocked"}(N||(N={})),function(e){e.Bot="bot",e.User="user",e.System="system"}(E||(E={})),function(e){e.AnnRules="AnnRules",e.Apology="Apology",e.BingContent="Bing Content",e.Chitchat="Chitchat",e.NluDirectResponse="NluDirectResponse",e.Qna="Qna",e.TopicChanger="TopicChanger",e.Delighterdluni="Delighterdluni",e.DeepLeo="DeepLeo",e.TransformContent="transform_content",e.LocalPluginRunner="local-plugin-runner",e.ImageChat="image-chat",e.GenerateResponse="generate_response"}(b||(b={})),function(e){e.Image="IMAGE"}(k||(k={})),function(e){e.WebPage="WebPage",e.ClientApp="ClientApp"}(M||(M={})),function(e){e.None="None",e.Positive="Positive",e.Negative="Negative",e.Laugh="Laugh",e.Surprised="Surprised",e.UnknownBf="UnknownBf"}(L||(L={})),function(e){e.Keyboard="Keyboard",e.Speech="Speech"}(B||(B={})),function(e){e.AudioUrl="AudioUrl",e.None="None",e.Simple="Simple",e.Ssml="Ssml"}(D||(D={})),function(e){e.ActionRequest="ActionRequest",e.Ads="Ads",e.AdsQuery="AdsQuery",e.Any="Any",e.AuthError="AuthError",e.ChatCompleted="ChatCompleted",e.CaptchaChallenge="CaptchaChallenge",e.Chat="Chat",e.ChatName="ChatName",e.ConfirmationCard="ConfirmationCard",e.Context="Context",e.Disengaged="Disengaged",e.SearchQuery="SearchQuery",e.Internal="Internal",e.InvokeAction="InvokeAction",e.Suggestion="Suggestion",e.InternalSuggestions="InternalSuggestions",e.InternalSearchResult="InternalSearchResult",e.InternalSearchQuery="InternalSearchQuery",e.InternalReasoningSearchResult="InternalReasoningSearchResult",e.InternalActionMarker="InternalActionMarker",e.InternalStateMarker="InternalStateMarker",e.InternalLoaderMessage="InternalLoaderMessage",e.Progress="Progress",e.GenerateContentQuery="GenerateContentQuery",e.GeneratedCode="GeneratedCode",e.RenderCardRequest="RenderCardRequest",e.RequireHumanInTheLoop="RequireHumanInTheLoop",e.SemanticSerp="SemanticSerp",e.ResumePluginAuth="ResumePluginAuth",e.TriggerPluginAuth="TriggerPluginAuth",e.ResumeInvokeAction="ResumeInvokeAction",e.TriggerConfirmation="TriggerConfirmation",e.InternalContentDescription="InternalContentDescription",e.TriggerPlugin="TriggerPlugin",e.CompletePlugin="CompletePlugin",e.AttachmentAction="AttachmentAction"}(P||(P={}));new Set([P.Chat,P.ChatCompleted,P.Disengaged,P.RenderCardRequest,P.RequireHumanInTheLoop]);var R,O,x,F,G,W,H,U,q,V,$,j,z,K;!function(e){e.IncomingBotResponse=void 0}(P||(P={})),function(e){e.Blank="BLANK",e.BingFrontPageSkill="BING_FRONT_PAGE_SKILL",e.BingSkill="BING_SKILL",e.Chitchat="CHITCHAT",e.Infoseeking="INFOSEEKING",e.InitialBingFrontPageSkill="INITIAL_BING_FRONT_PAGE_SKILL",e.InitialQNA="INITIAL_QNA",e.InitialVideos="INITIAL_VIDEOS",e.InitialWebpages="INITIAL_WEBPAGES",e.MedicalHealth="MEDICAL_HEALTH",e.MicrosoftBrands="MICROSOFT_BRANDS",e.NeedEmpathy="NEED_EMPATHY",e.Offensive="OFFENSIVE",e.OpinionGiving="OPINION_GIVING",e.OpinionSeeking="OPINION_SEEKING",e.OUTOFDomain="OUT_OF_DOMAIN",e.QNA="QNA",e.SettingsChange="SETTINGS_CHANGE",e.SettingsCheck="SETTINGS_CHECK",e.SuicideHelp="SUICIDE_HELP",e.TuringBOTSafe="TURING_BOT_SAFE",e.Unhandled="UNHANDLED",e.Videos="VIDEOS",e.Webpages="WEBPAGES"}(R||(R={})),function(e){e.Amount="AMOUNT",e.Setting="SETTING",e.Type="TYPE",e.Unknown="UNKNOWN",e.Unit="UNIT",e.Value="VALUE"}(O||(O={})),function(e){e.Unknown="Unknown",e.None="None",e.Offensive="Offensive",e.OffenseTrigger="OffenseTrigger",e.OffenseResponse="OffenseResponse",e.Blocklist="Blocklist"}(x||(x={})),function(e){e.Finished="FINISHED",e.Intermediate="INTERMEDIATE",e.FinishedAwaitingCommit="FINISHED_AWAITING_COMMIT"}(F||(F={})),function(e){e.General="General",e.Internal="Internal"}(G||(G={})),function(e){e.Testing="Testing",e.AdminCenterCopilot="AdminCenterCopilot",e.AIHubAppChatCopilot="AIHubAppChatCopilot",e.AIHubBrowseCopilot="AIHubBrowseCopilot",e.AIHubHome="AIHubHome",e.Assist365Copilot="Assist365Copilot",e.BizChatScheduledActions_MacOutlookHub="BizChatScheduledActions_MacOutlookHub",e.BizChatScheduledActions_MonarchHub="BizChatScheduledActions_MonarchHub",e.BizChatScheduledActions_OfficeDesktop="BizChatScheduledActions_OfficeDesktop",e.BizChatScheduledActions_OfficeWeb="BizChatScheduledActions_OfficeWeb",e.BizChatScheduledActions_OwaHub="BizChatScheduledActions_OwaHub",e.BizChatScheduledActions_TeamsHub="BizChatScheduledActions_TeamsHub",e.BizChatScheduledActions_Win32OutlookHub="BizChatScheduledActions_Win32OutlookHub",e.CopilotClips="CopilotClips",e.ExcelCopilot="ExcelCopilot",e.ExcelCopilotConsumer="ExcelCopilotConsumer",e.ExcelCopilotConsumerOSv2="ExcelCopilotConsumerOSv2",e.ExchangeAdminCenterCopilot="ExchangeAdminCenterCopilot",e.FormsCopilot="FormsCopilot",e.LoopCopilot="LoopCopilot",e.LoopCopilotOnCanvas="LoopCopilotOnCanvas",e.ODSPCopilot="ODSPCopilot",e.OfficeAiAppIncubation="OfficeAiAppIncubation",e.OfficeCopilotSearchAnswer="OfficeCopilotSearchAnswer",e.OfficePersonalAgentsCopilot="OfficePersonalAgentsCopilot",e.OneNoteCopilot="OneNoteCopilot",e.OneNoteCopilotConsumer="OneNoteCopilotConsumer",e.OneNoteCopilotConsumerOSv2="OneNoteCopilotConsumerOSv2",e.OperaWordCopilot="OperaWordCopilot",e.OutlookCopilot="OutlookCopilot",e.OutlookCopilotBizchatBase="OutlookCopilotBizchatBase",e.OutlookCopilotConsumerOSv2="OutlookCopilotConsumerOSv2",e.OutlookSearchChatCopilot="outlooksearchchatcopilot",e.PodcastCopilot="PodcastCopilot",e.PPTCopilot="PPTCopilot",e.PPTCopilotConsumer="PPTCopilotConsumer",e.PPTCopilotConsumerOSv2="PPTCopilotConsumerOSv2",e.PPTOnCanvasCopilot="PPTOnCanvasCopilot",e.PlannerCopilot="PlannerCopilot",e.SharePointAdminCenterCopilot="SharePointAdminCenterCopilot",e.SharepointAuthoringCopilot="SharepointAuthoringCopilot",e.StreamCopilot="StreamCopilot",e.TeamsAdminCenterCopilot="TeamsAdminCenterCopilot",e.TeamsQueuesIntelligence="TeamsQueuesIntelligence",e.TeamsChatCopilot="TeamsChatCopilot",e.TeamsMessagesSerpAICopilot="TeamsMessagesSerpAICopilot",e.TeamsSerpCopilot="TeamsSerpCopilot",e.TeamsGroupCopilot="TeamsGroupCopilot",e.TeamsMeetingCopilot="teamsmeetingcp",e.TeamsMeetingGroupCopilot="TeamsMeetingGroupCopilot",e.VivaCopilot="VivaCopilot",e.VivaEngageCopilot="VivaEngageCopilot",e.VivaGoalsCopilot="VivaGoalsCopilot",e.WhiteboardCopilotOnCanvas="WhiteboardCopilotOnCanvas",e.WordCopilot="WordCopilot",e.WordBackstageCopilot="WordBackstageCopilot",e.WordCopilotConsumer="WordCopilotConsumer",e.WordCopilotConsumerOsv2="WordCopilotConsumerOSv2",e.WordOnCanvasCopilot="WordOnCanvasCopilot",e.LegacyDefault="Default",e.RealtimeChat="AugmentationLoopRealTimeChat",e.AIHubCreateCopilot="AIHubCreateCopilot"}(W||(W={}));!function(e){e.Creative="Creative",e.Balanced="Balanced",e.Precise="Precise"}(H||(H={})),function(e){e.AppChat="appchat"}(U||(U={})),function(e){e.Default="Default",e.Reasoning="Reasoning",e.Responding="Responding"}(q||(q={})),function(e){e.AdaptiveCard="AdaptiveCard"}(V||(V={})),function(e){e[e.InternalError=-32603]="InternalError",e[e.InvalidParams=-32602]="InvalidParams",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.InvocationError=-32e3]="InvocationError",e[e.InvocationErrorWithException=-32004]="InvocationErrorWithException",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.NoMarshaledObjectFound=-32001]="NoMarshaledObjectFound",e[e.ParseError=-32700]="ParseError",e[e.RequestCanceled=-32800]="RequestCanceled",e[e.ResponseSerializationFailure=-32003]="ResponseSerializationFailure"}($||($={})),function(e){e.SUCCESS="success",e.FAILURE="failure"}(j||(j={})),function(e){e.AlwaysOn="AlwaysOn",e.Dynamic="Dynamic"}(z||(z={})),function(e){e.Document="document",e.Workbook="workbook",e.Presentation="presentation"}(K||(K={}))},211606:(e,t,s)=>{var n,o,i,a;s.d(t,{S5:()=>o,ss:()=>i}),function(e){e.ExcelSheetReference="ExcelSheetReference",e.ExcelTableReference="ExcelTableReference",e.ExcelRangeReference="ExcelRangeReference",e.ExcelTableLikeRangeReference="ExcelTableLikeRangeReference",e.ExcelPivotTableReference="ExcelPivotTableReference",e.ExcelChartReference="ExcelChartReference"}(n||(n={})),function(e){e.Add="Add",e.Delete="Delete",e.Change="Change",e.Rename="Rename"}(o||(o={})),function(e){e.Sheet="Sheet",e.Table="Table",e.PivotTable="PivotTable",e.Range="Range",e.Chart="Chart",e.TableLikeRange="TableLikeRange"}(i||(i={})),function(e){e.RangeEdited="RangeEdited",e.RowInserted="RowInserted",e.RowDeleted="RowDeleted",e.ColumnInserted="ColumnInserted",e.ColumnDeleted="ColumnDeleted",e.CellInsertedRight="CellInsertedRight",e.CellInsertedDown="CellInsertedDown",e.CellDeletedLeft="CellDeletedLeft",e.CellDeletedUp="CellDeletedUp"}(a||(a={}))},215365:(e,t,s)=>{var n,o,i,a,r,c,l;s.d(t,{CY:()=>a,Go:()=>c,Rq:()=>l,S5:()=>o,gG:()=>i,nW:()=>r}),function(e){e.Document="Document",e.Enterprise="Enterprise"}(n||(n={})),function(e){e.GetCurrentChatOperation="GetCurrentChatOperation",e.GetAllChatsOperation="GetAllChatsOperation",e.GetChatOperation="GetChatOperation",e.AddChatOperation="AddChatOperation",e.AddMessageOperation="AddMessageOperation",e.GetMessagesOperation="GetMessagesOperation",e.GetMessagesInCurrentChatSession="GetMessagesInCurrentChatSession",e.RemoveAllMessagesFromCurrentChatOperation="RemoveAllMessagesFromCurrectChatOperation",e.DeleteChatOperation="DeleteChatOperation",e.UpdateMessageOperation="UpdateMessageOperation",e.UpdateChatOperation="UpdateChatOperation"}(o||(o={})),function(e){e.User="User",e.Copilot="Copilot",e.System="System"}(i||(i={})),function(e){e.Unknown="Unknown",e.Canvas="Canvas",e.Pane="Pane"}(a||(a={})),function(e){e.Success="Success",e.Failure="Failure"}(r||(r={})),function(e){e.PlainText="PlainText",e.RichText="RichText",e.AdaptiveCard="AdaptiveCard"}(c||(c={})),function(e){e.AIResponse="AIResponse",e.ContentCreation="ContentCreation",e.Python="Python"}(l||(l={}))},217623:(e,t,s)=>{s.d(t,{X8:()=>T});var n=s(827774),o=s(521409),i=s(985002),a=s(282144),r=s(463569),c=s(199128),l=s(879586),u=s(83222),p=s(837450),g=s(186117);class h{constructor(e){this.outlookDataHandle=e}getLocalPeopleData(){const e=this.outlookDataHandle.getAllRecipients(),t=[];for(const s of e)t.push({DisplayName:s.displayName,EmailAddresses:[s.emailAddress],Id:s.id,confidence:0,entityType:"",providerName:"",text:""});return t}}const d=new Map([["AugLoop_GraphSearch_SearchSuggestionsRequest",0],["AugLoop_ObservationalAssistance_UserInitiatedRequestClient",1],["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient",2]]);class m extends p.c{constructor(e,t){super("GraphSearchWorkflowInstance",e,t)}async execute(e,t,s){var n;let a=!1,r=!1;const u=new Date,p=this.startLogOperation("GraphSearchWorkflowExecute",u);this.logWasmStats(p);const g=d.get(i.h.getTypeNameFor(e));void 0!==g&&p.setDataFields({scenario:g}),(l.VP.typeGuard(e)||c.iU.typeGuard(e))&&(p.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:t.clientMetadata.sessionId}),c.iU.typeGuard(e)&&0===(null===(n=e.multiIntents)||void 0===n?void 0:n.length)&&(r=!0)),a=this.executeWorkflowLambda(p,e,t,s),r&&!a||o.tG.info(509638755,o.nh.WorkflowDefault,p.stop())}}const y=(e,t)=>new m(e,t),T=(e,t)=>{const s=t.localContext?new h(t.localContext):null;return n.z.create("GraphSearchLocalWorkflowOA").setStateful().setInputTypes([a.$9.getTypeName(),c.iU.getTypeName(),l.VP.getTypeName(),a.zV.getTypeName()]).setOutputTypes([r.nm.getTypeName(),r.t9.getTypeName(),u.SM.getTypeName(),r.NG.getTypeName(),a.tE.getTypeName(),r.rQ.getTypeName(),r.xz.getTypeName()]).setLambdaType(y.bind(null,{...e,localContext:s},t))};f=g.aU,_=g.zb,n.z.create("GraphSearchLocalWorkflow").setStateful().setInputTypes([a.$9.getTypeName(),a.Z5.getTypeName(),a.zV.getTypeName()]).setOutputTypes([r.J_.getTypeName(),a.tE.getTypeName(),r.rQ.getTypeName(),r.xz.getTypeName()]).setLambdaType(y.bind(null,f,_));var f,_},217762:(e,t,s)=>{var n,o,i,a,r,c,l,u,p,g,h,d,m,y;s.d(t,{f9:()=>n,rS:()=>r}),function(e){e.Podcast="Podcast",e.AudioOverview="AudioOverview",e.Assistant="Assistant"}(n||(n={})),function(e){e.NewsBriefing="NewsBriefing"}(o||(o={})),function(e){e.ODSP="ODSP"}(i||(i={})),function(e){e.Long="long",e.Medium="medium",e.Short="short",e.VeryShort="very short",e.ExtremelyShort="extremely short",e.VeryLong="very long"}(a||(a={})),function(e){e.Script="script",e.Ssml="ssml",e.Audio="audio"}(r||(r={})),function(e){e.EN_US="en-us"}(c||(c={})),function(e){e.Professional="Professional",e.Casual="Casual"}(l||(l={})),function(e){e.OneHost="One Host",e.TwoHost="Two Host"}(u||(u={})),function(e){e.AudioCast_Error="AudioCast_Error",e.CONTENT_ACQUISITION_ERROR="CONTENT_ACQUISITION_ERROR",e.GRAPH_ERROR="GRAPH_ERROR",e.FILE_SENSITIVITY_FETCH_ERROR="FILE_SENSITIVITY_FETCH_ERROR",e.FILE_METADATA_FETCH_ERROR="FILE_METADATA_FETCH_ERROR",e.FILE_CONTENT_FETCH_ERROR="FILE_CONTENT_FETCH_ERROR",e.NORMALIZATION_ERROR="NORMALIZATION_ERROR",e.TTS_ERROR="TTS_ERROR",e.DLP_ERROR="DLP_ERROR",e.LLM_ERROR="LLM_ERROR",e.RAI_ERROR="RAI_ERROR",e.TOKEN_ERROR="TOKEN_ERROR",e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.SCRIPT_HANDLER_ERROR="SCRIPT_HANDLER_ERROR",e.METERING_ERROR="METERING_ERROR",e.CACHE_ERROR="CACHE_ERROR"}(p||(p={})),function(e){e.INTERNAL_SERVER_ERROR="INTERNAL_SERVER_ERROR",e.THROTTLED="THROTTLED",e.TOO_SMALL_AUDIO_BUFFER="TOO_SMALL_AUDIO_BUFFER",e.CACHE_READ_FAILED="CACHE_READ_FAILED",e.REQUEST_TOO_LARGE="REQUEST_TOO_LARGE",e.RETRY_LIMIT_REACHED="RETRY_LIMIT_REACHED",e.LIMITED_RESOURCES="LIMITED_RESOURCES",e.TOKEN_NOT_AVAILABLE="TOKEN_NOT_AVAILABLE",e.LOCAL_FILES_NOT_SUPPORTED="LOCAL_FILES_NOT_SUPPORTED",e.NETWORK_ERROR="NETWORK_ERROR",e.FAILED_TO_PARSE_FILES="FAILED_TO_PARSE_FILES",e.FAILED_TO_DOWNLOAD_FILES="FAILED_TO_DOWNLOAD_FILES",e.FAILED_TO_FETCH_FILE_METADATA="FAILED_TO_FETCH_FILE_METADATA",e.FAILED_TO_FETCH_SENSITIVITY_INFO="FAILED_TO_FETCH_SENSITIVITY_INFO",e.EMPTY_SENSITIVITY_INFO="EMPTY_SENSITIVITY_INFO",e.SENSITIVE_FILES_NOT_SUPPORTED="SENSITIVE_FILES_NOT_SUPPORTED",e.IRM_PROTECTED_ENCRYPTED_FILE="IRM_PROTECTED_ENCRYPTED_FILE",e.RAI_INPUT_CHECK_FAILED="RAI_INPUT_CHECK_FAILED",e.RAI_OUTPUT_CHECK_FAILED="RAI_OUTPUT_CHECK_FAILED",e.UNSUPPORTED_LANGUAGE="UNSUPPORTED_LANGUAGE",e.UNSUPPORTED_FILE_TYPE="UNSUPPORTED_FILE_TYPE",e.NOT_FOUND="NOT_FOUND",e.DLP_POLICY_ACCESS_DENIED="DLP_POLICY_ACCESS_DENIED",e.EXTRACT_RIGHTS_MISSING="EXTRACT_RIGHTS_MISSING",e.UNSUPPORTED_VOICE="UNSUPPORTED_VOICE",e.GROUNDING_CONTENT_INPUT_LIMIT_EXCEED="GROUNDING_CONTENT_INPUT_LIMIT_EXCEED",e.AUTHENTICATION_FAILED="AUTHENTICATION_FAILED",e.BAD_REQUEST="BAD_REQUEST",e.BAD_REQUEST_LLM="BAD_REQUEST_LLM",e.REQUEST_TIMEOUT="REQUEST_TIMEOUT",e.ABORTED="Aborted",e.UNKNOWN="Unknown",e.CLIENT_NOT_WHITELISTED="CLIENT_NOT_WHITELISTED",e.UNSUPPORTED_REQUEST="UNSUPPORTED_REQUEST",e.INVALID_CONTENT_ACQUISITION_SCRIPT="INVALID_CONTENT_ACQUISITION_SCRIPT",e.INVALID_CONTENT_NORMALIZATION_SCRIPT="INVALID_CONTENT_NORMALIZATION_SCRIPT",e.CONTENT_ACQUISITION_REQUEST_TIMEOUT="CONTENT_ACQUISITION_REQUEST_TIMEOUT",e.NO_CONTENT="NO_CONTENT",e.CONTENT_FETCH_FAILED_FOR_ALL_FILES="CONTENT_FETCH_FAILED_FOR_ALL_FILES",e.INCOMPLETE_CONTENT="INCOMPLETE_CONTENT",e.EMPTY_IMAGE_DATA="EMPTY_IMAGE_DATA",e.EMPTY_IMAGE_CONFIG="EMPTY_IMAGE_CONFIG",e.INVALID_IMAGE_FORMAT="INVALID_IMAGE_FORMAT",e.MULTIMODAL_LLM_CALL_FAILED="MULTIMODAL_LLM_CALL_FAILED",e.TOO_SMALL_GROUNDING_CONTENT="TOO_SMALL_GROUNDING_CONTENT",e.ALLOWED_ALLOWANCE_EXHAUSTED="ALLOWED_ALLOWANCE_EXHAUSTED",e.LLM_TOKEN_LIMIT_EXCEED="LLM_TOKEN_LIMIT_EXCEED",e.FILE_DOWNLOAD_CONDITIONAL_ACCESS_BLOCKED="FILE_DOWNLOAD_CONDITIONAL_ACCESS_BLOCKED"}(g||(g={})),function(e){e.BLOB="blob",e.BASE64="base64"}(h||(h={})),function(e){e.eTag="eTag",e.cTag="cTag"}(d||(d={})),function(e){e.TypeBPlugin="TypeBPlugin",e.TypeBPluginGlobal="TypeBPluginGlobal",e.CopilotApp="CopilotApp",e.Canvas="Canvas"}(m||(m={})),function(e){e.IDLE="IDLE",e.FETCHING_CONTENT="FETCHING_CONTENT",e.GENERATING_PLAN="GENERATING_PLAN",e.GENERATING_SCRIPT="GENERATING_SCRIPT",e.GENERATING_AUDIO_BLOB="GENERATING_AUDIO_BLOB",e.SUCCESS="SUCCESS",e.FAILED="FAILED"}(y||(y={}))},221777:(e,t,s)=>{s.d(t,{F:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.suspiciousStringValue="",e.prototype.PG_ConcernEventName="",e.prototype.PG_TableName="",e.prototype.PG_ColumnName="",e.prototype.PG_EventTime="",e.prototype.PG_ConcernTypeText="",e.prototype.PG_ShouldIgnore=!1,e.prototype.PG_EventLocatorName="",e.prototype.PG_EventLocatorValue="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/PrivacyGuardIssueEvent"},e}())},222699:(e,t,s)=>{s.d(t,{A:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.resourceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthReasonCategory="",e.prototype.healthBucketWithSuppressions="",e.prototype.healthReasonWithSuppressions="",e.prototype.healthReasonCategoryWithSuppressions="",e.prototype.scenarioHealthBucket="",e.prototype.scenarioHealthReason="",e.prototype.scenarioHealthBucketWithSuppressions="",e.prototype.scenarioHealthReasonWithSuppressions="",e.prototype.activationState="",e.prototype.modelItemsCountBucket="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ScenarioStatsEvent"},e}())},224411:(e,t,s)=>{var n,o;s.d(t,{p:()=>o,y:()=>n}),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(n||(n={})),function(e){e.Suggestion="Suggestion",e.UserActivity="UserActivity",e.UserPrompts="UserPrompts",e.Link="Link",e.Publish="Publish"}(o||(o={}))},228339:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.completePromiseWithin=void 0;var n=s(745032);t.completePromiseWithin=function(e,t,s){return e<=0?s:new Promise((function(o,i){var a=!1,r=setTimeout((function(){a||(a=!0,i(new Error("Timeout after ".concat(e,"ms. ").concat(t))))}),e);s.then((function(e){a||(a=!0,clearTimeout(r),o(e))}),(function(e){n.Log.error(539821445,n.LogCategory.WorkflowDefault,e),a||(a=!0,clearTimeout(r),i(e))}))}))}},230529:(e,t,s)=>{s.d(t,{g:()=>i,t:()=>o});var n=s(72715);const o=void 0!==n&&n.hrtime?()=>{const e=n.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now(),i=void 0!==n&&n.hrtime?()=>{const e=n.hrtime();return 1e6*e[0]+e[1]/1e3}:"undefined"!=typeof performance&&performance.now?()=>Math.round(1e3*performance.now()):()=>1e3*Date.now()},231455:(e,t,s)=>{s.d(t,{b:()=>je});var n=s(723768),o=s(985002);class i{constructor(){this._fulfilled=!1,this.completion=new Promise(((e,t)=>{this.onResolve=e,this.onReject=t}))}resolve(e){this._fulfilled=!0,this.onResolve(e)}reject(e){this._fulfilled=!0,this.onReject(e)}get fulfilled(){return this._fulfilled}}var a=s(586377),r=s(493491),c=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};class l{constructor(e,t,s){this.scheduler=e,this.callerCancelToken=t,this.timeoutMs=s}runWithCombinedToken(e){return c(this,void 0,void 0,(function*(){const t=new a.A9(this.scheduler),s=new a.aG(this.callerCancelToken,t.token);try{return void 0!==this.timeoutMs&&t.cancelAfter(this.timeoutMs),yield e(s.token)}catch(e){if(e instanceof r._b&&!this.callerCancelToken.IsCancellationRequested&&t.token.IsCancellationRequested)throw new r.Xq(`strategy timeout: ${this.timeoutMs}`);throw e}finally{s.dispose(),t.dispose()}}))}}var u=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};class p{constructor(e,t){this.value=null,this.error=null,this.value=e,this.error=t}static createValue(e){return new p(e,null)}static createError(e){return new p(null,e)}isError(){return null!==this.error}}class g{constructor(){this.items=[],this.pendingDequeuePromise=null}enqueue(e){var t;this.items.push(p.createValue(e)),null===(t=this.pendingDequeuePromise)||void 0===t||t.resolve()}enqueueError(e){var t;this.items.push(p.createError(e)),null===(t=this.pendingDequeuePromise)||void 0===t||t.resolve()}dequeue(e){return u(this,void 0,void 0,(function*(){if(0===this.items.length){if(this.pendingDequeuePromise)throw new Error("Cannot have simultaneous dequeues");this.pendingDequeuePromise=new i;try{yield Promise.race([this.pendingDequeuePromise.completion,e.rejectWhenCancellationRequested()])}finally{this.pendingDequeuePromise=null}}return this.items.shift()}))}empty(){return 0===this.items.length}}var h,d=s(521409),m=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))},y=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,s=e[Symbol.asyncIterator];return s?s.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=e[s]&&function(t){return new Promise((function(n,o){(function(e,t,s,n){Promise.resolve(n).then((function(t){e({value:t,done:s})}),t)})(n,o,(t=e[s](t)).done,t.value)}))}}};class T{constructor(e,t,s,n,o){this.session=e,this.request=t,this.cancelToken=s,this.scheduler=n,this.logOp=o,this.logOp.resourceId="StreamingRequest"}execute(){return m(this,void 0,void 0,(function*(){const e=this.request.firstAnnotationTimeoutMs?Math.min(this.request.firstAnnotationTimeoutMs,this.request.perAnnotationTimeoutMs):this.request.perAnnotationTimeoutMs,t={annotationType:[this.request.chunks.getTypeName(),this.request.completion.getTypeName()],transientItems:this.request.operation.items.map((e=>Object.assign(Object.assign({},e),{parentPath:this.request.operation.parentPath}))),maxDelayMs:e,sourceInfo:{}},s=this.session.getAnnotations(t,this.cancelToken),n=new g,o=new f(s,this.scheduler,this.cancelToken,this.request,n,this.logOp);return o.initialize().catch((e=>{n.enqueueError(e)})),Promise.resolve(o)}))}}class f{constructor(e,t,s,n,o,a){this.iterable=e,this.scheduler=t,this.cancelToken=s,this.request=n,this.queue=o,this.logOp=a,this.completionPromise=new i,this.complete=!1,this.isFirstAnnotation=!0}subscribeResults(e){var t,s,n,o,i,a,r;return m(this,void 0,void 0,(function*(){try{try{for(t=!0,s=y(e);n=yield s.next(),!(o=n.done);t=!0){r=n.value,t=!1;const e=r;if(this.completionPromise.fulfilled)break;this.onGetAnnotationResponse(e)}}catch(e){i={error:e}}finally{try{t||o||!(a=s.return)||(yield a.call(s))}finally{if(i)throw i.error}}}catch(e){this.queue.enqueueError(e)}}))}initialize(){return m(this,void 0,void 0,(function*(){return this.subscribeResults(this.iterable)}))}onGetAnnotationResponse(e){if(e.error)throw new r.m6(JSON.stringify(e.error),e.error);const t=e.content.map((e=>e.body));for(const e of t)this.isFirstAnnotation&&(this.isFirstAnnotation=!1),this.queue.enqueue(e);e.finalResponse&&(this.complete=!0)}[Symbol.asyncIterator](){return this}get chunks(){return this}get completion(){return this.completionPromise.completion}next(){return m(this,void 0,void 0,(function*(){try{const e=this.request.firstAnnotationTimeoutMs&&this.request.firstAnnotationTimeoutMs?this.request.firstAnnotationTimeoutMs:this.request.perAnnotationTimeoutMs,t=new l(this.scheduler,this.cancelToken,e),s=yield t.runWithCombinedToken(this.waitForNextEvent.bind(this)),{value:n}=s;return s.isError()?this.handleError(s.error):this.complete&&this.queue.empty()?this.request.completion.typeGuard(n)?(this.completionPromise.resolve(n),this.handleFinalResult(n)):this.handleError(new r.Ek(`(Streaming completion) expect: ${this.request.completion.getTypeName()}, received: ${o.h.getTypeNameFor(n)}`)):this.request.chunks.typeGuard(n)?{done:!1,value:n}:this.handleError(new r.Ek(`(Streaming chunks) expect: ${this.request.chunks.getTypeName()}, received: ${o.h.getTypeNameFor(n)}`))}catch(e){return this.handleError(e)}}))}handleError(e){return this.completionPromise.reject(e),this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,this.handleFinalResult(e)}handleFinalResult(e){return d.tG.info(505427165,d.nh.CoreDefault,this.logOp.stop()),{done:!0,value:e}}waitForNextEvent(e){return m(this,void 0,void 0,(function*(){return yield this.queue.dequeue(e)}))}}!function(e){e[e.SingleAnnotation=0]="SingleAnnotation",e[e.Streaming=1]="Streaming",e[e.CustomMessage=2]="CustomMessage"}(h||(h={}));var _=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))},C=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,s=e[Symbol.asyncIterator];return s?s.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=e[s]&&function(t){return new Promise((function(n,o){(function(e,t,s,n){Promise.resolve(n).then((function(t){e({value:t,done:s})}),t)})(n,o,(t=e[s](t)).done,t.value)}))}}};class S{constructor(e,t,s,n,o){this.session=e,this.request=t,this.cancelToken=s,this.scheduler=n,this.logOp=o,this.completionPromise=new i,this.logOp.resourceId="SingleAnnotationRequest"}execute(){return _(this,void 0,void 0,(function*(){try{const e=new l(this.scheduler,this.cancelToken,this.request.timeoutMs);return yield e.runWithCombinedToken(this.executeOnAnnotation.bind(this))}catch(e){throw this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,e}finally{d.tG.info(505427166,d.nh.CoreDefault,this.logOp.stop())}}))}executeOnAnnotation(e){return _(this,void 0,void 0,(function*(){try{const t={annotationType:[this.request.annotation.getTypeName()],transientItems:this.request.operation.items.map((e=>Object.assign(Object.assign({},e),{parentPath:this.request.operation.parentPath}))),maxDelayMs:this.request.timeoutMs,sourceInfo:{}},s=this.session.getAnnotations(t,e);return yield Promise.race([this.subscribeAnnotations(s),e.rejectWhenCancellationRequested()])}catch(e){throw e}}))}subscribeAnnotations(e){var t,s,n,i,a,c,l;return _(this,void 0,void 0,(function*(){try{for(t=!0,s=C(e);n=yield s.next(),!(i=n.done);t=!0){l=n.value,t=!1;const e=l;if(e.error){this.completionPromise.reject(new r.m6(JSON.stringify(e.error),e.error));break}const s=e.content.map((e=>e.body));1==s.length?this.request.annotation.typeGuard(s[0])?this.completionPromise.resolve(s[0]):this.completionPromise.reject(new r.Ek(`(SingleAnnotation) expect: ${this.request.annotation.getTypeName()}, received: ${o.h.getTypeNameFor(s[0])}`)):this.completionPromise.reject(new r.TQ(`Number of annotations received: ${s.length}`));break}}catch(e){a={error:e}}finally{try{t||i||!(c=s.return)||(yield c.call(s))}finally{if(a)throw a.error}}return this.completionPromise.completion}))}}var A=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};class v{constructor(e,t,s,n,o){this.session=e,this.request=t,this.cancelToken=s,this.scheduler=n,this.logOp=o,this.logOp.resourceId="CustomMessageRequest"}execute(){return A(this,void 0,void 0,(function*(){try{const e=new l(this.scheduler,this.cancelToken,this.request.timeoutMs);return yield e.runWithCombinedToken(this.executeOnAnnotation.bind(this))}catch(e){throw this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,e}finally{d.tG.info(505427164,d.nh.CoreDefault,this.logOp.stop())}}))}executeOnAnnotation(e){return A(this,void 0,void 0,(function*(){return yield Promise.race([this.submitRequest(),e.rejectWhenCancellationRequested()])}))}submitRequest(){return A(this,void 0,void 0,(function*(){const e=yield this.session.submitCustomMessage(this.request.message);if(!this.request.responseType.typeGuard(e))throw new r.Ek(`Response type do not match. Actual: ${o.h.getTypeNameFor(e)}, Expected: ${this.request.responseType}`);return e}))}}var I=s(488096),w=s(301520);class N{static create(e){var t;return new N(e.session,null!==(t=e.scheduler)&&void 0!==t?t:new I.O)}constructor(e,t){this.session=e,this.scheduler=t}execute(e,t){return this.createExecutor(e,t).execute()}createExecutor(e,t){const s=new w.I({operationName:"AsyncClientExecute",success:!0}).setClientMetadata(this.session.getClientMetadata()).start();switch(e.type){case h.SingleAnnotation:return s.resourceId="SingleAnnotationRequest",new S(this.session,e,t,this.scheduler,s);case h.Streaming:return s.resourceId="StreamingRequest",new T(this.session,e,t,this.scheduler,s);case h.CustomMessage:return s.resourceId="CustomMessageRequest",new v(this.session,e,t,this.scheduler,s);default:throw new Error("Request Type not supported")}}}var E=s(844457),b=s(339297);const k={category:E.v.Schema,schema:{name:"Exception",path:"message-schema.proto"}},M=(E.v.Schema,(e,t=!1)=>{if(null==e)return"Invalid message passed";if(null==e.payload)return`${b.K[b.K.NoOutput]}: Payload is null`;if(null==e.payload.exceptionType)return"Payload is not an exception";{let s=b.K[e.payload.exceptionType];return s+=e.payload.message?`: ${e.payload.message}`:": No description",s+=t&&e.payload.data?`\n${e.payload.data.toString()}`:"",s}}),L=(e,t)=>{if(null==e)throw new Error("Cannot set exception on null message");e.payload=t,e.payloadSchema=k,e.messageType=b.G.Exception};var B,D,P=s(868713),R=s(738460),O=s(475769),x=s(919450);!function(e){let t,s,n,o,i,a;!function(e){e[e.Unknown=0]="Unknown",e[e.Text=1]="Text",e[e.Slide=2]="Slide"}(t=e.TileType||(e.TileType={})),function(e){e[e.Generic=0]="Generic",e[e.Title=1]="Title",e[e.SmartArt=2]="SmartArt",e[e.TableCell=3]="TableCell",e[e.TextBox=4]="TextBox",e[e.Notes=5]="Notes"}(s=e.TextTileType||(e.TextTileType={})),function(e){e[e.Undefined=0]="Undefined",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(n=e.TextTileElementUnit||(e.TextTileElementUnit={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered"}(o=e.ListType||(e.ListType={})),function(e){e[e.Undefined=0]="Undefined",e[e.AlphaLcParenBoth=1]="AlphaLcParenBoth",e[e.AlphaUcParenBoth=2]="AlphaUcParenBoth",e[e.AlphaLcParenR=3]="AlphaLcParenR",e[e.AlphaUcParenR=4]="AlphaUcParenR",e[e.AlphaLcPeriod=5]="AlphaLcPeriod",e[e.AlphaUcPeriod=6]="AlphaUcPeriod",e[e.ArabicParenBoth=7]="ArabicParenBoth",e[e.ArabicParenR=8]="ArabicParenR",e[e.ArabicPeriod=9]="ArabicPeriod",e[e.ArabicPlain=10]="ArabicPlain",e[e.RomanLcParenBoth=11]="RomanLcParenBoth",e[e.RomanUcParenBoth=12]="RomanUcParenBoth",e[e.RomanLcParenR=13]="RomanLcParenR",e[e.RomanUcParenR=14]="RomanUcParenR",e[e.RomanLcPeriod=15]="RomanLcPeriod",e[e.RomanUcPeriod=16]="RomanUcPeriod",e[e.CircleNumDbPlain=17]="CircleNumDbPlain",e[e.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain",e[e.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain",e[e.ArabicDbPeriod=20]="ArabicDbPeriod",e[e.ArabicDbPlain=21]="ArabicDbPlain",e[e.Ea1ChsPeriod=22]="Ea1ChsPeriod",e[e.Ea1ChsPlain=23]="Ea1ChsPlain",e[e.Ea1ChtPeriod=24]="Ea1ChtPeriod",e[e.Ea1ChtPlain=25]="Ea1ChtPlain",e[e.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod",e[e.Ea1JpnKorPlain=27]="Ea1JpnKorPlain",e[e.Ea1JpnKorPeriod=28]="Ea1JpnKorPeriod",e[e.Arabic1Minus=29]="Arabic1Minus",e[e.Arabic2Minus=30]="Arabic2Minus",e[e.Hebrew2Minus=31]="Hebrew2Minus",e[e.ThaiAlphaPeriod=32]="ThaiAlphaPeriod",e[e.ThaiAlphaParenR=33]="ThaiAlphaParenR",e[e.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth",e[e.ThaiNumPeriod=35]="ThaiNumPeriod",e[e.ThaiNumParenR=36]="ThaiNumParenR",e[e.ThaiNumParenBoth=37]="ThaiNumParenBoth",e[e.HindiAlphaPeriod=38]="HindiAlphaPeriod",e[e.HindiNumPeriod=39]="HindiNumPeriod",e[e.HindiNumParenR=40]="HindiNumParenR",e[e.HindiAlpha1Period=41]="HindiAlpha1Period"}(i=e.ListNumeration||(e.ListNumeration={})),function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(a=e.TextTileEventType||(e.TextTileEventType={}))}(B||(B={})),function(e){let t;!function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(t=e.SlideTileEventType||(e.SlideTileEventType={}))}(D||(D={}));var F=s(673586);class G{constructor(){this.cache=new Map}setReduceTimer(e,t,s,n=500,o=()=>!1,i=5e3){this.cache.has(e)||this.cache.set(e,new Map);const a=this.cache.get(e);a.has(t)&&clearTimeout(a.get(t).timer);const r=()=>{const r=a.get(t),c=Date.now()-r.start;o()&&c<i?r.timer=setTimeout(r.timerCallback,Math.min(n,i-c)):(a.size>1?a.delete(t):this.cache.delete(e),s())};a.set(t,{start:Date.now(),timerCallback:r,timer:setTimeout(r,n)})}clear(e,t){this.cache.forEach(((s,n)=>{e&&e!==n||s.forEach(((e,s)=>{t&&t!==s||clearTimeout(e.timer)}))})),this.cache.clear()}}var W=s(427999);class H{constructor(e=33e5){this.tokenCache=new Map,this.requestMap=new Map,this.requestRecordMap=new Map,this.tokenExpirationMs=e}updateAuthToken(e,t){const s=JSON.stringify(t);let n=this.requestRecordMap.get(s);return(void 0===n||this.isTokenExpired(n))&&(n={requestPromise:e.requestAuthToken(t).then((e=>{if(!e||!e.Token)throw new Error(`No token available for request ${s}`);this.tokenCache.set(s,e.Token)})),requestTime:O.Aq.getCurrentTimeMs()},this.requestRecordMap.set(s,n)),n.requestPromise}getAuthTokenEntries(e,t){return Array.from(this.tokenCache.keys()).map((e=>{let t=this.requestMap.get(e);return void 0===t&&(t=JSON.parse(e),this.requestMap.set(e,t)),{requestKey:e,request:t}})).filter((({request:e})=>!t||e.DocId===t)).map((({requestKey:t,request:s})=>(this.isTokenExpired(this.requestRecordMap.get(t))&&this.updateAuthToken(e,s),{ticket:s.Tickets[0],token:this.tokenCache.get(t)})))}isTokenExpired(e){return O.Aq.getCurrentTimeMs()>e.requestTime+this.tokenExpirationMs}}let U;const q=()=>{U=new H};q();const V=(e,t,s,n,o,i,a,r,c,l)=>{const u={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":o},body:JSON.stringify({payload:t.payload,payloadSchema:s,requestedSchema:n,clientMetadata:i,tokens:U.getAuthTokenEntries(a,c.docId)})};(0,W.OW)(e,u,((u,p)=>{u?l(new Error(`Fetch error in remote lambda request to ${e}: ${u}`)):401===p.status?r>0?(d.tG.info(572838109,d.nh.CoreDefault,"Auth token required for remote lambda request"),p.json().then((e=>U.updateAuthToken(a,{Tickets:[e],DocId:c.docId}))).then((()=>{V(e,t,s,n,o,i,a,r-1,c,l)})).catch((e=>{l({exceptionType:b.K.Authentication,message:e.message})}))):l({exceptionType:b.K.Authentication,message:"Remote lambda request retry with authentication token failed"}):p.ok?p.json().then((e=>{if(Array.isArray(e))if(e.length>0){let s=0;for(const n of e)t.moreResults=++s<e.length,l(null,n)}else l(new Error("No output"));else l(new Error("Did not receive a valid response for remote lambda request"))})).catch((e=>{l({exceptionType:b.K.LambdaThrow,message:e.message})})):l(new Error(`Remote lambda request failed with status ${p.status}`))}))},$=(e,t,s,n,o,i,a,r,c)=>{Array.isArray(r.authTickets)?U.updateAuthToken(a,{Tickets:r.authTickets,DocId:r.docId}).then((()=>{V(e,t,s,n,o.id,i,a,1,r,c)})).catch((e=>{c({exceptionType:b.K.Authentication,message:e.message})})):V(e,t,s,n,o.id,i,a,1,r,c)};var j=s(399115);class z{constructor(){this.hasBeenOpened=!1,this.hadEgressError=!1,this.lastEgressTime=0,this.lastPongTime=0,this.remainingPingFailures=3,this.egressMessageCount=0,this.egressByteCount=0,this.isClosing=!1,this.pendingEgress=[]}init(e,t,s,n){this.ws=new j.A(e),this.logOp=new w.I({operationName:z.className,success:!0,dimension1:"V1"}).start(),this.egressTimer=Date.now(),this.egressMessageCountOp=new w.I({operationName:"WSEgressMessageCount",success:!0,dimension1:"V1"}),this.egressByteCountOp=new w.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0,dimension1:"V1"}),this.ingressByteCountOp=new w.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0,dimension1:"V1"});const o=e=>{this.logPingLatencyOp&&(this.logPingLatencyOp.success=e,d.tG.info(507789790,d.nh.CoreDefault,this.logPingLatencyOp.stop()),this.logPingLatencyOp=void 0)};this.ws.addEventListener("open",(e=>{s(),z.logCountLimiter.log((()=>{this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),d.tG.info(507789789,d.nh.CoreDefault,this.logOp.stop())})),this.hasBeenOpened=!0,this.pendingEgress.forEach((e=>{this.egress({obj:e})})),this.pendingEgress=[],this.pingInterval=setInterval((()=>{this.logPingLatencyOp&&(--this.remainingPingFailures,o(!1)),this.remainingPingFailures>0&&this.hasBeenOpened&&this.lastPongTime<this.lastEgressTime&&(this.logPingLatencyOp=new w.I({operationName:"Ping",success:!0,dimension0:this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString().length.toString():void 0,dimension1:"V1"}).start(),this.ws.send(z.pingPongMessage,(e=>{e&&(--this.remainingPingFailures,o(!1))})))}),3e4)})),this.ws.addEventListener("message",(e=>{this.logPingLatencyOp&&"string"==typeof e.data&&1===e.data.length&&e.data[0]===z.pingPongMessage?(o(!0),this.lastPongTime=Date.now()):(this.logIngressCount(e.data),t(e.data))})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,z.logCountLimiter.log((()=>{this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,d.tG.info(507789788,d.nh.CoreDefault,this.logOp.stop())})),this.ws.close()})),this.ws.addEventListener("close",(e=>{z.logCountLimiter.log((()=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,d.tG.info(507789787,d.nh.CoreDefault,this.logOp.stop())})),this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),n(this.errorMessage),this.isClosing=!1}))}egress(e){const t=e.obj;this.logEgressCount(t instanceof ArrayBuffer||t instanceof Uint8Array?t.byteLength:t.length),this.lastEgressTime=Date.now(),this.hasBeenOpened?this.ws.send(t,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,z.logCountLimiter.log((()=>{this.logOp.resourceId="OnFirstEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,d.tG.info(507789786,d.nh.CoreDefault,this.logOp.stop())})))})):this.pendingEgress.push(t)}close(){this.isClosing||(this.isClosing=!0,this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),this.ws.close())}logEgressCount(e){const t=Date.now(),s=t-this.egressTimer;s>1e3&&(this.egressMessageCount>50&&(this.egressMessageCountOp.start(),this.egressMessageCountOp.resultDescription="Egress message count: "+this.egressMessageCount.toString()+", Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+s.toString(),d.tG.info(507789785,d.nh.CoreDefault,this.egressMessageCountOp.stop())),this.egressByteCount>1e5&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=this.egressByteCount.toString().length.toString(),this.egressMessageCountOp.resultDescription="Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+s.toString(),d.tG.info(507789784,d.nh.CoreDefault,this.egressByteCountOp.stop())),this.egressTimer=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),d.tG.info(507789783,d.nh.CoreDefault,this.ingressByteCountOp.stop()))}}z.className="WebSocketWorker",z.logCountLimiter=new O.yq(z.className),z.pingPongMessage="~";class K{constructor(e,t,s,n,o,i){this.requestId=e,this.correlationId=t,this.schemaName=s,this.data=n,this.callback=o,this.requestTimeoutInMs=i,this.ended=!1,this.startTime=0}startRequest(){this.startTime=O.Aq.getCurrentTimeMs()}getMsUntilTimeout(){const e=O.Aq.getCurrentTimeMs()-this.startTime;return this.requestTimeoutInMs-e}endRequest(e){this.ended||(this.invokeCallback(null,e,!0),this.ended=!0)}addResponseData(e){this.invokeCallback(e,null,!1)}invokeCallback(e,t,s){new Promise((()=>this.callback(e,t,s))).catch((e=>{}))}}let Q;const J=()=>{Q=new H};J();const Y=new class{constructor(e,t,s){this.requestCounter=0,this.activeRequests=[],this.pendingRequests=[],this.requestTimeoutInMs=e,this.workerFactory=t,this.maxActiveRequests=s}testConnection(e,t){let s=!1;const n=new w.I({cv:(new P.W).toString(),operationName:"WebSocketTest",resourceId:(0,R.k$)(e),success:!0}).start();return new Promise((o=>{const i=O.Aq.createHealthCheckRequest(t);e?this.addRequest(e,i,n.cv,"HealthCheckRequest",((e,t,i)=>{t&&(n.success=!1,n.resultSignature="Error",n.resultDescription=t.message||t),e&&"OK"===e.status&&(s=!0),i&&(n.success&&!s&&(n.success=!1,n.resultSignature="NoResponseData"),d.tG.info(556617949,d.nh.CoreDefault,n.stop()),o(n.success))})):(n.success=!1,n.resultSignature="EmptyUrl",d.tG.info(557641870,d.nh.CoreDefault,n.stop()),o(n.success))}))}addRequest(e,t,s,n,o){const i=(this.requestCounter++).toString(),a=new K(i,s,n,t,o,this.requestTimeoutInMs);this.getWorker(e),this.pendingRequests.push(a),this.egressPendingRequests()}egressPendingRequests(){for(;this.pendingRequests.length>0&&this.activeRequests.length<this.maxActiveRequests;){const e=this.pendingRequests.shift();if(this.activeRequests.push(e),1===this.activeRequests.length){const t=e.getMsUntilTimeout();setTimeout(this.onTimeout.bind(this),t)}e.startRequest(),this.worker&&this.worker.egress({obj:this.createRequestMessage(e.data,e.requestId,e.correlationId)})}}createRequestMessage(e,t,s){return JSON.stringify({correlationId:s,requestId:t,body:e})}onTimeout(){for(;this.activeRequests.length>0;){const e=this.activeRequests[0],t=e.getMsUntilTimeout();if(!(t<=0))return void setTimeout(this.onTimeout.bind(this),t);{const t=new Error("Request timed out");e.endRequest(t),this.activeRequests.shift(),this.egressPendingRequests()}}}onMessage(e){try{const t=JSON.parse(e);for(let e=0;e<this.activeRequests.length;e++){const s=this.activeRequests[e];if(s.requestId===t.requestId){t.end?(this.activeRequests.splice(e,1),s.endRequest(t.error),this.egressPendingRequests()):t.body&&s.addResponseData(t.body);break}}}catch(e){d.tG.error(557641871,d.nh.CoreDefault,e)}}onClose(e){const t=new Error(`Connection closed: ${e}`);for(const e of this.activeRequests)e.endRequest(t);this.activeRequests=[];for(const e of this.pendingRequests)e.endRequest(t);this.pendingRequests=[],this.worker=void 0}getWorker(e){return this.worker||(this.worker=this.workerFactory(),this.worker.init(e,this.onMessage.bind(this),(()=>{}),this.onClose.bind(this))),this.worker}}(3e4,(()=>new z),50),Z=(e,t,s,n,o,i,a,r,c,l)=>{const u={payload:t.payload,payloadSchema:s,requestedSchema:n,clientMetadata:i,tokens:Q.getAuthTokenEntries(a,c.docId)};let p="";n&&n.schema&&(p=n.schema.name);let g=!1;Y.addRequest(e,u,o,p,((u,p,h)=>{if(!g)if(g=!0,null!=p)if(p.exceptionType===b.K.Authentication)try{const u=JSON.parse(p.data);r>0?(d.tG.info(572838108,d.nh.CoreDefault,"Auth token required for remote lambda WebSocket request"),Q.updateAuthToken(a,{Tickets:[u],DocId:c.docId}).then((()=>{Z(e,t,s,n,o,i,a,r-1,c,l)})).catch((e=>{l({exceptionType:b.K.Authentication,message:e.message})}))):l({exceptionType:b.K.Authentication,message:"Remote lambda request retry with authentication token failed"})}catch(e){l({exceptionType:b.K.Authentication,message:e.message})}else l(new Error(`Error in remote lambda WebSocket request to ${e}: ${p}`));else t.moreResults=!1,l(null,u)}))},X=(e,t,s,n,o,i,a,r,c)=>{Array.isArray(r.authTickets)?Q.updateAuthToken(a,{Tickets:r.authTickets,DocId:r.docId}).then((()=>{Z(e,t,s,n,o.id,i,a,1,r,c)})).catch((e=>{c({exceptionType:b.K.Authentication,message:e.message})})):Z(e,t,s,n,o.id,i,a,1,r,c)};class ee{constructor(){this.cache=new Map,this.bucketSizes=new Map}setBucketSize(e,t){this.bucketSizes.set(e,t)}setResult(e,t,s){if(!t.primary)return;let n=this.cache.get(e);n||(n=new Map,this.cache.set(e,n));let o=n.get(t.primary);if(o||(o=t.secondary?new Map:[],n.set(t.primary,o)),t.secondary){o.set(t.secondary,s)}else{const t=o;t.length==this.getBucketSize(e)&&t.shift(),t.push(s)}}getResults(e,t){const s=this.cache.get(e);if(s){const e=s.get(t.primary);if(e){if(!t.secondary)return e;const s=Array.from(e.values());if(s.length>0)return s}}return[]}clear(e,t){t?this.cache.forEach(((s,n)=>{if(!e||e===n)if(t.secondary){const e=s.get(t.primary);e&&e.delete(t.secondary)}else s.delete(t.primary)})):e?this.cache.delete(e):this.cache.clear()}getBucketSize(e){return this.bucketSizes.get(e)||10}}var te,se;!function(e){e[e.Unknown=0]="Unknown",e[e.Local=1]="Local",e[e.Custom=2]="Custom",e[e.Remote=3]="Remote",e[e.BatchedRemote=4]="BatchedRemote"}(te||(te={}));class ne{constructor(){this.throttleInfoMap=new Map}execute(e,t,s){if(t.throttleSettings.shouldBeThrottled&&t.throttleSettings.throttlingInterval>0){const n=this.getWorkflowThrottleInfo(t.name);if(null==n.currentTileId)n.currentTileId=e,n.timeOfPreviousStartedEvent=O.Aq.getCurrentTimeMs(),s();else if(n.currentTileId===e){const e=O.Aq.getCurrentTimeMs(),o=this.delayTime(n,e,t.throttleSettings.throttlingInterval);o>0?(n.latestCallback=s,null==n.lastTimeout&&(n.lastTimeout=setTimeout((()=>{const e=this.getWorkflowThrottleInfo(t.name);e.lastTimeout=void 0,e.timeOfPreviousStartedEvent=O.Aq.getCurrentTimeMs(),e.latestCallback()}),o))):(n.timeOfPreviousStartedEvent=e,s())}else null!=n.lastTimeout&&(clearTimeout(n.lastTimeout),n.latestCallback(),n.lastTimeout=void 0),n.currentTileId=e,n.timeOfPreviousStartedEvent=O.Aq.getCurrentTimeMs(),s()}else s()}delayTime(e,t,s){const n=t-e.timeOfPreviousStartedEvent;return Math.max(s-n,0)}getWorkflowThrottleInfo(e){let t=this.throttleInfoMap.get(e);return t||(t={currentTileId:void 0,timeOfPreviousStartedEvent:-1,latestCallback:()=>{},lastTimeout:void 0},this.throttleInfoMap.set(e,t)),t}}!function(e){e[e.Restricted=0]="Restricted",e[e.Unrestricted=1]="Unrestricted",e[e.Suppressed=2]="Suppressed"}(se||(se={}));class oe{constructor(){this.canaryTextTileEventSubmittedByDocSessionId=new Set,this.stateByDocSessionId=new Map,this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map}getOutputSchema(){return this.lambdas[this.lambdas.length-1].outputSchema}scheduleExecution(e,t){const s=this.docSessionIdExtractor?this.docSessionIdExtractor(e):void 0,n=this.getStateForDocSessionId(s);if(n===se.Restricted){const e=this.getExecutionQueueForDocSessionId(s);e.push(t),1===e.length&&t()}else n===se.Unrestricted?t():se.Suppressed}onStart(e){this.incrementExecutionCountForDocSessionId(e)}onFinish(e,t){if(this.decrementExecutionCountForDocSessionId(e),t===b.K.Authentication)this.stateByDocSessionId.set(e,se.Suppressed),this.executionQueueByDocSessionId.delete(e);else if(this.stateByDocSessionId.get(e)===se.Restricted){const s=this.getExecutionQueueForDocSessionId(e);if(s.shift(),void 0===t){this.stateByDocSessionId.set(e,se.Unrestricted),this.executionQueueByDocSessionId.delete(e);for(const e of s)e()}else if(s.length>0){(0,s[0])()}}}onRefresh(e){this.stateByDocSessionId=new Map,this.triggerOnRefresh&&(e?(this.executionQueueByDocSessionId.delete(e),this.executionCountByDocSessionId.delete(e)):(this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map)),this.canaryTextTileEventSubmittedByDocSessionId.delete(e)}getStateForDocSessionId(e){let t=this.stateByDocSessionId.get(e);return void 0===t&&(t=oe.executionQueuesEnabled?se.Restricted:se.Unrestricted,this.stateByDocSessionId.set(e,t)),t}getExecutionQueueForDocSessionId(e){let t=this.executionQueueByDocSessionId.get(e);return void 0===t&&(t=[],this.executionQueueByDocSessionId.set(e,t)),t}incrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;this.executionCountByDocSessionId.set(e,t+1)}decrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;t<=1?this.executionCountByDocSessionId.delete(e):this.executionCountByDocSessionId.set(e,t-1)}}oe.executionQueuesEnabled=!0;const ie=e=>({category:E.v.Schema,schema:{name:e}}),ae="Tiling.TextTileEvent",re="ClpSlideTile",ce=(e,t)=>e===ae&&t&&t.type==B.TextTileEventType.Refresh,le=(e,t)=>e===re&&t&&t.eventType==D.SlideTileEventType.Refresh,ue=(e,t)=>ce(e,t)||le(e,t),pe=(e,t)=>{var s,n;return e===ae?null===(n=null===(s=t.tile)||void 0===s?void 0:s.metadata)||void 0===n?void 0:n.docSessionId:e===re?t.docId:void 0};const ge=new class{constructor(){this.inputSchemasToWorkflows=new Map,this.inputSchemasToReduceWorkflows=new Map,this.reduceWorkflowsGroupingKeyExtractors=new Map,this.defaultWorkflowOptions={canProduceNullResult:!1,shouldSendResultsToHost:!0,enabledByDefault:!1,throttleSettings:{shouldBeThrottled:!1},triggerOnRefresh:!1},this.resultCache=new ee,this.reduceTimerCache=new G,this.lookupTableCache=new Map,this.throttling=new ne,this.lastTileRefreshSeq=-1,this.lastTileRefreshSeqByDocSessionId=new Map,this.tileRefreshByDocSessionIdEnabled=!0}init(e,t,s){const o=new w.I({operationName:"InitRuntimeALv1",resourceId:(0,R.k$)(e)});o.start(),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=(0,n.HF)()),this.hostCallbacks=s;const i=[];return i.push(this.isFeatureEnabled("DisableWebSocket").then((s=>{if(!!s)return!1;return!(["Outlook Mac","Outlook Win32","PowerPoint Mac","PowerPoint Web","PowerPoint Win32","Word Mac","Word Win32"].indexOf(`${t.appName} ${t.appPlatform}`)>=0)||((e,t)=>Y.testConnection(e,t))(O.Aq.convertServiceUrlToWebSocket(e),this.clientMetadata)})).then((t=>{e&&(this.serviceUrl=t?O.Aq.convertServiceUrlToWebSocket(e):e,this.executeRemoteLambda=t?X:$,this.clearRemoteLambdaTokenCache=t?J:q,this.serviceProtocol=this.serviceUrl.split(":")[0].toLowerCase())}))),i.push(this.isFeatureEnabled("WorkflowQueuesDisabled").then((e=>{oe.executionQueuesEnabled=!e}))),i.push(this.isFeatureEnabled("TileRefreshByDocSessionIdDisabled").then((e=>{this.tileRefreshByDocSessionIdEnabled=!e}))),Promise.all(i).then((()=>{this.logOperation(o,!0)})).catch((e=>{this.logOperation(o,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerSchemas(e,t){return Promise.resolve()}registerSimpleLocalWorkflow(e,t,s=this.defaultWorkflowOptions){return t.source=t.source||te.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToWorkflows,s)}registerSimpleRemoteWorkflow(e,t,s,n,o=this.defaultWorkflowOptions){const i=[];return t&&(t.source=te.Custom,i.push(t)),s.source=s.func?te.Custom:te.Remote,i.push(s),n&&(n.source=te.Custom,i.push(n)),this.registerHardcodedWorkflow(e,i,this.inputSchemasToWorkflows,o)}registerMultipleLambdasWorkflow(e,t,s=this.defaultWorkflowOptions){return this.registerHardcodedWorkflow(e,t,this.inputSchemasToWorkflows,s)}registerReduceWorkflow(e,t,s,n=10,o=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t.inputSchema,s),this.resultCache.setBucketSize(t.inputSchema,n),t.source=t.source||te.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToReduceWorkflows,o)}registerMultipleLambdasReduceWorkflow(e,t,s,n=10,o=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t[0].inputSchema,s),this.resultCache.setBucketSize(t[0].inputSchema,n),this.registerHardcodedWorkflow(e,t,this.inputSchemasToReduceWorkflows,o)}submit(e,t,s){this.submitToWorkflows(e,t,s,this.inputSchemasToWorkflows)}getGroupingKey(e,t,s){const n=this.reduceWorkflowsGroupingKeyExtractors.get(s);if(null==n)throw new Error("Reduce workflow does not have a grouping extractor");return n(t,e)}submitToWorkflows(e,t,s,n=this.inputSchemasToWorkflows){if(!this.hostCallbacks)return;let o;o=s?P.W.fromString(s):new P.W,this.handleTileRefresh(e,t,o);const i=n.get(e)||[];for(const s of i)ue(e,t)&&!s.triggerOnRefresh||(s.useCanaryTextTile&&e===ae&&!s.canaryTextTileEventSubmittedByDocSessionId.has(pe(e,t))&&(this.submitToWorkflow(ae,{type:(a=t).type,tile:{metadata:{docSessionId:a.tile.metadata.docSessionId,docId:a.tile.metadata.docId,seqnoCLPRefresh:a.tile.metadata.seqnoCLPRefresh,tileId:"A56B3127DBDFD0D6"},elements:[{text:"B91153AE828B4E48"}]}},o,s,n),s.canaryTextTileEventSubmittedByDocSessionId.add(pe(e,t))),this.submitToWorkflow(e,t,o,s,n));var a}submitToWorkflow(e,t,s,n,o){const i={messageType:b.G.Input,correlationVector:s.newChild(),payload:t,payloadSchema:ie(n.lambdas[0].inputSchema),clientMetadata:this.clientMetadata},a=new w.I({cv:i.correlationVector.toString(),operationName:"ExecuteWorkflow",resourceId:n.name});a.setClientMetadata(this.clientMetadata),a.start(),n.scheduleExecution(t,(()=>{try{if(i.payload&&i.payload.tile&&i.payload.tile.metadata&&i.payload.tile.metadata.tileId){const s=i.payload.tile.metadata.tileId;this.throttling.execute(s,n,(()=>this.executeWorkflow(a,i,t,n,e,o)))}else this.executeWorkflow(a,i,t,n,e,o)}catch(e){a.success=!1,a.resultSignature="ExecuteException",a.resultDescription=e?e.message:"(no error)",d.tG.error(559290447,d.nh.CoreDefault,a.stop())}}))}handleTileRefresh(e,t,s){if(!ue(e,t))return;const n=this.tileRefreshByDocSessionIdEnabled?pe(e,t):void 0,o=((e,t)=>{var s,n;return ce(e,t)?null===(n=null===(s=t.tile)||void 0===s?void 0:s.metadata)||void 0===n?void 0:n.seqnoCLPRefresh:(le(e,t),-1)})(e,t);if(this.tileRefreshByDocSessionIdEnabled){const e=this.lastTileRefreshSeqByDocSessionId.get(n);if(e>=0&&o<=e)return}else if(o<=this.lastTileRefreshSeq)return;const i=new w.I({cv:s.toString(),operationName:"TileRefresh",resultDescription:"",success:!0});if(i.start(),this.tileRefreshByDocSessionIdEnabled&&!n)return i.success=!1,i.resultDescription="NoDocSessionId",void d.tG.info(559290448,d.nh.CoreDefault,i.stop());this.inputSchemasToReduceWorkflows.forEach(((e,t)=>{e.some((e=>e.triggerOnRefresh))&&(this.tileRefreshByDocSessionIdEnabled?(this.resultCache.clear(t,{primary:n}),this.resultCache.clear(this.getForcedDocLevelSchema(t),{primary:n}),this.reduceTimerCache.clear(t,n)):(this.resultCache.clear(t),this.resultCache.clear(this.getForcedDocLevelSchema(t)),this.reduceTimerCache.clear(t)),e.some((e=>!e.triggerOnRefresh))&&(i.resultDescription+="X_"),i.resultDescription+=t+" ")})),this.clearRemoteLambdaTokenCache();const a=[];this.inputSchemasToWorkflows.forEach((e=>a.push(...e))),this.inputSchemasToReduceWorkflows.forEach((e=>a.push(...e)));for(const e of a)this.tileRefreshByDocSessionIdEnabled?e.onRefresh(n):e.onRefresh();this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.set(n,o):this.lastTileRefreshSeq=o,d.tG.info(559290449,d.nh.CoreDefault,i.stop())}executeWorkflow(e,t,s,n,o,i){const a=n.docIdExtractor?n.docIdExtractor(t.payload):void 0,r=n.docSessionIdExtractor(s),c=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(r):this.lastTileRefreshSeq;n.onStart(r);const l=t=>{const a=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(r):this.lastTileRefreshSeq;if(n.triggerOnRefresh&&a!==c)return e.success=!0,e.resultSignature="TileRefreshIgnore",void d.tG.info(559290450,d.nh.CoreDefault,e.stop());const l=t.messageType==b.G.Exception&&t.payload.exceptionType==b.K.NoOutput,u=l&&n.canProduceNullResult,p=u?n.lambdas[n.lambdas.length-1].outputSchema:t.payloadSchema.schema.name,g=u?null:t.payload;t.messageType===b.G.Input||u?(n.shouldSendResultsToHost&&(i===this.inputSchemasToReduceWorkflows?this.hostCallbacks.onResult("Reduce.Input",s,p,g):this.hostCallbacks.onResult(o,s,p,g)),e.success=!0,e.resultSignature=l?"NoOutput":"ValidOutput"):l?(e.success=!0,e.resultSignature="NoOutput"):(e.success=!1,e.resultSignature="Exception",e.resultDescription=M(t)),i!==this.inputSchemasToReduceWorkflows&&this.updateResultCacheForReduceWorkflows(o,s,p,g,t.correlationVector.toString()),t.moreResults||(e.stop(),d.tG.info(559290451,d.nh.CoreDefault,e),n.onFinish(r,t.payload&&t.payload.exceptionType?(e=>null==e||null==e.payload||null==e.payload.exceptionType?b.K.Unknown:e.payload.exceptionType)(t):void 0))};n.preExecutionPromise.then((()=>{const e={lookupTable:this.lookupTableCache.get(n.name),docId:a,docSessionId:r};let s=l;for(let t=n.lambdas.length-1;t>=0;t--)s=this.createLambdaExecutionStep(n.name,n.lambdas[t],e,s,l);s(t)}))}getForcedDocLevelSchema(e){return`~${e}`}updateResultCacheForReduceWorkflows(e,t,s,n,o){const i=this.inputSchemasToReduceWorkflows.get(s);if(i){let a;"docSessionId"===e?(a=this.getGroupingKey(e,t,s),this.resultCache.setResult(this.getForcedDocLevelSchema(s),a,n),a.secondary="*"):(a=this.getGroupingKey(e,t,s),((e,t)=>e===ae&&t&&t.type==B.TextTileEventType.Delete||e===re&&t&&t.eventType==D.SlideTileEventType.Delete)(e,t)&&null!=a.primary&&null!=a.secondary?this.resultCache.clear(void 0,a):this.resultCache.setResult(s,a,n));const r=i.some((e=>e.deferReduceUntilIdle)),c=[];this.inputSchemasToWorkflows.forEach((e=>c.push(...e.filter((e=>e.getOutputSchema()===s)))));const l=()=>r&&c.some((e=>e.executionCountByDocSessionId.get(a.primary)>0)),u=i.map((e=>e.deferReduceUntilIdleMaxDelayMs||0)).reduce(((e,t)=>Math.max(e,t)));this.reduceTimerCache.setReduceTimer(s,a.primary,(()=>{const e=this.resultCache.getResults(s,a);if(e.push(...this.resultCache.getResults(this.getForcedDocLevelSchema(s),{primary:a.primary})),Array.isArray(e)){const t={id:a.primary,values:e,isReduceInput:!0};this.submitToWorkflows(s,t,o,this.inputSchemasToReduceWorkflows)}else d.tG.error(559290452,d.nh.CoreDefault,`Cached results have unexpected type "${typeof e}"`)}),500,l,u)}}isFeatureEnabled(e,t=!1,s="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+e,s).catch((()=>Promise.resolve(t))):Promise.resolve(t)}areLicenseFeaturesEnabled(e){return this.hostCallbacks&&this.hostCallbacks.areLicenseFeaturesEnabled?this.hostCallbacks.areLicenseFeaturesEnabled(e).catch((()=>Promise.resolve(!1))):Promise.resolve(!1)}isWorkflowEnabled(e,t,s,n,o){if(t.some((e=>e.source===te.Remote||e.source===te.BatchedRemote))){if(!this.serviceUrl)return o.resultDescription="Disabled because no service URL available for remote workflow",Promise.resolve(!1);if(this.clientMetadata&&this.clientMetadata.privateMode&&t.some((e=>(e.source===te.Remote||e.source===te.BatchedRemote)&&!e.canRunInPrivateMode)))return o.resultDescription="Disabled because we are running in private mode",Promise.resolve(!1)}let i;return(!this.clientMetadata||"Mac"!==this.clientMetadata.appPlatform&&"Win32"!==this.clientMetadata.appPlatform)&&(n=!0,o.resultDescription="Enabled by default due to platform name"),i=n?Promise.resolve(!0):this.isFeatureEnabled("WorkflowEnabled."+e),i.then((t=>t?this.isFeatureEnabled("WorkflowDisabled."+e).then((e=>e?(o.resultDescription="Disabled because explicitly disabled",!1):!s||this.areLicenseFeaturesEnabled(s).then((e=>(e||(o.resultDescription="Disabled because license check failed"),e))))):(o.resultDescription="Disabled because not explicitly enabled",!1)))}registerHardcodedWorkflow(e,t,s=this.inputSchemasToWorkflows,n){if(!e||e.length>40)throw new Error("Workflow name has invalid length");if(!1===new RegExp(/^[A-Z][a-zA-Z0-9_]+$/).test(e))throw new Error("Workflow name has invalid format");s.forEach((t=>{if(t.some((t=>t.name===e)))throw new Error("Workflow name already registered.")}));const o=new w.I({operationName:"WorkflowRegistration",resourceId:e,success:!0});return o.setClientMetadata(this.clientMetadata),o.start(),this.isWorkflowEnabled(e,t,n.licenseFeatures,n.enabledByDefault,o).then((i=>{if(o.resultSignature=i?"Enabled":"Disabled",o.stop(),d.tG.info(559290453,d.nh.CoreDefault,o),i){const o=t[0].inputSchema;let i=s.get(o);i||(i=[],s.set(o,i));let a=Promise.resolve();n.lookupTableLambda&&(a=new Promise(((t,s)=>{const o=new P.W,i={messageType:b.G.Input,correlationVector:o,payloadSchema:ie(n.lookupTableLambda.inputSchema),clientMetadata:this.clientMetadata,payload:{}},a=s=>{s.messageType===b.G.Input&&s.payload&&this.lookupTableCache.set(e,s.payload),t()};this.createLambdaExecutionStep("",n.lookupTableLambda,{},a,a)(i)})));const r=new oe;r.name=e,r.lambdas=t,r.canProduceNullResult=n.canProduceNullResult,r.shouldSendResultsToHost=n.shouldSendResultsToHost,r.triggerOnRefresh=n.triggerOnRefresh,r.throttleSettings=n.throttleSettings||this.defaultWorkflowOptions.throttleSettings,r.docIdExtractor=n.docIdExtractor,r.docSessionIdExtractor=e=>e.isReduceInput?e.id:pe(o,e),r.deferReduceUntilIdle=n.deferReduceUntilIdle,r.deferReduceUntilIdleMaxDelayMs=n.deferReduceUntilIdleMaxDelayMs,r.useCanaryTextTile=n.useCanaryTextTile,r.preExecutionPromise=a,i.push(r)}}))}logOperation(e,t,s,n){e.stop(),e.success=t,e.resultSignature=s,e.resultDescription=n,d.tG.info(559290454,d.nh.CoreDefault,e)}handleLambdaError(e,t,s,n,o){null!=e.exceptionType?L(t,e):e instanceof Error?L(t,{exceptionType:n,message:e.message}):L(t,{exceptionType:b.K.Unknown,message:e?e.toString():void 0}),this.logOperation(s,!1,"Exception",M(t)),o(t)}handleLambdaOutput(e,t,s,n,o,i){e&&e.exceptionType!==b.K.NoOutput?null!=e.exceptionType?this.handleLambdaError(e,t,s,e.exceptionType,i):e instanceof Error?this.handleLambdaError(e,t,s,b.K.LambdaErrorCallback,i):(t.payload=e,t.payloadSchema=ie(n),this.logOperation(s,!0),o(t)):(L(t,{exceptionType:b.K.NoOutput}),this.logOperation(s,!0,"NoOutput"),i(t))}executeCustomLambdaStep(e,t,s,n,o,i){if(null==s.func)L(e,{exceptionType:b.K.LambdaThrow,message:"No lambda function set"}),this.logOperation(t,!1,"Error",M(e)),i(e);else{const a=n=>{this.handleLambdaOutput(n,e,t,s.outputSchema,o,i)},r=(s,n)=>{this.handleLambdaOutput(s,e,t,n,i,i)};try{s.func(e.payload,s.config,n,a,r)}catch(s){this.handleLambdaError(s,e,t,b.K.LambdaThrow,i)}}}executeLocalLambdaStep(e,t,s,n,o){null==this.hostCallbacks.executeLocalLambda?(L(e,{exceptionType:b.K.LambdaThrow,message:"No local lambda host callback set"}),this.logOperation(t,!1,"Error",M(e)),o(e)):this.hostCallbacks.executeLocalLambda(s.inputSchema,e.payload,s.outputSchema).then((i=>{this.handleLambdaOutput(i,e,t,s.outputSchema,n,o)})).catch((s=>{this.handleLambdaError(s,e,t,b.K.LambdaThrow,o)}))}executeRemoteLambdaStep(e,t,s,n,o,i){if(this.serviceUrl){t.resourceId+=`.${this.serviceProtocol}`;const a=(n,a)=>{n?this.handleLambdaError(n,e,t,n.exceptionType||b.K.LambdaErrorCallback,i):this.handleLambdaOutput(a,e,t,s.outputSchema,o,i)};if(n.authTickets=s.authTickets,s.source===te.Remote)this.executeRemoteLambda(this.serviceUrl,e,ie(s.inputSchema),ie(s.outputSchema),e.correlationVector,this.clientMetadata,this.hostCallbacks,n,a);else{this.batchedRemoteLambdaManager||(this.batchedRemoteLambdaManager=new x.Y(((e,t,s)=>{const{remoteLambda:n,lambdaContext:o}=t.context;this.executeRemoteLambda(this.serviceUrl,{messageType:b.G.Input,correlationVector:{id:t.cv},payload:e,payloadSchema:ie(n.inputSchema),clientMetadata:this.clientMetadata},ie(n.remoteInputSchema),ie(n.remoteOutputSchema),{id:t.cv},this.clientMetadata,this.hostCallbacks,o,s)}),!1,!1,((e,t,s)=>{var n;const{lambdaContext:o}=s;this.updateResultCacheForReduceWorkflows("docSessionId",null!==(n=o.docSessionId)&&void 0!==n?n:o.docId,e,t)})));const{batchOptions:t}=s,o=this.normalizeBatchOptions(t),{groupingKeyExtractor:i}=o;o.groupingKeyExtractor=e=>`${s.name}-${i(e)}`;const r={name:s.name,remoteLambda:s,lambdaContext:n};this.batchedRemoteLambdaManager.addBatchItem(e.payload,o,r,e.correlationVector.id.length>127?e.correlationVector.id.substring(0,127)+"!":e.correlationVector.id,void 0,a)}}else L(e,{exceptionType:b.K.LambdaThrow,message:"No URL for remote lambda"}),this.logOperation(t,!1,"Error",M(e)),i(e)}createLambdaExecutionStep(e,t,s,n,o){return i=>{const a=new w.I({cv:i.correlationVector.toString(),operationName:"ExecuteLambda",resourceId:t.name,dimension0:e});a.start(),t.source===te.Custom?this.executeCustomLambdaStep(i,a,t,s,n,o):t.source===te.Local?this.executeLocalLambdaStep(i,a,t,n,o):t.source===te.Remote||t.source===te.BatchedRemote?this.executeRemoteLambdaStep(i,a,t,s,n,o):(L(i,{exceptionType:b.K.LambdaThrow,message:"Unknown/No lambda location set"}),this.logOperation(a,!1,"Error",M(i)),o(i))}}normalizeBatchOptions(e){if(!e)throw new Error("Expected batchConfig");const t=Object.assign({},e);return e.estimateSize||(t.estimateSize=F.E),t}};var he=s(976941),de=s(886069),me=s(94470);class ye{static createFactory(e,t,s,n,o){return i=>{var a;const r=n||me.e3;return!ye.onnxRetrievalPromise||i?e&&t?((null===(a=r())||void 0===a?void 0:a.ort)&&!i?Promise.resolve():(0,me.el)(this.createCdnUrl(e,t),r,"ort",s,o)).then((()=>{ye.onnxRetrievalPromise=Promise.resolve(new ye(r))})).catch((e=>{ye.onnxRetrievalPromise=Promise.reject(e)})).then((()=>ye.onnxRetrievalPromise)):Promise.reject(new Error("Error: appName and/or version not provided")):ye.onnxRetrievalPromise}}static createCdnUrl(e,t){return`https://${e}${t}`}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var s;const n=null===(s=this.getCache())||void 0===s?void 0:s.ort;return(0,me.kQ)(e,t||"",n)}createInputs(){return(0,me.In)()}}var Te=s(547942),fe=s(184175),_e=s(633522),Ce=s(8165),Se=s(691891),Ae=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))},ve=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,s=e[Symbol.asyncIterator];return s?s.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=e[s]&&function(t){return new Promise((function(n,o){(function(e,t,s,n){Promise.resolve(n).then((function(t){e({value:t,done:s})}),t)})(n,o,(t=e[s](t)).done,t.value)}))}}};class Ie{constructor(){this.bridgeMessageSequenceId=0,this.sessionCloseReasonMap=new Map,this.addCallbacksAlreadySet=new Set,this.sendBridgeMessage=e=>{this.messageBridge&&(e.seq=this.bridgeMessageSequenceId++,this.messageBridge.sendMessage(JSON.stringify(new fe.vG(e))))},this.sendResponseAcrossBridge=(e,t,s,n)=>{e.catch((e=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message),new fe._p({messageId:t.messageId,error:e.message})))).then((e=>{this.sendBridgeMessage({bridgeId:s,docSessionId:n,response:e})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}}initialize(e){this.messageBridge=e.messageBridge,this.getSessionCallback=e.getSessionCallback,this.hostTelemetryCallbacks=e.hostTelemetryCallbacks,this.messageBridge.registerMessageReceivedCallback(this.onBridgeMessageReceived.bind(this))}setInterceptor(e){this.interceptorBridge=e,this.interceptorBridge.registerMessageReceivedCallback(this.onBridgeMessageReceivedFromInterceptor.bind(this))}onBridgeMessageReceived(e){null!=this.interceptorBridge?this.interceptorBridge.sendMessage(e):this.handleBridgeMessage(e)}onBridgeMessageReceivedFromInterceptor(e){this.handleBridgeMessage(e)}handleBridgeMessage(e){try{const{bridgeId:t,docSessionId:s,message:n}=JSON.parse(e),i=o.h.getTypeNameFor(n);this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Received message with messageTypeName ${i} on bridgeId ${t} and docSessionId ${s}`);const a=this.getSessionCallback(s);if(this.sessionCloseReasonMap.has(s)){const e=this.sessionCloseReasonMap.get(s);this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.w9({reason:e})}),this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Session whose doc session id is ${s} is close due to ${e}`)}if(Ce.Cs.typeGuard(n))if(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Sending GetHostBridgeSessionResponse to bridge with docSessionId ${s}`),a)a.then((e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new Ce.f8({messageId:n.messageId,isConnected:e.isConnected,isClosed:e.isClosed})})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:n.messageId,error:e})})}));else{const e="GetHostBridgeSessionRequestMessage called before session init";this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:n.messageId,error:e})})}else if(fe.n4.typeGuard(n))this.handleAnnotationActivationMessage(n,t,s,a);else if(Se.x5.typeGuard(n))this.handleGetAnnotationRequestBridgeMessage(n,t,s,a);else if(fe.Tb.typeGuard(n)){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Receiving Sync Message");for(const e of n.ops)a.then((t=>{t.submitOperation(e,n.cv)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}));this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe.YK({messageId:n.messageId})})}else if(fe.GA.typeGuard(n)){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Releasing Annotation Activation token = ${n.token}`);const e=a.then((e=>e.releaseAnnotation(n.token).then((e=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Sending Annotation Activation token = ${n.token}`),new fe.Qq({messageId:n.messageId,lastRelease:e}))))));this.sendResponseAcrossBridge(e,n,t,s)}else if(fe.g$.typeGuard(n))this.handleSubmittedCustomMessage(n,t,s,a);else if(fe.eE.typeGuard(n))this.handleSessionInitMessage(t,s,a);else if(o.h.matchesTypesFor(n,[Ce.i2.getTypeName()]))this.handleInteractiveAuthMessage(n,t,s,a);else if(o.h.matchesTypesFor(n,[Ce.og.getTypeName()])){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Setting seeding status change callback");const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Ce.U8({messageId:n.messageId,seedingStatusChangeMessage:e})})}).bind(this);a.then((t=>{t.setSeedingStatusChangeCallback(e)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}else if(o.h.matchesTypesFor(n,[Ce.tj.getTypeName()])){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Setting claims challenge callback");const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Ce.Td({messageId:n.messageId,claimsChallengeMessage:e})})}).bind(this);a.then((t=>{t.setClaimsChallengeCallback(e)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}else this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,`Did not respond to ${i} with Id ${n.messageId}`),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:n.messageId,error:"Unknown message type to handle"})})}catch(e){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message),this.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new fe._p({messageId:"unknown",error:e.message})})}}addBridgeCallbacksForSession(e,t){e.then((e=>{e.setServerAuthenticationStateChangeCallback((e=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.wU({serverAuthenticationState:e})})})),e.setSessionCloseCallback((e=>{this.sessionCloseReasonMap.set(t,e.reason),this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:e})})),e.setConnectCallback(((e,s,n,o,i)=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.uN({origin:n,sessionKey:s.split("/").pop(),sessionUrlBase:s.split("/").slice(0,-1).join("/"),anonymousToken:o,routingSessionKey:i})}),this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.gy({isSeedingRequired:e,sessionUrl:s,origin:n,authToken:o,routingSessionKey:i})})})),e.setReconnectCallback((()=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.lj})})),e.setDisconnectCallback((e=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new fe.eG({error:e})})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}handleAnnotationActivationMessage(e,t,s,n){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Activate Annotation of type = ${e.annotationType} token = ${e.token}`);const o=((n,o)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.B_({annotationType:e.annotationType,areApologies:!0,ops:[n],cv:o})})}).bind(this),i=n.then((n=>n.activateAnnotation(e.annotationType,{config:e.config,callback:(n,o)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.B_({annotationType:e.annotationType,ops:[n],cv:o})})},apologyCallback:e.sendApologies?o:void 0,forceReturnCachedAnnotations:e.forceReturnCachedAnnotations}).then((t=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Annotation Activation Response Recieved with token = ${t.token}`),new fe.PY({messageId:e.messageId,token:t.token}))))));this.sendResponseAcrossBridge(i,e,t,s)}handleSessionInitMessage(e,t,s){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Initing session with doc session id ${t}`),this.addCallbacksAlreadySet.has(t)||(this.addBridgeCallbacksForSession(s,t),this.addCallbacksAlreadySet.add(t)),s.then((s=>{const n=s.getConnectParams();if(void 0===n)return;const o=n.sessionUrl;this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new fe.uN({origin:n.origin,sessionKey:o.split("/").pop(),sessionUrlBase:o.split("/").slice(0,-1).join("/"),anonymousToken:n.authToken,routingSessionKey:n.routingSessionKey})}),this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Inited session with doc session id ${t}`),this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new fe.wU({serverAuthenticationState:s.getServerAuthenticationState()})})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}handleGetAnnotationRequestBridgeMessage(e,t,s,n){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Sending Get Annotation request");const o=n.then((t=>t.getAnnotations({annotationType:e.annotationTypes,sourceInfo:e.sourceInfo,configs:e.configs,transientItems:e.transientItems,maxDelayMs:e.maxDelayMs,tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,cv:e.cv})));Promise.resolve(o).then((n=>{var o,i,a;return Ae(this,void 0,void 0,(function*(){var r,c,l,u,p,g,h;try{for(o=!0,i=ve(n);!(r=(a=yield i.next()).done);o=!0){u=a.value,o=!1;const n=u;this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,"Receiving Get Annotation request");const i=new Se.rK({content:n.content,errorInfo:null===(p=n.error)||void 0===p?void 0:p.serviceError,warningInfo:null===(g=n.warning)||void 0===g?void 0:g.serviceError}),r=new Ce.wR({messageId:e.messageId,serverResponse:JSON.stringify(i),clientError:null===(h=n.error)||void 0===h?void 0:h.clientError,finalResponse:n.finalResponse});this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:r})}}catch(e){c={error:e}}finally{try{o||r||!(l=i.return)||(yield l.call(i))}finally{if(c)throw c.error}}}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}handleSubmittedCustomMessage(e,t,s,n){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Receiving SubmittedCustomMessage via message ${e.messageId}`),n.then((n=>{n.submitCustomMessage(e.customMessage).then((n=>{fe.YK.typeGuard(n)?n.messageId=e.messageId:this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,"Unexpeced response type from SubmitCustomMessage"),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:n})})).catch((n=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,n.message),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:e.messageId,error:n.message})})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}handleInteractiveAuthMessage(e,t,s,n){let o;this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Interactive auth requested via message ${e.messageId}`),n.then((n=>{n.authenticateInteractive().then((()=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.info,`Interactive auth succeeded for message ${e.messageId}`),o=new fe.YK({messageId:e.messageId})})).catch((t=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,`Interactive auth failed for message ${e.messageId}`),o=new fe._p({messageId:e.messageId,error:t.message})})).finally((()=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:o})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,he.q.error,e.message)}))}}var we=s(427420),Ne=s(676916),Ee=s(726529);class be{constructor(e){o.h.assign(be,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[be.getTypeName()])}}be.H_={T_:be.getTypeName(),B_:be.getBaseTypes()};class ke{constructor(e){o.h.assign(ke,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionExtensionConfig"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[ke.getTypeName()])}}ke.H_={T_:ke.getTypeName(),B_:ke.getBaseTypes()};var Me=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))},Le=function(e){return this instanceof Le?(this.v=e,this):new Le(e)},Be=function(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=s.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(s,n){i.push([e,t,s,n])>1||r(e,t)}))})}function r(e,t){try{(s=o[e](t)).value instanceof Le?Promise.resolve(s.value.v).then(c,l):u(i[0][2],s)}catch(e){u(i[0][3],e)}var s}function c(e){r("next",e)}function l(e){r("throw",e)}function u(e,t){e(t),i.shift(),i.length&&r(i[0][0],i[0][1])}},De=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,s=e[Symbol.asyncIterator];return s?s.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=e[s]&&function(t){return new Promise((function(n,o){(function(e,t,s,n){Promise.resolve(n).then((function(t){e({value:t,done:s})}),t)})(n,o,(t=e[s](t)).done,t.value)}))}}};const Pe=(e,t)=>{const s=[];for(const o of Object.keys(e)){if(void 0===e[o]||null===e[o])continue;const i={name:t?`${t}.${o}`:o,dataType:(n=e[o],"string"==typeof n?0:"boolean"==typeof n?1:"number"==typeof n?2:void we.Hv.sendTraceTag(572838285,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Warning,"Unsupported data field type")),value:e[o],classification:4};s.push(i)}var n;return s},Re=e=>Promise.resolve(!1);class Oe{constructor(){this._telemetryAggregationIntervalSec=30,this._eventHandlerDictionary={},this._changeGateEnabledCallback=void 0,this._bridge=null,this._bridgeInterceptor=null,this._sessionCloseReason=null,this._isSessionClosed=null,this._isSessionConnected=null,this._sessionConnectParams=null,this._serverAuthenticationState=Te.f.NotAuthenticated,this._connectCallbacks=new Map,this._connectionStateCallbackToken=0,this._claimsChallengeCallbacks=[],this._seedingStatusChangeCallbacks=[],this._bridgeMessageSequenceId=0,this._runtimeClientBridge=void 0,this._useBridgePackage=void 0,this.initialize=e=>{if(this._runtimeInitPromise)return void we.Hv.sendTraceTag(572838286,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Info,"Runtime already initialized");we.Hv.sendTraceTag(572838287,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Info,"Start and initialize augloop runtime ..."),this.checkParametersAndThrow("initialize",e);const t=[];t.push(this.isFeatureEnabled("Microsoft.Office.AugLoop.UseBridgePackage","None").then((e=>{this._useBridgePackage=e,we.Hv.sendTraceTag(505419218,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Info,`Use bridge package: ${e}`)}))),t.push(this.isFeatureEnabled("ModelDownloaderEbrake","None").then((t=>{t?we.Hv.sendTraceTag(556376070,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Info,"Resource downloader not created due to feature gate"):this.modelDownloaderFromCDN=e.appName&&e.downloadBaseUrl||e.downloadPolymerBaseUrl?new de.$(e.appName,e.downloadBaseUrl,e.downloadPolymerBaseUrl):void 0}))),this.inferenceServiceFactory=e.appName&&e.inferenceServiceVersion?ye.createFactory(e.appName,e.inferenceServiceVersion):void 0,this.powerpointParameters=e.powerpoint;const s={appName:e.appName,appPlatform:"Web",appVersion:e.appVersion,uiLanguage:e.uiLanguage,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,releaseCustomAudience:e.releaseCustomAudience,releaseFork:e.releaseFork,sessionId:e.sessionId,flights:e.flights,privateMode:e.privateMode,disabledServiceGroups:e.disabledServiceGroups,userSystemTimezone:e.userSystemTimezone,isClientTelemetrySampled:e.isClientTelemetrySampled},o={onResult:this.onResult.bind(this),onAnnotationResult:this.onAnnotationResult.bind(this),sendTelemetryEvent:this.sendTelemetryEvent.bind(this),sendDiagnosticTrace:this.sendDiagnosticTrace.bind(this),requestAuthToken:this.requestAuthToken.bind(this),isFeatureEnabled:this.isFeatureEnabled.bind(this),isChangeGateEnabled:this.isChangeGateEnabled.bind(this),setSessionData:this.setSessionData.bind(this),areLicenseFeaturesEnabled:Re,onInitSession:this.onInitSession.bind(this),overrideSessionInitMessage:this.overrideSessionInitMessage.bind(this)},i=Promise.all(t).then((()=>n.fA.init(e.serviceUrl,s,o,{telemetryAggregationIntervalSec:this._telemetryAggregationIntervalSec,modelDownloader:this.modelDownloaderFromCDN,inferenceServiceFactory:this.inferenceServiceFactory,isDeltaGeneratorEnabled:e.isDeltaGeneratorEnabled,disableSyncDeltaSending:e.disableSyncDeltaSending,syncDeltaTimeout:e.syncDeltaTimeout}))).then((()=>ge.init(e.serviceUrl,s,o)));this.createSession=()=>{this._runtimeInitPromise=i.then((()=>{let t=e.sessionCreationOptions;if(t||(t={}),this._useBridgePackage){if(this._runtimeClientBridge=new Ie,this._bridge){const e={sendDiagnosticTrace:(e,t,s)=>{const n=(()=>{switch(t){case he.q.error:return Ee.k.Error;case he.q.warn:return Ee.k.Warning;case he.q.info:return Ee.k.Info;case he.q.verbose:case he.q.debug:return Ee.k.Verbose;default:return Ee.k.Info}})();we.Hv.sendTraceTag(e,Ne.n.msoulscat_Wac_BrowserGeneral,n,s)},sendTelemetryEvent:(e,t,s,n,o,i,a,r)=>{throw new Error("Method not implemented.")}};this._runtimeClientBridge.initialize({messageBridge:this._bridge,getSessionCallback:this.getSessionCallback.bind(this),hostTelemetryCallbacks:e,changeGateFeatureGateCallbacks:{isFeatureEnabled:this.isFeatureEnabled.bind(this),isChangeGateEnabled:this.isChangeGateEnabled.bind(this)}})}else we.Hv.sendTraceTag(505415107,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,"bridge is not set, cannot initialize RuntimeClientBridge");this._bridgeInterceptor&&this._runtimeClientBridge.setInterceptor(this._bridgeInterceptor)}else{this._bridge&&this._bridge.registerMessageReceivedCallback(this.onBridgeMessage.bind(this)),this._bridgeInterceptor&&this._bridgeInterceptor.registerMessageReceivedCallback(this.onBridgeMessageFromInterceptor.bind(this));const e=t.onServerAuthenticationStateChangeCallback;t.onServerAuthenticationStateChangeCallback=t=>{this._serverAuthenticationState=t,e&&e(t),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.wU({serverAuthenticationState:t})})};const s=t.onSessionClose;t.onSessionClose=e=>{this._sessionCloseReason=e.reason,this._isSessionClosed=!0,s&&s(e),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:e})};const n=t.onSessionReconnect;t.onSessionReconnect=()=>{n&&n(),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.lj})};const o=t.onSessionDisconnect;t.onSessionDisconnect=e=>{this._isSessionConnected=!1,o&&o(e),this._bridge&&(this._sessionConnectParams=void 0,this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.eG({error:e})}))}}const s=t.onSessionConnect;t.onSessionConnect=(e,t,n,o,i)=>{this._isSessionConnected=!0,this._isSessionClosed=!1,s&&s(e,t,n,o,i),this._connectCallbacks.forEach(((s,a)=>{s(e,t,n,o,i)})),this._bridge&&!this._useBridgePackage&&(this._sessionConnectParams||(this._sessionConnectParams={authToken:o,isSeedingRequired:e,sessionUrl:t,origin:n,routingSessionKey:i},this.sendSessionInitResponseToBridge("*","*")),this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.gy({isSeedingRequired:e,sessionUrl:t,origin:n,authToken:o,routingSessionKey:i})}))};const o=t.onClaimsChallengeCallback;t.onClaimsChallengeCallback=e=>{o&&o(e),this._claimsChallengeCallbacks.forEach((t=>{t(e)}))};const i=t.onSeedingStatusChangeCallback;t.onSeedingStatusChangeCallback=e=>{i&&i(e),this._seedingStatusChangeCallbacks.forEach((t=>{t(e)}))};const a=t&&t.docSessionId||e.sessionId;return n.fA.createSession(Object.assign(Object.assign({},t),{docSessionId:a}))}))},this.createSession()},this.getSession=()=>this._runtimeInitPromise,this.setULSLogger=e=>{this.checkParametersAndThrow("setULSLogger",e&&e.ulsLogger),we.Hv.setLogger(e.ulsLogger)},this.setSendOTelEventCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendOTelEventCallback",e&&e.sendOTelEvent,this._sendOTelEventCallback),this._sendOTelEventCallback=e.sendOTelEvent},this.setSendDiagnosticTraceCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendDiagnosticTraceCallback",e&&e.sendDiagnosticTraceCallback,this._sendDiagnosticTraceCallback),this._sendDiagnosticTraceCallback=e.sendDiagnosticTraceCallback},this.setRequestAuthTokenCallback=e=>{this.checkParametersAndPropertyAndThrow("setRequestAuthTokenCallback",e&&e.requestAuthTokenCallback,this._requestAuthTokenCallback),this._requestAuthTokenCallback=e.requestAuthTokenCallback},this.setIsFeatureEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsFeatureEnabledCallback",e&&e.featureEnabledCallback,this._featureEnabledCallback),this._featureEnabledCallback=e.featureEnabledCallback},this.setIsChangeGateEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsChangeGateEnabledCallback",e&&e.changeGateEnabledCallback,this._changeGateEnabledCallback),this._changeGateEnabledCallback=e.changeGateEnabledCallback},this.registerLocalWorkflow=e=>{const t="registerLocalWorkflow";this.checkParametersAndThrow(t,e&&e.workflow),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.registerLocalWorkflow(e.workflow)}))},this.activateAnnotation=e=>{const t="activateAnnotation",s=this.checkParameters(t,e&&e.annotationType)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>{let s;return(e.config||e.handler||e.stateUpdateHandler)&&(s={config:e.config,callback:e.handler,apologyCallback:e.apologyHandler,stateUpdateCallback:e.stateUpdateHandler,forceReturnCachedAnnotations:e.forceReturnCachedAnnotations}),t.activateAnnotation(e.annotationType,s)}))},this.updateAnnotationConfig=e=>{const t="updateAnnotationConfig",s=this.checkParameters(t,e&&e.token&&e.config)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>{t.updateAnnotationConfig(e.token,e.config)}))},this.releaseAnnotation=e=>{const t="releaseAnnotation",s=this.checkParameters(t,e&&e.token)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>t.releaseAnnotation(e.token)))},this.submitOperation=e=>{const t="submitOperation";this.checkParametersAndThrow(t,e&&e.operation),this.checkRuntimeInit(t),this._runtimeInitPromise.then((t=>{t.submitOperation(e.operation,e.cv)}))},this.setSessionDataCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionDataCallback",e&&(e.sessionDataCallback||e.handler),this._setSessionDataCallback),e.sessionDataCallback?this._setSessionDataCallback=e.sessionDataCallback:e.handler&&(this._setSessionDataCallback=(t,s,n)=>e.handler(t,s))},this.setAnnotationResultCallback=e=>{const t="setAnnotationResultCallback";if(this.checkParametersAndThrow(t,e&&e.handler),this._annotationResultCallback){const e=`${t} already called`;we.Hv.sendTraceTag(537401028,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,e)}this._annotationResultCallback=e.handler},this.setAnnotationState=e=>{const t="setAnnotationState";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationState(e.parentPath,e.id,e.value)}))},this.setAnnotationMetadata=e=>{const t="setAnnotationMetadata";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationMetadata(e.parentPath,e.id,e.value)}))},this.setInitSessionCallback=e=>{this.checkParametersAndPropertyAndThrow("setInitSessionCallback",e&&e.initSessionCallback,this._initSessionCallback),this._initSessionCallback=e.initSessionCallback},this.setSessionInitOverrideCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionInitOverrideCallback",e&&e.handler,this._sessionInitOverrideCallback),this._sessionInitOverrideCallback=e.handler},this.setMessageBridge=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridge",e&&e.bridge,this._bridge),this._bridge=e.bridge},this.setMessageBridgeToALInterceptor=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridgeToALInterceptor",e&&e.bridge,this._bridgeInterceptor),this._bridgeInterceptor=e.bridge},this.forceReconnectSession=e=>{const t="forceReconnectSession",s=this.checkParameters(t,e)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((e=>e.forceReconnect()))},this.setSessionCloseCallback=e=>{const t="setSessionCloseCallback",s=this.checkParameters(t,e&&e.callback)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>{t.setSessionCloseCallback(e.callback)}))},this.setConnectCallback=e=>{const t=this.getSessionStateCallbackToken("connect");return e.callback&&this._connectCallbacks.set(t,e.callback),t},this.removeConnectionStateCallback=e=>!!this._connectCallbacks.has(e.token)&&(this._connectCallbacks.delete(e.token),!0),this.setSeedingStatusChangeCallback=e=>{this._seedingStatusChangeCallbacks.push(e.callback)},this.submitCustomMessage=e=>{const t="submitCustomMessage",s=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>t.submitCustomMessage(e.message)))},this.submitLargeBinaryDataMessage=e=>{const t="submitLargeBinaryDataMessage",s=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return s?Promise.reject(s):fe.VR.typeGuard(e.message)?this._runtimeInitPromise.then((t=>t.submitLargeBinaryDataMessage(e.message))):Promise.reject(`${t} only supports MicroSyncMessage`)},this.requestBinaryDataForBlob=e=>{const t="requestBinaryDataForBlob",s=this.checkParameters(t,e&&e.blob)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((t=>t.requestBinaryDataForBlob(e.blob)))},this.closeSession=()=>{const e=this.checkRuntimeInit("closeSession");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>{e.close()}))},this.startNewSession=()=>{if(!this.createSession){const e="startNewSession called before runtime init";throw we.Hv.sendTraceTag(537408074,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,e),new Error(e)}this.createSession(),this._sessionCloseReason=null,this._sessionConnectParams=null},this.authenticateInteractive=()=>{const e=this.checkRuntimeInit("authenticateInteractive");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>e.authenticateInteractive()))},this.getAnnotations=e=>{const t="getAnnotations",s=this.checkParameters(t,e&&e.request),n=this.checkRuntimeInit(t),o=s||n;return o?Promise.resolve({[Symbol.asyncIterator](){return Be(this,arguments,(function*(){const e=s?_e.zy.InvalidRequest:_e.zy.RuntimeNotInitialized;we.Hv.sendTraceTag(505952348,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,`ClientError. Code: ${e}, Error: ${null==o?void 0:o.message}`),yield yield Le({content:void 0,error:{clientError:{code:e,error:null==o?void 0:o.message}}})}))}}):this._runtimeInitPromise.then((t=>t.getAnnotations(e.request,e.cancellationToken)))},this.getAsyncClient=e=>{const t=this.checkRuntimeInit("getAsyncClient");return t?Promise.reject(t):this._runtimeInitPromise.then((t=>N.create({session:t,scheduler:e.scheduler})))},this.submit=e=>{const t="submit";this.checkParametersAndThrow(t,e&&e.inputSchema&&e.input),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((()=>{ge.submit(e.inputSchema,e.input,e.correlationVector)}))},this.addEventHandler=e=>{this.checkParametersAndThrow("addEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName]||[];t.push(e.handler),this._eventHandlerDictionary[e.schemaName]=t},this.removeEventHandler=e=>{this.checkParametersAndThrow("removeEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName];if(!Array.isArray(t))return;const s=t.indexOf(e.handler);s>=0&&t.splice(s,1)},this.registerSimpleRemoteWorkflow=e=>{const t="registerSimpleRemoteWorkflow",s=this.checkParameters(t,e&&e.name&&e.lambdaRemote)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((()=>ge.registerSimpleRemoteWorkflow(e.name,e.lambdaBefore,e.lambdaRemote,e.lambdaAfter)))},this.registerSimpleLocalWorkflow=e=>{const t="registerSimpleLocalWorkflow",s=this.checkParameters(t,e&&e.name&&e.lambda)||this.checkRuntimeInit(t);return s?Promise.reject(s):this._runtimeInitPromise.then((()=>ge.registerSimpleLocalWorkflow(e.name,e.lambda)))},this.registerReduceWorkflow=e=>Promise.resolve(),this.registerSchemas=e=>Promise.resolve(),this.onResult=(e,t,s,n)=>{const o=this._eventHandlerDictionary[s];if(o)for(const i of o)if(i){i({inputSchema:e,input:t,outputSchema:s,output:n})}},this.onAnnotationResult=(e,t)=>{this._annotationResultCallback&&this._annotationResultCallback(e,t)},this.requestAuthToken=e=>{if(!this._requestAuthTokenCallback)return Promise.resolve({Token:""});return(this._requestAuthTokenCallback(e)||Promise.resolve("")).then((e=>{const t=e||"";return Promise.resolve({Token:t})}))},this.sendTelemetryEvent=(e,t,s,n,o,i,a,r)=>{this._sendOTelEventCallback&&this._sendOTelEventCallback(((e,t,s,n,o,i,a)=>{const r={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:Pe(s),eventFlags:{dataCategories:i,diagnosticLevel:a,samplingPolicy:1}};return n&&(r.eventContract={name:n,dataFields:Pe(o,n.split(".").slice(-1)[0])}),r})(e,t,s,n,o,a,r))},this.sendDiagnosticTrace=(e,t,s)=>{this._sendDiagnosticTraceCallback&&this._sendDiagnosticTraceCallback(e,t,s)},this.isFeatureEnabled=(e,t)=>{if(!e)return Promise.resolve(!1);const s="Microsoft.Office.AugLoop.";if(0===e.indexOf(s)&&this._featureEnabledCallback){const t=e.slice(25);return Promise.resolve(this._featureEnabledCallback(t)||this._featureEnabledCallback(e))}return Promise.resolve(!1)},this.isChangeGateEnabled=e=>e&&this._changeGateEnabledCallback?Promise.resolve(this._changeGateEnabledCallback(e)):Promise.resolve(!1),this.setSessionData=(e,t,s)=>{this._setSessionDataCallback&&this._setSessionDataCallback(e,t,s)},this.overrideSessionInitMessage=e=>this._sessionInitOverrideCallback?this._sessionInitOverrideCallback(e):0===e.clientMetadata.appName.indexOf("PowerPoint")&&this.powerpointParameters?this.overridePowerPointSessionInitMessage(e):e,this.overridePowerPointSessionInitMessage=e=>{const t={downloadUrl:this.powerpointParameters.downloadUrl,getItemsEndPoint:this.powerpointParameters.getItemsEndPoint,documentOpenType:this.powerpointParameters.documentOpenType};for(const s of Object.keys(e))t[s]=e[s];return new be(t)},this.onInitSession=()=>this._initSessionCallback?this._initSessionCallback():Promise.resolve(),this.checkParameters=(e,t)=>{if(!t){const t=`${e} called with invalid parameters`;return we.Hv.sendTraceTag(537408075,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,t),new Error(t)}},this.checkParametersAndThrow=(e,t)=>{const s=this.checkParameters(e,t);if(s)throw s},this.checkParametersAndPropertyAndThrow=(e,t,s)=>{if(this.checkParametersAndThrow(e,t),s){const t=`${e} already called`;throw we.Hv.sendTraceTag(537408076,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,t),new Error(t)}},this.checkRuntimeInit=e=>{if(!this._runtimeInitPromise){const t=`${e} called before runtime init`;return we.Hv.sendTraceTag(537408077,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,t),new Error(t)}},this.checkRuntimeInitAndThrow=e=>{const t=this.checkRuntimeInit(e);if(t)throw t},this.sendBridgeMessage=e=>{this._bridge&&(e.seq=this._bridgeMessageSequenceId++,this._bridge.sendMessage(JSON.stringify(new fe.vG(e))))},this.onBridgeMessage=e=>{null!=this._bridgeInterceptor?this._bridgeInterceptor.sendMessage(e):this.handleReceivedBridgeMessage(e)},this.sendSessionInitResponseToBridge=(e,t)=>{if(this._sessionConnectParams){const s=this._sessionConnectParams.sessionUrl;this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new fe.uN({origin:this._sessionConnectParams.origin,sessionKey:s.split("/").pop(),sessionUrlBase:s.split("/").slice(0,-1).join("/"),anonymousToken:this._sessionConnectParams.authToken,routingSessionKey:this._sessionConnectParams.routingSessionKey})})}},this.handleReceivedBridgeMessage=e=>{try{const{bridgeId:t,docSessionId:s,message:n}=JSON.parse(e),i=o.h.getTypeNameFor(n);if(we.Hv.sendTraceTag(509092291,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Info,`Received ${i}`),null!=this._sessionCloseReason&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new fe.w9({reason:this._sessionCloseReason})}),Ce.Cs.typeGuard(n)){we.Hv.sendTraceTag(505448338,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Info,`Sending GetHostBridgeSessionResponse to bridge with docSessionId ${s}`);const e=this.checkRuntimeInit("GetHostBridgeSessionRequestMessage");e?this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:n.messageId,error:e.message})}):this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new Ce.f8({messageId:n.messageId,isConnected:this._isSessionConnected,isClosed:this._isSessionClosed})})}else if(fe.n4.typeGuard(n)){const e=((e,o)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.B_({annotationType:n.annotationType,areApologies:!0,ops:[e],cv:o})})}).bind(this),o=this.activateAnnotation({annotationType:n.annotationType,config:n.config,handler:(e,o)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.B_({annotationType:n.annotationType,ops:[e],cv:o})})},apologyHandler:n.sendApologies?e:void 0,forceReturnCachedAnnotations:n.forceReturnCachedAnnotations}).then((e=>new fe.PY({messageId:n.messageId,token:e.token})));this.sendResponseAcrossBridge(o,n,t,s)}else if(Se.x5.typeGuard(n))this.handleGetAnnotationsRequestMessage(t,s,n);else if(fe.Tb.typeGuard(n)){for(const e of n.ops)this.submitOperation({operation:e,cv:n.cv});this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe.YK({messageId:n.messageId})}),we.Hv.sendTraceTag(509092288,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Info,`Responded to ${i}`)}else if(fe.GA.typeGuard(n)){const e=this.releaseAnnotation({token:n.token}).then((e=>new fe.Qq({messageId:n.messageId,lastRelease:e})));this.sendResponseAcrossBridge(e,n,t,s)}else if(fe.g$.typeGuard(n))this.submitCustomMessage({message:n.customMessage}).then((e=>{fe.YK.typeGuard(e)?(e.messageId=n.messageId,we.Hv.sendTraceTag(508432467,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Info,`Responded to ${i}`)):we.Hv.sendTraceTag(508420946,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,"Unexpeced response type from SubmitCustomMessage"),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:e})})).catch((e=>{we.Hv.sendTraceTag(508436636,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,e.message),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:n.messageId,error:e.message})})}));else if(fe.eE.typeGuard(n))this.sendSessionInitResponseToBridge(t,s),this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new fe.wU({serverAuthenticationState:this._serverAuthenticationState})});else if(o.h.matchesTypesFor(n,[Ce.i2.getTypeName()])){const e=this._runtimeInitPromise.then((e=>e.authenticateInteractive())).then((()=>new fe.YK({messageId:n.messageId})));this.sendResponseAcrossBridge(e,n,t,s)}else if(o.h.matchesTypesFor(n,[Ce.og.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Ce.U8({messageId:n.messageId,seedingStatusChangeMessage:e})})}).bind(this);this._runtimeInitPromise.then((t=>{t.setSeedingStatusChangeCallback(e)})).catch((e=>{we.Hv.sendTraceTag(506474634,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Warning,`RuntimeInitPromiseException for message with Id ${n.messageId}`)}))}else if(o.h.matchesTypesFor(n,[Ce.tj.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:s,message:new Ce.Td({messageId:n.messageId,claimsChallengeMessage:e})})}).bind(this);this._runtimeInitPromise.then((t=>{t.setClaimsChallengeCallback(e)})).catch((e=>{we.Hv.sendTraceTag(506987159,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Warning,`RuntimeInitPromiseException for message with Id ${n.messageId}`)}))}else we.Hv.sendTraceTag(509092259,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Warning,`Did not respond to ${i} with Id ${n.messageId}`),this.sendBridgeMessage({bridgeId:t,docSessionId:s,response:new fe._p({messageId:n.messageId,error:"Unknown message type to handle"})})}catch(e){we.Hv.sendTraceTag(509092363,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,e.message),this.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new fe._p({messageId:"unknown",error:e.message})})}},this.handleGetAnnotationsRequestMessage=(e,t,s)=>{const n={request:{annotationType:s.annotationTypes,sourceInfo:s.sourceInfo,configs:s.configs,transientItems:s.transientItems,maxDelayMs:s.maxDelayMs,tryResolveUpstreamDependencies:s.tryResolveUpstreamDependencies,cv:s.cv}};this.getAnnotations(n).then((n=>{var o,i,a;return Me(this,void 0,void 0,(function*(){var r,c,l,u,p,g,h;try{for(o=!0,i=De(n);!(r=(a=yield i.next()).done);o=!0){u=a.value,o=!1;const n=u,i=new Se.rK({content:n.content,errorInfo:null===(p=n.error)||void 0===p?void 0:p.serviceError,warningInfo:null===(g=n.warning)||void 0===g?void 0:g.serviceError}),r=new Ce.wR({messageId:s.messageId,serverResponse:JSON.stringify(i),clientError:null===(h=n.error)||void 0===h?void 0:h.clientError,finalResponse:n.finalResponse});this.sendResponseAcrossBridge(Promise.resolve(r),s,e,t)}}catch(e){c={error:e}}finally{try{o||r||!(l=i.return)||(yield l.call(i))}finally{if(c)throw c.error}}}))}))},this.sendResponseAcrossBridge=(e,t,s,n)=>{e.catch((e=>new fe._p({messageId:t.messageId,error:e.message}))).then((e=>{this.sendBridgeMessage({bridgeId:s,docSessionId:n,response:e}),we.Hv.sendTraceTag(508937624,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Info,`Responded to ${o.h.getTypeNameFor(t)}`)})).catch((e=>{we.Hv.sendTraceTag(508937623,Ne.n.msoulscat_Wac_BrowserGeneral,Ee.k.Error,e.message)}))},this.onBridgeMessageFromInterceptor=e=>{this.handleReceivedBridgeMessage(e)},this.getSessionCallback=e=>this._runtimeInitPromise}getSessionStateCallbackToken(e){return e+"-callback-"+this._connectionStateCallbackToken++}}var xe=s(827774);class Fe{constructor(e){o.h.assign(Fe,this,e)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Fe.getTypeName()])}}Fe.H_={T_:Fe.getTypeName(),B_:Fe.getBaseTypes()};class Ge{constructor(e){o.h.assign(Ge,this,e)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[Ge.getTypeName()])}}Ge.H_={T_:Ge.getTypeName(),B_:Ge.getBaseTypes()};class We{constructor(e){o.h.assign(We,this,e)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[We.getTypeName()])}}We.H_={T_:We.getTypeName(),B_:We.getBaseTypes()};class He{constructor(e){o.h.assign(He,this,e)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[He.getTypeName()])}}He.H_={T_:He.getTypeName(),B_:He.getBaseTypes()};class Ue{constructor(e){o.h.assign(Ue,this,e)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Ue.getTypeName()])}}Ue.H_={T_:Ue.getTypeName(),B_:Ue.getBaseTypes()};var qe=s(784567),Ve=s(3722);class $e{static create(e){const t=new $e(e);return t.activateAnnotation(e.responseType).then((()=>t))}constructor(e){this.config=e,this.nextMessageId=0,this.responseCallbacks=new Map;const t=["session","chats"],s=(0,Ve.v4)(),n="messages",o=[...t,s];this.messagesPath=[...o,n],this.config.session.submitOperations([new qe.Xr({parentPath:t,items:[{id:s,body:e.chat}]}),new qe.Xr({parentPath:o,items:[{id:n,body:new We}]})])}send(e,t){const s=""+this.nextMessageId++;this.responseCallbacks.set(s,t),this.config.session.submitOperations([new qe.Xr({parentPath:this.messagesPath,items:[{id:s,body:e}]})])}close(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)}activateAnnotation(e){return this.config.session.activateAnnotation(e,{callback:e=>{if(qe.Xr.typeGuard(e)&&this.isUnderSubtree(e.parentPath,this.messagesPath))for(const t of e.items){const s=e.parentPath[e.parentPath.length-1],n=this.responseCallbacks.get(s);n&&(n(t.body),this.responseCallbacks.delete(s))}}}).then((({token:e})=>{this.activatedAnnotationToken=e}))}isUnderSubtree(e,t){if(e.length<t.length)return!1;for(let s=0;s<t.length;s++)if(e[s]!==t[s])return!1;return!0}}const je=new class{constructor(){this._augLoopRuntimeManager=new Oe}getAugLoopRuntimeManager(){return this._augLoopRuntimeManager}createSingleItemWorkflow(e){return xe.z.create(e)}createChatHelper(e){return this.getAugLoopRuntimeManager().getSession().then((t=>$e.create(Object.assign({session:t},e))))}createAugLoopRuntimeManager(){return new Oe}}},240633:(e,t,s)=>{s.d(t,{O:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.operationName="",e.prototype.key="",e.prototype.value="",e.prototype.buildVersion="",e.prototype.datafield0="",e.prototype.datafield1="",e.prototype.datafield2="",e.prototype.datafield3="",e.prototype.tagId=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnonymizedOperationEvent"},e}())},241378:(e,t,s)=>{s.d(t,{f:()=>o});var n=s(985002),o=function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_TimeResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},243508:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Operation=void 0;const n=s(386561),o=s(601317),i=Symbol("dataFieldsObject"),a=Symbol("dataFieldsAreDirty"),r=Symbol("_dataFields");class c extends n.OperationEvent{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1),(null==e?void 0:e.dataFields)&&(this.dataFields=e.dataFields)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){this[i]||(this[i]={}),this[i][e]=t,this[a]=!0}setDataFields(e){this[i]||(this[i]={}),this[i]=Object.assign(Object.assign({},this[i]),e),this[a]=!0}start(){return this.startTime=(0,o.now)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,o.now)()-this.startTime)),this}stop(){const e=(0,o.now)();return this.durationMs=Math.round(e-this.startTime),this}addCustomMetric(e){void 0===this.customMetrics&&(this.customMetrics=[]),this.customMetrics.push(e)}getCustomMetrics(){const e=[];if(void 0!==this.customMetrics){const t=e=>[...this.getDimensionNames(),...e.extraDimensions.map((e=>e.name))];for(const s of this.customMetrics){const n={};n[`${this.operationName}.${s.nameSuffix}`]={dimensionNames:()=>t(s),dimensionValues:[...this.getDimensionValues(),...s.extraDimensions.map((e=>e.value))],value:s.value},e.push(n)}}return e}getMetrics(e){var t,s;const n={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":n[this.operationName+".CountV2"]={dimensionNames:c.getOrphanedSessionHealthDimensionNames.bind(c),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":n[this.operationName+".Reason"]={dimensionNames:c.getSessionHealthDimensionNames.bind(c),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(n["Workflow.DurationMs"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},n["Workflow.Count"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const s=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(s)>=0)&&(n[s]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(s=this.options)||void 0===s?void 0:s.metricCount)||e.indexOf(t)>=0)&&(n[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return n}getDimensionNames(){var e,t;let s=c.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){s=s.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(e)}return s}getDimensionValues(){var e,t;const s=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(this.options.metricCustomDimensions[e]);return s}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}t.Operation=c,c.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],c.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"],Object.defineProperty(c.prototype,"dataFields",{get:function(){var e,t;return this[a]&&(this[r]=JSON.stringify(null!==(e=this[i])&&void 0!==e?e:{}),this[a]=!1),void 0!==this[a]?this[r]:null!==(t=this[r])&&void 0!==t?t:""},set:function(e){this[i]=e&&""!==e?JSON.parse(e):{},this[r]=e,this[a]=!1},enumerable:!0,configurable:!0})},248867:(e,t,s)=>{var n,o,i,a,r,c,l;s.d(t,{$O:()=>r,Cu:()=>o,IZ:()=>a,ZE:()=>c,jr:()=>i,kp:()=>n}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(n||(n={})),function(e){e.AnalyzeAudio="AnalyzeAudio",e.GetBatchResult="GetBatchResult"}(o||(o={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Word=1]="Word",e[e.OneNote=2]="OneNote",e[e.Outlook=3]="Outlook",e[e.Unknown=4]="Unknown",e[e.LinkedIn=5]="LinkedIn",e[e.Flipgrid=6]="Flipgrid",e[e.OfficeMobie=7]="OfficeMobie",e[e.OfficeSuite=8]="OfficeSuite",e[e.Teams=9]="Teams"}(i||(i={})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidSubscriptionFromConfig="ErrorInvalidSubscriptionFromConfig",e.ErrorInvalidRegionFromConfig="ErrorInvalidRegionFromConfig",e.ErrorAddSessionFailure="ErrorAddSessionFailure",e.ErrorCreateSpeechSessionBadRequest="ErrorCreateSpeechSessionBadRequest",e.ErrorSpeechHandlerWebSocketFailure="ErrorSpeechHandlerWebSocketFailure",e.ErrorInvalidMessage="ErrorInvalidMessage",e.ErrorWaitAudioTimeout="ErrorWaitAudioTimeout",e.ErrorInitialSilenceTimeout="ErrorInitialSilenceTimeout",e.ErrorInitialBabbleTimeout="ErrorInitialBabbleTimeout",e.ErrorProtobufDeserializationFailure="ErrorProtobufDeserializationFailure",e.ErrorSpeechRecognitionFailure="ErrorSpeechRecognitionFailure",e.ErrorTranslationFailure="ErrorTranslationFailure",e.ErrorFailedToGetSupportedTextLanguages="ErrorFailedToGetSupportedTextLanguages",e.ErrorCustomEndpointTimeout="ErrorCustomEndpointTimeout",e.ErrorAudioAbortError="ErrorAudioAbortError",e.ErrorAudioNotAllowedError="ErrorAudioNotAllowedError",e.ErrorAudioNotFoundError="ErrorAudioNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioOverconstrainedError="ErrorAudioOverconstrainedError",e.ErrorAudioSecurityError="ErrorAudioSecurityError",e.ErrorAudioTypeError="ErrorAudioTypeError",e.ErrorAudioSetupFailure="ErrorAudioSetupFailure",e.ErrorAudioCaptureStalePermission="ErrorAudioCaptureStalePermission",e.ErrorConnectionRetryFailure="ErrorConnectionRetryFailure",e.ErrorWebcamSamplingUnsupportedSpeechMode="ErrorWebcamSamplingUnsupportedSpeechMode",e.ErrorWebcamSetupFailure="ErrorWebcamSetupFailure",e.ErrorWebcamNotFoundError="ErrorWebcamNotFoundError",e.ErrorMultipleWebcamsFound="ErrorMultipleWebcamsFound",e.ErrorMaxConnectionRetryFailureInSession="ErrorMaxConnectionRetryFailureInSession",e.ErrorUnknown="ErrorUnknown"}(a||(a={})),function(e){e.RehearsalDashboardUpdate="RehearsalDashboardUpdate",e.MediaEvent="MediaEvent",e.QualityStatusUpdate="QualityStatusUpdate",e.ConnectionRetry="ConnectionRetry"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Listening=1]="Listening",e[e.Warning_CannotHearYou=2]="Warning_CannotHearYou",e[e.Warning_BackgroundNoise=3]="Warning_BackgroundNoise",e[e.Warning_TooLoud=4]="Warning_TooLoud",e[e.Warning_TooQuiet=5]="Warning_TooQuiet",e[e.Warning_WeakConnection=6]="Warning_WeakConnection",e[e.Warning_SlowConnection=7]="Warning_SlowConnection",e[e.Warning_UnstableConnection=8]="Warning_UnstableConnection",e[e.Warning_ServiceIssue=9]="Warning_ServiceIssue",e[e.Error_CannotHearYou=10]="Error_CannotHearYou",e[e.Error_BackgroundNoise=11]="Error_BackgroundNoise",e[e.Error_TooLoud=12]="Error_TooLoud",e[e.Error_TooQuiet=13]="Error_TooQuiet",e[e.Error_WeakConnection=14]="Error_WeakConnection",e[e.Error_SlowConnection=15]="Error_SlowConnection",e[e.Error_UnstableConnection=16]="Error_UnstableConnection",e[e.Error_ServiceIssue=17]="Error_ServiceIssue"}(c||(c={})),function(e){e.Closed="Closed",e.Closing="Closing",e.Connecting="Connecting",e.Open="Open"}(l||(l={}))},257612:(e,t,s)=>{s.d(t,{D:()=>a});const n="n~",o=/\|\~/g;class i{constructor(){this.count=0,this.measureSums=new Map}}class a{constructor(e,t,s,a,r){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const s=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])s.push(null);else{let i="";"boolean"==typeof e[t]?i="b~":"number"==typeof e[t]&&(i=n),s.push(`${i}${e[t].toString().replace(o,"_")}`)}const a=s.join("|");let r=this.buckets.get(a);if(!r){r=new i,r.traceLevel=e.traceLevel;for(const e of this.avgMeasures)r.measureSums.set(e,0);this.buckets.set(a,r)}r.count++;for(const t of this.avgMeasures)e[t]&&r.measureSums.set(t,r.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const s={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},o=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],i=o[e];0===i.indexOf("b~")?s[t]="b~true"===i:0===i.indexOf(n)?s[t]=parseInt(i.slice(2),10):s[t]=i}for(const t of this.avgMeasures)s[t]=Math.round(e.measureSums.get(t)/e.count);this.log(s,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=s,this.avgMeasures=a,r>0&&(this.interval=setInterval(this.flush,1e3*r))}}},270314:(e,t,s)=>{s.d(t,{l:()=>n});class n{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){n.logIntervalError=e}put(e,t,s,n,o,i,a){if(null==s||s<=0)throw new Error("Cache timeout must be a positive number");(null==o||o<=0)&&(o=this.options.idleDurationMs);const r={value:t,lastUsed:o?Date.now():void 0,expire:s+Date.now(),idleDurationMs:o,expireCallback:n,expiringTriggerTime:i+Date.now(),expiringCallback:a};return this.cache.set(e,r),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,s)=>{e(t.value,s)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,s)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(s),void(this.options.idleCallback&&this.options.idleCallback(s,t.value));t.expire<e&&(this.del(s),t.expireCallback&&t.expireCallback(s,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(s,t.value),t.expiringCallback=void 0)}catch(e){n.logIntervalError&&n.logIntervalError(e)}}))}}},271845:(e,t,s)=>{var n,o,i,a,r,c,l,u;s.d(t,{T8:()=>n}),function(e){e[e.EntityClicked=0]="EntityClicked",e[e.RelatedEntityClicked=1]="RelatedEntityClicked",e[e.EntityRefinerClicked=2]="EntityRefinerClicked",e[e.EntityActionTaken=3]="EntityActionTaken",e[e.PreviewOpen=4]="PreviewOpen",e[e.PreviewClose=5]="PreviewClose",e[e.OptionsMenuOpen=6]="OptionsMenuOpen",e[e.OptionsMenuClose=7]="OptionsMenuClose",e[e.MouseHover=8]="MouseHover"}(n||(n={})),function(e){e[e.Suggestions=0]="Suggestions",e[e.Query=1]="Query",e[e.Answers=2]="Answers"}(o||(o={})),function(e){e[e.File=0]="File",e[e.Site=1]="Site",e[e.App=2]="App"}(i||(i={})),function(e){e[e.Link=0]="Link"}(a||(a={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.Grid=2]="Grid"}(r||(r={})),function(e){e[e.Files=0]="Files",e[e.Videos=1]="Videos",e[e.Images=2]="Images",e[e.Office=3]="Office"}(c||(c={})),function(e){e[e.Visible=0]="Visible",e[e.Partial=1]="Partial",e[e.Hidden=2]="Hidden"}(l||(l={})),function(e){e[e.Entity=0]="Entity",e[e.Group=1]="Group"}(u||(u={}))},281076:(e,t,s)=>{var n,o,i;s.d(t,{HS:()=>i,OD:()=>o,WI:()=>n}),function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(n||(n={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(o||(o={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(i||(i={}))},282144:(e,t,s)=>{s.d(t,{$9:()=>a,Z5:()=>o,tE:()=>i,zV:()=>r});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsRequest"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GraphSearch_GraphSearchSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDelete"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},282699:(e,t,s)=>{var n,o;s.d(t,{F:()=>n,b:()=>o}),function(e){e[e.Client=0]="Client",e[e.Server=1]="Server"}(n||(n={})),function(e){e.None="None",e.RecentlyAccessed="RecentlyAccessed",e.Frequent="Frequent",e.Trending="Trending",e.Uploaded="Uploaded"}(o||(o={}))},297330:(e,t,s)=>{s.d(t,{G0:()=>l,Kx:()=>c,fE:()=>r});var n=s(774162),o=s(521409),i=s(301520),a=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};function r(e){let t="";if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0?t="Error: IE lacks necessary support":"undefined"==typeof Promise?t="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(t="Error: WASM is not supported")}else t="Error: No window userAgent";return""!=t&&(e.resultDescription=t,o.tG.info(540406806,o.nh.CoreDefault,e.stop()),!0)}class c{constructor(e,t,s){this.session=e,this.onnxObject=s,this.modelName=t}static create(e,t,s){return a(this,void 0,void 0,(function*(){const n=new i.I({operationName:"CreateModelForInferencing",success:!0,resourceId:t});return n.start(),s[e]?(n.resultDescription="Model already existed",o.tG.info(509699716,o.nh.CoreDefault,n.stop()),s[e]):s[e]=this.getInferenceSession(s).create(e).then((e=>(o.tG.info(540406807,o.nh.CoreDefault,n.stop()),new c(e,t,s)))).catch((e=>{throw n.resultDescription=`Error: ${e}`,o.tG.info(540406808,o.nh.CoreDefault,n.stop()),e}))}))}static getInferenceSession(e){if(null==e?void 0:e.InferenceSession)return e.InferenceSession;throw new Error("InferenceSession is not defined")}run(e){var t;return a(this,void 0,void 0,(function*(){const s=new i.I({operationName:"RunModelForInferencing",success:!0,resourceId:this.modelName});if(s.start(),null===(t=this.onnxObject)||void 0===t?void 0:t.Tensor){const t=e.getInputs(),n={};return Object.keys(t).forEach((e=>{const s=t[e];if(Array.isArray(s.values)&&s.values.length>0&&"boolean"==typeof s.values[0]){const t=new Uint8Array(s.values);n[e]=new this.onnxObject.Tensor(t,s.dimensions)}else n[e]=new this.onnxObject.Tensor(s.values,s.dimensions)})),this.session.run(n).then((e=>(o.tG.info(540406809,o.nh.CoreDefault,s.stop()),new u(e)))).catch((e=>{s.resultDescription=`Problem running model. ${e.message}`,o.tG.info(540406810,o.nh.CoreDefault,s.stop())}))}throw s.resultDescription="Unable to run model. Tensor not defined",o.tG.info(540406811,o.nh.CoreDefault,s.stop()),new Error("Tensor is not defined")}))}}class l{constructor(){this.map={}}static create(){return new l}getInputs(){return this.map}add(e,t,s){return this.map[e]={dimensions:t,values:s},this}}class u{constructor(e){for(const t of Object.keys(e))this[t]=new p(t,e[t])}}class p{constructor(e,t){this.resultName=e,this.result=t}name(){return this.resultName}outputType(){switch(this.result.type){case"string":return n.Z.Strings;case"int8":return n.Z.Int8s;case"int16":return n.Z.Int16s;case"int32":return n.Z.Int32s;case"bool":return n.Z.Booleans;case"uint8":return n.Z.UnsignedInt8s;case"uint16":return n.Z.UnsignedInt16s;case"uint32":return n.Z.UnsignedInt32s;case"float32":return n.Z.Float32s;case"float64":return n.Z.Float64s;default:throw new Error(`The output type ${this.result.type} is not supported.`)}}dimensions(){return this.result.dims}asBooleans(){if(this.outputType()===n.Z.Booleans)return this.result.data.map((e=>!!e));throw new Error(`asBooleans() was called; however, outputType() is ${this.outputType()}, not Type.Booleans.`)}asFloat32s(){if(this.outputType()===n.Z.Float32s)return this.result.data;throw new Error(`asFloat32s() was called; however, outputType() is ${this.outputType()}, not Type.Float32s.`)}asFloat64s(){if(this.outputType()===n.Z.Float64s)return this.result.data;throw new Error(`asFloat64s() was called; however, outputType() is ${this.outputType()}, not Type.Float64s.`)}asInt8s(){if(this.outputType()===n.Z.Int8s)return this.result.data;throw new Error(`asInt8s() was called; however, outputType() is ${this.outputType()}, not Type.Int8s.`)}asInt16s(){if(this.outputType()===n.Z.Int16s)return this.result.data;throw new Error(`asInt16s() was called; however, outputType() is ${this.outputType()}, not Type.Int16s.`)}asInt32s(){if(this.outputType()===n.Z.Int32s)return this.result.data;throw new Error(`asInt32s() was called; however, outputType() is ${this.outputType()}, not Type.Int32s.`)}asStrings(){if(this.outputType()===n.Z.Strings)return this.result.data;throw new Error(`asStrings() was called; however, outputType() is ${this.outputType()}, not Type.Strings.`)}asUnsignedInt8s(){if(this.outputType()===n.Z.UnsignedInt8s)return this.result.data;throw new Error(`asUnsignedInt8s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt8s.`)}asUnsignedInt16s(){if(this.outputType()===n.Z.UnsignedInt16s)return this.result.data;throw new Error(`asUnsignedInt16s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt16s.`)}asUnsignedInt32s(){if(this.outputType()===n.Z.UnsignedInt32s)return this.result.data;throw new Error(`asUnsignedInt32s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt32s.`)}}},297915:function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,o)}:function(e,t,s,n){void 0===n&&(n=s),e[n]=t[s]}),o=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),o(s(408165),t),o(s(598033),t)},301520:(e,t,s)=>{s.d(t,{I:()=>c});var n=s(109652),o=s(230529);const i=Symbol("dataFieldsObject"),a=Symbol("dataFieldsAreDirty"),r=Symbol("_dataFields");class c extends n.A{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1),(null==e?void 0:e.dataFields)&&(this.dataFields=e.dataFields)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){this[i]||(this[i]={}),this[i][e]=t,this[a]=!0}setDataFields(e){this[i]||(this[i]={}),this[i]=Object.assign(Object.assign({},this[i]),e),this[a]=!0}start(){return this.startTime=(0,o.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,o.t)()-this.startTime)),this}stop(){const e=(0,o.t)();return this.durationMs=Math.round(e-this.startTime),this}addCustomMetric(e){void 0===this.customMetrics&&(this.customMetrics=[]),this.customMetrics.push(e)}getCustomMetrics(){const e=[];if(void 0!==this.customMetrics){const t=e=>[...this.getDimensionNames(),...e.extraDimensions.map((e=>e.name))];for(const s of this.customMetrics){const n={};n[`${this.operationName}.${s.nameSuffix}`]={dimensionNames:()=>t(s),dimensionValues:[...this.getDimensionValues(),...s.extraDimensions.map((e=>e.value))],value:s.value},e.push(n)}}return e}getMetrics(e){var t,s;const n={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":n[this.operationName+".CountV2"]={dimensionNames:c.getOrphanedSessionHealthDimensionNames.bind(c),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":n[this.operationName+".Reason"]={dimensionNames:c.getSessionHealthDimensionNames.bind(c),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(n["Workflow.DurationMs"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},n["Workflow.Count"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const s=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(s)>=0)&&(n[s]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(s=this.options)||void 0===s?void 0:s.metricCount)||e.indexOf(t)>=0)&&(n[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return n}getDimensionNames(){var e,t;let s=c.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){s=s.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(e)}return s}getDimensionValues(){var e,t;const s=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)s.push(this.options.metricCustomDimensions[e]);return s}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}c.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],c.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"],Object.defineProperty(c.prototype,"dataFields",{get:function(){var e,t;return this[a]&&(this[r]=JSON.stringify(null!==(e=this[i])&&void 0!==e?e:{}),this[a]=!1),void 0!==this[a]?this[r]:null!==(t=this[r])&&void 0!==t?t:""},set:function(e){this[i]=e&&""!==e?JSON.parse(e):{},this[r]=e,this[a]=!1},enumerable:!0,configurable:!0})},315730:(e,t,s)=>{s.d(t,{G:()=>i});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SuggestionAPISignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotSubstrateIntegration_SubstrateSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},325426:(e,t,s)=>{s.d(t,{G:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotPluginConfigBrokering_CopilotPluginSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},330743:(e,t,s)=>{s.d(t,{wB:()=>B});var n=s(738460),o=s(178058),i=s(473257),a=s(547942),r=s(184175),c=s(8165),l=s(633522),u=s(985002),p=s(629271),g=s(182755);class h{constructor(){this.messageCallbackRegistrationReady=void 0}sendMessage(e){if("undefined"==typeof OfficeFirstParty)throw new Error("OfficeFirstParty global not available in SDX running AL");if(!this.messageCallbackRegistrationReady)throw new Error("MessageReceivedCallback not registered");this.messageCallbackRegistrationReady.then((()=>{OfficeFirstParty.AugLoop.SendMessage(e)})).catch((e=>{throw e}))}registerMessageReceivedCallback(e){if("undefined"==typeof OfficeFirstParty)throw new Error("OfficeFirstParty global not available in SDX running AL");if(this.messageCallbackRegistrationReady)throw new Error("MessageReceivedCallback already registered");this.messageCallbackRegistrationReady=OfficeFirstParty.AugLoop.onHostMessageReceived((t=>e(t)))}}class d{sendTelemetryEvent(e){if("undefined"==typeof Office)throw new Error("Office global not available in SDX running AL");Office.sendTelemetryEvent(e)}}class m{constructor(){this.telemetryLogger=new g.M,this.telemetryLogger.addSink(new d)}convertTelemetryEvent(e,t,s,n,o,i,a){const r={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:this.convertDataFields(s),eventFlags:{dataCategories:6,diagnosticLevel:110,samplingPolicy:1}};return n&&(r.eventContract={name:n,dataFields:this.convertDataFields(o,n.split(".").slice(-1)[0])}),r}convertDataFields(e,t){const s=[];for(const n of Object.keys(e)){if(void 0===e[n]||null===e[n])continue;const o={name:t?`${t}.${n}`:n,dataType:this.getDataFieldType(e[n]),value:e[n],classification:4};s.push(o)}return s}getDataFieldType(e){return"string"==typeof e?0:"boolean"==typeof e?1:"number"==typeof e?2:void 0}sendTelemetryEvent(e,t,s,n,o,i,a,r){this.telemetryLogger.sendTelemetryEvent(this.convertTelemetryEvent(e,t,s,n,o,a,r))}sendDiagnosticTrace(e,t,s){}addCustomSync(e){this.telemetryLogger.addSink(e)}}var y=s(3722),T=s(521409),f=s(301520),_=s(469408),C=s(93440),S=s.n(C);class A{constructor(e){this.queue=void 0,this.options={},this.maxSize=void 0,this.options=e,this.maxSize=this.options&&this.options.maxSize?this.options.maxSize:void 0,this.queue=new(S())}push(e){this.queue.push(e),this.maxSize&&this.queue.length>this.maxSize&&this.queue.shift()(new Error("TaskQueue Max size reached."))}processAll(){for(;this.queue.length>0;)this.queue.shift()(void 0)}}var v=s(691891),I=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))},w=function(e){return this instanceof w?(this.v=e,this):new w(e)},N=function(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=s.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(s,n){i.push([e,t,s,n])>1||r(e,t)}))})}function r(e,t){try{(s=o[e](t)).value instanceof w?Promise.resolve(s.value.v).then(c,l):u(i[0][2],s)}catch(e){u(i[0][3],e)}var s}function c(e){r("next",e)}function l(e){r("throw",e)}function u(e,t){e(t),i.shift(),i.length&&r(i[0][0],i[0][1])}};const E="cst-";let b=(0,y.v4)(),k=!1,M=null;const L=e=>{k||(M=new n.MP(e),T.tG.addLogger(M),k=!0)},B=(e,t)=>{L(new m);const s=P("GetAugLoopSession",!0,e),n=new x(e,new h,t);return n.initialize().catch((()=>{})),T.tG.info(505442513,T.nh.CoreDefault,s.stop()),n};let D=!1;const P=(e,t,s)=>{const n=new f.I({operationName:e,ariaNamespace:"Office_AugLoop_Client_SDX",clientDocSessionId:s,dimension0:b}).start();return n.success=t,n},R=(e,t)=>{t?(e.resultDescription=t,e.success=!1,T.tG.error(505201632,T.nh.CoreDefault,e.stop())):T.tG.info(505201631,T.nh.CoreDefault,e.stop())};class O extends Error{constructor(e){super(e),Object.setPrototypeOf(this,O.prototype)}}class x{constructor(e,t,s){this.sessionOptions=void 0,this.docSessionId="",this.messageBridge=void 0,this.activationsMapTypeToTokens=new Map,this.activationsMapTokenToCallback=new Map,this.activationsMapTokenToApologyCallback=new Map,this.waitingForResponse=new Map,this.messageId=0,this.customMessageSeq=0,this.activationToken=0,this.connectParams=void 0,this.seedGroupSize=0,this.connectionPendingTaskQueue=new A({maxSize:1e4}),this.sessionCloseMessages=[],this.sessionCloseCallbacks=new Map,this.sessionConnectCallbacks=new Map,this.sessionReconnectCallbacks=new Map,this.sessionDisconnectCallbacks=new Map,this.sessionCallbackToken=0,this.currentAuthenticationState=a.f.Pending,this.serverAuthenticationStateChangeCallbacks=[],this.claimsChallengeCallbacks=new Map,this.seedingStatusChangeCallbacks=new Map,this.internalSessionNumber=0,this.getAnnotationsResponseQueues=new Map,x.internalSessionCounter++,this.internalSessionNumber=x.internalSessionCounter,this.sessionOptions=s,D||(T.tG.addAggregator((0,n.cS)("Operation","operationName",["ProcessMessage","SubmitOperations","SubmitCustomMessage","SendLargeBinaryDataMessage","SendBinaryStreamUploadMessage","RequestBinaryData","EnsureConnection","KeepAlive"],30)),D=!0),this.docSessionId=e,this.messageBridge=t,this.prevMessageInfo={sequenceId:-1},t.registerMessageReceivedCallback((e=>{const t=JSON.parse(e),s=this.createLoggingOperation("ProcessMessage",!0);if(!t)return s.dimension2="ParseFailed",s.success=!1,void T.tG.info(509088289,T.nh.CoreDefault,s.stop());const n=t.message||t.response;if(this.verifyMessageOrder(t,n),!(t.bridgeId!=b&&"*"!=t.bridgeId||t.docSessionId!=this.docSessionId&&"*"!=t.docSessionId)){if(!n)return s.dimension2="NoMessageOrResponse",s.success=!1,void T.tG.info(509088288,T.nh.CoreDefault,s.stop());r.uN.typeGuard(n)?this.handleSessionInitResponse(n):r.B_.typeGuard(n)?this.handleAnnotationResults(n,s):r.w9.typeGuard(n)?this.handleSessionCloseMessage(n):r.gy.typeGuard(n)?this.handleSessionConnectMessage(n):r.lj.typeGuard(n)?this.handleSessionReconnectMessage(n):r.eG.typeGuard(n)?this.handleSessionDisconnectMessage(n):r.wU.typeGuard(n)?this.handleServerAuthenticationStateChange(n):c.Td.typeGuard(n)?this.handleFireClaimsChallengeCallback(n):c.U8.typeGuard(n)?this.handleFireSeedingStatusChangeCallback(n):c.wR.typeGuard(n)?this.handleGetAnnotationsResponse(n,s):r.YK.typeGuard(n)?this.handleResponse(n,s):s.dimension2="UnknownType",s.resourceId=u.h.getTypeNameFor(n),T.tG.info(509088287,T.nh.CoreDefault,s.stop())}}))}initialize(){const e=P("Initialize",!0,this.docSessionId);return new Promise(((t,s)=>{const n=new c.Cs({docSessionId:this.docSessionId,messageId:this.getMessageId()});this.sendMessageWithOpAsync("GetHostBridgeSession",n).then((s=>{this.handleGetHostBridgeSessionResponse(s),T.tG.info(505442511,T.nh.CoreDefault,e.stop()),t(this)})).catch((s=>{if(!(s instanceof O))throw T.tG.error(505442510,T.nh.CoreDefault,e.stop()),s;e.dimension2="UnknownMessageTypeError",T.tG.info(505251788,T.nh.CoreDefault,e.stop()),this.handleGetHostBridgeSessionResponse(void 0),t(this)}))}))}getCallbackToken(e){return e+"-callback-"+this.internalSessionNumber+"-"+this.sessionCallbackToken++}createLoggingOperation(e,t){return P(e,t,this.docSessionId)}handleFireClaimsChallengeCallback(e){if(!e.messageId||!e.claimsChallengeMessage)return;const t=this.claimsChallengeCallbacks.get(e.messageId);t&&t(e.claimsChallengeMessage)}handleGetHostBridgeSessionResponse(e){e&&(this.isClosed=e.isClosed,this.isConnected=e.isConnected);const t=new r.eE({bridgeId:b,clientMetadata:void 0,protocolVersion:2,messageId:this.getMessageId()});this.sendMessageWithOp("SessionInit",t)}handleSessionInitResponse(e){if(this.connectParams={authToken:e.anonymousToken,origin:e.origin,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,isSeedingRequired:!1,routingSessionKey:e.routingSessionKey},M){const e=this.connectParams.sessionUrl.substring(this.connectParams.sessionUrl.lastIndexOf("/")+1);M.setServerSessionKey(e)}this.connectionPendingTaskQueue.processAll()}handleGetAnnotationsResponse(e,t){var s,n;if(!e.messageId)return t.resultDescription="NoMessageId",void(t.success=!1);const i=JSON.parse(e.serverResponse),a=this.getAnnotationsResponseQueues.get(e.messageId);null==a||a.queue.push({content:i.content,error:{serviceError:i.errorInfo,clientError:e.clientError},warning:{serviceError:i.warningInfo},finalResponse:e.finalResponse}),null===(s=null==a?void 0:a.responseReceived)||void 0===s||s.call(a,!0);const r=(0,o.Kh)(i);t.cv=null==i?void 0:i.cv,t.resultSignature="CallbackInHostBridge",t.setDataFields({FirstUserPerceivedResponse:r,AnnotationType:null===(n=null==i?void 0:i.annotationType)||void 0===n?void 0:n.toString(),FinalResponse:e.finalResponse}),t.success=!0}handleResponse(e,t){return e.messageId?this.waitingForResponse.has(e.messageId)?(this.waitingForResponse.get(e.messageId)(e),this.waitingForResponse.delete(e.messageId),void(t.success=!0)):(t.resultDescription="NoResponseCallback",void(t.success=!1)):(t.resultDescription="NoMessageId",void(t.success=!1))}handleAnnotationResults(e,t){const s=Date.now();let n=0;t.resultSignature=e.annotationType;const i=this.activationsMapTypeToTokens.get(e.annotationType);if(t.dimension1=e.ops.length.toString(),i)for(const t of i)for(const s of e.ops){const o=e.areApologies?this.activationsMapTokenToApologyCallback.get(t):this.activationsMapTokenToCallback.get(t);o&&(o.callback(s,e.cv),n++)}t.success=!0,t.dimension2=n.toString(),t.dimension3=`AreApologies: ${e.areApologies}`,n>0&&(0,o.M4)(e,s,"CallbackInHostBridge",!1,this.createLoggingOperation("AugloopClientPerfTracker",!0))}handleSessionCloseMessage(e){this.isClosed=!0,this.sessionCloseMessages.push(e),this.sessionCloseCallbacks.forEach(((t,s)=>{t(e)}))}handleSessionConnectMessage(e){if(this.isConnected=!0,this.connectParams={authToken:e.authToken,origin:e.origin,sessionUrl:e.sessionUrl,isSeedingRequired:e.isSeedingRequired,routingSessionKey:e.routingSessionKey},M){const e=this.connectParams.sessionUrl.substring(this.connectParams.sessionUrl.lastIndexOf("/")+1);M.setServerSessionKey(e)}e.isSeedingRequired&&(this.seedGroupSize=0),this.sessionConnectCallbacks.forEach(((t,s)=>{t(e.isSeedingRequired,e.sessionUrl,e.origin,e.authToken,e.routingSessionKey)})),this.connectionPendingTaskQueue.processAll()}handleSessionReconnectMessage(e){this.sessionReconnectCallbacks.forEach(((e,t)=>{e()}))}handleSessionDisconnectMessage(e){this.isConnected=!1,this.connectParams=void 0,this.sessionDisconnectCallbacks.forEach(((t,s)=>{t(e.error)}))}handleServerAuthenticationStateChange(e){this.currentAuthenticationState!=e.serverAuthenticationState&&(this.currentAuthenticationState=e.serverAuthenticationState,this.serverAuthenticationStateChangeCallbacks.forEach((t=>{t(e.serverAuthenticationState)})))}handleFireSeedingStatusChangeCallback(e){if(!e.messageId||!e.seedingStatusChangeMessage)return;const t=this.seedingStatusChangeCallbacks.get(e.messageId);t&&t(e.seedingStatusChangeMessage)}getMessageId(){return"cl-"+this.internalSessionNumber+"-"+this.messageId++}getNextCustomMessageSeq(){return this.internalSessionNumber+"-"+this.customMessageSeq++}getNextActivationToken(){return"ac-"+b+"-"+this.internalSessionNumber+"-"+this.activationToken++}getServerAuthenticationState(){throw new Error("Method not implemented.")}registerLocalWorkflow(e){throw new Error("Method not implemented.")}registerLocalWorkflows(e){throw new Error("Method not implemented.")}isLocalWorkflowRegistered(e){throw new Error("Method not implemented.")}activateAnnotation(e,t,s){const n=this.getMessageId(),o=this.getNextActivationToken(),i=this.createLoggingOperation("ActivateAnnotation",!0);i.resourceId=e,i.dimension1=`ApologyCallback: ${void 0!==(null==t?void 0:t.apologyCallback)}`,i.setDataField("StartTimestamp",Date.now());const a=new Promise(((s,a)=>{this.waitingForResponse.set(n,(n=>r.PY.typeGuard(n)?(t&&(this.activationsMapTypeToTokens.has(e)||this.activationsMapTypeToTokens.set(e,new Set),t.callback&&this.activationsMapTokenToCallback.set(n.token,{annotationType:e,callback:t.callback}),t.apologyCallback&&this.activationsMapTokenToApologyCallback.set(n.token,{annotationType:e,callback:t.apologyCallback}),(t.callback||t.apologyCallback)&&this.activationsMapTypeToTokens.get(e).add(n.token)),i.resultDescription=`Activated annotation with token ${n.token}`,T.tG.info(509088286,T.nh.CoreDefault,i.stop()),void s(new r.PY({token:n.token}))):r._p.typeGuard(n)?(this.activationsMapTypeToTokens.get(e).delete(o),this.activationsMapTokenToCallback.delete(o),this.activationsMapTokenToApologyCallback.delete(o),i.success=!1,i.resultDescription=n.error,T.tG.error(509088285,T.nh.CoreDefault,i.stop()),void a(new Error(n.error))):(i.success=!1,i.resultDescription="Unknown Response",T.tG.error(509088284,T.nh.CoreDefault,i.stop()),void a(new Error("Unknown Response")))))})),c=new r.n4({annotationType:e,token:o,config:t?t.config:void 0,bridgeId:b,messageId:n,forceReturnCachedAnnotations:t?t.forceReturnCachedAnnotations:void 0,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)});return this.sendMessage(c,{hostConfig:s}),a}updateAnnotationConfig(e,t){throw new Error("Method not implemented.")}releaseAnnotation(e){const t=this.createLoggingOperation("ReleaseAnnotation",!0);if(t.dimension2=e,!this.activationsMapTokenToCallback.has(e)&&!this.activationsMapTokenToApologyCallback.has(e)){const s="AnnotationActivation already released:"+e;return t.success=!1,t.resultDescription=s,T.tG.info(508937629,T.nh.CoreDefault,t.stop()),Promise.reject(new Error(s))}let s=this.activationsMapTokenToCallback.get(e);s||(s=this.activationsMapTokenToApologyCallback.get(e)),s&&this.activationsMapTypeToTokens.get(s.annotationType).delete(e),this.activationsMapTokenToCallback.delete(e),this.activationsMapTokenToApologyCallback.delete(e);const n=this.getMessageId(),o=new r.GA({token:e,messageId:n}),i=new Promise(((e,s)=>{this.waitingForResponse.set(n,(n=>r.Qq.typeGuard(n)?(T.tG.info(508937628,T.nh.CoreDefault,t.stop()),void e(n.lastRelease)):r._p.typeGuard(n)?(t.success=!1,t.resultDescription=n.error,T.tG.error(508937627,T.nh.CoreDefault,t.stop()),void s(new Error(n.error))):(t.success=!1,t.resultDescription="Unknown Response",T.tG.error(508937626,T.nh.CoreDefault,t.stop()),void s(new Error("Unknown Response")))))}));return this.sendMessage(o),i}setAnnotationState(e,t,s){throw new Error("Method not implemented.")}setAnnotationMetadata(e,t,s){throw new Error("Method not implemented.")}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){const s=Date.now(),n=new r.Tb({bridgeId:b,ops:e,messageId:this.getMessageId(),cv:t});this.sendMessageWithOpAsync("SubmitOperations",n).catch((e=>{})),(0,o.BG)(e,t,s,"SubmitInHostBridge",this.createLoggingOperation("AugloopClientPerfTracker",!0))}submitSeedOperations(e,t){if(!this.sessionOptions.allowSeeding)throw new Error("Method not implemented.");const s=new r.Tb({bridgeId:b,ops:e,messageId:this.getMessageId(),cv:t,seq:0});this.sendMessageWithOpAsync("SubmitSeedOperations",s).catch((e=>{}))}submitSeedGroupOperations(e,t,s){if(!this.sessionOptions.allowSeeding)throw new Error("Method not implemented.");this.seedGroupSize++;const n=new r.Tb({bridgeId:b,ops:e,messageId:this.getMessageId(),groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0,cv:s,seq:0});this.sendMessageWithOpAsync("SubmitSeedGroupOperations",n).catch((e=>{}))}submitCustomMessage(e){const t=this.createLoggingOperation("SubmitCustomMessage",!0),s=e.messageId;e.messageId=e.messageId?E+e.messageId:E+this.getNextCustomMessageSeq();const n=this.getMessageId(),o=new Promise(((e,o)=>{this.waitingForResponse.set(n,(n=>r.YK.typeGuard(n)?(t.resultDescription="Got response for submitted custom message",T.tG.info(508420945,T.nh.CoreDefault,t.stop()),n.messageId=s,void e(n)):r._p.typeGuard(n)?(t.success=!1,t.resultDescription=n.error,T.tG.error(508420944,T.nh.CoreDefault,t.stop()),void o(new Error(n.error))):(t.success=!1,t.resultDescription="Unknown Response",T.tG.error(508420943,T.nh.CoreDefault,t.stop()),void o(new Error("Unknown Response")))))}));let i;u.h.matchesTypesFor(e,[r.VR.getTypeName()])&&(i=_.r.serialize(e));const a=new r.g$({messageId:n,customMessage:e,binaryMessage:i?Array.from(i):void 0});return this.sendMessage(a),T.tG.info(508436875,T.nh.CoreDefault,t.stop()),o}sendLargeBinaryDataMessageInternal(e,t,s,n){(0,i.A2)(e,t,s,n)}sendBlobUploadStreamMessageInternal(e,t,s,n){(0,i.wM)(e,t,s,n)}submitLargeBinaryDataMessage(e){const t=this.createLoggingOperation("SendLargeBinaryDataMessage",!0),s=new Promise(((s,n)=>{this.connectionPendingTaskQueue.push((o=>{o?n(o):this.sendLargeBinaryDataMessageInternal(this.connectParams,e,t,((e,t)=>{e?n(new Error(e.error)):s(t)}))}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),s}submitBinaryStreamUploadMessage(e){const t=this.createLoggingOperation("sendBinaryStreamUploadMessage",!0),s=new Promise(((s,n)=>{this.connectionPendingTaskQueue.push((o=>{o?n(o):this.sendBlobUploadStreamMessageInternal(this.connectParams,e,t,((e,t)=>{e?n(new Error(e.error)):s(t)}))}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),s}activateServerRequestResponse(e,t,s){return I(this,void 0,void 0,(function*(){yield this.activateAnnotation(e,{callback:(e,s)=>{for(const s of e.items){const e=P("ActivateServerRequestResponse",!0,this.docSessionId),n=s.body;if(!(null==n?void 0:n.workflowExecutionCorrelation)){const t="Received annotation without workflowExecutionCorrelation";throw R(e,t),new Error(t)}let o=!1;const i=(t,s)=>{if(o){const t="Final response has already been sent for this annotation";throw R(e,t),new Error(t)}o=void 0===s||s;const i=new r.iT({workflowExecutionCorrelation:n.workflowExecutionCorrelation,finalResponse:o,content:t}),a=this.submitCustomMessage(i).catch((t=>{throw R(e,`Error submitting response: ${t.message}`),t}));return s&&R(e),a};null==t||t.onAnnotationCallback(n,i).catch((t=>{R(e,`Error in onAnnotationCallback: ${t.message}`)}))}}},s)}))}fetchBlobFromRefInternal(e,t,s,n){(0,i.ZC)(e,t,s,n)}requestBinaryDataForBlob(e){const t=this.createLoggingOperation("RequestBinaryData",!0);if(e.data)return T.tG.info(507646876,T.nh.CoreDefault,t.stop()),Promise.resolve(e.data);if(!e.dataPointer||e.dataPointer.refType===p.J1.None){const e="Blob does not have a data pointer";return t.success=!1,t.resultDescription=e,T.tG.error(507646875,T.nh.CoreDefault,t.stop()),Promise.reject(new Error(e))}const s=new Promise(((s,n)=>{this.connectionPendingTaskQueue.push((o=>{o?n(o):this.fetchBlobFromRefInternal(this.connectParams,e.dataPointer,((e,t)=>{e?n(e):s(t)}),t)}).bind(this))}));return this.connectParams&&this.connectionPendingTaskQueue.processAll(),s}requestCacheDump(e){throw new Error("Method not implemented.")}forceReconnect(e){throw new Error("Method not implemented.")}close(){const e=this.createLoggingOperation("CloseSession",!0);this.activationsMapTokenToCallback.forEach(((t,s)=>{this.releaseAnnotation(s).catch((t=>{e.resultDescription+=" "+t.message,e.success=!1}))})),this.activationsMapTokenToApologyCallback.size>0&&this.activationsMapTokenToApologyCallback.forEach(((t,s)=>{this.releaseAnnotation(s).catch((t=>{e.resultDescription+=" ApologyCallbacks "+t.message,e.success=!1}))})),T.tG.info(508937625,T.nh.CoreDefault,e.stop()),T.tG.flushAggregators(!0)}authenticateInteractive(e){return I(this,void 0,void 0,(function*(){const t=new c.i2({messageId:this.getMessageId(),forceUserPrompt:null==e?void 0:e.forceUserPrompt});yield this.sendMessageWithOpAsync("AuthenticateInteractive",t)}))}setConnectCallback(e){const t=this.getCallbackToken("connect");return e&&this.sessionConnectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getCallbackToken("disconnect");return e&&this.sessionDisconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getCallbackToken("reconnect");return e&&this.sessionReconnectCallbacks.set(t,e),t}setSessionCloseCallback(e){const t=this.getCallbackToken("close");return e&&(this.sessionCloseCallbacks.set(t,e),this.isClosed&&this.sessionCloseMessages.forEach((t=>{e(t)}))),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.sessionReconnectCallbacks)||t(this.sessionDisconnectCallbacks)||t(this.sessionConnectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallbacks.push(e),e(this.currentAuthenticationState)}setClaimsChallengeCallback(e){if(!e)return;const t=this.getCallbackToken("claimsChallenge");this.claimsChallengeCallbacks.set(t,e);const s=new c.tj({messageId:t});this.sendMessageWithOp("SetClaimsChallengeCallback",s)}setSeedingStatusChangeCallback(e){if(!e)return;const t=this.getCallbackToken("seedingStatus");this.seedingStatusChangeCallbacks.set(t,e);const s=new c.og({messageId:t});this.sendMessageWithOp("SetSeedingStatusChangeCallback",s)}getConnectParams(){return this.connectParams}setOfflineMode(){throw new Error("Method not available.")}getAnnotations(e,t){var s,n;const o=this.createLoggingOperation("GetAnnotations",!0);o.cv=e.cv,o.resultSignature="SubmitInHostBridge",o.resourceId=`${e.sourceInfo.featureId}-${e.sourceInfo.entryPoint}`,o.setDataFields({AnnotationType:null===(s=e.annotationType)||void 0===s?void 0:s.toString(),MaxDelayMs:null===(n=e.maxDelayMs)||void 0===n?void 0:n.toString()});const i=new v.x5({annotationTypes:e.annotationType,configs:e.configs,transientItems:e.transientItems,maxDelayMs:e.maxDelayMs,correlationInfo:{cvString:e.cv},messageId:this.getMessageId(),tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,sourceInfo:e.sourceInfo,cv:e.cv});this.getAnnotationsResponseQueues.set(i.messageId,{queue:[]}),this.sendMessage(i);const a=this;let r=!1;const c=new Promise(((e,s)=>{if(t){const n=t.cancel.bind(t);t.cancel=()=>{r?e():(n(),s(new Error(x.requestCancelledError)))}}}));return{[Symbol.asyncIterator](){return N(this,arguments,(function*(){for(;!r;)try{const e=a.getAnnotationsResponseQueues.get(i.messageId);0===(null==e?void 0:e.queue.length)&&(yield w(Promise.race([new Promise((t=>e.responseReceived=t)),c])));const s=null==e?void 0:e.queue.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(x.requestCancelledError);r=null==s?void 0:s.finalResponse,o.resultDescription="OK",T.tG.info(506575007,T.nh.CoreDefault,o.stop()),yield yield w(s)}catch(e){const t=e.message===x.requestCancelledError?l.zy.RequestCancelled:l.zy.Unknown;o.resultDescription="Error",o.setDataField("ClientError",`ErrorCode: ${t}, Error: ${e.message}`),T.tG.info(506575006,T.nh.CoreDefault,o.stop()),yield yield w({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),r=!0;break}a.getAnnotationsResponseQueues.delete(i.messageId)}))}}}sendMessage(e,t){const s=new r.vG(Object.assign({bridgeId:b,docSessionId:this.docSessionId,messageType:u.h.getTypeNameFor(e),message:e},t));this.messageBridge.sendMessage(JSON.stringify(s))}sendMessageAsync(e,t){const s=new Promise(((t,s)=>{this.waitingForResponse.set(e.messageId,(e=>{r._p.typeGuard(e)?e.error&&e.error.includes("Unknown message type to handle")?s(new O(e.error)):s(new Error(e.error)):t(e)}))}));return this.sendMessage(e,t),s}sendMessageWithOp(e,t,s){const n=this.createLoggingOperation(e,!0);this.sendMessage(t,s),T.tG.info(507105996,T.nh.CoreDefault,n.stop())}sendMessageWithOpAsync(e,t,s){return I(this,void 0,void 0,(function*(){const n=this.createLoggingOperation(e,!0);try{return yield this.sendMessageAsync(t,s)}catch(e){throw n.success=!1,n.resultDescription=e.message,e}finally{n.success?T.tG.info(507105995,T.nh.CoreDefault,n.stop()):T.tG.error(507105994,T.nh.CoreDefault,n.stop())}}))}verifyMessageOrder(e,t){if(void 0===e.seq)return;const s={sequenceId:e.seq};if(t&&(s.messageType=u.h.getTypeNameFor(t),s.annotationCv=t.cv,r.B_.typeGuard(t))){const e=t;s.annotationType=e.annotationType}if(this.prevMessageInfo.sequenceId>s.sequenceId){const e=this.createLoggingOperation("OutOfOrderBridgeMessage",!1);e.setDataField("prevSeqId",this.prevMessageInfo.sequenceId),e.setDataField("prevMessageType",this.prevMessageInfo.messageType),e.setDataField("prevAnnotation",this.prevMessageInfo.annotationType),e.setDataField("prevAnnotationCv",this.prevMessageInfo.annotationCv),e.setDataField("currSeqId",s.sequenceId),e.setDataField("currMessageType",s.messageType),e.setDataField("currAnnotation",s.annotationType),e.setDataField("currAnnotationCv",s.annotationCv),T.tG.info(506799568,T.nh.CoreUnsampled,e.stop())}this.prevMessageInfo=s}ensureConnection(){return new Promise(((e,t)=>{const s=this.createLoggingOperation("EnsureConnection",!0);if(this.isClosed)return s.success=!1,s.resultDescription="Session is closed",T.tG.error(505192454,T.nh.CoreDefault,s.stop()),void t(new Error("Session is closed"));this.submitCustomMessage(new r.PR).then((t=>{T.tG.info(505192451,T.nh.CoreDefault,s.stop()),e()})).catch((e=>{s.success=!1,s.resultDescription=e.message,T.tG.error(505192452,T.nh.CoreDefault,s.stop()),t(e)}))}))}keepAlive(){this.ensureConnection().catch((e=>{}))}}x.internalSessionCounter=0,x.requestCancelledError="Request cancelled"},339297:(e,t,s)=>{var n,o;s.d(t,{G:()=>n,K:()=>o}),function(e){e[e.Input=0]="Input",e[e.Exception=1]="Exception",e[e.WaitOn=2]="WaitOn",e[e.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(o||(o={}))},344226:(e,t,s)=>{s.d(t,{f:()=>o,w:()=>i});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelChartStyles_ExcelChartStylesAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelChartStyles_ExcelChartStylesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},348234:(e,t,s)=>{var n,o,i;s.d(t,{Aw:()=>i,NQ:()=>n,Pf:()=>o}),function(e){e.ResumeInvokeAction="ResumeInvokeAction",e.ResumePluginAuth="ResumePluginAuth",e.CompletePlugin="CompletePlugin"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(o||(o={})),function(e){e.failed="failed",e.success="success",e.cancelled="cancelled"}(i||(i={}))},353683:(e,t,s)=>{s.d(t,{A:()=>o});var n=function(){function e(e){this.mergeDictationSettings(e)}return e.prototype.mergeDictationSettings=function(e){var t=this;Object.keys(e).forEach((function(s){t[s]=e[s]}))},e}(),o=function(){function e(){}return Object.defineProperty(e,"dictationSettings",{get:function(){if(e._instance)return e._instance;throw new Error("Dictation Settings not initialized")},set:function(t){e._instance?e._instance.mergeDictationSettings(t):e._instance=new n(t)},enumerable:!1,configurable:!0}),e}()},360356:(e,t,s)=>{s.r(t),s.d(t,{AudioMode:()=>c,BaseVoiceCommandResult:()=>f,BaseVoiceCommandSuggestion:()=>I,BatchTranscriptionConversation:()=>y.Qu,BatchTranscriptionErrorCode:()=>u.sP,BatchTranscriptionResult:()=>h.U1,BatchWorkflowStage:()=>l.Cu,ClientApp:()=>l.jr,CommandSuggestionContextType:()=>o,CommandSuggestionDisplayType:()=>n,DictationEventsType:()=>T.Ff,DictationSettingsManager:()=>p.A,IEventName:()=>l.$O,ISpeechError:()=>l.IZ,QualityStatusCode:()=>l.ZE,RehearsalNotificationResult:()=>h.m7,SelectionType:()=>a,SelectionWhich:()=>r,SpeechErrorEvent:()=>h.lM,SpeechErrorEventCode:()=>u.Y3,SpeechErrorEventImpact:()=>u.$O,SpeechErrorEventState:()=>u.o2,SpeechQualityEvent:()=>h._K,SpeechSessionEvent:()=>h.D_,SpeechSessionEventIds:()=>T.P_,SpeechToTextFinalResult:()=>h.mh,SpeechToTextPartialResult:()=>h.ZF,SpeechToTextProfile:()=>g.A,TraceLevel:()=>l.kp,UtteranceRecognitionType:()=>i,VoiceCommandError:()=>u.El,VoiceCommandInternalResult:()=>C,VoiceCommandRequest:()=>h.Pm,VoiceCommandResultV2:()=>_,VoiceCommandResultsInternalSignal:()=>S,VoiceCommandSuggestion:()=>w,VoiceCommandSuggestionInternalSignal:()=>A,VoiceCommandSuggestionResult:()=>N,VoiceDictationSessionInitiatedSignal:()=>v,VoiceLatencyInput:()=>y.VR,VoiceLatencyOutput:()=>h.Al,VoiceOperation:()=>m,VoiceResponseVersion:()=>u.wM,VoiceTile:()=>y.jP,WordVoiceCommandIds:()=>T.oJ,WordVoiceCommandValueKeys:()=>T.n4,internalCommandIds:()=>T.XH});var n,o,i,a,r,c,l=s(248867),u=s(361257),p=s(353683),g=s(803034),h=s(966264),d=s(985002),m=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),y=s(571919),T=s(774422);!function(e){e.Persistent="Persistent",e.Discardable="Discardable"}(n||(n={})),function(e){e.NONE="none",e.BLANK="blankDocument",e.PARAGRAPH="paragraph",e.LIST="list",e.TABLE="table",e.WHATCANISAY="whatCanISay"}(o||(o={})),function(e){e.Final="Final",e.Fragment="Fragment",e.Hypothesis="Hypothesis"}(i||(i={})),function(e){e.Paragraph="paragraph",e.Sentence="sentence",e.Character="character",e.Word="word",e.That="that",e.This="this",e.Table="table",e.Row="row",e.Column="column",e.Cell="cell",e.Page="page",e.Bullet="bullet",e.To="to",e.Bcc="bcc",e.Cc="cc",e.Subject="subject",e.EmailBody="emailBody",e.Field="field",e.All="all"}(a||(a={})),function(e){e.Next="next",e.Last="last",e.Previous="previous",e.Current="current",e.Left="left",e.Right="right",e.Above="above",e.Below="below",e.Start="start",e.End="end",e.Up="up",e.Down="down",e.Before="before",e.After="after",e.Beginning="start"}(r||(r={})),function(e){e.Play="play",e.Pause="pause",e.Resume="resume"}(c||(c={}));var f=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),_=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultV2"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),C=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandInternalResult"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),S=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultsInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),A=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),v=function(){function e(t){d.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceDictationSessionInitiatedSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),I=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),w=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandSuggestion","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),N=function(){function e(t){d.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return d.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},360678:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechErrorHandler=void 0;var n=s(360356),o=s(745032),i=function(){function e(){}return e.eventToMsg=function(e){switch(e){case"ConnectionRetry":return"Frontdoor Websocket Connection Retry";case"ErrorConnectionRetryFailure":return"Frontdoor Websocket Connection Retry Failed after MaxConnectionRetry";case"ErrorSpeechHandlerWebSocketFailure":return"Frontdoor Speech Handler Websocket Failure";case"ErrorProtobufDeserializationFailure":return"Frontdoor Protobuf Deserialization Failure";case"ErrorSpeechRecognitionCanceled":return"Frontdoor Speech Recognition canceled error";default:return e}},e.eventToErrorCode=function(e){switch(e){case"ConnectionRetry":return n.SpeechErrorEventCode.CONNECTION_RETRY;case"ErrorConnectionRetryFailure":return n.SpeechErrorEventCode.CONNECTION_RETRY_FAILURE;case"ErrorSpeechHandlerWebSocketFailure":return n.SpeechErrorEventCode.SPEECH_HANDLER_WS_FAILURE;case"ErrorProtobufDeserializationFailure":return n.SpeechErrorEventCode.PROTOBUF_DESERIALIZATION_FAILURE;case"ErrorSpeechRecognitionCanceled":return n.SpeechErrorEventCode.SPEECH_RECOGNITION_CANCELED;default:return n.SpeechErrorEventCode.UNKNOWN}},e.sendSpeechErrorEvent=function(e,t,s,i,a){if(e){var r=new n.SpeechErrorEvent({ErrorCode:t,ErrorMsg:s,ErrorState:i,ErrorImpact:a});e.setAnnotations(null,n.SpeechErrorEvent.getTypeName(),[r],{isSessionAnnotation:!0,immediate:!0})}else o.Log.warn(571013264,o.LogCategory.WorkflowDefault,"AL current Actions missing, won't emit SpeechErrorEvent to client.")},e}();t.SpeechErrorHandler=i},361257:(e,t,s)=>{var n,o,i,a,r,c;s.d(t,{$O:()=>i,El:()=>r,Y3:()=>n,o2:()=>o,sP:()=>c,wM:()=>a}),function(e){e.UNKNOWN="Unknown",e.CONNECTION_RETRY="ConnectionRetry",e.CONNECTION_RETRY_FAILURE="ErrorConnectionRetryFailure",e.SPEECH_HANDLER_WS_FAILURE="ErrorSpeechHandlerWebSocketFailure",e.PROTOBUF_DESERIALIZATION_FAILURE="ErrorProtobufDeserializationFailure",e.EXPLICITLY_DISABLED="ExplicitlyDisabled",e.SPEECH_RECOGNITION_CANCELED="ErrorSpeechRecognitionCanceled"}(n||(n={})),function(e){e.INTERMITTENT="Intermittent",e.FINAL="Final"}(o||(o={})),function(e){e.NO_DICTATION="NoDictation",e.NO_COMMANDING="NoCommanding",e.NO_TOKEN="NoPfaToken"}(i||(i={})),function(e){e.version1="1",e.version2="2"}(a||(a={})),function(e){e[e.NoMatch=0]="NoMatch"}(r||(r={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.UNSUPPORTED_FILE_FORMAT="UNSUPPORTED_FILE_FORMAT",e.UPLOADING="UPLOADING",e.PROCESSING="PROCESSING",e.DELETED="DELETED",e.FILE_NOT_EXIST="FILE_NOT_EXIST",e.FILE_DECODE_ERROR="FILE_DECODE_ERROR",e.REQUEST_TIMEOUT_ERROR="REQUEST_TIMEOUT_ERROR"}(c||(c={}))},372704:(e,t,s)=>{s.d(t,{Cc:()=>c,RN:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SubstrateEventsInput"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SubstrateEvent"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResponseReceivedSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsRenderedSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SearchEntityActionsSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ClientDataSourceSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ClientLayoutSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsView"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsViewEntity"}static getBaseTypes(){return["AugLoop_SubstrateEvents_ResultsView"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_ResultsViewGroup"}static getBaseTypes(){return["AugLoop_SubstrateEvents_ResultsView"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_CachedContentRenderedSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SearchFeedbackSubstrateEvent"}static getBaseTypes(){return["AugLoop_SubstrateEvents_SubstrateEvent"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()}},375746:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationMetaDataChange=void 0;const n=s(386561);class o extends n.AnnotationMetaDataChangeEvent{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}t.AnnotationMetaDataChange=o},385659:(e,t,s)=>{var n,o;s.d(t,{Q:()=>n}),function(e){e.GET="Get",e.PROCESSED="Processed"}(n||(n={})),function(e){e.GET="Get",e.STORE="Store"}(o||(o={}))},386561:(e,t,s)=>{s.r(t),s.d(t,{AnnotationMetaDataChangeEvent:()=>h.L,AnonymizedOperationEvent:()=>n.O,CircuitBreakerStateChangeEvent:()=>g,HttpRequestQueueEvent:()=>c.F,HttpSocketListEvent:()=>u.k,OperationEvent:()=>o.A,OutboundHttpRequestEvent:()=>l.g,PrivacyGuardIssueEvent:()=>C.F,ProcessIdentificationEvent:()=>r.m,ScenarioStatsEvent:()=>_.A,SessionHealthEvent:()=>y.R,SessionHealthEventAggregation:()=>T.Z,SessionIssueEvent:()=>f.Q,SessionStatsEvent:()=>m,WorkflowOperationEvent:()=>a});var n=s(240633),o=s(109652),i={util:{},roots:{default:{}}},a=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.workflow="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/WorkflowOperationEvent"},e}()),r=s(19821),c=s(130149),l=s(538194),u=s(103694),p={util:{},roots:{default:{}}},g=(p.util,p.roots.default||(p.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.group="",e.prototype.name="",e.prototype.state=0,e.prototype.failurePercent=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/CircuitBreakerStateChangeEvent"},e}()),h=s(117954),d={util:{},roots:{default:{}}},m=(d.util,d.roots.default||(d.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.healthy=!1,e.prototype.fullLogs=!1,e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientSessionId="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.isClientTelemetrySampled=!1,e.prototype.clientDocSessionId="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.userOid="",e.prototype.protocolVersion=0,e.prototype.totalDurationMs=0,e.prototype.idleDurationMs=0,e.prototype.closeReason="",e.prototype.firstClientConnectionDurationMs=0,e.prototype.seedMode="",e.prototype.seedSuccess=!1,e.prototype.seedItems=0,e.prototype.seedMessageCount=0,e.prototype.seedBatchSize=0,e.prototype.seedGroupSize=0,e.prototype.seedDurationMs=0,e.prototype.sendMessageCount=0,e.prototype.sendMessageErrors=0,e.prototype.sendMessageWarnings=0,e.prototype.sendMessageDurationMsMax=0,e.prototype.processMessageCount=0,e.prototype.processMessageErrors=0,e.prototype.processMessageWarnings=0,e.prototype.processMessageDurationMsMax=0,e.prototype.syncMessageCount=0,e.prototype.syncMessagesOutOfSequence=0,e.prototype.syncMessagesAbandoned=0,e.prototype.syncMessagesIgnored=0,e.prototype.syncMessageQueueLimitReached=!1,e.prototype.modelItemsMax=0,e.prototype.modelSizeInKb=0,e.prototype.modelConsistencyErrors=0,e.prototype.modelItemsCountBucket="",e.prototype.modelConsistencyErrorsAndWarnings=0,e.prototype.modelConsistencyQuietStateValid=!1,e.prototype.modelConsistencyQuietStateWarnings=0,e.prototype.modelConsistencyQuietStateErrors=0,e.prototype.documentUrlAvailable=!1,e.prototype.documentUrlWasProvided=!1,e.prototype.workflowsRegistered=0,e.prototype.workflowExecutions=0,e.prototype.workflowExecutionErrors=0,e.prototype.workflowExecutionDurationMsMax=0,e.prototype.workflowExecutionInfraErrors=0,e.prototype.annotationTypesActivated=0,e.prototype.annotationsAdded=0,e.prototype.annotationsUpdated=0,e.prototype.annotationsDeleted=0,e.prototype.augLoopLowPrivilegeTokenExistenceStatus="",e.prototype.augLoopLowPrivilegeTokenFirstArrivalDurationMs=0,e.prototype.wacTokenProvisionTokenExistenceStatus="",e.prototype.wacTokenProvisionTokenFirstArrivalDurationMs=0,e.prototype.seedingWorkflowPerformanceTimesValid=!1,e.prototype.timeFromFirstSeedMessageToFirstWorkflowFinishedMs=0,e.prototype.timeFromFirstSeedMessageToFirstAnnotationMs=0,e.prototype.timeFromFirstSeedMessageToLastAnnotationMs=0,e.prototype.timeFromFirstSeedMessageToLastWorkflowFinishedMs=0,e.prototype.timeFromLastSeedMessageToLastAnnotationMs=0,e.prototype.timeFromLastSeedMessageToLastWorkflowFinishedMs=0,e.prototype.syncMessagesWorkflowPerformanceNotMeasured=0,e.prototype.timeToAllWorkflowsFinishedMsMax=0,e.prototype.timeFromSessionStartToLastWorkflowFinishedMs=0,e.prototype.healthBucket="",e.prototype.coreHealthBucket="",e.prototype.coreHealthReason="",e.prototype.coreHealthBucketWithSuppressions="",e.prototype.coreHealthReasonWithSuppressions="",e.prototype.healthReason="",e.prototype.healthReasonCategory="",e.prototype.healthBucketWithSuppressions="",e.prototype.healthReasonWithSuppressions="",e.prototype.healthReasonCategoryWithSuppressions="",e.prototype.eventAnalysisFindings="",e.prototype.mappedHealthBucketsToReasons="",e.prototype.userDataBoundaryType="",e.prototype.ecsConfigIDs="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionStatsEvent"},e}()),y=s(511310),T=s(868773),f=s(537491),_=s(222699),C=s(221777)},387039:(e,t,s)=>{var n,o,i,a,r,c,l,u,p;s.d(t,{lC:()=>n}),function(e){e[e.Success=0]="Success",e[e.OffensiveContentInput=1]="OffensiveContentInput",e[e.OffensiveContentOutput=2]="OffensiveContentOutput",e[e.EmptyResponse=3]="EmptyResponse",e[e.ErrorInExecution=4]="ErrorInExecution",e[e.ResourcesNotAvailable=5]="ResourcesNotAvailable",e[e.RaiUnsupportedLanguageInContentInput=6]="RaiUnsupportedLanguageInContentInput",e[e.RaiUnsupportedLanguageInContentOutput=7]="RaiUnsupportedLanguageInContentOutput",e[e.InputBlockedByDynamicGuardList=8]="InputBlockedByDynamicGuardList",e[e.OutputBlockedByDynamicGuardList=9]="OutputBlockedByDynamicGuardList",e[e.InputAttackDetected=10]="InputAttackDetected",e[e.OutputAttackDetected=11]="OutputAttackDetected",e[e.EnumValueNotInUse=12]="EnumValueNotInUse",e[e.PartialResult=13]="PartialResult",e[e.ModelContentFilter=14]="ModelContentFilter",e[e.Unknown=15]="Unknown",e[e.Overloaded=16]="Overloaded",e[e.Timeout=17]="Timeout",e[e.TooLargeRequest=18]="TooLargeRequest",e[e.BadRequest=19]="BadRequest",e[e.InternalServerError=20]="InternalServerError",e[e.UserNotAuthenticated=21]="UserNotAuthenticated",e[e.UserNotAuthorized=22]="UserNotAuthorized",e[e.UserThrottled=23]="UserThrottled",e[e.ScenarioThrottled=24]="ScenarioThrottled",e[e.InvalidFormatting=25]="InvalidFormatting",e[e.WorkflowQuotaLimitExceeded=26]="WorkflowQuotaLimitExceeded",e[e.UnsupportedRequirement=27]="UnsupportedRequirement",e[e.UrlPresentInInput=28]="UrlPresentInInput",e[e.DocumentUrlChangeDetected=29]="DocumentUrlChangeDetected",e[e.ExpectedError=30]="ExpectedError",e[e.BlockedByUserPrompt=31]="BlockedByUserPrompt",e[e.PromptDefinedError=32]="PromptDefinedError",e[e.FailedToGetFileContents=33]="FailedToGetFileContents",e[e.OutputBlockedByDynamicBlockList=34]="OutputBlockedByDynamicBlockList",e[e.ProtectedMaterial=35]="ProtectedMaterial",e[e.Skipped=36]="Skipped",e[e.DeferredRaiFailure=37]="DeferredRaiFailure",e[e.OutOfCredits=38]="OutOfCredits",e[e.InputGroundingAttackDetected=39]="InputGroundingAttackDetected",e[e.ToolCalls=40]="ToolCalls",e[e.UnknownSydneyError=41]="UnknownSydneyError",e[e.GenericSydneyError=42]="GenericSydneyError",e[e.HttpStatusCodeSydneyError=43]="HttpStatusCodeSydneyError",e[e.AuthenticationSydneyError=44]="AuthenticationSydneyError",e[e.DisengagedSydneyError=45]="DisengagedSydneyError",e[e.NotEnoughTranscript=46]="NotEnoughTranscript",e[e.NotFoundError=47]="NotFoundError"}(n||(n={})),function(e){e.text="text",e.image="image"}(o||(o={})),function(e){e.System="system",e.User="user",e.Assistant="assistant",e.Tool="tool",e.Developer="developer"}(i||(i={})),function(e){e.text="text",e.image_url="image_url",e.input_audio="input_audio",e.file="file",e.refusal="refusal"}(a||(a={})),function(e){e.auto="auto",e.low="low",e.high="high"}(r||(r={})),function(e){e.wav="wav",e.mp3="mp3"}(c||(c={})),function(e){e.Function="function"}(l||(l={})),function(e){e.NotStarted="NotStarted",e.Running="Running",e.Succeeded="Succeeded",e.Failed="Failed"}(u||(u={})),function(e){e.Preprocessing="preprocessing",e.Queued="queued",e.Processing="processing",e.Running="running",e.Cancelled="cancelled",e.Succeeded="succeeded",e.Failed="failed",e.Unknown="unknown"}(p||(p={}))},387452:(e,t,s)=>{s.d(t,{T:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_CopilotChatHistorySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetCurrentChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetAllChatsOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesInCurrentChatSession"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_RemoveAllMessagesFromCurrectChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddMessageOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_DeleteChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateMessageOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateChatOperation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},392346:(e,t,s)=>{s.d(t,{HN:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},402205:(e,t,s)=>{var n;s.d(t,{N:()=>n}),function(e){e.Unknown="Unknown",e.Testing="Testing",e.CopilotSummary="Copilot Summary",e.CopilotCompose="Copilot Compose",e.Rewrite="Copilot Rewrite",e.ChatQnA="Copilot Chat Question & Answer",e.CIQ="Context IQ",e.Editor="Editor",e.Handoff="Handoff",e.ReadAloud="Read Aloud"}(n||(n={}))},405469:(e,t,s)=>{s.d(t,{d:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CreditBalance_CreditBalanceAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},405474:(e,t,s)=>{s.d(t,{f$:()=>a});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechSynthesizeSSMLSignal"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechSynthesizeTextSignal"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ReadAloudSpeechSynthesizeTextSignal"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechGetVoicesSignal"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ReadAloudSpeechGetVoicesSignal"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},408165:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.rangeEquals=t.isRangeContained=t.rangesIntersect=t.gridRangeToExcelRange=t.excelRangeToGridRange=t.getTopRowAddress=t.getColumnRangeToTheRight=t.isCellPartOfRange=t.hasSheetNameInRangeAddress=t.parseRangeAddressWithEmbeddedSheetName=t.parseRangeAddress=t.areCellsEqual=t.parseCellAddress=t.convertRowColumnToCellAddress=t.makeRangeAddress=t.countColumnsInRanges=t.countRowsInRanges=t.countCellsInRanges=t.convertToRanges=t.isIntersect=t.compareRanges=t.getStartIndexForColumnData=t.mergeCellsToRanges=t.unionRanges=t.mergeConsecutiveRangesByColumn=t.areAllRowsEqual=t.columnNumberToTitle=t.columnNumberFromTitle=t.GridConstants=void 0;class s{}function n(e){let t=0;const s=e.toUpperCase();for(let e=s.length-1,n=e;n>=0;--n){t+=(s.charCodeAt(n)-o+1)*Math.pow(i,e-n)}return t}t.GridConstants=s,s.lowerIndexBound=1,s.maxNumberOfRows=1048576,s.maxNumberOfColumns=16384,t.columnNumberFromTitle=n;const o="A".charCodeAt(0),i=26;function a(e){if(e<s.lowerIndexBound||e>s.maxNumberOfColumns)throw new Error(`column: ${e} is out of bounds`);const t=[];for(e--;e>=0;){const s=o+e%i,n=String.fromCharCode(s);t.unshift(n),e=Math.floor(e/i)-1}return t.join("")}function r(e,t){return{left:Math.min(e.left,t.left),top:Math.min(e.top,t.top),right:Math.max(e.right,t.right),bottom:Math.max(e.bottom,t.bottom),worksheetId:e.worksheetId}}function c(e){const t=[];e.sort(((e,t)=>e.row===t.row?e.column-t.column:e.row-t.row));for(let s=0;s<e.length;s++){const n=e[s].row;let o=n;for(;s<e.length-1&&e[s].column===e[s+1].column&&e[s+1].row-o<=1;)o=e[s+1].row,s++;t.push({left:e[s].column,top:n,right:e[s].column,bottom:o})}return t}function l(e){const{top:t,bottom:s,left:n,right:o}=e,i=u(s,o);return u(t,n)+":"+i}function u(e,t){if(e<s.lowerIndexBound||e>s.maxNumberOfRows)throw new Error(`row: ${e} is out of bounds`);if(t<s.lowerIndexBound||t>s.maxNumberOfColumns)throw new Error(`column: ${t} is out of bounds`);return`${a(t)}${e}`}function p(e){const t=/^([a-zA-Z]+)(\d+)$/g.exec(e);if(!t)return;const[,s,o]=t;return{row:parseInt(o,10),column:n(s)}}function g(e,t){if(e.includes("!")){if(!e.startsWith("'"))return g(e.split("!")[1],t);const s=/^\'(.*?)\'!(.*)$/.exec(e);if(s)return g(s[2],t)}const[o,i,...a]=e.split(":");if(a.length>0)throw new Error("Invalid range address: multiple instances of ':' found");const r=p(o);if(!r){const o=/^([a-zA-Z]+):([a-zA-Z]+)$/.exec(e);if(o){const e=n(o[1]),i=n(o[2]);return{top:s.lowerIndexBound,left:Math.min(e,i),bottom:s.maxNumberOfRows,right:Math.max(e,i),worksheetId:t}}const i=/^(\d+):(\d+)$/.exec(e);if(i){const e=parseInt(i[1],10),n=parseInt(i[2],10);return{top:Math.min(e,n),left:s.lowerIndexBound,bottom:Math.max(e,n),right:s.maxNumberOfColumns,worksheetId:t}}throw new Error("Invalid range address: failed to parse left top cell")}const c={top:r.row,left:r.column,bottom:-1,right:-1,worksheetId:t};if(i){const e=p(i);if(!e)throw new Error("Invalid range address: failed to parse right bottom cell");if(c.bottom=e.row,c.right=e.column,c.bottom<c.top){const e=c.top;c.top=c.bottom,c.bottom=e}if(c.right<c.left){const e=c.left;c.left=c.right,c.right=e}}else c.bottom=c.top,c.right=c.left;return c}function h(e,t,s=!0){return(!s||e.worksheetId===t.worksheetId)&&(Math.min(e.right,t.right)>=Math.max(e.left,t.left)&&Math.min(e.bottom,t.bottom)>=Math.max(e.top,t.top))}t.columnNumberToTitle=a,t.areAllRowsEqual=function(e,t){return e.length===t.length&&e.every(((e,s)=>{const n=t[s];return e.top===n.top&&e.bottom===n.bottom}))},t.mergeConsecutiveRangesByColumn=function(e){function t(e,t){const s=e.left===t.left&&e.right===t.right,n=t.top-e.bottom<=1;return s&&n}const s=e.sort(((e,t)=>e.top-t.top)),n=[];for(let e=0;e<s.length;e++){for(;e<s.length-1&&t(s[e],s[e+1]);)s[e+1]=r(s[e+1],s[e]),e++;n.push(s[e])}return n},t.unionRanges=r,t.mergeCellsToRanges=c,t.getStartIndexForColumnData=function(e,t,s){if(s>=1)for(let n=0;n<e.length;n++){const o=e[n];if(o&&o.row>=t.top+s)return n}return s},t.compareRanges=function(e,t){return e.left===t.left?e.top-t.top:e.left-t.left},t.isIntersect=function(e,t){return h(e,t.range,!1)},t.convertToRanges=function(e,t){return c(e.map((e=>({row:e,column:t}))))},t.countCellsInRanges=function(e){return e.reduce(((e,t)=>e+(t.right-t.left+1)*(t.bottom-t.top+1)),0)},t.countRowsInRanges=function(e){return e.reduce(((e,t)=>e+(t.bottom-t.top+1)),0)},t.countColumnsInRanges=function(e){return e.reduce(((e,t)=>e+(t.right-t.left+1)),0)},t.makeRangeAddress=l,t.convertRowColumnToCellAddress=u,t.parseCellAddress=p,t.areCellsEqual=function(e,t){return e.row===t.row&&e.column===t.column},t.parseRangeAddress=g,t.parseRangeAddressWithEmbeddedSheetName=function(e,t){if(e.includes("!")){const t=/^(?:'([^']+)'|([^!]+))!/.exec(e);if(t){return g(e,t[1]||t[2])}}if(!t)throw new Error("WorksheetId must be provided if range address does not include a sheet name.");return g(e,t)},t.hasSheetNameInRangeAddress=function(e){return e.includes("!")},t.isCellPartOfRange=function(e,t){return h(e,function(e,t){return{top:e.row,left:e.column,bottom:e.row,right:e.column,worksheetId:t}}(t,e.worksheetId))},t.getColumnRangeToTheRight=function(e){return{top:e.top,left:e.right+1,bottom:e.bottom,right:e.right+1,worksheetId:e.worksheetId}},t.getTopRowAddress=function(e){return l({top:e.top,left:e.left,bottom:e.top,right:e.right})},t.excelRangeToGridRange=function(e){return{row:e.top-1,rows:e.bottom-e.top+1,col:e.left-1,cols:e.right-e.left+1}},t.gridRangeToExcelRange=function(e,t){const s={top:e.row+1,bottom:e.row+e.rows,left:e.col+1,right:e.col+e.cols,worksheetId:t};return{...s,address:l(s)}},t.rangesIntersect=h,t.isRangeContained=function(e,t){return e.worksheetId===t.worksheetId&&(e.left<=t.left&&e.right>=t.right&&e.top<=t.top&&e.bottom>=t.bottom)},t.rangeEquals=function(e,t){return e.worksheetId===t.worksheetId&&(e.bottom===t.bottom&&e.left===t.left&&e.right===t.right&&e.top===t.top)}},427999:(e,t,s)=>{s.d(t,{_A:()=>r,OW:()=>i,t$:()=>o});var n=s(87477);const o="Request timed out";function i(e,t,s){const o=new n.Request(e,t);return a.add(o,s)}const a=new class{constructor(e,t,s){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=s}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,s]=this.queuedRequests.shift();clearTimeout(s),this.add(e,t)}}add(e,t){if(this.requestInProgress){const s=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,s])}else{this.requestInProgress=!0;new Promise(((t,s)=>{let n=!1;const o=setTimeout((()=>{n=!0,s(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{n||(clearTimeout(o),t(e))})).catch((e=>{n||(clearTimeout(o),s(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}}(n.fetch,2e4,12e4);function r(e,t,s){return new Promise(((i,a)=>{const r=setTimeout((()=>{a(new Error(o))}),t);(0,n.fetch)(e,s||{}).then((e=>{clearTimeout(r),i(e)})).catch((e=>{clearTimeout(r),a(e)}))}))}},442470:(e,t,s)=>{s.d(t,{L4:()=>f});var n=s(463569),o=s(282144),i=s(521409),a=s(974428),r=s(985002),c=s(83222),l=s(596374),u=s(879586),p=s(199128),g=s(837450),h=s(186117);const d=e=>"GraphSearchClient"===e.ownerId,m=new Map([["AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid",0],["AugLoop_ObservationalAssistance_EccAnnotationClient",1],["AugLoop_GraphSearch_EccAnnotationHybrid",1],["AugLoop_GraphSearch_PredictionAnnotationHybrid",2],["AugLoop_GraphSearch_NudgeAnnotationHybrid",3]]);class y extends g.c{constructor(e,t){super("GraphSearchJoinWorkflowInstance",e,t)}async execute(e,t,s,o){let a=!1,l=!1;const u=new Date,p=this.startLogOperation("GraphSearchJoinWorkflowExecute",u,t);this.logWasmStats(p);const g=m.get(r.h.getTypeNameFor(t[0]));if(void 0!==g&&p.setDataFields({scenario:g}),2===t.length){if(c.SM.typeGuard(t[0])||c.SM.typeGuard(t[1])){const e=t[d(t[0])?0:1];p.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:s.clientMetadata.sessionId})}if(n.nm.typeGuard(t[0])||n.nm.typeGuard(t[1])){const e=t[d(t[0])?0:1];p.setDataFields({logicalId:e.logicalId,sessionId:s.clientMetadata.sessionId}),"Ignore"===e.entityType&&(l=!0)}}p.setDataFields({dimension0:(new Date).getTime()-u.getTime()}),a=this.executeWorkflowLambda(p,e,s,o,t),l&&!a||i.tG.info(509638786,i.nh.WorkflowDefault,p.stop())}}const T=(e,t)=>new y(e,t),f=(e,t)=>a.a.create("GraphSearchJoinECC").setCollectionScopeType(u.VP.getTypeName()).setInputTypes([c.SM.getTypeName(),n.NG.getTypeName()]).setOutputTypes([l.os.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(T.bind(null,e,t));_=h.aU,C=h.zb,a.a.create("GraphSearchJoinWorkflow").setCollectionScopeType(o.Z5.getTypeName()).setInputTypes([n.J_.getTypeName()]).setOutputTypes([n.VL.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(T.bind(null,_,C));var _,C;((e,t)=>{a.a.create("GraphSearchJoinPrediction").setCollectionScopeType(p.iU.getTypeName()).setInputTypes([n.nm.getTypeName(),n.t9.getTypeName()]).setOutputTypes([c.k2.getTypeName(),c.KL.getTypeName(),l.Vm.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(T.bind(null,e,t))})(h.aU,h.zb),f(h.aU,h.zb)},452367:(e,t,s)=>{s.d(t,{K:()=>o});var n=s(301520);const o=(e,t)=>{var s,o;const i=new n.I({operationName:e,success:!0,resultDescription:"",ariaTenant:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",ariaNamespace:"Oa_Client"});return i.setClientMetadata(null==t?void 0:t.clientMetadata),i.setUserContext(null==t?void 0:t.userContext),i.setDataFields({contextId:null===(o=null===(s=null==t?void 0:t.model)||void 0===s?void 0:s.scopeItem)||void 0===o?void 0:o.getContextId()}),i}},462570:(e,t,s)=>{s.d(t,{TR:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_CopilotChatTeachingUIAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_SetTUIEverShownStateOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_GetTUIEverShownStateOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},463569:(e,t,s)=>{s.d(t,{J_:()=>r,NG:()=>u,VL:()=>a,nm:()=>c,rQ:()=>i,t9:()=>l,xz:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetchCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDeleteCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid"}static getBaseTypes(){return["AugLoop_GraphSearch_SearchSuggestionsAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphSearch_PredictionAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphSearch_NudgeAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphSearch_EccAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_GraphSearch_UserInitiatedAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()}},469408:(e,t,s)=>{s.d(t,{r:()=>r});const{AugLoopTextEncoder:n,AugLoopTextDecoder:o}=(()=>{if("undefined"==typeof TextEncoder||"undefined"==typeof TextDecoder){s(395621);const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})();var i=s(837542).hp,a=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};class r{static extractFragments(e){if(e[0]!==r.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let t=1;const s=[],n=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;t<e.byteLength;){if(t+4>e.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const o=n.getUint32(t);if(t+o+4>e.byteLength)throw new Error("Invalid Binary: Fragment out of range");void 0!==i&&i.from?s.push(i.from(e.buffer,e.byteOffset+t+4,o)):s.push(new Uint8Array(e.buffer,e.byteOffset+t+4,o)),t+=4+o}if(s.length<1)throw new Error("Invalid Binary: No fragments found");return s}static deserialize(e,t=e=>e){const s=r.extractFragments(e),n=r.textDecoder.decode(s[0]);return JSON.parse(n,((e,n)=>{if("string"==typeof n){if(n.substring(0,r.BINARYKEYWORD.length)===r.BINARYKEYWORD){const e=parseInt(n.substring(r.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=s.length-1)throw new Error("Invalid Binary: Binary index out of range");return t(s[e+1])}if(n.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD)return n.substring(r.ESCAPEKEYWORD.length)}return n}))}static deserializeAsync(e,t=e=>a(this,void 0,void 0,(function*(){return e}))){return a(this,void 0,void 0,(function*(){const s=r.extractFragments(e),n=r.textDecoder.decode(s[0]),o=[],i=Symbol("placeholder"),a=e=>{if(Array.isArray(e)){for(let t=0;t<e.length;t++)e[t]=a(e[t]);return e}if(null!==e&&"object"==typeof e){if(e[i])return e.value;for(const t of Object.keys(e))e[t]=a(e[t]);return e}return e};let c=JSON.parse(n,((e,n)=>{if("string"==typeof n){if(n.startsWith(r.BINARYKEYWORD)){const e=parseInt(n.substring(r.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=s.length-1)throw new Error("Invalid Binary: Binary index out of range");const a=t(s[e+1]);return o.push(a),(e=>{const t={[i]:!0,value:void 0};return e.then((e=>{t.value=e})),t})(a)}if(n.startsWith(r.ESCAPEKEYWORD))return n.substring(r.ESCAPEKEYWORD.length)}return n}));return yield Promise.all(o),c=yield a(c),c}))}static serializeInternal(e){const t=[void 0],s=JSON.stringify(e,((e,s)=>ArrayBuffer.isView(s)?(t.push(s),`${r.BINARYKEYWORD}${t.length-2}`):s&&"Buffer"===s.type&&Array.isArray(s.data)?(t.push(new Uint8Array(s.data)),`${r.BINARYKEYWORD}${t.length-2}`):"string"==typeof s&&s.substring(0,r.ESCAPEKEYWORD.length)===r.ESCAPEKEYWORD?r.ESCAPEKEYWORD+s:s));t[0]=r.textEncoder.encode(s);const n=t.reduce(((e,t)=>e+4+t.byteLength),0),o=new Uint8Array(n+1);o[0]=r.IDENTIFIERBYTE;let i=1;const a=new DataView(o.buffer,o.byteOffset,o.byteLength);for(const e of t)a.setUint32(i,e.byteLength),o.set(e,i+4),i+=4+e.byteLength;return o}static serialize(e){return r.serializeInternal(e)}static serializeAsync(e){return a(this,void 0,void 0,(function*(){return new Promise(((t,s)=>{try{t(r.serializeInternal(e))}catch(e){s(e)}}))}))}}r.IDENTIFIERBYTE=3,r.BINARYKEYWORD=":b",r.ESCAPEKEYWORD=":",r.textDecoder=new o,r.textEncoder=new n},473257:(e,t,s)=>{s.d(t,{A2:()=>p,ZC:()=>h,wM:()=>g});var n=s(629271),o=s(521409),i=s(87477),a=s(469408),r=s(184175),c=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};function l(e,t){return c(this,void 0,void 0,(function*(){const{authToken:s,origin:n,sessionUrl:o}=e,{body:a,cv:r,method:c,requestUrl:l}=t,u=yield(0,i.fetch)(l||o,{method:c,headers:Object.assign({Authorization:`Bearer ${s}`,"x-origin":n,"x-correlationid":r},t.headers),body:a});if(200!==u.status)throw new Error(`Unexpected status code: ${u.status}`);return u}))}const u=(e,t)=>{t?(e.resultDescription=t,e.success=!1,o.tG.error(507646878,o.nh.CoreDefault,e.stop())):o.tG.info(507646877,o.nh.CoreDefault,e.stop())};function p(e,t,s,n){let o;l(e,{headers:{"Content-Type":"application/jsond"},body:a.r.serialize(t),cv:s.cv,method:"POST"}).then((e=>e.json())).catch((e=>{o=new r._p({messageId:t.messageId,error:e.message})})).then((e=>{u(s,o?o.error:void 0),n(o,e)}))}function g(e,t,s,n){let o;l(e,{headers:{"Content-Type":"application/octet-stream"},body:t,cv:s.cv,method:"POST",requestUrl:`${e.sessionUrl}/blob`}).then((e=>e.json())).catch((e=>{o=new r._p({error:e.message})})).then((e=>{u(s,o?o.error:void 0),n(o,e)}))}function h(e,t,s,o){const{sessionUrl:i}=e;let a;l(e,{cv:o.cv,method:"GET",requestUrl:t.refType===n.J1.AlCodedLocation?`${i}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{a=e})).then((e=>{u(o,a?a.message:void 0),s(a,e)}))}},475769:(e,t,s)=>{s.d(t,{Aq:()=>g,MY:()=>m,ZF:()=>y,yq:()=>h,zX:()=>T});var n=s(521409),o=s(301520),i=s(844457),a=s(985002),r=s(708029),c=s(392346),l=s(784567),u=s(297288),p=s.n(u);class g{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:i.v.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:i.v.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:e}}static isFeatureEnabled(e,t,s=!1,n="None"){return e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,n).catch((()=>Promise.resolve(s))):Promise.resolve(s)}static isChangeGateEnabled(e,t){return e&&e.isChangeGateEnabled?e.isChangeGateEnabled(t):Promise.resolve(!1)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const s=e.split(":");let n=s[0].toLowerCase();return 0==n.indexOf(t?"http":"ws")?(n=t?n.replace("http","ws"):n.replace("ws","http"),s[0]=n,s.join(":")):e}static deepEquals(e,t){return p()(e,t)}static collectTelemetry(e,t,s,o,i,a){var r,c,l,u;e.start(),e.resultSignature=null!=o?o:"",e.resultDescription=null!=i?i:"",e.success=s,a?(e.dimension0=null!==(r=a[0])&&void 0!==r?r:"",e.dimension1=null!==(c=a[1])&&void 0!==c?c:"",e.dimension2=null!==(l=a[2])&&void 0!==l?l:"",e.dimension3=null!==(u=a[3])&&void 0!==u?u:""):(e.dimension0="",e.dimension1="",e.dimension2="",e.dimension3=""),t.log((()=>n.tG.info(508367457,n.nh.CoreDefault,e.stop())))}}g.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class h{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new o.I({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});n.tG.warn(572838107,n.nh.CoreDefault,e)}}}const d=[a.h.getTypeName(),r.YH.getTypeName(),c.HN.getTypeName()],m=e=>{const t=new Set;for(const s of e)if("string"==typeof s)-1===d.indexOf(s)&&t.add(s);else for(const e of[s.getTypeName(),...s.getBaseTypes()])-1===d.indexOf(e)&&t.add(e);return Array.from(t)},y=(e,t=0)=>Number.isFinite(e)?e:t,T=(e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(l.xU.typeGuard(e)||l.XP.typeGuard(e))return!0;for(const s of e.items)if(!s.body||a.h.matchesTypesFor(s.body,t))return!0;return!1}},487610:(e,t,s)=>{s.d(t,{mu:()=>o,qV:()=>r,vW:()=>i});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CreditBalance_CreditBalanceSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CreditBalance_CreditDeductionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CreditBalance_MeterSignalBase"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CreditBalance_MeterBalanceSignal"}static getBaseTypes(){return["AugLoop_CreditBalance_MeterSignalBase","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CreditBalance_MeterSpinSignal"}static getBaseTypes(){return["AugLoop_CreditBalance_MeterSignalBase","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},488096:(e,t,s)=>{s.d(t,{O:()=>n});class n{executeAfter(e,t){let s=setTimeout((()=>{s=null,e()}),t);return()=>{null!==s&&(clearTimeout(s),s=null)}}}},488837:(e,t,s)=>{s.d(t,{Cm:()=>u});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingCreateStepSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingCreateQuerySignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEditQuerySignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingCreateTableUpdatePlanSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEvaluateSampleSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingTableSignal","AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingValidateScriptSignal"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()}},492849:(e,t,s)=>{s.d(t,{l:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelRunScript_ExcelRunScriptAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},493491:(e,t,s)=>{s.d(t,{Ek:()=>a,TQ:()=>r,Xq:()=>o,_b:()=>n,m6:()=>i});class n extends Error{constructor(e){super(e),Object.setPrototypeOf(this,n.prototype)}}class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,o.prototype)}}class i extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,i.prototype),this.erroInfo=t}}class a extends Error{constructor(e){super(e),Object.setPrototypeOf(this,a.prototype)}}class r extends Error{constructor(e){super(e),Object.setPrototypeOf(this,r.prototype)}}Error},498483:(e,t,s)=>{s.d(t,{i:()=>i});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotWarmupAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotUserContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},511310:(e,t,s)=>{s.d(t,{R:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}())},511559:(e,t,s)=>{var n,o,i,a,r,c,l,u;s.d(t,{Hu:()=>c,QE:()=>n,ss:()=>o}),function(e){e.None="None",e.MessageExtension="MessageExtension",e.PowerPlatform="PowerPlatform",e.DataVerse="DataVerse",e.OpenAIPlugin="OpenAIPlugin"}(n||(n={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Excel=1]="Excel",e[e.Word=2]="Word",e[e.OneNote=3]="OneNote",e[e.Outlook=4]="Outlook",e[e.Teams=5]="Teams",e[e.Event=6]="Event",e[e.Meeting=7]="Meeting",e[e.TeamsMeeting=8]="TeamsMeeting",e[e.SharePoint=9]="SharePoint",e[e.Web=10]="Web",e[e.PDF=11]="PDF",e[e.Zip=12]="Zip",e[e.HTML=13]="HTML",e[e.Visio=14]="Visio",e[e.Image=15]="Image",e[e.Fluid=16]="Fluid",e[e.Video=17]="Video",e[e.Vector=18]="Vector",e[e.Txt=19]="Txt",e[e.ThirdParty=20]="ThirdParty",e[e.Loop=21]="Loop",e[e.Planner=22]="Planner"}(o||(o={})),function(e){e[e.Read=0]="Read",e[e.ReadMetadata=1]="ReadMetadata",e[e.Create=2]="Create"}(i||(i={})),function(e){e.Word="Word",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Excel="Excel",e.Outlook="Outlook",e.Web="Web",e.Pdf="Pdf",e.Planner="Planner",e.Loop="Loop"}(a||(a={})),function(e){e.BodyText="BodyText",e.Title="Title",e.SubTitle="SubTitle",e.Heading="Heading",e.Table="Table",e.ImageAltText="ImageAltText",e.SmartArtText="SmartArtText",e.Comment="Comment",e.VisualDescription="VisualDescription",e.SlideText="SlideText",e.InkHandwriting="Ink Handwriting"}(r||(r={})),function(e){e[e.Personalization_Indicator=1]="Personalization_Indicator"}(c||(c={})),function(e){e[e.Confirm_Set_Personalization_Profile=1]="Confirm_Set_Personalization_Profile",e[e.Confirm_Delete_Personalization_Profile=2]="Confirm_Delete_Personalization_Profile",e[e.Visual_Summary=3]="Visual_Summary",e[e.PPT_Summary=4]="PPT_Summary",e[e.PPT_Speaker_Notes=5]="PPT_Speaker_Notes"}(l||(l={})),function(e){e.Text="Text",e.Section="Section"}(u||(u={}))},518645:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CorrelationVector=void 0;class s{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<o;e++)i[e]=n[Math.floor(Math.random()*n.length)];return i.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let n;return n=e.endsWith(".0")?new s(e.substring(0,e.length-2)):new s(e),t&&(n.childCount=t),n}newChild(){return++this.childCount,new s(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}t.CorrelationVector=s;const n=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],o=22,i=new Array(o)},521409:(e,t,s)=>{s.d(t,{tG:()=>C,nh:()=>O,am:()=>A,OD:()=>N,ih:()=>P});var n,o=s(976941),i=s(610396);!function(e){e.Log="Log"}(n||(n={}));var a=s(72715);const r=void 0!==a&&a.env?a.env.SERVICE_NAME:"client",c="abcdefghijklmnopqrstuvwxyz0123456789",l={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let u,p=[],g=[],h=e=>null,d=e=>{};const m=new Map,y=new Map,T=new Map,f=new Map;var _,C;!function(e){e.Default="",e.EDPSCompliant="edps"}(_||(_={})),function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{p=[],g=[],y.clear(),T.clear()},e.clearAggregators=()=>{m.clear()},e.addLogger=e=>{-1===p.indexOf(e)&&(p.push(e),S(y,e))},e.addDecidingLogger=e=>{-1===g.indexOf(e)&&(g.push(e),S(T,e))},e.setCorrelationContextCallback=e=>{u=e},e.setStartPerformanceEventCallback=e=>{h=e},e.setStopPerformanceEventCallback=e=>{d=e},e.addAggregator=e=>{e.init(((e,t)=>{M(e,t)})),m.has(e.eventName)?m.get(e.eventName).push(e):m.set(e.eventName,[e])},e.flushAggregators=e=>{m.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const s=R(e);f.set(s,t)},e.resetTagLevelOverrides=()=>{f.clear()},e.error=(e,t,s,n,i,a,r,c,l,u)=>{k(e,t,o.q.error,s,n,i,a,r,c,l,u)},e.warn=(e,t,s,n,i,a,r,c,l,u)=>{k(e,t,o.q.warn,s,n,i,a,r,c,l,u)},e.info=(e,t,s,n,i,a,r,c,l,u)=>{k(e,t,o.q.info,s,n,i,a,r,c,l,u)},e.verbose=(e,t,s,n,i,a,r,c,l,u)=>{k(e,t,o.q.verbose,s,n,i,a,r,c,l,u)},e.debug=(e,t,s,n,i,a,r,c,l,u)=>{k(e,t,o.q.debug,s,n,i,a,r,c,l,u)},e.metric=(e,t,s,n,i,a,r,c,l,u)=>{k(e,t,o.q.metric,s,n,i,a,r,c,l,u)},e.formatMetric=(e,t,s,n)=>{const o={};return o[e]={dimensionNames:s,dimensionValues:n,value:t},o},e.dynamic=e=>{M(e)}}(C||(C={}));const S=(e,t)=>{const s=t.level;Object.keys(o.q).map((e=>o.q[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=s)).forEach((s=>{e.has(s)?e.get(s).push(t):e.set(s,[t])}))},A=e=>{if("string"==typeof e)return e;let t="";for(let s=0;s<e.length;s++){s>0&&(t+=" ");const n=e[s];n instanceof Error?t+=JSON.stringify({message:n.message,name:n.name,stack:n.stack}):t+="object"==typeof n?JSON.stringify(n):n}return t},v=[],I=["Level","Tag"],w=["Level","Tag","Workflow"],N=e=>E(e).length,E=e=>void 0!==e?y.get(e)||v:p,b=(e,t)=>(void 0!==e?T.get(e)||[]:g).filter((e=>e.shouldLog(t))),k=(e,t,s,o,i,a,r,c,l,p,g)=>{s=f.get(e)||s;const y=E(s),T=b(s,o);if(0==y.length&&0==T.length)return;const _=h(n.Log),C=P(e),S=((e,t,s,n,o,i,a,r)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const c=[];for(const l of[e,t,s,n,o,i,a,r])void 0!==l&&c.push("function"==typeof l?l():l);return c})(o,i,a,r,c,l,p,g);if(L(t))B(S)&&M({eventName:"Metrics",tagId:C,category:`${t.root}.${t.name}`,traceLevel:s,message:"",getMetrics:()=>S},!1,y,T);else if(B(S)){const e=S;e.tagId=C,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",u&&(e.joinContextId=u().joinContextId,e.workflow=u().workflow)),e.traceLevel=s;const n=m.get(e.eventName);if(n)for(let t=0;t<n.length;++t){const s=n[t];if(s&&s.add(e,t===n.length-1))break}else M(e,!1,y,T)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>I,dimensionValues:[String(s),C],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>w,dimensionValues:[String(s),C,u?null===(e=u())||void 0===e?void 0:e.workflow:""],value:1}}};M({eventName:"Log",tagId:C,category:`${t.root}.${t.name}`,traceLevel:s,message:A(S),getMetrics:e},!1,y,T)}d(_)},M=(e,t=!1,s,n)=>{var o,i,a,c,l,p,g,h,d,m,y,T,f,_;let C;if(null==s&&(s=E(e.traceLevel)),n=n||v,s.length>0||n.length>0){if(e.serviceName=r,!t&&u){const t=u();t&&(C={disableLogging:t.disableLogging,userDataBoundaryType:null===(i=null===(o=t.sessionDescriptor)||void 0===o?void 0:o.userContext)||void 0===i?void 0:i.userDataBoundaryType},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.userTenantId=e.userTenantId?e.userTenantId:t.userTenantId,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(a=t.clientMetadata)||void 0===a?void 0:a.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(c=t.clientMetadata)||void 0===c?void 0:c.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(l=t.clientMetadata)||void 0===l?void 0:l.appVersion,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(p=t.clientMetadata)||void 0===p?void 0:p.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(d=t.clientMetadata)||void 0===d?void 0:d.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(m=t.clientMetadata)||void 0===m?void 0:m.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(y=t.clientMetadata)||void 0===y?void 0:y.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(T=t.clientMetadata)||void 0===T?void 0:T.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(f=t.clientMetadata)||void 0===f?void 0:f.isClientTelemetrySampled,e.userDataBoundaryType=D(C),e.ecsConfigIDs=null===(_=t.ecsConfigIDsManager)||void 0===_?void 0:_.getAllConfigIDsString())}for(const t of s)t.log(e,C);for(const t of n)t.log(e)}},L=e=>e.name===O.WorkflowMetricsOnly.name&&e.root===O.WorkflowMetricsOnly.root,B=e=>!Array.isArray(e)&&"object"==typeof e,D=e=>(null==e?void 0:e.userDataBoundaryType)===i.Om.EDPSCompliant?_.EDPSCompliant:_.Default,P=e=>c[e>>24&63]+c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e],R=e=>e&&5===e.length?l[e.charCodeAt(0)]<<24|l[e.charCodeAt(1)]<<18|l[e.charCodeAt(2)]<<12|l[e.charCodeAt(3)]<<6|l[e.charCodeAt(4)]:-1;class O{}O.CoreDefault=C.defineCoreLogCategory("Default"),O.CoreSystem=C.defineCoreLogCategory("System"),O.CoreUnsampled=C.defineCoreLogCategory("Unsampled"),O.WorkflowDefault=C.defineWorkflowLogCategory("Default"),O.WorkflowUnsampled=C.defineWorkflowLogCategory("Unsampled"),O.WorkflowMetricsOnly=C.defineWorkflowLogCategory("MetricsOnly"),O.PrivacyGuardEvent=C.defineCoreLogCategory("PrivacyGuardEvent")},533188:(e,t,s)=>{s.d(t,{I9:()=>o,c7:()=>a,ep:()=>i});var n=s(985002),o=(function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ControlSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_InteractionModeSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_StartupSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfigSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();!function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ShutdownSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},534342:(e,t,s)=>{s.d(t,{v:()=>o});var n=s(117954);class o extends n.L{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}},537319:(e,t,s)=>{s.d(t,{CT:()=>o,Pd:()=>a,tP:()=>i});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_SharedCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_OperationResponse"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_CopilotChatHistoryErrorOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_AddMessageOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetAllChatsOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetCurrentChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_GetMessagesInCurrentChatSessionOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_RemoveAllMessagesFromCurrentChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){n.h.assign(T,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_DeleteChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){n.h.assign(f,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateMessageOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){n.h.assign(_,this,e)}static getTypeName(){return"AugLoop_CopilotChatHistory_UpdateChatOperationResponse"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_OperationResponse"]}static typeGuard(e){return n.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()}},537491:(e,t,s)=>{s.d(t,{Q:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthSubreason="",e.prototype.summarizedFindings="",e.prototype.affectedResource="",e.prototype.affectedSessions="",e.prototype.suppressionReason="",e.prototype.modelItemsCountBucket="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionIssueEvent"},e}())},538194:(e,t,s)=>{s.d(t,{g:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.host="",e.prototype.statusCode=0,e.prototype.success=!1,e.prototype.wait=0,e.prototype.dns=0,e.prototype.tcp=0,e.prototype.firstByte=0,e.prototype.download=0,e.prototype.total=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OutboundHttpRequestEvent"},e}())},547942:(e,t,s)=>{var n;s.d(t,{f:()=>n}),function(e){e[e.NotAuthenticated=0]="NotAuthenticated",e[e.Pending=1]="Pending",e[e.Authenticated=2]="Authenticated",e[e.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated",e[e.TokenMissingInteractionRequired=4]="TokenMissingInteractionRequired"}(n||(n={}))},556830:(e,t,s)=>{s.d(t,{h:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},567179:(e,t,s)=>{var n,o,i,a,r,c,l;s.d(t,{d2:()=>r}),function(e){e.USER_PROMPT="userPrompt",e.INVOKE_SKILL="invokeSkill",e.GENERATE_TABLE="generateTable",e.GENERATE_SUMMARY="generateSummary",e.GENERATE_CONTENT_LENGTH_SPECIFIED="generateContentLengthSpecified",e.GENERATE_CONTENT="generateContent",e.GENERATE_CONTENT_WITH_EMOJI="generateContentWithEmoji",e.REWRITE_CONTENT="rewriteContent",e.REWRITE_CONTENT_WITH_EMOJIS="rewriteContentWithEmojis",e.REWRITE_CONTENT_WITH_GROUNDING_CONTENT_FROM_FILE="rewriteContentWithGroundingContentFromFile",e.FORMAT_CONTENT="formatContent",e.TRANSLATE_CONTENT="translateContent",e.USER_QUERY="userQuery",e.USER_QUERY_CIP="userQueryCIP",e.OPERATE_ON_TABLE="operateOnTable",e.CONTENT_GENERATION_FROM_FILES="contentGenerationFromFiles",e.GENERATE_DATA_VISUALISATION_CHART="generateChartVisualisation",e.GENERATE_IMAGE="generateImage",e.GENERATE_ARTIFACT="generateArtifact",e.GENERATE_ARTIFACT_FROM_FILE="generateArtifactFromFile",e.ORGANIZE_FILES_IN_FOLDER="organizeFilesInFolder",e.REFRESH_DATA="refreshData",e.GENERATE_PODCAST="generatePodcast",e.NOT_KNOWN="notKnown"}(n||(n={})),function(e){e.INSERT="insert",e.UPDATE="update"}(o||(o={})),function(e){e.HTML="html",e.JSON="json",e.XML="xml",e.TEXT="text",e.ERROR_TEXT="error_text",e.MARKDOWN="markdown"}(i||(i={})),function(e){e.WEB_SEARCH_DETERMINATION="webSearchDetermination",e.INTENT_DETECTION="intentDetection",e.CONTENT_GENERATION="contentGeneration",e.CONTENT_EVALUATION="contentEvaluation",e.CONTENT_GENERATION_WITH_WEB_SEARCH="contentGenerationWithWebSearch"}(a||(a={})),function(e){e.INIT_SERVICE="initService",e.FETCH_FILE_LIST="fetchFileList",e.FETCH_CONTENT="fetchContent",e.GENERATE_DATA="generateData",e.GENERATE_CONTENT_WITH_EMOJIS_FROM_CONTENT="generateContentWithEmojisFromContent",e.SERVICE_RESPONSE="serviceResponse",e.CLIENT_ACK="clientAck",e.FETCH_CHAT_HISTORY="fetchChatHistory",e.FETCH_CONTENT_METADATA="fetchContentMetadata",e.GENERATE_SUGGESTIONS="generateSuggestions",e.CLEAN_UP="cleanUp",e.CONVERT_TO_BLOG="convertToBlog",e.SET_CONFIG="setConfig",e.REFRESH_DATA="refreshData",e.EVAL_AND_PERF_METRICS="evalAndPerfMetrics",e.GENERATE_ARTIFACT="generateArtifact",e.ORGANIZE_FILES_IN_FOLDER="organizeFilesInFolder",e.FETCH_FILES_USING_CONTEXT_SEARCH="fetchFilesUsingContextSearch",e.GENERATE_HIERARCHY_TREE_FOR_FOLDER="generateHierarchyTreeForFolder",e.GENERATE_ARTIFACT_FROM_FILE="generateArtifactFromFile",e.PODCAST_CREATION="podcastCreation"}(r||(r={})),function(e){e.DOCX="docx",e.DOC="doc",e.XLSX="xlsx",e.TEXT="txt",e.PDF="pdf",e.PEOPLE="people",e.PPTX="pptx",e.HTML="html",e.JSON="json",e.EMAIL="eml",e.UNKNOWN="unknown",e.MP4="mp4",e.AVI="avi",e.WMV="wmv",e.MP3="mp3",e.PNG="png",e.JPG="jpg",e.CSV="csv",e.EXTENSION_NOT_AVAILABLE="extension_not_available",e.YAML="yaml"}(c||(c={})),function(e){e.SENSITIVE_FILE="Sensitive file",e.METADATA_DOWNLOAD_FAILED="File metadata download failed",e.CONTENT_DOWNLOAD_FAILED="File content download failed",e.ACCESS_DENIED="No permission to access the file."}(l||(l={}))},571919:(e,t,s)=>{s.d(t,{Qu:()=>a,VR:()=>i,jP:()=>o});var n=s(985002),o=function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyInput"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionConversation"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},580717:(e,t,s)=>{var n;s.d(t,{D:()=>o,T:()=>n}),function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}(n||(n={}));class o extends Error{constructor(e="ExpectedError"){super(e),this.__proto__=o.prototype}}},581469:(e,t,s)=>{s.d(t,{kZ:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_CopilotChatTeachingUISignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_GetTUIEverShownStateOperation"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotChatTeachingUi_SetTUIEverShownStateOperation"}static getBaseTypes(){return["AugLoop_CopilotChatTeachingUi_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},585638:(e,t,s)=>{var n;s.d(t,{m:()=>n}),function(e){e[e.Unknown=0]="Unknown",e[e.Fatal=1]="Fatal",e[e.TokenExpired=2]="TokenExpired",e[e.ModelWorkflowNotSupported=3]="ModelWorkflowNotSupported",e[e.LargeWorkbooksNotSupported=4]="LargeWorkbooksNotSupported"}(n||(n={}))},586377:(e,t,s)=>{s.d(t,{A9:()=>a,XO:()=>i,aG:()=>r});var n=s(493491);const o=new(s(488096).O);class i{constructor(){this._isCancellationRequested=!1,this.onCancelCallbacks=[]}cancel(){if(!this._isCancellationRequested){this._isCancellationRequested=!0;for(const e of this.onCancelCallbacks)e(this);this.onCancelCallbacks=[]}}get IsCancellationRequested(){return this._isCancellationRequested}onCancel(e){this._isCancellationRequested?e(this):this.onCancelCallbacks.push(e)}rejectWhenCancellationRequested(){return new Promise(((e,t)=>{this.onCancel((()=>t(new n._b("Token cancelled"))))}))}removeCancelCallback(e){const t=this.onCancelCallbacks.indexOf(e);t>-1&&this.onCancelCallbacks.splice(t,1)}dispose(){this.onCancelCallbacks=[]}}class a{constructor(e){this.internalToken=new i,this.clearScheduledCancel=null,this.scheduler=null!=e?e:o}get token(){return this.internalToken}cancel(){var e;this.internalToken.IsCancellationRequested||(this.internalToken.cancel(),null===(e=this.clearScheduledCancel)||void 0===e||e.call(this))}cancelAfter(e){var t;if(this.token.IsCancellationRequested)return;if(e<0)throw new Error("Duration can not be negative");null===(t=this.clearScheduledCancel)||void 0===t||t.call(this);const s=this.scheduler.executeAfter((()=>{this.cancel(),this.clearScheduledCancel=null}),e);this.clearScheduledCancel=()=>{s(),this.clearScheduledCancel=null}}dispose(){var e;this.internalToken&&(null===(e=this.clearScheduledCancel)||void 0===e||e.call(this),this.internalToken.dispose(),this.internalToken=null)}}class r{constructor(...e){this.innerCancelSource=new a,this.unsubscribeFromTokens=null,this.onLinkedTokenCancelled=()=>{var e;this.innerCancelSource.cancel(),null===(e=this.unsubscribeFromTokens)||void 0===e||e.call(this)},this.subscribeToTokens(e)}get token(){return this.innerCancelSource.token}dispose(){var e;null===(e=this.unsubscribeFromTokens)||void 0===e||e.call(this)}subscribeToTokens(e){e.some((e=>e.IsCancellationRequested))?this.innerCancelSource.cancel():(e.forEach((e=>e.onCancel(this.onLinkedTokenCancelled))),this.unsubscribeFromTokens=()=>{this.unsubscribeFromTokens=null,e.forEach((e=>e.removeCancelCallback(this.onLinkedTokenCancelled)))})}}},590844:(e,t,s)=>{s.d(t,{Mw:()=>a,VT:()=>i,Wd:()=>o});var n=s(985002),o=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oFinalResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oTranscript"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oProcessingEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_GPT4oErrorEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_AudioCopilotAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_CVChunkCompleteAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_DocumentHandlerResponse"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_OAAudioCopilotAnnotation"},e.getBaseTypes=function(){return["AugLoop_ConversationalCopilot_AudioCopilotAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}());!function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ConversationalCopilot_ActionsAudioAnnotation"},e.getBaseTypes=function(){return["AugLoop_ConversationalCopilot_AudioCopilotAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},591475:(e,t,s)=>{s.d(t,{n:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_TenantFeedbackData_FeedbackDiagnosticDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},596374:(e,t,s)=>{s.d(t,{$g:()=>i,Fe:()=>o,J2:()=>r,Nh:()=>g,Vm:()=>p,Vn:()=>h,Zx:()=>l,c$:()=>c,gh:()=>u,os:()=>a});var n=s(985002),o=function(){function e(t){n.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UxTreatments"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationODSP"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotation","AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),u=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),p=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),g=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),h=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},598033:(e,t)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.countExcelErrors=t.toExcelError=t.ExcelError=void 0,function(e){e.Div0="#DIV/0!",e.NA="#N/A",e.Name="#NAME?",e.Null="#NULL!",e.Num="#NUM!",e.Ref="#REF!",e.Value="#VALUE!",e.GettingData="#GETTING_DATA",e.Calc="#CALC!",e.Spill="#SPILL!",e.Field="#FIELD!",e.Data="#DATA",e.Unknown="#UNKNOWN!",e.Busy="#BUSY!"}(s||(t.ExcelError=s={}));const n=new Set(Object.values(s));function o(e){if(n.has(e))return e}t.toExcelError=o,t.countExcelErrors=function(e){let t=0;const n=e.map(o).reduce(((e,s)=>(s&&(t++,e[s]=(e[s]||0)+1),e)),{}),i=t-(n[s.NA]||0),a=0===e.length?0:t/e.length*100,r=0===e.length?0:i/e.length*100;return{totalErrors:t,errorCounts:n,errorPercentage:a,errorPercentageWithoutNA:r}}},601317:(e,t,s)=>{var n=s(72715);Object.defineProperty(t,"__esModule",{value:!0}),t.nowMicroSeconds=t.now=void 0;t.now=void 0!==n&&n.hrtime?()=>{const e=n.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now(),t.nowMicroSeconds=void 0!==n&&n.hrtime?()=>{const e=n.hrtime();return 1e6*e[0]+e[1]/1e3}:"undefined"!=typeof performance&&performance.now?()=>Math.round(1e3*performance.now()):()=>1e3*Date.now()},607908:(e,t,s)=>{s.d(t,{_:()=>i});var n=s(94470),o=s(297330);class i{static createFactory(e=".",t,s,o){return a=>{var r;const c=s||n.e3;return!i.onnxRetrievalPromise||a?e?((null===(r=c())||void 0===r?void 0:r.ai_outlook)&&!a?Promise.resolve():(0,n.el)(`${e}/ai_outlook.min.js`,c,"ai_outlook",t,o)).then((()=>{i.onnxRetrievalPromise=Promise.resolve(new i(c))})).catch((e=>{i.onnxRetrievalPromise=Promise.reject(e)})).then((()=>i.onnxRetrievalPromise)):Promise.reject(new Error("Error: folderPath not provided")):i.onnxRetrievalPromise}}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var s;const n=null===(s=this.getCache())||void 0===s?void 0:s.ai_outlook;return n?(n.env.wasm.simd=!0,n.env.wasm.numThreads=0,o.Kx.create(e,t||"",n)):Promise.reject(new Error("Error: aiOutlook is undefined"))}createInputs(){return o.G0.create()}}},607915:(e,t,s)=>{s.d(t,{I:()=>o});const n=new(s(962019).eU)("disabledChangeGates",[]),o=(e,t,...s)=>{const o=-1===n.getValue().indexOf(e);return t?o?t(...s):void 0:o}},610396:(e,t,s)=>{var n,o,i,a,r;s.d(t,{Av:()=>a,OY:()=>n,Om:()=>i,rN:()=>r,ut:()=>o}),function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp",e[e.Dropbox=27]="Dropbox",e[e.GooglePhotos=28]="GooglePhotos",e[e.EditorApp=29]="EditorApp",e[e.AmazonKindle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege",e[e.IntentSvcApp=34]="IntentSvcApp",e[e.DcgLowPrivilege=35]="DcgLowPrivilege",e[e.CSALowPrivilege=36]="CSALowPrivilege",e[e.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege",e[e.CompliantSydneyApp=38]="CompliantSydneyApp",e[e.M365AdminApp=39]="M365AdminApp",e[e.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege",e[e.AlchemyApp=41]="AlchemyApp",e[e.M365Admin=42]="M365Admin",e[e.ConsumerShellApp=43]="ConsumerShellApp",e[e.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege",e[e.CIIApp=45]="CIIApp",e[e.ConsumerShell=46]="ConsumerShell",e[e.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege",e[e.Pva=48]="Pva",e[e.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege",e[e.CallAnalytics=50]="CallAnalytics",e[e.IncomingPFT=51]="IncomingPFT",e[e.GraphExchange=52]="GraphExchange",e[e.EXOAdmin=53]="EXOAdmin",e[e.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege",e[e.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege",e[e.EcsAppOnly=56]="EcsAppOnly",e[e.ShredderLowPrivilege=57]="ShredderLowPrivilege",e[e.SpoLowPrivilege=58]="SpoLowPrivilege",e[e.PromptValidationApp=59]="PromptValidationApp",e[e.CompliantSydneyLowPrivilege=60]="CompliantSydneyLowPrivilege",e[e.SubstrateTenantFeedbackApp=61]="SubstrateTenantFeedbackApp",e[e.MonitoringPlatform=62]="MonitoringPlatform",e[e.YammerLowPrivilege=63]="YammerLowPrivilege",e[e.VivaLearningLowPrivilege=64]="VivaLearningLowPrivilege",e[e.VivaInsightsLowPrivilege=65]="VivaInsightsLowPrivilege",e[e.ClientAugLoopApp=66]="ClientAugLoopApp",e[e.AssistAuthLowPrivilege=67]="AssistAuthLowPrivilege",e[e.VivaLearningSearchPreProdLowPrivilege=68]="VivaLearningSearchPreProdLowPrivilege",e[e.SubstrateSearchApp=69]="SubstrateSearchApp",e[e.SparkContentPlatformLowPrivilege=70]="SparkContentPlatformLowPrivilege",e[e.SparkContentPlatformPopApp=71]="SparkContentPlatformPopApp",e[e.ConsumerSydneyApp=72]="ConsumerSydneyApp",e[e.BusinessAssistAuthLowPrivilege=73]="BusinessAssistAuthLowPrivilege",e[e.AzureResourceManager=74]="AzureResourceManager",e[e.AlchemyPortal=75]="AlchemyPortal",e[e.VivaUserSkillsApp=76]="VivaUserSkillsApp",e[e.VivaEngageAppPop=77]="VivaEngageAppPop",e[e.SubstrateAppOnly=78]="SubstrateAppOnly",e[e.PowerAutomateFlowCreationLowPrivilege=79]="PowerAutomateFlowCreationLowPrivilege",e[e.PowerAutomateConnectionCreationLowPrivilege=80]="PowerAutomateConnectionCreationLowPrivilege",e[e.PowerAutomateAuthorizeConnectionLowPrivilege=81]="PowerAutomateAuthorizeConnectionLowPrivilege",e[e.TCAAppPop=82]="TCAAppPop",e[e.BusinessAssistAuthAppPop=83]="BusinessAssistAuthAppPop",e[e.HolmesApp=84]="HolmesApp",e[e.GraphAppOnly=85]="GraphAppOnly",e[e.SimsApp=86]="SimsApp",e[e.VivaOrgInsightsLowPrivilege=87]="VivaOrgInsightsLowPrivilege",e[e.VivaGoalsAppPop=88]="VivaGoalsAppPop",e[e.GCBotAppPop=89]="GCBotAppPop",e[e.ShredderV2App=90]="ShredderV2App",e[e.ShredderV2LowPrivilege=91]="ShredderV2LowPrivilege",e[e.AmplifyProfileService=92]="AmplifyProfileService",e[e.AzureDevopsLowPrivilege=93]="AzureDevopsLowPrivilege",e[e.CommuteServices=94]="CommuteServices",e[e.GCBotAppOnly=95]="GCBotAppOnly",e[e.TCAAppOnly=96]="TCAAppOnly",e[e.MavenAgentLowPrivilege=97]="MavenAgentLowPrivilege",e[e.VivaOrgInsightsAppPop=98]="VivaOrgInsightsAppPop",e[e.EduAssignmentsPftAtPop=99]="EduAssignmentsPftAtPop",e[e.AugloopAppPop=100]="AugloopAppPop",e[e.OneNoteLowPrivilege=101]="OneNoteLowPrivilege",e[e.TeamsAuthzSvcAppPop=102]="TeamsAuthzSvcAppPop",e[e.LoopAppPop=103]="LoopAppPop",e[e.LoopAppOnly=104]="LoopAppOnly",e[e.BapLowPrivilege=105]="BapLowPrivilege",e[e.IC3AppPop=106]="IC3AppPop",e[e.PowerPlatformApiGateway=107]="PowerPlatformApiGateway",e[e.OdspNotifyAppPop=108]="OdspNotifyAppPop",e[e.MIPSyncService=109]="MIPSyncService",e[e.RightsManagementServices=110]="RightsManagementServices",e[e.TCAV2AppPop=111]="TCAV2AppPop",e[e.SubstrateLLMLowPrivilege=112]="SubstrateLLMLowPrivilege",e[e.SubstrateSearchLowPrivilege=113]="SubstrateSearchLowPrivilege",e[e.CloudPolicyServiceAppPop=114]="CloudPolicyServiceAppPop",e[e.TCAV2LowPrivilege=115]="TCAV2LowPrivilege",e[e.AiHubServicesAppPop=116]="AiHubServicesAppPop",e[e.TMRAppOnly=117]="TMRAppOnly",e[e.PacmanAppPop=118]="PacmanAppPop",e[e.AugloopAlternativeIdentity=119]="AugloopAlternativeIdentity",e[e.SpoAppOnly=120]="SpoAppOnly",e[e.DataverseLowPrivilege=121]="DataverseLowPrivilege",e[e.SubstrateLLMApp=122]="SubstrateLLMApp",e[e.SimsAppOnly=123]="SimsAppOnly",e[e.PythonService=124]="PythonService",e[e.PythonServiceAppOnly=125]="PythonServiceAppOnly",e[e.DesignerAppServiceLowPrivilege=126]="DesignerAppServiceLowPrivilege",e[e.DesignerAppServiceAppPop=127]="DesignerAppServiceAppPop",e[e.AmplifyProfileServiceAppOnly=128]="AmplifyProfileServiceAppOnly",e[e.MARSAppPop=129]="MARSAppPop",e[e.PlannerAppPop=130]="PlannerAppPop",e[e.BingForBusinessLowPrivilege=131]="BingForBusinessLowPrivilege",e[e.OLS=132]="OLS",e[e.OLSAppPop=133]="OLSAppPop",e[e.GCS=134]="GCS",e[e.AugLoopConsumer=135]="AugLoopConsumer",e[e.ContentValidationServiceAppOnly=136]="ContentValidationServiceAppOnly",e[e.FabricLowPrivilege=137]="FabricLowPrivilege",e[e.FeatureAccessManagementAppPop=138]="FeatureAccessManagementAppPop",e[e.FireIntelligenceAppOnly=139]="FireIntelligenceAppOnly",e[e.MARSLowPrivilege=140]="MARSLowPrivilege",e[e.EXOAdminAppPop=141]="EXOAdminAppPop",e[e.IncomingAT=142]="IncomingAT",e[e.CopilotLabLowPrivilege=143]="CopilotLabLowPrivilege",e[e.VivaPulseLowPrivilege=144]="VivaPulseLowPrivilege",e[e.WacAppPop=145]="WacAppPop",e[e.PowerAppsAiBuilderLowPrivilege=146]="PowerAppsAiBuilderLowPrivilege",e[e.CognitiveApiAppOnly=147]="CognitiveApiAppOnly",e[e.CopilotMetricsAppOnly=148]="CopilotMetricsAppOnly",e[e.ShredderAppOnly=149]="ShredderAppOnly",e[e.TeamsAuthzSvcLowPrivilege=150]="TeamsAuthzSvcLowPrivilege",e[e.PlannerLowPrivilege=151]="PlannerLowPrivilege"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(o||(o={})),function(e){e[e.Default=0]="Default",e[e.EDPSCompliant=1]="EDPSCompliant"}(i||(i={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(a||(a={})),function(e){e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut"}(r||(r={}))},629271:(e,t,s)=>{s.d(t,{J1:()=>n});var n,o;!function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token",e[e.SpeAlCodedLocation=4]="SpeAlCodedLocation"}(n||(n={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(o||(o={}));class i{}i.lowerIndexBound=1,i.maxNumberOfRows=1048576,i.maxNumberOfColumns=16384,i.firstColumnName="A",i.lastColumnName="XFD"},633522:(e,t,s)=>{s.d(t,{K7:()=>l,PO:()=>r,Qn:()=>o,e9:()=>u,mH:()=>n,xv:()=>a,zy:()=>i});const n=2;var o,i,a,r,c,l,u;!function(e){e[e.ServerError=0]="ServerError",e[e.WorkflowDisabled=100]="WorkflowDisabled",e[e.TokenNotReady=101]="TokenNotReady",e[e.FlightNotReady=102]="FlightNotReady",e[e.ContextNotReady=103]="ContextNotReady",e[e.WorkflowExcluded=104]="WorkflowExcluded",e[e.WorkflowExecutionTimeout=105]="WorkflowExecutionTimeout",e[e.LambdaExecutionError=106]="LambdaExecutionError",e[e.UnexpectedOutput=107]="UnexpectedOutput",e[e.FailedToFetchInputs=108]="FailedToFetchInputs",e[e.FailedToFetchRequestedContexts=109]="FailedToFetchRequestedContexts"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidRequest=1]="InvalidRequest",e[e.InvalidResponse=2]="InvalidResponse",e[e.RuntimeNotInitialized=3]="RuntimeNotInitialized",e[e.RequestCancelled=4]="RequestCancelled",e[e.ResponseReceivedAfterFinalResponse=5]="ResponseReceivedAfterFinalResponse"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Found=302]="Found",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.UnprocessableContent=422]="UnprocessableContent",e[e.TooManyRequests=429]="TooManyRequests",e[e.SocketDisconnect=499]="SocketDisconnect",e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.UnsupportedMessage=1e3]="UnsupportedMessage",e[e.Cancelled=1001]="Cancelled",e[e.EgressError=1002]="EgressError",e[e.SyncMessageException=2e3]="SyncMessageException",e[e.SyncMessageUnsupported=2001]="SyncMessageUnsupported",e[e.SyncMessageUnexpectedSeed=2002]="SyncMessageUnexpectedSeed",e[e.SyncMessageUnsupportedBatch=2003]="SyncMessageUnsupportedBatch",e[e.SyncMessageQueueFull=2004]="SyncMessageQueueFull",e[e.SyncMessageTooLateOrDuplicate=2005]="SyncMessageTooLateOrDuplicate",e[e.SyncMessageGroupIdMismatch=2006]="SyncMessageGroupIdMismatch",e[e.SyncMessageGroupStop=2007]="SyncMessageGroupStop",e[e.SyncMessageLost=2008]="SyncMessageLost",e[e.SyncMessageUnprocessedDuplicate=2009]="SyncMessageUnprocessedDuplicate",e[e.SyncMessageSessionClosed=2010]="SyncMessageSessionClosed",e[e.SyncMessageAbandoned=2011]="SyncMessageAbandoned",e[e.SyncMessageTooManyDeltaOperations=2012]="SyncMessageTooManyDeltaOperations",e[e.SyncMessageSessionSizeLimitExceeded=2013]="SyncMessageSessionSizeLimitExceeded",e[e.TokenValidationError=2100]="TokenValidationError",e[e.TokenDecryptError=2101]="TokenDecryptError",e[e.TokenTypeError=2102]="TokenTypeError",e[e.TokenUserBlocked=2103]="TokenUserBlocked",e[e.AnnotationActivationInvalidType=2200]="AnnotationActivationInvalidType",e[e.AnnotationReleaseTokenNotFound=2300]="AnnotationReleaseTokenNotFound"}(a||(a={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.Start=1]="Start",e[e.Regular=2]="Regular",e[e.CheckConnection=3]="CheckConnection",e[e.PostEgress=4]="PostEgress",e[e.TimeoutResend=5]="TimeoutResend",e[e.FailResend=6]="FailResend"}(r||(r={})),function(e){e[e.IdentityChange=0]="IdentityChange"}(c||(c={})),function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(l||(l={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Incomplete=2]="Incomplete",e[e.Finished=3]="Finished"}(u||(u={}))},658835:(e,t,s)=>{var n,o,i,a,r,c,l,u;s.d(t,{Rk:()=>i,b_:()=>o,lp:()=>c,ss:()=>p,w2:()=>u,ye:()=>n}),function(e){e[e.None=0]="None",e[e.Unrecognized=1]="Unrecognized",e[e.RowMajor=2]="RowMajor",e[e.HasMergedCells=4]="HasMergedCells",e[e.UnsupportedAggregations=8]="UnsupportedAggregations",e[e.NoHeaderRow=16]="NoHeaderRow",e[e.MultipleHeaderRows=32]="MultipleHeaderRows",e[e.HeaderColumns=64]="HeaderColumns",e[e.LowInterpretationConfidence=128]="LowInterpretationConfidence",e[e.EmptyHeaders=256]="EmptyHeaders",e[e.DuplicateHeaders=512]="DuplicateHeaders",e[e.Crosstab=1024]="Crosstab",e[e.TotalsRow=2048]="TotalsRow",e[e.MultipleHeaderColumns=4096]="MultipleHeaderColumns",e[e.NoHeaderColumn=8192]="NoHeaderColumn",e[e.HeaderRows=16384]="HeaderRows",e[e.All=-2049]="All"}(n||(n={})),function(e){e[e.None=0]="None",e[e.ChartSelected=1]="ChartSelected",e[e.PivotTableSelected=2]="PivotTableSelected",e[e.PayloadTooLarge=4]="PayloadTooLarge",e[e.All=-1]="All"}(o||(o={})),function(e){e.Pill="pill",e.ZQM="zqm",e.ChatUserPrompt="chatUserPrompt",e.ChatPill="chatPill",e.ChatZQM="chatZqm",e.GridFormulaGenerationIPEOnCellEdit="gridFormulaGenerationIPEOnCellEdit",e.GridSkittleMenu="gridSkittleMenu",e.GridContextMenu="gridContextMenu",e.GridExplanationOnCellEdit="gridExplanationOnCellEdit",e.GridFormulaErrorCard="gridFormulaErrorCard",e.GridCopilotTab="gridCopilotTab",e.MsFormsSDX="msFormsSDX",e.MsFormsServer="msFormsServer",e.MsFormsWeb="msFormsWeb",e.CopilotSDX="copilotSDX",e.GridFormulaCompletion="onGridCompletion",e.AAChartingRibbon="AAChartingRibbon",e.GridSkittleContextualSuggestion="gridSkittleContextualSuggestion"}(i||(i={})),function(e){e.Insights="get_insights",e.CalculatedColumns="calculated_columns;create_columns",e.EditDocument="edit_document",e.Data_shaping="data_shaping",e.CalculatedRows="calculated_columns;aggregate",e.PythonCode="get_python_code",e.PythonCalculatedColumns="python_calculated_columns",e.ImportData="import_data",e.Else="excel_else"}(a||(a={})),function(e){e.Command="Command",e.ConditionalFormatting="Conditional format",e.GenerateFormula="Generate formula",e.FormulaCorrection="Formula correction and repair",e.FormulaSimplification="Formula simplification",e.FormulaModification="Formula modification",e.FormulaExplanation="Formula explanation",e.FormulaHelp="Formula help",e.CopilotCapabilities="Copilot capabilities",e.ExcelHelp="Excel help",e.HowToGeneric="How-to generic",e.HowToCustom="How-to custom",e.AnalysisDescribe="Analysis describe",e.AnalysisSummarize="Analysis summarize",e.AnalysisPredict="Analysis predict",e.AnalysisCalculate="Analysis calculate",e.AnalysisHelp="Analysis help",e.AnalysisVisualize="Analysis visualize",e.Answers="Answers",e.VBAGenerate="VBA generate",e.VBAExplain="VBA explain",e.VBAFix="VBA fix",e.VBAHelp="VBA help",e.PivotCreate="Pivot create",e.PivotModify="Pivot modify",e.PivotHelp="Pivot help",e.Python="Python",e.Else="Else"}(r||(r={})),function(e){e.StandardTable="StandardTable",e.TableLikeRange="TableLikeRange"}(c||(c={})),function(e){e.MSForms="MSForms"}(l||(l={})),function(e){e[e.None=0]="None",e[e.TooManyPivotTables=1]="TooManyPivotTables",e[e.TooManyCharts=2]="TooManyCharts"}(u||(u={}));const p="a1c76418-b11e-465f-9b75-c8095676380e"},669076:(e,t,s)=>{s.d(t,{Wh:()=>g,fm:()=>p,j5:()=>u});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCalculateColumnPreviewAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCalculateRowPreviewAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetRangeAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetFileTablesMetadataAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadSingleCellPreviewAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCommandingAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadChartRecommendationAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadStartNewSessionAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGeneratedFormulaPreviewAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadExecutePythonCodeRequestAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetPythonCodeResultAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadStartSnapshotAnnotation"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},673586:(e,t,s)=>{s.d(t,{E:()=>n});const n=e=>o(e,Number.POSITIVE_INFINITY),o=(e,t)=>{let s=0;const n=[],o=[e];for(;o.length>0;){const e=o.pop(),i=typeof e;if("boolean"===i)s+=4;else if("string"===i)s+=2*e.length;else if("number"===i)s+=8;else if("object"===i&&e&&-1===n.indexOf(e))if(e instanceof Uint8Array)s+=e.length;else{n.push(e);for(const t in e)o.push(e[t])}if(s>t)return s}return s}},675202:(e,t,s)=>{s.d(t,{B3:()=>N,De:()=>S,NU:()=>E,PM:()=>v,yg:()=>w});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateStep"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateColumnRename"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateWithColumnNamesStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateWithRowIndexAndDataProviderStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateWithRowIndexProviderStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateAddColumnStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateAddRowsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithRowIndexAndDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateRenameColumnsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateReplaceColumnStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateReplaceRowsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithRowIndexAndDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateReplaceTableStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateSelectColumnsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithColumnNamesStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){n.h.assign(T,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateSelectRowsStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithRowIndexProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){n.h.assign(f,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateSortStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithRowIndexProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){n.h.assign(_,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdateSplitColumnStep"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_TableUpdateWithDataProviderStep","AugLoop_ExcelDataShaping_TableUpdateStep"]}static typeGuard(e){return n.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){n.h.assign(C,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_TableUpdatePlan"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(S,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class A{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(A,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class v{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(v,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingCreateQueryAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class I{constructor(e){n.h.assign(I,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingTransformationStep"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class w{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(w,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingCreateStepsAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class N{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(N,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingEditQueryAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class E{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(E,this,e)}static getTypeName(){return"AugLoop_ExcelDataShaping_ExcelDataShapingTableUpdatePlanAnnotation"}static getBaseTypes(){return["AugLoop_ExcelDataShaping_ExcelDataShapingAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()}},677744:(e,t,s)=>{s.d(t,{Dv:()=>r,lL:()=>a,sG:()=>i});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_ExtendedFormulaSuggestion"}static getBaseTypes(){return["AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_CalculatedColumnSuggestion"}static getBaseTypes(){return["AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_CalculatedCellSuggestion"}static getBaseTypes(){return["AugLoop_ExcelIntelligence_GeneratedFormulaSuggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},680912:(e,t,s)=>{s.d(t,{P:()=>i});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_MeteringApiResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_GenerativeAi_GenerativeAIMeteringResponse"}static getBaseTypes(){return["AugLoop_GenerativeAi_MeteringApiResponse","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},681672:(e,t,s)=>{var n,o;s.d(t,{f:()=>n,h:()=>o}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Other=1]="Other",e[e.Jpg=2]="Jpg",e[e.Png=3]="Png",e[e.Bmp=4]="Bmp"}(n||(n={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Other=1]="Other",e[e.Small=2]="Small",e[e.Medium=3]="Medium",e[e.Large=4]="Large"}(o||(o={}))},691891:(e,t,s)=>{s.d(t,{Qr:()=>h,rK:()=>m,x5:()=>d});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowCancellationRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingRequest","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()}},696992:(e,t,s)=>{s.d(t,{YV:()=>a});var n;!function(e){e[e.None=0]="None",e[e.FormulaR1C1=1]="FormulaR1C1",e[e.Text=2]="Text",e[e.NumberFormat=4]="NumberFormat",e[e.RawValue=8]="RawValue",e[e.NumberFormatCategory=16]="NumberFormatCategory",e[e.Borders=32]="Borders",e[e.FillColor=64]="FillColor",e[e.FontColor=128]="FontColor",e[e.FontOptions=256]="FontOptions",e[e.UseNewFormatFetcher=512]="UseNewFormatFetcher",e[e.SparseCells=1024]="SparseCells",e[e.OmitCoordsForAdjacentCell=2048]="OmitCoordsForAdjacentCell",e[e.FormulaA1=4096]="FormulaA1",e[e.IsFormula=8192]="IsFormula",e[e.IncludeRichFormattedEmptyCells=16384]="IncludeRichFormattedEmptyCells",e[e.NumberFormatNonLocalized=32768]="NumberFormatNonLocalized",e[e.NotSupportedInAugloop=65536]="NotSupportedInAugloop",e[e.FetchMultipleRanges=131072]="FetchMultipleRanges",e[e.NotSupportedInAugloop2=262144]="NotSupportedInAugloop2"}(n||(n={}));var o,i,a,r,c,l,u,p,g,h,d;!function(e){e.Dimension="dimension",e.Measure="measure"}(o||(o={})),function(e){e.None="none",e.Sum="sum",e.Count="count",e.Average="average",e.Min="min",e.Max="max",e.DistinctCount="distinctCount",e.StdDev="stdDev",e.Variance="variance"}(i||(i={})),function(e){e.RowMajor="rowMajor",e.ColumnMajor="columnMajor"}(a||(a={})),function(e){e[e.None=0]="None",e[e.RowsSampled=1]="RowsSampled",e[e.ColumnsSampled=2]="ColumnsSampled"}(r||(r={})),function(e){e.None="none",e.Other="other",e.ColumnMajorFlat="columnMajorFlat",e.RowMajorFlat="rowMajorFlat",e.SimpleCrossTable="simpleCrossTable"}(c||(c={})),function(e){e.None="none",e.ColumnMajorTabularSkipRows="columnMajorTabularSkipRows",e.RowMajorTabularSkipColumns="rowMajorTabularSkipColumns "}(l||(l={})),function(e){e.Dimension="dimension",e.Measure="measure"}(u||(u={})),function(e){e.None="none",e.Sum="sum",e.Count="count",e.Average="average",e.Min="min",e.Max="max",e.DistinctCount="distinctCount",e.StdDev="stdDev",e.Variance="variance"}(p||(p={})),function(e){e.RowMajor="rowMajor",e.ColumnMajor="columnMajor"}(g||(g={})),function(e){e.None="none",e.ColumnMajorTabularSkipRows="columnMajorTabularSkipRows",e.RowMajorTabularSkipColumns="rowMajorTabularSkipColumns "}(h||(h={})),function(e){e.None="None",e.Invisible="Invisible",e.Visible="Visible",e.InferredByCopilotLicense="InferredByCopilotLicense"}(d||(d={}))},707897:(e,t,s)=>{var n,o,i;s.d(t,{OY:()=>o,Pu:()=>i}),function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(n||(n={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(i||(i={}))},708029:(e,t,s)=>{s.d(t,{YH:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_ExecutionCorrelatedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},719843:(e,t)=>{var s;Object.defineProperty(t,"__esModule",{value:!0}),t.PerformanceEventType=void 0,function(e){e.Log="Log"}(s||(t.PerformanceEventType=s={}))},723768:(e,t,s)=>{s.d(t,{xB:()=>es,Nd:()=>Jt,HF:()=>Yt,fA:()=>Xt});var n=s(976941),o=s(301520),i=s(521409);var a=s(738460),r=s(399115),c=s(72715);const l="object"==typeof c&&"object"==typeof c.versions&&void 0!==c.versions.node,u=1e5;class p{constructor(e,t){this.networkOverrideOptions=e,this.settings=t,this.hadEgressError=!1,this.isClosing=!1,this.pendingEgress=[]}get egressByteCountOp(){return this._egressByteCountOp||(this._egressByteCountOp=new o.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0}),this._egressByteCountOp.setClientMetadata(this.clientMetadata,!0)),this._egressByteCountOp}init(e,t,s,n,a){var c,u;if(this.clientMetadata=a,l&&this.networkOverrideOptions){const t={servername:null===(c=this.networkOverrideOptions)||void 0===c?void 0:c.hostHeader,headers:(null===(u=this.networkOverrideOptions)||void 0===u?void 0:u.hostHeader)?{host:this.networkOverrideOptions.hostHeader}:void 0};this.ws=new r.A(e,t)}else this.ws=new r.A(e);this.logOp=new o.I({operationName:p.className,success:!0}).start(),this.logOp.setClientMetadata(a,!0),this.ingressByteCountOp=new o.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp.setClientMetadata(a,!0),this.ws.addEventListener("open",(e=>{s(),this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),i.tG.info(508843801,i.nh.CoreDefault,this.logOp.stop())})),this.ws.addEventListener("message",(e=>{this.logIngressCount(e.data),t(e.data)})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,i.tG.info(508843800,i.nh.CoreDefault,this.logOp.stop()),this.ws?this.ws.close():this.logWsUndefinedError("error event handler")})),this.ws.addEventListener("close",(e=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,i.tG.info(508843799,i.nh.CoreDefault,this.logOp.stop()),n(this.errorMessage),this.isClosing=!1}))}egress(e){var t;const s=e.obj;(null===(t=this.settings)||void 0===t?void 0:t.webSocketWorkerShouldLogEgressCount)&&this.logEgressCount(s),this.ws.send(s,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,i.tG.info(508843797,i.nh.CoreDefault,this.logOp.stop()))}))}close(){this.isClosing||(this.isClosing=!0,this.ws?this.ws.close():this.logWsUndefinedError("close"))}logIngressCount(e){const t=e.length;t>u&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),i.tG.info(508843794,i.nh.CoreDefault,this.ingressByteCountOp.stop()))}logEgressCount(e){const t="string"==typeof e?e.length:e.byteLength;t>u&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=t.toString().length.toString(),i.tG.info(505710625,i.nh.CoreDefault,this.egressByteCountOp.stop()))}logWsUndefinedError(e){const t=new o.I({operationName:p.className,success:!1}).start();t.setClientMetadata(this.clientMetadata,!0),t.resourceId="webSocketUndefined",t.resultDescription=e+": this.ws null or undefined",i.tG.info(506566722,i.nh.CoreDefault,t.stop())}}p.className="WebSocketWorker";var g=s(868713),h=s(813373),d=s(230529),m=s(962019),y=s(607915),T=s(985002),f=s(633522),_=s(184175),C=s(270314),S=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};const A=new m.eU("processMessageEndpointValidation",!1);var v,I;function w(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let s;for(const n of t)if(0===e.indexOf(n)){s=n;break}if(!s)return"MalformedMessageName";const n="Message",o=e.indexOf(n,e.length-7)===e.length-7;return e.slice(s.length,o?-7:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.ClientClosed="Client closed",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found",e.TooManyDeltaOperations="SyncMessage with too many delta operations",e.UnsupportedSyncMessageSeq0NonSeeding="SyncMessages with seq 0 are not supported in non seeding sequencer (SenderId)."}(v||(v={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(I||(I={}));class N{constructor(e){this.config=e,this.nextMessageId=1,this.pendingResponseCallbacks=new C.l({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageValidators=new Map,this.messageIdPrefix=e.messageIdPrefix,this.source="c"===e.messageIdPrefix?h.aM.ClientRuntime:h.aM.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e,this.config.resendPendingMessagesOnReconnect&&this.egress&&this.pendingResponseCallbacks.forEach(((e,t)=>{e.logOp.dimension1=(e.sendCount++).toString(),this.egress(e.message,(t=>this.onEgressError(t,e)))}))}ingress(e,t){_.YK.typeGuard(e)?(this.processResponse(e),t()):this.processMessage(e,t),_.w9.typeGuard(e)&&!e.reconnectAllowed&&this.clearAllPendingResponses()}sendMessage(e,t,s,n=0){var o,a;const r=new h.vf({sessionHealthEventName:"SendMessage",source:this.source,reason:h.l6.Client,impact:this.source===h.aM.ClientRuntime?h.Pq.MissingInput:h.Pq.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:w(T.h.getTypeNameFor(e)),dimension0:n.toString()}).start().enableAggregation(),c=()=>{if(r.setClientMetadata(this.clientMetadata),r.success)i.tG.info(572836e3,i.nh.CoreDefault,r.stop());else{const e="ErrorWithoutPendingResponse"===r.resultSignature||"ResponseCallbackException"===r.resultSignature||"We called into done callback"!==r.message;r.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),i.tG.error(572836001,i.nh.CoreDefault,r.stop())}};(0,y.I)("PersistMessageId")?e.messageId=null!==(o=e.messageId)&&void 0!==o?o:`${this.messageIdPrefix}${this.nextMessageId++}`:e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`,_.l0.typeGuard(e)&&e.messages.forEach(((t,s)=>t.messageId=e.messageId+"."+s));const l=T.h.getTypeNameFor(e)===_.w9.getTypeName(),u={message:e,logOp:r,logEvent:c,callback:void 0,sendCount:1};if(!s&&!l){u.callback=(s,n)=>{var o;if(s?(0,y.I)("IgnoreUnsupportedMessageErrorForOldClientVersion")&&s.code===f.xv.UnsupportedMessage?(r.resultSignature="Success",r.resultDescription=`Ignore error for ${T.h.getTypeNameFor(e)} message ${e.messageId}${_.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${s.error}`):(r.success=!1,r.resultSignature=s.error,r.resultDescription=`Error for ${T.h.getTypeNameFor(e)} message ${e.messageId}${_.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${s.error}`):r.resultSignature="Success",t)try{r.message="We called into done callback",t(s,n)}catch(e){r.success=!1,r.resultSignature="ResponseCallbackException",r.resultDescription="Web"===(null===(o=this.clientMetadata)||void 0===o?void 0:o.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}c(),this.updateSendMessageStats(r.success,r.durationMs,s?new Error(s.error):void 0)};const s=()=>{u.callback(new _.F_({code:f.xv.RequestTimeout,error:"Timeout waiting for response"}),void 0)};let n=this.config.responseTimeoutMs;if(_.LQ.typeGuard(e)){const t=e;n=t.longPollTimeoutHint>=15e3&&t.longPollTimeoutHint<=3e5?t.longPollTimeoutHint+5e3:12e4}else _.Yp.typeGuard(e)&&(n=null!==(a=e.maxDelayMs)&&void 0!==a?a:12e4);this.pendingResponseCallbacks.put(e.messageId,u,n,s)}this.egress&&this.egress(e,(e=>this.onEgressError(e,u)),n)}onEgressError(e,t){var s,n;if(e){const o=t.message,i=this.pendingResponseCallbacks.get(t.message.messageId);i?(this.pendingResponseCallbacks.del(o.messageId),i.callback(new _._p({messageId:o.messageId,code:f.xv.EgressError,error:e.message}))):_.w9.typeGuard(o)?(t.logOp.success=null!==(n=null===(s=e.message)||void 0===s?void 0:s.endsWith("Client disconnected."))&&void 0!==n&&n,t.logOp.resultSignature="ErrorSendingSessionCloseMessage",t.logOp.resultDescription=`Error for ${T.h.getTypeNameFor(o)} message ${o.messageId}: ${e.message}`,t.logEvent()):(t.logOp.success=!1,t.logOp.resultSignature="ErrorWithoutPendingResponse",t.logOp.resultDescription=`Error for ${T.h.getTypeNameFor(o)} message ${o.messageId}: ${e.message}`,t.logEvent())}}queryEgressCacheSize(){return this.pendingResponseCallbacks.size()}onMessage(e,t,s){this.messageCallbacks.set(e,t),s&&this.messageValidators.set(e,s)}onMessageAsync(e,t,s){this.messageCallbacks.set(e,((e,s)=>S(this,void 0,void 0,(function*(){try{const n=yield t(e);_._p.typeGuard(n)?s(n,void 0):s(void 0,n)}catch(e){s(e)}})))),s&&this.messageValidators.set(e,s)}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(e){this.pendingResponseCallbacks.forEach(((t,s)=>{t&&(this.pendingResponseCallbacks.del(s),t.callback(new _._p({messageId:s,code:f.xv.Cancelled,error:`Cancelled. Reason: ${e}`})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new o.I({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});i.tG.info(572836002,i.nh.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){const s=new h.vf({sessionHealthEventName:"ProcessMessage",source:this.source,reason:h.l6.Client,impact:this.source===h.aM.ClientRuntime?h.Pq.MissingOutput:h.Pq.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start().enableAggregation(),n=()=>{if(s.setClientMetadata(this.clientMetadata),s.success)i.tG.info(572836003,i.nh.CoreDefault,s.stop());else{const e="UnsupportedMessage"===s.resourceId||"Timeout"===s.resultSignature||"OnResponseInvokedMoreThanOnce"===s.resultSignature||"MessageCallbackException"===s.resultSignature||"We called into messageCallback"!==s.message;s.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),i.tG.error(572836032,i.nh.CoreDefault,s.stop())}};let o=this.messageCallbacks.get(T.h.getTypeNameFor(e));o?s.resourceId=w(T.h.getTypeNameFor(e)):o=(e,t)=>{s.resourceId=w(T.h.getTypeNameFor(e)),"MalformedMessageName"!==s.resourceId&&(s.resourceId="UnsupportedMessage"),t(new _._p({messageId:e.messageId,code:f.xv.UnsupportedMessage,error:`Message type ${T.h.getTypeNameFor(e)} is not supported`}))};const a=(e,t,s)=>!0===A.getValue()?JSON.stringify({message:e,validationSuccess:null==t?void 0:t.success,validationError:null==t?void 0:t.error,validationDurationMicroseconds:null==t?void 0:t.durationMicroseconds,stack:s}):void 0!==s?JSON.stringify({message:e,stack:s}):e;let r;const c=this.messageValidators.get(T.h.getTypeNameFor(e));if(c&&A.getValue()){const t=(0,d.g)(),s=c.validate(e),n=(0,d.g)();r={success:s.success,error:s.error,durationMicroseconds:Math.round(n-t)}}let l=!1;const u=(o,i)=>{if(l){s.success=!1,s.resultSignature="OnResponseInvokedMoreThanOnce";const t=`Invoked onResponse for ${T.h.getTypeNameFor(e)} message ${e.messageId} more than once`;s.resultDescription=a(t,r)}else if(o){s.success=!1,s.resultSignature=o.error,void 0!==o.code&&(s.dimension0=f.xv[o.code]);const t=`Error for ${T.h.getTypeNameFor(e)} message ${e.messageId}: ${o.error}`;s.resultDescription=a(t,r)}else s.resultSignature="Success",s.resultDescription=a("",r);l=!0,n(),o&&!T.h.matchesTypesFor(o,[_._p.getTypeName()])&&(o=new _._p({error:"Internal Server Error"})),this.updateProcessMessageStats(s.success,s.durationMs,o?new Error(o.error):void 0),o?(o.messageId=e.messageId,t(o)):i?(i.messageId=e.messageId,t(void 0,i)):t()};try{s.message="We called into messageCallback",o(e,u)}catch(e){s.success=!1,s.resultSignature="MessageCallbackException",s.resultDescription=a(e.message,r,e.stack),n(),this.updateProcessMessageStats(!1,s.durationMs,e),t()}}processResponse(e){var t;const s=new o.I({operationName:"ProcessResponse"});if(s.success=!0,s.setClientMetadata(this.clientMetadata),s.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId),n=null==t?void 0:t.callback;if(n){if(_.i.typeGuard(e)&&!e.finalResponse){const s=t.message.maxDelayMs;this.pendingResponseCallbacks.updateExpireTime(e.messageId,s)}else this.pendingResponseCallbacks.del(e.messageId);T.h.matchesTypesFor(e,[_._p.getTypeName()])?n(e):n(void 0,e)}else s.resultSignature="NoPendingMessage",s.resultDescription=`${e.messageId}`,s.success=!1}else s.resultSignature="NoMessageIdSetInResponse",_._p.typeGuard(e)?s.resultDescription=e.error:s.resultDescription="MessageId is not available",s.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(s.resourceId=w(T.h.getTypeNameFor(e)),i.tG.info(572836034,i.nh.CoreDefault,s.stop()))}updateSendMessageStats(e,t,s){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||s?e&&s&&i.tG.warn(572836036,i.nh.CoreDefault,"Succeeded send message provided error object."):i.tG.warn(572836035,i.nh.CoreDefault,"Failed send message did not provide error object."),e||(s&&s.message===v.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,s){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||s?e&&s&&i.tG.warn(572836038,i.nh.CoreDefault,"Succeeded process message provided error object."):i.tG.warn(572836037,i.nh.CoreDefault,"Failed process message did not provide error object."),e||(s&&s.message===I.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}var E,b=s(309156),k=s(475769),M=s(93440),L=s.n(M);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(E||(E={}));class B{constructor(e){this.logOp=new o.I({operationName:"MessageQueue",success:!0}),this.queue=new(L())(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,s){this.logOp.start();const n=this.queue;if(1e3===n.length){this.logOp.resourceId="QueueFull",this.logOp.success=!1,i.tG.warn(508843746,i.nh.CoreDefault,this.logOp.stop());const e=n.shift();e.onResponse&&e.onResponse(new _._p({error:E.DroppedAsOldestInQueue}))}n.push({message:e,onResponse:t,timeQueued:k.Aq.getCurrentTimeMs(),attemptNumber:s})}sendOnSessionInitialized(e){this.logOp.start();const t=this.queue.length;let s=0;if(t>0){const n=k.Aq.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&this.containSequencedSyncMessage(t)?(s++,t.onResponse&&t.onResponse(new _._p({error:E.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${s}`,this.logOp.setDataField("OldestMessageInQueueTimeWaitingMs",n),this.logOp.success=!0,i.tG.warn(508843745,i.nh.CoreDefault,this.logOp.stop())}}containSequencedSyncMessage(e){return e.message instanceof _.Tb&&T.h.matchesTypesFor(e.message,[_.Tb.getTypeName()])&&e.message.seq>=0||e.message instanceof _.l0&&T.h.matchesTypesFor(e.message,[_.l0.getTypeName()])}}var D;!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(D||(D={}));const P=(e,t,s,n)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,n)=>{t||T.h.getTypeNameFor(n)!==_.fZ.getTypeName()||(e.stats.lastSyncMessage=Date.now()),s&&s(t,n)}),void 0,n))},R=(e,t,s,n)=>{t&&(e.messageQueue.push(t,s,n),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new o.I({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});i.tG.error(508843789,i.nh.CoreDefault,t)})))},O=(e,t)=>{t&&(e.messageQueue.push(t),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{i.tG.error(508843788,i.nh.CoreDefault,`Init failed: ${e}`)})))};class x{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,s,n){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class F extends x{constructor(){super(...arguments),this.stateName=D.Initing,this.possibleNextStates=[D.Running,D.Disconnected,D.Closed]}sendMessage(e,t,s){T.h.matchesTypesFor(e,[_.eE.getTypeName()])?P(this.context,e,t,s):R(this.context,e,t)}sendBytes(e){O(this.context,e)}onConnectionClose(){this.context.setState(D.Disconnected)}}class G extends x{constructor(){super(...arguments),this.stateName=D.Running,this.possibleNextStates=[D.Disconnected,D.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)}sendMessage(e,t,s,n){P(this.context,e,t,s)}sendBytes(e){e&&this.context.networkWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(D.Disconnected)}}class W extends x{constructor(){super(...arguments),this.stateName=D.Disconnected,this.possibleNextStates=[D.Initing,D.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(v.ClientDisconnected)}sendMessage(e,t,s,n){if(T.h.matchesTypesFor(e,[_.eE.getTypeName()]))this.context.setState(D.Initing),P(this.context,e,t,s);else if(T.h.matchesTypesFor(e,[_.w9.getTypeName()]))this.context.setState(D.Closed);else{if(!n)return void R(this.context,e,t,s);t&&t(new _._p({messageId:e.messageId,error:E.DroppedBecauseClientDisconnected}))}}sendBytes(e){O(this.context,e)}}class H extends x{constructor(){super(...arguments),this.stateName=D.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(v.ClientClosed)}}var U=s(469408),q=s(427999),V=s(691891);const $=3e4;class j{constructor(e,t,s,n){this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.remainingPingFailures=3,this.isPingPongSuccessful=!1,this.reducedPingPongRetryEnabled=n,this.pingPongLogOp=new o.I({operationName:"WebSocketReliabilityManager",success:!0,resourceId:this.reducedPingPongRetryEnabled?"reducedPingPongRetryEnabled":""}).start(),this.pingPongLogOp.setClientMetadata(s,!0),this.worker=e,this.rateControllerClose=t}start(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.resultSignature="initial ping"):this.logOperation(!0,"ping","initial ping"),this.ping(),this.isPingPongSuccessful=!0,this.startInterval()}onResponse(){this.lastPongTime=Date.now(),this.reducedPingPongRetryEnabled&&(this.pingPongLogOp.success=!0,i.tG.info(506795283,i.nh.CoreDefault,this.pingPongLogOp.stop()))}isReliabilityResponse(e){return"string"==typeof e&&1===e.length&&e===j.pingPongMessage}close(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.success=!0,this.pingPongLogOp.resultSignature="close",i.tG.info(506795282,i.nh.CoreDefault,this.pingPongLogOp.stop())):this.logOperation(!0,"ping","close"),this.lastPingTime=0,this.lastPongTime=0,this.isPingPongSuccessful=!1,this.clearPingInterval(),this.worker=void 0}checkConnection(){return this.isPingPongSuccessful}postEgress(){this.lastEgressTime=Date.now()}needsParsedResponses(){return!1}ping(){this.reducedPingPongRetryEnabled?this.worker||(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="websocket worker undefined",this.rateControllerClose(),i.tG.info(506795281,i.nh.CoreDefault,this.pingPongLogOp.stop())):this.lastPingTime=Date.now(),this.worker&&(this.reducedPingPongRetryEnabled&&(this.lastPingTime=Date.now()),this.worker.egress({obj:j.pingPongMessage}))}startInterval(){this.pingInterval=setInterval((()=>{if(this.reducedPingPongRetryEnabled){if(this.lastPongTime<this.lastPingTime&&Date.now()-this.lastPingTime<$)return;this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime,this.pingPongLogOp.start(),this.isPingPongSuccessful?(this.pingPongLogOp.resultSignature="ping",this.ping()):(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="Pong not received",i.tG.info(506795280,i.nh.CoreDefault,this.pingPongLogOp.stop()),this.worker?this.worker.close():this.rateControllerClose())}else{if(this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=$,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.isPingPongSuccessful?(this.remainingPingFailures=3,this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.ping()):(this.logOperation(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.worker?this.worker.close():this.rateControllerClose())}}),$)}clearPingInterval(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)}logOperation(e,t,s,n){var o,a,r,c;this.pingPongLogOp.start(),this.pingPongLogOp.success=e,this.pingPongLogOp.resultSignature=t,this.pingPongLogOp.resultDescription=s,n&&(this.pingPongLogOp.dimension0=null!==(o=n[0])&&void 0!==o?o:"",this.pingPongLogOp.dimension1=null!==(a=n[1])&&void 0!==a?a:"",this.pingPongLogOp.dimension2=null!==(r=n[2])&&void 0!==r?r:"",this.pingPongLogOp.dimension3=null!==(c=n[3])&&void 0!==c?c:""),i.tG.info(507320073,i.nh.CoreDefault,this.pingPongLogOp.stop())}}j.pingPongMessage="~";const z="Request timed out";class K{constructor(e,t,s){this.remainingRetryAttempts=4,this.isAsleep=!1,this.isLongPollSuccessful=!1,this.isActiveLongPoll=!1,this.isResponseReceived=!1,this.lastEgressTime=0,this.longPollLogOp=new o.I({operationName:"OnLongPollMessage",success:!0}),this.clientMetadata=t,this.sessionCorrelationVector=s,this.longPollLogOp.setClientMetadata(this.clientMetadata,!0),this.worker=e}start(){const e=new o.I({operationName:"StartHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),i.tG.info(508163399,i.nh.CoreDefault,e.stop()),this.trySendLongPoll(f.PO.Start,!0),this.isLongPollSuccessful=!0}onResponse(e){if(!e||this.isResponseReceived){const e=new o.I({operationName:"HttpReliabilityManagerFailure",success:!1}).start();return e.setClientMetadata(this.clientMetadata,!0),void i.tG.info(508162497,i.nh.CoreDefault,e.stop())}this.isResponseReceived=!0,this.isActiveLongPoll=!1;const t=e;if(t.error)if(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,this.remainingRetryAttempts>0){this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription=`Retry attempts left : ${this.remainingRetryAttempts}`,this.longPollLogOp.resultSignature=t.error,i.tG.info(508163398,i.nh.CoreDefault,this.longPollLogOp.stop());const e=t.error===z?f.PO.TimeoutResend:f.PO.FailResend;t.error===z||3===this.remainingRetryAttempts?this.trySendLongPoll(e,!0):this.enqueueSendLongPoll(e)}else this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",i.tG.info(508163397,i.nh.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close();else this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",i.tG.info(508163401,i.nh.CoreDefault,this.longPollLogOp.stop()),this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll(f.PO.Regular)}close(){const e=new o.I({operationName:"CloseHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),i.tG.info(508162467,i.nh.CoreDefault,e.stop()),this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0),this.isActiveLongPoll=!1,this.isLongPollSuccessful=!1,this.worker=void 0}checkConnection(){if(this.isAsleep){this.isAsleep=!1;const e=new o.I({operationName:"AwakenHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),i.tG.info(508162496,i.nh.CoreDefault,e.stop()),this.trySendLongPoll(f.PO.CheckConnection,!0)}return this.isLongPollSuccessful}isReliabilityResponse(e){return"string"!=typeof e&&_.ry.typeGuard(e)}postEgress(){this.lastEgressTime=Date.now(),this.trySendLongPoll(f.PO.PostEgress)}needsParsedResponses(){return!0}enqueueSendLongPoll(e){this.sendLongPollTimer=setTimeout((()=>{this.trySendLongPoll(e,!0)}),2e4)}trySendLongPoll(e,t){if(!this.worker){const e=new o.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Worker is undefined",void i.tG.info(507281438,i.nh.CoreDefault,e.stop())}if(!0===this.isActiveLongPoll){const e=new o.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Already active long poll",void i.tG.info(508163396,i.nh.CoreDefault,e.stop())}if(this.isActiveLongPoll=!0,Date.now()-this.lastEgressTime>6e4&&!t){this.isActiveLongPoll=!1,this.isAsleep=!0;const e=new o.I({operationName:"LongPollSleep",success:!0}).start();return e.setClientMetadata(this.clientMetadata),e.resultDescription=`isAsleep: ${this.isAsleep}, isActiveLongPoll: ${this.isActiveLongPoll}`,void i.tG.info(507278739,i.nh.CoreDefault,e.stop())}this.longPollLogOp.start(),this.isResponseReceived=!1,this.worker.egress({obj:this.getLongPollMessageString(e),isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1})}getLongPollMessageString(e){const t=new _.LQ({longPollTimeoutHint:15e3,type:e});return this.sessionCorrelationVector&&(t.cv=this.sessionCorrelationVector().newChild().toString()),JSON.stringify(t)}}var Q=s(87477);const J=JSON.stringify(new _.ry({error:q.t$}));class Y{constructor(e){this.networkOverrideOptions=e,this.isClosed=!1,this.pendingEgress=[]}init(e,t,s,n){const a=new o.I({operationName:"HttpWorkerInit",success:!0}).start(),r=e.split("/?x-origin=");2===r.length?(this.url=k.Aq.convertWebSocketUrlToHttp(r[0]),this.origin=r[1]):(this.url=k.Aq.convertWebSocketUrlToHttp(e),this.origin=void 0),this.ingress=t,this.onOpen=s,this.onClose=n,i.tG.info(507839180,i.nh.CoreDefault,a.stop())}egress(e){const t=new o.I({operationName:"HttpEgress",success:!0}).start();if(!this.isConnectedToSession()&&!e.isHttpSessionInitMessage)return this.pendingEgress.push(e),t.success=!1,t.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),void i.tG.info(508163394,i.nh.CoreDefault,t.stop());const s=this.getRequestInfo(e,t);if(!s.url)return t.success=!1,t.resultDescription="Could not generate HTTP request",void i.tG.error(508163393,i.nh.CoreDefault,t.stop());e.isHttpSessionLongPollMessage?this.egressLongPoll(s,t):(0,q.OW)(s.url,s.request,((e,s)=>{e?this.onEgressError(t,"OnEgressError:"+(null==e?void 0:e.message)):s&&s.ok?s.text().then((e=>{t.success=!0,i.tG.info(508163362,i.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"OnEgressParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"OnEgressResponseError: "+(null==e?void 0:e.message)+`, Status ${null==s?void 0:s.status}: ${null==s?void 0:s.statusText}`)}))}close(){const e=new o.I({operationName:"HttpWorkerClose",success:!0}).start();if(this.isClosed)return e.resultDescription="AlreadyClosed",void i.tG.info(508163360,i.nh.CoreDefault,e.stop());i.tG.info(508163359,i.nh.CoreDefault,e.stop()),this.isClosed=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0)}onEgressError(e,t){e.success=!1,e.resultDescription=t,i.tG.error(508163358,i.nh.CoreDefault,e.stop()),this.isClosed||this.close()}ingressInternal(e,t){let s=e;t||(s=this.formatServerInput(e));const n=e=>{_.uN.typeGuard(e)&&this.onSessionInitResponse(e)};s&&(this.logIngressCount(s),this.ingress(s,n))}onSessionInitResponse(e){const t=new o.I({operationName:"HttpWorkerOpen",success:!0}).start();if(!(e.sessionKey&&e.origin&&e.anonymousToken&&e.sessionUrlBase))return t.success=!1,t.resultDescription="SessionInitResponse missing information",void i.tG.error(507809949,i.nh.CoreDefault,t.stop());i.tG.info(508163357,i.nh.CoreDefault,t.stop()),this.setSessionSettings(e.sessionKey,e.origin,e.anonymousToken,e.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[]}egressLongPoll(e,t){(0,q._A)(e.url,2e4,e.request).then((e=>{e&&e.ok?e.text().then((e=>{t.success=!0,t.resourceId="LongPoll",i.tG.info(508163355,i.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"LongPollFetchParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"LongPollFetchStatusFailure: "+(null==e?void 0:e.statusText))})).catch((e=>{e.message===q.t$?(t.success=!1,t.resultDescription="LongPollFetchResponseTimeout:"+(null==e?void 0:e.message),i.tG.error(508163353,i.nh.CoreDefault,t.stop()),this.ingressInternal(J,!0)):this.onEgressError(t,"LongPollFetchResponseError: "+(null==e?void 0:e.message))}))}getRequestInfo(e,t){const s=this.getUrl(null==e?void 0:e.isHttpSessionInitMessage),n=this.getHeader(e,t);return t.resultSignature=s,{url:s,request:{method:"POST",headers:n,body:e.obj}}}getUrl(e){const t=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return e?t+"/sessioninit":this.isConnectedToSession()?t+"/session/"+this.sessionSettings.sessionKey:""}getHeader(e,t){var s;const n=new Q.Headers;return(null==e?void 0:e.isHttpSessionInitMessage)?(n.set("Content-Type","application/json"),this.origin&&n.set("x-origin",this.origin)):this.isConnectedToSession()&&(e.obj instanceof Uint8Array||e.obj instanceof ArrayBuffer?(n.set("Content-Type","application/jsond2"),t.dimension0=e.obj.byteLength.toString().length.toString()):n.set("Content-Type","application/json"),n.append("Authorization",`Bearer ${this.sessionSettings.anonymousToken}`),n.set("x-origin",this.sessionSettings.origin)),(null===(s=this.networkOverrideOptions)||void 0===s?void 0:s.hostHeader)&&n.set("host",this.networkOverrideOptions.hostHeader),n}setSessionSettings(e,t,s,n){const o=n.replace("/session","");this.sessionSettings={sessionKey:e,origin:t,anonymousToken:s,sliceUrl:o}}isConnectedToSession(){return this.sessionSettings&&this.sessionSettings.sessionKey.length>0&&this.sessionSettings.anonymousToken.length>0&&this.sessionSettings.origin.length>0&&this.sessionSettings.sliceUrl.length>0&&!this.isClosed}formatServerInput(e){return e.length>1?e.substring(1,e.length-1):""}logIngressCount(e){const t=e.length;if(t>1e5){const e=new o.I({operationName:"HttpIngressByteOrderOfMagnitude",success:!0}).start();e.dimension2=t.toString().length.toString(),i.tG.info(508409622,i.nh.CoreDefault,e.stop())}}}var Z=s(178058),X=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};const ee=1e5,te=3e6,se=1e3;class ne{constructor(e){var t;this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.rpsThreshold=150,this.bpsThreshold=5e8,this.isClosing=!1,this.messageQueue=void 0,this.egressRateLogOp=new o.I({operationName:"NetworkEgressRate",success:!0}),this.egressedCache=new Map,this.initPromise=new Promise((e=>{this.resolveInitPromise=e})),this.messageQueue=new(L()),this.reducedPingPongRetryEnabled=null!==(t=null==e?void 0:e.reducedPingPongRetryEnabled)&&void 0!==t&&t}init(e,t,s,n,o){this.worker=e,this.ingress=t,this.clientMetadata=n,this.networkMode=s,this.reliabilityManager=((e,t,s,n,o)=>e instanceof Y?new K(e,s,n):new j(e,t,s,o))(this.worker,this.close.bind(this),void 0,o,this.reducedPingPongRetryEnabled),this.egressRateLogOp.setClientMetadata(this.clientMetadata,!0),this.resetRateLimiter(),this.onCloseController=new Promise((e=>{this.resolveCloseControllerPromise=e})),this.queueProcessingCompletePromise=new Promise((e=>{this.resolveQueueProcessingCompletePromise=e})),this.resolveInitPromise()}open(){const e=new o.I({operationName:"NetworkRateControllerOpen",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),this.initPromise.then((()=>{if(!this.reliabilityManager)return e.success=!1,void(e.resultDescription="Reliability Manager is undefined");this.egressRateControlIntervalStart=Date.now(),this.reliabilityManager.start(),this.processQueue()})).catch((t=>{var s;e.success=!1,e.resultDescription="Catch: "+(null!==(s=null==t?void 0:t.message)&&void 0!==s?s:"")})).finally((()=>{i.tG.info(507834384,i.nh.CoreDefault,e.stop())}))}ingressFromWorker(e,t){this.reliabilityManager?this.reliabilityManager.needsParsedResponses()||!this.reliabilityManager.isReliabilityResponse(e)?this.ingress(e,(e=>{null==t||t(e),this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(e)&&this.reliabilityManager.onResponse(e)})):this.reliabilityManager.onResponse():this.ingress(e,t)}onRateLimitErrorResponse(e){const t=new o.I({operationName:"NetworkRateControllerOnRateLimitResponse",success:!0}).start();t.setClientMetadata(this.clientMetadata,!0),t.resultSignature=`rateLimitAlreadyStarted: ${void 0!==this.rateLimitTimeout}`,t.setDataField("RetryAfterMs",e.retryAfterMs),t.setDataField("QueueSize",this.messageQueue.length),this.startRateLimiting(e.retryAfterMs),i.tG.info(507388684,i.nh.CoreDefault,t.stop())}setRpsBps(e,t){const s=new o.I({operationName:"NetworkRateControllerRateLimitsSet",success:!0}).start();s.setClientMetadata(this.clientMetadata,!0),e&&(this.rpsThreshold=.8*e,s.resultDescription+=`maxRPS: ${e}, rpsThreshold: ${this.rpsThreshold}; `),t&&(this.bpsThreshold=.8*t,s.resultDescription+=`maxRPS: ${t}, rpsThreshold: ${this.bpsThreshold}; `),i.tG.info(507388683,i.nh.CoreDefault,s.stop())}close(){var e,t;return X(this,void 0,void 0,(function*(){const s=new o.I({operationName:"NetworkRateControllerClose",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();s.setClientMetadata(this.clientMetadata,!0),this.isClosing=!0,null===(e=this.resolveCloseControllerPromise)||void 0===e||e.call(this);const n=null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection();s.setDataField("QueueSizeBeforeFlush",this.messageQueue.length),0!=this.messageQueue.length&&n&&(yield this.queueProcessingCompletePromise),s.setDataField("QueueSizeAfterFlush",this.messageQueue.length),s.setDataField("IsConnected",n),this.reliabilityManager?this.reliabilityManager.close():s.resultDescription="Reliability Manager is undefined",this.worker=void 0,this.prevSeq=-1,this.clearEgressControlTimeout(),this.reliabilityManager=void 0,i.tG.info(507834381,i.nh.CoreDefault,s.stop())}))}clearMessageQueues(){this.egressedCache.clear(),this.messageQueue=void 0}egress(e,t=0){var s,n;if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","");const a=this.getMessageSize(e);if(a>=te)return void this.logEgressActivity(!1,"Message size exceeded 3000000",`Message size: ${a}`);if((e.obj instanceof ArrayBuffer||e.isHttpSessionInitMessage)&&this.worker)return this.logEgressActivity(!0,`isArrayBuffer: ${e.obj instanceof ArrayBuffer}, isHttpSessionInitMessage: ${e.isHttpSessionInitMessage}`,""),void this.worker.egress(e);this.validateSyncMessage(e.messageId,e.seqId);const r=null!==(s=e.messageId)&&void 0!==s?s:"id"+this.emptyMessageId++,c={obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:r,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage},l=t>0,u=new o.I({operationName:"NetworkRateControllerQueueItem",success:!0,dimension3:`isRetry: ${l}`}).start();u.setClientMetadata(this.clientMetadata,!0);const p={message:c,logOp:u};if(l?this.messageQueue.unshift(p):this.messageQueue.push(p),this.messageQueue.length>1e4){const e=this.messageQueue.shift(),t=`NetworkRateControllerQueue max size reached. Dropping messageId: ${e.message.messageId}`;throw e.logOp.resultDescription=t,e.logOp.success=!1,i.tG.info(506001225,i.nh.CoreDefault,e.logOp.stop()),new Error(t)}null===(n=this.resolveQueueNotEmptyPromise)||void 0===n||n.call(this)}getMessageSize(e){return e.obj instanceof ArrayBuffer?e.obj.byteLength:e.obj.length}sendToNetworkWorker(e){var t;try{if(!this.worker)return void this.logEgressActivity(!1,"NetworkWorker is undefined","SendToNetworkWorkerFailure");if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","SendToNetworkWorkerFailure");this.worker.egress(e),this.onSendToNetworkWorker(e),null===(t=this.reliabilityManager)||void 0===t||t.postEgress();const s=this.getMessageSize(e);this.logEgressCount(s)}catch(e){this.logEgressActivity(!1,"SendToNetworkWorkerFailure",e?e.message:"")}}onSendToNetworkWorker(e){if("string"==typeof e.obj)try{const t=JSON.parse(e.obj);if(_.Tb.typeGuard(t)){const e=t;(0,Z.NR)(e,Date.now(),"SendToNetwork",new o.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}else if(V.x5.typeGuard(t)){const e=t;(0,Z.m9)(e,"GetAnnotationsSendToNetwork",new o.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}}catch(e){}}processQueue(){var e,t,s;return X(this,void 0,void 0,(function*(){if(!this.reliabilityManager){const e=new o.I({operationName:"NetworkRateControllerProcessQueueFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void i.tG.info(507573643,i.nh.CoreDefault,e.stop())}const n=new o.I({operationName:"NetworkRateControllerProcessQueue",success:!0}).start();for(;;){if(0===this.messageQueue.length){if(this.isClosing){n.setDataField("ExitReason","Stage#1 Closing");break}yield Promise.race([this.queueNotEmpty(),this.onCloseController])}if(this.rateLimitTimeout){const e=new o.I({operationName:"NetworkRateControllerRateLimitBackoff",dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.setDataField("QueueLengthBeforeBackoff",this.messageQueue.length),yield Promise.race([this.rateLimitTimeout,this.onCloseController]),e.setDataField("QueueLengthAfterBackoff",this.messageQueue.length),e.setDataField("IsClosing",this.isClosing),e.success=!0,this.rateLimitTimeout=void 0,this.resetRateLimiter(),i.tG.info(507281410,i.nh.CoreDefault,e.stop())}if(!(null===(e=this.reliabilityManager)||void 0===e?void 0:e.checkConnection())){if(this.isClosing){n.setDataField("ExitReason","Stage#2 Closing");break}yield this.checkConnectionPromise(),this.connectionPromise=void 0}if(!this.reliabilityManager){n.setDataField("ExitReason","Stage#2 ReliabilityManager null");break}for(;this.messageQueue.length>0&&this.reliabilityManager.checkConnection();){if(Date.now()-this.egressRateControlIntervalStart>=se)this.resetRateLimiter();else if(this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold){const e=1100;let t="";this.egressMessageCount>=this.rpsThreshold&&(t+="RPS exceeded."),this.egressByteCount>=this.bpsThreshold&&(t+="BPS exceeded.");const s="rateLimitHit",n=new o.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();n.setClientMetadata(this.clientMetadata,!0),n.success=!0,n.resultDescription=s,n.resultSignature=t,n.dimension0=this.messageQueue.length.toString().length.toString(),n.dimension1="rateLimitHit",n.setDataField("QueueLength",this.messageQueue.length),n.setDataField("RateLimitDelayMs",e),i.tG.info(507281409,i.nh.CoreDefault,n.stop()),this.startRateLimiting(e);break}const e=this.messageQueue.shift();this.sendToNetworkWorker(e.message),i.tG.info(507388682,i.nh.CoreDefault,e.logOp.stop())}this.onQueueNotEmpty=void 0,this.resolveQueueNotEmptyPromise=void 0}null===(t=this.resolveQueueProcessingCompletePromise)||void 0===t||t.call(this),this.resolveQueueProcessingCompletePromise=void 0,n.setClientMetadata(this.clientMetadata,!0),n.setDataField("QueueSize",this.messageQueue.length),n.setDataField("IsConnected",null===(s=this.reliabilityManager)||void 0===s?void 0:s.checkConnection()),n.setDataField("IsClosing",this.isClosing),i.tG.info(507368671,i.nh.CoreDefault,n.stop())}))}queueNotEmpty(){return this.onQueueNotEmpty||(this.onQueueNotEmpty=new Promise((e=>{this.resolveQueueNotEmptyPromise=e}))),this.onQueueNotEmpty}checkConnectionPromise(){return this.connectionPromise||(this.connectionPromise=new Promise((e=>{setTimeout(e,1e3)}))),this.connectionPromise}startRateLimiting(e){this.rateLimitTimeout||(this.rateLimitTimeout=new Promise((t=>{setTimeout(t,e)})))}resetRateLimiter(){this.egressRateControlIntervalStart=Date.now(),this.egressMessageCount=0,this.egressByteCount=0}clearEgressControlTimeout(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}validateSyncMessage(e,t){if(!(void 0===t||void 0===e||t<=this.prevSeq)){if(t&&t!==this.prevSeq+1){const e=new o.I({operationName:"NetworkRateControllerAbandonedSyncMessage",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Gap in sync message",e.dimension0=`${this.prevSeq}`,e.dimension1=`${t}`,e.dimension2=""+(t-this.prevSeq),i.tG.info(507834370,i.nh.CoreDefault,e.stop())}this.prevSeq=t}}logEgressActivity(e,t,s,n){var a,r,c,l;const u=new o.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();u.setClientMetadata(this.clientMetadata,!0),u.success=e,u.resultDescription=t,u.resultSignature=s,n&&(u.dimension0=null!==(a=n[0])&&void 0!==a?a:"",u.dimension1=null!==(r=n[1])&&void 0!==r?r:"",u.dimension2=null!==(c=n[2])&&void 0!==c?c:"",u.dimension3=null!==(l=n[3])&&void 0!==l?l:""),i.tG.info(507626007,i.nh.CoreDefault,u.stop())}logEgressCount(e){const t=Date.now();t-this.egressRateControlIntervalStart>se&&((this.egressMessageCount>50||this.egressByteCount>ee)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps logging threshold exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>ee?"bps logging threshold exceeded":"",this.egressRateLogOp.dimension0=(t-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,this.egressRateLogOp.dimension3=`networkMode: ${this.networkMode}`,i.tG.info(508843792,i.nh.CoreDefault,this.egressRateLogOp.stop())),this.egressRateControlIntervalStart=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}var oe,ie;!function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets",e[e.HttpFallback=3]="HttpFallback"}(oe||(oe={})),function(e){e.Workflow="Workflow",e.Client="Client",e.HttpEndpoint="HttpEndpoint"}(ie||(ie={}));class ae{constructor(e,t,s,n,r,c,l,u,p){this.logCountLimiter=new k.yq(ae.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.workerOpenCount=0,this.testHttpConnection=e=>{const t=k.Aq.convertWebSocketUrlToHttp(this.globalUrl),s=!e,n=null!=e?e:new o.I({operationName:"HttpsTest",resourceId:(0,a.k$)(t),success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start(),r={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":n.cv},body:JSON.stringify(k.Aq.createHealthCheckRequest(this.clientMetadata))};(0,q.OW)(t,r,((e,t)=>{e?(n.dimension1="HttpErr",n.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(n.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,s&&(n.success=!0)):(n.dimension1="HttpNoResp",n.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),s&&n.stop(),this.logCountLimiter.log((()=>{i.tG.info(508843780,i.nh.CoreDefault,n)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=s,this.sessionInitializer=n,this.ingress=r,this.onConnectionClose=c,this.sessionCorrelationVector=l,this.reducedPingPongRetryEnabled=u.reducedPingPongRetryEnabled,this.networkWorkerLogOp=new o.I({operationName:"CreateNetworkWorker",success:!0}),this.networkMode=p||oe.JSWebSockets,this.initNetworkMode=this.networkMode}init(e,t,s=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const n=()=>{if(s||!this.alreadyLoggedReconnectAttempt){const e=s?ae.initialAttemptTimeout:ae.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new o.I({operationName:"ConnectionFailingOrSlow",dimension0:s?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});i.tG.info(508843787,i.nh.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!s,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromise=t().catch((e=>{const t=new o.I({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});i.tG.error(508843786,i.nh.CoreDefault,t)})).then((()=>{n(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),n(),this.initInternal()),this.pendingInitPromise}egress(e,t){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressInternal(e,t)})):(this.egressInternal(e,t),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}getNetworkMode(){return this.networkMode}getInitNetworkMode(){return this.initNetworkMode}onRateLimitErrorResponse(e){this.getNetworkRateController().onRateLimitErrorResponse(e)}close(e){this.isWorkerReady=!1,this.networkRateController&&this.getNetworkRateController().close(),this.worker&&(this.worker.close(),this.worker=null),this.networkRateController=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new o.I({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});i.tG.info(508843785,i.nh.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t,s)=>{let n=0;const o=k.Aq.getCurrentTimeMs()?k.Aq.getCurrentTimeMs()-t:0,i=[1e3,2e3,5e3,1e4,6e4];return n=i[Math.max(0,Math.min(i.length-1,e-1))],n=Math.max(n-o,1e3),n=s&&s>0?Math.min(5e3,n):n,n})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpTestsSuccessCount)):this.getNetworkMode()===oe.HttpFallback?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),100):this.tryToConnectAndInitializeSession()}egressInternal(e,t){if(!this.isWorkerReady&&!T.h.matchesTypesFor(e,[_.eE.getTypeName()]))return void(T.h.matchesTypesFor(e,[_.YK.getTypeName()])||i.tG.error(508843784,i.nh.CoreDefault,new o.I({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let s,n;if(T.h.matchesTypesFor(e,[_.VR.getTypeName()])?(this.castBinaryData(e),s=U.r.serialize(e)):s=JSON.stringify(e),_.Tb.typeGuard(e)&&(n=e.seq),this.bypassRateController(e))return void this.worker.egress({obj:s});const a=_.eE.typeGuard(e)&&this.getNetworkMode()===oe.HttpFallback;this.getNetworkRateController().egress({obj:s,isHttpSessionInitMessage:a,messageId:e.messageId,seqId:n},t)}bypassRateController(e){return _.w9.typeGuard(e)}egressBytesInternal(e){this.isWorkerReady?this.getNetworkRateController().egress({obj:e}):i.tG.error(508843783,i.nh.CoreDefault,new o.I({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=k.Aq.getCurrentTimeMs();const e=t=>{if(this.permanentlyClosed||this.isOffline())return;const s=this.sliceUrl?this.sliceUrl:this.globalUrl;t.setDataField("connectionUrl",(0,a.k$)(s)),this.connect(s),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(s,n)=>{if(t.success=!s,t.resourceId=n?(0,a.k$)(n.sliceUrl):"",t.dimension2=this.getNetworkModeLogString(),this.getNetworkMode()===oe.HttpFallback?(t.resultDescription=s?`HTTP Error: ${s.error}`:"",t.dimension0=t.success?"HTTPOK":"HTTPFail"):(t.resultDescription=s?`WS Error: ${s.error}`:"",t.dimension0=t.success?"WSOK":"WSFail"),s||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.getNetworkMode()===oe.JSWebSockets?0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(t.dimension1="WSBlocked",t.dimension3="HTTP Fallback",this.networkMode=oe.HttpFallback,this.currentReconnectAttempt=0,this.resetHttpTestsCounter()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="HTTPOffline"),this.logCountLimiter.log((()=>{i.tG.info(508843782,i.nh.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{i.tG.info(508843781,i.nh.CoreDefault,t.stop())})),n.forceReconnect){this.close();const t=new o.I({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=n.sliceUrl,this.getNetworkRateController().setRpsBps(n.maxRPS,n.maxBPS),this.ready();this.resetHttpTestsCounter()}})},t=new o.I({operationName:"TryToConnectAndInitializeSession",resultSignature:`Reconnection attempt #${this.currentReconnectAttempt}`}).start();e(t)}getNetworkRateController(){return this.networkRateController||(this.networkRateController=new ne({reducedPingPongRetryEnabled:this.reducedPingPongRetryEnabled})),this.networkRateController}connect(e){const t=this.getNetworkMode();this.networkWorkerLogOp.start(),this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString(),this.networkWorkerLogOp.dimension0=t.toString(),this.logCountLimiter.log((()=>i.tG.info(508372418,i.nh.CoreDefault,this.networkWorkerLogOp.stop()))),this.worker=this.workerFactory(t),this.worker.init(e,this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController),(()=>{this.workerOpenCount++,this.getNetworkRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClose(e)}),this.clientMetadata),this.getNetworkRateController().init(this.worker,this.ingress,t,this.clientMetadata,this.sessionCorrelationVector)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[t]=new Uint8Array(e[t]));for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&this.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMode(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}getNetworkModeLogString(){return"NetworkMode: "+(this.getNetworkMode()===oe.JSWebSockets?"WebSocket":"HTTP")}}ae.initialAttemptTimeout=1e5,ae.reconnectAttemptTimeout=2e4,ae.className="NetworkWorkerManager";class re extends b.EventEmitter{constructor(e,t,s,n,i,a,r,c,l){super(),this.cvParent=new g.W,this.logOp=new o.I({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new k.yq("SessionState"),this.stats=t,this.allStates={[D.Initing]:new F(this),[D.Running]:new G(this),[D.Disconnected]:new W(this),[D.Closed]:new H(this)},this.setState(D.Initing),this.messageEndpoint=new N({messageIdPrefix:"c",responseTimeoutMs:3e4,resendPendingMessagesOnReconnect:!1}),this.messageEndpoint.setClientMetadata(i),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(_.w9.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.networkWorkerManager=new ae(e,i,s,n,this.ingress.bind(this),this.onConnectionClose.bind(this),this.getCorrelationVector.bind(this),r,l),this.messageQueue=new B({sendMessage:(e,t,s,n)=>this.state.sendMessage(e,t,s,n),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage()}),n.on("connect",((e,t,s,n,o,i,a,r)=>{this.setState(D.Running,"",{isSessionReseedingStarted:e&&t}),this.emit("connect",e,s,n,o,i,a,r)})),n.on("reconnect",(()=>this.emit("reconnect"))),n.on("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=a,this.gateUtils=c}setState(e,t,s){if(this.state&&e===this.state.stateName)return;const n=this.state?D[this.state.stateName]:"undefined",o=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===D.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${o?D[e]:n}`,this.logOp.resultDescription=`Previous state: ${n}`,this.logOp.dimension0=`Attempted state: ${D[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!o?"Unexpected state change":""),this.logOp.success=o,i.tG.info(508843791,i.nh.CoreDefault,this.logOp)})),o&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(s))}init(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,s){this.retrySendMessage(e,t,re.maxRetries,s)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}getNetworkWorkerManager(){return this.networkWorkerManager}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.networkWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.networkWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(e){this.sendMessage(new _.w9),this.networkWorkerManager.close(!0);const t=e||new _.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new _.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}ingress(e,t){let s;try{s=JSON.parse(e)}catch(e){i.tG.error(508843790,i.nh.CoreDefault,new o.I({operationName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0}))}if(s){if(t&&_.YK.typeGuard(s)&&t(s),this.networkWorkerManager.getNetworkMode()===oe.HttpFallback&&_.ry.typeGuard(s)){const e=s;if(e.batch)for(const t of e.batch)this.messageEndpoint.ingress(t,((e,t)=>this.egress(e||t,(()=>{}))));return}this.messageEndpoint.ingress(s,((e,t)=>this.egress(e||t,(()=>{}))))}}egress(e,t,s){e&&this.networkWorkerManager.egress(e,s).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.networkWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(D.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=k.Aq.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,s,n,a){const r=re.maxRetries-s;this.state.sendMessage(e,((c,l)=>{var u,p,g,h,d,m;a&&(c&&0==s?(a.dimension0=(r+1).toString(),a.success=!1,i.tG.info(507025311,i.nh.CoreDefault,a.stop())):c&&s>0?(a.dimension0=(r+1).toString(),a.dimension1=null!==(p=null===(u=c.code)||void 0===u?void 0:u.toString())&&void 0!==p?p:"NoErrorCode",a.resultSignature=null!==(g=c.error)&&void 0!==g?g:"NoErrorMessage"):(a.success=!0,i.tG.info(507025310,i.nh.CoreDefault,a.stop()))),c&&s>0&&this.canBeRetried(e)&&this.isTransientError(c)?(a||((a=new o.I({operationName:"RetrySendMessage",success:!0,dimension0:(r+1).toString()}).start()).resourceId=T.h.getTypeNameFor(e),a.dimension1=null!==(d=null===(h=c.code)||void 0===h?void 0:h.toString())&&void 0!==d?d:"NoErrorCode",a.resultSignature=null!==(m=c.error)&&void 0!==m?m:"NoErrorMessage",a.resultDescription=`Retrying message with messageId: ${e.messageId}${_.Tb.typeGuard(e)?`, seq: ${e.seq}`:""}`),T.h.matchesTypesFor(c,[_.ru.getTypeName()])&&this.networkWorkerManager.onRateLimitErrorResponse(c),this.retrySendMessage(e,t,s-1,n,a)):t&&t(c,l)}),r,n)}canBeRetried(e){return!T.h.matchesTypesFor(e,[_.eE.getTypeName(),_.VR.getTypeName(),V.x5.getTypeName()])}isTransientError(e){const t=e.error,s=e.code;return s!==f.xv.TokenValidationError&&s!==f.xv.TokenDecryptError&&s!==f.xv.SyncMessageTooLateOrDuplicate&&s!==f.xv.Gone&&(t!==v.SyncMessageUnsupportedBatch&&t!==v.UnexpectedSeedMessage&&t!==v.UnsupportedSyncMessage&&t!==v.AnnotationTokenNotFound&&t!==E.ArrivedBeforeReseeding&&t!==E.DroppedAsOldestInQueue&&t!==E.DroppedBecauseClientDisconnected)}}re.maxRetries=2;var ce=s(547942),le=s(784567),ue=s(629271),pe=s(708029);class ge{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){T.h.assign(ge,this,e)}static getTypeName(){return"AugLoop_Core_Apology"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return T.h.matchesTypesFor(e,[ge.getTypeName()])}}ge.H_={T_:ge.getTypeName(),B_:ge.getBaseTypes()};class he{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){T.h.assign(he,this,e)}static getTypeName(){return"AugLoop_Core_SecondaryApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return T.h.matchesTypesFor(e,[he.getTypeName()])}}he.H_={T_:he.getTypeName(),B_:he.getBaseTypes()};class de{constructor(e){T.h.assign(de,this,e)}static getTypeName(){return"AugLoop_Core_WorkflowActivationFailureDetails"}static getBaseTypes(){return[]}static typeGuard(e){return T.h.matchesTypesFor(e,[de.getTypeName()])}}de.H_={T_:de.getTypeName(),B_:de.getBaseTypes()};class me{constructor(e){T.h.assign(me,this,e)}static getTypeName(){return"AugLoop_Core_AuthTokenIsMissingDetails"}static getBaseTypes(){return["AugLoop_Core_WorkflowActivationFailureDetails"]}static typeGuard(e){return T.h.matchesTypesFor(e,[me.getTypeName()])}}me.H_={T_:me.getTypeName(),B_:me.getBaseTypes()};class ye{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){T.h.assign(ye,this,e)}static getTypeName(){return"AugLoop_Core_NotActivatedWorkflowApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return T.h.matchesTypesFor(e,[ye.getTypeName()])}}ye.H_={T_:ye.getTypeName(),B_:ye.getBaseTypes()};var Te=s(707897);class fe{constructor(e,t,s,n){this.sendMessage=e,this.annotationType=t,this.options=s,this.token=`${t}-${fe.nextActivationResultBatchId++}`,this.annotationDoesNotExistOnServiceEnabled=n}activate(e,t,s){return new Promise(((n,o)=>{this.sendMessage(new _.n4({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:this.options?this.options.forceReturnCachedAnnotations:void 0,returnAnnotationDoesNotExist:this.annotationDoesNotExistOnServiceEnabled||!1,sendApologies:s}),((e,t)=>{e?o(new Error(e.error)):(_.PY.typeGuard(t)&&this.annotationDoesNotExistOnServiceEnabled&&(this.annotationDoesNotExistOnService=t.annotationNotExists),n({token:this.token}))}),t)}))}release(){return new Promise(((e,t)=>{this.annotationDoesNotExistOnService&&this.annotationDoesNotExistOnServiceEnabled?e(!1):this.sendMessage(new _.GA({token:this.token}),((s,n)=>{s?t(new Error(s.error)):e(n.lastRelease)}))}))}}fe.nextActivationResultBatchId=1;var _e=s(919450),Ce=s(610396),Se=s(41498);const Ae=(e,t)=>{const s=[];for(const n of null!=e?e:[])if(void 0===t||t===n.cardinality)for(const e of n.contextTypes)s.push([e,n.cardinality,n.producerWaitPolicy]);return s},ve="\\",Ie=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),we=e=>Array.isArray(e)?5===e.length?`${e[0]}${ve}${e[1]}${ve}${e[2]}${ve}${e[3]}${ve}${e[4]}`:4===e.length?`${e[0]}${ve}${e[1]}${ve}${e[2]}${ve}${e[3]}`:3===e.length?`${e[0]}${ve}${e[1]}${ve}${e[2]}`:2===e.length?`${e[0]}${ve}${e[1]}`:1===e.length?e[0]:e.join(ve):"(malformed path)";var Ne;!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(Ne||(Ne={}));class Ee{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var s;const n=this.getLocation(t);return null===(s=this.graphNodeByLocationAndWorkflowId.get(n))||void 0===s?void 0:s.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const s=new o.I({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void i.tG.error(524300630,i.nh.CoreDefault,s.stop())}const s=this.getLocation(t),n=new be(e,s);this.addWorkflowAsDependency(n);let a=this.graphNodeByLocationAndWorkflowId.get(s);a||(a=new Map,this.graphNodeByLocationAndWorkflowId.set(s,a)),a.set(e.id,n)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const s of t.values()||[]){const t=this.createWorkflowDefinition(s.workflow);s.workflow.visibility===Se.Y$.LocalOnly?this.compressDownstreamWorkflows(t,s):t.outputTypes.push(...s.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),s=this.graphNodeByLocationAndWorkflowId.get(t),n=Array.from((null==s?void 0:s.values())||[]);for(const e of n){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);s.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const s of t.values()||[])e.push(s.workflow);return e}getWorkflowNodes(e){const t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const s of e.values())t.push(s);return t}getLocation(e){return e?Ne.External:Ne.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const s of t.downstreamWorkflows)if(s.workflow.visibility!==Se.Y$.LocalOnly){if(s.workflow.kind!==Se.wC.Join||-1!==e.inputTypes.indexOf(s.workflow.collectionScopeType))for(const t of s.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,s)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const s of t.values()){for(const t of s.workflow.inputTypes)-1!==e.workflow.outputTypes.indexOf(t)&&this.addWorkflowChain(e,s);for(const t of s.workflow.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(s,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class be{constructor(e,t){this.isActivated=!0,this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Object.assign(Object.assign({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}}new m.eU("enableRichContentApis",!1);const ke=e=>({id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}),Me=(e,t)=>null!=e&&(null!=t&&(e.length>0&&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length))));class Le{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,s){return Object.assign(Object.assign(Object.assign({},e),t),s)}mergeWorkflowDefinition(e,t,s){if(s){const n=((e,t,s)=>{let n=e.get(t);return n||(n=s(),e.set(t,n)),n})(this.workflowDefByWorkflowAndContextId,e.id,(()=>new Map));n.set(s,Le.mergeDefinitions(e,n.get(s),t))}else this.workflowDefByWorkflow.set(e.id,Le.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var s;let n;return t&&(n=null===(s=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===s?void 0:s.get(t)),n||(n=this.workflowDefByWorkflow.get(e.id)),n||(n=e),n}deleteWorkflowDefinition(e,t){const s=this.workflowDefByWorkflowAndContextId.get(e.id);s&&(s.delete(t),0===s.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))}}var Be;!function(e){e.JsClient="C",e.Server="S"}(Be||(Be={}));const De=new Set([le.Xr.getTypeName(),le.fZ.getTypeName(),le.g0.getTypeName(),le.xU.getTypeName()]);class Pe{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return Me(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=T.h.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new o.I({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but without a workflow source atribute"):e.contextId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupportedOperation(e){return De.has(e)}tryLogMessage(e,t,s=!0){e&&(e.success=s,e.resultDescription=t,i.tG.verbose(527308633,i.nh.CoreDefault,e.stop()))}}var Re;!function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Running=3]="Running",e[e.Executed=4]="Executed"}(Re||(Re={}));class Oe{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var s;const n=e.contextId;if(n)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(n,[]),this.scopeItemsByContextId.has(n)){if(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.has(n)){const s=new o.I({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${n} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();i.tG.verbose(527291288,i.nh.CoreDefault,s.stop())}}else this.scopeItemsByContextId.set(n,e)}updateScopeItemPath(e,t,s){var n,o;if(!e)return;const i=this.scopeItemsByContextId.get(e);if(!i)return;const a=i.parentPath;this.scopeItemsByContextId.set(e,Ie(t,i));const r=null!==(o=null===(n=this.itemsByWorkflowAndContextId.get(s.id))||void 0===n?void 0:n.get(e))&&void 0!==o?o:[];for(let e=0;e<r.length;e++)r[e]=Ie([...t,...r[e].parentPath.slice(0,a.length)],r[e])}getScopeItem(e,t){var s;for(const n of(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.keys())||[])if(Me(n,e))return this.scopeItemsByContextId.get(n)}addItemToWorkflowList(e,t){const s=e.contextId;if(!s)return;const n=this.itemsByWorkflowAndContextId.get(t.id);if(n)for(const[a,r]of n)if(Me(a,s)){r.push(e);const s=new o.I({resultDescription:`Items for contextId ${a}: [${r.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();i.tG.info(526403808,i.nh.CoreDefault,s.stop())}}isWorkflowReady(e,t){const s=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=s}getItemsToExecute(e,t){const s=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),s}onWorkflowExecuted(e,t){const s=e.contextId,n=this.itemsByWorkflowAndContextId.get(t.id);n&&(n.delete(s),0===n.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(s)||this.scopeItemsByContextId.delete(s)}getGeneratedItems(e,t){var s;if(!(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.get(e)))return[];const n=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,n)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const s of t.keys())if(s===e)return!0;return!1}}var xe=s(735875),Fe=s(281076),Ge=s(928917);function We(e,t,s=!1){let n,o,i={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(n=e,o=t):(n=t,o=e),0===o.indexOf(n)?(i.firstDiffLeft=n.length,i.firstDiffRight=0):o.endsWith(n)?(i.firstDiffLeft=0,i.firstDiffRight=n.length):(i=function(e,t,s=!1){const n={firstDiffLeft:0,firstDiffRight:t.length};let o;for(o=0;o<e.length&&o<t.length;o+=1){const n=e.charCodeAt(o),i=t.charCodeAt(o);if(!(n===i||He(n,s)&&He(i,s)))break}for(n.firstDiffLeft=o,o=0;o<e.length&&o<t.length;o+=1){const n=e.charCodeAt(e.length-o-1),i=t.charCodeAt(t.length-o-1);if(!(n===i||He(n,s)&&He(i,s)))break}return n.firstDiffRight=o,n}(e,t,s),i.firstDiffLeft+i.firstDiffRight>n.length&&(i.firstDiffRight=n.length-i.firstDiffLeft)),function(e,t,s){if(e.firstDiffLeft>0){const n=e.firstDiffLeft<t.length&&Ue(t,e.firstDiffLeft),o=e.firstDiffLeft<s.length&&Ue(s,e.firstDiffLeft);(n||o)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const n=e.firstDiffRight<t.length&&Ue(t,t.length-e.firstDiffRight),o=e.firstDiffRight<s.length&&Ue(s,s.length-e.firstDiffRight);(n||o)&&(e.firstDiffRight-=1)}}(i,e,t),i}function He(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function Ue(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}var qe=s(297288),Ve=s.n(qe);const $e=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,je=/[.!?]/g;function ze(e,t){const s=[],n=Qe(e,t);return n&&s.push(n),s}function Ke(e,t){const s=[],n=Qe(e,t);n&&s.push(n);const o=function(e,t,s){var n,o,i,a,r,c;const l=e,u=t;if((null==l?void 0:l.ipPosition)===(null==u?void 0:u.ipPosition)&&(null==l?void 0:l.isColdIp)===(null==u?void 0:u.isColdIp))return;if((null==l?void 0:l.isColdIp)===(null==u?void 0:u.isColdIp)&&s)if(s.deltaType===Fe.WI.Add){if((null==u?void 0:u.ipPosition)===(null!==(n=s.position)&&void 0!==n?n:0)+(null!==(o=s.length)&&void 0!==o?o:0))return}else if(s.deltaType===Fe.WI.Update){if((null==u?void 0:u.ipPosition)===(null!==(i=s.position)&&void 0!==i?i:0)+(null!==(r=null===(a=s.content)||void 0===a?void 0:a.length)&&void 0!==r?r:0))return}else if(s.deltaType===Fe.WI.Delete&&(null==u?void 0:u.ipPosition)===(null!==(c=s.position)&&void 0!==c?c:0))return;return new Ge.s({deltaType:Fe.WI.CursorUpdate,cursorData:{ipPosition:null==u?void 0:u.ipPosition,isColdIp:null==u?void 0:u.isColdIp}})}(e,t,n);o&&s.push(o);const i=function(e,t,s){var n,o,i,a,r,c,l;const u=e,p=t;if((null===(n=p.formattedRanges)||void 0===n?void 0:n.length)<=(null===(o=u.formattedRanges)||void 0===o?void 0:o.length))if(s){let e=u.formattedRanges?[...u.formattedRanges]:[];const t=function(e,t,s){if(!e)return;if(t.deltaType===Fe.WI.Add){const t=e.find((e=>e.start===s&&0===e.length));if(t)return t;s=Math.max(s-1,0)}const n=e.find((e=>0===e.length?e.start===s:e.start<=s&&s<e.start+e.length));return n}(u.formattedRanges,s,s.position),n=t?e.indexOf(t):-1;if(-1!==n&&(s.position+(s.length||0)>t.start+t.length?t.length=s.position+(null!==(i=s.content)&&void 0!==i?i:"").length-t.start:t.length+=(null!==(a=s.content)&&void 0!==a?a:"").length-(s.length||0),e[n]=t),e.length>0){for(const t of e.slice(n+1))t.start<s.position||(s.position+(s.length||0)>t.start?(t.length=t.start+t.length-(s.position+(s.length||0)),t.start=s.position+(null!==(r=s.content)&&void 0!==r?r:"").length):t.start+=(null!==(c=s.content)&&void 0!==c?c:"").length-(s.length||0));e=e.filter((e=>e.length>0))}const o=null!==(l=null==p?void 0:p.formattedRanges)&&void 0!==l?l:[];if(Ve()(e,o)||0===e.length&&0===o.length)return}else if(Ve()(null==u?void 0:u.formattedRanges,null==p?void 0:p.formattedRanges))return;return new Ge.s({deltaType:Fe.WI.FormattingUpdate,formattedRanges:null==p?void 0:p.formattedRanges})}(e,t,n);i&&s.push(i);const a=function(e,t,s){var n;const o=e,i=t;if(!(null==o?void 0:o.attributionRanges)&&!i.attributionRanges&&!(null===(n=null==s?void 0:s.attributionData)||void 0===n?void 0:n.ranges)||Ve()(null==o?void 0:o.attributionRanges,null==i?void 0:i.attributionRanges))return;if(o.attributionRanges&&i.attributionRanges){const e=[];for(const t of i.attributionRanges)o.attributionRanges.some((e=>Ve()(e,t)))||e.push(t);if(0===e.length)return;return new Ge.s({deltaType:Fe.WI.AttributionUpdate,attributionData:{ranges:e}})}return new Ge.s({deltaType:Fe.WI.AttributionUpdate,attributionData:{ranges:null==i?void 0:i.attributionRanges}})}(e,t,n);a&&s.push(a);const r=function(e,t){const s=e,n=t;let o;const i={};let a=!1;for(o in n)-1===["ipPosition","isColdIp","content","formattedRanges","attributionRanges"].indexOf(o)&&(Ve()(n[o],s[o])||(a=!0,i[o]=n[o]));if(a)return new Ge.s({deltaType:Fe.WI.OtherNonContentUpdate,otherNonContentData:i});return}(e,t);return r&&s.push(r),s}function Qe(e,t){const s=e.content,n=t.content,o=We(s,n),i=o.firstDiffLeft,a=s.length-o.firstDiffRight,r=n.length-o.firstDiffRight;let c,l=Fe.WI.Update;if(s.length!==n.length)a===i?(l=Fe.WI.Add,c=s[s.length-1]):r===i&&(l=Fe.WI.Delete,c=n[n.length-1]);else if(s===n)return;let u,p=0;switch(l){case Fe.WI.Update:p=a-i,u=n.substring(i,r);break;case Fe.WI.Add:u=n.substring(i,r);break;case Fe.WI.Delete:p=a-i,u=s.substring(i,a)}const g=function(e,t){const s=Array.from(e.matchAll($e));if($e.lastIndex=0,0===s.length)return Fe.OD.Chars;if(1===s.length){if(0===s[0].index)return t&&je.test(t)?Fe.OD.Sentence:t&&!$e.test(t)?Fe.OD.Word:Fe.OD.Chars;if(s[0].index+1===e.length)return je.test(e[s[0].index-1])?Fe.OD.Sentence:$e.test(e[s[0].index-1])?Fe.OD.Chars:Fe.OD.Word;if(e[s[0].index-1]){const t=e[s[0].index-1];if(je.test(t))return Fe.OD.Sentence;if($e.test(t))return Fe.OD.Chars}return Fe.OD.Word}const n=Array.from(e.matchAll(je));if(je.lastIndex=0,0===n.length)return Fe.OD.PartialSentence;if(n.length>1)return Fe.OD.Paragraph;if(n[0].index+1<=e.length)return $e.test(e[n[0].index+1])?Fe.OD.Sentence:Fe.OD.Paragraph;return}(u,c);if(void 0!==g)return new Ge.s({content:l!==Fe.WI.Delete?u:void 0,deltaType:l,unit:g,position:i,length:l!==Fe.WI.Add?p:0})}class Je{constructor(){this.deltaBuilderHandlers=new Map,this.registerDeltaBuilderHandler(xe.qf.getTypeName(),ze),this.registerDeltaBuilderHandler(xe.Cg.getTypeName(),Ke)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,s){const n=this.deltaBuilderHandlers.get(e);return n?n(t,s):[]}}const Ye=(e,t)=>t?Ze([...t,e]):e,Ze=e=>e.join("\\");class Xe{constructor(e){this.createTextTileDeltasFromItem=(e,t)=>{var s;const n=new o.I({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return n.success=!1,n.resultDescription="Unable to create text tile delta, parent item is undefined",void i.tG.info(524883085,i.nh.CoreDefault,n.stop());if(!e.body)return n.success=!1,n.resultDescription="Unable to create text tile delta, parent item has undefined body",void i.tG.info(524883086,i.nh.CoreDefault,n.stop());const o=e.body;if(!xe.qf.typeGuard(o))return n.success=!1,void(n.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${xe.qf.getTypeName()}, received ${T.h.getTypeNameFor(o)}`);const a=Ye(e.id,t),r=null!==(s=this.lastSeenTileByTileId.get(a))&&void 0!==s?s:new xe.qf({content:""}),c=this.createDeltas(r,o);return c&&0!==c.length?(n.dimension0=c.length.toString(),this.lastSeenTileByTileId.set(a,o)):(n.dimension0="0",n.resultDescription="No delta differences found"),i.tG.info(524883087,i.nh.CoreDefault,n.stop()),c}catch(e){return n.success=!1,n.resultDescription=`Error creating text tile delta: ${e}`,void i.tG.info(524883088,i.nh.CoreDefault,n.stop())}},this.lastSeenTileByTileId=null!=e?e:new Map,this.deltaBuilder=new Je}addItemToLocalMap(e,t){const s=Ye(e.id,t),n=e.body;xe.qf.typeGuard(n)&&!this.lastSeenTileByTileId.has(s)&&this.lastSeenTileByTileId.set(s,n)}deleteItemFromLocalMap(e,t){const s=Ye(e.id,t);this.lastSeenTileByTileId.has(s)&&this.lastSeenTileByTileId.delete(s)}moveItemsInLocalMap(e,t,s){const n=new Set(s),o=Ze(t),i=Ze(e),a=[],r=(e,t)=>e.length>t.length?e.substring(t.length+1).split("\\")[0]:void 0;for(const[e,t]of this.lastSeenTileByTileId)if(e.startsWith(o)){const s=r(e,o);if(void 0===s||n.has(s)){const s=e.replace(o,i);a.push({item:t,newPathKey:s,prevPathKey:e})}}for(const e of a)this.lastSeenTileByTileId.delete(e.prevPathKey),this.lastSeenTileByTileId.set(e.newPathKey,e.item)}createDeltas(e,t){return this.deltaBuilder.executeDeltaBuilderHandler(T.h.getTypeNameFor(t),e,t)}}var et=s(3722),tt=s(673586),st=s(473257);class nt extends b.EventEmitter{init(){return Promise.resolve()}sendMessage(e,t,s){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new g.W}getNetworkWorkerManager(){}setState(e){}}var ot=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))},it=function(e){return this instanceof it?(this.v=e,this):new it(e)},at=function(e,t,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=s.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(s,n){i.push([e,t,s,n])>1||r(e,t)}))})}function r(e,t){try{(s=o[e](t)).value instanceof it?Promise.resolve(s.value.v).then(c,l):u(i[0][2],s)}catch(e){u(i[0][3],e)}var s}function c(e){r("next",e)}function l(e){r("throw",e)}function u(e,t){e(t),i.shift(),i.length&&r(i[0][0],i[0][1])}};var rt;!function(e){e[e.LocalWorkflow=0]="LocalWorkflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(rt||(rt={}));const ct=(e,t)=>{t?(e.resultDescription=t,e.success=!1,i.tG.error(509203144,i.nh.CoreDefault,e.stop())):i.tG.info(509203143,i.nh.CoreDefault,e.stop())},lt=e=>!e.items.some((e=>e.source&&0===e.source.indexOf("ThirdParty")));class ut{constructor(e){var t,s;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.apologyCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=ce.f.NotAuthenticated,this.sessionCloseCallbacks=new Map,this.connectCallbacks=new Map,this.reconnectCallbacks=new Map,this.disconnectCallbacks=new Map,this.sessionStateCallbackToken=0,this.workflowGraph=new Ee,this.workflowDefinitionManager=new Le,this.contextIdManager=new Pe(Be.JsClient,this.workflowGraph),this.workflowItemStorage=new Oe(this.workflowDefinitionManager),this.pendingConnectCallbacks=[],this.onAnnotationsSubmittedEnabled=!1,this.reduceBatchOperationsEnabled=!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=!1,this.batchMessagesEnabled=!1,this.seedingStatus=f.e9.NotStarted,this.onConnectTelemetryCG=void 0,this.cachedClaimsChallenge={claimsVersion:0,actionRequired:!1},this.tokenMessageVersion=1,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.batchMessagesEnabled=e.batchMessagesEnabled||!1,this.reduceBatchOperationsEnabled=e.reduceBatchOperationsEnabled||!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||!1,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,this.gateUtils=e.gateUtils,this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.claimsChallengeCallback=[],this.seedingStatusChangeCallbacks=[],this.onAnnotationsSubmittedEnabled=e.onAnnotationsSubmittedEnabled||!1,this.annotationDoesNotExistOnServiceEnabled=e.annotationDoesNotExistOnServiceEnabled||!1,this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(_.B_.getTypeName(),this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(_.$j.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(_.Gs.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),this.sessionManager.onMessage(_.Sy.getTypeName(),this.onClaimsChallengeMessage.bind(this)),this.sessionManager.onMessage(_.fr.getTypeName(),this.onSeedingStatusChangeMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator()),this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this)),(null===(s=this.gateUtils)||void 0===s?void 0:s.isChangeGateEnabledSync(Jt))||this.setClaimsChallengeCallback(this.requestAuthTokenWithClaims.bind(this))}enabledRemoteExecutionNotification(){return this.enableRemoteExecutionNotification}getSessionReconnectParams(){if(!this.connectParams)throw new Error("Session has not been established yet.");return{sessionUrl:this.connectParams.sessionUrl,origin:this.connectParams.origin,authToken:this.connectParams.authToken,nextSyncSequenceId:this.nextSyncSequenceId}}setNextSequenceId(e){this.nextSyncSequenceId=e}tryGetDocSessionId(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId}getSessionStateCallbackToken(e){var t;return e+"-callback-"+(null!==(t=this.tryGetDocSessionId())&&void 0!==t?t:"unknown")+"-"+this.sessionStateCallbackToken++}updateGraphOnAuthStateChange(e){this.tryActivateWorkflows()}tryActivateWorkflows(){if(this.enableRemoteExecutionNotification){const e=new o.I({operationName:"GraphServerWorkflowActivation",success:!0}).setClientMetadata(this.clientMetadata).start(),t=[];this.workflowGraph.getWorkflowNodes().filter((e=>e.location===Ne.External)).forEach((e=>{this.localWorkflowManager.canActivateWorkflow(e,this)?e.isActivated=!0:(this.localWorkflowManager.deactivateServerWorkflow(e,this),t.push(e.workflow.id))})),e.resultDescription=`deactivated workflows: [${t.join()}]`,i.tG.info(508879493,i.nh.CoreDefault,e.stop())}}initialize(){return ot(this,void 0,void 0,(function*(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows),this.gateUtils&&!this.onConnectTelemetryCG&&(this.onConnectTelemetryCG=yield this.gateUtils.isChangeGateEnabled("OnConnectTelemetry")),yield this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress),this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this}))}isLocalWorkflowRegistered(e){return this.getLocalRegisteredWorkflows().some((t=>e===t.id))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){this.registerLocalWorkflowsWithoutGraphInit(e),this.trySendWorkflowGraphInitMessage()}registerLocalWorkflowsWithoutGraphInit(e){if(e.length&&this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this)}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new o.I({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();ct(t)}activateAnnotation(e,t,s){var n;const o=new fe(this.sendMessageToSession.bind(this),e,t,this.annotationDoesNotExistOnServiceEnabled),i=(t,s)=>{let n=t.get(e);n||(n=new Map,t.set(e,n)),n.set(o.token,s)};(null==t?void 0:t.callback)&&i(this.annotationCallbacks,null==t?void 0:t.callback),(null==t?void 0:t.apologyCallback)&&i(this.apologyCallbacks,null==t?void 0:t.apologyCallback);const a=null!==(n=this.tokensByAnnotationType.get(e))&&void 0!==n?n:[];return-1===a.indexOf(o.token)&&a.push(o.token),this.tokensByAnnotationType.set(e,a),this.annotationActivationTrackers.set(o.token,o),this.activateAnnotationForTracker(o,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)})}activateServerRequestResponse(e,t,s){return ot(this,void 0,void 0,(function*(){yield this.activateAnnotation(e,{callback:(e,s)=>{for(const s of e.items){const e=new o.I({operationName:"ServerRequestResponseAnnotationReceived",success:!0}).setClientMetadata(this.clientMetadata).start(),n=s.body;if(!(null==n?void 0:n.workflowExecutionCorrelation)){const t="Received annotation without workflowExecutionCorrelation";throw ct(e,t),new Error(t)}let i=!1;const a=(t,s)=>{if(i){const t="Final response has already been sent for this annotation";throw ct(e,t),new Error(t)}i=void 0===s||s;const o=new _.iT({workflowExecutionCorrelation:n.workflowExecutionCorrelation,finalResponse:i,content:t}),a=this.submitCustomMessage(o).catch((t=>{throw ct(e,`Error submitting response: ${t.message}`),t}));return s&&ct(e),a};null==t||t.onAnnotationCallback(n,a).catch((t=>{ct(e,`Error in onAnnotationCallback: ${t.message}`)}))}}},s)}))}activateAnnotationForTracker(e,t){const s=new o.I({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return s.setDataField("StartTimestamp",Date.now()),e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected,t.sendApologies).then((n=>(s.resultSignature="Ok",s.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,ct(s),n))).catch((n=>{throw ct(s,`error on activate annotation type ${e.annotationType}: ${n}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),n}))}updateAnnotationConfig(e,t){const s=new _.Ol({token:e,config:t});this.sendMessageToSession(s);const n=this.annotationActivationTrackers.get(e);n&&n.options&&(n.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const s=s=>{const n=s.get(t.annotationType);n&&(n.delete(e),0==n.size&&s.delete(t.annotationType))};return s(this.annotationCallbacks),s(this.apologyCallbacks),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,s){const n={state:s};this.submitOperation(new le.XP({parentPath:e,items:[{id:t}],M_:n}))}setAnnotationMetadata(e,t,s){this.submitOperation(new le.XP({parentPath:e,items:[{id:t}],M_:s}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){var s,n;if(t||(t=this.generateCorrelationId()),(0,Z.BG)(e,t,Date.now(),"SubmitInRuntimeClient",new o.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e),!this.onAnnotationsSubmittedEnabled){const[s,n]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(s,t)}const i=e.filter(this.filterOperationsForSession.bind(this)).filter(lt),a=[];if(this.deltaGenerator){const e=new o.I({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of i)if(le.fZ.typeGuard(e))a.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const o of t.items)le.Xr.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(o,t.parentPath):le.n4.typeGuard(e)?this.deltaGenerator.deleteItemFromLocalMap(o,t.parentPath):le.hW.typeGuard(e)&&this.deltaGenerator.moveItemsInLocalMap(e.parentPath,e.prevParentPath,null!==(n=null===(s=e.items)||void 0===s?void 0:s.map((e=>e.id)))&&void 0!==n?n:[]);a.push(e)}ct(e)}if(this.onAnnotationsSubmittedEnabled){const[e,s]=this.partitionAnnotationOperations(a.length?a:i);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(s,t)}else this.submitOperationsToSession(a.length?a:i,t);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");if(this.networkMode===oe.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);t||(t=this.generateCorrelationId()),this.allowSeed=!1,this.allowGroupSeed=!1;const[s,n]=this.partitionAnnotationOperations(e);this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(s,t):this.executeCallbacksOnAnnotationSubmitted(s,t),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?n:e,!0,t):this.sendMessageToSession(new _.Tb({cv:t,seq:0,ops:this.onAnnotationsSubmittedEnabled?n:e}))}submitSeedGroupOperations(e,t,s){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");if(this.networkMode===oe.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);s||(s=this.generateCorrelationId()),t&&(this.allowGroupSeed=!1),this.allowSeed=!1;const[n,o]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(n,s),this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(n,s):this.executeCallbacksOnAnnotationSubmitted(n,s),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?o:e,!!t,s):(this.seedGroupSize++,this.sendMessageToSession(new _.Tb({cv:s,seq:0,ops:this.onAnnotationsSubmittedEnabled?o:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))}submitCustomMessage(e){return new Promise(((t,s)=>{this.sendMessageToSession(e,((n,o)=>{n?s(new Error(`${n.error}; for message type: ${T.h.getTypeNameFor(e)}`)):t(o)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,s)=>{this.sendMessageToSessionPostEndpoint(e,((e,n)=>{e?s(new Error(e.error)):t(n)}))}))}submitBinaryStreamUploadMessage(e){return new Promise(((t,s)=>{const n=new o.I({operationName:"sendBinaryStreamUploadMessage",success:!0}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,st.wM)(this.connectParams,e,n,((e,n)=>{e?s(new Error(e.error)):t(n)}));else{const o=(o=>(0,st.wM)(o,e,n,((e,n)=>{e?s(new Error(e.error)):t(n)}))).bind(this);this.pendingConnectCallbacks.push(o)}}))}requestBinaryDataForBlob(e){return e.data?Promise.resolve(e.data):e.dataPointer&&e.dataPointer.refType!==ue.J1.None?new Promise(((t,s)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,n)=>{e?s(e):t(n)}))})):Promise.reject(new Error("Blob does not have a data pointer"))}requestCacheDump(e){if(e)throw new Error("NYI");return this.submitCustomMessage(new _.z_)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(e){this.isSessionClosed=!0,this.sessionManager.closeSession(e),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this),this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0)}authenticateInteractive(e){return ot(this,void 0,void 0,(function*(){if(!(e&&e.forceUserPrompt)&&this.cachedClaimsChallenge.claimsVersion>0&&!this.cachedClaimsChallenge.actionRequired)return;const t=yield this.requestAuthTokenInteractive(this.cachedClaimsChallenge,{interactive:!0});if(_.D0.typeGuard(t))throw new Error(t.reason)}))}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){const t=this.getSessionStateCallbackToken("close");return e&&this.sessionCloseCallbacks.set(t,e),t}setConnectCallback(e){const t=this.getSessionStateCallbackToken("connect");return e&&this.connectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getSessionStateCallbackToken("disconnect");return e&&this.disconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getSessionStateCallbackToken("reconnect");return e&&this.reconnectCallbacks.set(t,e),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.reconnectCallbacks)||t(this.disconnectCallbacks)||t(this.connectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}setClaimsChallengeCallback(e){this.cachedClaimsChallenge.actionRequired&&e(this.cachedClaimsChallenge),this.claimsChallengeCallback.push(e)}setSeedingStatusChangeCallback(e){e(new _.fr({newStatus:this.seedingStatus})),this.seedingStatusChangeCallbacks.push(e)}getConnectParams(){return this.connectParams}setOfflineMode(){this.sessionManager=new nt}onAnnotationResults(e,t,s){i.tG.info(508916486,i.nh.CoreDefault,new o.I({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0,cv:e.cv})),s(void 0,new _.YK),t===rt.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(e.ops),this.updateWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,s)=>{this.applyOperationForContext(e,s,t)}),((s,n)=>{const i=Date.now();this.triggerRegisteredAnnotationCallbacks(s,e.annotationType,n,e.areApologies),t===rt.ServerWorkflow&&(0,Z.M4)(e,i,"CallbackInRuntimeClient",!0,new o.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}),(e=>{if(t!==rt.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this)).filter(lt);this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var s;t(void 0,new _.YK);for(const t of e.updates){const{annotationType:e,state:n}=t;if(!this.tokensByAnnotationType.has(e))continue;let o;o=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):n===f.K7.Idle?f.K7.Pending:f.K7.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(s=e.options)||void 0===s?void 0:s.stateUpdateCallback)&&e.options.stateUpdateCallback(o,n)}}}submitOperationsToSession(e,t){t||(t=this.generateCorrelationId());const s=e.filter((e=>le.g0.typeGuard(e))),n=e.filter((e=>!le.g0.typeGuard(e)));if(s.length>0&&this.sendMessageToSession(new _.Tb({cv:t,ops:s})),n.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,s)=>{if(e.length){const t=new _.l0;t.messages=[],e.forEach((e=>{t.messages.push(new _.Tb({cv:e.cv,seq:this.nextSyncSequenceId++,ops:e.input}))})),this.sendMessageToSession(t,(e=>{s(e?new Error(e.error):void 0)}))}}:(e,t,s)=>{this.sendMessageToSession(new _.Tb({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{s(e?new Error(e.error):void 0)}))},this.batchedOperationsManager=new _e.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.batchedOperationsManager.addBatchItem(n,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.sendMessageToSession(new _.Tb({cv:t,seq:this.nextSyncSequenceId++,ops:n}))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),_.w9.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){const s=new o.I({operationName:"SendLargeBinaryDataMessage",success:!0,cv:e.cv}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,st.A2)(this.connectParams,e,s,t);else{const n=(n=>(0,st.A2)(n,e,s,t)).bind(this);this.pendingConnectCallbacks.push(n)}}requestBinaryDataFromSessionBlobEndpoint(e,t){const s=new o.I({operationName:"RequestBinaryData",success:!0,cv:(new g.W).toString()}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)(0,st.ZC)(this.connectParams,e,t,s);else{const n=(n=>(0,st.ZC)(n,e,t,s)).bind(this);this.pendingConnectCallbacks.push(n)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,s){let n=T.h.getTypeNameFor(e);if(n!=le.Xr.getTypeName()&&n!=le.I.getTypeName()&&n!=le.fZ.getTypeName()&&n!=le.n4.getTypeName())return;n==le.I.getTypeName()&&(n=le.Xr.getTypeName());const o=Ie(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),a=we(o.parentPath);if(n==le.Xr.getTypeName()||n==le.fZ.getTypeName()){if(!o.body)return;const e=T.h.getTypeNameFor(o.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let r=t.get(s);if(r||(r=[],t.set(s,r)),o.id||this.localWorkflowManager&&(o.id=this.localWorkflowManager.getNextClientAnnotationId()),n==le.Xr.getTypeName())0==r.filter((e=>we(e.parentPath)==a&&e.id==o.id)).length?r.push(o):i.tG.info(540848911,i.nh.CoreDefault,`AddOperation for (${s}, ${o.id}, ${o.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<r.length;e++)if(r[e].id==o.id&&we(r[e].parentPath)==a){if(r[e].source==o.source){r[e]=o;break}i.tG.warn(540848912,i.nh.CoreDefault,`UpdateOperation for (${s}, ${o.id}, ${o.source}) can't be applied as the context item with provided path and ID has different source: ${r[e].source}`)}else i.tG.warn(540848913,i.nh.CoreDefault,`UpdateOperation for (${s}, ${o.id}, ${o.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(n==le.n4.getTypeName()){if(!o.id)return;this.availableContexts.forEach(((e,t)=>{let n=e.get(s);n&&(n=n.filter((e=>!(we(e.parentPath)==a&&e.id==o.id))),0==n.length?e.delete(s):e.set(s,n),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const s of e)if(De.has(T.h.getTypeNameFor(s)))for(const e of s.items)for(const s of t||[])this.localWorkflowManager.preProcessItemToWorkflow(s,e,this)}}resolveRequestedContexts(e){const t=[];for(const[s,n,o]of Ae(e.requestedContextTypesRules)){if(!this.availableContexts.has(s)){if(n==Se.in.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(s).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${s} which does not contain any context annotation.`);t.push(...e)}return[!0,this.removeDuplicatedContextItems(t)]}removeDuplicatedContextItems(e){return e.filter(((e,t,s)=>s.findIndex((t=>k.Aq.deepEquals(t,e)))===t))}getContextAnnotations(e,t,s,n){var o,i;const a=s?we(s):void 0;return null===(i=null===(o=this.availableContexts.get(e))||void 0===o?void 0:o.get(t))||void 0===i?void 0:i.filter((e=>!(a&&we(e.parentPath)!=a||n&&e.source!=n)))}onWorkflowDefinitionOverrideMessage(e){const t=new o.I({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),s=e=>{throw ct(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void s("Not supported by this local SessionProxy instance.");const n=this.localWorkflowManager.getWorkflowDefinitionsByName(this),i=n.get(e.sourceWorkflowId);if(!i)return void s(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=i.id;const a=n.get(e.targetWorkflowId);a&&(a.allowDefinitionOverride?i.definitionOverrideTargetWorkflows&&-1!==i.definitionOverrideTargetWorkflows.indexOf(a.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(a,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,ct(t)):s(`Workflow '${i.id}' does not allow workflow definition for workflow '${a.id}'.`):s(`Workflow '${a.id}' does not allow workflow definition override.`))}applyContextIdOnOperations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}triggerRegisteredAnnotationCallbacks(e,t,s,n){if(this.callAnnotationCallbacks(e,t,s,n),this.hostCallbacks.onAnnotationResult)try{n?this.hostCallbacks.onApologyResult&&this.hostCallbacks.onApologyResult(e,s):this.hostCallbacks.onAnnotationResult(e,s)}catch(e){i.tG.error(540301151,i.nh.CoreDefault,new o.I({operationName:"HostCallbackOnAnnotationResultError",dimension0:t,resultDescription:`onAnnotationResult error: ${e}`}))}}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new _.YK),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new Xe,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,s;const n=[];i.tG.info(523776396,i.nh.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(s=e.items)||void 0===s?void 0:s.length)>0?e.items[0].id:"(no items)"})`);let o=[...e.parentPath];for(const t of e.items){const s=[],a=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==a?void 0:a.length){for(const n of a){const i=(0,et.v4)();o=[...e.parentPath,t.id];const a={id:i,revId:t.revId,body:n,contextId:t.contextId,source:t.source};s.push(a)}s.length>0&&(n.push(new le.xU({parentPath:o,items:s})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,o,s))}else i.tG.info(523329632,i.nh.CoreDefault,`Failed to create delta on item ${t.id}`)}return n}setupSyncDeltaAfterDelay(e,t,s){var n,o,i;const a=this.syncDeltaTimers.get(e.id);a&&(clearTimeout(a),this.syncDeltaTimers.delete(e.id));const r=s.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===Fe.OD.Chars}));if(r){const s=r.body,a={content:"",deltaType:Fe.WI.Update,length:0,position:(null!==(n=null==s?void 0:s.position)&&void 0!==n?n:0)+(null!==(i=null===(o=null==s?void 0:s.content)||void 0===o?void 0:o.length)&&void 0!==i?i:0),unit:Fe.OD.Sentence},c=xe.Cg.typeGuard(e.body)?new Ge.s(a):new Ge.Q(a),l={id:(0,et.v4)(),revId:e.revId,body:c,contextId:e.contextId,source:e.source},u=new le.xU({parentPath:t,items:[l]}),p=setTimeout(((e,t)=>{this.submitOperation(e),this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,u,e.id);this.syncDeltaTimers.set(e.id,p)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow(ke(e))}getAnnotations(e,t){var s,n,i;const a=null!==(s=e.cv)&&void 0!==s?s:this.sessionManager.getCorrelationVector().newChild().toString(),r=new o.I({operationName:"GetAnnotations",success:!0,resultSignature:"GetAnnotationsEntry",resourceId:`${e.sourceInfo.featureId}-${e.sourceInfo.entryPoint}`,cv:a}).setClientMetadata(this.clientMetadata).start();r.setDataFields({AnnotationType:null===(n=e.annotationType)||void 0===n?void 0:n.toString(),MaxDelayMs:null===(i=e.maxDelayMs)||void 0===i?void 0:i.toString()});const c=new V.x5({annotationTypes:e.annotationType,transientItems:e.transientItems,configs:e.configs,maxDelayMs:e.maxDelayMs,sourceInfo:e.sourceInfo,caller:ie.Client,tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,correlationInfo:{cvString:a},cv:a}),l=[];let u;ct(r),this.sendMessageToSession(c,((e,s)=>{(null==t?void 0:t.IsCancellationRequested)||(l.push({error:e,response:s}),null==u||u(!0))}));const p=this;let g=!1;const h=new Promise(((e,s)=>{null==t||t.onCancel((t=>{g?e():s(new Error(ut.requestCancelledError))}))}));return{[Symbol.asyncIterator](){var e,s,n,o,i,a,c;return at(this,arguments,(function*(){for(;!g;)try{0===l.length&&(yield it(Promise.race([new Promise((e=>u=e)),h]))),r.resultSignature="AnnotationReceived";const d=l.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(ut.requestCancelledError);g=(null===(e=d.response)||void 0===e?void 0:e.finalResponse)||void 0!==d.error,r.setDataField("FinalResponse",g);const m=(0,Z.Kh)(d.response);let y,T,_;if(r.setDataField("FirstUserPerceivedResponse",m),d.error){const e=`ErrorCode: ${d.error.code}, Error: ${d.error.error}, Retryable: ${d.error.retryable}`;r.setDataField("ServerError",e),_=d.error.error,y={serviceError:[{code:f.Qn.ServerError,error:d.error.error,retryable:null==p?void 0:p.canBeRetried(d.error)}]}}else if((null===(n=null===(s=d.response)||void 0===s?void 0:s.errorInfo)||void 0===n?void 0:n.length)>0){const e=d.response.errorInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");r.setDataField("WorkflowErrors",e),_="Workflow execution error",y={serviceError:d.response.errorInfo}}else r.resultDescription="OK";if((null===(i=null===(o=d.response)||void 0===o?void 0:o.warningInfo)||void 0===i?void 0:i.length)>0){T={serviceError:d.response.warningInfo};const e=d.response.warningInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");r.setDataField("WorkflowWarnings",e)}ct(r,_),yield yield it({content:null===(a=d.response)||void 0===a?void 0:a.content,error:null!=y?y:void 0,warning:null!=T?T:void 0,finalResponse:null===(c=d.response)||void 0===c?void 0:c.finalResponse})}catch(e){const t=e.message===ut.requestCancelledError?f.zy.RequestCancelled:f.zy.Unknown;r.setDataField("ClientError",`ErrorCode: ${t}, Error: ${e.message}`),ct(r,null==e?void 0:e.message),yield yield it({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),g=!0;break}}))}}}isHttpFallback(){const e=this.sessionManager.getNetworkWorkerManager();return!(!e||e.getInitNetworkMode()!==oe.JSWebSockets||e.getNetworkMode()!==oe.HttpFallback)}canBeRetried(e){return(null==e?void 0:e.code)===f.xv.TooManyRequests||(null==e?void 0:e.code)===f.xv.RequestTimeout||e.error.includes(v.ClientDisconnected)}getAuthToken(e,t){const s={Tickets:[]};this.clientMetadata.docSessionId&&(s.DocSessionId=this.clientMetadata.docSessionId);const n=(e=>{if(e===Ce.OY.Substrate)return Te.OY.Substrate})(e);n&&(s.TokenType=n),this.hostCallbacks.requestAuthToken(s).then((s=>{var n;if(!s)throw new Error("Missing AuthTokenResponse from requestAuthToken");if(!s.Token)throw new Error("Missing Token from requestAuthToken");t(void 0,s.Token,{returnedTokenType:e,timeToLiveSec:null===(n=s.TokenProperties)||void 0===n?void 0:n.timeToLiveSec})})).catch((e=>{t(e)}))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{var t;this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0,sendApologies:void 0!==(null===(t=e.options)||void 0===t?void 0:t.apologyCallback)}).catch((()=>{}))})),this.reconnectCallbacks.forEach(((e,t)=>{e()})),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallbacks.forEach(((t,s)=>{t(e)}))}onConnect(e,t,s,n,i,a,r){const c=new o.I({operationName:"OnConnect",success:!0}).setClientMetadata(this.clientMetadata).start();c.setDataField("HasSessionConnected",this.hasSessionConnected),c.setDataField("IsSeedingRequired",e),c.setDataField("SeedingStatus",this.seedingStatus);let l=!1;e&&(this.hasSessionConnected&&(this.allowSeed=!0,this.allowGroupSeed=!0,l=this.changeSeedingStatus(f.e9.NotStarted,"ReconnectReset",!1),this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0)),this.cachedClaimsChallenge=Object.assign(Object.assign({},this.cachedClaimsChallenge),{claimsVersion:0})),this.enableRemoteExecutionNotification&&!this.hasSessionConnected&&this.addDownstreamWorkflowsIntoClientGraph(a),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:s,authToken:n,routingSessionKey:r},this.hasSessionConnected=!0,this.tryActivateWorkflows();for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallbacks.forEach(((o,i)=>{o(e,t,s,n,r)})),l&&this.triggerSeedingStatusChangeCallbacks(),this.serverInputTypes=i,this.onConnectTelemetryCG&&ct(c)}onDisconnect(e){this.connectParams=void 0,this.disconnectCallbacks.forEach(((t,s)=>{t(e)}))}onSeedingStatusChangeMessage(e,t){t(void 0,new _.YK),this.changeSeedingStatus(e.newStatus,"SeedingStatusChangeMessage")}changeSeedingStatus(e,t,s=!0){const n=new o.I({operationName:"SeedingStatusChange",success:!0}).setClientMetadata(this.clientMetadata).start();return n.setDataField("Status",f.e9[e]),n.setDataField("Reason",t),ct(n),this.seedingStatus!=e&&(this.seedingStatus=e,s&&this.triggerSeedingStatusChangeCallbacks(),!0)}triggerSeedingStatusChangeCallbacks(){this.seedingStatusChangeCallbacks.forEach((e=>{e(new _.fr({newStatus:this.seedingStatus}))}))}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==ce.f.Authenticated&&e==ce.f.Pending)return;const t=new o.I({operationName:"ServerAuthStateChange",dimension0:ce.f[e],dimension1:ce.f[this.serverAuthenticationState],success:!0}).setClientMetadata(this.clientMetadata).start();t.resultDescription=`Changing Server Authentication State newState: ${ce.f[e]}, previousState: ${ce.f[this.serverAuthenticationState]}`,ct(t),this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t,s,n){if(0===this.annotationCallbacks.size&&0===this.apologyCallbacks.size)return;const o=n?this.apologyCallbacks.get(t):this.annotationCallbacks.get(t);o&&o.forEach((t=>{t(e,s)}))}getOperationBatchConfig(e){let t;t=this.batchMessagesEnabled?e=>({input:e,demultiplex:()=>[[]]}):e=>({input:e.filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]});return{delayMs:e.delayMs,delayMsMax:e.delayMsMax,maxInputSize:e.maxInputSize,estimateSize:tt.E,groupingKeyExtractor:()=>"operations",multiplex:t,split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,s){if(!this.seedBatchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,s)=>{if(this.batchedSeedMessageGroupSize+=e.length,e.length){const n=new _.l0;n.messages=[],e.forEach((e=>{n.messages.push(new _.Tb({cv:e.cv,seq:0,ops:e.input,groupId:"Seed",groupSize:t.groupComplete?this.batchedSeedMessageGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}))})),this.sendMessageToSession(n,(e=>{s(e?new Error(e.error):void 0)}))}}:(e,t,s)=>{this.seedGroupSize++,this.sendMessageToSession(new _.Tb({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{s(e?new Error(e.error):void 0)}))},this.seedBatchedOperationsManager=new _e.Y(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},s,t)}onAnnotationResultsFromServer(e,t){(0,Z.M4)(e,Date.now(),"ReceiveFromNetwork",!0,new o.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.onAnnotationResults(e,rt.ServerWorkflow,t)}getLocalRegisteredWorkflows(){return this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>ke(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new o.I({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),s=new _.TV({upstreamRuntimeWorkflows:e});this.sendMessageToSession(s,((s,n)=>{s?ct(t,s.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${n.downstreamRuntimeWorkflows.map((e=>e.id))}`,ct(t),this.onWorkflowGraphInitResponse(n))}))}trySendWorkflowGraphInitMessage(){!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&(this.graphInitMessageTimer=setTimeout((()=>{this.graphInitMessageTimer=void 0,this.sendWorkflowGraphInitMessage()}),10))}onWorkflowGraphInitResponse(e){this.addDownstreamWorkflowsIntoClientGraph(e.downstreamRuntimeWorkflows),this.tryActivateWorkflows()}addDownstreamWorkflowsIntoClientGraph(e){this.workflowGraph.removeWorkflows(!0);for(const t of e||[])this.workflowGraph.addWorkflow(t,!0);this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(i.tG.info(540848914,i.nh.CoreDefault,`Replacing user context placeholder for: ${we(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(i.tG.info(540848915,i.nh.CoreDefault,`Replacing tenant context placeholder for: ${we(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return(0,k.zX)(e,this.serverInputTypes)}executeCallbacksOnAnnotationSubmitted(e,t){const{annotationOpsMap:s,apologyOpsMap:n}=this.getAnnotationOperationsByType(e);s.forEach(((e,s)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,s,t,!1)))})),n.forEach(((e,s)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,s,t,!0)))}))}partitionAnnotationOperations(e){return e.reduce((([e,t],s)=>s.items.some((e=>e.body&&pe.YH.typeGuard(e.body)))?[[...e,s],t]:[e,[...t,s]]),[[],[]])}onAnnotationsSubmitted(e,t){const{annotationOpsMap:s,apologyOpsMap:n}=this.getAnnotationOperationsByType(e);s.forEach(((e,s)=>{const n=Array.from(e);this.onAnnotationResults(new _.B_({annotationType:s,ops:n,cv:t,areApologies:!1}),rt.Submitted,(()=>{}))})),n.forEach(((e,s)=>{const n=Array.from(e);this.onAnnotationResults(new _.B_({annotationType:s,ops:n,cv:t,areApologies:!0}),rt.Submitted,(()=>{}))}))}getAnnotationOperationsByType(e){const t=new Map,s=new Map;for(const n of e)for(const e of n.items)if(e.body&&pe.YH.typeGuard(e.body)){const o=(e,t)=>{const s=e.get(t)||new Set;s.add(n),e.set(t,s)};ge.typeGuard(e.body)?o(s,e.body.annotationTypeName):o(t,T.h.getTypeNameFor(e.body))}return{annotationOpsMap:t,apologyOpsMap:s}}onClaimsChallengeMessage(e,t){var s;const n=new o.I({operationName:"OnClaimsChallengeMessage",dimension0:e.claimsVersion.toString(),dimension1:e.error,success:!0}).setClientMetadata(this.clientMetadata).start(),i=e.claims&&e.claims.length>0;n.resultSignature=`HasClaims: ${i}`,n.resultDescription="Received Claims Challenge Message from Server",ct(n),e.claimsVersion>this.cachedClaimsChallenge.claimsVersion&&(this.cachedClaimsChallenge=Object.assign(Object.assign({},e),{actionRequired:!0})),(null===(s=this.gateUtils)||void 0===s?void 0:s.isChangeGateEnabledSync(Jt))?this.requestAuthTokenInteractive(e).then((e=>{_.D0.typeGuard(e)&&this.invokeClaimsChallengeCallbacks()})).catch((()=>{})):this.invokeClaimsChallengeCallbacks(),t(void 0,new _.YK)}generateCorrelationId(){return this.sessionManager.getCorrelationVector().newChild().toString()}onTokenProvisionResponse(e){e&&this.onServerAuthenticationStateChange(ce.f.Authenticated)}invokeClaimsChallengeCallbacks(){for(const e of this.claimsChallengeCallback)e(this.cachedClaimsChallenge)}requestAuthTokenWithClaims(e){this.requestAuthTokenInteractive(e).catch((()=>{}))}requestAuthTokenInteractive(e,t){var s;const n=new o.I({operationName:"RequestAuthTokenInteractive",success:!0,dimension0:`isInteractive: ${null!==(s=null==t?void 0:t.interactive)&&void 0!==s&&s}`}).start();n.dimension1=`HasClaims: ${!!e.claims&&e.claims.length>0}`;const i={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:Te.OY.Augloop,ConnectParams:this.connectParams,Claims:e.claims,Interactive:null==t?void 0:t.interactive};return this.hostCallbacks.requestAuthToken(i).then((t=>{if(!t)throw new Error("Missing AuthTokenResponse from requestAuthToken claims");if(!t.Token)throw new Error("Missing Token from requestAuthToken claims");return n.resultSignature="Token",new _.kd({authToken:t.Token,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})})).catch((t=>(n.resultSignature="NoToken",n.dimension2=t.message,new _.D0({reason:t.message,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion,clientHandlesResponse:!0})))).then((e=>new Promise(((t,s)=>{this.sendMessageToSession(e,((o,i)=>{ct(n,null==o?void 0:o.error),o?s(new Error(o.error)):(_.kd.typeGuard(e)&&(this.cachedClaimsChallenge.actionRequired=!1,this.onTokenProvisionResponse(i)),t(e))}))}))))}ensureConnection(){return Promise.resolve()}keepAlive(){}}ut.requestCancelledError="Request cancelled";class pt{}var gt;!function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(gt||(gt={}));class ht{constructor(){this.timers=new Map}scheduleRefresh(e,t,s,n){let o=this.timers.get(e);o||(o={numberOfAttempts:0},this.timers.set(e,o)),o.refreshTimeoutId&&(clearTimeout(o.refreshTimeoutId),o.refreshTimeoutId=void 0),o.expiredTimeoutId&&(clearTimeout(o.expiredTimeoutId),o.expiredTimeoutId=void 0);let i=1e3*t-ht.tokenRefreshBufferMs,a=1e3*t-ht.tokenExpirationBufferMs;i>0?o.numberOfAttempts=0:(++o.numberOfAttempts,i=ht.tokenRefreshBackoffIntervalMs,a=ht.tokenExpirationBufferMs),o.numberOfAttempts<=ht.tokenRefreshMaximumAttempts&&(o.refreshTimeoutId=setTimeout((()=>{s()}),i)),n&&(o.expiredTimeoutId=setTimeout((()=>{n()}),a))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,s)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(s)}))}}ht.tokenRefreshBufferMs=24e4,ht.tokenExpirationBufferMs=12e4,ht.tokenRefreshBackoffIntervalMs=3e4,ht.tokenRefreshMaximumAttempts=3;var dt=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};class mt extends b.EventEmitter{constructor(e,t,s,n,o){if(super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=s,this.sendMessage=n,this.options=o||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e),this.clientMetadata&&!this.clientMetadata.userSystemTimezone)try{this.clientMetadata.userSystemTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=k.Aq.getCurrentTimeMs(),s=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,n=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,r=new o.I({operationName:"SessionInit"}).start(),c={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:s,timeSinceLastSyncMessage:n,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0,isSeedingRequired:void 0,enableCreateBlobStorageContainer:this.options.createBlobStorageContainerEnabled},l=this.options.overrideSessionInitMessage(new _.eE({protocolVersion:f.mH,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,createBlobStorageContainer:this.options.createBlobStorageContainerEnabled}));this.sendMessage(l,((t,s)=>{if(r.success=!t,r.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",r.resourceId=(0,a.k$)(null==s?void 0:s.sliceUrl),r.setClientMetadata(this.clientMetadata),(null==s?void 0:s.sessionKey)&&c.sessionKey!==s.sessionKey&&(c.sessionKey=s.sessionKey),t&&(c.error=t.error),c.isSeedingRequired=this.sessionKey!==(null==s?void 0:s.sessionKey),r.resultDescription=JSON.stringify(c),i.tG.info(508843779,i.nh.CoreDefault,r.stop()),e.onResponse(t,s),t)this.emit("serverAuthenticationStateChange",ce.f.NotAuthenticated);else if(e.isReconnectOnSameSlice&&s.forceReconnect)this.emit("serverAuthenticationStateChange",ce.f.NotAuthenticated);else{if(!s.anonymousToken||!s.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",ce.f.NotAuthenticated),void i.tG.error(508843778,i.nh.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=s.anonymousToken,this.onSuccessfulSessionInitOnServerSide(s)}}))}onSuccessfulSessionInitOnServerSide(e){var t,s;this.tokenRefreshManager.scheduleRefresh(gt.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.connectParams={isSeedingRequired:this.sessionKey!==e.sessionKey,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,origin:e.origin,authToken:this.anonymousToken},(null===(t=this.options)||void 0===t?void 0:t.dontSendTokenOnReconnectChangeGate)&&e.existingTokenProvisionResponse&&(null===(s=e.existingTokenProvisionResponse)||void 0===s?void 0:s.tokenType)===Ce.OY.AugLoopLowPrivilege||(this.options.sendTokenFailureMessageChangeGate?this.initHostAuthTokenNew().catch((()=>{})):this.initHostAuthToken());const n=!!this.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",this.connectParams.isSeedingRequired,n,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,e.workflowInputTypes,e.downstreamRuntimeWorkflows,e.routingSessionKey),n&&this.emit("reconnect")}getAuthToken(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:Te.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e)).catch((()=>{}))}getAuthTokenNew(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:Te.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e))}getAuthTokenTimeoutPromise(){const e=this.options.authTokenTimeoutMs;return new Promise(((t,s)=>{setTimeout((()=>{s(new Error(`Host auth token provision took longer than ${e} ms`))}),e)}))}initHostAuthToken(){const e=this.getAuthToken.bind(this);if(this.options.requestAuthToken&&e){const t=new o.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();e().then((e=>{if(e){if(!e.Token)return e.TokenError==Te.Pu.TokenMissingInteractionRequired?(this.emit("serverAuthenticationStateChange",ce.f.TokenMissingInteractionRequired),t.resultDescription="Host auth token provision failed interaction required"):(this.emit("serverAuthenticationStateChange",ce.f.NotAuthenticated),t.resultDescription="Host auth token provision failed"),t.success=!1,void i.tG.info(508843777,i.nh.CoreDefault,t.stop());i.tG.info(508843776,i.nh.CoreDefault,t.stop()),this.sendTokenProvisionMessage(e.Token)}else t.resultDescription="TokenResponse is not set"})).catch((e=>{this.emit("serverAuthenticationStateChange",ce.f.NotAuthenticated),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`,i.tG.error(508843747,i.nh.CoreDefault,t.stop())}))}}initHostAuthTokenNew(){return dt(this,void 0,void 0,(function*(){const e=this.getAuthTokenNew.bind(this);if(this.options.requestAuthToken&&e){const t=new o.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();let s,n,a=ce.f.NotAuthenticated;try{if(s=this.options.authTokenTimeoutMs>0?yield Promise.race([e(),this.getAuthTokenTimeoutPromise()]):yield e(),!s)throw new Error("TokenResponse is not set");if(!s.Token)throw s.TokenError==Te.Pu.TokenMissingInteractionRequired?(a=ce.f.TokenMissingInteractionRequired,new Error("Host auth token provision failed interaction required")):new Error("Host auth token provision failed")}catch(e){n=e.message,this.emit("serverAuthenticationStateChange",a),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`}try{n?this.sendMessage(new _.D0({reason:n,version:mt.initialTokenVersion,clientHandlesResponse:!0})):this.sendTokenProvisionMessage(s.Token)}catch(e){n||(n=e.message,this.emit("serverAuthenticationStateChange",a),t.success=!1,t.resultDescription=`Error happened while attempting to send host token: ${e}`)}finally{n?i.tG.error(506074845,i.nh.CoreDefault,t.stop()):i.tG.info(506074846,i.nh.CoreDefault,t.stop())}}}))}sendTokenProvisionMessage(e){const t=new _.kd({authToken:e,version:mt.initialTokenVersion});this.emit("serverAuthenticationStateChange",ce.f.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){!e&&t&&t.tokenExpirationSeconds?(this.emit("serverAuthenticationStateChange",ce.f.Authenticated),this.tokenRefreshManager.scheduleRefresh(gt.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))):this.emit("serverAuthenticationStateChange",ce.f.NotAuthenticated)}}mt.initialTokenVersion=1;var yt,Tt=s(167850);!function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(yt||(yt={}));var ft=s(392346),_t=s(580717),Ct=s(534342);class St{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=we(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Error("Method not implemented.")}getContextItemBodies(e){throw new Error("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class At{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&T.h.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&T.h.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented yet")},this.items=[...t,e],this.scopeItem=new St(e)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}const vt=[Fe.WI.CursorUpdate,Fe.WI.FormattingUpdate,Fe.WI.OtherNonContentUpdate,Fe.WI.AttributionUpdate];function It(e,t,s){const n=new o.I({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return n.success=!1,n.resultDescription="Unable to apply text tile delta, parent tile is undefined",void i.tG.info(538798173,i.nh.CoreDefault,n.stop());if(T.h.getTypeNameFor(t)!==xe.qf.getTypeName())return n.success=!1,n.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${Ge.Q.getTypeName()}, received ${T.h.getTypeNameFor(t)}`,void i.tG.info(538798174,i.nh.CoreDefault,n.stop());const s=e,o=t.content;let a="";if(void 0===s.position||s.position<0)return n.success=!1,n.resultDescription="Unable to apply text tile delta, invalid text tile position",void i.tG.info(538798175,i.nh.CoreDefault,n.stop());switch(s.deltaType){case Fe.WI.Add:a=s.position<o.length?`${o.slice(0,s.position)}${s.content}${o.slice(s.position,o.length)}`:o+s.content;break;case Fe.WI.Update:s.content||s.unit!==Fe.OD.Sentence||(n.dimension0="1"),a=`${o.slice(0,s.position)}${s.content}${o.slice(s.position+(s.length||0),o.length)}`;break;case Fe.WI.Delete:a=`${o.slice(0,s.position)}${o.slice(s.position+(s.length||0),o.length)}`}return i.tG.info(538837071,i.nh.CoreDefault,n.stop()),new xe.qf({content:a})}catch(e){return n.success=!1,n.resultDescription=`Error applying text tile delta: ${e}`,void i.tG.info(538798176,i.nh.CoreDefault,n.stop())}}function wt(e,t){var s,n,o,i,a;const r=(null===(s=t.attributionData)||void 0===s?void 0:s.ranges)||t.attributionRanges;if((null===(n=t.attributionData)||void 0===n?void 0:n.isFullUpdate)||t.deltaType!==Fe.WI.AttributionUpdate&&void 0!==r)return r;if(!(null===(o=e.attributionRanges)||void 0===o?void 0:o.length)&&!r||t.deltaType===Fe.WI.Update&&0===t.length)return e.attributionRanges;let c=e.attributionRanges?[...e.attributionRanges]:[];if(t.deltaType!==Fe.WI.AttributionUpdate){const s=Et(e.attributionRanges,t.deltaType,t.position),n=s?c.indexOf(s):-1;-1!==n&&(s.length=t.position-s.start);const o=(null!==(i=t.content)&&void 0!==i?i:"").length,r=null!==(a=t.length)&&void 0!==a?a:0,l=t.position+r,u=t.position+o;for(const e of c.slice(n+1)){if(e.start<t.position)continue;const s=e.start+e.length;l>e.start&&(e.length=s-l),e.start=Math.max(e.start+o-r,u)}return c=c.filter((e=>e.length>0)),c}const l=[];for(const e of r)0!==l.length&&l[l.length-1].start+l[l.length-1].length>=e.start?l[l.length-1].length=e.start+e.length-l[l.length-1].start:l.push({start:e.start,length:e.length});c=c.filter((e=>e.length>0&&!(e=>{for(const t of l)if(t.start<=e.start&&t.start+t.length>=e.start+e.length)return!0;return!1})(e))),null==r||r.forEach((e=>{c.push(e)})),c.sort(((e,t)=>e.start-t.start));const u=[];for(const e of c){const t=u.length>0?u[u.length-1]:void 0;t&&t.start+t.length>e.start&&(t.length=Math.max(e.start-t.start,0)),!t||(g=e,(p=t).attribution.userId!==g.attribution.userId||p.attribution.timestamp!==g.attribution.timestamp||p.attribution.dataSource!==g.attribution.dataSource)||e.start>t.start+t.length?u.push(e):t.length+=Math.max(e.start+e.length-(t.start+t.length),0)}var p,g;return u}function Nt(e,t,s){var n,a,r,c;const l=new o.I({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();l.clientFlights=s;try{if(!t)return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void i.tG.info(538798177,i.nh.CoreDefault,l.stop());if(T.h.getTypeNameFor(t)!==xe.Cg.getTypeName())return l.success=!1,l.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${xe.Cg.getTypeName()}, received ${T.h.getTypeNameFor(t)}`,void i.tG.info(538798178,i.nh.CoreDefault,l.stop());const s=t,u=e,p=s.content;let g="";if((void 0===u.position||u.position<0)&&!kt(u.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void i.tG.info(538798179,i.nh.CoreDefault,l.stop());if(void 0===u.content&&!kt(u.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void i.tG.info(538798208,i.nh.CoreDefault,l.stop());if(u.deltaType===Fe.WI.Add&&0!==u.length?i.tG.info(538798209,i.nh.CoreDefault,new o.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):kt(u.deltaType)&&void 0!==u.content&&i.tG.info(538798210,i.nh.CoreDefault,new o.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!bt(u.deltaType)){const e=function(e,t){var s,n,o,i;const a=Et(e.formattedRanges,t.deltaType,t.position);let r=e.formattedRanges?[...e.formattedRanges]:[];const c=a?r.indexOf(a):-1;-1!==c&&(t.position+(t.length||0)>a.start+a.length?a.length=t.position+(null!==(s=t.content)&&void 0!==s?s:"").length-a.start:a.length+=(null!==(n=t.content)&&void 0!==n?n:"").length-(t.length||0),r[c]=a);for(const e of r.slice(c+1))e.start<t.position||(t.position+(t.length||0)>e.start?(e.length=e.start+e.length-(t.position+(t.length||0)),e.start=t.position+(null!==(o=t.content)&&void 0!==o?o:"").length):e.start+=(null!==(i=t.content)&&void 0!==i?i:"").length-(t.length||0));return r=r.filter((e=>e.length>0)),r}(s,u),t=wt(s,u);let o=s.ipPosition;switch(u.deltaType){case Fe.WI.Add:g=u.position<p.length?`${p.slice(0,u.position)}${u.content}${p.slice(u.position,p.length)}`:p+u.content,o=u.position+u.length;break;case Fe.WI.Update:u.content||u.unit!==Fe.OD.Sentence||(l.dimension0="1"),g=`${p.slice(0,u.position)}${u.content}${p.slice(u.position+(null!==(n=u.length)&&void 0!==n?n:0),p.length)}`,o=u.position+u.content.length;break;case Fe.WI.Delete:g=`${p.slice(0,u.position)}${p.slice(u.position+(null!==(a=u.length)&&void 0!==a?a:0),p.length)}`,o=u.position}const r=new xe.Cg(Object.assign(Object.assign({},s),{ipPosition:o,content:g,formattedRanges:e,attributionRanges:t,queryRange:u.queryRange}));return i.tG.info(538837073,i.nh.CoreDefault,l.stop()),r}if(u.deltaType===Fe.WI.CursorUpdate)return new xe.Cg(Object.assign(Object.assign({},s),{ipPosition:null===(r=u.cursorData)||void 0===r?void 0:r.ipPosition,isColdIp:null===(c=u.cursorData)||void 0===c?void 0:c.isColdIp}));if(u.deltaType===Fe.WI.FormattingUpdate)return new xe.Cg(Object.assign(Object.assign({},s),{formattedRanges:u.formattedRanges}));if(u.deltaType===Fe.WI.OtherNonContentUpdate){let e;const t={};for(e in u.otherNonContentData)t[e]=u.otherNonContentData[e];return new xe.Cg(Object.assign(Object.assign({},s),t))}return u.deltaType===Fe.WI.AttributionUpdate?new xe.Cg(Object.assign(Object.assign({},s),{attributionRanges:wt(s,u)})):void 0}catch(e){return l.success=!1,l.resultDescription=`Error applying formatted text tile delta: ${e}`,void i.tG.info(538798211,i.nh.CoreDefault,l.stop())}}function Et(e,t,s){const n=new o.I({operationName:"FindRangeForDelta",success:!0});if(n.start(),!e)return n.resultDescription="No formatted ranges found within the tile, skipping.",void i.tG.info(538798212,i.nh.CoreDefault,n.stop());if(t===Fe.WI.Add){const t=e.find((e=>e.start===s&&0===e.length));if(t)return n.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,i.tG.info(538798213,i.nh.CoreDefault,n.stop()),t;s=Math.max(s-1,0)}const a=e.find((e=>0===e.length?e.start===s:e.start<=s&&s<e.start+e.length));return a?(n.resultDescription=`Updating formatted range for operation with start: ${a.start} and length: ${a.length}`,i.tG.info(538798214,i.nh.CoreDefault,n.stop())):(n.resultDescription=`Unable to find formatted range for operation at position ${s}, skipping.`,i.tG.info(538798215,i.nh.CoreDefault,n.stop())),a}function bt(e){return-1!==vt.indexOf(e)}function kt(e){return bt(e)||Fe.WI.Delete===e}function Mt(e){if(!e)return new Lt([],new Set,new Map,new Map);const t=e.split(";"),s=new Set,n=new Map,o=new Map;for(const e of t){const t=e.trim();if(""===t)continue;s.add(Lt.normalizeName(t));const[i,...a]=t.split(":"),r=a.join(":"),c=Lt.normalizeName(i);if(c){n.set(c,r);const e=Lt.parseName(c);e&&e!==c&&o.set(e,c)}}return new Lt(t,s,n,o)}class Lt{constructor(e,t,s,n){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=s,this.parsedFlightsMap=n}static normalizeName(e){return null==e?void 0:e.toLowerCase()}static parseName(e){const t=null==e?void 0:e.split(".");return t?t[t.length-1]:void 0}hasFlight(e){const t=Lt.normalizeName(e),s=this.normalizedFlights.has(t),n=this.keyValueFlightsMap.has(t),o=this.parsedFlightsMap.has(t);return s||n||o}getBooleanValue(e,t){var s,n;const o=null===(s=this.getStringValue(e))||void 0===s?void 0:s.toLowerCase(),i=null===(n=this.getStringValue(this.parsedFlightsMap.get(Lt.normalizeName(e))))||void 0===n?void 0:n.toLowerCase();return"true"===o||"true"===i||"false"!==o&&"false"!==i&&t}getIntValue(e,t){const s=this.getStringValue(e),n=Number.parseInt(s,10);return Number.isNaN(n)?t:n}getStringValue(e,t){var s;return null!==(s=this.keyValueFlightsMap.get(Lt.normalizeName(e)))&&void 0!==s?s:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,s)=>{const n=null==t?void 0:t.toLowerCase();switch(n){case"true":e.push({name:s,value:!0});break;case"false":e.push({name:s,value:!1});break;default:{const o=Number.parseInt(n,10);Number.isNaN(o)?e.push({name:s,value:t}):e.push({name:s,value:o})}}})),e}}class Bt{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,this.getTokenCallback=e.getTokenCallback}get flights(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=Mt(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getTokenCallback(e,t)}getTokenAsync(e){return new Promise(((t,s)=>{this.getToken(e,((e,n,o)=>{e?s(e):t(Object.assign(Object.assign({},o),{token:n}))}))}))}}class Dt{constructor(e,t,s){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,s&&(this.itemsContextId=s.itemsContextId,this.executionState=s.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const s of this.itemsContextId)0===s.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){return this.graphNode.isActivated?e?(this.executionState.set(e,t),!0):(i.tG.info(520217546,i.nh.CoreDefault,new o.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`})),!1):(i.tG.info(508883415,i.nh.CoreDefault,new o.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a not activated workflow`})),!1)}beforeWorkflowExecution(e){this.setExecutionState(e,Re.Pending)}afterWorkflowExecution(e){this.setExecutionState(e,Re.Executed)&&this.tryToCompleteWorkflowExecution(e)}clearWorkflowExecutions(){this.executionState.forEach(((e,t)=>this.afterWorkflowExecution(t)))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===Re.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[s,n]of t.getExecutionState())n===Re.Executed&&Pe.isParentContextId(e,s)&&t.tryToCompleteWorkflowExecution(s)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const s of t.getExecutionState().keys())if(Pe.isParentContextId(s,e))return!1;return!0}}var Pt;!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(Pt||(Pt={}));class Rt{constructor(e,t,s){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,s)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,s):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,s)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,s):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,s.enableDeltas&&(this.deltaHandlers=(new Map).set(T.h.getTypeNameFor(Ge.Q),It).set(T.h.getTypeNameFor(Ge.s),Nt),this.itemsForDelta=new Map),this.enableEarlyJoin=s.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const s=new o.I({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes(Ae(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGraph(e),s.setClientMetadata(t.getClientMetadata())):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,s)=>{t.push(this.createWorkflowImplementation(e,s))}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,s)=>{s.registerContextTypes(Ae(e.requestedContextTypesRules).map((([e,t])=>e))),s.attachToWorkflowGraph(e)}))),s.success=!0,i.tG.info(572838110,i.nh.CoreDefault,s.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),t.map((e=>e.workflow))}getWorkflowDefinitionsByName(e){var t;const s=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>s.set(e.workflow.id,e.workflow))),s}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,s){const n=e.getWorkflowNodes(),o=this.executionTrackersByWorkflowNameBySession.get(t),i=(e,n)=>{if(s&&s(e,n),this.enableEarlyJoin){(()=>{var e;for(const s of(null===(e=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===e?void 0:e.values())||[])if(s.graphNode.workflow.kind===Se.wC.Join)for(const e of s.getExecutionState().keys())if(Pe.isParentContextId(e,n))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())}};if(o){for(const e of n){const t=o.get(e.workflow.id),s=new Dt(e,i.bind(this),t);o.set(e.workflow.id,s)}for(const e of o.values())this.setDownstreamWorkflowExecutionTrackers(e,o),this.setUpstreamWorkflowExecutionTrackers(e,o)}}canActivateWorkflow(e,t){var s;return e.location===Ne.Local||!!t.hasConnected&&!((null===(s=e.workflow.requiredTokenTypes)||void 0===s?void 0:s.length)>0&&t.getServerAuthenticationState()===ce.f.NotAuthenticated)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:s}=e;for(const n of s.downstreamWorkflows||[]){const s=t.get(n.workflow.id);this.setDownstreamWorkflowExecutionTrackers(s,t),e.downstreamWorkflowExecutionTrackers.add(s)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:s}=e;for(const n of s.upstreamWorkflows||[]){const s=t.get(n.workflow.id);this.setUpstreamWorkflowExecutionTrackers(s,t),e.upstreamWorkflowExecutionTrackers.add(s)}}deactivateServerWorkflow(e,t){var s,n;e.location!==Ne.Local&&(null===(n=null===(s=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===s?void 0:s.get(e.workflow.id))||void 0===n||n.clearWorkflowExecutions(),e.isActivated=!1)}addSession(e){this.isWorkflowTrackingEnabled(e)&&this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const s of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(s)),e.attachToWorkflowGraph(s);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}isWorkflowTrackingEnabled(e){return this.enableEarlyJoin||e.enabledRemoteExecutionNotification()}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e),this.isWorkflowTrackingEnabled(e)&&this.executionTrackersByWorkflowNameBySession.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,s){var n;const o=null===(n=this.executionTrackersByWorkflowNameBySession.get(s))||void 0===n?void 0:n.get(e.id);o&&(e.kind===Se.wC.Join&&T.h.matchesTypesFor(t.body,e.inputTypes)&&o.addInputItemToProcess(t.contextId),(e.kind===Se.wC.SingleItem&&T.h.matchesTypesFor(t.body,e.inputTypes)||e.kind===Se.wC.Join&&T.h.matchesTypesFor(t.body,[e.collectionScopeType]))&&o.beforeWorkflowExecution(t.contextId))}isReadyToEarlyJoin(e,t,s){if(!e)return!1;const n=n=>{var a;const r=Array.from(null!==(a=n.states)&&void 0!==a?a:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),c=new o.I({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();c.setClientMetadata(s),c.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${n.hasProcessedAllInputItems}, allUpstreamComplete: ${n.allUpstreamComplete}, states: ${r}`,i.tG.info(512550800,i.nh.CoreDefault,c.stop())},a=0===e.countItemsToProcess(t);if(!a)return this.enableEarlyJoin||n({hasProcessedAllInputItems:a}),!1;const{allUpstreamComplete:r,states:c}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?r:(n({hasProcessedAllInputItems:a,allUpstreamComplete:r,states:c}),!1)}areAllUpstreamWorkflowComplete(e,t){const s=new Map;for(const n of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[o,i]of n.getExecutionState())if(e.push([o,i]),Pe.isParentContextId(t,o))return s.set(n.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:s};e.length>0&&s.set(n.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:s}}runLocalWorkflows(e,t,s=!1){var n,a,r;const c=(e,s,n)=>{var a,r;const c=t.getWorkflowItemStorage(),{workflow:l}=e,u=null===(a=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===a?void 0:a.get(l.id),p=l.inputTypes.concat(l.kind===Se.wC.Join?l.collectionScopeType:[]),g=new o.I({operationName:"RunLocalWorkflows",success:!0,resourceId:l.id,joinContextId:s.contextId}).start();if(g.setClientMetadata(t.getClientMetadata()),T.h.matchesTypesFor(s.body,p)){const o=Ie(n.parentPath,s);if(l.kind===Se.wC.Join){if(T.h.matchesTypesFor(o.body,[l.collectionScopeType]))return c.setScopeItem(o,l),g.resultDescription=`Scope item: ${s.id} (${T.h.getTypeNameFor(s.body)})`,i.tG.info(524126153,i.nh.CoreDefault,g.stop()),void this.setScopeExecutionNotification(t,e,o);{null==u||u.removeProcessedInputItem(o.contextId);const e=c.getScopeItem(o.contextId,l);if(!e)return g.resultDescription=`Filtered out join invalidation: out of scope type (${l.collectionScopeType}), item id: ${o.id}`,void i.tG.info(541173894,i.nh.CoreDefault,g.stop());c.addItemToWorkflowList(o,l),g.joinContextId=e.contextId,g.resultDescription=`Input item: ${s.id} (${T.h.getTypeNameFor(s.body)})`}}if(T.h.getBaseTypesFor(o.body).indexOf(Tt.W1.getTypeName())>=0){const e=[...o.parentPath,o.id];let s=!0;for(const n of null!==(r=l.outputTypes)&&void 0!==r?r:[])if(!t.getContextAnnotations(n,rt.LocalWorkflow,e,l.id)){s=!1;break}if(s)return}const a=()=>{var n;const[r,p]=t.resolveRequestedContexts(l);if(!r)return g.resultDescription=`Required contexts are not ready for ${l.id}. Retrying execution in 500 milliseconds...`,i.tG.info(545837259,i.nh.CoreDefault,g.stop()),void setTimeout(a,500);if(l.kind===Se.wC.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:o,inputItems:[o],requestedContexts:p,session:t,triggerReason:Pt.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,o,l,t)}).then((()=>{i.tG.info(509154263,i.nh.WorkflowDefault,g.stop())})).catch((e=>{g.resultDescription=e,i.tG.error(572838111,i.nh.CoreDefault,g.stop())}));else if(l.kind===Se.wC.Join){const o=s.contextId,a=c.getScopeItem(o,e.workflow);if(!a)return g.resultDescription=`No scope item for ${l.id} workflow from contextId ${o}`,void i.tG.info(526758475,i.nh.CoreDefault,g.stop());const r=this.isReadyToEarlyJoin(u,a.contextId,t.getClientMetadata()),h=r?Pt.JoinEarlyCompletion:Pt.JoinMaxAnnnotation;if(c.isWorkflowReady(a.contextId,l)||r){if(!(null===(n=this.pendingScopeExecutionNotificationsByWorkflow.get(l.id))||void 0===n?void 0:n.get(a.contextId)))return g.resultDescription=`Workflow ${l.id}, contextId ${a.contextId}, already queued, skipping new scope execution`,void i.tG.info(528048977,i.nh.CoreDefault,g.stop());const s=c.getItemsToExecute(a.contextId,l);this.queueWorkflow({workflowInfo:e,scopeItem:a,inputItems:s,requestedContexts:p,session:t,triggerReason:h,onCompleteCallback:this.onWorkflowExecuted.bind(this,a,l,t)}).then((()=>{i.tG.info(509154262,i.nh.WorkflowDefault,g.stop())})).catch((e=>{g.resultDescription=e,i.tG.error(541173895,i.nh.CoreDefault,g.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).delete(a.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(l.id)}}};a()}};let l=e;s&&(l=[new le.Xr({parentPath:["session"],items:[{id:"#userContext#",body:new Tt.hD}]}),new le.Xr({parentPath:["session"],items:[{id:"#tenantContext#",body:new Tt.SB}]})],t.getContextIdManager().applyContextIdOnOperations(l),l=l.concat(e));for(const e of l){const s=T.h.getTypeNameFor(e);for(const o of e.items)if(t.applyOperationForContext(e,o,rt.Submitted),s!==le.n4.getTypeName()){if(o.body)if(s===le.xU.getTypeName()&&this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(o,e,t);else{null===(a=this.itemsForDelta)||void 0===a||a.set(e.parentPath.concat(o.id).toString(),o);for(const t of this.workflowsWithoutSessionAffinity)c(t,o,e);for(const s of null!==(r=this.workflowsWithSessionAffinity.get(t))&&void 0!==r?r:[])c(s,o,e)}}else null===(n=this.itemsForDelta)||void 0===n||n.delete(e.parentPath.concat(o.id).toString())}}handleLocalDeltaUpdate(e,t,s){const n=new o.I({operationName:"LocalDeltaUpdate",dimension0:T.h.getTypeNameFor(e.body),success:!0});n.start();try{const o=this.deltaHandlers.get(T.h.getTypeNameFor(e.body)),a=this.itemsForDelta.get(t.parentPath.toString());if(o&&a){const r=t.parentPath.length>0?t.parentPath.slice(0,t.parentPath.length-1):t.parentPath,c=o(e.body,a.body);if(c){const t={id:a.id,revId:e.revId,body:c,parentPath:r,delta:e.body,contextId:e.contextId},o=new le.I({parentPath:t.parentPath,items:[t]});i.tG.info(539637591,i.nh.CoreDefault,n.stop()),this.runLocalWorkflows([o],s)}else n.success=!1,n.resultDescription="Failed because the handler did not produce valid updated item",i.tG.info(539637592,i.nh.CoreDefault,n.stop())}else n.success=!1,n.resultDescription="Failed due to lack of handler or parent item",i.tG.info(539637593,i.nh.CoreDefault,n.stop())}catch(e){n.success=!1,n.resultDescription=`Failed to apply delta, error: ${e}`,i.tG.info(539637594,i.nh.CoreDefault,n.stop())}}createWorkflowImplementation(e,t){const s=e.factory();return{workflow:e,workflowLambda:s,initPromise:this.initWorkflow(e.kind,s,t)}}initWorkflow(e,t,s){const n=new Bt({model:void 0,clientMetadata:s?s.getClientMetadata():void 0,userContext:s?s.getUserContext():void 0,site:this.site,getTokenCallback:this.getAuthTokenCallback});return e===Se.wC.SingleItem||e===Se.wC.Join?t.init(this.site,n):Promise.resolve()}queueWorkflow(e){var t,s;return null===(s=null===(t=this.executionTrackersByWorkflowNameBySession.get(e.session))||void 0===t?void 0:t.get(e.workflowInfo.workflow.id))||void 0===s||s.setExecutionState(e.scopeItem.contextId,Re.Running),this.executeLocalWorkflow(e.workflowInfo,e.scopeItem,e.inputItems,e.session,e.requestedContexts,e.triggerReason).then((t=>{this.processAnnotationResults(t,e.session),e.onCompleteCallback()})).catch((t=>{throw e.onCompleteCallback(),t}))}processAnnotationResults(e,t){for(const s of e)t.onAnnotationResults(s,rt.LocalWorkflow,(()=>{}))}executeLocalWorkflow(e,t,s,n,a,r){return new Promise(((c,l)=>{var u,p,g;const h=[],d=e.workflow,m=new o.I({operationName:"ExecuteWorkflow",resourceId:d.id,joinContextId:null!==(u=null==t?void 0:t.contextId)&&void 0!==u?u:"",resultDescription:null!=r?r:"",success:!0}).setClientMetadata(n.getClientMetadata());m.start();const y=null!==(p=null==t?void 0:t.contextId)&&void 0!==p?p:s[0].contextId,f=null!==(g=null==t?void 0:t.revId)&&void 0!==g?g:s[0].revId,C=(()=>{const e=new Map;if(t&&(t.parentPath||i.tG.error(525382231,i.nh.CoreDefault,`Missing scope item parent. Workflow: ${d.id}. Type: ${T.h.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(s))for(const t of s)t&&t.body&&(t.parentPath||i.tG.error(525382232,i.nh.CoreDefault,`Missing parent. Workflow: ${d.id}. Type: ${T.h.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),S=(e,t=m)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",i.tG.error(572838112,i.nh.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;i.tG.info(572838113,i.nh.CoreDefault,t.stop())},A=new Bt({model:new At(s[0],a),clientMetadata:n.getClientMetadata(),userContext:n.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback}),v=e=>{S(e?e.message:void 0),e?l(e):c(h)},I={setAnnotations:(a,r,c,u)=>{var p;const g=new o.I({operationName:"SetAnnotations",resourceId:r,joinContextId:null!==(p=null==t?void 0:t.contextId)&&void 0!==p?p:"",success:!0}).setClientMetadata(n.getClientMetadata());g.start();const m=t=>{i.tG.info(555866112,i.nh.CoreDefault,new Ct.v({annotationType:r,annotationState:t,workflowId:e.workflow.id}))};for(const e of c)e.metadata=Object.assign(Object.assign({},e.metadata),{state:yt.Created}),m(yt.Created);const A=C.get(a),v=T.h.getTypeNameFor(A.body),I=(()=>{var e;if(d.kind===Se.wC.SingleItem&&s[0].body!==a){const e=`Expected obj to be ${s[0].body} but instead it was ${a}`;return S(e,g),void l(S(e))}let t,o;if(Array.isArray(c))if(!d.outputTypes||d.outputTypes.indexOf(r)<0)t=`Workflow said it would output one of [${d.outputTypes}] but instead output ${r}`;else if(A)for(const e of c)T.h.matchesTypesFor(e,[pe.YH.getTypeName()])?T.h.getTypeNameFor(e)!==r&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${T.h.getTypeNameFor(e)} did not match expected ${r})`):t=`Workflow produced an output that is not an annotation ${T.h.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return S(t,g),void l(S(t));o=u&&u.isSessionAnnotation?["session"]:u&&u.ancestorType?A.parentPath:A.parentPath.concat(A.id);const p=[],h=[];for(const t of c){t.metadata=Object.assign(Object.assign({},t.metadata),{state:yt.Sent}),m(yt.Sent);const s=t.id,a=s?null===(e=n.getContextAnnotations(r,rt.LocalWorkflow,o,d.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==s})):void 0;1==(null==a?void 0:a.length)?1==a.length?h.push({id:a[0].id,source:d.id,revId:f,body:t,contextId:y}):i.tG.error(545837260,i.nh.CoreDefault,`Assert: Multiple existing context annotations with body id ${s} found for ${r} and local workflow ${d.id}).`):p.push({id:this.getNextClientAnnotationId(),source:d.id,revId:f,body:t,contextId:y})}const C=[];return p.length>0&&C.push(new le.Xr({parentPath:o,items:p,parentRevId:f})),h.length>0&&C.push(new le.fZ({parentPath:o,items:h,parentRevId:f})),new _.B_({annotationType:r,ops:C})})();I?(u&&u.immediate?n.onAnnotationResults(I,rt.LocalWorkflow,(()=>{})):h.push(I),(v==Tt.hD.getTypeName()||v==Tt.SB.getTypeName()||T.h.matchesTypesFor(A.body,[Tt.yo.getTypeName(),Tt.I3.getTypeName()]))&&n.submitOperationsToSession(I.ops),i.tG.info(509644822,i.nh.CoreDefault,g.stop())):i.tG.info(509644823,i.nh.CoreDefault,g.stop())},submitSignals:e=>{const t=new o.I({operationName:"submitSignalsAction",resourceId:d.id,success:!0}).setClientMetadata(n.getClientMetadata());for(const s of e){const e=T.h.getTypeNameFor(s);T.h.matchesTypesFor(s,[ft.HN.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${T.h.getTypeNameFor(s)})`,i.tG.info(521413954,i.nh.CoreDefault,t)),d.outputTypes&&-1!==d.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${d.outputTypes}] but instead output ${e}`,i.tG.info(521413953,i.nh.CoreDefault,t)),s.timestamp&&(Rt.logTimestampUsageByWorkflowId.has(d.id)||(Rt.logTimestampUsageByWorkflowId.add(d.id),t.resultDescription=`Workflow "${d.id}" sets signal.timeStamp`,i.tG.info(509212803,i.nh.CoreDefault,t)))}const s=e.map((e=>({id:this.getNextClientSignalId(),source:d.id,revId:f,body:e,contextId:y}))),a=new le.g0({parentPath:["session"],parentRevId:f,items:s});n.submitOperations([a])},done:v,overrideWorkflowDefinition:(e,s,o)=>{let a;switch(o){case _t.T.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw i.tG.error(527472289,i.nh.CoreDefault,e),new Error(e)}a=t.contextId;break;case _t.T.Session:a=void 0;break;default:{const e="Defined scope is not supported. "+o;throw i.tG.error(527472290,i.nh.CoreDefault,e),new Error(e)}}const r=new V.Qr({definition:s,contextId:a,sourceWorkflowId:d.id,targetWorkflowId:e});n.onWorkflowDefinitionOverrideMessage(r)},getDynamicAnnotations:void 0,setBillingDomain:void 0,sendClientRequest:void 0,sendClientRequestStreaming:void 0},w=e.workflowLambda;if(d.kind===Se.wC.SingleItem){1!==s.length&&v(new Error("Single item workflows expect a single input")),A.delta=s[0].delta,A.deltas=s[0].deltas;try{const t=w;e.initPromise||(e.initPromise=t.init(this.site,A)),e.initPromise.then((()=>{t.execute(s[0].body,A,I)})).catch((e=>{S(e)}))}catch(e){S(e)}}else if(d.kind===Se.wC.Join){0===s.length&&v(new Error("Join workflows expect an inputs array")),A.delta=t.delta,A.deltas=t.deltas;try{const n=w;e.initPromise||(e.initPromise=n.init(this.site,A)),e.initPromise.then((()=>{n.execute(t.body,s.map((e=>e.body)),A,I)})).catch((e=>{S(e)}))}catch(e){S(e)}}else S(`Workflow kind ${d.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,s){var n,a;const r=Date.now(),c={session:e,workflowImplementation:t,scopeItem:s,startTime:r,minTime:r+(0,k.ZF)(t.workflow.minDelayMs,1e3),maxTime:r+(0,k.ZF)(t.workflow.maxDelayMs,5e3)},l=t.workflow.kind===Se.wC.Join?s.contextId:c.scopeItem.parentPath.concat(s.id).join("\\");this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map);if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(l)){const n=new o.I({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${l}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(a=null==s?void 0:s.contextId)&&void 0!==a?a:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();i.tG.info(509727899,i.nh.CoreDefault,n.stop())}else{const a=new o.I({resultDescription:`New pending scope execution for ${t.workflow.id} at ${l}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(n=null==s?void 0:s.contextId)&&void 0!==n?n:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();i.tG.info(539883075,i.nh.CoreDefault,a.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(l,c)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const s=new Set(Array.from(this.sweepTimers.keys()));for(const[n,a]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[r,c]of Array.from(a.entries())){const{session:a,workflowImplementation:{workflow:l}}=c,u=a.getWorkflowItemStorage(),p=new o.I({operationName:"LocalScopeExecutionNotification",resourceId:l.id,joinContextId:null!==(t=null===(e=c.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(a.getClientMetadata()).start(),g=()=>{var e;if(l.kind===Se.wC.Join){const t=Date.now(),{workflow:s}=c.workflowImplementation,n=c.scopeItem.contextId,o=a.getWorkflowDefinition(s,n).maxDelayMs;return u.isWorkflowReady(n,s)?(p.resultDescription=`Join Workflow: ${s.id} queuing by maxAnnotation, contextId: ${n}`,i.tG.info(528048978,i.nh.CoreDefault,p.stop()),{isValid:!0,triggerReason:Pt.JoinMaxAnnnotation}):c.startTime+o<t?(p.resultDescription=`Join Workflow: ${s.id} queuing by maxTimeout, contextId: ${n}`,i.tG.info(528048979,i.nh.CoreDefault,p.stop()),{isValid:!0,triggerReason:Pt.JoinMaxTimeout}):this.isReadyToEarlyJoin(null===(e=this.executionTrackersByWorkflowNameBySession.get(a))||void 0===e?void 0:e.get(s.id),n,a.getClientMetadata())?(i.tG.info(512550856,i.nh.CoreDefault,`Workflow: ${s.id} queuing by early completion, contextId: ${n}, timeout: ${o}`),{isValid:!0,triggerReason:Pt.JoinEarlyCompletion}):{isValid:!1,triggerReason:Pt.Unknown}}return{isValid:!0,triggerReason:Pt.Unknown}};(()=>{const{isValid:e,triggerReason:t}=g();if(!e)return!1;const[s,n]=a.resolveRequestedContexts(l);if(!s)return!1;try{if(l.kind===Se.wC.Join){const e=c.scopeItem.contextId,s=u.getScopeItem(e,l);if(s){const o=u.getItemsToExecute(s.contextId,l);if(0===o.length)return p.resultDescription=`Failed to retrieve items for workflow: ${l.id}, contextId: ${e}, skipping execution`,i.tG.info(527472291,i.nh.CoreDefault,p.stop()),this.onWorkflowExecuted(s,l,a),!0;this.queueWorkflow({workflowInfo:c.workflowImplementation,scopeItem:s,inputItems:o,requestedContexts:n,session:a,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,s,l,a)}).catch((e=>{p.success=!1,p.resultDescription=e.message,i.tG.error(509092189,i.nh.CoreDefault,p.stop())}))}else p.resultDescription="ContextId no longer exists, skipping workflow execution",i.tG.info(539883076,i.nh.CoreDefault,p.stop())}else p.resultDescription=`Workflow in type ${l.kind} is not supported`,i.tG.error(539883077,i.nh.CoreDefault,p.stop())}catch(e){p.resultDescription=`Trying to execute ${l.id} caused an exception: ${e}`,i.tG.warn(539883078,i.nh.CoreDefault,p.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(n).delete(r),0===this.pendingScopeExecutionNotificationsByWorkflow.get(n).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(n)):s.delete(a)}if(0!==s.size)for(const e of Array.from(s)){const t=new o.I({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();i.tG.debug(539883079,i.nh.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,s){const n={id:"",parentPath:[],contextId:e},o={id:t};this.onWorkflowExecuted(n,o,s,!1)}onWorkflowExecuted(e,t,s,n=!0){var o,i;null===(i=null===(o=this.executionTrackersByWorkflowNameBySession.get(s))||void 0===o?void 0:o.get(t.id))||void 0===i||i.afterWorkflowExecution(e.contextId),n&&t.kind===Se.wC.Join&&s.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}class Ot{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,s)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=Ot.Rejected,void s(t)}this.prevSeq=-1}e!=this.prevSeq+1&&i.tG.warn(542712385,i.nh.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const n={seq:e,resolve:t};this.insertItem(n),this.runInOrder(n,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,s=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(s?(s.prev=e,e.next=s):this.lastQueueItem=e);s=t,t=t.prev}while(t);s&&(s.prev=e),e.next=s,this.firstQueueItem=e}runInOrder(e,t,s){let n=this.prevSeq,o=!1;const i=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(n+1!=t.seq&&(!s||t.seq>e.seq))break;n=t.seq,t.timeout&&clearTimeout(t.timeout),i.push(t),e==t&&(o=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}i.length>0&&setTimeout((()=>{for(const e of i)e.resolve(e.seq)}),0),this.prevSeq=n,!o&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}Ot.Rejected="SequenceItemRejected";class xt{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new Ot(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}var Ft=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};class Gt{constructor(e=500,t){this.sequencerFactory=null!=t?t:new xt(e)}sequence(e){var t;return Ft(this,void 0,void 0,(function*(){const s=null===(t=null==e?void 0:e.M_)||void 0===t?void 0:t.seq;if(null==s)return;const n=this.sequencerFactory.create(e);n&&(yield n.sequence(e.M_.seq))}))}}class Wt{constructor(e){this.annotationSequencer=null!=e?e:new Gt}process(e,t,s,n){const o=[];for(const n of e.ops){const i=[];if(null==n?void 0:n.items)for(const e of n.items){const s=this.annotationSequencer.sequence(e.body).then((()=>{t(n,e)}));i.push(s)}o.push(Promise.all(i).then((()=>{s(n,e.cv)})))}Promise.all(o).then((()=>n(e)))}}class Ht{process(e,t,s,n){for(const n of e.ops){if(null==n?void 0:n.items)for(const e of n.items)t(n,e);s(n,e.cv)}n(e)}}class Ut{constructor(e,t,s){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new Wt,this.unorderedAnnotationResultsProcessor=null!=s?s:new Ht}process(e,t,s,n){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,s,n):this.unorderedAnnotationResultsProcessor.process(e,t,s,n)}}var qt=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};class Vt{constructor(e,t){this.changeGatesInitialized=!1,this.hostCallbacks=e,this.changeGateMap=t||new Map}init(){return qt(this,void 0,void 0,(function*(){const e=[];this.hostCallbacks&&this.hostCallbacks.isChangeGateEnabled&&this.changeGateMap.forEach(((t,s)=>{e.push(this.hostCallbacks.isChangeGateEnabled(s).then((e=>{this.changeGateMap.set(s,e)})))})),yield Promise.all(e).then((()=>{this.changeGatesInitialized=!0})).catch((e=>{}))}))}isFeatureEnabled(e,t=!1,s="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled(e,s).catch((()=>Promise.resolve(t))):Promise.resolve(t)}isChangeGateEnabled(e){var t;return qt(this,void 0,void 0,(function*(){return!this.changeGateMap||(this.changeGatesInitialized&&this.changeGateMap.has(e)?this.changeGateMap.get(e):!(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled))||(yield this.hostCallbacks.isChangeGateEnabled(e)))}))}isChangeGateEnabledSync(e){var t;if(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled)){const t=new o.I({operationName:"GateUtilsNotInitialized",success:!1,resultDescription:`${e}`});i.tG.error(505529628,i.nh.CoreDefault,t)}return!this.changeGateMap||(!this.changeGatesInitialized||!this.changeGateMap.has(e)||this.changeGateMap.get(e))}isChangeGatesInitialized(){return this.changeGatesInitialized}getChangeGateMap(){return this.changeGateMap}}var $t=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};const jt="CloseSessionsOnRuntimeUninit",zt="ShouldAppendClientFeatureFlights",Kt="DontSendNewTokenOnReconnect",Qt="WebSocketWorkerShouldLogEgressCount",Jt="FixIncorrectInvocationOfClaimsCallbacks",Yt=()=>s(49279).r;class Zt{constructor(e,t,s,n){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.telemetryLogger=null,this.changeGateList=new Map([["SkipCheckingCachedClaimsChallenge",!0],[jt,!0],[zt,!0],[Kt,!0],[Qt,!0],[Jt,!0]]),this.settings={annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,reduceBatchOperationsEnabled:!1,batchMessagesEnabled:!1,removeDuplicateFlights:!0,annotationDoesNotExistOnService:!0,reducedPingPongRetryEnabled:!1,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:!1,sendTokenFailureMessage:!0,closeSessionsOnRuntimeUninit:!1,shouldAppendClientFeatureFlights:!0,authTokenTimeoutMs:0,doNotSendNewTokenOnReconnect:!1,webSocketWorkerShouldLogEgressCount:!0,createBlobStorageContainerEnabled:!1},this.settingToChangeGateName={closeSessionsOnRuntimeUninit:jt,shouldAppendClientFeatureFlights:zt,doNotSendNewTokenOnReconnect:Kt,webSocketWorkerShouldLogEgressCount:Qt},this.isDownloaderCompatible=()=>"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL,n&&(this.settings=n),this.workerFactory=e||(e=>e&&e===oe.HttpFallback?new Y:new p(void 0,this.settings));const o=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||o(...e),this.sessionFactory=s||(e=>new ut(e))}init(e,t,s,r){var c,l,u,p,g,h,d,m,y,T;const f=new o.I({operationName:"InitRuntime",resourceId:(0,a.k$)(e),dimension1:this.hasBeenInitialized.toString()});f.start(),this.hasBeenInitialized=!0,this.hostCallbacks=s,this.gateUtils=new Vt(this.hostCallbacks,this.changeGateList),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=Yt()),this.telemetryLogger=new a.MP(this.hostCallbacks),this.shouldAddLogger(f)?(i.tG.addLogger(this.telemetryLogger),this.addLoggingAggregator(r)):(i.tG.clearLoggers(),i.tG.addLogger(this.telemetryLogger)),Zt.haveCalledInit=!0,this.annotationResultsProcessor=new Ut((()=>this.settings.annotationsOrderingEnabled)),this.inferenceServiceFactory=r.inferenceServiceFactory,f.dimension2=(0,i.OD)(n.q.info).toString();const _=[];e&&(this.defaultServiceUrl=k.Aq.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),_.push(this.gateUtils.init().then((()=>$t(this,void 0,void 0,(function*(){yield Promise.all(Object.keys(this.settingToChangeGateName).map((e=>$t(this,void 0,void 0,(function*(){try{const t=yield this.gateUtils.isChangeGateEnabled(this.settingToChangeGateName[e]);this.settings[e]=t}catch(t){this.settings[e]=!1}})))))}))))),_.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then((e=>{this.settings.annotationsOrderingEnabled=e}))),_.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),_.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)}))),_.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then((e=>{var t;(t=this.settings).onAnnotationsSubmittedEnabled&&(t.onAnnotationsSubmittedEnabled=!e)}))),_.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then((e=>{var t;(t=this.settings).reduceBatchOperationsEnabled||(t.reduceBatchOperationsEnabled=e)}))),_.push(this.isFeatureEnabled("BatchMessagesEnabled").then((e=>{var t;(t=this.settings).batchMessagesEnabled||(t.batchMessagesEnabled=e)}))),_.push(k.Aq.isChangeGateEnabled(this.hostCallbacks,"AnnotationDoesNotExistOnService").then((e=>{this.settings.annotationDoesNotExistOnService=e}))),_.push(k.Aq.isFeatureEnabled(this.hostCallbacks,"ReducedPingPongRetryEnabled").then((e=>{var t;(t=this.settings).reducedPingPongRetryEnabled||(t.reducedPingPongRetryEnabled=e)}))),_.push(this.isFeatureEnabled("MaxNumberOfDeltaUpdateOpsPerItemPerBatch").then((e=>{var t;(t=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(t.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e)}))),_.push(k.Aq.isChangeGateEnabled(this.hostCallbacks,"SendTokenFailureMessage").then((e=>{this.settings.sendTokenFailureMessage=e}))),_.push(this.isFeatureEnabled("CreateBlobStorageContainerEnabled").then((e=>{var t;(t=this.settings).createBlobStorageContainerEnabled||(t.createBlobStorageContainerEnabled=e)})));const C={enableDeltas:!1,enableEarlyJoin:!1};_.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then((e=>C.enableDeltas=e)).catch((()=>C.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>C.enableEarlyJoin=e)).catch((()=>C.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new Rt(r.modelDownloader&&this.isDownloaderCompatible()?r.modelDownloader:void 0,this.inferenceServiceFactory,C)})));const S=Mt(null!==(c=t.flights)&&void 0!==c?c:"");return this.isDeltaGeneratorEnabled=S.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(l=r.isDeltaGeneratorEnabled)&&void 0!==l&&l),this.disableSyncDeltaSending=S.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(u=r.disableSyncDeltaSending)&&void 0!==u&&u),this.syncDeltaTimeout=S.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",r.syncDeltaTimeout),(p=this.settings).defaultBatchingEnabled&&(p.defaultBatchingEnabled=!S.getBooleanValue("DefaultBatchingDisabled",!1)),(g=this.settings).batchingWith20msIntervalEnabled&&(g.batchingWith20msIntervalEnabled=!S.getBooleanValue("BatchingWith20msIntervalDisabled",!1)),(h=this.settings).reduceBatchOperationsEnabled||(h.reduceBatchOperationsEnabled=S.getBooleanValue("ReduceBatchOperationsEnabled",!1)),(d=this.settings).batchMessagesEnabled||(d.batchMessagesEnabled=S.getBooleanValue("BatchMessagesEnabled",!1)),(m=this.settings).removeDuplicateFlights&&(m.removeDuplicateFlights=S.getBooleanValue("RemoveDuplicateFlights",!0)),(y=this.settings).reducedPingPongRetryEnabled||(y.reducedPingPongRetryEnabled=S.getBooleanValue("ReducedPingPongRetryEnabled",!1)),(T=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(T.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=S.getBooleanValue("maxNumberOfDeltaUpdateOpsPerItemPerBatch",!1)),this.settings.authTokenTimeoutMs=S.getIntValue("AuthTokenTimeoutMs",0),f.setDataField("Flights",JSON.stringify(this.settings)),r&&r.loggableUrls&&(0,a.sI)(r.loggableUrls),Promise.all(_).then((()=>{this.batchOptions=r.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6,delayMsMax:50},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),this.batchOptions&&!this.batchOptions.delayMsMax&&(this.batchOptions.delayMsMax=50),r&&r.networkMode&&(this.networkMode=r.networkMode,r.networkMode===oe.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new nt)),f.dimension0=JSON.stringify(this.batchOptions),this.logOperation(f,!0)})).catch((e=>{this.logOperation(f,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){i.tG.flushAggregators(e)}createSession(e){var t;const s=e&&e.docSessionId?e.docSessionId:(0,et.v4)(),n=e&&e.documentId?e.documentId:void 0,i=this.sessionsByDocSessionId.get(s),a=new o.I({operationName:"CreateSession",resourceId:s,dimension1:this.hasBeenInitialized.toString()});if(a.start(),i&&!1===i.isClosed)throw this.logOperation(a,!1,"Error","docSessionId already exists"),new Error("docSessionId already exists");let r=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;r=k.Aq.convertServiceUrlToWebSocket(r),r||((e=e||{}).networkMode=oe.LocalWorkflowsOnly),!this.networkMode||void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)||((e=e||{}).networkMode=this.networkMode),void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)&&(null==e?void 0:e.networkMode)!==oe.JSWebSockets||!this.hasHttpFallbackSession()||((e=e||{}).networkMode=oe.HttpFallback);const c=Object.assign({},this.clientMetadata);if(c.docSessionId=s,n&&(c.documentId=n),e&&e.tid3pHost&&(c.tid3pHost=e.tid3pHost),e&&e.flights&&(c.flights=c.flights?c.flights+";"+e.flights:e.flights),this.settings.shouldAppendClientFeatureFlights){const e=["_acceptsClaimsChallengeMessages","_acceptsSeedingStatusChangeMessages"].join(";");c.flights=c.flights?`${c.flights};${e}`:e}this.settings.removeDuplicateFlights&&c.flights&&(c.flights=function(e){if(!e)return"";const t=new Set,s=[];for(const n of e.split(";").reverse()){const e=n.split(":")[0],o=Lt.normalizeName(e);t.has(o)||(t.add(o),s.push(n))}return s.reverse().join(";")}(c.flights)),a.setDataField("Flights",c.flights||"");const l=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(c,r,e),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:c,userContext:e?e.userContext:void 0,localWorkflowManager:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:null==e?void 0:e.networkMode,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled,batchMessagesEnabled:this.settings.batchMessagesEnabled,annotationDoesNotExistOnServiceEnabled:this.settings.annotationDoesNotExistOnService,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:this.settings.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled,gateUtils:this.gateUtils});return this.sessionsByDocSessionId.set(s,l),e&&(e.onSessionConnect&&l.setConnectCallback(e.onSessionConnect),e.onSessionDisconnect&&l.setDisconnectCallback(e.onSessionDisconnect),e.onSessionReconnect&&l.setReconnectCallback(e.onSessionReconnect),e.onSessionClose&&l.setSessionCloseCallback(e.onSessionClose),e.onServerAuthenticationStateChangeCallback&&l.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),e.onClaimsChallengeCallback&&l.setClaimsChallengeCallback(e.onClaimsChallengeCallback),e.onSeedingStatusChangeCallback&&l.setSeedingStatusChangeCallback(e.onSeedingStatusChangeCallback)),this.logOperation(a,!0),l.initialize?l.initialize():Promise.resolve(l)}getSession(e){return this.sessionsByDocSessionId.get(e)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(Zt.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=(0,i.OD)(n.q.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,s)=>{if(s&&s.networkMode==oe.LocalWorkflowsOnly)return new nt;const n=new ht,o=new pt;let a=()=>{i.tG.error(573321615,i.nh.CoreDefault,"Unexpectedly not set sendMessage")};const r=new mt((()=>o),e,n,((e,t,s)=>{a(e,t,s)}),{requestAuthToken:this.hostCallbacks.requestAuthToken,overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==s?void 0:s.enableRemoteExecutionNotification)||!1,sendTokenFailureMessageChangeGate:this.settings.sendTokenFailureMessage,authTokenTimeoutMs:this.settings.authTokenTimeoutMs,dontSendTokenOnReconnectChangeGate:this.settings.doNotSendNewTokenOnReconnect,createBlobStorageContainerEnabled:this.settings.createBlobStorageContainerEnabled}),c=new re(k.Aq.convertServiceUrlToWebSocket(t),o,this.workerFactory,r,e,n,this.settings,this.gateUtils,null==s?void 0:s.networkMode);return a=c.sendMessage.bind(c),c.on("disconnect",(()=>n.clearRefreshTimeouts())),c.on("connect",((e,t,s,n)=>{e&&this.hostCallbacks.setSessionData&&this.hostCallbacks.setSessionData(t,s,n);const o=t.substring(t.lastIndexOf("/")+1);this.telemetryLogger.setServerSessionKey(o)})),c}}isFeatureEnabled(e,t=!1,s="None"){return k.Aq.isFeatureEnabled(this.hostCallbacks,e,t,s)}hasHttpFallbackSession(){let e=!1;return this.sessionsByDocSessionId.forEach((t=>{t.isHttpFallback()&&(e=!0)})),e}logOperation(e,t,s,n){e.stop(),e.success=t,e.resultSignature=s,e.resultDescription=n,i.tG.info(573321622,i.nh.CoreDefault,e)}addLoggingAggregator(e){var t,s,n,o;"Dogfood"!==this.clientMetadata.releaseAudienceGroup&&"Automation"!==this.clientMetadata.releaseAudienceGroup&&(i.tG.addAggregator((0,a.cS)("Operation","operationName",["ExecuteBatch","ReduceBatchOperations","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","NetworkEgressControl","HttpEgress","LongPollNoOp","NetworkRateControllerAbandonedSyncMessage","NetworkRateControllerEgress","NetworkRateControllerQueueItem","NetworkRateControllerOnRateLimitResponse","NetworkRateControllerOnRateLimitError","NetworkRateControllerRateLimitsSet"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),i.tG.addAggregator((0,a.cS)("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","EarlyJoinCompletion","OnLongPollMessage","OnAnnotationResultsEgress"],null!==(s=e.telemetryAggregationIntervalSec)&&void 0!==s?s:60)),i.tG.addAggregator((0,a.cS)("Operation","operationName",["LocalScopeExecutionNotification","RunLocalWorkflows","EarlyJoinCompletion","SetAnnotations","WIS.addItemOnContextIdList","WIS.setScopeItem"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:120)),i.tG.addAggregator((0,a.cS)("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(o=e.telemetryAggregationIntervalSec)&&void 0!==o?o:60)))}uninitialize(){this.settings.closeSessionsOnRuntimeUninit&&(this.sessionsByDocSessionId.forEach((e=>{e.close()})),this.sessionsByDocSessionId.clear()),this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,this.telemetryLogger=null,Zt.haveCalledInit=!1,i.tG.clearAggregators(),i.tG.clearLoggers()}}const Xt=new Zt,es=()=>new Zt},726897:(e,t,s)=>{var n,o,i;s.d(t,{PH:()=>i}),function(e){e.Success="Success",e.FetchingError="fetchingError",e.NotImplementedExcelFunction="notImplementedExcelFunction",e.CalcError="calcError",e.NotHybrid="notHybrid",e.NotSupported="notSupported",e.IncompleteDataError="incompleteDataError",e.ScratchpadError="scratchpadError",e.IntentionallyWithheld="intentionallyWithheld"}(n||(n={})),function(e){e[e.Insertion=0]="Insertion",e[e.FromColumn=1]="FromColumn"}(o||(o={})),function(e){e[e.OverrideSelection=0]="OverrideSelection",e[e.ToTableWithoutOverride=1]="ToTableWithoutOverride",e[e.OverrideFixedRange=2]="OverrideFixedRange",e[e.ToTableWithOverride=3]="ToTableWithOverride",e[e.ShiftRight=4]="ShiftRight",e[e.ShiftDown=5]="ShiftDown",e[e.InsertIntoEmptyCells=6]="InsertIntoEmptyCells"}(i||(i={}))},729816:(e,t,s)=>{var n;s.d(t,{B:()=>n}),function(e){e.OPENED="opened",e.CLOSED="closed",e.LOADING="loading",e.LOADED="loaded",e.UNKNOWN="unknown"}(n||(n={}))},735875:(e,t,s)=>{s.d(t,{Cg:()=>i,qf:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Text_CommentTile"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()}},738460:(e,t,s)=>{s.d(t,{MP:()=>u,cS:()=>r,k$:()=>l,sI:()=>c});var n=s(976941),o=s(886556),i=s(257612);const a=["cloud.dev.microsoft","officeppe.com","cloud.microsoft","office.com","office365.us","ic.gov","microsoft.scloud","microsoftonline.cn"],r=(e,t,s,n)=>new i.D(e,(e=>e.success&&s.indexOf(e[t])>=0),[t,"ariaNamespace","resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],n),c=e=>{a.push(...e)},l=e=>{if(!e)return e;for(const t of a)if(e.indexOf(t)>=0)return e;return"**redacted**"};class u{constructor(e){this.level=n.q.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,s,n,i)=>{let a=t.charAt(0).toUpperCase()+t.slice(1),r={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId,ServerSessionKey:this.serverSessionKey};s&&(r=Object.assign(Object.assign({},r),JSON.parse(s)));const c=n||u.augLoopAriaTenantToken,l=i||c!=u.augLoopAriaTenantToken?i:u.augLoopAriaNamespace;a=a||u.operationNamePlaceholder;const p={CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success};this.hostCallbacks.sendTelemetryEvent(c,l?`${l}_${a}`:a,r,"Office.System.Activity",p,!1,o.b.ProductServiceUsage|o.b.ProductServicePerformance,o.E.RequiredServiceDataEvent)},s=(e,t,s)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,s)};if("Workflow.MetricsOnly"==e.category);else if("Operation"===e.eventName){const s=e;t(s,s.operationName,s.dataFields,void 0,s.ariaNamespace)}else if("SessionHealth"===e.eventName){t(e,e.sessionHealthEventName)}else if("WorkflowOperation"===e.eventName){const s=e;t(s,s.operationName,s.dataFields,s.ariaTenant,s.ariaNamespace)}else"Log"===e.eventName&&s(e.tagId,e.traceLevel,e.message)}setServerSessionKey(e){this.serverSessionKey=e}}u.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",u.augLoopAriaNamespace="Office_AugLoop_Client",u.operationNamePlaceholder="OperationNameNotProvided"},742315:(e,t,s)=>{var n=s(758651);Object.defineProperty(t,"__esModule",{value:!0}),t.buildEmscriptenCustomContextFromSite=t.buildEmscriptenCustomContext=void 0;const o=s(901039);function i(e,t){function s(e,t,s,n){const o=function(e,t,s){const n=new Headers,o=s.keys();for(let e=0;e<o.size();e++){const t=o.get(e);n.append(t,s.get(t))}const i={};return i.method=e,void 0!==t&&(i.body=t),o.size()>0&&(i.headers=n),o.delete(),i}(t,s,n);let i=0;return fetch(e,o).then((e=>{if(i=e.status,!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e.arrayBuffer()})).then((e=>({bufferArray:new Uint8Array(e),length:e.byteLength,isError:!1,statusCode:i}))).catch((e=>{const t=e;return t.isError=!0,t.statusCode=i,t}))}function i(e,t,s){if(e||t&&0!==t.length){if(e){const t=e;return t.isError=!0,t}return{token:t,ttl:s?s.timeToLiveSec:void 0}}return{name:"Missing Token",message:"Unable to fetch token",isError:!0}}function a(e){if(!e)return;const t=new Map,s=e.keys();for(let n=0;n<s.size();n++){const o=s.get(n);t.set(o,e.get(o))}return t}function r(e,t){return new Promise((async(s,n)=>{try{if(!e.run)throw new Error("WorkflowSite is unimplemented.");const n=await e.run(t);if(!n)throw new Error("Outputs returned as undefined.");s(n)}catch(e){const t=e;t.isError=!0,s(t)}}))}function c(e,t,s){if(!e||!e.run){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void s(e)}const n=s.clone();e.run(t).then((e=>{if(!e)throw new Error("Outputs returned as undefined.");n.opcall(e)})).catch((e=>{const t=e;t.isError=!0,n.opcall(t)})).finally((()=>{n.delete()}))}const l={createModel:function(t){return new Promise((async(s,n)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const n=await e.site.createModel(t);n.customRun=r.bind(null,n),n.customRunInCallback=c.bind(null,n),s(n)}catch(e){const t=e;t.isError=!0,s(t)}}))},createModelInCallback:function(t,s){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void s(e)}const n=s.clone();e.site.createModel(t).then((e=>{e.customRun=r.bind(null,e),e.customRunInCallback=c.bind(null,e),n.opcall(e)})).catch((e=>{const t=e;t.isError=!0,n.opcall(t)})).finally((()=>{n.delete()}))},createModelInputs:function(){return new Promise((async(t,s)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");t(await e.site.createModelInputs())}catch(e){const s=e;s.isError=!0,t(s)}}))},createModelInputsInCallback:function(t){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void t(e)}const s=t.clone();e.site.createModelInputs().then((e=>{s.opcall(e)})).catch((e=>{const t=e;t.isError=!0,s.opcall(t)})).finally((()=>{s.delete()}))}},u={};return u.docSessionId=e.clientMetadata.docSessionId,u.getToken=function(t){return new Promise(((s,n)=>{e.getToken(t,((e,t,n)=>{if(e||t&&0!==t.length)if(e){const t=e;t.isError=!0,s(t)}else s(t);else s({name:"Missing Token",message:"Unable to fetch token",isError:!0})}))}))},u.getTokenWithPropertiesAsync=function(t){return new Promise(((s,n)=>{e.getToken(t,((e,t,n)=>{const o=i(e,t,n);s(o)}))}))},u.getTokenWithPropertiesInCallback=function(t,s){const n=s.clone();e.getToken(t,((e,t,s)=>{const o=i(e,t,s);n.opcall(o),n.delete()}))},u.getResourceAsUrlInCallback=function(t,s,n,o){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void o(e)}const i=o.clone();e.site.getResourceAsURL(t,s,a(n)).then((e=>{const t=Object.entries(e),s=new Map(t);i.opcall(s)})).catch((e=>{const t=e;t.isError=!0,i.opcall(t)})).finally((()=>{i.delete()}))},u.httpRequest=s,u.httpRequestInCallback=function(e,t,n,o,i){const a=i.clone();s(e,t,n,o).then((e=>{a.opcall(e)})).catch((e=>{})).finally((()=>{a.delete()}))},u.copyUint8ArrayToWasmMemory=function(e,s){t().HEAPU8.set(e,s)},u.copyUint16ArrayToWasmMemory=function(e,s){t().HEAPU16.set(e,s>>1)},u.copyUint32ArrayToWasmMemory=function(e,s){t().HEAPU32.set(e,s>>2)},u.copyInt8ArrayToWasmMemory=function(e,s){t().HEAP8.set(e,s)},u.copyInt16ArrayToWasmMemory=function(e,s){t().HEAP16.set(e,s>>1)},u.copyInt32ArrayToWasmMemory=function(e,s){t().HEAP32.set(e,s>>2)},u.copyFloat32ArrayToWasmMemory=function(e,s){t().HEAPF32.set(e,s>>2)},u.copyFloat64ArrayToWasmMemory=function(e,s){t().HEAPF64.set(e,s>>3)},u.getResourceAsUrl=function(t,s,n){return new Promise((async(o,i)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const i=await e.site.getResourceAsURL(t,s,a(n)),r=Object.entries(i);o(new Map(r))}catch(e){const t=e;t.isError=!0,o(t)}}))},u.getResourceAsByteArray=function(t,s,o){return new Promise((async(i,r)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const r=await e.site.getResourceAsArrayBuffer(t,s,a(o)),c=new Map;for(const[e,t]of Object.entries(r)){n.log(e,t);const s=new Uint8Array(t),o={};o.bufferArray=s,o.length=t.byteLength,c.set(e,o)}i(c)}catch(e){const t=e;t.isError=!0,i(t)}}))},u.site=l,u.context=e,u.logOperationClass=o.Operation,u.logInfoFunction=o.Log.info.bind(null,0,o.LogCategory.WorkflowDefault),u.dummyPromise=Promise.resolve("Success"),u.logDebugTrace=function(e,t){o.Log.debug(e,o.LogCategory.WorkflowDefault,t)},u.logInfoTrace=function(e,t){o.Log.info(e,o.LogCategory.WorkflowDefault,t)},u.logWarnTrace=function(e,t){o.Log.warn(e,o.LogCategory.WorkflowDefault,t)},u.logErrorTrace=function(e,t){o.Log.error(e,o.LogCategory.WorkflowDefault,t)},u.getUserContext=function(){if(!e.userContext)return;const t={UserContextObject:e.userContext};return JSON.stringify(t)},u}t.buildEmscriptenCustomContext=i,t.buildEmscriptenCustomContextFromSite=function(e,t){return i({clientMetadata:void 0,getToken:function(e,t){throw new Error("GetToken not available in init.")},getTokenAsync:async function(){throw new Error("GetTokenAsync not available in init.")},site:e},t)}},745032:function(e,t,s){var n=this&&this.__createBinding||(Object.create?function(e,t,s,n){void 0===n&&(n=s);var o=Object.getOwnPropertyDescriptor(t,s);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,n,o)}:function(e,t,s,n){void 0===n&&(n=s),e[n]=t[s]}),o=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||n(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.SessionHealthSource=t.SessionHealthReason=t.SessionHealthImpact=t.SessionHealthEvent=void 0,o(s(375746),t),o(s(518645),t),o(s(760640),t),o(s(150104),t),o(s(601317),t),o(s(243508),t);var i=s(99449);Object.defineProperty(t,"SessionHealthEvent",{enumerable:!0,get:function(){return i.SessionHealth}}),Object.defineProperty(t,"SessionHealthImpact",{enumerable:!0,get:function(){return i.SessionHealthImpact}}),Object.defineProperty(t,"SessionHealthReason",{enumerable:!0,get:function(){return i.SessionHealthReason}}),Object.defineProperty(t,"SessionHealthSource",{enumerable:!0,get:function(){return i.SessionHealthSource}})},747735:(e,t)=>{var s,n,o,i,a,r,c,l,u,p,g,h,d,m,y,T,f,_,C,S,A,v,I,w,N,E,b,k,M,L,B,D,P,R,O,x,F,G,W,H,U,q,V,$,j,z;t.n3=t.nC=void 0,function(e){e[e.Read=0]="Read",e[e.ReadMetadata=1]="ReadMetadata",e[e.Create=2]="Create"}(s||(s={})),function(e){e.PowerPoint="PowerPoint",e.Excel="Excel",e.Word="Word",e.OneNote="OneNote",e.Outlook="Outlook",e.Teams="Teams",e.Event="Event",e.Meeting="Meeting",e.TeamsMeeting="TeamsMeeting",e.TeamsQueues="TeamsQueues",e.SharePoint="SharePoint",e.Web="Web",e.PDF="PDF",e.Zip="Zip",e.HTML="HTML",e.Visio="Visio",e.Image="Image",e.Fluid="Fluid",e.Video="Video",e.Vector="Vector",e.Txt="Txt",e.ThirdParty="ThirdParty",e.Topic="Topic",e.Loop="Loop",e.Planner="Planner"}(n||(n={})),function(e){e[e.ChatResponse=0]="ChatResponse",e[e.GetMessagesResponse=1]="GetMessagesResponse",e[e.GetConversationResponse=2]="GetConversationResponse",e[e.GetSharedMessagesResponse=3]="GetSharedMessagesResponse",e[e.CopyConversationResponse=4]="CopyConversationResponse",e[e.SerpCachedResponse=5]="SerpCachedResponse",e[e.CaptchaResponse=6]="CaptchaResponse"}(o||(o={})),function(e){e.Default="Default",e.Early="Early",e.OnUse="OnUse",e.Never="Never"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Allow=1]="Allow",e[e.AlwaysAllow=2]="AlwaysAllow",e[e.Deny=3]="Deny"}(a||(a={})),function(e){e.Quiet="0",e.Verbose="1"}(r||(r={})),function(e){e.TurnBased="turnbased",e.Realtime="realtime",e.All="all"}(c||(c={})),function(e){e.Full="Full",e.Concise="Concise",e.ConciseWithPadding="ConciseWithPadding"}(l||(l={})),function(e){e.Text="text",e.Video="video",e.Voice="voice"}(u||(u={})),function(e){e.Unknown="Unknown",e.TeamsToolKit="TeamsToolKit",e.CopilotStudioFamily="CopilotStudioFamily",e.SharePoint="SharePoint",e.CopilotStudio="CopilotStudio",e.EmbeddedCopilotStudio="EmbeddedCopilotStudio",e.Notebook="Notebook"}(p||(p={})),function(e){e.WordDraftingAgent="WordDraftingAgent"}(g||(g={})),function(e){e.SharePoint="SharePoint",e.OneDrive="OneDrive",e.OneDriveAndSharePoint="OneDriveAndSharePoint",e.DeepResearch="DeepResearch",e.DeepResearchWork="DeepResearchWork",e.RegisteredPlugins="RegisteredPlugins",e.FirstPartyAgent="FirstPartyAgent",e.WebSearch="WebSearch",e.EnterpriseGrounding="EnterpriseGrounding"}(h||(h={})),function(e){e.Unknown="Unknown",e.Success="Success",e.InternalError="InternalError",e.InvalidSession="InvalidSession",e.ConfigurationError="ConfigurationError",e.InvalidRequest="InvalidRequest",e.ProcessingMessage="ProcessingMessage",e.UnauthorizedRequest="UnauthorizedRequest",e.UnexpectedError="UnexpectedError",e.Canceled="Canceled",e.CaptchaChallenge="CaptchaChallenge",e.Throttled="Throttled",e.NotFound="NotFound",e.NoResponseReturned="NoResponseReturned",e.ThrottledByLLM="ThrottledByLLM",e.NoResponseText="NoResponseText",e.ApologyResponseReturned="ApologyResponseReturned",e.NoValidMessageTypePresentInBotResponse="NoValidMessageTypePresentInBotResponse",e.ServiceNotEnabled="ServiceNotEnabled",e.ContentForbidden="ContentForbidden",e.ContentNotFound="ContentNotFound",e.InvalidLicense="InvalidLicense",e.NotEnoughContext="NotEnoughContext",e.OutOfCredits="OutOfCredits",e.VoiceSystemSignal="VoiceSystemSignal"}(d||(d={})),function(e){e.Success="Success",e.Failure="Failure",e.Pending="Pending",e.BotTurnStarting="BotTurnStarting"}(m||(m={})),function(e){e.Audio="audio",e.Text="text"}(y||(y={})),function(e){e.SearchWeb="SearchWeb",e.EnterpriseFileSearch="EnterpriseFileSearch",e.CodeInterpreter="CodeInterpreter"}(T||(T={})),function(e){e.Error="Error",e.Warning="Warning"}(f||(f={})),function(e){e[e.None=0]="None",e[e.MessagesDeleted=1]="MessagesDeleted"}(_||(_={})),function(e){e.MissingName="MissingName",e.TooLongName="TooLongName",e.InvalidCharacterInName="InvalidCharacterInName",e.MissingDescription="MissingDescription",e.TooLongDescription="TooLongDescription",e.InvalidCharacterInDescription="InvalidCharacterInDescription",e.MissingInstructions="MissingInstructions",e.TooLongInstructions="TooLongInstructions",e.InvalidCharacterInInstructions="InvalidCharacterInInstructions",e.InvalidIconUrl="InvalidIconUrl",e.InvalidGptId="InvalidGptId",e.TooManyConversationStarters="TooManyConversationStarters",e.InvalidCharacterInConversationStarter="InvalidCharacterInConversationStarter",e.InvalidConversationStarterImageUrl="InvalidConversationStarterImageUrl",e.TooLongConversationStarter="TooLongConversationStarter",e.MissingPluginShortName="MissingPluginShortName",e.TooLongShortName="TooLongShortName",e.InvalidCharacterInShortName="InvalidCharacterInShortName",e.MissingPluginLongName="MissingPluginLongName",e.TooLongLongName="TooLongLongName",e.InvalidCharacterInLongName="InvalidCharacterInLongName",e.MissingPluginShortDescription="MissingPluginShortDescription",e.TooLongShortDescription="TooLongShortDescription",e.InvalidCharacterInShortDescription="InvalidCharacterInShortDescription",e.MissingPluginFullDescription="MissingPluginFullDescription",e.TooLongFullDescription="TooLongFullDescription",e.InvalidCharacterInFullDescription="InvalidCharacterInFullDescription",e.MissingPluginFunction="MissingPluginFunction",e.MissingFunctionId="MissingFunctionId",e.TooLongFunctionId="TooLongFunctionId",e.InvalidCharacterInFunctionId="InvalidCharacterInFunctionId",e.MissingFunctionTitle="MissingFunctionTitle",e.TooLongFunctionTitle="TooLongFunctionTitle",e.InvalidCharacterInFunctionTitle="InvalidCharacterInFunctionTitle",e.MissingFunctionDescription="MissingFunctionDescription",e.TooLongFunctionDescription="TooLongFunctionDescription",e.InvalidCharacterInFunctionDescription="InvalidCharacterInFunctionDescription",e.MissingParameterName="MissingParameterName",e.TooLongParameterName="TooLongParameterName",e.InvalidCharacterInParameterName="InvalidCharacterInParameterName",e.MissingParameterDescription="MissingParameterDescription",e.TooLongParameterDescription="TooLongParameterDescription",e.InvalidCharacterInParameterDescription="InvalidCharacterInParameterDescription",e.MissingParameterTitle="MissingParameterTitle",e.TooLongParameterTitle="TooLongParameterTitle",e.InvalidCharacterInParameterTitle="InvalidCharacterInParameterTitle",e.InvalidTeamsMessagesCapabilityUrl="InvalidTeamsMessagesCapabilityUrl",e.OffensiveContent="OffensiveContent",e.Jailbreak="Jailbreak",e.RAIViolation="RAIViolation"}(C||(C={})),function(e){e.None="None",e.Limit="Limit",e.Billing="Billing"}(S||(S={})),function(e){e.ActionMETaskModule="ActionMETaskModule",e.AuthenticationCard="AuthenticationCard",e.CodeInterpreter="CodeInterpreter",e.ConfirmationCard="ConfirmationCard",e.GraphicArt="GraphicArt",e.MultiMessageResponse="MultiMessageResponse"}(A||(A={})),function(e){e.User="User",e.Tenant="Tenant",e.System="System"}(v||(v={})),function(e){e.Unknown="Unknown",e.User="User",e.Tenant="Tenant",e.System="System"}(I||(I={})),function(e){e.Active="Active",e.Draft="Draft",e.Deleted="Deleted",e.Blocked="Blocked"}(w||(w={})),function(e){e.Bot="bot",e.User="user",e.System="system"}(N||(t.nC=N={})),function(e){e.AnnRules="AnnRules",e.Apology="Apology",e.BingContent="Bing Content",e.Chitchat="Chitchat",e.NluDirectResponse="NluDirectResponse",e.Qna="Qna",e.TopicChanger="TopicChanger",e.Delighterdluni="Delighterdluni",e.DeepLeo="DeepLeo",e.TransformContent="transform_content",e.LocalPluginRunner="local-plugin-runner",e.ImageChat="image-chat",e.GenerateResponse="generate_response"}(E||(E={})),function(e){e.Image="IMAGE"}(b||(b={})),function(e){e.WebPage="WebPage",e.ClientApp="ClientApp"}(k||(k={})),function(e){e.None="None",e.Positive="Positive",e.Negative="Negative",e.Laugh="Laugh",e.Surprised="Surprised",e.UnknownBf="UnknownBf"}(M||(M={})),function(e){e.Keyboard="Keyboard",e.Speech="Speech"}(L||(L={})),function(e){e.AudioUrl="AudioUrl",e.None="None",e.Simple="Simple",e.Ssml="Ssml"}(B||(B={})),function(e){e.ActionRequest="ActionRequest",e.Ads="Ads",e.AdsQuery="AdsQuery",e.Any="Any",e.AuthError="AuthError",e.ChatCompleted="ChatCompleted",e.CaptchaChallenge="CaptchaChallenge",e.Chat="Chat",e.ChatName="ChatName",e.ConfirmationCard="ConfirmationCard",e.Context="Context",e.Disengaged="Disengaged",e.SearchQuery="SearchQuery",e.Internal="Internal",e.InvokeAction="InvokeAction",e.Suggestion="Suggestion",e.InternalSuggestions="InternalSuggestions",e.InternalSearchResult="InternalSearchResult",e.InternalSearchQuery="InternalSearchQuery",e.InternalReasoningSearchResult="InternalReasoningSearchResult",e.InternalActionMarker="InternalActionMarker",e.InternalStateMarker="InternalStateMarker",e.InternalLoaderMessage="InternalLoaderMessage",e.Progress="Progress",e.GenerateContentQuery="GenerateContentQuery",e.GeneratedCode="GeneratedCode",e.RenderCardRequest="RenderCardRequest",e.RequireHumanInTheLoop="RequireHumanInTheLoop",e.SemanticSerp="SemanticSerp",e.ResumePluginAuth="ResumePluginAuth",e.TriggerPluginAuth="TriggerPluginAuth",e.ResumeInvokeAction="ResumeInvokeAction",e.TriggerConfirmation="TriggerConfirmation",e.InternalContentDescription="InternalContentDescription",e.TriggerPlugin="TriggerPlugin",e.CompletePlugin="CompletePlugin",e.AttachmentAction="AttachmentAction"}(D||(t.n3=D={})),new Set([D.Chat,D.ChatCompleted,D.Disengaged,D.RenderCardRequest,D.RequireHumanInTheLoop]),function(e){e.IncomingBotResponse=void 0}(D||(t.n3=D={})),function(e){e.Blank="BLANK",e.BingFrontPageSkill="BING_FRONT_PAGE_SKILL",e.BingSkill="BING_SKILL",e.Chitchat="CHITCHAT",e.Infoseeking="INFOSEEKING",e.InitialBingFrontPageSkill="INITIAL_BING_FRONT_PAGE_SKILL",e.InitialQNA="INITIAL_QNA",e.InitialVideos="INITIAL_VIDEOS",e.InitialWebpages="INITIAL_WEBPAGES",e.MedicalHealth="MEDICAL_HEALTH",e.MicrosoftBrands="MICROSOFT_BRANDS",e.NeedEmpathy="NEED_EMPATHY",e.Offensive="OFFENSIVE",e.OpinionGiving="OPINION_GIVING",e.OpinionSeeking="OPINION_SEEKING",e.OUTOFDomain="OUT_OF_DOMAIN",e.QNA="QNA",e.SettingsChange="SETTINGS_CHANGE",e.SettingsCheck="SETTINGS_CHECK",e.SuicideHelp="SUICIDE_HELP",e.TuringBOTSafe="TURING_BOT_SAFE",e.Unhandled="UNHANDLED",e.Videos="VIDEOS",e.Webpages="WEBPAGES"}(P||(P={})),function(e){e.Amount="AMOUNT",e.Setting="SETTING",e.Type="TYPE",e.Unknown="UNKNOWN",e.Unit="UNIT",e.Value="VALUE"}(R||(R={})),function(e){e.Unknown="Unknown",e.None="None",e.Offensive="Offensive",e.OffenseTrigger="OffenseTrigger",e.OffenseResponse="OffenseResponse",e.Blocklist="Blocklist"}(O||(O={})),function(e){e.Finished="FINISHED",e.Intermediate="INTERMEDIATE",e.FinishedAwaitingCommit="FINISHED_AWAITING_COMMIT"}(x||(x={})),function(e){e.General="General",e.Internal="Internal"}(F||(F={})),function(e){e.Testing="Testing",e.AdminCenterCopilot="AdminCenterCopilot",e.AIHubAppChatCopilot="AIHubAppChatCopilot",e.AIHubBrowseCopilot="AIHubBrowseCopilot",e.AIHubHome="AIHubHome",e.Assist365Copilot="Assist365Copilot",e.BizChatScheduledActions_MacOutlookHub="BizChatScheduledActions_MacOutlookHub",e.BizChatScheduledActions_MonarchHub="BizChatScheduledActions_MonarchHub",e.BizChatScheduledActions_OfficeDesktop="BizChatScheduledActions_OfficeDesktop",e.BizChatScheduledActions_OfficeWeb="BizChatScheduledActions_OfficeWeb",e.BizChatScheduledActions_OwaHub="BizChatScheduledActions_OwaHub",e.BizChatScheduledActions_TeamsHub="BizChatScheduledActions_TeamsHub",e.BizChatScheduledActions_Win32OutlookHub="BizChatScheduledActions_Win32OutlookHub",e.CopilotClips="CopilotClips",e.ExcelCopilot="ExcelCopilot",e.ExcelCopilotConsumer="ExcelCopilotConsumer",e.ExcelCopilotConsumerOSv2="ExcelCopilotConsumerOSv2",e.ExchangeAdminCenterCopilot="ExchangeAdminCenterCopilot",e.FormsCopilot="FormsCopilot",e.LoopCopilot="LoopCopilot",e.LoopCopilotOnCanvas="LoopCopilotOnCanvas",e.ODSPCopilot="ODSPCopilot",e.OfficeAiAppIncubation="OfficeAiAppIncubation",e.OfficeCopilotSearchAnswer="OfficeCopilotSearchAnswer",e.OfficePersonalAgentsCopilot="OfficePersonalAgentsCopilot",e.OneNoteCopilot="OneNoteCopilot",e.OneNoteCopilotConsumer="OneNoteCopilotConsumer",e.OneNoteCopilotConsumerOSv2="OneNoteCopilotConsumerOSv2",e.OperaWordCopilot="OperaWordCopilot",e.OutlookCopilot="OutlookCopilot",e.OutlookCopilotBizchatBase="OutlookCopilotBizchatBase",e.OutlookCopilotConsumerOSv2="OutlookCopilotConsumerOSv2",e.OutlookSearchChatCopilot="outlooksearchchatcopilot",e.PodcastCopilot="PodcastCopilot",e.PPTCopilot="PPTCopilot",e.PPTCopilotConsumer="PPTCopilotConsumer",e.PPTCopilotConsumerOSv2="PPTCopilotConsumerOSv2",e.PPTOnCanvasCopilot="PPTOnCanvasCopilot",e.PlannerCopilot="PlannerCopilot",e.SharePointAdminCenterCopilot="SharePointAdminCenterCopilot",e.SharepointAuthoringCopilot="SharepointAuthoringCopilot",e.StreamCopilot="StreamCopilot",e.TeamsAdminCenterCopilot="TeamsAdminCenterCopilot",e.TeamsQueuesIntelligence="TeamsQueuesIntelligence",e.TeamsChatCopilot="TeamsChatCopilot",e.TeamsMessagesSerpAICopilot="TeamsMessagesSerpAICopilot",e.TeamsSerpCopilot="TeamsSerpCopilot",e.TeamsGroupCopilot="TeamsGroupCopilot",e.TeamsMeetingCopilot="teamsmeetingcp",e.TeamsMeetingGroupCopilot="TeamsMeetingGroupCopilot",e.VivaCopilot="VivaCopilot",e.VivaEngageCopilot="VivaEngageCopilot",e.VivaGoalsCopilot="VivaGoalsCopilot",e.WhiteboardCopilotOnCanvas="WhiteboardCopilotOnCanvas",e.WordCopilot="WordCopilot",e.WordBackstageCopilot="WordBackstageCopilot",e.WordCopilotConsumer="WordCopilotConsumer",e.WordCopilotConsumerOsv2="WordCopilotConsumerOSv2",e.WordOnCanvasCopilot="WordOnCanvasCopilot",e.LegacyDefault="Default",e.RealtimeChat="AugmentationLoopRealTimeChat",e.AIHubCreateCopilot="AIHubCreateCopilot"}(G||(G={}));(function(e){e.Creative="Creative",e.Balanced="Balanced",e.Precise="Precise"})(W||(W={})),function(e){e.AppChat="appchat"}(H||(H={})),function(e){e.Default="Default",e.Reasoning="Reasoning",e.Responding="Responding"}(U||(U={})),function(e){e.AdaptiveCard="AdaptiveCard"}(q||(q={})),function(e){e[e.InternalError=-32603]="InternalError",e[e.InvalidParams=-32602]="InvalidParams",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.InvocationError=-32e3]="InvocationError",e[e.InvocationErrorWithException=-32004]="InvocationErrorWithException",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.NoMarshaledObjectFound=-32001]="NoMarshaledObjectFound",e[e.ParseError=-32700]="ParseError",e[e.RequestCanceled=-32800]="RequestCanceled",e[e.ResponseSerializationFailure=-32003]="ResponseSerializationFailure"}(V||(V={})),function(e){e.SUCCESS="success",e.FAILURE="failure"}($||($={})),function(e){e.AlwaysOn="AlwaysOn",e.Dynamic="Dynamic"}(j||(j={})),function(e){e.Document="document",e.Workbook="workbook",e.Presentation="presentation"}(z||(z={}))},750567:(e,t,s)=>{s.d(t,{Ix:()=>u,dx:()=>d,uv:()=>h});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCalculateColumnPreviewSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCalculateRowPreviewSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetRangeSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetFileTablesMetadataSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadSingleCellPreviewSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCommandingSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadExecutePythonCodeRequestSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGetPythonCodeResultSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadChartRecommendationSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadStartNewSessionSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadGeneratedFormulaPreviewSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadStartSnapshotSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){n.h.assign(T,this,e)}static getTypeName(){return"AugLoop_ExcelScratchpad_ExcelScratchpadCloseSnapshotSignal"}static getBaseTypes(){return["AugLoop_ExcelScratchpad_ExcelScratchpadSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()}},750711:(e,t,s)=>{s.d(t,{m:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotOutputAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaValidateGptAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},750840:(e,t,s)=>{s.d(t,{qS:()=>r});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew","AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelBoundaryDetectionLimitExceededAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelBoundaryDetectionConfiguration"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelBlobRange"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_ExcelTableai_ExcelBoundaryDetectionStatus"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()}},756756:(e,t,s)=>{var n;s.d(t,{G:()=>n}),function(e){e.Success="Success",e.Failed="Failed"}(n||(n={}))},760640:(e,t,s)=>{var n=s(72715);Object.defineProperty(t,"__esModule",{value:!0}),t.LogCategory=t.tagIdToString=t.getNumLoggers=t.argsToString=t.Log=void 0;const o=s(834949),i=s(719843),a=void 0!==n&&n.env?n.env.SERVICE_NAME:"client",r="abcdefghijklmnopqrstuvwxyz0123456789",c={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let l,u=[],p=[],g=e=>null,h=e=>{};const d=new Map,m=new Map,y=new Map,T=new Map;var f,_;!function(e){e.Default="",e.EDPSCompliant="edps"}(f||(f={})),function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{u=[],p=[],m.clear(),y.clear()},e.clearAggregators=()=>{d.clear()},e.addLogger=e=>{-1===u.indexOf(e)&&(u.push(e),C(m,e))},e.addDecidingLogger=e=>{-1===p.indexOf(e)&&(p.push(e),C(y,e))},e.setCorrelationContextCallback=e=>{l=e},e.setStartPerformanceEventCallback=e=>{g=e},e.setStopPerformanceEventCallback=e=>{h=e},e.addAggregator=e=>{e.init(((e,t)=>{E(e,t)})),d.has(e.eventName)?d.get(e.eventName).push(e):d.set(e.eventName,[e])},e.flushAggregators=e=>{d.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const s=L(e);T.set(s,t)},e.resetTagLevelOverrides=()=>{T.clear()},e.error=(e,t,s,n,i,a,r,c,l,u)=>{N(e,t,o.LoggingLevel.error,s,n,i,a,r,c,l,u)},e.warn=(e,t,s,n,i,a,r,c,l,u)=>{N(e,t,o.LoggingLevel.warn,s,n,i,a,r,c,l,u)},e.info=(e,t,s,n,i,a,r,c,l,u)=>{N(e,t,o.LoggingLevel.info,s,n,i,a,r,c,l,u)},e.verbose=(e,t,s,n,i,a,r,c,l,u)=>{N(e,t,o.LoggingLevel.verbose,s,n,i,a,r,c,l,u)},e.debug=(e,t,s,n,i,a,r,c,l,u)=>{N(e,t,o.LoggingLevel.debug,s,n,i,a,r,c,l,u)},e.metric=(e,t,s,n,i,a,r,c,l,u)=>{N(e,t,o.LoggingLevel.metric,s,n,i,a,r,c,l,u)},e.formatMetric=(e,t,s,n)=>{const o={};return o[e]={dimensionNames:s,dimensionValues:n,value:t},o},e.dynamic=e=>{E(e)}}(_||(t.Log=_={}));const C=(e,t)=>{const s=t.level;Object.keys(o.LoggingLevel).map((e=>o.LoggingLevel[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=s)).forEach((s=>{e.has(s)?e.get(s).push(t):e.set(s,[t])}))};t.argsToString=e=>{if("string"==typeof e)return e;let t="";for(let s=0;s<e.length;s++){s>0&&(t+=" ");const n=e[s];n instanceof Error?t+=JSON.stringify({message:n.message,name:n.name,stack:n.stack}):t+="object"==typeof n?JSON.stringify(n):n}return t};const S=[],A=["Level","Tag"],v=["Level","Tag","Workflow"];t.getNumLoggers=e=>I(e).length;const I=e=>void 0!==e?m.get(e)||S:u,w=(e,t)=>(void 0!==e?y.get(e)||[]:p).filter((e=>e.shouldLog(t))),N=(e,s,n,o,a,r,c,u,p,m,y)=>{n=T.get(e)||n;const f=I(n),_=w(n,o);if(0==f.length&&0==_.length)return;const C=g(i.PerformanceEventType.Log),S=(0,t.tagIdToString)(e),N=((e,t,s,n,o,i,a,r)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const c=[];for(const l of[e,t,s,n,o,i,a,r])void 0!==l&&c.push("function"==typeof l?l():l);return c})(o,a,r,c,u,p,m,y);if(b(s))k(N)&&E({eventName:"Metrics",tagId:S,category:`${s.root}.${s.name}`,traceLevel:n,message:"",getMetrics:()=>N},!1,f,_);else if(k(N)){const e=N;e.tagId=S,e.category=`${s.root}.${s.name}`,"Operation"===e.eventName&&"Workflow"===s.root&&(e.eventName="WorkflowOperation",l&&(e.joinContextId=l().joinContextId,e.workflow=l().workflow)),e.traceLevel=n;const t=d.get(e.eventName);if(t)for(let s=0;s<t.length;++s){const n=t[s];if(n&&n.add(e,s===t.length-1))break}else E(e,!1,f,_)}else{const e=()=>{var e;return"Core"===s.root?{TraceEventV2:{dimensionNames:()=>A,dimensionValues:[String(n),S],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>v,dimensionValues:[String(n),S,l?null===(e=l())||void 0===e?void 0:e.workflow:""],value:1}}};E({eventName:"Log",tagId:S,category:`${s.root}.${s.name}`,traceLevel:n,message:(0,t.argsToString)(N),getMetrics:e},!1,f,_)}h(C)},E=(e,t=!1,s,n)=>{var o,i,r,c,u,p,g,h,d,m,y,T,f,_;let C;if(null==s&&(s=I(e.traceLevel)),n=n||S,s.length>0||n.length>0){if(e.serviceName=a,!t&&l){const t=l();t&&(C={disableLogging:t.disableLogging,userDataBoundaryType:null===(i=null===(o=t.sessionDescriptor)||void 0===o?void 0:o.userContext)||void 0===i?void 0:i.userDataBoundaryType},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.userTenantId=e.userTenantId?e.userTenantId:t.userTenantId,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(r=t.clientMetadata)||void 0===r?void 0:r.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(c=t.clientMetadata)||void 0===c?void 0:c.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(u=t.clientMetadata)||void 0===u?void 0:u.appVersion,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(p=t.clientMetadata)||void 0===p?void 0:p.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(d=t.clientMetadata)||void 0===d?void 0:d.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(m=t.clientMetadata)||void 0===m?void 0:m.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(y=t.clientMetadata)||void 0===y?void 0:y.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(T=t.clientMetadata)||void 0===T?void 0:T.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(f=t.clientMetadata)||void 0===f?void 0:f.isClientTelemetrySampled,e.userDataBoundaryType=M(C),e.ecsConfigIDs=null===(_=t.ecsConfigIDsManager)||void 0===_?void 0:_.getAllConfigIDsString())}for(const t of s)t.log(e,C);for(const t of n)t.log(e)}},b=e=>e.name===B.WorkflowMetricsOnly.name&&e.root===B.WorkflowMetricsOnly.root,k=e=>!Array.isArray(e)&&"object"==typeof e,M=e=>(null==e?void 0:e.userDataBoundaryType)===o.UserDataBoundaryType.EDPSCompliant?f.EDPSCompliant:f.Default;t.tagIdToString=e=>r[e>>24&63]+r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e];const L=e=>e&&5===e.length?c[e.charCodeAt(0)]<<24|c[e.charCodeAt(1)]<<18|c[e.charCodeAt(2)]<<12|c[e.charCodeAt(3)]<<6|c[e.charCodeAt(4)]:-1;class B{}t.LogCategory=B,B.CoreDefault=_.defineCoreLogCategory("Default"),B.CoreSystem=_.defineCoreLogCategory("System"),B.CoreUnsampled=_.defineCoreLogCategory("Unsampled"),B.WorkflowDefault=_.defineWorkflowLogCategory("Default"),B.WorkflowUnsampled=_.defineWorkflowLogCategory("Unsampled"),B.WorkflowMetricsOnly=_.defineWorkflowLogCategory("MetricsOnly"),B.PrivacyGuardEvent=_.defineCoreLogCategory("PrivacyGuardEvent")},768330:(e,t,s)=>{var n;s.d(t,{O:()=>n,Q:()=>o}),function(e){e.dev="dev",e.int="int",e.test="test",e.dogfood="dogfood",e.msit="msit",e.prod="prod",e.gcc="gcc",e.dod="dod",e.gccHigh="gcchigh",e.ag08="ag08",e.ag09="ag09",e.gallatin="gallatin"}(n||(n={}));const o={gcc:"fairfax"}},770224:(e,t,s)=>{var n;s.d(t,{e:()=>n}),function(e){e.OfficeScript="OfficeScript",e.OfficeJs="OfficeJs"}(n||(n={}))},774162:(e,t,s)=>{var n;s.d(t,{Z:()=>n}),function(e){e[e.None=0]="None",e[e.Booleans=1]="Booleans",e[e.Float32s=2]="Float32s",e[e.Float64s=3]="Float64s",e[e.Int8s=4]="Int8s",e[e.Int16s=5]="Int16s",e[e.Int32s=6]="Int32s",e[e.Strings=7]="Strings",e[e.UnsignedInt8s=8]="UnsignedInt8s",e[e.UnsignedInt16s=9]="UnsignedInt16s",e[e.UnsignedInt32s=10]="UnsignedInt32s"}(n||(n={}))},774422:(e,t,s)=>{var n;s.d(t,{Ff:()=>a,P_:()=>i,XH:()=>r,n4:()=>o,oJ:()=>n}),function(e){e.Bold="Word.Editing.Bold",e.CenterJustify="Word.Editing.CenterJustify",e.CreateBulletList="Word.Editing.CreateBulletList",e.CreateNumberedList="Word.Editing.CreateNumberedList",e.Delete="Word.Editing.Delete",e.Deselect="Word.Editing.Deselect",e.Exit="Command.Exit",e.ExitList="Word.Editing.ExitList",e.FullJustify="Word.Editing.FullJustify",e.Highlight="Word.Editing.Highlight",e.SetFont="Word.Editing.SetFont",e.InsertText="Word.Editing.InsertText",e.InsertBullet="Word.Editing.InsertBullet",e.InsertComment="Word.Editing.InsertComment",e.InsertEmoji="Word.Editing.InsertEmoji",e.InsertTable="Word.Editing.Table.Insert",e.DeleteTable="Word.Editing.Table.Delete",e.NavigateTable="Word.Editing.Table.Navigate",e.Navigation="Word.Editing.Navigation",e.InsertSpace="Word.Editing.InsertSpace",e.Italics="Word.Editing.Italics",e.LeftJustify="Word.Editing.LeftJustify",e.NewLine="Word.Editing.NewLine",e.NextBullet="Word.Editing.NextBullet",e.NextLine="Word.Editing.NextLine",e.Pause="Command.Pause",e.Paste="Word.Editing.Paste",e.ReadBack="Word.Editing.ReadBack",e.Redo="Word.Editing.Redo",e.RightJustify="Word.Editing.RightJustify",e.RemoveBold="Word.Editing.RemoveBold",e.RemoveItalics="Word.Editing.RemoveItalics",e.RemoveUnderline="Word.Editing.RemoveUnderline",e.RemoveHighlight="Word.Editing.RemoveHighlight",e.RemoveSuperscript="Word.Editing.RemoveSuperscript",e.RemoveStrikeThrough="Word.Editing.RemoveStrikeThrough",e.RemoveSubscript="Word.Editing.RemoveSubscript",e.RemoveFormatting="Word.Editing.RemoveFormatting",e.Quote="Word.Editing.Quote",e.Select="Word.Editing.Select",e.Superscript="Word.Editing.Superscript",e.Subscript="Word.Editing.Subscript",e.StrikeThrough="Word.Editing.StrikeThrough",e.ShowHelp="Command.ShowHelp",e.ShowCommands="Command.ShowCommand",e.Undo="Word.Editing.Undo",e.Underline="Word.Editing.Underline",e.IncreaseIndent="Word.Editing.IncreaseIndent",e.DecreaseIndent="Word.Editing.DecreaseIndent",e.Backspace="Word.Editing.Backspace",e.VoiceCommand="Command.VoiceCommand",e.Type="Command.Type",e.ShrinkFont="Word.Editing.ShrinkFont",e.GrowFont="Word.Editing.GrowFont",e.AllCaps="Word.Editing.AllCaps",e.SentenceCase="Word.Editing.SentenceCase",e.LowerCase="Word.Editing.LowerCase",e.Tab="Word.Editing.Tab",e.ZoomOut="Word.View.ZoomOut",e.ZoomIn="Word.View.ZoomIn",e.ScrollUp="Word.View.ScrollUp",e.ScrollDown="Word.View.ScrollDown",e.ShowOutline="Word.View.ShowOutline",e.PageBreak="Word.Editing.PageBreak",e.ResumeDictation="Word.Editing.ResumeDictation",e.Correction="Word.Editing.Correction",e.Style="Word.Editing.Style",e.CorrectionOption="Word.Editing.CorrectionOption",e.SpellOut="Word.Editing.SpellOut",e.ShowSuggestions="Word.Editing.ShowSuggestions",e.Send="Outlook.Send",e.Cancel="Outlook.Cancel",e.Yes="Outlook.Yes",e.AddRecipient="Outlook.AddRecipient",e.AtMention="Outlook.AtMention",e.FieldEdit="Outlook.FieldEdit",e.MoonshotAbout="Annotation.Document.About",e.MoonshotReadFromBeginning="Annotation.Document.FromBeginning",e.MoonshotKeyPoints="Annotation.Document.KeyPoints",e.MoonshotOutline="Annotation.Document.Outline",e.MoonshotReadInFull="Annotation.Document.ReadInFull",e.MoonshotSummarize="Annotation.Document.Summary",e.MoonshotMicrophoneOff="Audio.MicrophoneOff",e.MoonshotPause="Audio.Pause",e.MoonshotPlay="Audio.Play",e.MoonshotReplay="Audio.Replay",e.MoonshotSlowDown="Audio.SlowDown",e.MoonshotSpeedUp="Audio.SpeedUp",e.MoonshotReadSection="Document.Action.ReadSection",e.MoonshotRepeat="Document.Action.Repeat",e.MoonshotReview="Document.Action.Review",e.MoonshotDocumentAge="Document.Metadata.Age",e.MoonshotDocumentAuthor="Document.Metadata.Author",e.MoonshotDocumentHits="Document.Metadata.Hits",e.MoonshotDocumentLength="Document.Metadata.Length",e.MoonshotDocumentPreview="Document.Metadata.Preview",e.MoonshotDocumentTitle="Document.Metadata.Title",e.MoonshotNo="General.No",e.MoonshotYes="General.Yes",e.MoonshotIntro="intro",e.MoonshotNextDocument="Navigate.Document.Next",e.MoonshotPreviousDocument="Navigate.Document.Previous",e.ExcelIntent="ExcelIntent",e.InternalReadBack="Internal.Word.Editing.ReadBack",e.NoOp="NoOp"}(n||(n={}));var o,i,a,r=new Set([n.InternalReadBack]);!function(e){e.TableColumns="Word.Editing.InsertTable.TableColumns",e.TableRows="Word.Editing.InsertTable.TableRows",e.SelectionType="Word.Editing.ActOnSelection.SelectionType"}(o||(o={})),function(e){e.SpeechRecognitionStarted="SpeechRecognitionStarted",e.SpeechRecognitionStopped="SpeechRecognitionStopped",e.SpeechSessionStarted="SpeechSessionStarted",e.SpeechSessionStopped="SpeechSessionStopped"}(i||(i={})),function(e){e.MicrophoneError="ErrorAudioCaptureAsync"}(a||(a={}))},783705:(e,t,s)=>{s.d(t,{Pv:()=>i,vp:()=>o});var n=s(985002),o=(function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_CustomProp"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EntityConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccEntityConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EntityConfig"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccFeatureConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FeatureConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_BestMatchConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ScopeConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccFeatureConfig"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionConfig"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_FeatureConfig"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionConfig"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_HostConfig"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();!function(){function e(t){n.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientMetadata"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},784567:(e,t,s)=>{s.d(t,{I:()=>a,XP:()=>u,Xr:()=>c,fZ:()=>p,g0:()=>C,hW:()=>l,n4:()=>g,xU:()=>f});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{constructor(e){n.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{constructor(e){n.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{constructor(e){n.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){n.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){n.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Core_CancelSignalTriggeredWorkflowExecutionOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()}},789796:(e,t,s)=>{var n,o;s.d(t,{H:()=>n,n:()=>o}),function(e){e.GetTUIEverShownState="GetTUIEverShownState",e.SetTUIEverShownState="SetTUIEverShownState"}(n||(n={})),function(e){e.Success="Success",e.Failure="Failure"}(o||(o={}))},794718:(e,t,s)=>{var n,o,i,a,r,c,l,u,p,g,h;s.d(t,{pc:()=>a}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Inline=1]="Inline",e[e.Floating=2]="Floating"}(n||(n={})),function(e){e[e.ThumbsUp=0]="ThumbsUp"}(o||(o={})),function(e){e[e.Active=0]="Active",e[e.Resolved=1]="Resolved",e[e.Closed=2]="Closed"}(i||(i={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered",e[e.Lim=3]="Lim",e[e.Nil=4]="Nil",e[e.Any=5]="Any",e[e.NoList=6]="NoList",e[e.Invalid=7]="Invalid"}(a||(a={})),function(e){e[e.DontCare=1]="DontCare",e[e.Thin=2]="Thin",e[e.ExtraLight=3]="ExtraLight",e[e.Light=4]="Light",e[e.Normal=5]="Normal",e[e.Medium=6]="Medium",e[e.SemiBold=7]="SemiBold",e[e.Bold=8]="Bold",e[e.ExtraBold=9]="ExtraBold",e[e.Heavy=10]="Heavy"}(r||(r={})),function(e){e[e.NoCaps=0]="NoCaps",e[e.SmallCaps=1]="SmallCaps",e[e.AllCaps=2]="AllCaps",e[e.AllPetiteCaps=3]="AllPetiteCaps",e[e.PetiteCaps=4]="PetiteCaps",e[e.Unicase=5]="Unicase",e[e.Titling=6]="Titling",e[e.Other=7]="Other"}(c||(c={})),function(e){e[e.None=0]="None",e[e.Words=1]="Words",e[e.SingleLine=2]="SingleLine",e[e.DoubleLine=3]="DoubleLine",e[e.HeavyLine=4]="HeavyLine",e[e.DottedLine=5]="DottedLine",e[e.DottedHeavyLine=6]="DottedHeavyLine",e[e.DashLine=7]="DashLine",e[e.DashHeavyLine=8]="DashHeavyLine",e[e.DashLongLine=9]="DashLongLine",e[e.DashLongHeavyLine=10]="DashLongHeavyLine",e[e.DotDashLine=11]="DotDashLine",e[e.DotDashHeavyLine=12]="DotDashHeavyLine",e[e.DotDotDashLine=13]="DotDotDashLine",e[e.DotDotDashHeavyLine=14]="DotDotDashHeavyLine",e[e.WavyLine=15]="WavyLine",e[e.WavyHeavyLine=16]="WavyHeavyLine",e[e.WavyDoubleLine=17]="WavyDoubleLine"}(l||(l={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justified=3]="Justified",e[e.Other=4]="Other",e[e.None=5]="None",e[e.JustifyLow=6]="JustifyLow",e[e.Distributed=7]="Distributed",e[e.ThaiDistributed=8]="ThaiDistributed"}(u||(u={})),function(e){e[e.Image=0]="Image",e[e.TextBox=1]="TextBox",e[e.Chart=2]="Chart",e[e.SmartArt=3]="SmartArt",e[e.Drawing=4]="Drawing",e[e.EquationObject=5]="EquationObject",e[e.Ink=6]="Ink",e[e.InkSpace=7]="InkSpace",e[e.InkEndOfLine=8]="InkEndOfLine",e[e.LineBreak=9]="LineBreak",e[e.PageBreak=10]="PageBreak",e[e.PageNumbers=11]="PageNumbers",e[e.FootnoteEndnote=12]="FootnoteEndnote",e[e.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark",e[e.Tab=14]="Tab",e[e.UnsupportedObject=15]="UnsupportedObject",e[e.Other=16]="Other",e[e.Person=17]="Person",e[e.Date=18]="Date"}(p||(p={})),function(e){e[e.Initial=0]="Initial",e[e.FirstLine=1]="FirstLine",e[e.Hanging=2]="Hanging"}(g||(g={})),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(h||(h={}))},803034:(e,t,s)=>{var n;s.d(t,{A:()=>n}),function(e){e.Dictation="Dictation",e.Transcription="Transcription",e.ConversationTranscription="ConversationTranscription",e.Rehearsal="Rehearsal",e.Subtitle="Subtitle"}(n||(n={}))},808896:(e,t,s)=>{s.d(t,{w:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_TenantFeedbackData_DiagnosticUploadResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},811250:(e,t,s)=>{s.d(t,{vF:()=>i});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffPropertiesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffInboundMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffPropertiesSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_AppHandoffInboundMessage"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffInternalMessage"}static getBaseTypes(){return["AugLoop_HandoffSkill_HandoffPropertiesSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffMessageId"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffPrompt"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_HandoffSkill_HandoffDocUrlSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},813373:(e,t,s)=>{s.d(t,{Pq:()=>i,aM:()=>n,l6:()=>o,vf:()=>c});var n,o,i,a=s(511310),r=s(230529);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(i||(i={}));class c extends a.R{constructor(e,t){var s,a;super({source:n[e.source],reason:o[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:i[e.impact],success:e.success,durationMs:null!==(s=e.durationMs)&&void 0!==s?s:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(a=e.affectedWorkflows)&&void 0!==a?a:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",this.aggregationEnabled=!1,t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=o[e],this}setSource(e){return this.source=n[e],this}setImpact(e){return this.impact=i[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}enableAggregation(){return this.aggregationEnabled=!0,this}shouldBeAggregated(){return this.aggregationEnabled}start(){return this.startTime=(0,r.t)(),this}stop(){const e=(0,r.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},815881:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AudioStreamPerfTracker=t.RunningAveragesTracker=t.getOffsetAndDurationInMs=void 0;var n=s(745032),o=s(601317);t.getOffsetAndDurationInMs=function(e){return{offsetMs:e.Offset/1e4,durationMs:e.Duration/1e4}};var i=function(){function e(){this.count=0,this.total={service:0,perceived:0},this.min={service:Number.MAX_VALUE,perceived:Number.MAX_VALUE},this.max={service:0,perceived:0}}return e.prototype.add=function(e){this.count++,this.total.perceived+=e.perceived,this.total.service+=e.service,this.min.perceived=Math.min(e.perceived,this.min.perceived),this.min.service=Math.min(e.service,this.min.service),this.max.perceived=Math.max(e.perceived,this.max.perceived),this.max.service=Math.max(e.service,this.max.service)},e.prototype.getAverages=function(){return 0===this.count?{perceived:-1,service:-1}:{perceived:this.total.perceived/this.count,service:this.total.service/this.count}},e}();t.RunningAveragesTracker=i;var a=function(){function e(e,t){this.finals=new i,this.partials=new i,this.getNow=o.now,this.list=[],this.maxListLength=e,this.warnListLength=.8*e,this.getNow=null!=t?t:o.now}return Object.defineProperty(e.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),e.prototype.getChunk=function(e){return this.list[e]},e.prototype.track=function(e,t,s){var o={audioStart:e-t,audioEnd:e,localEnd:this.getNow(),seq:s},i=this.list.length-1;if(-1===i||o.audioStart>=this.list[i].audioEnd)this.list.push(o);else if(o.audioEnd<=this.list[0].audioStart)this.list.unshift(o);else{for(;i>0&&o.audioEnd<this.list[i].audioStart;)i--;if(i>=0&&o.audioStart===this.list[i].audioStart)throw new Error("Why are we double tracking the same chunk of audio? newChunk: ".concat(JSON.stringify(o),", existing chunk: ").concat(JSON.stringify(this.list[i])));this.list.splice(i,0,o)}if(this.list.length>this.maxListLength){var a=this.list.length-this.maxListLength;this.list.splice(0,a),n.Log.warn(572662883,n.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.track: list length has exceeded max by ".concat(a," items!"))}else this.list.length>=this.warnListLength&&n.Log.warn(572662912,n.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.track: list length: ".concat(this.list.length," approaching max: ").concat(this.maxListLength))},e.prototype.trimBefore=function(e){if(0!==this.list.length){for(var t="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),s=0;s<this.list.length&&this.list[s].audioEnd<e;)s++;s===this.list.length&&n.Log.warn(561628760,n.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.trimBefore: no match found for audioEnd: ".concat(e,". List length: ").concat(this.list.length,", audio span: ").concat(t));var o=this.list.splice(0,s),i=o.length>0?"".concat(o[0].audioStart," to ").concat(o[o.length-1].audioEnd):"none",a=this.list.length>0?"".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd):"none";n.Log.info(572662914,n.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.trimBefore: audioEnd: ".concat(e,", culling ").concat(o.length," chunks (audio span ").concat(i,"), new list.length: ").concat(this.list.length,". Audio span was: ").concat(t,", now: ").concat(a))}else n.Log.info(572662913,n.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.trimBefore: list is empty - nothing to trim!")},e.prototype.clear=function(){n.Log.info(506045275,n.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.clear: clearing all ".concat(this.list.length," entries")),this.list.splice(0,this.list.length)},e.prototype.getChunksFrom=function(e,t){for(var s,n,o=e+t,i=0;i<this.list.length&&(!s||!n);){var a=this.list[i];!s&&e>=a.audioStart&&e<=a.audioEnd&&(s=a),!n&&o>=a.audioStart&&o<=a.audioEnd&&(n=a),i++}return[s,n]},e.prototype.measureLatency=function(e,t,s){var o=this.getNow(),i=e+t,a=this.getChunksFrom(e,t),r=a[0],c=a[1];if(!r&&!c)return n.Log.warn(572662915,n.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.getRelatedAudioChunks: Zero audio chunks not found for speechEnd: ".concat(i," (").concat(e," + ").concat(t,")")),{service:-1,perceived:-1};if(!r||!c){var l=r?"end":"start",u="none",p=NaN;this.list.length>0&&(u="".concat(this.list[0].audioStart," to ").concat(this.list[this.list.length-1].audioEnd),p=r?i-this.list[this.list.length-1].audioEnd:i-this.list[0].audioStart),n.Log.warn(572662916,n.LogCategory.WorkflowDefault,"AudioStreamPerfTracker.getRelatedAudioChunks: Expected audio chunk not found for ".concat(l," of audio, for speechEnd: ").concat(i," (").concat(e," + ").concat(t,"), tracked audio span: ").concat(u,", delta: ").concat(p))}var g=o-Math.max((null==r?void 0:r.localEnd)||0,(null==c?void 0:c.localEnd)||0),h=r?this.getLatencyForChunk(r,e,t,o):-1,d=c?this.getLatencyForChunk(c,i,0,o):-1,m={service:g,perceived:Math.max(h,d)};return(s?this.finals:this.partials).add(m),m},e.prototype.getLatencyForChunk=function(e,t,s,n){return n-(e.localEnd-(e.audioEnd-t))-s},e}();t.AudioStreamPerfTracker=a},827774:(e,t,s)=>{s.d(t,{z:()=>i});var n=s(41498),o=s(475769);class i{constructor(e,t){var s,o,i,a,r,c;this.kind=n.wC.SingleItem,this.isStateful=!1,this.id=e,t&&(this.inputTypes=null!==(s=t.inputTypes)&&void 0!==s?s:this.inputTypes,this.outputTypes=null!==(o=t.outputTypes)&&void 0!==o?o:this.outputTypes,this.isStateful=null!==(i=t.isStateful)&&void 0!==i?i:this.isStateful,this.requestedContextTypesRules=null!==(a=t.requestedContextTypesRules)&&void 0!==a?a:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(r=t.definitionOverrideTargetWorkflows)&&void 0!==r?r:this.definitionOverrideTargetWorkflows,this.correlatedSignals=0!==(null===(c=t.correlatedSignals)||void 0===c?void 0:c.length)?t.correlatedSignals:this.correlatedSignals)}static create(e){return new i(e)}setInputTypes(e){return this.inputTypes=(0,o.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,o.MY)(e),this}setStateful(){return this.isStateful=!0,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setDefinitionOverrideTargetWorkflows(e){return this.definitionOverrideTargetWorkflows=e,this}setCorrelatedSignals(e){return 0!==e.length&&(this.correlatedSignals=e),this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},834949:(e,t,s)=>{s.r(t),s.d(t,{ActivationTier:()=>D.XJ,AsyncBoundaryLoaderKind:()=>r,AsyncBoundaryLoaderType:()=>a,AsyncBoundaryRequest:()=>u,AuthTokenType:()=>i.OY,BillingDomain:()=>D.mk,BlobStorageType:()=>n,CoherencyError:()=>P,DataCategories:()=>b.b,DiagnosticLevel:()=>b.E,DlpPolicyScope:()=>D.Bh,Environment:()=>c.O,EnvironmentNameTranslation:()=>c.Q,EventStatus:()=>I,ExpectedError:()=>A.D,FilteringAsyncBoundaryRequest:()=>p,GridRangeFilter:()=>m,GridRangeSampleFilter:()=>y,GridSubtreeFilter:()=>d,InputStage:()=>D.RN,ItemCardinality:()=>M,ItemRole:()=>k,LoggingLevel:()=>N.q,ModelIteratingAsyncBoundaryRequest:()=>g,OAuth2GrantFlow:()=>i.Av,OAuth2V2LoginStatus:()=>i.rN,Pattern:()=>S,PrefilterActionType:()=>D.Uy,PrefilterType:()=>D.gd,ProducerWaitPolicy:()=>D.qW,RequestedContextCardinality:()=>D.in,SequentialItemFilter:()=>h,SerializationProfile:()=>w,SetMessagesOperationType:()=>o,TriggerCondition:()=>D.ov,Type:()=>T.Z,UnitType:()=>D.ni,UserDataBoundaryType:()=>i.Om,UserType:()=>i.ut,WorkflowCancellationReason:()=>E,WorkflowDefinitionScope:()=>A.T,WorkflowExecutionThrottleResponse:()=>B,WorkflowKind:()=>D.wC,WorkflowStoreType:()=>L,WorkflowVisibility:()=>D.Y$,gatewayType:()=>v,isExceptionMessage:()=>C,stringifyReplacer:()=>f});var n,o,i=s(610396);!function(e){e.Azure="azure",e.Spe="spe",e.Local="local"}(n||(n={})),function(e){e[e.Add=1]="Add",e[e.Update=2]="Update",e[e.Delete=3]="Delete"}(o||(o={}));var a,r,c=s(768330),l=s(985002);class u{constructor(e){l.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Interfaces_AsyncBoundaryRequest"}static getBaseTypes(){return[]}static typeGuard(e){return l.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{constructor(e){l.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Interfaces_FilteringAsyncBoundaryRequest"}static getBaseTypes(){return["AugLoop_Interfaces_AsyncBoundaryRequest"]}static typeGuard(e){return l.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{constructor(e){l.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Interfaces_ModelIteratingAsyncBoundaryRequest"}static getBaseTypes(){return["AugLoop_Interfaces_AsyncBoundaryRequest"]}static typeGuard(e){return l.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{constructor(e){l.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Interfaces_SequentialItemFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return l.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{constructor(e){l.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Interfaces_GridSubtreeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return l.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{constructor(e){l.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Interfaces_GridRangeFilter"}static getBaseTypes(){return["AugLoop_Core_ItemFilter"]}static typeGuard(e){return l.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){l.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Interfaces_GridRangeSampleFilter"}static getBaseTypes(){return["AugLoop_Interfaces_GridRangeFilter","AugLoop_Core_ItemFilter"]}static typeGuard(e){return l.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()},function(e){e[e.MastermindAsyncBoundaryLoader=0]="MastermindAsyncBoundaryLoader",e[e.TruncatedModelIteratingLoader=1]="TruncatedModelIteratingLoader",e[e.ExcelAsyncBoundaryLoader=2]="ExcelAsyncBoundaryLoader",e[e.TruncatedModelNoPulling=3]="TruncatedModelNoPulling"}(a||(a={})),function(e){e[e.Filtering=0]="Filtering",e[e.ModelIterating=1]="ModelIterating"}(r||(r={}));var T=s(774162);const f=(e,t)=>"object"==typeof t&&null!==t&&0==Object.keys(t).length?void 0:t;var _=s(339297);const C=e=>null==e||null==e.messageType||e.messageType==_.G.Exception;var S;!function(e){e[e.PubSub=0]="PubSub",e[e.RequestReply=1]="RequestReply"}(S||(S={}));var A=s(580717);const v="Gateway";var I,w,N=s(976941);!function(e){e[e.Active=0]="Active",e[e.Stopped=1]="Stopped",e[e.Paused=2]="Paused"}(I||(I={})),function(e){e[e.JSONB=0]="JSONB",e[e.JSON=1]="JSON",e[e.JSOND=2]="JSOND",e[e.Disabled=3]="Disabled",e[e.COMPRESSEDJSON=4]="COMPRESSEDJSON",e[e.MESSAGEPACK=5]="MESSAGEPACK",e[e.COMPRESSEDMESSAGEPACK=6]="COMPRESSEDMESSAGEPACK"}(w||(w={}));var E,b=s(886556);!function(e){e[e.Other=0]="Other",e[e.DocumentUpdate=1]="DocumentUpdate",e[e.Timeout=2]="Timeout",e[e.CloseSession=3]="CloseSession",e[e.PurgeOrDelete=4]="PurgeOrDelete",e[e.Client=5]="Client",e[e.Merged=6]="Merged",e[e.MergedPendingTask=7]="MergedPendingTask",e[e.GridSplit=8]="GridSplit"}(E||(E={}));var k,M,L,B,D=s(41498);class P extends Error{constructor(e="CoherencyError"){super(e),this.__proto__=P.prototype}}!function(e){e[e.Input=1]="Input",e[e.Output=2]="Output"}(k||(k={})),function(e){e[e.Single=1]="Single",e[e.Any=-1]="Any",e[e.Optional=-2]="Optional",e[e.Some=-3]="Some"}(M||(M={})),function(e){e[e.WorkflowSession=0]="WorkflowSession",e[e.User=1]="User"}(L||(L={})),function(e){e[e.NoThrottle=0]="NoThrottle",e[e.SoftThrottle=1]="SoftThrottle",e[e.HardThrottle=2]="HardThrottle"}(B||(B={}))},837450:(e,t,s)=>{s.d(t,{c:()=>T});var n=s(46029),o=s(186117),i=s(768330),a=s(521409),r=s(301520),c=s(53403);function l(e,t,s){var n;if(!t||void 0===s)return[];const o=t.substring(0,s).trimEnd(),i=t.substring(s+(null!==(n=1+(null==e?void 0:e.length))&&void 0!==n?n:0)).trim();return(0,c.pR)(o,i)||[]}var u=s(282144),p=s(463569),g=s(879586),h=s(929354),d=s(83222),m=s(596374);class y{constructor(e){var t,s,n,o;this.memoryPoints=new Set,this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now(),this.growthFrequencyThreshold=null!==(t=e.growthFrequencyThreshold)&&void 0!==t?t:5,this.shortTermWindow=null!==(s=e.shortTermWindow)&&void 0!==s?s:6e4,this.longTermGrowthThreshold=null!==(n=e.longTermGrowthThreshold)&&void 0!==n?n:.5,this.longTermWindow=null!==(o=e.longTermWindow)&&void 0!==o?o:288e5}recordMemoryUsage(e){const t=Date.now();0===this.memoryPoints.size&&(this.startMemorySize=e,this.startTimestamp=t),this.memoryPoints.add(e),this.memoryTimestamps.push(t),this.checkShortTermGrowths(t),this.checkLongTermGrowth(e,t)}checkShortTermGrowths(e){const t=e-this.shortTermWindow;for(;this.memoryTimestamps.length>0&&this.memoryTimestamps[0]<t;)this.memoryTimestamps.shift();const s=new Set(this.memoryTimestamps.map((t=>Array.from(this.memoryPoints).find((()=>-1!==this.memoryTimestamps.findIndex((s=>s>=t&&s<=e)))))).filter(Boolean));if(s.size>=this.growthFrequencyThreshold)throw new Error(`Potential memory leak detected: ${s.size} unique memory points in the last ${this.shortTermWindow/1e3} seconds.`)}checkLongTermGrowth(e,t){const s=t-this.startTimestamp;if(s>=this.longTermWindow){const n=(e-this.startMemorySize)/this.startMemorySize;if(n>this.longTermGrowthThreshold)throw new Error(`Potential memory leak detected: ${(100*n).toFixed(2)}% growth over ${(s/36e5).toFixed(2)} hours.`);this.startMemorySize=e,this.startTimestamp=t}}getUniqueMemoryPointCount(){return this.memoryPoints.size}getCurrentMemoryUsage(){return Array.from(this.memoryPoints).pop()}resetDetector(){this.memoryPoints.clear(),this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now()}}class T{constructor(e,t,s){var n,a;this.ariaNamespace="GraphSearch",this.prodAriaToken="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",this.devAriaToken="30d62489eb65462bb3a5c93b0cad786b-0260e5be-afb3-4f7c-a14a-f0b25b00a080-7662",this.isDisposed=!1,this.wasmConfig=s,this.propertyName=e,this.ariaToken=void 0!==t.environment&&t.environment===i.O.dev?this.devAriaToken:this.prodAriaToken;const r=t.scenarios&&t.scenarios.includes(o.Nz.BIZ_CHAT)?{getHeuristicIntents:l}:void 0;this.config={...t,...void 0===t.scenarioLength?{scenarioLength:t.scenarios.length}:{},heuristicIntentsConfig:r};const c=null!==(n=null==s?void 0:s.jsAssetName)&&void 0!==n?n:"GraphSearchLocalWorkflow.js",u=`${s.wasmRoot}/${c}`;this.wasmConfig={...void 0===s?{}:s,wasmRoot:u},t.enableMemoryLeakDetection&&(this.memoryLeakDetector=new y(null!==(a=t.memoryLeakDetectorConfig)&&void 0!==a?a:{}))}async init(e,t){var s;const o=this.startLogOperation("GraphSearchWorkflowInstance"===this.propertyName?"GraphSearchWorkflowInit":"GraphSearchJoinWorkflowInit",new Date);o.setDataFields({isPrefetch:this.config.prefetchOnly});try{await this.initializeWasmModule(this.wasmConfig.wasmRoot,this.wasmConfig.locateFile,this.wasmConfig.cacheModule,this.wasmConfig.wasmModuleCache,this.wasmConfig.scriptSrcSetter),this.logWasmStats(o),this.workflowLambda=this.wasmModule[this.propertyName](this.config);const s=t?(0,n.buildEmscriptenCustomContext)(t,(()=>this.wasmModule)):(0,n.buildEmscriptenCustomContextFromSite)(e,(()=>this.wasmModule));this.workflowLambda.init(s)}catch(e){const t=null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:"";o.resultDescription=e&&e.message?`${e.message} // ${t}`:"Unknown error.",o.success=!1}a.tG.info(507573794,a.nh.WorkflowDefault,o.stop())}executeWorkflowLambda(e,t,s,o,i){var r;let c=!1;if(!this.wasmModule||!this.workflowLambda)return e.resultDescription="null lambda",e.success=!1,a.tG.info(507564037,a.nh.WorkflowDefault,e.stop()),"GraphSearchWorkflowInstance"===this.propertyName?this.sendDummyAndTriggerServiceFallback(o,t):this.sendInputAnnotation(o,t,i),!1;try{const e=(0,n.buildEmscriptenCustomContext)(s,this.wasmModule);void 0===i?this.workflowLambda.execute(t,e,o):this.workflowLambda.execute(t,i,e,o)}catch(t){const s=null!==(r=null==t?void 0:t.stack)&&void 0!==r?r:"";e.resultDescription=t&&t.message?`${t.message} // ${s}`:"Unknown error.",e.success=!1,c=!0}return c}dispose(){this.isDisposed=!0,void 0!==this.workflowLambda&&this.workflowLambda.delete(),this.workflowLambda=void 0,this.wasmModule=void 0}async initializeWasmModule(e,t,s=!0,o,i){if(this.wasmModule=await(0,n.loadWasmWebFromModularizeFunction)(e,"createGSWLocalInstance","GraphSearchWorkflowWasm_Prefetch",s,t,o,i),this.isDisposed)throw new Error("Workflow was disposed while initializing WASM module")}startLogOperation(e,t,s){const n=new r.I({operationName:"GraphSearchWorkflowInstance"===this.propertyName?"graphsearchworkflow_ts":"graphsearchjoinworkflow_ts",success:!0,resultDescription:"",ariaTenant:this.ariaToken,ariaNamespace:this.ariaNamespace}).start();return n.setDataFields({msg:e,startTimestamp:t.toISOString(),inputCount:s?s.length:0}),n}logWasmStats(e){this.wasmModule&&e.setDataFields({version:this.wasmModule.version,sdkVersion:this.wasmModule.sdkVersion,wasmModuleHeapSize:this.wasmModule.HEAP8?this.wasmModule.HEAP8.buffer.byteLength:void 0}),this.config.enableMemoryLeakDetection&&this.wasmModule&&this.wasmModule.HEAP8&&this.memoryLeakDetector.recordMemoryUsage(this.wasmModule.HEAP8.buffer.byteLength)}sendDummyAndTriggerServiceFallback(e,t){if(g.VP.typeGuard(t)||u.Z5.typeGuard(t)){const s={ownerId:"GraphSearchClient",conversationId:t.conversationId,logicalId:t.logicalId,entityResults:[],status:h.i.Success},n=g.VP.typeGuard(t)?d.SM.getTypeName():p.J_.getTypeName();e.setAnnotations(t,n,[s],{immediate:!0}),e.submitSignals([new u.tE({cachedIntents:[],inputObject:t,entityTypesResolved:this.config.entityTypes})])}}sendInputAnnotation(e,t,s){void 0!==s&&s.length>0&&(d.SM.typeGuard(s[0])?this.sendEccInputAnnotation(e,t,s):p.J_.typeGuard(s[0])&&this.sendSearchSuggestionInputAnnotation(e,t,s))}sendEccInputAnnotation(e,t,s){if(void 0!==s&&s.length>0&&d.SM.typeGuard(s[0])){const n=new m.os({entityResults:s[0].entityResults,status:h.i.Success});e.setAnnotations(t,m.os.getTypeName(),[n],{immediate:!0})}}sendSearchSuggestionInputAnnotation(e,t,s){if(void 0!==s&&s.length>0&&p.J_.typeGuard(s[0])){const n=new p.VL({results:s[0].results,status:h.i.Success});e.setAnnotations(t,p.VL.getTypeName(),[n],{immediate:!0})}}}},837868:(e,t,s)=>{s.d(t,{M5:()=>o,M6:()=>c,XE:()=>r});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotResearchInputSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotInputSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaCopilotProgramResponseSignal"}static getBaseTypes(){return["AugLoop_Copilot_CopilotProgramResponseSignal","AugLoop_Copilot_SignalWithQueryId","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_UIStateSyncSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_InvokeSkillSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_InvokeResearchSkillSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_OperaCopilot_OperaValidateGptSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()}},839048:(e,t,s)=>{s.d(t,{P:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotWarmup_CopilotGetUserContextSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},839054:(e,t,s)=>{s.d(t,{Ml:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForBusinessChatAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForIntelligentSearchAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365TeamsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365AppsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CheckCopilotLicenseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForSharePointAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_PlannerPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingOnDemandAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsCopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotUserContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()}},844457:(e,t,s)=>{var n;s.d(t,{v:()=>n}),function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(n||(n={}))},868713:(e,t,s)=>{s.d(t,{W:()=>n});class n{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<i;e++)a[e]=o[Math.floor(Math.random()*o.length)];return a.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let s;return s=e.endsWith(".0")?new n(e.substring(0,e.length-2)):new n(e),t&&(s.childCount=t),s}newChild(){return++this.childCount,new n(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],i=22,a=new Array(i)},868773:(e,t,s)=>{s.d(t,{Z:()=>o});var n={util:{},roots:{default:{}}},o=(n.util,n.roots.default||(n.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.count=0,e.prototype.successes=0,e.prototype.failures=0,e.prototype.maxDurationMs=0,e.prototype.sumDurationMs=0,e.prototype.cancellations=0,e.prototype.failureBuckets="",e.prototype.firstFailureReason="",e.prototype.firstFailureImpact="",e.prototype.lastEventSource="",e.prototype.lastEventReason="",e.prototype.lastEventReasonDependency="",e.prototype.lastEventImpact="",e.prototype.lastEventSuccess=!1,e.prototype.lastEventDurationMs=0,e.prototype.lastEventCount=0,e.prototype.lastEventMessage="",e.prototype.lastEventAffectedWorkflows="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEventAggregation"},e}())},869495:(e,t,s)=>{var n;s.d(t,{i:()=>n}),function(e){e.choose_topic="choose_topic",e.choose_input_files="choose_input_files",e.generate_draft="generate_draft",e.review_draft="generate_review",e.define_objective="define_objective",e.choose_audience="choose_audience",e.publish_draft="publish_draft",e.generate_outline="generate_outline",e.generate_ppt="generate_ppt",e.generate_semantic_tree="generate_semantic_tree",e.generate_artifacts="generate_artifacts",e.summarize_semantic_tree="summarize_semantic_tree",e.generate_markdown="generate_markdown",e.multi_file_summary="multi_file_summary",e.multi_file_qna="multi_file_qna",e.multi_file_preview="multi_file_preview",e.sydney_query="sydney_query"}(n||(n={}))},879262:(e,t,s)=>{s.d(t,{r:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelRunScript_ExcelRunScriptResponseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},879586:(e,t,s)=>{s.d(t,{JM:()=>i,Qo:()=>o,VP:()=>r,sr:()=>a});var n=s(985002),o=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_Request"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionStartRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),i=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),a=(function(){function e(t){n.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),r=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},885920:(e,t,s)=>{s.d(t,{b:()=>o,u:()=>i});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ConditionalFormattingSuggestion_ConditionalFormattingSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_ConditionalFormattingSuggestion_ConditionalFormattingSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},886069:(e,t,s)=>{s.d(t,{$:()=>c});var n,o=s(301520),i=s(521409),a=s(743210),r=s(87477);!function(e){e.URL="URL",e.ArrayBuffer="ArrayBuffer"}(n||(n={}));class c{constructor(e,t,s,n){this.dbName="ALModels_db",this.osName="ALModels_os",this.dbVersion=2,this.modelPathsCache=new Map,this.isPolymerSupported=Boolean(s),this.baseURL=`https://${t}/web/${e}`,this.polymerBaseURL=this.isPolymerSupported?`https://${s}`:"",this.fetchResource=null!=n?n:"undefined"!=typeof fetch?fetch:r.fetch;const a=new o.I({operationName:"CreateModelDownloader",success:!0,resultDescription:""});a.start(),this.isBrowserIdbCompatible().then((e=>{if(e){let e,t=0,s=0,n=0;const o=new Promise(((t,s)=>{e=setTimeout((()=>{s(new Error("Took longer than 10000 ms"))}),1e4)})),i=this.accessDB().then((e=>{const o=e.transaction(this.osName,"readwrite");return o.objectStore(this.osName).openCursor().then((function e(i){if(n++,i){const n=i.value;let o;return n.timesSinceUsage||(n.timesSinceUsage=0),n.timesSinceUsage++,n.timesSinceUsage>5?(s++,o=i.delete()):(t++,o=i.update(n)),o.then((()=>i.continue())).then(e)}return o.done}))}));this.initPromise=Promise.race([o,i]).catch((e=>{a.success=!1,a.resultDescription+=`${e.message} `})).then((()=>{a.dimension0=`${n}`,a.dimension1=`${t}`,a.dimension2=`${s}`,clearTimeout(e),this.closeDBAndEndLog(a,"initializing idb storage")}))}else a.resultDescription="Incompatible browser for IDB",i.tG.info(538706242,i.nh.CoreDefault,a.stop())})).catch((()=>{a.resultDescription="Issue determining idb compatibility",i.tG.info(536966936,i.nh.CoreDefault,a.stop())}))}getResourceAsArrayBuffer(e,t,s){const i=new o.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:n.ArrayBuffer,dimension1:e,dimension2:t});i.start();const a={};return this.getResource(e,t,s,n.ArrayBuffer,i,(e=>Promise.all(Array.from(e.keys()).map((t=>{const s=e.get(t);return s.arrayBuffer?s.arrayBuffer().then((e=>{a[t]=e})):new Promise(((e,n)=>{const o=new FileReader;o.readAsArrayBuffer(s),o.onload=s=>{const o=s.target.result;o instanceof ArrayBuffer?(a[t]=o,e()):n(new Error("Unable to obtain ArrayBuffer"))}}))}))))).then((()=>a))}getKey(e,t,s){return s?`${e}_${t}_${JSON.stringify(Array.from(s.entries()))}`:`${e}_${t}`}updateCache(e,t,s,n){this.modelPathsCache.set(this.getKey(e,t,s),n)}getCache(e,t,s){return this.modelPathsCache.get(this.getKey(e,t,s))}getResourceAsURL(e,t,s){const i=new o.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:n.URL,dimension1:e,dimension2:t});i.start();const a={},r=this.getCache(e,t,s);return r?Promise.resolve(r):this.getResource(e,t,s,n.URL,i,(e=>Promise.all(Array.from(e.keys()).map((t=>{a[t]=URL.createObjectURL(e.get(t))}))))).then((()=>{const n=this.getCache(e,t,s);return n||(this.updateCache(e,t,s,a),a)}))}getResource(e,t,s,n,o,i){return this.getFiles(e,t,s,o).then((e=>i(e))).then((()=>{this.closeDBAndEndLog(o,`retrieving ${e}`)})).catch((t=>{throw o.resultDescription.indexOf(t.message)>=0&&(o.success=!1,o.resultDescription+=`${t.message} `),o.resultSignature=`Issue retrieving from CDN or translating to ${n}`,this.closeDBAndEndLog(o,`retrieving ${e}`),t}))}checkFirefoxCompatibility(e){const t=globalThis.navigator.userAgent.substring(e+8,e+11);return t.replace(".",""),parseInt(t,10)<=70?new Promise((function(e,t){const s=globalThis.indexedDB.open(this.dbName,this.dbVersion);s.onsuccess=function(){e(!0)},s.onerror=function(e){return t(e),!0}})):Promise.resolve(!0)}isBrowserIdbCompatible(){var e,t;return"undefined"==typeof Array||void 0===Array.from||"undefined"==typeof Proxy||"undefined"==typeof URL||void 0===URL.createObjectURL?Promise.resolve(!1):"undefined"!=typeof globalThis&&(null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent)?globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")>-1?globalThis.indexedDB?this.checkFirefoxCompatibility(globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")):Promise.resolve(!1):globalThis.navigator.userAgent.toLowerCase().indexOf("safari")>-1&&globalThis.navigator.userAgent.toLowerCase().indexOf("chrome")<=-1?(null===(t=globalThis.document)||void 0===t?void 0:t.hasStorageAccess)?globalThis.document.hasStorageAccess().then((()=>!0)).catch((()=>!1)):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)}accessDB(){return this.accessDBPromise?this.accessDBPromise.then((e=>e.transaction(this.osName).done)).then((()=>this.accessDBPromise)).catch((()=>this.callOpenDB())):this.callOpenDB()}callOpenDB(){return this.accessDBPromise=(0,a.P2)(this.dbName,this.dbVersion,{upgrade:e=>{e.objectStoreNames.contains(this.osName)&&e.deleteObjectStore(this.osName),e.createObjectStore(this.osName,{keyPath:"id",autoIncrement:!0})}})}endLog(e,t){e.success?(e.resultDescription=`Success ${t}`,i.tG.info(573329487,i.nh.CoreDefault,e.stop())):(e.resultDescription+=`error ${t}`,i.tG.error(573329488,i.nh.CoreDefault,e.stop()))}closeDBAndEndLog(e,t){this.accessDBPromise?this.accessDBPromise.then((e=>{e.close()})).catch((t=>{e.resultDescription.indexOf(t.message)>=0&&(e.success=!1,e.resultDescription+=`${t.message?t.message:"Error closing db"} `,e.resultSignature="Issue closing db")})).then((()=>{this.accessDBPromise=void 0,this.endLog(e,t)})):this.endLog(e,t)}getFiles(e,t,s,n){return this.isBrowserIdbCompatible().catch((e=>(n.success=!1,n.resultDescription+=`${e.message} `,n.resultSignature="Issue determining idb compatibility",!1))).then((o=>{const i=()=>{if(s){if(this.isPolymerSupported)return this.downloadFiles1CDN(e,t,s,n,o);throw new Error("Missing polymerBaseURL provided at host level for queries with modelFilters")}return this.downloadFiles(e,t,n,o)};return o?this.getFilesFromIDB(e,t,s,n).catch((e=>(e&&(n.resultDescription.indexOf(e.message)>=0&&(n.success=!1,n.resultDescription+=`${e.message} `),n.resultSignature="Issue retrieving from DB"),i()))):i()}))}getFilesFromIDB(e,t,s,n){return this.initPromise.catch((e=>{n.success=!1,n.resultDescription+=`${e.message} `,n.resultSignature="Issue initializing"})).then((()=>this.getModelOptions(e))).then((o=>{for(const i of o)if(i&&i.model&&i.version==t){if(!this.checkModelFiltersPass(s,i.filters))continue;return this.putModel(e,i.model,t,i.filters,n,i.id),Promise.resolve(i.model)}return Promise.reject()}))}checkModelFiltersPass(e,t){var s;for(const n of e){const e=null===(s=t.get(n[0]))||void 0===s?void 0:s.map((e=>e.toLocaleLowerCase()));if(!e)throw new Error(`Expected filter ${n[0]} to exist in metadata file`);if(e.indexOf(n[1].toLocaleLowerCase())<0)return!1}return!0}downloadFiles1CDN(e,t,s,n,o){let i;return n.dimension3="Polymer",s||(s=new Map),this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/metadata.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((o=>{var a,r;const c=JSON.parse(o);if(c.name!==e||c.version!==t)throw new Error(`Expected: ${e} version ${t}, received: ${c.name} version ${c.version}`);for(const e of c.variants)if(i=new Map(Object.entries(e)),this.checkModelFiltersPass(s,i))return(c.catalog?s.size+2:s.size+1!==i.size)&&(n.success=!1,n.resultDescription+=`Expected ${null===(a=i.keys)||void 0===a?void 0:a.length} # of filters, received ${null===(r=s.keys)||void 0===r?void 0:r.length}`),e.model_files;throw new Error("No model found with given filters")})).then((s=>Promise.all(s.map((s=>this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/${s}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((e=>[s,e]))))))).then((s=>{const a=new Map(s);return o?this.putModel(e,a,t,i,n):a}))}downloadFiles(e,t,s,n){return s.dimension3="FS",this.fetchResource(`${this.baseURL}/catalog_${e}_${t}.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((s=>{const n=JSON.parse(s),o=`${n.MajorVersion}.${n.MinorVersion}/ModelResources`,i=`${e}/${t}/`;return Promise.all(n.Resources.map((e=>(e.Name.length>i.length&&e.Name.substring(0,i.length)===i&&(e.Name=e.Name.substring(i.length)),this.fetchResource(`${this.baseURL}/${o}/${i}${e.Name}.${e.Type}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((t=>[`${e.Name}.${e.Type}`,t]))))))})).then((o=>{const i=new Map(o);return n?this.putModel(e,i,t,new Map,s):i}))}getModelOptions(e){return this.accessDB().then((t=>{const s=[],n=t.transaction(this.osName,"readonly");return n.objectStore(this.osName).openCursor().then((function t(o){if(o){const n=o.value;return n.modelId==e&&s.push(n),o.continue().then(t)}return n.done})).then((()=>s))}))}putModel(e,t,s,n,o,i){return n||(n=new Map),this.accessDB().then((o=>o.put(this.osName,{modelId:e,model:t,version:s,filters:n,timesSinceUsage:0},i))).catch((e=>{o.resultDescription.indexOf(e.message)>=0&&(o.success=!1,o.resultDescription+=`${e.message} `),o.resultSignature="Issue adding to DB"})).then((()=>t))}}},886556:(e,t,s)=>{var n,o;s.d(t,{E:()=>o,b:()=>n}),function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(n||(n={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"}(o||(o={}))},887571:(e,t,s)=>{var n,o;s.r(t),s.d(t,{EntityPrediction:()=>i.f4,FlagWithIntent:()=>i.NC,GraphIntentDetectionBaseSignal:()=>r,GraphIntentDetectionSignal:()=>c,GraphIntentPrefilterTriggered:()=>i.Xv,GraphIntentSuggestion:()=>i.N0,IntentConfidenceLevel:()=>n,IntentScope:()=>o,Prefetch:()=>i.aD,SystemInitiatedRequestSignalHybrid:()=>l,SystemInitiatedWithIntent:()=>i.hl,SystemInitiatedWithIntentBase:()=>i.ub,SystemInitiatedWithIntentClient:()=>i.iU,SystemInitiatedWithIntentHybrid:()=>i.Z8}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High"}(n||(n={})),function(e){e.FirstParty="FirstParty",e.ThirdParty="ThirdParty"}(o||(o={}));var i=s(199128),a=s(985002);class r{constructor(e){a.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return a.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{constructor(e){a.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionSignal"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return a.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{constructor(e){a.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedRequestSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return a.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},895460:function(e,t,s){var n=this&&this.__spreadArray||function(e,t,s){if(s||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.SequencedValueTracker=void 0;var o=s(745032),i=function(){function e(e){this.list=e?n([],e,!0):[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this.list.map((function(e){return e.seq}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this.list.map((function(e){return e.value}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){if(0!==this.list.length)return this.list[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){if(0!==this.list.length)return this.list[this.list.length-1]},enumerable:!1,configurable:!0}),e.prototype.clear=function(){o.Log.info(528794771,o.LogCategory.WorkflowDefault,"Clearing tracked values. Old length: ".concat(this.length)),this.list=[]},e.prototype.track=function(e,t){var s=this.list.find((function(t){return t.seq===e}));if(s){if(s.value===t)return;throw new Error("Cannot double-track the same sequence: #".concat(e,"! Previous value: ").concat(s.value,", new value: ").concat(t))}var n={seq:e,value:t};if(0===this.list.length||this.last.seq<e)this.list.push(n);else{var i=this.getIndexBefore(e);this.list.splice(i+1,0,n)}o.Log.info(528794772,o.LogCategory.WorkflowDefault,"track #".concat(e,': "').concat(t,'" (new length: ').concat(this.length,")"))},e.prototype.valueAt=function(e){if(null!=e)if(0!==this.list.length){var t=this.getIndexBefore(e);if(!(t<0))return o.Log.info(528794776,o.LogCategory.WorkflowDefault,"valueAt #".concat(e," - found: "),this.list[t]),this.list[t];o.Log.info(528794775,o.LogCategory.WorkflowDefault,"valueAt #".concat(e," - found nothing prior"))}else o.Log.info(528794774,o.LogCategory.WorkflowDefault,"valueAt #".concat(e," - nothing is tracked"));else o.Log.info(528794773,o.LogCategory.WorkflowDefault,"valueAt #".concat(e," - nothing is tracked"))},e.prototype.trimUntil=function(e,t){void 0===t&&(t=!1);var s=this.getIndexBefore(e);t&&s--,o.Log.info(528794777,o.LogCategory.WorkflowDefault,"trimUntil #".concat(e," - preserveLast:").concat(t,", removing up to idx: ").concat(s)),s>=0&&this.list.splice(0,s+1)},e.prototype.getIndexBefore=function(e){for(var t=this.list.length-1;t>=0&&this.list[t].seq>e;)t--;return t},e}();t.SequencedValueTracker=i},901039:(e,t,s)=>{s.r(t),s.d(t,{AnnotationMetaDataChange:()=>h.v,AnonymizedOperation:()=>v,CorrelationContext:()=>p,CorrelationVector:()=>l.W,CustomBlockListLogger:()=>ae,ExtensionCloseReason:()=>G,ExtensionCloseType:()=>M,HttpRequestQueue:()=>a,HttpSocketList:()=>k,Log:()=>n.tG,LogCategory:()=>n.nh,LoggingAggregator:()=>g.D,Operation:()=>o.I,OutboundHttpRequest:()=>E,PrivacyGuardIssue:()=>B,ProcessIdentification:()=>c,ScenarioStats:()=>S,SessionHealthEvent:()=>d.vf,SessionHealthEventAggregation:()=>T,SessionHealthImpact:()=>d.Pq,SessionHealthReason:()=>d.l6,SessionHealthSource:()=>d.aM,SessionIssue:()=>_,Timer:()=>w,argsToString:()=>n.am,createChildCorrelation:()=>X,enter:()=>K,excelExtensionCloseEventName:()=>D,excelExtensionExpectedCloseEventName:()=>O,excelExtensionExpectedErrorEventName:()=>x,excelExtensionUnexpectedCloseEventName:()=>F,excelKeepAliveAggregationName:()=>R,excelKeepAliveMessageName:()=>P,exit:()=>Q,getCorrelation:()=>Y,getCorrelationVectorString:()=>Z,getLastEnterCorrelationContext:()=>q,getLastExitCorrelationContext:()=>$,getNumLoggers:()=>n.OD,initAsyncHooks:()=>J,now:()=>ne.t,nowMicroSeconds:()=>ne.g,resumeCorrelation:()=>se,startChildCorrelation:()=>ee,startCorrelation:()=>te,tagIdToString:()=>n.ih});var n=s(521409),o=s(301520),i=s(130149);class a extends i.F{getMetrics(){return{HttpRequestQueueV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpRequestQueue"}}var r=s(19821);class c extends r.m{constructor(){super(...arguments),this.eventName="ProcessIdentification"}}var l=s(868713);class u{constructor(){this.ecsConfigIDsMap={},this.ecsConfigIDs=""}updateConfigIDs(e,t,s){const n=e=>Array.isArray(e)?e:"string"==typeof e?[e]:[],o=new Set,i=n(t);i.length>0?i.forEach((e=>o.add(e))):n(s).forEach((e=>o.add(e))),this.ecsConfigIDsMap[e]=Array.from(o),this.ecsConfigIDs=Object.values(this.ecsConfigIDsMap).flat().join(",")}getAllConfigIDsString(){return this.ecsConfigIDs}getConfigIDsMap(){return this.ecsConfigIDsMap}clear(){this.ecsConfigIDsMap={}}}class p{get sessionKey(){var e;return null===(e=this.sessionDescriptor)||void 0===e?void 0:e.sessionKey}get userTenantId(){var e,t;return null===(t=null===(e=this.sessionDescriptor)||void 0===e?void 0:e.userContext)||void 0===t?void 0:t.tid}get interactionSessionId(){return this._interactionSessionId}set interactionSessionId(e){if(this._interactionSessionId&&this._interactionSessionId!==e)throw new Error("InteractionSessionId is already set");this._interactionSessionId=e}get interactionId(){return this._interactionId}set interactionId(e){if(this._interactionId&&this._interactionId!==e)throw new Error("InteractionId is already set");this._interactionId=e}constructor(e,t,s,n){var o;this.cv=e,this.sessionDescriptor=t,this.clientMetadata=s,this.workflow=null==n?void 0:n.workflow,this.joinContextId=null==n?void 0:n.joinContextId,this.performanceEvent=null==n?void 0:n.performanceEvent,this.sessionLogsSampled=void 0,this._interactionId=null==n?void 0:n.interactionId,this._interactionSessionId=null==n?void 0:n.interactionSessionId,this.traceId=null==n?void 0:n.traceId,this.disableLogging=null!==(o=null==n?void 0:n.disableLogging)&&void 0!==o&&o,this.ecsConfigIDsManager=new u}static deserialize(e){var t,s;if(e)try{const n=JSON.parse(e),o={appName:n.clientAppName,appPlatform:n.clientAppPlatform,releaseAudienceGroup:n.clientReleaseAudienceGroup,flights:n.clientFlights},i=null!==(t=n.userContext)&&void 0!==t?t:{};return i.userDataBoundaryType=null!==(s=i.userDataBoundaryType)&&void 0!==s?s:n.userDataBoundaryType,new p(new l.W(n.cv),{sessionKey:n.sessionKey,userId:n.userId,mastermindEndpoint:n.mastermindEndpoint,userContext:i},o,{workflow:n.workflow,joinContextId:n.joinContextId,interactionId:n.interactionId,interactionSessionId:n.interactionSessionId,traceId:n.traceId,disableLogging:n.disableLogging})}catch(t){return new p(new l.W(e))}}static fromExisting(e,t,s,n,o){return new p(t||e.cv,s||e.sessionDescriptor,n||e.clientMetadata,{workflow:(null==o?void 0:o.workflow)||e.workflow,joinContextId:(null==o?void 0:o.joinContextId)||e.joinContextId,performanceEvent:(null==o?void 0:o.performanceEvent)||e.performanceEvent,interactionId:(null==o?void 0:o.interactionId)||e.interactionId,interactionSessionId:(null==o?void 0:o.interactionSessionId)||e.interactionSessionId,traceId:(null==o?void 0:o.traceId)||e.traceId,disableLogging:(null==o?void 0:o.disableLogging)||e.disableLogging})}toString(){var e,t;return`${null===(e=this.clientMetadata)||void 0===e?void 0:e.appName};${null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform};${this.sessionKey};${this.cv}`}serialize(){var e,t,s,n,o,i;const a=null===(e=this.clientMetadata)||void 0===e?void 0:e.appName,r=null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform,c=null===(s=this.clientMetadata)||void 0===s?void 0:s.releaseAudienceGroup,l=null===(n=this.clientMetadata)||void 0===n?void 0:n.flights,u=null===(o=this.sessionDescriptor)||void 0===o?void 0:o.userContext;return p.stringify(Object.assign(Object.assign({cv:this.cv.toString()},null!==(i=this.sessionDescriptor)&&void 0!==i?i:{}),{clientAppName:a,clientAppPlatform:r,clientReleaseAudienceGroup:c,clientFlights:l,workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId,disableLogging:this.disableLogging,userContext:{tid:null==u?void 0:u.tid,oid:null==u?void 0:u.oid,userDataBoundaryType:null==u?void 0:u.userDataBoundaryType},userDataBoundaryType:null==u?void 0:u.userDataBoundaryType}))}newChild(){return new p(this.cv.newChild(),this.sessionDescriptor,this.clientMetadata,{workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId,disableLogging:this.disableLogging})}}p.schema={type:"object",properties:{cv:{type:"string"},clientAppName:{type:"string"},clientAppPlatform:{type:"string"},clientReleaseAudienceGroup:{type:"string"},clientFlights:{type:"string"},sessionKey:{type:"string"},userId:{type:"string"},mastermindEndpoint:{type:"string"},workflow:{type:"string"},joinContextId:{type:"string"},interactionId:{type:"string"},interactionSessionId:{type:"string"},traceId:{type:"string"},disableLogging:{type:"boolean"},userDataBoundaryType:{type:"number"},userContext:{type:"object",properties:{tid:{type:"string"},oid:{type:"string"},userDataBoundaryType:{type:"number"}}}}},p.stringify=(p.schema,JSON.stringify);var g=s(257612),h=s(534342),d=s(813373),m=s(868773);const y=(e,t)=>"reason"===e?d.l6[t]:"impact"===e?d.Pq[t]:t;class T extends m.Z{constructor(e,t){super({sessionHealthEventName:e,count:t.count,successes:t.successes,failures:t.failures,cancellations:t.cancellations,maxDurationMs:t.maxDurationMs,sumDurationMs:t.sumDurationMs,failureBuckets:JSON.stringify(t.failureBuckets,y),firstFailureReason:t.failureBuckets.length>0?d.l6[t.failureBuckets[0].reason]:"",firstFailureImpact:t.failureBuckets.length>0?d.Pq[t.failureBuckets[0].impact]:""}),this.eventName="SessionHealthAggregation",t.lastEvent&&(this.lastEventAffectedWorkflows=t.lastEvent.affectedWorkflows,this.lastEventCount=t.lastEvent.count,this.lastEventDurationMs=t.lastEvent.durationMs,this.lastEventImpact=t.lastEvent.impact,this.lastEventMessage=t.lastEvent.message,this.lastEventReason=t.lastEvent.reason,this.lastEventReasonDependency=t.lastEvent.reasonDependency,this.lastEventSource=t.lastEvent.source,this.lastEventSuccess=t.lastEvent.success)}}var f=s(537491);class _ extends f.Q{getMetrics(){return{"SessionIssue.CountV2":{dimensionNames:()=>_.dimensionNames,dimensionValues:this.getDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="SessionIssue",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.modelItemsCountBucket,this.healthBucket,this.healthReason,this.healthSubreason,this.affectedResource,this.affectedSessions,this.suppressionReason]}}_.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ModelItemsCountBucket","HealthBucket","HealthReason","HealthSubreason","AffectedResource","AffectedSessions","SuppressionReason"];var C=s(222699);class S extends C.A{getMetrics(){return{"ScenarioStats.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getDimensionValues(),value:1},"ScenarioStatsWithSuppressions.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getSuppressionsDimensionValues(),value:1},"ScenarioStatsScenario.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getScenarioDimensionValues(),value:1},"ScenarioStatsScenarioWithSuppressions.CountV2":{dimensionNames:()=>S.dimensionNames,dimensionValues:this.getScenarioSuppressionsDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="ScenarioStats",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucket,this.healthReason]}getSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucketWithSuppressions,this.healthReasonWithSuppressions]}getScenarioDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucket,this.scenarioHealthReason]}getScenarioSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucketWithSuppressions,this.scenarioHealthReasonWithSuppressions]}}S.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","HealthBucket","HealthReason"];var A=s(240633);class v extends A.O{constructor(e){if(super(e),this.eventName="AnonymizedOperation",this.allowListedLogs=[508856344,508688156],!this.allowListedLogs.includes(e.tagId))throw new Error("AnonymizedOperations must be allow-listed and reviewed by AugLoop engineering team. Please include your privacy approval in the review.")}}var I=s(72715);class w{constructor(e){null==e?this.reset():this.start=e}diffInMs(){const e=I.hrtime(this.start),t=1e3*e[0]+e[1]/1e6;return Math.floor(t)}diffInUs(){const e=I.hrtime(this.start),t=1e6*e[0]+e[1]/1e3;return Math.floor(t)}reset(){this.start=I.hrtime()}}var N=s(538194);class E extends N.g{getMetrics(){return{"OutboundHttpRequestV2.Wait":{dimensionNames:()=>E.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.wait},"OutboundHttpRequestV2.DNS":{dimensionNames:()=>E.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.dns},"OutboundHttpRequestV2.TCP":{dimensionNames:()=>E.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.tcp},"OutboundHttpRequestV2.FirstByte":{dimensionNames:()=>E.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.firstByte},"OutboundHttpRequestV2.Download":{dimensionNames:()=>E.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.download},"OutboundHttpRequestV2.Total":{dimensionNames:()=>E.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.total}}}constructor(e){super(e),this.eventName="OutboundHttpRequest"}getDimensionValues(){return[this.host,this.statusCode,this.success]}}E.dimensionNames=["Host","StatusCode","Success"];var b=s(103694);class k extends b.k{getMetrics(){return{HttpSocketListV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpSocketList"}}var M,L=s(221777);class B extends L.F{constructor(e){super(e),this.eventName="PrivacyGuardIssue"}}!function(e){e.UnexpectedClose="UnexpectedClose",e.ExpectedClose="ExpectedClose",e.ExpectedError="ExpectedError"}(M||(M={}));const D="ExcelExtensionClose",P="ExcelKeepAlive",R=`ProcessMessage_${D}`,O=`${D}_${M[M.ExpectedClose]}`,x=`${D}_${M[M.ExpectedError]}`,F=`${D}_${M[M.UnexpectedClose]}`;var G;!function(e){e[e.Unknown=0]="Unknown",e[e.SessionClosedOutside=1]="SessionClosedOutside",e[e.EcsProxyFailedToFetchWorkbookMetadata=2]="EcsProxyFailedToFetchWorkbookMetadata",e[e.EcsProxyFailedToRequestWaitForWorkbookChange=3]="EcsProxyFailedToRequestWaitForWorkbookChange",e[e.EcsProxyReconnect=4]="EcsProxyReconnect",e[e.EcsProxyUnexpected=5]="EcsProxyUnexpected",e[e.EcsSessionClosedNotification=6]="EcsSessionClosedNotification",e[e.SessionIdle=7]="SessionIdle",e[e.FailedToProducePubSubMessage=8]="FailedToProducePubSubMessage",e[e.FailedToSetSessionData=9]="FailedToSetSessionData",e[e.FailedToGetSessionData=10]="FailedToGetSessionData",e[e.ReachUnexpectedCode=11]="ReachUnexpectedCode",e[e.RequestIdMismatch=12]="RequestIdMismatch",e[e.SeedingNotRequired=13]="SeedingNotRequired",e[e.ShortAccessTokenTTLReconnect=14]="ShortAccessTokenTTLReconnect",e[e.ModelActivationWithNullRestURL=15]="ModelActivationWithNullRestURL",e[e.InvalidExcelRestUrl=16]="InvalidExcelRestUrl"}(G||(G={}));let W=new p(new l.W);const H=[];let U;const q=()=>U;let V;const $=()=>V,j=new Map;let z;const K=e=>{H.push(W),W=e,U=e},Q=e=>{if(V=e,W===e)return void(W=H.pop());const t=H.lastIndexOf(e);if(t<0)throw new Error("Context not found");if(0===t)throw new Error("Cannot remove top context");H.splice(t,1)},J=e=>{z||(z=e.createHook({init(t){const s=Y();if(s)j.set(t,s);else if(0===e.executionAsyncId()){const s=e.triggerAsyncId(),n=j.get(s);n&&j.set(t,n)}},before(e){const t=j.get(e);t&&K(t)},after(e){const t=j.get(e);t&&Q(t)},destroy(e){j.delete(e)}}),z.enable())},Y=()=>W,Z=()=>W&&W.cv&&W.cv.toString()||null,X=()=>{var e,t;return new p((null===(e=null==W?void 0:W.cv)||void 0===e?void 0:e.newChild())||new l.W,null==W?void 0:W.sessionDescriptor,null==W?void 0:W.clientMetadata,{workflow:null==W?void 0:W.workflow,joinContextId:null==W?void 0:W.joinContextId,performanceEvent:null==W?void 0:W.performanceEvent,interactionId:null==W?void 0:W.interactionId,interactionSessionId:W.interactionSessionId,traceId:null==W?void 0:W.traceId,disableLogging:null!==(t=null==W?void 0:W.disableLogging)&&void 0!==t&&t})},ee=e=>{const t=X();return se((t=>e(t&&t.cv||void 0)),t)},te=(e,t,s,n,o)=>{const i=new p(t&&l.W.fromString(t)||(null==W?void 0:W.cv)||new l.W,s||(null==W?void 0:W.sessionDescriptor),n||(null==W?void 0:W.clientMetadata),{workflow:(null==o?void 0:o.workflow)||(null==W?void 0:W.workflow),joinContextId:(null==o?void 0:o.joinContextId)||(null==W?void 0:W.joinContextId),performanceEvent:(null==o?void 0:o.performanceEvent)||(null==W?void 0:W.performanceEvent),interactionId:(null==o?void 0:o.interactionId)||(null==W?void 0:W.interactionId),interactionSessionId:(null==o?void 0:o.interactionSessionId)||(null==W?void 0:W.interactionSessionId),traceId:(null==o?void 0:o.traceId)||(null==W?void 0:W.traceId),disableLogging:(null==o?void 0:o.disableLogging)||(null==W?void 0:W.disableLogging)||!1});return se(e,i)},se=(e,t)=>{K(t);try{return e(t)}finally{Q(t)}};var ne=s(230529),oe=s(270314),ie=s(72715);class ae{constructor(e,t,s,n,o=5,i){this.severity=e,this.resourceId=t,this.tokenExpirationInMS=s,this.idleDurationInMS=n,this.kAnonUser=o,this.log=i,this.cache=new oe.l({idleDurationMs:this.idleDurationInMS,sweepInterval:6e4}),this.kAnonUser=Math.min(5,this.kAnonUser),this.log=i||this.logHits}updateTokenCount(e,t,s){this.flush();const n=Date.now(),o=this.cache.get(e);if(!o)return void this.cache.put(e,{users:[{userId:t,timestamp:n,count:s}]},this.tokenExpirationInMS);const i=o.users.find((e=>e.userId===t));if(i)i.timestamp=n,i.count+=s;else if(o.users.push({userId:t,timestamp:n,count:s}),o.users.length>=this.kAnonUser){const t=o.users.reduce(((e,t)=>e+t.count),0);this.cache.del(e),this.log(e,t)}}logHits(e,t){n.tG.info(508688156,n.nh.CoreSystem,new v({operationName:"BlocklistMatchEvent",key:e,value:t+"",datafield0:this.severity,datafield1:this.resourceId,buildVersion:ie.env.BUILD_BUILDNUMBER||"DEV",tagId:508688156}))}flush(){this.cache.forEach((e=>{e.users=e.users.filter((e=>Date.now()<e.timestamp+this.tokenExpirationInMS))}))}getCount(e){this.flush();const t=this.cache.get(e);return t?t.users.reduce(((e,t)=>e+t.count),0):0}shutdown(){this.cache.clear(),this.cache=void 0}}},905869:(e,t,s)=>{var n,o,i,a;s.d(t,{bx:()=>n,lb:()=>o,xv:()=>i}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(n||(n={})),function(e){e[e.NotificationOnly=0]="NotificationOnly",e[e.Delete=1]="Delete",e[e.Ignore=2]="Ignore",e[e.IgnoreAll=4]="IgnoreAll",e[e.IgnoreCritiqueType=8]="IgnoreCritiqueType",e[e.AddToDictionary=16]="AddToDictionary",e[e.ShowDetails=32]="ShowDetails"}(o||(o={})),function(e){e[e.None=0]="None",e[e.ChangeOnce=1]="ChangeOnce",e[e.ChangeAll=2]="ChangeAll",e[e.AutoCorrect=4]="AutoCorrect",e[e.ReadAloud=8]="ReadAloud",e[e.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"}(i||(i={})),function(e){e[e.None=0]="None",e[e.CAT_Spelling=1]="CAT_Spelling",e[e.CAT_Grammar=2]="CAT_Grammar",e[e.CAT_Clarity=3]="CAT_Clarity",e[e.CAT_Conciseness=4]="CAT_Conciseness",e[e.CAT_Formality=5]="CAT_Formality",e[e.CAT_Inclusiveness=6]="CAT_Inclusiveness",e[e.CAT_PunctuationConventions=7]="CAT_PunctuationConventions",e[e.CAT_Resume=8]="CAT_Resume",e[e.CAT_SensitiveGeopoliticalReferences=9]="CAT_SensitiveGeopoliticalReferences",e[e.CAT_Vocabulary=10]="CAT_Vocabulary",e[e.CAT_ConsistentWrittenForms=11]="CAT_ConsistentWrittenForms",e[e.CAT_ErrorCorrections=12]="CAT_ErrorCorrections",e[e.CAT_WritingConventions=13]="CAT_WritingConventions",e[e.CAT_Acronyms=14]="CAT_Acronyms",e[e.CAT_Perspectives=15]="CAT_Perspectives",e[e.CAT_UncommonWords=16]="CAT_UncommonWords",e[e.CAT_TypingErrors=17]="CAT_TypingErrors",e[e.CAT_Rewrite=18]="CAT_Rewrite"}(a||(a={}))},907449:(e,t,s)=>{s.d(t,{L:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ObservationalAssistanceAction_OAActionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},915814:(e,t,s)=>{s.d(t,{v:()=>o});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_ExcelIntelligence_ExcelIntelligenceTableSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},917853:(e,t,s)=>{var n,o,i,a,r,c,l,u,p,g;s.d(t,{E6:()=>a,Nm:()=>l,O2:()=>r,ck:()=>u}),function(e){e.Unknown="Unknown",e.File="File",e.Folder="Folder",e.Attachment="Attachment",e.Link="Link"}(n||(n={})),function(e){e.Unknown="Unknown",e.SharepointOnline="SharepointOnline",e.ModernAttachment="ModernAttachment",e.ClassicAttachment="ClassicAttachment",e.EmailLink="EmailLink",e.OneDriveForBusiness="OneDriveForBusiness"}(o||(o={})),function(e){e.Unknown="Unknown",e.DownloadableUrl="DownloadableUrl",e.ReaderUrl="ReaderUrl"}(i||(i={})),function(e){e.Person="Person",e.Group="Group",e.Other="Other"}(a||(a={})),function(e){e.OrganizationUser="OrganizationUser",e.OrganizationContact="OrganizationContact",e.PersonalContact="PersonalContact",e.ImplicitContact="ImplicitContact",e.ChatImplicitContact="ChatImplicitContact",e.Room="Room",e.Guest="Guest",e.UnifiedGroup="UnifiedGroup",e.PublicDistributionList="PublicDistributionList",e.PersonalDistributionList="PersonalDistributionList"}(r||(r={})),function(e){e.None="None",e.Organizer="Organizer",e.TentativelyAccepted="TentativelyAccepted",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(c||(c={})),function(e){e.Membership="Membership",e.Address="Address",e.Invalid="Invalid"}(l||(l={})),function(e){e.Message="Message",e.Email="Email",e.Conversation="Conversation",e.Document="Document",e.Keywords="Keywords",e.People="People",e.Bookmark="Bookmark",e.Building="Building",e.EditorialQnA="EditorialQnA",e.Floorplan="Floorplan",e.Flight="Flight",e.Acronym="Acronym",e.TuringQnA="TuringQnA",e.Task="Task",e.External="External",e.Topic="Topic",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Report="Report",e.Streams="Streams",e.Group="Group",e.Site="Site",e.Team="Team",e.Chat="Chat",e.Channel="Channel",e.Link="Link",e.EmployeeOffer="EmployeeOffer",e.Fact="Fact",e.Text="Text",e.Event="Event",e.File="File",e.SharePoint="SharePoint",e.Attachment="Attachment",e.PIM="PIM",e.MessageExtensionApp="MessageExtensionApp",e.Scope="Scope",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(u||(u={})),function(e){e.Off="Off",e.Forward="Forward",e.Reverse="Reverse"}(p||(p={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning"}(g||(g={}))},919450:(e,t,s)=>{s.d(t,{Y:()=>c});var n,o=s(521409),i=s(301520),a=s(784567),r=s(339297);!function(e){e[e.ExceedingMaxSize=0]="ExceedingMaxSize",e[e.GroupComplete=1]="GroupComplete",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(n||(n={}));class c{constructor(e,t,s,n,o){this.batchesByGroupingKey=new Map,this.getOrderOfMagnitudeDimension=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,this.submit=e,this.onSummary=n,this.reduceBatchOperationsEnabled=t,this.batchMessagesEnabled=s,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=o}addBatchItem(e,t,s,i,a,r){const{delayMs:c,delayMsMax:l,maxInputSize:u,estimateSize:p,groupingKeyExtractor:g}=t,h=p(e),d=g(e);if(t.split&&h>u){let n;try{n=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(r?r(t):o.tG.error(573366352,o.nh.CoreDefault,t))}if(n&&Array.isArray(n.inputs)&&n.inputs.length>1){let e;const o=[],c=r?(t,s)=>{if(e=e||t,o.push(s),o.length===n.inputs.length){let s;try{s=n.join(o)}catch(t){return void r(new Error("Join error: "+t.message))}r(e,s)}}:void 0;for(let e=0;e<n.inputs.length;e++){const o=n.inputs[e];this.addBatchItem(o,t,s,i,a&&e===n.inputs.length-1,c)}return}}let m=this.batchesByGroupingKey.get(d);if(m&&m.size+h>u&&(this.executeBatch(d,m,t,n.ExceedingMaxSize),m=void 0),m||(m={items:[],size:0,hasItemsWithCallbacks:!1,context:s,creationTime:Date.now()},this.batchesByGroupingKey.set(d,m)),this.batchMessagesEnabled){const t=m.items[m.items.length-1];t&&t.cv===i&&t.callback===r?(t.input=[...t.input,...e],t.size+=h):m.items.push({input:e,size:h,cv:i,callback:r})}else m.items.push({input:e,size:h,callback:r});m.size+=h,m.hasItemsWithCallbacks=m.hasItemsWithCallbacks||!!r,this.batchMessagesEnabled||(m.cv=i),m.groupComplete=a,m.groupComplete?this.executeBatch(d,m,t,n.GroupComplete):(Date.now()-m.creationTime+c<l&&(clearTimeout(m.timeout),m.timeout=void 0),m.timeout||(m.timeout=setTimeout((()=>{this.executeBatch(d,m,t,n.BatchIntervalElapsed)}),c)))}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}reduceBatchOperations(e){const t=new i.I({operationName:"ReduceBatchOperations"}).start();let s=0,n=0,r=0;const c=new Set,l=[],u=(e,t)=>e.parentPath.toString()+"/"+e.parentRevId+"/"+t.id;for(const t of e.input.reverse()){const e=[];for(const o of t.input.reverse())if(a.fZ.typeGuard(o)){const t=[];for(const e of o.items){r++;const i=u(o,e);c.has(i)?n++:(t.push(e),c.add(i),s++)}0!==t.length&&(o.items=t,e.push(o))}else if(a.Xr.typeGuard(o)){for(const e of o.items){const t=u(o,e);c.delete(t)}e.push(o)}else e.push(o);0!==e.length&&l.push({input:e.reverse(),size:t.size,cv:t.cv,callback:t.callback})}e.input=l.reverse(),0!=r&&(t.dimension0=`${this.getOrderOfMagnitudeDimension(n)}`,t.dimension1=`noOp: ${0===n}`),t.success=r-n==s,o.tG.info(507839488,o.nh.CoreDefault,t.stop())}maxNumberOfDeltaUpdateOpsPerItemPerBatch(e){const t=(e,t)=>e.parentPath.toString()+"/"+t.id;let s=0;const n=new Map;for(const o of e.input)if(a.xU.typeGuard(o))for(const e of o.items){const i=t(o,e);n.has(i)||n.set(i,0),n.set(i,n.get(i)+1),s=Math.max(s,n.get(i))}return s}executeBatch(e,t,s,n){clearTimeout(t.timeout),t.timeout=void 0,this.batchesByGroupingKey.delete(e);const a=t.items,c=new i.I({operationName:"ExecuteBatch",cv:this.batchMessagesEnabled?"":t.cv,resourceId:t.context.name,resultDescription:`batching duration: ${Date.now()-t.creationTime}ms`,dimension0:`${this.batchMessagesEnabled?"Batched items count":"Batched ops count:"} ${this.getOrderOfMagnitudeDimension(a.length)}`,dimension1:`Size ${this.getOrderOfMagnitudeDimension(t.size)}`,dimension2:n.toString()}).start(),l=(e,s,n)=>{let i;if(s&&s.exceptionType===r.K.NoOutput)c.success=!0,o.tG.info(573366353,o.nh.CoreDefault,c.stop());else{const n=`${e} error: ${s?s.message||s:"Unknown error"}`;i=s||new Error(n),c.success=!1,c.resultDescription=`Batch of ${a.length} items of size ${t.size} with ${n}`,c.resultSignature=`${e} Error`,o.tG.error(573366354,o.nh.CoreDefault,c.stop())}if(t.hasItemsWithCallbacks)for(const e of a)e.callback&&e.callback(i,n)};let u;try{u=s.multiplex(this.batchMessagesEnabled?a:a.map((e=>e.input)))}catch(e){return void l("Multiplex",e)}this.reduceBatchOperationsEnabled&&this.batchMessagesEnabled&&"operations"==e&&this.reduceBatchOperations(u),!this.batchMessagesEnabled&&"operations"==e&&this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled&&(c.dimension3=this.getOrderOfMagnitudeDimension(this.maxNumberOfDeltaUpdateOpsPerItemPerBatch(u))),this.submit(u.input,t,((e,n)=>{if(e||n&&("exceptionType"in n||n instanceof Error))l("Submit",e||n,n);else if(t.hasItemsWithCallbacks||s.summaryExtractor){let i,r,p;if(t.hasItemsWithCallbacks)try{if(i=u.demultiplex(n),i.length!==a.length)throw new Error("Mismatched output length")}catch(e){return void l("Demultiplex",e)}if(s.summaryExtractor)try{[p,r]=s.summaryExtractor(n)}catch(e){return void l("SummaryExtractor",e)}if(c.success=!0,o.tG.info(573366342,o.nh.CoreDefault,c.stop()),t.hasItemsWithCallbacks)for(let e=0;e<a.length;e++)a[e].callback&&a[e].callback(void 0,i[e]);r&&this.onSummary(p,r,t.context)}else c.success=!0,o.tG.info(573366343,o.nh.CoreDefault,c.stop())}))}}},923844:(e,t,s)=>{var n,o,i,a;s.d(t,{Ay:()=>o,VF:()=>n,XO:()=>i,b:()=>a}),function(e){e.CopilotChatResponseMeta="CopilotChatResponseMeta",e.DocumentGroundingMeta="DocumentGroundingMeta",e.ElseResponseMeta="ElseResponseMeta",e.FormulaResponseMeta="FormulaResponseMeta"}(n||(n={})),function(e){e.OK="OK",e.ServiceTimeout="ServiceTimeout",e.ServiceError="ServiceError",e.RAICheckFailed="RAICheckFailed",e.FormulaError="FormulaError",e.ExternalWorkbookFormulaError="ExternalWorkbookFormulaError",e.SecurityBlockedFormulaError="SecurityBlockedFormulaError",e.SearchAndActionNotAllowed="SearchAndActionNotAllowed",e.OutOfCredit="OutOfCredit",e.ImageChatChainingNotAllowed="ImageChatChainingNotAllowed"}(o||(o={})),function(e){e.OK="OK",e.ServiceTimeout="ServiceTimeout",e.ServiceError="ServiceError",e.RAICheckFailed="RAICheckFailed",e.Unknown="Unknown"}(i||(i={})),function(e){e.Started="Started",e.OK="OK",e.Unsuccessful="Unsuccessful",e.FallbackToElse="FallbackToElse",e.ServiceTimeout="ServiceTimeout",e.ServiceError="ServiceError"}(a||(a={}))},928917:(e,t,s)=>{s.d(t,{Q:()=>o,s:()=>i});var n=s(985002);class o{constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},929354:(e,t,s)=>{var n;s.d(t,{i:()=>n}),function(e){e[e.Success=0]="Success",e[e.NoResults=1]="NoResults",e[e.Cancelled=2]="Cancelled",e[e.Timeout=3]="Timeout",e[e.UnexpectedError=4]="UnexpectedError",e[e.EarlyExit=5]="EarlyExit"}(n||(n={}))},934189:(e,t,s)=>{s.d(t,{H6:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppAnnotation"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppStreamingAnnotation"}static getBaseTypes(){return["AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppAnnotation","AugLoop_Copilot_CopilotOutputAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_OfficeaiIncubationApp_OfficeaiIncubationAppCopilotChatHistoryAnnotation"}static getBaseTypes(){return["AugLoop_CopilotChatHistory_FluxCopilotChatHistoryAnnotation","AugLoop_CopilotChatHistory_CopilotChatHistoryAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},942449:(e,t,s)=>{s.d(t,{KJ:()=>o,Ob:()=>i,pK:()=>r});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorStreamCompletionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_DynamicQuestionGenerator_DynamicQuestionGeneratorSuggestedQnAAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},951644:(e,t,s)=>{s.d(t,{nL:()=>p});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class m{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class T{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class f{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class _{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Text_TextStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()}},958395:(e,t,s)=>{s.d(t,{TE:()=>_});var n=s(50233),o=s(596374),i=s(929354),a=s(735875),r=s(974428),c=s(521409),l=s(452367),u=s(607915);const p=new Map([[n.c.People,1300],[n.c.PeopleInGroup,1250],[n.c.File,1200],[n.c.Event,1100],[n.c.Message,1e3],[n.c.Chat,920],[n.c.Team,910],[n.c.Channel,900],[n.c.MessageExtensionApp,800],[n.c.External,700],[n.c.Topic,600],[n.c.Loop,500],[n.c.Address,400],[n.c.Scope,100],[n.c.App,90],[n.c.Prompt,85],[n.c.CopilotPlugin,80]]),g=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,h=e=>{const t=p.get(e);return void 0===t?(c.tG.error(509743565,c.nh.WorkflowDefault,`unsupported entity type:'${e}'`),1):t},d=(e,t)=>{const s=h(e.entityType),n=h(t.entityType);return s===n?(c.tG.warn(509743564,c.nh.WorkflowDefault,`unexpected priority:'${e.entityType}','${t.entityType}'`),e.entityType.localeCompare(t.entityType)):n-s},m=(e,t,s)=>{t||c.tG.warn(e,c.nh.WorkflowDefault,s)};class y{constructor(){this.seqCounter=0,this.seqCounter=0}async init(e){this.seqCounter=0}async execute(e,t,s,n){const i=(new Date).toISOString();c.tG.info(524066818,c.nh.WorkflowDefault,`Executing oa-client client-server ranker workflow. sequence number : ${this.seqCounter}`),this.seqCounter++;const a=(0,l.K)("Ranker_Ecc",s).start(),r=this.getRankedResults(t,a);r&&n.setAnnotations(e,o.c$.getTypeName(),[r]);const u=(new Date).toISOString();a.setDataFields({startTimeStamp:i,endTimeStamp:u}),c.tG.info(512500928,c.nh.WorkflowDefault,a.stop()),n.done()}dispose(){this.seqCounter=0}getRankedResults(e,t){var s,n,a,r,l,p,h,y,T,f,_,C;if(0===e.length||this.seqCounter<0)return t.success=!1,t.resultDescription="oa-client-server ecc result ranker lambda has no inputs",void c.tG.warn(524066819,c.nh.WorkflowDefault,t.resultDescription);if(e.length>2)return t.success=!1,t.resultDescription="Unexpected. Client-server ranker can never have more than 2 inputs",void c.tG.warn(523854672,c.nh.WorkflowDefault,t.resultDescription);const S=null!==(n=null===(s=e[0])||void 0===s?void 0:s.conversationId)&&void 0!==n?n:"",A=null!==(r=null===(a=e[0])||void 0===a?void 0:a.logicalId)&&void 0!==r?r:"";if(t.setDataFields({conversationId:S,logicalId:A}),0===(e=e.filter((e=>e.status!==i.i.EarlyExit))).length)return t.success=!0,t.resultDescription="oa-client-server ecc result ranker skipping execution due to receiving early-exit annotations only",void c.tG.warn(509112707,c.nh.WorkflowDefault,t.resultDescription);const v=e.length.toString(),I=e.map((e=>e.ownerId)).join(";");let w;if(t.setDataFields({providerCount:v,souces:I}),1===e.length&&e[0].entityResults)w=new o.c$({conversationId:S,entityResults:e[0].entityResults,logicalId:A,status:e[0].status,treatments:e[0].treatments});else{const t=new Map,s=e[0].entityResults.length>=e[1].entityResults.length?0:1,n=(s+1)%2,a=new Set,r=e[s];for(let s=0;s<r.entityResults.length;++s){const o=r.entityResults[s],i=o.entityType;a.add(i);const c=o.entities,l=e[n];let u=o.modelInfo,p=c,g=r.entityResults[s].intent;for(let e=0;e<l.entityResults.length;++e){const t=l.entityResults[e];if(i===t.entityType){const s=l.entityResults[e].intent;s&&(g=Math.max(null!=g?g:0,s)),p=this.getDeDupedEntityList(c,t.entities),u=this.getMergedModelInfo(o.modelInfo,t.modelInfo);break}}const h={entities:p,entityType:i,modelInfo:u,intent:g};t.set(i,h)}const v=e[n];for(let e=0;e<v.entityResults.length;++e){const s=v.entityResults[e],n=s.entityType;a.has(n)||t.set(n,s)}const I=Array.from(t.values()).sort(d),N=[];let E=[],b=!1;if((0,u.I)("UseLocallyGeneratedBM")&&(null===(l=null==r?void 0:r.entityResults)||void 0===l?void 0:l.length)>0&&"GraphSearchClient"===(null==r?void 0:r.ownerId)&&(null===(h=null===(p=null==r?void 0:r.treatments)||void 0===p?void 0:p.bestMatchEntries)||void 0===h?void 0:h.length)>0)E=r.treatments.bestMatchEntries;else if((0,u.I)("UseLocallyGeneratedBM")&&(null===(y=null==v?void 0:v.entityResults)||void 0===y?void 0:y.length)>0&&"GraphSearchClient"===(null==v?void 0:v.ownerId)&&(null===(f=null===(T=null==v?void 0:v.treatments)||void 0===T?void 0:T.bestMatchEntries)||void 0===f?void 0:f.length)>0)E=v.treatments.bestMatchEntries;else{const e=null===(_=null==r?void 0:r.treatments)||void 0===_?void 0:_.bestMatchEntries,t=null===(C=null==v?void 0:v.treatments)||void 0===C?void 0:C.bestMatchEntries;if(e)for(let t=0;t<e.length;t++)N.push(e[t]);if(t)for(let e=0;e<t.length;e++)N.push(t[e]);E=N.sort(((e,t)=>g(t.confidence)-g(e.confidence))).sort(d).slice(0,3),b=((e,t)=>{var s;const n=null===(s=t.find((e=>e.entities.length>0)))||void 0===s?void 0:s.entityType,o=n&&!e.some((e=>e.entityType!=n));return o&&c.tG.info(509662157,c.nh.WorkflowDefault,"Best Match results suppressed"),o})(E,I)}m(520135894,(null==r?void 0:r.conversationId)===(null==v?void 0:v.conversationId),"Unexpected mismatch of conversation id in ranker"),m(520135893,(null==r?void 0:r.logicalId)===(null==v?void 0:v.logicalId),"Unexpected mismatch of logical id in ranker"),w=new o.c$({conversationId:null!=S?S:"",entityResults:I,logicalId:null!=A?A:"",status:0===I.length?i.i.NoResults:i.i.Success,treatments:new o.Fe({bestMatchEntries:b?[]:E})})}var N;return t.setDataFields({entityCount:(N=[w],N.reduce(((e,t)=>{var s;return e+((null===(s=t.entityResults)||void 0===s?void 0:s.reduce(((e,t)=>{var s;return e+((null===(s=t.entities)||void 0===s?void 0:s.length)||0)}),0))||0)}),0).toString())}),w}getDeDupedEntityList(e,t){const s=[],n=new Set;for(let t=0;t<e.length;++t){const o=e[t],i=o.text.toLocaleLowerCase();n.has(i)||(n.add(i),s.push(o))}for(let e=0;e<t.length;++e){const o=t[e];n.has(o.text.toLocaleLowerCase())||s.push(o)}return s}getMergedModelInfo(e,t){return{elapsedTime:Math.max(e.elapsedTime,t.elapsedTime),name:`${e.name}|${t.name}`,version:`${e.version}|${t.version}`}}}const T=()=>new y,f=(e,t)=>r.a.create("OaClientServerEccResultRanker").setCollectionScopeType(a.Cg.getTypeName()).setInputTypes(t).setOutputTypes([o.c$.getTypeName()]).setMaxAnnotations(e).setMaxDelayTime(3400).setLambdaType(T),_=(f(2,[o.J2.getTypeName(),o.os.getTypeName()]),f(2,[o.os.getTypeName()]))},958509:(e,t,s)=>{s.d(t,{g:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_SubstrateEvents_SubstrateEventsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},962019:(e,t,s)=>{s.d(t,{eU:()=>h});var n,o,i=s(521409),a=s(301520),r=s(297288),c=s.n(r);class l{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}!function(e){e.Add="Add",e.Remove="Remove",e.Set="Set",e.Delete="Delete"}(o||(o={}));class u{static applyECSPatchOperation(e,t){let s=!1;if("object"==typeof t||Array.isArray(t))switch(e.operation){case o.Add:case o.Remove:s=u.applyAddOrRemoveOperation(e.path,t,e.value,e.operation);break;case o.Set:s=u.applySetOperation(e.path,t,e.value);break;case o.Delete:s=u.applyDeleteOperation(e.path,t,e.value)}return s?i.tG.verbose(505956121,i.nh.CoreDefault,`PATCH operation succeeded for ${e.operation} on ${e.settingName} with path: ${e.path}.`):i.tG.error(505956122,i.nh.CoreDefault,`PATCH operation failed for ${e.operation} on ${e.settingName} with path: ${e.path}`),s}static applyAddOrRemoveOperation(e,t,s,n){let a=!1;try{let i=[];if("object"!=typeof t||Array.isArray(t)?Array.isArray(t)&&(i=t):i=e.reduce(((e,t)=>e&&e[t]),t),Array.isArray(i))if(n===o.Add)i.push(s),a=!0;else if(n===o.Remove){const e=i.indexOf(s);e>=0&&(i.splice(e,1),a=!0)}}catch(e){i.tG.info(505968832,i.nh.CoreDefault,`Exception thrown while applying operation type: ${n} for an array. Error: ${e}`),a=!1}return a}static applySetOperation(e,t,s){let n=!1;try{const o=e.slice(0,-1),i=e[e.length-1];let a={};"object"!=typeof t||Array.isArray(t)||(a=o.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof a||Array.isArray(a)||(a[i]=s,n=!0))}catch(e){i.tG.info(505968802,i.nh.CoreDefault,`Exception thrown while applying set operation. Error: ${e}`),n=!1}return n}static applyDeleteOperation(e,t,s){let n=!1;try{let o={};"object"!=typeof t||Array.isArray(t)||(o=e.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof o||Array.isArray(o)||"string"!=typeof s||o.hasOwnProperty(s)&&(delete o[s],n=!0))}catch(e){i.tG.info(505968801,i.nh.CoreDefault,`Exception thrown while applying delete operation. Error: ${e}`),n=!1}return n}}n=u,u.parseECSOperation=(e,t)=>{if(!t.hasOwnProperty("operationType")||!t.hasOwnProperty("path")||!t.hasOwnProperty("value"))throw new Error(`Invalid format for PATCH operation on setting: ${e}`);const s=t.operationType.toLowerCase(),o=n.convertToConfigPatchOperationType(s);return{settingName:e,path:t.path?t.path.split("."):[],operation:o,value:t.value}},u.convertToConfigPatchOperationType=e=>{switch(e){case"add":return o.Add;case"remove":return o.Remove;case"set":return o.Set;case"delete":return o.Delete;default:throw new Error(`Invalid operation type: ${e}`)}};var p=function(e,t,s,n){return new(s||(s=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function r(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(a,r)}c((n=n.apply(e,t||[])).next())}))};class g extends l{constructor(e){super(),this.name=e}static initEcsSettingsProvider(e){i.tG.info(505999498,i.nh.CoreDefault,"Initializing ECS settings provider."),g.ecsSettingsProvider=e}static enableEcsPatchConfig(e){g.ecsPatchConfigEnabled=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new g(e);const s=g.tryGetConfigProperty(g.currentConfig,e);s.success&&t.updateValue(s.value),this.allSettings.set(e,t)}return t}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new g(e)};const s=g.tryGetConfigPropertyByPattern(g.currentConfig,t.regex);t.setting.updateValue(s),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){g.currentConfig=e,i.tG.info(572837966,i.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),g.allSettings.forEach(((e,t)=>{const s=g.tryGetConfigProperty(g.currentConfig,t).value;e.updateValue(s)&&(i.tG.info(572837967,i.nh.CoreDefault,`Setting new value for ${t}: ${s instanceof Object?JSON.stringify(s):s}`),e.notifyListeners(s))})),g.allPatternSettings.forEach(((t,s)=>{const n=g.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(n)&&(i.tG.info(508432774,i.nh.CoreDefault,`Setting new value for pattern ${s}: ${JSON.stringify(n)}`),t.setting.notifyListeners(n))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:g.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const s=[];if(e){const n=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of n)s.push({name:t,value:g.selectApplicableValue(e[t])})}return s}static setGlobalFilter(e){g.globalFilter=e}static setLocalConfig(e){g.localConfig=e,i.tG.info(506053841,i.nh.CoreDefault,`Setting localConfig field in Setting class: ${JSON.stringify(g.localConfig)}`)}static clear(){g.currentConfig=void 0,g.localConfig=void 0,g.allSettings.clear(),g.allPatternSettings.clear(),g.ecsSettingsProvider=void 0}static selectApplicableValue(e){let t;if(e){const s=e.find((e=>!g.globalFilter||g.globalFilter(e)));s&&(t=s.value)}return t}getName(){return this.name}getValue(){if(function(){var e;return void 0!==globalThis.process&&"true"===(null===(e=globalThis.process.env)||void 0===e?void 0:e.VALIDATE_CORRECT_USAGE_OF_GET_VALUE)}()&&0===this.listeners.size){const e=new Error(`SettingInstance or ChangeGate is being used incorrectly. Make sure .getValue() or ChangeGate is called during runtime or there is a listener set up on the setting. For more info visit: ${g.troubleshootUrl}`);throw e.name="Incorrect usage of getValue()",e}return this.value}getValueAdvancedAsync(e){return p(this,void 0,void 0,(function*(){const t=new a.I({operationName:"ECSGetValueAsync"},{metricDuration:!0}).start();let s;try{const n=yield g.ecsSettingsProvider.getSettingValue(this.name,e);t.dimension0=n.userAuthenticated?"Authenticated":"Anonymous",t.success=!0;let o=n.value,i=n.ecsSection;return o||(o=g.tryGetConfigProperty(g.localConfig,this.name).value,o&&n.patchValue&&(o=g.applyPatchOperationOnSetting(this.name,o,n.patchValue),i=n.ecsPatchSection)),s=`Setting value for ${this.name} is ${JSON.stringify(o)}.\n Config IDs: ${JSON.stringify(i)}.`,o}catch(e){i.tG.error(505226379,i.nh.CoreDefault,`Exception thrown while getting setting value for ${this.name}. Error: ${e}`),t.success=!1;const n=g.tryGetConfigProperty(g.localConfig,this.name).value;return s=`Setting value for ${this.name} is ${JSON.stringify(n)}.`,n}finally{i.tG.info(506053839,i.nh.CoreDefault,t.stop()),i.tG.info(505821320,i.nh.CoreDefault,s)}}))}updateValue(e){return!c()(this.value,e)&&(i.tG.info(572837968,i.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}static applyPatchOperationsOnConfig(e){try{if(!g.ecsPatchConfigEnabled)return e;const t=this.tryGetConfigProperty(e,"patchOperations").value;if(!t||0===t.length)return e;const s=[];for(const[e,n]of Object.entries(t))try{s.push(u.parseECSOperation(e,n))}catch(t){i.tG.error(505734922,i.nh.CoreDefault,`Exception thrown while parsing ECS PATCH operation for setting: ${e}. Error: ${t}`);continue}const n=new Map;for(const t of s)if(null==e?void 0:e.hasOwnProperty(t.settingName)){const s=JSON.parse(JSON.stringify(e[t.settingName])),o=g.selectApplicableValue(s);u.applyECSPatchOperation(t,o)&&(n.set(t.settingName,o),e[t.settingName]=s)}return n.size>0&&i.tG.info(505788322,i.nh.CoreDefault,`Resulting settings after PATCHes were applied: ${JSON.stringify(Object.fromEntries(n))}`),e}catch(t){return i.tG.error(505788321,i.nh.CoreDefault,`Exception thrown while applying ECS PATCH operations. Error: ${t}`),e}}static applyPatchOperationOnSetting(e,t,s){try{if(!g.ecsPatchConfigEnabled)return t;const n=JSON.parse(JSON.stringify(t)),o=s,i=u.parseECSOperation(e,o);return u.applyECSPatchOperation(i,n),n}catch(e){return i.tG.error(505788323,i.nh.CoreDefault,`Exception thrown while applying ECS PATCH operation on setting. Error: ${e}`),t}}}g.allSettings=new Map,g.allPatternSettings=new Map,g.ecsPatchConfigEnabled=!1,g.troubleshootUrl="https://eng.ms/docs/experiences-devices/opg/office-ai/augloop-ai-platform/augmentation-loop/documentation/server-workflow-tutorials/settings/troubleshoot";class h extends l{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=g.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!=this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}getValueAdvancedAsync(e){return p(this,void 0,void 0,(function*(){const t=yield this.setting.getValueAdvancedAsync(e);return void 0===t?this.defaultValue:t}))}}},966264:(e,t,s)=>{s.d(t,{Al:()=>u,D_:()=>c,Pm:()=>r,U1:()=>p,ZF:()=>i,_K:()=>l,lM:()=>a,m7:()=>g,mh:()=>o});var n=s(985002),o=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextFinalResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextPartialResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechErrorEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),r=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechSessionEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechQualityEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyOutput"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),p=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),g=function(){function e(t){n.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_RehearsalNotificationResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},969915:(e,t,s)=>{var n,o;s.d(t,{S:()=>n}),function(e){e.GetPluginConfig="GetPluginConfig",e.GetPluginDefinition="GetPluginDefinition",e.GetBotResult="GetBotResult",e.ReadFreFlag="ReadFreFlag",e.WriteFreFlag="WriteFreFlag"}(n||(n={})),function(e){e.DISMISSED="dismissed",e.COMPLETED="completed"}(o||(o={}))},974428:(e,t,s)=>{s.d(t,{a:()=>i});var n=s(41498),o=s(475769);class i{constructor(e,t){var s,o,i,a,r;this.kind=n.wC.Join,this.isStateful=!1,this.maxDelayMs=1e3,this.maxAnnotations=1,this.allowDefinitionOverride=!1,this.id=e,t&&(this.inputTypes=null!==(s=t.inputTypes)&&void 0!==s?s:this.inputTypes,this.outputTypes=null!==(o=t.outputTypes)&&void 0!==o?o:this.outputTypes,this.isStateful=null!==(i=t.isStateful)&&void 0!==i?i:this.isStateful,this.maxDelayMs=null!==(a=t.maxDelayMs)&&void 0!==a?a:this.maxDelayMs,this.requestedContextTypesRules=null!==(r=t.requestedContextTypesRules)&&void 0!==r?r:this.requestedContextTypesRules)}static create(e){return new i(e)}setCollectionScopeType(e){return this.collectionScopeType=e,this}setInputTypes(e){return this.inputTypes=(0,o.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,o.MY)(e),this}setStateful(){return this.isStateful=!0,this}setMaxDelayTime(e){return this.maxDelayMs=e?Math.max(0,e):void 0,this}setMaxAnnotations(e){return this.maxAnnotations=e,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setAllowDefinitionOverride(){return this.allowDefinitionOverride=!0,this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},976941:(e,t,s)=>{var n;s.d(t,{q:()=>n}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(n||(n={}))},982308:(e,t,s)=>{s.d(t,{q:()=>o});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_GenerateAudioCastResponse"}static getBaseTypes(){return["AugLoop_Copilot_CopilotOutputStreamAnnotation","AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_AudioCastGenerator_GenerateAudioCastStatusReport"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},982389:(e,t,s)=>{s.d(t,{f8:()=>i});var n=s(985002);class o{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(o,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechSynthesizeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(i,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ReadAloudSpeechSynthesizeFinalAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechGetVoicesAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_AcsTextToSpeech_ACSTextToSpeechGetVoicesRAAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},985002:(e,t,s)=>{s.d(t,{h:()=>n});class n{constructor(e){n.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_&&Array.isArray(e.H_.B_)?e.H_.B_:[]}static getAllTypesFor(e){const t=n.getTypeNameFor(e);return t?[t,...n.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const s=n.getTypeNameFor(e),o=n.getBaseTypesFor(e);for(const e of t){if(e===s)return!0;if(o.indexOf(e)>=0)return!0}return!1}static assign(e,t,s){if(s)for(const e of Object.keys(s))t[e]=s[e];return t.H_=e.H_,t}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()}},989914:(e,t,s)=>{var n,o,i,a;s.d(t,{az:()=>o,sR:()=>n}),function(e){e.InternalError="internalError",e.Success="success",e.NoSuggestion="noSuggestion",e.MultipleFormulas="multipleFormulas",e.NoCopilotLicense="noCopilotLicense",e.AuthFailure="authFailure",e.UserThrottled="userThrottled",e.HarmfulContent="harmfulContent",e.IrrelevantQuery="irrelevantQuery",e.LlmGeneralErrorFailure="llmGeneralErrorFailure",e.InsufficientInputError="insufficientInputError"}(n||(n={})),function(e){e.ColumnSuggestion="ColumnSuggestion",e.CellSuggestion="CellSuggestion",e.NlToFormulaSuggestion="NlToFormulaSuggestion"}(o||(o={})),function(e){e.MonthDayYear="MonthDayYear",e.DayMonthYear="DayMonthYear",e.YearMonthDay="YearMonthDay",e.MonthYearDay="MonthYearDay",e.DayYearMonth="DayYearMonth",e.YearDayMonth="YearDayMonth"}(i||(i={})),function(e){e.Parenthesis="Parenthesis",e.Lead="Lead",e.Internal="Internal",e.Trail="Trail"}(a||(a={}))},990550:(e,t,s)=>{var n,o,i,a;s.d(t,{$k:()=>n}),function(e){e.Unknown="Unknown",e.Canvas="Canvas",e.CopilotChat="CopilotChat",e.Test="Test"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Updated=2]="Updated",e[e.Deleted=3]="Deleted"}(o||(o={})),function(e){e[e.ContentChanged=0]="ContentChanged",e[e.ContentWasEmpty=1]="ContentWasEmpty",e[e.FormattingChanged=2]="FormattingChanged",e[e.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"}(i||(i={})),function(e){e[e.AddOfZeroElements=0]="AddOfZeroElements",e[e.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds",e[e.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId",e[e.AddOfUndefinedItem=3]="AddOfUndefinedItem",e[e.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds",e[e.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem",e[e.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem",e[e.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem",e[e.UpdateOfStubbedItem=8]="UpdateOfStubbedItem",e[e.MoveOfNonExistentItem=9]="MoveOfNonExistentItem",e[e.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType",e[e.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate",e[e.MoveToTheSamePath=12]="MoveToTheSamePath",e[e.UnknownOperation=13]="UnknownOperation",e[e.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"}(a||(a={}))},995611:(e,t,s)=>{var n,o,i;s.d(t,{g$:()=>n}),function(e){e.ProjectStatusReport="projectstatusreport",e.InternalReport="internalreport",e.Newsletter="newsletter",e.Email="emailcampaign",e.BlogPost="blogpost",e.Unknown="unknown"}(n||(n={})),function(e){e.qna="qna",e.summary="summary",e.unknown="unknown"}(o||(o={})),function(e){e.CIPTree="CIPTree",e.ChosenTopics="ChosenTopics"}(i||(i={}))}}]);
//# sourceMappingURL=augloop-chunk.js.map