(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([["vendors~sccserviceciq"],{87218:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var i=n(465525),r=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(i.O2,e),userGeneratedMetadata:Reflect.getMetadata(i.Bc,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(i.b2,e)||[]},e}()},145402:(e,t)=>{"use strict";var n=function(e,t){for(var n=!1,i=0;i<e.length;i+=1)e[i]===t&&(n=!0,e.splice(i,1),i-=1);return n},i=function(){function e(){this.anyRegistrations=[],this.registrations={}}return e.prototype.on=function(e,t){this.safelyGetRegistration(e).listeners.push(t)},e.prototype.onFirst=function(e,t){var n=this.safelyGetRegistration(e);void 0!==n.firstArgs&&t.apply(void 0,n.firstArgs),n.firstOnlyListeners.push(t)},e.prototype.onAny=function(e){this.anyRegistrations.push(e)},e.prototype.off=function(e,t){if(void 0!==e)if(void 0!==t){var i=this.safelyGetRegistration(e),r=n(i.listeners,t),o=n(i.firstOnlyListeners,t);if(!r&&!o)throw new Error("Tried to remove a non-existent listener for event name '"+e+"'.")}else this.registrations[e]={firstOnlyListeners:[],listeners:[]};else this.registrations={}},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=this.safelyGetRegistration(e);if(void 0===i.firstArgs){for(var r=0,o=i.firstOnlyListeners;r<o.length;r++){o[r].apply(void 0,t)}i.firstArgs=t,i.firstOnlyListeners=[]}for(var a=0,s=i.listeners;a<s.length;a++){s[a].apply(void 0,t)}for(var u=0,l=this.anyRegistrations;u<l.length;u++){l[u].apply(void 0,[e].concat(t))}},e.prototype.waitFor=function(e){var t=this;return new Promise((function(n){var i=function(r){n(r),t.off(e,i)};t.on(e,i)}))},e.prototype.waitForFirst=function(e){var t=this;return new Promise((function(n){var i=function(r){n(r),t.off(e,i)};t.onFirst(e,i)}))},e.prototype.safelyGetRegistration=function(e){return void 0===this.registrations[e]&&(this.registrations[e]={firstOnlyListeners:[],listeners:[]}),this.registrations[e]},e}();t.bk=i},231559:(e,t,n)=>{"use strict";n.d(t,{pj:()=>qe,N$:()=>Ne,uQ:()=>Me,fl:()=>xe,Fp:()=>Ee,G6:()=>Oe,PR:()=>ye,OD:()=>N});const i=new Set(["Deserialize","Serialize","Retry","Sign"]);class r{constructor(e){var t;this._policies=[],this._policies=null!==(t=null==e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!i.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!i.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((n=>!(e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase)||(t.push(n.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight(((e,t)=>n=>t.sendRequest(n,e)),(t=>e.sendRequest(t)))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new r(this._policies)}static create(){return new r}orderPolicies(){const e=[],t=new Map;function n(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const i=n("Serialize"),r=n("None"),o=n("Deserialize"),a=n("Retry"),s=n("Sign"),u=[i,r,o,a,s];function l(e){return"Retry"===e?a:"Serialize"===e?i:"Deserialize"===e?o:"Sign"===e?s:r}for(const e of this._policies){const n=e.policy,i=e.options,r=n.name;if(t.has(r))throw new Error("Duplicate policy names not allowed in pipeline");const o={policy:n,dependsOn:new Set,dependants:new Set};i.afterPhase&&(o.afterPhase=l(i.afterPhase),o.afterPhase.hasAfterPolicies=!0),t.set(r,o);l(i.phase).policies.add(o)}for(const e of this._policies){const{policy:n,options:i}=e,r=n.name,o=t.get(r);if(!o)throw new Error(`Missing node for policy ${r}`);if(i.afterPolicies)for(const e of i.afterPolicies){const n=t.get(e);n&&(o.dependsOn.add(n),n.dependants.add(o))}if(i.beforePolicies)for(const e of i.beforePolicies){const n=t.get(e);n&&(n.dependsOn.add(o),o.dependants.add(n))}}function c(n){n.hasRun=!0;for(const i of n.policies)if((!i.afterPhase||i.afterPhase.hasRun&&!i.afterPhase.policies.size)&&0===i.dependsOn.size){e.push(i.policy);for(const e of i.dependants)e.dependsOn.delete(i);t.delete(i.policy.name),n.policies.delete(i)}}function d(){for(const e of u){if(c(e),e.policies.size>0&&e!==r)return void(r.hasRun||c(r));e.hasAfterPolicies&&c(r)}}let p=0;for(;t.size>0;){p++;const t=e.length;if(d(),e.length<=t&&p>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}var o=n(424447);const a=(0,o.KV)("core-rest-pipeline");class s extends Error{constructor(e){super(e),this.name="AbortError"}}function u(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function l(e){if(u(e)){const t="string"==typeof e.name,n="string"==typeof e.message;return t&&n}return!1}function c(e){if(l(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return`Unknown error ${t}`}}function d(e,t){switch(t){case"utf-8":return function(e){return(new TextEncoder).encode(e)}(e);case"base64":return p(e);case"base64url":return function(e){const t=e.replace(/-/g,"+").replace(/_/g,"/");return p(t)}(e);case"hex":return function(e){const t=new Uint8Array(e.length/2);for(let n=0;n<e.length/2;++n){const i=e[2*n],r=e[2*n+1];if(!f.has(i)||!f.has(r))return t.slice(0,n);t[n]=parseInt(`${i}${r}`,16)}return t}(e)}}function p(e){return new Uint8Array([...atob(e)].map((e=>e.charCodeAt(0))))}const f=new Set("0123456789abcdefABCDEF");function y(){let e="";for(let t=0;t<32;t++){const n=Math.floor(16*Math.random());e+=12===t?"4":16===t?3&n|8:n.toString(16),7!==t&&11!==t&&15!==t&&19!==t||(e+="-")}return e}var h;const g="function"==typeof(null===(h=null===globalThis||void 0===globalThis?void 0:globalThis.crypto)||void 0===h?void 0:h.randomUUID)?globalThis.crypto.randomUUID.bind(globalThis.crypto):y;function m(){return g()}var v,b,C,w;"undefined"!=typeof window&&window.document,"object"==typeof self&&"function"==typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(v=self.constructor)||void 0===v?void 0:v.name)||"ServiceWorkerGlobalScope"===(null===(b=self.constructor)||void 0===b?void 0:b.name)||null===(C=self.constructor)||void 0===C||C.name),"undefined"!=typeof Deno&&void 0!==Deno.version&&Deno.version.deno,"undefined"!=typeof Bun&&Bun.version;const T=void 0!==globalThis.process&&Boolean(globalThis.process.version)&&Boolean(null===(w=globalThis.process.versions)||void 0===w?void 0:w.node),q=("undefined"!=typeof navigator&&(null===navigator||void 0===navigator||navigator.product),"REDACTED"),S=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],I=["api-version"];class E{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=S.concat(e),t=I.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,n)=>{if(n instanceof Error)return Object.assign(Object.assign({},n),{name:n.name,message:n.message});if("headers"===e)return this.sanitizeHeaders(n);if("url"===e)return this.sanitizeUrl(n);if("query"===e)return this.sanitizeQuery(n);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(n)||u(n)){if(t.has(n))return"[Circular]";t.add(n)}return n}}),2)}sanitizeUrl(e){if("string"!=typeof e||null===e||""===e)return e;const t=new URL(e);if(!t.search)return e;for(const[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,q);return t.toString()}sanitizeHeaders(e){const t={};for(const n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=q;return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;const t={};for(const n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=q;return t}}const A="logPolicy";const P="redirectPolicy",x=["GET","HEAD"];function _(e={}){const{maxRetries:t=20}=e;return{name:P,async sendRequest(e,n){const i=await n(e);return O(n,i,t)}}}async function O(e,t,n,i=0){const{request:r,status:o,headers:a}=t,s=a.get("location");if(s&&(300===o||301===o&&x.includes(r.method)||302===o&&x.includes(r.method)||303===o&&"POST"===r.method||307===o)&&i<n){const t=new URL(s,r.url);r.url=t.toString(),303===o&&(r.method="GET",r.headers.delete("Content-Length"),delete r.body),r.headers.delete("Authorization");const a=await e(r);return O(e,a,n,i+1)}return t}const R="1.16.3",D=3;async function M(e){const t=new Map;t.set("core-rest-pipeline",R),await async function(e){const t=globalThis.navigator;let n="unknown";if(null==t?void 0:t.userAgentData){const i=await t.userAgentData.getHighEntropyValues(["architecture","platformVersion"]);n=`${i.architecture}-${i.platform}-${i.platformVersion}`;const r=function(e){const t=["Google Chrome","Microsoft Edge","Opera","Brave","Chromium"];for(const n of t){const t=e.find((e=>e.brand===n));if(t)return t}}(t.userAgentData.brands);r&&e.set(r.brand,r.version)}else if(null==t?void 0:t.platform){n=t.platform;const i=function(e){const t=[{name:"Firefox",regex:/Firefox\/([\d.]+)/},{name:"Safari",regex:/Version\/([\d.]+).*Safari/}];for(const n of t){const t=e.match(n.regex);if(t)return{brand:n.name,version:t[1]}}}(t.userAgent);i&&e.set(i.brand,i.version)}else"string"==typeof globalThis.EdgeRuntime&&e.set("EdgeRuntime",globalThis.EdgeRuntime);e.set("OS",n)}(t);const n=function(e){const t=[];for(const[n,i]of e){const e=i?`${n}/${i}`:n;t.push(e)}return t.join(" ")}(t);return e?`${e} ${n}`:n}const V="x-ms-useragent",N="userAgentPolicy";const B=Symbol("rawContent");function j(e){return"function"==typeof e[B]?e[B]():e.stream()}function $(e){return Boolean(e&&"function"==typeof e.pipe)}function F(e){return Boolean(e&&"function"==typeof e.getReader&&"function"==typeof e.tee)}async function k(e){if(e instanceof Blob||e instanceof Uint8Array)return e;if(F(e))return new Response(e).blob();const t=j(e);if($(t))throw new Error("Encountered unexpected type. In the browser, `concat` supports Web ReadableStream, Blob, Uint8Array, and files created using `createFile` only.");return k(t)}function z(e){let t="";for(const[n,i]of e)t+=`${n}: ${i}\r\n`;return t}function U(e){return e instanceof Uint8Array?e.byteLength:"function"==typeof e.stream?-1===e.size?void 0:e.size:void 0}async function L(e,t,n){const i=[d(`--${n}`,"utf-8"),...t.flatMap((e=>[d("\r\n","utf-8"),d(z(e.headers),"utf-8"),d("\r\n","utf-8"),e.body,d(`\r\n--${n}`,"utf-8")])),d("--\r\n\r\n","utf-8")],r=function(e){let t=0;for(const n of e){const e=U(n);if(void 0===e)return;t+=e}return t}(i);r&&e.headers.set("Content-Length",r),e.body=await async function(e){const t=[];for(const n of e)t.push(await k("function"==typeof n?n():n));return new Blob(t)}(i)}const W="multipartPolicy",H=70,G=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function Q(){return{name:W,async sendRequest(e,t){var n;if(!e.multipartBody)return t(e);if(e.body)throw new Error("multipartBody and regular body cannot be set at the same time");let i=e.multipartBody.boundary;const r=null!==(n=e.headers.get("Content-Type"))&&void 0!==n?n:"multipart/mixed",o=r.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!o)throw new Error(`Got multipart request body, but content-type header was not multipart: ${r}`);const[,a,s]=o;if(s&&i&&s!==i)throw new Error(`Multipart boundary was specified as ${s} in the header, but got ${i} in the request body`);return null!=i||(i=s),i?function(e){if(e.length>H)throw new Error(`Multipart boundary "${e}" exceeds maximum length of 70 characters`);if(Array.from(e).some((e=>!G.has(e))))throw new Error(`Multipart boundary "${e}" contains invalid characters`)}(i):i=`----AzSDKFormBoundary${m()}`,e.headers.set("Content-Type",`${a}; boundary=${i}`),await L(e,e.multipartBody.parts,i),e.multipartBody=void 0,t(e)}}}const K="The operation was aborted.";function J(e,t,n){return new Promise(((i,r)=>{let o,a;const u=()=>r(new s((null==n?void 0:n.abortErrorMsg)?null==n?void 0:n.abortErrorMsg:K)),l=()=>{(null==n?void 0:n.abortSignal)&&a&&n.abortSignal.removeEventListener("abort",a)};if(a=()=>(o&&clearTimeout(o),l(),u()),(null==n?void 0:n.abortSignal)&&n.abortSignal.aborted)return u();o=setTimeout((()=>{l(),i(t)}),e),(null==n?void 0:n.abortSignal)&&n.abortSignal.addEventListener("abort",a)}))}function X(e,t){const n=e.headers.get(t);if(!n)return;const i=Number(n);return Number.isNaN(i)?void 0:i}const Z="Retry-After",Y=["retry-after-ms","x-ms-retry-after-ms",Z];function ee(e){if(e&&[429,503].includes(e.status))try{for(const t of Y){const n=X(e,t);if(0===n||n){return n*(t===Z?1e3:1)}}const t=e.headers.get(Z);if(!t)return;const n=Date.parse(t)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch(e){return}}const te=1e3,ne=64e3;function ie(e={}){var t,n;const i=null!==(t=e.retryDelayInMs)&&void 0!==t?t:te,r=null!==(n=e.maxRetryDelayInMs)&&void 0!==n?n:ne;let o=i;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:n,responseError:i}){const a=function(e){if(!e)return!1;return"ETIMEDOUT"===e.code||"ESOCKETTIMEDOUT"===e.code||"ECONNREFUSED"===e.code||"ECONNRESET"===e.code||"ENOENT"===e.code||"ENOTFOUND"===e.code}(i),s=a&&e.ignoreSystemErrors,u=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(n),l=u&&e.ignoreHttpStatusCodes,c=n&&(function(e){return Number.isFinite(ee(e))}(n)||!u);if(c||l||s)return{skipStrategy:!0};if(i&&!a&&!u)return{errorToThrow:i};const d=o*Math.pow(2,t),p=Math.min(r,d);var f,y;return o=p/2+(f=0,y=p/2,f=Math.ceil(f),y=Math.floor(y),Math.floor(Math.random()*(y-f+1))+f),{retryAfterInMs:o}}}}const re=(0,o.KV)("core-rest-pipeline retryPolicy"),oe="retryPolicy";function ae(e,t={maxRetries:D}){const n=t.logger||re;return{name:oe,async sendRequest(i,r){var o,a;let u,l,c=-1;e:for(;;){c+=1,u=void 0,l=void 0;try{n.info(`Retry ${c}: Attempting to send request`,i.requestId),u=await r(i),n.info(`Retry ${c}: Received a response from request`,i.requestId)}catch(e){if(n.error(`Retry ${c}: Received an error from request`,i.requestId),l=e,!e||"RestError"!==l.name)throw e;u=l.response}if(null===(o=i.abortSignal)||void 0===o?void 0:o.aborted){n.error(`Retry ${c}: Request aborted.`);throw new s}if(c>=(null!==(a=t.maxRetries)&&void 0!==a?a:D)){if(n.info(`Retry ${c}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(u)return u;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${c}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||re;e.info(`Retry ${c}: Processing retry strategy ${t.name}.`);const n=t.retry({retryCount:c,response:u,responseError:l});if(n.skipStrategy){e.info(`Retry ${c}: Skipped.`);continue t}const{errorToThrow:r,retryAfterInMs:o,redirectTo:a}=n;if(r)throw e.error(`Retry ${c}: Retry strategy ${t.name} throws error:`,r),r;if(o||0===o){e.info(`Retry ${c}: Retry strategy ${t.name} retries after ${o}`),await J(o,void 0,{abortSignal:i.abortSignal});continue e}if(a){e.info(`Retry ${c}: Retry strategy ${t.name} redirects to ${a}`),i.url=a;continue e}}if(l)throw n.info("None of the retry strategies could work with the received error. Throwing it."),l;if(u)return n.info("None of the retry strategies could work with the received response. Returning it."),u}}}}const se="defaultRetryPolicy";function ue(e){return e.toLowerCase()}class le{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(ue(e),{name:e,value:String(t).trim()})}get(e){var t;return null===(t=this._headersMap.get(ue(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(ue(e))}delete(e){this._headersMap.delete(ue(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const e of this._headersMap.values())t[e.name]=e.value;else for(const[e,n]of this._headersMap)t[e]=n.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function ce(e){return new le(e)}const de="formDataPolicy";function pe(){return{name:de,async sendRequest(e,t){if(T&&"undefined"!=typeof FormData&&e.body instanceof FormData&&(e.formData=function(e){var t;const n={};for(const[i,r]of e.entries())null!==(t=n[i])&&void 0!==t||(n[i]=[]),n[i].push(r);return n}(e.body),e.body=void 0),e.formData){const t=e.headers.get("Content-Type");t&&-1!==t.indexOf("application/x-www-form-urlencoded")?e.body=function(e){const t=new URLSearchParams;for(const[n,i]of Object.entries(e))if(Array.isArray(i))for(const e of i)t.append(n,e.toString());else t.append(n,i.toString());return t.toString()}(e.formData):await async function(e,t){const n=t.headers.get("Content-Type");if(n&&!n.startsWith("multipart/form-data"))return;t.headers.set("Content-Type",null!=n?n:"multipart/form-data");const i=[];for(const[t,n]of Object.entries(e))for(const e of Array.isArray(n)?n:[n])if("string"==typeof e)i.push({headers:ce({"Content-Disposition":`form-data; name="${t}"`}),body:d(e,"utf-8")});else{if(null==e||"object"!=typeof e)throw new Error(`Unexpected value for key ${t}: ${e}. Value should be serialized to string first.`);{const n=e.name||"blob",r=ce();r.set("Content-Disposition",`form-data; name="${t}"; filename="${n}"`),r.set("Content-Type",e.type||"application/octet-stream"),i.push({headers:r,body:e})}}t.multipartBody={parts:i}}(e.formData,e),e.formData=void 0}return t(e)}}}const fe="proxyPolicy is not supported in browser environment";const ye="setClientRequestIdPolicy";const he="tlsPolicy";const ge={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function me(e={}){let t=new ve(e.parentContext);return e.span&&(t=t.setValue(ge.span,e.span)),e.namespace&&(t=t.setValue(ge.namespace,e.namespace)),t}class ve{constructor(e){this._contextMap=e instanceof ve?new Map(e._contextMap):new Map}setValue(e,t){const n=new ve(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new ve(this);return t._contextMap.delete(e),t}}const be={instrumenterImplementation:void 0};function Ce(){return be.instrumenterImplementation||(be.instrumenterImplementation={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{},addEvent:()=>{}},tracingContext:me({parentContext:t.tracingContext})}),withContext:(e,t,...n)=>t(...n)}),be.instrumenterImplementation}const we={},Te=new E;class qe extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1}),Object.setPrototypeOf(this,qe.prototype)}[we](){return`RestError: ${this.message} \n ${Te.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}}qe.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",qe.PARSE_ERROR="PARSE_ERROR";const Se="tracingPolicy";function Ie(e={}){const t=M(e.userAgentPrefix),n=new E({additionalAllowedQueryParameters:e.additionalAllowedQueryParameters}),i=function(){try{return function(e){const{namespace:t,packageName:n,packageVersion:i}=e;function r(e,r,o){var a;const s=Ce().startSpan(e,Object.assign(Object.assign({},o),{packageName:n,packageVersion:i,tracingContext:null===(a=null==r?void 0:r.tracingOptions)||void 0===a?void 0:a.tracingContext}));let u=s.tracingContext;const l=s.span;return u.getValue(ge.namespace)||(u=u.setValue(ge.namespace,t)),l.setAttribute("az.namespace",u.getValue(ge.namespace)),{span:l,updatedOptions:Object.assign({},r,{tracingOptions:Object.assign(Object.assign({},null==r?void 0:r.tracingOptions),{tracingContext:u})})}}function o(e,t,...n){return Ce().withContext(e,t,...n)}return{startSpan:r,withSpan:async function(e,t,n,i){const{span:a,updatedOptions:s}=r(e,t,i);try{const e=await o(s.tracingOptions.tracingContext,(()=>Promise.resolve(n(s,a))));return a.setStatus({status:"success"}),e}catch(e){throw a.setStatus({status:"error",error:e}),e}finally{a.end()}},withContext:o,parseTraceparentHeader:function(e){return Ce().parseTraceparentHeader(e)},createRequestHeaders:function(e){return Ce().createRequestHeaders(e)}}}({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:R})}catch(e){return void a.warning(`Error when creating the TracingClient: ${c(e)}`)}}();return{name:Se,async sendRequest(e,r){var o,s;if(!i||!(null===(o=e.tracingOptions)||void 0===o?void 0:o.tracingContext))return r(e);const u=await t,d={"http.url":n.sanitizeUrl(e.url),"http.method":e.method,"http.user_agent":u,requestId:e.requestId};u&&(d["http.user_agent"]=u);const{span:p,tracingContext:f}=null!==(s=function(e,t,n){try{const{span:i,updatedOptions:r}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:n});if(!i.isRecording())return void i.end();const o=e.createRequestHeaders(r.tracingOptions.tracingContext);for(const[e,n]of Object.entries(o))t.headers.set(e,n);return{span:i,tracingContext:r.tracingOptions.tracingContext}}catch(e){return void a.warning(`Skipping creating a tracing span due to an error: ${c(e)}`)}}(i,e,d))&&void 0!==s?s:{};if(!p||!f)return r(e);try{const t=await i.withContext(f,r,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);const n=t.headers.get("x-ms-request-id");n&&e.setAttribute("serviceRequestId",n),e.setStatus({status:"success"}),e.end()}catch(e){a.warning(`Skipping tracing span processing due to an error: ${c(e)}`)}}(p,t),t}catch(e){throw function(e,t){try{e.setStatus({status:"error",error:l(t)?t:void 0}),((n=t)instanceof qe||l(n)&&"RestError"===n.name)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(n){a.warning(`Skipping tracing span processing due to an error: ${c(n)}`)}var n}(p,e),e}}}}function Ee(e){var t;const n=r.create();var i;return T&&(e.tlsOptions&&n.addPolicy((i=e.tlsOptions,{name:he,sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=i),t(e))})),n.addPolicy(function(){throw new Error(fe)}(e.proxyOptions)),n.addPolicy(function(){throw new Error("decompressResponsePolicy is not supported in browser environment")}())),n.addPolicy(pe(),{beforePolicies:[W]}),n.addPolicy(function(e={}){const t=M(e.userAgentPrefix);return{name:N,sendRequest:async(e,n)=>(e.headers.has(V)||e.headers.set(V,await t),n(e))}}(e.userAgentOptions)),n.addPolicy(function(e="x-ms-client-request-id"){return{name:ye,sendRequest:async(t,n)=>(t.headers.has(e)||t.headers.set(e,t.requestId),n(t))}}(null===(t=e.telemetryOptions)||void 0===t?void 0:t.clientRequestIdHeaderName)),n.addPolicy(Q(),{afterPhase:"Deserialize"}),n.addPolicy(function(e={}){var t;return{name:se,sendRequest:ae([{name:"throttlingRetryStrategy",retry({response:e}){const t=ee(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}},ie(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:D}).sendRequest}}(e.retryOptions),{phase:"Retry"}),n.addPolicy(Ie(Object.assign(Object.assign({},e.userAgentOptions),e.loggingOptions)),{afterPhase:"Retry"}),T&&n.addPolicy(_(e.redirectOptions),{afterPhase:"Retry"}),n.addPolicy(function(e={}){var t;const n=null!==(t=e.logger)&&void 0!==t?t:a.info,i=new E({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:A,async sendRequest(e,t){if(!n.enabled)return t(e);n(`Request: ${i.sanitize(e)}`);const r=await t(e);return n(`Response status code: ${r.status}`),n(`Headers: ${i.sanitize(r.headers)}`),r}}}(e.loggingOptions),{afterPhase:"Sign"}),n}class Ae{async sendRequest(e){if("https:"!==new URL(e.url).protocol&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await async function(e){const{abortController:t,abortControllerCleanup:n}=function(e){const t=new AbortController;let n,i;if(e.abortSignal){if(e.abortSignal.aborted)throw new s("The operation was aborted.");i=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",i),n=()=>{var t;i&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",i))}}e.timeout>0&&setTimeout((()=>{t.abort()}),e.timeout);return{abortController:t,abortControllerCleanup:n}}(e);try{const r=function(e){const t=new Headers;for(const[n,i]of e)t.append(n,i);return t}(e.headers),{streaming:o,body:a}=function(e){const t="function"==typeof e.body?e.body():e.body;if($(t))throw new Error("Node streams are not supported in browser environment.");return F(t)?{streaming:!0,body:Pe(t,{onProgress:e.onUploadProgress})}:{streaming:!1,body:t}}(e),s=Object.assign(Object.assign({body:a,method:e.method,headers:r,signal:t.signal},"credentials"in Request.prototype?{credentials:e.withCredentials?"include":"same-origin"}:{}),"cache"in Request.prototype?{cache:"no-store"}:{});o&&(s.duplex="half");const u=await fetch(e.url,s);return i=e.body,("function"==typeof Blob||"object"==typeof Blob)&&i instanceof Blob&&e.onUploadProgress&&e.onUploadProgress({loadedBytes:e.body.size}),async function(e,t,n){var i,r;const o=function(e){const t=ce();for(const[n,i]of e.headers)t.set(n,i);return t}(e),a={request:t,headers:o,status:e.status},s=F(e.body)?Pe(e.body,{onProgress:t.onDownloadProgress,onEnd:n}):e.body;if((null===(i=t.streamResponseStatusCodes)||void 0===i?void 0:i.has(Number.POSITIVE_INFINITY))||(null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(a.status)))if(t.enableBrowserStreams)a.browserStreamBody=null!=s?s:void 0;else{const e=new Response(s);a.blobBody=e.blob(),null==n||n()}else{const e=new Response(s);a.bodyAsText=await e.text(),null==n||n()}return a}(u,e,n)}catch(e){throw null==n||n(),e}var i}(e)}catch(t){throw function(e,t){var n;return e&&"AbortError"===(null==e?void 0:e.name)?e:new qe(`Error sending request: ${e.message}`,{code:null!==(n=null==e?void 0:e.code)&&void 0!==n?n:qe.REQUEST_SEND_ERROR,request:t})}(t,e)}}}function Pe(e,t={}){let n=0;const{onProgress:i,onEnd:r}=t;if(function(e){return void 0!==e.pipeThrough&&void 0!==self.TransformStream}(e))return e.pipeThrough(new TransformStream({transform(e,t){null!==e?(t.enqueue(e),n+=e.length,i&&i({loadedBytes:n})):t.terminate()},flush(){null==r||r()}}));{const t=e.getReader();return new ReadableStream({async pull(e){var o;const{done:a,value:s}=await t.read();if(a||!s)return null==r||r(),e.close(),void t.releaseLock();n+=null!==(o=null==s?void 0:s.length)&&void 0!==o?o:0,e.enqueue(s),i&&i({loadedBytes:n})},cancel:e=>(null==r||r(),t.cancel(e))})}}function xe(){return new Ae}class _e{constructor(e){var t,n,i,r,o,a,s;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:ce(),this.method=null!==(n=e.method)&&void 0!==n?n:"GET",this.timeout=null!==(i=e.timeout)&&void 0!==i?i:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=null!==(r=e.disableKeepAlive)&&void 0!==r&&r,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(o=e.withCredentials)&&void 0!==o&&o,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||m(),this.allowInsecureConnection=null!==(a=e.allowInsecureConnection)&&void 0!==a&&a,this.enableBrowserStreams=null!==(s=e.enableBrowserStreams)&&void 0!==s&&s}}function Oe(e){return new _e(e)}const Re={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};function De(e,t){let n,i=null,r=null;const o=Object.assign(Object.assign({},Re),t),a={get isRefreshing(){return null!==i},get shouldRefresh(){var e;return!a.isRefreshing&&(null!==(e=null==r?void 0:r.expiresOnTimestamp)&&void 0!==e?e:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return null===r||r.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function s(t,s){var u;if(!a.isRefreshing){i=async function(e,t,n){async function i(){if(!(Date.now()<n)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(e){return null}}let r=await i();for(;null===r;)await J(t),r=await i();return r}((()=>e.getToken(t,s)),o.retryIntervalInMs,null!==(u=null==r?void 0:r.expiresOnTimestamp)&&void 0!==u?u:Date.now()).then((e=>(i=null,r=e,n=s.tenantId,r))).catch((e=>{throw i=null,r=null,n=void 0,e}))}return i}return async(e,t)=>{const i=Boolean(t.claims),o=n!==t.tenantId;i&&(r=null);return o||i||a.mustRefresh?s(e,t):(a.shouldRefresh&&s(e,t),r)}}const Me="bearerTokenAuthenticationPolicy";async function Ve(e){const{scopes:t,getAccessToken:n,request:i}=e,r={abortSignal:i.abortSignal,tracingOptions:i.tracingOptions},o=await n(t,r);o&&e.request.headers.set("Authorization",`Bearer ${o.token}`)}function Ne(e){var t;const{credential:n,scopes:i,challengeCallbacks:r}=e,o=e.logger||a,s=Object.assign({authorizeRequest:null!==(t=null==r?void 0:r.authorizeRequest)&&void 0!==t?t:Ve,authorizeRequestOnChallenge:null==r?void 0:r.authorizeRequestOnChallenge},r),u=n?De(n):()=>Promise.resolve(null);return{name:Me,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let n,r;await s.authorizeRequest({scopes:Array.isArray(i)?i:[i],request:e,getAccessToken:u,logger:o});try{n=await t(e)}catch(e){r=e,n=e.response}if(s.authorizeRequestOnChallenge&&401===(null==n?void 0:n.status)&&function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(n)){if(await s.authorizeRequestOnChallenge({scopes:Array.isArray(i)?i:[i],request:e,response:n,getAccessToken:u,logger:o}))return t(e)}if(r)throw r;return n}}}},239797:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CiqAnchorElementId:()=>ye.W,EditorServiceImplementation:()=>fe,initCiq:()=>ye.a,mapSuggestions:()=>he.E});var i=n(379490),r=n(50233),o=n(932844);const a=[{id:"818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",name:"Frequentlyconfusedwords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"4ee98de6-ea40-48db-ae36-ca82fc8473f7",name:"AcademicDegrees",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"5cb7fc16-cd78-449c-86d9-5d047be21ac4",name:"AdjectiveUsedinsteadofAdverb",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"8778ba37-ca99-4ab9-a964-55abd18f7eba",name:"AdverbinsteadofAdjective",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"f57c12d6-03e4-4f48-9b7b-f95802a6c669",name:"AgreementwithinNounPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a127d2c9-2faf-491b-8d6a-e9b027fec098",name:"AnAnd Confusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"63e72d3d-62d7-4e73-8d66-c137d8841121",name:"Capitalization",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"79d4a5c7-11c0-4be1-8d3c-c322f9941323",name:"Capitalizationof March and May",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"822bb35e-0608-466e-a771-a315fcf95821",name:"CapitalizationofPersonalTitles",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7b3c279b-14c8-4e5f-83da-1cc446ed7f6a",name:"CommaafterGreetings",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"9d62fd01-8804-4485-a5f0-257131e4f6aa",name:"CommabeforeQuotations",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",name:"CommaMissingafterIntroductoryPhrase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"72e604b0-a185-413b-bd45-ad555288c746",name:"CommaSplice",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e3994139-ff36-44da-ae72-500b70d9b80f",name:"CommawithConjunctiveAdverbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e805847a-9050-45de-b767-f48ed68ad848",name:"CommawithConjunction",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"0c576af1-54af-4acb-8065-4616bb73820d",name:"CommasaroundDescriptiveClause",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"413425d5-5a64-4ea6-84df-aae06c596439",name:"CommonlyConfusedPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",name:"CommonlyConfusedWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"02c15397-df70-4f00-aa4d-7269e6d4e712",name:"ComparativeUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"25714ab1-190b-4ef3-8d3d-e45bfd591c45",name:"CorrelativeConjunctionMismatch",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"8cf6f68e-f693-4e6f-b253-5092cd19b9e2",name:"DateFormatting",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"03522a58-4044-4bab-b796-0630ae2ad00a",name:"EmbarrassingWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"84275a90-df79-4b9e-a208-9ec8b5e59622",name:"Hyphenation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"708198dd-ecbf-44fb-a428-ff2bc10e4d17",name:"IncorrectAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6c49e04e-c556-43f3-94dc-2fe5dc18d8e5",name:"IncorrectNegation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7d9778b3-89e4-4974-b38f-086d39b32c21",name:"IncorrectNumberEnding",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"ca649e0f-48de-4f54-b687-2bda07e40728",name:"IncorrectPronounCase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"631a3185-4bb6-4d1a-b275-f16c7f5dcc3a",name:"IncorrectReflexivePronounUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"296f8f65-02fb-45a7-b4ab-5dc137edc563",name:"IncorrectUseof That",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:1,CritiqueTag:0},{id:"0941dabb-e993-4a10-8a92-70a95ca5389d",name:"IncorrectVerbForm",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7c2ff4d7-41a9-4310-949b-863a0dfa4257",name:"IncorrectVerbFormafterAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6dbfae4c-9818-4dec-a769-2595168927f2",name:"IndefiniteArticle",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e006985e-33eb-42e1-9196-1333c4ecad9c",name:"IndirectQuestions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"4b1218e3-a124-4d36-b993-eb9ad6e80ddd",name:"MisheardPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"2700d569-bd6f-4806-9bf1-49abd64d9fd3",name:"MissingComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"b3613809-76ab-4b7b-91e6-ee9b6b9b60b2",name:"ModalConfusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"875c19b3-5769-4e9b-8d32-9c9dd4d74c13",name:"MultipleModals",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",name:"PossessiveandPluralForms",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"3f2eda01-e8a5-4ed9-9494-6de566bc5333",name:"Punctuation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"76e3d0aa-bb80-461e-89c3-9fa640190616",name:"QuestionMarkMissing",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"12d7f72e-e53e-4b27-b1ed-4ee115f54994",name:"RedundantColon",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"b956d579-6d99-4278-8b7d-e281ab8c576b",name:"RedundantCommabeforeComplementClause",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"2d08dbe8-c11b-4190-a428-9a2c0a37bd68",name:"RedundantCommabeforeObject",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"aa78ec66-2078-42bf-84f5-c241eb53a531",name:"RedundantCommafollowingSubject",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"1346c3e5-5bf2-4176-ad29-9e25d88da4c6",name:"RedundantQuestionMark",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e8c121e0-1ecd-4e88-8694-2fb17acb519d",name:"RepeatedAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"39d0acfc-05aa-4d25-ae88-32ebcee3bbeb",name:"SemicolonUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6d1d8c3d-62d5-45d1-b850-d8a98a24964b",name:"Spacing",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"d7746119-e7e5-4e97-9979-bcd2114f9fe9",name:"Subject-VerbAgreement",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"27783a58-c44f-4778-9856-36d9eab63693",name:"TooManyDeterminers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a7927082-e6bb-4061-a134-3051e5969222",name:"UnnecessaryHyphen",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"26bdc172-02a8-4f0a-8ec0-6049906f1f7c",name:"UseofPlainVerbForm",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"39e466f1-6ebd-4ada-a7db-e0cc74048f1e",name:"UseoftheWord Lack",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a9ca4ef4-12a5-4ad2-b8d5-b1310cc0d2af",name:"UseofWillandWould",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"352579fc-6ae6-4eb1-8d3b-895ab239714e",name:"VerbUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"ff12bbbd-0795-409a-8ed0-c8d7b2793e3a",name:"WhoWhomConfusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6a0e1c97-430e-4d83-889d-8c4fea315a83",name:"WordSplit",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"c4301606-9bc2-4389-bb1a-c08370627172",name:"AdverbPlacement",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"0da5de95-d496-4d23-8f93-693ef6592ae6",name:"DoubleNegation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3be567ea-4951-4e59-bdab-6b99c790f28d",name:"Jargon",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"ab60d6cb-98df-4b9d-9a69-f6c12d8099fe",name:"PassiveVoice",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"8aa31cca-af48-4d21-8fb5-a0f314fab6ce",name:"PassiveVoicewithUnknownActor",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"28c70cb7-e358-4b32-8756-725aa7af1d69",name:"SentenceStructure",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"7f6d979b-d0de-4367-aa9d-589b5134b7a6",name:"SimplerWording",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"79dd443b-0b94-45a1-90ad-02807565324d",name:"SplitInfinitives",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"007c6707-7280-4c94-b469-8caee77d8313",name:"UseofEuphemisms",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"e24fd819-cc17-4be9-afec-dd103055198e",name:"ConjunctionOveruse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"71384165-a4b9-45a7-9a73-7d0830c8c426",name:"Nominalizations",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"cfc8ef49-66b1-4ea0-8930-43d2ccd842e0",name:"Wordiness",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"6bdf8d88-1ed5-4506-9b5f-a17e7f8c2a48",name:"WordsExpressingUncertainty",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"67718619-a6b1-43ec-af18-1c48bbc27acd",name:"ColloquialVerbPhrase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"f4aa4a0a-f81a-41ac-b710-de4a60b99282",name:"Contractions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"6d60d9da-9e38-4d1e-bfc5-05a04120eef9",name:"InformalLanguage",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"d124712e-74ac-43eb-9bb6-373b2398f448",name:"OpinionMarkers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"aa4e5a53-9b76-49fe-8bf1-2f35fd0d091d",name:"Slang",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"c68edc3b-9340-4b68-9d18-268bb82e2d94",name:"SubjunctiveMood",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"932288af-0af4-43f8-94af-206e06e43fce",name:"AgeBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"dd116cd6-2adb-4be9-809f-7b8de7cace91",name:"EthnicSlurs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"6cd66cca-c2c2-48cf-8353-9791327aaea1",name:"GenderBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"e77bbc2a-f896-4012-a711-6041ea1e8964",name:"Gender-SpecificLanguage",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"36869146-3cc3-40fd-ae3c-bb30f6988335",name:"RacialBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"cbac7e3d-9058-442c-9f24-78fe164069b4",name:"SexualOrientationBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"3f2e6b47-fc23-4f99-ad25-1758e7f179b6",name:"CommawithAdverbials",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"55aa25a5-e28a-4f22-8410-34a4df965e30",name:"OxfordComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3fd9c226-3925-4855-ba1e-49eb9ee46d24",name:"UnnecessaryComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"5b75d94a-856d-461b-9bb4-879f4502b4c3",name:"PunctuationRequiredWithQuotes",IsBinaryCritiqueType:!1,CritiqueTypeValues:["don'tcheck","inside","outside"],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"a44ac718-8213-42ff-87a5-1e5d6592c352",name:"SpaceBetweenSentences",IsBinaryCritiqueType:!1,CritiqueTypeValues:["don'tcheck","onespace","twospaces"],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"487d4873-3793-45a7-b881-7f18cac3f16c",name:"AvoidFirstPersonReferences",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"ac135410-a38a-4398-a759-ac6e2e5f779c",name:"SuperfluousExpressions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"2b188727-cb05-4a4b-86a2-b35073e34c0b",name:"UnsuitableExpressions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"348f4088-d907-41dc-9007-3cecf9837b61",name:"VagueQuantifiers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"d07b8e0e-37e7-476e-99e6-477fd9f1b394",name:"VagueVerbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"923cc720-1624-4973-946a-30a0c6ec4163",name:"ClichÃ©s",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3ae3b3e9-6e99-4113-9962-b52b7fe539f3",name:"Region-SpecificWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"9725ea09-959d-48b9-9678-1844896547b3",name:"VagueAdjectives",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"64213f24-0943-4585-8dd4-ee4f26b47a37",name:"VagueorUnnecessaryAdverbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"2e33dc1f-0106-4182-b52a-ad94e479fb9a",name:"WeakVerbs",defaultCritiqueValue:0}];n(220029);var s=n(568998),u=n(110837),l=n(195220),c=n(937910),d=n(863430),p=n(637224),f=n(146507),y=n(456204),h=n(753031),g=n(17264),m=n(475920),v=n(666161),b=n(532419),C=n(756214),w=n(503710),T=n(391095),q=n(30466),S=n(703705),I=n(341213),E=n(491492),A=n(827328),P=n(108358),x=n(842590),_=n(498408),O=n(95593);async function R(e,t,i,r=new Date){try{await(0,p.iJ)();const{modules:o,uxModules:a,telemetrySinkOrModule:s}=await async function(e,t,i){const r=[],o=[];return r.push(m.Q),r.push(v.V),r.push(w.H),r.push(C.F),r.push(T.w),r.push(b.k),r.push(A.I),r.push(_.p),r.push((await Promise.all([n.e("chunk1jsfluent"),n.e("editor"),n.e("office-iss"),n.e("vendors~shared")]).then(n.bind(n,68214))).InlineSuggestionsWebUXModule),i||r.push((await Promise.all([n.e("editor"),n.e("vendors~shared")]).then(n.bind(n,539363))).CreateAugloopSessionModule),e.serviceSettings?.hybridAugloop?.enabled&&e.serviceSettings.hybridAugloop.enableGraphSearchLocal&&r.push((await Promise.all([n.e("editor"),n.e("augloop-chunk")]).then(n.bind(n,288822))).HybridModule),e.serviceSettings?.predictions?.enabled&&(void 0===e.serviceSettings.predictions.domInsertion||e.serviceSettings.predictions.domInsertion?r.push(P.Q):r.push(x._)),e.serviceSettings?.flagAnnotationSettings?.enabled&&(r.push(q.b),o.push((async()=>(await Promise.all([n.e("chunk1jsfluent"),n.e("editor"),n.e("office-iss"),n.e("vendors~shared")]).then(n.bind(n,236256))).UXModules)),o.push((async()=>(await Promise.all([n.e("editor"),n.e("vendors~shared"),n.e("npm_store_sdx_officecopilot_editor-nlxgrammarcategories_49_106_1-2d8122b40a0b33452e21_node_mo-d5377f")]).then(n.bind(n,317537))).CategoryLocalizationSlimModule))),e.serviceSettings?.nudge?.enabled&&(r.push(S.Q),o.push((async()=>(await Promise.all([n.e("editor"),n.e("vendors~shared")]).then(n.bind(n,262707))).NudgeUXModule))),e.isAggregatedLoggingEnabled&&r.push(g.A),window.Worker?r.push(I.e):r.push(O.O),{modules:r,uxModules:o,telemetrySinkOrModule:t??new E.f}}(e,t,i);return new D(e,o,a,i,s,void 0,r)}catch(e){throw(0,f.C)().logEvent(0,"Diagnostics",y.h.Host,h.q.Error,{Text_Message:`Failed to initialize Editor Client: ${e}`}),new Error(`Failed to initialize Editor Client: ${e}`)}}class D extends c.l{constructor(e,t,n,i=void 0,r,o,a=new Date){super(e,t,n,i,r,o,a)}readLocales(){throw new Error("Method not implemented.")}writeLocales(e){throw new Error("Method not implemented.")}spellCheck(e,t,n){return this.attach(e,n)}attach(e,t){const n=this.diContainer.get(s.l).createGraphNode({element:e,initialContentChangeType:t});return n&&this.proofingDom.addNode(n),n}detach(e){this.proofingDom.removeNode(e)}async setLocale(e){const t="string"==typeof e?[e]:e;return await super.setLocale(t)}clearPreloadedSuggestions(){this.diContainer.get(l.W).clearPreloadedSuggestions()}async clearPersistentData(){await this.diContainer.get(u.B).removePersistentKeys(),await this.diContainer.get(d.$).removePersistentKeys()}}var M=n(27668),V=n(77603),N="https://",B=N+"outlook-1-cdn.azureedge.",j="midgard/",$="/agsc-"+j,F="versionless/",k=N+"res.cdn.office.net/"+j;function z(e){return e?e.publicPath?e.publicPath:function(e){switch(e.environment){case"Gallatin":return N+"res-1.cdn.partner.office365.cn/"+j;case"AG08":return B+"eaglex.ic.gov"+$;case"AG09":return B+"microsoft.scloud"+$;case"GccHigh":return N+"res-gcch.cdn.office.net/"+j;case"DoD":return N+"res-dod.cdn.office.net/"+j;default:return k}}(e)+F:k+F}var U=n(61714),L=n(410282);const W="https://dogfood.augloop.svc.cloud.microsoft",H=15,G="@",Q=[{id:"spelling",name:"Spelling"},{id:"grammar",name:"Grammar"}],K=[{id:"headingDetection",name:"Heading Detection"},{id:"entityDetection",name:"People / Date Recognition"},{id:"taskRecognition",name:"Task Recognition"},{id:"textToTable",name:"Table Suggestions"},{id:"addressDetection",name:"Address Detection"},{id:"satoriEntity",name:"Entity Suggestion"}],J=[{id:"clarity",name:"Clarity"},{id:"conciseness",name:"Conciseness"},{id:"formality",name:"Formality"},{id:"inclusiveness",name:"Inclusiveness"},{id:"puncConventions",name:"Punctuation Conventions"},{id:"sensitiveGpRef",name:"Sensitive Geopolitical References"},{id:"vocabulary",name:"Vocabulary"}],X=[L.b.MessageExtension,L.b.PowerPlatform,L.b.OpenAIPlugin];var Z,Y;!function(e){e.DOGFOOD="dogfood",e.SDFV2="sdfv2",e.MSIT="msit",e.MICROSOFT="microsoft",e.WW="ww"}(Z||(Z={})),function(e){e.DOGFOOD="Dogfood",e.MICROSOFT="Microsoft",e.PRODUCTION="Production"}(Y||(Y={}));var ee=n(917853);function te(e,t,n){return{Type:"Entity",Name:null,ReferenceId:e,EntityType:t,LayoutType:null,Position:n,ResultsView:null}}function ne(e){switch(null==e?void 0:e.toLowerCase()){case Z.DOGFOOD:case Z.SDFV2:return Y.DOGFOOD;case Z.MSIT:case Z.MICROSOFT:return Y.MICROSOFT;case Z.WW:default:return Y.PRODUCTION}}function ie(e,t){if(void 0===e)return W;switch(null==e?void 0:e.toLowerCase()){case Z.DOGFOOD:case Z.SDFV2:return W;case Z.MSIT:case Z.MICROSOFT:case Z.WW:default:return(null==t?void 0:t.enableLegacyAugLoopEndpoint)?"https://augloop.office.com":"https://augloop.svc.cloud.microsoft"}}const re=e=>{const t=[];return(null==e?void 0:e.enableAppGptsInCiq)&&t.push({Term:{AppType:L.b.GPT}}),(null==e?void 0:e.enableAppMessageExtensionsInCiq)&&t.push({Term:{AppType:L.b.MessageExtension}}),(null==e?void 0:e.enableAppTypeBInCiq)&&t.push({Term:{AppType:L.b.OpenAIPlugin}}),(null==e?void 0:e.enableAppPPInCiq)&&t.push({Term:{AppType:L.b.PowerPlatform}}),(null==e?void 0:e.enableAppPluginsInCiq)&&X.forEach((e=>{t.push({Term:{AppType:e}})})),t},oe=(e,t,n)=>{const i=!!((null==t?void 0:t.enableAppGptsInCiq)||(null==t?void 0:t.enableAppPluginsInCiq)||(null==t?void 0:t.enableAppPPInCiq)||(null==t?void 0:t.enableAppTypeBInCiq)||(null==t?void 0:t.enableAppMessageExtensionsInCiq));let o=[...e,r.c.App,r.c.Topic];o=o.filter((e=>e===r.c.App?i:e!==r.c.Topic||((null==t?void 0:t.enableTopicCIQ)||(null==t?void 0:t.enableTopicECC))));const a=[];return o.forEach((e=>{e===r.c.App&&i?a.push({enabled:!0,entityType:r.c.App,maxResults:H,customProps:[{name:"Filter",value:JSON.stringify({Or:re(t)})}]}):e===r.c.People?a.push({enabled:!0,entityType:r.c.People,maxResults:H,customProps:[{name:"Filter",value:JSON.stringify({And:[{Or:[{Term:{PeopleType:ee.E6.Person}},{Term:{PeopleType:ee.E6.Other}}]},{Or:[{Term:{PeopleSubtype:ee.O2.OrganizationUser}},{Term:{PeopleSubtype:ee.O2.Guest}},{Term:{PeopleSubtype:ee.O2.OrganizationContact}}]}]})}]}):e===r.c.File?a.push({enabled:!0,entityType:e,maxResults:(null==t?void 0:t.enableSingleEntityStyle)?void 0:H,customProps:null==n?void 0:n.File}):(e===r.c.Topic&&((null==t?void 0:t.enableTopicCIQ)||null==t||t.enableTopicECC),a.push({enabled:!0,entityType:e,maxResults:H}))})),a.map((e=>(null==t?void 0:t.enableECCNudge)?Object.assign(Object.assign({},e),{queryPrefix:[e.entityType===r.c.App?G:"/"]}):e)),a},ae=(e,t)=>t||"DogFood"===e?M.G.Staging:"GCC"===e?M.G.GCC:"GCCH"===e?M.G.GCCHigh:"DOD"===e?M.G.USDoD:M.G.Prod,se=["mc-officeEditorTonalEnabled","mc-officeEditorALEnabled","mc-enable-override-critiques:true","mc-editor-oa","maps-editor-locationsuggestions","mc-graphIntentDetection-workflow","mc-graphIntentDetection-model-flight07","mc-graphIntentDetection-model-flight15","mc-graphIntentDetection-allowlist-flight02","mc-editor-oa-mid-tile-predictions","mc-editor-oa-flags","mc-editor-oa-address-detection","mc-editor-oa-local-business-detection","mc-editor-oa-satori-entity-detection","oa-graph-bestmatch","enable-scope-suggestions","scd-suggestions-toplevel","mc-editor-oa-settings","mc-editor-oa-ecc-annotation","mc-editor-oa-event-ecc","mc-editor-oa-scopes","mc-editor-enable-meeting-banner"],ue=(e,t)=>{const n=[...se];return(null==t?void 0:t.enableChatCIQ)&&n.push("mc-editor-oa-groupchat-ecc"),(null==t?void 0:t.enableEmailCIQ)&&n.push("mc-editor-oa-email-ecc"),((null==t?void 0:t.enableTopicECC)||(null==t?void 0:t.enableTopicCIQ))&&n.push("vivatopics"),((null==t?void 0:t.enableAppGptsInCiq)||(null==t?void 0:t.enableAppPluginsInCiq)||(null==t?void 0:t.enableAppPPInCiq)||(null==t?void 0:t.enableAppTypeBInCiq)||(null==t?void 0:t.enableAppMessageExtensionsInCiq))&&n.push("mc-editor-oa-app-ecc"),e&&n.push("mc-editor-oa-client-ecc"),(null==t?void 0:t.enableResponsiveExpandedECC)&&n.push("mc-editor-expanded-ecc-responsive"),(null==t?void 0:t.enableNewFileTidbits)&&n.push("mc-editor-enable-files-new-tidbits"),(null==t?void 0:t.enableSearchBar)&&(n.push("mc-editor-enable-searchbar"),n.push("mc-editor-attachbutton-searchbar-position")),(null==t?void 0:t.enableECCNudge)&&(n.push("mc-editor-oa-nudge"),n.push("mc-editor-oa-nudge-all-entities")),(null==t?void 0:t.enableGradientPlaceholder)&&n.push("immersive-bizchat-enable-gradient-placeholder"),(null==t?void 0:t.enableExperimentalPredictionTimeout)&&n.push("mc-editor-oa-experimental-prediction-timeout"),(null==t?void 0:t.enableAttachmentHint)&&n.push("mc-editor-enable-attachment-hint"),(null==t?void 0:t.enableShowCIQAfterRemoveAttachment)&&n.push("mc-editor-show-menu-after-remove-attachment"),n},le=(e,t,n,r,o,a)=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){return yield R((({augLoopAuthTokenCallback:e,getProfilePictureUrl:t,substrateAuthTokenCallback:n,appId:i,appName:r,appPlatform:o,appScenario:a,sessionId:s,isDogfoodEnvironment:u,appEnvironment:l,accountType:c,puid:d,tenantId:p,accountRing:f,locale:y,oaResultsTimeout:h,sourceName:g,browseThisComputerSettings:m,enableZeroQueryHintText:v,customizedEmptyECCSuggestionsString:b,onOpenGptStorefront:C,moreCopilotsStringOverride:w,enableVisualRefresh:T,doNotLimitToTargetDocument:q,enablePersistentStyleCopying:S},I,E,A)=>{const P=`${z({environment:"Prod"})}graph-search-local-0.4.3505-0.14.3`,x=!!(null==E?void 0:E.enableHybridWorkflow),_=!!((null==E?void 0:E.enableAppGptsInCiq)||(null==E?void 0:E.enableAppPluginsInCiq)||(null==E?void 0:E.enableAppPPInCiq)||(null==E?void 0:E.enableAppTypeBInCiq)||(null==E?void 0:E.enableAppMessageExtensionsInCiq)),O=!!(null==E?void 0:E.hideGptStorefront),R={enabled:!0,maxResults:H,enableAutomaticScoping:!0};return{appId:i,showSquiggleTooltip:!0,enableStealthSquiggles:!0,showOptionsButton:!0,flightsToTrack:ue(x,E),tonalFreEnabledForUser:!0,useFluentV9:T,oaSettings:{preventAllTabBackfill:null==E?void 0:E.enablePreventAllTabBackfill,isContextualCardEnabled:!0,mockResults:!1,mockNoAugloopResults:!1,mockResultState:"Default",enableZeroQueryHintText:v,bestMatchConfig:{enabled:!0,maxResults:H},getProfilePictureUrl:t,scopesConfig:R,enableOaClient:x,entitiesEnabled:oe(I,E,A),e2eMetric:!0,updateResultsTimeout:h||5e3,customizedEmptyECCSuggestionsString:b,scopeToAppGptInlineSuggestion:_},hostMetadata:{appName:r,appPlatform:o,appScenario:a,releaseAudienceGroup:f?ne(f):u?Y.DOGFOOD:Y.PRODUCTION,sessionId:null!=s?s:(0,U.A)()},isTextPredictionEnabled:!0,isFeedbackEnabled:!0,serviceSettings:Object.assign({nudge:{enabled:!!(null==E?void 0:E.enableECCNudge),enableInlineNudge:!0,insertionCharacter:"/",automaticallyScope:!0},hybridAugloop:{enabled:x,enableGraphSearchLocal:x,enablePeriodicUpdates:null==E?void 0:E.enableHybridWorkflowPeriodicUpdates,wasmConfig:{binaryPath:P,scriptPath:P,disableModuleCache:"owa"!=(null==g?void 0:g.toLowerCase())&&"owahub"!=(null==g?void 0:g.toLocaleLowerCase())}},predictions:{enabled:!0,domInsertion:!0,allowMiddleOfSentencePredictions:!1},browseThisComputerSettings:m},_?{appGptConfig:{enableAppGpt:!0,onClickExploreMoreCopilots:O?void 0:C,moreCopilotsStringOverride:w}}:{}),defaultLocale:y||"en-US",controlIconSetName:"FabricMDL2Icons",synonymsEndPoint:M.i.Prod,editorEndPoint:ae(l,u),userId:{puid:d||"testUserId",tenantId:p||"testTenantId",userDisplayName:"",identityProvider:"MSA"===c?0:1},licenseType:V.G_.Subscription,sessionType:0,upsellLink:"https://upselllink",ignoreAllEnabled:!0,ignoreOnceEnabled:!0,enableOptimizedCallingPattern:!0,maxSuggestionItemsDisplayNumber:3,maxSuggestionDisplayPerLanguageNumber:2,enableOrchestration:!0,newLineSentenceSeparatorEnabled:!0,enableE2eMetric:!0,orchestratorSettings:{enableAugLoop:!0,augLoopEndpoint:ie(f,E),augLoopAuthTokenCallback:e,substrateAuthTokenCallback:n},manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enhancedUpsellEnabled:!1,premiumPreviewEnabled:!1,wordCountDetectorEnabled:!0,enabledCorrectionCategories:Q,enabledRefinementCategories:J,enabledEnhancementCategories:K,enableStopCheckingForThis:!0,useUiCoherence:T,doNotLimitToTargetDocument:!!q,enablePersistentStyleCopying:!!S}})(e,t,n,a),o,r)})),ce={itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},de={calloutStyles:{marginTop:4,width:300,borderRadius:2},containerStyles:{maxWidth:300,minWidth:300,borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},headerStyles:{paddingHorizontal:12},shimmerStyles:{circleSize:32,gapSize:12,lineSize:160,paddingTop:8,paddingHorizontal:12},itemsStyles:{sharedItemStyles:{height:48,paddingHorizontal:12,borderRadius:0,textHorizontalPadding:12,titleFontSize:14,subtitleFontSize:12},personItemStyles:{personaCoinSize:32},fileItemStyles:{iconStyles:{margin:4}},scopeItemStyles:{height:32,iconFontSize:16,personaCoinSize:16}},footerStyles:{height:44,marginHorizontal:0,marginBottom:-4}};var pe=n(340270);class fe{constructor(){this.editorProps=null,this.editorClient=null,this.currentQuery=null,this.currentTab=null,this.openCount=0,this.suggestionCount=0}static getInstance(){return fe.instance||(fe.instance=new fe),fe.instance}updateFlyoutStartTime(e=!1){this.flyoutStartTime=e?void 0:Date.now()}getLatencyForFlyout(){if(!this.flyoutStartTime)return;const e=(Date.now()-this.flyoutStartTime)/1e3;return this.updateFlyoutStartTime(!0),e}getEditorProps(){return this.editorProps?this.editorProps:void 0}getEditorClient(){return this.editorClient}getCurrentQuery(){return this.currentQuery}getCurrentTab(){return this.currentTab}getCurrentInvocationSource(){return this.currentInvocationSource}getScenario(){return this.scenario}bootstrapEditor(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,o,s,u,l,c,d,{eccQueryCharacter:p,targetElement:f,onEntitySelected:y,featureFlags:h,alSession:g,telemetrySink:m,entitiesEnabled:v,telemetryLogger:b,entityCustomProps:C}=e,w=(0,i.__rest)(e,["eccQueryCharacter","targetElement","onEntitySelected","featureFlags","alSession","telemetrySink","entitiesEnabled","telemetryLogger","entityCustomProps"]);(0,pe.jA)(function(e){var t,n;return null!==(t=null==e?void 0:e.isDogfoodEnvironment)&&void 0!==t?t:(null===(n=null==e?void 0:e.accountRing)||void 0===n?void 0:n.toLowerCase())===Z.DOGFOOD}(w)),(0,pe.q_)("BootstrapEditor Called"),this.telemetryLogger=b,null==b||b.logEvent({eventId:"EditorBootstrapTriggered"});const T=yield le(w,v,h,g,m,C);var q,S,I;this.editorClient=T,this.scenario=(q=w.appName,S=w.appPlatform,I=null!==(t=w.appScenario)&&void 0!==t?t:"",`${q}.${S}.${I}`),(0,pe.q_)("EditorClient Created"),null==b||b.logEvent({eventId:"EditorClientCreated",editorSessionId:null===(n=T.hostSettings.hostMetadata)||void 0===n?void 0:n.sessionId,metaData:JSON.stringify({enabledEntities:null===(o=null===(r=T.hostSettings)||void 0===r?void 0:r.oaSettings)||void 0===o?void 0:o.entitiesEnabled})}),T.onError=(e,t)=>{(0,pe.ZI)("EditorClient onError called",e),null==b||b.logEvent({eventId:(null==T?void 0:T.isEditorClientShutdown)?"ESDKShutdownError":"ESDKInitializeError",errorMessage:JSON.stringify(e)})},T.setAvailableCritiqueTypes(a);try{localStorage.removeItem("featureFlags");const e={value:'{"enableVisibilityTracker":"True","enableSimplifiedHost":"True","enableParagraphUpdates":"True","enableOrchestratorEmitAll":"True","enablePhraseTextUnitClientSide":"True","enableParagraphDeltas":"True","enableParagraphDeltasVerboseLogging":"True","enableParagraphDeltasEmptyInitialTile":"True","enableRequiredServiceDataOnly":"True","enableExperimentalECCQueryDetectionFixes":"True","enableLoggingModulesAndBindings":"False"}',lastUpdated:(new Date).getTime(),manualOverride:!0};localStorage.setItem("featureFlags",JSON.stringify(e))}catch(e){(0,pe.ZI)("Error setting localStorage feature flags",e),null==b||b.logEvent({eventId:"EditorClientLocalStorageFFOverrideError",editorSessionId:null===(s=T.hostSettings.hostMetadata)||void 0===s?void 0:s.sessionId,errorMessage:String(e)})}return yield T.initializeSDK(),yield T.initializeUX(f.ownerDocument),(0,pe.q_)("EditorClient Initialized"),this.updateEditorClientCorrelationID(null===(u=w.getClientCorrelationId)||void 0===u?void 0:u.call(w)),null==b||b.logEvent({eventId:"EditorClientInitialized",editorSessionId:null===(l=T.hostSettings.hostMetadata)||void 0===l?void 0:l.sessionId,metaData:JSON.stringify({enabledEntities:null===(d=null===(c=T.hostSettings)||void 0===c?void 0:c.oaSettings)||void 0===d?void 0:d.entitiesEnabled})}),T}))}enableInlineSuggestionsMenu({targetElement:e,eccQueryCharacter:t,entitiesEnabled:n,enableExpandedECC:i,onEntitySelected:a,onItemSelected:s,onClose:u,onOpen:l,telemetryLogger:c,featureFlags:d,theme:p=o.SV.light,suggestionTitleAndSubTitle:f,inlineSuggestionsStyles:y,getCIQSuggestionsFromClient:h,fluentV9Theme:g}){var m,v,b,C;(0,pe.q_)("EnableInlineSuggestionsMenu Called");const w=this.editorClient;if(null==w||w.attach(e),!(null==d?void 0:d.disableClientConfigQueryCharacterForEditorService))try{this.enableInlineSuggestions({entitiesEnabled:n,eccQueryCharacter:t,enableExpandedECC:i,onEntitySelected:a,onItemSelected:s,onClose:u,onOpen:l,telemetryLogger:c,featureFlags:d,suggestionTitleAndSubTitle:f,inlineSuggestionsStyles:y,fluentV9Theme:g})}catch(e){(0,pe.ZI)("Error in enableInlineSuggestionsMenu",e),null===(m=this.telemetryLogger)||void 0===m||m.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${t}. Error: `+JSON.stringify(e)})}if((null==d?void 0:d.enableAppGptsInCiq)||(null==d?void 0:d.enableAppPluginsInCiq)||(null==d?void 0:d.enableAppMessageExtensionsInCiq)||(null==d?void 0:d.enableAppPPInCiq)||(null==d?void 0:d.enableAppTypeBInCiq)){const e=[r.c.App],t=G;try{this.enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:t,enableExpandedECC:!1,onEntitySelected:a,onItemSelected:s,onClose:u,onOpen:l,telemetryLogger:c,featureFlags:d,suggestionTitleAndSubTitle:f,inlineSuggestionsStyles:y,getCIQSuggestionsFromClient:h,fluentV9Theme:g})}catch(e){(0,pe.ZI)("Error in enableInlineSuggestionsMenu",e),null===(v=this.telemetryLogger)||void 0===v||v.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${t}. Error: `+JSON.stringify(e)})}}if(null==d?void 0:d.enableTopicECC){const e=[r.c.Topic],t="#";try{this.enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:t,enableExpandedECC:!0,onEntitySelected:a,onItemSelected:s,onClose:u,onOpen:l,telemetryLogger:c,featureFlags:d,suggestionTitleAndSubTitle:f,inlineSuggestionsStyles:y,fluentV9Theme:g})}catch(e){(0,pe.ZI)("Error in enableInlineSuggestionsMenu",e),null===(b=this.telemetryLogger)||void 0===b||b.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${t}. Error: `+JSON.stringify(e)})}}null==w||w.updateCurrentTheme(p),null===(C=this.telemetryLogger)||void 0===C||C.logEvent({eventId:"EditorClientThemeChanged",message:`Theme changed to ${p} in enableInlineSuggestionsMenu`})}disableInlineSuggestionsMenu({eccQueryCharacter:e,featureFlags:t},n){var i,r,o;(0,pe.q_)("DisableInlineSuggestionsMenu Called");const a=null!=n?n:this.editorClient;if(!(null==t?void 0:t.disableClientConfigQueryCharacterForEditorService))try{null==a||a.disableInlineSuggestionsMenu(e)}catch(t){(0,pe.ZI)("Error in disableInlineSuggestionsMenu",t),null===(i=this.telemetryLogger)||void 0===i||i.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:`Error in Disable Menu for ciq char ${e}. Error: `+JSON.stringify(t)})}if(null==t?void 0:t.enableTopicECC)try{null==a||a.disableInlineSuggestionsMenu("#")}catch(e){(0,pe.ZI)("Error in disableInlineSuggestionsMenu",e),null===(r=this.telemetryLogger)||void 0===r||r.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:"Error in Disable Menu for ciq char #. Error: "+JSON.stringify(e)})}if((null==t?void 0:t.enableAppGptsInCiq)||(null==t?void 0:t.enableAppPluginsInCiq)||(null==t?void 0:t.enableAppMessageExtensionsInCiq)||(null==t?void 0:t.enableAppPPInCiq)||(null==t?void 0:t.enableAppTypeBInCiq))try{null==a||a.disableInlineSuggestionsMenu(G)}catch(e){(0,pe.ZI)("Error in disableInlineSuggestionsMenu",e),null===(o=this.telemetryLogger)||void 0===o||o.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:`Error in Disable Menu for ciq char ${G}. Error: `+JSON.stringify(e)})}}destroyEditor(e){var t,n,i;(0,pe.q_)("destroyEditor called");try{const t=null!=e?e:this.editorClient;!1===(null==t?void 0:t.isEditorClientShutdown)&&(null==t||t.shutDown())}catch(e){(0,pe.ZI)("Error in destroyEditor",e)}null===(t=this.telemetryLogger)||void 0===t||t.logEvent({eventId:"EditorClientDestroyed",editorSessionId:null===(i=null===(n=this.editorClient)||void 0===n?void 0:n.hostSettings.hostMetadata)||void 0===i?void 0:i.sessionId}),this.editorClient=null}setEntityScope(e){if(!this.editorClient)return;const t=((e="")=>{switch(!0){case/file/i.test(e):return r.c.File;case/(people)|(person)/i.test(e):return r.c.People;case/(event)|(meeting)/i.test(e):return r.c.Event;case/chat/i.test(e):return r.c.Chat;case/(message)|(email)/i.test(e):return r.c.Message;case/(topic)/i.test(e):return r.c.Topic;default:return}})(e);if(void 0===t)return void(0,pe.tH)(`Invoked setEntityScope with unsupported entity type ${e}`);const n=this.editorClient.exp_getQueryDetection();null==n||n.setCurrentScope({entityType:t},!1)}eccManuallyInitiated(e){if(!this.editorClient)return;const t=this.editorClient.exp_getQueryDetection();null==t||t.setNextDeltaProgramaticallyInserted(e)}notifyTriggeringType(e){if(!this.editorClient)return;const t=e;this.editorClient.notifyMenuTriggeringMethod(t)}updateCurrentTheme(e){var t,n;if(this.editorClient){try{this.editorClient.updateCurrentTheme(e),(0,pe.q_)("Theme updated for CIQ to ",e)}catch(e){return(0,pe.ZI)("Exception updating theme for CIQ:",e),void(null===(t=this.telemetryLogger)||void 0===t||t.logEvent({eventId:"EditorClientThemeChangedError",errorMessage:e?`${e}`:""}))}null===(n=this.telemetryLogger)||void 0===n||n.logEvent({eventId:"EditorClientThemeChanged",message:`Theme changed to ${e}`})}else(0,pe.tH)("updateCurrentTheme, EditorClient not initialized")}setUnsupportedEntities(e){if(!this.editorClient)return;0===e.length&&(0,pe.tH)("unSupported enities list is empty");const t=this.editorClient.exp_getQueryDetection();null==t||t.setUnsupportedEntities(e)}updateEditorClientCorrelationID(e){if(!this.editorClient)return;const t=this.editorClient.exp_getQueryDetection(),n=null!=e?e:"";null==t||t.setClientCorrelationId(n)}onItemSelected(e,t,n,i,a,s){var u,l,c;if((0,pe.q_)("onItemSelected called Suggestion: ",e),!t)return void(0,pe.tH)("ECC injection failed due to undefined queryRange");const d=e;null==a||a.logEvent({eventId:"ECCEntitySelected",editorSessionId:null===(l=null===(u=this.editorClient)||void 0===u?void 0:u.hostSettings.hostMetadata)||void 0===l?void 0:l.sessionId,entityType:e.type,metaData:JSON.stringify({expansionType:this.currentTab,logicalId:d.logicalId,InvocationSource:this.currentInvocationSource,id:d.ReferenceId})}),(null==a?void 0:a.log3sEvent)&&(null==a||a.log3sEvent({eventType:"SearchEntityActions",localTime:(new Date).toISOString(),logicalId:null!==(c=d.logicalId)&&void 0!==c?c:"",id:d.ReferenceId,scenario:this.scenario,metaData:JSON.stringify({expansionType:this.currentTab,InvocationSource:this.currentInvocationSource})}));const p=((e,t,n)=>{var i,a,s,u,l,c,d,p,f,y,h,g,m;let v,b,C,w,T,q,S,I;switch(e.type){case r.c.People:{const s=e;if(!(null==s?void 0:s.EmailAddresses)||!s.DisplayName)return(0,pe.tH)("People ECC injection failed due to missing EmailAddresses or DisplayName"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:r.c.People,message:"People ECC injection failed due to missing EmailAddresses or DisplayName"}));b=s.DisplayName,C=(null==t?void 0:t.enablePeopleQueryAnnotationV2)&&null!==(i=s.Id)&&void 0!==i?i:s.EmailAddresses[0],w="",T="",v={queryAnnotationType:o.in.People,text:b,id:C},S={id:C,referenceId:null!==(a=s.ReferenceId)&&void 0!==a?a:"",displayName:s.DisplayName,emailAddresses:s.EmailAddresses};break}case r.c.File:{const t=e;if(!(null==t?void 0:t.AccessUrl))return(0,pe.tH)("File ECC injection failed due to missing AccessUrl"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:r.c.File,message:"File ECC injection failed due to missing AccessUrl"}));b=t.FileName,C=null!==(u=null!==(s=t.SpoId)&&void 0!==s?s:t.SpoUniqueId)&&void 0!==u?u:"",w=t.AccessUrl,T=t.AlternateAccessUrl,q=t.FileExtension,v={queryAnnotationType:o.in.File,text:b,id:C},S={id:C,referenceId:null!==(l=t.ReferenceId)&&void 0!==l?l:"",fileName:t.FileName,accessUrl:t.AccessUrl,spoId:C,dateModified:null!==(c=t.DateModified)&&void 0!==c?c:"",lastModifiedDisplayName:null!==(d=t.ModifiedByDisplayName)&&void 0!==d?d:"",fileSize:t.FileSize,alternateAccessUrl:t.AlternateAccessUrl};break}case r.c.Event:{const t=e;if(!(null==t?void 0:t.OriginalId))return(0,pe.tH)("Event ECC injection failed due to missing OriginalId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:r.c.Event,message:"Event ECC injection failed due to missing OriginalId"}));b=t.Subject,C=t.OriginalId,w=null!==(p=t.WebLink)&&void 0!==p?p:"",T="";const i={id:null!==(y=null===(f=t.EventId)||void 0===f?void 0:f.Id)&&void 0!==y?y:""};v={queryAnnotationType:o.in.Event,text:b,id:C},S={id:C,referenceId:null!==(h=t.ReferenceId)&&void 0!==h?h:"",originalId:t.OriginalId,subject:t.Subject,skypeTeamsMeetingUrl:t.SkypeTeamsMeetingUrl,start:t.Start,end:t.End,organizerName:t.OrganizerName,organizerAddress:t.OrganizerAddress,eventId:i,attendees:null===(g=t.Attendees)||void 0===g?void 0:g.map((e=>{var t,n;return{emailAddress:{name:null!==(t=e.EmailAddress.Name)&&void 0!==t?t:"",address:null!==(n=e.EmailAddress.Address)&&void 0!==n?n:""}}}))};break}case r.c.Chat:{const t=e;if(!(null==t?void 0:t.ThreadId))return(0,pe.tH)("Chat ECC injection failed due to missing ThreadId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:r.c.Chat,message:"Chat ECC injection failed due to missing ThreadId"}));if(t.Name)b=t.Name;else if(t.ChatMembers){const e=2,n=t.ChatMembers.length-e;let i=t.ChatMembers.slice(0,e).map((e=>e.DisplayName)).join(", ");n>0&&(i+=`, +${n}`),b=i}else b="";C=t.ThreadId,w="",T="",v={queryAnnotationType:o.in.Chat,text:b,id:C};break}case r.c.Message:{const t=e;if(!(null==t?void 0:t.ImmutableId))return(0,pe.tH)("Email ECC injection failed due to missing ImmutableId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:r.c.Message,message:"Email ECC injection failed due to missing ImmutableId"}));b=t.Subject,C=null===(m=t.ImmutableId)||void 0===m?void 0:m.Id,w="",T="",v={queryAnnotationType:o.in.Message,text:b,id:C};break}case r.c.Topic:{const t=e;if(!(null==t?void 0:t.TopicId))return(0,pe.tH)("Topic ECC injection failed due to missing TopicId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:r.c.Topic,message:"Topic ECC injection failed due to missing TopicId"}));b=t.DisplayName,C=t.TopicId,w=t.Url,T="",v={queryAnnotationType:o.in.Topic,text:b,id:C};break}case r.c.App:if(!(null==e?void 0:e.AppId))return(0,pe.tH)("App ECC injection failed due to missing AppId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:r.c.App,message:"App ECC injection failed due to missing AppId"}));C=e.AppId,b="",w="",T="",I={appId:e.AppId,collectorId:e.CollectorId,appType:e.AppType,title:e.Title,iconUrl:e.IconAnonymousUrl};break;default:return(0,pe.tH)(`onItemSelected called with unsupported suggestion type ${e.type}`),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:e.type,message:`onItemSelected called with unsupported suggestion type ${e.type}`}))}return{ciqEntityElement:{entityType:e.type,id:C,text:b,url:w,fileExtension:q,alternateUrl:T},annotation:v,rawEntityData:S,atMentionApp:I}})(e,s,a);p&&(this.currentQuery=null,this.currentTab=null,null==i||i(p.ciqEntityElement,p.annotation,t,n,p.rawEntityData,p.atMentionApp))}onOpen(e,t,n){var i,r;this.currentInvocationSource=e.invocationSource?e.invocationSource:e.triggerCharacter;let o={expansionSource:this.currentInvocationSource};const a=this.getLatencyForFlyout();a&&this.currentInvocationSource===G&&(o=Object.assign(Object.assign({},o),{suggestionUpdateLatency:a,openCount:this.openCount,suggestionCount:this.suggestionCount})),this.updateFlyoutStartTime(),null==t||t.logEvent({eventId:"ECCOpened",editorSessionId:null===(r=null===(i=this.editorClient)||void 0===i?void 0:i.hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId,metaData:JSON.stringify(o)}),n&&n()}onClose(e,t,n,i){var r,o;(0,pe.q_)(`onClose, searchResultAccepted: ${e}, persistTime: `,t),null==n||n.logEvent({eventId:"ECCClosed",editorSessionId:null===(o=null===(r=this.editorClient)||void 0===r?void 0:r.hostSettings.hostMetadata)||void 0===o?void 0:o.sessionId,metaData:JSON.stringify({selectedEntity:e,openedTime:t})}),i&&i(e,t)}onAction(e,t){var n,i;(0,pe.q_)("onAction",e),null==t||t.logEvent({eventId:"ECCAction",editorSessionId:null===(i=null===(n=this.editorClient)||void 0===n?void 0:n.hostSettings.hostMetadata)||void 0===i?void 0:i.sessionId,metaData:JSON.stringify({actionId:e})})}onSuggestionsUpdatedFromClient(e,t,n,o,a){return(0,i.__awaiter)(this,void 0,void 0,(function*(){var i,s,u,l,c,d;const p=null!==(u=null===(s=null===(i=null==t?void 0:t[0])||void 0===i?void 0:i.entities[0])||void 0===s?void 0:s.logicalId)&&void 0!==u?u:"",f=yield e(null!==(l=this.currentInvocationSource)&&void 0!==l?l:"",null!=n?n:"");t[0]?t[0]=Object.assign(Object.assign({},t[0]),{entities:f}):t.push({entities:f,groupTitle:null==a?void 0:a.title,groupSubtitle:null==a?void 0:a.subtitle,entityType:r.c.App});const y=this.getLatencyForFlyout();return null==o||o.logEvent({eventId:"ECCSuggestionUpdated",editorSessionId:null===(d=null===(c=this.editorClient)||void 0===c?void 0:c.hostSettings.hostMetadata)||void 0===d?void 0:d.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:p,suggestionCount:t[0].entities.length.toString(),isQueryStringEmpty:""===n?"true":"false",suggestionUpdateLatency:null!=y?y:void 0,openCount:this.openCount,clientOverride:"true"})}),t}))}onSuggestionsUpdated(e,t,n,i,o,a,s){var u,l,c,d,p,f,y;let h,g="";if(0===t&&e[0]&&e[0].entities.length>0&&s&&(null==n?void 0:n.entityType)===r.c.App){const n=e[0].entities.filter((e=>{var t;return!(null===(t=null==e?void 0:e.GptIdentifier)||void 0===t?void 0:t.Id.includes("ProjectedDeclarativeAgent"))}));e[0]=Object.assign(Object.assign({},e[0]),{entities:n}),t=n.length>0?0:1}if(0===t&&e[0]&&e[0].entities.length>0){g=null!==(u=e[0].entities[0].logicalId)&&void 0!==u?u:"",this.currentTab=null!==(l=null==n?void 0:n.entityType)&&void 0!==l?l:"All";const t=((e,t)=>{var n,i,r,o,a;let s=null!==(n=e[0].entities[0].logicalId)&&void 0!==n?n:"",u=1;const l=[];if(t)for(const n of e[0].entities){const e=n;s=""!=s?s:null!==(i=e.logicalId)&&void 0!==i?i:"",l.push(te(null!==(r=e.ReferenceId)&&void 0!==r?r:"",t.entityType,u)),u++}else for(const t of e)for(const e of t.entities)if(e.isBestMatch){const t=e;s=""!=s?s:null!==(o=t.logicalId)&&void 0!==o?o:"",l.push(te(null!==(a=t.ReferenceId)&&void 0!==a?a:"",e.entityType,u)),u++}return l})(e,n);if(n)try{h=JSON.stringify({Type:"Group",Name:this.currentTab,ReferenceId:null,EntityType:null,LayoutType:"Vertical",Position:1,ResultsView:t})}catch(e){(0,pe.ZI)("Error in onSuggestionsUpdated",e)}if(o)for(const t of e)t.groupTitle=o.title,t.groupSubtitle=o.subtitle;const r=this.getLatencyForFlyout();null==i||i.logEvent({eventId:"ECCSuggestionUpdated",editorSessionId:null===(d=null===(c=this.editorClient)||void 0===c?void 0:c.hostSettings.hostMetadata)||void 0===d?void 0:d.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:g,suggestionCount:e[0].entities.length.toString(),isQueryStringEmpty:""===a?"true":"false",suggestionUpdateLatency:null!=r?r:void 0})}),(null==i?void 0:i.log3sEvent)&&(null==i||i.log3sEvent({localTime:(new Date).toISOString(),eventType:"ClientLayout",logicalId:g,id:g,scenario:this.scenario,resultsView:h?JSON.stringify(h):void 0,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:g})}))}else if(1===t||3===t){this.currentTab=null!==(p=null==n?void 0:n.entityType)&&void 0!==p?p:"All";const e=this.getLatencyForFlyout();null==i||i.logEvent({eventId:"ECCEmptySuggestionUpdated",editorSessionId:null===(y=null===(f=this.editorClient)||void 0===f?void 0:f.hostSettings.hostMetadata)||void 0===y?void 0:y.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:g,isQueryStringEmpty:""===a?"true":"false",suggestionUpdateLatency:null!=e?e:void 0,status:1===t?"NoResults":"Timeout"})})}}enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:t,enableExpandedECC:n,onEntitySelected:o,onItemSelected:a,onClose:s,onOpen:u,telemetryLogger:l,featureFlags:c,suggestionTitleAndSubTitle:d,inlineSuggestionsStyles:p,getCIQSuggestionsFromClient:f,fluentV9Theme:y}){var h;const g=this.editorClient;null==g||g.enableInlineSuggestionsMenu(e,t,a||((e,t,n)=>{this.onItemSelected(e,t,n,o,l,c)}),void 0,void 0,{fitToContent:!0},p||((null==c?void 0:c.enableSingleEntityStyle)?de:ce),(e=>{this.onOpen(e,l,u)}),((e,t)=>{this.onClose(e,t,l,s)}),(e=>{this.onAction(e,l)}),void 0,((e,t,n,o,a,s)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=f&&(null==s?void 0:s.entityType)===r.c.App;if(a&&!n)return this.openCount=0,void(this.suggestionCount=0);if(n){const n=yield this.onSuggestionsUpdatedFromClient(f,e,t,l,d);return a&&""===t&&(this.openCount++,this.suggestionCount=n[0].entities.length,this.updateFlyoutStartTime()),n}return this.onSuggestionsUpdated(e,o,s,l,d,t,null==c?void 0:c.disablePluginsAsDAInFlyout),e}))),(()=>{}),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,n,void 0,void 0,y),null==l||l.logEvent({eventId:"EditorClientInlineSuggestionsEnabled",editorSessionId:null===(h=null==g?void 0:g.hostSettings.hostMetadata)||void 0===h?void 0:h.sessionId,metaData:JSON.stringify({eccQueryCharacter:t})})}}var ye=n(275075),he=n(204128)},252843:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>v});var i=n(208520),r=n(794329),o=n(143007),a=n.n(o),s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function u(e,t){return e(t={exports:{}},t.exports),t.exports}var l=u((function(e){!function(t){var n=function(e,t,i){if(!u(t)||c(t)||d(t)||p(t)||s(t))return t;var r,o=0,a=0;if(l(t))for(r=[],a=t.length;o<a;o++)r.push(n(e,t[o],i));else for(var f in r={},t)Object.prototype.hasOwnProperty.call(t,f)&&(r[e(f,i)]=n(e,t[f],i));return r},i=function(e){return f(e)?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1)},r=function(e){var t=i(e);return t.substr(0,1).toUpperCase()+t.substr(1)},o=function(e,t){return function(e,t){var n=(t=t||{}).separator||"_",i=t.split||/(?=[A-Z])/;return e.split(i).join(n)}(e,t).toLowerCase()},a=Object.prototype.toString,s=function(e){return"function"==typeof e},u=function(e){return e===Object(e)},l=function(e){return"[object Array]"==a.call(e)},c=function(e){return"[object Date]"==a.call(e)},d=function(e){return"[object RegExp]"==a.call(e)},p=function(e){return"[object Boolean]"==a.call(e)},f=function(e){return(e-=0)==e},y=function(e,t){var n=t&&"process"in t?t.process:t;return"function"!=typeof n?e:function(t,i){return n(t,e,i)}},h={camelize:i,decamelize:o,pascalize:r,depascalize:o,camelizeKeys:function(e,t){return n(y(i,t),e)},decamelizeKeys:function(e,t){return n(y(o,t),e,t)},pascalizeKeys:function(e,t){return n(y(r,t),e)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};e.exports?e.exports=h:t.humps=h}(s)})).decamelize,c=u((function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},t.apply(this,arguments)}e.exports=t})),d=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i},p=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},f=function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r},y=(0,i.createContext)(null);function h(e){var t=e.root,n=e.children;return(0,r.createPortal)(n,t)}h.propTypes={root:a().object.isRequired,children:a().node},h.defaultProps={children:null};var g=new Map;var m=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"core",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.children};return new Proxy(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{get:function(n,r){var o=l(r,{separator:"-"}),s="".concat(e,"-").concat(o);return g.has(s)||g.set(s,function(e){var t=(0,i.forwardRef)((function(t,n){var r,o,a=t.mode,s=t.delegatesFocus,u=t.styleSheets,l=t.ssr,d=t.children,g=f(t,["mode","delegatesFocus","styleSheets","ssr","children"]),m=(o=(0,i.useRef)((r=n)&&r.current),(0,i.useEffect)((function(){r&&(r.current=o.current)}),[r]),o),v=(0,i.useState)(null),b=p(v,2),C=b[0],w=b[1],T="node_".concat(a).concat(s);return(0,i.useLayoutEffect)((function(){if(m.current)try{if("function"==typeof n&&n(m.current),l){var e=m.current.shadowRoot;return void w(e)}var t=m.current.attachShadow({mode:a,delegatesFocus:s});u.length>0&&(t.adoptedStyleSheets=u),w(t)}catch(e){!function(e){var t=e.error,n=e.styleSheets,i=e.root;if("NotSupportedError"!==t.name)throw t;n.length>0&&(i.adoptedStyleSheets=n)}({error:e,styleSheets:u,root:C})}}),[n,m,u]),i.createElement(i.Fragment,null,i.createElement(e.tag,c({key:T,ref:m},g),(C||l)&&i.createElement(y.Provider,{value:C},l?i.createElement("template",{shadowroot:"open"},e.render({root:C,ssr:l,children:d})):i.createElement(h,{root:C},e.render({root:C,ssr:l,children:d})))))}));return t.propTypes={mode:a().oneOf(["open","closed"]),delegatesFocus:a().bool,styleSheets:a().arrayOf(a().instanceOf(globalThis.CSSStyleSheet)),ssr:a().bool,children:a().node},t.defaultProps={mode:"open",delegatesFocus:!1,styleSheets:[],ssr:!1,children:null},t}({tag:o,render:t})),g.get(s)}})}();const v=m},424447:(e,t,n)=>{"use strict";n.d(t,{KV:()=>E});var i=n(758651);var r=n(72715);const o=void 0!==r&&r.env&&r.env.DEBUG||void 0;let a,s=[],u=[];const l=[];o&&d(o);const c=Object.assign((e=>f(e)),{enable:d,enabled:p,disable:function(){const e=a||"";return d(""),e},log:function(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?i.error(...e):t.includes(":warning")?i.warn(...e):t.includes(":info")?i.info(...e):(t.includes(":verbose"),i.debug(...e))}}});function d(e){a=e,s=[],u=[];const t=/\*/g,n=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const e of n)e.startsWith("-")?u.push(new RegExp(`^${e.substr(1)}$`)):s.push(new RegExp(`^${e}$`));for(const e of l)e.enabled=p(e.namespace)}function p(e){if(e.endsWith("*"))return!0;for(const t of u)if(t.test(e))return!1;for(const t of s)if(t.test(e))return!0;return!1}function f(e){const t=Object.assign((function(...n){if(!t.enabled)return;n.length>0&&(n[0]=`${e} ${n[0]}`);t.log(...n)}),{enabled:p(e),destroy:y,log:c.log,namespace:e,extend:h});return l.push(t),t}function y(){const e=l.indexOf(this);return e>=0&&(l.splice(e,1),!0)}function h(e){const t=f(`${this.namespace}:${e}`);return t.log=this.log,t}const g=c;var m=n(72715),v=n(758651);const b=["verbose","info","warning","error"],C={verbose:400,info:300,warning:200,error:100};function w(e,t){t.log=(...t)=>{e.log(...t)}}function T(e){return b.includes(e)}function q(e){const t=new Set,n=void 0!==m&&m.env&&m.env[e.logLevelEnvVarName]||void 0;let i;const r=g(e.namespace);function o(e){return Boolean(i&&C[e.level]<=C[i])}function a(e,n){const i=Object.assign(e.extend(n),{level:n});if(w(e,i),o(i)){const e=g.disable();g.enable(e+","+i.namespace)}return t.add(i),i}return r.log=(...e)=>{g.log(...e)},n&&(T(n)?function(e){S.setLogLevel(e)}(n):v.error(`${e.logLevelEnvVarName} set to unknown log level '${n}'; logging is not enabled. Acceptable values: ${b.join(", ")}.`)),{setLogLevel(e){if(e&&!T(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${b.join(",")}`);i=e;const n=[];for(const e of t)o(e)&&n.push(e.namespace);g.enable(n.join(","))},getLogLevel:()=>i,createClientLogger(e){const t=r.extend(e);return w(r,t),{error:a(t,"error"),warning:a(t,"warning"),info:a(t,"info"),verbose:a(t,"verbose")}},logger:r}}const S=q({logLevelEnvVarName:"TYPESPEC_RUNTIME_LOG_LEVEL",namespace:"typeSpecRuntime"});S.logger;const I=q({logLevelEnvVarName:"AZURE_LOG_LEVEL",namespace:"azure"});I.logger;function E(e){return I.createClientLogger(e)}},442052:(e,t,n)=>{"use strict";function i(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function r(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}n.d(t,{Nl:()=>$,fj:()=>F,rl:()=>d});const o="$",a="_";const s=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;const u=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function l(e,t){var n,i;const r=e.parsedHeaders;if("HEAD"===e.request.method)return Object.assign(Object.assign({},r),{body:e.parsedBody});const o=t&&t.bodyMapper,a=Boolean(null==o?void 0:o.nullable),s=null==o?void 0:o.type.name;if("Stream"===s)return Object.assign(Object.assign({},r),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody});const u="Composite"===s&&o.type.modelProperties||{},l=Object.keys(u).some((e=>""===u[e].serializedName));if("Sequence"===s||l){const t=null!==(n=e.parsedBody)&&void 0!==n?n:[];for(const n of Object.keys(u))u[n].serializedName&&(t[n]=null===(i=e.parsedBody)||void 0===i?void 0:i[n]);if(r)for(const e of Object.keys(r))t[e]=r[e];return!a||e.parsedBody||r||0!==Object.getOwnPropertyNames(u).length?t:null}return function(e){const t=Object.assign(Object.assign({},e.headers),e.body);return e.hasNullableType&&0===Object.getOwnPropertyNames(t).length?e.shouldWrapBody?{body:null}:null:e.shouldWrapBody?Object.assign(Object.assign({},e.headers),{body:e.body}):t}({body:e.parsedBody,headers:r,hasNullableType:a,shouldWrapBody:(c=e.parsedBody,d=s,"Composite"!==d&&"Dictionary"!==d&&("string"==typeof c||"number"==typeof c||"boolean"==typeof c||null!==(null==d?void 0:d.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))||null==c))});var c,d}class c{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){const i=(e,i)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${e}": ${i}.`)};if(e.constraints&&null!=t){const{ExclusiveMaximum:n,ExclusiveMinimum:r,InclusiveMaximum:o,InclusiveMinimum:a,MaxItems:s,MaxLength:u,MinItems:l,MinLength:c,MultipleOf:d,Pattern:p,UniqueItems:f}=e.constraints;if(void 0!==n&&t>=n&&i("ExclusiveMaximum",n),void 0!==r&&t<=r&&i("ExclusiveMinimum",r),void 0!==o&&t>o&&i("InclusiveMaximum",o),void 0!==a&&t<a&&i("InclusiveMinimum",a),void 0!==s&&t.length>s&&i("MaxItems",s),void 0!==u&&t.length>u&&i("MaxLength",u),void 0!==l&&t.length<l&&i("MinItems",l),void 0!==c&&t.length<c&&i("MinLength",c),void 0!==d&&t%d!==0&&i("MultipleOf",d),p){const e="string"==typeof p?new RegExp(p):p;"string"==typeof t&&null!==t.match(e)||i("Pattern",p)}f&&t.some(((e,t,n)=>n.indexOf(e)!==t))&&i("UniqueItems",f)}}serialize(e,t,n,r={xml:{}}){var l,c,d;const g={xml:{rootName:null!==(l=r.xml.rootName)&&void 0!==l?l:"",includeRoot:null!==(c=r.xml.includeRoot)&&void 0!==c&&c,xmlCharKey:null!==(d=r.xml.xmlCharKey)&&void 0!==d?d:a}};let b={};const C=e.type.name;n||(n=e.serializedName),null!==C.match(/^Sequence$/i)&&(b=[]),e.isConstant&&(t=e.defaultValue);const{required:w,nullable:T}=e;if(w&&T&&void 0===t)throw new Error(`${n} cannot be undefined.`);if(w&&!T&&null==t)throw new Error(`${n} cannot be null or undefined.`);if(!w&&!1===T&&null===t)throw new Error(`${n} cannot be null.`);if(null==t)b=t;else if(null!==C.match(/^any$/i))b=t;else if(null!==C.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i))b=function(e,t,n){if(null!=n)if(null!==e.match(/^Number$/i)){if("number"!=typeof n)throw new Error(`${t} with value ${n} must be of type number.`)}else if(null!==e.match(/^String$/i)){if("string"!=typeof n.valueOf())throw new Error(`${t} with value "${n}" must be of type string.`)}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof n.valueOf()||(i=n,!u.test(i)))throw new Error(`${t} with value "${n}" must be of type string and a valid uuid.`)}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof n)throw new Error(`${t} with value ${n} must be of type boolean.`)}else if(null!==e.match(/^Stream$/i)){const e=typeof n;if(!("string"===e||"function"==typeof n.pipe||"function"==typeof n.tee||n instanceof ArrayBuffer||ArrayBuffer.isView(n)||("function"==typeof Blob||"object"==typeof Blob)&&n instanceof Blob||"function"===e))throw new Error(`${t} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}var i;return n}(C,n,t);else if(null!==C.match(/^Enum$/i)){b=function(e,t,n){if(!t)throw new Error(`Please provide a set of allowedValues to validate ${e} as an Enum Type.`);if(!t.some((e=>"string"==typeof e.valueOf()?e.toLowerCase()===n.toLowerCase():e===n)))throw new Error(`${n} is not a valid value for ${e}. The valid values are: ${JSON.stringify(t)}.`);return n}(n,e.type.allowedValues,t)}else null!==C.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?b=function(e,t,n){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123 format.`);t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);t=function(e){if(!e)return;"string"==typeof e.valueOf()&&(e=new Date(e));return Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!function(e){return s.test(e)}(t))throw new Error(`${n} must be a string in ISO 8601 format. Instead was "${t}".`);return t}(C,t,n):null!==C.match(/^ByteArray$/i)?b=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=i(t)}return t}(n,t):null!==C.match(/^Base64Url$/i)?b=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=function(e){if(!e)return;if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){let n=e.length;for(;n-1>=0&&e[n-1]===t;)--n;return e.substr(0,n)}(i(e),"=").replace(/\+/g,"-").replace(/\//g,"_")}(t)}return t}(n,t):null!==C.match(/^Sequence$/i)?b=function(e,t,n,i,r,a){var s;if(!Array.isArray(n))throw new Error(`${i} must be of type Array.`);let u=t.type.element;if(!u||"object"!=typeof u)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${i}.`);"Composite"===u.type.name&&u.type.className&&(u=null!==(s=e.modelMappers[u.type.className])&&void 0!==s?s:u);const l=[];for(let t=0;t<n.length;t++){const s=e.serialize(u,n[t],i,a);if(r&&u.xmlNamespace){const e=u.xmlNamespacePrefix?`xmlns:${u.xmlNamespacePrefix}`:"xmlns";"Composite"===u.type.name?(l[t]=Object.assign({},s),l[t][o]={[e]:u.xmlNamespace}):(l[t]={},l[t][a.xml.xmlCharKey]=s,l[t][o]={[e]:u.xmlNamespace})}else l[t]=s}return l}(this,e,t,n,Boolean(this.isXML),g):null!==C.match(/^Dictionary$/i)?b=function(e,t,n,i,r,a){if("object"!=typeof n)throw new Error(`${i} must be of type object.`);const s=t.type.value;if(!s||"object"!=typeof s)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${i}.`);const u={};for(const t of Object.keys(n)){const o=e.serialize(s,n[t],i,a);u[t]=h(s,o,r,a)}if(r&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns",n=u;return n[o]={[e]:t.xmlNamespace},n}return u}(this,e,t,n,Boolean(this.isXML),g):null!==C.match(/^Composite$/i)&&(b=function(e,t,n,i,r,a){v(e,t)&&(t=m(e,t,n,"clientName"));if(null!=n){const s={},u=y(e,t,i);for(const l of Object.keys(u)){const c=u[l];if(c.readOnly)continue;let d,f=s;if(e.isXML)d=c.xmlIsWrapped?c.xmlName:c.xmlElementName||c.xmlName;else{const e=p(c.serializedName);d=e.pop();for(const t of e){const e=f[t];null==e&&(void 0!==n[l]&&null!==n[l]||void 0!==c.defaultValue)&&(f[t]={}),f=f[t]}}if(null!=f){if(r&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns";f[o]=Object.assign(Object.assign({},f[o]),{[e]:t.xmlNamespace})}const s=""!==c.serializedName?i+"."+c.serializedName:i;let u=n[l];const p=v(e,t);p&&p.clientName===l&&null==u&&(u=t.serializedName);const y=e.serialize(c,u,s,a);if(void 0!==y&&null!=d){const e=h(c,y,r,a);r&&c.xmlIsAttribute?(f[o]=f[o]||{},f[o][d]=y):r&&c.xmlIsWrapped?f[d]={[c.xmlElementName]:e}:f[d]=e}}}const l=function(e,t,n){const i=t.type.additionalProperties;if(!i&&t.type.className){const i=f(e,t,n);return null==i?void 0:i.type.additionalProperties}return i}(e,t,i);if(l){const t=Object.keys(u);for(const r in n){t.every((e=>e!==r))&&(s[r]=e.serialize(l,n[r],i+'["'+r+'"]',a))}}return s}return n}(this,e,t,n,Boolean(this.isXML),g));return b}deserialize(e,t,n,i={xml:{}}){var s,u,l,c;const d={xml:{rootName:null!==(s=i.xml.rootName)&&void 0!==s?s:"",includeRoot:null!==(u=i.xml.includeRoot)&&void 0!==u&&u,xmlCharKey:null!==(l=i.xml.xmlCharKey)&&void 0!==l?l:a},ignoreUnknownProperties:null!==(c=i.ignoreUnknownProperties)&&void 0!==c&&c};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;let f;const h=e.type.name;if(n||(n=e.serializedName),null!==h.match(/^Composite$/i))f=function(e,t,n,i,r){var s,u;const l=null!==(s=r.xml.xmlCharKey)&&void 0!==s?s:a;v(e,t)&&(t=m(e,t,n,"serializedName"));const c=y(e,t,i);let d={};const f=[];for(const a of Object.keys(c)){const s=c[a],y=p(c[a].serializedName);f.push(y[0]);const{serializedName:h,xmlName:g,xmlElementName:m}=s;let v=i;""!==h&&void 0!==h&&(v=i+"."+h);const b=s.headerCollectionPrefix;if(b){const t={};for(const i of Object.keys(n))i.startsWith(b)&&(t[i.substring(b.length)]=e.deserialize(s.type.value,n[i],v,r)),f.push(i);d[a]=t}else if(e.isXML)if(s.xmlIsAttribute&&n[o])d[a]=e.deserialize(s,n[o][g],v,r);else if(s.xmlIsMsText)void 0!==n[l]?d[a]=n[l]:"string"==typeof n&&(d[a]=n);else{const t=m||g||h;if(s.xmlIsWrapped){const t=n[g],i=null!==(u=null==t?void 0:t[m])&&void 0!==u?u:[];d[a]=e.deserialize(s,i,v,r),f.push(g)}else{const i=n[t];d[a]=e.deserialize(s,i,v,r),f.push(t)}}else{let i,o=n,u=0;for(const e of y){if(!o)break;u++,o=o[e]}null===o&&u<y.length&&(o=void 0),i=o;const l=t.type.polymorphicDiscriminator;let p;if(l&&a===l.clientName&&null==i&&(i=t.serializedName),Array.isArray(n[a])&&""===c[a].serializedName){i=n[a];const t=e.deserialize(s,i,v,r);for(const[e,n]of Object.entries(d))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=n);d=t}else void 0===i&&void 0===s.defaultValue||(p=e.deserialize(s,i,v,r),d[a]=p)}}const h=t.type.additionalProperties;if(h){const t=e=>{for(const t in c){if(p(c[t].serializedName)[0]===e)return!1}return!0};for(const o in n)t(o)&&(d[o]=e.deserialize(h,n[o],i+'["'+o+'"]',r))}else if(n&&!r.ignoreUnknownProperties)for(const e of Object.keys(n))void 0!==d[e]||f.includes(e)||g(e,r)||(d[e]=n[e]);return d}(this,e,t,n,d);else{if(this.isXML){const e=d.xml.xmlCharKey;void 0!==t[o]&&void 0!==t[e]&&(t=t[e])}null!==h.match(/^Number$/i)?(f=parseFloat(t),isNaN(f)&&(f=t)):null!==h.match(/^Boolean$/i)?f="true"===t||"false"!==t&&t:null!==h.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?f=t:null!==h.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?f=new Date(t):null!==h.match(/^UnixTime$/i)?f=function(e){if(!e)return;return new Date(1e3*e)}(t):null!==h.match(/^ByteArray$/i)?f=r(t):null!==h.match(/^Base64Url$/i)?f=function(e){if(!e)return;if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return r(e=e.replace(/-/g,"+").replace(/_/g,"/"))}(t):null!==h.match(/^Sequence$/i)?f=function(e,t,n,i,r){var o;let a=t.type.element;if(!a||"object"!=typeof a)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${i}`);if(n){Array.isArray(n)||(n=[n]),"Composite"===a.type.name&&a.type.className&&(a=null!==(o=e.modelMappers[a.type.className])&&void 0!==o?o:a);const t=[];for(let o=0;o<n.length;o++)t[o]=e.deserialize(a,n[o],`${i}[${o}]`,r);return t}return n}(this,e,t,n,d):null!==h.match(/^Dictionary$/i)&&(f=function(e,t,n,i,r){const o=t.type.value;if(!o||"object"!=typeof o)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${i}`);if(n){const t={};for(const a of Object.keys(n))t[a]=e.deserialize(o,n[a],i,r);return t}return n}(this,e,t,n,d))}return e.isConstant&&(f=e.defaultValue),f}}function d(e={},t=!1){return new c(e,t)}function p(e){const t=[];let n="";if(e){const i=e.split(".");for(const e of i)"\\"===e.charAt(e.length-1)?n+=e.substr(0,e.length-1)+".":(n+=e,t.push(n),n="")}return t}function f(e,t,n){const i=t.type.className;if(!i)throw new Error(`Class name for model "${n}" is not provided in the mapper "${JSON.stringify(t,void 0,2)}".`);return e.modelMappers[i]}function y(e,t,n){let i=t.type.modelProperties;if(!i){const r=f(e,t,n);if(!r)throw new Error(`mapper() cannot be null or undefined for model "${t.type.className}".`);if(i=null==r?void 0:r.type.modelProperties,!i)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(r)}" of type "${t.type.className}" for object "${n}".`)}return i}function h(e,t,n,i){if(!n||!e.xmlNamespace)return t;const r=e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns",a={[r]:e.xmlNamespace};if(["Composite"].includes(e.type.name)){if(t[o])return t;{const e=Object.assign({},t);return e[o]=a,e}}const s={};return s[i.xml.xmlCharKey]=t,s[o]=a,s}function g(e,t){return[o,t.xml.xmlCharKey].includes(e)}function m(e,t,n,i){var r;const o=v(e,t);if(o){let a=o[i];if(a){"serializedName"===i&&(a=a.replace(/\\/gi,""));const o=n[a],s=null!==(r=t.type.uberParent)&&void 0!==r?r:t.type.className;if("string"==typeof o&&s){const n=function(e,t,n){const i=[n];for(;i.length;){const n=i.shift(),r=t===n?t:n+"."+t;if(Object.prototype.hasOwnProperty.call(e,r))return e[r];for(const[t,r]of Object.entries(e))t.startsWith(n+".")&&r.type.uberParent===n&&r.type.className&&i.push(r.type.className)}}(e.modelMappers.discriminators,o,s);n&&(t=n)}}}return t}function v(e,t){return t.type.polymorphicDiscriminator||b(e,t.type.uberParent)||b(e,t.type.className)}function b(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}const C="Sequence",w="String",T="Stream";var q=n(231559);const S={operationRequestMap:new WeakMap};function I(e,t,n){let i=t.parameterPath;const r=t.mapper;let o;if("string"==typeof i&&(i=[i]),Array.isArray(i)){if(i.length>0)if(r.isConstant)o=r.defaultValue;else{let t=E(e,i);!t.propertyFound&&n&&(t=E(n,i));let a=!1;t.propertyFound||(a=r.required||"options"===i[0]&&2===i.length),o=a?r.defaultValue:t.propertyValue}}else{r.required&&(o={});for(const t in i){const a=r.type.modelProperties[t],s=I(e,{parameterPath:i[t],mapper:a},n);void 0!==s&&(o||(o={}),o[t]=s)}}return o}function E(e,t){const n={propertyFound:!1};let i=0;for(;i<t.length;++i){const n=t[i];if(!e||!(n in e))break;e=e[n]}return i===t.length&&(n.propertyValue=e,n.propertyFound=!0),n}const A=Symbol.for("@azure/core-client original request");function P(e){if(function(e){return A in e}(e))return P(e[A]);let t=S.operationRequestMap.get(e);return t||(t={},S.operationRequestMap.set(e,t)),t}const x=["application/json","text/json"],_=["application/xml","application/atom+xml"];function O(e={}){var t,n,i,r,o,s,u;const l=null!==(n=null===(t=e.expectedContentTypes)||void 0===t?void 0:t.json)&&void 0!==n?n:x,c=null!==(r=null===(i=e.expectedContentTypes)||void 0===i?void 0:i.xml)&&void 0!==r?r:_,d=e.parseXML,p=e.serializerOptions,f={xml:{rootName:null!==(o=null==p?void 0:p.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(s=null==p?void 0:p.xml.includeRoot)&&void 0!==s&&s,xmlCharKey:null!==(u=null==p?void 0:p.xml.xmlCharKey)&&void 0!==u?u:a}};return{name:"deserializationPolicy",async sendRequest(e,t){const n=await t(e);return async function(e,t,n,i,r){const o=await async function(e,t,n,i,r){var o;if(!(null===(o=n.request.streamResponseStatusCodes)||void 0===o?void 0:o.has(n.status))&&n.bodyAsText){const o=n.bodyAsText,a=n.headers.get("Content-Type")||"",s=a?a.split(";").map((e=>e.toLowerCase())):[];try{if(0===s.length||s.some((t=>-1!==e.indexOf(t))))return n.parsedBody=JSON.parse(o),n;if(s.some((e=>-1!==t.indexOf(e)))){if(!r)throw new Error("Parsing XML not supported.");const e=await r(o,i.xml);return n.parsedBody=e,n}}catch(e){const t=`Error "${e}" occurred while parsing the response body - ${n.bodyAsText}.`,i=e.code||q.pj.PARSE_ERROR;throw new q.pj(t,{code:i,statusCode:n.status,request:n.request,response:n})}}return n}(e,t,n,i,r);if(!function(e){const t=e.request,n=P(t),i=null==n?void 0:n.shouldDeserialize;let r;r=void 0===i||("boolean"==typeof i?i:i(e));return r}(o))return o;const a=P(o.request),s=null==a?void 0:a.operationSpec;if(!s||!s.responses)return o;const u=function(e){let t;const n=e.request,i=P(n),r=null==i?void 0:i.operationSpec;r&&(t=(null==i?void 0:i.operationResponseGetter)?null==i?void 0:i.operationResponseGetter(r,e):r.responses[e.status]);return t}(o),{error:l,shouldReturnResponse:c}=function(e,t,n,i){var r;const o=200<=e.status&&e.status<300,a=function(e){const t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?o:!!n;if(a){if(!n)return{error:null,shouldReturnResponse:!1};if(!n.isError)return{error:null,shouldReturnResponse:!1}}const s=null!=n?n:t.responses.default,u=(null===(r=e.request.streamResponseStatusCodes)||void 0===r?void 0:r.has(e.status))?`Unexpected status code: ${e.status}`:e.bodyAsText,l=new q.pj(u,{statusCode:e.status,request:e.request,response:e});if(!s)throw l;const c=s.bodyMapper,d=s.headersMapper;try{if(e.parsedBody){const n=e.parsedBody;let r;if(c){let e=n;if(t.isXML&&c.type.name===C){e=[];const t=c.xmlElementName;"object"==typeof n&&t&&(e=n[t])}r=t.serializer.deserialize(c,e,"error.response.parsedBody",i)}const o=n.error||r||n;l.code=o.code,o.message&&(l.message=o.message),c&&(l.response.parsedBody=r)}e.headers&&d&&(l.response.parsedHeaders=t.serializer.deserialize(d,e.headers.toJSON(),"operationRes.parsedHeaders"))}catch(t){l.message=`Error "${t.message}" occurred in deserializing the responseBody - "${e.bodyAsText}" for the default response.`}return{error:l,shouldReturnResponse:!1}}(o,s,u,i);if(l)throw l;if(c)return o;if(u){if(u.bodyMapper){let e=o.parsedBody;s.isXML&&u.bodyMapper.type.name===C&&(e="object"==typeof e?e[u.bodyMapper.xmlElementName]:[]);try{o.parsedBody=s.serializer.deserialize(u.bodyMapper,e,"operationRes.parsedBody",i)}catch(e){throw new q.pj(`Error ${e} occurred in deserializing the responseBody - ${o.bodyAsText}`,{statusCode:o.status,request:o.request,response:o})}}else"HEAD"===s.httpMethod&&(o.parsedBody=n.status>=200&&n.status<300);u.headersMapper&&(o.parsedHeaders=s.serializer.deserialize(u.headersMapper,o.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return o}(l,c,n,f,d)}}}function R(e){const{parameterPath:t,mapper:n}=e;let i;return i="string"==typeof t?t:Array.isArray(t)?t.join("."):n.serializedName,i}function D(e={}){const t=e.stringifyXML;return{name:"serializationPolicy",async sendRequest(e,n){const i=P(e),r=null==i?void 0:i.operationSpec,s=null==i?void 0:i.operationArguments;return r&&s&&(function(e,t,n){var i,r;if(n.headerParameters)for(const i of n.headerParameters){let r=I(t,i);if(null!=r||i.mapper.required){r=n.serializer.serialize(i.mapper,r,R(i));const t=i.mapper.headerCollectionPrefix;if(t)for(const n of Object.keys(r))e.headers.set(t+n,r[n]);else e.headers.set(i.mapper.serializedName||R(i),r)}}const o=null===(r=null===(i=t.options)||void 0===i?void 0:i.requestOptions)||void 0===r?void 0:r.customHeaders;if(o)for(const t of Object.keys(o))e.headers.set(t,o[t])}(e,s,r),function(e,t,n,i=function(){throw new Error("XML serialization unsupported!")}){var r,s,u,l,c;const d=null===(r=t.options)||void 0===r?void 0:r.serializerOptions,p={xml:{rootName:null!==(s=null==d?void 0:d.xml.rootName)&&void 0!==s?s:"",includeRoot:null!==(u=null==d?void 0:d.xml.includeRoot)&&void 0!==u&&u,xmlCharKey:null!==(l=null==d?void 0:d.xml.xmlCharKey)&&void 0!==l?l:a}},f=p.xml.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){e.body=I(t,n.requestBody);const r=n.requestBody.mapper,{required:a,serializedName:s,xmlName:u,xmlElementName:l,xmlNamespace:d,xmlNamespacePrefix:y,nullable:h}=r,g=r.type.name;try{if(void 0!==e.body&&null!==e.body||h&&null===e.body||a){const t=R(n.requestBody);e.body=n.serializer.serialize(r,e.body,t,p);const a=g===T;if(n.isXML){const t=y?`xmlns:${y}`:"xmlns",n=function(e,t,n,i,r){if(e&&!["Composite","Sequence","Dictionary"].includes(n)){const n={};return n[r.xml.xmlCharKey]=i,n[o]={[t]:e},n}return i}(d,t,g,e.body,p);g===C?e.body=i(function(e,t,n,i){Array.isArray(e)||(e=[e]);if(!n||!i)return{[t]:e};const r={[t]:e};return r[o]={[n]:i},r}(n,l||u||s,t,d),{rootName:u||s,xmlCharKey:f}):a||(e.body=i(n,{rootName:u||s,xmlCharKey:f}))}else{if(g===w&&((null===(c=n.contentType)||void 0===c?void 0:c.match("text/plain"))||"text"===n.mediaType))return;a||(e.body=JSON.stringify(e.body))}}}catch(e){throw new Error(`Error "${e.message}" occurred in serializing the payload - ${JSON.stringify(s,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){e.formData={};for(const i of n.formDataParameters){const r=I(t,i);if(null!=r){const t=i.mapper.serializedName||R(i);e.formData[t]=n.serializer.serialize(i.mapper,r,R(i),p)}}}}(e,s,r,t)),n(e)}}}let M;const V={CSV:",",SSV:" ",Multi:"Multi",TSV:"\t",Pipes:"|"};function N(e,t,n,i){const r=function(e,t,n){var i;const r=new Map;if(null===(i=e.urlParameters)||void 0===i?void 0:i.length)for(const i of e.urlParameters){let o=I(t,i,n);const a=R(i);o=e.serializer.serialize(i.mapper,o,a),i.skipEncoding||(o=encodeURIComponent(o)),r.set(`{${i.mapper.serializedName||a}}`,o)}return r}(t,n,i);let o=!1,a=B(e,r);if(t.path){let e=B(t.path,r);"/{nextLink}"===t.path&&e.startsWith("/")&&(e=e.substring(1)),e.includes("://")?(a=e,o=!0):a=function(e,t){if(!t)return e;const n=new URL(e);let i=n.pathname;i.endsWith("/")||(i=`${i}/`);t.startsWith("/")&&(t=t.substring(1));const r=t.indexOf("?");if(-1!==r){const e=t.substring(0,r),o=t.substring(r+1);i+=e,o&&(n.search=n.search?`${n.search}&${o}`:o)}else i+=t;return n.pathname=i,n.toString()}(a,e)}const{queryParams:s,sequenceParams:u}=function(e,t,n){var i;const r=new Map,o=new Set;if(null===(i=e.queryParameters)||void 0===i?void 0:i.length)for(const i of e.queryParameters){"Sequence"===i.mapper.type.name&&i.mapper.serializedName&&o.add(i.mapper.serializedName);let a=I(t,i,n);if(null!=a||i.mapper.required){a=e.serializer.serialize(i.mapper,a,R(i));const t=i.collectionFormat?V[i.collectionFormat]:"";if(Array.isArray(a)&&(a=a.map((e=>null==e?"":e))),"Multi"===i.collectionFormat&&0===a.length)continue;!Array.isArray(a)||"SSV"!==i.collectionFormat&&"TSV"!==i.collectionFormat||(a=a.join(t)),i.skipEncoding||(a=Array.isArray(a)?a.map((e=>encodeURIComponent(e))):encodeURIComponent(a)),!Array.isArray(a)||"CSV"!==i.collectionFormat&&"Pipes"!==i.collectionFormat||(a=a.join(t)),r.set(i.mapper.serializedName||R(i),a)}}return{queryParams:r,sequenceParams:o}}(t,n,i);return a=function(e,t,n,i=!1){if(0===t.size)return e;const r=new URL(e),o=function(e){const t=new Map;if(!e||"?"!==e[0])return t;const n=(e=e.slice(1)).split("&");for(const e of n){const[n,i]=e.split("=",2),r=t.get(n);r?Array.isArray(r)?r.push(i):t.set(n,[r,i]):t.set(n,i)}return t}(r.search);for(const[e,r]of t){const t=o.get(e);if(Array.isArray(t))if(Array.isArray(r)){t.push(...r);const n=new Set(t);o.set(e,Array.from(n))}else t.push(r);else t?(Array.isArray(r)?r.unshift(t):n.has(e)&&o.set(e,[t,r]),i||o.set(e,r)):o.set(e,r)}const a=[];for(const[e,t]of o)if("string"==typeof t)a.push(`${e}=${t}`);else if(Array.isArray(t))for(const n of t)a.push(`${e}=${n}`);else a.push(`${e}=${t}`);return r.search=a.length?`?${a.join("&")}`:"",r.toString()}(a,s,u,o),a}function B(e,t){let n=e;for(const[e,i]of t)n=n.split(e).join(i);return n}const j=(0,n(424447).KV)("core-client");class ${constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri,e.baseUri&&j.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||(M||(M=(0,q.fl)()),M),this.pipeline=e.pipeline||function(e){const t=function(e){if(e.credentialScopes)return e.credentialScopes;if(e.endpoint)return`${e.endpoint}/.default`;if(e.baseUri)return`${e.baseUri}/.default`;if(e.credential&&!e.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy");return}(e),n=e.credential&&t?{credentialScopes:t,credential:e.credential}:void 0;return function(e={}){const t=(0,q.Fp)(null!=e?e:{});return e.credentialOptions&&t.addPolicy((0,q.N$)({credential:e.credentialOptions.credential,scopes:e.credentialOptions.credentialScopes})),t.addPolicy(D(e.serializationOptions),{phase:"Serialize"}),t.addPolicy(O(e.deserializationOptions),{phase:"Deserialize"}),t}(Object.assign(Object.assign({},e),{credentialOptions:n}))}(e),null===(n=e.additionalPolicies)||void 0===n?void 0:n.length)for(const{policy:t,position:n}of e.additionalPolicies){const e="perRetry"===n?"Sign":void 0;this.pipeline.addPolicy(t,{afterPhase:e})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){const n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const i=N(n,t,e,this),r=(0,q.G6)({url:i});r.method=t.httpMethod;const o=P(r);o.operationSpec=t,o.operationArguments=e;const a=t.contentType||this._requestContentType;a&&t.requestBody&&r.headers.set("Content-Type",a);const s=e.options;if(s){const e=s.requestOptions;e&&(e.timeout&&(r.timeout=e.timeout),e.onUploadProgress&&(r.onUploadProgress=e.onUploadProgress),e.onDownloadProgress&&(r.onDownloadProgress=e.onDownloadProgress),void 0!==e.shouldDeserialize&&(o.shouldDeserialize=e.shouldDeserialize),e.allowInsecureConnection&&(r.allowInsecureConnection=!0)),s.abortSignal&&(r.abortSignal=s.abortSignal),s.tracingOptions&&(r.tracingOptions=s.tracingOptions)}this._allowInsecureConnection&&(r.allowInsecureConnection=!0),void 0===r.streamResponseStatusCodes&&(r.streamResponseStatusCodes=function(e){const t=new Set;for(const n in e.responses){const i=e.responses[n];i.bodyMapper&&i.bodyMapper.type.name===T&&t.add(Number(n))}return t}(t));try{const e=await this.sendRequest(r),n=l(e,t.responses[e.status]);return(null==s?void 0:s.onResponse)&&s.onResponse(e,n),n}catch(e){if("object"==typeof e&&(null==e?void 0:e.response)){const n=e.response,i=l(n,t.responses[e.statusCode]||t.responses.default);e.details=i,(null==s?void 0:s.onResponse)&&s.onResponse(n,i,e)}throw e}}}async function F(e){const{scopes:t,response:n}=e,i=e.logger||j,r=n.headers.get("WWW-Authenticate");if(!r)return i.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;const o=function(e){return`, ${e.trim()}`.split(", Bearer ").filter((e=>e)).map((e=>`${e.trim()}, `.split('", ').filter((e=>e)).map((e=>(([e,t])=>({[e]:t}))(e.trim().split('="')))).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})))}(r)||[],a=o.find((e=>e.claims));if(!a)return i.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;const s=await e.getAccessToken(a.scope?[a.scope]:t,{claims:(u=a.claims,atob(u))});var u;return!!s&&(e.request.headers.set("Authorization",`Bearer ${s.token}`),!0)}},760963:e=>{function t(e,t,n){var i,r,o,a,s;function u(){var l=Date.now()-a;l<t&&l>=0?i=setTimeout(u,t-l):(i=null,n||(s=e.apply(o,r),o=r=null))}null==t&&(t=100);var l=function(){o=this,r=arguments,a=Date.now();var l=n&&!i;return i||(i=setTimeout(u,t)),l&&(s=e.apply(o,r),o=r=null),s};return l.clear=function(){i&&(clearTimeout(i),i=null)},l.flush=function(){i&&(s=e.apply(o,r),o=r=null,clearTimeout(i),i=null)},l}t.debounce=t,e.exports=t},772649:(e,t,n)=>{"use strict";n.d(t,{m:()=>Ue});var i="Request",r="Singleton",o="Transient",a="ConstantValue",s="Constructor",u="DynamicValue",l="Factory",c="Function",d="Instance",p="Invalid",f="Provider",y="ClassProperty",h="ConstructorArgument",g="Variable",m=0;function v(){return m++}var b=function(){function e(e,t){this.id=v(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=p,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===r&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},e}(),C=n(807990),w=n(465525),T=n(87218),q=0,S=1;function I(e){return e instanceof RangeError||e.message===C.U_}function E(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function A(e,t,n){var i="",r=n(e,t);return 0!==r.length&&(i="\nRegistered bindings:",r.forEach((function(e){var t="Object";null!==e.implementationType&&(t=_(e.implementationType)),i=i+"\n "+t,e.constraint.metaData&&(i=i+" - "+e.constraint.metaData)}))),i}function P(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||P(e.parentRequest,t))}function x(e){e.childRequests.forEach((function(e){if(P(e,e.serviceIdentifier)){var t=function(e){var t=function e(t,n){void 0===n&&(n=[]);var i=E(t.serviceIdentifier);return n.push(i),null!==t.parentRequest?e(t.parentRequest,n):n}(e);return t.reverse().join(" --\x3e ")}(e);throw new Error(C.ML+" "+t)}x(e)}))}function _(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}var O=function(){function e(e){this.id=v(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),R=n(644918),D=function(e,t){this.parentContext=e,this.rootRequest=t},M=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),V=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),N=function(){function e(e,t,n,i){this.id=v(),this.type=e,this.serviceIdentifier=n;var r="symbol"==typeof t?t.toString().slice(7,-1):t;this.name=new V(r||""),this.identifier=t,this.metadata=new Array;var o=null;"string"==typeof i?o=new R.O(w.P7,i):i instanceof R.O&&(o=i),null!==o&&this.metadata.push(o)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(w.jf)},e.prototype.matchesArray=function(e){return this.matchesTag(w.jf)(e)},e.prototype.isNamed=function(){return this.hasTag(w.P7)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return w.eV.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(w.Q2)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===w.P7}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return w.eV.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(w.P7)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,r=t.metadata;i<r.length;i++){var o=r[i];if(o.key===e&&o.value===n)return!0}return!1}},e}(),B=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function j(e,t,n,i){var r=e.getConstructorMetadata(n),o=r.compilerGeneratedMetadata;if(void 0===o){var a=C.z4+" "+t+".";throw new Error(a)}var s=r.userGeneratedMetadata,u=Object.keys(s),l=0===n.length&&u.length>0,c=u.length>n.length,d=function(e,t,n,i,r){for(var o=[],a=0;a<r;a++){var s=$(a,e,t,n,i);null!==s&&o.push(s)}return o}(i,t,o,s,l||c?u.length:n.length),p=k(e,n,t);return B(B([],d,!0),p,!0)}function $(e,t,n,i,r){var o=r[e.toString()]||[],a=U(o),s=!0!==a.unmanaged,u=i[e],l=a.inject||a.multiInject;if((u=l||u)instanceof M&&(u=u.unwrap()),s){if(!t&&(u===Object||u===Function||void 0===u)){var c=C.Ds+" argument "+e+" in class "+n+".";throw new Error(c)}var d=new N(h,a.targetName,u);return d.metadata=o,d}return null}function F(e,t,n,i){var r=e||t;if(void 0===r){var o=C.z4+" for property "+String(n)+" in class "+i+".";throw new Error(o)}return r}function k(e,t,n){for(var i=e.getPropertiesMetadata(t),r=[],o=Object.getOwnPropertySymbols(i),a=0,s=Object.keys(i).concat(o);a<s.length;a++){var u=s[a],l=i[u],c=U(l),d=c.targetName||u,p=F(c.inject,c.multiInject,u,n),f=new N(y,d,p);f.metadata=l,r.push(f)}var h=Object.getPrototypeOf(t.prototype).constructor;if(h!==Object){var g=k(e,h,n);r=B(B([],r,!0),g,!0)}return r}function z(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var i=j(e,_(n),n,!0),r=i.map((function(e){return e.metadata.filter((function(e){return e.key===w.Af}))})),o=[].concat.apply([],r).length,a=i.length-o;return a>0?a:z(e,n)}return 0}function U(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[w.n8],multiInject:t[w.jf],targetName:t[w.LX],unmanaged:t[w.Af]}}var L=function(){function e(e,t,n,i,r){this.id=v(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=r,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,i){var r=new e(t,this.parentContext,this,n,i);return this.childRequests.push(r),r},e}();function W(e){return e._bindingDictionary}function H(e,t,n,i,r){var o=Q(n.container,r.serviceIdentifier),a=[];return o.length===q&&n.container.options.autoBindInjectable&&"function"==typeof r.serviceIdentifier&&e.getConstructorMetadata(r.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(r.serviceIdentifier).toSelf(),o=Q(n.container,r.serviceIdentifier)),a=t?o:o.filter((function(e){var t=new L(e.serviceIdentifier,n,i,e,r);return e.constraint(t)})),function(e,t,n,i){switch(t.length){case q:if(n.isOptional())return t;var r=E(e),o=C.BT;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var n="",i=t.getNamedTag(),r=t.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==r&&r.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}(r,n),o+=A(i,r,Q),new Error(o);case S:return t;default:if(n.isArray())return t;r=E(e),o=C.No+" "+r;throw o+=A(i,r,Q),new Error(o)}}(r.serviceIdentifier,a,r,n.container),a}function G(e,t,n,i,r,o){var a,s;if(null===r){a=H(e,t,i,null,o),s=new L(n,i,null,a,o);var u=new D(i,s);i.addPlan(u)}else a=H(e,t,i,r,o),s=r.addChildRequest(o.serviceIdentifier,a,o);a.forEach((function(t){var n=null;if(o.isArray())n=s.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;n=s}if(t.type===d&&null!==t.implementationType){var r=function(e,t){return j(e,_(t),t,!1)}(e,t.implementationType);if(!i.container.options.skipBaseClassChecks){var a=z(e,t.implementationType);if(r.length<a){var u=C.Z_(_(t.implementationType));throw new Error(u)}}r.forEach((function(t){G(e,!1,t.serviceIdentifier,i,n,t)}))}}))}function Q(e,t){var n=[],i=W(e);return i.hasKey(t)?n=i.get(t):null!==e.parent&&(n=Q(e.parent,t)),n}function K(e,t,n,i,r,o,a,s){void 0===s&&(s=!1);var u=new O(t),l=function(e,t,n,i,r,o){var a=e?w.jf:w.n8,s=new R.O(a,n),u=new N(t,i,n,s);if(void 0!==r){var l=new R.O(r,o);u.metadata.push(l)}return u}(n,i,r,"",o,a);try{return G(e,s,r,u,null,l),u}catch(e){throw I(e)&&x(u.plan.rootRequest),e}}function J(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function X(e){return!!J(e)||Array.isArray(e)&&e.some(J)}var Z,Y=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},ee=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},te=function(e,t,n){e.has(t.id)||e.set(t.id,n)},ne=function(e,t){e.cache=t,e.activated=!0,J(t)&&ie(e,t)},ie=function(e,t){return Y(void 0,void 0,void 0,(function(){var n,i;return ee(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t];case 1:return n=r.sent(),e.cache=n,[3,3];case 2:throw i=r.sent(),e.cache=null,e.activated=!1,i;case 3:return[2]}}))}))};!function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"}(Z||(Z={}));var re=function(){return re=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},re.apply(this,arguments)},oe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},ae=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},se=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function ue(e,t,n){var i;if(t.length>0){var r=function(e,t){return e.reduce((function(e,n){var i=t(n);return n.target.type===h?e.constructorInjections.push(i):(e.propertyRequests.push(n),e.propertyInjections.push(i)),e.isAsync||(e.isAsync=X(i)),e}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(t,n),o=re(re({},r),{constr:e});i=r.isAsync?function(e){return oe(this,void 0,void 0,(function(){var t,n;return ae(this,(function(i){switch(i.label){case 0:return[4,ce(e.constructorInjections)];case 1:return t=i.sent(),[4,ce(e.propertyInjections)];case 2:return n=i.sent(),[2,le(re(re({},e),{constructorInjections:t,propertyInjections:n}))]}}))}))}(o):le(o)}else i=new e;return i}function le(e){var t,n=new((t=e.constr).bind.apply(t,se([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach((function(t,i){var r=t.target.identifier,o=e.propertyInjections[i];n[r]=o})),n}function ce(e){return oe(this,void 0,void 0,(function(){var t,n,i,r;return ae(this,(function(o){for(t=[],n=0,i=e;n<i.length;n++)r=i[n],Array.isArray(r)?t.push(Promise.all(r)):t.push(r);return[2,Promise.all(t)]}))}))}function de(e,t){var n=function(e,t){var n,i;if(Reflect.hasMetadata(w.Z_,e)){var r=Reflect.getMetadata(w.Z_,e);try{return null===(i=(n=t)[r.value])||void 0===i?void 0:i.call(n)}catch(t){throw new Error((0,C.CE)(e.name,t.message))}}}(e,t);return J(n)?n.then((function(){return t})):t}function pe(e,t){e.scope!==r&&function(e,t){var n="Class cannot be instantiated in "+(e.scope===i?"request":"transient")+" scope.";if("function"==typeof e.onDeactivation)throw new Error((0,C.bQ)(t.name,n));if(Reflect.hasMetadata(w.Vh,t))throw new Error((0,C.Wj)(t.name,n))}(e,t)}var fe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},ye=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},he=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,i=t.childRequests,r=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(r&&o)return i.map((function(t){return he(e)(t)}));if(!t.target.isOptional()||0!==n.length){var a=n[0];return be(e,t,a)}}},ge=function(e,t){var n=function(e){switch(e.type){case l:return{factory:e.factory,factoryType:Z.Factory};case f:return{factory:e.provider,factoryType:Z.Provider};case u:return{factory:e.dynamicValue,factoryType:Z.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}}(e);return function(e,t){try{return e()}catch(e){throw I(e)&&(e=t()),e}}((function(){return n.factory.bind(e)(t)}),(function(){return new Error(C.NF(n.factoryType,t.currentRequest.serviceIdentifier.toString()))}))},me=function(e,t,n){var i,r=t.childRequests;switch(function(e){var t=null;switch(e.type){case a:case c:t=e.cache;break;case s:case d:t=e.implementationType;break;case u:t=e.dynamicValue;break;case f:t=e.provider;break;case l:t=e.factory}if(null===t){var n=E(e.serviceIdentifier);throw new Error(C.F5+" "+n)}}(n),n.type){case a:case c:i=n.cache;break;case s:i=n.implementationType;break;case d:i=function(e,t,n,i){pe(e,t);var r=ue(t,n,i);return J(r)?r.then((function(e){return de(t,e)})):de(t,r)}(n,n.implementationType,r,he(e));break;default:i=ge(n,t.parentContext)}return i},ve=function(e,t,n){var o=function(e,t){return t.scope===r&&t.activated?t.cache:t.scope===i&&e.has(t.id)?e.get(t.id):null}(e,t);return null!==o||function(e,t,n){t.scope===r&&ne(t,n),t.scope===i&&te(e,t,n)}(e,t,o=n()),o},be=function(e,t,n){return ve(e,n,(function(){var i=me(e,t,n);return i=J(i)?i.then((function(e){return Ce(t,n,e)})):Ce(t,n,i)}))};function Ce(e,t,n){var i,r=we(e.parentContext,t,n),o=Ie(e.parentContext.container),a=o.next();do{i=a.value;var s=e.parentContext,u=e.serviceIdentifier,l=Se(i,u);r=J(r)?qe(l,s,r):Te(l,s,r),a=o.next()}while(!0!==a.done&&!W(i).hasKey(e.serviceIdentifier));return r}var we=function(e,t,n){return"function"==typeof t.onActivation?t.onActivation(e,n):n},Te=function(e,t,n){for(var i=e.next();!i.done;){if(J(n=i.value(t,n)))return qe(e,t,n);i=e.next()}return n},qe=function(e,t,n){return fe(void 0,void 0,void 0,(function(){var i,r;return ye(this,(function(o){switch(o.label){case 0:return[4,n];case 1:i=o.sent(),r=e.next(),o.label=2;case 2:return r.done?[3,4]:[4,r.value(t,i)];case 3:return i=o.sent(),r=e.next(),[3,2];case 4:return[2,i]}}))}))},Se=function(e,t){var n=e._activations;return n.hasKey(t)?n.get(t).values():[].values()},Ie=function(e){for(var t=[e],n=e.parent;null!==n;)t.push(n),n=n.parent;return{next:function(){var e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}};var Ee=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||Ee(n,t))},Ae=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new R.O(e,t),n}},Pe=Ae(w.P7),xe=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var i=t.bindings[0].implementationType;return e===i}return!1}},_e=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new Oe(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=Pe(e),new Oe(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e&&(null!==e.target&&!e.target.isNamed()&&!e.target.isTagged())},new Oe(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=Ae(e)(t),new Oe(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return null!==t&&xe(e)(t.parentRequest)},new Oe(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return null!==t&&Pe(e)(t.parentRequest)},new Oe(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&Ae(e)(t)(n.parentRequest)},new Oe(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&Ee(t,xe(e))},new Oe(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&!Ee(t,xe(e))},new Oe(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&Ee(t,Pe(e))},new Oe(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&!Ee(t,Pe(e))},new Oe(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&Ee(n,Ae(e)(t))},new Oe(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&!Ee(n,Ae(e)(t))},new Oe(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&Ee(t,e)},new Oe(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&!Ee(t,e)},new Oe(this._binding)},e}(),Oe=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new _e(this._binding)},e.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new _e(this._binding)},e}(),Re=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new _e(this._binding),this._bindingOnSyntax=new Oe(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),De=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=i,new Re(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=r,new Re(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=o,new Re(this._binding)},e}(),Me=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new _e(this._binding),this._bindingOnSyntax=new Oe(this._binding),this._bindingInSyntax=new De(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),Ve=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=d,this._binding.implementationType=e,new Me(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+C.jf);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=a,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=r,new Re(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=u,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new Me(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=s,this._binding.implementationType=e,this._binding.scope=r,new Re(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=l,this._binding.factory=e,this._binding.scope=r,new Re(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(C.rg);var t=this.toConstantValue(e);return this._binding.type=c,this._binding.scope=r,t},e.prototype.toAutoFactory=function(e){return this._binding.type=l,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=r,new Re(this._binding)},e.prototype.toAutoNamedFactory=function(e){return this._binding.type=l,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new Re(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=f,this._binding.provider=e,this._binding.scope=r,new Re(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),Ne=function(){function e(){}return e.of=function(t,n,i,r,o){var a=new e;return a.bindings=t,a.middleware=n,a.deactivations=r,a.activations=i,a.moduleActivationStore=o,a},e}();var Be=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(C.EC);if(null==t)throw new Error(C.EC);var n=this._map.get(e);void 0!==n?n.push(t):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(C.EC);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(C.Jk)},e.prototype.remove=function(e){if(null==e)throw new Error(C.EC);if(!this._map.delete(e))throw new Error(C.Jk)},e.prototype.removeIntersection=function(e){var t=this;this.traverse((function(n,i){var r=e.hasKey(n)?e.get(n):void 0;if(void 0!==r){var o=i.filter((function(e){return!r.some((function(t){return e===t}))}));t._setValue(n,o)}}))},e.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach((function(i,r){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];e(u)?n.push(u):o.push(u)}t._setValue(r,o)})),n},e.prototype.hasKey=function(e){if(null==e)throw new Error(C.EC);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,"object"==typeof(i=e)&&null!==i&&"clone"in i&&"function"==typeof i.clone?e.clone():e);var i}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},e}(),je=function(){function e(){this._map=new Map}return e.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},e.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){t._map.set(n,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})})),t},e.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},e.prototype._getEmptyHandlersStore=function(){return{onActivations:new Be,onDeactivations:new Be}},e}(),$e=function(){return $e=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},$e.apply(this,arguments)},Fe=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function s(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((i=i.apply(e,t||[])).next())}))},ke=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ze=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Ue=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+C.li);if(void 0===t.defaultScope)t.defaultScope=o;else if(t.defaultScope!==r&&t.defaultScope!==o&&t.defaultScope!==i)throw new Error(""+C.KU);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+C.jC);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+C.SW);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=v(),this._bindingDictionary=new Be,this._snapshots=[],this._middleware=null,this._activations=new Be,this._deactivations=new Be,this.parent=null,this._metadataReader=new T.P,this._moduleActivationStore=new je}return e.merge=function(t,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=new e,a=ze([t,n],i,!0).map((function(e){return W(e)})),s=W(o);return a.forEach((function(e){var t;t=s,e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,r=e;i<r.length;i++){var o=r[i],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Fe(this,void 0,void 0,(function(){var t,n,i,r,o;return ke(this,(function(a){switch(a.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,i=e,a.label=1;case 1:return n<i.length?(r=i[n],o=t(r.id),[4,r.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){var n=e._removeModuleBindings(t.id);e._deactivateSingletons(n),e._removeModuleHandlers(t.id)}))},e.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Fe(this,void 0,void 0,(function(){var t,n,i,r;return ke(this,(function(o){switch(o.label){case 0:t=0,n=e,o.label=1;case 1:return t<n.length?(i=n[t],r=this._removeModuleBindings(i.id),[4,this._deactivateSingletonsAsync(r)]):[3,4];case 2:o.sent(),this._removeModuleHandlers(i.id),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.bind=function(e){var t=this.options.defaultScope||o,n=new b(e,t);return this._bindingDictionary.add(e,n),new Ve(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.rebindAsync=function(e){return Fe(this,void 0,void 0,(function(){return ke(this,(function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}}))}))},e.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},e.prototype.unbindAsync=function(e){return Fe(this,void 0,void 0,(function(){var t;return ke(this,(function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}}))}))},e.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse((function(t,n){e._deactivateSingletons(n)})),this._bindingDictionary=new Be},e.prototype.unbindAllAsync=function(){return Fe(this,void 0,void 0,(function(){var e,t=this;return ke(this,(function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse((function(n,i){e.push(t._deactivateSingletonsAsync(i))})),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new Be,[2]}}))}))},e.prototype.onActivation=function(e,t){this._activations.add(e,t)},e.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,w.P7,t)},e.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var r=this._bindingDictionary.get(e),o=function(e,t,n,i){var r=new N(g,"",t,new R.O(n,i)),o=new O(e);return new L(t,o,null,[],r)}(this,e,t,n);i=r.some((function(e){return e.constraint(o)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(Ne.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(C.U9);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},e.prototype.getAsync=function(e){return Fe(this,void 0,void 0,(function(){var t;return ke(this,(function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]}))}))},e.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},e.prototype.getTaggedAsync=function(e,t,n){return Fe(this,void 0,void 0,(function(){var i;return ke(this,(function(r){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]}))}))},e.prototype.getNamed=function(e,t){return this.getTagged(e,w.P7,t)},e.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,w.P7,t)},e.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},e.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},e.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},e.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,w.P7,t)},e.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,w.P7,t)},e.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},e.prototype._preDestroy=function(e,t){if(Reflect.hasMetadata(w.Vh,e))return t[Reflect.getMetadata(w.Vh,e).value]()},e.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},e.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition((function(t){return t.moduleId===e}))},e.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var r=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(J(r))return this._handleDeactivationError(r.then((function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)})),i)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if(J(o))return this._handleDeactivationError(o,i)}catch(e){throw new Error(C.bQ(i.name,e.message))}},e.prototype._handleDeactivationError=function(e,t){return Fe(this,void 0,void 0,(function(){var n;return ke(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:throw n=i.sent(),new Error(C.bQ(t.name,n.message));case 3:return[2]}}))}))},e.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var r=i.value(e);if(J(r))return r.then((function(){return n._deactivateContainerAsync(e,t)}));i=t.next()}},e.prototype._deactivateContainerAsync=function(e,t){return Fe(this,void 0,void 0,(function(){var n;return ke(this,(function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}}))}))},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(i){var r=e.rebind(i);return t(r,n),r}},i=function(t){return function(n,i){e._moduleActivationStore.addActivation(t,n,i),e.onActivation(n,i)}},r=function(t){return function(n,i){e._moduleActivationStore.addDeactivation(t,n,i),e.onDeactivation(n,i)}};return function(o){return{bindFunction:(a=o,function(n){var i=e.bind(n);return t(i,a),i}),isboundFunction:function(t){return e.isBound(t)},onActivationFunction:i(o),onDeactivationFunction:r(o),rebindFunction:n(o),unbindFunction:function(t){return e.unbind(t)},unbindAsyncFunction:function(t){return e.unbindAsync(t)}};var a}},e.prototype._getAll=function(e){return Promise.all(this._get(e))},e.prototype._get=function(e){var t=$e($e({},e),{contextInterceptor:function(e){return e},targetType:g});if(this._middleware){var n=this._middleware(t);if(null==n)throw new Error(C.Y1);return n}return this._planAndResolve()(t)},e.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(X(t))throw new Error(C.Ft(e.serviceIdentifier));return t},e.prototype._getAllArgs=function(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}},e.prototype._getNotAllArgs=function(e,t,n,i){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i}},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=K(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return function(e){return he(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(n=t.contextInterceptor(n))}},e.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return J(e.cache)?e.cache.then((function(n){return t._deactivate(e,n)})):this._deactivate(e,e.cache)},e.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];if(J(this._deactivateIfSingleton(i)))throw new Error(C.Y3)}},e.prototype._deactivateSingletonsAsync=function(e){return Fe(this,void 0,void 0,(function(){var t=this;return ke(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return t._deactivateIfSingleton(e)})))];case 1:return n.sent(),[2]}}))}))},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return Fe(this,void 0,void 0,(function(){return ke(this,(function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))},e.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(C.fG+" "+E(e))}},e.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if("function"==typeof e.onDeactivation){var r=e.onDeactivation(t);if(J(r))return r.then((function(){return i._preDestroy(n,t)}))}return this._preDestroy(n,t)},e.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return Fe(this,void 0,void 0,(function(){return ke(this,(function(i){switch(i.label){case 0:return"function"!=typeof e.onDeactivation?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}}))}))},e}()},772995:e=>{"use strict";e.exports=function(e,t,n,i){var r=self||window;try{try{var o;try{o=new r.Blob([e])}catch(t){(o=new(r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder)).append(e),o=o.getBlob()}var a=r.URL||r.webkitURL,s=a.createObjectURL(o),u=new r[t](s,n);return a.revokeObjectURL(s),u}catch(i){return new r[t]("data:application/javascript,".concat(encodeURIComponent(e)),n)}}catch(e){if(!i)throw Error("Inline worker is not supported");return new r[t](i,n)}}}}]);
//# sourceMappingURL=vendors~sccserviceciq.js.map