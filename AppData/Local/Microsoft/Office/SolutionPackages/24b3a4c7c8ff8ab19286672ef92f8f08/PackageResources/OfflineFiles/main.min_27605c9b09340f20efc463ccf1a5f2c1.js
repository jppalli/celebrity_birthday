(function(){"use strict";var ariaPlaceholder="%s";var privacyKey="acceptedPrivacy";var clearStorageQueryParam="clearStorage";var isPemberlyParam="isPemberly";var splash="/cascades/splash/";var cookieName="skipOnboarding";var correlationId=null,clientInfo=null,versionInfo=null,resumeToCV=false;var experimentStrings={corrupt:"Corrupt",control:"BulletListControl",treatment:"BulletListTreatment",experimentFeatureGate:"Microsoft.Office.Word.fResumeAssistantBulletListExperiment",treatmentFeatureGate:"Microsoft.Office.Word.fResumeAssistantBulletListExperimentTreatment"};Office.initialize=function(reason){$(document).ready(function(){correlationId=Office.context.document.settings.get("CorrelationId");resumeToCV=Boolean(Office.context.document.settings.get("ShouldLocalizeForCV"));var clientEndpointName=Office.context.document.settings.get("ClientEndpointName");var buildVersion=Office.context.document.settings.get("BuildVersion");var localeId=Office.context.document.settings.get("LocaleId");var sessionId=Office.context.document.settings.get("SessionId");var userId=Office.context.document.settings.get("UserId");var machineId=Office.context.document.settings.get("MachineId");var audienceChannel=Office.context.document.settings.get("AudienceChannel");var audienceGroup=Office.context.document.settings.get("AudienceGroup");clientInfo={ClientEndpointName:clientEndpointName,BuildVersion:buildVersion,LocaleId:localeId,SessionId:sessionId,UserId:userId,MachineId:machineId,AudienceChannel:audienceChannel,AudienceGroup:audienceGroup};Office.context.document.settings.set("UserId","");var versionNumber=Office.context.document.settings.get("VersionNumber");versionInfo={VersionNumber:versionNumber};if(Office.context.platform==="OfficeOnline"){Office.context.document.settings.set("FeatureGate",null);Office.context.document.settings.set(experimentStrings.treatment,false);onload()}else{getFeatureGates().then(function(){onload()}).catch(function(err){Office.context.document.settings.set("FeatureGate",null);Office.context.document.settings.set(experimentStrings.treatment,false);console.error(err);onload()})}})};function getFeatureGates(){return Word.run(function(context){var inExperiment=context.flighting.getFeatureGate(experimentStrings.experimentFeatureGate);var applyTreatment=context.flighting.getFeatureGate(experimentStrings.treatmentFeatureGate);context.load(inExperiment);context.load(applyTreatment);return context.sync().then(function(){var logStatement=null;if(inExperiment.value&&applyTreatment.value){logStatement=experimentStrings.treatment}else if(inExperiment.value&&!applyTreatment.value){logStatement=experimentStrings.control}else if(!inExperiment.value&&applyTreatment.value){logStatement=experimentStrings.corrupt}Office.context.document.settings.set("FeatureGate",logStatement);var isValidTreatment=inExperiment.value&&applyTreatment.value;Office.context.document.settings.set(experimentStrings.treatment,isValidTreatment)})})}function clearSkipOnboardingCookie(){Cookies.remove(cookieName,{path:""})}function hasSkipOnboardingCookie(){return Cookies.get(cookieName)==="true"}function setSkipOnboardingCookie(){Cookies.set(cookieName,true,{expires:7,path:""})}function checkResumeCV(){var cvResumeString="Resume";var learnMoreElem=$("#js-learn-more-link");if(resumeToCV){cvResumeString="CV";$(".replace-resume").text("CV")}var ariaLabel=learnMoreElem.attr("aria-label").replace(ariaPlaceholder,cvResumeString);learnMoreElem.attr("aria-label",ariaLabel);learnMoreElem.click(function(){logLearnMoreClick()})}function applyUpdatedHeaderTreatment(){var raDiv=document.createElement("div");var resumeString=resumeToCV?"CV":"Resume";raDiv.innerText=resumeString+" Assistant";raDiv.setAttribute("class","resume-assistant__text");$("body").addClass("no-icon");$(".powered-by__text").text("Powered by Office and LinkedIn");$("li-icon").remove();$(".powered-by").before(raDiv)}var bulletTreatmentValues={document:{path:"M 16 22 L 16 23 C 16 23.552 15.552 24 15 24 L 1 24 C 0.448 24 0 23.552 0 23 L 0 5 C 0 4.448 0.448 4 1 4 L 2 4 L 2 22 L 16 22 L 16 22 Z M 8 14 L 14 14 L 14 13 L 8 13 L 8 14 L 8 14 Z M 8 11 L 16 11 L 16 10 L 8 10 L 8 11 L 8 11 Z M 18 18 L 6 18 L 6 2 L 13 2 L 13 7 L 18 7 L 18 18 L 18 18 Z M 14.13 0 L 5 0 C 4.448 0 4 0.448 4 1 L 4 19 C 4 19.552 4.448 20 5 20 L 19 20 C 19.552 20 20 19.552 20 19 L 20 5.88 L 14.13 0 L 14.13 0 Z",text:"See descriptions of work experience that's relevant"},briefcase:{path:"M 2 9 L 18 9 L 18 6 L 2 6 L 2 9 Z M 2 15 L 18 15 L 18 10 L 2 10 L 2 15 Z M 7 3 C 7 2.448 7.448 2 8 2 L 12 2 C 12.552 2 13 2.448 13 3 L 13 4 L 7 4 L 7 3 Z M 19 4 L 15 4 L 15 3 C 15 1.343 13.657 0 12 0 L 8 0 C 6.343 0 5 1.343 5 3 L 5 4 L 1 4 C 0.448 4 0 4.448 0 5 L 0 16 C 0 16.552 0.448 17 1 17 L 19 17 C 19.552 17 20 16.552 20 16 L 20 5 C 20 4.448 19.552 4 19 4 L 19 4 Z",text:"Discover job opportunities and other resources"},todoList:{path:"M 2.43 15.76 L 1.31 14.46 L 0 15.63 L 1.86 17.75 C 2.132 18.062 2.606 18.094 2.918 17.822 C 2.944 17.8 2.968 17.776 2.99 17.75 L 6.99 13.14 L 5.68 12 L 2.43 15.76 L 2.43 15.76 Z M 2.43 9.76 L 1.31 8.46 L 0 9.63 L 1.86 11.75 C 2.132 12.062 2.606 12.094 2.918 11.822 C 2.944 11.8 2.968 11.776 2.99 11.75 L 7 7.14 L 5.68 6 L 2.43 9.76 L 2.43 9.76 Z M 2.43 3.76 L 1.31 2.46 L 0 3.63 L 1.86 5.74 C 2.129 6.055 2.603 6.092 2.917 5.823 C 2.947 5.797 2.975 5.77 3 5.74 L 7 1.14 L 5.68 0 L 2.43 3.76 L 2.43 3.76 Z M 8 5 L 19 5 L 19 3 L 8 3 L 8 5 L 8 5 Z M 8 17 L 19 17 L 19 15 L 8 15 L 8 17 L 8 17 Z M 8 11 L 19 11 L 19 9 L 8 9 L 8 11 L 8 11 Z",text:"Check out the top skills for a role"}};function buildSvgElement(iconType){var svgNamespace="http://www.w3.org/2000/svg";var fillColor=$("body").hasClass("light-theme")?"#2b589b":"#ffffff";var svgEl=document.createElementNS(svgNamespace,"svg");svgEl.setAttribute("viewBox","0 0 24 24");svgEl.setAttribute("width","24px");svgEl.setAttribute("height","24px");svgEl.setAttribute("version","1.1");svgEl.setAttribute("opacity","0.9");var path=document.createElementNS(svgNamespace,"path");path.setAttribute("d",bulletTreatmentValues[iconType].path);path.setAttribute("fill",fillColor);path.setAttribute("fill-rule","evenodd");path.setAttribute("transform","translate(2 4)");svgEl.appendChild(path);return svgEl}function buildBulletDiv(iconType){if(!bulletTreatmentValues[iconType])return;var svgEl=buildSvgElement(iconType);var div=document.createElement("div");div.classList.add("bullet-item");var textSpan=document.createElement("span");textSpan.textContent=bulletTreatmentValues[iconType].text;textSpan.classList.add("bullet-item__text");var liIcon=document.createElement("li-icon");liIcon.setAttribute("size","24px");liIcon.setAttribute("color","inverse");liIcon.setAttribute("aria-hidden","true");liIcon.appendChild(svgEl);div.appendChild(liIcon);div.appendChild(textSpan);return div}function applyBulletList(){var newHeadline="Get ideas to inspire your best "+(resumeToCV?"CV":"resume");$(".splash__headline").text(newHeadline);$(".splash__subtext").remove();var descriptionsDiv=buildBulletDiv("document");var skillsDiv=buildBulletDiv("todoList");var jobsDiv=buildBulletDiv("briefcase");var acceptPrivacyBtn=$("#acceptPrivacyBtn");acceptPrivacyBtn.before(descriptionsDiv);acceptPrivacyBtn.before(skillsDiv);acceptPrivacyBtn.before(jobsDiv);acceptPrivacyBtn.addClass("bullet-treatment")}function applyExperimentTreatments(){if(Office.context.document.settings.get("BulletListTreatment")){applyBulletList()}if(Office.context.document.settings.get("NewHeaderTreatment")){applyUpdatedHeaderTreatment()}}function getRedirectUrl(isFtu){var corrId=Office.context.document.settings.get("CorrelationId");var queryparamCorrId=corrId?"correlationId="+corrId.replace("{","").replace("}",""):"";var queryparamFtu=isFtu?"ftu=true":"";var separatorQuestionMark=queryparamCorrId||queryparamFtu?"?":"";var separatorAmpersand=queryparamCorrId&&queryparamFtu?"&":"";var splashUrl=getBaseUrl()+splash+separatorQuestionMark+queryparamCorrId+separatorAmpersand+queryparamFtu;return splashUrl}function getBaseUrl(){var prod="https://www.linkedin.com";var pemberly="https://pemberly.www.linkedin.com:4443";var isPemberly=window.location.search.indexOf(isPemberlyParam)>-1;return isPemberly?pemberly:prod}function acceptPrivacyAndRedirect(){setSkipOnboardingCookie();redirectToUrl(getRedirectUrl(true),"Button")}function hasClearStorageParam(){return window.location.search.indexOf(clearStorageQueryParam)>-1}function onload(){logPageLoadVerification();var isWindows=window.navigator.platform==="Win32";console.log(isWindows);if(isWindows){$("body").addClass("win")}var privacyBtn=document.getElementById("acceptPrivacyBtn");privacyBtn.addEventListener("click",acceptPrivacyAndRedirect.bind(this),false);if(hasClearStorageParam()){clearSkipOnboardingCookie()}if(hasSkipOnboardingCookie()){setSkipOnboardingCookie();redirectToUrl(getRedirectUrl(),"Redirect")}else{checkResumeCV();applyExperimentTreatments();$("#js-li-privacy-policy-link").click(function(){logLiPrivacyPolicyClick()});$("body").removeClass("hidden");if(Office.context.platform==="OfficeOnline")window.focus()}}function redirectToUrl(url,pageRedirectReason){Office.context.document.settings.saveAsync(function(asyncResult){var pageRedirectReportItems={};if(asyncResult.status==Office.AsyncResultStatus.Failed){pageRedirectReportItems.SaveAsyncSucceeded="false"}else{pageRedirectReportItems.SaveAsyncSucceeded="true"}pageRedirectReportItems.RedirectReason=pageRedirectReason;logWordLandingPageRedirect(pageRedirectReportItems);window.location.href=url})}function logWordLandingPageRedirect(pageRedirectReportItems){pageRedirectReportItems.LogType="PageRedirect";Log(pageRedirectReportItems)}function logPageLoadVerification(){var pageLoadVerificationReportItems={LogType:"LoadVerification"};Log(pageLoadVerificationReportItems)}function logLearnMoreClick(){var learnMoreClickReportItems={LogType:"LearnMoreClick"};Log(learnMoreClickReportItems)}function logLiPrivacyPolicyClick(){var liPrivacyPolicyClickReportItems={LogType:"LIPrivacyPolicyClick"};Log(liPrivacyPolicyClickReportItems)}function Log(reportItems){var requestHeader={"X-RequestType":"ReportRequest"};if(correlationId!==null){requestHeader["X-Correlation"]=correlationId;reportItems.CorrelationIncluded=true}else{reportItems.CorrelationIncluded=false}var requestData={};if(clientInfo!==null){requestData.ClientInfo=JSON.stringify(clientInfo)}if(versionInfo!==null){requestData.VersionInfo=JSON.stringify(versionInfo)}requestData.ReportItems=JSON.stringify(reportItems);jQuery.ajax({url:"https://wordsgs.officeapps.live.com/wordsgs/home/?GATE=37631f2e-a7fa-44d9-9acd-b0fe38a0328f",type:"POST",dataType:"json",async:false,data:requestData,headers:requestHeader})}})();