"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[769],{778833:(e,t,n)=>{n.r(t),n.d(t,{default:()=>te});var r,i=n(743032),o=n(811912),a=n(791165),u=n(990813),l=n(374292),s=n(379490),c=n(61714),d=n(928499),h=function(){function e(){(0,o._)(this,e),(0,u._)(this,"items",void 0),this.items=[{tag:"body",level:0,element:document.createElement("body")}]}return(0,a._)(e,[{key:"top",get:function(){return this.items[this.items.length-1]}},{key:"root",get:function(){return this.items[0]}},{key:"push",value:function(e,t){var n=this.top.element,r=document.createElement(e);return this.items.push({tag:e,level:t,element:r}),n.appendChild(r),r}},{key:"popUntil",value:function(e){for(var t=this.items.length-1;t>0&&!e(this.items[t]);t--)this.items.pop()}}]),e}(),p=n(242154),f=(r={},(0,u._)(r,"Normal","p"),(0,u._)(r,"ListParagraph","li"),(0,u._)(r,"Title","title"),(0,u._)(r,"Subtitle","subtitle"),(0,u._)(r,"Heading1","h1"),(0,u._)(r,"Heading2","h2"),(0,u._)(r,"Heading3","h3"),(0,u._)(r,"Heading4","h4"),(0,u._)(r,"Heading5","h5"),(0,u._)(r,"Heading6","h6"),r);function v(e,t){var n=function(e){var t,n=null!==(t=f[e.styleBuiltIn])&&void 0!==t?t:"p";return document.createElement(n)}(e);try{var r,i=function(e){if(0===e.length)return[];for(var t=e.length-1,n=[],r=0;r<e.length;r++){var i=e[r],o=i.text,a=i.font,u=i.hyperlink;if("\r"!==o){var l=n[n.length-1],s=new _({text:r===t?o.trimEnd():o,font:a,hyperlink:u});(null==l?void 0:l.tryMerge(s))||n.push(s)}}return n}(t.items);(r=n).append.apply(r,(0,d._)(i.map((function(e){return e.buildNode()}))))}catch(t){(0,p.cY)(p.SA.Error,"Failed to extract formatting runs: ".concat(t.message)),n.appendChild(document.createTextNode(e.text))}return n}var g,_=function(){function e(t){(0,o._)(this,e),(0,u._)(this,"bold",void 0),(0,u._)(this,"italic",void 0),(0,u._)(this,"underline",void 0),(0,u._)(this,"hyperlink",void 0),(0,u._)(this,"text",void 0);var n=t.text,r=t.hyperlink,i=t.font,a=i.bold,l=i.italic,s=i.underline;this.text=n,this.bold=a,this.italic=l,this.underline=!!s&&"None"!==s,this.hyperlink=r}return(0,a._)(e,[{key:"tryMerge",value:function(e){return!(this.bold!==e.bold&&null!==e.bold||this.italic!==e.italic&&null!==e.italic||this.underline!==e.underline&&null!==e.underline||this.hyperlink!==e.hyperlink)&&(this.text+=e.text,!0)}},{key:"buildNode",value:function(){var e=document.createTextNode(this.text);if(this.bold&&(e=this.wrapWith("b",e)),this.italic&&(e=this.wrapWith("i",e)),this.underline&&(e=this.wrapWith("u",e)),this.hyperlink){var t=this.wrapWith("a",e);t.href=this.hyperlink,e=t}return e}},{key:"wrapWith",value:function(e,t){var n=document.createElement(e);return n.appendChild(t),n}}]),e}();function y(e,t){return m.apply(this,arguments)}function m(){return(m=(0,i._)((function(e,t){var n,r,i,o,a,u,l,c,d;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return[4,b(e)];case 1:n=s.sent(),r=new h,i=0,o=!0,a=!1,u=void 0;try{for(l=function(){var e=d.value,n=e.paragraph,o=e.charactersCollection,a=n.listItemOrNullObject,u=n.parentTableCellOrNullObject,l=n.tableNestingLevel,s=n.uniqueLocalId;if(a.isNullObject)r.popUntil((function(e){return!["ul","ol"].includes(e.tag)}));else{var c=a.level,h=function(e){if(/^[\da-zA-Z]+[.)]\s*$/.test(e))return"ol";return"ul"}(a.listString);r.popUntil((function(e){return e.tag===h&&e.level<=c}));for(var p=r.top.tag===h?r.top.level+1:0;p<=c;p++)r.push(h,p)}if(u.isNullObject)r.popUntil((function(e){return!["table","tr","td"].includes(e.tag)}));else{var f=u.cellIndex,g=u.rowIndex;if(r.popUntil((function(e){return"tr"===e.tag||"td"===e.tag&&e.level===f})),r.popUntil((function(e){return"table"===e.tag||"tr"===e.tag&&e.level===g})),"body"===r.top.tag)r.push("table",l).id=t.getModelId("table-".concat(i)),i++;"table"===r.top.tag&&r.push("tr",g),"tr"===r.top.tag&&r.push("td",f)}var _=v(n,o);_.id=t.getModelId(s),r.top.element.appendChild(_)},c=n[Symbol.iterator]();!(o=(d=c.next()).done);o=!0)l()}catch(e){a=!0,u=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw u}}return[2,r.root.element.outerHTML]}}))}))).apply(this,arguments)}function b(e){return I.apply(this,arguments)}function I(){return(I=(0,i._)((function(e){var t,n,r;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return t=e.document.body,n=t.paragraphs.load({text:!0,uniqueLocalId:!0,styleBuiltIn:!0,listItemOrNullObject:{listString:!0,level:!0},tableNestingLevel:!0,parentTableCellOrNullObject:{cellIndex:!0,rowIndex:!0}}),[4,e.sync()];case 1:return i.sent(),r=n.items.map((function(e){var t=e.getTextRanges((0,d._)(e.text)).load({text:!0,font:{bold:!0,italic:!0,underline:!0},hyperlink:!0});return{paragraph:e,charactersCollection:t}})),[4,e.sync()];case 2:return i.sent(),[2,r]}}))}))).apply(this,arguments)}var w,N=(g={},(0,u._)(g,"TITLE","Title"),(0,u._)(g,"SUBTITLE","Subtitle"),(0,u._)(g,"P","Normal"),(0,u._)(g,"H1","heading 1"),(0,u._)(g,"H2","heading 2"),(0,u._)(g,"H3","heading 3"),(0,u._)(g,"H4","heading 4"),(0,u._)(g,"H5","heading 5"),(0,u._)(g,"H6","heading 6"),g),T=(w={},(0,u._)(w,"TITLE","Title"),(0,u._)(w,"SUBTITLE","Subtitle"),(0,u._)(w,"P","Normal"),(0,u._)(w,"H7","Heading7"),(0,u._)(w,"H8","Heading8"),(0,u._)(w,"H9","Heading9"),w);function k(e,t){for(var n=document.createElement(t),r=0;r<e.attributes.length;r++){var i=e.attributes.item(r);n.setAttribute(i.name,i.value)}return e.childNodes.forEach((function(e){n.appendChild(e)})),n}var E=n(297309);function x(e){return M.apply(this,arguments)}function M(){return(M=(0,i._)((function(e){var t,n,r,i,o,a,u,c;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:return t=e.context,n=e.targetNode,r=e.placement,i=e.html,o=function(e){for(var t,n=(new DOMParser).parseFromString("<body>".concat(e,"</body>"),"text/html").body,r=Office.context.platform,i=document.createNodeIterator(n,NodeFilter.SHOW_ELEMENT);t=i.nextNode();){var o=(r===Office.PlatformType.OfficeOnline?N:T)[t.tagName];if((o||"P"===t.tagName)&&(t.style.marginTop||(t.style.marginTop="-1px"),t.style.marginBottom||(t.style.marginBottom="-1px")),"TABLE"===t.tagName&&(t.style.width||(t.style.width="620px"),t.style.tableLayout="fixed"),o){var a=k(t,"p");r===Office.PlatformType.OfficeOnline?a.setAttribute("data-ccp-parastyle",o):a.classList.add("Mso".concat(o)),t.replaceWith(a),i.nextNode()}}return r===Office.PlatformType.PC&&n.appendChild(document.createElement("br")),n.outerHTML}(i),(0,p.cY)("Importing HTML:\n",o),a=function(e,t){switch(t){case"Replace":return e.getRange("Whole");case"Before":case"After":var n=function(e,t){var n=e.insertParagraph("",t);return n.styleBuiltIn="Normal",n}(e,t);return n.getRange("Whole")}}(n,r),(0,l._)(n,Word.Table)&&a.delete(),(u=a.insertHtml(o,"Replace")).track(),[4,E.Y.highlightRange(u,t)];case 1:return s.sent(),c=u.paragraphs.getLastOrNullObject().load({uniqueLocalId:!0}),[4,t.sync()];case 2:if(s.sent(),c.isNullObject)throw new Error("Nothing was imported");return(0,p.cY)("Last replaced paragraph: ",c.uniqueLocalId),[2,c.uniqueLocalId]}}))}))).apply(this,arguments)}var S="abcdefghijklmnopqrstuvwxyz0123456789",H=function(){function e(){(0,o._)(this,e),(0,u._)(this,"nodeToModelId",new Map),(0,u._)(this,"modelIdToNode",new Map)}return(0,a._)(e,[{key:"getModelId",value:function(e){if(!this.nodeToModelId.has(e)){var t=this.createModelId();this.nodeToModelId.set(e,t),this.modelIdToNode.set(t,e)}return this.nodeToModelId.get(e)}},{key:"tryGetNodeId",value:function(e){var t;return null!==(t=this.modelIdToNode.get(e))&&void 0!==t?t:null}},{key:"clear",value:function(){this.nodeToModelId.clear(),this.modelIdToNode.clear()}},{key:"createModelId",value:function(){for(var e="",t=0;t<4;t++){var n=Math.floor(36*Math.random());e+=S.charAt(n)}return this.nodeToModelId.has(e)?this.createModelId():e}}]),e}();function O(e){return(0,i._)((function(){var t,n,r,i=arguments;return(0,s.__generator)(this,(function(o){switch(o.label){case 0:for(t=i.length,n=new Array(t),r=0;r<t;r++)n[r]=i[r];return[4,Word.run((function(t){return e.apply(void 0,[t].concat((0,d._)(n)))}))];case 1:return[2,o.sent()]}}))}))}function L(e,t){return C.apply(this,arguments)}function C(){return(C=(0,i._)((function(e,t){var n,r;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return n=e.document,t.startsWith("table-")?(r=Number.parseInt(t.slice(6),10),[4,P(e,r)]):[3,2];case 1:return[2,i.sent()];case 2:return[2,n.getParagraphByUniqueLocalId(t)]}}))}))).apply(this,arguments)}function A(e){return R.apply(this,arguments)}function R(){return(R=(0,i._)((function(e){return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return e.document.body.getRange("Whole").removeHighlight(),[4,e.sync()];case 1:return t.sent(),[2]}}))}))).apply(this,arguments)}function P(e,t){return B.apply(this,arguments)}function B(){return(B=(0,i._)((function(e,t){var n,r,i;return(0,s.__generator)(this,(function(o){switch(o.label){case 0:return n=e.document.body.tables.load({nestingLevel:!0}),[4,e.sync()];case 1:if(o.sent(),r=n.items.filter((function(e){return 1===e.nestingLevel})),!(i=r[t]))throw new Error("Table with id: ".concat(t," was not found"));return[2,i]}}))}))).apply(this,arguments)}var W=function(){function e(){(0,o._)(this,e),(0,u._)(this,"nodeIdRegistry",new H);var t,n=this;(0,u._)(this,"getDocumentHtml",O((t=(0,i._)((function(e){var t,r;return(0,s.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(0,p.cY)("Executing getDocumentHtml"),n.nodeIdRegistry.clear(),[4,y(e,n.nodeIdRegistry)];case 1:return t=i.sent(),(0,p.cY)("Document HTML:\n",t),[2,t];case 2:return r=i.sent(),(0,p.cY)(p.SA.Error,r),[2,"Failed to get document HTML"];case 3:return[2]}}))})),function(e){return t.apply(this,arguments)}))),(0,u._)(this,"beginEditSession",O(function(){var e=(0,i._)((function(e,t){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return(0,p.cY)("Executing beginEditSession with ",t),[4,A(e)];case 1:return n.sent(),[2,(0,c.A)()]}}))}));return function(t,n){return e.apply(this,arguments)}}()));var r=this;(0,u._)(this,"insertNode",O(function(){var e=(0,i._)((function(e,t){var n,i,o,a;return(0,s.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),(n=r.nodeIdRegistry.tryGetNodeId(t.nodeId))?[4,L(e,n)]:[2,"Node with `id` ".concat(t.nodeId," does not exist")];case 1:return i=u.sent(),[4,x({context:e,targetNode:i,html:t.content,placement:"before"===t.placement?"Before":"After"})];case 2:return o=u.sent(),[2,r.nodeIdRegistry.getModelId(o)];case 3:return a=u.sent(),(0,p.cY)(p.SA.Error,a),[2,"Failed to insert a node"];case 4:return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}()));var a=this;(0,u._)(this,"replaceNodeContent",O(function(){var e=(0,i._)((function(e,t){var n,r,i,o;return(0,s.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),(n=a.nodeIdRegistry.tryGetNodeId(t.nodeId))?[4,L(e,n)]:[2,"Node with `id` ".concat(t.nodeId," does not exist")];case 1:return r=u.sent(),[4,x({context:e,targetNode:r,placement:"Replace",html:t.content})];case 2:return i=u.sent(),[2,a.nodeIdRegistry.getModelId(i)];case 3:return o=u.sent(),(0,p.cY)(p.SA.Error,o),[2,"Failed to replace a node"];case 4:return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}()));var d=this;(0,u._)(this,"deleteNode",O(function(){var e=(0,i._)((function(e,t){var n,r,i;return(0,s.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),(n=d.nodeIdRegistry.tryGetNodeId(t.nodeId))?[4,L(e,n)]:[2,"Node with `id` ".concat(t.nodeId," does not exist")];case 1:return(r=o.sent()).track(),(0,l._)(r,Word.Paragraph)?(r.load({isListItem:!0}),[4,e.sync()]):[3,3];case 2:o.sent(),r.isListItem&&r.detachFromList(),o.label=3;case 3:return r.delete(),[2,"OK"];case 4:return i=o.sent(),(0,p.cY)(p.SA.Error,i),[2,"Failed to delete a node"];case 5:return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}()))}return(0,a._)(e,[{key:"endEditSession",value:function(e){return(0,i._)((function(){return(0,s.__generator)(this,(function(t){return(0,p.cY)("Executing endEditSession with ",e),[2,"Edit session ended successfully."]}))}))()}}]),e}(),j=n(720570),F=n(107182),Y=n(544698),U=n(695969);function D(e,t,n){return D=(0,Y.E)()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&(0,U.Z)(i,n.prototype),i},D.apply(null,arguments)}var q=n(575965);function G(e){var t="function"==typeof Map?new Map:void 0;return G=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return D(e,arguments,(0,q.r)(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,U.Z)(r,e)},G(e)}var z,K,Z,J=n(4026),V=n(602061),$=function(){function e(){(0,o._)(this,e),(0,u._)(this,"chatPrivateApi",void 0),this.chatPrivateApi=V.BDr.getInstance()}return(0,a._)(e,[{key:"getDocumentHtml",value:function(){return this.invokeToolMethod("getDocumentHtml")}},{key:"beginEditSession",value:function(e){return this.invokeToolMethod("beginEditSession",e)}},{key:"endEditSession",value:function(e){return this.invokeToolMethod("endEditSession",e)}},{key:"insertHtml",value:function(e){return this.invokeToolMethod("insertHtml",e)}},{key:"deleteNode",value:function(e){return this.invokeToolMethod("deleteNode",e)}},{key:"invokeToolMethod",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;return(0,i._)((function(){var r,i,o,a;return(0,s.__generator)(this,(function(u){switch(u.label){case 0:return r={dispidMethod:V.T7z.InvokeCanvasTool,payload:{jsonrpc:"2.0",method:e,params:t}},[4,n.chatPrivateApi.execute(r)];case 1:i=u.sent();try{o=JSON.parse(i)}catch(t){throw a=(0,l._)(t,Error)?t.message:"Unknown error",new Error("Failed to parse response from ".concat(e,": ").concat(a))}if(o.error)throw new Q(e,o.error);return[2,o.result]}}))}))()}}]),e}(),Q=function(e){(0,F._)(n,e);var t=(0,J._)(n);function n(e,r){var i;return(0,o._)(this,n),i=t.call(this,"Invocation of '".concat(e,"' JSON RPC method failed")),(0,u._)((0,j._)(i),"rpcError",void 0),i.rpcError=r,Object.setPrototypeOf((0,j._)(i),n.prototype),i}return n}(G(Error));!function(e){e.Cancelled="cancelled",e.Failed="failed",e.RunToCompletion="runToCompletion"}(z||(z={})),function(e){e.V1="v1"}(K||(K={})),function(e){e.After="after",e.Before="before",e.Replace="replace"}(Z||(Z={}));var X=function(){function e(){(0,o._)(this,e),(0,u._)(this,"privateApiClient",new $),(0,u._)(this,"currentSessionId",null)}return(0,a._)(e,[{key:"getDocumentHtml",value:function(){var e=this;return(0,i._)((function(){return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return[4,e.privateApiClient.getDocumentHtml()];case 1:return[2,t.sent().content]}}))}))()}},{key:"beginEditSession",value:function(e){var t=this;return(0,i._)((function(){var e;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return e=(0,c.A)(),[4,t.privateApiClient.beginEditSession({id:e})];case 1:return n.sent(),t.currentSessionId=e,[2,e]}}))}))()}},{key:"endEditSession",value:function(e){var t=this;return(0,i._)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:return[4,t.privateApiClient.endEditSession({id:t.currentSessionId,reason:z.RunToCompletion})];case 1:return e.sent(),t.currentSessionId=null,[2,"OK"]}}))}))()}},{key:"insertNode",value:function(e){var t=this;return(0,i._)((function(){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.privateApiClient.insertHtml({nodeId:e.nodeId,content:e.content,placement:e.placement})];case 1:return[2,n.sent().nodeId]}}))}))()}},{key:"replaceNodeContent",value:function(e){var t=this;return(0,i._)((function(){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.privateApiClient.insertHtml({nodeId:e.nodeId,content:e.content,placement:Z.Replace})];case 1:return[2,n.sent().nodeId]}}))}))()}},{key:"deleteNode",value:function(e){var t=this;return(0,i._)((function(){return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.privateApiClient.deleteNode({nodeId:e.nodeId})];case 1:return n.sent(),[2,"OK"]}}))}))()}}]),e}(),ee=n(740389);function te(){return(0,ee.BSB)()?new X:new W}}}]);
//# sourceMappingURL=wordcanvastool.js.map