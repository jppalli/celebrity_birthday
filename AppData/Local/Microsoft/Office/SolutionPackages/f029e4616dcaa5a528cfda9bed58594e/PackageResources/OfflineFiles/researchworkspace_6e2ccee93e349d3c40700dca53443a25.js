"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[5163],{239976:(e,t,n)=>{n.r(t),n.d(t,{Research:()=>ds,getLoopCard:()=>F});var o=n(95903),r=n(12227),i=n(365396),s=n(348238),a=n(110282),l=n(660484),c=n(104623),d=n(199641),p=n(321489),u=n(220732),h=n(609898),m=n(687458),g=n(876728),f=n(527439),y=n(256369),b=n(208520),v=n(275277),C=n(919961),_=n(752155),x=n(894416),k=n(758651);const S=new C.I({containerEnvironment:"Staging",localeHint:"en-us"});var E;!function(e){e.PlotlyJson="PlotlyJson",e.PlainText="PlainText"}(E||(E={}));const P={get Disposable(){return this},dispose(){k.log("DummyDisposable disposed")}},w=new v.H;w.register("FluidUrlResolverProvider",Promise.resolve({urlResolver:{resolve:async e=>Promise.resolve(e.url)},get FluidUrlResolverProvider(){return this},get Disposable(){return P}})),w.register("FluidDocumentServiceFactoryProvider",Promise.resolve({documentServiceFactory:{},get FluidDocumentServiceFactoryProvider(){return this},get Disposable(){return P}})),w.register("FluidCodeLoaderFactory",S),w.register("SettingsProvider",new class{constructor(e="Staging"){this.audience=e}getSetting(e,t,n){return"Fluid.Container.MemoryBlobStorageEnabled"===e||("codeBlock.previewPlotlyEnabled"===e||t)}get SettingsProvider(){return this}get Disposable(){return this}dispose(){k.log("MockSettingsProvider disposed")}});const I={HTMLViewable:"HTMLViewable",Disposable:"Disposable",ComponentCanvasProvider:"ComponentCanvasProvider"},T=({htmlData:e="",documentUrl:t="",insertHtmlText:n="",isArtifactData:o=!1,loopCodeArtifactType:r=E.PlainText})=>{k.log(t,n);const i=(0,b.useRef)(null),s=(0,b.useRef)(),a=(0,b.useRef)();return e=R(e,o,r),(0,b.useEffect)((()=>{o||s.current?.ComponentRichTextEditor?.setHtml(""==e?"Draft content will be generated here":e)}),[e]),(0,b.useEffect)((()=>{i.current&&async function(t){try{const n={iframeHostingDiv:t,dependencySynthesizer:w,loopComponentRouterInput:{type:"Fluid",codeDetails:(0,_.oO)()},options:{iframeTitle:"Loop Component"},config:{environment:{audience:"Staging"}},requiredProviderTypes:I},r=(0,x.j)(n),i=await r.component;if(r.addOnDisposeAction((()=>i.Disposable?.dispose())),s.current=await(i.ComponentCanvasProvider?.getCanvasComponent()),a.current=await(i.ComponentCanvasProvider?.getCanvasComponent()),o){const t=a.current?.ComponentEditable;if(!t)throw new Error("ComponentEditable is not available");if(!t.createComponentRange||!t.appendContent)throw new Error("ComponentEditable APIs are not available");const n=e,o=await t.createComponentRange();t.appendContent(""==n?"Draft content will be generated here":n,o,{attribution:void 0})}else s.current?.ComponentRichTextEditor?.setHtml(""==e?"Draft content will be generated here":e);const l=(await(i.HTMLViewable?.getView()))?.HTMLView;r.addOnDisposeAction((()=>l?.dispose())),l?.render(r.getRenderHostingElement())}catch(e){k.error("loadAndRender failed with error:",e)}}(i.current)}),[i,s,a]),b.createElement("div",{ref:i,style:{height:"100%",alignContent:"start"}})},R=(e,t,n)=>{if(!t||null==n)return e;switch(n){case E.PlainText:return'<pre><code class="language-Plain">'+e+"</code></pre>";case E.PlotlyJson:return'<pre><code class="language-Json" preview="Preview">'+e+"</code></pre>";default:return'<pre><code class="language-Plain">'+e+"</code></pre>"}};var D=n(260623),N=n(379563),O=n(529404);const A=(0,D.n)({cardStyle:{padding:"1px",borderRadius:"8px",zIndex:999,maxHeight:"80vh",overflowY:"auto"},cardGap:{...N.Pt.gap("8px")},headerStyle:{marginTop:"20px !important"},paddingBottom:{paddingBottom:"12px"},PinCardsStyle:{padding:"12px",backgroundColor:O.L.colorNeutralBackground2},accordionPanelStyle:{paddingBottom:"12px",...N.Pt.gap("8px")},pinnedMessageStyle:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",maxHeight:"3em",lineHeight:"1.5em",whiteSpace:"normal"},showMoreCardStyle:{padding:"4px 8px",borderRadius:"8px",backgroundColor:O.L.colorNeutralBackground2}});var B=n(758651);const M=({id:e,content:t,addButtonProps:n,copyButtonProps:v,pinButtonProps:C,aiHelpButtonProps:_,aiSuggestionButtonProps:x,isContentSensitive:k=!1,isArtifactData:S=!1,loopCodeArtifactType:E})=>{const P=A(),w=e=>b.createElement(i.W,{positioning:"above"},b.createElement(s.c,{disableButtonEnhancement:!0},b.createElement(a.$,{size:"small",appearance:"transparent",icon:e?.buttonIcon??b.createElement(b.Fragment,null,e?.buttonIcon)},e?.buttonText)),b.createElement(l.b,null,b.createElement(c.c,null,b.createElement(d.r,null,b.createElement(p.s,null,b.createElement(u.Q,null,e.headerText)),e?.suggestionList.map((e=>b.createElement(b.Fragment,null,b.createElement(h.c,null),b.createElement(m.D,{onClick:()=>e?.onClick(t,e.content,e.responsetype,e.skillName),icon:e.icon},e.content))))))));return b.createElement(o.B,{key:e},b.createElement(r.a,null,((e,t,n)=>{const o=e.replace(/<table/g,'<table style="width:100%; height: 100%;"');return B.log("HtmlContent  ",o),b.createElement(T,{htmlData:e,documentUrl:"documentUrl",key:"loopComponent",insertHtmlText:e,isArtifactData:t,loopCodeArtifactType:n})})(t,S,E)),b.createElement(o.B,{horizontal:!0,className:P.cardGap},n&&b.createElement(a.$,{size:"small",icon:n.icon??b.createElement(g.m61,null),onClick:()=>n.onClick?.(t),disabled:k},n.text),_&&w(_),v&&b.createElement(a.$,{size:"small",appearance:"transparent",icon:v.icon??b.createElement(f.Qvr,null),onClick:()=>v.onClick?.(t),disabled:k}),C&&b.createElement(a.$,{size:"small",appearance:"transparent",icon:C.icon??b.createElement(y.MtV,null),onClick:()=>C.onClick?.(t,e),disabled:k}),x&&w(x)))},F=(e,t,n,o,r,i,s,a,l,c)=>b.createElement(M,{id:e,content:t,addButtonProps:n,copyButtonProps:o,pinButtonProps:r,aiHelpButtonProps:i,aiSuggestionButtonProps:s,isContentSensitive:a,isArtifactData:l,loopCodeArtifactType:c});var L,H=n(918271),W=n(928599),z=n(335072),G=n(496229),U=n(379490),Q=n(27118),q=n(460757),K=n(104655),$=n(487395),j=n(794766),V=n(503117),Z=n(823148),J=n(273672),Y=n(452481),X=n(433799),ee=n(529211),te=n(112402),ne=n(769602),oe=n(231989),re=n(870083),ie=n(204385),se=n(384549),ae=n(67127),le=n(245965),ce=n(852036),de=n(616591),pe=(0,ce.J9)((function(e,t){var n,o,r,i=(0,de.$)(e),s={root:(n={padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"1px solid transparent"},n[le.up]={borderColor:"Window"},n),rootHovered:(o={color:e.palette.themePrimary},o[le.up]={color:"Highlight"},o),iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:(r={color:e.palette.neutralTertiary,backgroundColor:"transparent",borderColor:"transparent"},r[le.up]={color:"GrayText"},r),rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return(0,le.TW)(i,s,t)})),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,U.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return b.createElement(ie.S,(0,U.__assign)({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:pe(n,t),onRenderDescription:se.K}))},t=(0,U.__decorate)([(0,ae.T)("ActionButton",["theme","styles"],!0)],t)}(b.Component),he=ue;!function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.SelectAll=3]="SelectAll"}(L||(L={}));var me,ge=function(){function e(){this._size=0}return e.prototype.updateOptions=function(e){for(var t=[],n=[],o=0,r=0;r<e.length;r++){var i=e[r],s=i.itemType,a=i.hidden;s===L.Divider||s===L.Header?(t.push(r),n.push(r)):a?n.push(r):o++}this._size=o,this._displayOnlyOptionsCache=t,this._notSelectableOptionsCache=n,this._cachedOptions=(0,U.__spreadArray)([],e,!0)},Object.defineProperty(e.prototype,"optionSetSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedOptions",{get:function(){return this._cachedOptions},enumerable:!1,configurable:!0}),e.prototype.positionInSet=function(e){if(void 0!==e){for(var t=0;e>this._notSelectableOptionsCache[t];)t++;if(this._displayOnlyOptionsCache[t]===e)throw new Error("Unexpected: Option at index ".concat(e," is not a selectable element."));if(this._notSelectableOptionsCache[t]!==e)return e-t+1}},e}(),fe=n(335475),ye=n(254004),be=n(671821),ve=n(528079),Ce=n(553329),_e=n(49698),xe=n(653558),ke=n(677936),Se=n(174023),Ee=n(112738),Pe=n(984896),we=n(771829),Ie=n(262162),Te=n(685298),Re=n(137097);!function(e){e[e.smallFluid=0]="smallFluid",e[e.smallFixedFar=1]="smallFixedFar",e[e.smallFixedNear=2]="smallFixedNear",e[e.medium=3]="medium",e[e.large=4]="large",e[e.largeFixed=5]="largeFixed",e[e.extraLarge=6]="extraLarge",e[e.custom=7]="custom",e[e.customNear=8]="customNear"}(me||(me={}));var De,Ne=n(8039),Oe=n(632401),Ae=(0,Q.Z)();!function(e){e[e.closed=0]="closed",e[e.animatingOpen=1]="animatingOpen",e[e.open=2]="open",e[e.animatingClosed=3]="animatingClosed"}(De||(De={}));var Be,Me,Fe,Le,He,We=function(e){function t(t){var n=e.call(this,t)||this;n._panel=b.createRef(),n._animationCallback=null,n._hasCustomNavigation=!(!n.props.onRenderNavigation&&!n.props.onRenderNavigationContent),n.dismiss=function(e){n.props.onDismiss&&n.isActive&&n.props.onDismiss(e),(!e||e&&!e.defaultPrevented)&&n.close()},n._allowScrollOnPanel=function(e){var t;n._resizeObserver=n._createResizeObserver((function(t){t.length>0&&t[0].target===e&&n._updateFooterPosition()})),e?(null===(t=n._resizeObserver)||void 0===t||t.observe(e),n._allowTouchBodyScroll?(0,Se.K0)(e,n._events):(0,Se.c8)(e,n._events)):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onRenderNavigation=function(e){if(!n.props.onRenderNavigationContent&&!n.props.onRenderNavigation&&!n.props.hasCloseButton)return null;var t=n.props.onRenderNavigationContent,o=void 0===t?n._onRenderNavigationContent:t;return b.createElement("div",{className:n._classNames.navigation},o(e,n._onRenderNavigationContent))},n._onRenderNavigationContent=function(e){var t,o=e.closeButtonAriaLabel,r=e.hasCloseButton,i=e.onRenderHeader,s=void 0===i?n._onRenderHeader:i;if(r){var a=null===(t=n._classNames.subComponentStyles)||void 0===t?void 0:t.closeButton();return b.createElement(b.Fragment,null,!n._hasCustomNavigation&&s(n.props,n._onRenderHeader,n._headerTextId),b.createElement(Ce.K,{styles:a,className:n._classNames.closeButton,onClick:n._onPanelClick,ariaLabel:o,title:o,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null},n._onRenderHeader=function(e,t,o){var r=e.headerText,i=e.headerTextProps,s=void 0===i?{}:i;return r?b.createElement("div",{className:n._classNames.header},b.createElement("div",(0,U.__assign)({id:o,role:"heading","aria-level":1},s,{className:(0,$.A)(n._classNames.headerText,s.className)}),r)):null},n._onRenderBody=function(e){return b.createElement("div",{className:n._classNames.content},e.children)},n._onRenderFooter=function(e){var t=n.props.onRenderFooterContent,o=void 0===t?null:t;return o?b.createElement("div",{className:n._classNames.footer},b.createElement("div",{className:n._classNames.footerInner},o())):null},n._animateTo=function(e){e===De.open&&n.props.onOpen&&n.props.onOpen(),n._animationCallback=n._async.setTimeout((function(){n.setState({visibility:e}),n._onTransitionComplete(e)}),200)},n._clearExistingAnimationTimer=function(){null!==n._animationCallback&&n._async.clearTimeout(n._animationCallback)},n._onPanelClick=function(e){n.dismiss(e)},n._onTransitionComplete=function(e){n._updateFooterPosition(),e===De.open&&n.props.onOpened&&n.props.onOpened(),e===De.closed&&n.props.onDismissed&&n.props.onDismissed()};var o=n.props.allowTouchBodyScroll,r=void 0!==o&&o;return n._allowTouchBodyScroll=r,(0,J.f)(n),(0,Ee.A)("Panel",t,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),n.state={isFooterSticky:!1,visibility:De.closed,id:(0,Y.O)("Panel")},n}return(0,U.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return void 0===e.isOpen?null:!e.isOpen||t.visibility!==De.closed&&t.visibility!==De.animatingClosed?e.isOpen||t.visibility!==De.open&&t.visibility!==De.animatingOpen?null:{visibility:De.animatingClosed}:{visibility:De.animatingOpen}},t.prototype.componentDidMount=function(){this._async=new Pe.j(this),this._events=new we.g(this);var e=(0,Oe.k_)(this.context),t=(0,Oe.LW)(this.context);this._events.on(e,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(null==t?void 0:t.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.setState({visibility:De.animatingOpen})},t.prototype.componentDidUpdate=function(e,t){var n=this._shouldListenForOuterClick(this.props),o=this._shouldListenForOuterClick(e);this.state.visibility!==t.visibility&&(this._clearExistingAnimationTimer(),this.state.visibility===De.animatingOpen?this._animateTo(De.open):this.state.visibility===De.animatingClosed&&this._animateTo(De.closed));var r=(0,Oe.LW)(this.context);n&&!o?this._events.on(null==r?void 0:r.body,"mousedown",this._dismissOnOuterClick,!0):!n&&o&&this._events.off(null==r?void 0:r.body,"mousedown",this._dismissOnOuterClick,!0)},t.prototype.componentWillUnmount=function(){var e;this._async.dispose(),this._events.dispose(),null===(e=this._resizeObserver)||void 0===e||e.disconnect()},t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,o=e.elementToFocusOnDismiss,r=e.firstFocusableSelector,i=e.focusTrapZoneProps,s=e.forceFocusInsideTrap,a=e.hasCloseButton,l=e.headerText,c=e.headerClassName,d=void 0===c?"":c,p=e.ignoreExternalFocusing,u=e.isBlocking,h=e.isFooterAtBottom,m=e.isLightDismiss,g=e.isHiddenOnDismiss,f=e.layerProps,y=e.overlayProps,v=e.popupProps,C=e.type,_=e.styles,x=e.theme,k=e.customWidth,S=e.onLightDismissClick,E=void 0===S?this._onPanelClick:S,P=e.onRenderNavigation,w=void 0===P?this._onRenderNavigation:P,I=e.onRenderHeader,T=void 0===I?this._onRenderHeader:I,R=e.onRenderBody,D=void 0===R?this._onRenderBody:R,N=e.onRenderFooter,O=void 0===N?this._onRenderFooter:N,A=this.state,B=A.isFooterSticky,M=A.visibility,F=A.id,L=C===me.smallFixedNear||C===me.customNear,H=(0,Ie.jI)(x)?L:!L,W=C===me.custom||C===me.customNear?{width:k}:{},z=(0,X.G1)(this.props,X.JM),G=this.isActive,Q=M===De.animatingClosed||M===De.animatingOpen;if(this._headerTextId=l&&F+"-headerText",!G&&!Q&&!g)return null;this._classNames=Ae(_,{theme:x,className:n,focusTrapZoneClassName:i?i.className:void 0,hasCloseButton:a,headerClassName:d,isAnimating:Q,isFooterSticky:B,isFooterAtBottom:h,isOnRightSide:H,isOpen:G,isHiddenOnDismiss:g,type:C,hasCustomNavigation:this._hasCustomNavigation});var q,K=this._classNames,$=this._allowTouchBodyScroll;return u&&G&&(q=b.createElement(xe.h,(0,U.__assign)({className:K.overlay,isDarkThemed:!1,onClick:m?E:void 0,allowTouchBodyScroll:$},y))),b.createElement(_e.W,(0,U.__assign)({},f),b.createElement(ke.z,(0,U.__assign)({role:"dialog","aria-modal":u?"true":void 0,ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:K.hiddenPanel,enableAriaHiddenSiblings:!!G},v),b.createElement("div",(0,U.__assign)({"aria-hidden":!G&&Q},z,{ref:this._panel,className:K.root}),q,b.createElement(Re.Y,(0,U.__assign)({ignoreExternalFocusing:p,forceFocusInsideTrap:!(!u||g&&!G)&&s,firstFocusableSelector:r,isClickableOutsideFocusTrap:!0},i,{className:K.main,style:W,elementToFocusOnDismiss:o}),b.createElement("div",{className:K.contentInner},b.createElement("div",{ref:this._allowScrollOnPanel,className:K.scrollableContent,"data-is-scrollable":!0},b.createElement("div",{className:K.commands,"data-is-visible":!0},w(this.props,this._onRenderNavigation)),(this._hasCustomNavigation||!a)&&T(this.props,this._onRenderHeader,this._headerTextId),D(this.props,this._onRenderBody),O(this.props,this._onRenderFooter)))))))},t.prototype.open=function(){void 0===this.props.isOpen&&(this.isActive||this.setState({visibility:De.animatingOpen}))},t.prototype.close=function(){void 0===this.props.isOpen&&this.isActive&&this.setState({visibility:De.animatingClosed})},Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state.visibility===De.open||this.state.visibility===De.animatingOpen},enumerable:!1,configurable:!0}),t.prototype._createResizeObserver=function(e){var t,n=(0,Oe.LW)(this.context),o=null;return(null===(t=null==n?void 0:n.defaultView)||void 0===t?void 0:t.ResizeObserver)&&(o=new n.defaultView.ResizeObserver(e)),o},t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen},t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,n=e.scrollHeight;this.setState({isFooterSticky:t<n})}},t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this.isActive&&t&&!e.defaultPrevented&&((0,Te.s)(t,e.target)||(this.props.onOuterClick?this.props.onOuterClick(e):this.dismiss(e)))},t.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:me.smallFixedFar},t.contextType=Ne._0,t}(b.Component),ze={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},Ge="100%",Ue="auto",Qe=272,qe=340,Ke=592,$e=644,je=940,Ve="auto",Ze=0,Je=48,Ye=428,Xe=176,et=((Be={})["@media (min-width: ".concat(le.O7,"px)")]={width:qe},Be),tt=((Me={})["@media (min-width: ".concat(le.mu,"px)")]={width:Ke},Me["@media (min-width: ".concat(le.af,"px)")]={width:$e},Me),nt=((Fe={})["@media (min-width: ".concat(le.c3,"px)")]={left:Je,width:Ue},Fe["@media (min-width: ".concat(le.Ke,"px)")]={left:Ye},Fe),ot=((Le={})["@media (min-width: ".concat(le.Ke,"px)")]={left:Ve,width:je},Le),rt=((He={})["@media (min-width: ".concat(le.Ke,"px)")]={left:Xe},He),it=function(e){var t;switch(e){case me.smallFixedFar:t=(0,U.__assign)({},et);break;case me.medium:t=(0,U.__assign)((0,U.__assign)({},et),tt);break;case me.large:t=(0,U.__assign)((0,U.__assign)((0,U.__assign)({},et),tt),nt);break;case me.largeFixed:t=(0,U.__assign)((0,U.__assign)((0,U.__assign)((0,U.__assign)({},et),tt),nt),ot);break;case me.extraLarge:t=(0,U.__assign)((0,U.__assign)((0,U.__assign)((0,U.__assign)({},et),tt),nt),rt)}return t},st={paddingLeft:"24px",paddingRight:"24px"},at=(0,G.I)(We,(function(e){var t,n,o,r,i=e.className,s=e.focusTrapZoneClassName,a=e.hasCloseButton,l=e.headerClassName,c=e.isAnimating,d=e.isFooterSticky,p=e.isFooterAtBottom,u=e.isOnRightSide,h=e.isOpen,m=e.isHiddenOnDismiss,g=e.hasCustomNavigation,f=e.theme,y=e.type,b=void 0===y?me.smallFixedFar:y,v=f.effects,C=f.fonts,_=f.semanticColors,x=(0,le.Km)(ze,f),k=b===me.custom||b===me.customNear;return{root:[x.root,f.fonts.medium,h&&x.isOpen,a&&x.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},k&&u&&x.custom,k&&!u&&x.customNear,i],overlay:[{pointerEvents:"auto",cursor:"pointer"},h&&c&&le.lw.fadeIn100,!h&&c&&le.lw.fadeOut100],hiddenPanel:[!h&&!c&&m&&{visibility:"hidden"}],main:[x.main,{backgroundColor:_.bodyBackground,boxShadow:v.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:Ve,right:Ze,width:Ge,selectors:(0,U.__assign)((t={},t[le.up]={borderLeft:"3px solid ".concat(_.variantBorder),borderRight:"3px solid ".concat(_.variantBorder)},t),it(b))},b===me.smallFluid&&{left:Ze},b===me.smallFixedNear&&{left:Ze,right:Ve,width:Qe},b===me.customNear&&{right:"auto",left:0},k&&{maxWidth:"100vw"},h&&c&&!u&&le.lw.slideRightIn40,h&&c&&u&&le.lw.slideLeftIn40,!h&&c&&!u&&le.lw.slideLeftOut40,!h&&c&&u&&le.lw.slideRightOut40,s],commands:[x.commands,{backgroundColor:_.bodyBackground,paddingTop:18,selectors:(n={},n["@media (min-height: ".concat(le.O7,"px)")]={position:"sticky",top:0,zIndex:1},n)},g&&{paddingTop:"inherit"}],navigation:[x.navigation,{display:"flex",justifyContent:"flex-end"},g&&{height:"44px"}],contentInner:[x.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden"}],header:[x.header,st,{alignSelf:"flex-start"},a&&!g&&{flexGrow:1},g&&{flexShrink:0}],headerText:[x.headerText,C.xLarge,{color:_.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},l],scrollableContent:[x.scrollableContent,{overflowY:"auto"},p&&{flexGrow:1,display:"inherit",flexDirection:"inherit"}],content:[x.content,st,{paddingBottom:20},p&&{selectors:(o={},o["@media (min-height: ".concat(le.O7,"px)")]={flexGrow:1},o)}],footer:[x.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity ".concat(le.cs.durationValue3," ").concat(le.cs.easeFunction2),selectors:(r={},r["@media (min-height: ".concat(le.O7,"px)")]={position:"sticky",bottom:0},r)},d&&{backgroundColor:_.bodyBackground,borderTopColor:_.variantBorder}],footerInner:[x.footerInner,st,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[x.closeButton,{marginRight:14,color:f.palette.neutralSecondary,fontSize:le.fF.large},g&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:f.palette.neutralPrimary}}}}}),void 0,{scope:"Panel"}),lt=n(165820),ct=n(792763);function dt(e,t){for(var n=[],o=0,r=t;o<r.length;o++){var i=e[r[o]];i&&n.push(i)}return n}var pt=n(607201),ut=n(440906),ht=n(298770),mt=n(388020),gt=(0,Q.Z)(),ft=b.forwardRef((function(e,t){var n=e.disabled,o=e.required,r=e.inputProps,i=e.name,s=e.ariaLabel,a=e.ariaLabelledBy,l=e.ariaDescribedBy,c=e.ariaPositionInSet,d=e.ariaSetSize,p=e.title,u=e.checkmarkIconProps,h=e.styles,m=e.theme,g=e.className,f=e.boxSide,y=void 0===f?"start":f,v=(0,pt.B)("checkbox-",e.id),C=b.useRef(null),_=(0,ut.a)(C,t),x=b.useRef(null),k=(0,ht.k)(e.checked,e.defaultChecked,e.onChange),S=k[0],E=k[1],P=(0,ht.k)(e.indeterminate,e.defaultIndeterminate),w=P[0],I=P[1];(0,mt.vk)(C);var T=gt(h,{theme:m,className:g,disabled:n,indeterminate:w,checked:S,reversed:"start"!==y,isUsingCustomLabelRender:!!e.onRenderLabel}),R=b.useCallback((function(e){w?(E(!!S,e),I(!1)):E(!S,e)}),[E,I,w,S]),D=b.useCallback((function(e){return e&&e.label?b.createElement("span",{className:T.text,title:e.title},e.label):null}),[T.text]),N=b.useCallback((function(e){if(x.current){var t=!!e;x.current.indeterminate=t,I(t)}}),[I]);!function(e,t,n,o,r){b.useImperativeHandle(e.componentRef,(function(){return{get checked(){return!!t},get indeterminate(){return!!n},set indeterminate(e){o(e)},focus:function(){r.current&&r.current.focus()}}}),[r,t,n,o])}(e,S,w,N,x),b.useEffect((function(){return N(w)}),[N,w]);var O=e.onRenderLabel||D,A=w?"mixed":void 0,B=(0,U.__assign)((0,U.__assign)({className:T.input,type:"checkbox"},r),{checked:!!S,disabled:n,required:o,name:i,id:v,title:p,onChange:R,"aria-disabled":n,"aria-label":s,"aria-labelledby":a,"aria-describedby":l,"aria-posinset":c,"aria-setsize":d,"aria-checked":A});return b.createElement("div",{className:T.root,title:p,ref:_},b.createElement("input",(0,U.__assign)({},B,{ref:x,title:p,"data-ktp-execute-target":!0})),b.createElement("label",{className:T.label,htmlFor:v},b.createElement("div",{className:T.checkbox,"data-ktp-target":!0},b.createElement(be.I,(0,U.__assign)({iconName:"CheckMark"},u,{className:T.checkmark}))),O(e,D)))}));ft.displayName="CheckboxBase";var yt=n(358426),bt={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"},vt="20px",Ct="200ms",_t="cubic-bezier(.4, 0, .23, 1)",xt=(0,G.I)(ft,(function(e){var t,n,o,r,i,s,a,l,c,d,p,u,h,m,g,f,y,b,v=e.className,C=e.theme,_=e.reversed,x=e.checked,k=e.disabled,S=e.isUsingCustomLabelRender,E=e.indeterminate,P=C.semanticColors,w=C.effects,I=C.palette,T=C.fonts,R=(0,le.Km)(bt,C),D=P.inputForegroundChecked,N=I.neutralSecondary,O=I.neutralPrimary,A=P.inputBackgroundChecked,B=P.inputBackgroundChecked,M=P.disabledBodySubtext,F=P.inputBorderHovered,L=P.inputBackgroundCheckedHovered,H=P.inputBackgroundChecked,W=P.inputBackgroundCheckedHovered,z=P.inputBackgroundCheckedHovered,G=P.inputTextHovered,Q=P.disabledBodySubtext,q=P.bodyText,K=P.disabledText,$=[(t={content:'""',borderRadius:w.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:k?M:A,transitionProperty:"border-width, border, border-color",transitionDuration:Ct,transitionTimingFunction:_t},t[le.up]={borderColor:"WindowText"},t)];return{root:[R.root,{position:"relative",display:"flex"},_&&"reversed",x&&"is-checked",!k&&"is-enabled",k&&"is-disabled",!k&&[!x&&(n={},n[":hover .".concat(R.checkbox)]=(o={borderColor:F},o[le.up]={borderColor:"Highlight"},o),n[":focus .".concat(R.checkbox)]={borderColor:F},n[":hover .".concat(R.checkmark)]=(r={color:N,opacity:"1"},r[le.up]={color:"Highlight"},r),n),x&&!E&&(i={},i[":hover .".concat(R.checkbox)]={background:W,borderColor:z},i[":focus .".concat(R.checkbox)]={background:W,borderColor:z},i[le.up]=(s={},s[":hover .".concat(R.checkbox)]={background:"Highlight",borderColor:"Highlight"},s[":focus .".concat(R.checkbox)]={background:"Highlight"},s[":focus:hover .".concat(R.checkbox)]={background:"Highlight"},s[":focus:hover .".concat(R.checkmark)]={color:"Window"},s[":hover .".concat(R.checkmark)]={color:"Window"},s),i),E&&(a={},a[":hover .".concat(R.checkbox,", :hover .").concat(R.checkbox,":after")]=(l={borderColor:L},l[le.up]={borderColor:"WindowText"},l),a[":focus .".concat(R.checkbox)]={borderColor:L},a[":hover .".concat(R.checkmark)]={opacity:"0"},a),(c={},c[":hover .".concat(R.text,", :focus .").concat(R.text)]=(d={color:G},d[le.up]={color:k?"GrayText":"WindowText"},d),c)],v],input:(p={position:"absolute",background:"none",opacity:0},p[".".concat(yt.Y2," &:focus + label::before, :host(.").concat(yt.Y2,") &:focus + label::before")]=(u={outline:"1px solid "+C.palette.neutralSecondary,outlineOffset:"2px"},u[le.up]={outline:"1px solid WindowText"},u),p),label:[R.label,C.fonts.medium,{display:"flex",alignItems:S?"center":"flex-start",cursor:k?"default":"pointer",position:"relative",userSelect:"none"},_&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[R.checkbox,(h={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:vt,width:vt,border:"1px solid ".concat(O),borderRadius:w.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:Ct,transitionTimingFunction:_t,overflow:"hidden",":after":E?$:null},h[le.up]=(0,U.__assign)({borderColor:"WindowText"},(0,le.Qg)()),h),E&&{borderColor:A},_?{marginLeft:4}:{marginRight:4},!k&&!E&&x&&(m={background:H,borderColor:B},m[le.up]={background:"Highlight",borderColor:"Highlight"},m),k&&(g={borderColor:M},g[le.up]={borderColor:"GrayText"},g),x&&k&&(f={background:Q,borderColor:M},f[le.up]={background:"Window"},f)],checkmark:[R.checkmark,(y={opacity:x&&!E?"1":"0",color:D},y[le.up]=(0,U.__assign)({color:k?"GrayText":"Window"},(0,le.Qg)()),y)],text:[R.text,(b={color:k?K:q,fontSize:T.medium.fontSize,lineHeight:"20px"},b[le.up]=(0,U.__assign)({color:k?"GrayText":"WindowText"},(0,le.Qg)()),b),_?{marginRight:4}:{marginLeft:4}]}}),void 0,{scope:"Checkbox"}),kt=n(580730),St=n(144145),Et=(0,Q.Z)(),Pt={options:[]};var wt=b.forwardRef((function(e,t){var n=(0,kt.N)(Pt,e),o=b.useRef(null),r=(0,ut.a)(t,o),i=(0,lt.z)(o,n.responsiveMode),s=function(e){var t,n=e.defaultSelectedKeys,o=e.selectedKeys,r=e.defaultSelectedKey,i=e.selectedKey,s=e.options,a=e.multiSelect,l=(0,St.Z)(s),c=b.useState([]),d=c[0],p=c[1],u=s!==l;t=a?u&&void 0!==n?n:o:u&&void 0!==r?r:i;var h=(0,St.Z)(t);return b.useEffect((function(){var e=function(){return s.map((function(e,t){return e.selected?t:-1})).filter((function(e){return-1!==e}))},n=function(e){return(0,q.SL)(s,(function(t){return null!=e?t.key===e:!!t.selected||!!t.isSelected}))};void 0===t&&l||t===h&&!u||p(function(){if(void 0===t)return a?e():-1!==(s=n(null))?[s]:[];if(!Array.isArray(t))return-1!==(s=n(t))?[s]:[];for(var o=[],r=0,i=t;r<i.length;r++){var s,l=i[r];-1!==(s=n(l))&&o.push(s)}return o}())}),[u,a,l,h,s,t]),[d,p]}(n),a=s[0],l=s[1];return b.createElement(Ot,(0,U.__assign)({},n,{responsiveMode:i,hoisted:{rootRef:r,selectedIndices:a,setSelectedIndices:l}}))}));wt.displayName="DropdownBase";var It,Tt,Rt,Dt,Nt,Ot=function(e){function t(t){var n,o,r=e.call(this,t)||this;r._host=b.createRef(),r._focusZone=b.createRef(),r._dropDown=b.createRef(),r._scrollIdleDelay=250,r._sizePosCache=new ge,r._requestAnimationFrame=(n=r,function(e){o||(o=new Set,(0,K.i)(n,{componentWillUnmount:function(){o.forEach((function(e){return cancelAnimationFrame(e)}))}}));var t=requestAnimationFrame((function(){o.delete(t),e()}));o.add(t)}),r.dismissMenu=function(){r.state.isOpen&&r.setState({isOpen:!1})},r._onChange=function(e,t,n,o,i){var s=r.props,a=s.onChange,l=s.onChanged;if(a||l){var c=i?(0,U.__assign)((0,U.__assign)({},t[n]),{selected:!o}):t[n];a&&a((0,U.__assign)((0,U.__assign)({},e),{target:r._dropDown.current}),c,n),l&&l(c,n)}},r._getPlaceholder=function(){return r.props.placeholder||r.props.placeHolder},r._getTitle=function(e,t){var n=r.props.multiSelectDelimiter,o=void 0===n?", ":n;return e.map((function(e){return e.text})).join(o)},r._onRenderTitle=function(e){return b.createElement(b.Fragment,null,r._getTitle(e))},r._onRenderPlaceholder=function(e){return r._getPlaceholder()?b.createElement(b.Fragment,null,r._getPlaceholder()):null},r._onRenderContainer=function(e){var t=e.calloutProps,n=e.panelProps,o=r.props,i=o.responsiveMode,s=o.dropdownWidth,a=i<=ct.AR.medium,l={firstFocusableTarget:"#".concat(r._listId,"1")},c=r._classNames.subComponentStyles?r._classNames.subComponentStyles.panel:void 0,d=void 0,p=void 0;return"auto"===s?p=r._dropDown.current?r._dropDown.current.clientWidth:0:d=s||(r._dropDown.current?r._dropDown.current.clientWidth:0),a?b.createElement(at,(0,U.__assign)({closeButtonAriaLabel:"Close",focusTrapZoneProps:l,hasCloseButton:!0,isOpen:!0,isLightDismiss:!0,onDismiss:r._onDismiss,styles:c},n),r._renderFocusableList(e)):b.createElement(oe.P,(0,U.__assign)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHintFixed:!1,directionalHint:re.A.bottomLeftEdge,calloutWidth:d,calloutMinWidth:p},t,{className:r._classNames.callout,target:r._dropDown.current,onDismiss:r._onDismiss,onScroll:r._onScroll,onPositioned:r._onPositioned}),r._renderFocusableList(e))},r._onRenderCaretDown=function(e){return b.createElement(be.I,{className:r._classNames.caretDown,iconName:"ChevronDown","aria-hidden":!0})},r._onRenderList=function(e){var t=e.onRenderItem,n=void 0===t?r._onRenderItem:t,o={items:[]},i=[],s=function(){var e=o.id?[b.createElement("div",{role:"group",key:o.id,"aria-labelledby":o.id},o.items)]:o.items;i=(0,U.__spreadArray)((0,U.__spreadArray)([],i,!0),e,!0),o={items:[]}};return e.options.forEach((function(e,t){!function(e,t){switch(e.itemType){case L.Header:o.items.length>0&&s();var i=r._id+e.key;o.items.push(n((0,U.__assign)((0,U.__assign)({id:i},e),{index:t}),r._onRenderItem)),o.id=i;break;case L.Divider:t>0&&o.items.push(n((0,U.__assign)((0,U.__assign)({},e),{index:t}),r._onRenderItem)),o.items.length>0&&s();break;default:o.items.push(n((0,U.__assign)((0,U.__assign)({},e),{index:t}),r._onRenderItem))}}(e,t)})),o.items.length>0&&s(),b.createElement(b.Fragment,null,i)},r._onRenderItem=function(e){switch(e.itemType){case L.Divider:return r._renderSeparator(e);case L.Header:return r._renderHeader(e);default:return r._renderOption(e)}},r._renderOption=function(e){var t,n=r.props,o=n.onRenderOption,i=void 0===o?r._onRenderOption:o,s=n.hoisted.selectedIndices,a=void 0===s?[]:s,l=!(void 0===e.index||!a)&&a.indexOf(e.index)>-1,c=e.hidden?r._classNames.dropdownItemHidden:l&&!0===e.disabled?r._classNames.dropdownItemSelectedAndDisabled:l?r._classNames.dropdownItemSelected:!0===e.disabled?r._classNames.dropdownItemDisabled:r._classNames.dropdownItem,d=e.title,p=r._listId+e.index,u=null!==(t=e.id)&&void 0!==t?t:p+"-label",h=r._classNames.subComponentStyles?r._classNames.subComponentStyles.multiSelectItem:void 0;return r.props.multiSelect?b.createElement(xt,{id:p,key:e.key,disabled:e.disabled,onChange:r._onItemClick(e),inputProps:(0,U.__assign)({"aria-selected":l,onMouseEnter:r._onItemMouseEnter.bind(r,e),onMouseLeave:r._onMouseItemLeave.bind(r,e),onMouseMove:r._onItemMouseMove.bind(r,e),role:"option"},{"data-index":e.index,"data-is-focusable":!(e.disabled||e.hidden)}),label:e.text,title:d,onRenderLabel:r._onRenderItemLabel.bind(r,(0,U.__assign)((0,U.__assign)({},e),{id:u})),className:(0,$.A)(c,"is-multi-select"),checked:l,styles:h,ariaPositionInSet:e.hidden?void 0:r._sizePosCache.positionInSet(e.index),ariaSetSize:e.hidden?void 0:r._sizePosCache.optionSetSize,ariaLabel:e.ariaLabel,ariaLabelledBy:e.ariaLabel?void 0:u}):b.createElement(he,{id:p,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,className:c,onClick:r._onItemClick(e),onMouseEnter:r._onItemMouseEnter.bind(r,e),onMouseLeave:r._onMouseItemLeave.bind(r,e),onMouseMove:r._onItemMouseMove.bind(r,e),role:"option","aria-selected":l?"true":"false",ariaLabel:e.ariaLabel,title:d,"aria-posinset":r._sizePosCache.positionInSet(e.index),"aria-setsize":r._sizePosCache.optionSetSize},i(e,r._onRenderOption))},r._onRenderOption=function(e){return b.createElement("span",{className:r._classNames.dropdownOptionText},e.text)},r._onRenderMultiselectOption=function(e){return b.createElement("span",{id:e.id,"aria-hidden":"true",className:r._classNames.dropdownOptionText},e.text)},r._onRenderItemLabel=function(e){var t=r.props.onRenderOption;return(void 0===t?r._onRenderMultiselectOption:t)(e,r._onRenderMultiselectOption)},r._onPositioned=function(e){r._focusZone.current&&r._requestAnimationFrame((function(){var e=r.props.hoisted.selectedIndices;if(r._focusZone.current)if(!r._hasBeenPositioned&&e&&e[0]&&!r.props.options[e[0]].disabled){var t=(0,j.Y)().getElementById("".concat(r._id,"-list").concat(e[0]));t&&r._focusZone.current.focusElement(t),r._hasBeenPositioned=!0}else r._focusZone.current.focus()})),r.state.calloutRenderEdge&&r.state.calloutRenderEdge===e.targetEdge||r.setState({calloutRenderEdge:e.targetEdge})},r._onItemClick=function(e){return function(t){e.disabled||(r.setSelectedIndex(t,e.index),r.props.multiSelect||r.setState({isOpen:!1}))}},r._onScroll=function(){var e=(0,Oe.k_)(r.context);r._isScrollIdle||void 0===r._scrollIdleTimeoutId?r._isScrollIdle=!1:(e.clearTimeout(r._scrollIdleTimeoutId),r._scrollIdleTimeoutId=void 0),r._scrollIdleTimeoutId=e.setTimeout((function(){r._isScrollIdle=!0}),r._scrollIdleDelay)},r._onMouseItemLeave=function(e,t){if(!r._shouldIgnoreMouseEvent()&&r._host.current)if(r._host.current.setActive)try{r._host.current.setActive()}catch(e){}else r._host.current.focus()},r._onDismiss=function(){r.setState({isOpen:!1})},r._onDropdownBlur=function(e){r._isDisabled()||r.state.isOpen||(r.setState({hasFocus:!1}),r.props.onBlur&&r.props.onBlur(e))},r._onDropdownKeyDown=function(e){if(!r._isDisabled()&&(r._lastKeyDownWasAltOrMeta=r._isAltOrMeta(e),!r.props.onKeyDown||(r.props.onKeyDown(e),!e.defaultPrevented))){var t,n=r.props.hoisted.selectedIndices.length?r.props.hoisted.selectedIndices[0]:-1,o=e.altKey||e.metaKey,i=r.state.isOpen;switch(e.which){case V.c.enter:r.setState({isOpen:!i});break;case V.c.escape:if(!i)return;r.setState({isOpen:!1});break;case V.c.up:if(o){if(i){r.setState({isOpen:!1});break}return}r.props.multiSelect?r.setState({isOpen:!0}):r._isDisabled()||(t=r._moveIndex(e,-1,n-1,n));break;case V.c.down:o&&(e.stopPropagation(),e.preventDefault()),o&&!i||r.props.multiSelect?r.setState({isOpen:!0}):r._isDisabled()||(t=r._moveIndex(e,1,n+1,n));break;case V.c.home:r.props.multiSelect||(t=r._moveIndex(e,1,0,n));break;case V.c.end:r.props.multiSelect||(t=r._moveIndex(e,-1,r.props.options.length-1,n));break;case V.c.space:break;default:return}t!==n&&(e.stopPropagation(),e.preventDefault())}},r._onDropdownKeyUp=function(e){if(!r._isDisabled()){var t=r._shouldHandleKeyUp(e),n=r.state.isOpen;r.props.onKeyUp&&(r.props.onKeyUp(e),e.defaultPrevented)||(e.which===V.c.space?(r.setState({isOpen:!n}),e.stopPropagation(),e.preventDefault()):t&&n&&r.setState({isOpen:!1}))}},r._onZoneKeyDown=function(e){var t,n,o;r._lastKeyDownWasAltOrMeta=r._isAltOrMeta(e);var i=e.altKey||e.metaKey;switch(e.which){case V.c.up:i?r.setState({isOpen:!1}):r._host.current&&(o=(0,Z.dm)(r._host.current,r._host.current.lastChild,!0));break;case V.c.home:case V.c.end:case V.c.pageUp:case V.c.pageDown:break;case V.c.down:!i&&r._host.current&&(o=(0,Z.j5)(r._host.current,r._host.current.firstChild,!0));break;case V.c.escape:r.setState({isOpen:!1});break;case V.c.tab:r.setState({isOpen:!1});var s=(0,j.Y)();s&&(e.shiftKey?null===(t=(0,Z.yv)(s.body,r._dropDown.current,!1,!1,!0,!0))||void 0===t||t.focus():null===(n=(0,Z.eX)(s.body,r._dropDown.current,!1,!1,!0,!0))||void 0===n||n.focus());break;default:return}o&&o.focus(),e.stopPropagation(),e.preventDefault()},r._onZoneKeyUp=function(e){r._shouldHandleKeyUp(e)&&r.state.isOpen&&(r.setState({isOpen:!1}),e.preventDefault())},r._onDropdownClick=function(e){if(!r.props.onClick||(r.props.onClick(e),!e.defaultPrevented)){var t=r.state.isOpen;r._isDisabled()||r._shouldOpenOnFocus()||r.setState({isOpen:!t}),r._isFocusedByClick=!1}},r._onDropdownMouseDown=function(){r._isFocusedByClick=!0},r._onFocus=function(e){if(!r._isDisabled()){r.props.onFocus&&r.props.onFocus(e);var t={hasFocus:!0};r._shouldOpenOnFocus()&&(t.isOpen=!0),r.setState(t)}},r._isDisabled=function(){var e=r.props.disabled,t=r.props.isDisabled;return void 0===e&&(e=t),e},r._onRenderLabel=function(e){var t=e.label,n=e.required,o=e.disabled,i=r._classNames.subComponentStyles?r._classNames.subComponentStyles.label:void 0;return t?b.createElement(ve.J,{className:r._classNames.label,id:r._labelId,required:n,styles:i,disabled:o},t):null},(0,J.f)(r);t.multiSelect,t.selectedKey,t.selectedKeys,t.defaultSelectedKey,t.defaultSelectedKeys;var i=t.options;return r._id=t.id||(0,Y.O)("Dropdown"),r._labelId=r._id+"-label",r._listId=r._id+"-list",r._optionId=r._id+"-option",r._isScrollIdle=!0,r._hasBeenPositioned=!1,r._sizePosCache.updateOptions(i),r.state={isOpen:!1,hasFocus:!1,calloutRenderEdge:void 0},r}return(0,U.__extends)(t,e),Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.props;return dt(e.options,e.hoisted.selectedIndices)},enumerable:!1,configurable:!0}),t.prototype.componentWillUnmount=function(){clearTimeout(this._scrollIdleTimeoutId)},t.prototype.componentDidUpdate=function(e,t){!0===t.isOpen&&!1===this.state.isOpen&&(this._gotMouseMove=!1,this._hasBeenPositioned=!1,this.props.onDismiss&&this.props.onDismiss())},t.prototype.render=function(){var e=this._id,t=this.props,n=t.className,o=t.label,r=t.options,i=t.ariaLabel,s=t.required,a=t.errorMessage,l=t.styles,c=t.theme,d=t.panelProps,p=t.calloutProps,u=t.onRenderTitle,h=void 0===u?this._getTitle:u,m=t.onRenderContainer,g=void 0===m?this._onRenderContainer:m,f=t.onRenderCaretDown,y=void 0===f?this._onRenderCaretDown:f,v=t.onRenderLabel,C=void 0===v?this._onRenderLabel:v,_=t.onRenderItem,x=void 0===_?this._onRenderItem:_,k=t.hoisted.selectedIndices,S=this.state,E=S.isOpen,P=S.calloutRenderEdge,w=S.hasFocus,I=t.onRenderPlaceholder||t.onRenderPlaceHolder||this._getPlaceholder;r!==this._sizePosCache.cachedOptions&&this._sizePosCache.updateOptions(r);var T=dt(r,k),R=(0,X.G1)(t,X.JM),D=this._isDisabled(),N=e+"-errorMessage";this._classNames=Et(l,{theme:c,className:n,hasError:!!(a&&a.length>0),hasLabel:!!o,isOpen:E,required:s,disabled:D,isRenderingPlaceholder:!T.length,panelClassName:d?d.className:void 0,calloutClassName:p?p.className:void 0,calloutRenderEdge:P});var O=!!a&&a.length>0;return b.createElement("div",{className:this._classNames.root,ref:this.props.hoisted.rootRef,"aria-owns":E?this._listId:void 0},C(this.props,this._onRenderLabel),b.createElement("div",(0,U.__assign)({"data-is-focusable":!D,"data-ktp-target":!0,ref:this._dropDown,id:e,tabIndex:D?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":E?"true":"false","aria-label":i,"aria-labelledby":o&&!i?(0,ee._)(this._labelId,this._optionId):void 0,"aria-describedby":O?this._id+"-errorMessage":void 0,"aria-required":s,"aria-disabled":D,"aria-invalid":O,"aria-controls":E?this._listId:void 0},R,{className:this._classNames.dropdown,onBlur:this._onDropdownBlur,onKeyDown:this._onDropdownKeyDown,onKeyUp:this._onDropdownKeyUp,onClick:this._onDropdownClick,onMouseDown:this._onDropdownMouseDown,onFocus:this._onFocus}),b.createElement("span",{id:this._optionId,className:this._classNames.title,"aria-live":w?"polite":void 0,"aria-atomic":!!w||void 0},T.length?h(T,this._onRenderTitle):I(t,this._onRenderPlaceholder)),b.createElement("span",{className:this._classNames.caretDownWrapper},y(t,this._onRenderCaretDown))),E&&g((0,U.__assign)((0,U.__assign)({},t),{onDismiss:this._onDismiss,onRenderItem:x}),this._onRenderContainer),O&&b.createElement("div",{role:"alert",id:N,className:this._classNames.errorMessage},a))},t.prototype.focus=function(e){this._dropDown.current&&(this._dropDown.current.focus(),e&&this.setState({isOpen:!0}))},t.prototype.setSelectedIndex=function(e,t){var n=this.props,o=n.options,r=n.selectedKey,i=n.selectedKeys,s=n.multiSelect,a=n.notifyOnReselect,l=n.hoisted.selectedIndices,c=void 0===l?[]:l,d=!!c&&c.indexOf(t)>-1,p=[];if(t=Math.max(0,Math.min(o.length-1,t)),void 0===r&&void 0===i){if(s||a||t!==c[0]){if(s)if(p=c?this._copyArray(c):[],d){var u=p.indexOf(t);u>-1&&p.splice(u,1)}else p.push(t);else p=[t];e.persist(),this.props.hoisted.setSelectedIndices(p),this._onChange(e,o,t,d,s)}}else this._onChange(e,o,t,d,s)},t.prototype._copyArray=function(e){for(var t=[],n=0,o=e;n<o.length;n++){var r=o[n];t.push(r)}return t},t.prototype._moveIndex=function(e,t,n,o){var r=this.props.options;if(o===n||0===r.length)return o;n>=r.length?n=0:n<0&&(n=r.length-1);for(var i=0;r[n].itemType===L.Header||r[n].itemType===L.Divider||r[n].disabled;){if(i>=r.length)return o;n+t<0?n=r.length:n+t>=r.length&&(n=-1),n+=t,i++}return this.setSelectedIndex(e,n),n},t.prototype._renderFocusableList=function(e){var t=e.onRenderList,n=void 0===t?this._onRenderList:t,o=e.label,r=e.ariaLabel,i=e.multiSelect;return b.createElement("div",{className:this._classNames.dropdownItemsWrapper,onKeyDown:this._onZoneKeyDown,onKeyUp:this._onZoneKeyUp,ref:this._host,tabIndex:0},b.createElement(fe.R,{ref:this._focusZone,direction:ye.E.vertical,id:this._listId,className:this._classNames.dropdownItems,role:"listbox","aria-label":r,"aria-labelledby":o&&!r?this._labelId:void 0,"aria-multiselectable":i},n(e,this._onRenderList)))},t.prototype._renderSeparator=function(e){var t=e.index,n=e.key,o=e.hidden?this._classNames.dropdownDividerHidden:this._classNames.dropdownDivider;return t>0?b.createElement("div",{role:"presentation",key:n,className:o}):null},t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,n=void 0===t?this._onRenderOption:t,o=e.key,r=e.id,i=e.hidden?this._classNames.dropdownItemHeaderHidden:this._classNames.dropdownItemHeader;return b.createElement("div",{id:r,key:o,className:i},n(e,this._onRenderOption))},t.prototype._onItemMouseEnter=function(e,t){this._shouldIgnoreMouseEvent()||t.currentTarget.focus()},t.prototype._onItemMouseMove=function(e,t){var n=(0,Oe.LW)(this.context),o=t.currentTarget;this._gotMouseMove=!0,this._isScrollIdle&&n.activeElement!==o&&o.focus()},t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},t.prototype._isAltOrMeta=function(e){return e.which===V.c.alt||"Meta"===e.key},t.prototype._shouldHandleKeyUp=function(e){var t=this._lastKeyDownWasAltOrMeta&&this._isAltOrMeta(e);return this._lastKeyDownWasAltOrMeta=!1,!!t&&!((0,te.c)()||(0,ne.u)())},t.prototype._shouldOpenOnFocus=function(){var e=this.state.hasFocus,t=this.props.openOnKeyboardFocus;return!this._isFocusedByClick&&!0===t&&!e},t.defaultProps={options:[]},t.contextType=Ne._0,t}(b.Component),At=n(376341),Bt={root:"ms-Dropdown-container",label:"ms-Dropdown-label",dropdown:"ms-Dropdown",title:"ms-Dropdown-title",caretDownWrapper:"ms-Dropdown-caretDownWrapper",caretDown:"ms-Dropdown-caretDown",callout:"ms-Dropdown-callout",panel:"ms-Dropdown-panel",dropdownItems:"ms-Dropdown-items",dropdownItem:"ms-Dropdown-item",dropdownDivider:"ms-Dropdown-divider",dropdownOptionText:"ms-Dropdown-optionText",dropdownItemHeader:"ms-Dropdown-header",titleIsPlaceHolder:"ms-Dropdown-titleIsPlaceHolder",titleHasError:"ms-Dropdown-title--hasError"},Mt=((It={})["".concat(le.up,", ").concat(le.hT.replace("@media ",""))]=(0,U.__assign)({},(0,le.Qg)()),It),Ft={selectors:(0,U.__assign)((Tt={},Tt[le.up]=(Rt={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},Rt[".".concat(yt.Y2," &:focus:after")]={borderColor:"HighlightText"},Rt),Tt[".ms-Checkbox-checkbox"]=(Dt={},Dt[le.up]={borderColor:"HighlightText"},Dt),Tt),Mt)},Lt={selectors:(Nt={},Nt[le.up]={borderColor:"Highlight"},Nt)},Ht=(0,le.L6)(0,le.O7),Wt=(0,G.I)(wt,(function(e){var t,n,o,r,i,s,a,l,c,d,p,u,h=e.theme,m=e.hasError,g=e.hasLabel,f=e.className,y=e.isOpen,b=e.disabled,v=e.required,C=e.isRenderingPlaceholder,_=e.panelClassName,x=e.calloutClassName,k=e.calloutRenderEdge;if(!h)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var S=(0,le.Km)(Bt,h),E=h.palette,P=h.semanticColors,w=h.effects,I=h.fonts,T={color:P.menuItemTextHovered},R={color:P.menuItemText},D={borderColor:P.errorText},N=[S.dropdownItem,{backgroundColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:"flex",alignItems:"center",padding:"0 8px",width:"100%",minHeight:36,lineHeight:20,height:0,position:"relative",border:"1px solid transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",".ms-Button-flexContainer":{width:"100%"}}],O=[S.dropdownItemHeader,(0,U.__assign)((0,U.__assign)({},I.medium),{fontWeight:le.BO.semibold,color:P.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(t={},t[le.up]=(0,U.__assign)({color:"GrayText"},(0,le.Qg)()),t)})],A=P.menuItemBackgroundPressed,B=function(e){var t,n;return void 0===e&&(e=!1),{selectors:(t={"&:hover":[{color:P.menuItemTextHovered,backgroundColor:e?A:P.menuItemBackgroundHovered},Ft],"&.is-multi-select:hover":[{backgroundColor:e?A:"transparent"},Ft],"&:active:hover":[{color:P.menuItemTextHovered,backgroundColor:e?P.menuItemBackgroundHovered:P.menuItemBackgroundPressed},Ft]},t[".".concat(yt.Y2," &:focus:after, :host(.").concat(yt.Y2,") &:focus:after")]=(n={left:0,top:0,bottom:0,right:0},n[le.up]={inset:"2px"},n),t[le.up]={border:"none"},t)}},M=(0,U.__spreadArray)((0,U.__spreadArray)([],N,!0),[{backgroundColor:A,color:P.menuItemTextHovered},B(!0),Ft],!1),F=(0,U.__spreadArray)((0,U.__spreadArray)([],N,!0),[{color:P.disabledText,cursor:"default",selectors:(n={},n[le.up]={color:"GrayText",border:"none"},n)}],!1),L=k===At.x.bottom?"".concat(w.roundedCorner2," ").concat(w.roundedCorner2," 0 0"):"0 0 ".concat(w.roundedCorner2," ").concat(w.roundedCorner2),H=k===At.x.bottom?"0 0 ".concat(w.roundedCorner2," ").concat(w.roundedCorner2):"".concat(w.roundedCorner2," ").concat(w.roundedCorner2," 0 0");return{root:[S.root,f],label:S.label,dropdown:[S.dropdown,le.S8,I.medium,{color:P.menuItemText,borderColor:P.focusBorder,position:"relative",outline:0,userSelect:"none",selectors:(o={},o["&:hover ."+S.title]=[!b&&T,{borderColor:y?E.neutralSecondary:E.neutralPrimary},Lt],o["&:focus ."+S.title]=[!b&&T,{selectors:(r={},r[le.up]={color:"Highlight"},r)}],o["&:focus:after"]=[{pointerEvents:"none",content:"''",position:"absolute",boxSizing:"border-box",top:"0px",left:"0px",width:"100%",height:"100%",border:b?"none":"2px solid ".concat(E.themePrimary),borderRadius:"2px",selectors:(i={},i[le.up]={color:"Highlight"},i)}],o["&:active ."+S.title]=[!b&&T,{borderColor:E.themePrimary},Lt],o["&:hover ."+S.caretDown]=!b&&R,o["&:focus ."+S.caretDown]=[!b&&R,{selectors:(s={},s[le.up]={color:"Highlight"},s)}],o["&:active ."+S.caretDown]=!b&&R,o["&:hover ."+S.titleIsPlaceHolder]=!b&&R,o["&:focus ."+S.titleIsPlaceHolder]=!b&&R,o["&:active ."+S.titleIsPlaceHolder]=!b&&R,o["&:hover ."+S.titleHasError]=D,o["&:active ."+S.titleHasError]=D,o)},y&&"is-open",b&&"is-disabled",v&&"is-required",v&&!g&&{selectors:(a={":before":{content:"'*'",color:P.errorText,position:"absolute",top:-5,right:-10}},a[le.up]={selectors:{":after":{right:-14}}},a)}],title:[S.title,le.S8,{backgroundColor:P.inputBackground,borderWidth:1,borderStyle:"solid",borderColor:P.inputBorder,borderRadius:y?L:w.roundedCorner2,cursor:"pointer",display:"block",height:32,lineHeight:30,padding:"0 28px 0 8px",position:"relative",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},C&&[S.titleIsPlaceHolder,{color:P.inputPlaceholderText}],m&&[S.titleHasError,D],b&&{backgroundColor:P.disabledBackground,border:"none",color:P.disabledText,cursor:"default",selectors:(l={},l[le.up]=(0,U.__assign)({border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},(0,le.Qg)()),l)}],caretDownWrapper:[S.caretDownWrapper,{height:32,lineHeight:30,paddingTop:1,position:"absolute",right:8,top:0},!b&&{cursor:"pointer"}],caretDown:[S.caretDown,{color:E.neutralSecondary,fontSize:I.small.fontSize,pointerEvents:"none"},b&&{color:P.disabledText,selectors:(c={},c[le.up]=(0,U.__assign)({color:"GrayText"},(0,le.Qg)()),c)}],errorMessage:(0,U.__assign)((0,U.__assign)({color:P.errorText},h.fonts.small),{paddingTop:5}),callout:[S.callout,{boxShadow:w.elevation8,borderRadius:H,selectors:(d={},d[".ms-Callout-main"]={borderRadius:H},d)},x],dropdownItemsWrapper:{selectors:{"&:focus":{outline:0}}},dropdownItems:[S.dropdownItems,{display:"block"}],dropdownItem:(0,U.__spreadArray)((0,U.__spreadArray)([],N,!0),[B()],!1),dropdownItemSelected:M,dropdownItemDisabled:F,dropdownItemSelectedAndDisabled:[M,F,{backgroundColor:"transparent"}],dropdownItemHidden:(0,U.__spreadArray)((0,U.__spreadArray)([],N,!0),[{display:"none"}],!1),dropdownDivider:[S.dropdownDivider,{height:1,backgroundColor:P.bodyDivider}],dropdownDividerHidden:[S.dropdownDivider,{display:"none"}],dropdownOptionText:[S.dropdownOptionText,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:0,maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",margin:"1px"}],dropdownItemHeader:O,dropdownItemHeaderHidden:(0,U.__spreadArray)((0,U.__spreadArray)([],O,!0),[{display:"none"}],!1),subComponentStyles:{label:{root:{display:"inline-block"}},multiSelectItem:{root:{padding:0},label:{alignSelf:"stretch",padding:"0 8px",width:"100%"},input:{selectors:(p={},p[".".concat(yt.Y2," &:focus + label::before, :host(.").concat(yt.Y2,") &:focus + label::before")]={outlineOffset:"0px"},p)}},panel:{root:[_],main:{selectors:(u={},u[Ht]={width:272},u)},contentInner:{padding:"0 0 20px"}}}}}),void 0,{scope:"Dropdown"});Wt.displayName="Dropdown";var zt=n(585498),Gt=n(483076),Ut=n(198383),Qt=n(676823),qt=n(850576),Kt=n(824533),$t=n(921705),jt=n(950272),Vt=n(614918),Zt=n(758651);const Jt=[W.ck.File,W.ck.Event,W.ck.Message],Yt={settings:{hostAppId:"Word_Online",hostAppName:"Word",hostAppPlatform:"Web",hostAppScenario:"AppChatCopilot",hostDefaultLocale:"en-US",isDogfoodEnvironment:!0,appVersion:"1.0.0",customizedEmptyECCSuggestionsString:"I can't find that file right now. Check the name of the file, or try again in a bit."},telemLogger:{logError:e=>{Zt.log("CIQ Error Log: ",e)}},transformFileMenuTitle:"Suggestions",transformFilePlaceholderText:"Keep typing to search for your files",entitiesSupported:Jt,isExpandedECCEnabled:!0,ciqPlaceholderText:"Start Typing to search",featureFlags:{enableAppGptsInCiq:!0,enableAppPluginsInCiq:!0,enableTopicECC:!0}},Xt={headerText:"Workspace",descriptionText:"Upload Files to Ground and Interact",freImagePath:n(995163),hideGetStartedButton:!1,getStartedButtonText:"Upload Demo Files"},en=()=>{const e={...jt.Xt};return e.list=[],e.headerDescription="",e.addAnotherEntityProps&&e.addAnotherEntityProps.editorConfiguration&&(e.addAnotherEntityProps.editorConfiguration.entitiesEnabled=Jt),e},tn="Create a Synopsis of the Selected Files",nn="Add Synopsis to the Document",on="What are the key points from the meeting and who participated in it?",rn="Create a table using the data in the .xls",sn="Select the Table in the Word Document and Click here to bring it to chat",an="Select the Excel File and deselect rest",ln="Go to the end of the document. Use the insert button to add the chart",cn='Select one or more Word or PowerPoint files and type "Summarize"',dn="Ask Copilot to Regenerate a Longer Summary by clicking the icon next to the Insert button in the Response Card",pn="Pin the longer summary for later use by clicking the Pin icon in the Response Card",un="Explore Questions to Ask by clicking the Light Bulb icon",hn="Demo Mode: ",mn=[{name:tn,isALSignalRequired:!0},{name:nn,isALSignalRequired:!1},{name:on,isALSignalRequired:!0},{name:an,isALSignalRequired:!1},{name:rn,isALSignalRequired:!0},{name:"Convert this table to a chart",isALSignalRequired:!0},{name:ln,isALSignalRequired:!1},{name:cn,isALSignalRequired:!1},{name:dn,isALSignalRequired:!1},{name:pn,isALSignalRequired:!1},{name:sn,isALSignalRequired:!0},{name:un,isALSignalRequired:!1},{name:"END OF DEMO. Please continue to use Copilot Workspace",isALSignalRequired:!1}],gn=[{key:"Shorter",value:"Make it shorter"},{key:"Longer",value:"Make it longer"},{key:"Simpler",value:"Make it simpler"},{key:"Casual",value:"Make it casual"},{key:"Professional",value:"Make it professional"},{key:"Rewrite Content",value:""}],fn=[{key:"generateSummary",value:"Generate Summary"},{key:"generateTable",value:"Generate Table"},{key:"rewriteContent",value:"Rewrite Content"},{key:"generateChartVisualisation",value:"Generate Data Visualization Chart"}],yn=["https://microsoft-my.sharepoint-df.com/:u:/p/sanjibb/EfzcGItZCnJGvGsONGv2ONEBdjaFVDNpyGq31UMsQ6QFMg?e=ilHwGW","https://microsoft-my.sharepoint-df.com/:u:/p/sanjibb/EUOL4IVChQhJlJQztaeyob0B-jELHpXYVFfjh4lOsG4Ubg?e=pj4d5k","https://microsoft-my.sharepoint-df.com/:x:/p/sanjibb/ERMy4YzILZVJvvDmPiI2dVsBSqoR0CJb60d5He9bFficXQ?e=yTQR0d","https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EQsn2KTmyWZOn_aX1q2DC_YBRuFVeBZsmymDajU92o12cA?e=u4L8XS","https://microsoft-my.sharepoint-df.com/:p:/p/sanjibb/EbgJpYyyNW1KquSQ6_nqxOYBdE0FtUK_AQHIAcmSNFcNig?e=6QWJC5","https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EeQ0GcBCnxtPmsO1ERm7szABLt3-fdFdX0ykbwqLU-k9gA?e=hKualA","https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EU-V6hSBkaJGl3zlg1pZv3gBX1-PMpJE_4NQWFu23K4NZQ?e=vmgeeI"],bn=[{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:u:/p/sanjibb/EfzcGItZCnJGvGsONGv2ONEBdjaFVDNpyGq31UMsQ6QFMg?e=ilHwGW",text:"Strategic Focus on Mobile.eml",id:"1",iconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/outlook_24x1.svg"},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:t:/p/sanjibb/EX7JRovo7o5PpHstG8AOhjIBUXgLZnZ_vYMmHwosIbQarg?e=KwaZwh",text:"Mobile Revolution 2010 Meeting",id:"2",iconUrl:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/brand-icons/product/svg/teams_24x1.svg"},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:x:/p/sanjibb/ERMy4YzILZVJvvDmPiI2dVsBSqoR0CJb60d5He9bFficXQ?e=yTQR0d",text:"Mobile Market share.xlsx",id:"3",iconUrl:Vt.GB.get("xlsx")||""},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EQsn2KTmyWZOn_aX1q2DC_YBRuFVeBZsmymDajU92o12cA?e=u4L8XS",text:"The Introduction to Mobile.docx",id:"4",iconUrl:Vt.GB.get("docx")||""},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:p:/p/sanjibb/EbgJpYyyNW1KquSQ6_nqxOYBdE0FtUK_AQHIAcmSNFcNig?e=6QWJC5",text:"The Mobile Industry in 2020.ppt",id:"5",iconUrl:Vt.GB.get("pptx")||""},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EeQ0GcBCnxtPmsO1ERm7szABLt3-fdFdX0ykbwqLU-k9gA?e=hKualA",text:"Microsoft's Unfulfilled aspiration",id:"6",iconUrl:Vt.GB.get("docx")||""},{checked:!0,url:"https://microsoft-my.sharepoint-df.com/:w:/p/sanjibb/EU-V6hSBkaJGl3zlg1pZv3gBX1-PMpJE_4NQWFu23K4NZQ?e=vmgeeI",text:"History of Mobile Phones",id:"7",iconUrl:Vt.GB.get("docx")||""}];var vn;!function(e){e.suggestion="suggestion",e.skillName="skillName",e.operations="operations"}(vn||(vn={}));var Cn=n(349827),_n=n(555799),xn=n(243912),kn=n(644275),Sn=n(354311),En=n(784567),Pn=n(962304),wn=n(649377),In=n(148212),Tn=n(387039),Rn=n(567179),Dn=n(934189),Nn=n(641002),On=n(61714),An=n(312272);const Bn=({onSubmit:e})=>{const[t,n]=(0,b.useState)("");return b.createElement("form",{onSubmit:o=>{o.preventDefault(),e(t),n("")}},b.createElement(o.B,null,b.createElement(r.a,null,b.createElement(b.Fragment,null,b.createElement(An.p,{style:{width:"100%",height:"100px"},type:"text",value:t,onChange:e=>n(e.target.value),placeholder:"Enter annotation"}))),b.createElement(r.a,{style:{paddingTop:"20px"}},b.createElement(a.$,{type:"submit"},"Submit"))))};var Mn=n(884134);const Fn=({audioBlob:e})=>{const[t,n]=(0,b.useState)(!1),[o,r]=(0,b.useState)(0),[i,s]=(0,b.useState)(0),a=(0,b.useRef)(null);(0,b.useEffect)((()=>{if(e){const t=URL.createObjectURL(e);return a.current&&(a.current.src=t),()=>URL.revokeObjectURL(t)}}),[e]);const l=e=>{const t=Math.floor(e/60),n=Math.floor(e%60);return`${t}:${n<10?"0":""}${n}`};return b.createElement("div",{style:{width:"300px",padding:"10px",border:"1px solid #ccc",borderRadius:"5px"}},b.createElement("audio",{ref:a,onTimeUpdate:()=>{a.current&&r(a.current.currentTime)},onLoadedMetadata:()=>{a.current&&s(a.current.duration)}}),b.createElement("button",{onClick:()=>{a.current&&(t?a.current.pause():a.current.play(),n(!t))},style:{padding:"5px 10px",marginBottom:"10px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"3px",cursor:"pointer"}},t?"Pause":"Play"),b.createElement("input",{type:"range",min:0,max:i,value:o,onChange:e=>{const t=parseFloat(e.target.value);a.current&&(a.current.currentTime=t),r(t)},style:{width:"100%",marginBottom:"10px"}}),b.createElement("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px"}},b.createElement("span",null,l(o)),b.createElement("span",null,l(i))))},Ln=(0,D.n)({cardStyle:{padding:"1px",borderRadius:"8px",zIndex:999,maxHeight:"80vh",overflowY:"auto"},cardGap:{...N.Pt.gap("8px")},headerStyle:{marginTop:"20px !important"},paddingBottom:{paddingBottom:"12px"},PinCardsStyle:{padding:"12px",backgroundColor:O.L.colorNeutralBackground2},accordionPanelStyle:{paddingBottom:"12px",...N.Pt.gap("8px")},pinnedMessageStyle:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",maxHeight:"3em",lineHeight:"1.5em",whiteSpace:"normal"},showMoreCardStyle:{padding:"4px 8px",borderRadius:"8px",backgroundColor:O.L.colorNeutralBackground2}});n(758651);const Hn=({id:e,content:t,addButtonProps:n,copyButtonProps:v,pinButtonProps:C,aiHelpButtonProps:_,aiSuggestionButtonProps:x,isContentSensitive:k=!1,heading:S,filePickerComponent:E,blobData:P})=>{const w=Ln(),I=e=>b.createElement(i.W,{positioning:"above"},b.createElement(s.c,{disableButtonEnhancement:!0},b.createElement(a.$,{size:"small",appearance:"transparent",icon:e?.buttonIcon??b.createElement(b.Fragment,null,e?.buttonIcon)},e?.buttonText)),b.createElement(l.b,null,b.createElement(c.c,null,b.createElement(d.r,null,b.createElement(p.s,null,b.createElement(u.Q,null,e.headerText)),e?.suggestionList.map((e=>b.createElement(b.Fragment,null,b.createElement(h.c,null),b.createElement(m.D,{onClick:()=>e?.onClick(t,e.content,e.responsetype,e.skillName),icon:e.icon},e.content)))))))),T=new Blob([new Uint8Array(P||[])]);return b.createElement(o.B,{key:e},b.createElement(r.a,null,b.createElement(u.Q,null,S)),P&&b.createElement(Fn,{audioBlob:T}),E&&b.createElement(r.a,null,E),""===t?b.createElement(Mn.y,{label:"Waiting for content..."}):b.createElement(b.Fragment,null,b.createElement(r.a,null,t&&(e=>e.replace(/<table/g,'<table style="width:100%; height: 100%;"'))(t)),b.createElement(o.B,{horizontal:!0,className:w.cardGap},n&&b.createElement(a.$,{size:"small",icon:n.icon??b.createElement(g.m61,null),onClick:()=>n.onClick?.(t),disabled:k},n.text),_&&I(_),v&&b.createElement(a.$,{size:"small",appearance:"transparent",icon:v.icon??b.createElement(f.Qvr,null),onClick:()=>v.onClick?.(t),disabled:k}),C&&b.createElement(a.$,{size:"small",appearance:"transparent",icon:C.icon??b.createElement(y.MtV,null),onClick:()=>C.onClick?.(t,e),disabled:k}),x&&I(x))))};var Wn=n(74443),zn=n(509348),Gn=n(388482),Un=n(241341);const Qn=(0,D.n)({cardStyle:{padding:"1px",borderRadius:"8px",zIndex:999,maxHeight:"80vh",overflowY:"auto"},cardGap:{...N.Pt.gap("8px")},headerStyle:{marginTop:"20px !important"},paddingBottom:{paddingBottom:"12px"},PinCardsStyle:{padding:"12px",backgroundColor:O.L.colorNeutralBackground2},accordionPanelStyle:{paddingBottom:"12px",...N.Pt.gap("8px")},pinnedMessageStyle:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",maxHeight:"3em",lineHeight:"1.5em",whiteSpace:"normal"},showMoreCardStyle:{padding:"4px 8px",borderRadius:"8px",backgroundColor:O.L.colorNeutralBackground2},toggleStyle:{padding:"1px",maxWidth:"100%",overflowX:"auto",...N.Pt.gap("2px"),"&:-ms-overflow-style":"none",scrollbarWidth:"thin","&::-webkit-scrollbar":{display:"none",height:0}}});var qn=n(758651);const Kn=({id:e,content:t,addButtonProps:n,copyButtonProps:v,pinButtonProps:C,aiHelpButtonProps:_,aiSuggestionButtonProps:x,isContentSensitive:k=!1})=>{const S=Qn(),E=e=>b.createElement(i.W,{positioning:"above"},b.createElement(s.c,{disableButtonEnhancement:!0},b.createElement(a.$,{size:"small",appearance:"transparent",icon:e?.buttonIcon??b.createElement(b.Fragment,null,e?.buttonIcon)},e?.buttonText)),b.createElement(l.b,null,b.createElement(c.c,null,b.createElement(d.r,null,b.createElement(p.s,null,b.createElement(u.Q,null,e.headerText)),e?.suggestionList.map((e=>b.createElement(b.Fragment,null,b.createElement(h.c,null),b.createElement(m.D,{onClick:()=>e?.onClick(t,e.content,e.responsetype,e.skillName),icon:e.icon},e.content))))))));return b.createElement(o.B,{key:e},b.createElement(r.a,null,(e=>{const t=e.replace(/<table/g,'<table style="width:100%; height: 100%;"');return(0,Un.Ay)(t)})(t)),b.createElement(o.B,{horizontal:!0,className:S.cardGap},n&&b.createElement(a.$,{size:"small",icon:n.icon??b.createElement(g.m61,null),onClick:()=>n.onClick?.(t),disabled:k},n.text),_&&E(_),v&&b.createElement(a.$,{size:"small",appearance:"transparent",icon:v.icon??b.createElement(f.Qvr,null),onClick:()=>v.onClick?.(t),disabled:k}),C&&b.createElement(a.$,{size:"small",appearance:"transparent",icon:C.icon??b.createElement(y.MtV,null),onClick:()=>C.onClick?.(t,e),disabled:k}),x&&E(x)))},$n=(e,t,n)=>(qn.log("getRegenerateResponseMenuProps shouldSetRewriteSuggestions :",n),t?.push({content:"Generate Audio Summary",onClick:e,icon:b.createElement(Wn.gok,null),responsetype:vn.skillName,skillName:Rn.RS.ORGANIZE_FILES_IN_FOLDER}),{buttonText:"",buttonIcon:b.createElement(zn.mkh,null),headerText:"Regenerate response",suggestionList:n?[{content:"Shorter",onClick:e,icon:b.createElement(Wn.gok,null),responsetype:vn.skillName,skillName:Rn.RS.REWRITE_CONTENT},{content:"Longer",onClick:e,icon:b.createElement(Wn.lQL,null),responsetype:vn.skillName,skillName:Rn.RS.REWRITE_CONTENT},{content:"Simpler",onClick:e,icon:b.createElement(zn.b2m,null),responsetype:vn.skillName,skillName:Rn.RS.REWRITE_CONTENT},{content:"Casual",onClick:e,icon:b.createElement(f.bNJ,null),responsetype:vn.skillName,skillName:Rn.RS.REWRITE_CONTENT},{content:"Professional",onClick:e,icon:b.createElement(f.hDC,null),responsetype:vn.skillName,skillName:Rn.RS.REWRITE_CONTENT},...t||[]]:t||[]}),jn=e=>({buttonText:"",headerText:"Suggested from the Workspace",buttonIcon:b.createElement(Gn.wit,null),suggestionList:e}),Vn=e=>{switch(e){case"generateSummary":return{text:"Generate Summary",icon:b.createElement(f.Mrw,null)};case"generateTable":return{text:"Generate Table",icon:b.createElement(zn.PJ4,null)};default:return{text:"Rewrite Content",icon:b.createElement(f.GvE,null)}}};var Zn,Jn,Yn,Xn=n(758651);!function(e){e.PinnedMessages="PinnedMessages",e.GroundingFiles="GroundingFiles"}(Zn||(Zn={}));class eo{static saveItem(e,t){if(eo.doesIdExist(e,t.id))return void eo.updateItem(e,t);const n=eo.getItems(e);n.push(t),eo.setItems(e,n)}static updateItem(e,t){const n=eo.getItems(e).map((e=>e.id===t.id?t:e));eo.setItems(e,n)}static deleteItem(e,t){const n=eo.getItems(e).filter((e=>e.id!==t));eo.setItems(e,n)}static getItems(e){try{const t=eo.getItem(e);return null===t?[]:JSON.parse(t)}catch(e){return Xn.error("Error getting items from localStorage",e),[]}}static getItemById(e,t){return eo.getItems(e).find((e=>e.id===t))}static getNextAvailableId(e){const t=eo.getItems(e);let n=-1;for(const e of t)e.id>n&&(n=e.id);return n+1}static doesIdExist(e,t){return void 0!==eo.getItemById(e,t)}static getItem(e){try{return localStorage.getItem(e)}catch(e){return Xn.error("Error getting from localStorage",e),null}}static setItems(e,t){try{const n=JSON.stringify(t);localStorage.setItem(e,n)}catch(e){e instanceof DOMException&&"QuotaExceededError"===e.name?Xn.error("Storage quota exceeded"):Xn.error("Error storing to localStorage",e)}}}!function(e){e.OpenAiModel="OpenAiModel",e.FileContentFetchFormat="FileContentFetchFormat",e.CanvasResponseFormat="CanvasResponseFormat"}(Jn||(Jn={})),function(e){e.String="String",e.CipTree="CipTree",e.CipTreeSummary="CipTreeSummary"}(Yn||(Yn={}));class to{static generateId(){return to.operationId++,"CopilotResearch"+to.operationId.toString()}}to.operationId=0;var no=n(282736),oo=n(127373),ro=n(817069),io=n(182573);const so=e=>gn.some((t=>t.key===e)),ao=e=>{const t=fn.find((t=>t.key===e));return t?.value||""},lo=e=>{if(""===e)return"";const t=(e=>JSON.parse(e).listOfSensitiveFiles)(e||""),n=(e=>(JSON.parse(e).listOfFilesWithFailure||[]).map((e=>e?.fileName)))(e||"");let o="";if(t?.length>0){o=`Limited Access. Sensitive files found: ${t.join(", ")}.`}if(n?.length>0){o+=`\nThere is problem in accessing some of the input files. ${n.join(", ")}`}return o};var co,po=n(758651);!function(e){e[e.UnSupported=0]="UnSupported",e[e.PlotlyJson=1]="PlotlyJson",e[e.Html=2]="Html"}(co||(co={}));class uo extends Cn.h{setDemoMode(e){this.isDemoMode=e}constructor(e,t,n,o,r,i,s,a){super(),this.IsArtifactContentEnabledState=!1,this.isCIPQnAEnabledState=!1,this.isStreamingEnabledState=!1,this.IsDemoToggleHidden=!1,this.isDemoMode=!0,this.isNonDemoSuggestionPillShown=!1,this.fileList=[],this.lastCardContent="",this.payloadResponseData="",this.currentPillsIndex=0,this.isAccordionOpen=!0,this.isLoopEnabled=!1,this.hasActiveSignal=!1,this.pinMessageId=eo.getNextAvailableId(Zn.PinnedMessages),this.onEntityChanges=e=>{po.log("Entity Selected called: ",e),this.fileList=[];let t=!1;e.forEach((e=>{e.checked&&(t=t||e.text?.toLocaleLowerCase().endsWith(".xls")||e.text?.toLocaleLowerCase().endsWith(".xlsx"),this.fileList.push(e.url||""))})),po.log("File List: ",this.fileList),this.setEntityPickerProps((t=>({...t,hvcEntityPickerPropsValue:{...t.hvcEntityPickerPropsValue,list:e,openEntityInputPickerOnStartup:!1,addEntityButtonText:"Add Files"}}))),t&&1===this.fileList.length&&(this.expandAccordion(an),this.displayNextSuggestionPills(an)),!1===this.isDemoMode&&this.fileList.length>0&&!this.isNonDemoSuggestionPillShown&&this.setSuggestionsPills([tn])},this.addDemoFiles=()=>{this.fileList=yn,this.setEntityPickerProps((e=>({...e,shouldShowEntityPicker:!0,hvcEntityPickerPropsValue:{...e.hvcEntityPickerPropsValue,list:bn,openEntityInputPickerOnStartup:!1,addEntityButtonText:"Add Files"}})))},this.onArtifactContentStateChanged=e=>{this.IsArtifactContentEnabledState=e},this.onStreamingStateChanged=e=>{this.isStreamingEnabledState=e},this.onFileContentFetchFormatChanged=e=>{this.sendConfigChangeSignal(Jn.FileContentFetchFormat,e),this.updateCIPQnAState(e),po.log("File content fetch format updated to: ",e)},this.getOfficeAIIncubationConfigChangeSignal=(e,t,n)=>{po.log("research config change tile");let o="";switch(t){case Jn.OpenAiModel:o=`{"defaultModelName": "${In.sT[n]}"}`;break;case Jn.FileContentFetchFormat:o=`{"defaultContentFetchFormat": "${n}"}`}return{query:"",queryId:e,fileId:(0,On.A)(),requestType:Rn.d2.SET_CONFIG,userConfig:o}},this.handleGeneratedArtifactResponse=(e,t)=>{po.log("Inside handleGeneratedArtifactResponse");const n=e?.artifactResponse;if(void 0!==e.isFinalChunk&&e.isFinalChunk)return void t.current?.addResponseMessage({chatCardType:_n._.MarkdownCard,chatMessageData:{markDownCardProps:{message:"Added Artifact response to canvas."}},chatMessageBodyData:{feedbackSectionPosition:xn.O.None,shouldShowAIGeneratedIndicator:!1}});if(!n||0!=n?.status)return po.error("Error in response from Incubation workflow in Copilot Chat!"),void t.current?.addResponseMessage({chatCardType:_n._.MarkdownCard,chatMessageData:{markDownCardProps:{message:"Error processing the response from service! Please try again"}},chatMessageBodyData:{feedbackSectionPosition:xn.O.Footer,shouldShowAIGeneratedIndicator:!0}});let o=co.UnSupported;switch(n.artifactsType){case"code/plotlyJson":default:o=co.PlotlyJson;break;case"text/html":o=co.Html}if(n.artifactSummary){const e=n.artifactSummary.trim(),t=F(this.pinMessageId++,e,{text:"Insert",onClick:e=>{this.displayNextSuggestionPills(ln),this.expandAccordion(cn),this.onInsertString&&this.onInsertString(e||"")}},{text:"Copy",onClick:e=>{navigator.clipboard.writeText(e||"")}},{text:"Pin",onClick:this.addPinnedMessageInner},$n(this.submitSuggestionQuery.bind(this),[],!1),jn([]),""!==this.payloadResponseData,!1);this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:t}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0})}if(n.artifactContent&&o===co.PlotlyJson){const e=n.artifactContent.trim(),t=F(this.pinMessageId++,e,{text:"Insert",onClick:e=>{this.displayNextSuggestionPills(ln),this.expandAccordion(cn),this.onInsertString&&this.onInsertString(e||"")}},{text:"Copy",onClick:e=>{navigator.clipboard.writeText(e||"")}},{text:"Pin",onClick:this.addPinnedMessageInner},$n(this.submitSuggestionQuery.bind(this),[],!1),jn([]),""!==this.payloadResponseData,!0,E.PlotlyJson);this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:t}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0})}},this.addPinnedMessageInner=(e,t)=>{this.displayNextSuggestionPills(pn),this.addPinnedMessage?.(e,t),this.copilotChatRef.current?.updateMessage({chatCardType:_n._.ChatCardWrapper,chatMessageBodyData:{messageId:this.pinMessageId.toString()}})},this.handleResponse=e=>{this.validatePodcastResponse(e)},this.alSession=e,this.setEntityPickerProps=t,this.copilotChatRef=n,this.onInsertString=o,this.setSuggestionsPills=r,this.setOnCanvasDataRequested=i,this.setIsDemoToggleShown=s,this.isLoopEnabled=a}cleanup(){uo.instance=void 0}setAddPinnedMessageCallback(e){this.addPinnedMessage=e}getWorkflowsToRegister(){const e=[{workflowAnnotationType:Dn.H6.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0},{workflowAnnotationType:Dn.Vd.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0}];return po.log("Research:: Registered workflows"),e}async shouldSendRequestToAugloop(e,t,n){return this.IsDemoToggleHidden||this.setIsDemoToggleShown(!1),"dbgal"===e?(this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:(o=this.handleResponse,b.createElement(Bn,{onSubmit:o}))}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0}),!1):(!1!==this.isDemoMode||this.isNonDemoSuggestionPillShown||(this.isNonDemoSuggestionPillShown=!0,this.setSuggestionsPills([])),(!this.isDemoMode||!this.fileChecksForDemoMode(e))&&(e!==mn[this.currentPillsIndex].name||mn[this.currentPillsIndex].isALSignalRequired?(e.toLocaleLowerCase().includes("summarize")&&this.expandAccordion(e.toLocaleLowerCase()),e===sn&&(this.copilotChatRef.current?.startLoadingUi(),this.lastCardContent=await this.setOnCanvasDataRequested()),!0):(this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:kn.Q9.Chat,element:mn[this.currentPillsIndex].name===nn?"Synopsis has been added to the document":mn[this.currentPillsIndex].name}},chatMessageBodyData:{...this.getChatMessageBodyProps()}}),this.displayNextSuggestionPills(mn[this.currentPillsIndex].name,!0),e===nn&&this.onInsertString(this.lastCardContent),!1)));var o}expandAccordion(e){if(po.log("DEBUGLOG: expandAccordion isExpanded:",e),e===an||e===cn){if(!this.isAccordionOpen){const e=window.document.getElementById("accordionHeaderResearch");if(e){const t=e.querySelector("button");t&&t.click()}}}else if(this.isAccordionOpen){const e=window.document.getElementById("accordionHeaderResearch");if(e){const t=e.querySelector("button");t&&t.click()}}}updateCIPQnAState(e){this.isCIPQnAEnabledState=e===Yn.CipTreeSummary}getHostSettings(){return{appName:"Testing",appPlatform:"All",devBuild:!0,environment:Sn.D.DEV,sessionId:"",augloopUrl:"https://augloop-dogfood.officeppe.com"}}processFileListFromQueryAnnotations(e,t){const n=[];e?.forEach((e=>{const{name:t,extension:o}=(0,wn.sV)(e.text);po.log("Name: ",t,"Extension: ",o),n.push({checked:!0,url:"",text:e.text,id:e.id,iconUrl:Vt.GB.get(o)||""})})),t?.forEach(((e,t)=>{e.value&&(this.fileList.push(e.value),n[t].url=e.value)})),n.length>0&&this.setEntityPickerProps((e=>({...e,shouldShowEntityPicker:!0,hvcEntityPickerPropsValue:{...e.hvcEntityPickerPropsValue,list:[...e.hvcEntityPickerPropsValue.list,...n],openEntityInputPickerOnStartup:!1,addEntityButtonText:"Add Files"}})))}isArtifactContentEnabled(){return this.IsArtifactContentEnabledState}isCIPQnAEnabled(){return this.isCIPQnAEnabledState}isStreamingEnabled(){return this.isStreamingEnabledState}createSignal(e,t,n=[],o=Rn.v1.MARKDOWN,r=Rn.d2.GENERATE_DATA,i){const s=this.isArtifactContentEnabled()?Rn.RS.GENERATE_ARTIFACT:this.isCIPQnAEnabled()?Rn.RS.USER_QUERY_CIP:i;return po.log("createSignal:called: chatInputType ",i),new Nn.i({query:"",queryId:(0,On.A)(),requestType:this.isArtifactContentEnabled()?Rn.d2.GENERATE_ARTIFACT:r,isStreaming:this.isStreamingEnabled(),clientRequest:{chatInput:e,chatInputType:s,requestPayload:JSON.stringify({canvasContent:t,contentFormat:o,fileUrls:n})}})}sendConfigChangeSignal(e,t){const n=this.getOfficeAIIncubationConfigChangeSignal((0,On.A)(),e,t);po.log("Created tile for config update signal",n),this.copilotChatRef.current?.submitOperation({operation:new En.g0({parentPath:["Signal",Nn.i.getTypeName()],items:[{id:to.generateId(),body:new Nn.i(n)}]}),workflowAnnotationType:Dn.H6.getTypeName()}),this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.Default,chatMessageData:{defaultMessageProps:{user:"human",messageHeader:{text:`Updating config "${e}" to "${t}". Please wait...`}}}}),this.copilotChatRef.current?.startLoadingUi()}getDefaultSignalOperation(e,t,n,o,r){po.log("getDefaultSignalOperation:called: ",this.fileList,e,r);const i=e.replace(/\s+/g,"");let s,a="";for(const e of r??[])a+=e.text.replace(/\s+/g,"");if(po.log("DEBUGLOG: trimmedMessageText:",i),po.log("DEBUGLOG: trimmedAnnotationText:",a),i===a&&(e="Create a synopsis of the files "+e),"summarize"===e.toLocaleLowerCase()&&mn[this.currentPillsIndex].name===cn&&this.displayNextSuggestionPills(mn[this.currentPillsIndex].name),e===mn[this.currentPillsIndex].name&&this.displayNextSuggestionPills(mn[this.currentPillsIndex].name,!0),e==tn&&(po.log("Initial messageText: ",e),e="Create a three page Synopsis and also add a table",po.log("Converted messageText: ",e)),this.hasActiveSignal)s=this.activeSignal,this.hasActiveSignal=!1;else if(this.processFileListFromQueryAnnotations(r||[],o||[]),e===sn)s=this.createSignal(e,this.lastCardContent,[],Rn.v1.HTML,Rn.d2.GENERATE_SUGGESTIONS);else if(e.toLowerCase().includes("generate audio summary"))s=this.createSignal(e,"",this.fileList,Rn.v1.HTML,Rn.d2.PODCAST_CREATION);else{let t=Rn.v1.MARKDOWN;e===rn&&(t=Rn.v1.HTML),s=this.createSignal(e,this.isArtifactContentEnabled()?this.lastCardContent:"",this.fileList,t,Rn.d2.GENERATE_DATA)}const l=["Signal",Nn.i.getTypeName()],c={operation:new En.g0({parentPath:l,items:[{id:to.generateId(),body:s}]}),workflowAnnotationType:Dn.Vd.getTypeName()};return Promise.resolve(c)}displayNextSuggestionPills(e,t=!1){this.isDemoMode&&(this.currentPillsIndex<mn.length-1&&(!e||mn[this.currentPillsIndex].name===e)?this.setSuggestionsPills([mn[++this.currentPillsIndex].name]):t&&this.setSuggestionsPills([]))}displayPreviousSuggestionPills(e,t=!1){this.isDemoMode&&(this.currentPillsIndex>0&&(!e||mn[this.currentPillsIndex].name===e)?this.setSuggestionsPills([mn[--this.currentPillsIndex].name]):t&&this.setSuggestionsPills([]))}submitSuggestionQuery(e,t,n,o){t=t||"";let r="";n===vn.skillName?(so(t)&&(r=(e=>{const t=gn.find((t=>t.key===e));return t?.value||""})(t)),this.activeSignal=this.createSignal(r,e||"",[],Rn.v1.MARKDOWN,Rn.d2.GENERATE_DATA,o)):this.activeSignal=this.createSignal(t,e||"",[],Rn.v1.MARKDOWN,Rn.d2.GENERATE_DATA),this.hasActiveSignal=!0,this.displayNextSuggestionPills(un),"Longer"===t&&this.displayNextSuggestionPills(dn),so(t)?this.copilotChatRef.current?.submitUserQuery({text:""===r?"Rewrite Content":r}):this.copilotChatRef.current?.submitUserQuery({text:""===t?"Rewrite Content":t})}handleSetConfigResponse(){this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:"Successfully updated the configuration. Please proceed."}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0})}sendResponseToClient(e){if(po.log("Item: ",e),e.body?.H_)switch(e.body.H_.T_){case Dn.H6.getTypeName():case Dn.Vd.getTypeName():switch(e.body.responseType){case Rn.d2.GENERATE_ARTIFACT:this.handleGeneratedArtifactResponse(e.body,this.copilotChatRef);break;case Rn.d2.SERVICE_RESPONSE:e.body.requestType==Rn.d2.SET_CONFIG&&this.handleSetConfigResponse();break;case Rn.d2.PODCAST_CREATION:{const t=e.body;po.log("Podcast response received",t);const n=2e6;let o=new Uint8Array([]);const r=t.podcastResponse;if(!r)return void po.log("Podcast response is empty");if(r?.blob&&r.blob.sizeBytes<=n){po.log("Podcast response is within bounds");const e=(r?.blob?.data).data;void 0!==e&&(o=new Uint8Array(e),po.log("speechData ",o," blobData ",e),this.showPodcastCard(o))}else po.log("Podcast response is too large"),this.gotBlobReferences(r.blob);po.log("Speech data blob",o);break}default:{po.log("Received response from OfficeaiIncubationApp workflow in Copilot Chat");const c=e.body,d=c.generatedDataResponse?.response,p=c.generatedDataResponse?.responsePayload,u=c.generatedDataResponse?.status;let h={content:""};try{d&&"string"==typeof d&&d.length>0?h=JSON.parse(d):"object"==typeof d&&null!==d&&(h=d)}catch(e){po.error("Error parsing response:",e)}const m=c.generatedSuggestionsResponse?.generatedSuggestions,g=JSON.parse(m||"{}");if(u===Tn.lC.ErrorInExecution)return this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:"An error occurred while processing your request. Please try again later."}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0}),this.lastCardContent="",void this.displayPreviousSuggestionPills(mn[this.currentPillsIndex].name);po.log("Content: ",h),h?.content&&(c.generatedDataResponse?.chatInput==Rn.RS.GENERATE_DATA_VISUALISATION_CHART?this.lastCardContent='<img src="https://transcriptionserver.blob.core.windows.net/chart/image.png" alt="Chart" width="100%" height="100%">':this.lastCardContent=(e=>{const t=b.createElement(oo.$,{remarkPlugins:[io.A],rehypePlugins:[ro.A],components:{a:({node:e,...t})=>b.createElement("a",{...t,target:"_blank",rel:"noopener noreferrer"})}},e);return no.renderToString(t)})(h?.content),this.payloadResponseData=lo(p||""));const f=g?.follow_up_suggestions,y=[];f?.forEach((e=>{y.push({content:e,onClick:this.submitSuggestionQuery.bind(this),responsetype:vn.suggestion})}));const v=[],C=g?.follow_up_chatInputType;let _=!1;C?.forEach((e=>{"rewriteContent"===e&&(_=!0),v.push({content:ao(e),icon:Vn(e)?.icon||void 0,onClick:this.submitSuggestionQuery.bind(this),responsetype:vn.skillName,skillName:e})}));const x=g?.follow_up_operations;if(x?.forEach((e=>{v.push({content:e||"",icon:Vn(e)?.icon||void 0,onClick:this.submitSuggestionQuery.bind(this),responsetype:vn.operations})})),this.isStreamingEnabled()&&""!==this.lastCardContent&&h.content.length>0||g?.follow_up_suggestions&&""!==this.lastCardContent){let e;this.isLoopEnabled?e=F(this.pinMessageId++,this.lastCardContent,{text:"Insert",onClick:e=>{this.displayNextSuggestionPills(ln),this.expandAccordion(cn),this.onInsertString&&this.onInsertString(e||"")}},{text:"Copy",onClick:e=>{navigator.clipboard.writeText(e||"")}},{text:"Pin",onClick:this.addPinnedMessageInner},$n(this.submitSuggestionQuery.bind(this),v,_),jn(y),""!==this.payloadResponseData,!1):(t=this.pinMessageId++,n=this.lastCardContent,o={text:"Insert",onClick:e=>{this.displayNextSuggestionPills(ln),this.expandAccordion(cn),this.onInsertString&&this.onInsertString(e||"")}},r={text:"Copy",onClick:e=>{navigator.clipboard.writeText(e||"")}},i={text:"Pin",onClick:this.addPinnedMessageInner},s=$n(this.submitSuggestionQuery.bind(this),v,_),a=jn(y),l=""!==this.payloadResponseData,e=b.createElement(Kn,{id:t,content:n,addButtonProps:o,copyButtonProps:r,pinButtonProps:i,aiHelpButtonProps:s,aiSuggestionButtonProps:a,isContentSensitive:l})),this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:e}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0}),""!==this.payloadResponseData&&(this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:this.payloadResponseData}},chatMessageBodyData:{...this.getChatMessageBodyProps()}}),this.payloadResponseData="")}this.expandAccordion(mn[this.currentPillsIndex].name);break}}}var t,n,o,r,i,s,a,l}getChatMessageBodyProps(){return{messageId:"text",feedbackSectionPosition:xn.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:"Commanding Error Card",contextData:{cardMetaData:JSON.stringify({status:"Commanding Error card shown"})}}}}sendEventToClient(e,t){if(e===Pn.PV.CopilotChatLoaded){const e=en(),t=eo.getItems(Zn.GroundingFiles),n=0===t.length;if(!n){const e=t[0].list;e?.map((e=>{e.checked&&this.fileList.push(e.url||"")}))}this.setEntityPickerProps((o=>({...o,shouldShowEntityPicker:!n,hvcEntityPickerPropsValue:{list:n?[]:t[0].list,onEntityChange:this.onEntityChanges,addAnotherEntityProps:{editorConfiguration:e.addAnotherEntityProps?.editorConfiguration,alSession:this.alSession},openEntityInputPickerOnStartup:!1,addEntityButtonText:"Add Files"}})))}}fillEntityPickerProps(e,t){const n=t??en(),o=eo.getItems(Zn.GroundingFiles),r=0===o.length;this.setEntityPickerProps((t=>({...t,shouldShowEntityPicker:e,hvcEntityPickerPropsValue:{list:r?[]:o[0].list,onEntityChange:this.onEntityChanges,addAnotherEntityProps:{editorConfiguration:n.addAnotherEntityProps?.editorConfiguration,alSession:this.alSession},openEntityInputPickerOnStartup:!0,addEntityButtonText:"Add Files"}})))}static getInstance(e,t,n,o,r,i,s,a){return uo.instance||(uo.instance=new uo(e,t,n,o,r,i,s,a)),uo.instance}async getALSession(){return Promise.resolve(this.alSession)}getAuthToken(){return Promise.resolve("")}fileChecksForDemoMode(e){let t="";const n=/summarize/i;switch(e){case tn:0===this.fileList.length&&(t=`${hn}Please select the files to proceed.`);break;case rn:{const e=yn[2];this.fileList.find((t=>t===e))&&1===this.fileList.length||(t=`${hn}Please select the Excel file only to proceed.`);break}case on:{const e=[yn[1],bn[1].url];this.fileList.some((t=>e.includes(t)))||(t=`${hn}Please select the Teams Meeting transcript file to proceed.`);break}default:if(n.test(e)){const e=yn.slice(3,7);this.fileList.some((t=>e.includes(t)))||(t=`${hn}Please select one or more Word or Powerpoint files to proceed.`)}}return""!==t&&(this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:t}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0}),!0)}showPodcastCard(e){var t,n,o,r,i,s,a,l,c,d,p,u;this.copilotChatRef.current?.addResponseMessage({chatCardType:_n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:(t=this.pinMessageId++,n="Generated podcast",o=void 0,r=void 0,i=void 0,s=void 0,a=void 0,l=void 0,c=void 0,d=void 0,p=e,b.createElement(Hn,{id:t,content:n,addButtonProps:o,copyButtonProps:r,pinButtonProps:i,aiHelpButtonProps:s,aiSuggestionButtonProps:a,isContentSensitive:l,heading:c,filePickerComponent:d,blobData:p,blobVal:u}))}},chatMessageBodyData:{...this.getChatMessageBodyProps()},stopLoadingUi:!0})}async gotBlobReferences(e){const t=await this.alSession.requestBinaryDataForBlob(e);this.showPodcastCard(t)}async validatePodcastResponse(e){var t;let n;await(t=5e3,new Promise((e=>setTimeout(e,t))));const o=JSON.parse(e).podcastResponse,r=o.blob.data;if(void 0!==r&&"string"!=typeof r){if(!o)return void po.log("Podcast response is empty");if(o.blob.sizeBytes<=2e6){po.log("Podcast response is within bounds");const e=o.blob.data.data;void 0!==e&&(n=new Uint8Array(e),po.log("speechData ",n," blobData ",e),this.showPodcastCard(n))}else po.log("Podcast response is too large"),this.gotBlobReferences(o.blob);po.log("Speech data blob",n)}}}var ho=n(142411);const mo=(0,D.n)((0,ho.f)({chatFreStack:{height:"calc(100vh - 200px)"},chatUiStack:{top:"20px"}}));var go=n(944113),fo=n(74649);var yo=n(590539),bo=n(486092),vo=n(2203);const Co="fui-CounterBadge",_o="fui-CounterBadge__icon",xo=(0,yo.X)({dot:{Bf4jedk:"fgfkb25",a9b677:"f16dn6v3",Bqenvij:"f3mu39s",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai"},hide:{mc9l5x:"fjseox"}},{d:[".fgfkb25{min-width:auto;}",".f16dn6v3{width:6px;}",".f3mu39s{height:6px;}",[".f1mk8lai{padding:0;}",{p:-1}],".fjseox{display:none;}"]});var ko=n(209459),So=n(181828);const Eo=b.forwardRef(((e,t)=>{const n=((e,t)=>{const{shape:n="circular",appearance:o="filled",showZero:r=!1,overflowCount:i=99,count:s=0,dot:a=!1}=e,l={...(0,fo.c)(e,t),shape:n,appearance:o,showZero:r,count:s,dot:a};return 0===s&&!r||a||l.root.children||(l.root.children=s>i?`${i}+`:`${s}`),l})(e,t);return(e=>{const t=xo();e.root.className=(0,bo.z)(Co,e.dot&&t.dot,!e.root.children&&!e.dot&&t.hide,e.root.className),e.icon&&(e.icon.className=(0,bo.z)(_o,e.icon.className)),(0,vo.o)(e)})(n),(0,ko.$e)("useCounterBadgeStyles_unstable")(n),(0,So.r)(n)}));Eo.displayName="CounterBadge";var Po=n(716381),wo=n(863179),Io=n(428199),To=n(618990),Ro=n(791067),Do=n(758651);const No=({contentList:e,itemCounterText:t,title:n,HeaderIcon:o,handleOnToggle:r})=>{const[i,s]=b.useState(e);b.useEffect((()=>{Do.log("PinnedContent mounted"),s(e)}),[e]);const a=Qn();return 0===i.length?b.createElement(b.Fragment,null):b.createElement(Ro.n,{collapsible:!0,defaultOpenItems:1},b.createElement(Po.Z,{size:"small",className:a.cardStyle},b.createElement(wo.A,{value:1},b.createElement(Io.u,{expandIconPosition:"end",icon:o,expandIcon:b.createElement(go.W,{horizontal:!0,style:a.cardGap},b.createElement(Eo,{appearance:"filled",color:"informative",count:t}),b.createElement(f.yuG,null)),id:"accordionHeaderResearch",onClick:e=>{e.preventDefault(),r()}},n),b.createElement(To.v,null,i.map(((e,t)=>b.createElement(go.W,{key:t,style:a.paddingBottom},e)))))))};var Oo=n(592241);function Ao(){return Ao=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ao.apply(this,arguments)}const Bo=["children","options"],Mo="0",Fo="1",Lo="2",Ho="3",Wo="4",zo="5",Go="6",Uo="7",Qo="8",qo="9",Ko="10",$o="11",jo="12",Vo="13",Zo="14",Jo="15",Yo="16",Xo="17",er="18",tr="19",nr="20",or="21",rr="22",ir="23",sr="24",ar="25",lr="26",cr="27",dr="28",pr="29",ur="30",hr="31",mr="32",gr="33";var fr,yr;(yr=fr||(fr={}))[yr.MAX=0]="MAX",yr[yr.HIGH=1]="HIGH",yr[yr.MED=2]="MED",yr[yr.LOW=3]="LOW",yr[yr.MIN=4]="MIN";const br=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","className","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce(((e,t)=>(e[t.toLowerCase()]=t,e)),{for:"htmlFor"}),vr={amp:"&",apos:"'",gt:">",lt:"<",nbsp:"",quot:""},Cr=["style","script"],_r=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,xr=/mailto:/i,kr=/\n{2,}$/,Sr=/^(\s*>[\s\S]*?)(?=\n{2,})/,Er=/^ *> ?/gm,Pr=/^ {2,}\n/,wr=/^(?:( *[-*_])){3,} *(?:\n *)+\n/,Ir=/^\s*(`{3,}|~{3,}) *(\S+)?([^\n]*?)?\n([\s\S]+?)\s*\1 *(?:\n *)*\n?/,Tr=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,Rr=/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,Dr=/^(?:\n *)*\n/,Nr=/\r\n?/g,Or=/^\[\^([^\]]+)](:(.*)((\n+ {4,}.*)|(\n(?!\[\^).+))*)/,Ar=/^\[\^([^\]]+)]/,Br=/\f/g,Mr=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,Fr=/^\s*?\[(x|\s)\]/,Lr=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,Hr=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,Wr=/^([^\n]+)\n *(=|-){3,} *(?:\n *)+\n/,zr=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?((?:[^>]*[^/])?)>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1\b)[\s\S])*?)<\/\1>(?!<\/\1>)\n*/i,Gr=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,Ur=/^<!--[\s\S]*?(?:-->)/,Qr=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,qr=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,Kr=/^\{.*\}$/,$r=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,jr=/^<([^ >]+@[^ >]+)>/,Vr=/^<([^ >]+:\/[^ >]+)>/,Zr=/-([a-z])?/gi,Jr=/^(.*\|.*)\n(?: *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*))?\n?/,Yr=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,Xr=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,ei=/^\[([^\]]*)\] ?\[([^\]]*)\]/,ti=/(\[|\])/g,ni=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,oi=/\t/g,ri=/(^ *\||\| *$)/g,ii=/^ *:-+: *$/,si=/^ *:-+ *$/,ai=/^ *-+: *$/,li="((?:\\[.*?\\][([].*?[)\\]]|<.*?>(?:.*?<.*?>)?|`.*?`|~~.*?~~|==.*?==|.|\\n)*?)",ci=new RegExp(`^([*_])\\1${li}\\1\\1(?!\\1)`),di=new RegExp(`^([*_])${li}\\1(?!\\1|\\w)`),pi=new RegExp(`^==${li}==`),ui=new RegExp(`^~~${li}~~`),hi=/^\\([^0-9A-Za-z\s])/,mi=/^[\s\S]+?(?=[^0-9A-Z\s\u00c0-\uffff&#;.()'"]|\d+\.|\n\n| {2,}\n|\w+:\S|$)/i,gi=/^\n+/,fi=/^([ \t]*)/,yi=/\\([^\\])/g,bi=/ *\n+$/,vi=/(?:^|\n)( *)$/,Ci="(?:\\d+\\.)",_i="(?:[*+-])";function xi(e){return"( *)("+(1===e?Ci:_i)+") +"}const ki=xi(1),Si=xi(2);function Ei(e){return new RegExp("^"+(1===e?ki:Si))}const Pi=Ei(1),wi=Ei(2);function Ii(e){return new RegExp("^"+(1===e?ki:Si)+"[^\\n]*(?:\\n(?!\\1"+(1===e?Ci:_i)+" )[^\\n]*)*(\\n|$)","gm")}const Ti=Ii(1),Ri=Ii(2);function Di(e){const t=1===e?Ci:_i;return new RegExp("^( *)("+t+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+t+" (?!"+t+" ))\\n*|\\s*\\n*$)")}const Ni=Di(1),Oi=Di(2);function Ai(e,t){const n=1===t,o=n?Ni:Oi,r=n?Ti:Ri,i=n?Pi:wi;return{match(e,t,n){const r=vi.exec(n);return r&&(t.list||!t.inline&&!t.simple)?o.exec(e=r[1]+e):null},order:1,parse(e,t,o){const s=n?+e[2]:void 0,a=e[0].replace(kr,"\n").match(r);let l=!1;return{items:a.map((function(e,n){const r=i.exec(e)[0].length,s=new RegExp("^ {1,"+r+"}","gm"),c=e.replace(s,"").replace(i,""),d=n===a.length-1,p=-1!==c.indexOf("\n\n")||d&&l;l=p;const u=o.inline,h=o.list;let m;o.list=!0,p?(o.inline=!1,m=c.replace(bi,"\n\n")):(o.inline=!0,m=c.replace(bi,""));const g=t(m,o);return o.inline=u,o.list=h,g})),ordered:n,start:s}},render:(t,n,o)=>e(t.ordered?"ol":"ul",{key:o.key,start:t.type===nr?t.start:void 0},t.items.map((function(t,r){return e("li",{key:r},n(t,o))})))}}const Bi=new RegExp("^\\[((?:\\[[^\\]]*\\]|[^\\[\\]]|\\](?=[^\\[]*\\]))*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['\"]([\\s\\S]*?)['\"])?\\s*\\)"),Mi=/^!\[(.*?)\]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/,Fi=[Sr,Ir,Tr,Lr,Wr,Hr,Ur,Jr,Ti,Ni,Ri,Oi],Li=[...Fi,/^[^\n]+(?:  \n|\n{2,})/,zr,qr];function Hi(e){return e.replace(/[]/g,"a").replace(/[]/g,"c").replace(/[]/g,"d").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"n").replace(/[]/g,"o").replace(/[]/g,"u").replace(/[]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function Wi(e){return ai.test(e)?"right":ii.test(e)?"center":si.test(e)?"left":null}function zi(e,t,n,o){const r=n.inTable;n.inTable=!0;let i=e.trim().split(/( *(?:`[^`]*`|<.*?>.*?<\/.*?>(?!<\/.*?>)|\\\||\|) *)/).reduce(((e,r)=>("|"===r.trim()?e.push(o?{type:lr}:{type:cr,text:r}):""!==r&&e.push.apply(e,t(r,n)),e)),[]);n.inTable=r;let s=[[]];return i.forEach((function(e,t){e.type===lr?0!==t&&t!==i.length-1&&s.push([]):(e.type!==cr||null!=i[t+1]&&i[t+1].type!==lr||(e.text=e.text.trimEnd()),s[s.length-1].push(e))})),s}function Gi(e,t,n){n.inline=!0;const o=e[2]?e[2].replace(ri,"").split("|").map(Wi):[],r=e[3]?function(e,t,n){return e.trim().split("\n").map((function(e){return zi(e,t,n,!0)}))}(e[3],t,n):[],i=zi(e[1],t,n,!!r.length);return n.inline=!1,r.length?{align:o,cells:r,header:i,type:ar}:{children:i,type:or}}function Ui(e,t){return null==e.align[t]?{}:{textAlign:e.align[t]}}function Qi(e){return function(t,n){return n.inline?e.exec(t):null}}function qi(e){return function(t,n){return n.inline||n.simple?e.exec(t):null}}function Ki(e){return function(t,n){return n.inline||n.simple?null:e.exec(t)}}function $i(e){return function(t){return e.exec(t)}}function ji(e,t,n){if(t.inline||t.simple)return null;if(n&&!n.endsWith("\n"))return null;let o="";e.split("\n").every((e=>!Fi.some((t=>t.test(e)))&&(o+=e+"\n",e.trim())));const r=o.trimEnd();return""==r?null:[o,r]}function Vi(e){try{if(decodeURIComponent(e).replace(/[^A-Za-z0-9/:]/g,"").match(/^\s*(javascript|vbscript|data(?!:image)):/i))return null}catch(e){return null}return e}function Zi(e){return e.replace(yi,"$1")}function Ji(e,t,n){const o=n.inline||!1,r=n.simple||!1;n.inline=!0,n.simple=!0;const i=e(t,n);return n.inline=o,n.simple=r,i}function Yi(e,t,n){const o=n.inline||!1,r=n.simple||!1;n.inline=!1,n.simple=!0;const i=e(t,n);return n.inline=o,n.simple=r,i}function Xi(e,t,n){const o=n.inline||!1;n.inline=!1;const r=e(t,n);return n.inline=o,r}const es=(e,t,n)=>({children:Ji(t,e[1],n)});function ts(){return{}}function ns(){return null}function os(...e){return e.filter(Boolean).join(" ")}function rs(e,t,n){let o=e;const r=t.split(".");for(;r.length&&(o=o[r[0]],void 0!==o);)r.shift();return o||n}function is(e="",t={}){function n(e,n,...o){const r=rs(t.overrides,`${e}.props`,{});return t.createElement(function(e,t){const n=rs(t,e);return n?"function"==typeof n||"object"==typeof n&&"render"in n?n:rs(t,`${e}.component`,e):e}(e,t.overrides),Ao({},n,r,{className:os(null==n?void 0:n.className,r.className)||void 0}),...o)}function o(e){e=e.replace(Mr,"");let o=!1;t.forceInline?o=!0:t.forceBlock||(o=!1===ni.test(e));const r=c(l(o?e:`${e.trimEnd().replace(gi,"")}\n\n`,{inline:o}));for(;"string"==typeof r[r.length-1]&&!r[r.length-1].trim();)r.pop();if(null===t.wrapper)return r;const i=t.wrapper||(o?"span":"div");let s;if(r.length>1||t.forceWrapper)s=r;else{if(1===r.length)return s=r[0],"string"==typeof s?n("span",{key:"outer"},s):s;s=null}return b.createElement(i,{key:"outer"},s)}function r(e,n){const r=n.match(_r);return r?r.reduce((function(n,r,i){const s=r.indexOf("=");if(-1!==s){const a=function(e){return-1!==e.indexOf("-")&&null===e.match(Qr)&&(e=e.replace(Zr,(function(e,t){return t.toUpperCase()}))),e}(r.slice(0,s)).trim(),l=function(e){const t=e[0];return('"'===t||"'"===t)&&e.length>=2&&e[e.length-1]===t?e.slice(1,-1):e}(r.slice(s+1).trim()),c=br[a]||a,d=n[c]=function(e,t,n,o){return"style"===t?n.split(/;\s?/).reduce((function(e,t){const n=t.slice(0,t.indexOf(":"));return e[n.trim().replace(/(-[a-z])/g,(e=>e[1].toUpperCase()))]=t.slice(n.length+1).trim(),e}),{}):"href"===t||"src"===t?o(n,e,t):(n.match(Kr)&&(n=n.slice(1,n.length-1)),"true"===n||"false"!==n&&n)}(e,a,l,t.sanitizer);"string"==typeof d&&(zr.test(d)||qr.test(d))&&(n[c]=b.cloneElement(o(d.trim()),{key:i}))}else"style"!==r&&(n[br[r]||r]=!0);return n}),{}):null}t.overrides=t.overrides||{},t.sanitizer=t.sanitizer||Vi,t.slugify=t.slugify||Hi,t.namedCodesToUnicode=t.namedCodesToUnicode?Ao({},vr,t.namedCodesToUnicode):vr,t.createElement=t.createElement||b.createElement;const i=[],s={},a={[Mo]:{match:Ki(Sr),order:1,parse:(e,t,n)=>({children:t(e[0].replace(Er,""),n)}),render:(e,t,o)=>n("blockquote",{key:o.key},t(e.children,o))},[Fo]:{match:$i(Pr),order:1,parse:ts,render:(e,t,o)=>n("br",{key:o.key})},[Lo]:{match:Ki(wr),order:1,parse:ts,render:(e,t,o)=>n("hr",{key:o.key})},[Ho]:{match:Ki(Tr),order:0,parse:e=>({lang:void 0,text:e[0].replace(/^ {4}/gm,"").replace(/\n+$/,"")}),render:(e,t,o)=>n("pre",{key:o.key},n("code",Ao({},e.attrs,{className:e.lang?`lang-${e.lang}`:""}),e.text))},[Wo]:{match:Ki(Ir),order:0,parse:e=>({attrs:r("code",e[3]||""),lang:e[2]||void 0,text:e[4],type:Ho})},[zo]:{match:qi(Rr),order:3,parse:e=>({text:e[2]}),render:(e,t,o)=>n("code",{key:o.key},e.text)},[Go]:{match:Ki(Or),order:0,parse:e=>(i.push({footnote:e[2],identifier:e[1]}),{}),render:ns},[Uo]:{match:Qi(Ar),order:1,parse:e=>({target:`#${t.slugify(e[1],Hi)}`,text:e[1]}),render:(e,o,r)=>n("a",{key:r.key,href:t.sanitizer(e.target,"a","href")},n("sup",{key:r.key},e.text))},[Qo]:{match:Qi(Fr),order:1,parse:e=>({completed:"x"===e[1].toLowerCase()}),render:(e,t,o)=>n("input",{checked:e.completed,key:o.key,readOnly:!0,type:"checkbox"})},[qo]:{match:Ki(t.enforceAtxHeadings?Hr:Lr),order:1,parse:(e,n,o)=>({children:Ji(n,e[2],o),id:t.slugify(e[2],Hi),level:e[1].length}),render:(e,t,o)=>n(`h${e.level}`,{id:e.id,key:o.key},t(e.children,o))},[Ko]:{match:Ki(Wr),order:0,parse:(e,t,n)=>({children:Ji(t,e[1],n),level:"="===e[2]?1:2,type:qo})},[$o]:{match:$i(zr),order:1,parse(e,t,n){const[,o]=e[3].match(fi),i=new RegExp(`^${o}`,"gm"),s=e[3].replace(i,""),a=(l=s,Li.some((e=>e.test(l)))?Xi:Ji);var l;const c=e[1].toLowerCase(),d=-1!==Cr.indexOf(c),p=(d?c:e[1]).trim(),u={attrs:r(p,e[2]),noInnerParse:d,tag:p};return n.inAnchor=n.inAnchor||"a"===c,d?u.text=e[3]:u.children=a(t,s,n),n.inAnchor=!1,u},render:(e,t,o)=>n(e.tag,Ao({key:o.key},e.attrs),e.text||t(e.children,o))},[Vo]:{match:$i(qr),order:1,parse(e){const t=e[1].trim();return{attrs:r(t,e[2]||""),tag:t}},render:(e,t,o)=>n(e.tag,Ao({},e.attrs,{key:o.key}))},[jo]:{match:$i(Ur),order:1,parse:()=>({}),render:ns},[Zo]:{match:qi(Mi),order:1,parse:e=>({alt:e[1],target:Zi(e[2]),title:e[3]}),render:(e,o,r)=>n("img",{key:r.key,alt:e.alt||void 0,title:e.title||void 0,src:t.sanitizer(e.target,"img","src")})},[Jo]:{match:Qi(Bi),order:3,parse:(e,t,n)=>({children:Yi(t,e[1],n),target:Zi(e[2]),title:e[3]}),render:(e,o,r)=>n("a",{key:r.key,href:t.sanitizer(e.target,"a","href"),title:e.title},o(e.children,r))},[Yo]:{match:Qi(Vr),order:0,parse:e=>({children:[{text:e[1],type:cr}],target:e[1],type:Jo})},[Xo]:{match:(e,t)=>t.inAnchor?null:Qi($r)(e,t),order:0,parse:e=>({children:[{text:e[1],type:cr}],target:e[1],title:void 0,type:Jo})},[er]:{match:Qi(jr),order:0,parse(e){let t=e[1],n=e[1];return xr.test(n)||(n="mailto:"+n),{children:[{text:t.replace("mailto:",""),type:cr}],target:n,type:Jo}}},[nr]:Ai(n,1),[gr]:Ai(n,2),[tr]:{match:Ki(Dr),order:3,parse:ts,render:()=>"\n"},[or]:{match:ji,order:3,parse:es,render:(e,t,o)=>n("p",{key:o.key},t(e.children,o))},[rr]:{match:Qi(Yr),order:0,parse:e=>(s[e[1]]={target:e[2],title:e[4]},{}),render:ns},[ir]:{match:qi(Xr),order:0,parse:e=>({alt:e[1]||void 0,ref:e[2]}),render:(e,o,r)=>s[e.ref]?n("img",{key:r.key,alt:e.alt,src:t.sanitizer(s[e.ref].target,"img","src"),title:s[e.ref].title}):null},[sr]:{match:Qi(ei),order:0,parse:(e,t,n)=>({children:t(e[1],n),fallbackChildren:t(e[0].replace(ti,"\\$1"),n),ref:e[2]}),render:(e,o,r)=>s[e.ref]?n("a",{key:r.key,href:t.sanitizer(s[e.ref].target,"a","href"),title:s[e.ref].title},o(e.children,r)):n("span",{key:r.key},o(e.fallbackChildren,r))},[ar]:{match:Ki(Jr),order:1,parse:Gi,render(e,t,o){const r=e;return n("table",{key:o.key},n("thead",null,n("tr",null,r.header.map((function(e,i){return n("th",{key:i,style:Ui(r,i)},t(e,o))})))),n("tbody",null,r.cells.map((function(e,i){return n("tr",{key:i},e.map((function(e,i){return n("td",{key:i,style:Ui(r,i)},t(e,o))})))}))))}},[cr]:{match:$i(mi),order:4,parse:e=>({text:e[0].replace(Gr,((e,n)=>t.namedCodesToUnicode[n]?t.namedCodesToUnicode[n]:e))}),render:e=>e.text},[dr]:{match:qi(ci),order:2,parse:(e,t,n)=>({children:t(e[2],n)}),render:(e,t,o)=>n("strong",{key:o.key},t(e.children,o))},[pr]:{match:qi(di),order:3,parse:(e,t,n)=>({children:t(e[2],n)}),render:(e,t,o)=>n("em",{key:o.key},t(e.children,o))},[ur]:{match:qi(hi),order:1,parse:e=>({text:e[1],type:cr})},[hr]:{match:qi(pi),order:3,parse:es,render:(e,t,o)=>n("mark",{key:o.key},t(e.children,o))},[mr]:{match:qi(ui),order:3,parse:es,render:(e,t,o)=>n("del",{key:o.key},t(e.children,o))}};!0===t.disableParsingRawHTML&&(delete a[$o],delete a[Vo]);const l=function(e){let t=Object.keys(e);function n(o,r){let i=[],s="";for(;o;){let a=0;for(;a<t.length;){const l=t[a],c=e[l],d=c.match(o,r,s);if(d){const e=d[0];o=o.substring(e.length);const t=c.parse(d,n,r);null==t.type&&(t.type=l),i.push(t),s=e;break}a++}}return i}return t.sort((function(t,n){let o=e[t].order,r=e[n].order;return o!==r?o-r:t<n?-1:1})),function(e,t){return n(function(e){return e.replace(Nr,"\n").replace(Br,"").replace(oi,"    ")}(e),t)}}(a),c=(d=function(e,t){return function(n,o,r){const i=e[n.type].render;return t?t((()=>i(n,o,r)),n,o,r):i(n,o,r)}}(a,t.renderRule),function e(t,n={}){if(Array.isArray(t)){const o=n.key,r=[];let i=!1;for(let o=0;o<t.length;o++){n.key=o;const s=e(t[o],n),a="string"==typeof s;a&&i?r[r.length-1]+=s:null!==s&&r.push(s),i=a}return n.key=o,r}return d(t,e,n)});var d;const p=o(e);return i.length?n("div",null,p,n("footer",{key:"footer"},i.map((function(e){return n("div",{id:t.slugify(e.identifier,Hi),key:e.identifier},e.identifier,c(l(e.footnote,{inline:!0})))})))):p}const ss=e=>{let{children:t="",options:n}=e,o=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t.indexOf(n=i[o])>=0||(r[n]=e[n]);return r}(e,Bo);return b.cloneElement(is(t,n),o)};var as=n(758651);const ls=({message:e,messageId:t,shouldExpandMessage:n,onMessageExpanded:o,onInsertText:r,removePinnedMessage:i})=>{const s=Qn(),[a,l]=b.useState(n),c=()=>{l(!a),o?.(t||0)};return b.useEffect((()=>{as.log("PinnedMessageUI mounted"),l(n)}),[n]),a?b.createElement(Po.Z,{size:"small",className:s.PinCardsStyle},b.createElement(Kn,{id:t||0,content:e||"",addButtonProps:{text:"Insert",onClick:()=>{as.log("Insert button clicked"),r?.(e||"")},icon:b.createElement(g.m61,null)},...$n((e=>{as.log("Regenerate response clicked, message: ",e)})),copyButtonProps:{text:"Copy",onClick:()=>{as.log("Copy button clicked"),navigator.clipboard.writeText(e||"")},icon:b.createElement(f.Qvr,null)},pinButtonProps:{text:"Pin",onClick:()=>{i(e,t)},icon:b.createElement(y.BMy,{color:"#185ABD"})}})):b.createElement(Po.Z,{size:"small",className:s.showMoreCardStyle},b.createElement("span",{className:s.pinnedMessageStyle},b.createElement(ss,null,e||"")),b.createElement(Oo.N,{onClick:c},"Read more"))};var cs=n(758651);const ds=({alSession:e,onInsertString:t,theme:n,isTestApp:r,isRehydrationEnabled:a,canvasDataProps:d,isDemoMode:p,isZqmEnabled:u=!1,isLoopEnabled:h=!1})=>{const m=b.useRef(null),g=mo(),[v,C]=b.useState({shouldShowEntityPicker:!1,hvcEntityPickerPropsValue:en()}),[_,x]=b.useState([]),[k,S]=b.useState([]),[E,P]=b.useState(p||!1),[w,I]=b.useState(Yn.String),[T,R]=b.useState(!0),D=()=>{G.isAccordionOpen=!G.isAccordionOpen,cs.log("DEBUGLOG: isAccordianOpen",G.isAccordionOpen)},N=e=>t(e);b.useEffect((()=>{a||(localStorage.removeItem(Zn.PinnedMessages),localStorage.removeItem(Zn.GroundingFiles))}),[]);const[O,A]=b.useState(!1);b.useEffect((()=>{if(v.hvcEntityPickerPropsValue.list.length>0){const e={id:9e5,list:v.hvcEntityPickerPropsValue.list||[],shouldShowEntityPicker:v.shouldShowEntityPicker};eo.saveItem(Zn.GroundingFiles,e)}}),[v]);const B=Qn(),M=b.useCallback(((e,t)=>{x((e=>e.filter((e=>e.id!==t)))),void 0!==t&&eo.deleteItem(Zn.PinnedMessages,t)}),[]),F=b.useCallback(((e,t)=>b.createElement(ls,{message:e,messageId:t,onInsertText:e=>{N(e)},removePinnedMessage:(e,t)=>{M(e,t)}})),[N,M]),L=b.useCallback(((e,t)=>{if(_.some((e=>e.id===t)))return;const n={id:t||0,content:F(e,t||0)};x((e=>[...e,n])),eo.saveItem(Zn.PinnedMessages,{id:t||0,content:e||""})}),[F,_]),G=uo.getInstance(e,C,m,N,S,d.onCanvasDataRequested,R,h),[U,Q]=b.useState(!1),[q,K]=b.useState(!1);b.useEffect((()=>()=>{G.cleanup()}),[]),b.useEffect((()=>{G.setAddPinnedMessageCallback(L),G.setDemoMode(E??!1)}),[L,G,E]),b.useEffect((()=>{const e=eo.getItems(Zn.PinnedMessages);if(0===_.length&&e.length>0){const t=e.map((e=>({id:e.id,content:F(e.content,e.id)})));x(t)}}),[F,_.length]);const $=b.useMemo((()=>({component:b.createElement(b.Fragment,null,(0,z.p)(v.hvcEntityPickerPropsValue)),isShown:v.shouldShowEntityPicker})),[v]);cs.log("Supply the addPinnedMessage  function in the callback for adding to pinned messages",L);const j={checked:E||!1,disabled:!1,onChange:(e,t)=>{cs.log("demoModeToggle onChange called",t,e),P(!!e?.target?.checked)},label:"Demo Mode"},V={checked:U,disabled:!1,onChange:(e,t)=>{cs.log("artifactContentEnabledToggle onChange called",t,e);const n=!!e?.target?.checked;Q(n),G.onArtifactContentStateChanged(n)},label:"Artifacts Enabled"},Z={checked:q,disabled:!1,onChange:(e,t)=>{cs.log("streamingEnabledToggle onChange called",t,e);const n=!!e?.target?.checked;K(n),G.onStreamingStateChanged(n)},label:"Streaming Enabled"},J=[{key:Yn.String,text:"String"},{key:Yn.CipTree,text:"Cip Tree"},{key:Yn.CipTreeSummary,text:"Cip Tree Summary"}],Y=b.createElement(o.B,{tokens:{childrenGap:8}},b.createElement($t.J,{htmlFor:"fileContentFetchFormat"},"File Content Fetch Format"),b.createElement(Wt,{id:"fileContentFetchFormat",selectedKey:w,onChange:(e,t)=>{t&&(I(t.key),G.onFileContentFetchFormatChanged(t.key))},options:J}));return e?b.createElement(H.zn,{style:g,getHeaderElement:()=>(cs.log("DEBUG: getHeaderElement called"),b.createElement(o.B,{className:`${B.cardGap} ${B.headerStyle}`},b.createElement(o.B,{horizontal:!0,className:`${B.toggleStyle}`},b.createElement(zt.M,null,b.createElement(Gt.$,null,b.createElement(i.W,null,b.createElement(s.c,{disableButtonEnhancement:!0},b.createElement(Ut.I,{icon:b.createElement(qt.wMk,null),appearance:"subtle"})),b.createElement(l.b,null,b.createElement(c.c,null,b.createElement(Qt.v,null,b.createElement(Kt.A,{...Z})),b.createElement(Qt.v,null,h&&b.createElement(Kt.A,{...V})),b.createElement(Qt.v,null,Y)))))),T&&b.createElement(Kt.A,{...j})),v.shouldShowEntityPicker&&b.createElement(No,{contentList:[$.component],title:"Files",handleOnToggle:D,HeaderIcon:b.createElement(f.tXb,null),itemCounterText:v.hvcEntityPickerPropsValue.list?.length||0}),b.createElement(No,{contentList:_.map((e=>b.createElement(b.Fragment,null,e.content))),HeaderIcon:b.createElement(y.MtV,null),handleOnToggle:D,title:"Pinned Responses",itemCounterText:_?.length||0}))),chatUiProps:{chatInputV2Props:{pluginsInfo:[],chatPlaceholderMessage:"Start typing here...",editorConfig:Yt},zeroQueryMessageV2Props:O?{promptSuggestionList:[{suggestionCategory:"Add Files",suggestionText:"Create a synopsis based on [File]",iconRegular:f.Bc8,shouldLaunchCIQOnSelection:!0,scopedEntity:W.ck.File,notifyClientOnZQMClicked:e=>{A(!1&&u),cs.log("Zero Query Message clicked, ",e)}}]}:void 0,changeTopicUiProps:{hideChangeTopicButton:!0},freUiProps:{...Xt,getStartedButtonText:E?Xt.getStartedButtonText:"Get Started",onGetStartedButtonClicked(){R(!1),E?(G.addDemoFiles(),S([tn])):G.fillEntityPickerProps(!0,en())}},suggestionPillsUiProps:{suggestionList:k}},copilotCommunicationHandler:G,useALRuntime:!!r,ref:m,firstHeaderComponent:$,theme:n,hostAppAuthTokens:{graphTokenProvider:async e=>({accessToken:"",expirationTime:(new Date).getTime()+36e5}),sharepointTokenProvider:async e=>({accessToken:"",expirationTime:(new Date).getTime()+36e5})}}):(cs.log("alSession is required"),b.createElement(b.Fragment,null))}},995163:(e,t,n)=>{e.exports=n.p+"assets/research-illustration.svg"}}]);
//# sourceMappingURL=researchworkspace.js.map