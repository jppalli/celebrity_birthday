var TypeScriptModule;(()=>{var __webpack_modules__={413:(e,t,n)=>{"use strict";n.d(t,{X:()=>l});var r=n(61714),o=n(208520),a=n(475119),i=n(350065),s=n(457236),c=n(837963);function l(e){var t=(0,o.useCallback)((function(e){var t=function(e){if(!e.json)return null;try{var t=JSON.parse(e.json);if(!(null==t?void 0:t.relatedFiles))return null;var n=[];n=t.relatedFiles.map((function(e){var t,n;return{id:(0,r.A)(),fileId:null!==(t=e.fileId)&&void 0!==t?t:e.fileUrl,text:e.fileName,contentType:null!==(n=e.fileExtension)&&void 0!==n?n:"docx",url:e.fileUrl,subText:e.relationshipReason}}));var o=[(0,a.Mv)(),(0,a.Td)(),(0,a.Kd)()].map((function(e){return{text:e,onClick:function(){}}}));return{list:n,headerDescription:(0,a.CR)(),maxEntityCount:n.length,suggestedPrompts:o}}catch(t){(0,a.cY)("Error parsing related files JSON:",e.json,t)}return null}(e);return t?(0,s.F9)(t):(0,c.$)(e)}),[e]);return(0,i.D)(e,t)}},558:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});var r=n(764081),o=n(481797),a=n(806141),i=function(e){var t,n;if(e.viewMode!==a.hs.TaskModule)return{dialogHeight:r.Qt,dialogWidth:r.Qt};var i=(0,o.Cd)(null===(t=e.dialogContent)||void 0===t?void 0:t.height),s=(0,o.Cd)(null===(n=e.dialogContent)||void 0===n?void 0:n.width),c=!0,l=!0,u=r.t9,d=r.OY;i<=0&&(l=!1,u=(0,o.wc)(i)),s<=0&&(c=!1,d=(0,o.tP)(s));var _=screen.width,p=screen.height;return l&&(u=(0,o.Xz)(i,p)),c&&(d=(0,o.Xz)(s,_)),{dialogHeight:u,dialogWidth:d}}},769:(e,t,n)=>{"use strict";n.d(t,{m5:()=>c,mM:()=>r,w5:()=>l});var r,o=n(990813),a=n(656904);!function(e){e[e.summarize=0]="summarize",e[e.callToAction=1]="callToAction",e[e.purposeOfDoc=2]="purposeOfDoc",e[e.intendedAudience=3]="intendedAudience",e[e.docClaim=4]="docClaim",e[e.ideaPresented=5]="ideaPresented",e[e.explainDoc=6]="explainDoc",e[e.aboutDoc=7]="aboutDoc",e[e.generateCoverPage=8]="generateCoverPage"}(r||(r={}));var i,s,c=function(){var e,t;return(0,a.Csj)()?(e={},(0,o._)(e,0,WordCopilot.SummarizeSuggestionMessage),(0,o._)(e,1,WordCopilot.CallToActionMessage),(0,o._)(e,2,WordCopilot.PurposeOfDocMessage),(0,o._)(e,3,WordCopilot.IntendedAudienceMessage),(0,o._)(e,4,WordCopilot.DocClaimMessage),(0,o._)(e,5,WordCopilot.IdeaPresentedMessage),(0,o._)(e,6,WordCopilot.ExplainDocMessage),(0,o._)(e,7,WordCopilot.AboutDocMessage),(0,o._)(e,8,"Generate a cover image"),e):(t={},(0,o._)(t,0,"Summarize this doc"),(0,o._)(t,1,"Is there a call to action?"),(0,o._)(t,2,"What's the purpose of the doc?"),(0,o._)(t,3,"Who's the intended audience?"),(0,o._)(t,4,"What arguments does the doc make?"),(0,o._)(t,5,"What ideas are presented?"),(0,o._)(t,6,"Explain this doc in 3 sentences"),(0,o._)(t,7,"What is this doc about?"),(0,o._)(t,8,"Generate a cover image"),t)};function l(e){switch(e){case c()[0]:case c()[1]:case c()[2]:case c()[3]:case c()[4]:case c()[5]:case c()[6]:case c()[7]:case c()[8]:return!0;default:return!1}}!function(e){e.contentCreation="Make my doc sound professional."}(i||(i={})),function(e){e[e.PaneAIFeedbackSkittleLaunch=1161858014]="PaneAIFeedbackSkittleLaunch",e[e.generateSummaryFromDocument=3690804694]="generateSummaryFromDocument",e[e.openWritersUnBlockDialog=1983359938]="openWritersUnBlockDialog",e[e.bold=4143129361]="bold",e[e.copilotJumpstart=3148323950]="copilotJumpstart",e[e.contentCreation=4236347351]="contentCreation"}(s||(s={}))},8810:(e,t,n)=>{"use strict";var r;n.d(t,{S:()=>r}),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.Microphone="Microphone",e.Commanding="Commanding",e.CLP="CLP",e.Designer="Designer",e.Feedback="Feedback",e.ImageChat="ImageChat",e.Safelinks="Safelinks"}(r||(r={}))},24498:(e,t,n)=>{"use strict";n.d(t,{G4:()=>o.G,Qk:()=>r.Q,fQ:()=>i.f,lq:()=>a.l});var r=n(215751),o=n(749571),a=n(813392),i=n(946562)},40956:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var r={Ack:"ack",CloseEvent:"close"}},41167:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(208520),o=n(758651),a=function(e,t,n){return void 0===n&&(n=3),(0,r.lazy)((function(){return new Promise((function(r,a){var i=0,s=function(){e().then((function(e){return r(e)})).catch((function(e){++i>=n?a(e):(o.error("Error in lazy loading package ".concat(t),e),s())}))};s()}))}))}},42801:(e,t,n)=>{"use strict";n.d(t,{$K:()=>s,P9:()=>l,j9:()=>c});var r=n(660606),o=n(354311),a=n(211475),i=n(241273),s=function(e){switch((0,r.s7)(e)){case o.D.DOGFOOD:return"Dogfood";case o.D.DOD:return"Dod";case o.D.GCC:return"GCC";case o.D.GCCHIGH:return"GCCHigh";case o.D.PRODUCTION:default:return"Prod"}},c=function(e,t){var n=l(e,t);return"bot"===e.author&&e.messageType===a.n3.GenerateContentQuery&&(null==e?void 0:e.contentType)===i.lL.Video&&void 0!==n},l=function(e,t){var n,o,a,i=u(e.invocation,t);if(!e.hiddenText)return null!==(a=e.text)&&void 0!==a?a:i;try{(0,r.cY)("Parsing Visual Creator video response message",e.hiddenText);var s=JSON.parse(e.hiddenText),c=null!==(n=null==s?void 0:s.userPrompt)&&void 0!==n?n:e.text;return null!=c?c:i}catch(t){return(0,r.cY)("Error in parsing Visual Creator video response message",t),null!==(o=e.text)&&void 0!==o?o:i}},u=function(e,t){if(e){var n=t?/clipchamp_create_video\(\s*[^)]*userPrompt\s*=\s*(['"])((?:\\.|[^\\])*?)\1/:/clipchamp_create_video\(\s*[^)]*userPrompt\s*=\s*"([^"]*)"/,r=e.match(n);return r?t?r[2]:r[1]:void 0}}},44378:(e,t,n)=>{"use strict";n.d(t,{Gn:()=>r.Gn,Ld:()=>r.Ld,P7:()=>r.P7});var r=n(328831)},45512:(e,t,n)=>{"use strict";n.d(t,{D:()=>r,m:()=>N});var r,o=n(720570),a=n(743032),i=n(811912),s=n(791165),c=n(990813),l=n(992960),u=n(575965),d=n(107182),_=n(857835),p=n(4026),g=n(379490),f=n(49177),h=n(341422),C=n(644275),m=n(243912),v=n(784567),E=n(606363),y=n(656904),b=n(28515),T=n(811250),I=n(63461),P=n(728681),A=n(844807),D=n(492644),S=n(448397),M=n(140889),O=n(832713),k=n(457476),L=n(769449),w=n(249002),R=n(208520),U=n(602061),B=n(504105),x=n(61714),W=n(30217),F=n(932554);!function(e){e.WordToPPTDocTransform="WordToPPTDocTransform",e.WordCopilotComposeSelection="WordCopilotComposeSelection",e.WordCopilotComposeInsert="WordCopilotComposeInsert",e.TellMe="TellMe"}(r||(r={}));var N=function(e){(0,d._)(n,e);var t=(0,p._)(n);function n(){var e;return(0,i._)(this,n),e=t.call(this,new B.p),(0,c._)((0,o._)(e),"handoffDocUrlRequestSubmitTime",void 0),(0,c._)((0,o._)(e),"handoffButtonMap",void 0),e.handoffButtonMap=new Set,e}return(0,s._)(n,[{key:"getHandoffInternalMessageSignal",value:function(e){return e.destinationApp,b.Ww.POWERPOINT,new D.L((0,_._)({queryId:(0,x.A)(),sourceApp:b.Ww.WORD,destinationApp:b.Ww.POWERPOINT,language:"en-us",scenarioName:b.Cu.NEW},e))}},{key:"getPPTHandoffOperation",value:function(e,t,n){this.sentQueryIds.add(t);var r=decodeURI(n).split("/").pop(),o={userPrompt:"Create a presentation about",source:{initiatorView:"Word",correlationId:t,sourceComponent:b.Ut.APP_CHAT},settings:{launchCIQFlow:!0},promptEntities:[{entityType:"File",entityDetails:{url:n,displayName:r,fileExtension:"docx"}}]};return new v.Xr({parentPath:["session","doc"],items:[{id:e,body:this.getHandoffInternalMessageSignal({queryId:t,destinationApp:b.Ww.POWERPOINT,destinationComponent:b.Ut.NARRATIVE_BUILDER,documentName:r.endsWith(".docx")?r.substring(0,r.length-5):r,context:JSON.stringify((0,_._)({featureName:"WordToPPTDocTransform"},o))})}]})}},{key:"handoffOutboundMessageHandler",value:function(e,t,r){var o=this,i=this;return(0,a._)((function(){return(0,g.__generator)(this,(function(a){switch(a.label){case 0:return i.handoffInternalMessageSubmitTime=t,[4,(0,l._)((0,u._)(n.prototype),"handleHandoffOutboundMessage",o).call(i,e,r)];case 1:return a.sent(),[2]}}))}))()}},{key:"renderGeneratedHandoffLinks",value:function(e){var t=this;return(0,a._)((function(){var n,r;return(0,g.__generator)(this,(function(o){switch(o.label){case 0:return e&&e.generatedLinks&&0!==e.generatedLinks.length?(r=null!==(n=e.generatedLinks[0].platformHandoffUrl)&&void 0!==n?n:y.u1i,[4,t.showHandoffIntentResponseInChat(e.destinationApp,r,e.id)]):[2];case 1:return o.sent(),[2]}}))}))()}},{key:"getPowerpointIconUrl",value:function(){return(0,W.K_)(f.q.PPT,(0,F.rA)())}},{key:"showHandoffIntentResponseInChat",value:function(e,t,n){var r=this;return(0,a._)((function(){var o,a,i,s,l,u,d,_,p;return(0,g.__generator)(this,(function(g){switch(g.label){case 0:return o=r.getPowerpointIconUrl(),a=y.rs7,i=(0,y.xE4)(),s=(0,y.YPu)(),l=(0,y.OOx)(),e!==b.Ww.POWERPOINT?[2]:(u=function(){return R.createElement(P._,{src:o,alt:a,height:20,width:20})},d={type:h.jA.Default,title:i,text:(0,w.dD)()?void 0:i,iconRegular:u,handleButtonOnClick:function(){var e;S.B.getInstance().sendChatEventTelemetry((0,L.pN)((e={},(0,c._)(e,M.h3.ChatEventType,M.a5.HandoffActionButtonClicked),(0,c._)(e,M.h3.UserQueryGuid,"".concat(n)),e))),r.handoffButtonMap.has(n)||((0,k.Pi)({messageText:i,addCardToChatHistory:!0,user:C.Q9.Human}),(0,k.Pi)({messageText:s,showAnimation:!0}),r.handoffButtonMap.add(n)),window.open(t,"_blank")}},[4,E.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]);case 1:return _=g.sent(),S.B.getInstance().sendChatEventTelemetry((0,L.pN)((p={},(0,c._)(p,M.h3.ChatEventType,M.a5.HandoffResponseChatMessageShown),(0,c._)(p,M.h3.ChatEventParameters,"".concat(n)),p))),(0,k.Pi)({messageText:l,showAIGenerated:!0,showAnimation:!0,feedbackSectionPosition:m.O.Footer,actionbuttons:[d],clpLabelData:(0,O.Q9)(_),addCardToChatHistory:!0,telemetryFeatureName:M.CC.Handoff}),[2]}}))}))()}},{key:"sendHandoffDocUrlSignal",value:function(){var e=Office.context.document.url,t=new T.Ox({documentUrl:e}),n=new v.Xr({parentPath:["session","doc"],items:[{id:A.r.generateId(),body:t}]});this.handoffDocUrlRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(t.H_.T_,{operation:n,workflowAnnotationType:I.dF.getTypeName()})}},{key:"handleHandoffDocUrlAnnotation",value:function(e,t){if(e&&e.body&&I.dF.typeGuard(e.body)){var n=e.body;this.HandoffOperations.logDebug("Received HandoffDocUrlAnnotation response. Status:",n.status),this.HandoffOperations.onAnnotationReceived(I.dF.getTypeName(),n,this.handoffDocUrlRequestSubmitTime,t)}else this.HandoffOperations.logDebug("Handoff annotation not of type HandoffDocUrlAnnotation")}}],[{key:"getInstance",value:function(){return n._instance||(n._instance=new n),n._instance}}]),n}(U.TkU);(0,c._)(N,"_instance",void 0)},46727:(e,t,n)=>{"use strict";n.d(t,{h:()=>_});var r=n(811912),o=n(791165),a=n(184712),i=n(656904),s=n(722603),c=n(610918),l=n(965974),u=n(242154),d=n(598309),_=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,null,[{key:"logSurveyTriggerEvent",value:function(t,n){var r=this.createSurveyTriggerActivityNames(t);if(s.i.GetHostAppPlatform()===i.q93)(0,a.J_)({type:a.WH.ChatWordTriggerFloodgateSurvey,message:e.createSurveyTriggerMessage(r,n)}),(0,u.cY)("OCV Survey trigger sent to Host app. Survey trigger activity names: "+r);else{var o=!0,c=!1,d=void 0;try{for(var _,p=r[Symbol.iterator]();!(o=(_=p.next()).done);o=!0){var g=_.value;l.M.getInstance().logSurveyTriggerEvent(g),(0,u.cY)("OCV Survey triggered. Survey trigger activity name: "+g)}}catch(e){c=!0,d=e}finally{try{o||null==p.return||p.return()}finally{if(c)throw d}}}}},{key:"createSurveyTriggerActivityNames",value:function(e){var t=[c.uc+c.ey[c.w2.WordCopilotAppLevel]];return(0,d.w9)()&&t.push(c.uc+c.ey[c.w2.WordCopilotBackstageUsage]),e&&t.push(c.uc+c.ey[e]),t}},{key:"createSurveyTriggerMessage",value:function(e,t){var n={MessageId:"WordCopilotMessage",SendTime:Date.now(),Values:{Payload:{type:"CopilotSurvey",CopilotSurvey:{SurveyTriggerActivityNames:e,isSuccess:t}}}};return(0,u.cY)("sdxToWordMessageObject",JSON.stringify(n)),JSON.stringify(n)}}]),e}()},49674:(e,t,n)=>{"use strict";n.d(t,{m:()=>c,w:()=>i});var r=n(743032),o=n(379490),a=new Map;function i(){return a}var s,c=(s=(0,r._)((function(e){var t,n,i,s,c,l,u;return(0,o.__generator)(this,(function(d){switch(d.label){case 0:return"ActiveDocument"!==e&&"Document"!==e?[3,2]:[4,Word.run(function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return t=e.document,e.load(t),[4,e.sync()];case 1:return n.sent(),t.track(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return d.sent(),n={content:[{type:"text",text:"Error: Unable to get Document object"}],isError:!0},t&&(i=crypto.randomUUID(),a.set(i,t),n.content[0].text='{"__WordObjId": '.concat(i.toString(),', "__WordObjType": "Document"}'),n.isError=!1),[2,JSON.stringify(n)];case 2:return"Range"!==e?[3,4]:[4,Word.run(function(){var e=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return(s=e.document.getSelection()).load("text"),[4,e.sync()];case 1:return t.sent(),s.track(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 3:return d.sent(),c={content:[{type:"text",text:"Error: Unable to get Range object"}],isError:!0},s&&(l=crypto.randomUUID(),a.set(l,s),c.content[0].text='{"__WordObjId": '.concat(l.toString(),', "__WordObjType": "Range"}'),c.isError=!1),[2,JSON.stringify(c)];case 4:return u={content:[{type:"text",text:"Error: Unable to get ".concat(e," object")}],isError:!0},[2,JSON.stringify(u)]}}))})),function(e){return s.apply(this,arguments)})},51020:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var r=function(){function e(){this.cache=new Map}return e.prototype.get=function(e){var t=this.createKey(e);return this.cache.get(t)},e.prototype.set=function(e,t){var n=this.createKey(e);this.cache.set(n,t)},e.prototype.delete=function(e){var t=this.createKey(e);return this.cache.delete(t)},e.prototype.has=function(e){var t=this.createKey(e);return this.cache.has(t)},e.prototype.createKey=function(e){return"".concat(e.resource,"-").concat(e.claims,"-").concat(e.isSilent)},e}()},57008:(e,t,n)=>{"use strict";n.r(t),n.d(t,{deleteComments:()=>X,deleteText:()=>Qe,executeDocumentChanges:()=>Se,executeStatements:()=>Pe,fns:()=>kt,formatComments:()=>ne,formatText:()=>Ve,getSelectionContextTree:()=>Ct,helper:()=>r,imageProvider:()=>Ot,insertComments:()=>Z,insertText:()=>$e,redoApplication:()=>It,rewriteText:()=>tt,selectComments:()=>ee,selectIndices:()=>Ke,selectText:()=>we,selectTextIndex:()=>Fe,server:()=>Mt,textProvider:()=>St});var r={};n.r(r),n.d(r,{camelFromPascal:()=>g,getDocumentAsCompressed:()=>d,getSliceAsync:()=>_,matchAll:()=>u,onGotAllSlices:()=>p});var o=n(743032),a=n(379490),i=n(374292),s=n(242154),c=n(249002),l=n(758651);function u(e,t){for(var n,r=(0,i._)(t,RegExp)?t:new RegExp(t,"g"),o=[];null!==(n=r.exec(e));)o.push(n);return o}function d(){return new OfficeExtension.Promise((function(e,t){var n;Office.context.document.getFileAsync(Office.FileType.Compressed,{sliceSize:4194304},(n=(0,o._)((function(n){var r,o,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(n.status!=Office.AsyncResultStatus.Succeeded)return[3,4];r=n.value,o=r.sliceCount,_(r,0,o,!0,[],0,i=[]),a.label=1;case 1:return 0!=i.length?[3,3]:[4,(0,c.uk)(100)];case 2:return a.sent(),[3,1];case 3:return e(i[0]),[3,5];case 4:t(l.log(n.error.message)),a.label=5;case 5:return[2]}}))})),function(e){return n.apply(this,arguments)}))}))}function _(e,t,n,r,o,a,i){e.getSliceAsync(t,(function(c){if("succeeded"==c.status){if(!r)return void(0,s.cY)("Failed to get all slices, no need to continue.");o[c.value.index]=c.value.data,++a==n?((0,s.cY)("All slices have been received."),e.closeAsync(),p(o,i)):_(e,++t,n,r,o,a,i)}else r=!1,e.closeAsync()}))}function p(e,t){for(var n=[],r=0;r<e.length;r++)n=n.concat(e[r]);for(var o=new String,a=0;a<n.length;a++)o+=String.fromCharCode(n[a]);t.push(btoa(o))}function g(e){return e.charAt(0).toLowerCase()+e.slice(1)}var f=n(758651),h=function(e,t,n){for(var r=[],o=0;o<t;o++){for(var a=[],i=0;i<n;i++)o<e.length&&i<e[o].length?a.push(String(e[o][i])):a.push("");r.push(a)}return r};function C(e){return m.apply(this,arguments)}function m(){return(m=(0,o._)((function(e){var t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:if(!(e&&e.context&&e.rows&&e.columns&&e.insertLocation))throw f.error("invalid args for inserting the table"),new Error("invalid args for inserting the table");return f.log("START: insertTable"),t=[],e.precededBy.forEach((function(n){if(e.value){var r=JSON.parse(e.value),o=h(r,e.rows,e.columns);t.push(n.insertTable(e.rows,e.columns,v(e.insertLocation),o))}else t.push(n.insertTable(e.rows,e.columns,v(e.insertLocation)))})),[4,e.context.sync()];case 1:return n.sent(),f.log("END: insertTable"),[2,t]}}))}))).apply(this,arguments)}function v(e){return e&&"end"!==e.toLowerCase()?"start"===e.toLowerCase()?Word.InsertLocation.start:"replace"===e.toLowerCase()?Word.InsertLocation.replace:"before"===e.toLowerCase()?Word.InsertLocation.before:"after"===e.toLowerCase()?Word.InsertLocation.after:Word.InsertLocation.start:Word.InsertLocation.end}function E(e){return y.apply(this,arguments)}function y(){return(y=(0,o._)((function(e){var t,n,r,o;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return f.log("START: selectTables"),n=null!==(t=e.index)&&void 0!==t?t:0,e.scope&&"Selection"===e.scope?(r=e.context.document.getSelection().tables.load(),[4,e.context.sync()]):[3,4];case 1:return a.sent(),0!==r.items.length?[3,3]:(f.error("No tables found Selection scope and fetching table from the cursor position"),(o=e.context.document.getSelection()).load("parentTable"),[4,e.context.sync()]);case 2:if(a.sent(),o.parentTable)return f.log("END: selectTables"),[2,[o.parentTable]];throw f.error("Cursor is Not Inside Any Table"),new Error("Cursor is Not Inside Any Table");case 3:return[3,5];case 4:r=e.context.document.body.tables.load(),a.label=5;case 5:return[4,e.context.sync()];case 6:if(a.sent(),0===r.items.length||n>=r.items.length)throw f.error("No tables found in the document or index out of range"),new Error("No tables found in the document ");return f.log("END: selectTables"),-1===n?[2,[r.items[r.items.length-1]]]:[2,[r.items[n]]]}}))}))).apply(this,arguments)}function b(e,t){return T.apply(this,arguments)}function T(){return(T=(0,o._)((function(e,t){var n,r,o;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return r=null!==(n=e.numColumns)&&void 0!==n?n:1,t.load(["values","rowCount"]),[4,e.context.sync()];case 1:return a.sent(),void 0!==e.columnIndex||void 0!==e.numColumns?[3,3]:(t.delete(),[4,e.context.sync()]);case 2:return a.sent(),[2];case 3:void 0===e.columnIndex&&(e.columnIndex=0),a.label=4;case 4:if(e.columnIndex&&e.columnIndex<0||r<0||e.columnIndex+r>t.values[0].length)throw f.error("invalid args for deleting the columns: ",e),new Error("invalid args for deleting the columns");return"End"===(null!==(o=e.deleteLocation)&&void 0!==o?o:"Start")&&(e.columnIndex=t.values[0].length-(e.columnIndex+r)),t.deleteColumns(e.columnIndex,r),[4,e.context.sync()];case 5:return a.sent(),[2]}}))}))).apply(this,arguments)}function I(e){return P.apply(this,arguments)}function P(){return(P=(0,o._)((function(e){var t,n,r,o,i,s,c,l;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(f.log("START: deleteColumns"),!e||!e.tables&&!e.ranges||e.tables&&0===e.tables.length||e.ranges&&0===e.ranges.length)throw f.error("invalid args for deleting the columns"),new Error("invalid args for deleting the columns");if(!e.ranges||!e.scope)return[3,10];t=!0,n=!1,r=void 0,a.label=1;case 1:a.trys.push([1,7,8,9]),o=e.ranges[Symbol.iterator](),a.label=2;case 2:return(t=(i=o.next()).done)?[3,6]:(s=i.value,[4,U(e.context,s,e.scope)]);case 3:return c=a.sent(),e.columnIndex=c.ColumnIndex,void 0===c.parentTable?[3,5]:[4,b(e,c.parentTable)];case 4:a.sent(),e.columnIndex=void 0,a.label=5;case 5:return t=!0,[3,2];case 6:return[3,9];case 7:return l=a.sent(),n=!0,r=l,[3,9];case 8:try{t||null==o.return||o.return()}finally{if(n)throw r}return[7];case 9:return[3,12];case 10:return e.tables?[4,b(e,e.tables[0])]:[3,12];case 11:a.sent(),a.label=12;case 12:return f.log("END: deleteColumns"),[2]}}))}))).apply(this,arguments)}function A(e,t){return D.apply(this,arguments)}function D(){return(D=(0,o._)((function(e,t){var n,r,o;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return r=null!==(n=e.numRows)&&void 0!==n?n:1,t.load(["rowCount"]),[4,e.context.sync()];case 1:return a.sent(),void 0!==e.rowIndex||void 0!==e.numRows?[3,3]:(t.delete(),[4,e.context.sync()]);case 2:return a.sent(),[2];case 3:void 0===e.rowIndex&&(e.rowIndex=0),a.label=4;case 4:if(e.rowIndex+r>t.rowCount||e.rowIndex<0||r<0)throw f.error("invalid args for deleting the rows : ",e),new Error("invalid args for deleting the rows");return"End"===(null!==(o=e.deleteLocation)&&void 0!==o?o:"Start")&&(e.rowIndex=t.rowCount-(e.rowIndex+r)),t.deleteRows(e.rowIndex,r),[4,e.context.sync()];case 5:return a.sent(),[2]}}))}))).apply(this,arguments)}function S(e){return M.apply(this,arguments)}function M(){return(M=(0,o._)((function(e){var t,n,r,o,i,s,c,l;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(f.log("START: deleteRows"),!e||!e.tables&&!e.ranges||e.tables&&0===e.tables.length||e.ranges&&0===e.ranges.length)throw f.error("invalid args for deleting the rows"),new Error("invalid args for deleting the rows");if(!e.ranges||!e.scope)return[3,10];t=!0,n=!1,r=void 0,a.label=1;case 1:a.trys.push([1,7,8,9]),o=e.ranges[Symbol.iterator](),a.label=2;case 2:return(t=(i=o.next()).done)?[3,6]:(s=i.value,[4,U(e.context,s,e.scope)]);case 3:return c=a.sent(),e.rowIndex=c.rowIndex,void 0===c.parentTable?[3,5]:[4,A(e,c.parentTable)];case 4:a.sent(),e.rowIndex=void 0,a.label=5;case 5:return t=!0,[3,2];case 6:return[3,9];case 7:return l=a.sent(),n=!0,r=l,[3,9];case 8:try{t||null==o.return||o.return()}finally{if(n)throw r}return[7];case 9:return[3,12];case 10:return e.tables?[4,A(e,e.tables[0])]:[3,12];case 11:a.sent(),a.label=12;case 12:return f.log("END: deleteRows"),[2]}}))}))).apply(this,arguments)}function O(e){f.log("START: formatTableCellStyle");var t=e.table,n=e.rowIndex,r=e.columnIndex,o=e.color,a=e.borderColor,i=e.borderStyle,s=e.borderEdge;o&&(t.getCell(n,r).shadingColor=o),a&&s&&(t.getCell(n,r).getBorder(s).color=a),i&&s&&(t.getCell(n,r).getBorder(s).type=i),f.log("END: formatTableCellStyle")}function k(e){return L.apply(this,arguments)}function L(){return L=(0,o._)((function(e){var t,n,r,o,i,s,c,l,u,d,_,p;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return f.log("START: formatTableStyle"),t=e.table,n=e.rowIndex,r=e.columnIndex,o=e.color,i=e.borderColor,s=e.borderStyle,c=e.borderEdge,l=e.context,void 0===n||void 0===r?[3,1]:(O({table:t,rowIndex:n,columnIndex:r,color:o,borderColor:i,borderStyle:s,borderEdge:c}),[3,6]);case 1:return void 0===n?[3,3]:(t.load(["values"]),[4,l.sync()]);case 2:if(a.sent(),n>=t.values.length)throw f.log("invalid args for formatting the table"),new Error("invalid args for formatting the table");for(u=t.values[n].length,d=0;d<u;d++)O({table:t,rowIndex:n,columnIndex:d,color:o,borderColor:i,borderStyle:s,borderEdge:c});return[3,6];case 3:return void 0===r?[3,5]:(t.load(["rowCount","items","items/shadingColor"]),[4,l.sync()]);case 4:for(a.sent(),_=t.rowCount,p=0;p<_;p++)O({table:t,rowIndex:p,columnIndex:r,color:o,borderColor:i,borderStyle:s,borderEdge:c});return[3,6];case 5:o&&(t.shadingColor=o),i&&c&&(t.getBorder(c).color=i),s&&c&&(t.getBorder(c).type=s),a.label=6;case 6:return f.log("END: formatTableStyle"),[2]}}))})),L.apply(this,arguments)}function w(e,t){return R.apply(this,arguments)}function R(){return(R=(0,o._)((function(e,t){var n,r,o,i,s,c,l,u,d,_,p;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(f.log("START: formatTableData"),t.load(["type","color","styleBandedRows","styleBandedColumns"]),r=null!==(n=e.borderEdges)&&void 0!==n?n:["Top","Left","Right","Bottom"],!e.borderColor&&!e.borderStyle)return[3,8];o=!0,i=!1,s=void 0,a.label=1;case 1:a.trys.push([1,6,7,8]),c=r[Symbol.iterator](),a.label=2;case 2:return(o=(l=c.next()).done)?[3,5]:(u=l.value,[4,k({context:e.context,table:t,color:e.color,rowIndex:e.rowIndex,columnIndex:e.columnIndex,borderColor:e.borderColor,borderStyle:e.borderStyle,borderEdge:u})]);case 3:a.sent(),a.label=4;case 4:return o=!0,[3,2];case 5:return[3,8];case 6:return d=a.sent(),i=!0,s=d,[3,8];case 7:try{o||null==c.return||c.return()}finally{if(i)throw s}return[7];case 8:return e.color?[4,k({context:e.context,table:t,color:e.color,rowIndex:e.rowIndex,columnIndex:e.columnIndex})]:[3,10];case 9:a.sent(),a.label=10;case 10:return void 0!==e.autofit&&t.autoFitWindow(),void 0!==e.bandedRows&&(t.styleBandedRows=e.bandedRows),void 0!==e.bandedColumns&&(t.styleBandedColumns=e.bandedColumns),e.columnWidth?void 0===e.columnIndex?[3,11]:(t.getCell(0,e.columnIndex).columnWidth=e.columnWidth,[3,13]):[3,13];case 11:return t.load(["values"]),_=t.values[0].length,[4,e.context.sync()];case 12:for(a.sent(),p=0;p<_;p++)t.getCell(0,p).columnWidth=e.columnWidth;a.label=13;case 13:return[4,e.context.sync()];case 14:return a.sent(),f.log("END: formatTableData"),[2]}}))}))).apply(this,arguments)}function U(e,t,n){return B.apply(this,arguments)}function B(){return B=(0,o._)((function(e,t,n){var r;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:return t.load(["parentTable","parentTableCell"]),[4,e.sync()];case 1:return o.sent(),t.parentTable?((r=t.parentTableCell).load(["rowIndex","cellIndex"]),[4,e.sync()]):[2,{rowIndex:void 0,ColumnIndex:void 0,parentTable:void 0}];case 2:return o.sent(),"rows"===n?[2,{rowIndex:r.rowIndex,ColumnIndex:void 0,parentTable:t.parentTable}]:"columns"===n?[2,{rowIndex:void 0,ColumnIndex:r.cellIndex,parentTable:t.parentTable}]:"cells"===n?[2,{rowIndex:r.rowIndex,ColumnIndex:r.cellIndex,parentTable:t.parentTable}]:[2,{rowIndex:void 0,ColumnIndex:void 0,parentTable:void 0}]}}))})),B.apply(this,arguments)}function x(e){return W.apply(this,arguments)}function W(){return(W=(0,o._)((function(e){var t,n,r,o,i,s,c,l,u,d,_,p,g,h;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(f.log("START: formatTables"),!e||!e.tables&&!e.ranges||e.tables&&0===e.tables.length||e.ranges&&0===e.ranges.length)throw f.log("invalid args for formatting the table"),new Error("invalid args for formatting the table");if(!e.tables)return[3,9];t=!0,n=!1,r=void 0,a.label=1;case 1:a.trys.push([1,6,7,8]),o=e.tables[Symbol.iterator](),a.label=2;case 2:return(t=(i=o.next()).done)?[3,5]:(s=i.value,[4,w(e,s)]);case 3:a.sent(),a.label=4;case 4:return t=!0,[3,2];case 5:return[3,8];case 6:return h=a.sent(),n=!0,r=h,[3,8];case 7:try{t||null==o.return||o.return()}finally{if(n)throw r}return[7];case 8:return[3,18];case 9:if(!e.ranges||!e.scope)return[3,18];c=!0,l=!1,u=void 0,a.label=10;case 10:a.trys.push([10,16,17,18]),d=e.ranges[Symbol.iterator](),a.label=11;case 11:return(c=(_=d.next()).done)?[3,15]:(p=_.value,[4,U(e.context,p,e.scope)]);case 12:return g=a.sent(),e.rowIndex=g.rowIndex,e.columnIndex=g.ColumnIndex,void 0===g.parentTable?[3,14]:[4,w(e,g.parentTable)];case 13:a.sent(),e.rowIndex=void 0,e.columnIndex=void 0,a.label=14;case 14:return c=!0,[3,11];case 15:return[3,18];case 16:return h=a.sent(),l=!0,u=h,[3,18];case 17:try{c||null==d.return||d.return()}finally{if(l)throw u}return[7];case 18:return f.log("END: formatTables"),[2]}}))}))).apply(this,arguments)}function F(e){return N.apply(this,arguments)}function N(){return(N=(0,o._)((function(e){var t,n,r;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:if(!e||!e.tables||0===e.tables.length)throw f.log("invalid args for mergeTables the table"),new Error("invalid args for mergeTables the table");return f.log("START: mergeTables"),t=e.firstCell,n=e.lastCell,(r=e.tables[0]).load("values"),[4,e.context.sync()];case 1:if(o.sent(),void 0===t||void 0===n){if(e.bottomRow>=r.values.length)throw new Error("invalid args for mergeTables the table");r.mergeCells(e.topRow,0,e.bottomRow,r.values[e.bottomRow].length-1)}else r.mergeCells(e.topRow,t,e.bottomRow,n);return[4,e.context.sync()];case 2:return o.sent(),f.log("END: mergeTables"),[2]}}))}))).apply(this,arguments)}function K(e){return H.apply(this,arguments)}function H(){return(H=(0,o._)((function(e){var t,n,r,o,i,s,c,l;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(!e||!e.tables||0===e.tables.length)throw f.log("invalid args for spiltCellForTables the table"),new Error("invalid args for spiltCellForTables the table");return f.log("START: spiltCellForTables"),n=null!==(t=e.rowIndex)&&void 0!==t?t:0,o=null!==(r=e.columnIndex)&&void 0!==r?r:0,s=null!==(i=e.rowCount)&&void 0!==i?i:0,l=null!==(c=e.columnCount)&&void 0!==c?c:0,e.tables[0].getCell(n,o).split(s,l),[4,e.context.sync()];case 1:return a.sent(),f.log("END: spiltCellForTables"),[2]}}))}))).apply(this,arguments)}function G(e){return Q.apply(this,arguments)}function Q(){return(Q=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:if(!e||!e.tables||0===e.tables.length)throw f.log("invalid args for spiltCellForTables the table"),new Error("invalid args for spiltCellForTables the table");return f.log("START: deleteTables"),e.tables[0].delete(),[4,e.context.sync()];case 1:return t.sent(),f.log("END: deleteTables"),[2]}}))}))).apply(this,arguments)}function j(e){return Y.apply(this,arguments)}function Y(){return(Y=(0,o._)((function(e){var t,n,r;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:if(!e||!e.tables||0===e.tables.length)throw f.log("invalid args for spiltCellForTables the table"),new Error("invalid args for spiltCellForTables the table");return f.log("START: insertRows"),t=e.tables[0],e.value?(n=JSON.parse(e.value),t.load(["values","rowCount"]),[4,e.context.sync()]):[3,2];case 1:return o.sent(),r=h(n,e.numRows,t.values[t.rowCount-1].length),t.addRows(v(e.insertLocation),e.numRows,r),[3,3];case 2:t.addRows(v(e.insertLocation),e.numRows),o.label=3;case 3:return[4,e.context.sync()];case 4:return o.sent(),f.log("END: insertRows"),[2]}}))}))).apply(this,arguments)}function z(e){return q.apply(this,arguments)}function q(){return(q=(0,o._)((function(e){var t,n,r;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:if(!e||!e.tables||0===e.tables.length)throw f.log("invalid args for spiltCellForTables the table"),new Error("invalid args for spiltCellForTables the table");return f.log("START: insertColumns"),t=e.tables[0],e.value?(n=JSON.parse(e.value),t.load("rowCount"),[4,e.context.sync()]):[3,2];case 1:return o.sent(),r=h(n,t.rowCount,e.numColumns),t.addColumns(v(e.insertLocation),e.numColumns,r),[3,3];case 2:t.addColumns(v(e.insertLocation),e.numColumns),o.label=3;case 3:return[4,e.context.sync()];case 4:return o.sent(),f.log("END: insertColumns"),[2]}}))}))).apply(this,arguments)}var V=n(758651);function Z(e){return J.apply(this,arguments)}function J(){return J=(0,o._)((function(e){var t,n,r,o;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return V.log("START: insertComments"),V.log("InsertCommentsArgs = ",e),t=e.context,n=e.ranges,r=e.text,n||(n=[t.document.getSelection()]),o=[],n.forEach((function(e){var t=e.insertComment(r);o.push(t),t.load()})),[4,t.sync()];case 1:return a.sent(),V.log("END: insertComments"),[2,o]}}))})),J.apply(this,arguments)}function X(e){return $.apply(this,arguments)}function $(){return $=(0,o._)((function(e){var t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return V.log("START: deleteComments"),V.log("deleteComments = ",e),t=e.context,e.comments.forEach((function(e){e.delete()})),[4,t.sync()];case 1:return n.sent(),V.log("END: deleteComments"),[2]}}))})),$.apply(this,arguments)}function ee(e){return te.apply(this,arguments)}function te(){return te=(0,o._)((function(e){var t,n,r,o,i,s,c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(V.log("START: selectComments"),V.log("selectComments = ",e),t=e.context,n=e.scope,r=e.index,o=e.resolved,i=e.text,"Document"===n)s=t.document.body.getComments();else{if("Selection"!==n)throw new Error("Invalid scope, We are only supporting document and selection scope");s=t.document.getSelection().getComments()}return s.load("items"),[4,t.sync()];case 1:return a.sent(),c=[],0!==s.items.length||"Document"===n?[3,3]:(V.log("No comments found in the selection, searching in the document"),(s=t.document.body.getComments()).load("items"),[4,t.sync()]);case 2:a.sent(),a.label=3;case 3:return s.items.forEach((function(e){void 0!==o&&e.resolved!==o||c.push(e)})),i&&(V.log("Filtering comments based on text"),c=c.filter((function(e){return e.content.includes(i)}))),V.log(c.length),[4,t.sync()];case 4:if(a.sent(),V.log("END: selectComments"),void 0===r)return[2,c];if(r<c.length)return-1==r&&c.length>0?[2,[c[c.length-1]]]:[2,[c[r]]];throw new Error("No Comment is Selected")}}))})),te.apply(this,arguments)}function ne(e){return re.apply(this,arguments)}function re(){return re=(0,o._)((function(e){var t,n,r;return(0,a.__generator)(this,(function(o){switch(o.label){case 0:return V.log("START: formatComments"),V.log("formatComments = ",e),t=e.context,n=e.comments,r=e.resolved,n.forEach((function(e){e.load("items"),e.resolved=r})),[4,t.sync()];case 1:return o.sent(),V.log("END: formatComments"),[2]}}))})),re.apply(this,arguments)}var oe,ae,ie=n(260697),se=n(928499),ce=n(656904),le=n(740389),ue=n(140889),de=n(297309),_e=n(106572),pe=n(661218),ge=n(8810),fe=n(965974),he=n(602061),Ce=n(437408);!function(e){e.Absolute="Absolute",e.Relative="Relative"}(oe||(oe={})),function(e){e.Paragraph="Paragraph",e.Sentence="Sentence",e.Word="Word",e.Character="Character"}(ae||(ae={}));var me=["deleteText","deleteRanges","formatText","insertText","selectText","selectIndices","selectRanges","rewriteText","InsertOperation","DeleteOperation","ReplaceOperation","insertComments","selectComments","deleteComments","formatComments","insertTables","deleteColumns","selectTables","deleteRows","mergeTables","formatTables","splitCellForTables","deleteTables","insertColumns","insertRows","formatList","insertList","undoApplication","redoApplication","selectTextIndex"],ve=n(146931),Ee=n(862853),ye=n(598309),be={},Te=null,Ie=null;function Pe(e,t){return Ae.apply(this,arguments)}function Ae(){return Ae=(0,o._)((function(e,t){var n,r,o,i,c,l,u,d,_,p,g,f,h,C,m,v,E,y,b,T,I;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:Te=fe.M.getInstance(),Ie=pe.E.getInstance(),n=1,r=!1,o={},i=[],c={},l=0,a.label=1;case 1:a.trys.push([1,10,,11]),u=!0,d=!1,_=void 0,a.label=2;case 2:a.trys.push([2,7,8,9]),p=t[Symbol.iterator](),a.label=3;case 3:if(u=(g=p.next()).done)return[3,6];if(f=g.value,h="",C=f.name,(0,le.uPJ)()&&(i.push(C),(0,Ce.r4)(Ie,n,C)),!me.includes(C))throw(0,s.cY)(C,"is not a valid function name"),new Error("Unexpected function name: ".concat(C));if(!kt[C])throw new Error("Function not implemented: ".concat(C));for(var P in void 0!==f.dismissedArguments&&(r=!0),(m={}).context=e,v="",f.arguments)h+=P+",",(0,le.uPJ)()&&"textRanges"!==P&&"comments"!==P&&"context"!==P&&(v+=P+","),m[P]=De(f.arguments[P],o);return(0,ye.cU)((0,Ee.w5)())&&ve.sL.getInstance().getWordAppCopilotStreamingState()&&(m.isSydneyStreaming="true"),h=h.slice(0,-1),(0,le.uPJ)()&&(c[C]=v.slice(0,-1)),E=kt[C],y=(new Date).getTime(),be[ue.Dh.OperationOrder]=n,be[ue.Dh.EventState]="Start",be[ue.Dh.OperationType]=C,be[ue.Dh.OperationParameters]=h,Te.logEvent((0,s.gY)(be)),[4,E(m)];case 4:b=a.sent(),be[ue.Dh.EventState]="End",be[ue.Dh.TimeDurationInMs]=(0,he.xJq)(y),Te.logEvent((0,s.gY)(be)),be=(0,s.b6)(),(0,s.cY)("Execution Completed ",C,"with args: ",m,"Time Taken : "+(0,he.WUi)(y)+" sec"),l+=(0,he.xJq)(y),b&&Array.isArray(b)&&(0,s.cY)(C,"returned",b.length,"items"),f.returns&&(o[f.returns]=b),n++,a.label=5;case 5:return u=!0,[3,3];case 6:return[3,9];case 7:return T=a.sent(),d=!0,_=T,[3,9];case 8:try{u||null==p.return||p.return()}finally{if(d)throw _}return[7];case 9:return[3,11];case 10:return I=a.sent(),(0,s.cY)("exception",I),(0,s.cY)("Execute statements failed:"+JSON.stringify(I)),Te.logError({eventType:ge.S.ChatEvents,errorMessage:"Execute statements failed:"+JSON.stringify(I)}),I.name===ce.RZX?((0,Ce.wC)(Ie,Te,i,ue.by.ContentNotFound,c),[2,ce.rIt.CONTENT_NOTFOUND]):((0,Ce.wC)(Ie,Te,i,ue.by.Failed,c),[2,ce.rIt.FAILED]);case 11:return r?((0,Ce.e9)(Ie,Te,i,c,!0,l),[2,ce.rIt.PARTIAL_SUCCESS]):((0,Ce.e9)(Ie,Te,i,c,!1,l),[2,ce.rIt.SUCCESS])}}))})),Ae.apply(this,arguments)}var De=function(e,t){if("object"==typeof e)switch(e.type){case"regex":var n;(0,s.cY)("Regex returned from ODSL is ".concat(e.regex));var r=null===(n=e.regex)||void 0===n?void 0:n.split("/");if(3==r.length)return null!=r[2]?new RegExp(r[1],r[2]):new RegExp(r[1]);throw new Error("Regex is incorrect: ".concat(e.regex));case"var":return t[e.name];case"scope":return e.name;case"color":case"string":return e.string;case"number":return e.number;case"boolean":return e.boolean;case"jsonGrid":return e.json;case"stringList":return e.stringList;default:throw new Error("Unexpected complex type: ".concat(e.name))}return e};function Se(e){return Me.apply(this,arguments)}function Me(){return(Me=(0,o._)((function(e){var t,n,r,o,i,c,l,u,d,_,p,g,f,h,C;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:Te=fe.M.getInstance(),t=1,a.label=1;case 1:a.trys.push([1,10,,11]),n=!0,r=!1,o=void 0,a.label=2;case 2:a.trys.push([2,7,8,9]),i=e[Symbol.iterator](),a.label=3;case 3:if(n=(c=i.next()).done)return[3,6];switch(l=c.value,u=l.kind,d=void 0,_=void 0,p={},u){case _e.a.Insert:(0,s.cY)("It is a insert operation"),d="insertOperation",_=l.insertOperation,p.paragraphId=_.paragraphId,p.insertBefore=_.insertBefore,p.content=_.content;break;case _e.a.Replace:(0,s.cY)("It is a replace operation"),d="replaceOperation",_=l.replaceOperation,p.fromParagraphId=l.replaceOperation.fromParagraphId,p.paragraphIds=l.replaceOperation.paragraphIds,p.content=l.replaceOperation.content;break;case _e.a.Delete:(0,s.cY)("It is a delete operation"),d="deleteOperation",_=l.deleteOperation,p.paragraphIds=_.paragraphIds}if(!kt[d])throw new Error("Function not implemented: ".concat(d));return g=kt[d],f=(new Date).getTime(),be[ue.Dh.OperationOrder]=t,be[ue.Dh.EventState]="Start",be[ue.Dh.OperationType]=d,Te.logEvent((0,s.gY)(be)),[4,g(p)];case 4:a.sent(),be[ue.Dh.EventState]="End",be[ue.Dh.TimeDurationInMs]=(0,he.xJq)(f),Te.logEvent((0,s.gY)(be)),be=(0,s.b6)(),t++,a.label=5;case 5:return n=!0,[3,3];case 6:return[3,9];case 7:return h=a.sent(),r=!0,o=h,[3,9];case 8:try{n||null==i.return||i.return()}finally{if(r)throw o}return[7];case 9:return[3,11];case 10:return C=a.sent(),(0,s.cY)("exception",C),(0,s.cY)("Execute statements failed:"+JSON.stringify(C)),Te.logError({eventType:ge.S.ChatEvents,errorMessage:"Execute statements failed:"+JSON.stringify(C)}),[2,ce.rIt.FAILED];case 11:return[2,ce.rIt.SUCCESS]}}))}))).apply(this,arguments)}var Oe=window.console;function ke(e,t,n){return Le.apply(this,arguments)}function Le(){return Le=(0,o._)((function(e,t,n){var r,o,i,s,c,l,u,d=arguments;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:r=d.length>3&&void 0!==d[3]?d[3]:1,Oe.log("START: getParagraphForList"),o=[],i=0,a.label=1;case 1:return i<t.length?((c=t[i].getTextRanges(["\n","\r"],!0)).load("items"),[4,n.sync()]):[3,4];case 2:a.sent(),(s=o).push.apply(s,(0,se._)(c.items)),a.label=3;case 3:return i++,[3,1];case 4:for(e<0&&(o.reverse(),e=Math.abs(e+1)),l=[],u=e;u<o.length&&u<r+e;u++)l.push(o[u]);return Oe.log("END: getParagraphForList"),[2,l]}}))})),Le.apply(this,arguments)}function we(e){return Re.apply(this,arguments)}function Re(){return Re=(0,o._)((function(e){var t,n,r,o,s,c,l,u,d,_,p,g,f,h,C,m,v,E,y,b,T,I,P,A,D,S,M,O,k,L,w,R,U,B,x,W,F;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.context,n=e.scope,r=void 0===n?null:n,o=e.text,s=void 0===o?null:o,c=e.index,l=void 0===c?null:c,u=e.unitType,d=e.position,_=e.offset,p=void 0===_?null:_,g=e.length,f=void 0===g?null:g,h=e.style,C=void 0===h?null:h,m=[],v=[],E=!1,null==(y=r)&&(y="Selection"),(b=t.document.getSelection()).load("isEmpty"),[4,t.sync()];case 1:return a.sent(),null!=s&&"Selection"==y&&b.isEmpty&&(y="Document",Oe.log("selectText() text parameter provided but selection is empty, scope changed to Document")),"Selection"===y&&(m=[b]),Array.isArray(y)&&y.length>0&&(0,i._)(y[0],Word.Section)?[2,[]]:[3,2];case 2:return Array.isArray(y)&&y.length>0&&(0,i._)(y[0],Word.Table)?[2,[]]:[3,3];case 3:return"Document"!==y?[3,6]:(0,le.LDc)()?[3,5]:((I=t.document.body.getRange().getTextRanges(["\n","\r"],!0)).load("items"),[4,t.sync()]);case 4:return a.sent(),(T=m).push.apply(T,(0,se._)(I.items)),[3,6];case 5:m.push(t.document.body.getRange()),a.label=6;case 6:if(null==s)return[3,10];E=!0,P=0,a.label=7;case 7:return P<m.length?((D=m[P].search(s,{matchWholeWord:!0})).load("items"),[4,t.sync()]):[3,10];case 8:a.sent(),(A=v).push.apply(A,(0,se._)(D.items)),a.label=9;case 9:return P++,[3,7];case 10:if(null==C)return[3,22];E=!0,v.length>0&&(m=v,v=[]),Oe.log("Fetch all paragraphs here to match style: "+C),S=0,a.label=11;case 11:return S<m.length?((M=m[S].paragraphs).load("items"),[4,t.sync()]):[3,22];case 12:a.sent(),O=!0,k=!1,L=void 0,a.label=13;case 13:a.trys.push([13,19,20,21]),w=M.items[Symbol.iterator](),a.label=14;case 14:return(O=(R=w.next()).done)?[3,18]:((U=R.value).load("styleBuiltIn"),[4,t.sync()]);case 15:return a.sent(),Oe.log("styles..."+U.styleBuiltIn),(null===(B=U.styleBuiltIn.match(C))||void 0===B?void 0:B.length)>0?(Oe.log("Found the matching style here..."),U.load(),(W=U.getTextRanges(["\n","\r"],!0)).load("items"),[4,t.sync()]):[3,17];case 16:a.sent(),(x=v).push.apply(x,(0,se._)(W.items)),a.label=17;case 17:return O=!0,[3,14];case 18:return[3,21];case 19:return F=a.sent(),k=!0,L=F,[3,21];case 20:try{O||null==w.return||w.return()}finally{if(k)throw L}return[7];case 21:return S++,[3,11];case 22:if(E||(v=m),null!=l)try{v=[v[l]]}catch(e){v=[]}return(0,le.oCn)()&&null!=p?[4,ke(p,m,t,f=null!=f?f:1)]:[3,24];case 23:v=a.sent(),a.label=24;case 24:return Oe.log("filteredOccurrenes"),Oe.log(v),0===v.length&&Ge(),[2,v]}}))})),Re.apply(this,arguments)}function Ue(e,t,n){return Be.apply(this,arguments)}function Be(){return Be=(0,o._)((function(e,t,n){var r,o,i,s,c,l,u,d,_,p,g,f,h,C,m,v,E,y,b,T,I,P,A,D,S;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return r=(0,ie._)(t.split(":")),o=r[0],i=r.slice(1),s=de.Y.getParagraphRangeFromTileId(o,n),c=i.join(":"),l=c.length>255,u=s.search(c.substring(0,Math.min(c.length,255))),d=s.search(c.substring(Math.max(0,c.length-255),c.length)),u.load("items"),d.load("items"),[4,e.sync()];case 1:a.sent(),_=[],p=!0,g=!1,f=void 0,a.label=2;case 2:a.trys.push([2,14,15,16]),h=u.items[Symbol.iterator](),a.label=3;case 3:if(p=(C=h.next()).done)return[3,13];m=C.value,v=!0,E=!1,y=void 0,a.label=4;case 4:a.trys.push([4,10,11,12]),b=d.items[Symbol.iterator](),a.label=5;case 5:return(v=(T=b.next()).done)?[3,9]:(I=T.value,P=m.expandToOrNullObject(I),[4,e.sync()]);case 6:return a.sent(),P.isNullObject?[3,8]:(P.load("text"),[4,e.sync()]);case 7:if(a.sent(),A=P.text.replace(/\xa0/g," "),D=c.replace(/\xa0/g," "),A===D)return _.push(P),[3,9];a.label=8;case 8:return v=!0,[3,5];case 9:return[3,12];case 10:return S=a.sent(),E=!0,y=S,[3,12];case 11:try{v||null==b.return||b.return()}finally{if(E)throw y}return[7];case 12:return p=!0,[3,3];case 13:return[3,16];case 14:return S=a.sent(),g=!0,f=S,[3,16];case 15:try{p||null==h.return||h.return()}finally{if(g)throw f}return[7];case 16:return[2,{textRanges:_,isLongIndex:l}]}}))})),Be.apply(this,arguments)}function xe(e,t,n){return We.apply(this,arguments)}function We(){return We=(0,o._)((function(e,t,n){var r,o,i,s,c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return r=(0,ie._)(t.split(":")),o=r[0],i=r.slice(1),s=de.Y.getParagraphRangeFromTileId(o,n),(c=s.search(i.join(":"))).load("items"),[4,e.sync()];case 1:return a.sent(),[2,c.items]}}))})),We.apply(this,arguments)}function Fe(e){return Ne.apply(this,arguments)}function Ne(){return Ne=(0,o._)((function(e){var t,n,r,o,i,c,l,u,d;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.context,n=e.index,r=t.document.body.paragraphs,[4,t.sync()];case 1:a.sent(),o=[],a.label=2;case 2:return a.trys.push([2,7,,8]),(0,le.ULG)()?[4,Ue(t,n,r)]:[3,4];case 3:return c=a.sent().textRanges,(i=o).push.apply(i,(0,se._)(c)),[3,6];case 4:return[4,xe(t,n,r)];case 5:u=a.sent(),(l=o).push.apply(l,(0,se._)(u)),a.label=6;case 6:return o.filter((function(e){return e})),0===o.length&&((0,s.cY)("selectIndices: No paraRanges found"),Ge()),[2,o];case 7:throw d=a.sent(),(0,s.cY)("selectTextIndex: "+n+"failed because of "+d),new Error("Failed to select the text range");case 8:return[2]}}))})),Ne.apply(this,arguments)}function Ke(e){return He.apply(this,arguments)}function He(){return He=(0,o._)((function(e){var t,n,r,o,i,c,l,u,d,_,p,g,f,h,C,m,v,E,y,b,T,I,P,A,D,S,M,O,k,L,w,R,U,B,x,W,F;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:t=e.context,n=e.indices,r=(new Date).getTime(),o=0,i=0,c=0,l=0,u=0,d=0,_=0,p=0,g=0,f=0,h=0,C=[],a.label=1;case 1:a.trys.push([1,,18,19]),o=n.length,(0,s.cY)("selectIndices: indices: "+n),m=[];try{m=JSON.parse(n),i=m.length,(0,s.cY)("selectIndices: parsedIndices: "+m)}catch(e){c++,(0,s.cY)("selectIndices: Failed parsing as JSON string array because of "+e),Ge()}return v=function(e){for(var t="\n",n=0;n<e.length;n++)try{t+="Range ".concat(n,": ").concat(JSON.stringify(e[n]),"\n")}catch(e){t+="Range ".concat(n,": Failed stringifying range because of ").concat(e,"\n")}return t},E=t.document.body.paragraphs,[4,t.sync()];case 2:a.sent(),y=!0,b=!1,T=void 0,a.label=3;case 3:a.trys.push([3,15,16,17]),I=m[Symbol.iterator](),a.label=4;case 4:if(y=(P=I.next()).done)return[3,14];A=P.value,a.label=5;case 5:return a.trys.push([5,12,,13]),(0,s.cY)("selectIndices: parsing index: "+A),A.includes(":")?(l++,D=(0,ie._)(A.split(":")),S=D[0],D.slice(1),de.Y.getParagraphRangeFromTileId(S,E),(0,le.ULG)()?[4,Ue(t,A,E)]:[3,7]):[3,10];case 6:return O=a.sent(),k=O.textRanges,L=O.isLongIndex,(M=C).push.apply(M,(0,se._)(k)),u++,L&&d++,(0,s.cY)("selectIndices: parsed index: "+A+" as <paragraph ID>:<text range>, into "+v(k)),[3,9];case 7:return[4,xe(t,A,E)];case 8:R=a.sent(),(w=C).push.apply(w,(0,se._)(R)),u++,(0,s.cY)("selectIndices: parsed index: "+A+" as <paragraph ID>:<text range>, into "+v(R)),a.label=9;case 9:return[3,11];case 10:_++,U=de.Y.getParagraphRangeFromTileId(A,E),C.push(U),p++,(0,s.cY)("selectIndices: parsed index: "+A+" as <paragraph ID>, into "+v([U])),a.label=11;case 11:return[3,13];case 12:return B=a.sent(),g++,(0,s.cY)("selectIndices: parsing index: "+A+"failed because of "+B),[3,13];case 13:return y=!0,[3,4];case 14:return[3,17];case 15:return x=a.sent(),b=!0,T=x,[3,17];case 16:try{y||null==I.return||I.return()}finally{if(b)throw T}return[7];case 17:return f=C.length,(0,s.cY)("selectIndices: paraRanges before filtering: "+v(C)),C.filter((function(e){return e})),(0,s.cY)("selectIndices: paraRanges: "+v(C)),0===C.length&&((0,s.cY)("selectIndices: No paraRanges found"),Ge()),h=C.length,[2,C];case 18:return W=(new Date).getTime()-r,F="countIndices: ".concat(o,", countParsedIndices: ").concat(i,", countParsingErrors: ").concat(c,", countParaPlusTextIndices: ").concat(l,", countParaPlusTextIndicesFound: ").concat(u,", countParaIndices: ").concat(_,", countParaIndicesFound: ").concat(p,", countParsingIndexErrors: ").concat(g,", countParaRangesBeforeFiltering: ").concat(f,", countParaRangesReturned: ").concat(h,", countLongParaPlusTextIndicesFound: ").concat(d,", elapsedTime: ").concat(W," ms"),N=ue.Dh.OperationDetails,K=F,0===Object.keys(be).length&&(be=(0,s.b6)()),be[N]=K,(0,s.cY)("selectIndices: OperationDetails: "+F),[7];case 19:return[2]}var N,K}))})),He.apply(this,arguments)}function Ge(){var e=new Error("ContentNotFoundForCriteria");throw e.name=ce.RZX,e}function Qe(e){return je.apply(this,arguments)}function je(){return je=(0,o._)((function(e){var t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return t=e.context,e.textRanges.reverse().forEach((function(e){e.delete()})),[4,t.sync()];case 1:return n.sent(),[2]}}))})),je.apply(this,arguments)}function Ye(e){return ze.apply(this,arguments)}function ze(){return ze=(0,o._)((function(e){var t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return t=e.context,e.ranges.forEach((function(e){e.delete()})),[4,t.sync()];case 1:return n.sent(),[2]}}))})),ze.apply(this,arguments)}function qe(e,t,n){return n?e+t:t}function Ve(e){return Ze.apply(this,arguments)}function Ze(){return Ze=(0,o._)((function(e){var t,n,r,o,i,s,c,l,u,d,_,p,g,f,h,C,m,v,E,y,b,T,I,P,A,D,S,M,O,k,L,w,R,U,B,x,W,F,N,K,H,G,Q,j,Y,z,q,V,Z,J,X,$,ee,te,ne,re,oe,ae,ie,se,le,ue,de;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:t=e.context,n=e.textRanges,r=e.color,o=void 0===r?null:r,i=e.bold,s=void 0===i?null:i,c=e.italic,l=void 0===c?null:c,u=e.underline,d=void 0===u?null:u,_=e.fontName,p=void 0===_?null:_,g=e.size,f=void 0===g?null:g,h=e.subscript,C=void 0===h?null:h,m=e.superscript,v=void 0===m?null:m,E=e.strikeThrough,y=void 0===E?null:E,b=e.highlightColor,T=void 0===b?null:b,I=e.alignment,P=void 0===I?null:I,A=e.style,D=void 0===A?null:A,S=e.firstLineIndent,M=void 0===S?null:S,O=e.leftIndent,k=void 0===O?null:O,L=e.rightIndent,w=void 0===L?null:L,R=e.lineSpacing,U=void 0===R?null:R,B=e.hyperlink,x=void 0===B?null:B,W=e.capitalization,F=void 0===W?null:W,N=e.paragraphSpacingBefore,K=void 0===N?null:N,H=e.paragraphSpacingAfter,G=void 0===H?null:H,Q=e.relative,j=void 0!==Q&&Q,Oe.log("Formatting textRanges"),Y=[null,null,null,null,null,null,null,null,null],z=[null,null,null,null,null,null,null,null,null],q=!0,V=!1,Z=void 0,a.label=1;case 1:a.trys.push([1,23,24,25]),J=n[Symbol.iterator](),a.label=2;case 2:return(q=(X=J.next()).done)?[3,22]:($=X.value,null==P&&null==D&&null==M&&null==k&&null==w&&null==U&&null==K&&null==G?[3,17]:($.paragraphs.load("$none"),[4,t.sync()]));case 3:a.sent(),ee=!0,te=!1,ne=void 0,a.label=4;case 4:a.trys.push([4,15,16,17]),re=$.paragraphs.items[Symbol.iterator](),a.label=5;case 5:return(ee=(oe=re.next()).done)?[3,14]:((ae=oe.value).load(["firstLineIndent","leftIndent","rightIndent","lineSpacing","spaceBefore","spaceAfter"]),[4,t.sync()]);case 6:return a.sent(),null!=M&&(ae.firstLineIndent=qe(ae.firstLineIndent,M,1==j)),null!=k&&(ae.leftIndent=qe(ae.leftIndent,k,1==j)),null!=w&&(ae.rightIndent=qe(ae.rightIndent,w,1==j)),null!=U&&(ae.lineSpacing=12*qe(ae.lineSpacing/12,U,1==j)),null!=K&&(ae.spaceBefore=qe(ae.spaceBefore,K,1==j)),null!=G&&(ae.spaceAfter=qe(ae.spaceAfter,G,1==j)),null==D?[3,12]:(ae.load("styleBuiltIn"),[4,t.sync()]);case 7:return a.sent(),"ParagraphReset"!=D?[3,8]:(Oe.log("Resetting paragraph formatting"),ae.isListItem||(ae.firstLineIndent=0,ae.leftIndent=0),[3,12]);case 8:return"ListReset"!=D?[3,11]:ae.isListItem?(ae.list.load("levelExistences, levelTypes"),[4,t.sync()]):[3,10];case 9:for(a.sent(),ie=ae.list.levelExistences,se=0;se<ie.length;se++)ae.list.setLevelAlignment(se,Word.Alignment.left),ae.list.levelTypes[se]==Word.ListLevelType.bullet&&ae.list.setLevelBullet(se,se%2==0?Word.ListBullet.solid:Word.ListBullet.hollow),ie[se]&&(null==Y[se]?(Oe.log(ae.list.getLevelParagraphs(se)),Y[se]=38*(se+1),z[se]=-19,Oe.log("Level ".concat(se," indent is ").concat(Y[se]," , ").concat(z[se]))):(Oe.log("Setting level ".concat(se," indent to ").concat(Y[se]," , ").concat(z[se])),ae.list.setLevelIndents(se,Y[se],z[se])),ae.font.size=11,ae.font.name="Calibri (Body)");a.label=10;case 10:return[3,12];case 11:"FormattingReset"==D?ae.isListItem||(Oe.log("Resetting style to normal"),ae.styleBuiltIn=Word.Style.normal):(Oe.log("Changing style to ".concat(D)),ae.styleBuiltIn=D),a.label=12;case 12:null!=P&&(Oe.log("Setting alignment to ".concat(P)),ae.alignment=P,Oe.log("Set alignment to ".concat(ae.alignment))),a.label=13;case 13:return ee=!0,[3,5];case 14:return[3,17];case 15:return de=a.sent(),te=!0,ne=de,[3,17];case 16:try{ee||null==re.return||re.return()}finally{if(te)throw ne}return[7];case 17:return null!=o&&($.font.color=o),null!=s&&($.font.bold=s),null!=l&&($.font.italic=l),null!=d&&(Oe.log("Setting underline to ".concat(d)),$.font.underline=d,Oe.log("Underline set to ".concat($.font.underline))),null!=p&&($.font.name=p),null==f?[3,19]:($.load("font/size"),[4,t.sync()]);case 18:a.sent(),$.font.size=qe($.font.size,f,1==j),a.label=19;case 19:return null!=C&&($.font.subscript=C),null!=v&&($.font.superscript=v),null!=y&&(y.toUpperCase()===ce.WYm?$.font.strikeThrough=!0:y.toUpperCase()===ce.VJX&&($.font.doubleStrikeThrough=!0)),null!=T&&("none"==T.toLowerCase()?$.font.highlightColor=null:$.font.highlightColor=T),null!=x&&($.hyperlink=x),null==F?[3,21]:($.load("text"),[4,t.sync()]);case 20:a.sent(),"LowerCase"===F?$.insertText($.text.toLowerCase(),Word.InsertLocation.replace):"UpperCase"===F||"AllCaps"===F?$.insertText($.text.toUpperCase(),Word.InsertLocation.replace):"SentenceCase"===F?(le=$.text.toLowerCase(),ue=(ue=(ue=le.replace(/(^|\.)\s*([a-z])/g,(function(e){return e.toUpperCase()}))).replace(/(^|\!)\s*([a-z])/g,(function(e){return e.toUpperCase()}))).replace(/(^|\?)\s*([a-z])/g,(function(e){return e.toUpperCase()})),$.insertText(ue,Word.InsertLocation.replace)):"CapitalizeEachWord"===F?$.insertText($.text.split(" ").map((function(e){return e?e[0].toUpperCase()+e.slice(1).toLowerCase():""})).join(" "),Word.InsertLocation.replace):"ToggleCase"===F&&$.insertText($.text.split(" ").map((function(e){return e?e[0].toLowerCase()+e.slice(1).toUpperCase():""})).join(" "),Word.InsertLocation.replace),a.label=21;case 21:return q=!0,[3,2];case 22:return[3,25];case 23:return de=a.sent(),V=!0,Z=de,[3,25];case 24:try{q||null==J.return||J.return()}finally{if(V)throw Z}return[7];case 25:return[4,t.sync()];case 26:return a.sent(),[2]}}))})),Ze.apply(this,arguments)}function Je(e,t,n){return Xe.apply(this,arguments)}function Xe(){return Xe=(0,o._)((function(e,t,n){var r,o,i,s,c,l=arguments;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:for(r=l.length>3&&void 0!==l[3]?l[3]:"End",o=[],i=t.length-1;i>=0;i--)s=n.replace(/\\n/g,"\n"),c=t[i].insertText(s,r),o.push(c);return[4,e.sync()];case 1:return a.sent(),Oe.log("insertedTextRanges = ",o),[2,o]}}))})),Xe.apply(this,arguments)}function $e(e){return et.apply(this,arguments)}function et(){return et=(0,o._)((function(e){var t,n,r,o,i,s,c,l,u;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return t=e.context,n=e.precededBy,r=void 0===n?null:n,o=e.text,i=e.insertLocation,s=void 0===i?"End":i,c=[],null!=r?[3,2]:(r=[t.document.body.getRange("Start")],[4,t.sync()]);case 1:a.sent(),a.label=2;case 2:if((0,le.OiA)())return[2,Je(t,r,o,null!=s?s:"End")];for(l=0;l<r.length;l++)u=null,"After"==s&&o.startsWith("\n")?(Oe.log("Inserting paragraph after precededBy"),u=(u=r[l].insertParagraph("",s).getRange()).insertText(o.substring(1),"Replace")):"Before"==s&&o.endsWith("\n")?(Oe.log("Inserting paragraph before precededBy"),u=(u=r[l].insertParagraph("",s).getRange()).insertText(o.substring(0,o.length-1),"Replace")):(Oe.log("Inserting text ".concat(s.toLowerCase()," precededBy")),u=r[l].insertText(o,s)),c.push(u);return[4,t.sync()];case 3:return a.sent(),Oe.log("insertedTextRanges"),Oe.log(c),[2,c]}}))})),et.apply(this,arguments)}function tt(e){return nt.apply(this,arguments)}function nt(){return nt=(0,o._)((function(e){var t,n,r,o,i,s,c,l,u,d,_,p,g,f,h,C;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:t=e.context,n=e.textRanges,r=void 0===n?null:n,o=e.style,Oe.log("START: rewriteText"),null==r&&(Oe.log("No text provided, fallback to current selection"),r=[t.document.getSelection()],Oe.log("Got selected text")),i="Human: I have the following text - \n",s=!0,c=!1,l=void 0,a.label=1;case 1:a.trys.push([1,6,7,8]),u=r[Symbol.iterator](),a.label=2;case 2:return(s=(d=u.next()).done)?[3,5]:((_=d.value).load("text"),[4,t.sync()]);case 3:a.sent(),i+=_.text,a.label=4;case 4:return s=!0,[3,2];case 5:return[3,8];case 6:return p=a.sent(),c=!0,l=p,[3,8];case 7:try{s||null==u.return||u.return()}finally{if(c)throw l}return[7];case 8:return i+="\n\nHuman: Rewrite the text in the style of "+o+"\n\nAssistant:\n",Oe.log("Full text: "+i),g={Request:i},f=encodeURI(Mt+"/"+St),[4,fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}).then((function(e){return e.json()}))];case 9:return h=a.sent(),Oe.log("\nresponse:\n:"),Oe.log(h.message),C=h.message,Qe({context:t,textRanges:r}),$e({context:t,precededBy:r,text:C,insertLocation:"Before"}),[4,t.sync()];case 10:return a.sent(),Oe.log("END: rewriteText"),[2,r]}}))})),nt.apply(this,arguments)}var rt=n(758651);function ot(e){return at.apply(this,arguments)}function at(){return(at=(0,o._)((function(e){var t,n,r,o,i,s,c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(!e||!e.context||!e.precededBy)throw rt.log("Invalid arguments in insertList"),new Error("Invalid arguments in insertList");if(rt.log("START: insertList"),0===e.precededBy.length)throw rt.log("No text range is passed to insertList"),new Error("No text range is passed to insertList");t=!0,n=!1,r=void 0,a.label=1;case 1:a.trys.push([1,6,7,8]),o=e.precededBy[Symbol.iterator](),a.label=2;case 2:return(t=(i=o.next()).done)?[3,5]:((s=i.value).paragraphs.load(["items","isListItem"]),[4,e.context.sync()]);case 3:a.sent(),s.paragraphs.items.forEach((function(e){e.isListItem?rt.log("Paragraph is already a list item"):e.startNewList()})),a.label=4;case 4:return t=!0,[3,2];case 5:return[3,8];case 6:return c=a.sent(),n=!0,r=c,[3,8];case 7:try{t||null==o.return||o.return()}finally{if(n)throw r}return[7];case 8:return rt.log("END: insertList"),[2]}}))}))).apply(this,arguments)}function it(e){return st.apply(this,arguments)}function st(){return(st=(0,o._)((function(e){var t,n,r,o,i,s,c,l,u,d,_,p,g,f,h,C,m,v;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:if(!e||!e.context||!e.ranges)throw rt.log("Invalid arguments in formatList"),new Error("Invalid arguments in formatList");if(rt.log("START: formatList"),0===e.ranges.length)throw rt.log("No text range is passed to formatList"),new Error("No text range is passed to formatList");t=!0,n=!0,r=!1,o=void 0,a.label=1;case 1:a.trys.push([1,16,17,18]),i=e.ranges[Symbol.iterator](),a.label=2;case 2:return(n=(s=i.next()).done)?[3,15]:(c=s.value,(l=c.paragraphs).load("items"),[4,e.context.sync()]);case 3:a.sent(),u=!0,d=!1,_=void 0,a.label=4;case 4:a.trys.push([4,12,13,14]),p=l.items[Symbol.iterator](),a.label=5;case 5:return(u=(g=p.next()).done)?[3,11]:(f=g.value).isListItem?(f.load(["list","listItem","isListItem","listItem/level"]),[4,e.context.sync()]):[3,7];case 6:return a.sent(),h=f.list,(m=null!==(C=e.listLevel)&&void 0!==C?C:f.listItem.level)!==f.listItem.level&&(f.listItem.level=m),e.listLevelAlignment&&h.setLevelAlignment(m,e.listLevelAlignment),e.listLevelBullet&&h.setLevelBullet(m,e.listLevelBullet),e.listLevelNumbering&&(h.setLevelNumbering(m,e.listLevelNumbering),t&&(h.setLevelStartingNumber(m,1),t=!1)),[3,8];case 7:rt.log("Paragraph is not a list item, Making it a list item"),a.label=8;case 8:return[4,e.context.sync()];case 9:a.sent(),a.label=10;case 10:return u=!0,[3,5];case 11:return[3,14];case 12:return v=a.sent(),d=!0,_=v,[3,14];case 13:try{u||null==p.return||p.return()}finally{if(d)throw _}return[7];case 14:return n=!0,[3,2];case 15:return[3,18];case 16:return v=a.sent(),r=!0,o=v,[3,18];case 17:try{n||null==i.return||i.return()}finally{if(r)throw o}return[7];case 18:return rt.log("END: formatList"),[2]}}))}))).apply(this,arguments)}var ct=n(86207),lt=n(956775),ut="image/png",dt="data:".concat(ut,";base64,");function _t(e,t,n,r){return pt.apply(this,arguments)}function pt(){return pt=(0,o._)((function(e,t,n,r){var o;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return(o=t.getRange(ce.Zp6).intersectWith(r)).load("text"),[4,e.sync()];case 1:return a.sent(),[2,{index:n,text:o.text}]}}))})),pt.apply(this,arguments)}function gt(e,t){return ft.apply(this,arguments)}function ft(){return ft=(0,o._)((function(e,t){var n,r,o,i,s,c,l,u,d,_,p,g,f,h;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return t?(t.load("\n      rowCount,\n      values\n    "),[4,e.sync()]):[2,""];case 1:if(a.sent(),0==t.rowCount)return[2,""];n="",r=!0,o=!1,i=void 0;try{for(s=t.values[Symbol.iterator]();!(r=(c=s.next()).done);r=!0){l=c.value,u="",d=!0,_=!1,p=void 0;try{for(g=l[Symbol.iterator]();!(d=(f=g.next()).done);d=!0)h=f.value,u+=h+"\t"}catch(e){_=!0,p=e}finally{try{d||null==g.return||g.return()}finally{if(_)throw p}}n+=u+"\n"}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return[2,n.trim()]}}))})),ft.apply(this,arguments)}function ht(){return ht=(0,o._)((function(e){var t,n,r,o,i,c,l,u,d,_,p,g,f,h,C,m,v,E,y,b,T,I,P,A,D,S,M,O,k,L;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:t={displayText:"",objectTypes:[],paragraphs:[],pictures:[]},(n=e.document.getSelection()).load("\n      isEmpty,\n      text,\n      paragraphs/items,\n      lists/items,\n      tables/items,\n      inlinePictures/items\n    "),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e.sync()];case 2:return a.sent(),[3,4];case 3:throw r=a.sent(),(0,s.cY)("Error with getSelection() from Word API, possibly due to shape selection: ".concat(r)),r;case 4:if(n.isEmpty)return[2,void 0];o=new Set,i=!1,c=0==n.tables.items.length,l=0,a.label=5;case 5:return l<n.paragraphs.items.length?((u=n.paragraphs.items[l]).load("\n        tableNestingLevel,\n        isListItem,\n        inlinePictures/items,\n      "),[4,e.sync()]):[3,13];case 6:return a.sent(),0!=u.tableNestingLevel?o.add(ct.G.Table):u.isListItem?o.add(ct.G.List):u.inlinePictures.items.length>0?o.add(ct.G.Picture):o.add(ct.G.Plaintext),0!=u.tableNestingLevel?[3,8]:(i&&(i=!1),_=(d=t.paragraphs).push,[4,_t(e,u,l,n.getRange(ce.Zp6))]);case 7:return _.apply(d,[a.sent()]),[3,12];case 8:return i?[3,12]:(i=!0,c?(u.load("parentTable"),[4,e.sync()]):[3,10]);case 9:a.sent(),a.label=10;case 10:return p=c?u.parentTable:n.tables.items.shift(),f={index:l},[4,gt(e,p)];case 11:f.text=a.sent(),g=f,t.paragraphs.push(g),a.label=12;case 12:return l++,[3,5];case 13:if(!(0,le.QX7)())return[3,23];if(!(n.inlinePictures.items.length>0))return[3,23];h=!0,C=!1,m=void 0,a.label=14;case 14:a.trys.push([14,20,21,22]),v=n.inlinePictures.items[Symbol.iterator](),a.label=15;case 15:return(h=(E=v.next()).done)?[3,19]:(y=E.value,b=y.getBase64ImageSrc(),[4,e.sync()]);case 16:return a.sent(),T="".concat(dt).concat(b.value),[4,(I=new lt.ImageResizer).ResizeImage(T,void 0,void 0,void 0,void 0,void 0,ut)];case 17:if(a.sent(),!(P=I.base64ResizedImage))throw new Error("Something went wrong with image resizing. Check telemetry for ImageResizerFailure.");t.pictures.push({base64String:P}),a.label=18;case 18:return h=!0,[3,15];case 19:return[3,22];case 20:return A=a.sent(),C=!0,m=A,[3,22];case 21:try{h||null==v.return||v.return()}finally{if(C)throw m}return[7];case 22:o.add(ct.G.Picture),a.label=23;case 23:D=!0,S=!1,M=void 0;try{for(O=t.paragraphs[Symbol.iterator]();!(D=(k=O.next()).done);D=!0)if((L=k.value).text&&L.text.trim().length>0){t.displayText=L.text;break}}catch(e){S=!0,M=e}finally{try{D||null==O.return||O.return()}finally{if(S)throw M}}return 0!=t.displayText.length||o.has(ct.G.Picture)?(n.lists.items.length>0&&o.add(ct.G.List),t.displayText.length>0&&!o.has(ct.G.Table)&&!o.has(ct.G.List)&&o.add(ct.G.Plaintext),o.has(ct.G.Picture)&&1==o.size&&(t.paragraphs=[]),t.objectTypes=Array.from(o),[2,{selection:t}]):[2,void 0]}}))})),ht.apply(this,arguments)}const Ct=function(e){return ht.apply(this,arguments)};var mt=n(722603),vt=n(156845),Et=n(758651);function yt(e){mt.i.isWebPlatform()?Office.context.ui.executeFeature(e?ce.na4:ce.hW2):(mt.i.isWin32Platform()||mt.i.isMacPlatform()||mt.i.isIOSPlatform())&&Office.context.ui.executeFeature(e?ce.VGH:ce.bY3)}function bt(e){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:if(Et.log("START undoApplication"),!e.context)throw Et.error("Context is undefined"),new Error("Context is undefined");return(0,le.$J1)()?(yt(!0),[3,3]):[3,1];case 1:return[4,(0,vt.p9)()];case 2:t.sent(),t.label=3;case 3:return Et.log("END undoApplication"),[2]}}))}))).apply(this,arguments)}function It(e){return Pt.apply(this,arguments)}function Pt(){return(Pt=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){if(Et.log("START redoApplication"),!e.context)throw Et.error("Context is undefined"),new Error("Context is undefined");return yt(!1),Et.log("END redoApplication"),[2]}))}))).apply(this,arguments)}var At,Dt=n(758651),St="chatGPT",Mt="https://pptcopilotserver.azurewebsites.net",Ot="sd",kt={selectText:(At=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,we(e)];case 1:return[2,t.sent()]}}))})),function(e){return At.apply(this,arguments)}),selectIndices:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,Ke(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectTextIndex:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,Fe(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectRanges:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,we(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertText:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,$e(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),formatText:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,Ve(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteText:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,Qe(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteRanges:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,Ye(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),rewriteText:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,tt(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertOperation:function(e){Dt.log("In Insert Operation")},replaceOperation:function(e){Dt.log("In Replace Operation")},deleteOperation:function(e){Dt.log("In Delete Operation")},insertComments:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In insertComments"),[4,Z(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteComments:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In deleteComments"),[4,X(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectComments:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In selectComments"),[4,ee(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),formatComments:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In formatComments"),[4,ne(e)];case 1:return t.sent(),[2,Promise.resolve()]}}))}));return function(t){return e.apply(this,arguments)}}(),insertTables:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Insert Table Operation"),[4,C(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),selectTables:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Select Table Operation"),[4,E(e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteColumns:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Delete Column Operation"),[4,I(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteRows:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Delete Table Operation"),[4,S(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),mergeTables:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Merge Table Operation"),[4,F(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),formatTables:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Format Table Operation"),[4,x(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),splitCellForTables:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Split Cell For Table Operation"),[4,K(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),deleteTables:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Delete table Operation"),[4,G(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),insertRows:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Insert Rows Operation"),[4,j(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),insertColumns:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Insert Column Operation"),[4,z(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),insertList:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Insert List Operation"),[4,ot(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),formatList:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Format List Operation"),[4,it(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),undoApplication:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Undo Application Operation"),[4,bt(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),redoApplication:function(){var e=(0,o._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return Dt.log("In Redo Application Operation"),[4,It(e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}()}},57796:(e,t,n)=>{"use strict";n.d(t,{K:()=>oe});var r=n(990813),o=n(857835),a=n(461838),i=n(851348),s=n(208520),c=n(428535),l=n(209123),u=n(602061),d=n(423905),_=n(448397),p=n(140889),g=n(798050),f=n(740389),h=n(743032),C=n(379490),m=n(342840),v=n(962304),E=n(822446),y=n(242154),b=n(600727),T=n(89843),I=n(334130),P=n(61714),A=n(457476),D={feedbackArea:"",invocationTimestamp:Date.now(),contextData:{entryPoint:I.K.Chat}};const S=function(e,t,n,r,o,a,i){return(0,s.useMemo)((function(){if(!e)return{copyButton:null,feedbackButtons:null};var s=(0,P.A)(),c=_.B.getInstance();return{copyButton:(0,b.e)({onCopyButtonClick:function(r,o){var a=p.a5.InsightsCardCopyButtonClicked.replace("{TabName}",t.current);c.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:a}]),e.copyButtonClicked("".concat(s,"_").concat(t.current),r,o),n(t.current)}}),feedbackButtons:(0,f.HHe)()?(0,A.n)(e,r,o,a,i):(0,T.J)({handleThumbsUpClick:a,handleThumbsDownClick:i}),htmlMessageContentElementId:s}}),[e])};var M=n(86511);function O(e,t){var n=(0,s.useRef)({}),r=(0,s.useRef)({}),o=(0,s.useRef)({}),a=(0,s.useRef)({}),c=_.B.getInstance(),l=s.useMemo((function(){return e.reduce((function(e,t){return e[t.tabValue]=t.contentState,e}),{})}),[e]);s.useEffect((function(){if(e){var r=t(),o=a.current;Object.entries(l).forEach((function(t){var a=(0,i._)(t,2),s=a[0],l=a[1];if(void 0!==o[s]&&o[s]!==l){var _=(0,u.Izi)(s,e);_&&(c.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:(0,u.$SW)(_.skill,p.a5.InsightsCardCocoaSkillState)},{key:p.h3.ChatEventParameters,value:g.x[l]}]),l===g.x.LOADED&&(n.current[s]=!0,E.isSDXRenderingForPreload||r!==s||d(_)))}})),a.current=l}}),[l,e]);var d=function(e){!r.current[e.tabValue]&&n.current[e.tabValue]&&(r.current[e.tabValue]=!0,c.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:(0,u.$SW)(e.skill,p.a5.InsightsCardCocoaSkillShown)}]),c.logSeenEvent(void 0,p.CC.ChatQnA,M.RX.Ask,(0,u.$SW)(e.skill,p.nk.ContentCardCocoaSkill)))};return{logCocoaSkillSeenTelemetry:function(t){var n=(0,u.Izi)(t,e);n?d(n):c.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardUnknownRendered}])},logCocoaSkillTriedTelemetry:function(t){var n,r=(0,u.Izi)(t,e);r&&(n=r,o.current[n.tabValue]||(o.current[n.tabValue]=!0,c.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:(0,u.$SW)(n.skill,p.a5.InsightsCardCocoaSkillShown)}]),c.logTriedEvent(void 0,p.CC.ChatQnA,M.RX.Ask,(0,u.$SW)(n.skill,p.nk.ContentCardCocoaSkill),[{key:M.qN,value:n.queryId}])))},logCocoaSkillKeptTelemetry:function(t){var n=p.CC.CopilotChat,r=p.nk.Unset,o=void 0,a=(0,u.Izi)(t,e);a&&(n=p.CC.ChatQnA,r=(0,u.$SW)(a.skill,p.nk.ContentCardCocoaSkill),o=M.RX.Ask),c.logKeptEvent(n,r,o)},getCocoaSkillFeedbackInfo:function(t){var n=p.CC.CopilotChat,r=p.nk.Unset,o=(0,u.Izi)(t,e);return o&&(n=p.CC.ChatQnA,r=(0,u.$SW)(o.skill,p.nk.ContentCardCocoaSkill)),{featureName:n,subFeatureName:r}}}}function k(e,t,n,r,i,s,c,l,u,d,g){var f,b=_.B.getInstance(),T=(f=(0,h._)((function(e){return(0,C.__generator)(this,(function(t){return E.isSDXRenderingForPreload||R(e),[2]}))})),function(e){return f.apply(this,arguments)}),I=O(g,t),P=I.logCocoaSkillSeenTelemetry,A=I.logCocoaSkillTriedTelemetry,S=I.logCocoaSkillKeptTelemetry,M=I.getCocoaSkillFeedbackInfo,k=function(e,t,n){return(0,a._)((0,o._)({},e),{contextData:(0,a._)((0,o._)({},e.contextData),{featureName:t,subFeatureName:n})})},L=function(e,t){return JSON.stringify({featureName:e,subFeatureName:t})},w=function(t,o){var a=void 0;switch(t){case l():a=c.feedbackInfo;break;case r():a=n.feedbackInfo;break;case s():a=i.feedbackInfo;break;case d():a=u.feedbackInfo;break;default:a=M(t)}a&&e.feedbackButtonClicked(o?v.Gb.LIKE:v.Gb.DISLIKE,k(D,p.CC.ChatAgents,p.nk.ContentCardAgents),L(p.CC.ChatAgents,p.nk.ContentCardAgents))},R=function(){var e=(0,h._)((function(e){return(0,C.__generator)(this,(function(t){switch(e){case l():c.logSeen();break;case r():n.logSeen();break;case s():i.logSeen();break;case d():u.logSeen();break;default:P(e)}return[2]}))}));return function(t){return e.apply(this,arguments)}}();return(0,m.A)((0,h._)((function(){var e;return(0,C.__generator)(this,(function(n){return(e=t())&&R(e),[2]}))}))),{logCocoaSkillSeenTelemetry:P,logCocoaSkillTriedTelemetry:A,logFeedbackButtonClickTelemetry:w,logKeptTelemetry:function(e){switch(e){case l():c.logKept();break;case r():n.logKept();break;case s():(0,y.cY)("logKeptTelemetry for related files"),i.logKept();break;case d():u.logKept();break;default:S(e)}},logFirstCardRenderedTelemetry:T,getSCCFeedbackData:function(){var e,o,a,_,p;switch(t()){case l():e=c.feedbackInfo;break;case r():e=n.feedbackInfo;break;case s():e=i.feedbackInfo;break;case d():e=u.feedbackInfo;break;default:e=M(t())}if(e)return o=e.featureName,a=e.subFeatureName,p=k(D,o,a),{appData:L(o,a),feedbackArea:p.feedbackArea,featureName:o,subFeatureName:a,entryPoint:p.contextData.entryPoint,integrationSource:null===(_=p.contextData)||void 0===_?void 0:_.integrationSource,contextData:JSON.stringify(p.contextData)}},handleThumbsUpClick:function(){var e=p.a5.InsightsCardThumbsUpButtonClicked.replace("{TabName}",t());b.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:e}]),w(t(),!0)},handleThumbsDownClick:function(){var e=p.a5.InsightsCardThumbsUpButtonClicked.replace("{TabName}",t());b.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:e}]),w(t(),!1)}}}var L,w=n(938094),R=n(849080),U=n(784567),B=n(147903),x=n(308142),W=n(871598),F=n(844807),N=n(862853),K=n(249002),H=n(124857),G=n(309964),Q=n(934761),j=n(910480),Y=n(769449),z="39391841-ece1-4226-a02e-8504fbc25c47",q="Word - Content Card";!function(e){e.AGENT_OPEN_BUTTON_CLICKED="agent_open_button_clicked",e.VIEW_MORE_AGENTS_CLICKED="view_more_agents_clicked",e.EXPLORE_AGENTS_CLICKED="explore_agents_clicked"}(L||(L={}));var V=n(192318);var Z=n(932554),J=n(244157),X=n(267836);var $=n(280205),ee=n(722603),te=n(111246),ne=n(758651);var re=n(758651);function oe(e,t,n){var m=_.B.getInstance(),v=s.useRef(!1),b=s.useCallback((function(){var e,t=Z.Vv.getSetting(Z.zj.InitialWordCount),n=t>=J.Gj,o=(0,N.q0)(),a=(0,f.$3p)(),i=(0,u.yu7)(),s=(null==i?void 0:i.isDke)||!1===(null==i?void 0:i.hasExtractForUser),c=a&&n&&o&&!s;c&&!1===v.current&&(v.current=!0,(0,y.cY)("here: shouldShowInsightsCard fg: ".concat(a," wordCount:").concat(t," isUserEnterprise:").concat(o," isDKEOrNonExtractable: ").concat(s)),_.B.getInstance().sendChatEventTelemetry((0,d.pN)((e={},(0,r._)(e,p.h3.ChatEventType,p.a5.InsightsCardCheckPassedFromClient),(0,r._)(e,p.h3.ChatEventParameters,"".concat(t)),e))));return c}),[]),T=(0,c.O)((0,s.useCallback)((function(e){return null==rt?void 0:rt(e)}),[]),(0,s.useCallback)((function(e,t,n){return null==ot?void 0:ot(e,t,n)}),[])),I=T.getContent,A=T.updateContent,D=T.getTabType,O=T.getTabTitle,oe=T.getTabValue,ae=T.cardContentState,ie=T.setQueryMetadata,se=T.getQueryId,ce=T.onRetry,le=T.onTimeout,ue=(0,u.gBO)((0,s.useCallback)((function(e){return null==ct?void 0:ct(e)}),[]),(0,s.useCallback)((function(e,t,n){return null==lt?void 0:lt(e,t,n)}),[])),de=ue.getRelatedFilesContent,_e=ue.updateRelatedFilesContent,pe=ue.getRelatedFilesTabType,ge=ue.getRelatedFilesTabTitle,fe=ue.getRelatedFilesTabValue,he=ue.relatedFilesContentState,Ce=ue.getQueryId,me=ue.setQueryMetadata,ve=ue.onRetry,Ee=ue.onTimeout,ye=(0,u.oUt)(me),be=ye.callCFDRelatedFilesSignal,Te=ye.handleCFDRelatedFilesResponse,Ie=(0,l.O)((0,s.useCallback)((function(e){return null==ft?void 0:ft(e)}),[]),(0,s.useCallback)((function(e,t,n){return null==ht?void 0:ht(e,t,n)}),[])),Pe=Ie.getContent,Ae=Ie.updateContent,De=Ie.getTabType,Se=Ie.getTabTitle,Me=Ie.getTabValue,Oe=Ie.cardContentState,ke=Ie.setQueryMetadata,Le=Ie.getQueryId,we=Ie.onRetry,Re=Ie.onTimeout,Ue=function(e,t,n){var c,l=(0,i._)((0,s.useState)({sections:[],markdownSummary:u.u1i,references:[]}),2),d=l[0],m=l[1],v=(0,i._)((0,s.useState)(g.x.LOADING),2),b=v[0],T=v[1],I=(0,s.useRef)({queryId:u.u1i,querySubmitTime:-1,isRetryQuery:!1}),A=(0,s.useRef)([]),D=(0,s.useRef)(void 0),S=(0,s.useRef)(!1),O=(0,s.useRef)(g.x.LOADING),k=(0,s.useRef)(!1),L=(0,s.useRef)({sections:[],markdownSummary:u.u1i,references:[]}),Z=(0,s.useRef)(g.x.LOADING),J=(0,w.x)(),X=J.summaryLabel,$=J.summaryValue,ee=(0,s.useRef)(!1),te=_.B.getInstance(),ne=function(){var e;return null===(e=I.current)||void 0===e?void 0:e.queryId},re=(0,u.$Cv)({seenEvent:function(){ee.current&&(te.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardSummaryShown}]),te.logSeenEvent(M.rf.QAandSummaries,p.CC.Summary,M.RX.Summarize,p.nk.ContentCardSummary))},triedEvent:function(){var e=[{key:M.qN,value:ne()}];te.logTriedEvent(void 0,p.CC.Summary,M.RX.Summarize,p.nk.ContentCardSummary,e)},keptEvent:function(){te.logKeptEvent(p.CC.Summary,p.nk.ContentCardSummary,M.RX.Summarize)},getQueryId:ne,startedFetchingRef:ee,feedbackInfo:{featureName:p.CC.Summary,subFeatureName:p.nk.ContentCardSummary}}),oe=function(e){O.current=e,T(e)},ae=(0,j.throttle)((function(e,t){(0,y.cY)("InsightsCard setContent"),m((function(t){return(0,a._)((0,o._)({},t),{markdownSummary:(null==t?void 0:t.markdownSummary)+(null==e?void 0:e.markdownSummary),references:null==e?void 0:e.references})})),t&&oe(t)}),1e3),ie=(0,s.useCallback)((function(e,t,n){var i;D.current||(D.current=e);var s=null!==(i=D.current)&&void 0!==i?i:e;if(s===e){var c,l=n===g.x.UPDATING;b!==g.x.TIMEDOUT&&!k.current||S.current?l?ae(t,n):(m((function(e){return(0,a._)((0,o._)({},e),{markdownSummary:null==t?void 0:t.markdownSummary,references:null==t?void 0:t.references})})),n&&oe(n)):(L.current=(0,a._)((0,o._)({},L.current),{markdownSummary:l?(null===(c=L.current)||void 0===c?void 0:c.markdownSummary)+(null==t?void 0:t.markdownSummary):null==t?void 0:t.markdownSummary}),n&&(Z.current=n)),pe(n,e)}else{var u;te.sendChatEventTelemetry((0,Y.pN)((u={},(0,r._)(u,p.h3.ChatEventType,p.a5.InsightsCardDiscardedSummaryResponseReceived),(0,r._)(u,p.h3.UserQueryGuid,e),(0,r._)(u,p.h3.ChatEventParameters,"currentActiveQueryId: ".concat(s)),u)))}}),[Z,b,L,d]),se=(0,s.useCallback)((function(){return(0,R.D)({interactiveSummaryProps:d})}),[d]),ce=function(){return $},le=function(e,t,n){I.current={queryId:e,querySubmitTime:t,isRetryQuery:n},A.current.push(I.current)},ue=(0,s.useCallback)((function(e){var t;oe(g.x.TIMEDOUT),S.current=!1,k.current=!0,(0,y.cY)("Summary tab timedout for InsightsCard. IsRetry: ".concat(e)),te.sendChatEventTelemetry((0,Y.pN)((t={},(0,r._)(t,p.h3.ChatEventType,e?p.a5.InsightsCardRetrySummaryTimedOut:p.a5.InsightsCardSummaryTimedOut),(0,r._)(t,p.h3.UserQueryGuid,I.current.queryId),t)))}),[]),de=(0,s.useCallback)((c=(0,h._)((function(n){var o,a,i,s,c,l,d,_,g;return(0,C.__generator)(this,(function(h){switch(h.label){case 0:return(0,f.$3p)()&&(0,f.vM4)()&&t()?(a=(0,P.A)(),s=B.gQ.bind,c={queryId:a,doNotStream:!1,isProactive:!0},(0,N.q0)()?[4,(0,u.Ebk)((function(){return(0,K.Mo)()}))]:[3,2]):((0,y.cY)("Did not invoke InsightsCard summary. enableInsightsCard: ".concat((0,f.$3p)(),", enableInsightsCardSummary: ").concat((0,f.vM4)(),", shouldShowInsightsCard: ").concat(t())),[2]);case 1:return l=h.sent(),[3,3];case 2:l=void 0,h.label=3;case 3:return i=new(s.apply(B.gQ,[void 0,(c.copilotInputConfig=l,c.userPromptRequestedLanguage=(0,H.mf)(),c.useCitations=!0,c.clientScenario=x.F.AppChatContentCard,c.outputFormat=x.B.Keypoints,c.skipCache=!1,c.scenarioInfo={scenarioId:z,scenarioName:q},c)])),d=new U.g0({parentPath:["Signal",B.gQ.getTypeName()],items:[{id:F.r.generateId(),body:new B.gQ(i)}]}),Q.P.getInstance().addToSkipContextCheckList(a),V.p4.getCurrentInstance().addQueryIdToSkipTimerReset(a),null===(o=e.current)||void 0===o||o.submitOperation({operation:d,workflowAnnotationType:W.H.getTypeName()},!0),le(a,Date.now(),n),te.sendChatEventTelemetry((0,Y.pN)((_={},(0,r._)(_,p.h3.ChatEventType,p.a5.InsightsCardSummaryInvoked),(0,r._)(_,p.h3.UserQueryGuid,a),_))),(0,y.cY)("Summarization operation (isRetry call: ".concat(n,") for InsightsCard submitted ").concat(d)),te.sendChatEventTelemetry((0,Y.pN)((g={},(0,r._)(g,p.h3.ChatEventType,n?p.a5.RetrySummarizationOperationForInsightsCardSubmitted:p.a5.SummarizationOperationForInsightsCardSubmitted),(0,r._)(g,p.h3.UserQueryGuid,a),g))),[2]}}))})),function(e){return c.apply(this,arguments)}),[]),_e=(0,s.useCallback)((function(){var e,t;oe(g.x.LOADING),S.current=!0,k.current=!1;var n,o=!1;(null===(t=L.current)||void 0===t||null===(e=t.sections)||void 0===e?void 0:e.length)>0&&Z.current?(m(L.current),oe(Z.current),o=!0):de(!0),(0,y.cY)("Retried Summary for InsightsCard. isBackupContentAvailable: ".concat(o)),te.sendChatEventTelemetry((0,Y.pN)((n={},(0,r._)(n,p.h3.ChatEventType,p.a5.InsightsCardRetrySummaryClicked),(0,r._)(n,p.h3.ChatEventParameters,"isBackupContentAvailable: ".concat(o)),n)))}),[]),pe=(0,s.useCallback)((function(e,t){var n,o=null===(n=A.current)||void 0===n?void 0:n.find((function(e){return e.queryId===t}));if(!(e!==g.x.LOADED&&e!==g.x.UPDATING||(null==o?void 0:o.querySubmitTime)<0)){var a,i,s=(0,u.xJq)(null==o?void 0:o.querySubmitTime);te.sendChatEventTelemetry((0,Y.pN)((a={},(0,r._)(a,p.h3.ChatEventType,(null==o?void 0:o.isRetryQuery)?p.a5.InsightsCardRetrySummaryLoaded:p.a5.InsightsCardSummaryLoaded),(0,r._)(a,p.h3.UserQueryGuid,null==o?void 0:o.queryId),(0,r._)(a,p.h3.ChatEventParameters,s),a))),(0,y.cY)("Summary tab for InsightsCard loaded in ".concat(s,"ms isRetry: ").concat(null==o?void 0:o.isRetryQuery)),e===g.x.LOADED&&te.sendLatencyTelemetry((0,Y.pN)((i={},(0,r._)(i,p.CT.FeatureName,G.S2.InsightsCardSummary),(0,r._)(i,p.CT.UserPerceivedLatency,s),(0,r._)(i,p.CT.UserQueryGuid,t),i))),o&&Object.assign(o,{querySubmitTime:-1})}}),[]);return s.useEffect((function(){switch(te.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardSummaryState},{key:p.h3.ChatEventParameters,value:g.x[b]},{key:p.h3.UserQueryGuid,value:ne()}]),b){case g.x.UPDATING:case g.x.LOADED:re.markStartedFetching(),E.isSDXRenderingForPreload||n()!==ce()||re.logSeen()}}),[b]),{getSummaryCardContent:se,updateSummaryCardContent:ie,summaryCardContentState:b,getSummaryTabTitle:function(){return X},getSummaryTabValue:ce,getSummaryTabType:function(){return g.E.SUMMARY},setSummaryQueryMetadata:le,isInsightsCardSummaryQueryId:function(e){return A.current.some((function(t){return t.queryId===e}))},onSummaryTimedOut:ue,onSummaryRetried:_e,invokeSummaryForInteractiveCard:de,getSummaryQueryMetadata:ne,getCurrentSummaryCardContentState:function(){return O.current},summaryTelemetry:re}}(t,b,(0,s.useCallback)((function(){return null==et?void 0:et()}),[])),Be=Ue.getSummaryCardContent,xe=Ue.summaryCardContentState,We=Ue.updateSummaryCardContent,Fe=Ue.getSummaryTabType,Ne=Ue.getSummaryTabTitle,Ke=Ue.getSummaryTabValue,He=Ue.setSummaryQueryMetadata,Ge=Ue.isInsightsCardSummaryQueryId,Qe=Ue.onSummaryTimedOut,je=Ue.onSummaryRetried,Ye=Ue.invokeSummaryForInteractiveCard,ze=Ue.getCurrentSummaryCardContentState,qe=Ue.summaryTelemetry,Ve=(0,u.LTG)((0,f.WqY)()),Ze=Ve.submitAugloopSignals,Je=Ve.onAugloopAnnotations,Xe=Ve.cardContentProviders,$e=s.useRef(function(){if(!(0,f.czT)()&&(0,f.$3p)()){if((0,f.vM4)())return Ke();if((0,f.tcW)())return oe();if((0,f.stP)())return fe();if((0,X.wj)(u.Sqe.EnableInsightsCardAgents))return Me();if((0,f.qNw)()&&Xe.length>0)return Xe[0].tabValue}}()),et=s.useCallback((function(){return $e.current}),[]),tt=function(e,t,n,o,a,i){var c=(0,s.useRef)(!1),l=_.B.getInstance(),d=(0,u.$Cv)({seenEvent:function(){c.current&&(l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardQnAShown}]),l.logSeenEvent(void 0,p.CC.ChatQnA,M.RX.Ask,p.nk.ContentCardSuggestedQnA))},triedEvent:function(e){var t=[{key:M.qN,value:e}];l.logTriedEvent(void 0,p.CC.ChatQnA,M.RX.Ask,p.nk.ContentCardSuggestedQnA,t)},keptEvent:function(){l.logKeptEvent(p.CC.ChatQnA,p.nk.ContentCardSuggestedQnA,M.RX.Ask)},getQueryId:t,startedFetchingRef:c,feedbackInfo:{featureName:p.CC.ChatQnA,subFeatureName:p.nk.ContentCardSuggestedQnA}}),f=s.useCallback((function(e){e.length>0?l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardSuggestedQnAZQMButtonClickedOpen}]):l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardSuggestedQnAZQMButtonClickedClosed}]),t?d.logTried():(0,y.cY)("logSuggestedQnaTriedTelemetry or getQnAQueryId is undefined")}),[]),h=s.useCallback((function(e,t,n){var o,a=n-t;l.sendChatEventTelemetry((0,Y.pN)((o={},(0,r._)(o,p.h3.ChatEventType,p.a5.InsightsCardQnALoaded),(0,r._)(o,p.h3.UserQueryGuid,e),(0,r._)(o,p.h3.ChatEventParameters,a),o))),(0,y.cY)("QnA tab for InsightsCard loaded in ".concat(a,"ms"))}),[]),C=s.useCallback((function(e){var n;a(),(0,y.cY)("QnA tab timedout for InsightsCard. IsRetry: ".concat(e)),l.sendChatEventTelemetry((0,Y.pN)((n={},(0,r._)(n,p.h3.ChatEventType,e?p.a5.InsightsCardRetryQnATimedOut:p.a5.InsightsCardQnATimedOut),(0,r._)(n,p.h3.UserQueryGuid,t()),n)))}),[a]),m=s.useCallback((function(e){i(e),(0,y.cY)("QnA tab retried for InsightsCard."),l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardRetryQnAClicked}])}),[i]);return s.useEffect((function(){switch(l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardQnAState},{key:p.h3.ChatEventParameters,value:g.x[n]},{key:p.h3.UserQueryGuid,value:t()}]),n){case g.x.UPDATING:case g.x.LOADED:d.markStartedFetching(),E.isSDXRenderingForPreload||e()!==o()||d.logSeen()}}),[n]),{qnaTelemetry:d,handleInsightsCardSuggestedQnAButtonClicked:f,logQnATabLoadTelemetry:h,onQnATimedOut:C,onQnARetried:m}}(et,se,ae,oe,le,ce),nt=tt.qnaTelemetry,rt=tt.handleInsightsCardSuggestedQnAButtonClicked,ot=tt.logQnATabLoadTelemetry,at=tt.onQnARetried,it=tt.onQnATimedOut,st=function(e,t,n,o,a,i,c){var l=(0,s.useRef)(!1),d=_.B.getInstance(),f=(0,u.$Cv)({seenEvent:function(){l.current&&(d.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardRelatedFilesShown}]),d.logSeenEvent(void 0,p.CC.ChatQnA,M.RX.Ask,p.nk.ContentCardRelatedFiles))},triedEvent:function(e){var t=[{key:M.qN,value:e}];d.logTriedEvent(void 0,p.CC.ChatQnA,M.RX.Ask,p.nk.ContentCardRelatedFiles,t)},keptEvent:function(){d.logKeptEvent(p.CC.ChatQnA,p.nk.ContentCardRelatedFiles,M.RX.Ask)},getQueryId:t,startedFetchingRef:l,feedbackInfo:{featureName:p.CC.ChatQnA,subFeatureName:p.nk.ContentCardRelatedFiles}}),m=s.useCallback((function(e){switch(e){case u.AkC.FILE_LINK_CLICKED:d.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardRelatedFilesFileLinkClicked}]);break;case u.AkC.SUGGESTED_PROMPTS_CLICKED:d.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardRelatedFilesSuggestedPromptsClicked}]);break;default:(0,y.cY)("Unhandled event type: ".concat(e))}t?f.logTried():(0,y.cY)("logRelatedFilesTriedTelemetry or getRelatedFilesQueryId is undefined")}),[]),v=s.useCallback((function(e,t,n){var o,a=n-t;d.sendChatEventTelemetry((0,Y.pN)((o={},(0,r._)(o,p.h3.ChatEventType,p.a5.InsightsCardRelatedFilesLoaded),(0,r._)(o,p.h3.UserQueryGuid,e),(0,r._)(o,p.h3.ChatEventParameters,a),o))),(0,y.cY)("RelatedFiles tab for InsightsCard loaded in ".concat(a,"ms"))}),[]),b=s.useCallback((function(e){var n;a(),(0,y.cY)("Related Files tab timed out for InsightsCard. IsRetry: ".concat(e)),d.sendChatEventTelemetry((0,Y.pN)((n={},(0,r._)(n,p.h3.ChatEventType,e?p.a5.InsightsCardRelatedFilesRetryTimedOut:p.a5.InsightsCardRelatedFilesTimedOut),(0,r._)(n,p.h3.UserQueryGuid,t()),n)))}),[a]),T=s.useCallback((function(){var e,t=(e=(0,h._)((function(){var e,t,n;return(0,C.__generator)(this,(function(r){switch(r.label){case 0:e="",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,ee.i.getDocumentUrlAsync()];case 2:return e=r.sent(),[3,4];case 3:return t=r.sent(),ne.error("Failed to fetch document URL:",t),[3,4];case 4:return n=c(e),te.$.getInstance().submitOperation({operation:n,workflowAnnotationType:$.xc.getTypeName()}),[2]}}))})),function(){return e.apply(this,arguments)});i(t),(0,y.cY)("Related Files tab retried for InsightsCard."),d.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardRetryRelatedFilesClicked}])}),[i]);return s.useEffect((function(){d.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardRelatedFilesState},{key:p.h3.ChatEventParameters,value:g.x[n]}]),n===g.x.LOADED&&(f.markStartedFetching(),E.isSDXRenderingForPreload||e()!==o()||f.logSeen())}),[n]),{relatedFilesTelemetry:f,handleInsightCardRelatedFilesTriedEvents:m,logRelatedFilesTabLoadTelemetry:v,onRelatedFilesTimedOut:b,onRelatedFilesRetried:T}}(et,Ce,he,fe,Ee,ve,be),ct=st.handleInsightCardRelatedFilesTriedEvents,lt=st.logRelatedFilesTabLoadTelemetry,ut=st.onRelatedFilesRetried,dt=st.onRelatedFilesTimedOut,_t=st.relatedFilesTelemetry,pt=function(e,t,n,o,a,i){var c=(0,s.useRef)(!1),l=_.B.getInstance(),d=(0,u.$Cv)({seenEvent:function(){c.current&&e()===o()&&(l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardAgentsShown}]),l.logSeenEvent(void 0,p.CC.ChatAgents,M.RX.Ask,p.nk.ContentCardAgents))},triedEvent:function(e){var t=[{key:M.qN,value:e}];l.logTriedEvent(void 0,p.CC.ChatAgents,M.RX.Ask,p.nk.ContentCardAgents,t)},keptEvent:function(){l.logKeptEvent(p.CC.ChatAgents,p.nk.ContentCardAgents,M.RX.Ask)},getQueryId:t,startedFetchingRef:c,feedbackInfo:{featureName:p.CC.ChatAgents,subFeatureName:p.nk.ContentCardAgents}}),f=s.useCallback((function(e){switch(e){case L.AGENT_OPEN_BUTTON_CLICKED:l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardAgentsOpenButtonClicked}]);break;case L.VIEW_MORE_AGENTS_CLICKED:l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardAgentsViewMoreAgentsClicked}]);break;case L.EXPLORE_AGENTS_CLICKED:l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardAgentsExploreAgentsClicked}]);break;default:re.error("Unhandled event type: ".concat(e)),(0,y.cY)("Unhandled event type: ".concat(e))}t?d.logTried():(re.error("getAgentsQueryId is undefined"),(0,y.cY)("getAgentsQueryId is undefined"))}),[]),h=s.useCallback((function(e,t,n){var o,a=n-t;l.sendChatEventTelemetry((0,Y.pN)((o={},(0,r._)(o,p.h3.ChatEventType,p.a5.InsightsCardAgentsLoaded),(0,r._)(o,p.h3.UserQueryGuid,e),(0,r._)(o,p.h3.ChatEventParameters,a),o))),(0,y.cY)("Agents tab for InsightsCard loaded in ".concat(a,"ms"))}),[]),C=s.useCallback((function(e){var n;a(),(0,y.cY)("Agents tab timedout for InsightsCard. IsRetry: ".concat(e)),l.sendChatEventTelemetry((0,Y.pN)((n={},(0,r._)(n,p.h3.ChatEventType,e?p.a5.InsightsCardRetryAgentsTimedOut:p.a5.InsightsCardAgentsTimedOut),(0,r._)(n,p.h3.UserQueryGuid,t()),n)))}),[a]),m=s.useCallback((function(e){i(e),(0,y.cY)("Agents tab retried for InsightsCard."),l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardRetryAgentsClicked}])}),[i]);return s.useEffect((function(){l.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardAgentsState},{key:p.h3.ChatEventParameters,value:g.x[n]}]),n===g.x.LOADED&&(d.markStartedFetching(),E.isSDXRenderingForPreload||e()!==o()||d.logSeen())}),[n]),{agentsTelemetry:d,handleInsightCardAgentsTriedEvents:f,logAgentsTabLoadTelemetry:h,onAgentsTimedOut:C,onAgentsRetried:m}}(et,Le,Oe,Me,Re,we),gt=pt.agentsTelemetry,ft=pt.handleInsightCardAgentsTriedEvents,ht=pt.logAgentsTabLoadTelemetry,Ct=pt.onAgentsRetried,mt=pt.onAgentsTimedOut,vt=function(e){if($e.current=e,e===fe()&&Rt([void 0,Ot]),(0,f.czT)()){var t=p.a5.InsightsCardFirstCardRendered.replace("{TabName}",e);m.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:t}]),It(e)}},Et=k(e,et,nt,oe,_t,fe,qe,Ke,gt,Me,Xe),yt=Et.logCocoaSkillSeenTelemetry,bt=Et.logCocoaSkillTriedTelemetry,Tt=Et.logKeptTelemetry,It=Et.logFirstCardRenderedTelemetry,Pt=Et.getSCCFeedbackData,At=Et.handleThumbsUpClick,Dt=Et.handleThumbsDownClick,St=S(e,$e,Tt,Pt,n,At,Dt),Mt=St.copyButton,Ot=St.feedbackButtons,kt=St.htmlMessageContentElementId,Lt=(0,i._)(s.useState([Mt,Ot]),2),wt=Lt[0],Rt=Lt[1],Ut=function(e){var t=p.a5.InsightsCardShowMoreButtonClicked.replace("{TabName}",e);switch(m.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:t}]),e){case Ke():qe.logTried();break;case oe():nt.logTried();break;case Me():gt.logTried();break;default:bt(e)}},Bt=function(e){switch($e.current=e,e){case oe():(0,f.czT)()?m.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardNavigateToSuggestedQnACard}]):m.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardSuggestedQnATabClicked}]),nt.logSeen(),Rt([Mt,Ot]);break;case fe():(0,f.stP)()&&m.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardNavigateToRelatedFilesCard}]),m.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardRelatedFilesTabClicked}]),Rt([void 0,Ot]),_t.logSeen();break;case Ke():(0,f.czT)()?m.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardNavigateToSummaryCard}]):m.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardSummaryTabClicked}]),Rt([Mt,Ot]),qe.logSeen();break;case Me():m.sendChatEventTelemetry([{key:p.h3.ChatEventType,value:p.a5.InsightsCardAgentsTabClicked}]),Rt([void 0,Ot]),gt.logSeen();break;default:var t=(0,u.Izi)(e,Xe);t?(t.onSelected((0,f.czT)()),yt(e)):(0,y.cY)("Unhandled tab change: ".concat(e)),Rt([Mt,Ot])}};return{actionBarButtons:wt,getQnAContent:I,qnACardContentState:ae,getRelatedFilesContent:de,relatedFilesContentState:he,callCFDRelatedFilesSignal:be,handleCFDRelatedFilesResponse:Te,cocoaSkillsCardContentProviders:Xe,submitCocoaSkillsSignals:Ze,handleCocoaSkillAnnotation:Je,getSummaryCardContent:Be,summaryCardContentState:xe,updateSummaryCardContent:We,setSummaryQueryMetadata:He,getInsightsCardProps:function(){var e;if((0,f.$3p)()||(0,f.pn0)()){var t=[];return(0,f.vM4)()&&t.push({content:Be(),tabTitle:Ne(),tabValue:Ke(),tabType:Fe(),isFixedHeightTab:!0,contentState:xe,onTabLoadTimeout:Qe,onRetry:je}),(0,f.tcW)()&&t.push({content:I(),tabTitle:O(),tabValue:oe(),tabType:D(),updateContent:A,contentState:ae,setQueryMetadata:ie,onTabLoadTimeout:it,onRetry:at}),(0,f.stP)()&&t.push({content:de(),tabType:pe(),tabTitle:ge(),tabValue:fe(),updateContent:_e,contentState:he,setQueryMetadata:me,onTabLoadTimeout:dt,onRetry:ut}),(0,X.wj)(u.Sqe.EnableInsightsCardAgents)&&t.push({content:Pe(),tabTitle:Se(),tabValue:Me(),tabType:De(),updateContent:Ae,contentState:Oe,setQueryMetadata:ke,onTabLoadTimeout:mt,onRetry:Ct}),(0,f.qNw)()&&Xe.forEach((function(e){t.push((0,a._)((0,o._)({},e),{content:e.renderContent()}))})),{contentProviders:t,actionBarButtons:wt,cardContentElementId:kt,onTabChange:Bt,onFirstCardRendered:vt,sensitivityProps:null===(e=u.n6d.getInstance())||void 0===e?void 0:e.getSensitivity(),onShowMoreClicked:Ut,shouldShowContentCard:b()}}},isInsightsCardSummaryQueryId:Ge,getAgentsContent:Pe,agentsCardContentState:Oe,invokeSummaryForInteractiveCard:Ye,currentSelectedTab:$e,handleShowMoreClicked:Ut,getCurrentSummaryCardContentState:ze,isCardLoadedInInsightCard:function(e){return e===g.x.LOADED||e===g.x.UPDATING},shouldShowInsightsCard:b}}},57852:(e,t,n)=>{"use strict";n.d(t,{g:()=>b});var r,o,a,i=n(498483),s=n(839048),c=n(207545),l=n(265167),u=n(784567),d=n(426689),_=n(83437),p=n(660606),g=n(330743),f=n(423905),h=n(638753),C=n(822606),m=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},v=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function E(e){return m(this,void 0,void 0,(function(){var t;return v(this,(function(n){switch(n.label){case 0:return(0,p.cY)("Activating User Context Annotation"),function(){(0,p.cY)("Fetching AL Session");var e=c.kH.getSettingAsString(c.zj.AugloopSharedSessionID);o=(0,g.wB)((0,h.hX)(e)?"ALDummySession":e)}(),[4,o.activateAnnotation(i.i.getTypeName(),{callback:function(t){return function(e,t){(0,p.cY)("Entering user Context Annotation handler"),p.EG.updateTelemetryOnAnnotationReceived(i.i.getTypeName(),void 0,_.CT.UserContextResponseTime,C.u1,void 0,a);for(var n=0,r=e.items;n<r.length;n++){var o=r[n];o.body&&i.i.typeGuard(o.body)&&T(o,t)}}(t,e)}})];case 1:return t=n.sent(),r=t.token,(0,p.cY)("User Context Annotation activated with token: "+r),[2]}}))}))}function y(){return m(this,void 0,void 0,(function(){var e;return v(this,(function(t){switch(t.label){case 0:(0,p.cY)("Releasing User Context Annotation with token: "+r),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,o.releaseAnnotation(r)];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),(0,p.cY)("Error while releasing User Context Annotation: "+e),[3,4];case 4:return(0,p.cY)("User Context Released"),[2]}}))}))}function b(e){return m(this,void 0,void 0,(function(){var t,n,r,i,c;return v(this,(function(g){switch(g.label){case 0:return(0,p.cY)("Sending signal to Copilot Warmup Flow"),t=(new Date).getTime(),[4,E(e)];case 1:g.sent(),(0,p.cY)("User Context Annotation Time is "+(0,d.W)(t)),p.EG.sendLatencyTelemetry((0,f.pN)(((i={})[_.CT.UserContextAnnotationActivationTime]=(0,d.W)(t),i))),n=new u.g0({parentPath:["Signal",s.P.getTypeName()],items:[{id:l.r.generateId(),body:new s.P}]}),r=s.P.getTypeName(),(0,p.cY)("Submitting User Context signal"+JSON.stringify(n)),a=(new Date).getTime();try{o.submitOperation(n)}catch(e){(0,p.cY)("Error while submitting signal to Copilot Warmup Flow"+e)}return(0,p.cY)("User Context signal submitted..."),p.EG.sendChatEventTelemetry((0,f.pN)(((c={})[_.h3.ChatEventType]=_.a5.UserContextSignalSubmitted,c[_.h3.ChatEventParameters]=r,c))),[2]}}))}))}function T(e,t){return m(this,void 0,void 0,(function(){var n,r,o,a,i;return v(this,(function(s){switch(s.label){case 0:return(0,p.cY)("Entering user Context Annotation item handler"),e.body?(n=e.body.userType,(0,p.cY)("User Type returned is: ",n),r=null===(i=e.body)||void 0===i?void 0:i.isEUDBUser,(0,p.cY)("isEUDBUser returned is: ",r),n?(p.EG.sendChatEventTelemetry((0,f.pN)(((o={})[_.h3.ChatEventType]=_.a5.ALUserType,o[_.h3.ChatEventParameters]=(0,h.nh)(n),o))),t(n,r),[4,y()]):[3,2]):[2];case 1:return s.sent(),(0,p.cY)("User Context Annotation Released"),[3,3];case 2:p.EG.sendChatEventTelemetry((0,f.pN)(((a={})[_.h3.ChatEventType]=_.a5.ALUserType,a[_.h3.ChatEventParameters]="UserTypeNotFound",a))),s.label=3;case 3:return[2]}}))}))}},64047:(e,t,n)=>{"use strict";n.d(t,{$9:()=>m,JA:()=>y,MA:()=>T,OE:()=>h,hC:()=>g,qP:()=>E,vo:()=>u});var r=n(743032),o=n(379490),a=n(112514),i=n(242154),s=n(722603),c=n(598309),l=function(){return Office&&"ExtensionLifeCycle"in Office&&"taskpane"in Office.ExtensionLifeCycle};function u(){return d.apply(this,arguments)}function d(){return(d=(0,r._)((function(){var e;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return(0,i.cY)("Closing Shared Header"),l()?[4,null===(e=Office.ExtensionLifeCycle.taskpane)||void 0===e?void 0:e.close()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function _(){return p.apply(this,arguments)}function p(){return(p=(0,r._)((function(){var e;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return(0,i.cY)("Moving Shared Header"),l()?[4,null===(e=Office.ExtensionLifeCycle.taskpane)||void 0===e?void 0:e.move()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function g(){return f.apply(this,arguments)}function f(){return(f=(0,r._)((function(){var e;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return(0,i.cY)("Shared Header Loaded"),l()?[4,null===(e=Office.ExtensionLifeCycle.taskpane)||void 0===e?void 0:e.notifyHeaderLoaded()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function h(){return C.apply(this,arguments)}function C(){return(C=(0,r._)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return(0,i.cY)("Interactive Voice Toolbar Loaded"),b()?[4,Office.ExtensionLifeCycle.resize(368,50)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function m(){return v.apply(this,arguments)}function v(){return(v=(0,r._)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return(0,i.cY)("Interactive Voice Toolbar Closed and entering Conversational Voice Mode"),b()?[4,Office.ExtensionLifeCycle.resize(98,50)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))).apply(this,arguments)}function E(){if(s.i.isWin32Platform()&&!(0,c.w9)())return{buttons:[{type:a.y.Move,clickHandler:_},{type:a.y.Close,clickHandler:u}]}}function y(){if(!(s.i.isMacPlatform()||s.i.isIOSPlatform()||s.i.isWin32Platform()&&(0,c.w9)()))return{type:a.y.Close,clickHandler:u}}var b=function(){return Office&&"ExtensionLifeCycle"in Office};function T(e){return I.apply(this,arguments)}function I(){return(I=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return(0,i.cY)("Closing Shared Header for Dialog"),b()?[4,Office.ExtensionLifeCycle.close(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))).apply(this,arguments)}},64711:(e,t,n)=>{"use strict";n.d(t,{w6:()=>o});var r=n(278814);n(249002),n(208520);var o=(0,r.n)({ariaAnnouncer:{position:"absolute",width:"1px",height:"1px",margin:"-1px",padding:"0",overflow:"hidden",border:"0",clipPath:"inset(50%)",whiteSpace:"nowrap"}})},71245:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var r=n(851348),o=n(208520),a=function(){var e=(0,r._)((0,o.useState)(!1),2),t=e[0],n=e[1],a=(0,r._)((0,o.useState)(!1),2),i=a[0],s=a[1],c=(0,r._)((0,o.useState)(""),2),l=c[0],u=c[1];return(0,o.useEffect)((function(){t&&Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,function(){return Office.context.document.getSelectedDataAsync(Office.CoercionType.Html,(function(e){e.status===Office.AsyncResultStatus.Succeeded?u(e.value):u(void 0)}))}.bind(undefined))}),[t]),[(0,o.useMemo)((function(){return t&&i?l:void 0}),[t,i,l]),n,s,i]}},76554:(e,t,n)=>{"use strict";n.d(t,{R:()=>E,c:()=>m});var r,o=n(555799),a=n(784567),i=n(576493),s=n(117658),c=n(332532),l=n(83437),u=n(423905),d=n(660606),_=n(265167),p=n(822606),g=n(427537),f=n(185088),h=n(475119),C=function(){return C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},C.apply(this,arguments)},m=function(e,t,n,o,g){var f,h;void 0===g&&(g=p.u1);var C={profileOperation:n,queryId:t,profileId:o,queryLanguage:g};r=(new Date).getTime();var m=new a.Xr({parentPath:["Signal",i.t.getTypeName()],items:[{id:_.r.generateId(),body:new i.t(C)}]});null===(h=e.current)||void 0===h||h.submitOperation({operation:m,workflowAnnotationType:s.H.getTypeName()}),(0,d.cY)("Sending User Profile Signal: ",m),d.EG.sendChatEventTelemetry((0,u.pN)(((f={})[l.h3.ChatEventType]=l.a5.UserProfileOperationSubmitted,f[l.h3.ChatEventParameters]=c.X[n],f[l.h3.UserQueryGuid]=t,f)))},v=function(e){return"bot"===e.author&&"Chat"===e.messageType},E=function(e,t,n,a,i){var c,_,m,E=null==e?void 0:e.body,y=E.queryId;y&&!(0,h.hX)(d.EG.setQueryGuid)&&d.EG.setQueryGuid(y),d.EG.updateTelemetryOnAnnotationReceived(s.H.getTypeName(),y,l.CT.UserProfileResponseTime,l.CC.Customize,void 0,r,i);var b=!1,T={featureName:l.CC.Customize,subFeatureName:l.Ff.PersonalizationUserProfile};if(E.error){var I=(0,g.$)(E.error,a,y);return(0,u.AQ)(t,"".concat(s.H.getTypeName(),"_Error"),E.error.category.concat((0,h.jw)(I)?p.u1:"_".concat(I)),l.T_.Server),void n(y)}if(E.chatResponse&&0===E.chatResponse.status){var P=E.chatResponse.messagesToAddOrReplace;if(!(0,h.hX)(P)&&P.length>0)for(var A=0,D=P;A<D.length;A++){var S=D[A];v(S)&&S.text&&((0,d.cY)("rendered user Profile Annotation response:  ",S.text),null===(_=a.current)||void 0===_||_.addResponseMessage({chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:S.text}},chatMessageBodyData:C(C({},(0,h.Hm)(T)),{telemetryData:(0,f.Bh)(y)}),addCardToChatHistory:!0}),b=!0)}}b?d.EG.sendChatEventTelemetry((0,u.pN)(((c={})[l.h3.ChatEventType]=l.a5.QuerySuccessful,c[l.h3.ChatEventParameters]=l.CC.Customize,c))):((0,d.cY)("Error in User Profile Annotation response, showing default error message"),null===(m=a.current)||void 0===m||m.addResponseMessage((0,f.hk)(void 0,C(C({},T),{errorType:l.a5.IncompleteUserProfileResponse}),y))),(0,u.AQ)(t,b?void 0:l.a5.IncompleteUserProfileResponse,void 0,b?void 0:l.T_.Server),n(y)}},83437:(e,t,n)=>{"use strict";var r,o,a,i,s,c,l,u,d,_,p,g,f;n.d(t,{$b:()=>f,CC:()=>c,CT:()=>r,Ff:()=>u,G8:()=>d,IC:()=>s,S2:()=>o,T_:()=>l,a5:()=>i,av:()=>g,h3:()=>a,kD:()=>p,wV:()=>_}),function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.SubFeatureName="SubFeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(r||(r={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.ExtensibilityDialog="ExtensibilityDialog",e.LocalAddinActionExecution="LocalAddinActionExecution"}(o||(o={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(a||(a={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.PodcastFromNudgeTriggered="Podcast_From_Nudge_Triggered",e.DescribeImageFromNudgeTriggered="Describe_Image_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.ExtensibilityDialogLoad="Extensibility_Dialog_Load",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened",e.OpenMOSDialog="Open_MOS_Store_To_Get_Agents",e.MOSStoreDialogResponse="MOS_Store_Dialog_Response",e.VoiceCopilotZQMSubmitted="Voice_Copilot_ZQM_Submitted",e.VoiceCopilotZQMResponseRendered="Voice_Copilot_ZQM_Response_Rendered",e.VoiceCopilotZQMResponseClicked="Voice_Copilot_ZQM_Response_Clicked",e.VoiceCopilotZQMAutoStarted="Voice_Copilot_ZQM_Auto_Started",e.ChatHistorySignalSubmitted="Chat_History_Signal_Submitted",e.ConversationIdUndefined="Conversation_Id_Undefined",e.UpdateChatSessionId="Update_Chat_Session_Id",e.CannotUpdateChatSessionId="Cannot_Update_Chat_Session_Id",e.SubmitOperationUndefined="Submit_Operation_Undefined",e.ConnectionHealth="Connection_Health",e.InsightsCardRelatedFilesResponse="Insights_Card_RelatedFiles_Response",e.AugLoopOfficeCopilotOrchestrationCopilotRelatedFilesError="AugLoop_OfficeCopilotOrchestration_CopilotRelatedFiles_Error",e.InsightsCardRelatedFilesSignalSent="Insights_Card_RelatedFiles_Signal_Sent",e.InsightsCardCocoaSkillResponse="Insights_Card_CocoaSkill_{Skill}_Response",e.InsightsCardCocoaSkillResponseUpdating="Insights_Card_CocoaSkill_{Skill}_Response_Updating",e.InsightsCardCocoaSkillResponseLoaded="Insights_Card_CocoaSkill_{Skill}_Response_Loaded",e.InsightsCardCocoaSkillResponseError="Insights_Card_CocoaSkill_{Skill}_Response_Error",e.InsightsCardCocoaSkillResponseTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_TimedOut",e.InsightsCardCocoaSkillResponseRetryTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_Retry_TimedOut",e.InsightsCardCocoaSkillCardClicked="Insights_Card_CocoaSkill_{Skill}_CardClicked",e.InsightsCardCocoaSkillCardNavigatedTo="Insights_Card_CocoaSkill_{Skill}_CardNavigatedTo",e.LocalAddinActionInvoked="Local_Addin_Action_Invoked",e.LocalAddinExecutionCompletedFromHost="Local_Addin_Action_Completed_From_Host",e.LocalAddinExecutionFailedFromHost="Local_Addin_Action_Failed_From_Host",e.LocalAddinExecutionReceivedMultipleRequests="Local_Addin_Action_Received_Multiple_Requests",e.LocalAddinExecutionReceivedSingleRequest="Local_Addin_Action_Received_Single_Request",e.LocalAddinExecutionStarted="Local_Addin_Action_Started",e.StopGeneratingButtonClickedDuringAddinExecution="Stop_Generating_Button_Clicked_During_Addin_Execution",e.UndoButtonClickedAfterAddinSuccess="Undo_Button_Clicked_After_Addin_Success",e.UndoButtonHiddenOnSubmittingQueryAfterAddinSuccess="Undo_Button_Hidden_On_Submitting_Query_After_Addin_Success",e.UndoButtonShownAfterAddinSuccess="Undo_Button_Shown_After_Addin_Success"}(i||(i={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode",e.ErrorStack="ErrorStack"}(s||(s={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat",e.Extensibility="Extensibility"}(c||(c={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(l||(l={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile",e.AddInActionsForAgents="Add-in Actions for Agents"}(u||(u={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(d||(d={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(_||(_={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(p||(p={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(g||(g={})),function(e){e[e.Warning=400]="Warning",e[e.ASHA=450]="ASHA",e[e.Error=500]="Error",e[e.Critical=600]="Critical"}(f||(f={})),function(e){e.Error="Error",e.UncaughtException="UncaughtException",e.ChatEvents="ChatEvents",e.AssertionFailed="AssertionFailed"}(o||(o={}))},103801:(e,t,n)=>{"use strict";n.d(t,{E9:()=>s,hX:()=>u,k1:()=>l,vm:()=>_,yK:()=>c});var r=n(28515),o=n(260197),a=n(483781),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function s(e,t){var n;return void 0===t&&(t=!1),e.scenarioName===r.Cu.INAPP||(null===(n=e.properties)||void 0===n?void 0:n.scenarioName)===r.Cu.INAPP?o.Wr.InAppHandoff:t?o.Wr.CrossAppCanvasHandoff:o.Wr.CrossAppHandoff}function c(e,t){return void 0===t&&(t=!1),!!e&&(!(!t&&e.toLowerCase()===r.Ww.NONE)&&Object.values(r.Ww).some((function(t){return t===e.toLowerCase()})))}function l(e){var t;return i(i({scenarioName:r.Cu.NONE},e),null!==(t=e.properties)&&void 0!==t?t:{})}function u(e,t,n){return d(e,t,n)===a.$n.M365CopilotChat}function d(e,t,n){var r,i,s,c,l;if(!e.isBizChatinSDXEnabled||e.fallbackHandoffsToAppChat||!t)return a.$n.AppChat;var u=null!==(c=null!==(i=null===(r=null==n?void 0:n.PrimaryUserAccountInfo)||void 0===r?void 0:r.AggregatedLicensedFeatures)&&void 0!==i?i:null===(s=null==n?void 0:n.PrimaryUserAccountInfo)||void 0===s?void 0:s.LicensedFeatures)&&void 0!==c?c:void 0;return!e.shouldCheckUserLicense||(!!(null==u?void 0:u.includes("Copilot"))||!!(null==u?void 0:u.includes("CopilotStarter")))?e.shouldDefaultToBizChat?o.q7.includes(t.featureName)?a.$n.AppChat:a.$n.M365CopilotChat:null!==(l=o.i$.get(t.featureName))&&void 0!==l?l:a.$n.AppChat:a.$n.AppChat}function _(e,t,n,r){var o,a=r.useHandoffMessagePropertiesValue?l(e):e,s=void 0;try{s=a.context?JSON.parse(a.context):void 0}catch(e){return void n("Handoff context could not be parsed - unable to switch chat experience")}t.setBizChatHostContext&&t.setBizChatHostContext({PrimaryUserAccountInfo:i(i({},null===(o=t.bizChatHostContext)||void 0===o?void 0:o.PrimaryUserAccountInfo),{CopilotExperience:d(r,s,t.bizChatHostContext)})})}},111246:(e,t,n)=>{"use strict";n.d(t,{$:()=>l});var r=n(811912),o=n(791165),a=n(990813),i=(n(208520),n(249002)),s=n(242154),c=n(602061),l=function(){function e(){(0,r._)(this,e),(0,a._)(this,"copilotChatRef",void 0),(0,a._)(this,"ariaAnnouncerRef",void 0),(0,a._)(this,"pillsHandler",void 0),(0,a._)(this,"bizChatHandoffPropertiesHandler",void 0)}return(0,o._)(e,[{key:"setCopilotRef",value:function(e){this.copilotChatRef=e}},{key:"getCopilotRef",value:function(){return this.copilotChatRef}},{key:"setAriaAnnouncerRef",value:function(e){this.ariaAnnouncerRef=e}},{key:"getAriaAnnouncerRef",value:function(){return this.ariaAnnouncerRef}},{key:"setPillsHandler",value:function(e){this.pillsHandler=e}},{key:"getPillsHandler",value:function(){return this.pillsHandler}},{key:"setBizChatHandoffPropertiesHandler",value:function(e){this.bizChatHandoffPropertiesHandler=e}},{key:"getBizChatHandoffPropertiesHandler",value:function(){return this.bizChatHandoffPropertiesHandler}},{key:"getMessageAtIndex",value:function(e){var t;return(0,s.cY)("Fetching message at index : "+e),null===(t=this.copilotChatRef.current)||void 0===t?void 0:t.getMessageAtIndex(e)}},{key:"setPillTexts",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;(0,s.cY)("Setting pill texts here"),null===(t=this.pillsHandler)||void 0===t||t.setPillTexts(e,n)}},{key:"displayResponse",value:function(e){var t;(0,s.cY)("Displaying response : "+e),null===(t=this.copilotChatRef.current)||void 0===t||t.addResponseMessage(e)}},{key:"updateMessage",value:function(e){var t;(0,s.cY)("update response : "+e),null===(t=this.copilotChatRef.current)||void 0===t||t.updateMessage(e)}},{key:"updateLastMessage",value:function(e){var t;(0,s.cY)("Displaying response : "+e),null===(t=this.copilotChatRef.current)||void 0===t||t.updateLastMessage(e)}},{key:"deleteMessage",value:function(e){var t;(0,s.cY)("Deleting response : "+e),null===(t=this.copilotChatRef.current)||void 0===t||t.deleteMessage(e)}},{key:"submitOperation",value:function(e){var t;(0,s.cY)("Submitting signal : "+e),null===(t=this.copilotChatRef.current)||void 0===t||t.submitOperation(e)}},{key:"updateLoaderStrings",value:function(e){var t;(0,s.cY)("Updating loader strings here",e);var n={loadingUiStringList:e,showStopGeneratingButton:!(0,i.dD)(),showInlineStopGeneratingButton:(0,i.dD)()};null===(t=this.copilotChatRef.current)||void 0===t||t.updateLoadingComponentProps(n)}},{key:"getLastMessage",value:function(e){var t;return(0,s.cY)("Fetching last message here"),null===(t=this.copilotChatRef.current)||void 0===t?void 0:t.getLastMessage(e)}},{key:"setInputAreaText",value:function(e){var t;(0,s.cY)("putting text in text area"),null===(t=this.copilotChatRef.current)||void 0===t||t.setInputAreaText(e)}},{key:"setInputFocus",value:function(){var e,t;(0,s.cY)("Setting input focus"),null===(t=this.copilotChatRef)||void 0===t||null===(e=t.current)||void 0===e||e.setInputFocus()}},{key:"scrollToBottom",value:function(){var e,t;(0,s.cY)("Scroll to bottom"),null===(t=this.copilotChatRef)||void 0===t||null===(e=t.current)||void 0===e||e.scrollToBottom()}},{key:"submitUserPromptForSummaryNudge",value:function(e){var t;(0,s.cY)("Calling common core component to trigger summary for nudge"),(0,c.Dl2)(),null===(t=this.copilotChatRef.current)||void 0===t||t.submitUserQuery({text:e})}},{key:"submitUserPromptForPodcastNudge",value:function(e){var t;(0,s.cY)("Calling common core component to trigger podcast for nudge"),(0,c.Pb_)(),null===(t=this.copilotChatRef.current)||void 0===t||t.submitUserQuery({text:e})}},{key:"submitUserPromptForDescribeImageNudge",value:function(e){var t;(0,s.cY)("Calling common core component to trigger describe image for nudge"),null===(t=this.copilotChatRef.current)||void 0===t||t.submitUserQuery({text:e}),(0,c.d9u)()}},{key:"submitUserQuery",value:function(e){var t;(0,s.cY)("submitting prompt"),null===(t=this.copilotChatRef.current)||void 0===t||t.submitUserQuery({text:e})}},{key:"startLoadingUi",value:function(){var e;null===(e=this.copilotChatRef.current)||void 0===e||e.startLoadingUi()}},{key:"updateAttachmentList",value:function(e){this.copilotChatRef.current.updateAttachmentList(e)}},{key:"openRealtimeVoiceCopilot",value:function(e){var t;(0,s.cY)("Opening realtime voice copilot",e),null===(t=this.copilotChatRef.current)||void 0===t||t.openRealtimeVoiceCopilot(e)}},{key:"openSideQuest",value:function(e,t,n){var r;(0,s.cY)("Opening side quest"),null===(r=this.copilotChatRef.current)||void 0===r||r.openSideQuest(e,t,n)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,a._)(l,"instance",void 0)},116510:(e,t,n)=>{"use strict";var r,o;n.d(t,{T:()=>r,q:()=>o}),function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(r||(r={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(o||(o={}))},124857:(e,t,n)=>{"use strict";n.d(t,{lY:()=>_,mf:()=>d,xt:()=>l});var r=n(743032),o=n(379490),a=n(722603),i=n(740389),s=n(242154),c=n(602061);function l(){var e=d();return c.$nm.includes(e)||c.b_z.includes(e)}function u(e,t){var n=document.createElement("script");n.type="text/javascript",n.src=e,(0,s.cY)("Loading Localized strings for Language: "+t);var r=new Promise((function(e,r){n.onload=function(){(0,s.cY)("Resolved Promise to load script resource."),e()},n.onerror=n.onabort=function(){var e=a.i.GetHostAppDisplayLanguage();r(new c.DYx(c._sV.FailedToLoadStrings,"Failed to load strings with mapped language = "+t+" and display language = "+e))}}));return document.head.appendChild(n),r}function d(){var e=a.i.GetHostAppDisplayLanguage(),t=new c.dDr;return t.IsTier2LanguageSupportEnabled=!0,t.IsTier2RTLLanguageEnabled=!0,t.IsTier3LanguagesEnabled=!0,t.IsTier2Point5LanguagesEnabled=!0,t.IsTier4LanguagesEnabled=(0,i.PXo)(),t.getUserLanguage(e)}function _(){return p.apply(this,arguments)}function p(){return(p=(0,r._)((function(){var e,t,n,r,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:e=d().toLowerCase(),n=(t="office-online-strings")+"/"+e+"/word-copilot.min.js",r=t+"/"+e+"/officeaicopilot-strings.min.js",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,Promise.all([u(n,e),u(r,e)])];case 2:return o.sent(),[3,4];case 3:throw o.sent(),i=a.i.GetHostAppDisplayLanguage(),new c.DYx(c._sV.FailedToLoadStrings,"Failed to load strings with mapped language = "+e+" and display language = "+i);case 4:return[2]}}))}))).apply(this,arguments)}},128825:(e,t,n)=>{"use strict";n.d(t,{J:()=>p,u:()=>r});var r,o=n(990813),a=n(781551),i=n(208520),s=n(8810),c=n(140889),l=n(769449),u=n(448397);!function(e){e.DesignerCard="DesignerCard",e.StoreLauncherCard="StoreLauncherCard",e.ClipchampCard="ClipchampCard",e.PodcastUI="PodcastUI"}(r||(r={}));var d={StoreLauncherCard:a.D},_=i.memo((function(e){var t=e.component;return i.useEffect((function(){var e;u.B.getInstance().sendErrorTelemetry((0,l.pN)((e={},(0,o._)(e,c.IC.ErrorMessage,"Missing renderer for ".concat(t)),(0,o._)(e,c.IC.ErrorCategory,s.S.Error),e)))}),[t]),i.createElement("i",null,"Sorry, cannot display this message.")})),p={renderers:d,renderFallback:function(e){return i.createElement(_,{component:e.component})}}},139156:(e,t,n)=>{"use strict";n.d(t,{K:()=>h});var r=n(692806),o=n(977296),a=n(352311),i=n(891585),s=n(879840),c=n(680118),l=n(489641),u=n(806231),d=n(110213),_=n(623268),p=n(208520),g=n(384761),f=n(475119),h=function(e){var t=e.entity,n=e.suggestedPrompts,h=e.entityStyles,C=e.logRelatedFilesTriedEvents,m=p.useRef(null);return p.createElement(o.A,{withArrow:!0,positioning:"below-end",trapFocus:!0},p.createElement(a.W,null,p.createElement(i.$,{ref:m,className:h.entitySparkleIconContainer,"aria-label":"Show suggested prompts for this file "},p.createElement(_.WwO,null))),p.createElement(s.H,{"aria-label":"Suggested Prompts",className:h.suggestedPromptsPopover},p.createElement(r.W,{style:h.suggestedPromptsContainer},p.createElement(c.V,{className:h.suggestedPromptsTitle},(0,f.yG)()),p.createElement(l.c,{className:h.suggestedPromptMenuList,role:"menu"},null==n?void 0:n.map((function(e,r){return p.createElement(u.D,{key:r,className:h.suggestedPromptMenuItem,role:"menuitem","aria-posinset":r+1,"aria-setsize":n.length,onClick:function(){var n,r;null===(n=e.onClick)||void 0===n||n.call(e,t,e.text),null==C||C(g.A.SUGGESTED_PROMPTS_CLICKED),null===(r=m.current)||void 0===r||r.click()}},p.createElement(d.c,{className:h.suggestedPrompt},e.text))}))))))}},140889:(e,t,n)=>{"use strict";n.d(t,{CC:()=>u,CD:()=>E,CT:()=>r,Dh:()=>o,G8:()=>h,IC:()=>c,Nr:()=>i,Qw:()=>b,S9:()=>p,_R:()=>v,a5:()=>s,av:()=>m,by:()=>f,eJ:()=>C,h3:()=>a,jr:()=>y,lK:()=>g,nk:()=>d,qN:()=>T});var r,o,a,i,s,c,l,u,d,_,p,g,f,h,C,m;!function(e){e.ActionAIAcknowledgementResponseTime="ActionAIAcknowledgementResponseTime",e.AnnotationActivationTime="AnnotationActivationTime",e.AnnotationType="AnnotationType",e.AugloopInitializationTime="AugloopInitializationTime",e.AugloopResponseTime="AugloopResponseTime",e.AugloopSessionGuid="AugloopSessionGuid",e.ChatHistoryAnnotationActivationTime="ChatHistoryAnnotationActivationTime",e.ChatHistoryTimeInLoad="ChatHistoryTimeInLoad",e.ChatPPTSessionId="ChatPPTSessionId",e.CheckPoints="CheckPoints",e.ContentCreationChunkInfoJson="ContentCreationChunkInfoJson",e.ContentCreationResponseTime="ContentCreationResponseTime",e.ContentOrigin="ContentOrigin",e.ContextTreeBuildTime="ContextTreeBuildTime",e.ContextTreeMergeTime="ContextTreeMergeTime",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.CopilotODSLResponseTime="CopilotODSLResponseTime",e.DesignerBootTime="DesignerBootTime",e.ErrorChatEventParameter="ErrorChatEventParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorParameter="ErrorParameter",e.ErrorType="ErrorType",e.FeatureName="FeatureName",e.FirstServiceResponse="FirstServiceResponse",e.FirstValidMessageReceivedTime="FirstValidMessageReceivedTime",e.HandoffMessageResponseTime="HandoffMessageResponseTime",e.HandoffResponseTime="HandoffResponseTime",e.ImageInsertionTime="ImageInsertionTime",e.ImageResponseTime="ImageResponseTime",e.ImageType="ImageType",e.IsDevBuild="IsDevBuild",e.IsFluxEnabled="IsFluxEnabled",e.IsFluxUsed="IsFluxUsed",e.IsFromCache="IsFromCache",e.IsImageInsertionSuccess="IsImageInsertionSuccess",e.IsLocalAL="IsLocalAL",e.IsQuerySuccess="IsQuerySuccess",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.PersonalizationResponseTime="PersonalizationResponseTime",e.QueryExecutionTime="QueryExecutionTime",e.QnAChunkInfo="QnAChunkInfo",e.QnAResponseTime="QnAResponseTime",e.RequestSignalType="RequestSignalType",e.SDXResourcesLoadTime="SDXResourcesLoadTime",e.StartCopilotOperationTime="StartCopilotOperationTime",e.StopGeneratingTime="StopGeneratingTime",e.SubFeatureName="SubFeatureName",e.SubstrateAPIResponseTime="SubstrateAPIResponseTime",e.SummaryChunkInfo="SummaryChunkInfo",e.SummaryResponseTime="SummaryResponseTime",e.SydneyChunkInfoJson="SydneyChunkInfoJson",e.SydneyResponseTime="SydneyResponseTime",e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.UserPerceivedLatency="UserPerceivedLatency",e.UserProfileResponseTime="UserProfileResponseTime",e.UserQueryGuid="UserQueryGuid",e.WordUserCopilotPaneLoadTime="WordUserCopilotPaneLoadTime",e.UserCopilotPaneLoadTime_PreloadTime="UserCopilotPaneLoadTime_PreloadTime",e.SharedHeaderLoadTimeInMs="SharedHeaderLoadTimeInMs",e.StaticSharedHeaderLoadTimeInMs="StaticSharedHeaderLoadTimeInMs",e.ExtensibilityInfo="ExtensibilityInfo",e.BizChatTotalInitializationTime="BizChatTotalInitializationTime",e.BizChatSessionCreationTime="BizChatSessionCreationTime",e.BizChatAnnotationRegistrationTime="BizChatAnnotationRegistrationTime",e.BizChatHandoffAnnotationCount="BizChatHandoffAnnotationCount",e.BizChatInitializationFailureTime="BizChatInitializationFailureTime"}(r||(r={})),function(e){e.UserQueryGuid="UserQueryGuid",e.ChatPPTSessionId="ChatPPTSessionId",e.EventState="EventState",e.OperationOrder="OperationOrder",e.OperationType="OperationType",e.TimeDurationInMs="TimeDurationInMs",e.OperationParameters="OperationParameters",e.UserQueryOrder="UserQueryOrder",e.OperationDetails="OperationDetails"}(o||(o={})),function(e){e.DocSessionID="DocSessionId",e.ALSessionKey="ALSessionKey",e.IsDevBuild="IsDevBuild",e.UserQueryGuid="UserQueryGuid",e.ChatPPTSessionId="ChatPPTSessionId",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.UserQueryOrder="UserQueryOrder",e.IsMicrophoneInvolvedInQueryInput="IsMicrophoneInvolvedInQueryInput",e.SuggestionText="SuggestionText",e.Cv="Cv",e.ImageType="ImageType",e.UniqueActionId="UniqueActionId",e.TaskPaneVisibilityModeChanged="TaskPaneVisibilityModeChanged",e.ExtensibilityInfo="ExtensibilityInfo"}(a||(a={})),function(e){e.GenericErrorMessage="GenericErrorMessage",e.RaiErrorMessage="RaiErrorMessage",e.CopilotUnsupportedlanguageMessage="CopilotUnsupportedlanguageMessage",e.CopilotUnsupportedLanguageError="CopilotUnsupportedLanguageError",e.TimeoutErrorMessage="TimeoutErrorMessage",e.ThrottlingErrorMessage="ThrottlingErrorMessage",e.AugloopResponseTimeoutMessage="AugloopResponseTimeoutMessage",e.MultipleQuestionsErrorMessage="MultipleQuestionsErrorMessage",e.LocationParameterErrorMessage="LocationParameterErrorMessage",e.HelpQueryErrorMessage="HelpQueryErrorMessage",e.DKEAndNotExtractLabelErrorString="DKEAndNotExtractLabelErrorString",e.LicenseValidationErrorMessage="LicenseValidationErrorMessage",e.ODSLSyntaxError="ODSLSyntaxError",e.ODSLParsingError="ODSLParsingError",e.DisambiguationError="DisambiguationError",e.DisengagedError="DisengagedError",e.CommandNotSupportedMessage="CommandNotSupportedMessage",e.AnswerNotInDocErrorMessage="AnswerNotInDocErrorMessage",e.QueryLengthTooLongError="QueryLengthTooLongError",e.DefaultHelpCardDescription="DefaultHelpCardDescription",e.AdminControlErrorMessage="AdminControlErrorMessage",e.OutOfScopeRequestErrorMessage="OutOfScopeRequestErrorMessage",e.WordResponseLessErrorMessage="WordResponseLessErrorMessage",e.RequestTooLongErrorMessage="RequestTooLongErrorMessage",e.PluginAuthErrorMessage="PluginAuthErrorMessage",e.DesignerVisualsEmptyResponse="DesignerVisualsEmptyResponse",e.DesignerVisualsSkillResponseParseError="DesignerVisualsSkillResponseParseError",e.DesignerVisualsInsertError="DesignerVisualsInsertError",e.DesignerVisualsText2ImageError="DesignerVisualsText2ImageError",e.DesignerVisualsLLMError="DesignerVisualsLLMError",e.DesignerVisualsUnsupportedImageTypeError="DesignerVisualsUnsupportedImageTypeError",e.DesignerVisualsStockRAIError="DesignerVisualsStockRAIError",e.DesignerVisualsUnknownError="DesignerVisualsUnknownError",e.DesignerMiniError="DesignerMiniError",e.OutOfCreditsError="OutOfCreditsError",e.HandoffMessageFromHostAppSettingsError="HandoffMessageFromHostAppSettingsError",e.ProcessHandoffMessageError="ProcessHandoffMessageError",e.AdaptiveCardInsertImageError="AdaptiveCardInsertImageError",e.ResponseParsingFailure="ResponseParsingFailure",e.NoErrorFoundInErrorObject="NoErrorFoundInErrorObject",e.InvalidFinalMessage="InvalidFinalMessage",e.UnsuccessfulCompletionStatus="UnsuccessfulCompletionStatus"}(i||(i={})),function(e){e.EnterKeyPressed="Enter_Key_Pressed",e.SubmitButtonClicked="Submit_Button_Clicked",e.FRESuggestionClicked="FRE_Suggestion_Clicked",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.ZQMButtonClicked="ZQM_Button_Clicked",e.SparkleMenuSummarySuggestionClicked="SparkleMenuSummarySuggestionClicked",e.SparkleMenuHowCanCopilotHelpSuggestionClicked="SparkleMenuHowCanCopilotHelpSuggestionClicked",e.SparkleMenuGenerateDesignsSuggestionClicked="SparkleMenuGenerateDesignsSuggestionClicked",e.DesignerLinkClicked="Designer_Link_Clicked",e.OptoutIntentMessage="Optout_Intent_Message",e.OptoutButtonPressed="Optout_Button_Pressed",e.FailureType2Message="Failure_Type_2_Message",e.FailureType3Message="Failure_Type_3_Message",e.FailureType4Message="Failure_Type_4_Message",e.FailureType5Message="Failure_Type_5_Message",e.FailureType6Message="Failure_Type_6_Message",e.FailureType7Message="Failure_Type_7_Message",e.HelpIntentMessage="Help_Intent_Message",e.AudioCastConfigError="Audio_Cast_Config_Error",e.QuerySubmittedByUser="Query_Submitted_By_User",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.QueryReSubmittedByTimeout="Query_ReSubmitted_By_Timeout",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ODSLResponseReceivedFromSydney="ODSL_Response_Received_From_Sydney",e.SummaryResponseReceivedFromSkill="Summary_Response_Received_From_Skill",e.SummaryResponseReceivedFromSydney="Summary_Response_Received_From_Sydney",e.QnAResponseReceivedFromSydney="QnA_Response_Received_From_Sydney",e.DesignerGraphicsResponseReceivedFromSydney="Designer_Graphics_Response_Received_From_Sydney",e.ODSLExecutionTimeout="ODSL_Execution_Timeout",e.QueryExecutionFailed="Query_Execution_Failed",e.QueryExecutionSuccessful="Query_Execution_Successful",e.QueryExecutionPartiallySuccessful="Query_Execution_Partial_Success",e.HelpCardShownOnSubmission="Help_Tip_Card_Shown",e.WarningCardShownOnSubmission="Warning_Card_Shown",e.ThumbsUpButtonClicked="Thumbs_Up_Button_Clicked",e.ThumbsDownButtonClicked="Thumbs_Down_Button_Clicked",e.UndoButtonClicked="Undo_Button_Clicked",e.KeepItButtonClicked="Keep_It_Button_Clicked",e.StopGeneratingButtonClicked="Stop_Generating_Button_Clicked",e.StopGeneratingSignalSentToAL="Stop_Generating_Signal_Sent_To_AL",e.QueryEndOnGptSwitch="Query_End_On_Gpt_Switch",e.InvalidContextIdResponse="Invalid_Context_Id_Response",e.InsertButtonClicked="Insert_Button_Clicked",e.CopyButtonClicked="Copy_Button_Clicked",e.ChatPaneLoaded="Chat_Pane_Loaded",e.ChatHistorySessionLoaded="Chat_History_Session_Loaded",e.LocalizationStringsLoaded="Localization_Strings_Loaded",e.AugloopResponseTimeout="Augloop_Response_Timeout",e.AugloopDisconnected="Augloop_Disconnected",e.AugloopClosed="Augloop_Closed",e.AugloopReconnected="Augloop_Reconnected",e.AugloopSharedSessionIDMappingToALSessionKey="AugloopSharedSessionID_Mapping_To_ALSessionKey",e.InternetReconnected="Internet_Reconnected",e.AnnotationActivationOnSubmit="Annotation_Activation_On_Submit",e.ChatPaneInitialized="Chat_Pane_Initialized",e.MicrophonePlayClicked="Microphone_Play_Clicked",e.MicrophonePauseClicked="Microphone_Pause_Clicked",e.MicrophoneSuccessfullyInitialized="Microphone_Successfully_Initialized",e.MicrophonePermissionDenied="Microphone_Permission_Denied",e.IsVoiceCopilotFGEnabled="Is_VoiceCopilot_FG_Enabled",e.MicrophoneInitializationTimeInMs="MicrophoneInitializationTimeInMs",e.MicrophoneLoadingTimeInMs="MicrophoneLoadingTimeInMs",e.ChangeTopicButtonClicked="Change_Topic_Button_Clicked",e.FinalValidMessageReceivedFromSydney="Final_Valid_Message_Received_From_Sydney",e.FinalValidMessageReceivedFromSkill="Final_Valid_Message_Received_From_Skill",e.LastChatMessageUserType="Last_Chat_Message_User_Type",e.EmptyMessageReceivedFromSydney="Empty_Message_Received_From_Sydney",e.ContentOriginInFinalResponse="Content_Origin_In_Final_Response",e.ContentOriginUnknown="Content_Origin_Unknown",e.ChatIntentDetected="Chat_Intent_Detected",e.UnexpectedErrorObjectReceived="Unexpected_Error_Obj_Received",e.GroundingSourceUpdated="Grounding_Source_Updated",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.LaunchReviewerAgentResponseReceivedFromSydney="Launch_Reviewer_Agent_Response_Received_From_Sydney",e.CopilotConfig="Copilot_Config",e.TriggerImageChatOperation="Trigger_Image_Chat_Operation",e.ClientResponseTimeout="Client_Response_Timeout",e.LessContentError="Less_Content_Error",e.ContentGenerationDisabledByAdminControl="Content_Generation_Disabled_By_Admin_Control",e.ContentCreationDisabled="Content_Creation_Disabled",e.ExecutionStatusEmpty="Execution_Status_Empty",e.ExecutionStatusContentNotFound="Execution_Status_Content_Not_Found",e.ExecutionStatusFailed="Execution_Status_Failed",e.LightCommandingDisabled="Light_Commanding_Disabled",e.ODSLAndErrorNotFound="ODSL_And_Error_Not_Found",e.AnswerErrorNotFound="Answer_Error_Not_Found",e.ChatHistoryTimeout="Chat_History_Timeout",e.UnsupportedAnnotation="Unsupported_Annotation",e.ErrorNotFound="Error_Not_Found",e.FinalMessageTextNotFound="Final_MessageText_Not_Found",e.NoChatResponseRenderedFromSydney="No_Chat_Response_Rendered_From_Sydney",e.ResponseCardDisplayError="Response_Card_Display_Error",e.ResponseCardDisplaySuccessful="Query_Successful",e.RaiErrorMessage="Rai_Error_Message",e.LanguageBlockedErrorMessage="Language_Blocked_Error_Message",e.UnsupportedDocumentLanguageErrorMessage="Unsupported_Document_Language_Error_Message",e.UnsupportedPromptLanguageErrorMessage="Unsupported_Prompt_Language_Error_Message",e.UnsupportedPromptRequestedLanguageErrorMessage="Unsupported_Prompt_Requested_Language_Error_Message",e.TimeoutErrorMessage="Timeout_Error_Message",e.MultipleQuestionsErrorMessage="Multiple_Questions_Error_Message",e.OutOfScopeRequestErrorMessage="Out_Of_Scope_Request_Error_Message",e.LocationParameterErrorMessage="Location_Parameter_Error_Message",e.HelpQueryErrorMessage="Help_Query_Error_Message",e.GenericErrorMessage="Generic_Error_Message",e.AnswerNotInDocErrorMessage="Answer_Not_In_Doc_Error_Message",e.LessContentErrorMessage="Less_Content_Error_Message",e.ThrottledErrorMessage="Throttled_Error_Message",e.DisengagedErrorMessage="Disengaged_Error_Message",e.InvalidInputError="Invalid_Input_Error",e.InvalidSignalErrorMessage="Invalid_Signal_Error_Message",e.EmptyResponse="Empty_Response_Error",e.ErrorInExecution="Error_In_Execution",e.ResourcesNotAvailable="Resources_Not_Available",e.UnsupportedLanguageError="Unsupported_Language_Error",e.InputAttackDetected="Input_Attack_Detected",e.OutputAttackDetected="Output_Attack_Detected",e.TooLargeRequest="Too_Large_Request",e.StreamParsingFailed="Stream_Parsing_Failed",e.RequestRejected="Request_Rejected",e.PartialResult="Partial_Result",e.ODSLSyntaxError="ODSL_Syntax_Error",e.ODSLParsingError="ODSL_Parsing_Error",e.DisambiguationError="Disambiguation_Error",e.LicensingError="Licensing_Error",e.BadTokenError="Bad_Token_Error",e.RequestTooLongError="Request_Too_Long_Error",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.ProcessingDeniedMessage="Processing_Denied_Message",e.UnsupportedSVGError="Unsupported_SVG_Error",e.GetSignalOperationException="Get_Signal_Operation_Exception",e.ProactivePaneOpeningTriggered="Proactive_Pane_Opening_Triggered",e.InsertButtonClickedInIROMode="Insert_Button_Clicked_In_IRO_Mode",e.TaskPaneStart="TaskPane_Start",e.AppLoadStart="AppLoad_Start",e.OfficeJSReady="OfficeJS_Ready",e.LocalizationCheckpoint="Localization_Checkpoint",e.LocalizationEnd="Localization_End",e.CurrentChatHistoryStart="CurrentChatHistory_Start",e.CitationClicked="Citation_Clicked",e.CitationReceived="Citation_Received",e.TaskModuleLaunched="Task_Module_Launched",e.TaskModuleClosed="Task_Module_Closed",e.MsgExtDataReceived="MsgExt_Data_Received",e.EnabledPlugins="Enabled_Plugins",e.GptIdForBranding="Gpt_Id_For_Branding",e.ExtensibilityConfig="Extensibility_Config",e.InterstitialMessageShown="Interstitial_Message_Shown",e.AdaptiveCardImageInsertionSuccess="Adaptive_Card_Image_Insertion_Success",e.HandoffResponseChatMessageShown="Handoff_Response_Chat_Message_Shown",e.HandoffActionButtonClicked="Handoff_Action_Button_Clicked",e.HandoffMessageIdResponseError="Handoff_MessageIdResponse_Error",e.HandoffMessageIdGetOperationSubmitted="Handoff_Message_Id_Get_Operation_Submitted",e.HandoffMessageIdProcessedOperationSubmitted="Handoff_Message_Id_Processed_Operation_Submitted",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted",e.HandoffQuerySubmittedByUser="Handoff_Query_Submitted_By_User",e.HandoffComplete="Handoff_Complete",e.BizChatSessionInitializationStarted="BizChat_Session_Initialization_Started",e.BizChatSessionInitializationCompleted="BizChat_Session_Initialization_Completed",e.BizChatSessionInitializationFailed="BizChat_Session_Initialization_Failed",e.BizChatAnnotationRegistrationFailed="BizChat_Annotation_Registration_Failed",e.BizChatAnnotationRegistrationSummary="BizChat_Annotation_Registration_Summary",e.SelfHelpContentShown="SelfHelp_Content_Shown",e.SelfHelpActionClicked="SelfHelp_Action_Clicked",e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ZQMV2Loaded="ZQMV2_Loaded",e.ZQMV2CardClicked="ZQMV2_Card_Clicked",e.SuggestionPillClicked="Suggestion_Pill_Clicked",e.EmptyDesignerResponse="Empty_Designer_Response",e.DesignerImageInsertStart="Designer_Image_Insert_Start",e.DesignerImageInsertEnd="Designer_Image_Insert_End",e.DesignerImageInsertError="Designer_Image_Insert_Error",e.DesignerResponseShown="Designer_Shown",e.DesignerResponseShownForDCs="Designer_Shown_For_DCs",e.ReviewerAgentInvokedInSensitiveDoc="Reviewer_Agent_Invoked_In_Sensitive_Doc",e.DesignerAuthTokenFetchStart="Designer_Auth_Token_Fetch_Start",e.DesignerAuthTokenFetchRetry="Designer_Auth_Token_Fetch_Retry",e.DesignerAuthTokenFetchEnd="Designer_Auth_Token_Fetch_End",e.DesignerBase64ImagesReceived="Designer_Base64_Images_Received",e.DesignerSkillResponseParseError="Designer_Skill_Response_Parse_Error",e.DesignerMiniEvent="Designer_Mini_Event",e.DesignerMiniUnclassifiedError="Designer_Mini_Unclassified_Error",e.DesignerMiniRAIBlocklistError="Designer_Mini_RAI_Blocklist_Error",e.DesignerMiniAuthError="Designer_Mini_Auth_Error",e.DesignerMiniServiceBlockError="Designer_Mini_Service_Block_Error",e.DesignerDiscountedError="Designer_Discounted_Error",e.DesignerSkillError="Designer_Skill_Error",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.PreloadCopilot="PreloadCopilot",e.TaskPaneVisibilityModeChanged="TaskPaneVisibilityModeChanged",e.CshCopilotLinkClicked="Help_CSH_Copilot_Link_Clicked",e.CshCopilotLinkUnknownPromptId="Help_CSH_Copilot_Unknown_PromptId",e.ExperimentFlights="Experiment_Flights",e.InsightsCardQnALoaded="Insights_Card_QnA_Loaded",e.InsightsCardRelatedFilesLoaded="Insights_Card_RelatedFiles_Loaded",e.InsightsCardAgentsLoaded="Insights_Card_Agents_Loaded",e.InsightsCardSuggestedQnAZQMButtonClickedOpen="Insights_Card_SuggestedQnA_ZQM_Button_Clicked_Open",e.InsightsCardSuggestedQnAZQMButtonClickedClosed="Insights_Card_SuggestedQnA_ZQM_Button_Clicked_Closed",e.InsightsCardSuggestedQnATabClicked="Insights_Card_SuggestedQnA_Tab_Clicked",e.InsightsCardRelatedFilesTabClicked="Insights_Card_RelatedFiles_Tab_Clicked",e.InsightsCardSummaryTabClicked="Insights_Card_Summary_Tab_Clicked",e.InsightsCardNavigateToSummaryCard="Insights_Card_Navigate_To_Summary_Card",e.InsightsCardAgentsTabClicked="Insights_Card_Agents_Tab_Clicked",e.InsightsCardNavigateToSuggestedQnACard="Insights_Card_Navigate_To_Suggested_QnA_Card",e.InsightsCardNavigateToRelatedFilesCard="Insights_Card_Navigate_To_RelatedFiles_Card",e.InsightsCardQnATimedOut="Insights_Card_QnA_TimedOut",e.InsightsCardRetryQnATimedOut="Insights_Card_Retry_QnA_TimedOut",e.InsightsCardRetryQnAClicked="Insights_Card_Retry_QnA_Clicked",e.InsightsCardAgentsTimedOut="Insights_Card_Agents_TimedOut",e.InsightsCardRetryAgentsTimedOut="Insights_Card_Retry_Agents_TimedOut",e.InsightsCardRetryAgentsClicked="Insights_Card_Retry_Agents_Clicked",e.InsightsCardRetryRelatedFilesClicked="Insights_Card_Retry_RelatedFiles_Clicked",e.InsightsCardRelatedFilesTimedOut="Insights_Card_RelatedFiles_TimedOut",e.InsightsCardRelatedFilesRetryTimedOut="Insights_Card_RelatedFiles_Retry_TimedOut",e.InsightsCardCopyButtonClicked="Insights_Card_Copy_Button_Clicked_{TabName}",e.InsightsCardThumbsUpButtonClicked="Insights_Card_ThumbsUp_Button_Clicked_{TabName}",e.InsightsCardThumbsDownButtonClicked="Insights_Card_ThumbsDown_Button_Clicked_{TabName}",e.InsightsCardShowMoreButtonClicked="Insights_Card_ShowMore_Button_Clicked_{TabName}",e.InsightsCardFirstCardRendered="Insights_Card_First_Card_Rendered_{TabName}",e.InsightsCardUnknownRendered="Insights_Card_Unknown_Rendered",e.InsightsCardDiscardedSummaryResponseReceived="Insights_Card_Discarded_Summary_Response_Received",e.InsightsCardSummaryLoaded="Insights_Card_Summary_Loaded",e.InsightsCardRetrySummaryLoaded="Insights_Card_Retry_Summary_Loaded",e.InsightsCardRetrySummaryClicked="Insights_Card_Retry_Summary_Clicked",e.InsightsCardSummaryTimedOut="Insights_Card_Summary_TimedOut",e.InsightsCardRetrySummaryTimedOut="Insights_Card_Retry_Summary_TimedOut",e.SummarizationOperationForInsightsCardSubmitted="Summarization_Operation_Insights_Card_Submitted",e.RetrySummarizationOperationForInsightsCardSubmitted="Retry_Summarization_Operation_Insights_Card_Submitted",e.InsightsCardSummaryHandled="Insights_Card_Summary_Handled",e.InsightsCardSummaryIsFromCache="Insights_Card_Summary_Is_From_Cache",e.InsightsCardSummaryMarkdownHandled="Insights_Card_Summary_Markdown_Handled",e.InsightsCardSummaryCitationsNotHandled="Insights_Card_Summary_Citations_Not_Handled",e.InsightsCardSummaryShown="Insights_Card_Summary_Shown",e.InsightsCardQnAShown="Insights_Card_QnA_Shown",e.InsightsCardSummaryUnsuccessful="Insights_Card_Summary_Unsuccessful",e.InsightsCardSummaryError="Insights_Card_Summary_Error",e.InsightsCardSummaryState="Insights_Card_Summary_State",e.InsightsCardQnAState="Insights_Card_QnA_State",e.InsightsCardCheckPassedFromClient="Insights_Card_Check_Passed_From_Client",e.InsightsCardRelatedFilesShown="Insights_Card_RelatedFiles_Shown",e.InsightsCardRelatedFilesState="Insights_Card_RelatedFiles_State",e.InsightsCardRelatedFilesFileLinkClicked="Insights_Card_RelatedFiles_File_Link_Clicked",e.InsightsCardRelatedFilesSuggestedPromptsClicked="Insights_Card_RelatedFiles_SuggestedPrompts_Clicked",e.InsightsCardDocUrlFetchStatus="Insights_Card_RelatedFiles_DocUrlFetchStatus",e.InsightsCardCocoaSkillShown="Insights_Card_Cocoa_Skill_{Skill}_Shown",e.InsightsCardCocoaSkillState="Insights_Card_Cocoa_Skill_{Skill}_State",e.InsightsCardCocoaSkillLoaded="Insights_Card_Cocoa_Skill_{Skill}_Loaded",e.InsightsCardCocoaSkillClicked="Insights_Card_Cocoa_Skill_{Skill}_Clicked",e.InsightsCardCocoaSkillTimedOut="Insights_Card_Cocoa_Skill_{Skill}_TimedOut",e.InsightsCardCocoaSkillRetryClicked="Insights_Card_Cocoa_Skill_{Skill}_Retry_Clicked",e.InsightsCardCocoaSkillRetryTimedOut="Insights_Card_Cocoa_Skill_{Skill}_Retry_TimedOut",e.InsightsCardSummaryInvoked="Insights_Card_Summary_Invoked",e.InsightsCardAgentsShown="Insights_Card_Agents_Shown",e.InsightsCardAgentsState="Insights_Card_Agents_State",e.InsightsCardAgentsOpenButtonClicked="Insights_Card_Agents_Open_Button_Clicked",e.InsightsCardAgentsViewMoreAgentsClicked="Insights_Card_Agents_View_More_Agents_Clicked",e.InsightsCardAgentsExploreAgentsClicked="Insights_Card_Agents_Explore_Agents_Clicked",e.VoiceCopilotModeEntered="Voice_Copilot_Mode_Entered",e.BizchatHostContext="BizChat_Host_Context"}(s||(s={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode",e.ExtensibilityInfo="ExtensibilityInfo"}(c||(c={})),function(e){e.ContentGeneration="ContentGeneration",e.Commanding="Commanding",e.QAandSummaries="QAandSummaries",e.Suggestions="Suggestions",e.Others=""}(l||(l={})),function(e){e.ChatPaneLoad="ChatPaneLoad",e.Preload_ChatPaneLoad="Preload_ChatPaneLoad",e.CopilotChat="CopilotChat",e.Summary="Summarize",e.Podcast="Podcast",e.ChatQnA="Chat QnA",e.ChatAgents="Chat Agents",e.DocumentQnA="Document QnA",e.Commanding="Command",e.Handoff="Handoff",e.Draft="Draft",e.AddContent="AddContent",e.Customize="Customize",e.DesignerVisuals="Designer Visuals",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.ConversationalCopilot="ConversationalCopilot",e.RealtimeVoice="Realtime Voice",e.InteractiveReadAloud="Interactive Read Aloud"}(u||(u={})),function(e){e.ContentCreation="Content creation skill in Chat",e.BasicCommands="Basic commands",e.DocumentSummary="Document summary",e.SelfHelpSearch="Self-Help Search",e.InsertImage="Insert Image",e.SummaryNudge="Summary Nudge",e.AddDesignerImage="Add an image from Designer",e.CannedResponse="Canned Response",e.ProactiveSummary="Proactive summary",e.PodcastGeneration="Podcast generation",e.SummaryKeypoints="Summary in keypoints",e.ParagraphSummary="Summary in paragraph",e.InsertText="Insert Text",e.CoPilotHelp="CoPilot Help",e.ChatTopicChanged="Chat Topic Changed",e.Customize="Customize",e.ExtensibilityDeclarativeAgents="Extensibility Declarative Agents",e.ImageChat="Image Chat",e.ContentCardSummary="Content Card Summary",e.ContentCardSuggestedQnA="Content Card SuggestedQnA",e.ContentCardRelatedFiles="Content Card Related Files",e.ContentCardCocoaSkill="Content Card Cocoa Skill {Skill}",e.ContentCardAgents="Content Card Agents",e.RealtimeVoice="Realtime Voice",e.InteractiveReadAloud="Interactive Read Aloud",e[e.Unset=""]="Unset"}(d||(d={})),function(e){e.ChatEvents="ChatEvents",e.Latency="Latency",e.Error="Error",e.QueryDetails="QueryDetails",e.Chat="Chat",e.Microphone="Microphone"}(_||(_={})),function(e){e.CommandName="CommandName",e.IsCommandSuccessString="IsCommandSuccessString",e.UserQueryGuid="UserQueryGuid",e.HostSDXSessionID="HostSDXSessionID",e.Status="Status",e.EventOrder="EventOrder",e.ErrorCategory="ErrorCategory",e.ScenarioString="ScenarioString",e.IsCommandSuccess="IsCommandSuccess",e.Scenario="Scenario",e.Message="Message",e.TranspilationLatencyMSec="TranspilationLatencyMSec"}(p||(p={})),function(e){e.Initialize="Initialize",e.Executed="Executed"}(g||(g={})),function(e){e.ContentNotFound="ContentNotFound",e.Empty="Empty",e.Failed="Failed",e.PartialSuccess="PartialSuccess",e.None="None"}(f||(f={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response ",e.Text2ImageError="Text2Image Error",e.DesignerMiniError="Designer Mini Error Prevents Output"}(h||(h={})),function(e){e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA",e.DesignerVisuals="Create Designer Visuals"}(C||(C={})),function(e){e.NoChatResponseRenderedFromSydney="Error occurred because no chat response/error rendered by sydney",e.ErrorNotFound="Error occured because response returned doesn't have valid response/error field",e.UnsupportedAnnotation="Error occured because response has unsupported annotation",e.LanguageBlocked="Error occured because language is not supported",e.UnsupportedDocumentLanguage="Error occured because document language is not supported",e.UnsupportedPromptLanguage="Error occured because language of prompt is not supported",e.UnsupportedPromptRequestedLanguage="Error occured because language requested in the prompt is not supported",e.LocationParameter="Error occured  because execution on nth paragraph is not supported",e.OutOfScopeRequest="Error occured since the request is out of scope",e.RAI="Error occured because of offensive content",e.TimeOut="Timeout waiting for server",e.LessContent="Error occured because document length is too short",e.Throttled="Error occured because number of requests per hour limit exceeded",e.ProcessingDenied="Error occured because organisation policy doesn't allow to refer this content",e.LicensingOld="Error occured because copilot license couldn't be validated",e.BadTokenErrorOld="Input query contains invalid tokens",e.Generic="Error occured because copilot cannot perform the operation",e.BlockedByPostfilter="Error occured because output is blocked by filters",e.BlockedByPrefilter="Error occured because input is blocked by filters",e.OffensiveContentInUserInput="Error occured because input query is offensive",e.OffensiveInputContent="Offensive content detected in input content",e.OffensiveOutputContent="Offensive content detected in generated output",e.OffensiveSydneyOutput="Offensive content detected in generated Sydney output",e.BlockedByQualityCheck="Error occured because halllucination check has failed",e.ResourceUnavailable="Error occured because resource is unavailable",e.ScenarioThrottled="Error occured because scenario has issued too many requests",e.NotAvailable="Error occurred because API is not available",e.DoubleKeyEncryptedDocument="Error occured because document is double key encrypted",e.MissingExtractPermission="Error occured because extract permission is missing",e.MultipleQuestions="Error occurred  because multiple queries are not supported",e.Disambiguation="Error occurred  because of disambiguation",e.ODSLParsing="Error occurred because ODSL couldn't be parsed",e.ODSLSyntax="Error occurred because ODSL has syntax error",e.ContentNotFoundForCriteria="Error occurred because content cannot be found",e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.LightCommandingDisabled="Error occurred because commanding feature not enabled on client side",e.ODSLAndErrorNotFound="Error occurred because response returned doesn't have valid response/error field",e.ODSLExecutionTimeout="Error occurred because ODSL execution timed out",e.UnsupportedSVGError="Error occured because there is no support for svg",e.UnknownError="Error occurred because of an unclassifed issue",e.InputQueryTooLong="Input query is too long",e.InputQueryTooShort="Input query is too short",e.TokenIssue="Error occurred because of token",e.Unknown="Error is unknown",e.BadResponse="Error occurred because of bad response",e.UnsupportedMultiAgent="Input query involves multiple agents which is unsupported",e.InvalidQuery="Input query is invalid",e.LowScore="Language score is too low",e.UnknownLanguage="Detected language is unknown",e.SydneyUnsupportedLanguage="Unsupported language for Sydney",e.SydneyCancelledError="Connection to Sydney is cancelled",e.SkillFailedError="Skill failed error",e.SydneyDisengagement="Sydney disengagement error",e.UnsupportedProgram="Input query is not supported",e.ExcessTokenRequest="Excess tokens in the request",e.ExcessTokenResponse="Excess tokens in the response",e.MissingSignal="Error occurred because signal is missing in workflow",e.WrongTypeSignal="Error occurred because signal is invalid",e.DisambiguationRequired="Disambiguation is required",e.SameSlotDisambiguationLoop="Disambiguation loop detected with the same slot",e.PerpetualDisambiguationLoop="Perpetual disambiguation loop detected",e.Licensing="AugLoop failed to validate the user's Copilot entitlement",e.BadTokenError="AugLoop failed to validate the Copilot user token",e.GptSwitchAbortedQueryExecution="Gpt switch aborted query execution",e.Text2ImageGenericError="Text2Image failed to return requested image(s)",e.DesignerMiniAuthError="Designer Mini failed to display image options due to authentication error",e.DesignerMiniError="Designer Mini failed to display image options due to error",e.DesignerVisualsInferenceAPIError="Skill failed to properly generate entire response",e.DesignerVisualsUnsupportedImageType="Unsupported image type requested",e.OutOfCredits="Error occurred because of user is out of credits"}(m||(m={}));var v,E,y,b,T="UserQueryGuid";!function(e){e.HandoffStart="Handoff_Start",e.AppStart="App_Start",e.CopilotPaneStart="Copilot_Pane_Start",e.TaskPaneStart="TaskPane_Start",e.AppLoadStart="AppLoad_Start",e.ChatPaneLoaded="Chat_Pane_Loaded",e.HandoffMessageIdSent="Handoff_Message_Id_Sent",e.HandoffMessageIdProcessed="Handoff_Message_Id_Processed",e.HandoffMessageReceived="Handoff_Message_Received",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted",e.HandoffComplete="Handoff_Complete",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.PreloadCopilot="PreloadCopilot"}(v||(v={})),function(e){e.PromptType="promptType",e.SourceApp="sourceApp",e.IsModified="isModified",e.ScenarioName="scenarioName",e.FeatureName="featureName"}(E||(E={})),function(e){e.ContextTreeImplicitCount="ContextTreeImplicitCount",e.ContextTreeExplicitCount="ContextTreeExplicitCount",e.ContextTreeMergedCount="ContextTreeMergedCount",e.IgnoreImplicitContext="IgnoreImplicitContext",e.ImplicitContextObjectTypes="ImplicitContextObjectTypes",e.PolarisEntryPointObjectTypes="PolarisEntryPointObjectTypes",e.PolarisEntryPointIsValidSelection="PolarisEntryPointIsValidSelection"}(y||(y={})),function(e){e.ResponseParsingFailure="ResponseParsingFailure",e.NoErrorFoundInErrorObject="NoErrorFoundInErrorObject",e.InvalidFinalMessage="InvalidFinalMessage",e.UnsuccessfulCompletionStatus="UnsuccessfulCompletionStatus"}(b||(b={}))},146931:(e,t,n)=>{"use strict";n.d(t,{sL:()=>Ae,Ob:()=>Pe});var r=n(743032),o=n(811912),a=n(791165),i=n(990813),s=n(857835),c=n(461838),l=n(928499),u=n(379490),d=n(656904),_=n(309964),p=n(644275),g=n(555799),f=n(243912),h=n(602061),C=n(140889),m=n(565908),v=n(313222),E=n(606363),y=n(111246),b=n(441498),T=n(296955),I=n(965562),P=n(784567),A=n(211475),D=n(46727),S=n(610918),M=n(844807),O=n(934761),k=n(448397),L=n(871598),w=n(689265),R=n(242154),U=n(457476),B=n(997003),x=n(740389),W=n(407039),F=n(992950),N=n(556165),K=n(474785),H=n(720570),G=n(107182),Q=n(4026),j=n(86511),Y=n(127409),z=n(690763),q=n(663279),V=n(769449),Z=n(499011);function J(e){return!!(0,x.v1l)()&&("bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===Z.w.SELF_HELP)}function X(e,t){var n=e.adaptiveCards&&e.adaptiveCards.length>0,r=[],o="",a={featureName:C.CC.ChatQnA,subFeatureName:C.nk.SelfHelpSearch};if(n&&e.hiddenText===d.xZn.QuickAnswer){o=d.xZn.QuickAnswer;var i=(0,d.sj0)(),s=e.adaptiveCards[0],c=$(s,i,e.messageId);r.push(c)}else if(n&&e.hiddenText===d.xZn.HelpArticle)if(o=d.xZn.HelpArticle,1===e.adaptiveCards.length){var u=(0,d.Vgn)(),_=e.adaptiveCards[0],p=$(_,u,e.messageId);r.push(p)}else{var h,m={chatCardType:g._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,d.sj0)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:f.O.None,isFailure:!1,messageId:e.messageId,feedbackData:(0,q.as)("SelfHelpSearch",a),telemetryData:(0,V.YI)(C.CC.ChatQnA)},addCardToChatHistory:!0},v=e.adaptiveCards.map((function(t){return $(t,e.messageId)}));(h=r).push.apply(h,[m].concat((0,l._)(v)))}else{o="N/A";var E={chatCardType:g._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,d.ZAw)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:f.O.None,isFailure:!0,messageId:e.messageId,feedbackData:(0,q.as)("SelfHelpSearch",a),telemetryData:(0,V.YI)(C.CC.ChatQnA)},addCardToChatHistory:!0};r.push(E)}oe(o);var y=!0,b=!1,T=void 0;try{for(var I,P=r[Symbol.iterator]();!(y=(I=P.next()).done);y=!0){var A=I.value;t.displayResponse(A)}}catch(e){b=!0,T=e}finally{try{y||null==P.return||P.return()}finally{if(b)throw T}}}var $=function(e,t,n){var r,o={featureName:C.CC.ChatQnA,subFeatureName:C.nk.SelfHelpSearch};return{chatCardType:g._.SelfHelpAdaptiveCard,chatMessageData:{selfHelpAdaptiveCardProps:{user:"chat",headerText:t,sourceLabel:{iconName:"unknown",text:(0,d.x1n)()},cardData:e,customActions:(r={},(0,i._)(r,ee.JsonTypeName,ee),(0,i._)(r,ne.JsonTypeName,ne),(0,i._)(r,re.JsonTypeName,re),(0,i._)(r,te.JsonTypeName,te),r)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:f.O.Footer,feedbackData:(0,q.as)("SelfHelpSearch",o),isFailure:!1,messageId:n,telemetryData:(0,V.YI)(C.CC.ChatQnA)},addCardToChatHistory:!0}},ee=function(e){(0,G._)(n,e);var t=(0,Q._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,i._)((0,H._)(e),"tcid",void 0),e}return(0,a._)(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){ae("ExecuteTCID",e),this.tcid&&Office.context.ui.executeFeature(this.tcid)}}]),n}(z.Y);(0,i._)(ee,"JsonTypeName","SelfHelpAction.ExecuteTCID"),(0,i._)(ee,"tcidProperty",new Y.NumProperty(Y.Versions.v1_0,"tcid")),(0,u.__decorate)([Y.property(ee.tcidProperty)],ee.prototype,"tcid",void 0);var te=function(e){(0,G._)(n,e);var t=(0,Q._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,i._)((0,H._)(e),"tabId",void 0),(0,i._)((0,H._)(e),"anchorId",void 0),(0,i._)((0,H._)(e),"calloutTitle",void 0),(0,i._)((0,H._)(e),"calloutText",void 0),(0,i._)((0,H._)(e),"delay",void 0),e}return(0,a._)(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){ae("ShowTeachingCallout",e),this.tabId&&this.anchorId&&this.calloutTitle&&this.calloutText&&OfficeFirstParty.Notification.addNotification(OfficeFirstParty.Notification.callout({target:this.tabId,title:this.calloutTitle,content:this.calloutText,useTeachingStyles:!0}),{navigationalOptions:{controlToFind:this.anchorId}})}}]),n}(z.Y);(0,i._)(te,"JsonTypeName","SelfHelpAction.ShowTeachingCallout"),(0,i._)(te,"tabIdProperty",new Y.NumProperty(Y.Versions.v1_0,"tabId")),(0,i._)(te,"anchorIdProperty",new Y.NumProperty(Y.Versions.v1_0,"anchorId")),(0,i._)(te,"calloutTitleProperty",new Y.StringProperty(Y.Versions.v1_0,"calloutTitle")),(0,i._)(te,"calloutTextProperty",new Y.StringProperty(Y.Versions.v1_0,"calloutText")),(0,i._)(te,"delayProperty",new Y.NumProperty(Y.Versions.v1_0,"delay")),(0,u.__decorate)([Y.property(te.tabIdProperty)],te.prototype,"tabId",void 0),(0,u.__decorate)([Y.property(te.anchorIdProperty)],te.prototype,"anchorId",void 0),(0,u.__decorate)([Y.property(te.calloutTitleProperty)],te.prototype,"calloutTitle",void 0),(0,u.__decorate)([Y.property(te.calloutTextProperty)],te.prototype,"calloutText",void 0),(0,u.__decorate)([Y.property(te.delayProperty)],te.prototype,"delay",void 0);var ne=function(e){(0,G._)(n,e);var t=(0,Q._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,i._)((0,H._)(e),"url",void 0),e}return(0,a._)(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){var t;(ae("OpenUrl",e),this.url)&&(null===(t=window)||void 0===t||t.open(this.url))}}]),n}(z.Y);(0,i._)(ne,"JsonTypeName","SelfHelpAction.OpenUrl"),(0,i._)(ne,"urlProperty",new Y.StringProperty(Y.Versions.v1_0,"url")),(0,u.__decorate)([Y.property(ne.urlProperty)],ne.prototype,"url",void 0);var re=function(e){(0,G._)(n,e);var t=(0,Q._)(n);function n(){var e;return(0,o._)(this,n),e=t.apply(this,arguments),(0,i._)((0,H._)(e),"articleId",void 0),e}return(0,a._)(n,[{key:"getJsonTypeName",value:function(){return n.JsonTypeName}},{key:"executeWithTelemetry",value:function(e){ae("ShowHelpPane",e),this.articleId&&OfficeFirstParty.Copilot.launchHelpPaneByArticleIdString(this.articleId)}}]),n}(z.Y);(0,i._)(re,"JsonTypeName","SelfHelpAction.ShowHelpPane"),(0,i._)(re,"articleIdProperty",new Y.StringProperty(Y.Versions.v1_0,"articleId")),(0,u.__decorate)([Y.property(re.articleIdProperty)],re.prototype,"articleId",void 0);var oe=function(e){var t;k.B.getInstance().sendChatEventTelemetry((0,V.pN)((t={},(0,i._)(t,C.h3.ChatEventType,C.a5.SelfHelpContentShown),(0,i._)(t,C.h3.ChatEventParameters,JSON.stringify({ContentType:e})),t))),k.B.getInstance().logTriedEvent(j.rf.QAandSummaries,C.CC.ChatQnA,j.RX.Ask,C.nk.SelfHelpSearch)},ae=function(e,t){var n;if(t){var r=(0,V.zq)(t),o=r.correlationId;r.featureName;void 0!==o&&k.B.getInstance().setQueryGuid(o)}k.B.getInstance().sendChatEventTelemetry((0,V.pN)((n={},(0,i._)(n,C.h3.ChatEventType,C.a5.SelfHelpActionClicked),(0,i._)(n,C.h3.ChatEventParameters,JSON.stringify({ActionType:e})),n))),k.B.getInstance().logKeptEvent(C.CC.ChatQnA,C.nk.SelfHelpSearch,j.RX.Ask,j.rf.QAandSummaries),t&&k.B.getInstance().setQueryGuid("")},ie=n(832713),se=n(862853),ce=n(598309),le=n(249002),ue=n(805486),de=n(932554),_e=n(889899),pe=n(798050),ge=n(575757),fe=n(267836),he=n(192318),Ce="bot",me="Chat",ve="WordFluxCopilotApp",Ee=[],ye=[],be=[],Te=[],Ie=[],Pe="",Ae=function(){function e(){var t=this;(0,o._)(this,e),(0,i._)(this,"basin",void 0),(0,i._)(this,"accessPath",void 0),(0,i._)(this,"uniqueId",void 0),(0,i._)(this,"shouldShowUndoButton",!1),(0,i._)(this,"shouldUpdateSuggestionPool",!0),(0,i._)(this,"conversationId",void 0),(0,i._)(this,"isStreaming",!1),(0,i._)(this,"isFirstResponse",!0),(0,i._)(this,"isFirstStreamChunk",!0),(0,i._)(this,"isFirstValidMessageReceived",!1),(0,i._)(this,"odslSkillInvoked",!1),(0,i._)(this,"odslInsertionScenario",!1),(0,i._)(this,"shouldUpdateDocSensitivityAtStreamEnd",!1),(0,i._)(this,"streamChunks",[]),(0,i._)(this,"paragraphChunks",""),(0,i._)(this,"messageId",""),(0,i._)(this,"pluginAuthError",void 0),(0,i._)(this,"annotationResponses",[]),(0,i._)(this,"signals",[]),(0,i._)(this,"info",{}),(0,i._)(this,"isPersonalizationSkillResponse",!1),(0,i._)(this,"confirmationCardProps",void 0),(0,i._)(this,"codePreviewProps",void 0),(0,i._)(this,"isDisengagedError",!1),(0,i._)(this,"primaryQueryId",""),(0,i._)(this,"groupedMessageIds",new Set),(0,i._)(this,"sydneyEndpoint",void 0),(0,i._)(this,"locale",void 0),(0,i._)(this,"logResponseFromCache",(function(e,n){try{var r,o=JSON.parse(null==e?void 0:e.responseMetadata);if((null==o?void 0:o.summarySource)===ge.F.Cache)k.B.getInstance().sendChatEventTelemetry((0,V.pN)((r={},(0,i._)(r,C.h3.ChatEventType,C.a5.InsightsCardSummaryIsFromCache),(0,i._)(r,C.h3.UserQueryGuid,n),r)))}catch(e){t.handleInsightsCardErrorContent(e,n,!0)}})),(0,i._)(this,"handleInsightsCardErrorTelemetry",(function(e,t,n,r,o){var a,s,c=k.B.getInstance();c.sendChatEventTelemetry((0,V.pN)((a={},(0,i._)(a,C.h3.ChatEventType,C.a5.InsightsCardSummaryError),(0,i._)(a,C.h3.ChatEventParameters,t),(0,i._)(a,C.h3.ChatErrorType,n),(0,i._)(a,C.h3.ChatErrorKey,r),(0,i._)(a,C.h3.UserQueryGuid,e),a))),c.sendErrorTelemetry((0,V.pN)((s={},(0,i._)(s,C.IC.ErrorMessage,o),(0,i._)(s,C.IC.ErrorCategory,_.S2.InsightsCardSummary),(0,i._)(s,C.IC.ErrorCode,r),(0,i._)(s,C.h3.UserQueryGuid,e),s)))})),(0,i._)(this,"handleInsightsCardErrorContent",(function(e,n,r,o){try{var a,s=(null==e?void 0:e.json)?JSON.parse(null==e?void 0:e.json):void 0,c=null!==(a=null==e?void 0:e.category)&&void 0!==a?a:h.u1i,l=s?s.code:h.u1i,u=c.concat((0,h.jwY)(l)?h.u1i:"_".concat(l)),p=u,g=l;u!==h.u1i||r?u===h.u1i&&r&&(p=C.Qw.ResponseParsingFailure,g=C.Nr.ResponseParsingFailure):(p=C.Qw.NoErrorFoundInErrorObject,g=C.Nr.NoErrorFoundInErrorObject);var f=r?"Summary Parsing Exception":"Summary Workflow Error Detected",m=r?null==e?void 0:e.message:JSON.stringify(e);t.handleInsightsCardErrorTelemetry(n,"".concat(C.a5.InsightsCardSummaryError,"_").concat(p),r?d.T__.Client:d.T__.Server,null!=g?g:h.u1i,"".concat(f,", Error: ").concat(m))}catch(e){var v;(0,R.cY)("Failed to parse error object on the Final Message for InsightsCard"),k.B.getInstance().sendErrorTelemetry((0,V.pN)((v={},(0,i._)(v,C.IC.ErrorMessage,"Failed to parse error object on the Final Message for InsightsCard"),(0,i._)(v,C.IC.ErrorCategory,_.S2.Error),v)))}null==o||o(n,{sections:[],markdownSummary:h.u1i},pe.x.ERRORED)})),this.basin=new m.Basin,O.P.getInstance().addHandlerCleanup(this.cleanupStreamHandler),this.info={skill:F.B.Sydney,error:"None"}}return(0,a._)(e,[{key:"getConversationId",value:function(){return this.conversationId}},{key:"resetShouldUpdateSuggestionPool",value:function(){this.shouldUpdateSuggestionPool=!0}},{key:"getWordAppCopilotStreamingState",value:function(){return this.isStreaming}},{key:"setWordAppCopilotStreaming",value:function(){this.isStreaming=!0}},{key:"resetWordAppCopilotStreamingState",value:function(){this.isStreaming=!1,this.isFirstResponse=!0,this.isFirstStreamChunk=!0,this.isFirstValidMessageReceived=!1,this.streamChunks=[],this.shouldShowUndoButton=!1,this.shouldUpdateSuggestionPool=!0,this.odslSkillInvoked=!1,this.odslInsertionScenario=!1,this.shouldUpdateDocSensitivityAtStreamEnd=!1,this.messageId="",this.paragraphChunks="",this.pluginAuthError=void 0,this.annotationResponses=[],this.signals=[],this.info={},this.isPersonalizationSkillResponse=!1,this.confirmationCardProps=void 0,this.isDisengagedError=!1,this.primaryQueryId="",this.groupedMessageIds.clear()}},{key:"logAnnotationResponses",value:function(e,t,n,r){var o={annotationType:e,isStreamingAnnotation:n,responseTime:t,status:r};this.annotationResponses.push(o)}},{key:"getConversationDebugLog",value:function(){return Ee}},{key:"logSignalTypes",value:function(e){this.signals.push(e)}},{key:"cleanupStreamHandler",value:function(){e.getInstance().basin=new m.Basin,e.getInstance().accessPath="",e.getInstance().uniqueId="",e.getInstance().shouldShowUndoButton=!1,e.getInstance().isStreaming=!1,e.getInstance().isFirstResponse=!0,e.getInstance().isFirstStreamChunk=!0,e.getInstance().isFirstValidMessageReceived=!1,e.getInstance().streamChunks=[],e.getInstance().odslSkillInvoked=!1,e.getInstance().odslInsertionScenario=!1,e.getInstance().shouldUpdateDocSensitivityAtStreamEnd=!1,e.getInstance().messageId="",e.getInstance().paragraphChunks="",e.getInstance().pluginAuthError=void 0,e.getInstance().annotationResponses=[],e.getInstance().signals=[],e.getInstance().info={},e.getInstance().isPersonalizationSkillResponse=!1,e.getInstance().confirmationCardProps=void 0,e.getInstance().codePreviewProps=void 0}},{key:"isValidMessageForRendering",value:function(e){return(null==e?void 0:e.locale)&&(this.locale=e.locale),(0,x.Ikw)()?e.author===Ce&&(void 0===e.messageType||e.messageType===me||e.messageType===A.n3.RenderCardRequest||e.messageType===A.n3.RequireHumanInTheLoop):e.author===Ce&&e.adaptiveCards&&(void 0===e.messageType||e.messageType===me||e.messageType===A.n3.RenderCardRequest||e.messageType===A.n3.RequireHumanInTheLoop)||e.authErrors&&e.authErrors.length>0||!1}},{key:"isDisengagedResponse",value:function(e){return"bot"===e.author&&e.messageType===A.n3.Disengaged}},{key:"isInternalLoadingMessage",value:function(e){return e.messageType===A.n3.InternalSearchQuery||e.messageType===A.n3.InternalLoaderMessage}},{key:"isSummaryChatResponse",value:function(e){return e.author===Ce&&(void 0===e.messageType||e.messageType===me)&&e.contentOrigin===Z.w.SUMMARIZE}},{key:"isBasicChatResponse",value:function(e){return e.author===Ce&&(void 0===e.messageType||e.messageType===me)&&e.contentOrigin===Z.w.BASIC_CHAT}},{key:"isPersonalizationResponse",value:function(e){return e===Z.w.PERSONALIZATION_START||e===Z.w.PERSONALIZATION_END||e===Z.w.PERSONALIZATION_EXPLAIN||e===Z.w.PERSONALIZATION_UPDATE||e===Z.w.PERSONALIZATION_FORCED_DELETE}},{key:"summaryMessageExists",value:function(e){var t,n=this;return null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return n.isSummaryChatResponse(e)}))}},{key:"basicChatMessageExists",value:function(e){var t,n=this;return null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return n.isBasicChatResponse(e)}))}},{key:"isSummarySkillResponse",value:function(e){return e.author===Ce&&(void 0===e.messageType||e.messageType===me)&&e.contentOrigin===Z.w.WORD_SUMMARIZE||e.contentOrigin===Z.w.SUMMARIZE_SINGLE_SHOT}},{key:"isImageSkillResponse",value:function(e){return e.contentOrigin===Z.w.IMAGE_CHAT}},{key:"summarySkillExists",value:function(e){var t,n=this;return null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return n.isSummarySkillResponse(e)}))}},{key:"imageSkillExists",value:function(e){var t,n=this;return null===(t=e.chatResponse.messages)||void 0===t?void 0:t.find((function(e){return n.isImageSkillResponse(e)}))}},{key:"isWebOrEnterpriseEnabled",value:function(){return(0,se.gc)()||(0,se.pX)()}},{key:"isWebOrEnterpriseQuery",value:function(e){return e.startsWith(d.klO)||e.startsWith(d.I4U)||e.startsWith(d.tE5)}},{key:"getSuggestionStrings",value:function(e){var t=[],n=!0,r=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var s=a.value;"Suggestion"===s.messageType&&t.push(s.text)}}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return t}},{key:"logDiagnostics",value:function(e){(null==e?void 0:e.conversationId)&&(0,R.cY)("conversation id from Word App Copilot: "+e.conversationId)}},{key:"storeDebugInfoForResponse",value:function(e,t,n,r){var o,a,i,s,c,l,u,d,_,p=!(!r&&!n);(this.info.skill=null!==(s=this.info.skill)&&void 0!==s?s:F.B.Sydney,Pe)||(Pe=null===(c=e.chatResponse)||void 0===c?void 0:c.sessionKey);if(this.info.sessionId=Pe,this.info.status=null===(o=e.chatResponse)||void 0===o?void 0:o.status,this.info.queryId=null!==(l=this.info.queryId)&&void 0!==l?l:e.queryId,this.info.timestamp=e.timestamp,r)this.logAnnotationResponses(L.H.getTypeName(),(0,h.WUi)(t),!1,e.status),this.info.messageType=null!==(u=this.info.messageType)&&void 0!==u?u:"null",this.info.error=e.error;else if(n){var g,f;this.info.queryId=null!==(f=this.info.queryId)&&void 0!==f?f:n.queryId,this.info.messageType=n.messageType,this.info.timestamp=n.timestamp,this.info.sensitivity=null===(g=n.sensitivityLabel)||void 0===g?void 0:g.displayName,this.info.groundingDataCount=n.groundingDataCount}(this.info.resultType=null===(a=e.chatResponse)||void 0===a?void 0:a.resultType,this.info.optionSets=null===(i=e.chatResponse)||void 0===i?void 0:i.optionsSets,this.info.annotationResponses=this.annotationResponses,this.info.signals=this.signals,p)&&(this.info.LCFR=1e3*(0,h.WUi)(t),null!==(_=(d=this.info).FCFR)&&void 0!==_||(d.FCFR=this.info.LCFR),this.info.FCFRgoals=(0,ce.k7)(x.YqN.FCFR),this.info.LCFRgoals=(0,ce.k7)(x.YqN.LCFR),this.info.shouldShowPerfCounters=!0,(0,x.dS)()&&n&&(n.debugInfo=this.info))}},{key:"addDebugToActionButtons",value:function(e,t,n,r){var o,a=(0,U.Re)(t,n,r);a&&(null==e||(o=e).push.apply(o,(0,l._)(a)))}},{key:"handleStreamEndInternal",value:function(e,t,n){var r,o,a,c=this,l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,R.cY)("Word App Copilot streaming ended."),this.logDiagnostics(e);var u=!0,d=!1,_=void 0;try{for(var p,g=this.streamChunks[Symbol.iterator]();!(u=(p=g.next()).done);u=!0){var f=p.value;this.logAnnotationResponses(L.H.getTypeName(),f.augloopResponseTime,!0,f.status)}}catch(e){d=!0,_=e}finally{try{u||null==g.return||g.return()}finally{if(d)throw _}}this.logAnnotationResponses(L.H.getTypeName(),(0,h.WUi)(t),!1,e.chatResponse.status),(0,V.G4)(L.H.getTypeName(),null==e?void 0:e.queryId,JSON.stringify(this.streamChunks),t,!0,!1,n),n||(null==e?void 0:e.conversationId)&&(this.conversationId=e.conversationId),(null===(r=this.sydneyEndpoint)||void 0===r?void 0:r.length)||(this.sydneyEndpoint=e.sydneyEndpoint);var m,v,E=(null===(o=e.chatResponse.messages)||void 0===o?void 0:o.filter((function(e){return c.isValidMessageForRendering(e)&&c.groupedMessageIds.has(e.messageId)})))||[];if((0,x.fX6)()&&E.length>0){if(m=(0,s._)({},E[0]),E.length>1){var y="",b=!0,T=!1,I=void 0;try{for(var P,A=E[Symbol.iterator]();!(b=(P=A.next()).done);b=!0){var M=P.value,O=this.getFullAdaptiveCardText(M);O&&(y&&(y+="\n\n"),y+=O)}}catch(e){T=!0,I=e}finally{try{b||null==A.return||A.return()}finally{if(T)throw I}}y&&(m.text=y);var w=E.flatMap((function(e){return(e.sourceAttributions||[]).filter((function(e){return"true"===e.isCitedInResponse.toLocaleLowerCase()}))}));w.length>0&&(m.sourceAttributions=w)}(0,R.cY)("Merged final message from multiple streams is",m)}else{var U;m=null===(U=e.chatResponse.messages)||void 0===U?void 0:U.find((function(e){return c.isValidMessageForRendering(e)}))}(0,R.cY)("Final text is -",m),this.isFirstValidMessageReceived||(this.isFirstValidMessageReceived=!0,k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.FirstValidMessageReceivedTime,(0,h.WUi)(t))))),(0,le.MK)(m),k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.ContentOrigin,null!==(v=null==m?void 0:m.contentOrigin)&&void 0!==v?v:Z.w.UNKNOWN)));var B=W.s.getInstance().getSkillName();if(B===F.B.Designer||B===F.B.Summary||B===F.B.Sydney){var N,K=(N={},(0,i._)(N,C.h3.ChatEventType,C.a5.QnAResponseReceivedFromSydney),(0,i._)(N,C.h3.ChatEventParameters,L.H.getTypeName()),N);B===F.B.Designer?(this.info.skill=F.B.Designer,K[C.h3.ChatEventType]=C.a5.DesignerGraphicsResponseReceivedFromSydney,K[C.CT.FeatureName]=C.CC.DesignerVisuals,K[C.CT.SubFeatureName]=C.nk.AddDesignerImage,D.h.logSurveyTriggerEvent(S.w2.WordCopilotCreate,!0),D.h.logSurveyTriggerEvent(S.w2.WordCopilotDesigner,!0)):B===F.B.Summary?(this.info.skill=F.B.Summary,K[C.h3.ChatEventType]=n?C.a5.SummaryResponseReceivedFromSkill:C.a5.SummaryResponseReceivedFromSydney):B===F.B.Sydney?(this.info.skill=F.B.Sydney,K[C.h3.ChatEventType]=C.a5.QnAResponseReceivedFromSydney):B===F.B.ReviewerAgent&&(this.info.skill=F.B.ReviewerAgent,K[C.h3.ChatEventType]=C.a5.LaunchReviewerAgentResponseReceivedFromSydney),(null==e?void 0:e.queryId)&&(this.info.queryId=e.queryId,K[C.h3.UserQueryGuid]=null==e?void 0:e.queryId),k.B.getInstance().sendChatEventTelemetry((0,V.pN)(K))}var H=(0,le.EJ)(m,!0),G=null==m||null===(a=m.contentOrigin)||void 0===a?void 0:a.toLowerCase();return this.isPersonalizationResponse(G)&&(this.isPersonalizationSkillResponse=!0,k.B.getInstance().sendLatencyTelemetry([{key:C.CT.PersonalizationResponseTime,value:(0,h.WUi)(t)}]),(0,h.tpg)()&&(0,h.MCQ)((new Date).getTime())),(B!==F.B.Summary&&B!==F.B.BasicChat&&B!==F.B.ContentCreation&&B!==F.B.SelfHelp||G===Z.w.CANNED_RESPONSE||G===Z.w.SUMMARIZE_SINGLE_SHOT&&!l||this.isPersonalizationResponse(G))&&k.B.getInstance().logTriedEvent(H.capability,H.featureName,H.verb,H.subFeature),m}},{key:"checkIfSingleShotResponseMessage",value:function(e){var t,n=null==e||null===(t=e.contentOrigin)||void 0===t?void 0:t.toLowerCase();return n===Z.w.CANNED_RESPONSE||n===Z.w.DEBUG_COMMAND||n===Z.w.SUMMARIZE_SINGLE_SHOT||(0,x.tiu)().split("@").includes(null!=n?n:"")}},{key:"handleStreamEndForSharedCopilot",value:function(t,n,o,a){var c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],f=arguments.length>5?arguments[5]:void 0,m=arguments.length>6?arguments[6]:void 0,v=arguments.length>7?arguments[7]:void 0,E=arguments.length>8?arguments[8]:void 0,b=this;return(0,r._)((function(){var r,T,P,M,w,B,H,G,Q,j,Y,z,X,$,ee,te,ne,re,oe,ae,se,ce,ue,de,_e,pe,ge,fe,he,Ce,me,ve,ye,be,Te,Ie,Pe,Ae,De,Se,Me,Oe,ke,Le,we,Re,Ue,Be,xe,We,Fe,Ne,Ke;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:return r=b.handleStreamEndInternal(t,o,a,c),(0,x.uRc)()&&E&&(r.text=E),(0,x.UJf)()&&b.storeDebugInfoForResponse(t,o,r),T=(0,x.lH6)()&&(0,x.IaT)()?t.chatMessageHeader:void 0,(0,x.CIC)()&&b.isDisengagedError?(P=I.p.getErrorHandlingStrategy(t),M=P.getErrorMessage(t,b.isDisengagedError),w=!e.getInstance().getWordAppCopilotStreamingState(),B=!a||a&&w,H={featureName:C.CC.CopilotChat,errorMessage:M.message},G=(0,s._)({},b.info),(0,U.KY)(M.message,!0,M.helpLink,void 0,void 0,!0,B,H,M.linkMessageText,G,m,f,M.linkSuffix),O.P.getInstance().removeContextId(null==t?void 0:t.queryId),b.resetWordAppCopilotStreamingState(),W.s.getInstance().resetData(),(0,x.UxI)()&&h.xPp.setIsAddinFlow(!1,(function(){(0,h.An1)(y.$.getInstance().getCopilotRef(),!1)})),[2]):a?(b.handleStreamEndForSkill(t,r,n,o,f,m,v),[3,3]):[3,1];case 1:return Q=(null==r?void 0:r.contentOrigin)===Z.w.EDIT_DOCUMENT,j=!1,Y=(null==r?void 0:r.offense)&&r.offense!==A.h2.None&&r.offense!==A.h2.Unknown,[4,b.processConversationSensitivityLabel(t)];case 2:if(u.sent(),r&&(k.B.getInstance().sendChatEventTelemetry([{key:C.h3.ChatEventType,value:C.a5.FinalValidMessageReceivedFromSydney},{key:C.h3.ChatEventParameters,value:"messageIds_".concat(r.messageId,", ").concat(b.messageId,"; ContentOrigin: ").concat(null==r?void 0:r.contentOrigin)}]),j=Y||void 0!==(null==t?void 0:t.error)||(null==r?void 0:r.resultType)===A.gL.ApologyResponseReturned||(null==r?void 0:r.contentOrigin)===Z.w.APOLOGY,W.s.getInstance().getSkillName()===F.B.Sydney&&D.h.logSurveyTriggerEvent(S.w2.WordCopilotAsk,!j)),z=!1,b.messageId?!r||J(r)||(0,N.Ep)(r)||(0,K.xE)(r)||!(r.messageId===b.messageId||(0,x.fX6)()&&t.chatResponse.queryId===b.primaryQueryId||Q&&(0,x.fWR)())?z=!0:((0,R.cY)("Message id was set. Updating final message rendered"),ae=(0,ie.yu)(),se=(0,h.DF)(t,(0,x.LSW)(),(0,x.DtK)()),ce=(0,x.WNl)(),ue={allowImages:se||ce,enableLinkDataDownload:se,disableLinksProcessing:!1},b.updateLastRenderedMessage(r,n,Q,ae,!0,m,f,v,T,ue)):(X=y.$.getInstance().getLastMessage(!1),$=null==X?void 0:X.body.user,(0,R.cY)("Message Id does not exist, ChatUser: ".concat($)),k.B.getInstance().sendChatEventTelemetry([{key:C.h3.ChatEventType,value:C.a5.LastChatMessageUserType},{key:C.h3.ChatEventParameters,value:"MessageUserType_".concat($)}]),X&&$===p.Q9.Chat?(te=null!==(ee=X.messageType)&&void 0!==ee?ee:g._.MarkdownCard,(0,R.cY)("Message id was not set. Stopping loading ui for last message"),(0,x.UJf)()&&(re=(0,s._)({},b.info),Ee.push(re),v(),oe=null===(ne=X.actionBarButtons)||void 0===ne?void 0:ne.slice(),b.addDebugToActionButtons(oe,re,m,f),X.actionBarButtons=oe),y.$.getInstance().updateLastMessage({chatCardType:te,stopLoadingUi:!0,addCardToChatHistory:!1,chatMessageBodyData:(0,x.lH6)()&&(0,x.SBW)()?{actionButtonList:(0,l._)((0,h.M79)(y.$.getInstance().getCopilotRef())),feedbackData:(0,q.as)(void 0,(0,h.quJ)())}:void 0})):z=!0),de=(0,le.EJ)(r),_e=z&&b.checkIfSingleShotResponseMessage(r),(0,R.cY)("Is SingleShotResponseMessage: ".concat(_e," and checkContentOrigin: ").concat(z)),_e&&(null==r?void 0:r.text))ge={featureName:de.featureName,subFeatureName:de.subFeature},(0,U.wT)(null==r?void 0:r.text,r.messageId,ge,(null===(pe=r.contentOrigin)||void 0===pe?void 0:pe.toLowerCase())===Z.w.CANNED_RESPONSE),k.B.getInstance().sendLatencyTelemetry((0,V.pN)((fe={},(0,i._)(fe,C.CT.FeatureName,de.featureName),(0,i._)(fe,C.CT.UserPerceivedLatency,(0,h.WUi)(o)),fe)));else if((0,x.Ggk)()){if(he=y.$.getInstance().getLastMessage(!1),Ce=!1,null==t?void 0:t.error){if((be=I.p.getErrorHandlingStrategy(t))&&he&&he.body.user===p.Q9.Human)return k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.UserQueryGuid,null==t?void 0:t.queryId))),Te=be.getErrorMessage(t),(0,U.FN)(Te.message,!0,Te.helpLink,void 0,de.featureName),O.P.getInstance().removeContextId(null==t?void 0:t.queryId),b.resetWordAppCopilotStreamingState(),W.s.getInstance().resetData(),(0,x.UxI)()&&h.xPp.setIsAddinFlow(!1,(function(){(0,h.An1)(y.$.getInstance().getCopilotRef(),!1)})),[2];try{De=(null==t||null===(Ie=t.error)||void 0===Ie?void 0:Ie.json)?JSON.parse(null==t||null===(Pe=t.error)||void 0===Pe?void 0:Pe.json):void 0,ye=(null!==(Se=null==t||null===(Ae=t.error)||void 0===Ae?void 0:Ae.category)&&void 0!==Se?Se:"")+"_"+(De?De.code:"")}catch(e){(0,R.cY)("failed to parse error object on the Final Message"),k.B.getInstance().sendErrorTelemetry((0,V.pN)((Me={},(0,i._)(Me,C.IC.ErrorMessage,"failed to parse error object on the Final Message"),(0,i._)(Me,C.IC.ErrorCategory,_.S2.Error),Me)))}(null==ye?void 0:ye.includes("insert_graphic"))?(Oe=(0,N.jo)(ye),ke=Oe.designerVisualsErrorResultType,Le=Oe.designerVisualsASHAErrorDetails,me=ke,ve=Le):(k.B.getInstance().sendChatEventTelemetry([{key:C.h3.ChatEventType,value:C.a5.UnexpectedErrorObjectReceived},{key:C.h3.ChatEventParameters,value:ye}]),me=C.a5.ErrorInExecution,ve=(0,V.Uv)(C.G8.UnclassifiedError,C.av.UnknownError))}else Y&&((0,U.D9)(r.offense),Ce=!0);if(he&&he.body.user===p.Q9.Human)return k.B.getInstance().sendChatEventTelemetry([{key:C.h3.ChatEventType,value:C.a5.ContentOriginInFinalResponse},{key:C.h3.ChatEventParameters,value:null!==(we=null==r?void 0:r.contentOrigin)&&void 0!==we?we:Z.w.UNKNOWN}]),k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.UserQueryGuid,null==t?void 0:t.queryId))),ve||(ve=(0,V.Uv)(C.G8.UnclassifiedError,C.av.NoChatResponseRenderedFromSydney)),(0,R.cY)("No chat message has been rendered. Rendering error response from final annotation if any."),Re=Ce?void 0:{chatEventType:null!=me?me:C.a5.NoChatResponseRenderedFromSydney,chatEventParam:L.H.getTypeName(),chatErrorType:d.T__.Client,ashaErrorDetails:{vetoName:ve.vetoName,errorString:ve.errorString,featureName:ve.featureName}},k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.FeatureName,ve.featureName))),Ue=ye||"UnClassifiedError",(null==r?void 0:r.text)?(Be={featureName:de.featureName,errorMessage:Ue},(0,U.R1)(r.text,!0,Re,void 0,Be)):(k.B.getInstance().sendChatEventTelemetry([{key:C.h3.ChatEventType,value:C.a5.FinalMessageTextNotFound},{key:C.h3.ChatErrorKey,value:"AugloopErrorMessage"}]),xe={errorMessage:(0,d.BFD)(),featureName:de.featureName,errorType:Ue},(0,U.KY)((0,d.BFD)(),!0,void 0,Re,de.featureName,void 0,void 0,xe)),O.P.getInstance().removeContextId(null==t?void 0:t.queryId),b.resetWordAppCopilotStreamingState(),W.s.getInstance().resetData(),(0,x.UxI)()&&h.xPp.setIsAddinFlow(!1,(function(){(0,h.An1)(y.$.getInstance().getCopilotRef(),!1)})),[2];ve&&(0,U.A7)(d.T__.Server,ye,null!=me?me:C.a5.ErrorInExecution,ye,ve)}We=b.summaryMessageExists(t),Fe=b.basicChatMessageExists(t),Ne=!b.odslSkillInvoked&&!We&&!Fe&&!(0,h.tpg)()||j,(0,U.ow)(!1,!1,!((0,x.lH6)()&&(0,h.tpg)()),Ne,j),O.P.getInstance().removeContextId(null==t?void 0:t.queryId),b.resetWordAppCopilotStreamingState(),W.s.getInstance().resetData(),(0,x.UxI)()&&h.xPp.setIsAddinFlow(!1,(function(){(0,h.An1)(y.$.getInstance().getCopilotRef(),!1)})),y.$.getInstance().updateLoaderStrings(null!==(Ke=(0,d.wM6)().get(d.Aec.Default))&&void 0!==Ke?Ke:[]),u.label=3;case 3:return[2]}}))}))()}},{key:"handleStreamEndForSkill",value:function(t,n,o,a,c,l,d){var g=this;return(0,r._)((function(){var r,f,m,v,E,b,T,P,M,L,w,B,W,F,N,K,H,G,Q,j,Y,z;return(0,u.__generator)(this,(function(u){if(r=!1,f=(0,x.lH6)()&&(0,x.IaT)()?t.chatMessageHeader:void 0,n&&(k.B.getInstance().sendChatEventTelemetry([{key:C.h3.ChatEventType,value:C.a5.FinalValidMessageReceivedFromSkill},{key:C.h3.ChatEventParameters,value:"messageIds_".concat(n.messageId,", ").concat(g.messageId,"; ContentOrigin: ").concat(null==n?void 0:n.contentOrigin)}]),r=void 0!==(null==n?void 0:n.error)||(null==n?void 0:n.resultType)===A.gL.ApologyResponseReturned),(0,x.UJf)()&&(m=(0,s._)({},g.info),Ee.push(m),d()),v=!e.getInstance().getWordAppCopilotStreamingState(),E=!1,b=(0,le.Y1)(),n&&n.messageId===g.messageId||(0,x.fX6)()&&t.chatResponse.queryId===g.primaryQueryId?((0,R.cY)("Message id was set. Updating final message rendered"),T=(0,ie.yu)(),g.updateLastRenderedMessage(n,o,!1,T,v,l,c,d,f),b&&D.h.logSurveyTriggerEvent(S.w2.WordCopilotSummarize,!0)):E=!0,P=(0,le.EJ)(n),M=E&&g.checkIfSingleShotResponseMessage(n),(0,R.cY)("Is SingleShotResponseMessage: ".concat(M," and checkContentOrigin: ").concat(E)),M&&(null==n?void 0:n.text))L={featureName:P.featureName,subFeatureName:P.subFeature},(0,U.wT)(null==n?void 0:n.text,n.messageId,L,void 0,v,!1,void 0,void 0,f),w=(0,ie.yu)(),g.updateLastRenderedMessage(n,o,!1,w,v,l,c,d,f),k.B.getInstance().sendLatencyTelemetry((0,V.pN)((B={},(0,i._)(B,C.CT.FeatureName,P.featureName),(0,i._)(B,C.CT.UserPerceivedLatency,(0,h.WUi)(a)),B))),b&&D.h.logSurveyTriggerEvent(S.w2.WordCopilotSummarize,!0);else if((0,x.Ggk)()&&(W=y.$.getInstance().getLastMessage(!1),null==t?void 0:t.error)){if((N=I.p.getErrorHandlingStrategy(t))&&W&&W.body.user===p.Q9.Human)return k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.UserQueryGuid,null==t?void 0:t.queryId))),K=N.getErrorMessage(t),(0,U.FN)(K.message,!0,K.helpLink,void 0,P.featureName,!0,v),v&&O.P.getInstance().removeContextId(null==t?void 0:t.queryId),g.resetWordAppCopilotStreamingState(),b&&D.h.logSurveyTriggerEvent(S.w2.WordCopilotSummarize,!1),[2];try{j=(null==t||null===(H=t.error)||void 0===H?void 0:H.json)?JSON.parse(null==t||null===(G=t.error)||void 0===G?void 0:G.json):void 0,F=(null!==(Y=null==t||null===(Q=t.error)||void 0===Q?void 0:Q.category)&&void 0!==Y?Y:"")+"_"+(j?j.code:"")}catch(e){(0,R.cY)("failed to parse error object on the Final Message"),k.B.getInstance().sendErrorTelemetry((0,V.pN)((z={},(0,i._)(z,C.IC.ErrorMessage,"failed to parse error object on the Final Message"),(0,i._)(z,C.IC.ErrorCategory,_.S2.Error),z)))}k.B.getInstance().sendChatEventTelemetry([{key:C.h3.ChatEventType,value:C.a5.UnexpectedErrorObjectReceived},{key:C.h3.ChatEventParameters,value:F}])}return(0,U.ow)(!1,!1,v,!0,r),v&&O.P.getInstance().removeContextId(null==t?void 0:t.queryId),g.resetWordAppCopilotStreamingState(),[2]}))}))()}},{key:"processConversationSensitivityLabel",value:function(e){var t=this;return(0,r._)((function(){var n,r,o,a,s,c;return(0,u.__generator)(this,(function(l){switch(l.label){case 0:if(!(n=(0,se.pX)()&&(0,x.EG7)()?e.chatResponse.conversationSensitivityLabel:void 0))return[3,5];if((0,R.cY)("Enterprise search"),(0,x.Wdf)()?(0,h.YwR)():(0,se.Yw)(),!(r={labelId:n.id,tenantId:"",encryptionType:n.isEncrypted?h.TzT.IRMTemplate:h.TzT.None,displayName:n.displayName,description:n.tooltip,color:n.color,order:n.priority}).labelId&&!E.n.getInstance().getInDocSensitiveLabelInfo().labelId)return[3,5];l.label=1;case 1:return l.trys.push([1,4,,5]),[4,E.n.getInstance().getHighestDocumentSensitivityInfo([E.n.getInstance().getInDocSensitiveLabelInfo(),r])];case 2:return o=l.sent(),[4,E.n.getInstance().getInDocSensitiveLabelUsingOfcJs()];case 3:return a=l.sent(),o.isDke=a.isDke,o.hasExtractForUser=a.hasExtractForUser,(0,R.cY)("Highest label: "+JSON.stringify(o)),E.n.getInstance().setInDocSensitivityLabelInfo(o),t.shouldUpdateDocSensitivityAtStreamEnd&&((0,R.cY)("Handling end of stream. Odsl executed successfully and and odsl program is insertion scenario, updating document sensitivity"),E.n.getInstance().upgradeSensitivityLabelUsingOfcJs(E.n.getInstance().getInDocSensitiveLabelInfo())),[3,5];case 4:return s=l.sent(),(0,R.cY)("Enterprise search: Office JS sensitivity api failed: "+s.message),k.B.getInstance().sendErrorTelemetry((0,V.pN)((c={},(0,i._)(c,C.IC.ErrorMessage,"Exception while calling Office JS sensitivity api in Flux Copilot Workflow: "+s.message),(0,i._)(c,C.IC.ErrorCategory,_.S2.OfficeJsOperations),c))),[3,5];case 5:return[2]}}))}))()}},{key:"updateLastRenderedMessage",value:function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0,_=arguments.length>8?arguments[8]:void 0,m=arguments.length>9?arguments[9]:void 0,E=r?r.displayName:void 0;(0,R.cY)("Sensitivity label display name: "+E);var b=e.suggestedResponses;if(this.shouldUpdateSuggestionPool&&b&&b.length>0){var T=this.getSuggestionStrings(b),I=[];(0,x.NMh)()&&((0,se.gc)()&&I.push(d.I4U),(0,se.pX)()&&I.push(d.tE5));var P=(0,l._)(I).concat((0,l._)(T));(0,R.cY)("updating suggestion pills from Word App Shared Copilot. suggestions: "+P),t(P)}var A=!this.confirmationCardProps,D=[],S=(0,x.UxI)()&&h.xPp.getCurrentAddinState()===h.aB5.HasAction;if(S&&(h.xPp.transitionAddinState(h.aB5.ShowButton),k.B.getInstance().sendChatEventTelemetry((0,V.pN)((0,i._)({},C.h3.ChatEventType,h.rsb.UndoButtonShownAfterAddinSuccess)))),this.shouldShowUndoButton||S){D.push((0,B.FW)((function(){S&&k.B.getInstance().sendChatEventTelemetry((0,V.pN)((0,i._)({},C.h3.ChatEventType,h.rsb.UndoButtonClickedAfterAddinSuccess))),y.$.getInstance().displayResponse({chatCardType:g._.Default,chatMessageData:{defaultMessageProps:{user:p.Q9.Chat,messageHeader:{text:(0,d.W1n)()}}},chatMessageBodyData:{messageAttributionProps:(0,U.qN)()}}),(0,_e.jk)()})))}else if((0,x.DDO)()&&!(0,ce.w9)()){de.Vv.IsSettingTrue(de.zj.IsInteractiveReadOnlyMode)||D.push((0,B.ah)())}if((0,x.UJf)()){var M=(0,s._)({},this.info);Ee.push(M),u(),o&&this.addDebugToActionButtons(D,M,a,c)}if((e.citations||[]).length>0)(0,R.cY)("Getting in-doc citations here.."),be=v.F.getInstance().getCitationReferences(e.citations,E);else if((e.sourceAttributions||[]).length>0){var O;(0,R.cY)("Getting external citations here.."),be=v.F.getInstance().getChatReferencefromSourceAttributions(e.sourceAttributions),Te=v.F.getInstance().getChatReferencefromSourceAttributions(e.sourceAttributions,!0),Ie=(0,x.nId)()&&e.sourceAttributions&&null!==(O=(0,ue.yt)(e).entityAnnotations)&&void 0!==O?O:[]}var L,w="";(e.gptIdentifiers||[]).length>0&&((w=e.gptIdentifiers[0].id)&&((0,R.cY)("Rendering branding header for response received with GPT ID: ".concat(w)),k.B.getInstance().sendChatEventTelemetry((0,V.pN)((L={},(0,i._)(L,C.h3.ChatEventType,C.a5.GptIdForBranding),(0,i._)(L,C.h3.ChatEventParameters,w),L)))));var W=(0,h.tO0)(e.sourceAttributions,!0),F=(0,x.l6e)()?(0,h.kqr)(e.sourceAttributions,!0):void 0,N=this.confirmationCardProps,K=this.codePreviewProps,H=(0,le.EJ)(e),G={featureName:H.featureName,subFeatureName:H.subFeature};y.$.getInstance().updateLastMessage({chatCardType:g._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e.text,allowImages:null==m?void 0:m.allowImages,enableLinkDataDownload:null==m?void 0:m.enableLinkDataDownload,disableLinksProcessing:null==m?void 0:m.disableLinksProcessing}},chatMessageBodyData:(0,U._u)({showAIGenerated:!0,showAnimation:!0,footerPosition:f.O.Footer,actionButtonList:D,isFailure:!1,references:be&&be.length>0?be:void 0,annotationReferences:Te&&Te.length>0?Te:void 0,entityAnnotations:Ie&&Ie.length>0?Ie:void 0,clpLabel:r?(0,ie.Q9)(r):void 0,msgExtCardProps:W,apiPluginCardProps:F,confirmationCardProps:N,pluginAuthError:this.pluginAuthError,contextData:G,telemetryData:(0,U.J6)(H.featureName,H.subFeature),chatMessageHeader:_,gptId:w,shouldShowCopyButton:A,shouldShowHandoffButton:A,shouldShowReadAloudButton:A,debugInfo:e.debugInfo,codePreviewProps:K}),stopLoadingUi:o,addCardToChatHistory:((0,x.ga$)()||void 0===W)&&!(0,h.WSP)(e,w===d.alM)})}},{key:"handleOdslResponse",value:function(e,t,n){var o=this;return(0,r._)((function(){var r,a,s;return(0,u.__generator)(this,(function(c){switch(c.label){case 0:return o.odslSkillInvoked=!0,a={},(0,i._)(a,C.h3.ChatEventType,C.a5.ODSLResponseReceivedFromSydney),(0,i._)(a,C.h3.ChatEventParameters,L.H.getTypeName()),s=a,(null==e?void 0:e.queryId)&&(s[C.h3.UserQueryGuid]=null==e?void 0:e.queryId),k.B.getInstance().sendChatEventTelemetry((0,V.pN)(s)),k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.FeatureName,C.CC.Commanding))),(0,x.EG7)()&&(o.odslInsertionScenario=e.odslResponse.odslAction===b.b.Insertion),[4,t(e.odslResponse,n,null===(r=e.odslResponse.odsl)||void 0===r?void 0:r.responseRequired,(function(e,t,n,r,a){o.handleOdslProgramExecution(e,t,n,r,a)}))];case 1:return c.sent(),o.shouldUpdateSuggestionPool=(0,x.t3e)(),[2]}}))}))()}},{key:"handleOdslProgramExecution",value:function(e,t,n,r,o){if(e===d.rIt.SUCCESS||e===d.rIt.PARTIAL_SUCCESS){if(this.shouldShowUndoButton=!0,(0,x.EG7)()&&this.odslInsertionScenario){(0,R.cY)("Handling odsl program execution result. Detected Insertion scenario, updating document sensitivity");var a=E.n.getInstance().getInDocSensitiveLabelInfo();a.labelId&&E.n.getInstance().upgradeSensitivityLabelUsingOfcJs(a),this.shouldUpdateDocSensitivityAtStreamEnd=(0,x.SEe)()}}else if(o){var s,c,l;k.B.getInstance().sendChatEventTelemetry((0,V.pN)((s={},(0,i._)(s,C.h3.ChatEventType,o.chatEventType),(0,i._)(s,C.h3.ChatEventParameters,o.chatEventParam),(0,i._)(s,C.h3.ChatErrorType,o.chatErrorType),s))),k.B.getInstance().sendLatencyTelemetry((0,V.pN)((l={},(0,i._)(l,C.CT.ErrorType,o.chatErrorType),(0,i._)(l,C.CT.ErrorParameter,o.chatEventType),(0,i._)(l,C.CT.ErrorChatEventType,o.chatEventType),(0,i._)(l,C.CT.ErrorChatEventParameter,null!==(c=o.chatEventParam)&&void 0!==c?c:""),l))),o.ashaErrorDetails&&(0,V.W7)(o.ashaErrorDetails)}if((0,ce.cU)((0,se.w5)())&&t){var u=(0,R.iM)();if(O.P.getInstance().isValidAnnotationResponse(u)){var _=new P.g0({parentPath:[d.HN0,T.GJ.getTypeName()],items:[{id:M.r.generateId(),body:new w.KX({status:n,error:r,queryId:u})}]});y.$.getInstance().submitOperation({operation:_,workflowAnnotationType:L.H.getTypeName()})}else{var p={chatEventType:C.a5.ODSLExecutionTimeout,chatEventParam:L.H.getTypeName(),chatErrorType:d.T__.Server};k.B.getInstance().sendChatEventTelemetry((0,V.pN)(p)),(0,V.W7)({vetoName:(0,V.CI)(C.eJ.Command,C.G8.TimedOut),errorString:C.av.ODSLExecutionTimeout,featureName:C.CC.Commanding})}}}},{key:"handleChatResponseForSharedCopilot",value:function(e,t,n,r,o){var a=e.chatResponse.basinCursor,s=e.chatResponse.basinWrite,c=e.chatResponse.messagesToAddOrReplace,l=e.chatResponse.messagesToDelete,u=e.chatResponse.messagesToUpdate,d=e.chatResponse.queryId;if(!(0,le.hX)(l)){var p=!0,f=!1,m=void 0;try{for(var E,b=l[Symbol.iterator]();!(p=(E=b.next()).done);p=!0){var T=E.value;(0,R.cY)("Deleting message id: ",T),y.$.getInstance().deleteMessage({chatCardType:g._.MarkdownCard,messageIdToDelete:T}),delete this.basin.items[T]}}catch(e){f=!0,m=e}finally{try{p||null==b.return||b.return()}finally{if(f)throw m}}}if(!(0,le.hX)(a)){var I=JSON.parse(a);(0,R.cY)("Setting basin cursor: ",I),this.basin.setCursor(I)}if((0,R.cY)("Initial/previous annotation message id is "+this.messageId),!(0,le.hX)(c)&&c.length>0){var P=!0,A=!1,D=void 0;try{for(var S,M=c[Symbol.iterator]();!(P=(S=M.next()).done);P=!0){var O,L=S.value;if((0,x.CIC)()&&(this.isDisengagedResponse(L)||this.isDisengagedError))return void(this.isDisengagedError=!0);if("Progress"===L.messageType)(0,R.cY)("Progress message received: ",L);else if(this.isValidMessageForRendering(L)){var w=(0,x.fX6)()&&d===this.primaryQueryId&&""!==d;if((0,R.cY)("MessageId for this annotation is : "+L.messageId),(0,R.cY)("Current query ID is : "+d),L.messageId!==this.messageId)if(w){this.messageId=L.messageId,this.groupedMessageIds.add(L.messageId),(0,U.D9)(L.offense);var B=this.getMergedAdaptiveCardText(L,!1);this.paragraphChunks=B,this.updateResponseMarkdownMessageCard(B,!0)}else{if(this.messageId=L.messageId,this.groupedMessageIds.clear(),this.primaryQueryId=d,this.groupedMessageIds.add(L.messageId),this.isFirstStreamChunk){this.info.FCFR=1e3*(0,h.WUi)(t),(0,V.Ow)(t);var H,G=C.CC.ChatQnA,Q=C.nk.AddDesignerImage;if(k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.FirstValidMessageReceivedTime,(0,h.WUi)(t)))),this.isFirstValidMessageReceived=!0,L.contentOrigin==Z.w.WORD_SUMMARIZE){var j=(0,le.RH)(C.CC.Summary);G=j.featureName,W.s.getInstance().setSkillName(F.B.Summary),k.B.getInstance().logTriedEvent(j.capability,j.featureName,j.verb,j.subFeature)}else L.contentOrigin==Z.w.DESIGNER_INSERT_GRAPHIC?(W.s.getInstance().setSkillName(F.B.Designer),G=C.CC.DesignerVisuals):this.isPersonalizationResponse(L.contentOrigin)&&(G=C.CC.Customize);if((0,R.cY)("Feature name to log with first annotation from markdown is : ",G),L.contentOrigin==Z.w.DESIGNER_INSERT_GRAPHIC)k.B.getInstance().sendLatencyTelemetry((0,V.pN)((H={},(0,i._)(H,C.CT.FeatureName,G),(0,i._)(H,C.CT.SubFeatureName,Q),H)));else k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.FeatureName,G)));this.isFirstStreamChunk=!1}if((0,U.D9)(L.offense),(0,R.cY)("Adding Response Card for messagesToAddOrReplace:",L),(0,N.Ep)(L))(0,N.fw)(L);else if(J(L))X(L,y.$.getInstance());else if((0,K.xE)(L))(0,K.PX)(L,y.$.getInstance(),n,r,o);else{var Y=this.getFullAdaptiveCardText(L);(0,R.cY)("Full text from Adaptive Card: ",Y),this.addResponseMarkdownMessageCard(Y||L.text,L.messageId)}k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.UserPerceivedLatency,(0,h.WUi)(t))))}else if(!J(L)&&!(0,N.Ep)(L)&&!(0,K.xE)(L)){(0,R.cY)("Adding Response Card for messagesToAddOrReplace:",L);var z=(0,x.fX6)()?this.getMergedAdaptiveCardText(L,!0):this.getFullAdaptiveCardText(L);(0,R.cY)("Full text from Adaptive Card: ",z);var q=L.sourceAttributions;be=q?v.F.getInstance().getChatReferencefromSourceAttributions(q):[];var $,ee=(0,h.tO0)(L.sourceAttributions),te=(0,x.l6e)()?(0,h.kqr)(L.sourceAttributions):void 0;Te=q?v.F.getInstance().getChatReferencefromSourceAttributions(q,!0):[],Ie=(0,x.nId)()&&q&&null!==($=(0,ue.yt)(L).entityAnnotations)&&void 0!==$?$:[],this.updateResponseMarkdownMessageCard(z||L.text,!0,be,Te,Ie,1===(null==ee?void 0:ee.attributions.length)?void 0:ee,1===(null==te?void 0:te.attributions.length)?void 0:te)}this.basin.items[L.messageId]=L}else if(this.isInternalLoadingMessage(L))y.$.getInstance().updateLoaderStrings([L.text]);else if((0,h.vfc)(L))this.confirmationCardProps=(0,h.cqx)(L);else if((null===(O=L.authErrors)||void 0===O?void 0:O.length)>0&&L.authErrors[0]){var ne;if(this.pluginAuthError=L.authErrors[0],(0,R.cY)("Plugin Auth Error received"),(0,x.z5w)())k.B.getInstance().sendErrorTelemetry((0,V.pN)((ne={},(0,i._)(ne,C.IC.ErrorCategory,_.S2.Error),(0,i._)(ne,C.IC.ErrorMessage,"Plugin Auth Error Received"),ne)))}}}catch(e){A=!0,D=e}finally{try{P||null==M.return||M.return()}finally{if(A)throw D}}}else{if(!(0,le.hX)(u)&&u.length>0){var re=!0,oe=!1,ae=void 0;try{for(var ie,se=u[Symbol.iterator]();!(re=(ie=se.next()).done);re=!0){var ce=ie.value;if((0,x.CIC)()&&(this.isDisengagedResponse(ce)||this.isDisengagedError))return void(this.isDisengagedError=!0);if((0,R.cY)("MessageId for this annotation is : "+ce.messageId),ce.messageId===this.messageId){(0,R.cY)("Updating Response Card to messagesToUpdate:",ce);var de,_e=ce.sourceAttributions;be=_e?v.F.getInstance().getChatReferencefromSourceAttributions(_e):[],Te=_e?v.F.getInstance().getChatReferencefromSourceAttributions(_e,!0):[],Ie=(0,x.nId)()&&_e&&null!==(de=(0,ue.yt)(ce).entityAnnotations)&&void 0!==de?de:[];var pe=(0,h.tO0)(ce.sourceAttributions),ge=(0,x.l6e)()?(0,h.kqr)(ce.sourceAttributions):void 0;this.updateResponseMarkdownMessageCard(ce.appendText,void 0,be,Te,Ie,1===(null==pe?void 0:pe.attributions.length)?void 0:pe,1===(null==ge?void 0:ge.attributions.length)?void 0:ge)}}}catch(e){oe=!0,ae=e}finally{try{re||null==se.return||se.return()}finally{if(oe)throw ae}}}if(!(0,le.hX)(s)&&!this.isDisengagedError){var fe=JSON.parse(s);(0,R.cY)("Basin write received: ",fe),this.basin.write(fe);var he=(0,x.fX6)()?this.getMergedAdaptiveCardText(null,!1):this.getFullAdaptiveCardText(this.basin.items[this.messageId]);(0,R.cY)("Full text from Adaptive Card: ",he),this.updateResponseMarkdownMessageCard(he||fe,!0)}}}},{key:"getFullAdaptiveCardText",value:function(e){var t=(null==e?void 0:e.adaptiveCards)?e.adaptiveCards[0]:null,n="";if(t){var r=t.body,o=!0,a=!1,i=void 0;try{for(var s,c=r[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value;"TextBlock"===l.type&&(n+=l.text)}}catch(e){a=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw i}}}return n}},{key:"getMergedAdaptiveCardText",value:function(e,t){var n="",r=!0,o=!1,a=void 0;try{for(var i,s=this.groupedMessageIds[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var c=i.value,l=this.basin.items[c];if(l){var u=this.getFullAdaptiveCardText(l);t&&c===e.messageId&&(u=this.getFullAdaptiveCardText(e)),u&&(n&&(n+="\n\n"),n+=u)}}}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}if(e&&!t){var d=this.getFullAdaptiveCardText(e);d&&(n&&(n+="\n\n"),n+=d)}return n}},{key:"handleWordCopilotAppResponseForSharedCopilot",value:function(e,t,n,o,a,s,c,l,d,_,p,g,f,m,v){var E=this;return(0,r._)((function(){var r,y,b,T,I,P;return(0,u.__generator)(this,(function(u){return L.H.typeGuard(e.body)?((0,R.cY)("Word Copilot Annotation response received for Shared Copilot"),r=e.body.queryId,E.isFirstResponse&&(k.B.getInstance().sendLatencyTelemetry((0,V.pN)((y={},(0,i._)(y,C.CT.FirstServiceResponse,(0,h.WUi)(n)),(0,i._)(y,C.CT.AnnotationType,L.H.getTypeName()),(0,i._)(y,C.CT.IsFluxUsed,!(0,le.hX)(e.body.sydneyEndpoint)),y))),E.conversationId=e.body.conversationId,E.sydneyEndpoint=e.body.sydneyEndpoint,E.isFirstResponse=!1),(0,V.G4)(L.H.getTypeName(),r,void 0,n,!1,!1,!1,f),E.info.timestamp=e.body.timestamp,O.P.getInstance().isValidAnnotationResponse(r)?E.handleWordCopilotAppResponseInternal(e.body,t,n,o,a,s,r,c,l,d,!1,e.source,_,p,g,f,m,v):(k.B.getInstance().sendChatEventTelemetry((0,V.pN)((P={},(0,i._)(P,C.h3.ChatEventType,C.a5.InvalidContextIdResponse),(0,i._)(P,C.h3.ChatEventParameters,null!==(I=null===(T=e.body)||void 0===T||null===(b=T.H_)||void 0===b?void 0:b.T_)&&void 0!==I?I:""),(0,i._)(P,C.h3.UserQueryGuid,null!=r?r:""),P))),e.body.chatResponse&&0===e.body.chatResponse.status&&(Pe=e.body.chatResponse.sessionKey,(0,R.cY)("Word App Copilot streaming ended after Augloop response timeout."),E.logDiagnostics(e.body))),[2]):[2]}))}))()}},{key:"handleWordCopilotAppResponseInternal",value:function(t,n,o,a,c,_,p,f,m,v){var E=arguments.length>10&&void 0!==arguments[10]&&arguments[10],b=arguments.length>11&&void 0!==arguments[11]?arguments[11]:ve,T=arguments.length>12?arguments[12]:void 0,P=arguments.length>13?arguments[13]:void 0,M=arguments.length>14?arguments[14]:void 0,w=arguments.length>15?arguments[15]:void 0,B=arguments.length>16?arguments[16]:void 0,K=arguments.length>17?arguments[17]:void 0,H=this;return(0,r._)((function(){var r,G,Q,j,Y,z,q,J,X,$,ee,te,ne,re,oe,ae,ie,se,ce,ue,de,_e,pe,ge,he,Ce,me,Pe,Ae,De,Se,Me,Oe,ke,Le,we,Re,Ue,Be,xe,We,Fe,Ne,Ke,He,Ge;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:return(0,R.cY)("Word Copilot Annotation response internal received..."),H.handleInsightsCardSummaryResponse(t,B,K)?[2]:(G=null!==(r=t.requiredActionParameters)&&void 0!==r?r:[],(0,x.lH6)()&&(0,x.SBW)()&&(0,h.vqz)(G,y.$.getInstance().getCopilotRef()),t.chatResponse?(Q=!!H.summarySkillExists(t),(0,R.cY)("Is Skill response :"+Q),(0,x.UJf)()&&H.storeDebugInfoForResponse(t,o),0!==t.chatResponse.status?[3,3]:((0,x.mmq)()&&(q=null===(Y=t.chatResponse.messages)||void 0===Y?void 0:Y.find((function(e){return(0,h.JI8)(e,(0,fe.CP)(h.mRo.EnableNewRegexForVCPromptExtraction))})),J=null===(z=t.chatResponse.messages)||void 0===z?void 0:z.find((function(e){return(0,h.WSP)(e,!0)})),(0,le.hX)(q)||(ee="",(0,le.hX)(J)||(y.$.getInstance().deleteMessage({chatCardType:g._.MarkdownCard,messageIdToDelete:J.messageId}),ee=J.text),(0,N.dG)(q,ee,null==J||null===($=J.gptIdentifiers)||void 0===$||null===(X=$[0])||void 0===X?void 0:X.id))),te=void 0,ne=null===(j=t.chatResponse.messages)||void 0===j?void 0:j.find((function(e){return(0,h.j92)(e,(0,fe.CP)(h.mRo.EnableNewRegexForVCPromptExtraction))})),(0,le.hX)(ne)||((0,x.oly)()?(ie=null===(re=t.chatResponse.messages)||void 0===re?void 0:re.find((function(e){return(0,h.WSP)(e,!0)})),se="",(0,le.hX)(ie)||(y.$.getInstance().deleteMessage({chatCardType:g._.MarkdownCard,messageIdToDelete:ie.messageId}),se=ie.text),(0,N.hB)(ne,se,null==ie||null===(ae=ie.gptIdentifiers)||void 0===ae||null===(oe=ae[0])||void 0===oe?void 0:oe.id)):(0,x.uRc)()&&(te=(0,d.pHk)())),(0,h.DF)(t,(0,x.LSW)(),(0,x.DtK)())&&(0,le.jx)()&&(de=null===(ce=t.chatResponse.messages)||void 0===ce?void 0:ce.find((function(e){return(0,h._Ho)(e)})),_e=(null==de||null===(ue=de.text)||void 0===ue?void 0:ue.length)>0,(0,le.hX)(de)||(H.codePreviewProps=(0,h.QHk)(de,_e))),[4,(0,h.BIF)(t.chatResponse,y.$.getInstance().getCopilotRef(),{enableAddinLocalPluginActions:(0,x.UxI)(),passAllMessages:(0,x.Q9p)()})])):[3,4]);case 1:return u.sent()?(pe=(0,h.xRn)(t.chatResponse),ge=JSON.stringify({interstitialMessageType:pe}),(0,R.cY)("Extensibility handled interstitial message: ".concat(ge)),k.B.getInstance().sendChatEventTelemetry([{key:C.h3.ChatEventType,value:C.a5.InterstitialMessageShown},{key:C.h3.ChatEventParameters,value:ge}]),H.cleanupStreamHandler(),[2]):(Q||((null==t?void 0:t.conversationId)&&c(null==t?void 0:t.conversationId),Ce=null==t||null===(he=t.chatResponse)||void 0===he?void 0:he.telemetry,p&&Ce&&Ce.metrics&&((me=ye).push.apply(me,(0,l._)(t.chatResponse.messages)),_(p,Ce,null==t?void 0:t.conversationId,ye))),[4,H.handleStreamEndForSharedCopilot(t,a,o,Q,E,P,T,M,te)]);case 2:if(u.sent(),H.codePreviewProps=void 0,be=[],Te=[],Ie=[],(0,x.NMh)()){if(De=null===(Pe=t.chatResponse.messages)||void 0===Pe?void 0:Pe.at(0),Se=null===(Ae=t.chatResponse.messages)||void 0===Ae?void 0:Ae.at(-1),!De||!Se)return[2];Me=H.isWebOrEnterpriseQuery(De.text),Oe=Q||H.imageSkillExists(t),ke=Se.contentOrigin==Z.w.APOLOGY||Se.messageType==A.n3.Disengaged,Le=0==Se.sourceAttributions.length,H.isWebOrEnterpriseEnabled()&&t.isFinalResponse&&H.isValidMessageForRendering(Se)&&!Me&&!Oe&&!ke&&Le&&y.$.getInstance().submitUserQuery(d.klO)}return[2];case 3:return we={augloopResponseTime:(0,h.WUi)(o),status:t.chatResponse.status},H.streamChunks=(0,l._)(H.streamChunks).concat([we]),H.handleChatResponseForSharedCopilot(t,o,f,m,v),[3,7];case 4:return t.odslResponse?((0,V.G4)(L.H.getTypeName(),p,void 0,o,!1,!0,!1,w),Re={augloopResponseTime:(0,h.WUi)(o)},H.streamChunks=(0,l._)(H.streamChunks).concat([Re]),[4,H.handleOdslResponse(t,n,a)]):[3,6];case 5:return u.sent(),[3,7];case 6:t.error?((0,R.cY)("Error in flux response Copilot chat"),Ue={},(0,x.UJf)()&&(H.storeDebugInfoForResponse(t,o,void 0,!0),Ue=(0,s._)({},H.info),Ee.push(Ue),M()),H.cleanupStreamHandler(),Be=I.p.getErrorHandlingStrategy(t),xe=!e.getInstance().getWordAppCopilotStreamingState(),We=!1,b!==ve&&((0,R.cY)("Error Response source here is : "+b),We=!0),We?"GptSummaryStreamingWorkflow-Reduce-Copilot"==b&&(W.s.getInstance().setSkillName(F.B.Summary),k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.SummaryResponseTime,(0,h.WUi)(o))))):k.B.getInstance().sendLatencyTelemetry((0,V.pN)((0,i._)({},C.CT.SydneyResponseTime,(0,h.WUi)(o)))),Fe=!We||We&&xe,Be&&(Ne=Be.getErrorMessage(t),Ke={errorMessage:Ne.message,errorType:Ne.errorType,featureName:C.CC.CopilotChat},(0,U.KY)(Ne.message,!0,Ne.helpLink,void 0,void 0,!0,Fe,Ke,Ne.linkMessageText,Ue,T,P,Ne.linkSuffix)),Fe&&(O.P.getInstance().removeContextId(null==t?void 0:t.queryId),W.s.getInstance().resetData(),(0,x.UxI)()&&h.xPp.setIsAddinFlow(!1,(function(){(0,h.An1)(y.$.getInstance().getCopilotRef(),!1)}))),(0,le.Y1)()?D.h.logSurveyTriggerEvent(S.w2.WordCopilotSummarize,!1):D.h.logSurveyTriggerEvent(null,!1)):(H.cleanupStreamHandler(),(0,R.cY)("ChatResponse, odslResponse, and error not present in Word Copilot annotation received"),He={chatEventType:C.a5.ErrorNotFound,chatEventParam:L.H.getTypeName(),chatErrorType:d.T__.Client,ashaErrorDetails:{vetoName:(0,V.CI)(C.eJ.UnclearIntent,C.G8.UnclassifiedError),errorString:C.av.ErrorNotFound,featureName:C.CC.CopilotChat}},Ge={errorMessage:(0,d.BFD)(),errorType:"ResponseNotFound",featureName:C.CC.CopilotChat},(0,U.KY)((0,d.BFD)(),!0,void 0,He,void 0,void 0,void 0,Ge),D.h.logSurveyTriggerEvent(null,!1)),u.label=7;case 7:return[2]}}))}))()}},{key:"handleInsightsCardSummaryResponse",value:function(e,t,n){if(!t||!n)return!1;var r=e,o=r.queryId;try{if(t(o)){var a,s=k.B.getInstance();(0,R.cY)("Query ID for InsightsCard Summary",o),s.sendChatEventTelemetry((0,V.pN)((a={},(0,i._)(a,C.h3.ChatEventType,C.a5.InsightsCardSummaryHandled),(0,i._)(a,C.h3.UserQueryGuid,o),(0,i._)(a,C.h3.ChatEventParameters,(new Date).getTime()),a)));var c=null==r?void 0:r.chatResponse;if(c){var l=c.status,u=l===p.lC.Success||l===p.lC.PartialResult;if(u||((0,R.cY)("InsightsCard Summary Response Not Successful ".concat(p.lC[l])),this.handleInsightsCardErrorTelemetry(o,"".concat(C.a5.InsightsCardSummaryError,"_").concat(C.Qw.UnsuccessfulCompletionStatus),d.T__.Client,C.Qw.UnsuccessfulCompletionStatus,"Interactive Summary Workflow Completion Status not successful: ".concat(l))),u){var _,g,f,h=l===p.lC.PartialResult?(null==c||null===(_=c.messagesToUpdate)||void 0===_?void 0:_[0])||(null==c||null===(g=c.messagesToAddOrReplace)||void 0===g?void 0:g[0]):l===p.lC.Success?null===(f=c.messages)||void 0===f?void 0:f[0]:void 0;if(!h)return(0,R.cY)("Received a summary annotation without a chatResponse for InsightsCard"),this.handleInsightsCardErrorTelemetry(o,"".concat(C.a5.InsightsCardSummaryError,"_").concat(C.Qw.InvalidFinalMessage),d.T__.Server,C.Qw.InvalidFinalMessage,"Received a summary annotation without a chatResponse for InsightsCard"),!0;var m,E="appendText"in h?h.appendText:h.text,y=c.status===p.lC.PartialResult?pe.x.UPDATING:pe.x.LOADED,b=[];if(y===pe.x.LOADED){this.logResponseFromCache(c,o);try{var T=h.sourceAttributions;b=T?v.F.getInstance().getChatReferencefromSourceAttributions(T):[]}catch(e){var I;s.sendChatEventTelemetry((0,V.pN)((I={},(0,i._)(I,C.h3.ChatEventType,C.a5.InsightsCardSummaryCitationsNotHandled),(0,i._)(I,C.h3.UserQueryGuid,o),(0,i._)(I,C.h3.ChatEventParameters,null==e?void 0:e.message),I)))}O.P.getInstance().removeFromSkipContextCheckList(o),he.p4.getCurrentInstance().removeQueryIdToSkipTimerReset(o)}n(o,{sections:[],markdownSummary:E,references:b},y),s.sendChatEventTelemetry((0,V.pN)((m={},(0,i._)(m,C.h3.ChatEventType,C.a5.InsightsCardSummaryMarkdownHandled),(0,i._)(m,C.h3.UserQueryGuid,o),(0,i._)(m,C.h3.ChatEventParameters,null==E?void 0:E.length),m)))}}else if(null==r?void 0:r.error){var P=null==r?void 0:r.error;this.handleInsightsCardErrorContent(P,o,!1,n),(0,R.cY)("AL response failure for Interactive Card Summary: ",P)}return!0}}catch(e){this.handleInsightsCardErrorContent(e,o,!0,n),(0,R.cY)("Response parsing failure for InsightsCard Summary: ",e)}return!1}},{key:"addResponseMarkdownMessageCard",value:function(e,t,n){var r;if((0,le.hX)(e))return(0,R.cY)("Returning as message is undefined"),void k.B.getInstance().sendChatEventTelemetry((0,V.pN)((r={},(0,i._)(r,C.h3.ChatEventType,C.a5.EmptyMessageReceivedFromSydney),(0,i._)(r,C.h3.ChatEventParameters,"Empty Markdown message card"),r)));(0,R.cY)("Adding Response Card:",e),this.paragraphChunks=e;var o={featureName:C.CC.CopilotChat},a=this.codePreviewProps,l=(0,x.lH6)()&&(0,x.SBW)()?(0,h.$dc)():[],u={correlationId:k.B.getInstance().getQueryGuid(),featureName:(0,x.lH6)()&&(0,x.SBW)()||this.isPersonalizationSkillResponse?C.CC.Customize:C.CC.CopilotChat,subFeatureName:""};y.$.getInstance().displayResponse({chatCardType:g._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks}},chatMessageBodyData:(0,c._)((0,s._)({},(0,U._u)({showAIGenerated:!0,showAnimation:!0,footerPosition:f.O.None,actionButtonList:l,contextData:o,telemetryData:u,codePreviewProps:a})),{messageId:t}),stopLoadingUi:!!n,startAugloopTimerForStreaming:!0,addCardToChatHistory:!1})}},{key:"updateResponseMarkdownMessageCard",value:function(e,t,n,r,o,a,s){var c,l;if((0,le.hX)(e))return(0,R.cY)("Returning as message is undefined"),void k.B.getInstance().sendChatEventTelemetry((0,V.pN)((l={},(0,i._)(l,C.h3.ChatEventType,C.a5.EmptyMessageReceivedFromSydney),(0,i._)(l,C.h3.ChatEventParameters,"Empty Markdown message card"),l)));(0,R.cY)("Updating Response Card:",e);var u=e;u=u.replace("\\n","\n"),this.paragraphChunks=t?u:this.paragraphChunks+u;var d,_=y.$.getInstance().getLastMessage(),p=null!==(d=null==_||null===(c=_.actionBarButtons)||void 0===c?void 0:c.slice())&&void 0!==d?d:void 0,h=this.codePreviewProps;y.$.getInstance().updateLastMessage({chatCardType:g._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks}},chatMessageBodyData:(0,U._u)({showAIGenerated:!1,showAnimation:!1,footerPosition:f.O.None,references:n&&n.length>0?n:void 0,annotationReferences:r&&r.length>0?r:void 0,entityAnnotations:o&&o.length>0?o:void 0,actionButtonList:p,msgExtCardProps:a,apiPluginCardProps:s,codePreviewProps:h}),stopLoadingUi:!1,startAugloopTimerForStreaming:!0,addCardToChatHistory:!1})}}],[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}]),e}();(0,i._)(Ae,"_instance",void 0)},152233:(e,t,n)=>{"use strict";var r=n(475119),o=n(758651),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},i=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(e){var t=this;this.theme=void 0,this.platform=Office.context.platform,this.themeChangeObserver=void 0,this.registerThemeChangeEventCallback=function(){return a(t,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return(null===(e=Office.context)||void 0===e?void 0:e.themeManager)?[4,Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeEventCallback)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},this.themeChangeEventCallback=function(e){o.log("OfficeTheme Changed"),t.theme=t.buildOfficeTheme(e),t.themeChangeObserver.update(t.theme)},this.themeChangeObserver=e,this.platform===r.yx.win32?this.handleDefaultThemeChange():this.platform===r.yx.mac&&this.handleMacThemeChange()}e.getInstance=function(t){return e.instance||(this.instance=new e(t)),e.instance},e.prototype.handleDefaultThemeChange=function(){this.theme=this.buildOfficeTheme(),this.themeChangeObserver.update(this.theme),this.registerThemeChangeEventCallback().catch((function(e){}))},e.prototype.handleMacThemeChange=function(){var e,t,n=this;null===(t=null===(e=Office.context)||void 0===e?void 0:e.themeManager)||void 0===t||t.getOfficeThemeAsync((function(e){"succeeded"===e.status&&(n.theme=n.buildOfficeTheme(e.value),n.themeChangeObserver.update(n.theme),n.registerThemeChangeEventCallback().catch((function(e){})))}))},e.prototype.buildOfficeTheme=function(e){return e?{controlForegroundColor:e.officeTheme.controlForegroundColor,controlBackgroundColor:e.officeTheme.controlBackgroundColor,bodyForegroundColor:e.officeTheme.bodyForegroundColor,bodyBackgroundColor:e.officeTheme.bodyBackgroundColor}:{controlForegroundColor:Office.context.officeTheme.controlForegroundColor,controlBackgroundColor:Office.context.officeTheme.controlBackgroundColor,bodyForegroundColor:Office.context.officeTheme.bodyForegroundColor,bodyBackgroundColor:Office.context.officeTheme.bodyBackgroundColor}}}()},153668:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var r=n(426689),o=n(475119),a=function(){function e(){var e=this;this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.resetPersonalizationHITLActionState=function(){e.isPersonalizationHITLResponseCardActive=!1,e.personalizationHITLActionButtonList=[]},this.resetPersonalizationLatencyState=function(){e.personalizationHITLCardActivationTime=0,e.personalizationHITLCardUserInteractionTime=0},this.isPersonalizationHITLResponseCardActive=!1,this.personalizationHITLActionButtonList=[],this.personalizationHITLCardActivationTime=0}return e.getInstance=function(){return(0,o.hX)(e.personalizationHITLActionStateHandler)&&(e.personalizationHITLActionStateHandler=new e),e.personalizationHITLActionStateHandler},e.prototype.getIsPersonalizationHITLResponseCardActive=function(){return this.isPersonalizationHITLResponseCardActive},e.prototype.setIsPersonalizationHITLResponseCardActive=function(e){this.isPersonalizationHITLResponseCardActive=e},e.prototype.getPersonalizationHITLActionButtonList=function(){return this.personalizationHITLActionButtonList},e.prototype.setPersonalizationHITLActionButtonList=function(e){this.personalizationHITLActionButtonList=e},e.prototype.setPersonalizationHITLCardActivationTime=function(e){this.personalizationHITLCardActivationTime=e},e.prototype.getPersonalizationHITLUserInteractionTime=function(){return this.personalizationHITLCardUserInteractionTime},e.prototype.shouldConsiderPersonalizationHITLUserInteractionLatency=function(){return 0!==this.personalizationHITLCardActivationTime},e.prototype.setPersonalizationHITLUserInteractionTime=function(){this.personalizationHITLCardUserInteractionTime=(0,r.W)(this.personalizationHITLCardActivationTime)},e}()},155416:(e,t,n)=>{"use strict";n.d(t,{v:()=>d});var r=n(743032),o=n(379490),a=n(656904),i=n(932554),s=n(8810),c=n(965974),l="https://hubblecontent.df.osi.office.net/contentsvc/api/",u="https://hubblecontent.osi.office.net/contentsvc/api/";function d(e,t){return _.apply(this,arguments)}function _(){return(_=(0,r._)((function(e,t){var n,r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:if(!e)return[2];if(e.length<1)return c.M.getInstance().logError({eventType:s.S.Error,errorMessage:"HubbleApiHandler: Url is empty"}),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),n=function(e,t){var n={AppId:a.uYw,Url:e,Platform:t};try{return JSON.stringify(n)}catch(e){c.M.getInstance().logError({eventType:s.S.Error,errorMessage:"HubbleApiHandler: Stringify error: + ".concat(e)})}return""}([e],t),n.length<1?(c.M.getInstance().logError({eventType:s.S.Error,errorMessage:"HubbleApiHandler: Json body is empty"}),[2]):[4,p(n)];case 2:return o.sent(),[3,4];case 3:return r=o.sent(),c.M.getInstance().logError({eventType:s.S.Error,errorMessage:"HubbleApiHandler: sendUsageRequestToHubble threw ".concat(r)}),[3,4];case 4:return[2]}}))}))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=(0,r._)((function(e){var t,n,r,a;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:t=function(){if((0,i.I_)())return l;return u}(),n=t+"telemetry/getty",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(n,{method:"POST",body:e,headers:{"Content-Type":"application/json"}})];case 2:return(r=o.sent()).ok||c.M.getInstance().logError({eventType:s.S.Error,errorMessage:"HubbleApiHandler: Failed to send Getty usage data, status: ".concat(r.status,"}")}),[3,4];case 3:return a=o.sent(),c.M.getInstance().logError({eventType:s.S.Error,errorMessage:"HubbleApiHandler: Error while sending Getty usage data: ".concat(a)}),[3,4];case 4:return[2]}}))}))).apply(this,arguments)}},156845:(e,t,n)=>{"use strict";n.d(t,{$C:()=>I,BV:()=>S,Mh:()=>j,O3:()=>A,S8:()=>N,fC:()=>F,fb:()=>L,hC:()=>H,ko:()=>m,p9:()=>E,x4:()=>C,yB:()=>O,yJ:()=>b});var r=n(743032),o=n(857835),a=n(461838),i=n(379490),s=n(242154),c=n(769449),l=n(61714),u=n(656904),d=n(932554),_=n(334130),p=n(602061),g=n(457476),f=n(740389),h=n(722603),C=!1;function m(e){return v.apply(this,arguments)}function v(){return(v=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return(0,s.cY)("register OfficeFirstParty OnUndoStackChanged event"),[4,OfficeFirstParty.Undo.onUndoStackChanged((function(){e(),p.xPp.checkAndSetIsUndoableActionPresent(),(0,s.cY)("OfficeFirstParty onUndoStackChanged!")}))];case 1:return t.sent(),[2]}}))}))).apply(this,arguments)}function E(){return y.apply(this,arguments)}function y(){return(y=(0,r._)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return(0,s.cY)("calling OfficeFirstParty Undo"),[4,OfficeFirstParty.Undo.undo()];case 1:return e.sent(),[2]}}))}))).apply(this,arguments)}function b(){return T.apply(this,arguments)}function T(){return(T=(0,r._)((function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return(0,s.cY)("calling OfficeFirstParty startCopilotOperation"),e=(new Date).getTime(),[4,OfficeFirstParty.Undo.startCopilotOperation((0,l.A)())];case 1:return t.sent(),C=!0,(0,c.TU)(e),[2]}}))}))).apply(this,arguments)}function I(){return P.apply(this,arguments)}function P(){return(P=(0,r._)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return(0,s.cY)("calling OfficeFirstParty endCopilotOperation"),[4,OfficeFirstParty.Undo.endCopilotOperation((0,l.A)())];case 1:return e.sent(),C=!1,[2]}}))}))).apply(this,arguments)}function A(){return D.apply(this,arguments)}function D(){return(D=(0,r._)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return(0,s.cY)("calling OfficeFirstParty startAddinOperation"),[4,OfficeFirstParty.Undo.startCopilotOperation((0,l.A)())];case 1:return e.sent(),p.xPp.transitionAddinState(p.aB5.ScopeStarted),[2]}}))}))).apply(this,arguments)}function S(){return M.apply(this,arguments)}function M(){return(M=(0,r._)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return(0,s.cY)("calling OfficeFirstParty endAddinOperation"),[4,OfficeFirstParty.Undo.endCopilotOperation((0,l.A)())];case 1:return e.sent(),[2]}}))}))).apply(this,arguments)}function O(e){return k.apply(this,arguments)}function k(){return k=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return(0,s.cY)("registering word count upate callback"),[4,Word.run((n=(0,r._)((function(t){return(0,i.__generator)(this,(function(n){return t.document.onWordCountChanged.add((function(t){e(t.wordCount)})),[2]}))})),function(e){return n.apply(this,arguments)}))];case 1:return t.sent(),[2]}var n}))})),k.apply(this,arguments)}function L(){return w.apply(this,arguments)}function w(){return(w=(0,r._)((function(){var e,t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:e=u.u1i,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.UserFeedback.GetInitializationData()];case 2:return e=n.sent(),[3,4];case 3:return t=n.sent(),(0,c.io)("error in UserFeedback GetInitializationData : ".concat(t.message)),(0,s.cY)("Error in OfficeFirstParty UserFeedback GetInitializationData ",t),[3,4];case 4:return[2,e]}}))}))).apply(this,arguments)}function R(){return U.apply(this,arguments)}function U(){return(U=(0,r._)((function(){var e,t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:e={},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.UserFeedback.GetHostScreenshot()];case 2:return e=n.sent(),[3,4];case 3:return t=n.sent(),(0,c.io)("error in UserFeedback GetHostScreenshot : ".concat(t.message)),(0,s.cY)("Error in OfficeFirstParty UserFeedback GetHostScreenshot ",t),[3,4];case 4:return[2,e]}}))}))).apply(this,arguments)}function B(e,t,n){return x.apply(this,arguments)}function x(){return(x=(0,r._)((function(e,t,n){var r,o,a;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:if(e!==_.$G.TenantFeedback)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),r=new p.jYE({userPrincipalName:t,redirectUri:(0,g.x3)(),logTelemetry:(0,f.RyG)()}),[4,(0,p.sJD)(r,"https://substrate.office.com/tenantfeedback")];case 2:return o=n.sent(),[2,{token:"Bearer ".concat(o.accessToken)}];case 3:throw a=n.sent(),(0,c.io)("error in UserFeedback GetUserAccessToken : ".concat(a.message)),(0,s.cY)("Error in OfficeFirstParty UserFeedback GetUserAccessToken ",a),a;case 4:return(0,s.cY)("Invalid audience to fetch user access token: ".concat(e)),[2,void 0]}}))}))).apply(this,arguments)}function W(e,t){try{OfficeFirstParty.UserFeedback.InvokeDiagnosticsLogsUpload(e)}catch(e){(0,c.io)("error in UserFeedback InvokeDiagnosticsLogsUpload : ".concat(e.message)),(0,s.cY)("Error in OfficeFirstParty UserFeedback InvokeDiagnosticsLogsUpload ",e)}}function F(){if(d.Ms)try{var e=JSON.parse(d.Ms);return e&&(e=(0,a._)((0,o._)({},e),{callbackFunctions:(0,a._)((0,o._)({},e.callbackFunctions),{provideDynamicScreenshot:R,getUserAccessToken:B}),feedbackConfig:(0,a._)((0,o._)({},e.feedbackConfig),{diagnosticsConfig:(0,a._)((0,o._)({},e.feedbackConfig.diagnosticsConfig),{attachDiagnostics:W})}),telemetry:(0,a._)((0,o._)({},e.telemetry),{uiHost:"Word",platform:h.i.getM365ChatClientPlatform()})})),{feedbackInitOptions:e,lightTheme:{baseTheme:"WordLightTheme"},darkTheme:{baseTheme:"WordDarkTheme"}}}catch(e){return(0,c.io)("error in UserFeedback createFeedbackSettings : ".concat(e.message)),void(0,s.cY)("Error in parsing feedbackInitializationData to JSON ",e)}}function N(){return K.apply(this,arguments)}function K(){return(K=(0,r._)((function(){var e,t,n,r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:e=!1,o.label=1;case 1:return o.trys.push([1,3,,8]),[4,OfficeFirstParty.UserFeedback.CanCollectCopilotFeedback()];case 2:return e=o.sent(),(0,s.cY)("OfficeFirstParty CanCollectCopilotFeedback : "+e),[3,8];case 3:t=o.sent(),o.label=4;case 4:return o.trys.push([4,6,,7]),(0,c.io)("error in CanCollectCopilotFeedback Api : ".concat(t.message)),(0,s.cY)("Error in UserFeedback CanCollectCopilotFeedback : ",t),[4,OfficeFirstParty.UserFeedback.CanCollectUserFeedback()];case 5:return e=o.sent(),(0,s.cY)("OfficeFirstParty CanCollectUserFeedback : ",e),[3,7];case 6:return n=o.sent(),(0,c.io)("error in CanCollectUserFeedback Api : ".concat(n.message)),(0,s.cY)("Error in UserFeedback CanCollectUserFeedback : ",n),(r=d.Vv.getSettingAsString(d.zj.FeedbackEnabled))&&(e="true"===r.toLowerCase(),(0,s.cY)("HostAppSetting Feedbackenabled : ",e)),[3,7];case 7:return[3,8];case 8:return[2,e]}}))}))).apply(this,arguments)}function H(){return G.apply(this,arguments)}function G(){return(G=(0,r._)((function(){var e,t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:e=!1,n.label=1;case 1:return n.trys.push([1,3,,5]),[4,OfficeFirstParty.UserFeedback.CheckFeedbackEligibility("CanShowSingleClickCopilotFeedbackButton")];case 2:return e=n.sent(),(0,s.cY)("OfficeFirstParty CheckFeedbackEligibility : "+e),[3,5];case 3:return t=n.sent(),(0,c.io)("error in CheckFeedbackEligibility Api : ".concat(t.message)),(0,s.cY)("Error in UserFeedback CheckFeedbackEligibility : ",t),[4,N()];case 4:return e=n.sent(),[3,5];case 5:return[2,e]}}))}))).apply(this,arguments)}var Q,j=(Q=(0,r._)((function(e){return(0,i.__generator)(this,(function(t){return(0,s.cY)("launchCopilotChatDialog with context:",JSON.stringify(e)),OfficeFirstParty.PrivateApi.execute(JSON.stringify({dispidMethod:2002,context:e})).catch((function(e){(0,s.cY)("debugLog: Failed to call OfficeFirstParty PrivateApi execute: "+e)})),[2]}))})),function(e){return Q.apply(this,arguments)});!function(){var e=(0,r._)((function(){var e,t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:(0,s.cY)("triggerReadAloud called"),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.PrivateApi.execute(JSON.stringify({dispidMethod:2005}))];case 2:return e=r.sent(),(0,s.cY)("ReadAloud result:",e),[2,e];case 3:return t=r.sent(),n="Failed to trigger ReadAloud: ".concat(t),(0,s.cY)("Error in triggerReadAloud:",n),(0,c.io)(n),[2,u.u1i];case 4:return[2]}}))}))}()},158962:()=>{},166524:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var r=n(475119),o=n(423905);function a(e,t){var n,a;void 0===t&&(t=!1);var i=(e||[]).filter((function(e){return!(!e.adaptiveCardJson||e.sourceType&&"CITATION"!==e.sourceType)})),s=null!==(n=null==i?void 0:i.length)&&void 0!==n?n:0;return s>0?((0,r.cY)("Getting apiPluginProp for ApiPluginCard here.."),a={attributions:i},t&&(0,o.ys)(s)):(0,r.cY)("No data(adaptiveCardJson) found for ApiPluginCard."),a}},184712:(e,t,n)=>{"use strict";n.d(t,{J_:()=>i,WH:()=>r});n(769);var r,o=n(242154),a=n(758651);function i(e){try{var t="";if(null==document)return void(0,o.cY)("SendMessageToHost failed. document object is null!");t=document.referrer,window.parent.postMessage(e,t)}catch(t){a.log("ChatWord Log: SendMessageToHost failed with exception: ",t," for event: ",e)}}!function(e){e.ChatWordExitClicked="ChatWordExitClicked",e.ChatWordLikeClicked="ChatWordLikeClicked",e.ChatWordDislikeClicked="ChatWordDislikeClicked",e.ChatWordSuggestionClicked="ChatWordSuggestionClicked",e.ChatWordShowDesigner="ChatWordShowDesigner",e.ChatWordQueryExecutionStart="ChatWordQueryExecutionStart",e.ChatWordQueryExecutionComplete="ChatWordQueryExecutionComplete",e.ChatWordTriggerFloodgateSurvey="ChatWordTriggerFloodgateSurvey",e.ChatWordTriggerTTVRMessage="CopilotChatTTVRMessage",e.ChatPPTShowDesigner="ChatPPTShowDesigner",e.TriggerCommentHighlight="TriggerCommentHighlight",e.ExpandPane="ExpandPane",e.ExpandPaneForLoop="ExpandPaneForLoop",e.ExpandToClientThird="ExpandToClientThird",e.ResetPaneSize="ResetPaneSize",e.ExpandPaneForSideQuest="ExpandPaneForSideQuest",e.ResetPaneForSideQuest="ResetPaneForSideQuest"}(r||(r={}))},185088:(e,t,n)=>{"use strict";n.d(t,{$d:()=>E,Bh:()=>O,M7:()=>w,MC:()=>b,_p:()=>L,hk:()=>k,qu:()=>R,tp:()=>y,vq:()=>v});var r=n(341422),o=n(555799),a=n(644275),i=n(243912),s=n(511559),c=n(332532),l=n(623268),u=n(502402),d=n(61714),_=n(83437),p=n(423905),g=n(475119),f=n(822606),h=n(153668),C=n(76554),m=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},v=function(e,t,n){var r;(void 0===n&&(n=!1),n)?h.z.getInstance().resetPersonalizationHITLActionState():(void 0===(r=e)&&(r=[]),(null==r?void 0:r.length)>0&&(null==r?void 0:r.some((function(e){return e.responseType===s.yl.Confirm_Set_Personalization_Profile||e.responseType===s.yl.Confirm_Delete_Personalization_Profile})))&&(h.z.getInstance().setIsPersonalizationHITLResponseCardActive(!0),h.z.getInstance().setPersonalizationHITLActionButtonList(T(e,t))))},E=function(){return h.z.getInstance().getIsPersonalizationHITLResponseCardActive()?h.z.getInstance().getPersonalizationHITLActionButtonList():[]},y=function(){return h.z.getInstance().getIsPersonalizationHITLResponseCardActive()},b=function(e){h.z.getInstance().setPersonalizationHITLCardActivationTime(e)},T=function(e,t){var n,r=[],o="";return null==e||e.forEach((function(e){switch(e.responseType){case s.yl.Confirm_Set_Personalization_Profile:r.push(I(e,t)),o=s.yl.Confirm_Delete_Personalization_Profile.toString();break;case s.yl.Confirm_Delete_Personalization_Profile:r.push(A(e,t)),o=s.yl.Confirm_Delete_Personalization_Profile.toString()}})),g.EG.sendChatEventTelemetry((0,p.pN)(((n={})[_.h3.ChatEventType]=_.a5.PersonalizationHITLCardShown,n[_.h3.ChatEventParameters]=o,n))),r},I=function(e,t){return{type:r.jA.Default,title:(0,f.np)(),text:(0,f.np)(),iconRegular:l.N5_,iconHover:l.FUA,handleButtonOnClick:function(n,r,o){P(t,e,(0,f.np)(),o)},isDisabled:!0}},P=function(e,t,n,r){var o,a;void 0===r&&(r=f.u1),S(e,n);var i=(0,p.zq)(r).correlationId;void 0===i&&((0,g.cY)("Invalid correlationId from original profile update query."),g.EG.sendChatEventTelemetry((0,p.pN)(((o={})[_.h3.ChatEventType]=_.a5.UndefinedQueryIDInHITLCard,o))),i=(0,d.A)()),(0,g.hX)(g.EG.setQueryGuid)||g.EG.setQueryGuid(i),(0,g.hX)(g.EG.logKeptEvent)||g.EG.logKeptEvent(_.CC.Customize,_.CC.Customize);var s=t.argumentKeys.findIndex((function(e){return e===f.iX}));if(-1===s)return(0,g.cY)("Failed to find profile ID in required action parameters for personalization confirm button."),void(null===(a=e.current)||void 0===a||a.addResponseMessage(k()));var l=t.argumentValues[s],u=t.queryLanguage;(0,C.c)(e,i,c.X.SET_PROFILE,l,u),h.z.getInstance().resetPersonalizationHITLActionState()},A=function(e,t){return{type:r.jA.Default,title:(0,f.OZ)(),text:(0,f.OZ)(),iconRegular:u.va_,iconHover:u.TTy,handleButtonOnClick:function(n,r,o){D(t,e,(0,f.OZ)(),o)},isDisabled:!0}},D=function(e,t,n,r){var o;void 0===r&&(r=f.u1),S(e,n);var a=(0,p.zq)(r).correlationId;void 0===a&&((0,g.cY)("Failed to find correlation ID in required action parameters for personalization delete button."),g.EG.sendChatEventTelemetry((0,p.pN)(((o={})[_.h3.ChatEventType]=_.a5.UndefinedQueryIDInHITLCard,o))),a=(0,d.A)()),(0,g.hX)(g.EG.setQueryGuid)||g.EG.setQueryGuid(a);var i=t.queryLanguage;(0,C.c)(e,a,c.X.DELETE_PROFILE,f.u1,i),h.z.getInstance().resetPersonalizationHITLActionState()},S=function(e,t){var n,r,i;M(e),h.z.getInstance().setPersonalizationHITLUserInteractionTime(),g.EG.sendLatencyTelemetry((0,p.pN)(((n={})[_.CT.PersonalizationCardUserInteractionTime]=h.z.getInstance().getPersonalizationHITLUserInteractionTime(),n))),null===(r=e.current)||void 0===r||r.addResponseMessage({chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:a.Q9.Human,messageHeader:{text:t}}}}),null===(i=e.current)||void 0===i||i.startLoadingUi()},M=function(e){for(var t,n,r,a,i,s=null===(t=e.current)||void 0===t?void 0:t.getLastMessage(!0),c=null!==(n=null==s?void 0:s.messageType)&&void 0!==n?n:o._.MarkdownCard,l=null!==(a=null===(r=null==s?void 0:s.actionBarButtons)||void 0===r?void 0:r.slice())&&void 0!==a?a:[],u=0,d=l;u<d.length;u++){var _=d[u];_.text!==(0,f.np)()&&_.text!==(0,f.OZ)()||(_.isDisabled=!0)}null===(i=e.current)||void 0===i||i.updateLastMessage({chatCardType:c,chatMessageBodyData:{actionButtonList:m([],l,!0)}})},O=function(e){var t={correlationId:e,featureName:_.CC.Customize},n=f.u1;try{n=JSON.stringify(t)}catch(e){(0,g.cY)("Failed to stringify telemetry data for Personalization ",e)}return n},k=function(e,t,n){var r={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:i.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:O(n),feedbackData:(0,g.hX)(g.t6.getFeedbackData)?void 0:g.t6.getFeedbackData(void 0,t)};return{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:a.Q9.Chat,messageHeader:{text:null!=e?e:(0,f.de)()}}},chatMessageBodyData:r,stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!0}},L=function(e){var t;h.z.getInstance().getIsPersonalizationHITLResponseCardActive()&&(M(e),g.EG.sendChatEventTelemetry((0,p.pN)(((t={})[_.h3.ChatEventType]=_.a5.UserOverridedPersonalizationHITL,t))),g.EG.sendLatencyTelemetry([],!0),h.z.getInstance().resetPersonalizationHITLActionState())},w=function(e){var t,n,r,o,a=null===(t=e.current)||void 0===t?void 0:t.getLastMessage(!0),i=null!==(n=a.actionBarButtons)&&void 0!==n?n:[];if(h.z.getInstance().getIsPersonalizationHITLResponseCardActive()){for(var s=null!==(o=null===(r=null==a?void 0:a.actionBarButtons)||void 0===r?void 0:r.slice())&&void 0!==o?o:[],c=0,l=s;c<l.length;c++){var u=l[c];u.text!==(0,f.np)()&&u.text!==(0,f.OZ)()||(u.isDisabled=!1)}i=s}return i},R=function(){return{featureName:_.CC.Customize,subFeatureName:_.Ff.PersonalizationHITL}}},192318:(e,t,n)=>{"use strict";n.d(t,{p4:()=>Nt,PF:()=>Ot,Uy:()=>Lt,wl:()=>kt,i8:()=>St,zn:()=>Mt});var r=n(720570),o=n(743032),a=n(811912),i=n(791165),s=n(990813),c=n(992960),l=n(575965),u=n(107182),d=n(857835),_=n(461838),p=n(928499),g=n(4026),f=n(379490),h=n(86511),C=n(965801),m=n(884038),v=n(784567),E=n(314268),y=n(208520),b=function(){return y.createElement("svg",{width:"28",height:"28",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y.createElement("rect",{width:"20",height:"20",rx:"10",fill:"url(#pattern0)"}),y.createElement("defs",null,y.createElement("pattern",{id:"pattern0",patternContentUnits:"objectBoundingBox",width:"1",height:"1"},y.createElement("use",{xlinkHref:"#image0_6409_5011",transform:"scale(0.0033557)"})),y.createElement("image",{id:"image0_6409_5011",width:"298",height:"298",xlinkHref:"data:image/png;base64,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"})))},T=function(){return y.createElement("svg",{width:"20",height:"20",viewBox:"2 2 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},y.createElement("path",{d:"M14.293 9.99984L11.6109 12.6824C11.4157 12.8776 11.4157 13.1942 11.6109 13.3895C11.7845 13.563 12.0539 13.5823 12.2488 13.4473L12.318 13.3895L15.884 9.82067L15.9336 9.74953L15.9612 9.69372L15.984 9.62609L15.9889 9.60536C15.9962 9.57168 16 9.53647 16 9.50038L15.9945 9.5743L15.9982 9.54286L15.9982 9.45786L15.9832 9.37155L15.9622 9.30934L15.9228 9.23337L15.8683 9.16222L12.318 5.61129C12.1228 5.41603 11.8062 5.41603 11.6109 5.61129C11.4373 5.78486 11.4181 6.05428 11.5531 6.24915L11.6109 6.3184L14.293 8.99984L10 9.00038C6.47823 9.00038 4.11461 10.9762 4.00405 13.7928L4 14.0004C4 14.2765 4.22386 14.5004 4.5 14.5004C4.77614 14.5004 5 14.2765 5 14.0004C5 11.7272 6.80747 10.0958 9.73848 10.0044L10 10.0004L14.293 9.99984Z",fill:"#242424"}))},I=n(309964),P=n(644275),A=n(962304),D=n(555799),S=n(956775),M=n(602061),O=n(858703),k=n(656904),L=n(313222),w=n(111246),R=n(942449),U=n(147903),B=n(847354),x=n(336045),W=n(28515),F=n(63461),N=n(932554),K=n(722603),H=n(934761),G=n(448397),Q=n(140889),j=n(769449),Y=function(){function e(){var t=this;(0,a._)(this,e),(0,s._)(this,"connectedToInternet",navigator.onLine),(0,s._)(this,"onOnline",(function(){t.connectedToInternet=!0,H.P.getInstance().isRequestPending()&&G.B.getInstance().sendChatEventTelemetry((0,j.pN)((0,s._)({},Q.h3.ChatEventType,Q.a5.InternetReconnected)))})),(0,s._)(this,"onOffline",(function(){t.connectedToInternet=!1})),(0,s._)(this,"IsConnectedToNetwork",(function(){return navigator.onLine&&e.getInstance().connectedToInternet})),this.connectedToInternet=navigator.onLine,window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)}return(0,i._)(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,s._)(Y,"instance",void 0);var z=n(844807),q=n(492644),V=n(457476),Z=n(231006),J=n(661218),X=n(146931),$=n(871598),ee=n(689265),te=n(242154),ne=n(839054),re=n(537319),oe=n(740389),ae=n(598309),ie=n(158473),se=n(504600),ce=n(808896),le=n(117658),ue=n(371194),de=n(405469),_e=n(934189),pe=n(982308),ge=n(280205),fe=n(765799);var he=function(e){var t={staticStrings:k.fGO},n=(0,oe.l3J)();return e.push({workflowAnnotationType:$.H.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n,config:(0,oe.O7K)()?t:void 0}),e.push({workflowAnnotationType:re.Pd.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:1e3*(0,oe._1Y)()}),e},Ce=function(e){return he(e),e.push({workflowAnnotationType:C.MH.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:ne.Ml.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1,forceReturnCachedAnnotations:!0,activateAnnotationInALRequestResponse:!!(0,oe.NT7)()||void 0}),e},me=n(330743),ve=n(154317),Ee=n(862853),ye=n(663279),be=n(832713),Te=n(124857),Ie=n(889899),Pe=n(249002),Ae=n(46727),De=n(610918),Se=n(407039),Me=n(992950),Oe=n(891585),ke=n(246205),Le=n(194961),we={gap:"14px",padding:"10px 14px 10px 14px"},Re={fontFamily:"Segoe UI, sans-serif",fontWeight:600,color:"#242424",fontSize:"20px"},Ue={fontWeight:400,fontSize:"16px"},Be={fontSize:"20px",fontWeight:400,fontFamily:"Segoe UI",marginBottom:"15px"},xe=function(e){var t=e.text,n=e.icon,r=e.style;return y.createElement(ke.a,null,y.createElement(Le.B,{horizontal:!0,gap:8},y.createElement(ke.a,null,n),y.createElement(ke.a,{styles:{root:{marginTop:"4px"}},style:r},y.createElement("span",null,t))))},We=function(e){var t,n,r,o,a,i;return y.createElement(Le.B,{role:"menu",style:we},y.createElement(ke.a,{style:Be},y.createElement("span",null,null!==(t=e.reviewSyncHeaderText)&&void 0!==t?t:"Sure, I suggest continuing with ReviewSync agent:")),y.createElement(xe,{text:null!==(n=e.reviewSyncText)&&void 0!==n?n:"ReviewSync",icon:null!==(r=e.reviewSyncIcon)&&void 0!==r?r:y.createElement(b,null),style:Re}),y.createElement(ke.a,{style:(0,d._)({},Ue)},y.createElement("span",null,null!==(o=e.reviewSyncDescriptionText)&&void 0!==o?o:"I'm the ultimate agent for document reviews, and can help you launch, track progress and resolve review comments.")),y.createElement(ke.a,null,y.createElement(Le.B,{horizontal:!0},y.createElement(ke.a,null,y.createElement(Oe.$,{onClick:e.onLaunch},y.createElement(Le.B,{gap:8,horizontal:!0},y.createElement(ke.a,null,null!==(a=e.reviewSyncContinueIcon)&&void 0!==a?a:y.createElement(T,null)),y.createElement(ke.a,{style:Ue},null!==(i=e.buttonText)&&void 0!==i?i:"Continue with ReviewSync")))))))};const Fe={create:function(e){return y.createElement(We,e)}};var Ne,Ke=n(156845),He=n(15743),Ge=n(246539),Qe=n(702655),je=n(219270),Ye=n(768885),ze=n(228783),qe=n(45512),Ve=n(40956),Ze=n(758651),Je=(Ne=(0,o._)((function(){var e,t,n,r,a;return(0,f.__generator)(this,(function(i){switch(i.label){case 0:return Ze.log("Test:: launchBYOAModal invoked"),t=window.location.href.replace("taskpane.html","byoaDialog.html"),[4,OfficeFirstPartyAuth.getAccessToken({resource:"https://augloop.office.com/v2",DEFAULT_SCOPE:"Augloop.All",silentLogin:!0},{popup:!1})];case 1:return n=i.sent(),r=n.accessToken,a={token:r},[4,Office.context.ui.displayDialogAsync(t,{displayInIframe:!0,hideTitle:!0,height:95,width:95},function(){var t=(0,o._)((function(t){return(0,f.__generator)(this,(function(n){return(e=t.value).addEventHandler(Office.EventType.DialogMessageReceived,function(){var t=(0,o._)((function(t){return(0,f.__generator)(this,(function(n){return t.message===Ve.w.Ack?e.messageChild(JSON.stringify(a)):t.message===Ve.w.CloseEvent&&e.close(),[2]}))}));return function(e){return t.apply(this,arguments)}}()),[2]}))}));return function(e){return t.apply(this,arguments)}}())];case 2:return i.sent(),[2]}}))})),function(){return Ne.apply(this,arguments)}),Xe=n(64047),$e=new Map([["7afaf781-cfb5-48d1-bf3b-fc2904ec0bbes",function(){return(0,k.Csj)()?WordCopilot.CshRibbonCopilotInAppHelpInsertTablePrompt:"How to add a table?"}],["807ce404-698d-4a60-8c2d-76b6bf38cbec",function(){return(0,k.Csj)()?WordCopilot.CshRibbonCopilotInAppHelpOfficeVoicePrompt:"How to dictate my document?"}],["4cec4e8a-7f8d-4cd0-b1fc-04f01ddda5b7",function(){return(0,k.Csj)()?WordCopilot.CshRibbonCopilotInAppHelpColorPickerFontPrompt:"How to change the font color?"}],["c1158665-306f-42d1-b6de-8a91af2f2786",function(){return(0,k.Csj)()?WordCopilot.CshRibbonCopilotInAppHelpPageNumbersPrompt:"How to insert page numbers?"}],["2751cee0-902a-4d09-ade3-dd300cce2cca",function(){return(0,k.Csj)()?WordCopilot.LppTuiAnticipateQuestions:"Pretend that you are reviewing this document, what questions or issues would you raise about this document?"}],["a070a215-a41a-4bcc-bc2a-c94a0786e95e",function(){return(0,k.Csj)()?WordCopilot.LppTuiIdentifyFAQs:"Construct a list of the top 10 frequently asked questions for this document. Present the information as a numbered sequence of questions followed by their respective answers."}],["ec9b810c-c200-4bcd-93f4-393f03c0b75e",function(){return(0,k.Csj)()?WordCopilot.LppTuiIdentifyKeyTerms:"Identify key terms within this document that a newcomer would need to understand. Please organize the information into a table format with columns for the terms and their definitions."}]]);var et,tt=n(641002),nt=n(567179),rt=n(61714),ot=n(403162),at=n(273529),it=n(257490),st=n(42667),ct=n(217762),lt=n(184712),ut=function(){function e(){(0,a._)(this,e)}return(0,i._)(e,null,[{key:"sendAutoOpenTTVRMessageEvent",value:function(t){(0,lt.J_)({type:lt.WH.ChatWordTriggerTTVRMessage,message:e.createAutoOpenTTVRMessage(t)})}},{key:"createAutoOpenTTVRMessage",value:function(e){var t={MessageId:"WordCopilotMessage",SendTime:Date.now(),Values:{Payload:{type:"CopilotAutoOpen",CopilotTTVRCheckpoint:{ttvrCheckpoint:e}}}};return(0,te.cY)("sdxToWordMessageObject",JSON.stringify(t)),JSON.stringify(t)}}]),e}();!function(e){e.AutoOpenTTVR="visuallyReady",e.CopilotChatMessageType="CopilotChatTTVRMessage"}(et||(et={}));var dt=n(539797),_t=n(758651);function pt(){return gt.apply(this,arguments)}function gt(){return gt=(0,o._)((function(){return(0,f.__generator)(this,(function(e){return[2,Word.run(function(){var e=(0,o._)((function(e){var t;return(0,f.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.document.body).load("text"),[4,e.sync()];case 1:return n.sent(),[2,t.text]}}))}));return function(t){return e.apply(this,arguments)}}())]}))})),gt.apply(this,arguments)}function ft(){return(ft=(0,o._)((function(e,t){var n,r;return(0,f.__generator)(this,(function(o){return t?(n="xxxxyxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),w.$.getInstance().displayResponse({chatCardType:D._.MarkdownCard,chatMessageData:{markDownCardProps:{user:P.Q9.Chat,message:e}},chatMessageBodyData:{messageId:n}})):(r=w.$.getInstance().getLastMessage(),w.$.getInstance().updateLastMessage({chatCardType:D._.MarkdownCard,chatMessageData:{markDownCardProps:{user:P.Q9.Chat,message:e}},chatMessageBodyData:{messageId:r.messageId}})),[2]}))}))).apply(this,arguments)}function ht(e,t){return Ct.apply(this,arguments)}function Ct(){return Ct=(0,o._)((function(e,t){var n,r,o,a,i,s,c,l,u,d,_,p,g,h,C,m,v,E,y;return(0,f.__generator)(this,(function(f){switch(f.label){case 0:n="",r=["qnn-deepseek-r1-distill-qwen-1.5b","DeepSeek-R1-Distilled-NPU-Optimized","deepseek-r1-distill-qwen-1.5b-cpu-int4-rtn-block-32-acc-level-4"],o=!0,a=!1,i=void 0,f.label=1;case 1:f.trys.push([1,11,12,13]),s=r[Symbol.iterator](),f.label=2;case 2:if(o=(c=s.next()).done)return[3,10];l=c.value,f.label=3;case 3:return f.trys.push([3,8,,9]),d=function(e,t,n){var r="",o="｜";return r=e.toLowerCase().includes("summarize")?"Please summarize of the given text.   The summary should capture the main points and key details of the text while conveying the author's intended meaning accurately.   Please ensure that the summary is well-organized and easy to read, with clear headings and subheadings to guide the reader through each section.   The length of the summary should be appropriate to capture the main points and key details of the text,  without including unnecessary information or becoming overly long. Here is the text :\n\n":e.toLowerCase().includes("rewrite")?"Rewrite the following text and ensure you:  1. maintain a similar text length; 2. Provide the result directly without any greeting. Here is the text :\n\n":"Answer the question : \n\n"+e+"\n\nOnly based on the context provided, do not add any content based on your own knowledge: \n\n",{model:t,messages:[{role:"user",content:'"<'.concat(o,"User").concat(o,">").concat(r).concat(n,"<").concat(o,"Assistant").concat(o,'>"')}],temperature:.7,top_p:1,top_k:10,max_tokens:2048,stream:!0}}(e,l,t),[4,fetch("http://127.0.0.1:5272/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})];case 4:if(!(_=f.sent())||!_.ok)return[3,9];p=null===(u=_.body)||void 0===u?void 0:u.getReader(),g=new TextDecoder("utf-8"),h=!0,f.label=5;case 5:return p?[4,p.read()]:[3,7];case 6:return C=f.sent(),m=C.value,C.done?[3,7]:(v=g.decode(m,{stream:!0}),n+=function(e){var t="",n=e.split("\n"),r=!0,o=!1,a=void 0;try{for(var i,s=n[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var c=i.value;if(c.trim().startsWith("data: "))try{var l=c.trim().substring(6).match('"content":"(.*?)"');l&&l[1]&&(t+=JSON.parse('"'.concat(l[1],'"')))}catch(e){_t.error("Error parsing JSON:",e)}}}catch(e){o=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}var u=t.indexOf("</think>");return-1!==u?t.substring(u+8).trim():t}(v),function(e,t){ft.apply(this,arguments)}(n,h),h=!1,[3,5]);case 7:return[3,9];case 8:return E=f.sent(),(0,M.cY_)("Error with model ".concat(l,":"),E),[3,9];case 9:return o=!0,[3,2];case 10:return[3,13];case 11:return y=f.sent(),a=!0,i=y,[3,13];case 12:try{o||null==s.return||s.return()}finally{if(a)throw i}return[7];case 13:return[2,n]}}))})),Ct.apply(this,arguments)}var mt=n(910480),vt=n(618859),Et=n(32099),yt=n(965974),bt=function(){function e(){(0,a._)(this,e),(0,s._)(this,"handler",void 0),this.handler=J.E.getInstance()}return(0,i._)(e,[{key:"updateTelemetryChatEventData",value:function(e,t){this.handler.updateTelemetryChatEventData(e,t)}},{key:"updateTelemetryLatencyData",value:function(e,t){this.handler.updateTelemetryLatencyData(e,t)}}]),e}(),Tt=function(){function e(){(0,a._)(this,e)}return(0,i._)(e,[{key:"getInstance",value:function(){return yt.M.getInstance()}}]),e}(),It=function(){function e(){(0,a._)(this,e)}return(0,i._)(e,[{key:"getSettingAsString",value:function(e){return N.Vv.getSettingAsString(e)}}]),e}(),Pt=function(){function e(){(0,a._)(this,e)}return(0,i._)(e,[{key:"isNullOrUndefined",value:function(e){return(0,Pe.hX)(e)}},{key:"debugLog",value:function(e){(0,te.cY)(e)}}]),e}(),At={ChatEventType:{BizChatALSessionInitializationStarted:Q.a5.BizChatSessionInitializationStarted,BizChatALSessionInitializationCompleted:Q.a5.BizChatSessionInitializationCompleted,BizChatALSessionInitializationFailed:Q.a5.BizChatSessionInitializationFailed},LatencyKeys:{BizChatALSessionCreationTime:Q.CT.BizChatSessionCreationTime,BizChatALTotalInitializationTime:Q.CT.BizChatTotalInitializationTime,BizChatALAnnotationRegistrationTime:Q.CT.BizChatAnnotationRegistrationTime,BizChatALHandoffAnnotationCount:Q.CT.BizChatHandoffAnnotationCount},ChatEventsKeys:{ChatEventType:Q.h3.ChatEventType,ChatEventParameters:Q.h3.ChatEventParameters}},Dt=function(){function e(t){(0,a._)(this,e),(0,s._)(this,"communicationHandler",void 0),this.communicationHandler=t}return(0,i._)(e,[{key:"getALSession",value:function(){var e=this;return(0,o._)((function(){return(0,f.__generator)(this,(function(t){return[2,e.communicationHandler.getALSession()]}))}))()}}]),e}();var St,Mt,Ot,kt,Lt,wt=function(){function e(){(0,a._)(this,e),(0,s._)(this,"toolPromise",void 0),(0,s._)(this,"name","WordCanvasTool")}return(0,i._)(e,[{key:"tryInvoke",value:function(e){var t=this;return(0,o._)((function(){var n,r,o,a;return(0,f.__generator)(this,(function(i){switch(i.label){case 0:if("Microsoft.Office.WordCanvas"!==(null==(n=e.invocation)?void 0:n.local_endpoint))return[2,{isHandled:!1}];r=void 0,i.label=1;case 1:return i.trys.push([1,3,,4]),r=(0,M.wai)(n.payload),(0,oe.UZi)()?((0,te.cY)("[WordCanvasTool] Executing ".concat(r.method,":").concat(r.id," ...")),[4,t.dispatchRequest(r)]):[2,t.buildHandledResult(e,(0,M.C$H)(r,"Word Canvas tool is unavailable"))];case 2:return o=i.sent(),(0,te.cY)("[WordCanvasTool] Executed ".concat(r.method,":").concat(r.id," successfully")),[2,t.buildHandledResult(e,(0,M.Bbs)(r,o))];case 3:return a=i.sent(),(0,te.cY)(te.SA.Error,"[WordCanvasTool] Failed to invoke a function ".concat(a.message)),[2,t.buildHandledResult(e,(0,M.C$H)(r,a))];case 4:return[2]}}))}))()}},{key:"dispatchRequest",value:function(e){var t=this;return(0,o._)((function(){var n,r,o;return(0,f.__generator)(this,(function(a){switch(a.label){case 0:return n=e.method,r=e.params,[4,t.loadTool()];case 1:switch(o=a.sent(),n){case"getDocumentHtml":return[3,2];case"beginEditSession":return[3,4];case"endEditSession":return[3,6];case"insertNode":return[3,8];case"replaceNodeContent":return[3,10];case"deleteNode":return[3,12]}return[3,14];case 2:return[4,o.getDocumentHtml()];case 3:case 5:case 7:case 9:case 11:case 13:return[2,a.sent()];case 4:return[4,o.beginEditSession(r)];case 6:return[4,o.endEditSession(r)];case 8:return[4,o.insertNode(r)];case 10:return[4,o.replaceNodeContent(r)];case 12:return[4,o.deleteNode(r)];case 14:throw new Error("Function ".concat(n," is not supported"));case 15:return[2]}}))}))()}},{key:"loadTool",value:function(){var e=this;return(0,o._)((function(){var t;return(0,f.__generator)(this,(function(r){switch(r.label){case 0:return null!==(t=e.toolPromise)&&void 0!==t||(e.toolPromise=n.e(769).then(n.bind(n,778833)).then((function(e){return e.default()}))),[4,e.toolPromise];case 1:return[2,r.sent()]}}))}))()}},{key:"buildHandledResult",value:function(e,t){return{isHandled:!0,response:{correlation_id:e.correlation_id,schema_version:e.schema_version,response:t}}}}]),e}(),Rt=n(758651),Ut=function(){var e=(0,o._)((function(e,t){var n,r;return(0,f.__generator)(this,(function(o){switch(o.label){case 0:return n={query:e,contextId:t,isStreaming:!0},(0,Ee.q0)()?[4,(0,be.Eb)((function(){return(0,Pe.Mo)()}))]:[3,2];case 1:return r=o.sent(),[3,3];case 2:r=void 0,o.label=3;case 3:return n.config=r,[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}(),Bt=function(){var e=(0,o._)((function(e,t){var n,r;return(0,f.__generator)(this,(function(o){switch(o.label){case 0:return n={query:e,queryId:t,raw:!0},(0,Ee.q0)()?[4,(0,be.Eb)((function(){return(0,Pe.Mo)()}))]:[3,2];case 1:return r=o.sent(),[3,3];case 2:r=void 0,o.label=3;case 3:return n.config=r,[2,n]}}))}));return function(t,n){return e.apply(this,arguments)}}(),xt=function(){var e=(0,o._)((function(e,t){var n,r,o,a,i=arguments;return(0,f.__generator)(this,(function(s){switch(s.label){case 0:return n=i.length>2&&void 0!==i[2]&&i[2],r=!(i.length>3&&void 0!==i[3])||i[3],o={queryId:t,userPrompt:e,userPromptRequestedLanguage:(0,Te.mf)()},(0,Ee.q0)()?[4,(0,be.Eb)((function(){return(0,Pe.Mo)()}))]:[3,2];case 1:return a=s.sent(),[3,3];case 2:a=void 0,s.label=3;case 3:return o.copilotInputConfig=a,o.isProactive=n,o.useCitations=r,[2,o]}}))}));return function(t,n){return e.apply(this,arguments)}}();var Wt=k.u1i,Ft=function(){var e=(0,o._)((function(e,t,n,r,o,a){var i,c,l,u,g,h,C,m,v,E,y,b,T,P,A,D,S,O,L,w,R,U,B,x,W,F,H,Y,z,q,Z,J,$,ee,ne,re,ie,se,ce,le,ue,de,_e,pe,ge,fe,he,Ce=arguments;return(0,f.__generator)(this,(function(f){switch(f.label){case 0:return i=Ce.length>6&&void 0!==Ce[6]?Ce[6]:[],c=Ce.length>7?Ce[7]:void 0,l=Ce.length>8?Ce[8]:void 0,g=Ce.length>11?Ce[11]:void 0,h=Ce.length>12?Ce[12]:void 0,C=Ce.length>13?Ce[13]:void 0,m=Ce.length>14?Ce[14]:void 0,v=void 0,(u=Ce.length>9?Ce[9]:void 0)?[3,5]:(E=(0,M.y8L)(a,c),(E?(0,oe.Ypu)():(0,oe.$9h)())?[4,(0,V.EM)()]:[3,2]);case 1:return b=f.sent(),[3,3];case 2:b=void 0,f.label=3;case 3:if(y=b){D=null!==(A=null===(T=y.selection)||void 0===T?void 0:T.pictures)&&void 0!==A?A:[],S=!0,O=!1,L=void 0;try{for(w=D[Symbol.iterator]();!(S=(R=w.next()).done);S=!0)(U=R.value).base64String&&i.push(U.base64String)}catch(e){O=!0,L=e}finally{try{S||null==w.return||w.return()}finally{if(O)throw L}}G.B.getInstance().sendChatEventTelemetry((0,j.pN)((0,s._)({},Q.jr.ImplicitContextObjectTypes,JSON.stringify(null===(P=y.selection)||void 0===P?void 0:P.objectTypes))))}return B=y?JSON.stringify(y):void 0,x=B?JSON.stringify([B]):void 0,W=(0,oe.AgJ)()?h:void 0,(x||W&&"[]"!=W)&&(v=function(e,t){var n=(new Date).getTime(),r=[];try{var o=JSON.parse(e||"[]"),a=JSON.parse(t||"[]");if(!Array.isArray(o)||!Array.isArray(a))throw new Error("One or more of the input strings is not a valid JSON array.");var i,c=!1;if(o.length>0&&a.length>0){var l=o[0],u=a[a.length-1];c=(0,mt.isEqual)(l,u)}return r=(0,p._)(c?[]:o).concat((0,p._)(a)),G.B.getInstance().sendChatEventTelemetry((0,j.pN)((i={},(0,s._)(i,Q.jr.ContextTreeImplicitCount,o.length),(0,s._)(i,Q.jr.ContextTreeExplicitCount,a.length),(0,s._)(i,Q.jr.ContextTreeMergedCount,r.length),(0,s._)(i,Q.jr.IgnoreImplicitContext,c),i))),r.length?JSON.stringify(r):void 0}catch(e){var d;return(0,te.cY)("Exception in mergeImplicitAndExplicitContext(): ".concat(e)),void G.B.getInstance().sendErrorTelemetry((0,j.pN)((d={},(0,s._)(d,Q.IC.ErrorMessage,"Exception in mergeImplicitAndExplicitContext(): ".concat(e.message)),(0,s._)(d,Q.IC.ErrorCategory,I.S2.Error),d)))}finally{G.B.getInstance().sendLatencyTelemetry((0,j.pN)((0,s._)({},Q.CT.ContextTreeMergeTime,(0,M.WUi)(n))))}}(x,W)),m&&(F=JSON.parse(null!=v?v:"[]"),H=JSON.stringify(m),v=JSON.stringify((0,p._)(F).concat([H]))),(0,oe.lWG)()&&C&&((Y=v?JSON.parse(v):[]).push(JSON.stringify({sideQuestLastMessage:C})),v=JSON.stringify(Y)),(0,oe.e6I)()?((0,te.cY)("Adding vibe writing context"),[4,M.BDr.getInstance().getFullDocumentHtml()]):[3,5];case 4:z=f.sent(),q=JSON.parse(null!=v?v:"[]"),Z=JSON.stringify({fullDocumentHtml:z}),v=JSON.stringify((0,p._)(q).concat([Z])),f.label=5;case 5:return J=null==i?void 0:i.map(M.piD)[0],ee=null!==($=null==i?void 0:i.length)&&void 0!==$?$:0,Mt="",void 0===J&&i&&ee>0&&((0,te.cY)("Invalid image data URI in image chat: ".concat(i[0])),(0,j.iL)("Image chat bad image data URI in getFluxInputSignal")),ee>0&&(Mt=i[0],(0,te.cY)("image chat image count: ".concat(ee)),G.B.getInstance().sendChatEventTelemetry((0,j.pN)((ne={},(0,s._)(ne,Q.h3.ChatEventType,Q.a5.TriggerImageChatOperation),(0,s._)(ne,Q.h3.ChatEventParameters,"image chat image count: ".concat(ee)),(0,s._)(ne,Q.h3.UserQueryGuid,t),ne)))),re=k.MYv||(0,N.I_)(),ie=a===k.I47?dt.sp.getInstance().getConversationId():null!=n?n:X.sL.getInstance().getConversationId(),[4,K.i.getDocumentUrlAsync()];case 6:return se=f.sent(),o&&(0,oe.z5w)()&&(ce=(null==o?void 0:o.map((function(e){return e.id})))||[],le=ce.length>0?JSON.stringify(ce):"",(0,te.cY)("Enabled Plugins: ",le),G.B.getInstance().sendChatEventTelemetry((0,j.pN)((ue={},(0,s._)(ue,Q.h3.UserQueryGuid,t),(0,s._)(ue,Q.h3.ChatEventType,Q.a5.EnabledPlugins),(0,s._)(ue,Q.h3.ChatEventParameters,le),ue)))),de=(0,M.Hrz)(c),(0,te.cY)("Mentioned Plugins: ",de),_e=(0,p._)(null!=o?o:[]).concat((0,p._)(null!=de?de:[])).some((function(e){return"MOS3"===e.source})),(0,ae.s)()?[4,(0,be.Eb)((function(){return(0,Pe.Mo)(o)}),se)]:[3,8];case 7:return ge=f.sent(),[3,9];case 8:ge={documentConfig:{documentURL:se},copilotConfig:(0,Pe.Mo)()},f.label=9;case 9:if(pe=ge,(0,oe.NMh)())switch(e){case k.klO:e=k.klO+": "+Wt,pe.copilotConfig.docGroundingDisabled=!0;break;case k.I4U:e=k.I4U+": "+Wt,pe.copilotConfig.docGroundingDisabled=!0,pe.copilotConfig.enterpriseGroundingEnabled=!1;break;case k.tE5:e=k.tE5+": "+Wt,pe.copilotConfig.docGroundingDisabled=!0,pe.copilotConfig.webGroundingEnabled=!1;break;default:!u&&e.length>0&&(Wt=e),pe.copilotConfig.webGroundingEnabled=!1,pe.copilotConfig.enterpriseGroundingEnabled=!1}return fe=void 0,(0,ae.pZ)()?(he=(new Date).getTime(),[4,(0,Pe.UF)()]):[3,11];case 10:fe=f.sent(),(0,te.cY)("Comments check took : ".concat((0,M.WUi)(he))),f.label=11;case 11:return[2,{query:e,context:v,raw:re,queryId:t,gptId:a,config:(0,_._)((0,d._)({},pe),{isToolboxEnabled:!!a||_e&&(0,oe.Py4)(),isInterstitialConfirmationEnabled:!0,isInterstitialAuthenticationEnabled:!0}),conversationId:(0,ae.vf)()?ie:X.sL.getInstance().getConversationId(),queryAnnotations:r,clientUILanguageAndLocale:(0,Te.mf)(),images:J,mentionedPlugins:de,invokeActionConfirmation:l,isWarmUp:u,requestContinuation:g,isCommentAvailable:fe}]}}))}));return function(t,n,r,o,a,i){return e.apply(this,arguments)}}();var Nt=function(e){(0,u._)(n,e);var t=(0,g._)(n);function n(e,i,c,l,u,d,_,p,g){var h;(0,a._)(this,n),h=t.call(this),(0,s._)((0,r._)(h),"handleResponseItem",void 0),(0,s._)((0,r._)(h),"setSuggestionListPool",void 0),(0,s._)((0,r._)(h),"sendLoggingEventToPane",void 0),(0,s._)((0,r._)(h),"setEnterpriseSearchIsEnabled",void 0),(0,s._)((0,r._)(h),"moveScrollToTheTop",void 0),(0,s._)((0,r._)(h),"copilotMenuState",void 0),(0,s._)((0,r._)(h),"handleZQMRefresh",void 0),(0,s._)((0,r._)(h),"handleCopilotAgentFromHostRequest",void 0),(0,s._)((0,r._)(h),"basicChatStatus",void 0),(0,s._)((0,r._)(h),"suggestionPillsController",void 0),(0,s._)((0,r._)(h),"currentWordCountRef",void 0),(0,s._)((0,r._)(h),"queryIdsToSkipTimerReset",new Set),(0,s._)((0,r._)(h),"bizChatALSessionManager",null),(0,s._)((0,r._)(h),"bizChatHostContext",void 0),(0,s._)((0,r._)(h),"setBizChatHostContextState",void 0),(0,s._)((0,r._)(h),"unsubscribe",null),(0,s._)((0,r._)(h),"subscribePreoloadSignal",(function(){h.unsubscribe=He.U.subscribe(h.handleHandoffMessageHostAppSettings.bind((0,r._)(h)))})),(0,s._)((0,r._)(h),"shouldSendExtensibilityAgentsRequestToAL",(0,o._)((function(){var e;return(0,f.__generator)(this,(function(t){switch(t.label){case 0:return Y.getInstance().IsConnectedToNetwork()?[4,(0,M.aWC)()]:(e={errorMessage:(0,k.pwx)(),errorType:"NetworkDisconnected",featureName:Q.CC.CopilotChat},(0,V.KY)((0,k.pwx)(),!1,void 0,void 0,void 0,void 0,void 0,e),[2,!1]);case 1:return t.sent()?[2,!0]:((0,te.cY)("Sensitivity Label APIs failed, not sending request to AL"),[2,!1])}}))})));var C=(0,r._)(h);return(0,s._)((0,r._)(h),"handleHandoffMessageHostAppSettings",(0,o._)((function(){var e,t,n,r,o,a,i,c,l,u,d,_;return(0,f.__generator)(this,(function(p){var g,f;if((0,V.X8)()&&((0,te.cY)("TriggerSummary or OpenPaneProactivelyWithSummary host setting is true"),N.Vv.IsSettingTrue(N.zj.OpenPaneProactivelyWithSummary)&&(0,j.Ws)(),w.$.getInstance().submitUserPromptForSummaryNudge((0,Z.$w)()),(0,oe.EMj)()&&(0,V.cd)()),(0,oe._3I)()&&(0,V.V1)()&&((0,te.cY)("TriggerPodcast or OpenPaneProactivelyWithPodcast host setting is true"),N.Vv.IsSettingTrue(N.zj.OpenPaneProactivelyWithPodcast)&&(0,j.QH)(),w.$.getInstance().submitUserPromptForPodcastNudge((0,Z.v1)()),(0,oe.i5M)()&&(0,V.KS)()),(0,oe.g38)()&&(0,V.oj)()&&(e=N.Vv.getSettingAsString(N.zj.ImageDescriptionAnnotation),t=e&&JSON.parse(e),(0,V.A_)().then((function(e){var n;e.isValid&&(w.$.getInstance().updateAttachmentList([e]),(null==t?void 0:t.manualSendPrompt)||w.$.getInstance().submitUserPromptForDescribeImageNudge((0,Z.iV)())),G.B.getInstance().sendChatEventTelemetry((0,j.pN)((n={},(0,s._)(n,Q.jr.PolarisEntryPointObjectTypes,JSON.stringify(e.objects)),(0,s._)(n,Q.jr.PolarisEntryPointIsValidSelection,e.isValid),n)))})),(0,V.Wu)()),(0,Pe.nP)()&&(n=(0,Pe.iW)(),g=n,f=$e.get(g),(r=f?f():"")&&r.length>0?(w.$.getInstance().submitUserQuery(r),(0,j.B3)(n)):(0,j.wQ)(n)),o=void 0,o=(0,oe.pJh)()?(0,oe.JIK)()?null!==(a=N.Vv.getSettingAsString(N.zj.handoffMessage))&&void 0!==a?a:N.Vv.getSettingAsString(N.zj.HandoffMessage):N.Vv.getSettingAsString(N.zj.handoffMessage):(0,oe.JIK)()?null!==(i=N.Vv.getSetting(N.zj.handoffMessage))&&void 0!==i?i:N.Vv.getSetting(N.zj.HandoffMessage):N.Vv.getSetting(N.zj.handoffMessage))try{u=null===(l=JSON.parse(o))||void 0===l||null===(c=l.items)||void 0===c?void 0:c[0],(0,oe.aQo)()?(ot.p.getInstance().handleHandoffMessage(u,"",!0,w.$.getInstance().getCopilotRef(),C.setBizChatHostContextState,C.bizChatHostContext,w.$.getInstance().getBizChatHandoffPropertiesHandler()),(0,oe.UW0)()&&(0,ae.k1)()&&N.Vv.remove(N.zj.handoffMessage)):(null==(d=null==u?void 0:u.body)?void 0:d.scenarioName)===W.Cu.INAPP&&ot.p.getInstance().processHandoffMessage(d)}catch(e){G.B.getInstance().sendChatEventTelemetry((0,j.pN)((_={},(0,s._)(_,Q.h3.ChatEventType,Q.Nr.HandoffMessageFromHostAppSettingsError),(0,s._)(_,Q.h3.ChatErrorType,k.T__.Client),_)))}return[2]}))}))),(0,s._)((0,r._)(h),"_hostInjectedContextManager",void 0),(0,s._)((0,r._)(h),"suppliedContext",void 0),h.handleResponseItem=e,h.setSuggestionListPool=i,h.sendLoggingEventToPane=c,h.setEnterpriseSearchIsEnabled=l,h.moveScrollToTheTop=u,h.subscribePreoloadSignal(),h.handleZQMRefresh=d,h.handleCopilotAgentFromHostRequest=_,h.suggestionPillsController=p,h.currentWordCountRef=g,h.queryIdsToSkipTimerReset=new Set,(0,ae.k1)()&&(h.bizChatALSessionManager=function(e,t){var n={telemetryEventHandler:new bt,telemetryLogger:new Tt,hostAppSettings:new It,utils:new Pt,constants:At,augloopSharedSessionIDSettingName:N.zj.AugloopSharedSessionID,sessionProvider:t?new Dt(t):void 0};return new M.uhY(e,n)}(h.handleResponseItem,(0,r._)(h)),h.bizChatALSessionManager.initializeBizChatALSession()),h}return(0,i._)(n,[{key:"cleanup",value:function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}},{key:"sendResponseToClient",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k.u1i;(0,te.cY)("Item: ",e),this.handleResponseItem(e,t)}},{key:"isFeatureGateEnabledFromClient",value:function(e){return e===P.WT.IsClpSensitivityInChatInputEnabled?(0,ae.lf)():e===P.WT.EnableALCorrelationLogs?(0,oe.V7J)():e===P.WT.EnableMsgExtCardTelemetry?(0,oe.z5w)():e===P.WT.IsWebSearchDefaultOn?(0,oe.gr8)():e===P.WT.IsPersistanceInPhase2UxEnabled?(0,Ee.q0)()&&(0,oe.epR)():e===P.WT.EnableSendTenantFeedback?(0,ae.z4)():e===P.WT.IsCopilotPluginEnabled?(0,ae.dV)():e===P.WT.EnableCopilotExtTelemetry?(0,oe.ggJ)():e===P.WT.IsDisableChatInputWhenAlSessionCloseEnabled||(e===P.WT.IsSharedCopilotLabEnabled&&!(0,Pe.dD)()&&!(0,N.L1)()||(e===P.WT.IsQnASuggestionPillCachingEnabled?(0,oe.cPf)():e===P.WT.ExtractContentFromCardForFeedback&&!(0,M.$$b)()&&!(0,M.fUp)()||(0,oe.snA)(e)))}},{key:"getNumberFeatureGateValueFromClient",value:function(e){return(0,oe.Z8j)(e,NaN)}},{key:"sendLoggingEventToClient",value:function(e,t){(0,te.cY)("Logging event received from Copilot: ",e),(0,te.cY)("Logging event Args: ",t);N.Vv.getSetting(N.zj.CopilotPaneStartTimestamp);switch(e){case A.Yk.ALSessionInitialized:J.E.getInstance().updateTelemetryLatencyData((0,s._)({},Q.CT.AugloopInitializationTime,(null==t?void 0:t.timeInMs)?(null==t?void 0:t.timeInMs)/1e3:0));break;case A.Yk.AnnotationActivated:J.E.getInstance().updateTelemetryLatencyData((0,s._)({},Q.CT.AnnotationActivationTime,(null==t?void 0:t.timeInMs)?(null==t?void 0:t.timeInMs)/1e3:0));break;case A.Yk.AugloopResponseReceived:var n,r=(null==t?void 0:t.timeInMs)?(null==t?void 0:t.timeInMs)/1e3:0,o=null!==(n=null==t?void 0:t.annotationName)&&void 0!==n?n:"";X.sL.getInstance().logAnnotationResponses(o,r);break;case A.Yk.ZQMLoaded:case A.Yk.MenuButtonItemClicked:case A.Yk.MenuButtonItemClickedL1:case A.Yk.SuggestionPillClicked:case A.Yk.ZQMButtonItemClicked:this.sendLoggingEventToPane(e,t);break;case A.Yk.VoiceCopilotConnectionStarted:var a;G.B.getInstance().sendChatEventTelemetry((0,j.pN)((a={},(0,s._)(a,Q.h3.ChatEventType,e),(0,s._)(a,Q.h3.ChatEventParameters,t.timestamp),a))),G.B.getInstance().sendLatencyTelemetry((0,j.pN)((0,s._)({},Q.CT.FeatureName,Q.CC.ConversationalCopilot)));break;case A.Yk.VoiceCopilotSessionInitialMessageSent:case A.Yk.VoiceCopilotSessionStarted:case A.Yk.VoiceCopilotUserSpeechStarted:case A.Yk.VoiceCopilotUserSpeechStopped:case A.Yk.VoiceCopilotStateChanged:case A.Yk.VoiceCopilotResponseReceived:case A.Yk.VoiceCopilotPlaybackGlitchDetected:case A.Yk.VoiceCopilotFirstBufferReceived:case A.Yk.VoiceCopilotFinishedPlayerBuffer:case A.Yk.VoiceCopilotSessionStopped:case A.Yk.VoiceCopilotError:case A.Yk.VoiceCopilotWarning:case A.Yk.VoiceCopilotSessionDisconnected:case A.Yk.VoiceCopilotInfo:case A.Yk.VoiceCopilotReadAloudToolbarLoaded:case A.Yk.VoiceCopilotReadAloudChatPaneLoaded:case A.Yk.VoiceCopilotReadAloudAudioPlayed:case A.Yk.VoiceCopilotReadAloudAudioLoaded:case A.Yk.VoiceCopilotReadAloudAudioPlayClicked:case A.Yk.VoiceCopilotReadAloudAudioResumeClicked:case A.Yk.VoiceCopilotReadAloudAudioPrevClicked:case A.Yk.VoiceCopilotReadAloudAudioNextClicked:case A.Yk.VoiceCopilotReadAloudMuteButtonUnmuted:case A.Yk.VoiceCopilotReadAloudMuteButtonLoaded:case A.Yk.VoiceCopilotInteractiveReadAloudUserPerceivedLatency:case A.Yk.VoiceCopilotInteractiveReadAloudTTSFirstResponseLatency:var i;G.B.getInstance().sendChatEventTelemetry((0,j.pN)((i={},(0,s._)(i,Q.h3.ChatEventType,e),(0,s._)(i,Q.h3.ChatEventParameters,null==t?void 0:t.chatEventParams),i)));break;case A.Yk.VoiceCopilotInteractiveReadAloudIsSeen:G.B.getInstance().logSeenEvent(void 0,Q.CC.InteractiveReadAloud,h.RX.ReadAloud,Q.CC.InteractiveReadAloud);break;case A.Yk.VoiceCopilotInteractiveReadAloudIsTried:G.B.getInstance().logTriedEvent(void 0,Q.CC.InteractiveReadAloud,h.RX.ReadAloud,Q.CC.InteractiveReadAloud);break;case A.Yk.VoiceCopilotInteractiveReadAloudIsKept:G.B.getInstance().logKeptEvent(Q.CC.InteractiveReadAloud,Q.CC.InteractiveReadAloud,h.RX.ReadAloud);break;case A.Yk.VoiceCopilotIsTried:G.B.getInstance().logTriedEvent(void 0,Q.CC.RealtimeVoice,h.RX.Voice,Q.CC.RealtimeVoice);break;case A.Yk.VoiceCopilotReadAloudIsSeen:G.B.getInstance().logSeenEvent(void 0,Q.CC.RealtimeVoice,h.RX.Voice,Q.CC.RealtimeVoice)}}},{key:"addQueryIdToSkipTimerReset",value:function(e){var t;null===(t=this.queryIdsToSkipTimerReset)||void 0===t||t.add(e)}},{key:"removeQueryIdToSkipTimerReset",value:function(e){var t;null===(t=this.queryIdsToSkipTimerReset)||void 0===t||t.delete(e)}},{key:"calcEventTimeInSeconds",value:function(e,t){return(null==t?void 0:t.timestamp)&&e>0?((null==t?void 0:t.timestamp)-e)/1e3:0}},{key:"shouldSendRequestToAugloop",value:function(e){var t=this;return(0,o._)((function(){var n,r,o,a,i,s;return(0,f.__generator)(this,(function(c){switch(c.label){case 0:return(0,te.cY)("Message text: ",e),V.os.getInstance().setQueryTime((new Date).getTime()),(0,oe.WFw)()&&G.B.getInstance().sendHandoffQuerySubmittedEvent(e),[4,t.shouldSendExtensibilityAgentsRequestToAL()];case 1:if(!c.sent())return[2,!1];if((0,M.Ldm)()!==k.u1i)return[2,!0];if((0,oe.sc)()&&(0,Pe.CP)(e.toLowerCase()))return t.copilotMenuState(k.vy2),[2,Promise.resolve(!1)];if(n=(0,oe.Z8j)("AgentInputPrototype",0),e.toLowerCase().includes("setopenaikey"))return r=e.split(" ")[1].trim(),[2,Promise.resolve(!1)];if(n>0&&e.toLowerCase().includes("help me create an agent"))return Je(),[2,Promise.resolve(!1)];if(2==n&&(0,oe.Jqj)()){if((0,Pe.lS)(e))return[2,Promise.resolve(!1)]}else if(3==n&&(0,oe.Jqj)()&&(0,Pe.Dt)(e))return[2,Promise.resolve(!1)];return(0,oe.lH6)()&&(0,oe.SBW)()&&(0,M._pQ)(w.$.getInstance().getCopilotRef()),(0,oe.zk2)()&&e.toLowerCase().includes(k.ydF)?(w.$.getInstance().displayResponse({chatCardType:D._.CopilotWorkflowMessage,chatMessageData:{copilotWorkflowsCardProps:{user:"chat",buttonText:k.d7H,launchText:k.sVF,onLaunch:function(){t.handleResponseItem({id:k.ydF},k.ydF)}}}}),[2,Promise.resolve(!1)]):(0,oe.wxD)()&&e.toLowerCase().includes("reviewersync")?(w.$.getInstance().displayResponse({chatCardType:D._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:(l={reviewSyncHeaderText:"Sure, I suggest continuing with ReviewSync agent:",buttonText:"Continue with ReviewSync",reviewSyncText:"ReviewSync",reviewSyncDescriptionText:"I'm the ultimate agent for document reviews, and can help you launch, track progress and resolve review comments.",ReviewerSyncIcon:b,ReviewSyncContinueIcon:T,function:function(){Rt.log("Hello")}},Fe.create(l))}}}),[2,Promise.resolve(!1)]):(0,oe.Jrn)()&&(o=w.$.getInstance().getCopilotRef().current,a=(0,oe._kL)(),(0,M.dkM)(e,o,a))?[2,Promise.resolve(!1)]:(0,oe.wzE)()&&e.toLowerCase().startsWith("launchthisversionofsdx")?[4,(0,O.qo)()]:[3,3];case 2:return c.sent().toLowerCase(),(0,M.Bp2)(e.split(":")[1]),[2,Promise.resolve(!1)];case 3:if(e.toLowerCase()===M.p0W)return s=(0,M.y5p)(null!==(i=N.Vv.getSettingAsString(N.zj.AugLoopCloudALServiceUrl))&&void 0!==i?i:N.Vv.getSettingAsString(N.zj.AugLoopCloudALServiceUrlWAC)),(0,V.Pi)({messageText:s,showAIGenerated:!1}),[2,Promise.resolve(!1)];switch(e){case(0,Z.kO)()[Z.M9.HOW_CAN_COPIOT_HELP]():case k.UeP.help():return(0,V.wM)(),[2,Promise.resolve(!1)];case(0,k.JDs)():return(0,oe.DwB)()?((0,te.rw)(t.setSuggestionListPool,!0),(0,V.CM)(),[2,Promise.resolve(!1)]):[2,Promise.resolve(!0)];default:return[2,Promise.resolve(!0)]}return[2]}var l}))}))()}},{key:"feedbackButtonClicked",value:function(e,t,r,o,a){var i,s,u;(0,te.cY)("Feedback button clicked");var d,_=e===A.Gb.LIKE?Q.a5.ThumbsUpButtonClicked:Q.a5.ThumbsDownButtonClicked,p=[{key:"groundingSource",value:null!==(d=null===(i=t.contextData)||void 0===i?void 0:i.groundingSource)&&void 0!==d?d:"CurrentContext"}];if((0,j.Gp)(null!=r?r:"",_,p),!(0,oe.HHe)()){var g,f=(null!==(g=t.feedbackArea)&&void 0!==g?g:(0,oe.mOp)())?k.UWp:k.Wat;if(t.feedbackArea=f,(0,oe.mOp)())(0,c._)((0,l._)(n.prototype),"feedbackButtonClicked",this).call(this,e,t,r,o,a);else{var h,C=(null===(s=t.contextData)||void 0===s?void 0:s.cardMetaData)?JSON.parse(null===(u=t.contextData)||void 0===u?void 0:u.cardMetaData):void 0;h=(0,oe.vAO)()?e===A.Gb.DISLIKE?k.uoO.AIThumbsDown:k.uoO.AIThumbsUp:e===A.Gb.DISLIKE?k.uoO.AIThumbsDown:void 0;var m=(0,ye.mh)(C,h),v=e===A.Gb.LIKE?k.Zid.Like:k.Zid.Dislike,E=k.NXZ.ModalDialog;K.i.GetHostAppPlatform()===k.nAd&&(E=k.NXZ.Taskpane),(0,ye.N6)(v,E,f,m)}}}},{key:"sendEventToClient",value:function(e,t){var n=this;return(0,o._)((function(){var r,o,a,i,c,l,u,d,_,p,g,h,m,E,y,b,T,I,P,D,S,O,R,U;return(0,f.__generator)(this,(function(f){switch(f.label){case 0:switch(e){case A.PV.AugloopResponseTimeout:return[3,1];case A.PV.AnnotationActivated:return[3,3];case A.PV.StopGeneratingButtonClicked:return[3,4];case A.PV.QueryEndOnGptSwitch:return[3,5];case A.PV.CopilotChatLoaded:return[3,6];case A.PV.BasicChatSuggestionPills:return[3,8];case A.PV.BizChatNativeLoaded:return[3,9];case A.PV.CitationLinkClicked:return[3,10];case A.PV.ChatTopicChanged:return[3,14];case A.PV.BasicChatStatus:return[3,15];case A.PV.ChatHistoryHydrationFailed:return[3,16];case A.PV.CreateNewConversationButtonClicked:return[3,17];case A.PV.ResetContextId:return[3,18];case A.PV.PluginsStateUpdated:return[3,19];case A.PV.SharedHeaderRendered:return[3,20];case A.PV.AddInLocalPluginActionInvoked:case A.PV.AddInLocalPluginActionsInvoked:return[3,21];case A.PV.HandleSubmitForDQGCLicked:return[3,22];case A.PV.GenericMessageEvent:return[3,23];case A.PV.VoiceToolbarLargeLoaded:return[3,24];case A.PV.VoiceToolbarSmallLoaded:return[3,25]}return[3,26];case 1:return(0,te.cY)("AUGLOOP_RESPONSE_TIMEOUT: ",t),[4,(0,V.v2)(t.workflowAnnotationType)];case 2:return f.sent(),[3,26];case 3:return(0,te.cY)("AnnotationActivated: ",t.workflowAnnotationType),(0,Pe._L)(t.workflowAnnotationType),[3,26];case 4:return(0,te.cY)("Stop Generating Button Clicked: ",t),(0,V.S0)(Ot,n.basicChatStatus),[3,26];case 5:return(0,te.cY)("Stop Generating Gpt Switched: ",t),(0,V.Np)(Ot,n.basicChatStatus),[3,26];case 6:return(0,te.cY)("Copilot Chat Loaded Clicked: ",t),t&&t&&(r=t.gptId,(0,te.cY)("Current Selected Copilot Extension Id: ".concat(r)),(0,M.P71)(null!=r?r:k.u1i)),(0,V.sZ)(),kt=!0,(0,j.ud)(G.B.getInstance()),B=new v.Xr({parentPath:["session","#userContext#"],items:[{id:"myUserContext1",body:new C.MH({isAdminControlTurnedOn:(0,Pe.$i)()})}]}),w.$.getInstance().submitOperation({operation:B,workflowAnnotationType:C.MH.getTypeName()}),n.moveScrollToTheTop(),N.Vv.IsSettingTrue(N.zj.AutoOpenChatPane)&&ut.sendAutoOpenTTVRMessageEvent(et.AutoOpenTTVR),(0,oe.KOx)()&&(0,M.r7C)(),[4,n.handleHandoffMessageHostAppSettings()];case 7:return f.sent(),(0,Pe.El)(),(0,ae.af)()&&(o=N.Vv.getSetting(N.zj.CopilotAgentToLoadAfterLaunch),(0,te.cY)("Chat Loaded: Switch to Agent Post Load with AgentId: ",o),o&&o!==k.u1i&&(N.Vv.set(N.zj.CopilotAgentToLoadAfterLaunch,k.u1i),n.handleCopilotAgentFromHostRequest({actionType:M.Atg.Activated,titleId:o}))),[3,26];case 8:return(0,te.cY)("BasicChat SuggestionPills event triggered: ",t),(a=t).suggestionPills&&0!==a.suggestionPills.length?n.setSuggestionListPool(a.suggestionPills):(0,te.cY)("No suggestions returned by Basic Chat workflow"),[3,26];case 9:return(0,oe.KOx)()?(i=N.Vv.IsSettingTrue(N.zj.AutoOpenChatPane),c=t,(0,M.jgs)("WordCopilotMessage",i,c,(function(e){return(0,lt.J_)(e)}),(0,oe.Qq4)()),(0,oe.AkJ)()&&"TTVR"===(null==c?void 0:c.measureType)&&(0,j.ud)(G.B.getInstance()),[3,26]):[3,26];case 10:return(0,te.cY)("Citation Link Clicked: ",t),(null==(l=t)?void 0:l.referencePath[0])?[4,L.F.getInstance().highlightCitation(l.referencePath[0])]:[3,12];case 11:return f.sent(),[3,13];case 12:(0,te.cY)("No refernce path returned by citation"),f.label=13;case 13:return[3,26];case 14:return(0,te.cY)("Chat Topic Changed: ",t),n.setSuggestionListPool([]),(0,V.iV)(),[3,26];case 15:return u=t,n.basicChatStatus=u.status,u.status===A.y2.Started&&Se.s.getInstance().setSkillName(Me.B.BasicChat),u.status===A.y2.Finished&&(Ae.h.logSurveyTriggerEvent(De.w2.WordCopilotAsk),Se.s.getInstance().setSkillName(Me.B.BasicChat)),[3,26];case 16:return(0,ae.vf)()&&(0,ae.yV)()&&(d={errorMessage:(0,k.ghp)(),errorType:"ChatHistoryHydrationFailed",featureName:Q.CC.CopilotChat},(0,V.KY)((0,k.ghp)(),!0,void 0,void 0,void 0,!1,void 0,d)),[3,26];case 17:return(0,te.cY)("Create New Conversation event received"),(0,Ee.q0)()&&n.handleZQMRefresh(),(0,oe.Slc)()&&(n.suggestionPillsController(),n.setSuggestionListPool([])),[3,26];case 18:return(0,te.cY)("CopilotEvent ResetContextId received"),H.P.getInstance().emptyContextIdListandCleanup(),X.sL.getInstance().resetWordAppCopilotStreamingState(),[3,26];case 19:if((0,ae.vI)()&&!(0,oe.oJj)()&&(0,oe.HSC)()&&t.pluginsInfo.findIndex((function(e){return e&&e.id===k.VMi&&e.state===k.hiv}))>=0){if((0,Ee.LA)(!0),(0,Ee.q0)())try{null===(_=it.A.getInstance())||void 0===_||_.setIsEnterpriseCheckEnabled(!0),1===(null===Ge.I||void 0===Ge.I?void 0:Ge.I.getValue().iteration)&&0===(null===He.U||void 0===He.U?void 0:He.U.getValue().iteration)&&0===(null===Qe.w||void 0===Qe.w?void 0:Qe.w.getValue().iteration)&&n.handleZQMRefresh()}catch(e){(0,te.cY)("Error setting enterprise check enabled in sessionStorage",e)}n.setEnterpriseSearchIsEnabled(!0),G.B.getInstance().sendChatEventTelemetry([{key:Q.h3.ChatEventType,value:Q.a5.GroundingSourceUpdated},{key:Q.h3.ChatEventParameters,value:"Work:AutoOn"}])}return[3,26];case 20:return(0,oe.aC$)()&&(window.StaticHeaderLoadTime||(0,Xe.hC)(),G.B.getInstance().sendLatencyTelemetry((0,j.pN)((g={},(0,s._)(g,Q.CT.StaticSharedHeaderLoadTimeInMs,null!==(p=window.StaticHeaderLoadTime)&&void 0!==p?p:""),(0,s._)(g,Q.CT.SharedHeaderLoadTimeInMs,window.performance.now()),g)))),[3,26];case 21:return(0,te.cY)("AddInLocalPluginActionInvoked:",{eventArgs:t}),h=t,(0,M.f99)(h,Ke.O3,Ke.BV,Ke.p9),[3,26];case 22:return(0,ae.Il)()&&(0,oe.Slc)()&&(n.suggestionPillsController(),n.setSuggestionListPool([])),[3,26];case 23:switch((m=t).type){case"CloseSessionPane":(0,Xe.vo)();break;case"CloseDialog":(0,Xe.MA)(null!==(y=null===(E=m.args)||void 0===E?void 0:E.payload)&&void 0!==y?y:"");break;case"OnInsertClick":R={labelId:null!==(S=null===(T=m.args)||void 0===T||null===(b=T.sensitivityLabel)||void 0===b?void 0:b.id)&&void 0!==S?S:"",tenantId:"",color:null!==(O=null===(P=m.args)||void 0===P||null===(I=P.sensitivityLabel)||void 0===I?void 0:I.color)&&void 0!==O?O:""},(0,Pe.jM)(R),(0,Ie.QE)(null!==(U=null===(D=m.args)||void 0===D?void 0:D.insertContent)&&void 0!==U?U:"")}f.label=24;case 24:return(0,Xe.OE)(),[3,26];case 25:return(0,Xe.$9)(),[3,26];case 26:return[2]}var B}))}))()}},{key:"hostInjectedContextManager",get:function(){var e;if((0,oe.Ozm)())return null!==(e=this._hostInjectedContextManager)&&void 0!==e||(this._hostInjectedContextManager=this.buildHostInjectedContext()),this._hostInjectedContextManager}},{key:"buildHostInjectedContext",value:function(){return(new je.R).registerProvider(Ye.t,(function(){var e=new wt;return new ze._([e])})).build()}},{key:"shouldIgnoreResponse",value:function(e){return(0,o._)((function(){var t,n,r,o,a,i,c,l,u;return(0,f.__generator)(this,(function(d){if(n=!1,null===(t=e.body)||void 0===t?void 0:t.H_){switch(e.body.H_.T_){case C.Sy.getTypeName():r=e.body.contextId;break;case E.XV.getTypeName():case R.Ob.getTypeName():case $.H.getTypeName():case pe.q.getTypeName():r=e.body.queryId;break;default:return(0,te.cY)("shouldIgnoreResponse: No matching annotation found"),(0,te.cY)("shouldIgnoreResponse: "+n),[2,n]}(0,te.cY)("query id: ",r),(n=!H.P.getInstance().isValidAnnotationResponse(r))&&((0,te.cY)("Ignoring Annotation for annotation ".concat(null===(a=e.body)||void 0===a||null===(o=a.H_)||void 0===o?void 0:o.T_," with contextId: ").concat(r)),G.B.getInstance().sendChatEventTelemetry((0,j.pN)((u={},(0,s._)(u,Q.h3.ChatEventType,Q.a5.InvalidContextIdResponse),(0,s._)(u,Q.h3.ChatEventParameters,null!==(l=null===(c=e.body)||void 0===c||null===(i=c.H_)||void 0===i?void 0:i.T_)&&void 0!==l?l:""),(0,s._)(u,Q.h3.UserQueryGuid,null!=r?r:""),u))))}return(0,te.cY)("shouldIgnoreResponse: "+n),[2,n]}))}))()}},{key:"getWorkflowsToRegister",value:function(e){var t=function(e){var t=[];if(e)return(0,te.cY)("Adding only Flux annotations for Custom GPT",e),Ce(t);var n=(0,oe.l3J)();return t.push({workflowAnnotationType:C.Sy.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),(0,oe.qcN)()&&t.push({workflowAnnotationType:x.P.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t.push({workflowAnnotationType:E.XV.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t.push({workflowAnnotationType:_e.H6.getTypeName(),shouldHandleResponse:!(0,oe.yto)(),augloopResponseTimerRequired:!0,augloopResponseTimeout:24e4}),t.push({workflowAnnotationType:pe.q.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:24e4}),t.push({workflowAnnotationType:_e.Vd.getTypeName(),shouldHandleResponse:!(0,oe.yto)(),augloopResponseTimerRequired:!0}),((0,oe.zP3)()||(0,oe.qH6)())&&he(t),(0,oe.zP3)()||(0,oe.qH6)()||t.push({workflowAnnotationType:re.CT.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:1e3*(0,oe._1Y)()}),t.push({workflowAnnotationType:R.KJ.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t.push({workflowAnnotationType:R.Ob.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t.push({workflowAnnotationType:C.MH.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),Office.context.platform!==Office.PlatformType.PC&&Office.context.platform!==Office.PlatformType.Mac&&Office.context.platform!==Office.PlatformType.iOS||t.push({workflowAnnotationType:ie.WordCount.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),t.push({workflowAnnotationType:ce.w.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1,augloopResponseTimeout:n}),(0,oe.WFw)()&&((0,ae.k1)()||(t.push({workflowAnnotationType:F.uC.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n}),t.push({workflowAnnotationType:F.dF.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:n}),t.push({workflowAnnotationType:F.kp.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}))),t.push({workflowAnnotationType:ne.Ml.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1,forceReturnCachedAnnotations:!0,activateAnnotationInALRequestResponse:!!(0,oe.NT7)()||void 0}),(0,oe.lH6)()&&(0,oe.SBW)()&&t.push({workflowAnnotationType:le.H.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),(0,oe.gNz)()&&t.push({workflowAnnotationType:ue.Z.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),(0,oe.zQd)()&&(t.push({workflowAnnotationType:de.d.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n}),t.push({workflowAnnotationType:"AugLoop_CopilotChatTeachingUi_CopilotChatTeachingUIAnnotation",shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:n})),(0,oe.WNl)()&&t.push({workflowAnnotationType:se.p1.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:2*n}),(0,oe.stP)()&&t.push({workflowAnnotationType:ge.xc.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:12e4}),(0,oe.qNw)()&&(t.push({workflowAnnotationType:fe.ht.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),t.push({workflowAnnotationType:fe.CP.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1})),t}(e);return t}},{key:"getALSession",value:function(){return(0,o._)((function(){var e,t,n,r,o;return(0,f.__generator)(this,(function(a){return e=N.Vv.getSettingAsString(N.zj.AugloopSharedSessionID),t=(0,me.wB)((0,V.hX)(e)?"ALDummySession":e),(0,oe.Rq8)()&&(r=null==t||null===(n=t.getConnectParams())||void 0===n?void 0:n.sessionUrl,o=r?r.substring(r.lastIndexOf("/")+1):"sessionUrl Undefined",G.B.getInstance().sendChatEventTelemetry([{key:Q.h3.ChatEventType,value:Q.a5.AugloopSharedSessionIDMappingToALSessionKey},{key:Q.h3.ChatEventParameters,value:e},{key:Q.h3.ALSessionKey,value:o}])),[2,t]}))}))()}},{key:"getPreloadSignal",value:function(e){switch(e){case at.U.HidePane:return Qe.w;case at.U.StartPreload:return Ge.I;default:return He.U}}},{key:"getHostSettings",value:function(){var e={appName:"Word",appPlatform:K.i.GetHostAppPlatform(),devBuild:k.MYv||(0,te.Xx)(),environment:(0,N.rA)(),sessionId:"",augloopUrl:(0,N.Dl)(),getDocumentUrlAsync:K.i.getDocumentUrlAsync,substrateScenarioName:k.rGh[K.i.GetHostAppPlatform()],substrateProactiveZQMScenarioName:k.VeX[K.i.GetHostAppPlatform()],language:(0,Te.mf)(),sessionStorageKey:this.getSessionStorageKey(),enterpriseUser:(0,Ee.q0)(),m365ChatConfiguration:{environment:(0,N.rj)(),host:vt.vb.Word,clientPlatform:K.i.getM365ChatClientPlatform()}};return(0,oe.mOp)()&&N.Ms&&(e.feedbackSettings=(0,Ke.fC)()),e}},{key:"getSessionStorageKey",value:function(){var e,t,n,r,o=window.Office.context,a=null==o?void 0:o.platform,i=null==o||null===(t=o.hostSettings)||void 0===t||null===(e=t._settings)||void 0===e?void 0:e.IsCopilotPreloaded;if(a===window.Office.PlatformType.OfficeOnline)n=null==o||null===(r=o.hostSettings)||void 0===r?void 0:r.get("wacSessionId");else if(i){var s,c,l,u=null==o||null===(l=o.document)||void 0===l||null===(c=l.settings)||void 0===c||null===(s=c._clientSettingsManager)||void 0===s?void 0:s._osfClientContext,d=null==u?void 0:u.GetCorrelationId(),_=null==u?void 0:u.GetDocUrl();d&&(d=d.replace(/[{}]/g,"")),_&&d&&(n="".concat(d).concat("string"==typeof _?(0,M.ifM)((new TextEncoder).encode(_)):""))}return n}},{key:"updateCopilotState",value:function(e){(0,te.cY)("updateCopilotState: ".concat(e)),e===A.SG.QUERY_SUBMITTED&&(0,oe.UxI)()&&M.xPp.getCurrentAddinState()===M.aB5.ShowButton&&((0,Ie.jk)(),G.B.getInstance().sendChatEventTelemetry((0,j.pN)((0,s._)({},Q.h3.ChatEventType,M.rsb.UndoButtonHiddenOnSubmittingQueryAfterAddinSuccess))),M.xPp.transitionAddinState(M.aB5.Idle))}},{key:"getDefaultSignalOperation",value:function(e,t,n,r,a,i,c,l,u,_,p,g,h,E,y,b,T,I){var A=this;return(0,o._)((function(){var r,o,T,O,L,R,W,N,Y,Z,J,ne,re,ie,se,ce,le,de,ge,fe,he,Ce,me,ye,be,Te,Ae,De,Me,Oe,ke,Le,we;return(0,f.__generator)(this,(function(f){switch(f.label){case 0:return r=(0,M.TRs)(u,l,S.defaultCopilotChatMenuItemId),(0,M.P71)(null!=r?r:k.u1i),(0,Ee.j3)(b),o=(0,oe.CYx)()&&!p&&A.currentWordCountRef.current?{wordCount:{wordNumber:A.currentWordCountRef.current.toString()}}:void 0,(0,oe.KQw)()&&(0,Pe.y9)(e.toLocaleLowerCase())||(0,oe.yto)()&&(0,Pe.eN)(e.toLocaleLowerCase())?((0,te.cY)("Create Podcast command detected"),[4,(0,Pe.$C)()]):[3,3];case 1:return T=f.sent(),[4,K.i.getDocumentUrlAsync()];case 2:return O=f.sent(),L=Array.isArray(E)&&(null==E?void 0:E.find((function(e){return!!e})))?E:[O],(0,te.cY)("current documentURL:",O),L.find((function(e){return!!e}))||G.B.getInstance().sendChatEventTelemetry((0,j.pN)((R={},(0,s._)(R,Q.h3.UserQueryGuid,t),(0,s._)(R,Q.h3.ChatEventType,Q.a5.AudioCastConfigError),(0,s._)(R,Q.h3.ChatEventParameters,"Empty document URL: ".concat(Array.isArray(E)," :: ").concat(L.length)),R))),W=(0,Pe.zS)(I),Y=(0,oe.HKE)(),(0,oe.KQw)()&&(0,Pe.y9)(e.toLocaleLowerCase())?(Y?(Z=(0,oe.txF)()?{clientConfiguration:(0,Pe.jG)()}:{},N=new st.B({query:"",queryId:t,audioCastPayload:(0,d._)({isStreamingRequired:!0,requestSource:ct.FL.CopilotApp,mode:ct.f9.Podcast,files:L.map((function(e){return{fileUrl:e}})),requiredOutputs:(0,Pe.cC)(),format:null==W?void 0:W.format,length:null==W?void 0:W.length,tone:null==W?void 0:W.tone,additionalInstructions:null==W?void 0:W.additionalInstructions},Z)})):N=new tt.i({query:"",queryId:(0,rt.A)(),requestType:nt.d2.PODCAST_CREATION,clientRequest:{chatInput:"",chatInputType:nt.RS.GENERATE_PODCAST,requestPayload:JSON.stringify({contentFormat:"html",voiceIds:(0,Pe.ZN)(),fileUrls:L,voiceNames:(0,Pe.oX)(),isStreaming:!0})}}),w.$.getInstance().updateLoaderStrings((0,k.I_t)())):N=new tt.i({query:e,queryId:(0,rt.A)(),requestType:nt.d2.GENERATE_DATA,clientRequest:{chatInput:e,chatInputType:nt.RS.USER_QUERY,requestPayload:JSON.stringify({canvasContent:T,contentFormat:"html"})}}),J=new v.g0({parentPath:[k.HN0,Y?st.B.getTypeName():tt.i.getTypeName()],items:[{id:z.r.generateId(),body:N}]}),H.P.getInstance().addContextId(t),[2,{operation:J,workflowAnnotationType:Y?pe.q.getTypeName():_e.H6.getTypeName()}];case 3:return f.trys.push([3,22,,23]),re=z.r.generateId(),ie="",se="",Ot=t,St=e,Lt=null!=i?i:[],l===k.I47&&(ce=dt.sp.getInstance().getAssistantId(),Lt.push({id:ce,source:""})),le=(0,te.qS)(e),(0,te.cY)("UserQueryCategory: ",le),de=(0,k.wM6)().get(k.Aec.Default),Se.s.getInstance().resetData(),(0,Ie.i6)(),ge=(0,oe.WFw)()&&(0,oe.aIk)()&&(0,M.gIB)(l),(0,oe.Xuj)()&&(St.toLowerCase().includes("clientllm")||St.toLowerCase().includes("deepseek"))?[4,pt()]:[3,7];case 4:return(fe=f.sent())?[4,ht(St,fe)]:[3,6];case 5:f.sent()||w.$.getInstance().displayResponse({chatCardType:D._.MarkdownCard,chatMessageData:{markDownCardProps:{user:P.Q9.Chat,message:"The text is too long to be processed by client LLM."}}}),f.label=6;case 6:throw new Error("**Contents generated by client LLM**\n\n");case 7:return!(0,oe.qcN)()||p?[3,9]:[4,K.i.getDocumentUrlAsync()];case 8:return he=f.sent(),(0,te.cY)(he),Ce={question:e,documentURL:he},ne=new v.g0({parentPath:["Signal",B.T.getTypeName()],items:[{id:re,body:new B.T(Ce)}]}),ie=B.T.getTypeName(),se=x.P.getTypeName(),H.P.getInstance().addContextId(t),[2,{operation:ne,workflowAnnotationType:se}];case 9:return!(k.Aec.GiveMeAnOverview===le||(0,oe.n7p)()&&k.Aec.EnhanceOverview===le)||(0,ae.w9)()?[3,14]:(0,Pe.c5)(l,u,(0,oe.Xao)(),le)||!(0,ae.cU)((0,Ee.w5)())?[3,11]:(X.sL.getInstance().logSignalTypes(ee.ZQ.getTypeName()),[4,Ft(e,t,n,a,Lt,r,c,u,_,p,void 0,g,h,y,o)]);case 10:return me=f.sent(),ne=new v.g0({parentPath:["Signal",ee.ZQ.getTypeName()],items:[{id:re,body:new ee.ZQ(me)}]}),ie=ee.ZQ.getTypeName(),se=$.H.getTypeName(),p||X.sL.getInstance().setWordAppCopilotStreaming(),[3,13];case 11:return(0,te.cY)("Caling Summary Workflow directly"),X.sL.getInstance().logSignalTypes(U.gQ.getTypeName()),[4,xt(e,t)];case 12:ye=f.sent(),ne=new v.g0({parentPath:["Signal",U.gQ.getTypeName()],items:[{id:re,body:new U.gQ(ye)}]}),ie=U.gQ.getTypeName(),se=$.H.getTypeName(),de=(0,k.wM6)().get(k.Aec.GiveMeAnOverview),G.B.getInstance().sendLatencyTelemetry((0,j.pN)((0,s._)({},Q.CT.FeatureName,Q.CC.Summary))),f.label=13;case 13:return(0,te.cY)("Submitting user query for category : ".concat(k.Aec.GiveMeAnOverview)),[3,21];case 14:return(0,oe.gNz)()?(X.sL.getInstance().logSignalTypes(ve.tT.getTypeName()),[4,Bt(e,t)]):[3,16];case 15:return be=f.sent(),ne=new v.g0({parentPath:["Signal",ve.tT.getTypeName()],items:[{id:re,body:new ve.tT(be)}]}),ie=ve.tT.getTypeName(),se=ue.Z.getTypeName(),[3,21];case 16:return k.Aec.TransformDocument===le&&ge?(Te=encodeURI(Office.context.document.url),ne=qe.m.getInstance().getPPTHandoffOperation(re,t,Te),ie=q.L.getTypeName(),se=F.kp.getTypeName(),[3,21]):[3,17];case 17:return(0,ae.cU)((0,Ee.w5)())?(X.sL.getInstance().logSignalTypes(ee.ZQ.getTypeName()),[4,Ft(e,t,n,a,Lt,r,c,u,_,p,A.suppliedContext,g,h,y,o)]):[3,19];case 18:return Ae=f.sent(),ne=new v.g0({parentPath:["Signal",ee.ZQ.getTypeName()],items:[{id:re,body:new ee.ZQ(Ae)}]}),ie=ee.ZQ.getTypeName(),se=$.H.getTypeName(),p||X.sL.getInstance().setWordAppCopilotStreaming(),[3,21];case 19:return X.sL.getInstance().logSignalTypes(m.l.getTypeName()),[4,Ut(e,t)];case 20:De=f.sent(),ne=new v.Xr({parentPath:["Signal",m.l.getTypeName()],items:[{id:re,body:new m.l(De)}]}),ie=m.l.getTypeName(),se=C.Sy.getTypeName(),f.label=21;case 21:return H.P.getInstance().addContextId(t),(0,oe.UxI)()&&M.xPp.isAddinFlow()||w.$.getInstance().updateLoaderStrings(de),(0,j.WZ)(ie),[2,{operation:ne,workflowAnnotationType:se}];case 22:throw Me=f.sent(),Oe=JSON.stringify(Me)+" message: "+(null==Me?void 0:Me.message)+" stack trace: "+(null==Me?void 0:Me.stack)+" exception name: "+(null==Me?void 0:Me.name),(0,te.cY)("Exception in getDefaultSignalOperation: "+Oe),ke=k.u1i,(0,oe.CuF)()&&(ke=Oe),Le={chatEventType:Q.a5.GetSignalOperationException,chatEventParam:ke,chatErrorType:k.T__.Client},(0,oe.jOg)()&&(we={errorMessage:Oe,featureName:Q.CC.CopilotChat,errorType:"ExceptionInGetDefaultSignalOperation"},(0,V.KY)(Oe,!1,void 0,Le,void 0,void 0,void 0,we)),Me;case 23:return[2]}}))}))()}},{key:"setContext",value:function(e){this.suppliedContext=e}},{key:"setCopilotMenuState",value:function(e){this.copilotMenuState=e}},{key:"setBizChatHostContext",value:function(e){this.bizChatHostContext=e}},{key:"setBizChatHostContextSetter",value:function(e){this.setBizChatHostContextState=e}},{key:"getCanvasSelection",value:function(){var e=this;return(0,o._)((function(){var t,n,r,o,a,i,s;return(0,f.__generator)(this,(function(c){switch(c.label){case 0:return(0,oe.$AM)()?[4,null===(t=e)||void 0===t?void 0:t.getALSession()]:[3,2];case 1:o=c.sent(),a=(0,oe.CYx)()&&(null===(r=e)||void 0===r||null===(n=r.currentWordCountRef)||void 0===n?void 0:n.current)?{wordCount:{wordNumber:e.currentWordCountRef.current.toString()}}:void 0,o&&a&&(i=new Et.xx({seq:S.VoiceOperationId.generateId(),documentMetadata:JSON.stringify(a)}),s=new v.Xr({parentPath:["session","doc"],items:[{id:String(i.seq),body:i}]}),o.submitOperation(s)),c.label=2;case 2:return[4,(0,V.A_)()];case 3:return[2,c.sent()]}}))}))()}},{key:"copyButtonClicked",value:function(e,t,n){return(0,o._)((function(){return(0,f.__generator)(this,(function(r){return(0,te.cY)("Copy button clicked called"),(0,Ie.Kv)(e,t,n),[2]}))}))()}},{key:"shouldClearAugloopResponseTimer",value:function(e){if((0,oe.knu)()){var t,n,r=null==e||null===(t=e.body)||void 0===t?void 0:t.queryId;if(r&&(null===(n=this.queryIdsToSkipTimerReset)||void 0===n?void 0:n.has(r)))return!1}return!0}},{key:"getCopilotInputConfig",value:function(){return(0,Ee.q0)()?(0,be.Eb)((function(){return(0,Pe.Mo)()})):new Promise((function(e){return e({})}))}}],[{key:"getInstance",value:function(e,t,r,o,a,i,s,c,l){return n.instance||(n.instance=new n(e,t,r,o,a,i,s,c,l)),n.instance}},{key:"getCurrentInstance",value:function(){return n.instance}}]),n}(S.CopilotCommunicationHandler);(0,s._)(Nt,"instance",void 0)},194054:(e,t,n)=>{"use strict";n(758303),n(475119),n(327099)},194530:(e,t,n)=>{"use strict";n.d(t,{h:()=>s});var r=n(529404),o=n(260623),a={root:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",gap:r.L.spacingVerticalS},spinnerContainer:{justifyContent:"center",width:"100%"}},i=(0,o.n)(a),s=function(){return i()}},197627:(e,t,n)=>{"use strict";n(208520),n(794329),n(984244),n(475119),n(992640)},206447:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=206447,e.exports=t},207545:(e,t,n)=>{"use strict";n.d(t,{kH:()=>i,zj:()=>a});var r=n(423212),o=n(638753),a={AugloopSharedSessionID:"AugloopSharedSessionID",HandoffMessageId:"HandoffMessageId",HandoffMessage:"HandoffMessage",AugLoopCloudALServiceUrl:"AugloopClouldALServiceUrl",CopilotEntryPoint:"CopilotEntryPoint",CopilotStartResponse:"copilotStartResponse",CopilotStartQuery:"CopilotStartQuery",CopilotInitialPrompt:"CopilotInitialPrompt",CopilotStartPromptId:"CopilotStartPromptId",AugloopEverHadModelError:"AugloopEverHadModelError",AudienceGroup:"AudienceGroup",AppStartTimestamp:"AppStartTimestamp",CopilotPaneStartTimestamp:"StartTimeMs",AutoOpenChatPane:"AutoOpenChatPane",BizChatHostContext:"BizChatHostContext"},i=function(){function e(){}return e.getSettingAsString=function(e){if((0,r.isTest)())return"TestSetting";var t=Office.context.hostSettings.get(e);return(0,o.hX)(t)?t:t.toString()},e.getSetting=function(e){return Office.context.hostSettings.get(e.toString())},e.removeSetting=function(e){"undefined"!=typeof Office&&Office.context&&Office.context.hostSettings&&Office.context.hostSettings.remove(e)},e.set=function(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setByKey=function(e,t){Office.context.hostSettings.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setHostSettings=function(e){var t=this;Object.keys(e).forEach((function(n){var r=(0,o.gZ)(e[n]);t.setByKey(n,r)}))},e.IsSettingTrue=function(e){var t=this.getSettingAsString(e);return!!t&&"true"===t.toLowerCase()},e}()},208276:(e,t,n)=>{"use strict";n.d(t,{AG:()=>h,Mx:()=>f,V6:()=>_,_9:()=>p,bY:()=>d,cN:()=>l,jr:()=>s,xb:()=>g});var r=n(743032),o=n(379490),a=n(184712),i=n(242154);function s(e){return c.apply(this,arguments)}function c(){return c=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,Word.run((n=(0,r._)((function(t){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,t.sync()];case 1:return n.sent(),t.document.body.insertHtml(e,Word.InsertLocation.end),[4,t.sync()];case 2:return n.sent(),[2]}}))})),function(e){return n.apply(this,arguments)}))];case 1:return t.sent(),[2]}var n}))})),c.apply(this,arguments)}function l(){return u.apply(this,arguments)}function u(){return u=(0,r._)((function(){var e;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,Word.run((n=(0,r._)((function(e){var t,n;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.sync()];case 1:return r.sent(),t=e.document.getSelection(),n=t.getHtml(),[4,e.sync()];case 2:return r.sent(),[2,n.value||""]}}))})),function(e){return n.apply(this,arguments)}))];case 1:return e=t.sent(),[2,Promise.resolve(e)]}var n}))})),u.apply(this,arguments)}function d(){(0,i.cY)("DEBUGLOG : onCopilotWorkspacePaneOpen"),(0,a.J_)({type:a.WH.ExpandPane})}function _(){(0,i.cY)("DEBUGLOG :onCopilotWorkspacePaneClose"),(0,a.J_)({type:a.WH.ResetPaneSize})}function p(){(0,i.cY)("DEBUGLOG :onLoopCompress"),(0,a.J_)({type:a.WH.ResetPaneSize})}function g(){(0,i.cY)("DEBUGLOG :onPaneFullExpand"),(0,a.J_)({type:a.WH.ExpandPaneForLoop})}function f(){(0,i.cY)("DEBUGLOG :onExpandClientThird"),(0,a.J_)({type:a.WH.ExpandToClientThird})}function h(){(0,i.cY)("DEBUGLOG :onExpandForSideQuest"),(0,a.J_)({type:a.WH.ExpandPaneForSideQuest})}},215751:(e,t,n)=>{"use strict";n.d(t,{Q:()=>c});var r=n(814168),o=n(348854),a=n(208520),i=function(e){},s=(0,r.mL)(o.N,{currentLocale:void 0,strings:{},errorHandler:i,loaders:[],stringMapInitialized:!1});function c(e,t){void 0===t&&(t=i);var n=(0,a.useState)(s),o=n[0],c=n[1];return(0,a.useEffect)((function(){(0,r.Au)((0,r.U5)(e,"en-us"),o).then(c)}),[e]),(0,a.useEffect)((function(){c((0,r._c)(t,o))}),[t]),(0,r.zB)(o)}},217425:(e,t,n)=>{"use strict";n.d(t,{L6:()=>l,MA:()=>i,Ss:()=>s,dX:()=>c,ky:()=>o,mr:()=>a,w8:()=>r});var r={augloop:"https://augloop.office.com/v2/AugLoop.All",loki:"https://loki.delve.office.com",graph:"https://graph.microsoft.com",sharepoint:"https://microsoft-my.sharepoint-df.com",onenote:"https://onenote.com",substrate:"https://substrate.office.com/search",ic3:"https://ic3.teams.office.com",cognitive:"https://cognitiveservices.azure.com"},o="6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",a="https://login.microsoftonline.com/common",i="https://login.microsoftonline.us/common",s="https://titles.prod.mos.microsoft.com",c="https://safelinks.protection.office365.com",l="https://dataservice.o365filtering.com"},224376:(e,t,n)=>{"use strict";n.d(t,{w:()=>a});var r=n(798050),o=n(765799);function a(e){var t,n,a,i,s;return(null===(n=null===(t=e.body)||void 0===t?void 0:t.H_)||void 0===n?void 0:n.T_)===o.ht.getTypeName()?{skill:(s=e.body).scenario,markdownTextSoFar:s.markdownText,json:void 0,errorMessage:void 0,cardState:r.x.UPDATING}:(null===(i=null===(a=e.body)||void 0===a?void 0:a.H_)||void 0===i?void 0:i.T_)===o.CP.getTypeName()?{skill:(s=e.body).scenario,markdownTextSoFar:null,json:s.applicationContent,errorMessage:s.markdownErrorMessage,cardState:s.markdownErrorMessage?r.x.ERRORED:r.x.LOADED}:null}},231006:(e,t,n)=>{"use strict";n.d(t,{$w:()=>p,M9:()=>r,dJ:()=>h,iV:()=>g,kO:()=>b,tJ:()=>T,v1:()=>f});var r,o=n(990813),a=n(623268),i=n(526057),s=n(571002),c=n(990648),l=n(502402),u=n(999493),d=(n(720971),n(249002)),_=n(656904),p=function(){return(0,_.Csj)()?WordCopilot.SummarizeDocMenuText:"Summarize this doc"},g=function(){return"Describe this image"},f=function(){return(0,_.Csj)()?OfficeaicopilotStrings.GenerateAnAudioOverviewFromThisDocument:"Generate an audio overview from this document"},h=function(){return(0,_.Csj)()?"".concat(WordCopilot.ComprehensionOnSelectionExplainToMe,' "{0}"'):'Explain to me "{0}"'},C=function(){return(0,_.Csj)()?WordCopilot.AskAQuestionPlaceholder+"...":"Ask..."};!function(e){e[e.WRITE_ABOUT=0]="WRITE_ABOUT",e[e.REWRITE_TEXT=1]="REWRITE_TEXT",e[e.SUMMARIZE_DOC=2]="SUMMARIZE_DOC",e[e.ASK_A_QUESTION=3]="ASK_A_QUESTION",e[e.ASK_A_QUESTION_ONLY=4]="ASK_A_QUESTION_ONLY",e[e.CHANGE=5]="CHANGE",e[e.GENERATE_IMAGE=6]="GENERATE_IMAGE",e[e.GENERATE_BANNER=7]="GENERATE_BANNER",e[e.HOW_CAN_COPIOT_HELP=8]="HOW_CAN_COPIOT_HELP"}(r||(r={}));var m,v,E,y,b=(m=null,function(){var e;return m||(e={},(0,o._)(e,3,(function(){return(0,d.dD)()?C():(0,_.Csj)()?WordCopilot.AskAQuestionMenuText:"Ask a question about this doc..."})),(0,o._)(e,4,(function(){return C()})),(0,o._)(e,1,(function(){return(0,_.Csj)()?WordCopilot.RewriteMenuText:"Rewrite selected text..."})),(0,o._)(e,2,(function(){return(0,d.dD)()?(0,_.Csj)()?WordCopilot.ZQMPromptItemSummarize:"Summarize":p()})),(0,o._)(e,0,(function(){return(0,_.Csj)()?WordCopilot.WriteAboutMenuText:"Write about..."})),(0,o._)(e,5,(function(){return(0,_.Csj)()?WordCopilot.ChangeFormatting:"Change..."})),(0,o._)(e,6,(function(){return(0,_.Csj)()&&WordCopilot.PromptGuideMenuItemGenerateImage?WordCopilot.PromptGuideMenuItemGenerateImage:"Generate an image of..."})),(0,o._)(e,7,(function(){return(0,_.Csj)()&&WordCopilot.PromptGuideMenuItemGenerateBanner?WordCopilot.PromptGuideMenuItemGenerateBanner:"Generate a banner for this document"})),(0,o._)(e,8,(function(){return(0,_.Csj)()&&WordCopilot.PromptMenuItemLearnMore?WordCopilot.PromptMenuItemLearnMore:"How can Copilot help?"})),m=e),m}),T=(v={},(0,o._)(v,3,"AskAboutIcon"),(0,o._)(v,4,"AskAboutIcon"),(0,o._)(v,1,"RewriteTextIcon"),(0,o._)(v,2,"SummarizeIcon"),(0,o._)(v,0,"WriteAboutIcon"),(0,o._)(v,5,"ChangeIcon"),(0,o._)(v,6,"GenerateImageIcon"),(0,o._)(v,7,"GenerateImageIcon"),(0,o._)(v,8,"HelpIcon"),E={},(0,o._)(E,3,a.I11),(0,o._)(E,4,a.I11),(0,o._)(E,1,i.rzD),(0,o._)(E,2,s.XRy),(0,o._)(E,0,c.vfO),(0,o._)(E,5,i.pLu),(0,o._)(E,6,l.dG$),(0,o._)(E,7,l.dG$),(0,o._)(E,8,u.XLu),y={},(0,o._)(y,3,a.kNP),(0,o._)(y,4,a.kNP),(0,o._)(y,1,i.ZDY),(0,o._)(y,2,s.tpr),(0,o._)(y,0,c.Dal),(0,o._)(y,5,i.JWF),(0,o._)(y,6,l.$m8),(0,o._)(y,7,l.$m8),(0,o._)(y,8,u.ZrY),function(){return[(0,_.Csj)()?OfficeaicopilotStrings.CreatePodcast:"create podcast",(0,_.Csj)()?OfficeaicopilotStrings.CreatePodcastFromThis:"create podcast from this",(0,_.Csj)()?OfficeaicopilotStrings.CreatePodcastFromThisDoc:"create podcast from this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreatePodcastFromThisFile:"create podcast from this file",(0,_.Csj)()?OfficeaicopilotStrings.CreatePodcastOfThis:"create podcast of this",(0,_.Csj)()?OfficeaicopilotStrings.CreatePodcastOfThisDoc:"create podcast of this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreatePodcastOfThisFile:"create podcast of this file",(0,_.Csj)()?OfficeaicopilotStrings.GeneratePodcast:"generate podcast",(0,_.Csj)()?OfficeaicopilotStrings.GeneratePodcastOfThis:"generate podcast of this",(0,_.Csj)()?OfficeaicopilotStrings.GeneratePodcastOfThisDoc:"generate podcast of this doc",(0,_.Csj)()?OfficeaicopilotStrings.GeneratePodcastOfThisFile:"generate podcast of this file",(0,_.Csj)()?OfficeaicopilotStrings.GeneratePodcastFromThis:"generate podcast from this",(0,_.Csj)()?OfficeaicopilotStrings.GeneratePodcastFromThisDoc:"generate podcast from this doc",(0,_.Csj)()?OfficeaicopilotStrings.GeneratePodcastFromThisFile:"generate podcast from this file",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAPodcastFromThisDocument:"generate a podcast from this document",(0,_.Csj)()?OfficeaicopilotStrings.Podcast:"podcast",(0,_.Csj)()?OfficeaicopilotStrings.TurnDocIntoPodcast:"turn doc into podcast",(0,_.Csj)()?OfficeaicopilotStrings.TurnDocumentToPodcast:"turn document to podcast",(0,_.Csj)()?OfficeaicopilotStrings.MakeThisDocAPodcast:"make this doc a podcast",(0,_.Csj)()?OfficeaicopilotStrings.MakePodcastFromThisDoc:"make podcast from this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreateAPodcastForThisDocument:"create a podcast for this document",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAPodcastForThisDocument:"generate a podcast for this document",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAPodcastForThisDoc:"generate a podcast for this doc",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAPodcastForThisFile:"generate a podcast for this file",(0,_.Csj)()?OfficeaicopilotStrings.CreateAPodcastForThisDoc:"create a podcast for this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreateAPodcastForThisFile:"create a podcast for this file",(0,_.Csj)()?OfficeaicopilotStrings.CreateAnAudioVersionOfThisDocument:"create an audio version of this document",(0,_.Csj)()?OfficeaicopilotStrings.CreateAnAudioVersionOfThisDoc:"create an audio version of this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreateAnAudioVersionOfThisFile:"create an audio version of this file",(0,_.Csj)()?OfficeaicopilotStrings.ProduceAPodcastBasedOnThisDocument:"produce a podcast based on this document",(0,_.Csj)()?OfficeaicopilotStrings.ProduceAPodcastBasedOnThisDoc:"produce a podcast based on this doc",(0,_.Csj)()?OfficeaicopilotStrings.ProduceAPodcastBasedOnThisFile:"produce a podcast based on this file",(0,_.Csj)()?OfficeaicopilotStrings.DevelopAPodcastFromThisDocument:"develop a podcast from this document",(0,_.Csj)()?OfficeaicopilotStrings.DevelopAPodcastFromThisDoc:"develop a podcast from this doc",(0,_.Csj)()?OfficeaicopilotStrings.DevelopAPodcastFromThisFile:"develop a podcast from this file",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisDocumentIntoAPodcast:"convert this document into a podcast",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisDocIntoAPodcast:"convert this doc into a podcast",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisFileIntoAPodcast:"convert this file into a podcast",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisDocumentToAPodcast:"convert this document to a podcast",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisDocToAPodcast:"convert this doc to a podcast",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisFileToAPodcast:"convert this file to a podcast",(0,_.Csj)()?OfficeaicopilotStrings.TurnThisDocumentIntoAPodcast:"turn this document into a podcast",(0,_.Csj)()?OfficeaicopilotStrings.MakeAPodcastOutOfThisDocument:"make a podcast out of this document",(0,_.Csj)()?OfficeaicopilotStrings.MakeAPodcastOutOfThisDoc:"make a podcast out of this doc",(0,_.Csj)()?OfficeaicopilotStrings.MakeAPodcastOutOfThisFile:"make a podcast out of this file",(0,_.Csj)()?OfficeaicopilotStrings.CanYouDoAPodcastForThisDocument:"can you do a podcast for this document?",(0,_.Csj)()?OfficeaicopilotStrings.CanYouDoAPodcastForThisDoc:"can you do a podcast for this doc?",(0,_.Csj)()?OfficeaicopilotStrings.CanYouDoAPodcastForThisFile:"can you do a podcast for this file?",(0,_.Csj)()?OfficeaicopilotStrings.TransformThisDocumentIntoAPodcast:"transform this document into a podcast",(0,_.Csj)()?OfficeaicopilotStrings.TransformThisDocIntoAPodcast:"transform this doc into a podcast",(0,_.Csj)()?OfficeaicopilotStrings.TransformThisFileIntoAPodcast:"transform this file into a podcast",(0,_.Csj)()?OfficeaicopilotStrings.PleaseCreateAPodcastUsingThisDocument:"please create a podcast using this document",(0,_.Csj)()?OfficeaicopilotStrings.PleaseCreateAPodcastUsingThisDoc:"please create a podcast using this doc",(0,_.Csj)()?OfficeaicopilotStrings.PleaseCreateAPodcastUsingThisFile:"please create a podcast using this file",(0,_.Csj)()?OfficeaicopilotStrings.UseThisDocumentToGenerateAPodcast:"use this document to generate a podcast",(0,_.Csj)()?OfficeaicopilotStrings.UseThisDocToGenerateAPodcast:"use this doc to generate a podcast",(0,_.Csj)()?OfficeaicopilotStrings.UseThisFileToGenerateAPodcast:"use this file to generate a podcast",(0,_.Csj)()?OfficeaicopilotStrings.MakeAnAudioPodcastFromThisText:"make an audio podcast from this text",(0,_.Csj)()?OfficeaicopilotStrings.CreateAudioOverview:"create audio overview",(0,_.Csj)()?OfficeaicopilotStrings.CreateAudioOverviewFromThis:"create audio overview from this",(0,_.Csj)()?OfficeaicopilotStrings.CreateAudioOverviewFromThisDoc:"create audio overview from this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreateAudioOverviewFromThisFile:"create audio overview from this file",(0,_.Csj)()?OfficeaicopilotStrings.CreateAudioOverviewOfThis:"create audio overview of this",(0,_.Csj)()?OfficeaicopilotStrings.CreateAudioOverviewOfThisDoc:"create audio overview of this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreateAudioOverviewOfThisFile:"create audio overview of this file",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAudioOverview:"generate audio overview",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAudioOverviewOfThis:"generate audio overview of this",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAudioOverviewOfThisDoc:"generate audio overview of this doc",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAudioOverviewOfThisFile:"generate audio overview of this file",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAudioOverviewFromThis:"generate audio overview from this",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAudioOverviewFromThisDoc:"generate audio overview from this doc",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAudioOverviewFromThisFile:"generate audio overview from this file",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAnAudioOverviewFromThisDocument:"generate an audio overview from this document",(0,_.Csj)()?OfficeaicopilotStrings.AudioOverview:"audio overview",(0,_.Csj)()?OfficeaicopilotStrings.TurnDocIntoAudioOverview:"turn doc into audio overview",(0,_.Csj)()?OfficeaicopilotStrings.TurnDocumentToAudioOverview:"turn document to audio overview",(0,_.Csj)()?OfficeaicopilotStrings.MakeThisDocAnAudioOverview:"make this doc an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.MakeAudioOverviewFromThisDoc:"make audio overview from this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreateAnAudioOverviewForThisDocument:"create an audio overview for this document",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAnAudioOverviewForThisDocument:"generate an audio overview for this document",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAnAudioOverviewForThisDoc:"generate an audio overview for this doc",(0,_.Csj)()?OfficeaicopilotStrings.GenerateAnAudioOverviewForThisFile:"generate an audio overview for this file",(0,_.Csj)()?OfficeaicopilotStrings.CreateAnAudioOverviewForThisDoc:"create an audio overview for this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreateAnAudioOverviewForThisFile:"create an audio overview for this file",(0,_.Csj)()?OfficeaicopilotStrings.CreateAnAudioVersionOfThisDocument:"create an audio version of this document",(0,_.Csj)()?OfficeaicopilotStrings.CreateAnAudioVersionOfThisDoc:"create an audio version of this doc",(0,_.Csj)()?OfficeaicopilotStrings.CreateAnAudioVersionOfThisFile:"create an audio version of this file",(0,_.Csj)()?OfficeaicopilotStrings.ProduceAnAudioOverviewBasedOnThisDocument:"produce an audio overview based on this document",(0,_.Csj)()?OfficeaicopilotStrings.ProduceAnAudioOverviewBasedOnThisDoc:"produce an audio overview based on this doc",(0,_.Csj)()?OfficeaicopilotStrings.ProduceAnAudioOverviewBasedOnThisFile:"produce an audio overview based on this file",(0,_.Csj)()?OfficeaicopilotStrings.DevelopAnAudioOverviewFromThisDocument:"develop an audio overview from this document",(0,_.Csj)()?OfficeaicopilotStrings.DevelopAnAudioOverviewFromThisDoc:"develop an audio overview from this doc",(0,_.Csj)()?OfficeaicopilotStrings.DevelopAnAudioOverviewFromThisFile:"develop an audio overview from this file",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisDocumentIntoAnAudioOverview:"convert this document into an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisDocIntoAnAudioOverview:"convert this doc into an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisFileIntoAnAudioOverview:"convert this file into an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisDocumentToAnAudioOverview:"convert this document to an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisDocToAnAudioOverview:"convert this doc to an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.ConvertThisFileToAnAudioOverview:"convert this file to an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.TurnThisDocumentIntoAnAudioOverview:"turn this document into an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.MakeAnAudioOverviewOutOfThisDocument:"make an audio overview out of this document",(0,_.Csj)()?OfficeaicopilotStrings.MakeAnAudioOverviewOutOfThisDoc:"make an audio overview out of this doc",(0,_.Csj)()?OfficeaicopilotStrings.MakeAnAudioOverviewOutOfThisFile:"make an audio overview out of this file",(0,_.Csj)()?OfficeaicopilotStrings.CanYouDoAnAudioOverviewForThisDocument:"can you do an audio overview for this document?",(0,_.Csj)()?OfficeaicopilotStrings.CanYouDoAnAudioOverviewForThisDoc:"can you do an audio overview for this doc?",(0,_.Csj)()?OfficeaicopilotStrings.CanYouDoAnAudioOverviewForThisFile:"can you do an audio overview for this file?",(0,_.Csj)()?OfficeaicopilotStrings.TransformThisDocumentIntoAnAudioOverview:"transform this document into an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.TransformThisDocIntoAnAudioOverview:"transform this doc into an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.TransformThisFileIntoAnAudioOverview:"transform this file into an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.PleaseCreateAnAudioOverviewUsingThisDocument:"please create an audio overview using this document",(0,_.Csj)()?OfficeaicopilotStrings.PleaseCreateAnAudioOverviewUsingThisDoc:"please create an audio overview using this doc",(0,_.Csj)()?OfficeaicopilotStrings.PleaseCreateAnAudioOverviewUsingThisFile:"please create an audio overview using this file",(0,_.Csj)()?OfficeaicopilotStrings.UseThisDocumentToGenerateAnAudioOverview:"use this document to generate an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.UseThisDocToGenerateAnAudioOverview:"use this doc to generate an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.UseThisFileToGenerateAnAudioOverview:"use this file to generate an audio overview",(0,_.Csj)()?OfficeaicopilotStrings.MakeAnAudioAudioOverviewFromThisText:"make an audio overview from this text",(0,_.Csj)()?OfficeaicopilotStrings.GeneratePodcastWithUpdatedSettings:"generate an audio overview with the updated settings",(0,_.Csj)()?WordCopilot.CreatePodcastZQMTitleText:"Generate an audio overview from this document"]})},241273:(e,t,n)=>{"use strict";var r,o,a,i,s,c,l,u,d,_,p,g,f,h,C;n.d(t,{$m:()=>c,At:()=>f,Gm:()=>i,OZ:()=>u,T7:()=>C,Th:()=>h,YY:()=>d,eB:()=>l,lL:()=>p,ut:()=>r,yx:()=>a,zg:()=>_}),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(r||(r={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(o||(o={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(a||(a={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(i||(i={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(s||(s={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(c||(c={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(l||(l={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}(u||(u={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(d||(d={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(_||(_={})),function(e){e.Image="IMAGE",e.Video="VIDEO"}(p||(p={})),function(e){e.KeepIt="KeepIt",e.Undo="Undo",e.Insert="Insert",e.Copy="Copy",e.Custom="Custom",e.CustomiPad="CustomiPad",e.None="None"}(g||(g={})),function(e){e.Activated="Activated",e.Removed="Removed",e.ActivateCopilotAgent="activateCopilotAgent",e.RemoveCopilotAgent="removeCopilotAgent"}(f||(f={})),function(e){e.BizchatHostContextUpdate="BizChatHostContextUpdate"}(h||(h={})),function(e){e[e.LaunchMos=2001]="LaunchMos",e[e.GetFullDocumentHtml=2003]="GetFullDocumentHtml",e[e.InvokeCanvasTool=2004]="InvokeCanvasTool",e[e.ReadAloud=2005]="ReadAloud"}(C||(C={}))},242154:(e,t,n)=>{"use strict";n.d(t,{Dm:()=>$,EO:()=>S,IS:()=>q,OK:()=>U,R3:()=>P,SA:()=>O,Ui:()=>te,X9:()=>B,Xo:()=>H,Xx:()=>w,Y0:()=>j,_W:()=>K,b6:()=>N,bq:()=>D,cY:()=>L,gY:()=>F,h:()=>T,h7:()=>Y,iM:()=>b,k7:()=>I,kX:()=>W,qS:()=>z,rw:()=>k,uA:()=>G,uB:()=>ee,wV:()=>Q,xI:()=>x,zU:()=>A,zy:()=>Z});var r=n(743032),o=n(928499),a=n(379490),i=n(656904),s=n(932554),c=n(8810),l=n(140889),u=n(57541),d=n(956775),_=n(602061),p=n(769),g=n(740389),f=(n(208520),n(448397)),h=n(192318),C=n(61714),m=n(934761),v=n(556165),E=n(758651),y=(0,C.A)(),b=function(){return h.PF},T=function(){return(0,i.Csj)()?WordCopilot.CommandingSucess:"Done. Anything else I can do?"},I=function(){return(0,i.Csj)()?WordCopilot.CommandingPartialSucess:"I wasn't able to do everything you asked for. Try rephrasing, or ask me something else"},P=function(e){for(var t,n=e.length;0!=n;){var r;t=Math.floor(Math.random()*n),n--,r=[e[t],e[n]],e[n]=r[0],e[t]=r[1]}return e},A=function(e,t,n){var r=[],o=-1;for(P(e);r.length<t&&o<e.length;)o++,r.find((function(t){return t===e[o%e.length]}))||n.find((function(t){return t===e[o%e.length]}))||r.push(e[o%e.length]);return r},D=function(e,t,n){var r,o=function(n){return t.find((function(t){return t===e[n%e.length]}))?"continue":(r=e[n%e.length],L("Updated pill is ".concat(r)),"break")},a=[];P(e);for(var i=0;i<e.length;i++){if("break"===o(i))break}for(var s=0;s<t.length;s++)t[s]!=n?a.push(t[s]):r&&(L("Updating ".concat(n," with ").concat(r)),a.push(r));return a};function S(){return M.apply(this,arguments)}function M(){return(M=(0,r._)((function(){var e;return(0,a.__generator)(this,(function(t){return e=f.B.getInstance(),[2,new Promise((function(t,n){try{Office.context.auth.getAuthContextAsync((function(r){if("succeeded"===r.status){var o=r.value;if(o){var a=o.tenantId;L("Fetched tenant id for Safelinks successfully"),t(a)}else{var i="AuthContext is undefined";L(i),e.sendErrorTelemetry([{key:l.IC.ErrorCategory,value:c.S.Safelinks},{key:l.IC.ErrorMessage,value:i}]),n(new Error(i))}}else{var s="Failed to fetch tenant ID. Status: ".concat(r.status);L(s),e.sendErrorTelemetry([{key:l.IC.ErrorCategory,value:c.S.Safelinks},{key:l.IC.ErrorMessage,value:s}]),n(new Error(s))}}))}catch(t){var r="Error getting tenant ID: ".concat(t);L(r),e.sendErrorTelemetry([{key:l.IC.ErrorCategory,value:c.S.Safelinks},{key:l.IC.ErrorMessage,value:r}]),n(t)}}))]}))}))).apply(this,arguments)}var O,k=function(e){e&&e(P(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Object.values((0,p.m5)()):Object.values((0,i.Bhx)())))};function L(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(w()){var a="info";e&&Object.values(O).includes(e)?a=e:e&&n.unshift(e);var i="Word Copilot Chat";switch(a){case"verbose":var s;(s=E).debug.apply(s,["".concat(i)].concat((0,o._)(n)));break;case"warning":var c;(c=E).warn.apply(c,["".concat(i)].concat((0,o._)(n)));break;case"error":var l;(l=E).error.apply(l,["".concat(i)].concat((0,o._)(n)));break;default:var u;(u=E).log.apply(u,["".concat(i,":")].concat((0,o._)(n)))}}}function w(){return i.MYv||(0,g.snA)("showDebugLogs",!1)}!function(e){e.Verbose="verbose",e.Info="info",e.Warning="warning",e.Error="error"}(O||(O={}));var R,U=function(){return Office.context.platform===Office.PlatformType.iOS||Office.context.platform===Office.PlatformType.Mac},B=(R=(0,r._)((function(e,t){var n,r,o,i,s;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,6,,7]),t?[3,2]:[4,fetch(e,{cache:"no-cache"})];case 1:return r=a.sent(),[3,4];case 2:return[4,(0,_.zRu)(v.gf,e,t,{cache:"no-cache"})];case 3:r=a.sent(),a.label=4;case 4:if(!(n=r)||n&&!n.ok)throw L("".concat(o="toDataUrl: Could not fetch image"," at ").concat(e)),new Error(o);return L("Trying to fetch image from URL..."),[4,n.blob()];case 5:return i=a.sent(),[2,new Promise((function(e,t){var n=new FileReader;n.onloadend=function(){return e(n.result.toString())},n.onerror=function(){return t()},n.readAsDataURL(i)}))];case 6:throw a.sent(),L("Failed to fetch image from URL"),L("".concat(s="toDataUrl: Could not get base64 encoding of image"," at ").concat(e)),new Error(s);case 7:return[2]}}))})),function(e,t){return R.apply(this,arguments)}),x=(function(){var e=(0,r._)((function(e){return(0,a.__generator)(this,(function(t){return[2,new Promise((function(t,n){var r=new Image;r.onload=function(){t({height:r.height,width:r.width})},r.onerror=function(){n("Could not load image to calculate size")},r.src=e}))]}))}))}(),function(){var e={};return Object.keys(l.CT).forEach((function(t){e[t]=0})),e[l.CT.AugloopSessionGuid]=y,e[l.CT.ChatPPTSessionId]=s.Vv.getSettingAsString(s.zj.ChatWordSessionID),e[l.CT.IsDevBuild]=i.MYv,e}),W=function(e){return e[l.CT.UserQueryGuid]||(e[l.CT.UserQueryGuid]=b()),{eventType:c.S.Latency,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},F=function(e){return e[l.Dh.UserQueryGuid]||(e[l.Dh.UserQueryGuid]=b()),e[l.Dh.ChatPPTSessionId]=s.Vv.getSettingAsString(s.zj.ChatWordSessionID),e[l.Dh.UserQueryOrder]=d.userQueryOrder,{eventType:c.S.OfficeJsOperations,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},N=function(){var e={};return Object.keys(l.Dh).forEach((function(t){e[t]=""})),e},K=function(e){return e[l.h3.UserQueryGuid]||(e[l.h3.UserQueryGuid]=b()),{eventType:c.S.ChatEvents,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},H=function(e){return e[l.S9.UserQueryGuid]||(e[l.S9.UserQueryGuid]=b()),{eventType:c.S.Commanding,eventData:Object.keys(e).map((function(t){return{key:t,value:e[t]}}))}},G=function(){var e={};return Object.keys(l.h3).forEach((function(t){e[t]=""})),e[l.h3.UserQueryGuid]=b(),e[l.h3.ChatPPTSessionId]=s.Vv.getSettingAsString(s.zj.ChatWordSessionID),e[l.h3.UserQueryOrder]=d.userQueryOrder,e[l.h3.IsDevBuild]=i.MYv,e},Q=function(){var e={};return Object.keys(l.S9).forEach((function(t){e[t]=""})),e[l.S9.UserQueryGuid]=b(),e[l.S9.HostSDXSessionID]=s.Vv.getSettingAsString(s.zj.ChatWordSessionID),e};var j=function(e){return Object.values((0,i.Bhx)()).includes(e)},Y=function(e){return Object.keys((0,i.Bhx)()).find((function(t){return(0,i.Bhx)()[t]===e}))||""},z=function(e){var t=e.trim();return t=t.replace(/[\u200B-\u200D\uFEFF]/g,""),(0,i.x0y)().test(t)?i.Aec.GiveMeAnOverview:new RegExp("^("+Object.values((0,i.Bhx)()).join("|")+")$","i").test(t)?(0,g.n7p)()?i.Aec.EnhanceOverview:i.Aec.GiveMeAnOverview:(0,g.GK3)()&&i.g47.test(e)?i.Aec.ContentCreation:(0,g.aIk)()&&i.vrM.test(e)?i.Aec.TransformDocument:i.Aec.Default},q=function(){var e=(0,r._)((function(e,t,n){var r,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:L("Inserting image in canvas"),r=(new Date).getTime(),n.push({key:l.CT.ImageInsertionTime,value:(0,_.WUi)(r)},{key:l.CT.FeatureName,value:l.CC.AddContent}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Z(e,0,t,u.w.Selection)];case 2:return a.sent(),f.B.getInstance().sendLatencyTelemetry((0,o._)(n).concat([{key:l.CT.IsImageInsertionSuccess,value:!0}]),!0),[3,4];case 3:throw i=a.sent(),f.B.getInstance().sendLatencyTelemetry((0,o._)(n).concat([{key:l.CT.IsImageInsertionSuccess,value:!1}]),!0),L("Error: ".concat(i.message," at StackTrace ").concat(i.stack)),i;case 4:return[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),V=function(e){switch(e){case u.w.Selection:return Word.InsertLocation.after;case u.w.Bottom:return Word.InsertLocation.end;case u.w.Top:default:return Word.InsertLocation.start}},Z=function(){var e=(0,r._)((function(e,t,n,o){var i;return(0,a.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,7]),[4,Word.run(function(){var t=(0,r._)((function(t){var r,i;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return r=o===u.w.Selection?t.document.getSelection():t.document.body.getRange("Whole"),(0,g.stn)()?r.insertHtml('<img src="'.concat(e,'" alt="').concat(n,'" />'),V(o)):(i=r.insertInlinePictureFromBase64(e.split(",")[1],V(o)),n&&(i.altTextDescription=n)),[4,t.sync()];case 1:return a.sent(),[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return s.sent(),L("Image inserted successfully"),[3,7];case 2:return i=s.sent(),t+1<=3?(L("Image insertion failed. Retrying..."),[4,X(t+1)]):[3,5];case 3:return s.sent(),[4,Z(e,t+1,n)];case 4:return s.sent(),[3,6];case 5:throw L("Failed to insert image"),i;case 6:return[3,7];case 7:return[2]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),J=function(){var e=(0,r._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(t){return setTimeout(t,e)}))];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=(0,r._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,J(500*e)];case 1:return t.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),$=function(e){m.P.getInstance().removeContextId(e)},ee=function(){m.P.getInstance().removeContextId(b())},te=function(){return s.Vv.getSettingAsString(s.zj.CopilotLicenseStatus)===i.RE3.MultiAccessDisabledByAdmin}},244120:(e,t,n)=>{"use strict";n.d(t,{T:()=>u});var r=n(63461),o=n(28515),a=n(784567),i=n(265167),s=n(260197),c=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},l=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},u=function(){function e(e){this.HandoffOperations=e,this.sentQueryIds=new Set}return e.prototype.sendHandoffInternalMessage=function(e){try{var t=this.getHandoffInternalMessageSignal(e);this.sentQueryIds.add(t.queryId);var n=new a.Xr({parentPath:["session","doc"],items:[{id:i.r.generateId(),body:t}]});this.handoffInternalMessageSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(t.H_.T_,{operation:n,workflowAnnotationType:r.kp.getTypeName()})}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffInternalMessage signal. "+e.message),e}},e.prototype.handleHandoffOutboundMessage=function(e,t){return c(this,void 0,void 0,(function(){var n,a,i,c;return l(this,(function(l){switch(l.label){case 0:if(l.trys.push([0,6,,7]),!e.body||!r.kp.typeGuard(e.body))throw new Error("Service response not of type HandoffOutboundMessage");return(n=e.body).queryId&&this.sentQueryIds.has(n.queryId)?(this.sentQueryIds.delete(n.queryId),this.HandoffOperations.onAnnotationReceived(r.kp.getTypeName(),n,this.handoffInternalMessageSubmitTime,t),n.error?(this.HandoffOperations.onError(s.Fc.OutboundMessageResponse,n.error),[3,5]):[3,1]):[2];case 1:return n.message?[3,2]:(this.HandoffOperations.onError(s.Fc.NoResponse),[3,5]);case 2:return n.generatedLinks&&n.generatedLinks.length>0&&n.id?[4,this.renderGeneratedHandoffLinks(n)]:[3,4];case 3:if(l.sent(),n.destinationApp&&n.scenarioName)switch(n.scenarioName){case o.Cu.OPEN:this.HandoffOperations.renderBookending(null!==(i=n.sourceApp)&&void 0!==i?i:o.Ww.NONE,n.destinationApp,"Opening","Opened");break;case o.Cu.NEW:case o.Cu.GENERATE:this.HandoffOperations.renderBookending(null!==(c=n.sourceApp)&&void 0!==c?c:o.Ww.NONE,n.destinationApp,"Opening","Created")}return[3,5];case 4:this.HandoffOperations.onError(s.Fc.NoGeneratedLinks),l.label=5;case 5:return[3,7];case 6:throw a=l.sent(),this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffOutboundMessage. "+a.message),a;case 7:return[2]}}))}))},e}()},244157:(e,t,n)=>{"use strict";n.d(t,{Cf:()=>a,Gj:()=>o,P7:()=>r});var r,o=260;!function(e){e.newDocument="newDocument",e.existingDocument="existingDocument",e.Unknown="Unknown"}(r||(r={}));var a=2},244368:(e,t,n)=>{"use strict";var r,o;n.d(t,{S:()=>r,m:()=>o}),function(e){e.IsCustomGPTsEnabled="IsCustomGPTsEnabled",e.IsAgentDiscoverabilityZQMEnabled="IsAgentDiscoverabilityZQMEnabled",e.IsClickButtonStyleHamburgerEnabled="IsClickButtonStyleHamburgerEnabled",e.ShowAgentMenuNudgeAndTooltip="ShowAgentMenuNudgeAndTooltip",e.ShowAgentMenuExploreBadge="ShowAgentMenuExploreBadge",e.EnableUniqueDateCheckForStoreCardZQPrompt="EnableUniqueDateCheckForStoreCardZQPrompt",e.EnableInsightsCardAgents="EnableInsightsCardAgents",e.ShowAtMentionMenuZQPrompt="ShowAtMentionMenuZQPrompt"}(r||(r={})),function(e){e.EnableSystemMessageActions="EnableSystemMessageActions",e.IsInsertImageEnabledForDAs="IsInsertImageEnabledForDAs",e.DisableACHorizontalScroll="DisableACHorizontalScroll",e.DisableFooterActionsForAdaptiveCard="DisableFooterActionsForAdaptiveCard",e.EnableDynamicHostWidthForAC="EnableDynamicHostWidthForAC",e.EnableNewRegexForVCPromptExtraction="EnableNewRegexForVCPromptExtraction",e.ShowStoreLauncherZQPrompt="ShowStoreLauncherZQPrompt",e.ShowVisualCreatorZQPrompt="ShowVisualCreatorZQPrompt",e.EnableAgentSwitchInCatalyst="EnableAgentSwitchInCatalyst"}(o||(o={}))},249002:(e,t,n)=>{"use strict";n.d(t,{$C:()=>ue,$i:()=>W,CP:()=>ae,Dt:()=>re,E:()=>G,EJ:()=>q,El:()=>Ce,JT:()=>x,MK:()=>Z,Mo:()=>J,QV:()=>j,RH:()=>z,UF:()=>ye,Y1:()=>V,ZN:()=>_e,_L:()=>X,a1:()=>ve,c5:()=>de,cC:()=>ge,dD:()=>K,eN:()=>se,gZ:()=>ce,hX:()=>B,iW:()=>N,jG:()=>fe,jM:()=>be,jQ:()=>H,jx:()=>he,lS:()=>oe,lt:()=>me,nP:()=>F,oX:()=>pe,oZ:()=>Q,sC:()=>Ee,uk:()=>U,y9:()=>ie,zS:()=>Te});var r=n(743032),o=n(990813),a=n(379490),i=n(932554),s=n(656904),c=n(448397),l=n(231006),u=n(140889),d=n(720971),_=n(862853),p=n(648448),g=n(740389),f=n(86511),h=n(555799),C=n(309964),m=n(598309),v=n(407039),E=n(992950),y=n(499011),b=n(63461),T=n(385659),I=n(403162),P=n(45512),A=n(111246),D=n(242154),S=n(602061),M=n(217762),O=n(769449),k=n(208276),L=n(889899),w=n(983111),R=n(404630);function U(e){return new Promise((function(t,n){setTimeout((function(){t()}),e)}))}function B(e){return null==e}function x(e,t){return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}var W=function(){return i.Vv.IsSettingTrue(i.zj.IsCopilotContentGenerationDisabledByAdminControl)},F=function(){return i.Vv.IsSettingTrue(i.zj.InAppHelpCshEnabled)},N=function(){return i.Vv.getSettingAsString(i.zj.PrePopulatedPrompt)};function K(){var e,t,n,r;return(null===(t=Office)||void 0===t||null===(e=t.context)||void 0===e?void 0:e.platform)===(null===(r=Office)||void 0===r||null===(n=r.PlatformType)||void 0===n?void 0:n.iOS)}var H=function(e){var t={name:e.name,size:e.size,color:e.color};return e.bold&&(t.bold=e.bold),e.italic&&(t.italic=e.italic),e.underline!==Word.UnderlineType.none&&(t.underline=e.underline),e.highlightColor&&(t.highlightColor=e.highlightColor),e.strikeThrough&&(t.strikeThrough=e.strikeThrough),e.subscript&&(t.subscript=e.subscript),e.superscript&&(t.superscript=e.superscript),t};function G(e){var t=c.B.getInstance(),n=Y(e);t.logSeenEvent(n.capability,n.featureName,n.verb,n.subFeature)}var Q=function(e,t){var n=(0,p.Y)(t).find((function(t){return t.text===e}));n&&n.children&&n.children.forEach((function(e){var t=Y(e.text);c.B.getInstance().logSeenEvent(t.capability,t.featureName,t.verb,t.subFeature)}))},j=function(){return window.location.href.split("/")[4]};function Y(e){switch(e){case s.UeP.summarize():case(0,l.kO)()[l.M9.SUMMARIZE_DOC]():return{capability:f.rf.QAandSummaries,featureName:u.CC.Summary,verb:f.RX.Summarize,subFeature:u.nk.DocumentSummary};case(0,l.kO)()[l.M9.ASK_A_QUESTION]():case s.UeP.tellMeMore():case s.UeP.listProsAndCons():case s.UeP.impDeadlines():case s.UeP.showStakeHolders():case s.UeP.howToImproveDocument():case s.UeP.howToAddTable():case s.UeP.descTimeMgmt():return{capability:f.rf.QAandSummaries,featureName:u.CC.ChatQnA,verb:f.RX.Ask};case(0,l.kO)()[l.M9.WRITE_ABOUT]():case(0,l.kO)()[l.M9.REWRITE_TEXT]():case s.UeP.addAParagraph():case s.UeP.createDraftAbout():case s.UeP.createHighLevelOverview():case s.UeP.createProject():case s.UeP.writeIntroParagraph():return(0,g.IeB)()?{capability:f.rf.ContentGeneration,featureName:u.CC.Draft,verb:f.RX.Create,subFeature:u.nk.ContentCreation}:{capability:f.rf.QAandSummaries,featureName:u.CC.ChatQnA,verb:f.RX.Ask};case(0,l.kO)()[l.M9.CHANGE]():case s.UeP.addComment():case s.UeP.changeFont():case s.UeP.highlightAny():case s.UeP.highlightText():case s.UeP.addATable():return{capability:f.rf.Commanding,featureName:u.CC.Commanding,verb:f.RX.Command,subFeature:u.nk.BasicCommands};case s.UeP.generateBanner():case s.UeP.generateImage():return{capability:f.rf.ContentGeneration,featureName:u.CC.AddContent,verb:f.RX.Create,subFeature:u.nk.AddDesignerImage};case s.UeP.createMyCopilotProfile():case s.UeP.whatCanCopilotProfileDo():return{featureName:u.CC.Customize,subFeature:u.nk.Customize};default:return{featureName:u.CC.CopilotChat}}}function z(e,t){if(!e)return{featureName:u.CC.CopilotChat};switch(e){case u.CC.Summary:return{capability:f.rf.QAandSummaries,featureName:u.CC.Summary,verb:f.RX.Summarize,subFeature:u.nk.DocumentSummary};case u.CC.ChatQnA:return{capability:f.rf.QAandSummaries,featureName:u.CC.ChatQnA,verb:f.RX.Ask};case u.CC.DocumentQnA:return{capability:f.rf.QAandSummaries,featureName:u.CC.DocumentQnA,verb:f.RX.Ask};case u.CC.Draft:return{capability:f.rf.ContentGeneration,featureName:u.CC.Draft,verb:f.RX.Create,subFeature:u.nk.ContentCreation};case u.CC.Commanding:return{capability:f.rf.Commanding,featureName:u.CC.Commanding,verb:f.RX.Command};case u.CC.DesignerVisuals:return{capability:f.rf.ContentGeneration,featureName:u.CC.DesignerVisuals,verb:f.RX.Create,subFeature:u.nk.AddDesignerImage};case u.CC.AddContent:return{capability:f.rf.ContentGeneration,featureName:u.CC.AddContent,verb:f.RX.Create,subFeature:t||u.nk.ContentCreation};default:return{featureName:u.CC.CopilotChat}}}function q(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null==e?void 0:e.contentOrigin;if(!n||!n.length)return{featureName:u.CC.CopilotChat};var r=n.toLowerCase();switch(r){case y.w.APOLOGY:case y.w.DEEPLEO_SYDNEY:case y.w.BASIC_CHAT:case y.w.TABLE_CHAT:return z(u.CC.ChatQnA);case y.w.SELF_HELP:return{capability:f.rf.QAandSummaries,featureName:u.CC.ChatQnA,verb:f.RX.Ask,subFeature:u.nk.SelfHelpSearch};case y.w.CANNED_RESPONSE:return{capability:f.rf.QAandSummaries,featureName:u.CC.ChatQnA,verb:f.RX.Ask,subFeature:u.nk.CannedResponse};case y.w.DESIGNER_INSERT_GRAPHIC:return{capability:f.rf.ContentGeneration,featureName:u.CC.DesignerVisuals,verb:f.RX.Create,subFeature:u.nk.AddDesignerImage};case y.w.CONTENT_CREATION:return z(u.CC.AddContent);case y.w.SUMMARIZE:case y.w.WORD_SUMMARIZE:case y.w.SUMMARIZE_SINGLE_SHOT:return z(u.CC.Summary);case y.w.EDIT_DOCUMENT:return z(u.CC.Commanding);case y.w.SEARCH_DOC:return z(u.CC.DocumentQnA);case y.w.PERSONALIZATION_END:case y.w.PERSONALIZATION_START:case y.w.PERSONALIZATION_EXPLAIN:case y.w.PERSONALIZATION_UPDATE:case y.w.PERSONALIZATION_FORCED_DELETE:return{featureName:u.CC.Customize,subFeature:u.nk.Customize};case y.w.IMAGE_CHAT:return{capability:f.rf.ContentGeneration,featureName:u.CC.ChatQnA,verb:f.RX.Create,subFeature:u.nk.ImageChat}}return t&&c.B.getInstance().sendChatEventTelemetry([{key:u.h3.ChatEventType,value:u.a5.ContentOriginUnknown},{key:u.h3.ChatEventParameters,value:r}]),{featureName:u.CC.CopilotChat}}function V(){return v.s.getInstance().getSkillName()===E.B.Summary}function Z(e){var t=null==e?void 0:e.contentOrigin;if(v.s.getInstance().getSkillName()===E.B.Unset&&t&&t.length)switch(t.toLowerCase()){case y.w.APOLOGY:case y.w.CANNED_RESPONSE:case y.w.DEEPLEO_SYDNEY:return void v.s.getInstance().setSkillName(E.B.Sydney);case y.w.BASIC_CHAT:return void v.s.getInstance().setSkillName(E.B.BasicChat);case y.w.DESIGNER_INSERT_GRAPHIC:return void v.s.getInstance().setSkillName(E.B.Designer);case y.w.CONTENT_CREATION:return void v.s.getInstance().setSkillName(E.B.ContentCreation);case y.w.SUMMARIZE:case y.w.WORD_SUMMARIZE:case y.w.SUMMARIZE_SINGLE_SHOT:return void v.s.getInstance().setSkillName(E.B.Summary);case y.w.EDIT_DOCUMENT:return void v.s.getInstance().setSkillName(E.B.Commanding);case y.w.SELF_HELP:return void v.s.getInstance().setSkillName(E.B.SelfHelp);case y.w.SEARCH_DOC:return void v.s.getInstance().setSkillName(E.B.SearchDocument);case y.w.TABLE_CHAT:return void v.s.getInstance().setSkillName(E.B.TableChat);case y.w.INVOKE_HANDOFF:return void v.s.getInstance().setSkillName(E.B.HandOff)}}function J(e){return{webGroundingEnabled:!(null==e?void 0:e.some((function(e){return e.id===s.AF5}),!1))&&(0,m.vI)()&&(0,_.gc)(),docGroundingDisabled:!1,enterpriseGroundingEnabled:(0,_.pX)(),requireExplicitPlugins:(0,m.vI)(),searchOnlyMode:!1,pluginInfo:null!=e?e:[]}}function X(e){if((0,g.WFw)()){var t=I.p.getInstance().getDocumentHandoffMessageId();switch(e){case b.dF.getTypeName():P.m.getInstance().sendHandoffDocUrlSignal();break;case b.uC.getTypeName():I.p.getInstance().sendHandoffMessageId(T.Q.GET,t)}}}var $=[{trigger:"Every Wednesday at 8 am scan my inbox for SAP invoices add the main fields to a new Excel spreadsheet",followupQuestions:["It seems that directly scanning for SAP invoices and extracting fields is not fully supported at this time. However, we can search enterprise emails, get SAP invoices from a date range, and create an Excel spreadsheet with this information. Would you like to proceed with this plan?","Could you specify the search term for finding SAP invoices in your inbox? Some options could include 'SAP invoice', 'SAP bill', or 'SAP transaction'. Please choose one or provide a specific term.","To retrieve SAP invoices, could you please provide the start date and end date for the date range? For example, you could provide the current week (e.g., start_date: YYYY-MM-DD, end_date: YYYY-MM-DD) or specify a different period."],finalCard:[{title:"Get SAP invoices for a given date range",icon:"",taskProperties:[{name:"Start Date",value:"",type:"Date"},{name:"End Date",value:"",type:"Date"}]},{title:"Create an Excel spreadsheet with a given topic or from some existing content",icon:"Excel",taskProperties:[{name:"Request from user",value:"Create a spreadsheet with SAP invoices data",type:"String"}]}]},{trigger:"Review my inbox for team meeting appropriate updates and create a deck for my staff meeting. Repeat this every Tuesday at 6 pm",followupQuestions:["It looks like we can't automatically link the reviewed email updates to create the presentation deck. However, we can perform the tasks separately: review the inbox for updates, create a presentation deck, and schedule these tasks to repeat every Tuesday at 6 PM. Would you like to proceed with this plan?","Could you please provide the search keywords for reviewing the inbox for team meeting updates? Additionally, how many slides would you like in the presentation deck for your staff meeting? Lastly, can you confirm the interval for scheduling these tasks is every Tuesday at 6 PM?","Thank you for providing the search keywords 'Updates about the agent project'. Could you also let me know how many slides you would like in the presentation deck for your staff meeting? Additionally, can you confirm that you would like these tasks to be scheduled every Tuesday at 6 PM?","Thank you for providing the number of slides as 10. Can you confirm that you would like these tasks to be scheduled every Tuesday at 6 PM?"],finalCard:[{title:"Search for emails in the work account's inbox based on a query",icon:"Mail",taskProperties:[{name:"The search query",value:"Updates about the work my team is doing",type:"String"}]},{title:"Create a PowerPoint presentation",icon:"PowerPoint",taskProperties:[{name:"Query from user containing the presentation creation request",value:"Staff meeting updates",type:"String"}]}]}],ee=void 0,te=-1;function ne(){ee&&A.$.getInstance().displayResponse({chatCardType:h._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:ee.followupQuestions[te]}}})}function re(e){var t=e.trimEnd().toLowerCase();if(ee)return++te>=ee.followupQuestions.length?(ee&&A.$.getInstance().displayResponse({chatCardType:h._.AgentPlanBuilderCard,chatMessageData:{agentPlanBuilderCardProps:{user:"chat",chatMessage:"Absolutely, please review the following steps",tasks:ee.finalCard,handleStartClicked:function(e){(0,D.cY)("User requested to start plan",JSON.stringify(e))}}}}),ee=void 0):ne(),!0;var n=!0,r=!1,o=void 0;try{for(var a,i=$[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var s=a.value;if(t===s.trigger.toLowerCase())return ee=s,te=0,ne(),!0}}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}return!1}function oe(e){var t="Every Wednesday at 8 am scan my inbox for SAP invoices add the main fields to a new Excel spreadsheet".toLowerCase(),n="Review my inbox for team meeting appropriate updates and create a deck for my staff meeting. Repeat this every Tuesday at 6 pm".toLowerCase();if(e.trimEnd().toLowerCase()===t||e.trimEnd().toLowerCase()===n){return A.$.getInstance().displayResponse({chatCardType:h._.AgentPlanBuilderCard,chatMessageData:{agentPlanBuilderCardProps:{user:"chat",chatMessage:"Absolutely, please review the following steps",tasks:e.trimEnd().toLowerCase()===t?[{title:"Get SAP invoices for a given date range",icon:"",taskProperties:[{name:"Start Date",value:"",type:"Date"},{name:"End Date",value:"",type:"Date"}]},{title:"Create an Excel spreadsheet with a given topic or from some existing content",icon:"Excel",taskProperties:[{name:"Request from user",value:"Create a spreadsheet with SAP invoices data",type:"String"}]}]:[{title:"Search for emails in the work account's inbox based on a query",icon:"Mail",taskProperties:[{name:"The search query",value:"Updates about the work my team is doing",type:"String"}]},{title:"Create a PowerPoint presentation",icon:"PowerPoint",taskProperties:[{name:"Query from user containing the presentation creation request",value:"Staff meeting updates",type:"String"}]}],handleStartClicked:function(e){(0,D.cY)("User requested to start plan",JSON.stringify(e))}}}}),!0}return!1}function ae(e){return"workspace"===e||"research"===e}function ie(e){return(0,D.cY)("shouldCreatePodcast",e),(0,l.tJ)().some((function(t){return e.toLowerCase()===t.toLowerCase()}))}function se(e){return(0,D.cY)("shouldCreatePodcast",e),!!e.includes("create")}function ce(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}var le,ue=(le=(0,r._)((function(){return(0,a.__generator)(this,(function(e){return[2,new Promise((function(e,t){Word.run((function(n){return n.document.body.load("text"),n.sync().then((function(){e(n.document.body.text)})).catch((function(e){t(JSON.stringify(e.debugInfo))}))}))}))]}))})),function(){return le.apply(this,arguments)});function de(e,t,n,r){return(!(0,g.n7p)()||r!==s.Aec.EnhanceOverview)&&(n&&!(0,S.y8L)(e,t))}function _e(){var e=(0,g.Xrt)().replace(/@/g,":").replace(/\^/g,",");return(0,D.cY)("transformedVoiceIds: ",e),e.length>0?e.split(",").map((function(e){return e.trim()})):["en-US-Andrew2:DragonHDLatestNeural","en-US-Ava:DragonHDLatestNeural"]}function pe(){var e=(0,g.EIr)().replace(/\^/g,",");return(0,D.cY)("transformedSpeakerNames: ",e),e.length>0?e.split(",").map((function(e){return e.trim()})):["Andrew","Emma"]}function ge(){var e=[M.rS.Audio],t=(0,g.$pQ)().replace(/\^/g,",");return(0,D.cY)("transformedOutputTypes : ",t),t.length>0?t.split(",").map((function(e){return e.trim()})).filter((function(e){return Object.values(M.rS).includes(e)})):e}function fe(){var e={openAiModelForScript:(0,g.kky)(),customPromptFileName:(0,g.NL9)(),customScriptHandlerName:(0,g.M3V)()};return JSON.stringify(e)}function he(){return(0,g.FP9)()&&(0,g.LSW)()}var Ce=function(){if((0,g.xiT)()){var e,t=i.Vv.getSettingAsString(i.zj.VoiceModeEntry);if(t)(0,D.cY)("Enter Voice Mode from",t),i.Vv.setByKey(i.zj.VoiceModeEntry,void 0),A.$.getInstance().openRealtimeVoiceCopilot(t),c.B.getInstance().sendChatEventTelemetry((0,O.pN)((e={},(0,o._)(e,u.h3.ChatEventType,u.a5.VoiceCopilotModeEntered),(0,o._)(e,u.h3.ChatEventParameters,t),e)))}},me=function(e){A.$.getInstance().openSideQuest(e,(function(t,n,r,o){return(0,w.vi)(e,t,!1,!1,!1,void 0,void 0,void 0,!0,n,r,o,!0)}),L.QE),(0,k.AG)()},ve=function(e){return e<1?d.S.none:e<50?d.S.enableCommanding:e<(0,g.CSq)()?d.S.enableQnA:e<15e3?d.S.enableSummary:d.S.maxLimit},Ee=function(e){var t=A.$.getInstance().getAriaAnnouncerRef();(null==t?void 0:t.current)?(t.current.removeAttribute("aria-label"),setTimeout((function(){var n;null==t||null===(n=t.current)||void 0===n||n.setAttribute("aria-label",e)}),1)):(0,D.cY)("ariaAnnouncerRef is not set in CopilotChatUIHelper")},ye=function(){var e=(0,r._)((function(){var e,t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Word.run(function(){var e=(0,r._)((function(e){var t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return(t=e.document.body.getComments()).load("items"),[4,e.sync()];case 1:return n.sent(),[2,!B(t.items)&&t.items.length>0]}}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return[2,n.sent()];case 2:return e=n.sent(),(0,D.cY)("Error while checking for comments in document:",e),c.B.getInstance().sendErrorTelemetry((0,O.pN)((t={},(0,o._)(t,f.IC.ErrorMessage,"Exception in hasDocumentComments: ".concat(e.message)),(0,o._)(t,f.IC.ErrorCategory,C.S2.Error),t))),[2,!1];case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),be=function(){var e=(0,r._)((function(e){var t;return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,S.n6d.getInstance().getHighestDocumentSensitivityInfo([S.n6d.getInstance().getInDocSensitiveLabelInfo(),e])];case 1:return t=n.sent(),[4,S.n6d.getInstance().upgradeSensitivityLabelUsingOfcJs(t)];case 2:return n.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}();function Te(e){if(e){var t={};if(e.format)switch(e.format.toLowerCase()){case R.Sz.Single:t.format=M.$X.OneHost;break;case R.Sz.Dual:default:t.format=M.$X.TwoHost}if(e.duration)switch(e.duration.toLowerCase()){case R.R.Short:t.length=M.s0.Short;break;case R.R.Medium:t.length=M.s0.Medium;break;case R.R.Long:t.length=M.s0.Long;break;default:t.length=M.s0.Medium}if(e.style)switch(e.style.toLowerCase()){case R.oG.Concise:t.tone=M.QQ.Professional;break;case R.oG.Playful:default:t.tone=M.QQ.Casual}return e.custom_instructions&&(t.additionalInstructions=e.custom_instructions),t}}},257490:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(811912),o=n(791165),a=n(990813),i=n(242154),s=function(){function e(){(0,r._)(this,e),(0,a._)(this,"storage",void 0),this.storage=sessionStorage}return(0,o._)(e,[{key:"getSessionStorageObject",value:function(){var t,n=null===(t=this.storage)||void 0===t?void 0:t.getItem(e.SESSION_STORAGE_KEY);return n?JSON.parse(n):{isEnterpriseCheckEnabled:void 0}}},{key:"setSessionStorageObject",value:function(t){var n;null===(n=this.storage)||void 0===n||n.setItem(e.SESSION_STORAGE_KEY,JSON.stringify(t))}},{key:"getIsEnterpriseCheckEnabled",value:function(){try{var e=this.getSessionStorageObject();return null==e?void 0:e.isEnterpriseCheckEnabled}catch(e){return void(0,i.cY)("Error getting session storage object for ZeroQueryMessageSessionStorage",e)}}},{key:"setIsEnterpriseCheckEnabled",value:function(e){try{var t={isEnterpriseCheckEnabled:e};this.setSessionStorageObject(t)}catch(e){(0,i.cY)("Error setting session storage object for ZeroQueryMessageSessionStorage",e)}}}],[{key:"getInstance",value:function(){try{e.instance||(e.instance=new e)}catch(e){return void(0,i.cY)("Error creating instance of ZeroQueryMessageSessionStorage",e)}return e.instance}}]),e}();(0,a._)(s,"SESSION_STORAGE_KEY","ZeroQueryMessageSessionStorageObject"),(0,a._)(s,"instance",void 0);const c=s},258005:(e,t,n)=>{"use strict";n.d(t,{CS:()=>c,VE:()=>i,nQ:()=>r,sJ:()=>l,wM:()=>a,wj:()=>s});var r,o=n(656904),a=1317,i=366,s="DesignerImageInsertion";!function(e){e.oldSpaUrl="https://fa000000125.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2308.23015/en-us_web/login.html",e.newWebUrl="https://fa000000125.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.5008/en-us_web/login.html",e.newSpaUrl="https://fa000000125.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2401.13003/en-us_web/login.html",e.dodUrl="https://fa000000125.mro1cdnstorage.dod.cdn.office.net/mro1cdnstorage/033f92d3-bc6d-439a-858a-a17acf70360a/sdx/fa000000125/1.0.2505.27008/en-us_web/login.html",e.gccUrl="https://fa000000125.mro1cdnstorage.gcc.cdn.office.net/mro1cdnstorage/033f92d3-bc6d-439a-858a-a17acf70360a/sdx/fa000000125/1.0.2506.15004/en-us_web/login.html",e.nestedAppAuthUrl="brk-multihub://fa000000125.resources.office.net",e.nestedAppAuthDodUrl="brk-multihub://fa000000125.mro1cdnstorage.dod.cdn.office.net"}(r||(r={}));var c=function(){return(0,o.Csj)()?OfficeaicopilotStrings.DesignerFallbackToStockApologyMessage:"Apologies, I can't do this yet. Here are some stock images that match your search that may be useful."},l=function(){return(0,o.Csj)()?OfficeaicopilotStrings.DesignerFallbackToDalleApologyMessage:"Apologies, I can't do this yet. Here are some generated images that match your search and may be useful."}},260197:(e,t,n)=>{"use strict";n.d(t,{Fc:()=>r,I5:()=>s,Wr:()=>a,i$:()=>u,q7:()=>l,xT:()=>c});var r,o=n(483781);!function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(r||(r={}));var a,i,s="I ran into a problem while completing your request. Please try again.",c="The query in handoff message is empty or undefined.";!function(e){e.CrossAppCanvasHandoff="CrossAppCanvasHandoff",e.CrossAppHandoff="CrossAppHandoff",e.InAppHandoff="InAppHandoff"}(a||(a={})),function(e){e.TellMe="TellMe",e.WordCopilotComposeSelection="WordCopilotComposeSelection",e.ContextMenuRewriteClickAction="ContextMenuRewriteClickAction",e.WordCopilotRewriteSelection="WordCopilotRewriteSelection",e.SkittleContextMenuUserClickAction="SkittleContextMenuUserClickAction",e.WordCopilotComprehensionPodcast="WordCopilotComprehensionPodcast",e.ResearcherAgent="ResearcherAgent",e.CopilotContextMenuClickAction="CopilotContextMenuClickAction"}(i||(i={}));var l=[i.WordCopilotComprehensionPodcast],u=new Map([[i.TellMe,o.$n.M365CopilotChat],[i.WordCopilotComposeSelection,o.$n.M365CopilotChat],[i.ContextMenuRewriteClickAction,o.$n.M365CopilotChat],[i.WordCopilotRewriteSelection,o.$n.M365CopilotChat],[i.SkittleContextMenuUserClickAction,o.$n.M365CopilotChat],[i.ResearcherAgent,o.$n.M365CopilotChat],[i.CopilotContextMenuClickAction,o.$n.M365CopilotChat],[i.WordCopilotComprehensionPodcast,o.$n.AppChat]])},265167:(e,t,n)=>{"use strict";n.d(t,{r:()=>a});var r=n(660606),o="AugLoopChat".concat(r.JB),a=function(){function e(){}return e.generateId=function(){return e.operationId++,o+e.operationId.toString()},e.operationId=0,e}()},267380:(e,t,n)=>{"use strict";n.d(t,{E:()=>l});var r=n(533969),o=n(992640),a=n(61714),i=n(610898),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},c=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},l=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getApp=function(e){return s(this,void 0,void 0,(function(){var t,n,s;return c(this,(function(c){switch(c.label){case 0:return t=(0,a.A)(),(0,o.d)(t,r.o.AppService,r.L.GetApp,{request:e}),n=new i.N,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return s=c.sent(),[2,JSON.parse(s)]}}))}))},e.prototype.getApps=function(){return s(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(s){switch(s.label){case 0:return e=(0,a.A)(),(0,o.d)(e,r.o.AppService,r.L.GetApps),t=new i.N,this.requestByQueryId.set(e,t),[4,t.completion];case 1:return n=s.sent(),[2,JSON.parse(n)]}}))}))},e}()},267448:()=>{},267836:(e,t,n)=>{"use strict";n.d(t,{CP:()=>s,rT:()=>c,wj:()=>i});var r=n(862853),o=n(740389),a=n(602061);function i(e){return(0,r.q0)()&&(0,o.snA)(e)}function s(e){return(0,r.q0)()&&(0,o.sTw)(e)}var c=function(){return{isCustomGPTsEnabled:i(a.Sqe.IsCustomGPTsEnabled),shouldShowDADiscoverabilityZQM:i(a.Sqe.IsAgentDiscoverabilityZQMEnabled),isClickButtonStyleHamburgerEnabled:i(a.Sqe.IsClickButtonStyleHamburgerEnabled),showAgentMenuNudgeAndTooltip:i(a.Sqe.ShowAgentMenuNudgeAndTooltip),showAgentMenuExploreBadge:i(a.Sqe.ShowAgentMenuExploreBadge),enableUniqueDateCheckForStoreCardZQPrompt:i(a.Sqe.EnableUniqueDateCheckForStoreCardZQPrompt),enableInsightsCardAgents:i(a.Sqe.EnableInsightsCardAgents),enableSystemMessageActions:s(a.mRo.EnableSystemMessageActions),isInsertImageEnabledForDAs:s(a.mRo.IsInsertImageEnabledForDAs),disableACHorizontalScroll:s(a.mRo.DisableACHorizontalScroll),applyDynamicHostWidthToAC:s(a.mRo.EnableDynamicHostWidthForAC),showStoreLauncherZQPrompt:s(a.mRo.ShowStoreLauncherZQPrompt),showVisualCreatorZQPrompt:s(a.mRo.ShowVisualCreatorZQPrompt),showAtMentionMenuZQPrompt:i(a.Sqe.ShowAtMentionMenuZQPrompt),enableAgentSwitchInCatalyst:s(a.mRo.EnableAgentSwitchInCatalyst)}}},280858:(e,t,n)=>{"use strict";n.d(t,{D:()=>o.D,g:()=>r.g});var r=n(57852),o=n(768553)},285222:(e,t,n)=>{"use strict";n.d(t,{JI:()=>l,WS:()=>u,v_:()=>s,x5:()=>_,zt:()=>d});var r=n(354311),o=n(211475),a=n(660606),i=n(241273),s=function(e,t){var n,r=c(e.invocation,t);return null!==(n=e.text)&&void 0!==n?n:r},c=function(e,t){if(e){var n=t?/designer_graphic_art\(\s*[^)]*prompt\s*=\s*(['"])((?:\\.|[^\\])*?)\1/:/designer_graphic_art\(\s*[^)]*prompt\s*=\s*"([^"]*)"/,r=e.match(n);return r?t?r[2]:r[1]:void 0}},l=function(e,t){var n=s(e,t);return"bot"===e.author&&e.messageType===o.n3.GenerateContentQuery&&(null==e?void 0:e.contentType)===i.lL.Image&&void 0!==n},u=function(e,t){return!!t&&"bot"===e.author&&e.messageType===o.n3.Chat&&e.contentOrigin===o.o5.DeepLeo},d=function(e,t,n,o,i){return t?"dogfood":n&&(0,a.s7)(e)===r.D.GCC?"gcc":n&&(0,a.s7)(e)===r.D.DOD?i?"dod":"dod_cdn":o?"prod_ocdi":"production"},_=function(e){return e?e.split(";")[0].split("/")[1]:""}},297309:(e,t,n)=>{"use strict";n.d(t,{Y:()=>_});var r=n(743032),o=n(811912),a=n(791165),i=n(379490),s=n(242154),c=/<title>/g,l=/<\/title>/g,u=/<subtitle>/g,d=/<\/subtitle>/g,_=function(){function e(){(0,o._)(this,e)}return(0,a._)(e,null,[{key:"getParagraphById",value:function(e,t){return e.getByIdOrNullObject(t)}},{key:"highlightById",value:function(t,n,o){return(0,r._)((function(){var r,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r=e.getParagraphIdFromTileId(t),a=e.getParagraphById(n,r),[4,e.highlightParagraph(a,o)];case 1:return i.sent(),[2]}}))}))()}},{key:"getParagraphIdFromTileId",value:function(e){var t=e.split("\\");return t[t.length-1]}},{key:"getParagraphRangeFromTileId",value:function(t,n){var r=e.getParagraphIdFromTileId(t);if(!r)throw new Error("ParagraphOperation.getParagraphFromTileId: paragraphId is null or undefined");var o=e.getParagraphById(n,r);if(!o)throw new Error("ParagraphOperation.getParagraphFromTileId: paragraph is null or undefined");return o.getRange()}},{key:"highlightParagraph",value:function(t,n){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,r._)((function(){var r;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return o?[4,e.scrollToParagraph(t,n)]:[3,2];case 1:a.sent(),a.label=2;case 2:return r=t.getRange(),[4,e.highlightRange(r,n)];case 3:return a.sent(),[2]}}))}))()}},{key:"scrollToParagraph",value:function(e,t){return(0,r._)((function(){return(0,i.__generator)(this,(function(t){return e.select(Word.SelectionMode.end),[2]}))}))()}},{key:"highlightRange",value:function(e,t){return(0,r._)((function(){var n,r,o,a,c,l,u,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),(n=e.paragraphs).load("items"),[4,t.sync()];case 1:i.sent(),r=!0,o=!1,a=void 0;try{for(c=n.items[Symbol.iterator]();!(r=(l=c.next()).done);r=!0)u=l.value,u.getRange().intersectWith(e).highlight("")}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return[3,3];case 2:return d=i.sent(),(0,s.cY)("Highlights: error in highlighting range: "+d),[3,3];case 3:return[2]}}))}))()}},{key:"highlightRangeWithDuration",value:function(t,n,o){return(0,r._)((function(){return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.highlightRange(t,n)];case 1:return r.sent(),[4,n.sync()];case 2:return r.sent(),[4,new Promise((function(e){return setTimeout(e,o)}))];case 3:return r.sent(),e.removeHighlight(t),[4,n.sync()];case 4:return r.sent(),[2]}}))}))()}},{key:"removeHighlightById",value:function(t,n){var r=e.getParagraphIdFromTileId(t),o=e.getParagraphById(n,r);e.removeHighlightFromParagraph(o)}},{key:"removeHighlightFromParagraph",value:function(t){var n=t.getRange();e.removeHighlight(n)}},{key:"removeHighlight",value:function(e){e.removeHighlight()}},{key:"getAllParagraphs",value:function(e){return(0,r._)((function(){var t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return t=e.document.body.paragraphs,[4,e.sync()];case 1:return n.sent(),[2,t]}}))}))()}},{key:"adjustParagraphContent",value:function(e){return e=(e=(e=(e=e.replace(c,'<p data-ccp-parastyle="Title">')).replace(l,"</p>")).replace(u,'<p data-ccp-parastyle="Subtitle">')).replace(d,"</p>")}},{key:"replaceParagraphContent",value:function(t,n,o,a){return(0,r._)((function(){var r,s,c,l,u,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return r=e.getParagraphIdFromTileId(t),(s=e.getParagraphById(o,r)).load("style"),[4,a.sync()];case 1:return i.sent(),c=e.adjustParagraphContent(n),l=s.style,u=l.startsWith("heading")?l:null,s.getRange(Word.RangeLocation.content).clear(),d=s.insertHtml(c,Word.InsertLocation.end),null!=u&&(d.style=u),[2,d]}}))}))()}},{key:"deleteParagraph",value:function(t,n){var r=e.getParagraphIdFromTileId(t);e.getParagraphById(n,r).delete()}},{key:"insertParagraphContent",value:function(t,n,r){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=e.getParagraphIdFromTileId(t),i=e.getParagraphById(r,a),s=e.adjustParagraphContent(n);return i.insertParagraph("",o?Word.InsertLocation.before:Word.InsertLocation.after).insertHtml(s,Word.InsertLocation.replace)}},{key:"appendContentToDocument",value:function(t,n,o){return(0,r._)((function(){var r,a;return(0,i.__generator)(this,(function(i){return r=e.adjustParagraphContent(t),o?o.insertHtml(r,Word.InsertLocation.end):(a=n.getLast(),(o=a.insertHtml(r,Word.InsertLocation.end)).track()),[2,o]}))}))()}},{key:"cleanupLastAddedRange",value:function(e){return(0,r._)((function(){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return[4,Word.run((n=(0,r._)((function(t){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e?(e.untrack(),[4,t.sync()]):[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}}))})),function(e){return n.apply(this,arguments)}))];case 1:return t.sent(),[2,null]}var n}))}))()}}]),e}()},299562:(e,t,n)=>{"use strict";n.d(t,{u:()=>s});var r=n(63461),o=n(330743),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},i=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=function(){function e(e,t){this.bizChatALSession=null,this.handoffAnnotationTokens=new Map,this.initStartTime=0,this.sessionCreationTime=0,this.annotationRegistrationStartTime=0,this.handleResponseItem=e,this.config=t}return e.prototype.doInitializeBizChatALSession=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,a,s,c,l,u,d,_,p;return i(this,(function(i){switch(i.label){case 0:this.initStartTime=Date.now(),i.label=1;case 1:return i.trys.push([1,8,,9]),this.config.utils.debugLog("Initializing BizChatAL AL session"),this.config.telemetryEventHandler.updateTelemetryChatEventData(((l={})[this.config.constants.ChatEventsKeys.ChatEventType]=this.config.constants.ChatEventType.BizChatALSessionInitializationStarted,l[this.config.constants.ChatEventsKeys.ChatEventParameters]="BizChatAL AL Session Initialization Started",l),this.config.telemetryLogger.getInstance()),e=Date.now(),this.config.sessionProvider?(this.config.utils.debugLog("Using external AL session for BizChatAL"),t=this,[4,this.config.sessionProvider.getALSession()]):[3,3];case 2:return t.bizChatALSession=i.sent(),[3,4];case 3:this.config.utils.debugLog("Creating dedicated AL session for BizChatAL"),n=this.config.hostAppSettings.getSettingAsString(this.config.augloopSharedSessionIDSettingName),this.bizChatALSession=(0,o.wB)(this.config.utils.isNullOrUndefined(n)?"ALDummySession_BizChatAL":"".concat(n,"_BizChatAL")),i.label=4;case 4:return this.sessionCreationTime=Date.now()-e,this.config.telemetryEventHandler.updateTelemetryLatencyData(((u={})[this.config.constants.LatencyKeys.BizChatALSessionCreationTime]=this.sessionCreationTime/1e3,u),this.config.telemetryLogger.getInstance()),this.bizChatALSession?(this.annotationRegistrationStartTime=Date.now(),[4,this.registerHandoffAnnotations()]):[3,6];case 5:return i.sent(),r=Date.now()-this.initStartTime,a=Date.now()-this.annotationRegistrationStartTime,this.config.telemetryEventHandler.updateTelemetryLatencyData(((d={})[this.config.constants.LatencyKeys.BizChatALTotalInitializationTime]=r/1e3,d[this.config.constants.LatencyKeys.BizChatALAnnotationRegistrationTime]=a/1e3,d[this.config.constants.LatencyKeys.BizChatALHandoffAnnotationCount]=this.handoffAnnotationTokens.size,d),this.config.telemetryLogger.getInstance()),this.config.telemetryEventHandler.updateTelemetryChatEventData(((_={})[this.config.constants.ChatEventsKeys.ChatEventType]=this.config.constants.ChatEventType.BizChatALSessionInitializationCompleted,_[this.config.constants.ChatEventsKeys.ChatEventParameters]=JSON.stringify({totalTimeMs:r,sessionCreationTimeMs:this.sessionCreationTime,annotationRegistrationTimeMs:a,annotationsRegistered:this.handoffAnnotationTokens.size}),_),this.config.telemetryLogger.getInstance()),this.config.utils.debugLog("BizChatAL AL session initialized successfully. Total time: ".concat(r,"ms, Session creation: ").concat(this.sessionCreationTime,"ms, Annotation registration: ").concat(a,"ms")),[3,7];case 6:throw new Error("Failed to create BizChatAL AL session");case 7:return[3,9];case 8:throw s=i.sent(),c=Date.now()-this.initStartTime,this.config.utils.debugLog("Failed to initialize BizChatAL AL session: ".concat(s)),this.config.telemetryEventHandler.updateTelemetryChatEventData(((p={})[this.config.constants.ChatEventsKeys.ChatEventType]=this.config.constants.ChatEventType.BizChatALSessionInitializationFailed,p[this.config.constants.ChatEventsKeys.ChatEventParameters]=JSON.stringify({error:s instanceof Error?s.message:String(s),initTimeMs:c}),p),this.config.telemetryLogger.getInstance()),s;case 9:return[2]}}))}))},e.prototype.registerHandoffAnnotations=function(){return a(this,void 0,void 0,(function(){var e,t,n,o,s=this;return i(this,(function(c){switch(c.label){case 0:if(!this.bizChatALSession)throw new Error("BizChatAL AL session not initialized");this.config.utils.debugLog("Registering handoff annotations for BizChatAL"),c.label=1;case 1:return c.trys.push([1,5,,6]),[4,this.bizChatALSession.activateAnnotation(r.uC.getTypeName(),{callback:function(e){return a(s,void 0,void 0,(function(){var t,n,o;return i(this,(function(a){if(this.config.utils.debugLog("Received HandoffMessage annotation"),e.items)for(t=0,n=e.items;t<n.length;t++)(o=n[t]).body&&r.uC.typeGuard(o.body)&&(this.config.utils.debugLog("Processing HandoffMessage item"),this.handleResponseItem(o,""));return[2]}))}))}})];case 2:return e=c.sent(),this.handoffAnnotationTokens.set("HandoffMessage",e.token),[4,this.bizChatALSession.activateAnnotation(r.dF.getTypeName(),{callback:function(e){return a(s,void 0,void 0,(function(){return i(this,(function(e){return this.config.utils.debugLog("Received HandoffDocUrlAnnotation annotation"),[2]}))}))}})];case 3:return t=c.sent(),this.handoffAnnotationTokens.set("HandoffDocUrlAnnotation",t.token),[4,this.bizChatALSession.activateAnnotation(r.kp.getTypeName(),{callback:function(e){return a(s,void 0,void 0,(function(){return i(this,(function(e){return this.config.utils.debugLog("Received HandoffOutboundMessage annotation"),[2]}))}))}})];case 4:return n=c.sent(),this.handoffAnnotationTokens.set("HandoffOutboundMessage",n.token),this.config.utils.debugLog("Successfully registered ".concat(this.handoffAnnotationTokens.size," handoff annotations for BizChatAL")),[3,6];case 5:throw o=c.sent(),this.config.utils.debugLog("Failed to register handoff annotations: ".concat(o)),o;case 6:return[2]}}))}))},e.prototype.initializeBizChatALSession=function(){return a(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.doInitializeBizChatALSession()]}))}))},e.prototype.getBizChatALSession=function(){return this.bizChatALSession},e.prototype.isInitialized=function(){return null!==this.bizChatALSession},e.prototype.getPerformanceMetrics=function(){return{sessionCreationTime:this.sessionCreationTime,totalInitTime:this.initStartTime>0?Date.now()-this.initStartTime:0,annotationsCount:this.handoffAnnotationTokens.size}},e}()},302965:(e,t,n)=>{"use strict";n.d(t,{c:()=>r,v:()=>o});var r=function(e){var t,n=null===(t=null==e?void 0:e.adaptiveCards)||void 0===t?void 0:t[0];return{body:null!=n?n:{}}},o=function(e){return"bot"===e.author&&"ConfirmationCard"===e.messageType}},307222:(e,t,n)=>{"use strict";n.d(t,{e:()=>a});var r=n(208520),o=n(740389),a=function(){return{wordAgentFilterConstants:r.useMemo((function(){return{supportedAgentType:[{value:"AgentWithBizChatProfile",disabled:!(0,o.hrE)()},{value:"FluxV3",disabled:!(0,o.Wmj)()}]}}),[])}}},307271:(e,t,n)=>{"use strict";n(208520)},308849:(e,t,n)=>{"use strict";n.d(t,{GZ:()=>b,Hr:()=>h,Kj:()=>m,NV:()=>P,Sd:()=>I,TR:()=>E,gI:()=>v,iB:()=>T,jP:()=>C,y8:()=>y});var r=n(341422),o=n(822606),a=n(660606),i=n(608531),s=n(423905),c=n(83437),l=n(347853),u=n(330968),d=n(189037),_=n(483781),p=function(){return p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},p.apply(this,arguments)},g=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},f=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},h=function(e){if(e)return[{id:"CopilotPlugins.".concat(e.appType,".").concat(e.appId),source:"MOS3"}]},C=function(){var e,t=o.ps;null===(e=null===window||void 0===window?void 0:window.open)||void 0===e||e.call(window,t,"_blank","noopener,noreferrer")},m=function(){return g(void 0,void 0,void 0,(function(){var e,t;return f(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,i.B.getInstance().openMOSDialog()];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),(0,a.cY)("Error in launching MOS dialog",e),C(),a.EG.sendErrorTelemetry((0,s.pN)(((t={})[c.IC.ErrorMessage]="".concat(e),t[c.IC.ErrorCategory]=c.a5.OpenMOSDialog,t))),[3,3];case 3:return[2]}}))}))};function v(e){return void 0===e||""===e}var E=function(e,t,n){var r=(0,d.Z)(e),o=t===n?void 0:t;return(0,a.cY)("AtMentioned GPT: ",r),(0,a.cY)("Selected menu GPT: ",o),null!=r?r:o};function y(e,t){var n=(0,d.Z)(t);return!v(e)||void 0!==n}function b(e){return g(this,arguments,void 0,(function(e,t,n){var r,o,i,l=this;return void 0===t&&(t=0),f(this,(function(u){switch(u.label){case 0:r=function(r){return g(l,void 0,void 0,(function(){var o,i,l,u;return f(this,(function(d){switch(d.label){case 0:return(0,a.cY)("handleCopilotAgentEvent in client",JSON.stringify(p(p({},r),{delayValue:t}))),a.EG.sendChatEventTelemetry((0,s.pN)(((l={})[c.h3.ChatEventType]=c.a5.MOSStoreDialogResponse,l[c.h3.ChatEventParameters]=JSON.stringify(p(p({},r),{delayValue:t})),l))),o=r,t>0?[4,new Promise((function(e){return setTimeout(e,t)}))]:[3,2];case 1:d.sent(),d.label=2;case 2:return n&&(i=(0,_.dL)())&&(null===(u=null==i?void 0:i.PrimaryUserAccountInfo)||void 0===u?void 0:u.CopilotExperience)!==_.$n.M365CopilotChat&&n(p(p({},i),{PrimaryUserAccountInfo:p(p({},i.PrimaryUserAccountInfo),{CopilotExperience:_.$n.M365CopilotChat})})),e(o),[2]}}))}))},u.label=1;case 1:return u.trys.push([1,3,,4]),[4,OfficeFirstParty.UnifiedStore.onCopilotAgentEvent(r)];case 2:return u.sent(),[3,4];case 3:return o=u.sent(),(0,a.cY)("Error in initializing CopilotAgent listener",o),a.EG.sendErrorTelemetry((0,s.pN)(((i={})[c.IC.ErrorMessage]="".concat(o),i[c.IC.ErrorCategory]=c.a5.MOSStoreDialogResponse,i))),[3,4];case 4:return[2]}}))}))}var T=function(e,t,n){return g(void 0,void 0,void 0,(function(){var r,l,u,d;return f(this,(function(_){switch(_.label){case 0:return _.trys.push([0,6,,7]),e?[4,OfficeFirstParty.UnifiedStore.launchStore(o.Bx)]:[3,2];case 1:return _.sent(),[3,5];case 2:return t?[4,i.B.getInstance().openMOSDialog()]:[3,4];case 3:return _.sent(),[3,5];case 4:C(),_.label=5;case 5:return r={RichAPI:e,PrivateAPI:t,Source:n},a.EG.sendChatEventTelemetry((0,s.pN)(((u={})[c.h3.ChatEventType]=c.a5.OpenMOSDialog,u[c.h3.ChatEventParameters]=JSON.stringify(r),u))),[3,7];case 6:return l=_.sent(),(0,a.cY)("Error in launching MOS dialog",l),C(),a.EG.sendErrorTelemetry((0,s.pN)(((d={})[c.IC.ErrorMessage]="".concat(l),d[c.IC.ErrorCategory]=c.a5.OpenMOSDialog,d))),[3,7];case 7:return[2]}}))}))},I=function(e,t){return!e||v(e)?o.u1:JSON.stringify({gptId:null!=e?e:o.u1,agentType:null!=t?t:o.u1})};function P(e,t,n){var a=this;return{type:r.jA.Default,title:(0,u.QA)(),text:n?void 0:(0,u.QA)(),iconRegular:l.QxP,iconHover:l.SQn,handleButtonOnClick:function(n,r,i){return g(a,void 0,void 0,(function(){return f(this,(function(n){switch(n.label){case 0:return[4,T(e,t,o.Xt.FooterButton)];case 1:return n.sent(),[2]}}))}))}}}},309500:(e,t,n)=>{"use strict";n.d(t,{P:()=>c,S:()=>l});var r=n(341422),o=n(86511),a=n(555799),i=n(641359),s=n(475119),c=function(e){var t=(0,s.$H)(),n={type:r.jA.Default,title:t,text:(0,s.$$)()?void 0:t,iconRegular:i.T75,handleButtonOnClick:e},c=(0,s.rb)();return s.EG.logSeenEvent("Realtime Voice","Realtime Voice",o.RX.Voice),{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:c}}},chatMessageBodyData:{actionButtonList:[n]}}},l=function(){var e=(0,s.g5)();return{chatCardType:a._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:e}}}}}},313222:(e,t,n)=>{"use strict";n.d(t,{F:()=>m});var r=n(743032),o=n(811912),a=n(791165),i=n(990813),s=n(928499),c=n(379490),l=n(556117),u=n(656904),d=n(242154),_=n(297309),p=function(){function e(){(0,o._)(this,e)}return(0,a._)(e,null,[{key:"highlightWithDuration",value:function(t,n){return(0,r._)((function(){return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,e.highlight(t)];case 1:return r.sent(),[4,new Promise((function(e){return setTimeout(e,n)}))];case 2:return r.sent(),[4,e.unHighlight(t)];case 3:return r.sent(),[2]}}))}))()}},{key:"highlight",value:function(e){return(0,r._)((function(){var t;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Word.run((o=(0,r._)((function(t){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,_.Y.getAllParagraphs(t)];case 1:return n=r.sent(),[4,_.Y.highlightById(e,n,t)];case 2:return r.sent(),[2]}}))})),function(e){return o.apply(this,arguments)}))];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),(0,d.cY)("Highlights: error in ParagraphHighlight.highlight: "+t),[3,3];case 3:return[2]}var o}))}))()}},{key:"unHighlight",value:function(e){return(0,r._)((function(){var t;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Word.run((o=(0,r._)((function(t){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,_.Y.getAllParagraphs(t)];case 1:return n=r.sent(),_.Y.removeHighlightById(e,n),[2]}}))})),function(e){return o.apply(this,arguments)}))];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),(0,d.cY)("Highlights: error in ParagraphHighlight.unHighlight: "+t),[3,3];case 3:return[2]}var o}))}))()}}]),e}(),g=n(769449),f=n(740389),h=n(602061),C=n(211475),m=function(){function e(){var t=this;(0,o._)(this,e),(0,i._)(this,"CitationFileTypeMap",new Map([[C.YA.PowerPoint,l._R.PowerPoint],[C.YA.Excel,l._R.Excel],[C.YA.Word,l._R.Word],[C.YA.OneNote,l._R.OneNote],[C.YA.Outlook,l._R.Outlook],[C.YA.Teams,l._R.Teams],[C.YA.Event,l._R.Event],[C.YA.Meeting,l._R.Meeting],[C.YA.TeamsMeeting,l._R.Meeting],[C.YA.SharePoint,l._R.SharePoint],[C.YA.PDF,l._R.Pdf],[C.YA.Zip,l._R.Pdf],[C.YA.Visio,l._R.Visio],[C.YA.Fluid,l._R.Loop],[C.YA.Txt,l._R.Txt]]));var n,a=this;(0,i._)(this,"onClickCitationLink",(n=(0,r._)((function(e,t,n){return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return(0,d.cY)("onClickCitationLink called with referenceId : ".concat(e,"  ,path")),null==(null==t?void 0:t[0])?[3,2]:[4,a.highlightCitation(t[0])];case 1:r.sent(),r.label=2;case 2:return(0,g.lo)(n),[2]}}))})),function(e,t,r){return n.apply(this,arguments)})),(0,i._)(this,"getCitationReferences",(function(e,n){if(void 0===e||e&&0===e.length)return[];var r=e.map((function(e,r){var o=e.contentIndex?e.contentIndex:r+1;e.content=t.getSnippetFromCitationContent(e.content);var a={referenceIndex:o,referenceProps:{title:t.getTitleFromSnippet(e.content),primarySubtitle:(0,u.d_y)(),snippet:e.content,iconAppName:e.type,referenceType:l._2.Internal,citationPosition:e.position,onClickCitationLink:t.onClickCitationLink,path:e.path,sensitivityLabel:n}};return(0,d.cY)("Chat Reference is :",a),a}));return(0,g.M4)(r.length),r})),(0,i._)(this,"getSnippetFromCitationContent",(function(e){return e?'"'+(e.length>u.T1Y?e.slice(0,u.T1Y)+"...":e)+'"':void 0})),(0,i._)(this,"getTitleFromSnippet",(function(e){return e?('"'===e[0]&&(e=e.substring(1,e.length-1)),'"'+(e.length>u.cGI?e.slice(0,u.cGI).trim()+"...":e)+'"'):null})),(0,i._)(this,"addCitationsToParagraph",(function(e,n){if(void 0===e||e&&0===e.length)return[];e.sort((function(e,t){return e.referenceProps.citationPosition-t.referenceProps.citationPosition}));for(var r=(0,s._)(n),o=0,a=0,i=0,c="",l=0;o<n.length&&a<e.length;){var u=e[a].referenceProps.citationPosition-i;if((0,d.cY)("str length of current chunk :+",n[o].length),u<=n[o].length+1){var _=u+l,p=t.getCitationStrToInsert(e[a].referenceIndex);c=t.insertCitation(r[o],_,p),l+=p.length,r[o]=c,(0,d.cY)("Updated paragraph is :",r[o]),a++}else l=0,i+=n[o].length,o++}if(o===n.length&&a<e.length)for(;a<e.length;)r[o-1]=t.addCitationAtEnd(r[o-1],e[a].referenceIndex),a++;return r})),(0,i._)(this,"addCitationsToKeyPoints",(function(e,n){if(void 0===e||e&&0===e.length)return[];e.sort((function(e,t){return e.referenceProps.citationPosition-t.referenceProps.citationPosition}));for(var r=(0,s._)(n),o=0,a=0,i=0,c="",l=0;o<n.length&&a<e.length;){var u=e[a].referenceProps.citationPosition-i;if((0,d.cY)("str length :+",n[o].text.length),u<=n[o].text.length+1){var _=u+l,p=t.getCitationStrToInsert(e[a].referenceIndex);c=t.insertCitation(r[o].text,_,p),l+=p.length,r[o]={title:n[o].title,text:c},(0,d.cY)("Updated Keypoint is :",r[o]),a++}else l=0,i+=n[o].text.length,o++}if(o===n.length&&a<e.length)for(;a<e.length;){var g=t.addCitationAtEnd(r[o-1].text,e[a].referenceIndex);r[o-1]={title:n[o-1].title,text:g},a++}return r})),(0,i._)(this,"getChatReferenceType",(function(e,n,r){if((0,f.aJZ)()){if(null==r?void 0:r.path)return l._2.Internal;if(e===C.YA.Web||void 0===e)return l._2.External;if(void 0!==e&&Object.values(l._R).includes(e))return l._2.CrossApp}return void 0===n?l._2.External:(null==r?void 0:r.path)&&!(null==r?void 0:r.seeMoreUrl)?l._2.Internal:t.CitationFileTypeMap.has(n)?l._2.CrossApp:l._2.External})),(0,i._)(this,"getCrossAppCitationFileType",(function(e){if(void 0!==e)return t.CitationFileTypeMap.has(e)?t.CitationFileTypeMap.get(e):void 0})),(0,i._)(this,"getSupportedIconType",(function(e){if(void 0!==e)return Object.values(l._R).includes(e)?e:void 0})),(0,i._)(this,"getChatReferencefromSourceAttributions",(function(e,n){return e.filter((function(e){return n?e.sourceType===u.YgX:e.sourceType!==u.YgX})).map((function(e,n){var r,o,a,i=void 0;e.referenceMetadata&&(i=JSON.parse(e.referenceMetadata));var s,c,d,_,p,g=t.getChatReferenceType(null==i?void 0:i.type,null==i?void 0:i.referenceType,e),h=g===l._2.Internal?t.getTitleFromSnippet(null!==(s=null==i?void 0:i.snippet)&&void 0!==s?s:""):null!==(c=t.getTitleFromSnippet(e.providerDisplayName))&&void 0!==c?c:g,C=g===l._2.Internal?(0,u.d_y)():null!==(d=null==i?void 0:i.typeDescription)&&void 0!==d?d:u.u1i,m=null==i||null===(r=i.iconUrl)||void 0===r?void 0:r.replace(/\/$/,""),v=t.getReferenceSourceType(e);return{referenceIndex:n+1,referenceProps:{title:null!=h?h:u.u1i,primarySubtitle:C,secondarySubtitle:null!==(_=null==i?void 0:i.context)&&void 0!==_?_:t.getUrlForCitation(e),snippet:null!==(p=t.getSnippetFromCitationContent(null==i?void 0:i.snippet))&&void 0!==p?p:u.u1i,referenceType:g,iconAppName:g===l._2.CrossApp||g===l._2.Internal?(0,f.aJZ)()?t.getSupportedIconType(null==i?void 0:i.type):t.getCrossAppCitationFileType(null==i?void 0:i.referenceType):void 0,url:t.getUrlForCitation(e),path:[e.path],onClickCitationLink:t.onClickCitationLink,sensitivityLabel:(0,f.EG7)()?null==i||null===(o=i.sensitivityLabel)||void 0===o?void 0:o.displayName:void 0,iconUrl:m,linkType:v},isFlux:!0,isCitedInResponse:(0,f.ahx)()&&"true"===(null===(a=e.isCitedInResponse)||void 0===a?void 0:a.toLocaleLowerCase())}}))}))}return(0,a._)(e,[{key:"highlightCitation",value:function(e){return(0,r._)((function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return(0,d.cY)("Path is highlight and switch to: "+e),[4,p.highlightWithDuration(e,u.nSc)];case 1:return t.sent(),[2]}}))}))()}},{key:"insertCitation",value:function(e,t,n){return e.slice(0,t-1)+n+e.slice(t-1,e.length)}},{key:"addCitationAtEnd",value:function(e,t){return e+this.getCitationStrToInsert(t)}},{key:"getCitationStrToInsert",value:function(e){return u.FqO+e.toString()+u.FqO}},{key:"getUrlForCitation",value:function(e){return(0,f.aJZ)()?(0,h.hXl)(e.path)?e.seeMoreUrl:void 0:(0,h.hXl)(e.seeMoreUrl)?void 0:e.seeMoreUrl}},{key:"getReferenceSourceType",value:function(e){return e.sourceType===u.YgX?l.GH.Annotation:l.GH.Citation}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,i._)(m,"instance",void 0)},322974:(e,t,n)=>{"use strict";n.d(t,{t:()=>a});var r=n(475119),o=n(423905);function a(e,t){var n,a;void 0===t&&(t=!1);var i=(e||[]).filter((function(e){return!(!e.cardJson||e.sourceType&&"CITATION"!==e.sourceType)})),s=null!==(n=null==i?void 0:i.length)&&void 0!==n?n:0;return s>0?((0,r.cY)("Getting msgExtProp for MsgExtCard here.."),a={attributions:i},t&&(0,o.d_)(s)):(0,r.cY)("No data(cardJson) found for MsgExtCard."),a}},327099:(e,t,n)=>{"use strict";n.d(t,{g:()=>r.g});var r=n(705458);n(746592)},328831:(e,t,n)=>{"use strict";n.d(t,{Gn:()=>c,Ld:()=>s,P7:()=>i});var r=n(369649),o=n(475119),a=o.u1,i=function(e){a=null!=e?e:o.u1},s=function(){return a};function c(){if(a)return(0,r.UD)(a)}},329739:(e,t,n)=>{"use strict";n.d(t,{j:()=>d});var r=n(660606),o=n(423905),a=n(83437),i=n(217425),s=n(354311),c=n(758651),l=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},u=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},d=function(){function e(e){this.params=e}return e.prototype.loadMsalBrowser=function(){return l(this,void 0,void 0,(function(){var e,t,r;return u(this,(function(o){switch(o.label){case 0:e=1,o.label=1;case 1:if(!(e<=3))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),t=this,[4,n.e(717).then(n.bind(n,719072))];case 3:return t.msalModule=o.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(r=o.sent(),c.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),r),3===e)throw r;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.getAuthorityAsPerEnv=function(){var e;return!!(null===(e=this.params)||void 0===e?void 0:e.appEnvironment)&&this.params.appEnvironment.length>0&&this.params.appEnvironment===s.D.DOD?i.MA:i.mr},e.prototype.createPublicClientApplication=function(e){return l(this,void 0,void 0,(function(){var t,n,r,o,a;return u(this,(function(s){return t=null!==(a=null===(o=this.params)||void 0===o?void 0:o.clientId)&&void 0!==a?a:i.ky,n=this.params.redirectUri,r=this.getAuthorityAsPerEnv(),[2,new e({auth:{clientId:t,authority:r,redirectUri:new URL(n,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})]}))}))},e.prototype.getToken=function(e,t,n){return l(this,void 0,void 0,(function(){var t,i,s,c,l,d;return u(this,(function(u){switch(u.label){case 0:return(0,r.cY)("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:u.sent(),u.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=u.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(d=this.params)||void 0===d?void 0:d.logTelemetry)&&r.EG.sendChatEventTelemetry((0,o.pN)(((l={})[a.h3.ChatEventType]=a.a5.MSALTokenRequested,l))),i=void 0,u.label=4;case 4:return u.trys.push([4,10,,14]),[4,t.initialize()];case 5:return u.sent(),0!==(null==(s=t.getAllAccounts())?void 0:s.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,u.sent()];case 7:return[4,this.getSelectedAccount(s,t)];case 8:if(!(i=u.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[4,this.acquireTokenSilent(e,i,t,n)];case 9:return[2,u.sent()];case 10:return c=u.sent(),(0,r.cY)("Failed to get access token: ".concat(null==c?void 0:c.message)),this.msalModule&&c instanceof this.msalModule.InteractionRequiredAuthError?[4,this.acquireTokenPopup(e,i,t)]:[3,12];case 11:return[2,u.sent()];case 12:throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),c;case 13:return[3,14];case 14:return[2]}}))}))},e.prototype.getAccountInfoFromCache=function(){return l(this,void 0,void 0,(function(){var e,t,n=this;return u(this,(function(r){switch(r.label){case 0:return this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:r.sent(),r.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(e=r.sent()))throw this.logTokenAcquiredError("Failed to get account info - Could not load msal module"),new Error("Failed to get account info - Could not load msal module");return[4,e.initialize()];case 4:return r.sent(),[2,null!==(t=e.getAllAccounts().find((function(e){var t,r,o;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(o=null===(r=n.params)||void 0===r?void 0:r.userPrincipalName)||void 0===o?void 0:o.toLowerCase())})))&&void 0!==t?t:null]}}))}))},e.prototype.getSelectedAccount=function(e,t){return l(this,void 0,void 0,(function(){var n,r,o,a,i=this;return u(this,(function(s){switch(s.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(o=s.sent())?void 0:o.account];case 2:if(!e||0===e.length)return[2,null];if(n=this.params?null!==(a=e.find((function(e){var t,n,r;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(r=null===(n=i.params)||void 0===n?void 0:n.userPrincipalName)||void 0===r?void 0:r.toLowerCase())})))&&void 0!==a?a:null:e[0],n)return[2,n];r=this.params?{loginHint:this.params.userPrincipalName}:void 0,s.label=3;case 3:return s.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(r),[4,this.loginPopupPromise];case 4:return[2,null==(o=s.sent())?void 0:o.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){return l(this,void 0,void 0,(function(){var n,r,o;return u(this,(function(a){switch(a.label){case 0:return n={scopes:["".concat(e,"/.default")],loginHint:null===(o=this.params)||void 0===o?void 0:o.userPrincipalName},[4,t.ssoSilent(n)];case 1:return(r=a.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,r]}}))}))},e.prototype.acquireTokenSilent=function(e,t,n,r){return l(this,void 0,void 0,(function(){var o,a;return u(this,(function(i){switch(i.label){case 0:return o={scopes:null!=r?r:["".concat(e,"/.default")],account:t},[4,n.acquireTokenSilent(o)];case 1:return(a=i.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,a]}}))}))},e.prototype.acquireTokenPopup=function(e,t,n){return l(this,void 0,void 0,(function(){var r,o;return u(this,(function(a){switch(a.label){case 0:return r={scopes:["".concat(e,"/.default")],account:t},[4,n.acquireTokenPopup(r)];case 1:return(o=a.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,o]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,n;(null===(n=this.params)||void 0===n?void 0:n.logTelemetry)&&r.EG.sendErrorTelemetry((0,o.pN)(((t={})[a.IC.ErrorCategory]=a.S2.MSAL,t[a.IC.ErrorMessage]=e,t)))},e}()},330968:(e,t,n)=>{"use strict";n.d(t,{QA:()=>o.QA,QM:()=>o.QM,Sq:()=>a.S,Yj:()=>r.Y,lF:()=>o.lF,mR:()=>a.m});n(307271),n(373998);var r=n(578483),o=n(481933),a=n(244368)},336937:()=>{},339675:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});var r=n(208520),o=n(353923),a=n(916472);function i(e){var t=(0,o.A0)(e),n=(0,a.z)(),i=(0,r.useMemo)((function(){return n.filter((function(e){return t.includes(e.skill)}))}),[n,t]);return{submitAugloopSignals:(0,r.useCallback)((function(e){i.forEach((function(t){return t.submitAugloopSignal(e)}))}),[i]),onAugloopAnnotations:(0,r.useCallback)((function(e){i.forEach((function(t){return t.onAugloopAnnotation(e)}))}),[i]),cardContentProviders:i}}},340367:(e,t,n)=>{"use strict";n.d(t,{CY:()=>_,Gw:()=>p,K:()=>l,OK:()=>d,hT:()=>u});var r=n(656904),o=n(140889),a=n(249002),i=n(720971),s=n(244157),c=n(598309),l=function(){return(0,c.fD)()?s.Cf+1:s.Cf},u=function(e){return e===i.S.none||e===i.S.enableCommanding||e===i.S.enableQnA?s.P7.newDocument:e===i.S.enableSummary||e===i.S.maxLimit?s.P7.existingDocument:s.P7.Unknown};function d(e){var t,n=function(e){switch(e){case r.UeP.summarize():return o.CC.Summary;case r.UeP.generateImage():return o.CC.DesignerVisuals;case r.UeP.descTimeMgmt():case r.qvg.ProactiveZQMForDocWithContentTitleText1():case r.ipg.WhatDocSaysAboutTopic():case r.qvg.ProactiveZQMForDocWithContentTitleText2():case r.qvg.ProactiveZQMForDocWithContentTitleText3():case r.ipg.ProsAndConsOfTopic():case r.qvg.ProactiveZQMForDocWithContentTitleText4():case r.qvg.ProactiveZQMForDocWithContentTitleText5():case r.ipg.SummarizeIntoHighLevelOverview():case r.qvg.ProactiveZQMForDocWithContentTitleText6():case r.ipg.TellReferencesAboutTopic():case r.qvg.ProactiveZQMForDocWithContentTitleText7():case r.qvg.ProactiveGeneralZQMForDocWithContentTitleText1():case r.qvg.ProactiveGeneralZQMForDocWithContentTitleText2():case r.qvg.ProactiveGeneralZQMForDocWithContentTitleText10():case r.ipg.CreateBannerDesignOfDescription():case r.b5f.textItem11():case r.b5f.textItem12():case r.ipg.TranslateText():case r.b5f.textItem13():case r.ipg.DescribeTopic():case r.b5f.textItem14():return o.CC.ChatQnA;case r.qvg.ProactiveGeneralZQMForDocWithContentTitleText8():case r.qvg.ProactiveGeneralZQMForDocWithContentTitleText9():return o.CC.DesignerVisuals;case r.b5f.textItem1():case r.b5f.textItem2():case r.b5f.textItem3():case r.b5f.textItem4():case r.b5f.textItem5():case r.b5f.textItem6():case r.b5f.textItem7():case r.b5f.textItem8():case r.b5f.textItem9():case r.b5f.textItem10():case r.ipg.AnalyzeSuggestText():return o.CC.Draft;case r.UeP.speakWithCopilot():case r.UeP.extractTextFromImage():default:return o.CC.CopilotChat}}(e);return{featureName:null!=n?n:o.CC.CopilotChat,verb:(0,a.RH)(n).verb,subFeatureName:null!==(t=(0,a.RH)(n).subFeature)&&void 0!==t?t:o.nk.Unset}}var _=function(e){return null==e?void 0:e.findIndex((function(e){return e.suggestionText===r.UeP.summarize()}))},p=function(e){var t;if(!(null==e||null===(t=e.promptSuggestionList)||void 0===t?void 0:t.length))return!1;var n=e.promptSuggestionList,r=_(n);return r>=0&&!n[r].isHidden}},344196:(e,t,n)=>{"use strict";n.d(t,{D:()=>r.D});var r=n(898998)},350065:(e,t,n)=>{"use strict";n.d(t,{D:()=>h});var r=n(208520),o=n(798050),a=n(765799),i=n(475119),s=n(83437),c=n(837963),l=n(353923),u=n(224376),d=n(61714),_=n(362962),p=n(444689),g=n(967709),f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},f.apply(this,arguments)};function h(e,t){var n=(0,r.useReducer)(p.Jx,p.nC),h=n[0],C=n[1],m=(0,r.useRef)({id:i.u1,submitTime:-1}),v=(0,r.useCallback)((function(t){m.current.id=(0,d.A)(),m.current.submitTime=Date.now(),t({operation:(0,g.Y)(e,m.current.id),workflowAnnotationType:a.ht.getTypeName()})}),[e]),E=(0,r.useCallback)((function(t){var n=(0,u.w)(t);if(n&&n.skill===e){var r=n.markdownTextSoFar,o=n.json,a=n.errorMessage,i=n.cardState,s=null!=a?a:r;C({type:p.RN.AnnotationReceived,markdownText:s,json:o,cardState:i})}}),[e]),y=(0,r.useCallback)((function(e,t){C({type:p.RN.ContentUpdated,props:e,cardState:null!=t?t:o.x.LOADED})}),[]),b=(0,r.useCallback)((function(){return t?t(h.cardProps):(0,c.$)(h.cardProps)}),[h.cardProps,t]),T=(0,r.useCallback)((function(e){C({type:p.RN.RequestTimedOut,isRetry:e})}),[]),I=(0,r.useCallback)((function(t){void 0===t&&(t=!1);var n=t?s.a5.InsightsCardCocoaSkillCardNavigatedTo:s.a5.InsightsCardCocoaSkillCardClicked;(0,_.Ot)(e,n,m.current.id)}),[e]),P=(0,r.useMemo)((function(){return{content:b(),tabType:o.E.COCOASKILL,tabValue:(0,l.g3)(e),tabTitle:(0,l.Vx)(e),contentState:h.cardState,updateContent:y,onTabLoadTimeout:T}}),[e,b,h.cardState,y,T]);return(0,r.useEffect)((function(){var t=h.cardState,n=m.current,r=n.submitTime,a=n.id;switch(t){case o.x.LOADED:(0,_.sK)(e,s.a5.InsightsCardCocoaSkillResponseLoaded,r,a);break;case o.x.ERRORED:(0,_.sK)(e,s.a5.InsightsCardCocoaSkillResponseError,r,a);break;case o.x.UPDATING:(0,_.sK)(e,s.a5.InsightsCardCocoaSkillResponseUpdating,r,a);break;case o.x.TIMEDOUT:(0,_.sK)(e,s.a5.InsightsCardCocoaSkillResponseTimedOut,r,a)}}),[h.cardState,e]),f(f({},P),{skill:e,queryId:m.current.id,submitAugloopSignal:v,onAugloopAnnotation:E,renderContent:b,onSelected:I})}},351619:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{z:()=>getOfficeJSClientProps});var _swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(743032),_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(379490),_frontend_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(242154),_FeatureGates__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(740389),_OfficeJSTools__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(846863),_ToolCallbacks__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(909827),_getWordObject__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(49674);function getOfficeJSClientProps(){if((0,_FeatureGates__WEBPACK_IMPORTED_MODULE_1__.NbV)()){var officeJSTool={name:"OfficeJSExecutor",description:"Executor for OfficeJS code",inputSchema:{type:"object",properties:{officejs:{type:"string",description:(0,_FeatureGates__WEBPACK_IMPORTED_MODULE_1__.qMK)()||'OfficeJS code in format "{(async () => {<insert code here>); resolve(<result>)})();}". Should always resolve result that can be used as input for jsonify. No output to console or use of return. No data processing or mix of document set/gets in a script.'}},required:["officejs"],additionalProperties:!1,$schema:"https://json-schema.org/draft-07/schema#"}},tools=(0,_FeatureGates__WEBPACK_IMPORTED_MODULE_1__.EiL)()?[_OfficeJSTools__WEBPACK_IMPORTED_MODULE_2__.Xg,_OfficeJSTools__WEBPACK_IMPORTED_MODULE_2__.zk,_OfficeJSTools__WEBPACK_IMPORTED_MODULE_2__.fO]:[officeJSTool],getOfficeJSTools=function(){return{tools}},callOfficeJSTool=function(){var _ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_5__._)((function(toolName,args){var executeOfficeJSCodeForChatInput;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_6__.__generator)(this,(function(_state){switch(_state.label){case 0:return toolName!==_OfficeJSTools__WEBPACK_IMPORTED_MODULE_2__.Xg.name?[3,2]:[4,(0,_getWordObject__WEBPACK_IMPORTED_MODULE_4__.m)(args.propertyName)];case 1:case 3:case 5:case 7:return[2,_state.sent()];case 2:return toolName!==_OfficeJSTools__WEBPACK_IMPORTED_MODULE_2__.zk.name?[3,4]:[4,(0,_ToolCallbacks__WEBPACK_IMPORTED_MODULE_3__.N)(args.this_Document_wordObjId,args.code)];case 4:return toolName!==_OfficeJSTools__WEBPACK_IMPORTED_MODULE_2__.fO.name?[3,6]:[4,(0,_ToolCallbacks__WEBPACK_IMPORTED_MODULE_3__.d)(args.this_Range_wordObjId,args.code)];case 6:if(toolName!==officeJSTool.name)throw new Error("Unknown tool name: ".concat(toolName));return executeOfficeJSCodeForChatInput=function(){var _ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_5__._)((function(officejs){var waitEval,transpileTypeScript,jsCode,result;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_6__.__generator)(this,(function(_state){switch(_state.label){case 0:return waitEval=function(ev){return new Promise((function(resolve,reject){eval(ev)}))},transpileTypeScript=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_5__._)((function(e){var t;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_6__.__generator)(this,(function(n){switch(n.label){case 0:return[4,Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,508479,23))];case 1:return t=n.sent(),[2,t.transpile(e)]}}))}));return function(t){return e.apply(this,arguments)}}(),[4,transpileTypeScript(officejs)];case 1:return jsCode=_state.sent(),[4,(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_5__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_6__.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,waitEval(jsCode)];case 1:return[2,t.sent()];case 2:return e=t.sent(),(0,_frontend_utils__WEBPACK_IMPORTED_MODULE_0__.cY)("Syntax Error jsCode: ".concat(jsCode,"\n Error: ").concat(e.message)),[2,e.message];case 3:return[2]}}))}))()];case 2:return result=_state.sent(),[2,result]}}))}));return function(e){return _ref.apply(this,arguments)}}(),[4,executeOfficeJSCodeForChatInput(args.officejs)]}}))}));return function(e,t){return _ref.apply(this,arguments)}}();return{getLocalTools:getOfficeJSTools,callLocalTool:callOfficeJSTool}}}},352628:(e,t,n)=>{"use strict";n.d(t,{$n:()=>l,GN:()=>c,LJ:()=>s,b_:()=>a,h7:()=>r,k$:()=>o,zi:()=>i});var r=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","zh-CN"],o=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","pt-PT","ru-RU","sv-SE","th-TH","tr-TR","uk-UA","zh-TW"],a=["ar-SA","he-IL"],i=["ca-ES","cy-GB"],s=["bg-BG","el-GR","et-EE","hr-HR","id-ID","lt-LT","lv-LV","ro-RO","sk-SK","sl-SI","sr-Latn-RS","vi-VN"],c=["sq-AL","fil-PH","is-IS","kk-KZ","ms-MY","mt-MT","sr-Cyrl-RS"],l=["ar-SA","fa-IR","he-IL","ug-CN","ur-PK"]},352929:(e,t,n)=>{"use strict";n.d(t,{$:()=>o});var r=n(208520);function o(e){var t=e.seenEvent,n=e.triedEvent,o=e.keptEvent,a=e.getQueryId,i=e.startedFetchingRef,s=e.feedbackInfo,c=(0,r.useRef)(!1),l=(0,r.useRef)(!1);return{markStartedFetching:function(){i.current=!0},logSeen:function(){!c.current&&i.current&&(c.current=!0,t())},logTried:function(){l.current||(l.current=!0,n(a?a():void 0))},logKept:function(){null==o||o()},isSeenLogged:c,isTriedLogged:l,feedbackInfo:s}}},353923:(e,t,n)=>{"use strict";n.d(t,{A0:()=>a,Iz:()=>c,Vx:()=>i,g3:()=>s});var r=n(193536),o=Object.values(r.T).reduce((function(e,t){return e[t.toLowerCase()]=t,e}),{});function a(e){return e.split("|").map((function(e){var t=e.trim().toLowerCase();return o[t]})).filter((function(e){return void 0!==e}))}function i(e){return e}function s(e){return"CocoaSkill:".concat(e)}function c(e,t){return t.find((function(t){return t.tabValue===e}))||null}},354535:(e,t,n)=>{"use strict";n.d(t,{j:()=>i,r:()=>s});var r,o=n(660606);!function(e){e.AutoOpenTTVR="visuallyReady",e.AutoOpenTTFR="functionallyReady"}(r||(r={}));var a="[BizChat Perf]:";function i(e,t,n,i,s){var l=n;(0,o.cY)("".concat(a,": chat load event triggered at ").concat(performance.now()),n);var u=function(e){var t=void 0;switch(null==e?void 0:e.measureType){case"TTVR":t=r.AutoOpenTTVR;break;case"TTFR":t=r.AutoOpenTTFR}return t}(l);if(u)if(c())u===(s?r.AutoOpenTTFR:r.AutoOpenTTVR)&&(Microsoft.Office.WebExtension.Interactive(!0),(0,o.cY)("".concat(a,": Interactive API called with true param")));else if(t){var d=function(e,t,n){var r={MessageId:e,SendTime:void 0!==n?n:Date.now(),Values:{Payload:{type:"CopilotAutoOpen",CopilotTTVRCheckpoint:{ttvrCheckpoint:t},fromBizChat:!0}}};return JSON.stringify(r)}(e,u,l.eventTime);i({type:"CopilotChatTTVRMessage",message:d}),(0,o.cY)("".concat(a,": Perf PostMessage Sent"),d)}else(0,o.cY)("".concat(a,": Skipping post message for non-auto open"));else(0,o.cY)("".concat(a,": Invalid event arg"),l)}function s(){c()&&(Microsoft.Office.WebExtension.Interactive(!0),(0,o.cY)("".concat(a,": Interactive API called with true param")))}function c(){var e,t;return"undefined"!=typeof Microsoft&&"function"==typeof(null===(t=null===(e=null===Microsoft||void 0===Microsoft?void 0:Microsoft.Office)||void 0===e?void 0:e.WebExtension)||void 0===t?void 0:t.Interactive)}},362962:(e,t,n)=>{"use strict";n.d(t,{$S:()=>c,Ot:()=>s,sK:()=>i});var r=n(475119),o=n(83437),a=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function i(e,t,n,o){!function(e,t,n,r){d([l(e,t),u(n)],r)}(e,t,(0,r.xJ)(n),o)}function s(e,t,n){d([l(e,t)],n)}function c(e,t){return t.replace("{Skill}",e)}function l(e,t){return{key:o.h3.ChatEventType,value:c(e,t)}}function u(e){return{key:o.h3.ChatEventParameters,value:e}}function d(e,t){r.EG.sendChatEventTelemetry(a(a([],e,!0),[{key:o.h3.UserQueryGuid,value:t}],!1))}},370216:(e,t,n)=>{"use strict";n.d(t,{D:()=>r.D});var r=n(818203)},372102:(e,t,n)=>{"use strict";n.d(t,{V:()=>c});var r=n(475119),o=n(217425),a=n(632197),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(e){return i(void 0,void 0,void 0,(function(){var t,n;return s(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e.getToken(o.w8.onenote)];case 1:return t=i.sent(),[2,(0,a.t)(t)];case 2:throw n=i.sent(),(0,r.cY)("Error fetching OneNote token:",n),n;case 3:return[2]}}))}))}},373998:(e,t,n)=>{"use strict";n(208520)},375653:(e,t,n)=>{"use strict";n.d(t,{Xh:()=>o.Xh,a2:()=>o.a2,f9:()=>r.f});var r=n(817990),o=n(648284)},376951:(e,t,n)=>{"use strict";n.d(t,{F:()=>C});var r=n(110213),o=n(650958),a=n(4274),i=n(680118),s=n(648263),c=n(208520),l=n(742080),u=n(384761),d=n(139156),_=n(475119),p=n(758651),g=function(){return g=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},g.apply(this,arguments)},f=new Map([["docx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/docx.svg"],["pptx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pptx.svg"],["xlsx","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/xlsx.svg"],["pdf","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/pdf.svg"],["txt","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/txt.svg"],["html","https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets/item-types/20/html.svg"]]),h=function(e){var t=e.list,n=e.headerDescription,g=e.maxEntityCount,h=e.contentTypeFilter,C=e.suggestedPrompts,m=e.logRelatedFilesTriedEvents,v=e.styles,E=void 0===v?{}:v,y=c.useState((function(){var e=t;return h&&h.length>0&&(e=e.filter((function(e){return e.contentType&&-1!==h.indexOf(e.contentType)}))),g&&(e=e.slice(0,g)),e})),b=y[0],T=y[1],I=(0,_.bt)((0,l.N)(),E);return c.useEffect((function(){var e=t;h&&h.length>0&&(e=e.filter((function(e){return e.contentType&&-1!==h.indexOf(e.contentType)}))),g&&(e=e.slice(0,g)),e&&e.length>0&&T(e),p.log("Filtered entity list:",e)}),[t]),c.createElement(_.Wd,{style:I.entityPickerChildGap},n&&c.createElement(r.c,null,n),c.createElement(_.Wd,{style:I.elementGap},null==b?void 0:b.map((function(e,t){var n;return c.createElement(_.Wd,{key:t,style:I.entityCardContainer},c.createElement(_.Wd,{horizontal:!0,style:I.entityCard},c.createElement("div",{className:I.entityIconContainer},c.createElement("img",{src:e.iconUrl||f.get(e.contentType),alt:"".concat(null!==(n=e.contentType)&&void 0!==n?n:"File"," icon"),className:I.entityIconImg})),c.createElement("div",{className:I.entityTextContainer},c.createElement(o.m,{content:e.text,relationship:"label",positioning:"below",withArrow:!0},c.createElement(a.N,{href:e.url,target:"_blank",tabIndex:0,className:I.entityLink,onClick:function(){null==m||m(u.A.FILE_LINK_CLICKED)}},c.createElement(i.V,{className:I.entityText},(0,_.QY)(e.text)))),e.subText?c.createElement(o.m,{content:e.subText,relationship:"label",positioning:"below",withArrow:!0},c.createElement(s.T,{className:I.entitySubText},e.subText)):c.createElement(s.T,{className:I.entitySubText},e.subText)),c.createElement(d.K,{entity:e,suggestedPrompts:C,entityStyles:I,logRelatedFilesTriedEvents:m})))}))))},C=function(e){return c.createElement(h,g({},e))}},384761:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>r}),function(e){e.FILE_LINK_CLICKED="file_link_clicked",e.SUGGESTED_PROMPTS_CLICKED="suggested_prompts_clicked"}(r||(r={}))},400934:(e,t,n)=>{"use strict";n.d(t,{QJ:()=>r,Yw:()=>v,eS:()=>m,mR:()=>g});var r,o=n(857835),a=n(722603),i=n(932554),s=n(602061),c=n(778027),l=n(190202),u=n(124857);!function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(r||(r={}));var d=[{wordPrimaryBackgroundColor:"#FFFFFF",sdxPrimaryBackgroundColor:"#F5F5F5",sdxTheme:s.GmK.defaultWhite},{wordPrimaryBackgroundColor:"#1B1A19",sdxPrimaryBackgroundColor:"#292827",sdxTheme:s.GmK.defaultBlack},{wordPrimaryBackgroundColor:"#f0f0f0",sdxPrimaryBackgroundColor:"#292827",sdxTheme:s.GmK.defaultBlack},{wordPrimaryBackgroundColor:"#323232",sdxPrimaryBackgroundColor:"#323232",sdxTheme:s.GmK.defaultBlack}],_=[{wordPrimaryBackgroundColor:"#FFFFFF",sdxPrimaryBackgroundColor:"#F0F0F0",sdxBackstagePrimaryBkgColor:"#F5F5F5",sdxTheme:s.GmK.defaultWhite},{wordPrimaryBackgroundColor:"#262626",sdxPrimaryBackgroundColor:"#0a0a0a",sdxBackstagePrimaryBkgColor:"#141414",sdxTheme:s.GmK.defaultBlack},{wordPrimaryBackgroundColor:"#666666",sdxPrimaryBackgroundColor:"#525252",sdxBackstagePrimaryBkgColor:"#525252",sdxTheme:s.GmK.defaultBlack}],p=[{wordPrimaryBackgroundColor:"#ffffff",sdxPrimaryBackgroundColor:"#F5F5F5",sdxTheme:s.GmK.defaultWhite},{wordPrimaryBackgroundColor:"#000000",sdxPrimaryBackgroundColor:"#141414",sdxTheme:s.GmK.defaultBlack}],g=function(e,t){var n,r,o=(0,c.dD)()?p.find((function(t){return t.wordPrimaryBackgroundColor.toLowerCase()===(null==e?void 0:e.toLowerCase())})):a.i.isWin32Platform()?_.find((function(t){return t.wordPrimaryBackgroundColor.toLowerCase()===(null==e?void 0:e.toLowerCase())})):d.find((function(t){return t.wordPrimaryBackgroundColor.toLowerCase()===(null==e?void 0:e.toLowerCase())}));if((0,l.N_)(null!==(n=null==o?void 0:o.sdxTheme)&&void 0!==n?n:s.GmK.defaultWhite),t){var u,g,h,C=(0,i.So)()?null!==(g=null!==(u=null==o?void 0:o.sdxBackstagePrimaryBkgColor)&&void 0!==u?u:null==o?void 0:o.sdxPrimaryBackgroundColor)&&void 0!==g?g:"#F5F5F5":null!==(h=null==o?void 0:o.sdxPrimaryBackgroundColor)&&void 0!==h?h:"#F5F5F5";f(C)}return null!==(r=null==o?void 0:o.sdxTheme)&&void 0!==r?r:s.GmK.defaultWhite},f=function(e){document.body.style.backgroundColor=e},h={themePrimary:"#598FEC",themeSecondary:"#8763c2",themeLight:"#0E336A",themeDark:"#464FEB",themeTertiary:"#598FEC",themeDarker:"#353696",themeMedium:"#464FEB",themeDarkAlt:"#3D91FF",themeLighterAlt:"#6CEBE2",themeLighter:"#9270FF",neutralPrimary:"#FFFFFF",neutralLight:"#292929",neutralLighter:"#757575",neutralLighterAlt:"#666666",neutralSecondaryAlt:"#FFFFFF",neutralTertiary:"#3D3D3D",neutralTertiaryAlt:"#3D3D3D",neutralQuaternaryAlt:"#FFFFFF",neutralDark:"#2461CA",black:"#FFFFFF",white:"#000000"},C={themePrimary:"#185abd",themeSecondary:"#8763c2",themeLight:"#D2E0F4",themeDark:"#82ABF1",themeTertiary:"#598FEC",themeDarker:"#598FEC",themeMedium:"#82ABF1",themeDarkAlt:"#3D91FF",themeLighterAlt:"#6CEBE2",themeLighter:"#9270FF",neutralLighter:"#f5f5f5",neutralDark:"#1651AA",white:"#FFFFFF"},m=function(e,t){var n=e!==s.GmK.defaultWhite?(0,o._)({isDarkModeEnabled:!0,isHighContrastModeEnabled:t},h):(0,o._)({isDarkModeEnabled:!1,isHighContrastModeEnabled:t},C);return n.dir=(0,u.xt)()?"rtl":"ltr",n},v={10:"#071225",20:"#0C2145",30:"#0E336A",40:"#19428A",50:"#13458F",60:"#1651AA",70:"#2461CA",80:"#185ABD",90:"#2E6AC5",100:"#296AC5",110:"#3D7CE8",120:"#598FEC",130:"#6794D7",140:"#82ABF1",150:"#AEC6EB",160:"#D2E0F4"}},403162:(e,t,n)=>{"use strict";n.d(t,{p:()=>R,V:()=>w});var r=n(811912),o=n(791165),a=n(990813),i=n(107182),s=n(4026),c=n(28515),l=n(689265),u=n(602061),d=n(504105),_=n(111246),p=n(769449),g=n(740389),f=n(457476),h=n(45512),C=n(448397),m=n(140889),v=n(656904),E=n(932554),y=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"isApplicable",value:function(e){return!0}}],[{key:"getContext",value:function(e){var t,n,r;return JSON.parse(null!==(r=null!==(n=null===(t=e.properties)||void 0===t?void 0:t.context)&&void 0!==n?n:e.context)&&void 0!==r?r:"{}")}}]),e}(),b=function(e){(0,i._)(n,e);var t=(0,s._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"execute",value:function(e,t){var n;(null===(n=t.query)||void 0===n?void 0:n.trim())?t.manualSendPrompt?(_.$.getInstance().setInputAreaText(t.query),_.$.getInstance().setInputFocus()):(R.getInstance().autoExecuteQuery(t.query),_.$.getInstance().startLoadingUi()):_.$.getInstance().setInputFocus()}}]),n}(y),T=function(e){(0,i._)(n,e);var t=(0,s._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"isApplicable",value:function(e){return!!e.attachSelectionFromCanvas}},{key:"execute",value:function(e,t){(0,f.A_)().then((function(e){var t;e.isValid&&_.$.getInstance().updateAttachmentList([e]),C.B.getInstance().sendChatEventTelemetry((0,p.pN)((t={},(0,a._)(t,m.jr.PolarisEntryPointObjectTypes,JSON.stringify(e.objects)),(0,a._)(t,m.jr.PolarisEntryPointIsValidSelection,e.isValid),t)))}))}}]),n}(y),I=function(e){(0,i._)(n,e);var t=(0,s._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"isApplicable",value:function(e){return e.suggestedQueries&&Array.isArray(e.suggestedQueries)&&e.suggestedQueries.length>0}},{key:"execute",value:function(e,t){_.$.getInstance().setPillTexts(e.suggestedQueries,{featureName:null==e?void 0:e.featureName})}}]),n}(y),P=n(249002),A=n(231006),D=function(e){(0,i._)(n,e);var t=(0,s._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"isApplicable",value:function(e){return!!e.submitPrompt}},{key:"execute",value:function(e,t){var n=e.submitPrompt;n.startsWith("@")&&(n=this.getPredefinedPrompt(n)),_.$.getInstance().submitUserQuery(e.promptParameters?(0,P.JT)(n,e.promptParameters):n)}},{key:"getPredefinedPrompt",value:function(e){switch(e){case"@summary":return(0,A.$w)();case"@podcast":return(0,A.v1)();case"@describeImage":return(0,A.iV)();default:throw new Error("Unknown predefined prompt '".concat(e,"'."))}}}]),n}(y),S=n(743032),M=n(379490),O=function(e){(0,i._)(n,e);var t=(0,s._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"isApplicable",value:function(e){return!!e.comprehendSelection}},{key:"execute",value:function(e,t){var n=this;return(0,S._)((function(){var t,r;return(0,M.__generator)(this,(function(o){switch(o.label){case 0:return t="",[4,Word.run((a=(0,S._)((function(e){var n;return(0,M.__generator)(this,(function(r){switch(r.label){case 0:return n=e.document.getSelection(),e.load(n),[4,e.sync()];case 1:return r.sent(),t=n.text,[2]}}))})),function(e){return a.apply(this,arguments)}))];case 1:return o.sent(),r=(0,P.JT)(n.getPrompt(e.comprehendSelection),[t]),_.$.getInstance().submitUserQuery(r),[2]}var a}))}))()}},{key:"getPrompt",value:function(e){if("ExplainToMe"===e)return(0,A.dJ)();throw new Error("Unknown feature '".concat(e,"'."))}}]),n}(y),k=function(e){(0,i._)(n,e);var t=(0,s._)(n);function n(){return(0,r._)(this,n),t.apply(this,arguments)}return(0,o._)(n,[{key:"isApplicable",value:function(e){return(0,g.g38)()&&e.describeImage}},{key:"execute",value:function(e,t){return(0,S._)((function(){return(0,M.__generator)(this,(function(e){return(0,f.A_)().then((function(e){var n;e.isValid&&(_.$.getInstance().updateAttachmentList([e]),(null==t?void 0:t.manualSendPrompt)||(_.$.getInstance().submitUserQuery((0,A.iV)()),(0,u.d9u)())),C.B.getInstance().sendChatEventTelemetry((0,p.pN)((n={},(0,a._)(n,m.jr.PolarisEntryPointObjectTypes,JSON.stringify(e.objects)),(0,a._)(n,m.jr.PolarisEntryPointIsValidSelection,e.isValid),n)))})),[2]}))}))()}}]),n}(y),L=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,null,[{key:"getActionHandlers",value:function(e){var t=this.WordHandoffActionHandlers.filter((function(t){return t.isApplicable(e)}));return t.push(this.defaultHandler),t}}]),e}();function w(){(0,g.JIK)()&&E.Vv.getSetting(E.zj.HandoffMessage)?E.Vv.remove(E.zj.HandoffMessage):E.Vv.remove(E.zj.handoffMessage)}(0,a._)(L,"WordHandoffActionHandlers",[new O,new k,new I,new T,new D]),(0,a._)(L,"defaultHandler",new b);var R=function(e){(0,i._)(n,e);var t=(0,s._)(n);function n(){return(0,r._)(this,n),t.call(this,new d.p,C.B.getInstance())}return(0,o._)(n,[{key:"getHandoffMessageIdSignal",value:function(e,t,n){return new l.hs({queryId:e,handOffMessageId:t,handoffOperation:n})}},{key:"isHandoffAutoSubmitPromptsEnabled",value:function(){return(0,g.cWQ)()}},{key:"processHandoffMessage",value:function(e){try{if((0,g.W4o)()){var t=y.getContext(e),n=L.getActionHandlers(t),r=[],o=!0,i=!1,s=void 0;try{for(var c,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=c.value;try{u.execute(t,e)}catch(e){r.push(e)}}}catch(e){i=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw s}}if(r.length>0)throw new Error("One or more errors encountered while processing handoffMessage. Count: ".concat(r.length))}else this.processHandoffMessage_Legacy(e)}catch(e){var d;C.B.getInstance().sendChatEventTelemetry((0,p.pN)((d={},(0,a._)(d,m.h3.ChatEventType,m.Nr.ProcessHandoffMessageError),(0,a._)(d,m.h3.ChatErrorType,v.T__.Client),d)))}finally{(0,p.P_)(e,this.handoffMessageIdRequestSubmitTime)}}},{key:"isEmptyQueryFeature",value:function(e,t){if(!(0,g.ebC)()&&t===c.Cu.GENERATE)return!0;switch(e){case h.D.WordCopilotComposeSelection:case h.D.WordCopilotComposeInsert:case h.D.TellMe:return!0;default:return!1}}},{key:"processHandoffMessage_Legacy",value:function(e){var t,n=e.context?JSON.parse(e.context):void 0;e.query&&0!==e.query.length&&0!==e.query.trim().length||this.isEmptyQueryFeature(null==n?void 0:n.featureName,e.scenarioName)||this.HandoffOperations.onError(u.FcJ.NoQuery),(null==n?void 0:n.attachSelectionFromCanvas)&&(0,f.A_)().then((function(e){var t;e.isValid&&_.$.getInstance().updateAttachmentList([e]),C.B.getInstance().sendChatEventTelemetry((0,p.pN)((t={},(0,a._)(t,m.jr.PolarisEntryPointObjectTypes,JSON.stringify(e.objects)),(0,a._)(t,m.jr.PolarisEntryPointIsValidSelection,e.isValid),t)))}));var r=null==n?void 0:n.suggestedQueries;r&&Array.isArray(r)&&r.length>0&&_.$.getInstance().setPillTexts(r,{featureName:null==n?void 0:n.featureName}),(null===(t=e.query)||void 0===t?void 0:t.trim())?e.manualSendPrompt?(_.$.getInstance().setInputAreaText(e.query),_.$.getInstance().setInputFocus()):(this.autoExecuteQuery(e.query),_.$.getInstance().startLoadingUi()):_.$.getInstance().setInputFocus()}}],[{key:"getInstance",value:function(){return n._instance||(n._instance=new n),n._instance}}]),n}(u.Q6w);(0,a._)(R,"_instance",void 0)},403566:(e,t,n)=>{"use strict";n.d(t,{g:()=>c});var r=n(798050),o=n(208520),a=n(475119),i=n(376951),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)};function c(e,t){var n=(0,o.useState)(),c=n[0],l=n[1],u=(0,o.useState)(r.x.LOADING),d=u[0],_=u[1],p=(0,o.useRef)({queryId:a.u1,querySubmitTime:-1}),g=(0,o.useRef)(!1),f=(0,o.useRef)(!1),h=(0,o.useRef)(void 0),C=(0,o.useRef)(new Set),m=(0,o.useState)((0,a.VS)()),v=m[0],E=m[1],y=(0,o.useCallback)((function(e,n){var o,a;if(_((function(t){if(t===r.x.LOADED)return t;if(t!==r.x.TIMEDOUT&&!f.current||g.current){if(l(e),n)return n}else h.current=e;return t})),C.current.forEach((function(t){return t(e)})),n===r.x.LOADED){var i=null===(o=p.current)||void 0===o?void 0:o.queryId,s=null===(a=p.current)||void 0===a?void 0:a.querySubmitTime;t&&t(i,s,Date.now())}}),[t]),b=(0,o.useCallback)((function(e){E(e)}),[]),T=(0,o.useCallback)((function(){return c?(0,i.F)(s(s({},c),{logRelatedFilesTriedEvents:e})):null}),[c]),I=(0,o.useCallback)((function(e){return C.current.add(e),function(){C.current.delete(e)}}),[]),P=(0,o.useCallback)((function(){return v}),[v]),A=(0,o.useCallback)((function(){return a.Ay}),[]),D=(0,o.useCallback)((function(e){var t,n;g.current=!0,f.current=!1,(null!==(n=null===(t=h.current)||void 0===t?void 0:t.list)&&void 0!==n?n:[]).length>0?(l(h.current),_(r.x.LOADED),h.current=void 0):(_(r.x.LOADING),null==e||e())}),[]);return{getRelatedFilesContent:T,updateRelatedFilesContent:y,updateRelatedFilesTitle:b,relatedFilesContentState:d,subscribeToRelatedFilesContentUpdate:I,getRelatedFilesTabTitle:P,getRelatedFilesTabValue:A,getRelatedFilesTabType:function(){return r.E.RELATEDFILES},setQueryMetadata:function(e,t){p.current={queryId:e,querySubmitTime:t}},getQueryId:function(){var e;return null===(e=p.current)||void 0===e?void 0:e.queryId},isRelatedFilesCardQueryId:function(e){return p.current.queryId===e},onRetry:D,onTimeout:(0,o.useCallback)((function(){_(r.x.TIMEDOUT),g.current=!1,f.current=!0}),[])}}},404516:(e,t,n)=>{"use strict";n.d(t,{P:()=>c});var r=n(217425),o=n(764081),a=n(475119),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(){function e(e){this.clientInfo=e,this.initialized=!1}return e.prototype.initialize=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.initialized?[2]:[4,this.loadMsalBrowser()];case 1:return e.sent(),this.createMsalInstances(),this.initialized=!0,[2]}}))}))},e.prototype.getMsalModule=function(){if(!this.msalModule)throw new Error("MSAL module not loaded");return this.msalModule},e.prototype.getMsalFor1PResources=function(){if(!this.msalFor1PResources)throw new Error("MSAL 1P instance not initialized");return this.msalFor1PResources},e.prototype.getMsalFor3PResources=function(){if(!this.msalFor3PResources)throw new Error("MSAL 3P instance not initialized");return this.msalFor3PResources},e.prototype.initializeMsalInstances=function(){return i(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return e=this.getMsalFor1PResources(),t=this.getMsalFor3PResources(),[4,e.initialize()];case 1:return n.sent(),[4,t.initialize()];case 2:return n.sent(),[2]}}))}))},e.prototype.loadMsalBrowser=function(){return i(this,void 0,void 0,(function(){var e,t,r;return s(this,(function(o){switch(o.label){case 0:e=1,o.label=1;case 1:if(!(e<=3))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),t=this,[4,n.e(717).then(n.bind(n,719072))];case 3:return t.msalModule=o.sent(),[2];case 4:if(r=o.sent(),(0,a.cY)("Attempt ".concat(e," to load @azure/msal-browser failed:"),r),3===e)throw r;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.createMsalInstances=function(){if(!this.msalModule)throw new Error("MSAL module not loaded");this.msalFor1PResources=this.createPublicClientApplication(this.msalModule.PublicClientApplication,o.pL),this.msalFor3PResources=this.createPublicClientApplication(this.msalModule.PublicClientApplication,a.qA)},e.prototype.createPublicClientApplication=function(e,t){var n,o=null!==(n=this.clientInfo.redirectUri)&&void 0!==n?n:"";return new e({auth:{clientId:t,authority:r.mr,redirectUri:new URL(o,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})},e}()},407039:(e,t,n)=>{"use strict";n.d(t,{s:()=>_});var r=n(811912),o=n(791165),a=n(990813),i=n(242154),s=n(992950),c=n(140889),l=n(249002),u=n(448397),d=n(769449),_=function(){function e(){(0,r._)(this,e),(0,a._)(this,"skillName",void 0),this.skillName=s.B.Unset}return(0,o._)(e,[{key:"resetData",value:function(){this.skillName=s.B.Unset}},{key:"setSkillName",value:function(e){var t;this.skillName!==e&&(u.B.getInstance().sendChatEventTelemetry((0,d.pN)((t={},(0,a._)(t,c.h3.ChatEventType,c.a5.ChatIntentDetected),(0,a._)(t,c.h3.ChatEventParameters,e),t))),(0,i.cY)("Skill name set: ".concat(e)),this.skillName=e)}},{key:"getSkillName",value:function(){return this.skillName}}],[{key:"getInstance",value:function(){return(0,l.hX)(e.SkillHandler)&&(e.SkillHandler=new e),e.SkillHandler}}]),e}();(0,a._)(_,"SkillHandler",void 0)},412488:(e,t,n)=>{"use strict";n.d(t,{j:()=>s});var r=n(857835),o=n(461838),a=n(208520),i=a.lazy((function(){return Promise.all([n.e(3062),n.e(9037),n.e(3341),n.e(1713)]).then(n.bind(n,155413)).then((function(e){return{default:e.PodcastVoicePage}}))})),s=function(e,t,n){return{PodcastVoicePageUI:function(s){return a.createElement(a.Suspense,{fallback:a.createElement("div",null,"Loading...")},a.createElement(i,(0,o._)((0,r._)({},s),{realtimeVoiceCommunicationHandler:e,copilotFeatureFlags:t,onClose:n})))}}}},412728:(e,t,n)=>{"use strict";n.d(t,{Mp:()=>r.Mp,NG:()=>r.NG,p7:()=>r.p7});var r=n(556165)},423905:(e,t,n)=>{"use strict";n.d(t,{A9:()=>C,AQ:()=>h,CI:()=>b,Dl:()=>_,IT:()=>E,Pb:()=>p,Wx:()=>f,YI:()=>v,Zy:()=>u,d9:()=>g,d_:()=>I,jC:()=>A,js:()=>P,mQ:()=>l,pN:()=>d,ys:()=>T,zq:()=>m});var r=n(83437),o=n(660606),a=(n(956933),n(426689)),i=n(475119),s=n(462610),c=function(){var e=0,t=n(956775);if(void 0!==(null==t?void 0:t.querySubmitTime))return e=t.querySubmitTime;var r=n(5489);return void 0!==(null==r?void 0:r.querySubmitTime)?e=r.querySubmitTime:e},l=function(e,t,n){var a;o.EG.sendErrorTelemetry(d(((a={})[r.IC.ErrorMessage]="".concat(e),a[r.IC.ErrorCategory]=r.S2.CLP,a[r.IC.ErrorCode]=t,a[r.IC.ErrorStack]=n,a)))},u=function(e){var t;o.EG.sendChatEventTelemetry(d(((t={})[r.h3.ChatEventType]=r.a5.OfficeJsApiCallForCLP,t[r.h3.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},d=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};function _(){var e;o.EG.sendChatEventTelemetry(d(((e={})[r.h3.ChatEventType]=r.a5.SummaryFromNudgeTriggered,e)))}function p(){var e;o.EG.sendChatEventTelemetry(d(((e={})[r.h3.ChatEventType]=r.a5.PodcastFromNudgeTriggered,e)))}function g(){var e;o.EG.sendChatEventTelemetry(d(((e={})[r.h3.ChatEventType]=r.a5.DescribeImageFromNudgeTriggered,e)))}var f=function(e){var t;o.EG.sendChatEventTelemetry(d(((t={})[r.h3.ChatEventType]=r.a5.ErrorBoundaryCaughtError,t[r.h3.ChatEventParameters]=e,t))),y({vetoName:b(r.kD.UnclearIntent,r.G8.UnclassifiedError),errorString:r.av.UnexpectedFailure,featureName:r.CC.CopilotChat})},h=function(e,t,n,c,l,u){var _,p;t&&""!==t&&o.EG.sendChatEventTelemetry(d(((_={})[r.h3.ChatEventType]=t,_[r.h3.ChatEventParameters]=n||"",_[r.h3.ChatErrorType]=c||"",_)));var g=s.zF.getInstance().shouldConsiderPersonalizationHITLUserInteractionLatency()?s.zF.getInstance().getPersonalizationHITLUserInteractionTime():0;o.EG.sendLatencyTelemetry(d(((p={})[r.CT.UserPerceivedLatency]=(0,a.W)(e)-g,p[r.CT.IsQuerySuccess]=void 0===t,p[r.CT.ErrorType]=c||"",p[r.CT.ErrorParameter]=(!0===l?t:n)||"",p[r.CT.ErrorChatEventType]=t&&""!==t?t:"",p[r.CT.ErrorChatEventParameter]=t&&""!==t&&n||"",p)),null==u||u),o.EG.setQueryGuid(i.u1),s.zF.getInstance().resetPersonalizationLatencyState()},C=function(e,t){return(0,i.Px)(e,t)},m=function(e){var t={};try{t=JSON.parse(e)}catch(e){(0,o.cY)("Error parsing telemetry data ",e.message)}return t},v=function(e){return e||(e=r.CC.CopilotChat),JSON.stringify({featureName:e})};function E(e,t,n){var i,s;void 0===n&&(n=!0);var l={};if(t){o.EG.sendChatEventTelemetry(d(((i={})[r.h3.ChatEventType]=t.chatEventType,i[r.h3.ChatEventParameters]=t.chatEventParam,i[r.h3.ChatErrorType]=t.chatErrorType,i))),(s={})[r.CT.ErrorType]=r.T_.Client,s[r.CT.ErrorParameter]=t.chatEventType,s[r.CT.ErrorChatEventType]=t.chatEventType,s[r.CT.ErrorChatEventParameter]=t.chatEventParam,l=s;var u=t.ashaErrorDetails;u&&y(u)}e&&((0,o.cY)("User Perceived Latency :  ".concat((0,a.W)(c())," sec")),l[r.CT.UserPerceivedLatency]=(0,a.W)(c()),l[r.CT.IsQuerySuccess]=!1,o.EG.sendLatencyTelemetry(d(l),n))}function y(e){o.EG.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function b(e,t){return e+" "+t}var T=function(e){var t;o.EG.sendChatEventTelemetry(d(((t={})[r.h3.ChatEventType]=r.a5.ApiPluginDataReceived,t[r.h3.ChatEventParameters]=e.toString(),t)))},I=function(e){var t;o.EG.sendChatEventTelemetry(d(((t={})[r.h3.ChatEventType]=r.a5.MsgExtDataReceived,t[r.h3.ChatEventParameters]=e.toString(),t)))},P=function(e,t,n){var a;o.EG.sendLatencyTelemetry(d(((a={})[r.CT.FeatureName]="ExtensibilityDialogLoad",a[r.CT.UserPerceivedLatency]=e,a[r.CT.IsQuerySuccess]=t,a[r.CT.ErrorChatEventType]=t?"":r.a5.ExtensibilityDialogLoad,a[r.CT.ErrorChatEventParameter]=t?"":n,a)),!0)},A=function(e){var t;o.EG.sendErrorTelemetry(d(((t={})[r.IC.ErrorMessage]=e,t[r.IC.ErrorCategory]=r.S2.ExtensibilityDialog,t[r.IC.ErrorCode]="ExtensibilityDialogLoadError",t)))}},425842:(e,t,n)=>{"use strict";n.d(t,{t:()=>r.A});var r=n(863958)},426689:(e,t,n)=>{"use strict";n.d(t,{W:()=>r,x:()=>o});var r=function(e){return o(e)/1e3},o=function(e){return(new Date).getTime()-e}},427537:(e,t,n)=>{"use strict";n.d(t,{$:()=>c});var r=n(83437),o=n(423905),a=n(475119),i=n(822606),s=n(185088),c=function(e,t,n){var c,l,u;void 0===n&&(n=i.u1);var d,_=e.category,p=e.message,g=null!==(l=e.json)&&void 0!==l?l:i.u1,f=i.u1;try{(0,a.hX)(g)||(d=JSON.parse(g))}catch(e){(0,a.cY)("Exception occured during parsing of json Data for User profile annotation error : ".concat(e))}(0,a.cY)("UserProfile Annotation Error Detected, Category: ".concat(_,", ErrorMessage: ").concat(p,", JsonData: ").concat(g)),void 0!==d&&(f=d.code),a.EG.sendErrorTelemetry((0,o.pN)(((c={})[r.IC.ErrorMessage]="User Profile Annotation Error Detected, Category: ".concat(_,", ErrorCode: ").concat(f),c[r.IC.ErrorCategory]=r.S2.Personalization,c)));var h=r.wV.Unknown,C=r.G8.UnclassifiedError,m=(0,i.de)();switch(_){case a.$m.InvalidSignal:if(f===a.eB.MissingProfileId)h=r.wV.MissingProfileId,C=r.G8.LLMIssue;break;case a.$m.InvalidInput:switch(f){case a.eB.StaleProfileId:h=r.wV.StaleProfileId,C=r.G8.UserInputIssue;break;case a.eB.NotSupportedProfileOperation:h=r.wV.NotSupportedProfileOperation,C=r.G8.UnsupportedFunctionality;break;case a.eB.InvalidUserQuery:h=r.wV.InvalidUserQuery,C=r.G8.UserInputIssue}break;case a.$m.RoamingServiceError:switch(f){case a.eB.FailedToRead:h=r.wV.FailedToRead,C=r.G8.LLMIssue;break;case a.eB.FailedToWrite:h=r.wV.FailedToWrite,C=r.G8.LLMIssue;break;case a.eB.UninitializedUserStoreEntities:h=r.wV.UninitializedUserStoreEntities,C=r.G8.LLMIssue;break;case a.eB.UndefinedUserStoreEntities:h=r.wV.UndefinedUserStoreEntities,C=r.G8.LLMIssue}break;case a.$m.OpenAITextClientError:case a.$m.OpenAIChatClientError:switch(f){case a.eB.BadResponse:h=r.wV.BadResponse,C=r.G8.LLMIssue;break;case a.eB.Timeout:h=r.wV.Timeout,C=r.G8.TimedOut;break;case a.eB.Throttled:h=r.wV.Throttled,C=r.G8.CapacityIssue;break;case a.eB.UserThrottled:h=r.wV.UserThrottled,C=r.G8.CapacityIssue;break;case a.eB.ScenarioThrottled:h=r.wV.ScenarioThrottled,C=r.G8.CapacityIssue;break;case a.eB.Token:h=r.wV.Token,C=r.G8.UserAccessIssue;break;case a.eB.Unknown:h=r.wV.Unknown,C=r.G8.UnclassifiedError;break;case a.eB.NotAvailable:h=r.wV.NotAvailable,C=r.G8.LLMIssue;break;case a.eB.EmptyResponse:h=r.wV.EmptyResponse,C=r.G8.LLMIssue}break;case a.$m.SkillExecutionError:switch(f){case a.eB.Unknown:h=r.wV.SkillFailed,C=r.G8.LLMIssue;break;case a.eB.NotAvailable:h=r.wV.IncorrectServiceResponse,C=r.G8.LLMIssue}}var v={errorType:"".concat(_,"-").concat(f),featureName:r.CC.Customize,errorMessage:m,subFeatureName:r.Ff.PersonalizationUserProfile};null===(u=t.current)||void 0===u||u.addResponseMessage((0,s.hk)(m,v,n));var E=(0,o.A9)(r.kD.Customize,C);return(0,a.hX)(a.EG.logAshaErrorEvent)||a.EG.logAshaErrorEvent(E,h,r.CC.Customize),f}},432874:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var r=n(638753),o=function(e,t,n){var o,a,i,s;return!!(null===(a=null===(o=null==e?void 0:e.chatResponse)||void 0===o?void 0:o.messages)||void 0===a?void 0:a.find((function(e){return(0,r._H)(e)})))&&(!!t&&(!!n||(null===(s=null===(i=null==e?void 0:e.chatResponse)||void 0===i?void 0:i.messages)||void 0===s?void 0:s.find((function(e){return((null==e?void 0:e.gptIdentifiers)||[]).length>0})))))}},437408:(e,t,n)=>{"use strict";n.d(t,{e9:()=>d,r4:()=>_,wC:()=>u,yS:()=>p});var r=n(990813),o=n(740389),a=n(249002),i=n(140889),s=n(661218),c=n(965974);function l(e){var t=e.telemetryEventHandler,n=e.telemetryLogger,o=e.commands,s=e.error,c=e.scenario,l=e.TranspilationLatencyMSec,u=e.success,d=e.message;if(!(0,a.hX)(t)){var _=0,p=!0,g=!1,f=void 0;try{for(var h,C=o[Symbol.iterator]();!(p=(h=C.next()).done);p=!0){var m,v=h.value,E=!(0,a.hX)(c)&&v in c?c[v]:"None";t.updateTelemetryCommandingData((m={},(0,r._)(m,i.S9.EventOrder,_),(0,r._)(m,i.S9.CommandName,v),(0,r._)(m,i.S9.Status,i.lK.Executed),(0,r._)(m,i.S9.IsCommandSuccess,!1),(0,r._)(m,i.S9.IsCommandSuccessString,u?"true":"false"),(0,r._)(m,i.S9.ErrorCategory,s),(0,r._)(m,i.S9.Scenario,E),(0,r._)(m,i.S9.ScenarioString,E),(0,r._)(m,i.S9.Message,d||""),(0,r._)(m,i.S9.TranspilationLatencyMSec,l||0),m),n),++_}}catch(e){g=!0,f=e}finally{try{p||null==C.return||C.return()}finally{if(g)throw f}}}}function u(e,t,n,r,i,s){(0,o.uPJ)()&&((0,a.hX)(e)||l({telemetryEventHandler:e,telemetryLogger:t,commands:n,error:r,scenario:i,success:!1,message:s}))}function d(e,t,n,r,s,c){(0,o.uPJ)()&&((0,a.hX)(e)||l({telemetryEventHandler:e,telemetryLogger:t,commands:n,error:s?i.by.PartialSuccess:i.by.None,scenario:r,success:!0,TranspilationLatencyMSec:c}))}function _(e,t,n){var a;(0,o.uPJ)()&&e.updateTelemetryCommandingData((a={},(0,r._)(a,i.S9.EventOrder,t),(0,r._)(a,i.S9.CommandName,n),(0,r._)(a,i.S9.Status,i.lK.Initialize),(0,r._)(a,i.S9.IsCommandSuccessString,"false"),(0,r._)(a,i.S9.ErrorCategory,i.by.None),(0,r._)(a,i.S9.ScenarioString,"None"),a))}var p=function(e,t,n){if((0,o.Zhy)()){var r=[],a={},l=c.M.getInstance(),_=s.E.getInstance();if(null!=e&&"function"==typeof e[Symbol.iterator]){var p=!0,g=!1,f=void 0;try{for(var h,C=e[Symbol.iterator]();!(p=(h=C.next()).done);p=!0){var m=h.value,v=m.name;r.push(v);var E="";for(var y in m.arguments)(0,o.uPJ)()&&"textRanges"!==y&&"comments"!==y&&"context"!==y&&(E+=y+",");a[v]=E.slice(0,-1)}}catch(e){g=!0,f=e}finally{try{p||null==C.return||C.return()}finally{if(g)throw f}}}else r.push("NoCommand");t?d(_,l,r,a):u(_,l,r,i.by.Failed,a,n)}}},441752:(e,t,n)=>{"use strict";n.d(t,{P:()=>f});var r,o=n(743032),a=n(379490),i=n(722603),s=n(784567),c=n(641002),l=n(567179),u=n(934189),d=n(61714),_=n(249002),p=n(844807),g=n(758651),f=(r=(0,o._)((function(e,t,n){var r,o,f,h,C;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return t(),e("comprehension"),[4,i.i.getDocumentUrlAsync()];case 1:r=a.sent(),g.log("current documentURL:",r),o=new c.i({query:"",queryId:(0,d.A)(),requestType:l.d2.PODCAST_CREATION,clientRequest:{chatInput:"",chatInputType:l.RS.GENERATE_PODCAST,requestPayload:JSON.stringify({contentFormat:"html",voiceIds:(0,_.ZN)(),fileUrls:[r],voiceNames:(0,_.oX)(),isStreaming:!0})}}),f=new s.g0({parentPath:["Signal",c.i.getTypeName()],items:[{id:p.r.generateId(),body:o}]}),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,null===(h=n.current)||void 0===h?void 0:h.submitOperation({operation:f,workflowAnnotationType:u.H6.getTypeName()})];case 3:return a.sent(),[2,!0];case 4:return C=a.sent(),g.error("Error submitting operation:",C),[2,!1];case 5:return[2]}}))})),function(e,t,n){return r.apply(this,arguments)})},442567:(e,t,n)=>{"use strict";n.d(t,{Eb:()=>o.Eb,Q9:()=>o.Q9,Tz:()=>r.T,Yw:()=>o.Yw,Zj:()=>o.qH,aW:()=>a.aW,d9:()=>o.d9,n6:()=>i.n,ro:()=>a.ro,yu:()=>o.yu});var r=n(116510),o=n(956933),a=n(755657),i=n(881707)},444689:(e,t,n)=>{"use strict";n.d(t,{Jx:()=>s,RN:()=>r,nC:()=>i});var r,o=n(798050),a=function(){return a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};!function(e){e.AnnotationReceived="annotationReceived",e.ContentUpdated="contentUpdated",e.RequestTimedOut="requestTimedOut"}(r||(r={}));var i={cardProps:{markdownText:"",json:null,styles:{}},cardState:o.x.LOADING};function s(e,t){var n,i;switch(t.type){case r.AnnotationReceived:var s=null!==(n=t.markdownText)&&void 0!==n?n:e.cardProps.markdownText;return{cardProps:a(a({},e.cardProps),{markdownText:s,json:t.json}),cardState:t.cardState};case r.ContentUpdated:return{cardProps:a(a({},e.cardProps),t.props),cardState:null!==(i=t.cardState)&&void 0!==i?i:e.cardState};case r.RequestTimedOut:return a(a({},e),{cardState:o.x.TIMEDOUT});default:return e}}},448397:(e,t,n)=>{"use strict";n.d(t,{B:()=>A});var r,o=n(720570),a=n(811912),i=n(791165),s=n(990813),c=n(107182),l=n(928499),u=n(4026),d=n(12163),_=n(24784),p=n(656904),g=n(140889),f=n(309964),h=n(956775),C=n(965974),m=n(249002),v=n(740389),E=n(598309),y=n(862853),b=n(602061),T=n(769449),I=n(822446),P=n(932554);!function(e){e.Seen="Seen",e.Tried="Tried"}(r||(r={}));var A=function(e){(0,c._)(n,e);var t=(0,u._)(n);function n(){var e;return(0,a._)(this,n),e=t.call(this),(0,s._)((0,o._)(e),"telemetryLogger",void 0),(0,s._)((0,o._)(e),"telemetryLoggerUtils",void 0),(0,s._)((0,o._)(e),"telemetryLatencyObject",void 0),(0,s._)((0,o._)(e),"telemetryChatEventObject",void 0),(0,s._)((0,o._)(e),"chatHistoryLog",[]),(0,s._)((0,o._)(e),"userQueryGuid",""),(0,s._)((0,o._)(e),"checkPoints",void 0),(0,s._)((0,o._)(e),"checkPointStartTime",void 0),(0,s._)((0,o._)(e),"initialHandoffQuery",void 0),(0,s._)((0,o._)(e),"heldTelemetryEvents",[]),(0,s._)((0,o._)(e),"heldStkTelemetryEvents",[]),e.telemetryLogger=C.M.getInstance(),e.telemetryLoggerUtils=h.TelemetryLoggerUtils.getInstance(),e.telemetryLoggerUtils.setTelemetryHandler(n.instance),e.telemetryLatencyObject={},e.telemetryChatEventObject={},e.userQueryGuid="",e.checkPoints={},e.checkPointStartTime=0,e.initializeCheckPoint(),e}return(0,i._)(n,[{key:"initializeCheckPoint",value:function(){if(this.recordCheckPoint(g._R.TaskPaneStart,Number(I.taskPaneStartTime)),this.recordCheckPoint(g._R.AppLoadStart,Number(I.appEntryPointTime)),(0,v.khs)()){var e=P.Vv.getSetting(P.zj.AppStartTimestamp);e&&this.recordCheckPoint(g._R.AppStart,e);var t=P.Vv.getSetting(P.zj.CopilotPaneStartTimestamp);t&&this.recordCheckPoint(g._R.CopilotPaneStart,t)}}},{key:"getDataFields",value:function(e){return e.map((function(e){return"number"==typeof e.value?d.ip(e.key,e.value):"string"==typeof e.value?d.m9(e.key,e.value):"boolean"==typeof e.value?d.LK(e.key,e.value):d.m9(e.key,e.value)}),[])}},{key:"getCopilotScorecardData",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.CC.CopilotChat,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],s=arguments.length>6?arguments[6]:void 0;return i=i.concat((0,l._)(_.TA.getFields({featureActionType:e,isUserInitiated:!0,capability:_.TA.Capability[t],verb:(0,m.hX)(o)?"":_.TA.Verb[o],featureName:r,subFeatureName:(0,m.hX)(a)?"":a,entryPoint:(0,E.w9)()?_.TA.EntryPoint.Backstage:_.TA.EntryPoint.Chat,isThumbsUp:(0,m.hX)(s)?void 0:s}))),(null===(n=this.userQueryGuid)||void 0===n?void 0:n.length)>0&&!i.some((function(e){return e.name===g.qN&&e.value}))?i=i.concat(this.getDataFields([{key:g.qN,value:this.userQueryGuid}])):i.find((function(e){return e.name===g.qN&&e.value}))||(i=i.concat(this.getDataFields([{key:g.qN,value:h.userQueryGuid}]))),new h.TelemetryLog(f.S2.Chat,f.lr.Chat,i,r,t,o,!0,!0,f.uk.CP_DATA_CATEGORY_PRODUCT_SERVICE_USAGE,f.PM.CP_DIAGNOSTIC_LEVEL_REQUIRED_SERVICE_DATA)}},{key:"logSharedTelemetrySTKEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];I.isSDXRenderingForPreload?this.heldStkTelemetryEvents.push({telemetryLog:e,isSeen:t}):this.telemetryLogger.logSharedTelemetrySTKEvent(e,t)}},{key:"updateTelemetryOnAnnotationReceived",value:function(e,t,n,r,o,a,i){(0,T.G4)(e,t,o,a,void 0,void 0,void 0,i)}},{key:"releaseHeldTelemetryEvents",value:function(){var e=this;this.heldTelemetryEvents.forEach((function(t){var n=t.eventType,r=t.telemetryData,o=t.entryPoint,a=t.featureName,i=t.capability,s=t.isThumbsUp,c=t.verb,l=t.subFeatureName;"Seen"===n?e.telemetryLoggerUtils.logSeenEvent(r,o,a,i,c,l):"Tried"===n&&e.telemetryLoggerUtils.logTriedEvent(r,o,a,i,s,c,l)})),this.heldStkTelemetryEvents.forEach((function(t){var n=t.telemetryLog,r=t.isSeen;e.telemetryLogger.logSharedTelemetrySTKEvent(n,r)})),this.heldTelemetryEvents=[],this.heldStkTelemetryEvents=[]}},{key:"logSeenEvent",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.CC.CopilotChat,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&((a=a||[]).some((function(e){return e.key===g.qN&&e.value}))||a.push({key:g.qN,value:this.userQueryGuid})),I.isSDXRenderingForPreload?this.heldTelemetryEvents.push({eventType:"Seen",telemetryData:a,entryPoint:(0,E.w9)()?_.TA.EntryPoint.Backstage:_.TA.EntryPoint.Chat,featureName:n,capability:e,verb:r,subFeatureName:o}):this.telemetryLoggerUtils.logSeenEvent(a,(0,E.w9)()?_.TA.EntryPoint.Backstage:_.TA.EntryPoint.Chat,n,e,r,o)}},{key:"logTriedEvent",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.CC.CopilotChat,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&((a=a||[]).some((function(e){return e.key===g.qN&&e.value}))||a.push({key:g.qN,value:this.userQueryGuid})),I.isSDXRenderingForPreload?this.heldTelemetryEvents.push({eventType:"Seen",telemetryData:a,entryPoint:(0,E.w9)()?_.TA.EntryPoint.Backstage:_.TA.EntryPoint.Chat,featureName:n,capability:e,isThumbsUp:void 0,verb:r,subFeatureName:o}):this.telemetryLoggerUtils.logTriedEvent(a,(0,E.w9)()?_.TA.EntryPoint.Backstage:_.TA.EntryPoint.Chat,n,e,void 0,r,o)}},{key:"logKeptEvent",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g.CC.CopilotChat,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(null===(e=this.userQueryGuid)||void 0===e?void 0:e.length)>0&&((a=a||[]).some((function(e){return e.key===g.qN&&e.value}))||a.push({key:g.qN,value:this.userQueryGuid})),this.telemetryLoggerUtils.logKeptEvent(a,(0,E.w9)()?_.TA.EntryPoint.Backstage:_.TA.EntryPoint.Chat,t,o,void 0,r,n)}},{key:"setQueryGuid",value:function(e){this.userQueryGuid=e}},{key:"getQueryGuid",value:function(){return this.userQueryGuid}},{key:"recordCheckPoint",value:function(e,t){t&&0!==t&&!Number.isNaN(t)||(t=(new Date).getTime()),0===this.checkPointStartTime?(this.checkPointStartTime=t,this.checkPoints[e]=0):this.checkPoints[e]=t-this.checkPointStartTime}},{key:"sendLatencyTelemetryForCheckPoints",value:function(e){var t=JSON.stringify(this.checkPoints);(0,b.cY_)("sendLatencyTelemetryForCheckPoints: ",t),this.sendLatencyTelemetry((0,T.pN)((0,s._)({},g.CT.CheckPoints,t)),e)}},{key:"setInitialHandoffQuery",value:function(e){(0,b.cY_)("setInitialHandoffQuery: ",e),this.initialHandoffQuery=e}},{key:"sendHandoffQuerySubmittedEvent",value:function(e){if(this.initialHandoffQuery){e=e.trim();var t=this.initialHandoffQuery.trim(),r=!(e===t||e.includes(t));(0,b.cY_)("Handoff query is submitted. IsModified: "+r),n.getInstance().sendChatEventTelemetry([{key:g.h3.ChatEventType,value:g.a5.HandoffQuerySubmittedByUser},{key:g.h3.ChatEventParameters,value:"".concat(g.CD.IsModified,":").concat(r)}]),this.initialHandoffQuery=void 0}}},{key:"sendVisibilityModeChangedTelemetry",value:function(e){var t;n.getInstance().sendChatEventTelemetry((0,T.pN)((t={},(0,s._)(t,g.h3.ChatEventType,g.a5.TaskPaneVisibilityModeChanged),(0,s._)(t,g.h3.ChatEventParameters,e),t)))}},{key:"sendChatEventTelemetry",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!e.some((function(e){return e.key===g.qN&&e.value}))&&e.push({key:g.h3.UserQueryGuid,value:this.userQueryGuid}),e.push({key:g.h3.ExtensibilityInfo,value:(0,b.Sdf)((0,b.Ldm)(),(0,b.Gnb)())}),this.telemetryLoggerUtils.sendTelemetryChatEventData(e,n)}},{key:"sendLatencyTelemetry",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!e.some((function(e){return e.key===g.qN&&e.value}))&&e.push({key:g.CT.UserQueryGuid,value:this.userQueryGuid}),e.push({key:g.CT.ExtensibilityInfo,value:(0,b.Sdf)((0,b.Ldm)(),(0,b.Gnb)())}),this.telemetryLoggerUtils.sendTelemetryLatencyData(e,n)}},{key:"sendErrorTelemetry",value:function(e){var t;(null===(t=this.userQueryGuid)||void 0===t?void 0:t.length)>0&&!e.some((function(e){return e.key===g.qN&&e.value}))&&e.push({key:g.qN,value:this.userQueryGuid}),e.push({key:g.IC.ExtensibilityInfo,value:(0,b.Sdf)((0,b.Ldm)(),(0,b.Gnb)())}),this.telemetryLoggerUtils.sendTelemetryErrorData(e)}},{key:"LogTelemetryEvent",value:function(e){var t=this;switch(e.GetEventName()){case f.lr.ChatEvents:if(!e.GetShouldLog()){var n=!0,r=!1,o=void 0;try{for(var a,i=e.GetLogs()[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var s=a.value;s.name!==g.h3.UserQueryGuid&&(this.telemetryChatEventObject[s.name]=s.value)}}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}break}var c;e.SetIsRequired(!0);var u=null!==(c=P.Vv.getSettingAsString(P.zj.AugloopSharedSessionID))&&void 0!==c?c:"ALDummySession";e.SetLogs((0,l._)(e.GetLogs()).concat((0,l._)(this.getDataFields([{key:g.h3.DocSessionID,value:u},{key:g.h3.IsDevBuild,value:p.MYv},{key:g.h3.ExtensibilityInfo,value:(0,b.Sdf)((0,b.Ldm)(),(0,b.Gnb)())}].concat((0,l._)(Object.keys(this.telemetryChatEventObject).map((function(e){return{key:e,value:t.telemetryChatEventObject[e]}})))))))),this.telemetryLogger.logSharedTelemetryEvent(e),this.telemetryChatEventObject={};break;case f.lr.Latency:if(!e.GetShouldLog()){var d=!0,h=!1,C=void 0;try{for(var m,T=e.GetLogs()[Symbol.iterator]();!(d=(m=T.next()).done);d=!0){var I=m.value;I.name===g.CT.CopilotChatHistoryInfoJson?this.chatHistoryLog=this.chatHistoryLog.concat(JSON.parse(I.value)):I.name!==g.h3.UserQueryGuid&&(this.telemetryLatencyObject[I.name]=I.value)}}catch(e){h=!0,C=e}finally{try{d||null==T.return||T.return()}finally{if(h)throw C}}break}e.SetIsRequired(!0),e.SetLogs((0,l._)(e.GetLogs().filter((function(e){return e.name!==g.CT.CopilotChatHistoryInfoJson}))).concat((0,l._)(this.getDataFields([{key:g.CT.CopilotChatHistoryInfoJson,value:JSON.stringify(this.chatHistoryLog)},{key:g.CT.IsDevBuild,value:p.MYv},{key:g.CT.IsFluxEnabled,value:(0,E.cU)((0,y.w5)())},{key:g.CT.ExtensibilityInfo,value:(0,b.Sdf)((0,b.Ldm)(),(0,b.Gnb)())},{key:g.CT.IsLocalAL,value:5===(0,v.geh)()}].concat((0,l._)(Object.keys(this.telemetryLatencyObject).map((function(e){return{key:e,value:t.telemetryLatencyObject[e]}})))))))),(0,v.z$Z)()&&!e.GetLogs().some((function(e){return e.name==g.CT.FeatureName&&!!e.value}))&&e.SetLogs((0,l._)(e.GetLogs()).concat((0,l._)(this.getDataFields([{key:g.CT.FeatureName,value:g.CC.CopilotChat}])))),this.telemetryLogger.logSharedTelemetryEvent(e),this.chatHistoryLog=[],this.telemetryLatencyObject={},this.userQueryGuid="";break;case f.lr.Error:case f.lr.AgentEvents:case f.lr.AgentError:if(!e.GetShouldLog())break;e.SetLogs((0,l._)(e.GetLogs()).concat((0,l._)(this.getDataFields([{key:g.h3.IsDevBuild,value:p.MYv}])),(0,l._)(this.getDataFields([{key:g.IC.ExtensibilityInfo,value:(0,b.Sdf)((0,b.Ldm)(),(0,b.Gnb)())}])))),this.telemetryLogger.logSharedTelemetryEvent(e);break;case f.lr.Chat:if(!e.GetShouldLog())break;if(e.SetIsRequired(!0),e.GetShouldLog()){var A=e.GetLogs().some((function(e){return"Copilot.FeatureActionType"===e.name&&e.value===_.TA.FeatureActionType.IsSeen}));this.logSharedTelemetrySTKEvent(e,A)}break;case f.lr.AshaError:if(!e.GetShouldLog())break;e.SetIsRequired(!0),this.logSharedTelemetrySTKEvent(e)}}},{key:"logAshaErrorEvent",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.CC.CopilotChat,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];(null===(n=this.userQueryGuid)||void 0===n?void 0:n.length)>0&&!a.some((function(e){return e.key===g.qN&&e.value}))&&a.push({key:g.qN,value:this.userQueryGuid}),void 0!==r&&a.push({key:"AshaScenarioName",value:r}),this.telemetryLoggerUtils.logErrorWithAshaVetoAndError(a,r,"",e,t,o)}},{key:"logFeedbackEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g.CC.CopilotChat,r=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;this.LogTelemetryEvent(this.getCopilotScorecardData(p.u1i,t,n,r,o,(a||[]).length>0?this.getDataFields(a):void 0,e))}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n,h.TelemetryLoggerUtils.getInstance().setTelemetryHandler(n.instance)),n.instance}}]),n}(h.TelemetryHandler);(0,s._)(A,"instance",void 0)},448514:(e,t,n)=>{"use strict";n.d(t,{W:()=>r,x:()=>o});var r=function(e){return((new Date).getTime()-e)/1e3},o=function(e){return(new Date).getTime()-e}},448526:(e,t,n)=>{"use strict";n.d(t,{v:()=>c});var r=n(475119),o=n(217425),a=n(632197),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),n=void 0,e instanceof r.jY?[4,e.getToken(null!=t?t:o.w8.graph)]:[3,2];case 1:return n=s.sent(),[3,4];case 2:return[4,e.getToken(null!=t?t:o.w8.graph,"graph")];case 3:n=s.sent(),s.label=4;case 4:return[2,(0,a.t)(n)];case 5:throw i=s.sent(),(0,r.cY)("Error fetching Graph token:",i),i;case 6:return[2]}}))}))}},450501:(e,t,n)=>{"use strict";e.exports=n.p+"assets/mic-permission-dialog.svg"},457236:(e,t,n)=>{"use strict";n.d(t,{Ak:()=>i.A,F9:()=>r.F,gB:()=>o.g,oU:()=>a.o});var r=n(376951),o=n(403566),a=n(946084),i=n(384761)},457476:(e,t,n)=>{"use strict";n.d(t,{os:()=>fe,KV:()=>Pe,CM:()=>Ae,wM:()=>Ie,EM:()=>De,x3:()=>Ke,_u:()=>Te,m4:()=>He,pe:()=>Ne,A_:()=>Se,Re:()=>Qe,n:()=>Je,J6:()=>be,Y6:()=>Ye,Dz:()=>je,D9:()=>Be,v2:()=>Me,S0:()=>Ce,Np:()=>ve,ow:()=>ye,iV:()=>Ee,sZ:()=>xe,DP:()=>ze,hX:()=>te,oj:()=>Le,V1:()=>ke,X8:()=>Oe,A7:()=>ie,iE:()=>Ve,Wu:()=>we,KS:()=>Ue,cd:()=>Re,bD:()=>qe,GM:()=>de,Pi:()=>ce,KY:()=>ne,FN:()=>re,R1:()=>ae,wT:()=>le,pi:()=>ue,hT:()=>We,rX:()=>se,np:()=>_e,qN:()=>Ze});var r,o=n(743032),a=n(811912),i=n(791165),s=n(990813),c=n(857835),l=n(461838),u=n(379490),d=n(57008),_=n(656904),p=n(965801),g=n(844807),f=n(555799),h=n(644275),C=n(243912),m=n(784567),v=n(309964),E=n(354311),y=n(602061),b=n(956775),T=n(140889),I=n(111246),P=n(156845),A=n(722603),D=n(942449),S=n(211475),M=n(934761),O=n(448397),k=n(146931),L=n(689265),w=n(871598),R=n(242154),U=(n(832713),n(997003)),B=n(663279),x=n(769449),W=n(740389),F=n(103218),N=n(304765),K=n(932554),H=n(124857),G=n(249002),Q=n(992950),j=n(407039),Y=n(258005),z=n(86207),q=n(862853),V=n(598309),Z=n(128825),J=n(192318),X=n(497691),$=n(382435);!function(e){e.webUrl="https://fa000000125.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2308.23015/en-us_web/login.html",e.spaUrl="https://fa000000125.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2308.23015/en-us_web/login.html"}(r||(r={}));var ee=n(758651),te=function(e){return null==e};function ne(e,t,n,r,o){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=arguments.length>7?arguments[7]:void 0,u=arguments.length>8?arguments[8]:void 0,d=arguments.length>9?arguments[9]:void 0,p=arguments.length>10?arguments[10]:void 0,g=arguments.length>11?arguments[11]:void 0,m=arguments.length>12?arguments[12]:void 0;(0,R.cY)("Showing error response card");var v=null;n&&(v={text:u||(0,_.tyz)(),linkOnClick:ge,linkUrl:n,linkSuffix:null!=m?m:""});var E=Qe(d,p,g);I.$.getInstance().displayResponse({chatCardType:f._.Default,chatMessageData:{defaultMessageProps:{user:h.Q9.Chat,messageHeader:{text:e,linkText:v}}},chatMessageBodyData:(0,l._)((0,c._)({},Te({showAIGenerated:!1,showAnimation:!0,footerPosition:C.O.Footer,actionButtonList:E,isFailure:!0,contextData:s})),{telemetryData:o?(0,x.YI)(o):void 0}),stopLoadingUi:i,startAugloopTimerForStreaming:!1,addCardToChatHistory:a}),oe(t,r,i)}function re(e,t,n,r,o){var a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];(0,R.cY)("Showing error response card");var s=null;n&&(s={text:(0,_.tyz)(),linkOnClick:ge,linkUrl:n}),I.$.getInstance().displayResponse({chatCardType:f._.Default,chatMessageData:{defaultMessageProps:{user:h.Q9.Chat,messageHeader:{text:e,linkText:s}}},chatMessageBodyData:(0,l._)((0,c._)({},Te({showAIGenerated:!1,showAnimation:!0,footerPosition:C.O.None,isFailure:!0})),{telemetryData:o?(0,x.YI)(o):void 0}),stopLoadingUi:i,startAugloopTimerForStreaming:!1,addCardToChatHistory:a}),oe(t,r,i)}function oe(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r={};if(t){var o,a;O.B.getInstance().sendChatEventTelemetry((0,x.pN)((o={},(0,s._)(o,T.h3.ChatEventType,t.chatEventType),(0,s._)(o,T.h3.ChatEventParameters,t.chatEventParam),(0,s._)(o,T.h3.ChatErrorType,t.chatErrorType),o))),a={},(0,s._)(a,T.CT.ErrorType,_.T__.Client),(0,s._)(a,T.CT.ErrorParameter,t.chatEventType),(0,s._)(a,T.CT.ErrorChatEventType,t.chatEventType),(0,s._)(a,T.CT.ErrorChatEventParameter,t.chatEventParam),r=a;var i=t.ashaErrorDetails;i&&(0,x.W7)(i)}e&&((0,R.cY)("User Perceived Latency :  ".concat((0,y.WUi)(b.querySubmitTime)," sec")),r[T.CT.UserPerceivedLatency]=(0,y.WUi)(b.querySubmitTime),r[T.CT.IsQuerySuccess]=!1,O.B.getInstance().sendLatencyTelemetry((0,x.pN)(r),n))}function ae(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0;te(e)?ee.log("Returning as message is undefined"):(I.$.getInstance().displayResponse({chatCardType:f._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e}},chatMessageBodyData:Te({showAIGenerated:!0,showAnimation:!0,footerPosition:C.O.Footer,contextData:o}),stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!1}),oe(t,n,r))}function ie(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_.T__.Client,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=(e={},(0,s._)(e,T.CT.ErrorType,t),(0,s._)(e,T.CT.ErrorParameter,n),(0,s._)(e,T.CT.ErrorChatEventType,r),(0,s._)(e,T.CT.ErrorChatEventParameter,o),e);O.B.getInstance().sendLatencyTelemetry((0,x.pN)(c),i),a&&(0,x.W7)(a)}function se(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0;(0,R.cY)("Showing response card"),I.$.getInstance().displayResponse({chatCardType:f._.Default,chatMessageData:{defaultMessageProps:{user:h.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:(0,l._)((0,c._)({},Te({showAIGenerated:!0,showAnimation:!0,footerPosition:C.O.Footer,actionButtonList:t,contextData:i})),{telemetryData:a?(0,x.YI)(a):void 0}),stopLoadingUi:r}),o&&ye(n,!1,r)}function ce(e){var t=e.messageText,n=e.logUserPerceivedLatency,r=void 0===n||n,o=e.stopLoadingUi,a=void 0===o||o,i=e.logTelemetry,s=void 0===i||i,u=e.feedbackSectionPosition,d=void 0===u?C.O.None:u,_=e.showAIGenerated,p=void 0!==_&&_,g=e.showAnimation,m=void 0!==g&&g,v=e.actionbuttons,E=void 0===v?[]:v,y=e.telemetryFeatureName,b=void 0===y?void 0:y,T=e.contextData,P=void 0===T?void 0:T,A=e.clpLabelData,D=void 0===A?void 0:A,S=e.addCardToChatHistory,M=void 0===S?void 0:S,O=e.user,k=void 0===O?h.Q9.Chat:O;(0,R.cY)("Showing response card"),I.$.getInstance().displayResponse({chatCardType:f._.Default,chatMessageData:{defaultMessageProps:{user:k,messageHeader:{text:t}}},chatMessageBodyData:(0,l._)((0,c._)({},Te({showAIGenerated:p,showAnimation:m,footerPosition:d,actionButtonList:E,clpLabel:D,contextData:P})),{telemetryData:b?(0,x.YI)(b):void 0}),stopLoadingUi:a,addCardToChatHistory:M}),s&&ye(r,!1,a)}function le(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],u=arguments.length>8?arguments[8]:void 0;r&&(e=e.replace(/['"]+/g,"")),I.$.getInstance().displayResponse({chatCardType:f._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e,disableLinksProcessing:r}},chatMessageBodyData:(0,l._)((0,c._)({},Te({showAIGenerated:i,showAnimation:s,footerPosition:C.O.Footer,contextData:n,chatMessageHeader:u})),{messageId:t}),stopLoadingUi:o,addCardToChatHistory:a})}var ue=function(e,t,n,r,o){I.$.getInstance().displayResponse({chatCardType:f._.PaginatedCard,chatMessageData:{paginatedCardProps:{user:h.Q9.Chat,textIndices:e,extractTextToDisplay:t,handleApplyOnClick:r,handleApplyAllOnClick:o,locateTextIndex:n}},addCardToChatHistory:!1})};function de(e){(0,R.cY)("Showing action card"),I.$.getInstance().displayResponse({chatCardType:f._.Default,chatMessageData:{defaultMessageProps:{user:h.Q9.Human,messageHeader:{text:e}}}})}function _e(){(0,R.cY)("Striking through last message card"),I.$.getInstance().updateLastMessage({chatCardType:f._.Default,chatMessageBodyData:{strikeThroughText:!0,actionButtonList:[]},addCardToChatHistory:!1})}var pe,ge=(pe=(0,o._)((function(e){return(0,u.__generator)(this,(function(t){return e&&window.open(e,"_blank"),[2]}))})),function(e){return pe.apply(this,arguments)}),fe=function(){function e(){(0,a._)(this,e),(0,s._)(this,"querytime",void 0)}return(0,i._)(e,[{key:"setQueryTime",value:function(e){this.querytime=e}},{key:"getQueryTime",value:function(){return this.querytime}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,s._)(fe,"instance",void 0);var he=function(e,t,n,r,o){if(!o&&t){var a,i=I.$.getInstance().getLastMessage(),c=null!==(a=null==i?void 0:i.messageType)&&void 0!==a?a:f._.MarkdownCard;I.$.getInstance().updateLastMessage({chatCardType:c,stopLoadingUi:!0})}(0,W.P3Z)()&&function(e){var t={query:"",queryId:e,stopResponding:!0},n=new m.g0({parentPath:["Signal",L.ZQ.getTypeName()],items:[{id:g.r.generateId(),body:new L.ZQ(t)}]});I.$.getInstance().submitOperation({operation:n,workflowAnnotationType:w.H.getTypeName()}),O.B.getInstance().sendChatEventTelemetry((0,x.pN)((0,s._)({},T.h3.ChatEventType,T.a5.StopGeneratingSignalSentToAL))),(0,R.cY)("Stop Generating Signal Sent to AL")}(e),O.B.getInstance().sendChatEventTelemetry((0,x.pN)((0,s._)({},T.h3.ChatEventType,n)));var l,u=(0,x.Uv)(T.G8.UnableToCompleteTask,r);if(O.B.getInstance().sendLatencyTelemetry((0,x.pN)((l={},(0,s._)(l,T.CT.AnnotationType,n),(0,s._)(l,T.CT.StopGeneratingTime,(0,y.WUi)(b.querySubmitTime)),(0,s._)(l,T.CT.FeatureName,u.featureName),l))),M.P.getInstance().emptyContextIdListandCleanup(),k.sL.getInstance().resetWordAppCopilotStreamingState(),t){var d={featureName:T.CC.CopilotChat};se((0,_.Bti)(),void 0,!1,void 0,void 0,void 0,d)}};function Ce(e,t){var n=(0,W.UxI)()&&y.xPp.isAddinFlow();!function(e){me.apply(this,arguments)}(n&&y.xPp.getCurrentAddinState()===y.aB5.HasAction),n&&O.B.getInstance().sendChatEventTelemetry((0,x.pN)((0,s._)({},T.h3.ChatEventType,y.rsb.StopGeneratingButtonClickedDuringAddinExecution))),he(e,!0,T.a5.StopGeneratingButtonClicked,T.av.UnknownError,t),n&&y.xPp.setIsAddinFlow(!1,(function(){(0,y.An1)(I.$.getInstance().getCopilotRef(),!1)}))}function me(){return(me=(0,o._)((function(e){return(0,u.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,P.BV)()];case 1:return t.sent(),e?[4,(0,P.p9)()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))).apply(this,arguments)}function ve(e,t){(0,W.FFf)()&&he(e,!1,T.a5.QueryEndOnGptSwitch,T.av.GptSwitchAbortedQueryExecution,t)}function Ee(){O.B.getInstance().sendChatEventTelemetry((0,x.pN)((0,s._)({},T.h3.ChatEventType,T.a5.ChangeTopicButtonClicked)));var e={featureName:T.CC.CopilotChat,subFeatureName:T.nk.ChatTopicChanged};se((0,_.pH2)(),void 0,!1,void 0,!1,void 0,e)}function ye(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])){O.B.getInstance().sendChatEventTelemetry((0,x.pN)((0,s._)({},T.h3.ChatEventType,T.a5.ResponseCardDisplaySuccessful))),(0,R.cY)("User Perceived Latency :  ".concat((0,y.WUi)(b.querySubmitTime)," sec"));var o,a=[];if(e&&n)a=(0,x.pN)((o={},(0,s._)(o,T.CT.UserPerceivedLatency,(0,y.WUi)(b.querySubmitTime)),(0,s._)(o,T.CT.IsQuerySuccess,!0),o));else a=e&&!n?(0,x.pN)((0,s._)({},T.CT.UserPerceivedLatency,(0,y.WUi)(b.querySubmitTime))):!e&&n?(0,x.pN)((0,s._)({},T.CT.IsQuerySuccess,!r)):(0,x.pN)({});O.B.getInstance().sendLatencyTelemetry(a,t)}}function be(e,t){return{featureName:e,correlationId:O.B.getInstance().getQueryGuid(),subFeatureName:t}}function Te(e){var t,n=e.showAIGenerated,r=e.showAnimation,o=e.footerPosition,a=e.actionButtonList,i=e.isFailure,s=e.references,u=e.annotationReferences,d=e.entityAnnotations,_=e.clpLabel,p=e.msgExtCardProps,g=e.apiPluginCardProps,f=e.confirmationCardProps,h=e.pluginAuthError,C=e.contextData,m=e.telemetryData,v=e.chatMessageHeader,E=e.gptId,b=e.shouldShowCopyButton,T=e.shouldShowHandoffButton,I=e.shouldShowReadAloudButton,P=e.debugInfo,A=e.codePreviewProps;(0,R.cY)("Showing footer with showAnimation as ".concat(r," and AIGenerated as ").concat(n));try{t=m?JSON.stringify(m):void 0}catch(e){(0,R.cY)("Error in stringifying telemetry data",e)}var D=Ze();E&&(D=(0,l._)((0,c._)({},D),{id:E,name:""}));var S={shouldShowAIGeneratedIndicator:n,feedbackSectionPosition:o,feedbackData:(0,B.as)(void 0,C),isFailure:i||!1,showAnimation:r,actionButtonList:a,references:s,annotationReferences:u,entityAnnotations:d,clpSensitivityIndicatorData:_,msgExtCardProps:p,apiPluginCardProps:g,confirmationCardProps:f,pluginAuthError:h,telemetryData:t,messageAttributionProps:D,shouldShowCopyButton:b,shouldShowHandoffButton:T,shouldShowReadAloudButton:I,debugInfo:P,codePreviewProps:A};return v&&(0,W.lH6)()&&(0,W.IaT)()?(0,l._)((0,c._)({},S),{chatMessageHeaderData:(0,y.Ne4)(v)}):S}function Ie(){var e=[],t={featureName:T.CC.CopilotChat,subFeatureName:T.nk.CoPilotHelp},n=!0,r=!1,o=void 0;try{for(var a,i=(0,_.sjW)()[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var s=a.value,c={text:"",title:""};c.text=s,e.push(c)}}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}var l={text:(0,_.Fpl)()},u={text:(0,_.q1g)()+"\n\n",linkText:{text:(0,_.chx)(),linkOnClick:ge,linkUrl:_.hky}};I.$.getInstance().displayResponse({chatCardType:f._.Default,chatMessageData:{defaultMessageProps:{user:h.Q9.Chat,messageHeader:l,embeddedLists:e.length>0?[{listItems:e}]:[],messageFooter:u}},chatMessageBodyData:Te({showAIGenerated:!0,showAnimation:!0,footerPosition:C.O.Footer,contextData:t}),stopLoadingUi:!0,addCardToChatHistory:!0})}function Pe(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o={featureName:T.CC.Commanding};se(t,e?[]:[(0,U.FW)()],n,r,!0,T.CC.Commanding,o)}function Ae(){var e=(0,_.rq$)()+(0,_.kOX)()+(0,_.FME)()+(0,_.y_q)(),t={chatCardType:f._.MarkdownCard,chatMessageData:{markDownCardProps:{user:h.Q9.Chat,message:e}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,showAnimation:!0,feedbackSectionPosition:C.O.Footer}};I.$.getInstance().displayResponse(t)}var De=function(){var e=(0,o._)((function(){var e,t,n,r,a;return(0,u.__generator)(this,(function(i){switch(i.label){case 0:if((0,V.w9)())return[2,void 0];if(!(0,W.PTj)())return[3,5];e=(new Date).getTime(),n=d,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,Word.run(function(){var e=(0,o._)((function(e){return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.getSelectionContextTree(e)];case 1:return t=r.sent(),[2]}}))}));return function(t){return e.apply(this,arguments)}}())];case 2:return i.sent(),O.B.getInstance().sendLatencyTelemetry((0,x.pN)((0,s._)({},T.CT.ContextTreeBuildTime,(0,y.WUi)(e)))),[3,4];case 3:return r=i.sent(),(0,R.cY)("Exception in fetchContextTree(): ".concat(r)),O.B.getInstance().sendErrorTelemetry((0,x.pN)((a={},(0,s._)(a,T.IC.ErrorMessage,"Exception in fetchContextTree(): ".concat(r.message)),(0,s._)(a,T.IC.ErrorCategory,v.S2.Error),a))),[3,4];case 4:return[2,t];case 5:return[2,void 0];case 6:return[2]}}))}));return function(){return e.apply(this,arguments)}}(),Se=function(){var e=(0,o._)((function(){var e,t,n,r,o,a,i,s,c,l,d,p,g,f,h,C,m,v,E,b,T,I;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:return[4,De()];case 1:if(!(e=u.sent()))return[2,Promise.resolve({objects:[],selection:"",isValid:!1,attachmentDisplayText:"(empty)"})];if(t=e.selection.objectTypes.includes(z.G.Picture)&&1==e.selection.objectTypes.length,n=e.selection.objectTypes.includes(z.G.Picture)&&e.selection.objectTypes.length>1,r=(0,W.QX7)()?e.selection.objectTypes.length>0:!t,o=!(0,W.QX7)()&&n,(0,W.OUH)()&&(0,y.gte)()){i="",s=!0,c=!1,l=void 0;try{for(d=e.selection.paragraphs[Symbol.iterator]();!(s=(p=d.next()).done);s=!0)g=p.value,i+=g.text+"\n"}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}if(i=i.trim(),f=[],(0,W.tl_)()){h=!0,C=!1,m=void 0;try{for(v=e.selection.pictures[Symbol.iterator]();!(h=(E=v.next()).done);h=!0)b=E.value,f.push(b.base64String)}catch(e){C=!0,m=e}finally{try{h||null==v.return||v.return()}finally{if(C)throw m}}}T={text:i,pictures:f},a=JSON.stringify(T)}else a=JSON.stringify(e);return I={objects:e.selection.objectTypes,selection:a,isValid:r,attachmentDisplayText:e.selection.displayText,errorMessage:o?(0,_.kiD)():void 0},[2,Promise.resolve(I)]}}))}));return function(){return e.apply(this,arguments)}}(),Me=function(){var e=(0,o._)((function(e){var t,n,r,o,a,i;return(0,u.__generator)(this,(function(s){switch(s.label){case 0:return(0,R.cY)("Response Timed Out for annotation :"+e),t=T.CC.CopilotChat,P.x4?[4,(0,P.$C)()]:[3,2];case 1:s.sent(),s.label=2;case 2:return k.sL.getInstance().resetWordAppCopilotStreamingState(),M.P.getInstance().emptyContextIdListandCleanup(),e==D.Ob.getTypeName()&&(t=T.CC.ChatQnA),e!==p.Sy.getTypeName()&&e!==w.H.getTypeName()||(n=(0,x.Uv)(T.G8.TimedOut,T.av.TimeOut),O.B.getInstance().logAshaErrorEvent(n.vetoName,n.errorString,n.featureName),t=n.featureName),r="Incomplete"===b.CorrelationUtils.getInstance().getSeedingStatus()?(0,_.QMY)():(0,_.CY_)(),a={skill:e,error:o={errorMessage:r,featureName:t,errorType:"TimeoutWaitingForALResponse"},optionSets:[]},j.s.getInstance().getSkillName()==Q.B.Unset&&(i=(0,G.RH)(t),O.B.getInstance().logTriedEvent(i.capability,t,i.verb,i.subFeature)),ne(r,!1,void 0,void 0,void 0,void 0,void 0,o,void 0,a),[2]}}))}));return function(t){return e.apply(this,arguments)}}();function Oe(){return K.Vv.IsSettingTrue(K.zj.TriggerSummary)||K.Vv.IsSettingTrue(K.zj.OpenPaneProactivelyWithSummary)}function ke(){return K.Vv.IsSettingTrue(K.zj.TriggerPodcast)||K.Vv.IsSettingTrue(K.zj.OpenPaneProactivelyWithPodcast)}function Le(){return K.Vv.IsSettingTrue(K.zj.TriggerImageDescription)}function we(){K.Vv.set(K.zj.TriggerImageDescription,!1),K.Vv.remove(K.zj.ImageDescriptionAnnotation)}function Re(){K.Vv.set(K.zj.TriggerSummary,!1),K.Vv.set(K.zj.OpenPaneProactivelyWithSummary,!1)}function Ue(){K.Vv.set(K.zj.TriggerPodcast,!1),K.Vv.set(K.zj.OpenPaneProactivelyWithPodcast,!1)}var Be=function(e){if(e!==S.h2.None&&e!==S.h2.Unknown){var t,n=(t={},(0,s._)(t,T.h3.ChatEventType,T.a5.RaiErrorMessage),(0,s._)(t,T.h3.ChatEventParameters,e),t);O.B.getInstance().sendChatEventTelemetry((0,x.pN)(n));var r=(0,x.Uv)(T.G8.RAIError,T.av.RAI);(0,x.W7)(r)}};function xe(){var e;null===(e=window.document.getElementById(_.OsU))||void 0===e||e.style.setProperty("display","none")}function We(){var e;null===(e=window.document.getElementById(_.OsU))||void 0===e||e.style.setProperty("display","block")}var Fe=function(){return(0,W.cez)()&&(0,K.rA)()===E.D.DOD?_.y2K:_.UzE};function Ne(){return Fe()+_.RFL[A.i.GetHostAppPlatform()]}var Ke=function(){var e=Y.nQ.newSpaUrl;return(0,K.L1)()?e=Y.nQ.dodUrl:(0,K.TB)()&&(e=Y.nQ.gccUrl),new URL(e).pathname};function He(){return Ge.apply(this,arguments)}function Ge(){return(Ge=(0,o._)((function(){var e,t,n,r,o,a,i,c,l,d,_,p;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:if(e="",t="",!(0,W.xUq)())return[3,6];u.label=1;case 1:return u.trys.push([1,4,,5]),[4,new Promise((function(e){return Office.context.auth.getAuthContextAsync(e)}))];case 2:return n=u.sent(),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 3:return r=u.sent(),"succeeded"===n.status?(o=null==n?void 0:n.value,e=null==r?void 0:r.displayName,t=null==o?void 0:o.userPrincipalName):(O.B.getInstance().sendErrorTelemetry((0,x.pN)((a={},(0,s._)(a,T.IC.ErrorMessage,"Failed to fetch user id from OfficeJS"),(0,s._)(a,T.IC.ErrorCategory,v.S2.OfficeJsOperations),a))),(0,R.cY)("Failed to fetch user id from OfficeJS")),[3,5];case 4:return i=u.sent(),O.B.getInstance().sendErrorTelemetry((0,x.pN)((c={},(0,s._)(c,T.IC.ErrorMessage,"Error getting user info"),(0,s._)(c,T.IC.ErrorCategory,v.S2.OfficeJsOperations),c))),(0,R.cY)("Error getting user info: "+i),[3,5];case 5:return[3,9];case 6:return u.trys.push([6,8,,9]),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 7:return l=u.sent(),t=l.email,e=l.displayName,[3,9];case 8:return d=u.sent(),(0,R.cY)("Error getting user info: "+d),[2,(0,N.XG)()];case 9:return(0,W.FsT)()&&(p=(0,y.dLn)(),_=(0,y.FFS)(p)),[2,{locale:(0,H.mf)(),sessionId:K.Vv.getSettingAsString(K.zj.WacSessionId),aadUserId:t,userName:e,userPrincipalName:t,physicalRing:(0,K.I_)()?"Dogfood":"Prod",clientType:A.i.isWebPlatform()?F.WK.web:F.WK.desktop,hubName:(0,W.DYP)()?F.UH.office:F.UH.orange,clientId:y.qAn,redirectUri:Ke(),nestedAppAuthRedirectUri:(0,W.sDe)()?new URL("https://fa000000125.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2308.23015/en-us_web/login.html").pathname:(0,K.L1)()?Y.nQ.nestedAppAuthDodUrl:Y.nQ.nestedAppAuthUrl,trustedBrokerDomain:_,preferredAuthenticationStrategy:W.AJD&&(A.i.isIOSPlatform()||A.i.isWin32Platform()||A.i.isMacPlatform())?"NestedAppAuth":(0,W.XPY)()&&A.i.isWebPlatform()?"PairwiseBroker":"Default"}]}}))}))).apply(this,arguments)}function Qe(e,t,n){return(0,W.UJf)()&&e?[(0,U.uf)(e,t,n),(0,U.ZQ)(e)]:void 0}var je=function(){var e=[_.Dmx.Ask,_.Dmx.Edit,_.Dmx.Understand];return(0,W.lH6)()&&e.push(_.Dmx.Customize),e};function Ye(){return!k.sL.getInstance().getWordAppCopilotStreamingState()}var ze=function(){var e=(0,o._)((function(e){var t,n,r;return(0,u.__generator)(this,(function(o){switch(o.label){case 0:if((0,R.cY)("Data received for image insert from adaptive card",e),K.Vv.IsSettingTrue(K.zj.IsInteractiveReadOnlyMode))return O.B.getInstance().sendChatEventTelemetry([{key:T.h3.ChatEventType,value:T.a5.InsertButtonClickedInIROMode},{key:T.h3.ChatEventParameters,value:"Adaptive Card Insert button clicked in Interactive read only mode"}]),(0,R.cY)("Adaptive Card Insert button clicked in Interactive read only mode"),[2];o.label=1;case 1:return o.trys.push([1,4,,5]),[4,(0,R.X9)(e.url)];case 2:return t=o.sent()||"",n=(0,y.x5$)(t),[4,(0,R.zy)(t,0,e.altText,e.insertPosition)];case 3:return o.sent(),O.B.getInstance().sendChatEventTelemetry([{key:T.h3.ChatEventType,value:T.a5.AdaptiveCardImageInsertionSuccess},{key:T.h3.ChatEventParameters,value:"Image format: ".concat(n)}]),(0,R.cY)("Success inserting image from adaptive card in canvas. Image format: "+n),[3,5];case 4:return r=o.sent(),O.B.getInstance().sendErrorTelemetry([{key:T.IC.ErrorCategory,value:T.Nr.AdaptiveCardInsertImageError},{key:T.IC.ErrorMessage,value:"Error inserting image from adaptive card: "+r.message}]),(0,R.cY)("Error inserting image from adaptive card in canvas",r),[3,5];case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),qe=function(){var e=(0,q.q0)(),t=(0,W.wOV)();return e&&t},Ve=function(e){I.$.getInstance().displayResponse({chatCardType:f._.Default,chatMessageData:{defaultMessageProps:{user:"human",messageHeader:{text:e}}},addCardToChatHistory:!0}),I.$.getInstance().displayResponse({chatCardType:f._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:e,renderData:{component:Z.u.StoreLauncherCard,props:{cardImagePath:n(850333),cardImageAltText:(0,y.lFU)(),cardResponseText:(0,y.QMJ)()}}}},chatMessageBodyData:{feedbackSectionPosition:C.O.Footer,shouldShowAIPoweredIndicator:!1,actionButtonList:[(0,y.NVC)((0,V.dA)(),(0,V.zC)(),(0,G.dD)())]},addCardToChatHistory:!0})},Ze=function(){if(J.PF)return{promptId:J.PF}},Je=function(e,t,n,r,o){var a,i,s,u,d,_,p,g=e.getHostSettings(),f=null==g?void 0:g.feedbackSettings,h={feedbackInitOptions:(0,l._)((0,c._)({},null==f?void 0:f.feedbackInitOptions),{isProduction:null!==(p=null==f||null===(a=f.feedbackInitOptions)||void 0===a?void 0:a.isProduction)&&void 0!==p?p:(null==g?void 0:g.environment)===E.D.PRODUCTION,telemetry:(0,l._)((0,c._)({},null==f||null===(i=f.feedbackInitOptions)||void 0===i?void 0:i.telemetry),{sourceContext:(null==f||null===(u=f.feedbackInitOptions)||void 0===u||null===(s=u.callbackFunctions)||void 0===s?void 0:s.getUserAccessToken)?"CopilotChatFeedback":null==f||null===(_=f.feedbackInitOptions)||void 0===_||null===(d=_.telemetry)||void 0===d?void 0:d.sourceContext})}),getFeedbackData:t,centroHostName:"AppChatCopilot",language:g.language,getCurrentThemeInfo:n,feedbackClickedCallback:function(e){e===$.MW.Frown?o():r()}};return(0,X.A)(h)}},462610:(e,t,n)=>{"use strict";n.d(t,{$d:()=>a.$d,M7:()=>a.M7,MC:()=>a.MC,RB:()=>o.R,_p:()=>a._p,qu:()=>a.qu,tp:()=>a.tp,vq:()=>a.vq,zF:()=>r.z});var r=n(153668),o=n(76554),a=n(185088)},465321:(e,t,n)=>{"use strict";n.d(t,{Gc:()=>c,ZC:()=>u,yj:()=>l});var r=n(142411),o=n(260623),a=n(932554),i=(0,o.n)((0,r.f)({chatFreStack:{height:"calc(100vh - 50px)"},chatUiStack:{width:"100%"}})),s=(0,o.n)((0,r.f)({chatFreStack:{height:"calc(100vh - 50px)"},chatUiStack:{width:"var(--taskpane-width)",left:"auto"}})),c=function(e){var t=a.Vv.getSettingAsString(a.zj.DefaultPaneWidth),n=document.documentElement,r=parseInt(t);isNaN(r)||n.style.setProperty("--taskpane-width",.75*parseInt(t)+"px");var o=s(),c=i();return e?o:c},l={calloutStyles:{borderRadius:8,paddingRight:10},containerStyles:{maxWidth:"calc(100vw - 20px)",minWidth:"calc(100vw - 20px)",paddingHorizontal:0,borderRadius:8,paddingTop:8,paddingBottom:8,maxHeight:400},itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},u={calloutStyles:{borderRadius:8,paddingRight:0},containerStyles:{maxWidth:"calc(100vw - 20px)",minWidth:"calc(100vw - 20px)",paddingHorizontal:0,borderRadius:8,paddingTop:8,paddingBottom:8,maxHeight:400},itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}}},470551:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(533969),o=n(992640),a=n(61714),i=function(){function e(){}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogInfo=function(e){var t=(0,a.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogInfo,{request:e})},e.prototype.LogError=function(e){var t=(0,a.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogError,{request:e})},e.prototype.LogException=function(e){var t=(0,a.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogException,{request:e})},e.prototype.LogWarning=function(e){var t=(0,a.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogWarning,{request:e})},e.prototype.LogVerbose=function(e){var t=(0,a.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogVerbose,{request:e})},e.prototype.LogMetric=function(e){var t=(0,a.A)();(0,o.d)(t,r.o.TelemetryService,r.L.LogMetric,{request:e})},e}()},472096:(e,t,n)=>{"use strict";n.d(t,{$$:()=>a,fU:()=>o});var r=function(){function e(){}return e.isWebPlatform=function(){return Office.context.platform===Office.PlatformType.OfficeOnline},e.isMacPlatform=function(){return Office.context.platform===Office.PlatformType.Mac},e.isIOSPlatform=function(){return Office.context.platform===Office.PlatformType.iOS},e.isWin32Platform=function(){return Office.context.platform===Office.PlatformType.PC},e}(),o=(r.isWebPlatform,r.isMacPlatform),a=r.isIOSPlatform},474785:(e,t,n)=>{"use strict";n.d(t,{PX:()=>_,Wd:()=>p,xE:()=>d});var r=n(743032),o=n(379490),a=n(211475),i=n(740389),s=n(499011),c=n(555799),l=(n(111246),n(291172)),u=n(242154),d=(n(602061),n(457476),function(e){return!!(0,i._SP)()&&((0,i._SP)()&&"bot"===e.author&&e.messageType===a.n3.RenderCardRequest&&e.contentOrigin===s.w.LAUNCH_REVIEWERAGENT)}),_=function(e,t,n,r,o){!function(e){e("Start a review on this document")}(r),t.displayResponse({chatCardType:c._.ReviewAgentCard,chatMessageData:{reviewAgentCardProps:{user:"chat",reviewAgentIndividualCardProps:{reviewAgentCardType:l.I.EntryPointCard,reviewAgentInternalCardProps:{onAddDetailsButtonClick:n,onStartReviewButtonClick:o}}}}})};function p(){return g.apply(this,arguments)}function g(){return(g=(0,r._)((function(){var e,t,n,r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:e="",t="",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 2:return n=o.sent(),e=n.email,t=n.displayName,[3,4];case 3:return r=o.sent(),(0,u.cY)("Error getting user info: "+r),[2,{displayName:"defaultName",email:"defaultEmail"}];case 4:return[2,{displayName:t,email:e}]}}))}))).apply(this,arguments)}},475119:(e,t,n)=>{"use strict";n.d(t,{$$:()=>C.$$,$9:()=>p.$9,$H:()=>p.$H,$K:()=>c.$K,$m:()=>_.$m,$n:()=>f.$n,An:()=>i.An,At:()=>_.At,Ay:()=>p.Ay,Bp:()=>i.Bp,CR:()=>p.CR,Cs:()=>i.Cs,D0:()=>p.D0,DF:()=>a.D,DY:()=>g.DY,EG:()=>d.EG,Fq:()=>p.Fq,GZ:()=>m.GZ,Gm:()=>_.Gm,Hm:()=>i.Hm,Hr:()=>m.Hr,Id:()=>i.Id,JI:()=>l.JI,Kd:()=>p.Kd,Kj:()=>m.Kj,LQ:()=>u.LQ,Lx:()=>p.Lx,Mv:()=>p.Mv,NO:()=>o.N,NV:()=>m.NV,Ne:()=>i.Ne,Nn:()=>s.N,P9:()=>c.P9,Px:()=>i.Px,QH:()=>i.QH,QY:()=>i.QY,Sd:()=>m.Sd,T7:()=>_.T7,TR:()=>m.TR,Td:()=>p.Td,Th:()=>_.Th,VS:()=>p.VS,WS:()=>l.WS,WU:()=>v.W,Wd:()=>y.W,Xt:()=>p.Xt,YP:()=>d.YP,Zl:()=>h.Z,_H:()=>i._H,_s:()=>g._s,ae:()=>p.ae,b_:()=>f.b_,bt:()=>i.bt,cU:()=>p.cU,cY:()=>d.cY,dD:()=>g.dD,eB:()=>_.eB,fU:()=>C.fU,g5:()=>p.g5,gI:()=>m.gI,gS:()=>d.gS,hU:()=>i.hU,hX:()=>i.hX,iB:()=>m.iB,if:()=>i.if,j9:()=>c.j9,jP:()=>m.jP,jY:()=>r.j,jg:()=>b.j,jw:()=>i.jw,nG:()=>p.nG,nh:()=>i.nh,p0:()=>p.p0,pM:()=>E.p,pi:()=>u.pi,qA:()=>p.qA,r7:()=>b.r,rb:()=>p.rb,s7:()=>d.s7,sY:()=>E.s,sZ:()=>i.sZ,t6:()=>d.t6,u1:()=>p.u1,ut:()=>_.ut,v_:()=>l.v_,x5:()=>l.x5,x6:()=>p.x6,xJ:()=>v.x,y5:()=>i.y5,y8:()=>m.y8,yG:()=>p.yG,yx:()=>_.yx,zR:()=>i.zR,zg:()=>_.zg,zt:()=>l.zt});var r=n(329739),o=n(504009),a=n(432874),i=n(638753),s=n(902296),c=n(42801),l=n(285222),u=n(951903),d=n(660606),_=n(241273),p=n(822606),g=n(911443),f=n(352628),h=n(41167),C=(n(476653),n(673744),n(472096)),m=n(308849),v=n(448514),E=n(789970),y=n(991136),b=n(354535)},476653:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}()},480591:(e,t,n)=>{"use strict";n.d(t,{BI:()=>m,jX:()=>r,xR:()=>h});var r,o=n(555799),a=n(211475),i=n(660606),s=n(423905),c=n(83437),l=n(638753),u=n(702864),d=n(736679),_=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},p=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},g=new Set([a.n3.TriggerConfirmation,a.n3.TriggerPluginAuth,a.n3.TriggerPlugin]),f=function(e){return g.has(null==e?void 0:e.messageType)},h=function(e){var t,n=null!==(t=e.messages)&&void 0!==t?t:[],r=n[n.length-1];return f(r)?r.messageType:void 0},C=function(e,t,n,r,a){return _(void 0,void 0,void 0,(function(){var i,s;return p(this,(function(c){switch(c.label){case 0:return u.xP.setIsAddinFlow(!0,(function(){(0,l.An)(e,!0)})),[4,null!==(s=null===(i=e.current)||void 0===i?void 0:i.executeClientSkillFromInterstitialMessage({chatCardType:o._.InterstitialMessage,stopLoadingUi:!1,chatMessageData:{interstitialMessageProps:{user:"chat",interstitialMessages:a?r:[t],skillRequest:1===n.length?n[0]:void 0,skillRequests:n.length>1?n:void 0}},chatMessageBodyData:{messageId:t.messageId},addCardToChatHistory:!1}))&&void 0!==s?s:Promise.resolve()];case 1:return c.sent(),[2]}}))}))},m=function(e,t,n){return _(void 0,void 0,void 0,(function(){var _,g,h,m,v,E;return p(this,(function(p){switch(p.label){case 0:return _=null!==(v=e.messages)&&void 0!==v?v:[],g=_[_.length-1],0!==_.length&&f(g)?g.messageType===a.n3.TriggerPlugin?[3,1]:[3,6]:[2,!1];case 1:if(!n.enableAddinLocalPluginActions)return[3,5];h=function(e){for(var t,n=null!==(t=e.messages)&&void 0!==t?t:[],r=[],o=n.length-1;o>=0;o--){var i=n[o];if((null==i?void 0:i.messageType)!==a.n3.TriggerPlugin)break;r.push(i)}return r.reverse()}(e),(0,i.cY)("TriggerPlugin messages:",h),m=function(e){return e.map((function(e){var t,n;return{correlationId:null===(t=e.localTransportRequest)||void 0===t?void 0:t.correlation_id,localEndpoint:"InvokeAddInLocalPlugin/TriggerPlugin/"+(null==e?void 0:e.pluginInfo.data.MetaOSTitleId),payload:null===(n=e.localTransportRequest)||void 0===n?void 0:n.invocation.payload,sourceRequestId:e.sourceRequestId,actionId:e.actionId}}))}(h),function(e){var t;r=Date.now(),i.EG.sendChatEventTelemetry((0,s.pN)(((t={})[c.h3.ChatEventType]=c.a5.LocalAddinActionInvoked,t[c.h3.ChatEventParameters]=JSON.stringify({numberOfTriggerPluginMessages:e}),t)))}(h.length),p.label=2;case 2:return p.trys.push([2,4,,5]),[4,C(t,g,m,_,n.passAllMessages)];case 3:return p.sent(),[3,5];case 4:return function(e,t){var n,o;u.xP.setIsAddinFlow(!1,(function(){(0,l.An)(t,!1)})),r=void 0,o=e instanceof Error?e.message:"string"==typeof e?e:"Unknown error",(0,d.Xh)(o),null===(n=t.current)||void 0===n||n.addResponseMessage((0,d.a2)(o))}(p.sent(),t),[3,5];case 5:return[3,7];case 6:null===(E=t.current)||void 0===E||E.addResponseMessage({chatCardType:o._.InterstitialMessage,stopLoadingUi:!0,chatMessageData:{interstitialMessageProps:{user:"chat",interstitialMessages:n.passAllMessages?_:[g]}},chatMessageBodyData:{messageId:g.messageId},addCardToChatHistory:!1}),p.label=7;case 7:return[2,!0]}}))}))}},481797:(e,t,n)=>{"use strict";n.d(t,{Cd:()=>a,Xz:()=>i,Y7:()=>l,tP:()=>s,wc:()=>c,zC:()=>o});var r=n(764081),o=function(){return window.location.href.replace("taskpane.html","msgExtDialog.html")},a=function(e){var t;if("number"==typeof e)return e;if("string"==typeof e){var n=parseInt(e,10);if(!isNaN(n))return n;return null!==(t={large:-3,medium:-2,small:-1}[e.toLowerCase()])&&void 0!==t?t:-2}return-2},i=function(e,t){return Math.floor(e/t*100)},s=function(e){var t,n;return null!==(n=((t={})[-1]=r.yT,t[-2]=r.ag,t[-3]=r.Nz,t)[e])&&void 0!==n?n:r.ag},c=function(e){var t,n;return null!==(n=((t={})[-1]=r.fH,t[-2]=r.$H,t[-3]=r.qj,t)[e])&&void 0!==n?n:r.$H},l=12006},481933:(e,t,n)=>{"use strict";n.d(t,{QA:()=>o,QM:()=>a,lF:()=>i});var r=n(475119),o=function(){return(0,r.Cs)()?OfficeaicopilotStrings.GetAgents:"Get agents"},a=function(){return(0,r.Cs)()?OfficeaicopilotStrings.GetAgentsStoreCardResponse:"Agents are specialized AI assistants that enhance Copilot's capabilities by leveraging the knowledge and skills provided by their developers\nThey can help you access information from external data sources like your customer relationship management tool, create campaign content using your marketing software, synthesize data from your sales database, or coach you to write more effectively—all within Copilot"},i=function(){return(0,r.Cs)()?OfficeaicopilotStrings.GetAgentsStoreCardImageAltText:"Agent store launcher card image"}},483781:(e,t,n)=>{"use strict";n.d(t,{$n:()=>o.$n,FF:()=>o.FF,dL:()=>o.dL,gt:()=>o.gt,kH:()=>r.kH,op:()=>o.op,pH:()=>o.pH,zj:()=>r.zj});var r=n(207545),o=(n(560032),n(993821))},489231:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var r,o=n(918948),a=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(t,n,r,o,a){var i=e.call(this,t,n,r,o)||this;return i.fallbackTo3PResource=a,i}return a(t,e),t.prototype.getResourceType=function(){return"1P"},t.prototype.shouldFallbackTo3PResource=function(){return this.fallbackTo3PResource},t}(o.I)},496931:(e,t,n)=>{"use strict";n.d(t,{W:()=>c});var r=n(475119),o=n(217425),a=n(632197),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:o.w8.loki)];case 1:return n=s.sent(),[2,(0,a.t)(n)];case 2:throw i=s.sent(),(0,r.cY)("Error fetching Loki token:",i),i;case 3:return[2]}}))}))}},499011:(e,t,n)=>{"use strict";var r;n.d(t,{w:()=>r}),function(e){e.APOLOGY="apology",e.BASIC_CHAT="generate_response",e.CANNED_RESPONSE="annrules",e.CONTENT_CREATION="content_creation",e.DEBUG_COMMAND="debug_command",e.DEEPLEO_SYDNEY="deepleo",e.DESIGNER_INSERT_GRAPHIC="insert_graphic",e.DESIGNER_INSERT_IMAGE="insert_image",e.EDIT_DOCUMENT="edit_document",e.INVOKE_HANDOFF="invoke_handoff",e.SEARCH_DOC="search_document",e.SELF_HELP="self_help_search",e.SUMMARIZE="summarize",e.WORD_SUMMARIZE="wordsummarizeskill",e.SUMMARIZE_SINGLE_SHOT="wordsummarizeskillsingleshot",e.TABLE_CHAT="table_chat",e.LAUNCH_REVIEWERAGENT="launch_reviewer_agent",e.PERSONALIZATION_END="personalize_end",e.PERSONALIZATION_EXPLAIN="personalize_explain",e.PERSONALIZATION_START="personalize_start",e.PERSONALIZATION_UPDATE="personalize_update",e.PERSONALIZATION_FORCED_DELETE="personalize_forced_delete",e.IMAGE_CHAT="image-chat",e.UNKNOWN="Unknown"}(r||(r={}))},500525:(e,t,n)=>{"use strict";n.d(t,{Q:()=>h});var r=n(63461),o=n(385659),a=n(28515),i=n(483781),s=n(61714),c=n(784567),l=n(265167),u=n(260197),d=n(103801),_=n(423905),p=n(83437),g=n(676220),f=function(){return f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},f.apply(this,arguments)},h=function(){function e(e,t){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set,this.flights={};var n=this.getDocumentHandoffMessageId();n&&this.pendingHandoffMessageIds.add(n),this.flights=e.getFlights(),this.telemetryHandler=t}return e.prototype.getDocumentHandoffMessageId=function(){var e=i.kH.getSettingAsString(i.zj.HandoffMessageId);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var n=(0,s.A)(),a=this.getHandoffMessageIdSignal(n,t,e),i=new c.g0({parentPath:["Signal",r.uC.getTypeName()],items:[{id:l.r.generateId(),body:a}]});e===o.Q.GET&&this.trackHandoffMessageIdSignal(n,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(a.H_.T_,{operation:i,workflowAnnotationType:r.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(a)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.getBizChatProperties=function(e){return e},e.prototype.switchChatExperienceIfNeeded=function(e,t,n){this.flights.enableHandoffALBridge&&this.flights.enableBizchatHostContext&&(0,d.vm)(e,{setBizChatHostContext:t,bizChatHostContext:n},this.HandoffOperations.logDebug,this.flights)},e.prototype.receiveHandoffAnnotation=function(e,t){this.HandoffOperations.onAnnotationReceived(r.uC.getTypeName(),e,this.handoffMessageIdRequestSubmitTime,t)},e.prototype.handleBizChatHandoffIfEnabled=function(e,t,n){var r;if(this.flights.handoffToBizChatEnabled&&this.flights.enableHandoffALBridge&&n&&e){var o=void 0;if(this.flights.useHandoffMessagePropertiesValue)o=this.getBizChatProperties((0,d.k1)(e));else{var i=f({scenarioName:a.Cu.NONE},e);if(e.properties)for(var s=0,c=Object.keys(e.properties);s<c.length;s++){var l=c[s];void 0===i[l]&&(i[l]=e.properties[l])}o=this.getBizChatProperties(i)}try{var u=JSON.parse(null!==(r=null==o?void 0:o.context)&&void 0!==r?r:"");if((0,d.hX)(this.flights,u,t))return n(o),!0}catch(e){return!0}}return!1},e.prototype.handleHandoffMessage=function(e,t,n,o,a,i,s){void 0===n&&(n=!1);try{if(!(null==e?void 0:e.body)||!r.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var c=e.body;if(this.switchChatExperienceIfNeeded(c,a,i),this.receiveHandoffAnnotation(c,t),this.handleBizChatHandoffIfEnabled(c,i,s))return;switch((0,d.E9)(c,n)){case u.Wr.InAppHandoff:return void this.processHandoffMessage(c);case u.Wr.CrossAppCanvasHandoff:return this.renderChatHistory(c,o),this.renderClosingBookending(c),void this.processHandoffMessage(c);case u.Wr.CrossAppHandoff:default:return void(this.isHandoffMessageIdSignalTracked(c.queryId)&&this.validateResponse(c)&&(this.renderChatHistory(c,o),this.renderClosingBookending(c),this.processHandoffMessage(c),this.cleanupHandoff(c)))}}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.validateResponse=function(e){return!e.error||(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+e.error),e.error.includes("Unable to download content. The specified blob does not exist")||e.error.includes("Unable to download content. Request failed with status code 500")||this.HandoffOperations.onError(u.Fc.HandoffMessageResponse,u.I5),!1)},e.prototype.renderClosingBookending=function(e){var t,n,r;if((null===(t=e.properties)||void 0===t?void 0:t.sourceApp)&&(null===(n=e.properties)||void 0===n?void 0:n.destinationApp)&&(null===(r=e.properties)||void 0===r?void 0:r.scenarioName)&&(!this.flights.appValueChecksForBookendingEnabled||(0,d.yK)(e.properties.sourceApp)&&(0,d.yK)(e.properties.destinationApp)))switch(e.properties.scenarioName){case a.Cu.OPEN:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Opened");break;case a.Cu.NEW:case a.Cu.GENERATE:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Created")}},e.prototype.cleanupHandoff=function(e){var t=this.getHandoffMessageIdFromSignal(e.queryId);this.sendHandoffMessageId(o.Q.PROCESSED,t),this.completeTrackedHandoffMessageIdSignal(e.queryId)},e.prototype.renderChatHistory=function(e,t){var n,r,o;if(this.flights.renderChatHistoryInHandoffDestination){var a=null===(r=e.properties)||void 0===r?void 0:r.conversationId;a?(0,g.c)(a,e,this.HandoffOperations.logDebug,this.telemetryHandler,t):(this.HandoffOperations.logDebug("Cannot render chat history - conversation ID is undefined"),null===(o=this.telemetryHandler)||void 0===o||o.sendChatEventTelemetry((0,_.pN)(((n={})[p.h3.ChatEventType]=p.a5.ConversationIdUndefined,n))))}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)},e}()},504009:(e,t,n)=>{"use strict";n.d(t,{N:()=>l});var r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o="Microsoft.Office.SharedOnline",a="BizchatLocalServer",i="BizchatBranch",s={M365ChatMode:"dev",cspoff:"true",flight:"!cspheaders.enabled",auth:"2"};function c(e){for(var t=new URL(window.location.href),n=0,r=Object.entries(e);n<r.length;n++){var o=r[n],a=o[0],i=o[1];t.searchParams.set(a,i)}window.history.replaceState({},"",t.toString())}function l(e){var t=OfficeRuntime.experimentation.getIntFeatureGate("".concat(o,".").concat(e,".").concat(a));if(void 0===t){var n=OfficeRuntime.experimentation.getStringFeatureGate("".concat(o,".").concat(e,".").concat(i));void 0===n||c(r(r({},s),{M365ChatBranch:n}))}else c(r(r({},s),{M365ChatLocal:t.toString()}))}},504105:(e,t,n)=>{"use strict";n.d(t,{p:()=>m});var r=n(811912),o=n(791165),a=n(956775),i=n(111246),s=n(656904),c=n(63461),l=n(140889),u=n(242154),d=n(457476),_=n(769449),p=n(934761),g=n(602061),f=n(448397),h=n(740389),C=n(598309),m=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"onError",value:function(e,t){var n,r,o=g.I51;switch(e){case g.FcJ.OutboundMessageResponse:var a;n=this.getErrorContextData(o,null!==(a=this.getErrorTypeFromError(t))&&void 0!==a?a:"UnClassifiedError");break;case g.FcJ.NoResponse:n=this.getErrorContextData(s.tmB,"HandoffError_NoResponseMessage");break;case g.FcJ.NoGeneratedLinks:n=this.getErrorContextData(s.fam);break;case g.FcJ.HandoffMessageResponse:n=this.getErrorContextData(o),r=this.getClientErrorTelemetryParams(l.a5.HandoffMessageIdResponseError,o);break;case g.FcJ.NoQuery:(0,u.cY)("Handoff error type: "+g.xTN);break;default:throw(0,u.cY)("Unhandled Handoff error type: "+e),new Error(o)}n&&(0,d.KY)(n.errorMessage,!0,void 0,null!=r?r:void 0,void 0,void 0,void 0,n)}},{key:"getErrorContextData",value:function(e,t){return{errorMessage:e,errorType:t,featureName:l.CC.Handoff}}},{key:"getClientErrorTelemetryParams",value:function(e,t){return{chatEventType:e,chatErrorType:s.T__.Client,chatEventParam:t}}},{key:"getErrorTypeFromError",value:function(e){var t;try{var n,r=(null==e?void 0:e.json)?JSON.parse(null==e?void 0:e.json):void 0;t=(null!==(n=null==e?void 0:e.category)&&void 0!==n?n:"")+"_"+(r?r.code:"")}catch(e){(0,u.cY)("failed to parse error object on the Final Message")}return t}},{key:"submitSignal",value:function(e,t){i.$.getInstance().submitOperation(t),(0,_.WZ)(e)}},{key:"onAnnotationReceived",value:function(e,t,n,r){var o;e===c.uC.getTypeName()&&(o=t.queryId,f.B.getInstance().recordCheckPoint(l._R.HandoffMessageReceived));(0,_.G4)(e,null!=o?o:t.id,void 0,n,!1,!1,!1,r),p.P.getInstance().removeContextId(o)}},{key:"onHandoffMessageIdSubmitted",value:function(e){p.P.getInstance().addContextId(e.queryId),(0,_.WZ)(e.H_.T_),(0,_.Rb)(e)}},{key:"logDebug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];(0,u.cY)(t)}},{key:"submitQuery",value:function(e){i.$.getInstance().submitUserQuery(e)}},{key:"renderBookending",value:function(e,t,n,r){if((0,h.Skv)()){var o=(0,a.generateAppCopilotHandoffResponseSystemMessage)(e,t,n,r);i.$.getInstance().displayResponse(o)}}},{key:"getFlights",value:function(){return{renderChatHistoryInHandoffDestination:(0,h.yqt)(),isALHookEnabled:(0,h.UTV)(),appValueChecksForBookendingEnabled:(0,h.KT8)(),handoffToBizChatEnabled:(0,h.o94)(),enableHandoffALBridge:(0,C.k1)(),enableBizchatHostContext:(0,h.UW0)(),fallbackHandoffsToAppChat:(0,h.azT)(),shouldCheckUserLicense:(0,h.iAi)(),isBizChatinSDXEnabled:(0,h.xCw)(),shouldDefaultToBizChat:(0,h.lYv)(),useHandoffMessagePropertiesValue:(0,h.xUk)()}}}]),e}()},507503:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});var r=n(475119),o=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},a=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},i=function(){function e(e,t){this.clientInfo=e,this.msalAccountInfo=t,this.findMatchingAccount=function(e,t){return e.find((function(e){return e.username.toLowerCase()===t.toLowerCase()}))}}return e.prototype.getAccount=function(e){return o(this,void 0,void 0,(function(){var t,n;return a(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,1,,3]),!(t=this.getAccountSilent(e)))throw(0,r.cY)("AccountProvider : No account found in cache, trying interactive login"),new Error("No account found in cache");return[3,3];case 1:return n=o.sent(),(0,r.cY)("AccountProvider : Silent account retrieval failed: ".concat(n)),[4,this.getAccountInteractive(e)];case 2:return t=o.sent(),[3,3];case 3:if(!t)throw(0,r.cY)("AccountProvider : No account found after both silent and interactive attempts."),new Error("AccountProvider : No account found");return[2,t]}}))}))},e.prototype.getAccountSilent=function(e){var t;if(this.msalAccountInfo)return(0,r.cY)("AccountProvider: Using cached MSAL account info"),this.msalAccountInfo;var n=null===(t=this.clientInfo)||void 0===t?void 0:t.userPrincipalName;if(!n)throw(0,r.cY)("AccountProvider: No userPrincipalName provided in client info"),new Error("No userPrincipalName provided in client info");var o=e.getAllAccounts();if(0===o.length)throw new Error("No accounts found in MSAL service");o.length>1&&(0,r.cY)("AccountProvider: Multiple accounts found (".concat(o.length,"). Using account with UPN: ").concat(n));var a=this.findMatchingAccount(o,n);return a||((0,r.cY)("AccountProvider: No exact match found for UPN: ".concat(n,". Using first available account")),o[0])},e.prototype.getAccountInteractive=function(t){return o(this,void 0,void 0,(function(){var n;return a(this,(function(o){return e.signInRequestPromise?((0,r.cY)("AccountProvider: Sign-in request already in progress, waiting for it to complete"),[2,this.resolveSignInRequest()]):(n={loginHint:this.clientInfo.userPrincipalName},(0,r.cY)("AccountProvider: Initiating interactive login popup"),e.signInRequestPromise=t.loginPopup(n),[2,this.resolveSignInRequest()])}))}))},e.prototype.resolveSignInRequest=function(){return o(this,void 0,void 0,(function(){var t,n,o;return a(this,(function(a){switch(a.label){case 0:if(!e.signInRequestPromise)return(0,r.cY)("AccountProvider: No sign-in request promise found"),[2,void 0];a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,e.signInRequestPromise];case 2:return t=a.sent(),(n=null==t?void 0:t.account)?((0,r.cY)("AccountProvider: Interactive login successful for user: ".concat(n.username)),this.msalAccountInfo=n):(0,r.cY)("AccountProvider: Interactive login completed but no account returned"),[2,n];case 3:throw o=a.sent(),(0,r.cY)("AccountProvider: Interactive login failed: ",o),new Error("Interactive authentication failed: ".concat(o instanceof Error?o.message:"Unknown error"));case 4:return e.signInRequestPromise=void 0,[7];case 5:return[2]}}))}))},e}()},514931:(e,t,n)=>{"use strict";n.d(t,{aB:()=>r.aB,uh:()=>o.u,xP:()=>r.xP});var r=n(702864),o=n(299562)},539797:(e,t,n)=>{"use strict";n.d(t,{sp:()=>B});var r=n(743032),o=n(811912),a=n(791165),i=n(990813),s=n(857835),c=n(461838),l=n(289896),u=n(928499),d=n(379490),_=n(208520),p=n(656904),g=n(555799),f=n(243912),h=n(602061),C=n(140889),m=n(111246),v=n(504600),E=n(965562),y=n(934761),b=n(448397),T=n(242154),I=n(211475),P=n(457476),A=n(740389),D=n(992950),S=n(769449),M=n(598309),O=n(249002),k=n(801744),L=n(502402),w=[],R="",U=/CodeBlock-\d+/,B=function(){function e(){(0,o._)(this,e),(0,i._)(this,"conversationId",void 0),(0,i._)(this,"isStreaming",!1),(0,i._)(this,"isFirstResponse",!0),(0,i._)(this,"isFirstStreamChunk",!0),(0,i._)(this,"streamChunks",[]),(0,i._)(this,"paragraphChunks",""),(0,i._)(this,"messageId",""),(0,i._)(this,"annotationResponses",[]),(0,i._)(this,"signals",[]),(0,i._)(this,"info",{}),(0,i._)(this,"isDisengagedError",!1),(0,i._)(this,"assistantId",""),(0,i._)(this,"sydneyEndpoint",void 0),(0,i._)(this,"locale",void 0),y.P.getInstance().addHandlerCleanup(this.cleanupStreamHandler),this.info={skill:D.B.Sydney,error:"None"}}return(0,a._)(e,[{key:"getAssistantId",value:function(){return this.assistantId}},{key:"getCopilotOutputStreamStreamingState",value:function(){return this.isStreaming}},{key:"getConversationId",value:function(){return this.conversationId}},{key:"setCopilotOutputStreamStreaming",value:function(){this.isStreaming=!0}},{key:"resetCopilotOutputStreamStreamingState",value:function(){this.isStreaming=!1,this.isFirstResponse=!0,this.isFirstStreamChunk=!0,this.streamChunks=[],this.messageId="",this.paragraphChunks="",this.annotationResponses=[],this.signals=[],this.info={}}},{key:"logAnnotationResponses",value:function(e,t,n,r){var o={annotationType:e,isStreamingAnnotation:n,responseTime:t,status:r};this.annotationResponses.push(o)}},{key:"getMessageAttributionPropsForAssistant",value:function(){return{id:"SYSTEM_DA_code_interpretor_officeai",name:"Analysis Assistant",icon:L.i9m}}},{key:"getConversationDebugLog",value:function(){return w}},{key:"logSignalTypes",value:function(e){this.signals.push(e)}},{key:"cleanupStreamHandler",value:function(){e.getInstance().isStreaming=!1,e.getInstance().isFirstResponse=!0,e.getInstance().isFirstStreamChunk=!0,e.getInstance().streamChunks=[],e.getInstance().messageId="",e.getInstance().paragraphChunks="",e.getInstance().annotationResponses=[],e.getInstance().signals=[],e.getInstance().info={}}},{key:"getComponentOverrides",value:function(){return{h4:function(e){e.node;var t,n=(0,l._)(e,["node"]),r=null==n||null===(t=n.children)||void 0===t?void 0:t[0];return U.test(r)?_.createElement(k.y,{size:"tiny",style:{padding:"5px 0px"}}):_.createElement("h4",n,n.children)}}}},{key:"isInternalLoadingMessage",value:function(e){return e.messageType===I.n3.InternalLoaderMessage}},{key:"isValidMessageForRendering",value:function(e){return(null==e?void 0:e.locale)&&(this.locale=e.locale),"bot"===e.author&&!!e.text&&e.messageType!==I.n3.InternalLoaderMessage}},{key:"logDiagnostics",value:function(e){(null==e?void 0:e.conversationId)&&(0,T.cY)("conversation id from Word App Copilot: "+e.conversationId)}},{key:"storeDebugInfoForResponse",value:function(e,t,n,r){var o,a,i,s,c,l,u,d,_,p=!(!r&&!n);(this.info.skill=null!==(s=this.info.skill)&&void 0!==s?s:D.B.Sydney,R)||(R=null===(c=e.chatResponse)||void 0===c?void 0:c.sessionKey);if(this.info.sessionId=R,this.info.status=null===(o=e.chatResponse)||void 0===o?void 0:o.status,this.info.queryId=null!==(l=this.info.queryId)&&void 0!==l?l:e.queryId,this.info.timestamp=e.timestamp,r)this.logAnnotationResponses(v.p1.getTypeName(),(0,h.WUi)(t),!1,e.status),this.info.messageType=null!==(u=this.info.messageType)&&void 0!==u?u:"null",this.info.error=e.error;else if(n){var g,f;this.info.queryId=null!==(f=this.info.queryId)&&void 0!==f?f:n.queryId,this.info.messageType=n.messageType,this.info.timestamp=n.timestamp,this.info.sensitivity=null===(g=n.sensitivityLabel)||void 0===g?void 0:g.displayName,this.info.groundingDataCount=n.groundingDataCount}(this.info.resultType=null===(a=e.chatResponse)||void 0===a?void 0:a.resultType,this.info.optionSets=null===(i=e.chatResponse)||void 0===i?void 0:i.optionsSets,this.info.annotationResponses=this.annotationResponses,this.info.signals=this.signals,p)&&(this.info.LCFR=1e3*(0,h.WUi)(t),null!==(_=(d=this.info).FCFR)&&void 0!==_||(d.FCFR=this.info.LCFR),this.info.FCFRgoals=(0,M.k7)(A.YqN.FCFR),this.info.LCFRgoals=(0,M.k7)(A.YqN.LCFR),this.info.shouldShowPerfCounters=!0,(0,A.dS)()&&n&&(n.debugInfo=this.info))}},{key:"handleStreamEndInternal",value:function(e,t){var n,r,o=this;(0,T.cY)("Copilot Assistant Output streaming ended."),this.logDiagnostics(e);var a=!0,i=!1,s=void 0;try{for(var c,l=this.streamChunks[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value;this.logAnnotationResponses(v.p1.getTypeName(),u.augloopResponseTime,!0,u.status)}}catch(e){i=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}return this.logAnnotationResponses(v.p1.getTypeName(),(0,h.WUi)(t),!1,e.chatResponse.status),(0,S.G4)(v.p1.getTypeName(),null==e?void 0:e.queryId,JSON.stringify(this.streamChunks),t,!0,!1,!1),(null==e?void 0:e.conversationId)&&(this.conversationId=e.conversationId),(null===(n=this.sydneyEndpoint)||void 0===n?void 0:n.length)||(this.sydneyEndpoint=e.sydneyEndpoint),null===(r=e.chatResponse.messages)||void 0===r?void 0:r.find((function(e){return o.isValidMessageForRendering(e)}))}},{key:"handleStreamEndForCopilotAssistant",value:function(e,t,n,o){var a=this;return(0,r._)((function(){var r,i,c,l,u;return(0,d.__generator)(this,(function(d){return r=a.handleStreamEndInternal(e,t),(0,A.UJf)()&&a.storeDebugInfoForResponse(e,t,r),(0,A.CIC)()&&a.isDisengagedError?(i=E.p.getErrorHandlingStrategy(e),c=i.getErrorMessage(e,a.isDisengagedError),l={featureName:C.CC.CopilotChat,errorMessage:c.message},u=(0,s._)({},a.info),(0,P.KY)(c.message,!0,c.helpLink,void 0,void 0,!0,!0,l,c.linkMessageText,u,o,n,c.linkSuffix),y.P.getInstance().removeContextId(null==e?void 0:e.queryId),a.resetCopilotOutputStreamStreamingState(),[2]):(r&&a.updateLastRenderedMessage(r),[2])}))}))()}},{key:"updateLastRenderedMessage",value:function(e){m.$.getInstance().updateLastMessage({chatCardType:g._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e.text,allowImages:!0}},chatMessageBodyData:(0,c._)((0,s._)({},(0,P._u)({showAIGenerated:!0,showAnimation:!0,footerPosition:f.O.Footer})),{messageAttributionProps:this.getMessageAttributionPropsForAssistant()}),stopLoadingUi:!0,addCardToChatHistory:!0})}},{key:"handleChatResponseForCopilotAssistant",value:function(e,t){var n=e.chatResponse.messagesToAddOrReplace,r=e.chatResponse.messagesToDelete;if(!(0,O.hX)(r)){var o=!0,a=!1,i=void 0;try{for(var s,c=r[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value;(0,T.cY)("Deleting message id: ",l),m.$.getInstance().deleteMessage({chatCardType:g._.MarkdownCard,messageIdToDelete:l})}}catch(e){a=!0,i=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw i}}}if((0,T.cY)("Initial/previous annotation message id is "+this.messageId),!(0,O.hX)(n)&&n.length>0){var u=!0,d=!1,_=void 0;try{for(var p,f=n[Symbol.iterator]();!(u=(p=f.next()).done);u=!0){var C=p.value;this.isValidMessageForRendering(C)?((0,T.cY)("MessageId for this annotation is : "+C.messageId),C.messageId!==this.messageId?(this.messageId=C.messageId,this.isFirstStreamChunk&&(this.info.FCFR=1e3*(0,h.WUi)(t),(0,S.Ow)(t),this.isFirstStreamChunk=!1),(0,P.D9)(C.offense),(0,T.cY)("Adding Response Card for messagesToAddOrReplace:",C),this.addResponseMarkdownMessageCard(C.text,C.messageId)):this.updateResponseMarkdownMessageCard(C.text,!1)):this.isInternalLoadingMessage(C)&&m.$.getInstance().updateLoaderStrings([C.text])}}catch(e){d=!0,_=e}finally{try{u||null==f.return||f.return()}finally{if(d)throw _}}}}},{key:"handleCopilotAssistantResponse",value:function(e,t,n,o,a,s){var c=this;return(0,r._)((function(){var r,l,u,_,p,g;return(0,d.__generator)(this,(function(d){return v.p1.typeGuard(e.body)?((0,T.cY)("Copilot Output Stream Annotation response received for Shared Copilot"),r=e.body.queryId,c.isFirstResponse&&(b.B.getInstance().sendLatencyTelemetry((0,S.pN)((l={},(0,i._)(l,C.CT.FirstServiceResponse,(0,h.WUi)(t)),(0,i._)(l,C.CT.AnnotationType,v.p1.getTypeName()),(0,i._)(l,C.CT.IsFluxUsed,!(0,O.hX)(e.body.sydneyEndpoint)),l))),c.conversationId=e.body.conversationId,c.sydneyEndpoint=e.body.sydneyEndpoint,c.isFirstResponse=!1),(0,S.G4)(v.p1.getTypeName(),r,void 0,t,!1,!1,!1,s),c.info.timestamp=e.body.timestamp,y.P.getInstance().isValidAnnotationResponse(r)?c.handleCopilotAssistantResponseInternal(e.body,t,n,o,a):(b.B.getInstance().sendChatEventTelemetry((0,S.pN)((g={},(0,i._)(g,C.h3.ChatEventType,C.a5.InvalidContextIdResponse),(0,i._)(g,C.h3.ChatEventParameters,null!==(p=null===(_=e.body)||void 0===_||null===(u=_.H_)||void 0===u?void 0:u.T_)&&void 0!==p?p:""),(0,i._)(g,C.h3.UserQueryGuid,null!=r?r:""),g))),e.body.chatResponse&&0===e.body.chatResponse.status&&(R=e.body.chatResponse.sessionKey,(0,T.cY)("Copilot Output streaming ended after Augloop response timeout."),c.logDiagnostics(e.body))),[2]):[2]}))}))()}},{key:"handleCopilotAssistantResponseInternal",value:function(e,t,n,o,a){var c=this;return(0,r._)((function(){var r,l,_,g,f,m;return(0,d.__generator)(this,(function(d){switch(d.label){case 0:return(0,T.cY)("Copilot Stream Output Annotation response internal received..."),e.chatResponse?((0,A.UJf)()&&c.storeDebugInfoForResponse(e,t),e.contentOriginInformationalOnly&&(r=e.contentOriginInformationalOnly.split("_")).length>=3&&(l=r[1]+"_"+r[2],c.assistantId!==l&&(c.assistantId=l)),0!==e.chatResponse.status?[3,2]:[4,c.handleStreamEndForCopilotAssistant(e,t,o,n)]):[3,3];case 1:return d.sent(),[2];case 2:return _={augloopResponseTime:(0,h.WUi)(t),status:e.chatResponse.status},c.streamChunks=(0,u._)(c.streamChunks).concat([_]),c.handleChatResponseForCopilotAssistant(e,t),[3,4];case 3:e.error?((0,T.cY)("Error in Copilot Assistant flux response Copilot chat"),g={},(0,A.UJf)()&&(c.storeDebugInfoForResponse(e,t,void 0,!0),g=(0,s._)({},c.info),w.push(g),a()),c.cleanupStreamHandler(),f=E.p.getErrorHandlingStrategy(e),b.B.getInstance().sendLatencyTelemetry((0,S.pN)((0,i._)({},C.CT.SydneyResponseTime,(0,h.WUi)(t)))),f&&(m=f.getErrorMessage(e),(0,P.KY)(m.message,!0,m.helpLink,void 0,void 0,!0,!0,void 0,m.linkMessageText,g,n,o,m.linkSuffix)),y.P.getInstance().removeContextId(null==e?void 0:e.queryId)):(c.cleanupStreamHandler(),(0,T.cY)("ChatResponse, odslResponse, and error not present in Word Copilot annotation received"),(0,P.KY)((0,p.BFD)(),!0,void 0,void 0,void 0,void 0,void 0,void 0)),d.label=4;case 4:return[2]}}))}))()}},{key:"addResponseMarkdownMessageCard",value:function(e,t,n){var r;if((0,O.hX)(e))return(0,T.cY)("Returning as message is undefined"),void b.B.getInstance().sendChatEventTelemetry((0,S.pN)((r={},(0,i._)(r,C.h3.ChatEventType,C.a5.EmptyMessageReceivedFromSydney),(0,i._)(r,C.h3.ChatEventParameters,"Empty Markdown message card"),r)));(0,T.cY)("Adding Response Card:",e),this.paragraphChunks=e;var o={featureName:C.CC.CopilotChat},a={correlationId:b.B.getInstance().getQueryGuid(),featureName:C.CC.CopilotChat,subFeatureName:""};m.$.getInstance().displayResponse({chatCardType:g._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks,componentsOverride:this.getComponentOverrides()}},chatMessageBodyData:(0,c._)((0,s._)({},(0,P._u)({showAIGenerated:!0,showAnimation:!0,footerPosition:f.O.None,actionButtonList:[],contextData:o,telemetryData:a,codePreviewProps:void 0})),{messageId:t,messageAttributionProps:this.getMessageAttributionPropsForAssistant()}),stopLoadingUi:!!n,startAugloopTimerForStreaming:!0,addCardToChatHistory:!1})}},{key:"updateResponseMarkdownMessageCard",value:function(e,t){var n;if((0,O.hX)(e))return(0,T.cY)("Returning as message is undefined"),void b.B.getInstance().sendChatEventTelemetry((0,S.pN)((n={},(0,i._)(n,C.h3.ChatEventType,C.a5.EmptyMessageReceivedFromSydney),(0,i._)(n,C.h3.ChatEventParameters,"Empty Markdown message card"),n)));(0,T.cY)("Updating Response Card:",e);var r=e;r=r.replace("\\n","\n"),this.paragraphChunks=t?r:this.paragraphChunks+r,m.$.getInstance().updateLastMessage({chatCardType:g._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks,componentsOverride:this.getComponentOverrides()}},chatMessageBodyData:(0,c._)((0,s._)({},(0,P._u)({showAIGenerated:!1,showAnimation:!1,footerPosition:f.O.None})),{messageAttributionProps:this.getMessageAttributionPropsForAssistant()}),stopLoadingUi:!1,startAugloopTimerForStreaming:!0,addCardToChatHistory:!1})}}],[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}]),e}();(0,i._)(B,"_instance",void 0)},550294:(e,t,n)=>{"use strict";n.d(t,{k:()=>r.k});var r=n(166524)},556165:(e,t,n)=>{"use strict";n.d(t,{BQ:()=>_e,Bx:()=>Y,CS:()=>ce,Ep:()=>te,Gm:()=>ie,Mp:()=>ee,NG:()=>$,Nd:()=>q,Xg:()=>se,dG:()=>oe,fw:()=>ae,gf:()=>X,hB:()=>re,jo:()=>pe,le:()=>le,p7:()=>G});var r,o,a,i=n(743032),s=n(857835),c=n(461838),l=n(928499),u=n(379490),d=n(258005),_=n(111246),p=n(656904),g=n(86511),f=n(555799),h=n(644275),C=n(243912),m=n(573362),v=n(932554),E=n(140889),y=n(242154),b=n(740389),T=n(862853),I=n(211475),P=n(722603),A=n(124857),D=n(448397),S=n(61714),M=n(8810),O=n(499011),k=n(128825),L=n(663279),w=n(661840),R=n(208520),U=n(602061),B=n(858703),x=n(769449),W=n(190202),F=n(267836),N="",K={};!function(e){e.Text2ImageError="SkillFailedError:Text2ImageError_insert_graphic",e.InputQueryError="SkillFailedError:InputQueryError_insert_graphic",e.InferenceAPIError="SkillFailedError:InferenceAPIError_insert_graphic",e.OffensiveContent="SkillFailedError:OffensiveContent_insert_graphic",e.DesignerBrandImagesNotFound="SkillFailedError:DesignerBrandImagesNotFound_insert_graphic",e.DesignerBrandLibraryNotConfigured="SkillFailedError:DesignerBrandLibraryNotConfigured_insert_graphic",e.UnknownError="SkillFailedError:Error_insert_graphic"}(r||(r={})),function(e){e.Text2ImageError="Text2ImageError",e.InputQueryError="InputQueryError",e.InferenceAPIError="InferenceAPIError",e.OffensiveContent="OffensiveContent",e.ByDesign="ByDesign",e.Unknown="Unknown"}(o||(o={})),function(e){e.RAIBlocklistError="RAIBlocklistError",e.BackendOrUnexpectedError="BackendOrUnexpectedError",e.FailedToProcessDALLEImageInPanelViewError="Failed to process DALLE image in panel view",e.ImageLoadResultsError="ImageLoadResults Error",e.DalleEndpointError="Received back error from DALLE endpoint",e.TemplateRequestError="Template Request Error"}(a||(a={}));var H,G=(H=(0,i._)((function(e,t){var n,r,o,a;return(0,u.__generator)(this,(function(s){switch(s.label){case 0:return r=window.location.href.replace("taskpane.html","dialog.html"),o=function(r){var o=JSON.parse(r);if((0,y.cY)("message received from Designer Dialog: ",r),o.type===m.wh.Ack){var a={imageData:e};t&&(a.designerMiniSettings=t),n&&n.messageChild(JSON.stringify(a),{targetOrigin:"*"})}else o.type!==m.wh.CloseEvent||o.imageData?o.type===m.wh.CloseEvent&&o.imageData&&(_e(o.imageData),n&&n.close()):n&&n.close()},a=function(){(0,y.cY)("Designer dialog closed")},P.i.GetHostAppPlatform()!==p.q93?[3,2]:[4,Office.context.ui.displayDialogAsync(r,{displayInIframe:!0,hideTitle:!0,height:95,width:95},function(){var e=(0,i._)((function(e){return(0,u.__generator)(this,(function(t){return(n=e.value).addEventHandler(Office.EventType.DialogMessageReceived,function(){var e=(0,i._)((function(e){return(0,u.__generator)(this,(function(t){return o(e.message),[2]}))}));return function(t){return e.apply(this,arguments)}}()),[2]}))}));return function(t){return e.apply(this,arguments)}}())];case 1:return s.sent(),[3,3];case 2:OfficeFirstPartyDialog.displayWebDialog(r,{displayInIframe:!0,dialogTitle:"Designer",hideTitle:!0,height:95,width:95,onMessage:o,onClose:a}).then((function(e){n=e})),s.label=3;case 3:return[2]}}))})),function(e,t){return H.apply(this,arguments)});function Q(e,t){t+=":";var n=e.indexOf("".concat(t));return n<0?"":e.substring(n+t.length).split(";")[0]}var j=[{key:E.CT.FeatureName,value:E.CC.DesignerVisuals},{key:E.CT.SubFeatureName,value:E.nk.AddDesignerImage}],Y=function(e){return void 0===e&&(e=D.B.getInstance().getQueryGuid()),(0,l._)(j).concat([{key:E.h3.UserQueryGuid,value:e}])},z=function(){switch(P.i.GetHostAppPlatform()){case p.xb6:return"MacOS";case p.K4y:return"iOS";case p.nAd:return"Win32";case p.q93:default:return"Web"}};function q(){return V.apply(this,arguments)}function V(){return(V=(0,i._)((function(){var e;return(0,u.__generator)(this,(function(t){return e=function(e){if((0,v.L1)())return d.nQ.dodUrl;if((0,v.TB)())return d.nQ.gccUrl;switch(e){case 1:return d.nQ.newWebUrl;case 2:return d.nQ.oldSpaUrl;default:return d.nQ.newSpaUrl}}((0,b.H2h)()),(0,y.cY)("Loading auth with reply URL: ".concat(e)),[2,OfficeFirstPartyAuth.load(e)]}))}))).apply(this,arguments)}function Z(e,t,n){return J.apply(this,arguments)}function J(){return(J=(0,i._)((function(e,t,n){var r,o,a,i,s,c,d;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:return[4,(0,B.W2)()];case 1:o=u.sent(),a=0,u.label=2;case 2:if(!(a<=9))return[3,7];a>0&&(0,b.V3I)()&&D.B.getInstance().sendChatEventTelemetry((0,l._)(Y(n)).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerAuthTokenFetchRetry}])),u.label=3;case 3:return u.trys.push([3,5,,6]),i={resource:e,scope:t.length>0?t.join(" "):void 0,silentLogin:!0},s=o===U.utd.Unknown?(0,T.sQ)():o===U.utd.Consumer,(0,b.zS3)()&&!P.i.isWebPlatform()&&s&&(i.policy="DELEGATED",(0,y.cY)("Using DELEGATED policy for MSA token retrieval.")),[4,OfficeFirstPartyAuth.getAccessToken(i)];case 4:return c=u.sent(),(0,y.cY)("Auth token successfully retrieved."),[2,c.accessToken];case 5:return d=u.sent(),r=d,[3,6];case 6:return a++,[3,2];case 7:throw r}}))}))).apply(this,arguments)}var X=function(){var e=(0,i._)((function(e,t,n){var r,o,a,i,s;return(0,u.__generator)(this,(function(c){switch(c.label){case 0:r="",a=Y(o="00000000-0000-0000-0000-000000000000"),c.label=1;case 1:return c.trys.push([1,6,,7]),(0,b.V3I)()&&D.B.getInstance().sendChatEventTelemetry((0,l._)(a).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerAuthTokenFetchStart}])),(0,b.ZmX)()&&n?((0,y.cY)("Use appChatMsalTokenService for getToken"),[4,n.getToken(e,void 0,t)]):[3,3];case 2:return i=c.sent(),r=i.accessToken,[3,5];case 3:return[4,Z(e,t,o)];case 4:r=c.sent(),c.label=5;case 5:return(0,b.V3I)()&&D.B.getInstance().sendChatEventTelemetry((0,l._)(a).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerAuthTokenFetchEnd}])),[3,7];case 6:throw s=c.sent(),(0,y.cY)("Failed to get access token: ".concat(s.message)),(0,b.V3I)()&&D.B.getInstance().sendErrorTelemetry((0,l._)(a).concat([{key:E.IC.ErrorCategory,value:M.S.Designer},{key:E.IC.ErrorMessage,value:"Error getting auth token: "+s.message},{key:E.IC.ErrorCode,value:"".concat(s.code)}])),s;case 7:return[2,{token:r}]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),$=function(){var e,t,n,r;return{hostAppName:"WordCopilotChat",clientId:(0,S.A)(),designerTheme:(n=(0,W.$x)(),r=(0,W.R2)(),n===U.GmK.defaultBlack||n===U.GmK.defaultDarkGrey?r?"highContrast":"dark":n===U.GmK.defaultWhite?"light":"auto"),platformType:z(),hostBuildVersion:(t=window.location.href.match(/\/([0-9.]+)\/en-us_web\//),null==t||t.length<2?"":t[1]),sessionId:v.Vv.getSettingAsString(v.zj.WacSessionId),selectedDesignerEnv:(0,U.zt4)(null!==(e=v.Vv.getSettingAsString(v.zj.AugLoopCloudALServiceUrl))&&void 0!==e?e:v.Vv.getSettingAsString(v.zj.AugLoopCloudALServiceUrlWAC),(0,b.ALg)(),(0,b.Nnx)(),(0,b.zrA)(),(0,b.vnk)()),uiLanguage:(0,A.mf)(),audienceGroup:(0,v.I_)()?"Dogfood":"Production",showFeedBackSection:!1}},ee=function(e){D.B.getInstance().logSeenEvent(g.rf.ContentGeneration,E.CC.DesignerVisuals,g.RX.Create,E.nk.AddDesignerImage,e)},te=function(e){return"bot"===e.author&&e.messageType===I.n3.RenderCardRequest&&e.contentOrigin===O.w.DESIGNER_INSERT_GRAPHIC},ne=function(e){var t=function(e){var t="";switch(e){case w.b.Designer:t=(0,d.sJ)();break;case w.b.StockImage:default:t=(0,d.CS)()}return t}(e);_.$.getInstance().displayResponse({chatCardType:f._.Default,chatMessageData:{defaultMessageProps:{user:h.Q9.Chat,messageHeader:{text:t}}}})},re=function(e,t,n){var r=(0,U.P9K)(e,(0,F.CP)(U.mRo.EnableNewRegexForVCPromptExtraction)),o={userPrompt:r},a=JSON.stringify(o);_.$.getInstance().displayResponse({chatCardType:f._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:a,renderData:{component:k.u.ClipchampCard,props:{user:h.Q9.Chat,videoChatMessage:r,videoOptionSetPrompt:a,cardHeaderText:t},shouldMemoizeComponent:!0}}},chatMessageBodyData:{feedbackSectionPosition:C.O.Footer,feedbackData:K,messageId:N,telemetryData:(0,x.YI)(E.CC.DesignerVisuals),messageAttributionProps:{id:n,name:""}},addCardToChatHistory:!0})},oe=function(e,t,n){var r=(0,U.v_Q)(e,(0,F.CP)(U.mRo.EnableNewRegexForVCPromptExtraction)),o={payload:{designerPrompt:r,stockQuery:r,imageType:w.b.Designer}};e.text=JSON.stringify(o),ae(e,!0,t,n)},ae=function(e,t,n,r){var o=(0,y.iM)(),a=Y(o),i=(0,L.as)("Designer-Card",{featureName:E.CC.DesignerVisuals,subFeatureName:E.nk.AddDesignerImage}),u=v.Vv.IsSettingTrue(v.zj.IsInteractiveReadOnlyMode);try{if(null==e?void 0:e.text){var d,g,m,T,I,P,A,O,R,U,B,W,F,H;(0,y.cY)("Designer Init: Designer Graphics skill invoked. Payload: ",e.text);var G=JSON.parse(e.text),Q=null===(d=G.payload)||void 0===d?void 0:d.imageType,j=null===(g=G.payload)||void 0===g?void 0:g.isFallbackScenario,z=null===(m=G.payload)||void 0===m?void 0:m.clientSessionId,q=null===(P=G.payload)||void 0===P||null===(I=P.images)||void 0===I||null===(T=I[0])||void 0===T?void 0:T.companyName,V=null===(A=G.payload)||void 0===A?void 0:A.objectId,Z=null===(O=G.payload)||void 0===O?void 0:O.tenantId;j&&ne(Q);var J,X,$=null===(U=G.payload)||void 0===U||null===(R=U.images)||void 0===R?void 0:R.map((function(e){return{url:e.imageId,description:e.description,altText:e.altText,license:e.license,thumbnail:e.thumbnail,pac:e.pac}})),ee={width:(0,b.iKM)(),height:(0,b.$WV)()};N=(0,S.A)();var te,re=Q===w.b.Banner?null!==(J=null===(B=G.payload)||void 0===B?void 0:B.designerPrompt)&&void 0!==J?J:"":null!==(X=null===(W=G.payload)||void 0===W?void 0:W.stockQuery)&&void 0!==X?X:"",oe=(0,b.HsI)()&&!(null==$||null===(H=$[0])||void 0===H||null===(F=H.url)||void 0===F?void 0:F.startsWith("https")),ae=[w.b.StockImage,w.b.Icon,!oe&&w.b.Enterprise].includes(Q),ie=oe&&Q===w.b.Enterprise;if((0,b.GWw)()&&Q===w.b.Designer)re=null===(te=G.payload)||void 0===te?void 0:te.designerPrompt;var se=i.contextData,ce=(0,c._)((0,s._)({},i),{contextData:(0,c._)((0,s._)({},se),{feedbackContextData:(0,c._)((0,s._)({},null==se?void 0:se.feedbackContextData),{ALGeneratedPrompt:re,imageType:Q}),cardMetaData:JSON.stringify((0,c._)((0,s._)({},JSON.parse((null==se?void 0:se.cardMetaData)||"{}")),{ALGeneratedPrompt:re,imageType:Q}))})});K=(0,b.$rF)()?ce:i,_.$.getInstance().displayResponse({chatCardType:f._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:re,renderData:{component:k.u.DesignerCard,props:{user:h.Q9.Chat,message:re,turnId:o,isStockQuery:ae,stockImages:ie?void 0:$,base64ImageData:ie?$.map((function(e){return e.url})):void 0,imageType:Q,isAuthEnabled:!!(0,b.k4j)()||Q!==w.b.Banner,bannerWidth:Q===w.b.Banner?ee.width:void 0,bannerHeight:Q===w.b.Banner?ee.height:void 0,clientSessionId:z,objectId:V,tenantId:Z,companyName:q,shouldShowInsertButton:!u,cardHeaderText:n},shouldMemoizeComponent:!0}}},chatMessageBodyData:{feedbackSectionPosition:C.O.Footer,feedbackData:K,shouldShowAIPoweredIndicator:ae||ie,messageId:N,telemetryData:(0,x.YI)(E.CC.DesignerVisuals),messageAttributionProps:r?{id:r,name:""}:void 0},addCardToChatHistory:ae||ie}),D.B.getInstance().sendChatEventTelemetry((0,l._)(a).concat([{key:E.h3.ChatEventType,value:t?E.a5.DesignerResponseShownForDCs:E.a5.DesignerResponseShown},{key:E.h3.ImageType,value:Q}]))}else _.$.getInstance().displayResponse({chatCardType:f._.Default,chatMessageData:{defaultMessageProps:{user:h.Q9.Chat,messageHeader:{text:WordCopilot.ErrorMessageMapErrorMessage_1}}},chatMessageBodyData:{messageId:N,feedbackSectionPosition:C.O.Footer,feedbackData:i,telemetryData:(0,x.YI)(E.CC.DesignerVisuals)},addCardToChatHistory:!0}),(0,y.cY)("Triggered Designer Graphics: Empty message text"),D.B.getInstance().sendChatEventTelemetry((0,l._)(a).concat([{key:E.h3.ChatEventType,value:E.a5.EmptyDesignerResponse},{key:E.h3.ChatErrorType,value:p.T__.Server},{key:E.h3.ChatErrorKey,value:E.Nr.DesignerVisualsEmptyResponse}]));return}catch(e){return(0,y.cY)("Error parsing Designer Graphics response message"),D.B.getInstance().sendErrorTelemetry((0,l._)(a).concat([{key:E.IC.ErrorCategory,value:M.S.Designer},{key:E.IC.ErrorMessage,value:"Error parsing Designer Graphics response message: "+e.message}])),void D.B.getInstance().sendChatEventTelemetry((0,l._)(a).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerSkillResponseParseError},{key:E.h3.ChatEventParameters,value:"Error parsing Designer Graphics response message: ".concat(e.message)},{key:E.h3.ChatErrorType,value:p.T__.Server},{key:E.h3.ChatErrorKey,value:E.Nr.DesignerVisualsSkillResponseParseError}]))}},ie=function(){var e=(0,i._)((function(e){var t,n,r,o,a;return(0,u.__generator)(this,(function(i){return(t=_.$.getInstance().getLastMessage())&&t.messageType===f._.ChatCardWrapper&&e.dcHint&&(r=t.body,(null===(n=r.renderData)||void 0===n?void 0:n.component)===k.u.DesignerCard&&((0,y.cY)("Updating DesignerMini file cache info:"+JSON.stringify(e)),(a=null===(o=r.renderData)||void 0===o?void 0:o.props).fileCacheInfo||a.isStockQuery||_.$.getInstance().updateLastMessage({chatCardType:f._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:{component:k.u.DesignerCard,props:(0,c._)((0,s._)({},a),{fileCacheInfo:e}),shouldMemoizeComponent:!0}}},addCardToChatHistory:!1}))),[2]}))}));return function(t){return e.apply(this,arguments)}}(),se=function(e){(0,y.cY)("historyEventData received from designer: ",e.data);var t=_.$.getInstance().getLastMessage(),n=D.B.getInstance().getQueryGuid(),r=Y(n);if(t&&t.messageType===f._.ChatCardWrapper&&e){var o,a=t.body;if((null===(o=a.renderData)||void 0===o?void 0:o.component)===k.u.DesignerCard){var i,u=null===(i=a.renderData)||void 0===i?void 0:i.props,d=(0,b.qm6)()&&u.imageType===w.b.Designer||(0,b.k4j)()&&u.imageType===w.b.Banner;if(!u.base64ImageData&&d){var p,g,h,m,v,T,I,P=null===(p=u.message)||void 0===p?void 0:p.toString(),A=e.data;D.B.getInstance().sendChatEventTelemetry((0,l._)(r).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerBase64ImagesReceived},{key:E.h3.ChatEventParameters,value:(null!==(v=null===(g=A.data.base64Thumbnail)||void 0===g?void 0:g.length)&&void 0!==v?v:0)>0?"success":"failure"}]));var S=(0,c._)((0,s._)({},u),{base64ImageData:A.data.base64Thumbnail,generatedImageUrls:A.data.imgUrl,historyEventLocale:null!==(T=null===(h=A.metadata)||void 0===h?void 0:h.locale)&&void 0!==T?T:"",historyEventLanguage:null!==(I=null===(m=A.metadata)||void 0===m?void 0:m.language)&&void 0!==I?I:"",historyEventTimeStamp:A.timeStamp});_.$.getInstance().updateLastMessage({chatCardType:f._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{textContent:P,renderData:{component:k.u.DesignerCard,props:S,shouldMemoizeComponent:!0}}},chatMessageBodyData:{feedbackSectionPosition:C.O.Footer,feedbackData:K,messageId:N,chatHydrationKeys:{imagesKey:"base64ImageData"},telemetryData:(0,x.YI)(E.CC.DesignerVisuals)}})}}}},ce=function(e){var t,n,r,o="",a="",i=E.a5.DesignerMiniUnclassifiedError,s="";try{var c;if(t=Q(e.message,"hostCorrelationId"),n=Q(e.message,"imageType"),""!==(o=null===(c=e.message)||void 0===c?void 0:c.split(";")[0])&&o.includes(":")){var u=o.indexOf(":");a=o.substring(u+1).trim(),o=o.substring(0,u).trim()}var d=a.includes("auth");switch(o){case"RAIBlocklistError":i=E.a5.DesignerMiniRAIBlocklistError,r={vetoName:(0,x.CI)(E.eJ.DesignerVisuals,E.G8.RAIError),errorString:E.av.RAI,featureName:E.CC.DesignerVisuals};break;case"BackendOrUnexpectedError":case"Failed to process DALLE image in panel view":case"ImageLoadResults Error":case"Received back error from DALLE endpoint":case"Template Request Error":i=d?E.a5.DesignerMiniAuthError:E.a5.DesignerMiniServiceBlockError,s=a?"".concat(o,": ").concat(a):o,r={vetoName:(0,x.CI)(E.eJ.DesignerVisuals,E.G8.DesignerMiniError),errorString:d?E.av.DesignerMiniAuthError:E.av.DesignerMiniError,featureName:E.CC.DesignerVisuals};break;default:s=a?"".concat(o,": ").concat(a):o,r={vetoName:(0,x.CI)(E.eJ.DesignerVisuals,E.G8.UnclassifiedError),errorString:E.av.UnknownError,featureName:E.CC.DesignerVisuals}}D.B.getInstance().sendErrorTelemetry((0,l._)(Y(t)).concat([{key:E.IC.ErrorCategory,value:M.S.Designer},{key:E.IC.ErrorMessage,value:"Designer Mini Error=".concat(e.message)},{key:E.h3.ImageType,value:n}])),D.B.getInstance().sendChatEventTelemetry((0,l._)(Y(t)).concat([{key:E.h3.ChatEventType,value:i},{key:E.h3.ChatEventParameters,value:s},{key:E.h3.ImageType,value:n},{key:E.h3.ChatErrorType,value:p.T__.Server},{key:E.h3.ChatErrorKey,value:E.Nr.DesignerMiniError}])),(0,b.C0Y)()&&D.B.getInstance().logAshaErrorEvent(r.vetoName,r.errorString,r.featureName)}catch(e){(0,y.cY)("Error parsing Designer Mini error message"),D.B.getInstance().sendErrorTelemetry((0,l._)(Y(null!=t?t:"")).concat([{key:E.IC.ErrorCategory,value:M.S.Designer},{key:E.IC.ErrorMessage,value:"Error parsing Designer Mini error message: "+e.message},{key:E.h3.ImageType,value:n}])),D.B.getInstance().sendChatEventTelemetry((0,l._)(Y(t)).concat([{key:E.h3.ChatEventType,value:i},{key:E.h3.ChatEventParameters,value:"Error parsing Designer Mini error message: "+e.message},{key:E.h3.ImageType,value:n},{key:E.h3.ChatErrorType,value:p.T__.Server},{key:E.h3.ChatErrorKey,value:E.Nr.DesignerMiniError}]))}},le=function(e){try{D.B.getInstance().sendChatEventTelemetry((0,l._)(j).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerMiniEvent},{key:E.h3.ChatEventParameters,value:JSON.stringify(e.data)}])),ue(e.data)}catch(e){(0,y.cY)("Error parsing Designer Mini telemetry message"),D.B.getInstance().sendErrorTelemetry((0,l._)(j).concat([{key:E.IC.ErrorCategory,value:M.S.Designer},{key:E.IC.ErrorMessage,value:"Error parsing Designer Mini telemetry message: "+e.message}]))}},ue=function(e){if(e.data){var t=JSON.parse(e.data);if(t&&"number"==typeof t.DurationSinceBoot&&t.DurationSinceBoot>0){var n=t.DurationSinceBoot,r="string"==typeof t.hostCorrelationId?t.hostCorrelationId:"",o="boolean"==typeof t.isRehydration&&t.isRehydration,a="string"==typeof t.imageType?t.imageType:"";o||D.B.getInstance().sendLatencyTelemetry((0,l._)(Y(r)).concat([{key:E.CT.RequestSignalType,value:"Designer_Boot_Time"},{key:E.CT.DesignerBootTime,value:n},{key:E.CT.ImageType,value:a}]),!0)}}},de=function(e){(null==e?void 0:e.current)&&(e.current.removeAttribute("aria-label"),setTimeout((function(){var t;null==e||null===(t=e.current)||void 0===t||t.setAttribute("aria-label",(0,p.oul)())}),1))},_e=function(){var e=(0,i._)((function(e){var t,n,r,o,a,i,s,c,_,f=arguments;return(0,u.__generator)(this,(function(u){switch(u.label){case 0:if(t=f.length>2&&void 0!==f[2]?f[2]:"",n=f.length>4&&void 0!==f[4]&&f[4],r=f.length>5&&void 0!==f[5]?f[5]:"",o=f.length>6&&void 0!==f[6]?f[6]:"",a=f.length>7&&void 0!==f[7]?f[7]:"",i=f.length>8&&void 0!==f[8]?f[8]:R.createRef(),s=(0,l._)(Y(o)).concat([{key:E.h3.UniqueActionId,value:(0,S.A)()},{key:E.h3.ImageType,value:a}]),v.Vv.IsSettingTrue(v.zj.IsInteractiveReadOnlyMode))return D.B.getInstance().sendChatEventTelemetry([{key:E.h3.ChatEventType,value:E.a5.InsertButtonClickedInIROMode},{key:E.h3.ChatEventParameters,value:"Designer Insert button clicked in Interactive read only mode"}]),(0,y.cY)("Designer Insert button clicked in Interactive read only mode"),[2];u.label=1;case 1:return u.trys.push([1,10,,11]),D.B.getInstance().sendChatEventTelemetry((0,l._)(s).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerImageInsertStart}])),h=s,D.B.getInstance().logKeptEvent(E.CC.DesignerVisuals,E.nk.AddDesignerImage,g.RX.Create,g.rf.ContentGeneration,h),n?(c="",(0,b.X$C)()&&r?[4,(0,y.X9)(e,r)]:[3,3]):[3,7];case 2:return c=u.sent()||"",[3,5];case 3:return[4,(0,y.X9)(e)];case 4:c=u.sent()||"",u.label=5;case 5:return[4,(0,y.IS)(c,t,(0,l._)(s).concat([{key:E.CT.RequestSignalType,value:d.wj}]))];case 6:return u.sent(),de(i),[3,9];case 7:return[4,(0,y.IS)(e,t,(0,l._)(s).concat([{key:E.CT.RequestSignalType,value:d.wj}]))];case 8:u.sent(),de(i),u.label=9;case 9:return D.B.getInstance().sendChatEventTelemetry((0,l._)(s).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerImageInsertEnd}])),[3,11];case 10:return _=u.sent(),(0,y.cY)("Error: ".concat(_.message," at StackTrace ").concat(_.stack)),D.B.getInstance().sendErrorTelemetry((0,l._)(s).concat([{key:E.IC.ErrorCategory,value:M.S.Designer},{key:E.IC.ErrorMessage,value:"Error thrown during image insertion via insertInlinePictureFromBase64. Message=".concat(_.message)}])),D.B.getInstance().sendChatEventTelemetry((0,l._)(s).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerImageInsertError},{key:E.h3.ChatEventParameters,value:"Error thrown during image insertion via insertInlinePictureFromBase64. Message=".concat(_.message)},{key:E.h3.ChatErrorType,value:p.T__.Client},{key:E.h3.ChatErrorKey,value:E.Nr.DesignerVisualsInsertError}])),[3,11];case 11:return[2]}var h}))}));return function(t){return e.apply(this,arguments)}}(),pe=function(e){var t,n="Unknown",r=E.Nr.DesignerVisualsUnknownError,o=p.T__.Server,a=E.a5.ErrorInExecution;switch(e){case"SkillFailedError:Text2ImageError_insert_graphic":n="Text2ImageError",r=E.Nr.DesignerVisualsText2ImageError,t=(0,x.Uv)(E.G8.Text2ImageError,E.av.Text2ImageGenericError);break;case"SkillFailedError:InputQueryError_insert_graphic":n="InputQueryError",o=p.T__.UnsupportedAction,r=E.Nr.DesignerVisualsUnsupportedImageTypeError,t=(0,x.Uv)(E.G8.UnsupportedFunctionality,E.av.DesignerVisualsUnsupportedImageType);break;case"SkillFailedError:InferenceAPIError_insert_graphic":n="InferenceAPIError",r=E.Nr.DesignerVisualsLLMError,t=(0,x.Uv)(E.G8.LLMIssue,E.av.DesignerVisualsInferenceAPIError);break;case"SkillFailedError:OffensiveContent_insert_graphic":n="OffensiveContent",r=E.Nr.DesignerVisualsStockRAIError;break;case"SkillFailedError:DesignerBrandImagesNotFound_insert_graphic":case"SkillFailedError:DesignerBrandLibraryNotConfigured_insert_graphic":n="ByDesign",a=E.a5.DesignerDiscountedError;break;default:t=(0,x.Uv)(E.G8.UnclassifiedError,E.av.UnknownError)}return"ByDesign"===n?D.B.getInstance().sendChatEventTelemetry((0,l._)(Y()).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerDiscountedError},{key:E.h3.ChatEventParameters,value:e}])):D.B.getInstance().sendChatEventTelemetry((0,l._)(Y()).concat([{key:E.h3.ChatEventType,value:E.a5.DesignerSkillError},{key:E.h3.ChatEventParameters,value:n},{key:E.h3.ChatErrorType,value:o},{key:E.h3.ChatErrorKey,value:r}])),{designerVisualsErrorResultType:a,designerVisualsASHAErrorDetails:t}}},560032:(e,t,n)=>{"use strict";var r=n(208520),o=n(241273);n(152233),(0,r.createContext)({officePlatform:o.yx.web,officeTheme:void 0})},564539:(e,t,n)=>{"use strict";n.d(t,{DL:()=>r.DL,gQ:()=>r.gQ,tO:()=>o.t});var r=n(654752),o=n(322974)},565018:(e,t,n)=>{"use strict";n.d(t,{X:()=>c});var r=n(217425),o=n(632197),a=n(475119),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:r.w8.cognitive)];case 1:return n=s.sent(),[2,(0,o.t)(n)];case 2:throw i=s.sent(),(0,a.cY)("Error fetching Cognitive token:",i),i;case 3:return[2]}}))}))}},578483:(e,t,n)=>{"use strict";var r;n.d(t,{Y:()=>r}),function(e){e.LAUNCH_WITH_REVIEWERS="LAUNCH_WITH_REVIEWERS",e.LAUNCH_WITHOUT_REVIEWERS="LAUNCH_WITHOUT_REVIEWERS",e.LAUNCH_FROM_TOGGLE="LAUNCH_FROM_TOGGLE"}(r||(r={}))},578574:(e,t,n)=>{"use strict";n.d(t,{g:()=>D});var r,o,a,i=n(743032),s=n(990813),c=n(379490),l=n(498483),u=n(839048),d=n(932554),_=n(784567),p=n(602061),g=n(844807),f=n(448397),h=n(656904),C=n(140889),m=n(242154),v=n(330743),E=n(769449),y=n(249002),b=n(862853);function T(e){return I.apply(this,arguments)}function I(){return(I=(0,i._)((function(e){var t;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return(0,m.cY)("Activating User Context Annotation"),function(){(0,m.cY)("Fetching AL Session");var e=d.Vv.getSettingAsString(d.zj.AugloopSharedSessionID);o=(0,v.wB)((0,y.hX)(e)?"ALDummySession":e)}(),[4,o.activateAnnotation(l.i.getTypeName(),{callback:function(t){return function(e,t){(0,m.cY)("Entering user Context Annotation handler");var n=!0,r=!1,o=void 0;try{for(var a,i=e.items[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var s=a.value;l.i.typeGuard(s.body)&&M(s,t)}}catch(e){r=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw o}}}(t,e)}})];case 1:return t=n.sent(),r=t.token,(0,m.cY)("User Context Annotation activated with token: "+r),[2]}}))}))).apply(this,arguments)}function P(){return A.apply(this,arguments)}function A(){return(A=(0,i._)((function(){var e;return(0,c.__generator)(this,(function(t){switch(t.label){case 0:(0,m.cY)("Releasing User Context Annotation with token: "+r),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,o.releaseAnnotation(r)];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),(0,m.cY)("Error while releasing User Context Annotation: "+e),[3,4];case 4:return(0,m.cY)("User Context Released"),[2]}}))}))).apply(this,arguments)}function D(e){return S.apply(this,arguments)}function S(){return(S=(0,i._)((function(e){var t,n,r,i;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return(0,m.cY)("Sending signal to Copilot Warmup Flow"),t=(new Date).getTime(),[4,T(e)];case 1:c.sent(),(0,m.cY)("User Context Annotation Time is "+(0,p.WUi)(t)),f.B.getInstance().sendLatencyTelemetry((0,E.pN)((0,s._)({},C.CT.UserContextAnnotationActivationTime,(0,p.WUi)(t)))),n=new _.g0({parentPath:[h.HN0,u.P.getTypeName()],items:[{id:g.r.generateId(),body:new u.P}]}),r=u.P.getTypeName(),(0,m.cY)("Submitting User Context signal"+JSON.stringify(n)),a=(new Date).getTime();try{o.submitOperation(n)}catch(e){(0,m.cY)("Error while submitting signal to Copilot Warmup Flow"+e)}return(0,m.cY)("User Context signal submitted..."),f.B.getInstance().sendChatEventTelemetry((0,E.pN)((i={},(0,s._)(i,C.h3.ChatEventType,C.a5.UserContextSignalSubmitted),(0,s._)(i,C.h3.ChatEventParameters,r),i))),[2]}}))}))).apply(this,arguments)}function M(e,t){return O.apply(this,arguments)}function O(){return(O=(0,i._)((function(e,t){var n,r,o;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return(0,m.cY)("Entering user Context Annotation item handler"),(0,E.G4)(l.i.getTypeName(),void 0,void 0,a),e.body?(n=e.body.userType,(0,m.cY)("User Type returned is: ",n),n?(f.B.getInstance().sendChatEventTelemetry((0,E.pN)((r={},(0,s._)(r,C.h3.ChatEventType,C.a5.ALUserType),(0,s._)(r,C.h3.ChatEventParameters,(0,p.nhe)(n)),r))),(0,b.Kw)(n),t(n),[4,P()]):[3,2]):[2];case 1:return i.sent(),(0,m.cY)("User Context Annotation Released"),[3,3];case 2:f.B.getInstance().sendChatEventTelemetry((0,E.pN)((o={},(0,s._)(o,C.h3.ChatEventType,C.a5.ALUserType),(0,s._)(o,C.h3.ChatEventParameters,"UserTypeNotFound"),o))),i.label=3;case 3:return[2]}}))}))).apply(this,arguments)}},584660:(e,t,n)=>{"use strict";n.d(t,{R:()=>c});var r=n(217425),o=n(632197),a=n(475119),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i,c;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),n=t?r.dX:r.L6,[4,e.getToken(n)];case 1:return i=s.sent(),[2,(0,o.t)(i)];case 2:throw c=s.sent(),(0,a.cY)("Error fetching Safe Links token:",c),c;case 3:return[2]}}))}))}},598309:(e,t,n)=>{"use strict";n.d(t,{B_:()=>U,D9:()=>D,Gh:()=>_,Id:()=>Y,Il:()=>ie,LK:()=>Z,Lx:()=>V,MP:()=>j,NP:()=>x,Nr:()=>O,O8:()=>K,OJ:()=>L,S3:()=>re,T$:()=>w,V9:()=>k,XS:()=>H,YX:()=>G,Z5:()=>M,af:()=>te,b8:()=>g,cU:()=>y,cy:()=>p,dA:()=>q,dV:()=>h,du:()=>ee,fD:()=>Q,gP:()=>ce,j$:()=>J,k1:()=>se,k7:()=>W,kf:()=>ne,lf:()=>u,lj:()=>B,mO:()=>N,pZ:()=>ae,pm:()=>R,pv:()=>P,qQ:()=>d,r3:()=>A,s:()=>m,tC:()=>$,vI:()=>C,vP:()=>X,vf:()=>b,w9:()=>oe,x6:()=>S,xw:()=>I,yV:()=>E,z4:()=>f,zC:()=>z});var r,o=n(990813),a=n(932554),i=n(862853),s=n(740389),c=n(354311),l=n(602061);function u(){return(0,s.LV3)()&&(0,i.q0)()}function d(){return(0,s.A9c)()&&(0,i.q0)()}function _(){return(0,s.Shf)()&&(0,i.q0)()}function p(){return(0,s.EG7)()&&(0,i.q0)()}function g(){return(0,s.zP3)()&&(0,i.q0)()||v()}function f(){return(0,i.q0)()&&!(0,a.TB)()}function h(){return(0,i.q0)()&&(0,s.LXk)()}function C(){return(0,i.q0)()&&(0,s.jv5)()||(0,i.sQ)()&&(0,s.sTw)("IsGroundingPhase2UxEnabledForConsumer")}function m(){return(0,i.q0)()||v()}function v(){return(0,i.sQ)()&&(0,s.qH6)()}function E(){return(0,s.WTS)()&&((0,i.q0)()||(0,i.sQ)()&&(0,s.snA)("RehydrateMessagesConsumer"))}function y(e){return(0,s.mn7)(e)&&m()}function b(){return(0,i.q0)()||(0,i.sQ)()&&(0,s.sTw)("IsPersistentChatHistoryEnabledForConsumer")}function T(e){return(0,i.q0)()&&(0,s.snA)(e)}function I(){return T("IsEnableAppGptsInCIQ")}function P(){return T("IsEnableAppAgentsInCiqOverride")}function A(){return T("IsEnableAtMentionButtonForUser")&&I()}function D(){return T("IsUXRefreshEnabledForInput")}function S(){return T("IsEnableAppPluginsInCIQ")}function M(){return!(0,s.OrF)()&&T("IsEnableAppMsgExtInCIQ")}function O(){return T("IsEnableAppPPInCIQ")}function k(){return T("IsEnableAppTypeBInCIQ")}function L(){return T("IsEnableTopicECC")}function w(){return(0,s.snA)("HideChangeTopicButton")||(0,i.sQ)()&&!(0,s.qH6)()}function R(){return(0,s.sTw)("enableChatHistoryV2ForEnterprise")&&(0,i.q0)()||(0,s.snA)("enableChatHistoryV2ForConsumer")&&(0,i.sQ)()}function U(){return R()&&((0,s.snA)("enableChatHistoryLocalStorageForEnterprise")&&(0,i.q0)()||(0,s.snA)("enableChatHistoryLocalStorageForConsumer")&&(0,i.sQ)())}function B(){return(0,s.snA)("IsImageInputEnabled")}function x(){return B()&&(0,s.sTw)("IsExtractTextFromImageZQMEnabled")}function W(e){var t=(0,s.XTA)(e);if(t)try{var n=t.split("|").map(Number);if(Array.isArray(n)&&3==n.length&&n.every((function(e){return!isNaN(e)})))return{greenMs:1e3*n[0],neutralMs:1e3*n[1],yellowMs:1e3*n[2]}}catch(t){(0,l.cY_)("Unable to parse ".concat(e," perf counter goals. Need 3 numbers: green|neutral|yellow in seconds"),t)}return F[e]}var F=(r={},(0,o._)(r,s.YqN.FCFR,{greenMs:8e3,neutralMs:0,yellowMs:1e4}),(0,o._)(r,s.YqN.LCFR,{greenMs:0,neutralMs:2e4,yellowMs:3e4}),r);function N(){return(0,s.sTw)("IsHydratedEntityEnabled")}function K(){return(0,s.snA)("IsUploadImageFromPhoneEnabled")}function H(){return(0,s.snA)("IsPasteFromClipboardButtonEnabled")}function G(){return(0,s.snA)("showTelemetryLogs",!0)}function Q(){return(0,s.KQw)()&&(0,s.snA)("fixPodcastZQMinExistingDoc",!1)}function j(){return(0,i.q0)()&&(0,s.snA)("useModifiedZQStrings",!1)}function Y(){return(0,s.Slc)()&&(0,s.snA)("disableSuggestionPromptsWithZeroQueryInteraction",!1)}function z(){return(0,s.snA)("IsAcquirePluginsFromMosEnabled",!1)&&(0,i.q0)()}function q(){return(0,s.snA)("IsRichAPIForAcquirePluginsEnabled",!1)&&Office.context.requirements.isSetSupported("unifiedstoreservice","1.1")&&(0,i.q0)()&&!oe()}function V(){return(0,i.q0)()&&(0,s.snA)("EnablePodcastInBizChatResearcher",!1)}function Z(){return q()||z()?(0,s.Z8j)("DelayTimeForAgentSwitch",2e3):0}function J(){return(0,i.q0)()&&(0,s.snA)("EnableBizChatIntegration")}function X(){var e=a.Vv.IsSettingTrue(a.zj.BizChatEntry);return(0,l.cY_)("entryBizChatHostAppSetting: ".concat(e)),(0,i.q0)()&&(0,s.snA)("EnableBizChat")||e&&(0,s.snA)("EnableBizChatEntryFromRibbon")}function $(){return q()||z()?(0,s.Z8j)("MosAgentInstallTimeout",13e3):0}function ee(){return(q()||z())&&(0,s.sTw)("EnableMosRequestHandlers")}function te(){return(0,s.sTw)("EnableSwitchToAgentPostLoad")&&(q()||z())}function ne(){return(0,s.sTw)("EnableInputImageInOCV")}function re(){return(0,s.beW)("ImageFileUploadEndpoint","")}function oe(){return(0,s.DxQ)()&&(0,a.So)()}function ae(){return(0,s.sTw)("CommentCheckEnabled")}function ie(){return(0,s.sTw)("shouldClearSuggestionPillsOnDQGSubmit")}var se=function(){return!(0,s.hEq)()&&(0,i.q0)()&&((0,l.gte)()||X()||(0,s.TS5)())&&(0,s.sTw)("HandoffALBridgeEnabled")};function ce(){var e=(0,a.rA)();return!![c.D.DEV,c.D.DOGFOOD,c.D.PRODUCTION].includes(e)&&(!!(0,s.iih)()&&((0,i.q0)()||(0,s.vzv)()))}},602061:(e,t,n)=>{"use strict";n.d(t,{$$b:()=>a.$$,$Cv:()=>A.$,$SW:()=>P.$S,$dc:()=>p.$d,$nm:()=>a.$n,AkC:()=>I.Ak,An1:()=>a.An,Atg:()=>a.At,BDr:()=>C.B,BIF:()=>d.BI,Bbs:()=>_.Bb,Bp2:()=>a.Bp,C$H:()=>_.C$,D09:()=>a.D0,D9t:()=>o.D,DF:()=>a.DF,DLk:()=>D.DL,DYx:()=>a.DY,Djx:()=>E.D,Dl2:()=>i.Dl,Ebk:()=>r.Eb,FFS:()=>b.FF,FcJ:()=>f.Fc,FqH:()=>a.Fq,G41:()=>u.G4,GZA:()=>a.GZ,GmK:()=>a.Gm,Gnb:()=>v.Gn,Hrz:()=>a.Hr,I51:()=>f.I5,IdZ:()=>a.Id,Izi:()=>P.Iz,JI8:()=>a.JI,KjQ:()=>a.Kj,LQO:()=>a.LQ,LTG:()=>P.LT,Ldm:()=>v.Ld,M79:()=>p.M7,MCQ:()=>p.MC,NOM:()=>a.NO,NVC:()=>a.NV,Ne4:()=>a.Ne,NnE:()=>a.Nn,OzJ:()=>h.Oz,P71:()=>v.P7,P9K:()=>a.P9,Pb_:()=>i.Pb,Q6w:()=>f.Q6,Q9t:()=>r.Q9,QAh:()=>g.QA,QHk:()=>a.QH,QMJ:()=>g.QM,Qk5:()=>u.Qk,RBg:()=>p.RB,RLO:()=>h.RL,Sdf:()=>a.Sd,Sqe:()=>g.Sq,Ssr:()=>h.Ss,T7z:()=>a.T7,TRs:()=>a.TR,Thm:()=>a.Th,TkU:()=>f.Tk,TzT:()=>r.Tz,VEG:()=>h.VE,WSP:()=>a.WS,WUi:()=>a.WU,Wu7:()=>h.Wu,XXj:()=>h.XX,XtO:()=>a.Xt,YPU:()=>a.YP,Yj6:()=>g.Yj,YwR:()=>r.Yw,Zl2:()=>a.Zl,_Ho:()=>a._H,_pQ:()=>p._p,_sV:()=>a._s,aB5:()=>y.aB,aWC:()=>r.aW,b_z:()=>a.b_,cY_:()=>a.cY,cqx:()=>l.c,d9E:()=>r.d9,d9u:()=>i.d9,dDr:()=>a.dD,dLn:()=>b.dL,dkM:()=>m.dk,f99:()=>_.f9,fQe:()=>u.fQ,fUp:()=>a.fU,gBO:()=>I.gB,gIB:()=>a.gI,gQo:()=>D.gQ,gSe:()=>a.gS,gcB:()=>o.g,gte:()=>b.gt,hUL:()=>a.hU,hXl:()=>a.hX,iBH:()=>a.iB,ifM:()=>a.if,j92:()=>a.j9,jPo:()=>a.jP,jYE:()=>a.jY,jgs:()=>a.jg,jwY:()=>a.jw,kqr:()=>c.k,kyo:()=>h.ky,lFU:()=>g.lF,lqj:()=>u.lq,mRo:()=>g.mR,n6d:()=>r.n6,nhe:()=>a.nh,nq:()=>T.n,oUt:()=>I.oU,ope:()=>b.op,p0W:()=>a.p0,pH3:()=>b.pH,pMy:()=>a.pM,piD:()=>a.pi,qAn:()=>a.qA,qHb:()=>r.Zj,quJ:()=>p.qu,r7C:()=>a.r7,roB:()=>r.ro,rsb:()=>i.rs,s77:()=>a.s7,sJD:()=>h.sJ,sYi:()=>a.sY,sZB:()=>a.sZ,tHk:()=>s.t,tO0:()=>D.tO,tpg:()=>p.tp,u1W:()=>h.u1,u1i:()=>a.u1,uhY:()=>y.uh,utd:()=>a.ut,v5s:()=>h.v5,v_Q:()=>a.v_,vfc:()=>l.v,vqz:()=>p.vq,wai:()=>_.w,x5$:()=>a.x5,xJq:()=>a.xJ,xPp:()=>y.xP,xRn:()=>d.xR,xTN:()=>f.xT,y5p:()=>a.y5,y8L:()=>a.y8,yu7:()=>r.yu,zRu:()=>a.zR,zt4:()=>a.zt});var r=n(442567),o=n(280858),a=n(475119),i=n(995261),s=n(425842),c=n(550294),l=n(302965),u=n(24498),d=n(647428),_=n(736679),p=n(462610),g=n(330968),f=n(991392),h=n(806220),C=n(608531),m=n(930935),v=n(44378),E=n(370216),y=n(514931),b=n(483781),T=n(974951),I=n(457236),P=n(724919),A=n(849145),D=n(564539)},606363:(e,t,n)=>{"use strict";n.d(t,{n:()=>f});var r=n(743032),o=n(811912),a=n(791165),i=n(990813),s=n(379490),c=n(656904),l=n(602061),u=n(242154),d=n(769449),_=n(740389),p=n(111246),g=n(457476),f=function(){function e(){(0,o._)(this,e),(0,i._)(this,"labelInfo",{labelId:c.u1i,tenantId:c.u1i}),this.labelInfo.labelId=c.u1i,this.labelInfo.tenantId=c.u1i}return(0,a._)(e,[{key:"setInDocSensitiveLabelInfoUsingOfcJs",value:function(){var e=this;return(0,r._)((function(){var t;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return(0,u.cY)("Setting label"),[4,e.getInDocSensitiveLabelUsingOfcJs()];case 1:return t=n.sent(),e.setInDocSensitivityLabelInfo(t),[2]}}))}))()}},{key:"getInDocSensitiveLabelUsingOfcJs",value:function(){return(0,r._)((function(){var e,t;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:(0,u.cY)("Getting label"),e={labelId:c.u1i,tenantId:c.u1i},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=n.sent(),(0,d.Zy)("getLabel"),(0,u.cY)("Label is : ",e),[3,4];case 3:return t=n.sent(),(0,d.mQ)("error in getLabel Api : ".concat(t.message)),(0,u.cY)("Error while fetching In Doc sensitivity label: ".concat(t.message)),(0,u.cY)("trying to disable enterprise search"),t.code!==l.roB&&(0,d.oN)(),[3,4];case 4:return[2,e]}}))}))()}},{key:"getHighestDocumentSensitivityInfo",value:function(e){return(0,r._)((function(){var t,n;return(0,s.__generator)(this,(function(r){switch(r.label){case 0:t={labelId:c.u1i,tenantId:c.u1i},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=r.sent(),(0,u.cY)("Highest Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),(0,d.Zy)("HighestSensitivityLabel"),[3,4];case 3:return n=r.sent(),(0,d.mQ)("error in HighestSensitivityLabel Api : ".concat(n.message)),(0,u.cY)("Error while fetching highest sensitivity label: ".concat(n.message)),(0,u.cY)("trying to disable enterprise search"),n.code!==l.roB&&(0,d.oN)(),[3,4];case 4:return[2,t]}}))}))()}},{key:"setSensitivityLabelToHighestSensitivity",value:function(e){var t=this;return(0,r._)((function(){var n,r;return(0,s.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.getHighestDocumentSensitivityInfo(e)];case 1:return n=o.sent(),t.setInDocSensitivityLabelInfo(n),(0,d.Zy)("External Doc HighestSensitivityLabel"),[3,3];case 2:return r=o.sent(),(0,d.mQ)("error in HighestSensitivityLabel Api : ".concat(r.message)),(0,u.cY)("Error while updating external doc sensitivity label: ".concat(r.message)),(0,u.cY)("trying to disable enterprise search"),(0,d.oN)(),[3,3];case 3:return[2]}}))}))()}},{key:"setInDocSensitivityLabelInfo",value:function(e){(0,u.cY)("setting Sensitivity Label Info: ".concat(JSON.stringify(e))),this.labelInfo.version=e.version,this.labelInfo.labelId=e.labelId,this.labelInfo.tenantId=e.tenantId,this.labelInfo.isEnabled=e.isEnabled,this.labelInfo.encryptionType=e.encryptionType,this.labelInfo.isDke=e.isDke,this.labelInfo.hasExtractForUser=e.hasExtractForUser,this.labelInfo.order=e.order,this.labelInfo.displayName=e.displayName,this.labelInfo.description=e.description,this.labelInfo.parentName=e.parentName,this.labelInfo.color=e.color}},{key:"getInDocSensitiveLabelInfo",value:function(){return this.labelInfo}},{key:"upgradeSensitivityLabelUsingOfcJs",value:function(e){try{(0,u.cY)("Sensitivity Label Upgrade: ".concat(OfficeFirstParty.Sensitivity.tryUpgradeLabel(e)?"Success":"Failure")),(0,d.Zy)("tryUpgradeLabel")}catch(e){(0,d.mQ)("error in upgradeLabel Api : ".concat(e.message)),(0,u.cY)("Error while upgrading sensitivity label: ".concat(e.message)),(0,u.cY)("trying to disable enterprise search"),(0,d.oN)()}}},{key:"setLabelChangeEventListener",value:function(e){try{(0,u.cY)("Setting Sensitivity Label Change Event Listener"),OfficeFirstParty.Sensitivity.onLabelChangedEvent(e),(0,d.Zy)("Label Change Event Listener"),(0,u.cY)("Sensitivity Label Change Event Listener Set")}catch(e){(0,u.cY)("trying to disable enterprise search"),(0,d.oN)(),(0,d.mQ)("error in setting listener for CLP : ".concat(e.message)),(0,d.oN)(),(0,u.cY)("Error while setting sensitivity label change event listener: ".concat(e.message))}}},{key:"getSensitivity",value:function(){var e,t,n={id:this.labelInfo.labelId,displayName:null!==(e=this.labelInfo.displayName)&&void 0!==e?e:"",tooltip:this.labelInfo.description,color:this.labelInfo.color,isEncrypted:this.labelInfo.encryptionType!==l.TzT.None,priority:null!==(t=this.labelInfo.order)&&void 0!==t?t:0};return(0,u.cY)("Sensitivity is : ",JSON.stringify(n)),n}}],[{key:"getInstance",value:function(){return e.clpSensitivityHandler||((0,_.Wdf)()?e.clpSensitivityHandler=l.n6d.getInstance(void 0,void 0,p.$.getInstance().getCopilotRef(),u.uB,g.Y6):e.clpSensitivityHandler=new e),e.clpSensitivityHandler}}]),e}();(0,i._)(f,"clpSensitivityHandler",void 0)},608531:(e,t,n)=>{"use strict";n.d(t,{B:()=>r.B});var r=n(818067)},610898:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var r=function(){function e(){var e=this;this.completion=void 0,this.resolveCompletion=void 0,this.completion=new Promise((function(t){e.resolveCompletion=t}))}return e.prototype.complete=function(e){var t;null===(t=this.resolveCompletion)||void 0===t||t.call(this,e)},e}()},610918:(e,t,n)=>{"use strict";n.d(t,{_e:()=>s,ey:()=>l,uc:()=>c,w2:()=>r});var r,o,a,i=n(990813),s="Office.Word.Copilot",c=s+".";!function(e){e[e.WordCopilotAppLevel=0]="WordCopilotAppLevel",e[e.WordCopilotCreate=1]="WordCopilotCreate",e[e.WordCopilotSummarize=2]="WordCopilotSummarize",e[e.WordCopilotAsk=3]="WordCopilotAsk",e[e.WordCopilotCommand=4]="WordCopilotCommand",e[e.WordCopilotDesigner=5]="WordCopilotDesigner",e[e.WordCopilotBackstageUsage=6]="WordCopilotBackstageUsage"}(r||(r={})),function(e){e.CopilotUsageAnyFeatureTransformative="CopilotUsageAnyFeatureTransformative",e.CopilotUsageCreateMTE="CopilotUsageCreateMTE",e.CopilotUsageSummarizeMTE="CopilotUsageSummarizeMTE",e.CopilotUsageAskMTE="CopilotUsageAskMTE",e.CopilotUsageCommandMTE="CopilotUsageCommandMTE",e.CopilotUsageDesignerMTE="CopilotUsageDesignerMTE",e.CopilotUsageChatBackstageMTE="CopilotUsageChatBackstageMTE"}(o||(o={}));var l=(a={},(0,i._)(a,0,"CopilotUsageAnyFeatureTransformative"),(0,i._)(a,1,"CopilotUsageCreateMTE"),(0,i._)(a,2,"CopilotUsageSummarizeMTE"),(0,i._)(a,3,"CopilotUsageAskMTE"),(0,i._)(a,4,"CopilotUsageCommandMTE"),(0,i._)(a,5,"CopilotUsageDesignerMTE"),(0,i._)(a,6,"CopilotUsageChatBackstageMTE"),a)},613903:(e,t,n)=>{"use strict";n.d(t,{v:()=>a});var r=n(656904),o=n(242154);function a(e){return(0,o.cY)("Setting basic chat props here"),{citationTitle:(0,r.d_y)(),isFluxFlowEnabled:e,isCitationsEnabled:!0}}},616478:(e,t,n)=>{"use strict";n.d(t,{d:()=>l});var r=n(86511),o=n(475119),a=n(423905),i=n(83437),s=n(309500),c=[(0,o.cU)(),(0,o.$H)()],l=function(e,t,n){var l,u,d,_,p=function(e){for(var t=e.toLocaleLowerCase(),n=0,r=c;n<r.length;n++){var o=r[n];if(t===o.toLocaleLowerCase())return o}}(e);return!!p&&(o.EG.logSeenEvent("Realtime Voice","Realtime Voice",r.RX.Voice),o.EG.sendChatEventTelemetry((0,a.pN)(((l={})[i.h3.ChatEventType]=i.a5.VoiceCopilotZQMSubmitted,l[i.h3.ChatEventParameters]=p,l))),t&&(n?(t.addResponseMessage((0,s.S)()),o.EG.sendChatEventTelemetry((0,a.pN)(((u={})[i.h3.ChatEventType]=i.a5.VoiceCopilotZQMAutoStarted,u[i.h3.ChatEventParameters]=p,u))),null===(_=t.openRealtimeVoiceCopilot)||void 0===_||_.call(t,"SpeakWithCopilotZQM")):t.addResponseMessage((0,s.P)((function(){var e,n;o.EG.sendChatEventTelemetry((0,a.pN)(((e={})[i.h3.ChatEventType]=i.a5.VoiceCopilotZQMResponseClicked,e[i.h3.ChatEventParameters]=p,e))),null===(n=t.openRealtimeVoiceCopilot)||void 0===n||n.call(t,"SpeakWithCopilotZQM")}))),o.EG.sendChatEventTelemetry((0,a.pN)(((d={})[i.h3.ChatEventType]=i.a5.VoiceCopilotZQMResponseRendered,d[i.h3.ChatEventParameters]=p,d)))),!0)}},632197:(e,t,n)=>{"use strict";n.d(t,{t:()=>r});var r=function(e){var t,n;return{accessToken:e.accessToken,expirationTime:null!==(n=null===(t=null==e?void 0:e.expiresOn)||void 0===t?void 0:t.getTime())&&void 0!==n?n:0}}},636854:(e,t,n)=>{"use strict";n.d(t,{d:()=>l});var r=n(533969),o=n(992640),a=n(61714),i=n(610898),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},c=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},l=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.getToken=function(e){return s(this,void 0,void 0,(function(){var t,n,s;return c(this,(function(c){switch(c.label){case 0:return t=(0,a.A)(),(0,o.d)(t,r.o.AuthService,r.L.GetToken,{request:e}),n=new i.N,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return s=c.sent(),[2,JSON.parse(s)]}}))}))},e}()},638753:(e,t,n)=>{"use strict";n.d(t,{An:()=>x,Bp:()=>I,Cs:()=>A,Hm:()=>M,Id:()=>v,Ne:()=>D,Px:()=>P,QH:()=>w,QY:()=>B,_H:()=>L,bt:()=>U,gZ:()=>R,hU:()=>E,hX:()=>h,if:()=>k,jw:()=>S,nh:()=>C,sZ:()=>m,y5:()=>y,zR:()=>O});var r=n(423905),o=n(243912),a=n(241273),i=n(822606),s=n(752567),c=n(718033),l=n(486092),u=n(511559),d=n(660606),_=n(83437),p=function(){return p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},p.apply(this,arguments)},g=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},f=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function h(e){return null==e}function C(e){switch(e){case a.ut.Enterprise:return"Enterprise";case a.ut.Consumer:return"Consumer";default:return"Unknown"}}function m(){var e;null===(e=window.document.getElementById(i.Os))||void 0===e||e.style.setProperty("display","none")}var v=function(e,t,n,r,o){var i=t!==a.Gm.defaultWhite&&t!==a.Gm.themeColorful?p({isDarkModeEnabled:!0,isHighContrastModeEnabled:n},(0,s.W)(e)):p({isDarkModeEnabled:!1,isHighContrastModeEnabled:n},(0,c.a)(e));return i.dir=r,o&&i.isDarkModeEnabled&&Object.entries(o).forEach((function(e){var t=e[0],n=e[1];i[t]=n})),i},E=function(e){return{displayCategory:e.map((function(e){return{value:e}}))}},y=function(e){var t={PC:"1",OFFICEONLINE:"2",MAC:"3",IOS:"4"}[Office.context.diagnostics.platform.toString().toUpperCase()]||"Unknown",n=[{key:"App name",value:Office.context.diagnostics.host.toString().toUpperCase()},{key:"App version",value:Office.context.diagnostics.version},{key:"App platform",value:t},{key:"Chat environment",value:b(window.location.href,e)},{key:"Chat version",value:T(window.location.href)}];return n.map((function(e){return t=e.key,n=e.value,"".concat(t," : ").concat(n);var t,n})).join("\n")};function b(e,t){var n="0",r=e.toLowerCase();return""===e||(r.includes("dod.cdn")?n="6.3":r.includes("gcc.cdn")?n="6.1":r.includes("gcch.cdn")?n="6.2":(r.includes("public.cdn")||r.includes(".resources.office"))&&r.includes("033f92d3")?n="5":(r.includes("public.cdn")||r.includes(".resources.office"))&&r.includes("f7024bdc")&&t.includes("dogfood")?n="2":(r.includes("public.cdn")||r.includes(".resources.office"))&&r.includes("f7024bdc")&&(t.includes("msit.augloop")||t.includes("augloop.office.com"))&&(n="3")),n}function T(e){var t=e;if(""===t)(0,d.cY)("SDXjs URL is empty");else{if(t.split("/").length>9)return t.split("/")[7];if(t.split("/").length>6&&t.split("/").length<10)return t.split("/")[4]}return""}function I(e){(0,d.cY)("launchThisVersionOfSDX():"+e);var t=window.location.href;""===e?(0,d.cY)("launchThisVersionOfSDX() is empty"):t.split("/").length>9?e!==t.split("/")[7]&&((0,d.cY)("launchThisVersionOfSDX difference detected"),window.location.href=t.replace(t.split("/")[7],e)):t.split("/").length>6&&t.split("/").length<10&&e!==t.split("/")[4]&&((0,d.cY)("launchThisVersionOfSDX difference detected"),window.location.href=t.replace(t.split("/")[4],e))}function P(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.join(" ")}var A=function(){return"undefined"!=typeof OfficeaicopilotStrings},D=function(e){var t,n,o,a;if(!h(e))return(0,d.cY)("Chat Message header received in response chatMessageHeaderType: ",e.chatMessageHeaderType),e.chatMessageHeaderType===u.Hu.Personalization_Indicator&&((0,d.cY)("Personalization header received in response"),d.EG.sendChatEventTelemetry((0,r.pN)(((t={})[_.h3.ChatEventType]=_.a5.PersonalizationIndicatorShown,t[_.h3.IsPersonalizedResponse]=!0,t))),d.EG.sendLatencyTelemetry((0,r.pN)(((n={})[_.CT.IsPersonalizedResponse]=!0,n)))),{titleText:null!==(o=null==e?void 0:e.title)&&void 0!==o?o:"",popoverText:null!==(a=null==e?void 0:e.expandedTitle)&&void 0!==a?a:void 0}};function S(e){return""===e}function M(e,t){return{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,showAnimation:!0,isFailure:!1,feedbackData:h(d.t6.getFeedbackData)?void 0:d.t6.getFeedbackData(t,e)}}var O=function(e,t,n,r){return g(void 0,void 0,void 0,(function(){var o;return f(this,(function(a){switch(a.label){case 0:return[4,e(i.oU,["ResourceConstrainedToken.PAC"])];case 1:return o=a.sent(),[2,fetch(t,p(p({},r),{headers:p(p({},null==r?void 0:r.headers),{Authorization:o.token,"X-SPOPacToken":n})}))]}}))}))};function k(e){var t=Array.from(e,(function(e){return String.fromCodePoint(e)})).join("");return btoa(t)}var L=function(e){return"bot"===e.author&&"GeneratedCode"===e.messageType},w=function(e,t){return{shouldShowViewCodeButton:t,code:null==e?void 0:e.text,stdout:""}};function R(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}var U=function(e,t){if(t)for(var n in e)e[n]=(0,l.z)(e[n],t[n]);return e},B=function(e){if(!e)return"";return e.replace(/\.(docx?|pptx?|xlsx?|pdf|txt|html?|csv|rtf|zip|rar|png|jpe?g|gif|svg)$/i,"")},x=function(e,t){var n;(null===(n=null==e?void 0:e.current)||void 0===n?void 0:n.updateExecutionStatusForAddInActions)&&e.current.updateExecutionStatusForAddInActions(t)}},639985:(e,t,n)=>{"use strict";n.d(t,{s:()=>N,m:()=>K});var r,o=n(743032),a=n(990813),i=n(379490),s=n(965801),c=n(140889),l=n(656904),u=n(811912),d=n(791165),_=n(57008),p=n(156845),g=n(769449),f=n(46727),h=n(610918),C=n(348234),m=n(146931),v=n(260697),E=n(928499),y=n(242154),b=n(297309),T=(r=(0,o._)((function(e){var t,n,r,a,s,c,l,u,d,_;return(0,i.__generator)(this,(function(p){switch(p.label){case 0:(0,y.cY)("prepareTextIndices: preparing text indices for paginated card"),t=e.arguments.indices,n=[],"object"==typeof t&&"string"===t.type&&(n=JSON.parse(t.string)),r=[],a=!0,s=!1,c=void 0,p.label=1;case 1:p.trys.push([1,6,7,8]),l=function(){var e;return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return(e=d.value).includes(":")?(r.push(e),[3,4]):[3,1];case 1:return t.trys.push([1,3,,4]),[4,Word.run(function(){var t=(0,o._)((function(t){var n,o;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return n=t.document.body.paragraphs,[4,t.sync()];case 1:return a.sent(),o=b.Y.getParagraphRangeFromTileId(e,n),r.push("".concat(e,":").concat(o.text)),[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 2:return t.sent(),[3,4];case 3:return t.sent(),(0,y.cY)("prepareTextIndices: failed to retrieve text for index: "+e),[3,4];case 4:return[2]}}))},u=n[Symbol.iterator](),p.label=2;case 2:return(a=(d=u.next()).done)?[3,5]:[5,(0,i.__values)(l())];case 3:p.sent(),p.label=4;case 4:return a=!0,[3,2];case 5:return[3,8];case 6:return _=p.sent(),s=!0,c=_,[3,8];case 7:try{a||null==u.return||u.return()}finally{if(s)throw c}return[7];case 8:return[2,n]}}))})),function(e){return r.apply(this,arguments)}),I=function(e){var t=(0,v._)(e.split(":"));t[0];return t.slice(1).join(":")},P=function(){var e=(0,o._)((function(e,t,n){var r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return(0,y.cY)("Preparing modified ODSL program for semantic selection of textIndex: ".concat(n)),r=function(e,t){return[{name:"selectTextIndex",returns:"ranges",arguments:{index:{type:"string",string:"".concat(t)}}}].concat((0,E._)(e))}(e,n),[4,t(r)];case 1:return o.sent(),(0,y.cY)("Finished executing modified ODSL program for semantic selection of textIndex: ".concat(n)),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),A=function(){var e=(0,o._)((function(e){var t;return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Word.run(function(){var t=(0,o._)((function(t){var n,r,o,a,s,c,u,d;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return[4,(0,_.selectTextIndex)({context:t,index:e})];case 1:return(null==(n=i.sent())?void 0:n.length)?[4,n[0].select(Word.SelectionMode.end)]:[2];case 2:i.sent(),r=!0,o=!1,a=void 0,i.label=3;case 3:i.trys.push([3,8,9,10]),s=n[Symbol.iterator](),i.label=4;case 4:return(r=(c=s.next()).done)?[3,7]:(u=c.value,[4,b.Y.highlightRangeWithDuration(u,t,l.Qa9)]);case 5:i.sent(),i.label=6;case 6:return r=!0,[3,4];case 7:return[3,10];case 8:return d=i.sent(),o=!0,a=d,[3,10];case 9:try{r||null==s.return||s.return()}finally{if(o)throw a}return[7];case 10:return[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),(0,y.cY)("locateTextIndex: error in highlighting: "+e+" because of "+t),[3,3];case 3:return[2]}}))}));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=(0,o._)((function(e,t,n){var r;return(0,i.__generator)(this,(function(o){switch(o.label){case 0:return(0,y.cY)("Preparing modified ODSL program for semantic selection of all textIndices"),r=function(e,t){var n=JSON.stringify(t);return[{name:"selectIndices",returns:"ranges",arguments:{indices:{type:"string",string:"".concat(n)}}}].concat((0,E._)(e))}(e,n),[4,t(r)];case 1:return o.sent(),(0,y.cY)("Finished executing modified ODSL program for semantic selection of all textIndices"),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),S=n(457476),M=n(862853),O=n(602061),k=n(956775),L=n(740389),w=n(598309),R=n(437408),U=_,B=function(){function e(){(0,u._)(this,e)}return(0,d._)(e,null,[{key:"handleSemanticSelectionProgram",value:function(e){var t=this;return(0,o._)((function(){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return(0,y.cY)("Semantic Selection ODSL program detected: ".concat(e)),[4,T(e[0])];case 1:return n=r.sent(),(0,S.pi)(n,I,A,P.bind(null,e.slice(1),t.handleProgramStatements),D.bind(null,e.slice(1),t.handleProgramStatements)),[2,l.rIt.SUCCESS]}}))}))()}},{key:"handleProgramStatements",value:function(e,t){return(0,o._)((function(){var t,n,r,a;return(0,i.__generator)(this,(function(s){switch(s.label){case 0:return n=JSON.stringify(e),(0,y.cY)("Entered Commanding Handler\nProgram:\n".concat(n)),[4,(0,p.yJ)()];case 1:return s.sent(),r=(new Date).getTime(),[4,Word.run(function(){var n=(0,o._)((function(n){return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return[4,U.executeStatements(n,e)];case 1:return t=r.sent(),(0,y.cY)("log result : "+(t===l.rIt.SUCCESS?"Success":t===l.rIt.PARTIAL_SUCCESS?"Partial Success":"Failed")),[2]}}))}));return function(e){return n.apply(this,arguments)}}())];case 2:return s.sent(),[4,(0,p.$C)()];case 3:return s.sent(),a=(0,O.WUi)(r),(0,g.$1)(a),(0,w.cU)((0,M.w5)()),[2,t]}}))}))()}},{key:"copilotOdslProcessor",value:function(e,t,n,r,a){var s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=this;return(0,o._)((function(){var t,o,d,_,p,v,E,b,T,I,P,A,D,O,U,B;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(0,y.cY)("odslResponse",e),d=null==e||null===(t=e.odsl)||void 0===t?void 0:t.statements,_=d.length>0&&"undoApplication"===(null===(o=d[0])||void 0===o?void 0:o.name),d&&0!==d.length?(p=(0,w.cU)((0,M.w5)()),(0,L.cVe)()&&((x=d).length>0&&"selectIndices"===x[0].name)?[4,u.handleSemanticSelectionProgram(d)]:[3,2]):((0,g.Nx)(k.querySubmitTime,!1),(0,R.yS)(d,!1),[2]);case 1:if(i.sent(),p&&s)return a&&a(l.rIt.SUCCESS,s,C.Aw.success),(0,g.Nx)(k.querySubmitTime,!0),(0,R.yS)(d,!0),[2];i.label=2;case 2:return[4,u.handleProgramStatements(d)];case 3:return v=i.sent(),E=C.Aw.failed,b="",v===l.rIt.CONTENT_NOTFOUND?(T=(0,l.Csj)()?WordCopilot.ContentNotFoundForCriteria:"I couldn't find the text you're referring to. Try rephrasing your request.",I={chatEventType:c.a5.ExecutionStatusContentNotFound,chatEventParam:"Commanding",chatErrorType:l.T__.Client,ashaErrorDetails:{vetoName:(0,g.CI)(c.eJ.Command,c.G8.UnableToCompleteTask),errorString:c.av.ContentNotFoundForCriteria,featureName:c.CC.Commanding}},b=T,p&&a&&a(v,s,E,b,I),(0,L.QS5)()||!p?(P={errorMessage:T,errorType:"ContentNotFoundForCriteria",featureName:c.CC.Commanding},(0,S.KY)(T,!0,void 0,I,void 0,void 0,void 0,P)):(0,g.Nx)(k.querySubmitTime,!1)):v===l.rIt.FAILED?(A=(0,l.Csj)()?WordCopilot.CommandingFailure:"Something went wrong. Please try again in a moment. ",D={chatEventType:c.a5.ExecutionStatusFailed,chatEventParam:"Commanding",chatErrorType:l.T__.Client,ashaErrorDetails:{vetoName:(0,g.CI)(c.eJ.Command,c.G8.UnclassifiedError),errorString:c.av.ExecutionStatusFailed,featureName:c.CC.Commanding}},b=A,p&&a&&a(v,s,E,b,D),(0,L.QS5)()||!p?(O={errorMessage:A,featureName:c.CC.Commanding,errorType:"CommandingFailure"},(0,S.KY)(A,!0,void 0,D,c.CC.Commanding,void 0,void 0,O)):(0,g.Nx)(k.querySubmitTime,!1)):v===l.rIt.PARTIAL_SUCCESS?(E=C.Aw.success,p?a&&a(v,s,E):(0,S.KV)(_,(0,y.k7)(),!0,!0,r),(0,g.Nx)(k.querySubmitTime,!0)):(E=C.Aw.success,U=v===l.rIt.SUCCESS&&n.length>0&&""!==n[0],B=U?n[0]:(0,y.h)(),U?(0,y.cY)("showing ai explanation from actionai: ".concat(n[0])):(0,y.cY)("showing default explanation from actionai"),p?(a&&a(v,s,E),(0,L.emG)()&&(0,S.KV)(_,B,!0,!m.sL.getInstance().getWordAppCopilotStreamingState())):(0,S.KV)(_,B,!0,!0,r),(0,g.Nx)(k.querySubmitTime,!0)),f.h.logSurveyTriggerEvent(h.w2.WordCopilotCommand,v===l.rIt.PARTIAL_SUCCESS||v===l.rIt.SUCCESS),[2]}var x}))}))()}}]),e}(),x=n(965562),W=n(86511),F=n(448397),N=function(){var e=(0,o._)((function(e,t,n,r){var o,a;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(o=null==e?void 0:e.body)?(a=e.body.contextId,(0,g.G4)(s.Sy.getTypeName(),a,void 0,t,!1,!1,!1,r),[4,K(o,n)]):((0,y.cY)("Empty body in response Copilot chat. Returning"),[2]);case 1:return i.sent(),[2]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),K=function(){var e=(0,o._)((function(e,t){var n,r,o,u,d,_,p,f,h,C,m,v,E,b,T,I,P,A,D,M,O,k,w,U,N,K=arguments;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:if(n=K.length>2&&void 0!==K[2]&&K[2],r=K.length>3&&void 0!==K[3]?K[3]:void 0,u=null==e||null===(o=e.odsl)||void 0===o?void 0:o.statements,(d=null==e?void 0:e.rephrasedQuery)&&(0,y.cY)("received rephrasedQuery from actionai: ".concat(d)),_=null==e?void 0:e.aiResponses,p=[],f=[],h="",_){C=!0,m=!1,v=void 0;try{for(E=_[Symbol.iterator]();!(C=(b=E.next()).done);C=!0)"explanations"===(T=b.value).type&&0==p.length&&T.value.explanations.length>0?p=T.value.explanations:"suggestions"===T.type&&T.value.suggestions.length>0?f=T.value.suggestions:"disambiguations"===T.type&&T.value.question&&(h=T.value.question)}catch(e){m=!0,v=e}finally{try{C||null==E.return||E.return()}finally{if(m)throw v}}}return u&&0!==u.length?((0,y.cY)("Parsing ODSL..."),(0,y.cY)("Odsl response: ",e),u.find((function(e){return e.name===l.nbn}))&&(e.odsl.statements=void 0),(0,L.ZEr)()?((0,y.cY)("Commanding prompt executing"),F.B.getInstance().logTriedEvent(W.rf.Commanding,c.CC.Commanding,W.RX.Command),F.B.getInstance().sendLatencyTelemetry((0,g.pN)((0,a._)({},c.CT.FeatureName,c.CC.Commanding))),[4,B.copilotOdslProcessor(e,null,p,_,r,n)]):[3,2]):[3,4];case 1:return i.sent(),t&&t([]),[3,3];case 2:(0,y.cY)("Flight not enabled for commanding"),P={chatEventType:c.a5.LightCommandingDisabled,chatEventParam:"IntentDetection",chatErrorType:l.T__.Client,ashaErrorDetails:{vetoName:(0,g.CI)(c.eJ.Command,c.G8.UnsupportedFunctionality),errorString:c.av.LightCommandingDisabled,featureName:c.CC.Commanding}},(0,S.KY)((0,l.A3k)(),!0,void 0,P),(0,R.yS)(null==e||null===(I=e.odsl)||void 0===I?void 0:I.statements,!1),i.label=3;case 3:return f.length>0&&(0,y.cY)("ai suggestions received in response: "+f),[3,5];case 4:D=null==e?void 0:e.error,h?((0,y.cY)("showing disambiguation from actionai: ".concat(h)),M={featureName:c.CC.Commanding},(0,S.rX)(h,void 0,void 0,void 0,void 0,void 0,M)):D?((0,y.cY)("showing actionai error response card in chat"),(O=x.p.getErrorHandlingStrategy(e))&&(k=O.getErrorMessage(e),w={errorMessage:k.message,errorType:k.errorType,featureName:c.CC.Commanding},(0,S.KY)(k.message,!0,k.helpLink,void 0,void 0,!0,!0,w))):(U={chatEventType:c.a5.ODSLAndErrorNotFound,chatEventParam:s.Sy.getTypeName(),chatErrorType:l.T__.Client,ashaErrorDetails:{vetoName:(0,g.CI)(c.eJ.UnclearIntent,c.G8.UnclassifiedError),errorString:c.av.ODSLAndErrorNotFound,featureName:c.CC.Commanding}},N={errorMessage:(0,l.A3k)(),errorType:"ODSLAndErrorNotFound",featureName:c.CC.Commanding},(0,S.KY)((0,l.A3k)(),!0,void 0,U,void 0,void 0,void 0,N)),(0,R.yS)(null==e||null===(A=e.odsl)||void 0===A?void 0:A.statements,!1,D.message),i.label=5;case 5:return[2]}}))}));return function(t,n){return e.apply(this,arguments)}}()},643136:(e,t,n)=>{"use strict";n.d(t,{G:()=>l});var r=n(533969),o=n(992640),a=n(61714),i=n(610898),s=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},c=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},l=function(){function e(){this.requestByQueryId=new Map}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.addResponse=function(e,t){var n=this.requestByQueryId.get(e);n&&(this.requestByQueryId.delete(e),n.complete(t))},e.prototype.botInvoke=function(e){return s(this,void 0,void 0,(function(){var t,n,s;return c(this,(function(c){switch(c.label){case 0:return t=(0,a.A)(),(0,o.d)(t,r.o.ChannelService,r.L.BotInvoke,{request:e}),n=new i.N,this.requestByQueryId.set(t,n),[4,n.completion];case 1:return s=c.sent(),[2,JSON.parse(s)]}}))}))},e.prototype.botMessage=function(e){return s(this,void 0,void 0,(function(){return c(this,(function(e){throw new Error("Method not implemented.")}))}))},e}()},644022:(e,t,n)=>{"use strict";var r=n(475119);n(767370);try{var o=n(956775);o.ExternalAuthService,o.ChannelService,o.MosAppService}catch(e){try{var a=n(5489);a.ExternalAuthService,a.ChannelService,a.MosAppService}catch(e){(0,r.cY)("Neither @1js/officeaicopilot-chat-core nor @1js/officeaicopilot-chat could be loaded")}}},647428:(e,t,n)=>{"use strict";n.d(t,{BI:()=>r.BI,xR:()=>r.xR});var r=n(480591)},648284:(e,t,n)=>{"use strict";n.d(t,{SL:()=>g,Xh:()=>C,a2:()=>h,q1:()=>p});var r=n(514931),o=n(61714),a=n(243912),i=n(555799),s=n(644275),c=n(423905),l=n(475119),u=n(83437),d=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},_=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},p=function(e){return d(void 0,void 0,void 0,(function(){return _(this,(function(t){switch(t.label){case 0:return e&&r.xP.getCurrentAddinState()===r.aB.HasAction?[4,e()]:[3,2];case 1:t.sent(),r.xP.transitionAddinState(r.aB.Idle),t.label=2;case 2:return[2]}}))}))},g=function(e){try{var t=JSON.parse(e);if(f(t))return{id:(0,o.A)(),type:"text/adaptivecardtemplate",data:e,description_for_model:e}}catch(e){}return{id:(0,o.A)(),type:"text/plain",data:e,description_for_model:e}},f=function(e){return!(!e||"object"!=typeof e)&&("type"in e&&"AdaptiveCard"===e.type&&("body"in e&&"object"==typeof e.body))};function h(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!0);var r={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:a.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:void 0},o={chatCardType:i._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:r,stopLoadingUi:n,startAugloopTimerForStreaming:!1,addCardToChatHistory:t};return(0,l.cY)("Add in invocation error response message: ".concat(o)),o}function C(e){var t;l.EG.sendErrorTelemetry((0,c.pN)(((t={})[u.IC.ErrorCategory]=u.S2.LocalAddinActionExecution,t[u.IC.ErrorMessage]=e,t))),(0,l.cY)("Error executing client skill from TriggerPlugin message: \n",e)}},648448:(e,t,n)=>{"use strict";n.d(t,{I:()=>d,Y:()=>u});var r=n(634694),o=n(623268),a=n(502402),i=n(397574),s=n(656904),c=n(720971),l=n(740389),u=function(e){var t,n=[],u=function(e){var t=[],n=!1,o=!1;switch(e){case c.S.enableQnA:n=!0;break;case c.S.enableSummary:case c.S.maxLimit:n=!0,o=!0}if(n||o)return n&&t.push({nodeType:"ActionSet",text:s.UeP.tellMeMore()}),o&&t.push({nodeType:"ActionSet",text:s.UeP.summarize()}),n&&(t.push({nodeType:"ActionSet",text:s.UeP.listProsAndCons()}),t.push({nodeType:"ActionSet",text:s.UeP.impDeadlines()}),t.push({nodeType:"ActionSet",text:s.UeP.showStakeHolders()})),{nodeType:"Category",text:s.hn.menuSectionUnderstand(),promptCategory:"Understand",iconRegular:r.uJg,iconHover:r._38,children:t}}(e);return u&&n.push(u),n.push(function(e){var t=[];return t.push({nodeType:"ActionSet",text:s.UeP.help(),data:{shouldSubmitQueryOnClick:!0}}),t.push({nodeType:"ActionSet",text:s.UeP.howToAddTable()}),e!==c.S.enableQnA&&e!==c.S.enableSummary&&e!==c.S.maxLimit||t.push({nodeType:"ActionSet",text:s.UeP.howToImproveDocument()}),{nodeType:"Category",text:s.hn.menuSectionAsk(),promptCategory:"Ask",iconRegular:o.I11,iconHover:o.kNP,children:t}}(e)),(0,l.tPu)()&&n.push(function(e){var t=[],n=!1;switch(e){case c.S.enableQnA:case c.S.enableSummary:case c.S.maxLimit:n=!0}return n&&t.push({nodeType:"ActionSet",text:s.UeP.generateBanner(),data:{shouldSubmitQueryOnClick:!0}}),t.push({nodeType:"ActionSet",text:s.UeP.generateImage()}),{nodeType:"Category",text:s.hn.menuSectionDesign(),promptCategory:"Design",iconRegular:a.dG$,iconHover:a.$m8,children:t}}(e)),(0,l.lH6)()&&(0,l.y2i)()&&n.push(((t=[]).push({nodeType:"ActionSet",text:s.UeP.whatCanCopilotProfileDo(),data:{shouldSubmitQueryOnClick:!0}}),t.push({nodeType:"ActionSet",text:s.UeP.createMyCopilotProfile()}),{nodeType:"Category",text:s.hn.menuSectionCustomize(),promptCategory:"Customize",iconRegular:i.afj,iconHover:i.MOA,children:t})),n},d=function(e){return{promptGuideMenuData:{nodeType:"Root",text:s.hn.menuTitle(),children:u(e)}}}},649213:(e,t,n)=>{"use strict";n.d(t,{Y:()=>p});var r=n(743032),o=n(811912),a=n(791165),i=n(990813),s=n(379490),c=n(555799),l=n(644275),u=n(111246),d=n(457476),_=n(602061),p=function(){function e(){(0,o._)(this,e),(0,i._)(this,"plugins",[{name:"createWordDocument",nameWithUnderscore:"create_word_document",description:"Create a Word document with a given topic or from some existing content",parameters:{type:"object",properties:{query:{type:"string",description:"Query from user containing the document creation request"},context:{type:"Document",description:"Existing documents to be used for creating the new document"}},required:["query"]},returns:{type:"Document",description:"The created Word document"}},{name:"summarizeWordDocument",nameWithUnderscore:"summarize_word_document",description:"Summarize a Word document",parameters:{type:"object",properties:{document:{type:"Document",description:"The Word document to be summarized"}},required:["document"]},returns:{type:"string",description:"The summarized content of the Word document"}},{name:"createPresentation",nameWithUnderscore:"create_presentation",description:"Create a PowerPoint presentation with a given topic or from some existing content",parameters:{type:"object",properties:{query:{type:"string",description:"Query from user containing the presentation creation request"},slides:{type:"integer",description:"Number of slides to be created"},context:{type:"Document",description:"Existing documents to be used for creating the new presentation"}},required:["query","slides"]},returns:{type:"Document",description:"The created presentation"}},{name:"summarizePresentation",nameWithUnderscore:"summarize_presentation",description:"Summarize a presentation. Can only summarize the whole presentation, not individual slides.",parameters:{type:"object",properties:{presentation:{type:"Document",description:"The presentation to be summarized"}},required:["presentation"]},returns:{type:"string",description:"The summarized content of the presentation"}},{name:"addSlides",nameWithUnderscore:"add_slides",description:"Generate slides to an existing PowerPoint presentation",parameters:{type:"object",properties:{position:{type:"integer",description:"The location that the new slide will be added after. 0 for the beginning and -1 for the end."},slides:{type:"integer",description:"Number of slides to be added"},content:{type:"string",description:"A short description of the content for new slides to be generated"}},required:["position","slides","content"]},returns:{type:"Document",description:"The updated presentation with added slides"}},{name:"createExcelSheet",nameWithUnderscore:"create_excel_sheet",description:"Create an Excel spreadsheet with a given topic or from some existing content",parameters:{type:"object",properties:{query:{type:"string",description:"Request from user"},context:{type:"Document",description:"Existing documents to be used for creating the new Excel sheet as a reference"}},required:["query"]},returns:{type:"Document",description:"The created Excel sheet"}},{name:"summarizeSpreadsheet",nameWithUnderscore:"summarize_spreadsheet",description:"Summarize an Excel spreadsheet.",parameters:{type:"object",properties:{spreadsheet:{type:"Document",description:"The spreadsheet to be summarized"}},required:["spreadsheet"]},returns:{type:"string",description:"The summarized content of the spreadsheet"}},{name:"sendEmail",nameWithUnderscore:"send_email",description:"Send an email with a given subject and content",parameters:{type:"object",properties:{to:{type:"string",description:"Full email addresses of the recipients, separated by commas"},subject:{type:"string",description:"The subject of the email"},body:{type:"string",description:"The content of the email"},attachments:{type:"array",description:"The attachments to be included in the email"}},required:["subject","content"]},returns:{type:"string",description:"The confirmation message of the email sent"}},{name:"getSapInvoices",nameWithUnderscore:"get_sap_invoices",description:"Get SAP invoices for a given date range",parameters:{type:"object",properties:{start_date:{type:"string",description:"The start date of the date range"},end_date:{type:"string",description:"The end date of the date range"}},required:["start_date","end_date"]},returns:{type:"Document",description:"The invoices retrieved from SAP"}},{name:"createSapOrder",nameWithUnderscore:"create_sap_order",description:"Create a SAP order with a given product and quantity",parameters:{type:"object",properties:{product:{type:"string",description:"The product to be ordered"},quantity:{type:"number",description:"The quantity of the product to be ordered"}},required:["product","quantity"]},returns:{type:"Document",description:"The order confirmation from SAP"}},{name:"onSchedule",nameWithUnderscore:"on_schedule",description:"Schedule a program that contains a number of functions to run at a specific interval",parameters:{type:"object",properties:{interval:{type:"string",description:"The interval at which the program should run"}},required:["interval"]},returns:[{type:"null",description:"This function does not return anything"}]},{name:"searchEnterpriseEmails",nameWithUnderscore:"search_enterprise_emails",description:"Search for emails in the work account's inbox based on a query",parameters:{type:"object",properties:{query:{type:"string",description:"The search query"}},required:["query"]},returns:[{type:"List[Document]",description:"The emails that match the search query"}]}])}return(0,a._)(e,[{key:"BYOAgentResponseHandler",value:function(e){var t=this;return(0,r._)((function(){var n,r,o,a,i,p,g,f,h,C,m;return(0,s.__generator)(this,(function(s){n=e.body;try{(null==n||null===(o=n.odslResponse)||void 0===o||null===(r=o.odsl)||void 0===r?void 0:r.statements)&&(null==n||null===(i=n.odslResponse)||void 0===i||null===(a=i.odsl)||void 0===a?void 0:a.statements.length)>0?(m=t.handleODSLResponse(n.odslResponse.odsl.statements),u.$.getInstance().displayResponse({chatCardType:c._.AgentPlanBuilderCard,chatMessageData:{agentPlanBuilderCardProps:{user:l.Q9.Chat,chatMessage:"",tasks:m,handleStartClicked:function(e){(0,_.cY_)("User requested to start plan",JSON.stringify(e))}}}})):(null==n||null===(p=n.odslResponse)||void 0===p?void 0:p.raw)&&((null==n||null===(f=n.odslResponse)||void 0===f||null===(g=f.raw)||void 0===g?void 0:g.includes("on_schedule"))||(null==n||null===(C=n.odslResponse)||void 0===C||null===(h=C.raw)||void 0===h?void 0:h.includes("ODSL")))&&((0,_.cY_)("falling back to raw response for agent plan validation"),t.showValidationCardFromRawResponse(n.odslResponse.raw))}catch(e){(0,d.R1)("Error displaying a plan for the Agent plan "+e.toString(),!1)}return[2]}))}))()}},{key:"handleODSLResponse",value:function(e){var t,n,r=this,o=[];return(t=e,n=function(e){return e.arguments.nested?JSON.parse(e.arguments.nested.json):e},t.reduce((function(e,t){var r=n(t);return e.concat(r)}),[])).forEach((function(e){o.push(r.extractCodeValues(e))})),o}},{key:"extractCodeValues",value:function(e){var t=this,n=[];return e.argumentsArray.forEach((function(r){var o=r.key,a=t.getTaskPropertyType(o),i=r.value[r.value.type];n.push({name:t.getDescriptiveArgumentName(e.name,o),value:i,type:a})})),{title:this.getDescriptiveStatementName(e.name),icon:this.getIcon(e.name.toLowerCase()),taskProperties:n}}},{key:"getTaskPropertyType",value:function(e){switch(e){case"startDate":case"endDate":return"Date";case"to":return"People";default:return"String"}}},{key:"getDescriptiveStatementName",value:function(e){var t,n=null===(t=this.plugins.find((function(t){return t.name===e})))||void 0===t?void 0:t.description;return n||e}},{key:"getDescriptiveStatementNameWithUnderscore",value:function(e){var t,n=null===(t=this.plugins.find((function(t){return t.nameWithUnderscore===e})))||void 0===t?void 0:t.description;return n||e}},{key:"getIcon",value:function(e){return e.includes("email")?"Mail":e.includes("document")||e.includes("word")?"Word":e.includes("presentation")||e.includes("slide")?"PowerPoint":e.includes("spreadsheet")||e.includes("excel")?"Excel":""}},{key:"getDescriptiveArgumentName",value:function(e,t){var n=this.plugins.find((function(t){return t.name===e}));if(n){var r=n.parameters.properties[t].description;return r||t}return t}},{key:"showValidationCardFromRawResponse",value:function(e){var t=this,n=["create_word_document","summarize_word_document","create_presentation","summarize_presentation","add_slides","create_excel_sheet","summarize_spreadsheet","send_email","get_sap_invoices","create_sap_order","search_enterprise_emails"],r=[];e.split("\n").forEach((function(e){n.forEach((function(n){e.includes(n)&&r.push({title:t.getDescriptiveStatementNameWithUnderscore(n),icon:"",taskProperties:[]})}))})),u.$.getInstance().displayResponse({chatCardType:c._.AgentPlanBuilderCard,chatMessageData:{agentPlanBuilderCardProps:{user:l.Q9.Chat,chatMessage:"",tasks:r,handleStartClicked:function(e){(0,_.cY_)("User requested to start plan",JSON.stringify(e))}}}})}}],[{key:"getInstance",value:function(){return e._instance||(e._instance=new e),e._instance}}]),e}();(0,i._)(p,"_instance",void 0)},654752:(e,t,n)=>{"use strict";n.d(t,{DL:()=>o.D,gQ:()=>r.g});var r=n(327099),o=n(758303);n(194054)},656904:(e,t,n)=>{"use strict";n.d(t,{A3k:()=>Q,A92:()=>ye,AF5:()=>wt,Aec:()=>Xe,BFD:()=>Me,Bbi:()=>oe,Bf$:()=>J,Bhx:()=>ut,Bti:()=>me,C5D:()=>de,C8y:()=>A,CY_:()=>Oe,Csj:()=>B,DPI:()=>U,Dmx:()=>un,DwS:()=>Fe,EKU:()=>xe,FEx:()=>Mn,FK:()=>dn,FME:()=>Qe,FT:()=>jt,Fpl:()=>Y,FqO:()=>Te,GPl:()=>Ee,HLn:()=>_e,HN0:()=>$e,Hew:()=>ce,HoP:()=>Ne,I47:()=>k,I4U:()=>Tn,IQ6:()=>F,IQD:()=>ae,I_t:()=>x,JDs:()=>Ke,K4y:()=>yt,L9S:()=>Cn,Lvp:()=>en,Lz_:()=>It,MYv:()=>h,Mgi:()=>ct,Mrv:()=>$,NXZ:()=>it,NlR:()=>X,NnX:()=>Gt,OKS:()=>cn,OOx:()=>St,OY_:()=>se,OZ4:()=>Re,OsU:()=>P,P21:()=>pe,PJ3:()=>Ut,QMY:()=>ke,Qa9:()=>S,RE3:()=>ln,RFL:()=>Jt,RZX:()=>Je,R_I:()=>Be,S1E:()=>_n,T1Y:()=>Ie,T93:()=>qt,TEO:()=>m,T__:()=>lt,UTd:()=>Z,UWp:()=>y,UeP:()=>Qt,UlY:()=>We,UzE:()=>Vt,VGH:()=>p,VJX:()=>I,VMi:()=>Lt,VeX:()=>$t,Vgn:()=>on,ViB:()=>Ue,W1n:()=>Ce,WS6:()=>j,WYm:()=>T,Wat:()=>E,XTZ:()=>tt,YPu:()=>Mt,YgX:()=>Ae,ZAw:()=>an,ZUM:()=>fn,Zid:()=>st,Zor:()=>mn,Zp6:()=>b,alM:()=>w,b5f:()=>Ht,bY3:()=>f,cGI:()=>Pe,chx:()=>q,d7H:()=>ft,dY1:()=>An,d_y:()=>De,eVk:()=>L,edB:()=>le,fGO:()=>be,fS0:()=>bn,fam:()=>kt,fn_:()=>H,g47:()=>ht,gWk:()=>Yt,g_J:()=>Pt,ghp:()=>fe,gji:()=>ie,h1K:()=>V,hW2:()=>g,hiv:()=>Rt,hky:()=>C,hn:()=>Nt,ht0:()=>vn,i7B:()=>En,idh:()=>Sn,ipg:()=>xt,jSG:()=>zt,kOX:()=>Ge,kbu:()=>Kt,kiD:()=>W,klO:()=>Pn,lGm:()=>Le,mPZ:()=>At,n0J:()=>te,nAd:()=>mt,nSc:()=>D,na4:()=>_,nbn:()=>v,nnF:()=>qe,oul:()=>ee,p7z:()=>Dn,pEy:()=>K,pH2:()=>ve,pHk:()=>N,pwx:()=>Tt,q1g:()=>z,q93:()=>vt,qQp:()=>gn,qvg:()=>Bt,qxK:()=>ne,rGh:()=>Xt,rIt:()=>Ye,rq$:()=>He,rs7:()=>M,sVF:()=>gt,s_$:()=>re,sj0:()=>rn,sjW:()=>_t,ssU:()=>pn,tAK:()=>et,tE5:()=>In,tMN:()=>R,tSR:()=>nn,tmB:()=>Ot,tyz:()=>Se,u1i:()=>ze,uYw:()=>O,uoO:()=>at,vYk:()=>Wt,vrM:()=>dt,vy2:()=>hn,vz$:()=>we,wM6:()=>Ct,x0y:()=>rt,x1n:()=>sn,x2O:()=>ge,xE4:()=>Dt,xLU:()=>he,xZn:()=>bt,xb6:()=>Et,xvH:()=>yn,y2K:()=>Zt,y_q:()=>je,ydF:()=>pt,z$7:()=>ue,zYi:()=>Ft});var r,o,a=n(990813),i=n(722603),s=(n(192531),n(740389)),c=n(860093),l=n(140889),u=n(778027),d=n(256234),_=2792113512,p=128,g=4183277502,f=335,h=!1,C="https://go.microsoft.com/fwlink/?linkid=2232302",m="https://go.microsoft.com/fwlink/?linkid=2247805",v="generateRanges",E="Copilot",y="Copilot",b="Whole",T="SINGLE",I="DOUBLE",P="shimmer",A="TaskPaneCloseBtnStatic",D=2e3,S=1e3,M="powerpoint icon",O=1017,k="SYSTEM_DA_code_interpretor_officeai",L="js_execute_id",w="P_301fad66-fa35-ca43-824c-11cd5e9c4cf3.SYSTEM_CreateGPT",R=function(){switch((0,u.xp)()){case d.Y.web:return"cmm3pv3jgm7";case d.Y.MACOS:return"cmmf00jqo9h";case d.Y.IOS:return"cmm3s88a828";default:return"cmmwo79otex"}},U=function(){return(0,u.xp)()===d.Y.MACOS?"wordmac":"word"},B=function(){return"undefined"!=typeof WordCopilot},x=function(){return B()?[WordCopilot.GeneratingAudioOverviewText]:["Generating audio overview..."]},W=function(){return B()?WordCopilot.SelectionAttachmentErrorMessage:"To add a selection, select only text."},F=function(){return"I wasn't able to apply a sensitivity label to this file. Please choose another file or try again."},N=function(){return"Sorry, I can’t create videos in Word yet, but I’m pretty handy with generating images—let me know if I can help."},K="AppChatCopilot",H="Word";!function(e){e[e.START_A_DOCUMENT=0]="START_A_DOCUMENT",e[e.GENERATE_TEXT=1]="GENERATE_TEXT",e[e.GENERATE_TABLE=2]="GENERATE_TABLE",e[e.BRAINSTORM=3]="BRAINSTORM",e[e.ADD_VISUALS=4]="ADD_VISUALS",e[e.TRANSLATE=5]="TRANSLATE",e[e.CHANGE_READING_LEVEL=6]="CHANGE_READING_LEVEL",e[e.GET_SUGGESTIONS_ABOUT=7]="GET_SUGGESTIONS_ABOUT",e[e.ADD_TEXT_ABOUT=8]="ADD_TEXT_ABOUT",e[e.REWRITE_TEXT=9]="REWRITE_TEXT",e[e.ADD_IMAGE=10]="ADD_IMAGE",e[e.CHANGE_TEXT_STYLE=11]="CHANGE_TEXT_STYLE",e[e.GIVE_ME_AN_OVERVIEW=12]="GIVE_ME_AN_OVERVIEW",e[e.EXECUTE=13]="EXECUTE"}(r||(r={}));o={},(0,a._)(o,0,B()?WordCopilot.InlineSuggestionType_StartADocument:"Jumpstart a blank document"),(0,a._)(o,1,B()?WordCopilot.InlineSuggestionType_GenerateText:"Generate text"),(0,a._)(o,2,B()?WordCopilot.InlineSuggestionType_GenerateTable:"Generate a table"),(0,a._)(o,3,B()?WordCopilot.InlineSuggestionType_BrainStorm:"Brainstorm"),(0,a._)(o,4,B()?WordCopilot.InlineSuggestionType_AddVisuals:"Add visuals of"),(0,a._)(o,5,B()?WordCopilot.InlineSuggestionType_Translate:"Translate to"),(0,a._)(o,6,B()?WordCopilot.InlineSuggestionType_ChangeReadingLevel:"Change reading level to"),(0,a._)(o,7,B()?WordCopilot.InlineSuggestionType_GetSuggestionsAbout:"Get suggestions about"),(0,a._)(o,8,B()?WordCopilot.InlineSuggestionType_AddTextAbout:"Add text"),(0,a._)(o,9,B()?WordCopilot.InlineSuggestionType_RewriteText:"Rewrite the text to"),(0,a._)(o,10,B()?WordCopilot.InlineSuggestionType_AddImage:"Add an image of"),(0,a._)(o,11,B()?WordCopilot.InlineSuggestionType_ChangeTextStyle:"Change the text format to"),(0,a._)(o,12,B()?WordCopilot.InlineSuggestionType_GiveMeAnOverview:"Give me an overview"),(0,a._)(o,13,B()?WordCopilot.InlineSuggestionType_Execute:"Execute");var G,Q=function(){return B()?WordCopilot.StillLearning:"I'm still learning and can't answer that. Is there something else I can answer about the document?"},j=function(){return B()?WordCopilot.AdminControlErrorMessage:"Sorry, but your organization's settings don't allow me to do that. Select the prompt guide below for some ideas of what I can do."},Y=function(){return B()?WordCopilot.LearnMoreAssistantResponsePrefix:"I can save you time and boost your creativity in several ways, including:"},z=function(){return B()?WordCopilot.LearnMoreAssistantResponseSuffix:"Use the suggestions here, or tell me what you want to do. In the flow of your writing, watch for the Copilot icon on the page, and select it to get options for drafting and rewriting your text."},q=function(){return B()?WordCopilot.LearnMoreAssistantResponseSuffixLink:"Learn more about Copilot"},V=function(){return B()?WordCopilot.GenericErrorMessage:"I can't do that just yet. Currently I can generate and edit text, summarize, respond to your questions. Try asking me to write about something."},Z=function(){return B()?OfficeaicopilotStrings.DKEAndNotExtractLabelErrorString:"Copilot can't reference this content because your organization's policy doesn't allow it."},J=function(){return B()?OfficeaicopilotStrings.LicenseValidationErrorMessage:"We encountered a problem validating your Copilot license. For more information, see https://aka.ms/copilotlicensecheck"},X=function(){return B()?OfficeaicopilotStrings.RequestTooLongErrorMessage:"I can't help you with this because your description is too long. Please consider shortening your request and try again."},$=function(){return B()?WordCopilot.HelpQueryErrorMessage:"I can generate and edit text, summarize, and respond to your questions. Try asking me to write about something. "},ee=function(){return B()?OfficeaicopilotStrings.ImageInsertionSuccessAnnouncement:"Your image has been inserted."},te=function(e){var t;return e&&void 0!==(t=(0,c.nL)(e))?[t,l.Nr.CopilotUnsupportedLanguageError]:[t=B()?WordCopilot.CopilotUnsupportedlanguageMessage:"Your request includes a language that Copilot doesn't currently support.",l.Nr.CopilotUnsupportedlanguageMessage]},ne=function(e){if(e){var t=(0,c.nL)(e);if(void 0!==t)return t}return B()?WordCopilot.CopilotUnsupportedlanguageMessage:"Your request includes a language that Copilot doesn't currently support."},re=function(){return B()?WordCopilot.CopilotUnsupportedDocumentLanguageErrorMessage:"I can't summarize this document because it includes a language I don't currently support. Try using a different file or tell me how else I can help."},oe=function(){return B()?WordCopilot.CopilotUnsupportedPromptLanguageErrorMessage:"It looks like you've asked me to help in a language that I don't currently support. Try asking me again using a supported language."},ae=function(){return B()?WordCopilot.CopilotUnsupportedPromptRequestedLanguageErrorMessage:"I don't support the language you want for this summary. Please ask me to summarize again using a supported language."},ie=function(){return B()?WordCopilot.NthParagraphSummaryNotSupportedErrorMessage:"I can't summarize a specific part of text. Try asking me a question about the entire document instead."},se=function(){return B()?WordCopilot.SummaryQualityCheckErrorMessage:"I can't generate high-quality content for this. Please try again with a different file or ask a different question."},ce=function(){return B()?WordCopilot.OffensiveContentInput:"You've included content that I can't work with. Try changing the topic or ask me to help you with something else."},le=function(){return B()?WordCopilot.RaiErrorMessage:"Sorry, I'm not able to do that for this document, please try again with a different file or ask a different question."},ue=function(){return B()?WordCopilot.TimeoutErrorMessage:"Something went wrong. Please try again in a moment."},de=function(){return B()?WordCopilot.MultipleQuestionsErrorMessage:"Hold on, try sending one request at a time."},_e=function(){return B()?WordCopilot.OutOfScopeRequestErrorMessage:"I won't be able to help you with that. Try changing the topic or ask me to help you with something else."},pe=function(){return B()?WordCopilot.LocationParameterErrorMessage:"I can't do that just yet. Try asking me a question about the entire document instead."},ge=function(){return B()?WordCopilot.AnswerNotInDocErrorMessage:"I couldn't find an answer to that in this document. Try rephrasing your request to be more specific to the content."},fe=function(){return B()?OfficeaicopilotStrings.ChatHistoryHydrationError:"If this is a continuation of an earlier chat and you want chat history, try closing and reopening the pane."},he=function(){return B()?WordCopilot.UndoButton:"Undo"},Ce=function(){return B()?OfficeaicopilotStrings.UndoCompletionOutputText:"The changes have been reverted."},me=function(){return B()?WordCopilot.StopGeneratingResponseMessage:"OK, I stopped generating content."},ve=function(){return B()?WordCopilot.TopicChangedResponseMessage:"Ok, let's change topics. What would you like to talk about?"},Ee=function(){return B()?WordCopilot.InsertButton:"Insert"},ye=function(){return B()?WordCopilot.InsertResponseMessage:"Certainly! The content was inserted in the document."},be=[{key:"raiError",value:le()},{key:"genericError",value:V()}],Te="%c",Ie=150,Pe=18,Ae="ANNOTATION",De=function(){return B()?WordCopilot.CitationTitle:"This Document"},Se=function(){return B()?WordCopilot.WordLearnMoreLinkMessage:"Learn more"},Me=function(){return B()?WordCopilot.AugloopErrorMessage:"Whoops! I'm not able to understand this yet. Is there something else I can do to help?"},Oe=function(){return B()?WordCopilot.AugloopResponseTimeoutMessage:"Sorry, something went wrong. I'm working on it."},ke=function(){var e,t,n,r;return(null===(t=Office)||void 0===t||null===(e=t.context)||void 0===e?void 0:e.platform)===(null===(r=Office)||void 0===r||null===(n=r.PlatformType)||void 0===n?void 0:n.OfficeOnline)?B()?OfficeaicopilotStrings.AugLoopSeedingFailedTimeoutMessageForWeb:"There's a problem with the app. Try refreshing your browser tab.":B()?OfficeaicopilotStrings.AugLoopSeedingFailedTimeoutMessageForNonWeb:"There's a problem with the app. Please save and reopen this file."},Le=function(){return(B()?WordCopilot.WordResponseLessErrorMessage:"Keep writing! I need at least {0} words to generate a summary.").replace("{0}",(0,s.CSq)().toString())},we=function(){return B()&&WordCopilot.DisengagedError?OfficeaicopilotStrings.DisengagedError:"I can't work with this content. Click on Change Topic to ask a different question."},Re=function(){return B()&&WordCopilot.ThrottlingErrorMessage?WordCopilot.ThrottlingErrorMessage:"You've reached the limit on the number of requests per hour. Try again in a little while."},Ue=function(){return B()&&WordCopilot.CommandNotSupportedMessage?WordCopilot.CommandNotSupportedMessage:"I'm sorry, but I can't do that. I can answer general-purpose questions or those about the document, but I can't make changes to the document itself."},Be=function(){return B()&&OfficeaicopilotStrings.OutOfCreditsError?OfficeaicopilotStrings.OutOfCreditsError:"Unfortunately, I can't complete that request because you're out of AI credits this month. Your credits will refill at the start of the next month."},xe="Debug",We="Report Bug",Fe="Taskpane",Ne="Hidden",Ke=function(){return"I want to get better responses by creating my Copilot profile."},He=function(){return"Your Copilot profile should include your instructions to me about how you want me to answer. To create it, type: 'Create my Copilot profile: [followed by your instructions].'\n\n"},Ge=function(){return"**For example:** \n\n**Create my Copilot profile: Include key people, numbers, and dates when answering a question or summarizing a document.**\n\n"},Qe=function(){return"Once you create your profile, I'll be able to tailor my responses to you and generate personalized summaries and answers. To update your profile, type 'Update my Copilot profile: [followed by your instructions].' You can always ask me to delete your profile.\n\n"},je=function(){return"This feature is available in Word and PowerPoint in the Inner Ring (Dogfood) environment. Use thumbs up/down to send feedback to Feature Crew."};!function(e){e.Animation="Animation",e.Transition="Transition",e.SmartArt="Smartart",e.Undo="Undo",e.Table="Table",e.Background="Background",e.Icons="Icons",e.Audio="Audio",e.Video="Video",e.Theme="Theme"}(G||(G={}));var Ye,ze="",qe=function(){return B()?WordCopilot.ChatPlaceHolderMessage:"Message Copilot"};!function(e){e[e.FAILED=0]="FAILED",e[e.SUCCESS=1]="SUCCESS",e[e.PARTIAL_SUCCESS=2]="PARTIAL_SUCCESS",e[e.EMPTY=3]="EMPTY",e[e.CONTENT_NOTFOUND=4]="CONTENT_NOTFOUND"}(Ye||(Ye={}));var Ve,Ze,Je="Content not found for criteria";!function(e){e.Text="text",e.Shape="shape",e.Image="image"}(Ve||(Ve={})),function(e){e[e.Text=0]="Text",e[e.Shape=1]="Shape",e[e.Image=2]="Image"}(Ze||(Ze={}));var Xe,$e="Signal",et=function(){return B()?WordCopilot.DefaultHelpCardDescription:"You need to write at least 50 words for Copilot to answer questions about this document."},tt=function(){return B()?WordCopilot.QueryLengthTooLongError:"I'm still learning. That request is too large. Would you mind simplifying your request to one thing you want me to do?"};!function(e){e.AddDocument="AddDocument",e.AddAboutText="AddAboutText",e.AddText="AddText",e.RewriteText="RewriteText",e.AddImage="AddImage",e.ChangeStyle="ChangeStyle",e.GiveMeAnOverview="GiveMeAnOverview",e.EnhanceOverview="EnhanceOverview",e.QnA="QnA",e.ContentCreation="ContentCreation",e.Default="Default",e.GeneratingSuggestions="GeneratingSuggestions",e.TransformDocument="TransformDocument"}(Xe||(Xe={}));var nt,rt=function(){return new RegExp("^("+(B()?[WordCopilot.GiveMeAnOverViewRegex_1,WordCopilot.GiveMeAnOverViewRegex_2,WordCopilot.GiveMeAnOverViewRegex_3,WordCopilot.GiveMeAnOverViewRegex_4,WordCopilot.GiveMeAnOverViewRegex_5,WordCopilot.GiveMeAnOverViewRegex_6,WordCopilot.GiveMeAnOverViewRegex_7,WordCopilot.GiveMeAnOverViewRegex_8,WordCopilot.GiveMeAnOverViewRegex_9,WordCopilot.GiveMeAnOverViewRegex_11,WordCopilot.GiveMeAnOverViewRegex_12,WordCopilot.GiveMeAnOverViewRegex_13,WordCopilot.GiveMeAnOverViewRegex_14,WordCopilot.GiveMeAnOverViewRegex_15,WordCopilot.GiveMeAnOverViewRegex_16,WordCopilot.GiveMeAnOverViewRegex_17,WordCopilot.GiveMeAnOverViewRegex_18,WordCopilot.GiveMeAnOverViewRegex_19,WordCopilot.GiveMeAnOverViewRegex_20,WordCopilot.GiveMeAnOverViewRegex_21,WordCopilot.GiveMeAnOverViewRegex_22,WordCopilot.GiveMeAnOverViewRegex_23]:["Summarize the document","Summarize this document","Summarize","Generate Summary","Summarize the doc for me","Summary of this doc","Give me summary","Provide summary of this page","Summarize this doc","Summarize(?: (?:this|the))? doc(?:ument)?","Please summarize this document","Please summarise this document","Summarize this doc for me","key points","What is this document about","What is the document about","What is this document about?","What is the document about?","What is this doc about","What is the doc about","What is this doc about?","What is the doc about?","summary"]).join("|")+")$","i")};!function(e){e.Formal="Formal",e.Casual="Casual",e.Longer="Longer",e.Shorter="Shorter",e.MoreDetails="MoreDetails",e.Expand="Expand"}(nt||(nt={}));var ot,at,it,st,ct,lt,ut=function(){var e,t;return B()?(e={},(0,a._)(e,"Formal",WordCopilot.MakeItFormalMessage),(0,a._)(e,"Casual",WordCopilot.MakeItMoreCasual),(0,a._)(e,"Longer",WordCopilot.MakeItLongerMessage),(0,a._)(e,"Shorter",WordCopilot.MakeItShorterMessage),(0,a._)(e,"MoreDetails",WordCopilot.MoreDetailsMessage),(0,a._)(e,"Expand",WordCopilot.ExpandMainPointMessage),e):(t={},(0,a._)(t,"Formal","Make the summary more formal"),(0,a._)(t,"Casual","Make the summary more casual"),(0,a._)(t,"Longer","Make the summary longer"),(0,a._)(t,"Shorter","Make the summary shorter"),(0,a._)(t,"MoreDetails","Include more details in the summary"),(0,a._)(t,"Expand","Expand on the main point in the summary"),t)},dt=new RegExp("^(create.*?(presentation).*?(file|document|doc).*?)|^(transform.*?(file|document|doc).*?(powerpoint|presentation|ppt|deck).*?)","i"),_t=function(){return[B()?WordCopilot.LearnMoreAssistantResponseListItem1:"Drafting text from your outline or idea",B()?WordCopilot.LearnMoreAssistantResponseListItem2:"Rewriting your text for alternative phrasing or to change the tone",B()?WordCopilot.LearnMoreAssistantResponseListItem3:"Summarizing or answering questions about content in the document"]},pt="build me a byoa agent",gt="Build me a Scrum Master Agent",ft="Launch Agent",ht=/(Content Creation)/i,Ct=function(){return B()?new Map([["AddDocument",[WordCopilot.LoaderStringsMapAddDocument_1]],["AddAboutText",[WordCopilot.LoaderStringsMapAddAboutText_1,WordCopilot.LoaderStringsMapAddAboutText_2]],["AddText",[WordCopilot.LoaderStringsMapAddText_1,WordCopilot.LoaderStringsMapAddText_2]],["RewriteText",[WordCopilot.LoaderStringsMapRewriteText_1,WordCopilot.LoaderStringsMapRewriteText_1]],["AddImage",[WordCopilot.LoaderStringsMapAddImage_1,WordCopilot.LoaderStringsMapAddImage_2,WordCopilot.LoaderStringsMapAddImage_3]],["ChangeStyle",[WordCopilot.LoaderStringsMapChangeStyle_1,WordCopilot.LoaderStringsMapChangeStyle_2]],["GiveMeAnOverview",[WordCopilot.LoaderStringsMapGiveMeAnOverview_2,WordCopilot.LoaderStringsMapGiveMeAnOverview_3,WordCopilot.LoaderStringsMapGiveMeAnOverview_4,WordCopilot.LoaderStringsMapGiveMeAnOverview_5,WordCopilot.LoaderStringsMapGiveMeAnOverview_6,WordCopilot.LoaderStringsMapGiveMeAnOverview_7,WordCopilot.LoaderStringsMapDefault_6]],["QnA",[WordCopilot.LoaderStringsMapQnA_1,WordCopilot.LoaderStringsMapQnA_2,WordCopilot.LoaderStringsMapQnA_3,WordCopilot.LoaderStringsMapQnA_4,WordCopilot.LoaderStringsMapQnA_5,WordCopilot.LoaderStringsMapQnA_6,WordCopilot.LoaderStringsMapQnA_7,WordCopilot.LoaderStringsMapQnA_8,WordCopilot.LoaderStringsMapQnA_9]],["ContentCreation",[WordCopilot.LoaderStringsMapContentCreation_1,WordCopilot.LoaderStringsMapContentCreation_2,WordCopilot.LoaderStringsMapContentCreation_3,WordCopilot.LoaderStringsMapContentCreation_4,WordCopilot.LoaderStringsMapContentCreation_5]],["GeneratingSuggestions",[WordCopilot.LoaderStringsMapGeneratingSuggestions]],["Default",[WordCopilot.LoaderStringsMapDefault_1,WordCopilot.LoaderStringsMapDefault_2,WordCopilot.LoaderStringsMapDefault_3,WordCopilot.LoaderStringsMapDefault_4,WordCopilot.LoaderStringsMapDefault_5,WordCopilot.LoaderStringsMapDefault_6,WordCopilot.LoaderStringsMapDefault_7]]]):new Map([["AddDocument",["Coming right up..."]],["AddAboutText",["Finding the right words","Putting it all together"]],["AddText",["Finding the right words","Putting it all together"]],["RewriteText",["Tweaking for perfection","Finalizing your writing"]],["AddImage",["Searching for the perfect image","Making sure it's picture perfect","Getting ready to add it to your document"]],["ChangeStyle",["Changing up the style","Polishing the text"]],["GiveMeAnOverview",["Working on it...","Scanning the document...","Pulling things together...","Still working on it...","Looking things over...","Generating the summary...","Almost there..."]],["QnA",["OK, I'll search for that...","Scanning the document...","Combing through the info...","Digging up the details...","Working on your request...","Pulling things together...","Generating a response...","Getting ready...","Still searching..."]],["ContentCreation",["OK, I'll start writing that...","Creating a draft...","Working on it...","Pulling things together...","Almost there..."]],["GeneratingSuggestions",["Generating suggestions"]],["Default",["Working on a response for you...","Looking things over...","Working on it...","Pulling things together...","Still working on it...","Almost there...","Finishing up..."]]])},mt=(ot={},(0,a._)(ot,0,"regular_icon.svg"),(0,a._)(ot,1,"check_box_icon.svg"),(0,a._)(ot,2,"check_box_icon.svg"),(0,a._)(ot,3,"check_box_icon.svg"),(0,a._)(ot,8,"add-text.svg"),(0,a._)(ot,9,"regular_icon.svg"),(0,a._)(ot,10,"add-an-image.svg"),(0,a._)(ot,11,"change-text-format.svg"),(0,a._)(ot,12,"overview_icon.svg"),(0,a._)(ot,13,"regular_icon.svg"),(0,a._)(ot,4,""),(0,a._)(ot,5,""),(0,a._)(ot,6,""),(0,a._)(ot,7,""),"PC"),vt="OFFICEONLINE",Et="MAC",yt="IOS";!function(e){e.AIThumbsDown="AIThumbsDown",e.AIThumbsUp="AIThumbsUp",e.Custom="Custom"}(at||(at={})),function(e){e.ModalDialog="ModalDialog",e.Taskpane="Taskpane"}(it||(it={})),function(e){e.Like="Like",e.Dislike="Dislike",e.Idea="Idea",e.Unclassified="Unclassified"}(st||(st={})),function(e){e.notSet="NotSet",e.true="True",e.false="False"}(ct||(ct={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(lt||(lt={}));var bt,Tt=function(){return B()&&WordCopilot.InternetNotAvailableErrorMessage?WordCopilot.InternetNotAvailableErrorMessage:"Please check your connection. It looks like you don't have access to internet."},It=function(){return i.i.GetHostAppPlatform()===mt?OfficeaicopilotStrings.MicrophonPermissionErrorTitleWin32:OfficeaicopilotStrings.MicrophonPermissionErrorTitle},Pt=function(){return i.i.GetHostAppPlatform()===mt?OfficeaicopilotStrings.MicrophonPermissionErrorTextWin32:OfficeaicopilotStrings.MicrophonPermissionErrorText},At=function(){return i.i.GetHostAppPlatform()===vt},Dt=function(){return"Continue To PowerPoint"},St=function(){return B()?WordCopilot.HandoffPowerpointSuccessMessage:"Okay, I can do that. Continue to PowerPoint and I'll start creating your presentation."},Mt=function(){return B()?WordCopilot.HandoffPowerPointOpenedMessage:"Opened new presentation in PowerPoint"},Ot="Handoff response content is not found.",kt="No generated links received for handoff.",Lt="EnterpriseSearch",wt="BingWebSearch",Rt="acquired",Ut={ProactiveZQMForDocWithContentTitle1:function(){return WordCopilot.ProactiveZQMForDocWithContentTitle_1},ProactiveZQMForDocWithContentTitle2:function(){return WordCopilot.ProactiveZQMForDocWithContentTitle_2},ProactiveZQMForDocWithContentTitle3:function(){return WordCopilot.ProactiveZQMForDocWithContentTitle_3},ProactiveZQMForDocWithContentTitle4:function(){return WordCopilot.ProactiveZQMForDocWithContentTitle_4},ProactiveZQMForDocWithContentTitle5:function(){return WordCopilot.ProactiveZQMForDocWithContentTitle_5},ProactiveZQMForDocWithContentTitle6:function(){return WordCopilot.ProactiveZQMForDocWithContentTitle_6},ProactiveZQMForDocWithContentTitle7:function(){return WordCopilot.ProactiveZQMForDocWithContentTitle_7},ProactiveGeneralZQMForDocWithContentTitle1:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitle_1},ProactiveGeneralZQMForDocWithContentTitle2:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitle_2},ProactiveGeneralZQMForDocWithContentTitle8:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitle_8},ProactiveGeneralZQMForDocWithContentTitle9:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitle_9},ProactiveGeneralZQMForDocWithContentTitle10:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitle_10}},Bt={ProactiveZQMForDocWithContentTitleText1:function(){return WordCopilot.ProactiveZQMForDocWithContentTitleText_1},ProactiveZQMForDocWithContentTitleText2:function(){return WordCopilot.ProactiveZQMForDocWithContentTitleText_2},ProactiveZQMForDocWithContentTitleText3:function(){return WordCopilot.ProactiveZQMForDocWithContentTitleText_3},ProactiveZQMForDocWithContentTitleText4:function(){return WordCopilot.ProactiveZQMForDocWithContentTitleText_4},ProactiveZQMForDocWithContentTitleText5:function(){return WordCopilot.ProactiveZQMForDocWithContentTitleText_5},ProactiveZQMForDocWithContentTitleText6:function(){return WordCopilot.ProactiveZQMForDocWithContentTitleText_6},ProactiveZQMForDocWithContentTitleText7:function(){return WordCopilot.ProactiveZQMForDocWithContentTitleText_7},ProactiveGeneralZQMForDocWithContentTitleText1:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitleText_1},ProactiveGeneralZQMForDocWithContentTitleText2:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitleText_2},ProactiveGeneralZQMForDocWithContentTitleText8:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitleText_8},ProactiveGeneralZQMForDocWithContentTitleText9:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitleText_9},ProactiveGeneralZQMForDocWithContentTitleText10:function(){return WordCopilot.ProactiveGeneralZQMForDocWithContentTitleText_10}},xt={AnalyzeSuggestText:function(){return WordCopilot.AnalyzeSuggestText},TranslateText:function(){return WordCopilot.TranslateText},DescribeTopic:function(){return WordCopilot.DescribeTopic},WhatDocSaysAboutTopic:function(){return WordCopilot.WhatDocSaysAboutTopic},ProsAndConsOfTopic:function(){return WordCopilot.ProsAndConsOfTopic},SummarizeIntoHighLevelOverview:function(){return WordCopilot.SummarizeIntoHighLevelOverview},TellReferencesAboutTopic:function(){return WordCopilot.TellReferencesAboutTopic},CreateBannerDesignOfDescription:function(){return WordCopilot.CreateBannerDesignOfDescription}},Wt={AnalyzeSuggestText:"Modified_AnalyzeSuggestText",TranslateText:"Modified_TranslateText",DescribeTopic:"Modified_DescribeTopic",WhatDocSaysAboutTopic:"Modified_WhatDocSaysAboutTopic",ProsAndConsOfTopic:"Modified_ProsAndConsOfTopic",SummarizeIntoHighLevelOverview:"Modified_SummarizeIntoHighLevelOverview",TellReferencesAboutTopic:"Modified_TellReferencesAboutTopic",CreateBannerDesignOfDescription:"Modified_CreateBannerDesignOfDescription"},Ft={ProactiveZQMForDocWithContentTitleText1:"ProactiveZQMForDocWithContentTitleText_1",ProactiveZQMForDocWithContentTitleText2:"ProactiveZQMForDocWithContentTitleText_2",ProactiveZQMForDocWithContentTitleText3:"ProactiveZQMForDocWithContentTitleText_3",ProactiveZQMForDocWithContentTitleText4:"ProactiveZQMForDocWithContentTitleText_4",ProactiveZQMForDocWithContentTitleText5:"ProactiveZQMForDocWithContentTitleText_5",ProactiveZQMForDocWithContentTitleText6:"ProactiveZQMForDocWithContentTitleText_6",ProactiveZQMForDocWithContentTitleText7:"ProactiveZQMForDocWithContentTitleText_7",ProactiveGeneralZQMForDocWithContentTitleText1:"ProactiveGeneralZQMForDocWithContentTitleText_1",ProactiveGeneralZQMForDocWithContentTitleText2:"ProactiveGeneralZQMForDocWithContentTitleText_2",ProactiveGeneralZQMForDocWithContentTitleText8:"ProactiveGeneralZQMForDocWithContentTitleText_8",ProactiveGeneralZQMForDocWithContentTitleText9:"ProactiveGeneralZQMForDocWithContentTitleText_9",ProactiveGeneralZQMForDocWithContentTitleText10:"ProactiveGeneralZQMForDocWithContentTitleText_10"},Nt={menuTitle:function(){return WordCopilot.PromptGuideMenuTitlePrompts},menuSectionCreate:function(){return WordCopilot.PromptGuideMenuSectionCreate},menuSectionUnderstand:function(){return WordCopilot.PromptGuideMenuSectionUnderstand},menuSectionEdit:function(){return WordCopilot.PromptGuideMenuSectionEdit},menuSectionAsk:function(){return WordCopilot.PromptGuideMenuSectionAsk},menuSectionDesign:function(){return WordCopilot.PromptGuideMenuSectionDesign},viewMorePrompts:function(){return OfficeaicopilotStrings.CopilotLabMenuSubItem},menuSectionCustomize:function(){return OfficeaicopilotStrings.PromptGuideMenuSectionCustomize},menuSectionCreateImage:function(){return WordCopilot.PromptGuideMenuSectionCreateAnImage},menuSectionSpeak:function(){return OfficeaicopilotStrings.PromptGuideMenuSectionSpeak},menuSectionAudioOverview:function(){return WordCopilot.CreatePodcastZQMTitle}},Kt={title1:function(){return WordCopilot.ProactiveZQMTitle_1},title2:function(){return WordCopilot.ProactiveZQMTitle_2},title3:function(){return WordCopilot.ProactiveZQMTitle_3},title4:function(){return WordCopilot.ProactiveZQMTitle_4},title5:function(){return WordCopilot.ProactiveZQMTitle_5},title6:function(){return WordCopilot.ProactiveZQMTitle_6},title7:function(){return WordCopilot.ProactiveZQMTitle_7},title8:function(){return WordCopilot.ProactiveZQMTitle_8},title9:function(){return WordCopilot.ProactiveZQMTitle_9},title10:function(){return WordCopilot.ProactiveZQMTitle_10},title11:function(){return WordCopilot.ProactiveZQMTitle_11},title12:function(){return WordCopilot.ProactiveZQMTitle_12},title13:function(){return WordCopilot.ProactiveZQMTitle_13},title14:function(){return WordCopilot.ProactiveZQMTitle_14}},Ht={textItem1:function(){return WordCopilot.ProactiveZQMTitleText_1},textItem2:function(){return WordCopilot.ProactiveZQMTitleText_2},textItem3:function(){return WordCopilot.ProactiveZQMTitleText_3},textItem4:function(){return WordCopilot.ProactiveZQMTitleText_4},textItem5:function(){return WordCopilot.ProactiveZQMTitleText_5},textItem6:function(){return WordCopilot.ProactiveZQMTitleText_6},textItem7:function(){return WordCopilot.ProactiveZQMTitleText_7},textItem8:function(){return WordCopilot.ProactiveZQMTitleText_8},textItem9:function(){return WordCopilot.ProactiveZQMTitleText_9},textItem10:function(){return WordCopilot.ProactiveZQMTitleText_10},textItem11:function(){return WordCopilot.ProactiveZQMTitleText_11},textItem12:function(){return WordCopilot.ProactiveZQMTitleText_12},textItem13:function(){return WordCopilot.ProactiveZQMTitleText_13},textItem14:function(){return WordCopilot.ProactiveZQMTitleText_14}},Gt={textItem1:"ProactiveZQMTitleText_1",textItem2:"ProactiveZQMTitleText_2",textItem3:"ProactiveZQMTitleText_3",textItem4:"ProactiveZQMTitleText_4",textItem5:"ProactiveZQMTitleText_5",textItem6:"ProactiveZQMTitleText_6",textItem7:"ProactiveZQMTitleText_7",textItem8:"ProactiveZQMTitleText_8",textItem9:"ProactiveZQMTitleText_9",textItem10:"ProactiveZQMTitleText_10",textItem11:"ProactiveZQMTitleText_11",textItem12:"ProactiveZQMTitleText_12",textItem13:"ProactiveZQMTitleText_13",textItem14:"ProactiveZQMTitleText_14"},Qt={createProject:function(){return WordCopilot.PromptGuideMenuItemCreateProjectProposal},addAParagraph:function(){return WordCopilot.PromptGuideMenuItemAddAParagraph},createDraftAbout:function(){return WordCopilot.PromptGuideMenuItemCreateDraftAbout},writeIntroParagraph:function(){return WordCopilot.PromptGuideMenuItemWriteIntroParagraph},addATable:function(){return WordCopilot.PromptGuideMenuItemAddATable},createHighLevelOverview:function(){return WordCopilot.PromptGuideMenuItemCreateHighLevelOverview},tellMeMore:function(){return WordCopilot.PromptGuideMenuItemTellMeMore},summarize:function(){return WordCopilot.PromptGuideMenuItemSummarize},listProsAndCons:function(){return WordCopilot.PromptGuideMenuItemListProsAndCons},impDeadlines:function(){return WordCopilot.PromptGuideMenuItemImpDeadlines},showStakeHolders:function(){return WordCopilot.PromptGuideMenuItemShowStakeHolders},changeFont:function(){return WordCopilot.PromptGuideMenuItemChangeFont},highlightText:function(){return WordCopilot.PromptGuideMenuItemHighlightText},highlightAny:function(){return WordCopilot.PromptGuideMenuItemHighlightAny},addComment:function(){return WordCopilot.PromptGuideMenuItemAddComment},selectedTextAsTable:function(){return WordCopilot.PromptGuideMenuItemSelectedTextAsTable},selectedTextAsList:function(){return WordCopilot.PromptGuideMenuItemSelectedTextAsList},help:function(){return WordCopilot.PromptGuideMenuItemHelp},howToAddTable:function(){return WordCopilot.PromptGuideMenuItemHowToAddTable},howToImproveDocument:function(){return WordCopilot.PromptGuideMenuItemImproveDocument},generateBanner:function(){return WordCopilot.PromptGuideMenuItemGenerateBanner},generateImage:function(){return WordCopilot.PromptGuideMenuItemGenerateImage},redactInformation:function(){return WordCopilot.ZQMV2RedactFromFilePrompt},descTimeMgmt:function(){return WordCopilot.ZQMV2AskItemDescTimeMgmt},whatCanCopilotProfileDo:function(){return OfficeaicopilotStrings.PromptGuideMenuItemWhatCanCopilotProfileDo},createMyCopilotProfile:function(){return OfficeaicopilotStrings.PromptGuideMenuItemCreateMyCopilotProfile},speakWithCopilot:function(){return OfficeaicopilotStrings.PromptGuideMenuItemSpeakWithCopilot},extractTextFromImage:function(){return WordCopilot.ProactiveZQMTextExtractTextFromImage},generateAudioOverview:function(){return WordCopilot.CreatePodcastZQMTitleText}},jt={createProject:"PromptGuideMenuItemCreateProjectProposal",addAParagraph:"PromptGuideMenuItemAddAParagraph",createDraftAbout:"PromptGuideMenuItemCreateDraftAbout",writeIntroParagraph:"PromptGuideMenuItemWriteIntroParagraph",addATable:"PromptGuideMenuItemAddATable",createHighLevelOverview:"PromptGuideMenuItemCreateHighLevelOverview",tellMeMore:"PromptGuideMenuItemTellMeMore",summarize:"PromptGuideMenuItemSummarize",listProsAndCons:"PromptGuideMenuItemListProsAndCons",impDeadlines:"PromptGuideMenuItemImpDeadlines",showStakeHolders:"PromptGuideMenuItemShowStakeHolders",changeFont:"PromptGuideMenuItemChangeFont",highlightText:"PromptGuideMenuItemHighlightText",highlightAny:"PromptGuideMenuItemHighlightAny",addComment:"PromptGuideMenuItemAddComment",selectedTextAsTable:"PromptGuideMenuItemSelectedTextAsTable",selectedTextAsList:"PromptGuideMenuItemSelectedTextAsList",help:"PromptGuideMenuItemHelp",howToAddTable:"PromptGuideMenuItemHowToAddTable",howToImproveDocument:"PromptGuideMenuItemImproveDocument",generateBanner:"PromptGuideMenuItemGenerateBanner",generateImage:"PromptGuideMenuItemGenerateImage",redactInformation:"ZQMV2RedactFromFilePrompt",descTimeMgmt:"ZQMV2AskItemDescTimeMgmt",whatCanCopilotProfileDo:"PromptGuideMenuItemWhatCanCopilotProfileDo",createMyCopilotProfile:"PromptGuideMenuItemCreateMyCopilotProfile",speakWithCopilot:"PromptGuideMenuItemSpeakWithCopilot",extractTextFromImage:"ProactiveZQMTextExtractTextFromImage",generateAudioOverview:"PromptGuideMenuItemGeneratePodcastFromDoc"},Yt={title1:function(){return WordCopilot.BackstageZQMTitle_1},title2:function(){return WordCopilot.BackstageZQMTitle_2},title3:function(){return WordCopilot.BackstageZQMTitle_3},title4:function(){return WordCopilot.BackstageZQMTitle_4}},zt={textItem1:function(){return WordCopilot.BackstageZQMTitleText_1},textItem1V2:function(){return WordCopilot.BackstageZQMV2TitleText_1},textItem2:function(){return WordCopilot.BackstageZQMTitleText_2},textItem2V2:function(){return WordCopilot.BackstageZQMV2TitleText_2},textItem3:function(){return WordCopilot.BackstageZQMTitleText_3},textItem3V2:function(){return WordCopilot.BackstageZQMV2TitleText_3},textItem4:function(){return WordCopilot.BackstageZQMTitleText_4},textItem4V2:function(){return WordCopilot.BackstageZQMV2TitleText_4}},qt={textItem1:"BackstageZQMTitleText_1",textItem2:"BackstageZQMTitleText_2",textItem3:"BackstageZQMTitleText_3",textItem4:"BackstageZQMTitleText_4"},Vt="https://copilot.cloud.microsoft/prompts?ocid=",Zt="https://copilot.apps.mil/prompts?ocid=",Jt={OFFICEONLINE:"copilotlab_wordchatweb",PC:"copilotlab_wordchatwin32",MAC:"copilotlab_wordchatmac",IOS:"copilotlab_wordchatios"},Xt={OFFICEONLINE:"Word.Web.Copilot_Lib",PC:"Word.Win32.Copilot_Lib",MAC:"Word.Mac.Copilot_Lib",IOS:"Word.iPad.Copilot_Lib"},$t={OFFICEONLINE:"Word.Web.Copilot_FRE",PC:"Word.Win32.Copilot_FRE",MAC:"Word.Mac.Copilot_FRE",IOS:"Word.iPad.Copilot_FRE"},en="https://go.microsoft.com/fwlink/?linkid=2250136";!function(e){e.QuickAnswer="QuickAnswer",e.HelpArticle="HelpArticle"}(bt||(bt={}));var tn,nn="/Sydney",rn=function(){return B()?OfficeaicopilotStrings.CseSelfHelpSkillContentRetrievedQuickAnswer:"Here's what I found:"},on=function(){return B()?OfficeaicopilotStrings.CseSelfHelpSkillContentRetrievedSingleArticle:"Here's what I found:"},an=function(){return B()?OfficeaicopilotStrings.CseSelfHelpSkillErrorOrNoContentRetrieved:"Sorry, I'm having trouble finding information about that. Please rephrase your request and try again."},sn=function(){return B()?WordCopilot.CseSelfHelpSkillSourceLabel:"Word Help"},cn=function(){return B()?OfficeaicopilotStrings.ChatInputCharacterLimitExceededMessage:"Character limit exceeded"};!function(e){e.Chat="Chat",e.Backstage="Backstage"}(tn||(tn={}));var ln,un,dn="ChatWrapperId",_n="messagesStartID",pn="copilotChat",gn="Copilot",fn="reviewerAgent",hn="Workspace",Cn="Workspace",mn="GetMosCopilotExtensions",vn="div[data-testid='APIPluginCard']";!function(e){e.Licensed="Licensed",e.MultiAccessDisabledByAdmin="MultiAccessDisabledByAdmin"}(ln||(ln={})),function(e){e.Ask="Ask",e.Understand="Understand",e.Edit="Edit",e.Customize="Customize"}(un||(un={}));var En=function(){return"An unexpected error occurred. Please try again later."},yn=function(){return B()?WordCopilot.DesignerCardPrefixForSharedOutput:"Sure, here are some images, choose one to insert into the document"},bn=function(){return B()?WordCopilot.DesignerCardPrefixForSharedOutputWithSingleImage:"Sure, here is an image that might work. Select it to insert into the document"},Tn="Search the web with M365 Copilot",In="Search my organization with M365 Copilot",Pn="Search with M365 Copilot",An=16e3,Dn="WordSidepaneWorkCopilot",Sn="word",Mn={colorBrandForeground1:"#82ABF1",colorBrandForegroundLink:"#82ABF1",colorBrandForegroundLinkPressed:"#598FEC",colorBrandForegroundLinkSelected:"#82ABF1",colorBrandForegroundLinkHover:"#AEC6F0",colorNeutralForeground2BrandHover:"#82ABF1",colorNeutralForeground2BrandPressed:"#598FEC",colorBrandForeground2:"#AEC6F0",colorBrandForeground2Hover:"#FFFFFF"}},660606:(e,t,n)=>{"use strict";n.d(t,{EG:()=>r,JB:()=>s,YP:()=>l,cY:()=>c,gS:()=>d,s7:()=>u,t6:()=>o});var r,o,a=n(354311),i=n(618859),s=void 0,c=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},l=function(e,t,n,a){s=e,c=t,r=n,o=a};function u(e){if(!e)return a.D.PRODUCTION;var t=e.toLowerCase();return t.indexOf("augloop.office.com")>=0||t.indexOf("augloop-int.officeppe.com")>=0?a.D.PRODUCTION:t.indexOf("augloop-gcc.office.com")>=0||t.indexOf("gcc.augloop.svc.cloud.microsoft")>=0?a.D.GCC:t.indexOf("augloop.gov.online.office365.us")>=0?a.D.GCCHIGH:t.indexOf("augloop.dod.online.office365.us")>=0?a.D.DOD:t.includes("dogfood")?a.D.DOGFOOD:a.D.PRODUCTION}function d(e){if(!e)return i.RD.Unknown;var t=e.toLowerCase();return t.indexOf("augloop-msit.office.com")>=0||t.indexOf("msit.augloop.svc.cloud.microsoft")>=0?i.RD.MSIT:t.indexOf("augloop-gcc.office.com")>=0||t.indexOf("gcc.augloop.svc.cloud.microsoft")>=0?i.RD.GCCModerate:t.indexOf("augloop.gov.online.office365.us")>=0?i.RD.GCCHigh:t.indexOf("augloop.dod.online.office365.us")>=0?i.RD.DoD:t.includes("dogfood")?i.RD.Dogfood:i.RD.Production}},661218:(e,t,n)=>{"use strict";n.d(t,{E:()=>d});var r=n(811912),o=n(791165),a=n(990813),i=n(140889),s=n(242154),c=null,l=null,u=null,d=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"initTelemetryLatencyObject",value:function(){l=(0,s.xI)()}},{key:"initTelemetryChatEventObject",value:function(){c=(0,s.uA)()}},{key:"initTelemetryCommandingObject",value:function(){u=(0,s.wV)()}},{key:"updateTelemetryLatencyData",value:function(e,t){null!=l&&(Object.keys(e).forEach((function(t){l[t]=e[t]})),t&&0!==l[i.CT.RequestSignalType]&&this.sendTelemetryLatencyData(t))}},{key:"updateTelemetryChatEventData",value:function(e,t,n){null===c&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((function(t){c[t]=e[t]})),t&&this.sendTelemetryChatEventData(t,n)}},{key:"updateTelemetryCommandingData",value:function(e,t){null===u&&this.initTelemetryCommandingObject(),Object.keys(e).forEach((function(t){u[t]=e[t]})),t&&this.sendTelemetryCommandingData(t)}},{key:"sendTelemetryLatencyData",value:function(e){null!=e&&(e.logEvent((0,s.kX)(l)),this.initTelemetryLatencyObject())}},{key:"sendTelemetryChatEventData",value:function(e,t){null!=e&&(e.logEventWithAshaPillar((0,s._W)(c),void 0,t),this.initTelemetryChatEventObject())}},{key:"sendTelemetryCommandingData",value:function(e){null!=e&&(e.logEvent((0,s.Xo)(u)),this.initTelemetryCommandingObject())}}],[{key:"getInstance",value:function(){return e.telemetryEventHandler||(e.telemetryEventHandler=new e),e.telemetryEventHandler}}]),e}();(0,a._)(d,"telemetryEventHandler",void 0)},663279:(e,t,n)=>{"use strict";n.d(t,{LN:()=>P,N6:()=>C,as:()=>E,mh:()=>m});var r,o,a=n(743032),i=n(379490),s=n(656904),c=n(722603),l=n(192318),u=n(956775),d=n(242154),_=(n(862853),n(598309)),p=n(249002),g=n(740389),f=n(602061),h=n(111246);function C(e,t,n,r){y();var o=(0,g.zP3)()&&(0,_.z4)()?n+s.tSR:n;OfficeFirstParty.UserFeedback.CollectUserFeedback(e,t,o,r)}function m(e,t){var n={},r={},o={isScenarioEnabled:!1,question:{questionUIType:"DropDown",questionInstruction:{displayedString:" ",displayedStringInEnglish:" "},questionOptions:[{displayedString:" ",displayedStringInEnglish:" "}]},scenarioType:s.uoO.Custom};if(t&&(o.isScenarioEnabled=!0,o.scenarioType=t),e){var a={fileType:"text/plain; charset=utf-8",fileName:"contextData.txt",base64Data:btoa(unescape(encodeURIComponent(JSON.stringify(e))))};r.contextDataFiles=[a]}return r.scenarioConfig=o,(0,g.zP3)()&&(0,_.z4)()&&(r.isEmailCollectionEnabled=s.Mgi.false,r.isFileUploadEnabled=s.Mgi.false,r.isScreenshotEnabled=s.Mgi.false,r.isScreenRecordingEnabled=s.Mgi.false,r.isHostManagedContextDataEnabled=s.Mgi.true,r.hostManagedContextDataExplanationUrl=s.Lvp,r.isRetrieveFormDataEnabled=s.Mgi.true),n.v2Config=r,n}!function(e){e.Header="Header",e.Footer="Footer",e.Backstage="Backstage",e.HelpMenu="Help Menu",e.Canvas="Canvas",e.Chat="Chat"}(o||(o={}));var v,E=function(e,t){(new Date).toISOString();var n=null!=e?e:s.Wat,r={feedbackArea:n=(0,g.mOp)()?s.UWp:n,contextData:{cardMetaData:JSON.stringify({prompt:l.i8,promptId:l.PF,enabledPlugins:null===l.Uy||void 0===l.Uy?void 0:l.Uy.map((function(e){return e.id})),errorMessage:null==t?void 0:t.errorMessage,errorType:null==t?void 0:t.errorType}),feedbackContextData:{prompt:l.i8,promptId:l.PF,errorMessage:null==t?void 0:t.errorMessage,errorType:null==t?void 0:t.errorType},featureName:null==t?void 0:t.featureName,subFeatureName:null==t?void 0:t.subFeatureName,entryPoint:"Chat",feedbackClientAppName:A()}};return _.kf&&(r.contextData.contextScreenshots=(0,f.LQO)(l.zn)),r},y=function(){r=document.activeElement},b=function(e){if((0,g.zP3)()&&(0,_.z4)()&&e.length){var t="WordWeb";switch(c.i.GetHostAppPlatform()){case s.nAd:t="WordWin32";break;case s.xb6:t="WordMac";break;case s.K4y:t="WordiOS"}(0,d.cY)("initiating feedback signal for "+t),(0,g.UTV)()?(0,u.createAndSubmitFeedbackDataUploadSignal)(e,t,void 0,T).finally((function(){(0,d.cY)("Feedback diagnostic data upload signal called")})):(0,u.createAndSubmitFeedbackDataUploadSignal)(e,t).finally((function(){(0,d.cY)("Feedback diagnostic data upload signal called")}))}},T=function(e,t){h.$.getInstance().submitOperation({operation:e,workflowAnnotationType:t})},I=(v=(0,a._)((function(e){return(0,i.__generator)(this,(function(t){switch(t.label){case 0:return(0,d.cY)("Feedback was ".concat(e?"sent":"not sent",".")),(0,d.cY)("Adding delay of 2 sec before setting focus"),[4,(0,p.uk)(2e3)];case 1:return t.sent(),r&&r.focus(),[2]}}))})),function(e){return v.apply(this,arguments)}),P=function(){var e=(0,a._)((function(){return(0,i.__generator)(this,(function(e){switch(e.label){case 0:return(0,d.cY)("Register OfficeFirstParty On Submit feedback response event"),[4,OfficeFirstParty.UserFeedback.onUserFeedbackResponse(b)];case 1:return e.sent(),(0,d.cY)("Register OfficeFirstParty feedback dismissed event"),[4,OfficeFirstParty.UserFeedback.onUserFeedbackUIDismissed(I)];case 2:return e.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),A=function(){var e="WordWeb";switch(c.i.GetHostAppPlatform()){case s.nAd:e="WordWin32";break;case s.xb6:e="WordMac";break;case s.K4y:e="WordiOS"}return"".concat(e,"CopilotOCV")}},665320:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{e:()=>getOfficeComJSClientProps});var _swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(743032),_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(379490),_frontend_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(242154),_FeatureGates__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(740389);function getOfficeComJSClientProps(){if((0,_FeatureGates__WEBPACK_IMPORTED_MODULE_1__.Kr3)()){var officeComJSTools=[{name:"OfficeComJSExecutor",description:"Execute a custom Microsoft Word automation task with post-bound ComBridge API",inputSchema:{type:"object",properties:{officecomjs:{type:"string",description:"Execute JavaScript code that automates Microsoft Word using ComBridge API. Return result as a string, which will then be passed back as the tool’s final output.\n\n            **Available ComBridge API Methods:**\n            - comBridge.CreateObject(AppName) - Create/Connect to Office application (use 'Word.Application'), returns objectId\n            - comBridge.InvokeMethod(objectId, MethodName, ...args) - Invoke method on object, returns result/objectId\n            - comBridge.GetProperty(objectId, PropertyName) - Get object property, returns value/objectId\n            - comBridge.SetProperty(objectId, PropertyName, value) - Set object property\n            - comBridge.ReleaseObject(objectId) - Releases COM object\n\n            **CRITICAL ComBridge Implementation Details:**\n            - ObjectId strings start with \"obj_\" (e.g., \"obj_1\", \"obj_2\")\n            - Methods return either simple values (strings, numbers) OR new objectId strings\n            - Use objectId strings in subsequent API calls\n            - ComBridge automatically converts objectId strings to COM objects internally\n\n            **JavaScript Code Structure Requirements:**\n            - Function must be named `ClaudeFunc` with no parameters\n            - Wrap in async function with try-catch block\n            - add 'const comBridge = window.chrome.webview.hostObjects.sync.comBridge;' to be the first line of try block\n            - Return error.message on failure to get error details from comBridge.\n            - Ensure the document is read before modifying if its content is unknown.\n            - Never call quit() unless explicitly requested\n            - don't use console.log() for output, return result as string\n            - Generate code following two-step process: Python first, then JavaScript conversion\n            - add \"ClaudeFunc();\" in a new line after the body of function ClaudeFunc\n            - Include the original Python code as comments at the end\n\n            **JavaScript Conversion Rules:**\n            - Store each COM object reference in a separate variable\n            - Use await for all comBridge calls\n            - Handle each property/method access as individual API calls\n            - Example:\n            Instead of\n              ```javascript\n              const rangeId = await comBridge.GetProperty(wordId, 'ActiveDocument.Range');\n              ```\n              use:\n              ```javascript\n              const docId = await comBridge.GetProperty(wordId, 'ActiveDocument');\n              const rangeId = await comBridge.GetProperty(docId, 'Range');\n              ```\n            Instead of\n              ```javascript\n              await comBridge.InvokeMethod(wordId, 'Selection', 'Range', 'ListFormat', 'ApplyBulletDefault');\n              ```\n              use:\n              ```javascript\n              const selectionId = await comBridge.GetProperty(wordId, 'Selection');\n              const rangeId2 = await comBridge.GetProperty(selectionId, 'Range');\n              const listFormat = await comBridge.GetProperty(rangeId2, 'ListFormat');\n              await comBridge.InvokeMethod(listFormat, 'ApplyBulletDefault');\n              ```\n\n            **Two-Step Process:**\n            1. Write working Python code using win32com.client\n            2. Convert to JavaScript using ComBridge API\n            3. Include Python code as comments at the end\n            "}},required:["officecomjs"],additionalProperties:!1,$schema:"https://json-schema.org/draft-07/schema#"}}],getOfficeComJSTools=function(){return{tools:officeComJSTools}},executeOfficeComJSCode=function(){var _ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__._)((function(js){var transpileTypeScript,jsCode,result,e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(_state){switch(_state.label){case 0:return transpileTypeScript=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__._)((function(e){var t;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(n){switch(n.label){case 0:return[4,Promise.resolve().then(__webpack_require__.t.bind(__webpack_require__,508479,23))];case 1:return t=n.sent(),[2,t.transpile(e)]}}))}));return function(t){return e.apply(this,arguments)}}(),[4,transpileTypeScript(js)];case 1:jsCode=_state.sent(),(0,_frontend_utils__WEBPACK_IMPORTED_MODULE_0__.cY)(jsCode),_state.label=2;case 2:return _state.trys.push([2,4,,5]),[4,(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__._)((function(){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(_state){return[2,eval(jsCode)]}))}))()];case 3:return result=_state.sent(),(0,_frontend_utils__WEBPACK_IMPORTED_MODULE_0__.cY)(result),[3,5];case 4:return e=_state.sent(),(0,_frontend_utils__WEBPACK_IMPORTED_MODULE_0__.cY)("Syntax Error jsCode: ".concat(jsCode,"  \n Error: ").concat(e.message)),result="Syntax Error jsCode: ".concat(jsCode,"  \n Error: ").concat(e.message),[3,5];case 5:return[2,result]}}))}));return function(e){return _ref.apply(this,arguments)}}(),callOfficeComJSTool=(_ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__._)((function(e,t){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(n){switch(n.label){case 0:if(!officeComJSTools.some((function(t){return t.name===e})))throw new Error("Unknown tool name: ".concat(e));return[4,executeOfficeComJSCode(t.officecomjs)];case 1:return[2,n.sent()]}}))})),function(e,t){return _ref.apply(this,arguments)}),_ref;return{getLocalTools:getOfficeComJSTools,callLocalTool:callOfficeComJSTool}}}},666856:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(208520),o=n(758651);const a=function(e){var t=e.sdxVersion;return r.createElement("button",{id:"reloadSdx",onClick:function(){o.log("Reloading SDX to version: ",t);var e,n,r=(e=t,(n=window.location.href.split("/"))[4]=e,n.join("/"));o.log("Reloading SDX to url: ",r),window.location.href=r},style:{position:"absolute",zIndex:"1"}},"Reload")}},671100:()=>{},673744:(e,t,n)=>{"use strict";n.d(t,{U:()=>r});var r=new(n(476653).A)({iteration:0})},676220:(e,t,n)=>{"use strict";n.d(t,{c:()=>u});var r=n(784567),o=n(265167),a=n(215365),i=n(387452),s=n(423905),c=n(83437),l=n(189037),u=function(e,t,n,r,o){var a,i,l,u,_,g;d(n,r,null===(l=null==o?void 0:o.current)||void 0===l?void 0:l.updateChatSessionId,null===(u=null==o?void 0:o.current)||void 0===u?void 0:u.submitOperation)&&(n("Updating chat session ID with conversationId from source"),null==r||r.sendChatEventTelemetry((0,s.pN)(((a={})[c.h3.ChatEventType]=c.a5.UpdateChatSessionId,a))),null===(_=null==o?void 0:o.current)||void 0===_||_.updateChatSessionId(e),n("Conversation ID handoff successful - submitting chat history signal"),null==r||r.sendChatEventTelemetry((0,s.pN)(((i={})[c.h3.ChatEventType]=c.a5.ChatHistorySignalSubmitted,i))),null===(g=null==o?void 0:o.current)||void 0===g||g.submitOperation(p(e,t)))},d=function(e,t,n,r){var o,a;return n?!!r||(e("Conversation ID handoff unsucessful - no submitOperation function defined"),null==t||t.sendChatEventTelemetry((0,s.pN)(((a={})[c.h3.ChatEventType]=c.a5.SubmitOperationUndefined,a))),!1):(e("Unable to update chat session ID, updateChatSessionId is undefined"),null==t||t.sendChatEventTelemetry((0,s.pN)(((o={})[c.h3.ChatEventType]=c.a5.CannotUpdateChatSessionId,o))),!1)},_=function(e,t){var n,r,o={pageSize:g,syncState:void 0},s={type:a.S5.GetMessagesOperation,chatSessionId:e,paging:o,setSessionAsCurrent:!0,gptId:(0,l.Z)()};return new i.T({operation:s,documentURLOrLocalPath:null===(n=t.properties)||void 0===n?void 0:n.destinationDocUrl,timestamp:Date.now(),documentSensitivity:null===(r=t.properties)||void 0===r?void 0:r.sensitivityLabel,orchestratorGroundingMode:void 0,isFluxChatHistoryAnnotationActivated:!1,caller:f})},p=function(e,t){return{operation:new r.g0({parentPath:["Signal",i.T.getTypeName()],items:[{id:o.r.generateId(),body:_(e,t)}]}),workflowAnnotationType:i.T.getTypeName()}},g=10,f="handoff"},687295:(e,t,n)=>{"use strict";n.d(t,{s:()=>c});var r=n(475119),o=n(217425),a=n(632197),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:o.w8.substrate)];case 1:return n=s.sent(),[2,(0,a.t)(n)];case 2:throw i=s.sent(),(0,r.cY)("Error fetching Substrate token:",i),i;case 3:return[2]}}))}))}},702864:(e,t,n)=>{"use strict";var r;n.d(t,{aB:()=>r,xP:()=>o}),function(e){e[e.Idle=0]="Idle",e[e.ScopeStarted=1]="ScopeStarted",e[e.HasAction=2]="HasAction",e[e.ShowButton=3]="ShowButton"}(r||(r={}));var o=function(){function e(){this.addinUndoState=r.Idle,this.isAddinFlowActive=!1}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getCurrentAddinState=function(){return this.addinUndoState},e.prototype.isAddinFlow=function(){return this.isAddinFlowActive},e.prototype.setIsAddinFlow=function(e,t){this.isAddinFlowActive=e,null==t||t()},e.prototype.transitionAddinState=function(e,t){this.addinUndoState!==e&&(this.addinUndoState=e,null==t||t())},e.prototype.checkAndSetIsUndoableActionPresent=function(){this.getCurrentAddinState()===r.ScopeStarted&&this.transitionAddinState(r.HasAction)},e}().getInstance()},705458:(e,t,n)=>{"use strict";n.d(t,{g:()=>_});var r=n(806523),o=n(103218),a=n(475119),i=n(423905),s=n(558),c=n(481797),l=n(764081),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_=function(){function e(){var t=this;this.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},this.dialogProps=void 0,this.startTime=0,this.msalAccountInfo=null,this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},(0,a.cY)("ExtensibilityDialogLauncher : Extensibility Dialog closed")},this.logDialogTelemetry=function(e,n){var r=Date.now();(0,i.js)(r-t.startTime,e,null!=n?n:""),e||(0,i.jC)(null!=n?n:"")},this.onMessageCallback=function(n){return u(t,void 0,void 0,(function(){var t,o,a,i,s,c,l;return d(this,(function(u){return this.openedDialog.dialog?((t=JSON.parse(n)).type===r.o.Ack?(o={dialogContent:null===(a=this.dialogProps)||void 0===a?void 0:a.dialogContent,appDefinition:null===(i=this.dialogProps)||void 0===i?void 0:i.appDefinition,clientInfo:null===(s=this.dialogProps)||void 0===s?void 0:s.clientInfo,cardInfo:null===(c=this.dialogProps)||void 0===c?void 0:c.card,hostConfigFlags:null===(l=this.dialogProps)||void 0===l?void 0:l.hostConfigFlags,copilotChatThemev2:e.theme,source:"BizChat",msalAccountInfo:this.msalAccountInfo},this.openedDialog.dialog.messageChild(JSON.stringify(o),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0)):t.type===r.o.CloseEvent&&this.closeActiveDialog(),[2]):(this.logDialogTelemetry(!1,"ExtensibilityDialogLauncher.onMessageCallback : No active dialog found"),[2])}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return!!t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n,r;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(null===(r=null===(n=t.dialogProps)||void 0===n?void 0:n.action)||void 0===r?void 0:r.title)&&t.openedDialog.triggeringActionTitle&&t.openedDialog.triggeringActionTitle===t.dialogProps.action.title)},this.onDialogError=function(e){var n="Error opening dialog";if(e)try{n=JSON.stringify(e)}catch(e){(0,a.cY)("ExtensibilityDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"ExtensibilityDialogLauncher : ".concat(n))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return u(t,void 0,void 0,(function(){var t,r,o,a,i,s=this;return d(this,(function(l){switch(l.label){case 0:if(t=null!==(i=null===(a=null===(o=this.dialogProps)||void 0===o?void 0:o.card)||void 0===a?void 0:a.id)&&void 0!==i?i:"",this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return r=(0,c.zC)(),[4,Office.context.ui.displayDialogAsync(r,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return u(s,void 0,void 0,(function(){var n,r,o,a,i,s=this;return d(this,(function(l){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(o=null===(r=null===(n=this.dialogProps)||void 0===n?void 0:n.action)||void 0===r?void 0:r.title)&&void 0!==o?o:""},null===(a=this.openedDialog.dialog)||void 0===a||a.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return u(s,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),null===(i=this.openedDialog.dialog)||void 0===i||i.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return u(s,void 0,void 0,(function(){return d(this,(function(t){return e.error===c.Y7&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return l.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return u(t,void 0,void 0,(function(){var t,r,o,i,s=this;return d(this,(function(l){return t=(0,c.zC)(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(i=null===(o=null===(r=this.dialogProps)||void 0===r?void 0:r.dialogContent)||void 0===o?void 0:o.title)&&void 0!==i?i:a.$9,hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){s.openedDialog.dialog=e})).catch((function(e){s.onDialogError(e),(0,a.cY)("ExtensibilityDialogLauncher : Error displaying  Extensibility Dialog",e)})),[2]}))}))},this.launchExtensibilityDialog=function(e){return u(t,void 0,void 0,(function(){var t,n,r,i,c,u,_,p,g,f,h,C;return d(this,(function(d){switch(d.label){case 0:return(null==e?void 0:e.clientInfo)?(this.startTime=Date.now(),t=!this.msalAccountInfo||(null===(p=null===(_=this.dialogProps)||void 0===_?void 0:_.clientInfo)||void 0===p?void 0:p.userPrincipalName)!==e.clientInfo.userPrincipalName,this.dialogProps=e,t?(n=new a.jY({userPrincipalName:null===(g=null==e?void 0:e.clientInfo)||void 0===g?void 0:g.userPrincipalName,redirectUri:new URL(null!==(h=null===(f=null==e?void 0:e.clientInfo)||void 0===f?void 0:f.redirectUri)&&void 0!==h?h:"",window.location.origin).toString(),clientId:l.pL}),r=this,[4,n.getAccountInfoFromCache()]):[3,2]):((0,a.cY)("ExtensibilityDialogLauncher : Invalid dialog properties provided"),[2]);case 1:r.msalAccountInfo=d.sent(),d.label=2;case 2:return i=(0,s.m)(e),c=i.dialogHeight,u=i.dialogWidth,(null===(C=e.clientInfo)||void 0===C?void 0:C.clientType)===o.WK.web?this.openDialogForWebPlatformAsNewWindow(c,u):this.openDialogForNativePlatform(c,u),[2]}}))}))}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.setTheme=function(t){e.theme=t},e}()},710777:(e,t,n)=>{"use strict";n.d(t,{hD:()=>w,GY:()=>L,hT:()=>P});var r=n(194961),o=n(246205),a=n(208341),i=n(845460),s=n(891585),c=n(375294),l=n(489641),u=n(267015),d=n(60087),_=n(199904),p=n(368435),g=n(806231),f=n(801744),h=n(876728),C=n(527439),m=n(256369),v=n(509348),E=n(208520),y=n(851348),b=n(88012),T=function(e){return{audioButtonContainer:{display:"flex",alignItems:"center",justifyContent:"flex-start",gap:"10px"},button:{padding:"5px 10px",backgroundColor:e?"#185abd":"white",color:e?"white":"black",border:"0.2px solid #cfcbcb",borderRadius:"5px",cursor:"pointer",marginRight:"10px",minWidth:"30px",minHeight:"40px",transition:"background-color 0.3s"}}};const I=function(e){var t=e.audioBlob,n=(0,y._)((0,E.useState)(!1),2),o=n[0],a=n[1],i=(0,y._)((0,E.useState)(0),2),s=i[0],c=i[1],l=(0,y._)((0,E.useState)(0),2),u=l[0],d=l[1],_=(0,E.useRef)(null),p=(0,y._)((0,E.useState)(!1),2),g=p[0],f=p[1];(0,E.useEffect)((function(){if(t){var e=URL.createObjectURL(t);return _.current&&(_.current.src=e),function(){return URL.revokeObjectURL(e)}}}),[t]);var h,C,m;return E.createElement(r.B,{horizontal:!0,verticalAlign:"center"},E.createElement("div",{style:T(g).audioButtonContainer},E.createElement("audio",{ref:_,onTimeUpdate:function(){_.current&&c(_.current.currentTime)},onLoadedMetadata:function(){_.current&&d(_.current.duration)}}),E.createElement(b.$,{onClick:function(){f(!g),_.current&&(o?_.current.pause():_.current.play(),a(!o))},iconProps:{iconName:o?"Pause":"Play"},style:T(g).button})),E.createElement("div",{style:{display:"flex",alignItems:"center",width:"90%",border:"0.2px solid #cfcbcb",borderRadius:"5px",padding:"10px"}},E.createElement("span",{style:{fontSize:"12px",marginRight:"10px"}},(h=s,C=Math.floor(h/60),m=Math.floor(h%60),"".concat(C,":").concat(m<10?"0":"").concat(m))),E.createElement("input",{type:"range",min:0,max:u,value:s,onChange:function(e){var t=parseFloat(e.target.value);_.current&&(_.current.currentTime=t),c(t)},style:{flex:1,marginBottom:"0"}})))};var P,A=n(857835),D=n(260623),S=n(379563),M=n(529404),O=(0,D.n)({cardStyle:{padding:"1px",borderRadius:"8px",zIndex:999,maxHeight:"80vh",overflowY:"auto"},cardGap:(0,A._)({},S.Pt.gap("8px")),headerStyle:{marginTop:"20px !important"},paddingBottom:{paddingBottom:"12px"},PinCardsStyle:{padding:"12px",backgroundColor:M.L.colorNeutralBackground2},accordionPanelStyle:(0,A._)({paddingBottom:"12px"},S.Pt.gap("8px")),pinnedMessageStyle:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",maxHeight:"3em",lineHeight:"1.5em",whiteSpace:"normal"},showMoreCardStyle:{padding:"4px 8px",borderRadius:"8px",backgroundColor:M.L.colorNeutralBackground2}});n(758651);!function(e){e.suggestion="suggestion",e.skillName="skillName",e.operations="operations"}(P||(P={}));var k=function(e){var t,n,v,y=e.id,b=e.content,T=e.addButtonProps,P=e.copyButtonProps,A=e.pinButtonProps,D=e.aiHelpButtonProps,S=e.aiSuggestionButtonProps,M=e.isContentSensitive,k=void 0!==M&&M,L=e.heading,w=e.filePickerComponent,R=e.blobData,U=O(),B=function(e){var t;return E.createElement(a.W,{positioning:"above"},E.createElement(i.c,{disableButtonEnhancement:!0},E.createElement(s.$,{size:"small",appearance:"transparent",icon:null!==(t=null==e?void 0:e.buttonIcon)&&void 0!==t?t:E.createElement(E.Fragment,null,null==e?void 0:e.buttonIcon)},null==e?void 0:e.buttonText)),E.createElement(c.b,null,E.createElement(l.c,null,E.createElement(u.r,null,E.createElement(d.s,null,E.createElement(_.Q,null,e.headerText)),null==e?void 0:e.suggestionList.map((function(e){return E.createElement(E.Fragment,null,E.createElement(p.c,null),E.createElement(g.D,{onClick:function(){return null==e?void 0:e.onClick(b,e.content,e.responsetype,e.skillName)},icon:e.icon},e.content))}))))))},x=new Blob([new Uint8Array(R||[])]);return E.createElement(r.B,{key:y},E.createElement(o.a,null,E.createElement(_.Q,null,L)),E.createElement(o.a,{style:{marginBottom:"5px"}},b&&function(e){return e.replace(/<table/g,'<table style="width:100%; height: 100%;"')}(b)),R&&E.createElement(I,{audioBlob:x}),w&&E.createElement(o.a,null,w),""===b?E.createElement(f.y,{label:"Waiting for content..."}):E.createElement(E.Fragment,null,E.createElement(r.B,{horizontal:!0,className:U.cardGap},T&&E.createElement(s.$,{size:"small",icon:null!==(t=T.icon)&&void 0!==t?t:E.createElement(h.m61,null),onClick:function(){var e;return null===(e=T.onClick)||void 0===e?void 0:e.call(T,b)},disabled:k},T.text),D&&B(D),P&&E.createElement(s.$,{size:"small",appearance:"transparent",icon:null!==(n=P.icon)&&void 0!==n?n:E.createElement(C.Qvr,null),onClick:function(){var e;return null===(e=P.onClick)||void 0===e?void 0:e.call(P,b)},disabled:k}),A&&E.createElement(s.$,{size:"small",appearance:"transparent",icon:null!==(v=A.icon)&&void 0!==v?v:E.createElement(m.MtV,null),onClick:function(){var e;return null===(e=A.onClick)||void 0===e?void 0:e.call(A,b,y)},disabled:k}),S&&B(S))))},L=function(e,t,n,r,o,a,i,s,c,l,u,d){return E.createElement(k,{id:e,content:t,addButtonProps:n,copyButtonProps:r,pinButtonProps:o,aiHelpButtonProps:a,aiSuggestionButtonProps:i,isContentSensitive:s,heading:c,filePickerComponent:l,blobData:u,blobVal:d})},w=function(e){switch(e){case"generateSummary":return{text:"Generate Summary",icon:E.createElement(C.Mrw,null)};case"generateTable":return{text:"Generate Table",icon:E.createElement(v.PJ4,null)};default:return{text:"Rewrite Content",icon:E.createElement(C.GvE,null)}}}},720971:(e,t,n)=>{"use strict";var r;n.d(t,{S:()=>r}),function(e){e.default="default",e.none="none",e.enableCommanding="enableCommanding",e.enableQnA="enableQnA",e.enableSummary="enableSummary",e.maxLimit="maxLimit"}(r||(r={}))},722603:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});var r=n(811912),o=n(791165),a=n(618859),i=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,null,[{key:"GetHostAppContentLaguage",value:function(){return Office.context.contentLanguage}},{key:"GetHostAppDisplayLanguage",value:function(){return Office.context.displayLanguage}},{key:"GetHostAppPlatform",value:function(){return Office.context.diagnostics.platform.toString().toUpperCase()}},{key:"isWin32Platform",value:function(){return"PC"==e.GetHostAppPlatform()}},{key:"getDocumentUrlAsync",value:function(){return new Promise((function(e){Office.context.document.getFilePropertiesAsync((function(t){var n;e(null===(n=t.value)||void 0===n?void 0:n.url)}))}))}},{key:"isWebPlatform",value:function(){return"OFFICEONLINE"==e.GetHostAppPlatform()}},{key:"isMacPlatform",value:function(){return"MAC"==e.GetHostAppPlatform()}},{key:"isIOSPlatform",value:function(){return"IOS"==e.GetHostAppPlatform()}},{key:"getM365ChatClientPlatform",value:function(){switch(e.GetHostAppPlatform()){case"PC":return a.mp.Win32;case"MAC":return a.mp.MacOS;case"IOS":return a.mp.iOS;case"OFFICEONLINE":return a.mp.Web;default:return a.mp.Unknown}}}]),e}()},724919:(e,t,n)=>{"use strict";n.d(t,{$S:()=>a.$S,Iz:()=>o.Iz,LT:()=>r.L});var r=n(339675),o=n(353923),a=n(362962)},736679:(e,t,n)=>{"use strict";n.d(t,{Bb:()=>o.Bb,C$:()=>o.C$,Xh:()=>r.Xh,a2:()=>r.a2,f9:()=>r.f9,w:()=>o.w});var r=n(375653),o=n(789065)},740389:(e,t,n)=>{"use strict";n.d(t,{$2U:()=>Ga,$3p:()=>Fr,$9h:()=>fo,$AM:()=>ka,$Cf:()=>rs,$Ez:()=>cr,$J1:()=>J,$U2:()=>me,$WV:()=>Et,$bq:()=>k,$ff:()=>Oi,$ii:()=>hs,$pQ:()=>Mr,$rF:()=>Pn,A9c:()=>qr,AFi:()=>Nt,AJD:()=>is,ALg:()=>yt,Adl:()=>Ft,AgJ:()=>Co,AkJ:()=>Os,AmF:()=>As,BCo:()=>Kn,BSB:()=>zn,C0Y:()=>Dn,CIC:()=>Jn,CLb:()=>ba,CSq:()=>ut,CUx:()=>Vn,CXc:()=>$r,CYx:()=>ja,Cpg:()=>xr,CuF:()=>tt,CuN:()=>ea,CyP:()=>fi,D2B:()=>_i,D8N:()=>Ir,DBC:()=>dn,DDO:()=>de,DI8:()=>$i,DMe:()=>Lo,DOP:()=>si,DWo:()=>Fi,DYP:()=>eo,DYe:()=>Wt,Dmc:()=>Ki,DnQ:()=>Cs,DtK:()=>Je,DwB:()=>Xt,DxQ:()=>P,Dzl:()=>Vr,Dzy:()=>ni,E4X:()=>ji,EEM:()=>I,EG7:()=>rt,EHu:()=>Zi,EIr:()=>Sr,EMj:()=>ha,EiL:()=>vi,Ere:()=>gr,FC0:()=>Ja,FFf:()=>ao,FP9:()=>ur,FWR:()=>Hi,FYS:()=>Ns,FrA:()=>je,FsT:()=>$s,Fz9:()=>Pe,G1e:()=>ar,G3Z:()=>la,GDJ:()=>So,GK3:()=>L,GPk:()=>Ra,GRg:()=>Fe,GVV:()=>Bo,GWw:()=>On,Ggk:()=>pt,Gjt:()=>mr,Gmz:()=>lr,H2h:()=>Pt,H45:()=>sr,HHe:()=>Ka,HHv:()=>Ce,HKE:()=>br,HSC:()=>j,HUI:()=>Ao,HYu:()=>ls,Hi6:()=>ga,HsI:()=>De,I3H:()=>uo,IQJ:()=>xs,IW0:()=>ns,IaT:()=>Rn,IbI:()=>Ii,IeB:()=>lt,IfU:()=>Es,Ikw:()=>F,InH:()=>tr,Iy:()=>rr,JIK:()=>wi,Jqb:()=>Yi,Jqj:()=>an,Jrn:()=>Zo,Jz:()=>Ta,K$l:()=>Ys,K9Y:()=>fn,KC9:()=>_n,KOx:()=>os,KQw:()=>pr,KT8:()=>fe,KWs:()=>ie,KYx:()=>wo,Kr3:()=>yi,KsL:()=>Gn,Kuk:()=>cs,KxH:()=>Hs,L4b:()=>Gr,LDc:()=>V,LSW:()=>Xe,LUs:()=>Fs,LV3:()=>nt,LXk:()=>Jt,Lhe:()=>Di,Lzg:()=>qn,M$$:()=>_e,M3V:()=>Lr,MEQ:()=>fa,MHS:()=>jr,MNq:()=>ya,MQi:()=>Ri,MU0:()=>Wa,MqF:()=>To,NL9:()=>kr,NMh:()=>di,NQ$:()=>Pa,NT7:()=>Za,N_q:()=>At,NbV:()=>mi,Nnx:()=>co,Nud:()=>oi,Nx$:()=>$e,O74:()=>fs,O7K:()=>We,ON2:()=>qo,OSU:()=>Gi,OSh:()=>Xs,OUH:()=>vo,OWE:()=>zs,OWF:()=>Pr,OiA:()=>ct,Om4:()=>Mi,OrF:()=>xt,OvN:()=>ze,Ozm:()=>Vt,P3Z:()=>Un,PGz:()=>mt,PTj:()=>Z,PVq:()=>Po,PXo:()=>kn,Pn_:()=>ua,PrP:()=>ai,Py4:()=>so,Q9p:()=>_o,QC:()=>Qi,QF:()=>es,QMx:()=>Bi,QS5:()=>dt,QX7:()=>go,Qif:()=>Xr,QkZ:()=>Ua,Qni:()=>ms,Qq4:()=>vs,Rhi:()=>Dt,Rq8:()=>Ti,RyG:()=>Ke,SAS:()=>qs,SBS:()=>Nn,SBW:()=>wn,SEe:()=>gt,SYO:()=>qt,Shf:()=>zr,SiZ:()=>zo,Skv:()=>ae,Slc:()=>xa,Ssi:()=>ln,T7t:()=>La,TS5:()=>jt,Tby:()=>It,ThR:()=>Ds,TnG:()=>en,Tvc:()=>po,U4g:()=>Ps,UJf:()=>Me,ULG:()=>st,UM0:()=>Ba,UTV:()=>Aa,UW0:()=>us,UZi:()=>Yn,UjN:()=>pa,UxI:()=>Fa,Uyp:()=>ht,V3I:()=>be,V7J:()=>En,VDk:()=>Ht,VR7:()=>Yo,VYW:()=>Se,W4o:()=>ei,WFw:()=>pe,WIm:()=>Ct,WJo:()=>Ro,WLE:()=>ys,WNl:()=>w,WPi:()=>Cr,WTS:()=>we,Wdf:()=>te,Wmj:()=>Qt,Wp2:()=>bi,WqY:()=>Ko,WrJ:()=>za,X$8:()=>ii,X$C:()=>Hn,X41:()=>qa,XIt:()=>Ui,XPY:()=>Qs,XTA:()=>ke,XU$:()=>Vo,XUz:()=>ro,XXz:()=>xn,Xao:()=>yn,XmF:()=>An,Xp$:()=>xe,Xrt:()=>Tr,Xuj:()=>Pi,YAc:()=>Js,Ypu:()=>ho,YqN:()=>K,Z47:()=>Ma,Z8j:()=>C,ZEr:()=>q,Zhy:()=>$,ZmX:()=>Ae,_1Y:()=>E,_3I:()=>$a,_74:()=>nr,_8$:()=>ia,_Ij:()=>Gs,_SP:()=>Ut,_jX:()=>oo,_kL:()=>Jo,_k_:()=>Xi,_kn:()=>O,aC$:()=>Bn,aH3:()=>tc,aIk:()=>ve,aJZ:()=>Mt,aQo:()=>ge,ahx:()=>xi,aiL:()=>_a,ak4:()=>ee,anI:()=>_r,azT:()=>ds,azj:()=>hn,bUF:()=>ca,beW:()=>m,cH7:()=>Ar,cMx:()=>Us,cPf:()=>yo,cPj:()=>Yr,cU3:()=>Qn,cVe:()=>X,cWQ:()=>ye,cez:()=>Rr,cjy:()=>Ci,cpQ:()=>Ks,cz7:()=>Da,czT:()=>Hr,d3Q:()=>ci,dOo:()=>se,dS:()=>Oe,dVS:()=>oa,dW$:()=>ko,dl4:()=>Wo,dr7:()=>wa,dru:()=>Zs,dw_:()=>lo,e$6:()=>kt,e6I:()=>Wi,e8X:()=>qi,eHf:()=>pi,eOl:()=>Rs,ebC:()=>Ee,eh5:()=>ks,emG:()=>_t,epR:()=>z,f0B:()=>Ni,f1i:()=>Do,fFf:()=>Vs,fRX:()=>bo,fWR:()=>ue,fX6:()=>Li,feb:()=>zi,fnH:()=>Go,fnY:()=>to,g38:()=>ti,g5g:()=>Qr,g92:()=>un,gNz:()=>on,gQ_:()=>ce,ga$:()=>qe,gc0:()=>W,gd4:()=>Ji,geh:()=>v,ggJ:()=>Ze,gi4:()=>ma,gr8:()=>Y,hC:()=>Ho,hEq:()=>Yt,hF:()=>Zr,hRR:()=>gs,hnZ:()=>b,hoV:()=>D,hrE:()=>Gt,hw5:()=>Oo,i$4:()=>Qo,i3k:()=>ss,i5M:()=>Ca,iAi:()=>S,iGk:()=>xo,iKM:()=>vt,iWh:()=>li,iZl:()=>Ms,idb:()=>Re,iih:()=>He,jGy:()=>Er,jOg:()=>et,jjh:()=>zt,jv5:()=>G,k4j:()=>Mn,k6y:()=>pn,k8S:()=>St,kh6:()=>mn,khs:()=>Zn,kky:()=>Or,knu:()=>ts,l3J:()=>y,l6e:()=>Ne,l9B:()=>Is,lH6:()=>bn,lJI:()=>Vi,lWG:()=>Qa,lYv:()=>_s,mOp:()=>cn,mRe:()=>yr,mXJ:()=>Ls,mZS:()=>aa,mdc:()=>no,mmq:()=>Te,mn7:()=>R,n5h:()=>A,n7$:()=>js,n7p:()=>ri,nId:()=>va,o25:()=>Kt,o94:()=>ne,oCn:()=>Be,oJj:()=>Q,oaD:()=>oe,okL:()=>da,oly:()=>Ie,opT:()=>Ia,osS:()=>ot,p7G:()=>sa,p9C:()=>Zt,pBW:()=>ir,pJh:()=>T,pn0:()=>vr,prt:()=>Ur,qH6:()=>x,qJy:()=>Br,qMK:()=>Ei,qNo:()=>Uo,qNw:()=>No,qU:()=>Xa,qcN:()=>rn,qij:()=>Qe,qm6:()=>Sn,qsF:()=>nn,r2Z:()=>Ai,rY:()=>ra,rY0:()=>le,rpM:()=>ps,s2L:()=>Xn,s9k:()=>Wn,sDe:()=>ec,sK$:()=>gi,sKT:()=>ta,sQV:()=>mo,sTw:()=>g,sb6:()=>Dr,sc:()=>dr,sc6:()=>Ln,snA:()=>f,stP:()=>Fo,stn:()=>wt,sx$:()=>Ts,sx9:()=>ui,t3e:()=>N,tO4:()=>as,tPu:()=>Rt,tV1:()=>io,tcW:()=>Nr,tiu:()=>Lt,tl_:()=>Eo,tmD:()=>at,tmc:()=>ki,tpT:()=>Jr,txF:()=>fr,u5T:()=>hi,uIO:()=>Va,uPJ:()=>it,uQx:()=>jo,uRc:()=>Ye,uo3:()=>Sa,uyL:()=>$o,v1l:()=>ft,vAO:()=>Cn,vD:()=>Ya,vLn:()=>Fn,vM4:()=>Kr,vTB:()=>Ue,vcx:()=>ws,vdI:()=>Oa,vnk:()=>Tt,vzv:()=>Ge,w2V:()=>Ha,wBW:()=>Ot,wBl:()=>Bt,wOV:()=>Wr,wT7:()=>sn,wxD:()=>U,wxU:()=>$n,wzE:()=>vn,x13:()=>er,x2g:()=>Mo,xCw:()=>M,xUk:()=>re,xUq:()=>Ws,xVH:()=>na,xeR:()=>Le,xiT:()=>Xo,xw0:()=>Ea,xyK:()=>Na,y2i:()=>Tn,yZP:()=>tn,yq6:()=>hr,yqt:()=>he,yto:()=>wr,z$Z:()=>gn,z5w:()=>Ve,zP3:()=>B,zQd:()=>jn,zS3:()=>In,zWx:()=>Ss,zd8:()=>or,zf$:()=>bs,zk2:()=>$t,zn0:()=>Bs,zrA:()=>bt,zyh:()=>Io});var r=n(602061),o=n(258005),a=n(862853),i=5,s=12e4,c="Microsoft.Office.WordOnline.FA000000125.",l="Microsoft.Office.Word.fa000000125.",u="Microsoft.Office.WordOnline.Augloop.",d=["enableProactiveZQMWithSuggestedQnA","IsQnASuggestionPillCachingEnabled","OfficeCopilotChatPreloadEnabled","enableProactiveZQMWith3SAPISuggestions","EnableInsightsCard","EnableInsightsCardQnA","EnableCarouselForInsightsCard","EnableInsightsCardSummary","EnableInsightsCardAgents","IsRelatedFilesEnabled","fixPodcastZQMinExistingDoc"],_="Microsoft.Office.SharedOnline.FA000000125.",p="Microsoft.Office.Shared.fa000000125.";function g(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=OfficeRuntime.experimentation.getBooleanFeatureGate(c+e);if(void 0!==n)return n;var r=OfficeRuntime.experimentation.getBooleanFeatureGate(l+e);return void 0!==r?r:t}function f(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=OfficeRuntime.experimentation.getBooleanFeatureGate(c+e);if(void 0!==n)return n;var r=OfficeRuntime.experimentation.getBooleanFeatureGate(l+e);return void 0!==r?r:t}function h(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=OfficeRuntime.experimentation.getBooleanFeatureGate(_+e);if(void 0!==n)return n;var r=OfficeRuntime.experimentation.getBooleanFeatureGate(p+e);return void 0!==r?r:t}function C(e,t){var n=OfficeRuntime.experimentation.getIntFeatureGate(c+e);if(void 0!==n)return n;var r=OfficeRuntime.experimentation.getIntFeatureGate(l+e);return void 0!==r?r:t}function m(e,t){var n=OfficeRuntime.experimentation.getStringFeatureGate(c+e);if(void 0!==n)return n;var r=OfficeRuntime.experimentation.getStringFeatureGate(l+e);return void 0!==r?r:t}function v(){return e="EndpointOverride",t=-1,void 0!==(n=OfficeRuntime.experimentation.getIntFeatureGate(u+e))?n:t;var e,t,n}function E(){return C("ChatHistoryTimeoutInSeconds",i)}function y(){return C("DeepResearchTimeOut",s)}function b(){return C("ScrollToBottomThrottleDelay",500)}function T(){return g("AllowObjectInHostSetting")}function I(){return C("InstantScrollToBottomThrottleDelay",500)}function P(){return f("CopilotInBackstageEnabled",!1)}function A(){return g("EnableZQMEarlyLoadingInBackstage")}function D(){return g("EnableHighlightedKeywordsInZQMPrompts")}function S(){return f("ShouldCheckUserLicense")}function M(){return h("EnableM365CopilotChatStarter")||h("EnableM365CopilotChat")}function O(){return g("isInstantScrollEnabled",!1)}function k(){return g("EnableStopGeneratingButtonInChatInput",!1)}function L(){return f("ContentCreationIsEnabled")}function w(){return f("IsEnableAnalyzeDataButton")}function R(e){return e}function U(){return f("ReviewSyncAgentEnabled")}function B(){return g("IsNewWordAppCopilotWorkflowIntegrationEnabled")}function x(){return g("IsSydneyWorkflowForConsumerUserEnabled")}function W(){return f("IsBizChatSydneyUrlOverrideEnabled")}function F(){return g("IsFinalResponseFromALEnabled")}function N(){return f("IsNewWordAppCopilotWorkflowSuggestionsForCommandingEnabled")}var K,H=function(){return(0,a.w5)()};function G(){return g("IsGroundingPhase2UxEnabled")}function Q(){return f("EnableEnterpriseToggleInPhase2Ux")}function j(){return g("IsEnterpriseSearchDefaultOn")}function Y(){return g("IsWebSearchDefaultOn")}function z(){return g("IsPersistanceInPhase2UxEnabled")}function q(){return g("isCopilotOdslProcessingEnabled")}function V(){return g("isSplittingRangeIntoParagraphsDisabled")}function Z(){return f("isContextTreeBuildingEnabled")}function J(){return g("shouldEnableUndoForWholeAppInsteadCopilotChatTask")}function X(){return f("EnableSemanticSelectionWithPaginatedCards")}function $(){return g("IsCommandingEarlyReturnTelemetryEnabled")}function ee(){return g("IsCommandingUserPerceivedLatencyTelemetryEnabled")}function te(){return g("UseNewCopilotSharedPackage")}function ne(){return g("IsHandoffToBizChatEnabled")}function re(){return g("UseHandoffMessagePropertiesValue")}function oe(){return f("IsHandoffButtonEnabled",!1)}function ae(){return f("IsHandoffBookendingEnabled",!1)}function ie(){return f("IsHandoffGetAnnotationsEnabled",!1)}function se(){return f("IsHandoffInteractiveSummaryAndContentCallbackEnabled",!1)}function ce(){return g("IsHandoffRTLEnabled")}function le(){return function(e,t){var n=OfficeRuntime.experimentation.getIntFeatureGate(c+e);if(void 0!==n)return n;var r=OfficeRuntime.experimentation.getIntFeatureGate(l+e);return void 0!==r?r:t}("OpenInWordMinimumForHeuristic",5)}function ue(){return f("IsODSLResponseCheckEnabled",!0)}function de(){return f("isInsertEnabled",!1)}function _e(){return f("isSmartInsertEnabled",!1)}function pe(){return g("HandoffEnabled")}function ge(){return g("EnableWordCanvasHandoff")}function fe(){return g("AppValueChecksForBookending")}function he(){return f("RenderChatHistoryInHandoffDestination",!1)}function Ce(){return f("IsHandoffLoadingPageEnabled",!1)}function me(){return f("IsUrlUnfurlingUsingGraphAPIEnabled",!1)}function ve(){return f("DocTransformHandoffEnabled",!1)}function Ee(){return g("FixHandoffClientMetrics")}function ye(){return g("isHandoffAutoSubmitPromptsEnabled")}function be(){return g("LogAuthFlowForDesignerTelemetryEnabled")}function Te(){return g("isGenerateContentForDesignerEnabled")}function Ie(){return f("IsGenerateContentForClipChampEnabled")}function Pe(){return g("IsAgentsLoggingEnabledInShared")}function Ae(){return f("shouldUseMsalGetTokenForDesigner")}function De(){return f("IsEnterpriseBase64ImageEnabled",!1)}function Se(){return f("isSydneyDebugToggleEnabled",!1)}function Me(){return f("IsDebugSectionV2Enabled",!1)}function Oe(){return g("AddDebugInfoToMessage")}function ke(e){return m("PerfCounterGoals"+e,"")}function Le(){return f("IsCipTreeEnabledInDebugMenu",!1)}function we(){return f("IsChatHistoryHydrationErrorEnabled",!1)}function Re(){return f("isReplaceBehaviorForInsertEnabled",!1)}function Ue(){return f("isChatHTMLStyleOverridesEnabled",!1)}function Be(){return f("EnabledInsertListCommand",!0)}function xe(){return f("ZQMEarlyLoadingEnabled",!1)}function We(){return f("ShouldSendALConfigForRAI",!0)}function Fe(){return f("IsApiPluginsEnabled",!1)}function Ne(){return f("IsApiPluginsCardsEnabled",!1)}function Ke(){return f("LogMSALTokenRequestTelemetry",!1)}function He(){return g("IsSccReadAloudEnabled",!0)}function Ge(){return g("IsSccReadAloudAugloopEnabled",!0)}function Qe(){return f("IsSccPromptSuggestionsEnabled",!1)}function je(){return g("isClaimsChallengeMessageInAnnotationEnabled")}function Ye(){return g("ShouldShowVideoNotSupportedMessage")}function ze(){return f("ShouldRenderAllHyperLinks",!1)}function qe(){return g("IsMsgExtChatHistoryEnabled")}function Ve(){return g("IsMsgExtTelemetryEnabled")}function Ze(){return g("IsCopilotExtTelemetryEnabled")}function Je(){return f("IsCodeInterpreterEnabledForDefaultCopilot",!1)}function Xe(){return f("IsCodeInterpreterEnabled",!1)}function $e(){return g("ShouldCLPExceptionDisableEnterpriseSearch")}function et(){return f("isCustomErrorCardEnabled",!1)}function tt(){return f("isCustomLoggingEnabled",!1)}function nt(){return f("IsClpSensitivityInChatInputEnabled",!1)}function rt(){return H()&&g("IsClpEnabledInEnterpriseForSydney")}function ot(){return f("IsCiqEnabledInDAs",!1)}function at(){return g("RenameToAgentsEnabled")}function it(){return g("EnableCommandingTelemetry")}function st(){return f("EnableTextSearchExpansion",!0)}function ct(){return f("ReplaceTextFromLastOfTextRangeEnabled",!0)}function lt(){return f("IsChatComposeEnabled")}function ut(){return C("SummaryWordCountLowerLimit",60)}function dt(){return g("UseHardcodedClientErrorMessagingEnabled")}function _t(){return g("UseAIResponsesInODSLForSydney")}function pt(){return g("ShouldRenderErrorResponseFromFinalAnnotation")}function gt(){return g("ShouldUpdateDocSensitivityAtStreamEndForODSLInsertion")}function ft(){return f("SelfHelpSearchRenderingEnabled")}function ht(){return g("EnableCIQOnlyWhenEnterpriseSearchIsEnabled")}function Ct(){return g("disableClientConfigQueryCharacterForEditorService")}function mt(){return f("IsSendToTelemetrySinkEnabled",!1)}function vt(){return C("DesignerBannerWidth",o.wM)}function Et(){return C("DesignerBannerHeight",o.VE)}function yt(){return f("IsDesignerDogfoodEndpointEnabled",!1)}function bt(){return f("UseDesignerProdOCDI",!1)}function Tt(){return f("UseDesignerDoDOCDI",!1)}function It(){return f("EnableDesignerImageGen4o",!1)}function Pt(){return C("RedirectURLEndpointOverride",0)}function At(){return m("OverrideVersion","")}function Dt(){return g("HandleUnsupportedCommandErrorCode")}function St(){return f("EditorFluentV9SettingEnabled")}function Mt(){return g("IsCitationSupportForAvalonEnabled")}function Ot(){return f("IsWebChatToggleEnabled",!1)}function kt(){var e=m("WebChatUrl","");return e||void 0}function Lt(){return m("SingleShotAllowedContentOrigins","")}function wt(){return f("IsDesignerImageInsertionHTMLEnabled",!1)}function Rt(){return f("showDesignerPromptsInPromptGuide",!1)}function Ut(){return f("isReviewerAgentEnabled",!1)}function Bt(){return Ut()&&f("isReviewerAgentToggleEnabled",!1)}function xt(){return f("ShowPluginsAsAgents")}function Wt(){return f("ShowPluginAsDAInFlyout")}function Ft(){return f("EnableSearchBarInCIQECC")}function Nt(){return f("LoadGptListOnCopilotIconClick")}function Kt(){return g("EnableSwitcherMenuV2")}function Ht(){return f("EnableAgentsBasedOnSkill")}!function(e){e.FCFR="FCFR",e.LCFR="LCFR"}(K||(K={}));var Gt=function(){return f("EnableAgentWithBizChatProfileType")},Qt=function(){return f("EnableAgentsWithFluxV3")},jt=function(){return(0,a.q0)()&&f("EnableBizChatInAppChat")},Yt=function(){return f("HandoffPrivateApiEnabled")},zt=function(){return(0,a.q0)()&&f("EnableBizChatAgentsInAppChat")},qt=function(){return f("EnableHostLocalPluginsProvider")},Vt=function(){return f("EnableHostInjectedContextProvider")},Zt=function(){return f("EnableInsertButton",!1)};function Jt(){return!xt()&&f("IsCopilotPluginEnabled",!1)}function Xt(){return f("ShowPersonalizationSuggestionPill",!1)}function $t(){return f("IsBYOAgentEnabled",!1)}function en(){return f("IsJSExecutionEnabled",!1)}function tn(){return f("isLoopInWorkspaceEnabled",!1)}function nn(){return $t()&&g("isBYOAInputCIQEnabled",!1)}function rn(){return f("isCIPManipulateEnabled",!1)}function on(){return f("isBYOAgentValidationCardEnabled",!1)}function an(){return f("isBYOAgentValidationCardWithoutALEnabled",!1)}function sn(){return $t()&&f("isBYOAIdeasToPPTEnabled",!1)}var cn=function(){return!(0,r.$$b)()&&!(0,r.fUp)()||f("IsFeedbackAppChatIntegrationEnabled",!1)};function ln(){return f("UseCheckFeedbackEligibility")}function un(){return f("EnableCIQGlowUpVisualRefresh")}function dn(){return f("IsAddButtonToLeftEnabled",!1)}function _n(){return g("RefactorUnsupportedLanguageErrorString")}function pn(){return g("ShouldAddLinkSuffixForErrorMessage")}function gn(){return g("AddFeatureNameInLatencyTableIfEmpty")}function fn(){return g("ShowPluginReferencesV3")}function hn(){return g("showUpdatedAshaStrings")}function Cn(){return g("IsFeedbackAIThumbsUpScenarioEnabled")}function mn(){return m("LaunchThisVersionOfSDX","")}function vn(){return f("EnablePreProdForMaciPad")}function En(){return g("EnableALCorrelationLogs")}function yn(){return g("isDirectCallToSummaryWfEnabled")}function bn(){return f("IsPersonalizationUXEnabled")}function Tn(){return g("IsPersonalizationEntryPointInPromptMenuEnabled")}function In(){return g("isMSAAuthWorkaroundEnabled")}function Pn(){return f("EnableDesignerFeedbackDataForDebugMode",!1)}function An(){return g("ShouldSendCopilotLabCategories")}function Dn(){return g("IsASHAErrorLoggingEnabledForDesignerSideErrors")}function Sn(){return g("IsDalleImageRehydrationEnabled")}function Mn(){return g("IsBannersRehydrationEnabled")}function On(){return f("UseDesignerPromptForDalle",!1)}function kn(){return f("EnableTier4Languages")}function Ln(){return f("NewChatInHeaderControl",!1)}function wn(){return f("IsPersonalizationConfirmationResponseEnabled")}function Rn(){return g("IsPersonalizationIndicatorHeaderEnabled")}function Un(){return g("IsShouldSendStopGeneratingSignaltoALEnabled")}function Bn(){return f("IsCopilotSharedHeaderEnabled")}function xn(){return f("IsChatHistoryOnSwitcherMenuEnabled")}function Wn(){return f("IsSettingsPanelOnSwitcherMenuEnabled")}function Fn(){return f("IsSwitcherMenuContainerEnabled")}function Nn(){return f("IsSafeLinksEnabled")}function Kn(){return f("IsSafeLinksNonLegacyUrlEnabled")}function Hn(){return g("IsPACTokenEnabled")}function Gn(){return g("IsQueryWarmupSignalEnabled",!1)}function Qn(){return g("IsQueryWarmupSignalEnabledOnChatPaneOpens",!1)}function jn(){return f("IsCreditsUIInternalEnabled")}function Yn(){return f("IsWordCanvasToolEnabled")}function zn(){return f("IsWordCanvasPrivateApiEnabled")}function qn(){return f("IsNewChatOnCopilotGPTItemEnabled")}function Vn(){return f("IsNewChatOnGPTItemsEnabled")}function Zn(){return g("ShouldRecordAppAndCopilotPaneStartCheckpoints")}function Jn(){return f("UseDisengagedMessageType")}function Xn(){return f("IsViewMorePromptsIconV2Enabled")}function $n(){return g("IsAtMentionRedirectURLSetup")}function er(){return g("IsCustomWidthPropOnACEnabled")}function tr(){return g("IsAriaAnnouncerEnabled")}function nr(){return g("IsFallbackAriaAnnouncerEnabled")}function rr(){return g("IsAriaAnnouncementOnInsertButtonClickEnabled")}function or(){return f("IsViewMorePromptsOneClickEnabled")}function ar(){return f("IsSaveSharePromptEnabled")}function ir(){return f("IsSavePromptEnabled")}function sr(){return f("IsSharePromptEnabled")}function cr(){return f("IsDeclarativePromptsEnabled")}function lr(){return f("isDeclarativePromptsSaveEnabled")}function ur(){return g("isCodePreviewEnabled")}function dr(){return f("isCopilotWorkspacesEnabled",!1)}function _r(){return f("isSaveToOneDriveEnabled",!1)}function pr(){var e=f("isCreatePodcastEnabledForConsumer",!1),t=f("enablePodcastForTopOfDOc",!1),n=f("isCreatePodcastEnabled",!1);return!(!e&&!(0,a.q0)())&&(t||n)}function gr(){return f("enablePodcastForTopOfDOc",!1)||f("isPodcastV2Enabled",!1)}function fr(){return f("isPodcastClientConfigEnabled",!1)}function hr(){return f("enablePodcastForTopOfDOc",!1)||f("isAudioCastAutoPlayEnabled",!1)}function Cr(){return f("isConfigurePodcastEnabled",!1)}function mr(){return f("isOpenFullPodcastPlayerEnabled",!1)}var vr=function(){return f("isComprehensionViewEnabled",!1)};function Er(){return f("EnablePaneResizeResetOnViewSwitch",!1)}function yr(){return f("MaxExpandComprehensionView",!1)}function br(){return f("enablePodcastForTopOfDOc",!1)||f("isAudioCastAugloopWorkflowEnabled",!1)}function Tr(){return m("PodcastVoiceIds","")}function Ir(){return f("isAudioCastDownloadEnabled",!1)}function Pr(){return f("enablePodcastForTopOfDOc",!1)||f("isAudioCastPinningEnabled",!1)}function Ar(){return f("isAudioCastRaiseHandEnabled")}function Dr(){return f("enablePodcastForTopOfDOc",!1)||f("enableAudioPlayerTelemetry",!1)}function Sr(){return m("PodcastSpeakerNames","")}function Mr(){return m("AudioCastOutputTypes","")}function Or(){return C("AudioCastModel",67)}function kr(){return m("AudioCastPrompt","AudioCastPromptV3")}function Lr(){return m("AudioCastScriptHandler","DefaultScriptHandler")}function wr(){return f("isCreateLoopCardEnabled",!1)}function Rr(){return f("IsDODChangesForAppChatEnabled",!1)}function Ur(){return f("isLoopcardExpansionEnabled",!1)}function Br(){return f("IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled",!1)}function xr(){return f("enableProactiveZQMWith3SAPISuggestions",!1)}function Wr(){return f("enableProactiveZQMWithSuggestedQnA",!1)}function Fr(){return f("EnableInsightsCard",!1)}function Nr(){return f("EnableInsightsCardQnA",!1)}function Kr(){return f("EnableInsightsCardSummary",!1)}function Hr(){return f("EnableInsightsCard",!1)&&f("EnableCarouselForInsightsCard",!1)}function Gr(){return f("IsAppChatGlowUXEnabled",!1)}function Qr(){return f("IsModelSelectorEnabled",!1)}function jr(){return f("ShowWelcomeExperience",!1)}function Yr(){return C("InteractiveCardLoadingTimeout",15e3)}function zr(){return f("IsCloudFileUploadEnabled",!1)}function qr(){return f("IsLocalFileUploadEnabled",!1)}function Vr(){return f("isImplicitCIQForCloudFilesEnabled",!1)}function Zr(){return f("isImplicitCIQForLocalFilesEnabled",!1)}function Jr(){return g("IsInputMessageEnabled")}function Xr(){return g("IsChatHistorySignalDeferred")}function $r(){return g("IsDragDropWrapperEnabled")}function eo(){return g("ShouldUseOfficeHubName")}function to(){return g("EnablePluginSearchInFlyout")}function no(){return g("EnableMorePluginHyperLinkInFlyout")}function ro(){return f("isWorkspacesDemoModeDisabled",!1)}function oo(){return f("UseUpdatedGroundingButtonTitle")}function ao(){return g("EnableQueryEndOnGptSwitch")}function io(){return f("OfficeCopilotChatPreloadEnabled",!1)}function so(){return f("IsPluginToolboxEnabledForPlugins",!1)}function co(){return g("EnableClientEnvironmentDetection")}function lo(){return g("EnableInterstitialConfirmation")}function uo(){return g("EnableInterstitialAuthentication")}function _o(){return g("EnablePassAllInterstitialMessages")}function po(){return f("UseHTMLSelectionData",!1)}function go(){return f("EnablePicturesInSelectionData",!1)}function fo(){return f("IsImplicitSelectionEnabled",!1)}function ho(){return f("IsImplicitSelectionEnabledEnabledForExtensibilityScenarios",!1)}function Co(){return f("IsSelectionButtonEnabled",!1)}function mo(){return f("IsMultiSelectionAttachmentEnabled",!1)}function vo(){return f("EnableClientSelectionContext",!1)}function Eo(){return f("EnablePicturesInSelectionDataCatalyst",!1)}function yo(){return f("IsQnASuggestionPillCachingEnabled",!1)}function bo(){return g("IsChatCardRendererMemoizationEnabled")}function To(){return g("UseResponsiveSystemMessage")}function Io(){return f("isRealtimeVoiceEnabled",!1)}function Po(){return C("realtimeVoicePlayerVersion",2)}function Ao(){return C("realtimeVoiceClientVersion",2)}function Do(){return Io()&&g("isRealtimeVoiceChatHistoryEnabled")}function So(){return C("realtimeVoiceMuteIconVersion",1)}function Mo(){return C("realtimeVoicePlayerBufferDurationMs",1e3)}function Oo(){return g("isRealtimeVoiceDynamicBufferSizeEnabled")}function ko(){return f("isRealtimeVoiceTransciptionCardEnabled")}function Lo(){return f("isRealtimeVoiceTranscriptionStreamingEnabled")}function wo(){return f("isRealtimeVoiceToolInvokingEnabled")}function Ro(){return f("isRealtimeVoiceToolOutputEnabled")}function Uo(){return f("isRealtimeVoiceInputQueryTextEnabled")}function Bo(){return f("isRealtimeVoiceUserTranscriptionCardEnabled")}function xo(){return f("isOfficeAssistantEnabled")}function Wo(){return f("IsCopilotResearchEnabled")}function Fo(){return f("IsRelatedFilesEnabled")}function No(){return Ko().length>0}function Ko(){return m("ContentCardCocoaSkills","")}function Ho(){return f("enableSydneyDAForResearch")}function Go(){return f("enableAdvancedResearch")}function Qo(){return f("isRTVFixedWidthEnabled")}function jo(){return f("isActionSelectionEnabled")}function Yo(){return f("shouldSkipWelcomeScreen")}function zo(){return f("isOASpecialOnboardingExpEnabled")}function qo(){return g("shouldAssistantIgnoreUnknownServerErrors")}function Vo(){return f("shouldUseAssistantSpecificTiles")}function Zo(){return Io()&&g("isRealtimeVoiceZQMEnabled")}function Jo(){return g("isRealtimeVoiceZQMAutoStartEnabled")}function Xo(){return g("isRealtimeVoiceModeEntryEnabled")}function $o(){return f("isRealtimeVoiceSpeakerButtonEnabled")}function ea(){return f("isRealtimeVoiceHoldButtonEnabled",!1)}function ta(){return g("isRealtimeVoiceReadAloudEnabled")}function na(){return g("isRealtimeVoiceTeachingPageEnabled")}function ra(){return g("isRealtimeVoicePreviewTagEnabled")}function oa(){return f("isRealtimeVoiceMeteringResponseEnabled")}function aa(){return g("isRealtimeVoiceReadAloudVoiceSelectionEnabled")}function ia(){return C("realtimeVoiceMeteringLimitsThreshold",5)}function sa(){return g("isRealtimeVoiceAnimationQueueDisabled")}function ca(){return g("isRealtimeVoiceRAICheckEnabled")}function la(){return g("isRealtimeVoiceToolbarEnabled")}function ua(){return g("isRealtimeVoiceLoadingHaloEnabled")}function da(){return g("isRealtimeVoiceReadAloudTeachingPageEnabled")}function _a(){return f("isRealtimeVoiceDisconnectedByReadAloudEnabled")}function pa(){return g("isRealtimeVoiceNoiseSuppressionEnabled")}function ga(){return g("isRealtimeVoiceMicPermissionCheckEnabled")}function fa(){return f("isRealtimeVoiceChunkingEnabled")}function ha(){return g("ShouldStopOpenPaneWithSummaryScenario")}function Ca(){return g("ShouldStopOpenPaneWithPodcastScenario")}function ma(){return g("IsDesignerChatHistoryRehydrationCheckEnabled")}function va(){return f("IsSEFEntitiesEnabled")}function Ea(){return f("EnableElaboratedPrompt",!1)}function ya(){return g("IsDAOutputV2Enabled")}function ba(){return g("IsDACopilotBrandingEnabled")}function Ta(){return f("enablePodcastForTopOfDOc",!1)||f("shouldShowPodcastZQM",!1)}function Ia(){return f("isAudioCastPlayerEnabled",!1)}function Pa(){return f("isAudioCastCustomInstructionsEnabled",!1)}function Aa(){return f("isALHookEnabled",!1)}function Da(){return f("IsTextDirectionEnabled",!1)}function Sa(){return g("PrefetchACImages")}function Ma(){return g("EnableInMemoryCacheForACImages")}function Oa(){return Io()&&g("isRealtimeVoiceCanvasSelectionEnabled")}function ka(){return f("isRealtimeVoiceSendingWordCount")}function La(){return f("IsUXRefreshEnabledForInput",!1)}function wa(){return f("IsNewAttachmentListUiEnabled",!1)}function Ra(){return Io()&&g("IsRealtimeVoiceInputEnabledWithAddButtonOnLeft")}function Ua(){return g("IsFluentV9TaskPaneTabBehaviorEnabled")}function Ba(){return f("EnableZQMColumnStacking")}function xa(){return f("showPromptSuggestionsWithOutput",!1)}var Wa=function(){return g("IsMosInstallAgentLoaderEnabled")},Fa=function(){return f("AddinLocalPluginActionsEnabled",!1)},Na=function(){return Si(d)};function Ka(){return f("IsSccFeedbackPluginEnabled",!1)}function Ha(){return f("isOfficeAssistantTranscriptEnabled",!1)}function Ga(){return g("isRealtimeVoiceMicMutedSendTileEnabled")}var Qa=function(){return f("IsSideQuestEnabled",!1)},ja=function(){return g("AddWordCountToContext")},Ya=function(){return f("IsSideQuestStreamingEnabled",!1)},za=function(){return f("IsSideQuestMarkdownEnabled",!1)},qa=function(){return f("isSideQuestInBackStageEnabled",!1)},Va=function(){return f("ShowCitationsInSideQuest",!1)};function Za(){return f("isALRequestResponseEnabled",!1)}function Ja(){return f("EnableMultiAccessDisablementCheck",!1)}function Xa(){return C("RealtimeVoiceCopilotResponseTimeout",7e3)}function $a(){return f("IsTriggerPodcastHandoffEnabled")}function ei(){return f("isHandoffMessageActionHandlingEnabled")}function ti(){return f("IsVisualAssistantEnabled")}function ni(){return f("EnableSeedingDependentWFSubmission",!1)}function ri(){return g("isFluxWorkflowForEnhancedSummaryEnabled")}function oi(){return f("EnableAdaptiveCardEnhancements",!1)}function ai(){return f("EnableLocalCUAAgent")}function ii(){return f("EnableCUAExperience")}function si(){return f("EnableCUATokenProvider")}function ci(){return m("CUAOperatorURL","ws://localhost:9002")}function li(){return m("CUAVMURL","ws://localhost:5901")}function ui(){return f("EnableLoadCUADocument",!1)}function di(){return f("SeparateWebAndEnterpriseGrounding",!1)}function _i(){return f("EnableAdaptiveCardCharts")}function pi(){return m("LocalMCPServerURL","")}function gi(){return m("OpenAIApiKey","")}function fi(){return m("AnthropicKeyTicket","")}function hi(){return f("AWSAnthropic",!0)}function Ci(){return m("AnthropicClaudeModel","3.7")}function mi(){return f("EnableOfficeJSTool",!1)}function vi(){return f("EnableMultiOfficeJSTool",!1)}function Ei(){var e=m("OfficeJSToolDescription","");if(e.length>0)return e}function yi(){return f("EnableComJSTool",!1)}function bi(){var e=C("CommandingChatLogLevel",0);return Math.max(0,Math.min(e,2))}function Ti(){return g("EnableLoggingDocIdToALSessionKey")}function Ii(){return g("isHandoffCleanUpEnabled")}function Pi(){return f("IsClientLLMEnabled")}function Ai(){return g("ReleaseAnnotationsInCopilotChatDisplay")}function Di(){return f("isFeatureRegistryCardRenderingEnabled",!0)}var Si=function(e){var t=[],n=!0,o=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value,l=f(c,!1),u="".concat(c).concat(l?r.u1i:":0");t.push(u)}}catch(e){o=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw a}}var d=t.join(";")+";";if(d.length>24e3){var _=(d=d.substring(0,24e3)).lastIndexOf(";");-1!==_&&(d=d.substring(0,_)),d+=";"}return d};function Mi(){return g("IsDABrandingRefactorEnabled")}function Oi(){return g("IsMultipleConfirmationDialogFlowEnabled")}function ki(){return f("EnableOpenUrlDialogAction")}function Li(){return f("IsMultiStreamSingleCardEnabled",!1)}function wi(){return g("CheckUpperCaseHostAppSettingName")}function Ri(){return f("EnableImBackActions")}function Ui(){return f("isRealtimeVoiceCopilotReadAloudAugloopEnabled",!1)}function Bi(){return g("disableChatWhenUserInteractionRequiredCardIsShown")}function xi(){return f("IsUncitedReferencesEnabled")}function Wi(){return f("IsVibeWritingEnabled")}function Fi(){return g("isRealtimeVoiceReadAloudParagraphControlEnabled")}function Ni(){return g("isRealtimeVoiceReadAloudCanvasTextHighlightingEnabled")}function Ki(){return g("isRealtimeVoiceReadAloudAudioGreetingEnabled")}function Hi(){return g("isRealtimeVoiceReadAloudAudioOutroEnabled")}function Gi(){return g("isRealtimeVoiceReadAloudVoiceVolumeCoherenceEnabled")}function Qi(){return f("IsGuideMeEnabledForRealtimeVoice",!1)}function ji(){return f("IsScreenUnderstandingEnabledForRealtimeVoice",!1)}function Yi(){return m("M365ChatCdnVersion","")}function zi(){return m("M365ChatDeploymentRing","")}function qi(){return m("M365ChatDeploymentEnvironment","")}function Vi(){return f("EnableM365EcsProvidedProps")}function Zi(){return f("UseM365ChatAppVersionEcsProject")}function Ji(){return g("EnableBizInAppChatScenarioName")}function Xi(){return g("EnableLocalFileMessageBanner")}function $i(){return g("EnableFileAccessMessageBanner")}function es(){return f("UseExtensibilityDialogDimensionsV2",!1)}function ts(){return g("SkipALTimerReset")}function ns(){return f("shouldShowNewSQNAZQM",!1)}function rs(){return g("EnableBizChatInAppAuthDialog")}function os(){return f("EnableBizchatInAppPerfMonitor")}function as(){return g("EnableM365ChatLogger")}function is(){return g("EnableBizchatNestedAppAuthSupport")}function ss(){return g("EnableM365ChatEligibilityCheck")}function cs(){return g("EnableM365ChatEligibilityCache")}function ls(){return f("EnableSQNAZQMWhenNotInCC",!0)}function us(){return g("EnableBizchatHostContext")}function ds(){return f("FallbackHandoffsToAppChat",!1)}function _s(){return g("ShouldDefaultToBizChat")}function ps(){return g("EnableNullCheckBizChatHostContext")}function gs(){return g("EnableNullCheckChatExperience")}function fs(){return g("EnableBizChatOcpsPolicyFetching")}function hs(){return g("EnableBizChatFeedbackCompliancePolicyFetching")}function Cs(){return g("EnableBizChatDefaultFeedbackAppId")}function ms(){return g("EnableFeedbackDataIntegrationFromSdxToBizChat")}function vs(){return g("EnableBizChatInteractiveApiOnTtfr")}function Es(){return f("EnableBizChatInAppSettings",!1)}function ys(){return g("EnableKeepAliveForALSession")}function bs(){return C("KeepAliveForALSessionIntervalInSecond",60)}function Ts(){return g("EnableWaitForM365ChatEcsSettings")}function Is(){return C("M365ChatEcsSettingTimeout",2e3)}function Ps(){return g("EnableIsEuCheck")}function As(){return m("HrdServiceProviderId","174")}function Ds(){return g("EnableBizChatInAppAuthDialogV2")}function Ss(){return g("EnableBizChatOtelLogger")}function Ms(){return g("EnableBizChatIdsInOtelLog")}function Os(){return g("EnableBizChatPerfOtelLog")}function ks(){return g("EnableOcpsLogging")}function Ls(){return g("EnableEligibilityTelemetry")}function ws(){return f("ForceDfSydney")}function Rs(){return g("IsInsertImageEnabledForDesignerInCatalyst")}function Us(){return g("EnableBizChatAuthTelemetry")}function Bs(){return g("EnableBizChatInfiniteAuthShimmerFix")}function xs(){return g("EnableBizChatPuidCompliantCheck")}function Ws(){return g("EnableBizChatUpnFix")}function Fs(){return g("EnableFetchImplicitQueryAnnotations")}function Ns(){return f("isRingSwitcherEnabled",!1)}function Ks(){return g("EnableEcsSettingWaitOnExpiredCache")}function Hs(){return g("EnableBizChatInactiveLog")}function Gs(){return g("EnableM365ChatRehydration")}function Qs(){return f("EnableBizChatPairwiseBrokerSupport",!1)}function js(){return C("M365ChatPairwiseBrokerHandshakeTimeout",5e3)}function Ys(){return g("WordAccessibilityContrastColorThemeEnabled")}function zs(){return g("EnableBizchatEcsSettingsTelemetry")}function qs(){return g("EnableM365ChatWaitForBroker")}function Vs(){return g("EnableM365ChatTokenPrefetch")}function Zs(){return g("EnableM365ChatHandleAuthBackgroundVisibility")}function Js(){return g("EnableM365ChatHandleBackgroundVisibilityForRequests")}function Xs(){return C("M365ChatPairwiseBrokerConnectionTimeout",3e3)}function $s(){return g("EnableM365ChatTrustedDomainForPairwise")}function ec(){return g("EnableM365ChatReuseSameRedirectUriForNaa")}function tc(){return f("EnableBizChatNativePerfMark")}},740584:(e,t,n)=>{"use strict";n.d(t,{b:()=>a});var r=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},o=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},a=function(){function e(e,t,n,r){this.msalFor1PResources=e,this.msalFor3PResources=t,this.acquire3PTokenFallback=n,this.accountProvider=r,this.queue=[],this.interactionInProgress=!1}return e.prototype.enqueue=function(e,t,n){var r=this;return new Promise((function(o,a){r.queue.push({request:e,is1PResource:t,fallbackTo3PResource:n,resolve:o,reject:a}),r.processQueue()}))},e.prototype.createPopupRequest=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return[4,this.accountProvider.getAccount(t)];case 1:if(!(n=r.sent()))throw new Error("InteractiveTokenQueue : No account found for popup request");return[2,{scopes:["".concat(e.resource,"/.default")],account:n}]}}))}))},e.prototype.processQueue=function(){var e=this;if(!this.msalFor1PResources||!this.msalFor3PResources)throw new Error("InteractiveTokenQueue : MSAL instances not initialized.");if(!this.interactionInProgress&&0!==this.queue.length){this.interactionInProgress=!0;r(e,void 0,void 0,(function(){var e,t,n,r,a,i,s,c,l,u,d,_,p;return o(this,(function(o){switch(o.label){case 0:if(!(this.queue.length>0))return[3,12];e=this.queue.shift(),t=e.request,n=e.is1PResource,r=e.fallbackTo3PResource,a=e.resolve,i=e.reject,s=n?this.msalFor1PResources:this.msalFor3PResources,o.label=1;case 1:return o.trys.push([1,4,,11]),[4,this.createPopupRequest(t,s)];case 2:return c=o.sent(),[4,s.acquireTokenPopup(c)];case 3:return l=o.sent(),a({authToken:l.accessToken}),[3,11];case 4:if(u=o.sent(),!r||!n)return[3,9];o.label=5;case 5:return o.trys.push([5,7,,8]),[4,this.acquire3PTokenFallback(t)];case 6:return d=o.sent(),a({authToken:null!==(p=d.authToken)&&void 0!==p?p:""}),[3,8];case 7:return _=o.sent(),i(_),[3,8];case 8:return[3,10];case 9:i(u),o.label=10;case 10:return[3,11];case 11:return[3,0];case 12:return this.interactionInProgress=!1,[2]}}))}))}},e}()},742080:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(529404),o=n(260623),a={entityPickerChildGap:{rowGap:"12px"},elementGap:{rowGap:"9px"},entityCardContainer:{paddingBottom:"10px",paddingRight:"6px",borderBottom:"1px solid ".concat(r.L.colorNeutralStroke3),":last-child":{borderBottom:"none"}},entityCard:{columnGap:"12px",alignItems:"flex-start"},entityLink:{width:"fit-content",":hover":{textDecoration:"none !important"}},entityIconContainer:{minHeight:"32px",minWidth:"32px",borderRadius:"8px",backgroundColor:r.L.colorNeutralStrokeAlpha,display:"flex",justifyContent:"center",alignItems:"center",marginTop:"2px"},entityIconImg:{width:"20px",height:"20px"},entityTextContainer:{display:"flex",flexDirection:"column",flexGrow:1},entityText:{color:r.L.colorNeutralForeground1,":hover":{color:r.L.colorBrandForegroundLink},display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitBoxOrient:"vertical",WebkitLineClamp:"1",wordBreak:"break-word"},entitySubText:{width:"fit-content",color:r.L.colorNeutralForeground2,display:"-webkit-box",overflow:"hidden",textOverflow:"ellipsis",WebkitBoxOrient:"vertical",WebkitLineClamp:"1",wordBreak:"break-word"},entitySparkleIconContainer:{padding:0,minHeight:"32px",minWidth:"32px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",borderRadius:"4px",border:"1px solid transparent",backgroundColor:"transparent",color:r.L.colorNeutralForeground1,":hover":{backgroundColor:r.L.colorNeutralBackground1Hover,border:"1px solid ".concat(r.L.colorNeutralStroke1Hover),borderRadius:"6px",color:r.L.colorNeutralForeground1}},entitySparkleIconContainerSelected:{backgroundColor:r.L.colorNeutralBackground1Hover},suggestedPromptsPopover:{borderRadius:"8px",padding:"4px",backgroundColor:r.L.colorNeutralBackground1,boxShadow:r.L.shadow16,width:"175px"},suggestedPromptsContainer:{borderRadius:"4px",padding:"8px",rowGap:"7px"},suggestedPromptsTitle:{overflow:"hidden",color:r.L.colorNeutralForeground2,textOverflow:"ellipsis"},suggestedPromptMenuList:{rowGap:"7px"},suggestedPromptMenuItem:{margin:"0px",borderRadius:"8px",border:"1px solid ".concat(r.L.colorNeutralStroke2),display:"flex",height:"32px",padding:"0px 12px",alignItems:"center",width:"fit-content",cursor:"pointer",":hover":{border:"1px solid ".concat(r.L.colorNeutralStroke2),backgroundColor:"transparent"}},suggestedPrompt:{color:r.L.colorNeutralForeground2}},i=(0,o.n)(a)},746592:(e,t,n)=>{"use strict";n(208520),n(794329),n(644022);var r=n(475119);try{var o=n(956775);o.MsgExtDialogContainer}catch(e){try{var a=n(5489);a.MsgExtDialogContainer}catch(e){(0,r.cY)("Neither @1js/officeaicopilot-chat-core nor @1js/officeaicopilot-chat could be loaded")}}},747222:(e,t,n)=>{"use strict";n.d(t,{U:()=>u});var r=n(743032),o=n(811912),a=n(791165),i=n(990813),s=n(379490),c=n(740389),l=n(242154),u=function(){function e(){(0,o._)(this,e),(0,i._)(this,"algorithmName","RSA-OAEP"),(0,i._)(this,"awsAnthropicKeys",void 0),(0,i._)(this,"anthropicKey",void 0),this.awsAnthropicKeys=[],this.anthropicKey=""}return(0,a._)(e,[{key:"init",value:function(){var e=this;return(0,r._)((function(){return(0,s.__generator)(this,(function(t){switch(t.label){case 0:return[4,e.calcAwsAnthropicKeys()];case 1:return e.awsAnthropicKeys=t.sent(),[4,e.calcAnthropicKey()];case 2:return e.anthropicKey=t.sent(),[2]}}))}))()}},{key:"getAwsAnthropicKeys",value:function(){return(0,c.u5T)()?this.awsAnthropicKeys:[]}},{key:"getAnthropicKey",value:function(){return(0,c.u5T)()?"":this.anthropicKey}},{key:"hexStringToArrayBuffer",value:function(e){if((e=e.replace(/[^a-fA-F0-9]/g,"")).length%2!=0)throw new Error("Invalid hex string");for(var t=new ArrayBuffer(e.length/2),n=new Uint8Array(t),r=0;r<e.length;r+=2){var o=e.substring(r,r+2);n[r/2]=parseInt(o,16)}return t}},{key:"decryptData",value:function(e,t){var n=this;return(0,r._)((function(){var r;return(0,s.__generator)(this,(function(o){switch(o.label){case 0:return[4,window.crypto.subtle.decrypt({name:n.algorithmName},e,t)];case 1:return r=o.sent(),[2,(new TextDecoder).decode(r)]}}))}))()}},{key:"decryptKeys",value:function(e,t){var n=this;return(0,r._)((function(){var r,o,a,i,u;return(0,s.__generator)(this,(function(s){switch(s.label){case 0:if(0===(r=(0,c.CyP)()).length)return[2,[]];r+="f5c98a0709893c84e2c6478da1b4b0a05c015dbef47721255d0905e421ef836a9516b3bdb81171ef596b3920b9193f4a3e94c30b020301000102818021920186cd1efd522ba20d0cd6bcabff78769bc07fb8b0eb2daca4ca14317035af68c3981474a370d3be51af692c111bafb76d1d08b265550a9ff104c6fd2087c5a2184b2f4b7a3438ea4bd884a457b2436fab8efd384b088bc1e33d6817af08a112ef4cd3eb66b984183a2d6cb8f32c1f368ecd8bf8de40daa5783e6e004491024100f31181cf957fae6312dd443e6d8be4ceb296de33a4983c90fbd80fea6af6ba100e37ce3591562b82530338505290e5d3fd0a3f13a4711264f9c12938a57babf3024100dda50c399ebf308aecf04df55f920fca7c5522764810dd2ed819767cb4ccdabd5a3f37843dcdf8292c59544f6a997651d351c120b5be0fcdb94365a18568ca8902401d09695d77f981c69a194eaeba7d6cbef87ca75cb9fbe9b8542d9271298801e02b22a582a6b3098d8f0722720dfafb49a0bfd99b2a18cbdebe2b42165f466fdb0240379ddbc475a62a0b224b667484e7c4d89d7c4b6a7cc8e68783a8580810e23a9d3b1113e0361602086add7b7f76134e1258417281bfb912841fd1dea5ba31426902404a52f02643b685ff70b176f6ed340d3f7107bf1bf63b3588a57da21e44b5cee7143a5a9316eb1f3437abc844e54b7ab96326042a79de7f650614405145daadf8",s.label=1;case 1:return s.trys.push([1,5,,6]),[4,window.crypto.subtle.importKey("pkcs8",n.hexStringToArrayBuffer(r),{name:n.algorithmName,hash:"SHA-256"},!0,["decrypt"])];case 2:return o=s.sent(),[4,n.decryptData(o,n.hexStringToArrayBuffer(e))];case 3:return a=s.sent(),[4,n.decryptData(o,n.hexStringToArrayBuffer(t))];case 4:return i=s.sent(),[2,[a.toString(),i.toString()]];case 5:return u=s.sent(),(0,l.cY)("MCP: Error getting Anthropic keys - ",u),[2,[]];case 6:return[2]}}))}))()}},{key:"calcAwsAnthropicKeys",value:function(){var e=this;return(0,r._)((function(){return(0,s.__generator)(this,(function(t){return(0,l.cY)("MCP: Compute AWS Anthropic keys"),[2,e.decryptKeys("4242967b086c40eba39e223560222a30b6e4282b6dad995c44a3fa96d37b99586304ee46ff95fb1b90c0b62217fcc6997ae6bb9f3c2abfe4b940ce3e240248ec7cb7023174e0e2af88ddc2b88c6ac6db17a22d9782186e47c862d78f880e4b83681665e618546faa4ce7b6c2b1eb1143513fb3e895acd02e48f6e900a6f781df","5941633fc38f8ea62958706f2c1143af60f6a54e7945b8dee7e61bad71bf67707aa0b4ab9ca3edefad8b945488d9ba61853d0b16f9d0bc5d4981b507b48446cb481b7c0f48a98663fe3dd49cdf3adddcdc7efde29a0e693a3b25ba9100551741baa849915bf4f9f2251b1f478bd5842756201c647c1d94048f622abbbc3680ad")]}))}))()}},{key:"calcAnthropicKey",value:function(){var e=this;return(0,r._)((function(){var t;return(0,s.__generator)(this,(function(n){switch(n.label){case 0:return(0,l.cY)("MCP: Compute Anthropic key"),[4,e.decryptKeys("01725e534f0ba5169a126d8f44718b88690996d9b3bfba6f956e6c0d3f7d55f576485bd3d7e0b19643fc97c34d51e7684b4bd4b26db7088ce5dc0671d37a89c317828213a7a5bf94a67d638b879548ee72f3ef444a61c8344da8100bea48915e11b93f2bea31ea950a99f4a3390bdd5d64a27f75eec84fe3b21ccf96725c6bc0","1d06c4b96816a60143bf9776c2f7fa3fc5a92197f07e6ce0ecf433e6a0011f65298c4386b993350c34c2c2ba6399418cb7742b8b0bfa610cd70d2c2f197eeab639c7017405d3468ac159f89214e5052c40b24a89e138124a59ac53839f580402c3873642722f7cc0e0e4c63f2c621ffa8ed2ac798764e2ce25757465936ae6b8")];case 1:return 2!==(t=n.sent()).length?[2,""]:[2,t[0]+t[1]]}}))}))()}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,i._)(u,"instance",void 0)},754208:(e,t,n)=>{"use strict";n.d(t,{t:()=>_});var r=n(743032),o=n(379490),a=n(758651);function i(e,t){return s.apply(this,arguments)}function s(){return s=(0,r._)((function(e,t){return(0,o.__generator)(this,(function(n){switch(n.label){case 0:return[4,Word.run((i=(0,r._)((function(n){var r;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return(r=n.document.body.paragraphs).load("items"),[4,n.sync()];case 1:return o.sent(),t>=0&&t<r.items.length?(r.items[t].getRange().insertComment(e),[4,n.sync()]):[3,3];case 2:return o.sent(),a.log("Comment added to paragraph ".concat(t+1,": ").concat(e)),[3,4];case 3:a.error("Invalid paragraph index."),o.label=4;case 4:return[2]}}))})),function(e){return i.apply(this,arguments)}))];case 1:return n.sent(),[2]}var i}))})),s.apply(this,arguments)}var c=n(740389),l=n(871598),u=n(208520),d=n(193614);function _(){var e=(0,c.beW)("enableSuggestedCommentsForDA",""),t=e&&e.length>0,n=(0,u.useCallback)((function(e){0===e.contentReference.paragraphIndex?i(e.text,0):i(e.text,e.contentReference.paragraphIndex-1)}),[]);return(0,d.a)({isFeatureEnabled:t,annotationClass:l.H,commentHandler:n,declarativeAgentId:e})}},755657:(e,t,n)=>{"use strict";n.d(t,{Uk:()=>y,aW:()=>m,ro:()=>v});var r=n(822606),o=n(881707),a=n(243912),i=n(555799),s=n(644275),c=n(83437),l=n(660606),u=n(423905),d=n(241273),_=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},p=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},g=!1,f=function(){return g},h=function(e){(0,l.cY)("setting ClpOfficeJSApiError to ".concat(e)),g=e},C=!1;function m(){return _(this,void 0,void 0,(function(){var e,t;return p(this,(function(n){switch(n.label){case 0:return!l.t6.IsClpEnabledInEnterpriseForSydney()||(null===(t=l.t6.IsCopilotInBackstageMode)||void 0===t?void 0:t.call(l.t6))?[3,3]:(C=!0,[4,o.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]);case 1:return e=n.sent(),[4,o.n.getInstance().getHighestDocumentSensitivityInfo([o.n.getInstance().getInDocSensitiveLabelInfo(),e])];case 2:if(n.sent(),f())return h(!1),C=!1,[2,!1];n.label=3;case 3:return C=!1,[2,!0]}}))}))}var v="2147205115";function E(e,t){var n,r={chatEventType:c.a5.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:c.T_.Client,ashaErrorDetails:{vetoName:(0,u.CI)(c.kD.UnclearIntent,c.G8.UserInputIssue),errorString:c.av.SensitivityExecutionFailed,featureName:c.CC.CopilotChat}};null===(n=null==e?void 0:e.current)||void 0===n||n.addResponseMessage(function(e,t,n,r,c){void 0===c&&(c=!0);var d={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:a.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:r?(0,u.YI)(r):void 0},_=!0,p=o.n.getInstance();(null==p?void 0:p.getShouldStopLoadingUi)&&(_=p.getShouldStopLoadingUi());var g={chatCardType:i._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:d,stopLoadingUi:_,startAugloopTimerForStreaming:!1,addCardToChatHistory:c};return(0,u.IT)(t,n,!0),(0,l.cY)("CLP error response message: ".concat(g)),g}(t,!0,r))}function y(e,t,n,a){var i,s,_;if(null===(_=null==e?void 0:e.current)||void 0===_?void 0:_.getIsExecuting()){var p=function(e,t){switch(e){case d.YY.ApplyLabelUnsupportedCrossTenantErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.Sh)();case d.YY.ApplyLabelDocumentReadOnlyErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.w3)();case d.YY.ApplyLabelInsufficientPermissionErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.bX)();case d.YY.ApplyLabelLabelDisabledErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.pS)();case d.YY.ApplyLabelUnsupportedUdpErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.hf)();case d.YY.ApplyLabelLabelingDisabledErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.f4)();case d.YY.ApplyLabelUnsupportedContentTypeErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.TZ)();case d.YY.ApplyLabelUnsupportedDkeErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.O1)();case d.YY.ApplyLabelLabelNotFoundErrorCode:case d.YY.ErrorCode2147647531:return t===d.OZ.CLP_Get?r.u1:(0,r.aE)();case d.YY.OsfControlContainerErrorCode:case d.YY.OfficeSolutionFrameworkHostErrorCode:case d.YY.DocCookieErrorCode:case d.YY.HostIntegrationManagerErrorCode:case d.YY.MsoOLDocumentErrorCode:case d.YY.ClpSessionErrorCode:return(0,r.VQ)();case d.YY.OMWorkflowUserNotFoundErrorCode:return(0,r.W2)();case d.YY.OMOfficePerpetualNotSupportedErrorCode:return(0,r.MH)();case d.YY.LabelingDisabledProtectedViewErrorCode:return(0,r.s_)();case d.YY.LabelingDisabledAppguardErrorCode:return(0,r.Ng)();case d.YY.LabelingDisabledPrivacySettingsErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.KA)();case d.YY.LabelingDisabledUnsupportedLabelClientErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.H9)();case d.YY.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.oM)();case d.YY.OMOfficeClientNotLicensedForLabelingErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.kB)();case d.YY.PolicyManagerUnavailableErrorCode:return t===d.OZ.CLP_Get?r.u1:(0,r.VQ)();case d.YY.ApplyLabelNewLabelSensitivityOrderErrorCode:return r.u1;case d.YY.ErrorCode2147500033:default:return t===d.OZ.CLP_Get?r.u1:(0,r.VQ)()}}(t,n);if(p){C&&h(!0),(0,l.cY)("clp error: ".concat(p)),E(e,p);var g=!0,f=o.n.getInstance();(null==f?void 0:f.getShouldStopLoadingUi)&&(g=f.getShouldStopLoadingUi()),a&&g&&a(),l.EG.sendChatEventTelemetry((0,u.pN)(((i={})[c.h3.ChatEventType]=c.a5.CLPErrorShown,i[c.h3.ChatEventParameters]=n+"_"+t,i)))}else(0,l.cY)("clp error string is empty"),l.EG.sendChatEventTelemetry((0,u.pN)(((s={})[c.h3.ChatEventType]=c.a5.CLPErrorIgnored,s[c.h3.ChatEventParameters]=n+"_"+t,s)));return p}return r.u1}},757917:()=>{},758303:(e,t,n)=>{"use strict";n.d(t,{D:()=>r.D});n(828801);var r=n(344196)},764081:(e,t,n)=>{"use strict";n.d(t,{$H:()=>d,Nz:()=>s,OY:()=>i,Qt:()=>o,ag:()=>c,fH:()=>_,oY:()=>r,pL:()=>p,qj:()=>u,t9:()=>a,yT:()=>l});var r="TaskViewMode",o=80,a=55,i=50,s=70,c=50,l=35,u=70,d=50,_=35,p="c0ab8ce9-e9a0-42e7-b064-33d422df41f1"},767370:(e,t,n)=>{"use strict";var r=n(475119),o=n(507503),a=n(740584),i=n(404516),s=n(51020),c=n(854546),l=n(396578),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};!function(){function e(e,t){this.initialized=!1,this.msalManager=new i.P(e),this.tokenRequestCache=new s.P,this.accountProvider=new o.$(e,t)}e.prototype.ensureInitialized=function(){return u(this,void 0,void 0,(function(){return d(this,(function(e){switch(e.label){case 0:return this.initialized?[2]:[4,this.msalManager.initialize()];case 1:return e.sent(),[4,this.msalManager.initializeMsalInstances()];case 2:return e.sent(),this.interactiveTokenQueue=new a.b(this.msalManager.getMsalFor1PResources(),this.msalManager.getMsalFor3PResources(),this.acquire3PToken.bind(this),this.accountProvider),this.tokenAcquisitionFactory=new c.L(this.msalManager.getMsalFor1PResources(),this.msalManager.getMsalFor3PResources(),this.accountProvider,this.interactiveTokenQueue,this.msalManager.getMsalModule()),this.initialized=!0,[2]}}))}))},e.prototype.acquire1PToken=function(e,t){return u(this,void 0,void 0,(function(){return d(this,(function(n){if(!this.tokenAcquisitionFactory)throw new Error("Token acquisition factory not initialized");return[2,this.tokenAcquisitionFactory.acquire1PToken(e,t)]}))}))},e.prototype.acquire3PToken=function(e){return u(this,void 0,void 0,(function(){return d(this,(function(t){if(!this.tokenAcquisitionFactory)throw new Error("Token acquisition factory not initialized");return[2,this.tokenAcquisitionFactory.acquire3PToken(e)]}))}))},e.prototype.getTokenInternal=function(e){var t=(0,l.p)(e),n=t.is1PResource,r=t.fallbackTo3PResource;return n?this.acquire1PToken(e,r):this.acquire3PToken(e)},e.prototype.getToken=function(e){return u(this,void 0,void 0,(function(){var t,n,o;return d(this,(function(a){switch(a.label){case 0:return[4,this.ensureInitialized()];case 1:a.sent(),(t=this.tokenRequestCache.get(e))||(t=this.getTokenInternal(e),this.tokenRequestCache.set(e,t)),a.label=2;case 2:return a.trys.push([2,4,5,6]),[4,t];case 3:return[2,a.sent()];case 4:throw n=a.sent(),(o=this.msalManager.getMsalModule())&&n instanceof o.AuthError&&(0,r.cY)("DialogTokenService : AuthError encountered: ".concat(n.message)),n;case 5:return this.tokenRequestCache.delete(e),[7];case 6:return[2]}}))}))}}()},768553:(e,t,n)=>{"use strict";n.d(t,{D:()=>I});var r,o,a,i=n(560855),s=n(426208),c=n(990945),l=n(784567),u=n(61714),d=n(660606),_=n(822606),p=n(330743),g=n(265167),f=n(423905),h=n(638753),C=n(207545),m=n(83437),v=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},E=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},y=function(){var e=_.u1,t=n(956775);if(void 0!==(null==t?void 0:t.userQueryGuid))return e=t.userQueryGuid;var r=n(5489);return void 0!==(null==r?void 0:r.userQueryGuid)?e=r.userQueryGuid:e},b={semanticTree:"",contentTree:"",topicTree:""},T="";function I(e,t){return v(this,void 0,void 0,(function(){var n,r,s,c;return E(this,(function(p){switch(p.label){case 0:return p.trys.push([0,2,,3]),[4,P(t)];case 1:return p.sent(),T=y()===_.u1?(0,u.A)():y(),e?(n={correlationId:T,scenario:"ChatPane",sourceUrls:[e],returnSerializedJsonTree:!0,enableImageToText:!0,requestTopicTree:!0,requestSemanticTree:!0,requestContentTree:!0},r=new l.Xr({parentPath:["Signal",i.I.getTypeName()],items:[{id:g.r.generateId(),body:new i.I(n)}]}),(0,d.cY)("Submitting content intelligence platform evaluation signal"),a=(new Date).getTime(),o.submitOperation(r),d.EG.sendChatEventTelemetry((0,f.pN)(((c={})[m.h3.ChatEventType]=m.a5.ContentIntelligencePlatformEvaluationSignalSubmitted,c[m.h3.ChatEventParameters]=i.I.getTypeName(),c))),[3,3]):((0,d.cY)("Failed to retrieve document URL"),[2]);case 2:return s=p.sent(),(0,d.cY)("Error submitting content intelligence platform evaluation signal: ",s),[3,3];case 3:return[2]}}))}))}function P(e){return v(this,void 0,void 0,(function(){var t,n;return E(this,(function(i){switch(i.label){case 0:return(0,d.cY)("Activating Content Intelligence Platform Evaluation Annotation"),t=C.kH.getSettingAsString(C.zj.AugloopSharedSessionID),[4,(o=(0,p.wB)((0,h.hX)(t)?"ALDummySession":t)).activateAnnotation(s.g.getTypeName(),{callback:function(t){return function(e,t){return v(this,void 0,void 0,(function(){var n,r,o,i;return E(this,(function(l){try{for((0,d.cY)("Processing content intelligence platform annotation"),n=0,r=e.items;n<r.length;n++){if(!(null==(o=r[n])?void 0:o.body))return(0,d.cY)("Augloop annotation item missing body"),[2];if(s.g.typeGuard(o.body)&&d.EG.updateTelemetryOnAnnotationReceived(s.g.getTypeName(),void 0,m.CT.CIPEvaluationResponseTime,_.u1,void 0,a),(i=o.body).correlationId!==T)return(0,d.cY)("Correlations Id of response is not the same as in request"),[2];switch(i.treeType){case c.P.CipTree:b.semanticTree=JSON.stringify(i.semanticTree.json);break;case c.P.ContentTree:b.contentTree=JSON.stringify(i.semanticTree.json);break;case c.P.TopicTree:b.topicTree=JSON.stringify(i.semanticTree.json);break;default:(0,d.cY)("Unknown tree type from content intelligence platform evaluation workflow")}t(b)}}catch(e){(0,d.cY)("Error processing content intelligence platform evaluation annotation: ",e)}return[2]}))}))}(t,e)}})];case 1:return n=i.sent(),r=n.token,(0,d.cY)("Content Intelligence Platform Evaluation Annotation activated with token: "+r),[2]}}))}))}},769449:(e,t,n)=>{"use strict";n.d(t,{$1:()=>w,B3:()=>F,CI:()=>te,G4:()=>M,Gp:()=>q,M4:()=>H,Nx:()=>V,Ow:()=>R,P_:()=>Q,QH:()=>B,Rb:()=>G,TU:()=>k,Uv:()=>ee,W7:()=>$,WZ:()=>O,Ws:()=>U,YI:()=>Y,Zy:()=>J,eV:()=>L,iL:()=>re,io:()=>ne,lo:()=>K,mQ:()=>Z,oN:()=>X,pN:()=>x,ud:()=>W,wN:()=>z,wQ:()=>N,zq:()=>j});var r=n(990813),o=n(965801),a=n(314268),i=n(140889),s=n(583789),c=n(498483),l=n(8810),u=n(942449),d=n(63461),_=n(385659),p=n(932554),g=n(740389),f=n(934761),h=n(448397),C=n(407039),m=n(992950),v=n(86511),E=n(602061),y=(n(661218),n(249002)),b=(n(965974),n(871598)),T=n(242154),I=n(822446),P=n(862853),A=n(117658),D=n(267836),S=[d.kp.getTypeName(),c.i.getTypeName(),d.dF.getTypeName()];function M(e,t){var n,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,_=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,p=arguments.length>4&&void 0!==arguments[4]&&arguments[4],g=arguments.length>5&&void 0!==arguments[5]&&arguments[5],C=arguments.length>6&&void 0!==arguments[6]&&arguments[6],m=arguments.length>7?arguments[7]:void 0;if(f.P.getInstance().isValidAnnotationResponse(t)||S.includes(e)){var v,y,I;switch(t&&!S.includes(e)&&h.B.getInstance().setQueryGuid(t),e){case o.Sy.getTypeName():v=i.CT.AugloopResponseTime;break;case b.H.getTypeName():g?v=i.CT.CopilotODSLResponseTime:p&&(C?(v=i.CT.SummaryResponseTime,y=i.CT.SummaryChunkInfo):(v=i.CT.SydneyResponseTime,y=i.CT.SydneyChunkInfoJson));break;case a.XV.getTypeName():case u.Ob.getTypeName():y=i.CT.QnAChunkInfo,I=i.CC.ChatQnA;case a.R8.getTypeName():case u.KJ.getTypeName():v=i.CT.QnAResponseTime,I=i.CC.ChatQnA;break;case s.Jq.getTypeName():v=i.CT.ContentCreationResponseTime,y=i.CT.ContentCreationChunkInfoJson;break;case o.I.getTypeName():v=i.CT.ActionAIAcknowledgementResponseTime;break;case d.uC.getTypeName():I=i.CC.Handoff,v=i.CT.HandoffMessageResponseTime;break;case d.kp.getTypeName():I=i.CC.Handoff,v=i.CT.HandoffResponseTime;break;case c.i.getTypeName():v=i.CT.UserContextResponseTime;break;case A.H.getTypeName():v=i.CT.UserProfileResponseTime,I=i.CC.Customize}var P=(0,r._)({},i.CT.AnnotationType,e);(0,T.cY)("".concat(e," response.")),v&&(P[v]=(0,E.WUi)(null!=_?_:void 0),(0,T.cY)("".concat(e," response. Time Taken : ").concat((0,E.WUi)(null!=_?_:void 0)," sec \n"))),I&&(P[i.CT.FeatureName]=I,(0,T.cY)("".concat(I," feature response.\n"))),l&&(P[y]=l,(0,T.cY)("".concat(e," response. Stream chunks : ").concat(l,"\n"))),h.B.getInstance().sendLatencyTelemetry(x(P))}var D=(n={},(0,r._)(n,i.h3.ChatEventType,i.a5.ResponseReceivedFromAL),(0,r._)(n,i.h3.ChatEventParameters,e),(0,r._)(n,i.h3.Cv,null!=m?m:""),n);t&&(D[i.h3.UserQueryGuid]=t),h.B.getInstance().sendChatEventTelemetry(x(D))}function O(e){h.B.getInstance().sendLatencyTelemetry(x((0,r._)({},i.CT.RequestSignalType,e))),(0,T.cY)("".concat(e," sent to AL"))}function k(e){h.B.getInstance().sendLatencyTelemetry(x((0,r._)({},i.CT.StartCopilotOperationTime,(0,E.WUi)(e))))}var L=function(e){var t=parseFloat((0,y.gZ)(e));h.B.getInstance().sendLatencyTelemetry([{key:i.CT.FeatureName,value:i.CC.Preload_ChatPaneLoad},{key:i.CT.WordUserCopilotPaneLoadTime,value:(0,E.WUi)(t)}],!0),h.B.getInstance().recordCheckPoint(i._R.CopilotPaneStart,t)};function w(e){h.B.getInstance().sendLatencyTelemetry(x((0,r._)({},i.CT.QueryExecutionTime,e)))}function R(e){h.B.getInstance().sendLatencyTelemetry(x((0,r._)({},i.CT.UserPerceivedLatency,(0,E.WUi)(e)))),(0,T.cY)("User Perceived Latency for streaming scenarios:  ".concat((0,E.WUi)(e)," sec"))}function U(){h.B.getInstance().sendChatEventTelemetry([{key:i.h3.ChatEventType,value:i.a5.ProactivePaneOpeningTriggered}]),h.B.getInstance().logSeenEvent(v.rf.QAandSummaries,i.CC.Summary,v.RX.Summarize,i.nk.ProactiveSummary)}function B(){h.B.getInstance().sendChatEventTelemetry([{key:i.h3.ChatEventType,value:i.a5.ProactivePaneOpeningTriggered}]),h.B.getInstance().logTriedEvent(v.rf.ContentGeneration,i.CC.Podcast,v.RX.Create,i.nk.PodcastGeneration)}var x=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))},W=function(e){var t=p.Vv.getSetting(p.zj.CopilotPaneStartTimestamp),n=[{key:i.CT.SDXResourcesLoadTime,value:(0,E.WUi)(I.taskPaneStartTime)},{key:i.CT.FeatureName,value:i.CC.ChatPaneLoad},{key:i.CT.RequestSignalType,value:"SDX_Resources_Load_Time"}];I.preloadCopilotTime||n.push({key:i.CT.WordUserCopilotPaneLoadTime,value:(0,E.WUi)(t)}),e.sendLatencyTelemetry(n,!0);var o,a,s,c=JSON.stringify({isDeclarativeAgentsEnabled:(0,D.wj)(E.Sqe.IsCustomGPTsEnabled),enableSwitcherMenuV2:(0,g.o25)(),enableAgentsBasedOnSkill:(0,g.VDk)(),loadGptListOnCopilotIconClick:(0,g.AFi)(),showAgentMenuNudgeAndTooltip:(0,D.wj)(E.Sqe.ShowAgentMenuNudgeAndTooltip),showAgentMenuExploreBadge:(0,D.wj)(E.Sqe.ShowAgentMenuExploreBadge)});(0,T.cY)("Sending extensibility config telemetry for chat pane load ".concat(c)),e.sendChatEventTelemetry(x((o={},(0,r._)(o,i.h3.ChatEventType,i.a5.ExtensibilityConfig),(0,r._)(o,i.h3.ChatEventParameters,c),o))),e.recordCheckPoint(i._R.ChatPaneLoaded),e.sendChatEventTelemetry(x((a={},(0,r._)(a,i.h3.ChatEventType,i.a5.ExperimentFlights),(0,r._)(a,i.h3.ChatEventParameters,(0,g.xyK)()),a))),e.sendChatEventTelemetry(x((s={},(0,r._)(s,i.h3.ChatEventType,E.rsb.ConnectionHealth),(0,r._)(s,i.h3.ChatEventParameters,JSON.stringify((0,E.pMy)())),s)))},F=function(e){var t;h.B.getInstance().sendChatEventTelemetry(x((t={},(0,r._)(t,i.h3.ChatEventType,i.a5.CshCopilotLinkClicked),(0,r._)(t,i.h3.ChatEventParameters,e),t)))},N=function(e){var t;h.B.getInstance().sendChatEventTelemetry(x((t={},(0,r._)(t,i.h3.ChatEventType,i.a5.CshCopilotLinkUnknownPromptId),(0,r._)(t,i.h3.ChatEventParameters,e),t)))},K=function(e){z(e,i.a5.CitationClicked)},H=function(e){var t;h.B.getInstance().sendChatEventTelemetry(x((t={},(0,r._)(t,i.h3.ChatEventType,i.a5.CitationReceived),(0,r._)(t,i.h3.ChatEventParameters,e.toString()),t)))},G=function(e){var t,n;switch(e.handoffOperation){case _.Q.GET:t=i.a5.HandoffMessageIdGetOperationSubmitted,n=i._R.HandoffMessageIdSent;break;case _.Q.PROCESSED:t=i.a5.HandoffMessageIdProcessedOperationSubmitted,n=i._R.HandoffMessageIdProcessed}t&&h.B.getInstance().sendChatEventTelemetry(x((0,r._)({},i.h3.ChatEventType,t))),n&&h.B.getInstance().recordCheckPoint(n)},Q=function(e,t){var n,o;(0,g.ebC)()&&!e.query?(n=i.a5.HandoffComplete,o=i._R.HandoffComplete):e.manualSendPrompt?(n=i.a5.HandoffQueryPerceivedByUser,o=i._R.HandoffQueryPerceivedByUser,e.query&&h.B.getInstance().setInitialHandoffQuery(e.query)):(n=i.a5.HandoffQueryAutoSubmitted,o=i._R.HandoffQueryAutoSubmitted),h.B.getInstance().sendLatencyTelemetry(x((0,r._)({},i.CT.UserPerceivedLatency,(0,E.WUi)(t))));var a,s={};if(e.sourceApp&&(s[i.CD.SourceApp]=e.sourceApp),e.context)try{var c=JSON.parse(e.context);c.promptType&&(s[i.CD.PromptType]=c.promptType),c.featureName&&(s[i.CD.FeatureName]=c.featureName)}catch(e){(0,T.cY)("Could not parse context to JSON from handoff message.")}e.scenarioName&&(s[i.CD.ScenarioName]=e.scenarioName),(0,T.cY)("Handoff query perceived by user: ",s),h.B.getInstance().sendChatEventTelemetry(x((a={},(0,r._)(a,i.h3.ChatEventType,n),(0,r._)(a,i.h3.ChatEventParameters,JSON.stringify(s)),a))),e.handoffStartTime&&h.B.getInstance().recordCheckPoint(i._R.HandoffStart,e.handoffStartTime),h.B.getInstance().recordCheckPoint(o),h.B.getInstance().sendLatencyTelemetryForCheckPoints(!0)},j=function(e){var t={};try{t=JSON.parse(e)}catch(e){(0,T.cY)("Error parsing telemetry data ",e.message)}return t},Y=function(e){return e||(e=i.CC.CopilotChat),JSON.stringify({featureName:e})},z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=h.B.getInstance();if(e){var a=j(e),s=a.correlationId,c=a.featureName;if((0,T.cY)("Correlation Id is : ".concat(s," and feature Name is : ").concat(c)),s&&o.setQueryGuid(s),n){var l=(0,y.RH)(c);o.logKeptEvent(c,l.subFeature,l.verb,l.capability)}}o.sendChatEventTelemetry(x((0,r._)({},i.h3.ChatEventType,t))),e&&o.setQueryGuid("")},q=function(e,t,n){var o,a,s=h.B.getInstance();if(e){var c,l=j(e),u=l.correlationId,d=l.featureName,_=l.subFeatureName,p=l.copilotAgentId;(0,T.cY)("Correlation Id is : ".concat(u," and feature Name is : ").concat(d)),u&&s.setQueryGuid(u);var g,f=(0,y.RH)(d);s.logFeedbackEvent(t===i.a5.ThumbsUpButtonClicked,f.capability,d,f.verb,null!=_?_:f.subFeature,n),o={groundingSource:null!==(g=null==n||null===(c=n.find((function(e){return"groundingSource"===e.key})))||void 0===c?void 0:c.value)&&void 0!==g?g:"CurrentContext",queryId:u,feedbackArea:d,copilotAgentId:p&&""!==p?p:void 0}}s.sendChatEventTelemetry(x((a={},(0,r._)(a,i.h3.ChatEventType,t),(0,r._)(a,i.h3.ChatEventParameters,o?JSON.stringify(o):"{}"),a))),e&&s.setQueryGuid("")},V=function(e,t){var n;(0,g.ak4)()&&h.B.getInstance().sendLatencyTelemetry(x((n={},(0,r._)(n,i.CT.UserPerceivedLatency,(0,E.WUi)(e)),(0,r._)(n,i.CT.IsQuerySuccess,t),n)))},Z=function(e){var t;h.B.getInstance().sendErrorTelemetry(x((t={},(0,r._)(t,i.IC.ErrorMessage,"".concat(e)),(0,r._)(t,i.IC.ErrorCategory,l.S.CLP),t)))},J=function(e){var t;h.B.getInstance().sendChatEventTelemetry(x((t={},(0,r._)(t,i.h3.ChatEventType,i.a5.OfficeJsApiCallForCLP),(0,r._)(t,i.h3.ChatEventParameters,"CLP_OfficeJsApi : ".concat(e)),t)))},X=function(){(0,P.II)()&&((0,T.cY)("Disabled enterprise search after hitting CLP exception"),h.B.getInstance().sendChatEventTelemetry(x((0,r._)({},i.h3.ChatEventType,i.a5.EnterpriseGroundingDisabled))))};function $(e){h.B.getInstance().logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function ee(e,t){var n=C.s.getInstance().getSkillName(),r=i.CC.CopilotChat,o=i.eJ.UnclearIntent;switch(n){case m.B.Summary:r=i.CC.Summary,o=i.eJ.Summarize;break;case m.B.BasicChat:case m.B.TableChat:case m.B.SelfHelp:case m.B.Sydney:r=i.CC.ChatQnA,o=i.eJ.ChatQnA;break;case m.B.Commanding:r=i.CC.Commanding,o=i.eJ.Command;break;case m.B.ContentCreation:r=i.CC.AddContent,o=i.eJ.AddContent;break;case m.B.Designer:r=i.CC.DesignerVisuals,o=i.eJ.DesignerVisuals;break;case m.B.SearchDocument:r=i.CC.DocumentQnA,o=i.eJ.ChatQnA}return{vetoName:te(o,e),errorString:t,featureName:r}}function te(e,t){return e+" "+t}var ne=function(e){var t;h.B.getInstance().sendErrorTelemetry(x((t={},(0,r._)(t,i.IC.ErrorMessage,"".concat(e)),(0,r._)(t,i.IC.ErrorCategory,l.S.Feedback),t)))},re=function(e){var t;h.B.getInstance().sendErrorTelemetry(x((t={},(0,r._)(t,i.IC.ErrorMessage,"".concat(e)),(0,r._)(t,i.IC.ErrorCategory,l.S.ImageChat),t)))}},771181:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var r=n(208520),o=function(){return r.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M13.6696 3.98972C13.469 3.39807 12.9137 3 12.2889 3L11.3884 3C10.6873 3 10.0855 3.49905 9.95572 4.18803L9.02441 9.13282L9.48743 7.54883C9.66914 6.92722 10.2391 6.5 10.8867 6.5L13.7655 6.5L15.01 8.12858L16.118 6.5L15.5658 6.5C14.9411 6.5 14.3858 6.10193 14.1852 5.51027L13.6696 3.98972Z",fill:"url(#paint0_radial_1429_128522)"}),r.createElement("path",{d:"M6.50309 16.0036C6.70167 16.5987 7.25866 17 7.88598 17H9.35221C10.148 17 10.7967 16.3619 10.8099 15.5662L10.883 11.1348L10.4977 12.4516C10.3158 13.073 9.74595 13.5 9.09849 13.5L6.20857 13.5L4.97822 12.4147L4.07031 13.5H4.61719C5.24451 13.5 5.80149 13.9013 6.00008 14.4964L6.50309 16.0036Z",fill:"url(#paint1_radial_1429_128522)"}),r.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint2_linear_1429_128522)"}),r.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint3_linear_1429_128522)"}),r.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint4_radial_1429_128522)"}),r.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint5_linear_1429_128522)"}),r.createElement("defs",null,r.createElement("radialGradient",{id:"paint0_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.0851 9.1729) rotate(-128.772) scale(6.41931 6.01261)"},r.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),r.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),r.createElement("stop",{offset:"1",stopColor:"#0736C4"})),r.createElement("radialGradient",{id:"paint1_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.30628 13.0661) rotate(51.1538) scale(5.67928 5.53958)"},r.createElement("stop",{stopColor:"#FFB657"}),r.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),r.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),r.createElement("linearGradient",{id:"paint2_linear_1429_128522",x1:"5.81844",y1:"4.2727",x2:"6.65052",y2:"13.8998",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),r.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),r.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),r.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),r.createElement("linearGradient",{id:"paint3_linear_1429_128522",x1:"6.54577",y1:"3",x2:"7.00014",y2:"13.5035",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#3DCBFF"}),r.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),r.createElement("radialGradient",{id:"paint4_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.299 5.46979) rotate(109.281) scale(13.9554 16.7229)"},r.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),r.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),r.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),r.createElement("linearGradient",{id:"paint5_linear_1429_128522",x1:"16.7598",y1:"5.85685",x2:"16.7539",y2:"8.71732",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),r.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))}},779418:(e,t,n)=>{"use strict";n.d(t,{m5:()=>o,xx:()=>a});var r=n(558976),o=function(e){var t="\n    let workflows = split('',',');\n    let audienceGroup = split('''',',');\n    let platforms = split('''',',');\n    WorkflowOperationEvent\n    | where operationName in (\"ActionAIExec\", \"FluxCopilot\")\n    | where TIMESTAMP > ago(1d)\n    | where resourceId in  (\"WordFluxCopilotApp\")\n    | where  workflows[0] == '' or resourceId in~ (workflows)\n    | where  audienceGroup[0] == '' or clientReleaseAudienceGroup in~ (audienceGroup)\n    | where platforms[0] == '' or clientAppPlatform in~(platforms)\n    | extend extraFields = parse_json(dataFields)\n    | extend errMsg = tostring(extraFields[\"errMsg\"]), isChatHistory = tobool(extraFields[\"isOnlyChatHistorySignal\"])\n    | where isChatHistory != true\n    | extend queryId = tostring(extraFields[\"queryId\"])\n    | where isnotempty(queryId)\n    | extend errorName = case (isnotempty(tostring(extraFields[\"errorName\"])),tostring(extraFields[\"errorName\"]),\n                            isnotempty( tostring(extraFields[\"skillErrorName\"])), tostring(extraFields[\"skillErrorName\"]),\"Unknown\")\n    | extend errMsg = strcat(errMsg, '::')\n    | parse errMsg with endReason ':' errCode ':' *\n    | extend errorCategory = case(\n        success == 1, 'Success',\n        errMsg == '::', 'Success',\n        endReason in ('InputQueryError', 'UnsupportedLanguageError', 'Text2ImageError', 'OffensiveContent'), 'User',\n        endReason in ('ActionAIError', 'LicensingError', 'ResolveDelegationsError', 'InferenceAPIError', 'unexpected', 'ODSLSyntaxError', 'ODSLParseError', 'TokenCountError'), 'System',\n        'Uncategorized'\n    )\n    | extend Category = case(errorCategory == \"Success\", errorCategory,\n                            endReason == \"SkillFailedError\", strcat(endReason, \"-\", errCode, \"-\", errorName),\n                            endReason == \"SydneyError\", strcat(endReason, \"-\", errCode ),\n                            endReason)\n    | where sessionKey == '".concat(e,"'\n    | project sessionKey, clientSessionId, queryId, workflow, errorName, endReason, errCode, Category, errorCategory,extraFields\n    "),n=i(t);return{name:"Augloop Operations",description:"Get FluxCopilot operation for a given session id",linkUrl:"https://dataexplorer.azure.com/clusters/https%3a%2f%2fodxaugloop.eastus.kusto.windows.net/databases/ODX%20AugLoop%20Service?query=".concat(n),query:t}},a=function(e){var t="\n    let clientSessionId = cluster('odxaugloop.eastus.kusto.windows.net').database('ODX AugLoop Service').WorkflowOperationEvent\n    | where TIMESTAMP > ago(7d)\n    | where operationName == \"FluxCopilot\"\n    | where sessionKey == \"".concat(e,'"\n    | distinct clientSessionId;\n    union Office_Voice_ActionAI*\n        | where Event_ReceivedTime > ago(7d)\n        | where Session_Id in (clientSessionId)\n        | project-reorder Event_Time, Event_ReceivedTime, Event_Name, Data_ChatEventType, Data_UserQueryGuid, Data_OperationName, Data_AugloopSessionGuid, Data_EventState, Data_Type\n        | order by Event_Time asc\n    '),n=i(t);return{name:"Client Chat Event logs",description:"Get Client Chat Event logs for a given session id",linkUrl:"https://dataexplorer.azure.com/clusters/https%3a%2f%2fkusto.aria.microsoft.com/databases/9783945ebc2b468fbb8a2890cdab903b?query=".concat(n),query:t}},i=function(e){var t=(new TextEncoder).encode(e),n=r.Ay.deflate(t);return btoa(String.fromCharCode.apply(null,n))}},782597:(e,t,n)=>{"use strict";n.d(t,{M:()=>m});var r=n(743032),o=n(374292),a=n(379490),i=n(208520),s=n(70367),c=n(956775),l=n(242154),u=n(934761),d=n(656904),_=n(740389),p=function(e){switch(e){case Office.PlatformType.OfficeOnline:return(0,d.Csj)()?OfficeaicopilotStrings.PodcastHostAppWeb:"web app";case Office.PlatformType.Android:case Office.PlatformType.iOS:return(0,d.Csj)()?OfficeaicopilotStrings.PodcastHostAppMobile:"mobile app";default:return(0,d.Csj)()?OfficeaicopilotStrings.PodcastHostAppDesktop:"desktop app"}},g=n(156203),f=n(758651),h=i.lazy((function(){return Promise.all([n.e(9037),n.e(3341),n.e(5016)]).then(n.bind(n,836371)).then((function(e){return{default:e.FloatingAudioPlayer}}))})),C=function(e){var t=e.ssmlScript,n=e.conversationScript,r=function(e,t){var n=new Blob([t],{type:"text/plain;charset=utf-8"}),r=URL.createObjectURL(n),o=document.createElement("a");o.href=r,o.download=e,o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(r)};return i.createElement("div",null,i.createElement("button",{onClick:function(){r("ssml-script.txt",t),r("conversation-script.txt",n)}},"Download SSML Script"))},m=function(e,t){(0,l.cY)("Podcast Init: usePodcastUI");var n=(0,_.snA)("isSsmlDownloadEnabled",!1);return{PodcastUI:function(m){(0,l.cY)("Podcast Init: usePodcastUI render");var v,E=Office.context.diagnostics.platform===Office.PlatformType.OfficeOnline,y=(0,i.useMemo)((function(){var e,t;return{name:null===(e=m.hostAppInfo)||void 0===e?void 0:e.name,platform:E?"Web":null===(t=m.hostAppInfo)||void 0===t?void 0:t.platform}}),[m.hostAppInfo]),b=(0,c.useAudioCastStringsHandler)({name:y.name,platform:p(Office.context.diagnostics.platform)}),T=c.PodcastHistoryRequestHandler.getInstance(),I=(0,i.useMemo)((function(){return new c.AudioCastPlayerTelemetryHandler(m.userQueryGuid)}),[m.userQueryGuid]),P=c.AudioCastSettingsRequestHandler.getInstance(),A=c.AudioOverviewFullPaneFeedbackHandler.getInstance();if(m.feedbackData)try{v=JSON.parse(m.feedbackData)}catch(e){f.error("Failed to parse feedback data in usePodcastUI:",e),null==I||I.logQos({name:"FloatingPodcastPlayer.Error.FullPane.ParseFeedbackData",resultType:s.c.Failure,resultCode:"ParseFeedbackDataFailurePodcast",extraData:{error:(0,o._)(e,Error)?e.message:String(e)}})}var D,S=(0,i.useMemo)((function(){return v?A.getFeedbackProps(v,m.telemetryData):void 0}),[v,m.telemetryData]),M=(0,i.useMemo)((function(){var e;return P.getSettingsForQueryId(null!==(e=m.userQueryGuid)&&void 0!==e?e:"")}),[P,m.userQueryGuid]);return i.createElement(i.Suspense,{fallback:i.createElement("div",null,"Loading...")},i.createElement(h,{ref:m.ref,urls:m.audioUrls,isQueueVisible:m.isQueueVisible,isBuffering:m.isBuffering,audioId:m.audioId,isAskQuestionAllowed:m.isAskQuestionAllowed,isRaiseHandAllowed:m.isRaiseHandAllowed,isDownloadAllowed:m.isDownloadAllowed,isSaveToOneDriveAllowed:m.isSaveToOneDriveEnabled,isConfigureAllowed:m.isConfigureEnabled,isFullScreenAllowed:m.isFullScreenEnabled,shouldPlay:m.shouldPlay,wrapperError:m.audioPlayerError,currentlyPlayingText:m.fileName,downloadFileName:m.downloadFileName,isContentVisible:m.isContentVisible,content:m.content,isPinningEnabled:m.isPinningEnabled,telemetryHandler:I,isDebugEnvironment:m.isDebugEnvironment,onPodcastHistoryRequest:null==T?void 0:T.onPodcastHistoryRequest.bind(T),getCurrentPodcastHistoryPlayerIndex:null==T?void 0:T.getCurrentIndex.bind(T),shouldRenderPodcast:null==T?void 0:T.shouldRenderPodcast.bind(T),handleAudioCastStrings:b,graphTokenProvider:e,removeContextId:u.P.getInstance().removeContextId.bind(u.P.getInstance()),userQueryGuid:m.userQueryGuid,usePreloadHideSignal:g.H,onAudioCastSettingsRequest:(D=(0,r._)((function(e){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,null==P?void 0:P.onAudioCastSettingsRequest.bind(P,e,(0,d.Csj)()?OfficeaicopilotStrings.GeneratePodcastWithUpdatedSettings:"Generate an audio overview with the updated settings")()];case 1:return t.sent(),[2]}}))})),function(e){return D.apply(this,arguments)}),hostAppInfo:y,fullPaneErrorInfo:m.fullPaneErrorInfo,feedbackProps:S,featureFlags:{isAudioCastCustomInstructionsEnabled:(0,_.NQ$)()},audioCastSettings:M,customRaiseHandPlayerFactory:t}),n&&m.ssml&&i.createElement(C,{ssmlScript:m.ssml.ssmlScript,conversationScript:m.ssml.conversationScript}))}}}},789065:(e,t,n)=>{"use strict";n.d(t,{Bb:()=>a,C$:()=>i,w:()=>s});var r=n(211475),o=n(61714);function a(e,t){var n={jsonrpc:e.jsonrpc,id:e.id,result:[{type:"text/plain",id:(0,o.A)(),data:t,description_for_model:t}]};return{status:r.HZ.SUCCESS,message:"Successfully run the invoked plugin function",payload:JSON.stringify(n)}}function i(e,t){var n,a,i={jsonrpc:null!==(n=null==e?void 0:e.jsonrpc)&&void 0!==n?n:"2.0",id:null!==(a=null==e?void 0:e.id)&&void 0!==a?a:(0,o.A)(),error:{code:r._I.InvocationError,message:l(t)}};return{status:r.HZ.FAILURE,message:"Failed to execute the requested plugin",payload:JSON.stringify(i)}}function s(e){var t;try{t=JSON.parse(e)}catch(e){throw new Error("Failed to parse payload into a IPluginRequest object. \n"+e)}return{id:t.id,method:c(t.method),params:t.params,jsonrpc:t.jsonrpc}}function c(e){if(!e)throw new Error("Method name is missing in the invocation");var t=e.indexOf("_");if(-1===t)throw new Error("Namespace is missing in the invocation method name");return e.substring(t+1)}function l(e){return"string"==typeof e?e:e instanceof Error?e.message:"Unknown error"}},789970:(e,t,n)=>{"use strict";n.d(t,{p:()=>o,s:()=>a});var r=["https://fa000000125.resources.office.net","https://fa000000124.resources.office.net","https://fa000000129.resources.office.net","https://appsforoffice.microsoft.com"],o=function(){var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection,t=performance.getEntriesByType("resource").filter((function(e){return r.find((function(t){return e.name.startsWith(t)}))})).map((function(e){return[e.name.substring(e.name.lastIndexOf("/")+1),+e.duration.toFixed(1),e.transferSize,e.encodedBodySize,e.decodedBodySize]}));return{connection:[e.effectiveType,e.downlink,e.rtt],performanceEntries:t}},a={initialize:function(){return[]},addCheckpoint:function(e,t){e.push({checkpoint:t,ts:(new Date).getTime()})},serialize:function(e){return JSON.stringify(e)},getLatency:function(e,t){var n,r,o=null===(n=e.find((function(e){return e.checkpoint===t[0]})))||void 0===n?void 0:n.ts,a=null===(r=e.find((function(e){return e.checkpoint===t[1]})))||void 0===r?void 0:r.ts;return void 0===o||void 0===a?-1:(a-o)/1e3}}},790799:()=>{},806220:(e,t,n)=>{"use strict";n.d(t,{Oz:()=>s.O,RL:()=>_.R,Ss:()=>d.Ss,VE:()=>l.V,Wu:()=>c.W,XX:()=>o.X,ki:()=>r.k,ky:()=>d.ky,sJ:()=>u.s,u1:()=>i.u,v5:()=>a.v});var r=n(940965),o=n(565018),a=n(448526),i=n(863165),s=n(989881),c=n(496931),l=n(372102),u=n(687295),d=n(217425),_=n(584660)},813392:(e,t,n)=>{"use strict";n.d(t,{l:()=>c});var r=n(475119),o=n(208520),a=n(750287),i=n(423905),s=n(83437),c=function(e){var t,n=e.clientInfoRef,c=e.theme,l=e.locale,u=e.clientId,d=e.redirectUri,_=e.isWebPlatform,p=o.useRef(void 0),g=function(){t&&t.close(),t=void 0},f=o.useCallback((function(e){p.current=e;var o=window.location.href.replace("taskpane.html","CloudFilePickerDialog.html"),f=c===a.G.defaultBlack,h=function(e){var o,a,c,h,C,m,v=JSON.parse(e);switch(v.type){case r.zg.Ack:var E={userPrincipalName:null!==(c=null===(a=n.current)||void 0===a?void 0:a.userPrincipalName)&&void 0!==c?c:"",clientId:u,redirectUri:d,locale:l,isDarkMode:f};r.EG.sendChatEventTelemetry((0,i.pN)(((o={})[s.h3.ChatEventType]=s.a5.CloudFilesDialogOpened,o))),t&&t.messageChild(JSON.stringify(E),{targetOrigin:"*"});break;case r.zg.CloseEvent:g(),_?setTimeout((function(){var e;null===(e=p.current)||void 0===e||e.closeCiqCallback()}),700):null===(h=p.current)||void 0===h||h.closeCiqCallback();break;case r.zg.OnItemSelected:g();var y=v.files;_?setTimeout((function(){var e;null===(e=p.current)||void 0===e||e.onItemSelected(y)}),700):null===(C=p.current)||void 0===C||C.onItemSelected(y);break;case r.zg.OnErrorInLoading:g(),_?setTimeout((function(){var e;null===(e=p.current)||void 0===e||e.onErrorInLoading()}),700):null===(m=p.current)||void 0===m||m.onErrorInLoading()}};_?Office.context.ui.displayDialogAsync(o,{displayInIframe:!0,hideTitle:!0,height:65,width:60},(function(e){null==(t=e.value)||t.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){var t;h(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"")}))})):OfficeFirstPartyDialog.displayWebDialog(o,{displayInIframe:!0,dialogTitle:"",hideTitle:!0,height:65,width:60,onMessage:h,onClose:function(){var e;null===(e=p.current)||void 0===e||e.closeCiqCallback()}}).then((function(e){t=e}))}),[n,c,p]);return{onAttachCloudFiles:f}}},817206:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});var r,o=n(918948),a=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=function(e){function t(t,n,r,o){return e.call(this,t,n,r,o)||this}return a(t,e),t.prototype.getResourceType=function(){return"3P"},t.prototype.shouldFallbackTo3PResource=function(){return!1},t}(o.I)},817990:(e,t,n)=>{"use strict";n.d(t,{f:()=>f});var r=n(660606),o=n(423905),a=n(83437),i=n(883),s=n(426689),c=n(480591),l=n(789065),u=n(648284),d=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},_=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},p=function(e){return d(void 0,void 0,void 0,(function(){var t,n,r,o;return _(this,(function(a){return!(t=null===(o=e.localEndpoint)||void 0===o?void 0:o.split("/"))||t.length<3?(n="Invalid localEndpoint format received during local addin execution",(0,u.Xh)(n),[2,{result:n,isSuccess:!1}]):(r=t[2],[2,g(e.payload,r)])}))}))},g=function(e,t){return d(void 0,void 0,void 0,(function(){var n,s,c,d,p,g,f,h,C,m;return _(this,(function(_){switch(_.label){case 0:try{c=(0,l.w)(e),n=c.method,s=c.params}catch(e){return f=e.message,(0,u.Xh)(f),[2,{result:f,isSuccess:!1}]}(null==s?void 0:s["x-metadata"])&&delete s["x-metadata"],d=JSON.stringify(s),r.EG.sendChatEventTelemetry((0,o.pN)(((h={})[a.h3.ChatEventType]=a.a5.LocalAddinExecutionStarted,h[a.h3.ChatEventParameters]=JSON.stringify({titleId:t,methodName:n,stringifiedParams:d}),h))),_.label=1;case 1:return _.trys.push([1,3,,4]),[4,OfficeFirstParty.AddinSkillAction.InvokeAction(t,n,d)];case 2:return p=_.sent(),r.EG.sendChatEventTelemetry((0,o.pN)(((C={})[a.h3.ChatEventType]=a.a5.LocalAddinExecutionCompletedFromHost,C[a.h3.ChatEventParameters]=p,C))),(0,r.cY)("Successfully invoked local add-in plugin action",p),[2,{result:null!=p?p:"",isSuccess:!0}];case 3:return g=_.sent(),f="Failed to invoke local add-in plugin action. Error code is: \n"+(null==g?void 0:g.code)+"\nwith error message: \n"+(null==g?void 0:g.message),(0,i.debuglog)(f),r.EG.sendChatEventTelemetry((0,o.pN)(((m={})[a.h3.ChatEventType]=a.a5.LocalAddinExecutionFailedFromHost,m[a.h3.ChatEventParameters]=f,m))),(0,u.Xh)(f),[2,{result:f,isSuccess:!1}];case 4:return[2]}}))}))},f=function(e,t,n,l){return d(void 0,void 0,void 0,(function(){var d,g,f,h,C,m,v,E,y,b,T,I,P,A,D,S,M,O;return _(this,(function(_){switch(_.label){case 0:return[4,null==t?void 0:t()];case 1:_.sent(),d=[],g=!0,f=null!==c.jX&&void 0!==c.jX?c.jX:0,_.label=2;case 2:return _.trys.push([2,16,,19]),e.skillRequest?((0,o.pN)(((D={})[a.h3.ChatEventType]=a.a5.LocalAddinExecutionReceivedSingleRequest,D)),[4,p(e.skillRequest)]):[3,4];case 3:return h=_.sent(),y=h.result,b=h.isSuccess,d=[(0,u.SL)(y)],g=b,[3,12];case 4:if(!(e.skillRequests&&e.skillRequests.length>0))return[3,9];(0,o.pN)(((S={})[a.h3.ChatEventType]=a.a5.LocalAddinExecutionReceivedMultipleRequests,S)),C=0,m=e.skillRequests,_.label=5;case 5:return C<m.length?(v=m[C],[4,p(v)]):[3,8];case 6:if(E=_.sent(),y=E.result,b=E.isSuccess,d.push((0,u.SL)(y)),!b)return g=!1,[3,8];_.label=7;case 7:return C++,[3,5];case 8:return[3,12];case 9:return P="No skillRequest or skillRequests provided for local addin execution",(0,u.Xh)(P),[4,null==n?void 0:n()];case 10:return _.sent(),[4,(0,u.q1)(l)];case 11:return _.sent(),T={result:[(0,u.SL)(P)]},e.callback(T),[2];case 12:return[4,null==n?void 0:n()];case 13:return _.sent(),g?[3,15]:[4,(0,u.q1)(l)];case 14:_.sent(),_.label=15;case 15:return(0,r.cY)("Results from TriggerPlugin messages:",d),A={result:d},e.callback(A),r.EG.sendLatencyTelemetry((0,o.pN)(((M={})[a.CT.FeatureName]=a.CC.Extensibility,M[a.CT.SubFeatureName]=a.Ff.AddInActionsForAgents,M[a.CT.UserPerceivedLatency]=(0,s.x)(f),M[a.CT.IsQuerySuccess]=g,M)),!0),[3,19];case 16:return I=_.sent(),P="Unexpected error during local addin execution: ".concat(null==I?void 0:I.message),(0,i.debuglog)(P),[4,null==n?void 0:n()];case 17:return _.sent(),[4,(0,u.q1)(l)];case 18:return _.sent(),(0,u.Xh)(P),r.EG.sendLatencyTelemetry((0,o.pN)(((O={})[a.CT.FeatureName]=a.CC.Extensibility,O[a.CT.SubFeatureName]=a.Ff.AddInActionsForAgents,O[a.CT.UserPerceivedLatency]=(0,s.x)(f),O[a.CT.IsQuerySuccess]=!1,O[a.CT.ErrorChatEventType]=a.S2.LocalAddinActionExecution,O[a.CT.ErrorChatEventParameter]=P,O)),!0),A={result:[(0,u.SL)(P)]},e.callback(A),[3,19];case 19:return[2]}}))}))}},818067:(e,t,n)=>{"use strict";n.d(t,{B:()=>s});var r=n(475119),o=n(660606),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},i=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=function(){function e(){this.apiHandlers=new Map}return e.getInstance=function(){return e.PrivateApi||(e.PrivateApi=new e),e.PrivateApi},e.prototype.initializePrivateApi=function(){return a(this,arguments,void 0,(function(e){var t,n=this;return void 0===e&&(e=0),i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(t){return a(n,void 0,void 0,(function(){var n,r,a;return i(this,(function(i){switch(i.label){case 0:return(0,o.cY)("PrivateApi event: "+t),e>0?[4,new Promise((function(t){return setTimeout(t,e)}))]:[3,2];case 1:i.sent(),i.label=2;case 2:n=!1;try{r=JSON.parse(t)}catch(e){r=null}return(null==r?void 0:r.eventName)&&(a=this.apiHandlers.get(r.eventName))&&a instanceof Function&&(a(r),n=!0),n||(0,o.cY)("Could not dispatch PrivateApi event"),[2]}}))}))}))];case 1:return r.sent(),[3,3];case 2:return t=r.sent(),(0,o.cY)("Error initializing PrivateApi: "+t),[3,3];case 3:return[2]}}))}))},e.prototype.openMOSDialog=function(){return a(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return e={dispidMethod:r.T7.LaunchMos},[4,this.execute(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getFullDocumentHtml=function(){return a(this,void 0,void 0,(function(){var e;return i(this,(function(t){return e={dispidMethod:r.T7.GetFullDocumentHtml},[2,this.execute(e)]}))}))},e.prototype.execute=function(e){return a(this,void 0,void 0,(function(){return i(this,(function(t){return[2,OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))]}))}))},e.prototype.triggerReadAloud=function(){return a(this,void 0,void 0,(function(){var e;return i(this,(function(t){return e={dispidMethod:r.T7.ReadAloud},[2,this.execute(e)]}))}))},e.prototype.attachPrivateEventHandler=function(e,t){this.apiHandlers.has(e)&&(0,o.cY)("Overwriting PrivateApi event handler for "+e),this.apiHandlers.set(e,t)},e}()},818203:(e,t,n)=>{"use strict";n.d(t,{D:()=>s});var r=n(529404),o=n(260623),a={root:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",gap:r.L.spacingVerticalS},spinnerContainer:{justifyContent:"center",width:"100%"}},i=(0,o.n)(a),s=function(){return i()}},822202:()=>{},822446:(e,t,n)=>{"use strict";n.r(t),n.d(t,{appEntryPointTime:()=>ue,getPreloadedCopilotSessionObject:()=>fe,isSDXRenderingForPreload:()=>_e,officeOnReadyTime:()=>ne,preloadCopilotTime:()=>re,setPreloadedCopilotSessionObject:()=>ge,setPreloadedCopilotVisibility:()=>pe,taskPaneStartTime:()=>le});var r=n(743032),o=n(990813),a=n(379490),i=n(208520),s=n(794329),c=n(851348),l=(n(57008),n(359474)),u=n(400934),d=n(932554),_=n(374292),p=n(124857),g=n(448397),f=n(140889),h=n(242154),C=n(769449),m=n(858703),v=n(862853),E=n(602061),y=n(740389),b=n(722603),T=n(656904),I=n(663279),P=n(598309);function A(){return(A=(0,r._)((function(e){var t,n,r,i,s,c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:t=g.B.getInstance(),n=E.sYi.initialize(),a.label=1;case 1:return a.trys.push([1,3,,4]),E.sYi.addCheckpoint(n,"StringsTaskStart"),[4,Promise.all([D(),(0,m.Xd)(),(0,m.qG)()])];case 2:return a.sent(),E.sYi.addCheckpoint(n,"StringsTaskEnd"),E.sYi.addCheckpoint(n,"LoadUserTypeTaskEnd"),E.sYi.addCheckpoint(n,"LoadUserIdentityTaskEnd"),t.sendChatEventTelemetry((0,C.pN)((r={},(0,o._)(r,f.h3.ChatEventType,f.a5.LocalizationCheckpoint),(0,o._)(r,f.h3.ChatEventParameters,E.sYi.serialize(n)),r))),t.sendChatEventTelemetry((0,C.pN)((i={},(0,o._)(i,f.h3.ChatEventType,f.a5.PrimaryUserType),(0,o._)(i,f.h3.ChatEventParameters,(0,E.nhe)((0,v.W2)())),i))),(0,E.Bp2)((0,y.kh6)().toString()),(0,y.Wdf)()&&(0,E.YPU)(T.fn_,h.cY,t,{IsClpEnabledInEnterpriseForSydney:function(){return(0,y.EG7)()},IsApplyLabelUsingTryUpgradeLabelEnabled:function(){return!1},IsUserTypeEnterprise:function(){return(0,v.q0)()},getOfficeJSDocumentURL:function(){return b.i.getDocumentUrlAsync()},shouldCLPExceptionDisableEnterpriseSearch:function(){return(0,y.Nx$)()},setEnableEnterpriseSearchOverride:v.LA,getFeedbackData:I.as,IsCopilotInBackstageMode:P.w9}),e(!0),t.sendChatEventTelemetry((0,C.pN)((s={},(0,o._)(s,f.h3.ChatEventType,f.a5.LocalizationEnd),(0,o._)(s,f.h3.ChatEventParameters,(new Date).getTime().toString()),s))),(0,P.zC)()&&!(0,P.dA)()?E.BDr.getInstance().initializePrivateApi((0,P.LK)()):(0,y.UW0)()&&E.BDr.getInstance().initializePrivateApi(),[3,4];case 3:return c=a.sent(),(0,_._)(c,E.DYx)&&(0,h.cY)(c.message),[3,4];case 4:return[2]}}))}))).apply(this,arguments)}function D(){return S.apply(this,arguments)}function S(){return(S=(0,r._)((function(){return(0,a.__generator)(this,(function(e){switch(e.label){case 0:return"undefined"!=typeof WordCopilot?[2]:[4,(0,p.lY)()];case 1:return e.sent(),[2]}}))}))).apply(this,arguments)}var M,O=n(575136),k=n(8810),L=n(956775),w=n(897718),R=n(556165),U=n(245965),B=function(){return i.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M13.245 2.81755L3.63914 12.4234L3.52188 12.5513C3.33621 12.7723 3.20014 13.0315 3.12383 13.3113L2.01793 17.3663L2.00276 17.4457C1.96521 17.7862 2.28528 18.0748 2.63187 17.9803L6.68684 16.8744L6.85212 16.8215C7.12299 16.7217 7.36973 16.5641 7.57482 16.359L17.1806 6.75322L17.3108 6.61395C18.2656 5.52075 18.2222 3.85907 17.1806 2.81755C16.0938 1.73074 14.3318 1.73074 13.245 2.81755ZM4.34625 13.1305L12.3848 5.09244L14.9058 7.61344L6.86771 15.6519L6.77003 15.7377L6.66253 15.8097C6.5879 15.853 6.50767 15.8867 6.42372 15.9096L3.21196 16.7852L4.08859 13.5745L4.13086 13.4516C4.18093 13.3319 4.25396 13.2228 4.34625 13.1305ZM16.4735 3.52465L16.5831 3.64456C17.1677 4.34503 17.1311 5.38852 16.4735 6.04612L15.6128 6.90644L13.0918 4.38544L13.9521 3.52465L14.072 3.41505C14.7725 2.83052 15.8159 2.86705 16.4735 3.52465ZM11.6481 3.00015H2.5C2.22386 3.00015 2 3.22401 2 3.50015C2 3.77629 2.22386 4.00015 2.5 4.00015H10.6481L11.6481 3.00015ZM8.64811 6.00015H2.5C2.22386 6.00015 2 6.22401 2 6.50015C2 6.77629 2.22386 7.00015 2.5 7.00015H7.64811L8.64811 6.00015ZM4.64811 10.0002L5.64811 9.00015H2.5C2.22386 9.00015 2 9.22401 2 9.50015C2 9.77629 2.22386 10.0002 2.5 10.0002H4.64811Z",fill:"#424242"}))},x=function(){return i.createElement("svg",{width:"16",height:"13",viewBox:"0 0 16 13",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M0.5 0C0.223858 0 0 0.223858 0 0.5C0 0.776142 0.223858 1 0.5 1H15.5C15.7761 1 16 0.776142 16 0.5C16 0.223858 15.7761 0 15.5 0H0.5ZM0.5 3C0.223858 3 0 3.22386 0 3.5C0 3.77614 0.223858 4 0.5 4H9.5C9.77614 4 10 3.77614 10 3.5C10 3.22386 9.77614 3 9.5 3H0.5ZM0.5 6C0.223858 6 0 6.22386 0 6.5C0 6.77614 0.223858 7 0.5 7H7.38312C7.14997 6.73456 7.01013 6.38707 7.01013 6.01013L7.01017 6H0.5ZM0.5 9H6.87729L5.8764 10H0.5C0.223858 10 0 9.77614 0 9.5C0 9.22386 0.223858 9 0.5 9ZM12 2C12.2525 2 12.4654 2.18829 12.4963 2.43892L12.5937 3.23046C12.7338 4.36907 13.6309 5.26616 14.7695 5.40631L15.5611 5.50375C15.8117 5.5346 16 5.74748 16 6C16 6.25252 15.8117 6.4654 15.5611 6.49625L14.7695 6.59369C13.6309 6.73384 12.7338 7.63093 12.5937 8.76954L12.4963 9.56108C12.4654 9.81171 12.2525 10 12 10C11.7475 10 11.5346 9.81171 11.5037 9.56108L11.4063 8.76954C11.2662 7.63093 10.3691 6.73384 9.23046 6.59369L8.43892 6.49625C8.18829 6.4654 8 6.25252 8 6C8 5.74748 8.18829 5.5346 8.43892 5.50375L9.23046 5.40631C10.3691 5.26616 11.2662 4.36907 11.4063 3.23046L11.5037 2.43892C11.5346 2.18829 11.7475 2 12 2ZM12 4.59736C11.6776 5.18968 11.1897 5.67764 10.5974 6C11.1897 6.32236 11.6776 6.81032 12 7.40264C12.3224 6.81032 12.8103 6.32236 13.4026 6C12.8103 5.67764 12.3224 5.18968 12 4.59736ZM9.85304 8.14657C10.0482 8.34191 10.0481 8.65849 9.85278 8.85368L5.85343 12.8501C5.65809 13.0453 5.34151 13.0452 5.14632 12.8499C4.95113 12.6545 4.95124 12.338 5.14657 12.1428L9.14593 8.14632C9.34127 7.95113 9.65785 7.95124 9.85304 8.14657Z",fill:"#242424"}))},W=function(){return i.createElement("svg",{width:"17",height:"17",viewBox:"0 0 17 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M7.49279 3.90114C7.13479 3.9711 6.7439 4.20337 6.43474 4.74712C6.29826 4.98718 5.99301 5.07114 5.75296 4.93465C5.5129 4.79817 5.42894 4.49292 5.56543 4.25287C6.00628 3.47749 6.63328 3.0502 7.30099 2.9197C7.9539 2.7921 8.60295 2.95667 9.09316 3.28126C9.57681 3.6015 9.96793 4.12423 9.98039 4.75187C9.99339 5.40602 9.59456 5.99672 8.86123 6.43036C8.36263 6.7252 8.16869 6.92513 8.08626 7.05795C8.01687 7.16975 8.00009 7.27172 8.00009 7.5C8.00009 7.77614 7.77623 8 7.50009 8C7.22394 8 7.00009 7.77614 7.00009 7.5C7.00009 7.22827 7.01399 6.88929 7.2366 6.53061C7.44617 6.19295 7.80555 5.89287 8.35222 5.5696C8.88718 5.25326 8.98416 4.95168 8.98059 4.77173C8.97649 4.56527 8.83866 4.31208 8.54108 4.11505C8.25005 3.92235 7.86559 3.82828 7.49279 3.90114ZM7.75 10.5C8.16421 10.5 8.5 10.1642 8.5 9.75C8.5 9.33579 8.16421 9 7.75 9C7.33579 9 7 9.33579 7 9.75C7 10.1642 7.33579 10.5 7.75 10.5ZM7.50019 0C3.91034 0 1.00019 2.91015 1.00019 6.5C1.00019 7.651 1.29978 8.73335 1.82544 9.67194L1.0297 11.7542C0.736416 12.5216 1.4424 13.2957 2.23352 13.0741L4.7209 12.3774C5.5641 12.7768 6.50671 13 7.50019 13C11.09 13 14.0002 10.0899 14.0002 6.5C14.0002 2.91015 11.09 0 7.50019 0ZM2.00019 6.5C2.00019 3.46243 4.46263 1 7.50019 1C10.5378 1 13.0002 3.46243 13.0002 6.5C13.0002 9.53757 10.5378 12 7.50019 12C6.59806 12 5.74803 11.7832 4.99798 11.3993L4.82377 11.3101L1.96381 12.1111L2.93292 9.57525L2.80463 9.36552C2.29438 8.53135 2.00019 7.55079 2.00019 6.5ZM10.4628 16C8.49315 16 6.72814 15.1239 5.53613 13.7402C6.09918 13.8926 6.68851 13.981 7.29584 13.9973C8.19123 14.629 9.28368 15 10.4628 15C11.3649 15 12.2149 14.7832 12.965 14.3993L13.1392 14.3101L15.9992 15.1111L15.0301 12.5752L15.1583 12.3655C15.6686 11.5313 15.9628 10.5508 15.9628 9.49999C15.9628 8.34552 15.6071 7.27414 14.9993 6.38943C14.9905 5.78165 14.9095 5.19137 14.7643 4.6268C16.1125 5.81779 16.9628 7.5596 16.9628 9.49999C16.9628 10.651 16.6632 11.7333 16.1375 12.6719L16.9333 14.7542C17.2266 15.5216 16.5206 16.2957 15.7295 16.0741L13.2421 15.3774C12.3989 15.7768 11.4563 16 10.4628 16Z",fill:"#424242"}))},F=function(){return i.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M3.75 5C4.16421 5 4.5 4.66421 4.5 4.25C4.5 3.83579 4.16421 3.5 3.75 3.5C3.33579 3.5 3 3.83579 3 4.25C3 4.66421 3.33579 5 3.75 5ZM4.5 7.25C4.5 7.66421 4.16421 8 3.75 8C3.33579 8 3 7.66421 3 7.25C3 6.83579 3.33579 6.5 3.75 6.5C4.16421 6.5 4.5 6.83579 4.5 7.25ZM3.75 11C4.16421 11 4.5 10.6642 4.5 10.25C4.5 9.83579 4.16421 9.5 3.75 9.5C3.33579 9.5 3 9.83579 3 10.25C3 10.6642 3.33579 11 3.75 11ZM6 4.5C6 4.22386 6.22386 4 6.5 4H10.5C10.7761 4 11 4.22386 11 4.5C11 4.77614 10.7761 5 10.5 5H6.5C6.22386 5 6 4.77614 6 4.5ZM6.5 7C6.22386 7 6 7.22386 6 7.5C6 7.77614 6.22386 8 6.5 8H10.5C10.7761 8 11 7.77614 11 7.5C11 7.22386 10.7761 7 10.5 7H6.5ZM6 10.5C6 10.2239 6.22386 10 6.5 10H10.5C10.7761 10 11 10.2239 11 10.5C11 10.7761 10.7761 11 10.5 11H6.5C6.22386 11 6 10.7761 6 10.5ZM2.75 0H11.25C12.7688 0 14 1.23122 14 2.75V11.25C14 12.7688 12.7688 14 11.25 14H2.75C1.23122 14 0 12.7688 0 11.25V2.75C0 1.23122 1.23122 0 2.75 0ZM1 2.75V11.25C1 12.2165 1.7835 13 2.75 13H11.25C12.2165 13 13 12.2165 13 11.25V2.75C13 1.7835 12.2165 1 11.25 1H2.75C1.7835 1 1 1.7835 1 2.75Z",fill:"#424242"}))},N=function(){return i.createElement("svg",{width:"16",height:"17",viewBox:"0 0 16 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M12.0872 5.70296C12.9271 4.85986 14.2664 4.81723 15.1568 5.57689L15.2869 5.69685L15.4134 5.83345C16.1376 6.682 16.1376 7.93659 15.4134 8.78513L15.293 8.91562L8.41674 15.8182C8.26172 15.9738 8.0749 16.093 7.86988 16.1681L7.71291 16.216L4.62737 16.9763C4.28827 17.0598 3.98023 16.7812 4.00917 16.4497L4.0236 16.3659L4.81558 13.2951C4.86895 13.0882 4.96574 12.8957 5.09885 12.7301L5.20537 12.6111L12.0872 5.70296ZM14.5811 6.40531C14.1201 5.94601 13.393 5.91672 12.898 6.31648L12.7957 6.40872L5.91383 13.3169C5.87193 13.3589 5.83804 13.4079 5.8135 13.4615L5.7839 13.5449L5.20061 15.8049L7.47368 15.245C7.51317 15.2353 7.55114 15.2208 7.58682 15.2021L7.6385 15.1708L7.70829 15.1124L14.5845 8.20987C15.0806 7.71194 15.0806 6.90665 14.5811 6.40531ZM4.42419 1.22867L4.46607 1.31311L7.448 8.94212L6.676 9.71712L6.004 7.99812H2.007L0.966143 10.6779C0.877185 10.9066 0.638348 11.0328 0.405613 10.9877L0.318927 10.9627C0.0901546 10.8737 -0.0360133 10.6349 0.00906154 10.4021L0.0341258 10.3155L3.53436 1.31391C3.6877 0.919579 4.21661 0.890966 4.42419 1.22867ZM4.00061 2.87088L2.396 6.99812H5.614L4.00061 2.87088Z",fill:"#424242"}))},K=function(){return i.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M9 4C8.23745 4 7.52474 4.21338 6.91832 4.58369C6.85042 4.23521 6.73892 3.91747 6.57907 3.62413C7.29636 3.22644 8.12174 3 9 3C11.7614 3 14 5.23858 14 8H16.5C17.3284 8 18 8.67157 18 9.5V15.5C18 16.3284 17.3284 17 16.5 17H10.5C9.67158 17 9 16.3284 9 15.5V13C8.28132 13 7.59805 12.8484 6.98044 12.5754C6.99327 12.2357 7 11.8776 7 11.5L7 11.4649C7.58835 11.8052 8.27143 12 9 12V9.5C9 8.67157 9.67158 8 10.5 8H13C13 5.79086 11.2091 4 9 4ZM13.9 9C13.5023 10.9591 11.9591 12.5023 10 12.9V15.5C10 15.7761 10.2239 16 10.5 16H16.5C16.7761 16 17 15.7761 17 15.5V9.5C17 9.22386 16.7761 9 16.5 9H13.9ZM12.874 9H10.5C10.2239 9 10 9.22386 10 9.5V11.874C11.4056 11.5122 12.5122 10.4056 12.874 9ZM4.5809 2.12516C4.74705 2.27184 4.7964 2.50986 4.70381 2.7099C4.70296 2.71223 4.70137 2.71679 4.69951 2.7233C4.69403 2.74248 4.6875 2.77386 4.6875 2.8125C4.6875 2.87632 4.70345 2.99635 4.85355 3.14645C4.92656 3.21945 4.98278 3.27129 5.04403 3.32777C5.0937 3.37356 5.1467 3.42243 5.2147 3.48817C5.34326 3.61244 5.48131 3.75807 5.60353 3.9414C5.85878 4.32428 6 4.80266 6 5.5C6 6.35341 5.68386 7.07986 5.19132 7.52619C5.21306 7.55015 5.23421 7.57477 5.25477 7.6C5.53518 7.94407 5.69833 8.38978 5.79975 8.83013C6.00007 9.69992 6.00003 10.7457 6 11.4746L6 11.5C6 14.2873 5.62117 15.8681 5.20398 16.772C4.99389 17.2272 4.77136 17.5165 4.57769 17.6994C4.48105 17.7907 4.39315 17.854 4.3202 17.8974C4.28383 17.9191 4.25153 17.9356 4.22413 17.9481C4.21045 17.9543 4.19803 17.9595 4.18698 17.9638C4.18698 17.9638 4.07437 18 4 18C3.92563 18 3.81303 17.9638 3.81303 17.9638C3.80198 17.9595 3.78956 17.9543 3.77587 17.9481C3.74848 17.9356 3.71618 17.9191 3.67981 17.8974C3.60685 17.854 3.51895 17.7907 3.42232 17.6994C3.22865 17.5165 3.00612 17.2272 2.79602 16.772C2.37883 15.8681 2 14.2873 2 11.5V11.4746C1.99997 10.7457 1.99994 9.69992 2.20026 8.83013C2.30168 8.38978 2.46482 7.94407 2.74523 7.6C2.7658 7.57477 2.78695 7.55015 2.80869 7.52619C2.31614 7.07986 2 6.35341 2 5.5C2 5.17432 2.08733 4.78457 2.20709 4.42621C2.32741 4.06616 2.4953 3.6937 2.68863 3.39408C2.92008 3.00387 3.24542 2.67734 3.49671 2.45654C3.62622 2.34275 3.7425 2.25148 3.82717 2.18811C3.86961 2.15634 3.90443 2.13135 3.92936 2.11381L3.95916 2.09311L3.96805 2.08707L3.9709 2.08515L3.97265 2.08398C4.16129 1.95822 4.41094 1.97512 4.5809 2.12516ZM4.00165 7C4.38648 6.99878 5 6.57082 5 5.5C5 4.94735 4.89123 4.67573 4.77148 4.4961C4.7062 4.39818 4.62549 4.30944 4.51968 4.20715C4.48866 4.17717 4.44485 4.1364 4.39601 4.09093C4.31493 4.01546 4.21995 3.92706 4.14645 3.85356C4.02697 3.73408 3.93558 3.6111 3.86702 3.48854C3.7454 3.61965 3.63177 3.76281 3.54503 3.91047C3.54119 3.91701 3.5372 3.92346 3.53307 3.92981C3.3939 4.14378 3.25712 4.43917 3.15553 4.74317C3.05209 5.05267 3 5.32672 3 5.5C3 6.57235 3.61528 7 4 7L4.00165 7ZM3.5204 8.23176C3.37893 8.40534 3.26083 8.6808 3.17475 9.05457C3.00241 9.80286 3 10.7428 3 11.5C3 14.2127 3.37117 15.6319 3.70398 16.353C3.81319 16.5896 3.91694 16.7482 4 16.8524C4.08307 16.7482 4.18682 16.5896 4.29602 16.353C4.62883 15.6319 5 14.2127 5 11.5C5 10.7428 4.9976 9.80286 4.82526 9.05457C4.73918 8.6808 4.62107 8.40534 4.47961 8.23176C4.35446 8.0782 4.21077 8 4 8L3.99805 8C3.78835 8.00048 3.64516 8.07868 3.5204 8.23176Z",fill:"#707070"}))},H=function(){return i.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{d:"M10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2ZM10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3ZM10 13.5C10.4142 13.5 10.75 13.8358 10.75 14.25C10.75 14.6642 10.4142 15 10 15C9.58579 15 9.25 14.6642 9.25 14.25C9.25 13.8358 9.58579 13.5 10 13.5ZM10 5.5C11.3807 5.5 12.5 6.61929 12.5 8C12.5 8.72959 12.1848 9.40774 11.6513 9.8771L11.4967 10.0024L11.2782 10.1655L11.1906 10.2372C11.1348 10.2851 11.0835 10.3337 11.0346 10.3859C10.6963 10.7464 10.5 11.2422 10.5 12C10.5 12.2761 10.2761 12.5 10 12.5C9.72386 12.5 9.5 12.2761 9.5 12C9.5 10.988 9.79312 10.2475 10.3054 9.70162C10.4165 9.5832 10.532 9.47988 10.6609 9.37874L10.9076 9.19439L11.0256 9.09468C11.325 8.81435 11.5 8.42206 11.5 8C11.5 7.17157 10.8284 6.5 10 6.5C9.17157 6.5 8.5 7.17157 8.5 8C8.5 8.27614 8.27614 8.5 8 8.5C7.72386 8.5 7.5 8.27614 7.5 8C7.5 6.61929 8.61929 5.5 10 5.5Z",fill:"#242424"}))},G=n(256234),Q=n(190202),j=n(311367),Y=n(778027),z=n(228973),q=n(951405),V=n(747222),Z=n(251022),J=n(165865),X=n(758651),$=!1,ee=(M=(0,r._)((function(){return(0,a.__generator)(this,(function(e){return $||(OfficeFirstPartyAuth.autoPopup=!0,OfficeFirstPartyAuth.upnCheck=!1,OfficeFirstPartyAuth.useMsal3=!0,$=!0),[2]}))})),function(){return M.apply(this,arguments)}),te=function(){ee();var e=(0,c._)((0,i.useState)(!1),2),t=e[0],n=e[1],s=(0,c._)(i.useState(E.GmK.defaultWhite),2),_=s[0],m=s[1],v=(0,c._)(i.useState(u.QJ.disabled),2),b=v[0],T=v[1];window.matchMedia("(forced-colors: active)").addEventListener("change",(function(e){e.matches?D(!0):D(!1)})),window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",(function(e){window.matchMedia("(forced-colors: active)").matches&&T(e.matches?u.QJ.light:u.QJ.dark)}));var I=function(){var e=(0,r._)((function(){var e,t;return(0,a.__generator)(this,(function(n){if((0,d.So)())try{e=new OfficeCore.RequestContext,OfficeCore.ThemeService.newObject(e).onOfficeThemeChanged.add((function(e){e&&P(e.bodyBackgroundColor,!0)})),e.sync().then((function(){(0,h.cY)("ThemeService event is registered.x")})).catch((function(e){(0,h.cY)("ThemeService registration failed",e)}))}catch(e){(0,h.cY)("ThemeService registration failed",e)}else(null===(t=Office.context)||void 0===t?void 0:t.themeManager)&&Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,(function(e){var t=e.officeTheme;(0,h.cY)("theme is dark: "+t.isDarkTheme.toString()),(0,h.cY)("bodyBackground = "+t.bodyBackgroundColor),P(t.bodyBackgroundColor,!0)}),null);return[2]}))}));return function(){return e.apply(this,arguments)}}(),P=function(e,t){var n=E.GmK.defaultWhite;n=(0,u.mR)(e,t),m(n)},D=function(e){var t=window.matchMedia("(prefers-color-scheme: light)").matches;(0,Q.uj)(e),e?T(t?u.QJ.light:u.QJ.dark):(T(u.QJ.disabled),P(Office.context.officeTheme.bodyBackgroundColor,!0))};i.useEffect((function(){switch(b){case u.QJ.light:(0,Q.N_)(E.GmK.defaultWhite),m(E.GmK.defaultWhite);break;case u.QJ.dark:(0,Q.N_)(E.GmK.defaultBlack),m(E.GmK.defaultBlack)}}),[b]),i.useEffect((function(){Office.onReady().then((function(){var e,t,s,c,l,u,_,p;(g.B.getInstance().sendChatEventTelemetry((0,C.pN)((e={},(0,o._)(e,f.h3.ChatEventType,f.a5.TaskPaneStart),(0,o._)(e,f.h3.ChatEventParameters,le),e))),g.B.getInstance().sendChatEventTelemetry((0,C.pN)((t={},(0,o._)(t,f.h3.ChatEventType,f.a5.AppLoadStart),(0,o._)(t,f.h3.ChatEventParameters,ue),t))),g.B.getInstance().sendChatEventTelemetry((0,C.pN)((s={},(0,o._)(s,f.h3.ChatEventType,f.a5.OfficeJSReady),(0,o._)(s,f.h3.ChatEventParameters,null!=ne?ne:(new Date).getTime()),s))),re&&g.B.getInstance().sendChatEventTelemetry((0,C.pN)((c={},(0,o._)(c,f.h3.ChatEventType,f.a5.PreloadCopilot),(0,o._)(c,f.h3.ChatEventParameters,re),c))),function(){switch(Office.context.platform){case Office.PlatformType.iOS:(0,Y.j_)(G.Y.IOS);break;case Office.PlatformType.Mac:(0,Y.j_)(G.Y.MACOS);break;case Office.PlatformType.PC:(0,Y.j_)(G.Y.win32);break;default:(0,Y.j_)(G.Y.web)}}(),(0,O.v)(),(0,U.K1)({icons:{WriteAboutIcon:i.createElement(B,null),RewriteTextIcon:i.createElement(x,null),SummarizeIcon:i.createElement(F,null),AskAboutIcon:i.createElement(W,null),ChangeIcon:i.createElement(N,null),GenerateImageIcon:i.createElement(K,null),HelpIcon:i.createElement(H,null)}}),d.Vv.initializeHostAppSettingVariables(),(0,r._)((function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,(0,R.Nd)()];case 1:return t.sent(),(0,y.CyP)().length>0?[4,V.U.getInstance().init()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:return e=t.sent(),(0,h.cY)("Auth initialization failed with exception ".concat(e)),[3,5];case 5:return[2]}}))}))(),(0,h.OK)())?null===(u=Office.context)||void 0===u||null===(l=u.themeManager)||void 0===l||l.getOfficeThemeAsync((function(e){if("succeeded"===e.status){var t=e.value;P(t.bodyBackgroundColor,!0)}})):(window.matchMedia("(forced-colors: active)").matches&&D(!0),P(null===(p=Office.context)||void 0===p||null===(_=p.officeTheme)||void 0===_?void 0:_.bodyBackgroundColor,!0));I().catch((function(e){(0,h.cY)("Register Theme Callback() error: "+e),L.TelemetryLoggerUtils.getInstance().logErrorWithAshaVetoAndError([],void 0,void 0,"Copilot Chat Pane UI Experience Degraded","There was an error while trying to register the theme for the Copilot Chat pane",!1),g.B.getInstance().sendErrorTelemetry([{key:f.IC.ErrorCategory,value:k.S.Error},{key:f.IC.ErrorMessage,value:"Register Theme Callback() error: "+e.message}])})),function(e){return A.apply(this,arguments)}(n).catch((function(e){(0,h.cY)("Initialization tasks() error: "+e),L.TelemetryLoggerUtils.getInstance().logErrorWithAshaVetoAndError([],void 0,void 0,"Copilot Chat Pane Failed To Show","There was an error while trying to initialize tasks for the Copilot Chat pane",!1),g.B.getInstance().sendErrorTelemetry([{key:f.IC.ErrorCategory,value:k.S.Error},{key:f.IC.ErrorMessage,value:"Initialization tasks() error: "+e.message}])})),window.addEventListener("beforeunload",(function(){X.log("beforeunload"),E.DLk.getInstance().closeActiveDialog(),E.gQo.getInstance().closeActiveDialog()})),E.DLk.getInstance().shouldUseDimensionsV2((0,y.QF)())})).catch((function(e){(0,h.cY)("Office.onReady() error: "+e),L.TelemetryLoggerUtils.getInstance().logErrorWithAshaVetoAndError([],void 0,void 0,"Copilot Chat Pane Failed To Show","There was an unexpected error when trying to show the Copilot Chat pane",!1),g.B.getInstance().sendErrorTelemetry([{key:f.IC.ErrorCategory,value:k.S.Error},{key:f.IC.ErrorMessage,value:"Office.onReady() error: "+e.message}])}))}),[]);var S=d.Vv.IsSettingTrue(d.zj.IsCopilotChatDialog),M=d.Vv.getSetting(d.zj.CopilotChatDialogContext),$=M?JSON.parse(M):void 0,te=i.createElement(w.H,{theme:_,isHighContrast:b!==u.QJ.disabled}),oe=_!==E.GmK.defaultWhite?"./assets/error-boundary-dark.webp":"./assets/error-boundary-light.webp",ae=(0,E.IdZ)(u.Yw,_,b!==u.QJ.disabled);i.useEffect((function(){E.DLk.setTheme(ae),E.gQo.setTheme(ae)}),[_]);var ie=(0,y.FC0)()&&(0,h.Ui)()?((0,E.sZB)(),i.createElement(l.q,{theme:ae,dir:ae.dir},i.createElement(j.A,{licenseErrorImagePath:oe,handleRefreshButtonOnClick:function(){var e,t;null===Office||void 0===Office||null===(t=Office.ExtensionLifeCycle)||void 0===t||null===(e=t.taskpane)||void 0===e||e.close().catch((function(e){(0,h.cY)("Error closing taskpane: ".concat(e))}))}}))):i.createElement(E.tHk,{copilotChatTheme:ae,errorBoundaryImagePath:oe},te),se=(0,E.Qk5)((0,p.mf)(),void 0),ce=i.createElement(E.G41,{lookupString:se}," ",ie),de=i.createElement(L.VoiceContextProvider,{connectingStateAnimationSrc:"./assets/copilot.gif",initialModality:L.ActiveInputModality.Chat},ce);return!S||$&&$.appName!==q.u.VOICE||(de=i.createElement(L.VoiceContextProvider,{connectingStateAnimationSrc:"./assets/copilot.gif",initialModality:L.ActiveInputModality.RealtimeVoice,officeAssistantAssets:{checkmarkSvg:"./assets/checkmark.svg"},onClose:function(){var e;e=new KeyboardEvent("keydown",{key:"Escape",code:"Escape",keyCode:27,which:27,bubbles:!0,cancelable:!0}),document.dispatchEvent(e)}},ce)),i.useEffect((function(){(0,z.k)(L.AnimationOverride),(0,J.k)(L.AudioEffectsOverride),(0,E.NOM)("FA000000125")}),[]),t?i.createElement("div",{className:"ms-welcome"},i.createElement(l.q,{dir:(0,p.xt)()?"rtl":"ltr",theme:ae},i.createElement(Z.Wr,{mode:"sidecar"},de))):i.createElement(i.Fragment,null)};var ne,re,oe=n(246539),ae=n(702655),ie=n(15743),se=n(249002),ce=n(403162),le=window.TaskPaneStartTime,ue=(new Date).getTime().toString(),de=!1,_e=!1;function pe(e){var t;(null===(t=sessionStorage)||void 0===t?void 0:t.getItem("preloadCopilot"))&&ge(e)}function ge(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];null===(e=sessionStorage)||void 0===e||e.setItem("preloadCopilot",JSON.stringify({isPreloaded:!0,isHidden:t}))}function fe(){var e;return null===(e=sessionStorage)||void 0===e?void 0:e.getItem("preloadCopilot")}var he=function(){var e=(0,r._)((function(){function e(){(0,h.cY)("renderUIToScreen"),ne=(new Date).getTime();var e=document.getElementById("container");e?s.render(i.createElement("div",null,i.createElement(te,null)),e):(0,h.cY)("Container element not found")}return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(e){var t=function(){"undefined"!=typeof Office?e():setTimeout(t,50)};t()}))];case 1:return t.sent(),Office.onReady().then((function(t){t.addin?("Hidden"==t.addin.visibilityMode&&((0,h.cY)("hostAndPlatform.addin.visibilityMode: Hidden"),re=(new Date).getTime(),_e=!0,ge(),e(),oe.I.setValue({iteration:oe.I.getValue().iteration+1})),Office.addin.onVisibilityModeChanged((function(e){if(g.B.getInstance().sendVisibilityModeChangedTelemetry(e.visibilityMode),e.visibilityMode==T.DwS){if((0,h.cY)("Office.addin.onVisibilityModeChanged: Taskpane"),de){var t=d.Vv.getSetting(d.zj.CopilotPaneStartTimestamp);g.B.getInstance().sendLatencyTelemetry([{key:f.CT.FeatureName,value:f.CC.ShowPreloadedCopilot},{key:f.CT.UserCopilotPaneLoadTime_PreloadTime,value:(0,E.WUi)(t)}],!0),de=!1}_e=!1,g.B.getInstance().releaseHeldTelemetryEvents(),pe(!1),(0,se.El)()}else e.visibilityMode==T.HoP&&((0,h.cY)("Office.addin.onVisibilityModeChanged: Hidden"),pe(!0),ae.w.setValue({iteration:ae.w.getValue().iteration+1}),(0,y.IbI)()&&((0,h.cY)("Cleaning up App Settings"),(0,ce.V)()))}))):((0,h.cY)("hostAndPlatform.addin is null"),e())})).catch((function(e){(0,h.cY)("Office.onReady() error: "+e)})),Office.actions.associate("ShowPreloadedCopilot",(function(e){var t;de=!0,e&&(e.copilotPaneStartTimestamp&&(0,C.eV)(e.copilotPaneStartTimestamp),d.Vv.setHostSettings(e)),ie.U.setValue({iteration:ie.U.getValue().iteration+1}),(0,h.cY)("ShowPreloadedCopilot, showAsTaskPane with arg",e),_e=!1,g.B.getInstance().sendChatEventTelemetry((0,C.pN)((t={},(0,o._)(t,f.h3.ChatEventType,f.a5.ShowPreloadedCopilot),(0,o._)(t,f.h3.ChatEventParameters,(new Date).getTime()),t))),Office.addin.showAsTaskpane()})),Office.actions.associate("PreloadCopilot",(function(){fe()||(re=(new Date).getTime(),ge(),e())})),[2]}}))}));return function(){return e.apply(this,arguments)}}();he()},822606:(e,t,n)=>{"use strict";n.d(t,{$9:()=>h,$H:()=>x,Ay:()=>Y,Bx:()=>c,CR:()=>Z,D0:()=>Q,Fq:()=>s,H9:()=>w,IQ:()=>u,KA:()=>L,Kd:()=>V,Lx:()=>J,MH:()=>M,Mv:()=>z,Ng:()=>k,O1:()=>P,OZ:()=>f,Os:()=>i,Sh:()=>m,TZ:()=>I,Td:()=>q,VQ:()=>D,VS:()=>j,W2:()=>S,Xt:()=>r,aE:()=>A,ae:()=>H,bX:()=>E,cU:()=>W,de:()=>_,f4:()=>T,g5:()=>N,hf:()=>b,iX:()=>p,kB:()=>U,nG:()=>K,np:()=>g,oM:()=>R,oU:()=>B,p0:()=>l,pS:()=>y,ps:()=>G,qA:()=>C,qO:()=>d,rb:()=>F,s_:()=>O,u1:()=>a,w3:()=>v,x6:()=>$,yG:()=>X});var r,o=n(475119),a="",i="shimmer",s=10,c="CopilotAgentsPage",l="-version",u=function(){return"I wasn't able to apply a sensitivity label to this file. Please choose another file or try again."};!function(e){e.AtMention="AtMention",e.SwitcherMenu="SwitcherMenu",e.FooterButton="FooterButton"}(r||(r={}));var d=3e4,_=function(){return(0,o.Cs)()?OfficeaicopilotStrings.PersonalizationProfileErrorResponse:"Sorry, something went wrong. Please try again in a moment or ask me to help with something else."},p="ProfileId",g=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ConfirmButtonLabel:"Confirm"},f=function(){return(0,o.Cs)()?OfficeaicopilotStrings.DeleteButtonLabel:"Delete"},h="Copilot Extensions Dialog",C="3068386c-7a16-4f6a-a664-043b6b232816",m=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored."},v=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that can’t be applied when a file is read-only."},E=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file."},y=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},b=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions."},T=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},I=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels."},P=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption."},A=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file."},D=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},S=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label."},M=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},O=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View."},k=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard."},L=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label."},w=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},R=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},U=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},B="00000003-0000-0ff1-ce00-000000000000",x=function(){return(0,o.Cs)()?OfficeaicopilotStrings.SpeakWithCopilotText:"Speak with Copilot"},W=function(){return(0,o.Cs)()?OfficeaicopilotStrings.PromptGuideMenuItemSpeakWithCopilot:"Speak with Copilot about document insights"},F=function(){return(0,o.Cs)()?OfficeaicopilotStrings.SpeakWithCopilotResponseMessage:"Sure! I can answer questions and summarize key points from this document. Click 'Speak with Copilot' to start."},N=function(){return(0,o.Cs)()?OfficeaicopilotStrings.SpeakWithCopilotAutoStartResponseMessage:"Sure! I can answer questions and summarize key points from this document. Entering conversational voice mode..."},K=5,H=2,G="https://go.microsoft.com/fwlink/?linkid=2271054",Q="div[data-testid='MsgExtCardPreview']",j=function(){return(0,o.Cs)()?OfficeaicopilotStrings.RelatedFilesTabTitle:"Related Files"},Y="RelatedFilesTab",z=function(){return(0,o.Cs)()?OfficeaicopilotStrings.RelatedFilesSuggestion1:"List key points"},q=function(){return(0,o.Cs)()?OfficeaicopilotStrings.RelatedFilesSuggestion2:"Extract action items"},V=function(){return(0,o.Cs)()?OfficeaicopilotStrings.RelatedFilesSuggestion3:"Ask about this"},Z=function(){return"Ask follow-up questions for deeper insights on these files."},J=function(){return(0,o.Cs)()?OfficeaicopilotStrings.RelatedFilesPromptSuffix:" of the file"},X=function(){return(0,o.Cs)()?OfficeaicopilotStrings.RelatedFilesSuggestedPromptsHeader:"Suggested Prompts"},$=3},828801:(e,t,n)=>{"use strict";n(197627)},832713:(e,t,n)=>{"use strict";n.d(t,{Eb:()=>y,Q9:()=>m,qH:()=>E,yu:()=>v});var r,o=n(743032),a=n(990813),i=n(379490),s=n(606363),c=n(602061),l=n(242154),u=n(556117),d=n(656904),_=n(598309),p=n(862853),g=n(740389),f=n(448397),h=n(769449),C=n(140889),m=function(e){if((0,g.Wdf)())return(0,c.Q9t)(e);var t,n;(0,l.cY)("Fetching clpSensitivityIndicatorData");var r={iconType:b(e.encryptionType)?u.JF.Encryption:u.JF.NonEncryption,tooltipText:null!==(t=e.description)&&void 0!==t?t:"",badgeText:null!==(n=e.displayName)&&void 0!==n?n:""};return(0,l.cY)("Returning clpSensitivityIndicatorData as"+JSON.stringify(r)),r},v=function(){if((0,g.Wdf)())return(0,c.yu7)();if((0,p.q0)()){(0,l.cY)("Fetching CLP label info..");var e=s.n.getInstance().getInDocSensitiveLabelInfo();if((0,l.cY)("Label is : ".concat(JSON.stringify(e))),e.labelId)return(0,l.cY)("Doc is labelled"),e}},E=(r=(0,o._)((function(e){var t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return(0,g.Wdf)()?[2,(0,c.qHb)(e)]:e?(t={labelId:e.id,tenantId:e.tenantId},[4,s.n.getInstance().getHighestDocumentSensitivityInfo([t])]):[3,2];case 1:return n=r.sent(),[2,m(n)];case 2:return[2,{tooltipText:(0,d.IQ6)(),iconType:u.JF.Warning}];case 3:return[2]}}))})),function(e){return r.apply(this,arguments)}),y=function(){var e=(0,o._)((function(e,t){var n,r,o,l,u,p,m,v;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return(0,g.Wdf)()?[2,(0,c.Ebk)(e,t)]:(n=s.n.getInstance().getInDocSensitiveLabelInfo(),(0,_.cy)()?[4,s.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]:[3,3]);case 1:return r=i.sent(),[4,s.n.getInstance().getHighestDocumentSensitivityInfo([s.n.getInstance().getInDocSensitiveLabelInfo(),r])];case 2:(n=i.sent()).isDke=r.isDke,n.hasExtractForUser=r.hasExtractForUser,i.label=3;case 3:return u={id:n.labelId,displayName:null!==(o=n.displayName)&&void 0!==o?o:"",tooltip:n.description,color:n.color,isEncrypted:b(n.encryptionType),priority:null!==(l=n.order)&&void 0!==l?l:0},p={documentSensitivity:u,documentURL:t,hasExtract:n.labelId===d.u1i||n.hasExtractForUser,isDKE:n.labelId!==d.u1i&&n.isDke},m={copilotConfig:e(),documentConfig:p},f.B.getInstance().sendChatEventTelemetry((0,h.pN)((v={},(0,a._)(v,C.h3.ChatEventType,C.a5.CopilotConfig),(0,a._)(v,C.h3.ChatEventParameters,JSON.stringify(m.copilotConfig)),v))),[2,m]}}))}));return function(t,n){return e.apply(this,arguments)}}();function b(e){return(0,g.Wdf)()?(0,c.d9E)(e):e!==c.TzT.None}},837963:(e,t,n)=>{"use strict";n.d(t,{$:()=>u});var r=n(208520),o=n(475119),a=n(423654),i=n(822400),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)};function c(e){return{user:"human",message:e,disableLinksProcessing:!1,shouldApplyInputLinkTheme:!0}}var l=r.memo((function(e){var t=e.markdownText,n=e.styles,l=void 0===n?{}:n,u=(0,o.bt)((0,a.bM)(),l);return r.createElement(i.A,{styles:u,body:s({},c(t))})})),u=function(e){return r.createElement(l,s({},e))}},844807:(e,t,n)=>{"use strict";n.d(t,{r:()=>i});var r=n(811912),o=n(791165),a=n(990813),i=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,null,[{key:"generateId",value:function(){return e.operationId++,"AugLoopChatWord"+e.operationId.toString()}}]),e}();(0,a._)(i,"operationId",0)},846863:(e,t,n)=>{"use strict";n.d(t,{Xg:()=>r,fO:()=>a,zk:()=>o});var r={name:"word_OfficeJS_get_object",description:"Gets global Word objects\n          propertyName: Name of the property. Can be one of ...\n                Document, ActiveDocument, Range",inputSchema:{type:"object",properties:{propertyName:{title:"PropertyName",type:"string"}},required:["propertyName"],additionalProperties:!1,$schema:"https://json-schema.org/draft-07/schema#"}},o={name:"word_OfficeJS_RunCodeOnDocument",description:'Use this tool if you need to query or make modifications to an Document object\n  in the currently running instance of Microsoft Word. The passed "code" MUST use this_Document for the Document\n  object, and don\'t use context.document in the code.\n  Args: this_Document_wordObjId: The GUID of the Document object to run code on.\n  This object will be "code" parameter below as this_Document\n\n  code: OfficeJS code to execute. OfficeJS code must be in format as below -\n    (async () => {\n    try {\n      await Word.run(this_Document: Word.Document, async (context) => {\n            <insert your code here>\n            await context.sync();\n            this_Document.untrack();\n            return "Successfully executed the code on Document object";\n      });\n    } catch (error) {\n      return ("Error: " + error.message);\n    }\n  })();\n\n  Returned result can be used as input for jsonify.',inputSchema:{type:"object",properties:{this_Document_wordObjId:{title:"This Document Wordobjid",type:"string"},code:{title:"Code",type:"string"}},required:["this_Document_wordObjId","code"],additionalProperties:!1,$schema:"https://json-schema.org/draft-07/schema#"}},a={name:"word_OfficeJS_RunCodeOnRange",description:'Use this tool if you need to query or make modifications to an Range object\n  in the currently running instance of Microsoft Word. The code MUST use this_Range for the\n  Range object, and don\'t get the Range object from context.\n  Args:\n  this_Range_wordObjId: The GUID of the Range object to run code on.\n  This object will be used in "code" argument as this_Range\n\n  (async () => {\n    try {\n      await Word.run(this_Range, async (context) => {\n            <insert your code here to use this_Range as the Word.Range object>\n            await context.sync();\n            this_Range.untrack();\n            return (<result>);\n      });\n    } catch (error) {\n      return ("Error: " + error.message);\n    }\n  })();\n  Should always resolve result that can be used as input for jsonify.',inputSchema:{type:"object",properties:{this_Range_wordObjId:{title:"This Range Wordobjid",type:"string"},code:{title:"Code",type:"string"}},required:["this_Range_wordObjId","code"],additionalProperties:!1,$schema:"https://json-schema.org/draft-07/schema#"}}},847588:(e,t,n)=>{"use strict";n.d(t,{B:()=>p});var r=n(857835),o=n(461838),a=n(208520),i=n(242154),s=n(110213),c=n(801744),l=n(740389),u=n(656904),d=n(602061),_=a.lazy((function(){return Promise.all([n.e(9037),n.e(9412),n.e(3181)]).then(n.bind(n,110571)).then((function(e){return{default:e.LazyLoadedDesigner}}))})),p=function(e,t,n,p,g,f,h,C){(0,i.cY)("Designer Init: useDesignerCard");return{DesignerCard:function(m){var v;(0,i.cY)("Designer Init: useDesignerCard render"),m.clientSessionId&&(t.sessionId=m.clientSessionId),m.turnId&&(t.correlationId=m.turnId),t.insertMode=null===(v=m.shouldShowInsertButton)||void 0===v||v,p&&p.accountInfo&&(m.objectId&&!p.accountInfo.userId&&(p.accountInfo.userId=m.objectId),m.tenantId&&!p.accountInfo.tenantId&&(p.accountInfo.tenantId=m.tenantId));var E,y=(0,d.Djx)(),b=(0,l.Tby)()?(0,u.fS0)():(0,u.xvH)();return a.createElement("div",{className:y.root},a.createElement(s.c,null,null!==(E=m.cardHeaderText)&&void 0!==E?E:b),a.createElement(a.Suspense,{fallback:a.createElement("div",{className:y.spinnerContainer},a.createElement(c.y,{size:"extra-tiny"}))},a.createElement(_,(0,o._)((0,r._)({},m),{insertImagesInCanvas:e,hostCallback:n,hostTokenProvider:p,onDesignerCustomize:g,clientSettings:t,handleDesignerHistoryEvent:f,handleDesignerError:h,handleDesignerTelemetry:C,isChatHistoryRehydration:m.isChatHistoryRehydration}))))}}}},849145:(e,t,n)=>{"use strict";n.d(t,{$:()=>r.$});var r=n(352929)},850333:(e,t,n)=>{"use strict";e.exports=n.p+"assets/agent-store-card.gif"},851910:(e,t,n)=>{"use strict";n.d(t,{T:()=>o});var r=n(208520),o=function(){return r.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.createElement("path",{d:"M13.6696 3.98972C13.469 3.39807 12.9137 3 12.2889 3L11.3884 3C10.6873 3 10.0855 3.49905 9.95572 4.18803L9.02441 9.13282L9.48743 7.54883C9.66914 6.92722 10.2391 6.5 10.8867 6.5L13.7655 6.5L15.01 8.12858L16.118 6.5L15.5658 6.5C14.9411 6.5 14.3858 6.10193 14.1852 5.51027L13.6696 3.98972Z",fill:"url(#paint0_radial_1429_128522)"}),r.createElement("path",{d:"M6.50309 16.0036C6.70167 16.5987 7.25866 17 7.88598 17H9.35221C10.148 17 10.7967 16.3619 10.8099 15.5662L10.883 11.1348L10.4977 12.4516C10.3158 13.073 9.74595 13.5 9.09849 13.5L6.20857 13.5L4.97822 12.4147L4.07031 13.5H4.61719C5.24451 13.5 5.80149 13.9013 6.00008 14.4964L6.50309 16.0036Z",fill:"url(#paint1_radial_1429_128522)"}),r.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint2_linear_1429_128522)"}),r.createElement("path",{d:"M12.0004 3H6.16755C4.50102 3 3.50109 5.20235 2.83448 7.40471C2.04471 10.0139 1.01129 13.5035 4.00105 13.5035H6.69024C7.34194 13.5035 7.91403 13.0727 8.09306 12.4461C8.52129 10.9472 9.32308 8.15282 9.94795 6.04403C10.2543 5.01026 10.5094 4.12243 10.901 3.56954C11.1206 3.25958 11.4865 3 12.0004 3Z",fill:"url(#paint3_linear_1429_128522)"}),r.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint4_radial_1429_128522)"}),r.createElement("path",{d:"M8 17.0004H13.8329C15.4994 17.0004 16.4993 14.7983 17.166 12.5962C17.9557 9.98726 18.9891 6.49805 15.9994 6.49805H13.3102C12.6585 6.49805 12.0864 6.92885 11.9073 7.55545C11.4791 9.05414 10.6773 11.8482 10.0525 13.9567C9.74615 14.9904 9.49099 15.8781 9.0994 16.4309C8.87985 16.7408 8.51395 17.0004 8 17.0004Z",fill:"url(#paint5_linear_1429_128522)"}),r.createElement("defs",null,r.createElement("radialGradient",{id:"paint0_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(15.0851 9.1729) rotate(-128.772) scale(6.41931 6.01261)"},r.createElement("stop",{offset:"0.0955758",stopColor:"#00AEFF"}),r.createElement("stop",{offset:"0.773185",stopColor:"#2253CE"}),r.createElement("stop",{offset:"1",stopColor:"#0736C4"})),r.createElement("radialGradient",{id:"paint1_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.30628 13.0661) rotate(51.1538) scale(5.67928 5.53958)"},r.createElement("stop",{stopColor:"#FFB657"}),r.createElement("stop",{offset:"0.633728",stopColor:"#FF5F3D"}),r.createElement("stop",{offset:"0.923392",stopColor:"#C02B3C"})),r.createElement("linearGradient",{id:"paint2_linear_1429_128522",x1:"5.81844",y1:"4.2727",x2:"6.65052",y2:"13.8998",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:"0.156162",stopColor:"#0D91E1"}),r.createElement("stop",{offset:"0.487484",stopColor:"#52B471"}),r.createElement("stop",{offset:"0.652394",stopColor:"#98BD42"}),r.createElement("stop",{offset:"0.937361",stopColor:"#FFC800"})),r.createElement("linearGradient",{id:"paint3_linear_1429_128522",x1:"6.54577",y1:"3",x2:"7.00014",y2:"13.5035",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{stopColor:"#3DCBFF"}),r.createElement("stop",{offset:"0.246674",stopColor:"#0588F7",stopOpacity:"0"})),r.createElement("radialGradient",{id:"paint4_radial_1429_128522",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(16.299 5.46979) rotate(109.281) scale(13.9554 16.7229)"},r.createElement("stop",{offset:"0.0661714",stopColor:"#8C48FF"}),r.createElement("stop",{offset:"0.5",stopColor:"#F2598A"}),r.createElement("stop",{offset:"0.895833",stopColor:"#FFB152"})),r.createElement("linearGradient",{id:"paint5_linear_1429_128522",x1:"16.7598",y1:"5.85685",x2:"16.7539",y2:"8.71732",gradientUnits:"userSpaceOnUse"},r.createElement("stop",{offset:"0.0581535",stopColor:"#F8ADFA"}),r.createElement("stop",{offset:"0.708063",stopColor:"#A86EDD",stopOpacity:"0"}))))}},854546:(e,t,n)=>{"use strict";n.d(t,{L:()=>s});var r=n(489231),o=n(817206),a=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},i=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=function(){function e(e,t,n,r,o){this.msalFor1PResources=e,this.msalFor3PResources=t,this.accountProvider=n,this.interactiveTokenQueue=r,this.msalModule=o}return e.prototype.create1PTokenAcquisition=function(e){return new r.h(this.msalFor1PResources,this.accountProvider,this.interactiveTokenQueue,this.msalModule,e)},e.prototype.create3PTokenAcquisition=function(){return new o.o(this.msalFor3PResources,this.accountProvider,this.interactiveTokenQueue,this.msalModule)},e.prototype.acquire1PToken=function(e,t){return a(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.create1PTokenAcquisition(t).acquireToken(e)]}))}))},e.prototype.acquire3PToken=function(e){return a(this,void 0,void 0,(function(){return i(this,(function(t){return[2,this.create3PTokenAcquisition().acquireToken(e)]}))}))},e}()},858703:(e,t,n)=>{"use strict";n.d(t,{W2:()=>p,Xd:()=>d,qG:()=>C,qo:()=>f});var r,o=n(743032),a=n(379490),i=n(242154),s=n(602061),c=n(862853),l=n(722603),u=n(740389);function d(){return _.apply(this,arguments)}function _(){return(_=(0,o._)((function(){var e;return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,p()];case 1:return e=t.sent(),(0,c.Kw)(e),[2]}}))}))).apply(this,arguments)}function p(){return g.apply(this,arguments)}function g(){return(g=(0,o._)((function(){var e,t,n;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:e=s.utd.Unknown,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 2:switch(t=r.sent(),(0,i.cY)("Primary Identity Info is : ",JSON.stringify(t)),t.identityType){case"OrganizationAccount":e=s.utd.Enterprise;break;case"MicrosoftAccount":e=s.utd.Consumer;break;default:e=s.utd.Unknown}return[3,4];case 3:return n=r.sent(),(0,i.cY)("Error fetching Identity Info :",n),[3,4];case 4:return[2,e]}}))}))).apply(this,arguments)}function f(){return h.apply(this,arguments)}function h(){return(h=(0,o._)((function(){var e,t,n;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:e="",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstPartyAuth.getPrimaryIdentityInfo()];case 2:return t=r.sent(),(0,i.cY)("Primary Identity Info is : ",JSON.stringify(t)),e=t.email,[3,4];case 3:return n=r.sent(),(0,i.cY)("Error fetching Identity Info :",n),[3,4];case 4:return[2,e]}}))}))).apply(this,arguments)}function C(){return m.apply(this,arguments)}function m(){return(m=(0,o._)((function(){var e,t,n;return(0,a.__generator)(this,(function(r){switch(r.label){case 0:e=0,r.label=1;case 1:return r.trys.push([1,7,,8]),(0,u.Xp$)()?l.i.isWebPlatform()?(e=1,[3,4]):[3,2]:[3,5];case 2:return l.i.isWin32Platform()||l.i.isMacPlatform()?[4,OfficeFirstPartyAuth.getIdentities()]:[3,4];case 3:t=r.sent(),(0,i.cY)("All Identity Info is : ",JSON.stringify(t)),e=t.length,r.label=4;case 4:return[3,6];case 5:(0,i.cY)("isEarlyZQMLoadingEnabled flight is not enabled"),r.label=6;case 6:return[3,8];case 7:return n=r.sent(),(0,i.cY)("Error fetching All Identity Info :",n),[3,8];case 8:return(0,c.S3)(e),[2]}}))}))).apply(this,arguments)}!function(e){e.ODP="MicrosoftAccount",e.ODB="OrganizationAccount",e.Unsupported="Unsupported"}(r||(r={}))},860093:(e,t,n)=>{"use strict";n.d(t,{BA:()=>s,DH:()=>i,nL:()=>a});var r=n(656904),o=n(208276),a=function(e){var t,n,o,a="I don't yet support %s. For a list of supported languages, please visit ",i=new Intl.DisplayNames([Office.context.displayLanguage],{type:"language"}),s=new Intl.DisplayNames(["en"],{type:"language"}),c=i.of(e),l=s.of(e);if(c&&l){var u=(0,r.Csj)()?WordCopilot.CopilotUnsupportedLanguageError:a;a===u&&(c=l),n=u,o=c.toLocaleLowerCase(e),t=n.replace("%s",o)}return t},i=function(e){e!==r.vy2?(0,o.V6)():(0,o.bY)()},s=function(e){try{return JSON.parse(e).message||""}catch(e){return""}}},862853:(e,t,n)=>{"use strict";n.d(t,{Cr:()=>m,II:()=>P,Kw:()=>E,LA:()=>d,S3:()=>C,W2:()=>T,Yw:()=>A,gc:()=>p,gx:()=>c,j3:()=>f,pX:()=>u,q0:()=>y,sQ:()=>b,u$:()=>g,w5:()=>s});var r=n(242154),o=n(602061),a=n(740389);var i=!1;function s(){return i}function c(e){i=e}var l=!1;function u(){return l}function d(e){l=e}var _=!1;function p(){return _}function g(e){_=e}function f(e){e&&(_=e.webGroundingEnabled,l=e.enterpriseGroundingEnabled)}var h=!1;function C(e){(0,r.cY)("User Type count as : "+e),h=1==e}function m(){return h}var v=o.utd.Unknown;function E(e){(0,r.cY)("Setting User Type as : "+e),v=e}function y(){return v===o.utd.Enterprise}function b(){return v===o.utd.Consumer}function T(){return(0,r.cY)("User Type stored is : "+v),v}var I=!0;function P(){return!(!I||!(0,a.Nx$)())&&(d(!1),!0)}function A(){I=!1}},863165:(e,t,n)=>{"use strict";n.d(t,{u:()=>c});var r=n(217425),o=n(632197),a=n(475119),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i,c;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),n=null!=t?t:r.w8.ic3,[4,e.getToken(n,void 0,["".concat(n,"/Media.ReadWrite.All")])];case 1:return i=s.sent(),[2,(0,o.t)(i)];case 2:throw c=s.sent(),(0,a.cY)("Error fetching IC3 token:",c),c;case 3:return[2]}}))}))}},863958:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var r,o=n(208520),a=n(475119),i=n(423905),s=n(690579),c=n(359474),l=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};const _=function(e){function t(t){var n=e.call(this,t)||this;return n.handleRefreshButtonOnClick=function(){window.location.reload()},n.handleCopyErrorButtonOnClick=function(){return u(n,void 0,void 0,(function(){var e,t,n,r,o,i,s,c;return d(this,(function(l){switch(l.label){case 0:e=null!==(i=null===(o=this.state.error)||void 0===o?void 0:o.message)&&void 0!==i?i:"No error message",t=null!==(c=null===(s=this.state.error)||void 0===s?void 0:s.stack)&&void 0!==c?c:"No error stack",n="Error Message: "+e+"\n Error Stack: "+t,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,navigator.clipboard.writeText(n)];case 2:return l.sent(),[3,4];case 3:return r=l.sent(),(0,a.cY)("ErrorBoundary: Error in handleCopyErrorButtonOnClick -> error",r),[3,4];case 4:return[2]}}))}))},n.state={hasError:!1,error:void 0},n}return l(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0,error:e}},t.prototype.componentDidCatch=function(e){(0,a.cY)("ErrorBoundary caught an error ",e),(0,a.sZ)(),this.props.errorLogOverride?this.props.errorLogOverride(e):(0,i.Wx)(e.name+": "+e.message)},t.prototype.render=function(){return this.state.hasError?o.createElement(c.q,{theme:this.props.copilotChatTheme,dir:this.props.copilotChatTheme.dir},o.createElement(s.A,{handleRefreshButtonOnClick:this.handleRefreshButtonOnClick,handleErrorButtonOnClick:this.handleCopyErrorButtonOnClick,errorBoundaryImagePath:this.props.errorBoundaryImagePath})):this.props.children},t}(o.Component)},881707:(e,t,n)=>{"use strict";n.d(t,{n:()=>C});var r=n(822606),o=n(116510),a=n(556117),i=n(660606),s=n(638753),c=n(423905),l=n(61714),u=n(755657),d=n(241273),_=function(){return _=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},_.apply(this,arguments)},p=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},g=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},f=null,h=(0,l.A)(),C=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:r.u1,tenantId:r.u1},this.externalDocLabelInfo={labelId:r.u1,tenantId:r.u1},this.inDocLabelInfo.labelId=r.u1,this.inDocLabelInfo.tenantId=r.u1,this.externalDocLabelInfo.labelId=r.u1,this.externalDocLabelInfo.tenantId=r.u1}return e.getInstance=function(t,n,r,o,a){return(0,s.hX)(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),(0,s.hX)(t)||(e.clpSensitivityHandler.setBasicChatProps=t),(0,s.hX)(n)||(e.clpSensitivityHandler.setChatUiProps=n),(0,s.hX)(r)||(e.clpSensitivityHandler.copilotChatRef=r),(0,s.hX)(o)||(e.clpSensitivityHandler.removeCurrentContextId=o),(0,s.hX)(a)||(e.clpSensitivityHandler.getShouldStopLoadingUi=a),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return p(this,void 0,void 0,(function(){var e,t,n;return g(this,(function(r){switch(r.label){case 0:if(null===(n=i.t6.IsCopilotInBackstageMode)||void 0===n?void 0:n.call(i.t6))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=r.sent(),this.setInDocSensitivityLabelInfo(e),(0,c.Zy)("setInDocSensitiveLabelInfoUsingOfcJs"),[3,4];case 3:return t=r.sent(),(0,c.mQ)("error in getLabel Api: ".concat(t.message),t.code,t.stack),(0,u.Uk)(this.copilotChatRef,t.code,d.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return p(this,void 0,void 0,(function(){var e,t,n;return g(this,(function(o){switch(o.label){case 0:if((0,i.cY)("Getting label"),e={labelId:r.u1,tenantId:r.u1},null===(n=i.t6.IsCopilotInBackstageMode)||void 0===n?void 0:n.call(i.t6))return[2,e];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=o.sent(),(0,c.Zy)("getLabel"),[3,4];case 3:return t=o.sent(),(0,c.mQ)("error in getLabel Api : ".concat(t.message),t.code,t.stack),(0,u.Uk)(this.copilotChatRef,t.code,d.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return(0,i.cY)("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;(0,i.cY)("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(n){var r,i;return _(_({},n),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(r=e.description)&&void 0!==r?r:"",badgeText:null!==(i=e.displayName)&&void 0!==i?i:"",iconType:e.encryptionType!==o.T.None?a.JF.Encryption:a.JF.NonEncryption}:void 0})})),this.setChatUiProps&&this.shouldShowInDocSensitivityLabel()&&this.setChatUiProps((function(e){return _(_({},e),{documentSensitivityProps:t.getSensitivity()})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return p(this,void 0,void 0,(function(){var t;return g(this,(function(n){switch(n.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:r.u1}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):((0,i.cY)("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:n.sent(),this.labelChangedFromChatHistory=!1,n.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?((0,i.cY)("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return n.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){return p(this,arguments,void 0,(function(e,t){var n,a,s,l,_,C,m,v,E=this;return void 0===t&&(t=!1),g(this,(function(y){switch(y.label){case 0:if((0,c.Zy)("tryUpgradeLabel"),t&&!function(e){var t,n=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;return null!=(null===(t=e.labelId)||void 0===t?void 0:t.match(n))}(e))return(0,i.cY)("Invalid label",e),(0,c.mQ)("Invalid label format id: ".concat(e.labelId),o.q[o.q.E_APPLYLABEL_FAIL],""),[2,{status:o.q[o.q.E_APPLYLABEL_FAIL],errorMessage:"Invalid label format"}];if(null===(m=i.t6.IsCopilotInBackstageMode)||void 0===m?void 0:m.call(i.t6))return(0,i.cY)("Upgrading sensitivity label disabled in backstage mode"),[2,{status:o.q[o.q.E_APPLYLABEL_FAIL],errorMessage:"disabled in backstage mode"}];(0,i.cY)("Upgrading sensitivity label: ".concat(JSON.stringify(e))),n=o.q[o.q.S_APPLYLABEL_OK],a=r.u1,y.label=1;case 1:return y.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,h)];case 2:return y.sent(),[2,{status:o.q[o.q.S_APPLYLABEL_OK]}];case 3:return s=function(){return p(E,void 0,void 0,(function(){return g(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,h)]}catch(e){(0,c.mQ)("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code,e.stack),a=(0,u.Uk)(this.copilotChatRef,e.code,d.OZ.CLP_Upgrade,this.removeCurrentContextId),(0,i.cY)("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),n=e.message}return[2]}))}))},l=new Promise((function(e){f=e})),_=new Promise((function(e,t){var n=r.qO;setTimeout((function(){return t(new Error("CallbackTimeout"))}),n)})),[4,Promise.race([Promise.all([l,s()]),_])];case 4:y.sent(),y.label=5;case 5:return[3,7];case 6:return C=y.sent(),(0,c.mQ)("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(C.message),C.code,C.stack),(0,u.Uk)(this.copilotChatRef,C.code,d.OZ.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===C.message?(0,i.cY)("Callback Timeout"):(0,i.cY)("Exception while upgrading sensitivity label: ".concat(C.message,", error code: ").concat(C.code)),n=null!==(v=o.q[C.message])&&void 0!==v?v:C.message,[3,7];case 7:return f=null,[2,{status:n,errorMessage:a}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){var t;if(null===(t=i.t6.IsCopilotInBackstageMode)||void 0===t?void 0:t.call(i.t6))(0,i.cY)("setting label change EventListener disabled in backstage mode");else try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:m),(0,c.Zy)("Label Change Event Listener"),(0,i.cY)("Sensitivity Label Change Event Listener Set")}catch(e){(0,c.mQ)("error in setting listener for CLP : ".concat(e.message),e.code,e.stack),(0,u.Uk)(this.copilotChatRef,e.code,d.OZ.CLP_Upgrade,this.removeCurrentContextId),(0,i.cY)("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return p(this,void 0,void 0,(function(){var t,n,r;return g(this,(function(o){switch(o.label){case 0:if(null===(r=i.t6.IsCopilotInBackstageMode)||void 0===r?void 0:r.call(i.t6))return(0,i.cY)("update external doc sensitivity label disabled in backstage mode"),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=o.sent(),(0,i.cY)("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),(0,c.Zy)("External Doc HighestSensitivityLabel"),[3,4];case 3:return n=o.sent(),(0,c.mQ)("error in HighestSensitivityLabel Api : ".concat(n.message),n.code,n.stack),(0,u.Uk)(this.copilotChatRef,n.code,d.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while updating external doc sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return p(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return p(this,void 0,void 0,(function(){var t,n,o;return g(this,(function(a){switch(a.label){case 0:if(t={labelId:r.u1,tenantId:r.u1},null===(o=i.t6.IsCopilotInBackstageMode)||void 0===o?void 0:o.call(i.t6))return(0,i.cY)("getHighestDocumentSensitivityInfo disabled in backstage mode"),[2,t];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=a.sent(),(0,i.cY)("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),(0,c.Zy)("HighestSensitivityLabel"),[3,4];case 3:return n=a.sent(),(0,c.mQ)("error in HighestSensitivityLabel Api : ".concat(n.message),n.code,n.stack),(0,u.Uk)(this.copilotChatRef,n.code,d.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while fetching highest sensitivity label: ".concat(n.message,", error code: ").concat(n.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return p(this,void 0,void 0,(function(){var t;return g(this,(function(n){switch(n.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=n.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==o.T.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){(0,i.cY)("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return(0,c.Zy)("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===r.u1)),this.externalDocLabelInfo.labelId!==r.u1&&i.t6.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return(0,c.Zy)("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===r.u1)),this.inDocLabelInfo.labelId!==r.u1&&i.t6.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==o.T.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==o.T.None},e}();function m(e,t,n,r){return p(this,void 0,void 0,(function(){return g(this,(function(a){switch(a.label){case 0:return(0,i.cY)("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(n,", error: ").concat(r)),(0,c.Zy)("Label change callback received, context:  ".concat(n)),f&&n===h&&(f("ignore"),f=null),r!==o.q.S_APPLYLABEL_OK?((0,c.mQ)("error in upgrading label : ".concat(r),r.code,r.stack),[2]):i.t6.IsClpEnabledInEnterpriseForSydney()&&(C.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,C.getInstance().setSensitivityLabelToHighestSensitivity([C.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return a.sent(),[2];case 2:return i.t6.IsApplyLabelUsingTryUpgradeLabelEnabled(),C.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}},886461:(e,t,n)=>{"use strict";n.d(t,{j:()=>u});var r=n(208520),o=n(260623),a=n(529404),i=n(891585),s=n(397574),c=n(287150),l=(0,o.n)({container:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",height:"36px",padding:"6px 16px",gap:"2px",borderBottom:"1px solid ".concat(a.L.colorNeutralStroke1),boxShadow:"0 4px 2px -2px ".concat(a.L.colorNeutralShadowAmbient)},leftSection:{display:"flex",alignItems:"center",gap:"8px"},text:{color:a.L.colorNeutralForeground3,fontFamily:a.L.fontFamilyBase,fontSize:a.L.fontSizeBase200,fontStyle:"normal",fontWeight:a.L.fontWeightSemibold,lineHeight:a.L.lineHeightBase200},button:{border:"none",fontWeight:600,backgroundColor:a.L.colorNeutralBackground1Hover,"&:hover":{backgroundColor:a.L.colorNeutralBackground1Hover}},smallIcon:{width:"20px",height:"20px",color:a.L.colorNeutralForeground3}}),u=function(e){var t=l();return r.createElement("div",{className:t.container},r.createElement("div",{className:t.leftSection},r.createElement(s.Qem,{className:t.smallIcon}),r.createElement("span",{className:t.text},"Understand with Copilot")),r.createElement(i.$,{className:t.button,icon:r.createElement(c.urQ,{className:t.smallIcon}),onClick:e}))}},886621:(e,t,n)=>{"use strict";n.d(t,{iF:()=>ce,Jv:()=>pe,uC:()=>se});var r=n(743032),o=n(857835),a=n(461838),i=n(379490),s=n(656904),c=n(249002),l=n(962304),u=n(644275),d=n(606363),_=n(722603),p=n(740389),g=n(965974),f=n(851348),h=n(928499),C=n(242154),m=n(862853),v=n(598309),E=n(257490),y=n(288003),b=n(340367),T=n(244157),I=n(69756),P=n(251395),A=n(526057);var D=n(634694);function S(e){return{suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle2(),suggestionText:s.qvg.ProactiveZQMForDocWithContentTitleText2(),suggestionId:s.zYi.ProactiveZQMForDocWithContentTitleText2,iconRegular:D.uJg,shouldSubmitQueryOnClick:e,telemetryData:(0,b.OK)(s.qvg.ProactiveZQMForDocWithContentTitleText2())}}function M(e){return{suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle4(),suggestionText:s.qvg.ProactiveZQMForDocWithContentTitleText4(),suggestionId:s.zYi.ProactiveZQMForDocWithContentTitleText4,iconRegular:D.uJg,shouldSubmitQueryOnClick:e,telemetryData:(0,b.OK)(s.qvg.ProactiveZQMForDocWithContentTitleText4())}}function O(e){return{suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle7(),suggestionText:s.qvg.ProactiveZQMForDocWithContentTitleText7(),suggestionId:s.zYi.ProactiveZQMForDocWithContentTitleText7,iconRegular:D.uJg,shouldSubmitQueryOnClick:e,telemetryData:(0,b.OK)(s.qvg.ProactiveZQMForDocWithContentTitleText7())}}function k(e){var t=[S(e),M(e),O(e)];return(0,v.MP)()?(t.push({suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle1(),suggestionText:s.ipg.WhatDocSaysAboutTopic(),suggestionId:s.vYk.WhatDocSaysAboutTopic,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.ipg.WhatDocSaysAboutTopic())}),t.push({suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle3(),suggestionText:s.ipg.ProsAndConsOfTopic(),suggestionId:s.vYk.ProsAndConsOfTopic,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.ipg.ProsAndConsOfTopic())}),t.push({suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle5(),suggestionText:s.ipg.SummarizeIntoHighLevelOverview(),suggestionId:s.vYk.SummarizeIntoHighLevelOverview,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.ipg.SummarizeIntoHighLevelOverview())}),t.push({suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle6(),suggestionText:s.ipg.TellReferencesAboutTopic(),suggestionId:s.vYk.TellReferencesAboutTopic,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.ipg.TellReferencesAboutTopic())})):(t.push({suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle1(),suggestionText:s.qvg.ProactiveZQMForDocWithContentTitleText1(),suggestionId:s.zYi.ProactiveZQMForDocWithContentTitleText1,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.qvg.ProactiveZQMForDocWithContentTitleText1())}),t.push({suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle3(),suggestionText:s.qvg.ProactiveZQMForDocWithContentTitleText3(),suggestionId:s.zYi.ProactiveZQMForDocWithContentTitleText3,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.qvg.ProactiveZQMForDocWithContentTitleText3())}),t.push({suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle5(),suggestionText:s.qvg.ProactiveZQMForDocWithContentTitleText5(),suggestionId:s.zYi.ProactiveZQMForDocWithContentTitleText5,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.qvg.ProactiveZQMForDocWithContentTitleText5())}),t.push({suggestionCategory:s.PJ3.ProactiveZQMForDocWithContentTitle6(),suggestionText:s.qvg.ProactiveZQMForDocWithContentTitleText6(),suggestionId:s.zYi.ProactiveZQMForDocWithContentTitleText6,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.qvg.ProactiveZQMForDocWithContentTitleText6())})),t}var L=n(623268),w=n(641359),R=n(990648);function U(e){return{suggestionCategory:s.hn.menuSectionAudioOverview(),suggestionText:s.UeP.generateAudioOverview(),suggestionId:s.FT.generateAudioOverview,iconRegular:I.iY_,shouldSubmitQueryOnClick:e,telemetryData:(0,b.OK)(s.UeP.generateAudioOverview())}}function B(){return{suggestionCategory:s.hn.menuSectionUnderstand(),suggestionText:s.UeP.extractTextFromImage(),suggestionId:s.FT.extractTextFromImage,iconRegular:D.spT,shouldLaunchImageInputMenuOnSelection:!0,telemetryData:(0,b.OK)(s.UeP.extractTextFromImage())}}function x(){return{suggestionCategory:s.hn.menuSectionCreateImage(),suggestionText:s.UeP.generateImage(),suggestionId:s.FT.generateImage,iconRegular:D.spT,telemetryData:(0,b.OK)(s.UeP.generateImage())}}function W(){return{suggestionCategory:s.hn.menuSectionAsk(),suggestionText:s.UeP.descTimeMgmt(),suggestionId:s.FT.descTimeMgmt,iconRegular:L.CDg,telemetryData:(0,b.OK)(s.UeP.descTimeMgmt())}}function F(e){return{suggestionCategory:s.kbu.title11(),suggestionText:s.b5f.textItem11(),suggestionId:s.NnX.textItem11,iconRegular:A.rJq,shouldSubmitQueryOnClick:e,telemetryData:(0,b.OK)(s.b5f.textItem11())}}function N(e){return{suggestionCategory:s.kbu.title14(),suggestionText:s.b5f.textItem14(),suggestionId:s.NnX.textItem14,iconRegular:L.CDg,shouldSubmitQueryOnClick:e,telemetryData:(0,b.OK)(s.b5f.textItem14())}}function K(e){var t=[{suggestionCategory:s.PJ3.ProactiveGeneralZQMForDocWithContentTitle1(),suggestionText:s.qvg.ProactiveGeneralZQMForDocWithContentTitleText1(),suggestionId:s.zYi.ProactiveGeneralZQMForDocWithContentTitleText1,iconRegular:L.CDg,telemetryData:(0,b.OK)(s.qvg.ProactiveGeneralZQMForDocWithContentTitleText1())},{suggestionCategory:s.PJ3.ProactiveGeneralZQMForDocWithContentTitle2(),suggestionText:s.qvg.ProactiveGeneralZQMForDocWithContentTitleText2(),suggestionId:s.zYi.ProactiveGeneralZQMForDocWithContentTitleText2,iconRegular:L.CDg,shouldSubmitQueryOnClick:e,telemetryData:(0,b.OK)(s.qvg.ProactiveGeneralZQMForDocWithContentTitleText2())},{suggestionCategory:s.PJ3.ProactiveGeneralZQMForDocWithContentTitle8(),suggestionText:s.qvg.ProactiveGeneralZQMForDocWithContentTitleText8(),suggestionId:s.zYi.ProactiveGeneralZQMForDocWithContentTitleText8,iconRegular:D.spT,telemetryData:(0,b.OK)(s.qvg.ProactiveGeneralZQMForDocWithContentTitleText8())},{suggestionCategory:s.PJ3.ProactiveGeneralZQMForDocWithContentTitle9(),suggestionText:s.qvg.ProactiveGeneralZQMForDocWithContentTitleText9(),suggestionId:s.zYi.ProactiveGeneralZQMForDocWithContentTitleText9,iconRegular:D.spT,telemetryData:(0,b.OK)(s.qvg.ProactiveGeneralZQMForDocWithContentTitleText9())}];return(0,v.MP)()?t.push({suggestionCategory:s.PJ3.ProactiveGeneralZQMForDocWithContentTitle10(),suggestionText:s.ipg.CreateBannerDesignOfDescription(),suggestionId:s.vYk.CreateBannerDesignOfDescription,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.ipg.CreateBannerDesignOfDescription())}):t.push(function(e){return{suggestionCategory:s.PJ3.ProactiveGeneralZQMForDocWithContentTitle10(),suggestionText:s.qvg.ProactiveGeneralZQMForDocWithContentTitleText10(),suggestionId:s.zYi.ProactiveGeneralZQMForDocWithContentTitleText10,iconRegular:D.spT,shouldSubmitQueryOnClick:e,telemetryData:(0,b.OK)(s.qvg.ProactiveGeneralZQMForDocWithContentTitleText10())}}(e)),t}var H=n(397574);function G(e){var t=[{suggestionCategory:s.kbu.title1(),suggestionText:s.b5f.textItem1(),suggestionId:s.NnX.textItem1,iconRegular:R.vfO,shouldLaunchCIQOnSelection:!0,scopedEntity:l.ck.File,telemetryData:(0,b.OK)(s.b5f.textItem1())},{suggestionCategory:s.kbu.title2(),suggestionText:s.b5f.textItem2(),suggestionId:s.NnX.textItem2,iconRegular:R.vfO,shouldLaunchCIQOnSelection:!0,scopedEntity:l.ck.File,telemetryData:(0,b.OK)(s.b5f.textItem2())},{suggestionCategory:s.kbu.title3(),suggestionText:s.b5f.textItem3(),suggestionId:s.NnX.textItem3,iconRegular:R.vfO,shouldLaunchCIQOnSelection:!0,scopedEntity:l.ck.File,telemetryData:(0,b.OK)(s.b5f.textItem3())},{suggestionCategory:s.kbu.title4(),suggestionText:s.b5f.textItem4(),suggestionId:s.NnX.textItem4,iconRegular:R.vfO,shouldLaunchCIQOnSelection:!0,scopedEntity:l.ck.File,telemetryData:(0,b.OK)(s.b5f.textItem4())},{suggestionCategory:s.kbu.title5(),suggestionText:s.b5f.textItem5(),suggestionId:s.NnX.textItem5,iconRegular:H.tNe,shouldLaunchCIQOnSelection:!0,scopedEntity:l.ck.File,telemetryData:(0,b.OK)(s.b5f.textItem5())},{suggestionCategory:s.kbu.title6(),suggestionText:s.b5f.textItem6(),suggestionId:s.NnX.textItem6,iconRegular:I.ACH,shouldLaunchCIQOnSelection:!0,scopedEntity:l.ck.People,telemetryData:(0,b.OK)(s.b5f.textItem6())},{suggestionCategory:s.kbu.title7(),suggestionText:s.b5f.textItem7(),suggestionId:s.NnX.textItem7,iconRegular:R.vfO,shouldLaunchCIQOnSelection:!0,scopedEntity:l.ck.File,telemetryData:(0,b.OK)(s.b5f.textItem7())},{suggestionCategory:s.kbu.title8(),suggestionText:s.b5f.textItem8(),suggestionId:s.NnX.textItem8,iconRegular:R.vfO,shouldLaunchCIQOnSelection:!0,scopedEntity:l.ck.Event,telemetryData:(0,b.OK)(s.b5f.textItem8())},{suggestionCategory:s.kbu.title9(),suggestionText:s.b5f.textItem9(),suggestionId:s.NnX.textItem9,iconRegular:R.vfO,shouldLaunchCIQOnSelection:!0,scopedEntity:l.ck.Event,telemetryData:(0,b.OK)(s.b5f.textItem9())}],n=[F(e),N(e),x()];return(0,v.NP)()&&n.push(B()),(0,v.MP)()?(n.push({suggestionCategory:s.kbu.title10(),suggestionText:s.ipg.AnalyzeSuggestText(),suggestionId:s.vYk.AnalyzeSuggestText,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.ipg.AnalyzeSuggestText())}),n.push({suggestionCategory:s.kbu.title12(),suggestionText:s.ipg.TranslateText(),suggestionId:s.vYk.TranslateText,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.ipg.TranslateText())}),n.push({suggestionCategory:s.kbu.title13(),suggestionText:s.ipg.DescribeTopic(),suggestionId:s.vYk.DescribeTopic,iconRegular:D.uJg,telemetryData:(0,b.OK)(s.ipg.DescribeTopic())})):(n.push({suggestionCategory:s.kbu.title10(),suggestionText:s.b5f.textItem10(),suggestionId:s.NnX.textItem10,iconRegular:R.RIf,telemetryData:(0,b.OK)(s.b5f.textItem10())}),n.push({suggestionCategory:s.kbu.title12(),suggestionText:s.b5f.textItem12(),suggestionId:s.NnX.textItem12,iconRegular:I.MDe,telemetryData:(0,b.OK)(s.b5f.textItem12())}),n.push({suggestionCategory:s.kbu.title13(),suggestionText:s.b5f.textItem13(),suggestionId:s.NnX.textItem13,iconRegular:L.CDg,telemetryData:(0,b.OK)(s.b5f.textItem13())})),[t,n]}function Q(e){var t=[];return(0,p.Jrn)()&&t.push({suggestionCategory:s.hn.menuSectionSpeak(),suggestionText:s.UeP.speakWithCopilot(),suggestionId:s.FT.speakWithCopilot,iconRegular:w.T75,shouldSubmitQueryOnClick:!0,telemetryData:(0,b.OK)(s.UeP.speakWithCopilot())}),!(0,v.fD)()&&(0,p.Jz)()&&t.push(U(e)),t.push(x()),(0,v.NP)()&&t.push(B()),t}var j=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];void 0===j.lastDocState&&(j.lastDocState=T.P7.Unknown,j.lastShownZQMs=[]);var r,i,c,u=[W()],d=(0,m.q0)(),_=(0,b.hT)(e),g=j.lastDocState!==_,S=j.lastShownZQMs;if((0,v.w9)())c=(0,p.hoV)(),u=[{suggestionCategory:s.gWk.title1(),suggestionText:c?s.jSG.textItem1V2():s.jSG.textItem1(),suggestionId:s.T93.textItem1,iconRegular:I.wId,shouldLaunchCIQOnSelection:!1,scopedEntity:l.ck.File},{suggestionCategory:s.gWk.title2(),suggestionText:c?s.jSG.textItem2V2():s.jSG.textItem2(),suggestionId:s.T93.textItem2,iconRegular:P.LBF,shouldLaunchCIQOnSelection:!1,scopedEntity:l.ck.File},{suggestionCategory:s.gWk.title3(),suggestionText:c?s.jSG.textItem3V2():s.jSG.textItem3(),suggestionId:s.T93.textItem3,iconRegular:I.TiG,shouldLaunchCIQOnSelection:!1,scopedEntity:l.ck.File},{suggestionCategory:s.gWk.title1(),suggestionText:c?s.jSG.textItem4V2():s.jSG.textItem4(),suggestionId:s.T93.textItem4,iconRegular:A.BHo,shouldLaunchCIQOnSelection:!1,scopedEntity:l.ck.File}];else if((_===T.P7.existingDocument||_===T.P7.newDocument&&(0,m.q0)())&&(u=function(e,t,n,r,i){if(n||t){if(e===T.P7.existingDocument)return function(e){var t=[];t.push(function(e){return{suggestionCategory:s.hn.menuSectionUnderstand(),suggestionText:s.UeP.summarize(),suggestionId:s.FT.summarize,iconRegular:D.uJg,shouldSubmitQueryOnClick:e,telemetryData:(0,b.OK)(s.UeP.summarize())}}(e)),(0,v.fD)()&&t.push(U(e));var n=Q(e);if(n.length>0){var r=(0,C.R3)(n).slice(0,1)[0];t.push((0,a._)((0,o._)({},r),{parentBucketTitle:y.H.NewSkillPrompts}))}if((0,m.q0)()){var i,c,l=k(e);(i=t).push.apply(i,(0,h._)((0,C.R3)(l).slice(0,1)));var u=K(e);(c=t).push.apply(c,(0,h._)((0,C.R3)(u).slice(0,1)))}else{var d=W();t.push(d)}return t}(r);if(e===T.P7.newDocument)return function(e){var t=(0,f._)(G(e),2),n=t[0],r=t[1],o=[],a=(0,m.q0)()&&(0,m.pX)(),i=void 0;try{var s;i=null===(s=E.A.getInstance())||void 0===s?void 0:s.getIsEnterpriseCheckEnabled()}catch(e){(0,C.cY)("Error getting enterprise check enabled in sessionStorage",e)}o=a||i?(0,h._)((0,C.R3)(n).slice(0,3)).concat((0,h._)((0,C.R3)(r).slice(0,1))):(0,h._)((0,C.R3)(r).slice(0,4));return o}(r)}return i}(_,t,g,d,S),i=function(e){if(e===T.P7.existingDocument)return y.M.Existing;if(e===T.P7.newDocument)return y.M.New;return y.M.Unknown}(_),r=function(e,t){return e===T.P7.existingDocument?[{position:(0,b.K)(),promptList:Q(t),shouldShuffle:!0,canAlter:!0,title:y.H.NewSkillPrompts,fileStateRequired:y.M.Existing}]:void 0}(_,d),_===T.P7.existingDocument&&n&&(null==u?void 0:u.length)>0)){var M=(0,b.CY)(u);M>=0&&(u[M].isHidden=!0)}return j.lastDocState=_,j.lastShownZQMs=u,{promptArray:u,promptBuckets:r,fileState:i}};var Y=n(457476);function z(){switch(_.i.GetHostAppPlatform()){case s.nAd:return"Word_Win32";case s.xb6:return"Word_Mac";case s.K4y:return"Word_iOS";default:return"Word_Online"}}function q(){switch(_.i.GetHostAppPlatform()){case s.nAd:return"Win32";case s.xb6:return"Mac";case s.K4y:return"iOS";default:return"Web"}}var V=n(648448),Z=n(832713),J=n(124857),X=n(932554),$=n(769),ee=n(602061),te=n(465321),ne=n(156845),re=n(267836),oe=n(665320),ae=n(351619);var ie=window.OfficeFirstParty,se=function(e){var t=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,r=j(e,arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>4&&void 0!==arguments[4]&&arguments[4]),o=r.promptArray;return(0,p.pn0)()&&(o=function(e,t){return e.map((function(e){return e.suggestionText.includes("podcast")&&(e.promptClickHandledByClient=t,e.shouldSubmitQueryOnClick=!1),e}))}(r.promptArray,t)),{showBranding:!0,promptSuggestionList:o,showSuggestedQnA:(0,Y.bD)(),shouldShowInteractiveCard:null!=n&&n,promptBucketInfo:r.promptBuckets,fileState:r.fileState}};function ce(e,t){return{settings:{hostAppId:z(),hostAppName:s.fn_,hostAppPlatform:q(),hostAppScenario:s.pEy,hostDefaultLocale:(0,J.mf)(),isDogfoodEnvironment:(0,X.I_)(),enableAutomaticScoping:!0,useFluentV9:(0,p.k8S)(),enableVisualRefresh:(0,p.g92)()},telemLogger:{logError:function(e){(0,C.cY)("Shared Copilot CIQ Error Log: ",e)}},telemSink:(0,p.PGz)()?g.M.getInstance().getTelemetrySink():void 0,entitiesSupported:[l.ck.File,l.ck.People,l.ck.Event,l.ck.Message],isExpandedECCEnabled:!0,getSensitivityInfo:Z.qH,featureFlags:{enableAppGptsInCiq:(0,v.xw)(),enableAppPluginsInCiq:(0,v.x6)(),enableTopicECC:(0,v.OJ)(),enableAppMessageExtensionsInCiq:(0,v.Z5)(),enableAppPPInCiq:(0,v.Nr)(),enableAppTypeBInCiq:(0,v.V9)(),disableClientConfigQueryCharacterForEditorService:!t&&(0,p.WIm)(),enableHydratedEntities:(0,v.mO)(),disablePluginsAsDAInFlyout:!(0,p.DYe)(),enableSearchBar:(0,p.Adl)(),enableLocalCUAAgent:(0,p.PrP)()},onOpenGptStorefront:(0,p.wxU)()?function(){var e=(0,v.dA)();e?(0,ee.iBH)(e,(0,v.zC)(),ee.XtO.AtMention):(0,v.zC)()?(0,ee.KjQ)():(0,ee.jPo)()}:void 0,moreCopilotsStringOverride:(0,p.tmD)()?(0,ee.QAh)():void 0,onAttachCloudFiles:e,inlineSuggestionsStyles:(0,p.g92)()?te.ZC:te.yj}}var le=function(e,t,o,a,l){return{chatPlaceholderMessage:(0,p.T7t)()?void 0:(0,s.nnF)(),chatRestShyPlaceholderMessage:(0,s.Csj)()?WordCopilot.AskAQuestionPlaceholder:"Ask a question",voiceInputProps:(0,c.dD)()?void 0:{voiceInputLocale:_.i.GetHostAppDisplayLanguage(),microphonePermissionErrorMessage:(0,s.g_J)(),microphonePermissionErrorTitle:(0,s.Lz_)(),microphonePermissionImagePath:(0,s.mPZ)()?n(450501):void 0,showMicrophonePermissionHelpLink:(0,s.mPZ)()},menuProps:(0,V.I)(e),buttonProps:{groundingButtonEnabled:(0,v.vI)(),atMentionButtonEnabled:(0,v.r3)(),ciqButtonEnabled:(0,v.D9)(),analyzeDataButtonEnabled:(0,p.WNl)()},pluginsInfo:a(),editorConfig:(0,m.q0)()?ce(l,t):void 0,characterLimitErrorMessage:(0,s.OKS)(),imageInputEnabled:(0,v.lj)(),insertImageFlags:{isImageFromPhoneButtonEnabled:(0,v.O8)(),isPasteFromClipboardButtonEnabled:(0,v.XS)(),imageFromPhoneEndpoint:(0,v.S3)()},addMenuOptionsProps:{addButtonDirection:(0,p.DBC)()?"left":"right"},officeAssistantButtonProps:(0,p.iGk)()?{text:"Office Assistant",handleClick:function(){(0,ne.Mh)()},shouldShowPreview:!0}:void 0,copilotResearchButtonProps:(0,p.dl4)()?{text:"Copilot Research",handleClick:function(){(0,ne.Mh)({copilotChatDialogContext:{appName:"CopilotResearch"}})},shouldShowPreview:!0}:void 0,cuaButtonProps:(0,p.X$8)()?{text:"CUA",handleClick:function(){(0,ne.Mh)({copilotChatDialogContext:{appName:"CUA"}})},shouldShowPreview:!0}:void 0,isGuideMeEnabledForRealtimeVoice:(0,p.QC)(),getScreenshot:(0,p.QC)()||(0,p.E4X)()?(0,r._)((function(){return(0,i.__generator)(this,(function(e){return[2,ie.DispatchApi.execute("ScreenOperations.getScreenshot")]}))})):void 0,highlightArea:(0,p.QC)()?(u=(0,r._)((function(e,t,n,r){var o;return(0,i.__generator)(this,(function(a){switch(a.label){case 0:return o=e+","+t+","+n+","+r,[4,ie.DispatchApi.execute("ScreenOperations.highlightArea",o)];case 1:return a.sent(),[2]}}))})),function(e,t,n,r){return u.apply(this,arguments)}):void 0,shouldRunMCPAgent:(0,r._)((function(){var e,t,n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return 0===(0,p.eHf)().length&&!(0,p.NbV)()&&!(0,p.Kr3)()||0===(0,p.CyP)().length?[2,void 0]:(e={"Non-Business":0,Public:1,General:2,Confidential:3,"Highly Confidential":4},[4,d.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]);case 1:return(t=r.sent()).displayName&&(0!==(n=t.displayName.split("\\")).length&&""!==n[0]&&n[0]in e)?[2,e[n[0]]<e.Confidential]:[2,!1]}}))})),orbisProps:{getOfficeComJSClientProps:(0,p.Kr3)()?oe.e:void 0,getOfficeJSClientProps:(0,p.NbV)()?ae.z:void 0}};var u},ue=function(e){return function(e){return{suggestionList:Object.keys((0,$.m5)()).map((function(e){return(0,$.m5)()[e]})).filter((function(e){return e!==(0,$.m5)()[$.mM.generateCoverPage]||(0,J.mf)().startsWith("en")})),showRefreshButton:!0,onRefreshButtonClicked:e}}(e)},de=function(e,t,n,r){return{trySydneyToggleOnChange:e,trySydneyToggleChecked:t,trySydneyToggleEnabled:!1,tryEnterpriseSearchToggleChecked:!1,tryEnterpriseSearchToggleEnabled:!1,tryWebSearchToggleEnabled:(0,p.wBW)(),webSearchUrl:(0,p.e$6)(),tryReviewerAgentToggleOnChange:n,tryReviewerAgentToggleChecked:r,tryReviewerAgentToggleEnabled:(0,p.wBl)()}},_e=function(e){return{cardDataValue:e}},pe=function(e,t,n,r,i,c,l,g,f,h,E,y,b,T,I,P,A){(0,C.cY)("Fetching Chat UI Props");var D={zeroQueryMessageProps:void 0,zeroQueryMessageV2Props:se(e,!1,P,A),suggestionPillsUiProps:ue(n),toggleUiProps:de(r,i,c,l),streamingUiProps:_e(g),chatContainerUiProps:{showFeedbackButtons:X.tV,useFluentAIGeneratedIndicator:!0,shouldSupportCitationsInAvalon:(0,p.aJZ)()},activeView:T,setActiveView:I,documentSensitivityProps:d.n.getInstance().getSensitivity(),copilotLabProps:(0,p.snA)(u.WT.IsSharedCopilotLabEnabled)?{isCopilotLabHeaderDisabled:!_.i.isWebPlatform(),copilotLabLink:(0,Y.pe)(),facets:(0,p.XmF)()?(0,ee.hUL)((0,Y.Dz)()):void 0}:void 0,changeTopicUiProps:{hideChangeTopicButton:(0,v.T$)()},chatHistoryUiProps:{enableChatHistoryV2:(0,v.pm)(),enableChatHistoryLocalStorage:(0,v.B_)(),isGptsEnabled:(0,re.wj)(ee.Sqe.IsCustomGPTsEnabled)},zqmEarlyLoadProps:{isUserTypeUnique:(0,m.Cr)()},clientInfoProps:{clientInfo:y,taskModuleLauncher:ee.DLk.getInstance().launchTaskModule,extensibilityDialogLauncher:ee.gQo.getInstance().launchExtensibilityDialog},creditsUIProps:(0,p.zQd)()?{creditUpsellHandler:ee.NnE,upsellFwdLinkId:(0,s.tMN)(),clientParam:(0,s.DPI)()}:void 0};return D=(0,a._)((0,o._)({},D),{chatInputV2Props:le(e,f,0,E,b)})}},889263:()=>{},889899:(e,t,n)=>{"use strict";n.d(t,{Kv:()=>O,QE:()=>P,ZT:()=>k,e3:()=>M,i6:()=>L,jk:()=>w});var r=n(743032),o=n(379490),a=n(644275),i=n(555799),s=n(111246),c=n(956775),l=n(156845),u=n(656904),d=n(297309),_=n(140889),p=n(242154),g=n(304765),f=n(249002),h=n(769449),C=n(740389),m=n(457476),v=n(932554),E=n(448397),y=n(602061),b=n(267836);function T(){return I.apply(this,arguments)}function I(){return I=(0,r._)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return[4,Word.run((t=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,d.Y.removeHighlight(e.document.body.getRange())];case 1:return t.sent(),[2]}}))})),function(e){return t.apply(this,arguments)}))];case 1:return e.sent(),[2]}var t}))})),I.apply(this,arguments)}function P(e){return A.apply(this,arguments)}function A(){return A=(0,r._)((function(e){return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,l.yJ)()];case 1:return t.sent(),[4,Word.run((n=(0,r._)((function(t){var n,r,a,i;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return(n=t.document.getSelection()).load("font"),[4,t.sync()];case 1:return o.sent(),r=(0,C.idb)()?Word.InsertLocation.replace:Word.InsertLocation.end,a=n.insertHtml(e,r),(0,C.vTB)()&&(i=(0,f.jQ)(n.font),a.font.set(i)),[4,t.sync()];case 2:return o.sent(),[4,d.Y.highlightRange(a,t)];case 3:return o.sent(),setTimeout(T,2e3),[2]}}))})),function(e){return n.apply(this,arguments)}))];case 2:return t.sent(),[4,(0,l.$C)()];case 3:return t.sent(),[2]}var n}))})),A.apply(this,arguments)}var D,S=function(){var e=[];return(0,b.CP)(y.mRo.DisableFooterActionsForAdaptiveCard)&&(e.push(u.ht0),e.push(y.D09)),e},M=(D=(0,r._)((function(e,t,n){var r,a,i,c,l,d;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return v.Vv.IsSettingTrue(v.zj.IsInteractiveReadOnlyMode)?(E.B.getInstance().sendChatEventTelemetry([{key:_.h3.ChatEventType,value:_.a5.InsertButtonClickedInIROMode},{key:_.h3.ChatEventParameters,value:"Insert button clicked in Interactive read only mode"}]),(0,p.cY)("Insert button clicked in Interactive read only mode"),[2]):((0,p.cY)("Insert button clicked"),(0,h.wN)(n,_.a5.InsertButtonClicked,!0),(r=s.$.getInstance().getMessageAtIndex(t))?(d={labelId:null!==(c=null===(a=r.clpSensitivityIndicatorData)||void 0===a?void 0:a.labelId)&&void 0!==c?c:"",tenantId:"",color:null!==(l=null===(i=r.clpSensitivityIndicatorData)||void 0===i?void 0:i.color)&&void 0!==l?l:""},[4,(0,f.jM)(d)]):[3,2]);case 1:o.sent(),o.label=2;case 2:return[4,P((0,g.cj)(e,(0,C.M$$)(),!1,S()))];case 3:return o.sent(),(0,C.Iy)()&&(0,f.sC)((0,u.A92)()),[2]}}))})),function(e,t,n){return D.apply(this,arguments)}),O=function(){var e=(0,r._)((function(e,t,n){var r;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:(0,p.cY)("Copy button clicked"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,c.handleCopyOnClicked)(e,S())];case 2:return t.sent(),[3,4];case 3:return r=t.sent(),(0,p.cY)("Error copying html to clipboard",r.message),[3,4];case 4:return(0,h.wN)(n,_.a5.CopyButtonClicked,!0),[2]}}))}));return function(t,n,r){return e.apply(this,arguments)}}(),k=function(){var e=(0,r._)((function(e,t,n,r){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return(0,p.cY)("Undo button clicked"),(0,h.wN)(n,_.a5.UndoButtonClicked),(0,m.np)(),(0,m.GM)((0,u.xLU)()),r&&r(),[4,(0,l.p9)()];case 1:return e.sent(),[2]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),L=function(){var e,t,n,r,o=s.$.getInstance().getLastMessage();(null==o||null===(e=o.body)||void 0===e?void 0:e.user)!==a.Q9.Human&&(null==o||null===(t=o.actionBarButtons)||void 0===t?void 0:t.length)>0&&(null==o||null===(r=o.actionBarButtons)||void 0===r||null===(n=r[0])||void 0===n?void 0:n.title)===(0,u.xLU)()&&s.$.getInstance().updateLastMessage({chatCardType:i._.Default,chatMessageBodyData:{actionButtonList:void 0},addCardToChatHistory:!1})},w=function(){var e,t,n=s.$.getInstance().getLastMessage();(null==n||null===(e=n.body)||void 0===e?void 0:e.user)!==a.Q9.Human&&(null==n||null===(t=n.actionBarButtons)||void 0===t?void 0:t.length)>0&&(n.actionBarButtons=n.actionBarButtons.filter((function(e){return e.title!==(0,u.xLU)()})),s.$.getInstance().updateLastMessage({chatCardType:i._.Default,chatMessageBodyData:{actionButtonList:n.actionBarButtons},addCardToChatHistory:!1}))}},897718:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{H:()=>WordCopilotChat});var _swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__=__webpack_require__(743032),_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_74__=__webpack_require__(990813),_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__=__webpack_require__(857835),_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__=__webpack_require__(461838),_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__=__webpack_require__(851348),_swc_helpers_to_consumable_array__WEBPACK_IMPORTED_MODULE_72__=__webpack_require__(928499),_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__=__webpack_require__(379490),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(208520),_augloop_types_action_ai__WEBPACK_IMPORTED_MODULE_89__=__webpack_require__(965801),_backend_augloop_WorkflowHandlers_ActionAIAnnotationHandler__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(639985),_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_73__=__webpack_require__(962304),_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_75__=__webpack_require__(86511),_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_79__=__webpack_require__(555799),_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_80__=__webpack_require__(644275),_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_87__=__webpack_require__(960795),_1js_officeaicopilot_chat_core__WEBPACK_IMPORTED_MODULE_83__=__webpack_require__(956775),_1js_officeaicopilot_chat_core__WEBPACK_IMPORTED_MODULE_83___default=__webpack_require__.n(_1js_officeaicopilot_chat_core__WEBPACK_IMPORTED_MODULE_83__),_augloop_types_cip_manipulate__WEBPACK_IMPORTED_MODULE_76__=__webpack_require__(336045),_1js_officeaicopilot_designer__WEBPACK_IMPORTED_MODULE_86__=__webpack_require__(780428),_AppConstants__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(656904),_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(602061),_components_sharedComponent_utils_Clp_ClpSensitivityHandler__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(606363),_backend_SharedHandlers_CommunicationHandler__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(192318),_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(111246),_augloop_types_handoff_skill__WEBPACK_IMPORTED_MODULE_92__=__webpack_require__(63461),_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(932554),_backend_office_js_HostAppUtil__WEBPACK_IMPORTED_MODULE_84__=__webpack_require__(722603),_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_81__=__webpack_require__(243912),_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_99__=__webpack_require__(716563),_1js_officeaicopilot_ui__WEBPACK_IMPORTED_MODULE_100__=__webpack_require__(778027),_1js_officeaicopilot_ui__WEBPACK_IMPORTED_MODULE_102__=__webpack_require__(192839),_backend_augloop_WorkflowHandlers_CopilotUserContextHandler__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(578574),_backend_office_js_OfficeFirstPartyUtils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(156845),_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(457476),_backend_SharedHandlers_HubbleApiHandler__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(155416),_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(448397),_augloop_types_copilot__WEBPACK_IMPORTED_MODULE_91__=__webpack_require__(504600),_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(140889),_backend_TelemetryLogger_TelemetryEventHandler__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(661218),_backend_TelemetryLogger_TelemetryLogger__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(965974),_backend_augloop_WorkflowHandlers_WordAppCopilotHandler__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(146931),_augloop_types_word_copilot_app__WEBPACK_IMPORTED_MODULE_90__=__webpack_require__(871598),_augloop_types_insights__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(158473),_augloop_types_insights__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(_augloop_types_insights__WEBPACK_IMPORTED_MODULE_17__),_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(720971),_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(769),_utils__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(242154),_components_sharedComponent_ChatUiProps__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(886621),_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(740389),_backend_utils_AnthropicKeyHolder__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(747222),_components_sharedComponent_utils_Clp_clpUtils__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(832713),_components_sharedComponent_constants_BasicChatProps__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(613903),_themeHandler_wordTheme__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__(400934),_components_Designer__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__(412728),_backend_TelemetryLogger_TelemetryUtils__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__(769449),_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__(862853),_backend_office_js_ActionButtonHandlers__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__(889899),_components_Designer_utils__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__(556165),_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__(598309),_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__(249002),_components_FeedbackDialog_FeedBackDialog__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__(663279),_ChatUiStyle__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__(64711),_components_Reload_ReloadComponent__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__(666856),_components_Agents_ReviewerAgent_utils__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__(474785),_components_Agents_ReviewerAgent_ReviewerMenuOptionIcon__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__(851910),timers__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__(621783),timers__WEBPACK_IMPORTED_MODULE_39___default=__webpack_require__.n(timers__WEBPACK_IMPORTED_MODULE_39__),_backend_utils_KustoQueryUtils__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__(779418),_components_Designer_useDesignerCard__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__(847588),_ComponentBuilders_ChatContainer_customMessageRenderers__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__(128825),_components_CopilotMenuOptionIcon__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__(771181),_augloop_types_user_store__WEBPACK_IMPORTED_MODULE_93__=__webpack_require__(117658),_backend_SharedHandlers_Handoff_WordHandoffDestination__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__(403162),_backend_SharedHandlers_Handoff_WordHandoffSource__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__(45512),_backend_interfaces_ITelemetryLogger__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__(8810),_augloop_types_byo_agent__WEBPACK_IMPORTED_MODULE_94__=__webpack_require__(371194),_backend_augloop_WorkflowHandlers_BYOAgentHandler__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__(649213),_backend_office_js_SharedHeaderUtils__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__(64047),_components_Agents_LazyLoadedAgents__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__(942774),_backend_SharedHandlers_SelectionManager__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__(71245),_1js_officeaicopilot_loop__WEBPACK_IMPORTED_MODULE_98__=__webpack_require__(983111),_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__(208276),_utils_utils__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__(860093),_AppEntryPoint__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__(822446),_WordCopilotChat_style__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__(465321),_LoadWordCopilotStrings__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__(124857),_augloop_types_officeai_incubation_app__WEBPACK_IMPORTED_MODULE_96__=__webpack_require__(934189),_augloop_types_officeai_incubation_app__WEBPACK_IMPORTED_MODULE_97__=__webpack_require__(567179),_PodcastSkillCard__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__(710777),_1js_officeaicopilot_utils__WEBPACK_IMPORTED_MODULE_85__=__webpack_require__(156203),_components_ZeroQueryMessage_ZeroQueryMessageSessionStorage__WEBPACK_IMPORTED_MODULE_57__=__webpack_require__(257490),_utils_ComprehensionUtil__WEBPACK_IMPORTED_MODULE_58__=__webpack_require__(441752),_components_ComprehensionPinnedView__WEBPACK_IMPORTED_MODULE_59__=__webpack_require__(886461),_components_sharedComponent_hooks_useInsightsCardHandlers__WEBPACK_IMPORTED_MODULE_60__=__webpack_require__(57796),_backend_Enums_ChatDialogContext__WEBPACK_IMPORTED_MODULE_61__=__webpack_require__(951405),_components_PodcastUI_usePodcastUI__WEBPACK_IMPORTED_MODULE_62__=__webpack_require__(782597),_backend_augloop_WorkflowHandlers_CopilotAssistantOutputHandler__WEBPACK_IMPORTED_MODULE_63__=__webpack_require__(539797),_experiments_reviewerAgentFeature__WEBPACK_IMPORTED_MODULE_64__=__webpack_require__(754208),typescript__WEBPACK_IMPORTED_MODULE_65__=__webpack_require__(508479),typescript__WEBPACK_IMPORTED_MODULE_65___default=__webpack_require__.n(typescript__WEBPACK_IMPORTED_MODULE_65__),_augloop_types_office_copilot_orchestration__WEBPACK_IMPORTED_MODULE_88__=__webpack_require__(280205),_augloop_types_copilot_comprehension_architecture__WEBPACK_IMPORTED_MODULE_95__=__webpack_require__(765799),_backend_agent_useWordAgentFilterHook__WEBPACK_IMPORTED_MODULE_66__=__webpack_require__(307222),_1js_officeaicopilot_featureregistry__WEBPACK_IMPORTED_MODULE_101__=__webpack_require__(544821),_components_ZeroQueryMessage_ZQMV2Utils__WEBPACK_IMPORTED_MODULE_67__=__webpack_require__(340367),_backend_utils_ExtensibilityFeatureGates__WEBPACK_IMPORTED_MODULE_68__=__webpack_require__(267836),_components_RealtimeVoiceUI_usePodcastVoicePageUI__WEBPACK_IMPORTED_MODULE_69__=__webpack_require__(412488),console=__webpack_require__(758651),wordCountState=_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__.S.default,skipClearingSuggestionPillsOnToggleChange=!0,isInitialSwitcherMenuItem=!0,WordCopilotChat=function(param){var _param_theme=param.theme,theme=void 0===_param_theme?_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.GmK.defaultWhite:_param_theme,_param_isHighContrast=param.isHighContrast,isHighContrast=void 0!==_param_isHighContrast&&_param_isHighContrast,setSensitivity=function(){return _setSensitivity.apply(this,arguments)},UpdateAndSetClientInfo=function(){return _UpdateAndSetClientInfo.apply(this,arguments)},handleWordCountUpdate=function(e){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("handleWordCountUpdate wordCount: "+e);var t=e;currentWordCountRef.current=t;var n=(0,_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__.a1)(t);wordCountState!==n&&((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("WordCount: ".concat(t," WordCountType: ").concat(n)),wordCountState!==_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__.S.default||n!==_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__.S.enableSummary||(0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.X8)()?(displaySummaryPill.current=!1,(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Summary pill disabled here ".concat(displaySummaryPill.current)),removeSummaryPillFromPillBank()):(displaySummaryPill.current=!0,(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Summary pill enabled here ".concat(displaySummaryPill.current))),setWordCountType(wordCountState=n),wordCountState===_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__.S.enableSummary||wordCountState===_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__.S.maxLimit?(displaySummaryPill.current=!0,(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Summary pill Enabled here for this wordCount ".concat(displaySummaryPill.current)),dynamicSuggestionStrings.current.includes((0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.summarize])||((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Pushing summary pill here as word count is valid for summary"),dynamicSuggestionStrings.current.push((0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.summarize]))):(displaySummaryPill.current=!1,(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Summary pill disabled here for this wordCount ".concat(displaySummaryPill.current)),removeSummaryPillFromPillBank(),suggestionList.current.includes((0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.summarize])&&(suggestionList.current=(0,_utils__WEBPACK_IMPORTED_MODULE_20__.bq)(dynamicSuggestionStrings.current,suggestionList.current,(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.summarize]))))},UpdateSensitiveLabel=function(e,t){return _UpdateSensitiveLabel.apply(this,arguments)},setSensitivityinBasicChatandChatUIProps=function(){if((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Setting sensitivity in basic chat props"),(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.q0)()){var e=(0,_components_sharedComponent_utils_Clp_clpUtils__WEBPACK_IMPORTED_MODULE_24__.yu)();setBasicChatProps((function(t){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},t),{sensitivityIndicatorData:e?(0,_components_sharedComponent_utils_Clp_clpUtils__WEBPACK_IMPORTED_MODULE_24__.Q9)(e):void 0})}))}setChatUiProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{documentSensitivityProps:_components_sharedComponent_utils_Clp_ClpSensitivityHandler__WEBPACK_IMPORTED_MODULE_4__.n.getInstance().getSensitivity(),zeroQueryMessageV2Props:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e.zeroQueryMessageV2Props),{shouldShowInteractiveCard:shouldShowInsightsCard()})})}))},setSuggestionDisplayList=function(){(wordCountState===_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__.S.enableCommanding||wordCountState===_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__.S.none)&&checkIfSuggestionPillsAreAllDefault()||!(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.GK3)()&&wordCountState===_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__.S.maxLimit?(suggestionList.current=[],(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Setting suggestion list as empty array")):((0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.DwB)()&&displayPersonalizationPill.current&&(dynamicSuggestionStrings.current=[(0,_AppConstants__WEBPACK_IMPORTED_MODULE_2__.JDs)()].concat((0,_swc_helpers_to_consumable_array__WEBPACK_IMPORTED_MODULE_72__._)(dynamicSuggestionStrings.current)),displayPersonalizationPill.current=!1),(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.Id)()&&wordCountUpdatedInfoRef.current?suggestionList.current=[]:suggestionList.current=dynamicSuggestionStrings.current.slice(0,SuggestionPillCount)),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Setting suggestion list here...   ".concat(suggestionList.current)),setChatUiProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{suggestionPillsUiProps:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e.suggestionPillsUiProps),{suggestionList:suggestionList.current})})})),logSeenEventForSuggestionPills()},sendLoggingEventToPane=function(e,t){switch(telemetryLogger||(telemetryLogger=_backend_TelemetryLogger_TelemetryLogger__WEBPACK_IMPORTED_MODULE_15__.M.getInstance()),e){case _1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_73__.Yk.ZQMLoaded:var n,r,o;(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("ZQM Loaded: ",t),_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().sendChatEventTelemetry((0,_backend_TelemetryLogger_TelemetryUtils__WEBPACK_IMPORTED_MODULE_28__.pN)((r={},(0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_74__._)(r,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventType,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.a5.ZQMV2Loaded),(0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_74__._)(r,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventParameters,(new Date).getTime().toString()),r)));var a=!0,i=!1,s=void 0;try{for(var c,l=(null!==(o=null===(n=chatUiProps.zeroQueryMessageV2Props)||void 0===n?void 0:n.promptSuggestionList)&&void 0!==o?o:[])[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var u=c.value;(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)(u.suggestionText),(0,_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__.E)(u.suggestionText)}}catch(e){i=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw s}}break;case _1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_73__.Yk.MenuButtonItemClicked:(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Menu Button Item Clicked: ",t);break;case _1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_73__.Yk.MenuButtonItemClickedL1:(0,_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__.oZ)(null==t?void 0:t.suggestionClicked,wordCountState);break;case _1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_73__.Yk.SuggestionPillClicked:var d;(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Suggestion Pill Clicked: ",t),_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().sendChatEventTelemetry((0,_backend_TelemetryLogger_TelemetryUtils__WEBPACK_IMPORTED_MODULE_28__.pN)((d={},(0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_74__._)(d,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventType,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.a5.SuggestionPillClicked),(0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_74__._)(d,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventParameters,extendEventParamsWithPillSetupInfo(null==t?void 0:t.chatEventParams)),d)));break;case _1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_73__.Yk.ZQMButtonItemClicked:_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().sendChatEventTelemetry((0,_backend_TelemetryLogger_TelemetryUtils__WEBPACK_IMPORTED_MODULE_28__.pN)((0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_74__._)({},_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventType,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.a5.ZQMV2CardClicked)))}},setPillTexts=function(e,t){setSuggestionListPool(e),pillOverrideConfigRef.current=t},extendEventParamsWithPillSetupInfo=function(e){var t,n=null===(t=pillOverrideConfigRef.current)||void 0===t?void 0:t.featureName;if(clearPillOverrideConfig(),!n)return e;var r,o={overriddenByFeatureName:n,ts:(new Date).getTime().toString()};try{r=e?JSON.parse(e):{}}catch(t){r={value:e}}return r=(0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},r,o),JSON.stringify(r)},clearPillOverrideConfig=function(){pillOverrideConfigRef.current=void 0},setSuggestionListPool=function(e){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Setting pill Bank to : ".concat(e)),dynamicSuggestionStrings.current=e,displaySummaryPill.current||removeSummaryPillFromPillBank(),setSuggestionDisplayList()},logSeenEventForSuggestionPills=function(){var e=!0,t=!1,n=void 0;try{for(var r,o=suggestionList.current[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;if((0,_utils__WEBPACK_IMPORTED_MODULE_20__.Y0)(a))_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().logSeenEvent(_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_75__.rf.QAandSummaries,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.CC.Summary,_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_75__.RX.Summarize,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.nk.DocumentSummary,[{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.SuggestionText,value:(0,_utils__WEBPACK_IMPORTED_MODULE_20__.h7)(a)}]);else switch(a){case(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.summarize]:_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().logSeenEvent(_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_75__.rf.QAandSummaries,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.CC.Summary,_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_75__.RX.Summarize,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.nk.DocumentSummary);break;case(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.callToAction]:case(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.purposeOfDoc]:case(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.intendedAudience]:case(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.docClaim]:case(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.ideaPresented]:case(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.explainDoc]:case(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.aboutDoc]:_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().logSeenEvent(_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_75__.rf.QAandSummaries,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.CC.ChatQnA,_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_75__.RX.Ask);break;case(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.generateCoverPage]:(0,_components_Designer__WEBPACK_IMPORTED_MODULE_27__.Mp)();break;default:_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().logSeenEvent()}}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}},checkIfSuggestionPillsAreAllDefault=function(){var e=!0,t=!1,n=void 0;try{for(var r,o=dynamicSuggestionStrings.current.slice(0,SuggestionPillCount)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var a=r.value;if(!(0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.w5)(a))return!1}}catch(e){t=!0,n=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw n}}return!0},removeSummaryPillFromPillBank=function(){var e=dynamicSuggestionStrings.current.indexOf((0,_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.m5)()[_backend_HostAppMessage_WordWebEvents__WEBPACK_IMPORTED_MODULE_19__.mM.summarize]);-1!==e&&((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Removing summary pill from pill bank"),dynamicSuggestionStrings.current.splice(e,1))},WordCountAnnotationHandler=function(e){_augloop_types_insights__WEBPACK_IMPORTED_MODULE_17__.WordCount.typeGuard(e.body)&&((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Word count annotation response received"),e.body.wordNumber&&handleWordCountUpdate(e.body.wordNumber))},CipManipulateHandler=function(e){if(_augloop_types_cip_manipulate__WEBPACK_IMPORTED_MODULE_76__.P.typeGuard(e.body)){var t=e.body.documentUrl;(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Showing CipManipulate response card");var n,r={text:"Open in Word",linkOnClick:(n=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){return e&&window.open(e,"_blank"),[2]}))})),function(e){return n.apply(this,arguments)}),linkUrl:t,linkSuffix:""};_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().displayResponse({chatCardType:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_79__._.Default,chatMessageData:{defaultMessageProps:{user:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_80__.Q9.Chat,messageHeader:{text:"Follow this link to see your changes in a new document.\n",linkText:r}}},chatMessageBodyData:(0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},(0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__._u)({showAIGenerated:!1,showAnimation:!0,footerPosition:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_81__.O.Footer,isFailure:!0})),stopLoadingUi:!0,startAugloopTimerForStreaming:!1,addCardToChatHistory:!1})}},updateSydneyTelemetryPanel=function(e,t,n,r){if(isDebugToggleEnabled){var o=sydneyTelemetryData,a=o.find((function(t){return t.queryId===e}));if(void 0!==a){var i=o.indexOf(a);o[i].telemetry=t}else o.push({queryId:e,telemetry:t});if(r){var s=sydneyTelemetryData.map((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{requestId:e.queryId})})),c={messages:r,requests:(0,_swc_helpers_to_consumable_array__WEBPACK_IMPORTED_MODULE_72__._)(s),id:n,isFirstMessageTrigger:!0,status:"Success"};setSydneyConversationObject({conversation:c})}setSydneyTelemetryData(o),updateClientConversationLog()}},updateCipTree=function(e){setCipTreeData(e)},updateClientConversationLog=function(){setConversationLogObject(_backend_augloop_WorkflowHandlers_WordAppCopilotHandler__WEBPACK_IMPORTED_MODULE_16__.sL.getInstance().getConversationDebugLog())},setUserIdFromAuthContext=function(){return _setUserIdFromAuthContext.apply(this,arguments)},generatedJS=function(e){var t,n;if(null==e||null===(t=e.odslResponse)||void 0===t?void 0:t.raw)return null==e||null===(n=e.odslResponse)||void 0===n?void 0:n.raw},handleResponseItem=function(e){return _handleResponseItem.apply(this,arguments)},submitSuggestionQuery=function(e,t,n,r){var o;null===(o=copilotChatRef.current)||void 0===o||o.submitUserQuery({text:t})},getChatMessageBodyProps=function(){return{messageId:"text",feedbackSectionPosition:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_81__.O.Footer,shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:"Commanding Error Card",contextData:{cardMetaData:JSON.stringify({status:"Commanding Error card shown"})}}}},operaSignalSent=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(!1),_React_useState=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState("chat"),2),activeView=_React_useState[0],setActiveView=_React_useState[1],_React_useState1=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),2),hasEnteredComprehensionView=_React_useState1[0],setHasEnteredComprehensionView=_React_useState1[1],_useState=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(void 0),2),bizChatHandoffProperties=_useState[0],setBizChatHandoffProperties=_useState[1],handleViewChange=function(e){console.log("View changed to:",e),setActiveView(e)},podcastZqmOnClick=(_ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e,t){var n;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(e){return n=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.mRe)()?_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__.xb:_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__.Mx,[2,(0,_utils_ComprehensionUtil__WEBPACK_IMPORTED_MODULE_58__.P)(handleViewChange,n,copilotChatRef)]}))})),function(e,t){return _ref.apply(this,arguments)}),_ref,isTriggerSummary=_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.IsSettingTrue(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.TriggerSummary),isOpenPaneProactivelyWithSummary=_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.IsSettingTrue(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.OpenPaneProactivelyWithSummary),summaryFromNudge=_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.getSetting(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.SummaryFromNudge),initialWordCount=_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.getSetting(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.InitialWordCount),chatWordSessionId=_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.getSettingAsString(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.ChatWordSessionID);(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("ChatWord Session Id - "+((0,_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__.hX)(chatWordSessionId)?_AppConstants__WEBPACK_IMPORTED_MODULE_2__.u1i:chatWordSessionId));var SuggestionPillCount=2,copilotChatRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null);_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().setCopilotRef(copilotChatRef),_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().setPillsHandler({setPillTexts}),_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().setBizChatHandoffPropertiesHandler(setBizChatHandoffProperties);var pillOverrideConfigRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(void 0),isReviewerAgentEnabledStatus=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__._SP)(),isBYOAInputCIQEnabledStatus=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.qsF)(),isBYOAIdeasToPPTEnabledStatus=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.wT7)(),isCopilotWorkspaceEnabled=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.sc)(),isWorkspacesDemoModeDisabledStatus=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.XUz)(),suggestionList=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)([]),dynamicSuggestionStrings=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)([]),displaySummaryPill=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(!1),displayPersonalizationPill=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)((0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.DwB)()),isTextSelected=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(!1),ariaAnnouncerRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(null),ariaAnnouncer,_useState1=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),2),defaultSuggestionPills=_useState1[0],setDefaultSuggestionPills=_useState1[1],_React_useState2=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(void 0),2),cardDataValue=_React_useState2[0],setCardDataValue=_React_useState2[1],_React_useState3=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState((0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.b8)()),2),debugTrySydneyToggleChecked=_React_useState3[0],setDebugTrySydneyToggleChecked=_React_useState3[1],_useState2=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),2),session=_useState2[0],setSession=_useState2[1],_useState3=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),isWaiting=_useState3[0],setIsWaiting=_useState3[1],_React_useState4=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),2),reviewerAgentToggleChecked=_React_useState4[0],setReviewerAgentToggleChecked=_React_useState4[1],_React_useState5=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),2),isStartReviewAgentButtonClicked=_React_useState5[0],setIsStartReviewAgentButtonClicked=_React_useState5[1],_React_useState6=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(""),2),userQuery=_React_useState6[0],setUserQuery=_React_useState6[1],_useState4=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({displayName:"",email:""}),2),authorInfo=_useState4[0],setAuthorInfo=_useState4[1],_useState5=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(""),2),documentURL=_useState5[0],setDocumentURL=_useState5[1],_React_useState7=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState((0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.W2)()),2),user=_React_useState7[0],setUser=_React_useState7[1],_React_useState8=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState({objectId:"",tenantId:""}),2),userObject=_React_useState8[0],setUserObject=_React_useState8[1],_React_useState9=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(void 0),2),isEUDBUser=_React_useState9[0],setIsEUDBUser=_React_useState9[1],_React_useState10=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Yj6.LAUNCH_FROM_TOGGLE),2),reviewerAgentLaunchType=_React_useState10[0],setReviewerAgentLaunchType=_React_useState10[1],_React_useState11=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),2),isBYOAgentModeEnabled=_React_useState11[0],setIsBYOAgentModeEnabled=_React_useState11[1],_React_useState12=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),2),isEnterpriseSearchEnabled=_React_useState12[0],setEnterpriseSearchIsEnabled=_React_useState12[1],_React_useState13=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),2),isWebSearchEnabled=_React_useState13[0],setWebSearchIsEnabled=_React_useState13[1],isDebugToggleEnabled=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.VYW)()||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UJf)(),_React_useState14=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(""),2),conversationId=_React_useState14[0],setConversationId=_React_useState14[1],_React_useState15=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState([]),2),sydneyTelemetryData=_React_useState15[0],setSydneyTelemetryData=_React_useState15[1],_React_useState16=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(),2),conversationLogObject=_React_useState16[0],setConversationLogObject=_React_useState16[1],_React_useState17=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(),2),sydneyConversationObject=_React_useState17[0],setSydneyConversationObject=_React_useState17[1],_React_useState18=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(!1),2),showDebugInfoOnMessage=_React_useState18[0],setShowDebugInfoOnMessage=_React_useState18[1],_React_useState19=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(),2),debugMessageInfoObject=_React_useState19[0],setDebugMessageInfoObject=_React_useState19[1],_React_useState20=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(),2),cipTreeData=_React_useState20[0],setCipTreeData=_React_useState20[1],_React_useState21=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(isDebugToggleEnabled||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UJf)()?{conversationId,telemetryData:sydneyTelemetryData,isDebugToggleEnabled,sessionId:_backend_augloop_WorkflowHandlers_WordAppCopilotHandler__WEBPACK_IMPORTED_MODULE_16__.Ob,conversationLogObject,sydneyConversationObject,debugMessageInfoObject,showDebugInfoMessage:showDebugInfoOnMessage,setShowDebugInfoOnMessage,sdxVersion:(0,_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__.QV)(),augloopKustoQueryURL:"",clientKustoQueryURL:"",isCipTreeDebugEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.xeR)(),cipTree:cipTreeData}:void 0),2),debugProps=_React_useState21[0],setDebugProps=_React_useState21[1],isLoopExpansionEnabled=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.prt)(),incubationWfResponseContent="",currentWordCountRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(0),_React_useState22=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(_backend_Enums_WordCountType__WEBPACK_IMPORTED_MODULE_18__.S.default),2),wordcountType=_React_useState22[0],setWordCountType=_React_useState22[1],wordClientInfoRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef((0,_1js_officeaicopilot_chat_core__WEBPACK_IMPORTED_MODULE_83__.getDefaultClientInfo)()),wordCountUpdatedInfoRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(!1),referencedEntities=react__WEBPACK_IMPORTED_MODULE_0__.useRef([]),onAttachCloudFiles=(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.lqj)({clientInfoRef:wordClientInfoRef,theme,locale:(0,_LoadWordCopilotStrings__WEBPACK_IMPORTED_MODULE_55__.mf)(),clientId:_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.kyo,redirectUri:(0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.x3)(),isWebPlatform:_backend_office_js_HostAppUtil__WEBPACK_IMPORTED_MODULE_84__.i.isWebPlatform()}).onAttachCloudFiles,isFirstScrollToMessageStartEvent=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(!0),handleScrollToMessagesStart=function(){if(isFirstScrollToMessageStartEvent.current)isFirstScrollToMessageStartEvent.current=!1;else{_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().logTriedEvent(_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_75__.rf.QAandSummaries,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.CC.Summary,_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_75__.RX.Summarize,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.nk.ProactiveSummary);var e=document.getElementById(_AppConstants__WEBPACK_IMPORTED_MODULE_2__.FK);null==e||e.removeEventListener("scroll",handleScrollToMessagesStart)}},moveScrollToTheTop=function(){if(isOpenPaneProactivelyWithSummary&&_backend_SharedHandlers_CommunicationHandler__WEBPACK_IMPORTED_MODULE_5__.wl){var e=document.getElementById(_AppConstants__WEBPACK_IMPORTED_MODULE_2__.S1E),t=document.getElementById(_AppConstants__WEBPACK_IMPORTED_MODULE_2__.FK);null==t||t.addEventListener("scroll",handleScrollToMessagesStart),null==e||e.scrollIntoView({behavior:"smooth",block:"start"})}},handleZQMRefresh=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e,t;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(n){return(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.q0)()&&((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Refreshing ZQMV2Props"),e=shouldShowInsightsCard()&&(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.vM4)()&&isCardLoadedInInsightCard(getCurrentSummaryCardContentState()),t=(0,_components_sharedComponent_ChatUiProps__WEBPACK_IMPORTED_MODULE_21__.uC)(wordCountState,!0,podcastZqmOnClick,shouldShowInsightsCard(),e),setChatUiProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{zeroQueryMessageV2Props:t})}))),[2]}))}));return function(){return e.apply(this,arguments)}}();(0,_1js_officeaicopilot_utils__WEBPACK_IMPORTED_MODULE_85__.H)(handleZQMRefresh);var handleCopilotAgentFromHostRequest=function(e){var t="";(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.dA)()?t=e.actionType:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.zC)()&&(t=e.eventName),t==_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Atg.ActivateCopilotAgent||t==_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Atg.Activated?((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("handleActivateCopilotAgentFromHost in client ",e.titleId),setCopilotSwitcherOpenRequest({appId:e.titleId})):t!=_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Atg.RemoveCopilotAgent&&t!=_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Atg.Removed||((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("handleRemoveCopilotAgentFromHost in client ",e.titleId),setCopilotSwitcherRemoveRequest({appId:e.titleId}))},suggestionPillsController=function(){dynamicSuggestionStrings.current=[],suggestionList.current=[]},copilotCommunicationHandler=_backend_SharedHandlers_CommunicationHandler__WEBPACK_IMPORTED_MODULE_5__.p4.getInstance(handleResponseItem,setSuggestionListPool,sendLoggingEventToPane,setEnterpriseSearchIsEnabled,moveScrollToTheTop,handleZQMRefresh,handleCopilotAgentFromHostRequest,suggestionPillsController,currentWordCountRef),themeRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(theme),isHighContrastRef=react__WEBPACK_IMPORTED_MODULE_0__.useRef(isHighContrast);react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){themeRef.current=theme,isHighContrastRef.current=isHighContrast}),[theme,isHighContrast]);var getCurrentThemeInfo=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(){return{isFluentV9:!0,v9Theme:(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.IdZ)(_themeHandler_wordTheme__WEBPACK_IMPORTED_MODULE_26__.Yw,themeRef.current,isHighContrastRef.current,(0,_LoadWordCopilotStrings__WEBPACK_IMPORTED_MODULE_55__.xt)()?"rtl":"ltr",(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.K$l)()?_AppConstants__WEBPACK_IMPORTED_MODULE_2__.FEx:void 0)}}),[_themeHandler_wordTheme__WEBPACK_IMPORTED_MODULE_26__.Yw,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.IdZ,_LoadWordCopilotStrings__WEBPACK_IMPORTED_MODULE_55__.xt]),_useInsightsCardHandlers=(0,_components_sharedComponent_hooks_useInsightsCardHandlers__WEBPACK_IMPORTED_MODULE_60__.K)(copilotCommunicationHandler,copilotChatRef,getCurrentThemeInfo),getQnAContent=_useInsightsCardHandlers.getQnAContent,qnACardContentState=_useInsightsCardHandlers.qnACardContentState,getRelatedFilesContent=_useInsightsCardHandlers.getRelatedFilesContent,relatedFilesContentState=_useInsightsCardHandlers.relatedFilesContentState,callCFDRelatedFilesSignal=_useInsightsCardHandlers.callCFDRelatedFilesSignal,handleCFDRelatedFilesResponse=_useInsightsCardHandlers.handleCFDRelatedFilesResponse,cocoaSkillsCardContentProviders=_useInsightsCardHandlers.cocoaSkillsCardContentProviders,submitCocoaSkillsSignals=_useInsightsCardHandlers.submitCocoaSkillsSignals,handleCocoaSkillAnnotation=_useInsightsCardHandlers.handleCocoaSkillAnnotation,getSummaryCardContent=_useInsightsCardHandlers.getSummaryCardContent,summaryCardContentState=_useInsightsCardHandlers.summaryCardContentState,updateSummaryCardContent=_useInsightsCardHandlers.updateSummaryCardContent,isInsightsCardSummaryQueryId=_useInsightsCardHandlers.isInsightsCardSummaryQueryId,invokeSummaryForInteractiveCard=_useInsightsCardHandlers.invokeSummaryForInteractiveCard,getInsightsCardProps=_useInsightsCardHandlers.getInsightsCardProps,actionBarButtons=_useInsightsCardHandlers.actionBarButtons,getCurrentSummaryCardContentState=_useInsightsCardHandlers.getCurrentSummaryCardContentState,isCardLoadedInInsightCard=_useInsightsCardHandlers.isCardLoadedInInsightCard,shouldShowInsightsCard=_useInsightsCardHandlers.shouldShowInsightsCard,appChatMsalTokenService=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){var e=wordClientInfoRef.current.userPrincipalName;return new _office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.jYE({userPrincipalName:e,redirectUri:(0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.x3)(),logTelemetry:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.RyG)(),appEnvironment:(0,_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.rA)()})}),[wordClientInfoRef.current]),hostTokenProvider=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Updating host token provider"),{getToken:function(e){return(0,_components_Designer_utils__WEBPACK_IMPORTED_MODULE_31__.gf)(_1js_officeaicopilot_designer__WEBPACK_IMPORTED_MODULE_86__.dW,e,appChatMsalTokenService)},identityType:user===_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.utd.Enterprise?"AAD":"MSA",accountInfo:{userId:userObject.objectId,tenantId:userObject.tenantId},isEUDBUser}}),[appChatMsalTokenService,user,userObject,isEUDBUser]),_React_useState23=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(""),2),selectedText=_React_useState23[0],setselectedText=_React_useState23[1],handleSelectText=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){switch(t.label){case 0:if((0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.w9)())return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("handleSelectText is disabled in Backstage mode"),setselectedText(""),[2,""];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__.cN)()];case 2:return e=t.sent(),setselectedText(e),[2,e];case 3:return t.sent(),setselectedText(""),[2,""];case 4:return[2]}}))}));return function(){return e.apply(this,arguments)}}();function _setSensitivity(){return(_setSensitivity=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){switch(t.label){case 0:return[4,(e=_components_sharedComponent_utils_Clp_ClpSensitivityHandler__WEBPACK_IMPORTED_MODULE_4__.n.getInstance()).setInDocSensitiveLabelInfoUsingOfcJs()];case 1:return t.sent(),e.setLabelChangeEventListener(UpdateSensitiveLabel),setSensitivityinBasicChatandChatUIProps(),[2]}}))}))).apply(this,arguments)}react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){copilotIdMenuItemId===_AppConstants__WEBPACK_IMPORTED_MODULE_2__.vy2&&handleCopilotChatChange(_AppConstants__WEBPACK_IMPORTED_MODULE_2__.vy2)}),[selectedText]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.gx)(debugTrySydneyToggleChecked),setBasicChatProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{isFluxFlowEnabled:debugTrySydneyToggleChecked})})),setChatUiProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{streamingUiProps:{cardDataValue},toggleUiProps:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e.toggleUiProps),{trySydneyToggleChecked:void 0!==debugTrySydneyToggleChecked&&debugTrySydneyToggleChecked})})}))}),[debugTrySydneyToggleChecked]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){setChatUiProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{reviewerAgentToggleChecked:!isReviewerAgentEnabledStatus&&reviewerAgentToggleChecked})}))}),[reviewerAgentToggleChecked]);var handleReviewerAgentToggle=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(){setIsWaiting(!0),(0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.hT)(),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("handleReviewerAgentToggle User Query: ",userQuery),(0,timers__WEBPACK_IMPORTED_MODULE_39__.setTimeout)((function(){(0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.sZ)(),setIsWaiting(!1)}),2e3)}),[]),onReviewerAgentToggleChange=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(e,t){var n=null==t?void 0:t.checked;(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Toggling Reviewer Agent to "+(n?"on":"off")),setReviewerAgentToggleChecked(null!=n&&n),setCopilotIdMenuItemId(n?_AppConstants__WEBPACK_IMPORTED_MODULE_2__.ZUM:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.ssU),setUserQuery(""),setIsStartReviewAgentButtonClicked(!1),setReviewerAgentLaunchType(_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Yj6.LAUNCH_FROM_TOGGLE),handleReviewerAgentToggle()}),[handleReviewerAgentToggle]),onTryReviewerAgentClicked=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Clicked on Try Reviewer Agent"),setReviewerAgentToggleChecked(!0),setIsStartReviewAgentButtonClicked(!1),setReviewerAgentLaunchType(_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Yj6.LAUNCH_WITH_REVIEWERS),handleReviewerAgentToggle()}),[handleReviewerAgentToggle]),onStartReviewButtonClicked=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Clicked on Start Reviewer Agent"),setReviewerAgentToggleChecked(!0),setIsStartReviewAgentButtonClicked(!0),setReviewerAgentLaunchType(_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Yj6.LAUNCH_WITHOUT_REVIEWERS),handleReviewerAgentToggle()}),[handleReviewerAgentToggle]),onLaunchBYOAgent=function(e){setIsBYOAgentModeEnabled(e),(0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.hT)(),setIsWaiting(!0),(0,timers__WEBPACK_IMPORTED_MODULE_39__.setTimeout)((function(){(0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.sZ)(),setIsWaiting(!1)}),2e3)},getPluginsInfo=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(){if((0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.vI)()){if((0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.dV)())return[];var e=[];return(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.oJj)()&&e.push({id:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_87__.$.Work,onToggle:function(e){if((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Microsoft M365 toggle is "+(e?"enabled":"turned off")),(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.LA)(e),(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.q0)())try{var t;null===(t=_components_ZeroQueryMessage_ZeroQueryMessageSessionStorage__WEBPACK_IMPORTED_MODULE_57__.A.getInstance())||void 0===t||t.setIsEnterpriseCheckEnabled(e)}catch(e){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Error setting enterprise check enabled in sessionStorage",e)}setEnterpriseSearchIsEnabled(e)},state:isEnterpriseSearchEnabled?_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_87__.p.Enabled:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_87__.p.Disabled}),e.push({id:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_87__.$.Web,onToggle:function(e){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Web Content toggle is "+(e?"enabled":"turned off")),(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.u$)(e),setWebSearchIsEnabled(e),skipClearingSuggestionPillsOnToggleChange&&(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.gr8)()?skipClearingSuggestionPillsOnToggleChange=!1:setSuggestionListPool([])},state:isWebSearchEnabled?_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_87__.p.Enabled:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_87__.p.Disabled}),e}}),[isEnterpriseSearchEnabled,isWebSearchEnabled]);react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){var e=(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.q0)()&&(!(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Uyp)()||isEnterpriseSearchEnabled);setChatUiProps((function(t){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},t),{chatInputV2Props:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},t.chatInputV2Props),{editorConfig:e?(0,_components_sharedComponent_ChatUiProps__WEBPACK_IMPORTED_MODULE_21__.iF)(onAttachCloudFiles,e):void 0,pluginsInfo:getPluginsInfo()})})}))}),[isEnterpriseSearchEnabled,isWebSearchEnabled,user,onAttachCloudFiles]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){if((0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.q0)()){var e=(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.q0)()&&(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.pX)(),t=void 0;try{var n;t=null===(n=_components_ZeroQueryMessage_ZeroQueryMessageSessionStorage__WEBPACK_IMPORTED_MODULE_57__.A.getInstance())||void 0===n?void 0:n.getIsEnterpriseCheckEnabled()}catch(e){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Error getting enterprise check enabled in sessionStorage",e)}(e||t)&&setChatUiProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{zeroQueryMessageV2Props:(0,_components_sharedComponent_ChatUiProps__WEBPACK_IMPORTED_MODULE_21__.uC)(wordCountState,!0,podcastZqmOnClick,shouldShowInsightsCard())})}))}}),[]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){setChatUiProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{streamingUiProps:{cardDataValue}})}))}),[cardDataValue]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){setDebugTrySydneyToggleChecked((0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.b8)()),setChatUiProps((function(e){var t=(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.q0)()&&(!(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Uyp)()||isEnterpriseSearchEnabled);return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{ChatInputV2Props:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e.chatInputV2Props),{editorConfig:t?(0,_components_sharedComponent_ChatUiProps__WEBPACK_IMPORTED_MODULE_21__.iF)(onAttachCloudFiles,t):void 0,buttonProps:{groundingButtonEnabled:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.vI)(),atMentionButtonEnabled:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.r3)(),ciqButtonEnabled:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.D9)()}}),changeTopicUiProps:{hideChangeTopicButton:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.T$)()}})}))}),[isEnterpriseSearchEnabled,user,onAttachCloudFiles]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){isDebugToggleEnabled&&setDebugProps({conversationId,telemetryData:sydneyTelemetryData,isDebugToggleEnabled,sessionId:_backend_augloop_WorkflowHandlers_WordAppCopilotHandler__WEBPACK_IMPORTED_MODULE_16__.Ob,conversationLogObject,sydneyConversationObject,debugMessageInfoObject,showDebugInfoMessage:showDebugInfoOnMessage,setShowDebugInfoOnMessage,sdxVersion:(0,_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__.QV)(),augloopKustoQueryURL:(0,_backend_utils_KustoQueryUtils__WEBPACK_IMPORTED_MODULE_40__.m5)(_backend_augloop_WorkflowHandlers_WordAppCopilotHandler__WEBPACK_IMPORTED_MODULE_16__.Ob).linkUrl,clientKustoQueryURL:(0,_backend_utils_KustoQueryUtils__WEBPACK_IMPORTED_MODULE_40__.xx)(_backend_augloop_WorkflowHandlers_WordAppCopilotHandler__WEBPACK_IMPORTED_MODULE_16__.Ob).linkUrl,isCipTreeDebugEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.xeR)(),cipTree:cipTreeData})}),[conversationId,sydneyTelemetryData,conversationLogObject,sydneyConversationObject,showDebugInfoOnMessage,debugMessageInfoObject,_backend_augloop_WorkflowHandlers_WordAppCopilotHandler__WEBPACK_IMPORTED_MODULE_16__.Ob,cipTreeData]);var onTrySydneyToggleChange=function(e,t){var n=null==t?void 0:t.checked;(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Toggling Try Sydney to "+(n?"on":"off")),setDebugTrySydneyToggleChecked(null!=n&&n)},telemetryLogger=null,telemetryEventHandler=null,handleRefreshClick=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){return e=(0,_utils__WEBPACK_IMPORTED_MODULE_20__.zU)(dynamicSuggestionStrings.current,SuggestionPillCount,suggestionList.current),suggestionList.current=e.slice(0,SuggestionPillCount),setChatUiProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{suggestionPillsUiProps:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e.suggestionPillsUiProps),{suggestionList:suggestionList.current})})})),logSeenEventForSuggestionPills(),[2]}))}));return function(){return e.apply(this,arguments)}}(),DesignerCard=(0,_components_Designer_useDesignerCard__WEBPACK_IMPORTED_MODULE_41__.B)(function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e,t,n,r){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(o){switch(o.label){case 0:return[4,(0,_components_Designer_utils__WEBPACK_IMPORTED_MODULE_31__.BQ)(e,null==t?void 0:t.description,null==t?void 0:t.altText,null==t?void 0:t.license,null==t?void 0:t.isUrl,null==t?void 0:t.pac,n,r,ariaAnnouncerRef)];case 1:return o.sent(),[4,(0,_backend_SharedHandlers_HubbleApiHandler__WEBPACK_IMPORTED_MODULE_11__.v)(null==t?void 0:t.sourceUrl,_backend_office_js_HostAppUtil__WEBPACK_IMPORTED_MODULE_84__.i.GetHostAppPlatform())];case 2:return o.sent(),[2]}}))}));return function(t,n,r,o){return e.apply(this,arguments)}}(),(0,_components_Designer__WEBPACK_IMPORTED_MODULE_27__.NG)(),_components_Designer_utils__WEBPACK_IMPORTED_MODULE_31__.Gm,hostTokenProvider,function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e,t){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(n){switch(n.label){case 0:return[4,(0,_components_Designer__WEBPACK_IMPORTED_MODULE_27__.p7)(e,t)];case 1:return n.sent(),[2]}}))}));return function(t,n){return e.apply(this,arguments)}}(),_components_Designer_utils__WEBPACK_IMPORTED_MODULE_31__.Xg,_components_Designer_utils__WEBPACK_IMPORTED_MODULE_31__.CS,_components_Designer_utils__WEBPACK_IMPORTED_MODULE_31__.le).DesignerCard,_HostAppSettings_getSettingAsString;_ComponentBuilders_ChatContainer_customMessageRenderers__WEBPACK_IMPORTED_MODULE_42__.J.renderers.DesignerCard=DesignerCard;var ClipChampCard=(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.nq)(appChatMsalTokenService,{isEUDBUser,conversationId,augloopUrl:null!==(_HostAppSettings_getSettingAsString=_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.getSettingAsString(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.AugLoopCloudALServiceUrl))&&void 0!==_HostAppSettings_getSettingAsString?_HostAppSettings_getSettingAsString:_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.getSettingAsString(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.AugLoopCloudALServiceUrlWAC),locale:(0,_LoadWordCopilotStrings__WEBPACK_IMPORTED_MODULE_55__.mf)()},{identityType:hostTokenProvider.identityType,userId:hostTokenProvider.accountInfo.userId,tenantId:hostTokenProvider.accountInfo.tenantId}).ClipChampCard;_ComponentBuilders_ChatContainer_customMessageRenderers__WEBPACK_IMPORTED_MODULE_42__.J.renderers.ClipchampCard=ClipChampCard,(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){_backend_SharedHandlers_CommunicationHandler__WEBPACK_IMPORTED_MODULE_5__.wl&&(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.q0)()&&((0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.stP)()&&(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e,t,n,r;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(o){switch(o.label){case 0:t="",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,_backend_office_js_HostAppUtil__WEBPACK_IMPORTED_MODULE_84__.i.getDocumentUrlAsync()];case 2:return t=o.sent(),console.log("Related Files Document URL:",t),[3,4];case 3:return n=o.sent(),console.error("Failed to fetch document url:",n),[3,4];case 4:return _backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().sendChatEventTelemetry([{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventType,value:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.a5.InsightsCardDocUrlFetchStatus},{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventParameters,value:t?"Success":"Failed"}]),r=callCFDRelatedFilesSignal(t),null===(e=copilotChatRef.current)||void 0===e||e.submitOperation({operation:r,workflowAnnotationType:_augloop_types_office_copilot_orchestration__WEBPACK_IMPORTED_MODULE_88__.xc.getTypeName()}),[2]}}))}))(),(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.qNw)()&&copilotChatRef.current&&submitCocoaSkillsSignals(copilotChatRef.current.submitOperation),(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.gIB)((0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Ldm)())&&invokeSummaryForInteractiveCard(!1))}),[_backend_SharedHandlers_CommunicationHandler__WEBPACK_IMPORTED_MODULE_5__.wl]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){(0,_components_ZeroQueryMessage_ZQMV2Utils__WEBPACK_IMPORTED_MODULE_67__.Gw)(chatUiProps.zeroQueryMessageV2Props)&&isCardLoadedInInsightCard(getCurrentSummaryCardContentState())&&setChatUiProps((function(e){var t=e.zeroQueryMessageV2Props,n=t.promptSuggestionList,r=(0,_components_ZeroQueryMessage_ZQMV2Utils__WEBPACK_IMPORTED_MODULE_67__.CY)(n);return r>=0?(n[r].isHidden=!0,(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Summary ZQM hidden due to content card display")):(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Summary ZQM not found in promptArray when trying to hide"),(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{zeroQueryMessageV2Props:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},t),{promptSuggestionList:n})})})),((0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$3p)()||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.pn0)())&&setChatUiProps((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{interactiveCardProps:getInsightsCardProps()})}))}),[getQnAContent,qnACardContentState,getRelatedFilesContent,relatedFilesContentState,cocoaSkillsCardContentProviders.map((function(e){var t,n;return null===(n=e.content)||void 0===n||null===(t=n.props)||void 0===t?void 0:t.markdown})).join(),getSummaryCardContent,summaryCardContentState,actionBarButtons]);var _useState6=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},(0,_components_sharedComponent_ChatUiProps__WEBPACK_IMPORTED_MODULE_21__.Jv)(wordCountState,isTextSelected.current,handleRefreshClick,onTrySydneyToggleChange,debugTrySydneyToggleChecked,onReviewerAgentToggleChange,reviewerAgentToggleChecked,cardDataValue,isEnterpriseSearchEnabled,setEnterpriseSearchIsEnabled,getPluginsInfo,wordClientInfoRef.current,onAttachCloudFiles,activeView,setActiveView,podcastZqmOnClick,shouldShowInsightsCard())),{interactiveCardProps:getInsightsCardProps(),customMessageRenderers:_ComponentBuilders_ChatContainer_customMessageRenderers__WEBPACK_IMPORTED_MODULE_42__.J})),2),chatUiProps=_useState6[0],setChatUiProps=_useState6[1],_useState7=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((0,_components_sharedComponent_constants_BasicChatProps__WEBPACK_IMPORTED_MODULE_25__.v)(debugTrySydneyToggleChecked)),2),basicChatProps=_useState7[0],setBasicChatProps=_useState7[1],wordCountUpdateHandler=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){return e=_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.getSetting(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.InitialWordCount),handleWordCountUpdate(e),(0,_backend_office_js_OfficeFirstPartyUtils__WEBPACK_IMPORTED_MODULE_9__.yB)(handleWordCountUpdate),[2]}))}));return function(){return e.apply(this,arguments)}}();(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.fQe)(wordCountUpdateHandler);var showPreloadedCopilotStateUpdateHandler=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){return(e=document.getElementById(_AppConstants__WEBPACK_IMPORTED_MODULE_2__.C8y))&&e.focus(),_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().setInputFocus(),_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().scrollToBottom(),[2]}))}));return function(){return e.apply(this,arguments)}}();(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.fQe)(showPreloadedCopilotStateUpdateHandler),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var e,t;((0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.sZ)(),setUserIdFromAuthContext(),(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Wdf)()?(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.gcB)((function(e,t){setUser(e),(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.Kw)(e),setIsEUDBUser(t)})):(0,_backend_augloop_WorkflowHandlers_CopilotUserContextHandler__WEBPACK_IMPORTED_MODULE_8__.g)(setUser),telemetryLogger=_backend_TelemetryLogger_TelemetryLogger__WEBPACK_IMPORTED_MODULE_15__.M.getInstance(),(telemetryEventHandler=_backend_TelemetryLogger_TelemetryEventHandler__WEBPACK_IMPORTED_MODULE_14__.E.getInstance()).initTelemetryLatencyObject(),(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.xeR)()&&(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e,t;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,_backend_office_js_HostAppUtil__WEBPACK_IMPORTED_MODULE_84__.i.getDocumentUrlAsync()];case 1:return e=n.sent(),(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.D9t)(e,updateCipTree),[3,3];case 2:return t=n.sent(),console.error("Failed to call content intelligence platform workflow:",t),[3,3];case 3:return[2]}}))}))(),(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.Id)())?suggestionList.current=[]:suggestionList.current=(null===(e=chatUiProps.suggestionPillsUiProps)||void 0===e?void 0:e.suggestionList)?null===(t=chatUiProps.suggestionPillsUiProps)||void 0===t?void 0:t.suggestionList:[];dynamicSuggestionStrings.current=suggestionList.current,(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.w9)()||(updateSelectedText(),wordCountUpdateHandler(),(0,_backend_office_js_OfficeFirstPartyUtils__WEBPACK_IMPORTED_MODULE_9__.ko)((function(){(0,_backend_office_js_ActionButtonHandlers__WEBPACK_IMPORTED_MODULE_30__.i6)()})),(0,_backend_utils_AppStateValues__WEBPACK_IMPORTED_MODULE_29__.q0)()&&setSensitivity(),(0,_components_FeedbackDialog_FeedBackDialog__WEBPACK_IMPORTED_MODULE_34__.LN)()),(isReviewerAgentEnabledStatus||isCopilotWorkspaceEnabled)&&(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e,t,n,r;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),[4,copilotCommunicationHandler.getALSession()];case 1:return e=o.sent(),[4,(0,_components_Agents_ReviewerAgent_utils__WEBPACK_IMPORTED_MODULE_37__.Wd)()];case 2:return t=o.sent(),[4,_backend_office_js_HostAppUtil__WEBPACK_IMPORTED_MODULE_84__.i.getDocumentUrlAsync()];case 3:return n=o.sent(),setSession(e),setAuthorInfo(t),setDocumentURL(n),[3,5];case 4:return r=o.sent(),console.error("Failed to fetch session:",r),[3,5];case 5:return[2]}}))}))(),copilotCommunicationHandler.setCopilotMenuState(setCopilotIdMenuItemId),UpdateAndSetClientInfo()}),[]);var msgExtDialogLauncherInstance=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){var e,t=_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.DLk.getInstance();copilotChatRef.current&&t.setProxyOperator(null===(e=copilotChatRef.current)||void 0===e?void 0:e.executePluginOperation);return t}),[copilotChatRef.current]),extensibilityDialogLauncherInstance=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){return _office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.gQo.getInstance()}),[]);function _UpdateAndSetClientInfo(){return(_UpdateAndSetClientInfo=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.m4)()];case 1:return e=t.sent(),wordClientInfoRef.current=e,setChatUiProps((function(t){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},t),{clientInfoProps:{clientInfo:e,taskModuleLauncher:msgExtDialogLauncherInstance.launchTaskModule,extensibilityDialogLauncher:extensibilityDialogLauncherInstance.launchExtensibilityDialog}})})),[2]}}))}))).apply(this,arguments)}function _UpdateSensitiveLabel(){return(_UpdateSensitiveLabel=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e,t){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(n){switch(n.label){case 0:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t))),(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.EG7)()&&(_components_sharedComponent_utils_Clp_ClpSensitivityHandler__WEBPACK_IMPORTED_MODULE_4__.n.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,_components_sharedComponent_utils_Clp_ClpSensitivityHandler__WEBPACK_IMPORTED_MODULE_4__.n.getInstance().setSensitivityLabelToHighestSensitivity([_components_sharedComponent_utils_Clp_ClpSensitivityHandler__WEBPACK_IMPORTED_MODULE_4__.n.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return n.sent(),[2];case 2:_components_sharedComponent_utils_Clp_ClpSensitivityHandler__WEBPACK_IMPORTED_MODULE_4__.n.getInstance().setInDocSensitivityLabelInfo(t),n.label=3;case 3:return setSensitivityinBasicChatandChatUIProps(),[2]}}))}))).apply(this,arguments)}var updateSelectedText=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){switch(t.label){case 0:return(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.w9)()?((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("updateSelectedText is disabled in Backstage mode"),[2]):[4,Word.run(function(){var t=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(t){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(n){switch(n.label){case 0:return(e=t.document.getSelection()).load("text"),[4,t.sync()];case 1:return n.sent(),isTextSelected.current=0!==e.text.length,[2]}}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return t.sent(),[2]}}))}));return function(){return e.apply(this,arguments)}}();react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){updateChatUiProps(),(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.jGy)()&&"chat"===activeView?(0,_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__.V6)():"comprehension"===activeView&&setHasEnteredComprehensionView(!0)}),[activeView]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){wordCountUpdatedInfoRef.current=!0,updateChatUiProps(),setSuggestionDisplayList(),wordCountUpdatedInfoRef.current=!1}),[wordcountType,activeView]);var updateChatUiProps=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(){setChatUiProps((0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},(0,_components_sharedComponent_ChatUiProps__WEBPACK_IMPORTED_MODULE_21__.Jv)(wordcountType,isTextSelected.current,handleRefreshClick,onTrySydneyToggleChange,debugTrySydneyToggleChecked,onReviewerAgentToggleChange,reviewerAgentToggleChecked,cardDataValue,isEnterpriseSearchEnabled,setEnterpriseSearchIsEnabled,getPluginsInfo,wordClientInfoRef.current,onAttachCloudFiles,activeView,setActiveView,podcastZqmOnClick,shouldShowInsightsCard())),{interactiveCardProps:getInsightsCardProps(),customMessageRenderers:_ComponentBuilders_ChatContainer_customMessageRenderers__WEBPACK_IMPORTED_MODULE_42__.J}))}),[isEnterpriseSearchEnabled,wordcountType,onAttachCloudFiles,activeView]);function _setUserIdFromAuthContext(){return(_setUserIdFromAuthContext=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){e=(0,_components_Designer_utils__WEBPACK_IMPORTED_MODULE_31__.Bx)("00000000-0000-0000-0000-000000000000");try{Office.context.auth.getAuthContextAsync((function(t){if("succeeded"===t.status){var n=t.value;if(n){var r=n.userObjectId||userObject.objectId,o=n.tenantId||userObject.tenantId,a=n.authorityType||userObject.authorityType;setUserObject({objectId:r,tenantId:o,authorityType:a})}else(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Authcontext is undefined"),_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().sendErrorTelemetry((0,_swc_helpers_to_consumable_array__WEBPACK_IMPORTED_MODULE_72__._)(e).concat([{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.IC.ErrorCategory,value:_backend_interfaces_ITelemetryLogger__WEBPACK_IMPORTED_MODULE_46__.S.Designer},{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.IC.ErrorMessage,value:"Authcontext fetched from OfficeJS is undefined"}]))}else{(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Failed to fetch user id from OfficeJS with status: ",t.status);var i="";try{i=JSON.stringify(t)}catch(e){i="".concat(t)}_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().sendErrorTelemetry((0,_swc_helpers_to_consumable_array__WEBPACK_IMPORTED_MODULE_72__._)(e).concat([{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.IC.ErrorCategory,value:_backend_interfaces_ITelemetryLogger__WEBPACK_IMPORTED_MODULE_46__.S.Designer},{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.IC.ErrorMessage,value:"Failed to fetch user object from OfficeJS. Status=".concat(t.status,". Result= ").concat(i)}]))}}))}catch(t){_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().sendErrorTelemetry((0,_swc_helpers_to_consumable_array__WEBPACK_IMPORTED_MODULE_72__._)(e).concat([{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.IC.ErrorCategory,value:_backend_interfaces_ITelemetryLogger__WEBPACK_IMPORTED_MODULE_46__.S.Designer},{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.IC.ErrorMessage,value:"Error thrown while fetching user Object. Message=".concat(t.message)},{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.IC.ErrorCode,value:t.code}])),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Error getting user id: "+t)}return[2]}))}))).apply(this,arguments)}var _useState8=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),2),showExpandedLoop=_useState8[0],setShowExpandedLoop=_useState8[1],isLoopExpanded=!1,_useState9=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),2),loopElement=_useState9[0],setLoopElement=_useState9[1],getLoopCardCallback=function(){return loopElement},expandLoopToggleOnChange=function(){isLoopExpansionEnabled&&((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("DEBUGLOG: expand pane called"),isLoopExpanded?(0,_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__._9)():(0,_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__.xb)(),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("DEBUGLOG: expand button clicked"),setShowExpandedLoop((function(e){return!e})),isLoopExpanded=!isLoopExpanded)},onCloseLoopCard=function(){isLoopExpansionEnabled&&((0,_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__._9)(),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("DEBUGLOG: close button clicked"),setShowExpandedLoop((function(e){return!e})),isLoopExpanded=!isLoopExpanded)},handleJSExecution=function(jsString){_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().displayResponse({chatCardType:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_79__._.WarningMessage,addCardToChatHistory:!1,chatMessageBodyData:{messageId:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.eVk,feedbackSectionPosition:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_81__.O.Footer,shouldShowAIGeneratedIndicator:!1,warningActionButtons:[{buttonTitle:"test_button_title",buttonText:"Execute JavaScript code",handleButtonOnClick:(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var jsCode,result;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(_state){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("test button clicked"),jsCode=typescript__WEBPACK_IMPORTED_MODULE_65__.transpile(jsString),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)(jsCode);try{result=eval(jsCode),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)(result)}catch(e){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Syntax Error jsCode: ".concat(jsCode,"  \n Error: ").concat(e.message))}return[2]}))}))}]},chatMessageData:{warningMessageCardProps:{user:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_80__.Q9.Chat,warningPrefix:"JavaScript code received from the server"}}})};function _handleResponseItem(){return _handleResponseItem=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e){var t,n,r,o,a,i,s,c,l,u,d,_,p,g,f,h,C,m,v,E,y,b,T,I,P,A,D,S=arguments;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(M){switch(M.label){case 0:if(t=S.length>1&&void 0!==S[1]?S[1]:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.u1i,(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("handleResponseItem cv: ",t),(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.zk2)()&&t===_AppConstants__WEBPACK_IMPORTED_MODULE_2__.ydF&&onLaunchBYOAgent(!0),(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.V7J)()||(t=""),!(null===(n=e.body)||void 0===n?void 0:n.H_))return[3,24];switch(e.body.H_.T_){case _augloop_types_cip_manipulate__WEBPACK_IMPORTED_MODULE_76__.P.getTypeName():return[3,1];case _augloop_types_action_ai__WEBPACK_IMPORTED_MODULE_89__.Sy.getTypeName():return[3,3];case _augloop_types_word_copilot_app__WEBPACK_IMPORTED_MODULE_90__.H.getTypeName():return[3,5];case _augloop_types_copilot__WEBPACK_IMPORTED_MODULE_91__.p1.getTypeName():return[3,7];case _augloop_types_insights__WEBPACK_IMPORTED_MODULE_17__.WordCount.getTypeName():return[3,9];case _augloop_types_action_ai__WEBPACK_IMPORTED_MODULE_89__.MH.getTypeName():return[3,10];case _augloop_types_handoff_skill__WEBPACK_IMPORTED_MODULE_92__.uC.getTypeName():return[3,11];case _augloop_types_handoff_skill__WEBPACK_IMPORTED_MODULE_92__.dF.getTypeName():return[3,13];case _augloop_types_handoff_skill__WEBPACK_IMPORTED_MODULE_92__.kp.getTypeName():return[3,15];case _augloop_types_user_store__WEBPACK_IMPORTED_MODULE_93__.H.getTypeName():return[3,17];case _augloop_types_byo_agent__WEBPACK_IMPORTED_MODULE_94__.Z.getTypeName():return[3,18];case _augloop_types_office_copilot_orchestration__WEBPACK_IMPORTED_MODULE_88__.xc.getTypeName():return[3,20];case _augloop_types_copilot_comprehension_architecture__WEBPACK_IMPORTED_MODULE_95__.CP.getTypeName():case _augloop_types_copilot_comprehension_architecture__WEBPACK_IMPORTED_MODULE_95__.ht.getTypeName():return[3,21];case _augloop_types_officeai_incubation_app__WEBPACK_IMPORTED_MODULE_96__.H6.getTypeName():return[3,22]}return[3,23];case 1:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received ".concat(_augloop_types_cip_manipulate__WEBPACK_IMPORTED_MODULE_76__.P.getTypeName()," annotation in Copilot Chat")),[4,CipManipulateHandler(e)];case 2:case 4:case 6:case 8:case 12:case 14:case 16:case 19:return M.sent(),[3,24];case 3:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received action-ai response  in Copilot Chat"),[4,(0,_backend_augloop_WorkflowHandlers_ActionAIAnnotationHandler__WEBPACK_IMPORTED_MODULE_1__.s)(e,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.os.getInstance().getQueryTime(),setSuggestionListPool,t)];case 5:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received Word Copilot response in Copilot Chat"),(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.TnG)()&&(r=generatedJS(e.body))?(_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().deleteMessage({messageIdToDelete:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.eVk,chatCardType:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_79__._.WarningMessage}),handleJSExecution(r),[3,24]):[4,_backend_augloop_WorkflowHandlers_WordAppCopilotHandler__WEBPACK_IMPORTED_MODULE_16__.sL.getInstance().handleWordCopilotAppResponseForSharedCopilot(e,_backend_augloop_WorkflowHandlers_ActionAIAnnotationHandler__WEBPACK_IMPORTED_MODULE_1__.m,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.os.getInstance().getQueryTime(),setSuggestionListPool,setConversationId,updateSydneyTelemetryPanel,onTryReviewerAgentClicked,setUserQuery,onStartReviewButtonClicked,setShowDebugInfoOnMessage,setDebugMessageInfoObject,updateClientConversationLog,t,isInsightsCardSummaryQueryId,updateSummaryCardContent)];case 7:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received Copilot Output Stream response in Copilot Chat",e.body),[4,_backend_augloop_WorkflowHandlers_CopilotAssistantOutputHandler__WEBPACK_IMPORTED_MODULE_63__.sp.getInstance().handleCopilotAssistantResponse(e,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.os.getInstance().getQueryTime(),setShowDebugInfoOnMessage,setDebugMessageInfoObject,updateClientConversationLog,t)];case 9:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received wordcount response in Copilot Chat"),WordCountAnnotationHandler(e),[3,24];case 10:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received AdminControlAnnotation in Copilot Chat"),[3,24];case 11:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received HandoffMessage in Copilot Chat"),[4,_backend_SharedHandlers_Handoff_WordHandoffDestination__WEBPACK_IMPORTED_MODULE_44__.p.getInstance().handleHandoffMessage(e,t,!1,copilotChatRef,setBizChatHostContext,bizChatHostContext,setBizChatHandoffProperties)];case 13:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received HandoffDocUrlAnnotation in Copilot Chat"),[4,_backend_SharedHandlers_Handoff_WordHandoffSource__WEBPACK_IMPORTED_MODULE_45__.m.getInstance().handleHandoffDocUrlAnnotation(e,t)];case 15:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received HandoffOutboundMessage in Copilot Chat"),[4,_backend_SharedHandlers_Handoff_WordHandoffSource__WEBPACK_IMPORTED_MODULE_45__.m.getInstance().handoffOutboundMessageHandler(e,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.os.getInstance().getQueryTime(),t)];case 17:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received UserProfile response in Copilot Chat"),(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.RBg)(e,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.os.getInstance().getQueryTime(),_utils__WEBPACK_IMPORTED_MODULE_20__.Dm,_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().getCopilotRef()),[3,24];case 18:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received BuildYourOwnAgentProxyCopilotOutputAnnotation in Copilot Chat"),[4,_backend_augloop_WorkflowHandlers_BYOAgentHandler__WEBPACK_IMPORTED_MODULE_47__.Y.getInstance().BYOAgentResponseHandler(e)];case 20:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Related Files received: ",e),handleCFDRelatedFilesResponse(e,copilotChatRef,null==chatUiProps||null===(o=chatUiProps.interactiveCardProps)||void 0===o?void 0:o.contentProviders),[3,24];case 21:return(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.qNw)()&&handleCocoaSkillAnnotation(e),[3,24];case 22:return(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Received OfficeaiIncubationAppAnnotation in Copilot Chat: ",e),(a=e.body).responseType===_augloop_types_officeai_incubation_app__WEBPACK_IMPORTED_MODULE_97__.d2.PODCAST_CREATION?((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Podcast response received",a),i=new Uint8Array([]),(s=a.podcastResponse)?(s.blob.sizeBytes<=2e6?((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Podcast response is within bounds"),c=s.blob.data.data,l=(0,_utils_utils__WEBPACK_IMPORTED_MODULE_52__.BA)(s.response),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Podcast response message",l),void 0!==c&&(i=new Uint8Array(c),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("speechData ",i," blobData ",c),showPodcastCard(i,l))):((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Podcast response is too large"),gotBlobReferences(s.blob)),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Speech data blob",i),[2]):((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Podcast response is empty"),[2])):(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.yto)()?((d=null===(u=a.generatedDataResponse)||void 0===u?void 0:u.response)?(_=JSON.parse(d),(p=_.content)&&((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Incubation response received",p),incubationWfResponseContent=p)):(h=null===(g=a.generatedSuggestionsResponse)||void 0===g?void 0:g.generatedSuggestions,C=JSON.parse(h||"{}"),m=null==C?void 0:C.follow_up_suggestions,v=[],null==m||m.forEach((function(e){v.push({content:e,onClick:submitSuggestionQuery,responsetype:_PodcastSkillCard__WEBPACK_IMPORTED_MODULE_56__.hT.suggestion})})),E=[],y=null==C?void 0:C.follow_up_chatInputType,null==y||y.forEach((function(e){var t;"rewriteContent"===e&&!0,E.push({content:e,icon:(null===(t=(0,_PodcastSkillCard__WEBPACK_IMPORTED_MODULE_56__.hD)(e))||void 0===t?void 0:t.icon)||void 0,onClick:submitSuggestionQuery,responsetype:_PodcastSkillCard__WEBPACK_IMPORTED_MODULE_56__.hT.skillName,skillName:e})})),null==(b=null==C?void 0:C.follow_up_operations)||b.forEach((function(e){var t;E.push({content:e||"",icon:(null===(t=(0,_PodcastSkillCard__WEBPACK_IMPORTED_MODULE_56__.hD)(e))||void 0===t?void 0:t.icon)||void 0,onClick:submitSuggestionQuery,responsetype:_PodcastSkillCard__WEBPACK_IMPORTED_MODULE_56__.hT.operations})})),T=Math.floor(1e3*Math.random()),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("incubationResponse",incubationWfResponseContent),I=(0,_1js_officeaicopilot_loop__WEBPACK_IMPORTED_MODULE_98__.vi)(T,incubationWfResponseContent,!1,!1,!1,expandLoopToggleOnChange,onCloseLoopCard),isLoopExpansionEnabled&&(P=(0,_1js_officeaicopilot_loop__WEBPACK_IMPORTED_MODULE_98__.vi)(T,incubationWfResponseContent,!1,!1,!0,expandLoopToggleOnChange,onCloseLoopCard),setLoopElement(P)),null===(f=copilotChatRef.current)||void 0===f||f.addResponseMessage({chatCardType:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_79__._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:I}},chatMessageBodyData:(0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},getChatMessageBodyProps()),stopLoadingUi:!0})),[2]):((0,_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.FN)((0,_AppConstants__WEBPACK_IMPORTED_MODULE_2__.i7B)(),!1),[3,24]);case 23:return A={chatEventType:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.a5.UnsupportedAnnotation,chatEventParam:e.body.H_.T_,chatErrorType:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.T__.Client},_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().sendChatEventTelemetry((0,_backend_TelemetryLogger_TelemetryUtils__WEBPACK_IMPORTED_MODULE_28__.pN)((D={},(0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_74__._)(D,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventType,A.chatEventType),(0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_74__._)(D,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventParameters,A.chatEventParam),(0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_74__._)(D,_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatErrorType,A.chatErrorType),D))),[3,24];case 24:return[2]}}))})),_handleResponseItem.apply(this,arguments)}var showPodcastCard=function(e,t){var n,r=t||"Here's the podcast of this doc:";null===(n=copilotChatRef.current)||void 0===n||n.addResponseMessage({chatCardType:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_79__._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:"chat",element:(0,_PodcastSkillCard__WEBPACK_IMPORTED_MODULE_56__.GY)(1,r,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,e)}},chatMessageBodyData:(0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},getChatMessageBodyProps()),stopLoadingUi:!0})},gotBlobReferences=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e){var t;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(n){switch(n.label){case 0:return session?[4,session.requestBinaryDataForBlob(e)]:(console.error("iSession is undefined"),[2]);case 1:return t=n.sent(),showPodcastCard(t),[2]}}))}));return function(t){return e.apply(this,arguments)}}(),copilotStyle=(0,_WordCopilotChat_style__WEBPACK_IMPORTED_MODULE_54__.Gc)(showExpandedLoop),usingHTMLSelectionData=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Tvc)(),_useCanvasSelectionListener=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,_backend_SharedHandlers_SelectionManager__WEBPACK_IMPORTED_MODULE_50__.C)(),4),selectionContext=_useCanvasSelectionListener[0],setIsSelectionManagerListening=_useCanvasSelectionListener[1],setIsSelectionUsed=_useCanvasSelectionListener[2],_=_useCanvasSelectionListener[3];(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){setIsSelectionManagerListening(usingHTMLSelectionData),setIsSelectionUsed(usingHTMLSelectionData)}),[usingHTMLSelectionData]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){usingHTMLSelectionData?copilotCommunicationHandler.setContext(JSON.stringify({selectionHTML:selectionContext})):copilotCommunicationHandler.setContext(void 0)}),[usingHTMLSelectionData,selectionContext]);var copilotChatTheme=(0,_themeHandler_wordTheme__WEBPACK_IMPORTED_MODULE_26__.eS)(theme,isHighContrast),keyDownHandler=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.snA)("IsHandleTabKeyEnabled",!0)?function(e){"Tab"===e.key&&e.stopPropagation()}:void 0,_React_useState24=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState((function(){var e=[];return(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.vLn)()||e.push({id:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.ssU,name:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.qQp,isSelected:!0,isDefaultCopilot:!0,menuIcon:react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_CopilotMenuOptionIcon__WEBPACK_IMPORTED_MODULE_43__.e,null)}),isCopilotWorkspaceEnabled&&e.push({id:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.vy2,name:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.L9S,isSelected:!1,isDefaultCopilot:!1,copilotType:_1js_officeaicopilot_chat_types__WEBPACK_IMPORTED_MODULE_99__.NV.ClientProvided,copilotComponent:react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Agents_LazyLoadedAgents__WEBPACK_IMPORTED_MODULE_49__.x2,{alSession:session,onInsertString:_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__.jr,isTestApp:!1,theme:copilotChatTheme,canvasDataProps:{onCanvasDataRequested:handleSelectText},isDemoMode:!isWorkspacesDemoModeDisabledStatus}),menuIcon:react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Agents_ReviewerAgent_ReviewerMenuOptionIcon__WEBPACK_IMPORTED_MODULE_38__.T,null),iconAltText:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.L9S}),e})),2),copilotList=_React_useState24[0],setCopilotList=_React_useState24[1],_React_useState25=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(_AppConstants__WEBPACK_IMPORTED_MODULE_2__.ssU),2),copilotIdMenuItemId=_React_useState25[0],setCopilotIdMenuItemId=_React_useState25[1],handleCopilotChatChange=function(e){if((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("handleCopilotChatChange in client",e),e!==_AppConstants__WEBPACK_IMPORTED_MODULE_2__.Zor){var t=copilotList.map((function(t){return!isCopilotWorkspaceEnabled||_AppEntryPoint__WEBPACK_IMPORTED_MODULE_53__.isSDXRenderingForPreload||isInitialSwitcherMenuItem||((0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("DEBUG handle resize pane called"),(0,_utils_utils__WEBPACK_IMPORTED_MODULE_52__.DH)(e)),e===_AppConstants__WEBPACK_IMPORTED_MODULE_2__.vy2?(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},t),{copilotComponent:react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Agents_LazyLoadedAgents__WEBPACK_IMPORTED_MODULE_49__.x2,{alSession:session,onInsertString:_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__.jr,isTestApp:!1,theme:copilotChatTheme,canvasDataProps:{onCanvasDataRequested:handleSelectText},isDemoMode:!isWorkspacesDemoModeDisabledStatus,isLoopEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.yZP)()}),isSelected:t.id===e}):(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},t),{isSelected:t.id===e})}));e!=_AppConstants__WEBPACK_IMPORTED_MODULE_2__.ssU&&(isInitialSwitcherMenuItem=!1),setCopilotList(t),setCopilotIdMenuItemId(e),(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.P71)((0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.TRs)(null,e,_1js_officeaicopilot_chat_core__WEBPACK_IMPORTED_MODULE_83__.defaultCopilotChatMenuItemId))}else(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.iBH)((0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.dA)(),(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.zC)(),_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.XtO.SwitcherMenu)},_React_useState26=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(void 0),2),copilotSwitcherOpenRequest=_React_useState26[0],setCopilotSwitcherOpenRequest=_React_useState26[1],_React_useState27=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState(void 0),2),copilotSwitcherRemoveRequest=_React_useState27[0],setCopilotSwitcherRemoveRequest=_React_useState27[1];react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){handleCopilotChatChange(copilotIdMenuItemId)}),[copilotIdMenuItemId,session]);var _React_useState28=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)(react__WEBPACK_IMPORTED_MODULE_0__.useState((function(){if((0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UW0)())return(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.dLn)()})),2),bizChatHostContext=_React_useState28[0],setBizChatHostContext=_React_useState28[1],enableAgentSwitchInCatalyst=(0,_backend_utils_ExtensibilityFeatureGates__WEBPACK_IMPORTED_MODULE_68__.rT)().enableAgentSwitchInCatalyst;react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){if((0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.dA)()){var e=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UW0)()&&setBizChatHostContext&&enableAgentSwitchInCatalyst;(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.GZA)(handleCopilotAgentFromHostRequest,(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.LK)(),e?setBizChatHostContext:void 0)}else(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.zC)()&&(_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.BDr.getInstance().attachPrivateEventHandler(_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Atg.ActivateCopilotAgent,handleCopilotAgentFromHostRequest),_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.BDr.getInstance().attachPrivateEventHandler(_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Atg.RemoveCopilotAgent,handleCopilotAgentFromHostRequest))}),[]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UW0)()&&(copilotCommunicationHandler.setBizChatHostContext(bizChatHostContext),copilotCommunicationHandler.setBizChatHostContextSetter(setBizChatHostContext))}),[bizChatHostContext,setBizChatHostContext,copilotCommunicationHandler]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){if((0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UW0)()){Office.addin.onVisibilityModeChanged((function(e){var t;if(e.visibilityMode===_AppConstants__WEBPACK_IMPORTED_MODULE_2__.DwS){var n=(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.dLn)(),r=!(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.rpM)()||n,o=!(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.hRR)()||(null===(t=n.PrimaryUserAccountInfo)||void 0===t?void 0:t.CopilotExperience);r&&o&&setBizChatHostContext(n),(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("BizchatHostContext re-initialized: ",n),r&&o&&setBizChatHostContext(n)}}));_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.BDr.getInstance().attachPrivateEventHandler(_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Thm.BizchatHostContextUpdate,(function(e){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("BizchatHostContext updated:",e);var t=(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.ope)(e.eventData);(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("BizchatHostContext eventData:",t),setBizChatHostContext(t)}))}}),[]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){var e,t,n,r;(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UW0)()&&(_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance().sendChatEventTelemetry([{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventType,value:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.a5.BizchatHostContext},{key:_backend_TelemetryLogger_TelemetryConstants__WEBPACK_IMPORTED_MODULE_13__.h3.ChatEventParameters,value:{doesUpnExist:!!(null==bizChatHostContext||null===(e=bizChatHostContext.PrimaryUserAccountInfo)||void 0===e?void 0:e.Upn),aggregatedLicensedFeatures:null==bizChatHostContext||null===(t=bizChatHostContext.PrimaryUserAccountInfo)||void 0===t?void 0:t.AggregatedLicensedFeatures,licensedFeatures:null==bizChatHostContext||null===(n=bizChatHostContext.PrimaryUserAccountInfo)||void 0===n?void 0:n.LicensedFeatures,copilotExperience:null==bizChatHostContext||null===(r=bizChatHostContext.PrimaryUserAccountInfo)||void 0===r?void 0:r.CopilotExperience}}]),(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.pH3)(bizChatHostContext))}),[bizChatHostContext]);var wordAgentFilterConstants=(0,_backend_agent_useWordAgentFilterHook__WEBPACK_IMPORTED_MODULE_66__.e)().wordAgentFilterConstants,copilotPluginProps={showCopilotSwitcherMenu:!1,copilotList:[],handleCopilotChatChange:function(e){},copilotSwitcherRequest:{copilotSwitcherOpenRequest,setCopilotSwitcherOpenRequest,copilotSwitcherRemoveRequest,setCopilotSwitcherRemoveRequest},imageInsertionHandler:_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.DP,renderStoreCard:_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.iE,agentFilterConfig:wordAgentFilterConstants},copilotPluginPropsForAgent={showCopilotSwitcherMenu:!0,copilotList,handleCopilotChatChange,showNewChatButtonOnTop:!1,copilotSwitcherRequest:{copilotSwitcherOpenRequest,setCopilotSwitcherOpenRequest,copilotSwitcherRemoveRequest,setCopilotSwitcherRemoveRequest},imageInsertionHandler:_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.DP,renderStoreCard:_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.iE,agentFilterConfig:wordAgentFilterConstants},paneSilhouetteHeaderProps={closeButton:(0,_backend_office_js_SharedHeaderUtils__WEBPACK_IMPORTED_MODULE_48__.JA)(),headerMenuButtonProps:(0,_backend_office_js_SharedHeaderUtils__WEBPACK_IMPORTED_MODULE_48__.qP)(),enableChatHistory:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.XXz)(),showCreditButton:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.zQd)(),enableSettingsPanel:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.s9k)()},copilotPluginPropsForSharedHeader={showCopilotSwitcherMenu:!0,copilotList,handleCopilotChatChange,showNewChatButtonOnTop:!1,paneSilhouetteHeaderProps:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.aC$)()?paneSilhouetteHeaderProps:void 0,copilotSwitcherRequest:{copilotSwitcherOpenRequest,setCopilotSwitcherOpenRequest,copilotSwitcherRemoveRequest,setCopilotSwitcherRemoveRequest},imageInsertionHandler:_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.DP,renderStoreCard:_components_sharedComponent_utils_utils__WEBPACK_IMPORTED_MODULE_10__.iE,agentFilterConfig:wordAgentFilterConstants},isCopilotChatDialogLaunched=_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.IsSettingTrue(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.IsCopilotChatDialog),copilotChatDialogContext=_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.getSetting(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.CopilotChatDialogContext),copilotChatDialogContextJson=copilotChatDialogContext?JSON.parse(copilotChatDialogContext):void 0,isOfficeAssistantDailogLaunched=isCopilotChatDialogLaunched&&(!copilotChatDialogContextJson||copilotChatDialogContextJson.appName===_backend_Enums_ChatDialogContext__WEBPACK_IMPORTED_MODULE_61__.u.VOICE),isCUADialogLaunched=isCopilotChatDialogLaunched&&(!copilotChatDialogContextJson||copilotChatDialogContextJson.appName===_backend_Enums_ChatDialogContext__WEBPACK_IMPORTED_MODULE_61__.u.CUA),copilotFeatureFlags=(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},(0,_backend_utils_ExtensibilityFeatureGates__WEBPACK_IMPORTED_MODULE_68__.rT)()),{isBundledPackageEnabled:!0,isApiPluginsEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.GRg)(),isSccVoiceEnabled:!(0,_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__.dD)(),isSccReadAloudEnabled:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.gP)(),isSccReadAloudAugloopEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.vzv)(),isSccPromptSuggestionsEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.qij)(),isSccCiqEnabled:!0,isSccElaboratePromptEnabled:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.mO)()&&(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.xw0)(),isChatCardFactoryMemoizationEnabled:!0,isClaimsChallengeMessageInAnnotationEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.FrA)(),defaultEnableEnterpriseGrounding:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.oJj)(),defaultEnableWebGrounding:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.gr8)(),isCustomHandlingForChatHistoryEnabled:!0,shouldRenderAllHyperLinks:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.OvN)(),isPasteUnfurlingEnabled:!0,isQueryWarmupSignalEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.KsL)(),isQueryWarmupSignalEnabledOnChatPaneOpens:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.cU3)(),areAddinLocalPluginActionsEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UxI)(),isCreditsUIEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.zQd)(),isViewMorePromptsIconV2Enabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.s2L)(),isZQMEarlyLoadingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Xp$)(),isPodcastV2Enabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Ere)(),isSaveToOneDriveEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.anI)(),isViewMorePromptsOneClickEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.zd8)(),showNewChatOnGPTItem:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.CUx)(),enableNewChatOnlyOnCopilot:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Lzg)(),showPluginReferencesV3:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.K9Y)(),isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.qJy)(),enableProactiveZQMWith3SAPISuggestions:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Cpg)(),enableProactiveZQMWithSuggestedQnA:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.wOV)(),showTelemetryLogs:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.YX)(),enableInsightsCard:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$3p)(),enableCarouselForInsightsCard:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.czT)(),isZQMSeenTelemetryfromSharedEnabled:!0,isCloudFileUploadEnabled:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.Gh)(),isLocalFileUploadEnabled:!1,enablePluginSearchInFlyout:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.fnY)(),enableMorePluginHyperLinkInFlyout:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.mdc)(),isAttachmentListEnabled:!0,isInputMessageEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.tpT)(),isChatHistorySignalDeferred:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Qif)(),isDragDropWrapperEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.CXc)(),useUpdatedGroundingButtonTitle:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.dV)()&&(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__._jX)(),enableQueryEndOnGptSwitch:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.FFf)(),isFocusChatInputOnMount:!_AppEntryPoint__WEBPACK_IMPORTED_MODULE_53__.isSDXRenderingForPreload,promptInputLength:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.dY1,isOfficeCopilotChatPreloadEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.tV1)(),isInterstitialConfirmationEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.dw_)(),isInterstitialAuthEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.I3H)(),isSelectionButtonEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.AgJ)(),isMultiSelectionAttachmentEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.sQV)(),isOutputV2Enabled:!0,isChatCardRendererMemoizationEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.fRX)(),enableFileUrlUnFurlingWithGraphAPI:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$U2)(),maxVisibleAttachments:_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.FqH,useResponsiveSystemMessage:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.MqF)(),showPluginsAsAgents:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.OrF)(),isRealtimeVoiceEnabled:!!isOfficeAssistantDailogLaunched||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.zyh)(),enableGeneratePodcastButtonInResearcher:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.Lx)(),isAcquirePluginsFromMosEnabled:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.zC)()||(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.dA)(),isHandoffButtonEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.oaD)(),isHandoffBookendingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Skv)(),isHandoffGetAnnotationsEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.KWs)(),isHandoffInteractiveSummaryAndContentCallbackEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.dOo)(),isHandoffRTLEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.gQ_)(),openInWordMinimumForHeuristic:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.rY0)(),isApiPluginsCardsEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.l6e)(),isSmartInsertEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.M$$)(),realtimeVoicePlayerVersion:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.PVq)(),realtimeVoiceClientVersion:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.HUI)(),realtimeVoiceMuteIconVersion:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.GDJ)(),realtimeVoicePlayerBufferDurationMs:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.x2g)(),enableSwitcherMenuV2:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.o25)(),loadGptListOnCopilotIconClick:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.AFi)(),enableAgentsBasedOnSkill:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.VDk)(),isSEFEntitiesEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.nId)(),isRealtimeVoiceChatHistoryEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.f1i)(),isRealtimeVoiceDynamicBufferSizeEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.hw5)(),isRealtimeVoiceToolInvokingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.KYx)(),isRealtimeVoiceTransciptionCardEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.dW$)(),isRealtimeVoiceTranscriptionStreamingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.DMe)(),isRealtimeVoiceInputQueryTextEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.qNo)(),isRealtimeVoiceUserTranscriptionCardEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.GVV)(),isRealtimeVoiceSpeakerButtonEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.uyL)(),isRealtimeVoiceHoldButtonEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.CuN)(),isRealtimeVoiceReadAloudEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.sKT)(),isRealtimeVoiceTeachingPageEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.xVH)(),isRealtimeVoicePreviewTagEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.rY)(),isRealtimeVoiceMeteringResponseEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.dVS)(),isRealtimeVoiceReadAloudVoiceSelectionEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.mZS)(),realtimeVoiceMeteringLimitsThreshold:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__._8$)(),isRealtimeVoiceAnimationQueueDisabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.p7G)(),isRealtimeVoiceRAICheckEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.bUF)(),isRealtimeVoiceToolbarEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.G3Z)(),isRealtimeVoiceLoadingHaloEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Pn_)(),isRealtimeVoiceReadAloudTeachingPageEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.okL)(),isRealtimeVoiceDisconnectedByReadAloudEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.aiL)(),isRealtimeVoiceCopilotReadAloudAugloopEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.XIt)(),isRealtimeVoiceInSwitcherMenuContainerEnabled:_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.IsSettingTrue(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.IsReadAloudModalessDialog),isRealtimeVoiceNoiseSuppressionEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UjN)(),isRealtimeVoiceReadAloudParagraphControlEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.DWo)(),isRealtimeVoiceReadAloudCanvasTextHighlightingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.f0B)(),isRealtimeVoiceMicPermissionCheckEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Hi6)(),isRealtimeVoiceReadAloudAudioGreetingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Dmc)(),isRealtimeVoiceReadAloudAudioOutroEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.FWR)(),isRealtimeVoiceChunkingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.MEQ)(),isRealtimeVoiceReadAloudVoiceVolumeCoherenceEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.OSU)(),isSaveSharePromptEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.G1e)(),isSavePromptEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.pBW)(),isSharePromptEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.H45)(),isDeclarativePromptsEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$Ez)(),isDeclarativePromptsSaveEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Gmz)(),isDAOutputV2Enabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.MNq)(),isDABrandingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.CLb)(),scrollToBottomThrottleDelay:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.hnZ)(),instantScrollToBottomThrottleDelay:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.EEM)(),isInstantScrollEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__._kn)(),isAudioCastPlayerEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.opT)(),isAudioCastDownloadEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.D8N)(),isAudioCastPinningEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.OWF)(),isAudioCastRaiseHandEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.cH7)(),enableAudioPlayerTelemetry:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.sb6)(),enableAddSelectionForGPTs:!0,isRealtimeVoiceCanvasSelectionEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.vdI)(),enableCustomWidthPropOnAC:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.x13)(),isFluentV9TaskPaneEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.QkZ)(),isZQMColumnStackingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UM0)(),isComprehensionViewEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.pn0)(),isALHookEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.UTV)(),isSimplifiedChatInputEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.T7t)(),isAddMenuUxRefreshEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.T7t)(),isSimplifiedChatInputFlairEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.T7t)(),isHideSendButtonEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.T7t)(),isNewAttachmentListUiEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.dr7)(),isRealtimeVoiceInputWithUxRefreshEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.T7t)()&&(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.GPk)(),prefetchACImages:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.uo3)(),enableInMemoryCacheForACImages:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Z47)(),isRealtimeVoiceFunctionCallOutputEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.WJo)(),showPromptSuggestionsWithOutput:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Slc)(),isMosInstallAgentLoaderEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.MU0)(),isOfficeAssistantEnabled:isOfficeAssistantDailogLaunched,isOfficeAssistantTranscriptEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.w2V)(),isOfficeAssistantToDoListEnabled:!!isOfficeAssistantDailogLaunched||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.iGk)(),isAppChatGlowUXEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.L4b)(),showWelcomeExperience:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.MHS)(),isUXRefreshEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.L4b)(),interactiveCardLoadingTimeout:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.cPj)(),isCodePreviewEnabled:(0,_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__.jx)(),isOfficeAssistantPeopleOnboardingTableEnabled:!!isOfficeAssistantDailogLaunched||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.iGk)(),isActionSelectionEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.uQx)(),isRealtimeVoiceMicMutedSendTilesEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$2U)(),isTextDirectionEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.cz7)(),isALRequestResponseEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.NT7)(),isRTVFixedWidthEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.i$4)(),isSccFeedbackPluginEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.HHe)(),isSideQuestStreamingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.vD)(),isSideQuestMarkdownEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.WrJ)(),isSideQuestEnabled:(0,_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.So)()?(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.X41)():(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.lWG)(),showCitationsInSideQuest:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.uIO)(),invokeTenantFeedbackServiceFromFeedbackSDK:!0,useSharedFeedbackDataUpdate:!0,skipWelcomeForRtActions:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.VR7)(),isOfficeAssistantCombinedExperienceEnabled:isOfficeAssistantDailogLaunched,useStandaloneAssistantPackage:isOfficeAssistantDailogLaunched,isOfficeAssistantSkipOnboardingEnabled:!!isOfficeAssistantDailogLaunched||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.iGk)(),isCopilotInBackstageMode:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.w9)(),useAssistantSpecificTiles:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.XU$)(),realtimeVoiceCopilotResponseTimeout:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.qU)(),isOfficeAssistantSpecialOnboardingExperience:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.SiZ)(),assistantIgnoreUnknownServerErrors:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.ON2)(),enableSeedingDependentWFSubmission:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Dzy)(),enableAdaptiveCardEnhancements:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Nud)(),isEnabledLocalCUAAgent:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.PrP)(),enableCodeSnippetStyling:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.WNl)(),isAudioCastAutoPlayEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.yq6)(),enableSydneyDAForResearch:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.hC)(),enableAdvancedResearch:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.fnH)(),renderChatHistoryInHandoffDestination:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.yqt)(),isHandoffLoadingPageEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.HHv)(),enableAdaptiveCardCharts:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.D2B)(),isZQMEarlyLoadingEnabledInBackstage:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.n5h)(),enableHighlightedKeywordsInZQMPrompts:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.hoV)(),enableAppAgentsInCiqOverride:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.pv)(),releaseAnnotationsInCopilotChatDisplay:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.r2Z)(),isDABrandingRefactorEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Om4)(),isCiqEnabledInDAs:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.osS)(),isMultipleConfirmationDialogFlowEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$ff)(),isDODChangesForAppChatEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.cez)(),isFeatureRegistryCardRenderingEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Lhe)(),enableOpenUrlDialogAction:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.tmc)(),enableStopGeneratingButtonInChatInput:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$bq)(),enableMosRequestHandlers:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.du)(),isModelSelectorEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.g5g)(),isAgentsLoggingEnabledInShared:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Fz9)(),enableImBackActions:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.MQi)(),newChatInHeaderControl:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.sc6)(),disableChatWhenUserInteractionRequiredCardIsShown:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.QMx)(),mosAgentInstallTimeout:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.tC)(),enableUncitedReferences:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.ahx)(),isSafeLinksEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.SBS)(),enableBizChatInAppChat:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.TS5)(),enableBizChatAgentsInAppChat:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.jjh)(),enableHostLocalPluginsProvider:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.SYO)(),enableBizChatIntegration:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.j$)(),enableBizChatOtelLogger:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.zWx)(),enableBizChatIdsInOtelLog:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.iZl)(),enableBizChatPerfOtelLog:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.AkJ)(),enableBizChat:(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.vP)(),enableInsertButton:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.p9C)(),enableOcpsLogging:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.eh5)(),isEligibilityTelemetryEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.mXJ)(),forceDfSydney:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.vcx)(),isAudioCastConfigureEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.WPi)(),isAudioCastOpenFullScreenEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Gjt)(),shouldShowNewSQNAZQM:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.IW0)(),enableCloseChatPaneButton:(_backend_office_js_HostAppUtil__WEBPACK_IMPORTED_MODULE_84__.i.isWebPlatform()||_backend_office_js_HostAppUtil__WEBPACK_IMPORTED_MODULE_84__.i.isWin32Platform())&&!(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.w9)(),m365ChatCdnVersion:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Jqb)(),m365ChatDeploymentRing:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.feb)(),m365ChatDeploymentEnvironment:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.e8X)(),enableM365EcsProvidedProps:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.lJI)(),useAppVersionECSProject:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.EHu)(),enableImplicitCIQForCloudFiles:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Dzl)(),enableImplicitCIQForLocalFiles:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.hF)(),commandingFlags:{chatLogLevel:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Wp2)(),openAIApiKey:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.sK$)(),anthropicApiKey:_backend_utils_AnthropicKeyHolder__WEBPACK_IMPORTED_MODULE_23__.U.getInstance().getAnthropicKey(),awsAnthropicAuth:_backend_utils_AnthropicKeyHolder__WEBPACK_IMPORTED_MODULE_23__.U.getInstance().getAwsAnthropicKeys(),anthropicClaudeModel:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.cjy)(),localMCPServerURL:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.eHf)(),enableOfficeJSTool:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.NbV)(),enableComJSTool:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Kr3)()},enableFileAccessMessageBanner:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.DI8)(),enableLocalFileMessageBanner:!_backend_office_js_HostAppUtil__WEBPACK_IMPORTED_MODULE_84__.i.isWebPlatform()&&(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__._k_)()&&!(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.hF)(),enableBizChatInAppAuthDialog:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$Cf)(),enableBizchatInAppPerfMonitor:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.KOx)(),enableM365ChatLogger:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.tO4)(),enableSQNAZQMWhenNotInCC:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.HYu)(),enableBizchatNestedAppAuthSupport:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.AJD)(),isEligibilityCheckEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.i3k)(),isEligibilityCacheEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Kuk)(),enableBizChatFeedbackCompliancePolicyFetching:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$ii)(),enableBizChatDefaultFeedbackAppId:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.DnQ)(),enableOcpsPolicyFetching:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.O74)(),enableFeedbackDataIntegrationFromSdxToBizChat:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.Qni)(),enableBizChatInAppSettings:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.IfU)(),enableKeepAliveForALSession:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.WLE)(),keepAliveForALSessionIntervalInSecond:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.zf$)(),enableIsEuCheck:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.U4g)(),hrdServiceProviderId:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.AmF)(),enableBizChatInAppAuthDialogV2:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.ThR)(),waitForEcsSettingsTimeout:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.l9B)(),enableWaitForEcsSettings:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.sx$)(),isInsertImageEnabledForDesigner:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.eOl)(),enableClientSelectionContext:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.OUH)(),enableBizChatAuthTelemetry:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.cMx)(),enableBizChatInfiniteAuthShimmerFix:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.zn0)(),enablePuidCompliantCheck:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.IQJ)(),enableFetchImplicitQueryAnnotations:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.LUs)(),isRingSwitcherEnabled:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.FYS)(),enableWaitForEcsOnExpiredCache:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.cpQ)(),enableBizChatInactiveLog:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.KxH)(),enableM365ChatRehydration:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__._Ij)(),enableBizChatPairwiseBrokerSupport:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.XPY)(),bizchatPairwiseBrokerHandshakeTimeout:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.n7$)(),bizchatPairwiseBrokerConnectionTimeout:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.OSh)(),enableM365ChatTokenPrefetch:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.fFf)(),enableM365ChatWaitForBroker:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.SAS)(),enableBizchatEcsSettingsTelemetry:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.OWE)(),enableM365ChatHandleAuthBackgroundVisibility:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.dru)(),enableM365ChatHandleBackgroundVisibilityForRequests:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.YAc)(),enablePerfMarks:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.aH3)()}),appChatHostTokenProvider=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){return{mosTokenProvider:(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(e){return[2,appChatMsalTokenService.getToken(_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Ssr).then((function(e){return null==e?void 0:e.accessToken}))]}))}))}}),[appChatMsalTokenService]),copilotPluginPropsToSet=(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.vLn)()?copilotPluginPropsForSharedHeader:isReviewerAgentEnabledStatus?copilotPluginPropsForAgent:copilotPluginProps,graphTokenProviderCallback=react__WEBPACK_IMPORTED_MODULE_0__.useCallback(function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e){var t;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(n){switch(n.label){case 0:return t=appChatMsalTokenService,[4,(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.v5s)(t,e)];case 1:return[2,n.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),[appChatMsalTokenService]),customRaiseHandPlayerFactory=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(e){var t=e.onClose,n=(0,_components_RealtimeVoiceUI_usePodcastVoicePageUI__WEBPACK_IMPORTED_MODULE_69__.j)(copilotCommunicationHandler,copilotFeatureFlags,t).PodcastVoicePageUI;return _backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.cH7&&copilotCommunicationHandler?react__WEBPACK_IMPORTED_MODULE_0__.createElement(n,null):void 0}),[copilotCommunicationHandler,copilotFeatureFlags]),PodcastUI=(0,_components_PodcastUI_usePodcastUI__WEBPACK_IMPORTED_MODULE_62__.M)(graphTokenProviderCallback,customRaiseHandPlayerFactory).PodcastUI;_ComponentBuilders_ChatContainer_customMessageRenderers__WEBPACK_IMPORTED_MODULE_42__.J.renderers.PodcastUI=PodcastUI;var ic3TokenProviderCallback=react__WEBPACK_IMPORTED_MODULE_0__.useCallback(function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.u1W)(appChatMsalTokenService,e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),[appChatMsalTokenService]),sharepointTokenProviderCallback=react__WEBPACK_IMPORTED_MODULE_0__.useCallback(function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e){var t;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(n){switch(n.label){case 0:return t=appChatMsalTokenService,[4,(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.OzJ)(t,e)];case 1:return[2,n.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),[appChatMsalTokenService]),lokiTokenProviderCallback=react__WEBPACK_IMPORTED_MODULE_0__.useCallback(function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(e){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){switch(t.label){case 0:return[4,(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.Wu7)(appChatMsalTokenService,e)];case 1:return[2,t.sent()]}}))}));return function(t){return e.apply(this,arguments)}}(),[appChatMsalTokenService]),oneNoteTokenProviderCallback=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.VEG)(appChatMsalTokenService)];case 1:return[2,e.sent()]}}))})),[appChatMsalTokenService]),safeLinksTokenProviderCallback=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.RLO)(appChatMsalTokenService,(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.BCo)())];case 1:return[2,e.sent()]}}))})),[appChatMsalTokenService]),substrateTokenProviderCallback=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.sJD)(appChatMsalTokenService)];case 1:return[2,e.sent()]}}))})),[appChatMsalTokenService]),cognitiveTokenProviderCallback=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(e){switch(e.label){case 0:return[4,(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.XXj)(appChatMsalTokenService)];case 1:return[2,e.sent()]}}))})),[appChatMsalTokenService]),getHostAppTokens=react__WEBPACK_IMPORTED_MODULE_0__.useCallback((function(){return(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.Gh)()||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.$U2)()?{graphTokenProvider:graphTokenProviderCallback,sharepointTokenProvider:sharepointTokenProviderCallback}:{}}),[graphTokenProviderCallback,sharepointTokenProviderCallback]),_useState10=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(getHostAppTokens()),2),tokenProvider=_useState10[0],setTokenProvider=_useState10[1],_useState11=(0,_swc_helpers_sliced_to_array__WEBPACK_IMPORTED_MODULE_82__._)((0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(copilotFeatureFlags),2),copilotChatFeatureFlags=_useState11[0],setCopilotFeatureFlags=_useState11[1];react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){initializeLocalFileUpload()}),[lokiTokenProviderCallback]);var initializeLocalFileUpload=function(){var e=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_77__._)((function(){var e;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_78__.__generator)(this,(function(t){return((e=(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.qQ)())||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.nId)())&&""!==wordClientInfoRef.current.userPrincipalName&&(setTokenProvider((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{lokiTokenProvider:lokiTokenProviderCallback})})),e&&setCopilotFeatureFlags((0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},copilotChatFeatureFlags),{isLocalFileUploadEnabled:!0}))),[2]}))}));return function(){return e.apply(this,arguments)}}();react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){(0,_backend_utils_FeatureSetting__WEBPACK_IMPORTED_MODULE_32__.gP)()&&""!==wordClientInfoRef.current.userPrincipalName&&setTokenProvider((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{oneNoteTokenProvider:oneNoteTokenProviderCallback})}))}),[oneNoteTokenProviderCallback]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.SBS)()&&setTokenProvider((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{safeLinksTokenProvider:safeLinksTokenProviderCallback})}))}),[safeLinksTokenProviderCallback]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.qij)()&&setTokenProvider((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{substrateTokenProvider:substrateTokenProviderCallback})}))}),[substrateTokenProviderCallback]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.LSW)()&&setTokenProvider((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{ic3TokenProvider:ic3TokenProviderCallback})}))}),[ic3TokenProviderCallback]),react__WEBPACK_IMPORTED_MODULE_0__.useEffect((function(){(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.DOP)()&&((0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.X$8)()||(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.PrP)())&&setTokenProvider((function(e){return(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},e),{cognitiveTokenProvider:cognitiveTokenProviderCallback})}))}),[cognitiveTokenProviderCallback]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){var e=getHostAppTokens();setTokenProvider((function(t){return(0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},t,e)}))}),[getHostAppTokens]);var setHeaderElemet=function(){return(0,_components_ComprehensionPinnedView__WEBPACK_IMPORTED_MODULE_59__.j)((function(){((0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.mRe)()?_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__.xb:_components_CopilotWorkspaces_utils__WEBPACK_IMPORTED_MODULE_51__.Mx)(),setActiveView("comprehension")}))},accountInfoForBizchat=react__WEBPACK_IMPORTED_MODULE_0__.useMemo((function(){var e;if(copilotChatFeatureFlags.enableBizChatInAppAuthDialog&&(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.gte)()){var t,n=userObject.objectId?{objectId:userObject.objectId,tenantId:userObject.tenantId,accountType:null!==(t=null===(e=userObject.authorityType)||void 0===e?void 0:e.toUpperCase())&&void 0!==t?t:""}:void 0;return!(null==n?void 0:n.accountType)&&(null==n?void 0:n.objectId)&&(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("Failed to fetch authorityType from OfficeJS"),n}}),[userObject]),commonCopilotChatProps={copilotCommunicationHandler,hostInjectedContextManager:copilotCommunicationHandler.hostInjectedContextManager,platformType:(0,_1js_officeaicopilot_ui__WEBPACK_IMPORTED_MODULE_100__.xp)(),style:(0,_WordCopilotChat_style__WEBPACK_IMPORTED_MODULE_54__.Gc)(showExpandedLoop),useALRuntime:!1,ref:copilotChatRef,chatUiProps,theme:copilotChatTheme,themeV2:(0,_office_officeaicopilot_core__WEBPACK_IMPORTED_MODULE_3__.IdZ)(_themeHandler_wordTheme__WEBPACK_IMPORTED_MODULE_26__.Yw,theme,isHighContrast,(0,_LoadWordCopilotStrings__WEBPACK_IMPORTED_MODULE_55__.xt)()?"rtl":"ltr",(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.K$l)()?_AppConstants__WEBPACK_IMPORTED_MODULE_2__.FEx:void 0),basicChatProps,copilotTelemetryHandler:_backend_SharedHandlers_TelemetryHandler__WEBPACK_IMPORTED_MODULE_12__.B.getInstance(),debugProps,copilotPluginProps:copilotPluginPropsToSet,copilotFeatureFlags:copilotChatFeatureFlags,hostTokenProviders:appChatHostTokenProvider,hostAppAuthTokens:tokenProvider,wasChatPaneAutoOpened:_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.IsSettingTrue(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.AutoOpenChatPane),getHeaderElement:hasEnteredComprehensionView&&"chat"===activeView?setHeaderElemet:void 0,initSideQuestEditor:_backend_utils_utils__WEBPACK_IMPORTED_MODULE_33__.lt,getTenantId:_utils__WEBPACK_IMPORTED_MODULE_20__.EO,hostAccountInfo:accountInfoForBizchat,customM365ChatProps:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.gd4)()&&{scenarioName:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.p7z,sourceName:_AppConstants__WEBPACK_IMPORTED_MODULE_2__.idh}),{allowSydneyConfigOverrideInUrl:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.gc0)()}),bizChatHostContext,handoffProperties:bizChatHandoffProperties,getDocSensitivityLabel:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.DI8)()?_components_sharedComponent_utils_Clp_ClpSensitivityHandler__WEBPACK_IMPORTED_MODULE_4__.n.getInstance().getInDocSensitiveLabelUsingOfcJs:void 0},ariaAnnouncerStyles=(0,_ChatUiStyle__WEBPACK_IMPORTED_MODULE_35__.w6)();(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.InH)()&&!ariaAnnouncerRef.current&&(ariaAnnouncer=react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:ariaAnnouncerStyles.ariaAnnouncer,ref:ariaAnnouncerRef,"aria-live":"assertive","aria-atomic":"true"})),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){if((0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__._74)()&&(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.InH)()&&!(null==ariaAnnouncerRef?void 0:ariaAnnouncerRef.current)){(0,_utils__WEBPACK_IMPORTED_MODULE_20__.cY)("ariaAnnouncerRef is null. Creating a fallback announcer.");var e=document.createElement("div");e.className=ariaAnnouncerStyles.ariaAnnouncer,e.setAttribute("aria-live","assertive"),e.setAttribute("aria-atomic","true"),document.body.appendChild(e),ariaAnnouncerRef.current=e,_backend_SharedHandlers_CopilotChatUIHelper__WEBPACK_IMPORTED_MODULE_6__.$.getInstance().setAriaAnnouncerRef(ariaAnnouncerRef)}return function(){(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__._74)()&&ariaAnnouncerRef.current&&(document.body.removeChild(ariaAnnouncerRef.current),ariaAnnouncerRef.current=null)}}),[]);var features=[(0,_experiments_reviewerAgentFeature__WEBPACK_IMPORTED_MODULE_64__.t)()],_copilotChatDialogContextJson_props,copilotChatSelector=react__WEBPACK_IMPORTED_MODULE_0__.createElement(_1js_officeaicopilot_featureregistry__WEBPACK_IMPORTED_MODULE_101__.Q,{featureDefinitions:features,communicationHandler:copilotCommunicationHandler},!isCopilotChatDialogLaunched&&(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.vLn)()?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_1js_officeaicopilot_chat_core__WEBPACK_IMPORTED_MODULE_83__.LocalizedCopilotChatCore,(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},commonCopilotChatProps),{locale:(0,_LoadWordCopilotStrings__WEBPACK_IMPORTED_MODULE_55__.mf)()})):(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.dl4)()&&copilotChatDialogContextJson&&copilotChatDialogContextJson.appName===_backend_Enums_ChatDialogContext__WEBPACK_IMPORTED_MODULE_61__.u.RESEARCH?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_1js_officeaicopilot_ui__WEBPACK_IMPORTED_MODULE_102__.N,{theme:copilotChatTheme},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Agents_LazyLoadedAgents__WEBPACK_IMPORTED_MODULE_49__.Wv,{alSession:session,isTestApp:!1,theme:copilotChatTheme,copilotFeatureFlags:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},copilotChatFeatureFlags),{enableInsightsCard:!0,showWelcomeExperience:!1,isQueryWarmupSignalEnabled:!1}),initialFileCount:0,entityPickerPropsValue:null!==(_copilotChatDialogContextJson_props=copilotChatDialogContextJson.props)&&void 0!==_copilotChatDialogContextJson_props?_copilotChatDialogContextJson_props:void 0})):(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.X$8)()&&copilotChatDialogContextJson&&copilotChatDialogContextJson.appName===_backend_Enums_ChatDialogContext__WEBPACK_IMPORTED_MODULE_61__.u.CUA?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_1js_officeaicopilot_ui__WEBPACK_IMPORTED_MODULE_102__.N,{theme:copilotChatTheme},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Agents_LazyLoadedAgents__WEBPACK_IMPORTED_MODULE_49__.sL,{alSession:session,documentURL:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.sx9)()&&null!=documentURL?documentURL:"",isTestApp:!1,theme:copilotChatTheme,hostAppAuthTokens:tokenProvider,copilotFeatureFlags:{isOutputV2Enabled:!0,interactiveCardLoadingTimeout:9e4,promptInputLength:3e3,isEnabledLocalCUAAgent:!0,cuaOperatorUrl:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.d3Q)(),cuaVMUrl:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.iWh)()}})):react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_1js_officeaicopilot_chat_core__WEBPACK_IMPORTED_MODULE_83__.LocalizedCopilotChatCore,(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},commonCopilotChatProps),{chatUiProps:(0,_swc_helpers_object_spread_props__WEBPACK_IMPORTED_MODULE_70__._)((0,_swc_helpers_object_spread__WEBPACK_IMPORTED_MODULE_71__._)({},commonCopilotChatProps.chatUiProps),{hideAgentSwitcherMenuPane:!0}),locale:(0,_LoadWordCopilotStrings__WEBPACK_IMPORTED_MODULE_55__.mf)()})),(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.InH)()&&ariaAnnouncer)),defaultPaneWidth=(.75*_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.Vv.getSettingAsNumber(_backend_office_js_HostAppSettings__WEBPACK_IMPORTED_MODULE_7__.zj.DefaultPaneWidth)).toString()+"px";return isReviewerAgentEnabledStatus?isLoopExpansionEnabled?react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"ms-welcome",onKeyDown:keyDownHandler},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{display:"flex",flexDirection:"row"}},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{width:"calc(100vw - ".concat(defaultPaneWidth,")")}}," ",showExpandedLoop&&getLoopCardCallback()),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{width:showExpandedLoop?defaultPaneWidth:"auto"}},(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.N_q)()&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Reload_ReloadComponent__WEBPACK_IMPORTED_MODULE_36__.A,{sdxVersion:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.N_q)()}),isWaiting?react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",null,"Loading Chat..."):copilotChatSelector))):react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"ms-welcome",onKeyDown:keyDownHandler},(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.N_q)()&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Reload_ReloadComponent__WEBPACK_IMPORTED_MODULE_36__.A,{sdxVersion:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.N_q)()}),isWaiting?react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",null,"Loading Chat..."):copilotChatSelector):isLoopExpansionEnabled?react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"ms-welcome",onKeyDown:keyDownHandler},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{display:"flex",flexDirection:"row"}},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{width:"calc(100vw - ".concat(defaultPaneWidth,")")}}," ",showExpandedLoop&&getLoopCardCallback()),react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{width:showExpandedLoop?defaultPaneWidth:"auto"}},(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.N_q)()&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Reload_ReloadComponent__WEBPACK_IMPORTED_MODULE_36__.A,{sdxVersion:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.N_q)()}),copilotChatSelector))):react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:"ms-welcome",onKeyDown:keyDownHandler},(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.N_q)()&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_components_Reload_ReloadComponent__WEBPACK_IMPORTED_MODULE_36__.A,{sdxVersion:(0,_backend_utils_FeatureGates__WEBPACK_IMPORTED_MODULE_22__.N_q)()}),copilotChatSelector)},__WEBPACK_DEFAULT_EXPORT__=WordCopilotChat},898998:(e,t,n)=>{"use strict";n.d(t,{D:()=>p});var r=n(806523),o=n(103218),a=n(475119),i=n(911501),s=n(423905),c=n(83437),l=n(481797),u=function(){return u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},u.apply(this,arguments)},d=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},_=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},p=function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.startTime=0,this.useDimensionsV2=!1,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},(0,a.cY)("MsgExtDialogLauncher : Task Module dialog closed")},this.shouldUseDimensionsV2=function(e){t.useDimensionsV2=e},this.logDialogTelemetry=function(e,n){var r=Date.now();(0,s.js)(r-t.startTime,e,null!=n?n:""),e||(0,s.jC)(null!=n?n:"")},this.onMessageCallback=function(n){return d(t,void 0,void 0,(function(){var t,o,l,d,p,g,f,h,C,m,v,E,y,b;return _(this,(function(_){switch(_.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(n)).type!==r.o.Ack?[3,1]:(o=(0,i.jX)(this.taskModuleProps),d={dialogContent:null===(m=this.taskModuleProps)||void 0===m?void 0:m.dialogContent,appDefinition:null===(v=this.taskModuleProps)||void 0===v?void 0:v.appDefinition,clientInfo:null===(E=this.taskModuleProps)||void 0===E?void 0:E.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:o,hostConfigFlags:null===(y=this.taskModuleProps)||void 0===y?void 0:y.hostConfigFlags,copilotChatThemev2:e.theme,source:"AppChat"},this.openedDialog.dialog.messageChild(JSON.stringify(d),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0),[3,6]):(this.logDialogTelemetry(!1,"MsgExtDialogLauncher.onMessageCallback : No active dialog found"),[2]);case 1:return t.type!==r.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==r.o.onServiceRequest)return[3,6];null===(b=a.EG.setQueryGuid)||void 0===b||b.call(a.EG,t.requestId),(0,a.cY)("MsgExtDialogLauncher : Received service request from dialog",t),l={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},a.EG.sendChatEventTelemetry((0,s.pN)(((f={})[c.h3.ChatEventType]=c.a5.TaskModuleServiceRequest,f[c.h3.ChatEventParameters]=JSON.stringify(l),f))),d={requestId:t.requestId,messageType:r.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},_.label=3;case 3:return _.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(p=_.sent())&&(d.result=p),(0,a.cY)("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),a.EG.sendChatEventTelemetry((0,s.pN)(((h={})[c.h3.ChatEventType]=c.a5.TaskModuleServiceResponse,h[c.h3.ChatEventParameters]=JSON.stringify(l),h))),this.openedDialog.dialog.messageChild(JSON.stringify(d),{targetOrigin:window.location.origin}),[3,6];case 5:return g=_.sent(),(0,a.cY)("MsgExtDialogLauncher : Error executing plugin operation",g),a.EG.sendErrorTelemetry((0,s.pN)(((C={})[c.IC.ErrorMessage]=JSON.stringify(u(u({},l),{error:g})),C[c.IC.ErrorCategory]=c.S2.ExtensibilityDialog,C[c.IC.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),C))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var n;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(n=t.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.onDialogError=function(e){var n="Error opening dialog";if(e)try{n=JSON.stringify(e)}catch(e){(0,a.cY)("MsgExtDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"MsgExtDialogLauncher : ".concat(n))},this.openDialogForWebPlatformAsNewWindow=function(e,n){return d(t,void 0,void 0,(function(){var t,r,o=this;return _(this,(function(a){switch(a.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=(0,i.jX)(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return r=(0,l.zC)(),[4,Office.context.ui.displayDialogAsync(r,{displayInIframe:!1,hideTitle:!0,height:e,width:n,promptBeforeOpen:!1},(function(e){return d(o,void 0,void 0,(function(){var n,r,o=this;return _(this,(function(a){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(r=null===(n=this.taskModuleProps)||void 0===n?void 0:n.triggeringActionTitle)&&void 0!==r?r:""},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return d(o,void 0,void 0,(function(){return _(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return d(o,void 0,void 0,(function(){return _(this,(function(t){return e.error===l.Y7&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return a.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,n){return d(t,void 0,void 0,(function(){var t,r,o,i=this;return _(this,(function(s){return this.shouldDisplayDismissIcon=!1,t=(0,l.zC)(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(o=null===(r=this.taskModuleProps)||void 0===r?void 0:r.dialogTitle)&&void 0!==o?o:a.$9,hideTitle:!0,height:e,width:n,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){i.openedDialog.dialog=e})).catch((function(e){i.onDialogError(e),(0,a.cY)("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e){return d(t,void 0,void 0,(function(){var t,n,r,a,s,c,l;return _(this,(function(u){return this.startTime=Date.now(),this.taskModuleProps=e,t=0,n=0,this.useDimensionsV2?(a=(0,i.iR)(e),t=a.dialogHeight,n=a.dialogWidth):(r=null===(c=e.clientInfo)||void 0===c?void 0:c.clientType,s=r===o.WK.web?(0,i.aT)(e):(0,i.rT)(e),t=s.dialogHeight,n=s.dialogWidth),(null===(l=e.clientInfo)||void 0===l?void 0:l.clientType)===o.WK.web?this.openDialogForWebPlatformAsNewWindow(t,n):this.openDialogForNativePlatform(t,n),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}return e.getInstance=function(){return e.instance||new e},e.setTheme=function(t){e.theme=t},e}()},902296:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(475119),o=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},a=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},i=function(){return o(void 0,void 0,void 0,(function(){var e,t;return a(this,(function(n){switch(n.label){case 0:if(!(0,r.$$)()&&!(0,r.fU)())return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.PrivateApi.execute("SHOW_COPILOT_PRODIGY_UPSELL_FLOW")];case 2:return e=n.sent(),(0,r.cY)(e),[3,4];case 3:return t=n.sent(),(0,r.cY)("Error Executing SHOW_COPILOT_PRODIGY_UPSELL_FLOW"+t),[3,4];case 4:return[3,7];case 5:return[4,Office.license.launchUpsellExperience("copilotsidepanel_creditlimit")];case 6:n.sent(),n.label=7;case 7:return[2]}}))}))}},904182:(e,t,n)=>{"use strict";var r=n(182755),o=n(46692),a=n(12163),i=n(83437),s=function(){return s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},s.apply(this,arguments)},c=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},l=function(){function e(){}return e.prototype.sendTelemetryEvent=function(e){"undefined"!=typeof Office&&Office.sendTelemetryEvent(e)},e}();!function(){function e(){this.alwaysCriticalEvents=null,this.oTelLogger=new r.M,this.telemSink=new l,this.setupTelemetryLogger(this.oTelLogger)}e.prototype.getDefaultEventFlags=function(){return{dataCategories:o.o.DataCategories.ProductServicePerformance|o.o.DataCategories.ProductServiceUsage,diagnosticLevel:o.o.DiagnosticLevel.RequiredServiceData}},e.prototype.getTelemetrySink=function(){return this.telemSink},e.prototype.sendTelemetryEvent=function(e){this.isAlwaysCriticalEvent(e)&&(e.eventFlags.samplingPolicy=o.o.SamplingPolicy.CriticalUsage),this.oTelLogger.sendTelemetryEvent(e)},e.prototype.logEvent=function(e,t){this.logTelemetryEvent(e,t)},e.prototype.logUncaughtException=function(e){var t=[],n="";e instanceof Error&&(e.message&&(n=e.message),e.stack&&t.push({key:"Stack",value:e.stack})),this.logTelemetryErrorEvent({eventType:i.S2.UncaughtException,errorMessage:n,logLevel:i.$b.Critical},void 0,t)},e.prototype.logError=function(e,t,n){this.logTelemetryErrorEvent(e,t,n)},e.prototype.isAlwaysCriticalEvent=function(e){return!1},e.prototype.getTelemetryProperties=function(){return{ariaTenantToken:e.AriaTenantToken,nexusTenantToken:e.NexusTenantToken}},e.prototype.getDefaultEventDataFields=function(){return this.getDataFields(this.getDefaultTelemetryData())},e.prototype.getDefaultTelemetryData=function(){return[{key:"UserQueryGuid",value:e.userQueryGuid}]},e.prototype.logTelemetryEvent=function(e,t){var n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?s(s({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:c(c([],this.getDefaultEventDataFields(),!0),this.getDataFields(e.eventData||[]),!0)};this.sendTelemetryEvent(n)},e.prototype.getActionAITelemetryErrorEvent=function(e,t,n){return n||(n=[]),n.find((function(e){return"Message"===e.key}))||n.push({key:"Message",value:e.errorMessage}),n.find((function(e){return"LogLevel"===e.key}))||n.push({key:"LogLevel",value:e.logLevel}),{eventName:"Office.Voice.ActionAI."+i.S2.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?s(s({},this.getDefaultEventFlags()),t):this.getDefaultEventFlags(),dataFields:c(c([],this.getDefaultEventDataFields(),!0),this.getDataFields(n),!0)}},e.prototype.logTelemetryErrorEvent=function(e,t,n){this.oTelLogger.sendError(this.getActionAITelemetryErrorEvent(e,t,n))},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?(0,a.ip)(e.key,e.value):"string"==typeof e.value?(0,a.m9)(e.key,e.value):"boolean"==typeof e.value?(0,a.LK)(e.key,e.value):(0,a.m9)(e.key,String(e.value))}))},e.prototype.setupTelemetryLogger=function(t){t.setTenantToken("Office.Voice.ActionAI",e.AriaTenantToken,e.NexusTenantToken),t.setTenantToken("Office.Voice.Copilot",e.AriaTenantToken,e.NexusTenantToken),t.addSink(this.telemSink)},e.prototype.getLogLevelForErrorCategory=function(e){return i.$b.Error},e.AriaTenantToken="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",e.NexusTenantToken=1763,e.userQueryGuid="",e.userQueryOrder=0,e.conversationId=void 0}()},909827:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{N:()=>runCodeOnDocument,d:()=>runCodeOnRange});var _swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(743032),_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(379490),_frontend_utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(242154),_getWordObject__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(49674),evalOfficeJSToolCode=(_ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__._)((function(e,t){var n,r;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e(t)];case 1:return n=o.sent(),(0,_frontend_utils__WEBPACK_IMPORTED_MODULE_0__.cY)(n),[3,3];case 2:return r=o.sent(),(0,_frontend_utils__WEBPACK_IMPORTED_MODULE_0__.cY)("Syntax Error jsCode: ".concat(t,"  \n Error: ").concat(r.message)),n="Syntax Error jsCode: ".concat(t,"  \n Error: ").concat(r.message),[3,3];case 3:return[2,n]}}))})),function(e,t){return _ref.apply(this,arguments)}),_ref,runCodeOnDocument=function(){var _ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__._)((function(this_Document_wordObjId,code){var asyncFunction;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(_state){switch(_state.label){case 0:return asyncFunction=function(){var _ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__._)((function(jsCode){var this_Document,result;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(_state){switch(_state.label){case 0:return this_Document=(0,_getWordObject__WEBPACK_IMPORTED_MODULE_1__.w)().get(this_Document_wordObjId),this_Document?[4,eval(jsCode)]:[2,"Error: Unable to find Document object with ID ".concat(this_Document_wordObjId)];case 1:return result=_state.sent(),[2,result?result.toString():"Successfully executed code on Document object"]}}))}));return function(e){return _ref.apply(this,arguments)}}(),[4,evalOfficeJSToolCode(asyncFunction,code)];case 1:return[2,_state.sent()]}}))}));return function(e,t){return _ref.apply(this,arguments)}}(),runCodeOnRange=function(){var _ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__._)((function(this_Range_wordObjId,code){var asyncFunction;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(_state){switch(_state.label){case 0:return asyncFunction=function(){var _ref=(0,_swc_helpers_async_to_generator__WEBPACK_IMPORTED_MODULE_2__._)((function(jsCode){var this_Range,result;return(0,_swc_helpers_ts_generator__WEBPACK_IMPORTED_MODULE_3__.__generator)(this,(function(_state){switch(_state.label){case 0:return this_Range=(0,_getWordObject__WEBPACK_IMPORTED_MODULE_1__.w)().get(this_Range_wordObjId),this_Range?[4,eval(jsCode)]:[2,"Error: Unable to find Range object with ID ".concat(this_Range_wordObjId)];case 1:return result=_state.sent(),[2,result?result.toString():"Successfully executed code on Range object"]}}))}));return function(e){return _ref.apply(this,arguments)}}(),[4,evalOfficeJSToolCode(asyncFunction,code)];case 1:return[2,_state.sent()]}}))}));return function(e,t){return _ref.apply(this,arguments)}}()},911443:(e,t,n)=>{"use strict";n.d(t,{DY:()=>s,_s:()=>o,dD:()=>c});var r,o,a=n(352628),i=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(function(e){function t(t,n){var r=e.call(this,n)||this;return r.name=t,r}return i(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(o||(o={}));var c=function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.isTier4LanguagesEnabled=!1,this.supportedLanguages=[]}return Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier4LanguagesEnabled",{set:function(e){this.isTier4LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var n=1;n<t.length-1;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),n=0;n<this.supportedLanguages.length;n++){var r=this.supportedLanguages[n];if(t[0]===r.split("-")[0])return r}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new s(o.InvalidInput," Display Language is undefined or null");var n=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(n),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.supportedLanguages=a.h7,this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(a.k$),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(a.b_))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(a.LJ)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(a.zi)),this.isTier4LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(a.GN))},e}()},911501:(e,t,n)=>{"use strict";n.d(t,{aT:()=>c,iR:()=>s,jX:()=>i,rT:()=>l});var r=n(764081),o=n(475119),a=n(481797),i=function(e){var t={appId:"",botId:"",cardId:""};if(!(null==e?void 0:e.cardData))return(0,o.cY)("msgExtension Utils: cardData is not present in taskModuleProps"),t;try{var n=JSON.parse(e.cardData);t={appId:n.appId,botId:n.botId,cardId:n.cardId}}catch(e){(0,o.cY)("msgExtension Utils: Failed to extract cardId from cardData")}return t},s=function(e){var t,n;if(e.viewMode!==r.oY)return{dialogHeight:r.Qt,dialogWidth:r.Qt};var o=(0,a.Cd)(null===(t=e.dialogContent)||void 0===t?void 0:t.height),i=(0,a.Cd)(null===(n=e.dialogContent)||void 0===n?void 0:n.width),s=!0,c=!0,l=r.t9,u=r.OY;o<=0&&(c=!1,l=(0,a.wc)(o)),i<=0&&(s=!1,u=(0,a.tP)(i));var d=screen.width,_=screen.height;return c&&(l=(0,a.Xz)(o,_)),s&&(u=(0,a.Xz)(i,d)),{dialogHeight:l,dialogWidth:u}},c=function(e){var t,n;if(e.viewMode===r.oY){var o=null===(t=e.dialogContent)||void 0===t?void 0:t.height,a=null===(n=e.dialogContent)||void 0===n?void 0:n.width;if(!o||!a||"number"!=typeof a||"number"!=typeof o)return{dialogHeight:r.t9,dialogWidth:r.OY};var i=screen.width,s=screen.height;return{dialogHeight:Math.floor(o/s*100),dialogWidth:Math.floor(a/i*100)}}return{dialogHeight:r.Qt,dialogWidth:r.Qt}},l=function(e){var t,n,a,i,s=e.viewMode,c=s===r.oY?window.outerWidth:window.innerWidth,l=s===r.oY?window.outerHeight:window.innerHeight,u=s===r.oY?o.nG:0,d=s===r.oY?o.ae:0,_=null===(t=e.dialogContent)||void 0===t?void 0:t.height,p=null===(n=e.dialogContent)||void 0===n?void 0:n.width;try{if("number"==typeof p&&"number"==typeof _&&p<=c&&_<=l){var g=Math.floor(_/l*100),f=Math.floor(p/c*100);a=g+u,i=f+d}else a=r.t9,i=r.OY}catch(e){a=r.t9,i=r.OY}return{dialogHeight:a,dialogWidth:i}}},916472:(e,t,n)=>{"use strict";n.d(t,{z:()=>s});var r=n(193536),o=n(350065),a=n(413),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function s(){return[i({},(0,o.D)(r.T.ProactiveDocumentSummaryGlance)),i({},(0,o.D)(r.T.CollabCatchup)),i({},(0,o.D)(r.T.DocumentRelevance)),i({},(0,o.D)(r.T.DocumentCommentator)),i({},(0,o.D)(r.T.DocumentInsights)),i({},(0,a.X)(r.T.RelatedFiles))]}},918948:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});var r=n(475119),o=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},a=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},i=function(){function e(e,t,n,r){this.msalInstance=e,this.accountProvider=t,this.interactiveTokenQueue=n,this.msalModule=r}return e.prototype.createTokenRequest=function(e,t){return{scopes:["".concat(e,"/.default")],account:t}},e.prototype.acquireToken=function(e){return o(this,void 0,void 0,(function(){var t,n,o,i,s;return a(this,(function(a){switch(a.label){case 0:if(t=this.getResourceType(),!this.msalInstance)throw(0,r.cY)("DialogTokenService : Failed to acquire ".concat(t," MSAL instance.")),new Error("DialogTokenService : Failed to acquire ".concat(t," MSAL instance"));a.label=1;case 1:return a.trys.push([1,4,,5]),[4,this.accountProvider.getAccount(this.msalInstance)];case 2:if(!(n=a.sent()))throw(0,r.cY)("DialogTokenService : No account found for ".concat(t," resource.")),new Error("DialogTokenService : No account found for ".concat(t," resource"));return o=this.createTokenRequest(e.resource,n),[4,this.msalInstance.acquireTokenSilent(o)];case 3:return[2,{authToken:a.sent().accessToken}];case 4:if(i=a.sent(),this.msalModule&&i instanceof this.msalModule.InteractionRequiredAuthError){if(!this.interactiveTokenQueue)throw new Error("DialogTokenService : Interactive token queue not initialized");return s="1P"===t,[2,this.interactiveTokenQueue.enqueue(e,s,this.shouldFallbackTo3PResource())]}throw(0,r.cY)("DialogTokenService : Error acquiring ".concat(t," token: ").concat(i)),new Error("DialogTokenService : Error acquiring ".concat(t," token"));case 5:return[2]}}))}))},e}()},921773:(e,t,n)=>{"use strict";n.d(t,{n:()=>_});var r=n(208520),o=n(998088),a=n(806220),i=n(475119),s=n(194530),c=n(110213),l=n(801744),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},_=function(e,t,n){(0,i.cY)("ClipChamp Init: useClipChampCard");return{ClipChampCard:function(_){var p=(0,s.h)(),g=(0,i.$K)(t.augloopUrl),f=r.useCallback((function(){return u(void 0,void 0,void 0,(function(){var n;return d(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,(0,a.ki)(e,t.augloopUrl)];case 1:return[2,r.sent().accessToken];case 2:throw n=r.sent(),(0,i.cY)("Error fetching Augloop token"),n;case 3:return[2]}}))}))}),[e,t.augloopUrl]);return r.createElement("div",{className:p.root},_.cardHeaderText&&r.createElement(c.c,null,_.cardHeaderText),r.createElement(r.Suspense,{fallback:r.createElement("div",{className:p.spinnerContainer},r.createElement(l.y,{size:"extra-tiny"}))},r.createElement(o.aN,{text:_.videoOptionSetPrompt,identityType:n.identityType,userId:n.userId,tenantId:n.tenantId,isEu:t.isEUDBUser,tokenProvider:f,locale:t.locale||"en-US",conversationId:t.conversationId||"",physicalRing:g,videoChatMessage:_.videoChatMessage})))}}}},930935:(e,t,n)=>{"use strict";n.d(t,{dk:()=>r.d});var r=n(616478);n(309500)},932554:(e,t,n)=>{"use strict";n.d(t,{Dl:()=>E,I_:()=>T,L1:()=>P,Ms:()=>m,So:()=>A,TB:()=>I,Vv:()=>v,rA:()=>y,rj:()=>b,tV:()=>C,zj:()=>r});var r,o=n(743032),a=n(811912),i=n(791165),s=n(379490),c=n(354311),l=n(656904),u=n(242154),d=n(740389),_=n(249002),p=n(156845),g=n(602061);!function(e){e.AugLoopCloudALServiceUrlWAC="AugLoopCloudALServiceUrl",e.AugLoopCloudALServiceUrl="AugloopClouldALServiceUrl",e.ChatWordSessionID="WordCopilotSessionID",e.TriggerSummary="triggerSummary",e.SummaryFromNudge="summary",e.TriggerImageDescription="triggerImageDescription",e.ImageDescriptionAnnotation="imageDescriptionAnnotation",e.OpenPaneProactivelyWithSummary="openPaneProactivelyWithSummary",e.TriggerPodcast="triggerPodcast",e.PodcastFromNudge="podcast",e.OpenPaneProactivelyWithPodcast="openPaneProactivelyWithPodcast",e.AugloopSharedSessionID="AugloopSharedSessionID",e.WacSessionId="wacSessionId",e.CanonicalUserId="canonicalUserId",e.DocumentId="serverDocID",e.InitialWordCount="initialWordCount",e.HandoffMessageId="HandoffMessageId",e.AppStartTimestamp="AppStartTimestamp",e.CopilotPaneStartTimestamp="copilotPaneStartTimestamp",e.PrePopulatedPrompt="prePopulatedPrompt",e.HandoffMessage="HandoffMessage",e.handoffMessage="handoffMessage",e.AutoOpenChatPane="autoOpenChatPane",e.IsInteractiveReadOnlyMode="IsInteractiveReadOnlyMode",e.VoiceModeEntry="VoiceModeEntry",e.CopilotAgentToLoadAfterLaunch="agentId",e.BizChatEntry="BizChatEntry",e.ShouldUseEnvSpecificALUrl="ShouldUseEnvSpecificALUrl",e.IsCopilotContentGenerationDisabledByAdminControl="isCopilotContentGenerationDisabledbyAdminControl",e.FeedbackEnabled="FeedbackEnabled",e.InAppHelpCshEnabled="InAppHelpCshEnabled",e.DefaultPaneWidth="DefaultPaneWidth",e.IsCopilotChatDialog="IsCopilotChatDialog",e.IsCopilotInBackstageMode="CopilotInBackstageMode",e.CopilotChatDialogContext="copilotChatDialogContext",e.CopilotLicenseStatus="CopilotLicenseStatus",e.IsReadAloudModalessDialog="IsReadAloudModalessDialog"}(r||(r={}));var f,h=!1,C=!0,m=l.u1i,v=function(){function e(){(0,a._)(this,e)}return(0,i._)(e,null,[{key:"getSettingAsString",value:function(e){var t=Office.context.document.settings.get(e.toString());return(0,_.hX)(t)?t:(0,d.pJh)()&&"object"==typeof t?JSON.stringify(t):t.toString()}},{key:"getSettingAsNumber",value:function(e){var t=Office.context.document.settings.get(e.toString());return(0,_.hX)(t),t}},{key:"getSetting",value:function(e){return Office.context.document.settings.get(e.toString())}},{key:"setByKey",value:function(e,t){Office.context.document.settings.set(e,"string"==typeof t?t:JSON.stringify(t))}},{key:"setHostSettings",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=(0,_.gZ)(e[n]);t.setByKey(n,r)}))}},{key:"set",value:function(e,t){Office.context.document.settings.set(e,"string"==typeof t?t:JSON.stringify(t))}},{key:"IsSettingTrue",value:function(e){var t=this.getSettingAsString(e);return!!t&&"true"==t.toLowerCase()}},{key:"initializeHostAppSettingVariables",value:function(){return(0,o._)((function(){return(0,s.__generator)(this,(function(e){switch(e.label){case 0:return(0,d.Ssi)()?[4,(0,p.hC)()]:[3,2];case 1:return C=e.sent(),[3,4];case 2:return[4,(0,p.S8)()];case 3:C=e.sent(),e.label=4;case 4:return(0,u.cY)("isFeedbackEnabled: "+C),(0,d.mOp)()?[4,(0,p.fb)()]:[3,6];case 5:m=e.sent(),e.label=6;case 6:return[2]}}))}))()}},{key:"remove",value:function(e){Office.context.document.settings.remove(e)}}]),e}();function E(){var e;return null!==(e=v.getSettingAsString("AugloopClouldALServiceUrl"))&&void 0!==e?e:v.getSettingAsString("AugLoopCloudALServiceUrl")}function y(){return(0,g.s77)(E())}function b(){return(0,g.gSe)(E())}function T(){return h?((0,u.cY)("IsDogfoodEnvironment: "+h),!0):((!(0,_.hX)(v.getSettingAsString("AugloopClouldALServiceUrl"))&&v.getSettingAsString("AugloopClouldALServiceUrl").includes("dogfood")||!(0,_.hX)(v.getSettingAsString("AugLoopCloudALServiceUrl"))&&v.getSettingAsString("AugLoopCloudALServiceUrl").includes("dogfood"))&&(h=!0),(0,u.cY)("IsDogfoodEnvironment: "+h),h)}function I(){return y()===c.D.GCC}function P(){return y()===c.D.DOD}function A(){return void 0===f&&(f=v.IsSettingTrue("CopilotInBackstageMode")),f}},934761:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});var r=n(811912),o=n(791165),a=n(990813),i=function(){function e(){(0,r._)(this,e),(0,a._)(this,"contextIdList",void 0),(0,a._)(this,"cleanupCallback",void 0),(0,a._)(this,"skipContextIdCheckSet",void 0),this.contextIdList=new Set,this.cleanupCallback=new Set,this.skipContextIdCheckSet=new Set}return(0,o._)(e,[{key:"addContextId",value:function(e){this.contextIdList.add(e)}},{key:"removeContextId",value:function(e){this.contextIdList.delete(e)}},{key:"isValidAnnotationResponse",value:function(e){return this.skipContextIdCheckSet.has(e)||this.contextIdList.has(e)}},{key:"emptyContextIdListandCleanup",value:function(){this.contextIdList.clear(),this.cleanupCallback.forEach((function(e){return e()}))}},{key:"addHandlerCleanup",value:function(e){this.cleanupCallback.add(e)}},{key:"isRequestPending",value:function(){return this.contextIdList.size>0}},{key:"addToSkipContextCheckList",value:function(e){this.skipContextIdCheckSet.add(e)}},{key:"removeFromSkipContextCheckList",value:function(e){this.skipContextIdCheckSet.delete(e)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,a._)(i,"instance",void 0)},940965:(e,t,n)=>{"use strict";n.d(t,{k:()=>c});var r=n(632197),o=n(475119),a=n(217425),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.getToken(t,[],[a.w8.augloop])];case 1:return n=s.sent(),[2,(0,r.t)(n)];case 2:throw i=s.sent(),(0,o.cY)("Error fetching Augloop token:",i),i;case 3:return[2]}}))}))}},942774:(e,t,n)=>{"use strict";n.d(t,{Wv:()=>a,sL:()=>i,x2:()=>s});var r=n(602061),o=n(208520),a=function(e){var t=(0,r.Zl2)((function(){return Promise.all([n.e(9037),n.e(3341),n.e(4487)]).then(n.bind(n,522825)).then((function(e){return{default:e.ResearchApp}}))}),"researchnotebook");return o.createElement(o.Suspense,{fallback:o.createElement(o.Fragment,null,"Loading Data")},o.createElement(t,e))},i=function(e){var t=(0,r.Zl2)((function(){return Promise.all([n.e(9037),n.e(3341),n.e(6176)]).then(n.bind(n,868260)).then((function(e){return{default:e.CUAApp}}))}),"cuaexperience");return o.createElement(o.Suspense,{fallback:o.createElement(o.Fragment,null,"Loading Data")},o.createElement(t,e))},s=function(e){var t=(0,r.Zl2)((function(){return Promise.all([n.e(3062),n.e(9037),n.e(3341),n.e(5163)]).then(n.bind(n,239976)).then((function(e){return{default:e.Research}}))}),"researchworkspace");return o.createElement(o.Suspense,{fallback:o.createElement(o.Fragment,null,"Loading Data")},o.createElement(t,e))}},946084:(e,t,n)=>{"use strict";n.d(t,{o:()=>g});var r=n(468450),o=n(528899),a=n(280205),i=n(784567),s=n(798050),c=n(61714),l=n(475119),u=n(265167),d=n(208520),_=n(83437),p=n(387039),g=function(e){var t=(0,d.useCallback)((function(t){var n=(0,c.A)(),a={promptType:r.t.RelatedFiles,sourceFileIdentifier:t?{fileUrl:t}:void 0},s=new i.Xr({parentPath:["Signal",o.D.getTypeName()],items:[{id:u.r.generateId(),body:new o.D(a)}]}),l=(new Date).getTime();return null==e||e(n,l),f(_.a5.InsightsCardRelatedFilesSignalSent,l),s}),[e]),n=(0,d.useCallback)((function(e,t,n){var r,o,i;if(e.body&&a.xc.typeGuard(e.body)){f(_.a5.InsightsCardRelatedFilesResponse,(new Date).getTime());var u,d={list:[],headerDescription:"",maxEntityCount:l.x6,suggestedPrompts:[]},h=e.body;try{if(0===h.status){var C=null==h?void 0:h.RelatedFiles;if(0!==(null==C?void 0:C.length)){var m;m=C.map((function(e){var t;return{id:(0,c.A)(),fileId:e.fileId,text:e.name,contentType:e.fileType,url:e.link,subText:null!==(t=e.description)&&void 0!==t?t:" "}})),(0,l.cY)("mappedFiles",m);var v=(null!==(o=null===(r=e.body)||void 0===r?void 0:r.suggestedPrompts)&&void 0!==o?o:[(0,l.Mv)(),(0,l.Td)(),(0,l.Kd)()]).map((function(e){return{text:e,onClick:function(e,n){var r,o;return(null===(r=null==t?void 0:t.current)||void 0===r?void 0:r.getIsExecuting())?void 0:g(e,null===(o=null==t?void 0:t.current)||void 0===o?void 0:o.updateDraftForEntity,n)}}}));d={list:m,headerDescription:(0,l.CR)(),maxEntityCount:3,suggestedPrompts:v},u=s.x.LOADED}else(0,l.cY)("CFD response returned empty related files"),u=s.x.ERRORED,f(_.a5.AugLoopOfficeCopilotOrchestrationCopilotRelatedFilesError,"EmptyResponse")}else(0,l.cY)("CFD response status not success"),u=s.x.ERRORED,f(_.a5.AugLoopOfficeCopilotOrchestrationCopilotRelatedFilesError,null!==(i=p.lC[h.status])&&void 0!==i?i:"StatusNotSuccess")}catch(e){(0,l.cY)("Error processing related files response:",e),u=s.x.ERRORED,f(_.a5.AugLoopOfficeCopilotOrchestrationCopilotRelatedFilesError,"UnexpectedError")}n&&d&&(null==n||n.forEach((function(e){var t;s.E.RELATEDFILES===(null==e?void 0:e.tabType)&&(null===(t=null==e?void 0:e.updateContent)||void 0===t||t.call(e,d,u))})))}}),[]),g=(0,d.useCallback)((function(e,t,n){var r=n===(0,l.Kd)()?n:"".concat(n).concat((0,l.Lx)()),o={text:e.text,url:e.url,id:e.fileId,type:"File",metadata:{Id:e.id,Type:"File",Source:{Title:e.text,FileName:e.text,FileType:e.contentType,Path:e.url,FileExtension:e.contentType}},metadataState:"Full"};t({text:"".concat(r," <entity type='").concat(o.type,"' ReferenceId='").concat(o.id,"'>").concat(o.text,"</entity>"),hydratedEntities:[o]})}),[]),f=function(e,t){var n=[{key:_.h3.ChatEventType,value:e}];t&&n.push({key:_.h3.ChatEventParameters,value:t}),l.EG.sendChatEventTelemetry(n)};return{callCFDRelatedFilesSignal:t,handleCFDRelatedFilesResponse:n,addEntityInInputbox:g}}},946562:(e,t,n)=>{"use strict";n.d(t,{f:()=>a});var r=n(208520),o=n(673744),a=function(e){r.useEffect((function(){var t=o.U.subscribe(e);return function(){t()}}),[])}},951405:(e,t,n)=>{"use strict";var r;n.d(t,{u:()=>r}),function(e){e.VOICE="RealtimeVoice",e.RESEARCH="CopilotResearch",e.CUA="CUA"}(r||(r={}))},951903:(e,t,n)=>{"use strict";n.d(t,{LQ:()=>c,pi:()=>s});var r=n(681672),o=n(61714),a=n(334130),i=function(e){return/^data:image\/[a-zA-Z]+;base64,/.test(e)},s=function(e){if(i(e)){for(var t=e.split(",")[1],n=atob(t),a=new Uint8Array(new ArrayBuffer(n.length)),s=0;s<n.length;s++)a[s]=n.charCodeAt(s);var c=function(e){return e.startsWith("data:image/png")?{format:r.f.Png}:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?{format:r.f.Jpg}:e.startsWith("data:image/bmp")?{format:r.f.Bmp}:{format:r.f.Other,otherFormat:e.split(";")[0].split(":")[1]}}(e),l=c.format,u=c.otherFormat;return{contents:[{id:(0,o.A)(),size:r.h.Unspecified,format:l,otherFormat:u,data:Array.from(a),sizeBytes:a.length}],widthPx:0,heightPx:0}}},c=function(e){if(i(e)){var t=e.split(",")[1],n=function(e){return e.startsWith("data:image/png")?a.kd.PNG:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?a.kd.JPEG:void 0}(e);return t&&n?{screenshotBase64:[t],screenshotImageFormat:n}:void 0}}},956933:(e,t,n)=>{"use strict";n.d(t,{Eb:()=>h,Q9:()=>p,Yw:()=>_,d9:()=>C,qH:()=>f,yu:()=>g});var r=n(822606),o=n(881707),a=n(116510),i=n(556117),s=n(83437),c=n(660606),l=n(423905),u=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function _(){0}var p=function(e){var t,n;if(e){(0,c.cY)("ClpUtils: Fetching clpSensitivityIndicatorData");var r={labelId:e.labelId,iconType:C(e.encryptionType)?i.JF.Encryption:i.JF.NonEncryption,tooltipText:null!==(t=e.description)&&void 0!==t?t:"",badgeText:null!==(n=e.displayName)&&void 0!==n?n:""};return(0,c.cY)("ClpUtils: Returning clpSensitivityIndicatorData as ",r),r}(0,c.cY)("ClpUtils: Label is undefined")},g=function(){(0,c.cY)("ClpUtils: Fetching CLP label info..");var e=o.n.getInstance().getInDocSensitiveLabelInfo();if((0,c.cY)("ClpUtils: Label is : ".concat(JSON.stringify(e))),e.labelId)return(0,c.cY)("ClpUtils: Doc is labelled",e),e;(0,c.cY)("ClpUtils: Doc is not labelled")},f=function(e){return u(void 0,void 0,void 0,(function(){var t,n;return d(this,(function(a){switch(a.label){case 0:return e?(t={labelId:e.id,tenantId:e.tenantId},[4,o.n.getInstance().getHighestDocumentSensitivityInfo([t])]):[3,2];case 1:if(n=a.sent())return[2,p(n)];a.label=2;case 2:return[2,{tooltipText:(0,r.IQ)(),iconType:i.JF.Warning}]}}))}))},h=function(e,t){return u(void 0,void 0,void 0,(function(){var n,i,_,p,g,f,h,C,m,v,E,y;return d(this,(function(b){switch(b.label){case 0:return(null===(v=c.t6.IsCopilotInBackstageMode)||void 0===v?void 0:v.call(c.t6))?((0,c.cY)("getSensitivityConfig - skipping documentConfig in backstage mode"),[2,{copilotConfig:e()}]):[4,u(void 0,void 0,void 0,(function(){var e,t;return d(this,(function(n){switch(n.label){case 0:return e=o.n.getInstance().getInDocSensitiveLabelInfo(),c.t6.IsClpEnabledInEnterpriseForSydney()?[4,o.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]:[3,3];case 1:return t=n.sent(),[4,o.n.getInstance().getHighestDocumentSensitivityInfo([e,t])];case 2:(e=n.sent()).isDke=t.isDke,e.hasExtractForUser=t.hasExtractForUser,n.label=3;case 3:return[2,e]}}))}))];case 1:return n=b.sent(),i={id:n.labelId,displayName:null!==(E=n.displayName)&&void 0!==E?E:"",tooltip:n.description,color:n.color,isEncrypted:n.encryptionType!==a.T.None,priority:null!==(y=n.order)&&void 0!==y?y:0},h={documentSensitivity:i},null==t?[3,2]:(p=t,[3,4]);case 2:return[4,c.t6.getOfficeJSDocumentURL()];case 3:p=b.sent(),b.label=4;case 4:return h.documentURL=p,h.hasExtract=n.labelId===r.u1||n.hasExtractForUser,h.isDKE=n.labelId!==r.u1&&n.isDke,_=h,(g={copilotConfig:e(),documentConfig:_}).copilotConfig&&c.EG.sendChatEventTelemetry((0,l.pN)(((C={})[s.h3.ChatEventType]=s.a5.CopilotConfig,C[s.h3.ChatEventParameters]=JSON.stringify(g.copilotConfig),C))),f=void 0===_.hasExtract&&void 0===_.isDKE,c.EG.sendChatEventTelemetry((0,l.pN)(((m={})[s.h3.ChatEventType]=s.a5.IsDocumentProtected,m[s.h3.ChatEventParameters]=!!f||!(!_.hasExtract||_.isDKE),m))),[2,g]}}))}))};function C(e){return e!==a.T.None}},965562:(e,t,n)=>{"use strict";n.d(t,{p:()=>G});var r=n(811912),o=n(791165),a=n(990813),i=n(965801),s=n(851348),c=n(656904),l=n(140889),u=n(740389),d=n(448397),_=n(8810),p=n(871598),g=n(242154),f=n(769449),h=n(575757);function C(e,t,n){l.a5.GenericErrorMessage;var r,o,i,p="",g=(0,c.h1K)(),C=l.Nr.GenericErrorMessage,m=l.av.Generic,v=l.G8.UnclassifiedError,E=(0,c.tyz)(),y=d.B.getInstance();switch(e){case h.Q.BlockedByLanguage:var b;if(m=l.av.LanguageBlocked,v=l.G8.UnsupportedFunctionality,l.a5.LanguageBlockedErrorMessage,(0,u.KC9)())g=(b=(0,s._)((0,c.n0J)(t.outputAnswerLanguage),2))[0],C=b[1];else g=(0,c.qxK)(t.outputAnswerLanguage),C=l.Nr.CopilotUnsupportedlanguageMessage;E=WordCopilot.CopilotSupportedLanguagesLearnMoreLink,p=c.TEO;break;case h.Q.UnsupportedDocumentLanguage:m=l.av.UnsupportedDocumentLanguage,v=l.G8.UnsupportedFunctionality,l.a5.UnsupportedDocumentLanguageErrorMessage,g=(0,c.s_$)(),E=WordCopilot.CopilotSupportedLanguagesLearnMoreLink,C=l.Nr.CopilotUnsupportedlanguageMessage,p=c.TEO;break;case h.Q.UnsupportedPromptLanguage:m=l.av.UnsupportedPromptLanguage,v=l.G8.UnsupportedFunctionality,l.a5.UnsupportedPromptLanguageErrorMessage,g=(0,c.Bbi)(),E=WordCopilot.CopilotSupportedLanguagesLearnMoreLink,C=l.Nr.CopilotUnsupportedlanguageMessage,p=c.TEO;break;case h.Q.UnsupportedPromptRequestedLanguage:m=l.av.UnsupportedPromptRequestedLanguage,v=l.G8.UnsupportedFunctionality,l.a5.UnsupportedPromptRequestedLanguageErrorMessage,g=(0,c.IQD)(),E=WordCopilot.CopilotSupportedLanguagesLearnMoreLink,C=l.Nr.CopilotUnsupportedlanguageMessage,p=c.TEO;break;case h.Q.NthParagraphSummaryNotSupported:m=l.av.LocationParameter,v=l.G8.UnsupportedFunctionality,l.a5.LocationParameterErrorMessage,g=(0,c.gji)(),C=l.Nr.LocationParameterErrorMessage;break;case h.Q.OutOfScopeRequestInUserInput:case h.Q.UnsupportedSummaryFormat:m=l.av.OutOfScopeRequest,v=l.G8.UnsupportedFunctionality,l.a5.OutOfScopeRequestErrorMessage,g=(0,c.HLn)(),C=l.Nr.OutOfScopeRequestErrorMessage;break;case h.Q.BlockedByPostfilter:m=l.av.BlockedByPostfilter,v=l.G8.RAIError,l.a5.RaiErrorMessage,g=(0,c.OY_)(),C=l.Nr.RaiErrorMessage;break;case h.Q.BlockedByPrefilter:m=l.av.BlockedByPrefilter,v=l.G8.RAIError,l.a5.RaiErrorMessage,g=(0,c.edB)(),C=l.Nr.RaiErrorMessage;break;case h.Q.OffensiveContentInUserInput:m=l.av.OffensiveContentInUserInput,v=l.G8.RAIError,l.a5.RaiErrorMessage,g=(0,c.Hew)(),C=l.Nr.RaiErrorMessage;break;case h.Q.BlockedByQualityCheck:m=l.av.BlockedByQualityCheck,v=l.G8.RAIError,l.a5.RaiErrorMessage,g=(0,c.OY_)(),C=l.Nr.RaiErrorMessage;break;case h.Q.Timeout:case h.Q.ResourceUnavailable:m=l.av.ResourceUnavailable,v=l.G8.TimedOut,l.a5.TimeoutErrorMessage,g=(0,c.z$7)(),C=l.Nr.TimeoutErrorMessage;break;case h.Q.ScenarioThrottled:m=l.av.ScenarioThrottled,v=l.G8.CapacityIssue,l.a5.TimeoutErrorMessage,g=(0,c.z$7)(),C=l.Nr.TimeoutErrorMessage;break;case h.Q.DocumentLengthTooShort:m=l.av.LessContent,v=l.G8.UnableToCompleteTask,l.a5.LessContentErrorMessage,g=(0,c.lGm)(),C=l.Nr.WordResponseLessErrorMessage;break;case h.Q.UserThrottled:m=l.av.Throttled,v=l.G8.CapacityIssue,l.a5.ThrottledErrorMessage,g=(0,c.OZ4)(),C=l.Nr.ThrottlingErrorMessage;break;case h.Q.DoubleKeyEncryptedDocument:m=l.av.DoubleKeyEncryptedDocument,v=l.G8.UnableToCompleteTask,l.a5.ProcessingDeniedMessage,g=(0,c.UTd)(),C=l.Nr.DKEAndNotExtractLabelErrorString;break;case h.Q.MissingExtractPermission:m=l.av.MissingExtractPermission,v=l.G8.UnableToCompleteTask,l.a5.ProcessingDeniedMessage,g=(0,c.UTd)(),C=l.Nr.DKEAndNotExtractLabelErrorString;break;case h.Q.UserNotAuthorized:m=(0,u.azj)()?l.av.Licensing:l.av.LicensingOld,v=l.G8.UserAccessIssue,l.a5.LicensingError,g=(0,c.Bf$)(),C=l.Nr.LicenseValidationErrorMessage;break;default:l.a5.GenericErrorMessage,g=(0,c.h1K)(),C=l.Nr.GenericErrorMessage}var T,I=(i={},(0,a._)(i,l.h3.ChatEventType,"".concat(null==t||null===(r=t.H_)||void 0===r?void 0:r.T_,"_Error")),(0,a._)(i,l.h3.ChatEventParameters,n?n+"_"+e:e),(0,a._)(i,l.h3.ChatErrorType,c.T__.Server),(0,a._)(i,l.h3.ChatErrorKey,C),i);return y.logAshaErrorEvent((0,f.CI)(l.eJ.Summarize,v),m,l.CC.Summary),y.sendChatEventTelemetry((0,f.pN)(I)),y.sendLatencyTelemetry((0,f.pN)((T={},(0,a._)(T,l.CT.ErrorType,c.T__.Server),(0,a._)(T,l.CT.ErrorParameter,n?n+"_"+e:e),(0,a._)(T,l.CT.FeatureName,l.CC.Summary),(0,a._)(T,l.CT.ErrorChatEventType,"".concat(null==t||null===(o=t.H_)||void 0===o?void 0:o.T_,"_Error")),(0,a._)(T,l.CT.ErrorChatEventParameter,n?n+"_"+e:e),T))),y.sendErrorTelemetry([{key:l.IC.ErrorCategory,value:_.S.Augloop},{key:l.IC.ErrorMessage,value:"SummaryAnnotationErrorHandlingStrategy: Failure Received From AL: "+e}]),{message:g,helpLink:p,errorType:"".concat(e,"-").concat(C),linkMessageText:E}}var m,v,E,y,b,T,I,P,A,D,S,M,O,k,L=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"getErrorMessage",value:function(e,t){var n,r,o,h,m,v=d.B.getInstance();switch(null===(n=e.H_)||void 0===n?void 0:n.T_){case i.Sy.getTypeName():var E;m=null===(E=e.error)||void 0===E?void 0:E.category;break;case p.H.getTypeName():var y;m=null===(y=e.error)||void 0===y?void 0:y.category}t&&(m="DisengagedError");var b,T,I,P,A,D=null==e||null===(r=e.error)||void 0===r?void 0:r.json,S=(0,c.h1K)(),M=l.Nr.GenericErrorMessage,O=l.av.Generic,k=l.G8.UnclassifiedError,L=!0,w=(0,c.tyz)();switch(D&&((null==(P=JSON.parse(D))?void 0:P.code)?T=P.code:(null==P?void 0:P.intent)&&(T=P.intent)),null==m?void 0:m.toLowerCase()){case"OffensiveContent".toLowerCase():switch(k=l.G8.RAIError,S=(0,c.edB)(),M=l.Nr.RaiErrorMessage,null==T?void 0:T.toLowerCase()){case"input-query".toLowerCase():O=l.av.OffensiveContentInUserInput;break;case"input-content".toLowerCase():O=l.av.OffensiveInputContent;break;case"generated-output".toLowerCase():O=l.av.OffensiveOutputContent;break;case"generated-sydney-output".toLowerCase():O=l.av.OffensiveSydneyOutput}break;case"UnsupportedLanguageError".toLowerCase():var R;if(k=l.G8.UnsupportedFunctionality,(0,u.KC9)())S=(R=(0,s._)((0,c.n0J)(e.outputAnswerLanguage),2))[0],M=R[1];else S=(0,c.qxK)(e.outputAnswerLanguage),M=l.Nr.CopilotUnsupportedlanguageMessage;switch(w=WordCopilot.CopilotSupportedLanguagesLearnMoreLink,b=c.TEO,I=(0,u.k6y)()?"\n\n"+WordCopilot.FeedbackPrompt:void 0,null==T?void 0:T.toLowerCase()){case"low-score".toLowerCase():O=l.av.LowScore;break;case"unsupported-lang".toLowerCase():O=l.av.LanguageBlocked;break;case"Unknown-lang".toLowerCase():O=l.av.UnknownLanguage;break;case"sydney-unsupported-lang".toLowerCase():O=l.av.SydneyUnsupportedLanguage}break;case"InferenceAPIError".toLowerCase():switch(S=(0,c.CY_)(),M=l.Nr.AugloopResponseTimeoutMessage,null==T?void 0:T.toLowerCase()){case"throttled".toLowerCase():case"scenario-throttled".toLowerCase():O=l.av.ScenarioThrottled,k=l.G8.CapacityIssue,S=(0,c.z$7)(),M=l.Nr.TimeoutErrorMessage;break;case"not-available".toLowerCase():O=l.av.NotAvailable,k=l.G8.LLMIssue,S=(0,c.z$7)(),M=l.Nr.TimeoutErrorMessage;break;case"user-throttled".toLowerCase():O=l.av.Throttled,k=l.G8.CapacityIssue,S=(0,c.OZ4)(),M=l.Nr.ThrottlingErrorMessage;break;case"token".toLowerCase():O=l.av.TokenIssue,k=l.G8.UserAccessIssue;break;case"unknown".toLowerCase():O=l.av.Unknown,k=l.G8.LLMIssue;break;case"bad-response".toLowerCase():O=l.av.BadResponse,k=l.G8.LLMIssue;break;default:O=l.av.TimeOut,k=l.G8.TimedOut,S=(0,c.CY_)(),M=l.Nr.AugloopResponseTimeoutMessage}break;case"UnsupportedIntentError".toLowerCase():switch(null==T?void 0:T.toLowerCase()){case"WordMultiIntent".toLowerCase():O=l.av.MultipleQuestions,k=l.G8.UnsupportedFunctionality,S=(0,c.C5D)(),M=l.Nr.MultipleQuestionsErrorMessage;break;case"WordSegmentSummary".toLowerCase():S=(0,c.P21)(),M=l.Nr.LocationParameterErrorMessage;break;case"WordHelpIntent".toLowerCase():S=(0,c.Mrv)(),M=l.Nr.HelpQueryErrorMessage,b=c.hky}break;case"InputQueryError".toLowerCase():switch(k=l.G8.UserInputIssue,null==T?void 0:T.toLowerCase()){case"document-processing-denied".toLowerCase():O=l.av.ProcessingDenied,S=(0,c.UTd)(),M=l.Nr.DKEAndNotExtractLabelErrorString;break;case"bad-token".toLowerCase():O=(0,u.azj)()?l.av.BadTokenError:l.av.BadTokenErrorOld,S=(0,c.Bf$)(),M=l.Nr.LicenseValidationErrorMessage;break;case"unsupported-multi-agent".toLowerCase():O=l.av.UnsupportedMultiAgent;break;case"out-of-scope".toLowerCase():O=l.av.OutOfScopeRequest;break;case"invalid".toLowerCase():O=l.av.InvalidQuery;break;case"too-short".toLowerCase():O=l.av.InputQueryTooShort;break;case"too-long".toLowerCase():O=l.av.InputQueryTooLong,S=(0,c.NlR)(),M=l.Nr.RequestTooLongErrorMessage;break;default:S=(0,c.h1K)(),M=l.Nr.GenericErrorMessage}break;case"ODSLSyntaxError".toLowerCase():O=l.av.ODSLSyntax,k=l.G8.UnclassifiedError,S=(0,c.Csj)()?WordCopilot.ODSLSyntaxError:'I can\'t do that just yet. Try selecting text and asking me to do something like "change font size to 12."',M=l.Nr.ODSLSyntaxError;break;case"ODSLParsingError".toLowerCase():O=l.av.ODSLParsing,k=l.G8.UnclassifiedError,S=(0,c.Csj)()?WordCopilot.ODSLParsingError:"Something went wrong. Please try again in a moment.",M=l.Nr.ODSLParsingError;break;case"DisambiguationError".toLowerCase():switch(k=l.G8.LLMIssue,null==T?void 0:T.toLowerCase()){case"disambiguation-required".toLowerCase():O=l.av.DisambiguationRequired;break;case"perpetual-disambiguation-loop".toLowerCase():O=l.av.PerpetualDisambiguationLoop;break;case"same-slot-disambiguation-loop".toLowerCase():O=l.av.SameSlotDisambiguationLoop}S=(0,c.Csj)()?WordCopilot.DisambiguationError:"Sorry, I'm still not understanding your request. This might be something I can't do just yet. Instead, try asking me to write about something.",M=l.Nr.DisambiguationError;break;case"LicensingError".toLowerCase():O=(0,u.azj)()?l.av.Licensing:l.av.LicensingOld,k=l.G8.UserAccessIssue,S=(0,c.Bf$)(),M=l.Nr.LicenseValidationErrorMessage;break;case"IgnorableError".toLowerCase():case"SydneyError".toLowerCase():switch(null==T?void 0:T.toLowerCase()){case"user-throttled".toLowerCase():O=l.av.Throttled,k=l.G8.CapacityIssue,S=(0,c.OZ4)(),M=l.Nr.ThrottlingErrorMessage;break;case"out-of-credits".toLowerCase():O=l.av.OutOfCredits,k=l.G8.UnableToCompleteTask,S=(0,c.R_I)(),M=l.Nr.OutOfCreditsError;break;default:S=(0,c.CY_)(),M=l.Nr.AugloopResponseTimeoutMessage}break;case"DisengagedError".toLowerCase():S=(0,c.vz$)(),M=l.Nr.DisengagedError,O=l.av.SydneyDisengagement,k=l.G8.UnableToCompleteTask;break;case"SydneyCancelledError".toLowerCase():O=l.av.SydneyCancelledError,k=l.G8.UserRejectedResponse;break;case"SkillFailedError".toLowerCase():O=l.av.SkillFailedError,k=l.G8.UnclassifiedError;break;case"TokenCountError".toLowerCase():switch(null==T?void 0:T.toLowerCase()){case"excess-tokens-request".toLowerCase():O=l.av.ExcessTokenRequest,k=l.G8.UserInputIssue;break;case"excess-tokens-response".toLowerCase():O=l.av.ExcessTokenResponse,k=l.G8.UnableToCompleteTask}break;case"InvalidSignalError".toLowerCase():switch(k=l.G8.LLMIssue,null==T?void 0:T.toLowerCase()){case"missing".toLowerCase():O=l.av.MissingSignal;break;case"wrong-type".toLowerCase():O=l.av.WrongTypeSignal}break;case"PostProcessProgramError".toLowerCase():if((0,u.Rhi)())if(T==="unsupported-program".toLowerCase())O=l.av.UnsupportedProgram,k=l.G8.UnsupportedFunctionality,L=!1,S=(0,c.ViB)(),M=l.Nr.CommandNotSupportedMessage,(0,g.cY)("User requested command is not supported");else S=(0,c.h1K)(),M=l.Nr.GenericErrorMessage;break;case"WordCopilotSummaryError".toLowerCase():var U;if((0,g.cY)("Handling WordCopilotSummaryError : ",JSON.stringify(D)),D)return C(null===(U=JSON.parse(D))||void 0===U?void 0:U.code,e,m);break;default:S=(0,c.Csj)()?WordCopilot.GenericError:"Something went wrong. Please try again in a moment."}var B,x=(A={},(0,a._)(A,l.h3.ChatEventType,"".concat(null==e||null===(o=e.H_)||void 0===o?void 0:o.T_,"_error")),(0,a._)(A,l.h3.ChatEventParameters,T?m+"_"+T:m),(0,a._)(A,l.h3.ChatErrorType,c.T__.Server),(0,a._)(A,l.h3.ChatErrorKey,M),A),W=(0,f.Uv)(k,O);return v.logAshaErrorEvent(W.vetoName,W.errorString,W.featureName),v.sendChatEventTelemetry((0,f.pN)(x)),v.sendLatencyTelemetry((0,f.pN)((B={},(0,a._)(B,l.CT.ErrorType,c.T__.Server),(0,a._)(B,l.CT.ErrorParameter,T?m+"_"+T:m),(0,a._)(B,l.CT.FeatureName,W.featureName),(0,a._)(B,l.CT.ErrorChatEventType,"".concat(null==e||null===(h=e.H_)||void 0===h?void 0:h.T_,"_error")),(0,a._)(B,l.CT.ErrorChatEventParameter,T?m+"_"+T:m),B))),v.sendErrorTelemetry([{key:l.IC.ErrorCategory,value:_.S.Augloop},{key:l.IC.ErrorMessage,value:"ActionAIAnnotationErrorHandlingStrategy: Failure Received From AL: "+m}]),{message:S,helpLink:b,showFeedbackButton:L,errorType:"".concat(m,"-").concat(T,"-").concat(M),linkMessageText:w,linkSuffix:I}}}]),e}();!function(e){e.InputQueryError="InputQueryError",e.UnsupportedLanguageError="UnsupportedLanguageError",e.InferenceAPIError="InferenceAPIError",e.OffensiveContent="OffensiveContent",e.UnsupportedIntentError="UnsupportedIntentError",e.ODSLSyntaxError="ODSLSyntaxError",e.ODSLParsingError="ODSLParsingError",e.DisambiguationError="DisambiguationError",e.LicensingError="LicensingError",e.PostProcessProgramError="PostProcessProgramError"}(m||(m={})),function(e){e.IgnorableError="IgnorableError",e.SydneyError="SydneyError",e.DisengagedError="DisengagedError",e.SydneyCancelledError="SydneyCancelledError",e.SkillFailedError="SkillFailedError",e.WordCopilotSummaryError="WordCopilotSummaryError",e.InvalidSignalError="InvalidSignalError",e.TokenCountError="TokenCountError"}(v||(v={})),function(e){e.WordMultiIntent="WordMultiIntent",e.WordSegmentSummary="WordSegmentSummary",e.WordHelpIntent="WordHelpIntent"}(E||(E={})),function(e){e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.ScenarioThrottled="scenario-throttled",e.UserThrottled="user-throttled",e.Token="token",e.Unknown="unknown",e.UnsupportedProgram="unsupported-program",e.BadResponse="bad-response"}(y||(y={})),function(e){e.ProcessingDenied="document-processing-denied",e.BadToken="bad-token",e.TooLong="too-long",e.TooShort="too-short",e.UnsupportedMultiAgent="unsupported-multi-agent",e.OutOfScope="out-of-scope",e.Invalid="invalid"}(b||(b={})),function(e){e.LowScore="low-score",e.UnsupportedLang="unsupported-lang",e.UnknownLang="Unknown-lang",e.SydneyUnsupportedLang="sydney-unsupported-lang"}(T||(T={})),function(e){e.InputQuery="input-query",e.InputContent="input-content",e.GeneratedOutput="generated-output",e.GeneratedSydneyOutput="generated-sydney-output"}(I||(I={})),function(e){e.InvalidConversationId="bad-conversation-id",e.InvalidRequest="sydney-invalid-request",e.SydneyValidationFailed="sydney-validation-failed",e.ConnectionNotConnected="connection-not-in-connected-state",e.InvocationCanceled="invocation-canceled",e.CannotProvideToken="cannot-provide-token",e.ServerTimeout="server-timeout",e.WebsocketFailedToConnect="websocket-failed-to-connect",e.WebsocketClosed="websocket-closed-with-1006",e.ServerOnClose="server-on-close",e.InvalidMsgType="invalid-msg-type",e.UserThrottled="user-throttled",e.Ic3="ic3",e.SubstrateSearch="substrate-search",e.PolymerLLM="polymer-llm",e.RequestTooBig="request-too-big",e.Unknown="unknown",e.OutOfCredits="out-of-credits"}(P||(P={})),function(e){e.Cancelled="cancelled"}(A||(A={})),function(e){e.SkillFailedError="skill-failed-error"}(D||(D={})),function(e){e.ExcessTokenRequest="excess-tokens-request",e.ExcessTokenResponse="excess-tokens-response"}(S||(S={})),function(e){e.Disengaged="disengaged-error"}(M||(M={})),function(e){e.Missing="missing",e.WrongType="wrong-type"}(O||(O={})),function(e){e.DisambiguationRequired="disambiguation-required",e.SameSlotDisambiguationLoop="same-slot-disambiguation-loop",e.PerpetualDisambiguationLoop="perpetual-disambiguation-loop"}(k||(k={}));var w,R,U,B=n(314268),x=n(942449),W=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"getErrorMessage",value:function(e){var t,n,r=d.B.getInstance();switch(e.H_.T_){case B.R8.getTypeName():case B.XV.getTypeName():var o,i;t=null===(o=e.error)||void 0===o?void 0:o.category,n=null===(i=e.error)||void 0===i?void 0:i.errorDetailsJson;break;case x.KJ.getTypeName():case x.Ob.getTypeName():var s,u;t=null===(s=e.error)||void 0===s?void 0:s.category,n=null===(u=e.error)||void 0===u?void 0:u.errorDetailsJson}var p,g=l.a5.GenericErrorMessage,h=(0,c.h1K)(),C=l.Nr.GenericErrorMessage,m="";switch(null==t?void 0:t.toLowerCase()){case"OffensiveContentError".toLowerCase():case"PromptInjectionError".toLowerCase():g=l.a5.RaiErrorMessage,h=(0,c.edB)(),C=l.Nr.RaiErrorMessage;break;case"InputQueryOutOfScopeError".toLowerCase():g=l.a5.AnswerNotInDocErrorMessage,h=(0,c.x2O)(),C=l.Nr.AnswerNotInDocErrorMessage;break;case"InvalidSignalError".toLowerCase():g=l.a5.InvalidSignalErrorMessage,h=(0,c.CY_)(),C=l.Nr.AugloopResponseTimeoutMessage;break;case"InvalidLanguageError".toLowerCase():g=l.a5.LanguageBlockedErrorMessage,h=(0,c.qxK)(),C=l.Nr.CopilotUnsupportedlanguageMessage,m=c.TEO;break;case"InferenceAPIError".toLowerCase():if(n){var v=JSON.parse(n);if(null==v?void 0:v.code)switch(v.code.toLowerCase()){case"throttled".toLowerCase():case"scenario-throttled".toLowerCase():case"not-available".toLowerCase():g=l.a5.TimeoutErrorMessage,h=(0,c.z$7)(),C=l.Nr.TimeoutErrorMessage;break;case"user-throttled".toLowerCase():g=l.a5.ThrottledErrorMessage,h=(0,c.OZ4)(),C=l.Nr.ThrottlingErrorMessage;break;default:g=l.a5.AugloopResponseTimeout,h=(0,c.CY_)(),C=l.Nr.AugloopResponseTimeoutMessage}}break;case"InvalidInputError".toLowerCase():if(n){var E=JSON.parse(n);if(null==E?void 0:E.code)switch(E.code.toLowerCase()){case"too-long".toLowerCase():g=l.a5.InvalidInputError,h=(0,c.XTZ)(),C=l.Nr.QueryLengthTooLongError;break;case"too-short".toLowerCase():g=l.a5.InvalidInputError,h=(0,c.tAK)(),C=l.Nr.DefaultHelpCardDescription;break;default:g=l.a5.InvalidInputError,h=(0,c.h1K)(),C=l.Nr.GenericErrorMessage}}break;case"NotSupportedError".toLowerCase():g=l.a5.GenericErrorMessage,h=(0,c.h1K)(),C=l.Nr.GenericErrorMessage;break;case"AdminControlError".toLowerCase():g=l.a5.ContentGenerationDisabledByAdminControl,h=(0,c.WS6)(),C=l.Nr.AdminControlErrorMessage,m=c.hky;break;default:g=l.a5.GenericErrorMessage,h=(0,c.h1K)(),C=l.Nr.GenericErrorMessage}var y=(p={},(0,a._)(p,l.h3.ChatEventType,g),(0,a._)(p,l.h3.ChatEventParameters,t),(0,a._)(p,l.h3.ChatErrorType,c.T__.Server),(0,a._)(p,l.h3.ChatErrorKey,C),p);r.sendChatEventTelemetry((0,f.pN)(y)),r.sendErrorTelemetry([{key:l.IC.ErrorCategory,value:_.S.Augloop},{key:l.IC.ErrorMessage,value:"AnswerContentQuestionAnnotationErrorHandlingStrategy: Failure Received From AL: "+t}]);var b=JSON.parse(n);return{message:h,helpLink:m,errorType:"".concat(t,"-").concat(null==b?void 0:b.code,"-").concat(C)}}}]),e}();!function(e){e.InvalidSignalError="InvalidSignalError",e.InvalidInputError="InvalidInputError",e.InvalidLanguageError="InvalidLanguageError",e.InferenceAPIError="InferenceAPIError",e.InputQueryOutOfScopeError="InputQueryOutOfScopeError",e.OffensiveContentError="OffensiveContentError",e.PromptInjectionError="PromptInjectionError",e.NotSupportedError="NotSupportedError",e.AdminControlError="AdminControlError"}(w||(w={})),function(e){e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.ScenarioThrottled="scenario-throttled",e.UserThrottled="user-throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.BadRequest="bad-request"}(R||(R={})),function(e){e.MissingWordContent="missing-word-content",e.TooLong="too-long",e.TooShort="too-short"}(U||(U={}));var F=n(795952),N=n(661218),K=n(965974),H=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"getErrorMessage",value:function(e){var t,n=e.status,r="",o=l.a5.GenericErrorMessage,i=(0,c.h1K)(),s=l.Nr.GenericErrorMessage;switch(n){case F.Result.BlockedByLanguage:o=l.a5.LanguageBlockedErrorMessage,i=(0,c.qxK)(),s=l.Nr.CopilotUnsupportedlanguageMessage,r=c.TEO;break;case F.Result.BlockedByQualityCheck:o=l.a5.RaiErrorMessage,i=(0,c.edB)(),s=l.Nr.RaiErrorMessage;break;default:o=l.a5.GenericErrorMessage,i=(0,c.h1K)(),s=l.Nr.GenericErrorMessage}return N.E.getInstance().updateTelemetryChatEventData((t={},(0,a._)(t,l.h3.ChatEventType,o),(0,a._)(t,l.h3.ChatEventParameters,n),(0,a._)(t,l.h3.ChatErrorType,c.T__.Server),(0,a._)(t,l.h3.ChatErrorKey,s),t),K.M.getInstance()),K.M.getInstance().logError({eventType:_.S.Augloop,errorMessage:"OldSummaryAnnotationErrorHandlingStrategy: Failure Received From AL: "+n}),{message:i,helpLink:r}}}]),e}(),G=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,null,[{key:"getErrorHandlingStrategy",value:function(e){var t;if(!(null==e||null===(t=e.H_)||void 0===t?void 0:t.T_))return null;switch(e.H_.T_){case F.TextAbstractiveSummaryAnnotation.getTypeName():return new H;case B.R8.getTypeName():case B.XV.getTypeName():case x.KJ.getTypeName():case x.Ob.getTypeName():return new W;case i.Sy.getTypeName():case p.H.getTypeName():return new L;default:return new Q}}}]),e}(),Q=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"getErrorMessage",value:function(e){var t,n,r=d.B.getInstance(),o=(t={},(0,a._)(t,l.h3.ChatEventType,l.a5.GenericErrorMessage),(0,a._)(t,l.h3.ChatEventParameters,"DefaultErrorHandlingStrategy"),(0,a._)(t,l.h3.ChatErrorType,c.T__.Server),(0,a._)(t,l.h3.ChatErrorKey,l.Nr.GenericErrorMessage),t);return r.sendChatEventTelemetry((0,f.pN)(o)),r.sendLatencyTelemetry((0,f.pN)((n={},(0,a._)(n,l.CT.ErrorType,c.T__.Server),(0,a._)(n,l.CT.ErrorParameter,"DefaultErrorHandlingStrategy"),(0,a._)(n,l.CT.FeatureName,l.CC.CopilotChat),(0,a._)(n,l.CT.ErrorChatEventType,l.a5.GenericErrorMessage),(0,a._)(n,l.CT.ErrorChatEventParameter,"DefaultErrorHandlingStrategy"),n))),r.sendErrorTelemetry([{key:l.IC.ErrorCategory,value:_.S.Augloop},{key:l.IC.ErrorMessage,value:"DefaultErrorHandlingStrategy: Failure Received From AL"}]),{message:(0,c.h1K)(),helpLink:c.hky}}}]),e}()},965974:(e,t,n)=>{"use strict";n.d(t,{M:()=>b});var r=n(811912),o=n(791165),a=n(990813),i=n(857835),s=n(928499),c=n(182755),l=n(46692),u=n(24784),d=n(12163),_=n(932554),p=n(8810),g=n(610918),f=n(140889),h=n(242154),C=n(249002),m=n(598309),v="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",E=1763,y=function(){function e(){(0,r._)(this,e)}return(0,o._)(e,[{key:"sendTelemetryEvent",value:function(e){Office.sendTelemetryEvent(e)}}]),e}(),b=function(){function e(){(0,r._)(this,e),(0,a._)(this,"oTelLogger",void 0),(0,a._)(this,"telemSink",void 0),this.oTelLogger=new c.M,this.setupTelemetryLogger(this.oTelLogger)}return(0,o._)(e,[{key:"getDefaultEventFlags",value:function(){return{dataCategories:l.o.DataCategories.ProductServicePerformance|l.o.DataCategories.ProductServiceUsage,diagnosticLevel:l.o.DiagnosticLevel.Optional}}},{key:"logEvent",value:function(e,t){this.logTelemetryEvent(e,t)}},{key:"logEventWithAshaPillar",value:function(e,t,n){this.logTelemetryEventWithAshaPillar(e,t,n)}},{key:"logError",value:function(e,t){this.logTelemetryErrorEvent(e,t)}},{key:"logErrorWithAshaVetoAndError",value:function(e,t,n,r,o){this.logTelemetryErrorEventWithAshaVetoAndError(e,t,n,r,o)}},{key:"getTelemetrySink",value:function(){return this.telemSink}},{key:"getTelemetryProperties",value:function(){return{ariaTenantToken:v,nexusTenantToken:E}}},{key:"getActionAITelemetryEvent",value:function(e,t){return{telemetryProperties:{ariaTenantToken:v,nexusTenantToken:E},eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?(0,i._)({},t,this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields(e.eventData)}}},{key:"logTelemetryEvent",value:function(e,t){this.sendTelemetryEvent(this.getActionAITelemetryEvent(e,t))}},{key:"logTelemetryEventWithAshaPillar",value:function(e,t,n){var r,o,a=this.getActionAITelemetryEvent(e,t);null===(o=a.dataFields)||void 0===o||(r=o).push.apply(r,(0,s._)(n?(0,s._)(u.Mu.getFields({eventType:u.Mu.EventType.Pillar,pillar:n})):[])),this.sendTelemetryEvent(a)}},{key:"getActionAITelemetryErrorEvent",value:function(e,t){return{eventName:"Office.Voice.ActionAI."+p.S.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?(0,i._)({},t,this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:this.getDataFields([{key:"UserQueryGuid",value:(0,h.iM)()},{key:"ChatWordSessionId",value:_.Vv.getSettingAsString(_.zj.ChatWordSessionID)}])}}},{key:"logTelemetryErrorEvent",value:function(e,t){this.sendError(this.getActionAITelemetryErrorEvent(e,t))}},{key:"logTelemetryErrorEventWithAshaVetoAndError",value:function(e,t,n,r,o){var a,i,c=this.getActionAITelemetryErrorEvent(e,t);null===(i=c.dataFields)||void 0===i||(a=i).push.apply(a,(0,s._)(n&&r?(0,s._)(u.Mu.getFields({eventType:u.Mu.EventType.Error,veto:n,error:r,inStaging:null!=o&&o})):[])),this.sendError(c)}},{key:"getCopilotDataFields",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:f.CC.CopilotChat;return(0,s._)(u.TA.getFields({featureActionType:u.TA.FeatureActionType[e],isUserInitiated:!0,capability:(0,C.hX)(t)?"":u.TA.Capability[t],featureName:n,entryPoint:(0,m.w9)()?u.TA.EntryPoint.Backstage:u.TA.EntryPoint.Chat})).concat((0,s._)(this.getDataFields([{key:"UserQueryGuid",value:(0,h.iM)()},{key:"HostSDXSessionId",value:_.Vv.getSettingAsString(_.zj.ChatWordSessionID)}])))}},{key:"getCopilotEventFlags",value:function(){return{dataCategories:l.o.DataCategories.ProductServiceUsage,diagnosticLevel:l.o.DiagnosticLevel.RequiredServiceData}}},{key:"getAshaPillarDataFieldsForTried",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.CC.CopilotChat,n=(0,C.hX)(e)?"Unclear Intent":u.TA.Capability[e];return(0,s._)(u.Mu.getFields({eventType:u.Mu.EventType.Pillar,pillar:"Copilot:".concat(n,":").concat(t)}))}},{key:"logSharedTelemetryEvent",value:function(e){if(e.GetEventName()===p.S.Error)return this.logSharedErrorEvent(e);var t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.ActionAI."+e.GetEventName(),eventFlags:e.IsRequired()?{dataCategories:l.o.DataCategories.ProductServiceUsage|l.o.DataCategories.ProductServicePerformance,diagnosticLevel:l.o.DiagnosticLevel.RequiredServiceData,samplingPolicy:l.o.SamplingPolicy.CriticalUsage}:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:l.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.oTelLogger.sendTelemetryEvent(t)}},{key:"logSharedErrorEvent",value:function(e){var t,n={eventName:"Office.Voice.ActionAI."+p.S.Error,error:{errorGroup:null===(t=e.GetLogs().find((function(e){return e.name===f.IC.ErrorCategory})))||void 0===t?void 0:t.value,tag:0},eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?l.o.SamplingPolicy.CriticalUsage:l.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.oTelLogger.sendError(n)}},{key:"logSharedTelemetrySTKEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:e.IsRequired()&&!t?{dataCategories:l.o.DataCategories.ProductServiceUsage|l.o.DataCategories.ProductServicePerformance,diagnosticLevel:l.o.DiagnosticLevel.RequiredServiceData,samplingPolicy:l.o.SamplingPolicy.CriticalUsage}:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?l.o.SamplingPolicy.CriticalUsage:l.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.oTelLogger.sendTelemetryEvent(n)}},{key:"logSeenEvent",value:function(e,t){var n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsSeen,e,t)};this.sendTelemetryEvent(n)}},{key:"logTriedEvent",value:function(e,t){var n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:(0,s._)(this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,e,t)).concat((0,s._)(this.getAshaPillarDataFieldsForTried(e)))};this.sendTelemetryEvent(n)}},{key:"logKeptEvent",value:function(e,t){var n={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsKept,e,t)};this.sendTelemetryEvent(n)}},{key:"logEnabledEvent",value:function(){var e={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsEnabled)};this.sendTelemetryEvent(e)}},{key:"logSurveyTriggerEvent",value:function(e){var t={telemetryProperties:this.getTelemetryProperties(),eventName:e,eventFlags:this.getCopilotEventFlags()};this.sendTelemetryEvent(t)}},{key:"sendTelemetryEvent",value:function(e){this.oTelLogger.sendTelemetryEvent(e)}},{key:"sendError",value:function(e){this.oTelLogger.sendError(e)}},{key:"getDataFields",value:function(e){return e.map((function(e){return"number"==typeof e.value?d.ip(e.key,e.value):"string"==typeof e.value?d.m9(e.key,e.value):"boolean"==typeof e.value?d.LK(e.key,e.value):d.m9(e.key,e.value)}),[])}},{key:"setupTelemetryLogger",value:function(e){e.setTenantToken("Office.Voice.ActionAI",v,E),e.setTenantToken("Office.Voice.Copilot",v,E),e.setTenantToken(g._e,v,E),this.telemSink=new y,e.addSink(this.telemSink)}}],[{key:"getInstance",value:function(){return e.telemetryLogger||(e.telemetryLogger=new e),e.telemetryLogger}}]),e}();(0,a._)(b,"telemetryLogger",void 0)},967709:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});var r=n(514815),o=n(784567),a=n(265167);function i(e,t){var n={scenario:e,shouldStream:!0,queryId:t};return new o.Xr({parentPath:["Signal",r.bR.getTypeName()],items:[{id:a.r.generateId(),body:new r.bR(n)}]})}},974951:(e,t,n)=>{"use strict";n.d(t,{n:()=>r.n});var r=n(921773)},984244:(e,t,n)=>{"use strict";var r=n(359474),o=n(208520),a=n(267380),i=n(643136),s=n(470551),c=n(636854),l=n(475119),u=function(){return null},d=u,_=u;try{var p=n(956775);d=p.ExternalAuthService,_=p.MsgExtDialogContainer}catch(e){try{var g=n(5489);d=g.ExternalAuthService,_=g.MsgExtDialogContainer}catch(e){(0,l.cY)("Neither @1js/officeaicopilot-chat-core nor @1js/officeaicopilot-chat could be loaded")}}o.memo((function(e){var t=e.dialogContent,n=e.appDefinition,l=e.userContext,u=e.hostContext,p=e.clientInfo,g=e.handleCloseButtonClick,f=e.shouldShowDismissIcon,h=e.copilotChatThemeV2,C=e.cardInfo,m=e.hostConfigFlags,v=o.useMemo((function(){return a.E.getInstance()}),[]),E=o.useMemo((function(){return c.d.getInstance()}),[]),y=o.useMemo((function(){return i.G.getInstance()}),[]),b=o.useMemo((function(){return s.N.getInstance()}),[]),T=o.useMemo((function(){return new d}),[]);return o.createElement(r.q,{theme:h},o.createElement(_,{dialogContent:t,botService:y,appDefinition:n,tokenService:E,telemetryService:b,userContext:l,hostContext:u,appService:v,externalAuthService:T,clientInfo:p,handleCloseButtonClick:g,shouldShowDismissIcon:f,cardInfo:C,createAndSendSignalsToSubstrate:!1,hostConfigFlags:m}))}))},989881:(e,t,n)=>{"use strict";n.d(t,{O:()=>c});var r=n(475119),o=n(217425),a=n(632197),i=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))},s=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=s(0),i.throw=s(1),i.return=s(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&s[0]?r.return:s[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;switch(r=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},c=function(e,t){return i(void 0,void 0,void 0,(function(){var n,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.getToken(null!=t?t:o.w8.sharepoint)];case 1:return n=s.sent(),[2,(0,a.t)(n)];case 2:throw i=s.sent(),(0,r.cY)("Error fetching SharePoint token:",i),i;case 3:return[2]}}))}))}},991136:(e,t,n)=>{"use strict";n.d(t,{W:()=>c});var r=n(208520),o=n(260623),a=n(486092),i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)},s=(0,o.n)({root:{display:"flex",flexDirection:"column",flexWrap:"nowrap",width:"auto",height:"auto",boxSizing:"border-box","> *":{textOverflow:"ellipsis"},"> *:not(.ms-StackItem)":{flexShrink:1}},horizontal:{flexDirection:"row"},verticalReverse:{flexDirection:"column-reverse"},horizontalReverse:{flexDirection:"row-reverse"}}),c=function(e){var t=e.children,n=e.style,o=e.horizontal,c=void 0!==o&&o,l=e.reverse,u=void 0!==l&&l,d=e.customProperties,_=function(e,t,n,r){var o=e.root;return t&&(o=(0,a.z)(o,t)),n?o=r?(0,a.z)(o,e.horizontalReverse):(0,a.z)(o,e.horizontal):r&&(o=(0,a.z)(o,e.verticalReverse)),o}(s(),n,c,u);return r.createElement("div",i({className:_},d),t)}},991392:(e,t,n)=>{"use strict";n.d(t,{Fc:()=>a.Fc,I5:()=>a.I5,Q6:()=>r.Q,Tk:()=>o.T,xT:()=>a.xT});var r=n(500525),o=n(244120),a=n(260197)},992640:(e,t,n)=>{"use strict";n.d(t,{d:()=>o});var r=n(806523),o=(n(475119),n(636854),n(643136),n(267380),function(e,t,n,o){Office.context.ui.messageParent(JSON.stringify({requestId:e,type:r.o.onServiceRequest,serviceName:t,apiName:n,requestData:o}),{targetOrigin:window.location.origin})})},992950:(e,t,n)=>{"use strict";var r;n.d(t,{B:()=>r}),function(e){e.Summary="Summary",e.BasicChat="BasicChat",e.Commanding="Commanding",e.Designer="Designer",e.ContentCreation="ContentCreation",e.SelfHelp="SelfHelp",e.TableChat="TableChat",e.SearchDocument="SearchDocument",e.Sydney="Sydney",e.HandOff="HandOff",e.ReviewerAgent="ReviewerAgent",e.Unset=""}(r||(r={}))},993821:(e,t,n)=>{"use strict";n.d(t,{$n:()=>o,FF:()=>s,dL:()=>c,gt:()=>u,op:()=>l,pH:()=>d});var r,o,a=n(207545),i=n(758651);function s(e){return null==e?void 0:e.TrustedBrokerDomain}function c(e){return l(e?Office.context.document.settings.get(a.zj.BizChatHostContext):a.kH.getSetting(a.zj.BizChatHostContext))}function l(e){if("string"!=typeof e)return e;try{return JSON.parse(e)}catch(e){return void i.error("Failed to parse BizChatHostContext:",e)}}function u(){void 0===r&&d(c());return r}function d(e){var t,n=null===(t=null==e?void 0:e.PrimaryUserAccountInfo)||void 0===t?void 0:t.CopilotExperience;r=n===o.M365CopilotChat||n===o.Researcher||n===o.Analyst}!function(e){e.M365CopilotChat="M365CopilotChat",e.AppChat="AppChat",e.Researcher="Researcher",e.Analyst="Analyst",e.Disabled="Disabled"}(o||(o={}))},995261:(e,t,n)=>{"use strict";n.d(t,{Dl:()=>r.Dl,Pb:()=>r.Pb,d9:()=>r.d9,rs:()=>o.a5});var r=n(423905),o=n(83437);n(904182)},997003:(e,t,n)=>{"use strict";n.d(t,{uf:()=>f,ah:()=>g,ZQ:()=>h,FW:()=>p});var r=n(341422),o=n(287150),a=n(388482),i=n(188363),s=n(656904),c=n(242154),l=n(889899),u=n(249002),d=n(778027),_=n(146931);n(111246),n(208276);function p(e){return{type:r.jA.Default,title:(0,s.xLU)(),text:(0,u.dD)()?void 0:(0,s.xLU)(),iconRegular:o.t2R,iconHover:o.JL$,handleButtonOnClick:function(t,n,r){(0,l.ZT)(t,n,r,e)}}}function g(){return{type:r.jA.Default,title:(0,s.GPl)(),text:(0,u.dD)()?void 0:(0,s.GPl)(),iconRegular:a.o9b,iconHover:a.MN2,handleButtonOnClick:l.e3}}function f(e,t,n){return{type:r.jA.Default,title:s.EKU,text:s.EKU,tooltip:s.EKU,handleButtonOnClick:function(){(0,c.cY)("Debug button clicked"),t(!0),n(e)}}}function h(e){var t=function(e){var t,n=_.sL.getInstance().getConversationDebugLog().length>0&&_.sL.getInstance().getConversationDebugLog()[0].optionSets?_.sL.getInstance().getConversationDebugLog()[0].optionSets:[],r="<ul> <li><strong>SessionId:</strong> "+e.sessionId+"</li><li><strong>AL inspector link:</strong> https://web.augloop-tools.officeppe.com/inspector/"+e.sessionId+"</li><li><strong>appName:</strong> Word </li>"+"<li><strong>appPlatform:</strong> ".concat((0,d.xp)(),"</li>")+"<li><strong>sdxVersion: </strong>"+(0,u.QV)()+"</li><li><strong>optionSets: </strong>"+n+"</li></ul><br/> Please upload console and sydney logs from debug panel<br/><br/>";return r+"<strong>Skill Name:</strong> ".concat(null!==(t=e.skill)&&void 0!==t?t:"Sydney"," <br/> <strong>Error:</strong> ").concat(JSON.stringify(e.error)," <br/> <strong>FCFR:</strong> ").concat(e.FCFR," <br/> <strong>LCFR:</strong> ").concat(e.LCFR)}(e);return{type:r.jA.Default,title:s.UlY,iconRegular:i.gip,iconHover:i.gip,handleButtonOnClick:function(){(0,c.cY)("Report Bug button clicked"),window.open("https://office.visualstudio.com/OC/_workitems/create/Bug?[System.Title]=[Word+Copilot]:&[System.Description]="+t+"&[System.Area]=OCOffice+AI+ExpChat&[System.Tags]=UserFeedback","_blank")}}}}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__webpack_require__),n.loaded=!0,n.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdO={},deferred=[],__webpack_require__.O=(e,t,n,r)=>{if(!t){var o=1/0;for(c=0;c<deferred.length;c++){for(var[t,n,r]=deferred[c],a=!0,i=0;i<t.length;i++)(!1&r||o>=r)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[i])))?t.splice(i--,1):(a=!1,r<o&&(o=r));if(a){deferred.splice(c--,1);var s=n();void 0!==s&&(e=s)}}return e}r=r||0;for(var c=deferred.length;c>0&&deferred[c-1][2]>r;c--)deferred[c]=deferred[c-1];deferred[c]=[t,n,r]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var n=Object.create(null);__webpack_require__.r(n);var r={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var o=2&t&&e;"object"==typeof o&&!~leafPrototypes.indexOf(o);o=getProto(o))Object.getOwnPropertyNames(o).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,__webpack_require__.d(n,r),n},__webpack_require__.d=(e,t)=>{for(var n in t)__webpack_require__.o(t,n)&&!__webpack_require__.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,n)=>(__webpack_require__.f[n](e,t),t)),[])),__webpack_require__.u=e=>(({62:"vendors~sr-latn-rs-ui-strings-json",96:"vendors~fi-fi-ui-strings-json",214:"vendors~mk-mk-ui-strings-json",227:"officeaicopilotchatstrings_sv",269:"vendors~sl-si-ui-strings-json",280:"vendors~uk-ua-ui-strings-json",373:"officeaicopilotchatstrings_te",449:"officeaicopilotchatstrings_ur",526:"augloop",622:"vendors~lv-lv-ui-strings-json",626:"vendors~ca-es-ui-strings-json",640:"officeaicopilotchatstrings_ms",643:"vendors~ko-kr-ui-strings-json",673:"officeaicopilotchatstrings_fr-ca",697:"vendors~ar-sa-ui-strings-json",717:"vendors~auth-msal-browser",769:"wordcanvastool",787:"vendors~sv-se-ui-strings-json",811:"officeaicopilotchatstrings_pa-in",827:"officeaicopilotchatstrings_ca-es-valencia",935:"officeaicopilotchatstrings_ga-ie",1032:"officeaicopilotchatstrings_sd-arab-pk",1034:"sccserviceciq",1039:"officeaicopilotchatstrings_vi",1093:"vendors~gl-es-ui-strings-json",1103:"officeaicopilotchatstrings_zu-za",1182:"vendors~bs-latn-ba-ui-strings-json",1226:"officeaicopilotchatstrings_sw",1258:"vendors~audio-effects-noise-suppression",1285:"vendors~ug-cn-ui-strings-json",1312:"officeaicopilotchatstrings_sr-cyrl-ba",1361:"officeaicopilotchatstrings_ta",1386:"vendors~en-us-ui-strings-json",1411:"vendors~code-preview-dialog",1414:"vendors~fr-fr-ui-strings-json",1426:"vendors~sk-sk-ui-strings-json",1440:"vendors~it-it-ui-strings-json",1511:"office-iss",1565:"vendors~sccservicevoiceaugloop",1604:"sccciqv2plugin",1634:"vendors~lo-la-ui-strings-json",1642:"vendors~pl-pl-ui-strings-json",1668:"officeaicopilotchatstrings_quz-pe",1713:"vendors~officeaicopilot-voice-realtime",1751:"officeaicopilotchatstrings_ru",1758:"vendors~fr-ca-ui-strings-json",1864:"vendors~ta-in-ui-strings-json",1893:"vendors~cy-gb-ui-strings-json",1921:"vendors~event-link-plugin",1950:"officeaicopilotchatstrings_eu",2019:"vendors~nn-no-ui-strings-json",2054:"vendors~gd-gb-ui-strings-json",2119:"vendors~cs-cz-ui-strings-json",2163:"officeaicopilotchatstrings_zh-hans",2337:"officeaicopilotchatstrings_da",2401:"vendors~sq-al-ui-strings-json",2615:"vendors~officeaicopilot-assistant",2700:"vendors~pa-in-ui-strings-json",2793:"officeaicopilotchatstrings_gd-gb",2820:"vendors~inlinecreationhvcapp",2871:"vendors~nb-no-ui-strings-json",2899:"officeaicopilotchatstrings_mt-mt",2933:"officeaicopilotchatstrings_de",2935:"officeaicopilotchatstrings_ml",2953:"vendors~FluidFramework-HashFallback",3005:"officeaicopilotchatstrings_hi",3036:"officeaicopilotchatstrings_sq",3047:"officeaicopilotchatstrings_sr",3049:"officeaicopilotchatstrings_pt-pt",3071:"officeaicopilotchatstrings_el",3073:"officeaicopilotchatstrings_no",3106:"vendors~lt-lt-ui-strings-json",3124:"vendors~az-latn-az-ui-strings-json",3146:"vendors~fa-ir-ui-strings-json",3151:"vendors~zh-tw-ui-strings-json",3181:"lazyloadeddesigner",3327:"vendors~sr-cyrl-ba-ui-strings-json",3388:"vendors~te-in-ui-strings-json",3431:"officeaicopilotchatstrings_lt",3449:"officeaicopilotchatstrings_mr",3457:"officeaicopilotchatstrings_hu",3494:"vendors~hr-hr-ui-strings-json",3536:"officeaicopilotchatstrings_bn-in",3554:"vendors~nl-nl-ui-strings-json",3561:"officeaicopilotchatstrings_sl",3592:"vendors~ga-ie-ui-strings-json",3601:"officeaicopilotchatstrings_he",3624:"vendors~hu-hu-ui-strings-json",3637:"vendors~ja-jp-ui-strings-json",3670:"officeaicopilotchatstrings_si-lk",3674:"vendors~ml-in-ui-strings-json",3718:"vendors~es-es-ui-strings-json",3790:"vendors~ur-pk-ui-strings-json",3912:"officeaicopilotchatstrings_mk",3936:"vendors~bg-bg-ui-strings-json",3987:"vendors~bn-in-ui-strings-json",4016:"officeaicopilotchatstrings_pt",4121:"officeaicopilotchatstrings_af",4123:"officeaicopilotchatstrings_ja",4135:"vendors~hy-am-ui-strings-json",4156:"officeaicopilotchatstrings_ca",4328:"vendors~ms-my-ui-strings-json",4388:"vendors~uz-latn-uz-ui-strings-json",4445:"officeaicopilotchatstrings_hy",4487:"researchnotebook",4499:"officeaicopilotchatstrings_it",4569:"people-link-plugin",4692:"officeaicopilotchatstrings_cy",4775:"officeaicopilotchatstrings_be-by",4786:"vendors~af-za-ui-strings-json",4809:"vendors~FluidDocumentServiceFactoryContainer",4858:"officeaicopilotchatstrings_en-us",4972:"officeaicopilotchatstrings_zh-hant",5016:"vendors~podcastui",5099:"vendors~file-link-plugin",5107:"vendors~jspdf",5136:"officeaicopilotchatstrings_th",5163:"researchworkspace",5202:"vendors~th-th-ui-strings-json",5203:"officeaicopilotchatstrings_kn",5214:"officeaicopilotchatstrings_kk",5273:"officeaicopilotchatstrings_en-gb",5431:"officeaicopilotchatstrings_fa",5501:"officeaicopilotchatstrings_ar",5575:"vendors~am-et-ui-strings-json",5610:"officeaicopilotchatstrings_tr",5612:"officeaicopilotchatstrings_nn-no",5650:"vendors~ka-ge-ui-strings-json",5663:"officeaicopilotchatstrings_fi",5664:"officeaicopilotchatstrings_uk",5717:"vendors~et-ee-ui-strings-json",5756:"vendors~kok-in-ui-strings-json",5812:"officeaicopilotchatstrings_gu",5821:"officeaicopilotchatstrings_kok",5882:"officeaicopilotchatstrings_nl",5905:"vendors~sr-cyrl-rs-ui-strings-json",5939:"officeaicopilotchatstrings_id",5943:"officeaicopilotchatstrings_mi-nz",6008:"editor",6030:"vendors~or-in-ui-strings-json",6102:"vendors~pt-br-ui-strings-json",6121:"officeaicopilotchatstrings_prs",6176:"cuaexperience",6193:"officeaicopilotchatstrings_fil",6202:"officeaicopilotchatstrings_ko",6223:"vendors~vi-vn-ui-strings-json",6343:"officeaicopilotchatstrings_et",6385:"vendors~lb-lu-ui-strings-json",6470:"officeaicopilotchatstrings_ug-cn",6480:"vendors~ro-ro-ui-strings-json",6746:"officeaicopilotchatstrings_sr-cyrl",6759:"dialog-modal",6814:"vendors~kn-in-ui-strings-json",6852:"vendors~mr-in-ui-strings-json",6862:"officeaicopilotchatstrings_hr",6869:"vendors~tt-ru-ui-strings-json",6932:"officeaicopilotchatstrings_km-kh",6966:"officeaicopilotchatstrings_sk",7033:"officeaicopilotchatstrings_uz",7055:"officeaicopilotchatstrings_az-latn-az",7130:"vendors~pt-pt-ui-strings-json",7153:"officeaicopilotchatstrings_bs-latn-ba",7193:"vendors~sccserviceciq",7288:"officeaicopilotchatstrings_pl",7320:"officeaicopilotchatstrings_es",7358:"vendors~copilotchatdisplay",7392:"vendors~ru-ru-ui-strings-json",7420:"officeaicopilotchatstrings_tt",7490:"officeaicopilotchatstrings_lb-lu",7536:"vendors~id-id-ui-strings-json",7587:"vendors~quz-pe-ui-strings-json",7590:"vendors~he-il-ui-strings-json",7601:"vendors~html2canvas",7628:"officeaicopilotchatstrings_fr",7676:"vendors~hi-in-ui-strings-json",7876:"vendors~eu-es-ui-strings-json",7965:"officeaicopilotchatstrings_ro",7999:"officeaicopilotchatstrings_bn-bd",8021:"officeaicopilotchatstrings_bg",8063:"officeaicopilotchatstrings_ha-latn-ng",8088:"vendors~ca-es-valencia-ui-strings-json",8108:"vendors~el-gr-ui-strings-json",8224:"officeaicopilotchatstrings_as-in",8261:"vendors~scc-react-markdown-renderer-light-weight-code-block",8287:"vendors~gu-in-ui-strings-json",8294:"vendors~is-is-ui-strings-json",8409:"vendors~spfx-react-component",8499:"vendors~km-kh-ui-strings-json",8533:"vendors~personaimage",8542:"vendors~da-dk-ui-strings-json",8543:"vendors~kk-kz-ui-strings-json",8582:"officeaicopilotchatstrings_ne-np",8656:"vendors~mt-mt-ui-strings-json",8762:"officeaicopilotchatstrings_am",8767:"officeaicopilotchatstrings_mn-mn",8830:"officeaicopilotchatstrings_es-mx",8892:"officeaicopilotchatstrings_is",8908:"vendors~mi-nz-ui-strings-json",9005:"officeaicopilotchatstrings_lo-la",9203:"officeaicopilotchatstrings_or",9206:"officeaicopilotchatstrings_lv",9269:"vendors~es-mx-ui-strings-json",9397:"vendors~lazyclipchampiframehost",9412:"vendors~lazyloadeddesigner",9452:"officeaicopilotchatstrings_ky",9519:"vendors~research-workspace-component",9537:"vendors~ne-np-ui-strings-json",9638:"vendors~en-gb-ui-strings-json",9669:"officeaicopilotchatstrings_gl",9675:"vendors~zh-cn-ui-strings-json",9693:"officeaicopilotchatstrings_tk-tm",9761:"vendors~fil-ph-ui-strings-json",9832:"vendors~de-de-ui-strings-json",9918:"officeaicopilotchatstrings_cs",9926:"vendors~tr-tr-ui-strings-json",9983:"vendors~as-in-ui-strings-json",9988:"officeaicopilotchatstrings_ka"}[e]||e)+".js"),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="TypeScriptModule:",__webpack_require__.l=(e,t,n,r)=>{if(inProgress[e])inProgress[e].push(t);else{var o,a;if(void 0!==n)for(var i=document.getElementsByTagName("script"),s=0;s<i.length;s++){var c=i[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==dataWebpackPrefix+n){o=c;break}}o||(a=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,__webpack_require__.nc&&o.setAttribute("nonce",__webpack_require__.nc),o.setAttribute("data-webpack",dataWebpackPrefix+n),o.src=e),inProgress[e]=[t];var l=(t,n)=>{o.onerror=o.onload=null,clearTimeout(u);var r=inProgress[e];if(delete inProgress[e],o.parentNode&&o.parentNode.removeChild(o),r&&r.forEach((e=>e(n))),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=l.bind(null,o.onerror),o.onload=l.bind(null,o.onload),a&&document.head.appendChild(o)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.j=1926,(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})(),(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={1926:0};__webpack_require__.f.j=(t,n)=>{var r=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var a=__webpack_require__.p+__webpack_require__.u(t),i=new Error;__webpack_require__.l(a,(n=>{if(__webpack_require__.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;i.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",i.name="ChunkLoadError",i.type=o,i.request=a,r[1](i)}}),"chunk-"+t,t)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[a,i,s]=n,c=0;if(a.some((t=>0!==e[t]))){for(r in i)__webpack_require__.o(i,r)&&(__webpack_require__.m[r]=i[r]);if(s)var l=s(__webpack_require__)}for(t&&t(n);c<a.length;c++)o=a[c],__webpack_require__.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return __webpack_require__.O(l)},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),__webpack_require__.nc=void 0;var __webpack_exports__=__webpack_require__.O(void 0,[3062,9037,3341,6105],(()=>__webpack_require__(822446)));__webpack_exports__=__webpack_require__.O(__webpack_exports__),TypeScriptModule=__webpack_exports__})();
//# sourceMappingURL=taskpane.js.map