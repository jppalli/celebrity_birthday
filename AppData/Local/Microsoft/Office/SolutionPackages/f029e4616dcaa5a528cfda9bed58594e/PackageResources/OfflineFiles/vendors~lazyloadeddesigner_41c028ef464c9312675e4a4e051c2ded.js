"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[9412],{862925:(e,t,i)=>{i.d(t,{Z:()=>f});var n=i(948162);const s="http://localhost:8087",a="https://eus2-010.designerapp.edog.officeapps.live.com",r="https://designerapp.edog.officeapps.live.com",o="https://designerapp.edog.officeapps.live.com:857",l="https://designerapp.officeapps.live-int.com",g="https://canary.designerapp.officeapps.live.com",c="https://euc.designerapp.officeapps.live.com",d="https://designerapp.gcc.osi.office365.us",h="https://usge-010.designerapp.gcc.osi.office365.us",u="https://usgsw-010.designerapp.gcc.osi.office365.us",p="https://designerapp.osi.apps.mil",m="https://designerapp.officeapps.live.com";class f{static getBaseUrl(e){switch(e){case n.Ru.local:return s;case n.Ru.edog:return a;case n.Ru.dogfood:return r;case n.Ru.edognetcore:return o;case n.Ru.int:return l;case n.Ru.canary:return g;case n.Ru.euc:return c;case n.Ru.gcc:return d;case n.Ru.gcc_usge:return h;case n.Ru.gcc_usgsw:return u;case n.Ru.dod:return p;case n.Ru.prod:default:return m}}static getGettyUsageReportUrl(e){switch(e){case n.Ru.euc:return"https://euc.hubblecontent.osi.office.net/contentsvc/api/telemetry/getty";case n.Ru.local:case n.Ru.edog:case n.Ru.dogfood:case n.Ru.edognetcore:case n.Ru.int:return"https://hubblecontent.df.osi.office.net/contentsvc/api/telemetry/getty";case n.Ru.gcc:return"";case n.Ru.canary:case n.Ru.prod:default:return"https://hubblecontent.osi.office.net/contentsvc/api/telemetry/getty"}}static getDasRing(e){const t=e.toString();if(t===new URL(s).toString())return n.Ru.local;if(t===new URL(a).toString())return n.Ru.edog;if(t===new URL(r).toString())return n.Ru.dogfood;if(t===new URL(o).toString())return n.Ru.edognetcore;if(t===new URL(l).toString())return n.Ru.int;if(t===new URL(g).toString())return n.Ru.canary;if(t===new URL(c).toString())return n.Ru.euc;if(t===new URL(d).toString())return n.Ru.gcc;if(t===new URL(h).toString())return n.Ru.gcc_usge;if(t===new URL(u).toString())return n.Ru.gcc_usgsw;if(t===new URL(p).toString())return n.Ru.dod;if(t===new URL(m).toString())return n.Ru.prod;throw new Error("Invalid DAS URL")}static getAccountUrl(e){return this.getBaseUrl(e)+"/designerapp/Account.ashx"}static getAnimationsUrl(e){return this.getBaseUrl(e)+"/designerapp/Animation.ashx"}static getAnimationTemplatesUrl(e){return this.getAnimationsUrl(e)+"?Action=GetAllAnimationTemplates"}static getAppsIntegrationUrl(e){return this.getBaseUrl(e)+"/designerapp/OAuth.ashx"}static getBrandKitEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/BrandKit.ashx"}static getDallEBaseUrl(e){return this.getBaseUrl(e)+"/designerapp/DallE.ashx"}static getDallEImageUrl(e,t){return t?`${t}?action=GetDallEImagesCogSci`:`${this.getDallEBaseUrl(e)}?action=GetDallEImagesCogSci`}static getDallEImageEditsUrl(e,t){return t?`${t}?action=GetDallEImageEdits`:`${this.getDallEBaseUrl(e)}?action=GetDallEImageEdits`}static getDallEReportImageUrl(e){return`${this.getDallEBaseUrl(e)}?action=ReportDallEImage`}static getDocumentEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/Document.ashx"}static getImageTransformUrl(e){return this.getBaseUrl(e)+"/designerapp/imagetransformation.ashx"}static getLoggingUrl(e){return this.getBaseUrl(e)+"/designerapp/RemoteUls.ashx"}static getMediaEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/MediaSuggestions.ashx"}static getMediaUploadUrl(e){return this.getBaseUrl(e)+"/designerapp/Media.ashx"}static getMediaPollUrl(e,t){return this.getBaseUrl(e)+`/designerapp/Media.ashx?action=poll&id=${t}`}static getObjectLevelAnimationUrl(e){return this.getAnimationsUrl(e)+"?Action=ObjectLevelAnimation"}static getPhoneUploadServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/mobileupload.ashx"}static getProactiveSuggestionEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/proactivesuggestions.ashx"}static getPublishUrl(e){return this.getBaseUrl(e)+"/designerapp/Publish.ashx"}static getRealTimeChannelUrl(e){return(this.getBaseUrl(e)+"/designerapp/RealTimeChannel.ashx").replace("http","ws")}static getRecommendedImageServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/FilterRecommendations.ashx"}static getSocialMediaOAuthURL(e,t,i){return this.getBaseUrl(e)+`/designerapp/SocialMedia.ashx?state=${t}&social_media=${i.toLocaleLowerCase()}`}static getStableDiffusionUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx"}static getSAMEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/sam.ashx?Action=SAM"}static getMediaProcessorUrl(e){return this.getBaseUrl(e)+"/designerapp/mediaprocessor.ashx"}static getStableDiffusionGenerativeFontEffectUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx?Action=TextEffects"}static getStableDiffusionObjectRemovalUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx?Action=MIRObjRem"}static getStableDiffusionProductPlacementUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx?Action=ProductPlacement"}static getStableDiffusionReportImageUrl(e){return this.getBaseUrl(e)+"/designerapp/stablediffusion.ashx?Action=Report"}static getSubmitTemplateUrl(e){return this.getBaseUrl(e)+"/designerapp/SubmitTemplate.ashx"}static getSuggestionEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/suggestions.ashx"}static getSuggestionThumbnailEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/thumbnail.ashx"}static getSuggestionCompressedThumbnailEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/thumbnail.ashx?action=GetCompressedThumbnail"}static getTraceRequestEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/TraceRequest.ashx"}static getUserAssetsServiceUrl(e){return this.getBaseUrl(e)+"/designerapp/userasset.ashx"}static getWhatsNewEndpointUrl(e){return this.getBaseUrl(e)+"/designerapp/notifications.ashx"}static getTryItPromptsUrl(e){return this.getBaseUrl(e)+"/designerapp/TryItPrompts.ashx"}static getOCPSClientUrl(e){return this.getBaseUrl(e)+"/designerapp/OCPSClient.ashx"}static getBotAssetUrl(e,t,i){return this.getBaseUrl(e)+`/designerapp/BotAsset.ashx?chatId=${t}&messageId=${i}`}static getAbuseMonitoringUrl(e){return this.getBaseUrl(e)+"/designerapp/AbuseMonitoring.ashx"}static getTemplateSearchUrl(e){return this.getBaseUrl(e)+"/designerapp/TemplateSearch.ashx"}}},895829:(e,t,i)=>{i.d(t,{E:()=>F});var n=i(903495),s=i(680386),a=(i(456462),i(927994),i(570539),i(735041),i(628142),i(439146),i(781851),i(3205),i(634207)),r=(i(322892),i(9095),i(427420)),o=i(676916),l=i(726529);var g=i(747355),c=i(61714);class d{constructor(e,t,i){this.targetOrigin=e,this.hostWindow=t,this.iframeid=i,this.boundOnMessage=this.onMessage.bind(this),this.callbacks=new Map,this.hostWindow.addEventListener("message",this.boundOnMessage)}removeMessageHandler(){this.off(),this.hostWindow.removeEventListener("message",this.boundOnMessage)}on(e,t){if(this.callbacks.has(e))throw new Error(`"${e}" already registered`);this.callbacks.set(e,t)}off(e){if(e){if(!this.callbacks.has(e))throw new Error(`"${e}" not registered`);this.callbacks.delete(e)}else this.callbacks.clear()}setTarget(e){this.target=e}send(e,t){if(!this.target)throw new Error("Must call initialize first");this.target.postMessage({type:e,data:t},this.targetOrigin)}destroy(){this.removeMessageHandler(),this.target=void 0,this.hostWindow=void 0}onMessage(e){var t;const{origin:i,data:n}=e,s=null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.iframeid;if(new URL(i).origin!==new URL(this.targetOrigin).origin||s&&s!=this.iframeid)return;const{type:a,data:r}=n,o=this.callbacks.get(a);o&&o(r)}}var h=i(768208),u=i(9701),p=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function r(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};class m{constructor(e,t){this.m_appMessageHandler=e,this.m_settings=t}initialize(){this.m_appMessageHandler.on("auth_fetch",this.onAuthMessage.bind(this))}destroy(){this.m_appMessageHandler=void 0,this.m_settings=void 0}onAuthMessage(){return p(this,void 0,void 0,(function*(){try{const e=yield this.getAuthToken();this.m_appMessageHandler.send("auth_token",e)}catch(e){this.m_appMessageHandler.send("auth_error",e)}}))}getAuthToken(){return p(this,void 0,void 0,(function*(){if(this.m_settings.hostTokenProvider){const e=(0,h.nz)(!1);return yield this.m_settings.hostTokenProvider.getToken(e)}throw new u.F("No host auth callback provided")}))}}var f=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function r(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};class v{constructor(e,t){this.m_appMessageHandler=e,this.m_hostSessionStorage=t}initialize(){this.m_appMessageHandler.on("dcHint",this.onDcHintMessage.bind(this))}destroy(){this.m_appMessageHandler=void 0,this.m_hostSessionStorage=void 0}onDcHintMessage(e){return f(this,void 0,void 0,(function*(){(null==e?void 0:e.dcHint)&&"string"==typeof(null==e?void 0:e.dcHint)&&this.m_hostSessionStorage.setDcHint(null==e?void 0:e.dcHint)}))}}class C{constructor(e){var t,i,n;this.fileCacheInfoChangeHandler=null===(t=e.fileCacheInfoConfig)||void 0===t?void 0:t.hostCallback;const s=null===(i=e.fileCacheInfoConfig)||void 0===i?void 0:i.fileCacheInfo;if(s)this.containerId=s.containerId,this.fileToken=s.fileToken,this.dcHint=s.dcHint,r.Hv.sendTraceTag(505516771,o.n.msoulscat_Wac_Telemetry,l.k.Info,`HostSessionStorage initialized with dcHint: ${this.dcHint}`);else{const t=null===(n=e.hostTokenProvider)||void 0===n?void 0:n.identityType,i=e.telemetryConfig.clientName.toLowerCase().trim().replaceAll(" ","-");this.containerId=""+("AAD"===t?`aad-${i}-${(0,c.A)()}`:`${i}-${(0,c.A)()}`),this.fileToken=(0,c.A)(),this.fileCacheInfoChangeHandler&&this.fileCacheInfoChangeHandler(this.getFileCacheInfo())}}getContainerId(){return this.containerId}getFileToken(){return this.fileToken}getDcHint(){return this.dcHint}setDcHint(e){r.Hv.sendTraceTag(505516770,o.n.msoulscat_Wac_Telemetry,l.k.Info,`HostSessionStorage::setDcHint called with input dcHint: ${e}`),e!==this.dcHint&&(this.dcHint=e,this.fileCacheInfoChangeHandler&&this.fileCacheInfoChangeHandler(this.getFileCacheInfo()))}getFileCacheInfo(){return{containerId:this.containerId,fileToken:this.fileToken,dcHint:this.dcHint}}}const{parseSuggestionsResponse:I}=a.q4;var y,U,b,w,_;!function(e){e.DownloadDesign="downloadDesign",e.GenerateImage="generateImage",e.UpdateDesignDescription="updateDesignDescription",e.UploadImage="uploadImage",e.LoadThumbnails="loadThumbnails",e.CompleteBoot="completeBoot",e.OpenMini="openMini",e.CloseMini="closeMini"}(y||(y={})),function(e){e[e.Like=0]="Like",e[e.Dislike=1]="Dislike"}(U||(U={})),function(e){e.Pane="pane",e.Chat="chat"}(b||(b={})),function(e){e.Auto="auto",e.Dark="dark",e.Light="light",e.HighContrast="highContrast"}(w||(w={})),function(e){e[e.Done=0]="Done",e[e.Insert=1]="Insert"}(_||(_={}));var S=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function r(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};const T=new Map([["image/jpeg","jpg"],["image/png","png"],["image/x-png","png"],["image/webp","webp"],["image/heic","heic"]]);var D=function(e,t,i,n){return new(i||(i=Promise))((function(s,a){function r(e){try{l(n.next(e))}catch(e){a(e)}}function o(e){try{l(n.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,o)}l((n=n.apply(e,t||[])).next())}))};class E{constructor(e){var t,i;this.m_settings=e,this.axiosInstance=g.A.create(),this.iframeid=(0,c.A)(),this.m_hostWindow=null!==(i=null===(t=e.container.ownerDocument)||void 0===t?void 0:t.defaultView)&&void 0!==i?i:window,this.m_appMessageHandler=new d(this.m_settings.miniURL.origin,this.m_hostWindow,this.iframeid),this.m_authMessageHandler=new m(this.m_appMessageHandler,this.m_settings),this.m_iframe=this.createAppFrame(),this.m_hostSessionStorage=new C(this.m_settings),this.m_dcHintMessageHandler=new v(this.m_appMessageHandler,this.m_hostSessionStorage);this.axiosInstance.interceptors.response.use((e=>{const t=e.headers[s.Qk.DataCenterHint.toLowerCase()];return t&&this.m_hostSessionStorage.setDcHint(t),e}))}getSuggestions(e,t,i,n,s,g){var d,h,u;return D(this,void 0,void 0,(function*(){if(!this.m_suggestionClient){const e=null===(d=this.m_settings.hostTokenProvider)||void 0===d?void 0:d.identityType,t=null===(h=this.m_settings.hostTokenProvider)||void 0===h?void 0:h.accountInfo.userId,i=this.m_settings.telemetryConfig.clientId,n=t?"AAD"===e?t:function(e,t){if(36===(null==e?void 0:e.length))return e.substr(19,4)+e.substr(24);return 16===(null==e?void 0:e.length)&&!0===t?e:(r.Hv.sendTraceTag(507873103,o.n.msoulscat_Wac_Telemetry,l.k.Error,"Unexpected localAccountId length"),"")}(t):i;this.m_suggestionClient=new a.q4({AudienceGroup:this.m_settings.telemetryConfig.audienceGroup,Caller:"DesignerEcosystem",ClientId:this.m_settings.telemetryConfig.clientId,ClientName:this.m_settings.telemetryConfig.clientName,ServiceRing:this.getDesignerEnvironment(this.m_settings.serviceBaseURL),SessionId:this.m_settings.telemetryConfig.sessionId,UserId:n},this.axiosInstance)}const p=this.m_hostSessionStorage.getFileCacheInfo(),m={ContainerId:p.containerId,FileToken:p.fileToken,DcHint:p.dcHint},f={Title:{Text:""},SubTitle:{Text:""},Expectations:{Dimension:t,TypeMetadata:[null!==(u=this.m_settings.preferredImageOutputFormat)&&void 0!==u?u:"jpg","oxsd"],MinCount:i,MaxCount:n||(v=this.m_settings.viewConfig.view,v===b.Chat?4:14)},Hints:{DesignQuery:e,Trigger:"DesignFromScratch",DisableMotionSuggestions:"true",image2HeadingsForDFS:"true"},Scenario:g};var v;if(null==s?void 0:s.length){if("string"==typeof s[0]){const e=yield Promise.all(s.map((e=>{return t=e,S(void 0,void 0,void 0,(function*(){try{const e=yield fetch(t),n=yield e.blob(),s=T.get(n.type)||"jpg";let a=i;if(!a){const e=new URL(t).pathname.split("/").pop();a=(null==e?void 0:e.slice(0,e.lastIndexOf(".")))||(0,c.A)()}return new File([n],a+"."+s,{type:n.type})}catch(e){throw new Error(`Failed to fetch image: ${e.message}`)}}));var t,i})));return yield this.m_suggestionClient.getSuggestionsWithImageContent(Object.assign(Object.assign({},f),{ImageFiles:e}),m)}return yield this.m_suggestionClient.getSuggestionsWithImageContent(Object.assign(Object.assign({},f),{ImageBuffers:s}),m)}return yield this.m_suggestionClient.getSuggestions(f,m)}))}initialize(e){return D(this,void 0,void 0,(function*(){const t=Date.now();this.m_authMessageHandler.initialize(),this.m_dcHintMessageHandler.initialize();const i=new Promise(((i,n)=>{this.m_appMessageHandler.on("ready",(()=>{try{this.m_appMessageHandler.send("initialize",{designerEnvironment:this.getDesignerEnvironment(this.m_settings.serviceBaseURL),telemetryConfig:this.m_settings.telemetryConfig,packageVersion:"0.23.9",appStartTimestamp:t,config:{insertMode:this.m_settings.insertMode,useDoneCta:this.m_settings.ctaButtonLabel===_.Done,hideSizeSelector:this.m_settings.hideSizeSelector,preferredImageOutputFormat:this.m_settings.preferredImageOutputFormat,disableOptionalConnectedExperiences:this.m_settings.disableOptionalConnectedExperiences,hostCanProvideAuthToken:!!this.m_settings.hostTokenProvider,hostAuthConfig:this.m_settings.hostTokenProvider?{hostAccountInfo:this.m_settings.hostTokenProvider.accountInfo,hostIdentityType:this.m_settings.hostTokenProvider.identityType,hostCanProvideAuthToken:!0,isEUDBUser:this.m_settings.hostTokenProvider.isEUDBUser}:void 0,useEnterpriseTOULink:this.m_settings.useEnterpriseTOULink,isSovereignUser:this.m_settings.isSovereignUser,hideGenImageEntryPoint:this.m_settings.hideGenImageEntryPoint},suggestionsConfig:e,viewConfig:this.m_settings.viewConfig,fileCacheInfo:this.m_hostSessionStorage.getFileCacheInfo()}),this.m_appMessageHandler.off("ready"),i()}catch(e){n(e)}})),this.m_iframe.onerror=e=>{n(new Error(`Error loading iframe: ${e}`))}}));this.m_settings.container.appendChild(this.m_iframe),this.m_iframe.contentWindow&&this.m_appMessageHandler.setTarget(this.m_iframe.contentWindow),yield i}))}update(e){this.m_appMessageHandler.send("update",e)}updateAfterSignIn(){this.m_appMessageHandler.send("update_after_sign_in")}destroy(){this.m_appMessageHandler.destroy(),this.m_authMessageHandler.destroy(),this.m_dcHintMessageHandler.destroy(),this.m_iframe.remove(),this.m_hostWindow=void 0,this.m_settings=void 0}on(e,t){this.m_appMessageHandler.on(e,t)}off(e){this.m_appMessageHandler.off(e)}toggleInsertMode(e){this.m_appMessageHandler.send("insert_mode",e)}switchDesignerMiniAppTheme(e){this.m_appMessageHandler.send("switch_theme",e)}enableRedirectAuth(e){this.m_appMessageHandler.send("enable_redirect_auth",e)}createAppFrame(){var e,t,i;const n=new URL(this.m_settings.miniURL.toString());n.searchParams.append("view",null===(e=this.m_settings.viewConfig)||void 0===e?void 0:e.view),n.searchParams.append("theme",null!==(i=null===(t=this.m_settings.viewConfig)||void 0===t?void 0:t.theme)&&void 0!==i?i:"auto"),n.searchParams.append("sessionId",this.m_settings.telemetryConfig.sessionId),n.searchParams.append("clientId",this.m_settings.telemetryConfig.clientId),n.searchParams.append("clientName",this.m_settings.telemetryConfig.clientName),n.searchParams.append("iframeid",this.iframeid),this.m_settings.lng&&n.searchParams.append("lng",this.m_settings.lng),this.m_settings.loginHint&&n.searchParams.append("loginHint",this.m_settings.loginHint);const s=this.m_hostWindow.document.createElement("iframe");return s.allow="clipboard-write",s.width="100%",s.height="100%",s.style.border="none",s.name="Microsoft Designer",s.src=n.toString(),this.m_settings.enableSandboxing&&s.sandbox.add("allow-scripts","allow-same-origin","allow-downloads","allow-popups","allow-popups-to-escape-sandbox","allow-top-navigation"),this.m_settings.disableEmbeddedCSPEnforcement||s.setAttribute("csp","object-src 'none'; base-uri 'none'; require-trusted-types-for 'script'; trusted-types default; "),s}getDesignerEnvironment(e){return s.Zb.getDasRing(e)}}const{parseSuggestionsResponse:k}=a.q4;var M=i(208520);const R=(0,i(814168).Ex)("officeaicopilot-designer.DesignerStrings.DesignerPreviewLabel");var A=i(573362);var H=i(780428),x=i(758651);const B=(0,i(245965).l8)({lightThemeWithChatCard:{backgroundColor:"#FFFFFF"},darkThemeWithChatCard:{backgroundColor:"#292929"}});var P=i(758651);const L={designerPreviewAriaLabel:R},F=e=>{const t=M.useMemo((()=>(0,c.A)()),[]),i=M.useRef(),s=M.useRef(!1),a=(0,n.kQ)(L);P.log("Designer Log: historyEventData sent to Designer",e.historyEventData);const{initializeDesignerMini:r,designerMiniSettings:o}=(e=>{const{clientSettings:t,hostTokenProvider:i,isAuthEnabled:n,isRehydration:s,turnId:a,hostCallback:r,fileCacheInfo:o,isPlugAndPlay:l,historyEventData:g}=e,d=(0,H.eR)(e.clientSettings?.selectedDesignerEnv,n),h=(0,H.iK)(t?.selectedDesignerEnv,i?.isEUDBUser),u=t?.clientId||(0,c.A)(),p=t?.sessionId||(0,c.A)(),m=t?.correlationId||(0,c.A)(),f=t?.hostAppName,v=t?.scenarioName||"Other",C=t?.platformType,I=t?.hostBuildVersion,y=`${f}-${C}`,U=t?.audienceGroup;x.log("Designer Log: is Plug and Play enabled: ",l);const{parentContainerIdentifier:S}=e,T=M.useMemo((()=>{return{miniURL:d,serviceBaseURL:h,viewConfig:{view:b.Chat,theme:t?.designerTheme??w.Light,showFeedbackSection:t?.showFeedBackSection??!1,tempPlugNPlay:l},fileCacheInfoConfig:{hostCallback:r??(e=>{x.log(`FileCacheInfo updated: ${JSON.stringify(e)}`)}),fileCacheInfo:o},telemetryConfig:{audienceGroup:U??A.EW.Other,clientId:u,clientName:f??"unknown",hostBuildVersion:I??"unknown",hostEnvironment:y,isMicrosoftInternal:!0,optionalDiagnosticsAllowed:!0,sessionId:p,correlationId:m,platform:(n=t?.platformType??A.lt.Web,n===A.lt.iOS?{platform:"iOS"}:n===A.lt.Web?{platform:"Web"}:n===A.lt.MacOS?{platform:"MacOS"}:{platform:"Web"}).platform,tenantId:i?.accountInfo.tenantId??""},container:document.getElementById(S),insertMode:t?.insertMode??!0,enableSandboxing:!0,ctaButtonLabel:e.preferredCtaButtonLabel??_.Insert,hideSizeSelector:!0,preferredImageOutputFormat:e.preferredImageFormat??"png",hostTokenProvider:i,lng:t?.uiLanguage??"en-US"};var n}),[d,h,t?.designerTheme,t?.platformType,t?.uiLanguage,t?.insertMode,r,o,u,f,I,y,p,m,S,e.preferredCtaButtonLabel,e.preferredImageFormat,i]),D=M.useCallback((async(e,t,i,n,r,o,l,c,d,h)=>{const u=new E({...T,container:document.getElementById(e)});return await u.initialize({turnId:a,isRehydration:s,scenario:v,minCount:3,maxCount:4,...t??{},historyEventData:g}),i&&u.on("done",i),n&&u.on("customize",n),o&&u.on("feedback",o),r&&u.on("AnswerCardResize",r),l&&u.on("persist_results",l),c&&u.on("error",c),d&&u.on("telemetry",d),h&&u.on("keyboardEvent",h),u}),[T,g,s,v,a]);return{designerMiniSettings:T,initializeDesignerMini:D}})({clientSettings:e.clientSettings,hostTokenProvider:e.hostTokenProvider,isAuthEnabled:e.isAuthEnabled,turnId:e.turnId,isRehydration:e.isRehydration,parentContainerIdentifier:t,hostCallback:e.hostCallback,fileCacheInfo:e.fileCacheInfo,isPlugAndPlay:e.isPlugAndPlay,historyEventData:e.historyEventData});P.log("Designer Log: Designer Mini initialized with settings: ",o);const l=M.useCallback((async t=>{if(t.options?.isUrl&&t.uri)e.insertImagesInCanvas?.(t.uri,{...t.options,altText:t.altText,sourceUrl:t.uri},t.correlationId,t.imageType);else{const i=await function(e,t){const i=Array.from(e),n=new Blob([new Uint8Array(i)],{type:t||"image/png"}),s=new FileReader;return s.readAsDataURL(n),new Promise(((e,t)=>{s.onload=function(){const t=s.result;e(t)},s.onerror=function(){t(s.error)}}))}(t.media,t.mimeType);e.insertImagesInCanvas?.(i,{...t.options,altText:t.altText,sourceUrl:t.options?.isUrl?t.uri:void 0},t.correlationId,t.imageType)}}),[e]),g=M.useCallback((e=>{const i=document.getElementById(t);i&&(i.style.height=`${e.height}px`)}),[t]),d=M.useCallback((t=>{e?.onDesignerCustomize?.(t,o)}),[o,e]),h=M.useCallback((t=>{((e,t,i,n)=>{e===U.Like?n?t?.(n):t?.():e===U.Dislike&&(n?i?.(n):i?.())})(t.type,e.handleThumbsUpClick,e.handleThumbsDownClick,e.feedbackData)}),[e]),u=M.useCallback((t=>{P.log("Designer Log: data received after image generation",t),e?.persistentChatHistoryCallback?.(t)}),[e]),p=M.useCallback((t=>{e?.handleDesignerError?.(t)}),[e]),m=M.useCallback((t=>{e?.handleDesignerTelemetry?.(t)}),[e]),f=M.useCallback((e=>{if("Escape"===e.key){const e=document.getElementById(t)?.closest("."+A.lc.CopilotMessage),i=document.getElementsByClassName(A.lc.UserMessage)[0];i?.focus({preventScroll:!0}),e?.focus()}}),[e]),v=M.useMemo((()=>{const t={imageType:e.imageType};return e.isStockQuery?{...t,stockContent:e.stockImages,artifactType:A.FR.DesignSuggestions,companyName:e.companyName}:"banner"===e.imageType?.toLowerCase()?{...t,dimensions:e.dimensions,text:e.userInput.trim(),artifactType:A.FR.DesignSuggestions}:{...t,text:e.userInput.trim(),artifactType:A.FR.DallEImages,enableImageGen4o:e.enableImageGen4o??!1}}),[e.companyName,e.dimensions,e.imageType,e.isStockQuery,e.stockImages,e.userInput,e.enableImageGen4o]);return M.useEffect((()=>{s.current?P.log(`Designer Log: Designer Mini already initialized, skipping initializeDesignerMini. doneInitializing: ${null!==i.current}`):(s.current=!0,P.log("Designer Log: Calling initializeDesignerMini"),r(t,v,l,d,g,h,u,p,m,f).then((e=>{i.current=e})).catch((e=>{s.current=!1,P.error(e)})))}),[v,r,g,d,l,h,t,u,p,m,f]),M.useEffect((()=>{e.clientSettings?.designerTheme&&i.current&&i.current.switchDesignerMiniAppTheme(e.clientSettings.designerTheme)}),[e.clientSettings?.designerTheme]),M.createElement(M.Fragment,null,M.createElement("div",{id:t,key:t,className:`${e.clientSettings?.designerTheme===w.Dark?B.darkThemeWithChatCard:B.lightThemeWithChatCard}`,tabIndex:-1,"aria-label":a.designerPreviewAriaLabel()}))}},948162:(e,t,i)=>{var n;i.d(t,{MK:()=>a,Qk:()=>s,Ru:()=>n}),function(e){e[e.prod=0]="prod",e[e.edog=1]="edog",e[e.int=2]="int",e[e.local=3]="local",e[e.canary=4]="canary",e[e.euc=5]="euc",e[e.gcc=6]="gcc",e[e.gcc_usge=7]="gcc_usge",e[e.gcc_usgsw=8]="gcc_usgsw",e[e.dod=9]="dod",e[e.edognetcore=10]="edognetcore",e[e.dogfood=11]="dogfood"}(n||(n={}));const s={AccessToken:"AccessToken",Action:"Action",AudienceGroup:"AudienceGroup",Authorization:"Authorization",Caller:"Caller",ClientBuild:"ClientBuild",ClientId:"ClientId",ClientName:"ClientName",ContainerId:"ContainerId",ContentType:"Content-Type",CorrelationId:"X-Correlation",Correlation_Id:"X-Correlation-ID",DataCenterHint:"X-DC-Hint",DeviceId:"DeviceId",DocId:"DocId",EnableCreditAndPolicyChecksOnDAS:"X-EnableCreditAndPolicyChecksOnDAS",EnableCreditsDevExperience:"X-EnableCreditsDevExperience",EnableFluxExperience:"X-EnableFluxExperience",EnableGptBasedImageGen:"X-EnableGptBasedImageGen",EnvironmentHint:"X-Environment-Hint",ErrorCode:"X-ErrorCode",FailureReason:"X-FailureReason",FileToken:"FileToken",Handler:"Handler",HostApp:"HostApp",InviteCode:"InviteCode",InviteProgram:"InviteProgram",Locale:"Locale",PersistentId:"PersistentId",Platform:"Platform",ReleaseChannel:"ReleaseChannel",SessionId:"SessionId",StatusCode:"StatusCode",ThemeMetadatas:"ThemeMetadatas",Trigger:"Trigger",UploadToStorage:"x-upload-to-storage-das",UserAgent:"User-Agent",UserId:"UserId",UserSessionId:"X-UserSessionId",UserType:"UserType"},a={NotEnoughSuggestions:"NotEnoughSuggestions"}}}]);
//# sourceMappingURL=vendors~lazyloadeddesigner.js.map