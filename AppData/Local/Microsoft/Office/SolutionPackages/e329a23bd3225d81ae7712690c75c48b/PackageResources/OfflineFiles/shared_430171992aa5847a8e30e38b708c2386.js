/*! For license information please see shared.js.LICENSE.txt */
(self.webpackChunksdx_pptnarrativeview=self.webpackChunksdx_pptnarrativeview||[]).push([[1804],{61907:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{CreateAugloopSessionModule:()=>i.M}),3023==o.j)var i=o(87652)},65233:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{CategoryLocalizationSlimModule:()=>i.N}),3023==o.j)var i=o(33244)},72803:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{NudgeUXModule:()=>i.B}),3023==o.j)var i=o(13821)},11440:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{UXModules:()=>s}),3023==o.j)var i=o(97428);if(3023==o.j)var n=o(81628);if(3023==o.j)var r=o(90809);class s{constructor(){this.imports=[r.q,n.y]}get uniqueId(){return(0,i.z)(507363479)}}},90809:(e,t,o)=>{"use strict";if(o.d(t,{q:()=>u}),3023==o.j)var i=o(97428);if(3023==o.j)var n=o(8974);if(3023==o.j)var r=o(8228);if(3023==o.j)var s=o(42877);if(3023==o.j)var a=o(63302);if(3023==o.j)var l=o(2798);if(3023==o.j)var c=o(19100);class u{constructor(){this.imports=[r.f,n.D,a.I,c.p,s.S,l.O]}get uniqueId(){return(0,i.z)(507363480)}}},30103:(e,t,o)=>{"use strict";o.d(t,{A:()=>n});var i=o(41856);class n{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,o)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=n.Rejected,void o(t)}this.prevSeq=-1}e!=this.prevSeq+1&&i.tG.warn(542712385,i.nh.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const r={seq:e,resolve:t};this.insertItem(r),this.runInOrder(r,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,o=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(o?(o.prev=e,e.next=o):this.lastQueueItem=e);o=t,t=t.prev}while(t);o&&(o.prev=e),e.next=o,this.firstQueueItem=e}runInOrder(e,t,o){let i=this.prevSeq,n=!1;const r=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(i+1!=t.seq&&(!o||t.seq>e.seq))break;i=t.seq,t.timeout&&clearTimeout(t.timeout),r.push(t),e==t&&(n=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}r.length>0&&setTimeout((()=>{for(const e of r)e.resolve(e.seq)}),0),this.prevSeq=i,!n&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}n.Rejected="SequenceItemRejected"},56238:(e,t,o)=>{"use strict";if(o.d(t,{L:()=>d,n:()=>u}),3023==o.j)var i=o(11168);if(3023==o.j)var n=o(78449);if(3023==o.j)var r=o(28539);var s=o(26394),a=o.n(s);const l=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,c=/[.!?]/g;function u(e,t){const o=[],i=h(e,t);return i&&o.push(i),o}function d(e,t){const o=[],r=h(e,t);r&&o.push(r);const s=function(e,t,o){var r,s,a,l,c,u;const d=e,h=t;if((null==d?void 0:d.ipPosition)!==(null==h?void 0:h.ipPosition)||(null==d?void 0:d.isColdIp)!==(null==h?void 0:h.isColdIp)){if((null==d?void 0:d.isColdIp)===(null==h?void 0:h.isColdIp)&&o)if(o.deltaType===i.WI.Add){if((null==h?void 0:h.ipPosition)===(null!==(r=o.position)&&void 0!==r?r:0)+(null!==(s=o.length)&&void 0!==s?s:0))return}else if(o.deltaType===i.WI.Update){if((null==h?void 0:h.ipPosition)===(null!==(a=o.position)&&void 0!==a?a:0)+(null!==(c=null===(l=o.content)||void 0===l?void 0:l.length)&&void 0!==c?c:0))return}else if(o.deltaType===i.WI.Delete&&(null==h?void 0:h.ipPosition)===(null!==(u=o.position)&&void 0!==u?u:0))return;return new n.s({deltaType:i.WI.CursorUpdate,cursorData:{ipPosition:null==h?void 0:h.ipPosition,isColdIp:null==h?void 0:h.isColdIp}})}}(e,t,r);s&&o.push(s);const l=function(e,t,o){var r,s,l,c,u,d,h;const g=e,p=t;if((null===(r=p.formattedRanges)||void 0===r?void 0:r.length)<=(null===(s=g.formattedRanges)||void 0===s?void 0:s.length))if(o){let e=g.formattedRanges?[...g.formattedRanges]:[];const t=function(e,t,o){if(!e)return;if(t.deltaType===i.WI.Add){const t=e.find((e=>e.start===o&&0===e.length));if(t)return t;o=Math.max(o-1,0)}const n=e.find((e=>0===e.length?e.start===o:e.start<=o&&o<e.start+e.length));return n}(g.formattedRanges,o,o.position),n=t?e.indexOf(t):-1;if(-1!==n&&(o.position+(o.length||0)>t.start+t.length?t.length=o.position+(null!==(l=o.content)&&void 0!==l?l:"").length-t.start:t.length+=(null!==(c=o.content)&&void 0!==c?c:"").length-(o.length||0),e[n]=t),e.length>0){for(const t of e.slice(n+1))t.start<o.position||(o.position+(o.length||0)>t.start?(t.length=t.start+t.length-(o.position+(o.length||0)),t.start=o.position+(null!==(u=o.content)&&void 0!==u?u:"").length):t.start+=(null!==(d=o.content)&&void 0!==d?d:"").length-(o.length||0));e=e.filter((e=>e.length>0))}const r=null!==(h=null==p?void 0:p.formattedRanges)&&void 0!==h?h:[];if(a()(e,r)||0===e.length&&0===r.length)return}else if(a()(null==g?void 0:g.formattedRanges,null==p?void 0:p.formattedRanges))return;return new n.s({deltaType:i.WI.FormattingUpdate,formattedRanges:null==p?void 0:p.formattedRanges})}(e,t,r);l&&o.push(l);const c=function(e,t,o){var r;const s=e,l=t;if(((null==s?void 0:s.attributionRanges)||l.attributionRanges||(null===(r=null==o?void 0:o.attributionData)||void 0===r?void 0:r.ranges))&&!a()(null==s?void 0:s.attributionRanges,null==l?void 0:l.attributionRanges)){if(s.attributionRanges&&l.attributionRanges){const e=[];for(const t of l.attributionRanges)s.attributionRanges.some((e=>a()(e,t)))||e.push(t);if(0===e.length)return;return new n.s({deltaType:i.WI.AttributionUpdate,attributionData:{ranges:e}})}return new n.s({deltaType:i.WI.AttributionUpdate,attributionData:{ranges:null==l?void 0:l.attributionRanges}})}}(e,t,r);c&&o.push(c);const u=function(e,t){const o=e,r=t;let s;const l={};let c=!1;for(s in r)-1===["ipPosition","isColdIp","content","formattedRanges","attributionRanges"].indexOf(s)&&(a()(r[s],o[s])||(c=!0,l[s]=r[s]));if(c)return new n.s({deltaType:i.WI.OtherNonContentUpdate,otherNonContentData:l})}(e,t);return u&&o.push(u),o}function h(e,t){const o=e.content,s=t.content,a=(0,r.C)(o,s),u=a.firstDiffLeft,d=o.length-a.firstDiffRight,h=s.length-a.firstDiffRight;let g,p=i.WI.Update;if(o.length!==s.length)d===u?(p=i.WI.Add,g=o[o.length-1]):h===u&&(p=i.WI.Delete,g=s[s.length-1]);else if(o===s)return;let f,m=0;switch(p){case i.WI.Update:m=d-u,f=s.substring(u,h);break;case i.WI.Add:f=s.substring(u,h);break;case i.WI.Delete:m=d-u,f=o.substring(u,d)}const v=function(e,t){const o=Array.from(e.matchAll(l));if(l.lastIndex=0,0===o.length)return i.OD.Chars;if(1===o.length){if(0===o[0].index)return t&&c.test(t)?i.OD.Sentence:t&&!l.test(t)?i.OD.Word:i.OD.Chars;if(o[0].index+1===e.length)return c.test(e[o[0].index-1])?i.OD.Sentence:l.test(e[o[0].index-1])?i.OD.Chars:i.OD.Word;if(e[o[0].index-1]){const t=e[o[0].index-1];if(c.test(t))return i.OD.Sentence;if(l.test(t))return i.OD.Chars}return i.OD.Word}const n=Array.from(e.matchAll(c));return c.lastIndex=0,0===n.length?i.OD.PartialSentence:n.length>1?i.OD.Paragraph:n[0].index+1<=e.length?l.test(e[n[0].index+1])?i.OD.Sentence:i.OD.Paragraph:void 0}(f,g);if(void 0!==v)return new n.s({content:p!==i.WI.Delete?f:void 0,deltaType:p,unit:v,position:u,length:p!==i.WI.Add?m:0})}},26302:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>r}),3023==o.j)var i=o(23503);if(3023==o.j)var n=o(56238);class r{constructor(){this.deltaBuilderHandlers=new Map,this.registerDeltaBuilderHandler(i.qf.getTypeName(),n.n),this.registerDeltaBuilderHandler(i.Cg.getTypeName(),n.L)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,o){const i=this.deltaBuilderHandlers.get(e);return i?i(t,o):[]}}},28539:(e,t,o)=>{"use strict";function i(e,t,o=!1){let i,s,a={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(i=e,s=t):(i=t,s=e),0===s.indexOf(i)?(a.firstDiffLeft=i.length,a.firstDiffRight=0):s.endsWith(i)?(a.firstDiffLeft=0,a.firstDiffRight=i.length):(a=function(e,t,o=!1){const i={firstDiffLeft:0,firstDiffRight:t.length};let r;for(r=0;r<e.length&&r<t.length;r+=1){const i=e.charCodeAt(r),s=t.charCodeAt(r);if(!(i===s||n(i,o)&&n(s,o)))break}for(i.firstDiffLeft=r,r=0;r<e.length&&r<t.length;r+=1){const i=e.charCodeAt(e.length-r-1),s=t.charCodeAt(t.length-r-1);if(!(i===s||n(i,o)&&n(s,o)))break}return i.firstDiffRight=r,i}(e,t,o),a.firstDiffLeft+a.firstDiffRight>i.length&&(a.firstDiffRight=i.length-a.firstDiffLeft)),function(e,t,o){if(e.firstDiffLeft>0){const i=e.firstDiffLeft<t.length&&r(t,e.firstDiffLeft),n=e.firstDiffLeft<o.length&&r(o,e.firstDiffLeft);(i||n)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const i=e.firstDiffRight<t.length&&r(t,t.length-e.firstDiffRight),n=e.firstDiffRight<o.length&&r(o,o.length-e.firstDiffRight);(i||n)&&(e.firstDiffRight-=1)}}(a,e,t),a}function n(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function r(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}o.d(t,{C:()=>i})},98414:(e,t,o)=>{"use strict";var i;o.d(t,{O:()=>i}),function(e){e.dev="dev",e.int="int",e.test="test",e.dogfood="dogfood",e.msit="msit",e.prod="prod",e.gcc="gcc",e.dod="dod",e.gccHigh="gcchigh",e.ag08="ag08",e.ag09="ag09",e.gallatin="gallatin"}(i||(i={}))},81206:(e,t,o)=>{"use strict";var i;o.d(t,{Z:()=>i}),function(e){e[e.None=0]="None",e[e.Booleans=1]="Booleans",e[e.Float32s=2]="Float32s",e[e.Float64s=3]="Float64s",e[e.Int8s=4]="Int8s",e[e.Int16s=5]="Int16s",e[e.Int32s=6]="Int32s",e[e.Strings=7]="Strings",e[e.UnsignedInt8s=8]="UnsignedInt8s",e[e.UnsignedInt16s=9]="UnsignedInt16s",e[e.UnsignedInt32s=10]="UnsignedInt32s"}(i||(i={}))},98894:(e,t,o)=>{"use strict";var i,n,r,s,a,l,c,u,d,h,g,p;o.d(t,{wC:()=>i}),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(i||(i={})),function(e){e.Default="Default",e.Copilot="Copilot"}(n||(n={})),function(e){e[e.None=0]="None",e[e.ContentFiltering_M365Copilot=1]="ContentFiltering_M365Copilot"}(r||(r={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(s||(s={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(a||(a={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(l||(l={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(c||(c={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(u||(u={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(d||(d={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(h||(h={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount",e.ExtensionLimits="ExtensionLimits"}(g||(g={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(p||(p={}))},19286:(e,t,o)=>{"use strict";var i,n,r,s,a;o.d(t,{OY:()=>i}),function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp",e[e.Dropbox=27]="Dropbox",e[e.GooglePhotos=28]="GooglePhotos",e[e.EditorApp=29]="EditorApp",e[e.AmazonKindle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege",e[e.IntentSvcApp=34]="IntentSvcApp",e[e.DcgLowPrivilege=35]="DcgLowPrivilege",e[e.CSALowPrivilege=36]="CSALowPrivilege",e[e.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege",e[e.CompliantSydneyApp=38]="CompliantSydneyApp",e[e.M365AdminApp=39]="M365AdminApp",e[e.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege",e[e.AlchemyApp=41]="AlchemyApp",e[e.M365Admin=42]="M365Admin",e[e.ConsumerShellApp=43]="ConsumerShellApp",e[e.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege",e[e.CIIApp=45]="CIIApp",e[e.ConsumerShell=46]="ConsumerShell",e[e.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege",e[e.Pva=48]="Pva",e[e.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege",e[e.CallAnalytics=50]="CallAnalytics",e[e.IncomingPFT=51]="IncomingPFT",e[e.GraphExchange=52]="GraphExchange",e[e.EXOAdmin=53]="EXOAdmin",e[e.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege",e[e.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege",e[e.EcsAppOnly=56]="EcsAppOnly",e[e.ShredderLowPrivilege=57]="ShredderLowPrivilege",e[e.SpoLowPrivilege=58]="SpoLowPrivilege",e[e.PromptValidationApp=59]="PromptValidationApp",e[e.CompliantSydneyLowPrivilege=60]="CompliantSydneyLowPrivilege",e[e.SubstrateTenantFeedbackApp=61]="SubstrateTenantFeedbackApp",e[e.MonitoringPlatform=62]="MonitoringPlatform",e[e.YammerLowPrivilege=63]="YammerLowPrivilege",e[e.VivaLearningLowPrivilege=64]="VivaLearningLowPrivilege",e[e.VivaInsightsLowPrivilege=65]="VivaInsightsLowPrivilege",e[e.ClientAugLoopApp=66]="ClientAugLoopApp",e[e.AssistAuthLowPrivilege=67]="AssistAuthLowPrivilege",e[e.VivaLearningSearchPreProdLowPrivilege=68]="VivaLearningSearchPreProdLowPrivilege",e[e.SubstrateSearchApp=69]="SubstrateSearchApp",e[e.SparkContentPlatformLowPrivilege=70]="SparkContentPlatformLowPrivilege",e[e.SparkContentPlatformPopApp=71]="SparkContentPlatformPopApp",e[e.ConsumerSydneyApp=72]="ConsumerSydneyApp",e[e.BusinessAssistAuthLowPrivilege=73]="BusinessAssistAuthLowPrivilege",e[e.AzureResourceManager=74]="AzureResourceManager",e[e.AlchemyPortal=75]="AlchemyPortal",e[e.VivaUserSkillsApp=76]="VivaUserSkillsApp",e[e.VivaEngageAppPop=77]="VivaEngageAppPop",e[e.SubstrateAppOnly=78]="SubstrateAppOnly",e[e.PowerAutomateFlowCreationLowPrivilege=79]="PowerAutomateFlowCreationLowPrivilege",e[e.PowerAutomateConnectionCreationLowPrivilege=80]="PowerAutomateConnectionCreationLowPrivilege",e[e.PowerAutomateAuthorizeConnectionLowPrivilege=81]="PowerAutomateAuthorizeConnectionLowPrivilege",e[e.TCAAppPop=82]="TCAAppPop",e[e.BusinessAssistAuthAppPop=83]="BusinessAssistAuthAppPop",e[e.HolmesApp=84]="HolmesApp",e[e.GraphAppOnly=85]="GraphAppOnly",e[e.SimsApp=86]="SimsApp",e[e.VivaOrgInsightsLowPrivilege=87]="VivaOrgInsightsLowPrivilege",e[e.VivaGoalsAppPop=88]="VivaGoalsAppPop",e[e.GCBotAppPop=89]="GCBotAppPop",e[e.ShredderV2App=90]="ShredderV2App",e[e.ShredderV2LowPrivilege=91]="ShredderV2LowPrivilege",e[e.AmplifyProfileService=92]="AmplifyProfileService",e[e.AzureDevopsLowPrivilege=93]="AzureDevopsLowPrivilege",e[e.CommuteServices=94]="CommuteServices",e[e.GCBotAppOnly=95]="GCBotAppOnly",e[e.TCAAppOnly=96]="TCAAppOnly",e[e.MavenAgentLowPrivilege=97]="MavenAgentLowPrivilege",e[e.VivaOrgInsightsAppPop=98]="VivaOrgInsightsAppPop",e[e.EduAssignmentsPftAtPop=99]="EduAssignmentsPftAtPop",e[e.AugloopAppPop=100]="AugloopAppPop",e[e.OneNoteLowPrivilege=101]="OneNoteLowPrivilege",e[e.TeamsAuthzSvcAppPop=102]="TeamsAuthzSvcAppPop",e[e.LoopAppPop=103]="LoopAppPop",e[e.LoopAppOnly=104]="LoopAppOnly",e[e.BapLowPrivilege=105]="BapLowPrivilege",e[e.IC3AppPop=106]="IC3AppPop",e[e.PowerPlatformApiGateway=107]="PowerPlatformApiGateway",e[e.OdspNotifyAppPop=108]="OdspNotifyAppPop",e[e.MIPSyncService=109]="MIPSyncService",e[e.RightsManagementServices=110]="RightsManagementServices",e[e.TCAV2AppPop=111]="TCAV2AppPop",e[e.SubstrateLLMLowPrivilege=112]="SubstrateLLMLowPrivilege",e[e.SubstrateSearchLowPrivilege=113]="SubstrateSearchLowPrivilege",e[e.CloudPolicyServiceAppPop=114]="CloudPolicyServiceAppPop",e[e.TCAV2LowPrivilege=115]="TCAV2LowPrivilege",e[e.AiHubServicesAppPop=116]="AiHubServicesAppPop",e[e.TMRAppOnly=117]="TMRAppOnly",e[e.PacmanAppPop=118]="PacmanAppPop",e[e.AugloopAlternativeIdentity=119]="AugloopAlternativeIdentity",e[e.SpoAppOnly=120]="SpoAppOnly",e[e.DataverseLowPrivilege=121]="DataverseLowPrivilege",e[e.SubstrateLLMApp=122]="SubstrateLLMApp",e[e.SimsAppOnly=123]="SimsAppOnly",e[e.PythonService=124]="PythonService",e[e.PythonServiceAppOnly=125]="PythonServiceAppOnly",e[e.DesignerAppServiceLowPrivilege=126]="DesignerAppServiceLowPrivilege",e[e.DesignerAppServiceAppPop=127]="DesignerAppServiceAppPop",e[e.AmplifyProfileServiceAppOnly=128]="AmplifyProfileServiceAppOnly",e[e.MARSAppPop=129]="MARSAppPop",e[e.PlannerAppPop=130]="PlannerAppPop",e[e.BingForBusinessLowPrivilege=131]="BingForBusinessLowPrivilege",e[e.OLS=132]="OLS",e[e.OLSAppPop=133]="OLSAppPop",e[e.GCS=134]="GCS",e[e.AugLoopConsumer=135]="AugLoopConsumer",e[e.ContentValidationServiceAppOnly=136]="ContentValidationServiceAppOnly",e[e.FabricLowPrivilege=137]="FabricLowPrivilege",e[e.FeatureAccessManagementAppPop=138]="FeatureAccessManagementAppPop",e[e.FireIntelligenceAppOnly=139]="FireIntelligenceAppOnly",e[e.MARSLowPrivilege=140]="MARSLowPrivilege",e[e.EXOAdminAppPop=141]="EXOAdminAppPop"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(n||(n={})),function(e){e[e.Default=0]="Default",e[e.EDPSCompliant=1]="EDPSCompliant"}(r||(r={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(s||(s={})),function(e){e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut"}(a||(a={}))},719:(e,t,o)=>{"use strict";var i;o.d(t,{T:()=>i}),function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}(i||(i={})),Error},2843:(e,t,o)=>{"use strict";var i;o.d(t,{q:()=>i}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(i||(i={}))},65920:(e,t,o)=>{"use strict";var i,n,r,s,a,l,c,u,d,h,g,p;o.d(t,{Y$:()=>s,in:()=>l,wC:()=>i}),function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(i||(i={})),function(e){e.Default="Default",e.Copilot="Copilot"}(n||(n={})),function(e){e[e.None=0]="None",e[e.ContentFiltering_M365Copilot=1]="ContentFiltering_M365Copilot"}(r||(r={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(s||(s={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(a||(a={})),function(e){e[e.Required=-3]="Required",e[e.Optional=-1]="Optional"}(l||(l={})),function(e){e[e.Never=0]="Never",e[e.Always=1]="Always"}(c||(c={})),function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(u||(u={})),function(e){e[e.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",e[e.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",e[e.DeltaUpdate=2]="DeltaUpdate",e[e.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals"}(d||(d={})),function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(h||(h={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount",e.ExtensionLimits="ExtensionLimits"}(g||(g={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(p||(p={}))},42316:(e,t,o)=>{"use strict";o.d(t,{r:()=>a});const{AugLoopTextEncoder:i,AugLoopTextDecoder:n}=(()=>{if("undefined"==typeof TextEncoder||"undefined"==typeof TextDecoder){o(12855);const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})();var r=o(69616).hp,s=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class a{static extractFragments(e){if(e[0]!==a.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let t=1;const o=[],i=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;t<e.byteLength;){if(t+4>e.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const n=i.getUint32(t);if(t+n+4>e.byteLength)throw new Error("Invalid Binary: Fragment out of range");void 0!==r&&r.from?o.push(r.from(e.buffer,e.byteOffset+t+4,n)):o.push(new Uint8Array(e.buffer,e.byteOffset+t+4,n)),t+=4+n}if(o.length<1)throw new Error("Invalid Binary: No fragments found");return o}static deserialize(e,t=(e=>e)){const o=a.extractFragments(e),i=a.textDecoder.decode(o[0]);return JSON.parse(i,((e,i)=>{if("string"==typeof i){if(i.substring(0,a.BINARYKEYWORD.length)===a.BINARYKEYWORD){const e=parseInt(i.substring(a.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=o.length-1)throw new Error("Invalid Binary: Binary index out of range");return t(o[e+1])}if(i.substring(0,a.ESCAPEKEYWORD.length)===a.ESCAPEKEYWORD)return i.substring(a.ESCAPEKEYWORD.length)}return i}))}static deserializeAsync(e,t=(e=>s(this,void 0,void 0,(function*(){return e})))){return s(this,void 0,void 0,(function*(){const o=a.extractFragments(e),i=a.textDecoder.decode(o[0]),n=[],r=Symbol("placeholder"),s=e=>{if(Array.isArray(e)){for(let t=0;t<e.length;t++)e[t]=s(e[t]);return e}if(null!==e&&"object"==typeof e){if(e[r])return e.value;for(const t of Object.keys(e))e[t]=s(e[t]);return e}return e};let l=JSON.parse(i,((e,i)=>{if("string"==typeof i){if(i.startsWith(a.BINARYKEYWORD)){const e=parseInt(i.substring(a.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=o.length-1)throw new Error("Invalid Binary: Binary index out of range");const s=t(o[e+1]);return n.push(s),(e=>{const t={[r]:!0,value:void 0};return e.then((e=>{t.value=e})),t})(s)}if(i.startsWith(a.ESCAPEKEYWORD))return i.substring(a.ESCAPEKEYWORD.length)}return i}));return yield Promise.all(n),l=yield s(l),l}))}static serializeInternal(e){const t=[void 0],o=JSON.stringify(e,((e,o)=>ArrayBuffer.isView(o)?(t.push(o),`${a.BINARYKEYWORD}${t.length-2}`):o&&"Buffer"===o.type&&Array.isArray(o.data)?(t.push(new Uint8Array(o.data)),`${a.BINARYKEYWORD}${t.length-2}`):"string"==typeof o&&o.substring(0,a.ESCAPEKEYWORD.length)===a.ESCAPEKEYWORD?a.ESCAPEKEYWORD+o:o));t[0]=a.textEncoder.encode(o);const i=t.reduce(((e,t)=>e+4+t.byteLength),0),n=new Uint8Array(i+1);n[0]=a.IDENTIFIERBYTE;let r=1;const s=new DataView(n.buffer,n.byteOffset,n.byteLength);for(const e of t)s.setUint32(r,e.byteLength),n.set(e,r+4),r+=4+e.byteLength;return n}static serialize(e){return a.serializeInternal(e)}static serializeAsync(e){return s(this,void 0,void 0,(function*(){return new Promise(((t,o)=>{try{t(a.serializeInternal(e))}catch(e){o(e)}}))}))}}a.IDENTIFIERBYTE=3,a.BINARYKEYWORD=":b",a.ESCAPEKEYWORD=":",a.textDecoder=new n,a.textEncoder=new i},98472:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}());class r extends n{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}},13272:(e,t,o)=>{"use strict";o.d(t,{u:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.operationName="",e.prototype.key="",e.prototype.value="",e.prototype.buildVersion="",e.prototype.datafield0="",e.prototype.datafield1="",e.prototype.datafield2="",e.prototype.datafield3="",e.prototype.tagId=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnonymizedOperationEvent"},e}());class r extends n{constructor(e){if(super(e),this.eventName="AnonymizedOperation",this.allowListedLogs=[508856344,508688156],!this.allowListedLogs.includes(e.tagId))throw new Error("AnonymizedOperations must be allow-listed and reviewed by AugLoop engineering team. Please include your privacy approval in the review.")}}},56056:(e,t,o)=>{"use strict";o.d(t,{W:()=>i});class i{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<r;e++)s[e]=n[Math.floor(Math.random()*n.length)];return s.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let o;return o=e.endsWith(".0")?new i(e.substring(0,e.length-2)):new i(e),t&&(o.childCount=t),o}newChild(){return++this.childCount,new i(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const n=3023==o.j?["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"]:null,r=22,s=new Array(r)},9175:(e,t,o)=>{"use strict";o.d(t,{u:()=>n});var i=o(56056);class n{get sessionKey(){var e;return null===(e=this.sessionDescriptor)||void 0===e?void 0:e.sessionKey}get userTenantId(){var e,t;return null===(t=null===(e=this.sessionDescriptor)||void 0===e?void 0:e.userContext)||void 0===t?void 0:t.tid}get interactionSessionId(){return this._interactionSessionId}set interactionSessionId(e){if(this._interactionSessionId&&this._interactionSessionId!==e)throw new Error("InteractionSessionId is already set");this._interactionSessionId=e}get interactionId(){return this._interactionId}set interactionId(e){if(this._interactionId&&this._interactionId!==e)throw new Error("InteractionId is already set");this._interactionId=e}constructor(e,t,o,i){var n;this.cv=e,this.sessionDescriptor=t,this.clientMetadata=o,this.workflow=null==i?void 0:i.workflow,this.joinContextId=null==i?void 0:i.joinContextId,this.performanceEvent=null==i?void 0:i.performanceEvent,this.sessionLogsSampled=void 0,this._interactionId=null==i?void 0:i.interactionId,this._interactionSessionId=null==i?void 0:i.interactionSessionId,this.traceId=null==i?void 0:i.traceId,this.disableLogging=null!==(n=null==i?void 0:i.disableLogging)&&void 0!==n&&n}static deserialize(e){var t,o;if(e)try{const r=JSON.parse(e),s={appName:r.clientAppName,appPlatform:r.clientAppPlatform,releaseAudienceGroup:r.clientReleaseAudienceGroup,flights:r.clientFlights},a=null!==(t=r.userContext)&&void 0!==t?t:{};return a.userDataBoundaryType=null!==(o=a.userDataBoundaryType)&&void 0!==o?o:r.userDataBoundaryType,new n(new i.W(r.cv),{sessionKey:r.sessionKey,userId:r.userId,mastermindEndpoint:r.mastermindEndpoint,userContext:a},s,{workflow:r.workflow,joinContextId:r.joinContextId,interactionId:r.interactionId,interactionSessionId:r.interactionSessionId,traceId:r.traceId,disableLogging:r.disableLogging})}catch(t){return new n(new i.W(e))}}static fromExisting(e,t,o,i,r){return new n(t||e.cv,o||e.sessionDescriptor,i||e.clientMetadata,{workflow:(null==r?void 0:r.workflow)||e.workflow,joinContextId:(null==r?void 0:r.joinContextId)||e.joinContextId,performanceEvent:(null==r?void 0:r.performanceEvent)||e.performanceEvent,interactionId:(null==r?void 0:r.interactionId)||e.interactionId,interactionSessionId:(null==r?void 0:r.interactionSessionId)||e.interactionSessionId,traceId:(null==r?void 0:r.traceId)||e.traceId,disableLogging:(null==r?void 0:r.disableLogging)||e.disableLogging})}toString(){var e,t;return`${null===(e=this.clientMetadata)||void 0===e?void 0:e.appName};${null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform};${this.sessionKey};${this.cv}`}serialize(){var e,t,o,i,r,s;const a=null===(e=this.clientMetadata)||void 0===e?void 0:e.appName,l=null===(t=this.clientMetadata)||void 0===t?void 0:t.appPlatform,c=null===(o=this.clientMetadata)||void 0===o?void 0:o.releaseAudienceGroup,u=null===(i=this.clientMetadata)||void 0===i?void 0:i.flights,d=null===(r=this.sessionDescriptor)||void 0===r?void 0:r.userContext;return n.stringify(Object.assign(Object.assign({cv:this.cv.toString()},null!==(s=this.sessionDescriptor)&&void 0!==s?s:{}),{clientAppName:a,clientAppPlatform:l,clientReleaseAudienceGroup:c,clientFlights:u,workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId,disableLogging:this.disableLogging,userContext:{tid:null==d?void 0:d.tid,oid:null==d?void 0:d.oid,userDataBoundaryType:null==d?void 0:d.userDataBoundaryType},userDataBoundaryType:null==d?void 0:d.userDataBoundaryType}))}newChild(){return new n(this.cv.newChild(),this.sessionDescriptor,this.clientMetadata,{workflow:this.workflow,joinContextId:this.joinContextId,interactionId:this.interactionId,interactionSessionId:this.interactionSessionId,traceId:this.traceId,disableLogging:this.disableLogging})}}n.schema={type:"object",properties:{cv:{type:"string"},clientAppName:{type:"string"},clientAppPlatform:{type:"string"},clientReleaseAudienceGroup:{type:"string"},clientFlights:{type:"string"},sessionKey:{type:"string"},userId:{type:"string"},mastermindEndpoint:{type:"string"},workflow:{type:"string"},joinContextId:{type:"string"},interactionId:{type:"string"},interactionSessionId:{type:"string"},traceId:{type:"string"},disableLogging:{type:"boolean"},userDataBoundaryType:{type:"number"},userContext:{type:"object",properties:{tid:{type:"string"},userDataBoundaryType:{type:"number"}}}}},n.stringify=(n.schema,JSON.stringify)},61720:(e,t,o)=>{"use strict";o.d(t,{HW:()=>g,IQ:()=>y,NS:()=>h,S8:()=>l,Ve:()=>d,Zw:()=>v,fK:()=>m,fZ:()=>b,nd:()=>p,z0:()=>f});var i=o(56056),n=o(9175);let r=new n.u(new i.W);const s=3023==o.j?[]:null;let a;const l=()=>a,c=new Map;let u;const d=e=>{s.push(r),r=e,a=e},h=e=>{if(r===e)return void(r=s.pop());const t=s.lastIndexOf(e);if(t<0)throw new Error("Context not found");if(0===t)throw new Error("Cannot remove top context");s.splice(t,1)},g=e=>{u||(u=e.createHook({init(t){const o=p();if(o)c.set(t,o);else if(0===e.executionAsyncId()){const o=e.triggerAsyncId(),i=c.get(o);i&&c.set(t,i)}},before(e){const t=c.get(e);t&&d(t)},after(e){const t=c.get(e);t&&h(t)},destroy(e){c.delete(e)}}),u.enable())},p=()=>r,f=()=>r&&r.cv&&r.cv.toString()||null,m=()=>{var e,t;return new n.u((null===(e=null==r?void 0:r.cv)||void 0===e?void 0:e.newChild())||new i.W,null==r?void 0:r.sessionDescriptor,null==r?void 0:r.clientMetadata,{workflow:null==r?void 0:r.workflow,joinContextId:null==r?void 0:r.joinContextId,performanceEvent:null==r?void 0:r.performanceEvent,interactionId:null==r?void 0:r.interactionId,interactionSessionId:r.interactionSessionId,traceId:null==r?void 0:r.traceId,disableLogging:null!==(t=null==r?void 0:r.disableLogging)&&void 0!==t&&t})},v=e=>{const t=m();return y((t=>e(t&&t.cv||void 0)),t)},b=(e,t,o,s,a)=>{const l=new n.u(t&&i.W.fromString(t)||(null==r?void 0:r.cv)||new i.W,o||(null==r?void 0:r.sessionDescriptor),s||(null==r?void 0:r.clientMetadata),{workflow:(null==a?void 0:a.workflow)||(null==r?void 0:r.workflow),joinContextId:(null==a?void 0:a.joinContextId)||(null==r?void 0:r.joinContextId),performanceEvent:(null==a?void 0:a.performanceEvent)||(null==r?void 0:r.performanceEvent),interactionId:(null==a?void 0:a.interactionId)||(null==r?void 0:r.interactionId),interactionSessionId:(null==a?void 0:a.interactionSessionId)||(null==r?void 0:r.interactionSessionId),traceId:(null==a?void 0:a.traceId)||(null==r?void 0:r.traceId),disableLogging:(null==a?void 0:a.disableLogging)||(null==r?void 0:r.disableLogging)||!1});return y(e,l)},y=(e,t)=>{d(t);try{return e(t)}finally{h(t)}}},57807:(e,t,o)=>{"use strict";var i;o.d(t,{AQ:()=>r,GR:()=>i,HX:()=>c,He:()=>s,ax:()=>a,oX:()=>l,sw:()=>u,yL:()=>n}),function(e){e.UnexpectedClose="UnexpectedClose",e.ExpectedClose="ExpectedClose",e.ExpectedError="ExpectedError"}(i||(i={}));const n="ExcelExtensionClose",r="ExcelKeepAlive",s=3023==o.j?`ProcessMessage_${n}`:null,a=3023==o.j?`${n}_${i[i.ExpectedClose]}`:null,l=3023==o.j?`${n}_${i[i.ExpectedError]}`:null,c=3023==o.j?`${n}_${i[i.UnexpectedClose]}`:null;var u;!function(e){e[e.Unknown=0]="Unknown",e[e.SessionClosedOutside=1]="SessionClosedOutside",e[e.ClosedOutsideBeforeInitialSeedingCompleted=2]="ClosedOutsideBeforeInitialSeedingCompleted",e[e.EcsProxyClose=3]="EcsProxyClose",e[e.EcsProxyFailedToFetchContent=4]="EcsProxyFailedToFetchContent",e[e.EcsProxyFailedToFetchWorkbookMetadata=5]="EcsProxyFailedToFetchWorkbookMetadata",e[e.EcsProxyFailedToRequestWaitForWorkbookChange=6]="EcsProxyFailedToRequestWaitForWorkbookChange",e[e.EcsProxyReconnect=7]="EcsProxyReconnect",e[e.EcsProxyUnexpected=8]="EcsProxyUnexpected",e[e.EcsSessionClosedNotification=9]="EcsSessionClosedNotification",e[e.SessionIdle=10]="SessionIdle",e[e.FailedToProducePubSubMessage=11]="FailedToProducePubSubMessage",e[e.FailedToSetSessionData=12]="FailedToSetSessionData",e[e.FailedToGetSessionData=13]="FailedToGetSessionData",e[e.ReachUnexpectedCode=14]="ReachUnexpectedCode",e[e.RequestIdMismatch=15]="RequestIdMismatch",e[e.SeedingNotRequired=16]="SeedingNotRequired",e[e.ShortAccessTokenTTLReconnect=17]="ShortAccessTokenTTLReconnect"}(u||(u={}))},65767:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>s}),3023==o.j)var i=o(21019);if(3023==o.j)var n=o(62788);if(3023==o.j)var r=o(13272);class s{constructor(e,t,o,n,r=5,s){this.severity=e,this.resourceId=t,this.tokenExpirationInMS=o,this.idleDurationInMS=n,this.kAnonUser=r,this.log=s,this.cache=new i.l({idleDurationMs:this.idleDurationInMS,sweepInterval:6e4}),this.kAnonUser=Math.min(5,this.kAnonUser),this.log=s||this.logHits}updateTokenCount(e,t,o){this.flush();const i=Date.now(),n=this.cache.get(e);if(!n)return void this.cache.put(e,{users:[{userId:t,timestamp:i,count:o}]},this.tokenExpirationInMS);const r=n.users.find((e=>e.userId===t));if(r)r.timestamp=i,r.count+=o;else if(n.users.push({userId:t,timestamp:i,count:o}),n.users.length>=this.kAnonUser){const t=n.users.reduce(((e,t)=>e+t.count),0);this.cache.del(e),this.log(e,t)}}logHits(e,t){n.tG.info(508688156,n.nh.CoreSystem,new r.u({operationName:"BlocklistMatchEvent",key:e,value:t+"",datafield0:this.severity,datafield1:this.resourceId,buildVersion:process.env.BUILD_BUILDNUMBER||"DEV",tagId:508688156}))}flush(){this.cache.forEach((e=>{e.users=e.users.filter((e=>Date.now()<e.timestamp+this.tokenExpirationInMS))}))}getCount(e){this.flush();const t=this.cache.get(e);return t?t.users.reduce(((e,t)=>e+t.count),0):0}shutdown(){this.cache.clear(),this.cache=void 0}}},91602:(e,t,o)=>{"use strict";o.d(t,{H:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpRequestQueueEvent"},e}());class r extends n{getMetrics(){return{HttpRequestQueueV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpRequestQueue"}}},49522:(e,t,o)=>{"use strict";o.d(t,{S:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Name="",e.prototype.Length=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/HttpSocketListEvent"},e}());class r extends n{getMetrics(){return{HttpSocketListV2:{dimensionNames:()=>[],dimensionValues:[],value:this.Length}}}constructor(e){super(e),this.eventName="HttpSocketList"}}},84402:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{AnnotationMetaDataChange:()=>d.v,AnonymizedOperation:()=>m.u,CorrelationContext:()=>a.u,CorrelationVector:()=>l.W,CustomBlockListLogger:()=>T.P,ExtensionCloseReason:()=>C.sw,ExtensionCloseType:()=>C.GR,HttpRequestQueue:()=>r.H,HttpSocketList:()=>y.S,Log:()=>i.tG,LogCategory:()=>i.nh,LoggingAggregator:()=>u.D,Operation:()=>n.I,OutboundHttpRequest:()=>b.c,PrivacyGuardIssue:()=>w.J,ProcessIdentification:()=>s.U,ScenarioStats:()=>f.y,SessionHealthEvent:()=>h.vf,SessionHealthEventAggregation:()=>g.N,SessionHealthImpact:()=>h.Pq,SessionHealthReason:()=>h.l6,SessionHealthSource:()=>h.aM,SessionIssue:()=>p.M,Timer:()=>v.M,WebSocketConnectionEnd:()=>c.j,argsToString:()=>i.am,createChildCorrelation:()=>S.fK,enter:()=>S.Ve,excelExtensionCloseEventName:()=>C.yL,excelExtensionExpectedCloseEventName:()=>C.ax,excelExtensionExpectedErrorEventName:()=>C.oX,excelExtensionUnexpectedCloseEventName:()=>C.HX,excelKeepAliveAggregationName:()=>C.He,excelKeepAliveMessageName:()=>C.AQ,exit:()=>S.NS,getCorrelation:()=>S.nd,getCorrelationVectorString:()=>S.z0,getLastCorrelationContext:()=>S.S8,getNumLoggers:()=>i.OD,initAsyncHooks:()=>S.HW,now:()=>k.t,nowMicroSeconds:()=>k.g,resumeCorrelation:()=>S.IQ,startChildCorrelation:()=>S.Zw,startCorrelation:()=>S.fZ,tagIdToString:()=>i.ih}),3023==o.j)var i=o(62788);if(3023==o.j)var n=o(34574);if(3023==o.j)var r=o(91602);if(3023==o.j)var s=o(88483);if(3023==o.j)var a=o(9175);if(3023==o.j)var l=o(56056);if(3023==o.j)var c=o(99105);if(3023==o.j)var u=o(31381);if(3023==o.j)var d=o(98472);if(3023==o.j)var h=o(71415);if(3023==o.j)var g=o(48891);if(3023==o.j)var p=o(97897);if(3023==o.j)var f=o(86325);if(3023==o.j)var m=o(13272);if(3023==o.j)var v=o(66375);if(3023==o.j)var b=o(28963);if(3023==o.j)var y=o(49522);if(3023==o.j)var w=o(23527);if(3023==o.j)var C=o(57807);if(3023==o.j)var S=o(61720);if(3023==o.j)var k=o(41966);if(3023==o.j)var T=o(65767)},31381:(e,t,o)=>{"use strict";o.d(t,{D:()=>r});const i=/\|\~/g;class n{constructor(){this.count=0,this.measureSums=new Map}}class r{constructor(e,t,o,r,s){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const o=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])o.push(null);else{let n="";"boolean"==typeof e[t]?n="b~":"number"==typeof e[t]&&(n="n~"),o.push(`${n}${e[t].toString().replace(i,"_")}`)}const r=o.join("|");let s=this.buckets.get(r);if(!s){s=new n,s.traceLevel=e.traceLevel;for(const e of this.avgMeasures)s.measureSums.set(e,0);this.buckets.set(r,s)}s.count++;for(const t of this.avgMeasures)e[t]&&s.measureSums.set(t,s.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const o={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},i=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],n=i[e];0===n.indexOf("b~")?o[t]="b~true"===n:0===n.indexOf("n~")?o[t]=parseInt(n.slice(2),10):o[t]=n}for(const t of this.avgMeasures)o[t]=Math.round(e.measureSums.get(t)/e.count);this.log(o,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=o,this.avgMeasures=r,s>0&&(this.interval=setInterval(this.flush,1e3*s))}}},62788:(e,t,o)=>{"use strict";var i,n;o.d(t,{tG:()=>v,nh:()=>M,am:()=>y,OD:()=>k,ih:()=>A}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(i||(i={})),function(e){e.Log="Log"}(n||(n={}));const r="undefined"!=typeof process&&process.env?process.env.SERVICE_NAME:"client",s="abcdefghijklmnopqrstuvwxyz0123456789",a={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let l,c=[],u=[],d=e=>null,h=e=>{};const g=new Map,p=new Map,f=new Map,m=new Map;var v;!function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{c=[],u=[],p.clear(),f.clear()},e.clearAggregators=()=>{g.clear()},e.addLogger=e=>{-1===c.indexOf(e)&&(c.push(e),b(p,e))},e.addDecidingLogger=e=>{-1===u.indexOf(e)&&(u.push(e),b(f,e))},e.setCorrelationContextCallback=e=>{l=e},e.setStartPerformanceEventCallback=e=>{d=e},e.setStopPerformanceEventCallback=e=>{h=e},e.addAggregator=e=>{e.init(((e,t)=>{I(e,t)})),g.has(e.eventName)?g.get(e.eventName).push(e):g.set(e.eventName,[e])},e.flushAggregators=e=>{g.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const o=R(e);m.set(o,t)},e.resetTagLevelOverrides=()=>{m.clear()},e.error=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.error,o,n,r,s,a,l,c,u)},e.warn=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.warn,o,n,r,s,a,l,c,u)},e.info=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.info,o,n,r,s,a,l,c,u)},e.verbose=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.verbose,o,n,r,s,a,l,c,u)},e.debug=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.debug,o,n,r,s,a,l,c,u)},e.metric=(e,t,o,n,r,s,a,l,c,u)=>{_(e,t,i.metric,o,n,r,s,a,l,c,u)},e.formatMetric=(e,t,o,i)=>{const n={};return n[e]={dimensionNames:o,dimensionValues:i,value:t},n},e.dynamic=e=>{I(e)}}(v||(v={}));const b=(e,t)=>{const o=t.level;Object.keys(i).map((e=>i[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=o)).forEach((o=>{e.has(o)?e.get(o).push(t):e.set(o,[t])}))},y=e=>{if("string"==typeof e)return e;let t="";for(let o=0;o<e.length;o++){o>0&&(t+=" ");const i=e[o];i instanceof Error?t+=JSON.stringify({message:i.message,name:i.name,stack:i.stack}):t+="object"==typeof i?JSON.stringify(i):i}return t},w=[],C=["Level","Tag"],S=["Level","Tag","Workflow"],k=e=>T(e).length,T=e=>void 0!==e?p.get(e)||w:c,x=(e,t)=>(void 0!==e?f.get(e)||[]:u).filter((e=>e.shouldLog(t))),_=(e,t,o,i,r,s,a,c,u,p,f)=>{o=m.get(e)||o;const v=T(o),b=x(o,i);if(0==v.length&&0==b.length)return;const w=d(n.Log),k=A(e),_=((e,t,o,i,n,r,s,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const l=[];for(const c of[e,t,o,i,n,r,s,a])void 0!==c&&l.push("function"==typeof c?c():c);return l})(i,r,s,a,c,u,p,f);if(E(t))B(_)&&I({eventName:"Metrics",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:"",getMetrics:()=>_},!1,v,b);else if(B(_)){const e=_;e.tagId=k,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",l&&(e.joinContextId=l().joinContextId,e.workflow=l().workflow)),e.traceLevel=o;const i=g.get(e.eventName);if(i)for(let t=0;t<i.length;++t){const o=i[t];if(o&&o.add(e,t===i.length-1))break}else I(e,!1,v,b)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>C,dimensionValues:[String(o),k],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>S,dimensionValues:[String(o),k,l?null===(e=l())||void 0===e?void 0:e.workflow:""],value:1}}};I({eventName:"Log",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:y(_),getMetrics:e},!1,v,b)}h(w)},I=(e,t=!1,o,i)=>{var n,s,a,c,u,d,h,g,p,f,m,v,b,y;let C;if(null==o&&(o=T(e.traceLevel)),i=i||w,o.length>0||i.length>0){if(e.serviceName=r,!t&&l){const t=l();t&&(C={disableLogging:t.disableLogging,userDataBoundaryType:null===(s=null===(n=t.sessionDescriptor)||void 0===n?void 0:n.userContext)||void 0===s?void 0:s.userDataBoundaryType},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.userTenantId=e.userTenantId?e.userTenantId:t.userTenantId,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(a=t.clientMetadata)||void 0===a?void 0:a.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(c=t.clientMetadata)||void 0===c?void 0:c.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(u=t.clientMetadata)||void 0===u?void 0:u.appVersion,e.clientDeviceId=e.clientDeviceId?e.clientDeviceId:null===(d=t.clientMetadata)||void 0===d?void 0:d.deviceId,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(h=t.clientMetadata)||void 0===h?void 0:h.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(p=t.clientMetadata)||void 0===p?void 0:p.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(f=t.clientMetadata)||void 0===f?void 0:f.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(m=t.clientMetadata)||void 0===m?void 0:m.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(v=t.clientMetadata)||void 0===v?void 0:v.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(b=t.clientMetadata)||void 0===b?void 0:b.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(y=t.clientMetadata)||void 0===y?void 0:y.isClientTelemetrySampled)}for(const t of o)t.log(e,C);for(const t of i)t.log(e)}},E=e=>e.name===M.WorkflowMetricsOnly.name&&e.root===M.WorkflowMetricsOnly.root,B=e=>!Array.isArray(e)&&"object"==typeof e,A=e=>s[e>>24&63]+s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e],R=e=>e&&5===e.length?a[e.charCodeAt(0)]<<24|a[e.charCodeAt(1)]<<18|a[e.charCodeAt(2)]<<12|a[e.charCodeAt(3)]<<6|a[e.charCodeAt(4)]:-1;class M{}M.CoreDefault=v.defineCoreLogCategory("Default"),M.CoreSystem=v.defineCoreLogCategory("System"),M.CoreUnsampled=v.defineCoreLogCategory("Unsampled"),M.WorkflowDefault=v.defineWorkflowLogCategory("Default"),M.WorkflowUnsampled=v.defineWorkflowLogCategory("Unsampled"),M.WorkflowMetricsOnly=v.defineWorkflowLogCategory("MetricsOnly"),M.PrivacyGuardEvent=v.defineCoreLogCategory("PrivacyGuardEvent")},41966:(e,t,o)=>{"use strict";o.d(t,{g:()=>n,t:()=>i});const i="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now(),n="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e6*e[0]+e[1]/1e3}:"undefined"!=typeof performance&&performance.now?()=>Math.round(1e3*performance.now()):()=>1e3*Date.now()},34574:(e,t,o)=>{"use strict";o.d(t,{I:()=>s});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}()),r=o(41966);class s extends n{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){null!=t&&(this.dataFieldsObject||(this.dataFieldsObject={}),this.dataFieldsObject[e]=t)}setDataFields(e){this.dataFieldsObject||(this.dataFieldsObject={}),this.dataFieldsObject=Object.assign(Object.assign({},this.dataFieldsObject),e)}start(){return this.startTime=(0,r.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,r.t)()-this.startTime)),this}stop(){const e=(0,r.t)();return this.durationMs=Math.round(e-this.startTime),this}getMetrics(e){var t,o;const i={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":i[this.operationName+".CountV2"]={dimensionNames:s.getOrphanedSessionHealthDimensionNames.bind(s),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":i[this.operationName+".Reason"]={dimensionNames:s.getSessionHealthDimensionNames.bind(s),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(i["Workflow.DurationMs"]={dimensionNames:s.getWorkflowDimensionNames.bind(s),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},i["Workflow.Count"]={dimensionNames:s.getWorkflowDimensionNames.bind(s),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const o=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(o)>=0)&&(i[o]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(o=this.options)||void 0===o?void 0:o.metricCount)||e.indexOf(t)>=0)&&(i[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return i}getDimensionNames(){var e,t;let o=s.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){o=o.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(e)}return o}getDimensionValues(){var e,t;const o=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(this.options.metricCustomDimensions[e]);return o}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}s.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],s.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],s.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],s.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"]},28963:(e,t,o)=>{"use strict";o.d(t,{c:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.host="",e.prototype.statusCode=0,e.prototype.success=!1,e.prototype.wait=0,e.prototype.dns=0,e.prototype.tcp=0,e.prototype.firstByte=0,e.prototype.download=0,e.prototype.total=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OutboundHttpRequestEvent"},e}());class r extends n{getMetrics(){return{"OutboundHttpRequestV2.Wait":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.wait},"OutboundHttpRequestV2.DNS":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.dns},"OutboundHttpRequestV2.TCP":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.tcp},"OutboundHttpRequestV2.FirstByte":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.firstByte},"OutboundHttpRequestV2.Download":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.download},"OutboundHttpRequestV2.Total":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.total}}}constructor(e){super(e),this.eventName="OutboundHttpRequest"}getDimensionValues(){return[this.host,this.statusCode,this.success]}}r.dimensionNames=["Host","StatusCode","Success"]},23527:(e,t,o)=>{"use strict";o.d(t,{J:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.suspiciousStringValue="",e.prototype.PG_ConcernEventName="",e.prototype.PG_TableName="",e.prototype.PG_ColumnName="",e.prototype.PG_EventTime="",e.prototype.PG_ConcernTypeText="",e.prototype.PG_ShouldIgnore=!1,e.prototype.PG_EventLocatorName="",e.prototype.PG_EventLocatorValue="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/PrivacyGuardIssueEvent"},e}());class r extends n{constructor(e){super(e),this.eventName="PrivacyGuardIssue"}}},88483:(e,t,o)=>{"use strict";o.d(t,{U:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.Pid=0,e.prototype.ApplicationName="",e.prototype.ServiceName="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ProcessIdentificationEvent"},e}());class r extends n{constructor(){super(...arguments),this.eventName="ProcessIdentification"}}},86325:(e,t,o)=>{"use strict";o.d(t,{y:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.clientDeviceId="",e.prototype.resourceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthReasonCategory="",e.prototype.healthBucketWithSuppressions="",e.prototype.healthReasonWithSuppressions="",e.prototype.healthReasonCategoryWithSuppressions="",e.prototype.scenarioHealthBucket="",e.prototype.scenarioHealthReason="",e.prototype.scenarioHealthBucketWithSuppressions="",e.prototype.scenarioHealthReasonWithSuppressions="",e.prototype.activationState="",e.prototype.modelItemsCountBucket="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/ScenarioStatsEvent"},e}());class r extends n{getMetrics(){return{"ScenarioStats.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:1},"ScenarioStatsWithSuppressions.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getSuppressionsDimensionValues(),value:1},"ScenarioStatsScenario.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getScenarioDimensionValues(),value:1},"ScenarioStatsScenarioWithSuppressions.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getScenarioSuppressionsDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="ScenarioStats",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucket,this.healthReason]}getSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.healthBucketWithSuppressions,this.healthReasonWithSuppressions]}getScenarioDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucket,this.scenarioHealthReason]}getScenarioSuppressionsDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.scenarioHealthBucketWithSuppressions,this.scenarioHealthReasonWithSuppressions]}}r.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","HealthBucket","HealthReason"]},48891:(e,t,o)=>{"use strict";o.d(t,{N:()=>a});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.count=0,e.prototype.successes=0,e.prototype.failures=0,e.prototype.maxDurationMs=0,e.prototype.sumDurationMs=0,e.prototype.cancellations=0,e.prototype.failureBuckets="",e.prototype.firstFailureReason="",e.prototype.firstFailureImpact="",e.prototype.firstEventSource="",e.prototype.firstEventReason="",e.prototype.firstEventReasonDependency="",e.prototype.firstEventImpact="",e.prototype.firstEventSuccess=!1,e.prototype.firstEventDurationMs=0,e.prototype.firstEventCount=0,e.prototype.firstEventMessage="",e.prototype.firstEventAffectedWorkflows="",e.prototype.lastEventSource="",e.prototype.lastEventReason="",e.prototype.lastEventReasonDependency="",e.prototype.lastEventImpact="",e.prototype.lastEventSuccess=!1,e.prototype.lastEventDurationMs=0,e.prototype.lastEventCount=0,e.prototype.lastEventMessage="",e.prototype.lastEventAffectedWorkflows="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEventAggregation"},e}()),r=o(71415);const s=(e,t)=>"reason"===e?r.l6[t]:"impact"===e?r.Pq[t]:t;class a extends n{constructor(e,t){super({sessionHealthEventName:e,count:t.count,successes:t.successes,failures:t.failures,cancellations:t.cancellations,maxDurationMs:t.maxDurationMs,sumDurationMs:t.sumDurationMs,failureBuckets:JSON.stringify(t.failureBuckets,s),firstFailureReason:t.failureBuckets.length>0?r.l6[t.failureBuckets[0].reason]:"",firstFailureImpact:t.failureBuckets.length>0?r.Pq[t.failureBuckets[0].impact]:""}),this.eventName="SessionHealthAggregation",t.firstEvent&&(this.firstEventAffectedWorkflows=t.firstEvent.affectedWorkflows,this.firstEventCount=t.firstEvent.count,this.firstEventDurationMs=t.firstEvent.durationMs,this.firstEventImpact=t.firstEvent.impact,this.firstEventMessage=t.firstEvent.message,this.firstEventReason=t.firstEvent.reason,this.firstEventReasonDependency=t.firstEvent.reasonDependency,this.firstEventSource=t.firstEvent.source,this.firstEventSuccess=t.firstEvent.success),t.lastEvent&&(this.lastEventAffectedWorkflows=t.lastEvent.affectedWorkflows,this.lastEventCount=t.lastEvent.count,this.lastEventDurationMs=t.lastEvent.durationMs,this.lastEventImpact=t.lastEvent.impact,this.lastEventMessage=t.lastEvent.message,this.lastEventReason=t.lastEvent.reason,this.lastEventReasonDependency=t.lastEvent.reasonDependency,this.lastEventSource=t.lastEvent.source,this.lastEventSuccess=t.lastEvent.success)}}},71415:(e,t,o)=>{"use strict";o.d(t,{vf:()=>c,Pq:()=>r,l6:()=>n,aM:()=>i});var i,n,r,s={util:{},roots:{default:{}}},a=(s.util,s.roots.default||(s.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}()),l=o(41966);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(r||(r={}));class c extends a{constructor(e,t){var o,s;super({source:i[e.source],reason:n[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:r[e.impact],success:e.success,durationMs:null!==(o=e.durationMs)&&void 0!==o?o:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(s=e.affectedWorkflows)&&void 0!==s?s:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=n[e],this}setSource(e){return this.source=i[e],this}setImpact(e){return this.impact=r[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}start(){return this.startTime=(0,l.t)(),this}stop(){const e=(0,l.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},97897:(e,t,o)=>{"use strict";o.d(t,{M:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientAppVersion="",e.prototype.clientRuntimeVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientUserAgent="",e.prototype.clientDeviceId="",e.prototype.healthBucket="",e.prototype.healthReason="",e.prototype.healthSubreason="",e.prototype.summarizedFindings="",e.prototype.affectedResource="",e.prototype.affectedSessions="",e.prototype.suppressionReason="",e.prototype.modelItemsCountBucket="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionIssueEvent"},e}());class r extends n{getMetrics(){return{"SessionIssue.CountV2":{dimensionNames:()=>r.dimensionNames,dimensionValues:this.getDimensionValues(),value:1}}}constructor(e,t){super(e),this.eventName="SessionIssue",t&&this.setClientMetadata(t)}setClientMetadata(e){e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientRuntimeVersion=e.runtimeVersion,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId)}getDimensionValues(){return[this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.modelItemsCountBucket,this.healthBucket,this.healthReason,this.healthSubreason,this.affectedResource,this.affectedSessions,this.suppressionReason]}}r.dimensionNames=["ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ModelItemsCountBucket","HealthBucket","HealthReason","HealthSubreason","AffectedResource","AffectedSessions","SuppressionReason"]},66375:(e,t,o)=>{"use strict";o.d(t,{M:()=>i});class i{constructor(e){null==e?this.reset():this.start=e}diffInMs(){const e=process.hrtime(this.start),t=1e3*e[0]+e[1]/1e6;return Math.floor(t)}diffInUs(){const e=process.hrtime(this.start),t=1e6*e[0]+e[1]/1e3;return Math.floor(t)}reset(){this.start=process.hrtime()}}},99105:(e,t,o)=>{"use strict";o.d(t,{j:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.TerminationReason="",e.prototype.cv="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.TotalRequestCount=0,e.prototype.LifetimeSec=0,e.prototype.ClientApp="",e.prototype.ClientAppPlatform="",e.prototype.ClientAppVersion="",e.prototype.ClientReleaseAudienceGroup="",e.prototype.ClientSessionId="",e.prototype.ClusterId="",e.prototype.ConnectionSequenceId=0,e.prototype.CorrelationId="",e.prototype.UsageType="",e.prototype.MaxActiveRequestsCount=0,e.prototype.unexpectedTerminationNotSeenInSessionHealth=!1,e.prototype.webSocketCloseCode=0,e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/WebSocketConnectionEndEvent"},e}());class r extends n{constructor(e,t){super(e),this.eventName="WebSocketConnectionEnd",t&&(this.ClientApp=null==t?void 0:t.appName,this.ClientAppPlatform=null==t?void 0:t.appPlatform,this.ClientAppVersion=null==t?void 0:t.appVersion,this.ClientReleaseAudienceGroup=null==t?void 0:t.releaseAudienceGroup,this.ClientSessionId=null==t?void 0:t.sessionId)}}},13912:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}());class r extends n{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}},76881:(e,t,o)=>{"use strict";o.d(t,{W:()=>i});class i{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<r;e++)s[e]=n[Math.floor(Math.random()*n.length)];return s.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let o;return o=e.endsWith(".0")?new i(e.substring(0,e.length-2)):new i(e),t&&(o.childCount=t),o}newChild(){return++this.childCount,new i(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const n=3023==o.j?["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"]:null,r=22,s=new Array(r)},37796:(e,t,o)=>{"use strict";o.d(t,{D:()=>r});const i=/\|\~/g;class n{constructor(){this.count=0,this.measureSums=new Map}}class r{constructor(e,t,o,r,s){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const o=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])o.push(null);else{let n="";"boolean"==typeof e[t]?n="b~":"number"==typeof e[t]&&(n="n~"),o.push(`${n}${e[t].toString().replace(i,"_")}`)}const r=o.join("|");let s=this.buckets.get(r);if(!s){s=new n,s.traceLevel=e.traceLevel;for(const e of this.avgMeasures)s.measureSums.set(e,0);this.buckets.set(r,s)}s.count++;for(const t of this.avgMeasures)e[t]&&s.measureSums.set(t,s.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const o={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},i=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],n=i[e];0===n.indexOf("b~")?o[t]="b~true"===n:0===n.indexOf("n~")?o[t]=parseInt(n.slice(2),10):o[t]=n}for(const t of this.avgMeasures)o[t]=Math.round(e.measureSums.get(t)/e.count);this.log(o,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=o,this.avgMeasures=r,s>0&&(this.interval=setInterval(this.flush,1e3*s))}}},41856:(e,t,o)=>{"use strict";o.d(t,{tG:()=>v,nh:()=>M,OD:()=>k});var i,n=o(2843);!function(e){e.Log="Log"}(i||(i={}));const r="undefined"!=typeof process&&process.env?process.env.SERVICE_NAME:"client",s="abcdefghijklmnopqrstuvwxyz0123456789",a={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let l,c=[],u=[],d=e=>null,h=e=>{};const g=new Map,p=new Map,f=new Map,m=new Map;var v;!function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{c=[],u=[],p.clear(),f.clear()},e.clearAggregators=()=>{g.clear()},e.addLogger=e=>{-1===c.indexOf(e)&&(c.push(e),b(p,e))},e.addDecidingLogger=e=>{-1===u.indexOf(e)&&(u.push(e),b(f,e))},e.setCorrelationContextCallback=e=>{l=e},e.setStartPerformanceEventCallback=e=>{d=e},e.setStopPerformanceEventCallback=e=>{h=e},e.addAggregator=e=>{e.init(((e,t)=>{I(e,t)})),g.has(e.eventName)?g.get(e.eventName).push(e):g.set(e.eventName,[e])},e.flushAggregators=e=>{g.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const o=R(e);m.set(o,t)},e.resetTagLevelOverrides=()=>{m.clear()},e.error=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.error,o,i,r,s,a,l,c,u)},e.warn=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.warn,o,i,r,s,a,l,c,u)},e.info=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.info,o,i,r,s,a,l,c,u)},e.verbose=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.verbose,o,i,r,s,a,l,c,u)},e.debug=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.debug,o,i,r,s,a,l,c,u)},e.metric=(e,t,o,i,r,s,a,l,c,u)=>{_(e,t,n.q.metric,o,i,r,s,a,l,c,u)},e.formatMetric=(e,t,o,i)=>{const n={};return n[e]={dimensionNames:o,dimensionValues:i,value:t},n},e.dynamic=e=>{I(e)}}(v||(v={}));const b=(e,t)=>{const o=t.level;Object.keys(n.q).map((e=>n.q[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=o)).forEach((o=>{e.has(o)?e.get(o).push(t):e.set(o,[t])}))},y=e=>{if("string"==typeof e)return e;let t="";for(let o=0;o<e.length;o++){o>0&&(t+=" ");const i=e[o];i instanceof Error?t+=JSON.stringify({message:i.message,name:i.name,stack:i.stack}):t+="object"==typeof i?JSON.stringify(i):i}return t},w=[],C=["Level","Tag"],S=["Level","Tag","Workflow"],k=e=>T(e).length,T=e=>void 0!==e?p.get(e)||w:c,x=(e,t)=>(void 0!==e?f.get(e)||[]:u).filter((e=>e.shouldLog(t))),_=(e,t,o,n,r,s,a,c,u,p,f)=>{o=m.get(e)||o;const v=T(o),b=x(o,n);if(0==v.length&&0==b.length)return;const w=d(i.Log),k=A(e),_=((e,t,o,i,n,r,s,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const l=[];for(const c of[e,t,o,i,n,r,s,a])void 0!==c&&l.push("function"==typeof c?c():c);return l})(n,r,s,a,c,u,p,f);if(E(t))B(_)&&I({eventName:"Metrics",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:"",getMetrics:()=>_},!1,v,b);else if(B(_)){const e=_;e.tagId=k,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",l&&(e.joinContextId=l().joinContextId,e.workflow=l().workflow)),e.traceLevel=o;const i=g.get(e.eventName);if(i)for(let t=0;t<i.length;++t){const o=i[t];if(o&&o.add(e,t===i.length-1))break}else I(e,!1,v,b)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>C,dimensionValues:[String(o),k],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>S,dimensionValues:[String(o),k,l?null===(e=l())||void 0===e?void 0:e.workflow:""],value:1}}};I({eventName:"Log",tagId:k,category:`${t.root}.${t.name}`,traceLevel:o,message:y(_),getMetrics:e},!1,v,b)}h(w)},I=(e,t=!1,o,i)=>{var n,s,a,c,u,d,h,g,p,f,m,v,b,y;let C;if(null==o&&(o=T(e.traceLevel)),i=i||w,o.length>0||i.length>0){if(e.serviceName=r,!t&&l){const t=l();t&&(C={disableLogging:t.disableLogging,userDataBoundaryType:null===(s=null===(n=t.sessionDescriptor)||void 0===n?void 0:n.userContext)||void 0===s?void 0:s.userDataBoundaryType},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.userTenantId=e.userTenantId?e.userTenantId:t.userTenantId,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(a=t.clientMetadata)||void 0===a?void 0:a.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(c=t.clientMetadata)||void 0===c?void 0:c.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(u=t.clientMetadata)||void 0===u?void 0:u.appVersion,e.clientDeviceId=e.clientDeviceId?e.clientDeviceId:null===(d=t.clientMetadata)||void 0===d?void 0:d.deviceId,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(h=t.clientMetadata)||void 0===h?void 0:h.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(g=t.clientMetadata)||void 0===g?void 0:g.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(p=t.clientMetadata)||void 0===p?void 0:p.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(f=t.clientMetadata)||void 0===f?void 0:f.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(m=t.clientMetadata)||void 0===m?void 0:m.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(v=t.clientMetadata)||void 0===v?void 0:v.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(b=t.clientMetadata)||void 0===b?void 0:b.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(y=t.clientMetadata)||void 0===y?void 0:y.isClientTelemetrySampled)}for(const t of o)t.log(e,C);for(const t of i)t.log(e)}},E=e=>e.name===M.WorkflowMetricsOnly.name&&e.root===M.WorkflowMetricsOnly.root,B=e=>!Array.isArray(e)&&"object"==typeof e,A=e=>s[e>>24&63]+s[e>>18&63]+s[e>>12&63]+s[e>>6&63]+s[63&e],R=e=>e&&5===e.length?a[e.charCodeAt(0)]<<24|a[e.charCodeAt(1)]<<18|a[e.charCodeAt(2)]<<12|a[e.charCodeAt(3)]<<6|a[e.charCodeAt(4)]:-1;class M{}M.CoreDefault=v.defineCoreLogCategory("Default"),M.CoreSystem=v.defineCoreLogCategory("System"),M.CoreUnsampled=v.defineCoreLogCategory("Unsampled"),M.WorkflowDefault=v.defineWorkflowLogCategory("Default"),M.WorkflowUnsampled=v.defineWorkflowLogCategory("Unsampled"),M.WorkflowMetricsOnly=v.defineWorkflowLogCategory("MetricsOnly"),M.PrivacyGuardEvent=v.defineCoreLogCategory("PrivacyGuardEvent")},70217:(e,t,o)=>{"use strict";o.d(t,{g:()=>n,t:()=>i});const i="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now(),n="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e6*e[0]+e[1]/1e3}:"undefined"!=typeof performance&&performance.now?()=>Math.round(1e3*performance.now()):()=>1e3*Date.now()},90456:(e,t,o)=>{"use strict";o.d(t,{I:()=>c});var i={util:{},roots:{default:{}}},n=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}()),r=o(70217);const s=Symbol("dataFieldsObject"),a=Symbol("dataFieldsAreDirty"),l=Symbol("_dataFields");class c extends n{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1),(null==e?void 0:e.dataFields)&&(this.dataFields=e.dataFields)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){this[s]||(this[s]={}),this[s][e]=t,this[a]=!0}setDataFields(e){this[s]||(this[s]={}),this[s]=Object.assign(Object.assign({},this[s]),e),this[a]=!0}start(){return this.startTime=(0,r.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,r.t)()-this.startTime)),this}stop(){const e=(0,r.t)();return this.durationMs=Math.round(e-this.startTime),this}getMetrics(e){var t,o;const i={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":i[this.operationName+".CountV2"]={dimensionNames:c.getOrphanedSessionHealthDimensionNames.bind(c),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":i[this.operationName+".Reason"]={dimensionNames:c.getSessionHealthDimensionNames.bind(c),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(i["Workflow.DurationMs"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},i["Workflow.Count"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const o=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(o)>=0)&&(i[o]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(o=this.options)||void 0===o?void 0:o.metricCount)||e.indexOf(t)>=0)&&(i[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return i}getDimensionNames(){var e,t;let o=c.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){o=o.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(e)}return o}getDimensionValues(){var e,t;const o=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)o.push(this.options.metricCustomDimensions[e]);return o}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}c.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],c.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"],Object.defineProperty(c.prototype,"dataFields",{get:function(){var e,t;return this[a]&&(this[l]=JSON.stringify(null!==(e=this[s])&&void 0!==e?e:{}),this[a]=!1),void 0!==this[a]?this[l]:null!==(t=this[l])&&void 0!==t?t:""},set:function(e){this[s]=e&&""!==e?JSON.parse(e):{},this[l]=e,this[a]=!1},enumerable:!0,configurable:!0})},48837:(e,t,o)=>{"use strict";o.d(t,{vf:()=>c,Pq:()=>r,l6:()=>n,aM:()=>i});var i,n,r,s={util:{},roots:{default:{}}},a=(s.util,s.roots.default||(s.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}()),l=o(70217);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(r||(r={}));class c extends a{constructor(e,t){var o,s;super({source:i[e.source],reason:n[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:r[e.impact],success:e.success,durationMs:null!==(o=e.durationMs)&&void 0!==o?o:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(s=e.affectedWorkflows)&&void 0!==s?s:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=n[e],this}setSource(e){return this.source=i[e],this}setImpact(e){return this.impact=r[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}start(){return this.startTime=(0,l.t)(),this}stop(){const e=(0,l.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},41450:(e,t,o)=>{"use strict";o.d(t,{a4:()=>u,gu:()=>c,si:()=>d,xs:()=>i});var i,n=o(31733);if(3023==o.j)var r=o(60859);if(3023==o.j)var s=o(90456);if(3023==o.j)var a=o(41856);if(3023==o.j)var l=o(28810);!function(e){e.JsClient="C",e.Server="S"}(i||(i={}));const c=new Set([n.Xr.getTypeName(),n.fZ.getTypeName(),n.g0.getTypeName(),n.xU.getTypeName()]);class u{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return(0,l.lO)(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=r.h.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new s.I({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but without a workflow source atribute"):e.contextId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupportedOperation(e){return c.has(e)}tryLogMessage(e,t,o=!0){e&&(e.success=o,e.resultDescription=t,a.tG.verbose(527308633,a.nh.CoreDefault,e.stop()))}}var d;!function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Running=3]="Running",e[e.Executed=4]="Executed"}(d||(d={}))},19231:(e,t,o)=>{"use strict";if(o.d(t,{MM:()=>u,a4:()=>h}),3023==o.j)var i=o(90456);if(3023==o.j)var n=o(41856);if(3023==o.j)var r=o(60859);var s=o(11168);if(3023==o.j)var a=o(23503);if(3023==o.j)var l=o(78449);const c=[s.WI.CursorUpdate,s.WI.FormattingUpdate,s.WI.OtherNonContentUpdate,s.WI.AttributionUpdate];function u(e,t,o){const c=new i.I({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return c.success=!1,c.resultDescription="Unable to apply text tile delta, parent tile is undefined",void n.tG.info(538798173,n.nh.CoreDefault,c.stop());if(r.h.getTypeNameFor(t)!==a.qf.getTypeName())return c.success=!1,c.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${l.Q.getTypeName()}, received ${r.h.getTypeNameFor(t)}`,void n.tG.info(538798174,n.nh.CoreDefault,c.stop());const o=e,i=t.content;let u="";if(void 0===o.position||o.position<0)return c.success=!1,c.resultDescription="Unable to apply text tile delta, invalid text tile position",void n.tG.info(538798175,n.nh.CoreDefault,c.stop());switch(o.deltaType){case s.WI.Add:u=o.position<i.length?`${i.slice(0,o.position)}${o.content}${i.slice(o.position,i.length)}`:i+o.content;break;case s.WI.Update:o.content||o.unit!==s.OD.Sentence||(c.dimension0="1"),u=`${i.slice(0,o.position)}${o.content}${i.slice(o.position+(o.length||0),i.length)}`;break;case s.WI.Delete:u=`${i.slice(0,o.position)}${i.slice(o.position+(o.length||0),i.length)}`}return n.tG.info(538837071,n.nh.CoreDefault,c.stop()),new a.qf({content:u})}catch(e){return c.success=!1,c.resultDescription=`Error applying text tile delta: ${e}`,void n.tG.info(538798176,n.nh.CoreDefault,c.stop())}}function d(e,t){var o,i,n,r,a;const l=(null===(o=t.attributionData)||void 0===o?void 0:o.ranges)||t.attributionRanges;if((null===(i=t.attributionData)||void 0===i?void 0:i.isFullUpdate)||t.deltaType!==s.WI.AttributionUpdate&&void 0!==l)return l;if(!(null===(n=e.attributionRanges)||void 0===n?void 0:n.length)&&!l||t.deltaType===s.WI.Update&&0===t.length)return e.attributionRanges;let c=e.attributionRanges?[...e.attributionRanges]:[];if(t.deltaType!==s.WI.AttributionUpdate){const o=g(e.attributionRanges,t.deltaType,t.position),i=o?c.indexOf(o):-1;-1!==i&&(o.length=t.position-o.start);const n=(null!==(r=t.content)&&void 0!==r?r:"").length,s=null!==(a=t.length)&&void 0!==a?a:0,l=t.position+s,u=t.position+n;for(const e of c.slice(i+1)){if(e.start<t.position)continue;const o=e.start+e.length;l>e.start&&(e.length=o-l),e.start=Math.max(e.start+n-s,u)}return c=c.filter((e=>e.length>0)),c}const u=[];for(const e of l)0!==u.length&&u[u.length-1].start+u[u.length-1].length>=e.start?u[u.length-1].length=e.start+e.length-u[u.length-1].start:u.push({start:e.start,length:e.length});c=c.filter((e=>e.length>0&&!(e=>{for(const t of u)if(t.start<=e.start&&t.start+t.length>=e.start+e.length)return!0;return!1})(e))),null==l||l.forEach((e=>{c.push(e)})),c.sort(((e,t)=>e.start-t.start));const d=[];for(const e of c){const t=d.length>0?d[d.length-1]:void 0;t&&t.start+t.length>e.start&&(t.length=Math.max(e.start-t.start,0)),!t||(p=e,(h=t).attribution.userId!==p.attribution.userId||h.attribution.timestamp!==p.attribution.timestamp||h.attribution.dataSource!==p.attribution.dataSource)||e.start>t.start+t.length?d.push(e):t.length+=Math.max(e.start+e.length-(t.start+t.length),0)}var h,p;return d}function h(e,t,o){var l,c,u,h;const m=new i.I({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();m.clientFlights=o;try{if(!t)return m.success=!1,m.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void n.tG.info(538798177,n.nh.CoreDefault,m.stop());if(r.h.getTypeNameFor(t)!==a.Cg.getTypeName())return m.success=!1,m.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${a.Cg.getTypeName()}, received ${r.h.getTypeNameFor(t)}`,void n.tG.info(538798178,n.nh.CoreDefault,m.stop());const o=t,v=e,b=o.content;let y="";if((void 0===v.position||v.position<0)&&!f(v.deltaType))return m.success=!1,m.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void n.tG.info(538798179,n.nh.CoreDefault,m.stop());if(void 0===v.content&&!f(v.deltaType))return m.success=!1,m.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void n.tG.info(538798208,n.nh.CoreDefault,m.stop());if(v.deltaType===s.WI.Add&&0!==v.length?n.tG.info(538798209,n.nh.CoreDefault,new i.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):f(v.deltaType)&&void 0!==v.content&&n.tG.info(538798210,n.nh.CoreDefault,new i.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!p(v.deltaType)){const e=function(e,t){var o,i,n,r;const s=g(e.formattedRanges,t.deltaType,t.position);let a=e.formattedRanges?[...e.formattedRanges]:[];const l=s?a.indexOf(s):-1;-1!==l&&(t.position+(t.length||0)>s.start+s.length?s.length=t.position+(null!==(o=t.content)&&void 0!==o?o:"").length-s.start:s.length+=(null!==(i=t.content)&&void 0!==i?i:"").length-(t.length||0),a[l]=s);for(const e of a.slice(l+1))e.start<t.position||(t.position+(t.length||0)>e.start?(e.length=e.start+e.length-(t.position+(t.length||0)),e.start=t.position+(null!==(n=t.content)&&void 0!==n?n:"").length):e.start+=(null!==(r=t.content)&&void 0!==r?r:"").length-(t.length||0));return a=a.filter((e=>e.length>0)),a}(o,v),t=d(o,v);let i=o.ipPosition;switch(v.deltaType){case s.WI.Add:y=v.position<b.length?`${b.slice(0,v.position)}${v.content}${b.slice(v.position,b.length)}`:b+v.content,i=v.position+v.length;break;case s.WI.Update:v.content||v.unit!==s.OD.Sentence||(m.dimension0="1"),y=`${b.slice(0,v.position)}${v.content}${b.slice(v.position+(null!==(l=v.length)&&void 0!==l?l:0),b.length)}`,i=v.position+v.content.length;break;case s.WI.Delete:y=`${b.slice(0,v.position)}${b.slice(v.position+(null!==(c=v.length)&&void 0!==c?c:0),b.length)}`,i=v.position}const r=new a.Cg(Object.assign(Object.assign({},o),{ipPosition:i,content:y,formattedRanges:e,attributionRanges:t,queryRange:v.queryRange}));return n.tG.info(538837073,n.nh.CoreDefault,m.stop()),r}if(v.deltaType===s.WI.CursorUpdate)return new a.Cg(Object.assign(Object.assign({},o),{ipPosition:null===(u=v.cursorData)||void 0===u?void 0:u.ipPosition,isColdIp:null===(h=v.cursorData)||void 0===h?void 0:h.isColdIp}));if(v.deltaType===s.WI.FormattingUpdate)return new a.Cg(Object.assign(Object.assign({},o),{formattedRanges:v.formattedRanges}));if(v.deltaType===s.WI.OtherNonContentUpdate){let e;const t={};for(e in v.otherNonContentData)t[e]=v.otherNonContentData[e];return new a.Cg(Object.assign(Object.assign({},o),t))}return v.deltaType===s.WI.AttributionUpdate?new a.Cg(Object.assign(Object.assign({},o),{attributionRanges:d(o,v)})):void 0}catch(e){return m.success=!1,m.resultDescription=`Error applying formatted text tile delta: ${e}`,void n.tG.info(538798211,n.nh.CoreDefault,m.stop())}}function g(e,t,o){const r=new i.I({operationName:"FindRangeForDelta",success:!0});if(r.start(),!e)return r.resultDescription="No formatted ranges found within the tile, skipping.",void n.tG.info(538798212,n.nh.CoreDefault,r.stop());if(t===s.WI.Add){const t=e.find((e=>e.start===o&&0===e.length));if(t)return r.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,n.tG.info(538798213,n.nh.CoreDefault,r.stop()),t;o=Math.max(o-1,0)}const a=e.find((e=>0===e.length?e.start===o:e.start<=o&&o<e.start+e.length));return a?(r.resultDescription=`Updating formatted range for operation with start: ${a.start} and length: ${a.length}`,n.tG.info(538798214,n.nh.CoreDefault,r.stop())):(r.resultDescription=`Unable to find formatted range for operation at position ${o}, skipping.`,n.tG.info(538798215,n.nh.CoreDefault,r.stop())),a}function p(e){return-1!==c.indexOf(e)}function f(e){return p(e)||s.WI.Delete===e}},28810:(e,t,o)=>{"use strict";o.d(t,{_$:()=>n,lO:()=>r,oF:()=>i});const i=(e,t,o)=>{let i=e.get(t);return i||(i=o(),e.set(t,i)),i},n=e=>({id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}),r=(e,t)=>null!=e&&null!=t&&e.length>0&&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length))},1895:(e,t,o)=>{"use strict";if(o.d(t,{Q$:()=>a,aZ:()=>s}),3023==o.j)var i=o(65920);if(3023==o.j)var n=o(90456);if(3023==o.j)var r=o(41856);var s;!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(s||(s={}));class a{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var o;const i=this.getLocation(t);return null===(o=this.graphNodeByLocationAndWorkflowId.get(i))||void 0===o?void 0:o.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const o=new n.I({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void r.tG.error(524300630,r.nh.CoreDefault,o.stop())}const o=this.getLocation(t),i=new l(e,o);this.addWorkflowAsDependency(i);let s=this.graphNodeByLocationAndWorkflowId.get(o);s||(s=new Map,this.graphNodeByLocationAndWorkflowId.set(o,s)),s.set(e.id,i)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const o of t.values()||[]){const t=this.createWorkflowDefinition(o.workflow);o.workflow.visibility===i.Y$.LocalOnly?this.compressDownstreamWorkflows(t,o):t.outputTypes.push(...o.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),o=this.graphNodeByLocationAndWorkflowId.get(t),i=Array.from((null==o?void 0:o.values())||[]);for(const e of i){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);o.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const o of t.values()||[])e.push(o.workflow);return e}getWorkflowNodes(e){const t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const o of e.values())t.push(o);return t}getLocation(e){return e?s.External:s.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const o of t.downstreamWorkflows)if(o.workflow.visibility!==i.Y$.LocalOnly){if(o.workflow.kind!==i.wC.Join||-1!==e.inputTypes.indexOf(o.workflow.collectionScopeType))for(const t of o.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,o)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const o of t.values()){for(const t of o.workflow.inputTypes)-1!==e.workflow.outputTypes.indexOf(t)&&this.addWorkflowChain(e,o);for(const t of o.workflow.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(o,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class l{constructor(e,t){this.isActivated=!0,this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Object.assign(Object.assign({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}}},52176:(e,t,o)=>{"use strict";o.d(t,{$:()=>T});var i=o(34574),n=o(62788);const r=(e,t)=>t.some((t=>e instanceof t));let s,a;const l=new WeakMap,c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap;let g={get(e,t,o){if(e instanceof IDBTransaction){if("done"===t)return c.get(e);if("objectStoreNames"===t)return e.objectStoreNames||u.get(e);if("store"===t)return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return f(e[t])},set:(e,t,o)=>(e[t]=o,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function p(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(m(this),e),f(l.get(this))}:function(...e){return f(t.apply(m(this),e))}:function(e,...o){const i=t.call(m(this),e,...o);return u.set(i,e.sort?e.sort():[e]),f(i)}:(e instanceof IDBTransaction&&function(e){if(c.has(e))return;const t=new Promise(((t,o)=>{const i=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",r),e.removeEventListener("abort",r)},n=()=>{t(),i()},r=()=>{o(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",n),e.addEventListener("error",r),e.addEventListener("abort",r)}));c.set(e,t)}(e),r(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,g):e);var t}function f(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,o)=>{const i=()=>{e.removeEventListener("success",n),e.removeEventListener("error",r)},n=()=>{t(f(e.result)),i()},r=()=>{o(e.error),i()};e.addEventListener("success",n),e.addEventListener("error",r)}));return t.then((t=>{t instanceof IDBCursor&&l.set(t,e)})).catch((()=>{})),h.set(t,e),t}(e);if(d.has(e))return d.get(e);const t=p(e);return t!==e&&(d.set(e,t),h.set(t,e)),t}const m=e=>h.get(e),v=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],y=new Map;function w(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(y.get(t))return y.get(t);const o=t.replace(/FromIndex$/,""),i=t!==o,n=b.includes(o);if(!(o in(i?IDBIndex:IDBObjectStore).prototype)||!n&&!v.includes(o))return;const r=async function(e,...t){const r=this.transaction(e,n?"readwrite":"readonly");let s=r.store;return i&&(s=s.index(t.shift())),(await Promise.all([s[o](...t),n&&r.done]))[0]};return y.set(t,r),r}var C;C=g,g={...C,get:(e,t,o)=>w(e,t)||C.get(e,t,o),has:(e,t)=>!!w(e,t)||C.has(e,t)};var S,k=o(87783);!function(e){e.URL="URL",e.ArrayBuffer="ArrayBuffer"}(S||(S={}));class T{constructor(e,t,o,r){this.dbName="ALModels_db",this.osName="ALModels_os",this.dbVersion=2,this.modelPathsCache=new Map,this.isPolymerSupported=Boolean(o),this.baseURL=`https://${t}/web/${e}`,this.polymerBaseURL=this.isPolymerSupported?`https://${o}`:"",this.fetchResource=null!=r?r:"undefined"!=typeof fetch?fetch:k.fetch;const s=new i.I({operationName:"CreateModelDownloader",success:!0,resultDescription:""});s.start(),this.isBrowserIdbCompatible().then((e=>{if(e){let e,t=0,o=0,i=0;const n=new Promise(((t,o)=>{e=setTimeout((()=>{o(new Error("Took longer than 10000 ms"))}),1e4)})),r=this.accessDB().then((e=>{const n=e.transaction(this.osName,"readwrite");return n.objectStore(this.osName).openCursor().then((function e(r){if(i++,r){const i=r.value;let n;return i.timesSinceUsage||(i.timesSinceUsage=0),i.timesSinceUsage++,i.timesSinceUsage>5?(o++,n=r.delete()):(t++,n=r.update(i)),n.then((()=>r.continue())).then(e)}return n.done}))}));this.initPromise=Promise.race([n,r]).catch((e=>{s.success=!1,s.resultDescription+=`${e.message} `})).then((()=>{s.dimension0=`${i}`,s.dimension1=`${t}`,s.dimension2=`${o}`,clearTimeout(e),this.closeDBAndEndLog(s,"initializing idb storage")}))}else s.resultDescription="Incompatible browser for IDB",n.tG.info(538706242,n.nh.CoreDefault,s.stop())})).catch((()=>{s.resultDescription="Issue determining idb compatibility",n.tG.info(536966936,n.nh.CoreDefault,s.stop())}))}getResourceAsArrayBuffer(e,t,o){const n=new i.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:S.ArrayBuffer,dimension1:e,dimension2:t});n.start();const r={};return this.getResource(e,t,o,S.ArrayBuffer,n,(e=>Promise.all(Array.from(e.keys()).map((t=>{const o=e.get(t);return o.arrayBuffer?o.arrayBuffer().then((e=>{r[t]=e})):new Promise(((e,i)=>{const n=new FileReader;n.readAsArrayBuffer(o),n.onload=o=>{const n=o.target.result;n instanceof ArrayBuffer?(r[t]=n,e()):i(new Error("Unable to obtain ArrayBuffer"))}}))}))))).then((()=>r))}getKey(e,t,o){return o?`${e}_${t}_${JSON.stringify(Array.from(o.entries()))}`:`${e}_${t}`}updateCache(e,t,o,i){this.modelPathsCache.set(this.getKey(e,t,o),i)}getCache(e,t,o){return this.modelPathsCache.get(this.getKey(e,t,o))}getResourceAsURL(e,t,o){const n=new i.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:S.URL,dimension1:e,dimension2:t});n.start();const r={},s=this.getCache(e,t,o);return s?Promise.resolve(s):this.getResource(e,t,o,S.URL,n,(e=>Promise.all(Array.from(e.keys()).map((t=>{r[t]=URL.createObjectURL(e.get(t))}))))).then((()=>this.getCache(e,t,o)||(this.updateCache(e,t,o,r),r)))}getResource(e,t,o,i,n,r){return this.getFiles(e,t,o,n).then((e=>r(e))).then((()=>{this.closeDBAndEndLog(n,`retrieving ${e}`)})).catch((t=>{throw n.resultDescription.indexOf(t.message)>=0&&(n.success=!1,n.resultDescription+=`${t.message} `),n.resultSignature=`Issue retrieving from CDN or translating to ${i}`,this.closeDBAndEndLog(n,`retrieving ${e}`),t}))}checkFirefoxCompatibility(e){const t=globalThis.navigator.userAgent.substring(e+8,e+11);return t.replace(".",""),parseInt(t,10)<=70?new Promise((function(e,t){const o=globalThis.indexedDB.open(this.dbName,this.dbVersion);o.onsuccess=function(){e(!0)},o.onerror=function(e){return t(e),!0}})):Promise.resolve(!0)}isBrowserIdbCompatible(){var e,t;return"undefined"==typeof Array||void 0===Array.from||"undefined"==typeof Proxy||"undefined"==typeof URL||void 0===URL.createObjectURL?Promise.resolve(!1):"undefined"!=typeof globalThis&&(null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent)?globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")>-1?globalThis.indexedDB?this.checkFirefoxCompatibility(globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")):Promise.resolve(!1):globalThis.navigator.userAgent.toLowerCase().indexOf("safari")>-1&&globalThis.navigator.userAgent.toLowerCase().indexOf("chrome")<=-1?(null===(t=globalThis.document)||void 0===t?void 0:t.hasStorageAccess)?globalThis.document.hasStorageAccess().then((()=>!0)).catch((()=>!1)):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)}accessDB(){return this.accessDBPromise?this.accessDBPromise.then((e=>e.transaction(this.osName).done)).then((()=>this.accessDBPromise)).catch((()=>this.callOpenDB())):this.callOpenDB()}callOpenDB(){return this.accessDBPromise=function(e,t,{blocked:o,upgrade:i,blocking:n,terminated:r}={}){const s=indexedDB.open(e,t),a=f(s);return i&&s.addEventListener("upgradeneeded",(e=>{i(f(s.result),e.oldVersion,e.newVersion,f(s.transaction))})),o&&s.addEventListener("blocked",(()=>o())),a.then((e=>{r&&e.addEventListener("close",(()=>r())),n&&e.addEventListener("versionchange",(()=>n()))})).catch((()=>{})),a}(this.dbName,this.dbVersion,{upgrade:e=>{e.objectStoreNames.contains(this.osName)&&e.deleteObjectStore(this.osName),e.createObjectStore(this.osName,{keyPath:"id",autoIncrement:!0})}})}endLog(e,t){e.success?(e.resultDescription=`Success ${t}`,n.tG.info(573329487,n.nh.CoreDefault,e.stop())):(e.resultDescription+=`error ${t}`,n.tG.error(573329488,n.nh.CoreDefault,e.stop()))}closeDBAndEndLog(e,t){this.accessDBPromise?this.accessDBPromise.then((e=>{e.close()})).catch((t=>{e.resultDescription.indexOf(t.message)>=0&&(e.success=!1,e.resultDescription+=`${t.message?t.message:"Error closing db"} `,e.resultSignature="Issue closing db")})).then((()=>{this.accessDBPromise=void 0,this.endLog(e,t)})):this.endLog(e,t)}getFiles(e,t,o,i){return this.isBrowserIdbCompatible().catch((e=>(i.success=!1,i.resultDescription+=`${e.message} `,i.resultSignature="Issue determining idb compatibility",!1))).then((n=>{const r=()=>{if(o){if(this.isPolymerSupported)return this.downloadFiles1CDN(e,t,o,i,n);throw new Error("Missing polymerBaseURL provided at host level for queries with modelFilters")}return this.downloadFiles(e,t,i,n)};return n?this.getFilesFromIDB(e,t,o,i).catch((e=>(e&&(i.resultDescription.indexOf(e.message)>=0&&(i.success=!1,i.resultDescription+=`${e.message} `),i.resultSignature="Issue retrieving from DB"),r()))):r()}))}getFilesFromIDB(e,t,o,i){return this.initPromise.catch((e=>{i.success=!1,i.resultDescription+=`${e.message} `,i.resultSignature="Issue initializing"})).then((()=>this.getModelOptions(e))).then((n=>{for(const r of n)if(r&&r.model&&r.version==t){if(!this.checkModelFiltersPass(o,r.filters))continue;return this.putModel(e,r.model,t,r.filters,i,r.id),Promise.resolve(r.model)}return Promise.reject()}))}checkModelFiltersPass(e,t){var o;for(const i of e){const e=null===(o=t.get(i[0]))||void 0===o?void 0:o.map((e=>e.toLocaleLowerCase()));if(!e)throw new Error(`Expected filter ${i[0]} to exist in metadata file`);if(e.indexOf(i[1].toLocaleLowerCase())<0)return!1}return!0}downloadFiles1CDN(e,t,o,i,n){let r;return i.dimension3="Polymer",o||(o=new Map),this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/metadata.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((n=>{var s,a;const l=JSON.parse(n);if(l.name!==e||l.version!==t)throw new Error(`Expected: ${e} version ${t}, received: ${l.name} version ${l.version}`);for(const e of l.variants)if(r=new Map(Object.entries(e)),this.checkModelFiltersPass(o,r))return(l.catalog?o.size+2:o.size+1!==r.size)&&(i.success=!1,i.resultDescription+=`Expected ${null===(s=r.keys)||void 0===s?void 0:s.length} # of filters, received ${null===(a=o.keys)||void 0===a?void 0:a.length}`),e.model_files;throw new Error("No model found with given filters")})).then((o=>Promise.all(o.map((o=>this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/${o}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((e=>[o,e]))))))).then((o=>{const s=new Map(o);return n?this.putModel(e,s,t,r,i):s}))}downloadFiles(e,t,o,i){return o.dimension3="FS",this.fetchResource(`${this.baseURL}/catalog_${e}_${t}.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((o=>{const i=JSON.parse(o),n=`${i.MajorVersion}.${i.MinorVersion}/ModelResources`,r=`${e}/${t}/`;return Promise.all(i.Resources.map((e=>(e.Name.length>r.length&&e.Name.substring(0,r.length)===r&&(e.Name=e.Name.substring(r.length)),this.fetchResource(`${this.baseURL}/${n}/${r}${e.Name}.${e.Type}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((t=>[`${e.Name}.${e.Type}`,t]))))))})).then((n=>{const r=new Map(n);return i?this.putModel(e,r,t,new Map,o):r}))}getModelOptions(e){return this.accessDB().then((t=>{const o=[],i=t.transaction(this.osName,"readonly");return i.objectStore(this.osName).openCursor().then((function t(n){if(n){const i=n.value;return i.modelId==e&&o.push(i),n.continue().then(t)}return i.done})).then((()=>o))}))}putModel(e,t,o,i,n,r){return i||(i=new Map),this.accessDB().then((n=>n.put(this.osName,{modelId:e,model:t,version:o,filters:i,timesSinceUsage:0},r))).catch((e=>{n.resultDescription.indexOf(e.message)>=0&&(n.success=!1,n.resultDescription+=`${e.message} `),n.resultSignature="Issue adding to DB"})).then((()=>t))}}},78992:(e,t,o)=>{"use strict";if(o.d(t,{_:()=>r}),3023==o.j)var i=o(33998);if(3023==o.j)var n=o(98202);class r{static createFactory(e=".",t,o,n){return s=>{var a;const l=o||i.e3;return!r.onnxRetrievalPromise||s?e?((null===(a=l())||void 0===a?void 0:a.ai_outlook)&&!s?Promise.resolve():(0,i.el)(`${e}/ai_outlook.min.js`,l,"ai_outlook",t,n)).then((()=>{r.onnxRetrievalPromise=Promise.resolve(new r(l))})).catch((e=>{r.onnxRetrievalPromise=Promise.reject(e)})).then((()=>r.onnxRetrievalPromise)):Promise.reject(new Error("Error: folderPath not provided")):r.onnxRetrievalPromise}}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var o;const i=null===(o=this.getCache())||void 0===o?void 0:o.ai_outlook;return i?(i.env.wasm.simd=!0,i.env.wasm.numThreads=0,n.Kx.create(e,t||"",i)):Promise.reject(new Error("Error: aiOutlook is undefined"))}createInputs(){return n.G0.create()}}},98202:(e,t,o)=>{"use strict";if(o.d(t,{G0:()=>c,Kx:()=>l,fE:()=>a}),3023==o.j)var i=o(81206);if(3023==o.j)var n=o(62788);if(3023==o.j)var r=o(34574);var s=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function a(e){let t="";if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0?t="Error: IE lacks necessary support":"undefined"==typeof Promise?t="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(t="Error: WASM is not supported")}else t="Error: No window userAgent";return""!=t&&(e.resultDescription=t,n.tG.info(540406806,n.nh.CoreDefault,e.stop()),!0)}class l{constructor(e,t,o){this.session=e,this.onnxObject=o,this.modelName=t}static create(e,t,o){return s(this,void 0,void 0,(function*(){const i=new r.I({operationName:"CreateModelForInferencing",success:!0,resourceId:t});return i.start(),o[e]?(i.resultDescription="Model already existed",n.tG.info(509699716,n.nh.CoreDefault,i.stop()),o[e]):o[e]=this.getInferenceSession(o).create(e).then((e=>(n.tG.info(540406807,n.nh.CoreDefault,i.stop()),new l(e,t,o)))).catch((e=>{throw i.resultDescription=`Error: ${e}`,n.tG.info(540406808,n.nh.CoreDefault,i.stop()),e}))}))}static getInferenceSession(e){if(null==e?void 0:e.InferenceSession)return e.InferenceSession;throw new Error("InferenceSession is not defined")}run(e){var t;return s(this,void 0,void 0,(function*(){const o=new r.I({operationName:"RunModelForInferencing",success:!0,resourceId:this.modelName});if(o.start(),null===(t=this.onnxObject)||void 0===t?void 0:t.Tensor){const t=e.getInputs(),i={};return Object.keys(t).forEach((e=>{const o=t[e];if(Array.isArray(o.values)&&o.values.length>0&&"boolean"==typeof o.values[0]){const t=new Uint8Array(o.values);i[e]=new this.onnxObject.Tensor(t,o.dimensions)}else i[e]=new this.onnxObject.Tensor(o.values,o.dimensions)})),this.session.run(i).then((e=>(n.tG.info(540406809,n.nh.CoreDefault,o.stop()),new u(e)))).catch((e=>{o.resultDescription=`Problem running model. ${e.message}`,n.tG.info(540406810,n.nh.CoreDefault,o.stop())}))}throw o.resultDescription="Unable to run model. Tensor not defined",n.tG.info(540406811,n.nh.CoreDefault,o.stop()),new Error("Tensor is not defined")}))}}class c{constructor(){this.map={}}static create(){return new c}getInputs(){return this.map}add(e,t,o){return this.map[e]={dimensions:t,values:o},this}}class u{constructor(e){for(const t of Object.keys(e))this[t]=new d(t,e[t])}}class d{constructor(e,t){this.resultName=e,this.result=t}name(){return this.resultName}outputType(){switch(this.result.type){case"string":return i.Z.Strings;case"int8":return i.Z.Int8s;case"int16":return i.Z.Int16s;case"int32":return i.Z.Int32s;case"bool":return i.Z.Booleans;case"uint8":return i.Z.UnsignedInt8s;case"uint16":return i.Z.UnsignedInt16s;case"uint32":return i.Z.UnsignedInt32s;case"float32":return i.Z.Float32s;case"float64":return i.Z.Float64s;default:throw new Error(`The output type ${this.result.type} is not supported.`)}}dimensions(){return this.result.dims}asBooleans(){if(this.outputType()===i.Z.Booleans)return this.result.data.map((e=>!!e));throw new Error(`asBooleans() was called; however, outputType() is ${this.outputType()}, not Type.Booleans.`)}asFloat32s(){if(this.outputType()===i.Z.Float32s)return this.result.data;throw new Error(`asFloat32s() was called; however, outputType() is ${this.outputType()}, not Type.Float32s.`)}asFloat64s(){if(this.outputType()===i.Z.Float64s)return this.result.data;throw new Error(`asFloat64s() was called; however, outputType() is ${this.outputType()}, not Type.Float64s.`)}asInt8s(){if(this.outputType()===i.Z.Int8s)return this.result.data;throw new Error(`asInt8s() was called; however, outputType() is ${this.outputType()}, not Type.Int8s.`)}asInt16s(){if(this.outputType()===i.Z.Int16s)return this.result.data;throw new Error(`asInt16s() was called; however, outputType() is ${this.outputType()}, not Type.Int16s.`)}asInt32s(){if(this.outputType()===i.Z.Int32s)return this.result.data;throw new Error(`asInt32s() was called; however, outputType() is ${this.outputType()}, not Type.Int32s.`)}asStrings(){if(this.outputType()===i.Z.Strings)return this.result.data;throw new Error(`asStrings() was called; however, outputType() is ${this.outputType()}, not Type.Strings.`)}asUnsignedInt8s(){if(this.outputType()===i.Z.UnsignedInt8s)return this.result.data;throw new Error(`asUnsignedInt8s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt8s.`)}asUnsignedInt16s(){if(this.outputType()===i.Z.UnsignedInt16s)return this.result.data;throw new Error(`asUnsignedInt16s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt16s.`)}asUnsignedInt32s(){if(this.outputType()===i.Z.UnsignedInt32s)return this.result.data;throw new Error(`asUnsignedInt32s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt32s.`)}}},33998:(e,t,o)=>{"use strict";if(o.d(t,{e3:()=>s,el:()=>l}),3023==o.j)var i=o(34574);if(3023==o.j)var n=o(62788);if(3023==o.j)var r=o(98202);function s(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function a(e,t){e.src=t}function l(e,t,o,s,l){const u=new i.I({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});if(u.start(),(0,r.fE)(u)){const e="Browser lacks necessary support for inference service";return u.success=!1,u.resultDescription=e,n.tG.info(540406803,n.nh.CoreDefault,u.stop()),Promise.reject(new Error(e))}return new Promise(((i,n)=>{if("undefined"!=typeof document){const r=document.createElement("script");(l||a)(r,e),r.onload=()=>{c(t,o)?(s&&(t()[o].env.wasm.wasmPaths=s),i()):(r.remove(),n(new Error("ort.Tensor and/or ort.InferenceSession are undefined")))},r.onerror=n,document.body.appendChild(r)}else globalThis.importScripts?(globalThis.importScripts(e),globalThis[o]=self[o],c(t,o)?(s&&(t()[o].env.wasm.wasmPaths=s),i()):n(new Error("ort.Tensor and/or ort.InferenceSession are undefined"))):n(new Error("Unexpected lack of document and importScripts"))})).then((()=>{n.tG.info(540406804,n.nh.CoreDefault,u.stop())})).catch((e=>{throw u.success=!1,u.resultDescription=e.message,n.tG.info(509871835,n.nh.CoreDefault,u.stop()),e}))}function c(e,t){const o=globalThis[t];if(o&&o.InferenceSession&&o.Tensor){const i=e();return i&&!i[t]&&(i[t]=o),!0}return!1}},7140:(e,t,o)=>{"use strict";var i;o.d(t,{MY:()=>h}),o(62788),function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(i||(i={}));var n=o(41567);class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){n.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return n.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){n.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return n.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){n.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){n.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return n.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()},o(26394);const d=[n.h.getTypeName(),r.getTypeName(),l.getTypeName()],h=e=>{const t=new Set;for(const o of e)if("string"==typeof o)-1===d.indexOf(o)&&t.add(o);else for(const e of[o.getTypeName(),...o.getBaseTypes()])-1===d.indexOf(e)&&t.add(e);return Array.from(t)}},7464:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>r}),3023==o.j)var i=o(98894);if(3023==o.j)var n=o(7140);class r{constructor(e,t){var o,n,r,s,a;this.kind=i.wC.Join,this.isStateful=!1,this.maxDelayMs=1e3,this.maxAnnotations=1,this.allowDefinitionOverride=!1,this.id=e,t&&(this.inputTypes=null!==(o=t.inputTypes)&&void 0!==o?o:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(r=t.isStateful)&&void 0!==r?r:this.isStateful,this.maxDelayMs=null!==(s=t.maxDelayMs)&&void 0!==s?s:this.maxDelayMs,this.requestedContextTypesRules=null!==(a=t.requestedContextTypesRules)&&void 0!==a?a:this.requestedContextTypesRules)}static create(e){return new r(e)}setCollectionScopeType(e){return this.collectionScopeType=e,this}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setMaxDelayTime(e){return this.maxDelayMs=e?Math.max(0,e):void 0,this}setMaxAnnotations(e){return this.maxAnnotations=e,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setAllowDefinitionOverride(){return this.allowDefinitionOverride=!0,this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},46402:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>r}),3023==o.j)var i=o(98894);if(3023==o.j)var n=o(7140);class r{constructor(e,t){var o,n,r,s,a,l;this.kind=i.wC.SingleItem,this.isStateful=!1,this.id=e,t&&(this.inputTypes=null!==(o=t.inputTypes)&&void 0!==o?o:this.inputTypes,this.outputTypes=null!==(n=t.outputTypes)&&void 0!==n?n:this.outputTypes,this.isStateful=null!==(r=t.isStateful)&&void 0!==r?r:this.isStateful,this.requestedContextTypesRules=null!==(s=t.requestedContextTypesRules)&&void 0!==s?s:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(a=t.definitionOverrideTargetWorkflows)&&void 0!==a?a:this.definitionOverrideTargetWorkflows,this.correlatedSignals=0!==(null===(l=t.correlatedSignals)||void 0===l?void 0:l.length)?t.correlatedSignals:this.correlatedSignals)}static create(e){return new r(e)}setInputTypes(e){return this.inputTypes=(0,n.MY)(e),this}setOutputTypes(e){return this.outputTypes=(0,n.MY)(e),this}setStateful(){return this.isStateful=!0,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setDefinitionOverrideTargetWorkflows(e){return this.definitionOverrideTargetWorkflows=e,this}setCorrelatedSignals(e){return 0!==e.length&&(this.correlatedSignals=e),this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}},95732:(e,t,o)=>{"use strict";if(o.d(t,{Z:()=>n}),3023==o.j)var i=o(28979);class n{constructor(e){this.annotationSequencer=null!=e?e:new i.N}process(e,t,o,i){const n=[];for(const i of e.ops){const r=[];if(null==i?void 0:i.items)for(const e of i.items){const o=this.annotationSequencer.sequence(e.body).then((()=>{t(i,e)}));r.push(o)}n.push(Promise.all(r).then((()=>{o(i,e.cv)})))}Promise.all(n).then((()=>i(e)))}}},28979:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>n}),3023==o.j)var i=o(39513);class n{constructor(e=500,t){this.sequencerFactory=null!=t?t:new i.k(e)}sequence(e){var t,o,i,n,r;return o=this,i=void 0,r=function*(){if(null==(null===(t=null==e?void 0:e.M_)||void 0===t?void 0:t.seq))return;const o=this.sequencerFactory.create(e);o&&(yield o.sequence(e.M_.seq))},new((n=void 0)||(n=Promise))((function(e,t){function s(e){try{l(r.next(e))}catch(e){t(e)}}function a(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof n?o:new n((function(e){e(o)}))).then(s,a)}l((r=r.apply(o,i||[])).next())}))}}},39513:(e,t,o)=>{"use strict";if(o.d(t,{k:()=>n}),3023==o.j)var i=o(30103);class n{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new i.A(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}},82971:(e,t,o)=>{"use strict";o.d(t,{_:()=>i});class i{process(e,t,o,i){for(const i of e.ops){if(null==i?void 0:i.items)for(const e of i.items)t(i,e);o(i,e.cv)}i(e)}}},77243:(e,t,o)=>{"use strict";o.d(t,{_A:()=>a,OW:()=>r,t$:()=>n});var i=o(87783);const n="Request timed out";function r(e,t,o){const n=new i.Request(e,t);return s.add(n,o)}const s=new class{constructor(e,t,o){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=o}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,o]=this.queuedRequests.shift();clearTimeout(o),this.add(e,t)}}add(e,t){if(this.requestInProgress){const o=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,o])}else this.requestInProgress=!0,new Promise(((t,o)=>{let i=!1;const n=setTimeout((()=>{i=!0,o(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{i||(clearTimeout(n),t(e))})).catch((e=>{i||(clearTimeout(n),o(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}(i.fetch,2e4,12e4);function a(e,t,o){return new Promise(((r,s)=>{const a=setTimeout((()=>{s(new Error(n))}),t);(0,i.fetch)(e,o||{}).then((e=>{clearTimeout(a),r(e)})).catch((e=>{clearTimeout(a),s(e)}))}))}},15210:(e,t,o)=>{"use strict";if(o.d(t,{I:()=>n}),3023==o.j)var i=o(23442);class n{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,this.getTokenCallback=e.getTokenCallback}get flights(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=(0,i.Vh)(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getTokenCallback(e,t)}getTokenAsync(e){return new Promise(((t,o)=>{this.getToken(e,((e,i,n)=>{e?o(e):t(Object.assign(Object.assign({},n),{token:i}))}))}))}}},16230:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>s}),3023==o.j)var i=o(41856);if(3023==o.j)var n=o(90456);if(3023==o.j)var r=o(41450);class s{constructor(e,t,o){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,o&&(this.itemsContextId=o.itemsContextId,this.executionState=o.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const o of this.itemsContextId)0===o.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){return this.graphNode.isActivated?e?(this.executionState.set(e,t),!0):(i.tG.info(520217546,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`})),!1):(i.tG.info(508883415,i.nh.CoreDefault,new n.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a not activated workflow`})),!1)}beforeWorkflowExecution(e){this.setExecutionState(e,r.si.Pending)}afterWorkflowExecution(e){this.setExecutionState(e,r.si.Executed)&&this.tryToCompleteWorkflowExecution(e)}clearWorkflowExecutions(){this.executionState.forEach(((e,t)=>this.afterWorkflowExecution(t)))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===r.si.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[o,i]of t.getExecutionState())i===r.si.Executed&&r.a4.isParentContextId(e,o)&&t.tryToCompleteWorkflowExecution(o)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const o of t.getExecutionState().keys())if(r.a4.isParentContextId(o,e))return!1;return!0}}},93692:(e,t,o)=>{"use strict";if(o.d(t,{t:()=>r}),3023==o.j)var i=o(76881);var n=o(85430);class r extends(3023==o.j?n.EventEmitter:null){init(){return Promise.resolve()}sendMessage(e,t,o){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new i.W}getNetworkWorkerManager(){}setState(e){}}},85427:(e,t,o)=>{"use strict";if(o.d(t,{Y:()=>c}),3023==o.j)var i=o(90456);if(3023==o.j)var n=o(41856);if(3023==o.j)var r=o(94878);if(3023==o.j)var s=o(46875);const a=3023==o.j?6e4:null,l="Request timed out";class c{constructor(e,t,o){this.remainingRetryAttempts=4,this.isAsleep=!1,this.isLongPollSuccessful=!1,this.isActiveLongPoll=!1,this.isResponseReceived=!1,this.lastEgressTime=0,this.longPollLogOp=new i.I({operationName:"OnLongPollMessage",success:!0}),this.clientMetadata=t,this.sessionCorrelationVector=o,this.longPollLogOp.setClientMetadata(this.clientMetadata,!0),this.worker=e}start(){const e=new i.I({operationName:"StartHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),n.tG.info(508163399,n.nh.CoreDefault,e.stop()),this.trySendLongPoll(r.PO.Start,!0),this.isLongPollSuccessful=!0}onResponse(e){if(!e||this.isResponseReceived){const e=new i.I({operationName:"HttpReliabilityManagerFailure",success:!1}).start();return e.setClientMetadata(this.clientMetadata,!0),void n.tG.info(508162497,n.nh.CoreDefault,e.stop())}this.isResponseReceived=!0,this.isActiveLongPoll=!1;const t=e;if(t.error)if(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,this.remainingRetryAttempts>0){this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription=`Retry attempts left : ${this.remainingRetryAttempts}`,this.longPollLogOp.resultSignature=t.error,n.tG.info(508163398,n.nh.CoreDefault,this.longPollLogOp.stop());const e=t.error===l?r.PO.TimeoutResend:r.PO.FailResend;t.error===l||3===this.remainingRetryAttempts?this.trySendLongPoll(e,!0):this.enqueueSendLongPoll(e)}else this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",n.tG.info(508163397,n.nh.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close();else this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",n.tG.info(508163401,n.nh.CoreDefault,this.longPollLogOp.stop()),this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll(r.PO.Regular)}close(){const e=new i.I({operationName:"CloseHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),n.tG.info(508162467,n.nh.CoreDefault,e.stop()),this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0),this.isActiveLongPoll=!1,this.isLongPollSuccessful=!1,this.worker=void 0}checkConnection(){if(this.isAsleep){this.isAsleep=!1;const e=new i.I({operationName:"AwakenHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),n.tG.info(508162496,n.nh.CoreDefault,e.stop()),this.trySendLongPoll(r.PO.CheckConnection,!0)}return this.isLongPollSuccessful}isReliabilityResponse(e){return"string"!=typeof e&&s.ry.typeGuard(e)}postEgress(){this.lastEgressTime=Date.now(),this.trySendLongPoll(r.PO.PostEgress)}needsParsedResponses(){return!0}enqueueSendLongPoll(e){this.sendLongPollTimer=setTimeout((()=>{this.trySendLongPoll(e,!0)}),2e4)}trySendLongPoll(e,t){if(!this.worker){const e=new i.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Worker is undefined",void n.tG.info(507281438,n.nh.CoreDefault,e.stop())}if(!0===this.isActiveLongPoll){const e=new i.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Already active long poll",void n.tG.info(508163396,n.nh.CoreDefault,e.stop())}if(this.isActiveLongPoll=!0,Date.now()-this.lastEgressTime>a&&!t){this.isActiveLongPoll=!1,this.isAsleep=!0;const e=new i.I({operationName:"LongPollSleep",success:!0}).start();return e.setClientMetadata(this.clientMetadata),e.resultDescription=`isAsleep: ${this.isAsleep}, isActiveLongPoll: ${this.isActiveLongPoll}`,void n.tG.info(507278739,n.nh.CoreDefault,e.stop())}this.longPollLogOp.start(),this.isResponseReceived=!1,this.worker.egress({obj:this.getLongPollMessageString(e),isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1})}getLongPollMessageString(e){const t=new s.LQ({longPollTimeoutHint:15e3,type:e});return this.sessionCorrelationVector&&(t.cv=this.sessionCorrelationVector().newChild().toString()),JSON.stringify(t)}}},18583:(e,t,o)=>{"use strict";o.d(t,{Z:()=>u});var i=o(46875);if(3023==o.j)var n=o(86391);var r=o(77243),s=o(87783);if(3023==o.j)var a=o(90456);if(3023==o.j)var l=o(41856);const c=JSON.stringify(new i.ry({error:r.t$}));class u{constructor(e){this.networkOverrideOptions=e,this.isClosed=!1,this.pendingEgress=[]}init(e,t,o,i){const r=new a.I({operationName:"HttpWorkerInit",success:!0}).start(),s=e.split("/?x-origin=");2===s.length?(this.url=n.Aq.convertWebSocketUrlToHttp(s[0]),this.origin=s[1]):(this.url=n.Aq.convertWebSocketUrlToHttp(e),this.origin=void 0),this.ingress=t,this.onOpen=o,this.onClose=i,l.tG.info(507839180,l.nh.CoreDefault,r.stop())}egress(e){const t=new a.I({operationName:"HttpEgress",success:!0}).start();if(!this.isConnectedToSession()&&!e.isHttpSessionInitMessage)return this.pendingEgress.push(e),t.success=!1,t.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),void l.tG.info(508163394,l.nh.CoreDefault,t.stop());const o=this.getRequestInfo(e,t);if(!o.url)return t.success=!1,t.resultDescription="Could not generate HTTP request",void l.tG.error(508163393,l.nh.CoreDefault,t.stop());e.isHttpSessionLongPollMessage?this.egressLongPoll(o,t):(0,r.OW)(o.url,o.request,((e,o)=>{e?this.onEgressError(t,"OnEgressError:"+(null==e?void 0:e.message)):o&&o.ok?o.text().then((e=>{t.success=!0,l.tG.info(508163362,l.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"OnEgressParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"OnEgressResponseError: "+(null==e?void 0:e.message)+`, Status ${null==o?void 0:o.status}: ${null==o?void 0:o.statusText}`)}))}close(){const e=new a.I({operationName:"HttpWorkerClose",success:!0}).start();if(this.isClosed)return e.resultDescription="AlreadyClosed",void l.tG.info(508163360,l.nh.CoreDefault,e.stop());l.tG.info(508163359,l.nh.CoreDefault,e.stop()),this.isClosed=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0)}onEgressError(e,t){e.success=!1,e.resultDescription=t,l.tG.error(508163358,l.nh.CoreDefault,e.stop()),this.isClosed||this.close()}ingressInternal(e,t){let o=e;t||(o=this.formatServerInput(e));o&&(this.logIngressCount(o),this.ingress(o,(e=>{i.uN.typeGuard(e)&&this.onSessionInitResponse(e)})))}onSessionInitResponse(e){const t=new a.I({operationName:"HttpWorkerOpen",success:!0}).start();if(!(e.sessionKey&&e.origin&&e.anonymousToken&&e.sessionUrlBase))return t.success=!1,t.resultDescription="SessionInitResponse missing information",void l.tG.error(507809949,l.nh.CoreDefault,t.stop());l.tG.info(508163357,l.nh.CoreDefault,t.stop()),this.setSessionSettings(e.sessionKey,e.origin,e.anonymousToken,e.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[]}egressLongPoll(e,t){(0,r._A)(e.url,2e4,e.request).then((e=>{e&&e.ok?e.text().then((e=>{t.success=!0,t.resourceId="LongPoll",l.tG.info(508163355,l.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"LongPollFetchParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"LongPollFetchStatusFailure: "+(null==e?void 0:e.statusText))})).catch((e=>{e.message===r.t$?(t.success=!1,t.resultDescription="LongPollFetchResponseTimeout:"+(null==e?void 0:e.message),l.tG.error(508163353,l.nh.CoreDefault,t.stop()),this.ingressInternal(c,!0)):this.onEgressError(t,"LongPollFetchResponseError: "+(null==e?void 0:e.message))}))}getRequestInfo(e,t){const o=this.getUrl(null==e?void 0:e.isHttpSessionInitMessage),i=this.getHeader(e,t);return t.resultSignature=o,{url:o,request:{method:"POST",headers:i,body:e.obj}}}getUrl(e){const t=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return e?t+"/sessioninit":this.isConnectedToSession()?t+"/session/"+this.sessionSettings.sessionKey:""}getHeader(e,t){var o;const i=new s.Headers;return(null==e?void 0:e.isHttpSessionInitMessage)?(i.set("Content-Type","application/json"),this.origin&&i.set("x-origin",this.origin)):this.isConnectedToSession()&&(e.obj instanceof Uint8Array||e.obj instanceof ArrayBuffer?(i.set("Content-Type","application/jsond2"),t.dimension0=e.obj.byteLength.toString().length.toString()):i.set("Content-Type","application/json"),i.append("Authorization",`Bearer ${this.sessionSettings.anonymousToken}`),i.set("x-origin",this.sessionSettings.origin)),(null===(o=this.networkOverrideOptions)||void 0===o?void 0:o.hostHeader)&&i.set("host",this.networkOverrideOptions.hostHeader),i}setSessionSettings(e,t,o,i){const n=i.replace("/session","");this.sessionSettings={sessionKey:e,origin:t,anonymousToken:o,sliceUrl:n}}isConnectedToSession(){return this.sessionSettings&&this.sessionSettings.sessionKey.length>0&&this.sessionSettings.anonymousToken.length>0&&this.sessionSettings.origin.length>0&&this.sessionSettings.sliceUrl.length>0&&!this.isClosed}formatServerInput(e){return e.length>1?e.substring(1,e.length-1):""}logIngressCount(e){const t=e.length;if(t>1e5){const e=new a.I({operationName:"HttpIngressByteOrderOfMagnitude",success:!0}).start();e.dimension2=t.toString().length.toString(),l.tG.info(508409622,l.nh.CoreDefault,e.stop())}}}},82494:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>s}),3023==o.j)var i=o(56670);if(3023==o.j)var n=o(85427);if(3023==o.j)var r=o(18583);const s=(e,t,o,s,a)=>e instanceof r.Z?new n.Y(e,o,s):new i.R(e,t,o,a)},56670:(e,t,o)=>{"use strict";o.d(t,{R:()=>s});var i=o(90456),n=o(41856);const r=3e4;class s{constructor(e,t,o,n){this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.remainingPingFailures=3,this.isPingPongSuccessful=!1,this.reducedPingPongRetryEnabled=n,this.pingPongLogOp=new i.I({operationName:"WebSocketReliabilityManager",success:!0,resourceId:this.reducedPingPongRetryEnabled?"reducedPingPongRetryEnabled":""}).start(),this.pingPongLogOp.setClientMetadata(o,!0),this.worker=e,this.rateControllerClose=t}start(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.resultSignature="initial ping"):this.logOperation(!0,"ping","initial ping"),this.ping(),this.isPingPongSuccessful=!0,this.startInterval()}onResponse(){this.lastPongTime=Date.now(),this.reducedPingPongRetryEnabled&&(this.pingPongLogOp.success=!0,n.tG.info(506795283,n.nh.CoreDefault,this.pingPongLogOp.stop()))}isReliabilityResponse(e){return"string"==typeof e&&1===e.length&&e===s.pingPongMessage}close(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.success=!0,this.pingPongLogOp.resultSignature="close",n.tG.info(506795282,n.nh.CoreDefault,this.pingPongLogOp.stop())):this.logOperation(!0,"ping","close"),this.lastPingTime=0,this.lastPongTime=0,this.isPingPongSuccessful=!1,this.clearPingInterval(),this.worker=void 0}checkConnection(){return this.isPingPongSuccessful}postEgress(){this.lastEgressTime=Date.now()}needsParsedResponses(){return!1}ping(){this.reducedPingPongRetryEnabled?this.worker||(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="websocket worker undefined",this.rateControllerClose(),n.tG.info(506795281,n.nh.CoreDefault,this.pingPongLogOp.stop())):this.lastPingTime=Date.now(),this.worker&&(this.reducedPingPongRetryEnabled&&(this.lastPingTime=Date.now()),this.worker.egress({obj:s.pingPongMessage}))}startInterval(){this.pingInterval=setInterval((()=>{if(this.reducedPingPongRetryEnabled){if(this.lastPongTime<this.lastPingTime&&Date.now()-this.lastPingTime<r)return;this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime,this.pingPongLogOp.start(),this.isPingPongSuccessful?(this.pingPongLogOp.resultSignature="ping",this.ping()):(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="Pong not received",n.tG.info(506795280,n.nh.CoreDefault,this.pingPongLogOp.stop()),this.worker?this.worker.close():this.rateControllerClose())}else{if(this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=r,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.isPingPongSuccessful?(this.remainingPingFailures=3,this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.ping()):(this.logOperation(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.worker?this.worker.close():this.rateControllerClose())}}),r)}clearPingInterval(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)}logOperation(e,t,o,i){var r,s,a,l;this.pingPongLogOp.start(),this.pingPongLogOp.success=e,this.pingPongLogOp.resultSignature=t,this.pingPongLogOp.resultDescription=o,i&&(this.pingPongLogOp.dimension0=null!==(r=i[0])&&void 0!==r?r:"",this.pingPongLogOp.dimension1=null!==(s=i[1])&&void 0!==s?s:"",this.pingPongLogOp.dimension2=null!==(a=i[2])&&void 0!==a?a:"",this.pingPongLogOp.dimension3=null!==(l=i[3])&&void 0!==l?l:""),n.tG.info(507320073,n.nh.CoreDefault,this.pingPongLogOp.stop())}}s.pingPongMessage="~"},34897:(e,t,o)=>{"use strict";if(o.d(t,{BG:()=>r,M4:()=>a,NR:()=>s}),3023==o.j)var i=o(60859);if(3023==o.j)var n=o(41856);const r=(e,t,o,r,s)=>{const a=(e=>{const t=e.filter((e=>i.h.matchesTypesFor(e,["AugLoop_Signals_SignalOperation"])));for(const e of t)for(const t of e.items)if(t.body&&i.h.matchesTypesFor(t.body,["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Copilot_CopilotInputSignal"]))return t})(e);a&&(s.setDataField("CurrentTimestamp",o),s.cv=t||"",s.resultSignature=r,s.resourceId=i.h.getTypeNameFor(a.body),a.contextId&&s.setDataField("ContextId",a.contextId),a.sourceTimestamp&&s.setDataField("SourceTimestamp",a.sourceTimestamp),n.tG.info(505983429,n.nh.CoreDefault,s.stop()))},s=(e,t,o,i)=>{r(e.ops,e.cv,t,o,i)},a=(e,t,o,r,s)=>{r&&!(e=>{var t;const o=e.ops.filter((e=>i.h.matchesTypesFor(e,["AugLoop_Core_AddOperation"])));for(const e of o)for(const o of e.items)if(o.body&&(null===(t=o.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse))return!0;return!1})(e)||(s.setDataField("CurrentTimestamp",t),s.cv=e.cv,s.resultSignature=o,s.resourceId=e.annotationType,n.tG.info(505983428,n.nh.CoreDefault,s.stop()))}},72459:(e,t,o)=>{"use strict";o.d(t,{xB:()=>je,Nd:()=>Ne});var i,n,r=o(2843),s=o(90456),a=o(41856);!function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(i||(i={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"}(n||(n={}));var l=o(37796);const c=["cloud.dev.microsoft","officeppe.com","cloud.microsoft","office.com","office365.us","ic.gov","microsoft.scloud","microsoftonline.cn"],u=(e,t,o,i)=>new l.D(e,(e=>e.success&&o.indexOf(e[t])>=0),[t,"ariaNamespace","resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],i),d=e=>{if(!e)return e;for(const t of c)if(e.indexOf(t)>=0)return e;return"**redacted**"};class h{constructor(e){this.level=r.q.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,o,r,s)=>{let a=t.charAt(0).toUpperCase()+t.slice(1),l={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId,ServerSessionKey:this.serverSessionKey};o&&(l=Object.assign(Object.assign({},l),JSON.parse(o)));const c=r||h.augLoopAriaTenantToken,u=s||c!=h.augLoopAriaTenantToken?s:h.augLoopAriaNamespace;a=a||h.operationNamePlaceholder;const d={CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success};this.hostCallbacks.sendTelemetryEvent(c,u?`${u}_${a}`:a,l,"Office.System.Activity",d,!1,i.ProductServiceUsage|i.ProductServicePerformance,n.RequiredServiceDataEvent)};if("Workflow.MetricsOnly"==e.category);else if("Operation"===e.eventName){const o=e;t(o,o.operationName,o.dataFields,void 0,o.ariaNamespace)}else if("SessionHealth"===e.eventName)t(e,e.sessionHealthEventName);else if("WorkflowOperation"===e.eventName){const o=e;t(o,o.operationName,o.dataFields,o.ariaTenant,o.ariaNamespace)}else"Log"===e.eventName&&((e,t,o)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,o)})(e.tagId,e.traceLevel,e.message)}setServerSessionKey(e){this.serverSessionKey=e}}h.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",h.augLoopAriaNamespace="Office_AugLoop_Client",h.operationNamePlaceholder="OperationNameNotProvided";var g=null;"undefined"!=typeof WebSocket?g=WebSocket:"undefined"!=typeof MozWebSocket?g=MozWebSocket:void 0!==o.g?g=o.g.WebSocket||o.g.MozWebSocket:"undefined"!=typeof window?g=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(g=self.WebSocket||self.MozWebSocket);const p=g,f="object"==typeof process&&"object"==typeof process.versions&&void 0!==process.versions.node,m=1e5;class v{constructor(e,t){this.networkOverrideOptions=e,this.settings=t,this.hadEgressError=!1,this.isClosing=!1,this.pendingEgress=[]}get egressByteCountOp(){return this._egressByteCountOp||(this._egressByteCountOp=new s.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0}),this._egressByteCountOp.setClientMetadata(this.clientMetadata,!0)),this._egressByteCountOp}init(e,t,o,i,n){var r,l;if(this.clientMetadata=n,f){const t={servername:null===(r=this.networkOverrideOptions)||void 0===r?void 0:r.hostHeader,headers:(null===(l=this.networkOverrideOptions)||void 0===l?void 0:l.hostHeader)?{host:this.networkOverrideOptions.hostHeader}:void 0};this.ws=new p(e,t)}else this.ws=new p(e);this.logOp=new s.I({operationName:v.className,success:!0}).start(),this.logOp.setClientMetadata(n,!0),this.ingressByteCountOp=new s.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp.setClientMetadata(n,!0),this.ws.addEventListener("open",(e=>{o(),this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),a.tG.info(508843801,a.nh.CoreDefault,this.logOp.stop())})),this.ws.addEventListener("message",(e=>{this.logIngressCount(e.data),t(e.data)})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,a.tG.info(508843800,a.nh.CoreDefault,this.logOp.stop()),this.ws?this.ws.close():this.logWsUndefinedError("error event handler")})),this.ws.addEventListener("close",(e=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,a.tG.info(508843799,a.nh.CoreDefault,this.logOp.stop()),i(this.errorMessage),this.isClosing=!1}))}egress(e){var t;const o=e.obj;(null===(t=this.settings)||void 0===t?void 0:t.webSocketWorkerShouldLogEgressCount)&&this.logEgressCount(o),this.ws.send(o,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,a.tG.info(508843797,a.nh.CoreDefault,this.logOp.stop()))}))}close(){this.isClosing||(this.isClosing=!0,this.ws?this.ws.close():this.logWsUndefinedError("close"))}logIngressCount(e){const t=e.length;t>m&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),a.tG.info(508843794,a.nh.CoreDefault,this.ingressByteCountOp.stop()))}logEgressCount(e){const t="string"==typeof e?e.length:e.byteLength;t>m&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=t.toString().length.toString(),a.tG.info(505710625,a.nh.CoreDefault,this.egressByteCountOp.stop()))}logWsUndefinedError(e){const t=new s.I({operationName:v.className,success:!1}).start();t.setClientMetadata(this.clientMetadata,!0),t.resourceId="webSocketUndefined",t.resultDescription=e+": this.ws null or undefined",a.tG.info(506566722,a.nh.CoreDefault,t.stop())}}v.className="WebSocketWorker";var b,y,w=o(76881),C=o(92313),S=o(46875),k=o(94878),T=o(60859),x=o(85430),_=o(86391),I=o(25626),E=o.n(I);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(b||(b={}));class B{constructor(e){this.logOp=new s.I({operationName:"MessageQueue",success:!0}),this.queue=new(E())(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,o){const i=this.queue;if(1e3===i.length){this.logOp.resourceId="QueueFull",this.logOp.durationMs=0,this.logOp.success=!1,a.tG.warn(508843746,a.nh.CoreDefault,this.logOp);const e=i.shift();e.onResponse&&e.onResponse(new S._p({error:b.DroppedAsOldestInQueue}))}i.push({message:e,onResponse:t,timeQueued:_.Aq.getCurrentTimeMs(),attemptNumber:o})}sendOnSessionInitialized(e){const t=this.queue.length;let o=0;if(t>0){const i=_.Aq.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&this.containSequencedSyncMessage(t)?(o++,t.onResponse&&t.onResponse(new S._p({error:b.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${o}`,this.logOp.durationMs=i,this.logOp.success=!0,a.tG.warn(508843745,a.nh.CoreDefault,this.logOp)}}containSequencedSyncMessage(e){return e.message instanceof S.Tb&&T.h.matchesTypesFor(e.message,[S.Tb.getTypeName()])&&e.message.seq>=0||e.message instanceof S.l0&&T.h.matchesTypesFor(e.message,[S.l0.getTypeName()])}}!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(y||(y={}));const A=(e,t,o,i)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,i)=>{t||T.h.getTypeNameFor(i)!==S.fZ.getTypeName()||(e.stats.lastSyncMessage=Date.now()),o&&o(t,i)}),void 0,i))},R=(e,t,o,i)=>{t&&(e.messageQueue.push(t,o,i),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new s.I({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});a.tG.error(508843789,a.nh.CoreDefault,t)})))},M=(e,t)=>{t&&(e.messageQueue.push(t),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{a.tG.error(508843788,a.nh.CoreDefault,`Init failed: ${e}`)})))};class D{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,o,i){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class P extends D{constructor(){super(...arguments),this.stateName=y.Initing,this.possibleNextStates=[y.Running,y.Disconnected,y.Closed]}sendMessage(e,t,o){T.h.matchesTypesFor(e,[S.eE.getTypeName()])?A(this.context,e,t,o):R(this.context,e,t)}sendBytes(e){M(this.context,e)}onConnectionClose(){this.context.setState(y.Disconnected)}}class F extends D{constructor(){super(...arguments),this.stateName=y.Running,this.possibleNextStates=[y.Disconnected,y.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)}sendMessage(e,t,o,i){A(this.context,e,t,o)}sendBytes(e){e&&this.context.networkWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(y.Disconnected)}}class O extends D{constructor(){super(...arguments),this.stateName=y.Disconnected,this.possibleNextStates=[y.Initing,y.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(C.Ef.ClientDisconnected)}sendMessage(e,t,o,i){if(T.h.matchesTypesFor(e,[S.eE.getTypeName()]))this.context.setState(y.Initing),A(this.context,e,t,o);else if(T.h.matchesTypesFor(e,[S.w9.getTypeName()]))this.context.setState(y.Closed);else{if(!i)return void R(this.context,e,t,o);t&&t(new S._p({messageId:e.messageId,error:b.DroppedBecauseClientDisconnected}))}}sendBytes(e){M(this.context,e)}}class N extends D{constructor(){super(...arguments),this.stateName=y.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(C.Ef.ClientClosed)}}var q=o(42316),j=o(77243),L=o(82494),z=o(34897),H=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const W=1e5,U=1e4;class G{constructor(e){var t,o;this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.pendingQueue=[],this.rpsThreshold=150,this.bpsThreshold=5e8,this.isClosing=!1,this.messageQueue=void 0,this.egressRateLogOp=new s.I({operationName:"NetworkEgressRate",success:!0}),this.egressedCache=new Map,this.initPromise=new Promise((e=>{this.resolveInitPromise=e})),this.dynamicRateControllerEnabled=null!==(t=null==e?void 0:e.dynamicRateControllerEnabled)&&void 0!==t&&t,this.dynamicRateControllerEnabled&&(this.messageQueue=new(E())),this.reducedPingPongRetryEnabled=null!==(o=null==e?void 0:e.reducedPingPongRetryEnabled)&&void 0!==o&&o}init(e,t,o,i,n,r){this.worker=e,this.ingress=t,this.queryEgressCacheSize=o,this.clientMetadata=n,this.networkMode=i,this.reliabilityManager=(0,L.a)(this.worker,this.close.bind(this),void 0,r,this.reducedPingPongRetryEnabled),this.egressRateLogOp.setClientMetadata(this.clientMetadata,!0),this.dynamicRateControllerEnabled&&(this.resetRateLimiter(),this.onCloseController=new Promise((e=>{this.resolveCloseControllerPromise=e})),this.queueProcessingCompletePromise=new Promise((e=>{this.resolveQueueProcessingCompletePromise=e}))),this.resolveInitPromise()}open(){const e=new s.I({operationName:"NetworkRateControllerOpen",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),this.initPromise.then((()=>{if(!this.reliabilityManager)return e.success=!1,void(e.resultDescription="Reliability Manager is undefined");this.egressRateControlIntervalStart=Date.now(),this.reliabilityManager.start(),this.dynamicRateControllerEnabled?this.processQueue():(this.egressRateControlTimer=setInterval((()=>this.flush()),1e3),this.flush())})).catch((t=>{var o;e.success=!1,e.resultDescription="Catch: "+(null!==(o=null==t?void 0:t.message)&&void 0!==o?o:"")})).finally((()=>{a.tG.info(507834384,a.nh.CoreDefault,e.stop())}))}ingressFromWorker(e,t){this.reliabilityManager?this.reliabilityManager.needsParsedResponses()||!this.reliabilityManager.isReliabilityResponse(e)?this.ingress(e,(e=>{null==t||t(e),this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(e)&&this.reliabilityManager.onResponse(e)})):this.reliabilityManager.onResponse():this.ingress(e,t)}onRateLimitErrorResponse(e){if(this.dynamicRateControllerEnabled){const t=new s.I({operationName:"NetworkRateControllerOnRateLimitResponse",success:!0}).start();t.setClientMetadata(this.clientMetadata,!0),t.resultSignature=`rateLimitAlreadyStarted: ${void 0!==this.rateLimitTimeout}`,t.setDataField("RetryAfterMs",e.retryAfterMs),t.setDataField("QueueSize",this.messageQueue.length),this.startRateLimiting(e.retryAfterMs),a.tG.info(507388684,a.nh.CoreDefault,t.stop())}}setRpsBps(e,t){const o=new s.I({operationName:"NetworkRateControllerRateLimitsSet",success:!0}).start();o.setClientMetadata(this.clientMetadata,!0),e&&(this.rpsThreshold=.8*e,o.resultDescription+=`maxRPS: ${e}, rpsThreshold: ${this.rpsThreshold}; `),t&&(this.bpsThreshold=.8*t,o.resultDescription+=`maxRPS: ${t}, rpsThreshold: ${this.bpsThreshold}; `),a.tG.info(507388683,a.nh.CoreDefault,o.stop())}close(){var e,t;return H(this,void 0,void 0,(function*(){const o=new s.I({operationName:"NetworkRateControllerClose",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();if(o.setClientMetadata(this.clientMetadata,!0),this.isClosing=!0,this.dynamicRateControllerEnabled){null===(e=this.resolveCloseControllerPromise)||void 0===e||e.call(this);const i=null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection();o.setDataField("QueueSizeBeforeFlush",this.messageQueue.length),0!=this.messageQueue.length&&i&&(yield this.queueProcessingCompletePromise),o.setDataField("QueueSizeAfterFlush",this.messageQueue.length),o.setDataField("IsConnected",i)}this.reliabilityManager?this.reliabilityManager.close():o.resultDescription="Reliability Manager is undefined",this.worker=void 0,this.prevSeq=-1,this.clearEgressControlTimeout(),this.reliabilityManager=void 0,a.tG.info(507834381,a.nh.CoreDefault,o.stop())}))}clearMessageQueues(){this.pendingQueue=[],this.egressedCache.clear(),this.messageQueue=void 0}egress(e,t=0){var o,i,n;if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","");const r=this.getMessageSize(e);if(r>=3e6)this.logEgressActivity(!1,"Message size exceeded 3000000",`Message size: ${r}`);else{if((e.obj instanceof ArrayBuffer||e.isHttpSessionInitMessage)&&this.worker)return this.logEgressActivity(!0,`isArrayBuffer: ${e.obj instanceof ArrayBuffer}, isHttpSessionInitMessage: ${e.isHttpSessionInitMessage}`,""),void this.worker.egress(e);if(this.validateSyncMessage(e.messageId,e.seqId),this.dynamicRateControllerEnabled){const n=null!==(o=e.messageId)&&void 0!==o?o:"id"+this.emptyMessageId++,r={obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:n,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage},l=t>0,c=new s.I({operationName:"NetworkRateControllerQueueItem",success:!0,dimension3:`isRetry: ${l}`}).start();c.setClientMetadata(this.clientMetadata,!0);const u={message:r,logOp:c};if(l?this.messageQueue.unshift(u):this.messageQueue.push(u),this.messageQueue.length>1e4){const e=this.messageQueue.shift(),t=`NetworkRateControllerQueue max size reached. Dropping messageId: ${e.message.messageId}`;throw e.logOp.resultDescription=t,e.logOp.success=!1,a.tG.info(506001225,a.nh.CoreDefault,e.logOp.stop()),new Error(t)}null===(i=this.resolveQueueNotEmptyPromise)||void 0===i||i.call(this)}else{const t=this.queryEgressCacheSize(),o=this.egressMessageCount>=this.rpsThreshold,i=this.egressByteCount>=this.bpsThreshold,r=t>U,s=this.reliabilityManager.checkConnection(),a=0!==this.pendingQueue.length,l=this.pendingQueue.length>=1e4;if(!s||o||i||a||l||r){let c="";const u=[];(a||l)&&(c+=l?"Pending queue max exceeded. ":"Pending queue not empty. ",u.push(this.pendingQueue.length.toString().length.toString())),r&&(c+=t>=U?"Egressed cache max exceeded. ":"",u.push(t.toString().length.toString())),o&&(c+="RPS exceeded. ",u.push(this.egressMessageCount.toString().length.toString())),i&&(c+="BPS exceeded. ",u.push(this.egressByteCount.toString().length.toString())),c+=s?"":"Not connected. ",this.logEgressActivity(!0,`networkMode: ${this.networkMode}`,c,u);const d=null!==(n=e.messageId)&&void 0!==n?n:"id"+this.emptyMessageId++;return void this.pendingQueue.push({obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:d,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage})}this.sendToNetworkWorker(e)}}}getMessageSize(e){return e.obj instanceof ArrayBuffer?e.obj.byteLength:e.obj.length}sendToNetworkWorker(e){var t;try{if(!this.worker)return void this.logEgressActivity(!1,"NetworkWorker is undefined","SendToNetworkWorkerFailure");if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","SendToNetworkWorkerFailure");this.worker.egress(e),this.onSendToNetworkWorker(e),null===(t=this.reliabilityManager)||void 0===t||t.postEgress();const o=this.getMessageSize(e);this.logEgressCount(o)}catch(e){this.logEgressActivity(!1,"SendToNetworkWorkerFailure",e?e.message:"")}}onSendToNetworkWorker(e){if("string"==typeof e.obj)try{const t=JSON.parse(e.obj);if(S.Tb.typeGuard(t)){const e=t;(0,z.NR)(e,Date.now(),"SendToNetwork",new s.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}}catch(e){}}flush(){if(!this.reliabilityManager){const e=new s.I({operationName:"NetworkRateControllerFlushFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void a.tG.info(507834373,a.nh.CoreDefault,e.stop())}let e=0,t=0;for(;this.pendingQueue.length>0&&this.queryEgressCacheSize()<U&&e<this.rpsThreshold&&t<this.bpsThreshold&&this.reliabilityManager.checkConnection();){const o=this.pendingQueue.shift();this.sendToNetworkWorker(o),e++,t+=this.getMessageSize(o)}}processQueue(){var e,t,o;return H(this,void 0,void 0,(function*(){if(!this.reliabilityManager){const e=new s.I({operationName:"NetworkRateControllerProcessQueueFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void a.tG.info(507573643,a.nh.CoreDefault,e.stop())}const i=new s.I({operationName:"NetworkRateControllerProcessQueue",success:!0}).start();for(;;){if(0===this.messageQueue.length){if(this.isClosing){i.setDataField("ExitReason","Stage#1 Closing");break}yield Promise.race([this.queueNotEmpty(),this.onCloseController])}if(this.rateLimitTimeout){const e=new s.I({operationName:"NetworkRateControllerRateLimitBackoff",dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.setDataField("QueueLengthBeforeBackoff",this.messageQueue.length),yield Promise.race([this.rateLimitTimeout,this.onCloseController]),e.setDataField("QueueLengthAfterBackoff",this.messageQueue.length),e.setDataField("IsClosing",this.isClosing),e.success=!0,this.rateLimitTimeout=void 0,this.resetRateLimiter(),a.tG.info(507281410,a.nh.CoreDefault,e.stop())}if(!(null===(e=this.reliabilityManager)||void 0===e?void 0:e.checkConnection())){if(this.isClosing){i.setDataField("ExitReason","Stage#2 Closing");break}yield this.checkConnectionPromise(),this.connectionPromise=void 0}if(!this.reliabilityManager){i.setDataField("ExitReason","Stage#2 ReliabilityManager null");break}for(;this.messageQueue.length>0&&this.reliabilityManager.checkConnection();){if(Date.now()-this.egressRateControlIntervalStart>=1e3)this.resetRateLimiter();else if(this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold){const e=1100;let t="";this.egressMessageCount>=this.rpsThreshold&&(t+="RPS exceeded."),this.egressByteCount>=this.bpsThreshold&&(t+="BPS exceeded.");const o="rateLimitHit",i=new s.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();i.setClientMetadata(this.clientMetadata,!0),i.success=!0,i.resultDescription=o,i.resultSignature=t,i.dimension0=this.messageQueue.length.toString().length.toString(),i.dimension1="rateLimitHit",i.setDataField("QueueLength",this.messageQueue.length),i.setDataField("RateLimitDelayMs",e),a.tG.info(507281409,a.nh.CoreDefault,i.stop()),this.startRateLimiting(e);break}const e=this.messageQueue.shift();this.sendToNetworkWorker(e.message),a.tG.info(507388682,a.nh.CoreDefault,e.logOp.stop())}this.onQueueNotEmpty=void 0,this.resolveQueueNotEmptyPromise=void 0}null===(t=this.resolveQueueProcessingCompletePromise)||void 0===t||t.call(this),this.resolveQueueProcessingCompletePromise=void 0,i.setClientMetadata(this.clientMetadata,!0),i.setDataField("QueueSize",this.messageQueue.length),i.setDataField("IsConnected",null===(o=this.reliabilityManager)||void 0===o?void 0:o.checkConnection()),i.setDataField("IsClosing",this.isClosing),a.tG.info(507368671,a.nh.CoreDefault,i.stop())}))}queueNotEmpty(){return this.onQueueNotEmpty||(this.onQueueNotEmpty=new Promise((e=>{this.resolveQueueNotEmptyPromise=e}))),this.onQueueNotEmpty}checkConnectionPromise(){return this.connectionPromise||(this.connectionPromise=new Promise((e=>{setTimeout(e,1e3)}))),this.connectionPromise}startRateLimiting(e){this.rateLimitTimeout||(this.rateLimitTimeout=new Promise((t=>{setTimeout(t,e)})))}resetRateLimiter(){this.egressRateControlIntervalStart=Date.now(),this.egressMessageCount=0,this.egressByteCount=0}clearEgressControlTimeout(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}validateSyncMessage(e,t){if(!(void 0===t||void 0===e||t<=this.prevSeq)){if(t&&t!==this.prevSeq+1){const e=new s.I({operationName:"NetworkRateControllerAbandonedSyncMessage",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Gap in sync message",e.dimension0=`${this.prevSeq}`,e.dimension1=`${t}`,e.dimension2=""+(t-this.prevSeq),a.tG.info(507834370,a.nh.CoreDefault,e.stop())}this.prevSeq=t}}logEgressActivity(e,t,o,i){var n,r,l,c;const u=new s.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();u.setClientMetadata(this.clientMetadata,!0),u.success=e,u.resultDescription=t,u.resultSignature=o,i&&(u.dimension0=null!==(n=i[0])&&void 0!==n?n:"",u.dimension1=null!==(r=i[1])&&void 0!==r?r:"",u.dimension2=null!==(l=i[2])&&void 0!==l?l:"",u.dimension3=null!==(c=i[3])&&void 0!==c?c:""),a.tG.info(507626007,a.nh.CoreDefault,u.stop())}logEgressCount(e){const t=Date.now();t-this.egressRateControlIntervalStart>1e3&&((this.egressMessageCount>50||this.egressByteCount>W)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps logging threshold exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>W?"bps logging threshold exceeded":"",this.egressRateLogOp.dimension0=(t-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,this.egressRateLogOp.dimension3=`networkMode: ${this.networkMode}`,a.tG.info(508843792,a.nh.CoreDefault,this.egressRateLogOp.stop())),this.egressRateControlIntervalStart=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}var V=o(55887);class ${constructor(e,t,o,i,n,r,l,c,u,h){this.logCountLimiter=new _.yq($.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.workerOpenCount=0,this.testHttpConnection=e=>{const t=_.Aq.convertWebSocketUrlToHttp(this.globalUrl),o=!e,i=null!=e?e:new s.I({operationName:"HttpsTest",resourceId:d(t),success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start(),n={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":i.cv},body:JSON.stringify(_.Aq.createHealthCheckRequest(this.clientMetadata))};(0,j.OW)(t,n,((e,t)=>{e?(i.dimension1="HttpErr",i.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(i.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,o&&(i.success=!0)):(i.dimension1="HttpNoResp",i.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),o&&i.stop(),this.logCountLimiter.log((()=>{a.tG.info(508843780,a.nh.CoreDefault,i)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=o,this.sessionInitializer=i,this.ingress=n,this.queryEgressCacheSize=r,this.onConnectionClose=l,this.sessionCorrelationVector=c,this.dynamicRateControllerEnabled=u.dynamicRateControllerEnabled,this.reducedPingPongRetryEnabled=u.reducedPingPongRetryEnabled,this.networkWorkerLogOp=new s.I({operationName:"CreateNetworkWorker",success:!0}),this.networkMode=h||V.yv.JSWebSockets,this.initNetworkMode=this.networkMode}init(e,t,o=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const i=()=>{if(o||!this.alreadyLoggedReconnectAttempt){const e=o?$.initialAttemptTimeout:$.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new s.I({operationName:"ConnectionFailingOrSlow",dimension0:o?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});a.tG.info(508843787,a.nh.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!o,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromise=t().catch((e=>{const t=new s.I({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});a.tG.error(508843786,a.nh.CoreDefault,t)})).then((()=>{i(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),i(),this.initInternal()),this.pendingInitPromise}egress(e,t){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressInternal(e,t)})):(this.egressInternal(e,t),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}getNetworkMode(){return this.networkMode}getInitNetworkMode(){return this.initNetworkMode}onRateLimitErrorResponse(e){this.dynamicRateControllerEnabled&&this.getNetworkRateController().onRateLimitErrorResponse(e)}close(e){this.isWorkerReady=!1,this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.worker&&(this.worker.close(),this.worker=null),!this.dynamicRateControllerEnabled&&this.networkRateController&&this.getNetworkRateController().close(),this.networkRateController=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new s.I({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});a.tG.info(508843785,a.nh.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t,o)=>{let i=0;const n=_.Aq.getCurrentTimeMs()?_.Aq.getCurrentTimeMs()-t:0,r=[1e3,2e3,5e3,1e4,6e4];return i=r[Math.max(0,Math.min(r.length-1,e-1))],i=Math.max(i-n,1e3),i=o&&o>0?Math.min(5e3,i):i,i})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpTestsSuccessCount)):this.getNetworkMode()===V.yv.HttpFallback?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),100):this.tryToConnectAndInitializeSession()}egressInternal(e,t){if(!this.isWorkerReady&&!T.h.matchesTypesFor(e,[S.eE.getTypeName()]))return void(T.h.matchesTypesFor(e,[S.YK.getTypeName()])||a.tG.error(508843784,a.nh.CoreDefault,new s.I({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let o,i;if(T.h.matchesTypesFor(e,[S.VR.getTypeName()])?(this.castBinaryData(e),o=q.r.serialize(e)):o=JSON.stringify(e),S.Tb.typeGuard(e)&&(i=e.seq),this.bypassRateController(e))return void this.worker.egress({obj:o});const n=S.eE.typeGuard(e)&&this.getNetworkMode()===V.yv.HttpFallback;this.getNetworkRateController().egress({obj:o,isHttpSessionInitMessage:n,messageId:e.messageId,seqId:i},t)}bypassRateController(e){return S.w9.typeGuard(e)}egressBytesInternal(e){this.isWorkerReady?this.getNetworkRateController().egress({obj:e}):a.tG.error(508843783,a.nh.CoreDefault,new s.I({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=_.Aq.getCurrentTimeMs();const e=t=>{if(this.permanentlyClosed||this.isOffline())return;const o=this.sliceUrl?this.sliceUrl:this.globalUrl;t.setDataField("connectionUrl",d(o)),this.connect(o),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(o,i)=>{if(t.success=!o,t.resourceId=i?d(i.sliceUrl):"",t.dimension2=this.getNetworkModeLogString(),this.getNetworkMode()===V.yv.HttpFallback?(t.resultDescription=o?`HTTP Error: ${o.error}`:"",t.dimension0=t.success?"HTTPOK":"HTTPFail"):(t.resultDescription=o?`WS Error: ${o.error}`:"",t.dimension0=t.success?"WSOK":"WSFail"),o||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.getNetworkMode()===V.yv.JSWebSockets?0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(t.dimension1="WSBlocked",t.dimension3="HTTP Fallback",this.networkMode=V.yv.HttpFallback,this.currentReconnectAttempt=0,this.resetHttpTestsCounter()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="HTTPOffline"),this.logCountLimiter.log((()=>{a.tG.info(508843782,a.nh.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{a.tG.info(508843781,a.nh.CoreDefault,t.stop())})),i.forceReconnect){this.close();const t=new s.I({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=i.sliceUrl,this.dynamicRateControllerEnabled&&this.getNetworkRateController().setRpsBps(i.maxRPS,i.maxBPS),this.ready();this.resetHttpTestsCounter()}})},t=new s.I({operationName:"TryToConnectAndInitializeSession",resultSignature:`Reconnection attempt #${this.currentReconnectAttempt}`}).start();e(t)}getNetworkRateController(){return this.networkRateController||(this.networkRateController=new G({dynamicRateControllerEnabled:this.dynamicRateControllerEnabled,reducedPingPongRetryEnabled:this.reducedPingPongRetryEnabled})),this.networkRateController}connect(e){const t=this.getNetworkMode();this.networkWorkerLogOp.start(),this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString(),this.networkWorkerLogOp.dimension0=t.toString(),this.logCountLimiter.log((()=>a.tG.info(508372418,a.nh.CoreDefault,this.networkWorkerLogOp.stop()))),this.worker=this.workerFactory(t),this.worker.init(e,this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController),(()=>{this.workerOpenCount++,this.getNetworkRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClose(e)}),this.clientMetadata),this.getNetworkRateController().init(this.worker,this.ingress,this.queryEgressCacheSize,t,this.clientMetadata,this.sessionCorrelationVector)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[t]=new Uint8Array(e[t]));for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&this.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMode(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}getNetworkModeLogString(){return"NetworkMode: "+(this.getNetworkMode()===V.yv.JSWebSockets?"WebSocket":"HTTP")}}$.initialAttemptTimeout=1e5,$.reconnectAttemptTimeout=2e4,$.className="NetworkWorkerManager";var K=o(59294);class J extends x.EventEmitter{constructor(e,t,o,i,n,r,a,l,c){super(),this.cvParent=new w.W,this.logOp=new s.I({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new _.yq("SessionState"),this.logRetryTelemetry=!0,this.isImproveRetriesChangeGateEnabled=!0,this.shouldNotRetryOnSessionClosedError=!0,this.stats=t,this.allStates={[y.Initing]:new P(this),[y.Running]:new F(this),[y.Disconnected]:new O(this),[y.Closed]:new N(this)},this.setState(y.Initing),this.messageEndpoint=new C.N0({messageIdPrefix:"c",responseTimeoutMs:3e4,resendPendingMessagesOnReconnect:!1}),this.messageEndpoint.setClientMetadata(n),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(S.w9.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.networkWorkerManager=new $(e,n,o,i,this.ingress.bind(this),this.messageEndpoint.queryEgressCacheSize.bind(this.messageEndpoint),this.onConnectionClose.bind(this),this.getCorrelationVector.bind(this),a,c),this.messageQueue=new B({sendMessage:(e,t,o,i)=>this.state.sendMessage(e,t,o,i),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage()}),i.on("connect",((e,t,o,i,n,r,s)=>{this.setState(y.Running,"",{isSessionReseedingStarted:e&&t}),this.emit("connect",e,o,i,n,r,s)})),i.on("reconnect",(()=>this.emit("reconnect"))),i.on("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=r,this.gateUtils=l,this.gateUtils&&(this.gateUtils.isChangeGateEnabled("LogRetryMessageEventV2").then((e=>{this.logRetryTelemetry=e})).catch((()=>{})),this.gateUtils.isChangeGateEnabled("ImproveClientRetries").then((e=>{this.isImproveRetriesChangeGateEnabled=e})).catch((()=>{})),this.gateUtils.isChangeGateEnabled("ShouldNotRetryOnSessionClosedError").then((e=>{this.shouldNotRetryOnSessionClosedError=e})).catch((()=>{})))}setState(e,t,o){if(this.state&&e===this.state.stateName)return;const i=this.state?y[this.state.stateName]:"undefined",n=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===y.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${n?y[e]:i}`,this.logOp.resultDescription=`Previous state: ${i}`,this.logOp.dimension0=`Attempted state: ${y[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!n?"Unexpected state change":""),this.logOp.success=n,a.tG.info(508843791,a.nh.CoreDefault,this.logOp)})),n&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(o))}init(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,o){this.retrySendMessage(e,t,J.maxRetries,o)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}getNetworkWorkerManager(){return this.networkWorkerManager}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.networkWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.networkWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(e){this.sendMessage(new S.w9),this.networkWorkerManager.close(!0);const t=e||new S.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new S.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}ingress(e,t){let o;try{o=JSON.parse(e)}catch(e){a.tG.error(508843790,a.nh.CoreDefault,new s.I({operationName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0}))}if(o){if(t&&S.YK.typeGuard(o)&&t(o),this.networkWorkerManager.getNetworkMode()===V.yv.HttpFallback&&S.ry.typeGuard(o)){const e=o;if(e.batch)for(const t of e.batch)this.messageEndpoint.ingress(t,((e,t)=>this.egress(e||t,(()=>{}))));return}this.messageEndpoint.ingress(o,((e,t)=>this.egress(e||t,(()=>{}))))}}egress(e,t,o){e&&this.networkWorkerManager.egress(e,o).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.networkWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(y.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=_.Aq.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,o,i,n){const r=J.maxRetries-o;this.state.sendMessage(e,((l,c)=>{var u,d,h,g,p,f;n&&(l&&0==o?(n.dimension0=(r+1).toString(),n.success=!1,a.tG.info(507025311,a.nh.CoreDefault,n.stop())):l&&o>0?(n.dimension0=(r+1).toString(),n.dimension1=null!==(d=null===(u=l.code)||void 0===u?void 0:u.toString())&&void 0!==d?d:"NoErrorCode",n.resultSignature=null!==(h=l.error)&&void 0!==h?h:"NoErrorMessage"):(n.success=!0,a.tG.info(507025310,a.nh.CoreDefault,n.stop()))),l&&o>0&&this.canBeRetried(e)&&this.isTransientError(l)?(this.logRetryTelemetry&&!n&&((n=new s.I({operationName:"RetrySendMessage",success:!0,dimension0:(r+1).toString()}).start()).resourceId=T.h.getTypeNameFor(e),n.dimension1=null!==(p=null===(g=l.code)||void 0===g?void 0:g.toString())&&void 0!==p?p:"NoErrorCode",n.resultSignature=null!==(f=l.error)&&void 0!==f?f:"NoErrorMessage",n.resultDescription=`Retrying message with messageId: ${e.messageId}${S.Tb.typeGuard(e)?`, seq: ${e.seq}`:""}`),T.h.matchesTypesFor(l,[S.ru.getTypeName()])&&this.networkWorkerManager.onRateLimitErrorResponse(l),this.retrySendMessage(e,t,o-1,i,n)):t&&t(l,c)}),r,i)}canBeRetried(e){return!T.h.matchesTypesFor(e,[S.eE.getTypeName(),S.VR.getTypeName(),K.x5.getTypeName()])}isTransientError(e){const t=e.error,o=e.code;return!(this.isImproveRetriesChangeGateEnabled&&o===k.xv.TokenValidationError||o===k.xv.TokenDecryptError||o===k.xv.SyncMessageTooLateOrDuplicate||this.shouldNotRetryOnSessionClosedError&&o===k.xv.Gone)&&t!==C.Ef.SyncMessageUnsupportedBatch&&t!==C.Ef.UnexpectedSeedMessage&&t!==C.Ef.UnsupportedSyncMessage&&t!==C.Ef.AnnotationTokenNotFound&&t!==b.ArrivedBeforeReseeding&&t!==b.DroppedAsOldestInQueue&&t!==b.DroppedBecauseClientDisconnected}}J.maxRetries=2;var Y=o(78473);class Q{}var Z,X=o(13674),ee=o(19286),te=o(38238);!function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(Z||(Z={}));class oe{constructor(){this.timers=new Map}scheduleRefresh(e,t,o,i){let n=this.timers.get(e);n||(n={numberOfAttempts:0},this.timers.set(e,n)),n.refreshTimeoutId&&(clearTimeout(n.refreshTimeoutId),n.refreshTimeoutId=void 0),n.expiredTimeoutId&&(clearTimeout(n.expiredTimeoutId),n.expiredTimeoutId=void 0);let r=1e3*t-oe.tokenRefreshBufferMs,s=1e3*t-oe.tokenExpirationBufferMs;r>0?n.numberOfAttempts=0:(++n.numberOfAttempts,r=oe.tokenRefreshBackoffIntervalMs,s=oe.tokenExpirationBufferMs),n.numberOfAttempts<=oe.tokenRefreshMaximumAttempts&&(n.refreshTimeoutId=setTimeout((()=>{o()}),r)),i&&(n.expiredTimeoutId=setTimeout((()=>{i()}),s))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,o)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(o)}))}}oe.tokenRefreshBufferMs=24e4,oe.tokenExpirationBufferMs=12e4,oe.tokenRefreshBackoffIntervalMs=3e4,oe.tokenRefreshMaximumAttempts=3;class ie extends x.EventEmitter{constructor(e,t,o,i,n){if(super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=o,this.sendMessage=i,this.options=n||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e),this.clientMetadata&&!this.clientMetadata.userSystemTimezone)try{this.clientMetadata.userSystemTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=_.Aq.getCurrentTimeMs(),o=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,i=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,n=new s.I({operationName:"SessionInit"}).start(),r={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:o,timeSinceLastSyncMessage:i,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0,isSeedingRequired:void 0},l=this.options.overrideSessionInitMessage(new S.eE({protocolVersion:k.mH,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification}));this.sendMessage(l,((t,o)=>{if(n.success=!t,n.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",n.resourceId=d(null==o?void 0:o.sliceUrl),n.setClientMetadata(this.clientMetadata),(null==o?void 0:o.sessionKey)&&r.sessionKey!==o.sessionKey&&(r.sessionKey=o.sessionKey),t&&(r.error=t.error),r.isSeedingRequired=this.sessionKey!==(null==o?void 0:o.sessionKey),n.resultDescription=JSON.stringify(r),a.tG.info(508843779,a.nh.CoreDefault,n.stop()),e.onResponse(t,o),t)this.emit("serverAuthenticationStateChange",X.f.NotAuthenticated);else if(e.isReconnectOnSameSlice&&o.forceReconnect)this.emit("serverAuthenticationStateChange",X.f.NotAuthenticated);else{if(!o.anonymousToken||!o.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",X.f.NotAuthenticated),void a.tG.error(508843778,a.nh.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=o.anonymousToken,this.onSuccessfulSessionInitOnServerSide(o)}}))}onSuccessfulSessionInitOnServerSide(e){var t,o;this.tokenRefreshManager.scheduleRefresh(Z.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.connectParams={isSeedingRequired:this.sessionKey!==e.sessionKey,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,origin:e.origin,authToken:this.anonymousToken},(null===(t=this.options)||void 0===t?void 0:t.dontSendTokenOnReconnectChangeGate)&&e.existingTokenProvisionResponse&&(null===(o=e.existingTokenProvisionResponse)||void 0===o?void 0:o.tokenType)===ee.OY.AugLoopLowPrivilege||(this.options.sendTokenFailureMessageChangeGate?this.initHostAuthTokenNew().catch((()=>{})):this.initHostAuthToken());const i=!!this.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",this.connectParams.isSeedingRequired,i,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,e.workflowInputTypes,e.downstreamRuntimeWorkflows),i&&this.emit("reconnect")}getAuthToken(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:te.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e)).catch((()=>{}))}getAuthTokenNew(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:te.OY.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e))}getAuthTokenTimeoutPromise(){const e=this.options.authTokenTimeoutMs;return new Promise(((t,o)=>{setTimeout((()=>{o(new Error(`Host auth token provision took longer than ${e} ms`))}),e)}))}initHostAuthToken(){const e=this.getAuthToken.bind(this);if(this.options.requestAuthToken&&e){const t=new s.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();e().then((e=>{if(e){if(!e.Token)return e.TokenError==te.Pu.TokenMissingInteractionRequired?(this.emit("serverAuthenticationStateChange",X.f.TokenMissingInteractionRequired),t.resultDescription="Host auth token provision failed interaction required"):(this.emit("serverAuthenticationStateChange",X.f.NotAuthenticated),t.resultDescription="Host auth token provision failed"),t.success=!1,void a.tG.info(508843777,a.nh.CoreDefault,t.stop());a.tG.info(508843776,a.nh.CoreDefault,t.stop()),this.sendTokenProvisionMessage(e.Token)}else t.resultDescription="TokenResponse is not set"})).catch((e=>{this.emit("serverAuthenticationStateChange",X.f.NotAuthenticated),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`,a.tG.error(508843747,a.nh.CoreDefault,t.stop())}))}}initHostAuthTokenNew(){return e=this,t=void 0,i=function*(){const e=this.getAuthTokenNew.bind(this);if(this.options.requestAuthToken&&e){const t=new s.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();let o,i,n=X.f.NotAuthenticated;try{if(o=this.options.authTokenTimeoutMs>0?yield Promise.race([e(),this.getAuthTokenTimeoutPromise()]):yield e(),!o)throw new Error("TokenResponse is not set");if(!o.Token)throw o.TokenError==te.Pu.TokenMissingInteractionRequired?(n=X.f.TokenMissingInteractionRequired,new Error("Host auth token provision failed interaction required")):new Error("Host auth token provision failed")}catch(e){i=e.message,this.emit("serverAuthenticationStateChange",n),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`}try{i?this.sendMessage(new S.D0({reason:i,version:ie.initialTokenVersion,clientHandlesResponse:!0})):this.sendTokenProvisionMessage(o.Token)}catch(e){i||(i=e.message,this.emit("serverAuthenticationStateChange",n),t.success=!1,t.resultDescription=`Error happened while attempting to send host token: ${e}`)}finally{i?a.tG.error(506074845,a.nh.CoreDefault,t.stop()):a.tG.info(506074846,a.nh.CoreDefault,t.stop())}}},new((o=void 0)||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}));var e,t,o,i}sendTokenProvisionMessage(e){const t=new S.kd({authToken:e,version:ie.initialTokenVersion});this.emit("serverAuthenticationStateChange",X.f.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){if(e||!t||!t.tokenExpirationSeconds)return void this.emit("serverAuthenticationStateChange",X.f.NotAuthenticated);const o=t.tokenType&&t.tokenType==ee.OY.WacUserInfo?X.f.WacUserInfoAuthenticated:X.f.Authenticated;this.emit("serverAuthenticationStateChange",o),this.tokenRefreshManager.scheduleRefresh(Z.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))}}ie.initialTokenVersion=1;var ne,re=o(70460),se=o(31733),ae=o(44882),le=o(99795),ce=o(67336),ue=o(65920),de=o(719),he=o(13912),ge=o(22162),pe=o(19231),fe=o(41450),me=o(1895),ve=o(15210),be=o(79938),ye=o(78449),we=o(10510),Ce=o(16230);!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(ne||(ne={}));class Se{constructor(e,t,o){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,o)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,o):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,o)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,o):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,o.enableDeltas&&(this.deltaHandlers=(new Map).set(T.h.getTypeNameFor(ye.Q),pe.MM).set(T.h.getTypeNameFor(ye.s),pe.a4),this.itemsForDelta=new Map),this.enableEarlyJoin=o.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const o=new s.I({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes((0,be.v)(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGraph(e),o.setClientMetadata(t.getClientMetadata())):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,o)=>{t.push(this.createWorkflowImplementation(e,o))}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,o)=>{o.registerContextTypes((0,be.v)(e.requestedContextTypesRules).map((([e,t])=>e))),o.attachToWorkflowGraph(e)}))),o.success=!0,a.tG.info(572838110,a.nh.CoreDefault,o.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),t.map((e=>e.workflow))}getWorkflowDefinitionsByName(e){var t;const o=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>o.set(e.workflow.id,e.workflow))),o}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,o){const i=e.getWorkflowNodes(),n=this.executionTrackersByWorkflowNameBySession.get(t),r=(e,i)=>{o&&o(e,i),this.enableEarlyJoin&&(()=>{for(const e of this.executionTrackersByWorkflowNameBySession.get(t).values())if(e.graphNode.workflow.kind===ue.wC.Join)for(const t of e.getExecutionState().keys())if(fe.a4.isParentContextId(t,i))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())};for(const e of i){const t=n.get(e.workflow.id),o=new Ce.g(e,r.bind(this),t);n.set(e.workflow.id,o)}for(const e of n.values())this.setDownstreamWorkflowExecutionTrackers(e,n),this.setUpstreamWorkflowExecutionTrackers(e,n)}canActivateWorkflow(e,t){var o;return e.location===me.aZ.Local||!!t.hasConnected&&!((null===(o=e.workflow.requiredTokenTypes)||void 0===o?void 0:o.length)>0&&t.getServerAuthenticationState()===X.f.NotAuthenticated)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:o}=e;for(const i of o.downstreamWorkflows||[]){const o=t.get(i.workflow.id);this.setDownstreamWorkflowExecutionTrackers(o,t),e.downstreamWorkflowExecutionTrackers.add(o)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:o}=e;for(const i of o.upstreamWorkflows||[]){const o=t.get(i.workflow.id);this.setUpstreamWorkflowExecutionTrackers(o,t),e.upstreamWorkflowExecutionTrackers.add(o)}}deactivateServerWorkflow(e,t){var o;e.location!==me.aZ.Local&&(null===(o=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===o||o.get(e.workflow.id).clearWorkflowExecutions(),e.isActivated=!1)}addSession(e){this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const o of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(o)),e.attachToWorkflowGraph(o);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,o){const i=this.executionTrackersByWorkflowNameBySession.get(o).get(e.id);e.kind===ue.wC.Join&&T.h.matchesTypesFor(t.body,e.inputTypes)&&i.addInputItemToProcess(t.contextId),(e.kind===ue.wC.SingleItem&&T.h.matchesTypesFor(t.body,e.inputTypes)||e.kind===ue.wC.Join&&T.h.matchesTypesFor(t.body,[e.collectionScopeType]))&&i.beforeWorkflowExecution(t.contextId)}isReadyToEarlyJoin(e,t,o){const i=i=>{var n;const r=Array.from(null!==(n=i.states)&&void 0!==n?n:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),l=new s.I({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();l.setClientMetadata(o),l.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${i.hasProcessedAllInputItems}, allUpstreamComplete: ${i.allUpstreamComplete}, states: ${r}`,a.tG.info(512550800,a.nh.CoreDefault,l.stop())},n=0===e.countItemsToProcess(t);if(!n)return this.enableEarlyJoin||i({hasProcessedAllInputItems:n}),!1;const{allUpstreamComplete:r,states:l}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?r:(i({hasProcessedAllInputItems:n,allUpstreamComplete:r,states:l}),!1)}areAllUpstreamWorkflowComplete(e,t){const o=new Map;for(const i of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[n,r]of i.getExecutionState())if(e.push([n,r]),fe.a4.isParentContextId(t,n))return o.set(i.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:o};e.length>0&&o.set(i.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:o}}runLocalWorkflows(e,t,o=!1){var i,n,r;const l=(e,o,i)=>{var n,r;const l=t.getWorkflowItemStorage(),{workflow:c}=e,u=null===(n=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===n?void 0:n.get(c.id),d=c.inputTypes.concat(c.kind===ue.wC.Join?c.collectionScopeType:[]),h=new s.I({operationName:"RunLocalWorkflows",success:!0,resourceId:c.id,joinContextId:o.contextId}).start();if(h.setClientMetadata(t.getClientMetadata()),T.h.matchesTypesFor(o.body,d)){const n=(0,we.CY)(i.parentPath,o);if(c.kind===ue.wC.Join){if(T.h.matchesTypesFor(n.body,[c.collectionScopeType]))return l.setScopeItem(n,c),h.resultDescription=`Scope item: ${o.id} (${T.h.getTypeNameFor(o.body)})`,a.tG.info(524126153,a.nh.CoreDefault,h.stop()),void this.setScopeExecutionNotification(t,e,n);{u.removeProcessedInputItem(n.contextId);const e=l.getScopeItem(n.contextId,c);if(!e)return h.resultDescription=`Filtered out join invalidation: out of scope type (${c.collectionScopeType}), item id: ${n.id}`,void a.tG.info(541173894,a.nh.CoreDefault,h.stop());l.addItemToWorkflowList(n,c),h.joinContextId=e.contextId,h.resultDescription=`Input item: ${o.id} (${T.h.getTypeNameFor(o.body)})`}}if(T.h.getBaseTypesFor(n.body).indexOf(re.W1.getTypeName())>=0){const e=[...n.parentPath,n.id];let o=!0;for(const i of null!==(r=c.outputTypes)&&void 0!==r?r:[])if(!t.getContextAnnotations(i,Y.vd.LocalWorkflow,e,c.id)){o=!1;break}if(o)return}const s=()=>{var i;const[r,d]=t.resolveRequestedContexts(c);if(!r)return h.resultDescription=`Required contexts are not ready for ${c.id}. Retrying execution in 500 milliseconds...`,a.tG.info(545837259,a.nh.CoreDefault,h.stop()),void setTimeout(s,500);if(c.kind===ue.wC.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:n,inputItems:[n],requestedContexts:d,session:t,triggerReason:ne.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,n,c,t)}).then((()=>{a.tG.info(509154263,a.nh.WorkflowDefault,h.stop())})).catch((e=>{h.resultDescription=e,a.tG.error(572838111,a.nh.CoreDefault,h.stop())}));else if(c.kind===ue.wC.Join){const n=o.contextId,r=l.getScopeItem(n,e.workflow);if(!r)return h.resultDescription=`No scope item for ${c.id} workflow from contextId ${n}`,void a.tG.info(526758475,a.nh.CoreDefault,h.stop());const s=this.isReadyToEarlyJoin(u,r.contextId,t.getClientMetadata()),g=s?ne.JoinEarlyCompletion:ne.JoinMaxAnnnotation;if(l.isWorkflowReady(r.contextId,c)||s){if(!(null===(i=this.pendingScopeExecutionNotificationsByWorkflow.get(c.id))||void 0===i?void 0:i.get(r.contextId)))return h.resultDescription=`Workflow ${c.id}, contextId ${r.contextId}, already queued, skipping new scope execution`,void a.tG.info(528048977,a.nh.CoreDefault,h.stop());const o=l.getItemsToExecute(r.contextId,c);this.queueWorkflow({workflowInfo:e,scopeItem:r,inputItems:o,requestedContexts:d,session:t,triggerReason:g,onCompleteCallback:this.onWorkflowExecuted.bind(this,r,c,t)}).then((()=>{a.tG.info(509154262,a.nh.WorkflowDefault,h.stop())})).catch((e=>{h.resultDescription=e,a.tG.error(541173895,a.nh.CoreDefault,h.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(c.id).delete(r.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(c.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(c.id)}}};s()}};let c=e;o&&(c=[new se.Xr({parentPath:["session"],items:[{id:"#userContext#",body:new re.hD}]}),new se.Xr({parentPath:["session"],items:[{id:"#tenantContext#",body:new re.SB}]})],t.getContextIdManager().applyContextIdOnOperations(c),c=c.concat(e));for(const e of c){const o=T.h.getTypeNameFor(e);for(const s of e.items)if(t.applyOperationForContext(e,s,Y.vd.Submitted),o!==se.n4.getTypeName()){if(s.body)if(o===se.xU.getTypeName()&&this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(s,e,t);else{null===(n=this.itemsForDelta)||void 0===n||n.set(e.parentPath.concat(s.id).toString(),s);for(const t of this.workflowsWithoutSessionAffinity)l(t,s,e);for(const o of null!==(r=this.workflowsWithSessionAffinity.get(t))&&void 0!==r?r:[])l(o,s,e)}}else null===(i=this.itemsForDelta)||void 0===i||i.delete(e.parentPath.concat(s.id).toString())}}handleLocalDeltaUpdate(e,t,o){const i=new s.I({operationName:"LocalDeltaUpdate",dimension0:T.h.getTypeNameFor(e.body),success:!0});i.start();try{const n=this.deltaHandlers.get(T.h.getTypeNameFor(e.body)),r=this.itemsForDelta.get(t.parentPath.toString());if(n&&r){const s=t.parentPath.length>0?t.parentPath.slice(0,t.parentPath.length-1):t.parentPath,l=n(e.body,r.body);if(l){const t={id:r.id,revId:e.revId,body:l,parentPath:s,delta:e.body,contextId:e.contextId},n=new se.I({parentPath:t.parentPath,items:[t]});a.tG.info(539637591,a.nh.CoreDefault,i.stop()),this.runLocalWorkflows([n],o)}else i.success=!1,i.resultDescription="Failed because the handler did not produce valid updated item",a.tG.info(539637592,a.nh.CoreDefault,i.stop())}else i.success=!1,i.resultDescription="Failed due to lack of handler or parent item",a.tG.info(539637593,a.nh.CoreDefault,i.stop())}catch(e){i.success=!1,i.resultDescription=`Failed to apply delta, error: ${e}`,a.tG.info(539637594,a.nh.CoreDefault,i.stop())}}createWorkflowImplementation(e,t){const o=e.factory();return{workflow:e,workflowLambda:o,initPromise:this.initWorkflow(e.kind,o,t)}}initWorkflow(e,t,o){const i=new ve.I({model:void 0,clientMetadata:o?o.getClientMetadata():void 0,userContext:o?o.getUserContext():void 0,site:this.site,getTokenCallback:this.getAuthTokenCallback});return e===ue.wC.SingleItem||e===ue.wC.Join?t.init(this.site,i):Promise.resolve()}queueWorkflow(e){return this.executionTrackersByWorkflowNameBySession.get(e.session).get(e.workflowInfo.workflow.id).setExecutionState(e.scopeItem.contextId,fe.si.Running),this.executeLocalWorkflow(e.workflowInfo,e.scopeItem,e.inputItems,e.session,e.requestedContexts,e.triggerReason).then((t=>{this.processAnnotationResults(t,e.session),e.onCompleteCallback()})).catch((t=>{throw e.onCompleteCallback(),t}))}processAnnotationResults(e,t){for(const o of e)t.onAnnotationResults(o,Y.vd.LocalWorkflow,(()=>{}))}executeLocalWorkflow(e,t,o,i,n,r){return new Promise(((l,c)=>{var u,d,h;const g=[],p=e.workflow,f=new s.I({operationName:"ExecuteWorkflow",resourceId:p.id,joinContextId:null!==(u=null==t?void 0:t.contextId)&&void 0!==u?u:"",resultDescription:null!=r?r:"",success:!0}).setClientMetadata(i.getClientMetadata());f.start();const m=null!==(d=null==t?void 0:t.contextId)&&void 0!==d?d:o[0].contextId,v=null!==(h=null==t?void 0:t.revId)&&void 0!==h?h:o[0].revId,b=(()=>{const e=new Map;if(t&&(t.parentPath||a.tG.error(525382231,a.nh.CoreDefault,`Missing scope item parent. Workflow: ${p.id}. Type: ${T.h.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(o))for(const t of o)t&&t.body&&(t.parentPath||a.tG.error(525382232,a.nh.CoreDefault,`Missing parent. Workflow: ${p.id}. Type: ${T.h.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),y=(e,t=f)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",a.tG.error(572838112,a.nh.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;a.tG.info(572838113,a.nh.CoreDefault,t.stop())},w=new ve.I({model:new ge.B(o[0],n),clientMetadata:i.getClientMetadata(),userContext:i.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback}),C=e=>{y(e?e.message:void 0),e?c(e):l(g)},k={setAnnotations:(n,r,l,u)=>{var d;const h=new s.I({operationName:"SetAnnotations",resourceId:r,joinContextId:null!==(d=null==t?void 0:t.contextId)&&void 0!==d?d:"",success:!0}).setClientMetadata(i.getClientMetadata());h.start();const f=t=>{a.tG.info(555866112,a.nh.CoreDefault,new he.v({annotationType:r,annotationState:t,workflowId:e.workflow.id}))};for(const e of l)e.metadata=Object.assign(Object.assign({},e.metadata),{state:ae.r.Created}),f(ae.r.Created);const w=b.get(n),C=T.h.getTypeNameFor(w.body),k=(()=>{var e;if(p.kind===ue.wC.SingleItem&&o[0].body!==n){const e=`Expected obj to be ${o[0].body} but instead it was ${n}`;return y(e,h),void c(y(e))}let t,s;if(Array.isArray(l))if(!p.outputTypes||p.outputTypes.indexOf(r)<0)t=`Workflow said it would output one of [${p.outputTypes}] but instead output ${r}`;else if(w)for(const e of l)T.h.matchesTypesFor(e,[le.YH.getTypeName()])?T.h.getTypeNameFor(e)!==r&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${T.h.getTypeNameFor(e)} did not match expected ${r})`):t=`Workflow produced an output that is not an annotation ${T.h.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return y(t,h),void c(y(t));s=u&&u.isSessionAnnotation?["session"]:u&&u.ancestorType?w.parentPath:w.parentPath.concat(w.id);const d=[],g=[];for(const t of l){t.metadata=Object.assign(Object.assign({},t.metadata),{state:ae.r.Sent}),f(ae.r.Sent);const o=t.id,n=o?null===(e=i.getContextAnnotations(r,Y.vd.LocalWorkflow,s,p.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==o})):void 0;1==(null==n?void 0:n.length)?1==n.length?g.push({id:n[0].id,source:p.id,revId:v,body:t,contextId:m}):a.tG.error(545837260,a.nh.CoreDefault,`Assert: Multiple existing context annotations with body id ${o} found for ${r} and local workflow ${p.id}).`):d.push({id:this.getNextClientAnnotationId(),source:p.id,revId:v,body:t,contextId:m})}const b=[];return d.length>0&&b.push(new se.Xr({parentPath:s,items:d,parentRevId:v})),g.length>0&&b.push(new se.fZ({parentPath:s,items:g,parentRevId:v})),new S.B_({annotationType:r,ops:b})})();k?(u&&u.immediate?i.onAnnotationResults(k,Y.vd.LocalWorkflow,(()=>{})):g.push(k),(C==re.hD.getTypeName()||C==re.SB.getTypeName()||T.h.matchesTypesFor(w.body,[re.yo.getTypeName(),re.I3.getTypeName()]))&&i.submitOperationsToSession(k.ops),a.tG.info(509644822,a.nh.CoreDefault,h.stop())):a.tG.info(509644823,a.nh.CoreDefault,h.stop())},submitSignals:e=>{const t=new s.I({operationName:"submitSignalsAction",resourceId:p.id,success:!0}).setClientMetadata(i.getClientMetadata());for(const o of e){const e=T.h.getTypeNameFor(o);T.h.matchesTypesFor(o,[ce.HN.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${T.h.getTypeNameFor(o)})`,a.tG.info(521413954,a.nh.CoreDefault,t)),p.outputTypes&&-1!==p.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${p.outputTypes}] but instead output ${e}`,a.tG.info(521413953,a.nh.CoreDefault,t)),o.timestamp&&(Se.logTimestampUsageByWorkflowId.has(p.id)||(Se.logTimestampUsageByWorkflowId.add(p.id),t.resultDescription=`Workflow "${p.id}" sets signal.timeStamp`,a.tG.info(509212803,a.nh.CoreDefault,t)))}const o=e.map((e=>({id:this.getNextClientSignalId(),source:p.id,revId:v,body:e,contextId:m}))),n=new se.g0({parentPath:["session"],parentRevId:v,items:o});i.submitOperations([n])},done:C,overrideWorkflowDefinition:(e,o,n)=>{let r;switch(n){case de.T.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw a.tG.error(527472289,a.nh.CoreDefault,e),new Error(e)}r=t.contextId;break;case de.T.Session:r=void 0;break;default:{const e="Defined scope is not supported. "+n;throw a.tG.error(527472290,a.nh.CoreDefault,e),new Error(e)}}const s=new K.Qr({definition:o,contextId:r,sourceWorkflowId:p.id,targetWorkflowId:e});i.onWorkflowDefinitionOverrideMessage(s)},getDynamicAnnotations:void 0,setBillingDomain:void 0},x=e.workflowLambda;if(p.kind===ue.wC.SingleItem){1!==o.length&&C(new Error("Single item workflows expect a single input")),w.delta=o[0].delta,w.deltas=o[0].deltas;try{const t=x;e.initPromise||(e.initPromise=t.init(this.site,w)),e.initPromise.then((()=>{t.execute(o[0].body,w,k)})).catch((e=>{y(e)}))}catch(e){y(e)}}else if(p.kind===ue.wC.Join){0===o.length&&C(new Error("Join workflows expect an inputs array")),w.delta=t.delta,w.deltas=t.deltas;try{const i=x;e.initPromise||(e.initPromise=i.init(this.site,w)),e.initPromise.then((()=>{i.execute(t.body,o.map((e=>e.body)),w,k)})).catch((e=>{y(e)}))}catch(e){y(e)}}else y(`Workflow kind ${p.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,o){var i,n;const r=Date.now(),l={session:e,workflowImplementation:t,scopeItem:o,startTime:r,minTime:r+(0,_.ZF)(t.workflow.minDelayMs,1e3),maxTime:r+(0,_.ZF)(t.workflow.maxDelayMs,5e3)},c=t.workflow.kind===ue.wC.Join?o.contextId:l.scopeItem.parentPath.concat(o.id).join("\\");if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(c)){const i=new s.I({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${c}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(n=null==o?void 0:o.contextId)&&void 0!==n?n:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();a.tG.info(509727899,a.nh.CoreDefault,i.stop())}else{const n=new s.I({resultDescription:`New pending scope execution for ${t.workflow.id} at ${c}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(i=null==o?void 0:o.contextId)&&void 0!==i?i:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();a.tG.info(539883075,a.nh.CoreDefault,n.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(c,l)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const o=new Set(Array.from(this.sweepTimers.keys()));for(const[i,n]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[r,l]of Array.from(n.entries())){const{session:n,workflowImplementation:{workflow:c}}=l,u=n.getWorkflowItemStorage(),d=new s.I({operationName:"LocalScopeExecutionNotification",resourceId:c.id,joinContextId:null!==(t=null===(e=l.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(n.getClientMetadata()).start(),h=()=>{if(c.kind===ue.wC.Join){const e=Date.now(),{workflow:t}=l.workflowImplementation,o=l.scopeItem.contextId,i=n.getWorkflowDefinition(t,o).maxDelayMs;return u.isWorkflowReady(o,t)?(d.resultDescription=`Join Workflow: ${t.id} queuing by maxAnnotation, contextId: ${o}`,a.tG.info(528048978,a.nh.CoreDefault,d.stop()),{isValid:!0,triggerReason:ne.JoinMaxAnnnotation}):l.startTime+i<e?(d.resultDescription=`Join Workflow: ${t.id} queuing by maxTimeout, contextId: ${o}`,a.tG.info(528048979,a.nh.CoreDefault,d.stop()),{isValid:!0,triggerReason:ne.JoinMaxTimeout}):this.isReadyToEarlyJoin(this.executionTrackersByWorkflowNameBySession.get(n).get(t.id),o,n.getClientMetadata())?(a.tG.info(512550856,a.nh.CoreDefault,`Workflow: ${t.id} queuing by early completion, contextId: ${o}, timeout: ${i}`),{isValid:!0,triggerReason:ne.JoinEarlyCompletion}):{isValid:!1,triggerReason:ne.Unknown}}return{isValid:!0,triggerReason:ne.Unknown}};(()=>{const{isValid:e,triggerReason:t}=h();if(!e)return!1;const[o,i]=n.resolveRequestedContexts(c);if(!o)return!1;try{if(c.kind===ue.wC.Join){const e=l.scopeItem.contextId,o=u.getScopeItem(e,c);if(o){const r=u.getItemsToExecute(o.contextId,c);if(0===r.length)return d.resultDescription=`Failed to retrieve items for workflow: ${c.id}, contextId: ${e}, skipping execution`,a.tG.info(527472291,a.nh.CoreDefault,d.stop()),this.onWorkflowExecuted(o,c,n),!0;this.queueWorkflow({workflowInfo:l.workflowImplementation,scopeItem:o,inputItems:r,requestedContexts:i,session:n,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,o,c,n)}).catch((e=>{d.success=!1,d.resultDescription=e.message,a.tG.error(509092189,a.nh.CoreDefault,d.stop())}))}else d.resultDescription="ContextId no longer exists, skipping workflow execution",a.tG.info(539883076,a.nh.CoreDefault,d.stop())}else d.resultDescription=`Workflow in type ${c.kind} is not supported`,a.tG.error(539883077,a.nh.CoreDefault,d.stop())}catch(e){d.resultDescription=`Trying to execute ${c.id} caused an exception: ${e}`,a.tG.warn(539883078,a.nh.CoreDefault,d.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(i).delete(r),0===this.pendingScopeExecutionNotificationsByWorkflow.get(i).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(i)):o.delete(n)}if(0!==o.size)for(const e of Array.from(o)){const t=new s.I({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();a.tG.debug(539883079,a.nh.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,o){const i={id:"",parentPath:[],contextId:e},n={id:t};this.onWorkflowExecuted(i,n,o,!1)}onWorkflowExecuted(e,t,o,i=!0){var n;null===(n=this.executionTrackersByWorkflowNameBySession.get(o).get(t.id))||void 0===n||n.afterWorkflowExecution(e.contextId),i&&t.kind===ue.wC.Join&&o.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}var ke=o(95732),Te=o(82971);class xe{constructor(e,t,o){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new ke.Z,this.unorderedAnnotationResultsProcessor=null!=o?o:new Te._}process(e,t,o,i){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,o,i):this.unorderedAnnotationResultsProcessor.process(e,t,o,i)}}var _e=o(93692),Ie=o(38178),Ee=o(23442),Be=o(18583),Ae=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class Re{constructor(e,t){this.changeGatesInitialized=!1,this.hostCallbacks=e,this.changeGateMap=t||new Map}init(){return Ae(this,void 0,void 0,(function*(){const e=[];this.hostCallbacks&&this.hostCallbacks.isChangeGateEnabled&&this.changeGateMap.forEach(((t,o)=>{e.push(this.hostCallbacks.isChangeGateEnabled(o).then((e=>{this.changeGateMap.set(o,e)})))})),yield Promise.all(e).then((()=>{this.changeGatesInitialized=!0})).catch((e=>{}))}))}isFeatureEnabled(e,t=!1,o="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled(e,o).catch((()=>Promise.resolve(t))):Promise.resolve(t)}isChangeGateEnabled(e){var t;return Ae(this,void 0,void 0,(function*(){return!this.changeGateMap||(this.changeGatesInitialized&&this.changeGateMap.has(e)?this.changeGateMap.get(e):!(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled))||(yield this.hostCallbacks.isChangeGateEnabled(e)))}))}isChangeGateEnabledSync(e){var t;if(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled)){const t=new s.I({operationName:"GateUtilsNotInitialized",success:!1,resultDescription:`${e}`});a.tG.error(505529628,a.nh.CoreDefault,t)}return!this.changeGateMap||!this.changeGatesInitialized||!this.changeGateMap.has(e)||this.changeGateMap.get(e)}isChangeGatesInitialized(){return this.changeGatesInitialized}getChangeGateMap(){return this.changeGateMap}}var Me=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const De="CloseSessionsOnRuntimeUninit",Pe="ShouldAppendClientFeatureFlights",Fe="DontSendNewTokenOnReconnect",Oe="WebSocketWorkerShouldLogEgressCount",Ne="FixIncorrectInvocationOfClaimsCallbacks";class qe{constructor(e,t,o,i){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.telemetryLogger=null,this.changeGateList=new Map([["SkipCheckingCachedClaimsChallenge",!0],["LogRetryMessageEvent",!0],["ImproveClientRetries",!0],["ShouldNotRetryOnSessionClosedError",!0],[De,!0],[Pe,!0],[Fe,!0],[Oe,!0],[Ne,!0]]),this.settings={annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,reduceBatchOperationsEnabled:!1,batchMessagesEnabled:!1,dynamicRateControllerEnabled:!1,removeDuplicateFlights:!0,annotationDoesNotExistOnService:!0,reducedPingPongRetryEnabled:!1,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:!1,sendTokenFailureMessage:!0,closeSessionsOnRuntimeUninit:!1,shouldAppendClientFeatureFlights:!0,authTokenTimeoutMs:0,doNotSendNewTokenOnReconnect:!1,webSocketWorkerShouldLogEgressCount:!0},this.settingToChangeGateName={closeSessionsOnRuntimeUninit:De,shouldAppendClientFeatureFlights:Pe,doNotSendNewTokenOnReconnect:Fe,webSocketWorkerShouldLogEgressCount:Oe},this.isDownloaderCompatible=()=>"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL,i&&(this.settings=i),this.workerFactory=e||(e=>e&&e===V.yv.HttpFallback?new Be.Z:new v(void 0,this.settings));const n=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||n(...e),this.sessionFactory=o||(e=>new Y.po(e))}init(e,t,i,n){var l,u,g,p,f,m,v,b,y,w;const C=new s.I({operationName:"InitRuntime",resourceId:d(e),dimension1:this.hasBeenInitialized.toString()});C.start(),this.hasBeenInitialized=!0,this.hostCallbacks=i,this.gateUtils=new Re(this.hostCallbacks,this.changeGateList),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=o(81264).r),this.telemetryLogger=new h(this.hostCallbacks),this.shouldAddLogger(C)?(a.tG.addLogger(this.telemetryLogger),this.addLoggingAggregator(n)):(a.tG.clearLoggers(),a.tG.addLogger(this.telemetryLogger)),qe.haveCalledInit=!0,this.annotationResultsProcessor=new xe((()=>this.settings.annotationsOrderingEnabled)),this.inferenceServiceFactory=n.inferenceServiceFactory,C.dimension2=(0,a.OD)(r.q.info).toString();const S=[];e&&(this.defaultServiceUrl=_.Aq.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),S.push(this.gateUtils.init().then((()=>Me(this,void 0,void 0,(function*(){yield Promise.all(Object.keys(this.settingToChangeGateName).map((e=>Me(this,void 0,void 0,(function*(){try{const t=yield this.gateUtils.isChangeGateEnabled(this.settingToChangeGateName[e]);this.settings[e]=t}catch(t){this.settings[e]=!1}})))))}))))),S.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then((e=>{this.settings.annotationsOrderingEnabled=e}))),S.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),S.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)}))),S.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then((e=>{var t;(t=this.settings).onAnnotationsSubmittedEnabled&&(t.onAnnotationsSubmittedEnabled=!e)}))),S.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then((e=>{var t;(t=this.settings).reduceBatchOperationsEnabled||(t.reduceBatchOperationsEnabled=e)}))),S.push(this.isFeatureEnabled("BatchMessagesEnabled").then((e=>{var t;(t=this.settings).batchMessagesEnabled||(t.batchMessagesEnabled=e)}))),S.push(_.Aq.isChangeGateEnabled(this.hostCallbacks,"DynamicRateControllerEnabled").then((e=>{this.settings.dynamicRateControllerEnabled=e}))),S.push(_.Aq.isChangeGateEnabled(this.hostCallbacks,"AnnotationDoesNotExistOnService").then((e=>{this.settings.annotationDoesNotExistOnService=e}))),S.push(_.Aq.isFeatureEnabled(this.hostCallbacks,"ReducedPingPongRetryEnabled").then((e=>{var t;(t=this.settings).reducedPingPongRetryEnabled||(t.reducedPingPongRetryEnabled=e)}))),S.push(this.isFeatureEnabled("MaxNumberOfDeltaUpdateOpsPerItemPerBatch").then((e=>{var t;(t=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(t.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e)}))),S.push(_.Aq.isChangeGateEnabled(this.hostCallbacks,"SendTokenFailureMessage").then((e=>{this.settings.sendTokenFailureMessage=e})));const k={enableDeltas:!1,enableEarlyJoin:!1};S.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then((e=>k.enableDeltas=e)).catch((()=>k.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>k.enableEarlyJoin=e)).catch((()=>k.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new Se(n.modelDownloader&&this.isDownloaderCompatible()?n.modelDownloader:void 0,this.inferenceServiceFactory,k)})));const T=(0,Ee.Vh)(null!==(l=t.flights)&&void 0!==l?l:"");var x;return this.isDeltaGeneratorEnabled=T.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(u=n.isDeltaGeneratorEnabled)&&void 0!==u&&u),this.disableSyncDeltaSending=T.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(g=n.disableSyncDeltaSending)&&void 0!==g&&g),this.syncDeltaTimeout=T.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",n.syncDeltaTimeout),(p=this.settings).defaultBatchingEnabled&&(p.defaultBatchingEnabled=!T.getBooleanValue("DefaultBatchingDisabled",!1)),(f=this.settings).batchingWith20msIntervalEnabled&&(f.batchingWith20msIntervalEnabled=!T.getBooleanValue("BatchingWith20msIntervalDisabled",!1)),(m=this.settings).reduceBatchOperationsEnabled||(m.reduceBatchOperationsEnabled=T.getBooleanValue("ReduceBatchOperationsEnabled",!1)),(v=this.settings).batchMessagesEnabled||(v.batchMessagesEnabled=T.getBooleanValue("BatchMessagesEnabled",!1)),(b=this.settings).removeDuplicateFlights&&(b.removeDuplicateFlights=T.getBooleanValue("RemoveDuplicateFlights",!0)),(y=this.settings).reducedPingPongRetryEnabled||(y.reducedPingPongRetryEnabled=T.getBooleanValue("ReducedPingPongRetryEnabled",!1)),(w=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(w.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=T.getBooleanValue("maxNumberOfDeltaUpdateOpsPerItemPerBatch",!1)),this.settings.authTokenTimeoutMs=T.getIntValue("AuthTokenTimeoutMs",0),C.setDataField("Flights",JSON.stringify(this.settings)),n&&n.loggableUrls&&(x=n.loggableUrls,c.push(...x)),Promise.all(S).then((()=>{this.batchOptions=n.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6,delayMsMax:50},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),this.batchOptions&&!this.batchOptions.delayMsMax&&(this.batchOptions.delayMsMax=50),n&&n.networkMode&&(this.networkMode=n.networkMode,n.networkMode===V.yv.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new _e.t)),C.dimension0=JSON.stringify(this.batchOptions),this.logOperation(C,!0)})).catch((e=>{this.logOperation(C,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){a.tG.flushAggregators(e)}createSession(e){var t;const o=e&&e.docSessionId?e.docSessionId:(0,Ie.v4)(),i=e&&e.documentId?e.documentId:void 0,n=this.sessionsByDocSessionId.get(o),r=new s.I({operationName:"CreateSession",resourceId:o,dimension1:this.hasBeenInitialized.toString()});if(r.start(),n&&!1===n.isClosed)throw this.logOperation(r,!1,"Error","docSessionId already exists"),new Error("docSessionId already exists");let a=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;a=_.Aq.convertServiceUrlToWebSocket(a),a||((e=e||{}).networkMode=V.yv.LocalWorkflowsOnly),!this.networkMode||void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)||((e=e||{}).networkMode=this.networkMode),void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)&&(null==e?void 0:e.networkMode)!==V.yv.JSWebSockets||!this.hasHttpFallbackSession()||((e=e||{}).networkMode=V.yv.HttpFallback);const l=Object.assign({},this.clientMetadata);if(l.docSessionId=o,i&&(l.documentId=i),e&&e.flights&&(l.flights=l.flights?l.flights+";"+e.flights:e.flights),this.settings.shouldAppendClientFeatureFlights){const e=["_acceptsClaimsChallengeMessages","_acceptsSeedingStatusChangeMessages"].join(";");l.flights=l.flights?`${l.flights};${e}`:e}this.settings.removeDuplicateFlights&&l.flights&&(l.flights=(0,Ee.JU)(l.flights)),r.setDataField("Flights",l.flights||"");const c=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(l,a,e),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:l,userContext:e?e.userContext:void 0,localWorkflowManager:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:null==e?void 0:e.networkMode,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled,batchMessagesEnabled:this.settings.batchMessagesEnabled,annotationDoesNotExistOnServiceEnabled:this.settings.annotationDoesNotExistOnService,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:this.settings.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled,gateUtils:this.gateUtils});return this.sessionsByDocSessionId.set(o,c),e&&(e.onSessionConnect&&c.setConnectCallback(e.onSessionConnect),e.onSessionDisconnect&&c.setDisconnectCallback(e.onSessionDisconnect),e.onSessionReconnect&&c.setReconnectCallback(e.onSessionReconnect),e.onSessionClose&&c.setSessionCloseCallback(e.onSessionClose),e.onServerAuthenticationStateChangeCallback&&c.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),e.onClaimsChallengeCallback&&c.setClaimsChallengeCallback(e.onClaimsChallengeCallback),e.onSeedingStatusChangeCallback&&c.setSeedingStatusChangeCallback(e.onSeedingStatusChangeCallback)),this.logOperation(r,!0),c.initialize?c.initialize():Promise.resolve(c)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(qe.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=(0,a.OD)(r.q.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,o)=>{if(o&&o.networkMode==V.yv.LocalWorkflowsOnly)return new _e.t;const i=new oe,n=new Q;let r=()=>{a.tG.error(573321615,a.nh.CoreDefault,"Unexpectedly not set sendMessage")};const s=new ie((()=>n),e,i,((e,t,o)=>{r(e,t,o)}),{requestAuthToken:this.hostCallbacks.requestAuthToken,overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==o?void 0:o.enableRemoteExecutionNotification)||!1,sendTokenFailureMessageChangeGate:this.settings.sendTokenFailureMessage,authTokenTimeoutMs:this.settings.authTokenTimeoutMs,dontSendTokenOnReconnectChangeGate:this.settings.doNotSendNewTokenOnReconnect}),l=new J(_.Aq.convertServiceUrlToWebSocket(t),n,this.workerFactory,s,e,i,this.settings,this.gateUtils,null==o?void 0:o.networkMode);return r=l.sendMessage.bind(l),l.on("disconnect",(()=>i.clearRefreshTimeouts())),l.on("connect",((e,t,o,i)=>{e&&this.hostCallbacks.setSessionData&&this.hostCallbacks.setSessionData(t,o,i);const n=t.substring(t.lastIndexOf("/")+1);this.telemetryLogger.setServerSessionKey(n)})),l}}isFeatureEnabled(e,t=!1,o="None"){return _.Aq.isFeatureEnabled(this.hostCallbacks,e,t,o)}hasHttpFallbackSession(){let e=!1;return this.sessionsByDocSessionId.forEach((t=>{t.isHttpFallback()&&(e=!0)})),e}logOperation(e,t,o,i){e.stop(),e.success=t,e.resultSignature=o,e.resultDescription=i,a.tG.info(573321622,a.nh.CoreDefault,e)}addLoggingAggregator(e){var t,o,i,n;"Dogfood"!==this.clientMetadata.releaseAudienceGroup&&(a.tG.addAggregator(u("Operation","operationName",["ExecuteBatch","ReduceBatchOperations","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","NetworkEgressControl","HttpEgress","LongPollNoOp","NetworkRateControllerAbandonedSyncMessage","NetworkRateControllerEgress","NetworkRateControllerQueueItem","NetworkRateControllerOnRateLimitResponse","NetworkRateControllerOnRateLimitError","NetworkRateControllerRateLimitsSet"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),a.tG.addAggregator(u("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","EarlyJoinCompletion","OnLongPollMessage","OnAnnotationResultsEgress"],null!==(o=e.telemetryAggregationIntervalSec)&&void 0!==o?o:60)),a.tG.addAggregator(u("Operation","operationName",["LocalScopeExecutionNotification","RunLocalWorkflows","EarlyJoinCompletion","SetAnnotations","WIS.addItemOnContextIdList","WIS.setScopeItem"],null!==(i=e.telemetryAggregationIntervalSec)&&void 0!==i?i:120)),a.tG.addAggregator(u("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:60)))}uninitialize(){this.settings.closeSessionsOnRuntimeUninit&&(this.sessionsByDocSessionId.forEach((e=>{e.close()})),this.sessionsByDocSessionId.clear()),this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,this.telemetryLogger=null,qe.haveCalledInit=!1,a.tG.clearAggregators(),a.tG.clearLoggers()}}new qe;const je=()=>new qe},78473:(e,t,o)=>{"use strict";o.d(t,{vd:()=>ee,po:()=>le});var i=o(13674),n=o(94878),r=o(46875),s=o(92313),a=o(55887),l=o(59294),c=o(31733),u=o(60859),d=o(66001),h=o(99795);class g{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){u.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_Apology"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return u.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class p{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){u.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_SecondaryApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return u.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){u.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_WorkflowActivationFailureDetails"}static getBaseTypes(){return[]}static typeGuard(e){return u.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class m{constructor(e){u.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_AuthTokenIsMissingDetails"}static getBaseTypes(){return["AugLoop_Core_WorkflowActivationFailureDetails"]}static typeGuard(e){return u.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class v{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){u.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_NotActivatedWorkflowApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return u.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};var b=o(38238);class y{constructor(e,t,o,i){this.sendMessage=e,this.annotationType=t,this.options=o,this.token=`${t}-${y.nextActivationResultBatchId++}`,this.annotationDoesNotExistOnServiceEnabled=i}activate(e,t,o){return new Promise(((i,n)=>{this.sendMessage(new r.n4({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:this.options?this.options.forceReturnCachedAnnotations:void 0,returnAnnotationDoesNotExist:this.annotationDoesNotExistOnServiceEnabled||!1,sendApologies:o}),((e,t)=>{e?n(new Error(e.error)):(r.PY.typeGuard(t)&&this.annotationDoesNotExistOnServiceEnabled&&(this.annotationDoesNotExistOnService=t.annotationNotExists),i({token:this.token}))}),t)}))}release(){return new Promise(((e,t)=>{this.annotationDoesNotExistOnService&&this.annotationDoesNotExistOnServiceEnabled?e(!1):this.sendMessage(new r.GA({token:this.token}),((o,i)=>{o?t(new Error(o.error)):e(i.lastRelease)}))}))}}y.nextActivationResultBatchId=1;var w,C=o(41856),S=o(90456),k=o(1554);!function(e){e[e.ExceedingMaxSize=0]="ExceedingMaxSize",e[e.GroupComplete=1]="GroupComplete",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(w||(w={}));class T{constructor(e,t,o,i,n){this.batchesByGroupingKey=new Map,this.getOrderOfMagnitudeDimension=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,this.submit=e,this.onSummary=i,this.reduceBatchOperationsEnabled=t,this.batchMessagesEnabled=o,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=n}addBatchItem(e,t,o,i,n,r){const{delayMs:s,delayMsMax:a,maxInputSize:l,estimateSize:c,groupingKeyExtractor:u}=t,d=c(e),h=u(e);if(t.split&&d>l){let s;try{s=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(r?r(t):C.tG.error(573366352,C.nh.CoreDefault,t))}if(s&&Array.isArray(s.inputs)&&s.inputs.length>1){let e;const a=[],l=r?(t,o)=>{if(e=e||t,a.push(o),a.length===s.inputs.length){let o;try{o=s.join(a)}catch(t){return void r(new Error("Join error: "+t.message))}r(e,o)}}:void 0;for(let e=0;e<s.inputs.length;e++){const r=s.inputs[e];this.addBatchItem(r,t,o,i,n&&e===s.inputs.length-1,l)}return}}let g=this.batchesByGroupingKey.get(h);if(g&&g.size+d>l&&(this.executeBatch(h,g,t,w.ExceedingMaxSize),g=void 0),g||(g={items:[],size:0,hasItemsWithCallbacks:!1,context:o,creationTime:Date.now()},this.batchesByGroupingKey.set(h,g)),this.batchMessagesEnabled){const t=g.items[g.items.length-1];t&&t.cv===i&&t.callback===r?(t.input=[...t.input,...e],t.size+=d):g.items.push({input:e,size:d,cv:i,callback:r})}else g.items.push({input:e,size:d,callback:r});g.size+=d,g.hasItemsWithCallbacks=g.hasItemsWithCallbacks||!!r,this.batchMessagesEnabled||(g.cv=i),g.groupComplete=n,g.groupComplete?this.executeBatch(h,g,t,w.GroupComplete):(Date.now()-g.creationTime+s<a&&(clearTimeout(g.timeout),g.timeout=void 0),g.timeout||(g.timeout=setTimeout((()=>{this.executeBatch(h,g,t,w.BatchIntervalElapsed)}),s)))}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}reduceBatchOperations(e){const t=new S.I({operationName:"ReduceBatchOperations"}).start();let o=0,i=0,n=0;const r=new Set,s=[],a=(e,t)=>e.parentPath.toString()+"/"+e.parentRevId+"/"+t.id;for(const t of e.input.reverse()){const e=[];for(const s of t.input.reverse())if(c.fZ.typeGuard(s)){const t=[];for(const e of s.items){n++;const l=a(s,e);r.has(l)?i++:(t.push(e),r.add(l),o++)}0!==t.length&&(s.items=t,e.push(s))}else if(c.Xr.typeGuard(s)){for(const e of s.items){const t=a(s,e);r.delete(t)}e.push(s)}else e.push(s);0!==e.length&&s.push({input:e.reverse(),size:t.size,cv:t.cv,callback:t.callback})}e.input=s.reverse(),0!=n&&(t.dimension0=`${this.getOrderOfMagnitudeDimension(i)}`,t.dimension1=`noOp: ${0===i}`),t.success=n-i==o,C.tG.info(507839488,C.nh.CoreDefault,t.stop())}maxNumberOfDeltaUpdateOpsPerItemPerBatch(e){const t=(e,t)=>e.parentPath.toString()+"/"+t.id;let o=0;const i=new Map;for(const n of e.input)if(c.xU.typeGuard(n))for(const e of n.items){const r=t(n,e);i.has(r)||i.set(r,0),i.set(r,i.get(r)+1),o=Math.max(o,i.get(r))}return o}executeBatch(e,t,o,i){clearTimeout(t.timeout),t.timeout=void 0,this.batchesByGroupingKey.delete(e);const n=t.items,r=new S.I({operationName:"ExecuteBatch",cv:this.batchMessagesEnabled?"":t.cv,resourceId:t.context.name,resultDescription:`batching duration: ${Date.now()-t.creationTime}ms`,dimension0:`${this.batchMessagesEnabled?"Batched items count":"Batched ops count:"} ${this.getOrderOfMagnitudeDimension(n.length)}`,dimension1:`Size ${this.getOrderOfMagnitudeDimension(t.size)}`,dimension2:i.toString()}).start(),s=(e,o,i)=>{let s;if(o&&o.exceptionType===k.K.NoOutput)r.success=!0,C.tG.info(573366353,C.nh.CoreDefault,r.stop());else{const i=`${e} error: ${o?o.message||o:"Unknown error"}`;s=o||new Error(i),r.success=!1,r.resultDescription=`Batch of ${n.length} items of size ${t.size} with ${i}`,r.resultSignature=`${e} Error`,C.tG.error(573366354,C.nh.CoreDefault,r.stop())}if(t.hasItemsWithCallbacks)for(const e of n)e.callback&&e.callback(s,i)};let a;try{a=o.multiplex(this.batchMessagesEnabled?n:n.map((e=>e.input)))}catch(e){return void s("Multiplex",e)}this.reduceBatchOperationsEnabled&&this.batchMessagesEnabled&&"operations"==e&&this.reduceBatchOperations(a),!this.batchMessagesEnabled&&"operations"==e&&this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled&&(r.dimension3=this.getOrderOfMagnitudeDimension(this.maxNumberOfDeltaUpdateOpsPerItemPerBatch(a))),this.submit(a.input,t,((e,i)=>{if(e||i&&("exceptionType"in i||i instanceof Error))s("Submit",e||i,i);else if(t.hasItemsWithCallbacks||o.summaryExtractor){let l,c,u;if(t.hasItemsWithCallbacks)try{if(l=a.demultiplex(i),l.length!==n.length)throw new Error("Mismatched output length")}catch(e){return void s("Demultiplex",e)}if(o.summaryExtractor)try{[u,c]=o.summaryExtractor(i)}catch(e){return void s("SummaryExtractor",e)}if(r.success=!0,C.tG.info(573366342,C.nh.CoreDefault,r.stop()),t.hasItemsWithCallbacks)for(let e=0;e<n.length;e++)n[e].callback&&n[e].callback(void 0,l[e]);c&&this.onSummary(u,c,t.context)}else r.success=!0,C.tG.info(573366343,C.nh.CoreDefault,r.stop())}))}}var x=o(19286),_=o(65920),I=o(86391),E=o(76881),B=o(79938),A=o(10510),R=o(1895),M=o(28810);class D{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,o){return Object.assign(Object.assign(Object.assign({},e),t),o)}mergeWorkflowDefinition(e,t,o){if(o){const i=(0,M.oF)(this.workflowDefByWorkflowAndContextId,e.id,(()=>new Map));i.set(o,D.mergeDefinitions(e,i.get(o),t))}else this.workflowDefByWorkflow.set(e.id,D.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var o;let i;return t&&(i=null===(o=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===o?void 0:o.get(t)),i||(i=this.workflowDefByWorkflow.get(e.id)),i||(i=e),i}deleteWorkflowDefinition(e,t){const o=this.workflowDefByWorkflowAndContextId.get(e.id);o&&(o.delete(t),0===o.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))}}var P=o(41450);class F{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var o;const i=e.contextId;if(i)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(i,[]),this.scopeItemsByContextId.has(i)){if(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.has(i)){const o=new S.I({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${i} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();C.tG.verbose(527291288,C.nh.CoreDefault,o.stop())}}else this.scopeItemsByContextId.set(i,e)}updateScopeItemPath(e,t,o){var i,n;if(!e)return;const r=this.scopeItemsByContextId.get(e);if(!r)return;const s=r.parentPath;this.scopeItemsByContextId.set(e,(0,A.CY)(t,r));const a=null!==(n=null===(i=this.itemsByWorkflowAndContextId.get(o.id))||void 0===i?void 0:i.get(e))&&void 0!==n?n:[];for(let e=0;e<a.length;e++)a[e]=(0,A.CY)([...t,...a[e].parentPath.slice(0,s.length)],a[e])}getScopeItem(e,t){var o;for(const i of(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.keys())||[])if((0,M.lO)(i,e))return this.scopeItemsByContextId.get(i)}addItemToWorkflowList(e,t){const o=e.contextId;if(!o)return;const i=this.itemsByWorkflowAndContextId.get(t.id);if(i)for(const[n,r]of i)if((0,M.lO)(n,o)){r.push(e);const o=new S.I({resultDescription:`Items for contextId ${n}: [${r.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();C.tG.info(526403808,C.nh.CoreDefault,o.stop())}}isWorkflowReady(e,t){const o=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=o}getItemsToExecute(e,t){const o=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),o}onWorkflowExecuted(e,t){const o=e.contextId,i=this.itemsByWorkflowAndContextId.get(t.id);i&&(i.delete(o),0===i.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(o)||this.scopeItemsByContextId.delete(o)}getGeneratedItems(e,t){var o;if(!(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.get(e)))return[];const i=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,i)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const o of t.keys())if(o===e)return!0;return!1}}var O=o(23503),N=o(26302);const q=(e,t)=>t?j([...t,e]):e,j=e=>e.join("\\");class L{constructor(e){this.createTextTileDeltasFromItem=(e,t)=>{var o;const i=new S.I({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return i.success=!1,i.resultDescription="Unable to create text tile delta, parent item is undefined",void C.tG.info(524883085,C.nh.CoreDefault,i.stop());if(!e.body)return i.success=!1,i.resultDescription="Unable to create text tile delta, parent item has undefined body",void C.tG.info(524883086,C.nh.CoreDefault,i.stop());const n=e.body;if(!O.qf.typeGuard(n))return i.success=!1,void(i.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${O.qf.getTypeName()}, received ${u.h.getTypeNameFor(n)}`);const r=q(e.id,t),s=null!==(o=this.lastSeenTileByTileId.get(r))&&void 0!==o?o:new O.qf({content:""}),a=this.createDeltas(s,n);return a&&0!==a.length?(i.dimension0=a.length.toString(),this.lastSeenTileByTileId.set(r,n)):(i.dimension0="0",i.resultDescription="No delta differences found"),C.tG.info(524883087,C.nh.CoreDefault,i.stop()),a}catch(e){return i.success=!1,i.resultDescription=`Error creating text tile delta: ${e}`,void C.tG.info(524883088,C.nh.CoreDefault,i.stop())}},this.lastSeenTileByTileId=null!=e?e:new Map,this.deltaBuilder=new N.a}addItemToLocalMap(e,t){const o=q(e.id,t),i=e.body;O.qf.typeGuard(i)&&!this.lastSeenTileByTileId.has(o)&&this.lastSeenTileByTileId.set(o,i)}deleteItemFromLocalMap(e,t){const o=q(e.id,t);this.lastSeenTileByTileId.has(o)&&this.lastSeenTileByTileId.delete(o)}moveItemsInLocalMap(e,t,o){const i=new Set(o),n=j(t),r=j(e),s=[],a=(e,t)=>e.length>t.length?e.substring(t.length+1).split("\\")[0]:void 0;for(const[e,t]of this.lastSeenTileByTileId)if(e.startsWith(n)){const o=a(e,n);if(void 0===o||i.has(o)){const o=e.replace(n,r);s.push({item:t,newPathKey:o,prevPathKey:e})}}for(const e of s)this.lastSeenTileByTileId.delete(e.prevPathKey),this.lastSeenTileByTileId.set(e.newPathKey,e.item)}createDeltas(e,t){return this.deltaBuilder.executeDeltaBuilderHandler(u.h.getTypeNameFor(t),e,t)}}var z=o(11168),H=o(78449),W=o(38178);const U=e=>G(e,Number.POSITIVE_INFINITY),G=(e,t)=>{let o=0;const i=[],n=[e];for(;n.length>0;){const e=n.pop(),r=typeof e;if("boolean"===r)o+=4;else if("string"===r)o+=2*e.length;else if("number"===r)o+=8;else if("object"===r&&e&&-1===i.indexOf(e))if(e instanceof Uint8Array)o+=e.length;else{i.push(e);for(const t in e)n.push(e[t])}if(o>t)return o}return o};var V=o(87783),$=o(42316),K=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function J(e,t){return K(this,void 0,void 0,(function*(){const{authToken:o,origin:i,sessionUrl:n}=e,{body:r,cv:s,method:a,requestUrl:l}=t,c=yield(0,V.fetch)(l||n,{method:a,headers:Object.assign({Authorization:`Bearer ${o}`,"x-origin":i,"x-correlationid":s},t.headers),body:r});if(200!==c.status)throw new Error(`Unexpected status code: ${c.status}`);return c}))}const Y=(e,t)=>{t?(e.resultDescription=t,e.success=!1,C.tG.error(507646878,C.nh.CoreDefault,e.stop())):C.tG.info(507646877,C.nh.CoreDefault,e.stop())};function Q(e,t,o,i){let n;J(e,{headers:{"Content-Type":"application/jsond"},body:$.r.serialize(t),cv:o.cv,method:"POST"}).then((e=>e.json())).catch((e=>{n=new r._p({messageId:t.messageId,error:e.message})})).then((e=>{Y(o,n?n.error:void 0),i(n,e)}))}function Z(e,t,o,i){let n;J(e,{headers:{"Content-Type":"application/octet-stream"},body:t,cv:o.cv,method:"POST",requestUrl:`${e.sessionUrl}/blob`}).then((e=>e.json())).catch((e=>{n=new r._p({error:e.message})})).then((e=>{Y(o,n?n.error:void 0),i(n,e)}))}function X(e,t,o,i){const{sessionUrl:n}=e;let r;J(e,{cv:i.cv,method:"GET",requestUrl:t.refType===d.J1.AlCodedLocation?`${n}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{r=e})).then((e=>{Y(i,r?r.message:void 0),o(r,e)}))}var ee,te=o(93692),oe=o(34897),ie=o(72459),ne=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))},re=function(e){return this instanceof re?(this.v=e,this):new re(e)};!function(e){e[e.LocalWorkflow=0]="LocalWorkflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(ee||(ee={}));const se=(e,t)=>{t?(e.resultDescription=t,e.success=!1,C.tG.error(509203144,C.nh.CoreDefault,e.stop())):C.tG.info(509203143,C.nh.CoreDefault,e.stop())},ae=e=>!e.items.some((e=>e.source&&0===e.source.indexOf("ThirdParty")));class le{constructor(e){var t,o;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.apologyCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=i.f.NotAuthenticated,this.sessionCloseCallbacks=new Map,this.connectCallbacks=new Map,this.reconnectCallbacks=new Map,this.disconnectCallbacks=new Map,this.sessionStateCallbackToken=0,this.workflowGraph=new R.Q$,this.workflowDefinitionManager=new D,this.contextIdManager=new P.a4(P.xs.JsClient,this.workflowGraph),this.workflowItemStorage=new F(this.workflowDefinitionManager),this.pendingConnectCallbacks=[],this.onAnnotationsSubmittedEnabled=!1,this.reduceBatchOperationsEnabled=!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=!1,this.batchMessagesEnabled=!1,this.seedingStatus=n.e9.NotStarted,this.isChangeGateForceUserInteractiveAuth=void 0,this.onConnectTelemetryCG=void 0,this.cachedClaimsChallenge={claimsVersion:0,actionRequired:!1},this.tokenMessageVersion=1,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.batchMessagesEnabled=e.batchMessagesEnabled||!1,this.reduceBatchOperationsEnabled=e.reduceBatchOperationsEnabled||!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||!1,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,this.gateUtils=e.gateUtils,this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.claimsChallengeCallback=[],this.seedingStatusChangeCallbacks=[],this.onAnnotationsSubmittedEnabled=e.onAnnotationsSubmittedEnabled||!1,this.annotationDoesNotExistOnServiceEnabled=e.annotationDoesNotExistOnServiceEnabled||!1,this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(r.B_.getTypeName(),this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(r.$j.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(r.Gs.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),this.sessionManager.onMessage(r.Sy.getTypeName(),this.onClaimsChallengeMessage.bind(this)),this.sessionManager.onMessage(r.fr.getTypeName(),this.onSeedingStatusChangeMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator()),this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this)),(null===(o=this.gateUtils)||void 0===o?void 0:o.isChangeGateEnabledSync(ie.Nd))||this.setClaimsChallengeCallback(this.requestAuthTokenWithClaims.bind(this))}getSessionReconnectParams(){if(!this.connectParams)throw new Error("Session has not been established yet.");return{sessionUrl:this.connectParams.sessionUrl,origin:this.connectParams.origin,authToken:this.connectParams.authToken,nextSyncSequenceId:this.nextSyncSequenceId}}setNextSequenceId(e){this.nextSyncSequenceId=e}tryGetDocSessionId(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId}getSessionStateCallbackToken(e){var t;return e+"-callback-"+(null!==(t=this.tryGetDocSessionId())&&void 0!==t?t:"unknown")+"-"+this.sessionStateCallbackToken++}updateGraphOnAuthStateChange(e){this.tryActivateWorkflows()}tryActivateWorkflows(){if(this.enableRemoteExecutionNotification){const e=new S.I({operationName:"GraphServerWorkflowActivation",success:!0}).setClientMetadata(this.clientMetadata).start(),t=[];this.workflowGraph.getWorkflowNodes().filter((e=>e.location===R.aZ.External)).forEach((e=>{this.localWorkflowManager.canActivateWorkflow(e,this)?e.isActivated=!0:(this.localWorkflowManager.deactivateServerWorkflow(e,this),t.push(e.workflow.id))})),e.resultDescription=`deactivated workflows: [${t.join()}]`,C.tG.info(508879493,C.nh.CoreDefault,e.stop())}}initialize(){return ne(this,void 0,void 0,(function*(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows),this.gateUtils&&!this.onConnectTelemetryCG&&(this.onConnectTelemetryCG=yield this.gateUtils.isChangeGateEnabled("OnConnectTelemetry")),yield this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress),this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this}))}isLocalWorkflowRegistered(e){return this.getLocalRegisteredWorkflows().some((t=>e===t.id))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){this.registerLocalWorkflowsWithoutGraphInit(e),this.trySendWorkflowGraphInitMessage()}registerLocalWorkflowsWithoutGraphInit(e){if(e.length&&this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this)}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new S.I({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();se(t)}activateAnnotation(e,t,o){var i;const n=new y(this.sendMessageToSession.bind(this),e,t,this.annotationDoesNotExistOnServiceEnabled),r=(t,o)=>{let i=t.get(e);i||(i=new Map,t.set(e,i)),i.set(n.token,o)};(null==t?void 0:t.callback)&&r(this.annotationCallbacks,null==t?void 0:t.callback),(null==t?void 0:t.apologyCallback)&&r(this.apologyCallbacks,null==t?void 0:t.apologyCallback);const s=null!==(i=this.tokensByAnnotationType.get(e))&&void 0!==i?i:[];return-1===s.indexOf(n.token)&&s.push(n.token),this.tokensByAnnotationType.set(e,s),this.annotationActivationTrackers.set(n.token,n),this.activateAnnotationForTracker(n,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)})}activateAnnotationForTracker(e,t){const o=new S.I({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected,t.sendApologies).then((i=>(o.resultSignature="Ok",o.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,se(o),i))).catch((i=>{throw se(o,`error on activate annotation type ${e.annotationType}: ${i}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),i}))}updateAnnotationConfig(e,t){const o=new r.Ol({token:e,config:t});this.sendMessageToSession(o);const i=this.annotationActivationTrackers.get(e);i&&i.options&&(i.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const o=o=>{const i=o.get(t.annotationType);i&&(i.delete(e),0==i.size&&o.delete(t.annotationType))};return o(this.annotationCallbacks),o(this.apologyCallbacks),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,o){const i={state:o};this.submitOperation(new c.XP({parentPath:e,items:[{id:t}],M_:i}))}setAnnotationMetadata(e,t,o){this.submitOperation(new c.XP({parentPath:e,items:[{id:t}],M_:o}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){var o,i;if(t||(t=this.generateCorrelationId()),(0,oe.BG)(e,t,Date.now(),"SubmitInRuntimeClient",new S.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e),!this.onAnnotationsSubmittedEnabled){const[o,i]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(o,t)}const n=e.filter(this.filterOperationsForSession.bind(this)).filter(ae),r=[];if(this.deltaGenerator){const e=new S.I({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of n)if(c.fZ.typeGuard(e))r.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const n of t.items)c.Xr.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(n,t.parentPath):c.n4.typeGuard(e)?this.deltaGenerator.deleteItemFromLocalMap(n,t.parentPath):c.hW.typeGuard(e)&&this.deltaGenerator.moveItemsInLocalMap(e.parentPath,e.prevParentPath,null!==(i=null===(o=e.items)||void 0===o?void 0:o.map((e=>e.id)))&&void 0!==i?i:[]);r.push(e)}se(e)}if(this.onAnnotationsSubmittedEnabled){const[e,o]=this.partitionAnnotationOperations(r.length?r:n);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(o,t)}else this.submitOperationsToSession(r.length?r:n,t);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");if(this.networkMode===a.yv.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);t||(t=this.generateCorrelationId()),this.allowSeed=!1,this.allowGroupSeed=!1;const[o,i]=this.partitionAnnotationOperations(e);this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(o,t):this.executeCallbacksOnAnnotationSubmitted(o,t),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?i:e,!0,t):this.sendMessageToSession(new r.Tb({cv:t,seq:0,ops:this.onAnnotationsSubmittedEnabled?i:e}))}submitSeedGroupOperations(e,t,o){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");if(this.networkMode===a.yv.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);o||(o=this.generateCorrelationId()),t&&(this.allowGroupSeed=!1),this.allowSeed=!1;const[i,n]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(i,o),this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(i,o):this.executeCallbacksOnAnnotationSubmitted(i,o),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?n:e,!!t,o):(this.seedGroupSize++,this.sendMessageToSession(new r.Tb({cv:o,seq:0,ops:this.onAnnotationsSubmittedEnabled?n:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))}submitCustomMessage(e){return new Promise(((t,o)=>{this.sendMessageToSession(e,((i,n)=>{i?o(new Error(`${i.error}; for message type: ${u.h.getTypeNameFor(e)}`)):t(n)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,o)=>{this.sendMessageToSessionPostEndpoint(e,((e,i)=>{e?o(new Error(e.error)):t(i)}))}))}submitBinaryStreamUploadMessage(e){return new Promise(((t,o)=>{const i=new S.I({operationName:"sendBinaryStreamUploadMessage",success:!0}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)Z(this.connectParams,e,i,((e,i)=>{e?o(new Error(e.error)):t(i)}));else{const n=(n=>Z(n,e,i,((e,i)=>{e?o(new Error(e.error)):t(i)}))).bind(this);this.pendingConnectCallbacks.push(n)}}))}requestBinaryDataForBlob(e){return e.data?Promise.resolve(e.data):e.dataPointer&&e.dataPointer.refType!==d.J1.None?new Promise(((t,o)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,i)=>{e?o(e):t(i)}))})):Promise.reject(new Error("Blob does not have a data pointer"))}requestCacheDump(e){if(e)throw new Error("NYI");return this.submitCustomMessage(new r.z_)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(e){this.isSessionClosed=!0,this.sessionManager.closeSession(e),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this),this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0)}authenticateInteractive(e){return ne(this,void 0,void 0,(function*(){if(this.gateUtils&&!this.isChangeGateForceUserInteractiveAuth&&(this.isChangeGateForceUserInteractiveAuth=yield this.gateUtils.isChangeGateEnabled("CGForceUserInteractiveAuth")),!(this.isChangeGateForceUserInteractiveAuth&&e&&e.forceUserPrompt)&&this.cachedClaimsChallenge.claimsVersion>0&&!this.cachedClaimsChallenge.actionRequired)return;const t=yield this.requestAuthTokenInteractive(this.cachedClaimsChallenge,{interactive:!0});if(r.D0.typeGuard(t))throw new Error(t.reason)}))}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){const t=this.getSessionStateCallbackToken("close");return e&&this.sessionCloseCallbacks.set(t,e),t}setConnectCallback(e){const t=this.getSessionStateCallbackToken("connect");return e&&this.connectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getSessionStateCallbackToken("disconnect");return e&&this.disconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getSessionStateCallbackToken("reconnect");return e&&this.reconnectCallbacks.set(t,e),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.reconnectCallbacks)||t(this.disconnectCallbacks)||t(this.connectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}setClaimsChallengeCallback(e){this.cachedClaimsChallenge.actionRequired&&e(this.cachedClaimsChallenge),this.claimsChallengeCallback.push(e)}setSeedingStatusChangeCallback(e){e(new r.fr({newStatus:this.seedingStatus})),this.seedingStatusChangeCallbacks.push(e)}getConnectParams(){return this.connectParams}setOfflineMode(){this.sessionManager=new te.t}onAnnotationResults(e,t,o){C.tG.info(508916486,C.nh.CoreDefault,new S.I({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0,cv:e.cv})),o(void 0,new r.YK),t===ee.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(e.ops),this.updateWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,o)=>{this.applyOperationForContext(e,o,t)}),((o,i)=>{const n=Date.now();this.triggerRegisteredAnnotationCallbacks(o,e.annotationType,i,e.areApologies),t===ee.ServerWorkflow&&(0,oe.M4)(e,n,"CallbackInRuntimeClient",!0,new S.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}),(e=>{if(t!==ee.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this)).filter(ae);this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var o;t(void 0,new r.YK);for(const t of e.updates){const{annotationType:e,state:i}=t;if(!this.tokensByAnnotationType.has(e))continue;let r;r=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):i===n.K7.Idle?n.K7.Pending:n.K7.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(o=e.options)||void 0===o?void 0:o.stateUpdateCallback)&&e.options.stateUpdateCallback(r,i)}}}submitOperationsToSession(e,t){t||(t=this.generateCorrelationId());const o=e.filter((e=>c.g0.typeGuard(e))),i=e.filter((e=>!c.g0.typeGuard(e)));if(o.length>0&&this.sendMessageToSession(new r.Tb({cv:t,ops:o})),i.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,o)=>{if(e.length){const t=new r.l0;t.messages=[],e.forEach((e=>{t.messages.push(new r.Tb({cv:e.cv,seq:this.nextSyncSequenceId++,ops:e.input}))})),this.sendMessageToSession(t,(e=>{o(e?new Error(e.error):void 0)}))}}:(e,t,o)=>{this.sendMessageToSession(new r.Tb({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{o(e?new Error(e.error):void 0)}))},this.batchedOperationsManager=new T(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.batchedOperationsManager.addBatchItem(i,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.sendMessageToSession(new r.Tb({cv:t,seq:this.nextSyncSequenceId++,ops:i}))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),r.w9.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){const o=new S.I({operationName:"SendLargeBinaryDataMessage",success:!0,cv:e.cv}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)Q(this.connectParams,e,o,t);else{const i=(i=>Q(i,e,o,t)).bind(this);this.pendingConnectCallbacks.push(i)}}requestBinaryDataFromSessionBlobEndpoint(e,t){const o=new S.I({operationName:"RequestBinaryData",success:!0,cv:(new E.W).toString()}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)X(this.connectParams,e,t,o);else{const i=(i=>X(i,e,t,o)).bind(this);this.pendingConnectCallbacks.push(i)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,o){let i=u.h.getTypeNameFor(e);if(i!=c.Xr.getTypeName()&&i!=c.I.getTypeName()&&i!=c.fZ.getTypeName()&&i!=c.n4.getTypeName())return;i==c.I.getTypeName()&&(i=c.Xr.getTypeName());const n=(0,A.CY)(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),r=(0,A.M6)(n.parentPath);if(i==c.Xr.getTypeName()||i==c.fZ.getTypeName()){if(!n.body)return;const e=u.h.getTypeNameFor(n.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let s=t.get(o);if(s||(s=[],t.set(o,s)),n.id||this.localWorkflowManager&&(n.id=this.localWorkflowManager.getNextClientAnnotationId()),i==c.Xr.getTypeName())0==s.filter((e=>(0,A.M6)(e.parentPath)==r&&e.id==n.id)).length?s.push(n):C.tG.info(540848911,C.nh.CoreDefault,`AddOperation for (${o}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<s.length;e++)if(s[e].id==n.id&&(0,A.M6)(s[e].parentPath)==r){if(s[e].source==n.source){s[e]=n;break}C.tG.warn(540848912,C.nh.CoreDefault,`UpdateOperation for (${o}, ${n.id}, ${n.source}) can't be applied as the context item with provided path and ID has different source: ${s[e].source}`)}else C.tG.warn(540848913,C.nh.CoreDefault,`UpdateOperation for (${o}, ${n.id}, ${n.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(i==c.n4.getTypeName()){if(!n.id)return;this.availableContexts.forEach(((e,t)=>{let i=e.get(o);i&&(i=i.filter((e=>!((0,A.M6)(e.parentPath)==r&&e.id==n.id))),0==i.length?e.delete(o):e.set(o,i),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const o of e)if(P.gu.has(u.h.getTypeNameFor(o)))for(const e of o.items)for(const o of t||[])this.localWorkflowManager.preProcessItemToWorkflow(o,e,this)}}resolveRequestedContexts(e){const t=[];for(const[o,i,n]of(0,B.v)(e.requestedContextTypesRules)){if(!this.availableContexts.has(o)){if(i==_.in.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(o).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${o} which does not contain any context annotation.`);t.push(...e)}return[!0,this.removeDuplicatedContextItems(t)]}removeDuplicatedContextItems(e){return e.filter(((e,t,o)=>o.findIndex((t=>I.Aq.deepEquals(t,e)))===t))}getContextAnnotations(e,t,o,i){var n,r;const s=o?(0,A.M6)(o):void 0;return null===(r=null===(n=this.availableContexts.get(e))||void 0===n?void 0:n.get(t))||void 0===r?void 0:r.filter((e=>!(s&&(0,A.M6)(e.parentPath)!=s||i&&e.source!=i)))}onWorkflowDefinitionOverrideMessage(e){const t=new S.I({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),o=e=>{throw se(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void o("Not supported by this local SessionProxy instance.");const i=this.localWorkflowManager.getWorkflowDefinitionsByName(this),n=i.get(e.sourceWorkflowId);if(!n)return void o(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=n.id;const r=i.get(e.targetWorkflowId);r&&(r.allowDefinitionOverride?n.definitionOverrideTargetWorkflows&&-1!==n.definitionOverrideTargetWorkflows.indexOf(r.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(r,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,se(t)):o(`Workflow '${n.id}' does not allow workflow definition for workflow '${r.id}'.`):o(`Workflow '${r.id}' does not allow workflow definition override.`))}applyContextIdOnOperations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}triggerRegisteredAnnotationCallbacks(e,t,o,i){if(this.callAnnotationCallbacks(e,t,o,i),this.hostCallbacks.onAnnotationResult)try{i?this.hostCallbacks.onApologyResult&&this.hostCallbacks.onApologyResult(e,o):this.hostCallbacks.onAnnotationResult(e,o)}catch(e){C.tG.error(540301151,C.nh.CoreDefault,new S.I({operationName:"HostCallbackOnAnnotationResultError",dimension0:t,resultDescription:`onAnnotationResult error: ${e}`}))}}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new r.YK),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new L,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,o;const i=[];C.tG.info(523776396,C.nh.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(o=e.items)||void 0===o?void 0:o.length)>0?e.items[0].id:"(no items)"})`);let n=[...e.parentPath];for(const t of e.items){const o=[],r=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==r?void 0:r.length){for(const i of r){const r=(0,W.v4)();n=[...e.parentPath,t.id];const s={id:r,revId:t.revId,body:i,contextId:t.contextId,source:t.source};o.push(s)}o.length>0&&(i.push(new c.xU({parentPath:n,items:o})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,n,o))}else C.tG.info(523329632,C.nh.CoreDefault,`Failed to create delta on item ${t.id}`)}return i}setupSyncDeltaAfterDelay(e,t,o){var i,n,r;const s=this.syncDeltaTimers.get(e.id);s&&(clearTimeout(s),this.syncDeltaTimers.delete(e.id));const a=o.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===z.OD.Chars}));if(a){const o=a.body,s={content:"",deltaType:z.WI.Update,length:0,position:(null!==(i=null==o?void 0:o.position)&&void 0!==i?i:0)+(null!==(r=null===(n=null==o?void 0:o.content)||void 0===n?void 0:n.length)&&void 0!==r?r:0),unit:z.OD.Sentence},l=O.Cg.typeGuard(e.body)?new H.s(s):new H.Q(s),u={id:(0,W.v4)(),revId:e.revId,body:l,contextId:e.contextId,source:e.source},d=new c.xU({parentPath:t,items:[u]}),h=setTimeout(((e,t)=>{this.submitOperation(e),this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,d,e.id);this.syncDeltaTimers.set(e.id,h)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow((0,M._$)(e))}getAnnotations(e,t){var o,i,r;const s=new S.I({operationName:"GetAnnotations",success:!0,dimension1:null===(o=e.annotationType)||void 0===o?void 0:o.toString(),dimension2:null===(i=e.maxDelayMs)||void 0===i?void 0:i.toString(),cv:e.cv}).setClientMetadata(this.clientMetadata).start(),c=this.sessionManager.getCorrelationVector(),u=new l.x5({annotationTypes:e.annotationType,transientItems:e.transientItems,configs:e.configs,maxDelayMs:e.maxDelayMs,sourceInfo:e.sourceInfo,caller:a.l6.Client,tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,correlationInfo:{cvString:null!==(r=e.cv)&&void 0!==r?r:c.newChild().toString()}}),d=[];let h;this.sendMessageToSession(u,((e,o)=>{(null==t?void 0:t.IsCancellationRequested)||(d.push({error:e,response:o}),null==h||h(!0))}));const g=this;let p=!1;const f=new Promise(((e,o)=>{null==t||t.onCancel((t=>{p?e():o(new Error(le.requestCancelledError))}))}));return{[Symbol.asyncIterator](){var e,o,i,r,a,l,c;return function(e,t,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,n=o.apply(e,t||[]),r=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(e){n[e]&&(i[e]=function(t){return new Promise((function(o,i){r.push([e,t,o,i])>1||a(e,t)}))})}function a(e,t){try{(o=n[e](t)).value instanceof re?Promise.resolve(o.value.v).then(l,c):u(r[0][2],o)}catch(e){u(r[0][3],e)}var o}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),r.shift(),r.length&&a(r[0][0],r[0][1])}}(this,arguments,(function*(){for(;!p;)try{0===d.length&&(yield re(Promise.race([new Promise((e=>h=e)),f])));const u=d.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(le.requestCancelledError);let m,v,b;if(p=(null===(e=u.response)||void 0===e?void 0:e.finalResponse)||void 0!==u.error,s.dimension3=`final response: ${p}`,u.error){const e=`ErrorCode: ${u.error.code}, Error: ${u.error.error}, Retryable: ${u.error.retryable}`;s.setDataField("ServerError",e),b=u.error.error,m={serviceError:[{code:n.Qn.ServerError,error:u.error.error,retryable:null==g?void 0:g.canBeRetried(u.error)}]}}else if((null===(i=null===(o=u.response)||void 0===o?void 0:o.errorInfo)||void 0===i?void 0:i.length)>0){const e=u.response.errorInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");s.setDataField("WorkflowErrors",e),b="Workflow execution error",m={serviceError:u.response.errorInfo}}else s.resultDescription="OK";if((null===(a=null===(r=u.response)||void 0===r?void 0:r.warningInfo)||void 0===a?void 0:a.length)>0){v={serviceError:u.response.warningInfo};const e=u.response.warningInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");s.setDataField("WorkflowWarnings",e)}se(s,b),yield yield re({content:null===(l=u.response)||void 0===l?void 0:l.content,error:null!=m?m:void 0,warning:null!=v?v:void 0,finalResponse:null===(c=u.response)||void 0===c?void 0:c.finalResponse})}catch(e){const t=e.message===le.requestCancelledError?n.zy.RequestCancelled:n.zy.Unknown;s.setDataField("ClientError",`ErrorCode: ${t}, Error: ${e.message}`),se(s,null==e?void 0:e.message),yield yield re({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),p=!0;break}}))}}}isHttpFallback(){const e=this.sessionManager.getNetworkWorkerManager();return!(!e||e.getInitNetworkMode()!==a.yv.JSWebSockets||e.getNetworkMode()!==a.yv.HttpFallback)}canBeRetried(e){return(null==e?void 0:e.code)===n.xv.TooManyRequests||(null==e?void 0:e.code)===n.xv.RequestTimeout||e.error.includes(s.Ef.ClientDisconnected)}getAuthToken(e,t){const o={Tickets:[]};this.clientMetadata.docSessionId&&(o.DocSessionId=this.clientMetadata.docSessionId);const i=(e=>{if(e===x.OY.Substrate)return b.OY.Substrate})(e);i&&(o.TokenType=i),this.hostCallbacks.requestAuthToken(o).then((o=>{var i;if(!o)throw new Error("Missing AuthTokenResponse from requestAuthToken");if(!o.Token)throw new Error("Missing Token from requestAuthToken");t(void 0,o.Token,{returnedTokenType:e,timeToLiveSec:null===(i=o.TokenProperties)||void 0===i?void 0:i.timeToLiveSec})})).catch((e=>{t(e)}))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{var t;this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0,sendApologies:void 0!==(null===(t=e.options)||void 0===t?void 0:t.apologyCallback)}).catch((()=>{}))})),this.reconnectCallbacks.forEach(((e,t)=>{e()})),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallbacks.forEach(((t,o)=>{t(e)}))}onConnect(e,t,o,i,r,s){const a=new S.I({operationName:"OnConnect",success:!0}).setClientMetadata(this.clientMetadata).start();a.setDataField("HasSessionConnected",this.hasSessionConnected),a.setDataField("IsSeedingRequired",e),a.setDataField("SeedingStatus",this.seedingStatus);let l=!1;e&&(this.hasSessionConnected&&(this.allowSeed=!0,this.allowGroupSeed=!0,l=this.changeSeedingStatus(n.e9.NotStarted,"ReconnectReset",!1),this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0)),this.cachedClaimsChallenge=Object.assign(Object.assign({},this.cachedClaimsChallenge),{claimsVersion:0})),this.enableRemoteExecutionNotification&&!this.hasSessionConnected&&this.addDownstreamWorkflowsIntoClientGraph(s),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:o,authToken:i},this.hasSessionConnected=!0,this.tryActivateWorkflows();for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallbacks.forEach(((n,r)=>{n(e,t,o,i)})),l&&this.triggerSeedingStatusChangeCallbacks(),this.serverInputTypes=r,this.onConnectTelemetryCG&&se(a)}onDisconnect(e){this.connectParams=void 0,this.disconnectCallbacks.forEach(((t,o)=>{t(e)}))}onSeedingStatusChangeMessage(e,t){t(void 0,new r.YK),this.changeSeedingStatus(e.newStatus,"SeedingStatusChangeMessage")}changeSeedingStatus(e,t,o=!0){const i=new S.I({operationName:"SeedingStatusChange",success:!0}).setClientMetadata(this.clientMetadata).start();return i.setDataField("Status",n.e9[e]),i.setDataField("Reason",t),se(i),this.seedingStatus!=e&&(this.seedingStatus=e,o&&this.triggerSeedingStatusChangeCallbacks(),!0)}triggerSeedingStatusChangeCallbacks(){this.seedingStatusChangeCallbacks.forEach((e=>{e(new r.fr({newStatus:this.seedingStatus}))}))}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==i.f.Authenticated&&e==i.f.Pending)return;const t=new S.I({operationName:"ServerAuthStateChange",dimension0:i.f[e],dimension1:i.f[this.serverAuthenticationState],success:!0}).setClientMetadata(this.clientMetadata).start();t.resultDescription=`Changing Server Authentication State newState: ${i.f[e]}, previousState: ${i.f[this.serverAuthenticationState]}`,se(t),this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t,o,i){if(0===this.annotationCallbacks.size&&0===this.apologyCallbacks.size)return;const n=i?this.apologyCallbacks.get(t):this.annotationCallbacks.get(t);n&&n.forEach((t=>{t(e,o)}))}getOperationBatchConfig(e){let t;return t=this.batchMessagesEnabled?e=>({input:e,demultiplex:()=>[[]]}):e=>({input:e.filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]}),{delayMs:e.delayMs,delayMsMax:e.delayMsMax,maxInputSize:e.maxInputSize,estimateSize:U,groupingKeyExtractor:()=>"operations",multiplex:t,split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,o){if(!this.seedBatchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,o)=>{if(this.batchedSeedMessageGroupSize+=e.length,e.length){const i=new r.l0;i.messages=[],e.forEach((e=>{i.messages.push(new r.Tb({cv:e.cv,seq:0,ops:e.input,groupId:"Seed",groupSize:t.groupComplete?this.batchedSeedMessageGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}))})),this.sendMessageToSession(i,(e=>{o(e?new Error(e.error):void 0)}))}}:(e,t,o)=>{this.seedGroupSize++,this.sendMessageToSession(new r.Tb({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{o(e?new Error(e.error):void 0)}))},this.seedBatchedOperationsManager=new T(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},o,t)}onAnnotationResultsFromServer(e,t){(0,oe.M4)(e,Date.now(),"ReceiveFromNetwork",!0,new S.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.onAnnotationResults(e,ee.ServerWorkflow,t)}getLocalRegisteredWorkflows(){return this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>(0,M._$)(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new S.I({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),o=new r.TV({upstreamRuntimeWorkflows:e});this.sendMessageToSession(o,((o,i)=>{o?se(t,o.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${i.downstreamRuntimeWorkflows.map((e=>e.id))}`,se(t),this.onWorkflowGraphInitResponse(i))}))}trySendWorkflowGraphInitMessage(){!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&(this.graphInitMessageTimer=setTimeout((()=>{this.graphInitMessageTimer=void 0,this.sendWorkflowGraphInitMessage()}),10))}onWorkflowGraphInitResponse(e){this.addDownstreamWorkflowsIntoClientGraph(e.downstreamRuntimeWorkflows),this.tryActivateWorkflows()}addDownstreamWorkflowsIntoClientGraph(e){this.workflowGraph.removeWorkflows(!0);for(const t of e||[])this.workflowGraph.addWorkflow(t,!0);this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(C.tG.info(540848914,C.nh.CoreDefault,`Replacing user context placeholder for: ${(0,A.M6)(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(C.tG.info(540848915,C.nh.CoreDefault,`Replacing tenant context placeholder for: ${(0,A.M6)(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return(0,I.zX)(e,this.serverInputTypes)}executeCallbacksOnAnnotationSubmitted(e,t){const{annotationOpsMap:o,apologyOpsMap:i}=this.getAnnotationOperationsByType(e);o.forEach(((e,o)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,o,t,!1)))})),i.forEach(((e,o)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,o,t,!0)))}))}partitionAnnotationOperations(e){return e.reduce((([e,t],o)=>o.items.some((e=>e.body&&h.YH.typeGuard(e.body)))?[[...e,o],t]:[e,[...t,o]]),[[],[]])}onAnnotationsSubmitted(e,t){const{annotationOpsMap:o,apologyOpsMap:i}=this.getAnnotationOperationsByType(e);o.forEach(((e,o)=>{const i=Array.from(e);this.onAnnotationResults(new r.B_({annotationType:o,ops:i,cv:t,areApologies:!1}),ee.Submitted,(()=>{}))})),i.forEach(((e,o)=>{const i=Array.from(e);this.onAnnotationResults(new r.B_({annotationType:o,ops:i,cv:t,areApologies:!0}),ee.Submitted,(()=>{}))}))}getAnnotationOperationsByType(e){const t=new Map,o=new Map;for(const i of e)for(const e of i.items)if(e.body&&h.YH.typeGuard(e.body)){const n=(e,t)=>{const o=e.get(t)||new Set;o.add(i),e.set(t,o)};g.typeGuard(e.body)?n(o,e.body.annotationTypeName):n(t,u.h.getTypeNameFor(e.body))}return{annotationOpsMap:t,apologyOpsMap:o}}onClaimsChallengeMessage(e,t){var o;const i=new S.I({operationName:"OnClaimsChallengeMessage",dimension0:e.claimsVersion.toString(),dimension1:e.error,success:!0}).setClientMetadata(this.clientMetadata).start(),n=e.claims&&e.claims.length>0;i.resultSignature=`HasClaims: ${n}`,i.resultDescription="Received Claims Challenge Message from Server",se(i),e.claimsVersion>this.cachedClaimsChallenge.claimsVersion&&(this.cachedClaimsChallenge=Object.assign(Object.assign({},e),{actionRequired:!0})),(null===(o=this.gateUtils)||void 0===o?void 0:o.isChangeGateEnabledSync(ie.Nd))?this.requestAuthTokenInteractive(e).then((e=>{r.D0.typeGuard(e)&&this.invokeClaimsChallengeCallbacks()})).catch((()=>{})):this.invokeClaimsChallengeCallbacks(),t(void 0,new r.YK)}generateCorrelationId(){return this.sessionManager.getCorrelationVector().newChild().toString()}onTokenProvisionResponse(e){if(!e)return;const t=e.tokenType&&e.tokenType==x.OY.WacUserInfo?i.f.WacUserInfoAuthenticated:i.f.Authenticated;this.onServerAuthenticationStateChange(t)}invokeClaimsChallengeCallbacks(){for(const e of this.claimsChallengeCallback)e(this.cachedClaimsChallenge)}requestAuthTokenWithClaims(e){this.requestAuthTokenInteractive(e).catch((()=>{}))}requestAuthTokenInteractive(e,t){var o;const i=new S.I({operationName:"RequestAuthTokenInteractive",success:!0,dimension0:`isInteractive: ${null!==(o=null==t?void 0:t.interactive)&&void 0!==o&&o}`}).start();i.dimension1=`HasClaims: ${!!e.claims&&e.claims.length>0}`;const n={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:b.OY.Augloop,ConnectParams:this.connectParams,Claims:e.claims,Interactive:null==t?void 0:t.interactive};return this.hostCallbacks.requestAuthToken(n).then((t=>{if(!t)throw new Error("Missing AuthTokenResponse from requestAuthToken claims");if(!t.Token)throw new Error("Missing Token from requestAuthToken claims");return i.resultSignature="Token",new r.kd({authToken:t.Token,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})})).catch((t=>(i.resultSignature="NoToken",i.dimension2=t.message,new r.D0({reason:t.message,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion,clientHandlesResponse:!0})))).then((e=>new Promise(((t,o)=>{this.sendMessageToSession(e,((n,s)=>{se(i,null==n?void 0:n.error),n?o(new Error(n.error)):(r.kd.typeGuard(e)&&(this.cachedClaimsChallenge.actionRequired=!1,this.onTokenProvisionResponse(s)),t(e))}))}))))}}le.requestCancelledError="Request cancelled"},86391:(e,t,o)=>{"use strict";o.d(t,{yq:()=>g,Aq:()=>h,ZF:()=>p,zX:()=>f});var i,n=o(41856),r=o(90456);!function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(i||(i={}));var s=o(60859),a=o(99795),l=o(67336),c=o(31733),u=o(26394),d=o.n(u);class h{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:i.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:i.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:e}}static isFeatureEnabled(e,t,o=!1,i="None"){return e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,i).catch((()=>Promise.resolve(o))):Promise.resolve(o)}static isChangeGateEnabled(e,t){return e&&e.isChangeGateEnabled?e.isChangeGateEnabled(t):Promise.resolve(!1)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const o=e.split(":");let i=o[0].toLowerCase();return 0==i.indexOf(t?"http":"ws")?(i=t?i.replace("http","ws"):i.replace("ws","http"),o[0]=i,o.join(":")):e}static deepEquals(e,t){return d()(e,t)}static collectTelemetry(e,t,o,i,r,s){var a,l,c,u;e.start(),e.resultSignature=null!=i?i:"",e.resultDescription=null!=r?r:"",e.success=o,s?(e.dimension0=null!==(a=s[0])&&void 0!==a?a:"",e.dimension1=null!==(l=s[1])&&void 0!==l?l:"",e.dimension2=null!==(c=s[2])&&void 0!==c?c:"",e.dimension3=null!==(u=s[3])&&void 0!==u?u:""):(e.dimension0="",e.dimension1="",e.dimension2="",e.dimension3=""),t.log((()=>n.tG.info(508367457,n.nh.CoreDefault,e.stop())))}}h.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class g{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new r.I({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});n.tG.warn(572838107,n.nh.CoreDefault,e)}}}s.h.getTypeName(),a.YH.getTypeName(),l.HN.getTypeName();const p=(e,t=0)=>Number.isFinite(e)?e:t,f=(e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(c.xU.typeGuard(e)||c.XP.typeGuard(e))return!0;for(const o of e.items)if(!o.body||s.h.matchesTypesFor(o.body,t))return!0;return!1}},22162:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>s}),3023==o.j)var i=o(10510);if(3023==o.j)var n=o(60859);class r{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=(0,i.M6)(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Error("Method not implemented.")}getContextItemBodies(e){throw new Error("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class s{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&n.h.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&n.h.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented yet")},this.items=[...t,e],this.scopeItem=new r(e)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}},37218:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{OY:()=>n}),function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(i||(i={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(r||(r={}))},38238:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{OY:()=>n,Pu:()=>r}),function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(i||(i={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(r||(r={}))},1554:(e,t,o)=>{"use strict";var i,n;o.d(t,{K:()=>n}),function(e){e[e.Input=0]="Input",e[e.Exception=1]="Exception",e[e.WaitOn=2]="WaitOn",e[e.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(n||(n={}))},10510:(e,t,o)=>{"use strict";o.d(t,{CY:()=>n,M6:()=>r});const i="\\",n=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),r=e=>Array.isArray(e)?5===e.length?`${e[0]}${i}${e[1]}${i}${e[2]}${i}${e[3]}${i}${e[4]}`:4===e.length?`${e[0]}${i}${e[1]}${i}${e[2]}${i}${e[3]}`:3===e.length?`${e[0]}${i}${e[1]}${i}${e[2]}`:2===e.length?`${e[0]}${i}${e[1]}`:1===e.length?e[0]:e.join(i):"(malformed path)"},59294:(e,t,o)=>{"use strict";o.d(t,{Qr:()=>g,x5:()=>p});var i=o(60859);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowCancellationRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingRequest","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){i.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()}},55887:(e,t,o)=>{"use strict";var i,n;o.d(t,{l6:()=>n,yv:()=>i}),function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets",e[e.HttpFallback=3]="HttpFallback"}(i||(i={})),function(e){e.Workflow="Workflow",e.Client="Client",e.HttpEndpoint="HttpEndpoint"}(n||(n={}))},13674:(e,t,o)=>{"use strict";var i;o.d(t,{f:()=>i}),function(e){e[e.NotAuthenticated=0]="NotAuthenticated",e[e.Pending=1]="Pending",e[e.Authenticated=2]="Authenticated",e[e.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated",e[e.TokenMissingInteractionRequired=4]="TokenMissingInteractionRequired"}(i||(i={}))},46875:(e,t,o)=>{"use strict";o.d(t,{$j:()=>x,B_:()=>F,D0:()=>N,F_:()=>h,GA:()=>_,Gs:()=>H,LQ:()=>m,Ol:()=>E,PY:()=>T,Sy:()=>te,TV:()=>L,Tb:()=>R,VR:()=>M,YK:()=>r,Yp:()=>a,Zy:()=>b,_p:()=>d,eE:()=>p,fZ:()=>D,fr:()=>W,i:()=>s,kd:()=>O,l0:()=>A,n4:()=>k,ru:()=>g,ry:()=>v,uN:()=>f,w9:()=>w,z_:()=>C});var i=o(60859);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionError"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsClientError"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsErrorInfo"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){i.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class m{constructor(e){i.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class v{constructor(e){i.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){i.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class y{constructor(e){i.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(e){return i.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class w{constructor(e){i.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class C{constructor(e){i.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class S{constructor(e){i.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class k{constructor(e){i.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class T{constructor(e){i.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class x{constructor(e){i.h.assign(x,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class _{constructor(e){i.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class I{constructor(e){i.h.assign(I,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class E{constructor(e){i.h.assign(E,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class B{constructor(e){i.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class A{constructor(e){i.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class R{constructor(e){i.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class M{constructor(e){i.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class D{constructor(e){i.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class P{constructor(e){i.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class F{constructor(e){i.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class O{constructor(e){i.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class N{constructor(e){i.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenFailureMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class q{constructor(e){i.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class j{constructor(e){i.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class L{constructor(e){i.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class z{constructor(e){i.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class H{constructor(e){i.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class W{constructor(e){i.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SeedingStatusChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class U{constructor(e){i.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class G{constructor(e){i.h.assign(G,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class V{constructor(e){i.h.assign(V,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class ${constructor(e){i.h.assign($,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[$.getTypeName()])}}$.H_={T_:$.getTypeName(),B_:$.getBaseTypes()};class K{constructor(e){i.h.assign(K,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class J{constructor(e){i.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class Y{constructor(e){i.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class Q{constructor(e){i.h.assign(Q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class Z{constructor(e){i.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class X{constructor(e){i.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class ee{constructor(e){i.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{constructor(e){i.h.assign(te,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ClaimsChallengeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class oe{constructor(e){i.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BlobUploadResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class ie{constructor(e){i.h.assign(ie,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return i.h.matchesTypesFor(e,[ie.getTypeName()])}}ie.H_={T_:ie.getTypeName(),B_:ie.getBaseTypes()};class ne{constructor(e){i.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return i.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()}},92313:(e,t,o)=>{"use strict";if(o.d(t,{Ef:()=>p,N0:()=>C}),3023==o.j)var i=o(48837);if(3023==o.j)var n=o(41856);if(3023==o.j)var r=o(90456);if(3023==o.j)var s=o(70217);var a=o(9915);if(3023==o.j)var l=o(76019);if(3023==o.j)var c=o(60859);if(3023==o.j)var u=o(94878);if(3023==o.j)var d=o(46875);if(3023==o.j)var h=o(4064);const g=new a.eU("processMessageEndpointValidation",!1);var p,f;function m(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let o;for(const i of t)if(0===e.indexOf(i)){o=i;break}if(!o)return"MalformedMessageName";const i=e.indexOf("Message",e.length-7)===e.length-7;return e.slice(o.length,i?-7:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.ClientClosed="Client closed",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found",e.TooManyDeltaOperations="SyncMessage with too many delta operations",e.UnsupportedSyncMessageSeq0NonSeeding="SyncMessages with seq 0 are not supported in non seeding sequencer (SenderId)."}(p||(p={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(f||(f={}));const v=3023==o.j?12e4:null,b=3023==o.j?15e3:null,y=3023==o.j?3e5:null,w=3023==o.j?12e4:null;class C{constructor(e){this.config=e,this.nextMessageId=1,this.pendingResponseCallbacks=new h.l({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageValidators=new Map,this.messageIdPrefix=e.messageIdPrefix,this.source="c"===e.messageIdPrefix?i.aM.ClientRuntime:i.aM.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e,this.config.resendPendingMessagesOnReconnect&&this.egress&&this.pendingResponseCallbacks.forEach(((e,t)=>{e.logOp.dimension1=(e.sendCount++).toString(),this.egress(e.message,(t=>this.onEgressError(t,e)))}))}ingress(e,t){d.YK.typeGuard(e)?(this.processResponse(e),t()):this.processMessage(e,t),d.w9.typeGuard(e)&&!e.reconnectAllowed&&this.clearAllPendingResponses()}sendMessage(e,t,o,r=0){var s,a;const h=new i.vf({sessionHealthEventName:"SendMessage",source:this.source,reason:i.l6.Client,impact:this.source===i.aM.ClientRuntime?i.Pq.MissingInput:i.Pq.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:m(c.h.getTypeNameFor(e)),dimension0:r.toString()}).start(),g=()=>{if(h.setClientMetadata(this.clientMetadata),h.success)n.tG.info(572836e3,n.nh.CoreDefault,h.stop());else{const e="ErrorWithoutPendingResponse"===h.resultSignature||"ResponseCallbackException"===h.resultSignature||"We called into done callback"!==h.message;h.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),n.tG.error(572836001,n.nh.CoreDefault,h.stop())}};(0,l.I)("PersistMessageId")?e.messageId=null!==(s=e.messageId)&&void 0!==s?s:`${this.messageIdPrefix}${this.nextMessageId++}`:e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`,d.l0.typeGuard(e)&&e.messages.forEach(((t,o)=>t.messageId=e.messageId+"."+o));const p=c.h.getTypeNameFor(e)===d.w9.getTypeName(),f={message:e,logOp:h,logEvent:g,callback:void 0,sendCount:1};if(!o&&!p){f.callback=(o,i)=>{var n;if(o?(0,l.I)("IgnoreUnsupportedMessageErrorForOldClientVersion")&&o.code===u.xv.UnsupportedMessage?(h.resultSignature="Success",h.resultDescription=`Ignore error for ${c.h.getTypeNameFor(e)} message ${e.messageId}${d.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${o.error}`):(h.success=!1,h.resultSignature=o.error,h.resultDescription=`Error for ${c.h.getTypeNameFor(e)} message ${e.messageId}${d.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${o.error}`):h.resultSignature="Success",t)try{h.message="We called into done callback",t(o,i)}catch(e){h.success=!1,h.resultSignature="ResponseCallbackException",h.resultDescription="Web"===(null===(n=this.clientMetadata)||void 0===n?void 0:n.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}g(),this.updateSendMessageStats(h.success,h.durationMs,o?new Error(o.error):void 0)};const o=()=>{f.callback(new d.F_({code:u.xv.RequestTimeout,error:"Timeout waiting for response"}),void 0)};let i=this.config.responseTimeoutMs;if(d.LQ.typeGuard(e)){const t=e;i=t.longPollTimeoutHint>=b&&t.longPollTimeoutHint<=y?t.longPollTimeoutHint+5e3:v}else d.Yp.typeGuard(e)&&(i=null!==(a=e.maxDelayMs)&&void 0!==a?a:w);this.pendingResponseCallbacks.put(e.messageId,f,i,o)}this.egress&&this.egress(e,(e=>this.onEgressError(e,f)),r)}onEgressError(e,t){var o,i;if(e){const n=t.message,r=this.pendingResponseCallbacks.get(t.message.messageId);r?(this.pendingResponseCallbacks.del(n.messageId),r.callback(new d._p({messageId:n.messageId,code:u.xv.EgressError,error:e.message}))):d.w9.typeGuard(n)?(t.logOp.success=null!==(i=null===(o=e.message)||void 0===o?void 0:o.endsWith("Client disconnected."))&&void 0!==i&&i,t.logOp.resultSignature="ErrorSendingSessionCloseMessage",t.logOp.resultDescription=`Error for ${c.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent()):(t.logOp.success=!1,t.logOp.resultSignature="ErrorWithoutPendingResponse",t.logOp.resultDescription=`Error for ${c.h.getTypeNameFor(n)} message ${n.messageId}: ${e.message}`,t.logEvent())}}queryEgressCacheSize(){return this.pendingResponseCallbacks.size()}onMessage(e,t,o){this.messageCallbacks.set(e,t),o&&this.messageValidators.set(e,o)}onMessageAsync(e,t,o){this.messageCallbacks.set(e,((e,o)=>{return i=this,n=void 0,s=function*(){try{const i=yield t(e);d._p.typeGuard(i)?o(i,void 0):o(void 0,i)}catch(e){o(e)}},new((r=void 0)||(r=Promise))((function(e,t){function o(e){try{l(s.next(e))}catch(e){t(e)}}function a(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r((function(e){e(i)}))).then(o,a)}l((s=s.apply(i,n||[])).next())}));var i,n,r,s})),o&&this.messageValidators.set(e,o)}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(e){this.pendingResponseCallbacks.forEach(((t,o)=>{t&&(this.pendingResponseCallbacks.del(o),t.callback(new d._p({messageId:o,code:u.xv.Cancelled,error:`Cancelled. Reason: ${e}`})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new r.I({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});n.tG.info(572836002,n.nh.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){const o=new i.vf({sessionHealthEventName:"ProcessMessage",source:this.source,reason:i.l6.Client,impact:this.source===i.aM.ClientRuntime?i.Pq.MissingOutput:i.Pq.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start(),r=()=>{if(o.setClientMetadata(this.clientMetadata),o.success)n.tG.info(572836003,n.nh.CoreDefault,o.stop());else{const e="UnsupportedMessage"===o.resourceId||"Timeout"===o.resultSignature||"OnResponseInvokedMoreThanOnce"===o.resultSignature||"MessageCallbackException"===o.resultSignature||"We called into messageCallback"!==o.message;o.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),n.tG.error(572836032,n.nh.CoreDefault,o.stop())}};let a=this.messageCallbacks.get(c.h.getTypeNameFor(e));a?o.resourceId=m(c.h.getTypeNameFor(e)):a=(e,t)=>{o.resourceId=m(c.h.getTypeNameFor(e)),"MalformedMessageName"!==o.resourceId&&(o.resourceId="UnsupportedMessage"),t(new d._p({messageId:e.messageId,code:u.xv.UnsupportedMessage,error:`Message type ${c.h.getTypeNameFor(e)} is not supported`}))};const l=(e,t,o)=>!0===g.getValue()?JSON.stringify({message:e,validationSuccess:null==t?void 0:t.success,validationError:null==t?void 0:t.error,validationDurationMicroseconds:null==t?void 0:t.durationMicroseconds,stack:o}):void 0!==o?JSON.stringify({message:e,stack:o}):e;let h;const p=this.messageValidators.get(c.h.getTypeNameFor(e));if(p&&g.getValue()){const t=(0,s.g)(),o=p.validate(e),i=(0,s.g)();h={success:o.success,error:o.error,durationMicroseconds:Math.round(i-t)}}let f=!1;const v=(i,n)=>{if(f){o.success=!1,o.resultSignature="OnResponseInvokedMoreThanOnce";const t=`Invoked onResponse for ${c.h.getTypeNameFor(e)} message ${e.messageId} more than once`;o.resultDescription=l(t,h)}else if(i){o.success=!1,o.resultSignature=i.error,void 0!==i.code&&(o.dimension0=u.xv[i.code]);const t=`Error for ${c.h.getTypeNameFor(e)} message ${e.messageId}: ${i.error}`;o.resultDescription=l(t,h)}else o.resultSignature="Success",o.resultDescription=l("",h);f=!0,r(),i&&!c.h.matchesTypesFor(i,[d._p.getTypeName()])&&(i=new d._p({error:"Internal Server Error"})),this.updateProcessMessageStats(o.success,o.durationMs,i?new Error(i.error):void 0),i?(i.messageId=e.messageId,t(i)):n?(n.messageId=e.messageId,t(void 0,n)):t()};try{o.message="We called into messageCallback",a(e,v)}catch(e){o.success=!1,o.resultSignature="MessageCallbackException",o.resultDescription=l(e.message,h,e.stack),r(),this.updateProcessMessageStats(!1,o.durationMs,e),t()}}processResponse(e){var t;const o=new r.I({operationName:"ProcessResponse"});if(o.success=!0,o.setClientMetadata(this.clientMetadata),o.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId),i=null==t?void 0:t.callback;if(i){if(d.i.typeGuard(e)&&!e.finalResponse){const o=t.message.maxDelayMs;this.pendingResponseCallbacks.updateExpireTime(e.messageId,o)}else this.pendingResponseCallbacks.del(e.messageId);c.h.matchesTypesFor(e,[d._p.getTypeName()])?i(e):i(void 0,e)}else o.resultSignature="NoPendingMessage",o.resultDescription=`${e.messageId}`,o.success=!1}else o.resultSignature="NoMessageIdSetInResponse",d._p.typeGuard(e)?o.resultDescription=e.error:o.resultDescription="MessageId is not available",o.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(o.resourceId=m(c.h.getTypeNameFor(e)),n.tG.info(572836034,n.nh.CoreDefault,o.stop()))}updateSendMessageStats(e,t,o){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||o?e&&o&&n.tG.warn(572836036,n.nh.CoreDefault,"Succeeded send message provided error object."):n.tG.warn(572836035,n.nh.CoreDefault,"Failed send message did not provide error object."),e||(o&&o.message===p.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,o){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||o?e&&o&&n.tG.warn(572836038,n.nh.CoreDefault,"Succeeded process message provided error object."):n.tG.warn(572836037,n.nh.CoreDefault,"Failed process message did not provide error object."),e||(o&&o.message===f.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}},94878:(e,t,o)=>{"use strict";o.d(t,{K7:()=>c,PO:()=>a,Qn:()=>n,e9:()=>u,mH:()=>i,xv:()=>s,zy:()=>r});const i=2;var n,r,s,a,l,c,u;!function(e){e[e.ServerError=0]="ServerError",e[e.WorkflowDisabled=100]="WorkflowDisabled",e[e.TokenNotReady=101]="TokenNotReady",e[e.FlightNotReady=102]="FlightNotReady",e[e.ContextNotReady=103]="ContextNotReady",e[e.WorkflowExcluded=104]="WorkflowExcluded",e[e.WorkflowExecutionTimeout=105]="WorkflowExecutionTimeout",e[e.LambdaExecutionError=106]="LambdaExecutionError",e[e.UnexpectedOutput=107]="UnexpectedOutput",e[e.FailedToFetchInputs=108]="FailedToFetchInputs"}(n||(n={})),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidRequest=1]="InvalidRequest",e[e.InvalidResponse=2]="InvalidResponse",e[e.RuntimeNotInitialized=3]="RuntimeNotInitialized",e[e.RequestCancelled=4]="RequestCancelled",e[e.ResponseReceivedAfterFinalResponse=5]="ResponseReceivedAfterFinalResponse"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.Found=302]="Found",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.UnprocessableContent=422]="UnprocessableContent",e[e.TooManyRequests=429]="TooManyRequests",e[e.SocketDisconnect=499]="SocketDisconnect",e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.UnsupportedMessage=1e3]="UnsupportedMessage",e[e.Cancelled=1001]="Cancelled",e[e.EgressError=1002]="EgressError",e[e.SyncMessageException=2e3]="SyncMessageException",e[e.SyncMessageUnsupported=2001]="SyncMessageUnsupported",e[e.SyncMessageUnexpectedSeed=2002]="SyncMessageUnexpectedSeed",e[e.SyncMessageUnsupportedBatch=2003]="SyncMessageUnsupportedBatch",e[e.SyncMessageQueueFull=2004]="SyncMessageQueueFull",e[e.SyncMessageTooLateOrDuplicate=2005]="SyncMessageTooLateOrDuplicate",e[e.SyncMessageGroupIdMismatch=2006]="SyncMessageGroupIdMismatch",e[e.SyncMessageGroupStop=2007]="SyncMessageGroupStop",e[e.SyncMessageLost=2008]="SyncMessageLost",e[e.SyncMessageUnprocessedDuplicate=2009]="SyncMessageUnprocessedDuplicate",e[e.SyncMessageSessionClosed=2010]="SyncMessageSessionClosed",e[e.SyncMessageAbandoned=2011]="SyncMessageAbandoned",e[e.SyncMessageTooManyDeltaOperations=2012]="SyncMessageTooManyDeltaOperations",e[e.SyncMessageSessionSizeLimitExceeded=2013]="SyncMessageSessionSizeLimitExceeded",e[e.TokenValidationError=2100]="TokenValidationError",e[e.TokenDecryptError=2101]="TokenDecryptError",e[e.TokenTypeError=2102]="TokenTypeError",e[e.TokenUserBlocked=2103]="TokenUserBlocked",e[e.AnnotationActivationInvalidType=2200]="AnnotationActivationInvalidType",e[e.AnnotationReleaseTokenNotFound=2300]="AnnotationReleaseTokenNotFound"}(s||(s={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.Start=1]="Start",e[e.Regular=2]="Regular",e[e.CheckConnection=3]="CheckConnection",e[e.PostEgress=4]="PostEgress",e[e.TimeoutResend=5]="TimeoutResend",e[e.FailResend=6]="FailResend"}(a||(a={})),function(e){e[e.IdentityChange=0]="IdentityChange"}(l||(l={})),function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(c||(c={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Incomplete=2]="Incomplete",e[e.Finished=3]="Finished"}(u||(u={}))},76019:(e,t,o)=>{"use strict";o.d(t,{I:()=>n});const i=new(o(9915).eU)("disabledChangeGates",[]),n=(e,t,...o)=>{const n=-1===i.getValue().indexOf(e);return t?n?t(...o):void 0:n}},9915:(e,t,o)=>{"use strict";o.d(t,{eU:()=>g});var i,n,r=o(41856),s=o(90456),a=o(26394),l=o.n(a);class c{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}!function(e){e.Add="Add",e.Remove="Remove",e.Set="Set",e.Delete="Delete"}(n||(n={}));class u{static applyECSPatchOperation(e,t){let o=!1;if("object"==typeof t||Array.isArray(t))switch(e.operation){case n.Add:case n.Remove:o=u.applyAddOrRemoveOperation(e.path,t,e.value,e.operation);break;case n.Set:o=u.applySetOperation(e.path,t,e.value);break;case n.Delete:o=u.applyDeleteOperation(e.path,t,e.value)}return o?r.tG.verbose(505956121,r.nh.CoreDefault,`PATCH operation succeeded for ${e.operation} on ${e.settingName} with path: ${e.path}.`):r.tG.error(505956122,r.nh.CoreDefault,`PATCH operation failed for ${e.operation} on ${e.settingName} with path: ${e.path}`),o}static applyAddOrRemoveOperation(e,t,o,i){let s=!1;try{let r=[];if("object"!=typeof t||Array.isArray(t)?Array.isArray(t)&&(r=t):r=e.reduce(((e,t)=>e&&e[t]),t),Array.isArray(r))if(i===n.Add)r.push(o),s=!0;else if(i===n.Remove){const e=r.indexOf(o);e>=0&&(r.splice(e,1),s=!0)}}catch(e){r.tG.info(505968832,r.nh.CoreDefault,`Exception thrown while applying operation type: ${i} for an array. Error: ${e}`),s=!1}return s}static applySetOperation(e,t,o){let i=!1;try{const n=e.slice(0,-1),r=e[e.length-1];let s={};"object"!=typeof t||Array.isArray(t)||(s=n.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof s||Array.isArray(s)||(s[r]=o,i=!0))}catch(e){r.tG.info(505968802,r.nh.CoreDefault,`Exception thrown while applying set operation. Error: ${e}`),i=!1}return i}static applyDeleteOperation(e,t,o){let i=!1;try{let n={};"object"!=typeof t||Array.isArray(t)||(n=e.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof n||Array.isArray(n)||"string"!=typeof o||n.hasOwnProperty(o)&&(delete n[o],i=!0))}catch(e){r.tG.info(505968801,r.nh.CoreDefault,`Exception thrown while applying delete operation. Error: ${e}`),i=!1}return i}}i=u,u.parseECSOperation=(e,t)=>{if(!t.hasOwnProperty("operationType")||!t.hasOwnProperty("path")||!t.hasOwnProperty("value"))throw new Error(`Invalid format for PATCH operation on setting: ${e}`);const o=t.operationType.toLowerCase(),n=i.convertToConfigPatchOperationType(o);return{settingName:e,path:t.path?t.path.split("."):[],operation:n,value:t.value}},u.convertToConfigPatchOperationType=e=>{switch(e){case"add":return n.Add;case"remove":return n.Remove;case"set":return n.Set;case"delete":return n.Delete;default:throw new Error(`Invalid operation type: ${e}`)}};var d=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class h extends c{constructor(e){super(),this.name=e}static initEcsSettingsProvider(e){r.tG.info(505999498,r.nh.CoreDefault,"Initializing ECS settings provider."),h.ecsSettingsProvider=e}static enableEcsPatchConfig(e){h.ecsPatchConfigEnabled=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new h(e);const o=h.tryGetConfigProperty(h.currentConfig,e);o.success&&t.updateValue(o.value),this.allSettings.set(e,t)}return t}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new h(e)};const o=h.tryGetConfigPropertyByPattern(h.currentConfig,t.regex);t.setting.updateValue(o),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){h.currentConfig=e,r.tG.info(572837966,r.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),h.allSettings.forEach(((e,t)=>{const o=h.tryGetConfigProperty(h.currentConfig,t).value;e.updateValue(o)&&(r.tG.info(572837967,r.nh.CoreDefault,`Setting new value for ${t}: ${o instanceof Object?JSON.stringify(o):o}`),e.notifyListeners(o))})),h.allPatternSettings.forEach(((t,o)=>{const i=h.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(i)&&(r.tG.info(508432774,r.nh.CoreDefault,`Setting new value for pattern ${o}: ${JSON.stringify(i)}`),t.setting.notifyListeners(i))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:h.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const o=[];if(e){const i=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of i)o.push({name:t,value:h.selectApplicableValue(e[t])})}return o}static setGlobalFilter(e){h.globalFilter=e}static setLocalConfig(e){h.localConfig=e,r.tG.info(506053841,r.nh.CoreDefault,`Setting localConfig field in Setting class: ${JSON.stringify(h.localConfig)}`)}static clear(){h.currentConfig=void 0,h.localConfig=void 0,h.allSettings.clear(),h.allPatternSettings.clear(),h.ecsSettingsProvider=void 0}static selectApplicableValue(e){let t;if(e){const o=e.find((e=>!h.globalFilter||h.globalFilter(e)));o&&(t=o.value)}return t}getName(){return this.name}getValue(){if(function(){var e;return void 0!==globalThis.process&&"true"===(null===(e=globalThis.process.env)||void 0===e?void 0:e.VALIDATE_CORRECT_USAGE_OF_GET_VALUE)}()&&0===this.listeners.size){const e=new Error(`SettingInstance or ChangeGate is being used incorrectly. Make sure .getValue() or ChangeGate is called during runtime or there is a listener set up on the setting. For more info visit: ${h.troubleshootUrl}`);throw e.name="Incorrect usage of getValue()",e}return this.value}getValueAdvancedAsync(e){return d(this,void 0,void 0,(function*(){const t=new s.I({operationName:"ECSGetValueAsync"},{metricDuration:!0}).start();let o;try{const i=yield h.ecsSettingsProvider.getSettingValue(this.name,e);t.dimension0=i.userAuthenticated?"Authenticated":"Anonymous",t.success=!0;let n=i.value;return n||(n=h.tryGetConfigProperty(h.localConfig,this.name).value,n&&i.patchValue&&(n=h.applyPatchOperationOnSetting(this.name,n,i.patchValue))),o=`Setting value for ${this.name} is ${JSON.stringify(n)}.`,n}catch(e){t.success=!1;const i=h.tryGetConfigProperty(h.localConfig,this.name).value;return o=`Setting value for ${this.name} is ${JSON.stringify(i)}.`,i}finally{r.tG.info(506053839,r.nh.CoreDefault,t.stop()),r.tG.info(505821320,r.nh.CoreDefault,o)}}))}updateValue(e){return!l()(this.value,e)&&(r.tG.info(572837968,r.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}static applyPatchOperationsOnConfig(e){try{if(!h.ecsPatchConfigEnabled)return e;const t=this.tryGetConfigProperty(e,"patchOperations").value;if(!t||0===t.length)return e;const o=[];for(const[e,i]of Object.entries(t))try{o.push(u.parseECSOperation(e,i))}catch(t){r.tG.error(505734922,r.nh.CoreDefault,`Exception thrown while parsing ECS PATCH operation for setting: ${e}. Error: ${t}`);continue}const i=new Map;for(const t of o)if(null==e?void 0:e.hasOwnProperty(t.settingName)){const o=JSON.parse(JSON.stringify(e[t.settingName])),n=h.selectApplicableValue(o);u.applyECSPatchOperation(t,n)&&(i.set(t.settingName,n),e[t.settingName]=o)}return i.size>0&&r.tG.info(505788322,r.nh.CoreDefault,`Resulting settings after PATCHes were applied: ${JSON.stringify(Object.fromEntries(i))}`),e}catch(t){return r.tG.error(505788321,r.nh.CoreDefault,`Exception thrown while applying ECS PATCH operations. Error: ${t}`),e}}static applyPatchOperationOnSetting(e,t,o){try{if(!h.ecsPatchConfigEnabled)return t;const i=JSON.parse(JSON.stringify(t)),n=o,r=u.parseECSOperation(e,n);return u.applyECSPatchOperation(r,i),i}catch(e){return r.tG.error(505788323,r.nh.CoreDefault,`Exception thrown while applying ECS PATCH operation on setting. Error: ${e}`),t}}}h.allSettings=new Map,h.allPatternSettings=new Map,h.ecsPatchConfigEnabled=!1,h.troubleshootUrl="https://eng.ms/docs/experiences-devices/opg/office-ai/augloop-ai-platform/augmentation-loop/documentation/server-workflow-tutorials/settings/troubleshoot";class g extends c{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=h.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!=this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}getValueAdvancedAsync(e){return d(this,void 0,void 0,(function*(){const t=yield this.setting.getValueAdvancedAsync(e);return void 0===t?this.defaultValue:t}))}}},21019:(e,t,o)=>{"use strict";o.d(t,{l:()=>i});class i{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){i.logIntervalError=e}put(e,t,o,i,n,r,s){if(null==o||o<=0)throw new Error("Cache timeout must be a positive number");(null==n||n<=0)&&(n=this.options.idleDurationMs);const a={value:t,lastUsed:n?Date.now():void 0,expire:o+Date.now(),idleDurationMs:n,expireCallback:i,expiringTriggerTime:r+Date.now(),expiringCallback:s};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,o)=>{e(t.value,o)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,o)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(o),void(this.options.idleCallback&&this.options.idleCallback(o,t.value));t.expire<e&&(this.del(o),t.expireCallback&&t.expireCallback(o,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(o,t.value),t.expiringCallback=void 0)}catch(e){i.logIntervalError&&i.logIntervalError(e)}}))}}},4064:(e,t,o)=>{"use strict";o.d(t,{l:()=>i});class i{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){i.logIntervalError=e}put(e,t,o,i,n,r,s){if(null==o||o<=0)throw new Error("Cache timeout must be a positive number");(null==n||n<=0)&&(n=this.options.idleDurationMs);const a={value:t,lastUsed:n?Date.now():void 0,expire:o+Date.now(),idleDurationMs:n,expireCallback:i,expiringTriggerTime:r+Date.now(),expiringCallback:s};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,o)=>{e(t.value,o)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,o)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(o),void(this.options.idleCallback&&this.options.idleCallback(o,t.value));t.expire<e&&(this.del(o),t.expireCallback&&t.expireCallback(o,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(o,t.value),t.expiringCallback=void 0)}catch(e){i.logIntervalError&&i.logIntervalError(e)}}))}}},44882:(e,t,o)=>{"use strict";var i;o.d(t,{r:()=>i}),function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(i||(i={}))},99795:(e,t,o)=>{"use strict";o.d(t,{YH:()=>n});var i=o(60859);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},31733:(e,t,o)=>{"use strict";o.d(t,{I:()=>s,XP:()=>u,Xr:()=>l,fZ:()=>d,g0:()=>w,hW:()=>c,n4:()=>h,xU:()=>b});var i=o(60859);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){i.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class m{constructor(e){i.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class v{constructor(e){i.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){i.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class y{constructor(e){i.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class w{constructor(e){i.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class C{constructor(e){i.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Core_CancelSignalTriggeredWorkflowExecutionOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()}},60859:(e,t,o)=>{"use strict";o.d(t,{h:()=>i});class i{constructor(e){i.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=i.getTypeNameFor(e);return t?[t,...i.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const o=i.getTypeNameFor(e),n=i.getBaseTypesFor(e);for(const e of t){if(e===o)return!0;if(n.indexOf(e)>=0)return!0}return!1}static assign(e,t,o){if(o)for(const e of Object.keys(o))t[e]=o[e];return t.H_=e.H_,t}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},67336:(e,t,o)=>{"use strict";o.d(t,{HN:()=>n});var i=o(60859);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},70460:(e,t,o)=>{"use strict";o.d(t,{I3:()=>c,SB:()=>m,W1:()=>p,hD:()=>f,yo:()=>l});var i=o(60859);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){i.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return i.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class m{constructor(e){i.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return i.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class v{constructor(e){i.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){i.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return i.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()}},66001:(e,t,o)=>{"use strict";var i,n;o.d(t,{J1:()=>i}),function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token",e[e.SpeAlCodedLocation=4]="SpeAlCodedLocation"}(i||(i={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(n||(n={}));class r{}r.lowerIndexBound=1,r.maxNumberOfRows=1048576,r.maxNumberOfColumns=16384,r.firstColumnName="A",r.lastColumnName="XFD"},78351:(e,t,o)=>{"use strict";o.d(t,{N0:()=>n,NC:()=>d,Xv:()=>r,Z8:()=>c,aD:()=>u,f4:()=>h,hl:()=>a,iU:()=>l,ub:()=>s});var i=o(41567);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentSuggestion"}static getBaseTypes(){return["AugLoop_SmartCompose_Suggestion","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentPrefilterTriggered"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntent"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedWithIntentHybrid"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_Prefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_FlagWithIntent"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_EntityPrediction"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()}},3764:(e,t,o)=>{"use strict";o.d(t,{A$:()=>s,R6:()=>n,aO:()=>r});var i=o(41567);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_GraphIntentDetectionSignal"}static getBaseTypes(){return["AugLoop_GraphIntentDetection_GraphIntentDetectionBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphIntentDetection_SystemInitiatedRequestSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()}},37300:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{EntityPrediction:()=>n.f4,FlagWithIntent:()=>n.NC,GraphIntentDetectionBaseSignal:()=>r.R6,GraphIntentDetectionSignal:()=>r.aO,GraphIntentPrefilterTriggered:()=>n.Xv,GraphIntentSuggestion:()=>n.N0,IntentConfidenceLevel:()=>i.Z,IntentScope:()=>i.f,Prefetch:()=>n.aD,SystemInitiatedRequestSignalHybrid:()=>r.A$,SystemInitiatedWithIntent:()=>n.hl,SystemInitiatedWithIntentBase:()=>n.ub,SystemInitiatedWithIntentClient:()=>n.iU,SystemInitiatedWithIntentHybrid:()=>n.Z8}),3023==o.j)var i=o(91473);if(3023==o.j)var n=o(78351);if(3023==o.j)var r=o(3764)},91473:(e,t,o)=>{"use strict";var i,n;o.d(t,{Z:()=>i,f:()=>n}),function(e){e[e.Unspecified=0]="Unspecified",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High"}(i||(i={})),function(e){e.FirstParty="FirstParty",e.ThirdParty="ThirdParty"}(n||(n={}))},88236:(e,t,o)=>{"use strict";o.d(t,{J_:()=>a,NG:()=>u,VL:()=>s,nm:()=>l,rQ:()=>r,t9:()=>c,xz:()=>n});var i=o(41567);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetchCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDeleteCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid"}static getBaseTypes(){return["AugLoop_GraphSearch_SearchSuggestionsAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_GraphSearch_PredictionAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_GraphSearch_NudgeAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_GraphSearch_EccAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_GraphSearch_UserInitiatedAnnotationHybrid"}static getBaseTypes(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},36943:(e,t,o)=>{"use strict";o.d(t,{$9:()=>s,Z5:()=>n,tE:()=>r,zV:()=>a});var i=o(41567);class n{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_GraphSearch_SearchSuggestionsRequest"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_GraphSearch_GraphSearchSignalHybrid"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_GraphSearch_ClientPrefetch"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_GraphSearch_StorageDelete"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},70394:(e,t,o)=>{"use strict";o.d(t,{JM:()=>n,VP:()=>r});var i=o(41567),n=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_Request"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SessionStartRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),r=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestBase"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequest"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedRequestClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedRequestBase","AugLoop_ObservationalAssistance_Request","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}())},48943:(e,t,o)=>{"use strict";o.d(t,{Cg:()=>r,qf:()=>n});var i=o(41567);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Text_CommentTile"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()}},11168:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{OD:()=>n,WI:()=>i}),function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(i||(i={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(n||(n={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(r||(r={}))},78449:(e,t,o)=>{"use strict";o.d(t,{Q:()=>n,s:()=>r});var i=o(60859);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()}},23503:(e,t,o)=>{"use strict";o.d(t,{Cg:()=>r,qf:()=>n});var i=o(60859);class n{constructor(e){i.h.assign(n,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[n.getTypeName()])}}n.H_={T_:n.getTypeName(),B_:n.getBaseTypes()};class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Text_CommentTile"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()}},16408:(e,t,o)=>{"use strict";t.pR=t.O7=t.i6=t.Jq=t.wS=t._C=void 0;const i=o(37300);var n,r;!function(e){e[e.Person=0]="Person",e[e.NonPerson=1]="NonPerson",e[e.File=2]="File",e[e.WordDocument=3]="WordDocument",e[e.Powerpoint=4]="Powerpoint",e[e.PDF=5]="PDF",e[e.Excel=6]="Excel",e[e.Meeting=7]="Meeting",e[e.Chat=8]="Chat",e[e.Email=9]="Email",e[e.Unknown=10]="Unknown"}(n||(n={})),function(e){e[e.PastMeeting=0]="PastMeeting",e[e.FutureMeeting=1]="FutureMeeting",e[e.Unknown=2]="Unknown"}(r||(r={}));t._C={"whats the latest from":n.Person,"when is my next meeting with":n.Person,"what s the latest from":n.Person,"when s my next meeting with":n.Person,"what did":n.Person,recap:n.Meeting,"draft an email with action items from":n.Meeting,"what are the unresolved issues from":n.Meeting,"help me prepare for my next meeting":n.Meeting,"what were the key takeaways from":n.Meeting,"what are the key takeaways from":n.Meeting,"list key points from":n.File,"create a faq based on":n.File,"propose a new introduction to":n.File,"suggest edits make this more concise":n.File},t.wS={"¿cuáles fueron los problemas abiertos de":r.PastMeeting,"¿cuáles fueron los problemas abiertos de la":r.PastMeeting,"rédige un courriel contenant des notes et des éléments d’action de la":r.PastMeeting,"rédige un e-mail contenant des notes et des éléments d’action de la":r.PastMeeting,"crea una bozza di e-mail con le note e le attività definite durante la":r.PastMeeting,"entwirf eine e-mail mit notizen und aktionselementen aus":r.PastMeeting,"redacta un borrador de correo electrónico con notas y acciones de":r.PastMeeting,使用来自:r.PastMeeting,"draft an email with notes and action items from":r.PastMeeting,"¿cuáles son los elementos de acción de":r.PastMeeting,"elabore um email com anotações e itens de ação":r.PastMeeting,"was waren die offenen fragen in":r.PastMeeting,"what were the open issues from":r.PastMeeting,"quels étaient les problèmes en suspens par rapport à la":r.PastMeeting,"quali sono state le questioni discusse nella":r.PastMeeting,"quais foram os problemas em aberto da":r.PastMeeting,"what are the action items from":r.PastMeeting,"quali sono le attività da svolgere definite nella":r.PastMeeting,"was sind die aktionselemente aus":r.PastMeeting,"quels sont les points d'action issus de la":r.PastMeeting,"quais são os itens de ação da":r.PastMeeting,recap:r.PastMeeting,"resuma a":r.PastMeeting,"récap. la":r.PastMeeting,"resume las conclusiones y elementos de acción de la":r.PastMeeting,"crea un riepilogo della":r.PastMeeting,回顾:r.PastMeeting,récap:r.PastMeeting},t.Jq={"のオープンしている問題は何でしたか?":r.PastMeeting,"を要約し、主要な要点とアクション アイテムを別のセクションとしてまとめ、各責任者を含めます":r.PastMeeting,"中的未解决问题有哪些?":r.PastMeeting,"のアクション アイテムは何ですか?":r.PastMeeting,"中的拟办事项有哪些?":r.PastMeeting,"zusammen, mit ergebnissen/aktionselementen als abschnitten, mit zuständigen.":r.PastMeeting,"のメモとアクション アイテムを含むメールの下書きを作成します":r.PastMeeting},t.i6={"latest from":n.Person,"manager of":n.Person,who:n.Person,"who is":n.Person,message:n.NonPerson,messages:n.NonPerson,summarize:n.NonPerson,concise:n.NonPerson,elaborate:n.NonPerson,"introduction to":n.NonPerson,"points from":n.NonPerson,"items from":n.NonPerson,"issues from":n.NonPerson,"based on":n.NonPerson,in:n.NonPerson,meeting:n.Meeting,event:n.Meeting,meet:n.Meeting,sync:n.Meeting,"sync up":n.Meeting,call:n.Meeting,huddle:n.Meeting,scrum:n.Meeting,conference:n.Meeting,conf:n.Meeting,review:n.Meeting,discussion:n.Meeting,brief:n.Meeting,briefing:n.Meeting,appointment:n.Meeting,recap:n.Meeting,"prepare for":n.Meeting,"prep for":n.Meeting,file:n.File,files:n.File,document:n.WordDocument,documents:n.WordDocument,doc:n.WordDocument,word:n.WordDocument,docx:n.WordDocument,excel:n.Excel,sheet:n.Excel,spreadsheet:n.Excel,"spread sheet":n.Excel,presentation:n.Powerpoint,deck:n.Powerpoint,powerpoint:n.Powerpoint,"power point":n.Powerpoint,ppt:n.Powerpoint,pptx:n.Powerpoint,pdf:n.PDF,email:n.Email,emails:n.Email,"e mail":n.Email,"e mails":n.Email,chat:n.Chat,chats:n.Chat,group:n.Chat,groups:n.Chat,conversation:n.Chat,conversations:n.Chat};const s=new Set(["with","by"]);function a(e,t,o){const n=function(e,t){let o;if(void 0!==e&&e!==r.Unknown)switch(e){case r.FutureMeeting:o={name:"#event#",scope:i.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?i.IntentConfidenceLevel.High:i.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"future"}],highConfidenceSign:!!t};break;case r.PastMeeting:o={name:"#event#",scope:i.IntentScope.FirstParty,score:t?1:.5,confidenceLevel:t?i.IntentConfidenceLevel.High:i.IntentConfidenceLevel.Medium,slots:[{slotName:"event_time",slotValue:"past"}],highConfidenceSign:!!t}}return o}(e,o);if(void 0===n)return;const s=t.find((e=>e.name===n.name));s?(s.score=Math.max(s.score,n.score),s.confidenceLevel=Math.max(s.confidenceLevel,n.confidenceLevel),s.highConfidenceSign=s.highConfidenceSign||n.highConfidenceSign,s.slots=function(e,t){if(t){if(e){const o=t.filter((t=>!e.some((e=>t.slotName===e.slotName))));return[...e,...o]}return t}return e}(s.slots,n.slots)):t.push(n)}function l(e){let t=e.toLowerCase().trim().replace(/[^\w\s]/g," ").trim().toLowerCase();return t=t.replace(/\s+/g," "),t}t.O7={"prepare for":r.FutureMeeting,"prep for":r.FutureMeeting,"prepare me for":r.FutureMeeting,"prep me for":r.FutureMeeting,"next meeting":r.FutureMeeting,"next event":r.FutureMeeting,"next sync":r.FutureMeeting,"next call":r.FutureMeeting,upcoming:r.FutureMeeting,"to be discussed":r.FutureMeeting,recap:r.PastMeeting,"last meeting":r.PastMeeting,"previous meeting":r.PastMeeting,summarize:r.PastMeeting,"summary of":r.PastMeeting,"points from":r.PastMeeting,"items from":r.PastMeeting,"takeaways from":r.PastMeeting,discussed:r.PastMeeting,"issues from":r.PastMeeting,"based on":r.PastMeeting},t.pR=function(e,o){var c,u;if((null!==(c=null==e?void 0:e.length)&&void 0!==c?c:0)<=0&&(null!==(u=null==o?void 0:o.length)&&void 0!==u?u:0)<=0)return;const d=function(e){const t=[];if(void 0!==e&&e!==n.Unknown)switch(e){case n.Person:t.push({name:"#people#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.NonPerson:t.push({name:"#people#",scope:i.IntentScope.FirstParty,score:0,confidenceLevel:i.IntentConfidenceLevel.Low,highConfidenceSign:!1});break;case n.File:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.WordDocument:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"doc"},{slotName:"file_type",slotValue:"docx"}],highConfidenceSign:!0});break;case n.Powerpoint:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"ppt"},{slotName:"file_type",slotValue:"pptx"}],highConfidenceSign:!0});break;case n.PDF:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"pdf"}],highConfidenceSign:!0});break;case n.Excel:t.push({name:"#file#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,slots:[{slotName:"file_type",slotValue:"xls"},{slotName:"file_type",slotValue:"xlsx"}],highConfidenceSign:!0});break;case n.Meeting:t.push({name:"#event#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Chat:t.push({name:"#chat#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0});break;case n.Email:t.push({name:"#email#",scope:i.IntentScope.FirstParty,score:1,confidenceLevel:i.IntentConfidenceLevel.High,highConfidenceSign:!0})}return t}(function(e){let o=n.Unknown;const i=l(e);if(t._C.hasOwnProperty(i))return t._C[i];const r=i.split(" "),a=r[r.length-1];if(t.i6.hasOwnProperty(a)&&(o=t.i6[a]),r.length>=2){const e=r.slice(Math.max(0,r.length-2)).join(" ");t.i6.hasOwnProperty(e)&&(o=t.i6[e]);const i=r[r.length-2];("from"===a&&t.i6.hasOwnProperty(i)||s.has(a))&&(o=n.Person)}return o}(e)),h=function(e,o){const i=e.trim().toLowerCase();if(t.wS.hasOwnProperty(i))return t.wS[i];if(o){const e=o.trim().toLowerCase();if(t.Jq.hasOwnProperty(e))return t.Jq[e]}return r.Unknown}(e,o);return h!==r.Unknown?a(h,d,!0):a(function(e){const o=l(e).split(" "),i=Math.min(o.length,5),n=o.slice(Math.max(0,o.length-i)).join(" ");for(const e in t.O7)if(n.includes(e))return t.O7[e];return r.Unknown}(e),d),d}},93333:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildEmscriptenCustomContextFromSite=t.buildEmscriptenCustomContext=void 0;const i=o(84402);function n(e,t){function o(e,t,o,i){const n=function(e,t,o){const i=new Headers,n=o.keys();for(let e=0;e<n.size();e++){const t=n.get(e);i.append(t,o.get(t))}const r={};return r.method=e,void 0!==t&&(r.body=t),n.size()>0&&(r.headers=i),n.delete(),r}(t,o,i);let r=0;return fetch(e,n).then((e=>{if(r=e.status,!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e.arrayBuffer()})).then((e=>({bufferArray:new Uint8Array(e),length:e.byteLength,isError:!1,statusCode:r}))).catch((e=>{const t=e;return t.isError=!0,t.statusCode=r,t}))}function n(e,t,o){if(e||t&&0!==t.length){if(e){const t=e;return t.isError=!0,t}return{token:t,ttl:o?o.timeToLiveSec:void 0}}return{name:"Missing Token",message:"Unable to fetch token",isError:!0}}function r(e){if(!e)return;const t=new Map,o=e.keys();for(let i=0;i<o.size();i++){const n=o.get(i);t.set(n,e.get(n))}return t}function s(e,t){return new Promise((async(o,i)=>{try{if(!e.run)throw new Error("WorkflowSite is unimplemented.");const i=await e.run(t);if(!i)throw new Error("Outputs returned as undefined.");o(i)}catch(e){const t=e;t.isError=!0,o(t)}}))}function a(e,t,o){if(!e||!e.run){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void o(e)}const i=o.clone();e.run(t).then((e=>{if(!e)throw new Error("Outputs returned as undefined.");i.opcall(e)})).catch((e=>{const t=e;t.isError=!0,i.opcall(t)})).finally((()=>{i.delete()}))}const l={createModel:function(t){return new Promise((async(o,i)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const i=await e.site.createModel(t);i.customRun=s.bind(null,i),i.customRunInCallback=a.bind(null,i),o(i)}catch(e){const t=e;t.isError=!0,o(t)}}))},createModelInCallback:function(t,o){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void o(e)}const i=o.clone();e.site.createModel(t).then((e=>{e.customRun=s.bind(null,e),e.customRunInCallback=a.bind(null,e),i.opcall(e)})).catch((e=>{const t=e;t.isError=!0,i.opcall(t)})).finally((()=>{i.delete()}))},createModelInputs:function(){return new Promise((async(t,o)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");t(await e.site.createModelInputs())}catch(e){const o=e;o.isError=!0,t(o)}}))},createModelInputsInCallback:function(t){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void t(e)}const o=t.clone();e.site.createModelInputs().then((e=>{o.opcall(e)})).catch((e=>{const t=e;t.isError=!0,o.opcall(t)})).finally((()=>{o.delete()}))}},c={};return c.docSessionId=e.clientMetadata.docSessionId,c.getToken=function(t){return new Promise(((o,i)=>{e.getToken(t,((e,t,i)=>{if(e||t&&0!==t.length)if(e){const t=e;t.isError=!0,o(t)}else o(t);else o({name:"Missing Token",message:"Unable to fetch token",isError:!0})}))}))},c.getTokenWithPropertiesAsync=function(t){return new Promise(((o,i)=>{e.getToken(t,((e,t,i)=>{const r=n(e,t,i);o(r)}))}))},c.getTokenWithPropertiesInCallback=function(t,o){const i=o.clone();e.getToken(t,((e,t,o)=>{const r=n(e,t,o);i.opcall(r),i.delete()}))},c.getResourceAsUrlInCallback=function(t,o,i,n){if(!e.site){const e=new Error("WorkflowSite is unimplemented.");return e.isError=!0,void n(e)}const s=n.clone();e.site.getResourceAsURL(t,o,r(i)).then((e=>{const t=Object.entries(e),o=new Map(t);s.opcall(o)})).catch((e=>{const t=e;t.isError=!0,s.opcall(t)})).finally((()=>{s.delete()}))},c.httpRequest=o,c.httpRequestInCallback=function(e,t,i,n,r){const s=r.clone();o(e,t,i,n).then((e=>{s.opcall(e)})).catch((e=>{})).finally((()=>{s.delete()}))},c.copyUint8ArrayToWasmMemory=function(e,o){t().HEAPU8.set(e,o)},c.copyUint16ArrayToWasmMemory=function(e,o){t().HEAPU16.set(e,o>>1)},c.copyUint32ArrayToWasmMemory=function(e,o){t().HEAPU32.set(e,o>>2)},c.copyInt8ArrayToWasmMemory=function(e,o){t().HEAP8.set(e,o)},c.copyInt16ArrayToWasmMemory=function(e,o){t().HEAP16.set(e,o>>1)},c.copyInt32ArrayToWasmMemory=function(e,o){t().HEAP32.set(e,o>>2)},c.copyFloat32ArrayToWasmMemory=function(e,o){t().HEAPF32.set(e,o>>2)},c.copyFloat64ArrayToWasmMemory=function(e,o){t().HEAPF64.set(e,o>>3)},c.getResourceAsUrl=function(t,o,i){return new Promise((async(n,s)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const s=await e.site.getResourceAsURL(t,o,r(i)),a=Object.entries(s);n(new Map(a))}catch(e){const t=e;t.isError=!0,n(t)}}))},c.getResourceAsByteArray=function(t,o,i){return new Promise((async(n,s)=>{try{if(!e.site)throw new Error("WorkflowSite is unimplemented.");const s=await e.site.getResourceAsArrayBuffer(t,o,r(i)),a=new Map;for(const[e,t]of Object.entries(s)){console.log(e,t);const o=new Uint8Array(t),i={};i.bufferArray=o,i.length=t.byteLength,a.set(e,i)}n(a)}catch(e){const t=e;t.isError=!0,n(t)}}))},c.site=l,c.context=e,c.logOperationClass=i.Operation,c.logInfoFunction=i.Log.info.bind(null,0,i.LogCategory.WorkflowDefault),c.dummyPromise=Promise.resolve("Success"),c.logDebugTrace=function(e,t){i.Log.debug(e,i.LogCategory.WorkflowDefault,t)},c.logInfoTrace=function(e,t){i.Log.info(e,i.LogCategory.WorkflowDefault,t)},c.logWarnTrace=function(e,t){i.Log.warn(e,i.LogCategory.WorkflowDefault,t)},c.logErrorTrace=function(e,t){i.Log.error(e,i.LogCategory.WorkflowDefault,t)},c.getUserContext=function(){if(!e.userContext)return;const t={UserContextObject:e.userContext};return JSON.stringify(t)},c}t.buildEmscriptenCustomContext=n,t.buildEmscriptenCustomContextFromSite=function(e,t){return n({clientMetadata:void 0,getToken:function(e,t){throw new Error("GetToken not available in init.")},getTokenAsync:async function(){throw new Error("GetTokenAsync not available in init.")},site:e},t)}},95667:function(e,t,o){"use strict";var i=this&&this.__createBinding||(Object.create?function(e,t,o,i){void 0===i&&(i=o);var n=Object.getOwnPropertyDescriptor(t,o);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,i,n)}:function(e,t,o,i){void 0===i&&(i=o),e[i]=t[o]}),n=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||i(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),n(o(3707),t),n(o(93333),t)},3707:(e,t,o)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadWasmWebFromModularizeFunction=void 0;const i=o(84402),n=new Set,r=new Map,s="function"==typeof globalThis.importScripts;function a(e,t){e.src=t}function l(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function c(e,t,o,n,r){if(!n)return!1;const s=r||l;return!!s()[e+"Module"]&&(t.resultDescription="Module Loaded From Cache",i.Log.info(538576341,i.LogCategory.WorkflowDefault,t.stop()),o(s()[e+"Module"]),!0)}t.loadWasmWebFromModularizeFunction=async function(e,t,o,u,d,h,g){const p=new i.Operation({operationName:"LoadWasmWebFromModularizeFunction",success:!0,resourceId:o,resultDescription:""}).start();return new Promise(((f,m)=>{if(c(t,p,f,u,h))return;if(u&&n.has(t)){if(c(t,p,f,u,h))return;let e=r.get(t);void 0===e&&(e=[],r.set(t,e)),e.push({onSuccess:e=>f(e),onError:e=>m(e)})}else!function(e,t,o,i){if(s)try{globalThis.importScripts(e),t()}catch(e){o(e)}else{const n=document.createElement("script");(i||a)(n,e),n.onload=function(){t(),n.remove()},n.onerror=function(e){o(e),n.remove()},document.body.appendChild(n)}}(e,(()=>{if(c(t,p,f,u,h))return;if(!self[t])return p.success=!1,p.resultDescription="ModularizeFunction Missing",i.Log.info(538576343,i.LogCategory.WorkflowDefault,p.stop()),void m(new Error("ModularizeFunction Missing"));const e={};void 0!==d&&(e.locateFile=d),e.onAbort=function(e){const t=new i.Operation({operationName:"WasmCrashHappenedOnAbortCalled",resourceId:o}).start();"string"==typeof e&&(t.resultDescription=e),i.Log.error(509154189,i.LogCategory.WorkflowDefault,t.stop())},self[t](e).then((e=>{!function(e,t,o,n,a,u){var d;if(c(e,t,o,n,u))return;s&&(globalThis.top=self);const h=u||l;n&&(h()[e+"Module"]=a,null===(d=r.get(e))||void 0===d||d.forEach((t=>{t.onSuccess(h()[e+"Module"])})),r.set(e,[])),t.dimension0=n.toString(),i.Log.info(512237901,i.LogCategory.WorkflowDefault,t.stop()),o(a)}(t,p,f,u,e,h)})).catch((e=>{var o,n;p.success=!1,p.resultDescription="ModularizeFunction Failed: "+(null!==(o=e.message)&&void 0!==o?o:"Unknown Error Message"),i.Log.info(512237900,i.LogCategory.WorkflowDefault,p.stop()),null===(n=r.get(t))||void 0===n||n.forEach((t=>{t.onError(e)})),r.set(t,[]),m(e)}))}),(e=>{var o;p.success=!1,p.resultDescription="ScriptLoad Failed: "+("string"==typeof e?e:"Unknown Error Message"),i.Log.info(538706265,i.LogCategory.WorkflowDefault,p.stop()),null===(o=r.get(t))||void 0===o||o.forEach((t=>{t.onError(e)})),r.set(t,[]),m(e)}),g);u&&n.add(t)}))}},38178:(e,t,o)=>{"use strict";function i(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}o.d(t,{v4:()=>i})},23442:(e,t,o)=>{"use strict";o.d(t,{JU:()=>s,Vh:()=>r});const i=";",n=":";function r(e){if(!e)return new a([],new Set,new Map,new Map);const t=e.split(i),o=new Set,r=new Map,s=new Map;for(const e of t){const t=e.trim();if(""===t)continue;o.add(a.normalizeName(t));const[i,...l]=t.split(n),c=l.join(n),u=a.normalizeName(i);if(u){r.set(u,c);const e=a.parseName(u);e&&e!==u&&s.set(e,u)}}return new a(t,o,r,s)}function s(e){if(!e)return"";const t=new Set,o=[];for(const r of e.split(i).reverse()){const e=r.split(n)[0],i=a.normalizeName(e);t.has(i)||(t.add(i),o.push(r))}return o.reverse().join(i)}class a{constructor(e,t,o,i){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=o,this.parsedFlightsMap=i}static normalizeName(e){return null==e?void 0:e.toLowerCase()}static parseName(e){const t=null==e?void 0:e.split(".");return t?t[t.length-1]:void 0}hasFlight(e){const t=a.normalizeName(e),o=this.normalizedFlights.has(t),i=this.keyValueFlightsMap.has(t),n=this.parsedFlightsMap.has(t);return o||i||n}getBooleanValue(e,t){var o,i;const n=null===(o=this.getStringValue(e))||void 0===o?void 0:o.toLowerCase(),r=null===(i=this.getStringValue(this.parsedFlightsMap.get(a.normalizeName(e))))||void 0===i?void 0:i.toLowerCase();return"true"===n||"true"===r||"false"!==n&&"false"!==r&&t}getIntValue(e,t){const o=this.getStringValue(e),i=Number.parseInt(o,10);return Number.isNaN(i)?t:i}getStringValue(e,t){var o;return null!==(o=this.keyValueFlightsMap.get(a.normalizeName(e)))&&void 0!==o?o:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,o)=>{const i=null==t?void 0:t.toLowerCase();switch(i){case"true":e.push({name:o,value:!0});break;case"false":e.push({name:o,value:!1});break;default:{const n=Number.parseInt(i,10);Number.isNaN(n)?e.push({name:o,value:t}):e.push({name:o,value:n})}}})),e}}},79938:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=(e,t)=>{const o=[];for(const i of null!=e?e:[])if(void 0===t||t===i.cardinality)for(const e of i.contextTypes)o.push([e,i.cardinality,i.producerWaitPolicy]);return o}},68429:(e,t,o)=>{"use strict";o.d(t,{L:()=>i});class i{constructor(e){this.outlookDataHandle=e}getLocalPeopleData(){const e=this.outlookDataHandle.getAllRecipients(),t=[];for(const o of e)t.push({DisplayName:o.displayName,EmailAddresses:[o.emailAddress],Id:o.id,confidence:0,entityType:"",providerName:"",text:""});return t}}},43596:(e,t,o)=>{"use strict";o.d(t,{L4:()=>b});var i=o(88236),n=o(36943),r=o(62788),s=o(7464),a=o(41567),l=o(48574),c=o(84382),u=o(70394),d=o(78351),h=o(2387),g=o(45455);const p=e=>"GraphSearchClient"===e.ownerId,f=new Map([["AugLoop_GraphSearch_SearchSuggestionsAnnotationHybrid",0],["AugLoop_ObservationalAssistance_EccAnnotationClient",1],["AugLoop_GraphSearch_EccAnnotationHybrid",1],["AugLoop_GraphSearch_PredictionAnnotationHybrid",2],["AugLoop_GraphSearch_NudgeAnnotationHybrid",3]]);class m extends h.c{constructor(e,t){super("GraphSearchJoinWorkflowInstance",e,t)}async execute(e,t,o,n){let s=!1,c=!1;const u=new Date,d=this.startLogOperation("GraphSearchJoinWorkflowExecute",u,t);this.logWasmStats(d);const h=f.get(a.h.getTypeNameFor(t[0]));if(void 0!==h&&d.setDataFields({scenario:h}),2===t.length){if(l.SM.typeGuard(t[0])||l.SM.typeGuard(t[1])){const e=t[p(t[0])?0:1];d.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:o.clientMetadata.sessionId})}if(i.nm.typeGuard(t[0])||i.nm.typeGuard(t[1])){const e=t[p(t[0])?0:1];d.setDataFields({logicalId:e.logicalId,sessionId:o.clientMetadata.sessionId}),"Ignore"===e.entityType&&(c=!0)}}d.setDataFields({dimension0:(new Date).getTime()-u.getTime()}),s=this.executeWorkflowLambda(d,e,o,n,t),c&&!s||r.tG.info(509638786,r.nh.WorkflowDefault,d.stop())}}const v=(e,t)=>new m(e,t),b=(e,t)=>s.a.create("GraphSearchJoinECC").setCollectionScopeType(u.VP.getTypeName()).setInputTypes([l.SM.getTypeName(),i.NG.getTypeName()]).setOutputTypes([c.os.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(v.bind(null,e,t));var y,w;y=g.aU,w=g.zb,s.a.create("GraphSearchJoinWorkflow").setCollectionScopeType(n.Z5.getTypeName()).setInputTypes([i.J_.getTypeName()]).setOutputTypes([i.VL.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(v.bind(null,y,w)),((e,t)=>{s.a.create("GraphSearchJoinPrediction").setCollectionScopeType(d.iU.getTypeName()).setInputTypes([i.nm.getTypeName(),i.t9.getTypeName()]).setOutputTypes([l.k2.getTypeName(),l.KL.getTypeName(),c.Vm.getTypeName()]).setMaxAnnotations(2).setMaxDelayTime(1500).setLambdaType(v.bind(null,e,t))})(g.aU,g.zb),b(g.aU,g.zb)},25451:(e,t,o)=>{"use strict";o.d(t,{X8:()=>v});var i=o(46402),n=o(62788),r=o(41567),s=o(36943),a=o(88236),l=o(78351),c=o(70394);if(3023==o.j)var u=o(48574);var d=o(2387),h=o(45455);if(3023==o.j)var g=o(68429);const p=new Map([["AugLoop_GraphSearch_SearchSuggestionsRequest",0],["AugLoop_ObservationalAssistance_UserInitiatedRequestClient",1],["AugLoop_GraphIntentDetection_SystemInitiatedWithIntentClient",2]]);class f extends d.c{constructor(e,t){super("GraphSearchWorkflowInstance",e,t)}async execute(e,t,o){var i;let s=!1,a=!1;const u=new Date,d=this.startLogOperation("GraphSearchWorkflowExecute",u);this.logWasmStats(d);const h=p.get(r.h.getTypeNameFor(e));void 0!==h&&d.setDataFields({scenario:h}),(c.VP.typeGuard(e)||l.iU.typeGuard(e))&&(d.setDataFields({conversationId:e.conversationId,logicalId:e.logicalId,sessionId:t.clientMetadata.sessionId}),l.iU.typeGuard(e)&&0===(null===(i=e.multiIntents)||void 0===i?void 0:i.length)&&(a=!0)),s=this.executeWorkflowLambda(d,e,t,o),a&&!s||n.tG.info(509638755,n.nh.WorkflowDefault,d.stop())}}const m=(e,t)=>new f(e,t),v=(e,t)=>{const o=t.localContext?new g.L(t.localContext):null;return i.z.create("GraphSearchLocalWorkflowOA").setStateful().setInputTypes([s.$9.getTypeName(),l.iU.getTypeName(),c.VP.getTypeName(),s.zV.getTypeName()]).setOutputTypes([a.nm.getTypeName(),a.t9.getTypeName(),u.SM.getTypeName(),a.NG.getTypeName(),s.tE.getTypeName(),a.rQ.getTypeName(),a.xz.getTypeName()]).setLambdaType(m.bind(null,{...e,localContext:o},t))};var b,y;b=h.aU,y=h.zb,i.z.create("GraphSearchLocalWorkflow").setStateful().setInputTypes([s.$9.getTypeName(),s.Z5.getTypeName(),s.zV.getTypeName()]).setOutputTypes([a.J_.getTypeName(),s.tE.getTypeName(),a.rQ.getTypeName(),a.xz.getTypeName()]).setLambdaType(m.bind(null,b,y))},2387:(e,t,o)=>{"use strict";o.d(t,{c:()=>m});var i=o(95667);if(3023==o.j)var n=o(45455);if(3023==o.j)var r=o(98414);if(3023==o.j)var s=o(62788);if(3023==o.j)var a=o(34574);if(3023==o.j)var l=o(56653);if(3023==o.j)var c=o(36943);if(3023==o.j)var u=o(88236);if(3023==o.j)var d=o(70394);if(3023==o.j)var h=o(48741);if(3023==o.j)var g=o(48574);if(3023==o.j)var p=o(84382);if(3023==o.j)var f=o(79646);class m{constructor(e,t,o){var i,s;this.ariaNamespace="GraphSearch",this.prodAriaToken="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",this.devAriaToken="30d62489eb65462bb3a5c93b0cad786b-0260e5be-afb3-4f7c-a14a-f0b25b00a080-7662",this.isDisposed=!1,this.wasmConfig=o,this.propertyName=e,this.ariaToken=void 0!==t.environment&&t.environment===r.O.dev?this.devAriaToken:this.prodAriaToken;const a=t.scenarios&&t.scenarios.includes(n.Nz.BIZ_CHAT)?(0,l.E)():void 0;this.config={...t,...void 0===t.scenarioLength?{scenarioLength:t.scenarios.length}:{},heuristicIntentsConfig:a};const c=null!==(i=null==o?void 0:o.jsAssetName)&&void 0!==i?i:"GraphSearchLocalWorkflow.js",u=`${o.wasmRoot}/${c}`;this.wasmConfig={...void 0===o?{}:o,wasmRoot:u},t.enableMemoryLeakDetection&&(this.memoryLeakDetector=new f.j(null!==(s=t.memoryLeakDetectorConfig)&&void 0!==s?s:{}))}async init(e,t){var o;const n=this.startLogOperation("GraphSearchWorkflowInstance"===this.propertyName?"GraphSearchWorkflowInit":"GraphSearchJoinWorkflowInit",new Date);n.setDataFields({isPrefetch:this.config.prefetchOnly});try{await this.initializeWasmModule(this.wasmConfig.wasmRoot,this.wasmConfig.locateFile,this.wasmConfig.cacheModule,this.wasmConfig.wasmModuleCache,this.wasmConfig.scriptSrcSetter),this.logWasmStats(n),this.workflowLambda=this.wasmModule[this.propertyName](this.config);const o=t?(0,i.buildEmscriptenCustomContext)(t,(()=>this.wasmModule)):(0,i.buildEmscriptenCustomContextFromSite)(e,(()=>this.wasmModule));this.workflowLambda.init(o)}catch(e){const t=null!==(o=null==e?void 0:e.stack)&&void 0!==o?o:"";n.resultDescription=e&&e.message?`${e.message} // ${t}`:"Unknown error.",n.success=!1}s.tG.info(507573794,s.nh.WorkflowDefault,n.stop())}executeWorkflowLambda(e,t,o,n,r){var a;let l=!1;if(!this.wasmModule||!this.workflowLambda)return e.resultDescription="null lambda",e.success=!1,s.tG.info(507564037,s.nh.WorkflowDefault,e.stop()),"GraphSearchWorkflowInstance"===this.propertyName?this.sendDummyAndTriggerServiceFallback(n,t):this.sendInputAnnotation(n,t,r),!1;try{const e=(0,i.buildEmscriptenCustomContext)(o,this.wasmModule);void 0===r?this.workflowLambda.execute(t,e,n):this.workflowLambda.execute(t,r,e,n)}catch(t){const o=null!==(a=null==t?void 0:t.stack)&&void 0!==a?a:"";e.resultDescription=t&&t.message?`${t.message} // ${o}`:"Unknown error.",e.success=!1,l=!0}return l}dispose(){this.isDisposed=!0,void 0!==this.workflowLambda&&this.workflowLambda.delete(),this.workflowLambda=void 0,this.wasmModule=void 0}async initializeWasmModule(e,t,o=!0,n,r){if(this.wasmModule=await(0,i.loadWasmWebFromModularizeFunction)(e,"createGSWLocalInstance","GraphSearchWorkflowWasm_Prefetch",o,t,n,r),this.isDisposed)throw new Error("Workflow was disposed while initializing WASM module")}startLogOperation(e,t,o){const i=new a.I({operationName:"GraphSearchWorkflowInstance"===this.propertyName?"graphsearchworkflow_ts":"graphsearchjoinworkflow_ts",success:!0,resultDescription:"",ariaTenant:this.ariaToken,ariaNamespace:this.ariaNamespace}).start();return i.setDataFields({msg:e,startTimestamp:t.toISOString(),inputCount:o?o.length:0}),i}logWasmStats(e){this.wasmModule&&e.setDataFields({version:this.wasmModule.version,sdkVersion:this.wasmModule.sdkVersion,wasmModuleHeapSize:this.wasmModule.HEAP8?this.wasmModule.HEAP8.buffer.byteLength:void 0}),this.config.enableMemoryLeakDetection&&this.wasmModule&&this.wasmModule.HEAP8&&this.memoryLeakDetector.recordMemoryUsage(this.wasmModule.HEAP8.buffer.byteLength)}sendDummyAndTriggerServiceFallback(e,t){if(d.VP.typeGuard(t)||c.Z5.typeGuard(t)){const o={ownerId:"GraphSearchClient",conversationId:t.conversationId,logicalId:t.logicalId,entityResults:[],status:h.i.Success},i=d.VP.typeGuard(t)?g.SM.getTypeName():u.J_.getTypeName();e.setAnnotations(t,i,[o],{immediate:!0}),e.submitSignals([new c.tE({cachedIntents:[],inputObject:t,entityTypesResolved:this.config.entityTypes})])}}sendInputAnnotation(e,t,o){void 0!==o&&o.length>0&&(g.SM.typeGuard(o[0])?this.sendEccInputAnnotation(e,t,o):u.J_.typeGuard(o[0])&&this.sendSearchSuggestionInputAnnotation(e,t,o))}sendEccInputAnnotation(e,t,o){if(void 0!==o&&o.length>0&&g.SM.typeGuard(o[0])){const i=new p.os({entityResults:o[0].entityResults,status:h.i.Success});e.setAnnotations(t,p.os.getTypeName(),[i],{immediate:!0})}}sendSearchSuggestionInputAnnotation(e,t,o){if(void 0!==o&&o.length>0&&u.J_.typeGuard(o[0])){const i=new u.VL({results:o[0].results,status:h.i.Success});e.setAnnotations(t,u.VL.getTypeName(),[i],{immediate:!0})}}}},56653:(e,t,o)=>{"use strict";o.d(t,{E:()=>r});var i=o(16408);function n(e,t,o){var n;if(!t||void 0===o)return[];const r=t.substring(0,o).trimEnd(),s=t.substring(o+(null!==(n=1+(null==e?void 0:e.length))&&void 0!==n?n:0)).trim();return(0,i.pR)(r,s)||[]}function r(){return{getHeuristicIntents:n}}},79646:(e,t,o)=>{"use strict";o.d(t,{j:()=>i});class i{constructor(e){var t,o,i,n;this.memoryPoints=new Set,this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now(),this.growthFrequencyThreshold=null!==(t=e.growthFrequencyThreshold)&&void 0!==t?t:5,this.shortTermWindow=null!==(o=e.shortTermWindow)&&void 0!==o?o:6e4,this.longTermGrowthThreshold=null!==(i=e.longTermGrowthThreshold)&&void 0!==i?i:.5,this.longTermWindow=null!==(n=e.longTermWindow)&&void 0!==n?n:288e5}recordMemoryUsage(e){const t=Date.now();0===this.memoryPoints.size&&(this.startMemorySize=e,this.startTimestamp=t),this.memoryPoints.add(e),this.memoryTimestamps.push(t),this.checkShortTermGrowths(t),this.checkLongTermGrowth(e,t)}checkShortTermGrowths(e){const t=e-this.shortTermWindow;for(;this.memoryTimestamps.length>0&&this.memoryTimestamps[0]<t;)this.memoryTimestamps.shift();const o=new Set(this.memoryTimestamps.map((t=>Array.from(this.memoryPoints).find((()=>-1!==this.memoryTimestamps.findIndex((o=>o>=t&&o<=e)))))).filter(Boolean));if(o.size>=this.growthFrequencyThreshold)throw new Error(`Potential memory leak detected: ${o.size} unique memory points in the last ${this.shortTermWindow/1e3} seconds.`)}checkLongTermGrowth(e,t){const o=t-this.startTimestamp;if(o>=this.longTermWindow){const i=(e-this.startMemorySize)/this.startMemorySize;if(i>this.longTermGrowthThreshold)throw new Error(`Potential memory leak detected: ${(100*i).toFixed(2)}% growth over ${(o/36e5).toFixed(2)} hours.`);this.startMemorySize=e,this.startTimestamp=t}}getUniqueMemoryPointCount(){return this.memoryPoints.size}getCurrentMemoryUsage(){return Array.from(this.memoryPoints).pop()}resetDetector(){this.memoryPoints.clear(),this.memoryTimestamps=[],this.startMemorySize=0,this.startTimestamp=Date.now()}}},45455:(e,t,o)=>{"use strict";o.d(t,{Nz:()=>i,Xe:()=>n,aU:()=>s,zb:()=>a});var i,n,r=o(93381);!function(e){e[e.OWA_REACT_COMPOSE=0]="OWA_REACT_COMPOSE",e[e.OUTLOOK_WEB_OA=1]="OUTLOOK_WEB_OA",e[e.OWA_PEOPLE_NAME_PRED=2]="OWA_PEOPLE_NAME_PRED",e[e.OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE=3]="OUTLOOKMOBILE_IOS_PEOPLE_COMPOSE",e[e.DYNAMIC_SEARCH_BOX=4]="DYNAMIC_SEARCH_BOX",e[e.WORKPLACE_SEARCH=5]="WORKPLACE_SEARCH",e[e.COPILOT=6]="COPILOT",e[e.COPILOT_POWERPOINT=7]="COPILOT_POWERPOINT",e[e.PEOPLE_FLYOUT=100]="PEOPLE_FLYOUT",e[e.BIZ_CHAT=1e4]="BIZ_CHAT"}(i||(i={})),function(e){e[e.SUBSTRATE_AAD=0]="SUBSTRATE_AAD",e[e.SUBSTRATE_MSA=1]="SUBSTRATE_MSA"}(n||(n={}));const s={emailId:"",puid:"",scenarios:[i.OWA_REACT_COMPOSE],market:"",tenantId:"",substrateAuthTokenType:n.SUBSTRATE_AAD,entityTypes:[r.ck.People,r.ck.File,r.ck.Scope],prefetchOnly:!1},a={wasmRoot:"graph-search-local"}},10193:(e,t,o)=>{"use strict";o.d(t,{A:()=>f});var i,n,r,s=o(84382),a=o(48741),l=o(70394),c=o(62788),u=o(46402),d=o(48943);!function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(i||(i={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(n||(n={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(r||(r={}));var h=o(4413),g=o(15293);class p{constructor(){this.seqCounter=0,this.lastInput="",this.lastConversationId="",this.lastLogicalId=""}async init(e){}initialize(e){var t,o;!0!==this.initialized&&(this.enableUserInitiatedRequests=null===(t=null==e?void 0:e.flights)||void 0===t?void 0:t.hasFlight("mc-editor-oa-client-ecc"),this.enableSystemInitiatedRequest=null===(o=null==e?void 0:e.flights)||void 0===o?void 0:o.hasFlight("mc-editor-oa-client-predictions"),this.initialized=!0)}async execute(e,t,o){this.executeInner(e,t,o),o.done()}executeInner(e,t,o){var i;if(c.tG.info(526713100,c.nh.WorkflowDefault,"Executing oa-client router workflow"),e&&e.content&&t&&o){if(this.initialize(t),d.Cg.typeGuard(e)||d.qf.typeGuard(e))if(null===(i=null==t?void 0:t.flights)||void 0===i?void 0:i.hasFlight("mc-editor-oa-client-router-refactor"))this.processTextTileInput(e.content,e,o,t);else{if(this.tryGenerateUserInitiatedRequest(e.content,e,o,t))return;this.tryGenerateSystemInitiatedRequest(e.content,e,o,t)}}else c.tG.warn(526713101,c.nh.WorkflowDefault,"unexpected inputs, ignoring request")}dispose(){this.seqCounter=0}processTextTileInput(e,t,o,i){var n,r,l,u,d,p,f;const m=(new Date).toISOString(),v=(0,g.K)("Router_UserInitiated",i).start(),b=i.delta,y=null!==(r=null===(n=null==b?void 0:b.additionalData)||void 0===n?void 0:n.conversationId)&&void 0!==r?r:"",w=null!==(u=null===(l=null==b?void 0:b.additionalData)||void 0===l?void 0:l.logicalId)&&void 0!==u?u:"",C=this.getValidUserInitQuery(t,i,v);if(C){const i=null!==(p=null===(d=null==b?void 0:b.additionalData)||void 0===d?void 0:d.scopeInfo)&&void 0!==p?p:void 0,n=void 0===i&&this.sameAsLastUserInitRequest(e,b),r=null!==(f=null==i?void 0:i.entityType)&&void 0!==f?f:"";return v.setDataFields({hasScope:void 0!==i,entityType:r,repeatedReuquest:n}),this.generateUserInitiatedRequest(e,t,o,C,w,y,i,v),void this.finalizeLogging(v,m,w,y)}if(this.enableUserInitiatedRequests){const e=new s.os({conversationId:null!=y?y:"",entityResults:[],logicalId:null!=w?w:"",status:a.i.EarlyExit});o.setAnnotations(t,s.os.getTypeName(),[e]),v.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"}),this.finalizeLogging(v,m,w,y)}else v.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),this.finalizeLogging(v,m,w,y);const S=(new Date).toISOString(),k=(0,g.K)("Router_SystemInitiated",i).start(),T=(0,h.A)();this.isValidSystemInitQuery(t,i,k)?this.generateSystemInitiatedRequest(e,t,o,T,k):this.enableSystemInitiatedRequest?k.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"}):k.setDataFields({statusDescription:"Request to send empty annotation skipped because required flight is missing"}),c.tG.info(508408097,c.nh.WorkflowDefault,`sending SystemInitiatedRequestClient (${this.seqCounter})`),this.finalizeLogging(k,S,T)}finalizeLogging(e,t,o,i){const n=(new Date).toISOString();i&&e.setDataFields({conversationId:i}),e.setDataFields({startTimeStamp:t,endTimeStamp:n,logicalId:o}),c.tG.info(508356445,c.nh.WorkflowDefault,e.stop())}generateUserInitiatedRequest(e,t,o,i,n,r,s,a){if(!this.enableUserInitiatedRequests)return void a.setDataFields({statusDescription:"Request skipped because required flight is missing"});const c=new l.VP({content:this.sanitizeText(e),logicalId:n,conversationId:r,seq:++this.seqCounter,scope:s,...i});o.setAnnotations(t,l.VP.getTypeName(),[c]),a.setDataFields({statusDescription:"User-Initiated request generated"})}generateSystemInitiatedRequest(e,t,o,i,n){if(!this.enableSystemInitiatedRequest)return void n.setDataFields({statusDescription:"Request skipped because required flight is missing"});const r=new l.JM({content:this.sanitizeText(e),logicalId:i,seq:++this.seqCounter});o.setAnnotations(t,l.JM.getTypeName(),[r]),n.setDataFields({statusDescription:"System-Initiated request generated"})}tryGenerateUserInitiatedRequest(e,t,o,i){var n,r,u,d,h,p,f,m;let v=!1;const b=(new Date).toISOString(),y=(0,g.K)("Router_UserInitiated",i).start(),w=i.delta,C=null!==(r=null===(n=null==w?void 0:w.additionalData)||void 0===n?void 0:n.conversationId)&&void 0!==r?r:"",S=null!==(d=null===(u=null==w?void 0:w.additionalData)||void 0===u?void 0:u.logicalId)&&void 0!==d?d:"";if(null===(h=null==i?void 0:i.flights)||void 0===h?void 0:h.hasFlight("mc-editor-oa-client-ecc")){const n=this.getValidUserInitQuery(t,i,y);if(n){const i=null!==(f=null===(p=null==w?void 0:w.additionalData)||void 0===p?void 0:p.scopeInfo)&&void 0!==f?f:void 0,r=void 0===i&&this.sameAsLastUserInitRequest(e,w),s=null!==(m=null==i?void 0:i.entityType)&&void 0!==m?m:"";y.setDataFields({hasScope:void 0!==i,entityType:s,repeatedReuquest:r});const a=new l.VP({content:this.sanitizeText(e),logicalId:S,conversationId:C,seq:++this.seqCounter,scope:i,...n});o.setAnnotations(t,l.VP.getTypeName(),[a]),y.setDataFields({statusDescription:"User-Initiated request generated"}),v=!0}else{const e=new s.os({conversationId:null!=C?C:"",entityResults:[],logicalId:null!=S?S:"",status:a.i.EarlyExit});o.setAnnotations(t,s.os.getTypeName(),[e]),y.setDataFields({resultDescription:"Invalid or undefined query info provided, setting client empty annotation"})}}else y.setDataFields({statusDescription:"Request skipped because required flight is missing"});const k=(new Date).toISOString();return y.setDataFields({startTimeStamp:b,endTimeStamp:k,conversationId:C,logicalId:S}),c.tG.info(508409808,c.nh.WorkflowDefault,y.stop()),v}tryGenerateSystemInitiatedRequest(e,t,o,i){var n;const r=(new Date).toISOString(),s=(0,g.K)("Router_SystemInitiated",i).start(),a=(0,h.A)();if(null===(n=null==i?void 0:i.flights)||void 0===n?void 0:n.hasFlight("mc-editor-oa-client-predictions")){if(this.isValidSystemInitQuery(t,i,s)){const i=new l.JM({content:this.sanitizeText(e),logicalId:a,seq:++this.seqCounter});o.setAnnotations(t,l.JM.getTypeName(),[i]),s.setDataFields({statusDescription:"System-Initiated request generated"})}else s.setDataFields({resultDescription:"Invalid query sent, skipped sending client empty annotation"});c.tG.info(508409807,c.nh.WorkflowDefault,`sending SystemInitiatedRequestClient(${this.seqCounter})`)}else s.setDataFields({statusDescription:"Request skipped because required flight is missing"});const u=(new Date).toISOString();s.setDataFields({startTimeStamp:r,endTimeStamp:u,logicalId:a}),c.tG.info(508409806,c.nh.WorkflowDefault,s.stop())}sanitizeText(e,t){if("number"!=typeof(null==e?void 0:e.length))return"";"\n"===e[e.length-1]&&(e=e.substring(0,e.length-1));const o=e.replace(/\s/g," ");return t?o.trim():o}sameAsLastUserInitRequest(e,t){var o,i,n,r;const s=null!==(i=null===(o=null==t?void 0:t.additionalData)||void 0===o?void 0:o.conversationId)&&void 0!==i?i:"",a=null!==(r=null===(n=null==t?void 0:t.additionalData)||void 0===n?void 0:n.logicalId)&&void 0!==r?r:"";let l=!1;return e===this.lastInput&&s===this.lastConversationId&&a===this.lastLogicalId&&(l=!0),this.lastInput=e,this.lastConversationId=s,this.lastLogicalId=a,l}getValidUserInitQuery(e,t,o){var i,r;if(!d.Cg.typeGuard(e))return void o.setDataFields({statusDescription:"Invalid input type"});const s=e;if((null===(i=t.delta)||void 0===i?void 0:i.unit)!==n.Chars&&this.sanitizeText(s.content,!0).length<1)return void o.setDataFields({statusDescription:"Ignore empty tile"});const a=t.delta;if(a&&(a.unit!==n.Sentence||a.queryRange&&a.content)){const t=e.content;let i;const n=a.queryRange;if(n){const{length:e,start:o}=n,s=null!==(r=n.prefix)&&void 0!==r?r:p.userInitiatedIntentChar;i={query:this.sanitizeText(t.substring(o+s.length,o+e)),queryChar:s,queryCharIndex:o}}else o.setDataFields({statusDescription:"Invalid or non-existent queryRange provided."});if(i){const e={start:i.queryCharIndex,end:i.queryCharIndex+i.query.length+1};return(a.position>=e.start||a.position+a.content.length>=e.start)&&a.position<=e.end?(o.setDataFields({seqCounter:this.seqCounter,querylength:n.length}),i):void o.setDataFields({statusDescription:"Delta outside of query bounds"})}o.setDataFields({statusDescription:"Invalid query to generate user init request."})}else o.setDataFields({statusDescription:"Delta is undefined. Cannot proceed with query detection logic."})}isValidSystemInitQuery(e,t,o){var i;if(!d.Cg.typeGuard(e))return o.setDataFields({statusDescription:"Invalid input type, ignore"}),!1;const r=e.content,s=this.sanitizeText(r,!0),a=t.delta;if(!a)return o.setDataFields({statusDescription:"Delta is undefined."}),!1;{if(a.unit===n.Sentence||a.unit===n.Paragraph)return!1;if(a.unit!==n.Chars&&s.length<1)return o.setDataFields({statusDescription:"Empty tile, ignore"}),!1;const e=r.endsWith("\n")?r.substring(0,r.length-1):r;if((null===(i=null==t?void 0:t.flights)||void 0===i?void 0:i.hasFlight("mc-editor-oa-client-router-refactor"))&&a.position>=e.length-1)return!0;if(a.position>=e.length-1&&p.triggerCharacters.has(s[s.length-1]))return o.setDataFields({statusDescription:"Router should not generate system initiated requests for ECC requests"}),!1}return!0}}p.userInitiatedIntentChar="@",p.triggerCharacters=new Set(["@","/"]);const f=u.z.create("oaClientRouter").setInputTypes([d.qf.getTypeName()]).setOutputTypes([s.os.getTypeName(),l.JM.getTypeName(),l.VP.getTypeName()]).setLambdaType((()=>new p))},45384:(e,t,o)=>{"use strict";o.d(t,{TE:()=>B});var i,n,r=o(26017),s=o(84382),a=o(48741),l=o(48943),c=o(7464),u=o(62788),d=o(15293),h=o(34574),g=o(26394),p=o.n(g);class f{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}!function(e){e.Add="Add",e.Remove="Remove",e.Set="Set",e.Delete="Delete"}(n||(n={}));class m{static applyECSPatchOperation(e,t){let o=!1;if("object"==typeof t||Array.isArray(t))switch(e.operation){case n.Add:case n.Remove:o=m.applyAddOrRemoveOperation(e.path,t,e.value,e.operation);break;case n.Set:o=m.applySetOperation(e.path,t,e.value);break;case n.Delete:o=m.applyDeleteOperation(e.path,t,e.value)}return o?u.tG.verbose(505956121,u.nh.CoreDefault,`PATCH operation succeeded for ${e.operation} on ${e.settingName} with path: ${e.path}.`):u.tG.error(505956122,u.nh.CoreDefault,`PATCH operation failed for ${e.operation} on ${e.settingName} with path: ${e.path}`),o}static applyAddOrRemoveOperation(e,t,o,i){let r=!1;try{let s=[];if("object"!=typeof t||Array.isArray(t)?Array.isArray(t)&&(s=t):s=e.reduce(((e,t)=>e&&e[t]),t),Array.isArray(s))if(i===n.Add)s.push(o),r=!0;else if(i===n.Remove){const e=s.indexOf(o);e>=0&&(s.splice(e,1),r=!0)}}catch(e){u.tG.info(505968832,u.nh.CoreDefault,`Exception thrown while applying operation type: ${i} for an array. Error: ${e}`),r=!1}return r}static applySetOperation(e,t,o){let i=!1;try{const n=e.slice(0,-1),r=e[e.length-1];let s={};"object"!=typeof t||Array.isArray(t)||(s=n.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof s||Array.isArray(s)||(s[r]=o,i=!0))}catch(e){u.tG.info(505968802,u.nh.CoreDefault,`Exception thrown while applying set operation. Error: ${e}`),i=!1}return i}static applyDeleteOperation(e,t,o){let i=!1;try{let n={};"object"!=typeof t||Array.isArray(t)||(n=e.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof n||Array.isArray(n)||"string"!=typeof o||n.hasOwnProperty(o)&&(delete n[o],i=!0))}catch(e){u.tG.info(505968801,u.nh.CoreDefault,`Exception thrown while applying delete operation. Error: ${e}`),i=!1}return i}}i=m,m.parseECSOperation=(e,t)=>{if(!t.hasOwnProperty("operationType")||!t.hasOwnProperty("path")||!t.hasOwnProperty("value"))throw new Error(`Invalid format for PATCH operation on setting: ${e}`);const o=t.operationType.toLowerCase(),n=i.convertToConfigPatchOperationType(o);return{settingName:e,path:t.path?t.path.split("."):[],operation:n,value:t.value}},m.convertToConfigPatchOperationType=e=>{switch(e){case"add":return n.Add;case"remove":return n.Remove;case"set":return n.Set;case"delete":return n.Delete;default:throw new Error(`Invalid operation type: ${e}`)}};var v=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};class b extends f{constructor(e){super(),this.name=e}static initEcsSettingsProvider(e){u.tG.info(505999498,u.nh.CoreDefault,"Initializing ECS settings provider."),b.ecsSettingsProvider=e}static enableEcsPatchConfig(e){b.ecsPatchConfigEnabled=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new b(e);const o=b.tryGetConfigProperty(b.currentConfig,e);o.success&&t.updateValue(o.value),this.allSettings.set(e,t)}return t}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new b(e)};const o=b.tryGetConfigPropertyByPattern(b.currentConfig,t.regex);t.setting.updateValue(o),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){b.currentConfig=e,u.tG.info(572837966,u.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),b.allSettings.forEach(((e,t)=>{const o=b.tryGetConfigProperty(b.currentConfig,t).value;e.updateValue(o)&&(u.tG.info(572837967,u.nh.CoreDefault,`Setting new value for ${t}: ${o instanceof Object?JSON.stringify(o):o}`),e.notifyListeners(o))})),b.allPatternSettings.forEach(((t,o)=>{const i=b.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(i)&&(u.tG.info(508432774,u.nh.CoreDefault,`Setting new value for pattern ${o}: ${JSON.stringify(i)}`),t.setting.notifyListeners(i))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:b.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const o=[];if(e){const i=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of i)o.push({name:t,value:b.selectApplicableValue(e[t])})}return o}static setGlobalFilter(e){b.globalFilter=e}static setLocalConfig(e){b.localConfig=e,u.tG.info(506053841,u.nh.CoreDefault,`Setting localConfig field in Setting class: ${JSON.stringify(b.localConfig)}`)}static clear(){b.currentConfig=void 0,b.localConfig=void 0,b.allSettings.clear(),b.allPatternSettings.clear(),b.ecsSettingsProvider=void 0}static selectApplicableValue(e){let t;if(e){const o=e.find((e=>!b.globalFilter||b.globalFilter(e)));o&&(t=o.value)}return t}getName(){return this.name}getValue(){if(function(){var e;return void 0!==globalThis.process&&"true"===(null===(e=globalThis.process.env)||void 0===e?void 0:e.VALIDATE_CORRECT_USAGE_OF_GET_VALUE)}()&&0===this.listeners.size){const e=new Error(`SettingInstance or ChangeGate is being used incorrectly. Make sure .getValue() or ChangeGate is called during runtime or there is a listener set up on the setting. For more info visit: ${b.troubleshootUrl}`);throw e.name="Incorrect usage of getValue()",e}return this.value}getValueAdvancedAsync(e){return v(this,void 0,void 0,(function*(){const t=new h.I({operationName:"ECSGetValueAsync"},{metricDuration:!0}).start();let o;try{const i=yield b.ecsSettingsProvider.getSettingValue(this.name,e);t.dimension0=i.userAuthenticated?"Authenticated":"Anonymous",t.success=!0;let n=i.value;return n||(n=b.tryGetConfigProperty(b.localConfig,this.name).value,n&&i.patchValue&&(n=b.applyPatchOperationOnSetting(this.name,n,i.patchValue))),o=`Setting value for ${this.name} is ${JSON.stringify(n)}.`,n}catch(e){t.success=!1;const i=b.tryGetConfigProperty(b.localConfig,this.name).value;return o=`Setting value for ${this.name} is ${JSON.stringify(i)}.`,i}finally{u.tG.info(506053839,u.nh.CoreDefault,t.stop()),u.tG.info(505821320,u.nh.CoreDefault,o)}}))}updateValue(e){return!p()(this.value,e)&&(u.tG.info(572837968,u.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}static applyPatchOperationsOnConfig(e){try{if(!b.ecsPatchConfigEnabled)return e;const t=this.tryGetConfigProperty(e,"patchOperations").value;if(!t||0===t.length)return e;const o=[];for(const[e,i]of Object.entries(t))try{o.push(m.parseECSOperation(e,i))}catch(t){u.tG.error(505734922,u.nh.CoreDefault,`Exception thrown while parsing ECS PATCH operation for setting: ${e}. Error: ${t}`);continue}const i=new Map;for(const t of o)if(null==e?void 0:e.hasOwnProperty(t.settingName)){const o=JSON.parse(JSON.stringify(e[t.settingName])),n=b.selectApplicableValue(o);m.applyECSPatchOperation(t,n)&&(i.set(t.settingName,n),e[t.settingName]=o)}return i.size>0&&u.tG.info(505788322,u.nh.CoreDefault,`Resulting settings after PATCHes were applied: ${JSON.stringify(Object.fromEntries(i))}`),e}catch(t){return u.tG.error(505788321,u.nh.CoreDefault,`Exception thrown while applying ECS PATCH operations. Error: ${t}`),e}}static applyPatchOperationOnSetting(e,t,o){try{if(!b.ecsPatchConfigEnabled)return t;const i=JSON.parse(JSON.stringify(t)),n=o,r=m.parseECSOperation(e,n);return m.applyECSPatchOperation(r,i),i}catch(e){return u.tG.error(505788323,u.nh.CoreDefault,`Exception thrown while applying ECS PATCH operation on setting. Error: ${e}`),t}}}b.allSettings=new Map,b.allPatternSettings=new Map,b.ecsPatchConfigEnabled=!1,b.troubleshootUrl="https://eng.ms/docs/experiences-devices/opg/office-ai/augloop-ai-platform/augmentation-loop/documentation/server-workflow-tutorials/settings/troubleshoot";const y=new class extends f{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=b.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!=this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}getValueAdvancedAsync(e){return v(this,void 0,void 0,(function*(){const t=yield this.setting.getValueAdvancedAsync(e);return void 0===t?this.defaultValue:t}))}}("disabledChangeGates",[]),w=(e,t,...o)=>{const i=-1===y.getValue().indexOf(e);return t?i?t(...o):void 0:i},C=new Map([[r.c.People,1300],[r.c.PeopleInGroup,1250],[r.c.File,1200],[r.c.Event,1100],[r.c.Message,1e3],[r.c.Chat,920],[r.c.Team,910],[r.c.Channel,900],[r.c.MessageExtensionApp,800],[r.c.External,700],[r.c.Topic,600],[r.c.Loop,500],[r.c.Address,400],[r.c.Scope,100],[r.c.App,90],[r.c.Prompt,85],[r.c.CopilotPlugin,80]]),S=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,k=e=>{const t=C.get(e);return void 0===t?(u.tG.error(509743565,u.nh.WorkflowDefault,`unsupported entity type:'${e}'`),1):t},T=(e,t)=>{const o=k(e.entityType),i=k(t.entityType);return o===i?(u.tG.warn(509743564,u.nh.WorkflowDefault,`unexpected priority:'${e.entityType}','${t.entityType}'`),e.entityType.localeCompare(t.entityType)):i-o},x=(e,t,o)=>{t||u.tG.warn(e,u.nh.WorkflowDefault,o)};class _{constructor(){this.seqCounter=0,this.seqCounter=0}async init(e){this.seqCounter=0}async execute(e,t,o,i){const n=(new Date).toISOString();u.tG.info(524066818,u.nh.WorkflowDefault,`Executing oa-client client-server ranker workflow. sequence number : ${this.seqCounter}`),this.seqCounter++;const r=(0,d.K)("Ranker_Ecc",o).start(),a=this.getRankedResults(t,r);a&&i.setAnnotations(e,s.c$.getTypeName(),[a]);const l=(new Date).toISOString();r.setDataFields({startTimeStamp:n,endTimeStamp:l}),u.tG.info(512500928,u.nh.WorkflowDefault,r.stop()),i.done()}dispose(){this.seqCounter=0}getRankedResults(e,t){var o,i,n,r,l,c,d,h,g,p,f,m;if(0===e.length||this.seqCounter<0)return t.success=!1,t.resultDescription="oa-client-server ecc result ranker lambda has no inputs",void u.tG.warn(524066819,u.nh.WorkflowDefault,t.resultDescription);if(e.length>2)return t.success=!1,t.resultDescription="Unexpected. Client-server ranker can never have more than 2 inputs",void u.tG.warn(523854672,u.nh.WorkflowDefault,t.resultDescription);const v=null!==(i=null===(o=e[0])||void 0===o?void 0:o.conversationId)&&void 0!==i?i:"",b=null!==(r=null===(n=e[0])||void 0===n?void 0:n.logicalId)&&void 0!==r?r:"";if(t.setDataFields({conversationId:v,logicalId:b}),0===(e=e.filter((e=>e.status!==a.i.EarlyExit))).length)return t.success=!0,t.resultDescription="oa-client-server ecc result ranker skipping execution due to receiving early-exit annotations only",void u.tG.warn(509112707,u.nh.WorkflowDefault,t.resultDescription);const y=e.length.toString(),C=e.map((e=>e.ownerId)).join(";");let k;if(t.setDataFields({providerCount:y,souces:C}),1===e.length&&e[0].entityResults)k=new s.c$({conversationId:v,entityResults:e[0].entityResults,logicalId:b,status:e[0].status,treatments:e[0].treatments});else{const t=new Map,o=e[0].entityResults.length>=e[1].entityResults.length?0:1,i=(o+1)%2,n=new Set,r=e[o];for(let o=0;o<r.entityResults.length;++o){const s=r.entityResults[o],a=s.entityType;n.add(a);const l=s.entities,c=e[i];let u=s.modelInfo,d=l,h=r.entityResults[o].intent;for(let e=0;e<c.entityResults.length;++e){const t=c.entityResults[e];if(a===t.entityType){const o=c.entityResults[e].intent;o&&(h=Math.max(null!=h?h:0,o)),d=this.getDeDupedEntityList(l,t.entities),u=this.getMergedModelInfo(s.modelInfo,t.modelInfo);break}}const g={entities:d,entityType:a,modelInfo:u,intent:h};t.set(a,g)}const y=e[i];for(let e=0;e<y.entityResults.length;++e){const o=y.entityResults[e],i=o.entityType;n.has(i)||t.set(i,o)}const C=Array.from(t.values()).sort(T),_=[];let I=[],E=!1;if(w("UseLocallyGeneratedBM")&&(null===(l=null==r?void 0:r.entityResults)||void 0===l?void 0:l.length)>0&&"GraphSearchClient"===(null==r?void 0:r.ownerId)&&(null===(d=null===(c=null==r?void 0:r.treatments)||void 0===c?void 0:c.bestMatchEntries)||void 0===d?void 0:d.length)>0)I=r.treatments.bestMatchEntries;else if(w("UseLocallyGeneratedBM")&&(null===(h=null==y?void 0:y.entityResults)||void 0===h?void 0:h.length)>0&&"GraphSearchClient"===(null==y?void 0:y.ownerId)&&(null===(p=null===(g=null==y?void 0:y.treatments)||void 0===g?void 0:g.bestMatchEntries)||void 0===p?void 0:p.length)>0)I=y.treatments.bestMatchEntries;else{const e=null===(f=null==r?void 0:r.treatments)||void 0===f?void 0:f.bestMatchEntries,t=null===(m=null==y?void 0:y.treatments)||void 0===m?void 0:m.bestMatchEntries;if(e)for(let t=0;t<e.length;t++)_.push(e[t]);if(t)for(let e=0;e<t.length;e++)_.push(t[e]);I=_.sort(((e,t)=>S(t.confidence)-S(e.confidence))).sort(T).slice(0,3),E=((e,t)=>{var o;const i=null===(o=t.find((e=>e.entities.length>0)))||void 0===o?void 0:o.entityType,n=i&&!e.some((e=>e.entityType!=i));return n&&u.tG.info(509662157,u.nh.WorkflowDefault,"Best Match results suppressed"),n})(I,C)}x(520135894,(null==r?void 0:r.conversationId)===(null==y?void 0:y.conversationId),"Unexpected mismatch of conversation id in ranker"),x(520135893,(null==r?void 0:r.logicalId)===(null==y?void 0:y.logicalId),"Unexpected mismatch of logical id in ranker"),k=new s.c$({conversationId:null!=v?v:"",entityResults:C,logicalId:null!=b?b:"",status:0===C.length?a.i.NoResults:a.i.Success,treatments:new s.Fe({bestMatchEntries:E?[]:I})})}var _;return t.setDataFields({entityCount:(_=[k],_.reduce(((e,t)=>{var o;return e+((null===(o=t.entityResults)||void 0===o?void 0:o.reduce(((e,t)=>{var o;return e+((null===(o=t.entities)||void 0===o?void 0:o.length)||0)}),0))||0)}),0).toString())}),k}getDeDupedEntityList(e,t){const o=[],i=new Set;for(let t=0;t<e.length;++t){const n=e[t],r=n.text.toLocaleLowerCase();i.has(r)||(i.add(r),o.push(n))}for(let e=0;e<t.length;++e){const n=t[e];i.has(n.text.toLocaleLowerCase())||o.push(n)}return o}getMergedModelInfo(e,t){return{elapsedTime:Math.max(e.elapsedTime,t.elapsedTime),name:`${e.name}|${t.name}`,version:`${e.version}|${t.version}`}}}const I=()=>new _,E=(e,t)=>c.a.create("OaClientServerEccResultRanker").setCollectionScopeType(l.Cg.getTypeName()).setInputTypes(t).setOutputTypes([s.c$.getTypeName()]).setMaxAnnotations(e).setMaxDelayTime(3400).setLambdaType(I),B=(E(2,[s.J2.getTypeName(),s.os.getTypeName()]),E(2,[s.os.getTypeName()]))},15293:(e,t,o)=>{"use strict";if(o.d(t,{K:()=>n}),3023==o.j)var i=o(34574);const n=(e,t)=>{var o,n;const r=new i.I({operationName:e,success:!0,resultDescription:"",ariaTenant:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",ariaNamespace:"Oa_Client"});return r.setClientMetadata(null==t?void 0:t.clientMetadata),r.setUserContext(null==t?void 0:t.userContext),r.setDataFields({contextId:null===(n=null===(o=null==t?void 0:t.model)||void 0===o?void 0:o.scopeItem)||void 0===n?void 0:n.getContextId()}),r}},8996:(e,t,o)=>{"use strict";var i;o.d(t,{N:()=>i}),function(e){e[e.GENERIC=0]="GENERIC",e[e.OFFICE=1]="OFFICE",e[e.SVG=2]="SVG"}(i||(i={}))},19693:(e,t,o)=>{"use strict";o.d(t,{k:()=>i});const i=Object.assign({createSession:"createSession",alTelemetry:"alTelemetry",alSessionDisconnect:"alSessionDisconnect",alSessionReconnect:"alSessionReconnect",alSessionClosed:"alSessionClosed",alSessionConnect:"alSessionConnect",startCreateSession:"startCreateSession",finishCreateSession:"finishCreateSession",startSeedingSession:"startSeedingSession",finishSeedingSession:"finishSeedingSession",canReconnectSession:"canReconnectSession",authCallbackError:"authCallbackError",startCreateRuntime:"startCreateRuntime",finishCreateRuntime:"finishCreateRuntime",CritiqueCardShownViaKeyboardAction:"CritiqueCardShownViaKeyboardAction",CritiqueCardShownViaLeftClickAction:"CritiqueCardShownViaLeftClickAction",CritiqueCardShownViaRightClickAction:"CritiqueCardShownViaRightClickAction",CritiqueCardShownViaMiddleClickAction:"CritiqueCardShownViaMiddleClickAction",CritiqueCardShownViaBrowserBackButtonAction:"CritiqueCardShownViaBrowserBackButtonAction",CritiqueCardShownViaBrowserForwardButtonAction:"CritiqueCardShownViaBrowserForwardButtonAction",LeftClickOnSquiggle:"LeftClickOnSquiggle",RightClickOnSquiggle:"RightClickOnSquiggle",ContextMenuKeyUpEventOnSquiggle:"ContextMenuKeyUpEventOnSquiggle",InvalidLocales:"InvalidLocales",Unknown:"Unknown"},{EngagementCritiqueOffered:"EngagementCritiqueOffered",EngagementCritiqueCardOpened:"EngagementCritiqueCardOpened",EngagementCritiqueAccepted:"EngagementCritiqueAccepted",EngagementCritiqueIgnore:"EngagementCritiqueIgnore",EngagementCritiqueIgnoreAll:"EngagementCritiqueIgnoreAll",EngagementCritiqueAddToDictionary:"EngagementCritiqueAddToDictionary",EngagementCritiqueClickNoAction:"EngagementCritiqueClickNoAction",EngagementCritiqueDoNotCheckThisIssue:"EngagementCritiqueDoNotCheckThisIssue"})},18582:(e,t,o)=>{"use strict";o.d(t,{z:()=>i});const i=(0,o(63837).f)("IEditorSettingsState")},731:(e,t,o)=>{"use strict";function i(e,t){if(!function(e){if(0===e.trim().length)return!1;try{return new URL(e),!0}catch(e){return!1}}(e))return e;const o=new URL(e),i=t.trim();return o.pathname.endsWith("/")?o.pathname+=i:o.pathname=`${o.pathname}/${i}`,o.toString()}o.d(t,{W:()=>i})},71621:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>n}),3023==o.j)var i=o(731);function n(e,t=""){const o=null===t?e:(0,i.W)(e,t);window.open(o,"_blank","noopener,noreferrer")}},33244:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>a}),3023==o.j)var i=o(83240);if(3023==o.j)var n=o(64052);if(3023==o.j)var r=o(97428);if(3023==o.j)var s=o(44680);class a{constructor(){this.imports=[]}get uniqueId(){return(0,r.z)(507918409)}configureRootServices(e){e.bind(i.C).toDynamicValue((e=>{const t=e.get(s.n);return new n.t(t.defaultLocale)}))}}},86461:(e,t,o)=>{"use strict";o.d(t,{t:()=>r});var i=o(30206),n=o(48828);let r=class{setOnFeedbackIconClicked(e){this._onFeedbackIconClicked=e}feedbackIconClicked(e,t){this._onFeedbackIconClicked&&this._onFeedbackIconClicked(e,t)}};r=(0,i.__decorate)([(0,n._)()],r)},27742:(e,t,o)=>{"use strict";if(o.d(t,{cl:()=>s,nv:()=>l}),3023==o.j)var i=o(70578);if(3023==o.j)var n=o(75943);if(3023==o.j)var r=o(8662);const s=(0,o(63837).f)("HostCallbacksTransformer");class a{constructor(e,t,o,i,n,r){this.hostCallbacksCustomizations=(e,t)=>e,this.hostSettings=e,this.descriptorManager=t,this.telemetrySink=o,this.logger=i,this.clientRuntime=n,this.aggregateLogger=r}withHostCallbacksCustomizations(e){return this.hostCallbacksCustomizations=t=>{let o=t;for(const t of e)o=t(o,this);return o},this}async build(e,t){try{const e=await this.createClientMetadata(),o=this.hostCallbacksCustomizations(this.createHostCallbacks(),this),i=this.createRuntimeOptions();return await this.runPreRuntimeInit(e,i),await this.initClientRuntime(e,o,i),{session:await this.createSession(t),runtime:this.clientRuntime}}catch(e){return this.logger.error(507392469,"Initializing augloop session runtime failed",e),{}}}logAnnotationResultOperation(e){var t;const o=n.h.getTypeNameFor(e);null===(t=this.aggregateLogger)||void 0===t||t.incrementEventCount(0,JSON.stringify({message:"Operation received",operationType:o,nItems:e.items.length}));for(const t of e.items)this.logAnnotationResultItem(o,t)}logAnnotationResultItem(e,t){var o;const i=t.body?n.h.getTypeNameFor(t.body):"unknown";null===(o=this.aggregateLogger)||void 0===o||o.incrementEventCount(0,JSON.stringify({message:"Annotation received",annotationType:i,operationType:e}))}async createClientMetadata(){var e,t,o,i,n,r;const s={appName:null!==(t=null===(e=this.hostSettings.hostMetadata)||void 0===e?void 0:e.appName)&&void 0!==t?t:"EditorBX",appPlatform:null!==(i=null===(o=this.hostSettings.hostMetadata)||void 0===o?void 0:o.appPlatform)&&void 0!==i?i:"Online",releaseAudienceGroup:null===(n=this.hostSettings.hostMetadata)||void 0===n?void 0:n.releaseAudienceGroup,uiLanguage:this.hostSettings.defaultLocale,sessionId:null===(r=this.hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId},a=(await this.descriptorManager.buildDescriptors()).find((e=>"FlightIds"===e.name));return a&&(s.flights=a.value),s}createHostCallbacks(){return{onAnnotationResult:e=>{this.logAnnotationResultOperation(e)},isFeatureEnabled:async(e,t)=>{var o;let i;return i=(null===(o=this.hostSettings.orchestratorSettings)||void 0===o?void 0:o.augLoopIsFeatureEnabledCallback)?await this.hostSettings.orchestratorSettings.augLoopIsFeatureEnabledCallback(e,t):"Production"===t,i},onResult:()=>{},executeLocalLambda:async()=>{},areLicenseFeaturesEnabled:async()=>Promise.resolve(!1),requestAuthToken:async e=>{var t;return(async e=>({Token:e?await e():void 0}))(null===(t=this.hostSettings.orchestratorSettings)||void 0===t?void 0:t.augLoopAuthTokenCallback)},sendTelemetryEvent:(0,r.U)(this.telemetrySink)}}createRuntimeOptions(){var e;return{telemetryAggregationIntervalSec:100,initSession:!1,batchOptions:(null===(e=this.hostSettings.orchestratorSettings)||void 0===e?void 0:e.enableBatching)?{maxInputSize:128e3,delayMs:50}:void 0}}async runPreRuntimeInit(e,t){var o;(null===(o=this.hostSettings.orchestratorSettings)||void 0===o?void 0:o.preRuntimeInit)&&await Promise.all(this.hostSettings.orchestratorSettings.preRuntimeInit.map((o=>o(e,t))))}async initClientRuntime(e,t,o){await this.clientRuntime.init(this.hostSettings.orchestratorSettings.augLoopEndpoint,e,t,o)}createSession(e){var t;const o=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:(new i.L).generate();return this.clientRuntime.createSession({docSessionId:o})}}const l=(e,t,o,i,n,r)=>new a(e,t,o,i,n,r)},87652:(e,t,o)=>{"use strict";if(o.d(t,{M:()=>p}),3023==o.j)var i=o(18054);if(3023==o.j)var n=o(97428);if(3023==o.j)var r=o(44680);if(3023==o.j)var s=o(16103);if(3023==o.j)var a=o(86278);if(3023==o.j)var l=o(13915);if(3023==o.j)var c=o(32927);if(3023==o.j)var u=o(85574);if(3023==o.j)var d=o(72459);if(3023==o.j)var h=o(27742);const g=(0,o(63837).f)("IClientRuntime");class p{constructor(){this.imports=[u.E]}get uniqueId(){return(0,n.z)(507918289)}configureRootServices(e){var t;const o=e.get(r.n);(null===(t=o.orchestratorSettings)||void 0===t?void 0:t.enableAugLoop)&&o.orchestratorSettings.augLoopEndpoint&&(e.bind(g).toDynamicValue((()=>(0,d.xB)())),e.bind(i.a).toDynamicValue((e=>(t,o)=>{const i=e.get(r.n),n=e.get(c.o),u=e.get(s.qy),d=e.get(a.g),p=e.getOptional(l.v),f=e.get(g),m=(0,h.nv)(i,n,u,d,f,p),v=e.getAll(h.cl);return m.withHostCallbacksCustomizations(v),m.build(t,o)})))}}},82285:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>c}),3023==o.j)var i=o(97428);if(3023==o.j)var n=o(44680);if(3023==o.j)var r=o(29714);if(3023==o.j)var s=o(46785);if(3023==o.j)var a=o(31928);if(3023==o.j)var l=o(30834);class c{constructor(){this.imports=[a.g]}get uniqueId(){return(0,i.z)(507918402)}configureRootServices(e){e.bind(s.R9).toDynamicValue((e=>{const t=e.get(n.n);return new s.R9({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(r.S).to(l.M)}}},8662:(e,t,o)=>{"use strict";o.d(t,{U:()=>r});const i="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",n=(e,t)=>{const o=[];for(const n of Object.keys(e)){if(void 0===e[n]||null===e[n])continue;const r={name:t?`${t}.${n}`:n,dataType:(i=e[n],"string"==typeof i?0:"boolean"==typeof i?1:"number"==typeof i?2:0),value:e[n],classification:4};o.push(r)}var i;return o};function r(e){return(t,o,r,s,a,l,c,u)=>{const d=t===i;let h,g=n(r);if(s){let e=n(a,s.split(".").slice(-1)[0]);d&&(e=[...e,...g],g=[]),h={name:s,dataFields:e}}const p={telemetryProperties:{ariaTenantToken:t,nexusTenantToken:-1},eventName:o,dataFields:g,eventFlags:{dataCategories:c,diagnosticLevel:u},eventContract:h};e.sendTelemetryEvent(p)}}},30834:(e,t,o)=>{"use strict";o.d(t,{M:()=>g});var i=o(30206),n=o(13494),r=o(36230),s=o(44680),a=o(86278),l=o(72971),c=o(46785),u=o(48828),d=o(90424),h=o(72783);let g=class{constructor(e,t,o,i,n,r){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=o,this._hostSettings=i,this._logger=n,this._sessionContextProvider=r}async initialize(){this._hostEmitter.on(n.pD.instrumentationRequestV1,(async e=>this.handleRequest(e)))}shutDown(){}async handleRequest(e){try{const t=await this._userInfoStrategy.executeAsync(!1);t&&(this._editorService.serverToServerId=JSON.stringify({puid:t.userId,identityProvider:t.identityProvider,tenantId:t.tenantId}));const o=await this._sessionContextProvider();return o.sessionId&&(this._editorService.xUserSessionId=o.sessionId),o.composeSessionId&&(this._editorService.xUserComposeSessionId=o.composeSessionId),function(e,t,o){if(e)for(const t of e)if("LicenseType"===t.name)return t.value;let i=h.G_.NoLicense;t?i=h.G_.Subscription:o&&(i=o),null==e||e.push({name:"LicenseType",value:i})}(e.message.descriptors,this._hostSettings.enhancedUpsellEnabled,null==t?void 0:t.licenseType),await this._editorService.instrumentation(e.message),!0}catch(e){this._logger.error(560219268,"Error in sending instrumentation request",e)}return!1}};g=(0,i.__decorate)([(0,u._)(),(0,i.__param)(0,(0,d.W)(r.e)),(0,i.__param)(1,(0,d.W)(n.M5)),(0,i.__param)(2,(0,d.W)(c.R9)),(0,i.__param)(3,(0,d.W)(s.n)),(0,i.__param)(4,(0,d.W)(a.g)),(0,i.__param)(5,(0,d.W)(l.a))],g)},15884:(e,t,o)=>{"use strict";o.d(t,{u:()=>c});var i=o(95734),n=o(37842),r=o(8676),s=o(54218),a=o(8903);const l=(0,n.F5)({stateStore:r.A.on(s.JY),featureFlagsReader:r.A.on(a.c)}),c=()=>{const{featureFlagsReader:e,stateStore:t}=(0,n.KN)(l),[o,r]=i.useState(void 0);return i.useEffect((()=>(t.subscribe("stateUpdated",r),()=>{t.unsubscribe("stateUpdated",r)})),[t]),o?i.createElement(u,{enableAriaStatusInNonRootIFrames:e.flags.enableAriaStatusInNonRootIFrames,politeUpdates:o.politeUpdates,assertiveUpdates:o.assertiveUpdates,status:o.status,statusSeverity:o.statusSeverity}):null},u=e=>{const{enableAriaStatusInNonRootIFrames:t,politeUpdates:o,assertiveUpdates:n,status:r,statusSeverity:s}=e,a={width:0,height:0,color:"transparent",background:"none",border:"none",outline:"none",overflow:"hidden",pointerEvents:"none"};return window.self===window.top||t?i.createElement(i.Fragment,null,r&&i.createElement("div",{role:"status","aria-live":s,"aria-label":r,style:a}),0!==n.length&&i.createElement("div",{role:"log","aria-live":"assertive",style:a},n),0!==o.length&&i.createElement("div",{role:"log","aria-live":"polite",style:a},o)):null}},88787:(e,t,o)=>{"use strict";o.d(t,{Jx:()=>i,XG:()=>d,mU:()=>u});var i,n=o(30206),r=o(38716),s=o(54218),a=o(63837),l=o(48828),c=o(90424);!function(e){e[e.KeepOriginal=0]="KeepOriginal",e[e.AutoCorrectAppearance=1]="AutoCorrectAppearance",e[e.AutoCorrectHover=2]="AutoCorrectHover",e[e.SingleIssueOnLine=3]="SingleIssueOnLine",e[e.IssuesOnLine=4]="IssuesOnLine"}(i||(i={}));const u=(0,a.f)("IAriaStatusUniqueProxy");let d=class{constructor(e,t){this.ariaStatusStateStore=e,this.localizer=t,this.existingCritiques=new Set,this.completeStatusMessage=(e,t)=>{const o=this.getMessageKey(t);if(!o)return e;let n=this.localizer.getMessage(o,e);return t===i.AutoCorrectHover&&(n=`${n} ${this.localizer.getMessage("ebx_autoCorrectedKeyboardAccess")}`),n},this.getMessageKey=e=>e===i.AutoCorrectAppearance||e===i.AutoCorrectHover?"ebx_autoCorrected":e===i.SingleIssueOnLine?"ebx_issuesOnLineSingular":e===i.IssuesOnLine?"ebx_issuesOnLinePlural":void 0}setStatus(e,t,o=!1,i,n){if(i&&o){if(this.existingCritiques.has(i))return;this.existingCritiques.add(i)}const r=void 0===n?e:this.completeStatusMessage(e,n);this.ariaStatusStateStore.setStatus(r,t,o)}addPreservedStatuses(e,t){const o=e.filter((e=>{const t=this.existingCritiques.has(e.id);return t||this.existingCritiques.add(e.id),!t})).map((e=>void 0===e.messageKind?e.text:this.completeStatusMessage(e.text,e.messageKind)));this.ariaStatusStateStore.addPreservedStatuses([o.join(". ")],t)}setLineNavStatus(e,t,o){e<1||this.setStatus(e.toLocaleString(),t,o,void 0,1===e?i.SingleIssueOnLine:i.IssuesOnLine)}};d=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,c.W)(s.JY)),(0,n.__param)(1,(0,c.W)(r.H))],d)},67971:(e,t,o)=>{"use strict";o.d(t,{v:()=>q});var i=o(37842),n=o(8676),r=o(36747),s=o(44680),a=o(74847),l=o(95734),c=o(17523),u=o(19720),d=o(46009),h=o(2766),g=o(81564),p=o(50007),f=o(71057),m=o(49433),v=o(10745),b=o(64287),y=o(30935),w=o(42174),C=o(45825),S=o(44071),k=o(96398);var T=o(81591);const x=e=>(e=>{const{appearance:t,arrowRef:o,contentRef:i,inline:n,mountNode:r,open:s,openOnContext:a,openOnHover:c,setOpen:u,size:d,toggleOpen:h,trapFocus:g,triggerRef:p,withArrow:f,inertTrapFocus:m}=e;return l.createElement(T.nt.Provider,{value:{appearance:t,arrowRef:o,contentRef:i,inline:n,mountNode:r,open:s,openOnContext:a,openOnHover:c,setOpen:u,toggleOpen:h,triggerRef:p,size:d,trapFocus:g,inertTrapFocus:m,withArrow:f}},e.popoverTrigger,e.open&&e.popoverSurface)})((e=>{const[t,o]=(0,m.N)(),i={size:"medium",contextTarget:t,setContextTarget:o,...e},n=l.Children.toArray(e.children);let r,s;2===n.length?(r=n[0],s=n[1]):1===n.length&&(s=n[0]);const[a,T]=function(e){const t=(0,u.D)(((t,o)=>{var i;return null===(i=e.onOpenChange)||void 0===i?void 0:i.call(e,t,o)})),[o,i]=(0,p.i)({state:e.open,defaultState:e.defaultOpen,initialState:!1});e.open=void 0!==o?o:e.open;const n=e.setContextTarget;return[o,l.useCallback(((e,o)=>{o&&"contextmenu"===e.type&&n(e),o||n(void 0),i(o),null==t||t(e,{open:o})}),[i,t,n])]}(i),[x,_]=(0,c.Z)(),I=(0,u.D)(((t,o)=>{var i;_(),t instanceof Event||!t.persist||t.persist(),"mouseleave"===t.type?x((()=>{T(t,o)}),null!==(i=e.mouseLeaveDelay)&&void 0!==i?i:500):T(t,o)})),E=l.useCallback((e=>{I(e,!a)}),[I,a]),B=function(e){const t={position:"above",align:"center",arrowPadding:2*k.v,target:e.openOnContext?e.contextTarget:void 0,...(0,v.P)(e.positioning)};t.coverTarget&&(e.withArrow=!1),e.withArrow&&(t.offset=(0,b.H)(t.offset,S.aT[e.size]));const{targetRef:o,containerRef:i,arrowRef:n}=(0,y.T)(t);return{triggerRef:o,contentRef:i,arrowRef:n}}(i),{targetDocument:A}=(0,f.Y)();var R;(0,d.W)({contains:h.s,element:A,callback:e=>I(e,!1),refs:[B.triggerRef,B.contentRef],disabled:!a,disabledFocusOnIframe:!(null===(R=e.closeOnIframeFocus)||void 0===R||R)});const M=i.openOnContext||i.closeOnScroll;(0,g.z)({contains:h.s,element:A,callback:e=>I(e,!1),refs:[B.triggerRef,B.contentRef],disabled:!a||!M});const{findFirstFocusable:D}=(0,w.r)(),P=(0,C.i)();var F,O;return l.useEffect((()=>{if(e.unstable_disableAutoFocus)return;const t=B.contentRef.current;if(a&&t){var o;const e=!isNaN(null!==(o=t.getAttribute("tabIndex"))&&void 0!==o?o:void 0),i=e?t:D(t);null==i||i.focus(),e&&P(t)}}),[D,P,a,B.contentRef,e.unstable_disableAutoFocus]),{...i,...B,inertTrapFocus:null!==(F=e.inertTrapFocus)&&void 0!==F?F:void 0!==e.legacyTrapFocus&&!e.legacyTrapFocus,popoverTrigger:r,popoverSurface:s,open:a,setOpen:I,toggleOpen:E,setContextTarget:o,contextTarget:t,inline:null!==(O=e.inline)&&void 0!==O&&O}})(e));x.displayName="Popover";var _=o(39366),I=o(35333),E=o(89693),B=o(64011),A=o(74074),R=o(64671),M=o(32471),D=o(19821);const P=l.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,T.pO)((e=>e.contentRef)),i=(0,T.pO)((e=>e.openOnHover)),n=(0,T.pO)((e=>e.setOpen)),r=(0,T.pO)((e=>e.mountNode)),s=(0,T.pO)((e=>e.arrowRef)),a=(0,T.pO)((e=>e.size)),l=(0,T.pO)((e=>e.withArrow)),c=(0,T.pO)((e=>e.appearance)),u=(0,T.pO)((e=>e.trapFocus)),d=(0,T.pO)((e=>e.inertTrapFocus)),h=(0,T.pO)((e=>e.inline)),{modalAttributes:g}=(0,B.y)({trapFocus:u,legacyTrapFocus:!d,alwaysFocusable:!u}),p={inline:h,appearance:c,withArrow:l,size:a,arrowRef:s,mountNode:r,components:{root:"div"},root:_.Gk((0,I.g)("div",{ref:(0,E.a)(t,o),role:u?"dialog":"group","aria-modal":!!u||void 0,...g,...e}),{elementType:"div"})},{onMouseEnter:f,onMouseLeave:m,onKeyDown:v}=p.root;return p.root.onMouseEnter=e=>{i&&n(e,!0),null==f||f(e)},p.root.onMouseLeave=e=>{i&&n(e,!1),null==m||m(e)},p.root.onKeyDown=e=>{var t;"Escape"===e.key&&(null===(t=o.current)||void 0===t?void 0:t.contains(e.target))&&(e.preventDefault(),n(e,!1)),null==v||v(e)},p})(e,t);return(0,S.Ls)(o),(0,D.$e)("usePopoverSurfaceStyles_unstable")(o),(e=>{(0,R.C)(e);const t=(0,A.FD)(e.root,{children:[e.withArrow&&(0,A.Y)("div",{ref:e.arrowRef,className:e.arrowClassName}),e.root.children]});return e.inline?t:(0,A.Y)(M.Z,{mountNode:e.mountNode,children:t})})(o)}));P.displayName="PopoverSurface";var F=o(20193),O=o(30862);const N=(0,i.F5)({languageScriptDirectionDetector:n.A.on(r.iw).optional(),hostSettings:n.A.on(s.n).optional(),targetWindow:n.A.on(a.sh).optional()}),q=l.forwardRef(((e,t)=>{var o,n,r,s;const{hostSettings:a,languageScriptDirectionDetector:c,targetWindow:u}=(0,i.SM)(N),d=l.useRef(null),h=(null===(o=e.popover)||void 0===o?void 0:o.positioning).target;return l.useImperativeHandle(t,(()=>({getElementRef:()=>d}))),l.useEffect((()=>{var t;return null===(t=null==a?void 0:a.onCalloutOpened)||void 0===t||t.call(a,null,h,void 0),e.moveFocusIntoModalizer&&setTimeout((()=>{var e,t,o,i;const n=(0,O.OT)(null!==(e=null==u?void 0:u.deref())&&void 0!==e?e:window),r=d.current?null===(i=null===(o=null===(t=null==n?void 0:n.core)||void 0===t?void 0:t.storageEntry)||void 0===o?void 0:o.call(t,d.current))||void 0===i?void 0:i.tabster:void 0;n&&(null==r?void 0:r.modalizer)&&(0,O.Az)(n).setActive(r.modalizer)}),0),()=>{var e;null===(e=null==a?void 0:a.onCalloutClosed)||void 0===e||e.call(a,null,h,void 0)}}),[a,e.moveFocusIntoModalizer,h]),l.createElement(x,Object.assign({},e.popover),l.createElement(P,Object.assign({},e.surface,{ref:d,dir:null==c?void 0:c.dir(),role:null===(n=e.popover)||void 0===n?void 0:n.ariaRole,"aria-label":null===(r=e.popover)||void 0===r?void 0:r.ariaLabel,"aria-labelledby":null===(s=e.popover)||void 0===s?void 0:s.ariaLabelledBy}),void 0===c?e.children:l.createElement(F.K,{rtl:c.isRtl()},e.children)))}))},87276:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=(0,o(63837).f)("ICritiqueCalloutStateStoreBase")},75186:(e,t,o)=>{"use strict";o.d(t,{x:()=>i});const i=(0,o(63837).f)("IUndoCalloutStateStoreBase")},48338:(e,t,o)=>{"use strict";o.d(t,{D:()=>r,Y:()=>i});var i,n=o(63837);!function(e){e.critique="critique",e.inlineSuggestions="inlineSuggestions",e.languageAutoDetection="languageAutoDetection"}(i||(i={}));const r=(0,n.f)("IFooterFreStore")},57284:(e,t,o)=>{"use strict";if(o.d(t,{J:()=>r}),3023==o.j)var i=o(78448);const n=3023==o.j?'[\\.\\:\\;\\,\\s-_\\(\\)\\/\\"\\u2018\\u2019\\u201c\\u201d\\xab\\xbb\\!\\?\\#\\&\\+\\¤\\<\\>\\@\\+\\=\\xa1\\xbf\\xaa\\xba]':null;function r(e,t,o,n){if(t){const r=e.map((e=>(0,i.S)(e))),l=(0,i.S)(t);return 1===e.length&&""===e[0]?[]:function(e,t,o,i){let n;t=t.toUpperCase();const r={};for(const o of e){if(!o)continue;const e=i(o.toUpperCase());for(;n=e.exec(t);)a(o,n,r)}const s=function(e,t){const o=[];for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&o.push({offset:parseInt(i,10),word:e[i],propertyHit:t});return o.sort(((e,t)=>t.offset-e.offset))}(r,o);return s.length&&function(e,t){let o=e[e.length-1].offset+e[e.length-1].word.length;for(let i=e.length-2;i>=0;i--){const n=e[i].offset+e[i].word.length-1;e[i].offset<o?n>o?e[i].offset<o&&(e[i].word=t.substring(o,e[i].offset+e[i].word.length),e[i].offset=o):e.splice(i,1):o=n}}(s,t),s}(r,l,o,n||s)}return[]}function s(e){return new RegExp("(^|"+n+")"+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"ig")}function a(e,t,o){var i;const n=(null===(i=t[1])||void 0===i?void 0:i.length)?t.index+t[1].length:t.index;(!o[n]||o[n].length<e.length)&&(o[n]=e)}},78448:(e,t,o)=>{"use strict";function i(e){if(null===r&&function(){r={};for(const e in s)r[e]=new RegExp("["+s[e]+"]","g")}(),e&&!function(e){null===n&&function(){let e="[";for(const t in s)e+=s[t];e+="]",n=new RegExp(e)}();return!(null==n?void 0:n.test(e.toLowerCase()))}(e))for(const t in r)e=e.replace(r[t],t);return e}o.d(t,{S:()=>i});let n=null,r=null;const s={a:"AÀÁÂÃÄÅàáâãäåĀāĂăĄąǍǎǞǟǠǡǺǻȀȁȂȃȦȧᴀḀḁẠạẢảẤấẦầẨẩẪẫẬậẮắẰằẲẳẴẵẶặÅⒶⓐＡ",b:"BƀƁƂƃɃʙḂḃḄḅḆḇⒷⓑＢ",c:"CÇçĆćĈĉĊċČčƇƈᴄḈḉⒸⓒＣ",d:"DÐðĎďĐđƉƊƋƌȡᴅḊḋḌḍḎḏḐḑḒḓⒹⓓＤ",e:"EÈÉÊËèéêëĒēĔĕĖėĘęĚěȄȅȆȇȨȩᴇḔḕḖḗḘḙḚḛḜḝẸẹẺẻẼẽẾếỀềỂểỄễỆệⒺⓔＥ",f:"FƑƒḞḟⒻⓕＦ",g:"GĜĝĞğĠġĢģƓǤǥǦǧǴǵɢḠḡⒼⓖＧ",h:"HĤĥĦħȞȟʜʰḢḣḤḥḨḩḪḫẖⒽⓗＨ",i:"IÌÍÎÏìíîïĨĩĪīĬĭĮįİıƗǏǐȈȉȊȋɪḬḭḮḯỈỉỊịⒾⓘＩ",j:"JĴĵǰʲᴊⒿⓙＪ",k:"KĶķƘƙǨǩᴋḰḱḲḳḴḵKⓀⓚＫ",l:"LĹĺĻļĽľŁłƚȴȽʟḶḷḸḹḺḻḼḽⓁⓛＬ",m:"MᴍḾḿṀṁṂṃⓂⓜＭ",n:"NÑñŃńŅņŇňƝƞǸǹȠȵɴṄṅṆṇṈṉṊṋⓃⓝＮ",o:"OÒÓÔÕÖØòóôõöøŌōŎŏŐőƟƠơǑǒǪǫǬǭǾǿȌȍȎȏȪȫȬȭȮȯȰȱᴏṌṍṎṏṐṑṒṓỌọỎỏỐốỒồỔổỖỗỘộỚớỜờỞởỠỡỢợⓄⓞＯ",p:"PƤƥᴘṔṕṖṗⓅⓟＰ",q:"QⓆⓠＱ",r:"RŔŕŖŗŘřȐȑȒȓʀʳṘṙṚṛṜṝṞṟⓇⓡＲ",s:"SŚśŜŝŞşŠšſȘșṠṡṢṣṤṥṦṧṨṩẛⓈⓢＳ",t:"TŢţŤťŦŧƫƬƭƮȚțᴛṪṫṬṭṮṯṰṱⓉⓣＴ",u:"UÙÚÛÜùúûüŨũŪūŬŭŮůŰűŲųƯưǓǔǕǖǗǘǙǚǛǜȔȕȖȗᴜṲṳṴṵṶṷṸṹṺṻỤụỦủỨứỪừỬửỮữỰựⓊⓤＵ",v:"VƲᴠṼṽṾṿⓋⓥＶ",w:"WŴŵʷᴡẀẁẂẃẆẇẈẉⓌⓦＷ",x:"XƳƴẊẋⓍⓧＸ",y:"YÝýÿŶŷŸƵƶȲȳʏʸẎẏỲỳỴỵỶỷỸỹⓎⓨＹ",z:"ZŹźŻżŽžȤȥᴢẐẑẒẓẔẕⓏⓩＺ",2:"²②",3:"³③",μ:"µΜ",1:"¹①",ae:"ÆæǢǣǼǽ",th:"Þþ",ss:"ßẞ",ŋ:"Ŋ",oe:"Œœ",ƅ:"Ƅ",ɔ:"Ɔᴐ",ǝ:"Ǝ",ə:"Ə",ɛ:"Ɛ",ɣ:"Ɣ",ɩ:"Ɩ",ɯ:"Ɯ",ƣ:"Ƣ",ʀ:"Ʀ",ƨ:"Ƨ",ʃ:"Ʃ",ʊ:"Ʊ",ʒ:"ƷǮǯᴣ",ƹ:"Ƹ",ƽ:"Ƽ",ƕ:"Ƕ",ƿ:"Ƿ",ȝ:"Ȝ",ȣ:"Ȣ",ⱥ:"Ⱥ",ȼ:"Ȼ",ⱦ:"Ⱦ",ʔ:"Ɂɂ",ʉ:"Ʉ",ʌ:"Ʌ",ɇ:"Ɇ",ɉ:"Ɉ",ɋ:"Ɋ",ɍ:"Ɍ",ɏ:"Ɏ",œ:"ɶ",ɠ:"ʛ",ɦ:"ʱ",ɹ:"ʴ",ɻ:"ʵ",ʁ:"ʶ",ͱ:"Ͱ",ͳ:"Ͳ",ͷ:"Ͷ",α:"ΆΑάἀἁἂἃἄἅἆἇἈἉἊἋἌἍἎἏὰάᾀᾁᾂᾃᾄᾅᾆᾇᾈᾉᾊᾋᾌᾍᾎᾏᾰᾱᾲᾳᾴᾶᾷᾸᾹᾺΆᾼ",ε:"ΈΕέϵἐἑἒἓἔἕἘἙἚἛἜἝὲέῈΈ",η:"ΉΗήἠἡἢἣἤἥἦἧἨἩἪἫἬἭἮἯὴήᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾞᾟῂῃῄῆῇῊΉῌ",ι:"ΊΙίἰἱἲἳἴἵἶἷἸἹἺἻἼἽἾἿὶίιῐῑῖῘῙῚΊ",ο:"ΌΟόὀὁὂὃὄὅὈὉὊὋὌὍὸόῸΌ",υ:"ΎΥύϒϓϔὐὑὒὓὔὕὖὗὙὛὝὟὺύῠῡῦῨῩῪΎ",ω:"ΏΩώὠὡὢὣὤὥὦὧὨὩὪὫὬὭὮὯὼώᾠᾡᾢᾣᾤᾥᾦᾧᾨᾩᾪᾫᾬᾭᾮᾯῲῳῴῶῷῺΏῼΩ",ϊ:"ΐΪῒΐῗ",β:"Βϐ",γ:"Γᴦ",δ:"Δ",ζ:"Ζ",θ:"Θϑϴ",κ:"Κϰ",λ:"Λᴧ",ν:"Ν",ξ:"Ξ",π:"Πϖᴨ",ρ:"ΡϱᴩῤῥῬ",σ:"ΣςϹ",τ:"Τ",φ:"Φϕ",χ:"Χ",ψ:"Ψᴪ",ϋ:"Ϋΰῢΰῧ",ϙ:"Ϙ",ϛ:"Ϛ",ϝ:"Ϝ",ϟ:"Ϟ",ϡ:"Ϡ",ϣ:"Ϣ",ϥ:"Ϥ",ϧ:"Ϧ",ϩ:"Ϩ",ϫ:"Ϫ",ϭ:"Ϭ",ϯ:"Ϯ",ς:"ϲ",ϸ:"Ϸ",ϻ:"Ϻ",е:"ЀЁЕѐёӖӗ",ђ:"Ђ",г:"ЃГѓ",є:"Є",ѕ:"Ѕ",і:"І",ї:"Ї",ј:"Ј",љ:"Љ",њ:"Њ",ћ:"Ћ",к:"ЌКќ",и:"ЍИЙйѝӢӣ",у:"ЎУўӮӯӲӳ",џ:"Џ",а:"АӐӑ",б:"Б",в:"В",д:"Д",ж:"ЖӁӂ",з:"З",л:"Лᴫ",м:"М",н:"Н",о:"О",п:"П",р:"Р",с:"С",т:"Т",ф:"Ф",х:"Х",ц:"Ц",ч:"Ч",ш:"Ш",щ:"Щ",ъ:"Ъ",ы:"Ы",ь:"Ь",э:"Э",ю:"Ю",я:"Я",ѡ:"Ѡ",ѣ:"Ѣ",ѥ:"Ѥ",ѧ:"Ѧ",ѩ:"Ѩ",ѫ:"Ѫ",ѭ:"Ѭ",ѯ:"Ѯ",ѱ:"Ѱ",ѳ:"Ѳ",ѵ:"ѴѶѷ",ѹ:"Ѹ",ѻ:"Ѻ",ѽ:"Ѽ",ѿ:"Ѿ",ҁ:"Ҁ",ҋ:"Ҋ",ҍ:"Ҍ",ҏ:"Ҏ",ґ:"Ґ",ғ:"Ғ",ҕ:"Ҕ",җ:"Җ",ҙ:"Ҙ",қ:"Қ",ҝ:"Ҝ",ҟ:"Ҟ",ҡ:"Ҡ",ң:"Ң",ҥ:"Ҥ",ҧ:"Ҧ",ҩ:"Ҩ",ҫ:"Ҫ",ҭ:"Ҭ",ү:"Ү",ұ:"Ұ",ҳ:"Ҳ",ҵ:"Ҵ",ҷ:"Ҷ",ҹ:"Ҹ",һ:"Һ",ҽ:"Ҽ",ҿ:"Ҿ",ӄ:"Ӄ",ӆ:"Ӆ",ӈ:"Ӈ",ӊ:"Ӊ",ӌ:"Ӌ",ӎ:"Ӎ",ӓ:"Ӓ",ӕ:"Ӕ",ә:"Ә",ӛ:"Ӛ",ӝ:"Ӝ",ӟ:"Ӟ",ӡ:"Ӡ",ӥ:"Ӥ",ӧ:"Ӧ",ө:"Ө",ӫ:"Ӫ",ӭ:"Ӭ",ӱ:"Ӱ",ӵ:"Ӵ",ӷ:"Ӷ",ӹ:"Ӹ",ӻ:"Ӻ",ӽ:"Ӽ",ӿ:"Ӿ",ԁ:"Ԁ",ԃ:"Ԃ",ԅ:"Ԅ",ԇ:"Ԇ",ԉ:"Ԉ",ԋ:"Ԋ",ԍ:"Ԍ",ԏ:"Ԏ",ԑ:"Ԑ",ԓ:"Ԓ",ԕ:"Ԕ",ԗ:"Ԗ",ԙ:"Ԙ",ԛ:"Ԛ",ԝ:"Ԝ",ԟ:"Ԟ",ԡ:"Ԡ",ԣ:"Ԣ",ԥ:"Ԥ",ԧ:"Ԧ",ա:"Ա",բ:"Բ",գ:"Գ",դ:"Դ",ե:"Ե",զ:"Զ",է:"Է",ը:"Ը",թ:"Թ",ժ:"Ժ",ի:"Ի",լ:"Լ",խ:"Խ",ծ:"Ծ",կ:"Կ",հ:"Հ",ձ:"Ձ",ղ:"Ղ",ճ:"Ճ",մ:"Մ",յ:"Յ",ն:"Ն",շ:"Շ",ո:"Ո",չ:"Չ",պ:"Պ",ջ:"Ջ",ռ:"Ռ",ս:"Ս",վ:"Վ",տ:"Տ",ր:"Ր",ց:"Ց",ւ:"Ւ",փ:"Փ",ք:"Ք",օ:"Օ",ֆ:"Ֆ",ا:"آأإ",و:"ؤ",ي:"ئى",ه:"ة",ە:"ۀ",ہ:"ۂ",ے:"ۓ",न:"ऩ",र:"ऱ",ळ:"ऴ",क:"क़",ख:"ख़",ग:"ग़",ज:"ज़",ड:"ड़",ढ:"ढ़",फ:"फ़",य:"य़",ড:"ড়",ঢ:"ঢ়",য:"য়",ਲ:"ਲ਼",ਸ:"ਸ਼",ਖ:"ਖ਼",ਗ:"ਗ਼",ਜ:"ਜ਼",ਫ:"ਫ਼",ଡ:"ଡ଼",ଢ:"ଢ଼",ஒ:"ஔ",ག:"གྷ",ཌ:"ཌྷ",ད:"དྷ",བ:"བྷ",ཛ:"ཛྷ",ཀ:"ཀྵ",ဥ:"ဦ",ⴀ:"Ⴀ",ⴁ:"Ⴁ",ⴂ:"Ⴂ",ⴃ:"Ⴃ",ⴄ:"Ⴄ",ⴅ:"Ⴅ",ⴆ:"Ⴆ",ⴇ:"Ⴇ",ⴈ:"Ⴈ",ⴉ:"Ⴉ",ⴊ:"Ⴊ",ⴋ:"Ⴋ",ⴌ:"Ⴌ",ⴍ:"Ⴍ",ⴎ:"Ⴎ",ⴏ:"Ⴏ",ⴐ:"Ⴐ",ⴑ:"Ⴑ",ⴒ:"Ⴒ",ⴓ:"Ⴓ",ⴔ:"Ⴔ",ⴕ:"Ⴕ",ⴖ:"Ⴖ",ⴗ:"Ⴗ",ⴘ:"Ⴘ",ⴙ:"Ⴙ",ⴚ:"Ⴚ",ⴛ:"Ⴛ",ⴜ:"Ⴜ",ⴝ:"Ⴝ",ⴞ:"Ⴞ",ⴟ:"Ⴟ",ⴠ:"Ⴠ",ⴡ:"Ⴡ",ⴢ:"Ⴢ",ⴣ:"Ⴣ",ⴤ:"Ⴤ",ⴥ:"Ⴥ",æ:"ᴁ",ð:"ᴆ",ł:"ᴌ",ḧ:"Ḧ",ẅ:"Ẅ",ẍ:"Ẍ",ỻ:"Ỻ",ỽ:"Ỽ",ỿ:"Ỿ",pts:"₧",tm:"™",ⅎ:"Ⅎ",4:"④",5:"⑤",6:"⑥",7:"⑦",8:"⑧",9:"⑨",10:"⑩",11:"⑪",12:"⑫",13:"⑬",14:"⑭",15:"⑮",16:"⑯",17:"⑰",18:"⑱",19:"⑲",20:"⑳",0:"⓪",ⰰ:"Ⰰ",ⰱ:"Ⰱ",ⰲ:"Ⰲ",ⰳ:"Ⰳ",ⰴ:"Ⰴ",ⰵ:"Ⰵ",ⰶ:"Ⰶ",ⰷ:"Ⰷ",ⰸ:"Ⰸ",ⰹ:"Ⰹ",ⰺ:"Ⰺ",ⰻ:"Ⰻ",ⰼ:"Ⰼ",ⰽ:"Ⰽ",ⰾ:"Ⰾ",ⰿ:"Ⰿ",ⱀ:"Ⱀ",ⱁ:"Ⱁ",ⱂ:"Ⱂ",ⱃ:"Ⱃ",ⱄ:"Ⱄ",ⱅ:"Ⱅ",ⱆ:"Ⱆ",ⱇ:"Ⱇ",ⱈ:"Ⱈ",ⱉ:"Ⱉ",ⱊ:"Ⱊ",ⱋ:"Ⱋ",ⱌ:"Ⱌ",ⱍ:"Ⱍ",ⱎ:"Ⱎ",ⱏ:"Ⱏ",ⱐ:"Ⱐ",ⱑ:"Ⱑ",ⱒ:"Ⱒ",ⱓ:"Ⱓ",ⱔ:"Ⱔ",ⱕ:"Ⱕ",ⱖ:"Ⱖ",ⱗ:"Ⱗ",ⱘ:"Ⱘ",ⱙ:"Ⱙ",ⱚ:"Ⱚ",ⱛ:"Ⱛ",ⱜ:"Ⱜ",ⱝ:"Ⱝ",ⱞ:"Ⱞ",ⱡ:"Ⱡ",ɫ:"Ɫ",ᵽ:"Ᵽ",ɽ:"Ɽ",ⱨ:"Ⱨ",ⱪ:"Ⱪ",ⱬ:"Ⱬ",ɑ:"Ɑ",ɱ:"Ɱ",ɐ:"Ɐ",ⱳ:"Ⱳ",ⱶ:"Ⱶ",ȿ:"Ȿ",ɀ:"Ɀ",ⲁ:"Ⲁ",ⲃ:"Ⲃ",ⲅ:"Ⲅ",ⲇ:"Ⲇ",ⲉ:"Ⲉ",ⲋ:"Ⲋ",ⲍ:"Ⲍ",ⲏ:"Ⲏ",ⲑ:"Ⲑ",ⲓ:"Ⲓ",ⲕ:"Ⲕ",ⲗ:"Ⲗ",ⲙ:"Ⲙ",ⲛ:"Ⲛ",ⲝ:"Ⲝ",ⲟ:"Ⲟ",ⲡ:"Ⲡ",ⲣ:"Ⲣ",ⲥ:"Ⲥ",ⲧ:"Ⲧ",ⲩ:"Ⲩ",ⲫ:"Ⲫ",ⲭ:"Ⲭ",ⲯ:"Ⲯ",ⲱ:"Ⲱ",ⲳ:"Ⲳ",ⲵ:"Ⲵ",ⲷ:"Ⲷ",ⲹ:"Ⲹ",ⲻ:"Ⲻ",ⲽ:"Ⲽ",ⲿ:"Ⲿ",ⳁ:"Ⳁ",ⳃ:"Ⳃ",ⳅ:"Ⳅ",ⳇ:"Ⳇ",ⳉ:"Ⳉ",ⳋ:"Ⳋ",ⳍ:"Ⳍ",ⳏ:"Ⳏ",ⳑ:"Ⳑ",ⳓ:"Ⳓ",ⳕ:"Ⳕ",ⳗ:"Ⳗ",ⳙ:"Ⳙ",ⳛ:"Ⳛ",ⳝ:"Ⳝ",ⳟ:"Ⳟ",ⳡ:"Ⳡ",ⳣ:"Ⳣ",ブ:"ヴ",21:"㉑",22:"㉒",23:"㉓",24:"㉔",25:"㉕",26:"㉖",27:"㉗",28:"㉘",29:"㉙",30:"㉚",31:"㉛",32:"㉜",33:"㉝",34:"㉞",35:"㉟",ㄱ:"㉠",ㄴ:"㉡",ㄷ:"㉢",ㄹ:"㉣",ㅁ:"㉤",ㅂ:"㉥",ㅅ:"㉦",ㅇ:"㉧",ㅈ:"㉨",ㅊ:"㉩",ㅋ:"㉪",ㅌ:"㉫",ㅍ:"㉬",ㅎ:"㉭",가:"㉮",나:"㉯",다:"㉰",라:"㉱",마:"㉲",바:"㉳",사:"㉴",아:"㉵",자:"㉶",차:"㉷",카:"㉸",타:"㉹",파:"㉺",하:"㉻",참고:"㉼",주의:"㉽",우:"㉾",一:"㊀",二:"㊁",三:"㊂",四:"㊃",五:"㊄",六:"㊅",七:"㊆",八:"㊇",九:"㊈",十:"㊉",月:"㊊",火:"㊋",水:"㊌",木:"㊍",金:"㊎",土:"㊏",日:"㊐",株:"㊑",有:"㊒",社:"㊓",名:"㊔",特:"㊕",財:"㊖",祝:"㊗",労:"㊘",秘:"㊙",男:"㊚",女:"㊛",適:"㊜",優:"㊝",印:"㊞",注:"㊟",項:"㊠",休:"㊡",写:"㊢",正:"㊣",上:"㊤",中:"㊥",下:"㊦",左:"㊧",右:"㊨",医:"㊩",宗:"㊪",学:"㊫",監:"㊬",企:"㊭",資:"㊮",協:"㊯",夜:"㊰",36:"㊱",37:"㊲",38:"㊳",39:"㊴",40:"㊵",41:"㊶",42:"㊷",43:"㊸",44:"㊹",45:"㊺",46:"㊻",47:"㊼",48:"㊽",49:"㊾",50:"㊿","1月":"㋀","2月":"㋁","3月":"㋂","4月":"㋃","5月":"㋄","6月":"㋅","7月":"㋆","8月":"㋇","9月":"㋈","10月":"㋉","11月":"㋊","12月":"㋋",hg:"㋌",erg:"㋍",ev:"㋎",ltd:"㋏",ア:"㋐",イ:"㋑",ウ:"㋒",エ:"㋓",オ:"㋔",カ:"㋕",キ:"㋖",ク:"㋗",ケ:"㋘",コ:"㋙",サ:"㋚",シ:"㋛",ス:"㋜",セ:"㋝",ソ:"㋞",タ:"㋟",チ:"㋠",ツ:"㋡",テ:"㋢",ト:"㋣",ナ:"㋤",ニ:"㋥",ヌ:"㋦",ネ:"㋧",ノ:"㋨",ハ:"㋩",ヒ:"㋪",フ:"㋫",ヘ:"㋬",ホ:"㋭",マ:"㋮",ミ:"㋯",ム:"㋰",メ:"㋱",モ:"㋲",ヤ:"㋳",ユ:"㋴",ヨ:"㋵",ラ:"㋶",リ:"㋷",ル:"㋸",レ:"㋹",ロ:"㋺",ワ:"㋻",ヰ:"㋼",ヱ:"㋽",ヲ:"㋾",アパート:"㌀",アルファ:"㌁",アンペア:"㌂",アール:"㌃",イニング:"㌄",インチ:"㌅",ウォン:"㌆",エスクード:"㌇",エーカー:"㌈",オンス:"㌉",オーム:"㌊",カイリ:"㌋",カラット:"㌌",カロリー:"㌍",ガロン:"㌎",ガンマ:"㌏",ギガ:"㌐",ギニー:"㌑",キュリー:"㌒",ギルダー:"㌓",キロ:"㌔",キログラム:"㌕",キロメートル:"㌖",キロワット:"㌗",グラム:"㌘",グラムトン:"㌙",クルゼイロ:"㌚",クローネ:"㌛",ケース:"㌜",コルナ:"㌝",コーポ:"㌞",サイクル:"㌟",サンチーム:"㌠",シリング:"㌡",センチ:"㌢",セント:"㌣",ダース:"㌤",デシ:"㌥",ドル:"㌦",トン:"㌧",ナノ:"㌨",ノット:"㌩",ハイツ:"㌪",パーセント:"㌫",パーツ:"㌬",バーレル:"㌭",ピアストル:"㌮",ピクル:"㌯",ピコ:"㌰",ビル:"㌱",ファラッド:"㌲",フィート:"㌳",ブッシェル:"㌴",フラン:"㌵",ヘクタール:"㌶",ペソ:"㌷",ペニヒ:"㌸",ヘルツ:"㌹",ペンス:"㌺",ページ:"㌻",ベータ:"㌼",ポイント:"㌽",ボルト:"㌾",ホン:"㌿",ポンド:"㍀",ホール:"㍁",ホーン:"㍂",マイクロ:"㍃",マイル:"㍄",マッハ:"㍅",マルク:"㍆",マンション:"㍇",ミクロン:"㍈",ミリ:"㍉",ミリバール:"㍊",メガ:"㍋",メガトン:"㍌",メートル:"㍍",ヤード:"㍎",ヤール:"㍏",ユアン:"㍐",リットル:"㍑",リラ:"㍒",ルピー:"㍓",ルーブル:"㍔",レム:"㍕",レントゲン:"㍖",ワット:"㍗","0点":"㍘","1点":"㍙","2点":"㍚","3点":"㍛","4点":"㍜","5点":"㍝","6点":"㍞","7点":"㍟","8点":"㍠","9点":"㍡","10点":"㍢","11点":"㍣","12点":"㍤","13点":"㍥","14点":"㍦","15点":"㍧","16点":"㍨","17点":"㍩","18点":"㍪","19点":"㍫","20点":"㍬","21点":"㍭","22点":"㍮","23点":"㍯","24点":"㍰",hpa:"㍱",da:"㍲",au:"㍳",bar:"㍴",ov:"㍵",pc:"㍶",dm:"㍷",dm2:"㍸",dm3:"㍹",iu:"㍺",平成:"㍻",昭和:"㍼",大正:"㍽",明治:"㍾",株式会社:"㍿",pa:"㎀㎩",na:"㎁",μa:"㎂",ma:"㎃",ka:"㎄",kb:"㎅",mb:"㎆㏔",gb:"㎇",cal:"㎈",kcal:"㎉",pf:"㎊",nf:"㎋",μf:"㎌",μg:"㎍",mg:"㎎",kg:"㎏",hz:"㎐",khz:"㎑",mhz:"㎒",ghz:"㎓",thz:"㎔",μℓ:"㎕",mℓ:"㎖",dℓ:"㎗",kℓ:"㎘",fm:"㎙",nm:"㎚",μm:"㎛",mm:"㎜",cm:"㎝",km:"㎞㏎",mm2:"㎟",cm2:"㎠",m2:"㎡",km2:"㎢",mm3:"㎣",cm3:"㎤",m3:"㎥",km3:"㎦",ms:"㎧㎳",ms2:"㎨",kpa:"㎪",mpa:"㎫",gpa:"㎬",rad:"㎭",rads:"㎮",rads2:"㎯",ps:"㎰",ns:"㎱",μs:"㎲",pv:"㎴",nv:"㎵",μv:"㎶",mv:"㎷㎹",kv:"㎸",pw:"㎺",nw:"㎻",μw:"㎼",mw:"㎽㎿",kw:"㎾",kω:"㏀",mω:"㏁",am:"㏂",bq:"㏃",cc:"㏄",cd:"㏅",ckg:"㏆",co:"㏇",db:"㏈",gy:"㏉",ha:"㏊",hp:"㏋",in:"㏌",kk:"㏍",kt:"㏏",lm:"㏐",ln:"㏑",log:"㏒",lx:"㏓",mil:"㏕",mol:"㏖",ph:"㏗",pm:"㏘",ppm:"㏙",pr:"㏚",sr:"㏛",sv:"㏜",wb:"㏝","1日":"㏠","2日":"㏡","3日":"㏢","4日":"㏣","5日":"㏤","6日":"㏥","7日":"㏦","8日":"㏧","9日":"㏨","10日":"㏩","11日":"㏪","12日":"㏫","13日":"㏬","14日":"㏭","15日":"㏮","16日":"㏯","17日":"㏰","18日":"㏱","19日":"㏲","20日":"㏳","21日":"㏴","22日":"㏵","23日":"㏶","24日":"㏷","25日":"㏸","26日":"㏹","27日":"㏺","28日":"㏻","29日":"㏼","30日":"㏽","31日":"㏾",ꙁ:"Ꙁ",ꙃ:"Ꙃ",ꙅ:"Ꙅ",ꙇ:"Ꙇ",ꙉ:"Ꙉ",ꙋ:"Ꙋ",ꙍ:"Ꙍ",ꙏ:"Ꙏ",ꙑ:"Ꙑ",ꙓ:"Ꙓ",ꙕ:"Ꙕ",ꙗ:"Ꙗ",ꙙ:"Ꙙ",ꙛ:"Ꙛ",ꙝ:"Ꙝ",ꙟ:"Ꙟ",ꙣ:"Ꙣ",ꙥ:"Ꙥ",ꙧ:"Ꙧ",ꙩ:"Ꙩ",ꙫ:"Ꙫ",ꙭ:"Ꙭ",ꚁ:"Ꚁ",ꚃ:"Ꚃ",ꚅ:"Ꚅ",ꚇ:"Ꚇ",ꚉ:"Ꚉ",ꚋ:"Ꚋ",ꚍ:"Ꚍ",ꚏ:"Ꚏ",ꚑ:"Ꚑ",ꚓ:"Ꚓ",ꚕ:"Ꚕ",ꚗ:"Ꚗ",ꜣ:"Ꜣ",ꜥ:"Ꜥ",ꜧ:"Ꜧ",ꜩ:"Ꜩ",ꜫ:"Ꜫ",ꜭ:"Ꜭ",ꜯ:"Ꜯ",ꜳ:"Ꜳ",ꜵ:"Ꜵ",ꜷ:"Ꜷ",ꜹ:"Ꜹ",ꜻ:"Ꜻ",ꜽ:"Ꜽ",ꜿ:"Ꜿ",ꝁ:"Ꝁ",ꝃ:"Ꝃ",ꝅ:"Ꝅ",ꝇ:"Ꝇ",ꝉ:"Ꝉ",ꝋ:"Ꝋ",ꝍ:"Ꝍ",ꝏ:"Ꝏ",ꝑ:"Ꝑ",ꝓ:"Ꝓ",ꝕ:"Ꝕ",ꝗ:"Ꝗ",ꝙ:"Ꝙ",ꝛ:"Ꝛ",ꝝ:"Ꝝ",ꝟ:"Ꝟ",ꝡ:"Ꝡ",ꝣ:"Ꝣ",ꝥ:"Ꝥ",ꝧ:"Ꝧ",ꝩ:"Ꝩ",ꝫ:"Ꝫ",ꝭ:"Ꝭ",ꝯ:"Ꝯ",ꝺ:"Ꝺ",ꝼ:"Ꝼ",ᵹ:"Ᵹ",ꝿ:"Ꝿ",ꞁ:"Ꞁ",ꞃ:"Ꞃ",ꞅ:"Ꞅ",ꞇ:"Ꞇ",ꞌ:"Ꞌ",ꞑ:"Ꞑ",ꞡ:"Ꞡ",ꞣ:"Ꞣ",ꞥ:"Ꞥ",ꞧ:"Ꞧ",ꞩ:"Ꞩ",י:"יִיּ",ײ:"ײַ",ש:"שׁשׂשּׁשּׂשּ",א:"אַאָאּ",ב:"בּבֿ",ג:"גּ",ד:"דּ",ה:"הּ",ו:"וּוֹ",ז:"זּ",ט:"טּ",ך:"ךּ",כ:"כּכֿ",ל:"לּ",מ:"מּ",נ:"נּ",ס:"סּ",ף:"ףּ",פ:"פּפֿ",צ:"צּ",ק:"קּ",ר:"רּ",ת:"תּ"}},4172:(e,t,o)=>{"use strict";o.r(t),o.d(t,{mockInlineSuggestions:()=>r});var i=o(26017),n=o(52484);const r=[{entities:[{entityType:i.c.People,Id:"0",text:"Annie Reid",EmailAddresses:["areid@microsoft.com"],confidence:0},{entityType:i.c.People,Id:"0",text:"Ed Taylor",EmailAddresses:["et@microsoft.com"],confidence:0},{entityType:i.c.People,Id:"0",text:"Clippy",EmailAddresses:["clippy@microsoft.com"],confidence:0}],entityType:i.c.People},{entities:[{entityType:i.c.File,Id:"0",FileSourceType:"Unknown",text:"Feature Spec",FileName:"Feature Spec",FileExtension:"Docx",FileSize:1e3,AccessUrl:"mockFile.gg/FeatureSpec",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:i.c.File,Id:"1",FileSourceType:"Unknown",text:"Planning Deck",FileName:"Planning Deck",FileExtension:"pptx",FileSize:1e3,AccessUrl:"mockFile.gg/PlanningDeck",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",isBestMatch:!0,confidence:0},{entityType:i.c.File,Id:"2",FileSourceType:"Unknown",text:"Crunched Numbers",FileName:"Crunched Numbers",FileExtension:"xls",FileSize:1e3,AccessUrl:"mockFile.gg/CrunchedNumbers",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:i.c.File,Id:"3",FileSourceType:"Unknown",text:"Some Contract with a very very long name",FileName:"Some Contract with a very very long name",FileExtension:"pdf",FileSize:1e3,AccessUrl:"mockFile.gg/contract",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:i.c.File,Id:"4",FileSourceType:"Unknown",text:"Even more files",FileName:"Even more files",FileExtension:"txt",FileSize:1e3,AccessUrl:"mockFile.gg/txt",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0}],entityType:i.c.File},{entities:[{ContentDomainName:"People",ScopeTitle:"Insert People",ScopeDescription:"Search people in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",entityType:i.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",text:"Insert People",scopeInfo:{entityType:"People",contentSource:""},confidence:0},{ContentDomainName:"Files",ScopeTitle:"Insert Files",ScopeDescription:"Search files in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",entityType:i.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",text:"Insert Files",scopeInfo:{entityType:"File",contentSource:""},confidence:0},{ItemId:"Ci7lEZX87y1MfPYPsAnbHw",Title:"FL Desktop 2.0",Url:"https://www.figma.com/file/Ci7lEZX87y1MfPYPsAnbHw",IconUrl:"https://figmaconnector.blob.core.windows.net/assets/icons/figma-logo.svg",ContentDomainId:"nonEssFigmaConnector",Authors:[],LastModifiedDateTimeUtc:"2022-04-26T03:57:42",CreatedTimeUtc:"2022-04-26T03:57:42",Text:"FL Desktop 2.0",PropertyHits:[],ReferenceId:"e60f6f30-9164-8d5e-7451-1da86e66df64.7000.22",entityType:i.c.External,Id:"Ci7lEZX87y1MfPYPsAnbHw",text:"FL Desktop 2.0",confidence:0}],entityType:i.c.Scope},{entities:[{entityType:i.c.Loop,Id:"0",text:"Action Items",icon:{iconName:"FFXCCompleted"},confidence:0},{entityType:i.c.Loop,Id:"0",text:"Bulleted List",icon:{iconName:"FFXCBulletedList"},confidence:0},{entityType:i.c.Loop,Id:"0",text:"Checklist",icon:{iconName:"FFXCChecklist"},confidence:0}],entityType:i.c.Loop},{entities:[{entityType:i.c.MessageExtensionApp,AppId:"ExcelOnline",DisplayName:"Excel",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.1",Id:"ExcelOnline",text:"Excel",confidence:0},{entityType:i.c.MessageExtensionApp,AppId:"f12466e6-a66c-495f-86f5-135938125391",DisplayName:"Azure DevOps (Internal)",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.2",Id:"f12466e6-a66c-495f-86f5-135938125391",text:"Azure DevOps (Internal)",confidence:0}],entityType:i.c.MessageExtensionApp},{entityType:i.c.Event,entities:[{entityType:i.c.Event,confidence:1,text:"Multiday meeting",EventId:{Id:"id1"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",HasRecording:!0,isBestMatch:!0},{entityType:i.c.Event,confidence:1,text:"Sameday meeting",EventId:{Id:"id2"},Start:"2023-05-12T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",isBestMatch:!0},{entityType:i.c.Event,confidence:1,text:"Multiday all day meeting",EventId:{Id:"id3"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",IsAllDay:!0}]},{entityType:i.c.Message,entities:[{entityType:i.c.Message,confidence:1,text:"Error while running Local IIS",Subject:"Error while running Local IIS",From:{EmailAddress:{Name:"John Doe"}},ItemId:{Id:"id1"}},{entityType:i.c.Message,confidence:1,text:"RE: Enable console logging question",Subject:"RE: Enable console logging question",From:{EmailAddress:{Name:"Jane Doe"}},ItemId:{Id:"id2"}}]},{entityType:i.c.Chat,entities:[{entityType:i.c.Chat,confidence:1,text:"Group Chat",Name:"Group Chat",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4,ChatMembers:[{Id:"1",ResultSource:n.F.Server,confidence:1,entityType:i.c.People,text:"John Doe"}]},{entityType:i.c.Chat,confidence:1,text:"Group Chat 2",Name:"Group Chat 2",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:5,ChatMembers:[{Id:"1",ResultSource:n.F.Server,confidence:1,entityType:i.c.People,text:"John Doe"},{Id:"2",ResultSource:n.F.Server,confidence:1,entityType:i.c.People,text:"Jane Doe"}]}]},{entityType:i.c.Channel,entities:[{entityType:i.c.Channel,confidence:1,text:"Developer Channel",Name:"Developer Channel",TeamName:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entityType:i.c.Team,entities:[{entityType:i.c.Team,confidence:1,text:"Editor-SDK",Name:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entities:[{entityType:i.c.App,id:"id",Title:"Sales meetings",text:"",subtitle:"Turned on last week",imageUrl:"https://vivasales.dynamics.com/outlookaddin/manifestimages/appLogoCopilotForSales_64px.png",confidence:0},{entityType:i.c.App,Title:"Bing",subtitle:"Available on Copilot",text:"Turned on last week",imageUrl:"https://content.powerapps.com/resource/powerbiwfe/images/PowerBI96x96.c2c49fdb8eb6008a98b3.png",confidence:0}],entityType:i.c.App}]},66886:(e,t,o)=>{"use strict";o.d(t,{j:()=>i});const i=(0,o(63837).f)("IMultilingualFreStore")},5901:(e,t,o)=>{"use strict";o.d(t,{QE:()=>C});var i=o(30206),n=o(95734),r=o(6011),s=o(37842),a=o(8676),l=o(74847);const c=(0,s.F5)({targetWindow:a.A.on(l.sh)}),u=e=>{const{targetWindow:t}=(0,s.KN)(c),{autoCorrectProps:o}=e,{critique:i,initializationProgress:a}=o,l=n.useRef(0),[u,d]=n.useState(1-a);return n.useEffect((()=>{const e=()=>{var e;0!==l.current&&(null===(e=t.deref())||void 0===e||e.clearInterval(l.current),l.current=0)},n=()=>{d((t=>t<.01?(e(),0):t-.02)),i.traceId&&o.setInitializationProgress(i.traceId,1-u)};return(()=>{if(u>0){e();const o=t.deref();o&&(l.current=o.setInterval(n,100))}})(),()=>{e()}}),[o,i.traceId,u,t]),n.createElement(r.u,Object.assign({},e,{squigglerId:o.id,squigglesProps:[o],opacity:u,isAutoCorrection:!0,ariaStatusUpdatesOnly:!1,anchorElement:e.anchorElement}))};var d=o(84166),h=o(30882),g=o(1557),p=o(15209),f=o(26607),m=o(51285),v=o(48828);const b=function(e){return t=>{var o,i;const{critique:r,data:s,element:a,squiggleKind:l,onCallOut:c,closeCallout:u,setInitializationProgress:h,showTooltip:p,closeTooltip:f,contextualCardTriggers:v}=t,{keyboard:b,mouse:y}=v,w=g.Bn.AutoCorrectSquiggle,C=t.squiggleRef||n.useRef(null),S=null!==(o=a.ownerDocument.defaultView)&&void 0!==o?o:window,k=n.useRef(0),[T,x]=n.useState(1-t.initializationProgress),_=n.useCallback((()=>t.isCaretOver||t.isMouseOver||t.isCalloutOpened),[t.isCaretOver,t.isMouseOver,t.isCalloutOpened]),I=n.useCallback((()=>_()||void 0!==T&&T>0?"ms-squiggle ms-squiggle-autocorrect-hl ":"ms-squiggle ms-squiggle-autocorrect"),[T,_]),[E,B]=n.useState(I());n.useEffect((()=>{B(I())}),[I]);const A=t.useSvgUnderline?g.fQ[w]:0,R=n.useCallback((e=>{var t;c(C.current,r,null!==(t=r.textInContext)&&void 0!==t?t:"","keyboard"===e,(()=>{}),a,l,(0,m.eO)(s),A)}),[r,s,a,A,c,l,C]),M=n.useCallback((()=>{0!==k.current&&(x(void 0),B(I()),S.clearInterval(k.current),k.current=0)}),[I,S]),D=n.useCallback((()=>u(r.traceId)),[u,r.traceId]);n.useEffect((()=>{y.includes(d.v.Hover)?t.isMouseOver?R("mouse"):t.isCalloutOpened||u(r.traceId):(t.isMouseOver||t.isCaretOver)&&(M(),x(void 0),B(I()))}),[y,t.isMouseOver,t.isCalloutOpened,R,u,r.traceId,M,I,t.isCaretOver]);const P=t.isCaretOver&&!t.isCalloutOpened;n.useEffect((()=>{P?p(l,C.current,r,"keyboard"):f(r.traceId)}),[f,r,p,l,C,P]);const F=n.useCallback((()=>{x((e=>{let t;return!e||e<.01?(t=void 0,M()):t=e-.02,r.traceId&&h(r.traceId,1-(null!=t?t:0)),t}))}),[M,r.traceId,h]);if(n.useEffect((()=>(M(),k.current=S.setInterval(F,100),()=>{M(),u(r.traceId),f(r.traceId)})),[]),null===(i=t.autoCorrectionBroker)||void 0===i?void 0:i.getAutoCorrectionIsBeingApplied(t.critique))return null;const O=!y.includes(d.v.Hover)&&y.includes(d.v.MainButtonPressed)?()=>R("mouse"):void 0,N=y.includes(d.v.SecondaryButtonPressed)?()=>R("mouse"):()=>{};return e(Object.assign(Object.assign({},t),{patternName:w,className:E,squiggleRef:C,opacity:T,openCalloutPredicate:e=>b.some((t=>t(e))),onClick:O,onNonLeftClick:D,onKeyboardEvent:()=>R("keyboard"),onEscapePress:()=>t.closeTooltip(t.critique.traceId),onRightClickEvent:N}))}},y=n.memo(b(h.m),f.I),w=n.memo(b(p.G),f.P);let C=class{constructor(e,t){this.hostSettings=e,this.autoCorrectionBroker=t}getSquiggles(e,t,o,i,s){const a=(0,r.g)(this.hostSettings,s);if(a)return n.createElement(n.Fragment,null,t.map(((e,t)=>n.createElement(u,{key:t.toString(),autoCorrectProps:e,theme:o,forcedHighContrast:i,hostSettings:this.hostSettings,anchorElement:s}))));{const l=a&&n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:o,forcedHighContrast:i,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!0,ariaStatusUpdatesOnly:!0,anchorElement:s});return n.createElement(n.Fragment,null,l,t.map(((e,t)=>n.createElement(y,Object.assign({key:t.toString()},e,{useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey,autoCorrectionBroker:this.autoCorrectionBroker})))))}}getFormInputSquiggle(e,t,o,i){return n.createElement(w,Object.assign({key:e},t,{initializationProgress:o,setInitializationProgress:i}))}};C=(0,i.__decorate)([(0,v._)()],C)},84166:(e,t,o)=>{"use strict";o.d(t,{c:()=>i,v:()=>n});const i={MainButtonPressed:0,AuxiliaryButtonPressed:1,SecondaryButtonPressed:2,FourthButton:3,FifthButton:4},n={MainButtonPressed:i.MainButtonPressed,SecondaryButtonPressed:i.SecondaryButtonPressed,Hover:100}},44573:(e,t,o)=>{"use strict";if(o.d(t,{KM:()=>c,Kc:()=>s,Nz:()=>a,OW:()=>d,S1:()=>l,tu:()=>u}),3023==o.j)var i=o(96120);var n=o(84166);if(3023==o.j)var r=o(19693);const s=n.v.MainButtonPressed,a=n.v.Hover,l=(n.v.SecondaryButtonPressed,e=>i.i()?!e.shiftKey&&e.ctrlKey&&e.altKey&&"ArrowDown"===e.key:!e.shiftKey&&!e.ctrlKey&&e.altKey&&"ArrowDown"===e.key),c=e=>!e.shiftKey&&e.ctrlKey&&e.altKey&&"ArrowDown"===e.key,u=e=>!e.shiftKey&&!e.altKey&&"Control"===e.key;function d(e){switch(e){case n.c.MainButtonPressed:return r.k.CritiqueCardShownViaLeftClickAction;case n.c.SecondaryButtonPressed:return r.k.CritiqueCardShownViaRightClickAction;case n.c.AuxiliaryButtonPressed:return r.k.CritiqueCardShownViaMiddleClickAction;case n.c.FourthButton:return r.k.CritiqueCardShownViaBrowserBackButtonAction;case n.c.FifthButton:return r.k.CritiqueCardShownViaBrowserForwardButtonAction;default:return r.k.Unknown}}},52894:(e,t,o)=>{"use strict";o.d(t,{FY:()=>S,hJ:()=>w});var i=o(30206),n=o(95734),r=o(6011),s=o(84166),a=o(20399),l=o(19693),c=o(10059),u=o(30882),d=o(87111),h=o(51285),g=o(1557),p=o(15209),f=o(26607),m=o(44573),v=o(48828);const b=function(e){return t=>{var o;const{critique:i,squiggleKind:r,closeCallout:u,showTooltip:d,closeTooltip:p,submitTelemetryEvent:f,contextualCardTriggers:v}=t,{keyboard:b,mouse:y}=v,w=null!==(o=t.squiggleRef)&&void 0!==o?o:n.useRef(null),C=(0,g.H7)(i,!!t.isAutoCorrectionEnabled,h.Ah.critique),S=n.useCallback((e=>{null==f||f({telemetryLog:{logType:"Event",eventName:e,level:a.q.Info,data:{critiquePriority:i.priority,critiqueTypeId:i.typeIdRaw,critiqueTraceId:i.traceId,critiqueSourceData:i.sourceData,squiggleKind:r}}})}),[i,r,f]),k=n.useCallback(((e,o=s.c.MainButtonPressed)=>{var n;const r=t.useSvgUnderline?g.fQ[C]:0;t.onCallOut(w.current,i,null!==(n=i.textInContext)&&void 0!==n?n:"","keyboard"===e,(()=>{}),t.element,h.Ah.critique,(0,h.eO)(t.data),r),S("keyboard"===e?l.k.CritiqueCardShownViaKeyboardAction:(0,m.OW)(o))}),[i,S,C,t,w]),T=n.useCallback((()=>u(i.traceId)),[u,i]),x=y.includes(s.v.SecondaryButtonPressed),_=x?()=>k("mouse",s.c.SecondaryButtonPressed):()=>S(l.k.RightClickOnSquiggle),I=y.includes(s.v.MainButtonPressed)?()=>k("mouse",s.c.MainButtonPressed):()=>S(l.k.LeftClickOnSquiggle);n.useEffect((()=>{y.includes(s.v.Hover)&&(t.isMouseOver?k("mouse"):t.isCalloutOpened||u(i.traceId))}),[y,t.isMouseOver,t.isCalloutOpened,k,u,i.traceId,t.isCaretOver]);const E=i.typeId?"ms-squiggle-"+function(e,t){const o=Object.keys(e).filter((o=>e[o]===t));return o.length>0?o[0]:null}(c.L9,i.typeId):void 0,B=`ms-squiggle ms-squiggle-${i.priority} ${E} ${t.isCalloutOpened||t.isHighlighted?"hl":""} ${t.stealth?"stealth":""}`,A=t.isMouseOver?"mouse":t.isCaretOver?"keyboard":void 0,R=A&&!t.isCalloutOpened;return n.useEffect((()=>{R?d(r,w.current,i,A):p(i.traceId)}),[i,R,w,A,d,r,p]),n.useEffect((()=>()=>{p(i.traceId)}),[p,i]),e(Object.assign(Object.assign({},t),{patternName:C,className:B,squiggleRef:w,handleContextMenuEvent:x,openCalloutPredicate:e=>("ContextMenu"===e.key&&S(l.k.ContextMenuKeyUpEventOnSquiggle),b.some((t=>t(e)))),onKeyboardEvent:()=>k("keyboard"),onClick:I,onContextMenuClick:()=>{p(i.traceId,!0)},closeCalloutOnNonLeftClick:T,onRightClickEvent:_,onEscapePress:()=>p(i.traceId)}))}},y=n.memo(b(u.m),f.I),w=n.memo(b(d.z),f.I),C=n.memo(b(p.G),f.P);let S=class{constructor(e){this.hostSettings=e}getSquiggles(e,t,o,i,s){const a=(0,r.g)(this.hostSettings,s);if(a)return n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:o,forcedHighContrast:i,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!1,anchorElement:s});{const l=a&&n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:o,forcedHighContrast:i,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!0,anchorElement:s});return n.createElement(n.Fragment,null,l,t.map((e=>n.createElement(y,Object.assign({key:e.id},e,{isAutoCorrectionEnabled:this.hostSettings.enableAutoCorrect,squiggleKind:h.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey})))))}}getFormInputSquiggle(e,t,o,i){return n.createElement(C,Object.assign({key:e},t,{squiggleKind:h.Ah.critique,useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey}))}};S=(0,i.__decorate)([(0,v._)()],S)},90182:(e,t,o)=>{"use strict";o.d(t,{g:()=>i});const i=(0,o(63837).f)("ISquigglerUXFactory")},26607:(e,t,o)=>{"use strict";if(o.d(t,{I:()=>n,P:()=>r}),3023==o.j)var i=o(7711);function n(e,t){const o=e.stealth===t.stealth,n=e.isHighlighted===t.isHighlighted,r=e.isCaretOver===t.isCaretOver,s=e.isMouseOver===t.isMouseOver,a=e.isCalloutOpened===t.isCalloutOpened,l=(0,i.a)(e.data.clientRect,t.data.clientRect);return r&&s&&a&&l&&n&&o}function r(e,t){const o=e.isHighlighted===t.isHighlighted,i=e.isCaretOver===t.isCaretOver,n=e.isMouseOver===t.isMouseOver,r=e.isCalloutOpened===t.isCalloutOpened,s=e.data.start===t.data.start,a=e.data.end===t.data.end,l=e.data.text===t.data.text,c=e.data.overlayCss.height===t.data.overlayCss.height,u=e.data.overlayCss.width===t.data.overlayCss.width;return r&&i&&a&&c&&u&&n&&s&&l&&o}},6011:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>d,u:()=>c}),3023==o.j)var i=o(52894);if(3023==o.j)var n=o(51285);if(3023==o.j)var r=o(1557);if(3023==o.j)var s=o(72403);if(3023==o.j)var a=o(3918);var l=o(95734);const c=e=>{var t;const{squigglerId:o,squigglesProps:c,theme:p,forcedHighContrast:f,opacity:m,hostSettings:v,isAutoCorrection:b,ariaStatusUpdatesOnly:y,anchorElement:w}=e;if((0,l.useEffect)((()=>()=>{const e=h(w);e&&u(e,o,b)}),[]),!d(v,w))return null;const C=h(w);u(C,o,b);const S=new Map,k=[];for(const e of c){const i=null!==(t=e.squiggleVerticalAdjustment)&&void 0!==t?t:0,n=(0,r.H7)(e.critique,!!v.enableAutoCorrect,e.squiggleKind),a=g(n,o,!1,S,e.data.range);e.isHighlighted&&g(n,o,e.isHighlighted,S,e.data.range);const l={id:a,patternName:n,opacity:m,squiggleVerticalAdjustment:i};(0,s.IG)(k,l)&&k.push(l)}for(const[e,t]of S)C.set(e,t);return y||0===k.length?l.createElement(l.Fragment,null):l.createElement(l.Fragment,null,c.map(((e,t)=>l.createElement(i.hJ,Object.assign({key:t.toString()},e,{squiggleKind:n.Ah.critique,useAltHotkey:!!v.useAlternativeSquiggleHotkey})))),l.createElement("style",null,"@media not print {",k.map((e=>{const{main:t,background:o}=(0,a.q)(e,p,f);return`\n            ::highlight(${e.id}) {\n              ${t}\n            }\n            ::highlight(${e.id}-hl) {\n              ${o}\n            }\n            `})),"}"))};function u(e,t,o){for(const i in r.Bn){const n=r.Bn[i];o===(n===r.Bn.AutoCorrectSquiggle)&&(e.delete((0,s.Mf)(n,t,!1)),e.delete((0,s.Mf)(n,t,!0)))}}function d(e,t){return!!e.enableCSSHighlightApiSquiggleRendering&&void 0!==h(t)}function h(e){var t,o,i;return null===(i=null===(o=(null!==(t=null==e?void 0:e.ownerDocument)&&void 0!==t?t:document).defaultView)||void 0===o?void 0:o.CSS)||void 0===i?void 0:i.highlights}function g(e,t,o,i,n){const r=(0,s.Mf)(e,t,o),a=function(e,t,o,i){let n=o.get(e);return n?(n.add(i),n):(n=new Highlight(i),n.type=(0,s.pE)(t),n)}(r,e,i,n);return i.set(r,a),r}},72403:(e,t,o)=>{"use strict";function i(e,t){const o=Math.max(0,Math.min(1,t));if(7===e.length)return e+Math.floor(255*o).toString(16).padStart(2,"0");{const t=parseInt(e.slice(-2),16)/255,i=Math.floor(o*t*255).toString(16).padStart(2,"0");return e.slice(0,-2)+i}}function n(e){switch(e){case"SpellingSquiggle":return"spelling-error";case"GrammarSquiggle":case"AdvancedSquiggle":return"grammar-error";default:return"highlight"}}function r(e,t,o){return e+"-"+t+(o?"-hl":"")}function s(e,t){return!e.some((e=>e.id===t.id&&e.patternName===t.patternName&&e.opacity===t.opacity&&e.squiggleVerticalAdjustment===t.squiggleVerticalAdjustment))}o.d(t,{$v:()=>i,IG:()=>s,Mf:()=>r,pE:()=>n})},3918:(e,t,o)=>{"use strict";if(o.d(t,{q:()=>r}),3023==o.j)var i=o(1557);if(3023==o.j)var n=o(72403);function r(e,t,o=!1){const{patternName:r,opacity:s,squiggleVerticalAdjustment:a}=e,l=e=>o?"highlight":e;let c="",u="";switch(r){case i.Bn.SpellingSquiggle:c=`text-decoration: ${l(t.highPriorityColors.tile)} wavy underline;\n           text-decoration-skip-ink: none;\n           text-decoration-thickness: 1px;\n           text-underline-offset: ${a}px;`,u=`background-color: ${l(t.highPriorityColors.highlight)};`;break;case i.Bn.GrammarSquiggle:c=`text-decoration: ${l(t.mediumPriorityColors.tile)} double underline;\n           text-decoration-skip-ink: none;\n           text-underline-offset: ${.5+a}px;`,u=`background-color: ${l(t.mediumPriorityColors.highlight)};`;break;case i.Bn.AdvancedSquiggle:c=`text-decoration: ${l(t.lowPriorityColors.tile)} dashed underline;\n           text-decoration-skip-ink: none;\n           text-underline-offset: ${a}px;\n           text-decoration-thickness: 2px;`,u=`background-color: ${l(t.lowPriorityColors.highlight)};`;break;case i.Bn.CIQFlagSquiggle:c=`text-decoration: ${l(t.ciqFlagColors.tile)} dotted underline;\n           text-decoration-skip-ink: none;\n           text-underline-offset: ${1+a}px;\n           text-decoration-thickness: 3px;`,u=`background-color: ${l(t.ciqFlagColors.highlight)};`;break;case i.Bn.HeadingDetectionSquiggle:c=`text-decoration: ${l(t.headingDetectionColors.tile)} dashed underline;\n           text-decoration-skip-ink: none;\n           text-underline-offset: ${a}px;\n           text-decoration-thickness: 2px;`,u=`background-color: ${l(t.headingDetectionColors.highlight)};`;break;case i.Bn.AutoCorrectSquiggle:c=`text-decoration: ${l((0,n.$v)(t.autoCorrectColors.tile,s))} solid underline;\n            background-color: ${l((0,n.$v)(t.autoCorrectColors.highlight,s))};\n            text-decoration-skip-ink: none;\n            text-underline-offset: ${1+a}px;\n            text-decoration-thickness: 1px;`,u=`text-decoration: ${l(t.autoCorrectColors.tile)} solid underline;\n        background-color: ${l(t.autoCorrectColors.highlight)};`}return{main:c,background:u}}},7318:(e,t,o)=>{"use strict";o.d(t,{M:()=>r});var i=o(95734);if(3023==o.j)var n=o(46546);const r=e=>{const[t,o]=i.useState(0),r=i.useRef([]);i.useEffect((()=>(0,n.observe)(e.map,(e=>{r.current.push(e.name),o((e=>e+1))}))),[e.map]);const a=r.current;return r.current=[],i.createElement(i.Fragment,null,Array.from(e.map).map((([t,o])=>i.createElement(s,{key:t,id:t,value:o,changedReferences:a,renderEntry:e.renderEntry}))))},s=i.memo((e=>e.renderEntry(e.id,e.value)),((e,t)=>e.id===t.id&&t.changedReferences.length>0&&!t.changedReferences.includes(e.id)))},19376:(e,t,o)=>{"use strict";if(o.d(t,{G:()=>n}),3023==o.j)var i=o(11387);class n{constructor(e,t,o,i){this.calloutStateStore=e,this.inlineSuggestionsRenderer=t,this.undoCalloutStateStore=o,this.logger=i}async showFlagCritique(e){var t,o,n,r,s,a;(0,i.r3)(e.critique)?e.onApplyFlag?this.inlineSuggestionsRenderer?(await this.inlineSuggestionsRenderer.showFlag(e.critique,e.onApplyFlag,((e,t)=>{var o,i,n;t?null===(o=this.calloutStateStore)||void 0===o||o.hide():null===(i=this.calloutStateStore)||void 0===i||i.clickNoActionHide(e),null===(n=this.undoCalloutStateStore)||void 0===n||n.hide()}),e.onFlagIgnoreOnce,e.onFlagIgnoreAll,e.onDisableFlag,e.onShowFeedback,null===(r=this.calloutStateStore)||void 0===r?void 0:r.navInfo,null===(s=this.calloutStateStore)||void 0===s?void 0:s.navigate),null===(a=this.calloutStateStore)||void 0===a||a.markAsShown(e.critique,e.onDismiss)):null===(n=this.logger)||void 0===n||n.error(508909200,"Got flag callout display, but no inlineSuggestionRenderer"):null===(o=this.logger)||void 0===o||o.error(508909201,"Got flag callout display, but no function for onApplyFlag was specified"):null===(t=this.logger)||void 0===t||t.error(0,"Got a critique that is not a flag critique, but expected a flag critique")}}},30882:(e,t,o)=>{"use strict";o.d(t,{m:()=>s});var i=o(95734);if(3023==o.j)var n=o(87111);if(3023==o.j)var r=o(79704);const s=e=>{const{top:t,left:o,width:s,height:a}=e.data.clientRect,l=e.isVisible?void 0:"none";return i.createElement(i.Fragment,null,i.createElement(n.z,{anchor:e.anchor,disableCalloutOnDoubleClick:e.disableCalloutOnDoubleClick,element:e.element,isCaretOver:e.isCaretOver,isMouseOver:e.isMouseOver,handleContextMenuEvent:e.handleContextMenuEvent,isCalloutOpened:e.isCalloutOpened,openCalloutPredicate:e.openCalloutPredicate,onKeyboardEvent:e.onKeyboardEvent,onClick:e.onClick,onContextMenuClick:e.onContextMenuClick,closeCalloutOnNonLeftClick:e.closeCalloutOnNonLeftClick,onRightClickEvent:e.onRightClickEvent,onEscapePress:e.onEscapePress}),i.createElement("span",{role:e.role,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,ref:e.squiggleRef,className:e.className,style:{top:t,left:o,width:s,height:a,zIndex:e.data.zIndex,display:l,opacity:e.opacity}}),e.useSvgUnderline&&i.createElement(r.a,{width:s,left:o,squiggleHeight:t+a,patternName:e.patternName,className:e.className,styleOverrides:{display:l,opacity:e.opacity}}))}},87111:(e,t,o)=>{"use strict";o.d(t,{z:()=>a});var i=o(95734);if(3023==o.j)var n=o(23094);if(3023==o.j)var r=o(84166);if(3023==o.j)var s=o(99501);const a=e=>{const{anchor:t,isCalloutOpened:o,disableCalloutOnDoubleClick:a,element:l,isCaretOver:c,isMouseOver:u,handleContextMenuEvent:d,onClick:h,onEscapePress:g,onKeyboardEvent:p,closeCalloutOnNonLeftClick:f,onRightClickEvent:m,openCalloutPredicate:v}=e,b=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),y=i.useRef(null),w=()=>{var e;const t=(null!==(e=l.ownerDocument.defaultView)&&void 0!==e?e:window).getSelection();return!(!t||t.focusNode!==t.anchorNode||t.focusOffset!==t.anchorOffset)};return i.useEffect((()=>{var i;const s=t=>{var i;null===(i=e.onContextMenuClick)||void 0===i||i.call(e),d&&(u||c)&&!o&&w()&&(b(t),null==m||m())},g=e=>{u&&!o&&w()&&(null==h||h())},p=e=>{o&&(e.button===r.c.MainButtonPressed||d||null==f||f())};if(a){const e=null!==(i=l.ownerDocument.defaultView)&&void 0!==i?i:window,o=t=>{const o=t;o.button===r.c.MainButtonPressed?1===o.detail&&(y.current=e.setTimeout(g,200)):null==f||f()},a=()=>{y.current&&(e.clearTimeout(y.current),y.current=null)},c=e=>a(),u=new n.J(t);return u.addListener("contextmenu",s),u.addListener("click",o),u.addListener("dblclick",c),u.addListener("mouseup",p),()=>{u.removeAllListeners(),a()}}{const e=new n.J(t);return e.addListener("contextmenu",s),e.addListener("click",g),e.addListener("mouseup",p),()=>{e.removeAllListeners()}}}),[t,a,l,f,u,o,h]),i.useEffect((()=>{if(c||u||o){const e=(0,s.a2)(t),i=new n.J(e),r=e=>{const t=e;c&&!o&&(null==v?void 0:v(t))?"keyup"===t.type?(null==p||p(),t.preventDefault()):b(e):"Escape"===t.key&&"keyup"===t.type&&(null==g||g())};return i.addListener("keyup",r,{capture:!0}),o||(i.addListener("focus",b),i.addListener("blur",b),i.addListener("keydown",r,{capture:!0})),()=>{i.removeAllListeners()}}}),[u,c,o,t,v,p,g]),null}},1557:(e,t,o)=>{"use strict";o.d(t,{Bn:()=>l,H7:()=>c,K3:()=>d,VA:()=>h,fQ:()=>u});var i=o(95734);if(3023==o.j)var n=o(10059);if(3023==o.j)var r=o(43713);if(3023==o.j)var s=o(51285);if(3023==o.j)var a=o(96950);const l={SpellingSquiggle:"SpellingSquiggle",GrammarSquiggle:"GrammarSquiggle",AdvancedSquiggle:"AdvancedSquiggle",CIQFlagSquiggle:"CIQFlagSquiggle",HeadingDetectionSquiggle:"HeadingDetectionSquiggle",AutoCorrectSquiggle:"AutoCorrectSquiggle",UnknownSquiggle:"UnknownSquiggle"};function c(e,t,o){switch(e.priority){case n.bx.High:return(0,a.MG)(e)&&t&&o!==s.Ah.critique?"AutoCorrectSquiggle":"SpellingSquiggle";case n.bx.Medium:return"GrammarSquiggle";case n.bx.Low:return"AdvancedSquiggle";case n.bx.Informational:return e.typeId===n.L9.HeadingDetection?"HeadingDetectionSquiggle":"CIQFlagSquiggle";default:return"UnknownSquiggle"}}const u={SpellingSquiggle:4,GrammarSquiggle:3,AdvancedSquiggle:2,CIQFlagSquiggle:3,HeadingDetectionSquiggle:2,AutoCorrectSquiggle:1,UnknownSquiggle:0},d={SpellingSquiggle:0,GrammarSquiggle:0,AdvancedSquiggle:0,CIQFlagSquiggle:1,HeadingDetectionSquiggle:0,AutoCorrectSquiggle:0,UnknownSquiggle:0},h=e=>{const{theme:t}=e,o="squiggleHighlightStrokeColor",n="squiggleHighlightFillColor",s=`\n      ${r.Rr} {\n        .${o} {\n          stroke: highlight;\n        }\n        .${n} {\n          fill: highlight;\n        }\n      }`;return i.createElement(i.Fragment,null,i.createElement("style",null,s),i.createElement("svg",{width:"0",height:"0",style:{position:"absolute"}},i.createElement("defs",null,i.createElement("pattern",{id:l.SpellingSquiggle,width:"5",height:u.SpellingSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("path",{d:"M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3",className:o,stroke:t.highPriorityColors.tile,strokeWidth:"1",fill:"transparent"})),i.createElement("pattern",{id:l.GrammarSquiggle,width:"5",height:u.GrammarSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round"},i.createElement("g",{className:o,stroke:t.mediumPriorityColors.tile},i.createElement("path",{d:"M0,0.5 L5,0.5"}),i.createElement("path",{d:"M0,2.5 L5,2.5"})))),i.createElement("pattern",{id:l.AdvancedSquiggle,width:"10",height:u.AdvancedSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("path",{d:"M1,1 L5,1",className:o,stroke:t.lowPriorityColors.tile,strokeWidth:"2",strokeLinecap:"round"}))),i.createElement("pattern",{id:l.AutoCorrectSquiggle,width:"5",height:u.AutoCorrectSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none"},i.createElement("path",{d:"M0,0.5 L5,0.5",className:o,strokeWidth:"1",stroke:t.autoCorrectColors.tile}))),i.createElement("pattern",{id:l.CIQFlagSquiggle,width:"6",height:u.CIQFlagSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("circle",{cx:"1.5",cy:"1.5",r:"1.5",className:n,fill:t.ciqFlagColors.tile}))),i.createElement("pattern",{id:l.HeadingDetectionSquiggle,width:"10",height:u.HeadingDetectionSquiggle,patternUnits:"userSpaceOnUse"},i.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.createElement("path",{d:"M1,1 L5,1",className:o,stroke:t.headingDetectionColors.tile,strokeWidth:"2",strokeLinecap:"round"}))))))}},79704:(e,t,o)=>{"use strict";o.d(t,{a:()=>r});var i=o(95734);if(3023==o.j)var n=o(1557);const r=e=>{const{className:t,left:o,patternName:r,squiggleHeight:s,styleOverrides:a,width:l}=e,c=n.fQ[r],u=n.K3[r];return i.createElement("svg",{width:l,height:c,viewBox:`0 0 ${l} ${c}`,className:t,style:Object.assign({top:s?s-c+u:void 0,bottom:s?void 0:-1*(c+u),left:o,position:"absolute"},a)},i.createElement("rect",{fill:`url(#${r})`,width:l,height:c}))}},35047:(e,t,o)=>{"use strict";o.d(t,{$:()=>A});var i=o(95734),n=o(37842),r=o(8676),s=o(78376),a=o(8903),l=o(44680),c=o(31685),u=o(2579),d=o(3755),h=o(8996),g=o(3039),p=o(90182),f=o(7318),m=o(51285),v=o(7051);const b=e=>i.createElement(f.M,{map:e.squigglerState.squigglesMap,renderEntry:(t,o)=>i.createElement(y,Object.assign({key:t,squiggles:o},e))}),y=(0,v.PA)((e=>{var t;const o=[],n=[];let r=0,s=0;for(const t of e.squiggles.values()){const i=t.filter((t=>{var o;return t.isVisible&&e.squigglerState.anchorElement&&(null===(o=e.squigglerState.hostElement)||void 0===o?void 0:o.shouldRenderSquiggle(t.data.range.startContainer,e.squigglerState.anchorElement))})),a=e.squigglerState.getSquiggleProps(i);a.length>0&&a[0].squiggleKind!==m.Ah.critique?n.push(...a):o.push(...a);for(const e of a)r=Math.max(r,e.data.clientRect.right),s=Math.max(s,e.data.clientRect.bottom)}const a=i.createElement(i.Fragment,null,i.createElement(w,Object.assign({},e,{squiggles:o,squiggleKind:m.Ah.critique,anchorElement:e.squigglerState.anchorElement})),i.createElement(w,Object.assign({},e,{squiggles:n,squiggleKind:m.Ah.autocorrection,anchorElement:e.squigglerState.anchorElement})));if(e.squigglerState.disableAutoBrowserVirtualizationOfSquiggles)return a;const l=r,c=s;return i.createElement("div",{key:null===(t=e.squigglerState.anchorElement)||void 0===t?void 0:t.id,style:{contentVisibility:"auto",containIntrinsicSize:`${l}px ${c}px`,contain:"strict",position:"absolute",width:l,height:c}},a)})),w=(0,v.PA)((e=>{var t;const o=e.squigglerUXFactory(e.squiggleKind);return i.createElement(i.Fragment,{key:e.squiggleKind},o.getSquiggles(e.squigglerId+(null===(t=e.anchorElement)||void 0===t?void 0:t.id),e.squiggles,e.theme,e.forcedHighContrast,e.anchorElement))}));var C=o(1557),S=o(6011),k=o(4984),T=o(10059),x=o(43713);const _=(e=h.N.GENERIC,t,o,i)=>{const n=function(e,t){switch(e){case h.N.OFFICE:return function(e){return`\n    span.ms-squiggle-${T.bx.High} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.spellingTile};\n    }\n\n    span.ms-squiggle-${T.bx.Medium} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.grammarTile};\n    }\n\n    span.ms-squiggle-${T.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.insightTile};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 1px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      border-image-source: ${e.autoCorrectTile};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t);case h.N.SVG:return function(e){return`\n  span.ms-squiggle-autocorrect-hl, svg.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      box-sizing: border-box;\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-autocorrect, svg.ms-squiggle-autocorrect {\n      opacity: 0%;\n    }\n  `}(t);case h.N.GENERIC:default:return function(e){return`\n    span.ms-squiggle-${T.bx.High} {\n      border-bottom: 4px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.highPriorityColors.tile};\n      border-image-source: ${e.spellingTileBorder};\n    }\n\n    span.ms-squiggle-${T.bx.Medium} {\n      border-bottom: 3px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.mediumPriorityColors.tile};\n      border-image-source: ${e.grammarTileBorder};\n    }\n\n    span.ms-squiggle-${T.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px solid;\n      border-image-slice: 0 1 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.lowPriorityColors.tile};\n      border-image-source: ${e.insightTileBorder};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-image-source: ${e.autoCorrectTileBorder};\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t)}}(e,t),r=`\n        span.ms-squiggle {\n            position: absolute;\n            border-radius: 2px;\n            border-image-repeat: repeat;\n            background-clip: content-box;\n            cursor: text;\n            pointer-events: none;\n            box-sizing: ${e===h.N.OFFICE?"content-box":"border-box"};\n        }\n\n        span.ms-squiggle.stealth, svg.ms-squiggle.stealth {\n          opacity: 0%;\n          transition: opacity 0.25s;\n        }\n\n        span.ms-squiggle.stealth.hl, svg.ms-squiggle.stealth.hl {\n          opacity: 100%;\n        }\n\n        ${n}\n        ${function(e){return`\n    span.ms-squiggle-${T.bx.High}.hl {\n      background-color: ${e.theme.highPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${T.bx.Medium}.hl {\n      background-color: ${e.theme.mediumPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${T.bx.Low}.hl:not(.ms-squiggle-TopicSuggestion.hl) {\n      background-color: ${e.theme.lowPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition.hl, .ms-squiggle-CIQFlag_DateEntityRecognition.hl, .ms-squiggle-CIQFlag_SatoriEntityRecognition.hl, .ms-squiggle-CIQFlag_Location.hl, .ms-squiggle-CIQFlag_File.hl, .ms-squiggle-CIQFlag_Time.hl, .ms-squiggle-CIQFlag_Topic.hl, .ms-squiggle-CIQFlag_TaskRecognition.hl, .ms-squiggle-TopicSuggestion.hl, .ms-squiggle-CIQFlag_LocalBusiness.hl {\n      background-color: ${e.theme.ciqFlagColors.highlight};\n    }\n\n    span.ms-squiggle-HeadingDetection.hl {\n      background-color:${e.theme.headingDetectionColors.highlight};\n    }\n  `}(t)}\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n    `,s=`\n        span.hc-noadjust {\n          -ms-high-contrast-adjust: none;\n          forced-color-adjust: none;\n        }\n\n        span.ms-squiggle {\n          forced-color-adjust:none;\n          cursor: text;\n          box-sizing: border-box;\n          pointer-events: none;\n          border-color: highlight;\n          border-image-source: none;\n          background-image: none;\n          position: absolute;\n          border-radius: 0px;\n        }\n\n        ${function(e){return e===h.N.SVG?"":`\n    span.ms-squiggle-${T.bx.High} {\n      border-bottom: 4px solid highlight;\n    }\n\n    span.ms-squiggle-${T.bx.Medium} {\n      border-bottom: 3px double highlight;\n    }\n\n    span.ms-squiggle-${T.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px dashed highlight;\n    }\n\n    span.ms-squiggle-autocorrect {\n      border-bottom: none;\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid highlight;\n    }\n  `}(e)}\n\n        span.ms-squiggle-autocorrect {\n          border-bottom: none;\n        }\n\n        span.hl {\n          outline: 2px solid highlight;\n        }\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n\n        span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition,, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n          background-image: linear-gradient(to right, #3c97dd 33%, rgba(0,0,0,0) 0%);\n          background-position: bottom;\n          background-size: 6px 2px;\n          background-repeat: repeat-x;\n        }\n    `;return o?s:i?`\n    @media not (forced-colors: active) {\n      ${r}\n    }\n    ${x.Rr} {\n      ${s}\n    }`:r};var I=o(38883),E=o(13956);const B=(0,n.F5)({featureFlagsReader:r.A.on(a.c),hostSettings:r.A.on(l.n),squigglerUXFactory:r.A.on(p.g),safeWindow:r.A.on(c.j),highConstrastModeDetector:r.A.on(g.P)});class A extends i.Component{constructor(e){super(e),this.connectSquiggler=()=>{this.squigglerEvents.connectSquiggler()},this.disconnectSquiggler=()=>{this.squigglerEvents.disconnectSquiggler()},this.setSquigglerRef=e=>{this.props.state.setSquigglerRef(e),this.squigglerEvents.updatePositionIfRelative()},this.shouldRender=()=>{var e,t;return null!==(t=null===(e=this.props.state.hostElement)||void 0===e?void 0:e.shouldRender(this.props.state.anchorElement))&&void 0!==t&&t},this.selectorRef=i.createRef();const t=new u.O(this.props.state.anchorElement?(0,d.e)(this.props.state.anchorElement):window);this.squigglerEvents=this.props.state.squigglerEventManager.createEventManager(t,this.props.state,this.props.deps.safeWindow)}componentDidUpdate(e){var t;const o=this.props.state.isVisible,i=e.state.isVisible;o?(this.props.state.reactOnComponentUpdate&&(this.squigglerEvents.updatePositionIfRelative(),this.squigglerEvents.checkHighlight()),i||this.connectSquiggler()):i&&this.disconnectSquiggler(),this.selectorRef.current&&(null===(t=this.props.state.hostElement)||void 0===t||t.squigglerUpdated(this.selectorRef.current))}async componentDidMount(){this.connectSquiggler(),await this.props.state.updateRanges(),this.squigglerEvents.checkHighlight(),this.squigglerEvents.updatePositionIfRelative()}componentWillUnmount(){this.disconnectSquiggler(),this.props.state.disconnectVisibilityTracker(),this.squigglerEvents.dispose()}render(){let e={};const{isRelativePositionEnabled:t,squiggleStyleType:o,id:n,top:r,left:s,anchorElement:a,isVisible:l,parentToRenderTo:c,hostElement:u,theme:d,scaleTransformValue:g,forcedHighContrast:p}=this.props.state;if(!a||!c||!u)return null;e=t?{pointerEvents:"none",position:"relative",flexGrow:0,msHighContrastAdjust:"none",display:"block",top:`${r}px`,left:`${s}px`}:{pointerEvents:"none",position:"absolute",msHighContrastAdjust:"none",flexGrow:0,top:`${r}px`,left:`${s}px`};const f=u.squigglerInlineStyles(a,g),m=o===h.N.SVG,v=_(o,d,p,this.props.deps.highConstrastModeDetector.browserSupportsHighContrastMode),y=i.createElement(b,{squigglerState:this.props.state,squigglerId:n,theme:d.theme,forcedHighContrast:p,squigglerUXFactory:this.props.deps.squigglerUXFactory});return(0,S.g)(this.props.deps.hostSettings,a)?l&&this.shouldRender()?y:null:I.createPortal(i.createElement("editor-squiggler",{"aria-hidden":this.props.state.ariaEnabled,tabindex:-1,style:{height:"0px",width:"0px"},ref:this.selectorRef},i.createElement(i.Fragment,null,i.createElement("style",null,"\n  @media print {\n    .ms-editor-squiggler {\n        display:none !important;\n    }\n  }\n  .ms-editor-squiggler {\n    all: initial;\n    display: block !important;\n    height: 0px !important;\n    width: 0px !important;\n  }"),i.createElement(E.Ay.div,{className:"ms-editor-squiggler",ref:this.setSquigglerRef,style:f},i.createElement("style",{type:"text/css"},v),m&&i.createElement(C.VA,{theme:d.theme}),i.createElement("div",{style:e},l&&this.shouldRender()&&y)))),c)}}(0,s.r)((0,k.PA)(A),B)},99501:(e,t,o)=>{"use strict";o.d(t,{a2:()=>u,pT:()=>a});var i=o(30206),n=o(23094),r=o(40664),s=o(48828);let a=class{createEventManager(e,t,o){return new c(e,t,o)}};a=(0,i.__decorate)([(0,s._)()],a);const l={passive:!1};class c{constructor(e,t,o){var i;this.targetWindowRef=e,this.state=t,this.safeWindow=o,this.isMouseWithinElement=!1,this.disconnectAdditionalHandlers=()=>null,this.connectedEventListeners=[],this.connectSquiggler=()=>{for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[];const e=this.targetWindowRef.deref();if(!e)return;const t=new n.J(e),o=new n.J(e.document);if(this.connectedEventListeners.push(t),this.connectedEventListeners.push(o),t.addListener("resize",this.reRenderDeferred,l),o.addListener("mouseup",this.onDocumentMouseUp,l),o.addListener("pointerup",this.onDocumentMouseUp,l),o.addListener("selectionchange",this.checkHighlight,l),this.state.anchorElement&&this.state.hostElement){const e=new n.J(this.state.anchorElement);if(this.connectedEventListeners.push(e),e.addListener("mouseenter",this.onMouseEnter,l),e.addListener("mouseleave",this.onMouseLeave,l),this.resizeObserver){this.resizeObserver.observe(this.state.anchorElement);for(const e of this.state.hostElement.shouldObserveSize(this.state.anchorElement))e&&this.resizeObserver.observe(e)}const t=u(this.state.anchorElement),o=new n.J(t);this.connectedEventListeners.push(o),o.addListener("input",this.onInputHandler,l),o.addListener("keyup",this.throttleKeyUp,l),this.isScrollable&&(o.addListener("scroll",this.throttleScroll,l),o.addListener("mousewheel",this.throttleScroll,l),o.addListener("touchmove",this.throttleScroll,l)),o.addListener("focusin",this.checkHighlight,l),o.addListener("focusout",this.throttleFocusOut,l),this.disconnectAdditionalHandlers=this.state.hostElement.addHandlers(this.state.anchorElement,this,this.state.proofedElements.map((e=>e.id)))}},this.disconnectSquiggler=()=>{var e;for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[],this.lastMouseMoveEvent=void 0,null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.resizeObserver=void 0,this.disconnectAdditionalHandlers(),this.disconnectAdditionalHandlers=()=>{}},this.dispose=()=>{this.disconnectSquiggler(),this.throttledCheckCursorHighlight=void 0},this.reRender=()=>{this.state.updateRanges()},this.updatePositionIfRelative=()=>{this.requiresUpdateForRelativePosition()&&this.reRender()},this.checkHighlight=()=>{var e,t;const o=this.targetWindowRef.deref();o&&this.state.anchorElement&&(o.document.activeElement===this.state.anchorElement||this.state.anchorElement.contains(o.document.activeElement)||(null===(e=o.document.activeElement)||void 0===e?void 0:e.contains(this.state.anchorElement)))&&(this.onMouseEnter(),this.checkCaretPosition(),null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this))},this.onMouseEnter=()=>{var e;this.isMouseWithinElement=!0,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.anchorElement&&(this.mouseWithinElementEventListener=new n.J(this.state.anchorElement),this.connectedEventListeners.push(this.mouseWithinElementEventListener),this.mouseWithinElementEventListener.addListener("mousemove",this.onMouseMove,l))},this.onMouseLeave=()=>{var e;this.isMouseWithinElement=!1,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.setLastMousePosition(void 0),this.state.trivializeAllSquiggles("cursor")},this.onFocusOut=()=>{this.state.trivializeAllSquiggles("caret"),this.state.closeTooltip()},this.onInputHandler=()=>{this.onInput()},this.onInput=()=>{(this.getShouldReactToInput()||this.state.isAutoCorrectionOnly||this.requiresUpdateForRelativePosition())&&this.reRender()},this.onKeyup=e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key)?this.checkCaretPosition():("Delete"===e.key||"Backspace"===e.key||this.isTabPressed(e)||this.state.isAutoCorrectionOnly)&&this.onInput()},this.isTabPressed=e=>"Tab"===e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey,this.checkCaretPosition=()=>{var e;const t=((null===(e=this.state.anchorElement)||void 0===e?void 0:e.ownerDocument)||document).getSelection();t&&t.rangeCount>0&&this.state.updateSelectionHighlightState(t)},this.onMouseMove=e=>{var t;this.state.anchorElement&&this.isMouseWithinElement?(this.lastMouseMoveEvent=e,null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this)):this.lastMouseMoveEvent=void 0},this.checkCursorHighlight=()=>{if(this.lastMouseMoveEvent&&this.state.anchorElement){const e={x:this.lastMouseMoveEvent.clientX,y:this.lastMouseMoveEvent.clientY};this.state.setLastMousePosition(e)}this.state.updateCursorHighlightState(),this.lastMouseMoveEvent=void 0},this.onDocumentMouseUp=e=>{this.onMouseClick(e),this.reRenderDeferred()},this.onMouseClick=e=>{const{anchorElement:t,updateCursorHighlightState:o,setLastMousePosition:i}=this.state;t&&(i({x:e.clientX,y:e.clientY}),this.checkCaretPosition(),o())},this.throttleScroll=()=>{this.reRenderDeferred()},this.reRenderDeferred=()=>{this.safeWindow.requestAnimationFrame((()=>this.reRender()),this.targetWindowRef)},this.throttleKeyUp=e=>{this.safeWindow.requestAnimationFrame((()=>this.onKeyup(e)),this.targetWindowRef)},this.throttleFocusOut=()=>{this.safeWindow.requestAnimationFrame((()=>this.onFocusOut()),this.targetWindowRef)},this.throttleUpdateOnResize=()=>{this.safeWindow.requestAnimationFrame((()=>{this.state.updatePosition(this.state.isRelativePositionEnabled),this.reRender()}),this.targetWindowRef)},this.requiresUpdateForRelativePosition=()=>{const{isRelativePositionEnabled:e}=this.state;return e&&this.state.updatePosition(e)},this.determineIfScrollable=e=>{switch(e){case"scroll":return!0;case"hidden":case"visible":return!1;default:return null}};const s=e.deref();if(s&&(this.throttledCheckCursorHighlight=(0,r.hQ)(this.safeWindow,s,this.checkCursorHighlight,"After"),this.state.anchorElement)){if(this.isScrollable=null===(i=this.state.hostElement)||void 0===i?void 0:i.isScrollable(this.state.anchorElement),void 0===this.isScrollable){const e=this.getAnchorElementComputedStyle();this.isScrollable=e&&!(!1===this.determineIfScrollable(e.overflowX)&&!1===this.determineIfScrollable(e.overflowY))}s.ResizeObserver&&(this.resizeObserver=new s.ResizeObserver((()=>this.throttleUpdateOnResize())))}}getAnchorElementComputedStyle(){var e;return this.anchorElementComputedStyle||(this.anchorElementComputedStyle=this.state.anchorElement&&(null===(e=this.targetWindowRef.deref())||void 0===e?void 0:e.getComputedStyle(this.state.anchorElement))),this.anchorElementComputedStyle}getShouldReactToInput(){if(void 0!==this.reactToOnInput)return this.reactToOnInput;const e=this.getAnchorElementComputedStyle();return this.reactToOnInput=["center","right"].includes((null==e?void 0:e.textAlign)||"")||"rtl"===(null==e?void 0:e.direction),this.reactToOnInput}}function u(e){let t=e;if("true"!==t.contentEditable&&t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(t=e)}return t}},69711:(e,t,o)=>{"use strict";o.d(t,{i:()=>pe});var i=o(30206),n=o(23751),r=o(71905),s=o(79993),a=o(45118),l=o(44332),c=o(12376),u=o(44573),d=o(15885),h=o(88787),g=o(36271),p=o(66526),f=o(6638),m=o(51218),v=o(85996),b=o(21206),y=o(6754),w=o(13494),C=o(31685),S=o(21077),k=o(44680),T=o(86278),x=o(18582),_=o(83732),I=o(92910),E=o(32673),B=o(95734),A=o(46546),R=o(92037);class M{constructor(e,t,o){this.range=e,this.zIndex=o,this.originalStartContainerOfRange=e.startContainer,this.clientRect=t}isRangeInValidState(){return this.range.startContainer===this.originalStartContainerOfRange&&!this.range.collapsed}updateRange(e){e&&(this.range=e)}}class D{constructor(e,t,o,i,n,r,s,a){this.id=e,this.element=t,this.squiggleKind=o,this.critique=i,this.isVisible=n,this.stealth=r,this.data=s,this.squiggleRef=a,(0,R.Gn)(this)}updateFromRect(e,t){var o;this.isVisible!==e.visible&&(this.isVisible=e.visible),e.visible&&(this.data=new M(t,e,this.data.zIndex));const i=null!==(o=this.critique.isStealth)&&void 0!==o&&o;i!==this.stealth&&(this.stealth=i)}}(0,i.__decorate)([A.observable],D.prototype,"isVisible",void 0),(0,i.__decorate)([A.observable],D.prototype,"stealth",void 0),(0,i.__decorate)([A.observable],D.prototype,"data",void 0),(0,i.__decorate)([A.action],D.prototype,"updateFromRect",null);var P,F=o(19432),O=o(67127),N=o(10059),q=o(71621),j=o(3755),L=o(2579),z=o(8996),H=o(19613);function W(e,t,o,i){return e&&o>=e.top&&o<=e.bottom?t>=e.left&&t<=e.right?P.direct:i&&t>=e.right-i&&t<=e.left?P.indirect:P.line:P.none}function U(e,t){if("Caret"!==t.type||!t.focusNode)return P.none;if(e.isPointInRange(t.focusNode,t.focusOffset))return P.direct;const o=e.getBoundingClientRect(),i=t.getRangeAt(0).getBoundingClientRect();return o.top<=i.top&&o.bottom>=i.bottom?P.line:P.none}function G(e,t){return!("Caret"!==t.type||!t.focusNode)&&e.isPointInRange(t.focusNode,t.focusOffset)}!function(e){e.none="none",e.direct="direct",e.line="line",e.indirect="indirect"}(P||(P={}));var V=o(69013),$=o(51285),K=o(68675),J=o(54110),Y=o(99501),Q=o(7711);function Z(e){if(!e||"auto"===e)return 0;const t=parseInt(e,10);return isNaN(t)?0:t+1}function X(e,t){return e.bottom>t.bottom+e.height/4||e.left>t.right||e.right<t.left||e.bottom<t.top}function ee(e){if(!e)return 0;const t=parseFloat(e);return isNaN(t)?0:t}var te=o(40144),oe=o(96950),ie=o(31409),ne=o(37120);const re=()=>!0;var se=o(21479);class ae extends F.z{constructor(e,t,o,i,n,r,s,a,l,c,u,d){var g,p,f,m,v,b,y,w;super(),this.tileContent=t,this.hostSettings=o,this.proofingDom=i,this._squiggleThemeStore=n,this.critiqueApplicationHandler=r,this.critiqueRangeBuilder=s,this.autoCorrectionBroker=a,this.getIsHighContrastTheme=l,this.logger=c,this.upsellStore=u,this.editorSettingsState=d,this.diffPrecision=.01,this.isTooltipShown=!1,this.squigglesMap=new A.ObservableMap,this.autoCorrectDisabledLanguages=[],this.proofedElements=[],this.proofedElementDomRects=[],this.calloutOpenedForCritique=void 0,this.mouseHoveredElement=void 0,this.mouseIndirectlyHoveredElement=void 0,this.disabledCritiqueIdToShowTooltip=void 0,this.caretHoveredElement=void 0,this.scaleTransformValue=1,this.top=0,this.left=0,this.hadUpdateWithoutAnyValidSquiggles=!1,this.recalculateRelativePosition=()=>{this.isRelativePositionEnabledValue=this.calculateRelativePosition()},this.isVisible=!1,this.onCalloutPositionUpdated=(e,t)=>{this.isUndoCalloutAlignedRight=e,this.undoCalloutRect=t},this.setAutoCorrectLanguages=e=>{this.autoCorrectDisabledLanguages=e},this.setCritiques=async(e,t=!1)=>{var o;const i=this.proofedElements.find((t=>t.id===e.id));let n=!0;if(i){if(t){const t=e.critiques.length!==i.critiques.length||!e.critiques.every(((e,t)=>(0,O.gS)(e,i.critiques[t]))),r=(null===(o=this.squigglesMap.get(e.id))||void 0===o?void 0:o.size)!==e.critiques.length;n=t||r||this.hadUpdateWithoutAnyValidSquiggles,this.hadUpdateWithoutAnyValidSquiggles=!1}i.critiques=e.critiques}else this.proofedElements.push(e);n&&await this.updateRanges([e.id])},this.removeCritiques=async e=>{const t=this.proofedElements.findIndex((t=>t.id===e));-1!==t&&(this.squigglesMap.delete(e),this.proofedElements.splice(t,1),await this.updateRanges())},this.updateRanges=async e=>{var t;this.throttledUpdateRanges?(this.throttledUpdateRangesProofedElementsToCheck=e?[...null!==(t=this.throttledUpdateRangesProofedElementsToCheck)&&void 0!==t?t:[],...e]:void 0,await this.throttledUpdateRanges()):await this.updateRangesImmediately(e)},this.updateSquiggles=()=>{this.throttledUpdateSquiggles?this.throttledUpdateSquiggles():this.innerUpdateSquiggles()},this.setVisible=e=>{this.isVisible=e,e&&(this.cancelSetVisibleFrame(),this.setVisibleFrameRequestId=this.safeWindow.requestAnimationFrame((async()=>{await this.updateRanges()}),this.targetWindowRef))},this.setLastMousePosition=e=>{this.lastMousePosition=e},this.disconnectVisibilityTracker=()=>{var e;null===(e=this._visibilityTracker)||void 0===e||e.disconnect()},this.getCritiques=()=>this.proofedElements.reduce(((e,t)=>e.concat(t.critiques)),[]),this.showCallout=(e,t)=>{var o,i;const n=null===(o=this.targetWindowRef)||void 0===o?void 0:o.deref();if(!e.traceId||!n)return;const r=this.findSquiggle(e.traceId);if(r){const o=null!==(i=r.data.range.startContainer.parentElement)&&void 0!==i?i:r.element;this.cancelShowCalloutFrame(),this.showCalloutFrameRequestId=this.safeWindow.requestAnimationFrame((()=>{o.scrollIntoView({behavior:"auto"}),this.clearOnCalloutShownCallbackTimeout(),this.onCalloutShownCallbackTimeout=n.setTimeout((()=>{var o,i;this.hasSquigglerRefOrIsCSSHighlightSquiggle(r)&&(this.onShowCallout(null!==(i=null===(o=r.squiggleRef)||void 0===o?void 0:o.current)&&void 0!==i?i:null,e,r.data.range.toString(),!0,(()=>{}),r.element,$.Ah.critique,r.data.range),null==t||t())}),100)}),n)}},this.updateSelectionHighlightState=e=>{let t,o=0;this.forEachCritique((i=>{var n,r;for(const s of i.squiggles){if(!s.isVisible)continue;let a=P.none;this.ariaLineNavUpdatesEnabled?a=U(s.data.range,e):G(s.data.range,e)&&(a=P.direct),a===P.direct?(this.caretHoveredCritiqueId=s.critique.traceId,(1===i.squiggles.length||this.checkSquiggleSelection(s,e))&&(this.caretHoveredElement=s.id,this.hasSquigglerRefOrIsCSSHighlightSquiggle(s)&&this.showTooltipAt(s.squiggleKind,null===(n=s.squiggleRef)||void 0===n?void 0:n.current,s.critique,"keyboard")),t=s,this.caretPosition={node:e.focusNode,offset:e.focusOffset}):(this.caretHoveredElement===s.id&&(this.caretPosition=void 0,null===(r=this.critiqueCalloutHandler)||void 0===r||r.hideCallout()),a===P.line&&(o+=1),this.trivializeSquiggle(s,"caret"))}})),this.updateAriaStatus(o,t)},this.updateSelectionHighlightStateFromCoordinates=e=>{let t,o=0;this.forEachCritique((i=>{var n,r;for(const s of i.squiggles){if(!s.isVisible)continue;const i=W(s.data.clientRect,e.x,e.y);i===P.direct?(this.caretHoveredCritiqueId=s.critique.traceId,this.caretHoveredElement=s.id,this.hasSquigglerRefOrIsCSSHighlightSquiggle(s)&&this.showTooltipAt(s.squiggleKind,null===(n=s.squiggleRef)||void 0===n?void 0:n.current,s.critique,"keyboard",e),t=s):(i===P.line&&(o+=1),this.caretHoveredElement===s.id&&(this.caretPosition=void 0,null===(r=this.critiqueCalloutHandler)||void 0===r||r.hideCallout()),this.trivializeSquiggle(s,"caret"))}})),this.updateAriaStatus(o,t)},this.startUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=t.setTimeout((()=>{this.lastMousePosition?this.setMouseIndirectlyHoveredElement(void 0):this.clearUndoCardTimeout()}),2e3))},this.clearUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=void 0)},this.isMouseWithinUndoCallout=()=>{if(!this.undoCalloutRect||!this.lastMousePosition||!this.anchorElement)return!1;const e=(e,t,o)=>e>=t&&e<=t+o;return e(this.lastMousePosition.x,this.undoCalloutRect.x,this.undoCalloutRect.width)&&e(this.lastMousePosition.y,this.undoCalloutRect.y,this.undoCalloutRect.height)},this.calculateSquiggleClientRectInGlobalCoordinates=e=>{if(!this.anchorElement)return;const t=e.data.clientRect,o=this.anchorElement.getBoundingClientRect();return{left:t.left+o.left,top:t.top+o.top,right:t.right+o.left,bottom:t.bottom+o.top,width:t.width,height:t.height}},this.getCritiqueAtPosition=e=>{if(this.anchorElement)for(const t of this.squigglesMap){const o=t[1];for(const t of o){const o=t[1];for(const t of o){if(!t.isVisible)continue;const o=this.calculateSquiggleClientRectInGlobalCoordinates(t);if(o&&W(o,e.x,e.y)===P.direct)return t.critique}}}},this.getCritiqueAtSelection=e=>{if(!this.anchorElement||e.rangeCount<1)return;const t=e.getRangeAt(0);for(const e of this.squigglesMap){const o=e[1];for(const e of o){const o=e[1];for(const e of o){if(!e.isVisible)continue;const o=this.calculateSquiggleClientRectInGlobalCoordinates(e);if(!o)continue;const i=t.getBoundingClientRect();if(i.top>=o.top&&i.left>=o.left&&i.bottom<=o.bottom&&i.right<=o.right)return e.critique}}}},this.updateCursorHighlightState=()=>{var e;if(this.lastMousePosition&&this.anchorElement)if(null===(e=this.options)||void 0===e?void 0:e.enableCursorIntersectionObserver){const e=new IntersectionObserver((t=>{(0,A.runInAction)((()=>{this.updateCursorHighlightStateWithAnchorBoundingBox(t[0].boundingClientRect),e.disconnect()}))}));e.observe(this.anchorElement)}else{const e=this.anchorElement.getBoundingClientRect();this.updateCursorHighlightStateWithAnchorBoundingBox(e)}},this.updateCursorHighlightStateWithAnchorBoundingBox=e=>{if(!this.lastMousePosition)return;const{x:t,y:o}=this.lastMousePosition;let i,n=0;this.forEachCritique((r=>{var s,a,l,c;for(const u of r.squiggles){if(!u.isVisible||!this.anchorElement)continue;const r=this.mouseIndirectlyHoveredElement===u.id?null===(s=this.undoCalloutRect)||void 0===s?void 0:s.width:void 0;let d=W({left:u.data.clientRect.left+e.left,top:u.data.clientRect.top+e.top,right:u.data.clientRect.right+e.left,bottom:u.data.clientRect.bottom+e.top,width:u.data.clientRect.width,height:u.data.clientRect.height},t,o,r);const h=(0,$.kI)(u.squiggleKind);if(this.ariaLineNavUpdatesEnabled||d!==P.line||(d=P.none),h)if(this.mouseIndirectlyHoveredElement===u.id)if(d===P.indirect){if(void 0!==this.indirectTimer)continue;this.startUndoCardTimeout()}else this.setMouseIndirectlyHoveredElement(void 0),this.clearUndoCardTimeout();else(null===(a=this.options)||void 0===a?void 0:a.disableOpenAutoCorrectCalloutOnHover)||this.calloutOpenedForCritique!==u.critique.traceId||d!==P.none||this.isMouseWithinUndoCallout()||(null===(l=this.critiqueCalloutHandler)||void 0===l||l.hideCallout(),this.undoCalloutRect=void 0);if(d===P.direct)return i=u,this.mouseHoveredCritiqueId=u.critique.traceId,this.mouseHoveredElement=u.id,this.isUndoCalloutAlignedRight&&this.setMouseIndirectlyHoveredElement(u.id),void(u.squiggleKind===$.Ah.critique&&this.hasSquigglerRefOrIsCSSHighlightSquiggle(u)&&this.showTooltipAt(u.squiggleKind,null===(c=u.squiggleRef)||void 0===c?void 0:c.current,u.critique,"mouse"));d===P.line&&(n+=1),this.trivializeSquiggle(u,"cursor")}})),this.updateAriaStatus(n,i),i||this.trivializeCursorSquiggle()},this.trivializeAllSquiggles=e=>{"caret"===e?this.trivializeCaretSquiggle():this.trivializeCursorSquiggle()},this.trivializeSquiggle=(e,t,o=!1)=>{"caret"===t?this.trivializeSquiggleCaretHover(e.critique.traceId):this.mouseHoveredCritiqueId!==e.critique.traceId||o&&(0,$.kI)(e.squiggleKind)||(this.trivializeCursorSquiggle(),this.trivializeDisabledCritiqueIdToShowTooltip())},this.trivializeSquiggleCaretHover=e=>{this.caretHoveredCritiqueId===e&&this.trivializeCaretSquiggle()},this.trivializeDisabledCritiqueIdToShowTooltip=()=>{this.disabledCritiqueIdToShowTooltip=void 0},this.trivializeCursorSquiggle=()=>{this.mouseHoveredCritiqueId=void 0,this.mouseHoveredElement=void 0},this.trivializeCaretSquiggle=()=>{this.caretHoveredCritiqueId=void 0,this.caretHoveredElement=void 0},this.flagShowFeedback=(e,t)=>{var o,i,n,r;this.proofedElements.find((t=>t.element===e))&&((null==t?void 0:t.typeId)===N.L9.CIQFlag_Topic?(0,q.z)((0,se.S)({topicIds:(null===(o=t.suggestionItems)||void 0===o?void 0:o.map((e=>e.entities.map((e=>e.TopicId)))).join(","))||"",topicNames:(null===(i=t.suggestionItems)||void 0===i?void 0:i.map((e=>e.entities.map((e=>e.DisplayName)))).join(","))||"",highlightedText:t.textInContext||"",hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),requestId:t.nodeId,source:"EditorFlag",traceId:t.traceId||""})):this.publishEvent("feedbackIconClicked",{suggestionText:null!==(n=null==t?void 0:t.textInContext)&&void 0!==n?n:"",mode:null!==(r=null==t?void 0:t.typeId)&&void 0!==r?r:""}))},this.scaleTransform=e=>{this.scaleTransformValue=e,this.innerUpdateSquiggles()},this.updateAriaStatus=(e,t)=>{t&&this.isAriaFeatureEnabled(J.j.highlight)?this.isAriaFeatureEnabled(J.j.highlight)?this.publishEvent("ariaStatusUpdated",{eventKind:"status",statusText:this.getAriaStatusString(t),severity:"assertive",preserve:!1,id:void 0,messageKind:t.squiggleKind===$.Ah.critique?h.Jx.KeepOriginal:h.Jx.AutoCorrectHover}):this.publishEvent("ariaStatusUpdated",{eventKind:"status",statusText:"",severity:"assertive",preserve:!1,id:void 0}):this.ariaLineNavUpdatesEnabled&&this.publishEvent("ariaStatusUpdated",{eventKind:"lineNav",issuesCount:e,severity:"polite",preserve:!1})},this.updateRangesImmediately=async e=>{var t,o,i,n,r,s,a;if(!this.isVisible)return;const l=new Set(this.squigglesMap.keys()),c=!!(null===(t=this.options)||void 0===t?void 0:t.autoCorrectionEnabled)&&!!this.autoCorrectionCache;let u=!1;const d=new Map;for(const t of this.proofedElements){if(e&&!e.includes(t.id)){l.delete(t.id);continue}const h=[],g=this.squigglesMap.has(t.id),p=null!==(o=this.squigglesMap.get(t.id))&&void 0!==o?o:new A.ObservableMap,f=new Set(p.keys());for(const e of t.critiques)e.traceId&&f.delete(e.traceId),h.push(e);const m=await this.critiqueRangeBuilder.getCritiqueRanges(h,t.element);let v=[];if(h.length>0){const e=this.determineValidSquiggles(m);v=e.validRanges;for(const t of e.critiquesInInvalidRanges)f.add(t)}if(f.size>0&&this.removeCritiquesFromCache(f,p),v.length>0){this.hadUpdateWithoutAnyValidSquiggles=!1;const e=await this.buildSquigglesForCritiques(t.element,v,p,c),o=[];if(this.autoCorrectionBroker){for(let l=e.length-1;l>=0;l-=1){const c=e[l];if(!(null===(i=this.autoCorrectionCache)||void 0===i?void 0:i.process(c.critique.traceId)))continue;const u=null!==(n=c.critique.nodeId)&&void 0!==n?n:null===(r=c.critique.tileId)||void 0===r?void 0:r.nodeId,d=u?this.proofingDom.findNode(u):null;if(!d){null===(s=this.logger)||void 0===s||s.error(508146701,"Unable to find node while applying autocorrection");continue}this.autoCorrectionBroker.setIsApplyingAutoCorrection(c.critique);const h=await this.tileContent.autoCorrect(d,t.element,c.critique.start,c.critique.length,c.suggestion.text,c.range,null===(a=this.options)||void 0===a?void 0:a.autoCorrectionInputCacheEnabled);if(h){o.push({replacedText:h,critique:c.critique});const e=(0,oe.dP)(c.suggestion);this.publishEvent("autoCorrectionTriggered",{critique:c.critique,isPersonalized:e})}else this.autoCorrectionBroker.convertToNormalSquiggle(c.critique)}let l=0;for(let e=o.length-1;e>=0;e-=1)l+=this.autoCorrectionBroker.setIsFinishedApplyingAutoCorrection(o[e].critique,l),u=!0}}else this.hadUpdateWithoutAnyValidSquiggles=h.length>0;g||d.set(t.id,p),l.delete(t.id)}l.size>0&&this.removeMissingElements(l),this.updatePosition(this.isRelativePositionEnabled),d.size>0&&this.squigglesMap.merge(d),u&&await this.updateRangesImmediately(e)},this.getValidCritiques=async e=>{const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.critiques,e.element);return this.determineValidSquiggles(t).validRanges.map((e=>e.critique))},this.removeCritiquesFromCache=(e,t)=>{var o;for(const i of e.keys())t.delete(i),this.calloutOpenedForCritique===i&&(null===(o=this.critiqueCalloutHandler)||void 0===o||o.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.mouseHoveredCritiqueId!==i&&this.caretHoveredCritiqueId!==i||(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle())},this.removeMissingElements=e=>{var t;for(const o of e){const e=this.squigglesMap.get(o);if(e)for(const o of e.values())for(const e of o)null===(t=this._visibilityTracker)||void 0===t||t.unTrackSquiggle(e.data.range.startContainer);this.squigglesMap.delete(o)}},this.buildSquigglesForCritiques=async(e,t,o,i,n=$.Ah.critique)=>{var r,s,a,l,c,u;const d=[];if(this.anchorElement){const h=this.anchorElement.getBoundingClientRect(),g=null===(r=this.anchorElement.ownerDocument.activeElement)||void 0===r?void 0:r.contains(e),p=null===(s=this.targetWindowRef)||void 0===s?void 0:s.deref(),f=p&&(null===(a=this.hostElement)||void 0===a?void 0:a.getForbiddenRects(p)),m=(e,t)=>{var o;return null===(o=this.hostElement)||void 0===o?void 0:o.transformSquiggleRects(e,t,f)},v=[];for(const r of t){if(!r.range||!r.critique.traceId)continue;const t=o.get(r.critique.traceId);let s=null!==(l=null==t?void 0:t[0].squiggleKind)&&void 0!==l?l:n;if(i&&!t&&g){const e=(0,oe.MG)(r.critique);if(e){const t=r.critique;if(this.autoCorrectionBroker&&!this.autoCorrectionBroker.getHasAutoCorrectionBeenConvertedToNormalSquiggle(t))if(this.autoCorrectionBroker.getHasAutoCorrectionBeenApplied(t))s=(null===(u=this.options)||void 0===u?void 0:u.personalizedAutoCorrectionEnabled)&&(0,oe.dP)(e)?$.Ah.personalizedAutocorrection:$.Ah.autocorrection;else{if(this.enableAutoCorrectionForLanguages(e.languages)&&await(null===(c=this._visibilityTracker)||void 0===c?void 0:c.checkImmediateVisibility(r.range.startContainer))&&this.isAutoCorrectApplicable(r.range)){d.push({critique:t,suggestion:e,range:r.range});continue}this.autoCorrectionBroker.convertToNormalSquiggle(t)}}}this.createOrUpdateSquiggleStates(r.critique,r.range,e,o,s,h,t,m).shouldAnnounce&&v.push({critique:r.critique,squiggleKind:s})}v.length&&this.setAriaStatuses(v)}return d},this.isAutoCorrectApplicable=e=>{var t;const o=null===(t=this.targetWindowRef)||void 0===t?void 0:t.deref();if(!o)return!1;const i=o.document.getSelection();if(!(null==i?void 0:i.focusNode)||!i.isCollapsed)return!1;const n=e.comparePoint(i.focusNode,i.focusOffset);if(0===n)return!1;const r=o.document.createRange();return 1===n?(r.setStart(e.endContainer,e.endOffset),r.setEnd(i.focusNode,i.focusOffset)):(r.setStart(i.focusNode,i.focusOffset),r.setEnd(e.startContainer,e.startOffset)),r.toString().length<=$.tB},this.createOrUpdateSquiggleStates=(e,t,o,i,n,r,s,a)=>e.traceId&&this.anchorElement&&this.hostElement?this.updateSquiggle(s,t,e,o,n,r,a,i,e.traceId):{shouldAnnounce:!1},this.setAriaStatuses=e=>{const t=e.map((e=>{if(!this.isAriaFeatureEnabled(J.j.appearance))return;const{critique:t,squiggleKind:o}=e,i=t.textInContext;if(!i)return;const n=o===$.Ah.critique?`${t.categoryTitle} ${i}`:i,r=o===$.Ah.critique?h.Jx.KeepOriginal:h.Jx.AutoCorrectAppearance;return{text:n,id:t.traceId,messageKind:r}}));this.publishEvent("ariaStatusUpdated",{eventKind:"statusList",statuses:t.filter((e=>!!e)),severity:"assertive"})},this.findSquiggle=e=>{let t;for(const o of this.squigglesMap.values()){const i=o.get(e);if(null==i?void 0:i.length){t=i[0];break}}return t},this.onShowCallout=(e,t,o,i,n,r,s,a,l)=>{var c,u,d,h,g;if(!this.isVisible)return;if(this.calloutOpenedForCritique===t.traceId)return;this.calloutOpenedForCritique&&this.onCalloutClosed(n,!1,this.calloutOpenedForCritique),this.closeTooltip(),this.setCalloutOpenedForCritique(t.traceId);const p=this.proofedElements.find((e=>e.element===r));let f=null===(c=null==p?void 0:p.graphNode)||void 0===c?void 0:c.element;if(!f&&t.nodeId){const e=this.proofingDom.findNode(t.nodeId);(0,ie.l)(e)?f=e.parent.element:e&&(f=e.element)}if(!f)return void(null===(u=this.logger)||void 0===u||u.error(508146700,"Unable to find graph node while showing callout"));const m=null!=e?e:a;if(!m)return void(null===(d=this.logger)||void 0===d||d.error(507562183,"Unable to find target location while showing callout"));const v=e&&(0,j.C)(e,"HTMLElement")?e.ownerDocument:null===(h=this.anchorElement)||void 0===h?void 0:h.ownerDocument;null===(g=this.critiqueCalloutHandler)||void 0===g||g.showCallout({critique:t,issueText:o,setInitialFocus:i,target:m,gapSpace:l,targetDocumentRef:v&&new L.O(v),squiggleKind:s,onDismiss:e=>{this.onCalloutClosed(n,e,t.traceId)},onApplySuggestion:async(e,t)=>{var o,i;this.caretPosition=void 0,await this.critiqueApplicationHandler.applyCritiqueSuggestion(f,r,null!==(o=e.nodeId)&&void 0!==o?o:null==p?void 0:p.id,e,t,(null===(i=this.options)||void 0===i?void 0:i.disableRangeWhenApplyingCritiqueSuggestions)?void 0:a,s)},onApplyFlag:async(e,t,o)=>{await this.critiqueApplicationHandler.applyFlagSuggestion(f,r,e.nodeId,e,t,o)},onIgnoreOnce:e=>{var t,o,i;this.critiqueApplicationHandler.ignoreCritiqueOnce(f,r,null!==(i=null!==(t=e.nodeId)&&void 0!==t?t:null===(o=e.tileId)||void 0===o?void 0:o.nodeId)&&void 0!==i?i:null==p?void 0:p.id,e)},onIgnoreAll:e=>{var t;this.critiqueApplicationHandler.ignoreAllOfCritique(f,r,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onFlagIgnoreOnce:e=>{this.critiqueApplicationHandler.ignoreFlagOnce(f,r,e.nodeId,e)},onFlagIgnoreAll:e=>{this.critiqueApplicationHandler.ignoreAllOfFlag(f,r,e)},onDisableFlag:e=>{this.critiqueApplicationHandler.disableFlagType(f,r,e.nodeId,e)},onShowFeedback:e=>{this.flagShowFeedback(r,e)},onDisableCritiqueType:async e=>{var t;await this.critiqueApplicationHandler.disableCritiqueType(f,r,null!==(t=e.nodeId)&&void 0!==t?t:null==p?void 0:p.id,e)},onCalloutPositionUpdated:this.onCalloutPositionUpdated})},this.setCalloutOpenedForCritique=e=>{this.calloutOpenedForCritique=e},this.setMouseIndirectlyHoveredElement=e=>{this.mouseIndirectlyHoveredElement=e},this.innerUpdateSquiggles=async()=>{const e=[];if(this.forEachCritique((t=>{if(t.squiggles.length)for(const o of t.squiggles)o.data.isRangeInValidState()||e.push(o)})),e.length){const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.map((e=>e.critique)));if(t.length===e.length)for(let o=0;o<e.length;o++)e[o].data.updateRange(t[o].range)}this.innerUpdateSquigglesWithValidRanges()},this.innerUpdateSquigglesWithValidRanges=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();if(!(this.isVisible&&this.anchorElement&&t&&this.hostElement))return;const o=this.anchorElement.getBoundingClientRect(),i=this.hostElement.getForbiddenRects(t),n=(e,t)=>{var o;return null===(o=this.hostElement)||void 0===o?void 0:o.transformSquiggleRects(e,t,i)},r=[];(0,A.transaction)((()=>{this.forEachCritique((e=>{if(!e.squiggles.length)return;const t=e.squiggles[0];this.updateSquiggle(e.squiggles,t.data.range,t.critique,t.element,t.squiggleKind,o,n,e.elementCritiques,e.key).shouldAnnounce&&r.push(t)}))})),r.length&&this.setAriaStatuses(r)},this.updateSquiggle=(e,t,o,i,n,r,s,a,l)=>{var c,u,d,h,g,p;let f=!0;e?f=null===(d=null===(u=this._visibilityTracker)||void 0===u?void 0:u.isSquiggleVisible(t.startContainer))||void 0===d||d:null===(c=this._visibilityTracker)||void 0===c||c.trackSquiggle(t.startContainer);let m=!1;if(f&&this.anchorElement){const c=function(e,t,o,i=1){const n=o,r=t(function(e){if(e.startContainer===e.endContainer)return Array.from(e.getClientRects());const t=e.startContainer.ownerDocument||document,o=t.createNodeIterator(e.commonAncestorContainer,NodeFilter.SHOW_ALL),i=[];for(;o.nextNode()&&(0===i.length&&o.referenceNode!==e.startContainer||(i.push(o.referenceNode),o.referenceNode!==e.endContainer)););const n=[],r=t.createRange();for(const t of i)t.nodeType===t.TEXT_NODE&&(r.selectNode(t),t===e.startContainer?r.setStart(t,e.startOffset):t===e.endContainer&&r.setEnd(t,e.endOffset),n.push(...Array.from(r.getClientRects())));let s=!0;for(const e of n)if(e.top!==n[0].top||e.height!==n[0].height){s=!1;break}return s&&n.length>0?[n.reduce(((e,t)=>new DOMRect(Math.min(e.left,t.left),e.top,Math.max(e.right,t.right)-Math.min(e.left,t.left),e.height)))]:n}(e),e),s=[];if(r)for(const e of r){const t=(n.right-n.left)/i,o=e.left-n.left,r=Math.min(e.right-n.left,t),a={top:e.top-n.top,left:o,bottom:e.bottom-n.top,right:r,width:r-o,height:e.height,visible:!X(e,n)};s.push(a)}return s}(t,s,r,this.scaleTransformValue);if(e&&c.length===e.length)for(let i=0;i<c.length;i+=1){const n=this.adjustVerticalPosition(c[i]),r=e[i];n.visible===r.isVisible&&(0,Q.a)(n,r.data.clientRect)||e[i].updateFromRect(n,t),r.critique.start!==o.start&&(r.critique.start=o.start),r.stealth!==(null!==(h=r.critique.isStealth)&&void 0!==h&&h)&&(r.stealth=null!==(g=r.critique.isStealth)&&void 0!==g&&g)}else{const r=[];for(const e of c){const s=new D((0,te.h)(),i,n,o,e.visible,null!==(p=o.isStealth)&&void 0!==p&&p,new M(t,this.adjustVerticalPosition(e),this.zIndex),B.createRef());r.push(s)}r.length>0&&(e||(m=!0),a.set(l,r))}}else if(e)for(const t of e)t.isVisible&&(t.isVisible=!1);return{shouldAnnounce:m}},this.adjustVerticalPosition=e=>{var t;return void 0!==(null===(t=this.options)||void 0===t?void 0:t.squiggleVerticalAdjustment)&&(e.bottom+=this.options.squiggleVerticalAdjustment,e.height+=this.options.squiggleVerticalAdjustment),e},this.forEachCritique=e=>{this.forEachCritiqueInCache(this.squigglesMap,e)},this.forEachCritiqueInCache=(e,t)=>{const o=new Map;for(const i of e){const e=i[0],n=i[1],r=[];for(const o of n){const i=o[0],s=o[1];s.length>0&&r.push(s[0].critique),t({squiggles:s,key:i,elementCritiques:n,elementId:e})}o.set(e,r)}return o},this.showTooltipAt=(e,t,o,i,n)=>{var r,s,a,l,c,u;if(!(null===(r=this.options)||void 0===r?void 0:r.tooltipEnabled)||(null===(s=this.upsellStore)||void 0===s?void 0:s.isSquiggleBeingPreviewed(o)))return;if(this.calloutOpenedForCritique||(null===(a=this.editorSettingsState)||void 0===a?void 0:a.currentlyOpen))return void this.closeTooltip();const d=(null==t?void 0:t.ownerDocument)||(null===(l=this.anchorElement)||void 0===l?void 0:l.ownerDocument)||document;let h;if("keyboard"===i)if(n)h=this.getTooltipCoordinatesFromLocalPosition(n);else{const e=d.getSelection();if(!(e&&e.rangeCount>0))return;{const t=e.getRangeAt(0);let o;o=t.collapsed&&t.getClientRects().length?t.getClientRects()[0]:t.getBoundingClientRect(),h={x:o.left,y:o.bottom}}}else{if(this.mouseHoveredCritiqueId===this.disabledCritiqueIdToShowTooltip)return;if(!this.lastMousePosition)return;if(this.options.disableSquiggleTooltipOnTextSelection){const e=d.getSelection();if(e&&0!==e.toString().length)return}h=this.getTooltipCoordinatesFromGlobalPoint(this.lastMousePosition)}this.clearTooltipTimeout();const g=(0,ne.m)(d.activeElement);this.tooltipTimeout=null===(u=null===(c=this.targetWindowRef)||void 0===c?void 0:c.deref())||void 0===u?void 0:u.setTimeout((()=>{var n;if("keyboard"===i){const e=(0,ne.m)(d.activeElement);if(g!==e)return}this.isTooltipShown=!0,null===(n=this.tooltipHandler)||void 0===n||n.showTooltip({squiggleKind:e,critique:o,position:h,origin:null!=t?t:void 0,isAbsolute:void 0,targetDocument:d})}),1e3)},this.getTooltipCoordinatesFromGlobalPoint=e=>({x:e.x+6,y:e.y+16}),this.getTooltipCoordinatesFromLocalPosition=e=>{var t,o,i;const n=null===(t=this.anchorElement)||void 0===t?void 0:t.getBoundingClientRect();return this.getTooltipCoordinatesFromGlobalPoint({x:e.x+(null!==(o=null==n?void 0:n.left)&&void 0!==o?o:0),y:e.y+(null!==(i=null==n?void 0:n.top)&&void 0!==i?i:0)})},this.closeTooltip=(e,t)=>{var o;this.clearTooltipTimeout(),this.isTooltipShown&&(this.isTooltipShown=!1,null===(o=this.tooltipHandler)||void 0===o||o.hideTooltip()),t&&(this.disabledCritiqueIdToShowTooltip=e)},this.onSquigglerVisibilityChange=e=>{this.setVisible(e)},this.onSquigglesVisibilityChange=()=>{this.updateSquiggles()},this.submitTelemetryEvent=e=>{this.publishEvent("telemetryLogEvent",e)},this.isAriaFeatureEnabled=e=>{var t,o;const i=null!==(o=null===(t=this.options)||void 0===t?void 0:t.ariaFeatures)&&void 0!==o?o:J.j.none;return e===J.j.none?i===e:(i&e)===e},this.restoreCaretOnCalloutClose=()=>{var e,t,o,i,n;if((null===(e=this.options)||void 0===e?void 0:e.restoreCaretPosition)&&void 0!==this.caretPosition){const{node:e,offset:r}=this.caretPosition;if(void 0!==e){const s=((null===(t=this.anchorElement)||void 0===t?void 0:t.ownerDocument)||document).getSelection();if(!s||!e)return;const a=null!==(i=null===(o=e.textContent)||void 0===o?void 0:o.length)&&void 0!==i?i:0,l=Math.min(r,a);try{s.removeAllRanges(),s.setPosition(e,l)}catch(e){null===(n=this.logger)||void 0===n||n.error(539824961,"Error while restoring the IP on callout dismissed",e)}}}},this.checkSquiggleSelection=(e,t)=>{var o,i,n;if(!this.hasSquigglerRefOrIsCSSHighlightSquiggle(e)||t.rangeCount<1)return!1;const r=t.getRangeAt(0);let s;s=r.collapsed&&r.getClientRects().length?r.getClientRects()[0]:r.getBoundingClientRect();const a=null!==(n=null===(i=null===(o=e.squiggleRef)||void 0===o?void 0:o.current)||void 0===i?void 0:i.getBoundingClientRect())&&void 0!==n?n:e.data.range.getBoundingClientRect();return!(a.left>s.right||a.right<s.left||a.top>s.bottom||a.bottom<s.top)},this.onCalloutClosed=(e,t,o)=>{e(),this.calloutOpenedForCritique===o&&this.setCalloutOpenedForCritique(void 0),t?this.restoreCaretOnCalloutClose():this.caretPosition=void 0},this.getAriaStatusString=e=>{const t=e.data.range.toString();return e.squiggleKind===$.Ah.critique?`${e.critique.categoryTitle} ${t}`:t},this.closeCalloutCallback=e=>{var t;e&&this.calloutOpenedForCritique===e&&(null===(t=this.critiqueCalloutHandler)||void 0===t||t.hideCallout())},this.getSquiggleProps=e=>{var t;const o=this.anchorElement;if(!o)return[];const i=!this.isAriaFeatureEnabled(J.j.none),n=i?"none presentation":"status",r=i?"off":"assertive",s=(null===(t=this.options)||void 0===t?void 0:t.squiggleStyleType)===z.N.SVG;return e.map((e=>{var t,a,l;const{critique:c,id:u}=e,d=c.traceId===this.caretHoveredCritiqueId||c.traceId===this.mouseHoveredCritiqueId||c.traceId===this.calloutOpenedForCritique;let h=u===this.mouseHoveredElement;(0,$.kI)(e.squiggleKind)&&(h=h||u===this.mouseIndirectlyHoveredElement);const g=Object.assign(Object.assign({},e),{isHighlighted:d,isCaretOver:u===this.caretHoveredElement,isMouseOver:h,isCalloutOpened:c.traceId===this.calloutOpenedForCritique,useSvgUnderline:s,squiggleVerticalAdjustment:null===(t=this.options)||void 0===t?void 0:t.squiggleVerticalAdjustment,contextualCardTriggers:this.contextualCardTriggers.critique,disableCalloutOnDoubleClick:(null===(a=this.options)||void 0===a?void 0:a.disableCalloutOnDoubleClick)&&(null===(l=this.hostElement)||void 0===l?void 0:l.disableCalloutOnDoubleClick),role:n,ariaLive:r,ariaLabel:i?"":this.getAriaStatusString(e),describedBy:K.y,anchor:o,onCallOut:this.onShowCallout,closeCallout:this.closeCalloutCallback,showTooltip:this.showTooltipAt,closeTooltip:this.closeTooltip,submitTelemetryEvent:this.submitTelemetryEvent});return(0,$.kI)(e.squiggleKind)&&this.autoCorrectionCache?Object.assign(Object.assign({},g),{squiggleKind:e.squiggleKind,contextualCardTriggers:this.contextualCardTriggers.autoCorrection,initializationProgress:this.autoCorrectionCache.getSquiggleInitializationProgress(e.critique.traceId),setInitializationProgress:this.autoCorrectionCache.setInitializationProgress}):Object.assign(Object.assign({},g),{squiggleKind:$.Ah.critique,contextualCardTriggers:this.contextualCardTriggers.critique})}))},this.clearTooltipTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();this.tooltipTimeout&&t&&(t.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=void 0)},this.clearOnCalloutShownCallbackTimeout=()=>{var e;if(!this.onCalloutShownCallbackTimeout)return;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.onCalloutShownCallbackTimeout),this.onCalloutShownCallbackTimeout=void 0)},this.cancelSetVisibleFrame=()=>{this.setVisibleFrameRequestId&&(this.safeWindow.cancelAnimationFrame(this.setVisibleFrameRequestId),this.setVisibleFrameRequestId=void 0)},this.cancelShowCalloutFrame=()=>{this.showCalloutFrameRequestId&&(this.safeWindow.cancelAnimationFrame(this.showCalloutFrameRequestId),this.showCalloutFrameRequestId=void 0)},this.hasSquigglerRefOrIsCSSHighlightSquiggle=e=>{var t;return!!(null===(t=e.squiggleRef)||void 0===t?void 0:t.current)||!!this.hostSettings.enableCSSHighlightApiSquiggleRendering};const{anchorElement:S,anchorId:k,proofedItem:T,critiqueCalloutHandler:x,tooltipHandler:_,options:E,contextualCardTriggers:F}=e;let ee;this.contextualCardTriggers=F,this.critiqueCalloutHandler=x,this.tooltipHandler=_,this.id=k,this.options=E,this.anchorElement=S,this.proofedElements.push(T),this.targetWindowRef=new L.O((0,j.e)(this.anchorElement)),this.safeWindow=new C.c(o),this.throttleManager=new H._(null!==(g=this.targetWindowRef)&&void 0!==g?g:new L.O(window)),this.squigglerEventManager=new Y.pT,this.autoCorrectionCache=new I.Qr;const ae=()=>ee||(ee=getComputedStyle(S));this.hostElement=((e,t,o,i,n=!0)=>{var r,s,a,l,c,u,d,h,g,p,f,m;const v=o.find((t=>t.match(e))),b=null!==(r=null==v?void 0:v.shouldRender)&&void 0!==r?r:re,y=null!==(s=null==v?void 0:v.shouldRenderSquiggle)&&void 0!==s?s:re,w=null!==(a=null==v?void 0:v.shouldObserveSize)&&void 0!==a?a:()=>[],C=null!==(l=null==v?void 0:v.addHandlers)&&void 0!==l?l:()=>()=>null,S=null!==(c=null==v?void 0:v.squigglerInlineStyles)&&void 0!==c?c:()=>{},k=null!==(u=null==v?void 0:v.transformSquiggleRects)&&void 0!==u?u:e=>e,T=null!==(d=null==v?void 0:v.getForbiddenRects)&&void 0!==d?d:()=>[],x=null!==(h=null==v?void 0:v.isScrollable)&&void 0!==h?h:()=>{},_=null!==(g=null==v?void 0:v.squigglerUpdated)&&void 0!==g?g:()=>{},I=e.tagName.toLowerCase(),E="editor-shadow-element"===I?window.document.body:e.parentElement,B=null!==(p=null==v?void 0:v.getSquigglerTopOffset)&&void 0!==p?p:e=>e.getBoundingClientRect().height,A={element:null!==(f=e.parentElement)&&void 0!==f?f:window.document.body,zIndex:null!==(m=null==v?void 0:v.zIndex)&&void 0!==m?m:"auto",shouldRender:b,shouldRenderSquiggle:y,shouldObserveSize:w,addHandlers:C,squigglerInlineStyles:S,transformSquiggleRects:k,getForbiddenRects:T,isScrollable:x,squigglerUpdated:_,getTopOffset:B,disableCalloutOnDoubleClick:null==v?void 0:v.disableCalloutOnDoubleClick};if("body"===I||!E)return A;if(null==v?void 0:v.selector){const t="string"==typeof v.selector?e.closest(v.selector):v.selector(e,null==i?void 0:i.element);if(t)return A.element=t,A}return A.element=n?((e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let o=e.parentElement,i=window.getComputedStyle(o);for(;o&&"relative"!==i.position&&o!==document.body;)o=o.parentElement,i=window.getComputedStyle(o);return o})(e,t()):E,A})(S,(()=>ae().position),null!==(p=null==E?void 0:E.edgeCases)&&void 0!==p?p:[],T,!1),(null===(f=this.hostElement.element)||void 0===f?void 0:f.parentElement)===this.anchorElement&&(this.anchorElement.firstElementChild===this.hostElement.element?this.top=0:this.top=-1*this.hostElement.getTopOffset(this.anchorElement)),this.zIndex=this.hostElement.zIndex?Z(this.hostElement.zIndex.toString()):Z(ae().zIndex),this.parentToRenderTo=this.hostElement.element,this._visibilityTracker=null!==(m=null==E?void 0:E.visibilityTracker)&&void 0!==m?m:V.Y,this.isVisible=this._visibilityTracker===V.Y,this._visibilityTracker.connect({trackSquiggler:!0,trackSquiggles:null===(b=null===(v=this.options)||void 0===v?void 0:v.visibilityTrackerShouldTrackSquiggles)||void 0===b||b,anchorElement:S,onSquigglerVisibilityChange:this.onSquigglerVisibilityChange,onSquigglesVisibilityChange:this.onSquigglesVisibilityChange}),(null===(y=this.options)||void 0===y?void 0:y.mutationObserverBasedRelativePosition)&&(this.recalculateRelativePosition(),this._relativePositionMutationObserver=new MutationObserver((e=>this.recalculateRelativePosition())),this._relativePositionMutationObserver.observe(this.parentToRenderTo,{attributeFilter:["class","style"]})),(null==E?void 0:E.throttleUpdates)&&(this.throttledUpdateSquiggles=this.throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this.safeWindow,this.innerUpdateSquiggles,16,"After"),this.throttledUpdateRanges=this.throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this.safeWindow,(()=>{const e=this.throttledUpdateRangesProofedElementsToCheck;return this.throttledUpdateRangesProofedElementsToCheck=void 0,this.updateRangesImmediately(e)}),16,"After")),this.autoCorrectDisabledLanguages=null!==(w=null==E?void 0:E.autoCorrectDisabledLanguages)&&void 0!==w?w:[],(0,R.Gn)(this)}get isAutoCorrectionOnly(){let e=!1;for(const t of this.squigglesMap.values())for(const o of t.values())for(const t of o.values()){if(!(0,$.kI)(t.squiggleKind)||!this.autoCorrectionCache)return!1;e=!0}return e}get squiggles(){const e=[];return this.forEachCritique((t=>{const o=t.squiggles.filter((e=>{var t;return e.isVisible&&this.anchorElement&&(null===(t=this.hostElement)||void 0===t?void 0:t.shouldRenderSquiggle(e.data.range.startContainer,this.anchorElement))}));e.push(...o)})),e}get isRelativePositionEnabled(){return this.isRelativePositionEnabledValue?this.isRelativePositionEnabledValue:this.calculateRelativePosition()}calculateRelativePosition(){return!!this.parentToRenderTo&&"static"===(""!==this.parentToRenderTo.style.position?this.parentToRenderTo.style.position:getComputedStyle(this.parentToRenderTo).position)}get isEmpty(){return 0===this.proofedElements.length}get theme(){return this._squiggleThemeStore}get squiggleStyleType(){var e;return null===(e=this.options)||void 0===e?void 0:e.squiggleStyleType}get reactOnComponentUpdate(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.reactOnComponentUpdate)&&void 0!==t&&t}get disableAutoBrowserVirtualizationOfSquiggles(){var e,t,o;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.disableAutoBrowserVirtualizationOfSquiggles)&&void 0!==t&&t||null!==(o=this.hostSettings.enableCSSHighlightApiSquiggleRendering)&&void 0!==o&&o}get ariaEnabled(){return this.isAriaFeatureEnabled(J.j.none)}get ariaLineNavUpdatesEnabled(){return this.isAriaFeatureEnabled(J.j.lineNavigation)}get forcedHighContrast(){var e,t;return null!==(t=null===(e=this.getIsHighContrastTheme)||void 0===e?void 0:e.call(this))&&void 0!==t&&t}setSquigglerRef(e){this._squigglerElement=e}checkProofingElementsPosition(){let e=this.proofedElementDomRects.length!==this.proofedElements.length;const t=[];return this.proofedElements.forEach(((o,i)=>{const n=o.element.getBoundingClientRect();t.push(n);const r=this.proofedElementDomRects[i],s=!r||!(n.x===r.x&&n.y===r.y&&n.width===r.width&&n.height===r.height);e=e||s})),e&&(this.proofedElementDomRects=t),e}updatePosition(e){var t,o,i,n,r;if(e){if(this._squigglerElement&&this.anchorElement){if((null===(o=null===(t=this.hostElement)||void 0===t?void 0:t.element)||void 0===o?void 0:o.parentElement)===this.anchorElement&&this.anchorElement.firstElementChild===this.hostElement.element&&0===this.top&&0===this.left)return!1;let e=!1;const s=this._squigglerElement.getBoundingClientRect(),a=this.anchorElement.getBoundingClientRect(),l=a.top-s.top-this.top,c=a.left-s.left-this.left;return Math.abs(l)>(null!==(i=this.diffPrecision)&&void 0!==i?i:.01)&&(this.top+=l,e=!0),Math.abs(c)>(null!==(n=this.diffPrecision)&&void 0!==n?n:.01)&&(this.left+=c,e=!0),!e&&(null===(r=this.options)||void 0===r?void 0:r.trackProofingElementsPositionEnabled)&&(e=this.checkProofingElementsPosition()),e}}else if(this.anchorElement)if(this.anchorElement===this.parentToRenderTo)if(["body","html"].includes(this.anchorElement.nodeName.toLowerCase())){const e=function(e){const t=getComputedStyle(e),o=ee(t.marginTop);return{x:ee(t.marginLeft),y:o}}(this.anchorElement);this.left=this.anchorElement.offsetLeft+e.x,this.top=this.anchorElement.offsetTop+e.y}else this.left=0,this.top=0;else["tbody"].includes(this.anchorElement.nodeName.toLowerCase())?(this.left=0,this.top=0):(this.left=this.anchorElement.offsetLeft,this.top=this.anchorElement.offsetTop);return!1}dispose(){var e,t,o,i;this.clearUndoCardTimeout(),this.anchorElement&&(this.cancelSetVisibleFrame(),this.cancelShowCalloutFrame(),this.clearOnCalloutShownCallbackTimeout(),this.clearTooltipTimeout(),this.squigglesMap.clear(),null===(e=this._visibilityTracker)||void 0===e||e.disconnect(),this._visibilityTracker=void 0,null===(t=this._relativePositionMutationObserver)||void 0===t||t.disconnect(),this._relativePositionMutationObserver=void 0,this.proofedElements=[],this.anchorElement=void 0,this.parentToRenderTo=void 0,this.hostElement=void 0,this._squigglerElement=void 0,this.targetWindowRef=void 0,this.throttledUpdateSquiggles=void 0,this.throttledUpdateRanges=void 0,null===(o=this.throttleManager)||void 0===o||o.dispose(),(this.caretHoveredCritiqueId||this.mouseHoveredCritiqueId)&&(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle()),this.calloutOpenedForCritique&&(null===(i=this.critiqueCalloutHandler)||void 0===i||i.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.critiqueCalloutHandler=void 0,this.tooltipHandler=void 0,this.contextualCardTriggers={autoCorrection:{mouse:[],keyboard:[]},critique:{mouse:[],keyboard:[]}})}determineValidSquiggles(e){var t,o,i,n,r,s,a,l,c,u;const d=[],h=[],g=new Map;for(const p of e){if(!p.range)continue;const e=p.range.commonAncestorContainer.nodeType!==Node.TEXT_NODE&&(0,j.C)(p.range.commonAncestorContainer,"HTMLElement")?p.range.commonAncestorContainer:p.range.commonAncestorContainer.parentElement;if(!e)continue;let f=!0;const m=g.get(e);if(void 0!==m)f=m;else{("a"===e.nodeName.toLowerCase()||!0===(null===(i=null===(o=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.squigglerSettings)||void 0===o?void 0:o.checkSquigglePositionValidity)||void 0===i?void 0:i.call(o,p.critique,p.range))||(null===(r=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.squigglerSettings)||void 0===r?void 0:r.invalidSquiggleParentSelectors)&&e.closest(this.hostSettings.serviceSettings.squigglerSettings.invalidSquiggleParentSelectors.join(", ")))&&(f=!1);const d=[...null!==(l=null===(a=null===(s=this.hostSettings.serviceSettings)||void 0===s?void 0:s.squigglerSettings)||void 0===a?void 0:a.invalidSquiggleSelectors)&&void 0!==l?l:[],".ms-prediction","a"].join(", ");let h=p.range.startContainer;if((0,j.C)(h,"HTMLElement")?h.closest(d):null===(c=null==h?void 0:h.parentElement)||void 0===c?void 0:c.closest(d))f=!1;else for(;h=this.getNextNode(p.range.startContainer,!1,p.range.endContainer);){((0,j.C)(h,"HTMLElement")?h.closest(d):null===(u=null==h?void 0:h.parentElement)||void 0===u?void 0:u.closest(d))&&(f=!1);break}g.set(e,f)}f?d.push(p):p.critique.traceId&&h.push(p.critique.traceId)}return{validRanges:d,critiquesInInvalidRanges:h}}getNextNode(e,t,o){var i;if(o!==e){if(e.firstChild&&!t)return e.firstChild;if(e.parentNode)return null!==(i=e.nextSibling)&&void 0!==i?i:this.getNextNode(e.parentNode,!0,o)}}enableAutoCorrectionForLanguages(e=[]){return 0===this.autoCorrectDisabledLanguages.length||e.some((e=>!this.autoCorrectDisabledLanguages.includes(e)))}}(0,i.__decorate)([A.observable],ae.prototype,"squigglesMap",void 0),(0,i.__decorate)([A.observable],ae.prototype,"calloutOpenedForCritique",void 0),(0,i.__decorate)([A.observable],ae.prototype,"mouseHoveredElement",void 0),(0,i.__decorate)([A.observable],ae.prototype,"mouseIndirectlyHoveredElement",void 0),(0,i.__decorate)([A.observable],ae.prototype,"caretHoveredElement",void 0),(0,i.__decorate)([A.observable],ae.prototype,"scaleTransformValue",void 0),(0,i.__decorate)([A.observable],ae.prototype,"top",void 0),(0,i.__decorate)([A.observable],ae.prototype,"left",void 0),(0,i.__decorate)([A.computed],ae.prototype,"squiggles",null),(0,i.__decorate)([A.observable],ae.prototype,"isVisible",void 0),(0,i.__decorate)([A.action],ae.prototype,"removeCritiques",void 0),(0,i.__decorate)([A.action],ae.prototype,"setVisible",void 0),(0,i.__decorate)([A.action],ae.prototype,"updatePosition",null),(0,i.__decorate)([A.action],ae.prototype,"updateSelectionHighlightState",void 0),(0,i.__decorate)([A.action],ae.prototype,"updateSelectionHighlightStateFromCoordinates",void 0),(0,i.__decorate)([A.action],ae.prototype,"updateCursorHighlightState",void 0),(0,i.__decorate)([A.action],ae.prototype,"trivializeCursorSquiggle",void 0),(0,i.__decorate)([A.action],ae.prototype,"trivializeCaretSquiggle",void 0),(0,i.__decorate)([A.action],ae.prototype,"scaleTransform",void 0),(0,i.__decorate)([A.action],ae.prototype,"dispose",null),(0,i.__decorate)([A.action],ae.prototype,"updateRangesImmediately",void 0),(0,i.__decorate)([A.action],ae.prototype,"removeCritiquesFromCache",void 0),(0,i.__decorate)([A.action],ae.prototype,"removeMissingElements",void 0),(0,i.__decorate)([A.action],ae.prototype,"setCalloutOpenedForCritique",void 0),(0,i.__decorate)([A.action],ae.prototype,"setMouseIndirectlyHoveredElement",void 0),(0,i.__decorate)([A.action],ae.prototype,"innerUpdateSquigglesWithValidRanges",void 0),(0,i.__decorate)([A.action],ae.prototype,"updateSquiggle",void 0);var le=o(63837),ce=o(48828),ue=o(90424),de=o(30122),he=o(30225);const ge=(0,le.f)("SquigglerV2StateStoreOptionsToken");let pe=class{constructor(e,t,o,i,s,a,l,c,d,h,g,p,f,m,v,b,y,S,k,T,x,_,I){var E,B;this.tileContent=t,this.instrumentationProcessor=o,this._hostEmitters=i,this.hostEmitter=s,this.hostSettings=a,this.proofingDom=l,this._squiggleThemeStore=c,this.logger=d,this._tileNodeTraverser=h,this.upsellStore=g,this.editorSettingsState=f,this.feedbackStore=m,this._disableCritiqueHandler=v,this.critiqueStore=b,this.applyCritiqueSuggestionHandler=y,this.applyFlagHandler=S,this.wordDictionary=k,this.editorSettingsManager=T,this._formElementAutoCorrectionCache=x,this.autoCorrectionBroker=_,this.getIsHighContrastTheme=I,this.onFeedbackIconClicked=async e=>{var t;null===(t=this.feedbackStore)||void 0===t||t.feedbackIconClicked(e.suggestionText,e.mode)},this.onAutoCorrectionTriggered=e=>{this.hostEmitter.emit(w.pD.autoCorrectionTriggered);const t={isPersonalized:e.isPersonalized.toString()};this.instrumentationProcessor.process({critique:e.critique,eventId:15,customProperties:t})},this.onAriaStatusUpdated=e=>{if(this.ariaStatusStateStore)switch(e.eventKind){case"status":this.ariaStatusStateStore.setStatus(e.statusText,e.severity,e.preserve,e.id,e.messageKind);break;case"statusList":this.ariaStatusStateStore.addPreservedStatuses(e.statuses,e.severity);break;case"lineNav":this.ariaStatusStateStore.setLineNavStatus(e.issuesCount,e.severity,e.preserve)}},this.autoCorrectLanguagesUpdated=async e=>{this._squigglerCore.setAutoCorrectLanguages(e.message)},this.setCritiques=async(e,t=!1)=>this._squigglerCore.setCritiques(e,t),this.removeCritiques=async e=>this._squigglerCore.removeCritiques(e),this.updateRanges=async e=>this._squigglerCore.updateRanges(e),this.updateSquiggles=()=>this._squigglerCore.updateSquiggles(),this.setVisible=e=>this._squigglerCore.setVisible(e),this.setLastMousePosition=e=>{this._squigglerCore.setLastMousePosition(e)},this.disconnectVisibilityTracker=()=>{this._squigglerCore.disconnectVisibilityTracker()},this.getCritiques=()=>this._squigglerCore.getCritiques(),this.showCallout=(e,t)=>{this._squigglerCore.showCallout(e,t)},this.updateSelectionHighlightState=e=>{this._squigglerCore.updateSelectionHighlightState(e)},this.updateSelectionHighlightStateFromCoordinates=e=>{this._squigglerCore.updateSelectionHighlightStateFromCoordinates(e)},this.updateCursorHighlightState=()=>{this._squigglerCore.updateCursorHighlightState()},this.trivializeAllSquiggles=e=>{this._squigglerCore.trivializeAllSquiggles(e)},this.flagShowFeedback=(e,t)=>{this._squigglerCore.flagShowFeedback(e,t)},this.scaleTransform=e=>{this._squigglerCore.scaleTransform(e)},this.updateRangesImmediately=async e=>this._squigglerCore.updateRangesImmediately(e),this.getValidCritiques=async e=>this._squigglerCore.getValidCritiques(e),this.onShowCallout=(e,t,o,i,n,r,s,a,l)=>{this._squigglerCore.onShowCallout(e,t,o,i,n,r,s,a,l)},this.closeTooltip=(e,t)=>{this._squigglerCore.closeTooltip(e,t)},this.getSquiggleProps=e=>this._squigglerCore.getSquiggleProps(e),this.options=e.options,this.ariaStatusStateStore=(null===(E=this.options)||void 0===E?void 0:E.ariaFeatures)?p:void 0,this.critiqueRangeBuilder=new r.$(this.tileContent,this.proofingDom,this._tileNodeTraverser),this.safeWindow=new C.c(a),this.critiqueApplicationHandler=new n.n(this._hostEmitters,this.tileContent,this.critiqueRangeBuilder,this.proofingDom,this.safeWindow,this._disableCritiqueHandler,this.logger,this.critiqueStore,this.applyCritiqueSuggestionHandler,this.applyFlagHandler,this.wordDictionary,this.editorSettingsManager,this._formElementAutoCorrectionCache),this._squigglerCore=new ae(Object.assign(Object.assign({},e),{contextualCardTriggers:{critique:{keyboard:[this.hostSettings.useAlternativeSquiggleHotkey?u.KM:u.S1],mouse:[u.Kc]},autoCorrection:{keyboard:[u.tu],mouse:[!0===(null===(B=this.options)||void 0===B?void 0:B.disableOpenAutoCorrectCalloutOnHover)?u.Kc:u.Nz]}}}),this.tileContent,this.hostSettings,this.proofingDom,this._squiggleThemeStore,this.critiqueApplicationHandler,this.critiqueRangeBuilder,this.autoCorrectionBroker,this.getIsHighContrastTheme,this.logger,this.upsellStore,this.editorSettingsState),this.hostEmitter.on(w.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated),this._squigglerCore.subscribe("ariaStatusUpdated",this.onAriaStatusUpdated),this._squigglerCore.subscribe("autoCorrectionTriggered",this.onAutoCorrectionTriggered),this._squigglerCore.subscribe("feedbackIconClicked",this.onFeedbackIconClicked)}get squigglesMap(){return this._squigglerCore.squigglesMap}get proofedElements(){return this._squigglerCore.proofedElements}get calloutOpenedForCritique(){return this._squigglerCore.calloutOpenedForCritique}get mouseHoveredElement(){return this._squigglerCore.mouseHoveredElement}get mouseIndirectlyHoveredElement(){return this._squigglerCore.mouseIndirectlyHoveredElement}get mouseHoveredCritiqueId(){return this._squigglerCore.mouseHoveredCritiqueId}get disabledCritiqueIdToShowTooltip(){return this._squigglerCore.disabledCritiqueIdToShowTooltip}get id(){return this._squigglerCore.id}get caretHoveredElement(){return this._squigglerCore.caretHoveredElement}get caretHoveredCritiqueId(){return this._squigglerCore.caretHoveredCritiqueId}get scaleTransformValue(){return this._squigglerCore.scaleTransformValue}get top(){return this._squigglerCore.top}get left(){return this._squigglerCore.left}get isAutoCorrectionOnly(){return this._squigglerCore.isAutoCorrectionOnly}get squiggles(){return this._squigglerCore.squiggles}get parentToRenderTo(){return this._squigglerCore.parentToRenderTo}get hostElement(){return this._squigglerCore.hostElement}get isRelativePositionEnabled(){return this._squigglerCore.isRelativePositionEnabled}get isEmpty(){return this._squigglerCore.isEmpty}get theme(){return this._squigglerCore.theme}get isVisible(){return this._squigglerCore.isVisible}get squiggleStyleType(){return this._squigglerCore.squiggleStyleType}get reactOnComponentUpdate(){return this._squigglerCore.reactOnComponentUpdate}get disableAutoBrowserVirtualizationOfSquiggles(){return this._squigglerCore.disableAutoBrowserVirtualizationOfSquiggles}get ariaEnabled(){return this._squigglerCore.ariaEnabled}get ariaLineNavUpdatesEnabled(){return this._squigglerCore.ariaLineNavUpdatesEnabled}get forcedHighContrast(){return this._squigglerCore.forcedHighContrast}get anchorElement(){return this._squigglerCore.anchorElement}get squigglerEventManager(){return this._squigglerCore.squigglerEventManager}setSquigglerRef(e){this._squigglerCore.setSquigglerRef(e)}updatePosition(e){return this._squigglerCore.updatePosition(e)}dispose(){this._squigglerCore.unsubscribe("ariaStatusUpdated",this.onAriaStatusUpdated),this._squigglerCore.unsubscribe("autoCorrectionTriggered",this.onAutoCorrectionTriggered),this._squigglerCore.unsubscribe("feedbackIconClicked",this.onFeedbackIconClicked),this._squigglerCore.dispose(),this.hostEmitter.off(w.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated)}};pe=(0,i.__decorate)([(0,ce._)(),(0,i.__param)(0,(0,ue.W)(ge)),(0,i.__param)(1,(0,ue.W)(g.d)),(0,i.__param)(2,(0,ue.W)(S.f)),(0,i.__param)(3,(0,de.t)(w.zJ)),(0,i.__param)(4,(0,ue.W)(w.M5)),(0,i.__param)(5,(0,ue.W)(k.n)),(0,i.__param)(6,(0,ue.W)(p.w)),(0,i.__param)(7,(0,ue.W)(E.Vw)),(0,i.__param)(8,(0,he.l)()),(0,i.__param)(8,(0,ue.W)(T.g)),(0,i.__param)(9,(0,he.l)()),(0,i.__param)(9,(0,ue.W)(f.M)),(0,i.__param)(10,(0,he.l)()),(0,i.__param)(10,(0,ue.W)(m.Ey)),(0,i.__param)(11,(0,he.l)()),(0,i.__param)(11,(0,ue.W)(h.mU)),(0,i.__param)(12,(0,he.l)()),(0,i.__param)(12,(0,ue.W)(x.z)),(0,i.__param)(13,(0,he.l)()),(0,i.__param)(13,(0,ue.W)(v.M)),(0,i.__param)(14,(0,he.l)()),(0,i.__param)(14,(0,ue.W)(b.W)),(0,i.__param)(15,(0,he.l)()),(0,i.__param)(15,(0,ue.W)(s.$)),(0,i.__param)(16,(0,he.l)()),(0,i.__param)(16,(0,ue.W)(a.a)),(0,i.__param)(17,(0,he.l)()),(0,i.__param)(17,(0,ue.W)(l.K)),(0,i.__param)(18,(0,he.l)()),(0,i.__param)(18,(0,ue.W)(y.s)),(0,i.__param)(19,(0,he.l)()),(0,i.__param)(19,(0,ue.W)(_.rI)),(0,i.__param)(20,(0,he.l)()),(0,i.__param)(20,(0,ue.W)(I.PF)),(0,i.__param)(21,(0,he.l)()),(0,i.__param)(21,(0,ue.W)(c.m)),(0,i.__param)(22,(0,he.l)()),(0,i.__param)(22,(0,ue.W)(d.A))],pe)},69013:(e,t,o)=>{"use strict";if(o.d(t,{J:()=>r,Y:()=>s}),3023==o.j)var i=o(2579);if(3023==o.j)var n=o(3755);class r{constructor(){this._targetWindow=new i.O(window),this._visibleSquigglesRangeContainers=new Map,this._checkedElements=new Map,this._isAnchorElementVisible=!0,this.connect=e=>{var t;this._targetWindow=new i.O((0,n.e)(e.anchorElement)),(null===(t=this._targetWindow.deref())||void 0===t?void 0:t.IntersectionObserver)&&(this.initSquigglerObserver(e.trackSquiggler,e.anchorElement,e.onSquigglerVisibilityChange),this.initSquigglesObserver(e.trackSquiggles,e.onSquigglesVisibilityChange))},this.disconnect=()=>{this._squigglesVisibilityObserver&&this._squigglesVisibilityObserver.disconnect(),this._squigglerVisibilityObserver&&this._squigglerVisibilityObserver.disconnect(),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.disconnect()},this.trackSquiggle=e=>{var t;let o;if(!this._squigglesVisibilityObserver||!(o=this.getElementFromRange(e)))return;const i=null!==(t=this._visibleSquigglesRangeContainers.get(o))&&void 0!==t?t:{visible:void 0,handles:0};i.handles=i.handles+1,this._visibleSquigglesRangeContainers.set(o,i),this._squigglesVisibilityObserver.observe(o)},this.unTrackSquiggle=e=>{var t;let o;if(!this._squigglesVisibilityObserver||!(o=this.getElementFromRange(e)))return;const i=null!==(t=this._visibleSquigglesRangeContainers.get(o))&&void 0!==t?t:{visible:!1,handles:0};i.handles=i.handles-1,this._visibleSquigglesRangeContainers.set(o,i),i.handles<=0&&this.untrackElement(o)},this.isSquiggleVisible=e=>{const t=this.getElementFromRange(e);if(!t)return;if(!this._visibleSquigglesRangeContainers.has(t))return void this.trackSquiggle(e);const o=this._visibleSquigglesRangeContainers.get(t);return null==o?void 0:o.visible},this.checkImmediateVisibility=async e=>{const t=this.getElementFromRange(e);if(!t)return!1;const o=await this.asyncCheckVisibility(t);return this._checkedElements.delete(t),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.unobserve(t),o},this.asyncCheckVisibility=async e=>new Promise((t=>this.checkVisibility(e,t))),this.asyncVisibilityCallback=e=>{for(const t of e){const e=this._checkedElements.get(t.target);e&&e(t.isIntersecting)}},this.checkVisibility=(e,t)=>{if(!this._asyncVisibilityObserver){const e=this._targetWindow.deref();if(!e)return;this._asyncVisibilityObserver=new e.IntersectionObserver(this.asyncVisibilityCallback,{rootMargin:"0px",threshold:[0,1]})}this._checkedElements.set(e,t),this._asyncVisibilityObserver.observe(e)},this.untrackElement=e=>{var t;null===(t=this._squigglesVisibilityObserver)||void 0===t||t.unobserve(e),this._visibleSquigglesRangeContainers.delete(e)},this.initSquigglerObserver=(e,t,o)=>{if(!e)return;const i=this._targetWindow.deref();i&&(this._squigglerVisibilityObserver=new i.IntersectionObserver((e=>{o(this.getSquigglerIsVisible(e))}),{rootMargin:"0px",threshold:[0,1]}),this._squigglerVisibilityObserver.observe(t))},this.initSquigglesObserver=(e,t)=>{if(!e)return;const o=this._targetWindow.deref();o&&(this._squigglesVisibilityObserver=new o.IntersectionObserver((e=>{t(this.getVisibleSquigglesRangeContainers(e))}),{rootMargin:"0px",threshold:[0,1]}))},this.getVisibleSquigglesRangeContainers=e=>{var t;let o=!1;for(const i of e.values())if(i.target.isConnected){const e=null!==(t=this._visibleSquigglesRangeContainers.get(i.target))&&void 0!==t?t:{visible:!1,handles:1};e.visible=i.isIntersecting,this._visibleSquigglesRangeContainers.set(i.target,e)}else o=!0;return o&&this.removeZombies(),e},this.removeZombies=()=>{for(const e of this._visibleSquigglesRangeContainers.keys())e.isConnected&&this.untrackElement(e)},this.getSquigglerIsVisible=e=>(this._isAnchorElementVisible=e[e.length-1].isIntersecting,this._isAnchorElementVisible),this.getElementFromRange=e=>1===e.nodeType?e:e.parentElement}}const s={connect:()=>null,disconnect:()=>null,isSquiggleVisible:()=>!0,trackSquiggle:()=>null,unTrackSquiggle:()=>null,checkImmediateVisibility:async()=>!0}},54110:(e,t,o)=>{"use strict";var i;o.d(t,{j:()=>i}),function(e){e[e.none=0]="none",e[e.appearance=1]="appearance",e[e.highlight=2]="highlight",e[e.lineNavigation=4]="lineNavigation",e[e.cssHighlightsAPIAnnouncement=8]="cssHighlightsAPIAnnouncement"}(i||(i={}))},33044:(e,t,o)=>{"use strict";o.d(t,{f:()=>n,u:()=>r});var i=o(63837);const n=(0,i.f)("ISquigglerStateStoreFactory"),r=(0,i.f)("ContentEditableSquigglerComponent")},23210:(e,t,o)=>{"use strict";o.d(t,{_:()=>i});const i=(0,o(63837).f)("ISquigglePositioningEdgeCases")},32673:(e,t,o)=>{"use strict";o.d(t,{Vw:()=>i,pz:()=>n});const i=(0,o(63837).f)("ISquiggleThemeStore"),n={highPriorityColors:{tile:"#EB0000",highlight:"#FF30001A"},mediumPriorityColors:{tile:"#3355FF",highlight:"#0055CC1A"},lowPriorityColors:{tile:"#7160E8",highlight:"#7160E833"},autoCorrectColors:{tile:"#38BA62",highlight:"#5BC55240"},ciqFlagColors:{tile:"#0F6CBD",highlight:"#0F6CBD1A"},headingDetectionColors:{tile:"#D27A36",highlight:"#D27A3627"}};n.autoCorrectColors.tile,n.ciqFlagColors.tile,n.headingDetectionColors.tile,n.mediumPriorityColors.tile,n.highPriorityColors.tile,n.lowPriorityColors.tile},61653:(e,t,o)=>{"use strict";o.d(t,{$K:()=>r,iV:()=>n});var i=o(63837);(0,i.f)("InputControlsV2ProxyOptionsToken");const n=(0,i.f)("IInputControlsStateStoreFactory"),r=(0,i.f)("InputControlsSquigglerComponent")},15209:(e,t,o)=>{"use strict";if(o.d(t,{G:()=>s}),3023==o.j)var i=o(23094);if(3023==o.j)var n=o(79704);var r=o(95734);const s=e=>{const t=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1);r.useEffect((()=>{const t=new i.J(e.anchor);return t.addListener("click",(()=>{var t;e.isMouseOver&&!e.isCalloutOpened&&(null===(t=e.onClick)||void 0===t||t.call(e))})),()=>{t.removeAllListeners()}}),[e.isCalloutOpened,e.critique,e.isMouseOver,e.anchor,e.onClick]);const o=o=>{var i,n,r;const s=o;e.isCaretOver&&(null===(i=e.openCalloutPredicate)||void 0===i?void 0:i.call(e,s))&&!e.isCalloutOpened?(t(o),"keyup"===s.type&&(null===(n=e.onKeyboardEvent)||void 0===n||n.call(e))):"Escape"===s.key&&"keyup"===s.type&&(null===(r=e.onEscapePress)||void 0===r||r.call(e))};return r.useEffect((()=>{if(e.isCaretOver||e.isMouseOver){const n=new i.J(e.anchor);return n.addListener("keyup",o),n.addListener("focus",t),n.addListener("blur",t),n.addListener("keydown",o),()=>{n.removeAllListeners()}}}),[e.isCaretOver,e.isMouseOver,e.isCalloutOpened,e.critique,e.anchor,e.openCalloutPredicate,e.onKeyboardEvent,e.onEscapePress]),r.createElement("span",{ref:e.squiggleRef,id:e.id,role:e.role,className:e.className,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,style:{opacity:e.opacity}},r.createElement("span",{"aria-hidden":"true"},e.data.text),e.useSvgUnderline&&r.createElement(n.a,{width:"100%",left:0,patternName:e.patternName,styleOverrides:{opacity:e.opacity}}))}},38203:(e,t,o)=>{"use strict";o.d(t,{U:()=>g});var i=o(30206);const n=(0,o(63837).f)("ISquiggleThemeFactory");var r=o(46546),s=o(92037),a=o(32673),l=o(15885),c=o(48828),u=o(30225),d=o(90424);const h=e=>`url("data:image/svg+xml,${encodeURIComponent(e.trim())}")`;let g=class{constructor(e,t){this.getIsHighContrastTheme=t,this._grammarTile="",this._grammarTileBorder="",this._insightTile="",this._insightTileBorder="",this._spellingTile="",this._spellingTileBorder="",this._autoCorrectTile="",this._autoCorrectBorder="",this._ciqFlagTile="",this._ciqFlagBorder="",this._headingDetectionTile="",this._headingDetectionBorder="",this.setSquiggleTheme=e=>{this._theme={highPriorityColors:e.highPriorityColors||this._theme.highPriorityColors,mediumPriorityColors:e.mediumPriorityColors||this._theme.mediumPriorityColors,lowPriorityColors:e.lowPriorityColors||this._theme.lowPriorityColors,autoCorrectColors:e.autoCorrectColors||this._theme.autoCorrectColors,ciqFlagColors:e.ciqFlagColors||this._theme.ciqFlagColors,headingDetectionColors:e.headingDetectionColors||this._theme.headingDetectionColors},this.setGrammarTiles(this._theme),this.setInsightTiles(this._theme),this.setSpellingTiles(this._theme),this.setAutoCorrectTiles(this._theme),this.setCiqFlagTiles(this._theme),this.setHeadingDetectionTiles(this._theme)},this.setGrammarTiles=e=>{this._grammarTile=h(`\n      <svg width="5px" height="3px" viewBox="0 0 5 3" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>grammar_double_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="grammar_double_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n            <path d="M0,2.5 L5,2.5" id="Line-2-Copy-11"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._grammarTileBorder=h(`\n    <svg width="15px" height="9px" viewBox="0 0 15 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n      <title>grammar_double_line</title>\n      <desc>Created with Sketch.</desc>\n      <g id="grammar_double_line" stroke="none" stroke-width="3" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n        <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n          <path d="M0,1.5 L15,1.5" id="Line-2-Copy-10"></path>\n          <path d="M0,7.5 L15,7.5" id="Line-2-Copy-11"></path>\n        </g>\n      </g>\n    </svg>\n  `)},this.setInsightTiles=e=>{this._insightTile=h(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._insightTileBorder=h(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this.setSpellingTiles=e=>{this._spellingTile=h(`\n      <svg width="5px" height="4px" viewBox="0 0 5 4" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="1"></path>\n              <rect id="Rectangle" x="0" y="0" width="5" height="4"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `),this._spellingTileBorder=h(`\n      <svg width="17px" height="9px" viewBox="0 0 17 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M 0,7.5 H 1 C 4.75,7.5 4.75,1.5 8.5,1.5 12.25,1.5 12.25,7.5 16,7.5 H 17" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="3"></path>\n              <rect id="Rectangle" x="0" y="0" width="17" height="9"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `)},this.setAutoCorrectTiles=e=>{this._autoCorrectTile=h(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._autoCorrectBorder=h(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `)},this.setCiqFlagTiles=e=>{this._ciqFlagTile=h(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n          <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `),this._ciqFlagBorder=h(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n            <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `)},this.setHeadingDetectionTiles=e=>{this._headingDetectionTile=h(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._headingDetectionBorder=h(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this._theme=a.pz;const o=null==e?void 0:e();o&&this.setSquiggleTheme(o),(0,s.Gn)(this)}get theme(){var e,t;return(null===(e=this.getIsHighContrastTheme)||void 0===e?void 0:e.call(this))?(t=this._theme,Object.assign(Object.assign({},t),{highPriorityColors:Object.assign(Object.assign({},t.highPriorityColors),{tile:"highlight"}),mediumPriorityColors:Object.assign(Object.assign({},t.mediumPriorityColors),{tile:"highlight"}),lowPriorityColors:Object.assign(Object.assign({},t.lowPriorityColors),{tile:"highlight"}),autoCorrectColors:Object.assign(Object.assign({},t.autoCorrectColors),{tile:"highlight"}),ciqFlagColors:Object.assign(Object.assign({},t.ciqFlagColors),{tile:"highlight"}),headingDetectionColors:Object.assign(Object.assign({},t.headingDetectionColors),{tile:"highlight"})})):this._theme}get grammarTile(){return this._grammarTile||this.setGrammarTiles(this._theme),this._grammarTile}get grammarTileBorder(){return this._grammarTileBorder||this.setGrammarTiles(this._theme),this._grammarTileBorder}get insightTile(){return this._insightTile||this.setInsightTiles(this._theme),this._insightTile}get insightTileBorder(){return this._insightTileBorder||this.setInsightTiles(this._theme),this._insightTileBorder}get spellingTile(){return this._spellingTile||this.setSpellingTiles(this._theme),this._spellingTile}get spellingTileBorder(){return this._spellingTileBorder||this.setSpellingTiles(this._theme),this._spellingTileBorder}get autoCorrectTile(){return this._autoCorrectTile||this.setAutoCorrectTiles(this._theme),this._autoCorrectTile}get autoCorrectTileBorder(){return this._autoCorrectBorder||this.setAutoCorrectTiles(this._theme),this._autoCorrectBorder}get ciqFlagTile(){return this._ciqFlagTile||this.setCiqFlagTiles(this._theme),this._ciqFlagTile}get ciqFlagTileBorder(){return this._ciqFlagBorder||this.setCiqFlagTiles(this._theme),this._ciqFlagBorder}get headingDetectionTile(){return this._headingDetectionTile||this.setHeadingDetectionTiles(this._theme),this._headingDetectionTile}get headingDetectionTileBorder(){return this._headingDetectionBorder||this.setHeadingDetectionTiles(this._theme),this._headingDetectionBorder}};(0,i.__decorate)([r.observable],g.prototype,"_theme",void 0),(0,i.__decorate)([r.observable],g.prototype,"_grammarTile",void 0),(0,i.__decorate)([r.observable],g.prototype,"_grammarTileBorder",void 0),(0,i.__decorate)([r.observable],g.prototype,"_insightTile",void 0),(0,i.__decorate)([r.observable],g.prototype,"_insightTileBorder",void 0),(0,i.__decorate)([r.observable],g.prototype,"_spellingTile",void 0),(0,i.__decorate)([r.observable],g.prototype,"_spellingTileBorder",void 0),(0,i.__decorate)([r.observable],g.prototype,"_autoCorrectTile",void 0),(0,i.__decorate)([r.observable],g.prototype,"_autoCorrectBorder",void 0),(0,i.__decorate)([r.observable],g.prototype,"_ciqFlagTile",void 0),(0,i.__decorate)([r.observable],g.prototype,"_ciqFlagBorder",void 0),(0,i.__decorate)([r.observable],g.prototype,"_headingDetectionTile",void 0),(0,i.__decorate)([r.observable],g.prototype,"_headingDetectionBorder",void 0),(0,i.__decorate)([r.computed],g.prototype,"theme",null),(0,i.__decorate)([r.computed],g.prototype,"grammarTile",null),(0,i.__decorate)([r.computed],g.prototype,"grammarTileBorder",null),(0,i.__decorate)([r.computed],g.prototype,"insightTile",null),(0,i.__decorate)([r.computed],g.prototype,"insightTileBorder",null),(0,i.__decorate)([r.computed],g.prototype,"spellingTile",null),(0,i.__decorate)([r.computed],g.prototype,"spellingTileBorder",null),(0,i.__decorate)([r.computed],g.prototype,"autoCorrectTile",null),(0,i.__decorate)([r.computed],g.prototype,"autoCorrectTileBorder",null),(0,i.__decorate)([r.computed],g.prototype,"ciqFlagTile",null),(0,i.__decorate)([r.computed],g.prototype,"ciqFlagTileBorder",null),(0,i.__decorate)([r.computed],g.prototype,"headingDetectionTile",null),(0,i.__decorate)([r.computed],g.prototype,"headingDetectionTileBorder",null),(0,i.__decorate)([r.action],g.prototype,"setSquiggleTheme",void 0),g=(0,i.__decorate)([(0,c._)(),(0,i.__param)(0,(0,u.l)()),(0,i.__param)(0,(0,d.W)(n)),(0,i.__param)(1,(0,u.l)()),(0,i.__param)(1,(0,d.W)(l.A))],g)},80967:(e,t,o)=>{"use strict";o.d(t,{$:()=>i});const i=(0,o(63837).f)("IStyleDefinitions")},68675:(e,t,o)=>{"use strict";o.d(t,{y:()=>i});const i="ms-squiggle-tooltip"},95894:(e,t,o)=>{"use strict";o.d(t,{A:()=>i});const i=(0,o(63837).f)("ISquiggleTooltipStateStore")},32665:(e,t,o)=>{"use strict";o.d(t,{F:()=>h});var i=o(95734),n=o(37842),r=o(8676),s=o(38716);if(3023==o.j)var a=o(23094);var l=o(95894);if(3023==o.j)var c=o(68675);var u=o(13956);const d=(0,n.F5)({state:r.A.on(l.A),localizer:r.A.on(s.H)}),h=()=>{const{state:e,localizer:t}=(0,n.KN)(d),[o,r]=i.useState(e.isVisible);i.useEffect((()=>{const t=e=>{r(e.visible)};return e.subscribe("tooltipStateUpdated",t),()=>{e.unsubscribe("tooltipStateUpdated",t)}}),[e]);const{styles:s,fontsUrl:l,targetDocumentRef:h}=e,g=i.useCallback((()=>{e.hide()}),[e]),p=i.useCallback((()=>{e.emergencyDismiss("Tooltip dismissed on click.")}),[e]);return i.useEffect((()=>{var e,t;const o=new a.J(h),i=new a.J(null!==(t=null===(e=h.deref())||void 0===e?void 0:e.defaultView)&&void 0!==t?t:window);return o.addListener("scroll",g,{capture:!0}),i.addListener("resize",g,{capture:!0}),()=>{o.removeAllListeners(),i.removeAllListeners()}}),[g,h]),i.createElement("div",{style:s.container},l&&i.createElement("link",{rel:"stylesheet",href:l}),i.createElement(u.Ay.div,{style:s.shadowBoundary},(()=>{const{top:n,right:r,left:s,ariaLabel:a,title:l,text:u,styles:d,isEccOpen:h}=e;return!o||h?null:i.createElement("div",{role:"status","aria-live":"polite",id:c.y,style:d.shadowRoot},i.createElement("div",{onClick:p,style:Object.assign(Object.assign({},d.root),{top:n,left:s,right:r}),role:"tooltip","aria-label":t.getMessage("combineSentences",[l,a])},i.createElement("div",{"aria-hidden":!0,style:d.tooltipMain},i.createElement("div",{"aria-hidden":!0,style:d.title},l),i.createElement("div",{"aria-hidden":!0,style:d.text},u))))})()))}},88467:(e,t,o)=>{"use strict";o.d(t,{X:()=>k});var i=o(30206),n=o(19432),r=o(10059),s=o(2579),a=o(44579),l=o(59834),c=o(17288),u=o(38716),d=o(44680),h=o(86278),g=o(36747),p=o(33984),f=o(21648),m=o(91864),v=o(80967),b=o(48828),y=o(90424),w=o(30225),C=o(51285),S=o(96120);let k=class extends n.z{constructor(e,t,o,i,n,s,a,l){super(),this.localizer=e,this.hostSettings=t,this.presentationDomSettings=o,this.logger=i,this.scriptDirectionDetector=n,this.styleDefinitions=s,this.urlFormatter=a,this.inlineSuggestionsRenderer=l,this._position=void 0,this._title=void 0,this._isVisible=!1,this._targetDocumentRef=void 0,this.getTitleCritique=e=>{var t;switch(e.priority){case r.bx.Low:return e.typeId===r.L9.TopicSuggestion?this.localizer.getMessage("ebx_SquiggleTooltipTopicTitle"):this.localizer.getMessage("ebx_SquiggleTooltipRefinementTitle");case r.bx.Medium:return this.localizer.getMessage("ebx_SquiggleTooltipGrammarTitle");case r.bx.High:return this.localizer.getMessage("ebx_SquiggleTooltipSpellingTitle");case r.bx.Informational:return null!==(t=e.tooltipTitle)&&void 0!==t?t:""}},this.getTitleAutocorrect=()=>this.localizer.getMessage("ebx_SquiggleTooltipAutoCorrectTitle"),this.resetTimeout=()=>{this.originStatusCheckTimer&&(window.clearTimeout(this.originStatusCheckTimer),this.originStatusCheckTimer=void 0)},this.checkOriginState=()=>{var e;null===(null===(e=this.origin)||void 0===e?void 0:e.parentElement)?this.emergencyDismiss("Tooltip dismissed on timeout: the origin is orphaned."):this.setOriginStateCheckTimeout()},this.setOriginStateCheckTimeout=()=>{this.originStatusCheckTimer=window.setTimeout(this.checkOriginState,3e3)}}get fontsUrl(){var e;return null===(e=this.urlFormatter)||void 0===e?void 0:e.getUrl(this.presentationDomSettings.fabricFontsDefinitionPath)}get title(){var e;return null!==(e=this._title)&&void 0!==e?e:""}get text(){if((0,C.kI)(this.squiggleKind))return this.localizer.getMessage("ebx_AutoCorrectTooltipText");{const e=(0,S.i)()?this.localizer.getMessage("ebx_SquiggleTooltipCombinationMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipCombinationAlt":"ebx_SquiggleTooltipCombination");return`${this.localizer.getMessage("ebx_SquiggleTooltipText")} ${e}`}}get ariaLabel(){return(0,C.kI)(this.squiggleKind)?this.localizer.getMessage("ebx_AutocorrectTooltipAriaText"):(0,S.i)()?this.localizer.getMessage("ebx_SquiggleTooltipAriaTextMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipAriaTextAlt":"ebx_SquiggleTooltipAriaText")}get isVisible(){return this._isVisible}get top(){return this._position?`${this._position.y}px`:"auto"}get left(){return!this._position||this.scriptDirectionDetector.isRtl()?"auto":`calc(min(100vw - ${this._position.x+300}px, 0px) + ${this._position.x}px)`}get right(){return this._position&&this.scriptDirectionDetector.isRtl()?`calc(100vw - max(${this._position.x}px, 300px))`:"auto"}get styles(){return this.styleDefinitions.tooltip}get isEccOpen(){var e;return!!(null===(e=this.inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo())}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new s.O(document)}async initialize(){}shutDown(){this.hide()}show(e,t,o,i,n){this.resetTimeout(),this.squiggleKind=e,this._title=(0,C.kI)(this.squiggleKind)?this.getTitleAutocorrect():this.getTitleCritique(t),this._position=o,this._isVisible=!!this.hostSettings.showSquiggleTooltip,this.origin=i;const r=null!=n?n:null==i?void 0:i.ownerDocument;this._targetDocumentRef=r&&new s.O(r),this.setOriginStateCheckTimeout();const u=this.logger.getNewActivity(a.n.SquiggleTooltipShown,l.o.SamplingPolicy.CriticalExperimentation);u&&(u.dataFields.push((0,c.n)("CritiqueTypeId",t.typeId)),u.success=!0,u.endNow()),this.publishEvent("tooltipStateUpdated",{visible:this._isVisible,position:this._position})}hide(){this.resetTimeout(),this.origin=void 0,this._targetDocumentRef=void 0,this._isVisible=!1,this._position=void 0,this.squiggleKind=void 0,this.publishEvent("tooltipStateUpdated",{visible:this._isVisible,position:void 0})}emergencyDismiss(e){this.logger.warn(545910989,e),this.hide()}};k=(0,i.__decorate)([(0,b._)(),(0,i.__param)(0,(0,y.W)(u.H)),(0,i.__param)(1,(0,y.W)(d.n)),(0,i.__param)(2,(0,y.W)(m.D)),(0,i.__param)(3,(0,y.W)(h.g)),(0,i.__param)(4,(0,y.W)(g.iw)),(0,i.__param)(5,(0,y.W)(v.$)),(0,i.__param)(6,(0,y.W)(p.n)),(0,i.__param)(6,(0,w.l)()),(0,i.__param)(7,(0,w.l)()),(0,i.__param)(7,(0,y.W)(f.V))],k)},4157:(e,t,o)=>{"use strict";if(o.d(t,{E:()=>c}),3023==o.j)var i=o(15884);if(3023==o.j)var n=o(54218);if(3023==o.j)var r=o(88787);if(3023==o.j)var s=o(63282);if(3023==o.j)var a=o(97428);if(3023==o.j)var l=o(29714);class c{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918365)}configureRootServices(e){e.bind(s.i).toValue(i.u),e.bind(n.JY).to(n.yi),e.bind(l.S).toExisting(n.JY),e.bind(r.mU).to(r.XG)}}},29049:(e,t,o)=>{"use strict";if(o.d(t,{E:()=>u}),3023==o.j)var i=o(4157);if(3023==o.j)var n=o(17783);if(3023==o.j)var r=o(3039);if(3023==o.j)var s=o(29140);if(3023==o.j)var a=o(13304);if(3023==o.j)var l=o(85996);if(3023==o.j)var c=o(86461);class u{constructor(){this.imports=[a.r,i.E]}configureRootServices(e){e.bind(l.M).to(c.t),e.bind(n.$).to(n.I),e.bind(r.P).to(s.Q)}}},8974:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>d}),3023==o.j)var i=o(4157);if(3023==o.j)var n=o(63282);if(3023==o.j)var r=o(97428);if(3023==o.j)var s=o(29714);if(3023==o.j)var a=o(95894);if(3023==o.j)var l=o(32665);if(3023==o.j)var c=o(88467);if(3023==o.j)var u=o(69394);class d{constructor(){this.imports=[i.E,u.f]}get uniqueId(){return(0,r.z)(507918353)}configureRootServices(e){e.bind(a.A).to(c.X),e.bind(s.S).toExisting(a.A),e.bind(n.i).toValue(l.F)}}},69394:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>u}),3023==o.j)var i=o(5901);if(3023==o.j)var n=o(52894);if(3023==o.j)var r=o(12376);if(3023==o.j)var s=o(97428);if(3023==o.j)var a=o(44680);if(3023==o.j)var l=o(90182);if(3023==o.j)var c=o(51285);class u{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918356)}configureRootServices(e){e.bind(l.g).toDynamicValue((e=>{const t=e.get(a.n),o=e.getOptional(r.m);return e=>{switch(e){case c.Ah.critique:return new n.FY(t);case c.Ah.autocorrection:case c.Ah.personalizedAutocorrection:return new i.QE(t,o);default:throw new Error("Unknown squiggle kind")}}}))}}},21479:(e,t,o)=>{"use strict";o.d(t,{S:()=>i});const i=({topicIds:e,topicNames:t,highlightedText:o,hostMetadata:i,requestId:n,source:r,traceId:s})=>{const a=`&body=${encodeURIComponent(`Tell us about your experience with this topic suggestion. Was the suggestion accurate or helpful?\n    \n\n\n\nEngineering notes:\n_______________________________\n\n    TopicIds: ${e}\n\n    TopicNames: ${t}\n\n    HighlightedText: ${o}\n\n    HostMetadata: ${i}\n\n    KMAPIRequestId: ${n}\n\n    Source: ${r}\n\n    TraceId: ${s}\n_______________________________\n`)}`;return"mailto:projecthedleyfeedback@service.microsoft.com?subject=Viva Topics Editor Suggestion Feedback"+encodeURIComponent(": "+o)+a}},29140:(e,t,o)=>{"use strict";o.d(t,{Q:()=>c});var i=o(30206),n=o(43713),r=o(13608),s=o(48828),a=o(30225),l=o(90424);let c=class{constructor(e){var t,o;this.themeStore=e,this.browserSupportsHighContrastMode=null!==(o=null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,"not all and (forced-colors), (forced-colors), not all and (-ms-high-contrast), (-ms-high-contrast)").matches)&&void 0!==o&&o}get enabled(){var e,t;return(null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme)===r.SV.highContrast||(null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,n.Rr.replace("@media ","")).matches)}};c=(0,i.__decorate)([(0,s._)(),(0,i.__param)(0,(0,a.l)()),(0,i.__param)(0,(0,l.W)(r.YQ))],c)},3039:(e,t,o)=>{"use strict";o.d(t,{P:()=>i});const i=(0,o(63837).f)("IHighContrastModeDetector")},7711:(e,t,o)=>{"use strict";function i(e,t){return e===t||n(e.bottom,t.bottom)&&n(e.height,t.height)&&n(e.left,t.left)&&n(e.right,t.right)&&n(e.top,t.top)&&n(e.width,t.width)}function n(e,t,o=.01){return Math.abs(e-t)<o}o.d(t,{a:()=>i})},17783:(e,t,o)=>{"use strict";o.d(t,{$:()=>l,I:()=>c});var i=o(30206),n=o(63837),r=o(48828),s=o(90424),a=o(50955);const l=(0,n.f)("IContentValidator");let c=class{constructor(e){this.presentationSettings=e}validate(e){if(!e)return"";let t=e;return t.includes("￼")&&(t=t.replace(/￼/g,"")),t.slice(0,this.presentationSettings.maxServiceContentLengthInChars)}};c=(0,i.__decorate)([(0,r._)(),(0,i.__param)(0,(0,s.W)(a.z))],c)},69060:(e,t,o)=>{"use strict";o.d(t,{f:()=>r});var i=o(30206),n=o(48828);let r=class{get tooltip(){return{tooltipMain:{background:"window",boxShadow:"none",border:"1px solid windowframe"},title:{color:"windowtext"},text:{color:"windowtext"}}}};r=(0,i.__decorate)([(0,n._)()],r)},60410:(e,t,o)=>{"use strict";o.d(t,{U:()=>u});var i=o(30206),n=(0,o(18322).a)({}),r=o(44207),s=o(13608);const a=e=>{let t="'Segoe UI'";if(e)switch(e.toLowerCase()){case"ar":t="'Segoe UI Web (Arabic)'";break;case"bg-bg":case"ru-ru":case"uk-ua":t="'Segoe UI Web (Cyrillic)'";break;case"cs-cz":case"et-ee":case"hr-hr":case"hu-hu":case"lt-lt":case"lv-lv":case"pl-pl":case"lt-sr-sp":case"tr-tr":case"sk-sk":case"kk-kz":t="'Segoe UI Web (East European)'";break;case"el-gr":t="'Segoe UI Web (Greek)'";break;case"he-il":t="'Segoe UI Web (Hebrew)'";break;case"vi-vn":t="'Segoe UI Web (Vietnamese)'";break;case"ja-jp":t="YuGothic, 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka";break;case"ko-kr":t="'Malgun Gothic', Gulim";break;case"ch-zhs":t="'Microsoft Yahei', Verdana, Simsun";break;case"ch-zht":t="'Microsoft Jhenghei', Pmingliu";break;case"hi-in":t="'Nirmala UI'";break;case"th-th":t="'Leelawadee UI Regular', 'Kmer UI'";break;default:t="'Segoe UI Web (West European)'"}return`${t}, 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif`};var l=o(48828),c=o(59901);let u=class{constructor(e,t,o){this.uxLanguageCode=e,this.themeStore=t,this.useFluentV9=o,this._calloutZIndex=Number.MAX_SAFE_INTEGER-1}get critiqueCallout(){return{shadowHost:{all:"initial",position:"absolute",zIndex:this._calloutZIndex},calloutMain:{root:{fontFamily:a(this.uxLanguageCode),borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:[{borderRadius:8,MsHighContrastAdjust:"auto",fontFamily:a(this.uxLanguageCode)}]},calloutV9:{fontFamily:a(this.uxLanguageCode),borderRadius:8}}}get undoCallout(){return{buttonIcon:{borderRadius:"2px"},logoButtonBase:{cursor:"default",pointerEvents:"all",lineHeight:"24px",fontSize:r.s.size12,fontWeight:r.BO.semibold,WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none",padding:0,margin:"0 8px",flexGrow:0,whiteSpace:"nowrap",overflow:"visible",color:n.palette.blue,alignSelf:"center"},calloutContainer:{height:"40px",borderRadius:"4px",padding:"4px"},calloutMain:{root:{borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:{borderRadius:8,MsHighContrastAdjust:"auto",background:c.L.colorNeutralBackground1}},calloutV9:{fontFamily:a(this.uxLanguageCode),borderRadius:8}}}get tooltip(){var e,t,o,i,r;const l=this.useFluentV9||null===(e=this.themeStore)||void 0===e?void 0:e.getComponentActiveTheme(s.yF.squiggleTooltipComponentName);return{container:{all:"initial",position:"absolute",zIndex:Number.MAX_SAFE_INTEGER},shadowBoundary:{all:"initial"},shadowRoot:{width:"0px !important",height:"0px !important",overflowX:"hidden"},root:{position:"fixed",maxWidth:300,background:this.useFluentV9?c.L.colorNeutralBackground1:"transparent",border:"none",cursor:"default"},tooltipMain:{msHighContrastAdjust:"none",forcedColorAdjust:"none",fontFamily:a(this.uxLanguageCode),fontSize:"12px",fontWeight:600,background:this.useFluentV9?void 0:null!==(t=null==l?void 0:l.background)&&void 0!==t?t:n.palette.white,padding:"6px 12px",display:"inline-block",boxShadow:this.useFluentV9?`0 6.4px 14.4px 0 ${c.L.colorNeutralShadowKey}, 0 1.2px 3.6px 0 ${c.L.colorNeutralShadowAmbient}`:null!==(o=null==l?void 0:l.shadow)&&void 0!==o?o:"0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",border:"none",borderRadius:4},title:{marginBottom:"4px",color:this.useFluentV9?c.L.colorNeutralForeground2:null!==(i=null==l?void 0:l.text)&&void 0!==i?i:n.palette.neutralSecondary},text:{color:this.useFluentV9?c.L.colorNeutralForeground3:null!==(r=null==l?void 0:l.altText)&&void 0!==r?r:n.palette.black}}}};u=(0,i.__decorate)([(0,l._)()],u)},29816:(e,t,o)=>{"use strict";o.d(t,{Y:()=>m,bb:()=>y,c$:()=>b});var i=o(30206),n=o(47954),r=o(91822),s=o(98287),a=o(59886),l=o(83225),c=o(3039),u=o(46546),d=o(63837),h=o(48828),g=o(90424),p=o(30225),f=o(92037);const m=(0,d.f)("IDefaultStyleDefinitionsFactory"),v=(0,d.f)("IDefaultStyleOverrides"),b=(0,d.f)("IHighContrastStyleOverrides");let y=class{constructor(e,t,o,i,s,a,l){this.highContrastModeDetector=e,this.proofingStore=t,this.emitter=o,this.defaultStyleDefinitionsFactory=s,this.highContrastStyleOverrides=a,this.styleOverrides=l,this.onProofingLanguageChanged=e=>{this.styles=this.defineStyles()},this.defineStyles=()=>{const e=this.defaultStyleDefinitionsFactory(this.uxLanguage);return this.styleOverrides?{critiqueCallout:this.applyOverrides(e.critiqueCallout,this.styleOverrides.critiqueCallout),undoCallout:this.applyOverrides(e.undoCallout,this.styleOverrides.undoCallout),tooltip:this.applyOverrides(e.tooltip,this.styleOverrides.tooltip)}:e},this.getAdjustedStyle=e=>{let t=this.styles[e];return this.highContrastModeDetector.enabled&&this.highContrastStyleOverrides&&(t=this.applyOverrides(t,this.highContrastStyleOverrides[e])),t},this.applyOverrides=(e,t)=>{if(!t)return e;const o={};for(const i of Object.keys(e))o[i]=Object.assign(Object.assign({},e[i]),t[i]);return o},this.uxLanguage=i.getUILanguage(),this.styles=this.defineStyles(),this.proofingStore.read(n.l.ProofingLanguages).then((e=>{this.onProofingLanguageChanged(r.I.getDefaultLanguageCode(e))})).catch((()=>{})),this.emitter.on("proofingLanguageChanged",(async e=>{this.onProofingLanguageChanged(e.data.defaultLanguageCode)})),(0,f.Gn)(this)}get critiqueCallout(){return this.getAdjustedStyle("critiqueCallout")}get undoCallout(){return this.getAdjustedStyle("undoCallout")}get tooltip(){return this.getAdjustedStyle("tooltip")}};(0,i.__decorate)([u.observable],y.prototype,"styles",void 0),(0,i.__decorate)([u.computed],y.prototype,"critiqueCallout",null),(0,i.__decorate)([u.computed],y.prototype,"undoCallout",null),(0,i.__decorate)([u.computed],y.prototype,"tooltip",null),(0,i.__decorate)([u.action],y.prototype,"onProofingLanguageChanged",void 0),y=(0,i.__decorate)([(0,h._)(),(0,i.__param)(0,(0,g.W)(c.P)),(0,i.__param)(1,(0,g.W)(s.K)),(0,i.__param)(2,(0,g.W)(a.o)),(0,i.__param)(3,(0,g.W)(l.v)),(0,i.__param)(4,(0,g.W)(m)),(0,i.__param)(5,(0,p.l)()),(0,i.__param)(5,(0,g.W)(b)),(0,i.__param)(6,(0,p.l)()),(0,i.__param)(6,(0,g.W)(v))],y)},13821:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>l}),3023==o.j)var i=o(4157);if(3023==o.j)var n=o(63282);if(3023==o.j)var r=o(13681);if(3023==o.j)var s=o(41977);if(3023==o.j)var a=o(97428);class l{constructor(){this.imports=[s.Q,i.E]}get uniqueId(){return(0,a.z)(507918302)}configureRootServices(e){e.bind(n.i).toValue(r._)}}},81628:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>v}),3023==o.j)var i=o(29049);if(3023==o.j)var n=o(87276);if(3023==o.j)var r=o(80967);if(3023==o.j)var s=o(76785);if(3023==o.j)var a=o(30074);if(3023==o.j)var l=o(60410);if(3023==o.j)var c=o(63282);if(3023==o.j)var u=o(69060);if(3023==o.j)var d=o(29816);if(3023==o.j)var h=o(97428);if(3023==o.j)var g=o(29714);if(3023==o.j)var p=o(44680);var f=o(13608);if(3023==o.j)var m=o(82285);class v{constructor(){this.imports=[i.E,m.h]}get uniqueId(){return(0,h.z)(507918293)}configureRootServices(e){e.bind(c.i).toValue(s.r),e.bind(n.v).to(a.b),e.bind(g.S).toExisting(n.v),e.bind(r.$).to(d.bb),e.bind(d.c$).to(u.f),e.bind(d.Y).toDynamicValue((e=>{const t=e.getOptional(f.YQ),o=e.get(p.n);return e=>new l.U(e,t,!!o.useFluentV9)}))}}},2798:(e,t,o)=>{"use strict";if(o.d(t,{O:()=>a}),3023==o.j)var i=o(8974);if(3023==o.j)var n=o(69394);if(3023==o.j)var r=o(92535);if(3023==o.j)var s=o(97428);class a{constructor(){this.imports=[r.C,i.D,n.f]}get uniqueId(){return(0,s.z)(507918281)}configureRootServices(e){}}},4442:(e,t,o)=>{"use strict";o.d(t,{C:()=>u});var i=o(46746),n=o(33044),r=o(61653),s=o(37842),a=o(8676),l=o(95734);const c=(0,s.F5)({squigglerCanvasRenderingState:a.A.on(i.C),contentEditableSquigglerComponent:a.A.on(n.u).optional(),inputControlsSquigglerComponent:a.A.on(r.$K).optional()}),u=()=>{const{contentEditableSquigglerComponent:e,inputControlsSquigglerComponent:t,squigglerCanvasRenderingState:o}=(0,s.KN)(c),i=[],n=[],[r,a]=l.useState(o);if(l.useEffect((()=>(o.subscribe("stateUpdated",a),()=>{o.unsubscribe("stateUpdated",a)})),[o]),!r.visible)return null;if(e)for(const[t,n]of r.squigglers)o.getTileVisibility(n.proofedElements[0].id)&&i.push(e(t,n));if(t)for(const e of r.inputControlsProxyList)n.push(t(e));return l.createElement(l.Fragment,null,...n,...i)}},43099:(e,t,o)=>{"use strict";o.d(t,{D:()=>N});var i=o(30206),n=o(19432),r=o(11387),s=o(99828),a=o(2579),l=o(3755),c=o(59886),u=o(40747),d=o(86278),h=o(31685),g=o(44680),p=o(19376),f=o(51285);class m{constructor(e,t,o,i,n,r,s){this.hostSettings=e,this.calloutStateStore=t,this.undoCalloutStateStore=o,this.squiggleTooltipStateStore=i,this.critiqueStore=s,this.squigglerFlagCritiqueHandler=new p.G(t,n,o,r)}hideCallout(){var e;this.calloutStateStore.isVisible&&!this.calloutStateStore.isApplyingCritiqueAction&&(this.calloutStateStore.recordInstrumentationEventId(12),this.calloutStateStore.hide()),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide()}async showCallout(e){var t,o,i,n;null===(t=this.squiggleTooltipStateStore)||void 0===t||t.hide();const s=null===(o=this.critiqueStore)||void 0===o?void 0:o.getCritique(e.critique.traceId,e.critique.nodeId),a=Object.assign(Object.assign({},e),{critique:s?(0,r.OE)(s):e.critique});if(!(null===(n=null===(i=this.hostSettings.serviceSettings)||void 0===i?void 0:i.squigglerSettings)||void 0===n?void 0:n.onSquiggleClicked)||this.hostSettings.serviceSettings.squigglerSettings.onSquiggleClicked(a.critique))if((0,r.r3)(a.critique))await this.squigglerFlagCritiqueHandler.showFlagCritique(a);else{if(this.undoCalloutStateStore&&e.squiggleKind===f.Ah.autocorrection)return this.undoCalloutStateStore.show(a);await this.calloutStateStore.show(a)}}}class v{constructor(e,t,o,i){this.squiggleTooltipStateStore=e,this.calloutStateStore=t,this.undoCalloutStateStore=o,this.hostSettings=i}showTooltip(e){var t,o,i,n,r;const{squiggleKind:s,critique:a,position:l,origin:c,targetDocument:u}=e;if(!(null===(t=this.calloutStateStore)||void 0===t?void 0:t.isVisible)&&!(null===(o=this.undoCalloutStateStore)||void 0===o?void 0:o.isVisible)){if(!c&&!(null===(i=this.hostSettings)||void 0===i?void 0:i.enableCSSHighlightApiSquiggleRendering))return;(null===(n=this.squiggleTooltipStateStore)||void 0===n?void 0:n.isVisible)&&this.squiggleTooltipStateStore.hide(),null===(r=this.squiggleTooltipStateStore)||void 0===r||r.show(s,a,l,c,u)}}hideTooltip(){var e;null===(e=this.squiggleTooltipStateStore)||void 0===e||e.hide()}}var b=o(33044),y=o(61653),w=o(87276),C=o(95894),S=o(79788),k=o(21648),T=o(23210),x=o(75186),_=o(63837);const I=(0,_.f)("ICritiqueCardNativeApi");(0,_.f)("IECCNativeApi");var E=o(79993),B=o(31409),A=o(39441),R=o(66526),M=o(36271),D=o(48828),P=o(90424),F=o(30225),O=o(46546);let N=class extends n.z{constructor(e,t,o,i,n,c,u,d,h,g,p,f,b,y,w,C,S,k){super(),this.proofingEventListener=e,this.squigglerStateStoreFactory=t,this.inputControlsStateStoreFactory=o,this.calloutStateStore=i,this.settings=n,this.guidGenerator=c,this.squiggleTooltipStateStore=u,this._logger=d,this.critiqueApplicationHandler=h,this.proofingDom=g,this.safeWindow=p,this.tileContent=f,this.hostSettings=b,this.inlineSuggestionsRenderer=y,this.squigglePositioningEdgeCases=w,this.undoCalloutStateStore=C,this.nativeApi=S,this.critiqueStore=k,this.anchorElements=new Map,this.squigglers=new Map,this.visible=!0,this.tileVisibility=new Map,this.inputControlsProxyList=[],this._inputControlsProxyListCache=[],this.setVisibility=e=>{this.visible=e,this.publishStateChange()},this.setVisibilityForTile=(e,t)=>{var o,i,n,r,s,a,l,c;if(this.tileVisibility.set(e,t),!t){e===(null===(i=null===(o=this.inlineSuggestionsRenderer)||void 0===o?void 0:o.getCurrentMenuInfo())||void 0===i?void 0:i.parentTileId)&&this.inlineSuggestionsRenderer.dismissMenu();const t=null===(n=this.calloutStateStore.critique)||void 0===n?void 0:n.nodeId,u=this.proofingDom.findParagraphNode(null!=t?t:"");e===(null===(r=null==u?void 0:u.parent)||void 0===r?void 0:r.id)&&this.calloutStateStore.hide();const d=null===(a=null===(s=this.undoCalloutStateStore)||void 0===s?void 0:s.critique)||void 0===a?void 0:a.nodeId,h=this.proofingDom.findParagraphNode(null!=d?d:"");e===(null===(l=null==h?void 0:h.parent)||void 0===l?void 0:l.id)&&(null===(c=this.undoCalloutStateStore)||void 0===c||c.hide())}this.publishStateChange()},this.getTileVisibility=e=>{var t;return null===(t=this.tileVisibility.get(e))||void 0===t||t},this.getSquigglerForTile=e=>{const t=this.anchorElements.get(e);return t?this.squigglers.get(t.id):void 0},this.getCritiqueCount=e=>{var t;return!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null!==(t=null==e?void 0:e.getCritiques().length)&&void 0!==t?t:0},this.update=e=>(!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null==e?void 0:e.updateSquiggles()),this.updateSquiggleRanges=e=>{if(e)return void e.updateRanges();if(0===this.squigglers.size)return;const t=new Set(this.squigglers.values());for(const e of t)e.updateRanges()},this.navigate=(e,t)=>{!t&&this.squigglers.size>0&&(t=Array.from(this.squigglers.values())),t&&(this.calloutStateStore.setNavInfo({stores:t,ctr:"contenteditable",currentIndex:0,category:"category",onCloseNavigation:()=>{e()},onNavSuggestionApplied:()=>{this.calloutStateStore.navigate(0)}}),this.calloutStateStore.navigate(0))},this.clearSquiggles=(e,t,o)=>{1===e.proofedElements.length&&e.proofedElements[0].id===t?(this.anchorElements.delete(t),this.squigglers.delete(o),this.publishStateChange(),e.dispose()):e.removeCritiques(t).then((()=>{e.isEmpty&&(this.squigglers.delete(o),this.anchorElements.delete(t),e.dispose()),this.publishStateChange()}))},this.displayFlag=async e=>{const t={critique:e,issueText:"",setInitialFocus:!1,onDismiss(e){},onIgnoreOnce:this.onIgnoreOnce,onIgnoreAll:this.onIgnoreAll,onApplyFlag:this.onApplyFlag};await this.critiqueCalloutHandler.showCallout(t)},this.onApplyFlag=async(e,t,o)=>{await this.applyChange(e,(async(i,n)=>{await i.applyFlagSuggestion(n,void 0,e.nodeId,e,t,o)}))},this.applyChange=(e,t)=>{const o=this.proofingDom.findParagraphNode(e.nodeId);return(0,B.l)(o)&&o.parent.element?t(this.critiqueApplicationHandler,o.parent.element):Promise.resolve()},this.onIgnoreOnce=e=>{(0,r.r3)(e)&&this.applyChange(e,((t,o)=>{t.ignoreFlagOnce(o,void 0,e.nodeId,e)}))},this.onIgnoreAll=e=>{(0,r.r3)(e)&&this.applyChange(e,((t,o)=>{t.ignoreAllOfCritique(o,void 0,e.nodeId,e)}))},this.setSquiggler=(e,t)=>{this.squigglers.set(e,t),this.publishStateChange()},this.notifyHost=e=>{var t,o;const i=e.data.critiquesToElementsMap;if(e.messageType===s.G.NewData)for(const e of i)null===(t=this.nativeApi)||void 0===t||t.critiqueCountChanged(e.critiques.length);else if(e.messageType===s.G.RemoveData)for(const e of i)this.anchorElements.get(e.elementId)&&(null===(o=this.nativeApi)||void 0===o||o.critiqueCountChanged(e.critiques.length))},this.getAnchorElement=(e,t)=>{var o;let i=this.anchorElements.get(e);if(i){const t=i.elementRef.deref();if(null==t?void 0:t.isConnected)return i;this.clearSquiggler(e),this.anchorElements.delete(e)}let n=t;const r=null===(o=this.squigglePositioningEdgeCases)||void 0===o?void 0:o.getEdgeCases(),s=null==r?void 0:r.find((e=>e.match(t)));if(null==s?void 0:s.getAnchorElement){let o;n=s.getAnchorElement(t);for(const t of this.anchorElements.values())t.elementRef.deref()===n&&(this.anchorElements.set(e,t),o=t);i=o}else{if(t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(n=e)}if("true"===n.getAttribute(this.settings.editorSpellcheckAttribute)){let t;for(const o of this.anchorElements.values())o.elementRef.deref()===n&&(this.anchorElements.set(e,o),t=o);i=t}}return i||(i={id:this.guidGenerator.generate(),elementRef:new a.O(n)},this.anchorElements.set(e,i)),i},this._zoomScale=1,this.updateInputControlsProxyListCache=e=>{0===this._inputControlsProxyListCache.length&&0===e.length||(this._inputControlsProxyListCache=e,this.safeWindow.requestAnimationFrame((()=>{0===this.inputControlsProxyList.length&&0===this._inputControlsProxyListCache.length||(this.inputControlsProxyList=this._inputControlsProxyListCache,this.publishStateChange())})))},this.buildInputAndTextAreaList=e=>{if(!this.inputControlsStateStoreFactory)return;this._inputControlsProxyListCache=this._inputControlsProxyListCache.map((e=>(e.messageItem.changed=!1,e)));const t=e.data.critiquesToElementsMap;for(const e of t){if(!e.element)continue;const t=this.tileContent.getContainingElement(e.element);if(!t)continue;if(!(0,l.C)(t,"HTMLInputElement")&&!(0,l.C)(t,"HTMLTextAreaElement"))continue;const o=this.getAnchorElement(e.elementId,t);if(o){this._inputControlsProxyListCache=this._inputControlsProxyListCache.filter((e=>e.messageItem.anchor.id!==o.id));const t={entry:{elementId:e.elementId,element:e.element,critiques:e.critiques},anchor:{element:o.elementRef.deref(),id:o.id},changed:!0};this._inputControlsProxyListCache.push(this.inputControlsStateStoreFactory({messageItem:t,critiqueCalloutHandler:this.critiqueCalloutHandler,tooltipHandler:this.tooltipHandler,disableClearOnFocusFix:!1}))}}this.updateInputControlsProxyListCache(this._inputControlsProxyListCache)},this.buildContentEditableList=async e=>{if(!this.squigglerStateStoreFactory)return;const t=e.data.critiquesToElementsMap;if(e.messageType===s.G.NewData||e.messageType===s.G.ChangeData)await(0,O.transaction)((async()=>{if(this.squigglerStateStoreFactory)for(const o of t){if(!o.element)continue;const t=this.proofingDom.findTileNode(o.elementId);if(!t)continue;const i=this.tileContent.getContainingElement(o.element);if(!i)continue;if((0,l.C)(i,"HTMLInputElement")||(0,l.C)(i,"HTMLTextAreaElement")||!(0,l.C)(i,"HTMLElement"))continue;const n=this.getAnchorElement(o.elementId,i);let r;if(n&&(r=this.squigglers.get(n.id)),!n||!o.critiques.length){n&&r&&!o.critiques.length&&this.clearSquiggles(r,o.elementId,n.id);continue}const s={id:o.elementId,graphNode:t,element:i,critiques:o.critiques};r?await r.setCritiques(s,e.data.isVisualStateChange):(r=this.squigglerStateStoreFactory(s,n.elementRef.deref(),n.id,this.critiqueCalloutHandler,this.tooltipHandler),1!==this._zoomScale&&r.scaleTransform(this._zoomScale),this.setSquiggler(n.id,r))}}));else if(e.messageType===s.G.RemoveData)for(const e of t)this.clearSquiggler(e.elementId)},this.critiqueCalloutHandler=new m(this.hostSettings,this.calloutStateStore,this.undoCalloutStateStore,this.squiggleTooltipStateStore,this.inlineSuggestionsRenderer,this._logger,this.critiqueStore),this.tooltipHandler=new v(this.squiggleTooltipStateStore,this.calloutStateStore,this.undoCalloutStateStore,this.hostSettings)}async initialize(){this.proofingEventListener.emit("squiggleUXReadyEvent",{messageType:s.G.NewData})}shutDown(){var e;if(this.squigglers.size)for(const e of this.squigglers.values())e.dispose();this.squigglers.clear(),this.anchorElements.clear(),this.calloutStateStore.hide(),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide(),this.publishStateChange()}publishStateChange(){this.publishEvent("stateUpdated",{squigglers:this.squigglers,inputControlsProxyList:this.inputControlsProxyList,visible:this.visible})}clearSquiggler(e){const t=this.anchorElements.get(e);if(!t)return;const o=this.squigglers.get(t.id);o&&this.clearSquiggles(o,e,t.id)}async onCritiqueForUiEvent(e){this.buildInputAndTextAreaList(e),await this.buildContentEditableList(e),this.notifyHost(e)}setZoomScale(e){this._zoomScale=e;for(const[,t]of this.squigglers)t.scaleTransform(e)}};N=(0,i.__decorate)([(0,D._)(),(0,i.__param)(0,(0,P.W)(c.o)),(0,i.__param)(1,(0,F.l)()),(0,i.__param)(1,(0,P.W)(b.f)),(0,i.__param)(2,(0,F.l)()),(0,i.__param)(2,(0,P.W)(y.iV)),(0,i.__param)(3,(0,P.W)(w.v)),(0,i.__param)(4,(0,P.W)(A.k)),(0,i.__param)(5,(0,P.W)(u.G)),(0,i.__param)(6,(0,P.W)(C.A)),(0,i.__param)(6,(0,F.l)()),(0,i.__param)(7,(0,P.W)(d.g)),(0,i.__param)(8,(0,P.W)(S.i)),(0,i.__param)(9,(0,P.W)(R.w)),(0,i.__param)(10,(0,P.W)(h.j)),(0,i.__param)(11,(0,P.W)(M.d)),(0,i.__param)(12,(0,P.W)(g.n)),(0,i.__param)(13,(0,F.l)()),(0,i.__param)(13,(0,P.W)(k.V)),(0,i.__param)(14,(0,F.l)()),(0,i.__param)(14,(0,P.W)(T._)),(0,i.__param)(15,(0,F.l)()),(0,i.__param)(15,(0,P.W)(x.x)),(0,i.__param)(16,(0,F.l)()),(0,i.__param)(16,(0,P.W)(I)),(0,i.__param)(17,(0,F.l)()),(0,i.__param)(17,(0,P.W)(E.$))],N)},10722:(e,t,o)=>{"use strict";const i=new(o(68008).diff_match_patch);i.Diff_Timeout=0;const n=(e,t)=>e.index>=0?(e.index=t,e):t;addEventListener("message",(e=>{"get-url"!==e.data[0]?(e=>{try{const o=[],r=e.data[0],s=e.data[1],a=e.data[2],l=i.diff_main(r,s);1===l.length&&0===l[0][0]&&e.ports[0].postMessage({result:a});let c=0,u=0,d=0,h=0,g=0,p=0;for(const e of l){const i=e[0],r=e[1].length;switch(i){case 0:g=r,p=r;break;case 1:g=0,p=r;break;case-1:d+=r;continue}u+=d,d=0;for(let e=c;e<a.length;e+=1){const r=(t=a[e]).index>=0?t.index:t;if(r<h)throw new Error("Indices are not sorted!");if(!(r>=h&&r<h+p))break;o[e]=n(a[e],0===i?r+u-h:u),c+=1}if(c===a.length)break;u+=g,h+=p}for(let e=c;e<a.length;e+=1)o[e]=n(a[e],u);e.ports[0].postMessage({result:o})}catch(t){e.ports[0].postMessage({error:t})}var t})(e):e.ports[0].postMessage({url:self.location.href})}),!1)},8228:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>O}),3023==o.j)var i=o(69394);if(3023==o.j)var n=o(33044);if(3023==o.j)var r=o(90182);if(3023==o.j)var s=o(35047);if(3023==o.j)var a=o(32673);if(3023==o.j)var l=o(38203);if(3023==o.j)var c=o(88787);if(3023==o.j)var u=o(92910);if(3023==o.j)var d=o(15885);if(3023==o.j)var h=o(69711);if(3023==o.j)var g=o(3039);if(3023==o.j)var p=o(79993);if(3023==o.j)var f=o(45118);if(3023==o.j)var m=o(44332);if(3023==o.j)var v=o(12376);if(3023==o.j)var b=o(36271);if(3023==o.j)var y=o(66526);if(3023==o.j)var w=o(6638);if(3023==o.j)var C=o(51218);if(3023==o.j)var S=o(85996);if(3023==o.j)var k=o(21206);if(3023==o.j)var T=o(6754);if(3023==o.j)var x=o(97428);if(3023==o.j)var _=o(31685);if(3023==o.j)var I=o(8903);if(3023==o.j)var E=o(44680);if(3023==o.j)var B=o(21077);if(3023==o.j)var A=o(86278);if(3023==o.j)var R=o(13494);if(3023==o.j)var M=o(18582);if(3023==o.j)var D=o(83732);if(3023==o.j)var P=o(42877);var F=o(95734);class O{constructor(){this.imports=[i.f]}get uniqueId(){return(0,x.z)(507847257)}configureRootServices(e){e.bind(n.u).toDynamicValue((e=>{const t=e.get(_.j),o=e.get(I.c),i=e.get(E.n),n=e.get(r.g),a=e.get(g.P);return(e,r)=>F.createElement(s.$,{key:`squiggler-${e}`,state:r,deps:{safeWindow:t,featureFlagsReader:o,hostSettings:i,squigglerUXFactory:n,highConstrastModeDetector:a}})})),e.bind(a.Vw).to(l.U),e.bind(n.f).toDynamicValue((t=>{const o=e.get(b.d),i=e.get(B.f),n=e.get(A.g),r=e.getAll(R.zJ),s=e.get(R.M5),l=e.get(E.n),g=e.get(y.w),x=e.get(a.Vw),_=e.getOptional(w.M),I=e.getOptional(C.Ey),F=e.getOptional(c.mU),O=e.getOptional(M.z),N=e.getOptional(S.M),q=e.getOptional(k.W),j=e.getOptional(p.$),L=e.getOptional(f.a),z=e.getOptional(m.K),H=e.getOptional(T.s),W=e.getOptional(D.rI),U=e.getOptional(u.PF),G=e.getOptional(v.m),V=e.getOptional(d.A);return(t,a,c,u,d,p={})=>new h.i({proofedItem:t,anchorElement:a,anchorId:c,critiqueCalloutHandler:u,tooltipHandler:d,options:e.get(P.z)(p)},o,i,r,s,l,g,x,n,_,I,F,O,N,q,j,L,z,H,W,U,G,V)}))}}},42877:(e,t,o)=>{"use strict";if(o.d(t,{S:()=>d,z:()=>u}),3023==o.j)var i=o(97428);if(3023==o.j)var n=o(8903);if(3023==o.j)var r=o(44680);if(3023==o.j)var s=o(8996);if(3023==o.j)var a=o(23210);if(3023==o.j)var l=o(69013);if(3023==o.j)var c=o(54110);const u=(0,o(63837).f)("ISquigglerOptionsFactory");class d{constructor(){this.imports=[]}get uniqueId(){return(0,i.z)(507918274)}configureRootServices(e){e.bind(u).toDynamicValue((e=>{const t=e.get(n.c),o=e.get(r.n),i=e.getOptional(a._);return(e={})=>{const n=t.flags.enableSvgSquiggleUnderline?s.N.SVG:o.sessionType===r.d.OWA_New_Email||o.sessionType===r.d.OWA_Draft_Email?s.N.OFFICE:s.N.GENERIC;e.edgeCases=null==i?void 0:i.getEdgeCases(),e.visibilityTracker=t.flags.enableVisibilityTracker?new l.J:l.Y,e.throttleUpdates=t.flags.enableSquigglesUpdateThrottling,e.visibilityTrackerShouldTrackSquiggles=t.flags.visibilityTrackerShouldTrackSquiggles,e.mutationObserverBasedRelativePosition=t.flags.mutationObserverBasedRelativePosition,e.enableCursorIntersectionObserver=t.flags.enableCursorIntersectionObserver,e.disableAutoBrowserVirtualizationOfSquiggles=t.flags.disableAutoBrowserVirtualizationOfSquiggles;let a=c.j.none;t.flags.enableAriaStatusElement&&(t.flags.enableCssHighlightApiAnnouncementsOnly?a|=c.j.cssHighlightsAPIAnnouncement:a|=c.j.appearance|c.j.highlight,t.flags.enableLineNavAriaAnnouncement&&(a|=c.j.lineNavigation));const u=e;return u.restoreCaretPosition=!!o.enableCaretPositionRestore,u.ariaFeatures=a,u.tooltipEnabled=!!o.showSquiggleTooltip,u.disableSquiggleTooltipOnTextSelection=!!o.disableSquiggleTooltipOnTextSelection,u.squiggleStyleType=n,u.autoCorrectionEnabled=o.enableAutoCorrect,u.personalizedAutoCorrectionEnabled=o.enablePersonalizedAutoCorrect,u.autoCorrectionInputCacheEnabled=o.enableAutoCorrect&&t.flags.enableAutoCorrectInputCache,u.trackProofingElementsPositionEnabled=o.dynamicProofingElementsEnabled,u.disableRangeWhenApplyingCritiqueSuggestions=o.disableRangeWhenApplyingCritiqueSuggestions,u.disableOpenAutoCorrectCalloutOnHover=o.disableOpenAutoCorrectCalloutOnHover,u}}))}}},92535:(e,t,o)=>{"use strict";if(o.d(t,{C:()=>u}),3023==o.j)var i=o(63282);if(3023==o.j)var n=o(97428);if(3023==o.j)var r=o(29714);if(3023==o.j)var s=o(69394);if(3023==o.j)var a=o(46746);if(3023==o.j)var l=o(4442);if(3023==o.j)var c=o(43099);class u{constructor(){this.imports=[s.f]}get uniqueId(){return(0,n.z)(507918273)}configureRootServices(e){e.bind(i.i).toValue(l.C),e.bind(a.C).to(c.D),e.bind(r.S).toExisting(a.C)}}},43713:(e,t,o)=>{"use strict";o.d(t,{CJ:()=>r,Rr:()=>n});const i="(-ms-high-contrast: active), (forced-colors: active)",n="@media screen and "+i;class r{get isHighContrastActive(){return window.matchMedia(i).matches}get isHighContrastBlack(){return window.matchMedia("(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)").matches}get isHighContrastWhite(){return window.matchMedia("(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)").matches}}new r},78376:(e,t,o)=>{"use strict";if(o.d(t,{r:()=>r}),3023==o.j)var i=o(37842);var n=o(95734);function r(e,t){var o;const r=o=>{const r=(0,i.KN)(t);return o.deps?n.createElement(e,Object.assign({},o)):n.createElement(e,Object.assign({},o,{deps:r}))},s=null!==(o=e.displayName)&&void 0!==o?o:e.name;return r.displayName=`${s}DepsResolver`,r}},45036:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>v}),3023==o.j)var i=o(28356);if(3023==o.j)var n=o(36943);if(3023==o.j)var r=o(88236);if(3023==o.j)var s=o(84382);if(3023==o.j)var a=o(52176);if(3023==o.j)var l=o(78992);if(3023==o.j)var c=o(25451);if(3023==o.j)var u=o(43596);if(3023==o.j)var d=o(12305);if(3023==o.j)var h=o(10193);if(3023==o.j)var g=o(45384);const p={requiredFlights:["mc-editor-oa","mc-editor-oa-client-ecc"],isFeatureEnabled:(e,t)=>!0===(null==t?void 0:t.some((t=>t===e)))},f={};class m{constructor(e,t,o,i){this.refreshCadence=e,this.augloopSession=t,this.timer=o,this._logger=i}start(){this.timer.setIntervalWithDelay("refreshGraphSearchData",(()=>this.tryRefresh()),this.refreshCadence,this.refreshCadence)}stop(){this.timer.clearTimer("refreshGraphSearchData")}async tryRefresh(){if(this.augloopSession.isClosed)return;const e={parentPath:["session","doc"],items:[{id:"0",body:new n.$9({forceRefresh:!1})}]};this.augloopSession.submitOperation(new i.Xr(e))}onRefreshDone(){this._logger.info(507349215,"Graph search data refresh done")}}class v{constructor(e,t,o){var i,n,r,s,a,l,c,u,d,h;this.timer=o,this.defaultRefreshInterval=3e5,this.annotationListenerType="",this.config=e,this._logger=t,this.requiredSetting(null===(i=this.config.oaSettings)||void 0===i?void 0:i.enableOaClient,"oaSettings.enableOaClient"),this.requiredSetting(null===(r=null===(n=this.config.serviceSettings)||void 0===n?void 0:n.hybridAugloop)||void 0===r?void 0:r.enabled,"serviceSettings.hybridAugloop.enabled"),this.requiredSetting(null===(a=null===(s=this.config.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===a?void 0:a.enableGraphSearchLocal,"serviceSettings.hybridAugloop.enableGraphSearchLocal"),this.requiredSetting(null===(l=this.config.orchestratorSettings)||void 0===l?void 0:l.enableAugLoop,"orchestratorSettings.enableAugLoop"),this.requiredSetting(!!(null===(c=this.config.orchestratorSettings)||void 0===c?void 0:c.substrateAuthTokenCallback),"orchestratorSettings.substrateAuthTokenCallback"),this.checkRequiredFlights(this.config.flightsToTrack),this.cacheGetter=(null===(h=null===(d=null===(u=this.config.serviceSettings)||void 0===u?void 0:u.hybridAugloop)||void 0===d?void 0:d.wasmConfig)||void 0===h?void 0:h.disableModuleCache)?()=>f:void 0,this.config.orchestratorSettings?(this.config.orchestratorSettings.preRuntimeInit=this.config.orchestratorSettings.preRuntimeInit||[],this.config.orchestratorSettings.preRuntimeInit.push(((e,t)=>this.preRuntimeInit(e,t)))):this._logger.error(507349214,"OrchestratorSettings missing. Required for Hybrid ECC"),this.eccEnabled=(e=>{var t;return!!(null===(t=e.oaSettings)||void 0===t?void 0:t.enableOaClient)})(e),this.eccEnabled||this._logger.warn(507349213,"Hybrid ECC workflows are not enabled.  Consider excluding Hybrid plugin support to reduce overall package size.")}get wasmScriptPath(){var e,t,o;return(0,d.Gm)(null===(o=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.wasmConfig)||void 0===o?void 0:o.scriptPath)}preRuntimeInit(e,t){return t.inferenceServiceFactory=l._.createFactory(this.wasmScriptPath,(0,d.$A)(this.config),this.cacheGetter),t.modelDownloader=new a.$(e.appName,"fs.microsoft.com/fs/augmentationLoop","res.cdn.office.net/polymer/models"),Promise.resolve()}requiredSetting(e,t){e||this._logger.error(507349212,`Required setting ${t} for hybrid wasn't set.`,t)}checkRequiredFlights(e){const t=p.requiredFlights.filter((t=>!p.isFeatureEnabled(t,e)));0!==t.length&&this._logger.error(507349211,`Hybrid requires these flights be enabled: ${t}`,t)}async activateAnnotations(e){if(!e||!this.eccEnabled)return;e.registerLocalWorkflow(h.A);const t=this.wasmScriptPath||"",o=(0,d.uz)(this.config),i={wasmRoot:t,locateFile:e=>(0,d.$A)(this.config,e),cacheModule:!0,wasmModuleCache:this.cacheGetter};e.registerLocalWorkflow((0,c.X8)(o,i)),e.registerLocalWorkflow((0,u.L4)(o,i)),e.activateAnnotation(r.NG.getTypeName()),e.registerLocalWorkflow(g.TE),e.activateAnnotation(s.os.getTypeName()),this.isUpdateSchedulerEnabled()?this.setupGraphSearchDataRefreshScheduler(e):e.activateAnnotation(n.$9.getTypeName())}isUpdateSchedulerEnabled(){var e,t,o;return null!==(o=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.enablePeriodicUpdates)&&void 0!==o&&o}getUpdateInterval(){var e,t,o;return null!==(o=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.periodicUpdateInterval)&&void 0!==o?o:this.defaultRefreshInterval}setupGraphSearchDataRefreshScheduler(e){this.graphSearchDataRefreshScheduler&&this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=new m(this.getUpdateInterval(),e,this.timer,this._logger),this.graphSearchDataRefreshScheduler.start(),e.activateAnnotation(n.$9.getTypeName(),{callback:this.graphSearchDataRefreshScheduler.onRefreshDone.bind(this.graphSearchDataRefreshScheduler)})}async deactivateAnnotations(e){return!(!e||!this.eccEnabled||(this.graphSearchDataRefreshScheduler&&(this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=void 0),e.releaseAnnotation(r.NG.getTypeName()),e.releaseAnnotation(s.os.getTypeName()),e.releaseAnnotation(n.$9.getTypeName()),0))}async updateAnnotationActivationConfig(){}}},37857:(e,t,o)=>{"use strict";o.d(t,{g:()=>u});var i=o(30206),n=o(45036),r=o(44680),s=o(86278),a=o(1628),l=o(48828),c=o(90424);let u=class{constructor(e,t,o){this.isEnabled=!0,this.graphSearchLocalAnnotationListener=new n.N(e,t,o)}onInitialize(){}register(e,t){}unregister(){}createAnnotationListener(){return this.graphSearchLocalAnnotationListener}onSessionReconnected(){}onDocumentCreated(){}};u=(0,i.__decorate)([(0,l._)(),(0,i.__param)(0,(0,c.W)(r.n)),(0,i.__param)(1,(0,c.W)(s.g)),(0,i.__param)(2,(0,c.W)(a.J))],u)},72677:(e,t,o)=>{"use strict";if(o.d(t,{p:()=>u}),3023==o.j)var i=o(97105);if(3023==o.j)var n=o(32450);if(3023==o.j)var r=o(27742);if(3023==o.j)var s=o(37857);if(3023==o.j)var a=o(7523);if(3023==o.j)var l=o(97428);if(3023==o.j)var c=o(53023);class u{constructor(){this.imports=[i.J,a.k]}get uniqueId(){return(0,l.z)(507918226)}configureRootServices(e){e.bind(n.T).to(s.g),e.bind(r.cl).toDynamicValue((e=>(e,t)=>{var o;const i=(0,c.g)(e,null===(o=t.hostSettings.orchestratorSettings)||void 0===o?void 0:o.substrateAuthTokenCallback);return Object.assign(Object.assign({},e),{isFeatureEnabled:i.isFeatureEnabled,requestAuthToken:i.requestAuthToken})}))}}},53023:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>r}),3023==o.j)var i=o(37218);function n(e,t){return async o=>o.TokenType===i.OY.Substrate&&t?{Token:await t(o)}:e(o)}function r(e,t){return{isFeatureEnabled:(o=e.isFeatureEnabled,async(e,t)=>{switch(e){case"Microsoft.Office.AugLoop.AnnotationsOrderingEnabled":case"Microsoft.Office.AugLoop.EarlyJoinCompletionEnabled":return!1;case"Microsoft.Office.AugLoop.DeltaOperationsEnabled":return!0}return o(e,t)}),requestAuthToken:n(e.requestAuthToken,t)};var o}},12305:(e,t,o)=>{"use strict";o.d(t,{$A:()=>s,Gm:()=>r,uz:()=>a});var i=o(45455);if(3023==o.j)var n=o(2672);const r=e=>{if(e){try{return new URL(e),"/"===e[e.length-1]?e.substring(0,e.length-1):e}catch(e){}const t=e.split("/").filter((e=>0!==e.length));if(0!==t.length)return["/",t.join("/")].join("")}return e},s=(e,t)=>{var o,i,n,s,a,l;return((e,t)=>["/"===e?"":r(e),t].join("/"))((null===(n=null===(i=null===(o=e.serviceSettings)||void 0===o?void 0:o.hybridAugloop)||void 0===i?void 0:i.wasmConfig)||void 0===n?void 0:n.binaryPath)||(null===(l=null===(a=null===(s=e.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===a?void 0:a.wasmConfig)||void 0===l?void 0:l.scriptPath),t)},a=e=>{var t,o,r,s,a;const c=(0,n.e)(e);return{emailId:e.userId.email,puid:e.userId.puid,scenarios:[i.Nz.BIZ_CHAT,"PowerPoint"===(null===(t=e.hostMetadata)||void 0===t?void 0:t.appName)?i.Nz.COPILOT_POWERPOINT:i.Nz.WORKPLACE_SEARCH],tenantId:e.userId.tenantId,substrateAuthTokenType:l[e.userId.identityProvider],entityTypes:[],clientConfig:{getConfig:()=>c},prefetchOnly:!1,market:e.defaultLocale,useLocalFileRanker:null===(r=null===(o=e.serviceSettings)||void 0===o?void 0:o.hybridAugloop)||void 0===r?void 0:r.useLocalFileRanker,includeLoopFiles:null===(a=null===(s=e.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===a?void 0:a.includeLoopFiles}},l=[i.Xe.SUBSTRATE_MSA,i.Xe.SUBSTRATE_AAD]},94673:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{GraphSearchLocalAnnotationListener:()=>i.N,HybridModule:()=>n.p,graphSearchLocalOverrideHostCallbacks:()=>s.g,hostConfigToGraphConfig:()=>r.uz}),3023==o.j)var i=o(45036);if(3023==o.j)var n=o(72677);if(3023==o.j)var r=o(12305);if(3023==o.j)var s=o(53023)},64052:(e,t,o)=>{"use strict";if(o.d(t,{t:()=>u}),3023==o.j)var i=o(90935);if(3023==o.j)var n=o(86388);if(3023==o.j)var r=o(20399);if(3023==o.j)var s=o(60279);if(3023==o.j)var a=o(88200);if(3023==o.j)var l=o(29594);if(3023==o.j)var c=o(7094);class u{constructor(e,t){this._displayLanguage=e,this._stringProvider=t,this._defaultUiLocale="en-us",this._categoryNameToLocalizedName=new Map,this._localizationTableFallbackMapping=(0,c.mO)(),this._localizedNameToCategoryName=new Map,this._nonEditorCategories=new Set([s.s.Perspectives,s.s.TonalRewrite]),this.uiLocale="",this.isCategorySupportedInCurrentUiLanguage=e=>!!this._categoriesForUILocale&&e in this._categoriesForUILocale&&this._categoriesForUILocale[e].IsImplemented,this.setUiLocale(this._displayLanguage)}async setUiLocale(e){const t=e;this.uiLocale=t?t.toLowerCase():this._defaultUiLocale;const o=this._localizationTableFallbackMapping.get(this.uiLocale);if(o&&(this.uiLocale=o),this._categoriesForUILocale=await(0,a.oZ)(this.uiLocale),!this._categoriesForUILocale)throw Error(`Failed to load categories strings from localization file dynamically: ${this.uiLocale}`);this.cacheLocalizedCategories(this.uiLocale.toLowerCase(),this._categoriesForUILocale)}cacheLocalizedCategories(e,t){for(const o of Object.keys(t))this.cacheCategoryNames(o,t[o].LocalizedName,e)}get NonEditorCategories(){return this._nonEditorCategories}categoryNameToLocale(e,t){var o;const s=t.toLowerCase(),a=null===(o=this._categoryNameToLocalizedName.get(e))||void 0===o?void 0:o.get(s);if(a)return a;if(this._nonEditorCategories.has(e)){const t=this.localizeNonEditorCategoryNameToUiLocale(e);return this.cacheCategoryNames(e,t,s),t}return(0,i.C)().logEvent(571281556,"CategoryLocalizationNotFoundInLocalizationTable",n.h.Host,r.q.Error,{category:e,language:s}),e}toUiLocale(e){return this.categoryNameToLocale(e,this.uiLocale)}async localizedNameToStandardizedName(e,t){if(t===s.s.Spelling||t===s.s.Grammar||this.NonEditorCategories.has(t))return t;const o=this._localizedNameToCategoryName.get(t);if(o)return o;const i=await(0,a.oZ)(null!=e?e:this.uiLocale);if(i){const o=Object.keys(i).find((e=>{const o=i[e];return o&&o.LocalizedName===t}));if(o)return this.cacheCategoryNames(o,t,null!=e?e:this.uiLocale),o}const n=this.mapNonEditorCategoryNameToStandardizedName(t);return n?(this.cacheCategoryNames(n,t,this.uiLocale),n):t}cacheCategoryNames(e,t,o){const i=this._categoryNameToLocalizedName.get(e),n=null==i?void 0:i.get(o),r=this._localizedNameToCategoryName.get(t);if(!n)if(i)i.set(o,t);else{const i=new Map;i.set(o,t),this._categoryNameToLocalizedName.set(e,i)}r||this._localizedNameToCategoryName.set(t,e)}localizeNonEditorCategoryNameToUiLocale(e){var t;const o=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,i=o.getString.bind(o);switch(e){case s.s.Perspectives:return i("CritiqueCategoryStrings","Perspectives");case s.s.TonalRewrite:return i("CritiqueCategoryStrings","TonalRewrite");default:return e}}mapNonEditorCategoryNameToStandardizedName(e){var t;const o=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,i=o.getString.bind(o);switch(e){case i("CritiqueCategoryStrings","Perspectives"):return s.s.Perspectives;case i("CritiqueCategoryStrings","TonalRewrite"):return s.s.TonalRewrite;default:return e}}}},7094:(e,t,o)=>{"use strict";var i;o.d(t,{mO:()=>n}),function(e){e.CATALAN="ca",e.CATALANCATALAN="ca-es",e.CHINESE="zh",e.CHINESESIMPLIFIED="zh-hans",e.CHINESETRADITIONAL="zh-hant",e.ENGLISH="en",e.ENGLISH_AUSTRALIA="en-au",e.ENGLISH_CANADA="en-ca",e.ENGLISH_INDIA="en-in",e.ENGLISH_UNITEDKINGDOM="en-gb",e.ENGLISH_UNITEDSTATES="en-us",e.FRENCH="fr",e.FRENCH_CANADA="fr-ca",e.FRENCH_FRANCE="fr-fr",e.GERMAN="de",e.ITALIAN="it",e.JAPANESE="ja",e.PORTUGUESE="pt",e.SPANISH="es",e.SPANISH_MEXICO="es-mx",e.SPANISH_SPAIN="es-es",e.VALENCIAN="ca-es-valencia",e.RUSSIAN="ru",e.BRAZILIAN="br"}(i||(i={}));const n=()=>new Map([[i.ENGLISH_AUSTRALIA,i.ENGLISH_UNITEDSTATES],[i.ENGLISH_CANADA,i.ENGLISH_UNITEDSTATES],[i.ENGLISH_INDIA,i.ENGLISH_UNITEDSTATES],[i.ENGLISH_UNITEDKINGDOM,i.ENGLISH_UNITEDSTATES],[i.FRENCH_CANADA,i.FRENCH_FRANCE],[i.SPANISH_MEXICO,i.SPANISH_SPAIN]]);var r;!function(e){e.Goals="Goals"}(r||(r={}))},60279:(e,t,o)=>{"use strict";var i;o.d(t,{s:()=>i}),function(e){e.Clarity="Clarity",e.Conciseness="Conciseness",e.Formality="Formality",e.Grammar="Grammar",e.Inclusiveness="Inclusiveness",e.Perspectives="Perspectives",e.PunctuationConventions="Punctuation Conventions",e.Resume="Resume",e.SensitiveGeopoliticalReferences="Sensitive Geopolitical References",e.Spelling="Spelling",e.Vocabulary="Vocabulary",e.TonalRewrite="Tone",e.Synonyms="Synonyms",e.DistinctWords="DistinctWords",e.Readability="Readability",e.TimeToRead="TimeToRead",e.TimeToSpeak="TimeToSpeak",e.Similarity="SimilarityCategoryLevel",e.Goals="GoalsCard"}(i||(i={}))},88200:(e,t,o)=>{"use strict";if(o.d(t,{oZ:()=>l}),3023==o.j)var i=o(90935);if(3023==o.j)var n=o(86388);if(3023==o.j)var r=o(20399);if(3023==o.j)var s=o(89928);const a=new Map([["es-419","es-MX"]]);async function l(e,t=!1){var c;const u=null!==(c=a.get(e))&&void 0!==c?c:e,d=(0,i.C)();try{return await o(69108)(`./${u.toLowerCase()}.json`)}catch(o){try{if(!t){const t=e.split("-")[0];if(t in s.Y){const e=s.Y[t];return l(Array.isArray(e)?e[0]:e,!0)}}d.logEvent(0,"Diagnostics",n.h.Undefined,r.q.Error,`Failed to load categories strings for locale ${e} from localization file dynamically: ${o}`,void 0,void 0,void 0,"Text_Message")}catch(t){d.logEvent(0,"Diagnostics",n.h.Undefined,r.q.Error,`Failed to load neutral categories strings for locale ${e} from localization file dynamically: ${o}`,void 0,void 0,void 0,"Text_Message")}return}}},76785:(e,t,o)=>{"use strict";o.d(t,{r:()=>ze,h:()=>je});var i,n,r,s,a=o(95734),l=o(37842),c=o(8676),u=o(78376),d=o(87276),h=o(48338),g=o(80120),p=o(68023),f=o(70496),m=o(67971),v=o(38716),b=o(44680),y=o(23094),w=o(9420),C=o(3755),S=o(63666),k=o(18465),T=o(38331),x=o(89416),_=o(80470),I=(i=function(e){var t=e.semanticColors,o=e.fonts;return{body:[{color:t.bodyText,background:t.bodyBackground,fontFamily:o.medium.fontFamily,fontWeight:o.medium.fontWeight,fontSize:o.medium.fontSize,MozOsxFontSmoothing:o.medium.MozOsxFontSmoothing,WebkitFontSmoothing:o.medium.WebkitFontSmoothing}]}},n=new Map,r=new Set,s=function(e){var t=e.currentTarget,o=t.__id__;n.delete(o),t.removeEventListener("unload",s),r.delete(o)},function(e){void 0===e&&(e={});var t,o=e.theme,l=(0,k.ox)();l&&(l.__id__=l.__id__||(0,x.O)(),t=l.__id__,r.has(t)||(r.add(t),l.addEventListener("unload",s)));var c=(0,T.D)();o=o||c;var u=_.K.getId(),d=[t,u,o],h=function(e,t){var o,i,n,r=t[0],s=t[1],a=t[2];return null===(n=null===(i=null===(o=e.get(r))||void 0===o?void 0:o.get(s))||void 0===i?void 0:i.get(a))||void 0===n?void 0:n.classMap}(n,d);if(a.useEffect((function(){return function(e,t){var o,i,n=t[0],r=t[1],s=t[2],a=null===(i=null===(o=e.get(n))||void 0===o?void 0:o.get(r))||void 0===i?void 0:i.get(s);a&&a.refCount++}(n,[t,u,o]),function(){return function(e,t){var o,i,n,r,s,a,l,c,u=t[0],d=t[1],h=t[2],g=null===(i=null===(o=e.get(u))||void 0===o?void 0:o.get(d))||void 0===i?void 0:i.get(h);g&&(g.refCount--,0===g.refCount&&(null===(r=null===(n=e.get(u))||void 0===n?void 0:n.get(d))||void 0===r||r.delete(h),0===(null===(a=null===(s=e.get(u))||void 0===s?void 0:s.get(d))||void 0===a?void 0:a.size)&&(null===(l=e.get(u))||void 0===l||l.delete(d),0===(null===(c=e.get(u))||void 0===c?void 0:c.size)&&e.delete(u))))}(n,[t,u,o])}}),[t,u,o]),!h){var g=function(e){return"function"==typeof e}(i)?i(o):i;h=_.K.renderStyles(g,{targetWindow:l,rtl:!!o.rtl}),function(e,t,o){var i,n,r=t[0],s=t[1],a=t[2],l=null!==(i=e.get(r))&&void 0!==i?i:new Map;e.set(r,l);var c=null!==(n=l.get(s))&&void 0!==n?n:new Map;l.set(s,c),c.set(a,{classMap:o,refCount:0})}(n,d,h)}return h});var E=o(71571),B=o(73877),A=o(23401),R=o(28482),M=a.forwardRef((function(e,t){var o=function(e,t){var o=(0,A.N)(t,e);return(0,B.T)(o),{state:o,render:E.j}}(e,{ref:(0,R.a)(t,a.useRef(null)),as:"div",applyTo:"element"}),i=o.render,n=o.state;return function(e){var t=I(e),o=e.className,i=e.applyTo;!function(e,t){var o,i="body"===e.applyTo,n=null===(o=(0,k.ZY)())||void 0===o?void 0:o.body;a.useEffect((function(){if(i&&n){for(var e=0,o=t;e<o.length;e++){var r=o[e];r&&n.classList.add(r)}return function(){if(i&&n)for(var e=0,o=t;e<o.length;e++){var r=o[e];r&&n.classList.remove(r)}}}}),[i,n,t])}(e,[t.root,t.body]),e.className=(0,S.A)(o,t.root,"element"===i&&t.body)}(n),i(n)}));M.displayName="ThemeProvider";var D=o(44207),P=o(35240),F=o(85859),O=o(1585),N=o(4497),q=o(43713),j=o(13608),L=o(54651),z=o(51395);function H(e){return{background:{resting:e,disabled:"transparent"},border:"#D1D1D1",focusRing:"black",title:{resting:"transparent"}}}const W={marginHorizontal:16,marginTop:0,marginBottom:0},U={marginHorizontal:0,marginTop:2,marginBottom:0};z.R.Center;var G=o(77776),V=o(86399);function $(e){return{paddingHorizontal:L.QL,paddingVertical:9,backgroundColor:e.addOnFooterBackground}}function K(e,t,o){return{fontSize:t.xxsmall,fontFamily:G.V,cssColor:o?e.addOnAction:e.addOnFooterMessage,underlineType:o?V.RV.Single:V.RV.None,wrapMode:o?V.bd.NoWrap:V.bd.Normal}}function J(e){return e.premiumEmphasis}var Y=o(31127),Q=o(62989),Z=o(98848),X=o(6284),ee=o(7313),te=o(68803),oe=o(78585),ie=o(40732),ne=o(78607),re=o(56360),se=o(87962),ae=o(48545),le=o(87123),ce=o(5076),ue=o(16971),de=o(73543),he=o(67036),ge=o(58742),pe=o(87169),fe=o(33748),me=o(7869);class ve extends a.Component{constructor(e){super(e),this.firstSuggestionRef=a.createRef(),this.firstSuggestionButtonRef=a.createRef(),this.footerRef=a.createRef(),this.state={definition:e.definition}}setDefinition(e){this.setState({definition:e})}componentDidMount(){var e,t;null===(t=(e=this.props).onAfterUpdate)||void 0===t||t.call(e,this.state.definition)}componentDidUpdate(e,t){this.props.onAfterUpdate&&t.definition!==this.state.definition&&this.props.onAfterUpdate(this.state.definition),e.definition!==this.props.definition&&this.setState({definition:this.props.definition})}render(){var e,t,o;const{automationId:i,fontTable:n,layerHostId:r,onAction:s,settings:l,spacing:c,strings:u,style:d,theme:h}=this.props,g=L.uI(this.getTheme(),this.props.style,{useFluentV9:!!this.context});return a.createElement(ee.S,{style:g,align:te.j5.Stretch},this.renderHeader(),this.renderBody(),this.renderFooterTitle(),a.createElement(de.w,{automationId:i,layerHostId:r,definition:this.state.definition,theme:h,fontTable:n,spacing:c,style:d,strings:u,settings:l,onAction:s,overflowMenuCalloutStyle:null===(e=null==d?void 0:d.footerStyle)||void 0===e?void 0:e.overflowMenuCalloutStyle,footerContainerStyle:he.m$(null==d?void 0:d.footerStyle),footerButtonStyle:L.B7(null===(t=null==d?void 0:d.footerStyle)||void 0===t?void 0:t.buttonStyles),overflowMenuButtonStyle:L.B7(null===(o=null==d?void 0:d.footerStyle)||void 0===o?void 0:o.buttonStyles),ref:this.footerRef}),this.renderAddOnFooter())}focus(){var e;this.firstSuggestionRef.current?this.firstSuggestionRef.current.focus():this.firstSuggestionButtonRef.current?this.firstSuggestionButtonRef.current.focus():null===(e=this.footerRef.current)||void 0===e||e.focus()}executeBadgedAction(e){if(!this.props.onAction)return;const t=he.do(this.getDefinition(),this.props.strings),o={actionSourceId:Y.tR.VoiceDictationBadge,maxBadgeId:t.reduce(((e,t)=>Math.max(e,t.badgeId)),0)},i=t.filter((t=>t.badgeId===e));i.length>0?(o.executedBadgeId=i[0].badgeId,this.props.onAction(i[0].action,i[0].suggestionIndex,void 0,o)):this.props.onAction(Q._R.Dismiss,void 0,void 0,o)}getBooleanSetting(e){return!!this.props.settings&&"true"===this.props.settings[e]}getDefinition(){return this.state.definition}renderContext(e){if(!e.showContext||!e.contextText||!e.contextText.length)return null;const t=(0,Z.y)(this.props.strings.textFormatting,e.critiqueType,e.contextText,e.contextDecorations),o=he.xt(e,Q._R.ReadContext),i=o?Object.assign(Object.assign({},L.YV),{flexibleSize:!0}):L.YV,n=a.createElement(ee.S,{style:i,accessibleLive:te.pq.Polite},a.createElement(oe.c,{text:(0,X.EE)(e.contextText,ve.contextMaxLength),style:L.yl(this.getTheme(),this.getFontTable()),formatting:(0,ie.S)(e.contextText.length,this.getTheme(),e.contextDecorations),accessibilityLabel:t}));if(!o)return n;const r=this.getBooleanSetting("NoTooltipForReadContext")?void 0:he.a4(e,this.props.strings,Q._R.ReadContext);return a.createElement(ee.S,{direction:te.PR.LeftToRight,align:te.j5.Center},n,he.o2(this.getDefinition(),this.getTheme(),Q._R.ReadContext,L.Bd(this.getFontTable()),this.props.strings,{action:"readcontext",context:t||e.contextText},void 0,void 0,r,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,void 0,void 0,void 0,void 0,this.props.layerHostId))}getCardHeaderText(){var e,t,o,i;const n=this.getDefinition();let r;switch(n.critiqueType){case Q.L9.Classification:r=this.props.strings.critique("sensitiveContentCardHeader");break;case Q.L9.Spelling:case Q.L9.RepeatedWord:r=this.props.strings.critique("spellingCardHeader");break;case Q.L9.Grammar:r=this.props.strings.critique("grammarCardHeader");break;case Q.L9.NeuralRewrite:r=this.getBooleanSetting("renderNRForAIFeedback")?void 0:this.props.strings.critique("neuralRewriteCardHeader");break;case Q.L9.SimilarityChecker:r=this.props.strings.critique("similarityCheckerCardHeader");break;case Q.L9.TonalRewrite:r=this.props.strings.critique("tonalRewriteCardHeader");break;case Q.L9.AccColorChecker:r=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerCardHeader");break;case Q.L9.TextPenAlternates:r=null===(i=(o=this.props.strings).textPenAlternates)||void 0===i?void 0:i.call(o,"textPenAlternatesGroupTitle");break;default:r=this.props.definition.header}return n.showDictationCommandUx&&!r&&(r=this.props.strings.critique("dictationCorrectionsGroupTitle")),r}getCardSubheaderText(){var e,t;const o=this.getDefinition();let i;switch(o.critiqueType){case Q.L9.Spelling:i=void 0;break;case Q.L9.RepeatedWord:i=this.props.strings.critique("repeatedWordCardSubheader");break;case Q.L9.NeuralRewrite:i=this.getBooleanSetting("renderNRForAIFeedback")?this.props.strings.critique("aIFeedbackCardSubHeader"):this.props.strings.critique("neuralRewriteCardSubheader");break;case Q.L9.SimilarityChecker:i=this.props.strings.critique("similarityCheckerCardSubheader");break;case Q.L9.AccColorChecker:i=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerCardSubheader");break;default:i=o.subheader}return o.showDictationCommandUx&&!i&&(i=this.props.strings.critique("dictationCorrectionCommandCardTitle")),i}renderPreviewMarker(){return a.createElement(oe.c,{text:this.props.strings.critique("previewHeaderLabel"),style:L.HV(this.getTheme(),this.getFontTable())})}renderCardHeader(e){const t=e.critiqueType===Q.L9.NeuralRewrite||e.critiqueType===Q.L9.SimilarityChecker||e.critiqueType===Q.L9.TonalRewrite?this.renderPreviewMarker():void 0,o=this.getCardHeaderText(),i=o?a.createElement(oe.c,{text:o,style:L.k(this.getTheme(),this.getFontTable(),{useFluentV9:!!this.context}),accessibilityRole:"heading"}):null,n=i?this.getDefinition().showPremiumIcon?a.createElement(ee.S,{direction:te.PR.LeftToRight},a.createElement(ne.E,{type:"PremiumDiamond",primaryColor:this.getTheme().header}),a.createElement(ee.S,{style:{minWidth:6}}),i):i:null;return t?a.createElement(ee.S,{align:te.j5.Stretch,direction:te.PR.LeftToRight},n,a.createElement(ee.S,{style:{flexibleSize:!0,minWidth:16}}),t):n}renderCardFooterTitle(e){return e.showDictationCommandUx&&this.props.strings.critique("dictationSpelloutCommandCardTitle"),null}renderCardSubheader(){const e=this.getCardSubheaderText();return e?a.createElement(oe.c,{text:e,style:L.GP(this.getTheme(),this.getFontTable(),{useFluentV9:!!this.context}),accessibilityRole:"heading"}):null}renderHeader(){const e=this.getDefinition();return a.createElement(ee.S,{style:L.WC,align:te.j5.Stretch},this.renderCardHeader(e),this.renderCardSubheader(),this.renderContext(e))}shouldShowSuggestionDescription(e){return he.eS(this.getDefinition(),Q._R.Accept,e)&&this.getDefinition().showDescription&&e.subtitle&&e.subtitle.length>0}getSuggestionButtonProps(e,t,o,i){const n=this.getDefinition(),r=this.getSuggestionButtonKind(n.critiqueType,e),s=n.critiqueType===Q.L9.Topic?`#${e.title}`:e.title,a=s.length,l=he.t$(n,o,e),c=he.EH(n,this.props.strings,this.getTheme(),l,o,t),u=n.critiqueType===Q.L9.RepeatedWord,d=void 0!==i?{type:i,filled:u}:void 0,h={title:s,titleStyle:void 0!==r&&o!==Q._R.MoreSources?L.D0(this.getFontTable(),a):(0,ie.S)(a,this.getTheme(),e.titleDecorations),tag:e.tag,tagStyle:L.RU(this.getFontTable()),icon:d,disabled:l,onClick:()=>{var e,i;null===(i=(e=this.props).onAction)||void 0===i||i.call(e,o,t)},theme:n.critiqueType===Q.L9.RepeatedWord?L.P4(this.getTheme(),r,!0):L.P4(this.getTheme(),r),strings:he.Eh(this.props.strings.common),accessibilityRole:"menuitem",accessibilityLabel:this.getSuggestionAccessibilityLabel(e),automationLabel:"CritiqueSuggestionButton_"+e.id,badgeProps:c};return this.shouldShowSuggestionDescription(e)&&(h.subtitle=e.subtitle,h.subtitleStyle=L.qw(this.getFontTable())),h}getSuggestionButtonKind(e,t){if(!(t.titleDecorations&&t.titleDecorations.length>0))switch(e){case Q.L9.Grammar:return"grammar";case Q.L9.Refinement:case Q.L9.Topic:return"refinement";default:return"suggestion"}}getSuggestionAccessibilityLabel(e){const t=this.getDefinition(),o=e.tagAccessibilityLabel||e.tag||"";return t.critiqueType!==Q.L9.Spelling&&t.critiqueType!==Q.L9.NeuralRewrite||!t.showDescription||!e.subtitle||0===e.subtitle.trim().length?o?this.props.strings.critique("suggestionWithTagAccessibilityLabel").replace("{0}",o).replace("{1}",e.title):void 0:o&&t.critiqueType===Q.L9.Spelling?this.props.strings.critique("spellingSuggestionTagAndDescriptionAccessibilityLabel").replace("{0}",o).replace("{1}",e.title).replace("{2}",e.subtitle):(t.critiqueType===Q.L9.Spelling?this.props.strings.critique("spellingSuggestionDescriptionAccessibilityLabel"):this.props.strings.critique("neuralRewriteSuggestionAccessibilityLabel")).replace("{0}",e.title).replace("{1}",e.subtitle)}renderButtonSuggestion(e,t,o,i,n){return a.createElement(re.J,Object.assign({key:e,ref:t},o,{style:L.kw,strings:he.Hz(this.props.strings.common),accessibilityPositionInSet:void 0!==i?i:1,accessibilitySetSize:void 0!==n?n:1}))}renderSingleSuggestion(e,t,o,i,n,r,s,a){return[this.renderButtonSuggestion(e,o,this.getSuggestionButtonProps({title:t,actions:n?[]:[i]},e,i,r),s,a)]}renderActionListAsSuggestions(e){const t=this.getDefinition();return e.filter((e=>he.a4(t,this.props.strings,e))).map(((e,o,i)=>this.renderSingleSuggestion(o,he.a4(t,this.props.strings,e),0===o?this.firstSuggestionRef:void 0,e,void 0,he.g$(e),o+1,i.length)[0]))}renderSpecialSuggestions(e,t){return e.critiqueType===Q.L9.RepeatedWord?this.renderSingleSuggestion(0,this.props.strings.critique("deleteRepeatedWord"),this.firstSuggestionRef,t[0],!1,"Delete"):e.critiqueType===Q.L9.SimilarityChecker?this.renderActionListAsSuggestions(t):[a.createElement(se.v,{key:0,shimmerCount:L.Wi,styles:L.B8(this.getSpacing()),render:()=>{const e=this.renderSingleSuggestion(0,this.props.strings.common("suggestionsGroupLoadingSuggestionsText"),void 0,Q._R.Accept,!0);return e.length>0?e[0]:null}})]}renderSuggestions(){const e=this.getDefinition(),t=he.zh(e,this.props.strings);if(t)return this.renderSpecialSuggestions(e,t);const o=he.KW(e),i=o.map(((t,i)=>{const n=this.getSuggestionIcon(e.critiqueType,t,o.length),r=this.renderButtonSuggestion(i,0===i?this.firstSuggestionRef:void 0,this.getSuggestionButtonProps(t,i,Q._R.Accept,n),i+1,o.length);return i>0&&t.tag!==o[i-1].tag?a.createElement(a.Fragment,null,a.createElement(ae.w,{key:i,color:this.props.theme&&this.props.theme.separator,style:L.cK}),r):r}));return 0===i.length?this.renderSingleSuggestion(0,e.critiqueType===Q.L9.NeuralRewrite?this.props.strings.critique("neuralRewriteNoSuggestionsText"):this.props.strings.common("suggestionsGroupNoSuggestionsText"),void 0,Q._R.Accept,!0):i}getSuggestionIcon(e,t,o){return e===Q.L9.Classification&&1===o?"Delete":e===Q.L9.Grammar&&this.props.critiqueSource===Y.UD.Inference?"Cloud":e!==Q.L9.NeuralRewrite||he.eS(this.getDefinition(),Q._R.Accept,t)?void 0:"Info"}renderSourceUrlAsHyperlink(e,t){return a.createElement(le.R,{url:e,theme:L.ki(this.getTheme()),style:L.eO(this.getFontTable()),text:t})}renderSourceUrlAsText(e){return a.createElement(oe.c,{text:e,style:L.lb(this.getTheme(),this.getFontTable())})}renderSource(){const e=this.getDefinition(),t=this.props.sourceIndex||0;if(!e.sources)return;const o=e.sources[t].sourceUrl,i=e.sources[t].sourceTitle;if(!o||!i)return;const n=(0,X.SE)(o);return a.createElement(ee.S,{style:L.ID,align:te.j5.Stretch},a.createElement(oe.c,{text:i,style:L.F6(this.getFontTable(),this.getTheme())}),a.createElement(ee.S,{direction:te.PR.LeftToRight,align:te.j5.Baseline},a.createElement(ee.S,{direction:te.PR.LeftToRight,align:te.j5.Baseline,style:{flexibleSize:!0}},e.sourceUrlClickable?this.renderSourceUrlAsHyperlink(o,n):this.renderSourceUrlAsText(n)),a.createElement(oe.c,{text:this.props.strings.critique("poweredByBing"),style:L.Ps(this.getFontTable())})))}generateButtonProps(e,t,o){return{onClick:()=>{this.props.onAction&&this.props.onAction(Q._R.ApplyColor,o)},hoverRing:!0,style:{width:32,height:32,borderRadius:2,marginEnd:8,borderThickness:2},theme:H(e),automationLabel:`ColorPickerButton_${this.props.automationId}`,tooltip:t,tooltipProps:{layerHostId:this.props.layerHostId}}}renderColors(){var e,t,o;const i=(this.getDefinition().suggestions||[]).map(((e,t)=>a.createElement(re.J,Object.assign({key:e.id,ref:0===t?this.firstSuggestionButtonRef:void 0},this.generateButtonProps(e.title,e.subtitle,t)))));return a.createElement(ee.S,{align:te.j5.Start,justifyContent:te.Pr.Start,style:W},a.createElement(oe.c,{text:null!==(o=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerSecondCardSubheader"))&&void 0!==o?o:"",style:L.qL(this.getTheme(),this.getFontTable()),accessibilityRole:"heading"}),a.createElement(ee.S,{direction:te.PR.LeftToRight,align:te.j5.Start,justifyContent:te.Pr.Start,style:U},i))}renderHelpLink(){const e=this.getDefinition();if(e.helpLink)return a.createElement(ee.S,{direction:te.PR.LeftToRight,style:L.cq,align:te.j5.Stretch},a.createElement(le.R,{text:e.helpLink.text,url:e.helpLink.url,theme:L.dG(this.getTheme()),style:L.ej(this.getFontTable())}))}getCustomSuggestions(){return(0,me.Z)(this.props)?this.props.getCustomSuggestions?this.props.getCustomSuggestions(this.props,void 0):void 0:this.props.customSuggestions?this.props.customSuggestions:this.props.definition.critiqueType===Q.L9.Grammar?function(e,t){var o;const i=Object.assign(Object.assign(Object.assign({},e),(0,pe.m)(e,void 0)),{definition:Object.assign(Object.assign({},e.definition),{header:e.strings.critique("grammarCardHeader")}),suggestionOverflowActions:[Q._R.Accept,Q._R.ReadAloud,Q._R.SpellOut],suggestionKind:()=>"grammar",suggestionIcon:()=>e.critiqueSource===Y.UD.Inference?"Cloud":void 0});if((0,me.Z)(e))i.getCustomSuggestions=(0,fe.Q)(e.definition)?fe.oN:void 0;else{const t=a.createRef(),n=null!=e.definition.showAIRewriteNudgeForCritiqueType&&e.definition.showAIRewriteNudgeForCritiqueType.length>0&&e.definition.showAIRewriteNudgeForCritiqueType.includes(e.definition.critiqueType);i.customSuggestions=n?a.createElement(fe.Yi,Object.assign({},i,{ref:null!==(o=i.firstSuggestionRef)&&void 0!==o?o:t})):void 0}return i}(this.props).customSuggestions:this.props.definition.critiqueType===Q.L9.Refinement?function(e,t){var o;const i=Object.assign(Object.assign(Object.assign({},e),(0,pe.m)(e,void 0)),{suggestionOverflowActions:[Q._R.Accept,Q._R.ReadAloud,Q._R.SpellOut],suggestionKind:()=>"refinement"});if((0,me.Z)(e))i.getCustomSuggestions=(0,fe.Q)(e.definition)?fe.oN:void 0;else{const t=a.createRef(),n=null!=e.definition.showAIRewriteNudgeForCritiqueType&&e.definition.showAIRewriteNudgeForCritiqueType.length>0&&e.definition.showAIRewriteNudgeForCritiqueType.includes(e.definition.critiqueType);i.customSuggestions=n?a.createElement(fe.Yi,Object.assign({},i,{ref:null!==(o=i.firstSuggestionRef)&&void 0!==o?o:t})):void 0}return i}(this.props).customSuggestions:this.props.customSuggestions}renderBodySuggestions(){const e=this.getDefinition(),t=this.getCustomSuggestions(),o=e.critiqueType!==Q.L9.SimilarityChecker?this.props.strings.critique("suggestionsGroupAccessibilityLabel"):void 0,i=null!=t?t:this.renderSuggestions();return(0,ge.R2)()?a.createElement(ee.S,{align:te.j5.Stretch,accessible:!1},i):a.createElement(ee.S,{align:te.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:o},i)}renderBody(){const e=this.getDefinition();return a.createElement(ee.S,{align:te.j5.Stretch},e.critiqueType===Q.L9.SimilarityChecker?this.renderSource():void 0,a.createElement(ce.R,{disableInitialFocus:!0},e.critiqueType===Q.L9.AccColorChecker?this.renderColors():this.renderBodySuggestions()),this.renderHelpLink())}renderFooterTitle(){const e=this.getDefinition(),t=this.renderCardFooterTitle(e);return t?a.createElement(ee.S,{style:L.WC,align:te.j5.Stretch},t):null}renderAddOnFooter(){if(!this.props.addOnFooterData)return null;const{addOnFooterData:e}=this.props,t={onClick:()=>{var e,t;null===(t=(e=this.props).onAction)||void 0===t||t.call(e,Q._R.AddOnFooterAction)},style:L.Oc,theme:(o=this.getTheme(),{background:{resting:"transparent"},title:{resting:o.addOnAction||o.background.resting}}),automationLabel:`AddonFooterButton_${e.actionText}_${this.props.automationId}`};var o,i;return a.createElement(ee.S,{style:$(this.getTheme()),direction:te.PR.LeftToRight,align:te.j5.Center,accessible:!0,accessibilityLabel:e.message},e.icon&&a.createElement(a.Fragment,null,a.createElement(ne.E,{type:e.icon,primaryColor:J(this.getTheme()),fontSize:(i=this.getFontTable(),i.xsmall)}),a.createElement(ee.S,{style:{width:8}})),this.getAddOnFooterFormattedText(),a.createElement(ee.S,{style:{width:4}}),a.createElement(re.J,Object.assign({},t),a.createElement(oe.c,{text:e.actionText,style:K(this.getTheme(),this.getFontTable(),!0)})))}getAddOnFooterFormattedText(){if(!this.props.addOnFooterData)return;const{addOnFooterData:e}=this.props;return a.createElement(oe.c,{text:e.message,style:K(this.getTheme(),this.getFontTable(),!1),formatting:e.footerDecorations?(0,ie.S)(e.message.length,this.getTheme(),e.footerDecorations):void 0})}getTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:this.context?L.ol:L.vy}getFontTable(){return this.props.fontTable?this.props.fontTable:L.d4}getSpacing(){return this.props.spacing?this.props.spacing:L.lT}}ve.contextMaxLength=120,ve.contextType=ue.O;const be={primaryButtonBackground:{resting:"#0078D4",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9"},defaultButtonText:{resting:"#201F1E",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",primaryButtonFocusRing:"#969696",backgroundColor:"#FFFFFF",link:"#1651AA",titleColor:"#201F1E",descriptionColor:"#605E5C",rejectionTextColor:"#201F1E",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#DEECF9",dismissButtonColor:"#000000"},ye={marginHorizontal:16,marginTop:12},we={marginBottom:16,marginTop:16},Ce={marginBottom:16,marginTop:8},Se={marginVertical:12,marginStart:16,maxWidth:236},ke={paddingVertical:5,textAlign:z.R.Center,borderRadius:2,borderThickness:1},Te={paddingHorizontal:0,paddingVertical:0};function xe(e,t){return{fontSize:14,lineHeight:20,fontFamily:G.V,cssColor:t?null==e?void 0:e.link:null==e?void 0:e.rejectionTextColor,underlineType:t?V.RV.Single:V.RV.None,wrapMode:t?V.bd.NoWrap:V.bd.Normal}}function _e(e,t){return{fontFamily:G.V,fontSize:12,lineHeight:t?12:16,cssColor:t?null==e?void 0:e.titleColor:null==e?void 0:e.descriptionColor,fontWeight:t?V.IT.SemiBold:V.IT.Normal}}function Ie(e,t){return{background:t?e.primaryButtonBackground:e.defaultButtonBackground,title:t?e.primaryButtonText:e.defaultButtonText,border:t?e.primaryBorder:e.defaultBorder,focusRing:t?e.primaryButtonFocusRing:e.defaultButtonFocusRing}}function Ee(e){return{background:{resting:e.backgroundColor},title:{resting:e.link},focusRing:e.defaultButtonFocusRing}}function Be(e){return{background:{resting:e.backgroundColor},title:{resting:e.dismissButtonColor},focusRing:e.defaultButtonFocusRing}}const Ae={iconFontWeight:V.IT.SemiBold,iconFontSize:12,paddingHorizontal:8,paddingVertical:8,textAlign:z.R.Center};var Re,Me=o(71418);!function(e){e[e.Default=0]="Default",e[e.RejectMessage=1]="RejectMessage"}(Re||(Re={}));class De extends a.Component{constructor(e){super(e),this.acceptButtonRef=a.createRef(),this.showSettingsButtonRef=a.createRef(),this.state={tonalFirstRunState:Re.Default},this.onAccept=this.onClickAction.bind(this,Me.h.Accept),this.onIgnore=this.onClickAction.bind(this,Me.h.Ignore),this.onReject=this.onClickAction.bind(this,Me.h.Reject),this.onOpenEditorSettings=this.onClickAction.bind(this,Me.h.OpenEditorSettings),this.onDismissRejectMessage=this.onClickAction.bind(this,Me.h.DismissRejectMessage)}componentDidUpdate(e,t){if(t.tonalFirstRunState!==this.state.tonalFirstRunState)switch(this.state.tonalFirstRunState){case Re.Default:this.acceptButtonRef.current&&this.acceptButtonRef.current.focus();break;case Re.RejectMessage:this.showSettingsButtonRef.current&&this.showSettingsButtonRef.current.focus()}}render(){return this.state.tonalFirstRunState===Re.RejectMessage?this.renderRejectionMessageCard():this.renderFreCard()}renderFreCard(){return a.createElement(ee.S,{direction:te.PR.LeftToRight,align:te.j5.Start,style:(e=this.theme,{backgroundColor:null==e?void 0:e.backgroundColor,minWidth:292})},this.renderNewFeatureIcon(),a.createElement(ee.S,null,this.renderText(),this.renderButtons()));var e}renderNewFeatureIcon(){var e,t;return a.createElement(ee.S,{style:ye},a.createElement(ne.E,{type:"NewFeature",primaryColor:this.context?"var(--editorTonalFreCardIconPrimaryColor, var(--colorPaletteBlueBackground2))":null===(e=this.theme)||void 0===e?void 0:e.iconPrimaryColor,secondaryColor:this.context?"var(--editorTonalFreCardIconSecondaryColor, var(--colorPaletteBlueBorderActive))":null===(t=this.theme)||void 0===t?void 0:t.iconSecondaryColor}))}renderText(){const{strings:e}=this.props;return a.createElement(ee.S,{style:we},a.createElement(ee.S,{direction:te.PR.TopToBottom,justifyContent:te.Pr.SpaceBetween,style:{maxWidth:184}},a.createElement(ee.S,{style:{marginBottom:4}},a.createElement(oe.c,{text:e.cardTitle,style:_e(this.theme,!0),accessibilityRole:"heading"})),a.createElement(oe.c,{text:e.textDescription,style:_e(this.theme,!1),accessibilityRole:"text"})))}renderButtons(){const{strings:e,automationId:t}=this.props;return a.createElement(ee.S,null,a.createElement(ee.S,{align:te.j5.Baseline,direction:te.PR.LeftToRight},a.createElement(ee.S,{style:{marginEnd:6}},this.renderAnswerButton(e.acceptButtonText,this.onAccept,!0)),this.renderAnswerButton(e.ignoreButtonText,this.onIgnore,!1)),a.createElement(ee.S,{style:Ce},this.context?a.createElement(le.R,{text:e.rejectLinkText,onClick:this.onReject,style:{fontSize:10,fontWeight:V.IT.Normal,underlineType:V.RV.Single}}):a.createElement(re.J,{onClick:this.onReject,style:Te,theme:void 0===this.theme?void 0:Ee(this.theme),automationLabel:`TonalFirstRunLinkButton_${t}`},a.createElement(oe.c,{text:e.rejectLinkText,style:(o=this.theme,{fontSize:10,lineHeight:12,fontFamily:G.V,cssColor:null==o?void 0:o.link,underlineType:V.RV.Single,wrapMode:V.bd.NoWrap})}))));var o}renderAnswerButton(e,t,o){const i=o?"Primary":"Default";return a.createElement(re.J,{ref:o?this.acceptButtonRef:void 0,title:e,titleStyle:(n=e.length,[{start:0,length:n,fontWeight:V.IT.SemiBold,fontFamily:G.V,fontSize:12,lineHeight:16}]),onClick:t,appearance:o?"primary":"secondary",theme:void 0===this.theme?void 0:Ie(this.theme,o),disabled:!1,style:ke,automationLabel:`TonalFirstRunAnswerButton_${i}_${this.props.automationId}`});var n}renderRejectionMessageCard(){const{strings:e,automationId:t}=this.props;return a.createElement(ee.S,{direction:te.PR.LeftToRight,align:te.j5.Start,style:(o=this.theme,{backgroundColor:null==o?void 0:o.backgroundColor})},a.createElement(ee.S,{align:te.j5.Baseline,style:Se,direction:te.PR.TopToBottom},a.createElement(oe.c,{text:e.rejectionMessage,style:xe(this.theme,!1),accessibilityRole:"text"}),this.context?a.createElement(le.R,{text:e.editorSettingsText,onClick:this.onOpenEditorSettings,style:{fontSize:14,fontWeight:V.IT.Normal,underlineType:V.RV.Single}}):a.createElement(re.J,{ref:this.showSettingsButtonRef,onClick:this.onOpenEditorSettings,style:Te,theme:void 0===this.theme?void 0:Ee(this.theme),automationLabel:`OpenEditorSettings_${t}`},a.createElement(oe.c,{text:e.editorSettingsText,style:xe(this.theme,!0)}))),a.createElement(re.J,{automationLabel:`DismissRejectMessage_${t}`,icon:{type:"Cancel"},onClick:this.onDismissRejectMessage,appearance:"subtle",theme:void 0===this.theme?void 0:Be(this.theme),style:Ae,accessibilityLabel:e.dissmissButtonAccessibilityLabel}));var o}onClickAction(e){e===Me.h.Reject&&this.setState({tonalFirstRunState:Re.RejectMessage}),this.props.onClickAction(e)}get theme(){var e;return this.context?void 0:null!==(e=this.props.theme)&&void 0!==e?e:be}}De.contextType=ue.O;var Pe=o(31892),Fe=o(18322);let Oe;var Ne=o(4984);const qe="editor-critique-card-id",je=(0,l.F5)({store:c.A.on(d.v),footerFREStore:c.A.on(h.D).optional(),themeStore:c.A.on(j.YQ).optional(),localizer:c.A.on(v.H),calloutDismissalHandler:c.A.on(g.J).optional(),styleStore:c.A.on(j.UC).optional(),hostSettings:c.A.on(b.n)});class Le extends a.Component{constructor(e){super(e),this.hasPositioned=!1,this.critiqueCalloutRef=a.createRef(),this.handleKeyDown=e=>{var t;this.store.isVisible&&(e.key===N.m.arrowDown||e.key===N.m.arrowUp?(e.stopPropagation(),e.preventDefault(),null===(t=this.critiqueCalloutRef.current)||void 0===t||t.focus()):"Escape"===e.key&&this.dismiss())},this.renderCallout=()=>a.createElement("div",null,a.createElement(M,Object.assign({},null!=Oe?Oe:Oe={settings:{theme:(0,Pe.I)((0,Fe.a)())},scopedSettings:{}}),this.renderSharedCallout())),this.emitClick=e=>{const t=new MouseEvent("click",{clientX:e.clientX,clientY:e.clientY});window.document.documentElement.dispatchEvent(t)},this.onAfterRender=()=>{var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),null===(t=this.documentEventListener)||void 0===t||t.addListener("contextmenu",this.emitClick,{capture:!0}),this.parentElement||(this.parentElement=this.store.getParentElement()),this.parentElement&&!this.parentElementEventListener&&(this.parentElementEventListener=new y.J(this.parentElement),this.parentElementEventListener.addListener("keydown",this.handleKeyDown)),this.store.afterRender()},this.dismiss=()=>{var e;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.store.clickNoActionHide()},this.renderTonalFreCard=()=>{const{themeStore:e,localizer:t}=this.props.deps,{onTonalFreAction:o}=this.store,i=null==e?void 0:e.getComponentActiveTheme(j.yF.tonalFreComponentName);if(i){let t;const o=null==e?void 0:e.getComponentThemes(j.yF.tonalFreComponentName),n=new q.CJ;o&&(n.isHighContrastWhite?t=o.get(j.SV.light):n.isHighContrastBlack&&(t=o.get(j.SV.dark)),t&&(i.iconPrimaryColor=t.highContrast.iconPrimaryColor,i.iconSecondaryColor=t.highContrast.iconSecondaryColor))}return a.createElement(De,{automationId:"tonal_fre_card",onClickAction:o,strings:{cardTitle:t.getMessage("ebx_tonalFreTitle"),textDescription:t.getMessage("ebx_tonalFreDescription"),acceptButtonText:t.getMessage("ebx_tonalFreAcceptButton"),ignoreButtonText:t.getMessage("ebx_tonalFreIgnoreButton"),rejectLinkText:t.getMessage("ebx_tonalFreRejectButton"),rejectionMessage:t.getMessage("ebx_tonalFreRejectMessage"),editorSettingsText:t.getMessage("ebx_tonalFreOpenEditorSettings"),dissmissButtonAccessibilityLabel:t.getMessage("ebx_tonalFreDismissButtonAccessibilityLabel")},theme:i})},this.renderSharedCard=()=>{var e,t;const{deps:o}=this.props,{footerFREStore:i,themeStore:n,styleStore:r,hostSettings:s}=o,{addOnFooterData:l,critiqueSource:c,critiqueType:u,calloutCategory:d,calloutTitle:g,suggestionsToRender:m,showSynonyms:v,dropDownActions:b,navInfo:y,brandingMode:w,explanation:C,explanationTitle:S,onCalloutAction:k,settings:T,isUpsell:x}=this.store,_=null==n?void 0:n.getComponentActiveTheme(j.iN.critiqueCalloutComponentName),I=null==r?void 0:r.getComponentStyle(j.iN.critiqueCalloutComponentName),E=null==r?void 0:r.getComponentStyle(j.iN.footerFreComponentName),B=null===(t=null===(e=s.serviceSettings)||void 0===e?void 0:e.multilingual)||void 0===t?void 0:t.hideFooterFreIcon;_&&x&&(_.addOnFooterBackground=_.upsellFooterColor);const A=null==i?void 0:i.footerProps.get(h.Y.critique);return a.createElement(p.d.Consumer,null,(e=>{var t,o,i,n;return a.createElement(a.Fragment,null,a.createElement(ve,{ref:this.critiqueCalloutRef,addOnFooterData:(null==A?void 0:A.display)?void 0:l,automationId:"browser_extension",critiqueSource:c,definition:{definitionType:"CritiqueDefinition",critiqueType:u,header:d,subheader:g,contextText:void 0,contextDecorations:void 0,suggestions:m,maximumSuggestions:m.length,showContext:!1,showDescription:v,actions:b,critiqueSetSize:y?(0,f.v)(y).length:void 0,critiquePosition:null==y?void 0:y.currentIndex,brandingMode:w,explanation:C,explanationTitle:S},onAction:k,onAfterUpdate:this.onAfterRender,settings:T,strings:this.getLocalizedSharedStrings(),style:Object.assign(Object.assign({},I),{minWidth:null!==(t=null==I?void 0:I.minWidth)&&void 0!==t?t:300,maxWidth:null!==(o=null==I?void 0:I.maxWidth)&&void 0!==o?o:420,hasBottomAttachment:(null==A?void 0:A.display)&&!A.pages.size}),theme:_,layerHostId:e}),a.createElement(O.b,{target:h.Y.critique,styles:{container:Object.assign({borderRadius:{topStart:0,topEnd:0,bottomStart:2,bottomEnd:2},minWidth:null!==(i=null==I?void 0:I.minWidth)&&void 0!==i?i:300,maxWidth:null!==(n=null==I?void 0:I.maxWidth)&&void 0!==n?n:420},null==E?void 0:E.container),dismissContainerStyle:null==E?void 0:E.dismissContainerStyle,textContainerStyle:null==E?void 0:E.textContainerStyle},hideIcon:B}))}))},this.renderSharedCallout=()=>{var e,t,o;const{localizer:i,themeStore:n}=this.props.deps,{target:r,setInitialFocus:s,shouldShowTonalFre:l,gapSpace:c,styles:u}=this.store,d=null==n?void 0:n.getComponentActiveTheme(j.yF.critiqueCalloutComponentName);if(!0!==this.context){const o=(0,D.Zq)(null===(e=u.calloutMain)||void 0===e?void 0:e.root,{marginLeft:this.state.marginLeft,marginRight:this.state.marginRight,border:(null===(t=null==d?void 0:d.callout)||void 0===t?void 0:t.borderColor)?`1px solid ${d.callout.borderColor}`:void 0});return a.createElement(p.U,{id:qe,className:"ms-critique-callout","aria-label":i.getMessage("ebx_brandText"),calloutMaxWidth:450,doNotLayer:!1,gapSpace:c,isBeakVisible:!1,onDismiss:this.dismiss,onPositioned:e=>{e&&!this.hasPositioned&&(this.hasPositioned=!0,e.alignmentEdge===P.x.left?e.elementPosition.left?this.setState({marginLeft:-15,marginRight:0}):this.setState({marginLeft:0,marginRight:15}):e.alignmentEdge===P.x.right?e.elementPosition.left?this.setState({marginLeft:15,marginRight:0}):this.setState({marginLeft:0,marginRight:-15}):this.setState({marginLeft:0,marginRight:0}))},role:"dialog",target:(0,w.KV)(r),preventDismissOnLostFocus:!1,preventDismissOnEvent:this.onPreventDismissCalloutOnEvent,styles:Object.assign(Object.assign({},u.calloutMain),{root:o})},a.createElement(F.Y,{disableFirstFocus:!s,isClickableOutsideFocusTrap:!0},l?this.renderTonalFreCard():this.renderSharedCard()))}{const e=e=>void 0!==(null==e?void 0:e.key),t={moveFocusIntoModalizer:!0,popover:{unstable_disableAutoFocus:!0,trapFocus:!0,withArrow:!1,open:this.store.isVisible,onOpenChange:(t,o)=>{if((o.open||!this.onPreventDismissCalloutOnEvent(t))&&!o.open){const o=t.nativeEvent;e(o)&&"Escape"===o.key&&this.store.restoreCaretToPreviousPosition(),this.dismiss()}},positioning:{target:(0,w.ug)(r),align:"start",position:"below",offset:e=>({mainAxis:c,crossAxis:"start"===e.alignment?-15:0})},ariaLabel:this.store.ariaLabelToReadWhenCardIsOpened},surface:{className:"ms-critique-callout",style:Object.assign({padding:0,maxWidth:450,border:(null===(o=null==d?void 0:d.callout)||void 0===o?void 0:o.borderColor)?`1px solid ${d.callout.borderColor}`:void 0},u.calloutV9)}};return a.createElement(a.Fragment,null,a.createElement("div",{id:qe,"aria-live":"polite","aria-label":this.store.ariaLabelToReadWhenCardIsOpened}),a.createElement(m.v,Object.assign({},t),l?this.renderTonalFreCard():this.renderSharedCard()))}},this.onPreventDismissCalloutOnEvent=e=>{const{deps:t}=this.props,{calloutDismissalHandler:o}=t;if(o&&!o.shouldDismissCallout(e,"CritiqueCallout",void 0))return!0;if("click"===e.type){const t=this.store.target;if((0,C.C)(t,"HTMLElement")){if(i=t.getBoundingClientRect(),n=e.pageX,r=e.pageY,i.x<=n&&n<=i.x+i.width&&i.y<=r&&r<=i.y+i.height)return!0}}var i,n,r;return!1},this.store=e.deps.store,this.state={marginLeft:-15,marginRight:-15},this.documentEventListener=new y.J(this.store.targetDocumentRef)}componentDidUpdate(e,t,o){var i,n,r,s,a,l,c;this.parentElement||(this.parentElement=this.store.getParentElement()),this.store.isVisible?(null===(i=this.parentElement)||void 0===i||i.setAttribute("aria-activedescendant",qe),null===(n=this.parentElement)||void 0===n||n.setAttribute("aria-controls",qe),null===(r=this.parentElement)||void 0===r||r.setAttribute("aria-owns",qe),this.store.setInitialFocus&&(null===(s=this.critiqueCalloutRef.current)||void 0===s||s.focus())):(null===(a=this.parentElement)||void 0===a||a.removeAttribute("aria-activedescendant"),null===(l=this.parentElement)||void 0===l||l.removeAttribute("aria-controls"),null===(c=this.parentElement)||void 0===c||c.removeAttribute("aria-owns"))}componentWillUnmount(){var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.documentEventListener=void 0,this.parentElement=void 0,null===(t=this.parentElementEventListener)||void 0===t||t.removeAllListeners(),this.parentElementEventListener=void 0}render(){const{styles:e,target:t}=this.store;let o=this.store.isVisible;return(!t||"x"in t&&"y"in t&&0===t.x&&0===t.y||(0,C.C)(t,"HTMLElement")&&!t.isConnected)&&(o=!1),a.createElement("div",{style:e.shadowHost},o?this.renderCallout():null)}getCommonStringsMap(){return{suggestionsGroupNoSuggestionsText:this.store.noSuggestionLabel}}getTextFormattingStringsMap(){const{localizer:e}=this.props.deps,{text:t,textInContext:o}=this.store;return{contextAccessibilityLabelForSpelling:e.getMessage("contextAccessibilityLabelForSpelling",[t,o]),contextAccessibilityLabelForRepeatedWord:e.getMessage("contextAccessibilityLabelForRepeatedWord",[t,o]),contextAccessibilityLabelForGrammar:e.getMessage("contextAccessibilityLabelForGrammar",[t,o]),contextAccessibilityLabelForRefinement:e.getMessage("contextAccessibilityLabelForRefinement",[t,o]),contextAccessibilityLabelForCorrection:e.getMessage("contextAccessibilityLabelForCorrection",[t,o])}}getCritiqueExplanationStringsMap(){const{localizer:e}=this.props.deps;return{explanationTableBefore:e.getMessage("explanationTableBefore"),explanationTableAfter:e.getMessage("explanationTableAfter"),explanationTableSeparator:e.getMessage("explanationTableSeparator"),explanationTableAccessibilityLabel:e.getMessage("explanationTableAccessibilityLabel")}}getCritiqueStringsMap(){var e;const{localizer:t}=this.props.deps,{calloutCategory:o,calloutTitle:i,navInfo:n}=this.store,r=t.getMessage("ebx_asInSynonyms"),s=`{0} ${r} {1}`,a=`{0}, {1} ${r} {2}`,l=n?(0,f.v)(n).length:0,c=null!==(e=null==n?void 0:n.currentIndex)&&void 0!==e?e:0,u=l-c-1;return{previewHeaderLabel:t.getMessage("ebx_previewLabel"),spellingCardHeader:o,repeatedWordCardSubheader:i,grammarCardHeader:o,tonalRewriteCardHeader:t.getMessage("ebx_toneLabel"),deleteRepeatedWord:t.getMessage("ebx_deleteRepeatedWord"),spellingSuggestionDescriptionAccessibilityLabel:s,suggestionWithTagAccessibilityLabel:"{0}, {1}",spellingSuggestionTagAndDescriptionAccessibilityLabel:a,ignoreAll:t.getMessage("ebx_ignoreAllButtonLabel"),ignoreOnce:t.getMessage("ebx_ignoreOnceButtonLabel"),addToDictionary:t.getMessage("ebx_addToDictionaryButtonLabel"),microsoftEditorBranding:t.getMessage("ebx_brandText"),microsoftEditorBrandingAccessibilityLabel:t.getMessage("ebx_brandTextArialLabel"),editorButtonTooltipContent:t.getMessage("ebx_settingsButtonTooltip"),footerSeeMoreActionsAccessibilityLabel:t.getMessage("ebx_moreButtonArialLabel"),changeAll:t.getMessage("ebx_changeAllCommandLabel"),giveFeedbackButtonText:t.getMessage("ebx_giveFeedback"),hideSynonyms:t.getMessage("ebx_hideSynonyms"),showSynonyms:t.getMessage("ebx_showSynonyms"),ignoreRule:t.getMessage("ebx_disableCritiqueButton"),options:t.getMessage("ebx_changeSettingsCommandLabel"),manageLanguages:t.getMessage("ebx_manageLanguages"),nextIssue:t.getMessage("ebx_nextIssueWithCount",u.toString()),nextIssueWithCount:t.getMessage("ebx_nextIssueWithCount",u.toString()),previousIssue:t.getMessage("ebx_previousIssueWithCount",c.toString()),previousIssueWithCount:t.getMessage("ebx_previousIssueWithCount",c.toString()),readAloudOriginalSentenceAccessibilityLabel:t.getMessage("readAloudOriginalSentenceAccessibilityLabel"),explanationFlyoutAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),footerExplanationButtonAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),editorButtonText:t.getMessage("editorButtonText")}}getLocalizedSharedStrings(){const e=this.getCritiqueStringsMap(),t=this.getCommonStringsMap(),o=this.getCritiqueExplanationStringsMap(),i=this.getTextFormattingStringsMap();return{critique:t=>e[t]||"",common:e=>t[e]||"",critiqueExplanation:e=>o[e]||"",textFormatting:e=>i[e]||""}}}Le.contextType=j.O1;const ze=(0,u.r)((0,Ne.PA)(Le),je)},30074:(e,t,o)=>{"use strict";o.d(t,{b:()=>re});var i,n,r=o(30206),s=o(72700),a=o(47954),l=o(63837);!function(e){e[e.CritiqueClicked=0]="CritiqueClicked",e[e.UpsellButtonClicked=1]="UpsellButtonClicked",e[e.ShowPage=2]="ShowPage",e[e.TryPremiumPreviewButtonClicked=3]="TryPremiumPreviewButtonClicked"}(i||(i={})),function(e){e[e.ShowCritiqueCallout=0]="ShowCritiqueCallout",e[e.SettingsPage=1]="SettingsPage",e[e.Outlook=2]="Outlook"}(n||(n={}));const c=(0,l.f)("IUpsellFeature");var u=o(87432),d=o(44579),h=o(59834),g=o(17288),p=o(10059),f=o(71621),m=o(60040);const v=(e,t,o,i)=>{if(i){let i=t;for(;" "!==e.charAt(i)&&i<o;)i+=1;return i}{let i=o;const n=o;for(;" "!==e.charAt(i)&&i>t;)i-=1;return i+1<=n&&(i+=1),i}};var b=o(33300),y=o(2579),w=o(98242),C=o(98287),S=o(38716),k=o(44680),T=o(21077),x=o(86278),_=o(11117),I=o(8903),E=o(2612),B=o(40617),A=o(51218),R=o(96950),M=o(6754),D=o(66526),P=o(36271),F=o(85996);const O=(0,l.f)("ITonalFreStore");var N=o(35744),q=o(40628),j=o(92037),L=o(21479),z=o(70496),H=o(51285),W=o(80967),U=o(54218),G=o(66886),V=o(17783),$=o(12376),K=o(83240),J=o(95988),Y=o(46546),Q=o(48828),Z=o(90424),X=o(30225),ee=o(62989),te=o(31127),oe=o(71418),ie=o(37120),ne=o(39977);let re=class{constructor(e,t,o,r,l,c,y,w,C,S,k,T,x,_,I,E,B,M,D,P,F,O,N,W,U,G){var V;this.proofingStore=e,this.localizerService=t,this.hostSettings=o,this.wordDictionary=r,this.instrumentationProcessor=l,this.logger=c,this.validator=y,this._showSynonymsFeature=w,this._proofingDom=C,this._tileContent=S,this._upsellFeature=k,this.styleDefinitions=T,this._roamingDictionaryBroker=x,this._upsellStore=_,this._featureFlagsReader=I,this._unSignedInEditorFeature=E,this._ariaStatusStateStore=B,this._feedbackStore=M,this._tonalFreStore=D,this._categoryLocalization=P,this._paneOpenState=F,this._externalSettingsFeature=O,this._roamingDictionaryFeature=N,this._indicatorStore=W,this._multilingualFreStore=U,this._autoCorrectionBroker=G,this.wasMarkedAsShown=!1,this.enableUpsell=!1,this._setInitialFocus=!1,this._isVisible=!1,this._target=void 0,this.showSynonymsState=!1,this._suggestionsToRender=[],this.isApplyingCritiqueAction=!1,this.navInfo=void 0,this._gapSpace=void 0,this._unsignedInEditorFeatureEnabled=!1,this.show=async e=>{var t,o,r,l,c,d;const{critique:h,setInitialFocus:g,target:p,onDismiss:f,onApplySuggestion:m,onIgnoreOnce:v,onIgnoreAll:b,onDisableCritiqueType:y,onShowFeedback:w,targetDocumentRef:C,gapSpace:S}=e,k=null!==(o=null===(t=this._upsellStore)||void 0===t?void 0:t.reducePreviewCount(h))&&void 0!==o?o:A.nz.Visible,T=null===(r=this._upsellStore)||void 0===r?void 0:r.isSquiggleBeingPreviewed(h);if(k!==A.nz.Hidden&&!T){if(this._unsignedInEditorFeatureEnabled=await this._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:s.o9.CalloutShown,sender:s.v$.CritiqueCallout}),this.setSynonymsState(await this.proofingStore.read(a.l.ShowSynonyms)),this._suggestionsToRender=[],this._setInitialFocus=g,this.critique=h,this._targetDocumentRef=C,this.enableUpsell=!!(null===(l=this._upsellFeature)||void 0===l?void 0:l.emitAndEvaluate({eventId:i.CritiqueClicked,sender:n.ShowCritiqueCallout,critique:this.critique})),h.suggestions.length>0)for(const[e,t]of h.suggestions.entries()){if((0,u.gA)(t.action))continue;let o={id:e.toString(),title:this.getSuggestionTitle(t),subtitle:this.getSuggestionDescription(t),tag:this.getLanguageTags(t),actions:[ee._R.Accept]};this.isRewrite&&(o=Object.assign(Object.assign({},o),this.getSuggestionTitleWithDecorations(t))),this.suggestionsToRender.push(o)}this.critique.shouldShowMultilingualFre?null===(c=this._multilingualFreStore)||void 0===c||c.addMultilingualProofingFre():null===(d=this._multilingualFreStore)||void 0===d||d.removeMultilingualProofingFre(),this.onAfterShownCallback=()=>{this._setInitialFocus&&(0,ne.Fy)(!0),this.onAfterShownCallback=void 0},this._gapSpace=S,(0,Y.runInAction)((()=>{this._target=p})),this.onApplySuggestion=m,this.onIgnoreOnce=v,this.onIgnoreAll=b,this.onDisableCritiqueType=y,this.onShowFeedback=w,this.setIsVisible(!0),this.onShown(h,f)}},this.setSynonymsState=e=>{this.showSynonymsState=e},this.setIsVisible=e=>{this._isVisible=e,this.wasMarkedAsShown=!1},this.hide=()=>{var e;(this._isVisible||this.wasMarkedAsShown)&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isRewrite&&(null===(e=this._tonalFreStore)||void 0===e||e.checkIfDisableTonalCritiqueInitiatedAndCompleteIt()),this._isVisible=!1,this.wasMarkedAsShown=!1,this.instrumentationEventId=void 0,this.critique=void 0,this._target=void 0,this._targetDocumentRef=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onDisableCritiqueType=void 0,this.footerAction=void 0,this._gapSpace=void 0,this._suggestionsToRender=[],this.onDismiss()},this.onDismiss=()=>{var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this),this.onDismissCallback=void 0},this.afterRender=()=>{var e;null===(e=this.onAfterShownCallback)||void 0===e||e.call(this)},this.onCalloutAction=(e,t,o)=>{this.isApplyingCritiqueAction=!0;try{this.isCritiqueAction(e)?this.onCritiqueAction(e,t):this.onCardAction(e)}finally{this.isApplyingCritiqueAction=!1}},this.onTonalFreAction=e=>{var t;if(this._tonalFreStore){this.isApplyingCritiqueAction=!0;try{let o=!1;switch(e){case oe.h.Accept:this._tonalFreStore.acceptTonalRewriteCritique();break;case oe.h.Ignore:this.ignoreOnce(),o=!0,this._tonalFreStore.logTonalFreIgnored();break;case oe.h.Reject:void 0!==(null===(t=this.critique)||void 0===t?void 0:t.typeId)&&this._tonalFreStore.disableTonalRewriteCritique(this.critique.typeId);break;case oe.h.OpenEditorSettings:this._tonalFreStore.showEditorSettings(),o=!0;break;case oe.h.DismissRejectMessage:o=!0}o&&this.hide()}finally{this.isApplyingCritiqueAction=!1}}},this.changeShowSynonymsState=()=>{const e=!this.showSynonymsState;this.proofingStore.write(a.l.ShowSynonyms,e).then((()=>{this.updateShowSynonyms(e)}))},this.updateShowSynonyms=e=>{this.showSynonymsState=e;const t=this.logger.getNewActivity(this.showSynonyms?d.n.ActionShowSynonymsFromCallout:d.n.ActionHideSynonymsFromCallout,h.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())},this.goPremium=e=>{var t;null===(t=this._upsellFeature)||void 0===t||t.goPremium(n.ShowCritiqueCallout,this.critique,e)},this.tryPremiumPreview=()=>{var e;null===(e=this._upsellStore)||void 0===e||e.tryPremiumPreview(this.critique)},this.signIn=()=>{chrome.runtime.sendMessage({activity:"authentication",type:"msidUserService"});const e=this.logger.getNewActivity(d.n.SignInInitialized,h.o.SamplingPolicy.CriticalExperimentation);e&&(e.dataFields.push((0,g.n)("Entry","CritiqueCallout")),e.success=!0,e.endNow())},this.clickNoActionHide=()=>{const e=this.shouldShowTonalFre;!this.isVisible&&!this.wasMarkedAsShown||e||this.recordInstrumentationEventId(J.xp.ClickNoAction),this.hide()},this.notifyAriaStatusChange=e=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(e,"assertive")},this.applySuggestion=(e,t)=>{var o;this.critique&&this.onApplySuggestion&&(null===(o=this._upsellStore)||void 0===o||o.removePremiumCritique(this.critique),this.onApplySuggestion(this.critique,e))},this.ignoreOnce=()=>{var e,t;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&(null===(t=this.onIgnoreOnce)||void 0===t||t.call(this,this.critique))},this.ignoreAll=()=>{var e;this.critique&&(null===(e=this.onIgnoreAll)||void 0===e||e.call(this,this.critique))},this.addToDictionary=()=>{var e;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&this.wordDictionary.addWordToCustomDictionary(this.critique.textInContext)},this.disableCritiqueType=async()=>{var e;const t=this.critique;if(void 0===(null==t?void 0:t.typeId))return void this.logger.error(571326788,"Undefined critique or typeId while trying to disable a critique type");await(null===(e=this.onDisableCritiqueType)||void 0===e?void 0:e.call(this,t));const o=this.logger.getNewActivity(d.n.ActionDisableCritique,h.o.SamplingPolicy.CriticalExperimentation);o&&(o.dataFields.push((0,g.n)("CritiqueTypeId",t.typeId)),t.typeId===p.L9.TopicSuggestion&&o.dataFields.push((0,g.n)("CritiqueMetadataJSON",JSON.stringify(t.metadata))),o.success=!0,o.endNow()),this.recordInstrumentationEventId(J.xp.DoNotCheckThisIssue),this.notifyAriaStatusChange(t.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",t.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel")),this.hide()},this.onRewriteFeedback=()=>{if(this.isRewrite){const e=this.suggestionsToRender.length>0?this.suggestionsToRender[0].title:"";this._feedbackStore.feedbackIconClicked(e,"tonal"),this.hide()}},this.isCritiqueAction=e=>{switch(e){case ee._R.Accept:case ee._R.IgnoreOnce:case ee._R.IgnoreAll:case ee._R.AddToDictionary:case ee._R.IgnoreRule:return!0;default:return!1}},this.onCritiqueAction=(e,t)=>{var o;if(!this.critique)return void this.logger.error(562438878,`Undefined critique on action: ${e}`);const i=void 0!==t?this.critique.suggestions[t]:void 0;let n,r;switch(e){case ee._R.Accept:i&&void 0!==t?(this.applySuggestion(i,t),n=this.localizer.getMessage("ebx_SuggestionAppliedMessage",i.text),r=this.isSpellingDeletion?J.xp.Delete:Math.min(t+J.xp.ChangeSugg0,J.xp.ChangeSuggOther)):this.logger.error(543495585,`Undefined suggestionIndex or suggestion on Accept: ${t}, ${i}`);break;case ee._R.IgnoreOnce:this.ignoreOnce(),n=this.localizer.getMessage("ebx_GrammarIgnored"),r=J.xp.Ignore;break;case ee._R.IgnoreAll:this.ignoreAll(),n=this.localizer.getMessage("ebx_SpellingIgnored"),r=J.xp.IgnoreAll;break;case ee._R.AddToDictionary:this.addToDictionary(),n=this.localizer.getMessage("ebx_AddedToDictionary",this.critique.textInContext),r=J.xp.AddToDictionary;break;case ee._R.IgnoreRule:this.disableCritiqueType(),n=this.critique.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",this.critique.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel"),r=J.xp.DoNotCheckThisIssue}void 0!==r?this.recordInstrumentationEventId(r):this.logger.error(562438879,`Undefined actionInstrumentationEventId on action: ${e}`),void 0!==n?this.notifyAriaStatusChange(n):this.logger.error(562438880,`Undefined actionAriaNotification on action: ${e}`),this.hide(),null===(o=this.navInfo)||void 0===o||o.onNavSuggestionApplied()},this.executeActionIfDefined=(e,t)=>{t?t():this.logger.error(561853783,`Undefined action clicked: ${e}`)},this.onCardAction=e=>{var t,o;switch(e){case ee._R.Options:this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide();break;case ee._R.ManageLanguages:this.executeActionIfDefined("manageLanguagesAction",this.manageLanguagesAction),this.hide();break;case ee._R.ShowExplanation:break;case ee._R.Feedback:if(this.isRewrite)this.onRewriteFeedback();else if(this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback){let e;try{e=this.critique.suggestions.map((e=>{var t;return JSON.parse(null!==(t=e.metadataJSON)&&void 0!==t?t:"{}")}))}catch(e){this.logger.error(537778203,"Error parsing topic metadata json.")}(0,f.z)((0,L.S)({topicIds:(null==e?void 0:e.map((e=>e.id)).join(", "))||"",topicNames:(null==e?void 0:e.map((e=>e.displayName)).join(", "))||"",highlightedText:this.critique.textInContext||"",requestId:this.critique.metadata[0].value,hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),source:"EditorFlag",traceId:this.critique.traceId||""}))}else this.executeActionIfDefined("onShowFeedback",this.onShowFeedback);break;case ee._R.ToggleDescription:this.changeShowSynonymsState();break;case ee._R.AddOnFooterAction:this.executeActionIfDefined("footerAction",this.footerAction);break;case ee._R.Next:this.navigate(1);break;case ee._R.Previous:this.navigate(-1);break;case ee._R.OpenEditorPane:this._indicatorStore?null===(o=(t=this._indicatorStore).onOpenEditorPane)||void 0===o||o.call(t,q.k.ContextualCard):this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide()}},this.getSuggestionTitle=e=>!(0,R.qB)(e)&&this.critique&&(0,R.ht)(this.critique)?this.localizer.getMessage("ebx_deleteRepeatedWord"):this.validator.validate(e.text),this.getSuggestionTitleWithDecorations=e=>{var t;if(null===(t=this.critique)||void 0===t?void 0:t.textInContext){const{truncatedPrefix:t,truncatedSubstring:o,truncatedSuffix:i}=((e,t)=>{const o=t.length,i=((e,t)=>{const o=e.length,i=t.length;let n=0,r=0;for(let s=0;s<Math.min(o,i)&&e.charAt(s)===t.charAt(s);s+=1)n+=1,(0,m.Yv)(e.charCodeAt(s))&&(r=n);return r})(e,t),n=Math.min(((e,t)=>{const o=e.length,i=t.length;let n=0,r=0;for(let s=0;s<Math.min(o,i)&&e.charAt(o-s-1)===t.charAt(i-s-1);s+=1)n+=1,(0,m.Yv)(e.charCodeAt(o-s-1))&&(r=n);return r})(e,t),Math.min(o,e.length)-i),r=i+n,s=o-r,a=Math.min(130,s),l=Math.min(150-a,r),c=Math.min(l,i),u=Math.min(l,n),{actualLeftContextLength:d,actualRightContextLength:h}=((e,t,o)=>{let i,n;const r=e/2;return t<r&&o<r?(i=t,n=o):t<r?(i=t,n=Math.min(o,e-i)):o<r?(n=o,i=Math.min(t,e-n)):(i=r,n=r),{actualLeftContextLength:i,actualRightContextLength:n}})(l,c,u),g=t.substring(i-d,i),p=t.substring(i,o-n),f=t.substring(o-n,o-n+h);let b=g,y=p,w=f;if(i>d){const e=v(g,0,g.length,!0);b=`...${g.substring(e,g.length)}`}if(p.length>a){const e=v(p,0,a/2,!1),t=v(p,a/2,p.length,!0);y=`${p.substring(0,e)}...${p.substring(t,p.length)}`}if(n>h){const e=v(f,0,f.length,!1);w=`${f.substring(0,e)}...`}return{truncatedPrefix:b,truncatedSubstring:y,truncatedSuffix:w}})(this.critique.textInContext,e.text);return{title:t+o+i,titleDecorations:[{start:e.text.indexOf(o),length:o.length,decorationType:ee.vr.Rewrite}]}}return{title:this.getSuggestionTitle(e),titleDecorations:void 0}},this.getSuggestionDescription=e=>{if(!this.isSynonymsEnabled)return;if(!this.isSynonymsAvailable)return;let t=this.validator.validate(e.description);return this.isTopicSuggestionCritique&&(t=t.slice(0,125),e.description&&e.description.length>t.length&&(t+="...")),t||this.localizer.getMessage("ebx_synonymsNotAvailable")},this.getNeutralLanguageCode=e=>{const t=e.indexOf("-");return(t<0?e:e.slice(0,t)).toUpperCase()},this.getLanguageTags=e=>{const t=this.proofingStore.getCachedEntry(a.l.ProofingLanguages).storeEntryValue;if(!t||t.length<2||!e.languages)return"";const o=[];for(const t of e.languages){const e=this.getNeutralLanguageCode(t);o.includes(e)||o.push(e)}return o.join(", ")},this.setNavInfo=e=>{this.navInfo=e},this.navigate=(e=0)=>{const t=(0,z.v)(this.navInfo),o=t.length;if(!this.navInfo||0===o)return this.resetNavigation(),this.clickNoActionHide(),!1;const i=((this.navInfo.currentIndex+e)%o+o)%o,n=t[i];return this.navInfo=Object.assign(Object.assign({},this.navInfo),{currentIndex:i}),this.hide(),"contenteditable"===this.navInfo.ctr?this.navigateCe(n.store,n.critique):this.navigateV2(n.store,n.critique),!0},this.navigateCe=(e,t)=>{const o=this.navInfo;e.showCallout(t,(()=>{this.setNavInfo(o)}))},this.navigateV2=(e,t)=>{const o=e.messageItem.anchor.element,i=this.navInfo;e.showCallout(t,o,o.innerText,!0,(()=>{this.setNavInfo(i)}),H.Ah.critique)},this.resetNavigation=()=>{var e;null===(e=this.navInfo)||void 0===e||e.onCloseNavigation(),this.navInfo=void 0},this.recordInstrumentationEventId=e=>{var t;this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e),e===J.xp.ClickNoAction&&this.resetNavigation(),null===(t=this._indicatorStore)||void 0===t||t.userInputEvent()},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:(0,Y.toJS)(this.critique),eventId:e})},(0,j.Gn)(this),(null===(V=this._externalSettingsFeature)||void 0===V?void 0:V.openSettings)&&(this.showOptionsAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(b.kY.dropdown)},this.manageLanguagesAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(b.kY.manageLanguages)})}get roamingDictionaryEnabled(){var e,t;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!(null===(t=this._roamingDictionaryFeature)||void 0===t?void 0:t.isReady())}get cloudIconEnabled(){return this.hostSettings.inferenceCritiqueCloudIconEnabled&&!this.isRewrite}get shouldShowAddToDictionary(){return!!this.critique&&this.roamingDictionaryEnabled&&this.isSpelling&&!(0,R.dt)(this.critique)}get isUpsell(){return this.enableUpsell}get setInitialFocus(){return this._setInitialFocus}get isVisible(){return this._isVisible}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new y.O(document)}getParentElement(){var e,t;if(null===(e=this.critique)||void 0===e?void 0:e.nodeId){const e=this._proofingDom.findParagraphNode(this.critique.nodeId);if(!e)return;const o=this._tileContent.getContainingElement(e);if(o)return null!==(t=(0,ie.m)(o))&&void 0!==t?t:o}}get target(){return this._target}get isSynonymsEnabled(){return this._showSynonymsFeature.emitAndEvaluate({eventId:w.OV.GetMoreCommands,sender:w.xr.CritiqueCallout})}get showSynonyms(){return this.showSynonymsState||this.isTopicSuggestionCritique}get brandingMode(){return this.hostSettings.brandingMode}get suggestionsToRender(){return this._suggestionsToRender}get noSuggestionLabel(){var e;return(null===(e=this.critique)||void 0===e?void 0:e.suggestions.length)&&(0,u.gA)(this.critique.suggestions[0].action)?this.critique.suggestions[0].text:""}get calloutTitle(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}return(0,R.dt)(this.critique)?this.localizer.getMessage("ebx_repeatedWordsExplanationTitle"):(0,R.r)(this.critique)?this.localizer.getMessage("ebx_spellingExplanationTitle"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionExplanationTitle"):this.validator.validate(this.critique.explanationTitle)}get text(){var e,t,o;return null!==(o=null===(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)||void 0===t?void 0:t.substring(this.critique.start,this.critique.start+this.critique.length))&&void 0!==o?o:""}get textInContext(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&void 0!==t?t:""}get calloutCategory(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}const e=this.critique.categoryTitle?this._categoryLocalization.toUiLocale(this.critique.categoryTitle):void 0,t=this.isRewrite?this.localizer.getMessage("ebx_toneLabel"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionLabel"):e;return this.validator.validate(t)}get explanation(){var e;return this.hostSettings.critiqueCalloutExplanationFlyout&&this.critique&&null!==(e=this.critique.explanation)&&void 0!==e?e:""}get explanationTitle(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.explanationLabel)&&void 0!==t?t:""}get localizer(){return this.localizerService}get styles(){return this.styleDefinitions.critiqueCallout}get ariaLabelToReadWhenCardIsOpened(){return this.localizer.getMessage("ebx_critiqueCalloutAriaLabel",[this.calloutCategory,this.explanationTitle,this.calloutTitle,this.textInContext])}get isSpelling(){return(0,R.r)(this.critique)}get isRepeatedWords(){return(0,R.dt)(this.critique)}get isRewrite(){return(0,R.r6)(this.critique)}get isTopicSuggestionCritique(){return(0,R.W)(this.critique)}get isAutoCorrection(){var e;return!!(this.hostSettings.enableAutoCorrect&&this.critique&&(0,R.MG)(this.critique)&&(null===(e=this._autoCorrectionBroker)||void 0===e?void 0:e.getHasAutoCorrectionBeenApplied(this.critique)))}get isSpellingDeletion(){return!!this.critique&&(0,R.ht)(this.critique)}get shouldShowTonalFre(){return this.isRewrite&&!!this.hostSettings.tonalFreEnabledForUser&&!!this._tonalFreStore&&!this._tonalFreStore.isTonalFreAccepted}get settings(){const e={RenderFooterIcons:"true"};return this.hostSettings.isFeedbackEnabled&&this.isRewrite&&(e.EnableFeedback="true"),this.hostSettings.ignoreAllEnabled&&(e.EnableIgnoreAll="true"),e}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:4}get critiqueType(){return this.critique&&(0,R.dt)(this.critique)?ee.L9.RepeatedWord:(0,R.r)(this.critique)?ee.L9.Spelling:(0,R.W)(this.critique)?ee.L9.Topic:this.critique&&this.critique.priority===p.bx.Medium?ee.L9.Grammar:this.isRewrite?ee.L9.TonalRewrite:ee.L9.Refinement}get critiqueSource(){if(this.critique&&this.cloudIconEnabled){const e=this.critique.metadata;if(e&&e.length>0)for(const t of e)if("CritiqueSource"===t.name&&"Inference"===t.value)return te.UD.Inference}return te.UD.Unknown}get isSynonymsAvailable(){var e;const t=null===(e=this.critique)||void 0===e?void 0:e.suggestions.find((e=>!!e.description&&!e.description.match(/\[(.*)\]/g)));return(this.isSpelling||this.isTopicSuggestionCritique)&&!this.isAutoCorrection&&!!t}get showDisableCritiqueTypeMenuItem(){return!!this.hostSettings.enableStopCheckingForThis&&!!this.critique&&this.critique.priority!==p.bx.High&&!this.isTopicSuggestionCritique}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}async initialize(){}shutDown(){this._target=void 0,this._targetDocumentRef=void 0,this.onDisableCritiqueType=void 0,this.onDismissCallback=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onAfterShownCallback=void 0,this.onShowFeedback=void 0,this.showOptionsAction=void 0,this.manageLanguagesAction=void 0,this.footerAction=void 0}markAsShown(e,t){this.wasMarkedAsShown=!0,this.onShown(e,t)}onShown(e,t){var o;this.shouldShowTonalFre&&(null===(o=this._tonalFreStore)||void 0===o||o.logTonalFreShown());const i=this.logger.getNewActivity(d.n.ActionShowCallout,h.o.SamplingPolicy.CriticalExperimentation);i&&(i.dataFields.push((0,g.n)("CritiqueTypeId",e.typeId)),e.typeId===p.L9.TopicSuggestion&&i.dataFields.push((0,g.n)("CritiqueMetadataJSON",JSON.stringify(e.metadata))),i.success=!0,i.endNow()),this.onDismiss(),this.onDismissCallback=t}get dropDownActions(){var e;const t=[];return this.isAutoCorrection?t.push(ee._R.AutoCorrectOptions):this.isSpelling&&!this.isSpellingDeletion?(this.hostSettings.ignoreAllEnabled&&t.push(ee._R.IgnoreAll),this.hostSettings.isMultilingualProofingEnabled&&this.hostSettings.enableManageLanguagesInCritiqueCallout&&t.push(ee._R.ManageLanguages)):this.hostSettings.ignoreOnceEnabled&&t.push(ee._R.IgnoreOnce),this.isTopicSuggestionCritique&&this.hostSettings.ignoreAllEnabled&&t.push(ee._R.IgnoreAll),this.isSynonymsAvailable&&this.isSynonymsEnabled&&!this.isTopicSuggestionCritique&&t.push(ee._R.ToggleDescription),this.hostSettings.showOptionsButton&&t.push(ee._R.Options),(this._featureFlagsReader.flags.enableOcvFeedbackUi||this.hostSettings.isFeedbackEnabled&&this.isRewrite||this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback)&&t.push(ee._R.Feedback),this.showDisableCritiqueTypeMenuItem&&t.push(ee._R.IgnoreRule),!this.isAutoCorrection&&this.shouldShowAddToDictionary&&t.push(ee._R.AddToDictionary),this.navInfo&&(t.push(ee._R.Next),t.push(ee._R.Previous)),(null===(e=this._paneOpenState)||void 0===e?void 0:e.isPaneOpen)||this.brandingMode!==ee.nH.IconButton&&this.brandingMode!==ee.nH.IconAndTextButton||t.push(ee._R.OpenEditorPane),t}get addOnFooterData(){var e,t;if(this.unsignedInEditorFeatureEnabled)return this.footerAction=this.signIn,{actionText:this.localizer.getMessage("ebx_signIntoEditor"),message:`${this.localizer.getMessage("ebx_addGrammarChecking")}${this.localizer.getMessage("ebx_enhancedUpsellCategoriesComma")}`};if(!this.enableUpsell)return;if(!this.hostSettings.areAdditionalPaneEntryPointsEnabled||!this._indicatorStore)return this.premiumPreviewFooter;this.footerAction=()=>{var e,t;null===(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.onOpenEditorPane)||void 0===t||t.call(e,q.k.ContextualCard),this.hide()};const o=null!==(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.getPremiumCritiquesCount())&&void 0!==t?t:0;return{actionText:this.localizer.getMessage("ebx_openEditorLabel"),message:o>0?this.localizer.getMessage("ebx_editorAdvancedCritiquesLabel",o.toString()):this.localizer.getMessage("ebx_tryEditorLabel"),icon:"Editor"}}get premiumPreviewFooter(){if(!this.hostSettings.enhancedUpsellEnabled||!this._upsellStore)return this.footerAction=()=>this.goPremium("Regular_CCard"),{actionText:this.localizer.getMessage("ebx_goPremiumLinkText"),message:this.localizer.getMessage("ebx_goPremiumLine"),icon:"PremiumDiamond"};const e=this._upsellStore.previewModeActive,t=this.hostSettings.premiumPreviewEnabled,o=this._upsellStore.previewUnit,i=e?this._upsellStore.previewCount:this._upsellStore.premiumCount,n=t&&!e&&i>0;let r="ebx_premiumPreviewGeneralLine";const s=1===i;e&&o===A.mq.Suggestions?r=s?"ebx_premiumPreviewSuggestionsSingular":"ebx_premiumPreviewSuggestionsPlural":e&&o===A.mq.Days?r=s?"ebx_premiumPreviewDaysSingular":"ebx_premiumPreviewDaysPlural":i>0&&(r=s?"ebx_enhancedUpsellLineSingular":"ebx_enhancedUpsellLinePlural");const a=i.toLocaleString(),l=this.localizer.getMessage(r,a);return this.footerAction=n?()=>{var e;return null===(e=this._upsellStore)||void 0===e?void 0:e.tryPremiumPreview(this.critique)}:()=>this.goPremium("ContextualUpsell_CCard"),{actionText:n?this.localizer.getMessage("ebx_tryPremiumPreviewLink"):this.localizer.getMessage("ebx_goPremiumLinkText"),footerDecorations:i>0||e?[{decorationType:ee.vr.PremiumEmphasis,length:a.length,start:l.indexOf(a)}]:void 0,message:l,icon:"PremiumDiamond"}}restoreCaretToPreviousPosition(){var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this,!0)}};(0,r.__decorate)([Y.observable],re.prototype,"enableUpsell",void 0),(0,r.__decorate)([Y.computed],re.prototype,"isUpsell",null),(0,r.__decorate)([Y.observable],re.prototype,"_setInitialFocus",void 0),(0,r.__decorate)([Y.computed],re.prototype,"setInitialFocus",null),(0,r.__decorate)([Y.observable],re.prototype,"_isVisible",void 0),(0,r.__decorate)([Y.computed],re.prototype,"isVisible",null),(0,r.__decorate)([Y.observable],re.prototype,"_target",void 0),(0,r.__decorate)([Y.computed],re.prototype,"target",null),(0,r.__decorate)([Y.observable],re.prototype,"showSynonymsState",void 0),(0,r.__decorate)([Y.computed],re.prototype,"showSynonyms",null),(0,r.__decorate)([Y.computed],re.prototype,"brandingMode",null),(0,r.__decorate)([Y.observable],re.prototype,"_suggestionsToRender",void 0),(0,r.__decorate)([Y.computed],re.prototype,"suggestionsToRender",null),(0,r.__decorate)([Y.computed],re.prototype,"noSuggestionLabel",null),(0,r.__decorate)([Y.observable],re.prototype,"navInfo",void 0),(0,r.__decorate)([Y.computed],re.prototype,"calloutTitle",null),(0,r.__decorate)([Y.computed],re.prototype,"text",null),(0,r.__decorate)([Y.computed],re.prototype,"textInContext",null),(0,r.__decorate)([Y.computed],re.prototype,"calloutCategory",null),(0,r.__decorate)([Y.computed],re.prototype,"explanation",null),(0,r.__decorate)([Y.computed],re.prototype,"explanationTitle",null),(0,r.__decorate)([Y.computed],re.prototype,"styles",null),(0,r.__decorate)([Y.computed],re.prototype,"ariaLabelToReadWhenCardIsOpened",null),(0,r.__decorate)([Y.computed],re.prototype,"shouldShowTonalFre",null),(0,r.__decorate)([Y.computed],re.prototype,"settings",null),(0,r.__decorate)([Y.observable],re.prototype,"_gapSpace",void 0),(0,r.__decorate)([Y.computed],re.prototype,"gapSpace",null),(0,r.__decorate)([Y.computed],re.prototype,"critiqueType",null),(0,r.__decorate)([Y.computed],re.prototype,"critiqueSource",null),(0,r.__decorate)([Y.action],re.prototype,"show",void 0),(0,r.__decorate)([Y.action],re.prototype,"setSynonymsState",void 0),(0,r.__decorate)([Y.action],re.prototype,"setIsVisible",void 0),(0,r.__decorate)([Y.action],re.prototype,"hide",void 0),(0,r.__decorate)([Y.action],re.prototype,"onDismiss",void 0),(0,r.__decorate)([Y.action],re.prototype,"afterRender",void 0),(0,r.__decorate)([Y.action],re.prototype,"onCalloutAction",void 0),(0,r.__decorate)([Y.action],re.prototype,"onTonalFreAction",void 0),(0,r.__decorate)([Y.computed],re.prototype,"dropDownActions",null),(0,r.__decorate)([Y.action],re.prototype,"updateShowSynonyms",void 0),(0,r.__decorate)([Y.computed],re.prototype,"addOnFooterData",null),(0,r.__decorate)([Y.action],re.prototype,"setNavInfo",void 0),(0,r.__decorate)([Y.action],re.prototype,"navigate",void 0),(0,r.__decorate)([Y.action],re.prototype,"resetNavigation",void 0),re=(0,r.__decorate)([(0,Q._)(),(0,r.__param)(0,(0,Z.W)(C.K)),(0,r.__param)(1,(0,Z.W)(S.H)),(0,r.__param)(2,(0,Z.W)(k.n)),(0,r.__param)(3,(0,Z.W)(M.s)),(0,r.__param)(4,(0,Z.W)(T.f)),(0,r.__param)(5,(0,Z.W)(x.g)),(0,r.__param)(6,(0,Z.W)(V.$)),(0,r.__param)(7,(0,Z.W)(w.DS)),(0,r.__param)(8,(0,Z.W)(D.w)),(0,r.__param)(9,(0,Z.W)(P.d)),(0,r.__param)(10,(0,Z.W)(c)),(0,r.__param)(10,(0,X.l)()),(0,r.__param)(11,(0,Z.W)(W.$)),(0,r.__param)(12,(0,Z.W)(_.C)),(0,r.__param)(12,(0,X.l)()),(0,r.__param)(13,(0,Z.W)(A.Ey)),(0,r.__param)(13,(0,X.l)()),(0,r.__param)(14,(0,Z.W)(I.c)),(0,r.__param)(15,(0,Z.W)(s.tq)),(0,r.__param)(16,(0,Z.W)(U.JY)),(0,r.__param)(17,(0,Z.W)(F.M)),(0,r.__param)(18,(0,Z.W)(O)),(0,r.__param)(18,(0,X.l)()),(0,r.__param)(19,(0,Z.W)(K.C)),(0,r.__param)(20,(0,X.l)()),(0,r.__param)(20,(0,Z.W)(E.F)),(0,r.__param)(21,(0,X.l)()),(0,r.__param)(21,(0,Z.W)(b.In)),(0,r.__param)(22,(0,X.l)()),(0,r.__param)(22,(0,Z.W)(B.Zp)),(0,r.__param)(23,(0,X.l)()),(0,r.__param)(23,(0,Z.W)(N.y)),(0,r.__param)(24,(0,X.l)()),(0,r.__param)(24,(0,Z.W)(G.j)),(0,r.__param)(25,(0,X.l)()),(0,r.__param)(25,(0,Z.W)($.m))],re)},8474:(e,t,o)=>{"use strict";var i;o.d(t,{u:()=>i}),function(e){e.calloutMain="calloutMain",e.moreActions="moreActions"}(i||(i={}))},15306:(e,t,o)=>{"use strict";o.d(t,{$:()=>y,v:()=>b});var i=o(95734);if(3023==o.j)var n=o(46914);if(3023==o.j)var r=o(91122);if(3023==o.j)var s=o(93028);if(3023==o.j)var a=o(59901);var l=o(37842),c=o(8676),u=o(75186);if(3023==o.j)var d=o(68023);if(3023==o.j)var h=o(67971);if(3023==o.j)var g=o(35240);if(3023==o.j)var p=o(79768);var f=o(13608);if(3023==o.j)var m=o(9420);if(3023==o.j)var v=o(61324);const b=(0,l.F5)({state:c.A.on(u.x)}),y=()=>{const e=i.useContext(f.O1),{state:t}=(0,l.KN)(b),[o,c]=i.useState(!1);i.useEffect((()=>(t.subscribe("visibilityUpdated",c),()=>{t.unsubscribe("visibilityUpdated",c)})),[t]);const{undoAriaLabel:u,undoTitle:y,localizer:w,target:C,styles:S,showEditorBranding:k,gapSpace:T}=t,x=w.getMessage("ebx_settingsButtonTooltip"),_=w.getMessage("ebx_undoCalloutAriaLabel"),I=i.useCallback((()=>{t.applyUndo()}),[t]),E=i.useCallback((()=>{t.openSettings()}),[t]),B=i.useCallback((e=>{t.updateCalloutPosition((null==e?void 0:e.alignmentEdge)===g.x.right,!1)}),[t]),A=(0,v.I)(),R=i.createElement("div",{style:Object.assign({display:"flex",flexDirection:"row",flexWrap:"nowrap"},S.calloutContainer)},i.createElement(s.$,{icon:i.createElement(n.t2R,{style:e?void 0:S.buttonIcon.icon,className:A.icon}),appearance:"subtle",className:`${p.g.undoButton}`,"data-automation-id":"undo-callout-undo-button",key:"Undo",role:"button",style:S.buttonIcon,title:y,"aria-label":u,onClick:I}),i.createElement(s.$,{icon:i.createElement(r.$Dw,{style:e?void 0:S.buttonIcon.icon,className:A.icon}),appearance:"subtle",className:p.g.settingsButton,key:"Settings","data-automation-id":"undo-callout-settings-button",role:"button",style:Object.assign({marginLeft:2},S.buttonIcon),title:x,"aria-label":x,onClick:E}),k&&i.createElement("span",{role:"none presentation","aria-hidden":!0,style:S.logoButtonBase},w.getMessage("ebx_brandText")));if(e){const e={popover:{trapFocus:t.setInitialFocus,withArrow:!1,open:o,ariaLabel:_,ariaRole:"group",positioning:{target:(0,m.ug)(C),align:"center",position:"above",offset:e=>(t.updateCalloutPosition("end"===e.alignment,!0),{mainAxis:T})}},surface:{style:Object.assign({padding:0,background:a.L.colorNeutralBackground1,borderRadius:8},S.calloutV9)}};return i.createElement(h.v,Object.assign({ref:t.undoCardV9Ref},e),R)}return o?i.createElement(d.U,{ref:t.undoCardRef,isBeakVisible:!1,gapSpace:T,target:(0,m.KV)(C),doNotLayer:!0,role:"group",ariaLabel:_,setInitialFocus:t.setInitialFocus,onRestoreFocus:()=>{},onPositioned:B,styles:S.calloutMain},R):i.createElement(i.Fragment,null)}},61324:(e,t,o)=>{"use strict";o.d(t,{I:()=>r});var i=o(78814),n=o(59901);const r=(0,i.n)({icon:{color:n.L.colorNeutralForeground1}})},79768:(e,t,o)=>{"use strict";o.d(t,{f:()=>k,g:()=>S});var i=o(30206),n=o(19432),r=o(9420),s=o(33300),a=o(44579),l=o(59834),c=o(38716),u=o(44680),d=o(86278),h=o(8903),g=o(21077),p=o(54218),f=o(80967),m=o(17783),v=o(6754),b=o(48828),y=o(90424),w=o(30225),C=o(95734);const S={undoButton:"ebx_undoButton",settingsButton:"ebx_settingsButton"};let k=class extends n.z{constructor(e,t,o,i,n,a,l,c,u,d){var h;let g;super(),this.localizer=e,this.hostSettings=t,this.externalSettingsFeature=o,this.logger=i,this.wordDictionary=n,this._ariaStatusStateStore=a,this._featureFlagsReader=l,this.validator=c,this.instrumentationProcessor=u,this.styleDefinitions=d,this._undoCardRef=C.createRef(),this._undoCardV9Ref=C.createRef(),this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._unsignedInEditorFeatureEnabled=!1,this.getTargetRect=()=>{var e,t;if(this.target)return(0,r.Pe)(this.target)?{left:this.target.x,right:this.target.x,top:this.target.y,bottom:this.target.y,width:0,height:0}:(0,r.K2)(this.target)?{left:this.target.left,right:null!==(e=this.target.right)&&void 0!==e?e:0,top:this.target.top,bottom:null!==(t=this.target.bottom)&&void 0!==t?t:0,width:this.target.width,height:this.target.height}:this.target.getBoundingClientRect()},this.executeShowOptionsAction=()=>{this.showOptionsAction&&this.showOptionsAction()},this.setShowOptionsAction=e=>{e&&(this.showOptionsAction=e)},this.notifyAriaStatusChange=(e,t)=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(this.localizer.getMessage(e,t),"assertive")},this.recordInstrumentationEventId=e=>{this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e)},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:this.critique,eventId:e})},(null===(h=this.externalSettingsFeature)||void 0===h?void 0:h.openSettings)&&(g=()=>{var e;null===(e=this.externalSettingsFeature)||void 0===e||e.openSettings(s.kY.dropdown)}),this.setShowOptionsAction(g)}get undoCardRef(){return this._undoCardRef}get undoCardV9Ref(){return this._undoCardV9Ref}get isVisible(){return this._isVisible}get target(){return this._target}get targetRect(){return this._targetRect||(this._targetRect=this.getTargetRect()),this._targetRect}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:0}get setInitialFocus(){var e;return null!==(e=this._setInitialFocus)&&void 0!==e&&e}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}get mainFocusZoneId(){return"calloutMain--undo"}get undoTitle(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,o=this.localizer.getMessage("ebx_autoCorrectRevertTo",t);return this.validator.validate(o)}get undoAriaLabel(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,o=t.split("").join(" "),i=this.localizer.getMessage("ebx_autoCorrectRevertTo",t),n=this.localizer.getMessage("ebx_undoButtonAriaLabel");return this.validator.validate(`${n}, ${i}, ${o}`)}get showEditorBranding(){return!!this.hostSettings.undoCardShowEditorLogo}get styles(){return this.styleDefinitions.undoCallout}checkShowConditions(e){return!!this.hostSettings.enableAutoCorrect}async prepareShowContent(e){const{onApplySuggestion:t,critique:o,onCalloutPositionUpdated:i}=e;this.critique=o,this.onApplySuggestion=t,this.onCalloutPositionUpdated=i}hide(e){this.isVisible&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isVisible&&(this.resetVariablesAfterHide(),this.onDismiss(e))}resetVariablesAfterHide(){this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._gapSpace=void 0,this.instrumentationEventId=void 0,this.onApplySuggestion=void 0,this.critique=void 0,this.publishEvent("visibilityUpdated",this._isVisible)}onDismiss(e){var t;null===(t=this.onDismissCallback)||void 0===t||t.call(this,e),this.onDismissCallback=void 0}async show(e){if(!this.checkShowConditions(e))return;const{setInitialFocus:t,target:o,onDismiss:i,gapSpace:n}=e;this._target=o,this._gapSpace=n,this._setInitialFocus=t,this.onDismiss(!1),this.onDismissCallback=i,await this.prepareShowContent(e),this._isVisible=!0,this.publishEvent("visibilityUpdated",this._isVisible),this.doAfterShow()}doAfterShow(){this.logUndoCalloutOpened()}logUndoCalloutOpened(){const e=this.logger.getNewActivity(a.n.UndoCalloutShown,l.o.SamplingPolicy.CriticalExperimentation);e&&(e.success=!0,e.endNow())}clickNoActionHide(e){this.isVisible&&this.recordInstrumentationEventId(12),this.hide(e)}applyUndo(){if(this.onApplySuggestion&&this.critique&&this.critique.suggestions.length){const e=this.critique.suggestions[0];this.onApplySuggestion(this.critique,e),this.wordDictionary.addWordToIgnoreList(e.text),this.notifyAriaStatusChange("ebx_autoCorrectIgnored",e.text),this.recordInstrumentationEventId(16)}this.hide()}openSettings(){this.executeShowOptionsAction(),this.hide()}updateCalloutPosition(e,t){var o,i,n;if(this.onCalloutPositionUpdated){const r=t?null===(n=null===(i=this._undoCardV9Ref.current)||void 0===i?void 0:i.getElementRef().current)||void 0===n?void 0:n.firstChild:null===(o=this._undoCardRef.current)||void 0===o?void 0:o.firstChild;if(r){const t=r.getBoundingClientRect();this.onCalloutPositionUpdated(e,t)}}}};k=(0,i.__decorate)([(0,b._)(),(0,i.__param)(0,(0,y.W)(c.H)),(0,i.__param)(1,(0,y.W)(u.n)),(0,i.__param)(2,(0,w.l)()),(0,i.__param)(2,(0,y.W)(s.In)),(0,i.__param)(3,(0,y.W)(d.g)),(0,i.__param)(4,(0,y.W)(v.s)),(0,i.__param)(5,(0,y.W)(p.JY)),(0,i.__param)(6,(0,y.W)(h.c)),(0,i.__param)(7,(0,y.W)(m.$)),(0,i.__param)(8,(0,y.W)(g.f)),(0,i.__param)(9,(0,y.W)(f.$))],k)},1585:(e,t,o)=>{"use strict";o.d(t,{b:()=>f});var i=o(95734),n=o(37842),r=o(8676);if(3023==o.j)var s=o(47050);var a=o(48338),l=o(36747),c=o(13608);if(3023==o.j)var u=o(20193);if(3023==o.j)var d=o(29594);const h=e=>{switch(e){case a.Y.critique:return"footer_fre_in_critique_callout";case a.Y.inlineSuggestions:return"footer_fre_in_inline_suggestion_callout";default:return"footer_fre_generic"}},g=()=>{const e=(0,d.$)().getStringsFor("OnCanvasCalloutStrings"),t={nextPageTooltip:e("footerFRE_nextPageTooltip"),paginationTipsText:e("footerFRE_paginationTipsText"),previousPageTooltip:e("footerFRE_previousPageTooltip")};return{footer:e=>t[e]||""}},p=(0,n.F5)({themeStore:r.A.on(c.YQ).optional(),footerFreStore:r.A.on(a.D).optional(),languageScriptDirectionDetector:r.A.on(l.iw).optional()}),f=e=>{const{target:t,styles:o}=e,{footerFreStore:r,languageScriptDirectionDetector:a,themeStore:l}=(0,n.SM)(p),[d,f]=i.useState((()=>null==r?void 0:r.footerProps.get(t)));i.useEffect((()=>{if(!r)return;const e=e=>{const o=e.footerProps.get(t);f(o?Object.assign({},o):void 0)};return r.subscribe("stateUpdated",e),()=>{r.unsubscribe("stateUpdated",e)}}),[r,t]);const[m,v]=i.useState(null==l?void 0:l.getComponentActiveTheme(c.yF.footerFreComponentName,!0));if(i.useEffect((()=>{if(!l)return()=>{};const e=()=>{v(l.getComponentActiveTheme(c.yF.footerFreComponentName,!0))};return l.subscribe("currentThemeUpdated",e),l.subscribe("defaultThemeUpdated",e),l.subscribe("themesUpdated",e),()=>{l.unsubscribe("currentThemeUpdated",e),l.unsubscribe("defaultThemeUpdated",e),l.unsubscribe("themesUpdated",e)}}),[l]),!(null==d?void 0:d.display)||!d.pages.size)return null;const b=i.createElement(s.J,{automationId:h(t),pages:Array.from(d.pages.values()),animated:d.animated,styles:o,strings:g(),theme:m,onDismiss:()=>null==r?void 0:r.setFooterDisplay(t,!1),hideIcon:e.hideIcon});return a?i.createElement(u.K,{rtl:a.isRtl()},b):b}},86628:(e,t,o)=>{"use strict";o.d(t,{o:()=>s});var i=o(30206),n=o(19432),r=o(48828);let s=class extends n.z{constructor(){super(...arguments),this.footerProps=new Map}publishStateChange(){this.publishEvent("stateUpdated",{footerProps:this.footerProps})}setFooterDisplay(e,t){const o=this.footerProps.get(e);o&&(this.footerProps.set(e,Object.assign(Object.assign({},o),{display:t})),this.publishStateChange())}setFooterAnimated(e,t){const o=this.footerProps.get(e);o&&(this.footerProps.set(e,Object.assign(Object.assign({},o),{animated:t})),this.publishStateChange())}addFooterPage(e,t,o){var i;const n=null!==(i=this.footerProps.get(e))&&void 0!==i?i:{display:!0,pages:new Map,animated:!0};n.pages.set(t,o),n.display=!0,this.footerProps.set(e,n),this.publishStateChange()}removeFooterPage(e,t){const o=this.footerProps.get(e);o&&(o.pages.delete(t),0===o.pages.size&&(o.display=!1),this.footerProps.set(e,o),this.publishStateChange())}};s=(0,i.__decorate)([(0,r._)()],s)},24628:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>d}),3023==o.j)var i=o(93028);var n=o(37842),r=o(8676);if(3023==o.j)var s=o(21218);var a=o(48338),l=o(38716),c=o(95734);const u=(0,n.F5)({localizer:r.A.on(l.H),footerFreStore:r.A.on(a.D)}),d=e=>{var t;const{theme:o,style:r,languageName:l,undoCallback:d,manageLanguagesCallback:h}=e,{localizer:g,footerFreStore:p}=(0,n.KN)(u),f=()=>{p.removeFooterPage(a.Y.languageAutoDetection,s.Id)};return c.createElement("div",{style:Object.assign({color:null!==(t=null==o?void 0:o.textColor)&&void 0!==t?t:"#323130",minWidth:250},r)},c.createElement("div",{style:{marginBottom:12,paddingRight:14}},g.getMessage("autoDetectionFRE_HeadingText",l)),c.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},c.createElement(i.$,{appearance:"transparent",style:{fontSize:12,padding:2,minWidth:"fit-content",height:"revert",minHeight:24},onClick:()=>{d(),f()}},g.getMessage("autoDetectionFRE_UndoButtonText",l)),c.createElement(i.$,{style:{borderRadius:4,marginLeft:8,fontSize:12,height:"fit-content",minHeight:24,textAlign:"left",paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2},onClick:()=>{h(),f()}},g.getMessage("autoDetectionFRE_ManageLanguagesText",l))))}},21218:(e,t,o)=>{"use strict";o.d(t,{Id:()=>m,lP:()=>v,sy:()=>b});var i=o(37842),n=o(8676);if(3023==o.j)var r=o(10056);var s=o(48338);if(3023==o.j)var a=o(68023);if(3023==o.j)var l=o(67971);if(3023==o.j)var c=o(23094);if(3023==o.j)var u=o(9420);if(3023==o.j)var d=o(1585);var h=o(13608);if(3023==o.j)var g=o(63503);var p=o(95734);const f=(0,i.F5)({footerFreStore:n.A.on(s.D)}),m="LanguageAutoDetection",v="lang-auto-detect-footer",b=()=>{const{footerFreStore:e}=(0,i.KN)(f),[t,o]=p.useState((()=>e.footerProps.get(s.Y.languageAutoDetection)));return p.useEffect((()=>{const t=e=>{const t=e.footerProps.get(s.Y.languageAutoDetection);o(t?Object.assign({},t):void 0)};return e.subscribe("stateUpdated",t),()=>{e.unsubscribe("stateUpdated",t)}}),[e]),(null==t?void 0:t.display)&&1===t.pages.size?p.createElement(y,null):null},y=()=>{var e,t;const o=p.useContext(h.O1),i=null!==(e=(0,g.ZY)())&&void 0!==e?e:document,n=null!==(t=i.defaultView)&&void 0!==t?t:window,[f,m]=p.useState(w(i)),[b,y]=p.useState(!0),C=p.useCallback((()=>{m(w(i))}),[i,m]);if(p.useEffect((()=>{const e=new c.J(n);return e.addListener("resize",C,{passive:!0,capture:!0}),()=>{e.removeAllListeners()}}),[C,n]),o){const e={popover:{id:v,withArrow:!1,open:b,onOpenChange:(e,t)=>{y(t.open)},positioning:{target:(0,u.ug)(f),align:"center",position:"above",offset:e=>({mainAxis:8})}},surface:{style:{padding:0,background:"transparent",borderRadius:8}}};return p.createElement(l.v,Object.assign({},e),p.createElement(d.b,{target:s.Y.languageAutoDetection}))}return p.createElement(a.U,{id:v,target:f,directionalHint:r.A.topCenter,isBeakVisible:!1,gapSpace:8,style:{borderRadius:8},styles:{root:{borderRadius:8},calloutMain:{background:"transparent"}}},p.createElement(d.b,{target:s.Y.languageAutoDetection}))};function w(e){return{x:e.body.clientWidth-240,y:e.body.clientHeight-13}}},35700:(e,t,o)=>{"use strict";o.d(t,{Nt:()=>c,cu:()=>u});var i=o(96346),n=o(16971),r=o(99120),s=o(2579),a=o(95734),l=o(38883);function c(e,t,o){return new h(e,t,o)}function u(e,t){const o=new d(e);return{element:a.createElement(g,{eccUxReplacement:o,commonOptions:t}),eccUxReplacement:o}}class d{constructor(e){this.iframeElement=e,this.eccStateChanged=e=>{var t;null===(t=this.listener)||void 0===t||t.call(this,e)},this.setListener=e=>{this.listener=e}}dispose(){this.listener&&(this.listener(void 0),this.listener=void 0)}}class h extends d{constructor(e,t,o){super(t),this.editorCard=document.createElement("external-editor-card"),this.editorCard.setAttribute("style","position:absolute;top:0px;left:0px;z-index:auto;display: block !important"),e.appendChild(this.editorCard),(0,r.d)(this.editorCard,a.createElement(g,{eccUxReplacement:this,commonOptions:o}))}dispose(){this.editorCard&&(l.unmountComponentAtNode(this.editorCard),this.editorCard.remove(),this.editorCard=void 0),super.dispose()}}const g=e=>{var t;const{iframeElement:o,setListener:r}=e.eccUxReplacement,[l,c]=a.useState(),u=a.useCallback((e=>{c(e)}),[c]);if(a.useEffect((()=>(r(u),()=>{r(void 0)})),[u,r]),!l)return null;const d=function(e,t){var o,i;if(!e||!t||"string"==typeof t)return t;let n=e.getBoundingClientRect();const r=getComputedStyle(e),s=parseFloat(r.borderWidth.replace("px",""));return n=new DOMRect(n.left+s,n.top+s,n.width-s-s,n.height-s-s),"left"in t&&"top"in t&&t.left&&t.top?"width"in t&&"height"in t?{left:t.left+n.left,right:t.left+n.left+t.width,top:t.top+n.top,bottom:t.top+n.top+t.height,width:t.width,height:t.height}:{x:(null!==(o=t.left)&&void 0!==o?o:0)+n.left,y:(null!==(i=t.top)&&void 0!==i?i:0)+n.top}:"x"in t&&"y"in t?{x:t.x+n.left,y:t.y+n.top}:t}(o,l.targetLocation);return d?a.createElement(n.O.Provider,{value:!!(null===(t=e.commonOptions)||void 0===t?void 0:t.useFluentV9)},a.createElement("div",{dir:l.calloutProps.isRtl?"rtl":"ltr",style:{all:"initial"}},a.createElement(i.$,Object.assign({},l,{targetWindow:new s.O(window),targetLocation:d,isMobile:!1,isRtl:l.calloutProps.isRtl})))):null}},87524:(e,t,o)=>{"use strict";o.d(t,{V:()=>_});var i=o(95734);if(3023==o.j)var n=o(26017);if(3023==o.j)var r=o(23094);if(3023==o.j)var s=o(17011);if(3023==o.j)var a=o(5534);if(3023==o.j)var l=o(68916);if(3023==o.j)var c=o(60970);if(3023==o.j)var u=o(7044);if(3023==o.j)var d=o(1585);if(3023==o.j)var h=o(37156);if(3023==o.j)var g=o(4812);if(3023==o.j)var p=o(57284);if(3023==o.j)var f=o(21648);if(3023==o.j)var m=o(49691);if(3023==o.j)var v=o(48338);if(3023==o.j)var b=o(82931);if(3023==o.j)var y=o(16971);if(3023==o.j)var w=o(24607);if(3023==o.j)var C=o(40868);if(3023==o.j)var S=o(31012);if(3023==o.j)var k=o(53479);function T(e,t,o){var i;return o?o.message:null!==(i=null==e?void 0:e.customizedEmptyECCSuggestionsString)&&void 0!==i?i:t("suggestionsGroupNoSuggestionsText")}function x(e,t,o,i){const n={clearSearchLabel:t("clearSearchLabel"),showAvailableSuggestionsLabel:t("showAvailableSuggestionsLabel"),somethingWentWrongLabel:t("somethingWentWrongLabel"),tryAgainLabel:t("tryAgainLabel"),suggestionsGroupSearchResultAccessibilityLabel:t("suggestionsGroupSearchResultAccessibilityLabel"),combineSentences:t("combineSentences"),newTagText:t("newTagText"),discoveryPromoFooterText:t("discoveryPromoFooterText"),emailSentBy:t("emailSentBy"),feedbackText:t("feedbackText"),meetingSeries:t("meetingSeries"),recordText:t("recordText"),tabAriaLabel:t("allTabAriaLabel"),overflowTabAriaLabel:t("overflowTabAriaLabel"),expandedInlineSuggestionsSearchBarPlaceholder:t("expandedInlineSuggestionsSearchBarPlaceholder"),startTypingToSearch:t("startTypingToSearch"),moreButtonQuantityText:t("moreButtonQuantityText")},r={ignoreAll:o("ebx_ignoreAllButtonLabel"),ignoreOnce:o("ebx_ignoreOnceButtonLabel"),ignoreRule:o("ebx_disableCritiqueButton"),options:o("ebx_changeSettingsCommandLabel"),giveFeedbackButtonText:o("ebx_giveFeedback"),editorButtonTooltipContent:o("ebx_settingsButtonTooltip"),editorButtonText:o("editorButtonText"),footerSeeMoreActionsAccessibilityLabel:o("ebx_moreButtonArialLabel")},s={suggestionsGroupNoSuggestionsText:T(e,t,i)};return Object.assign(Object.assign({},function(){const e=Array(),t={};for(const o of e)t[o]=e=>"";return t}()),{inlineSuggestions:e=>n[e]||"",common:e=>s[e]||"",critique:e=>r[e]||""})}const _=e=>{var t,o,C,T,_,E,B,A,R,M,D,P,F,O,N,q,j,L,z,H;const W=i.useContext(y.O),{calloutProps:U,layerHostId:G,isRtl:V,styles:$}=e,{calloutStrings:K,currentScope:J,enableExpandedECC:Y,enableScopedHeader:Q,expandedEccSearchBarConfig:Z,getLocale:X,expandedECCHeader:ee,inlineSuggestionsStrings:te,isDividerShown:oe,isFeedbackEnabled:ie,isFeedbackButtonEnabled:ne,onFeedbackButtonClicked:re,isFlightEnabled:se,isLoading:ae,oaSettings:le,onGroupSelected:ce,onItemSelected:ue,onProcessedResults:de,onUserInteraction:he,resultReset:ge,suggestions:pe,style:fe,theme:me,handleKeyDown:ve,triggerMethod:be,appGptConfig:ye,unsupportedEntities:we,removeComposingBoxQuery:Ce}=U,Se=U.searchBoxQueryString.length>0?U.searchBoxQueryString:U.queryString,ke=null==we?void 0:we.find((e=>e.entityType===(null==J?void 0:J.entityType))),Te=null===(t=null==le?void 0:le.bestMatchConfig)||void 0===t?void 0:t.enabled,xe=null==le?void 0:le.enablePrefixHighlighting,_e=new Map,Ie=i.useRef([]),Ee=[],Be=i.useRef(ee),[Ae,Re]=i.useState(null);Y&&(Be.current=Be.current.map((e=>{var t,o,i;return Object.assign(Object.assign({},e),{isSelected:!(null==J?void 0:J.entityType)&&!(null===(t=e.scopeInfo)||void 0===t?void 0:t.entityType)||(null==J?void 0:J.entityType)===(null===(o=e.scopeInfo)||void 0===o?void 0:o.entityType)||!J&&e.isSelected&&1===(null===(i=null==le?void 0:le.entitiesEnabled)||void 0===i?void 0:i.length)})})),Be.current.length&&!Be.current.some((e=>e.isSelected))&&(Be.current=[Object.assign(Object.assign({},Be.current[0]),{isSelected:!0}),...Be.current.slice(1)]));let Me=!1;if(!ae){const e=pe.slice().sort(((e,t)=>{var o,i;return(null!==(o=e.priority)&&void 0!==o?o:0)-(null!==(i=t.priority)&&void 0!==i?i:0)}));let t;for(const i of e)for(const[,r]of i.entities.entries()){Me=Me||r.entityType===n.c.PIM;const s=Te&&r.isBestMatch,a=s?"":null!==(o=i.groupTitle)&&void 0!==o?o:r.entityType===n.c.PIM?(0,h.X)(r.type,r.IntentId):(0,h.X)(r.type);if(r.icon&&(r.icon.iconName=(0,g.S)(r.icon.iconName)),r.entityType===n.c.People&&I(r,V),r.entityType===n.c.Scope&&(null===(C=r.scopeInfo)||void 0===C?void 0:C.entityType)&&r.scopeInfo.entityType!==n.c.External&&(r.title=(0,h.X)(r.scopeInfo.entityType)),xe&&!r.hitHighlightIndexes){const e=r[null!==(T=r.titleHitHighlightProperty)&&void 0!==T?T:"title"],t=r[null!==(_=r.subtitleHitHighlightProperty)&&void 0!==_?_:"subtitle"];r.hitHighlightIndexes=(0,p.J)([Se],e,"title").concat(t?(0,p.J)([Se],t,"subTitle"):[])}let l=_e.get(a);if(!l)if(l=Object.assign(Object.assign(Object.assign({title:a,subtitle:i.groupSubtitle,suggestions:[]},(null==J?void 0:J.entityType)===e[0].entityType&&{isScoped:!0}),r.entityType===n.c.Scope&&{isScopingEnabled:!1,showSeparator:!0}),oe&&{showSeparator:!0}),_e.set(a,l),s)Ee.unshift(l);else if(i.entityType===n.c.Scope)t=l;else{if(J&&J.entityType!==i.entityType)continue;if(!J&&(null==we?void 0:we.some((e=>e.entityType===i.entityType))))continue;Ee.push(l)}l.suggestions.push(r)}if(t&&Ee.push(t),null==le?void 0:le.preventAllTabBackfill){const e=!J,t=(null===(E=Ee[0])||void 0===E?void 0:E.suggestions.length)>0;Y&&e&&t&&Ee.splice(1)}(null==le?void 0:le.gptResultsLengthCap)&&"App"===(null===(B=Ee[0])||void 0===B?void 0:B.title)&&(null===(A=Ee[0])||void 0===A||A.suggestions.splice(le.gptResultsLengthCap)),Ee.length&&(Ee[0].showSeparator=!1),de()}const De=i.useCallback((()=>{he()}),[he]),Pe=i.useCallback((e=>{if(Ae){if(Z&&be!==f.P.AttachFile&&be!==f.P.Fre){const t=Ae.querySelectorAll("input[type=search]")[0];0===(null==t?void 0:t.value.length)&&e.target===t&&setTimeout((()=>{t.value=Se||""}),100)}if(!Y&&(0,m.m)(e.target)&&"BUTTON"!==e.target.nodeName&&"INPUT"!==e.target.nodeName){e.preventDefault();const t=e.relatedTarget;null==t||t.focus()}}}),[Ae,Y,Z,Se,be]),[Fe,Oe]=i.useState(!1),[Ne,qe]=i.useState(!1),je=i.useRef(!0);i.useEffect((()=>{if(!Ae)return;const e=Ae.ownerDocument,t=Ae.querySelectorAll("input[type=search]")[0],o=e.querySelectorAll('[data-ms-editor="true"]')[0];Z&&t&&(be===f.P.AttachFile||o&&e.activeElement===o)&&je.current&&(je.current=!1,be===f.P.AttachFile||be===f.P.Fre?null==Ce||Ce(""!==Se):t.setAttribute("placeholder",""!==Se?Se:te("expandedInlineSuggestionsSearchBarPlaceholder")))}),[Ae,Z,te,Se,Ce,be]),i.useEffect((()=>{var e;if(!Ae)return;const t=null!==(e=Ae.ownerDocument.defaultView)&&void 0!==e?e:window;function o(){Oe(t.matchMedia("(max-width: 480px)").matches),qe(t.matchMedia("(max-height: 480px)").matches)}o();const i=new r.J(t);i.addListener("resize",o);const n=Ae.closest(".ms-ecc-callout"),s=n&&new r.J(n);return null==s||s.addListener("keydown",ve),()=>{i.removeAllListeners(),null==s||s.removeAllListeners()}}),[Ae,ve]);const Le=se("mc-editor-expanded-ecc-responsive"),ze=se("mc-editor-enable-meeting-banner");(ge||!ae||Ee.length)&&(Ie.current=Q?(0,k.k)(Ee):Ee);const He=te("managePersonalInfoLinkText"),We=te("managePersonalInfoLinkUrl"),Ue=te("meetingBannerText"),Ge=null!==(R=null==X?void 0:X())&&void 0!==R?R:"en-US",Ve={results:Ie.current,queryString:Se,onItemSelected:ue,onGroupSelected:ce,theme:me,style:fe,styles:$,isError:U.isError,strings:x(le,te,K,ke),onAction:U.onAction,isLoading:U.isLoading,keyboardHandlerTarget:Y?void 0:U.keyboardHandlerTarget,expandedKeyboardHandlerTarget:Y?U.keyboardHandlerTarget:void 0,menuType:U.menuType,onFooterAction:U.onFooterAction,enablePrefixHighlighting:xe,showMoreEntitiesConfig:U.showMoreEntitiesConfig,browseThisComputerConfig:U.browseThisComputerConfig,layerHostId:G,showDiscoveryPromoFooter:null==le?void 0:le.enableDiscoveryPromoFooter,noSuggestionsHeaderInfo:U.noSuggestionsHeaderInfo,locale:Ge,appGptConfig:ye,enableMeetingBanner:ze,showMeetingBanner:ze&&(null==J?void 0:J.entityType)===n.c.Event,meetingBannerText:Ue,isUnsupported:!!ke},$e=i.useMemo((()=>(0,w.jI)()?"rtl":"ltr"),[]),Ke=(0,S.Z)(U.menuParentElement,null!==(M=U.enableExpandedECC)&&void 0!==M&&M,U.accessibilitySettings),Je=(0,i.useContext)(b.D),Ye=null!==(P=null!==(D=U.fluentTheme)&&void 0!==D?D:Je)&&void 0!==P?P:"dark"===e.themeType?l.C:c.o;return i.createElement("div",{ref:Re,onMouseEnter:De,onFocus:Pe},Y?i.createElement(u.q,{theme:Ye,dir:$e,id:"inline-suggestions-fluent-provider"},i.createElement(s._,Object.assign({},Ve,{scopes:{title:"",isScopingEnabled:!1,suggestions:Be.current},useFURNTabList:W,onItemFocused:Ke,disableTooltips:!0,isFeedbackEnabledForEcc:ie,isFeedbackButtonEnabled:ne,onFeedbackButtonClicked:re,enableResponsiveLayout:Le,isSmallWindow:Le&&Fe,isSmallHeight:Le&&Ne,expandedEccSearchBarConfig:Z,themeType:e.themeType}))):i.createElement(a.x,Object.assign({},Ve,{onFocus:Ke,enableScopedHeader:Q,disableTooltips:null==le?void 0:le.disableInlineSuggestionTooltips})),Me?i.createElement("div",{style:{height:"32px",padding:"4px 12px"}},i.createElement("a",{href:We,target:"_blank",rel:"noreferrer","aria-label":He,style:{textDecoration:"unset",color:"#0078D4",fontSize:12,lineHeight:"16px"}},He)):null,i.createElement(d.b,{target:v.Y.inlineSuggestions,styles:{container:{borderRadius:{topStart:0,topEnd:0,bottomStart:null!==(O=null===(F=null==$?void 0:$.containerStyles)||void 0===F?void 0:F.borderRadius)&&void 0!==O?O:8,bottomEnd:null!==(q=null===(N=null==$?void 0:$.containerStyles)||void 0===N?void 0:N.borderRadius)&&void 0!==q?q:8},minWidth:null!==(L=null===(j=null==$?void 0:$.containerStyles)||void 0===j?void 0:j.minWidth)&&void 0!==L?L:300,maxWidth:null!==(H=null===(z=null==$?void 0:$.containerStyles)||void 0===z?void 0:z.maxWidth)&&void 0!==H?H:420}}}))};function I(e,t){e.initials=(0,C.I)(e.displayName,t)}},9964:(e,t,o)=>{"use strict";o.d(t,{b:()=>h});var i=o(37842),n=o(8676),r=o(44680),s=o(36747),a=o(21648);if(3023==o.j)var l=o(96346);if(3023==o.j)var c=o(16971);var u=o(95734);const d=(0,i.F5)({hostSettings:n.A.on(r.n),inlineSuggestionsRenderer:n.A.on(a.V),languageScriptDirectionDetector:n.A.on(s.iw).optional()}),h=()=>{var e,t,o,n,r;const{hostSettings:s,inlineSuggestionsRenderer:a,languageScriptDirectionDetector:h}=(0,i.KN)(d),[g,p]=u.useState(null!==(e=a.getCalloutStateStore().getCalloutState())&&void 0!==e?e:null);return u.useEffect((()=>{const e=a.getCalloutStateStore(),t=()=>{var t;p(null!==(t=e.getCalloutState())&&void 0!==t?t:null)};return e.subscribe("menuUpdated",t),()=>{e.unsubscribe("menuUpdated",t)}}),[a]),(null==g?void 0:g.targetLocation)?u.createElement(c.b.Provider,{value:!!s.useUiCoherence},u.createElement(l.$,Object.assign({},g,{isRtl:null!==(t=null==h?void 0:h.isRtl())&&void 0!==t&&t,isMobile:null!==(r=null===(n=null===(o=s.oaSettings)||void 0===o?void 0:o.enableECCForMobileDevice)||void 0===n?void 0:n.enabled)&&void 0!==r&&r}))):null}},96346:(e,t,o)=>{"use strict";if(o.d(t,{$:()=>g}),3023==o.j)var i=o(30206);var n=o(95734);if(3023==o.j)var r=o(68023);if(3023==o.j)var s=o(67971);if(3023==o.j)var a=o(87524);if(3023==o.j)var l=o(4326);if(3023==o.j)var c=o(4497);var u=o(13608);if(3023==o.j)var d=o(16971);if(3023==o.j)var h=o(9420);const g=e=>{var t,o,g,p,f,m,v,b,y,w,C,S,k,T,x,_,I;const E=n.useContext(u.O1),B=n.useContext(d.b),{maxHeightCallback:A,targetLocation:R,isMobile:M}=e,{isLoading:D,isFlightEnabled:P,onDismissed:F,onFirstRender:O,onPreventDismissOnEvent:N,onRenderResults:q,onRestoreFocus:j,style:L,styles:z,theme:H}=e.calloutProps;let W=!0;const[U,G]=n.useState(!0);n.useEffect((()=>{O()}),[O]),n.useEffect((()=>{D||q()}),[D,q]);const V=n.useCallback((e=>{e&&"key"in e&&l.x.isKey(e,c.m.escape)&&(e.preventDefault(),e.stopPropagation()),e&&"focus"===e.type&&(W=!1),F(!1)}),[F]),$=n.useCallback((e=>{W&&j(e,(()=>{var t;null===(t=e.originalElement)||void 0===t||t.focus()}))}),[j,W]),K=z||{},{calloutStyles:J}=K,Y=(0,i.__rest)(K,["calloutStyles"]),Q=Y.containerStyles||{},Z=P("mc-editor-expanded-ecc-responsive"),X=null!==(p=null!==(o=null===(t=null==z?void 0:z.calloutStyles)||void 0===t?void 0:t.borderRadius)&&void 0!==o?o:null===(g=null==H?void 0:H.callout)||void 0===g?void 0:g.borderRadius)&&void 0!==p?p:B?12:8;if(!e.targetLocation)return null;const ee=null==A?void 0:A(e.targetLocation,null!==(f=e.targetWindow.deref())&&void 0!==f?f:window),te=null===(m=e.directionalHintCallback)||void 0===m?void 0:m.call(e,e.targetLocation,null!==(v=e.targetWindow.deref())&&void 0!==v?v:window,ee);let oe,ie="absolute";if(M&&(ie="fixed",oe=!0),E){const t=Z?{borderRadius:X,width:"fit-content"}:Object.assign({borderRadius:X,width:null===(k=null==H?void 0:H.callout)||void 0===k?void 0:k.width},J),o={moveFocusIntoModalizer:!0,popover:{unstable_disableAutoFocus:!0,trapFocus:!1,withArrow:null!==(x=null===(T=null==H?void 0:H.callout)||void 0===T?void 0:T.isBeakVisible)&&void 0!==x&&x,open:U,onOpenChange:(e,t)=>{!t.open&&(null==N?void 0:N(e))||(G(t.open),t.open||V())},positioning:Object.assign(Object.assign({},(0,h.Sg)(te)),{target:(0,h.ug)(R),strategy:ie,autoSize:oe})},surface:{className:"ms-ecc-callout",style:Object.assign({padding:0,maxWidth:480,maxHeight:ee,overflow:"hidden",border:null===(_=null==H?void 0:H.callout)||void 0===_?void 0:_.border,boxShadow:null===(I=null==H?void 0:H.callout)||void 0===I?void 0:I.shadow},t)}};return n.createElement(s.v,Object.assign({},o),n.createElement(a.V,{calloutProps:e.calloutProps,themeType:e.currentThemeType,isRtl:e.isRtl,styles:(null==L?void 0:L.fitToContent)||Q.maxHeight?Object.assign(Object.assign({},Y),{containerStyles:Object.assign(Object.assign({},Q),{maxHeight:ee})}):Y}))}return n.createElement(r.U,{className:"ms-ecc-callout",target:(0,h.KV)(R),shouldDismissOnWindowFocus:!1,onDismiss:V,preventDismissOnEvent:N,gapSpace:0,doNotLayer:!1,isBeakVisible:null!==(y=null===(b=null==H?void 0:H.callout)||void 0===b?void 0:b.isBeakVisible)&&void 0!==y&&y,directionalHint:te,alignTargetEdge:!0,onRestoreFocus:$,calloutMaxHeight:ee,style:Z?{borderRadius:X,width:"fit-content"}:Object.assign({borderRadius:X,width:null===(w=null==H?void 0:H.callout)||void 0===w?void 0:w.width},J),styles:{beakCurtain:{borderRadius:X},calloutMain:{overflow:"hidden",border:null===(C=null==H?void 0:H.callout)||void 0===C?void 0:C.border,borderRadius:X,boxShadow:null===(S=null==H?void 0:H.callout)||void 0===S?void 0:S.shadow},root:{borderRadius:X,width:"fit-content",maxHeight:"none !important"}}},n.createElement(r.d.Consumer,null,(t=>n.createElement(a.V,{calloutProps:e.calloutProps,isRtl:e.isRtl,styles:(null==L?void 0:L.fitToContent)||Q.maxHeight?Object.assign(Object.assign({},Y),{containerStyles:Object.assign(Object.assign({},Q),{maxHeight:ee})}):Y,themeType:e.currentThemeType,layerHostId:t}))))}},31012:(e,t,o)=>{"use strict";o.d(t,{Z:()=>a});var i=o(95734);if(3023==o.j)var n=o(26017);if(3023==o.j)var r=o(31685);if(3023==o.j)var s=o(3755);const a=(e,t,o)=>{const a=i.useRef(),l=i.useRef(),c=i.useRef(new r.c({enableClearingOfRequestedAnimationFrames:!0})),u=i.useCallback((()=>{a.current&&(a.current.remove(),a.current=void 0),l.current?(l.current.removeAttribute("aria-activedescendant"),l.current.removeAttribute("aria-controls"),l.current.removeAttribute("aria-owns"),l.current=void 0):(null==e||e.removeAttribute("aria-activedescendant"),null==e||e.removeAttribute("aria-controls"),null==e||e.removeAttribute("aria-owns"))}),[e]),d=i.useCallback(((e,t)=>{c.current.requestAnimationFrame((()=>{var i,n;const r=e.getRootNode(),l=e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`);if(!(null==l?void 0:l.ariaLabel)||!(0,s.C)(r,"ShadowRoot"))return;if(null==o?void 0:o.enableExpandedECCAccessibilityElement){if(a.current)a.current.removeAttribute("aria-label"),a.current.removeAttribute("role");else{a.current=e.ownerDocument.createElement("div"),a.current.setAttribute("role","listBox");const t=e.ownerDocument.querySelector("#inlineSuggestionsEnclosingDiv");a.current.setAttribute("aria-label",(null==t?void 0:t.getAttribute("aria-label"))||"")}a.current.style.cssText="width: 0; height: 0; overflow: hidden;"}a.current||(a.current=e.ownerDocument.createElement("div"),a.current.setAttribute("role","listbox"),a.current.style.cssText="width: 0; height: 0; overflow: hidden;");const c=e.ownerDocument.createElement("button");(null==o?void 0:o.enableExpandedECCAccessibilityElement)?(c.setAttribute("role",l.getAttribute("role")||"option"),c.setAttribute("type",l.getAttribute("type")||"button"),c.id=t.focusedItemHtmlId,c.innerText=l.ariaLabel,c.ariaLabel=l.ariaLabel,l.id.includes("header")||l.id.includes("overflow")?(a.current.setAttribute("aria-label","tablist"),c.ariaPosInSet=String(Number(l.id.substring(l.id.length-1,l.id.length))+1),c.ariaSetSize=String(null===(n=null===(i=l.parentElement)||void 0===i?void 0:i.parentElement)||void 0===n?void 0:n.children.length),c.ariaSelected=l.getAttribute("aria-selected")):(c.ariaPosInSet=l.ariaPosInSet,c.ariaSetSize=l.ariaSetSize,c.ariaSelected="true")):(c.setAttribute("role","option"),c.setAttribute("type","button"),c.id=t.focusedItemHtmlId,c.innerText=l.ariaLabel,c.ariaLabel=l.ariaLabel,c.ariaPosInSet=l.ariaPosInSet,c.ariaSetSize=l.ariaSetSize,c.ariaSelected="true"),a.current.children.length&&a.current.children[0].remove(),a.current.appendChild(c),r.appendChild(a.current)}))}),[null==o?void 0:o.enableExpandedECCAccessibilityElement]),h=i.useCallback((t=>{c.current.requestAnimationFrame((()=>{var o;const i=null==e?void 0:e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`),r=(null===(o=t.selection)||void 0===o?void 0:o.type)===n.c.Scope.toLowerCase();i&&r&&(t.selection&&"scope"in t.selection&&t.selection.scope.isSelected?i.ariaSelected="true":i.ariaSelected="false")}))}),[e]),g=i.useCallback((i=>{if(i.focusedItemHtmlId){if(!e)return;t&&h(i),(null==o?void 0:o.enableDetachedAccessibilityElementForEcc)&&d(e,i),e.setAttribute("aria-activedescendant",i.focusedItemHtmlId),e.setAttribute("aria-controls",i.focusedItemHtmlId),e.setAttribute("aria-owns",i.focusedItemHtmlId),l.current=e}else u()}),[o,t,d,h,e,u]);return i.useEffect((()=>()=>{u()}),[u]),g}},40842:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>l}),3023==o.j)var i=o(86628);if(3023==o.j)var n=o(48338);if(3023==o.j)var r=o(66886);if(3023==o.j)var s=o(48692);if(3023==o.j)var a=o(97428);class l{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918212)}configureRootServices(e){e.bind(n.D).to(i.o),e.bind(r.j).to(s.S)}}},37035:(e,t,o)=>{"use strict";if(o.d(t,{Q:()=>l}),3023==o.j)var i=o(63282);if(3023==o.j)var n=o(9964);if(3023==o.j)var r=o(61137);if(3023==o.j)var s=o(82285);if(3023==o.j)var a=o(97428);class l{constructor(){this.imports=[r.N,s.h]}get uniqueId(){return(0,a.z)(507918216)}configureRootServices(e){e.bind(i.i).toValue(n.b)}}},45985:(e,t,o)=>{"use strict";o.d(t,{R:()=>d});var i=o(37842),n=o(8676),r=o(66886),s=o(87276),a=o(38716);if(3023==o.j)var l=o(89001);var c=o(95734);const u=(0,i.F5)({multilingualStore:n.A.on(r.j),critiqueCalloutStateStore:n.A.on(s.v),localizer:n.A.on(a.H)}),d=e=>{var t;const{theme:o,style:n}=e,{critiqueCalloutStateStore:r,multilingualStore:s,localizer:a}=(0,i.KN)(u);return c.createElement("div",{style:Object.assign({color:null!==(t=null==o?void 0:o.textColor)&&void 0!==t?t:"#323130"},n)},c.createElement("div",{style:{marginBottom:8}},c.createElement("b",null,a.getMessage("multilingualFRE_HeadingText"))),a.getMessage("multilingualFRE_DescriptionText")," ",c.createElement("br",null),c.createElement(l.N,{style:{fontSize:12},onClick:()=>{r.hide(),s.showEditorSettings()},"aria-label":a.getMessage("multilingualFRE_DescriptionButtonLinkAriaLabel"),"data-is-focusable":!0},a.getMessage("multilingualFRE_DescriptionButtonLink")))}},48692:(e,t,o)=>{"use strict";o.d(t,{S:()=>u});var i=o(30206),n=o(95734),r=o(48338),s=o(45985),a=o(48828),l=o(90424);const c="multilingualProofingFre";let u=class{constructor(e){this.footerFreStore=e}addMultilingualProofingFre(){this.footerFreStore.addFooterPage(r.Y.critique,c,{icon:"LocaleLanguage",content:(e,t)=>n.createElement(s.R,{style:e,theme:t})})}removeMultilingualProofingFre(){this.footerFreStore.removeFooterPage(r.Y.critique,c)}setOnShowEditorSettings(e){this._onShowEditorSettings=e}showEditorSettings(){this._onShowEditorSettings&&this._onShowEditorSettings(!0)}};u=(0,i.__decorate)([(0,a._)(),(0,i.__param)(0,(0,l.W)(r.D))],u)},70479:(e,t,o)=>{"use strict";o.d(t,{a:()=>b});var i=o(95734),n=o(37842),r=o(8676);if(3023==o.j)var s=o(10056);if(3023==o.j)var a=o(4812);if(3023==o.j)var l=o(68023);if(3023==o.j)var c=o(67971);if(3023==o.j)var u=o(23094);if(3023==o.j)var d=o(9420);var h=o(13608);if(3023==o.j)var g=o(97782);if(3023==o.j)var p=o(4326);if(3023==o.j)var f=o(4497);if(3023==o.j)var m=o(59901);const v=(0,n.F5)({styleStore:r.A.on(h.UC).optional(),themeStore:r.A.on(h.YQ).optional()}),b=e=>{var t,o,r,b,y,w,C,S,k,T,x;const _=i.useContext(h.O1),{styleStore:I,themeStore:E}=(0,n.KN)(v),{nudge:B,nudgeDisplayLocation:A,nudgeTargetDocumentRef:R,onAcceptNudgeAction:M,onHideNudge:D,inlineNudge:P,insertionCharacter:F}=e,O=null!==(o=null===(t=R.deref())||void 0===t?void 0:t.defaultView)&&void 0!==o?o:window,[N,q]=i.useState(null==E?void 0:E.getComponentActiveTheme(P?h.yF.inlineNudgeBubbleComponentName:h.yF.nudgeBubbleComponentName));i.useEffect((()=>{if(!E)return()=>{};const e=()=>{q(E.getComponentActiveTheme(P?h.yF.inlineNudgeBubbleComponentName:h.yF.nudgeBubbleComponentName))};return E.subscribe("currentThemeUpdated",e),E.subscribe("defaultThemeUpdated",e),E.subscribe("themesUpdated",e),()=>{E.unsubscribe("currentThemeUpdated",e),E.unsubscribe("defaultThemeUpdated",e),E.unsubscribe("themesUpdated",e)}}),[P,E]);const[j,L]=i.useState(!1),[z,H]=i.useState(!0),W=i.useRef(void 0),U=i.useCallback((e=>{O.clearTimeout(W.current),W.current=e}),[O]),G=i.useCallback(((e,t)=>{O.clearTimeout(W.current),D(e,t)}),[D,O]),V=i.useCallback((()=>{O.clearTimeout(W.current),L(!0)}),[L,O]),$=i.useCallback((()=>{U(O.setTimeout((()=>{G("timeout 5000")}),5e3)),L(!1)}),[G,U,O]),K=i.useCallback((()=>M("click",!0)),[M]);i.useEffect((()=>(U(O.setTimeout((()=>{G("timeout 5000")}),5e3)),()=>{O.clearTimeout(W.current)})),[]);const J=i.useCallback((e=>{p.x.isKey(e,f.m.escape)?(e.stopPropagation(),e.preventDefault(),G(e.key)):p.x.isKey(e,f.m.enter)||p.x.isKey(e,f.m.backspace)?G(e.key):p.x.isKey(e,"v",void 0,!0)?G("user pasted text",!0):(p.x.isKey(e,f.m.tab)||e.key===F)&&(e.stopPropagation(),e.preventDefault(),M(e.key,!0))}),[G,F,M]),Y=i.useCallback((()=>{G("MouseDown")}),[G]),Q=i.useCallback((()=>{G("Scroll")}),[G]),Z=i.useCallback((()=>{G("Resize")}),[G]);i.useEffect((()=>{const e=new u.J(R),t=new u.J(O);return e.addListener("keydown",J,{capture:!0}),e.addListener("mouseup",Y),t.addListener("resize",Z),t.addListener("scroll",Q,{capture:!0}),()=>{e.removeAllListeners(),t.removeAllListeners()}}),[J,Y,Q,Z,R,O]);const X=null==I?void 0:I.getComponentStyle(P?h.yF.inlineNudgeBubbleComponentName:h.yF.nudgeBubbleComponentName),ee=_?function(e){return e?{background:{resting:m.L.colorNeutralBackground5,hover:m.L.colorNeutralBackground5Hover},text:{resting:m.L.colorNeutralForeground3}}:{background:{resting:m.L.colorNeutralBackground1,hover:m.L.colorNeutralBackground1Hover},text:{resting:m.L.colorNeutralForeground1},highlight:{text:{resting:m.L.colorNeutralForeground1},background:{resting:m.L.colorNeutralBackground3,hover:m.L.colorNeutralBackground3Hover}}}}(P):N,te=B.entityResults?(0,a.S)(null!==(b=null===(r=B.entityResults.entities[0].icon)||void 0===r?void 0:r.iconName)&&void 0!==b?b:""):void 0,oe=null!==(y=null==X?void 0:X.borderRadius)&&void 0!==y?y:P?4:15,ie=null!==(w=null==X?void 0:X.fontSize)&&void 0!==w?w:"10pt",ne=null==X?void 0:X.fontWeight,re=null!==(C=null==X?void 0:X.paddingTop)&&void 0!==C?C:2,se=null!==(S=null==X?void 0:X.paddingBottom)&&void 0!==S?S:2,ae=null!==(k=null==X?void 0:X.paddingLeftRight)&&void 0!==k?k:8,le=null==X?void 0:X.lineHeight,ce=P?s.A.rightTopEdge:s.A.bottomCenter,ue=P?"none":null==X?void 0:X.boxShadow,de=B.text.split(/(@|\/)/g),he=P?{align:"center",position:"after",offset:e=>({mainAxis:1})}:{align:"center",position:"below",offset:e=>({mainAxis:8})},ge=i.createElement("div",{style:{borderRadius:oe,display:"flex",cursor:"pointer"}},te?i.createElement("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:8}},i.createElement(g.I,{type:te,style:{width:void 0,height:void 0},primaryColor:j&&null!==(T=null==ee?void 0:ee.text.hover)&&void 0!==T?T:null==ee?void 0:ee.text.resting,fontSize:void 0})):void 0,i.createElement("span",{className:"ms-nudge-text",style:{color:j&&null!==(x=null==ee?void 0:ee.text.hover)&&void 0!==x?x:null==ee?void 0:ee.text.resting,fontSize:ie,fontWeight:ne,paddingTop:re,paddingBottom:se,paddingLeft:ae,paddingRight:ae,textDecoration:"none",userSelect:"none",lineHeight:le}},de.map((e=>{var t,o,n,r;return"@"===e||"/"===e?i.createElement("span",{key:e,style:Object.assign({backgroundColor:(null==ee?void 0:ee.highlight)?j?ee.highlight.background.hover:ee.highlight.background.resting:j&&null!==(t=null==ee?void 0:ee.background.hover)&&void 0!==t?t:null==ee?void 0:ee.background.resting,color:(null==ee?void 0:ee.highlight)?j?ee.highlight.text.hover:ee.highlight.text.resting:j&&null!==(o=null==ee?void 0:ee.text.hover)&&void 0!==o?o:null==ee?void 0:ee.text.resting,paddingLeft:null===(n=null==X?void 0:X.highlightStyle)||void 0===n?void 0:n.paddingLeftRight,paddingRight:null===(r=null==X?void 0:X.highlightStyle)||void 0===r?void 0:r.paddingLeftRight},null==X?void 0:X.highlightStyle)},e):i.createElement("span",{key:e},e)}))));if(_||P){const e={popover:{trapFocus:!0,withArrow:!1,open:z,onOpenChange:(e,t)=>{H(t.open)},positioning:Object.assign({target:(0,d.ug)(A)},he)},surface:{className:"ms-ecc-callout",style:{padding:0,overflowY:"hidden",borderRadius:oe,backgroundColor:j?null==ee?void 0:ee.background.hover:null==ee?void 0:ee.background.resting,boxShadow:ue,cursor:"pointer"}}};return i.createElement("div",{role:"button",tabIndex:-1,onMouseOver:V,onMouseLeave:$,onMouseUp:K,onFocus:V,onBlur:$},i.createElement(c.v,Object.assign({},e),ge))}return i.createElement(l.U,{target:A,directionalHint:ce,isBeakVisible:!1,gapSpace:8,onMouseOver:V,onMouseLeave:$,onMouseUp:K,style:{overflowY:"hidden"},styles:{root:{borderRadius:oe,boxShadow:ue,cursor:"pointer"},calloutMain:{borderRadius:oe,backgroundColor:j?null==ee?void 0:ee.background.hover:null==ee?void 0:ee.background.resting}}},ge)}},13681:(e,t,o)=>{"use strict";o.d(t,{_:()=>c});var i=o(37842),n=o(8676),r=o(95920);if(3023==o.j)var s=o(70479);var a=o(95734);const l=(0,i.F5)({nudgeStateStore:n.A.on(r.V)}),c=()=>{const{nudgeStateStore:e}=(0,i.KN)(l),[t,o]=a.useState(e);a.useEffect((()=>(e.subscribe("stateUpdated",o),()=>{e.unsubscribe("stateUpdated",o)})),[e]);const{nudge:n,nudgeDisplayLocation:r,nudgeTargetDocumentRef:c}=t;return n&&r&&c?a.createElement(s.a,{nudge:n,inlineNudge:e.enableInlineNudge,insertionCharacter:e.insertionCharacter,nudgeTargetDocumentRef:c,nudgeDisplayLocation:r,onAcceptNudgeAction:(t,o)=>{e.onNudgeAccepted(t,o)},onHideNudge:(t,o)=>{e.onNudgeDismiss(t,o)}}):null}},53479:(e,t,o)=>{"use strict";if(o.d(t,{k:()=>r}),3023==o.j)var i=o(26017);const n=e=>!(void 0===e.isScopingEnabled&&void 0===e.showSeparator),r=e=>{if(e.length>0&&e.some(n))return e;const t=e.findIndex((e=>{var t;return(null===(t=e.suggestions[0])||void 0===t?void 0:t.type)===i.c.Scope}));return-1!==t?(e[t]=Object.assign(Object.assign({},e[t]),{isScopingEnabled:!1,showSeparator:!0}),e.concat(e.splice(t,1))):e}},36458:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{CritiqueCallout:()=>i.r,CritiqueCalloutStateStore:()=>n.b,FOOTER_FRE_PAGE_ID:()=>l.Id,FocusZoneId:()=>r.u,FooterFre:()=>d.b,FooterFreModule:()=>m.B,FooterFreStore:()=>u.o,IPredictionStateStore:()=>C.Tc,InlineSuggestions:()=>g.V,InlineSuggestionsCalloutPortal:()=>p.b,InlineSuggestionsWebUXModule:()=>v.Q,InlineSuggestionsWithCallout:()=>f.$,InsertionPredictionStateStore:()=>S.l,LanguageAutoDetectionFRE:()=>c.a,LanguageAutoDetectionFRECallout:()=>l.sy,LayeredPrediction:()=>k.q,LayeredPredictionStateStore:()=>T.O,MultilingualFre:()=>y.R,MultilingualFreStore:()=>w.S,NudgeCallout:()=>x._,PredictionCoreModule:()=>b.B,PredictionDismissalReason:()=>C.R8,UndoCallout:()=>s.$,UndoCalloutStateStore:()=>a.f,UndoQuerySelectorClass:()=>a.g,critiqueCalloutDeps:()=>i.h,getEccUxReplacement:()=>h.Nt,getEccUxReplacementUX:()=>h.cu,langAutoDetectFooterId:()=>l.lP,undoCalloutDeps:()=>s.v}),3023==o.j)var i=o(76785);if(3023==o.j)var n=o(30074);if(3023==o.j)var r=o(8474);if(3023==o.j)var s=o(15306);if(3023==o.j)var a=o(79768);if(3023==o.j)var l=o(21218);if(3023==o.j)var c=o(24628);if(3023==o.j)var u=o(86628);if(3023==o.j)var d=o(1585);if(3023==o.j)var h=o(35700);if(3023==o.j)var g=o(87524);if(3023==o.j)var p=o(9964);if(3023==o.j)var f=o(96346);if(3023==o.j)var m=o(40842);if(3023==o.j)var v=o(37035);if(3023==o.j)var b=o(99938);if(3023==o.j)var y=o(45985);if(3023==o.j)var w=o(48692);if(3023==o.j)var C=o(50630);if(3023==o.j)var S=o(98016);if(3023==o.j)var k=o(74840);if(3023==o.j)var T=o(1180);if(3023==o.j)var x=o(13681)},5871:(e,t,o)=>{"use strict";if(o.d(t,{s:()=>r}),3023==o.j)var i=o(97951);if(3023==o.j)var n=o(79970);function r(e,t,o){var r,s=(0,i.w)(e,(function(e){var o;return t===e||!!(null===(o=e.hasAttribute)||void 0===o?void 0:o.call(e,n.r))}),o);return null!==s&&!!(null===(r=s.hasAttribute)||void 0===r?void 0:r.call(s,n.r))}},42987:(e,t,o)=>{"use strict";o.d(t,{Q:()=>n,W:()=>i});const i="data-overflowing",n="data-overflow-group"},66077:(e,t,o)=>{"use strict";function i(e,t){var o;const i=null===(o=e.ownerDocument.defaultView)||void 0===o?void 0:o.ResizeObserver;if(!i)return()=>null;let n=new i(t);return n.observe(e),()=>{null==n||n.disconnect(),n=void 0}}o.d(t,{v:()=>i})},91108:(e,t,o)=>{"use strict";function i(e){let t;return()=>{t||(t=!0,queueMicrotask((()=>{t=!1,e()})))}}o.d(t,{s:()=>i})},46178:(e,t,o)=>{"use strict";if(o.d(t,{A:()=>a}),3023==o.j)var i=o(42987);if(3023==o.j)var n=o(66077);if(3023==o.j)var r=o(91108);if(3023==o.j)var s=o(59760);function a(){const e=new Map;let t,o,a=!1,c=!0;const u={padding:10,overflowAxis:"horizontal",overflowDirection:"end",minimumVisible:0,onUpdateItemVisibility:()=>{},onUpdateOverflow:()=>{}},d={},h={};let g=()=>null;const p=(e,t)=>{const o=e.dequeue();return t.enqueue(o),d[o]},f=l();function m(e,t){if(!e||!t)return 0;const o=d[e],i=d[t];if(!o||!i)return o?1:-1;if(o.priority!==i.priority)return o.priority>i.priority?1:-1;const n="end"===u.overflowDirection?Node.DOCUMENT_POSITION_FOLLOWING:Node.DOCUMENT_POSITION_PRECEDING;return o.element.compareDocumentPosition(i.element)&n?1:-1}function v(t,o,i){return e.has(i)||e.set(i,"horizontal"===u.overflowAxis?i[t]:i[o]),e.get(i)}const b=v.bind(null,"offsetWidth","offsetHeight"),y=v.bind(null,"clientWidth","clientHeight"),w=(0,s.w)(((e,t)=>-1*m(e,t))),C=(0,s.w)(m);function S(){return C.all().map((e=>d[e].element)).map(b).reduce(((e,t)=>e+t),0)+Object.entries(f.groupVisibility()).reduce(((e,[t,o])=>e+("hidden"!==o&&h[t]?b(h[t].element):0)),0)+(w.size()>0&&o?b(o):0)}const k=()=>{const e=p(w,C);var t;u.onUpdateItemVisibility({item:e,visible:!0}),e.groupId&&(f.showItem(e.id,e.groupId),f.isSingleItemVisible(e.id,e.groupId)&&(null===(t=h[e.groupId])||void 0===t||t.element.removeAttribute(i.W)))},T=()=>{const e=p(C,w);var t;(u.onUpdateItemVisibility({item:e,visible:!1}),e.groupId)&&(f.isSingleItemVisible(e.id,e.groupId)&&(null===(t=h[e.groupId])||void 0===t||t.element.setAttribute(i.W,"")),f.hideItem(e.id,e.groupId))},x=()=>{((()=>{if(!t)return!1;e.clear();const o=y(t)-u.padding,i=C.peek(),n=w.peek();for(;m(w.peek(),C.peek())>0;)T();for(let e=0;e<2;e++){for(;S()<o&&w.size()>0||1===w.size();)k();for(;S()>o&&C.size()>u.minimumVisible;)T()}return C.peek()!==i||w.peek()!==n})()||c)&&(c=!1,(()=>{const e=C.all(),t=w.all(),o=e.map((e=>d[e])),i=t.map((e=>d[e]));u.onUpdateOverflow({visibleItems:o,invisibleItems:i,groupVisibility:f.groupVisibility()})})())},_=(0,r.s)(x),I=()=>{o=void 0},E=e=>{if(!h[e])return;const t=h[e];t.groupId&&(delete h[e],t.element.removeAttribute(i.Q))},B=t=>{if(!d[t])return;a&&(c=!0);const o=d[t];C.remove(t),w.remove(t),o.groupId&&(f.removeItem(o.id,o.groupId),o.element.removeAttribute(i.Q)),e.delete(o.element),delete d[t],_()};return{addItem:e=>{d[e.id]||(d[e.id]=e,a&&(c=!0,C.enqueue(e.id)),e.groupId&&(f.addItem(e.id,e.groupId),e.element.setAttribute(i.Q,e.groupId)),_())},disconnect:()=>{g(),t=void 0,a=!1,c=!0,Object.keys(d).forEach((e=>B(e))),Object.keys(h).forEach((e=>E(e))),I(),e.clear()},forceUpdate:x,observe:(e,o)=>{Object.assign(u,o),a=!0,Object.values(d).forEach((e=>C.enqueue(e.id))),t=e,g=(0,n.v)(t,(e=>{e[0]&&t&&_()}))},removeItem:B,update:_,addOverflowMenu:e=>{o=e},removeOverflowMenu:I,addDivider:e=>{e.groupId&&!h[e.groupId]&&(e.element.setAttribute(i.Q,e.groupId),h[e.groupId]=e)},removeDivider:E}}const l=()=>{const e={},t={};function o(o){const i=t[o];i.invisibleItemIds.size&&i.visibleItemIds.size?e[o]="overflow":0===i.visibleItemIds.size?e[o]="hidden":e[o]="visible"}return{groupVisibility:()=>e,isSingleItemVisible:(o,i)=>function(t){return"visible"===e[t]||"overflow"===e[t]}(i)&&t[i].visibleItemIds.has(o)&&1===t[i].visibleItemIds.size,addItem(e,i){var n,r,s;null!==(s=(n=t)[r=i])&&void 0!==s||(n[r]={visibleItemIds:new Set,invisibleItemIds:new Set}),t[i].visibleItemIds.add(e),o(i)},removeItem(e,i){t[i].invisibleItemIds.delete(e),t[i].visibleItemIds.delete(e),o(i)},showItem(e,i){t[i].invisibleItemIds.delete(e),t[i].visibleItemIds.add(e),o(i)},hideItem(e,i){t[i].invisibleItemIds.add(e),t[i].visibleItemIds.delete(e),o(i)}}}},59760:(e,t,o)=>{"use strict";function i(e){const t=[];let o=0;const i=e=>Math.floor((e-1)/2),n=(e,o)=>{const i=t[e];t[e]=t[o],t[o]=i},r=i=>{let s=i;const a=(e=>2*e+1)(i),l=(e=>2*e+2)(i);a<o&&e(t[a],t[s])<0&&(s=a),l<o&&e(t[l],t[s])<0&&(s=l),s!==i&&(n(s,i),r(s))};return{all:()=>t.slice(0,o),clear:()=>{o=0},contains:e=>{const i=t.indexOf(e);return i>=0&&i<o},dequeue:()=>{if(0===o)throw new Error("Priority queue empty");const e=t[0];return t[0]=t[--o],r(0),e},enqueue:r=>{t[o++]=r;let s=o-1,a=i(s);for(;s>0&&e(t[a],t[s])>0;)n(a,s),s=a,a=i(s)},peek:()=>0===o?null:t[0],remove:e=>{const i=t.indexOf(e);-1===i||i>=o||(t[i]=t[--o],r(i))},size:()=>o}}o.d(t,{w:()=>i})},37645:(e,t,o)=>{"use strict";if(o.d(t,{F:()=>r}),3023==o.j)var i=o(35985);if(3023==o.j)var n=o(19720);function r(e,t){const{disabled:o,disabledFocusable:r=!1,"aria-disabled":s,onClick:a,onKeyDown:l,onKeyUp:c,...u}=null!=t?t:{},d="string"==typeof s?"true"===s:s,h=o||r||d,g=(0,n.D)((e=>{h?(e.preventDefault(),e.stopPropagation()):null==a||a(e)})),p=(0,n.D)((e=>{if(null==l||l(e),e.isDefaultPrevented())return;const t=e.key;if(h&&(t===i.xyI||t===i.$xS))return e.preventDefault(),void e.stopPropagation();t!==i.$xS?t===i.xyI&&(e.preventDefault(),e.currentTarget.click()):e.preventDefault()})),f=(0,n.D)((e=>{if(null==c||c(e),e.isDefaultPrevented())return;const t=e.key;if(h&&(t===i.xyI||t===i.$xS))return e.preventDefault(),void e.stopPropagation();t===i.$xS&&(e.preventDefault(),e.currentTarget.click())}));if("button"===e||void 0===e)return{...u,disabled:o&&!r,"aria-disabled":!!r||d,onClick:r?void 0:g,onKeyUp:r?void 0:c,onKeyDown:r?void 0:l};{const t=!!u.href;let i=t?void 0:"button";!i&&h&&(i="link");const n={role:i,tabIndex:r||!t&&!o?0:void 0,...u,onClick:g,onKeyUp:f,onKeyDown:p,"aria-disabled":h};return"a"===e&&h&&(n.href=void 0),n}}o(95734)},36307:(e,t,o)=>{"use strict";if(o.d(t,{F:()=>r}),3023==o.j)var i=o(35985);if(3023==o.j)var n=o(32726);function r(e,t){const{disabled:o,disabledFocusable:r=!1,"aria-disabled":s,onClick:a,onKeyDown:l,onKeyUp:c,...u}=null!=t?t:{},d="string"==typeof s?"true"===s:s,h=o||r||d,g=(0,n.D)((e=>{h?(e.preventDefault(),e.stopPropagation()):null==a||a(e)})),p=(0,n.D)((e=>{if(null==l||l(e),e.isDefaultPrevented())return;const t=e.key;if(h&&(t===i.xyI||t===i.$xS))return e.preventDefault(),void e.stopPropagation();t!==i.$xS?t===i.xyI&&(e.preventDefault(),e.currentTarget.click()):e.preventDefault()})),f=(0,n.D)((e=>{if(null==c||c(e),e.isDefaultPrevented())return;const t=e.key;if(h&&(t===i.xyI||t===i.$xS))return e.preventDefault(),void e.stopPropagation();t===i.$xS&&(e.preventDefault(),e.currentTarget.click())}));if("button"===e||void 0===e)return{...u,disabled:o&&!r,"aria-disabled":!!r||d,onClick:r?void 0:g,onKeyUp:r?void 0:c,onKeyDown:r?void 0:l};{const t=!!u.href;let i=t?void 0:"button";!i&&h&&(i="link");const n={role:i,tabIndex:r||!t&&!o?0:void 0,...u,onClick:g,onKeyUp:f,onKeyDown:p,"aria-disabled":h};return"a"===e&&h&&(n.href=void 0),n}}o(95734)},93028:(e,t,o)=>{"use strict";o.d(t,{$:()=>C});var i=o(95734),n=o(74074),r=o(64671),s=o(37645),a=o(39366),l=o(35333),c=o(88997),u=o(11612),d=o(27760),h=o(63649);const g=(0,u.y)("r1alrhcs",null,{r:[".r1alrhcs{align-items:center;box-sizing:border-box;display:inline-flex;justify-content:center;text-decoration-line:none;vertical-align:middle;margin:0;overflow:hidden;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);font-family:var(--fontFamilyBase);outline-style:none;padding:5px var(--spacingHorizontalM);min-width:96px;border-radius:var(--borderRadiusMedium);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightSemibold);line-height:var(--lineHeightBase300);transition-duration:var(--durationFaster);transition-property:background,border,color;transition-timing-function:var(--curveEasyEase);}",".r1alrhcs:hover{background-color:var(--colorNeutralBackground1Hover);border-color:var(--colorNeutralStroke1Hover);color:var(--colorNeutralForeground1Hover);cursor:pointer;}",".r1alrhcs:hover:active{background-color:var(--colorNeutralBackground1Pressed);border-color:var(--colorNeutralStroke1Pressed);color:var(--colorNeutralForeground1Pressed);outline-style:none;}",".r1alrhcs[data-fui-focus-visible]{border-color:var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);border-width:1px;outline:var(--strokeWidthThick) solid var(--colorTransparentStroke);box-shadow:0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;z-index:1;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1alrhcs{transition-duration:0.01ms;}}","@media (forced-colors: active){.r1alrhcs:focus{border-color:ButtonText;}.r1alrhcs:hover{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}.r1alrhcs:hover:active{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}}","@supports (-moz-appearance:button){.r1alrhcs[data-fui-focus-visible]{box-shadow:0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),p=(0,u.y)("rywnvv2",null,[".rywnvv2{align-items:center;display:inline-flex;justify-content:center;font-size:20px;height:20px;width:20px;--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}"]),f=(0,d.X)({outline:{De3pzq:"f1c21dwh",Jwef8y:"fjxutwb",iro3zm:"fwiml72"},primary:{De3pzq:"ffp7eso",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1phragk",Jwef8y:"f15wkkf3",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f1rq72xc",iro3zm:"fnp9lpt",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1d6v5y2",Bsw6fvg:"f1rirnrt",Bjwas2f:"f1uu00uk",Bn1d65q:["fkvaka8","f9a0qzu"],Bxeuatn:"f1ux7til",n51gp8:["f9a0qzu","fkvaka8"],Bbusuzp:"f1lkg8j3",ycbfsm:"fkc42ay",Bqrx1nm:"fq7113v",pgvf35:"ff1wgvm",Bh7lczh:["fiob0tu","f1x4h75k"],dpv3f4:"f1j6scgf",Bpnjhaq:["f1x4h75k","fiob0tu"],ze5xyy:"f4xjyn1",g2kj27:"fbgcvur",Bf756sw:"f1ks1yx8",Bow2dr7:["f1o6qegi","fmxjhhp"],Bvhedfk:"fcnxywj",Gye4lf:["fmxjhhp","f1o6qegi"],pc6evw:"f9ddjv3"},secondary:{},subtle:{De3pzq:"fhovq9v",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"f1t94bn6",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"fnwyq0v",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bbdnnc7:"fy5bs14",iro3zm:"fsv2rcd",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1omzyqd",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",x3br3k:"fj8yq94",ze5xyy:"f4xjyn1",Bx3q9su:"f1et0tmh",pc6evw:"f9ddjv3",xd2cci:"f1wi8ngl"},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f139oj5f",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",iro3zm:"fwiml72",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1fg1p5m",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",Bqrx1nm:"f1tme0vf",ze5xyy:"f4xjyn1",g2kj27:"f18onu3q",pc6evw:"f9ddjv3"},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{},square:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw"},small:{Bf4jedk:"fh7ncta",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fneth5b",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},smallWithIcon:{Byoj8tv:"f1brlhvm",z8tnut:"f1sl3k7w"},medium:{},large:{Bf4jedk:"f14es27b",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4db1ww",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},largeWithIcon:{Byoj8tv:"fy7v416",z8tnut:"f1a1bwwz"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".fh7ncta{min-width:64px;}",[".fneth5b{padding:3px var(--spacingHorizontalS);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1brlhvm{padding-bottom:1px;}",".f1sl3k7w{padding-top:1px;}",".f14es27b{min-width:96px;}",[".f4db1ww{padding:8px var(--spacingHorizontalL);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fy7v416{padding-bottom:7px;}",".f1a1bwwz{padding-top:7px;}"],h:[".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fwiml72:hover:active{background-color:var(--colorTransparentBackgroundPressed);}",".f15wkkf3:hover{background-color:var(--colorBrandBackgroundHover);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1rq72xc:hover{color:var(--colorNeutralForegroundOnBrand);}",".fnp9lpt:hover:active{background-color:var(--colorBrandBackgroundPressed);}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}",".f1d6v5y2:hover:active{color:var(--colorNeutralForegroundOnBrand);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".ft1hn21:hover .fui-Icon-filled{display:inline;}",".fuxngvv:hover .fui-Icon-regular{display:none;}",".fy5bs14:hover .fui-Button__icon{color:var(--colorNeutralForeground2BrandHover);}",".fsv2rcd:hover:active{background-color:var(--colorSubtleBackgroundPressed);}",".f1omzyqd:hover:active{color:var(--colorNeutralForeground2Pressed);}",".f1dfjoow:hover:active .fui-Icon-filled{display:inline;}",".f1j98vj9:hover:active .fui-Icon-regular{display:none;}",".fj8yq94:hover:active .fui-Button__icon{color:var(--colorNeutralForeground2BrandPressed);}",".f139oj5f:hover{color:var(--colorNeutralForeground2BrandHover);}",".f1fg1p5m:hover:active{color:var(--colorNeutralForeground2BrandPressed);}"],m:[["@media (forced-colors: active){.f1rirnrt{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1uu00uk{border-top-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9a0qzu{border-left-color:HighlightText;}.fkvaka8{border-right-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ux7til{border-bottom-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lkg8j3{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkc42ay{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fq7113v:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff1wgvm:hover{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1x4h75k:hover{border-left-color:Highlight;}.fiob0tu:hover{border-right-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1j6scgf:hover{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4xjyn1:hover{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fbgcvur:hover:active{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ks1yx8:hover:active{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1o6qegi:hover:active{border-right-color:Highlight;}.fmxjhhp:hover:active{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcnxywj:hover:active{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9ddjv3:hover:active{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1et0tmh:hover .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1wi8ngl:hover:active .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1tme0vf:hover{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18onu3q:hover:active{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}]]}),m=(0,d.X)({base:{De3pzq:"f1bg9a2p",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bfinmwp:"f15x8b5r",Jwef8y:"f1falr9n",Bgoe8wy:"f12mpcsy",Bwzppfd:["f1gwvigk","f18rmfxp"],oetu4i:"f1jnshp0",gg5e9n:["f18rmfxp","f1gwvigk"],Bi91k9c:"fvgxktp",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bbdnnc7:"f1al02dq",iro3zm:"f1t6o4dc",b661bw:"f10ztigi",Bk6r4ia:["f1ft5sdu","f1gzf82w"],B9zn80p:"f12zbtn2",Bpld233:["f1gzf82w","f1ft5sdu"],B2d53fq:"fcvwxyo",c3iz72:"f8w4c43",em6i61:"f1ol4fw6",vm6p8p:"f1q1lw4e",x3br3k:"f1dwjv2g"},highContrast:{Bsw6fvg:"f4lkoma",Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"],Bbusuzp:"f1dcs8yz",Bm2fdqk:"fuigjrg",G867l3:"fjwq6ea",gdbnj:["f1lr3nhc","f1mbxvi6"],mxns5l:"fn5gmvv",o3nasb:["f1mbxvi6","f1lr3nhc"],Bqrx1nm:"f1vmkb5g",pgvf35:"f53ppgq",Bh7lczh:["f1663y11","f80fkiy"],dpv3f4:"f18v5270",Bpnjhaq:["f80fkiy","f1663y11"],ze5xyy:"f1kc2mi9",Bx3q9su:"f4dhi0o",g2kj27:"f1y0svfh",Bf756sw:"fihuait",Bow2dr7:["fnxhupq","fyd6l6x"],Bvhedfk:"fx507ft",Gye4lf:["fyd6l6x","fnxhupq"],pc6evw:"fb3rf2x",xd2cci:"fequ9m0"},outline:{De3pzq:"f1c21dwh",Jwef8y:"f9ql6rf",iro3zm:"f3h1zc4"},primary:{g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},secondary:{},subtle:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]}},{d:[".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f15x8b5r .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}"],h:[".f1falr9n:hover{background-color:var(--colorNeutralBackgroundDisabled);}",".f12mpcsy:hover{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1gwvigk:hover{border-right-color:var(--colorNeutralStrokeDisabled);}",".f18rmfxp:hover{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1jnshp0:hover{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1al02dq:hover .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1t6o4dc:hover:active{background-color:var(--colorNeutralBackgroundDisabled);}",".f10ztigi:hover:active{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1ft5sdu:hover:active{border-right-color:var(--colorNeutralStrokeDisabled);}",".f1gzf82w:hover:active{border-left-color:var(--colorNeutralStrokeDisabled);}",".f12zbtn2:hover:active{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f8w4c43:hover:active{cursor:not-allowed;}",".f1ol4fw6:hover:active .fui-Icon-filled{display:none;}",".f1q1lw4e:hover:active .fui-Icon-regular{display:inline;}",".f1dwjv2g:hover:active .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f9ql6rf:hover{background-color:var(--colorTransparentBackground);}",".f3h1zc4:hover:active{background-color:var(--colorTransparentBackground);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}"],m:[["@media (forced-colors: active){.f4lkoma{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fuigjrg .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fjwq6ea:focus{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lr3nhc:focus{border-right-color:GrayText;}.f1mbxvi6:focus{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fn5gmvv:focus{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1vmkb5g:hover{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f53ppgq:hover{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1663y11:hover{border-right-color:GrayText;}.f80fkiy:hover{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18v5270:hover{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4dhi0o:hover .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1y0svfh:hover:active{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fihuait:hover:active{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fnxhupq:hover:active{border-right-color:GrayText;}.fyd6l6x:hover:active{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fx507ft:hover:active{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fb3rf2x:hover:active{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fequ9m0:hover:active .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),v=(0,d.X)({circular:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1062rbf"},rounded:{},square:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fj0ryk1"},primary:{B8q5s1w:"f17t0x8g",Bci5o5g:["f194v5ow","fk7jm04"],n8qw10:"f1qgg65p",Bdrgwmp:["fk7jm04","f194v5ow"],j6ew2k:["fhgccpy","fjo7pq6"],he4mth:"f32wu9k",Byr4aka:"fu5nqqq",lks7q5:["f13prjl2","f1nl83rv"],Bnan3qt:"f1czftr5",k1dn9:["f1nl83rv","f13prjl2"],Boium3a:["f12k37oa","fdnykm2"],tm8e47:"fr96u23"},small:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fazmxh"},medium:{},large:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1b6alqh"}},{d:[[".f1062rbf[data-fui-focus-visible]{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".fj0ryk1[data-fui-focus-visible]{border-radius:var(--borderRadiusNone);}",{p:-1}],".f17t0x8g[data-fui-focus-visible]{border-top-color:var(--colorStrokeFocus2);}",".f194v5ow[data-fui-focus-visible]{border-right-color:var(--colorStrokeFocus2);}",".fk7jm04[data-fui-focus-visible]{border-left-color:var(--colorStrokeFocus2);}",".f1qgg65p[data-fui-focus-visible]{border-bottom-color:var(--colorStrokeFocus2);}",".fhgccpy[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".fjo7pq6[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".f32wu9k[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;}",".fu5nqqq[data-fui-focus-visible]:hover{border-top-color:var(--colorStrokeFocus2);}",".f13prjl2[data-fui-focus-visible]:hover{border-right-color:var(--colorStrokeFocus2);}",".f1nl83rv[data-fui-focus-visible]:hover{border-left-color:var(--colorStrokeFocus2);}",".f1czftr5[data-fui-focus-visible]:hover{border-bottom-color:var(--colorStrokeFocus2);}",[".fazmxh[data-fui-focus-visible]{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".f1b6alqh[data-fui-focus-visible]{border-radius:var(--borderRadiusLarge);}",{p:-1}]],t:["@supports (-moz-appearance:button){.f12k37oa[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}.fdnykm2[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}}","@supports (-moz-appearance:button){.fr96u23[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),b=(0,d.X)({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fu97m5z",Bf4jedk:"f17fgpbq",B2u0y6b:"f1jt17bm"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f18ktai2",Bf4jedk:"fwbmr0d",B2u0y6b:"f44c6la"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1hbd1aw",Bf4jedk:"f12clzc2",B2u0y6b:"fjy1crr"}},{d:[[".fu97m5z{padding:1px;}",{p:-1}],".f17fgpbq{min-width:24px;}",".f1jt17bm{max-width:24px;}",[".f18ktai2{padding:5px;}",{p:-1}],".fwbmr0d{min-width:32px;}",".f44c6la{max-width:32px;}",[".f1hbd1aw{padding:7px;}",{p:-1}],".f12clzc2{min-width:40px;}",".fjy1crr{max-width:40px;}"]}),y=(0,d.X)({small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3",Bqrlyyl:"fbaiahx"},medium:{},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun",Bqrlyyl:"f1exjqw5"},before:{t21cq0:["f1nizpg2","f1a695kz"]},after:{Frg6f3:["f1a695kz","f1nizpg2"]}},{d:[".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".fbaiahx{--fui-Button__icon--spacing:var(--spacingHorizontalXS);}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".f1exjqw5{--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}",".f1nizpg2{margin-right:var(--fui-Button__icon--spacing);}",".f1a695kz{margin-left:var(--fui-Button__icon--spacing);}"]});var w=o(19821);const C=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{size:o}=(0,c.j)(),{appearance:i="secondary",as:n="button",disabled:r=!1,disabledFocusable:u=!1,icon:d,iconPosition:h="before",shape:g="rounded",size:p=(null!=o?o:"medium")}=e,f=a.lq(d,{elementType:"span"});return{appearance:i,disabled:r,disabledFocusable:u,iconPosition:h,shape:g,size:p,iconOnly:Boolean((null==f?void 0:f.children)&&!e.children),components:{root:"button",icon:"span"},root:a.Gk((0,l.g)(n,(0,s.F)(e.as,e)),{elementType:"button",defaultProps:{ref:t,type:"button"===n?"button":void 0}}),icon:f}})(e,t);return(e=>{const t=g(),o=p(),i=f(),n=m(),r=v(),s=b(),a=y(),{appearance:l,disabled:c,disabledFocusable:u,icon:d,iconOnly:w,iconPosition:C,shape:S,size:k}=e;e.root.className=(0,h.z)("fui-Button",t,l&&i[l],i[k],d&&"small"===k&&i.smallWithIcon,d&&"large"===k&&i.largeWithIcon,i[S],(c||u)&&n.base,(c||u)&&n.highContrast,l&&(c||u)&&n[l],"primary"===l&&r.primary,r[k],r[S],w&&s[k],e.root.className),e.icon&&(e.icon.className=(0,h.z)("fui-Button__icon",o,!!e.root.children&&a[C],a[k],e.icon.className))})(o),(0,w.$e)("useButtonStyles_unstable")(o),(e=>{(0,r.C)(e);const{iconOnly:t,iconPosition:o}=e;return(0,n.FD)(e.root,{children:["after"!==o&&e.icon&&(0,n.Y)(e.icon,{}),!t&&e.root.children,"after"===o&&e.icon&&(0,n.Y)(e.icon,{})]})})(o)}));C.displayName="Button"},88997:(e,t,o)=>{"use strict";o.d(t,{j:()=>s});var i=o(95734);const n=i.createContext(void 0),r={},s=(n.Provider,()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r})},55009:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>a}),o(95734),3023==o.j)var i=o(36307);if(3023==o.j)var n=o(36216);if(3023==o.j)var r=o(48701);if(3023==o.j)var s=o(24250);const a=(e,t)=>{const{size:o}=(0,s.j)(),{appearance:a="secondary",as:l="button",disabled:c=!1,disabledFocusable:u=!1,icon:d,iconPosition:h="before",shape:g="rounded",size:p=(null!=o?o:"medium")}=e,f=n.lq(d,{elementType:"span"});return{appearance:a,disabled:c,disabledFocusable:u,iconPosition:h,shape:g,size:p,iconOnly:Boolean((null==f?void 0:f.children)&&!e.children),components:{root:"button",icon:"span"},root:n.Gk((0,r.g)(l,(0,i.F)(e.as,e)),{elementType:"button",defaultProps:{ref:t,type:"button"===l?"button":void 0}}),icon:f}}},35203:(e,t,o)=>{"use strict";o.d(t,{B:()=>g});var i=o(11612),n=o(27760);if(3023==o.j)var r=o(63649);const s=(0,i.y)("r1alrhcs",null,{r:[".r1alrhcs{align-items:center;box-sizing:border-box;display:inline-flex;justify-content:center;text-decoration-line:none;vertical-align:middle;margin:0;overflow:hidden;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);font-family:var(--fontFamilyBase);outline-style:none;padding:5px var(--spacingHorizontalM);min-width:96px;border-radius:var(--borderRadiusMedium);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightSemibold);line-height:var(--lineHeightBase300);transition-duration:var(--durationFaster);transition-property:background,border,color;transition-timing-function:var(--curveEasyEase);}",".r1alrhcs:hover{background-color:var(--colorNeutralBackground1Hover);border-color:var(--colorNeutralStroke1Hover);color:var(--colorNeutralForeground1Hover);cursor:pointer;}",".r1alrhcs:hover:active{background-color:var(--colorNeutralBackground1Pressed);border-color:var(--colorNeutralStroke1Pressed);color:var(--colorNeutralForeground1Pressed);outline-style:none;}",".r1alrhcs[data-fui-focus-visible]{border-color:var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);border-width:1px;outline:var(--strokeWidthThick) solid var(--colorTransparentStroke);box-shadow:0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;z-index:1;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1alrhcs{transition-duration:0.01ms;}}","@media (forced-colors: active){.r1alrhcs:focus{border-color:ButtonText;}.r1alrhcs:hover{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}.r1alrhcs:hover:active{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}}","@supports (-moz-appearance:button){.r1alrhcs[data-fui-focus-visible]{box-shadow:0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),a=3023==o.j?(0,i.y)("rywnvv2",null,[".rywnvv2{align-items:center;display:inline-flex;justify-content:center;font-size:20px;height:20px;width:20px;--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}"]):null,l=(0,n.X)({outline:{De3pzq:"f1c21dwh",Jwef8y:"fjxutwb",iro3zm:"fwiml72"},primary:{De3pzq:"ffp7eso",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1phragk",Jwef8y:"f15wkkf3",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f1rq72xc",iro3zm:"fnp9lpt",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1d6v5y2",Bsw6fvg:"f1rirnrt",Bjwas2f:"f1uu00uk",Bn1d65q:["fkvaka8","f9a0qzu"],Bxeuatn:"f1ux7til",n51gp8:["f9a0qzu","fkvaka8"],Bbusuzp:"f1lkg8j3",ycbfsm:"fkc42ay",Bqrx1nm:"fq7113v",pgvf35:"ff1wgvm",Bh7lczh:["fiob0tu","f1x4h75k"],dpv3f4:"f1j6scgf",Bpnjhaq:["f1x4h75k","fiob0tu"],ze5xyy:"f4xjyn1",g2kj27:"fbgcvur",Bf756sw:"f1ks1yx8",Bow2dr7:["f1o6qegi","fmxjhhp"],Bvhedfk:"fcnxywj",Gye4lf:["fmxjhhp","f1o6qegi"],pc6evw:"f9ddjv3"},secondary:{},subtle:{De3pzq:"fhovq9v",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"f1t94bn6",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"fnwyq0v",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bbdnnc7:"fy5bs14",iro3zm:"fsv2rcd",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1omzyqd",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",x3br3k:"fj8yq94",ze5xyy:"f4xjyn1",Bx3q9su:"f1et0tmh",pc6evw:"f9ddjv3",xd2cci:"f1wi8ngl"},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f139oj5f",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",iro3zm:"fwiml72",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1fg1p5m",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",Bqrx1nm:"f1tme0vf",ze5xyy:"f4xjyn1",g2kj27:"f18onu3q",pc6evw:"f9ddjv3"},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{},square:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw"},small:{Bf4jedk:"fh7ncta",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fneth5b",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},smallWithIcon:{Byoj8tv:"f1brlhvm",z8tnut:"f1sl3k7w"},medium:{},large:{Bf4jedk:"f14es27b",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4db1ww",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},largeWithIcon:{Byoj8tv:"fy7v416",z8tnut:"f1a1bwwz"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".fh7ncta{min-width:64px;}",[".fneth5b{padding:3px var(--spacingHorizontalS);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1brlhvm{padding-bottom:1px;}",".f1sl3k7w{padding-top:1px;}",".f14es27b{min-width:96px;}",[".f4db1ww{padding:8px var(--spacingHorizontalL);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fy7v416{padding-bottom:7px;}",".f1a1bwwz{padding-top:7px;}"],h:[".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fwiml72:hover:active{background-color:var(--colorTransparentBackgroundPressed);}",".f15wkkf3:hover{background-color:var(--colorBrandBackgroundHover);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1rq72xc:hover{color:var(--colorNeutralForegroundOnBrand);}",".fnp9lpt:hover:active{background-color:var(--colorBrandBackgroundPressed);}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}",".f1d6v5y2:hover:active{color:var(--colorNeutralForegroundOnBrand);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".ft1hn21:hover .fui-Icon-filled{display:inline;}",".fuxngvv:hover .fui-Icon-regular{display:none;}",".fy5bs14:hover .fui-Button__icon{color:var(--colorNeutralForeground2BrandHover);}",".fsv2rcd:hover:active{background-color:var(--colorSubtleBackgroundPressed);}",".f1omzyqd:hover:active{color:var(--colorNeutralForeground2Pressed);}",".f1dfjoow:hover:active .fui-Icon-filled{display:inline;}",".f1j98vj9:hover:active .fui-Icon-regular{display:none;}",".fj8yq94:hover:active .fui-Button__icon{color:var(--colorNeutralForeground2BrandPressed);}",".f139oj5f:hover{color:var(--colorNeutralForeground2BrandHover);}",".f1fg1p5m:hover:active{color:var(--colorNeutralForeground2BrandPressed);}"],m:[["@media (forced-colors: active){.f1rirnrt{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1uu00uk{border-top-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9a0qzu{border-left-color:HighlightText;}.fkvaka8{border-right-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ux7til{border-bottom-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lkg8j3{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkc42ay{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fq7113v:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff1wgvm:hover{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1x4h75k:hover{border-left-color:Highlight;}.fiob0tu:hover{border-right-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1j6scgf:hover{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4xjyn1:hover{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fbgcvur:hover:active{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ks1yx8:hover:active{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1o6qegi:hover:active{border-right-color:Highlight;}.fmxjhhp:hover:active{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcnxywj:hover:active{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9ddjv3:hover:active{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1et0tmh:hover .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1wi8ngl:hover:active .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1tme0vf:hover{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18onu3q:hover:active{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}]]}),c=(0,n.X)({base:{De3pzq:"f1bg9a2p",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bfinmwp:"f15x8b5r",Jwef8y:"f1falr9n",Bgoe8wy:"f12mpcsy",Bwzppfd:["f1gwvigk","f18rmfxp"],oetu4i:"f1jnshp0",gg5e9n:["f18rmfxp","f1gwvigk"],Bi91k9c:"fvgxktp",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bbdnnc7:"f1al02dq",iro3zm:"f1t6o4dc",b661bw:"f10ztigi",Bk6r4ia:["f1ft5sdu","f1gzf82w"],B9zn80p:"f12zbtn2",Bpld233:["f1gzf82w","f1ft5sdu"],B2d53fq:"fcvwxyo",c3iz72:"f8w4c43",em6i61:"f1ol4fw6",vm6p8p:"f1q1lw4e",x3br3k:"f1dwjv2g"},highContrast:{Bsw6fvg:"f4lkoma",Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"],Bbusuzp:"f1dcs8yz",Bm2fdqk:"fuigjrg",G867l3:"fjwq6ea",gdbnj:["f1lr3nhc","f1mbxvi6"],mxns5l:"fn5gmvv",o3nasb:["f1mbxvi6","f1lr3nhc"],Bqrx1nm:"f1vmkb5g",pgvf35:"f53ppgq",Bh7lczh:["f1663y11","f80fkiy"],dpv3f4:"f18v5270",Bpnjhaq:["f80fkiy","f1663y11"],ze5xyy:"f1kc2mi9",Bx3q9su:"f4dhi0o",g2kj27:"f1y0svfh",Bf756sw:"fihuait",Bow2dr7:["fnxhupq","fyd6l6x"],Bvhedfk:"fx507ft",Gye4lf:["fyd6l6x","fnxhupq"],pc6evw:"fb3rf2x",xd2cci:"fequ9m0"},outline:{De3pzq:"f1c21dwh",Jwef8y:"f9ql6rf",iro3zm:"f3h1zc4"},primary:{g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},secondary:{},subtle:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]}},{d:[".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f15x8b5r .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}"],h:[".f1falr9n:hover{background-color:var(--colorNeutralBackgroundDisabled);}",".f12mpcsy:hover{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1gwvigk:hover{border-right-color:var(--colorNeutralStrokeDisabled);}",".f18rmfxp:hover{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1jnshp0:hover{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1al02dq:hover .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1t6o4dc:hover:active{background-color:var(--colorNeutralBackgroundDisabled);}",".f10ztigi:hover:active{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1ft5sdu:hover:active{border-right-color:var(--colorNeutralStrokeDisabled);}",".f1gzf82w:hover:active{border-left-color:var(--colorNeutralStrokeDisabled);}",".f12zbtn2:hover:active{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f8w4c43:hover:active{cursor:not-allowed;}",".f1ol4fw6:hover:active .fui-Icon-filled{display:none;}",".f1q1lw4e:hover:active .fui-Icon-regular{display:inline;}",".f1dwjv2g:hover:active .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f9ql6rf:hover{background-color:var(--colorTransparentBackground);}",".f3h1zc4:hover:active{background-color:var(--colorTransparentBackground);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}"],m:[["@media (forced-colors: active){.f4lkoma{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fuigjrg .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fjwq6ea:focus{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lr3nhc:focus{border-right-color:GrayText;}.f1mbxvi6:focus{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fn5gmvv:focus{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1vmkb5g:hover{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f53ppgq:hover{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1663y11:hover{border-right-color:GrayText;}.f80fkiy:hover{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18v5270:hover{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4dhi0o:hover .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1y0svfh:hover:active{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fihuait:hover:active{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fnxhupq:hover:active{border-right-color:GrayText;}.fyd6l6x:hover:active{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fx507ft:hover:active{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fb3rf2x:hover:active{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fequ9m0:hover:active .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),u=(0,n.X)({circular:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1062rbf"},rounded:{},square:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fj0ryk1"},primary:{B8q5s1w:"f17t0x8g",Bci5o5g:["f194v5ow","fk7jm04"],n8qw10:"f1qgg65p",Bdrgwmp:["fk7jm04","f194v5ow"],j6ew2k:["fhgccpy","fjo7pq6"],he4mth:"f32wu9k",Byr4aka:"fu5nqqq",lks7q5:["f13prjl2","f1nl83rv"],Bnan3qt:"f1czftr5",k1dn9:["f1nl83rv","f13prjl2"],Boium3a:["f12k37oa","fdnykm2"],tm8e47:"fr96u23"},small:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fazmxh"},medium:{},large:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1b6alqh"}},{d:[[".f1062rbf[data-fui-focus-visible]{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".fj0ryk1[data-fui-focus-visible]{border-radius:var(--borderRadiusNone);}",{p:-1}],".f17t0x8g[data-fui-focus-visible]{border-top-color:var(--colorStrokeFocus2);}",".f194v5ow[data-fui-focus-visible]{border-right-color:var(--colorStrokeFocus2);}",".fk7jm04[data-fui-focus-visible]{border-left-color:var(--colorStrokeFocus2);}",".f1qgg65p[data-fui-focus-visible]{border-bottom-color:var(--colorStrokeFocus2);}",".fhgccpy[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".fjo7pq6[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".f32wu9k[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;}",".fu5nqqq[data-fui-focus-visible]:hover{border-top-color:var(--colorStrokeFocus2);}",".f13prjl2[data-fui-focus-visible]:hover{border-right-color:var(--colorStrokeFocus2);}",".f1nl83rv[data-fui-focus-visible]:hover{border-left-color:var(--colorStrokeFocus2);}",".f1czftr5[data-fui-focus-visible]:hover{border-bottom-color:var(--colorStrokeFocus2);}",[".fazmxh[data-fui-focus-visible]{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".f1b6alqh[data-fui-focus-visible]{border-radius:var(--borderRadiusLarge);}",{p:-1}]],t:["@supports (-moz-appearance:button){.f12k37oa[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}.fdnykm2[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}}","@supports (-moz-appearance:button){.fr96u23[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),d=(0,n.X)({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fu97m5z",Bf4jedk:"f17fgpbq",B2u0y6b:"f1jt17bm"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f18ktai2",Bf4jedk:"fwbmr0d",B2u0y6b:"f44c6la"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1hbd1aw",Bf4jedk:"f12clzc2",B2u0y6b:"fjy1crr"}},{d:[[".fu97m5z{padding:1px;}",{p:-1}],".f17fgpbq{min-width:24px;}",".f1jt17bm{max-width:24px;}",[".f18ktai2{padding:5px;}",{p:-1}],".fwbmr0d{min-width:32px;}",".f44c6la{max-width:32px;}",[".f1hbd1aw{padding:7px;}",{p:-1}],".f12clzc2{min-width:40px;}",".fjy1crr{max-width:40px;}"]}),h=(0,n.X)({small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3",Bqrlyyl:"fbaiahx"},medium:{},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun",Bqrlyyl:"f1exjqw5"},before:{t21cq0:["f1nizpg2","f1a695kz"]},after:{Frg6f3:["f1a695kz","f1nizpg2"]}},{d:[".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".fbaiahx{--fui-Button__icon--spacing:var(--spacingHorizontalXS);}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".f1exjqw5{--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}",".f1nizpg2{margin-right:var(--fui-Button__icon--spacing);}",".f1a695kz{margin-left:var(--fui-Button__icon--spacing);}"]}),g=e=>{const t=s(),o=a(),i=l(),n=c(),g=u(),p=d(),f=h(),{appearance:m,disabled:v,disabledFocusable:b,icon:y,iconOnly:w,iconPosition:C,shape:S,size:k}=e;return e.root.className=(0,r.z)("fui-Button",t,m&&i[m],i[k],y&&"small"===k&&i.smallWithIcon,y&&"large"===k&&i.largeWithIcon,i[S],(v||b)&&n.base,(v||b)&&n.highContrast,m&&(v||b)&&n[m],"primary"===m&&g.primary,g[k],g[S],w&&p[k],e.root.className),e.icon&&(e.icon.className=(0,r.z)("fui-Button__icon",o,!!e.root.children&&f[C],f[k],e.icon.className)),e}},24250:(e,t,o)=>{"use strict";o.d(t,{j:()=>s});var i=o(95734);const n=i.createContext(void 0),r={},s=(n.Provider,()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r})},23292:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>s}),3023==o.j)var i=o(19720);if(3023==o.j)var n=o(44877);var r=o(95734);const s=(e,t)=>{const o=r.useContext(e),{value:{current:s},version:{current:a},listeners:l}=o,c=t(s),[u,d]=r.useState([s,c]),h=e=>{d((o=>{if(!e)return[s,c];if(e[0]<=a)return Object.is(o[1],c)?o:[s,c];try{if(Object.is(o[0],e[1]))return o;const i=t(e[1]);return Object.is(o[1],i)?o:[e[1],i]}catch(e){}return[o[0],o[1]]}))};Object.is(u[1],c)||h(void 0);const g=(0,i.D)(h);return(0,n.E)((()=>(l.push(g),()=>{const e=l.indexOf(g);l.splice(e,1)})),[g,l]),u[1]}},10932:(e,t,o)=>{"use strict";if(o.d(t,{q:()=>s}),3023==o.j)var i=o(93851);var n=o(95734),r=o(85453);const s=e=>{const t=n.createContext({value:{current:e},version:{current:-1},listeners:[]});var o;return t.Provider=(o=t.Provider,e=>{const t=n.useRef(e.value),s=n.useRef(0),a=n.useRef();return a.current||(a.current={value:t,version:s,listeners:[]}),(0,i.E)((()=>{t.current=e.value,s.current+=1,(0,r.unstable_runWithPriority)(r.unstable_NormalPriority,(()=>{a.current.listeners.forEach((t=>{t([s.current,e.value])}))}))}),[e.value]),n.createElement(o,{value:a.current},e.children)}),delete t.Consumer,t}},51204:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>s}),3023==o.j)var i=o(32726);if(3023==o.j)var n=o(93851);var r=o(95734);const s=(e,t)=>{const o=r.useContext(e),{value:{current:s},version:{current:a},listeners:l}=o,c=t(s),[u,d]=r.useState([s,c]),h=e=>{d((o=>{if(!e)return[s,c];if(e[0]<=a)return Object.is(o[1],c)?o:[s,c];try{if(Object.is(o[0],e[1]))return o;const i=t(e[1]);return Object.is(o[1],i)?o:[e[1],i]}catch(e){}return[o[0],o[1]]}))};Object.is(u[1],c)||h(void 0);const g=(0,i.D)(h);return(0,n.E)((()=>(l.push(g),()=>{const e=l.indexOf(g);l.splice(e,1)})),[g,l]),u[1]}},92687:(e,t,o)=>{"use strict";o.d(t,{V:()=>n});var i=o(95734);function n(e){const t=i.useContext(e);return!!t.version&&-1!==t.version.current}},95809:(e,t,o)=>{"use strict";o.d(t,{c:()=>f});var i=o(95734),n=o(60839),r=o(18861),s=o(50344),a=o(36216),l=o(48701),c=o(27760),u=o(63649);const d=(0,c.X)({base:{Bt984gj:"f122n59",B7ck84d:"f1ewtqcl",mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Bh6795r:"fqerorx",qhf8xq:"f10pi13n",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm",fsow6f:"f17mccla",Bcvre1j:"fyl8oag",Br0sdwz:"f16vkdww",Bn78ew0:"fhsnbul",li1rpt:"f1gw3sf2",ap17g6:"f1ly5f7u",B771hl4:"f1s3tz6t"},childless:{susq4k:"f1kyqvp9",Bicfajf:["fzynn9s","f1z0ukd1"],jwcpgy:["fekrn8e","ftdg338"],B4rk6o:"fesgyo"},start:{Bsft5z2:"f13zj6fq"},center:{Ftih45:"f1wl9k8s",Bsft5z2:"f13zj6fq"},end:{Ftih45:"f1wl9k8s"},brand:{sj55zd:"f16muhyy",Bq4z7u6:"fcbuu2a",Bk5zm6e:["f1wdw2dr","f1ttio3w"],Bqjgrrk:"f1582fpk",Bm6vgfq:["f1ttio3w","f1wdw2dr"],B0n5ga8:"f1ahrvm8",s924m2:["f1cd3wbc","f17hbk9y"],B1q35kw:"fvrapl0",Gp14am:["f17hbk9y","f1cd3wbc"]},default:{sj55zd:"fkfq4zb",Bq4z7u6:"f1vccso1",Bk5zm6e:["f1geml7w","fjml6kk"],Bqjgrrk:"f1r7kh1m",Bm6vgfq:["fjml6kk","f1geml7w"],B0n5ga8:"f16j7guv",s924m2:["fx01ahm","fj1a37q"],B1q35kw:"fl8d8yv",Gp14am:["fj1a37q","fx01ahm"]},subtle:{sj55zd:"f11d4kpn",Bq4z7u6:"f5g06un",Bk5zm6e:["f13sxdku","f1n015lb"],Bqjgrrk:"f1x6bl8t",Bm6vgfq:["f1n015lb","f13sxdku"],B0n5ga8:"fvod1wy",s924m2:["fwslg65","flk0e17"],B1q35kw:"f103fvts",Gp14am:["flk0e17","fwslg65"]},strong:{sj55zd:"f19n0e5",Bq4z7u6:"f10tv6oz",Bk5zm6e:["f16xp3sf","f1seuxxq"],Bqjgrrk:"fwrmqbx",Bm6vgfq:["f1seuxxq","f16xp3sf"],B0n5ga8:"ft83z1f",s924m2:["f1g4150c","f192dr6e"],B1q35kw:"f1qnawh6",Gp14am:["f192dr6e","f1g4150c"]}},{d:[".f122n59{align-items:center;}",".f1ewtqcl{box-sizing:border-box;}",".f22iagw{display:flex;}",".f1063pyq{flex-direction:row;}",".fqerorx{flex-grow:1;}",".f10pi13n{position:relative;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f17mccla{text-align:center;}",".fyl8oag::before{box-sizing:border-box;}",".f16vkdww::before{display:flex;}",".fhsnbul::before{flex-grow:1;}",".f1gw3sf2::after{box-sizing:border-box;}",".f1ly5f7u::after{display:flex;}",".f1s3tz6t::after{flex-grow:1;}",".f1kyqvp9::before{margin-bottom:0;}",".fzynn9s::before{margin-right:0;}",".f1z0ukd1::before{margin-left:0;}",".fekrn8e::after{margin-left:0;}",".ftdg338::after{margin-right:0;}",".fesgyo::after{margin-top:0;}",'.f13zj6fq::after{content:"";}','.f1wl9k8s::before{content:"";}',".f16muhyy{color:var(--colorBrandForeground1);}",".fcbuu2a::before{border-top-color:var(--colorBrandStroke1);}",".f1wdw2dr::before{border-right-color:var(--colorBrandStroke1);}",".f1ttio3w::before{border-left-color:var(--colorBrandStroke1);}",".f1582fpk::before{border-bottom-color:var(--colorBrandStroke1);}",".f1ahrvm8::after{border-top-color:var(--colorBrandStroke1);}",".f1cd3wbc::after{border-right-color:var(--colorBrandStroke1);}",".f17hbk9y::after{border-left-color:var(--colorBrandStroke1);}",".fvrapl0::after{border-bottom-color:var(--colorBrandStroke1);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",".f1vccso1::before{border-top-color:var(--colorNeutralStroke2);}",".f1geml7w::before{border-right-color:var(--colorNeutralStroke2);}",".fjml6kk::before{border-left-color:var(--colorNeutralStroke2);}",".f1r7kh1m::before{border-bottom-color:var(--colorNeutralStroke2);}",".f16j7guv::after{border-top-color:var(--colorNeutralStroke2);}",".fx01ahm::after{border-right-color:var(--colorNeutralStroke2);}",".fj1a37q::after{border-left-color:var(--colorNeutralStroke2);}",".fl8d8yv::after{border-bottom-color:var(--colorNeutralStroke2);}",".f11d4kpn{color:var(--colorNeutralForeground3);}",".f5g06un::before{border-top-color:var(--colorNeutralStroke3);}",".f13sxdku::before{border-right-color:var(--colorNeutralStroke3);}",".f1n015lb::before{border-left-color:var(--colorNeutralStroke3);}",".f1x6bl8t::before{border-bottom-color:var(--colorNeutralStroke3);}",".fvod1wy::after{border-top-color:var(--colorNeutralStroke3);}",".fwslg65::after{border-right-color:var(--colorNeutralStroke3);}",".flk0e17::after{border-left-color:var(--colorNeutralStroke3);}",".f103fvts::after{border-bottom-color:var(--colorNeutralStroke3);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f10tv6oz::before{border-top-color:var(--colorNeutralStroke1);}",".f16xp3sf::before{border-right-color:var(--colorNeutralStroke1);}",".f1seuxxq::before{border-left-color:var(--colorNeutralStroke1);}",".fwrmqbx::before{border-bottom-color:var(--colorNeutralStroke1);}",".ft83z1f::after{border-top-color:var(--colorNeutralStroke1);}",".f1g4150c::after{border-right-color:var(--colorNeutralStroke1);}",".f192dr6e::after{border-left-color:var(--colorNeutralStroke1);}",".f1qnawh6::after{border-bottom-color:var(--colorNeutralStroke1);}"]}),h=(0,c.X)({base:{a9b677:"fly5x3f",Bdkvgpv:"f163fonl",B0qfbqy:"f51yk4v",pbipgd:"f13rof3u",Bm2nyyq:"f8rth92",xrcqlc:"f6czdpx",i5u598:"f1iyka9k"},inset:{uwmqm3:["fjlbh76","f11qrl6u"],z189sj:["f11qrl6u","fjlbh76"]},start:{Ftih45:"f1wl9k8s",Bicfajf:["f1ojjlep","fk1kexq"],Bxwl2t9:"f1he2m4d",jwcpgy:["f12w1bnb","f1558wlj"]},center:{Bicfajf:["f1ojjlep","fk1kexq"],jwcpgy:["f12w1bnb","f1558wlj"]},end:{Bicfajf:["f1ojjlep","fk1kexq"],Bsft5z2:"f13zj6fq",jwcpgy:["f12w1bnb","f1558wlj"],Iy66sp:"f1ayce8x"}},{d:[".fly5x3f{width:100%;}",".f163fonl::before{border-top-style:solid;}",".f51yk4v::before{border-top-width:var(--strokeWidthThin);}",".f13rof3u::before{min-width:8px;}",".f8rth92::after{border-top-style:solid;}",".f6czdpx::after{border-top-width:var(--strokeWidthThin);}",".f1iyka9k::after{min-width:8px;}",".fjlbh76{padding-left:12px;}",".f11qrl6u{padding-right:12px;}",'.f1wl9k8s::before{content:"";}',".f1ojjlep::before{margin-right:12px;}",".fk1kexq::before{margin-left:12px;}",".f1he2m4d::before{max-width:8px;}",".f12w1bnb::after{margin-left:12px;}",".f1558wlj::after{margin-right:12px;}",'.f13zj6fq::after{content:"";}',".f1ayce8x::after{max-width:8px;}"]}),g=(0,c.X)({base:{Beiy3e4:"f1vx9l62",sshi5w:"f16gbxbe",m598lv:["f1yq6w5o","f1jpmc5p"],B4f6apu:["f9sc749","f1x8pvcy"],zkzzav:"fhkwbjy",Barhvk9:["flthirb","ftkbnf5"],Ihftqj:["f13hvwk3","f1en4csx"],Bde111x:"f19onpk6"},inset:{B6of3ja:"f1xdg43u",jrapky:"f1jlhsmd"},withChildren:{sshi5w:"f1tjaq3g"},start:{Ftih45:"f1wl9k8s",susq4k:"fg2pwug",Bbdr6tz:"fkjtzyi",B4rk6o:"f8vk40g"},center:{susq4k:"fg2pwug",B4rk6o:"f8vk40g"},end:{susq4k:"fg2pwug",Bsft5z2:"f13zj6fq",B4rk6o:"f8vk40g",gn64ia:"fqg5mu5"}},{d:[".f1vx9l62{flex-direction:column;}",".f16gbxbe{min-height:20px;}",".f1yq6w5o::before{border-right-style:solid;}",".f1jpmc5p::before{border-left-style:solid;}",".f9sc749::before{border-right-width:var(--strokeWidthThin);}",".f1x8pvcy::before{border-left-width:var(--strokeWidthThin);}",".fhkwbjy::before{min-height:8px;}",".flthirb::after{border-right-style:solid;}",".ftkbnf5::after{border-left-style:solid;}",".f13hvwk3::after{border-right-width:var(--strokeWidthThin);}",".f1en4csx::after{border-left-width:var(--strokeWidthThin);}",".f19onpk6::after{min-height:8px;}",".f1xdg43u{margin-top:12px;}",".f1jlhsmd{margin-bottom:12px;}",".f1tjaq3g{min-height:84px;}",'.f1wl9k8s::before{content:"";}',".fg2pwug::before{margin-bottom:12px;}",".fkjtzyi::before{max-height:8px;}",".f8vk40g::after{margin-top:12px;}",'.f13zj6fq::after{content:"";}',".fqg5mu5::after{max-height:8px;}"]});var p=o(34877);const f=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{alignContent:o="center",appearance:i="default",inset:n=!1,vertical:r=!1,wrapper:c}=e,u=(0,s.Bi)("divider-");return{alignContent:o,appearance:i,inset:n,vertical:r,components:{root:"div",wrapper:"div"},root:a.Gk((0,l.g)("div",{role:"separator","aria-orientation":r?"vertical":"horizontal","aria-labelledby":e.children?u:void 0,...e,ref:t}),{elementType:"div"}),wrapper:a.Gk(c,{defaultProps:{id:u,children:e.children},elementType:"div"})}})(e,t);return(e=>{const t=d(),o=h(),i=g(),{alignContent:n,appearance:r,inset:s,vertical:a}=e;e.root.className=(0,u.z)("fui-Divider",t.base,t[n],r&&t[r],!a&&o.base,!a&&s&&o.inset,!a&&o[n],a&&i.base,a&&s&&i.inset,a&&i[n],a&&void 0!==e.root.children&&i.withChildren,void 0===e.root.children&&t.childless,e.root.className),e.wrapper&&(e.wrapper.className=(0,u.z)("fui-Divider__wrapper",e.wrapper.className))})(o),(0,p.$e)("useDividerStyles_unstable")(o),(e=>((0,r.C)(e),(0,n.Y)(e.root,{children:void 0!==e.root.children&&(0,n.Y)(e.wrapper,{children:e.root.children})})))(o)}));f.displayName="Divider"},35495:(e,t,o)=>{"use strict";o.d(t,{o:()=>r});var i=o(95734);const n=i.createContext(void 0),r=(n.Provider,()=>i.useContext(n))},16808:(e,t,o)=>{"use strict";if(o.d(t,{c:()=>n}),3023==o.j)var i=o(35495);function n(e,t){return function(e,t,o){if(!e)return t;t={...t};const{generatedControlId:i,hintId:n,labelFor:r,labelId:s,required:a,validationMessageId:l,validationState:c}=e;var u,d,h,g,p,f,m,v,b,y,w,C,S;(i&&(null!==(d=(u=t).id)&&void 0!==d||(u.id=i)),!s||(null==o?void 0:o.supportsLabelFor)&&r===t.id||null!==(p=(h=t)[g="aria-labelledby"])&&void 0!==p||(h[g]=s),(l||n)&&(t["aria-describedby"]=[l,n,null==t?void 0:t["aria-describedby"]].filter(Boolean).join(" ")),"error"===c&&(null!==(m=(f=t)["aria-invalid"])&&void 0!==m||(f["aria-invalid"]=!0)),a)&&((null==o?void 0:o.supportsRequired)?null!==(w=(y=t).required)&&void 0!==w||(y.required=!0):null!==(S=(C=t)["aria-required"])&&void 0!==S||(C["aria-required"]=!0));return(null==o?void 0:o.supportsSize)&&(null!==(b=(v=t).size)&&void 0!==b||(v.size=e.size)),t}((0,i.o)(),e,t)}},60874:(e,t,o)=>{"use strict";o.d(t,{R:()=>F});var i,n=o(30206),r=o(95734),s=o(20941),a=o(56308),l=o(19440),c=o(30915),u=o(91578),d=o(24607),h=o(60343),g=o(89416),p=o(17875),f=o(13668),m=o(63666),v=o(98288),b=o(5871),y=o(98675),w=o(50610),C=o(48614),S=o(44207),k="data-is-focusable",T="data-focuszone-id",x="tabindex",_="data-no-vertical-wrap",I="data-no-horizontal-wrap",E=999999999,B=-999999999;function A(e,t){var o;"function"==typeof MouseEvent?o=new MouseEvent("click",{ctrlKey:null==t?void 0:t.ctrlKey,metaKey:null==t?void 0:t.metaKey,shiftKey:null==t?void 0:t.shiftKey,altKey:null==t?void 0:t.altKey,bubbles:null==t?void 0:t.bubbles,cancelable:null==t?void 0:t.cancelable}):(o=document.createEvent("MouseEvents")).initMouseEvent("click",!!t&&t.bubbles,!!t&&t.cancelable,window,0,0,0,0,0,!!t&&t.ctrlKey,!!t&&t.altKey,!!t&&t.shiftKey,!!t&&t.metaKey,0,null),e.dispatchEvent(o)}var R={},M=new Set,D=["text","number","password","email","tel","url","search","textarea"],P=!1,F=function(e){function t(o){var i,n,p,f,m=e.call(this,o)||this;m._root=r.createRef(),m._mergedRef=(0,a.K)(),m._onFocus=function(e){if(!m._portalContainsElement(e.target)){var t,o=m.props,i=o.onActiveElementChanged,n=o.doNotAllowFocusEventToPropagate,r=o.stopFocusPropagation,s=o.onFocusNotification,a=o.onFocus,u=o.shouldFocusInnerElementWhenReceivedFocus,d=o.defaultTabbableElement,h=m._isImmediateDescendantOfZone(e.target);if(h)t=e.target;else for(var g=e.target;g&&g!==m._root.current;){if((0,l.S0)(g,void 0,m._inShadowRoot)&&m._isImmediateDescendantOfZone(g)){t=g;break}g=(0,c.P)(g,P)}if(u&&e.target===m._root.current){var p=d&&"function"==typeof d&&m._root.current&&d(m._root.current);p&&(0,l.S0)(p,void 0,m._inShadowRoot)?(t=p,p.focus()):(m.focus(!0),m._activeElement&&(t=null))}var f=!m._activeElement;t&&t!==m._activeElement&&((h||f)&&m._setFocusAlignment(t,!0,!0),m._activeElement=t,f&&m._updateTabIndexes()),i&&i(m._activeElement,e),(r||n)&&e.stopPropagation(),a?a(e):s&&s()}},m._onBlur=function(){m._setParkedFocus(!1)},m._onMouseDown=function(e){if(!m._portalContainsElement(e.target)&&!m.props.disabled){for(var t=e.target,o=[];t&&t!==m._root.current;)o.push(t),t=(0,c.P)(t,P);for(;o.length&&((t=o.pop())&&(0,l.S0)(t,void 0,m._inShadowRoot)&&m._setActiveElement(t,!0),!(0,l.HC)(t)););}},m._onKeyDown=function(e,t){if(!m._portalContainsElement(e.target)){var o=m.props,i=o.direction,n=o.disabled,r=o.isInnerZoneKeystroke,a=o.pagingSupportDisabled,c=o.shouldEnterInnerZone;if(!(n||(m.props.onKeyDown&&m.props.onKeyDown(e),e.isDefaultPrevented()||m._getDocument().activeElement===m._root.current&&m._isInnerZone))){if((c&&c(e)||r&&r(e))&&m._isImmediateDescendantOfZone(e.target)){var h=m._getFirstInnerZone();if(h){if(!h.focus(!0))return}else{if(!(0,l.Z5)(e.target))return;if(!m.focusElement((0,l.eX)(e.target,e.target.firstChild,!0)))return}}else{if(e.altKey)return;switch(e.which){case u.c.space:if(m._shouldRaiseClicksOnSpace&&m._tryInvokeClickForFocusable(e.target,e))break;return;case u.c.left:if(i!==s.E.vertical&&(m._preventDefaultWhenHandled(e),m._moveFocusLeft(t)))break;return;case u.c.right:if(i!==s.E.vertical&&(m._preventDefaultWhenHandled(e),m._moveFocusRight(t)))break;return;case u.c.up:if(i!==s.E.horizontal&&(m._preventDefaultWhenHandled(e),m._moveFocusUp()))break;return;case u.c.down:if(i!==s.E.horizontal&&(m._preventDefaultWhenHandled(e),m._moveFocusDown()))break;return;case u.c.pageDown:if(!a&&m._moveFocusPaging(!0))break;return;case u.c.pageUp:if(!a&&m._moveFocusPaging(!1))break;return;case u.c.tab:if(m.props.allowTabKey||m.props.handleTabKey===s.l.all||m.props.handleTabKey===s.l.inputOnly&&m._isElementInput(e.target)){var g=!1;if(m._processingTabKey=!0,g=i!==s.E.vertical&&m._shouldWrapFocus(m._activeElement,I)?((0,d.jI)(t)?!e.shiftKey:e.shiftKey)?m._moveFocusLeft(t):m._moveFocusRight(t):e.shiftKey?m._moveFocusUp():m._moveFocusDown(),m._processingTabKey=!1,g)break;m.props.shouldResetActiveElementWhenTabFromZone&&(m._activeElement=null)}return;case u.c.home:if(m._isContentEditableElement(e.target)||m._isElementInput(e.target)&&!m._shouldInputLoseFocus(e.target,!1))return!1;var p=m._root.current&&m._root.current.firstChild;if(m._root.current&&p&&m.focusElement((0,l.eX)(m._root.current,p,!0)))break;return;case u.c.end:if(m._isContentEditableElement(e.target)||m._isElementInput(e.target)&&!m._shouldInputLoseFocus(e.target,!0))return!1;var f=m._root.current&&m._root.current.lastChild;if(m._root.current&&m.focusElement((0,l.yv)(m._root.current,f,!0,!0,!0)))break;return;case u.c.enter:if(m._shouldRaiseClicksOnEnter&&m._tryInvokeClickForFocusable(e.target,e))break;return;default:return}}e.preventDefault(),e.stopPropagation()}}},m._getHorizontalDistanceFromCenter=function(e,t,o){var i=m._focusAlignment.left||m._focusAlignment.x||0,n=Math.floor(o.top),r=Math.floor(t.bottom),s=Math.floor(o.bottom),a=Math.floor(t.top);return e&&n>r||!e&&s<a?i>=o.left&&i<=o.left+o.width?0:Math.abs(o.left+o.width/2-i):m._shouldWrapFocus(m._activeElement,_)?E:B},(0,h.f)(m),m._id=(0,g.O)("FocusZone"),m._focusAlignment={left:0,top:0},m._processingTabKey=!1;var v=null===(n=null!==(i=o.shouldRaiseClicks)&&void 0!==i?i:t.defaultProps.shouldRaiseClicks)||void 0===n||n;return m._shouldRaiseClicksOnEnter=null!==(p=o.shouldRaiseClicksOnEnter)&&void 0!==p?p:v,m._shouldRaiseClicksOnSpace=null!==(f=o.shouldRaiseClicksOnSpace)&&void 0!==f?f:v,m}return(0,n.__extends)(t,e),t.getOuterZones=function(){return M.size},t._onKeyDownCapture=function(e){e.which===u.c.tab&&M.forEach((function(e){return e._updateTabIndexes()}))},t.prototype.componentDidMount=function(){var e,o=this._root.current;if(this._inShadowRoot=!!(null===(e=this.context)||void 0===e?void 0:e.shadowRoot),R[this._id]=this,o){for(var i=(0,c.P)(o,P);i&&i!==this._getDocument().body&&1===i.nodeType;){if((0,l.HC)(i)){this._isInnerZone=!0;break}i=(0,c.P)(i,P)}this._isInnerZone||(M.add(this),this._root.current&&this._root.current.addEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.addEventListener("blur",this._onBlur,!0),this._updateTabIndexes(),this.props.defaultTabbableElement&&"string"==typeof this.props.defaultTabbableElement?this._activeElement=this._getDocument().querySelector(this.props.defaultTabbableElement):this.props.defaultActiveElement&&(this._activeElement=this._getDocument().querySelector(this.props.defaultActiveElement)),this.props.shouldFocusOnMount&&this.focus()}},t.prototype.componentDidUpdate=function(){var e,t=this._root.current,o=this._getDocument();if(this._inShadowRoot=!!(null===(e=this.context)||void 0===e?void 0:e.shadowRoot),(this._activeElement&&!(0,p.s)(this._root.current,this._activeElement,P)||this._defaultFocusElement&&!(0,p.s)(this._root.current,this._defaultFocusElement,P))&&(this._activeElement=null,this._defaultFocusElement=null,this._updateTabIndexes()),!this.props.preventFocusRestoration&&o&&this._lastIndexPath&&(o.activeElement===o.body||null===o.activeElement||o.activeElement===t)){var i=(0,l.nA)(t,this._lastIndexPath);i?(this._setActiveElement(i,!0),i.focus(),this._setParkedFocus(!1)):this._setParkedFocus(!0)}},t.prototype.componentWillUnmount=function(){delete R[this._id],this._isInnerZone||(M.delete(this),this._root.current&&this._root.current.removeEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.removeEventListener("blur",this._onBlur,!0),this._activeElement=null,this._defaultFocusElement=null},t.prototype.render=function(){var e=this,t=this.props,o=t.as,s=t.elementType,a=t.rootProps,l=t.ariaDescribedBy,c=t.ariaLabelledBy,u=t.className,d=(0,f.G1)(this.props,f.vt),h=o||s||"div";this._evaluateFocusBeforeRender();var g=(0,S.O4)();return r.createElement(h,(0,n.__assign)({"aria-labelledby":c,"aria-describedby":l},d,a,{className:(0,m.A)((i||(i=(0,C.Z)({selectors:{":focus":{outline:"none"}}},"ms-FocusZone")),i),u),ref:this._mergedRef(this.props.elementRef,this._root),"data-focuszone-id":this._id,onKeyDown:function(t){return e._onKeyDown(t,g)},onFocus:this._onFocus,onMouseDownCapture:this._onMouseDown}),this.props.children)},t.prototype.focus=function(e,t){if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._root.current){if(!e&&"true"===this._root.current.getAttribute(k)&&this._isInnerZone){var o=this._getOwnerZone(this._root.current);if(o!==this._root.current){var i=R[o.getAttribute(T)];return!!i&&i.focusElement(this._root.current)}return!1}if(!e&&this._activeElement&&(0,p.s)(this._root.current,this._activeElement)&&(0,l.S0)(this._activeElement,void 0,this._inShadowRoot)&&(!t||(0,l.F2)(this._activeElement)))return this._activeElement.focus(),!0;var n=this._root.current.firstChild;return this.focusElement((0,l.eX)(this._root.current,n,!0,void 0,void 0,void 0,void 0,void 0,t))}return!1},t.prototype.focusLast=function(){if(this._root.current){var e=this._root.current&&this._root.current.lastChild;return this.focusElement((0,l.yv)(this._root.current,e,!0,!0,!0))}return!1},t.prototype.focusElement=function(e,t){var o=this.props,i=o.onBeforeFocus,n=o.shouldReceiveFocus;return!(n&&!n(e)||i&&!i(e)||!e||(this._setActiveElement(e,t),this._activeElement&&this._activeElement.focus(),0))},t.prototype.setFocusAlignment=function(e){this._focusAlignment=e},Object.defineProperty(t.prototype,"defaultFocusElement",{get:function(){return this._defaultFocusElement},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"activeElement",{get:function(){return this._activeElement},enumerable:!1,configurable:!0}),t.prototype._evaluateFocusBeforeRender=function(){var e=this._root.current,t=this._getDocument();if(t){var o=t.activeElement;if(o!==e){var i=(0,p.s)(e,o,!1);this._lastIndexPath=i?(0,l.Ep)(e,o):void 0}}},t.prototype._setParkedFocus=function(e){var t=this._root.current;t&&this._isParked!==e&&(this._isParked=e,e?(this.props.allowFocusRoot||(this._parkedTabIndex=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")),t.focus()):this.props.allowFocusRoot||(this._parkedTabIndex?(t.setAttribute("tabindex",this._parkedTabIndex),this._parkedTabIndex=void 0):t.removeAttribute("tabindex")))},t.prototype._setActiveElement=function(e,t){var o=this._activeElement;this._activeElement=e,o&&((0,l.HC)(o)&&this._updateTabIndexes(o),o.tabIndex=-1),this._activeElement&&(this._focusAlignment&&!t||this._setFocusAlignment(e,!0,!0),this._activeElement.tabIndex=0)},t.prototype._preventDefaultWhenHandled=function(e){this.props.preventDefaultWhenHandled&&e.preventDefault()},t.prototype._tryInvokeClickForFocusable=function(e,t){var o=e;if(o===this._root.current)return!1;do{if("BUTTON"===o.tagName||"A"===o.tagName||"INPUT"===o.tagName||"TEXTAREA"===o.tagName||"SUMMARY"===o.tagName)return!1;if(this._isImmediateDescendantOfZone(o)&&"true"===o.getAttribute(k)&&"true"!==o.getAttribute("data-disable-click-on-enter"))return A(o,t),!0;o=(0,c.P)(o,P)}while(o!==this._root.current);return!1},t.prototype._getFirstInnerZone=function(e){if(!(e=e||this._activeElement||this._root.current))return null;if((0,l.HC)(e))return R[e.getAttribute(T)];for(var t=e.firstElementChild;t;){if((0,l.HC)(t))return R[t.getAttribute(T)];var o=this._getFirstInnerZone(t);if(o)return o;t=t.nextElementSibling}return null},t.prototype._moveFocus=function(e,t,o,i){void 0===i&&(i=!0);var n=this._activeElement,r=-1,a=void 0,c=!1,u=this.props.direction===s.E.bidirectional;if(!n||!this._root.current)return!1;if(this._isElementInput(n)&&!this._shouldInputLoseFocus(n,e))return!1;var d=u?n.getBoundingClientRect():null;do{if(n=e?(0,l.eX)(this._root.current,n):(0,l.yv)(this._root.current,n),!u){a=n;break}if(n){var h=t(d,n.getBoundingClientRect());if(-1===h&&-1===r){a=n;break}if(h>-1&&(-1===r||h<r)&&(r=h,a=n),r>=0&&h<0)break}}while(n);if(a&&a!==this._activeElement)c=!0,this.focusElement(a);else if(this.props.isCircularNavigation&&i)return e?this.focusElement((0,l.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,l.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return c},t.prototype._moveFocusDown=function(){var e=this,t=-1,o=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!0,(function(i,n){var r=-1,s=Math.floor(n.top),a=Math.floor(i.bottom);return s<a?e._shouldWrapFocus(e._activeElement,_)?E:B:((-1===t&&s>=a||s===t)&&(t=s,r=o>=n.left&&o<=n.left+n.width?0:Math.abs(n.left+n.width/2-o)),r)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusUp=function(){var e=this,t=-1,o=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!1,(function(i,n){var r=-1,s=Math.floor(n.bottom),a=Math.floor(n.top),l=Math.floor(i.top);return s>l?e._shouldWrapFocus(e._activeElement,_)?E:B:((-1===t&&s<=l||a===t)&&(t=a,r=o>=n.left&&o<=n.left+n.width?0:Math.abs(n.left+n.width/2-o)),r)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusLeft=function(e){var t=this,o=this._shouldWrapFocus(this._activeElement,I);return!!this._moveFocus((0,d.jI)(e),(function(i,n){var r=-1;return((0,d.jI)(e)?parseFloat(n.top.toFixed(3))<parseFloat(i.bottom.toFixed(3)):parseFloat(n.bottom.toFixed(3))>parseFloat(i.top.toFixed(3)))&&n.right<=i.right&&t.props.direction!==s.E.vertical?r=i.right-n.right:o||(r=B),r}),void 0,o)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusRight=function(e){var t=this,o=this._shouldWrapFocus(this._activeElement,I);return!!this._moveFocus(!(0,d.jI)(e),(function(i,n){var r=-1;return((0,d.jI)(e)?parseFloat(n.bottom.toFixed(3))>parseFloat(i.top.toFixed(3)):parseFloat(n.top.toFixed(3))<parseFloat(i.bottom.toFixed(3)))&&n.left>=i.left&&t.props.direction!==s.E.vertical?r=n.left-i.left:o||(r=B),r}),void 0,o)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusPaging=function(e,t){void 0===t&&(t=!0);var o=this._activeElement;if(!o||!this._root.current)return!1;if(this._isElementInput(o)&&!this._shouldInputLoseFocus(o,e))return!1;var i=(0,v.Hc)(o);if(!i)return!1;var n=-1,r=void 0,s=-1,a=-1,c=i.clientHeight,u=o.getBoundingClientRect();do{if(o=e?(0,l.eX)(this._root.current,o):(0,l.yv)(this._root.current,o)){var d=o.getBoundingClientRect(),h=Math.floor(d.top),g=Math.floor(u.bottom),p=Math.floor(d.bottom),f=Math.floor(u.top),m=this._getHorizontalDistanceFromCenter(e,u,d);if(e&&h>g+c||!e&&p<f-c)break;m>-1&&(e&&h>s?(s=h,n=m,r=o):!e&&p<a?(a=p,n=m,r=o):(-1===n||m<=n)&&(n=m,r=o))}}while(o);var b=!1;if(r&&r!==this._activeElement)b=!0,this.focusElement(r),this._setFocusAlignment(r,!1,!0);else if(this.props.isCircularNavigation&&t)return e?this.focusElement((0,l.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,l.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return b},t.prototype._setFocusAlignment=function(e,t,o){if(this.props.direction===s.E.bidirectional&&(!this._focusAlignment||t||o)){var i=e.getBoundingClientRect(),n=i.left+i.width/2,r=i.top+i.height/2;this._focusAlignment||(this._focusAlignment={left:n,top:r}),t&&(this._focusAlignment.left=n),o&&(this._focusAlignment.top=r)}},t.prototype._isImmediateDescendantOfZone=function(e){return this._getOwnerZone(e)===this._root.current},t.prototype._getOwnerZone=function(e){for(var t=(0,c.P)(e,P);t&&t!==this._root.current&&t!==this._getDocument().body;){if((0,l.HC)(t))return t;t=(0,c.P)(t,P)}return t},t.prototype._updateTabIndexes=function(e){!this._activeElement&&this.props.defaultTabbableElement&&"function"==typeof this.props.defaultTabbableElement&&(this._activeElement=this.props.defaultTabbableElement(this._root.current)),!e&&this._root.current&&(this._defaultFocusElement=null,e=this._root.current,this._activeElement&&!(0,p.s)(e,this._activeElement)&&(this._activeElement=null)),this._activeElement&&!(0,l.S0)(this._activeElement,void 0,this._inShadowRoot)&&(this._activeElement=null);for(var t=e&&e.children,o=0;t&&o<t.length;o++){var i=t[o];(0,l.HC)(i)?"true"===i.getAttribute(k)&&(this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==i?"-1"!==i.getAttribute(x)&&i.setAttribute(x,"-1"):(this._defaultFocusElement=i,"0"!==i.getAttribute(x)&&i.setAttribute(x,"0"))):(i.getAttribute&&"false"===i.getAttribute(k)&&i.setAttribute(x,"-1"),(0,l.S0)(i,void 0,this._inShadowRoot)?this.props.disabled?i.setAttribute(x,"-1"):this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==i?"-1"!==i.getAttribute(x)&&i.setAttribute(x,"-1"):(this._defaultFocusElement=i,"0"!==i.getAttribute(x)&&i.setAttribute(x,"0")):"svg"===i.tagName&&"false"!==i.getAttribute("focusable")&&i.setAttribute("focusable","false")),this._updateTabIndexes(i)}},t.prototype._isContentEditableElement=function(e){return e&&"true"===e.getAttribute("contenteditable")},t.prototype._isElementInput=function(e){return!(!e||!e.tagName||"input"!==e.tagName.toLowerCase()&&"textarea"!==e.tagName.toLowerCase())},t.prototype._shouldInputLoseFocus=function(e,t){if(!this._processingTabKey&&e&&e.type&&D.indexOf(e.type.toLowerCase())>-1){var o=e.selectionStart,i=o!==e.selectionEnd,n=e.value,r=e.readOnly;if(i||o>0&&!t&&!r||o!==n.length&&t&&!r||this.props.handleTabKey&&(!this.props.shouldInputLoseFocusOnArrowKey||!this.props.shouldInputLoseFocusOnArrowKey(e)))return!1}return!0},t.prototype._shouldWrapFocus=function(e,t){return!this.props.checkForNoWrap||(0,l._l)(e,t)},t.prototype._portalContainsElement=function(e){return e&&!!this._root.current&&(0,b.s)(e,this._root.current)},t.prototype._getDocument=function(){return(0,y.Y)(this._root.current)},t.contextType=w.c,t.defaultProps={isCircularNavigation:!1,direction:s.E.bidirectional,shouldRaiseClicks:!0,"data-tabster":'{"uncontrolled": {}}'},t}(r.Component)},20941:(e,t,o)=>{"use strict";o.d(t,{E:()=>i,l:()=>n});var i,n={none:0,all:1,inputOnly:2};!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.bidirectional=2]="bidirectional",e[e.domOrder=3]="domOrder"}(i||(i={}))},54937:(e,t,o)=>{"use strict";o.d(t,{B:()=>r});var i=o(95734);if(3023==o.j)var n=o(89416);function r(e,t){var o=i.useRef(t);return o.current||(o.current=(0,n.O)(e)),o.current}},15289:(e,t,o)=>{"use strict";o.d(t,{Z:()=>n});var i=o(95734);function n(e){var t=i.useRef();return i.useEffect((function(){t.current=e})),t.current}},46914:(e,t,o)=>{"use strict";o.d(t,{Ncu:()=>l,WG1:()=>r,hhx:()=>s,pTW:()=>a,t2R:()=>n});var i=o(14774);const n=(0,i.U)("ArrowUndo16Regular","16",["M3 2.5a.5.5 0 0 1 1 0v3.84l3.17-3.17a4 4 0 0 1 5.66 5.66L7.8 13.85a.5.5 0 0 1-.7-.7l5.02-5.03a3 3 0 1 0-4.24-4.24L4.76 7H8.5a.5.5 0 0 1 0 1H3.6a.6.6 0 0 1-.6-.6V2.5Z"],{flipInRtl:!0}),r=3023==o.j?(0,i.U)("ArrowUpload16Filled","16",["M3.75 2a.75.75 0 0 0 0 1.5h8.5a.75.75 0 0 0 0-1.5h-8.5Zm4.78 2.72a.75.75 0 0 0-1.06 0L4.22 7.97a.75.75 0 0 0 1.06 1.06l1.97-1.97v6.19a.75.75 0 0 0 1.5 0V7.06l1.97 1.97a.75.75 0 1 0 1.06-1.06L8.53 4.72Z"]):null,s=3023==o.j?(0,i.U)("ArrowUpload20Regular","20",["M15 3a.5.5 0 0 0 .09-.99H4a.5.5 0 0 0-.09.98L4 3h11ZM9.5 18a.5.5 0 0 0 .5-.41V5.7l3.64 3.65c.17.18.44.2.64.06l.07-.06a.5.5 0 0 0 .06-.63l-.06-.07-4.5-4.5A.5.5 0 0 0 9.6 4h-.1a.5.5 0 0 0-.4.19L4.64 8.65a.5.5 0 0 0 .64.76l.07-.06L9 5.71V17.5c0 .28.22.5.5.5Z"]):null,a=3023==o.j?(0,i.U)("BookQuestionMark20Filled","20",["M6 2a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6Zm2.76 4.4a.9.9 0 0 0-.26.6.5.5 0 0 1-1 0c0-.37.14-.87.54-1.28C8.45 5.29 9.09 5 10 5c.91 0 1.55.29 1.96.72.4.41.54.91.54 1.28 0 1.05-.73 1.55-1.28 1.82a8 8 0 0 1-.39.18h-.01a5.75 5.75 0 0 0-.32.15V10a.5.5 0 0 1-1 0V9c0-.25.13-.43.24-.53.11-.1.24-.18.35-.23l.32-.15.02-.01a7 7 0 0 0 .35-.16c.45-.22.72-.47.72-.92a.9.9 0 0 0-.26-.6c-.19-.19-.55-.4-1.24-.4s-1.05.21-1.24.4ZM10 13a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"]):null,l=3023==o.j?(0,i.U)("BookQuestionMark20Regular","20",["M4 4v12c0 1.1.9 2 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2Zm10-1a1 1 0 0 1 1 1v11H5V4a1 1 0 0 1 1-1h8ZM8.76 6.4c.19-.19.55-.4 1.24-.4s1.05.21 1.24.4c.2.22.26.47.26.6 0 .45-.27.7-.72.92a7 7 0 0 1-.35.16l-.02.01-.32.15c-.1.05-.24.12-.35.23A.73.73 0 0 0 9.5 9v1a.5.5 0 1 0 1 0v-.85l.04-.02.28-.13h.01a8 8 0 0 0 .4-.18c.54-.27 1.27-.77 1.27-1.82 0-.37-.14-.87-.54-1.28C11.55 5.29 10.91 5 10 5c-.91 0-1.55.29-1.96.72-.4.41-.54.91-.54 1.28a.5.5 0 0 0 1 0 .9.9 0 0 1 .26-.6ZM10 13a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z"]):null},14888:(e,t,o)=>{"use strict";o.d(t,{MOA:()=>s,afj:()=>a,p2N:()=>n,tNe:()=>r});var i=o(14774);const n=3023==o.j?(0,i.U)("PersonFeedback20Filled","20",["M10.5 12c.83 0 1.5.67 1.5 1.5v.5c0 1.97-1.86 4-5 4-3.14 0-5-2.03-5-4v-.5c0-.83.67-1.5 1.5-1.5h7ZM7 5.5A2.75 2.75 0 1 1 7 11a2.75 2.75 0 0 1 0-5.5ZM16 2a2 2 0 0 1 2 1.85V6a2 2 0 0 1-1.85 2H14.5l-1.2 1.6a1 1 0 0 1-1.78-.38l-.01-.1V9l-.01-1.07-.08-.01a2 2 0 0 1-1.4-1.6l-.01-.17L10 6V4a2 2 0 0 1 1.85-2H16Z"]):null,r=3023==o.j?(0,i.U)("PersonFeedback20Regular","20",["M10.5 12c.83 0 1.5.67 1.5 1.5v.5c0 1.97-1.86 4-5 4-3.14 0-5-2.03-5-4v-.5c0-.83.67-1.5 1.5-1.5h7Zm0 1h-7a.5.5 0 0 0-.5.5v.5c0 1.44 1.43 3 4 3 2.57 0 4-1.56 4-3v-.5a.5.5 0 0 0-.5-.5ZM7 5.5A2.75 2.75 0 1 1 7 11a2.75 2.75 0 0 1 0-5.5ZM16 2a2 2 0 0 1 2 1.85V6a2 2 0 0 1-1.85 2H14.5l-1.2 1.6a1 1 0 0 1-1.78-.38l-.01-.1V9l-.01-1.07-.08-.01a2 2 0 0 1-1.4-1.6l-.01-.17L10 6V4a2 2 0 0 1 1.85-2H16ZM7 6.5A1.75 1.75 0 1 0 7 10a1.75 1.75 0 0 0 0-3.5ZM16 3h-4a1 1 0 0 0-1 .88V6a1 1 0 0 0 .88 1h.62v2L14 7h2a1 1 0 0 0 1-.88V4a1 1 0 0 0-.88-1H16Z"]):null,s=3023==o.j?(0,i.U)("PersonNote20Filled","20",["M10 2a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm-5 9a2 2 0 0 0-2 2c0 1.7.83 2.97 2.13 3.8 1.1.69 2.5 1.07 4.03 1.17A3 3 0 0 1 9 17v-4c0-.77.29-1.47.76-2H5.01Zm5 2c0-1.1.9-2 2-2h5a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-4Zm6.5 3h-4a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1Zm-4-3a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1h-4Z"]):null,a=3023==o.j?(0,i.U)("PersonNote20Regular","20",["M10 2a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM7 6a3 3 0 1 1 6 0 3 3 0 0 1-6 0Zm-2 5a2 2 0 0 0-2 2c0 1.7.83 2.97 2.13 3.8 1.1.69 2.5 1.07 4.03 1.17A3 3 0 0 1 9 17v-.04a7.42 7.42 0 0 1-3.33-1A3.36 3.36 0 0 1 4 13a1 1 0 0 1 1-1h4.17a3 3 0 0 1 .6-1H5Zm5 2c0-1.1.9-2 2-2h5a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-4Zm6.5 3h-4a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1Zm-4-3a.5.5 0 1 0 0 1h4a.5.5 0 1 0 0-1h-4Z"]):null},91122:(e,t,o)=>{"use strict";o.d(t,{$Dw:()=>n});var i=o(14774);const n=3023==o.j?(0,i.U)("Settings16Regular","16",["M8 6a2 2 0 1 0 0 4 2 2 0 0 0 0-4ZM7 8a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm3.62-3.6a.7.7 0 0 1-.83-.57l-.26-1.42a.35.35 0 0 0-.27-.28 6.07 6.07 0 0 0-2.52 0 .35.35 0 0 0-.27.29L6.2 3.83a.71.71 0 0 1-.94.54l-1.36-.49a.36.36 0 0 0-.38.1c-.57.63-1 1.37-1.26 2.17-.05.14 0 .29.1.38l1.1.93a.7.7 0 0 1 0 1.08l-1.1.93c-.1.1-.15.24-.1.38.26.8.69 1.54 1.26 2.17.1.1.25.14.38.1l1.36-.49a.7.7 0 0 1 .94.54l.26 1.41c.02.15.13.26.27.29a6.07 6.07 0 0 0 2.52 0 .35.35 0 0 0 .27-.29l.26-1.41a.71.71 0 0 1 .94-.54l1.36.49c.13.04.28 0 .38-.1.57-.63 1-1.37 1.26-2.17a.35.35 0 0 0-.1-.38l-1.1-.93a.7.7 0 0 1 0-1.08l1.1-.93c.1-.1.15-.24.1-.38-.26-.8-.69-1.54-1.26-2.17a.36.36 0 0 0-.38-.1l-1.36.49a.71.71 0 0 1-.11.03ZM4 4.98l.94.33a1.71 1.71 0 0 0 2.25-1.3l.18-.97a5.1 5.1 0 0 1 1.26 0l.18.97a1.7 1.7 0 0 0 2.25 1.3l.94-.33c.26.33.47.7.63 1.08l-.75.64a1.7 1.7 0 0 0 0 2.6l.75.64c-.16.39-.37.75-.63 1.08l-.94-.33a1.7 1.7 0 0 0-2.25 1.3l-.18.97a5.1 5.1 0 0 1-1.26 0l-.18-.97a1.7 1.7 0 0 0-2.25-1.3l-.94.33c-.26-.33-.47-.7-.63-1.08l.75-.64a1.7 1.7 0 0 0 0-2.6l-.75-.64c.16-.39.37-.75.63-1.08Z"]):null},83629:(e,t,o)=>{"use strict";if(o.d(t,{n:()=>c}),o(95734),3023==o.j)var i=o(16808);if(3023==o.j)var n=o(36049);if(3023==o.j)var r=o(1584);if(3023==o.j)var s=o(36216);if(3023==o.j)var a=o(32726);if(3023==o.j)var l=o(30711);const c=(e,t)=>{e=(0,i.c)(e,{supportsLabelFor:!0,supportsRequired:!0,supportsSize:!0});const o=(0,l.Pv)();var c;const{size:u="medium",appearance:d=(null!==(c=o.inputDefaultAppearance)&&void 0!==c?c:"outline"),onChange:h}=e,[g,p]=(0,n.i)({state:e.value,defaultState:e.defaultValue,initialState:""}),f=(0,r.n)({props:e,primarySlotTagName:"input",excludedPropNames:["size","onChange","value","defaultValue"]}),m={size:u,appearance:d,components:{root:"span",input:"input",contentBefore:"span",contentAfter:"span"},input:s.Gk(e.input,{defaultProps:{type:"text",ref:t,...f.primary},elementType:"input"}),contentAfter:s.lq(e.contentAfter,{elementType:"span"}),contentBefore:s.lq(e.contentBefore,{elementType:"span"}),root:s.Gk(e.root,{defaultProps:f.root,elementType:"span"})};return m.input.value=g,m.input.onChange=(0,a.D)((e=>{const t=e.target.value;null==h||h(e,{value:t}),p(t)})),m}},62447:(e,t,o)=>{"use strict";o.d(t,{d:()=>g});var i=o(59901),n=o(11612),r=o(27760);if(3023==o.j)var s=o(63649);const a=(i.L.spacingHorizontalSNudge,i.L.spacingHorizontalMNudge,i.L.spacingHorizontalM,i.L.spacingHorizontalXXS,i.L.spacingHorizontalXXS,i.L.spacingHorizontalSNudge,i.L.spacingHorizontalS,i.L.spacingHorizontalM,i.L.spacingHorizontalM,i.L.spacingHorizontalSNudge,(0,n.y)("r1oeeo9n","r9sxh5",{r:[".r1oeeo9n{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r1oeeo9n::after{box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-left-radius:var(--borderRadiusMedium);border-bottom-right-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r1oeeo9n:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r1oeeo9n:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r1oeeo9n:focus-within{outline:2px solid transparent;}",".r9sxh5{display:inline-flex;align-items:center;flex-wrap:nowrap;gap:var(--spacingHorizontalXXS);border-radius:var(--borderRadiusMedium);position:relative;box-sizing:border-box;vertical-align:middle;min-height:32px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);background-color:var(--colorNeutralBackground1);border:1px solid var(--colorNeutralStroke1);border-bottom-color:var(--colorNeutralStrokeAccessible);}",'.r9sxh5::after{box-sizing:border-box;content:"";position:absolute;right:-1px;bottom:-1px;left:-1px;height:max(2px, var(--borderRadiusMedium));border-bottom-right-radius:var(--borderRadiusMedium);border-bottom-left-radius:var(--borderRadiusMedium);border-bottom:2px solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - 2px) 0 0 0);transform:scaleX(0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}',".r9sxh5:focus-within::after{transform:scaleX(1);transition-property:transform;transition-duration:var(--durationNormal);transition-delay:var(--curveDecelerateMid);}",".r9sxh5:focus-within:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}",".r9sxh5:focus-within{outline:2px solid transparent;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r1oeeo9n:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r9sxh5:focus-within::after{transition-duration:0.01ms;transition-delay:0.01ms;}}"]})),l=(0,r.X)({small:{sshi5w:"f1pha7fy",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},medium:{},large:{sshi5w:"f1w5jphr",Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k",i8kkvl:0,Belr9w4:0,rmohyg:"f1eyhf9v"},outline:{},outlineInteractive:{Bgoe8wy:"fvcxoqz",Bwzppfd:["f1ub3y4t","f1m52nbi"],oetu4i:"f1l4zc64",gg5e9n:["f1m52nbi","f1ub3y4t"],Drbcw7:"f8vnjqi",udz0bu:["fz1etlk","f1hc16gm"],Be8ivqh:"f1klwx88",ofdepl:["f1hc16gm","fz1etlk"]},underline:{De3pzq:"f1c21dwh",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fokr779",icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],wvpqe5:["f1deefiw","f1n71otn"],Eqx8gd:["f1n6gb5g","f15yvnhg"],B1piin3:["f15yvnhg","f1n6gb5g"]},underlineInteractive:{oetu4i:"f1l4zc64",Be8ivqh:"f1klwx88",d9w3h3:0,B3778ie:0,B4j8arr:0,Bl18szs:0,Blrzh8d:"f2ale1x"},filled:{g2u3we:"fghlq4f",h3c5rm:["f1gn591s","fjscplz"],B9xav0g:"fb073pr",zhjwy3:["fjscplz","f1gn591s"]},filledInteractive:{q7v0qe:"ftmjh5b",kmh5ft:["f17blpuu","fsrcdbj"],nagaa4:"f1tpwn32",B1yhkcb:["fsrcdbj","f17blpuu"]},invalid:{tvckwq:"fs4k3qj",gk2u95:["fcee079","fmyw78r"],hhx65j:"f1fgmyf4",Bxowmz0:["fmyw78r","fcee079"]},"filled-darker":{De3pzq:"f16xq7d1"},"filled-lighter":{De3pzq:"fxugw4r"},"filled-darker-shadow":{De3pzq:"f16xq7d1",E5pizo:"fyed02w"},"filled-lighter-shadow":{De3pzq:"fxugw4r",E5pizo:"fyed02w"},disabled:{Bceei9c:"fdrzuqr",De3pzq:"f1c21dwh",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"],Bsft5z2:"fhr9occ",Bduesf4:"f99w1ws"},smallWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},smallWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},mediumWithContentBefore:{uwmqm3:["f1ng84yb","f11gcy0p"]},mediumWithContentAfter:{z189sj:["f11gcy0p","f1ng84yb"]},largeWithContentBefore:{uwmqm3:["f1uw59to","fw5db7e"]},largeWithContentAfter:{z189sj:["fw5db7e","f1uw59to"]}},{d:[".f1pha7fy{min-height:24px;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1w5jphr{min-height:40px;}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",[".f1eyhf9v{gap:var(--spacingHorizontalSNudge);}",{p:-1}],".f1c21dwh{background-color:var(--colorTransparentBackground);}",[".fokr779{border-radius:0;}",{p:-1}],".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",[".f2ale1x::after{border-radius:0;}",{p:-1}],".fghlq4f{border-top-color:var(--colorTransparentStroke);}",".f1gn591s{border-right-color:var(--colorTransparentStroke);}",".fjscplz{border-left-color:var(--colorTransparentStroke);}",".fb073pr{border-bottom-color:var(--colorTransparentStroke);}",".fs4k3qj:not(:focus-within),.fs4k3qj:hover:not(:focus-within){border-top-color:var(--colorPaletteRedBorder2);}",".fcee079:not(:focus-within),.fcee079:hover:not(:focus-within){border-right-color:var(--colorPaletteRedBorder2);}",".fmyw78r:not(:focus-within),.fmyw78r:hover:not(:focus-within){border-left-color:var(--colorPaletteRedBorder2);}",".f1fgmyf4:not(:focus-within),.f1fgmyf4:hover:not(:focus-within){border-bottom-color:var(--colorPaletteRedBorder2);}",".f16xq7d1{background-color:var(--colorNeutralBackground3);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".fyed02w{box-shadow:var(--shadow2);}",".fdrzuqr{cursor:not-allowed;}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fhr9occ::after{content:unset;}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fw5db7e{padding-right:var(--spacingHorizontalM);}"],h:[".fvcxoqz:hover{border-top-color:var(--colorNeutralStroke1Hover);}",".f1ub3y4t:hover{border-right-color:var(--colorNeutralStroke1Hover);}",".f1m52nbi:hover{border-left-color:var(--colorNeutralStroke1Hover);}",".f1l4zc64:hover{border-bottom-color:var(--colorNeutralStrokeAccessibleHover);}",".ftmjh5b:hover,.ftmjh5b:focus-within{border-top-color:var(--colorTransparentStrokeInteractive);}",".f17blpuu:hover,.f17blpuu:focus-within{border-right-color:var(--colorTransparentStrokeInteractive);}",".fsrcdbj:hover,.fsrcdbj:focus-within{border-left-color:var(--colorTransparentStrokeInteractive);}",".f1tpwn32:hover,.f1tpwn32:focus-within{border-bottom-color:var(--colorTransparentStrokeInteractive);}"],a:[".f8vnjqi:active,.f8vnjqi:focus-within{border-top-color:var(--colorNeutralStroke1Pressed);}",".fz1etlk:active,.fz1etlk:focus-within{border-right-color:var(--colorNeutralStroke1Pressed);}",".f1hc16gm:active,.f1hc16gm:focus-within{border-left-color:var(--colorNeutralStroke1Pressed);}",".f1klwx88:active,.f1klwx88:focus-within{border-bottom-color:var(--colorNeutralStrokeAccessiblePressed);}"],m:[["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]],w:[".f99w1ws:focus-within{outline-style:none;}"]}),c=3023==o.j?(0,n.y)("r12stul0",null,[".r12stul0{align-self:stretch;box-sizing:border-box;flex-grow:1;min-width:0;border-style:none;padding:0 var(--spacingHorizontalM);color:var(--colorNeutralForeground1);background-color:transparent;outline-style:none;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;}",".r12stul0::-webkit-input-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::-moz-placeholder{color:var(--colorNeutralForeground4);opacity:1;}",".r12stul0::placeholder{color:var(--colorNeutralForeground4);opacity:1;}"]):null,u=(0,r.X)({small:{uwmqm3:["f1f5gg8d","f1vdfbxk"],z189sj:["f1vdfbxk","f1f5gg8d"]},medium:{},large:{uwmqm3:["fnphzt9","flt1dlf"],z189sj:["flt1dlf","fnphzt9"]},smallWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},smallWithContentAfter:{z189sj:["ffczdla","fgiv446"]},mediumWithContentBefore:{uwmqm3:["fgiv446","ffczdla"]},mediumWithContentAfter:{z189sj:["ffczdla","fgiv446"]},largeWithContentBefore:{uwmqm3:["fk8j09s","fdw0yi8"]},largeWithContentAfter:{z189sj:["fdw0yi8","fk8j09s"]},disabled:{sj55zd:"f1s2aq7o",De3pzq:"f1c21dwh",Bceei9c:"fdrzuqr",yvdlaj:"fahhnxm"}},{d:[".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".fnphzt9{padding-left:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".flt1dlf{padding-right:calc(var(--spacingHorizontalM) + var(--spacingHorizontalSNudge));}",".fgiv446{padding-left:var(--spacingHorizontalXXS);}",".ffczdla{padding-right:var(--spacingHorizontalXXS);}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".fdrzuqr{cursor:not-allowed;}",".fahhnxm::-webkit-input-placeholder{color:var(--colorNeutralForegroundDisabled);}",".fahhnxm::-moz-placeholder{color:var(--colorNeutralForegroundDisabled);}"]}),d=3023==o.j?(0,n.y)("r1572tok",null,[".r1572tok{box-sizing:border-box;color:var(--colorNeutralForeground3);display:flex;}",".r1572tok>svg{font-size:20px;}"]):null,h=(0,r.X)({disabled:{sj55zd:"f1s2aq7o"},small:{Duoase:"f3qv9w"},medium:{},large:{Duoase:"f16u2scb"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f3qv9w>svg{font-size:16px;}",".f16u2scb>svg{font-size:24px;}"]}),g=e=>{const{size:t,appearance:o}=e,i=e.input.disabled,n="true"==`${e.input["aria-invalid"]}`,r=o.startsWith("filled"),g=l(),p=u(),f=h();e.root.className=(0,s.z)("fui-Input",a(),g[t],e.contentBefore&&g[`${t}WithContentBefore`],e.contentAfter&&g[`${t}WithContentAfter`],g[o],!i&&"outline"===o&&g.outlineInteractive,!i&&"underline"===o&&g.underlineInteractive,!i&&r&&g.filledInteractive,r&&g.filled,!i&&n&&g.invalid,i&&g.disabled,e.root.className),e.input.className=(0,s.z)("fui-Input__input",c(),p[t],e.contentBefore&&p[`${t}WithContentBefore`],e.contentAfter&&p[`${t}WithContentAfter`],i&&p.disabled,e.input.className);const m=[d(),i&&f.disabled,f[t]];return e.contentBefore&&(e.contentBefore.className=(0,s.z)("fui-Input__contentBefore",...m,e.contentBefore.className)),e.contentAfter&&(e.contentAfter.className=(0,s.z)("fui-Input__contentAfter",...m,e.contentAfter.className)),e}},89001:(e,t,o)=>{"use strict";o.d(t,{N:()=>f});var i=o(95734),n=o(39366),r=o(35333),s=o(201),a=o(60358),l=o(78576),c=o(27760),u=o(63649);const d=(0,c.X)({focusIndicator:{Bttzg6e:"fhgqx19",B3uz8dt:"f1olyrje",B6ihwck:"f1p93eir",g9k6zt:"f1nev41a"},root:{B486eqv:"f2hkw1w",De3pzq:"f3rmtva",B7ck84d:"f1ewtqcl",sj55zd:"fyind8e",Bceei9c:"f1k6fduh",mc9l5x:"f1w7gpdv",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1s184ao",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai",B68tc82:0,Bmxbyg5:0,Bpg54ce:"fnbmjn9",fsow6f:["f1o700av","fes3tcz"],w71qe1:"f1iuv45f",Bkioxbp:"f1cmlufx",ygn44y:"f9n3di6",famaaq:"f1ids18y",Bde5pd6:"f1tx3yz7",Bi91k9c:"f1deo86v",i089h6:"f1eh06m1",lj723h:"f1iescvh"},button:{icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],oivjwe:"f1h8hb77",wvpqe5:["f1deefiw","f1n71otn"]},href:{Be2twd7:"fjoy568"},subtle:{sj55zd:"fkfq4zb",Bde5pd6:"f1tx3yz7",Bi91k9c:"fnwyq0v",i089h6:"f1eh06m1",lj723h:"flvvhsy"},inline:{w71qe1:"f13mvf36"},disabled:{w71qe1:"f1iuv45f",sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bde5pd6:"fbnuktb",Bi91k9c:"fvgxktp",i089h6:"fljg2da",lj723h:"f19wldhg"},inverted:{sj55zd:"f1qz2gb0",Bi91k9c:"f1mlt8il",lj723h:"f1hsd4st"}},{d:[".fhgqx19[data-fui-focus-visible]{text-decoration-color:var(--colorStrokeFocus2);}",".f1olyrje[data-fui-focus-visible]{text-decoration-line:underline;}",".f1p93eir[data-fui-focus-visible]{text-decoration-style:double;}",".f1nev41a[data-fui-focus-visible]{outline-style:none;}",".f3rmtva{background-color:transparent;}",".f1ewtqcl{box-sizing:border-box;}",".fyind8e{color:var(--colorBrandForegroundLink);}",".f1k6fduh{cursor:pointer;}",".f1w7gpdv{display:inline;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",[".f1s184ao{margin:0;}",{p:-1}],[".f1mk8lai{padding:0;}",{p:-1}],[".fnbmjn9{overflow:inherit;}",{p:-1}],".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".f1iuv45f{text-decoration-line:none;}",".f1cmlufx{text-decoration-thickness:var(--strokeWidthThin);}",".f9n3di6{text-overflow:inherit;}",".f1ids18y{-webkit-user-select:text;-moz-user-select:text;user-select:text;}",".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1h8hb77{border-bottom-style:none;}",".fjoy568{font-size:inherit;}",".fkfq4zb{color:var(--colorNeutralForeground2);}",".f13mvf36{text-decoration-line:underline;}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f1qz2gb0{color:var(--colorBrandForegroundInverted);}"],i:[".f2hkw1w:focus-visible{outline-style:none;}"],h:[".f1tx3yz7:hover{text-decoration-line:underline;}",".f1deo86v:hover{color:var(--colorBrandForegroundLinkHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".fbnuktb:hover{text-decoration-line:none;}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".f1mlt8il:hover{color:var(--colorBrandForegroundInvertedHover);}"],a:[".f1eh06m1:active{text-decoration-line:underline;}",".f1iescvh:active{color:var(--colorBrandForegroundLinkPressed);}",".flvvhsy:active{color:var(--colorNeutralForeground2Pressed);}",".fljg2da:active{text-decoration-line:none;}",".f19wldhg:active{color:var(--colorNeutralForegroundDisabled);}",".f1hsd4st:active{color:var(--colorBrandForegroundInvertedPressed);}"]});var h=o(74074),g=o(64671),p=o(19821);const f=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,s.i1)(),{inline:i}=(0,l.Fr)(),{appearance:c="default",disabled:u=!1,disabledFocusable:d=!1,inline:h=!1}=e,g=e.as||(e.href?"a":"button"),p={role:"span"===g?"button":void 0,type:"button"===g?"button":void 0,...e,as:g},f={appearance:c,disabled:u,disabledFocusable:d,inline:null!=h?h:!!i,components:{root:g},root:n.Gk((0,r.g)(g,{ref:t,...p}),{elementType:g}),backgroundAppearance:o};return(0,a.e)(f),f})(e,t);return(e=>{const t=d(),{appearance:o,disabled:i,inline:n,root:r,backgroundAppearance:s}=e;e.root.className=(0,u.z)("fui-Link",t.root,t.focusIndicator,"a"===r.as&&r.href&&t.href,"button"===r.as&&t.button,"subtle"===o&&t.subtle,"inverted"===s&&t.inverted,n&&t.inline,i&&t.disabled,e.root.className)})(o),(0,p.$e)("useLinkStyles_unstable")(o),(e=>((0,g.C)(e),(0,h.Y)(e.root,{})))(o)}));f.displayName="Link"},60358:(e,t,o)=>{"use strict";if(o.d(t,{e:()=>n}),o(95734),3023==o.j)var i=o(35985);const n=e=>{const{disabled:t,disabledFocusable:o}=e,{onClick:n,onKeyDown:r,role:s,tabIndex:a}=e.root;return"a"===e.root.as&&(e.root.href=t?void 0:e.root.href,(t||o)&&(e.root.role=s||"link")),"a"!==e.root.as&&"span"!==e.root.as||(e.root.tabIndex=null!=a?a:t&&!o?void 0:0),e.root.onClick=e=>{t||o?e.preventDefault():null==n||n(e)},e.root.onKeyDown=n=>{const s=n.key===i.xyI||n.key===i.$xS;(t||o)&&s?(n.preventDefault(),n.stopPropagation()):(null==r||r(n),"span"===e.root.as&&e.root.onClick&&!r&&s&&(n.preventDefault(),n.currentTarget.click()))},e.disabled=t||o,e.root["aria-disabled"]=t||o||void 0,"button"===e.root.as&&(e.root.disabled=t&&!o),e}},78576:(e,t,o)=>{"use strict";o.d(t,{Fr:()=>s});var i=o(95734);const n=i.createContext(void 0),r={inline:!1},s=(n.Provider,()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r})},9306:(e,t,o)=>{"use strict";o.d(t,{D:()=>O});var i=o(95734),n=o(36216),r=o(48701),s=o(38523),a=o(32726),l=o(93851),c=o(98721),u=o(56380),d=o(28095),h=o(60222),g=o(87579),p=o(18729),f=o(76257),m=o(36307),v=o(35985),b=o(20796);const y=(0,h.A)(g.oAB,g.Crl),w=(0,h.A)(g.NGN,g.nUb);var C=o(60839),S=o(18861),k=o(11612),T=o(27760),x=o(63649),_=o(429);const I=(0,k.y)("rfoezjv","r8lt3v0",{r:[".rfoezjv{border-radius:var(--borderRadiusMedium);position:relative;color:var(--colorNeutralForeground2);background-color:var(--colorNeutralBackground1);padding-right:var(--spacingVerticalSNudge);padding-left:var(--spacingVerticalSNudge);padding-top:var(--spacingVerticalSNudge);padding-bottom:var(--spacingVerticalSNudge);box-sizing:border-box;max-width:290px;min-height:32px;flex-shrink:0;display:flex;align-items:start;font-size:var(--fontSizeBase300);cursor:pointer;gap:4px;-webkit-user-select:none;-moz-user-select:none;user-select:none;}",".rfoezjv:hover{background-color:var(--colorNeutralBackground1Hover);color:var(--colorNeutralForeground2Hover);}",".rfoezjv:hover .fui-Icon-filled{display:inline;}",".rfoezjv:hover .fui-Icon-regular{display:none;}",".rfoezjv:hover .fui-MenuItem__icon{color:var(--colorNeutralForeground2BrandSelected);}",".rfoezjv:hover .fui-MenuItem__subText{color:var(--colorNeutralForeground3Hover);}",".rfoezjv:hover:active{background-color:var(--colorNeutralBackground1Pressed);color:var(--colorNeutralForeground2Pressed);}",".rfoezjv:hover:active .fui-MenuItem__subText{color:var(--colorNeutralForeground3Pressed);}",".rfoezjv:focus{outline-style:none;}",".rfoezjv:focus-visible{outline-style:none;}",".rfoezjv[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}",'.rfoezjv[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}',".r8lt3v0{border-radius:var(--borderRadiusMedium);position:relative;color:var(--colorNeutralForeground2);background-color:var(--colorNeutralBackground1);padding-left:var(--spacingVerticalSNudge);padding-right:var(--spacingVerticalSNudge);padding-top:var(--spacingVerticalSNudge);padding-bottom:var(--spacingVerticalSNudge);box-sizing:border-box;max-width:290px;min-height:32px;flex-shrink:0;display:flex;align-items:start;font-size:var(--fontSizeBase300);cursor:pointer;gap:4px;-webkit-user-select:none;-moz-user-select:none;user-select:none;}",".r8lt3v0:hover{background-color:var(--colorNeutralBackground1Hover);color:var(--colorNeutralForeground2Hover);}",".r8lt3v0:hover .fui-Icon-filled{display:inline;}",".r8lt3v0:hover .fui-Icon-regular{display:none;}",".r8lt3v0:hover .fui-MenuItem__icon{color:var(--colorNeutralForeground2BrandSelected);}",".r8lt3v0:hover .fui-MenuItem__subText{color:var(--colorNeutralForeground3Hover);}",".r8lt3v0:hover:active{background-color:var(--colorNeutralBackground1Pressed);color:var(--colorNeutralForeground2Pressed);}",".r8lt3v0:hover:active .fui-MenuItem__subText{color:var(--colorNeutralForeground3Pressed);}",".r8lt3v0:focus{outline-style:none;}",".r8lt3v0:focus-visible{outline-style:none;}",".r8lt3v0[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}",'.r8lt3v0[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}'],s:['@media (forced-colors: active){.rfoezjv:hover{background-color:Canvas;border-color:Highlight;color:Highlight;}.rfoezjv:focus{outline-style:none;}.rfoezjv:focus-visible{outline-style:none;}.rfoezjv[data-fui-focus-visible]{border-top-color:transparent;border-right-color:transparent;border-bottom-color:transparent;border-left-color:transparent;}@media (forced-colors: active){.rfoezjv[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}.rfoezjv[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid Highlight;border-radius:var(--borderRadiusMedium);top:calc(2px * -1);right:calc(2px * -1);bottom:calc(2px * -1);left:calc(2px * -1);}}',"@media (forced-colors: active){.rfoezjv[data-fui-focus-visible]::after{border-top-color:Highlight;border-right-color:Highlight;border-bottom-color:Highlight;border-left-color:Highlight;}}",'@media (forced-colors: active){.r8lt3v0:hover{background-color:Canvas;border-color:Highlight;color:Highlight;}.r8lt3v0:focus{outline-style:none;}.r8lt3v0:focus-visible{outline-style:none;}.r8lt3v0[data-fui-focus-visible]{border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}@media (forced-colors: active){.r8lt3v0[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}.r8lt3v0[data-fui-focus-visible]::after{content:"";position:absolute;pointer-events:none;z-index:1;border:2px solid Highlight;border-radius:var(--borderRadiusMedium);top:calc(2px * -1);left:calc(2px * -1);bottom:calc(2px * -1);right:calc(2px * -1);}}',"@media (forced-colors: active){.r8lt3v0[data-fui-focus-visible]::after{border-top-color:Highlight;border-left-color:Highlight;border-bottom-color:Highlight;border-right-color:Highlight;}}"]}),E=(0,k.y)("r1ls86vo","rpbc5dr",[".r1ls86vo{padding-left:2px;padding-right:2px;background-color:transparent;flex-grow:1;}",".rpbc5dr{padding-right:2px;padding-left:2px;background-color:transparent;flex-grow:1;}"]),B=(0,k.y)("r12mwwux","r1ewgu5j",[".r12mwwux{padding-left:2px;padding-right:2px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);color:var(--colorNeutralForeground3);}",".r12mwwux:hover{color:var(--colorNeutralForeground3Hover);}",".r12mwwux:focus{color:var(--colorNeutralForeground3Hover);}",".r1ewgu5j{padding-right:2px;padding-left:2px;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);color:var(--colorNeutralForeground3);}",".r1ewgu5j:hover{color:var(--colorNeutralForeground3Hover);}",".r1ewgu5j:focus{color:var(--colorNeutralForeground3Hover);}"]),A=(0,k.y)("ro9koqv",null,[".ro9koqv{width:20px;height:20px;font-size:20px;line-height:0;align-items:center;display:inline-flex;justify-content:center;flex-shrink:0;}"]),R=(0,k.y)("r9c34qo",null,[".r9c34qo{width:20px;height:20px;font-size:20px;line-height:0;align-items:center;display:inline-flex;justify-content:center;}"]),M=(0,k.y)("rk2ppru",null,[".rk2ppru{font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase100);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase100);color:var(--colorNeutralForeground3);}"]),D=(0,T.X)({checkmark:{B6of3ja:"fmnzpld"},splitItemMain:{Bh6795r:"fqerorx"},splitItemTrigger:{Btl43ni:["f1ozlkrg","f10ostut"],Beyfa6y:["f1deotkl","f1krrbdw"],uwmqm3:["f1cnd47f","fhxju0i"],Ftih45:"f1wl9k8s",Ccq8qp:"f1yn80uh",Baz25je:"f68mna0",cmx5o7:"f1p5zmk"},disabled:{sj55zd:"f1s2aq7o",Bi91k9c:"fvgxktp",Jwef8y:"f1ijtazh",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bg7n49j:"f1q1x1ba",B2d53fq:"fcvwxyo",iro3zm:"f1to34ca",t0hwav:"ft33916",Bbusuzp:"f1dcs8yz",ze5xyy:"f1kc2mi9",Bqrx1nm:"fkavljg",Bctn1xl:"fk56vqo",h5esng:"ff3wi9b",Bh6z0a4:"f1ikwg0d",Bh953qp:"f10l1t5h"}},{d:[".fmnzpld{margin-top:2px;}",".fqerorx{flex-grow:1;}",".f1ozlkrg{border-top-left-radius:0;}",".f10ostut{border-top-right-radius:0;}",".f1deotkl{border-bottom-left-radius:0;}",".f1krrbdw{border-bottom-right-radius:0;}",".f1cnd47f{padding-left:0;}",".fhxju0i{padding-right:0;}",'.f1wl9k8s::before{content:"";}',".f1yn80uh::before{width:var(--strokeWidthThin);}",".f68mna0::before{height:24px;}",".f1p5zmk::before{background-color:var(--colorNeutralStroke1);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}"],h:[".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".f1ijtazh:hover{background-color:var(--colorNeutralBackground1);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1q1x1ba:hover .fui-MenuItem__icon{color:var(--colorNeutralForegroundDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f1to34ca:hover:active{background-color:var(--colorNeutralBackground1);}"],f:[".ft33916:focus{color:var(--colorNeutralForegroundDisabled);}"],m:[["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkavljg:hover{background-color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fk56vqo:hover .fui-MenuItem__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff3wi9b:hover .fui-MenuItem__icon{background-color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ikwg0d:focus{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f10l1t5h:focus{background-color:Canvas;}}",{m:"(forced-colors: active)"}]]}),P=(0,T.X)({content:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62"},secondaryContent:{qb2dma:"f7nlbp4"},submenuIndicator:{qb2dma:"f7nlbp4"}},{d:[".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".f7nlbp4{align-self:center;}"]});var F=o(34877);const O=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,d.T)(),h=(0,f.tv)((e=>e.persistOnItemClick)),{as:g="div",disabled:C=!1,hasSubmenu:S=o,persistOnClick:k=h}=e,{hasIcons:T,hasCheckmarks:x}=(e=>{const{hasSubmenu:t}=e,o=(0,p.f_)((e=>e.hasIcons)),i=(0,p.f_)((e=>e.hasCheckmarks)),n=(0,b.fC)()&&t;return{hasIcons:o&&!n,hasCheckmarks:i&&!n}})({hasSubmenu:S}),_=(0,f.tv)((e=>e.setOpen));(e=>{const{hasSubmenu:t,multiline:o}=e,i=(0,b.fC)()&&t,{setMultiline:n}=(0,b.GS)();(0,l.E)((()=>{i||n(o)}),[n,o,i])})({multiline:!!e.subText,hasSubmenu:S});const{dir:I}=(0,c.Y)(),E=i.useRef(null),B=i.useRef(!1),A={hasSubmenu:S,disabled:C,persistOnClick:k,components:{root:"div",icon:"span",checkmark:"span",submenuIndicator:"span",content:"span",secondaryContent:"span",subText:"span"},root:n.Gk((0,r.g)(g,(0,m.F)(g,{role:"menuitem",...e,disabled:!1,disabledFocusable:C,ref:(0,s.a)(t,E),onKeyDown:(0,a.D)((t=>{var o;null===(o=e.onKeyDown)||void 0===o||o.call(e,t),t.isDefaultPrevented()||t.key!==v.$xS&&t.key!==v.xyI||(B.current=!0)})),onMouseMove:(0,a.D)((t=>{var o,i;t.currentTarget.ownerDocument.activeElement!==t.currentTarget&&(null===(i=E.current)||void 0===i||i.focus()),null===(o=e.onMouseMove)||void 0===o||o.call(e,t)})),onClick:(0,a.D)((t=>{var o;S||k||(_(t,{open:!1,keyboard:B.current,bubble:!0,type:"menuItemClick",event:t}),B.current=!1),null===(o=e.onClick)||void 0===o||o.call(e,t)}))})),{elementType:"div"}),icon:n.lq(e.icon,{renderByDefault:T,elementType:"span"}),checkmark:n.lq(e.checkmark,{renderByDefault:x,elementType:"span"}),submenuIndicator:n.lq(e.submenuIndicator,{renderByDefault:S,defaultProps:{children:"ltr"===I?i.createElement(y,null):i.createElement(w,null)},elementType:"span"}),content:n.lq(e.content,{renderByDefault:!!e.children,defaultProps:{children:e.children},elementType:"span"}),secondaryContent:n.lq(e.secondaryContent,{elementType:"span"}),subText:n.lq(e.subText,{elementType:"span"})};return(0,u.t)(A,E),A})(e,t);return(e=>{const t=D(),o=I(),i=E(),n=B(),r=A(),s=R(),a=P(),l=M(),c=!!e.subText;e.root.className=(0,x.z)("fui-MenuItem",o,e.disabled&&t.disabled,e.root.className),e.content&&(e.content.className=(0,x.z)("fui-MenuItem__content",i,e.content.className,c&&a.content)),e.checkmark&&(e.checkmark.className=(0,x.z)("fui-MenuItem__checkmark",t.checkmark,e.checkmark.className)),e.secondaryContent&&(e.secondaryContent.className=(0,x.z)("fui-MenuItem__secondaryContent",!e.disabled&&n,e.secondaryContent.className,c&&a.secondaryContent)),e.icon&&(e.icon.className=(0,x.z)("fui-MenuItem__icon",r,e.icon.className)),e.submenuIndicator&&(e.submenuIndicator.className=(0,x.z)("fui-MenuItem__submenuIndicator",s,e.submenuIndicator.className,c&&a.submenuIndicator)),e.subText&&(e.subText.className=(0,x.z)("fui-MenuItem__subText",e.subText.className,l)),(0,_.Y)(e)})(o),(0,F.$e)("useMenuItemStyles_unstable")(o),(e=>((0,S.C)(e),(0,C.FD)(e.root,{children:[e.checkmark&&(0,C.Y)(e.checkmark,{}),e.icon&&(0,C.Y)(e.icon,{}),e.content&&(0,C.FD)(e.content,{children:[e.content.children,e.subText&&(0,C.Y)(e.subText,{})]}),e.secondaryContent&&(0,C.Y)(e.secondaryContent,{}),e.submenuIndicator&&(0,C.Y)(e.submenuIndicator,{})]})))(o)}));O.displayName="MenuItem"},56380:(e,t,o)=>{"use strict";if(o.d(t,{t:()=>n}),o(95734),3023==o.j)var i=o(18729);const n=(e,t)=>{const o=(0,i.f_)((e=>e.setFocusByFirstCharacter)),{onKeyDown:n}=e.root;return e.root.onKeyDown=e=>{var i;null==n||n(e),(null===(i=e.key)||void 0===i?void 0:i.length)>1||t.current&&(null==o||o(e,t.current))},e}},87503:(e,t,o)=>{"use strict";o.d(t,{c:()=>S});var i=o(95734),n=o(36049),r=o(32726),s=o(36216),a=o(48701),l=o(38523),c=o(43730),u=o(21257),d=o(58276),h=o(98721),g=o(92687),p=o(76257);var f=o(60839),m=o(18861),v=o(18729),b=o(27760),y=o(63649);const w=(0,b.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",i8kkvl:0,Belr9w4:0,rmohyg:"f1t6b6ee"},hasMenuContext:{Bqenvij:"f1l02sjl"}},{d:[".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",[".f1t6b6ee{gap:2px;}",{p:-1}],".f1l02sjl{height:100%;}"]});var C=o(34877);const S=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{findAllFocusable:o}=(0,c.r)(),{targetDocument:f}=(0,h.Y)(),m={checkedValues:(0,p.tv)((e=>e.checkedValues)),onCheckedValueChange:(0,p.tv)((e=>e.onCheckedValueChange)),triggerId:(0,p.tv)((e=>e.triggerId)),hasIcons:(0,p.tv)((e=>e.hasIcons)),hasCheckmarks:(0,p.tv)((e=>e.hasCheckmarks))},v=(0,g.V)(p.xu),b=(0,u.i)({circular:!0});((e,t,o)=>{let i=!1;for(const o in t)e[o]&&(i=!0);return o&&i})(e,m,v)&&console.warn("You are using both MenuList and Menu props, we recommend you to use Menu props when available");const y=i.useRef(null);i.useEffect((()=>{const e=y.current;if(v&&f&&e){const t=t=>{const o=t.detail.next;o&&e.contains(f.activeElement)&&!e.contains(o)&&t.preventDefault()};return f.addEventListener(d.GD,t),()=>{f.removeEventListener(d.GD,t)}}}),[y,f,v]);const w=i.useCallback(((e,t)=>{const i=["menuitem","menuitemcheckbox","menuitemradio"];if(!y.current)return;const n=o(y.current,(e=>e.hasAttribute("role")&&-1!==i.indexOf(e.getAttribute("role"))));let r=n.indexOf(t)+1;r===n.length&&(r=0);const s=n.map((e=>{var t;return null===(t=e.textContent)||void 0===t?void 0:t.charAt(0).toLowerCase()})),a=e.key.toLowerCase(),l=(e,t)=>{for(let t=e;t<s.length;t++)if(a===s[t])return t;return-1};let c=l(r);-1===c&&(c=l(0)),c>-1&&n[c].focus()}),[o]);var C;const[S,k]=(0,n.i)({state:null!==(C=e.checkedValues)&&void 0!==C?C:v?m.checkedValues:void 0,defaultState:e.defaultCheckedValues,initialState:{}});var T;const x=null!==(T=e.onCheckedValueChange)&&void 0!==T?T:v?m.onCheckedValueChange:void 0,_=(0,r.D)(((e,t,o,i)=>{const n=[...(null==S?void 0:S[t])||[]];i?n.splice(n.indexOf(o),1):n.push(o),null==x||x(e,{name:t,checkedItems:n}),k((e=>({...e,[t]:n})))})),I=(0,r.D)(((e,t,o)=>{const i=[o];k((e=>({...e,[t]:i}))),null==x||x(e,{name:t,checkedItems:i})}));return{components:{root:"div"},root:s.Gk((0,a.g)("div",{ref:(0,l.a)(t,y),role:"menu","aria-labelledby":m.triggerId,...b,...e}),{elementType:"div"}),hasIcons:m.hasIcons||!1,hasCheckmarks:m.hasCheckmarks||!1,checkedValues:S,hasMenuContext:v,setFocusByFirstCharacter:w,selectRadio:I,toggleCheckbox:_}})(e,t),b=function(e){const{checkedValues:t,hasCheckmarks:o,hasIcons:i,selectRadio:n,setFocusByFirstCharacter:r,toggleCheckbox:s}=e;return{menuList:{checkedValues:t,hasCheckmarks:o,hasIcons:i,selectRadio:n,setFocusByFirstCharacter:r,toggleCheckbox:s}}}(o);return(e=>{const t=w();e.root.className=(0,y.z)("fui-MenuList",t.root,e.hasMenuContext&&t.hasMenuContext,e.root.className)})(o),(0,C.$e)("useMenuListStyles_unstable")(o),((e,t)=>((0,m.C)(e),(0,f.Y)(v.j4,{value:t.menuList,children:(0,f.Y)(e.root,{})})))(o,b)}));S.displayName="MenuList"},35818:(e,t,o)=>{"use strict";o.d(t,{b:()=>S});var i=o(95734),n=o(35985),r=o(4754),s=o(36216),a=o(48701),l=o(38523),c=o(32726),u=o(76257),d=o(14699),h=o(98721),g=o(37938),p=o(67265),f=o(27760),m=o(63649);const v=(0,f.X)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",De3pzq:"fxugw4r",sj55zd:"f19n0e5",B7ck84d:"f1ewtqcl",Bf4jedk:"fl8fusi",B2u0y6b:"f1kaai3v",B68tc82:"f1p9o1ba",a9b677:"f1ahpp82",E5pizo:"f1hg901r",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fd3pd8h",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B93otf3:"f1hdglry",vin17d:"fo1kyvf",Ezkn3b:"fetxo7e",nyiy2g:"f8x1vz1",swvrvq:"f8g0anz",Bkovbt3:"fezwn9i",hgjdhn:"fz5efge",fsy9dk:"f1ydixl4",B3ogreh:"f8dgqj5",jv49x5:"fnyfnr8",Bk7o48c:"fgw77r4",Bv12yb3:"ftje0s4",vcguit:"fxes1gr",z0t1cu:"fi19xcv",Bks05zx:"f1mzajhk",yckwsp:"fgez7cy",Bvtglag:"fjp4h9y"}},{d:[[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f1ewtqcl{box-sizing:border-box;}",".fl8fusi{min-width:138px;}",".f1kaai3v{max-width:300px;}",".f1p9o1ba{overflow-x:hidden;}",".f1ahpp82{width:max-content;}",".f1hg901r{box-shadow:var(--shadow16);}",[".fd3pd8h{padding:4px;}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f1hdglry{animation-composition:replace,accumulate;}",".fo1kyvf{animation-duration:var(--durationSlower);}",".fetxo7e{animation-timing-function:var(--curveDecelerateMid);}",".f8x1vz1{--fui-positioning-slide-distance-x:0px;}",".f8g0anz{--fui-positioning-slide-distance-y:10px;}",".fezwn9i[data-popper-placement^=right]{--fui-positioning-slide-distance-x:-10px;}",".fz5efge[data-popper-placement^=right]{--fui-positioning-slide-distance-y:0px;}",".f1ydixl4[data-popper-placement^=bottom]{--fui-positioning-slide-distance-x:0px;}",".f8dgqj5[data-popper-placement^=bottom]{--fui-positioning-slide-distance-y:-10px;}",".fnyfnr8[data-popper-placement^=left]{--fui-positioning-slide-distance-x:10px;}",".fgw77r4[data-popper-placement^=left]{--fui-positioning-slide-distance-y:0px;}",".ftje0s4{animation-name:f5j8bii,f79suad;}"],k:["@keyframes f5j8bii{from{opacity:0;}to{opacity:1;}}","@keyframes f79suad{from{transform:translate(var(--fui-positioning-slide-distance-x), var(--fui-positioning-slide-distance-y));}}"],m:[["@media (prefers-reduced-motion){.fxes1gr[data-popper-placement]{animation-composition:replace;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.fi19xcv[data-popper-placement]{animation-duration:1ms;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.f1mzajhk[data-popper-placement]{animation-name:f5j8bii;}}",{m:"(prefers-reduced-motion)"}]],t:["@supports not (animation-composition: accumulate){.fgez7cy[data-popper-placement]{animation-composition:replace;}}","@supports not (animation-composition: accumulate){.fjp4h9y[data-popper-placement]{animation-name:f5j8bii;}}"]});var b=o(60839),y=o(18861),w=o(88289),C=o(34877);const S=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,u.tv)((e=>e.menuPopoverRef)),f=(0,u.tv)((e=>e.setOpen)),m=(0,u.tv)((e=>e.open)),v=(0,u.tv)((e=>e.openOnHover)),b=(0,u.tv)((e=>e.triggerRef)),y=(0,g.R)(),w=i.useRef(!0),C=(0,p.P)(),[S,k]=(0,r.Z)(),{dir:T}=(0,h.Y)(),x="ltr"===T?n.nkM:n.Qpb,_=i.useCallback((e=>{e&&e.addEventListener("mouseover",(e=>{w.current&&(w.current=!1,(0,d.uD)(o.current,e),S((()=>w.current=!0),250))}))}),[o,S]);var I;i.useEffect((()=>{}),[k]);const E=null!==(I=(0,u.tv)((e=>e.inline)))&&void 0!==I&&I,B=(0,u.tv)((e=>e.mountNode)),A=s.Gk((0,a.g)("div",{role:"presentation",...C,...e,ref:(0,l.a)(t,o,_)}),{elementType:"div"}),{onMouseEnter:R,onKeyDown:M}=A;return A.onMouseEnter=(0,c.D)((e=>{(v||y)&&f(e,{open:!0,keyboard:!1,type:"menuPopoverMouseEnter",event:e}),null==R||R(e)})),A.onKeyDown=(0,c.D)((e=>{const t=e.key;var i,r;(t===n.uf9||y&&t===x)&&m&&(null===(i=o.current)||void 0===i?void 0:i.contains(e.target))&&!e.isDefaultPrevented()&&(f(e,{open:!1,keyboard:!0,type:"menuPopoverKeyDown",event:e}),e.preventDefault()),t===n.ozo&&(f(e,{open:!1,keyboard:!0,type:"menuPopoverKeyDown",event:e}),y||null===(r=b.current)||void 0===r||r.focus()),null==M||M(e)})),{inline:E,mountNode:B,components:{root:"div"},root:A}})(e,t);return(e=>{const t=v();e.root.className=(0,m.z)("fui-MenuPopover",t.root,e.root.className)})(o),(0,C.$e)("useMenuPopoverStyles_unstable")(o),(e=>((0,y.C)(e),e.inline?(0,b.Y)(e.root,{}):(0,b.Y)(w.Z,{mountNode:e.mountNode,children:(0,b.Y)(e.root,{})})))(o)}));S.displayName="MenuPopover"},25161:(e,t,o)=>{"use strict";o.d(t,{c:()=>b});var i=o(95734),n=o(76257),r=o(37938),s=o(43730),a=o(98721),l=o(35985),c=o(74396),u=o(38523),d=o(32726),h=o(29875),g=o(77442),p=o(94756),f=o(36307);const m=e=>{const t=e=>e.hasAttribute("disabled")||e.hasAttribute("aria-disabled")&&"true"===e.getAttribute("aria-disabled");return!(!(0,p.s)(e.target)||!t(e.target))||(0,p.s)(e.currentTarget)&&t(e.currentTarget)};var v=o(28095);const b=e=>{const t=(e=>{const{children:t,disableButtonEnhancement:o=!1}=e,p=(0,n.tv)((e=>e.triggerRef)),v=(0,n.tv)((e=>e.menuPopoverRef)),b=(0,n.tv)((e=>e.setOpen)),y=(0,n.tv)((e=>e.open)),w=(0,n.tv)((e=>e.triggerId)),C=(0,n.tv)((e=>e.openOnHover)),S=(0,n.tv)((e=>e.openOnContext)),k=(0,r.R)(),{findFirstFocusable:T}=(0,s.r)(),x=i.useCallback((()=>{const e=T(v.current);null==e||e.focus()}),[T,v]),_=i.useRef(!1),I=i.useRef(!1),{dir:E}=(0,a.Y)(),B="ltr"===E?l.Qpb:l.nkM,A=(0,c.h)(t),R={id:w,...null==A?void 0:A.props,ref:(0,u.a)(p,null==A?void 0:A.ref),onMouseEnter:(0,d.D)((0,h.p)(null==A?void 0:A.props.onMouseEnter,(e=>{m(e)||C&&I.current&&b(e,{open:!0,keyboard:!1,type:"menuTriggerMouseEnter",event:e})}))),onMouseLeave:(0,d.D)((0,h.p)(null==A?void 0:A.props.onMouseLeave,(e=>{m(e)||C&&b(e,{open:!1,keyboard:!1,type:"menuTriggerMouseLeave",event:e})}))),onContextMenu:(0,d.D)((0,h.p)(null==A?void 0:A.props.onContextMenu,(e=>{m(e)||e.isDefaultPrevented()||S&&(e.preventDefault(),b(e,{open:!0,keyboard:!1,type:"menuTriggerContextMenu",event:e}))}))),onMouseMove:(0,d.D)((0,h.p)(null==A?void 0:A.props.onMouseMove,(e=>{m(e)||C&&!I.current&&(b(e,{open:!0,keyboard:!1,type:"menuTriggerMouseMove",event:e}),I.current=!0)})))},M={"aria-haspopup":"menu","aria-expanded":y||k?y:void 0,...R,onClick:(0,d.D)((0,h.p)(null==A?void 0:A.props.onClick,(e=>{m(e)||S||(b(e,{open:!y,keyboard:_.current,type:"menuTriggerClick",event:e}),_.current=!1)}))),onKeyDown:(0,d.D)((0,h.p)(null==A?void 0:A.props.onKeyDown,(e=>{if(m(e))return;const t=e.key;!S&&(k&&t===B||!k&&t===l.yd$)&&b(e,{open:!0,keyboard:!0,type:"menuTriggerKeyDown",event:e}),t!==l.uf9||k||b(e,{open:!1,keyboard:!0,type:"menuTriggerKeyDown",event:e}),y&&t===B&&k&&x()})))},D=(0,f.F)("button"===(null==A?void 0:A.type)||"a"===(null==A?void 0:A.type)?A.type:"div",M);return{isSubmenu:k,children:(0,g.L)(t,S?R:o?M:D)}})(e);return(e=>i.createElement(v._,{value:e.isSubmenu},e.children))(t)};b.displayName="MenuTrigger",b.isFluentTriggerComponent=!0},58099:(e,t,o)=>{"use strict";o.d(t,{W:()=>C});var i=o(95734),n=o(11307),r=o(65855),s=o(87789),a=o(50344),l=o(36049),c=o(32726),u=o(4754),d=o(2527),h=o(12500),g=o(61394),p=o(86642),f=o(98721),m=o(43730),v=o(76257),b=o(14699),y=o(37938);const w=["after","after-bottom","before-top","before","before-bottom","above"],C=e=>{const t=(e=>{const t=(0,y.R)(),{hoverDelay:o=500,inline:C=!1,hasCheckmarks:S=!1,hasIcons:k=!1,closeOnScroll:T=!1,openOnContext:x=!1,persistOnItemClick:_=!1,openOnHover:I=t,defaultCheckedValues:E,mountNode:B=null}=e,A=(0,a.Bi)("menu"),[R,M]=(0,n.N)(),D={position:t?"after":"below",align:t?"top":"start",target:e.openOnContext?R:void 0,fallbackPositions:t?w:void 0,...(0,r.P)(e.positioning)},P=i.Children.toArray(e.children);let F,O;2===P.length?(F=P[0],O=P[1]):1===P.length&&(O=P[0]);const{targetRef:N,containerRef:q}=(0,s.T)(D),[j,L]=(e=>{const{targetDocument:t}=(0,f.Y)(),o=(0,v.tv)((e=>e.setOpen)),n=(0,c.D)(((t,o)=>{var i;return null===(i=e.onOpenChange)||void 0===i?void 0:i.call(e,t,o)})),r=i.useRef(!1),[s,a]=(0,l.i)({state:e.open,defaultState:e.defaultOpen,initialState:!1}),y=(0,c.D)(((t,i)=>{const r=t instanceof CustomEvent&&t.type===b.C4?t.detail.nativeEvent:t;null==n||n(r,{...i}),i.open&&"contextmenu"===t.type&&e.setContextTarget(t),i.open||e.setContextTarget(void 0),i.bubble&&o(t,{...i}),a(i.open)})),[w,C]=(0,u.Z)(),S=(0,c.D)(((t,o)=>{var i;C(),t instanceof Event||!t.persist||t.persist(),"mouseleave"===t.type||"mouseenter"===t.type||"mousemove"===t.type||t.type===b.C4?((null===(i=e.triggerRef.current)||void 0===i?void 0:i.contains(t.target))&&(r.current="mouseenter"===t.type||"mousemove"===t.type),w((()=>y(t,o)),e.hoverDelay)):y(t,o)}));(0,d.W)({contains:h.s,disabled:!s,element:t,refs:[e.menuPopoverRef,!e.openOnContext&&e.triggerRef].filter(Boolean),callback:e=>S(e,{open:!1,type:"clickOutside",event:e})});const k=e.openOnContext||e.closeOnScroll;(0,g.z)({contains:h.s,element:t,callback:e=>S(e,{open:!1,type:"scrollOutside",event:e}),refs:[e.menuPopoverRef,!e.openOnContext&&e.triggerRef].filter(Boolean),disabled:!s||!k}),(0,b.Ji)({element:t,callback:e=>{r.current||S(e,{open:!1,type:"menuMouseEnter",event:e})},disabled:!s,refs:[e.menuPopoverRef]});const{findFirstFocusable:T}=(0,m.r)(),x=i.useCallback((()=>{const t=T(e.menuPopoverRef.current);null==t||t.focus()}),[T,e.menuPopoverRef]),_=(0,p.t)();return i.useEffect((()=>{var o;s?x():_||(null==t?void 0:t.activeElement)===(null==t?void 0:t.body)&&(null===(o=e.triggerRef.current)||void 0===o||o.focus())}),[e.triggerRef,e.isSubmenu,s,x,t,e.menuPopoverRef]),[s,S]})({hoverDelay:o,isSubmenu:t,setContextTarget:M,closeOnScroll:T,menuPopoverRef:q,triggerRef:N,open:e.open,defaultOpen:e.defaultOpen,onOpenChange:e.onOpenChange,openOnContext:x}),[z,H]=(e=>{const[t,o]=(0,l.i)({state:e.checkedValues,defaultState:e.defaultCheckedValues,initialState:{}});return[t,(0,c.D)(((t,{name:i,checkedItems:n})=>{var r;null===(r=e.onCheckedValueChange)||void 0===r||r.call(e,t,{name:i,checkedItems:n}),o((e=>({...e,[i]:n})))}))]})({checkedValues:e.checkedValues,defaultCheckedValues:E,onCheckedValueChange:e.onCheckedValueChange});return{inline:C,hoverDelay:o,triggerId:A,isSubmenu:t,openOnHover:I,contextTarget:R,setContextTarget:M,hasCheckmarks:S,hasIcons:k,closeOnScroll:T,menuTrigger:F,menuPopover:O,mountNode:B,triggerRef:N,menuPopoverRef:q,components:{},openOnContext:x,open:j,setOpen:L,checkedValues:z,onCheckedValueChange:H,persistOnItemClick:_}})(e),o=function(e){const{checkedValues:t,hasCheckmarks:o,hasIcons:i,inline:n,isSubmenu:r,menuPopoverRef:s,mountNode:a,onCheckedValueChange:l,open:c,openOnContext:u,openOnHover:d,persistOnItemClick:h,setOpen:g,triggerId:p,triggerRef:f}=e;return{menu:{checkedValues:t,hasCheckmarks:o,hasIcons:i,inline:n,isSubmenu:r,menuPopoverRef:s,mountNode:a,onCheckedValueChange:l,open:c,openOnContext:u,openOnHover:d,persistOnItemClick:h,setOpen:g,triggerId:p,triggerRef:f}}}(t);return((e,t)=>i.createElement(v.BV,{value:t.menu},e.menuTrigger,e.open&&e.menuPopover))(t,o)};C.displayName="Menu"},76257:(e,t,o)=>{"use strict";o.d(t,{BV:()=>a,tv:()=>l,xu:()=>r}),o(95734);var i=o(10932);if(3023==o.j)var n=o(51204);const r=(0,i.q)(void 0),s={open:!1,setOpen:()=>!1,checkedValues:{},onCheckedValueChange:()=>null,isSubmenu:!1,triggerRef:{current:null},menuPopoverRef:{current:null},mountNode:null,triggerId:"",openOnContext:!1,openOnHover:!1,hasIcons:!1,hasCheckmarks:!1,inline:!1,persistOnItemClick:!1},a=r.Provider,l=e=>(0,n.i)(r,((t=s)=>e(t)))},18729:(e,t,o)=>{"use strict";o.d(t,{VU:()=>r,f_:()=>l,j4:()=>a}),o(95734);var i=o(10932);if(3023==o.j)var n=o(51204);const r=(0,i.q)(void 0),s={checkedValues:{},setFocusByFirstCharacter:()=>null,toggleCheckbox:()=>null,selectRadio:()=>null,hasIcons:!1,hasCheckmarks:!1},a=r.Provider,l=e=>(0,n.i)(r,((t=s)=>e(t)))},20796:(e,t,o)=>{"use strict";o.d(t,{GS:()=>s,fC:()=>a});var i=o(95734);const n=i.createContext(void 0),r={setMultiline:()=>null},s=(n.Provider,()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r}),a=()=>s()!==r},28095:(e,t,o)=>{"use strict";o.d(t,{T:()=>s,_:()=>r});var i=o(95734);const n=i.createContext(void 0),r=n.Provider,s=()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e&&e}},429:(e,t,o)=>{"use strict";o.d(t,{Y:()=>s});var i=o(27760);if(3023==o.j)var n=o(63649);const r=(0,i.X)({root:{a9b677:"fjw5fx7",Bqenvij:"fd461yt",Bcdw1i0:"fd7fpy0",Bnnss6s:"fi64zpg"},rootChecked:{Bcdw1i0:"f1022m68",Bnnss6s:"fi64zpg"}},{d:[".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".fd7fpy0{visibility:hidden;}",".fi64zpg{flex-shrink:0;}",".f1022m68{visibility:visible;}"]}),s=e=>{const t=r();e.checkmark&&(e.checkmark.className=(0,n.z)(t.root,e.checked&&t.rootChecked,e.checkmark.className))}},37938:(e,t,o)=>{"use strict";if(o.d(t,{R:()=>s}),3023==o.j)var i=o(92687);if(3023==o.j)var n=o(76257);if(3023==o.j)var r=o(18729);function s(){const e=(0,n.tv)((e=>e.isSubmenu)),t=(0,i.V)(r.VU);return e||t}},14699:(e,t,o)=>{"use strict";o.d(t,{C4:()=>s,Ji:()=>a,uD:()=>l});var i=o(95734);if(3023==o.j)var n=o(32726);if(3023==o.j)var r=o(12500);const s="fuimenuenter",a=e=>{const{refs:t,callback:o,element:a,disabled:l}=e,c=(0,n.D)((e=>{const i=t[0],n=e.target;var s;!(0,r.s)(null!==(s=i.current)&&void 0!==s?s:null,n)&&!l&&o(e)}));i.useEffect((()=>{if(null!=a)return l||a.addEventListener(s,c),()=>{a.removeEventListener(s,c)}}),[c,a,l])},l=(e,t)=>{e.dispatchEvent(new CustomEvent(s,{bubbles:!0,detail:{nativeEvent:t}}))}},43050:(e,t,o)=>{"use strict";o.d(t,{I:()=>i});const i=(0,o(27760).X)({overflowMenu:{Brvla84:"fyfkpbf"},overflowingItems:{zb22lx:"f10570jf"}},{d:[".fyfkpbf [data-overflow-menu]{flex-shrink:0;}",".f10570jf [data-overflowing]{display:none;}"]})},52371:(e,t,o)=>{"use strict";o.d(t,{K7:()=>n,My:()=>s,Od:()=>r,Wg:()=>i});const i="data-overflowing",n="data-overflow-item",r="data-overflow-menu",s="data-overflow-divider"},93743:(e,t,o)=>{"use strict";o.d(t,{J:()=>a,a:()=>r});var i=o(10932);if(3023==o.j)var n=o(51204);const r=(0,i.q)(void 0),s={itemVisibility:{},groupVisibility:{},hasOverflow:!1,registerItem:()=>()=>null,updateOverflow:()=>null,registerOverflowMenu:()=>()=>null,registerDivider:()=>()=>null},a=e=>(0,n.i)(r,((t=s)=>e(t)))},53660:(e,t,o)=>{"use strict";o.d(t,{K:()=>h,f:()=>d});var i=o(95734);if(3023==o.j)var n=o(46178);if(3023==o.j)var r=o(32726);if(3023==o.j)var s=o(86642);if(3023==o.j)var a=o(20101);if(3023==o.j)var l=o(93851);if(3023==o.j)var c=o(52371);const u=()=>null,d=(e,t)=>{const{overflowAxis:o="horizontal",overflowDirection:d="end",padding:h=10,minimumVisible:g=0,onUpdateItemVisibility:p=u}=t,f=(0,r.D)(e),m=i.useMemo((()=>({overflowAxis:o,overflowDirection:d,padding:h,minimumVisible:g,onUpdateItemVisibility:p,onUpdateOverflow:f})),[g,p,o,d,h,f]),v=(0,s.t)(),b=i.useRef(null),[y,w]=i.useState((()=>(0,a.S)()?(0,n.A)():null));return(0,l.E)((()=>{v&&b.current&&(null==y||y.observe(b.current,m))}),[v,y,m]),(0,l.E)((()=>{if(!b.current||!(0,a.S)()||v)return;const e=(0,n.A)();e.observe(b.current,m),w(e)}),[m]),i.useEffect((()=>()=>{null==y||y.disconnect()}),[y]),{registerItem:i.useCallback((e=>(null==y||y.addItem(e),e.element.setAttribute(c.K7,""),()=>{e.element.removeAttribute(c.Wg),e.element.removeAttribute(c.K7),null==y||y.removeItem(e.id)})),[y]),registerDivider:i.useCallback((e=>{const t=e.element;return null==y||y.addDivider(e),t.setAttribute(c.My,""),()=>{e.groupId&&(null==y||y.removeDivider(e.groupId)),t.removeAttribute(c.My)}}),[y]),registerOverflowMenu:i.useCallback((e=>(null==y||y.addOverflowMenu(e),e.setAttribute(c.Od,""),()=>{null==y||y.removeOverflowMenu(),e.removeAttribute(c.Od)})),[y]),updateOverflow:i.useCallback((()=>{null==y||y.update()}),[y]),containerRef:b}},h=({item:e,visible:t})=>{t?e.element.removeAttribute(c.Wg):e.element.setAttribute(c.Wg,"")}},57964:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>n}),3023==o.j)var i=o(93743);const n=()=>(0,i.J)((e=>Object.entries(e.itemVisibility).reduce(((e,[t,o])=>(o||e++,e)),0)))},44071:(e,t,o)=>{"use strict";o.d(t,{Ls:()=>a,aT:()=>r});var i=o(27760);if(3023==o.j)var n=o(63649);const r={small:6,medium:8,large:8},s=(0,i.X)({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B93otf3:"f1hdglry",vin17d:"fo1kyvf",Ezkn3b:"fetxo7e",nyiy2g:"f8x1vz1",swvrvq:"f8g0anz",Bkovbt3:"fezwn9i",hgjdhn:"fz5efge",fsy9dk:"f1ydixl4",B3ogreh:"f8dgqj5",jv49x5:"fnyfnr8",Bk7o48c:"fgw77r4",Bv12yb3:"ftje0s4",vcguit:"fxes1gr",z0t1cu:"fi19xcv",Bks05zx:"f1mzajhk",yckwsp:"fgez7cy",Bvtglag:"fjp4h9y",Bhu2qc9:"fymb6k8"},inline:{Bj3rh1h:"f19g0ac"},inverted:{De3pzq:"fg3r6xk",sj55zd:"fonrgv7"},brand:{De3pzq:"ffp7eso",sj55zd:"f1phragk"},smallPadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1sy4kr4"},mediumPadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4zyqsv"},largePadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fop8ug2"},smallArrow:{rhnwrx:"f1s3jn22",Bdy53xb:"fv40uqz"},mediumLargeArrow:{rhnwrx:"f1f72gjr",Bdy53xb:"f69yoe5"},arrow:{B7ck84d:"f1ewtqcl",qhf8xq:"f1euv43f",Bj3rh1h:"f1bsuimh",De3pzq:"f1u2r49w",B2eet1l:"fqhgnl",Beyfa6y:"f17bz04i",Bz10aip:"f36o3x3",Bqenvij:"fzofk8q",a9b677:"f1wbx1ie",Ftih45:"f1wl9k8s",Br0sdwz:"f1aocrix",cmx5o7:"f1ljr5q2",susq4k:0,Biibvgv:0,Bicfajf:0,qehafq:0,Brs5u8j:"f155f1qt",Ccq8qp:"f9mhzq7",Baz25je:"fr6rhvx",Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1kc0wz4",r59vdv:"fgq90dz",Bkw5xw4:"fq0y47f",hl6cv3:"f1pwrbz6",aea9ga:"f1hxxcvm",yayu3t:"fw8rgyo",Bhsv975:"f1wnzycx",rhl9o9:"f1730wal",B7gxrvb:"f1fy4ixr",B6q6orb:"fobkauc",B0lu1f8:"f16bqv1l"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f1hdglry{animation-composition:replace,accumulate;}",".fo1kyvf{animation-duration:var(--durationSlower);}",".fetxo7e{animation-timing-function:var(--curveDecelerateMid);}",".f8x1vz1{--fui-positioning-slide-distance-x:0px;}",".f8g0anz{--fui-positioning-slide-distance-y:10px;}",".fezwn9i[data-popper-placement^=right]{--fui-positioning-slide-distance-x:-10px;}",".fz5efge[data-popper-placement^=right]{--fui-positioning-slide-distance-y:0px;}",".f1ydixl4[data-popper-placement^=bottom]{--fui-positioning-slide-distance-x:0px;}",".f8dgqj5[data-popper-placement^=bottom]{--fui-positioning-slide-distance-y:-10px;}",".fnyfnr8[data-popper-placement^=left]{--fui-positioning-slide-distance-x:10px;}",".fgw77r4[data-popper-placement^=left]{--fui-positioning-slide-distance-y:0px;}",".ftje0s4{animation-name:f5j8bii,f79suad;}",".fymb6k8{filter:drop-shadow(0 0 2px var(--colorNeutralShadowAmbient)) drop-shadow(0 8px 16px var(--colorNeutralShadowKey));}",".f19g0ac{z-index:1;}",".fg3r6xk{background-color:var(--colorNeutralBackgroundStatic);}",".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",[".f1sy4kr4{padding:12px;}",{p:-1}],[".f4zyqsv{padding:16px;}",{p:-1}],[".fop8ug2{padding:20px;}",{p:-1}],".f1s3jn22{--fui-positioning-arrow-height:8.484px;}",".fv40uqz{--fui-positioning-arrow-offset:-4.242px;}",".f1f72gjr{--fui-positioning-arrow-height:11.312px;}",".f69yoe5{--fui-positioning-arrow-offset:-5.656px;}",".f1ewtqcl{box-sizing:border-box;}",".f1euv43f{position:absolute;}",".f1bsuimh{z-index:-1;}",".f1u2r49w{background-color:inherit;}",".fqhgnl{background-clip:content-box;}",".f17bz04i{border-bottom-left-radius:var(--borderRadiusSmall);}",".f36o3x3{transform:rotate(var(--fui-positioning-arrow-angle));}",".fzofk8q{height:var(--fui-positioning-arrow-height);}",".f1wbx1ie{width:var(--fui-positioning-arrow-height);}",'.f1wl9k8s::before{content:"";}',".f1aocrix::before{display:block;}",".f1ljr5q2::before{background-color:inherit;}",[".f155f1qt::before{margin:-1px;}",{p:-1}],".f9mhzq7::before{width:100%;}",".fr6rhvx::before{height:100%;}",[".f1kc0wz4::before{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fgq90dz::before{border-bottom-left-radius:var(--borderRadiusSmall);}",".fq0y47f::before{clip-path:polygon(0% 0%, 100% 100%, 0% 100%);}",'[data-popper-placement^="top"] .f1pwrbz6{bottom:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="top"] .f1hxxcvm{--fui-positioning-arrow-angle:-45deg;}','[data-popper-placement^="right"] .fw8rgyo{left:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="right"] .f1wnzycx{--fui-positioning-arrow-angle:45deg;}','[data-popper-placement^="bottom"] .f1730wal{top:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="bottom"] .f1fy4ixr{--fui-positioning-arrow-angle:135deg;}','[data-popper-placement^="left"] .fobkauc{right:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="left"] .f16bqv1l{--fui-positioning-arrow-angle:225deg;}'],k:["@keyframes f5j8bii{from{opacity:0;}to{opacity:1;}}","@keyframes f79suad{from{transform:translate(var(--fui-positioning-slide-distance-x), var(--fui-positioning-slide-distance-y));}}"],m:[["@media (prefers-reduced-motion){.fxes1gr[data-popper-placement]{animation-composition:replace;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.fi19xcv[data-popper-placement]{animation-duration:1ms;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.f1mzajhk[data-popper-placement]{animation-name:f5j8bii;}}",{m:"(prefers-reduced-motion)"}]],t:["@supports not (animation-composition: accumulate){.fgez7cy[data-popper-placement]{animation-composition:replace;}}","@supports not (animation-composition: accumulate){.fjp4h9y[data-popper-placement]{animation-name:f5j8bii;}}"]}),a=e=>{const t=s();return e.root.className=(0,n.z)("fui-PopoverSurface",t.root,e.inline&&t.inline,"small"===e.size&&t.smallPadding,"medium"===e.size&&t.mediumPadding,"large"===e.size&&t.largePadding,"inverted"===e.appearance&&t.inverted,"brand"===e.appearance&&t.brand,e.root.className),e.arrowClassName=(0,n.z)(t.arrow,"small"===e.size?t.smallArrow:t.mediumLargeArrow),e}},96398:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=4},81591:(e,t,o)=>{"use strict";o.d(t,{nt:()=>a,pO:()=>c});var i=o(44877),n=o(95734),r=o(85453),s=o(23292);const a=(e=>{const t=n.createContext({value:{current:void 0},version:{current:-1},listeners:[]});var o;return t.Provider=(o=t.Provider,e=>{const t=n.useRef(e.value),s=n.useRef(0),a=n.useRef();return a.current||(a.current={value:t,version:s,listeners:[]}),(0,i.E)((()=>{t.current=e.value,s.current+=1,(0,r.unstable_runWithPriority)(r.unstable_NormalPriority,(()=>{a.current.listeners.forEach((t=>{t([s.current,e.value])}))}))}),[e.value]),n.createElement(o,{value:a.current},e.children)}),delete t.Consumer,t})(),l={open:!1,setOpen:()=>null,toggleOpen:()=>null,triggerRef:{current:null},contentRef:{current:null},arrowRef:{current:null},openOnContext:!1,openOnHover:!1,size:"medium",trapFocus:!1,inline:!1},c=(a.Provider,e=>(0,s.i)(a,((t=l)=>e(t))))},67026:(e,t,o)=>{"use strict";o.d(t,{H:()=>p});var i=o(95734),n=o(36216),r=o(48701),s=o(38523),a=o(16055),l=o(67795),c=o(60839),u=o(18861),d=o(88289),h=o(49598),g=o(34877);const p=i.forwardRef(((e,t)=>{const o=((e,t)=>{const o=(0,l.pO)((e=>e.contentRef)),i=(0,l.pO)((e=>e.openOnHover)),c=(0,l.pO)((e=>e.setOpen)),u=(0,l.pO)((e=>e.mountNode)),d=(0,l.pO)((e=>e.arrowRef)),h=(0,l.pO)((e=>e.size)),g=(0,l.pO)((e=>e.withArrow)),p=(0,l.pO)((e=>e.appearance)),f=(0,l.pO)((e=>e.trapFocus)),m=(0,l.pO)((e=>e.inertTrapFocus)),v=(0,l.pO)((e=>e.inline)),{modalAttributes:b}=(0,a.y)({trapFocus:f,legacyTrapFocus:!m,alwaysFocusable:!f}),y={inline:v,appearance:p,withArrow:g,size:h,arrowRef:d,mountNode:u,components:{root:"div"},root:n.Gk((0,r.g)("div",{ref:(0,s.a)(t,o),role:f?"dialog":"group","aria-modal":!!f||void 0,...b,...e}),{elementType:"div"})},{onMouseEnter:w,onMouseLeave:C,onKeyDown:S}=y.root;return y.root.onMouseEnter=e=>{i&&c(e,!0),null==w||w(e)},y.root.onMouseLeave=e=>{i&&c(e,!1),null==C||C(e)},y.root.onKeyDown=e=>{var t;"Escape"===e.key&&(null===(t=o.current)||void 0===t?void 0:t.contains(e.target))&&(e.preventDefault(),c(e,!1)),null==S||S(e)},y})(e,t);return(0,h.Ls)(o),(0,g.$e)("usePopoverSurfaceStyles_unstable")(o),(e=>{(0,u.C)(e);const t=(0,c.FD)(e.root,{children:[e.withArrow&&(0,c.Y)("div",{ref:e.arrowRef,className:e.arrowClassName}),e.root.children]});return e.inline?t:(0,c.Y)(d.Z,{mountNode:e.mountNode,children:t})})(o)}));p.displayName="PopoverSurface"},49598:(e,t,o)=>{"use strict";o.d(t,{Ls:()=>a,aT:()=>r});var i=o(27760);if(3023==o.j)var n=o(63649);const r={small:6,medium:8,large:8},s=(0,i.X)({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B93otf3:"f1hdglry",vin17d:"fo1kyvf",Ezkn3b:"fetxo7e",nyiy2g:"f8x1vz1",swvrvq:"f8g0anz",Bkovbt3:"fezwn9i",hgjdhn:"fz5efge",fsy9dk:"f1ydixl4",B3ogreh:"f8dgqj5",jv49x5:"fnyfnr8",Bk7o48c:"fgw77r4",Bv12yb3:"ftje0s4",vcguit:"fxes1gr",z0t1cu:"fi19xcv",Bks05zx:"f1mzajhk",yckwsp:"fgez7cy",Bvtglag:"fjp4h9y",Bhu2qc9:"fymb6k8"},inline:{Bj3rh1h:"f19g0ac"},inverted:{De3pzq:"fg3r6xk",sj55zd:"fonrgv7"},brand:{De3pzq:"ffp7eso",sj55zd:"f1phragk"},smallPadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1sy4kr4"},mediumPadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4zyqsv"},largePadding:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fop8ug2"},smallArrow:{rhnwrx:"f1s3jn22",Bdy53xb:"fv40uqz"},mediumLargeArrow:{rhnwrx:"f1f72gjr",Bdy53xb:"f69yoe5"},arrow:{B7ck84d:"f1ewtqcl",qhf8xq:"f1euv43f",Bj3rh1h:"f1bsuimh",De3pzq:"f1u2r49w",B2eet1l:"fqhgnl",Beyfa6y:"f17bz04i",Bz10aip:"f36o3x3",Bqenvij:"fzofk8q",a9b677:"f1wbx1ie",Ftih45:"f1wl9k8s",Br0sdwz:"f1aocrix",cmx5o7:"f1ljr5q2",susq4k:0,Biibvgv:0,Bicfajf:0,qehafq:0,Brs5u8j:"f155f1qt",Ccq8qp:"f9mhzq7",Baz25je:"fr6rhvx",Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1kc0wz4",r59vdv:"fgq90dz",Bkw5xw4:"fq0y47f",hl6cv3:"f1pwrbz6",aea9ga:"f1hxxcvm",yayu3t:"fw8rgyo",Bhsv975:"f1wnzycx",rhl9o9:"f1730wal",B7gxrvb:"f1fy4ixr",B6q6orb:"fobkauc",B0lu1f8:"f16bqv1l"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".f1hdglry{animation-composition:replace,accumulate;}",".fo1kyvf{animation-duration:var(--durationSlower);}",".fetxo7e{animation-timing-function:var(--curveDecelerateMid);}",".f8x1vz1{--fui-positioning-slide-distance-x:0px;}",".f8g0anz{--fui-positioning-slide-distance-y:10px;}",".fezwn9i[data-popper-placement^=right]{--fui-positioning-slide-distance-x:-10px;}",".fz5efge[data-popper-placement^=right]{--fui-positioning-slide-distance-y:0px;}",".f1ydixl4[data-popper-placement^=bottom]{--fui-positioning-slide-distance-x:0px;}",".f8dgqj5[data-popper-placement^=bottom]{--fui-positioning-slide-distance-y:-10px;}",".fnyfnr8[data-popper-placement^=left]{--fui-positioning-slide-distance-x:10px;}",".fgw77r4[data-popper-placement^=left]{--fui-positioning-slide-distance-y:0px;}",".ftje0s4{animation-name:f5j8bii,f79suad;}",".fymb6k8{filter:drop-shadow(0 0 2px var(--colorNeutralShadowAmbient)) drop-shadow(0 8px 16px var(--colorNeutralShadowKey));}",".f19g0ac{z-index:1;}",".fg3r6xk{background-color:var(--colorNeutralBackgroundStatic);}",".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",[".f1sy4kr4{padding:12px;}",{p:-1}],[".f4zyqsv{padding:16px;}",{p:-1}],[".fop8ug2{padding:20px;}",{p:-1}],".f1s3jn22{--fui-positioning-arrow-height:8.484px;}",".fv40uqz{--fui-positioning-arrow-offset:-4.242px;}",".f1f72gjr{--fui-positioning-arrow-height:11.312px;}",".f69yoe5{--fui-positioning-arrow-offset:-5.656px;}",".f1ewtqcl{box-sizing:border-box;}",".f1euv43f{position:absolute;}",".f1bsuimh{z-index:-1;}",".f1u2r49w{background-color:inherit;}",".fqhgnl{background-clip:content-box;}",".f17bz04i{border-bottom-left-radius:var(--borderRadiusSmall);}",".f36o3x3{transform:rotate(var(--fui-positioning-arrow-angle));}",".fzofk8q{height:var(--fui-positioning-arrow-height);}",".f1wbx1ie{width:var(--fui-positioning-arrow-height);}",'.f1wl9k8s::before{content:"";}',".f1aocrix::before{display:block;}",".f1ljr5q2::before{background-color:inherit;}",[".f155f1qt::before{margin:-1px;}",{p:-1}],".f9mhzq7::before{width:100%;}",".fr6rhvx::before{height:100%;}",[".f1kc0wz4::before{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fgq90dz::before{border-bottom-left-radius:var(--borderRadiusSmall);}",".fq0y47f::before{clip-path:polygon(0% 0%, 100% 100%, 0% 100%);}",'[data-popper-placement^="top"] .f1pwrbz6{bottom:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="top"] .f1hxxcvm{--fui-positioning-arrow-angle:-45deg;}','[data-popper-placement^="right"] .fw8rgyo{left:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="right"] .f1wnzycx{--fui-positioning-arrow-angle:45deg;}','[data-popper-placement^="bottom"] .f1730wal{top:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="bottom"] .f1fy4ixr{--fui-positioning-arrow-angle:135deg;}','[data-popper-placement^="left"] .fobkauc{right:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="left"] .f16bqv1l{--fui-positioning-arrow-angle:225deg;}'],k:["@keyframes f5j8bii{from{opacity:0;}to{opacity:1;}}","@keyframes f79suad{from{transform:translate(var(--fui-positioning-slide-distance-x), var(--fui-positioning-slide-distance-y));}}"],m:[["@media (prefers-reduced-motion){.fxes1gr[data-popper-placement]{animation-composition:replace;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.fi19xcv[data-popper-placement]{animation-duration:1ms;}}",{m:"(prefers-reduced-motion)"}],["@media (prefers-reduced-motion){.f1mzajhk[data-popper-placement]{animation-name:f5j8bii;}}",{m:"(prefers-reduced-motion)"}]],t:["@supports not (animation-composition: accumulate){.fgez7cy[data-popper-placement]{animation-composition:replace;}}","@supports not (animation-composition: accumulate){.fjp4h9y[data-popper-placement]{animation-name:f5j8bii;}}"]}),a=e=>{const t=s();return e.root.className=(0,n.z)("fui-PopoverSurface",t.root,e.inline&&t.inline,"small"===e.size&&t.smallPadding,"medium"===e.size&&t.mediumPadding,"large"===e.size&&t.largePadding,"inverted"===e.appearance&&t.inverted,"brand"===e.appearance&&t.brand,e.root.className),e.arrowClassName=(0,n.z)(t.arrow,"small"===e.size?t.smallArrow:t.mediumLargeArrow),e}},3488:(e,t,o)=>{"use strict";o.d(t,{W:()=>h}),o(95734);var i=o(74396),n=o(32726),r=o(29875),s=o(38523),a=o(77442),l=o(16055),c=o(67795),u=o(36307),d=o(35985);const h=e=>{const t=(e=>{const{children:t,disableButtonEnhancement:o=!1}=e,h=(0,i.h)(t),g=(0,c.pO)((e=>e.open)),p=(0,c.pO)((e=>e.setOpen)),f=(0,c.pO)((e=>e.toggleOpen)),m=(0,c.pO)((e=>e.triggerRef)),v=(0,c.pO)((e=>e.openOnHover)),b=(0,c.pO)((e=>e.openOnContext)),{triggerAttributes:y}=(0,l.y)(),w={...y,"aria-expanded":`${g}`,...null==h?void 0:h.props,onMouseEnter:(0,n.D)((0,r.p)(null==h?void 0:h.props.onMouseEnter,(e=>{v&&p(e,!0)}))),onMouseLeave:(0,n.D)((0,r.p)(null==h?void 0:h.props.onMouseLeave,(e=>{v&&p(e,!1)}))),onContextMenu:(0,n.D)((0,r.p)(null==h?void 0:h.props.onContextMenu,(e=>{b&&(e.preventDefault(),p(e,!0))}))),ref:(0,s.a)(m,null==h?void 0:h.ref)},C={...w,onClick:(0,n.D)((0,r.p)(null==h?void 0:h.props.onClick,(e=>{b||f(e)}))),onKeyDown:(0,n.D)((0,r.p)(null==h?void 0:h.props.onKeyDown,(e=>{e.key===d.uf9&&g&&!e.isDefaultPrevented()&&(p(e,!1),e.preventDefault())})))},S=(0,u.F)("button"===(null==h?void 0:h.type)||"a"===(null==h?void 0:h.type)?h.type:"div",C);return{children:(0,a.L)(e.children,(0,u.F)("button"===(null==h?void 0:h.type)||"a"===(null==h?void 0:h.type)?h.type:"div",b?w:o?C:S))}})(e);return(e=>e.children)(t)};h.displayName="PopoverTrigger",h.isFluentTriggerComponent=!0},50752:(e,t,o)=>{"use strict";o.d(t,{A:()=>w});var i=o(95734),n=o(4754),r=o(32726),s=o(2527),a=o(12500),l=o(61394),c=o(36049),u=o(98721),d=o(11307),h=o(65855),g=o(45777),p=o(87789),f=o(43730),m=o(84197),v=o(49598),b=o(43203);var y=o(67795);const w=e=>(e=>{const{appearance:t,arrowRef:o,contentRef:n,inline:r,mountNode:s,open:a,openOnContext:l,openOnHover:c,setOpen:u,size:d,toggleOpen:h,trapFocus:g,triggerRef:p,withArrow:f,inertTrapFocus:m}=e;return i.createElement(y.nt.Provider,{value:{appearance:t,arrowRef:o,contentRef:n,inline:r,mountNode:s,open:a,openOnContext:l,openOnHover:c,setOpen:u,toggleOpen:h,triggerRef:p,size:d,trapFocus:g,inertTrapFocus:m,withArrow:f}},e.popoverTrigger,e.open&&e.popoverSurface)})((e=>{const[t,o]=(0,d.N)(),y={size:"medium",contextTarget:t,setContextTarget:o,...e},w=i.Children.toArray(e.children);let C,S;2===w.length?(C=w[0],S=w[1]):1===w.length&&(S=w[0]);const[k,T]=function(e){const t=(0,r.D)(((t,o)=>{var i;return null===(i=e.onOpenChange)||void 0===i?void 0:i.call(e,t,o)})),[o,n]=(0,c.i)({state:e.open,defaultState:e.defaultOpen,initialState:!1});e.open=void 0!==o?o:e.open;const s=e.setContextTarget;return[o,i.useCallback(((e,o)=>{o&&"contextmenu"===e.type&&s(e),o||s(void 0),n(o),null==t||t(e,{open:o})}),[n,t,s])]}(y),[x,_]=(0,n.Z)(),I=(0,r.D)(((t,o)=>{var i;_(),t instanceof Event||!t.persist||t.persist(),"mouseleave"===t.type?x((()=>{T(t,o)}),null!==(i=e.mouseLeaveDelay)&&void 0!==i?i:500):T(t,o)})),E=i.useCallback((e=>{I(e,!k)}),[I,k]),B=function(e){const t={position:"above",align:"center",arrowPadding:2*b.v,target:e.openOnContext?e.contextTarget:void 0,...(0,h.P)(e.positioning)};t.coverTarget&&(e.withArrow=!1),e.withArrow&&(t.offset=(0,g.H)(t.offset,v.aT[e.size]));const{targetRef:o,containerRef:i,arrowRef:n}=(0,p.T)(t);return{triggerRef:o,contentRef:i,arrowRef:n}}(y),{targetDocument:A}=(0,u.Y)();var R;(0,s.W)({contains:a.s,element:A,callback:e=>I(e,!1),refs:[B.triggerRef,B.contentRef],disabled:!k,disabledFocusOnIframe:!(null===(R=e.closeOnIframeFocus)||void 0===R||R)});const M=y.openOnContext||y.closeOnScroll;(0,l.z)({contains:a.s,element:A,callback:e=>I(e,!1),refs:[B.triggerRef,B.contentRef],disabled:!k||!M});const{findFirstFocusable:D}=(0,f.r)(),P=(0,m.i)();var F,O;return i.useEffect((()=>{if(e.unstable_disableAutoFocus)return;const t=B.contentRef.current;if(k&&t){var o;const e=!isNaN(null!==(o=t.getAttribute("tabIndex"))&&void 0!==o?o:void 0),i=e?t:D(t);null==i||i.focus(),e&&P(t)}}),[D,P,k,B.contentRef,e.unstable_disableAutoFocus]),{...y,...B,inertTrapFocus:null!==(F=e.inertTrapFocus)&&void 0!==F?F:void 0!==e.legacyTrapFocus&&!e.legacyTrapFocus,popoverTrigger:C,popoverSurface:S,open:k,setOpen:I,toggleOpen:E,setContextTarget:o,contextTarget:t,inline:null!==(O=e.inline)&&void 0!==O&&O}})(e));w.displayName="Popover"},43203:(e,t,o)=>{"use strict";o.d(t,{v:()=>i});const i=4},67795:(e,t,o)=>{"use strict";o.d(t,{nt:()=>r,pO:()=>a});var i=o(10932);if(3023==o.j)var n=o(51204);const r=(0,i.q)(void 0),s={open:!1,setOpen:()=>null,toggleOpen:()=>null,triggerRef:{current:null},contentRef:{current:null},arrowRef:{current:null},openOnContext:!1,openOnHover:!1,size:"medium",trapFocus:!1,inline:!1},a=(r.Provider,e=>(0,n.i)(r,((t=s)=>e(t))))},32471:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var i=o(95734),n=o(26092),r=o(86344),s=o(56456),a=o(38883);const l=e=>{const t=(e=>{const{element:t,className:o}=(0,r.h)(e.mountNode),a=i.useRef(null),l=(0,s.v)({disabled:!!t,className:o}),c=null!=t?t:l,u={children:e.children,mountNode:c,virtualParentRootRef:a};return i.useEffect((()=>{if(!c)return;const e=a.current,t=c.contains(e);return e&&!t?((0,n.g)(c,e),()=>{(0,n.g)(c,void 0)}):void 0}),[a,c]),u})(e);return(e=>i.createElement("span",{hidden:!0,ref:e.virtualParentRootRef},e.mountNode&&a.createPortal(e.children,e.mountNode)))(t)};l.displayName="Portal"},56456:(e,t,o)=>{"use strict";var i;o.d(t,{v:()=>g});var n=o(95734);if(3023==o.j)var r=o(71057);if(3023==o.j)var s=o(33874);if(3023==o.j)var a=o(75901);if(3023==o.j)var l=o(63649);if(3023==o.j)var c=o(17190);if(3023==o.j)var u=o(9264);if(3023==o.j)var d=o(36200);const h=(i||(i=o.t(n,2))).useInsertionEffect,g=e=>{const{targetDocument:t,dir:o}=(0,r.Y)(),i=(0,s.v)(),g=(0,c.Y)(),p=(0,d.B)(),f=(0,a.q)(),m=(0,l.z)(f,p.root,e.className),v=null!=i?i:null==t?void 0:t.body,b=(0,u.K)((()=>{if(void 0===v||e.disabled)return[null,()=>null];const t=v.ownerDocument.createElement("div");return v.appendChild(t),[t,()=>t.remove()]}),[v]);return h?h((()=>{if(!b)return;const e=m.split(" ").filter(Boolean);return b.classList.add(...e),b.setAttribute("dir",o),b.setAttribute("data-portal-node","true"),g.current=b,()=>{b.classList.remove(...e),b.removeAttribute("dir")}}),[m,o,b,g]):n.useMemo((()=>{b&&(b.className=m,b.setAttribute("dir",o),b.setAttribute("data-portal-node","true"),g.current=b)}),[m,o,b,g]),b}},36200:(e,t,o)=>{"use strict";o.d(t,{B:()=>i});const i=(0,o(27760).X)({root:{qhf8xq:"f1euv43f",Bhzewxz:"f15twtuk",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bj3rh1h:"f494woh"}},{d:[".f1euv43f{position:absolute;}",".f15twtuk{top:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".f494woh{z-index:1000000;}"]})},86344:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>n}),3023==o.j)var i=o(54034);function n(e){return(0,i.s)(e)?{element:e}:"object"==typeof e?null===e?{element:null}:e:{}}},88289:(e,t,o)=>{"use strict";o.d(t,{Z:()=>l});var i=o(95734),n=o(29146),r=o(77582),s=o(97482),a=o(38883);const l=e=>{const t=(e=>{const{element:t,className:o}=(0,r.h)(e.mountNode),a=i.useRef(null),l=(0,s.v)({disabled:!!t,className:o}),c=null!=t?t:l,u={children:e.children,mountNode:c,virtualParentRootRef:a};return i.useEffect((()=>{if(!c)return;const e=a.current,t=c.contains(e);return e&&!t?((0,n.g)(c,e),()=>{(0,n.g)(c,void 0)}):void 0}),[a,c]),u})(e);return(e=>i.createElement("span",{hidden:!0,ref:e.virtualParentRootRef},e.mountNode&&a.createPortal(e.children,e.mountNode)))(t)};l.displayName="Portal"},97482:(e,t,o)=>{"use strict";var i;o.d(t,{v:()=>g});var n=o(95734);if(3023==o.j)var r=o(98721);if(3023==o.j)var s=o(54658);if(3023==o.j)var a=o(32589);if(3023==o.j)var l=o(63649);if(3023==o.j)var c=o(59045);if(3023==o.j)var u=o(9264);if(3023==o.j)var d=o(96586);const h=(i||(i=o.t(n,2))).useInsertionEffect,g=e=>{const{targetDocument:t,dir:o}=(0,r.Y)(),i=(0,s.v)(),g=(0,c.Y)(),p=(0,d.B)(),f=(0,a.q)(),m=(0,l.z)(f,p.root,e.className),v=null!=i?i:null==t?void 0:t.body,b=(0,u.K)((()=>{if(void 0===v||e.disabled)return[null,()=>null];const t=v.ownerDocument.createElement("div");return v.appendChild(t),[t,()=>t.remove()]}),[v]);return h?h((()=>{if(!b)return;const e=m.split(" ").filter(Boolean);return b.classList.add(...e),b.setAttribute("dir",o),b.setAttribute("data-portal-node","true"),g.current=b,()=>{b.classList.remove(...e),b.removeAttribute("dir")}}),[m,o,b,g]):n.useMemo((()=>{b&&(b.className=m,b.setAttribute("dir",o),b.setAttribute("data-portal-node","true"),g.current=b)}),[m,o,b,g]),b}},96586:(e,t,o)=>{"use strict";o.d(t,{B:()=>i});const i=(0,o(27760).X)({root:{qhf8xq:"f1euv43f",Bhzewxz:"f15twtuk",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bj3rh1h:"f494woh"}},{d:[".f1euv43f{position:absolute;}",".f15twtuk{top:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".f494woh{z-index:1000000;}"]})},77582:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>n}),3023==o.j)var i=o(94756);function n(e){return(0,i.s)(e)?{element:e}:"object"==typeof e?null===e?{element:null}:e:{}}},74758:(e,t,o)=>{"use strict";o.d(t,{Hz:()=>n,Pg:()=>s,VJ:()=>i,a_:()=>r,l7:()=>a});const i="data-popper-is-intersecting",n="data-popper-escaped",r="data-popper-reference-hidden",s="data-popper-placement",a="fui-positioningend"},50201:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>d}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(54034);if(3023==o.j)var r=o(6687);if(3023==o.j)var s=o(86909);if(3023==o.j)var a=o(84314);if(3023==o.j)var l=o(62055);if(3023==o.j)var c=o(74758);if(3023==o.j)var u=o(8111);function d(e){let t=!1;const{container:o,target:d,arrow:h,strategy:g,middleware:p,placement:f,useTransform:m=!0,disableUpdateOnResize:v=!1}=e,b=o.ownerDocument.defaultView;if(!d||!o||!b)return{updatePosition:()=>{},dispose:()=>{}};const y=v?null:(0,u.J)(b,(e=>{e.every((e=>e.contentRect.width>0&&e.contentRect.height>0))&&S()}));let w=!0;const C=new Set;Object.assign(o.style,{position:"fixed",left:0,top:0,margin:0});const S=(0,a.s)((()=>{t||(w&&((0,l.X)(o).forEach((e=>C.add(e))),(0,n.s)(d)&&(0,l.X)(d).forEach((e=>C.add(e))),C.forEach((e=>{e.addEventListener("scroll",S,{passive:!0})})),null==y||y.observe(o),(0,n.s)(d)&&(null==y||y.observe(d)),w=!1),Object.assign(o.style,{position:g}),(0,i.rD)(d,o,{placement:f,middleware:p,strategy:g}).then((({x:e,y:i,middlewareData:n,placement:a})=>{t||((0,r.P)({arrow:h,middlewareData:n}),(0,s.f)({container:o,middlewareData:n,placement:a,coordinates:{x:e,y:i},lowPPI:((null==b?void 0:b.devicePixelRatio)||1)<=1,strategy:g,useTransform:m}),o.dispatchEvent(new CustomEvent(c.l7)))})).catch((e=>{})))}));return b&&(b.addEventListener("scroll",S,{passive:!0}),b.addEventListener("resize",S)),S(),{updatePosition:S,dispose:()=>{t=!0,b&&(b.removeEventListener("scroll",S),b.removeEventListener("resize",S)),C.forEach((e=>{e.removeEventListener("scroll",S)})),C.clear(),null==y||y.disconnect()}}}},45160:(e,t,o)=>{"use strict";function i(e){const t=e.clientX,o=e.clientY,i=t+1,n=o+1;return{getBoundingClientRect:function(){return{left:t,top:o,right:i,bottom:n,x:t,y:o,height:1,width:1}}}}o.d(t,{S:()=>i})},82834:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>n}),3023==o.j)var i=o(89839);function n(){return{name:"coverTarget",fn:e=>{const{placement:t,rects:o,x:n,y:r}=e,s={x:n,y:r};switch((0,i.n)(t).side){case"bottom":s.y-=o.reference.height;break;case"top":s.y+=o.reference.height;break;case"left":s.x+=o.reference.width;break;case"right":s.x-=o.reference.width}return s}}}},60945:(e,t,o)=>{"use strict";if(o.d(t,{U:()=>a}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(10745);if(3023==o.j)var r=o(98513);if(3023==o.j)var s=o(32503);function a(e){const{hasScrollableElement:t,flipBoundary:o,container:a,fallbackPositions:l=[],isRtl:c}=e,u=l.reduce(((e,t)=>{const{position:o,align:i}=(0,n.P)(t),s=(0,r.h)(i,o,c);return s&&e.push(s),e}),[]);return(0,i.UU)({...t&&{boundary:"clippingAncestors"},...o&&{altBoundary:!0,boundary:(0,s.r)(a,o)},fallbackStrategy:"bestFit",...u.length&&{fallbackPlacements:u}})}},63925:(e,t,o)=>{"use strict";if(o.d(t,{M:()=>n}),3023==o.j)var i=o(69929);function n(){return{name:"intersectionObserver",fn:async e=>{const t=e.rects.floating,o=await(0,i.__)(e,{altBoundary:!0}),n=o.top<t.height&&o.top>0,r=o.bottom<t.height&&o.bottom>0;return{data:{intersecting:n||r}}}}}},35177:(e,t,o)=>{"use strict";o.d(t,{_:()=>n});const i="--fui-match-target-size";function n(){return{name:"matchTargetSize",fn:async e=>{const{rects:{reference:t,floating:o},elements:{floating:n},middlewareData:{matchTargetSize:{matchTargetSizeAttempt:r=!1}={}}}=e;if(t.width===o.width||r)return{};const{width:s}=t;return n.style.setProperty(i,`${s}px`),n.style.width||(n.style.width=`var(${i})`),{data:{matchTargetSizeAttempt:!0},reset:{rects:!0}}}}}},58063:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>s,e:()=>a}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(32503);if(3023==o.j)var r=o(87880);const s=e=>({name:"resetMaxSize",fn({middlewareData:t,elements:o}){var i;if(null===(i=t.resetMaxSize)||void 0===i?void 0:i.maxSizeAlreadyReset)return{};const{applyMaxWidth:n,applyMaxHeight:r}=e;return n&&(o.floating.style.removeProperty("box-sizing"),o.floating.style.removeProperty("max-width"),o.floating.style.removeProperty("width")),r&&(o.floating.style.removeProperty("box-sizing"),o.floating.style.removeProperty("max-height"),o.floating.style.removeProperty("height")),{data:{maxSizeAlreadyReset:!0},reset:{rects:!0}}}});function a(e,t){const{container:o,overflowBoundary:s,overflowBoundaryPadding:a,isRtl:l}=t;return(0,i.Ej)({...a&&{padding:(0,r.z)(a,l)},...s&&{altBoundary:!0,boundary:(0,n.r)(o,s)},apply({availableHeight:t,availableWidth:o,elements:i,rects:n}){const r=(e,t,o)=>{if(e&&(i.floating.style.setProperty("box-sizing","border-box"),i.floating.style.setProperty(`max-${t}`,`${o}px`),n.floating[t]>o)){i.floating.style.setProperty(t,`${o}px`);const e="width"===t?"x":"y";i.floating.style.getPropertyValue(`overflow-${e}`)||i.floating.style.setProperty(`overflow-${e}`,"auto")}},{applyMaxWidth:s,applyMaxHeight:a}=e;r(s,"width",o),r(a,"height",t)}})}},81237:(e,t,o)=>{"use strict";if(o.d(t,{c:()=>r}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(4510);function r(e){const t=(0,n.u)(e);return(0,i.cY)(t)}},60908:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>s}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(87880);if(3023==o.j)var r=o(32503);function s(e){const{hasScrollableElement:t,shiftToCoverTarget:o,disableTether:s,overflowBoundary:a,container:l,overflowBoundaryPadding:c,isRtl:u}=e;return(0,i.BN)({...t&&{boundary:"clippingAncestors"},...o&&{crossAxis:!0,limiter:(0,i.ER)({crossAxis:!0,mainAxis:!1})},...s&&{crossAxis:"all"===s,limiter:(0,i.ER)({crossAxis:"all"!==s,mainAxis:!1})},...c&&{padding:(0,n.z)(c,u)},...a&&{altBoundary:!0,boundary:(0,r.r)(l,a)}})}},30935:(e,t,o)=>{"use strict";if(o.d(t,{T:()=>S}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(71057);if(3023==o.j)var r=o(10723);if(3023==o.j)var s=o(19720);if(3023==o.j)var a=o(44877);var l=o(95734);if(3023==o.j)var c=o(54304);if(3023==o.j)var u=o(81100);if(3023==o.j)var d=o(28392);if(3023==o.j)var h=o(98513);if(3023==o.j)var g=o(58063);if(3023==o.j)var p=o(35177);if(3023==o.j)var f=o(81237);if(3023==o.j)var m=o(82834);if(3023==o.j)var v=o(60945);if(3023==o.j)var b=o(60908);if(3023==o.j)var y=o(63925);if(3023==o.j)var w=o(50201);if(3023==o.j)var C=o(74758);function S(e){const t=l.useRef(null),o=l.useRef(null),S=l.useRef(null),k=l.useRef(null),T=l.useRef(null),{enabled:x=!0}=e,_=function(e){const{align:t,arrowPadding:o,autoSize:r,coverTarget:s,flipBoundary:a,offset:c,overflowBoundary:w,pinned:C,position:S,unstable_disableTether:k,positionFixed:T,strategy:x,overflowBoundaryPadding:_,fallbackPositions:I,useTransform:E,matchTargetSize:B,disableUpdateOnResize:A=!1,shiftToCoverTarget:R}=e,{dir:M,targetDocument:D}=(0,n.Y)(),P="rtl"===M,F=(null!=x?x:T)?"fixed":"absolute",O=(0,u.a)(r);return l.useCallback(((e,n)=>{const r=(0,d.iv)(e),l=[O&&(0,g.D)(O),B&&(0,p._)(),c&&(0,f.c)(c),s&&(0,m.z)(),!C&&(0,v.U)({container:e,flipBoundary:a,hasScrollableElement:r,isRtl:P,fallbackPositions:I}),(0,b.B)({container:e,hasScrollableElement:r,overflowBoundary:w,disableTether:k,overflowBoundaryPadding:_,isRtl:P,shiftToCoverTarget:R}),O&&(0,g.e)(O,{container:e,overflowBoundary:w,overflowBoundaryPadding:_,isRtl:P}),(0,y.M)(),n&&(0,i.UE)({element:n,padding:o}),(0,i.jD)({strategy:"referenceHidden"}),(0,i.jD)({strategy:"escaped"}),!1].filter(Boolean);return{placement:(0,h.h)(t,S,P),middleware:l,strategy:F,useTransform:E,disableUpdateOnResize:A}}),[t,o,O,s,k,a,P,c,w,C,S,F,_,I,E,B,D,A])}(e),I=l.useCallback((()=>{var e;t.current&&t.current.dispose(),t.current=null;const i=null!==(e=S.current)&&void 0!==e?e:o.current;x&&(0,r.S)()&&i&&k.current&&(t.current=(0,w.h)({container:k.current,target:i,arrow:T.current,..._(k.current,T.current)}))}),[x,_]),E=(0,s.D)((e=>{S.current=e,I()}));l.useImperativeHandle(e.positioningRef,(()=>({updatePosition:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.updatePosition()},setTarget:t=>{e.target,E(t)}})),[e.target,E]),(0,a.E)((()=>{var t;E(null!==(t=e.target)&&void 0!==t?t:null)}),[e.target,E]),(0,a.E)((()=>{I()}),[I]);const B=(0,c.c)(null,(e=>{o.current!==e&&(o.current=e,I())})),A=(0,s.D)((()=>{var t;return null===(t=e.onPositioningEnd)||void 0===t?void 0:t.call(e)}));return{targetRef:B,containerRef:(0,c.c)(null,(e=>{var t;k.current!==e&&(null===(t=k.current)||void 0===t||t.removeEventListener(C.l7,A),null==e||e.addEventListener(C.l7,A),k.current=e,I())})),arrowRef:(0,c.c)(null,(e=>{T.current!==e&&(T.current=e,I())}))}}},49433:(e,t,o)=>{"use strict";o.d(t,{N:()=>r});var i=o(95734);if(3023==o.j)var n=o(45160);const r=e=>{const[t,o]=i.useState(e);return[t,e=>{if(null==e)return void o(void 0);let t;t=e instanceof MouseEvent?e:e.nativeEvent,MouseEvent;const i=(0,n.S)(t);o(i)}]}},8111:(e,t,o)=>{"use strict";function i(e,t){return new e.ResizeObserver(t)}o.d(t,{J:()=>i})},84314:(e,t,o)=>{"use strict";function i(e){let t;return()=>(t||(t=new Promise((o=>{Promise.resolve().then((()=>{t=void 0,o(e())}))}))),t)}o.d(t,{s:()=>i})},79430:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>n}),3023==o.j)var i=o(89839);const n=e=>{const{side:t,alignment:o}=(0,i.n)(e),n={top:"above",bottom:"below",right:"after",left:"before"}[t],r=o&&(e=>"above"===e||"below"===e?{start:"start",end:"end"}:{start:"top",end:"bottom"})(n)[o];return{position:n,alignment:r}}},32503:(e,t,o)=>{"use strict";if(o.d(t,{r:()=>n}),3023==o.j)var i=o(28392);function n(e,t){if("window"===t)return null==e?void 0:e.ownerDocument.documentElement;if("clippingParents"===t)return"clippingAncestors";if("scrollParent"===t){let t=(0,i.mH)(e);return"BODY"===t.nodeName&&(t=null==e?void 0:e.ownerDocument.documentElement),t}return t}},4510:(e,t,o)=>{"use strict";if(o.d(t,{u:()=>n}),3023==o.j)var i=o(79430);function n(e){return e?"number"==typeof e||"object"==typeof e?e:({rects:{floating:t,reference:o},placement:n})=>{const{position:r,alignment:s}=(0,i.y)(n);return e({positionedRect:t,targetRect:o,position:r,alignment:s})}:e}},28392:(e,t,o)=>{"use strict";o.d(t,{iv:()=>n,mH:()=>i});const i=e=>{const t=e&&(e=>"HTML"===e.nodeName?e:e.parentNode||e.host)(e);if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}const{overflow:o,overflowX:n,overflowY:r}=(e=>{var t;return 1!==e.nodeType?{}:(null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView).getComputedStyle(e,null)})(t);return/(auto|scroll|overlay)/.test(o+r+n)?t:i(t)},n=e=>{var t;const o=i(e);return!!o&&o!==(null===(t=o.ownerDocument)||void 0===t?void 0:t.body)}},62055:(e,t,o)=>{"use strict";if(o.d(t,{X:()=>n}),3023==o.j)var i=o(28392);function n(e){const t=[];let o=e;for(;o;){const n=(0,i.mH)(o);if(e.ownerDocument.body===n){t.push(n);break}if("BODY"===n.nodeName&&n!==e.ownerDocument.body)break;t.push(n),o=n}return t}},64287:(e,t,o)=>{"use strict";function i(e,t){return"number"==typeof e||"object"==typeof e&&null!==e?n(e,t):"function"==typeof e?o=>{const i=e(o);return n(i,t)}:{mainAxis:t}}o.d(t,{H:()=>i});const n=(e,t)=>{return"number"==typeof e?{mainAxis:e+t}:{...e,mainAxis:(null!==(o=e.mainAxis)&&void 0!==o?o:0)+t};var o}},81100:(e,t,o)=>{"use strict";o.d(t,{a:()=>i});const i=e=>{switch(e){case"always":case!0:return{applyMaxWidth:!0,applyMaxHeight:!0};case"width-always":case"width":return{applyMaxWidth:!0,applyMaxHeight:!1};case"height-always":case"height":return{applyMaxWidth:!1,applyMaxHeight:!0};default:return!1}}},89839:(e,t,o)=>{"use strict";function i(e){const t=e.split("-");return{side:t[0],alignment:t[1]}}o.d(t,{n:()=>i})},10745:(e,t,o)=>{"use strict";o.d(t,{P:()=>n});const i={above:{position:"above",align:"center"},"above-start":{position:"above",align:"start"},"above-end":{position:"above",align:"end"},below:{position:"below",align:"center"},"below-start":{position:"below",align:"start"},"below-end":{position:"below",align:"end"},before:{position:"before",align:"center"},"before-top":{position:"before",align:"top"},"before-bottom":{position:"before",align:"bottom"},after:{position:"after",align:"center"},"after-top":{position:"after",align:"top"},"after-bottom":{position:"after",align:"bottom"}};function n(e){return null==e?{}:"string"==typeof e?i[e]:e}},87880:(e,t,o)=>{"use strict";function i(e,t){if("number"==typeof e)return e;const{start:o,end:i,...n}=e,r=n,s=t?"end":"start",a=t?"start":"end";return e[s]&&(r.left=e[s]),e[a]&&(r.right=e[a]),r}o.d(t,{z:()=>i})},98513:(e,t,o)=>{"use strict";o.d(t,{h:()=>i});const i=(e,t,o)=>{const i=((e,t)=>{const o="above"===e||"below"===e,i="top"===t||"bottom"===t;return o&&i||!o&&!i})(t,e)?"center":e,n=t&&(e=>({above:"top",below:"bottom",before:e?"right":"left",after:e?"left":"right"}))(o)[t],r=i&&{start:"start",end:"end",top:"start",bottom:"end",center:void 0}[i];return n&&r?`${n}-${r}`:n}},54304:(e,t,o)=>{"use strict";o.d(t,{c:()=>r});var i=o(95734);if(3023==o.j)var n=o(44877);function r(e,t,o){const r=i.useRef(!0),[s]=i.useState((()=>({value:e,callback:t,facade:{get current(){return s.value},set current(e){const t=s.value;if(t!==e){if(s.value=e,o&&r.current)return;s.callback(e,t)}}}})));return(0,n.E)((()=>{r.current=!1}),[]),s.callback=t,s.facade}},6687:(e,t,o)=>{"use strict";function i(e){const{arrow:t,middlewareData:o}=e;if(!o.arrow||!t)return;const{x:i,y:n}=o.arrow;Object.assign(t.style,{left:null!=i?`${i}px`:"",top:null!=n?`${n}px`:""})}o.d(t,{P:()=>i})},86909:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>n}),3023==o.j)var i=o(74758);function n(e){var t,o,n;const{container:r,placement:s,middlewareData:a,strategy:l,lowPPI:c,coordinates:u,useTransform:d=!0}=e;if(!r)return;r.setAttribute(i.Pg,s),r.removeAttribute(i.VJ),a.intersectionObserver.intersecting&&r.setAttribute(i.VJ,""),r.removeAttribute(i.Hz),(null===(t=a.hide)||void 0===t?void 0:t.escaped)&&r.setAttribute(i.Hz,""),r.removeAttribute(i.a_),(null===(o=a.hide)||void 0===o?void 0:o.referenceHidden)&&r.setAttribute(i.a_,"");const h=(null===(n=r.ownerDocument.defaultView)||void 0===n?void 0:n.devicePixelRatio)||1,g=Math.round(u.x*h)/h,p=Math.round(u.y*h)/h;Object.assign(r.style,{position:l}),d?Object.assign(r.style,{transform:c?`translate(${g}px, ${p}px)`:`translate3d(${g}px, ${p}px, 0)`}):Object.assign(r.style,{left:`${g}px`,top:`${p}px`})}},59380:(e,t,o)=>{"use strict";o.d(t,{Hz:()=>n,Pg:()=>s,VJ:()=>i,a_:()=>r,l7:()=>a});const i="data-popper-is-intersecting",n="data-popper-escaped",r="data-popper-reference-hidden",s="data-popper-placement",a="fui-positioningend"},66939:(e,t,o)=>{"use strict";if(o.d(t,{h:()=>d}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(94756);if(3023==o.j)var r=o(88409);if(3023==o.j)var s=o(18523);if(3023==o.j)var a=o(4292);if(3023==o.j)var l=o(56869);if(3023==o.j)var c=o(59380);if(3023==o.j)var u=o(17661);function d(e){let t=!1;const{container:o,target:d,arrow:h,strategy:g,middleware:p,placement:f,useTransform:m=!0,disableUpdateOnResize:v=!1}=e,b=o.ownerDocument.defaultView;if(!d||!o||!b)return{updatePosition:()=>{},dispose:()=>{}};const y=v?null:(0,u.J)(b,(e=>{e.every((e=>e.contentRect.width>0&&e.contentRect.height>0))&&S()}));let w=!0;const C=new Set;Object.assign(o.style,{position:"fixed",left:0,top:0,margin:0});const S=(0,a.s)((()=>{t||(w&&((0,l.X)(o).forEach((e=>C.add(e))),(0,n.s)(d)&&(0,l.X)(d).forEach((e=>C.add(e))),C.forEach((e=>{e.addEventListener("scroll",S,{passive:!0})})),null==y||y.observe(o),(0,n.s)(d)&&(null==y||y.observe(d)),w=!1),Object.assign(o.style,{position:g}),(0,i.rD)(d,o,{placement:f,middleware:p,strategy:g}).then((({x:e,y:i,middlewareData:n,placement:a})=>{t||((0,r.P)({arrow:h,middlewareData:n}),(0,s.f)({container:o,middlewareData:n,placement:a,coordinates:{x:e,y:i},lowPPI:((null==b?void 0:b.devicePixelRatio)||1)<=1,strategy:g,useTransform:m}),o.dispatchEvent(new CustomEvent(c.l7)))})).catch((e=>{})))}));return b&&(b.addEventListener("scroll",S,{passive:!0}),b.addEventListener("resize",S)),S(),{updatePosition:S,dispose:()=>{t=!0,b&&(b.removeEventListener("scroll",S),b.removeEventListener("resize",S)),C.forEach((e=>{e.removeEventListener("scroll",S)})),C.clear(),null==y||y.disconnect()}}}},49610:(e,t,o)=>{"use strict";function i(e){const t=e.clientX,o=e.clientY,i=t+1,n=o+1;return{getBoundingClientRect:function(){return{left:t,top:o,right:i,bottom:n,x:t,y:o,height:1,width:1}}}}o.d(t,{S:()=>i})},11992:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>n}),3023==o.j)var i=o(56041);function n(){return{name:"coverTarget",fn:e=>{const{placement:t,rects:o,x:n,y:r}=e,s={x:n,y:r};switch((0,i.n)(t).side){case"bottom":s.y-=o.reference.height;break;case"top":s.y+=o.reference.height;break;case"left":s.x+=o.reference.width;break;case"right":s.x-=o.reference.width}return s}}}},35351:(e,t,o)=>{"use strict";if(o.d(t,{U:()=>a}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(65855);if(3023==o.j)var r=o(20811);if(3023==o.j)var s=o(84241);function a(e){const{hasScrollableElement:t,flipBoundary:o,container:a,fallbackPositions:l=[],isRtl:c}=e,u=l.reduce(((e,t)=>{const{position:o,align:i}=(0,n.P)(t),s=(0,r.h)(i,o,c);return s&&e.push(s),e}),[]);return(0,i.UU)({...t&&{boundary:"clippingAncestors"},...o&&{altBoundary:!0,boundary:(0,s.r)(a,o)},fallbackStrategy:"bestFit",...u.length&&{fallbackPlacements:u}})}},58703:(e,t,o)=>{"use strict";if(o.d(t,{M:()=>n}),3023==o.j)var i=o(69929);function n(){return{name:"intersectionObserver",fn:async e=>{const t=e.rects.floating,o=await(0,i.__)(e,{altBoundary:!0}),n=o.top<t.height&&o.top>0,r=o.bottom<t.height&&o.bottom>0;return{data:{intersecting:n||r}}}}}},90819:(e,t,o)=>{"use strict";o.d(t,{_:()=>n});const i="--fui-match-target-size";function n(){return{name:"matchTargetSize",fn:async e=>{const{rects:{reference:t,floating:o},elements:{floating:n},middlewareData:{matchTargetSize:{matchTargetSizeAttempt:r=!1}={}}}=e;if(t.width===o.width||r)return{};const{width:s}=t;return n.style.setProperty(i,`${s}px`),n.style.width||(n.style.width=`var(${i})`),{data:{matchTargetSizeAttempt:!0},reset:{rects:!0}}}}}},77357:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>s,e:()=>a}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(84241);if(3023==o.j)var r=o(77949);const s=e=>({name:"resetMaxSize",fn({middlewareData:t,elements:o}){var i;if(null===(i=t.resetMaxSize)||void 0===i?void 0:i.maxSizeAlreadyReset)return{};const{applyMaxWidth:n,applyMaxHeight:r}=e;return n&&(o.floating.style.removeProperty("box-sizing"),o.floating.style.removeProperty("max-width"),o.floating.style.removeProperty("width")),r&&(o.floating.style.removeProperty("box-sizing"),o.floating.style.removeProperty("max-height"),o.floating.style.removeProperty("height")),{data:{maxSizeAlreadyReset:!0},reset:{rects:!0}}}});function a(e,t){const{container:o,overflowBoundary:s,overflowBoundaryPadding:a,isRtl:l}=t;return(0,i.Ej)({...a&&{padding:(0,r.z)(a,l)},...s&&{altBoundary:!0,boundary:(0,n.r)(o,s)},apply({availableHeight:t,availableWidth:o,elements:i,rects:n}){const r=(e,t,o)=>{if(e&&(i.floating.style.setProperty("box-sizing","border-box"),i.floating.style.setProperty(`max-${t}`,`${o}px`),n.floating[t]>o)){i.floating.style.setProperty(t,`${o}px`);const e="width"===t?"x":"y";i.floating.style.getPropertyValue(`overflow-${e}`)||i.floating.style.setProperty(`overflow-${e}`,"auto")}},{applyMaxWidth:s,applyMaxHeight:a}=e;r(s,"width",o),r(a,"height",t)}})}},45503:(e,t,o)=>{"use strict";if(o.d(t,{c:()=>r}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(50552);function r(e){const t=(0,n.u)(e);return(0,i.cY)(t)}},15114:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>s}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(77949);if(3023==o.j)var r=o(84241);function s(e){const{hasScrollableElement:t,shiftToCoverTarget:o,disableTether:s,overflowBoundary:a,container:l,overflowBoundaryPadding:c,isRtl:u}=e;return(0,i.BN)({...t&&{boundary:"clippingAncestors"},...o&&{crossAxis:!0,limiter:(0,i.ER)({crossAxis:!0,mainAxis:!1})},...s&&{crossAxis:"all"===s,limiter:(0,i.ER)({crossAxis:"all"!==s,mainAxis:!1})},...c&&{padding:(0,n.z)(c,u)},...a&&{altBoundary:!0,boundary:(0,r.r)(l,a)}})}},87789:(e,t,o)=>{"use strict";if(o.d(t,{T:()=>S}),3023==o.j)var i=o(69929);if(3023==o.j)var n=o(98721);if(3023==o.j)var r=o(20101);if(3023==o.j)var s=o(32726);if(3023==o.j)var a=o(93851);var l=o(95734);if(3023==o.j)var c=o(71926);if(3023==o.j)var u=o(26774);if(3023==o.j)var d=o(30762);if(3023==o.j)var h=o(20811);if(3023==o.j)var g=o(77357);if(3023==o.j)var p=o(90819);if(3023==o.j)var f=o(45503);if(3023==o.j)var m=o(11992);if(3023==o.j)var v=o(35351);if(3023==o.j)var b=o(15114);if(3023==o.j)var y=o(58703);if(3023==o.j)var w=o(66939);if(3023==o.j)var C=o(59380);function S(e){const t=l.useRef(null),o=l.useRef(null),S=l.useRef(null),k=l.useRef(null),T=l.useRef(null),{enabled:x=!0}=e,_=function(e){const{align:t,arrowPadding:o,autoSize:r,coverTarget:s,flipBoundary:a,offset:c,overflowBoundary:w,pinned:C,position:S,unstable_disableTether:k,positionFixed:T,strategy:x,overflowBoundaryPadding:_,fallbackPositions:I,useTransform:E,matchTargetSize:B,disableUpdateOnResize:A=!1,shiftToCoverTarget:R}=e,{dir:M,targetDocument:D}=(0,n.Y)(),P="rtl"===M,F=(null!=x?x:T)?"fixed":"absolute",O=(0,u.a)(r);return l.useCallback(((e,n)=>{const r=(0,d.iv)(e),l=[O&&(0,g.D)(O),B&&(0,p._)(),c&&(0,f.c)(c),s&&(0,m.z)(),!C&&(0,v.U)({container:e,flipBoundary:a,hasScrollableElement:r,isRtl:P,fallbackPositions:I}),(0,b.B)({container:e,hasScrollableElement:r,overflowBoundary:w,disableTether:k,overflowBoundaryPadding:_,isRtl:P,shiftToCoverTarget:R}),O&&(0,g.e)(O,{container:e,overflowBoundary:w,overflowBoundaryPadding:_,isRtl:P}),(0,y.M)(),n&&(0,i.UE)({element:n,padding:o}),(0,i.jD)({strategy:"referenceHidden"}),(0,i.jD)({strategy:"escaped"}),!1].filter(Boolean);return{placement:(0,h.h)(t,S,P),middleware:l,strategy:F,useTransform:E,disableUpdateOnResize:A}}),[t,o,O,s,k,a,P,c,w,C,S,F,_,I,E,B,D,A])}(e),I=l.useCallback((()=>{var e;t.current&&t.current.dispose(),t.current=null;const i=null!==(e=S.current)&&void 0!==e?e:o.current;x&&(0,r.S)()&&i&&k.current&&(t.current=(0,w.h)({container:k.current,target:i,arrow:T.current,..._(k.current,T.current)}))}),[x,_]),E=(0,s.D)((e=>{S.current=e,I()}));l.useImperativeHandle(e.positioningRef,(()=>({updatePosition:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.updatePosition()},setTarget:t=>{e.target,E(t)}})),[e.target,E]),(0,a.E)((()=>{var t;E(null!==(t=e.target)&&void 0!==t?t:null)}),[e.target,E]),(0,a.E)((()=>{I()}),[I]);const B=(0,c.c)(null,(e=>{o.current!==e&&(o.current=e,I())})),A=(0,s.D)((()=>{var t;return null===(t=e.onPositioningEnd)||void 0===t?void 0:t.call(e)}));return{targetRef:B,containerRef:(0,c.c)(null,(e=>{var t;k.current!==e&&(null===(t=k.current)||void 0===t||t.removeEventListener(C.l7,A),null==e||e.addEventListener(C.l7,A),k.current=e,I())})),arrowRef:(0,c.c)(null,(e=>{T.current!==e&&(T.current=e,I())}))}}},11307:(e,t,o)=>{"use strict";o.d(t,{N:()=>r});var i=o(95734);if(3023==o.j)var n=o(49610);const r=e=>{const[t,o]=i.useState(e);return[t,e=>{if(null==e)return void o(void 0);let t;t=e instanceof MouseEvent?e:e.nativeEvent,MouseEvent;const i=(0,n.S)(t);o(i)}]}},17661:(e,t,o)=>{"use strict";function i(e,t){return new e.ResizeObserver(t)}o.d(t,{J:()=>i})},4292:(e,t,o)=>{"use strict";function i(e){let t;return()=>(t||(t=new Promise((o=>{Promise.resolve().then((()=>{t=void 0,o(e())}))}))),t)}o.d(t,{s:()=>i})},19456:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>n}),3023==o.j)var i=o(56041);const n=e=>{const{side:t,alignment:o}=(0,i.n)(e),n={top:"above",bottom:"below",right:"after",left:"before"}[t],r=o&&(e=>"above"===e||"below"===e?{start:"start",end:"end"}:{start:"top",end:"bottom"})(n)[o];return{position:n,alignment:r}}},84241:(e,t,o)=>{"use strict";if(o.d(t,{r:()=>n}),3023==o.j)var i=o(30762);function n(e,t){if("window"===t)return null==e?void 0:e.ownerDocument.documentElement;if("clippingParents"===t)return"clippingAncestors";if("scrollParent"===t){let t=(0,i.mH)(e);return"BODY"===t.nodeName&&(t=null==e?void 0:e.ownerDocument.documentElement),t}return t}},50552:(e,t,o)=>{"use strict";if(o.d(t,{u:()=>n}),3023==o.j)var i=o(19456);function n(e){return e?"number"==typeof e||"object"==typeof e?e:({rects:{floating:t,reference:o},placement:n})=>{const{position:r,alignment:s}=(0,i.y)(n);return e({positionedRect:t,targetRect:o,position:r,alignment:s})}:e}},30762:(e,t,o)=>{"use strict";o.d(t,{iv:()=>n,mH:()=>i});const i=e=>{const t=e&&(e=>"HTML"===e.nodeName?e:e.parentNode||e.host)(e);if(!t)return document.body;switch(t.nodeName){case"HTML":case"BODY":return t.ownerDocument.body;case"#document":return t.body}const{overflow:o,overflowX:n,overflowY:r}=(e=>{var t;if(1!==e.nodeType)return{};const o=null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView;return o?o.getComputedStyle(e,null):{}})(t);return/(auto|scroll|overlay)/.test(o+r+n)?t:i(t)},n=e=>{var t;const o=i(e);return!!o&&o!==(null===(t=o.ownerDocument)||void 0===t?void 0:t.body)}},56869:(e,t,o)=>{"use strict";if(o.d(t,{X:()=>n}),3023==o.j)var i=o(30762);function n(e){const t=[];let o=e;for(;o;){const n=(0,i.mH)(o);if(e.ownerDocument.body===n){t.push(n);break}if("BODY"===n.nodeName&&n!==e.ownerDocument.body)break;t.push(n),o=n}return t}},45777:(e,t,o)=>{"use strict";function i(e,t){return"number"==typeof e||"object"==typeof e&&null!==e?n(e,t):"function"==typeof e?o=>{const i=e(o);return n(i,t)}:{mainAxis:t}}o.d(t,{H:()=>i});const n=(e,t)=>{return"number"==typeof e?{mainAxis:e+t}:{...e,mainAxis:(null!==(o=e.mainAxis)&&void 0!==o?o:0)+t};var o}},26774:(e,t,o)=>{"use strict";o.d(t,{a:()=>i});const i=e=>{switch(e){case"always":case!0:return{applyMaxWidth:!0,applyMaxHeight:!0};case"width-always":case"width":return{applyMaxWidth:!0,applyMaxHeight:!1};case"height-always":case"height":return{applyMaxWidth:!1,applyMaxHeight:!0};default:return!1}}},56041:(e,t,o)=>{"use strict";function i(e){const t=e.split("-");return{side:t[0],alignment:t[1]}}o.d(t,{n:()=>i})},65855:(e,t,o)=>{"use strict";o.d(t,{P:()=>n});const i={above:{position:"above",align:"center"},"above-start":{position:"above",align:"start"},"above-end":{position:"above",align:"end"},below:{position:"below",align:"center"},"below-start":{position:"below",align:"start"},"below-end":{position:"below",align:"end"},before:{position:"before",align:"center"},"before-top":{position:"before",align:"top"},"before-bottom":{position:"before",align:"bottom"},after:{position:"after",align:"center"},"after-top":{position:"after",align:"top"},"after-bottom":{position:"after",align:"bottom"}};function n(e){return null==e?{}:"string"==typeof e?i[e]:e}},77949:(e,t,o)=>{"use strict";function i(e,t){if("number"==typeof e)return e;const{start:o,end:i,...n}=e,r=n,s=t?"end":"start",a=t?"start":"end";return e[s]&&(r.left=e[s]),e[a]&&(r.right=e[a]),r}o.d(t,{z:()=>i})},20811:(e,t,o)=>{"use strict";o.d(t,{h:()=>i});const i=(e,t,o)=>{const i=((e,t)=>{const o="above"===e||"below"===e,i="top"===t||"bottom"===t;return o&&i||!o&&!i})(t,e)?"center":e,n=t&&(e=>({above:"top",below:"bottom",before:e?"right":"left",after:e?"left":"right"}))(o)[t],r=i&&{start:"start",end:"end",top:"start",bottom:"end",center:void 0}[i];return n&&r?`${n}-${r}`:n}},71926:(e,t,o)=>{"use strict";o.d(t,{c:()=>r});var i=o(95734);if(3023==o.j)var n=o(93851);function r(e,t,o){const r=i.useRef(!0),[s]=i.useState((()=>({value:e,callback:t,facade:{get current(){return s.value},set current(e){const t=s.value;if(t!==e){if(s.value=e,o&&r.current)return;s.callback(e,t)}}}})));return(0,n.E)((()=>{r.current=!1}),[]),s.callback=t,s.facade}},88409:(e,t,o)=>{"use strict";function i(e){const{arrow:t,middlewareData:o}=e;if(!o.arrow||!t)return;const{x:i,y:n}=o.arrow;Object.assign(t.style,{left:null!=i?`${i}px`:"",top:null!=n?`${n}px`:""})}o.d(t,{P:()=>i})},18523:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>n}),3023==o.j)var i=o(59380);function n(e){var t,o,n;const{container:r,placement:s,middlewareData:a,strategy:l,lowPPI:c,coordinates:u,useTransform:d=!0}=e;if(!r)return;r.setAttribute(i.Pg,s),r.removeAttribute(i.VJ),a.intersectionObserver.intersecting&&r.setAttribute(i.VJ,""),r.removeAttribute(i.Hz),(null===(t=a.hide)||void 0===t?void 0:t.escaped)&&r.setAttribute(i.Hz,""),r.removeAttribute(i.a_),(null===(o=a.hide)||void 0===o?void 0:o.referenceHidden)&&r.setAttribute(i.a_,"");const h=(null===(n=r.ownerDocument.defaultView)||void 0===n?void 0:n.devicePixelRatio)||1,g=Math.round(u.x*h)/h,p=Math.round(u.y*h)/h;Object.assign(r.style,{position:l}),d?Object.assign(r.style,{transform:c?`translate(${g}px, ${p}px)`:`translate3d(${g}px, ${p}px, 0)`}):Object.assign(r.style,{left:`${g}px`,top:`${p}px`})}},49790:(e,t,o)=>{"use strict";o.d(t,{G:()=>x});var i=o(95734),n=o(36049),r=o(36216),s=o(32726),a=o(84485),l=o(38523),c=o(29875),u=o(83629),d=o(51485),h=o(87579),g=o(60839),p=o(18861),f=o(27760),m=o(11612),v=o(63649),b=o(62447);const y=(0,f.X)({small:{i8kkvl:"fjuset5",B2u0y6b:"f1xzfw5u",uwmqm3:["fk8j09s","fdw0yi8"],z189sj:["fdw0yi8","fk8j09s"]},medium:{i8kkvl:"fjuset5",B2u0y6b:"f1xzfw5u",uwmqm3:["f1f5gg8d","f1vdfbxk"],z189sj:["f1vdfbxk","f1f5gg8d"]},large:{i8kkvl:"fjuset5",B2u0y6b:"f1xzfw5u",uwmqm3:["f1ng84yb","f11gcy0p"],z189sj:["f11gcy0p","f1ng84yb"]},input:{uwmqm3:["fk8j09s","fdw0yi8"],z189sj:["fhxju0i","f1cnd47f"],Boqhc8c:"f18izjht",B8uat0v:"fcoa6sg"},unfocusedNoContentAfter:{z189sj:["fhxju0i","f1cnd47f"]}},{d:[".fjuset5{column-gap:0;}",".f1xzfw5u{max-width:468px;}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".fhxju0i{padding-right:0;}",".f1cnd47f{padding-left:0;}",".f18izjht::-webkit-search-decoration{display:none;}",".fcoa6sg::-webkit-search-cancel-button{display:none;}"]}),w=(0,f.X)({small:{z189sj:["fdw0yi8","fk8j09s"]},medium:{z189sj:["f1vdfbxk","f1f5gg8d"]},large:{z189sj:["f11gcy0p","f1ng84yb"]}},{d:[".fdw0yi8{padding-right:var(--spacingHorizontalSNudge);}",".fk8j09s{padding-left:var(--spacingHorizontalSNudge);}",".f1vdfbxk{padding-right:var(--spacingHorizontalS);}",".f1f5gg8d{padding-left:var(--spacingHorizontalS);}",".f11gcy0p{padding-right:var(--spacingHorizontalMNudge);}",".f1ng84yb{padding-left:var(--spacingHorizontalMNudge);}"]}),C=(0,f.X)({contentAfter:{uwmqm3:["f1uw59to","fw5db7e"],i8kkvl:"f1ufnopg"},rest:{Bqenvij:"fniina8",a9b677:"f3tsq5r",uwmqm3:["f1cnd47f","fhxju0i"],B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp"}},{d:[".f1uw59to{padding-left:var(--spacingHorizontalM);}",".fw5db7e{padding-right:var(--spacingHorizontalM);}",".f1ufnopg{column-gap:var(--spacingHorizontalXS);}",".fniina8{height:0;}",".f3tsq5r{width:0;}",".f1cnd47f{padding-left:0;}",".fhxju0i{padding-right:0;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}]]}),S=(0,m.y)("r1pvzcuu",null,[".r1pvzcuu{box-sizing:border-box;color:var(--colorNeutralForeground3);display:flex;cursor:pointer;}",".r1pvzcuu>svg{font-size:20px;}"]),k=(0,f.X)({disabled:{sj55zd:"f1s2aq7o"},small:{Duoase:"f3qv9w"},medium:{},large:{Duoase:"f16u2scb"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f3qv9w>svg{font-size:16px;}",".f16u2scb>svg{font-size:24px;}"]});var T=o(34877);const x=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{size:o="medium",disabled:g=!1,root:p,contentBefore:f,dismiss:m,contentAfter:v,value:b,defaultValue:y,...w}=e,C=i.useRef(null),S=i.useRef(null),[k,T]=(0,n.i)({state:b,defaultState:y,initialState:""}),[x,_]=i.useState(!1),I=i.useCallback((()=>{_(!0)}),[_]),E=i.useCallback((e=>{var t;_(!!(null===(t=C.current)||void 0===t?void 0:t.contains(e.relatedTarget)))}),[_]),B=r.Gf(p),A=(0,s.D)((t=>{var o,i,n;(0,a.g)(m)&&(null===(n=m.onClick)||void 0===n||n.call(m,t)),T(""),null===(o=e.onChange)||void 0===o||o.call(e,t,{value:""}),null===(i=S.current)||void 0===i||i.focus()})),R=(0,u.n)({type:"search",disabled:g,size:o,value:k,root:r.Gk({...B,ref:(0,l.a)(null==B?void 0:B.ref,C),onFocus:(0,c.p)(null==B?void 0:B.onFocus,I),onBlur:(0,c.p)(null==B?void 0:B.onBlur,E)},{elementType:"span"}),contentBefore:r.lq(f,{renderByDefault:!0,defaultProps:{children:i.createElement(d.vMY,null)},elementType:"span"}),contentAfter:r.lq(v,{renderByDefault:!0,elementType:"span"}),...w,onChange:(0,s.D)((t=>{var o;const i=t.target.value;null===(o=e.onChange)||void 0===o||o.call(e,t,{value:i}),T(i)}))},(0,l.a)(S,t)),M={...R,components:{...R.components,dismiss:"span"},dismiss:r.lq(m,{defaultProps:{children:i.createElement(h.BEt,null),role:"button","aria-label":"clear",tabIndex:-1},renderByDefault:!0,elementType:"span"}),disabled:g,focused:x,size:o};return M.dismiss&&(M.dismiss.onClick=A),M})(e,t);return(e=>{const{disabled:t,focused:o,size:i}=e,n=y(),r=w(),s=C(),a=S(),l=k();e.root.className=(0,v.z)("fui-SearchBox",n[i],!o&&n.unfocusedNoContentAfter,e.root.className),e.input.className=(0,v.z)("fui-SearchBox__input",n.input,!o&&r[i],e.input.className),e.dismiss&&(e.dismiss.className=(0,v.z)("fui-SearchBox__dismiss",a,t&&l.disabled,l[i],e.dismiss.className)),e.contentBefore&&(e.contentBefore.className=(0,v.z)("fui-SearchBox__contentBefore",e.contentBefore.className)),e.contentAfter?e.contentAfter.className=(0,v.z)("fui-SearchBox__contentAfter",s.contentAfter,!o&&s.rest,e.contentAfter.className):e.dismiss&&(e.dismiss.className=(0,v.z)(e.dismiss.className,s.contentAfter)),(0,b.d)(e)})(o),(0,T.$e)("useSearchBoxStyles_unstable")(o),(e=>((0,p.C)(e),(0,g.FD)(e.root,{children:[e.contentBefore&&(0,g.Y)(e.contentBefore,{}),(0,g.Y)(e.input,{}),e.contentAfter&&(0,g.FD)(e.contentAfter,{children:[e.contentAfter.children,e.dismiss&&(0,g.Y)(e.dismiss,{})]})]})))(o)}));x.displayName="SearchBox"},82931:(e,t,o)=>{"use strict";o.d(t,{D:()=>i});const i=o(95734).createContext(void 0);i.Provider},201:(e,t,o)=>{"use strict";o.d(t,{i1:()=>r});var i=o(95734);const n=i.createContext(void 0);function r(){return i.useContext(n)}n.Provider},33874:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i=o(95734);const n=i.createContext(void 0);function r(){return i.useContext(n)}n.Provider},30711:(e,t,o)=>{"use strict";o.d(t,{Pv:()=>r});var i=o(95734);const n=i.createContext(void 0);function r(){var e;return null!==(e=i.useContext(n))&&void 0!==e?e:{}}n.Provider},54658:(e,t,o)=>{"use strict";o.d(t,{v:()=>r});var i=o(95734);const n=i.createContext(void 0);function r(){return i.useContext(n)}n.Provider},32589:(e,t,o)=>{"use strict";o.d(t,{q:()=>s});var i=o(95734);const n=i.createContext(void 0),r="";function s(){var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r}n.Provider},1447:(e,t,o)=>{"use strict";o.d(t,{n:()=>s});var i=o(95734);const n=i.createContext(void 0),r={};function s(){var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r}n.Provider},29572:(e,t,o)=>{"use strict";o.d(t,{H:()=>m});var i=o(95734),n=o(36216),r=o(48701),s=o(77790),a=o(60839),l=o(18861),c=o(27760),u=o(63649);const d=(0,c.X)({root:{qhf8xq:"f10pi13n",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",Bsft5z2:"f13zj6fq",ap17g6:"f2gz7yw",E3zdtr:"f1mdlcz9",By385i5:0,Eqx8gd:0,B1piin3:0,bn5sak:0,B58onuk:"f1nt53hs",s9ouvv:"f18xs7ez",xr36ep:"ffm3629",Bitv4sc:"f1f9zsvm",Jx5sug:"f1ub80pn",Hzyzrh:"f1e7twep"},wave:{De3pzq:"f1gjxg63",Br128sd:["f3fo419","f6m9r4"],h62rwi:["ftnv2js","f12jzhyt"],b1kco5:["fig1c6l","f1rv5y9h"],oi31me:"f103n15n"},pulse:{Br128sd:"f171zwvm",xr36ep:"fs3pcyf",Bjyk6c5:"f1yu5riq"},translucent:{De3pzq:"f162mh4z",h62rwi:["flvf4r0","f1uek97b"]},translucentPulse:{De3pzq:"flu3bqm",Bjyk6c5:"fxucc0w"}},{d:[".f10pi13n{position:relative;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],'.f13zj6fq::after{content:"";}',".f2gz7yw::after{display:block;}",".f1mdlcz9::after{position:absolute;}",[".f1nt53hs::after{inset:0;}",{p:-1}],".f18xs7ez::after{animation-iteration-count:infinite;}",".ffm3629::after{animation-duration:3s;}",".f1f9zsvm::after{animation-timing-function:ease-in-out;}",".f1gjxg63{background-color:var(--colorNeutralStencil1);}",".f3fo419::after{animation-name:f1efwx7q;}",".f6m9r4::after{animation-name:f1kkgpz1;}",".ftnv2js::after{background-image:linear-gradient(\n        to right,\n        var(--colorNeutralStencil1) 0%,\n        var(--colorNeutralStencil2) 50%,\n        var(--colorNeutralStencil1) 100%);}",".f12jzhyt::after{background-image:linear-gradient(\n        to left,\n        var(--colorNeutralStencil1) 0%,\n        var(--colorNeutralStencil2) 50%,\n        var(--colorNeutralStencil1) 100%);}",".fig1c6l::after{transform:translate(-100%);}",".f1rv5y9h::after{transform:translate(100%);}",".f171zwvm::after{animation-name:f12o7gg6;}",".fs3pcyf::after{animation-duration:1s;}",".f1yu5riq::after{background-color:var(--colorNeutralStencil1);}",".f162mh4z{background-color:var(--colorNeutralStencil1Alpha);}",".flvf4r0::after{background-image:linear-gradient(\n      to right,\n      transparent 0%,\n      var(--colorNeutralStencil1Alpha) 50%,\n      transparent 100%);}",".f1uek97b::after{background-image:linear-gradient(\n      to left,\n      transparent 0%,\n      var(--colorNeutralStencil1Alpha) 50%,\n      transparent 100%);}",".flu3bqm{background-color:none;}",".fxucc0w::after{background-color:var(--colorNeutralStencil1Alpha);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f1ub80pn::after{animation-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1e7twep::after{animation-iteration-count:1;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (forced-colors: active){.f103n15n::after{background-color:WindowText;}}",{m:"screen and (forced-colors: active)"}]],k:["@keyframes f1efwx7q{to{transform:translate(100%);}}","@keyframes f1kkgpz1{to{transform:translate(-100%);}}","@keyframes f12o7gg6{0%{opacity:1;}50%{opacity:0.4;}100%{opacity:1;}}"]}),h=(0,c.X)({8:{Bqenvij:"f1x82gua"},12:{Bqenvij:"fvblgha"},16:{Bqenvij:"fd461yt"},20:{Bqenvij:"fjamq6b"},24:{Bqenvij:"frvgh55"},28:{Bqenvij:"fxldao9"},32:{Bqenvij:"f1d2rq10"},36:{Bqenvij:"f8ljn23"},40:{Bqenvij:"fbhnoac"},48:{Bqenvij:"ff2sm71"},56:{Bqenvij:"fzki0ko"},64:{Bqenvij:"f16k9i2m"},72:{Bqenvij:"f1shusfg"},96:{Bqenvij:"fypu0ge"},120:{Bqenvij:"fjr5b71"},128:{Bqenvij:"fele2au"},root:{a9b677:"fly5x3f",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ff3glw6"}},{d:[".f1x82gua{height:8px;}",".fvblgha{height:12px;}",".fd461yt{height:16px;}",".fjamq6b{height:20px;}",".frvgh55{height:24px;}",".fxldao9{height:28px;}",".f1d2rq10{height:32px;}",".f8ljn23{height:36px;}",".fbhnoac{height:40px;}",".ff2sm71{height:48px;}",".fzki0ko{height:56px;}",".f16k9i2m{height:64px;}",".f1shusfg{height:72px;}",".fypu0ge{height:96px;}",".fjr5b71{height:120px;}",".fele2au{height:128px;}",".fly5x3f{width:100%;}",[".ff3glw6{border-radius:4px;}",{p:-1}]]}),g=(0,c.X)({8:{a9b677:"f1o3cbw4",Bqenvij:"f1x82gua"},12:{a9b677:"frx94fk",Bqenvij:"fvblgha"},16:{a9b677:"fjw5fx7",Bqenvij:"fd461yt"},20:{a9b677:"f64fuq3",Bqenvij:"fjamq6b"},24:{a9b677:"fq4mcun",Bqenvij:"frvgh55"},28:{a9b677:"f1w9dchk",Bqenvij:"fxldao9"},32:{a9b677:"f1szoe96",Bqenvij:"f1d2rq10"},36:{a9b677:"fpdz1er",Bqenvij:"f8ljn23"},40:{a9b677:"feqmc2u",Bqenvij:"fbhnoac"},48:{a9b677:"f124akge",Bqenvij:"ff2sm71"},56:{a9b677:"f1u66zr1",Bqenvij:"fzki0ko"},64:{a9b677:"fa9ln6p",Bqenvij:"f16k9i2m"},72:{a9b677:"fhcae8x",Bqenvij:"f1shusfg"},96:{a9b677:"f1kyr2gn",Bqenvij:"fypu0ge"},120:{a9b677:"fwfqyga",Bqenvij:"fjr5b71"},128:{a9b677:"f1iksgmy",Bqenvij:"fele2au"}},{d:[".f1o3cbw4{width:8px;}",".f1x82gua{height:8px;}",".frx94fk{width:12px;}",".fvblgha{height:12px;}",".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".f64fuq3{width:20px;}",".fjamq6b{height:20px;}",".fq4mcun{width:24px;}",".frvgh55{height:24px;}",".f1w9dchk{width:28px;}",".fxldao9{height:28px;}",".f1szoe96{width:32px;}",".f1d2rq10{height:32px;}",".fpdz1er{width:36px;}",".f8ljn23{height:36px;}",".feqmc2u{width:40px;}",".fbhnoac{height:40px;}",".f124akge{width:48px;}",".ff2sm71{height:48px;}",".f1u66zr1{width:56px;}",".fzki0ko{height:56px;}",".fa9ln6p{width:64px;}",".f16k9i2m{height:64px;}",".fhcae8x{width:72px;}",".f1shusfg{height:72px;}",".f1kyr2gn{width:96px;}",".fypu0ge{height:96px;}",".fwfqyga{width:120px;}",".fjr5b71{height:120px;}",".f1iksgmy{width:128px;}",".fele2au{height:128px;}"]}),p=(0,c.X)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f5q2cvs"}},{d:[[".f5q2cvs{border-radius:50%;}",{p:-1}]]});var f=o(34877);const m=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{animation:o,appearance:i}=(0,s.O)(),{animation:a=(null!=o?o:"wave"),appearance:l=(null!=i?i:"opaque"),size:c=16,shape:u="rectangle"}=e;return{appearance:l,animation:a,size:c,shape:u,components:{root:"div"},root:n.Gk((0,r.g)("div",{ref:t,...e}),{elementType:"div"})}})(e,t);return(e=>{const{animation:t,appearance:o,size:i,shape:n}=e,r=d(),s=h(),a=g(),l=p();e.root.className=(0,u.z)("fui-SkeletonItem",r.root,"wave"===t&&r.wave,"pulse"===t&&r.pulse,"translucent"===o&&r.translucent,"pulse"===t&&"translucent"===o&&r.translucentPulse,"rectangle"===n&&s.root,"rectangle"===n&&s[i],"square"===n&&a[i],"circle"===n&&l.root,"circle"===n&&a[i],e.root.className)})(o),(0,f.$e)("useSkeletonItemStyles_unstable")(o),(e=>((0,l.C)(e),(0,a.Y)(e.root,{})))(o)}));m.displayName="SkeletonItem"},84226:(e,t,o)=>{"use strict";o.d(t,{E:()=>d});var i=o(95734),n=o(36216),r=o(48701),s=o(77790),a=o(60839),l=o(18861),c=o(63649);var u=o(34877);const d=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{animation:o,appearance:i}=(0,s.O)(),{animation:a=(null!=o?o:"wave"),appearance:l=(null!=i?i:"opaque")}=e;return{animation:a,appearance:l,components:{root:"div"},root:n.Gk((0,r.g)("div",{ref:t,role:"progressbar","aria-busy":!0,...e}),{elementType:"div"})}})(e,t),d=(e=>{const{animation:t,appearance:o}=e;return{skeletonGroup:i.useMemo((()=>({animation:t,appearance:o})),[t,o])}})(o);return(e=>{e.root.className=(0,c.z)("fui-Skeleton",e.root.className)})(o),(0,u.$e)("useSkeletonStyles_unstable")(o),((e,t)=>((0,l.C)(e),(0,a.Y)(s.Q,{value:t.skeletonGroup,children:(0,a.Y)(e.root,{})})))(o,d)}));d.displayName="Skeleton"},77790:(e,t,o)=>{"use strict";o.d(t,{O:()=>a,Q:()=>s});var i=o(95734);const n=i.createContext(void 0),r={},s=n.Provider,a=()=>{var e;return null!==(e=i.useContext(n))&&void 0!==e?e:r}},74978:(e,t,o)=>{"use strict";o.d(t,{H:()=>l,bd:()=>a});var i=o(10932);if(3023==o.j)var n=o(51204);const r={appearance:"transparent",reserveSelectedTabSpace:!0,selectTabOnFocus:!1,disabled:!1,selectedValue:void 0,onRegister:()=>{},onUnregister:()=>{},onSelect:()=>{},getRegisteredTabs:()=>({registeredTabs:{}}),size:"medium",vertical:!1},s=(0,i.q)(void 0),a=s.Provider,l=e=>(0,n.i)(s,((t=r)=>e(t)))},520:(e,t,o)=>{"use strict";o.d(t,{U:()=>d});var i=o(95734),n=o(27760);if(3023==o.j)var r=o(63649);if(3023==o.j)var s=o(74978);if(3023==o.j)var a=o(77114);const l=(0,n.X)({base:{B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1gl81tg"},animated:{Ba2ppi3:"fhwpy7i",F2fol1:"f6zz20j",B1dyfl9:"f1ai4sc1",B0vmy72:"f9qxlq5",u9bimw:"f1aql376"},horizontal:{sjv3b2:["fug4aj8","f1i5xzg7"],b1kco5:"f1q7ujh"},vertical:{sjv3b2:"f1hqboyk",b1kco5:"f1dxupa6"}},{d:[[".f1gl81tg{overflow:visible;}",{p:-1}],".fhwpy7i::after{transition-property:transform;}",".f6zz20j::after{transition-duration:var(--durationSlow);}",".f1ai4sc1::after{transition-timing-function:var(--curveDecelerateMax);}",".fug4aj8::after{transform-origin:left;}",".f1i5xzg7::after{transform-origin:right;}",".f1q7ujh::after{transform:translateX(var(--fui-Tab__indicator--offset)) scaleX(var(--fui-Tab__indicator--scale));}",".f1hqboyk::after{transform-origin:top;}",".f1dxupa6::after{transform:translateY(var(--fui-Tab__indicator--offset)) scaleY(var(--fui-Tab__indicator--scale));}"],m:[["@media (prefers-reduced-motion: reduce){.f9qxlq5::after{transition-property:none;}}",{m:"(prefers-reduced-motion: reduce)"}],["@media (prefers-reduced-motion: reduce){.f1aql376::after{transition-duration:0.01ms;}}",{m:"(prefers-reduced-motion: reduce)"}]]}),c=(e,t)=>{var o;const i=u(t)?null===(o=e[JSON.stringify(t)])||void 0===o?void 0:o.ref.current:void 0;return i?(e=>{if(e){var t;const o=(null===(t=e.parentElement)||void 0===t?void 0:t.getBoundingClientRect())||{x:0,y:0,width:0,height:0},i=e.getBoundingClientRect();return{x:i.x-o.x,y:i.y-o.y,width:i.width,height:i.height}}})(i):void 0},u=e=>null!=e,d=e=>{const{disabled:t,selected:o,vertical:n}=e,d=l(),[h,g]=i.useState(),[p,f]=i.useState({offset:0,scale:1}),m=(0,s.H)((e=>e.getRegisteredTabs)),[v]=(0,a.N)();if(o){const{previousSelectedValue:e,selectedValue:t,registeredTabs:o}=m();if(u(e)&&h!==e){const i=c(o,e),r=c(o,t);if(r&&i){const t=n?i.y-r.y:i.x-r.x,o=n?i.height/r.height:i.width/r.width;f({offset:t,scale:o}),g(e),v((()=>f({offset:0,scale:1})))}}}else u(h)&&g(void 0);if(t)return e;const b=0===p.offset&&1===p.scale;e.root.className=(0,r.z)(e.root.className,o&&d.base,o&&b&&d.animated,o&&(n?d.vertical:d.horizontal));const y={"--fui-Tab__indicator--offset":`${p.offset}px`,"--fui-Tab__indicator--scale":`${p.scale}`};return e.root.style={...y,...e.root.style},e}},45825:(e,t,o)=>{"use strict";o.d(t,{i:()=>a});var i=o(95734);if(3023==o.j)var n=o(58276);if(3023==o.j)var r=o(17523);if(3023==o.j)var s=o(26192);function a(){const e=(0,s.p)(),t=e?(0,n.Az)(e):void 0,[o]=(0,r.Z)();return i.useCallback((e=>{o((()=>{null==t||t.activate(e)}),0)}),[t,o])}},42174:(e,t,o)=>{"use strict";o.d(t,{r:()=>s});var i=o(95734);if(3023==o.j)var n=o(71057);if(3023==o.j)var r=o(26192);const s=()=>{const e=(0,r.p)(),{targetDocument:t}=(0,n.Y)();return{findAllFocusable:i.useCallback(((t,o)=>(null==e?void 0:e.focusable.findAll({container:t,acceptCondition:o}))||[]),[e]),findFirstFocusable:i.useCallback((t=>null==e?void 0:e.focusable.findFirst({container:t})),[e]),findLastFocusable:i.useCallback((t=>null==e?void 0:e.focusable.findLast({container:t})),[e]),findNextFocusable:i.useCallback(((o,i={})=>{if(!e||!t)return null;const{container:n=t.body}=i;return e.focusable.findNext({currentElement:o,container:n})}),[e,t]),findPrevFocusable:i.useCallback(((o,i={})=>{if(!e||!t)return null;const{container:n=t.body}=i;return e.focusable.findPrev({currentElement:o,container:n})}),[e,t])}}},64011:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>l}),3023==o.j)var i=o(51507);if(3023==o.j)var n=o(63417);if(3023==o.j)var r=o(58276);if(3023==o.j)var s=o(26192);const a=e=>e.hasAttribute("data-tabster-never-hide"),l=(e={})=>{const{trapFocus:t,alwaysFocusable:o,legacyTrapFocus:l}=e,c=(0,s.p)();c&&((0,r.Az)(c,void 0,a),(0,r.mz)(c));const u=(0,i.Bi)("modal-",e.id);return{modalAttributes:(0,n.g)({restorer:{type:r.CP.Source},...t&&{modalizer:{id:u,isOthersAccessible:!t,isAlwaysAccessible:o,isTrapped:l&&t}}}),triggerAttributes:(0,n.g)({restorer:{type:r.CP.Target}})}}},26192:(e,t,o)=>{"use strict";o.d(t,{p:()=>l});var i=o(95734);if(3023==o.j)var n=o(71057);if(3023==o.j)var r=o(58276);if(3023==o.j)var s=o(45935);if(3023==o.j)var a=o(44877);const l=()=>{const{targetDocument:e}=(0,n.Y)(),t=(null==e?void 0:e.defaultView)||void 0,o=null==t?void 0:t.__tabsterShadowDOMAPI,l=i.useMemo((()=>t?(0,r._A)(t,{autoRoot:{},controlTab:!1,getParent:s.P,checkUncontrolledTrappingFocus:e=>{var t;return!!(null===(t=e.firstElementChild)||void 0===t?void 0:t.hasAttribute("data-is-focus-trap-zone-bumper"))},DOMAPI:o}):null),[t,o]);return(0,a.E)((()=>()=>{l&&(0,r.hC)(l)}),[l]),l}},63417:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>s}),3023==o.j)var i=o(58276);if(3023==o.j)var n=o(26192);var r=o(95734);const s=e=>{(0,n.p)();const t=(0,i.U6)(e,!0);return r.useMemo((()=>({[i.h7]:t})),[t])}},57714:(e,t,o)=>{"use strict";o.d(t,{A7:()=>i});const i="data-fui-focus-visible"},33959:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>s}),3023==o.j)var i=o(94756);if(3023==o.j)var n=o(96406);if(3023==o.j)var r=o(57714);function s(e,t){if(a(e))return()=>{};const o={current:void 0},s=(0,n.SQ)(t);function l(e){s.isNavigatingWithKeyboard()&&(0,i.s)(e)&&(o.current=e,e.setAttribute(r.A7,""))}function c(){o.current&&(o.current.removeAttribute(r.A7),o.current=void 0)}s.subscribe((e=>{e||c()}));const u=e=>{c(),l(e.composedPath()[0])},d=t=>{(!t.relatedTarget||(0,i.s)(t.relatedTarget)&&!e.contains(t.relatedTarget))&&c()};return e.addEventListener(n.Oy,u),e.addEventListener("focusout",d),e.focusVisible=!0,e.contains(t.document.activeElement)&&l(t.document.activeElement),()=>{c(),e.removeEventListener(n.Oy,u),e.removeEventListener("focusout",d),delete e.focusVisible,(0,n.bd)(s)}}function a(e){return!!e&&(!!e.focusVisible||a(null==e?void 0:e.parentElement))}},84197:(e,t,o)=>{"use strict";o.d(t,{i:()=>a});var i=o(95734);if(3023==o.j)var n=o(58276);if(3023==o.j)var r=o(4754);if(3023==o.j)var s=o(65484);function a(){const e=(0,s.p)(n.Az),[t]=(0,r.Z)();return i.useCallback((o=>{t((()=>{var t;null===(t=e.current)||void 0===t||t.activate(o)}),0)}),[e,t])}},21257:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>s}),3023==o.j)var i=o(58276);if(3023==o.j)var n=o(68957);if(3023==o.j)var r=o(65484);const s=(e={})=>{const{circular:t,axis:o,memorizeCurrent:s=!0,tabbable:l,ignoreDefaultKeydown:c,unstable_hasDefault:u}=e;return(0,r.p)(i.S),(0,n.g)({mover:{cyclic:!!t,direction:a(null!=o?o:"vertical"),memorizeCurrent:s,tabbable:l,hasDefault:u},...c&&{focusable:{ignoreKeydown:c}}})};function a(e){switch(e){case"horizontal":return i.iA.Horizontal;case"grid":return i.iA.Grid;case"grid-linear":return i.iA.GridLinear;case"both":return i.iA.Both;default:return i.iA.Vertical}}},43730:(e,t,o)=>{"use strict";o.d(t,{r:()=>s});var i=o(95734);if(3023==o.j)var n=o(98721);if(3023==o.j)var r=o(65484);const s=()=>{const e=(0,r.p)(),{targetDocument:t}=(0,n.Y)();return{findAllFocusable:i.useCallback(((t,o)=>{var i;return(null===(i=e.current)||void 0===i?void 0:i.focusable.findAll({container:t,acceptCondition:o}))||[]}),[e]),findFirstFocusable:i.useCallback((t=>{var o;return null===(o=e.current)||void 0===o?void 0:o.focusable.findFirst({container:t})}),[e]),findLastFocusable:i.useCallback((t=>{var o;return null===(o=e.current)||void 0===o?void 0:o.focusable.findLast({container:t})}),[e]),findNextFocusable:i.useCallback(((o,i={})=>{if(!e.current||!t)return null;const{container:n=t.body}=i;return e.current.focusable.findNext({currentElement:o,container:n})}),[e,t]),findPrevFocusable:i.useCallback(((o,i={})=>{if(!e.current||!t)return null;const{container:n=t.body}=i;return e.current.focusable.findPrev({currentElement:o,container:n})}),[e,t])}}},59045:(e,t,o)=>{"use strict";o.d(t,{Y:()=>s});var i=o(95734);if(3023==o.j)var n=o(98721);if(3023==o.j)var r=o(33959);function s(e={}){const t=(0,n.Y)(),o=i.useRef(null);var s;const a=null!==(s=e.targetDocument)&&void 0!==s?s:t.targetDocument;return i.useEffect((()=>{if((null==a?void 0:a.defaultView)&&o.current)return(0,r.y)(o.current,a.defaultView)}),[o,a]),o}},21298:(e,t,o)=>{"use strict";o.d(t,{B:()=>r});var i=o(95734);if(3023==o.j)var n=o(65499);function r(){const e=(0,n.K)();return i.useCallback((()=>{var t,o;return null!==(o=null===(t=e.current)||void 0===t?void 0:t.isNavigatingWithKeyboard())&&void 0!==o&&o}),[e])}},65499:(e,t,o)=>{"use strict";o.d(t,{K:()=>s});var i=o(95734);if(3023==o.j)var n=o(96406);if(3023==o.j)var r=o(98721);function s(){const{targetDocument:e}=(0,r.Y)(),t=i.useRef(null);return i.useEffect((()=>{const o=null==e?void 0:e.defaultView;if(o){const e=(0,n.SQ)(o);return t.current=e,()=>{(0,n.bd)(e),t.current=null}}}),[e]),t}},16055:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>c}),3023==o.j)var i=o(50344);if(3023==o.j)var n=o(68957);if(3023==o.j)var r=o(58276);if(3023==o.j)var s=o(65484);const a=e=>e.hasAttribute("data-tabster-never-hide");function l(e){(0,r.Az)(e,void 0,a),(0,r.mz)(e)}const c=(e={})=>{const{trapFocus:t,alwaysFocusable:o,legacyTrapFocus:a}=e;(0,s.p)(l);const c=(0,i.Bi)("modal-",e.id);return{modalAttributes:(0,n.g)({restorer:{type:r.CP.Source},...t&&{modalizer:{id:c,isOthersAccessible:!t,isAlwaysAccessible:o,isTrapped:a&&t}}}),triggerAttributes:(0,n.g)({restorer:{type:r.CP.Target}})}}},67265:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>r}),3023==o.j)var i=o(58276);if(3023==o.j)var n=o(65484);function r(){return(0,n.p)(i.mz),(0,i.U6)({restorer:{type:i.CP.Source}})}},65484:(e,t,o)=>{"use strict";o.d(t,{p:()=>l});var i=o(95734);if(3023==o.j)var n=o(58276);if(3023==o.j)var r=o(98721);if(3023==o.j)var s=o(77073);const a=e=>e;function l(e=a){const{targetDocument:t}=(0,r.Y)(),o=i.useRef(null);return i.useEffect((()=>{const i=function(e){const t=(null==e?void 0:e.defaultView)||void 0,o=null==t?void 0:t.__tabsterShadowDOMAPI;if(t)return(0,n._A)(t,{autoRoot:{},controlTab:!1,getParent:s.P,checkUncontrolledTrappingFocus:e=>{var t;return!!(null===(t=e.firstElementChild)||void 0===t?void 0:t.hasAttribute("data-is-focus-trap-zone-bumper"))},DOMAPI:o})}(t);if(i)return o.current=e(i),()=>{(0,n.hC)(i),o.current=null}}),[t,e]),o}},68957:(e,t,o)=>{"use strict";if(o.d(t,{g:()=>s}),3023==o.j)var i=o(58276);if(3023==o.j)var n=o(65484);var r=o(95734);const s=e=>{(0,n.p)();const t=(0,i.U6)(e,!0);return r.useMemo((()=>({[i.h7]:t})),[t])}},89942:(e,t,o)=>{"use strict";o.d(t,{m:()=>R});var i=o(95734),n=o(65855),r=o(45777),s=o(87789),a=o(1447),l=o(98721),c=o(21298),u=o(96406),d=o(44031),h=o(4754),g=o(36049),p=o(36216),f=o(50344),m=o(38523),v=o(93851),b=o(29875),y=o(74396),w=o(77442),C=o(32726),S=o(33884),k=o(35985),T=o(60839),x=o(88289),_=o(18861),I=o(34877),E=o(27760),B=o(63649);const A=(0,E.X)({root:{mc9l5x:"fjseox",B7ck84d:"f1ewtqcl",B2u0y6b:"f132xexn",Bceei9c:"f158kwzp",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm",Btd35i7:"fokg9q4",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f9ggezi",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1bzqsji",De3pzq:"fxugw4r",sj55zd:"f19n0e5",Bhu2qc9:"fxeb0a7"},visible:{mc9l5x:"ftgm304"},inverted:{De3pzq:"fg3r6xk",sj55zd:"fonrgv7"},arrow:{B7ck84d:"f1ewtqcl",qhf8xq:"f1euv43f",Bj3rh1h:"f1bsuimh",rhnwrx:"f1s3jn22",Bdy53xb:"fv40uqz",De3pzq:"f1u2r49w",B2eet1l:"fqhgnl",Beyfa6y:"f17bz04i",Bz10aip:"f36o3x3",Bqenvij:"fzofk8q",a9b677:"f1wbx1ie",Ftih45:"f1wl9k8s",Br0sdwz:"f1aocrix",cmx5o7:"f1ljr5q2",susq4k:0,Biibvgv:0,Bicfajf:0,qehafq:0,Brs5u8j:"f155f1qt",Ccq8qp:"f9mhzq7",Baz25je:"fr6rhvx",Bcgcnre:0,Bqjgrrk:0,qa3bma:0,y0oebl:0,Biqmznv:0,Bm6vgfq:0,Bbv0w2i:0,uvfttm:0,eqrjj:0,Bk5zm6e:0,m598lv:0,B4f6apu:0,ydt019:0,Bq4z7u6:0,Bdkvgpv:0,B0qfbqy:0,kj8mxx:"f1kc0wz4",r59vdv:"fgq90dz",Bkw5xw4:"fq0y47f",hl6cv3:"f1pwrbz6",aea9ga:"f1hxxcvm",yayu3t:"fw8rgyo",Bhsv975:"f1wnzycx",rhl9o9:"f1730wal",B7gxrvb:"f1fy4ixr",B6q6orb:"fobkauc",B0lu1f8:"f16bqv1l"}},{d:[".fjseox{display:none;}",".f1ewtqcl{box-sizing:border-box;}",".f132xexn{max-width:240px;}",".f158kwzp{cursor:default;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".fokg9q4{overflow-wrap:break-word;}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".f9ggezi{border:1px solid var(--colorTransparentStroke);}",{p:-2}],[".f1bzqsji{padding:4px 11px 6px 11px;}",{p:-1}],".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".fxeb0a7{filter:drop-shadow(0 0 2px var(--colorNeutralShadowAmbient)) drop-shadow(0 4px 8px var(--colorNeutralShadowKey));}",".ftgm304{display:block;}",".fg3r6xk{background-color:var(--colorNeutralBackgroundStatic);}",".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".f1euv43f{position:absolute;}",".f1bsuimh{z-index:-1;}",".f1s3jn22{--fui-positioning-arrow-height:8.484px;}",".fv40uqz{--fui-positioning-arrow-offset:-4.242px;}",".f1u2r49w{background-color:inherit;}",".fqhgnl{background-clip:content-box;}",".f17bz04i{border-bottom-left-radius:var(--borderRadiusSmall);}",".f36o3x3{transform:rotate(var(--fui-positioning-arrow-angle));}",".fzofk8q{height:var(--fui-positioning-arrow-height);}",".f1wbx1ie{width:var(--fui-positioning-arrow-height);}",'.f1wl9k8s::before{content:"";}',".f1aocrix::before{display:block;}",".f1ljr5q2::before{background-color:inherit;}",[".f155f1qt::before{margin:-1px;}",{p:-1}],".f9mhzq7::before{width:100%;}",".fr6rhvx::before{height:100%;}",[".f1kc0wz4::before{border:1px solid var(--colorTransparentStroke);}",{p:-2}],".fgq90dz::before{border-bottom-left-radius:var(--borderRadiusSmall);}",".fq0y47f::before{clip-path:polygon(0% 0%, 100% 100%, 0% 100%);}",'[data-popper-placement^="top"] .f1pwrbz6{bottom:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="top"] .f1hxxcvm{--fui-positioning-arrow-angle:-45deg;}','[data-popper-placement^="right"] .fw8rgyo{left:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="right"] .f1wnzycx{--fui-positioning-arrow-angle:45deg;}','[data-popper-placement^="bottom"] .f1730wal{top:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="bottom"] .f1fy4ixr{--fui-positioning-arrow-angle:135deg;}','[data-popper-placement^="left"] .fobkauc{right:var(--fui-positioning-arrow-offset);}','[data-popper-placement^="left"] .f16bqv1l{--fui-positioning-arrow-angle:225deg;}']}),R=e=>{const t=(e=>{var t,o,T,x,_,I;const E=(0,a.n)(),B=(0,d.wR)(),{targetDocument:A}=(0,l.Y)(),[R,M]=(0,h.Z)(),{appearance:D="normal",children:P,content:F,withArrow:O=!1,positioning:N="above",onVisibleChange:q,relationship:j,showDelay:L=250,hideDelay:z=250,mountNode:H}=e,[W,U]=(0,g.i)({state:e.visible,initialState:!1}),G=i.useCallback(((e,t)=>{M(),U((o=>(t.visible!==o&&(null==q||q(e,t)),t.visible)))}),[M,U,q]),V={withArrow:O,positioning:N,showDelay:L,hideDelay:z,relationship:j,visible:W,shouldRenderTooltip:W,appearance:D,mountNode:H,components:{content:"div"},content:p.Gk(F,{defaultProps:{role:"tooltip"},elementType:"div"})};V.content.id=(0,f.Bi)("tooltip-",V.content.id);const $={enabled:V.visible,arrowPadding:2*S.Q,position:"above",align:"center",offset:4,...(0,n.P)(V.positioning)};V.withArrow&&($.offset=(0,r.H)($.offset,S.d));const{targetRef:K,containerRef:J,arrowRef:Y}=(0,s.T)($);V.content.ref=(0,m.a)(V.content.ref,J),V.arrowRef=Y,(0,v.E)((()=>{if(W){var e;const t={hide:e=>G(void 0,{visible:!1,documentKeyboardEvent:e})};null===(e=E.visibleTooltip)||void 0===e||e.hide(),E.visibleTooltip=t;const o=e=>{e.key!==k.uf9||e.defaultPrevented||(t.hide(e),e.preventDefault())};return null==A||A.addEventListener("keydown",o,{capture:!0}),()=>{E.visibleTooltip===t&&(E.visibleTooltip=void 0),null==A||A.removeEventListener("keydown",o,{capture:!0})}}}),[E,A,W,G]);const Q=i.useRef(!1),Z=i.useCallback((e=>{if("focus"===e.type&&Q.current)return void(Q.current=!1);const t=E.visibleTooltip?0:V.showDelay;R((()=>{G(e,{visible:!0})}),t),e.persist()}),[R,G,V.showDelay,E]),X=(0,c.B)(),[ee]=i.useState((()=>{const e=e=>{var t;(null===(t=e.detail)||void 0===t?void 0:t.isFocusedProgrammatically)&&!X()&&(Q.current=!0)};let t=null;return o=>{null==t||t.removeEventListener(u.Oy,e),null==o||o.addEventListener(u.Oy,e),t=o}})),te=i.useCallback((e=>{let t=V.hideDelay;"blur"===e.type&&(t=0,Q.current=(null==A?void 0:A.activeElement)===e.target),R((()=>{G(e,{visible:!1})}),t),e.persist()}),[R,G,V.hideDelay,A]);V.content.onPointerEnter=(0,b.p)(V.content.onPointerEnter,M),V.content.onPointerLeave=(0,b.p)(V.content.onPointerLeave,te),V.content.onFocus=(0,b.p)(V.content.onFocus,M),V.content.onBlur=(0,b.p)(V.content.onBlur,te);const oe=(0,y.h)(P),ie={},ne="menu"===(null==oe||null===(t=oe.props)||void 0===t?void 0:t["aria-haspopup"])&&(null==oe||null===(o=oe.props)||void 0===o?void 0:o["aria-expanded"]);return"label"===j?"string"==typeof V.content.children?ie["aria-label"]=V.content.children:(ie["aria-labelledby"]=V.content.id,V.shouldRenderTooltip=!0):"description"===j&&(ie["aria-describedby"]=V.content.id,V.shouldRenderTooltip=!0),(B||ne)&&(V.shouldRenderTooltip=!1),V.children=(0,w.L)(P,{...ie,...null==oe?void 0:oe.props,ref:(0,m.a)(null==oe?void 0:oe.ref,ee,void 0===$.target?K:void 0),onPointerEnter:(0,C.D)((0,b.p)(null==oe||null===(T=oe.props)||void 0===T?void 0:T.onPointerEnter,Z)),onPointerLeave:(0,C.D)((0,b.p)(null==oe||null===(x=oe.props)||void 0===x?void 0:x.onPointerLeave,te)),onFocus:(0,C.D)((0,b.p)(null==oe||null===(_=oe.props)||void 0===_?void 0:_.onFocus,Z)),onBlur:(0,C.D)((0,b.p)(null==oe||null===(I=oe.props)||void 0===I?void 0:I.onBlur,te))}),V})(e);return(e=>{const t=A();e.content.className=(0,B.z)("fui-Tooltip__content",t.root,"inverted"===e.appearance&&t.inverted,e.visible&&t.visible,e.content.className),e.arrowClassName=t.arrow})(t),(0,I.$e)("useTooltipStyles_unstable")(t),(e=>((0,_.C)(e),(0,T.FD)(i.Fragment,{children:[e.children,e.shouldRenderTooltip&&(0,T.Y)(x.Z,{mountNode:e.mountNode,children:(0,T.FD)(e.content,{children:[e.withArrow&&(0,T.Y)("div",{ref:e.arrowRef,className:e.arrowClassName}),e.content.children]})})]})))(t)};R.displayName="Tooltip",R.isFluentTriggerComponent=!0},33884:(e,t,o)=>{"use strict";o.d(t,{Q:()=>n,d:()=>i});const i=6,n=4},69602:(e,t,o)=>{"use strict";o.d(t,{X:()=>n});var i=o(95734);function n(e,t){const o=i.useRef(void 0),n=i.useCallback(((i,n)=>(void 0!==o.current&&t(o.current),o.current=e(i,n),o.current)),[t,e]),r=i.useCallback((()=>{void 0!==o.current&&(t(o.current),o.current=void 0)}),[t]);return i.useEffect((()=>r),[r]),[n,r]}},50007:(e,t,o)=>{"use strict";o.d(t,{i:()=>n});var i=o(95734);const n=e=>{const[t,o]=i.useState((()=>void 0===e.defaultState?e.initialState:"function"==typeof e.defaultState?e.defaultState():e.defaultState)),n=i.useRef(e.state);i.useEffect((()=>{n.current=e.state}),[e.state]);const s=i.useCallback((e=>{(function(e){return"function"==typeof e})(e)&&e(n.current)}),[]);return r(e.state)?[e.state,s]:[t,o]},r=e=>{const[t]=i.useState((()=>void 0!==e));return t}},19720:(e,t,o)=>{"use strict";o.d(t,{D:()=>r});var i=o(95734);if(3023==o.j)var n=o(44877);const r=e=>{const t=i.useRef((()=>{throw new Error("Cannot call an event handler while rendering")}));return(0,n.E)((()=>{t.current=e}),[e]),i.useCallback(((...e)=>(0,t.current)(...e)),[t])}},46009:(e,t,o)=>{"use strict";o.d(t,{W:()=>a});var i=o(95734);if(3023==o.j)var n=o(19720);if(3023==o.j)var r=o(71057);const s=(e,t)=>!!(null==e?void 0:e.contains(t)),a=e=>{const{targetDocument:t}=(0,r.Y)(),o=null==t?void 0:t.defaultView,{refs:a,callback:c,element:d,disabled:h,disabledFocusOnIframe:g,contains:p=s}=e,f=i.useRef(void 0);u({element:d,disabled:g||h,callback:c,refs:a,contains:p});const m=i.useRef(!1),v=(0,n.D)((e=>{if(m.current)return void(m.current=!1);const t=e.composedPath()[0];a.every((e=>!p(e.current||null,t)))&&!h&&c(e)})),b=(0,n.D)((e=>{m.current=a.some((t=>p(t.current||null,e.target)))}));i.useEffect((()=>{if(h)return;let e=l(o);const t=t=>{t!==e?v(t):e=void 0};return null==d||d.addEventListener("click",t,!0),null==d||d.addEventListener("touchstart",t,!0),null==d||d.addEventListener("contextmenu",t,!0),null==d||d.addEventListener("mousedown",b,!0),f.current=null==o?void 0:o.setTimeout((()=>{e=void 0}),1),()=>{null==d||d.removeEventListener("click",t,!0),null==d||d.removeEventListener("touchstart",t,!0),null==d||d.removeEventListener("contextmenu",t,!0),null==d||d.removeEventListener("mousedown",b,!0),null==o||o.clearTimeout(f.current),e=void 0}}),[v,d,h,b,o])},l=e=>{var t,o,i;if(e)return"object"==typeof e.window&&e.window===e?e.event:null!==(i=null===(o=e.ownerDocument)||void 0===o||null===(t=o.defaultView)||void 0===t?void 0:t.event)&&void 0!==i?i:void 0},c="fuiframefocus",u=e=>{const{disabled:t,element:o,callback:r,contains:a=s,pollDuration:l=1e3,refs:u}=e,d=i.useRef(),h=(0,n.D)((e=>{u.every((t=>!a(t.current||null,e.target)))&&!t&&r(e)}));i.useEffect((()=>{if(!t)return null==o||o.addEventListener(c,h,!0),()=>{null==o||o.removeEventListener(c,h,!0)}}),[o,t,h]),i.useEffect((()=>{var e;if(!t)return d.current=null==o||null===(e=o.defaultView)||void 0===e?void 0:e.setInterval((()=>{const e=null==o?void 0:o.activeElement;if("IFRAME"===(null==e?void 0:e.tagName)||"WEBVIEW"===(null==e?void 0:e.tagName)){const t=new CustomEvent(c,{bubbles:!0});e.dispatchEvent(t)}}),l),()=>{var e;null==o||null===(e=o.defaultView)||void 0===e||e.clearTimeout(d.current)}}),[o,t,l])}},81564:(e,t,o)=>{"use strict";o.d(t,{z:()=>r});var i=o(95734);if(3023==o.j)var n=o(19720);const r=e=>{const{refs:t,callback:o,element:r,disabled:s,contains:a}=e,l=(0,n.D)((e=>{const i=a||((e,t)=>!!(null==e?void 0:e.contains(t))),n=e.composedPath()[0];t.every((e=>!i(e.current||null,n)))&&!s&&o(e)}));i.useEffect((()=>{if(!s)return null==r||r.addEventListener("wheel",l),null==r||r.addEventListener("touchmove",l),()=>{null==r||r.removeEventListener("wheel",l),null==r||r.removeEventListener("touchmove",l)}}),[l,r,s])}},17523:(e,t,o)=>{"use strict";if(o.d(t,{Z:()=>a}),3023==o.j)var i=o(69602);if(3023==o.j)var n=o(71057);const r=e=>-1,s=e=>{};function a(){const{targetDocument:e}=(0,n.Y)(),t=null==e?void 0:e.defaultView,o=t?t.setTimeout:r,a=t?t.clearTimeout:s;return(0,i.X)(o,a)}},2766:(e,t,o)=>{"use strict";if(o.d(t,{s:()=>n}),3023==o.j)var i=o(45935);function n(e,t){if(!e||!t)return!1;if(e===t)return!0;{const o=new WeakSet;for(;t;){const n=(0,i.P)(t,{skipVirtual:o.has(t)});if(o.add(t),n===e)return!0;t=n}}return!1}},45935:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>n}),3023==o.j)var i=o(68874);function n(e,t={}){if(!e)return null;if(!t.skipVirtual){const t=function(e){return(0,i.q)(e)&&e._virtual.parent||null}(e);if(t)return t}const o=e.parentNode;return o&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o}},68874:(e,t,o)=>{"use strict";function i(e){return e&&!!e._virtual}o.d(t,{q:()=>i})},26092:(e,t,o)=>{"use strict";function i(e,t){if(!e)return;const o=e;o._virtual||(o._virtual={}),o._virtual.parent=t}o.d(t,{g:()=>i})},84485:(e,t,o)=>{"use strict";o.d(t,{g:()=>n});var i=o(95734);function n(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&!i.isValidElement(e)}},77114:(e,t,o)=>{"use strict";if(o.d(t,{N:()=>a}),3023==o.j)var i=o(11152);if(3023==o.j)var n=o(98721);const r=e=>(e(0),0),s=e=>e;function a(){const{targetDocument:e}=(0,n.Y)(),t=null==e?void 0:e.defaultView,o=t?t.requestAnimationFrame:r,a=t?t.cancelAnimationFrame:s;return(0,i.X)(o,a)}},36049:(e,t,o)=>{"use strict";o.d(t,{i:()=>n});var i=o(95734);const n=e=>{const[t,o]=i.useState((()=>void 0===e.defaultState?e.initialState:"function"==typeof e.defaultState?e.defaultState():e.defaultState)),n=i.useRef(e.state);i.useEffect((()=>{n.current=e.state}),[e.state]);const s=i.useCallback((e=>{(function(e){return"function"==typeof e})(e)&&e(n.current)}),[]);return r(e.state)?[e.state,s]:[t,o]},r=e=>{const[t]=i.useState((()=>void 0!==e));return t}},32726:(e,t,o)=>{"use strict";o.d(t,{D:()=>r});var i=o(95734);if(3023==o.j)var n=o(93851);const r=e=>{const t=i.useRef((()=>{throw new Error("Cannot call an event handler while rendering")}));return(0,n.E)((()=>{t.current=e}),[e]),i.useCallback(((...e)=>(0,t.current)(...e)),[t])}},86642:(e,t,o)=>{"use strict";o.d(t,{t:()=>n});var i=o(95734);function n(){const e=i.useRef(!0);return e.current?(e.current=!1,!0):e.current}},93851:(e,t,o)=>{"use strict";o.d(t,{E:()=>n});var i=o(95734);const n=(0,o(20101).S)()?i.useLayoutEffect:i.useEffect},38523:(e,t,o)=>{"use strict";o.d(t,{a:()=>n});var i=o(95734);function n(...e){const t=i.useCallback((o=>{t.current=o;for(const t of e)"function"==typeof t?t(o):t&&(t.current=o)}),[...e]);return t}},2527:(e,t,o)=>{"use strict";o.d(t,{W:()=>a});var i=o(95734);if(3023==o.j)var n=o(32726);if(3023==o.j)var r=o(98721);const s=(e,t)=>!!(null==e?void 0:e.contains(t)),a=e=>{const{targetDocument:t}=(0,r.Y)(),o=null==t?void 0:t.defaultView,{refs:a,callback:c,element:d,disabled:h,disabledFocusOnIframe:g,contains:p=s}=e,f=i.useRef(void 0);u({element:d,disabled:g||h,callback:c,refs:a,contains:p});const m=i.useRef(!1),v=(0,n.D)((e=>{if(m.current)return void(m.current=!1);const t=e.composedPath()[0];a.every((e=>!p(e.current||null,t)))&&!h&&c(e)})),b=(0,n.D)((e=>{m.current=a.some((t=>p(t.current||null,e.target)))}));i.useEffect((()=>{if(h)return;let e=l(o);const t=t=>{t!==e?v(t):e=void 0};return null==d||d.addEventListener("click",t,!0),null==d||d.addEventListener("touchstart",t,!0),null==d||d.addEventListener("contextmenu",t,!0),null==d||d.addEventListener("mousedown",b,!0),f.current=null==o?void 0:o.setTimeout((()=>{e=void 0}),1),()=>{null==d||d.removeEventListener("click",t,!0),null==d||d.removeEventListener("touchstart",t,!0),null==d||d.removeEventListener("contextmenu",t,!0),null==d||d.removeEventListener("mousedown",b,!0),null==o||o.clearTimeout(f.current),e=void 0}}),[v,d,h,b,o])},l=e=>{var t,o,i;if(e)return"object"==typeof e.window&&e.window===e?e.event:null!==(i=null===(o=e.ownerDocument)||void 0===o||null===(t=o.defaultView)||void 0===t?void 0:t.event)&&void 0!==i?i:void 0},c="fuiframefocus",u=e=>{const{disabled:t,element:o,callback:r,contains:a=s,pollDuration:l=1e3,refs:u}=e,d=i.useRef(),h=(0,n.D)((e=>{u.every((t=>!a(t.current||null,e.target)))&&!t&&r(e)}));i.useEffect((()=>{if(!t)return null==o||o.addEventListener(c,h,!0),()=>{null==o||o.removeEventListener(c,h,!0)}}),[o,t,h]),i.useEffect((()=>{var e;if(!t)return d.current=null==o||null===(e=o.defaultView)||void 0===e?void 0:e.setInterval((()=>{const e=null==o?void 0:o.activeElement;if("IFRAME"===(null==e?void 0:e.tagName)||"WEBVIEW"===(null==e?void 0:e.tagName)){const t=new CustomEvent(c,{bubbles:!0});e.dispatchEvent(t)}}),l),()=>{var e;null==o||null===(e=o.defaultView)||void 0===e||e.clearTimeout(d.current)}}),[o,t,l])}},61394:(e,t,o)=>{"use strict";o.d(t,{z:()=>r});var i=o(95734);if(3023==o.j)var n=o(32726);const r=e=>{const{refs:t,callback:o,element:r,disabled:s,contains:a}=e,l=(0,n.D)((e=>{const i=a||((e,t)=>!!(null==e?void 0:e.contains(t))),n=e.composedPath()[0];t.every((e=>!i(e.current||null,n)))&&!s&&o(e)}));i.useEffect((()=>{if(!s)return null==r||r.addEventListener("wheel",l),null==r||r.addEventListener("touchmove",l),()=>{null==r||r.removeEventListener("wheel",l),null==r||r.removeEventListener("touchmove",l)}}),[l,r,s])}},77442:(e,t,o)=>{"use strict";o.d(t,{L:()=>r});var i=o(95734);if(3023==o.j)var n=o(79684);function r(e,t){return"function"==typeof e?e(t):e?s(e,t):e||null}function s(e,t){if(!i.isValidElement(e)||e.type===i.Fragment)throw new Error("A trigger element must be a single element for this component. Please ensure that you're not using React Fragments.");if((0,n.Z)(e)){const o=s(e.props.children,t);return i.cloneElement(e,void 0,o)}return i.cloneElement(e,t)}},74396:(e,t,o)=>{"use strict";o.d(t,{h:()=>r});var i=o(95734);if(3023==o.j)var n=o(79684);function r(e){return i.isValidElement(e)?(0,n.Z)(e)?r(e.props.children):e:null}},79684:(e,t,o)=>{"use strict";function i(e){return Boolean(e.type.isFluentTriggerComponent)}o.d(t,{Z:()=>i}),o(95734)},94756:(e,t,o)=>{"use strict";function i(e,t){var o;const i=e;var n;return Boolean((null==i||null===(o=i.ownerDocument)||void 0===o?void 0:o.defaultView)&&i instanceof i.ownerDocument.defaultView[null!==(n=null==t?void 0:t.constructorName)&&void 0!==n?n:"HTMLElement"])}o.d(t,{s:()=>i})},76182:(e,t,o)=>{"use strict";function i(e,t){const o={};for(const i in e)-1===t.indexOf(i)&&e.hasOwnProperty(i)&&(o[i]=e[i]);return o}o.d(t,{c:()=>i})},12500:(e,t,o)=>{"use strict";if(o.d(t,{s:()=>n}),3023==o.j)var i=o(77073);function n(e,t){if(!e||!t)return!1;if(e===t)return!0;{const o=new WeakSet;for(;t;){const n=(0,i.P)(t,{skipVirtual:o.has(t)});if(o.add(t),n===e)return!0;t=n}}return!1}},77073:(e,t,o)=>{"use strict";if(o.d(t,{P:()=>n}),3023==o.j)var i=o(19164);function n(e,t={}){if(!e)return null;if(!t.skipVirtual){const t=function(e){return(0,i.q)(e)&&e._virtual.parent||null}(e);if(t)return t}const o=e.parentNode;return o&&o.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.host:o}},19164:(e,t,o)=>{"use strict";function i(e){return e&&!!e._virtual}o.d(t,{q:()=>i})},29146:(e,t,o)=>{"use strict";function i(e,t){if(!e)return;const o=e;o._virtual||(o._virtual={}),o._virtual.parent=t}o.d(t,{g:()=>i})},57144:(e,t,o)=>{"use strict";o.d(t,{C:()=>s,J:()=>l});var i=o(30206),n=o(44207),r=o(413),s=36,a=(0,n.L6)(0,n.mm),l=(0,r.J9)((function(e){var t,o,r,l,c,u=e.semanticColors,d=e.fonts,h=e.palette,g=u.menuItemBackgroundHovered,p=u.menuItemTextHovered,f=u.menuItemBackgroundPressed,m=u.bodyDivider,v={item:[d.medium,{color:u.bodyText,position:"relative",boxSizing:"border-box"}],divider:{display:"block",height:"1px",backgroundColor:m,position:"relative"},root:[(0,n.gm)(e),d.medium,{color:u.bodyText,backgroundColor:"transparent",border:"none",width:"100%",height:s,lineHeight:s,display:"block",cursor:"pointer",padding:"0px 8px 0 4px",textAlign:"left"}],rootDisabled:{color:u.disabledBodyText,cursor:"default",pointerEvents:"none",selectors:(t={},t[n.up]={color:"GrayText",opacity:1},t)},rootHovered:{backgroundColor:g,color:p,selectors:{".ms-ContextualMenu-icon":{color:h.themeDarkAlt},".ms-ContextualMenu-submenuIcon":{color:h.neutralPrimary}}},rootFocused:{backgroundColor:h.white},rootChecked:{selectors:{".ms-ContextualMenu-checkmarkIcon":{color:h.neutralPrimary}}},rootPressed:{backgroundColor:f,selectors:{".ms-ContextualMenu-icon":{color:h.themeDark},".ms-ContextualMenu-submenuIcon":{color:h.neutralPrimary}}},rootExpanded:{backgroundColor:f,color:u.bodyTextChecked,selectors:(o={".ms-ContextualMenu-submenuIcon":(r={},r[n.up]={color:"inherit"},r)},o[n.up]=(0,i.__assign)({},(0,n.Qg)()),o)},linkContent:{whiteSpace:"nowrap",height:"inherit",display:"flex",alignItems:"center",maxWidth:"100%"},anchorLink:{padding:"0px 8px 0 4px",textRendering:"auto",color:"inherit",letterSpacing:"normal",wordSpacing:"normal",textTransform:"none",textIndent:"0px",textShadow:"none",textDecoration:"none",boxSizing:"border-box"},label:{margin:"0 4px",verticalAlign:"middle",display:"inline-block",flexGrow:"1",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},secondaryText:{color:e.palette.neutralSecondary,paddingLeft:"20px",textAlign:"right"},icon:{display:"inline-block",minHeight:"1px",maxHeight:s,fontSize:n.fF.medium,width:n.fF.medium,margin:"0 4px",verticalAlign:"middle",flexShrink:"0",selectors:(l={},l[a]={fontSize:n.fF.large,width:n.fF.large},l)},iconColor:{color:u.menuIcon},iconDisabled:{color:u.disabledBodyText},checkmarkIcon:{color:u.bodySubtext},subMenuIcon:{height:s,lineHeight:s,color:h.neutralSecondary,textAlign:"center",display:"inline-block",verticalAlign:"middle",flexShrink:"0",fontSize:n.fF.small,selectors:(c={":hover":{color:h.neutralPrimary},":active":{color:h.neutralPrimary}},c[a]={fontSize:n.fF.medium},c)},splitButtonFlexContainer:[(0,n.gm)(e),{display:"flex",height:s,flexWrap:"nowrap",justifyContent:"center",alignItems:"flex-start"}]};return(0,n.TW)(v)}))},85859:(e,t,o)=>{"use strict";o.d(t,{Y:()=>T});var i=o(30206),n=o(95734),r=o(71170),s=o(23401),a=o(19440),l=o(17875),c=function(e){for(var t=e.activeElement;null==t?void 0:t.shadowRoot;)t=t.shadowRoot.activeElement;return t},u=function(e){var t=e.target;return t&&t.shadowRoot&&(t=e.composedPath()[0]),t},d=o(6657),h=o(11192),g=o(13668),p=o(28482),f=o(15289),m=o(54465),v=o(54937),b=o(66e3);function y(e){var t=n.useRef((function(){throw new Error("Cannot call an event handler while rendering")}));return(0,b.E)((function(){t.current=e}),[e]),(0,m.d)((function(){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.current.apply(void 0,e)}}))}var w=o(17954),C=o(18465),S=o(43488),k={disabled:!1,disableFirstFocus:!1,forceFocusInsideTrap:!0,isClickableOutsideFocusTrap:!1,"data-tabster":'{"uncontrolled": {"completely": true}}'},T=n.forwardRef((function(e,t){var o,b=n.useRef(null),x=n.useRef(null),_=n.useRef(null),I=(0,p.a)(b,t),E=(0,C.ZY)(),B=(0,S.bX)(),A=(0,r.h)(),R=null===(o=(0,f.Z)(!1))||void 0===o||o,M=(0,s.N)(k,e),D=(0,m.d)({hasFocus:!1,focusStackId:(0,v.B)("ftz-",M.id)}),P=M.children,F=M.componentRef,O=M.disabled,N=M.disableFirstFocus,q=M.forceFocusInsideTrap,j=M.focusPreviouslyFocusedInnerElement,L=M.firstFocusableSelector,z=M.firstFocusableTarget,H=M.disableRestoreFocus,W=void 0===H?M.ignoreExternalFocusing:H,U=M.isClickableOutsideFocusTrap,G=M.enableAriaHiddenSiblings,V={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:O?-1:0,"data-is-visible":!0,"data-is-focus-trap-zone-bumper":!0},$=n.useCallback((function(e){e!==x.current&&e!==_.current&&(0,a.lo)(e)}),[]),K=y((function(){if(b.current){var e=D.previouslyFocusedElementInTrapZone;if(j&&e&&(0,l.s)(b.current,e))$(e);else{var t=null;if("string"==typeof z)t=b.current.querySelector(z);else if(z)t=z(b.current);else if(L){var o="string"==typeof L?L:L();t=b.current.querySelector("."+o)}t||(t=(0,a.eX)(b.current,b.current.firstChild,!1,!1,!1,!0,void 0,void 0,void 0,A)),t&&$(t)}}})),J=function(e){if(!O&&b.current){var t=e===D.hasFocus?(0,a.Cm)(b.current,_.current,!0,!1,A):(0,a.oR)(b.current,x.current,!0,!1,A);t&&(t===x.current||t===_.current?K():t.focus())}},Y=y((function(e){if(T.focusStack=T.focusStack.filter((function(e){return D.focusStackId!==e})),E){var t=E.activeElement;W||"function"!=typeof(null==e?void 0:e.focus)||!(0,l.s)(b.current,t)&&t!==E.body&&!t.shadowRoot||$(e)}})),Q=y((function(e){if(!O&&D.focusStackId===T.focusStack.slice(-1)[0]){var t=u(e);t&&!(0,l.s)(b.current,t)&&(E&&c(E)===E.body?setTimeout((function(){E&&c(E)===E.body&&(K(),D.hasFocus=!0)}),0):(K(),D.hasFocus=!0),e.preventDefault(),e.stopPropagation())}}));return n.useEffect((function(){var e=[];return q&&e.push((0,d.on)(B,"focus",Q,!0)),U||e.push((0,d.on)(B,"click",Q,!0)),function(){e.forEach((function(e){return e()}))}}),[q,U,B]),n.useEffect((function(){if(!O&&(R||q)&&b.current){T.focusStack.push(D.focusStackId);var e=M.elementToFocusOnDismiss||c(E);return N||(0,l.s)(b.current,e)||K(),function(){return Y(e)}}}),[q,O]),n.useEffect((function(){if(!O&&G)return(0,h.q)(b.current)}),[O,G,b]),(0,w.i)((function(){delete D.previouslyFocusedElementInTrapZone})),function(e,t,o){n.useImperativeHandle(e,(function(){return{get previouslyFocusedElement(){return t},focus:o}}),[o,t])}(F,D.previouslyFocusedElementInTrapZone,K),n.createElement("div",(0,i.__assign)({"aria-labelledby":M.ariaLabelledBy},(0,g.G1)(M,g.JM),{ref:I,onFocusCapture:function(e){var t;null===(t=M.onFocusCapture)||void 0===t||t.call(M,e),e.target===x.current?J(!0):e.target===_.current&&J(!1),D.hasFocus=!0,e.target!==e.currentTarget&&e.target!==x.current&&e.target!==_.current&&(D.previouslyFocusedElementInTrapZone=u(e.nativeEvent))},onBlurCapture:function(e){var t;null===(t=M.onBlurCapture)||void 0===t||t.call(M,e);var o=e.relatedTarget;null===e.relatedTarget&&(o=c(E)),(0,l.s)(b.current,o)||(D.hasFocus=!1)}}),n.createElement("div",(0,i.__assign)({},V,{ref:x})),P,n.createElement("div",(0,i.__assign)({},V,{ref:_})))}));T.displayName="FocusTrapZone",T.focusStack=[]},9280:(e,t,o)=>{"use strict";o.d(t,{_:()=>v});var i=o(82330),n=o(30206),r=o(95734),s=o(30205),a=o(13668),l=o(34916),c=o(66e3),u=o(28482),d=(0,s.Z)(),h=/\.svg$/i,g=r.forwardRef((function(e,t){var o=r.useRef(),i=r.useRef(),s=function(e,t){var o=e.onLoadingStateChange,i=e.onLoad,n=e.onError,s=e.src,a=r.useState(l.P6.notLoaded),u=a[0],d=a[1];(0,c.E)((function(){d(l.P6.notLoaded)}),[s]),r.useEffect((function(){u===l.P6.notLoaded&&t.current&&(s&&t.current.naturalWidth>0&&t.current.naturalHeight>0||t.current.complete&&h.test(s))&&d(l.P6.loaded)})),r.useEffect((function(){null==o||o(u)}),[u]);var g=r.useCallback((function(e){null==i||i(e),s&&d(l.P6.loaded)}),[s,i]),p=r.useCallback((function(e){null==n||n(e),d(l.P6.error)}),[n]);return[u,g,p]}(e,i),g=s[0],p=s[1],f=s[2],m=(0,a.G1)(e,a.xM,["width","height"]),v=e.src,b=e.alt,y=e.width,w=e.height,C=e.shouldFadeIn,S=void 0===C||C,k=e.shouldStartVisible,T=e.className,x=e.imageFit,_=e.role,I=e.maximizeFrame,E=e.styles,B=e.theme,A=e.loading,R=function(e,t,o,i){var n=r.useRef(t),s=r.useRef();return(void 0===s||n.current===l.P6.notLoaded&&t===l.P6.loaded)&&(s.current=function(e,t,o,i){var n=e.imageFit,r=e.width,s=e.height;if(void 0!==e.coverStyle)return e.coverStyle;if(t===l.P6.loaded&&(n===l.N_.cover||n===l.N_.contain||n===l.N_.centerContain||n===l.N_.centerCover)&&o.current&&i.current){var a;if(a="number"==typeof r&&"number"==typeof s&&n!==l.N_.centerContain&&n!==l.N_.centerCover?r/s:i.current.clientWidth/i.current.clientHeight,o.current.naturalWidth/o.current.naturalHeight>a)return l.Aw.landscape}return l.Aw.portrait}(e,t,o,i)),n.current=t,s.current}(e,g,i,o),M=d(E,{theme:B,className:T,width:y,height:w,maximizeFrame:I,shouldFadeIn:S,shouldStartVisible:k,isLoaded:g===l.P6.loaded||g===l.P6.notLoaded&&e.shouldStartVisible,isLandscape:R===l.Aw.landscape,isCenter:x===l.N_.center,isCenterContain:x===l.N_.centerContain,isCenterCover:x===l.N_.centerCover,isContain:x===l.N_.contain,isCover:x===l.N_.cover,isNone:x===l.N_.none,isError:g===l.P6.error,isNotImageFit:void 0===x});return r.createElement("div",{className:M.root,style:{width:y,height:w},ref:o},r.createElement("img",(0,n.__assign)({},m,{onLoad:p,onError:f,key:"fabricImage"+e.src||"",className:M.image,ref:(0,u.a)(i,t),src:v,alt:b,role:_,loading:A})))}));g.displayName="ImageBase";var p=o(44207),f=o(58086),m={root:"ms-Image",rootMaximizeFrame:"ms-Image--maximizeFrame",image:"ms-Image-image",imageCenter:"ms-Image-image--center",imageContain:"ms-Image-image--contain",imageCover:"ms-Image-image--cover",imageCenterContain:"ms-Image-image--centerContain",imageCenterCover:"ms-Image-image--centerCover",imageNone:"ms-Image-image--none",imageLandscape:"ms-Image-image--landscape",imagePortrait:"ms-Image-image--portrait"},v=(0,i.I)(g,(function(e){var t=e.className,o=e.width,i=e.height,n=e.maximizeFrame,r=e.isLoaded,s=e.shouldFadeIn,a=e.shouldStartVisible,l=e.isLandscape,c=e.isCenter,u=e.isContain,d=e.isCover,h=e.isCenterContain,g=e.isCenterCover,v=e.isNone,b=e.isError,y=e.isNotImageFit,w=e.theme,C=(0,p.Km)(m,w),S={position:"absolute",left:"50% /* @noflip */",top:"50%",transform:"translate(-50%,-50%)"},k=(0,f.z)(),T=void 0!==k&&void 0===k.navigator.msMaxTouchPoints,x=u&&l||d&&!l?{width:"100%",height:"auto"}:{width:"auto",height:"100%"};return{root:[C.root,w.fonts.medium,{overflow:"hidden"},n&&[C.rootMaximizeFrame,{height:"100%",width:"100%"}],r&&s&&!a&&p.lw.fadeIn400,(c||u||d||h||g)&&{position:"relative"},t],image:[C.image,{display:"block",opacity:0},r&&["is-loaded",{opacity:1}],c&&[C.imageCenter,S],u&&[C.imageContain,T&&{width:"100%",height:"100%",objectFit:"contain"},!T&&x,!T&&S],d&&[C.imageCover,T&&{width:"100%",height:"100%",objectFit:"cover"},!T&&x,!T&&S],h&&[C.imageCenterContain,l&&{maxWidth:"100%"},!l&&{maxHeight:"100%"},S],g&&[C.imageCenterCover,l&&{maxHeight:"100%"},!l&&{maxWidth:"100%"},S],v&&[C.imageNone,{width:"auto",height:"auto"}],y&&[!!o&&!i&&{height:"auto",width:"100%"},!o&&!!i&&{height:"100%",width:"auto"},!!o&&!!i&&{height:"100%",width:"100%"}],l&&C.imageLandscape,!l&&C.imagePortrait,!r&&"is-notLoaded",s&&"is-fadeIn",b&&"is-error"]}}),void 0,{scope:"Image"},!0);v.displayName="Image"},34916:(e,t,o)=>{"use strict";var i,n,r;o.d(t,{Aw:()=>n,N_:()=>i,P6:()=>r}),function(e){e[e.center=0]="center",e[e.contain=1]="contain",e[e.cover=2]="cover",e[e.none=3]="none",e[e.centerCover=4]="centerCover",e[e.centerContain=5]="centerContain"}(i||(i={})),function(e){e[e.landscape=0]="landscape",e[e.portrait=1]="portrait"}(n||(n={})),function(e){e[e.notLoaded=0]="notLoaded",e[e.loaded=1]="loaded",e[e.error=2]="error",e[e.errorLoaded=3]="errorLoaded"}(r||(r={}))},66098:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>d}),3023==o.j)var i=o(30206);var n=o(95734);if(3023==o.j)var r=o(54465);if(3023==o.j)var s=o(15289);if(3023==o.j)var a=o(66e3);if(3023==o.j)var l=o(81448);if(3023==o.j)var c=o(22365);if(3023==o.j)var u=o(12963);function d(e){var t=n.useRef(),o=e.keytipProps?(0,i.__assign)({disabled:e.disabled},e.keytipProps):void 0,d=(0,r.d)(c._.getInstance()),h=(0,s.Z)(e);(0,a.E)((function(){t.current&&o&&((null==h?void 0:h.keytipProps)!==e.keytipProps||(null==h?void 0:h.disabled)!==e.disabled)&&d.update(o,t.current)})),(0,a.E)((function(){return o&&(t.current=d.register(o)),function(){o&&d.unregister(o,t.current)}}),[]);var g={ariaDescribedBy:e.ariaDescribedBy,keytipId:void 0};return o&&(g=function(e,t,o){var n=e.addParentOverflow(t),r=(0,l._)(o,(0,u.gt)(n.keySequences)),s=(0,i.__spreadArray)([],n.keySequences,!0);return n.overflowSetSequence&&(s=(0,u.YY)(s,n.overflowSetSequence)),{ariaDescribedBy:r,keytipId:(0,u.Z2)(s)}}(d,o,e.ariaDescribedBy)),g}},69843:(e,t,o)=>{"use strict";o.d(t,{D:()=>i});var i=o(95734).createContext(void 0)},71571:(e,t,o)=>{"use strict";if(o.d(t,{j:()=>u}),3023==o.j)var i=o(30206);var n=o(95734);if(3023==o.j)var r=o(87396);if(3023==o.j)var s=o(67234);if(3023==o.j)var a=o(9414);if(3023==o.j)var l=o(33795);if(3023==o.j)var c=o(69843);var u=function(e){var t=e.customizerContext,o=e.ref,u=e.theme,d=e.as||"div",h="string"==typeof e.as?(0,r._)(e.as,e):e.as===n.Fragment?{children:e.children}:(0,s.cJ)(e,["as"]);return n.createElement(c.D.Provider,{value:u},n.createElement(a.z.Provider,{value:t},n.createElement(l.N,{providerRef:o},n.createElement(d,(0,i.__assign)({},h)))))}},80470:(e,t,o)=>{"use strict";o.d(t,{K:()=>l});var i=o(83702),n=o(68678),r=o(1798),s=o(76437),a=0,l={reset:function(){i.nr.getInstance().onReset((function(){return a++}))},getId:function(){return a},renderStyles:function(e,t){return(0,n.L)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return(0,r.n)(e)},renderKeyframes:function(e){return(0,s.i)(e)}}},38331:(e,t,o)=>{"use strict";o.d(t,{D:()=>a});var i=o(95734);if(3023==o.j)var n=o(20683);if(3023==o.j)var r=o(18322);if(3023==o.j)var s=o(69843);var a=function(){var e=i.useContext(s.D),t=(0,n.m)(["theme"]).theme;return e||t||(0,r.a)({})}},73877:(e,t,o)=>{"use strict";if(o.d(t,{T:()=>l}),3023==o.j)var i=o(34484);var n=o(95734);if(3023==o.j)var r=o(38331);if(3023==o.j)var s=o(89416);var a=new Map,l=function(e){var t=e.theme,o=(0,r.D)(),l=e.theme=n.useMemo((function(){var e=(0,i.z)(o,t);return e.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o=[],i=0,n=e;i<n.length;i++){var r=n[i];if(r){var l=r.id||a.get(r);l||(l=(0,s.O)(""),a.set(r,l)),o.push(l)}}return o.join("-")}(o,t),e}),[o,t]);e.customizerContext=n.useMemo((function(){return{customizations:{inCustomizerContext:!0,settings:{theme:l},scopedSettings:l.components||{}}}}),[l]),e.theme.rtl!==o.rtl&&(e.dir=e.theme.rtl?"rtl":"ltr")}},94510:(e,t,o)=>{"use strict";var i;o.d(t,{AR:()=>i,YF:()=>a,kA:()=>c}),o(95734),function(e){e[e.small=0]="small",e[e.medium=1]="medium",e[e.large=2]="large",e[e.xLarge=3]="xLarge",e[e.xxLarge=4]="xxLarge",e[e.xxxLarge=5]="xxxLarge",e[e.unknown=999]="unknown"}(i||(i={}));var n,r,s=3023==o.j?[479,639,1023,1365,1919,99999999]:null;function a(){var e;return null!==(e=null!=n?n:r)&&void 0!==e?e:i.large}function l(e){try{return e.document.documentElement.clientWidth}catch(t){return e.innerWidth}}function c(e){var t=i.small;if(e){try{for(;l(e)>s[t];)t++}catch(e){t=a()}r=t}else{if(void 0===n)throw new Error("Content was rendered in a server environment without providing a default responsive mode. Call setResponsiveMode to define what the responsive mode is.");t=n}return t}},39827:(e,t,o)=>{"use strict";o.d(t,{Cm:()=>l,aR:()=>s,er:()=>a,fy:()=>n,oQ:()=>r,uA:()=>i});var i,n="ktp",r="-",s="data-ktp-target",a="data-ktp-execute-target",l="ktp-layer-id";!function(e){e.KEYTIP_ADDED="keytipAdded",e.KEYTIP_REMOVED="keytipRemoved",e.KEYTIP_UPDATED="keytipUpdated",e.PERSISTED_KEYTIP_ADDED="persistedKeytipAdded",e.PERSISTED_KEYTIP_REMOVED="persistedKeytipRemoved",e.PERSISTED_KEYTIP_EXECUTE="persistedKeytipExecute",e.ENTER_KEYTIP_MODE="enterKeytipMode",e.EXIT_KEYTIP_MODE="exitKeytipMode"}(i||(i={}))},22365:(e,t,o)=>{"use strict";o.d(t,{_:()=>a});var i=o(30206),n=o(9570),r=o(89416),s=o(39827),a=function(){function e(){this.keytips={},this.persistedKeytips={},this.sequenceMapping={},this.inKeytipMode=!1,this.shouldEnterKeytipMode=!0,this.delayUpdatingKeytipChange=!1}return e.getInstance=function(){return this._instance},e.prototype.init=function(e){this.delayUpdatingKeytipChange=e},e.prototype.register=function(e,t){void 0===t&&(t=!1);var o=e;t||(o=this.addParentOverflow(e),this.sequenceMapping[o.keySequences.toString()]=o);var i=this._getUniqueKtp(o);if(t?this.persistedKeytips[i.uniqueID]=i:this.keytips[i.uniqueID]=i,this.inKeytipMode||!this.delayUpdatingKeytipChange){var r=t?s.uA.PERSISTED_KEYTIP_ADDED:s.uA.KEYTIP_ADDED;n.g.raise(this,r,{keytip:o,uniqueID:i.uniqueID})}return i.uniqueID},e.prototype.update=function(e,t){var o=this.addParentOverflow(e),i=this._getUniqueKtp(o,t),r=this.keytips[t];r&&(i.keytip.visible=r.keytip.visible,this.keytips[t]=i,delete this.sequenceMapping[r.keytip.keySequences.toString()],this.sequenceMapping[i.keytip.keySequences.toString()]=i.keytip,!this.inKeytipMode&&this.delayUpdatingKeytipChange||n.g.raise(this,s.uA.KEYTIP_UPDATED,{keytip:i.keytip,uniqueID:i.uniqueID}))},e.prototype.unregister=function(e,t,o){void 0===o&&(o=!1),o?delete this.persistedKeytips[t]:delete this.keytips[t],!o&&delete this.sequenceMapping[e.keySequences.toString()];var i=o?s.uA.PERSISTED_KEYTIP_REMOVED:s.uA.KEYTIP_REMOVED;!this.inKeytipMode&&this.delayUpdatingKeytipChange||n.g.raise(this,i,{keytip:e,uniqueID:t})},e.prototype.enterKeytipMode=function(){n.g.raise(this,s.uA.ENTER_KEYTIP_MODE)},e.prototype.exitKeytipMode=function(){n.g.raise(this,s.uA.EXIT_KEYTIP_MODE)},e.prototype.getKeytips=function(){var e=this;return Object.keys(this.keytips).map((function(t){return e.keytips[t].keytip}))},e.prototype.addParentOverflow=function(e){var t=(0,i.__spreadArray)([],e.keySequences,!0);if(t.pop(),0!==t.length){var o=this.sequenceMapping[t.toString()];if(o&&o.overflowSetSequence)return(0,i.__assign)((0,i.__assign)({},e),{overflowSetSequence:o.overflowSetSequence})}return e},e.prototype.menuExecute=function(e,t){n.g.raise(this,s.uA.PERSISTED_KEYTIP_EXECUTE,{overflowButtonSequences:e,keytipSequences:t})},e.prototype._getUniqueKtp=function(e,t){return void 0===t&&(t=(0,r.O)()),{keytip:(0,i.__assign)({},e),uniqueID:t}},e._instance=new e,e}()},12963:(e,t,o)=>{"use strict";if(o.d(t,{YY:()=>a,Z2:()=>s,gt:()=>l}),3023==o.j)var i=o(30206);if(3023==o.j)var n=o(39827);if(3023==o.j)var r=o(76296);function s(e){return e.reduce((function(e,t){return e+n.oQ+t.split("").join(n.oQ)}),n.fy)}function a(e,t){var o=t.length,n=(0,i.__spreadArray)([],t,!0).pop(),s=(0,i.__spreadArray)([],e,!0);return(0,r.Ty)(s,o-1,n)}function l(e){var t=" "+n.Cm;return e.length?t+" "+s(e):t}},31892:(e,t,o)=>{"use strict";if(o.d(t,{I:()=>n}),3023==o.j)var i=o(57972);function n(e){e.schemes={strong:(0,i.pw)(e),soft:(0,i.uy)(e),neutral:(0,i.h9)(e)}}},57972:(e,t,o)=>{"use strict";if(o.d(t,{h9:()=>s,pw:()=>l,uy:()=>a}),3023==o.j)var i=o(30206);if(3023==o.j)var n=o(27064);function r(e,t,o){var r=(0,n.a)({palette:(0,i.__assign)((0,i.__assign)({},e.palette),t)});return r.semanticColors=(0,i.__assign)((0,i.__assign)({},r.semanticColors),o),(0,i.__assign)((0,i.__assign)({},e),{palette:r.palette,semanticColors:r.semanticColors})}function s(e){var t=(0,n.a)(e),o=t.palette;return r(t,{themeDark:o.themeDarker,themeDarkAlt:o.themeDark,themePrimary:o.themeDarkAlt,themeSecondary:o.themePrimary,themeTertiary:o.themeSecondary,themeLight:o.themeTertiary,themeLighter:o.themeLight,themeLighterAlt:o.themeLighterAlt,neutralQuaternary:o.neutralTertiaryAlt,neutralQuaternaryAlt:o.neutralQuaternary,neutralLight:o.neutralQuaternaryAlt,neutralLighter:o.neutralLight,neutralLighterAlt:o.neutralLight,white:o.neutralLighter},{bodyBackground:o.neutralLighter,bodyStandoutBackground:o.neutralLight,bodyFrameBackground:t.isInverted?o.neutralLighter:o.neutralLight,bodyFrameDivider:t.isInverted?o.neutralQuaternaryAlt:o.neutralLight,bodyText:o.neutralPrimary,bodySubtext:o.neutralSecondary,bodyDivider:o.neutralQuaternaryAlt,focusBorder:o.neutralSecondary,variantBorder:o.neutralLight,variantBorderHovered:o.neutralTertiary,defaultStateBackground:o.neutralLight,actionLink:o.neutralPrimary,actionLinkHovered:o.neutralDark,link:o.themeDarkAlt,linkHovered:o.themeDarker,disabledBackground:t.isInverted?o.neutralLighter:o.neutralLight,disabledText:o.neutralTertiary,disabledBodyText:o.neutralTertiary,disabledBodySubtext:o.neutralTertiaryAlt,inputBorder:o.neutralTertiary,inputBorderHovered:o.neutralPrimary,inputBackground:o.white,inputFocusBorderAlt:o.themePrimary,inputText:o.neutralPrimary,inputTextHovered:o.neutralDark,inputPlaceholderText:o.neutralSecondary,buttonBackground:o.neutralQuaternaryAlt,buttonBackgroundHovered:o.neutralQuaternary,buttonBackgroundPressed:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBackgroundDisabled:o.neutralLight,buttonBorder:o.neutralSecondaryAlt,buttonText:o.neutralPrimary,buttonTextHovered:o.neutralDark,buttonTextPressed:o.neutralDark,buttonTextDisabled:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBorderDisabled:o.neutralLighter,primaryButtonBackground:o.themePrimary,primaryButtonBackgroundHovered:o.themeDarkAlt,primaryButtonBackgroundPressed:o.themeDark,primaryButtonBorder:"transparent",primaryButtonText:o.white,primaryButtonTextHovered:o.white,primaryButtonTextPressed:o.white,accentButtonBackground:o.accent,accentButtonText:o.white,menuBackground:o.white,menuDivider:o.neutralTertiaryAlt,menuItemBackgroundHovered:o.neutralLighter,menuItemBackgroundPressed:o.neutralLight,menuItemText:o.neutralPrimary,menuItemTextHovered:t.isInverted?o.neutralPrimary:o.neutralDark})}function a(e){var t=(0,n.a)(e),o=t.palette;return r(t,{themeDark:o.themeDarker,themeDarkAlt:o.themeDark,themePrimary:o.themeDarkAlt,themeSecondary:o.themePrimary,themeTertiary:o.themeSecondary,themeLight:o.themeTertiary,themeLighter:o.themeLight,themeLighterAlt:o.themeLighter,neutralTertiaryAlt:t.isInverted?o.themeDarker:o.themeDarkAlt,neutralQuaternary:t.isInverted?o.themeDark:o.themePrimary,neutralQuaternaryAlt:t.isInverted?o.themeDarkAlt:o.themeSecondary,neutralLight:t.isInverted?o.themePrimary:o.themeTertiary,neutralLighter:t.isInverted?o.themeSecondary:o.themeLight,neutralLighterAlt:t.isInverted?o.themeTertiary:o.themeLighter,white:t.isInverted?o.themeLight:o.themeLighterAlt},{bodyBackground:t.isInverted?o.themeLight:o.themeLighterAlt,bodyStandoutBackground:t.isInverted?o.themeTertiary:o.themeLighter,bodyFrameBackground:t.isInverted?o.themeLight:o.themeLighter,bodyFrameDivider:t.isInverted?o.neutralQuaternary:o.themeLighter,bodyText:o.neutralPrimary,bodySubtext:o.neutralSecondary,bodyDivider:o.neutralQuaternaryAlt,inputBorder:o.neutralTertiary,inputBackground:o.white,inputForegroundChecked:o.themeLighter,inputText:o.neutralPrimary,inputTextHovered:o.neutralDark,inputPlaceholderText:o.neutralSecondary,focusBorder:o.neutralSecondary,variantBorder:o.neutralLight,variantBorderHovered:o.neutralTertiary,defaultStateBackground:o.neutralLight,actionLink:o.neutralPrimary,actionLinkHovered:o.neutralDark,link:o.themeDarkAlt,linkHovered:o.themeDarker,disabledBackground:o.neutralLight,disabledText:o.neutralTertiary,disabledBodyText:o.neutralTertiary,disabledBodySubtext:o.neutralTertiaryAlt,buttonBackground:o.neutralQuaternaryAlt,buttonBackgroundHovered:o.neutralQuaternary,buttonBackgroundPressed:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBackgroundDisabled:o.neutralLight,buttonBorder:"transparent",buttonText:o.neutralPrimary,buttonTextHovered:o.neutralDark,buttonTextPressed:o.neutralDark,buttonTextDisabled:t.isInverted?o.neutralTertiaryAlt:o.neutralTertiary,buttonBorderDisabled:"transparent",primaryButtonBackground:o.themePrimary,primaryButtonBackgroundHovered:o.themeDarkAlt,primaryButtonBackgroundPressed:o.themeDark,primaryButtonBorder:"transparent",primaryButtonText:o.white,primaryButtonTextHovered:o.white,primaryButtonTextPressed:o.white,accentButtonBackground:o.accent,accentButtonText:o.white,menuBackground:o.white,menuDivider:o.neutralTertiaryAlt,menuItemBackgroundHovered:o.neutralLighter,menuItemBackgroundPressed:o.neutralLight,menuItemText:o.neutralPrimary,menuItemTextHovered:t.isInverted?o.neutralPrimary:o.neutralDark})}function l(e){var t=(0,n.a)(e),o=t.palette,r={themeDarker:o.white,themeDark:o.neutralLighterAlt,themeDarkAlt:o.neutralLighterAlt,themePrimary:o.white,themeSecondary:o.neutralLighter,themeTertiary:o.neutralLight,themeLight:o.neutralQuaternaryAlt,themeLighter:o.neutralQuaternary,themeLighterAlt:o.neutralTertiaryAlt,black:o.neutralLighterAlt,neutralDark:o.neutralLighter,neutralPrimary:o.white,neutralPrimaryAlt:o.neutralLight,neutralSecondary:o.neutralQuaternaryAlt,neutralTertiary:o.neutralQuaternary,neutralTertiaryAlt:o.themeLighterAlt,neutralQuaternary:o.themeLighterAlt,neutralQuaternaryAlt:o.themeLighter,neutralLight:o.themeLight,neutralLighter:o.themeTertiary,neutralLighterAlt:o.themeSecondary,white:o.themePrimary},s={bodyBackground:o.themePrimary,bodyStandoutBackground:o.themeDarkAlt,bodyFrameBackground:t.isInverted?o.themePrimary:o.themeDarkAlt,bodyFrameDivider:t.isInverted?o.themeTertiary:o.themeDarkAlt,bodyText:o.white,bodySubtext:o.white,bodyDivider:o.themeTertiary,inputBorder:o.themeDarkAlt,inputBorderHovered:o.themeDarker,inputBackground:o.white,inputBackgroundChecked:o.white,inputBackgroundCheckedHovered:o.themePrimary,inputForegroundChecked:o.themeDark,inputFocusBorderAlt:o.themeTertiary,inputText:o.neutralPrimary,inputTextHovered:o.neutralDark,inputPlaceholderText:o.neutralSecondary,focusBorder:o.white,variantBorder:o.themeDarkAlt,variantBorderHovered:o.themeDarker,defaultStateBackground:o.neutralLighterAlt,actionLink:o.white,actionLinkHovered:o.white,link:o.white,linkHovered:o.white,disabledBackground:o.themeDarkAlt,disabledText:o.themeTertiary,disabledBodyText:o.neutralQuaternary,disabledBodySubtext:o.neutralTertiaryAlt,buttonBackground:o.themePrimary,buttonBackgroundHovered:o.themeDarkAlt,buttonBackgroundPressed:o.themeDark,buttonBackgroundDisabled:t.isInverted?o.themeLight:o.themeLighter,buttonBorder:o.white,buttonText:o.white,buttonTextHovered:o.white,buttonTextPressed:o.white,buttonTextDisabled:o.themeTertiary,buttonBorderDisabled:"transparent",primaryButtonBackground:o.white,primaryButtonBackgroundHovered:t.isInverted?o.themeLight:o.themeLighter,primaryButtonBackgroundPressed:t.isInverted?o.themeTertiary:o.themeLight,primaryButtonBorder:"transparent",primaryButtonText:t.isInverted?o.neutralPrimary:o.themePrimary,primaryButtonTextHovered:t.isInverted?o.neutralDark:o.themeDark,primaryButtonTextPressed:t.isInverted?o.neutralDark:o.themeDark,accentButtonBackground:o.white,accentButtonText:t.isInverted?o.neutralPrimary:o.themePrimary,menuBackground:o.themePrimary,menuDivider:o.neutralTertiaryAlt,menuItemBackgroundHovered:o.themeTertiary,menuItemBackgroundPressed:o.themeLight,menuItemText:o.neutralPrimary,menuItemTextHovered:t.isInverted?o.white:o.neutralLighter},a=(0,n.a)({palette:(0,i.__assign)((0,i.__assign)({},t.palette),r)});return a.semanticColors=(0,i.__assign)((0,i.__assign)({},a.semanticColors),s),(0,i.__assign)((0,i.__assign)({},t),{palette:a.palette,semanticColors:a.semanticColors,isInverted:!t.isInverted})}},43864:(e,t,o)=>{"use strict";o.d(t,{b:()=>i});var i={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"}},27064:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>c}),3023==o.j)var i=o(43864);if(3023==o.j)var n=o(64716);if(3023==o.j)var r=o(25426);if(3023==o.j)var s=o(93859);if(3023==o.j)var a=o(79885);if(3023==o.j)var l=o(38398);function c(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var o=!!e.isInverted,c={palette:i.b,effects:n.W,fonts:r.d,spacing:a.N,isInverted:o,disableGlobalClassNames:!1,semanticColors:(0,l.b)(i.b,n.W,void 0,o,t),rtl:void 0};return(0,s.z)(c,e)}},64716:(e,t,o)=>{"use strict";var i;o.d(t,{W:()=>n}),function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(i||(i={}));var n={elevation4:i.depth4,elevation8:i.depth8,elevation16:i.depth16,elevation64:i.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"}},25426:(e,t,o)=>{"use strict";o.d(t,{d:()=>k});var i,n,r,s,a,l=o(78104);!function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(i||(i={})),function(e){e.Arabic="'".concat(i.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(i.Cyrillic,"'"),e.EastEuropean="'".concat(i.EastEuropean,"'"),e.Greek="'".concat(i.Greek,"'"),e.Hebrew="'".concat(i.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(i.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(i.Vietnamese,"'"),e.WestEuropean="'".concat(i.WestEuropean,"'"),e.Armenian="'".concat(i.Armenian,"'"),e.Georgian="'".concat(i.Georgian,"'")}(n||(n={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(r||(r={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(s||(s={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(a||(a={}));var c="'Segoe UI', '".concat(i.WestEuropean,"'"),u={ar:n.Arabic,bg:n.Cyrillic,cs:n.EastEuropean,el:n.Greek,et:n.EastEuropean,he:n.Hebrew,hi:n.Hindi,hr:n.EastEuropean,hu:n.EastEuropean,ja:n.Japanese,kk:n.EastEuropean,ko:n.Korean,lt:n.EastEuropean,lv:n.EastEuropean,pl:n.EastEuropean,ru:n.Cyrillic,sk:n.EastEuropean,"sr-latn":n.EastEuropean,th:n.Thai,tr:n.EastEuropean,uk:n.Cyrillic,vi:n.Vietnamese,"zh-hans":n.ChineseSimplified,"zh-hant":n.ChineseTraditional,hy:n.Armenian,ka:n.Georgian};function d(e,t,o){return{fontFamily:o,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var h,g,p,f,m,v,b=o(27469),y=o(6363),w=o(32202),C="language",S=o(18076),k=(g=function(e){for(var t in u)if(u.hasOwnProperty(t)&&e&&0===t.indexOf(e))return u[t];return c}(function(e){if(void 0===e&&(e="sessionStorage"),void 0===h){var t=(0,b.Y)(),o="localStorage"===e?y.G(C):"sessionStorage"===e?w.G(C):void 0;o&&(h=o),void 0===h&&t&&(h=t.documentElement.getAttribute("lang")),void 0===h&&(h="en")}return h}()),p="".concat(g,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif"),{tiny:d(r.mini,s.regular,p),xSmall:d(r.xSmall,s.regular,p),small:d(r.small,s.regular,p),smallPlus:d(r.smallPlus,s.regular,p),medium:d(r.medium,s.regular,p),mediumPlus:d(r.mediumPlus,s.regular,p),large:d(r.large,s.regular,p),xLarge:d(r.xLarge,s.semibold,p),xLargePlus:d(r.xLargePlus,s.semibold,p),xxLarge:d(r.xxLarge,s.semibold,p),xxLargePlus:d(r.xxLargePlus,s.semibold,p),superLarge:d(r.superLarge,s.semibold,p),mega:d(r.mega,s.semibold,p)});function T(e,t,o,i){e="'".concat(e,"'");var n=void 0!==i?"local('".concat(i,"'),"):"";(0,l.n)({fontFamily:e,src:n+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:o,fontStyle:"normal",fontDisplay:"swap"})}function x(e,t,o,i,n){void 0===i&&(i="segoeui");var r="".concat(e,"/").concat(o,"/").concat(i);T(t,r+"-light",s.light,n&&n+" Light"),T(t,r+"-semilight",s.semilight,n&&n+" SemiLight"),T(t,r+"-regular",s.regular,n),T(t,r+"-semibold",s.semibold,n&&n+" SemiBold"),T(t,r+"-bold",s.bold,n&&n+" Bold")}!function(e){if(e){var t="".concat(e,"/fonts");x(t,i.Thai,"leelawadeeui-thai","leelawadeeui"),x(t,i.Arabic,"segoeui-arabic"),x(t,i.Cyrillic,"segoeui-cyrillic"),x(t,i.EastEuropean,"segoeui-easteuropean"),x(t,i.Greek,"segoeui-greek"),x(t,i.Hebrew,"segoeui-hebrew"),x(t,i.Vietnamese,"segoeui-vietnamese"),x(t,i.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),x(t,n.Selawik,"selawik","selawik"),x(t,i.Armenian,"segoeui-armenian"),x(t,i.Georgian,"segoeui-georgian"),T("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),s.light),T("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),s.semibold)}}((v=null===(f=(0,S.z)())||void 0===f?void 0:f.FabricConfig,null!==(m=null==v?void 0:v.fontBaseUrl)&&void 0!==m?m:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"))},93859:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>r}),3023==o.j)var i=o(9287);if(3023==o.j)var n=o(38398);function r(e,t){var o,r,s;void 0===t&&(t={});var a=(0,i.h)({},e,t,{semanticColors:(0,n.B)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(o=t.palette)||void 0===o?void 0:o.themePrimary)&&!(null===(r=t.palette)||void 0===r?void 0:r.accent)&&(a.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var l=0,c=Object.keys(a.fonts);l<c.length;l++){var u=c[l];a.fonts[u]=(0,i.h)(a.fonts[u],t.defaultFontStyle,null===(s=null==t?void 0:t.fonts)||void 0===s?void 0:s[u])}return a}},79885:(e,t,o)=>{"use strict";o.d(t,{N:()=>i});var i={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"}},38398:(e,t,o)=>{"use strict";if(o.d(t,{B:()=>r,b:()=>n}),3023==o.j)var i=o(30206);function n(e,t,o,n,s){return void 0===s&&(s=!1),function(e,t){var o="";return!0===t&&(o=" /* @deprecated */"),e.listTextColor=e.listText+o,e.menuItemBackgroundChecked+=o,e.warningHighlight+=o,e.warningText=e.messageText+o,e.successText+=o,e}(r(e,t,(0,i.__assign)({primaryButtonBorder:"transparent",errorText:n?"#F1707B":"#a4262c",messageText:n?"#F3F2F1":"#323130",messageLink:n?"#6CB8F6":"#005A9E",messageLinkHovered:n?"#82C7FF":"#004578",infoIcon:n?"#C8C6C4":"#605e5c",errorIcon:n?"#F1707B":"#A80000",blockingIcon:n?"#442726":"#FDE7E9",warningIcon:n?"#C8C6C4":"#797775",severeWarningIcon:n?"#FCE100":"#D83B01",successIcon:n?"#92C353":"#107C10",infoBackground:n?"#323130":"#f3f2f1",errorBackground:n?"#442726":"#FDE7E9",blockingBackground:n?"#442726":"#FDE7E9",warningBackground:n?"#433519":"#FFF4CE",severeWarningBackground:n?"#4F2A0F":"#FED9CC",successBackground:n?"#393D1B":"#DFF6DD",warningHighlight:n?"#fff100":"#ffb900",successText:n?"#92c353":"#107C10"},o),n),s)}function r(e,t,o,n,r){void 0===r&&(r=!1);var s={},a=e||{},l=a.white,c=a.black,u=a.themePrimary,d=a.themeDark,h=a.themeDarker,g=a.themeDarkAlt,p=a.themeLighter,f=a.neutralLight,m=a.neutralLighter,v=a.neutralDark,b=a.neutralQuaternary,y=a.neutralQuaternaryAlt,w=a.neutralPrimary,C=a.neutralSecondary,S=a.neutralSecondaryAlt,k=a.neutralTertiary,T=a.neutralTertiaryAlt,x=a.neutralLighterAlt,_=a.accent;return l&&(s.bodyBackground=l,s.bodyFrameBackground=l,s.accentButtonText=l,s.buttonBackground=l,s.primaryButtonText=l,s.primaryButtonTextHovered=l,s.primaryButtonTextPressed=l,s.inputBackground=l,s.inputForegroundChecked=l,s.listBackground=l,s.menuBackground=l,s.cardStandoutBackground=l),c&&(s.bodyTextChecked=c,s.buttonTextCheckedHovered=c),u&&(s.link=u,s.primaryButtonBackground=u,s.inputBackgroundChecked=u,s.inputIcon=u,s.inputFocusBorderAlt=u,s.menuIcon=u,s.menuHeader=u,s.accentButtonBackground=u),d&&(s.primaryButtonBackgroundPressed=d,s.inputBackgroundCheckedHovered=d,s.inputIconHovered=d),h&&(s.linkHovered=h),g&&(s.primaryButtonBackgroundHovered=g),p&&(s.inputPlaceholderBackgroundChecked=p),f&&(s.bodyBackgroundChecked=f,s.bodyFrameDivider=f,s.bodyDivider=f,s.variantBorder=f,s.buttonBackgroundCheckedHovered=f,s.buttonBackgroundPressed=f,s.listItemBackgroundChecked=f,s.listHeaderBackgroundPressed=f,s.menuItemBackgroundPressed=f,s.menuItemBackgroundChecked=f),m&&(s.bodyBackgroundHovered=m,s.buttonBackgroundHovered=m,s.buttonBackgroundDisabled=m,s.buttonBorderDisabled=m,s.primaryButtonBackgroundDisabled=m,s.disabledBackground=m,s.listItemBackgroundHovered=m,s.listHeaderBackgroundHovered=m,s.menuItemBackgroundHovered=m),b&&(s.primaryButtonTextDisabled=b,s.disabledSubtext=b),y&&(s.listItemBackgroundCheckedHovered=y),k&&(s.disabledBodyText=k,s.variantBorderHovered=(null==o?void 0:o.variantBorderHovered)||k,s.buttonTextDisabled=k,s.inputIconDisabled=k,s.disabledText=k),w&&(s.bodyText=w,s.actionLink=w,s.buttonText=w,s.inputBorderHovered=w,s.inputText=w,s.listText=w,s.menuItemText=w),x&&(s.bodyStandoutBackground=x,s.defaultStateBackground=x),v&&(s.actionLinkHovered=v,s.buttonTextHovered=v,s.buttonTextChecked=v,s.buttonTextPressed=v,s.inputTextHovered=v,s.menuItemTextHovered=v),C&&(s.bodySubtext=C,s.focusBorder=C,s.inputBorder=C,s.smallInputBorder=C,s.inputPlaceholderText=C),S&&(s.buttonBorder=S),T&&(s.disabledBodySubtext=T,s.disabledBorder=T,s.buttonBackgroundChecked=T,s.menuDivider=T),_&&(s.accentButtonBackground=_),(null==t?void 0:t.elevation4)&&(s.cardShadow=t.elevation4),!n&&(null==t?void 0:t.elevation8)?s.cardShadowHovered=t.elevation8:s.variantBorderHovered&&(s.cardShadowHovered="0 0 1px "+s.variantBorderHovered),(0,i.__assign)((0,i.__assign)({},s),o)}},47143:(e,t,o)=>{"use strict";function i(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}o.d(t,{S:()=>i})},27469:(e,t,o)=>{"use strict";if(o.d(t,{Y:()=>n}),3023==o.j)var i=o(47143);function n(e){if((0,i.S)()&&"undefined"!=typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}},18076:(e,t,o)=>{"use strict";if(o.d(t,{z:()=>r}),3023==o.j)var i=o(47143);var n=3023==o.j?void 0:null;try{n=window}catch(e){}function r(e){if((0,i.S)()&&void 0!==n){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:n}}},6363:(e,t,o)=>{"use strict";if(o.d(t,{G:()=>n}),3023==o.j)var i=o(18076);function n(e){var t=null;try{var o=(0,i.z)();t=o?o.localStorage.getItem(e):null}catch(e){}return t}},9287:(e,t,o)=>{"use strict";function i(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];for(var i=0,r=t;i<r.length;i++)n(e||{},r[i]);return e}function n(e,t,o){for(var i in void 0===o&&(o=[]),o.push(t),t)if(t.hasOwnProperty(i)&&"__proto__"!==i&&"constructor"!==i&&"prototype"!==i){var r=t[i];if("object"!=typeof r||null===r||Array.isArray(r))e[i]=r;else{var s=o.indexOf(r)>-1;e[i]=s?r:n(e[i]||{},r,o)}}return o.pop(),e}o.d(t,{h:()=>i})},32202:(e,t,o)=>{"use strict";if(o.d(t,{G:()=>n}),3023==o.j)var i=o(18076);function n(e){var t=null;try{var o=(0,i.z)();t=o?o.sessionStorage.getItem(e):null}catch(e){}return t}},9570:(e,t,o)=>{"use strict";o.d(t,{g:()=>r});var i=o(98675),n=o(67234),r=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,o,r,s,a){var l,c=null!=a?a:(0,i.Y)();if(e._isElement(t)){if(void 0!==c&&c.createEvent){var u=c.createEvent("HTMLEvents");u.initEvent(o,s||!1,!0),(0,n.kp)(u,r),l=t.dispatchEvent(u)}else if(void 0!==c&&c.createEventObject){var d=c.createEventObject(r);t.fireEvent("on"+o,d)}}else for(;t&&!1!==l;){var h=t.__events__,g=h?h[o]:null;if(g)for(var p in g)if(g.hasOwnProperty(p))for(var f=g[p],m=0;!1!==l&&m<f.length;m++){var v=f[m];v.objectCallback&&(l=v.objectCallback.call(v.parent,r))}t=s?t.parent:null}return l},e.isObserved=function(e,t){var o=e&&e.__events__;return!!o&&!!o[t]},e.isDeclared=function(e,t){var o=e&&e.__declaredEvents;return!!o&&!!o[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,o){for(var i in t)t.hasOwnProperty(i)&&this.on(e,i,t[i],o)},e.prototype.on=function(t,o,i,n){var r=this;if(o.indexOf(",")>-1)for(var s=o.split(/[ ,]+/),a=0;a<s.length;a++)this.on(t,s[a],i,n);else{var l=this._parent,c={target:t,eventName:o,parent:l,callback:i,options:n};if((s=t.__events__=t.__events__||{})[o]=s[o]||{count:0},s[o][this._id]=s[o][this._id]||[],s[o][this._id].push(c),s[o].count++,e._isElement(t)){var u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed){var o;try{if(!1===(o=i.apply(l,e))&&e[0]){var n=e[0];n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0}}catch(n){}return o}};c.elementCallback=u,t.addEventListener?t.addEventListener(o,u,n):t.attachEvent&&t.attachEvent("on"+o,u)}else c.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed)return i.apply(l,e)};this._eventRecords.push(c)}},e.prototype.off=function(e,t,o,i){for(var n=0;n<this._eventRecords.length;n++){var r=this._eventRecords[n];if(!(e&&e!==r.target||t&&t!==r.eventName||o&&o!==r.callback||"boolean"==typeof i&&i!==r.options)){var s=r.target.__events__,a=s[r.eventName],l=a?a[this._id]:null;l&&(1!==l.length&&o?(a.count--,l.splice(l.indexOf(r),1)):(a.count-=l.length,delete s[r.eventName][this._id]),a.count||delete s[r.eventName]),r.elementCallback&&(r.target.removeEventListener?r.target.removeEventListener(r.eventName,r.elementCallback,r.options):r.target.detachEvent&&r.target.detachEvent("on"+r.eventName,r.elementCallback)),this._eventRecords.splice(n--,1)}}},e.prototype.raise=function(t,o,i){return e.raise(this._parent,t,o,i)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var o=0;o<e.length;o++)t[e[o]]=!0},e._uniqueId=0,e}()},65645:(e,t,o)=>{"use strict";function i(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return t.length<2?t[0]:function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];t.forEach((function(t){return t&&t.apply(e,o)}))}}o.d(t,{$:()=>i})},81448:(e,t,o)=>{"use strict";function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o=e.filter((function(e){return e})).join(" ").trim();return""===o?void 0:o}o.d(t,{_:()=>i})},76296:(e,t,o)=>{"use strict";function i(e,t,o){var i=e.slice();return i.splice(t,0,o),i}function n(e,t){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}o.d(t,{Ty:()=>i,r1:()=>n})},56308:(e,t,o)=>{"use strict";if(o.d(t,{K:()=>n}),3023==o.j)var i=o(76296);var n=function(e){var t={refs:[]};return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t.resolver&&(0,i.r1)(t.refs,e)||(t.resolver=function(e){return function(t){for(var o=0,i=e.refs;o<i.length;o++){var n=i[o];"function"==typeof n?n(t):n&&(n.current=t)}}}(t)),t.refs=e,t.resolver}}},31998:(e,t,o)=>{"use strict";if(o.d(t,{i:()=>n}),3023==o.j)var i=o(65645);function n(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=(0,i.$)(e,e[o],t[o]))}},87396:(e,t,o)=>{"use strict";o.d(t,{_:()=>r});var i=o(13668),n={label:i.q6,audio:i.Sg,video:i.Fo,ol:i.p3,li:i.P4,a:i.t0,button:i.uw,input:i.QQ,textarea:i.Sh,select:i.Cq,option:i.tK,table:i.al,tr:i.g0,th:i.cr,td:i.k3,colGroup:i.lA,col:i.Qf,form:i.Gp,iframe:i.Cs,img:i.xM};function r(e,t,o){var r=e&&n[e]||i.vt;return(0,i.G1)(t,r,o)}},2963:(e,t,o)=>{"use strict";function i(e,t){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}o.d(t,{D:()=>i})},60343:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>n}),3023==o.j)var i=o(31998);function n(e){(0,i.i)(e,{componentDidMount:r,componentDidUpdate:s,componentWillUnmount:a})}function r(){l(this.props.componentRef,this)}function s(e){e.componentRef!==this.props.componentRef&&(l(e.componentRef,null),l(this.props.componentRef,this))}function a(){l(this.props.componentRef,null)}function l(e,t){e&&("object"==typeof e?e.current=t:"function"==typeof e&&e(t))}},40868:(e,t,o)=>{"use strict";o.d(t,{I:()=>l});var i=/[\(\[\{\<][^\)\]\}\>]*[\)\]\}\>]/g,n=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,r=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,s=/\s+/g,a=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function l(e,t,o){return e?(e=function(e){return(e=(e=(e=e.replace(i,"")).replace(n,"")).replace(s," ")).trim()}(e),a.test(e)||!o&&r.test(e)?"":function(e,t){var o="",i=e.split(" ");return 2===i.length?(o+=i[0].charAt(0).toUpperCase(),o+=i[1].charAt(0).toUpperCase()):3===i.length?(o+=i[0].charAt(0).toUpperCase(),o+=i[2].charAt(0).toUpperCase()):0!==i.length&&(o+=i[0].charAt(0).toUpperCase()),t&&o.length>1?o.charAt(1)+o.charAt(0):o}(e,t)):""}},70833:(e,t,o)=>{"use strict";if(o.d(t,{f:()=>s}),3023==o.j)var i=o(31860);if(3023==o.j)var n=o(47126);if(3023==o.j)var r=o(71170);var s=function(e){var t=e.stylesheetKey,o=e.children,s=(0,n.A)(),a=s.useAdoptedStylesheetEx,l=s.useMergeStylesRootStylesheets,c=s.useWindow,u=(0,r.v)(),d=l(),h=c();return a(i.P6,u,d,h),a(t,u,d,h),o(!!u)}},50610:(e,t,o)=>{"use strict";o.d(t,{c:()=>i});var i=o(95734).createContext(void 0)},71170:(e,t,o)=>{"use strict";o.d(t,{h:()=>r,v:()=>s});var i=o(95734);if(3023==o.j)var n=o(50610);var r=function(){return!!s()},s=function(){return i.useContext(n.c)}},12528:(e,t,o)=>{"use strict";o.d(t,{$:()=>i});const i=(0,o(83335).y8)({u:"string"})},83335:(e,t,o)=>{"use strict";o.d(t,{cC:()=>r,g8:()=>i,oE:()=>n,y8:()=>s});const i="metadata";function n(e){return JSON.parse(atob(decodeURIComponent(e)))}function r(e){return encodeURIComponent(btoa(JSON.stringify(e)))}function s(e){return t=>{if("object"!=typeof t||!t)return!1;const o=t;for(const[t,i]of Object.entries(e)){const e=o[t];if(typeof e!==i||!e)return!1}return!0}}},16062:(e,t,o)=>{"use strict";o.d(t,{KA:()=>n,oC:()=>r});const i={publicOrigin:"https://m365.cloud.microsoft"},n=e=>{const t=e.toLowerCase();return Object.values(i).some((o=>"string"==typeof o&&o===t||!!Array.isArray(o)&&o.includes(e)))},r="/chat/pages"},39248:(e,t,o)=>{"use strict";o.d(t,{Ff:()=>a,Pf:()=>s,V0:()=>n,Y0:()=>r,ys:()=>l});var i=o(83335);const n=(0,i.y8)({i:"string"}),r=(0,i.y8)({m:"string"}),s=(0,i.y8)({g:"string"}),a=(0,i.y8)({t:"string",u:"string"}),l=(0,i.y8)({s:"string",n:"string"})},65605:(e,t,o)=>{"use strict";if(o.d(t,{s:()=>s}),3023==o.j)var i=o(67299);if(3023==o.j)var n=o(24345);if(3023==o.j)var r=o(52673);function s(e){if("string"==typeof e&&!(0,n.C)(e))return;const t=new URL(e),o=(0,r.y)(t);return o?((0,i.Cu)(t,o),{url:t,locator:o}):void 0}},32917:(e,t,o)=>{"use strict";if(o.d(t,{RK:()=>l,Ug:()=>a,q$:()=>c}),3023==o.j)var i=o(64168);if(3023==o.j)var n=o(16062);if(3023==o.j)var r=o(95121);if(3023==o.j)var s=o(83335);function a(e){let t;return(0,r.L$)(e.origin)&&e.pathname.startsWith(i.a6)?t=e.pathname.substring(i.a6.length+1):(0,n.KA)(e.origin)&&e.pathname.startsWith(n.oC)&&(t=e.pathname.substring(n.oC.length+1)),t&&(0,s.oE)(t)}function l(e){let t=e;if((0,i.Ix)(e)&&(t=(0,i.RS)(e)),(0,i.NW)(t)&&(0,i.fl)(t.p))return{fileUrl:t.p.u,requiresRedeem:t.p.r,pageId:t.i?.i}}function c(e){return l(a(e))}},67268:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>r}),3023==o.j)var i=o(67299);if(3023==o.j)var n=o(32917);function r(e){const t=(0,n.RK)((0,n.Ug)(e));if(t)return(0,i.Mh)(new URL(t.fileUrl),!1)}},52673:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>n}),3023==o.j)var i=o(67299);function n(e){return(0,i.Mh)(e,!1)}},99237:(e,t,o)=>{"use strict";if(o.d(t,{a:()=>h,w:()=>d}),3023==o.j)var i=o(67299);if(3023==o.j)var n=o(64168);if(3023==o.j)var r=o(43990);if(3023==o.j)var s=o(44310);if(3023==o.j)var a=o(95121);const l=e=>e.hasOwnProperty("hydratableFileLink"),c=e=>e.hasOwnProperty("sharingFileLink"),u=e=>e?.hasOwnProperty("workspacePodId")??!1;function d(e){const{page:t,options:o,pageWorkspaceContext:a,pageMeetingContext:d}=e;let h;if(l(t))h={u:t.hydratableFileLink,r:t.requiresRedeem};else{const e=c(t),n=new URL(e?t.sharingFileLink:t.siteOrigin),l=u(a)?(0,r.th)(a):a?(0,r.th)({workspacePodId:(0,s.an)({siteDomain:n.hostname,driveId:a.driveId,itemId:a.itemId}),pageId:a.pageId}):void 0,d={siteUrl:n.href,driveId:t.driveId,itemId:t.itemId,dataStorePath:o?.deeplink||"/",containerPackageName:o?.containerPackageName,context:l};(0,i.Cu)(n,d),h={u:n.href,r:e}}const g=(0,n.RS)(h);if(d){const e=(0,r.LC)(d);g.m=e}return(0,n.M8)(g)}function h(e,t,o="v2"){const i=d(e);return`${(0,a.qh)(t,o)}${i}`}},47070:(e,t,o)=>{"use strict";if(o.d(t,{R:()=>s}),3023==o.j)var i=o(83335);if(3023==o.j)var n=o(52673);if(3023==o.j)var r=o(64168);const s=e=>{const t=e&&(0,i.oE)(e);if(!t)return;const o=(0,r.NW)(t)?t:(0,r.Ix)(t)?(0,r.RS)(t):void 0;return o&&(0,r.fl)(o.p)?{pageUrl:o.p.u,workspaceUrl:o.w&&(0,r.fl)(o.w)?o.w.u:void 0,itemId:(0,n.y)(new URL(o.p.u))?.itemId}:void 0}},97917:(e,t,o)=>{"use strict";o.d(t,{D:()=>r,k:()=>n});var i=o(95121);const n={v1:i.kt.v1,v2:i.kt.v2,v3:{publicOrigin:"https://hosted.loop.cloud.microsoft",developerOrigin:"https://hosted.loop.cloud.dev.microsoft"}},r=e=>{const t=e.toLowerCase();return Object.values(n.v1).concat(Object.values(n.v2)).concat(Object.values(n.v3)).some((o=>"string"==typeof o&&o===t||!!Array.isArray(o)&&o.includes(e)))}},25020:(e,t,o)=>{"use strict";o.d(t,{H1:()=>u,Ow:()=>c,_2:()=>s,_x:()=>l,ll:()=>a});var i=o(83335);if(3023==o.j)var n=o(95121);if(3023==o.j)var r=o(5060);const s="/join",a=(0,i.y8)({g:"string",i:"string"});function l(e,t){const o=new URLSearchParams;return o.set(r.X,e),t&&o.set(r.J,t),`${s}?${o.toString()}`}function c(e,t,o){return`${(0,n.qh)(o??"Prod")}${l(e,t)}`}function u(e,t,o){const n={g:e,i:t,w:o};return`${s}/${(0,i.cC)(n)}`}},89559:(e,t,o)=>{"use strict";o.d(t,{w:()=>i});const i=(0,o(83335).y8)({s:"string"})},5060:(e,t,o)=>{"use strict";o.d(t,{J:()=>n,X:()=>i});const i="podId",n="tid"},95121:(e,t,o)=>{"use strict";o.d(t,{L$:()=>n,kt:()=>i,qh:()=>r});const i={v1:{productionOrigin:"https://loop.microsoft.com",previewOrigin:"https://preview.loop.microsoft.com",dogfoodOrigin:"https://df.loop.microsoft.com",stagingOrigin:"https://dev.loop.microsoft.com",localOrigins:["https://local.loop.microsoft.com","https://local.loop.microsoft.com:8080","https://local.loop.microsoft.com:8081","http://localhost:8094","http://localhost"]},v2:{gallatinOrigin:"https://loop.microsoftonline.cn",dodOrigin:"https://loop.apps.mil",gcchOrigin:"https://loop.office365.us",publicOrigin:"https://loop.cloud.microsoft",developerOrigin:"https://loop.cloud-dev.microsoft"},hoopOrigins:{publicOrigin:"https://hosted.loop.cloud.microsoft",developerOrigin:"https://hosted.loop.cloud.dev.microsoft"}},n=e=>{const t=e.toLowerCase();return Object.values(i.v1).concat(Object.values(i.v2)).concat(Object.values(i.hoopOrigins)).some((o=>"string"==typeof o&&o===t||!!Array.isArray(o)&&o.includes(e)))},r=(e,t="v2")=>{switch(e){case"Development":return i.v1.localOrigins[0];case"Staging":return"v1"===t?i.v1.stagingOrigin:i.v2.developerOrigin;case"Dogfood":return"v1"===t?i.v1.dogfoodOrigin:i.v2.publicOrigin;case"Preview":return"v1"===t?i.v1.previewOrigin:i.v2.publicOrigin;case"Prod":case"Gcc":return"v1"===t?i.v1.productionOrigin:i.v2.publicOrigin;case"GccHigh":return i.v2.gcchOrigin;case"DoD":return i.v2.dodOrigin;case"Gallatin":return i.v2.gallatinOrigin;default:throw new Error(`Loop web app does not support ${e} ring`)}}},43990:(e,t,o)=>{"use strict";if(o.d(t,{Hg:()=>a,LC:()=>r,eO:()=>l,qP:()=>c,th:()=>s}),3023==o.j)var i=o(67299);if(3023==o.j)var n=o(64168);function r(e){return{i:e.meetingId,s:e.meetingSeriesId,m:e.meetingSeriesICalUid,d:e.startDateTimeOfWeek}}function s(e){return JSON.stringify({w:e.workspacePodId,i:e.pageId})}function a(e){const t=JSON.parse(e);if("object"==typeof(o=t)&&o&&o.w)return{workspacePodId:t.w,pageId:t.i};var o;throw new Error("Encoded page context value is in invalid format")}function l(e,t){const o=(0,i.Mh)(e);return!!o&&((0,i.Cu)(e,{...o,context:s(t)}),!0)}function c(e){if((0,n.NW)(e)){const t=e.m;if(t?.i)return{meetingId:t.i.toUpperCase(),meetingSeriesId:t.s,meetingSeriesICalUid:t.m?.toUpperCase(),startDateTimeOfWeek:t.d}}}},64168:(e,t,o)=>{"use strict";o.d(t,{Ix:()=>h,KX:()=>d,M8:()=>g,MO:()=>l,NW:()=>u,RS:()=>p,a6:()=>a,fl:()=>c});var i=o(83335);if(3023==o.j)var n=o(65605);if(3023==o.j)var r=o(43990);if(3023==o.j)var s=o(44310);const a="/p",l=3023==o.j?`${a}/:${i.g8}`:null;function c(e){return"u"in e}const u=(0,i.y8)({p:"object"}),d=(0,i.y8)({w:"object"}),h=(0,i.y8)({u:"string"});function g(e){return`${a}/${(0,i.cC)(e)}`}function p(e){const t=(0,n.s)(e.u);if(!t)throw new Error("Page file metadata does not include valid file link");const o={u:t.url.href,r:Boolean(e.r)};let i;if(t.locator.context){const e=(0,r.Hg)(t.locator.context);i={w:{u:(0,s.xo)(e.workspacePodId),r:!1},p:o,i:e.pageId?{i:e.pageId}:void 0}}else i={p:o};return i}},44310:(e,t,o)=>{"use strict";if(o.d(t,{LS:()=>s,RY:()=>r,an:()=>l,bN:()=>h,f1:()=>c,xE:()=>d,xo:()=>u}),3023==o.j)var i=o(67299);if(3023==o.j)var n=o(52673);const r="LoopAppData",s="Copilot",a="fo";function l(e){return e.podFileFolderPath&&e.podFileFolderPath!==r&&e.podFileFolderPath!==s?btoa(`ODSP|${e.siteDomain.toLowerCase()}|${e.driveId}|${e.itemId}|${e.podFileFolderPath}`):btoa(`ODSP|${e.siteDomain.toLowerCase()}|${e.driveId}|${e.itemId}`)}function c(e){const t=atob(e);if(!t.startsWith("ODSP"))throw new Error("Cannot parse id value when provided ID is not for ODSP pod");const o=t.split("|");return o.length>4?{siteDomain:o[1],driveId:o[2],itemId:o[3],podFileFolderPath:o[4]}:{siteDomain:o[1],driveId:o[2],itemId:o[3]}}function u(e){const t=c(e),o=`https://${t.siteDomain}`,n=new URL(o);return(0,i.Cu)(n,{siteUrl:o,driveId:t.driveId,itemId:t.itemId,dataStorePath:""}),t.podFileFolderPath&&n.searchParams.set(a,btoa(t.podFileFolderPath)),n.toString()}function d(e){const t=new URL(e),o=(0,i.Mh)(t);if(!o)return;const n=t.searchParams.get(a);return l({siteDomain:new URL(o.siteUrl).host,driveId:o.driveId,itemId:o.itemId,podFileFolderPath:n?atob(n):void 0})}function h(e){const t=(0,n.y)(new URL(e));if(t)return l({siteDomain:new URL(t.siteUrl).host,driveId:t.driveId,itemId:t.itemId})}},63179:(e,t,o)=>{"use strict";if(o.d(t,{F:()=>r}),3023==o.j)var i=o(83335);const n="/print";function r(e,t){const o={p:{u:e}};return`${t}${n}/${(0,i.cC)(o)}`}},82672:(e,t,o)=>{"use strict";o.d(t,{z:()=>i});const i=(0,o(83335).y8)({})},76264:(e,t,o)=>{"use strict";if(o.d(t,{Aw:()=>a,II:()=>s,pe:()=>r,y2:()=>n}),3023==o.j)var i=o(83335);const n="/w",r=3023==o.j?`${n}/home`:null;function s(e){if("object"==typeof e&&null!==e){const t=e;return"string"==typeof t.t||"string"==typeof t.w}return!1}function a(e){return`${n}/${(0,i.cC)(e)}`}},36252:(e,t,o)=>{"use strict";if(o.r(t),o.d(t,{PersonalCopilotWorkspaceFolderName:()=>b.LS,convertToPageRouteUrlMetadata:()=>v.RS,decodeAppRouteMetadata:()=>i.oE,decodePageContext:()=>m.Hg,encodeAppRouteMetadata:()=>i.cC,encodePageContext:()=>m.th,ensureHydratableFluidUrl:()=>s.s,fileUrlToPodId:()=>b.bN,fluidUrlToPodId:()=>b.xE,fromPodId:()=>b.f1,generateInviteUrl:()=>h.Ow,getDecodedMetadataFromAppUrl:()=>a.Ug,getFileUrlFromAppUrl:()=>a.q$,getFileUrlFromDecodedMetadata:()=>a.RK,getInvitationWithCodeUrlPath:()=>h.H1,getJoinWorkspaceRoutePath:()=>h._x,getLocatorFromAppUrl:()=>l.D,getLocatorFromFileUrl:()=>c.y,getLoopAppOrigin:()=>p.qh,getLoopPageAppUrl:()=>u.a,getLoopPageUrlPath:()=>u.w,getMeetingContextFromMetadata:()=>m.qP,getPageDataFromMetadata:()=>d.R,getPrintPageRoutePath:()=>w.F,hoopOrigins:()=>f.k,isAddToNewWorkspaceMetadata:()=>r.Ff,isAddToWorkspaceTemplateMetadata:()=>n.$,isAttachedFluidFileInfo:()=>v.fl,isHoopOrigin:()=>f.D,isJoinUrlMetadata:()=>h.ll,isLiveRouteUrlMetadata:()=>S.w,isLoopOrigin:()=>p.L$,isPageRouteFileMetadata:()=>v.Ix,isPageRouteUrlMetadata:()=>v.NW,isRecentRouteUrlMetadata:()=>y.z,isSuggestedWorkspaceMetadata:()=>r.ys,isWorkspaceHostedTabMetadata:()=>r.Pf,isWorkspaceMeetingMetadata:()=>r.Y0,isWorkspaceScopedPageRouteUrlMetadata:()=>v.KX,isWorkspaceTemplateMetadata:()=>r.V0,isWorkspaceUrlMetadata:()=>g.II,joinWorkspaceRoutePathPrefix:()=>h._2,loopAppDataFolderName:()=>b.RY,metadataParamName:()=>i.g8,origins:()=>p.kt,pageRouteDefinition:()=>v.MO,pageRouteMetadataToPageRoutePath:()=>v.M8,pageRoutePathPrefix:()=>v.a6,podIdToFluidUrl:()=>b.xo,storePageContextInOdspUrl:()=>m.eO,tenantIdQueryParam:()=>C.J,toPodId:()=>b.an,workspaceHomeRoutePathPrefix:()=>g.pe,workspaceMfsPodIdQueryParam:()=>C.X,workspaceRouteMetadataToWorkspaceRoutePath:()=>g.Aw,workspaceRoutePathPrefix:()=>g.y2}),3023==o.j)var i=o(83335);if(3023==o.j)var n=o(12528);if(3023==o.j)var r=o(39248);if(3023==o.j)var s=o(65605);if(3023==o.j)var a=o(32917);if(3023==o.j)var l=o(67268);if(3023==o.j)var c=o(52673);if(3023==o.j)var u=o(99237);if(3023==o.j)var d=o(47070);if(3023==o.j)var h=o(25020);if(3023==o.j)var g=o(76264);if(3023==o.j)var p=o(95121);if(3023==o.j)var f=o(97917);if(3023==o.j)var m=o(43990);if(3023==o.j)var v=o(64168);if(3023==o.j)var b=o(44310);if(3023==o.j)var y=o(82672);if(3023==o.j)var w=o(63179);if(3023==o.j)var C=o(5060);if(3023==o.j)var S=o(89559)},24345:(e,t,o)=>{"use strict";o.d(t,{C:()=>n});const i=new Set(["http:","https:","ftp:","mailto:","ms-word:","ms-excel:","ms-powerpoint:","ms-visio:","ms-access:","ms-spd:","ms-publisher:","ms-project:","msteams:","ms-officemobile:"]);function n(e){let t;try{t=new URL(e)}catch{return!1}return function(e){return i.has(e.protocol.toLowerCase())}(t)}},8871:(e,t,o)=>{"use strict";o.d(t,{w:()=>n});var i=o(95734);(0,o(54167).hN)([{rawString:"@-webkit-keyframes rollout_09ccd899{0%{left:-100px}100%{left:calc(100% + 100px)}}@keyframes rollout_09ccd899{0%{left:-100px}100%{left:calc(100% + 100px)}}.backgroundShimmer_09ccd899{position:absolute;background:var(--background-color);width:80px;height:calc(100% + 100px);left:0;top:-50px;-webkit-transform:rotate(30deg);transform:rotate(30deg);-webkit-box-shadow:0 0 15px 8px var(--background-color);box-shadow:0 0 15px 8px var(--background-color);z-index:0;-webkit-animation:rollout_09ccd899 var(--animation-time) forwards;animation:rollout_09ccd899 var(--animation-time) forwards}"}]);const n=i.memo((e=>{var t;const{animationTimeMs:o,theme:n}=e;return i.createElement("div",{className:"backgroundShimmer_09ccd899",style:{"--background-color":null!==(t=null==n?void 0:n.shimmerColor)&&void 0!==t?t:"rgba(255, 255, 255, 0.8)","--animation-time":`${null!=o?o:1750}ms`}})}));n.displayName="BackgroundShimmer"},51249:(e,t,o)=>{"use strict";o.d(t,{i:()=>a});var i=o(95734);if(3023==o.j)var n=o(7313);if(3023==o.j)var r=o(68803);if(3023==o.j)var s=o(36694);const a=e=>i.createElement(n.S,{style:e.style,align:r.j5.Stretch,onKeyDown:e.onKeyDown,handledKeys:[s.h.Tab]},e.baseItems)},82512:(e,t,o)=>{"use strict";o.d(t,{u:()=>u});var i=o(95734),n=o(16971),r=o(56360),s=o(70189),a=o(97782),l=o(7313);const c=(e,t,o,n,r,c)=>{var u;if(void 0===e.icon)return;const{type:d,style:h,primaryColor:g,filled:p,fontSize:f}=e.icon,m={type:d,style:h,primaryColor:g||s.VA(e,t,o,n,r,c),filled:o&&p,fontSize:f||(null===(u=e.style)||void 0===u?void 0:u.iconFontSize)};return a.I.shouldRender(m,c)?i.createElement(l.S,{accessible:e.iconShouldBeAccessible},i.createElement(a.I,Object.assign({},m))):void 0},u=i.memo(i.forwardRef(((e,t)=>{const o=i.useContext(n.O),[a,l]=i.useState(!1),[u,d]=i.useState(!1),[h,g]=i.useState(!1);return i.createElement(r.J,Object.assign({ref:t},e,{onHoverIn:()=>{var t;null===(t=e.onHoverIn)||void 0===t||t.call(e),g(!0)},onHoverOut:()=>{var t;null===(t=e.onHoverOut)||void 0===t||t.call(e),g(!1),l(!1)},onFocus:t=>{var o;!t.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onFocus)||void 0===o||o.call(e,t),d(!0))},onBlur:t=>{var o;!t.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onBlur)||void 0===o||o.call(e,t),d(!1))},onPressIn:()=>{var t;null===(t=e.onPressIn)||void 0===t||t.call(e),l(!0)},onPressOut:()=>{var t;null===(t=e.onPressOut)||void 0===t||t.call(e),l(!1)}}),s.nK(e,s.KD,a,h,u,c,s.lM(e,o),{useFluentV9:o}))})));u.displayName="CompositeButton"},56360:(e,t,o)=>{"use strict";o.d(t,{J:()=>oo});var i=o(44207),n=o(30206),r=o(95734),s=o(56308),a=o(413),l=o(63666),c=o(5871),u=o(91578),d=o(39977),h=o(60343),g=o(47161),p=o(9570),f=o(89416),m=o(13668),v=o(67234);function b(e,t,o){var i=e[o],n=t[o];(i||n)&&(e[o]=function(){for(var e,t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return n&&(e=n.apply(this,t)),i!==n&&(e=i.apply(this,t)),e})}function y(){return null}!function(e){function t(o,i){var n=e.call(this,o,i)||this;return function(e,t,o){for(var i=0,n=o.length;i<n;i++)b(e,t,o[i])}(n,t.prototype,["componentDidMount","shouldComponentUpdate","getSnapshotBeforeUpdate","render","componentDidUpdate","componentWillUnmount"]),n}(0,n.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){this._updateComponentRef(e,this.props)},t.prototype.componentDidMount=function(){this._setComponentRef(this.props.componentRef,this)},t.prototype.componentWillUnmount=function(){if(this._setComponentRef(this.props.componentRef,null),this.__disposables){for(var e=0,t=this._disposables.length;e<t;e++){var o=this.__disposables[e];o.dispose&&o.dispose()}this.__disposables=null}},Object.defineProperty(t.prototype,"className",{get:function(){if(!this.__className){var e=/function (.{1,})\(/.exec(this.constructor.toString());this.__className=e&&e.length>1?e[1]:""}return this.__className},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_disposables",{get:function(){return this.__disposables||(this.__disposables=[]),this.__disposables},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_async",{get:function(){return this.__async||(this.__async=new g.j(this),this._disposables.push(this.__async)),this.__async},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_events",{get:function(){return this.__events||(this.__events=new p.g(this),this._disposables.push(this.__events)),this.__events},enumerable:!1,configurable:!0}),t.prototype._resolveRef=function(e){var t=this;return this.__resolves||(this.__resolves={}),this.__resolves[e]||(this.__resolves[e]=function(o){return t[e]=o}),this.__resolves[e]},t.prototype._updateComponentRef=function(e,t){void 0===t&&(t={}),e&&t&&e.componentRef!==t.componentRef&&(this._setComponentRef(e.componentRef,null),this._setComponentRef(t.componentRef,this))},t.prototype._warnDeprecations=function(e){this.className,this.props},t.prototype._warnMutuallyExclusive=function(e){this.className,this.props},t.prototype._warnConditionallyRequiredProps=function(e,t,o){this.className,this.props},t.prototype._setComponentRef=function(e,t){!this._skipComponentRefResolution&&e&&("function"==typeof e&&e(t),"object"==typeof e&&(e.current=t))}}(r.Component);var w,C=o(52302),S=o(81448),k=o(82330);!function(e){e[e.default=0]="default",e[e.image=1]="image",e[e.Default=1e5]="Default",e[e.Image=100001]="Image"}(w||(w={}));var T=o(9280),x=o(34916),_=o(30205),I=o(90298),E=(0,_.Z)({cacheSize:100}),B=function(e){function t(t){var o=e.call(this,t)||this;return o._onImageLoadingStateChange=function(e){o.props.imageProps&&o.props.imageProps.onLoadingStateChange&&o.props.imageProps.onLoadingStateChange(e),e===x.P6.error&&o.setState({imageLoadError:!0})},o.state={imageLoadError:!1},o}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,o=e.className,i=e.styles,s=e.iconName,a=e.imageErrorAs,l=e.theme,c="string"==typeof s&&0===s.length,u=!!this.props.imageProps||this.props.iconType===w.image||this.props.iconType===w.Image,d=(0,I.ne)(s)||{},h=d.iconClassName,g=d.children,p=d.mergeImageProps,f=E(i,{theme:l,className:o,iconClassName:h,isImage:u,isPlaceholder:c}),v=u?"span":"i",b=(0,m.G1)(this.props,m.vt,["aria-label"]),y=this.state.imageLoadError,C=(0,n.__assign)((0,n.__assign)({},this.props.imageProps),{onLoadingStateChange:this._onImageLoadingStateChange}),S=y&&a||T._,k=this.props["aria-label"]||this.props.ariaLabel,x=C.alt||k||this.props.title,_=x||this.props["aria-labelledby"]||C["aria-label"]||C["aria-labelledby"]?{role:u||p?void 0:"img","aria-label":u||p?void 0:x}:{"aria-hidden":!0},B=g;return p&&g&&"object"==typeof g&&x&&(B=r.cloneElement(g,{alt:x})),r.createElement(v,(0,n.__assign)({"data-icon-name":s},_,b,p?{title:void 0,"aria-label":void 0}:{},{className:f.root}),u?r.createElement(S,(0,n.__assign)({},C)):t||B)},t}(r.Component),A=o(34771),R=(0,k.I)(B,A.$f,void 0,{scope:"Icon"},!0);R.displayName="Icon";var M,D=function(e){var t=e.className,o=e.imageProps,i=(0,m.G1)(e,m.vt,["aria-label","aria-labelledby","title","aria-describedby"]),s=o.alt||e["aria-label"],a=s||e["aria-labelledby"]||e.title||o["aria-label"]||o["aria-labelledby"]||o.title,c={"aria-labelledby":e["aria-labelledby"],"aria-describedby":e["aria-describedby"],title:e.title},u=a?{}:{"aria-hidden":!0};return r.createElement("div",(0,n.__assign)({},u,i,{className:(0,l.A)(A.xD,A.xW.root,A.xW.image,t)}),r.createElement(T._,(0,n.__assign)({},c,o,{alt:a?s:""})))},P=o(10056),F=(0,a.J5)((function(e){return(0,a.J5)((function(t){var o=(0,a.J5)((function(e){return function(o){return t(o,e)}}));return function(i,n){return e(i,n?o(n):t)}}))}));!function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.Section=3]="Section"}(M||(M={}));var O,N=o(20941),q=o(60874),j=o(24607),L=o(98675),z=o(19440),H=o(58086);function W(e){var t;if(void 0===O||e){var o=(0,H.z)(),i=null===(t=null==o?void 0:o.navigator)||void 0===t?void 0:t.userAgent;O=!!i&&-1!==i.indexOf("Macintosh")}return!!O}var U=function(){return!!(window&&window.navigator&&window.navigator.userAgent)&&/iPad|iPhone|iPod/i.test(window.navigator.userAgent)},G=o(23401),V=(0,a.J5)((function(e){var t=e;return(0,a.J5)((function(o){if(e===o)throw new Error("Attempted to compose a component with itself.");var i=o,s=(0,a.J5)((function(e){return function(t){return r.createElement(i,(0,n.__assign)({},t,{defaultRender:e}))}}));return function(e){var o=e.defaultRender;return r.createElement(t,(0,n.__assign)({},e,{defaultRender:o?s(o):i}))}}))}));function $(e,t){return V(e)(t)}function K(e){return e.canCheck?!(!e.isChecked&&!e.checked):"boolean"==typeof e.isChecked?e.isChecked:"boolean"==typeof e.checked?e.checked:null}function J(e){return!(!e.subMenuProps&&!e.items)}function Y(e){return!(!e.isDisabled&&!e.disabled)}function Q(e){return null!==K(e)?"menuitemcheckbox":"menuitem"}var Z=o(32334),X=function(e){var t=e.item,o=e.classNames,i=t.iconProps;return r.createElement(R,(0,n.__assign)({},i,{className:o.icon}))},ee=function(e){var t=e.item;return e.hasIcons?t.onRenderIcon?t.onRenderIcon(e,X):X(e):null},te=function(e){var t=e.onCheckmarkClick,o=e.item,i=e.classNames,n=K(o);return t?r.createElement(R,{iconName:!1!==o.canCheck&&n?"CheckMark":"",className:i.checkmarkIcon,onClick:function(e){return t(o,e)}}):null},oe=function(e){var t=e.item,o=e.classNames;return t.text||t.name?r.createElement("span",{className:o.label},t.text||t.name):null},ie=function(e){var t=e.item,o=e.classNames;return t.secondaryText?r.createElement("span",{className:o.secondaryText},t.secondaryText):null},ne=function(e){var t=e.item,o=e.classNames,i=e.theme;return J(t)?r.createElement(R,(0,n.__assign)({iconName:(0,j.jI)(i)?"ChevronLeft":"ChevronRight"},t.submenuIconProps,{className:o.subMenuIcon})):null},re=function(e){function t(t){var o=e.call(this,t)||this;return o.openSubMenu=function(){var e=o.props,t=e.item,i=e.openSubMenu,n=e.getSubmenuTarget;if(n){var r=n();J(t)&&i&&r&&i(t,r)}},o.dismissSubMenu=function(){var e=o.props,t=e.item,i=e.dismissSubMenu;J(t)&&i&&i()},o.dismissMenu=function(e){var t=o.props.dismissMenu;t&&t(void 0,e)},(0,h.f)(o),o}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.item,o=e.classNames,i=t.onRenderContent||this._renderLayout;return r.createElement("div",{className:t.split?o.linkContentMenu:o.linkContent},i(this.props,{renderCheckMarkIcon:te,renderItemIcon:ee,renderItemName:oe,renderSecondaryText:ie,renderSubMenuIcon:ne}))},t.prototype._renderLayout=function(e,t){return r.createElement(r.Fragment,null,t.renderCheckMarkIcon(e),t.renderItemIcon(e),t.renderItemName(e),t.renderSecondaryText(e),t.renderSubMenuIcon(e))},t}(r.Component),se=(0,a.J9)((function(e){return(0,i.l8)({wrapper:{display:"inline-flex",height:"100%",alignItems:"center"},divider:{width:1,height:"100%",backgroundColor:e.palette.neutralTertiaryAlt}})})),ae=o(57144),le="28px",ce=(0,i.L6)(0,i.mm),ue=(0,a.J9)((function(e){var t;return(0,i.l8)(se(e),{wrapper:{position:"absolute",right:28,selectors:(t={},t[ce]={right:32},t)},divider:{height:16,width:1}})})),de={item:"ms-ContextualMenu-item",divider:"ms-ContextualMenu-divider",root:"ms-ContextualMenu-link",isChecked:"is-checked",isExpanded:"is-expanded",isDisabled:"is-disabled",linkContent:"ms-ContextualMenu-linkContent",linkContentMenu:"ms-ContextualMenu-linkContent",icon:"ms-ContextualMenu-icon",iconColor:"ms-ContextualMenu-iconColor",checkmarkIcon:"ms-ContextualMenu-checkmarkIcon",subMenuIcon:"ms-ContextualMenu-submenuIcon",label:"ms-ContextualMenu-itemText",secondaryText:"ms-ContextualMenu-secondaryText",splitMenu:"ms-ContextualMenu-splitMenu",screenReaderText:"ms-ContextualMenu-screenReaderText"},he=(0,a.J9)((function(e,t,o,n,r,s,a,l,c,u,h,g){var p,f,m,v,b=(0,ae.J)(e),y=(0,i.Km)(de,e);return(0,i.l8)({item:[y.item,b.item,a],divider:[y.divider,b.divider,l],root:[y.root,b.root,n&&[y.isChecked,b.rootChecked],r&&b.anchorLink,o&&[y.isExpanded,b.rootExpanded],t&&[y.isDisabled,b.rootDisabled],!t&&!o&&[{selectors:(p={":hover":b.rootHovered,":active":b.rootPressed},p[".".concat(d.Y2," &:focus, .").concat(d.Y2," &:focus:hover, :host(.").concat(d.Y2,") &:focus, :host(.").concat(d.Y2,") &:focus:hover")]=b.rootFocused,p[".".concat(d.Y2," &:hover, :host(.").concat(d.Y2,") &:hover")]={background:"inherit;"},p)}],g],splitPrimary:[b.root,{width:"calc(100% - ".concat(le,")")},n&&["is-checked",b.rootChecked],(t||h)&&["is-disabled",b.rootDisabled],!(t||h)&&!n&&[{selectors:(f={":hover":b.rootHovered},f[":hover ~ .".concat(y.splitMenu)]=b.rootHovered,f[":active"]=b.rootPressed,f[".".concat(d.Y2," &:focus, .").concat(d.Y2," &:focus:hover, :host(.").concat(d.Y2,") &:focus, :host(.").concat(d.Y2,") &:focus:hover")]=b.rootFocused,f[".".concat(d.Y2," &:hover, :host(.").concat(d.Y2,") &:hover")]={background:"inherit;"},f)}]],splitMenu:[y.splitMenu,b.root,{flexBasis:"0",padding:"0 8px",minWidth:le},o&&["is-expanded",b.rootExpanded],t&&["is-disabled",b.rootDisabled],!t&&!o&&[{selectors:(m={":hover":b.rootHovered,":active":b.rootPressed},m[".".concat(d.Y2," &:focus, .").concat(d.Y2," &:focus:hover, :host(.").concat(d.Y2,") &:focus, :host(.").concat(d.Y2,") &:focus:hover")]=b.rootFocused,m[".".concat(d.Y2," &:hover, :host(.").concat(d.Y2,") &:hover")]={background:"inherit;"},m)}]],anchorLink:b.anchorLink,linkContent:[y.linkContent,b.linkContent],linkContentMenu:[y.linkContentMenu,b.linkContent,{justifyContent:"center"}],icon:[y.icon,s&&b.iconColor,b.icon,c,t&&[y.isDisabled,b.iconDisabled]],iconColor:b.iconColor,checkmarkIcon:[y.checkmarkIcon,s&&b.checkmarkIcon,b.icon,c],subMenuIcon:[y.subMenuIcon,b.subMenuIcon,u,o&&{color:e.palette.neutralPrimary},t&&[b.iconDisabled]],label:[y.label,b.label],secondaryText:[y.secondaryText,b.secondaryText],splitContainer:[b.splitButtonFlexContainer,!t&&!n&&[{selectors:(v={},v[".".concat(d.Y2," &:focus, .").concat(d.Y2," &:focus:hover, :host(.").concat(d.Y2,") &:focus, :host(.").concat(d.Y2,") &:focus:hover")]=b.rootFocused,v)}]],screenReaderText:[y.screenReaderText,b.screenReaderText,i.dX,{visibility:"hidden"}]})})),ge=function(e){var t=e.theme,o=e.disabled,i=e.expanded,n=e.checked,r=e.isAnchorLink,s=e.knownIcon,a=e.itemClassName,l=e.dividerClassName,c=e.iconClassName,u=e.subMenuClassName,d=e.primaryDisabled,h=e.className;return he(t,o,i,n,r,s,a,l,c,u,d,h)},pe=(0,k.I)(re,ge,void 0,{scope:"ContextualMenuItem"}),fe=function(e){function t(t){var o=e.call(this,t)||this;return o._onItemMouseEnter=function(e){var t=o.props,i=t.item,n=t.onItemMouseEnter;n&&n(i,e,e.currentTarget)},o._onItemClick=function(e){var t=o.props,i=t.item,n=t.onItemClickBase;n&&n(i,e,e.currentTarget)},o._onItemMouseLeave=function(e){var t=o.props,i=t.item,n=t.onItemMouseLeave;n&&n(i,e)},o._onItemKeyDown=function(e){var t=o.props,i=t.item,n=t.onItemKeyDown;n&&n(i,e)},o._onItemMouseMove=function(e){var t=o.props,i=t.item,n=t.onItemMouseMove;n&&n(i,e,e.currentTarget)},o._getSubmenuTarget=function(){},(0,h.f)(o),o}return(0,n.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return!(0,v.ab)(e,this.props)},t}(r.Component),me=o(39827),ve=o(66098),be=function(e){var t,o=e.children,i=(0,n.__rest)(e,["children"]),r=(0,ve.i)(i),s=r.keytipId,a=r.ariaDescribedBy;return o(((t={})[me.aR]=s,t[me.er]=s,t["aria-describedby"]=a,t))},ye=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._anchor=r.createRef(),t._getMemoizedMenuButtonKeytipProps=(0,a.J9)((function(e){return(0,n.__assign)((0,n.__assign)({},e),{hasMenu:!0})})),t._getSubmenuTarget=function(){return t._anchor.current?t._anchor.current:void 0},t._onItemClick=function(e){var o=t.props,i=o.item,n=o.onItemClick;n&&n(i,e)},t._renderAriaDescription=function(e,o){return e?r.createElement("span",{id:t._ariaDescriptionId,className:o},e):null},t}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.item,i=t.classNames,s=t.index,a=t.focusableElementIndex,l=t.totalItemCount,c=t.hasCheckmarks,u=t.hasIcons,d=t.expandedMenuItemKey,h=t.onItemClick,g=t.openSubMenu,p=t.dismissSubMenu,v=t.dismissMenu,b=pe;this.props.item.contextualMenuItemAs&&(b=$(this.props.item.contextualMenuItemAs,b)),this.props.contextualMenuItemAs&&(b=$(this.props.contextualMenuItemAs,b));var y=o.rel;o.target&&"_blank"===o.target.toLowerCase()&&(y=y||"nofollow noopener noreferrer");var w=J(o),C=(0,m.G1)(o,m.t0),k=Y(o),T=o.itemProps,x=o.ariaDescription,_=o.keytipProps;_&&w&&(_=this._getMemoizedMenuButtonKeytipProps(_)),x&&(this._ariaDescriptionId=(0,f.O)());var I=(0,S._)(o.ariaDescribedBy,x?this._ariaDescriptionId:void 0,C["aria-describedby"]),E={"aria-describedby":I};return r.createElement("div",null,r.createElement(be,{keytipProps:o.keytipProps,ariaDescribedBy:I,disabled:k},(function(t){return r.createElement("a",(0,n.__assign)({},E,C,t,{ref:e._anchor,href:o.href,target:o.target,rel:y,className:i.root,role:"menuitem","aria-haspopup":w||void 0,"aria-expanded":w?o.key===d:void 0,"aria-posinset":a+1,"aria-setsize":l,"aria-disabled":Y(o),style:o.style,onClick:e._onItemClick,onMouseEnter:e._onItemMouseEnter,onMouseLeave:e._onItemMouseLeave,onMouseMove:e._onItemMouseMove,onKeyDown:w?e._onItemKeyDown:void 0}),r.createElement(b,(0,n.__assign)({componentRef:o.componentRef,item:o,classNames:i,index:s,onCheckmarkClick:c&&h?h:void 0,hasIcons:u,openSubMenu:g,dismissSubMenu:p,dismissMenu:v,getSubmenuTarget:e._getSubmenuTarget},T)),e._renderAriaDescription(x,i.screenReaderText))})))},t}(fe),we=(0,_.Z)(),Ce=r.forwardRef((function(e,t){var o=e.styles,i=e.theme,n=e.getClassNames,s=e.className,a=we(o,{theme:i,getClassNames:n,className:s});return r.createElement("span",{className:a.wrapper,ref:t},r.createElement("span",{className:a.divider}))}));Ce.displayName="VerticalDividerBase";var Se=(0,k.I)(Ce,(function(e){var t=e.theme,o=e.getClassNames,i=e.className;if(!t)throw new Error("Theme is undefined or null.");if(o){var n=o(t);return{wrapper:[n.wrapper],divider:[n.divider]}}return{wrapper:[{display:"inline-flex",height:"100%",alignItems:"center"},i],divider:[{width:1,height:"100%",backgroundColor:t.palette.neutralTertiaryAlt}]}}),void 0,{scope:"VerticalDivider"}),ke=function(e){function t(t){var o=e.call(this,t)||this;return o._getMemoizedMenuButtonKeytipProps=(0,a.J9)((function(e){return(0,n.__assign)((0,n.__assign)({},e),{hasMenu:!0})})),o._onItemKeyDown=function(e){var t=o.props,i=t.item,n=t.onItemKeyDown;e.which===u.c.enter?(o._executeItemClick(e),e.preventDefault(),e.stopPropagation()):n&&n(i,e)},o._getSubmenuTarget=function(){return o._splitButton},o._renderAriaDescription=function(e,t){return e?r.createElement("span",{id:o._ariaDescriptionId,className:t},e):null},o._onItemMouseEnterPrimary=function(e){var t=o.props,i=t.item,r=t.onItemMouseEnter;r&&r((0,n.__assign)((0,n.__assign)({},i),{subMenuProps:void 0,items:void 0}),e,o._splitButton)},o._onItemMouseEnterIcon=function(e){var t=o.props,i=t.item,n=t.onItemMouseEnter;n&&n(i,e,o._splitButton)},o._onItemMouseMovePrimary=function(e){var t=o.props,i=t.item,r=t.onItemMouseMove;r&&r((0,n.__assign)((0,n.__assign)({},i),{subMenuProps:void 0,items:void 0}),e,o._splitButton)},o._onItemMouseMoveIcon=function(e){var t=o.props,i=t.item,n=t.onItemMouseMove;n&&n(i,e,o._splitButton)},o._onIconItemClick=function(e){var t=o.props,i=t.item,n=t.onItemClickBase;n&&n(i,e,o._splitButton?o._splitButton:e.currentTarget)},o._executeItemClick=function(e){var t=o.props,i=t.item,n=t.executeItemClick,r=t.onItemClick;if(!i.disabled&&!i.isDisabled)return o._processingTouch&&!i.canCheck&&r?r(i,e):void(n&&n(i,e))},o._onTouchStart=function(e){o._splitButton&&!("onpointerdown"in o._splitButton)&&o._handleTouchAndPointerEvent(e)},o._onPointerDown=function(e){"touch"===e.pointerType&&(o._handleTouchAndPointerEvent(e),e.preventDefault(),e.stopImmediatePropagation())},o._async=new g.j(o),o._events=new p.g(o),o._dismissLabelId=(0,f.O)(),o}return(0,n.__extends)(t,e),t.prototype.componentDidMount=function(){this._splitButton&&"onpointerdown"in this._splitButton&&this._events.on(this._splitButton,"pointerdown",this._onPointerDown,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e,t=this,o=this.props,i=o.item,s=o.classNames,a=o.index,l=o.focusableElementIndex,c=o.totalItemCount,u=o.hasCheckmarks,d=o.hasIcons,h=o.onItemMouseLeave,g=o.expandedMenuItemKey,p=J(i),m=i.keytipProps;m&&(m=this._getMemoizedMenuButtonKeytipProps(m));var v=i.ariaDescription;v&&(this._ariaDescriptionId=(0,f.O)());var b=null!==(e=K(i))&&void 0!==e?e:void 0;return r.createElement(be,{keytipProps:m,disabled:Y(i)},(function(e){return r.createElement("div",{"data-ktp-target":e["data-ktp-target"],ref:function(e){return t._splitButton=e},role:Q(i),"aria-label":i.ariaLabel,className:s.splitContainer,"aria-disabled":Y(i),"aria-expanded":p?i.key===g:void 0,"aria-haspopup":!0,"aria-describedby":(0,S._)(i.ariaDescribedBy,v?t._ariaDescriptionId:void 0,e["aria-describedby"]),"aria-checked":b,"aria-posinset":l+1,"aria-setsize":c,onMouseEnter:t._onItemMouseEnterPrimary,onMouseLeave:h?h.bind(t,(0,n.__assign)((0,n.__assign)({},i),{subMenuProps:null,items:null})):void 0,onMouseMove:t._onItemMouseMovePrimary,onKeyDown:t._onItemKeyDown,onClick:t._executeItemClick,onTouchStart:t._onTouchStart,tabIndex:0,"data-is-focusable":!0,"aria-roledescription":i["aria-roledescription"]},t._renderSplitPrimaryButton(i,s,a,u,d),t._renderSplitDivider(i),t._renderSplitIconButton(i,s,a,e),t._renderAriaDescription(v,s.screenReaderText))}))},t.prototype._renderSplitPrimaryButton=function(e,t,o,i,s){var a=this.props,l=a.contextualMenuItemAs,c=void 0===l?pe:l,u=a.onItemClick,d={key:e.key,disabled:Y(e)||e.primaryDisabled,name:e.name,text:e.text||e.name,secondaryText:e.secondaryText,className:t.splitPrimary,canCheck:e.canCheck,isChecked:e.isChecked,checked:e.checked,iconProps:e.iconProps,id:this._dismissLabelId,onClick:e.onClick,onRenderIcon:e.onRenderIcon,data:e.data,"data-is-focusable":!1},h=e.itemProps;return r.createElement("button",(0,n.__assign)({},(0,m.G1)(d,m.uw)),r.createElement(c,(0,n.__assign)({"data-is-focusable":!1,item:d,classNames:t,index:o,onCheckmarkClick:i&&u?u:void 0,hasIcons:s},h)))},t.prototype._renderSplitDivider=function(e){var t=e.getSplitButtonVerticalDividerClassNames||ue;return r.createElement(Se,{getClassNames:t})},t.prototype._renderSplitIconButton=function(e,t,o,i){var s=this.props,a=s.onItemMouseLeave,l=s.onItemMouseDown,c=s.openSubMenu,u=s.dismissSubMenu,d=s.dismissMenu,h=pe;this.props.item.contextualMenuItemAs&&(h=$(this.props.item.contextualMenuItemAs,h)),this.props.contextualMenuItemAs&&(h=$(this.props.contextualMenuItemAs,h));var g={onClick:this._onIconItemClick,disabled:Y(e),className:t.splitMenu,subMenuProps:e.subMenuProps,submenuIconProps:e.submenuIconProps,split:!0,key:e.key,"aria-labelledby":this._dismissLabelId},p=(0,n.__assign)((0,n.__assign)({},(0,m.G1)(g,m.uw)),{onMouseEnter:this._onItemMouseEnterIcon,onMouseLeave:a?a.bind(this,e):void 0,onMouseDown:function(t){return l?l(e,t):void 0},onMouseMove:this._onItemMouseMoveIcon,"data-is-focusable":!1,"data-ktp-execute-target":i["data-ktp-execute-target"],"aria-haspopup":!0}),f=e.itemProps;return r.createElement("button",(0,n.__assign)({},p),r.createElement(h,(0,n.__assign)({componentRef:e.componentRef,item:g,classNames:t,index:o,hasIcons:!1,openSubMenu:c,dismissSubMenu:u,dismissMenu:d,getSubmenuTarget:this._getSubmenuTarget},f)))},t.prototype._handleTouchAndPointerEvent=function(e){var t=this,o=this.props.onTap;o&&o(e),this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){t._processingTouch=!1,t._lastTouchTimeoutId=void 0}),500)},t}(fe),Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._btn=r.createRef(),t._getMemoizedMenuButtonKeytipProps=(0,a.J9)((function(e){return(0,n.__assign)((0,n.__assign)({},e),{hasMenu:!0})})),t._renderAriaDescription=function(e,o){return e?r.createElement("span",{id:t._ariaDescriptionId,className:o},e):null},t._getSubmenuTarget=function(){return t._btn.current?t._btn.current:void 0},t}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,o=t.item,i=t.classNames,s=t.index,a=t.focusableElementIndex,l=t.totalItemCount,c=t.hasCheckmarks,u=t.hasIcons,d=t.contextualMenuItemAs,h=t.expandedMenuItemKey,g=t.onItemMouseDown,p=t.onItemClick,v=t.openSubMenu,b=t.dismissSubMenu,y=t.dismissMenu,w=pe;o.contextualMenuItemAs&&(w=$(o.contextualMenuItemAs,w)),d&&(w=$(d,w));var C=K(o),k=null!==C,T=Q(o),x=J(o),_=o.itemProps,I=o.ariaLabel,E=o.ariaDescription,B=(0,m.G1)(o,m.uw);delete B.disabled;var A=o.role||T;E&&(this._ariaDescriptionId=(0,f.O)());var R=(0,S._)(o.ariaDescribedBy,E?this._ariaDescriptionId:void 0,B["aria-describedby"]),M={className:i.root,onClick:this._onItemClick,onKeyDown:x?this._onItemKeyDown:void 0,onMouseEnter:this._onItemMouseEnter,onMouseLeave:this._onItemMouseLeave,onMouseDown:function(e){return g?g(o,e):void 0},onMouseMove:this._onItemMouseMove,href:o.href,title:o.title,"aria-label":I,"aria-describedby":R,"aria-haspopup":x||void 0,"aria-expanded":x?o.key===h:void 0,"aria-posinset":a+1,"aria-setsize":l,"aria-disabled":Y(o),"aria-checked":"menuitemcheckbox"!==A&&"menuitemradio"!==A||!k?void 0:!!C,"aria-selected":"menuitem"===A&&k?!!C:void 0,role:A,style:o.style},D=o.keytipProps;return D&&x&&(D=this._getMemoizedMenuButtonKeytipProps(D)),r.createElement(be,{keytipProps:D,ariaDescribedBy:R,disabled:Y(o)},(function(t){return r.createElement("button",(0,n.__assign)({ref:e._btn},B,M,t),r.createElement(w,(0,n.__assign)({componentRef:o.componentRef,item:o,classNames:i,index:s,onCheckmarkClick:c&&p?p:void 0,hasIcons:u,openSubMenu:v,dismissSubMenu:b,dismissMenu:y,getSubmenuTarget:e._getSubmenuTarget},_)),e._renderAriaDescription(E,i.screenReaderText))}))},t}(fe),xe=o(15289),_e=o(54937),Ie=o(66e3),Ee=o(83758),Be=o(91449),Ae=o(52053),Re=o(94510),Me=o(18465),De=r.createContext({}),Pe=(0,_.Z)(),Fe=(0,_.Z)(),Oe={items:[],shouldFocusOnMount:!0,gapSpace:0,directionalHint:P.A.bottomAutoEdge,beakWidth:16};function Ne(e){for(var t=0,o=0,i=e;o<i.length;o++){var n=i[o];n.itemType!==M.Divider&&n.itemType!==M.Header&&(t+=n.customOnRenderListLength?n.customOnRenderListLength:1)}return t}function qe(e,t){var o=null==t?void 0:t.target,i=e.subMenuProps?e.subMenuProps.items:e.items;if(i){for(var r=[],s=0,a=i;s<a.length;s++){var l=a[s];if(l.preferMenuTargetAsEventTarget){var c=l.onClick,u=(0,n.__rest)(l,["onClick"]);r.push((0,n.__assign)((0,n.__assign)({},u),{onClick:$e(c,o)}))}else r.push(l)}return r}}var je="ContextualMenu",Le=(0,a.J9)((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){return i.pB.apply(void 0,(0,n.__spreadArray)([t,ge],e,!1))}}));function ze(e,t){var o=e.hidden,i=e.items,n=e.theme,s=e.className,a=e.id,l=e.target,c=r.useState(),u=c[0],d=c[1],h=r.useState(),g=h[0],p=h[1],f=r.useState(),m=f[0],b=f[1],y=(0,_e.B)(je,a),w=r.useCallback((function(){b(void 0),d(void 0),p(void 0)}),[]),C=r.useCallback((function(e,t,o){var i=e.key;u!==i&&(t.focus(),b(o),d(i),p(t))}),[u]);r.useEffect((function(){o&&w()}),[o,w]);var S=function(e,t){var o=r.useRef(!1);r.useEffect((function(){return o.current=!0,function(){o.current=!1}}),[]);return function(i,n){n?e(i,n):o.current&&t()}}(t,w);return[u,C,function(){var e=Ve(u,i),t=null;if(e&&(t={items:qe(e,{target:l}),target:g,onDismiss:S,isSubMenu:!0,id:y,shouldFocusOnMount:!0,shouldFocusOnContainer:m,directionalHint:(0,j.jI)(n)?P.A.leftTopEdge:P.A.rightTopEdge,className:s,gapSpace:0,isBeakVisible:!1},e.subMenuProps&&(0,v.kp)(t,e.subMenuProps),e.preferMenuTargetAsEventTarget)){var o=e.onItemClick;t.onItemClick=$e(o,l)}return t},S]}var He=r.memo(r.forwardRef((function(e,t){var o,i=(0,G.N)(Oe,e),s=(i.ref,(0,n.__rest)(i,["ref"])),a=r.useRef(null),c=(0,Ee.Y)(),d=(0,_e.B)(je,s.id),h=function(e,t){var o;return null===(o=s.onDismiss)||void 0===o?void 0:o.call(s,e,t)},g=(0,Be.P)(s.target,a),p=g[0],f=g[1],v=function(e,t,o){var i=e.hidden,n=e.onRestoreFocus,s=r.useRef(),a=r.useCallback((function(e){var t,o;n?n(e):(null==e?void 0:e.documentContainsFocus)&&(null===(o=null===(t=s.current)||void 0===t?void 0:t.focus)||void 0===o||o.call(t))}),[n]);return(0,Ie.E)((function(){var e,n;if(i)s.current&&(a({originalElement:s.current,containsFocus:!0,documentContainsFocus:(null===(n=(0,L.Y)())||void 0===n?void 0:n.hasFocus())||!1}),s.current=void 0);else{var r=null==t?void 0:t.document.activeElement;(null===(e=o.current)||void 0===e?void 0:e.contains(r))||"BODY"===r.tagName||(s.current=r)}}),[i,null==t?void 0:t.document.activeElement,a,o]),[a]}(s,f,a)[0],b=ze(s,h),y=b[0],w=b[1],S=b[2],k=b[3],T=function(e){var t=e.delayUpdateFocusOnHover,o=e.hidden,i=r.useRef(!t),n=r.useRef(!1);r.useEffect((function(){i.current=!t,n.current=!o&&!t&&n.current}),[t,o]);var s=r.useCallback((function(){t&&(i.current=!1)}),[t]);return[i,n,s]}(s),x=T[0],_=T[1],I=T[2],E=function(e){var t=r.useRef(!0),o=r.useRef();return[function(){t.current||void 0===o.current?t.current=!1:(e.clearTimeout(o.current),o.current=void 0),o.current=e.setTimeout((function(){t.current=!0}),250)},t]}(c),B=E[0],A=E[1],R=function(e,t){var o=e.subMenuHoverDelay,i=void 0===o?250:o,n=r.useRef(void 0),s=function(){void 0!==n.current&&(t.clearTimeout(n.current),n.current=void 0)};return[s,function(e){n.current=t.setTimeout((function(){e(),s()}),i)},n]}(s,c),D=R[0],P=R[1],F=R[2],O=function(e,t){var o=r.useState((0,Re.YF)()),i=o[0],n=o[1],s=r.useCallback((function(){var t=(0,Re.kA)((0,H.z)(e.current));i!==t&&n(t)}),[e,i]),a=(0,Me.ox)();return(0,Ae.x)(a,"resize",s),r.useEffect((function(){void 0===t&&s()}),[t]),null!=t?t:i}(a,s.responsiveMode);!function(e,t){var o=e.hidden,i=void 0!==o&&o,n=e.onMenuDismissed,s=e.onMenuOpened,a=(0,xe.Z)(i),l=r.useRef(s),c=r.useRef(n),u=r.useRef(e);l.current=s,c.current=n,u.current=e,r.useEffect((function(){var e,t;i&&!1===a?null===(e=c.current)||void 0===e||e.call(c,u.current):i||!1===a||null===(t=l.current)||void 0===t||t.call(l,u.current)}),[i,a]),r.useEffect((function(){return function(){var e;return null===(e=c.current)||void 0===e?void 0:e.call(c,u.current)}}),[])}(s);var V,Q=function(e,t,o,i){var n=e.theme,s=e.isSubMenu,a=e.focusZoneProps,l=void 0===a?{}:a,c=l.checkForNoWrap,d=l.direction,h=void 0===d?N.E.vertical:d,g=r.useRef(),p=function(e,o,i){var n=!1;return o(e)&&(t(e,i),e.preventDefault(),e.stopPropagation(),n=!0),n},f=function(e){return e.which===u.c.escape||function(e){var t=(0,j.jI)(n)?u.c.right:u.c.left;return!(e.which!==t||!s||h!==N.E.vertical&&(!c||(0,z._l)(e.target,"data-no-horizontal-wrap")))}(e)||e.which===u.c.up&&(e.altKey||e.metaKey)},m=function(e){g.current=We(e);var t=e.which===u.c.escape&&(W()||U());return p(e,f,t)},v=function(e){var t=g.current&&We(e);return g.current=!1,!!t&&!(U()||W())};return[m,function(e){return p(e,v,!0)},function(e){if(!m(e)&&o.current){var t=!(!e.altKey&&!e.metaKey),i=e.which===u.c.up,n=e.which===u.c.down;if(!t&&(i||n)){var r=i?(0,z.dm)(o.current,o.current.lastChild,!0):(0,z.j5)(o.current,o.current.firstChild,!0);r&&(r.focus(),e.preventDefault(),e.stopPropagation())}}},function(e,t){var o=(0,j.jI)(n)?u.c.left:u.c.right;e.disabled||t.which!==o&&t.which!==u.c.enter&&(t.which!==u.c.down||!t.altKey&&!t.metaKey)||(i(e,t.currentTarget),t.preventDefault())}]}(s,h,a,w),X=Q[0],ee=Q[1],te=Q[2],oe=Q[3],ie=function(e,t,o,i,n,r,s,a,l,c,u,d,h){var g=e.target,p=function(){return!t.current||!r.current},f=function(e,t,o){var i=o||t.currentTarget;e.key!==s&&(c(),void 0===s&&i.focus(),J(e)?(t.stopPropagation(),l((function(){i.focus(),u(e,i,!0)}))):l((function(){d(t),i.focus()})))},m=function(t,o,i){var n=qe(t,{target:g});if(c(),J(t)||n&&n.length){if(t.key!==s){var r="boolean"==typeof e.shouldFocusOnContainer?e.shouldFocusOnContainer:"mouse"===o.nativeEvent.pointerType;u(t,i,r)}}else v(t,o);o.stopPropagation(),o.preventDefault()},v=function(t,o){if(!t.disabled&&!t.isDisabled){t.preferMenuTargetAsEventTarget&&Ke(o,g);var i=!1;t.onClick?i=!!t.onClick(o,t):e.onItemClick&&(i=!!e.onItemClick(o,t)),!i&&o.defaultPrevented||h(o,!0)}};return[function(e,t,o){n.current&&(r.current=!0),p()||f(e,t,o)},function(e,s,a){var l=s.currentTarget;n.current&&(r.current=!0,t.current&&void 0===o.current&&l!==(null==i?void 0:i.document.activeElement)&&f(e,s,a))},function(e,t){var o;if(!p()&&(c(),void 0===s))if(a.current.setActive)try{a.current.setActive()}catch(e){}else null===(o=a.current)||void 0===o||o.focus()},function(e,t){m(e,t,t.currentTarget)},function(e,t){v(e,t),t.stopPropagation()},v,m]}(s,A,F,f,x,_,y,a,P,D,w,k,h),ne=ie[0],re=ie[1],se=ie[2],ae=ie[3],le=ie[4],ce=ie[5],ue=ie[6],de=function(e,t,o){var i=0,n=e.items,s=e.totalItemCount,a=e.hasCheckmarks,l=e.hasIcons;return r.createElement("ul",{className:t.list,onKeyDown:X,onKeyUp:ee,role:"presentation"},n.map((function(e,o){var n=he(e,o,i,s,a,l,t);if(e.itemType!==M.Divider&&e.itemType!==M.Header){var r=e.customOnRenderListLength?e.customOnRenderListLength:1;i+=r}return n})))},he=function(e,t,o,i,n,a,l){var c,u,d=[],h=e.iconProps||{iconName:"None"},g=e.getItemClassNames,p=e.itemProps,f=p?p.styles:void 0,m=e.itemType===M.Divider?e.className:void 0,v=e.submenuIconProps?e.submenuIconProps.className:"";if(g)u=g(s.theme,Y(e),y===e.key,!!K(e),!!e.href,"None"!==h.iconName,e.className,m,h.className,v,e.primaryDisabled);else{var b={theme:s.theme,disabled:Y(e),expanded:y===e.key,checked:!!K(e),isAnchorLink:!!e.href,knownIcon:"None"!==h.iconName,itemClassName:e.className,dividerClassName:m,iconClassName:h.className,subMenuClassName:v,primaryDisabled:e.primaryDisabled};u=Fe(Le(null===(c=l.subComponentStyles)||void 0===c?void 0:c.menuItem,f),b)}switch("-"!==e.text&&"-"!==e.name||(e.itemType=M.Divider),e.itemType){case M.Divider:d.push(me(t,u));break;case M.Header:d.push(me(t,u));var w=be(e,u,l,t,n,a);d.push(fe(w,e.key||t,u,e.title));break;case M.Section:d.push(ge(e,u,l,t,n,a));break;default:var C=function(){return ve(e,u,t,o,i,n,a)},S=s.onRenderContextualMenuItem?s.onRenderContextualMenuItem(e,C):C();d.push(fe(S,e.key||t,u,e.title))}return r.createElement(r.Fragment,{key:e.key},d)},ge=function(e,t,o,i,s,a){var l=e.sectionProps;if(l){var c,u;if(l.title){var h=void 0,g="";if("string"==typeof l.title){var p=d+l.title.replace(/\s/g,"");h={key:"section-".concat(l.title,"-title"),itemType:M.Header,text:l.title,id:p},g=p}else{var f=l.title.id||d+l.title.key.replace(/\s/g,"");h=(0,n.__assign)((0,n.__assign)({},l.title),{id:f}),g=f}h&&(u={role:"group","aria-labelledby":g},c=be(h,t,o,i,s,a))}if(l.items&&l.items.length>0){var m=0;return r.createElement("li",{role:"presentation",key:l.key||e.key||"section-".concat(i)},r.createElement("div",(0,n.__assign)({},u),r.createElement("ul",{className:o.list,role:"presentation"},l.topDivider&&me(i,t,!0,!0),c&&fe(c,e.key||i,t,e.title),l.items.map((function(e,t){var i=he(e,t,m,Ne(l.items),s,a,o);if(e.itemType!==M.Divider&&e.itemType!==M.Header){var n=e.customOnRenderListLength?e.customOnRenderListLength:1;m+=n}return i})),l.bottomDivider&&me(i,t,!1,!0))))}}},fe=function(e,t,o,i){return r.createElement("li",{role:"presentation",title:i,key:t,className:o.item},e)},me=function(e,t,o,i){return i||e>0?r.createElement("li",{role:"separator",key:"separator-"+e+(void 0===o?"":o?"-top":"-bottom"),className:t.divider,"aria-hidden":"true"}):null},ve=function(e,t,o,i,a,l,c){if(e.onRender)return e.onRender((0,n.__assign)({"aria-posinset":i+1,"aria-setsize":a},e),h);var u={item:e,classNames:t,index:o,focusableElementIndex:i,totalItemCount:a,hasCheckmarks:l,hasIcons:c,contextualMenuItemAs:s.contextualMenuItemAs,onItemMouseEnter:ne,onItemMouseLeave:se,onItemMouseMove:re,onItemMouseDown:Ue,executeItemClick:ce,onItemKeyDown:oe,expandedMenuItemKey:y,openSubMenu:w,dismissSubMenu:k,dismissMenu:h};if(e.href){var d=ye;return e.contextualMenuItemWrapperAs&&(d=$(e.contextualMenuItemWrapperAs,d)),r.createElement(d,(0,n.__assign)({},u,{onItemClick:le}))}if(e.split&&J(e)){var g=ke;return e.contextualMenuItemWrapperAs&&(g=$(e.contextualMenuItemWrapperAs,g)),r.createElement(g,(0,n.__assign)({},u,{onItemClick:ae,onItemClickBase:ue,onTap:D}))}var p=Te;return e.contextualMenuItemWrapperAs&&(p=$(e.contextualMenuItemWrapperAs,p)),r.createElement(p,(0,n.__assign)({},u,{onItemClick:ae,onItemClickBase:ue}))},be=function(e,t,o,i,a,l){var c=pe;e.contextualMenuItemAs&&(c=$(e.contextualMenuItemAs,c)),s.contextualMenuItemAs&&(c=$(s.contextualMenuItemAs,c));var u=e.itemProps,d=e.id,h=u&&(0,m.G1)(u,m.JM);return r.createElement("div",(0,n.__assign)({id:d,className:o.header},h,{style:e.style}),r.createElement(c,(0,n.__assign)({item:e,classNames:t,index:i,onCheckmarkClick:a?ae:void 0,hasIcons:l},u)))},we=s.isBeakVisible,Ce=s.items,Se=s.labelElementId,He=s.id,Ve=s.className,$e=s.beakWidth,Je=s.directionalHint,Ye=s.directionalHintForRTL,Qe=s.alignTargetEdge,Ze=s.gapSpace,Xe=s.coverTarget,et=s.ariaLabel,tt=s.doNotLayer,ot=s.target,it=s.bounds,nt=s.useTargetWidth,rt=s.useTargetAsMinWidth,st=s.directionalHintFixed,at=s.shouldFocusOnMount,lt=s.shouldFocusOnContainer,ct=s.title,ut=s.styles,dt=s.theme,ht=s.calloutProps,gt=s.onRenderSubMenu,pt=void 0===gt?Ge:gt,ft=s.onRenderMenuList,mt=void 0===ft?function(e,t){return de(e,yt)}:ft,vt=s.focusZoneProps,bt=s.getMenuClassNames,yt=bt?bt(dt,Ve):Pe(ut,{theme:dt,className:Ve}),wt=function e(t){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(n.iconProps)return!0;if(n.itemType===M.Section&&n.sectionProps&&e(n.sectionProps.items))return!0}return!1}(Ce),Ct=(0,n.__assign)((0,n.__assign)({direction:N.E.vertical,handleTabKey:N.l.all,isCircularNavigation:!0,"data-tabster":'{"uncontrolled": {}, "focusable": { "excludeFromMover": true }}'},vt),{className:(0,l.A)(yt.root,null===(o=s.focusZoneProps)||void 0===o?void 0:o.className)}),St=function(e){return e.some((function(e){return!!e.canCheck||!(!e.sectionProps||!e.sectionProps.items.some((function(e){return!0===e.canCheck})))}))}(Ce),kt=y&&!0!==s.hidden?S():null;we=void 0===we?O<=Re.AR.medium:we;var Tt=p.current;if((nt||rt)&&Tt&&Tt.offsetWidth){var xt=Tt.getBoundingClientRect().width-2;nt?V={width:xt}:rt&&(V={minWidth:xt})}if(Ce&&Ce.length>0){var _t=Ne(Ce),It=yt.subComponentStyles?yt.subComponentStyles.callout:void 0;return r.createElement(De.Consumer,null,(function(e){return r.createElement(Z.P,(0,n.__assign)({styles:It,onRestoreFocus:v},ht,{target:ot||e.target,isBeakVisible:we,beakWidth:$e,directionalHint:Je,directionalHintForRTL:Ye,gapSpace:Ze,coverTarget:Xe,doNotLayer:tt,className:(0,l.A)("ms-ContextualMenu-Callout",ht&&ht.className),setInitialFocus:at,onDismiss:s.onDismiss||e.onDismiss,onScroll:B,bounds:it,directionalHintFixed:st,alignTargetEdge:Qe,hidden:s.hidden||e.hidden,ref:t}),r.createElement("div",{style:V,ref:a,id:He,className:yt.container,tabIndex:lt?0:-1,onKeyDown:te,onKeyUp:ee,onFocusCapture:I,"aria-label":et,"aria-labelledby":Se,role:"menu"},ct&&r.createElement("div",{className:yt.title}," ",ct," "),Ce&&Ce.length?function(e,t){var o=s.focusZoneAs,i=void 0===o?q.R:o;return r.createElement(i,(0,n.__assign)({},t),e)}(mt({ariaLabel:et,items:Ce,totalItemCount:_t,hasCheckmarks:St,hasIcons:wt,defaultMenuItemRenderer:function(e){return function(e,t){var o=e.index,i=e.focusableElementIndex,n=e.totalItemCount,r=e.hasCheckmarks,s=e.hasIcons;return he(e,o,i,n,r,s,t)}(e,yt)},labelElementId:Se},(function(e,t){return de(e,yt)})),Ct):null,kt&&pt(kt,Ge)),r.createElement(C.MO,null))}))}return null})),(function(e,t){return!(t.shouldUpdateWhenHidden||!e.hidden||!t.hidden)||(0,v.ab)(e,t)}));function We(e){return e.which===u.c.alt||"Meta"===e.key}function Ue(e,t){var o;null===(o=e.onMouseDown)||void 0===o||o.call(e,e,t)}function Ge(e,t){throw Error("ContextualMenuBase: onRenderSubMenu callback is null or undefined. Please ensure to set `onRenderSubMenu` property either manually or with `styled` helper.")}function Ve(e,t){for(var o=0,i=t;o<i.length;o++){var n=i[o];if(n.itemType===M.Section&&n.sectionProps){var r=Ve(e,n.sectionProps.items);if(r)return r}else if(n.key&&n.key===e)return n}}function $e(e,t){return e?function(o,i){return Ke(o,t),e(o,i)}:e}function Ke(e,t){e&&t&&(e.persist(),t instanceof Event?e.target=t.target:t instanceof Element&&(e.target=t))}He.displayName="ContextualMenuBase";var Je={root:"ms-ContextualMenu",container:"ms-ContextualMenu-container",list:"ms-ContextualMenu-list",header:"ms-ContextualMenu-header",title:"ms-ContextualMenu-title",isopen:"is-open"};function Ye(e){return r.createElement(Qe,(0,n.__assign)({},e))}var Qe=(0,k.I)(He,(function(e){var t=e.className,o=e.theme,n=(0,i.Km)(Je,o),r=o.fonts,s=o.semanticColors,a=o.effects;return{root:[o.fonts.medium,n.root,n.isopen,{backgroundColor:s.menuBackground,minWidth:"180px"},t],container:[n.container,{selectors:{":focus":{outline:0}}}],list:[n.list,n.isopen,{listStyleType:"none",margin:"0",padding:"0"}],header:[n.header,r.small,{fontWeight:i.BO.semibold,color:s.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:ae.C,lineHeight:ae.C,cursor:"default",padding:"0px 6px",userSelect:"none",textAlign:"left"}],title:[n.title,{fontSize:r.mediumPlus.fontSize,paddingRight:"14px",paddingLeft:"14px",paddingBottom:"5px",paddingTop:"5px",backgroundColor:s.menuItemBackgroundPressed}],subComponentStyles:{callout:{root:{boxShadow:a.elevation8}},menuItem:{}}}}),(function(e){return{onRenderSubMenu:e.onRenderSubMenu?(t=e.onRenderSubMenu,o=Ye,F(t)(o)):Ye};var t,o}),{scope:"ContextualMenu"}),Ze=Qe;Ze.displayName="ContextualMenu";var Xe,et={msButton:"ms-Button",msButtonHasMenu:"ms-Button--hasMenu",msButtonIcon:"ms-Button-icon",msButtonMenuIcon:"ms-Button-menuIcon",msButtonLabel:"ms-Button-label",msButtonDescription:"ms-Button-description",msButtonScreenReaderText:"ms-Button-screenReaderText",msButtonFlexContainer:"ms-Button-flexContainer",msButtonTextContainer:"ms-Button-textContainer"},tt=(0,a.J9)((function(e,t,o,n,r,s,a,l,c,u,d){var h,g,p=(0,i.Km)(et,e||{}),f=u&&!d;return(0,i.l8)(t.__shadowConfig__,{root:[p.msButton,t.root,n,c&&["is-checked",t.rootChecked],f&&["is-expanded",t.rootExpanded,(h={},h[":hover .".concat(p.msButtonIcon)]=t.iconExpandedHovered,h[":hover .".concat(p.msButtonMenuIcon)]=t.menuIconExpandedHovered||t.rootExpandedHovered,h[":hover"]=t.rootExpandedHovered,h)],l&&[et.msButtonHasMenu,t.rootHasMenu],a&&["is-disabled",t.rootDisabled],!a&&!f&&!c&&(g={":hover":t.rootHovered},g[":hover .".concat(p.msButtonLabel)]=t.labelHovered,g[":hover .".concat(p.msButtonIcon)]=t.iconHovered,g[":hover .".concat(p.msButtonDescription)]=t.descriptionHovered,g[":hover .".concat(p.msButtonMenuIcon)]=t.menuIconHovered,g[":focus"]=t.rootFocused,g[":active"]=t.rootPressed,g[":active .".concat(p.msButtonIcon)]=t.iconPressed,g[":active .".concat(p.msButtonDescription)]=t.descriptionPressed,g[":active .".concat(p.msButtonMenuIcon)]=t.menuIconPressed,g),a&&c&&[t.rootCheckedDisabled],!a&&c&&{":hover":t.rootCheckedHovered,":active":t.rootCheckedPressed},o],flexContainer:[p.msButtonFlexContainer,t.flexContainer],textContainer:[p.msButtonTextContainer,t.textContainer],icon:[p.msButtonIcon,r,t.icon,f&&t.iconExpanded,c&&t.iconChecked,a&&t.iconDisabled],label:[p.msButtonLabel,t.label,c&&t.labelChecked,a&&t.labelDisabled],menuIcon:[p.msButtonMenuIcon,s,t.menuIcon,c&&t.menuIconChecked,a&&!d&&t.menuIconDisabled,!a&&!f&&!c&&{":hover":t.menuIconHovered,":active":t.menuIconPressed},f&&["is-expanded",t.menuIconExpanded]],description:[p.msButtonDescription,t.description,c&&t.descriptionChecked,a&&t.descriptionDisabled],screenReaderText:[p.msButtonScreenReaderText,t.screenReaderText]})})),ot=(0,a.J9)((function(e,t,o,n,r){return{root:(0,i.Zq)(e.splitButtonMenuButton,o&&[e.splitButtonMenuButtonExpanded],t&&[e.splitButtonMenuButtonDisabled],n&&!t&&[e.splitButtonMenuButtonChecked],r&&!t&&[{":focus":e.splitButtonMenuFocused}]),splitButtonContainer:(0,i.Zq)(e.splitButtonContainer,!t&&n&&[e.splitButtonContainerChecked,{":hover":e.splitButtonContainerCheckedHovered}],!t&&!n&&[{":hover":e.splitButtonContainerHovered,":focus":e.splitButtonContainerFocused}],t&&e.splitButtonContainerDisabled),icon:(0,i.Zq)(e.splitButtonMenuIcon,t&&e.splitButtonMenuIconDisabled,!t&&r&&e.splitButtonMenuIcon),flexContainer:(0,i.Zq)(e.splitButtonFlexContainer),divider:(0,i.Zq)("ms-SplitButton-divider",e.splitButtonDivider,(r||t)&&e.splitButtonDividerDisabled)}})),it=function(e){function t(t){var o=e.call(this,t)||this;return o._buttonElement=r.createRef(),o._splitButtonContainer=r.createRef(),o._mergedRef=(0,s.K)(),o._renderedVisibleMenu=!1,o._getMemoizedMenuButtonKeytipProps=(0,a.J9)((function(e){return(0,n.__assign)((0,n.__assign)({},e),{hasMenu:!0})})),o._onRenderIcon=function(e,t){var i=o.props.iconProps;if(i&&(void 0!==i.iconName||i.imageProps)){var s=i.className,a=i.imageProps,c=(0,n.__rest)(i,["className","imageProps"]);if(i.styles)return r.createElement(R,(0,n.__assign)({className:(0,l.A)(o._classNames.icon,s),imageProps:a},c));if(i.iconName)return r.createElement(I.l8,(0,n.__assign)({className:(0,l.A)(o._classNames.icon,s)},c));if(a)return r.createElement(D,(0,n.__assign)({className:(0,l.A)(o._classNames.icon,s),imageProps:a},c))}return null},o._onRenderTextContents=function(){var e=o.props,t=e.text,i=e.children,n=e.secondaryText,s=void 0===n?o.props.description:n,a=e.onRenderText,l=void 0===a?o._onRenderText:a,c=e.onRenderDescription,u=void 0===c?o._onRenderDescription:c;return t||"string"==typeof i||s?r.createElement("span",{className:o._classNames.textContainer},l(o.props,o._onRenderText),u(o.props,o._onRenderDescription)):[l(o.props,o._onRenderText),u(o.props,o._onRenderDescription)]},o._onRenderText=function(){var e=o.props.text,t=o.props.children;return void 0===e&&"string"==typeof t&&(e=t),o._hasText()?r.createElement("span",{key:o._labelId,className:o._classNames.label,id:o._labelId},e):null},o._onRenderChildren=function(){var e=o.props.children;return"string"==typeof e?null:e},o._onRenderDescription=function(e){var t=e.secondaryText,i=void 0===t?o.props.description:t;return i?r.createElement("span",{key:o._descriptionId,className:o._classNames.description,id:o._descriptionId},i):null},o._onRenderAriaDescription=function(){var e=o.props.ariaDescription;return e?r.createElement("span",{className:o._classNames.screenReaderText,id:o._ariaDescriptionId},e):null},o._onRenderMenuIcon=function(e){var t=o.props.menuIconProps;return r.createElement(I.l8,(0,n.__assign)({iconName:"ChevronDown"},t,{className:o._classNames.menuIcon}))},o._onRenderMenu=function(e){var t=o.props.menuAs?$(o.props.menuAs,Ze):Ze;return r.createElement(t,(0,n.__assign)({},e))},o._onDismissMenu=function(e){var t=o.props.menuProps;t&&t.onDismiss&&t.onDismiss(e),e&&e.defaultPrevented||o._dismissMenu()},o._dismissMenu=function(){o._menuShouldFocusOnMount=void 0,o._menuShouldFocusOnContainer=void 0,o.setState({menuHidden:!0})},o._openMenu=function(e,t){void 0===t&&(t=!0),o.props.menuProps&&(o._menuShouldFocusOnContainer=e,o._menuShouldFocusOnMount=t,o._renderedVisibleMenu=!0,o.setState({menuHidden:!1}))},o._onToggleMenu=function(e){var t=!0;o.props.menuProps&&!1===o.props.menuProps.shouldFocusOnMount&&(t=!1),o.state.menuHidden?o._openMenu(e,t):o._dismissMenu()},o._onSplitContainerFocusCapture=function(e){var t=o._splitButtonContainer.current;!t||e.target&&(0,c.s)(e.target,t)||t.focus()},o._onSplitButtonPrimaryClick=function(e){o.state.menuHidden||o._dismissMenu();var t=o._processingTouch&&!o.props.toggle;!t&&o.props.onClick?o.props.onClick(e):t&&o._onMenuClick(e)},o._onKeyDown=function(e){!o.props.disabled||e.which!==u.c.enter&&e.which!==u.c.space?o.props.disabled||(o.props.menuProps?o._onMenuKeyDown(e):void 0!==o.props.onKeyDown&&o.props.onKeyDown(e)):(e.preventDefault(),e.stopPropagation())},o._onKeyUp=function(e){o.props.disabled||void 0===o.props.onKeyUp||o.props.onKeyUp(e)},o._onKeyPress=function(e){o.props.disabled||void 0===o.props.onKeyPress||o.props.onKeyPress(e)},o._onMouseUp=function(e){o.props.disabled||void 0===o.props.onMouseUp||o.props.onMouseUp(e)},o._onMouseDown=function(e){o.props.disabled||void 0===o.props.onMouseDown||o.props.onMouseDown(e)},o._onClick=function(e){o.props.disabled||(o.props.menuProps?o._onMenuClick(e):void 0!==o.props.onClick&&o.props.onClick(e))},o._onSplitButtonContainerKeyDown=function(e){e.which===u.c.enter||e.which===u.c.space?o._buttonElement.current&&(o._buttonElement.current.click(),e.preventDefault(),e.stopPropagation()):o._onMenuKeyDown(e)},o._onMenuKeyDown=function(e){var t;if(!o.props.disabled){o.props.onKeyDown&&o.props.onKeyDown(e);var i=e.which===u.c.up,n=e.which===u.c.down;if(!e.defaultPrevented&&o._isValidMenuOpenKey(e)){var r=o.props.onMenuClick;r&&r(e,o.props),o._onToggleMenu(!1),e.preventDefault(),e.stopPropagation()}e.which!==u.c.enter&&e.which!==u.c.space||(0,d.Fy)(!0,e.target,null===(t=o.context)||void 0===t?void 0:t.registeredProviders),e.altKey||e.metaKey||!i&&!n||!o.state.menuHidden&&o.props.menuProps&&((void 0!==o._menuShouldFocusOnMount?o._menuShouldFocusOnMount:o.props.menuProps.shouldFocusOnMount)||(e.preventDefault(),e.stopPropagation(),o._menuShouldFocusOnMount=!0,o.forceUpdate()))}},o._onTouchStart=function(){o._isSplitButton&&o._splitButtonContainer.current&&!("onpointerdown"in o._splitButtonContainer.current)&&o._handleTouchAndPointerEvent()},o._onMenuClick=function(e){var t=o.props,i=t.onMenuClick,n=t.menuProps;i&&i(e,o.props);var r="boolean"==typeof(null==n?void 0:n.shouldFocusOnContainer)?n.shouldFocusOnContainer:"mouse"===e.nativeEvent.pointerType;e.defaultPrevented||(o._onToggleMenu(r),e.preventDefault(),e.stopPropagation())},(0,h.f)(o),o._async=new g.j(o),o._events=new p.g(o),o.props.split,o._labelId=(0,f.O)(),o._descriptionId=(0,f.O)(),o._ariaDescriptionId=(0,f.O)(),o.state={menuHidden:!0},o}return(0,n.__extends)(t,e),Object.defineProperty(t.prototype,"_isSplitButton",{get:function(){return!!this.props.menuProps&&!!this.props.onClick&&!0===this.props.split},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t=this.props,o=t.ariaDescription,i=t.ariaLabel,n=t.ariaHidden,r=t.className,s=t.disabled,a=t.allowDisabledFocus,l=t.primaryDisabled,c=t.secondaryText,u=void 0===c?this.props.description:c,d=t.href,h=t.iconProps,g=t.menuIconProps,p=t.styles,f=t.checked,b=t.variantClassName,w=t.theme,C=t.toggle,S=t.getClassNames,k=t.role,T=this.state.menuHidden,x=s||l;this._classNames=S?S(w,r,b,h&&h.className,g&&g.className,x,f,!T,!!this.props.menuProps,this.props.split,!!a):tt(w,p,r,b,h&&h.className,g&&g.className,x,!!this.props.menuProps,f,!T,this.props.split);var _=this,I=_._ariaDescriptionId,E=_._labelId,B=_._descriptionId,A=!x&&!!d,R=A?"a":"button",M=(0,m.G1)((0,v.kp)(A?{}:{type:"button"},this.props.rootProps,this.props),A?m.t0:m.uw,["disabled"]),D=i||M["aria-label"],P=void 0;o?P=I:u&&this.props.onRenderDescription!==y?P=B:M["aria-describedby"]&&(P=M["aria-describedby"]);var F=void 0;M["aria-labelledby"]?F=M["aria-labelledby"]:P&&!D&&(F=this._hasText()?E:void 0);var O=!(!1===this.props["data-is-focusable"]||s&&!a||this._isSplitButton),N="menuitemcheckbox"===k||"checkbox"===k,q=N||!0===C?!!f:void 0,j=(0,v.kp)(M,((e={className:this._classNames.root,ref:this._mergedRef(this.props.elementRef,this._buttonElement),disabled:x&&!a,onKeyDown:this._onKeyDown,onKeyPress:this._onKeyPress,onKeyUp:this._onKeyUp,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onClick:this._onClick,"aria-label":D,"aria-labelledby":F,"aria-describedby":P,"aria-disabled":x,"data-is-focusable":O})[N?"aria-checked":"aria-pressed"]=q,e));if(n&&(j["aria-hidden"]=!0),this._isSplitButton)return this._onRenderSplitButtonContent(R,j);if(this.props.menuProps){var L=this.props.menuProps.id,z=void 0===L?"".concat(this._labelId,"-menu"):L;(0,v.kp)(j,{"aria-expanded":!T,"aria-controls":T?null:z,"aria-haspopup":!0})}return this._onRenderContent(R,j)},t.prototype.componentDidMount=function(){this._isSplitButton&&this._splitButtonContainer.current&&("onpointerdown"in this._splitButtonContainer.current&&this._events.on(this._splitButtonContainer.current,"pointerdown",this._onPointerDown,!0),"onpointerup"in this._splitButtonContainer.current&&this.props.onPointerUp&&this._events.on(this._splitButtonContainer.current,"pointerup",this.props.onPointerUp,!0))},t.prototype.componentDidUpdate=function(e,t){this.props.onAfterMenuDismiss&&!t.menuHidden&&this.state.menuHidden&&this.props.onAfterMenuDismiss()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.focus=function(){var e,t;this._isSplitButton&&this._splitButtonContainer.current?((0,d.Fy)(!0,void 0,null===(e=this.context)||void 0===e?void 0:e.registeredProviders),this._splitButtonContainer.current.focus()):this._buttonElement.current&&((0,d.Fy)(!0,void 0,null===(t=this.context)||void 0===t?void 0:t.registeredProviders),this._buttonElement.current.focus())},t.prototype.dismissMenu=function(){this._dismissMenu()},t.prototype.openMenu=function(e,t){this._openMenu(e,t)},t.prototype._onRenderContent=function(e,t){var o=this,i=this.props,s=e,a=i.menuIconProps,l=i.menuProps,c=i.onRenderIcon,u=void 0===c?this._onRenderIcon:c,d=i.onRenderAriaDescription,h=void 0===d?this._onRenderAriaDescription:d,g=i.onRenderChildren,p=void 0===g?this._onRenderChildren:g,f=i.onRenderMenu,m=void 0===f?this._onRenderMenu:f,v=i.onRenderMenuIcon,b=void 0===v?this._onRenderMenuIcon:v,y=i.disabled,w=i.keytipProps;w&&l&&(w=this._getMemoizedMenuButtonKeytipProps(w));var S=function(e){return r.createElement(s,(0,n.__assign)({},t,e),r.createElement("span",{className:o._classNames.flexContainer,"data-automationid":"splitbuttonprimary"},u(i,o._onRenderIcon),o._onRenderTextContents(),h(i,o._onRenderAriaDescription),p(i,o._onRenderChildren),!o._isSplitButton&&(l||a||o.props.onRenderMenuIcon)&&b(o.props,o._onRenderMenuIcon),l&&!l.doNotLayer&&o._shouldRenderMenu()&&m(o._getMenuProps(l),o._onRenderMenu)))},k=w?r.createElement(be,{keytipProps:this._isSplitButton?void 0:w,ariaDescribedBy:t["aria-describedby"],disabled:y},(function(e){return S(e)})):S();return l&&l.doNotLayer?r.createElement(r.Fragment,null,k,this._shouldRenderMenu()&&m(this._getMenuProps(l),this._onRenderMenu)):r.createElement(r.Fragment,null,k,r.createElement(C.MO,null))},t.prototype._shouldRenderMenu=function(){var e=this.state.menuHidden,t=this.props,o=t.persistMenu,i=t.renderPersistedMenuHiddenOnMount;return!e||!(!o||!this._renderedVisibleMenu&&!i)},t.prototype._hasText=function(){return null!==this.props.text&&(void 0!==this.props.text||"string"==typeof this.props.children)},t.prototype._getMenuProps=function(e){var t=this.props.persistMenu,o=this.state.menuHidden;return e.ariaLabel||e.labelElementId||!this._hasText()||(e=(0,n.__assign)((0,n.__assign)({},e),{labelElementId:this._labelId})),(0,n.__assign)((0,n.__assign)({id:this._labelId+"-menu",directionalHint:P.A.bottomLeftEdge},e),{shouldFocusOnContainer:this._menuShouldFocusOnContainer,shouldFocusOnMount:this._menuShouldFocusOnMount,hidden:t?o:void 0,className:(0,l.A)("ms-BaseButton-menuhost",e.className),target:this._isSplitButton?this._splitButtonContainer.current:this._buttonElement.current,onDismiss:this._onDismissMenu})},t.prototype._onRenderSplitButtonContent=function(e,t){var o=this,i=this.props,s=i.styles,a=void 0===s?{}:s,l=i.disabled,c=i.allowDisabledFocus,u=i.checked,d=i.getSplitButtonClassNames,h=i.primaryDisabled,g=i.menuProps,p=i.toggle,f=i.role,b=i.primaryActionButtonProps,y=this.props.keytipProps,w=this.state.menuHidden,C=d?d(!!l,!w,!!u,!!c):a&&ot(a,!!l,!w,!!u,!!h);(0,v.kp)(t,{onClick:void 0,onPointerDown:void 0,onPointerUp:void 0,tabIndex:-1,"data-is-focusable":!1}),y&&g&&(y=this._getMemoizedMenuButtonKeytipProps(y));var k=(0,m.G1)(t,[],["disabled"]);b&&(0,v.kp)(t,b);var T=function(i){return r.createElement("div",(0,n.__assign)({},k,{"data-ktp-target":i?i["data-ktp-target"]:void 0,role:f||"button","aria-disabled":l,"aria-haspopup":!0,"aria-expanded":!w,"aria-pressed":p?!!u:void 0,"aria-describedby":(0,S._)(t["aria-describedby"],i?i["aria-describedby"]:void 0),className:C&&C.splitButtonContainer,onKeyDown:o._onSplitButtonContainerKeyDown,onTouchStart:o._onTouchStart,ref:o._splitButtonContainer,"data-is-focusable":!0,onClick:l||h?void 0:o._onSplitButtonPrimaryClick,tabIndex:!l&&!h||c?0:void 0,"aria-roledescription":t["aria-roledescription"],onFocusCapture:o._onSplitContainerFocusCapture}),r.createElement("span",{style:{display:"flex",width:"100%"}},o._onRenderContent(e,t),o._onRenderSplitButtonMenuButton(C,i),o._onRenderSplitButtonDivider(C)))};return y?r.createElement(be,{keytipProps:y,disabled:l},(function(e){return T(e)})):T()},t.prototype._onRenderSplitButtonDivider=function(e){return e&&e.divider?r.createElement("span",{className:e.divider,"aria-hidden":!0,onClick:function(e){e.stopPropagation()}}):null},t.prototype._onRenderSplitButtonMenuButton=function(e,o){var i=this.props,s=i.allowDisabledFocus,a=i.checked,l=i.disabled,c=i.splitButtonMenuProps,u=i.splitButtonAriaLabel,d=i.primaryDisabled,h=this.state.menuHidden,g=this.props.menuIconProps;void 0===g&&(g={iconName:"ChevronDown"});var p=(0,n.__assign)((0,n.__assign)({},c),{styles:e,checked:a,disabled:l,allowDisabledFocus:s,onClick:this._onMenuClick,menuProps:void 0,iconProps:(0,n.__assign)((0,n.__assign)({},g),{className:this._classNames.menuIcon}),ariaLabel:u,"aria-haspopup":!0,"aria-expanded":!h,"data-is-focusable":!1});return r.createElement(t,(0,n.__assign)({},p,{"data-ktp-execute-target":o?o["data-ktp-execute-target"]:o,onMouseDown:this._onMouseDown,tabIndex:d&&!s?0:-1}))},t.prototype._onPointerDown=function(e){var t=this.props.onPointerDown;t&&t(e),"touch"===e.pointerType&&(this._handleTouchAndPointerEvent(),e.preventDefault(),e.stopImmediatePropagation())},t.prototype._handleTouchAndPointerEvent=function(){var e=this;void 0!==this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout((function(){e._processingTouch=!1,e._lastTouchTimeoutId=void 0,e.state.menuHidden&&e.focus()}),500)},t.prototype._isValidMenuOpenKey=function(e){return this.props.menuTriggerKeyCode?e.which===this.props.menuTriggerKeyCode:!!this.props.menuProps&&e.which===u.c.down&&(e.altKey||e.metaKey)},t.defaultProps={baseClassName:"ms-Button",styles:{},split:!1},t.contextType=C.dM,t}(r.Component),nt=o(33072),rt=o(2963),st=o(9414),at=o(31860),lt=o(80072),ct=o(70833),ut=(0,a.J9)(at.HD),dt=(0,a.J9)((function(e,t,o){var i,n=null!==(i=null!=t?t:e)&&void 0!==i?i:{};return n.__shadowConfig__=o,n})),ht={outline:0},gt=function(e){return{fontSize:e,margin:"0 4px",height:"16px",lineHeight:"16px",textAlign:"center",flexShrink:0}},pt=(0,a.J9)((function(e){var t,o,n=e.semanticColors,r=e.effects,s=e.fonts,a=n.buttonBorder,l=n.disabledBackground,c=n.disabledText,u={left:-2,top:-2,bottom:-2,right:-2,outlineColor:"ButtonText"};return{root:[(0,i.gm)(e,{inset:1,highContrastStyle:u,borderColor:"transparent"}),e.fonts.medium,{border:"1px solid "+a,borderRadius:r.roundedCorner2,boxSizing:"border-box",cursor:"pointer",display:"inline-flex",alignItems:"center",justifyContent:"center",padding:"0 16px",textDecoration:"none",textAlign:"center",userSelect:"none",":active > span":{position:"relative",left:0,top:0}}],rootDisabled:[(0,i.gm)(e,{inset:1,highContrastStyle:u,borderColor:"transparent"}),{backgroundColor:l,borderColor:l,color:c,cursor:"default",":hover":ht,":focus":ht}],iconDisabled:(t={color:c},t[i.up]={color:"GrayText"},t),menuIconDisabled:(o={color:c},o[i.up]={color:"GrayText"},o),flexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},description:{display:"block"},textContainer:{flexGrow:1,display:"block"},icon:gt(s.mediumPlus.fontSize),menuIcon:gt(s.small.fontSize),label:{margin:"0 4px",lineHeight:"100%",display:"block"},screenReaderText:i.dX}})),ft=(0,a.J9)((function(e,t){var o,r,s,a,l,c,u,d,h,g,p,f,m,v,b,y,w,C=e.effects,S=e.palette,k=e.semanticColors,T={left:-2,top:-2,bottom:-2,right:-2,border:"none"},x={position:"absolute",width:1,right:31,top:8,bottom:8},_={splitButtonContainer:[(0,i.gm)(e,{highContrastStyle:T,inset:2,pointerEvents:"none"}),{display:"inline-flex",".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none",flexGrow:"1"},".ms-Button--primary":(o={borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",flexGrow:"1",":hover":{border:"none"},":active":{border:"none"}},o[i.up]=(0,n.__assign)((0,n.__assign)({color:"WindowText",backgroundColor:"Window",border:"1px solid WindowText",borderRightWidth:"0"},(0,i.Qg)()),{":hover":{backgroundColor:"Highlight",border:"1px solid Highlight",borderRightWidth:"0",color:"HighlightText"},":active":{border:"1px solid Highlight"}}),o),".ms-Button--default + .ms-Button":(r={},r[i.up]={border:"1px solid WindowText",borderLeftWidth:"0",":hover":{backgroundColor:"HighlightText",borderColor:"Highlight",color:"Highlight",".ms-Button-menuIcon":(0,n.__assign)({backgroundColor:"HighlightText",color:"Highlight"},(0,i.Qg)())}},r),'.ms-Button--default + .ms-Button[aria-expanded="true"]':(s={},s[i.up]={backgroundColor:"HighlightText",borderColor:"Highlight",color:"Highlight",".ms-Button-menuIcon":(0,n.__assign)({backgroundColor:"HighlightText",color:"Highlight"},(0,i.Qg)())},s),".ms-Button--primary + .ms-Button":(a={border:"none"},a[i.up]={border:"1px solid WindowText",borderLeftWidth:"0",":hover":{borderLeftWidth:"0",backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText",".ms-Button-menuIcon":(0,n.__assign)((0,n.__assign)({},(0,i.Qg)()),{color:"HighlightText"})}},a),'.ms-Button--primary + .ms-Button[aria-expanded="true"]':(l={},l[i.up]=(0,n.__assign)((0,n.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},(0,i.Qg)()),{".ms-Button-menuIcon":{color:"HighlightText"}}),l),".ms-Button.is-disabled":(c={},c[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},c)}],splitButtonContainerHovered:{".ms-Button--default.is-disabled":(u={backgroundColor:k.buttonBackgroundDisabled,color:k.buttonTextDisabled},u[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},u),".ms-Button--primary.is-disabled":(d={backgroundColor:k.primaryButtonBackgroundDisabled,color:k.primaryButtonTextDisabled},d[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},d)},splitButtonContainerChecked:{".ms-Button--primary":(h={},h[i.up]=(0,n.__assign)({color:"Window",backgroundColor:"WindowText"},(0,i.Qg)()),h)},splitButtonContainerCheckedHovered:{".ms-Button--primary":(g={},g[i.up]=(0,n.__assign)({color:"Window",backgroundColor:"WindowText"},(0,i.Qg)()),g)},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:(p={padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:C.roundedCorner2,borderBottomRightRadius:C.roundedCorner2,border:"1px solid ".concat(S.neutralSecondaryAlt),borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},p[i.up]={".ms-Button-menuIcon":{color:"WindowText"}},p),splitButtonDivider:(0,n.__assign)((0,n.__assign)({},x),(f={},f[i.up]={backgroundColor:"WindowText"},f)),splitButtonDividerDisabled:(0,n.__assign)((0,n.__assign)({},x),(m={},m[i.up]={backgroundColor:"GrayText"},m)),splitButtonMenuButtonDisabled:(v={pointerEvents:"none",border:"none",":hover":{cursor:"default"},".ms-Button--primary":(b={},b[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},b),".ms-Button-menuIcon":(y={},y[i.up]={color:"GrayText"},y)},v[i.up]={color:"GrayText",border:"1px solid GrayText",backgroundColor:"Window"},v),splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:(w={outline:"none",border:"none"},w[i.up]=(0,n.__assign)({color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},(0,i.Qg)()),w),splitButtonMenuFocused:(0,n.__assign)({},(0,i.gm)(e,{highContrastStyle:T,inset:2}))};return(0,i.TW)(_,t)})),mt=(0,a.J9)((function(e,t,o){var r,s,a,l,c,u=e.fonts,h=e.palette,g=pt(e),p=ft(e),f={root:{maxWidth:"280px",minHeight:"72px",height:"auto",padding:"16px 12px"},flexContainer:{flexDirection:"row",alignItems:"flex-start",minWidth:"100%",margin:""},textContainer:{textAlign:"left"},icon:{fontSize:"2em",lineHeight:"1em",height:"1em",margin:"0px 8px 0px 0px",flexBasis:"1em",flexShrink:"0"},label:{margin:"0 0 5px",lineHeight:"100%",fontWeight:i.BO.semibold},description:[u.small,{lineHeight:"100%"}]},m={description:{color:h.neutralSecondary},descriptionHovered:{color:h.neutralDark},descriptionPressed:{color:"inherit"},descriptionChecked:{color:"inherit"},descriptionDisabled:{color:"inherit"}},v={description:(r={color:h.white},r[i.up]=(0,n.__assign)({backgroundColor:"WindowText",color:"Window"},(0,i.Qg)()),r),descriptionHovered:(s={color:h.white},s[i.up]={backgroundColor:"Highlight",color:"Window"},s),descriptionPressed:(a={color:"inherit"},a[i.up]=(0,n.__assign)({color:"Window",backgroundColor:"WindowText"},(0,i.Qg)()),a),descriptionChecked:(l={color:"inherit"},l[i.up]=(0,n.__assign)({color:"Window",backgroundColor:"WindowText"},(0,i.Qg)()),l),descriptionDisabled:(c={color:"inherit"},c[i.up]={color:"inherit"},c)};return(0,i.TW)(g,f,o?function(e){var t,o,r,s,a,l,c,u,h,g=e.palette,p=e.semanticColors;return{root:(t={backgroundColor:p.primaryButtonBackground,border:"1px solid ".concat(p.primaryButtonBackground),color:p.primaryButtonText},t[i.up]=(0,n.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},(0,i.Qg)()),t[".".concat(d.Y2," &:focus, :host(.").concat(d.Y2,") &:focus")]={":after":{border:"none",outlineColor:g.white}},t),rootHovered:(o={backgroundColor:p.primaryButtonBackgroundHovered,border:"1px solid ".concat(p.primaryButtonBackgroundHovered),color:p.primaryButtonTextHovered},o[i.up]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},o),rootPressed:(r={backgroundColor:p.primaryButtonBackgroundPressed,border:"1px solid ".concat(p.primaryButtonBackgroundPressed),color:p.primaryButtonTextPressed},r[i.up]=(0,n.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},(0,i.Qg)()),r),rootExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootChecked:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:p.primaryButtonBackgroundPressed,color:p.primaryButtonTextPressed},rootDisabled:(s={color:p.primaryButtonTextDisabled,backgroundColor:p.primaryButtonBackgroundDisabled},s[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},s),splitButtonContainer:(a={},a[i.up]={border:"none"},a),splitButtonDivider:(0,n.__assign)((0,n.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),(l={backgroundColor:g.white},l[i.up]={backgroundColor:"Window"},l)),splitButtonMenuButton:(c={backgroundColor:p.primaryButtonBackground,color:p.primaryButtonText},c[i.up]={backgroundColor:"Canvas"},c[":hover"]=(u={backgroundColor:p.primaryButtonBackgroundHovered},u[i.up]={color:"Highlight"},u),c),splitButtonMenuButtonDisabled:{backgroundColor:p.primaryButtonBackgroundDisabled,":hover":{backgroundColor:p.primaryButtonBackgroundDisabled}},splitButtonMenuButtonChecked:{backgroundColor:p.primaryButtonBackgroundPressed,":hover":{backgroundColor:p.primaryButtonBackgroundPressed}},splitButtonMenuButtonExpanded:{backgroundColor:p.primaryButtonBackgroundPressed,":hover":{backgroundColor:p.primaryButtonBackgroundPressed}},splitButtonMenuIcon:{color:p.primaryButtonText},splitButtonMenuIconDisabled:(h={color:g.neutralTertiary},h[i.up]={color:"GrayText"},h)}}(e):function(e){var t,o,r,s,a,l=e.semanticColors,c=e.palette,u=l.buttonBackground,d=l.buttonBackgroundPressed,h=l.buttonBackgroundHovered,g=l.buttonBackgroundDisabled,p=l.buttonText,f=l.buttonTextHovered,m=l.buttonTextDisabled,v=l.buttonTextChecked,b=l.buttonTextCheckedHovered;return{root:{backgroundColor:u,color:p},rootHovered:(t={backgroundColor:h,color:f},t[i.up]={borderColor:"Highlight",color:"Highlight"},t),rootPressed:{backgroundColor:d,color:v},rootExpanded:{backgroundColor:d,color:v},rootChecked:{backgroundColor:d,color:v},rootCheckedHovered:{backgroundColor:d,color:b},rootDisabled:(o={color:m,backgroundColor:g},o[i.up]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},o),splitButtonContainer:(r={},r[i.up]={border:"none"},r),splitButtonMenuButton:{color:c.white,backgroundColor:"transparent",":hover":(s={backgroundColor:c.neutralLight},s[i.up]={color:"Highlight"},s)},splitButtonMenuButtonDisabled:{backgroundColor:l.buttonBackgroundDisabled,":hover":{backgroundColor:l.buttonBackgroundDisabled}},splitButtonDivider:(0,n.__assign)((0,n.__assign)({},{position:"absolute",width:1,right:31,top:8,bottom:8}),(a={backgroundColor:c.neutralTertiaryAlt},a[i.up]={backgroundColor:"WindowText"},a)),splitButtonDividerDisabled:{backgroundColor:e.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:c.neutralQuaternaryAlt,":hover":{backgroundColor:c.neutralQuaternaryAlt}},splitButtonMenuButtonExpanded:{backgroundColor:c.neutralQuaternaryAlt,":hover":{backgroundColor:c.neutralQuaternaryAlt}},splitButtonMenuIcon:{color:l.buttonText},splitButtonMenuIconDisabled:{color:l.buttonTextDisabled}}}(e),o?v:m,p,t)})),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o,i;return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.primary,o=void 0!==t&&t,i=e.styles,s=e.theme;return r.createElement(it,(0,n.__assign)({},this.props,{variantClassName:o?"ms-Button--compoundPrimary":"ms-Button--compound",styles:mt(s,i,o)}))},t=(0,n.__decorate)([(o="CompoundButton",i=["theme","styles"],!0,function(e){var t,s=(t=function(t){function s(e){var o=t.call(this,e)||this;return o._styleCache={},o._onSettingChanged=o._onSettingChanged.bind(o),o}return(0,n.__extends)(s,t),s.prototype.componentDidMount=function(){nt.X.observe(this._onSettingChanged)},s.prototype.componentWillUnmount=function(){nt.X.unobserve(this._onSettingChanged)},s.prototype.render=function(){var t=this;return r.createElement(ct.f,{stylesheetKey:o},(function(s){return r.createElement(st.z.Consumer,null,(function(a){var l,c=nt.X.getSettings(i,o,a.customizations),u=null!==(l=t.context.window)&&void 0!==l?l:(0,H.z)(),d=ut(o,s,u),h=t.props;if(c.styles&&"function"==typeof c.styles&&(c.styles=c.styles((0,n.__assign)((0,n.__assign)({},c),h))),c.styles){if(t._styleCache.default!==c.styles||t._styleCache.component!==h.styles){var g=(0,lt.T)(c.styles,h.styles);g.__shadowConfig__=d,t._styleCache.default=c.styles,t._styleCache.component=h.styles,t._styleCache.merged=g}return r.createElement(e,(0,n.__assign)({},c,h,{styles:t._styleCache.merged}))}var p=dt(c.styles,h.styles,d);return r.createElement(e,(0,n.__assign)({},c,h,{styles:p}))}))}))},s.prototype._onSettingChanged=function(){this.forceUpdate()},s}(r.Component),t.displayName="Customized"+o,t.contextType=Me._0,t);return(0,rt.D)(e,s)})],t),t}(r.Component);!function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(Xe||(Xe={}));var bt,yt=(0,_.Z)(),wt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return"string"==typeof e.content?r.createElement("p",{className:t._classNames.subText},e.content):r.createElement("div",{className:t._classNames.subText},e.content)},t}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,o=e.calloutProps,i=e.directionalHint,s=e.directionalHintForRTL,a=e.styles,l=e.id,c=e.maxWidth,u=e.onRenderContent,d=void 0===u?this._onRenderContent:u,h=e.targetElement,g=e.theme;return this._classNames=yt(a,{theme:g,className:t||o&&o.className,beakWidth:o&&o.isBeakVisible?o.beakWidth:0,gapSpace:o&&o.gapSpace,maxWidth:c}),r.createElement(Z.P,(0,n.__assign)({target:h,directionalHint:i,directionalHintForRTL:s},o,(0,m.G1)(this.props,m.JM,["id"]),{className:this._classNames.root}),r.createElement("div",{className:this._classNames.content,id:l,onFocus:this.props.onFocus,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},d(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:P.A.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(r.Component),Ct=(0,k.I)(wt,(function(e){var t=e.className,o=e.beakWidth,n=void 0===o?16:o,r=e.gapSpace,s=void 0===r?0:r,a=e.maxWidth,l=e.theme,c=l.semanticColors,u=l.fonts,d=l.effects,h=-(Math.sqrt(n*n/2)+s)+1/window.devicePixelRatio;return{root:["ms-Tooltip",l.fonts.medium,i.lw.fadeIn200,{background:c.menuBackground,boxShadow:d.elevation8,padding:"8px",maxWidth:a,selectors:{":after":{content:"''",position:"absolute",bottom:h,left:h,right:h,top:h,zIndex:0}}},t],content:["ms-Tooltip-content",u.small,{position:"relative",zIndex:1,color:c.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"});!function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(bt||(bt={}));var St=o(43488),kt=(0,_.Z)(),Tt=function(e){function t(o){var i=e.call(this,o)||this;return i._tooltipHost=r.createRef(),i._defaultTooltipId=(0,f.O)("tooltip"),i.show=function(){i._toggleTooltip(!0)},i.dismiss=function(){i._hideTooltip()},i._getTargetElement=function(){if(i._tooltipHost.current){var e=i.props.overflowMode;if(void 0!==e)switch(e){case Xe.Parent:return i._tooltipHost.current.parentElement;case Xe.Self:return i._tooltipHost.current}return i._tooltipHost.current}},i._onTooltipFocus=function(e){i._ignoreNextFocusEvent?i._ignoreNextFocusEvent=!1:i._onTooltipMouseEnter(e)},i._onTooltipContentFocus=function(e){t._currentVisibleTooltip&&t._currentVisibleTooltip!==i&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=i,i._clearDismissTimer(),i._clearOpenTimer()},i._onTooltipBlur=function(e){var t;i._ignoreNextFocusEvent=(null===(t=(0,St.LW)(i.context))||void 0===t?void 0:t.activeElement)===e.target,i._dismissTimerId=i._async.setTimeout((function(){i._hideTooltip()}),0)},i._onTooltipMouseEnter=function(e){var o,n=i.props,r=n.overflowMode,s=n.delay,a=(0,St.LW)(i.context);if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==i&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=i,void 0!==r){var l=i._getTargetElement();if(l&&!function(e){return e.clientWidth<e.scrollWidth}(o=l)&&!function(e){return e.clientHeight<e.scrollHeight}(o))return}if(!e.target||!(0,c.s)(e.target,i._getTargetElement(),a))if(i._clearDismissTimer(),i._clearOpenTimer(),s!==bt.zero){var u=i._getDelayTime(s);i._openTimerId=i._async.setTimeout((function(){i._toggleTooltip(!0)}),u)}else i._toggleTooltip(!0)},i._onTooltipMouseLeave=function(e){var o=i.props.closeDelay;i._clearDismissTimer(),i._clearOpenTimer(),o?i._dismissTimerId=i._async.setTimeout((function(){i._toggleTooltip(!1)}),o):i._toggleTooltip(!1),t._currentVisibleTooltip===i&&(t._currentVisibleTooltip=void 0)},i._onTooltipKeyDown=function(e){(e.which===u.c.escape||e.ctrlKey)&&i.state.isTooltipVisible&&(i._hideTooltip(),e.stopPropagation())},i._clearDismissTimer=function(){i._async.clearTimeout(i._dismissTimerId)},i._clearOpenTimer=function(){i._async.clearTimeout(i._openTimerId)},i._hideTooltip=function(){i._clearOpenTimer(),i._clearDismissTimer(),i._toggleTooltip(!1)},i._toggleTooltip=function(e){i.state.isTooltipVisible!==e&&i.setState({isTooltipVisible:e},(function(){return i.props.onTooltipToggle&&i.props.onTooltipToggle(e)}))},i._getDelayTime=function(e){switch(e){case bt.medium:return 300;case bt.long:return 500;default:return 0}},(0,h.f)(i),i.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},i}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,o=e.children,s=e.content,a=e.directionalHint,l=e.directionalHintForRTL,c=e.hostClassName,u=e.id,d=e.setAriaDescribedBy,h=void 0===d||d,g=e.tooltipProps,p=e.styles,f=e.theme;this._classNames=kt(p,{theme:f,className:c});var b=this.state.isTooltipVisible,y=u||this._defaultTooltipId,w=(0,n.__assign)((0,n.__assign)({id:"".concat(y,"--tooltip"),content:s,targetElement:this._getTargetElement(),directionalHint:a,directionalHintForRTL:l,calloutProps:(0,v.kp)({},t,{onDismiss:this._hideTooltip,onFocus:this._onTooltipContentFocus,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},(0,m.G1)(this.props,m.JM,["id"])),g),C=(null==g?void 0:g.onRenderContent)?g.onRenderContent(w,(function(e){return(null==e?void 0:e.content)?r.createElement(r.Fragment,null,e.content):null})):s,S=b&&!!C,k=h&&b&&C?y:void 0;return r.createElement("div",{className:this._classNames.root,ref:this._tooltipHost,onFocusCapture:this._onTooltipFocus,onBlurCapture:this._onTooltipBlur,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,role:"none","aria-describedby":k},o,S&&r.createElement(Ct,(0,n.__assign)({},w)),r.createElement("div",{hidden:!0,id:y,style:i.dX},C))},t.prototype.componentDidMount=function(){this._async=new g.j(this)},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:bt.medium},t.contextType=Me._0,t}(r.Component),xt={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"},_t=(0,k.I)(Tt,(function(e){var t=e.className,o=e.theme;return{root:[(0,i.Km)(xt,o).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"});(0,o(54167).hN)([{rawString:"@media screen and (-ms-high-contrast: active),(forced-colors: active){.hasKeyboardFocus_67b207b6{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 span{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 span:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 .ms-Persona-initials{background-color:highlight !important;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 .ms-Persona-initials:hover{background-color:highlight !important;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 svg path{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hasKeyboardFocus_67b207b6 svg path:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hcIcon_67b207b6 svg path{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}.hcIcon_67b207b6 svg path:hover{background-color:highlight;color:highlighttext !important;outline-color:buttontext;forced-color-adjust:none}}"}]);var It=o(7313);class Et extends r.Component{render(){var e;const t=-16-(void 0!==(null===(e=this.props.style)||void 0===e?void 0:e.horizontalSpacing)?this.props.style.horizontalSpacing:0);return r.createElement("div",{style:{height:24,width:24,position:"fixed",background:this.props.theme.badgeBackground,border:"1px solid "+this.props.theme.badgeText,borderTopRightRadius:"50%",borderTopLeftRadius:"50%",borderBottomLeftRadius:"50%",boxSizing:"border-box",boxShadow:"0px 1.2px 3.6px rgba(0, 0, 0, 0.1), 0px 6.4px 14.4px rgba(0, 0, 0, 0.13)",marginLeft:t,marginTop:-16,textAlign:"center",color:this.props.theme.badgeText,paddingTop:2,zIndex:1,userSelect:"none"}},this.props.text)}}var Bt=o(16971),At=o(20193);class Rt{constructor(e){this._event=e}get isOriginal(){return this._event.currentTarget===this._event.target}stopPropagation(){this._event.stopPropagation()}}var Mt=o(44626),Dt=o(34034);let Pt=0;function Ft(e){return Pt++,`${e}${Pt}`}var Ot=o(70189),Nt=o(36359),qt=o(496),jt=o(63649),Lt=o(60839),zt=o(18861),Ht=o(36216),Wt=o(55009),Ut=o(27760),Gt=o(35203);const Vt=(0,Ut.X)({base:{Bqenvij:"f11ysow2",J657lq:"f1um431h",Jlnjib:"fte7hqw",Bc29nj9:"f1yh8ef3"},highContrast:{pu7qz5:"fi3u9nm",B10010i:"f1tdgb9w"},outline:{},primary:{J657lq:"foe7gw6",Jlnjib:"fvxlz81",Bc29nj9:"f1c2mdy",B8ia98v:"f1r39r2s"},secondary:{},subtle:{J657lq:"f1um431h",Jlnjib:"fte7hqw",Bc29nj9:"f1yh8ef3",pu7qz5:"f1xoeh18",B10010i:"f1ca1nd7"},transparent:{J657lq:"f1um431h",Jlnjib:"f1wn9xqz",Bc29nj9:"f1a8q4d0"},small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1ge6w2w",Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fnnf4v2",Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f14s4sho",Be2twd7:"fod5ikn",Bg96gwp:"faaz57k"},disabled:{J657lq:"f1rlv8bf",Jlnjib:"fd1dbtm",Bc29nj9:"f1vqmdmi"},disabledHighContrast:{B8ia98v:"f1csacz4",pu7qz5:"f1s5tkfe",B10010i:"fs0rda3"}},{d:[".f11ysow2{height:auto;}",".f1um431h .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2);}",".foe7gw6 .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundOnBrand);}",[".f1ge6w2w{padding:var(--spacingHorizontalS) var(--spacingHorizontalS) var(--spacingHorizontalMNudge) var(--spacingHorizontalS);}",{p:-1}],".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".fnnf4v2{padding:14px var(--spacingHorizontalM) var(--spacingHorizontalL) var(--spacingHorizontalM);}",{p:-1}],[".f14s4sho{padding:18px var(--spacingHorizontalL) var(--spacingHorizontalXL) var(--spacingHorizontalL);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".f1rlv8bf .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundDisabled);}"],h:[".fte7hqw:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2Hover);}",".f1yh8ef3:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2Pressed);}",".fvxlz81:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundOnBrand);}",".f1c2mdy:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundOnBrand);}",".f1wn9xqz:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2BrandHover);}",".f1a8q4d0:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForeground2BrandPressed);}",".fd1dbtm:hover .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundDisabled);}",".f1vqmdmi:hover:active .fui-CompoundButton__secondaryContent{color:var(--colorNeutralForegroundDisabled);}"],m:[["@media (forced-colors: active){.fi3u9nm:hover .fui-CompoundButton__secondaryContent{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1tdgb9w:hover:active .fui-CompoundButton__secondaryContent{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1r39r2s .fui-CompoundButton__secondaryContent{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1xoeh18:hover .fui-CompoundButton__secondaryContent{color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ca1nd7:hover:active .fui-CompoundButton__secondaryContent{color:Canvas;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1csacz4 .fui-CompoundButton__secondaryContent{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1s5tkfe:hover .fui-CompoundButton__secondaryContent{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fs0rda3:hover:active .fui-CompoundButton__secondaryContent{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),$t=(0,Ut.X)({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1t35pdg",B2u0y6b:"ft5vyj6",Bf4jedk:"f17suaiq"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1r1wyb6",B2u0y6b:"fdczgix",Bf4jedk:"fjdcg9m"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1bnz8pu",B2u0y6b:"fww51uw",Bf4jedk:"f1qhsl2h"}},{d:[[".f1t35pdg{padding:var(--spacingHorizontalXS);}",{p:-1}],".ft5vyj6{max-width:48px;}",".f17suaiq{min-width:48px;}",[".f1r1wyb6{padding:var(--spacingHorizontalSNudge);}",{p:-1}],".fdczgix{max-width:52px;}",".fjdcg9m{min-width:52px;}",[".f1bnz8pu{padding:var(--spacingHorizontalS);}",{p:-1}],".fww51uw{max-width:56px;}",".f1qhsl2h{min-width:56px;}"]}),Kt=(0,Ut.X)({base:{Be2twd7:"fndrnj9",Bqenvij:"fbhnoac",a9b677:"feqmc2u"},before:{t21cq0:["fkujibs","f199hnxi"]},after:{Frg6f3:["f199hnxi","fkujibs"]}},{d:[".fndrnj9{font-size:40px;}",".fbhnoac{height:40px;}",".feqmc2u{width:40px;}",".fkujibs{margin-right:var(--spacingHorizontalM);}",".f199hnxi{margin-left:var(--spacingHorizontalM);}"]}),Jt=(0,Ut.X)({base:{mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",fsow6f:["f1o700av","fes3tcz"]}},{d:[".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}"]}),Yt=(0,Ut.X)({base:{Bg96gwp:"flkuc6h",Bhrd7zp:"figsok6"},small:{Be2twd7:"fy9rknc"},medium:{Be2twd7:"fy9rknc"},large:{Be2twd7:"fkhj508"}},{d:[".flkuc6h{line-height:100%;}",".figsok6{font-weight:var(--fontWeightRegular);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fkhj508{font-size:var(--fontSizeBase300);}"]});var Qt=o(34877);const Zt=r.forwardRef(((e,t)=>{const o=(({contentContainer:e,secondaryContent:t,...o},i)=>{var n,r;const s={...(0,Wt.P)(o,i),components:{root:"button",icon:"span",contentContainer:"span",secondaryContent:"span"},contentContainer:Ht.Gk(e,{elementType:"span"}),secondaryContent:Ht.lq(t,{elementType:"span"})};return s.iconOnly=Boolean((null===(n=s.icon)||void 0===n?void 0:n.children)&&!o.children&&!(null===(r=s.secondaryContent)||void 0===r?void 0:r.children)),s})(e,t);return(e=>{const t=Vt(),o=$t(),i=Kt(),n=Jt(),r=Yt(),{appearance:s,disabled:a,disabledFocusable:l,iconOnly:c,iconPosition:u,size:d}=e;e.root.className=(0,jt.z)("fui-CompoundButton",t.base,t.highContrast,s&&t[s],t[d],(a||l)&&t.disabled,(a||l)&&t.disabledHighContrast,c&&o[d],e.root.className),e.contentContainer.className=(0,jt.z)("fui-CompoundButton__contentContainer",n.base,e.contentContainer.className),e.icon&&(e.icon.className=(0,jt.z)("fui-CompoundButton__icon",i.base,void 0!==e.root.children&&null!==e.root.children&&i[u],e.icon.className)),e.secondaryContent&&(e.secondaryContent.className=(0,jt.z)("fui-CompoundButton__secondaryContent",r.base,r[d],e.secondaryContent.className)),(0,Gt.B)(e)})(o),(0,Qt.$e)("useCompoundButtonStyles_unstable")(o),(e=>{(0,zt.C)(e);const{iconOnly:t,iconPosition:o}=e;return(0,Lt.FD)(e.root,{children:["after"!==o&&e.icon&&(0,Lt.Y)(e.icon,{}),!t&&(0,Lt.FD)(e.contentContainer,{children:[e.root.children,e.secondaryContent&&(0,Lt.Y)(e.secondaryContent,{})]}),"after"===o&&e.icon&&(0,Lt.Y)(e.icon,{})]})})(o)}));Zt.displayName="CompoundButton";var Xt=o(89942),eo=o(40226);const to=["gridcell","option","row","tab"],oo=r.memo(r.forwardRef(((e,t)=>{var o,n;const s=!1,a=e.disableTabFocus?-1:void 0,l=r.useRef(null),c=r.useRef(null),u=r.useRef(null),h=r.useRef(null),g=r.useContext(Bt.O),p=r.useContext(Bt.b),f=Ft("TooltipLabelHolder"),m=Ft("TooltipHost"),[v,b]=r.useState(!1),[y,w]=r.useState(!1),[C,S]=r.useState(!1);r.useImperativeHandle(t,(()=>({focus:T,getElementRef:I,updateState_StorybookTestOnly:()=>{}})));const k=()=>{var t,o,i,n;g?e.updateItemHeight&&(null===(i=c.current)||void 0===i?void 0:i.offsetHeight)&&e.updateItemHeight(null===(n=c.current)||void 0===n?void 0:n.offsetHeight):e.updateItemHeight&&(null===(t=u.current)||void 0===t?void 0:t.offsetHeight)&&e.updateItemHeight(null===(o=u.current)||void 0===o?void 0:o.offsetHeight)};r.useEffect((()=>{k()}),[k]);const T=()=>{var t,o;e.refusesKeyboardFocus||(g?null===(t=c.current)||void 0===t||t.focus():null===(o=l.current)||void 0===o||o.focus())},x=(0,i.Zq)({":focus-visible":{outlineOffset:"calc(var(--strokeWidthThick) * -1)",outline:"var(--strokeWidthThick) solid var(--colorStrokeFocus2) !important"},".fui-CompoundButton__contentContainer":{width:"100%",justifyContent:"center"}}),_=(0,i.Zq)({outlineOffset:"calc(var(--strokeWidthThick) * -1)",outline:"var(--strokeWidthThick) solid var(--colorStrokeFocus2) !important","@media (forced-colors: active)":{outline:"var(--strokeWidthThick) solid highlight !important"}}),I=()=>u,E=null!==(o=e.children)&&void 0!==o?o:(0,Ot.E)(e,v,C,y,{useFluentV9:g});r.useEffect((()=>{g||e.tooltip&&h.current&&(e.isSelectedByKeyboard?h.current.show():h.current.dismiss())}),[e.isSelectedByKeyboard,g,h]);const B=()=>{var t;e.disabled||(null===(t=e.onHoverIn)||void 0===t||t.call(e),S(!0))},A=()=>{var t;e.disabled||(null===(t=e.onHoverOut)||void 0===t||t.call(e),S(!1),b(!1))},R=()=>{var t;e.disabled||(null===(t=e.onPressIn)||void 0===t||t.call(e),b(!0))},M=()=>{var t;e.disabled||(null===(t=e.onPressOut)||void 0===t||t.call(e),b(!1))},D=()=>{var t;!e.disabled&&(null===(t=e.onClick)||void 0===t||t.call(e))},F=t=>{var o;const i=new Rt(t);!i.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onFocus)||void 0===o||o.call(e,i),w(!0))},O=t=>{var o;const i=new Rt(t);!i.isOriginal||e.disabled||e.refusesKeyboardFocus||(null===(o=e.onBlur)||void 0===o||o.call(e,i),w(!1))},N=()=>{var t;const o=(0,Ot.pD)(e),i=(0,Ot.cf)(e),n=to.includes(null!==(t=e.accessibilityRole)&&void 0!==t?t:"")?e.hasKeyboardFocus:void 0,r=e.disableAccessibilityExpanded?void 0:e.accessibilityState,a=!e.accessibilityDescribedByTooltip&&e.tooltip?f:void 0,l=e.accessibilityDescribedByTooltip&&e.tooltip?f:void 0;return{role:(0,Ot.H9)(e),"aria-label":(0,Ot.d)(e,s,o),"aria-posinset":o?e.accessibilityPositionInSet:void 0,"aria-setsize":o?e.accessibilitySetSize:void 0,"aria-haspopup":i,"aria-selected":n,"aria-labelledby":a,"aria-describedby":l,"aria-expanded":r}},q=t=>{var o,i,n,r,s,a,l,c,u,h,p,f,m;const v=qt.O4(e,{useFluentV9:g}),b=Nt.f6(e),y=v.focusRing?{[`.${d.Y2} &:focus`]:{selectors:{":after":{border:"none",outlineColor:v.focusRing}}}}:void 0,w=Nt.DF(e.style),C=Nt.Q6(e.style),S=Nt.ot(e.style),k=Nt.Xo(e.style),T=Nt.Cl(e.style,"start"),x=Nt.Cl(e.style,"end"),_=(0,Dt.W)(e.style,"topStart"),I=(0,Dt.W)(e.style,"topEnd"),E=(0,Dt.W)(e.style,"bottomStart"),B=(0,Dt.W)(e.style,"bottomEnd"),A={borderWidth:Nt.Cl(e.style),borderLeftWidth:t?x:T,borderTopWidth:Nt.Cl(e.style,"top"),borderRightWidth:t?T:x,borderBottomWidth:Nt.Cl(e.style,"bottom"),borderRadius:(0,Dt.W)(e.style),borderTopLeftRadius:t?I:_,borderTopRightRadius:t?_:I,borderBottomRightRadius:t?E:B,borderBottomLeftRadius:t?B:E,border:null===(o=e.style)||void 0===o?void 0:o.border};return Object.assign(Object.assign({backgroundColor:v.background.resting,paddingTop:Nt.AF(e.style),paddingLeft:t?C:w,paddingBottom:Nt.em(e.style),paddingRight:t?w:C,marginTop:Nt.rf(e.style),marginRight:t?S:k,marginBottom:Nt.dV(e.style),marginLeft:t?k:S},A),{boxShadow:null===(i=e.style)||void 0===i?void 0:i.boxShadow,opacity:Nt.qr(e),flexGrow:b,flexShrink:b,textAlign:Nt.AW(e.style),width:e.useFullWidth?"100%":null===(n=e.style)||void 0===n?void 0:n.width,minWidth:null!==(s=null===(r=e.style)||void 0===r?void 0:r.minWidth)&&void 0!==s?s:0,maxWidth:null!==(l=null===(a=e.style)||void 0===a?void 0:a.maxWidth)&&void 0!==l?l:"none",height:null===(c=e.style)||void 0===c?void 0:c.height,minHeight:null!==(h=null===(u=e.style)||void 0===u?void 0:u.minHeight)&&void 0!==h?h:"min-content",maxHeight:null===(p=e.style)||void 0===p?void 0:p.maxHeight,position:null===(f=e.style)||void 0===f?void 0:f.position,bottom:null===(m=e.style)||void 0===m?void 0:m.bottom,selectors:y})},j=()=>({justifyContent:Nt.XI(e.style),flexDirection:"row",alignItems:"stretch"}),L=t=>{const o=Object.assign(Object.assign({},qt.O4(e,{useFluentV9:g})),{focusRing:void 0}),i=qt.SL(v&&!e.topPanelScopeButton,C&&!e.topPanelScopeButton,e.hoverRing,qt.uk(e,y),e.disabled,e.showBorderWhenDisabled,o,{useFluentV9:g});return Object.assign(Object.assign({},q(t)),i)},z=()=>{var e;return p?P.A.topCenter:null!==(e=null==G?void 0:G.directionHint)&&void 0!==e?e:P.A.bottomCenter},{badgeProps:H,theme:W,tooltip:U,tooltipProps:G,refusesKeyboardFocus:V}=e,{tooltip:$,title:K}=null!=W?W:{},J=null!==(n=null==$?void 0:$.backgroundColor)&&void 0!==n?n:null==W?void 0:W.background.resting,Y=r.createElement(r.Fragment,null,H?r.createElement(Et,Object.assign({},H)):void 0,r.createElement(At.q.Consumer,null,(t=>{const o=g?(t=>{var o,i;const n=(s=Object.assign(Object.assign({lineHeight:"normal",fontWeight:"normal"},L(t)),j()),Object.keys(s).forEach((e=>void 0===s[e]&&delete s[e])),s);var s;const l=Object.assign({onFocus:F,onBlur:O,onClick:D,onPointerEnter:B,onPointerLeave:A,onPointerDown:R,onPointerUp:M,style:n,disabled:e.disabled},N());e.onHeightChange&&(null==c?void 0:c.current)&&e.onHeightChange(c.current.getBoundingClientRect().height);const u=r.createElement(Zt,Object.assign({className:qt.uk(e,y)?(0,jt.z)(x,_):x,as:"button","data-automation-id":e.automationLabel,id:e.htmlId,ref:c,appearance:e.appearance,icon:e.iconComponent,tabIndex:a},l),E);return e.topPanelScopeButton?r.createElement(It.S,null,u,r.createElement("div",{style:{paddingLeft:n.paddingLeft,paddingRight:n.paddingRight,width:"100%",boxSizing:"border-box"}},r.createElement("div",{style:{width:"100%",height:"3px",background:null!==(i=null===(o=e.theme)||void 0===o?void 0:o.underline)&&void 0!==i?i:"#464FEB",forcedColorAdjust:"none",alignSelf:"center",borderRadius:"10px",display:e.showUnderline&&e.topPanelScopeButton?"block":"none"}}))):u})(t):(t=>{var o,n;const c=L(t),d=Object.assign({onFocus:F,onBlur:O,onClick:D,onPointerEnter:B,onPointerLeave:A,onPointerDown:R,onPointerUp:M,styles:{root:c,rootPressed:c,rootFocused:c,rootHovered:c,rootDisabled:c,flexContainer:j()},disabled:e.disabled,ariaLabel:(0,Ot.d)(e,s,(0,Ot.pD)(e))},N());Mt.tO(e,d),e.onHeightChange&&u.current&&e.onHeightChange(u.current.getBoundingClientRect().height);const h=(0,i.Zq)({selectors:{":hover":{[`.${eo.ru}`]:{display:"inline !important"},[`.${eo.$C}`]:{display:"none !important"}}}}),g=r.createElement(vt,Object.assign({role:e.topPanelScopeButton?"tab":"button",id:e.htmlId,elementRef:u,componentRef:l,tabIndex:a,className:qt.uk(e,y)?(0,jt.z)("hasKeyboardFocus_67b207b6",h):h},d,{"data-automation-id":e.automationLabel}),E);return e.topPanelScopeButton?r.createElement(It.S,null,g,r.createElement("div",{style:{paddingLeft:c.paddingLeft,paddingRight:c.paddingRight,width:"100%",boxSizing:"border-box"}},r.createElement("div",{style:{width:"100%",height:"3px",background:null!==(n=null===(o=e.theme)||void 0===o?void 0:o.underline)&&void 0!==n?n:"#464FEB",forcedColorAdjust:"none",alignSelf:"center",borderRadius:"10px",display:e.showUnderline&&e.topPanelScopeButton?"block":"none"}}))):g})(t);return V?(t=>{const o=q(t),i=j(),n=Object.assign({onMouseEnter:B,onMouseLeave:A,onMouseDown:R,onMouseUp:M,onClick:D,style:Object.assign(Object.assign(Object.assign(Object.assign({},o),{display:"flex"}),i),{cursor:"pointer"})},N());return r.createElement("div",Object.assign({},n),e.children)})(t):o})));return U?g?r.createElement(At.q.Consumer,null,(t=>{var o,n,s,a;const l=(0,i.Zq)({maxWidth:null==G?void 0:G.calloutMaxWidth,borderRadius:null==G?void 0:G.borderRadius,paddingLeft:t?null==G?void 0:G.paddingEnd:null==G?void 0:G.paddingStart,paddingTop:null==G?void 0:G.paddingTop,paddingRight:t?null==G?void 0:G.paddingStart:null==G?void 0:G.paddingEnd,paddingBottom:null==G?void 0:G.paddingBottom});return r.createElement(Xt.m,{withArrow:null==G?void 0:G.showBeak,content:{children:U,className:null!=l?l:void 0},relationship:"inaccessible",mountNode:document.getElementById(null!==(n=null===(o=e.tooltipProps)||void 0===o?void 0:o.layerHostId)&&void 0!==n?n:m),positioning:null!==(a=null===(s=e.tooltipProps)||void 0===s?void 0:s.positioning)&&void 0!==a?a:io(z())},r.createElement("div",{id:m,style:{display:"flex"}},r.createElement("div",{id:f,hidden:!0,"aria-label":U}),Y))})):r.createElement(At.q.Consumer,null,(e=>{var t;return r.createElement(_t,{componentRef:h,directionalHint:z(),content:U,styles:{root:{display:"flex"}},id:f,calloutProps:{coverTarget:null==G?void 0:G.coverTarget,isBeakVisible:null==G?void 0:G.showBeak,onClick:D,backgroundColor:J,gapSpace:null==G?void 0:G.gapSpace,calloutMaxWidth:null==G?void 0:G.calloutMaxWidth,layerProps:(null==G?void 0:G.layerHostId)?{hostId:G.layerHostId}:void 0,styles:{beakCurtain:{backgroundColor:J},root:{backgroundColor:J,cursor:"pointer",borderRadius:null==G?void 0:G.borderRadius,paddingLeft:e?null==G?void 0:G.paddingEnd:null==G?void 0:G.paddingStart,paddingTop:null==G?void 0:G.paddingTop,paddingRight:e?null==G?void 0:G.paddingStart:null==G?void 0:G.paddingEnd,paddingBottom:null==G?void 0:G.paddingBottom}}},tooltipProps:{styles:{content:{backgroundColor:J},subText:{color:null!==(t=null==$?void 0:$.textColor)&&void 0!==t?t:null==K?void 0:K.resting,borderRadius:8}}},delay:bt.long},Y)})):Y})));function io(e){if(void 0===e)return{position:"below",align:"start"};switch(e){case P.A.topLeftEdge:return{position:"above",align:"start"};case P.A.topCenter:case P.A.topAutoEdge:return{position:"above",align:"center"};case P.A.topRightEdge:return{position:"above",align:"end"};case P.A.bottomLeftEdge:return{position:"below",align:"start"};case P.A.bottomCenter:case P.A.bottomAutoEdge:return{position:"below",align:"center"};case P.A.bottomRightEdge:return{position:"below",align:"end"};case P.A.leftTopEdge:return{position:"before",align:"top"};case P.A.leftCenter:return{position:"before",align:"center"};case P.A.leftBottomEdge:return{position:"before",align:"bottom"};case P.A.rightTopEdge:return{position:"after",align:"top"};case P.A.rightCenter:return{position:"after",align:"center"};case P.A.rightBottomEdge:return{position:"after",align:"bottom"}}}oo.displayName="CompositeButtonBase"},70189:(e,t,o)=>{"use strict";o.d(t,{E:()=>p,H9:()=>m,KD:()=>A,VA:()=>R,cf:()=>f,d:()=>v,lM:()=>B,nK:()=>g,pD:()=>b});var i=o(95734);if(3023==o.j)var n=o(7313);if(3023==o.j)var r=o(68803);if(3023==o.j)var s=o(78585);if(3023==o.j)var a=o(99265);if(3023==o.j)var l=o(36359);if(3023==o.j)var c=o(496);if(3023==o.j)var u=o(22914);if(3023==o.j)var d=o(66466);if(3023==o.j)var h=o(78607);const g=(e,t,o,a,c,u,d,h)=>{var g,p,f,m,v,b,k,T,x,_,I;if(e.children)return e.children;const E={flexibleSize:l.f6(e)?"center"!==l.AW(e.style):void 0},B=u(e,o,a,c,d,h),A=y(e),R=w(e,t,o,a,c,h),M=C(e,o,a,c,h),D=B||A;if(!D&&!R)return null;let P=null!==(p=null===(g=e.style)||void 0===g?void 0:g.textPaddingStart)&&void 0!==p?p:null===(f=e.style)||void 0===f?void 0:f.textHorizontalPadding,F=null!==(v=null===(m=e.style)||void 0===m?void 0:m.textPaddingEnd)&&void 0!==v?v:null===(b=e.style)||void 0===b?void 0:b.textHorizontalPadding;if(void 0===P&&void 0===F){const e=B||A?8:0;P=e,F=e}const O=R?i.createElement(n.S,{justifyContent:r.Pr.Center,align:"center"!==l.AW(e.style)?r.j5.Stretch:void 0,style:Object.assign({paddingStart:P,paddingEnd:F,minWidth:0},D?{flexibleSize:!0}:E)},M?i.createElement(n.S,{direction:r.PR.LeftToRight,align:r.j5.Baseline,style:{flexibleSize:!0}},R,M):R,S(e,o,a,c,h)):void 0,N=e.tagText?i.createElement(n.S,{align:r.j5.Center,justifyContent:r.Pr.Center,style:null===(k=e.tagStyles)||void 0===k?void 0:k.containerStyles},i.createElement(s.c,{text:e.tagText,style:null===(T=e.tagStyles)||void 0===T?void 0:T.textStyles,accessibilityHidden:e.disableTagAccessibility})):void 0;return D?i.createElement(n.S,{direction:r.PR.LeftToRight,align:r.j5.Center,style:Object.assign({minWidth:0},E)},null!=B?B:A,void 0!==(null===(x=e.style)||void 0===x?void 0:x.iconTextSpacing)&&0!==(null===(_=e.style)||void 0===_?void 0:_.iconTextSpacing)&&i.createElement(n.S,{style:{paddingHorizontal:null===(I=e.style)||void 0===I?void 0:I.iconTextSpacing}}),O,N):O},p=(e,t,o,r,s)=>g(e,A,t,o,r,((e,t,o,r,s,a)=>{var l;if(void 0===e.icon)return;const{type:c,style:u,primaryColor:g,filled:p,fontSize:f}=e.icon,m={type:c,style:u,primaryColor:g||R(e,t,o,r,s,a),filled:o&&p,fontSize:f||(null===(l=e.style)||void 0===l?void 0:l.iconFontSize)};return(0,d.R)(m,a)?i.createElement(n.S,{accessible:e.iconShouldBeAccessible},i.createElement(h.E,Object.assign({},m))):void 0}),B(e,!!(null==s?void 0:s.useFluentV9)),s),f=e=>("overflow"===e.accessibilityRole||"splitbutton"===e.accessibilityRole)&&void 0!==e.accessibilityState&&void 0!==e.onAccessibilityExpandCollapse,m=e=>{switch(e.accessibilityRole){case"menuitem":case"option":case"tab":return e.accessibilityRole;case"overflow":return"menuitem";default:return"button"}},v=(e,t,o)=>{let i=e.accessibilityLabel||e.title||e.subtitle;return o&&t&&e.strings&&e.strings.oneOfManyChoiceButtonAccessibilityLabelAugment&&(i=e.strings.oneOfManyChoiceButtonAccessibilityLabelAugment.replace("{0}",i||"").replace("{1}",e.accessibilityPositionInSet.toString(10)).replace("{2}",e.accessibilitySetSize.toString(10))),e.tooltip&&e.accessibilityDescribedByTooltip&&!(e=>"menuitem"!==m(e))(e)&&(i=`${i} ${e.tooltip}`),i},b=e=>void 0!==e.accessibilityPositionInSet&&void 0!==e.accessibilitySetSize&&e.accessibilityPositionInSet>0&&e.accessibilityPositionInSet<=e.accessibilitySetSize&&e.accessibilitySetSize>=1,y=e=>{if(void 0!==e.personaCoinProps&&!e.icon)return i.createElement(n.S,{accessible:e.iconShouldBeAccessible},i.createElement(a.c,Object.assign({},e.personaCoinProps)))},w=(e,t,o,n,r,a)=>{if(e.title)return i.createElement(s.c,{text:e.title,style:Object.assign(Object.assign({},e.titleRootStyle),T(e,o,n,r,a)||{}),formatting:t(_(e,o,n,r,a)),accessibilityHidden:!0})},C=(e,t,o,r,a)=>e.tag?i.createElement(n.S,{style:{marginHorizontal:8}},i.createElement(s.c,{text:e.tag,style:x(e,t,o,r,a),accessibilityHidden:!0})):void 0,S=(e,t,o,r,a)=>e.subtitle?i.createElement(n.S,{style:{paddingTop:2,width:"100%"}},i.createElement(s.c,{text:e.subtitle,style:I(e,t,o,r,a),formatting:E(e,t,o,r,a),accessibilityHidden:!0})):void 0,k=e=>e.title&&e.titleStyle&&0!==e.titleStyle.length?1===e.titleStyle.length&&0===e.titleStyle[0].start&&e.titleStyle[0].length===e.title.length?Object.assign({},e.titleStyle[0]):void 0:{},T=(e,t,o,i,n)=>{const r=k(e);if(!r)return;const s=c.O4(e,n),a=(null==n?void 0:n.useFluentV9)&&(0,u.I)()?"CanvasText":c.gZ(t,o,e.disabled,c.uk(e,i),s.title);return c.hM(r,a)},x=(e,t,o,i,n)=>{const r=c.O4(e,n),s=(null==n?void 0:n.useFluentV9)&&(0,u.I)()?"CanvasText":c.gZ(t,o,e.disabled,c.uk(e,i),r.tag||r.title);return c.hM(e.tagStyle,s)},_=(e,t,o,i,n)=>{var r;if(!e.titleFormatting_DONOTUSE&&k(e))return;const s=c.O4(e,n),a=c.gZ(t,o,e.disabled,c.uk(e,i),s.title);return c.EF(null!==(r=e.titleFormatting_DONOTUSE)&&void 0!==r?r:e.titleStyle,a,o)},I=(e,t,o,i,n)=>{const r=c.O4(e,n),s=(null==n?void 0:n.useFluentV9)&&(0,u.I)()?"CanvasText":c.gZ(t,o,e.disabled,c.uk(e,i),r.subtitle||r.title);return c.hM(e.subtitleStyle,s)},E=(e,t,o,i,n)=>{if(!e.subtitleFormatting)return;const r=c.O4(e,n),s=c.gZ(t,o,e.disabled,c.uk(e,i),r.subtitle||r.title);return c.EF(e.subtitleFormatting,s,o)},B=(e,t)=>{var o,i;if((0,u.I)())return{resting:"CanvasText",focused:(null===(i=null===(o=e.icon)||void 0===o?void 0:o.style)||void 0===i?void 0:i.backgroundColor)?"CanvasText":t?"Highlight":"HighlightText",pressed:"Canvas"}},A=e=>e,R=(e,t,o,i,n,r)=>{const s=null!=n?n:((e,t)=>{const o=c.O4(e,t);return o.icon||o.title})(e,r);return c.gZ(t,o,e.disabled,c.uk(e,i),s)}},51395:(e,t,o)=>{"use strict";var i,n;o.d(t,{A:()=>i,R:()=>n}),function(e){e[e.bottomCenter=5]="bottomCenter",e[e.rightCenter=12]="rightCenter"}(i||(i={})),function(e){e[e.Start=0]="Start",e[e.Center=1]="Center"}(n||(n={}))},36359:(e,t,o)=>{"use strict";if(o.d(t,{AF:()=>s,AW:()=>f,Cl:()=>h,DF:()=>n,Q6:()=>r,XI:()=>m,Xo:()=>c,dV:()=>d,em:()=>a,f6:()=>p,ot:()=>l,qr:()=>g,rf:()=>u}),3023==o.j)var i=o(51395);const n=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingStart)&&void 0!==o?o:0)},r=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingEnd)&&void 0!==o?o:0)},s=e=>{var t;return null!==(t=null==e?void 0:e.paddingVertical)&&void 0!==t?t:8},a=e=>{var t,o;return(null!==(t=null==e?void 0:e.paddingVertical)&&void 0!==t?t:8)+(null!==(o=null==e?void 0:e.paddingBottom)&&void 0!==o?o:0)},l=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginHorizontal)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginStart)&&void 0!==o?o:0)},c=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginHorizontal)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginEnd)&&void 0!==o?o:0)},u=e=>{var t;return null!==(t=null==e?void 0:e.marginVertical)&&void 0!==t?t:0},d=e=>{var t,o;return(null!==(t=null==e?void 0:e.marginVertical)&&void 0!==t?t:0)+(null!==(o=null==e?void 0:e.marginBottom)&&void 0!==o?o:0)},h=(e,t)=>{var o,i;return void 0===t?void 0===(null==e?void 0:e.borderThickness)||"number"==typeof(null==e?void 0:e.borderThickness)?null!==(o=null==e?void 0:e.borderThickness)&&void 0!==o?o:1:void 0:"object"==typeof(null==e?void 0:e.borderThickness)?null!==(i=e.borderThickness[t])&&void 0!==i?i:0:void 0},g=e=>e.hidden?0:1,p=e=>{var t;return(null===(t=e.style)||void 0===t?void 0:t.flexibleSize)?1:void 0},f=e=>(null==e?void 0:e.textAlign)===i.R.Center?"center":"start",m=e=>(null==e?void 0:e.textAlign)===i.R.Center?"center":"flex-start"},496:(e,t,o)=>{"use strict";if(o.d(t,{$C:()=>r,EF:()=>c,G7:()=>n,O4:()=>h,SL:()=>a,gZ:()=>l,hM:()=>u,uk:()=>d}),3023==o.j)var i=o(22914);const n={background:{resting:"#FFFFFF",hover:"#D2D2D2",pressed:"#B1B1B1"},title:{resting:"#262626",disabled:"#666666"},tag:{resting:"#605e5c",disabled:"#666666"},subtitle:{resting:"#666666",disabled:"#666666"},focusRing:"#969696"},r={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},title:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},tag:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},subtitle:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},icon:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},focusRing:"var(--colorStrokeFocus2)",border:"var(--colorNeutralStroke1)"},s={background:{resting:"var(--colorBrandBackground)",hover:"var(--colorBrandBackgroundHover)",pressed:"var(--colorBrandBackgroundPressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},title:{resting:"var(--colorNeutralForegroundOnBrand)"},tag:{resting:"var(--colorNeutralForegroundOnBrand)"},subtitle:{resting:"var(--colorNeutralForegroundOnBrand)"},icon:{resting:"var(--colorNeutralForegroundOnBrand)"},focusRing:"var(--colorStrokeFocus2)",border:"var(--colorNeutralStroke1)"},a=(e,t,o,n,r,s,a,l)=>{const c={};r?a.background.disabled&&(c.backgroundColor=a.background.disabled,s&&a.border&&(c.borderColor=a.border)):(t&&((null==l?void 0:l.useFluentV9)&&(0,i.I)()?(c.backgroundColor="Canvas",c.borderColor="Highlight"):(a.background.hover&&(c.backgroundColor="undefined"!=typeof navigator&&/firefox/i.test(navigator.userAgent)?"Canvas":a.background.hover),a.focusRing&&o&&(c.borderColor=a.focusRing))),n&&(a.background.focused&&(c.backgroundColor=a.background.focused),a.focusRing&&(c.borderColor=a.focusRing)),e&&a.background.pressed&&(c.backgroundColor=a.background.pressed),a.border&&!c.borderColor&&(c.borderColor=a.border));const u=c.backgroundColor||((null==l?void 0:l.useFluentV9)&&(0,i.I)()?"Canvas":a.background.resting);return{backgroundColor:u,borderColor:c.borderColor||u}},l=(e,t,o,i,n)=>{let r=n.resting;return o?n.disabled&&(r=n.disabled):(t&&n.hover&&(r=n.hover),i&&n.focused&&(r=n.focused),e&&n.pressed&&(r=n.pressed)),r},c=(e,t,o)=>e.map((e=>{var i;let n=null!==(i=e.cssColor)&&void 0!==i?i:t;return o&&e.cssColorHover&&(n=e.cssColorHover),Object.assign(Object.assign({},e),{cssColor:n})})).filter((e=>!!e)),u=(e,t)=>e&&e.cssColor?e:e&&t?Object.assign(Object.assign({},e),{cssColor:t}):t?{cssColor:t}:e,d=(e,t)=>{const o=!(!e.showUnderline||!e.topPanelScopeButton);return t||!!e.hasKeyboardFocus||o},h=(e,t)=>e.theme?e.theme:(null==t?void 0:t.useFluentV9)?"primary"===e.appearance?s:r:n},93923:(e,t,o)=>{"use strict";if(o.d(t,{O:()=>l}),3023==o.j)var i=o(14888);var n=o(95734);if(3023==o.j)var r=o(82512);if(3023==o.j)var s=o(95809);if(3023==o.j)var a=o(90997);function l({accentSuggestionColors:e,accessibilityLabel:t,htmlId:o,onClick:l,onFocus:c,style:u,theme:d,isSelectedByKeyboard:h,icon:g}){return n.createElement(n.Fragment,null,n.createElement(s.c,{vertical:!0}),n.createElement("div",{className:a.K,style:e},n.createElement(r.u,{htmlId:o,style:u,accessibilityRole:"menuitem",accessibilityLabel:t,automationLabel:"InlineSuggestionsFeedback",onFocus:c,iconComponent:n.createElement(i.tNe,null),appearance:"transparent",title:void 0,onClick:l,theme:d,isSelectedByKeyboard:h,icon:g,tooltip:"Feedback"})))}},90997:(e,t,o)=>{"use strict";o.d(t,{K:()=>i}),(0,o(54167).hN)([{rawString:".feedbackButton_23aafea6 button{background-color:var(--defaultMenuButtonsRestingBgColor) !important;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.feedbackButton_23aafea6 button span{height:32px;min-width:auto}.feedbackButton_23aafea6 button:hover:not(.selected_23aafea6){border-width:2px !important;border-style:solid !important;background-color:var(--defaultMenuButtonsHoverBgColor) !important;border-color:var(--defaultMenuButtonsHoverBorderColor) !important}.feedbackButton_23aafea6 button:hover:not(.selected_23aafea6) path{fill:var(--defaultMenuButtonsHoveTextColor) !important}.feedbackButton_23aafea6 button:active,.feedbackButton_23aafea6 button:hover:active{border-width:2px !important;border-style:solid !important;background-color:var(--defaultMenuButtonsPressedBgColor) !important;border-color:var(--defaultMenuButtonsPressedBorderColor) !important}.feedbackButton_23aafea6 button:active path,.feedbackButton_23aafea6 button:hover:active path{fill:var(--defaultMenuButtonsPressedTextColor) !important}.feedbackButton_23aafea6 button:enabled:focus:not(.selected_23aafea6){border-width:2px !important;border-style:solid !important;background-color:var(--defaultMenuButtonsFocusedBgColor) !important;border-color:var(--defaultMenuButtonsFocusedBorderColor) !important}.feedbackButton_23aafea6 button:enabled:focus:not(.selected_23aafea6) path{fill:var(--defaultMenuButtonsFocusedTextColor) !important}.feedbackButton_23aafea6 button.selected_23aafea6{border-width:2px !important;border-style:solid !important;background-color:var(--defaultMenuButtonsSelectedBgColor) !important;border-color:var(--defaultMenuButtonsSelectedBorderColor) !important}.feedbackButton_23aafea6 button.selected_23aafea6 path{fill:var(--defaultMenuButtonsSelectedTextColor) !important}.feedbackButton_23aafea6 button:enabled:hover.selected_23aafea6{border-width:2px !important;border-style:solid !important;background-color:var(--defaultMenuButtonsSelectedHoverBgColor) !important;border-color:var(--defaultMenuButtonsSelectedHoverBorderColor) !important}.feedbackButton_23aafea6 button:enabled:hover.selected_23aafea6 path{fill:var(--defaultMenuButtonsSelectedHoverTextColor) !important}.feedbackButton_23aafea6 button:enabled.selected_23aafea6:hover:active{border-width:2px !important;border-style:solid !important;background-color:var(--defaultMenuButtonsSelectedPressedBgColor) !important;border-color:var(--defaultMenuButtonsSelectedPressedBorderColor) !important}.feedbackButton_23aafea6 button:enabled.selected_23aafea6:hover:active path{fill:var(--defaultMenuButtonsSelectedPressedTextColor) !important}.feedbackButton_23aafea6 button:enabled.selected_23aafea6:focus{border-width:2px !important;border-style:solid !important;background-color:var(--defaultMenuButtonsSelectedFocusedBgColor) !important;border-color:var(--defaultMenuButtonsSelectedFocusedBorderColor) !important}.feedbackButton_23aafea6 button:enabled.selected_23aafea6:focus path{fill:var(--defaultMenuButtonsSelectedFocusedTextColor) !important}"}]);const i="feedbackButton_23aafea6"},5076:(e,t,o)=>{"use strict";o.d(t,{R:()=>u,y:()=>d});var i=o(95734),n=o(16971),r=o(39904),s=o(20941),a=o(60874),l=o(43730),c=o(21257);const u=i.memo((0,i.forwardRef)(((e,t)=>{const o=i.useContext(n.O),l=i.useRef(null),c=i.useRef(null);(0,i.useImperativeHandle)(t,(()=>({focus:u})));const u=()=>{var e,t;o?null===(e=c.current)||void 0===e||e.focus():null===(t=l.current)||void 0===t||t.focus()};return o?i.createElement(d,Object.assign({},e,{ref:c})):i.createElement(a.R,{direction:(()=>{switch(e.direction){case r.E.Horizontal:return s.E.horizontal;case r.E.Vertical:return s.E.vertical;default:return s.E.bidirectional}})(),componentRef:l},e.children)})));u.displayName="FocusZone";const d=i.memo((0,i.forwardRef)(((e,t)=>{const o=i.useRef(null),{findFirstFocusable:n}=(0,l.r)(),{children:s,disableInitialFocus:a,direction:u=r.E.Default}=e;(0,i.useEffect)((()=>{a||d()}),[]),(0,i.useImperativeHandle)(t,(()=>({focus:d})));const d=()=>{var e;o.current&&(null===(e=n(o.current))||void 0===e||e.focus())},h=(0,c.i)({circular:u===r.E.Default,axis:u===r.E.Default?"grid":u===r.E.Horizontal?"horizontal":"vertical"}),g=u!==r.E.None?h:{};return i.createElement("div",Object.assign({ref:o},g),s)})));d.displayName="FocusZoneV9"},39904:(e,t,o)=>{"use strict";var i;o.d(t,{E:()=>i}),function(e){e[e.Default=0]="Default",e[e.Vertical=1]="Vertical",e[e.Horizontal=2]="Horizontal",e[e.None=3]="None"}(i||(i={}))},8821:(e,t,o)=>{"use strict";o.d(t,{Y:()=>a});var i=o(95734);if(3023==o.j)var n=o(7313);if(3023==o.j)var r=o(68803);if(3023==o.j)var s=o(78585);function a(e){var t,o,a,l;const c=i.useRef(0),u=i.useRef(0),d=()=>{if(!e.onHeaderHeightChange)return;const t=e.componentStackStyle.marginTop?e.componentStackStyle.marginTop:e.componentStackStyle.marginVertical,o=e.componentStackStyle.paddingTop?e.componentStackStyle.paddingTop:e.componentStackStyle.paddingVertical;let i=0;e.componentStackStyle.borderWidth&&(i="object"==typeof e.componentStackStyle.borderWidth?e.componentStackStyle.borderWidth.top?e.componentStackStyle.borderWidth.top:0:e.componentStackStyle.borderWidth),e.onHeaderHeightChange((t||0)+(o||0)+i+c.current+u.current)},h=e.tagText?i.createElement(n.S,{align:r.j5.Center,justifyContent:r.Pr.Center,style:null===(t=e.tagStyles)||void 0===t?void 0:t.containerStyles},i.createElement(s.c,{text:e.tagText,style:null===(o=e.tagStyles)||void 0===o?void 0:o.textStyles,accessibilityHidden:!0})):void 0;return i.createElement(n.S,{direction:e.stackDirection,style:e.componentStackStyle,align:e.stackAlignment,accessibleLive:null!==(a=e.accessibleLive)&&void 0!==a?a:r.pq.Polite,accessibilityLabel:null!==(l=e.accessibleLabel)&&void 0!==l?l:e.header,accessibilityRole:"group",accessible:!0,focusable:e.focusable},e.header&&i.createElement(n.S,{direction:r.PR.LeftToRight,align:r.j5.Center},i.createElement(s.c,{onHeightChange:e=>{e!=c.current&&(c.current=e,d())},text:e.header,style:e.headerStyle,accessibilityHidden:!0}),h),e.subheader&&e.subheaderStyle?i.createElement(s.c,{onHeightChange:e=>{e!=u.current&&(u.current=e,d())},text:e.subheader,style:e.subheaderStyle,accessibilityRole:"text"}):i.createElement(i.Fragment,null),e.children)}},22914:(e,t,o)=>{"use strict";function i(){return window.matchMedia("@media screen and (-ms-high-contrast: active), (forced-colors: active)").matches}o.d(t,{I:()=>i})},78607:(e,t,o)=>{"use strict";o.d(t,{E:()=>h});var i=o(95734),n=o(16971),r=o(92968),s=o(90992),a=o(57794),l=o(96895),c=o(66466);const u=i.lazy((()=>Promise.all([o.e(1804),o.e(1519)]).then(o.bind(o,94299)))),d=i.lazy((()=>o.e(490).then(o.bind(o,77555))));class h extends i.Component{render(){const e=!!this.context;return(0,c.R)(this.props,{useFluentV9:e})?i.createElement(g,Object.assign({},this.props)):null}}h.contextType=n.O;const g=e=>(0,s.j2)(e.type,!0)?i.createElement(i.Suspense,{fallback:i.createElement(a.A,Object.assign({},e))},i.createElement(u,Object.assign({},e))):(0,s.ku)(e.type)?i.createElement(l.A,Object.assign({},e)):(0,r.tv)(e.type,!0)?i.createElement(i.Suspense,{fallback:i.createElement(a.A,Object.assign({},e))},i.createElement(d,Object.assign({},e))):null},88511:(e,t,o)=>{"use strict";o.d(t,{_:()=>r});var i=o(95734);if(3023==o.j)var n=o(73385);const r=e=>{var t,o;return i.createElement(i.Fragment,null,i.createElement(n._,{src:e.uri,width:null===(t=e.style)||void 0===t?void 0:t.width,height:null===(o=e.style)||void 0===o?void 0:o.height,alt:e.altText}))}},96204:(e,t,o)=>{"use strict";o.d(t,{o:()=>I});var i=o(95734),n=o(496),r=o(36694),s=o(16971),a=o(56360);const l=e=>e.accessibilityLabel||e.title||e.strings&&e.strings.defaultOverflowButtonAccessibilityLabel,c=(e,t,o)=>{var i,r;const s=Object.assign({},null!==(r=null!==(i=t.buttonOnlyTheme)&&void 0!==i?i:t.theme)&&void 0!==r?r:(null==o?void 0:o.useFluentV9)?n.$C:n.G7);return e&&(s.background.hover&&(s.background=Object.assign(Object.assign({},s.background),{resting:s.background.hover})),s.title.hover&&(s.title=Object.assign(Object.assign({},s.title),{resting:s.title.hover})),s.subtitle&&s.subtitle.hover&&(s.subtitle=Object.assign(Object.assign({},s.subtitle),{resting:s.subtitle.hover})),s.icon&&s.icon.hover&&(s.icon=Object.assign(Object.assign({},s.icon),{resting:s.icon.hover}))),s},u=e=>{const t=e.style;return t&&void 0!==t.paddingHorizontal?t:Object.assign(Object.assign({},t),{paddingHorizontal:8})};var d=o(21257),h=o(50752),g=o(3488),p=o(67026),f=o(16895),m=o(66466),v=o(48545),b=o(51249);function y(e){return void 0!==e.iconType?{type:e.iconType,filled:!0}:void 0}const w=e=>{const t=[];if(e.items){const o=e.items.filter((e=>"item"===e.type)),n=o.some((e=>{const t=y(e);return!!t&&(0,m.R)(t)}));let r=1;t.push(e.items.map((t=>{var s;switch(t.type){case"item":return function(e,t,o,n,r,s,l){const{itemTheme:c,automationLabelType:u,automationId:d}=e,h=y(t),g=function(e,t,o){var i,n,r;const s={paddingHorizontal:8,flexibleSize:!0,iconFontSize:20,borderRadius:null!==(n=null===(i=e.style)||void 0===i?void 0:i.borderRadius)&&void 0!==n?n:4};return!t||o||(s.paddingStart=8+(0,f.S)(null===(r=e.icon)||void 0===r?void 0:r.fontSize)),s}(e,s,void 0!==t.iconType);return i.createElement(a.J,{appearance:"subtle",key:t.key,title:t.title,titleStyle:t.titleStyle,onClick:()=>o(t),disabled:t.disabled,theme:c,htmlId:l+t.key,accessibilityRole:"menuitem",automationLabel:`${u}_${t.title}_${d}`,icon:h,style:g,accessibilityPositionInSet:n,accessibilitySetSize:r,useAlternateIconColors:!0})}(e,t,e.onItemClick,r++,o.length,n,null!==(s=null==e?void 0:e.id)&&void 0!==s?s:"");case"separator":return i.createElement(v.w,{key:t.key,color:e.theme&&e.theme.separator});default:return null}})))}return i.createElement(b.i,Object.assign({},e,{baseItems:t}))};class C extends i.PureComponent{getAccessibilityLabel(){return this.props.accessibilityLabel||this.props.title||this.props.strings&&this.props.strings.defaultOverflowButtonAccessibilityLabel}renderButton(e,t,o,n,r,s,l){var c,u,d,h,g;const p=Object.assign(Object.assign({},l),{layerHostId:this.props.layerHostId?this.props.layerHostId:void 0});return i.createElement(a.J,{ref:r,key:t,htmlId:s,title:this.props.title,icon:{type:null!==(u=null===(c=this.props.icon)||void 0===c?void 0:c.type)&&void 0!==u?u:"Overflow",filled:(null===(d=this.props.icon)||void 0===d?void 0:d.filled)||o},tooltip:null!==(h=this.props.tooltip)&&void 0!==h?h:null===(g=this.props.strings)||void 0===g?void 0:g.defaultOverflowButtonAccessibilityLabel,tooltipProps:p,disabled:this.props.disabled,hidden:this.props.hidden,refusesKeyboardFocus:this.props.refusesKeyboardFocus,style:this.getStyle(),theme:this.getCompositeButtonTheme(),strings:this.props.strings,onClick:e,onHoverIn:this.props.onHoverIn,onHoverOut:this.props.onHoverOut,onFocus:this.props.onFocus,onBlur:this.props.onBlur,accessibilityLabel:this.getAccessibilityLabel(),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:o,onAccessibilityExpandCollapse:n,automationLabel:`${this.props.automationLabelType}_${this.props.title||"OverFlow"}_${this.props.automationId}`,hasKeyboardFocus:this.props.hasKeyboardFocus,onHeightChange:this.props.onHeightChange})}getCompositeButtonTheme(){return this.props.buttonOnlyTheme?this.props.buttonOnlyTheme:this.props.theme?this.props.theme:n.G7}getStyle(){const e=this.props.style;return e&&void 0!==e.paddingHorizontal?e:Object.assign(Object.assign({},e),{paddingHorizontal:8})}}class S extends C{constructor(e){super(e),this.state={menuOpen:!!e.startOpen},this.buttonRef=i.createRef(),this.onMenuDismiss=this.onMenuDismiss.bind(this),this.onButtonClick=this.onButtonClick.bind(this),this.onItemClick=this.onItemClick.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onAccessibilityExpandCollapse=this.onAccessibilityExpandCollapse.bind(this)}componentDidUpdate(){this.props.startOpen&&this.openMenu()}openMenu(){this.state.menuOpen||(this.setState({menuOpen:!0}),this.handleMenuOpen())}focus(){var e;null===(e=this.buttonRef.current)||void 0===e||e.focus()}performAccessibilityExpandCollapse(e){this.onAccessibilityExpandCollapse(e)}renderAnchorButtonAndMaybeCallout(){var e;const t=this.renderButton(this.onButtonClick,"button",this.state.menuOpen,this.onAccessibilityExpandCollapse,this.buttonRef,this.props.id,null===(e=this.props.style)||void 0===e?void 0:e.tooltipProps),o=this.state.menuOpen?this.renderCallout("callout",this.onMenuDismiss):void 0;return o?[t,o]:[t]}calculateBorderRadiusForCalloutItem(){var e,t,o,i,n;if(void 0!==(null===(e=this.props.style)||void 0===e?void 0:e.borderRadius))return"number"==typeof(null===(t=this.props.style)||void 0===t?void 0:t.borderRadius)?null===(o=this.props.style)||void 0===o?void 0:o.borderRadius:null===(n=null===(i=this.props.style)||void 0===i?void 0:i.borderRadius)||void 0===n?void 0:n.topEnd}renderCalloutItems(){return i.createElement(w,Object.assign({},this.props,{style:Object.assign(Object.assign({},this.props.style),{borderRadius:this.calculateBorderRadiusForCalloutItem()}),onItemClick:this.onItemClick,onKeyDown:this.onKeyDown}))}getCompositeButtonTheme(){const e=Object.assign({},super.getCompositeButtonTheme());return this.state.menuOpen&&(e.background.hover&&(e.background=Object.assign(Object.assign({},e.background),{resting:e.background.hover})),e.title.hover&&(e.title=Object.assign(Object.assign({},e.title),{resting:e.title.hover})),e.subtitle&&e.subtitle.hover&&(e.subtitle=Object.assign(Object.assign({},e.subtitle),{resting:e.subtitle.hover})),e.icon&&e.icon.hover&&(e.icon=Object.assign(Object.assign({},e.icon),{resting:e.icon.hover}))),e}handleMenuOpen(){this.props.onMenuOpen&&this.props.onMenuOpen()}handleMenuDismiss(e){this.props.onMenuDismiss&&this.props.onMenuDismiss(e),this.shouldFocusButtonOnDismiss()&&this.focus()}onMenuDismiss(e){this.handleMenuDismiss(e),this.setState({menuOpen:!1})}onButtonClick(){this.setState((e=>{const t={menuOpen:!e.menuOpen};return t.menuOpen?this.handleMenuOpen():this.handleMenuDismiss(),t}))}onItemClick(e){this.props.onClick&&this.props.onClick(e),e.preventDismiss||this.onMenuDismiss()}onKeyDown(e){this.props.onTabClose&&e.key===r.h.Tab&&this.onMenuDismiss(!0)}onAccessibilityExpandCollapse(e){"expand"===e&&this.state.menuOpen||"collapse"===e&&!this.state.menuOpen||this.onButtonClick()}}var k=o(32334),T=o(10056),x=o(60874),_=o(20941);class I extends S{constructor(e){super(e),this.overflowButtonRef=i.createRef()}render(){return this.context?i.createElement(E,Object.assign({},this.props,{ref:this.props.refV9})):i.createElement("div",{ref:this.overflowButtonRef,style:{display:"flex"},role:"menu"},this.renderAnchorButtonAndMaybeCallout())}shouldFocusButtonOnDismiss(){var e;return null===(e=this.props.shouldFocusButtonOnDismiss)||void 0===e||e}renderCallout(e,t){var o,n,r,s;const a=null===(n=null===(o=this.props.style)||void 0===o?void 0:o.calloutStyle)||void 0===n?void 0:n.borderRadius;return i.createElement(k.P,{layerProps:this.props.layerHostId?{hostId:this.props.layerHostId}:void 0,styles:{beakCurtain:{borderRadius:a},calloutMain:{backgroundColor:null===(r=this.props.theme)||void 0===r?void 0:r.background.resting,borderRadius:a},root:{backgroundColor:null===(s=this.props.theme)||void 0===s?void 0:s.background.resting,borderRadius:a}},key:e,role:"menu",target:this.overflowButtonRef,isBeakVisible:!1,alignTargetEdge:!0,directionalHint:T.A.bottomLeftEdge,onDismiss:t,setInitialFocus:!0},i.createElement(x.R,{isCircularNavigation:!0,handleTabKey:_.l.all},this.renderCalloutItems()))}}I.contextType=s.O;const E=i.memo((0,i.forwardRef)(((e,t)=>{var o,n,f,m,v;const b=i.useRef(null),{menuOpen:y,button:C,buttonRef:S,focus:k,setMenuOpen:T,onAccessibilityExpandCollapse:x,onMenuOpen:_,onMenuDismiss:I,onItemClick:E,onKeyDown:B}=(e=>{const t=i.useRef(null),o=i.useRef(null),[n,d]=i.useState(!!e.startOpen),h=i.useContext(s.O),g=()=>{var e;null===(e=t.current)||void 0===e||e.focus()},p=t=>{var i;null===(i=e.onMenuDismiss)||void 0===i||i.call(e,t),!1!==e.shouldFocusButtonOnDismiss?g():(()=>{var e;null===(e=o.current)||void 0===e||e.focus()})(),o.current=null},f=e=>{p(e),d(!1)},m=()=>{d((t=>{var o;const i=!t;return i?null===(o=e.onMenuOpen)||void 0===o||o.call(e):p(),i}))},v=e=>{"expand"===e&&n||"collapse"===e&&!n||m()},b=((e,t,o,n=!1,r,s,d,h)=>{var g,p,f,m,v;return i.createElement(a.J,{appearance:"subtle",ref:s,key:o,htmlId:d,title:e.title,icon:{type:null!==(p=null===(g=e.icon)||void 0===g?void 0:g.type)&&void 0!==p?p:"Overflow",filled:(null===(f=e.icon)||void 0===f?void 0:f.filled)||n},tooltip:null!==(m=e.tooltip)&&void 0!==m?m:null===(v=e.strings)||void 0===v?void 0:v.defaultOverflowButtonAccessibilityLabel,tooltipProps:e.layerHostId?{layerHostId:e.layerHostId}:void 0,disabled:e.disabled,hidden:e.hidden,refusesKeyboardFocus:e.refusesKeyboardFocus,style:u(e),theme:c(n,e,h),strings:e.strings,onClick:t,onHoverIn:e.onHoverIn,onHoverOut:e.onHoverOut,onFocus:e.onFocus,onBlur:e.onBlur,accessibilityLabel:l(e),accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:n,onAccessibilityExpandCollapse:r,automationLabel:`${e.automationLabelType}_${e.title||"OverFlow"}_${e.automationId}`,hasKeyboardFocus:e.hasKeyboardFocus,onHeightChange:e.onHeightChange})})(e,m,"button",n,v,t,e.id,{useFluentV9:h});return{menuOpen:n,button:b,buttonRef:t,focus:g,setMenuOpen:d,onAccessibilityExpandCollapse:v,onMenuOpen:t=>{var i;n||(o.current=t?document.activeElement:null,d(!0),null===(i=e.onMenuOpen)||void 0===i||i.call(e))},onMenuDismiss:f,onItemClick:t=>{var o;null===(o=e.onClick)||void 0===o||o.call(e,t),t.preventDismiss||f()},onKeyDown:t=>{e.onTabClose&&t.key===r.h.Tab&&f(!0)}}})(Object.assign(Object.assign({},e),{shouldFocusButtonOnDismiss:null===(o=e.shouldFocusButtonOnDismiss)||void 0===o||o}));(0,i.useImperativeHandle)(t,(()=>({focus:k,openMenu:_,onAccessibilityExpandCollapse:x})));const A=(0,d.i)({circular:!0,axis:"vertical"});return i.createElement(h.A,{trapFocus:!0,open:y,onOpenChange:(e,t)=>{T(t.open),t.open?_():I()},closeOnScroll:!1,positioning:{position:"below",align:"start",target:null===(f=null===(n=S.current)||void 0===n?void 0:n.getElementRef())||void 0===f?void 0:f.current}},i.createElement(g.W,null,i.createElement("div",{id:e.layerHostId,role:"menu",style:{display:"flex"},ref:b,tabIndex:-1},C)),i.createElement(p.H,{style:{padding:4,borderWidth:"0px",borderRadius:null===(v=null===(m=e.style)||void 0===m?void 0:m.calloutStyle)||void 0===v?void 0:v.borderRadius}},i.createElement("div",Object.assign({style:{display:"flex",flexDirection:"column"},role:"menu",className:"ms-cc-overflow"},A),i.createElement(w,Object.assign({},e,{style:Object.assign(Object.assign({},e.style),{borderRadius:(()=>{var t,o,i,n,r;if(void 0!==(null===(t=e.style)||void 0===t?void 0:t.borderRadius))return"number"==typeof(null===(o=e.style)||void 0===o?void 0:o.borderRadius)?null===(i=e.style)||void 0===i?void 0:i.borderRadius:null===(r=null===(n=e.style)||void 0===n?void 0:n.borderRadius)||void 0===r?void 0:r.topEnd})()}),onItemClick:E,onKeyDown:B})))))})))},26483:(e,t,o)=>{"use strict";o.d(t,{B:()=>l});var i=o(95734),n=o(20193);(0,o(54167).hN)([{rawString:".customScrollBar_cfe9a557{scrollbar-width:none}.customScrollBar_cfe9a557::-webkit-scrollbar{display:none}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557{position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:6px;top:4px;overflow:hidden}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557{position:absolute;width:3px;border-radius:6px;background:var(--thumb-color);opacity:.7}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557:hover{width:5px}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557.ltr_cfe9a557{right:3px}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557.rtl_cfe9a557{left:3px}@media screen and (-ms-high-contrast: active),(forced-colors: active){.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557{background:highlight !important}}"}]);var r=function(e,t,o,i){return new(o||(o=Promise))((function(n,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function s(e,t,o){return a((e=>setTimeout(e,t)),e,o)}function a(e,t,o){let i=!1,n=!1;const s=[];let l=!1;return()=>new Promise((c=>r(this,void 0,void 0,(function*(){if("Immediately"===o){if(!i){i=!0;try{yield t()}catch(e){}e((()=>{i=!1,c()}))}}else i?(l&&(n=!0),s.push(c)):(i=!0,e((()=>r(this,void 0,void 0,(function*(){l=!0;try{yield t()}catch(e){}l=!1,i=!1,c();for(const e of s)e();n&&(n=!1,a(e,t,o))})))))}))))}const l=i.memo((e=>{var t,o,r,a;const l=!!e.alwaysShowScrollbar,[u,d]=i.useState(l),[h,g]=i.useState(20),[p,f]=i.useState((null===(t=e.style)||void 0===t?void 0:t.paddingScrollTop)?e.style.paddingScrollTop:0),[m,v]=i.useState(0),[b,y]=i.useState(!1),w=i.useRef({delta:{x:0,y:0}}),C=i.useRef(null),S=i.useRef(null),k=(null===(o=e.style)||void 0===o?void 0:o.scrollbarThumbWidth)?e.style.scrollbarThumbWidth:6,T=(null===(r=e.style)||void 0===r?void 0:r.scrollbarPaddingBottom)?e.style.scrollbarPaddingBottom:0,x=()=>{var t,o;if(C.current){const{style:i}=e,{clientHeight:n,scrollHeight:r}=C.current;return{clientHeight:n,contentHeight:r,viewableRatio:(n-(null!==(t=null==i?void 0:i.paddingTop)&&void 0!==t?t:0)-(null!==(o=null==i?void 0:i.paddingBottom)&&void 0!==o?o:0))/(r+T)}}return{clientHeight:0,contentHeight:0,viewableRatio:0}},_=(null===(a=e.style)||void 0===a?void 0:a.paddingScrollTop)?e.style.paddingScrollTop:0,I=i.useCallback((()=>{var t;if(C.current){const{viewableRatio:e}=x();f(Math.max(e*C.current.scrollTop,_))}null===(t=e.onScroll)||void 0===t||t.call(e)}),[e.onScroll]),E={scrollableContainer:{scroll:b?I:s(I,50,"After"),mouseOver:()=>{if(!u&&c(C,u,p,l)){const{onScrollStatusChange:t}=e;t&&t(!0),d(!0)}},mouseUp:()=>{y(!1),w.current.delta={x:0,y:0}}},scrollbarContainer:{mouseDown:e=>{if(e.preventDefault(),C.current&&S.current){const{clientHeight:t,contentHeight:o}=x(),i=e.clientY-S.current.getBoundingClientRect().top;C.current.scroll({top:i/t*o}),y(!0)}}},scrollbarThumb:{mouseDown:e=>{e.stopPropagation(),e.preventDefault(),y(!0)}}},{scrollTo:B}=e;let A;switch(i.useEffect((()=>{if(C.current){if(u)return;const t=c(C,u,p,l);if(t!==u){const{onScrollStatusChange:o}=e;o&&o(t),d(t)}}}),[C.current,u,p,l,e.onScrollStatusChange]),i.useEffect((()=>(()=>{if(C.current&&e.scrollTo){const{top:t,bottom:o,isNewRender:i}=e.scrollTo,n=6,r=Math.max(t-n,0),s=Math.min(o+n,C.current.scrollHeight);if(r<C.current.scrollTop?C.current.scrollTo({top:r,behavior:"smooth"}):s>=C.current.scrollTop+C.current.offsetHeight&&C.current.scrollTo({top:s-C.current.offsetHeight,behavior:"smooth"}),!i&&c(C,u,p,l)){const{onScrollStatusChange:t}=e;t&&t(!0),d(!0)}}})()),[null==B?void 0:B.top,null==B?void 0:B.bottom]),i.useEffect((()=>(()=>{if(C.current){const{clientHeight:e,viewableRatio:t}=x();g(Math.round(t*e)),v(e)}})())),i.useEffect((()=>{if(!b)return;const e=()=>y(!1);return window.addEventListener("mouseup",e,{once:!0,passive:!0}),()=>window.removeEventListener("mouseup",e)}),[b]),i.useEffect((()=>{if(!b)return;let e;const t=t=>{b&&(t.movementX||t.movementY)&&(w.current.delta.x+=t.movementX,w.current.delta.y+=t.movementY,null==e&&(e=requestAnimationFrame((()=>{if(e=void 0,C.current){const{y:e}=w.current.delta;w.current.delta={x:0,y:0};const{clientHeight:t,contentHeight:o}=x();C.current.scroll({top:C.current.scrollTop+e/t*o})}}))))};return window.addEventListener("mousemove",t,{passive:!0}),()=>window.removeEventListener("mousemove",t)}),[b]),e.scrollDirection){case"horizontal":A={overflowY:"hidden",overflowX:"auto",display:"flex",flexDirection:"row"};break;case"both":A={overflowY:"auto",overflowX:"auto",display:"block",flexDirection:"row"};break;default:A={overflowY:"auto",overflowX:"hidden",display:"block",flexDirection:"column"}}const R=i.useContext(n.q),M="horizontal"!==e.scrollDirection?i.createElement("div",{style:{height:m,opacity:e.hidden?0:1},className:"scrollbarContainer_cfe9a557 "+(R?"rtl_cfe9a557":"ltr_cfe9a557"),ref:S,onMouseDown:E.scrollbarContainer.mouseDown},u&&i.createElement("div",{style:{height:h,top:p,width:k,transition:b?void 0:"all 0.1s ease-out"},className:"scrollbarThumb_cfe9a557",onMouseDown:E.scrollbarThumb.mouseDown})):void 0;return i.createElement("div",{style:(t=>{let o=Object.assign({},t);const{style:i,theme:n}=e;if(i){if(i.paddingHorizontal)o.paddingRight=i.paddingHorizontal,o.paddingLeft=i.paddingHorizontal;else{const e=R?i.paddingEnd:i.paddingStart,t=R?i.paddingStart:i.paddingEnd;void 0!==t&&(o.paddingRight=t),void 0!==e&&(o.paddingLeft=e)}i.paddingTop&&(o.paddingTop=i.paddingTop),i.paddingBottom&&(o.paddingBottom=i.paddingBottom),i.borderRadius&&(o.borderRadius=i.borderRadius),i.width&&(o.width=i.width)}return n&&n.thumbColor&&(o=Object.assign(Object.assign({},o),{"--thumb-color":n.thumbColor})),o})(A),className:"customScrollBar_cfe9a557",ref:C,onScroll:E.scrollableContainer.scroll,onMouseUp:E.scrollableContainer.mouseUp,onMouseOver:E.scrollableContainer.mouseOver},e.children,M)}));function c(e,t,o,i){if(e.current){const{clientHeight:n,scrollHeight:r}=e.current;return r>n&&(o>4||t||i)}return!1}l.displayName="ScrollView"},48803:(e,t,o)=>{"use strict";o.d(t,{G:()=>u});var i=o(95734);if(3023==o.j)var n=o(44626);if(3023==o.j)var r=o(44207);if(3023==o.j)var s=o(20193);if(3023==o.j)var a=o(49790);if(3023==o.j)var l=o(87579);if(3023==o.j)var c=o(51485);const u=({htmlId:e,theme:t,styles:o,accessibilityLabel:u,accessibilitySetSize:d,accessibilityPositionInSet:h,placeholder:g,disabled:p,handledKeys:f,spellCheck:m,value:v,hideDismiss:b,autoFocus:y,isSearchBoxHighlighted:w,onValueChange:C,onKeyDown:S,onClear:k,onSearchFocus:T})=>{var x,_,I;const E={};n.tO({onKeyDown:S,handledKeys:f},E);const B=i.useContext(s.q),A=(0,r.Zq)({"& input":{color:null==t?void 0:t.textColor,"::placeholder":{color:null==t?void 0:t.placeholderTextColor}}}),R=(0,r.Zq)({backgroundColor:null===(x=null==t?void 0:t.clearButton)||void 0===x?void 0:x.resting,":hover":{backgroundColor:null===(_=null==t?void 0:t.clearButton)||void 0===_?void 0:_.hover}}),M=i.useRef(null);return i.useEffect((()=>{var e;w&&(null===(e=M.current)||void 0===e||e.focus())}),[w]),i.useEffect((()=>{var e;y&&(null===(e=M.current)||void 0===e||e.focus())}),[]),i.createElement(a.G,{ref:M,className:A,style:{background:null==t?void 0:t.background,borderColor:null===(I=null==t?void 0:t.borderColor)||void 0===I?void 0:I.resting,borderRadius:null==o?void 0:o.borderRadius,borderBottom:null==o?void 0:o.borderBottom,width:null==o?void 0:o.width,marginTop:null==o?void 0:o.marginTop,marginBottom:null==o?void 0:o.marginBottom,marginLeft:B?null==o?void 0:o.marginEnd:null==o?void 0:o.marginStart,marginRight:B?null==o?void 0:o.marginStart:null==o?void 0:o.marginEnd},autoComplete:"off",placeholder:g,onChange:(e,t)=>null==C?void 0:C(t.value),onFocus:T,id:e,"aria-label":u,"aria-posinset":h,"aria-setsize":d,disabled:p,defaultValue:v,onKeyDown:E.onKeyDown,dismiss:b?null:i.createElement(l.BEt,{color:null==t?void 0:t.textColor,className:R,onClick:k}),spellCheck:m,contentBefore:i.createElement(c.vMY,{color:null==t?void 0:t.iconColor})})}},48545:(e,t,o)=>{"use strict";o.d(t,{w:()=>s});var i=o(95734);if(3023==o.j)var n=o(95809);if(3023==o.j)var r=o(20193);const s=({style:e,onHeightChange:t})=>{var o;const s=(null==e?void 0:e.marginHorizontal)?e.marginHorizontal:0,a=(null==e?void 0:e.marginVertical)?e.marginVertical:0,l=void 0!==(null==e?void 0:e.marginTop)?e.marginTop:a||0,c=void 0!==(null==e?void 0:e.marginBottom)?e.marginBottom:a||0,u=void 0!==(null==e?void 0:e.marginStart)?e.marginStart:s||0,d=void 0!==(null==e?void 0:e.marginEnd)?e.marginEnd:s||0,h=i.useContext(r.q),g=h?d:u,p=h?u:d,f=null!==(o=null==e?void 0:e.height)&&void 0!==o?o:2;t&&t(f+l+c);const m={height:`${f}px`,padding:"0px"};return i.createElement("div",{style:{marginTop:l,marginBottom:c,marginLeft:g,marginRight:p}},i.createElement(n.c,{style:m}))}},87962:(e,t,o)=>{"use strict";o.d(t,{v:()=>c});var i=o(95734);if(3023==o.j)var n=o(7313);if(3023==o.j)var r=o(68803);if(3023==o.j)var s=o(29572);if(3023==o.j)var a=o(84226);function l(e){if(e)return{paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,paddingHorizontal:e.paddingHorizontal}}const c=e=>{var t,o,c;if(e.styles&&e.styles.widths&&e.shimmerCount!==e.styles.widths.length)return null;const u=[];for(let n=0;n<e.shimmerCount;n+=1)u.push(i.createElement("div",{style:{width:null!==(c=null===(o=null===(t=e.styles)||void 0===t?void 0:t.widths)||void 0===o?void 0:o[n])&&void 0!==c?c:void 0}},i.createElement(s.H,{style:{marginBottom:5}})));return i.createElement(n.S,{style:l(e.styles),direction:r.PR.TopToBottom,align:r.j5.Stretch},i.createElement(a.E,{appearance:"translucent"},u))}},20855:(e,t,o)=>{"use strict";o.d(t,{f:()=>m});var i=o(95734);function n(e,t){return e.hover?t?Object.assign(Object.assign({},e),{resting:e.hover}):Object.assign(Object.assign({},e),{hover:void 0}):e}function r(e,t){return Object.assign(Object.assign({},e),{resting:t,hover:void 0})}function s(e,t,o,i){return Object.assign(Object.assign({},e),{background:t&&t.splitMenuHoverBackground&&o&&i?r(e.background,t.splitMenuHoverBackground):n(e.background,o),title:t&&t.splitMenuHoverForeground&&o&&i?r(e.title,t.splitMenuHoverForeground):n(e.title,o),icon:t&&t.splitMenuHoverForeground&&o&&i?r(e.icon,t.splitMenuHoverForeground):e.icon&&n(e.icon,o)})}function a(e){var t;return null!==(t=null==e?void 0:e.borderThickness)&&void 0!==t?t:1}function l(e){var t;return null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:0}function c(e){return!(!e.menuProps||!e.menuProps.items)&&e.menuProps.items.length>0}var u=o(496),d=o(7313),h=o(68803),g=o(56360),p=o(96204),f=o(16971);class m extends i.PureComponent{constructor(e){super(e),this.state={buttonHover:!1,buttonFocus:!1,overflowHover:!1,overflowFocus:!1,menuOpened:!1,overflowTimeout:void 0,highlightTimeout:void 0},this.buttonRef=i.createRef(),this.onButtonHoverIn=this.handleEvent.bind(this,"buttonHover",!0),this.onButtonHoverOut=this.handleEvent.bind(this,"buttonHover",!1),this.onButtonFocus=this.handleEvent.bind(this,"buttonFocus",!0),this.onButtonBlur=this.handleEvent.bind(this,"buttonFocus",!1),this.onOverflowHoverIn=this.handleEvent.bind(this,"overflowHover",!0),this.onOverflowHoverOut=this.handleEvent.bind(this,"overflowHover",!1),this.onOverflowFocus=this.handleEvent.bind(this,"overflowFocus",!0),this.onOverflowBlur=this.handleEvent.bind(this,"overflowFocus",!1),this.onMenuOpened=this.handleEvent.bind(this,"menuOpened",!0),this.onMenuDismissed=this.handleEvent.bind(this,"menuOpened",!1)}static shouldShowHighlight(e,t){return e.buttonHover||e.overflowHover||e.menuOpened||!t&&void 0!==e.highlightTimeout}static shouldSetHighlightTimerForEvent(e){return"buttonHover"===e||"overflowHover"===e}static shouldShowOverflow(e,t){return e.buttonHover||e.buttonFocus||e.overflowHover||e.overflowFocus||e.menuOpened||!t&&void 0!==e.overflowTimeout}static isSplitButtonEntered(e){return e.buttonHover||e.buttonFocus||e.overflowHover||e.overflowFocus||e.menuOpened}static setTimerHighlightedInstance(e){this.timerHighlightedInstance!==e&&(void 0!==e&&void 0!==this.timerHighlightedInstance&&void 0!==this.timerHighlightedInstance.state.highlightTimeout&&this.timerHighlightedInstance.cancelUnhighlightTimer(!1),this.timerHighlightedInstance=e)}render(){var e,t;const o=this.props.style,n={marginHorizontal:null==o?void 0:o.marginHorizontal,marginVertical:null==o?void 0:o.marginVertical,flexibleSize:null==o?void 0:o.flexibleSize,height:null==o?void 0:o.height,minHeight:null==o?void 0:o.minHeight,maxHeight:null==o?void 0:o.maxHeight},r=this.context;if(this.drawBorderOnRoot()&&!r){const o=null!==(e=this.props.buttonProps.theme)&&void 0!==e?e:u.G7;n.borderColor=null!==(t=o.border)&&void 0!==t?t:m.shouldShowHighlight(this.state)?o.background.hover:o.background.resting,n.borderStyle="solid",n.borderWidth=a(this.props.style),n.borderRadius=l(this.props.style)}return i.createElement(d.S,{direction:h.PR.LeftToRight,align:h.j5.Stretch,style:n},i.createElement(g.J,Object.assign({ref:this.buttonRef},this.computeButtonProps())),c(this.props)?i.createElement(p.o,Object.assign({},this.computeOverflowMenuProps())):null)}focus(){this.buttonRef.current&&this.buttonRef.current.focus()}componentWillUnmount(){m.timerHighlightedInstance===this&&m.setTimerHighlightedInstance(void 0),this.cancelOverflowTimer(!1),this.cancelUnhighlightTimer(!1),super.componentWillUnmount&&super.componentWillUnmount()}cancelOverflowTimer(e){void 0!==this.state.overflowTimeout&&(clearTimeout(this.state.overflowTimeout),e||this.setState({overflowTimeout:void 0}))}cancelUnhighlightTimer(e){void 0!==this.state.highlightTimeout&&(clearTimeout(this.state.highlightTimeout),e||this.setState({highlightTimeout:void 0}))}computeButtonProps(){var e;const t=this.context,o=a(this.props.style),i=l(this.props.style),r=Object.assign(Object.assign({},this.props.style),{paddingEnd:o,borderRadius:{topStart:i,bottomStart:i}});c(this.props)||(r.borderRadius={topStart:i,topEnd:i,bottomStart:i,bottomEnd:i}),this.drawBorderOnRoot()||t?r.borderThickness=0:r.borderThickness={start:o,top:o,bottom:o},this.props.menuProps||delete r.paddingEnd,delete r.marginHorizontal,delete r.marginVertical,delete r.height,delete r.minHeight,delete r.maxHeight;const s=this.props.buttonProps,d=(null==s?void 0:s.icon)?null==s?void 0:s.icon:void 0,h=function(e,t){return Object.assign(Object.assign({},e),{background:n(e.background,t),title:n(e.title,t),subtitle:e.subtitle&&n(e.subtitle,t),icon:e.icon&&n(e.icon,t)})}(null!==(e=s.theme)&&void 0!==e?e:t?u.$C:u.G7,m.shouldShowHighlight(this.state)),g=function(e,t){if(null!=e)return e.map((e=>{const o=Object.assign({},e);return t&&o.cssColorHover&&(o.cssColor=o.cssColorHover),o}))}(s.titleStyle,m.shouldShowHighlight(this.state));return Object.assign(Object.assign({},s),{titleStyle:g,appearance:"subtle",icon:d,style:r,theme:h,tooltipProps:this.props.layerHostId?{layerHostId:this.props.layerHostId}:void 0,onHoverIn:this.onButtonHoverIn,onHoverOut:this.onButtonHoverOut,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize})}computeOverflowMenuProps(){var e;const t=a(this.props.style),o=l(this.props.style),i={paddingStart:t,borderRadius:{topEnd:o,bottomEnd:o}},n=this.context;this.drawBorderOnRoot()||n?i.borderThickness=0:i.borderThickness={top:t,end:t,bottom:t};const r=this.props.menuProps,c=null!==(e=r.theme)&&void 0!==e?e:n?u.$C:u.G7;return Object.assign(Object.assign({},r),{icon:{type:"Overflow",filled:!0},hidden:!m.shouldShowOverflow(this.state),style:i,theme:s(c,this.props.theme,m.shouldShowHighlight(this.state),this.state.overflowHover||this.state.menuOpened),accessibilityLabel:(d=this.props,d.menuProps&&d.menuProps.accessibilityLabel?d.menuProps.accessibilityLabel:d.buttonProps.title&&d.strings&&d.strings.defaultSplitButtonOverflowAccessibilityLabel?d.strings.defaultSplitButtonOverflowAccessibilityLabel.replace("{0}",d.buttonProps.title):void 0),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,layerHostId:this.props.layerHostId,onHoverIn:this.onOverflowHoverIn,onHoverOut:this.onOverflowHoverOut,onFocus:this.onOverflowFocus,onBlur:this.onOverflowBlur,onMenuOpen:this.onMenuOpened,onMenuDismiss:this.onMenuDismissed});var d}setOverflowTimer(){if(!(m.hideOverflowLagInMs<=0))return this.cancelOverflowTimer(!0),setTimeout((()=>{this.setState({overflowTimeout:void 0})}),m.hideOverflowLagInMs)}setUnhighlightTimer(){if(!(m.unhoverLagInMs<=0))return this.cancelUnhighlightTimer(!0),setTimeout((()=>{m.timerHighlightedInstance===this&&m.setTimerHighlightedInstance(void 0),this.setState({highlightTimeout:void 0})}),m.unhoverLagInMs)}handleEvent(e,t){m.shouldSetHighlightTimerForEvent(e)&&t&&m.setTimerHighlightedInstance(this),this.setState((o=>{var i,n,r,s;if(o[e]===t)return;const a=Object.assign({},o);a[e]=t,t&&("overflowHover"===e&&(a.buttonHover=!1),"buttonHover"===e&&(a.overflowHover=!1)),a.highlightTimeout=m.shouldShowHighlight(o)&&!m.shouldShowHighlight(a)?this.setUnhighlightTimer():void 0,a.overflowTimeout=m.shouldShowOverflow(o)&&!m.shouldShowOverflow(a)?this.setOverflowTimer():void 0;const l=m.isSplitButtonEntered(o),c=m.isSplitButtonEntered(a);return!l&&c?null===(n=(i=this.props.buttonProps).onSplitButtonIn)||void 0===n||n.call(i):l&&!c&&(null===(s=(r=this.props.buttonProps).onSplitButtonOut)||void 0===s||s.call(r)),a}))}drawBorderOnRoot(){return!this.props.menuProps||!m.shouldShowOverflow(this.state)}}m.hideOverflowLagInMs=5,m.unhoverLagInMs=5,m.timerHighlightedInstance=void 0,m.contextType=f.O},77776:(e,t,o)=>{"use strict";o.d(t,{V:()=>i,m:()=>n});const i='-apple-system, BlinkMacSystemFont, Helvetica Neue, "Segoe UI", "Segoe UI Web", "Segoe UI Web (West European)", sans-serif',n='Bahnschrift, "Bahnschrift Web", "Segoe UI", "Helvetica Neue"'},59621:(e,t,o)=>{"use strict";o.d(t,{w:()=>Z});var i=o(95734),n=o(93743),r=o(9306),s=o(50344),a=o(93851),l=o(57964),c=o(58099),u=o(25161),d=o(60839),h=o(18861),g=o(55009),p=o(35203),f=o(34877);const m=i.forwardRef(((e,t)=>{const o=(0,g.P)(e,t);return(0,p.B)(o),(0,f.$e)("useButtonStyles_unstable")(o),(e=>{(0,h.C)(e);const{iconOnly:t,iconPosition:o}=e;return(0,d.FD)(e.root,{children:["after"!==o&&e.icon&&(0,d.Y)(e.icon,{}),!t&&e.root.children,"after"===o&&e.icon&&(0,d.Y)(e.icon,{})]})})(o)}));m.displayName="Button";var v=o(35818),b=o(87503),y=o(21257),w=o(36049),C=o(32726),S=o(36216),k=o(48701),T=o(38523),x=o(74978),_=o(27760),I=o(63649);const E=(0,_.X)({root:{mc9l5x:"f22iagw",Beiy3e4:"f1063pyq",Bnnss6s:"fi64zpg",Eh141a:"flvyvdh",qhf8xq:"f10pi13n"},horizontal:{Bt984gj:"f1q9h2pe",Beiy3e4:"f1063pyq"},vertical:{Bt984gj:"f1q9h2pe",Beiy3e4:"f1vx9l62"},roundedSmall:{i8kkvl:0,Belr9w4:0,rmohyg:"f1eyhf9v"},rounded:{i8kkvl:0,Belr9w4:0,rmohyg:"faqewft"}},{d:[".f22iagw{display:flex;}",".f1063pyq{flex-direction:row;}",".fi64zpg{flex-shrink:0;}",".flvyvdh{flex-wrap:nowrap;}",".f10pi13n{position:relative;}",".f1q9h2pe{align-items:stretch;}",".f1vx9l62{flex-direction:column;}",[".f1eyhf9v{gap:var(--spacingHorizontalSNudge);}",{p:-1}],[".faqewft{gap:var(--spacingHorizontalS);}",{p:-1}]]}),B=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{appearance:o="transparent",reserveSelectedTabSpace:n=!0,disabled:r=!1,onTabSelect:s,selectTabOnFocus:a=!1,size:l="medium",vertical:c=!1}=e,u=i.useRef(null),d=(0,y.i)({circular:!0,axis:c?"vertical":"horizontal",memorizeCurrent:!1,unstable_hasDefault:!0}),[h,g]=(0,w.i)({state:e.selectedValue,defaultState:e.defaultSelectedValue,initialState:void 0}),p=i.useRef(void 0),f=i.useRef(void 0);i.useEffect((()=>{f.current=p.current,p.current=h}),[h]);const m=(0,C.D)(((e,t)=>{g(t.value),null==s||s(e,t)})),v=i.useRef({}),b=(0,C.D)((e=>{const t=JSON.stringify(e.value);v.current[t]=e})),x=(0,C.D)((e=>{delete v.current[JSON.stringify(e.value)]})),_=i.useCallback((()=>({selectedValue:p.current,previousSelectedValue:f.current,registeredTabs:v.current})),[]);return{components:{root:"div"},root:S.Gk((0,k.g)("div",{ref:(0,T.a)(t,u),role:"tablist","aria-orientation":c?"vertical":"horizontal",...d,...e}),{elementType:"div"}),appearance:o,reserveSelectedTabSpace:n,disabled:r,selectTabOnFocus:a,selectedValue:h,size:l,vertical:c,onRegister:b,onUnregister:x,onSelect:m,getRegisteredTabs:_}})(e,t),n=function(e){const{appearance:t,reserveSelectedTabSpace:o,disabled:i,selectTabOnFocus:n,selectedValue:r,onRegister:s,onUnregister:a,onSelect:l,getRegisteredTabs:c,size:u,vertical:d}=e;return{tabList:{appearance:t,reserveSelectedTabSpace:o,disabled:i,selectTabOnFocus:n,selectedValue:r,onSelect:l,onRegister:s,onUnregister:a,getRegisteredTabs:c,size:u,vertical:d}}}(o);return(e=>{const{appearance:t,vertical:o,size:i}=e,n=E(),r="subtle-circular"===t||"filled-circular"===t;e.root.className=(0,I.z)("fui-TabList",n.root,o?n.vertical:n.horizontal,r&&("small"===i?n.roundedSmall:n.rounded),e.root.className)})(o),(0,f.$e)("useTabListStyles_unstable")(o),((e,t)=>((0,h.C)(e),(0,d.Y)(e.root,{children:(0,d.Y)(x.bd,{value:t.tabList,children:e.root.children})})))(o,n)}));B.displayName="TabList";var A=o(68957),R=o(29875),M=o(76182),D=o(520);const P=(0,_.X)({root:{Bt984gj:"f122n59",mc9l5x:"f13qh94s",Bnnss6s:"fi64zpg",Bxotwcr:"f1u07yai",Budl1dq:"frn2hmy",wkccdc:"f1olsevy",oeaueh:"f1s6fcnf",qhf8xq:"f10pi13n"},button:{Bt984gj:"f122n59",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f3bhgqh",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Bceei9c:"f1k6fduh",mc9l5x:"f13qh94s",Bnnss6s:"fi64zpg",Bxotwcr:"f1u07yai",Budl1dq:"frn2hmy",wkccdc:"f1olsevy",Bahqtrf:"fk6fouc",Bg96gwp:"f1i3iumi",oeaueh:"f1s6fcnf",qhf8xq:"f10pi13n",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",B9bfxx9:"f1cxpek8"},horizontal:{Brf1p80:"f4d9j23"},vertical:{Brf1p80:"f1s9ku6b"},smallHorizontal:{i8kkvl:"f14mj54c",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1wmopi4"},smallVertical:{i8kkvl:"f14mj54c",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f12or63q"},mediumHorizontal:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1w08f2p"},mediumVertical:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fymxs25"},largeHorizontal:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1ssfvub"},largeVertical:{i8kkvl:"f1rjii52",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fwkd1rq"},transparent:{De3pzq:"f1c21dwh",B95qlz1:"f9rvdkv",B7xitij:"f1051ucx",Bptxc3x:"fmmjozx",Bwqhzpy:"fqhzt5g",iyk698:"f7l5cgy",cl4aha:"fpkze5g",B0q3jbp:"f1iywnoi",Be9ayug:"f9n45c4"},subtle:{De3pzq:"fhovq9v",B95qlz1:"f1bifk9c",B7xitij:"fo6hitd",Bptxc3x:"fmmjozx",Bwqhzpy:"fqhzt5g",iyk698:"f7l5cgy",cl4aha:"fpkze5g",B0q3jbp:"f1iywnoi",Be9ayug:"f9n45c4"},disabledCursor:{Bceei9c:"fdrzuqr"},disabled:{De3pzq:"f1c21dwh",Bptxc3x:"fato7r6",cl4aha:"fao1bnu"},selected:{Bptxc3x:"f1cadz5z",Bwqhzpy:"fwhdxxj",iyk698:"fintccb",cl4aha:"ffplhdr",B0q3jbp:"fjo17wb",Be9ayug:"f148789c"}},{d:[".f122n59{align-items:center;}",".f13qh94s{display:grid;}",".fi64zpg{flex-shrink:0;}",".f1u07yai{grid-auto-flow:column;}",".frn2hmy{grid-template-columns:auto;}",".f1olsevy{grid-template-rows:auto;}",".f1s6fcnf{outline-style:none;}",".f10pi13n{position:relative;}",[".f3bhgqh{border:none;}",{p:-2}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1k6fduh{cursor:pointer;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f1cxpek8{text-transform:none;}",".f4d9j23{justify-content:center;}",".f1s9ku6b{justify-content:start;}",".f14mj54c{column-gap:var(--spacingHorizontalXXS);}",[".f1wmopi4{padding:var(--spacingVerticalSNudge) var(--spacingHorizontalSNudge);}",{p:-1}],[".f12or63q{padding:var(--spacingVerticalXXS) var(--spacingHorizontalSNudge);}",{p:-1}],".f1rjii52{column-gap:var(--spacingHorizontalSNudge);}",[".f1w08f2p{padding:var(--spacingVerticalM) var(--spacingHorizontalMNudge);}",{p:-1}],[".fymxs25{padding:var(--spacingVerticalSNudge) var(--spacingHorizontalMNudge);}",{p:-1}],[".f1ssfvub{padding:var(--spacingVerticalL) var(--spacingHorizontalMNudge);}",{p:-1}],[".fwkd1rq{padding:var(--spacingVerticalS) var(--spacingHorizontalMNudge);}",{p:-1}],".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f9rvdkv:enabled:hover{background-color:var(--colorTransparentBackgroundHover);}",".f1051ucx:enabled:active{background-color:var(--colorTransparentBackgroundPressed);}",".fmmjozx .fui-Tab__icon{color:var(--colorNeutralForeground2);}",".fqhzt5g:enabled:hover .fui-Tab__icon{color:var(--colorNeutralForeground2Hover);}",".f7l5cgy:enabled:active .fui-Tab__icon{color:var(--colorNeutralForeground2Pressed);}",".fpkze5g .fui-Tab__content{color:var(--colorNeutralForeground2);}",".f1iywnoi:enabled:hover .fui-Tab__content{color:var(--colorNeutralForeground2Hover);}",".f9n45c4:enabled:active .fui-Tab__content{color:var(--colorNeutralForeground2Pressed);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".f1bifk9c:enabled:hover{background-color:var(--colorSubtleBackgroundHover);}",".fo6hitd:enabled:active{background-color:var(--colorSubtleBackgroundPressed);}",".fdrzuqr{cursor:not-allowed;}",".fato7r6 .fui-Tab__icon{color:var(--colorNeutralForegroundDisabled);}",".fao1bnu .fui-Tab__content{color:var(--colorNeutralForegroundDisabled);}",".f1cadz5z .fui-Tab__icon{color:var(--colorCompoundBrandForeground1);}",".fwhdxxj:enabled:hover .fui-Tab__icon{color:var(--colorCompoundBrandForeground1Hover);}",".fintccb:enabled:active .fui-Tab__icon{color:var(--colorCompoundBrandForeground1Pressed);}",".ffplhdr .fui-Tab__content{color:var(--colorNeutralForeground1);}",".fjo17wb:enabled:hover .fui-Tab__content{color:var(--colorNeutralForeground1Hover);}",".f148789c:enabled:active .fui-Tab__content{color:var(--colorNeutralForeground1Pressed);}"]}),F=(0,_.X)({base:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9",Bptxc3x:"ftorr8m",cl4aha:"f16lqpmv"},medium:{Dbcxam:0,rjzwhg:0,Bblux5w:"f1lj1ynd"},subtle:{De3pzq:"fhovq9v",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fqeaewv",sj55zd:"fkfq4zb",B95qlz1:"f1bifk9c",Eo63ln:0,r9osk6:0,Itrz8y:0,zeg6vx:0,l65xgk:0,Bw4olcx:0,Folb0i:0,I2h8y4:0,Bgxgoyi:0,Bvlkotb:0,Fwyncl:0,Byh5edv:0,Becqvjq:0,uumbiq:0,B73q3dg:0,Bblwbaf:0,B0ezav:"ft57sj0",r4wkhp:"f1fcoy83",B7xitij:"fo6hitd",d3wsvi:0,Hdqn7s:0,zu5y1p:0,owqphb:0,g9c53k:0,Btmu08z:0,Bthxvy6:0,gluvuq:0,tb88gp:0,wns6jk:0,kdfdk4:0,Bbw008l:0,Bayi1ib:0,B1kkfu3:0,J1oqyp:0,kem6az:0,goa3yj:"fhn220o",p743kt:"f15qf7sh"},subtleSelected:{De3pzq:"f16xkysk",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"f1c2pc3t",sj55zd:"faj9fo0",B95qlz1:"fsm7zmf",Eo63ln:0,r9osk6:0,Itrz8y:0,zeg6vx:0,l65xgk:0,Bw4olcx:0,Folb0i:0,I2h8y4:0,Bgxgoyi:0,Bvlkotb:0,Fwyncl:0,Byh5edv:0,Becqvjq:0,uumbiq:0,B73q3dg:0,Bblwbaf:0,B0ezav:"f1wo0sfq",r4wkhp:"f1afuynh",B7xitij:"f94ddyl",d3wsvi:0,Hdqn7s:0,zu5y1p:0,owqphb:0,g9c53k:0,Btmu08z:0,Bthxvy6:0,gluvuq:0,tb88gp:0,wns6jk:0,kdfdk4:0,Bbw008l:0,Bayi1ib:0,B1kkfu3:0,J1oqyp:0,kem6az:0,goa3yj:"fmle6oo",p743kt:"f1d3itm4"},subtleDisabled:{De3pzq:"fhovq9v",sj55zd:"f1s2aq7o",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fqeaewv"},subtleDisabledSelected:{De3pzq:"f1bg9a2p",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fegtqic",sj55zd:"f1s2aq7o"},filled:{De3pzq:"f16xq7d1",sj55zd:"fkfq4zb",B95qlz1:"fwwxidx",r4wkhp:"f1fcoy83",B7xitij:"f14i52sd",p743kt:"f15qf7sh",Bw5j0gk:"f159yq2d",Baikq8m:"ful0ncq",B2ndh17:"f2rulcp",w0x64w:"f19p5z4e",Bdzpij4:"fo1bcu3"},filledSelected:{De3pzq:"ffp7eso",sj55zd:"f1phragk",B95qlz1:"f1lm9dni",r4wkhp:"f1mn5ei1",B7xitij:"f1g6ncd0",p743kt:"fl71aob",bml8oc:"f13s88zn",qew46a:"f16zjd40",B84x17g:"f1mr3uue",Jetwu1:"f196ywdt"},filledDisabled:{De3pzq:"f1bg9a2p",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fqeaewv",sj55zd:"f1s2aq7o"},filledDisabledSelected:{De3pzq:"f1bg9a2p",Bgfg5da:0,B9xav0g:0,oivjwe:0,Bn0qgzm:0,B4g9neb:0,zhjwy3:0,wvpqe5:0,ibv6hh:0,u1mtju:0,h3c5rm:0,vrafjx:0,Bekrc4i:0,i8vvqc:0,g2u3we:0,icvyot:0,B4j52fo:0,irswps:"fegtqic",sj55zd:"f1s2aq7o"}},{d:[[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],".ftorr8m .fui-Tab__icon{color:inherit;}",".f16lqpmv .fui-Tab__content{color:inherit;}",[".f1lj1ynd{padding-block:var(--spacingVerticalSNudge);}",{p:-1}],".fhovq9v{background-color:var(--colorSubtleBackground);}",[".fqeaewv{border:solid var(--strokeWidthThin) transparent;}",{p:-2}],".fkfq4zb{color:var(--colorNeutralForeground2);}",".f1bifk9c:enabled:hover{background-color:var(--colorSubtleBackgroundHover);}",[".ft57sj0:enabled:hover{border:solid var(--strokeWidthThin) var(--colorNeutralStroke1Hover);}",{p:-2}],".f1fcoy83:enabled:hover{color:var(--colorNeutralForeground2Hover);}",".fo6hitd:enabled:active{background-color:var(--colorSubtleBackgroundPressed);}",[".fhn220o:enabled:active{border:solid var(--strokeWidthThin) var(--colorNeutralStroke1Pressed);}",{p:-2}],".f15qf7sh:enabled:active{color:var(--colorNeutralForeground2Pressed);}",".f16xkysk{background-color:var(--colorBrandBackground2);}",[".f1c2pc3t{border:solid var(--strokeWidthThin) var(--colorCompoundBrandStroke);}",{p:-2}],".faj9fo0{color:var(--colorBrandForeground2);}",".fsm7zmf:enabled:hover{background-color:var(--colorBrandBackground2Hover);}",[".f1wo0sfq:enabled:hover{border:solid var(--strokeWidthThin) var(--colorCompoundBrandStrokeHover);}",{p:-2}],".f1afuynh:enabled:hover{color:var(--colorBrandForeground2Hover);}",".f94ddyl:enabled:active{background-color:var(--colorBrandBackground2Pressed);}",[".fmle6oo:enabled:active{border:solid var(--strokeWidthThin) var(--colorCompoundBrandStrokePressed);}",{p:-2}],".f1d3itm4:enabled:active{color:var(--colorBrandForeground2Pressed);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",[".fqeaewv{border:solid var(--strokeWidthThin) transparent;}",{p:-2}],".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",[".fegtqic{border:solid var(--strokeWidthThin) var(--colorNeutralStrokeDisabled);}",{p:-2}],".f16xq7d1{background-color:var(--colorNeutralBackground3);}",".fwwxidx:enabled:hover{background-color:var(--colorNeutralBackground3Hover);}",".f14i52sd:enabled:active{background-color:var(--colorNeutralBackground3Pressed);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".f1lm9dni:enabled:hover{background-color:var(--colorBrandBackgroundHover);}",".f1mn5ei1:enabled:hover{color:var(--colorNeutralForegroundOnBrand);}",".f1g6ncd0:enabled:active{background-color:var(--colorBrandBackgroundPressed);}",".fl71aob:enabled:active{color:var(--colorNeutralForegroundOnBrand);}",[".fqeaewv{border:solid var(--strokeWidthThin) transparent;}",{p:-2}],[".fegtqic{border:solid var(--strokeWidthThin) var(--colorNeutralStrokeDisabled);}",{p:-2}]],m:[["@media (forced-colors: active){.f159yq2d:enabled:hover{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ful0ncq:enabled:hover{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f2rulcp:enabled:hover .fui-Tab__content{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f19p5z4e:enabled:hover .fui-Icon-filled{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fo1bcu3:enabled:hover .fui-Icon-regular{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f13s88zn:enabled{background-color:ButtonText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f16zjd40:enabled .fui-Tab__content{color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1mr3uue:enabled .fui-Tab__content{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f196ywdt:enabled .fui-Tab__icon{color:ButtonFace;}}",{m:"(forced-colors: active)"}]]}),O=(0,_.X)({base:{B8q5s1w:"f8hki3x",Bci5o5g:["f1d2448m","ffh67wi"],n8qw10:"f1bjia2o",Bdrgwmp:["ffh67wi","f1d2448m"],Bn4voq9:"f1p7hgxw",Bfpq7zp:"f1way5bb",g9k6zt:"f9znhxp",j6ew2k:["fqa318h","fqa318h"],Bhxq17a:"f1vjpng2"},circular:{B8q5s1w:"f8hki3x",Bci5o5g:["f1d2448m","ffh67wi"],n8qw10:"f1bjia2o",Bdrgwmp:["ffh67wi","f1d2448m"],Bn4voq9:"f1p7hgxw",Bfpq7zp:"f1way5bb",g9k6zt:"f9znhxp",j6ew2k:["fzgyhws","fqxug60"],Bhxq17a:"f1vjpng2"}},{d:[".f8hki3x[data-fui-focus-visible]{border-top-color:transparent;}",".f1d2448m[data-fui-focus-visible]{border-right-color:transparent;}",".ffh67wi[data-fui-focus-visible]{border-left-color:transparent;}",".f1bjia2o[data-fui-focus-visible]{border-bottom-color:transparent;}",".f1p7hgxw[data-fui-focus-visible]{outline-width:var(--strokeWidthThick);}",".f1way5bb[data-fui-focus-visible]{outline-color:transparent;}",".f9znhxp[data-fui-focus-visible]{outline-style:solid;}",".fqa318h[data-fui-focus-visible]{box-shadow:var(--shadow4),0 0 0 var(--strokeWidthThick) var(--colorStrokeFocus2);}",".f1vjpng2[data-fui-focus-visible]{z-index:1;}",".fzgyhws[data-fui-focus-visible]{box-shadow:var(--shadow4),0 0 0 var(--strokeWidthThick) var(--colorStrokeFocus2),0 0 0 var(--strokeWidthThin) var(--colorNeutralStrokeOnBrand) inset;}",".fqxug60[data-fui-focus-visible]{box-shadow:var(--shadow4),0 0 0 var(--strokeWidthThick) var(--colorStrokeFocus2),0 0 0 var(--strokeWidthThin) var(--colorNeutralStrokeOnBrand) inset;}"]}),N=(0,_.X)({base:{az7l2e:"fhw179n",vqofr:0,Bv4n3vi:0,Bgqb9hq:0,B0uxbk8:0,Bf3jju6:"fg9j5n4",amg5m6:"f1kmhr4c",zkfqfm:"fl1ydde",Bkydozb:"f1y7maxz",Bka2azo:0,vzq8l0:0,csmgbd:0,Br4ovkg:0,aelrif:"fceyvr4",y36c18:"f16cxu0",B1ctymy:"f1nwgacf",Bgvrrv0:"f15ovonk",ddr6p5:"fvje46l"},disabled:{az7l2e:"f1ut20fw",Bkydozb:"fhrzcfn",Bgvrrv0:"f1v15rkt",ddr6p5:"f3nwrnk"},smallHorizontal:{lawp4y:"fchca7p",Baz25je:"f1r53b5e",Fbdkly:["f1s6rxz5","fo35v8s"],mdwyqc:["fo35v8s","f1s6rxz5"]},smallVertical:{lawp4y:"fze4zud",Fbdkly:["f1fzr1x6","f1f351id"],Bciustq:"fdp32p8",Ccq8qp:"f1aij3q"},mediumHorizontal:{lawp4y:"fchca7p",Baz25je:"f1s2r9ax",Fbdkly:["f1o0nnkk","fxb7rol"],mdwyqc:["fxb7rol","f1o0nnkk"]},mediumVertical:{lawp4y:"f17jracn",Fbdkly:["f1fzr1x6","f1f351id"],Bciustq:"f117lcb2",Ccq8qp:"f1aij3q"},largeHorizontal:{lawp4y:"fchca7p",Baz25je:"f1s2r9ax",Fbdkly:["f1o0nnkk","fxb7rol"],mdwyqc:["fxb7rol","f1o0nnkk"]},largeVertical:{lawp4y:"fel9d3z",Fbdkly:["f1fzr1x6","f1f351id"],Bciustq:"f6vqlre",Ccq8qp:"f1aij3q"}},{h:[".fhw179n:hover::before{background-color:var(--colorNeutralStroke1Hover);}",[".fg9j5n4:hover::before{border-radius:var(--borderRadiusCircular);}",{p:-1}],'.f1kmhr4c:hover::before{content:"";}',".fl1ydde:hover::before{position:absolute;}",".f1ut20fw:hover::before{background-color:var(--colorTransparentStroke);}"],a:[".f1y7maxz:active::before{background-color:var(--colorNeutralStroke1Pressed);}",[".fceyvr4:active::before{border-radius:var(--borderRadiusCircular);}",{p:-1}],'.f16cxu0:active::before{content:"";}',".f1nwgacf:active::before{position:absolute;}",".fhrzcfn:active::before{background-color:var(--colorTransparentStroke);}"],m:[["@media (forced-colors: active){.f15ovonk:hover::before{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fvje46l:active::before{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1v15rkt:hover::before{background-color:transparent;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3nwrnk:active::before{background-color:transparent;}}",{m:"(forced-colors: active)"}]],d:[".fchca7p::before{bottom:0;}",".f1r53b5e::before{height:var(--strokeWidthThick);}",".f1s6rxz5::before{left:var(--spacingHorizontalSNudge);}",".fo35v8s::before{right:var(--spacingHorizontalSNudge);}",".fze4zud::before{bottom:var(--spacingVerticalXS);}",".f1fzr1x6::before{left:0;}",".f1f351id::before{right:0;}",".fdp32p8::before{top:var(--spacingVerticalXS);}",".f1aij3q::before{width:var(--strokeWidthThicker);}",".f1s2r9ax::before{height:var(--strokeWidthThicker);}",".f1o0nnkk::before{left:var(--spacingHorizontalM);}",".fxb7rol::before{right:var(--spacingHorizontalM);}",".f17jracn::before{bottom:var(--spacingVerticalS);}",".f117lcb2::before{top:var(--spacingVerticalS);}",".fel9d3z::before{bottom:var(--spacingVerticalMNudge);}",".f6vqlre::before{top:var(--spacingVerticalMNudge);}"]}),q=(0,_.X)({base:{Bjyk6c5:"f1rp0jgh",d9w3h3:0,B3778ie:0,B4j8arr:0,Bl18szs:0,Blrzh8d:"f3b9emi",Bsft5z2:"f13zj6fq",E3zdtr:"f1mdlcz9"},selected:{Bjyk6c5:"f1ksivud",Bej4dhw:"f1476jrx",B7wqxwa:"f18q216b",f7digc:"fy7ktjt",Bvuzv5k:"f1033yux",k4sdgo:"fkh9b8o"},disabled:{Bjyk6c5:"f13lkzet"},smallHorizontal:{By385i5:"fo72kxq",Dlnsje:"f9bb2ob",Eqx8gd:["f1q70ajw","f18rbzdx"],B1piin3:["f18rbzdx","f1q70ajw"]},smallVertical:{By385i5:"fqbue9b",Eqx8gd:["f1n6gb5g","f15yvnhg"],bn5sak:"fk1klkt",a2br6o:"f1o25lip"},mediumHorizontal:{By385i5:"fo72kxq",Dlnsje:"f1vx7lu8",Eqx8gd:["fna7m5n","f1oxpfwv"],B1piin3:["f1oxpfwv","fna7m5n"]},mediumVertical:{By385i5:"fipylg0",Eqx8gd:["f1n6gb5g","f15yvnhg"],bn5sak:"fqchiol",a2br6o:"f1o25lip"},largeHorizontal:{By385i5:"fo72kxq",Dlnsje:"f1vx7lu8",Eqx8gd:["fna7m5n","f1oxpfwv"],B1piin3:["f1oxpfwv","fna7m5n"]},largeVertical:{By385i5:"f1w7dm5g",Eqx8gd:["f1n6gb5g","f15yvnhg"],bn5sak:"f1p6em4m",a2br6o:"f1o25lip"}},{d:[".f1rp0jgh::after{background-color:var(--colorTransparentStroke);}",[".f3b9emi::after{border-radius:var(--borderRadiusCircular);}",{p:-1}],'.f13zj6fq::after{content:"";}',".f1mdlcz9::after{position:absolute;}",".f1ksivud::after{background-color:var(--colorCompoundBrandStroke);}",".f1476jrx:enabled:hover::after{background-color:var(--colorCompoundBrandStrokeHover);}",".f18q216b:enabled:active::after{background-color:var(--colorCompoundBrandStrokePressed);}",".f13lkzet::after{background-color:var(--colorNeutralForegroundDisabled);}",".fo72kxq::after{bottom:0;}",".f9bb2ob::after{height:var(--strokeWidthThick);}",".f1q70ajw::after{left:var(--spacingHorizontalSNudge);}",".f18rbzdx::after{right:var(--spacingHorizontalSNudge);}",".fqbue9b::after{bottom:var(--spacingVerticalXS);}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",".fk1klkt::after{top:var(--spacingVerticalXS);}",".f1o25lip::after{width:var(--strokeWidthThicker);}",".f1vx7lu8::after{height:var(--strokeWidthThicker);}",".fna7m5n::after{left:var(--spacingHorizontalM);}",".f1oxpfwv::after{right:var(--spacingHorizontalM);}",".fipylg0::after{bottom:var(--spacingVerticalS);}",".fqchiol::after{top:var(--spacingVerticalS);}",".f1w7dm5g::after{bottom:var(--spacingVerticalMNudge);}",".f1p6em4m::after{top:var(--spacingVerticalMNudge);}"],m:[["@media (forced-colors: active){.fy7ktjt::after{background-color:ButtonText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1033yux:enabled:hover::after{background-color:ButtonText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkh9b8o:enabled:active::after{background-color:ButtonText;}}",{m:"(forced-colors: active)"}]]}),j=(0,_.X)({base:{Br312pm:"fwpfdsa",Ijaq50:"f16hsg94",Bt984gj:"f122n59",mc9l5x:"ftuwxu6",Brf1p80:"f4d9j23",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",D0sxk3:"f16u1re",t6yez3:"f8bsbmo"},small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3"},medium:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3"},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun"},selected:{D0sxk3:"fxoiby5",t6yez3:"f15q0o9g"}},{d:[".fwpfdsa{grid-column-start:1;}",".f16hsg94{grid-row-start:1;}",".f122n59{align-items:center;}",".ftuwxu6{display:inline-flex;}",".f4d9j23{justify-content:center;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f16u1re .fui-Icon-filled{display:none;}",".f8bsbmo .fui-Icon-regular{display:inline;}",".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".fxoiby5 .fui-Icon-filled{display:inline;}",".f15q0o9g .fui-Icon-regular{display:none;}"]}),L=(0,_.X)({base:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1bwptpd"},selected:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"fl43uef",Bg96gwp:"f1i3iumi"},large:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k"},largeSelected:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},noIconBefore:{Br312pm:"fwpfdsa",Ijaq50:"f16hsg94"},iconBefore:{Br312pm:"fd46tj4",Ijaq50:"f16hsg94"},placeholder:{Bcdw1i0:"fd7fpy0"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],[".f1bwptpd{padding:var(--spacingVerticalNone) var(--spacingHorizontalXXS);}",{p:-1}],".fl43uef{font-weight:var(--fontWeightSemibold);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fwpfdsa{grid-column-start:1;}",".f16hsg94{grid-row-start:1;}",".fd46tj4{grid-column-start:2;}",".fd7fpy0{visibility:hidden;}"]}),z=i.forwardRef(((e,t)=>{const o=((e,t)=>{const{content:o,disabled:n=!1,icon:r,onClick:s,onFocus:a,value:l}=e,c=(0,x.H)((e=>e.appearance)),u=(0,x.H)((e=>e.reserveSelectedTabSpace)),d=(0,x.H)((e=>e.selectTabOnFocus)),h=(0,x.H)((e=>e.disabled)),g=(0,x.H)((e=>e.selectedValue===l)),p=(0,x.H)((e=>e.onRegister)),f=(0,x.H)((e=>e.onUnregister)),m=(0,x.H)((e=>e.onSelect)),v=(0,x.H)((e=>e.size)),b=(0,x.H)((e=>!!e.vertical)),y=h||n,w=i.useRef(null),_=e=>m(e,{value:l}),I=(0,C.D)((0,R.p)(s,_)),E=(0,C.D)((0,R.p)(a,_)),B=(0,A.g)({focusable:{isDefault:g}});i.useEffect((()=>(p({value:l,ref:w}),()=>{f({value:l,ref:w})})),[p,f,w,l]);const D=S.lq(r,{elementType:"span"}),P=S.Gk(o,{defaultProps:{children:e.children},elementType:"span"}),F=o&&"object"==typeof o?(0,M.c)(o,["ref"]):o,O=Boolean((null==D?void 0:D.children)&&!P.children);return{components:{root:"button",icon:"span",content:"span",contentReservedSpace:"span"},root:S.Gk((0,k.g)("button",{ref:(0,T.a)(t,w),role:"tab",type:"button","aria-selected":y?void 0:`${g}`,...B,...e,disabled:y,onClick:I,onFocus:d?E:a}),{elementType:"button"}),icon:D,iconOnly:O,content:P,contentReservedSpace:S.lq(F,{renderByDefault:!g&&!O&&u,defaultProps:{children:e.children},elementType:"span"}),appearance:c,disabled:y,selected:g,size:v,value:l,vertical:b}})(e,t);return(e=>{(e=>{const t=P(),o=N(),i=q(),{appearance:n,disabled:r,selected:s,size:a,vertical:l}=e,c=["fui-Tab",t.root];"subtle-circular"!==n&&"filled-circular"!==n&&c.push(o.base,"small"===a&&(l?o.smallVertical:o.smallHorizontal),"medium"===a&&(l?o.mediumVertical:o.mediumHorizontal),"large"===a&&(l?o.largeVertical:o.largeHorizontal),r&&o.disabled,s&&i.base,s&&!r&&i.selected,s&&"small"===a&&(l?i.smallVertical:i.smallHorizontal),s&&"medium"===a&&(l?i.mediumVertical:i.mediumHorizontal),s&&"large"===a&&(l?i.largeVertical:i.largeHorizontal),s&&r&&i.disabled),e.root.className=(0,I.z)(...c,e.root.className),(0,D.U)(e)})(e),((e,t)=>{const o=P(),i=O(),n=F(),{appearance:r,disabled:s,selected:a,size:l,vertical:c}=e,u="subtle-circular"===r,d="filled-circular"===r,h=u||d,g=[n.base,i.circular,"medium"===l&&n.medium,u&&n.subtle,a&&u&&n.subtleSelected,s&&u&&n.subtleDisabled,a&&s&&u&&n.subtleDisabledSelected,d&&n.filled,a&&d&&n.filledSelected,s&&d&&n.filledDisabled,a&&s&&d&&n.filledDisabledSelected],p=[i.base,!s&&"subtle"===r&&o.subtle,!s&&"transparent"===r&&o.transparent,!s&&a&&o.selected,s&&o.disabled];t.className=(0,I.z)(o.button,c?o.vertical:o.horizontal,"small"===l&&(c?o.smallVertical:o.smallHorizontal),"medium"===l&&(c?o.mediumVertical:o.mediumHorizontal),"large"===l&&(c?o.largeVertical:o.largeHorizontal),...h?g:p,s&&o.disabledCursor,t.className)})(e,e.root),(e=>{const t=j(),o=L(),{selected:i,size:n}=e;e.icon&&(e.icon.className=(0,I.z)("fui-Tab__icon",t.base,t[n],i&&t.selected,e.icon.className)),e.contentReservedSpace&&(e.contentReservedSpace.className=(0,I.z)("fui-Tab__content--reserved-space",o.base,"large"===n?o.largeSelected:o.selected,e.icon?o.iconBefore:o.noIconBefore,o.placeholder,e.content.className),e.contentReservedSpaceClassName=e.contentReservedSpace.className),e.content.className=(0,I.z)("fui-Tab__content",o.base,"large"===n&&o.large,i&&("large"===n?o.largeSelected:o.selected),e.icon?o.iconBefore:o.noIconBefore,e.content.className)})(e)})(o),(0,f.$e)("useTabStyles_unstable")(o),(e=>((0,h.C)(e),(0,d.FD)(e.root,{children:[e.icon&&(0,d.Y)(e.icon,{}),!e.iconOnly&&(0,d.Y)(e.content,{}),e.contentReservedSpace&&(0,d.Y)(e.contentReservedSpace,{})]})))(o)}));z.displayName="Tab";var H=o(74396),W=o(77442);const U=i.forwardRef(((e,t)=>{const{id:o,groupId:r,priority:s,children:l}=e,c=function(e,t,o){const r=i.useRef(null),s=(0,n.J)((e=>e.registerItem));return(0,a.E)((()=>{if(r.current)return s({element:r.current,id:e,priority:null!=t?t:0,groupId:o})}),[e,t,s,o]),r}(o,s,r),u=(0,H.h)(l);return(0,W.L)(l,{ref:(0,T.a)(c,t,null==u?void 0:u.ref)})}));U.isFluentTriggerComponent=!0;var G=o(53660),V=o(43050);const $=i.forwardRef(((e,t)=>{const o=(0,V.I)(),{children:r,minimumVisible:s,overflowAxis:a="horizontal",overflowDirection:l,padding:c,onOverflowChange:u}=e,[d,h]=i.useState({hasOverflow:!1,itemVisibility:{},groupVisibility:{}}),{containerRef:g,registerItem:p,updateOverflow:f,registerOverflowMenu:m,registerDivider:v}=(0,G.f)((e=>{const{visibleItems:t,invisibleItems:o,groupVisibility:i}=e,n={};t.forEach((e=>{n[e.id]=!0})),o.forEach((e=>n[e.id]=!1));const r={hasOverflow:e.invisibleItems.length>0,itemVisibility:n,groupVisibility:i};null==u||u(null,{...r}),h(r)}),{overflowDirection:l,overflowAxis:a,padding:c,minimumVisible:s,onUpdateItemVisibility:G.K}),b=(0,H.h)(r),y=(0,W.L)(r,{ref:(0,T.a)(g,t,null==b?void 0:b.ref),className:(0,I.z)("fui-Overflow",o.overflowMenu,o.overflowingItems,r.props.className)});return i.createElement(n.a.Provider,{value:{itemVisibility:d.itemVisibility,groupVisibility:d.groupVisibility,hasOverflow:d.hasOverflow,registerItem:p,updateOverflow:f,registerOverflowMenu:m,registerDivider:v}},y)}));var K=o(97782);(0,o(54167).hN)([{rawString:"button.tab_3e91ac2a{padding:6px;height:32px;font-weight:var(--fontWeightRegular);background-color:var(--tabBgRestingColor);border-color:var(--tabBorderRestingColor);color:var(--tabTextRestingColor);margin-right:var(--spacingHorizontalS);-ms-flex-negative:0;flex-shrink:0}button.tab_3e91ac2a:enabled:hover:not(.selected_3e91ac2a){background-color:var(--tabBgHoverColor);border-color:var(--tabBorderHoverColor);color:var(--tabTextHoverColor)}button.tab_3e91ac2a:enabled:active,button.tab_3e91ac2a:enabled:hover:active{background-color:var(--tabBgPressedColor);border-color:var(--tabBorderPressedColor);color:var(--tabTextPressedColor)}button.tab_3e91ac2a:enabled:focus:not(.selected_3e91ac2a){background-color:var(--tabBgFocusedColor);border-color:var(--tabBorderFocusedColor);color:var(--tabTextFocusedColor)}button.tab_3e91ac2a:enabled:focus:is(.selected){background-color:var(--tabBgFocusedColor);border-color:var(--tabBorderFocusedColor);color:var(--tabTextFocusedColor)}button.tab_3e91ac2a.selected_3e91ac2a{background-color:var(--tabBgSelectedColor);border-color:var(--tabBorderSelectedColor);color:var(--tabTextSelectedColor)}button.tab_3e91ac2a:enabled.selected_3e91ac2a:hover:active{background-color:var(--tabBgSelectedPressedColor);border-color:var(--tabBorderSelectedPressedColor);color:var(--tabTextSelectedPressedColor)}button.tab_3e91ac2a:enabled.selected_3e91ac2a:focus{background-color:var(--tabBgSelectedFocusedColor);border-color:var(--tabBorderSelectedFocusedColor);color:var(--tabTextSelectedFocusedColor)}button.tab_3e91ac2a:enabled:hover.selected_3e91ac2a{background-color:var(--tabBgSelectedHoverColor);border-color:var(--tabBorderSelectedHoverColor);color:var(--tabTextSelectedHoverColor)}button.overflowMenu_3e91ac2a{background-color:var(--defaultMenuButtonsRestingBgColor);border-color:var(--defaultMenuButtonsRestingBorderColor);color:var(--defaultMenuButtonsRestingTextColor);font-weight:var(--fontWeightRegular);margin-right:var(--spacingHorizontalM) !important;padding-left:var(--spacingHorizontalM) !important;padding-right:var(--spacingHorizontalM) !important;min-width:73px;-ms-flex-negative:0;flex-shrink:0}button.overflowMenu_3e91ac2a [data-fui-focus-visible]{border-width:var(--strokeWidthThick);outline-width:var(--strokeWidthThick)}button.overflowMenu_3e91ac2a:enabled:hover:not(.selected_3e91ac2a){background-color:var(--defaultMenuButtonsHoverBgColor);border-color:var(--defaultMenuButtonsHoverBorderColor);color:var(--defaultMenuButtonsHoverTextColor)}button.overflowMenu_3e91ac2a:enabled:active,button.overflowMenu_3e91ac2a:enabled:hover:active{background-color:var(--defaultMenuButtonsPressedBgColor);border-color:var(--defaultMenuButtonsPressedBorderColor);color:var(--defaultMenuButtonsPressedTextColor)}button.overflowMenu_3e91ac2a:enabled:focus:not(.selected_3e91ac2a){background-color:var(--defaultMenuButtonsFocusedBgColor);border-color:var(--defaultMenuButtonsFocusedBorderColor);color:var(--defaultMenuButtonsFocusedTextColor)}button.overflowMenu_3e91ac2a:enabled:hover.selected_3e91ac2a{background-color:var(--defaultMenuButtonsSelectedHoverBgColor);border-color:var(--defaultMenuButtonsSelectedHoverBorderColor);color:var(--defaultMenuButtonsSelectedHoverTextColor)}button.overflowMenu_3e91ac2a:enabled.selected_3e91ac2a:hover:active{background-color:var(--defaultMenuButtonsSelectedPressedBgColor);border-color:var(--defaultMenuButtonsSelectedPressedBorderColor);color:var(--defaultMenuButtonsSelectedPressedTextColor)}button.overflowMenu_3e91ac2a:enabled.selected_3e91ac2a:focus{background-color:var(--defaultMenuButtonsSelectedFocusedBgColor);border-color:var(--defaultMenuButtonsSelectedFocusedBorderColor);color:var(--defaultMenuButtonsSelectedFocusedTextColor)}button.overflowMenu_3e91ac2a[aria-expanded=true]{background-color:var(--defaultMenuButtonsSelectedBgColor);border-color:var(--defaultMenuButtonsSelectedBorderColor);color:var(--defaultMenuButtonsSelectedTextColor)}div.tabContainer_3e91ac2a{padding-right:var(--spacingHorizontalS)}"}]);var J=o(16971);const Y=e=>{const{onItemClick:t,onItemFocus:o,disabled:s,label:a,tabKey:l,theme:c}=e,u=(d=l,!!(0,n.J)((e=>e.itemVisibility[d])));var d;const h=i.useCallback((()=>{null==t||t(l)}),[t,l]);return u?null:i.createElement(r.D,{onFocus:e=>{null==o||o(l),c&&(e.currentTarget.style.backgroundColor=c.overflowItem.hover)},onBlur:e=>{c&&(e.currentTarget.style.backgroundColor=c.overflowItem.resting)},onClick:h,disabled:s},a)},Q=({size:e,items:t,onTabSelect:o,theme:r,cssProperties:d,moreButtonQuantityText:h,onOverflowOpenChange:g,onOverflowTriggerFocus:p,onMenuItemFocus:f})=>{const{ref:y,isOverflowing:w}=function(e){const t=(0,s.Bi)("overflow-menu",void 0),o=(0,l.D)(),r=(0,n.J)((e=>e.registerOverflowMenu)),c=(0,n.J)((e=>e.updateOverflow)),u=i.useRef(null),d=o>0;return(0,a.E)((()=>{if(u.current)return r(u.current)}),[r,d,t]),(0,a.E)((()=>{d&&c()}),[d,c,u]),{ref:u,overflowCount:o,isOverflowing:d}}(),C=i.useContext(J.b),[S,k]=i.useState(0),T=(0,l.D)(),x=i.useCallback(((e,t)=>{null==g||g(t.open)}),[]);return i.useEffect((()=>{k(T)}),[T]),w?i.createElement(c.W,{onOpenChange:x},i.createElement(u.c,null,C?i.createElement(m,{appearance:"transparent",shape:"circular",ref:y,className:"overflowMenu_3e91ac2a",role:"button",onFocus:p,style:Object.assign({},d)},i.createElement("div",{style:{display:"flex",justifyContent:"center"}},null==h?void 0:h.replace("{0}",S.toString()),i.createElement(K.I,{type:"DropdownChevron"}))):i.createElement(m,{appearance:"transparent",icon:i.createElement(K.I,{type:"Overflow"}),ref:y,onFocus:p,role:"tab",size:e})),i.createElement(v.b,null,i.createElement(b.c,null,t.map((e=>i.createElement(Y,Object.assign({theme:r,key:e.tabKey,onItemClick:o,onItemFocus:f},e))))))):null},Z=i.forwardRef(((e,t)=>{const{items:o,overflow:n=!0,onTabSelect:r,defaultSelectedKey:s,selectedKey:a,cssProperties:l,moreButtonQuantityText:c,onMenuItemFocus:u,onOverflowOpenChange:d,onOverflowTriggerFocus:h}=e,g=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["items","overflow","onTabSelect","defaultSelectedKey","selectedKey","cssProperties","moreButtonQuantityText","onMenuItemFocus","onOverflowOpenChange","onOverflowTriggerFocus"]),p=i.useContext(J.b),[f,m]=i.useState(null!=s?s:o[0].tabKey),v=null!=a?a:f,b=i.useCallback((e=>{null==r||r(e),a||m(e)}),[r,m]),y=i.useCallback(((e,t)=>{"string"==typeof t.value&&b(t.value)}),[b]),w=i.useCallback((e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),e.currentTarget.click())}),[]),C=i.useMemo((()=>{const e={};return o.forEach((t=>{e[t.tabKey]=i.createRef()})),e}),[o]);i.useImperativeHandle(t,(()=>({focus:()=>{var e,t;null===(t=null===(e=C[v])||void 0===e?void 0:e.current)||void 0===t||t.focus()}})));const S=i.useMemo((()=>{var e;return{appearance:p?"subtle-circular":"transparent",disabled:g.disabled,key:g.key,onTabSelect:y,size:null!==(e=g.size)&&void 0!==e?e:"medium",selectedValue:v,defaultSelectedValue:s,style:{flexShrink:"unset",gap:0}}}),[g,y]),k={items:o,size:S.size,onTabSelect:b,onMenuItemFocus:u,onOverflowOpenChange:d,onOverflowTriggerFocus:h,cssProperties:l,useUiCoherence:p,moreButtonQuantityText:c};let T=i.createElement(B,Object.assign({},S),o.map((e=>{const{tabKey:t,label:o,disabled:r,overflowPriority:s=0}=e,a="tab_3e91ac2a"+(v===t?" selected_3e91ac2a":"");let c=i.createElement(z,{value:t,disabled:r,key:t,ref:C[t],onKeyDown:w,onFocus:()=>null==u?void 0:u(t),className:p?a:"",style:l},o);return n&&(c=i.createElement(U,{priority:s,key:t,id:t,ref:C[t]},c)),c})),n&&i.createElement(Q,Object.assign({},k)));return n&&(T=i.createElement($,{minimumVisible:1,padding:0},T)),T}));Z.displayName="TabList"},40732:(e,t,o)=>{"use strict";if(o.d(t,{S:()=>s,v:()=>r}),3023==o.j)var i=o(77776);if(3023==o.j)var n=o(86399);var r;function s(e,t,o){const i=o?o.filter((e=>!!e)).sort(((e,t)=>e.start-t.start)):[],n=[];for(let o=0;o<i.length;o+=1){if(e<i[o].start+i[o].length)continue;const s=0===o?0:i[o-1].start+i[o-1].length;s<i[o].start&&a(n,s,i[o].start-s,r.None,t),a(n,i[o].start,i[o].length,i[o].decorationType,t);const l=i[o].start+i[o].length;o===i.length-1&&l<e&&a(n,l,e-l,r.None,t)}return 0===n.length&&a(n,0,e,r.None,t),n}function a(e,t,o,s,a){var l,c;const u={start:t,length:o};switch(s){case r.Spelling:u.emphasizedColor=a.errorText,u.underlineType=n.RV.SpellingSquiggle;break;case r.Grammar:u.emphasizedColor=a.errorText,u.underlineType=n.RV.GrammarSquiggle;break;case r.Refinement:u.emphasizedColor=a.errorText,u.underlineType=n.RV.CritiqueSquiggle;break;case r.Rewrite:case r.SimilarityChecker:u.fontWeight=n.IT.Bold,u.cssColor=null===(l=a.rewriteText)||void 0===l?void 0:l.resting,u.cssColorHover=null===(c=a.rewriteText)||void 0===c?void 0:c.hover;break;case r.Modification:u.highlightColor=a.correctionHighlight,u.highlightRadius=2,u.fontWeight=n.IT.SemiBold;break;case r.PremiumEmphasis:u.cssColor=a.premiumEmphasis,u.fontFamily=i.m;break;case r.TrackChangeContent:u.italic=!0;break;case r.TrackChangePlaceholder:u.cssColor=a.trackChangePlaceholderText;break;case r.CatchUp:u.cssColor=a.catchUpDescriptorText,u.fontWeight=n.IT.SemiBold}e.push(u)}!function(e){e[e.None=0]="None",e[e.Spelling=1]="Spelling",e[e.Grammar=2]="Grammar",e[e.Refinement=3]="Refinement",e[e.Rewrite=4]="Rewrite",e[e.SimilarityChecker=5]="SimilarityChecker",e[e.AccColorChecker=6]="AccColorChecker",e[e.Modification=7]="Modification",e[e.PremiumEmphasis=8]="PremiumEmphasis",e[e.TrackChangeContent=9]="TrackChangeContent",e[e.TrackChangePlaceholder=10]="TrackChangePlaceholder",e[e.CatchUp=11]="CatchUp"}(r||(r={}))},62153:(e,t,o)=>{"use strict";o.d(t,{j:()=>i}),(0,o(54167).hN)([{rawString:".menuItem_60ddf5f8 button{background-color:unset;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center !important;-ms-flex-pack:center !important;justify-content:center !important}.menuItem_60ddf5f8 button span{height:32px;min-width:auto}.menuItem_60ddf5f8 button span div{-webkit-box-pack:center !important;-ms-flex-pack:center !important;justify-content:center !important}.menuItem_60ddf5f8 button i{font-size:18px !important}.menuItem_60ddf5f8 button:hover:not(.selected_60ddf5f8){background-color:var(--defaultMenuButtonsHoverBgColor) !important;border-color:var(--defaultMenuButtonsHoverBorderColor) !important}.menuItem_60ddf5f8 button:hover:not(.selected_60ddf5f8) svg{color:var(--defaultMenuButtonsHoverTextColor)}.menuItem_60ddf5f8 button:hover:not(.selected_60ddf5f8) i{color:var(--defaultMenuButtonsHoverTextColor) !important}.menuItem_60ddf5f8 button:active,.menuItem_60ddf5f8 button:hover:active{background-color:var(--defaultMenuButtonsPressedBgColor) !important;border-color:var(--defaultMenuButtonsPressedBorderColor) !important}.menuItem_60ddf5f8 button:active svg,.menuItem_60ddf5f8 button:hover:active svg{color:var(--defaultMenuButtonsPressedTextColor)}.menuItem_60ddf5f8 button:active i,.menuItem_60ddf5f8 button:hover:active i{color:var(--defaultMenuButtonsPressedTextColor) !important}.menuItem_60ddf5f8 button:enabled:focus:not(.selected_60ddf5f8){background-color:var(--defaultMenuButtonsFocusedBgColor) !important;border-color:var(--defaultMenuButtonsFocusedBorderColor) !important}.menuItem_60ddf5f8 button:enabled:focus:not(.selected_60ddf5f8) svg{color:var(--defaultMenuButtonsFocusedTextColor)}.menuItem_60ddf5f8 button:enabled:focus:not(.selected_60ddf5f8) i{color:var(--defaultMenuButtonsFocusedTextColor) !important}.menuItem_60ddf5f8 button.selected_60ddf5f8{background-color:var(--defaultMenuButtonsSelectedBgColor) !important;border-color:var(--defaultMenuButtonsSelectedBorderColor) !important}.menuItem_60ddf5f8 button.selected_60ddf5f8 svg{color:var(--defaultMenuButtonsSelectedTextColor)}.menuItem_60ddf5f8 button.selected_60ddf5f8 i{color:var(--defaultMenuButtonsSelectedTextColor) !important}.menuItem_60ddf5f8 button:enabled:hover.selected_60ddf5f8{background-color:var(--defaultMenuButtonsSelectedHoverBgColor) !important;border-color:var(--defaultMenuButtonsSelectedHoverBorderColor) !important}.menuItem_60ddf5f8 button:enabled:hover.selected_60ddf5f8 svg{color:var(--defaultMenuButtonsSelectedHoverTextColor)}.menuItem_60ddf5f8 button:enabled:hover.selected_60ddf5f8 i{color:var(--defaultMenuButtonsSelectedHoverTextColor) !important}.menuItem_60ddf5f8 button:enabled.selected_60ddf5f8:hover:active{background-color:var(--defaultMenuButtonsSelectedPressedBgColor) !important;border-color:var(--defaultMenuButtonsSelectedPressedBorderColor) !important}.menuItem_60ddf5f8 button:enabled.selected_60ddf5f8:hover:active svg{color:var(--defaultMenuButtonsSelectedPressedTextColor)}.menuItem_60ddf5f8 button:enabled.selected_60ddf5f8:hover:active i{color:var(--defaultMenuButtonsSelectedPressedTextColor) !important}.menuItem_60ddf5f8 button:enabled.selected_60ddf5f8:hover:active{background-color:var(--defaultMenuButtonsSelectedFocusedBgColor) !important;border-color:var(--defaultMenuButtonsSelectedFocusedBorderColor) !important}.menuItem_60ddf5f8 button:enabled.selected_60ddf5f8:hover:active svg{color:var(--defaultMenuButtonsSelectedFocusedTextColor)}.menuItem_60ddf5f8 button:enabled.selected_60ddf5f8:hover:active i{color:var(--defaultMenuButtonsSelectedFocusedTextColor) !important}"}]);const i="menuItem_60ddf5f8"},66563:(e,t,o)=>{"use strict";o.d(t,{i:()=>i});const i=()=>!1},75033:(e,t,o)=>{"use strict";o.d(t,{c:()=>n});var i=o(95734);const n=e=>{i.useEffect((()=>(window.addEventListener("mousemove",e,{capture:!0,passive:!0}),()=>window.removeEventListener("mousemove",e,{capture:!0}))),[])}},58742:(e,t,o)=>{"use strict";function i(){return!1}o.d(t,{R2:()=>i})},67036:(e,t,o)=>{"use strict";o.d(t,{EH:()=>p,Eh:()=>l,HP:()=>_,Hz:()=>u,KW:()=>f,OF:()=>T,T4:()=>b,a4:()=>y,do:()=>m,eS:()=>x,g$:()=>w,m$:()=>E,ms:()=>d,o2:()=>h,pj:()=>g,rj:()=>C,t$:()=>k,xt:()=>S,zh:()=>v});var i=o(95734);if(3023==o.j)var n=o(54651);if(3023==o.j)var r=o(62989);if(3023==o.j)var s=o(56360);if(3023==o.j)var a=o(66466);function l(e){return{oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function c(e){return{defaultOverflowButtonAccessibilityLabel:e("defaultOverflowButtonAccessibilityLabel"),oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function u(e){return{defaultSplitButtonOverflowAccessibilityLabel:e("defaultSplitButtonOverflowAccessibilityLabel"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function d(e,t,o,i,s,a,l,u,d,h,g,p,m,v){const b=f(e),w=void 0!==u;if(void 0!==u&&(u<0||u>=b.length))return;const C=w?b[u]:void 0,k=s.filter((t=>S(e,t,C))).filter((t=>y(e,o,t))).map((t=>I(e,o,i,t)));return!w&&S(e,r._R.ShowMenu)&&(k.length>0&&k.push({type:"separator",key:"separator"}),k.push(I(e,o,i,r._R.ShowMenu))),0!==k.length?{tooltip:w||a?void 0:l,items:k,onClick:e=>{if(g){const t=parseInt(e.key,10);g(t,u)}},style:w?{}:Object.assign(Object.assign({},n.lI(v)),{calloutStyle:null==v?void 0:v.calloutStyle}),theme:n.B1(t,p),itemTheme:n.P4(t,void 0,!0),strings:c(o.common),accessibilityLabel:l,automationLabelType:"CritiqueActionButton",automationId:d||"",hasKeyboardFocus:p,layerHostId:h,onHeightChange:m,shouldFocusButtonOnDismiss:e.critiqueType!==r.L9.InlineSuggestion&&void 0}:void 0}function h(e,t,o,r,a,l,c,u,d,h,g,p,f,m,v,y,C,S,T,x){const I=Object.assign(Object.assign({},r.tooltipProps),{layerHostId:x||void 0}),E=w(o),B=void 0!==E?{type:E,filled:v}:void 0,A={onClick:()=>{null==m||m(o,void 0,l)},title:c,titleStyle:u,tooltip:d,tooltipProps:I,disabled:k(e,o),style:r,theme:n.P4(t,void 0,v,C),accessibilityLabel:b(e,a,o),automationLabel:null!=h?h:_(o,f),badgeProps:p,icon:B,htmlId:y,onHeightChange:T,uiAnchorId:S,hasKeyboardFocus:C,appearance:"subtle"};return i.createElement(s.J,Object.assign({ref:g},A,{key:o.toString(),useAlternateIconColors:v}))}function g(e,t,o,a,l,c,u,d,h){const g=y(e,a,r._R.Feedback);if(!g)return null;const p={type:w(r._R.Feedback),filled:!0},f=n.$d(t,u),m={onClick:()=>{null==c||c(r._R.Feedback,void 0,void 0)},title:g,tooltip:g,tooltipProps:{layerHostId:h},disabled:k(e,r._R.Feedback),style:o,theme:f,accessibilityLabel:b(e,a,r._R.Feedback),automationLabel:`CritiqueActionButton_${g}_${l}`,icon:p,onHeightChange:d};return i.createElement(s.J,Object.assign({},m,{key:r._R.Feedback.toString(),useAlternateIconColors:!0}))}function p(e,t,o,i,n,r,s){if(e.showDictationCommandUx&&!i){const i=function(e,t,o,i){const n=m(e,t).filter((e=>e.action===o&&e.suggestionIndex===i));return n.length>0?n[0].badgeId:void 0}(e,t,n,r);if(void 0!==i)return{text:i.toString(),theme:o,style:s}}}function f(e){const t=e.maximumSuggestions||n.gc;return e.suggestions?e.suggestions.length>t?e.suggestions.slice(0,t):e.suggestions:[]}function m(e,t){var o;const i=v(e,t),n=[];let s=1;return i?i.forEach(((e,t)=>{n.push({action:e,badgeId:s++,suggestionIndex:t})})):null===(o=f(e))||void 0===o||o.forEach(((t,o)=>{k(e,r._R.Accept,t)||n.push({action:r._R.Accept,badgeId:s++,suggestionIndex:o})})),n}function v(e,t){switch(e.critiqueType){case r.L9.RepeatedWord:return[r._R.Accept];case r.L9.SimilarityChecker:return(S(e,r._R.MoreSources)?[r._R.IntextCitation,r._R.FullCitation,r._R.MoreSources]:[r._R.IntextCitation,r._R.FullCitation]).filter((o=>y(e,t,o)))}if(e.isContentPending)return[]}function b(e,t,o){switch(o){case r._R.Previous:case r._R.Next:if(e.wrapAroundNavigation&&void 0!==e.critiqueSetSize&&e.critiqueSetSize>1){const i=e.critiqueSetSize.toString(10);return o===r._R.Previous?t.critique("previousIssueWithCount").replace("{0}",i):t.critique("nextIssueWithCount").replace("{0}",i)}return o===r._R.Previous?t.critique("previousIssue"):t.critique("nextIssue")}return y(e,t,o)}function y(e,t,o){var i,n,s,a,l,c,u,d,h,g,p,f,m,v,b,y;switch(o){case r._R.ReadAloud:return t.critique("readAloud");case r._R.SpellOut:return t.critique("spellOut");case r._R.ChangeAll:return t.critique("changeAll");case r._R.AddToAutoCorrect:return t.critique("addToAutoCorrect");case r._R.AutoCorrectOptions:return t.critique("autoCorrectOptions");case r._R.IgnoreOnce:return t.critique("ignoreOnce");case r._R.IgnoreAll:return t.critique("ignoreAll");case r._R.IgnoreRule:return t.critique("ignoreRule");case r._R.AddToDictionary:return t.critique("addToDictionary");case r._R.Options:return t.critique("options");case r._R.ShowExplanation:return t.critique("footerExplanationButtonAccessibilityLabel");case r._R.ManageLanguages:return t.critique("manageLanguages");case r._R.Next:return t.critique("nextIssue");case r._R.Previous:return t.critique("previousIssue");case r._R.ToggleContext:return e.showContext?t.critique("hideContext"):t.critique("showContext");case r._R.ToggleDescription:return e.critiqueType===r.L9.Spelling?e.showDescription?t.critique("hideSynonyms"):t.critique("showSynonyms"):e.critiqueType===r.L9.NeuralRewrite?e.showDescription?t.critique("hideExplanationButtonText"):t.critique("showExplanationButtonText"):void 0;case r._R.ReadContext:return t.critique("readAloudOriginalSentenceAccessibilityLabel");case r._R.ShowMenu:return t.critique("showMenuButtonText");case r._R.Feedback:return t.critique("giveFeedbackButtonText");case r._R.Dismiss:return t.common("cancelButton");case r._R.OpenEditorPane:return t.critique("accessibilityLabelForEditorButton");case r._R.LearnMore:return t.critique("learnMore");case r._R.IntextCitation:return t.critique("addInTextCitation");case r._R.FullCitation:return t.critique("copyFullCitation");case r._R.MoreSources:return t.critique("moreSources");case r._R.Accessibility:return null===(i=t.accChecker)||void 0===i?void 0:i.call(t,"accAssistant");case r._R.OpenColorPicker:return null===(n=t.accChecker)||void 0===n?void 0:n.call(t,"moreColors");case r._R.MoreFontColors:return null===(s=t.accChecker)||void 0===s?void 0:s.call(t,"moreFontColors");case r._R.ChangeColors:return null===(a=t.accChecker)||void 0===a?void 0:a.call(t,"changeColors");case r._R.ResetGraphic:return null===(l=t.accChecker)||void 0===l?void 0:l.call(t,"resetGraphic");case r._R.TurnOffAccChecker:return null===(c=t.accChecker)||void 0===c?void 0:c.call(t,"turnOffAccChecker");case r._R.Allow:return null===(u=t.accChecker)||void 0===u?void 0:u.call(t,"allowTextColorIssue");case r._R.AllowAll:return null===(d=t.accChecker)||void 0===d?void 0:d.call(t,"allowAllTextColorIssues");case r._R.FixSimilarColors:return null===(h=t.accChecker)||void 0===h?void 0:h.call(t,"fixSimilarColors");case r._R.FixAllColors:return null===(g=t.accChecker)||void 0===g?void 0:g.call(t,"fixAllColors");case r._R.AutoGenAltText:case r._R.MissingAltText:return null===(p=t.accChecker)||void 0===p?void 0:p.call(t,"altText");case r._R.UseFirstRowAsHeader:return null===(f=t.accChecker)||void 0===f?void 0:f.call(t,"useFirstRowAsHeader");case r._R.SplitCell:return null===(m=t.accChecker)||void 0===m?void 0:m.call(t,"splitCell");case r._R.MergeCells:return null===(v=t.accChecker)||void 0===v?void 0:v.call(t,"mergeCells");case r._R.MarkAsDecorative:return null===(b=t.accChecker)||void 0===b?void 0:b.call(t,"markAsDecorative");case r._R.MarkAsLayout:return null===(y=t.accChecker)||void 0===y?void 0:y.call(t,"markAsLayout");case r._R.Accept:case r._R.Complete:case r._R.AddOnFooterAction:case r._R.Report:case r._R.RejectHoverIn:case r._R.RejectHoverOut:case r._R.AcceptHoverIn:case r._R.AcceptHoverOut:case r._R.Reject:case r._R.OpenCustomDictionary:case r._R.SourceSelected:case r._R.ApplyColor:case r._R.RefreshSummary:case r._R.UndoInsertSummarization:case r._R.Overflow:case r._R.InsertBelow:case r._R.Regenerate:case r._R.Cancel:case r._R.StopGenerating:case r._R.ContainerHoverIn:case r._R.ContainerHoverOut:case r._R.LaunchAIRewrite:case r._R.LaunchAIRewriteHoverIn:case r._R.LaunchAIRewriteHoverOut:case r._R.CatchUp:return}}function w(e){switch(e){case r._R.Allow:return"Ignore";case r._R.AllowAll:return"IgnoreAll";case r._R.IgnoreOnce:return"Ignore";case r._R.IgnoreAll:return"IgnoreAll";case r._R.IgnoreRule:return"IgnoreRule";case r._R.FixAllColors:return"Completed";case r._R.AddToDictionary:return"AddToDictionary";case r._R.ShowExplanation:return"ShowExplanation";case r._R.Next:return"Next";case r._R.Previous:return"Previous";case r._R.ReadContext:return"ReadAloud";case r._R.Feedback:return"GiveFeedback";case r._R.Dismiss:return"Cancel";case r._R.OpenEditorPane:return"Editor";case r._R.ManageLanguages:return"LocaleLanguage";case r._R.Options:return"EditorSettings";case r._R.IntextCitation:return"Plus";case r._R.FullCitation:return"Copy";case r._R.Accessibility:return"Accessibility";case r._R.OpenColorPicker:case r._R.MoreFontColors:case r._R.ChangeColors:return"Color";case r._R.TurnOffAccChecker:return"Hide";case r._R.MarkAsDecorative:case r._R.MarkAsLayout:return"BowTie";case r._R.UseFirstRowAsHeader:return"FirstRowAsHeader";case r._R.ResetGraphic:return"ArrowReset"}}function C(e,t){switch(e){case r.L9.Refinement:case r.L9.RepeatedWord:case r.L9.SimilarityChecker:case r.L9.AccColorChecker:case r.L9.TonalRewrite:case r.L9.Grammar:case r.L9.DictationCorrection:case r.L9.TextPenAlternates:return r._R.IgnoreOnce;case r.L9.Spelling:case r.L9.Topic:return r._R.IgnoreAll;case r.L9.InlineSuggestion:switch(t){case r.z4.Person:case r.z4.File:case r.z4.Location:case r.z4.SatoriEntity:return r._R.IgnoreOnce;case r.z4.Topic:return r._R.IgnoreAll;default:return}case r.L9.AddinCritique:return r._R.IgnoreOnce;case r.L9.NeuralRewrite:case r.L9.Classification:case r.L9.WritersUnblock:default:return}}function S(e,t,o){switch(t){case r._R.Previous:case r._R.Next:return T(e)&&x(e,t);case r._R.ToggleContext:if(void 0===e.contextText)return!1;break;case r._R.ReadContext:const o=w(t);if(void 0===o||!(0,a.R)({type:o}))return!1;break;case r._R.IgnoreOnce:if(e.critiqueType===r.L9.SimilarityChecker)return!0;break;case r._R.Accessibility:case r._R.OpenColorPicker:case r._R.Allow:case r._R.AllowAll:case r._R.FixSimilarColors:case r._R.FixAllColors:case r._R.AutoGenAltText:case r._R.MissingAltText:case r._R.UseFirstRowAsHeader:case r._R.SplitCell:case r._R.MergeCells:case r._R.MarkAsDecorative:case r._R.MarkAsLayout:return!0;case r._R.Feedback:case r._R.TurnOffAccChecker:if(e.critiqueType===r.L9.AccColorChecker||e.critiqueType===r.L9.AltText||e.critiqueType===r.L9.MergeSplitCell||e.critiqueType===r.L9.MissingTableHeader)return!0}return x(e,t,o)}function k(e,t,o){switch(t){case r._R.Next:case r._R.Previous:return!T(e)||!x(e,t)||!e.wrapAroundNavigation&&(t===r._R.Previous?e.critiquePosition<=0:e.critiquePosition>=e.critiqueSetSize-1);case r._R.Dismiss:case r._R.Accessibility:case r._R.OpenColorPicker:case r._R.Allow:case r._R.AllowAll:case r._R.FixSimilarColors:case r._R.FixAllColors:case r._R.Overflow:case r._R.AutoGenAltText:case r._R.MissingAltText:case r._R.UseFirstRowAsHeader:case r._R.SplitCell:case r._R.MergeCells:case r._R.MarkAsDecorative:case r._R.MarkAsLayout:return!1;default:return!x(e,t,o)}}function T(e){return void 0!==e.critiquePosition&&void 0!==e.critiqueSetSize&&e.critiquePosition>=0&&e.critiqueSetSize>0}function x(e,t,o){const{actions:i}=e,n=o?o.actions:i;return!!n&&n.indexOf(t)>=0}function _(e,t){switch(e){case r._R.Previous:return`CritiqueNavButton_Left_${t}`;case r._R.Next:return`CritiqueNavButton_Right_${t}`;case r._R.Dismiss:return`CritiqueCloseButton_${t}`;case r._R.OpenEditorPane:return`EditorPaneOpenButton_${t}`}return"undefined"}function I(e,t,o,i){const r=i,s=y(e,t,r);return{type:"item",key:r.toString(),title:s,titleStyle:n.Ot(o,s.length),iconType:w(r)}}function E(e={}){return Object.assign(Object.assign({},n.Y_),e)}},31127:(e,t,o)=>{"use strict";var i,n;o.d(t,{UD:()=>i,tR:()=>n}),function(e){e[e.Unknown=0]="Unknown",e[e.Inference=1]="Inference"}(i||(i={})),function(e){e[e.Unknown=0]="Unknown",e[e.VoiceDictationBadge=1]="VoiceDictationBadge",e[e.VoiceDictationPhrase=2]="VoiceDictationPhrase"}(n||(n={}))},33748:(e,t,o)=>{"use strict";o.d(t,{Q:()=>d,Yi:()=>u,oN:()=>h});var i=o(95734),n=o(20855),r=o(16971),s=o(67036),a=o(62989),l=o(54651),c=o(70574);const u=i.forwardRef(((e,t)=>{var o;const u=e.definition,d=i.useContext(r.O),h=(0,l.W0)(e,d),g=(0,c.OL)(e,t,u,h,1);let p=g.length+1;return 0===g.length&&(g.push((0,c.nb)(e,t,0,e.noSuggestionsLabel||e.strings.common("suggestionsGroupNoSuggestionsText"),a._R.Accept,h,!0)),p-=1),g.push(((e,t,o,r,c,u,d)=>{const h={title:r,actions:[a._R.LaunchAIRewrite]},g={title:r,titleStyle:(0,l.D0)(e.fontTable||l.d4,r.length),tag:void 0,tagStyle:(0,l.RU)(e.fontTable||l.d4),icon:{type:"ColorfulCopilot"},disabled:!1,onClick:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,a._R.LaunchAIRewrite,o)},onSplitButtonIn:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,a._R.LaunchAIRewriteHoverIn,o)},onSplitButtonOut:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,a._R.LaunchAIRewriteHoverOut,o)},theme:(0,l.P4)(c,"suggestion"),strings:(0,s.Eh)(e.strings.common),accessibilityRole:"menuitem",accessibilityLabel:e.suggestionAccessibilityLabel&&e.suggestionAccessibilityLabel(h),automationLabel:"CritiqueSuggestionButton_"+h.id};return i.createElement(n.f,{key:o,ref:t,buttonProps:g,menuProps:void 0,style:l.kw,theme:{splitMenuHoverBackground:c.suggestionMenuHoverBackground,splitMenuHoverForeground:c.suggestionMenuHoverForeground},strings:(0,s.Hz)(e.strings.common),accessibilityPositionInSet:void 0!==u?u:1,accessibilitySetSize:void 0!==d?d:1,layerHostId:e.layerHostId})})(e,0===g.length?t:void 0,g.length,null!==(o=u.aIRewriteButtonText)&&void 0!==o?o:e.strings.critique("defaultCritiqueAIRewriteText"),h,p,p)),i.createElement(i.Fragment,null,g)}));function d(e){return null!=e.showAIRewriteNudgeForCritiqueType&&e.showAIRewriteNudgeForCritiqueType.length>0&&e.showAIRewriteNudgeForCritiqueType.includes(e.critiqueType)}function h(e,t){var o;return i.createElement(u,Object.assign({},e,{ref:null!==(o=e.firstSuggestionRef)&&void 0!==o?o:t}))}u.displayName="AIRewriteSuggestions"},70574:(e,t,o)=>{"use strict";o.d(t,{OL:()=>v,nb:()=>b});var i=o(95734),n=o(40732),r=o(20855),s=o(48545),a=o(16971),l=o(7313),c=o(68803),u=o(58742),d=o(67036),h=o(62989),g=o(54651),p=o(7869);const f=(e,t,o,i,r,s,a)=>{const l=e.suggestionKind?e.suggestionKind(t):void 0,c=e.definition,u=t.title,p=u.length,f=(0,d.t$)(c,i,t),m=(0,d.EH)(c,e.strings,r,f,i,o),v=void 0!==s?{type:s}:void 0,b={title:u,titleStyle:void 0!==l&&i!==h._R.MoreSources?(0,g.D0)(e.fontTable||g.d4,p):(0,n.S)(p,r,t.titleDecorations),tag:t.tag,tagStyle:(0,g.RU)(e.fontTable||g.d4),icon:v,disabled:f,onClick:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,i,o)},theme:(0,g.P4)(r,l),strings:(0,d.Eh)(e.strings.common),accessibilityRole:"menuitem",accessibilityLabel:e.suggestionAccessibilityLabel&&e.suggestionAccessibilityLabel(t),automationLabel:"CritiqueSuggestionButton_"+t.id,badgeProps:m,uiAnchorId:a};return((e,t)=>!!((0,d.eS)(e,h._R.Accept,t)&&e.showDescription&&t.subtitle&&t.subtitle.length>0))(e.definition,t)&&(b.subtitle=t.subtitle,b.subtitleStyle=(0,g.qw)(e.fontTable||g.d4)),b},m=(e,t,o,n,s,a,l,c)=>i.createElement(r.f,{key:o,ref:t,buttonProps:n,menuProps:a,style:g.kw,theme:{splitMenuHoverBackground:s.suggestionMenuHoverBackground,splitMenuHoverForeground:s.suggestionMenuHoverForeground},strings:(0,d.Hz)(e.strings.common),accessibilityPositionInSet:void 0!==l?l:1,accessibilitySetSize:void 0!==c?c:1,layerHostId:e.layerHostId});function v(e,t,o,n,r){const a=(0,d.KW)(o);return a.map(((l,c)=>{const u=m(e,0===c?t:void 0,c,f(e,l,c,h._R.Accept,n,e.suggestionIcon?e.suggestionIcon(l):void 0),n,(0,d.ms)(o,n,e.strings,e.fontTable||g.d4,e.suggestionOverflowActions||[],!(!e.settings||"true"!==e.settings.NoTooltipForFooterOverflow),void 0,c,e.automationId,e.layerHostId,e.onAction),c+1,a.length+(null!=r?r:0));return c>0&&l.tag!==a[c-1].tag?i.createElement(i.Fragment,null,i.createElement(s.w,{key:c,color:e.theme&&e.theme.separator,style:g.cK}),u):u}))}const b=(e,t,o,i,n,r,s,a,l,c,u)=>m(e,0===o?t:void 0,o,f(e,{title:i,actions:s?[]:[n]},o,n,r,a,u),r,void 0,l,c),y=i.forwardRef(((e,t)=>{const o=e.definition,n=i.useContext(a.O),r=(0,g.W0)(e,n),s=v(e,t,o,r);return 0===s.length?b(e,t,0,e.noSuggestionsLabel||e.strings.common("suggestionsGroupNoSuggestionsText"),h._R.Accept,r,!0):i.createElement(i.Fragment,null,s)}));y.displayName="Suggestions",i.forwardRef(((e,t)=>{const o=e.suggestionsGroupAriaLabel;let n;n=(0,p.Z)(e)?e.getCustomSuggestions&&t?e.getCustomSuggestions(e,t):void 0:e.customSuggestions;const r=null!=n?n:i.createElement(y,Object.assign({},e,{ref:t}));return(0,u.R2)()?i.createElement(l.S,{align:c.j5.Stretch,accessible:!1},r):i.createElement(l.S,{align:c.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:o},r)})).displayName="BodySuggestions"},87169:(e,t,o)=>{"use strict";if(o.d(t,{m:()=>c}),3023==o.j)var i=o(5076);if(3023==o.j)var n=o(87962);var r=o(95734);if(3023==o.j)var s=o(62989);if(3023==o.j)var a=o(54651);if(3023==o.j)var l=o(70574);const c=(e,t)=>({suggestionKind:e=>{if(!(e.titleDecorations&&e.titleDecorations.length>0))return"suggestion"},suggestionOverflowActions:[],suggestionsGroupAriaLabel:e.strings.critique("suggestionsGroupAccessibilityLabel"),suggestionAccessibilityLabel:t=>{const o=e.definition,i=t.tagAccessibilityLabel||t.tag||"";return o.showDescription&&t.subtitle&&0!==t.subtitle.trim().length?e.strings.critique("neuralRewriteSuggestionAccessibilityLabel").replace("{0}",t.title).replace("{1}",t.subtitle):i?e.strings.critique("suggestionWithTagAccessibilityLabel").replace("{0}",i).replace("{1}",t.title):""},customBody:e.definition.isContentPending?r.createElement(i.R,null,r.createElement(n.v,{key:0,shimmerCount:a.Wi,styles:(0,a.B8)(e.spacing||a.lT),render:()=>(0,l.nb)(e,void 0,0,e.strings.common("suggestionsGroupLoadingSuggestionsText"),s._R.Accept,(0,a.W0)(e,!!(null==t?void 0:t.useFluentV9)),!0)})):void 0})},77871:(e,t,o)=>{"use strict";o.d(t,{R:()=>c});var i=o(95734);if(3023==o.j)var n=o(54651);if(3023==o.j)var r=o(7313);if(3023==o.j)var s=o(68803);if(3023==o.j)var a=o(97782);if(3023==o.j)var l=o(78585);const c=e=>i.createElement(r.S,{direction:s.PR.LeftToRight,style:n.JP},i.createElement(a.I,{type:"ForwardSlashPromo",style:n.VP}),i.createElement(l.c,{text:e.strings.inlineSuggestions("discoveryPromoFooterText"),style:n.vP}))},73543:(e,t,o)=>{"use strict";o.d(t,{w:()=>G,k:()=>U});var i=o(95734),n=o(54651),r=o(98848),s=o(85859),a=o(16971),l=o(5076),c=o(39904);const u=i.memo((0,i.forwardRef)(((e,t)=>{const o=i.useContext(a.O),n=i.useRef(null),r=i.useRef(null);(0,i.useImperativeHandle)(t,(()=>({focus:u})));const u=()=>{var e,t;o?null===(e=r.current)||void 0===e||e.focus():null===(t=n.current)||void 0===t||t.focus()};return o?i.createElement(l.y,Object.assign({},e,{ref:r,direction:c.E.None})):i.createElement(s.Y,{disabled:e.disabled,componentRef:n,forceFocusInsideTrap:!1},e.children)})));u.displayName="FocusTrapZone";var d=o(8821),h=o(68803),g=o(7313),p=o(78585),f=o(78607),m=o(86399);class v extends i.PureComponent{render(){return i.createElement("tr",null,this.props.children)}}class b extends i.PureComponent{render(){return this.props.header?i.createElement("th",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children):i.createElement("td",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}getTableCellStyle(){const e={};return this.props.style&&this.props.style.paddingVertical&&(e.paddingBottom=this.props.style.paddingVertical,e.paddingTop=this.props.style.paddingVertical),this.props.style&&this.props.style.paddingHorizontal&&(e.paddingLeft=this.props.style.paddingHorizontal,e.paddingRight=this.props.style.paddingHorizontal),this.props.style&&this.props.style.paddingStart&&(e.paddingInlineStart=this.props.style.paddingStart),this.props.style&&this.props.style.paddingEnd&&(e.paddingInlineEnd=this.props.style.paddingEnd),this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),this.props.style&&this.props.style.marginHorizontal&&(e.marginLeft=this.props.style.marginHorizontal,e.marginRight=this.props.style.marginHorizontal),this.props.style&&this.props.style.verticalAlign&&(e.verticalAlign=this.props.style.verticalAlign),this.props.style&&this.props.style.horizontalAlign&&(e.textAlign=this.props.style.horizontalAlign),e}}var y=o(40732);class w extends i.PureComponent{render(){return i.createElement("table",{style:this.getTableStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}getTableStyle(){const e={borderCollapse:"collapse"};return this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),e}}var C,S=o(62989);!function(e){e[e.Exposition=0]="Exposition",e[e.Example=1]="Example"}(C||(C={}));class k extends i.PureComponent{componentDidMount(){const e=this.getDefinition();e&&e.explanationTitle,this.getExplanationText()}render(){const e=this.parseExplanationText(this.getExplanationText()),t=this.getDefinition(),o=t&&t.explanationTitle||"";return i.createElement(u,null,i.createElement(d.Y,{componentStackStyle:n.tJ(this.props.style,this.props.theme),stackAlignment:h.j5.Stretch,stackDirection:h.PR.TopToBottom,header:o,headerStyle:n.J2(this.props.theme,this.props.fontTable)},this.renderExplanationText(e),this.renderAccessibleColorsLearningTip(),this.renderMergeSplitCellsLearningTip()))}renderAccessibleColorsLearningTip(){var e,t,o,r,s,a;if(this.props.definition.critiqueType!==S.L9.AccColorChecker)return null;const l={height:16,width:16},c={type:"ErrorBadge",primaryColor:"#E41323",style:l},u={type:"Completed",primaryColor:"#0B6A0B",style:l},d={backgroundColor:"#CCCCCC",borderRadius:2,minHeight:24,marginVertical:4,marginStart:10,paddingHorizontal:15},v={width:"50%"};return i.createElement(g.S,null,i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{style:v},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("explanationTableBefore"),style:n.dU(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})),i.createElement(g.S,{style:v},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("explanationTableAfter"),style:n.dU(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{style:v},i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:{height:32}},i.createElement(f.E,Object.assign({},c))),i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:d},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#BECFFA",fontSize:this.props.fontTable.xsmall,fontWeight:m.IT.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{style:{width:26}}),i.createElement(p.c,{text:null!==(o=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"poorContrast"))&&void 0!==o?o:"",style:n._e(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(g.S,{style:v},i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:{height:32}},i.createElement(f.E,Object.assign({},u))),i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:d},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#002EA3",fontSize:this.props.fontTable.xsmall,fontWeight:m.IT.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),i.createElement(g.S,{direction:h.PR.LeftToRight},i.createElement(g.S,{style:{width:26}}),i.createElement(p.c,{text:null!==(a=null===(s=(r=this.props.strings).accChecker)||void 0===s?void 0:s.call(r,"goodContrast"))&&void 0!==a?a:"",style:n._e(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))))}renderMergeSplitCellsLearningTip(){const{critiqueType:e}=this.props.definition,t=this.props.strings.accChecker;return e===S.L9.MergeSplitCell&&t?i.createElement(g.S,null,["mergeSplitCellStepsTitle","mergeSplitCellStepsLine1","mergeSplitCellStepsLine2","mergeSplitCellStepsLine3","mergeSplitCellStepsLine4","mergeSplitCellStepsEnd"].map((e=>i.createElement(p.c,{key:e,text:null==t?void 0:t(e),style:n._e(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))):null}getDefinition(){return this.props.definition}getExplanationText(){const e=this.getDefinition();return e&&e.explanation?e.explanation.replace("\\r\\n","\r\n"):""}parseExplanationText(e){const t=[];let o=[],n=null,r=!0,s=!1,a=0,l=0,c=0,u=this.props.strings.critiqueExplanation("explanationTableBefore"),d=this.props.strings.critiqueExplanation("explanationTableAfter");const h=e.split("\r\n");for(const e of h)if(0!==e.length)if("•"===e[0]){const t=e.indexOf(":"),h=e.substr(2,t-1),g=e.substr(t+2);r?(u=h,n=this.renderBeforeText(g,l++),r=!1,s=!0):s?(d=h,o.push(i.createElement(v,{key:a++},this.renderTableHeaderText(u,l++,0===o.length,!0),this.renderTableHeaderText(d,c++,0===o.length,!1))),o.push(i.createElement(v,{key:a++},n,this.renderAfterText(g,c++))),n=null,s=!1):(o.push(i.createElement(v,{key:a++},this.renderPlaceholder(l++),this.renderExampleSeparator(c++))),o.push(i.createElement(v,{key:a++},this.renderPlaceholder(l++),this.renderAfterText(g,c++))))}else o.length>0&&(t.push(this.renderCurrentTable(o)),o=[]),t.push(this.renderExplanationNonExampleText(e));else n=null,r=!0,s=!1;return o.length>0&&(t.push(this.renderCurrentTable(o)),o=[]),t}analyzeExampleText(e){const t={trimmedText:e,emphasisStart:-1,emphasisLength:-1},o=e.indexOf("{ul}");if(-1!==o){const i=e.indexOf("{ul 0}",o);if(-1!==i){const n=o+4,r=i-n;t.trimmedText=e.substr(0,o)+e.substr(n,r)+e.substr(i+6),t.emphasisStart=o,t.emphasisLength=r}}return t}renderTableHeaderText(e,t,o,r){const s=r?n.i6():n.db();return o?i.createElement(b,{header:!0,key:t,style:s},i.createElement(p.c,{text:e,style:n.dU(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})):i.createElement(b,{key:t,style:s}," ")}renderCurrentTable(e){return{explanationPartType:C.Example,data:e}}getDecorationType(e){switch(e){case S.L9.Grammar:return S.vr.Grammar;case S.L9.Refinement:return S.vr.Refinement;default:return S.vr.None}}renderBeforeText(e,t){return this.renderExampleText(e,t,this.getDecorationType(this.getDefinition().critiqueType),this.props.strings.critiqueExplanation("explanationTableBefore"),!0)}renderAfterText(e,t){return this.renderExampleText(e,t,S.vr.Modification,this.props.strings.critiqueExplanation("explanationTableAfter"),!1)}renderExampleText(e,t,o,s,a){const l=[],c=this.analyzeExampleText(e);-1!==c.emphasisStart&&-1!==c.emphasisLength&&l.push({start:c.emphasisStart,length:c.emphasisLength,decorationType:o});const u=s+" "+(0,r.y)(this.props.strings.textFormatting,this.getDefinition().critiqueType,c.trimmedText,l),d=a?n.i6():n.db();return i.createElement(b,{key:t,style:d},i.createElement(p.c,{text:c.trimmedText,style:n._e(this.props.theme,this.props.fontTable),formatting:(0,y.S)(e.length,this.props.theme,l),accessibilityRole:"text",accessibilityLabel:u}))}renderExampleSeparator(e){return i.createElement(b,{key:e,style:n.db()},i.createElement(p.c,{text:this.props.strings.critiqueExplanation("explanationTableSeparator"),style:n.LO(this.props.theme,this.props.fontTable),accessibilityRole:"text"}))}renderPlaceholder(e){return i.createElement(b,{key:e,style:n.i6()})}renderExplanationNonExampleText(e){return{explanationPartType:C.Exposition,data:[i.createElement(p.c,{key:0,text:e,style:n.MW(this.props.theme,this.props.fontTable),accessibilityRole:"text"})]}}renderExplanationText(e){const t=[];for(const o of e)switch(o.explanationPartType){case C.Exposition:o.data[0]&&t.push(o.data[0]);break;case C.Example:t.push(i.createElement(w,{style:n.PN(),accessibilityLabel:this.props.strings.critiqueExplanation("explanationTableAccessibilityLabel")},o.data))}return t}}var T=o(56360),x=o(88511),_=o(45306),I=o(67036);const E=e=>{const{brandingMode:t,theme:o}=e,n={useFluentV9:i.useContext(a.O)};switch(t){case S.nH.Text:const{strings:t,fontTable:r}=e,s=t.critique("microsoftEditorBranding"),a=_.ET(o,r,n),l=t.critique("microsoftEditorBrandingAccessibilityLabel"),c=i.createElement(p.c,{text:s,accessibilityLabel:l,style:a});return B(c);case S.nH.Icon:return B(i.createElement(f.E,{type:"Editor",primaryColor:_.C_(o,n)}));case S.nH.MonochromeIcon:return B(i.createElement(f.E,{type:"EditorSingleColor",primaryColor:_.C_(o,n)}));case S.nH.IconButton:return A(e,n);case S.nH.IconAndTextButton:return R(e,n);case S.nH.CustomImageAndText:return D(e,n);default:return i.createElement(i.Fragment,null)}},B=e=>i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:{paddingHorizontal:6,paddingVertical:6}},e),A=(e,t)=>{const{definition:o,strings:n,theme:r,automationId:s,onAction:a,fontTable:l,htmlId:c,hasKeyboardFocus:u,isDisabled:d,showPreviewTooltipForBranding:p,layerHostId:f}=e,m=_.m7(r,u,t),v=_.qv(l),b=p?n.critique("editorButtonCiqPreviewTooltipContent"):n.critique("editorButtonTooltipContent");return i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Stretch},M(o,m,v,n,void 0,void 0,b,s,a,c,d,u,f))},R=(e,t)=>{const{definition:o,strings:n,theme:r,automationId:s,onAction:a,fontTable:l,htmlId:c,hasKeyboardFocus:u,isDisabled:d,showPreviewTooltipForBranding:p,layerHostId:f}=e,m=_._s(r,u,t),v=_.Eq(l),b=n.critique("editorButtonText"),y=_.zB(l),w=p?n.critique("editorButtonCiqPreviewTooltipContent"):n.critique("editorButtonTooltipContent");return i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Stretch},M(o,m,v,n,b,y,w,s,a,c,d,u,f))},M=(e,t,o,n,r,s,a,l,c,u,d,h,g)=>{const p=I.g$(S._R.OpenEditorPane),f=void 0!==p?{type:p}:void 0,m={appearance:"subtle",onClick:()=>{null==c||c(S._R.OpenEditorPane,void 0,void 0)},title:r,titleRootStyle:s,tooltip:a,tooltipProps:g?{layerHostId:g}:void 0,disabled:d,style:o,theme:t,accessibilityLabel:I.T4(e,n,S._R.OpenEditorPane),automationLabel:I.HP(S._R.OpenEditorPane,l),icon:f,htmlId:u,hasKeyboardFocus:h};return i.createElement(T.J,Object.assign({},m,{key:S._R.OpenEditorPane.toString()}))},D=(e,t)=>{const{theme:o,fontTable:n,definition:r}=e;return r.brandingImageUri&&r.brandingText?i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Center,style:{paddingHorizontal:8,paddingVertical:8}},i.createElement(i.Fragment,null,i.createElement(x._,{uri:r.brandingImageUri,style:{width:20,height:20}}),i.createElement(g.S,{style:{paddingHorizontal:3}},i.createElement(i.Fragment,null)),i.createElement(p.c,{text:r.brandingText,style:_.pd(o,n,t)}))):i.createElement(i.Fragment,null)};var P=o(96204),F=o(87962),O=o(50752),N=o(3488),q=o(67026),j=o(32334);class L extends i.PureComponent{constructor(e){super(e),this.shouldFocusButtonOnUpdate=!1,this.buttonRef=i.createRef(),this.flyoutAnchorRef=i.createRef(),this.buttonId="FlyoutAnchor"+L.ids,L.ids+=1,this.handleClick=this.handleClick.bind(this),this.closeCallout=this.closeCallout.bind(this),this.onAccessibilityExpandCollapse=this.onAccessibilityExpandCollapse.bind(this),this.onPopoverOpenChange=this.onPopoverOpenChange.bind(this),this.state={calloutVisible:!1}}render(){var e,t,o,n;if(!this.context){const t=this.renderButton();if(this.state.calloutVisible){const o=null===(e=this.props.calloutStyle)||void 0===e?void 0:e.borderRadius,n={role:"dialog",target:"#"+this.buttonId,isBeakVisible:!1,ariaLabel:this.props.calloutAccessibilityLabel,setInitialFocus:!0,onDismiss:this.closeCallout,layerProps:this.props.layerHostId?{hostId:this.props.layerHostId}:void 0,styles:{beakCurtain:{borderRadius:o},calloutMain:{borderRadius:o},root:{borderRadius:o}}},r=i.createElement(j.P,Object.assign({},n),this.props.children);return i.createElement("div",{id:this.buttonId,style:{display:"flex"}},t,r)}return t}return i.createElement(O.A,{trapFocus:!0,inline:!0,open:this.state.calloutVisible,onOpenChange:this.onPopoverOpenChange,closeOnScroll:!1,positioning:{position:"below",align:"start",target:null===(o=null===(t=this.buttonRef.current)||void 0===t?void 0:t.getElementRef())||void 0===o?void 0:o.current}},i.createElement(N.W,null,i.createElement("div",{role:void 0,"aria-expanded":void 0,id:this.props.layerHostId,ref:this.flyoutAnchorRef,tabIndex:-1},this.renderButton())),i.createElement(q.H,{role:"dialog","aria-lable":this.props.calloutAccessibilityLabel,style:{padding:0,borderWidth:"0px",borderRadius:null===(n=this.props.calloutStyle)||void 0===n?void 0:n.borderRadius}},this.props.children))}componentDidUpdate(){var e;this.shouldFocusButtonOnUpdate&&(null===(e=this.buttonRef.current)||void 0===e||e.focus(),this.shouldFocusButtonOnUpdate=!1)}renderButton(){const e=Object.assign(Object.assign({},this.props.buttonProps),{htmlId:this.buttonId,onClick:this.context?this.props.buttonProps.onClick:this.handleClick,accessibilityState:this.state.calloutVisible,accessibilityRole:this.props.buttonAccessibilityRole||"button",tooltipProps:this.props.layerHostId?{layerHostId:this.props.layerHostId}:void 0});return this.state.calloutVisible&&e.theme&&e.theme.background.hover&&(e.theme=Object.assign(Object.assign({},e.theme),{background:Object.assign(Object.assign({},e.theme.background),{resting:e.theme.background.hover})})),i.createElement(T.J,Object.assign({},e,{onAccessibilityExpandCollapse:this.onAccessibilityExpandCollapse,ref:this.buttonRef}))}onPopoverOpenChange(e,t){t.open||(this.shouldFocusButtonOnUpdate=!0),this.setState((e=>Object.assign(Object.assign({},e),{calloutVisible:t.open})))}handleClick(){this.props.buttonProps.onClick&&this.props.buttonProps.onClick(),this.setState((e=>({calloutVisible:!e.calloutVisible})))}closeCallout(){this.shouldFocusButtonOnUpdate=!0,this.setState((e=>({calloutVisible:!1})))}onAccessibilityExpandCollapse(e){var t,o;"expand"===e&&this.state.calloutVisible||"collapse"===e&&!this.state.calloutVisible||(this.context?null===(o=(t=this.props.buttonProps).onClick)||void 0===o||o.call(t):this.handleClick())}}L.contextType=a.O,L.ids=0;var z=o(66466);function H(e,t){var o;return null!==(o="true"===(null==t?void 0:t[e]))&&void 0!==o&&o}function W(e,t){const o=I.g$(e);return!H("RenderFooterIcons",t)||!o||!(0,z.R)({type:o})}const U=e=>"footerButton"+e.toString();class G extends i.Component{constructor(e){super(e),this.defaultActionButtonRef=i.createRef(),this.overflowMenuRef=i.createRef(),this.overflowMenuRefV9=i.createRef(),this.isFirstTimeRendering=i.createRef(),this.actionIds=i.createRef(),this.state={actionIdShowAppearFocusMap:{}},this.addActionId=this.addActionId.bind(this),this.isFirstTimeRendering.current=!0}componentDidMount(){var e;this.props.setFooterActionIdList&&this.props.setFooterActionIdList(null!==(e=this.actionIds.current)&&void 0!==e?e:[]),this.isFirstTimeRendering.current=!1}componentDidUpdate(e,t){const{selectedButtonIndex:o}=this.props,i=e.selectedButtonIndex;o!==i&&(void 0!==i&&this.setState((e=>{if(null!==this.actionIds.current){const t=this.actionIds.current[i],o=Object.assign({},e.actionIdShowAppearFocusMap);return o[t]=!1,Object.assign(Object.assign({},this.state),{actionIdShowAppearFocusMap:o})}return e})),void 0!==o&&this.setState((e=>{if(null!==this.actionIds.current){const t=this.actionIds.current[o],i=Object.assign({},e.actionIdShowAppearFocusMap);return i[t]=!0,Object.assign(Object.assign({},this.state),{actionIdShowAppearFocusMap:i})}return e})))}render(){return i.createElement(g.S,{direction:h.PR.LeftToRight,style:this.getFooterStyle(),align:h.j5.Stretch},this.renderIcons(),i.createElement(g.S,{style:{flexibleSize:!0}}),this.props.definition.critiqueType===S.L9.AccColorChecker||this.props.definition.critiqueType===S.L9.AltText||this.props.definition.critiqueType===S.L9.MergeSplitCell||this.props.definition.critiqueType===S.L9.MissingTableHeader?this.renderFooterButton(S._R.Accessibility):null,this.renderBrandingOrPrevNextButton())}focus(){var e,t;this.defaultActionButtonRef.current?this.defaultActionButtonRef.current.focus():this.context?null===(e=this.overflowMenuRefV9.current)||void 0===e||e.focus():null===(t=this.overflowMenuRef.current)||void 0===t||t.focus()}openOverflowMenu(e){var t,o;this.context?null===(t=this.overflowMenuRefV9.current)||void 0===t||t.openMenu(e):null===(o=this.overflowMenuRef.current)||void 0===o||o.openMenu()}componentWillUnmount(){this.props.setFooterActionIdList&&this.props.setFooterActionIdList([]),this.isFirstTimeRendering.current=null}renderIcons(){return this.props.definition.onlyShowFeedbackButton?this.renderFeedbackIcon():i.createElement(i.Fragment,null,this.renderDefaultActionButtons(),this.renderExplanation(),this.renderOverflowMenu())}renderFeedbackIcon(){const{definition:e,strings:t,layerHostId:o,onAction:i,automationId:r}=this.props;return I.xt(e,S._R.Feedback)?(this.addActionId(S._R.Feedback),I.pj(e,this.getTheme(),n.Vn(this.props.footerButtonStyle),t,r,i,this.state.actionIdShowAppearFocusMap[S._R.Feedback],void 0,o)):null}addActionId(e){I.t$(this.props.definition,e)||this.isFirstTimeRendering.current&&(null===this.actionIds.current&&(this.actionIds.current=[]),this.actionIds.current.push(e))}renderOverflowMenu(){const{definition:e,layerHostId:t,strings:o,onAction:n,automationId:r}=this.props,{critiqueType:s,isContentPending:a}=e;if(s===S.L9.NeuralRewrite&&a||s===S.L9.NeuralRewrite&&H("renderNRForAIFeedback",this.props.settings)||s===S.L9.DictationCorrection)return null;const l=this.state.actionIdShowAppearFocusMap[S._R.Overflow],c=I.ms(e,this.getTheme(),o,this.getFontTable(),function(e,t){const{actions:o,critiqueType:i,flagType:n}=e;if(void 0===o||0===o.length)return[];const r=H("EnableFeedback",t),s=H("FirstActionTurnOffAccChecker",t);let a;switch(i){case S.L9.Spelling:a=[S._R.IgnoreOnce,W(S._R.AddToDictionary,t)?S._R.AddToDictionary:void 0,S._R.ToggleContext,S._R.ToggleDescription,S._R.Options,S._R.ManageLanguages];break;case S.L9.RepeatedWord:a=[S._R.ToggleContext,S._R.Options];break;case S.L9.Grammar:a=[S._R.IgnoreAll,S._R.IgnoreRule,S._R.ShowExplanation,S._R.ToggleContext,r&&W(S._R.Feedback,t)?S._R.Feedback:void 0,S._R.Options];break;case S.L9.Refinement:a=[S._R.IgnoreRule,S._R.ToggleContext,r&&W(S._R.Feedback,t)?S._R.Feedback:void 0,S._R.Options];break;case S.L9.TonalRewrite:a=[S._R.IgnoreAll,S._R.IgnoreRule,S._R.ToggleContext,S._R.Options];break;case S.L9.Topic:a=[S._R.IgnoreOnce,S._R.IgnoreRule,S._R.ToggleContext,S._R.Options];break;case S.L9.NeuralRewrite:a=[S._R.ToggleContext,S._R.ToggleDescription];break;case S.L9.SimilarityChecker:a=[S._R.Feedback,S._R.LearnMore];break;case S.L9.AccColorChecker:{const e=H("AllowTextColorIssueEnabled",t);a=[H("BulkFixTextColorIssuesEnabled",t)?S._R.FixAllColors:void 0,e?S._R.AllowAll:void 0,e||!s?S._R.TurnOffAccChecker:void 0,S._R.Feedback];break}case S.L9.AltText:case S.L9.MergeSplitCell:case S.L9.MissingTableHeader:a=[s?void 0:S._R.TurnOffAccChecker];break;case S.L9.InlineSuggestion:if(void 0!==n)switch(n){case S.z4.Location:case S.z4.SatoriEntity:a=[S._R.IgnoreRule,S._R.Feedback,S._R.ReadAloud,S._R.Options];break;case S.z4.File:case S.z4.Person:a=[S._R.IgnoreRule,S._R.IgnoreAll,S._R.ReadAloud,S._R.Options];break;case S.z4.Topic:a=[S._R.Feedback,S._R.Options];break;default:a=[]}a=[S._R.IgnoreRule,S._R.IgnoreAll,S._R.ReadAloud,S._R.Options];break;default:a=[]}return a.filter((e=>void 0!==e&&-1!==o.indexOf(e)))}(e,this.props.settings),H("NoTooltipForFooterOverflow",this.props.settings),o.critique("footerSeeMoreActionsAccessibilityLabel"),void 0,r,t,n,l,void 0,Object.assign(Object.assign({},this.props.overflowMenuButtonStyle),{calloutStyle:this.props.overflowMenuCalloutStyle}));return c?(this.addActionId(S._R.Overflow),i.createElement(P.o,Object.assign({ref:this.overflowMenuRef,refV9:this.overflowMenuRefV9},c,{icon:{type:"Overflow",filled:!0}}))):null}getTheme(e){var t;const o=null!==(t=this.props.theme)&&void 0!==t?t:this.context?n.ol:n.vy,i=o.altIcon;return e===S._R.Accessibility&&o.accessibilityIcon?Object.assign(Object.assign({},o),{altIcon:Object.assign(Object.assign({},i),{resting:o.accessibilityIcon})}):o}getBrandingTheme(){var e,t;return null!==(t=null===(e=this.props.theme)||void 0===e?void 0:e.branding)&&void 0!==t?t:_.m0(this.props.definition.brandingMode,{useFluentV9:!!this.context})}getFontTable(){var e;return null!==(e=this.props.fontTable)&&void 0!==e?e:n.d4}getFooterStyle(){var e;return null!==(e=this.props.footerContainerStyle)&&void 0!==e?e:n.Y_}renderFooterButton(e,t,o){var r;const{definition:s,strings:a,onAction:l,automationId:c}=this.props;if(!I.xt(s,e))return null;const u=I.a4(s,a,e);if(!u)return null;this.addActionId(e);const d=`CritiqueActionButton_${u}_${c}`,h=I.t$(s,e),g=e===S._R.IgnoreOnce||e===S._R.IgnoreAll?I.EH(s,a,this.getTheme(),h,e,void 0,{horizontalSpacing:null===(r=this.getFooterStyle())||void 0===r?void 0:r.paddingHorizontal}):void 0;if(!this.shouldRenderFooterIconActionInOverflow(e))return I.o2(s,this.getTheme(e),e,n.Vn(this.props.footerButtonStyle),a,void 0,void 0,void 0,u,d,t?this.defaultActionButtonRef:void 0,g,c,l,!0,U(e),this.state.actionIdShowAppearFocusMap[e],o,void 0,this.props.layerHostId);const p={appearance:"subtle",title:u,titleStyle:n.Dd(this.getFontTable(),u.length),onClick:()=>{null==l||l(e)},style:n.Vn(this.props.footerButtonStyle),theme:n.P4(this.getTheme(e)),automationLabel:d,disabled:h};return i.createElement(T.J,Object.assign({key:e,ref:this.defaultActionButtonRef},p))}renderDefaultActionButtons(){const{definition:e,strings:t,onAction:o,automationId:r}=this.props,{critiqueType:s}=e,a=function(e,t){const{actions:o,critiqueType:i,isContentPending:n,flagType:r}=e;if(void 0===o||0===o.length)return[];const s=I.rj(i,r),a=H("EnableFeedback",t),l=H("FirstActionTurnOffAccChecker",t);let c;switch(i){case S.L9.Refinement:case S.L9.Topic:const o=[s];I.xt(e,S._R.Feedback)&&(W(S._R.Feedback,t)&&i!==S.L9.Topic||o.push(S._R.Feedback)),c=o;break;case S.L9.Spelling:c=[s,I.xt(e,S._R.Feedback)&&!W(S._R.Feedback,t)?S._R.Feedback:void 0,W(S._R.AddToDictionary,t)?void 0:S._R.AddToDictionary];break;case S.L9.AccColorChecker:{const e=H("AllowTextColorIssueEnabled",t),o=[];e&&o.push(S._R.Allow),!e&&l&&o.push(S._R.TurnOffAccChecker),o.push(S._R.OpenColorPicker),c=o;break}case S.L9.AltText:case S.L9.MissingTableHeader:case S.L9.MergeSplitCell:c=[l?S._R.TurnOffAccChecker:void 0];break;case S.L9.RepeatedWord:case S.L9.SimilarityChecker:case S.L9.DictationCorrection:case S.L9.TextPenAlternates:c=[s];break;case S.L9.Grammar:c=[s,a&&!W(S._R.Feedback,t)?S._R.Feedback:void 0];break;case S.L9.TonalRewrite:c=[s,a?S._R.Feedback:void 0];break;case S.L9.NeuralRewrite:n&&(c=[]),c=0===I.KW(e).length?[S._R.Dismiss]:[S._R.Feedback];break;case S.L9.InlineSuggestion:if(void 0!==r)switch(r){case S.z4.Location:case S.z4.SatoriEntity:case S.z4.Topic:c=[s];break;case S.z4.File:case S.z4.Person:c=[s,S._R.Feedback];break;default:c=[]}else c=[s,I.xt(e,S._R.Feedback)&&!W(S._R.Feedback,t)?S._R.Feedback:void 0];break;case S.L9.AddinCritique:c=[s];break;default:c=[]}return c.filter((e=>void 0!==e&&-1!==o.indexOf(e)))}(e,this.props.settings);return s!==S.L9.NeuralRewrite?i.createElement(i.Fragment,null,a.map(((e,t)=>e===S._R.OpenColorPicker?this.renderFooterButton(S._R.OpenColorPicker,0===t,"ACCF2E3E-7EC7-46DF-AB25-A1AFEDBC6B7B"):this.renderFooterButton(e,0===t))),s===S.L9.AltText&&this.renderFooterButton(S._R.MarkAsDecorative),s===S.L9.MissingTableHeader&&this.renderFooterButton(S._R.MarkAsLayout)):0===a.length?i.createElement(F.v,{shimmerCount:1,styles:n.ys(this.getSpacing())}):i.createElement(i.Fragment,null,a.map((i=>i===S._R.Dismiss?(this.addActionId(i),I.o2(e,this.getTheme(i),S._R.Dismiss,n.nV(this.getFontTable()),t,void 0,void 0,void 0,void 0,void 0,this.defaultActionButtonRef,void 0,r,o,void 0,void 0,void 0,void 0,void 0,this.props.layerHostId)):this.renderFooterButton(i))))}renderExplanation(){const{automationId:e,footerButtonStyle:t,layerHostId:o,onAction:r,overflowMenuCalloutStyle:s,strings:a,style:l}=this.props,c=Object.assign({},this.props.definition),u=this.getTheme(),d=this.getFontTable();if(!c.explanationTitle||!c.explanation)return null;const h={appearance:"subtle",onClick:()=>{null==r||r(S._R.ShowExplanation)},style:n.uY(d,t),theme:n.P4(u,void 0,!0),tooltip:I.a4(c,a,S._R.ShowExplanation),accessibilityLabel:I.T4(c,a,S._R.ShowExplanation),automationLabel:`CritiqueExplanationButton_${e}`,icon:{type:"ShowExplanation",filled:!0},tooltipProps:{layerHostId:o}};this.addActionId(S._R.ShowExplanation);const g={definition:c,strings:a,style:l,theme:u,fontTable:d};return i.createElement(L,{calloutAccessibilityLabel:a.critique("explanationFlyoutAccessibilityLabel"),calloutStyle:s,layerHostId:o,buttonAccessibilityRole:"button",buttonProps:h,showCloseButton_DONOTUSE:!0,closeButtonAccessibilityLabel_DONOTUSE:a.critique("explanationFlyoutCloseLabel")},i.createElement(k,Object.assign({},g)))}renderBrandingOrPrevNextButton(){const{definition:e,showPreviewTooltipForBranding:t}=this.props,{brandingMode:o}=e;if(I.OF(e))return this.renderPrevNextButtons();if(void 0===o)return null;const{strings:n,automationId:r,layerHostId:s,onAction:a}=this.props,l=I.t$(e,S._R.OpenEditorPane);return o!==S.nH.IconButton&&o!==S.nH.IconAndTextButton||this.addActionId(S._R.OpenEditorPane),i.createElement(E,{strings:n,theme:this.getBrandingTheme(),fontTable:this.getFontTable(),definition:e,automationId:r,brandingMode:o,onAction:a,htmlId:U(S._R.OpenEditorPane),hasKeyboardFocus:l?void 0:this.state.actionIdShowAppearFocusMap[S._R.OpenEditorPane],isDisabled:l,showPreviewTooltipForBranding:t,layerHostId:s})}renderPrevNextButtons(){if(!I.xt(this.props.definition,S._R.Previous)||!I.xt(this.props.definition,S._R.Next))return null;const e=n.nV(this.getFontTable()),t=!H("NoTooltipForPrevNext",this.props.settings);return this.addActionId(S._R.Previous),this.addActionId(S._R.Next),i.createElement(g.S,{direction:h.PR.LeftToRight,align:h.j5.Stretch},I.o2(this.props.definition,this.getTheme(),S._R.Previous,e,this.props.strings,void 0,void 0,void 0,t?I.a4(this.props.definition,this.props.strings,S._R.Previous):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,!0,U(S._R.Previous),this.state.actionIdShowAppearFocusMap[S._R.Previous],void 0,void 0,this.props.layerHostId),I.o2(this.props.definition,this.getTheme(),S._R.Next,e,this.props.strings,void 0,void 0,void 0,t?I.a4(this.props.definition,this.props.strings,S._R.Next):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,!0,U(S._R.Next),this.state.actionIdShowAppearFocusMap[S._R.Next],void 0,void 0,this.props.layerHostId))}shouldRenderFooterIconActionInOverflow(e){const t=I.g$(e);return!H("RenderFooterIcons",this.props.settings)||!t||!(0,z.R)({type:t})}getSpacing(){var e;return null!==(e=this.props.spacing)&&void 0!==e?e:n.lT}}G.contextType=a.O},47050:(e,t,o)=>{"use strict";o.d(t,{J:()=>g});var i=o(95734);if(3023==o.j)var n=o(56360);if(3023==o.j)var r=o(78607);if(3023==o.j)var s=o(86399);if(3023==o.j)var a=o(7313);if(3023==o.j)var l=o(68803);if(3023==o.j)var c=o(78585);if(3023==o.j)var u=o(8871);if(3023==o.j)var d=o(40960);if(3023==o.j)var h=o(6284);const g=e=>{var t,o,g,p,f,m,v;const b=new Map([["EditorWithStars","EditorWithStarsAnimated"],["EditorWithStarsDarkMode","EditorWithStarsDarkModeAnimated"]]),[y,w]=i.useState(0),C=i.useRef(!0);i.useEffect((()=>{C.current&&(C.current=!1)}));const{theme:S,styles:k,animated:T,strings:x}=e,_=(0,d.v)(),I=C.current&&null!=T&&T,E=e.pages[y].icon,B=()=>{y>0&&w(y-1)},A=()=>{y<e.pages.length-1&&w(y+1)};return i.createElement(a.S,{style:Object.assign(Object.assign(Object.assign({},_.containerStyle),{paddingEnd:e.onDismiss?28:_.containerStyle.paddingEnd,borderRadius:null!==(o=null===(t=null==k?void 0:k.container)||void 0===t?void 0:t.borderRadius)&&void 0!==o?o:_.containerStyle.borderRadius,minWidth:null!==(p=null===(g=null==k?void 0:k.container)||void 0===g?void 0:g.minWidth)&&void 0!==p?p:_.containerStyle.minWidth,maxWidth:null!==(m=null===(f=null==k?void 0:k.container)||void 0===f?void 0:f.maxWidth)&&void 0!==m?m:_.containerStyle.maxWidth,backgroundImage:null!==(v=null==S?void 0:S.background)&&void 0!==v?v:"#FFFFFF"}),null==k?void 0:k.container)},i.createElement(a.S,{style:Object.assign(Object.assign({},_.dismissContainerStyle),null==k?void 0:k.dismissContainerStyle)},(()=>{if(e.onDismiss)return i.createElement(n.J,{theme:{background:{resting:"transparent"},title:{resting:"transparent"}},style:_.buttonStyle,onClick:e.onDismiss,automationLabel:""},i.createElement(r.E,{type:"Cancel",primaryColor:null==S?void 0:S.dismissColor,fontSize:12,fontWeight:s.IT.Bold}))})()),i.createElement(a.S,{direction:l.PR.LeftToRight,style:{zIndex:1}},(()=>{var t;if(e.hideIcon)return;const o=I&&null!==(t=b.get(E))&&void 0!==t?t:E;return i.createElement(a.S,{style:_.iconContainerStyle,justifyContent:l.Pr.SpaceBetween},i.createElement(r.E,{type:o,primaryColor:null==S?void 0:S.iconColor}))})(),i.createElement(a.S,{justifyContent:l.Pr.SpaceBetween,style:Object.assign(Object.assign({},_.textContainerStyle),null==k?void 0:k.textContainerStyle)},i.createElement(a.S,{direction:l.PR.LeftToRight,align:l.j5.Center},(()=>{var t,o;const n=e.pages[y].newTag;if(n)return i.createElement(a.S,{style:Object.assign(Object.assign({},_.newTagContainerStyle),{backgroundColor:null!==(t=null==S?void 0:S.newTag.background)&&void 0!==t?t:"#FFFFFF",boxShadow:null==S?void 0:S.newTag.shadow})},i.createElement(c.c,{style:Object.assign(Object.assign({},_.newTagTextStyle),{cssColor:null!==(o=null==S?void 0:S.newTag.textColor)&&void 0!==o?o:"#000000"}),text:n}))})(),(()=>{const t=e.pages[y].title;if(t)return i.createElement(a.S,{style:_.titleContainerStyle},i.createElement(c.c,{style:Object.assign(Object.assign({},_.titleTextStyle),{cssColor:null==S?void 0:S.textColor}),text:t}))})()),e.pages[y].content(_.contentContainerStyle,S))),(()=>{var t,o,s;if(1===e.pages.length)return;let u=null==S?void 0:S.pagination.textColor,d=null==S?void 0:S.pagination.textColor;return 0===y?u=null==S?void 0:S.pagination.arrow.disabledButtonColor:y===e.pages.length-1&&(d=null==S?void 0:S.pagination.arrow.disabledButtonColor),i.createElement(a.S,{style:Object.assign(Object.assign({},_.pageArrowContainerStyle),{zIndex:1}),direction:l.PR.LeftToRight,justifyContent:l.Pr.Center,align:l.j5.Center},i.createElement(n.J,{theme:{background:{resting:null!==(t=null==S?void 0:S.pagination.arrow.background.resting)&&void 0!==t?t:"transparent",hover:null==S?void 0:S.pagination.arrow.background.hover},title:{resting:"transparent"},tooltip:{backgroundColor:null==S?void 0:S.tooltip.background,textColor:null==S?void 0:S.tooltip.textColor}},style:_.buttonStyle,onClick:B,tooltip:x.footer("previousPageTooltip"),automationLabel:"",tooltipProps:{layerHostId:e.layerHostId}},i.createElement(r.E,{type:"Previous",primaryColor:u})),i.createElement(c.c,{style:Object.assign(Object.assign({},_.paginationTextStyle),{cssColor:null!==(o=null==S?void 0:S.pagination.textColor)&&void 0!==o?o:"black"}),text:(0,h.JT)(x.footer("paginationTipsText"),y+1,e.pages.length)}),i.createElement(n.J,{theme:{background:{resting:null!==(s=null==S?void 0:S.pagination.arrow.background.resting)&&void 0!==s?s:"transparent",hover:null==S?void 0:S.pagination.arrow.background.hover},title:{resting:"transparent"},tooltip:{backgroundColor:null==S?void 0:S.tooltip.background,textColor:null==S?void 0:S.tooltip.textColor}},style:_.buttonStyle,onClick:A,tooltip:x.footer("nextPageTooltip"),automationLabel:"",tooltipProps:{layerHostId:e.layerHostId}},i.createElement(r.E,{type:"Next",primaryColor:d})))})(),(()=>{if(I)return i.createElement(u.w,{theme:null==S?void 0:S.shimmer})})())}},40960:(e,t,o)=>{"use strict";if(o.d(t,{v:()=>n}),3023==o.j)var i=o(86399);const n=()=>({containerStyle:{position:"relative",borderRadius:8,paddingVertical:14,paddingStart:12,paddingEnd:12,maxWidth:309,minWidth:309,overflow:"hidden"},dismissContainerStyle:{position:"absolute",top:12.65,right:12.65,zIndex:2},iconContainerStyle:{marginEnd:12},textContainerStyle:{maxWidth:220},newTagContainerStyle:{borderRadius:3,paddingHorizontal:4,paddingVertical:2,marginEnd:8,marginBottom:4},newTagTextStyle:{fontSize:10,lineHeight:12},titleContainerStyle:{marginBottom:4},titleTextStyle:{fontSize:12,lineHeight:16,fontWeight:i.IT.SemiBold},contentContainerStyle:{fontSize:12,lineHeight:1.25},tryLinkContainerStyle:{marginTop:10},pageArrowContainerStyle:{marginTop:14,width:"100%"},paginationTextStyle:{fontSize:12,lineHeight:16,fontWeight:i.IT.SemiBold,marginHorizontal:13,marginVertical:0},buttonStyle:{paddingHorizontal:0,paddingVertical:0}})},7869:(e,t,o)=>{"use strict";function i(e){return function(e,t){return!!e.settings&&"true"===e.settings.RefactorToGetRewriteNudgeInCritiqueV2}(e)}o.d(t,{Z:()=>i})},17011:(e,t,o)=>{"use strict";if(o.d(t,{_:()=>E}),3023==o.j)var i=o(16971);if(3023==o.j)var n=o(36694);if(3023==o.j)var r=o(7313);if(3023==o.j)var s=o(68803);if(3023==o.j)var a=o(59621);if(3023==o.j)var l=o(20193);if(3023==o.j)var c=o(82512);if(3023==o.j)var u=o(93923);if(3023==o.j)var d=o(48545);if(3023==o.j)var h=o(26483);var g=o(95734);if(3023==o.j)var p=o(54651);if(3023==o.j)var f=o(72388);if(3023==o.j)var m=o(45216);if(3023==o.j)var v=o(6255);if(3023==o.j)var b=o(5823);if(3023==o.j)var y=o(317);if(3023==o.j)var w=o(37582);if(3023==o.j)var C=o(44357);if(3023==o.j)var S=o(68937);if(3023==o.j)var k=o(93098);if(3023==o.j)var T=o(36382);const x="eccSuggestionsListEnclosingDiv",_="eccFeedbackButton",I="eccMenuTrigger",E=({definition:e,theme:t,style:o,styles:E,strings:B,layerHostId:A,queryString:R,results:M,scopes:D,isError:P,isLoading:F,enablePrefixHighlighting:O,keyboardHandlerTarget:N,expandedKeyboardHandlerTarget:q,showMoreEntitiesConfig:j,browseThisComputerConfig:L,listID:z,disableTooltips:H,isFeedbackEnabledForEcc:W,isSmallWindow:U,isSmallHeight:G,enableResponsiveLayout:V,refocus:$,showPartialLoadingEntities:K,themeType:J,onGroupSelected:Y,onAction:Q,onFocusSuggestionListEnclosure:Z,onFocusSuggestionList:X,onItemSelected:ee,onItemFocused:te,onAfterUpdate:oe,noSuggestionsHeaderInfo:ie,expandedEccSearchBarConfig:ne,showMeetingBanner:re,enableMeetingBanner:se,meetingBannerText:ae,isFeedbackButtonEnabled:le,onFeedbackButtonClicked:ce,isUnsupported:ue,locale:de,useFURNTabList:he,moveSelectionOnHover:ge})=>{var pe,fe,me,ve,be;const ye=!!W&&!le,we=g.useContext(i.O),Ce=g.useContext(i.b),[Se,ke]=g.useState(!1),Te=()=>{ke(!Se)},xe=M.every((e=>!e.suggestions||0===e.suggestions.length)),[_e,Ie]=g.useState([]),Ee=g.useCallback((e=>{e.type===C.E9?e.id===C.Es?null==Q||Q(b.L.Retry):e.id===C.WM&&(rt(""),null==Q||Q(b.L.ClearSearch)):ee(e)}),[Q,ee]),Be=null!=t?t:T.nk(void 0,we,Ce),Ae=null!=o?o:y.Ss,Re=(0,v.WT)(E,Ae,U&&V),Me=g.useRef(null),De=g.useRef(null),Pe=g.useRef(null),Fe=g.useRef(null),Oe=g.useRef(null),Ne=g.useRef(null),qe=g.useRef(null),je=g.useRef({groupLayouts:[]}),[Le,ze]=g.useState({value:0}),[He,We]=g.useState({value:-1}),[Ue,Ge]=g.useState(!1),[Ve,$e]=g.useState(!1),[Ke,Je]=g.useState(!1),[Ye,Qe]=g.useState(!0),[Ze,Xe]=g.useState(!1),[et,tt]=g.useState(),[ot,it]=g.useState(!1),[nt,rt]=g.useState(""),[st,at]=g.useState(!1),[lt,ct]=g.useState(!1),ut=g.useRef(!0),[dt,ht]=g.useState(!1),[gt,pt]=g.useState(!1),ft=g.useRef(null),mt=_e.reduce(((e,t)=>t.suggestions.length+e),0),vt=g.useCallback((e=>{Qe(e),e&&(null==X||X())}),[X,Qe]),bt=g.useCallback((e=>{ee(e),vt(!0),We({value:Et(He.value,-1)}),ze({value:Bt(He.value,0)})}),[ee]);g.useEffect((()=>{if(-1===Le.value)return void(De.current=null);let e=0;for(const t of _e)e++,Le.value>=e&&Le.value<e+t.suggestions.length&&(De.current=t.suggestions[Le.value-e]),e+=t.suggestions.length}),[Le,_e]),g.useEffect((()=>{!F&&Ie((0,C.Oz)(F,P,xe,B,M,ie,ue))}),[F,P,xe,B,M,ie,ue]),g.useEffect((()=>{F||ot&&(null==L?void 0:L.isBrowseThisComputerEnabled)||(Ye&&(Bt(Le.value,0),ze({value:0})),Et(He.value,-1),We({value:-1}))}),[F,ot,Ye,$,_e,L]),g.useEffect((()=>{Ue&&tt({top:0,bottom:0,isNewRender:!1})}),[Ue]),g.useEffect((()=>{Ve&&tt({top:0,bottom:0,isNewRender:!1})}),[Ve]),g.useEffect((()=>{Me.current&&(clearTimeout(Me.current),Me.current=null),F?_e&&_e.length?Me.current=setTimeout((()=>Xe(!0)),C.al):Xe(!0):Xe(!1)}),[F,_e]),g.useEffect((()=>{oe&&e&&oe(e)}));const yt=g.useCallback((e=>{null==te||te({focusedItemHtmlId:e})}),[te]),wt=()=>yt(_),Ct=()=>{var e;null==te||te({focusedItemHtmlId:null!==(e=null==j?void 0:j.searchBoxHtmlId)&&void 0!==e?e:"eccSearchBoxFocus",selection:{type:"searchBox"}})},St=e=>{yt(e)},kt=g.useCallback((()=>{yt(x),null==Z||Z()}),[te]),Tt=()=>{yt("eccUploadFileTriggerButton"),Ge(!0),$e(!1),Je(!1),Qe(!1)},xt=g.useCallback(((e,t)=>{t.type===C.E9?t.id===C.Es?null==te||te({focusedItemHtmlId:C.E9,selection:{type:"retryButton"}}):t.id===C.WM&&(null==te||te({focusedItemHtmlId:C.E9,selection:{type:"clearSearchButton"}})):null==te||te({focusedItemHtmlId:(0,C.Bn)(e),selection:{type:"item",item:t,positionInSet:e,setSize:mt}})}),[te,mt]),_t=(e,t)=>{var o,i,n,r,s;let a=0;const l={top:0,bottom:0};for(let c=0;c<_e.length;c++){const u=_e[c];l.top=l.bottom+(null===(o=je.current.groupLayouts[c])||void 0===o?void 0:o.separatorHeight),l.bottom=l.top+(null===(i=je.current.groupLayouts[c])||void 0===i?void 0:i.headerHeight);for(let o=0;o<u.suggestions.length;o++){const i=u.suggestions[o];if(0!==o&&(l.top=l.bottom),l.bottom=l.bottom+(null!==(r=null===(n=je.current.groupLayouts[c])||void 0===n?void 0:n.itemHeights[o])&&void 0!==r?r:0),o===u.suggestions.length-1&&(l.bottom+=null===(s=je.current.groupLayouts[c])||void 0===s?void 0:s.extraSpaceBottomHeight),e===a)return i.isHighlighted=t,t&&(tt(Object.assign(Object.assign({},l),{isNewRender:ut.current})),ut.current=!1,xt(e,i)),void Ie((e=>(c<e.length&&(e[c].isHighlighted=t),e)));a++}}},It=(e,t)=>{e>=0&&e<D.suggestions.length&&(D.suggestions[e].isHighlighted=t)},Et=(e,t)=>(e>=0&&It(e,!1),t<0?-1:(t%=D.suggestions.length,It(t,!0),null==te||te({focusedItemHtmlId:(0,C.Bn)(t,!0),selection:{type:"scope",scope:D.suggestions[t],positionInSet:t,setSize:D.suggestions.length}}),t)),Bt=(e,t)=>(e>=0&&_t(e,!1),t<0?-1:(_t(t%=mt,!0),t)),At=g.useCallback((()=>{var e;null===(e=null==qe?void 0:qe.current)||void 0===e||e.focus()}),[qe]),Rt=e=>Dt(e,!1),Mt=(e,t,o)=>{var i;return console.debug("key",e,"shift",o),e!==n.h.Tab?Dt(e,o):!o&&!(null===(i=Oe.current)||void 0===i?void 0:i.isFocusWithin())&&(At(),!0)},Dt=(e,t)=>{var o,i;if(e!==n.h.ArrowDown&&e!==n.h.ArrowUp&&e!==n.h.ArrowLeft&&e!==n.h.ArrowRight&&e!==n.h.Enter&&e!==n.h.Tab&&e!==n.h.Home&&e!==n.h.End)return!1;if(e===n.h.Tab)return!t;switch(e){case n.h.ArrowDown:if(Le.value!==mt-1){ct(!0);const e=Bt(Le.value,Le.value+1);ze({value:e})}return!0;case n.h.ArrowUp:return ct(!0),0===Le.value||ze({value:Bt(Le.value,Le.value-1)}),!0;case n.h.Home:ct(!0),ze({value:Bt(Le.value,0)});break;case n.h.End:ct(!0),ze({value:Bt(Le.value,mt-1)});break;case n.h.Enter:if(!(null===(o=Ne.current)||void 0===o?void 0:o.isFocusWithin())&&((null===(i=Oe.current)||void 0===i?void 0:i.isFocusWithin())||gt))return!1;if(F&&De.current)Ee(De.current);else{let e=0;_e.forEach((t=>{Le.value>=e&&Le.value<e+t.suggestions.length&&Ee(t.suggestions[Le.value-e]),e+=t.suggestions.length}))}break;case n.h.ArrowLeft:case n.h.ArrowRight:default:return!1}return!0},Pt=g.useCallback((e=>e.key!==n.h.Tab&&!N&&!q&&Dt(e.key,e.shift)),[Dt]),Ft=g.useCallback((e=>{if(ge){let t=0;_e.every((o=>{let i=!0;return o.suggestions.every((o=>(o===e&&(ze({value:Bt(Le.value,t)}),i=!1),t++,i))),i}))}}),[ge,M,Le,ze,Bt]),Ot=g.useCallback((e=>{e(je.current)}),[]);g.useEffect((()=>void 0!==q?(q.setKeyPressHandler(Mt),()=>{q.setKeyPressHandler(void 0)}):(null==N||N.setKeyPressHandler(Rt),()=>{null==N||N.setKeyPressHandler(void 0)})));const Nt=Re.containerStyles||{},{paddingStart:qt,paddingEnd:jt,paddingHorizontal:Lt,paddingTop:zt,paddingBottom:Ht,paddingVertical:Wt,paddingScrollTop:Ut,scrollbarThumbWidth:Gt}=Nt,Vt=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(Nt,["paddingStart","paddingEnd","paddingHorizontal","paddingTop","paddingBottom","paddingVertical","paddingScrollTop","scrollbarThumbWidth"]),$t=(null==j?void 0:j.isShowMoreEntitiesEnabled)&&!ot&&!(P||xe||ue),Kt=G?"30%":250,Jt=D.suggestions.findIndex((e=>e.isSelected)),[Yt,Qt]=g.useState(null===(pe=D.suggestions[Jt])||void 0===pe?void 0:pe.id);g.useEffect((()=>{var e;Qt(null===(e=D.suggestions[Jt])||void 0===e?void 0:e.id)}),[Jt]);const Zt=D.suggestions.map((e=>{var t;return{label:null!==(t=e.title)&&void 0!==t?t:"",tabKey:e.id,overflowPriority:e.id===Yt?1:0}})),Xt=g.useCallback((e=>{for(let t=0;t<D.suggestions.length;t++)if(D.suggestions[t].id===e){bt(D.suggestions[t]);break}Qt(e)}),[D,bt,Qt]),eo=(0,v.QI)(J,null==E?void 0:E.accentColors,null==t?void 0:t.accentColors);return g.createElement(r.S,{style:Object.assign(Object.assign(Object.assign({},p.uI(Be,void 0,{useFluentV9:we})),Vt),{hideFocusBox:!0,backgroundColor:Be.background.resting}),align:s.j5.Stretch,focusable:!0,ref:Oe,onKeyDown:Pt,handledKeys:[n.h.ArrowDown,n.h.ArrowUp,n.h.ArrowLeft,n.h.ArrowRight,n.h.Enter,n.h.Home,n.h.End],accessibilityRole:Ze||P||xe||ue?void 0:"application",accessible:!0,accessibilityLabel:B.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel"),nativeID:z},g.createElement(r.S,{style:Ce?{minHeight:48,marginHorizontal:12}:{minHeight:44,marginVertical:2,marginEnd:12},ref:Pe,direction:s.PR.LeftToRight,align:s.j5.Center,justifyContent:Ce?s.Pr.SpaceBetween:void 0},he?g.createElement(r.S,{accessibilityRole:"tablist",direction:s.PR.LeftToRight,align:s.j5.Center,accessible:!0,ref:Fe,style:{flexibleSize:!0}},g.createElement(a.w,Object.assign({overflow:!0,selectedKey:Yt,onTabSelect:Xt,onOverflowOpenChange:e=>{pt(e)},onMenuItemFocus:e=>{yt(`eccMenuItem-${e}`)},onOverflowTriggerFocus:()=>{yt(I)}},Ce?{cssProperties:eo}:{theme:T.T_(Be),style:y.vC(Re)},{items:Zt,ref:qe,moreButtonQuantityText:B.inlineSuggestions("moreButtonQuantityText")}))):g.createElement(r.S,{accessibilityRole:"tablist",direction:s.PR.LeftToRight,align:s.j5.Center,accessible:!0,ref:Fe},g.createElement(f.U,{theme:Be,headerRef:Pe,headerScopesRef:Fe,styles:(0,v.oM)(E,Ae),overflowUid:I,strings:B,scopes:D,groupLayouts:je.current.groupLayouts,itemQueryString:R,onGroupSelected:Y,onItemSelected:bt,isOverflowHighlighted:dt,isOverflowMenuOpened:gt,onOverflowClose:e=>{var t;e||(null===(t=ft.current)||void 0===t||t.focus(),ht(!1),vt(!0),We({value:Et(He.value,-1)})),pt(!1)},enablePrefixHighlighting:O,hasSelectionBeenModifiedViaKeyboard:lt,layerHostId:A,isFeedbackEnabledForEcc:ye,isSmallWindow:U,enableResponsiveLayout:V})),(null==L?void 0:L.isUploadFileButtonEnabled)||le?g.createElement(l.q.Consumer,null,(e=>{var t,o;return g.createElement(r.S,{nativeID:"uploadFileButtonContainer",direction:Ce?s.PR.LeftToRight:void 0,style:he?{}:e?{position:"absolute",left:12}:{position:"absolute",right:12}},g.createElement(r.S,{accessibilityRole:Ce?"group":"menu",accessibilityLabel:null==B?void 0:B.inlineSuggestions("expandedInlineSuggestionsFeedbackButtonAndUploadButtonGroupLabel"),accessible:!0,direction:s.PR.LeftToRight,align:s.j5.Center,justifyContent:Ce?s.Pr.End:void 0},!Ce&&le?g.createElement(c.u,{handledKeys:[n.h.Enter,n.h.Tab,n.h.ArrowDown,n.h.ArrowUp,n.h.Home,n.h.End],onKeyDown:Pt,htmlId:_,style:y.gl,accessibilityRole:"menuitem",accessibilityLabel:B.inlineSuggestions("feedbackText"),automationLabel:"InlineSuggestionsFeedback",icon:{type:"ECCFeedback",style:y.p},title:void 0,onClick:ce,onFocus:wt,theme:T.$d(Be,Ke),isSelectedByKeyboard:lt}):null,(null==L?void 0:L.isUploadFileButtonEnabled)?g.createElement(k.Y,Object.assign({handledKeys:[n.h.Enter,n.h.Tab,n.h.Home,n.h.End,n.h.ArrowDown,n.h.ArrowUp],containerElement:null!==(o=null===(t=null==Oe?void 0:Oe.current)||void 0===t?void 0:t.el())&&void 0!==o?o:null,onKeyDown:Pt,strings:B,isUploadButtonHighlighted:Ue,hasSelectionBeenModifiedViaKeyboard:lt,theme:T.wK(Be,Ue),iconOnly:U&&V,open:Se,onOpenChange:Te,onTriggerButtonFocus:Tt,onMenuItemFocus:St,accentSuggestionColors:eo},L)):null,Ce&&le?g.createElement(u.O,{accentSuggestionColors:eo,accessibilityLabel:B.inlineSuggestions("feedbackText"),htmlId:_,style:y.Qf,onClick:ce,onFocus:wt,theme:T.$d(Be,Ke),isSelectedByKeyboard:lt,icon:we?void 0:{type:"ECCFeedback",style:y.p}}):null))})):null),g.createElement(d.w,null),ot&&g.createElement(r.S,{direction:s.PR.LeftToRight},g.createElement(r.S,{style:{flexibleSize:!1}},g.createElement(c.u,{style:y.Ek,automationLabel:"InlineSuggestionBackButton",onClick:()=>{var e;it(!1),null===(e=null==j?void 0:j.onCloseShowMoreEntities)||void 0===e||e.call(j,!1),ze({value:0})},theme:T.VD(Be),icon:{type:"ChevronLeftMed",style:y.dt}}),g.createElement(S.y,{theme:Be,style:null==E?void 0:E.searchBoxStyles,htmlId:null==j?void 0:j.searchBoxHtmlId,autoFocus:!0,handledKeys:[n.h.ArrowDown,n.h.ArrowUp,n.h.Enter,n.h.Tab,n.h.Home,n.h.End],onKeyDown:Pt,placeholder:(null==j?void 0:j.searchBoxPlaceHolder)||"",value:nt,onValueChange:e=>{var t;rt(e),null===(t=null==j?void 0:j.onSearchChange)||void 0===t||t.call(j,e)},onClear:()=>{var e;rt(""),null===(e=null==j?void 0:j.onSearchClear)||void 0===e||e.call(j)},onSearchFocus:Ct}))),(null==ne?void 0:ne.enableExpandedECCSearchBar)&&g.createElement(r.S,{direction:s.PR.LeftToRight},g.createElement(m.V,{placeholder:(null==B?void 0:B.inlineSuggestions("expandedInlineSuggestionsSearchBarPlaceholder"))||"",onValueChange:e=>{var t;rt(e),null===(t=null==ne?void 0:ne.onSearchChange)||void 0===t||t.call(ne,e)},onClear:()=>{var e;rt(""),null===(e=null==ne?void 0:ne.onSearchClear)||void 0===e||e.call(ne)},dismiss:null,accessibilityLabel:(null==B?void 0:B.inlineSuggestions("expandedInlineSuggestionsSearchBarPlaceholder"))||"",theme:Be,style:Ae,htmlId:null==ne?void 0:ne.searchBoxHtmlId,autoFocus:null==ne?void 0:ne.autoFocus,handledKeys:[n.h.ArrowDown,n.h.ArrowUp,n.h.Enter,n.h.Tab,n.h.Home,n.h.End],onKeyDown:Pt,value:nt,showIcon:!0,isSearchBoxHighlighted:Ve,hideDismiss:ne.hideDismiss,onSearchFocus:Ct})),g.createElement(r.S,{nativeID:x,accessible:!0,accessibilityLabel:(0===Jt?`${B.inlineSuggestions("startTypingToSearch")} `:"").concat((null!==(fe=B.inlineSuggestions("tabAriaLabel"))&&void 0!==fe?fe:"{0} tab, press alt + down to change tabs").replace("{0}",null!==(ve=null===(me=D.suggestions[Jt])||void 0===me?void 0:me.title)&&void 0!==ve?ve:"")),accessibilityRole:"menu",ref:Ne,focusable:!0,onFocus:kt,style:{position:"relative",maxHeight:Kt,backgroundColor:Be.background.resting}},g.createElement(h.B,{scrollDirection:"vertical",style:{paddingStart:qt,paddingEnd:jt,paddingHorizontal:Lt,paddingTop:zt,paddingBottom:Ht,paddingVertical:Wt,paddingScrollTop:Ut,scrollbarThumbWidth:Gt,borderRadius:Vt.borderRadius,width:"100%"},theme:{thumbColor:null===(be=null==Be?void 0:Be.scroll)||void 0===be?void 0:be.thumbColor},scrollTo:et,alwaysShowScrollbar:!0,hidden:Ze},g.createElement(w.p,{theme:Be,suggestionsRef:ft,styles:Re,strings:B,locale:de,results:_e,canDisableSuggestionTabFocus:!0,isShimmerVisible:Ze,showPartialLoadingEntities:K,enableScopedHeader:!1,itemsCount:mt,updateMenuLayout:Ot,itemQueryString:R,onGroupSelected:Y,onItemSelected:Ee,onItemHovered:Ft,enablePrefixHighlighting:O,isGroupHeaderVisible:!1,hasSelectionBeenModifiedViaKeyboard:lt,layerHostId:A,disableTooltips:H,showMeetingBanner:re,enableMeetingBanner:se,meetingBannerText:ae,isSmallWindow:U}))),$t&&g.createElement(c.u,{automationLabel:"InlineSuggestionMoreEntitiesButton",title:j.showMoreEntitiesButtonLabel,useFullWidth:!0,accessibilityRole:"option",theme:T.zN(Be,st),onClick:()=>{var e;it(!0),at(!1),null===(e=null==j?void 0:j.onClickShowMoreEntities)||void 0===e||e.call(j,!0),ze({value:-1})}}))}},72388:(e,t,o)=>{"use strict";o.d(t,{U:()=>u});var i=o(95734),n=o(16971),r=o(20193),s=o(96204),a=o(36382);const l=i.memo((({group:e,onItemSelected:t,overflowIndex:o,theme:r,isFeedbackEnabledForEcc:l,strings:c,isHighlighted:u,isOpen:d,onOverflowClose:h,overflowUid:g})=>{const p=i.useContext(n.O),f=i.useContext(n.b);r||(r=a.nk(void 0,p,f));let m=[];o&&o>0&&(m=e.suggestions.slice(o,e.suggestions.length).filter((e=>!!e.title)).map(((e,t)=>{var o;return{title:e.title,type:"item",key:t.toString(),entityType:null===(o=e.scopeInfo)||void 0===o?void 0:o.entityType}})));const v=a.JE(r,u),b={title:r.text,background:r.background};if(l){m.length&&m.push({type:"separator",key:"separator"});const e=m.length?m.length-1:0;m.push({type:"item",title:c.inlineSuggestions("feedbackText"),key:e.toString()})}return m.length?i.createElement(s.o,{items:m,onClick:t,shouldFocusButtonOnDismiss:!1,hasKeyboardFocus:u,theme:b,buttonOnlyTheme:v,itemTheme:b,id:g,icon:{type:"Overflow",filled:!1},automationLabelType:"",automationId:"",startOpen:d,onTabClose:!0,onMenuDismiss:h,accessibilityLabel:c.inlineSuggestions("overflowTabAriaLabel")}):null}));l.displayName="ExpandedInlineSuggestionsOverflow";var c=o(5202);const u=i.memo((({theme:e,styles:t,strings:o,scopes:s,enablePrefixHighlighting:u,layerHostId:h,groupLayouts:g,itemQueryString:p,hasSelectionBeenModifiedViaKeyboard:f,isFeedbackEnabledForEcc:m,isSmallWindow:v,enableResponsiveLayout:b,overflowUid:y,headerRef:w,headerScopesRef:C,onGroupSelected:S,onItemSelected:k,onOverflowCalculated:T,isOverflowHighlighted:x,isOverflowMenuOpened:_,onOverflowClose:I})=>{var E,B,A;const R=i.useContext(n.O),M=i.useContext(n.b),D=null!=e?e:a.nk(void 0,R,M);let P=0;const[F,O]=i.useState(0),[N,q]=i.useState(0),j=function(e){const t=i.useRef();return i.useEffect((()=>{t.current=e})),t.current}(v),L=null===(E=w.current)||void 0===E?void 0:E.el(),z=null===(B=C.current)||void 0===B?void 0:B.el(),H=document.getElementById("uploadFileButtonContainer"),W=H?H.clientWidth+12:0,U=null!==(A=null==L?void 0:L.clientWidth)&&void 0!==A?A:0;return i.useEffect((()=>{if(b&&(0===F||j!==v||(null==L?void 0:L.clientWidth)&&N>=L.clientWidth)){const e=d(L,W,z);null==T||T(0!==e[0],e[0]),O(e[0]),q(e[1])}}),[b,F,j,v,N,T,L]),i.useEffect((()=>{if(!b){const e=d(L,W,z);P=e[0],O(P),q(e[1]),null==T||T(0!==P,P)}}),[U]),P=F,i.createElement(i.Fragment,null,i.createElement(c.K,{theme:D,strings:o,key:"scopes",group:s,layerHostId:h,accessibilitySetSize:s.suggestions.length,headerStyles:null==t?void 0:t.headerStyles,newItemTagStyles:null==t?void 0:t.newItemTagStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:0,accessibilityRole:"tab",enablePrefixHighlighting:u,onHeaderClick:()=>null==S?void 0:S(s),onHeaderHeightChange:e=>{g[0]||(g[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),g[0].headerHeight=e},onHeightExtraSpaceBottomChange:e=>{g[0]||(g[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),g[0].extraSpaceBottomHeight=e},onSeparatorHeightChange:e=>{g[0]||(g[0]={headerHeight:0,separatorHeight:e,extraSpaceBottomHeight:0,itemHeights:[]}),g[0].separatorHeight=e},itemsStyles:null==t?void 0:t.itemsStyles,itemQueryString:p,onItemSelected:k,onItemHeightChange:(e,t)=>{g[0]||(g[0]={headerHeight:0,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),g[0].itemHeights[t]=e},showSeparator:!1,separatorProps:void 0,hasSelectionBeenModifiedViaKeyboard:f,disableTooltips:!0,enableExpandedECCScopeLayout:!0,overflowIndex:b?F:P}),b&&0===F&&!m||!b&&0===P&&!m?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,i.createElement(r.q.Consumer,null,(e=>i.createElement("div",{style:0!==N&&b?e?{position:"absolute",right:N}:{position:"absolute",left:N}:{}},i.createElement(l,{overflowIndex:b?F:P,group:s,onItemSelected:k,theme:D,isFeedbackEnabledForEcc:m,strings:o,isHighlighted:x,isOpen:_,onOverflowClose:I,overflowUid:y}))))))})),d=(e,t,o)=>{if(!e||!o)return[0,0];const i=(null==e?void 0:e.clientWidth)-38-t,n=Array.from(o.children);let r=0,s=0;for(let e=0;e<n.length;e++){if(!(n[e].clientWidth+r<i)){s=e;break}r+=n[e].clientWidth}return[s,r]}},45216:(e,t,o)=>{"use strict";o.d(t,{V:()=>s});var i=o(95734),n=o(7313),r=o(48803);const s=i.memo((e=>{var t,o,s,a,l,c,{theme:u,accessibilityLabel:d}=e,h=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["theme","accessibilityLabel"]);return i.createElement(i.Fragment,null,i.createElement(n.S,{style:{marginTop:10,marginStart:12,marginEnd:12,width:"100%",minWidth:0}},i.createElement(r.G,Object.assign({},h,{autoComplete:!1,spellCheck:!1,accessibilityLabel:d,styles:{borderRadius:4,width:"100%",borderBottom:`${null===(t=null==u?void 0:u.searchBox)||void 0===t?void 0:t.borderBottomColor} solid 3px`},theme:{iconColor:null===(o=null==u?void 0:u.searchBox)||void 0===o?void 0:o.iconColor,borderColor:{hover:null===(a=null===(s=null==u?void 0:u.searchBox)||void 0===s?void 0:s.borderColor)||void 0===a?void 0:a.hover,resting:null===(c=null===(l=null==u?void 0:u.searchBox)||void 0===l?void 0:l.borderColor)||void 0===c?void 0:c.resting}}}))))}));s.displayName="ExpandedInlineSuggestionsSearchBox"},6255:(e,t,o)=>{"use strict";if(o.d(t,{QI:()=>$,WT:()=>r,oM:()=>s}),3023==o.j)var i=o(54651);if(3023==o.j)var n=o(317);const r=(e={},t,o)=>({containerStyles:a(e.containerStyles,t,o),shimmerStyles:l(e),headerStyles:c(e.headerStyles),itemsStyles:d(e.itemsStyles,t),footerStyles:C(e.footerStyles)}),s=(e={},t)=>({containerStyles:a(e.containerStyles,t),shimmerStyles:l(e),headerStyles:c(e.headerStyles),itemsStyles:d(e.itemsStyles,t),footerStyles:C(e.footerStyles)}),a=(e={},t,o)=>{var i,n,r;return Object.assign({minWidth:o?304:null!==(i=null==t?void 0:t.menuMaxWidth)&&void 0!==i?i:480,maxWidth:o?304:null!==(n=null==t?void 0:t.menuMaxWidth)&&void 0!==n?n:480,minHeight:100,maxHeight:o?280:null!==(r=null==t?void 0:t.menuHeight)&&void 0!==r?r:300,paddingHorizontal:4,paddingTop:4,paddingBottom:4,marginEnd:10,scrollbarThumbWidth:10,overflow:"hidden"},e)},l=(e={})=>{var t,o,i,n,r,s,a;const l=null===(t=null==e?void 0:e.itemsStyles)||void 0===t?void 0:t.genericItemStyles;return Object.assign({titleLineHeight:null!==(i=null===(o=null==e?void 0:e.headerStyles)||void 0===o?void 0:o.titleLineHeight)&&void 0!==i?i:16,itemPaddingVertical:null!==(n=null==l?void 0:l.paddingVertical)&&void 0!==n?n:6,itemPaddingHorizontal:null!==(r=null==l?void 0:l.paddingHorizontal)&&void 0!==r?r:12,textPaddingLeft:null!==(s=null==l?void 0:l.textPaddingStart)&&void 0!==s?s:8,personaCoinSize:null!==(a=null==l?void 0:l.personaCoinSize)&&void 0!==a?a:32},e.shimmerStyles)},c=(e={})=>Object.assign({},e),u=(e={},t={},o={})=>({item:Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),n.ZD.item),t),e.item),description:Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),n.ZD.description),t),e.description)}),d=(e={},t)=>({genericItemStyles:p(e.genericItemStyles,e.sharedItemStyles,t),personItemStyles:f(e.personItemStyles,e.sharedItemStyles,t),fileItemStyles:m(e.fileItemStyles,e.sharedItemStyles,t),scopeItemStyles:v(e.scopeItemStyles,e.sharedItemStyles,t),eventItemStyles:b(e.eventItemStyles,e.sharedItemStyles,t),emailItemStyles:y(e.emailItemStyles,e.sharedItemStyles,t),chatItemStyles:w(e.chatItemStyles,e.sharedItemStyles,t),noSuggestionsStyles:u(e.noSuggestionsStyles,e.sharedItemStyles,t)}),h=e=>{var t,o;return Object.assign(Object.assign({},n.cK),{borderRadius:null!==(t=null==e?void 0:e.itemBorderRadius)&&void 0!==t?t:n.cK.borderRadius,height:null!==(o=null==e?void 0:e.itemHeight)&&void 0!==o?o:n.cK.height})},g=e=>Object.assign(Object.assign({},n.nI),(null==e?void 0:e.itemIconSize)?{width:e.itemIconSize,height:e.itemIconSize,minWidth:e.itemIconSize}:{}),p=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)}),{paddingVertical:6})},f=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:32}),t),e),{paddingVertical:6})},m=(e={},t={},o)=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),t),e),{iconStyles:Object.assign(Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles),{backgroundColor:"#EBEBEB",borderRadius:20})}),{paddingVertical:6}),v=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{height:40,iconStyles:Object.assign(Object.assign({},g(o)),null==e?void 0:e.iconStyles)}),{paddingHorizontal:12,paddingVertical:10})},b=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign(Object.assign({},g(o)),{width:32,height:32,minWidth:32,borderRadius:20,padding:6,backgroundColor:"#EBEBEB"}),null==e?void 0:e.iconStyles)}),{paddingVertical:6})},y=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign(Object.assign({},g(o)),{width:32,height:32,minWidth:32,borderRadius:20,padding:6,backgroundColor:"#EBEBEB"}),null==e?void 0:e.iconStyles)}),{paddingVertical:6})},w=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:32}),t),e),{iconStyles:Object.assign({width:32,height:32,minWidth:32,borderRadius:20,padding:6,backgroundColor:"#EBEBEB"},null==e?void 0:e.iconStyles)}),{paddingVertical:6})},C=(e={})=>Object.assign(Object.assign(Object.assign({},i.Y_),{height:40,paddingTop:6,paddingBottom:4,paddingHorizontal:6,marginTop:-4,marginHorizontal:-4,marginBottom:4,transform:"translateY(4px)"}),e),S="var(--colorNeutralForeground2)",k="transparent",T="var(--colorNeutralBackground3)",x="var(--colorNeutralForeground2Hover)",_="var(--colorNeutralStrokeAlpha)",I="var(--colorNeutralBackground1)",E="var(--colorNeutralForeground2Pressed)",B="var(--colorNeutralStrokeAlpha)",A="var(--colorSubtleBackgroundLightAlphaPressed)",R="var(--colorNeutralForeground2)",M="var(--colorStrokeFocus2)",D="var(--colorSubtleBackground)",P="var(--colorNeutralForeground1)",F="var(--colorNeutralStroke1)",O="var(--colorNeutralBackground1)",N="var(--colorNeutralForeground1)",q="var(--colorNeutralStroke1Hover)",j="var(--colorNeutralBackground1Hover)",L="var(--colorNeutralForeground1Pressed)",z="var(--colorNeutralStroke1Pressed)",H="var(--colorNeutralBackground1Pressed)",W="var(--colorNeutralForeground1)",U="var(--colorStrokeFocus2)",G="var(--colorNeutralBackground1)",V={light:{selected:{textColor:"#3E45C9",borderColor:"#464FEB",backgroundColor:"#EBEFFF"},selectedHover:{textColor:"#3B3FB2",borderColor:"#3E45C9",backgroundColor:"#CCD6FF"},selectedPressed:{textColor:"#27265C",borderColor:"#3B3FB2",backgroundColor:"#96A8FF"},selectedFocused:{textColor:"#3E45C9",borderColor:"var(--colorStrokeFocus2)",backgroundColor:"#EBEFFF"}},dark:{selected:{textColor:"#7385FF",borderColor:"#5F71FA",backgroundColor:"#1E1D40"},selectedHover:{textColor:"#96A8FF",borderColor:"#7385FF",backgroundColor:"#2E2E78"},selectedPressed:{textColor:"#5F71FA",borderColor:"#515EF5",backgroundColor:"#16152B"},selectedFocused:{textColor:"#7385FF",borderColor:"var(--colorStrokeFocus2)",backgroundColor:"#1E1D40"}}},$=(e,t,o)=>{var i,n,r,s,a,l,c,u,d,h,g,p,f,m,v,b,y,w,C,$,K,J,Y,Q,Z,X,ee,te,oe,ie,ne,re,se,ae,le,ce,ue,de,he,ge,pe,fe,me,ve,be,ye,we,Ce,Se,ke,Te,xe,_e,Ie,Ee,Be,Ae,Re,Me,De,Pe,Fe,Oe,Ne,qe,je,Le,ze,He,We,Ue,Ge;const Ve="light"===e?"light":"dark",$e=null==t?void 0:t[Ve],Ke=null==o?void 0:o[Ve],Je=V[Ve];return{"--tabTextRestingColor":null!==(s=null!==(n=null===(i=null==$e?void 0:$e.resting)||void 0===i?void 0:i.textColor)&&void 0!==n?n:null===(r=null==Ke?void 0:Ke.resting)||void 0===r?void 0:r.textColor)&&void 0!==s?s:S,"--tabBorderRestingColor":null!==(u=null!==(l=null===(a=null==$e?void 0:$e.resting)||void 0===a?void 0:a.borderColor)&&void 0!==l?l:null===(c=null==Ke?void 0:Ke.resting)||void 0===c?void 0:c.borderColor)&&void 0!==u?u:k,"--tabBgRestingColor":null!==(p=null!==(h=null===(d=null==$e?void 0:$e.resting)||void 0===d?void 0:d.backgroundColor)&&void 0!==h?h:null===(g=null==Ke?void 0:Ke.resting)||void 0===g?void 0:g.backgroundColor)&&void 0!==p?p:T,"--tabTextHoverColor":null!==(b=null!==(m=null===(f=null==$e?void 0:$e.hover)||void 0===f?void 0:f.textColor)&&void 0!==m?m:null===(v=null==Ke?void 0:Ke.hover)||void 0===v?void 0:v.textColor)&&void 0!==b?b:x,"--tabBorderHoverColor":null!==($=null!==(w=null===(y=null==$e?void 0:$e.hover)||void 0===y?void 0:y.borderColor)&&void 0!==w?w:null===(C=null==Ke?void 0:Ke.hover)||void 0===C?void 0:C.borderColor)&&void 0!==$?$:_,"--tabBgHoverColor":null!==(Q=null!==(J=null===(K=null==$e?void 0:$e.hover)||void 0===K?void 0:K.backgroundColor)&&void 0!==J?J:null===(Y=null==Ke?void 0:Ke.hover)||void 0===Y?void 0:Y.backgroundColor)&&void 0!==Q?Q:I,"--tabTextPressedColor":null!==(te=null!==(X=null===(Z=null==$e?void 0:$e.pressed)||void 0===Z?void 0:Z.textColor)&&void 0!==X?X:null===(ee=null==Ke?void 0:Ke.pressed)||void 0===ee?void 0:ee.textColor)&&void 0!==te?te:E,"--tabBorderPressedColor":null!==(re=null!==(ie=null===(oe=null==$e?void 0:$e.pressed)||void 0===oe?void 0:oe.borderColor)&&void 0!==ie?ie:null===(ne=null==Ke?void 0:Ke.pressed)||void 0===ne?void 0:ne.borderColor)&&void 0!==re?re:B,"--tabBgPressedColor":null!==(ce=null!==(ae=null===(se=null==$e?void 0:$e.pressed)||void 0===se?void 0:se.backgroundColor)&&void 0!==ae?ae:null===(le=null==Ke?void 0:Ke.pressed)||void 0===le?void 0:le.backgroundColor)&&void 0!==ce?ce:A,"--tabTextFocusedColor":null!==(ge=null!==(de=null===(ue=null==$e?void 0:$e.focused)||void 0===ue?void 0:ue.textColor)&&void 0!==de?de:null===(he=null==Ke?void 0:Ke.focused)||void 0===he?void 0:he.textColor)&&void 0!==ge?ge:R,"--tabBorderFocusedColor":null!==(ve=null!==(fe=null===(pe=null==$e?void 0:$e.focused)||void 0===pe?void 0:pe.borderColor)&&void 0!==fe?fe:null===(me=null==Ke?void 0:Ke.focused)||void 0===me?void 0:me.borderColor)&&void 0!==ve?ve:M,"--tabBgFocusedColor":null!==(Ce=null!==(ye=null===(be=null==$e?void 0:$e.pressed)||void 0===be?void 0:be.backgroundColor)&&void 0!==ye?ye:null===(we=null==Ke?void 0:Ke.pressed)||void 0===we?void 0:we.backgroundColor)&&void 0!==Ce?Ce:A,"--tabTextSelectedColor":null!==(ke=null!==(Se=null==$e?void 0:$e.selected.textColor)&&void 0!==Se?Se:null==Ke?void 0:Ke.selected.textColor)&&void 0!==ke?ke:Je.selected.textColor,"--tabBorderSelectedColor":null!==(xe=null!==(Te=null==$e?void 0:$e.selected.borderColor)&&void 0!==Te?Te:null==Ke?void 0:Ke.selected.borderColor)&&void 0!==xe?xe:Je.selected.borderColor,"--tabBgSelectedColor":null!==(Ie=null!==(_e=null==$e?void 0:$e.selected.backgroundColor)&&void 0!==_e?_e:null==Ke?void 0:Ke.selected.backgroundColor)&&void 0!==Ie?Ie:Je.selected.backgroundColor,"--tabTextSelectedHoverColor":null!==(Be=null!==(Ee=null==$e?void 0:$e.selectedHover.textColor)&&void 0!==Ee?Ee:null==Ke?void 0:Ke.selectedHover.textColor)&&void 0!==Be?Be:Je.selectedHover.textColor,"--tabBorderSelectedHoverColor":null!==(Re=null!==(Ae=null==$e?void 0:$e.selectedHover.borderColor)&&void 0!==Ae?Ae:null==Ke?void 0:Ke.selectedHover.borderColor)&&void 0!==Re?Re:Je.selectedHover.borderColor,"--tabBgSelectedHoverColor":null!==(De=null!==(Me=null==$e?void 0:$e.selectedHover.backgroundColor)&&void 0!==Me?Me:null==Ke?void 0:Ke.selectedHover.backgroundColor)&&void 0!==De?De:Je.selectedHover.backgroundColor,"--tabTextSelectedPressedColor":null!==(Fe=null!==(Pe=null==$e?void 0:$e.selectedPressed.textColor)&&void 0!==Pe?Pe:null==Ke?void 0:Ke.selectedPressed.textColor)&&void 0!==Fe?Fe:Je.selectedPressed.textColor,"--tabBorderSelectedPressedColor":null!==(Ne=null!==(Oe=null==$e?void 0:$e.selectedPressed.borderColor)&&void 0!==Oe?Oe:null==Ke?void 0:Ke.selectedPressed.borderColor)&&void 0!==Ne?Ne:Je.selectedPressed.borderColor,"--tabBgSelectedPressedColor":null!==(je=null!==(qe=null==$e?void 0:$e.selectedPressed.backgroundColor)&&void 0!==qe?qe:null==Ke?void 0:Ke.selectedPressed.backgroundColor)&&void 0!==je?je:Je.selectedPressed.backgroundColor,"--tabTextSelectedFocusedColor":null!==(ze=null!==(Le=null==$e?void 0:$e.selectedFocused.textColor)&&void 0!==Le?Le:null==Ke?void 0:Ke.selectedFocused.textColor)&&void 0!==ze?ze:Je.selectedFocused.textColor,"--tabBorderSelectedFocusedColor":null!==(We=null!==(He=null==$e?void 0:$e.selectedFocused.borderColor)&&void 0!==He?He:null==Ke?void 0:Ke.selectedFocused.borderColor)&&void 0!==We?We:Je.selectedFocused.borderColor,"--tabBgSelectedFocusedColor":null!==(Ge=null!==(Ue=null==$e?void 0:$e.selectedFocused.backgroundColor)&&void 0!==Ue?Ue:null==Ke?void 0:Ke.selectedFocused.backgroundColor)&&void 0!==Ge?Ge:Je.selectedFocused.backgroundColor,"--defaultMenuButtonsRestingTextColor":S,"--defaultMenuButtonsRestingBgColor":T,"--defaultMenuButtonsRestingBorderColor":k,"--defaultMenuButtonsHoverTextColor":x,"--defaultMenuButtonsHoverBgColor":I,"--defaultMenuButtonsHoverBorderColor":_,"--defaultMenuButtonsPressedTextColor":E,"--defaultMenuButtonsPressedBgColor":A,"--defaultMenuButtonsPressedBorderColor":B,"--defaultMenuButtonsFocusedTextColor":R,"--defaultMenuButtonsFocusedBgColor":D,"--defaultMenuButtonsFocusedBorderColor":M,"--defaultMenuButtonsSelectedTextColor":P,"--defaultMenuButtonsSelectedBgColor":O,"--defaultMenuButtonsSelectedBorderColor":F,"--defaultMenuButtonsSelectedHoverTextColor":N,"--defaultMenuButtonsSelectedHoverBgColor":j,"--defaultMenuButtonsSelectedHoverBorderColor":q,"--defaultMenuButtonsSelectedPressedTextColor":L,"--defaultMenuButtonsSelectedPressedBgColor":H,"--defaultMenuButtonsSelectedPressedBorderColor":z,"--defaultMenuButtonsSelectedFocusedTextColor":W,"--defaultMenuButtonsSelectedFocusedBgColor":G,"--defaultMenuButtonsSelectedFocusedBorderColor":U}}},317:(e,t,o)=>{"use strict";o.d(t,{B3:()=>b,Ek:()=>v,Js:()=>r,L_:()=>C,MG:()=>x,Qf:()=>h,RR:()=>f,Ss:()=>s,XC:()=>y,ZD:()=>_,cK:()=>a,dm:()=>w,dt:()=>m,g4:()=>T,gl:()=>d,mX:()=>p,nI:()=>u,p:()=>g,v9:()=>S,vC:()=>k,z0:()=>c,zx:()=>l});var i=o(86399);if(3023==o.j)var n=o(77776);const r={headerMarginVertical:4,itemBorderRadius:4,itemIconSize:24,menuHeight:252},s={headerMarginVertical:4,itemBorderRadius:8,itemIconSize:32,menuHeight:300},a={flexibleSize:!0,borderRadius:4},l={width:300,maxHeight:48};function c(e){const t=Object.assign(Object.assign({},u),{margin:8}),o={borderRadius:4,paddingHorizontal:1,paddingVertical:1,fontWeight:i.IT.Bold,height:35,border:"1px solid var(--color-neutral-stroke-1-rest, #D1D1D1)"};return e?Object.assign(Object.assign({},u),{minWidth:"unset",style:{width:32,borderRadius:4,paddingHorizontal:6,paddingVertical:6,fontWeight:i.IT.Bold,height:32,border:"1px solid var(--color-neutral-stroke-1-rest, #D1D1D1)"}}):{icon:Object.assign(Object.assign({},t),{marginRight:0}),style:Object.assign({width:100},o)}}i.IT.Bold;const u={width:24,height:24,minWidth:24},d={width:24,height:30,marginHorizontal:12,paddingHorizontal:0,paddingVertical:0},h={width:32,height:32,border:"0",borderRadius:4,paddingHorizontal:0,paddingVertical:0},g={width:16,height:16};function p(e,t){var o,n,r,s,a,l,c,u,d;return{containerStyles:{paddingHorizontal:null!==(o=null==t?void 0:t.paddingHorizontal)&&void 0!==o?o:2,paddingVertical:null!==(n=null==t?void 0:t.paddingVertical)&&void 0!==n?n:6,minWidth:null!==(r=null==t?void 0:t.minWidth)&&void 0!==r?r:33,height:null!==(s=null==t?void 0:t.height)&&void 0!==s?s:18,backgroundColor:null===(a=e.tag)||void 0===a?void 0:a.background,borderRadius:null!==(l=null==t?void 0:t.borderRadius)&&void 0!==l?l:8},textStyles:{width:null!==(c=null==t?void 0:t.minWidth)&&void 0!==c?c:33,height:(null==t?void 0:t.height)?(null==t?void 0:t.height)-4:20,fontSize:null!==(u=null==t?void 0:t.fontSize)&&void 0!==u?u:10,cssColor:null===(d=e.tag)||void 0===d?void 0:d.textColor,fontFamily:"Segoe UI",fontWeight:i.IT.Bold,textAlign:"center"}}}const f=Object.assign(Object.assign({},u),{margin:8}),m=(Object.assign(Object.assign({},u),{margin:8,marginRight:0}),{marginTop:6,fontSize:20}),v={paddingHorizontal:12};function b(e,t,o){var r,s;return{fontWeight:i.IT.SemiBold,fontFamily:n.V,fontSize:o.xsmall,paddingHorizontal:8,marginVertical:null!==(r=t.headerMarginVertical)&&void 0!==r?r:4,cssColor:e.text.resting,lineHeight:null!==(s=t.headerLineHeight)&&void 0!==s?s:20}}function y(e,t,o){var r,s,a;return{fontWeight:i.IT.Normal,fontFamily:n.V,fontSize:o.xsmall,marginTop:0,marginBottom:null!==(r=t.headerMarginVertical)&&void 0!==r?r:4,paddingHorizontal:8,cssColor:null!==(a=null===(s=e.altText)||void 0===s?void 0:s.resting)&&void 0!==a?a:"#605e5c"}}function w(e,t){return{fontWeight:i.IT.Normal,fontFamily:n.V,fontSize:t.small,cssColor:e,lineHeight:20}}function C(e){const t={};return e&&(t.borderWidth={top:0,end:0,start:0,bottom:1},t.borderStyle="solid"),t}function S(){return{fontSize:12,fontWeight:600}}function k(e){var t;return{overflow:{width:null===(t=e.containerStyles)||void 0===t?void 0:t.maxWidth}}}const T={style:{marginStart:-8,marginEnd:-12,marginTop:8,marginBottom:8,height:1}},x={paddingTop:12,paddingBottom:8,paddingHorizontal:12},_={description:x,item:{paddingVertical:8,paddingStart:4,borderRadius:8}}},9161:(e,t,o)=>{"use strict";o.d(t,{i:()=>l});var i=o(95734),n=o(7313),r=o(68803),s=o(82512),a=o(317);const l=i.memo((e=>{var{strings:t,theme:o,browseThisComputerButtonLabel:l,isBrowseThisComputerEnabled:c,onClickBrowseThisComputer:u,hasSelectionBeenModifiedViaKeyboard:d}=e,h=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["strings","theme","browseThisComputerButtonLabel","isBrowseThisComputerEnabled","onClickBrowseThisComputer","hasSelectionBeenModifiedViaKeyboard"]);return i.createElement(n.S,{direction:r.PR.LeftToRight,align:r.j5.Stretch},i.createElement(s.u,Object.assign({},h,{style:a.zx,accessibilityRole:"option",automationLabel:"InlineSuggestionsBrowseThisComputer",title:l,icon:{type:"Laptop",style:a.RR},onClick:u,hasKeyboardFocus:c,theme:o,isSelectedByKeyboard:c&&d})))}));l.displayName="InlineSuggestionsBrowseThisComputer"},5202:(e,t,o)=>{"use strict";o.d(t,{K:()=>B});var i=o(95734),n=o(48545),r=o(97782),s=o(39386),a=o(62989),l=o(86399),c=o(16971),u=o(51395),d=o(22914),h=o(82512),g=o(54651),p=o(317),f=o(15897),m=o(36382),v=o(43046);function b(e,t){if(!t)return;e=e.toLocaleLowerCase();const o=(t=t.toLocaleLowerCase()).indexOf(e);return o<0?void 0:[{start:o,length:e.length,fontWeight:l.IT.SemiBold,wrapMode:l.bd.NoWrap}]}function y(e,t,o){if(!e)return;const i=o?null==t?void 0:t.filter((e=>e.propertyHit===o)):t,n=[];return i&&i.forEach((e=>{n.push({start:e.offset,length:e.word.length,fontWeight:l.IT.SemiBold,wrapMode:l.bd.NoWrap})})),n}const w=({htmlId:e,theme:t,style:o,strings:n,suggestionId:r,suggestionType:l,queryString:w,title:C,titleFontSize:S,subtitle:k,subtitleFontSize:T,truncateSubtitle:x,tooltip:_,icon:I,layerHostId:E,personaCoinProps:B,isHighlighted:A,hasSelectionBeenModifiedViaKeyboard:R,showKeyboardTooltip:M,disableTabFocus:D,isInitialSelection:P,accessibilityRole:F,accessibilityPositionInSet:O,accessibilitySetSize:N,disableAccessibilityExpanded:q,onHeightChange:j,onHoverIn:L,onClick:z,enablePrefixHighlighting:H,hitHighlightIndexes:W,displayNewItemTag:U,newItemTagStyles:G,disableTooltips:V,enableExpandedECCScopeLayout:$,isScopeSelected:K,isDisabled:J,updateItemHeight:Y})=>{var Q,Z,X,ee,te,oe,ie,ne,re,se,ae,le,ce;const ue=i.useContext(c.O),de=i.useContext(c.b),he=l===s.c.Topic,ge=null!=t?t:m.nk(void 0,ue,de);let pe=u.A.rightCenter;switch(null===(Q=null==ge?void 0:ge.tooltip)||void 0===Q?void 0:Q.directionHint){case a.A8.centered:pe=void 0;break;case a.A8.rightCenter:pe=u.A.rightCenter;break;case a.A8.bottomCenter:pe=u.A.bottomCenter;break;default:pe=he?u.A.rightCenter:void 0}const fe=m.yi(l,t,A);let me=C&&k?(0,f.w)(n,C,k):C;U&&(me=n.inlineSuggestions("combineTag").replace("{0}",null!=me?me:"").replace("{1}",n.inlineSuggestions("newTagText")));const{borderThickness:ve,shadows:be}=(0,v.j)(o,ue?(0,d.I)()?"Highlight":null!==(Z=ge.focusRing)&&void 0!==Z?Z:"var(--colorStrokeFocus2)":null!==(X=fe.border)&&void 0!==X?X:"#000",null!=P&&P,null!=R&&R,null!=A&&A,{useFluentV9:ue});return i.createElement(h.u,{appearance:"subtle",htmlId:e,onClick:z,onHoverIn:L,accessibilityLabel:me,accessibilityRole:F,accessibilityPositionInSet:O,accessibilitySetSize:N,accessibilityDescribedByTooltip:!!_||void 0,disableAccessibilityExpanded:q,onHeightChange:j,automationLabel:`Inline${l}Suggestion-${r}`,tooltipProps:{showBeak:null!==(te=null===(ee=null==ge?void 0:ge.tooltip)||void 0===ee?void 0:ee.showBeak)&&void 0!==te?te:he,gapSpace:null===(oe=null==ge?void 0:ge.tooltip)||void 0===oe?void 0:oe.gapSpace,borderRadius:null===(ie=null==ge?void 0:ge.tooltip)||void 0===ie?void 0:ie.borderRadius,calloutMaxWidth:null===(ne=null==ge?void 0:ge.tooltip)||void 0===ne?void 0:ne.calloutMaxWidth,paddingStart:null===(re=null==ge?void 0:ge.tooltip)||void 0===re?void 0:re.paddingStart,paddingEnd:null===(se=null==ge?void 0:ge.tooltip)||void 0===se?void 0:se.paddingEnd,paddingTop:null===(ae=null==ge?void 0:ge.tooltip)||void 0===ae?void 0:ae.paddingTop,paddingBottom:null===(le=null==ge?void 0:ge.tooltip)||void 0===le?void 0:le.paddingBottom,coverTarget:void 0===pe,directionHint:pe,layerHostId:E},title:C,titleStyle:g.D0(g.d4,C?C.length:0,!0,S),titleRootStyle:g.Xp(),personaCoinProps:B,style:o?Object.assign(Object.assign({},o),{borderThickness:be?0:ve,boxShadow:(null!==(ce=null==be?void 0:be.length)&&void 0!==ce?ce:0)>0?be:void 0}):void 0,subtitle:k,subtitleStyle:g.qw(g.d4,!0,x,T),theme:fe,hasKeyboardFocus:A,isSelectedByKeyboard:A&&R&&M,tooltip:V?"":_,icon:I?Object.assign(Object.assign({},I),{filled:!0}):void 0,iconShouldBeAccessible:!1,titleFormatting_DONOTUSE:w?H?y(C,W,"title"):b(w,C):void 0,subtitleFormatting:w?H?y(k,W,"subTitle"):b(w,k):void 0,disableTagAccessibility:!0,tagStyles:p.mX(ge,G),tagText:U?n.inlineSuggestions("newTagText"):void 0,topPanelScopeButton:$,showUnderline:K,disabled:J,updateItemHeight:Y,disableTabFocus:D})};var C=o(7313),S=o(68803),k=o(78585),T=o(21646),x=o(44357);const _=i.memo((e=>{var t,o,{suggestion:n,theme:r,styles:s,newItemTagStyles:a,onItemHovered:l,onItemSelected:u,strings:d,enableExpandedECCScopeLayout:h,enableMeetingBanner:f,locale:v}=e,b=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["suggestion","theme","styles","newItemTagStyles","onItemHovered","onItemSelected","strings","enableExpandedECCScopeLayout","enableMeetingBanner","locale"]);const y=i.useContext(c.O),_=i.useContext(c.b),I=null!=r?r:m.nk(void 0,y,_),E=i.useCallback((()=>{u(n)}),[n,u]),B=i.useCallback((()=>{null==l||l(n)}),[n,l]),A=(0,T.D)(n,d,s,I,h,f,v),R=n.type===x.E9&&(null===(t=null==s?void 0:s.noSuggestionsStyles)||void 0===t?void 0:t.item)?s.noSuggestionsStyles.item:A.style,M=`${A.suggestionId}-${b.queryString}`,D=i.createElement(w,Object.assign({},b,A,{style:R,newItemTagStyles:a,strings:d,theme:r,onClick:E,onHoverIn:B,isDisabled:n.isDisabled,key:M}));if(n.noSuggestionsDescription){const e=n.type===x.E9?null===(o=null==s?void 0:s.noSuggestionsStyles)||void 0===o?void 0:o.description:void 0;return i.createElement(C.S,{align:S.j5.Stretch,direction:S.PR.TopToBottom},i.createElement(C.S,{style:null!=e?e:p.MG},i.createElement(k.c,{text:n.noSuggestionsDescription,style:p.dm(m.FP(n,r),g.d4)})),D)}return D}));_.displayName="InlineSuggestionsItem";var I=o(2114),E=o(67787);const B=i.memo((({theme:e,group:t,accessibilitySetSize:o,strings:a,headerHtmlId:l,isHeaderVisible:c,headerStyles:u,containerStyles:d,hasScopableHeader:h,headerAccessibilityPositionInSet:g,enablePrefixHighlighting:p,showSeparator:f,separatorProps:m,hasSelectionBeenModifiedViaKeyboard:v,showKeyboardTooltip:b,isInitialSelection:y,layerHostId:w,showPartialLoadingEntities:C,shimmerStyles:S,itemsStyles:k,newItemTagStyles:T,itemQueryString:_,canDisableTabFocus:B,onHeaderClick:R,onHeaderHeightChange:M,onSeparatorHeightChange:D,onHeightExtraSpaceBottomChange:P,onGroupHovered:F,onItemHovered:O,onItemSelected:N,onItemHeightChange:q,disableTooltips:j,enableExpandedECCScopeLayout:L,overflowIndex:z,showMeetingBanner:H,enableMeetingBanner:W,meetingBannerText:U,accessibilityRole:G="menuitem",isSmallWindow:V,updateItemHeight:$,locale:K})=>{var J,Y,Q,Z;const X=t.suggestions;let ee=!1,te=!1;const oe=X.map(((t,n)=>{if(z&&z<=n)return;const r=g+(h?++n:n);return ee=ee||t.isNew&&t.type===s.c.Scope||!1,te=H&&t.type===s.c.Event||!1,i.createElement(A,{styles:k,containerStyles:d,newItemTagStyles:T,strings:a,suggestion:t,key:`suggestion-item-${n}`,index:n,locale:K,htmlId:L?(0,x.Bn)(n,!0):t.type===x.E9?x.E9:(0,x.Bn)(r),theme:e,queryString:""!==_?_:void 0,accessibilityRole:G,accessibilityPositionInSet:r+1,accessibilitySetSize:o,truncateSubtitle:!0,onItemHovered:O,onItemSelected:N,onItemHeightChange:q,enablePrefixHighlighting:p,hasSelectionBeenModifiedViaKeyboard:v,showKeyboardTooltip:b&&!!t.isHighlighted,disableTabFocus:B,isInitialSelection:y,layerHostId:w,disableTooltips:j,enableExpandedECCScopeLayout:L,enableMeetingBanner:W,hasScopableHeader:h,updateItemHeight:$})})),ie=[];for(let e=0;e<(C||0);e++)ie.push(i.createElement(E.n,{style:S,key:`shimmer-skeleton-${e}`}));return i.createElement(i.Fragment,null,f&&i.createElement(n.w,Object.assign({},m,{onHeightChange:D})),te&&i.createElement("div",{style:{display:"flex",width:"100%",height:V?"52px":"36px",alignItems:"center",gap:"12px",borderRadius:"6px",backgroundColor:`${null===(J=null==e?void 0:e.meetingBanner)||void 0===J?void 0:J.backgroundColor}`,padding:"6px 12px",border:`1px solid ${null===(Y=null==e?void 0:e.meetingBanner)||void 0===Y?void 0:Y.borderColor}`,margin:"6px 0",boxSizing:"border-box"},"aria-label":U},i.createElement(r.I,{type:"Info",filled:!0,primaryColor:null===(Q=null==e?void 0:e.meetingBanner)||void 0===Q?void 0:Q.iconPrimaryColor}),i.createElement("span",{style:{fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",padding:"1px 0px 3px 0px",color:`${null===(Z=null==e?void 0:e.meetingBanner)||void 0===Z?void 0:Z.text}`}},U)),c?i.createElement(I.h,{theme:e,styles:u,htmlId:l,group:t,isScopableHeader:h,accessibilityPositionInSet:g+1,accessibilitySetSize:o,onClick:R,onGroupHovered:F,onHeightChange:M,onHeightExtraSpaceBottomChange:P,strings:a,displayNewItemTag:ee,newItemTagStyles:T,hasSelectionBeenModifiedViaKeyboard:v},oe):oe,ie)}));B.displayName="InlineSuggestionsGroup";const A=e=>{var{index:t,hasScopableHeader:o,onItemHeightChange:n}=e,r=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["index","hasScopableHeader","onItemHeightChange"]);const s=i.useCallback((e=>n(e,t-(o?1:0))),[t,o]);return i.createElement(_,Object.assign({},r,{onHeightChange:s}))}},2114:(e,t,o)=>{"use strict";o.d(t,{h:()=>p});var i=o(95734),n=o(54651),r=o(317),s=o(16971),a=o(22914),l=o(82512),c=o(97782),u=o(8821),d=o(68803),h=o(36382),g=o(43046);const p=i.memo((({group:e,htmlId:t,theme:o,style:p,styles:f,isScopableHeader:m,accessibilityPositionInSet:v,accessibilitySetSize:b,onClick:y,onGroupHovered:w,onHeightChange:C,onHeightExtraSpaceBottomChange:S,children:k,strings:T,displayNewItemTag:x,newItemTagStyles:_,hasSelectionBeenModifiedViaKeyboard:I})=>{var E,B,A,R,M,D;const P=i.useContext(s.O),F=i.useContext(s.b),{title:O,subtitle:N,isScoped:q=!1,isHighlighted:j,addBottomBorder:L}=e,[z,H]=i.useState(!1),W=null!=o?o:h.nk(void 0,P,F),U=null!=p?p:r.Js,G=Object.assign(Object.assign({},h.Fr(W)),r.L_(L)),V=i.useCallback((()=>{H(!0),null==w||w(e)}),[e,w]);if(S){let e=0;G.borderWidth&&(e="object"==typeof G.borderWidth?G.borderWidth.bottom?G.borderWidth.bottom:0:G.borderWidth),S(e)}if(m&&O){const e=null!==(E=null==f?void 0:f.titleLineHeight)&&void 0!==E?E:10,r=null!==(B=null==f?void 0:f.headerIconSize)&&void 0!==B?B:10;let s;s=(0,a.I)()?j?P?"CanvasText":"HighlightText":"CanvasText":(j||z)&&null!==(A=null==W?void 0:W.text.hover)&&void 0!==A?A:null==W?void 0:W.text.resting;const u={lineHeight:e+"px",display:"flex",width:q?"auto":"100%",flexDirection:q?"row-reverse":"row",justifyContent:"flex-end"},d={color:s,marginLeft:"4px",fontWeight:"600",flexGrow:q?0:1,fontSize:n.d4.xsmall,display:"flex",alignItems:"center"},p=q?"Previous":"Next",w=h.vA(W,j),{borderThickness:S,shadows:T}=(0,g.j)(f,P?(0,a.I)()?"Highlight":null!==(R=null==o?void 0:o.focusRing)&&void 0!==R?R:"var(--colorStrokeFocus2)":null!==(M=w.border)&&void 0!==M?M:"#000",!1,null!=I&&I,null!=j&&j,{useFluentV9:P}),x=m?"menuitem":"option",_=m&&q;return i.createElement(i.Fragment,null,i.createElement(l.u,{appearance:"subtle",hasKeyboardFocus:j,htmlId:t,icon:{type:p},automationLabel:O,title:O,titleStyle:n.D0(n.d4,(null==O?void 0:O.length)||0,!0),theme:w,onClick:y,style:Object.assign(Object.assign({flexibleSize:!0,borderRadius:4},f),{borderThickness:T?0:S,boxShadow:(null!==(D=null==T?void 0:T.length)&&void 0!==D?D:0)>0?T:void 0}),onHeightChange:C,onHoverIn:V,onHoverOut:()=>H(!1),accessibilityRole:x,accessibilityPositionInSet:v,accessibilitySetSize:b,accessibilityState:_,accessibilityDescribedByTooltip:!0,useFullWidth:!0},i.createElement("span",{"data-is-focusable":!0,style:u},i.createElement("span",{style:d},O),i.createElement(c.I,{type:p,primaryColor:s,fontSize:r,style:{margin:(e-r)/2}}))),k)}const $=x?null==T?void 0:T.inlineSuggestions("combineTag").replace("{0}",null!=O?O:"").replace("{1}",null==T?void 0:T.inlineSuggestions("newTagText")):O;return i.createElement(u.Y,{header:O,headerStyle:Object.assign(Object.assign(Object.assign({},r.B3(W,U,n.d4)),f),{userSelectable:!1}),subheader:N,subheaderStyle:Object.assign(Object.assign({},r.XC(W,U,n.d4)),f),componentStackStyle:G,stackDirection:d.PR.TopToBottom,stackAlignment:d.j5.Stretch,accessibleLive:d.pq.Off,accessibleLabel:$,onHeaderHeightChange:C,tagStyles:r.mX(W,_),tagText:x?null==T?void 0:T.inlineSuggestions("newTagText"):void 0},k)}));p.displayName="InlineSuggestionsGroupHeader"},21646:(e,t,o)=>{"use strict";if(o.d(t,{D:()=>m,r:()=>f}),3023==o.j)var i=o(39386);if(3023==o.j)var n=o(23612);if(3023==o.j)var r=o(59132);var s=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};function a(e){return e.type===i.c.Event}function l(e){return e.type===i.c.Message}function c(e){return e.type===i.c.File}function u(e){return e.type===i.c.People}function d(e){return e.type===i.c.Scope}function h(e){return e.type===i.c.Chat}function g(e){return e.type===i.c.CopilotPlugin}function p(e){return e.type===i.c.App}function f(e){return a(e)?e.eventId:l(e)?e.emailId:c(e)?e.fileName:u(e)?e.displayName:d(e)?e.id:h(e)?e.name:g(e)?e.previewCard.title:(p(e),e.title)}const m=(e,t,o,i,f,m,b)=>{var y,w,C,S,k,T,x,_,I,E,B,A,R,M,D;if(c(e)){const t=e.hitFileName||`${e.fileName}.${e.fileExtension}`,n=t.endsWith(`.${e.fileExtension}`),a=(null==o?void 0:o.fileItemStyles)||{},{iconStyles:l,titleFontSize:c,subtitleFontSize:u}=a,d=s(a,["iconStyles","titleFontSize","subtitleFontSize"]),h=(0,r.Z)(e.fileExtension),g="Files"===h,p=g?(null===(y=null==i?void 0:i.fallbackIcon)||void 0===y?void 0:y.background)||(null==l?void 0:l.backgroundColor):void 0,f=g&&!n?`.${e.fileExtension}`:"",m=g?6:void 0;return{suggestionId:e.itemId,suggestionType:e.type,title:t+f,titleFontSize:c,icon:{type:h,style:Object.assign(Object.assign({},l),{backgroundColor:p,padding:m,fontSize:16})||{backgroundColor:p}},style:d,subtitle:e.subject,subtitleFontSize:u,tooltip:t,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(u(e)){const t=(null==o?void 0:o.personItemStyles)||{},{personaCoinSize:n,titleFontSize:r,subtitleFontSize:a}=t,l=s(t,["personaCoinSize","titleFontSize","subtitleFontSize"]);return Object.assign(Object.assign({suggestionId:e.displayName,suggestionType:e.type,title:e.displayName,titleFontSize:r,personaCoinProps:{text:"",size:v(n),imageUrl:e.imageUrl,initials:e.initials,borderColor:null==i?void 0:i.userAvatarBorderColor}},e.iconName&&{icon:{type:e.iconName}}),{style:l,subtitle:null!==(w=e.subtitleOverride)&&void 0!==w?w:e.primaryEmailAddress,subtitleFontSize:a,truncateSubtitle:!0,tooltip:e.primaryEmailAddress,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes})}if(d(e)){const t=(null==o?void 0:o.scopeItemStyles)||{},{iconStyles:i,titleFontSize:r,subtitleFontSize:a,personaCoinSize:l}=t,c=s(t,["iconStyles","titleFontSize","subtitleFontSize","personaCoinSize"]),u=(0,n.S)(e.iconName);return{suggestionId:e.id,suggestionType:e.type,title:e.title,titleFontSize:r,icon:void 0===u||f?void 0:{type:u,style:i||{}},personaCoinProps:!e.imageUrl&&!e.iconName||f?void 0:{text:"",size:v(l),imageUrl:e.imageUrl,color:"neutral"},style:c,subtitle:e.subtitle,subtitleFontSize:a,tooltip:null!==(C=e.tooltip)&&void 0!==C?C:e.title,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,displayNewItemTag:e.isNew,enableExpandedECCScopeLayout:f,isScopeSelected:e.isSelected}}if(a(e)){const{eventId:n,eventName:r,eventStartDateTime:a,eventEndDateTime:l,isAllDay:c,isSeries:u,hasRecording:d}=e,h=(null==o?void 0:o.eventItemStyles)||{},{iconStyles:g,titleFontSize:p,subtitleFontSize:f}=h,v=s(h,["iconStyles","titleFontSize","subtitleFontSize"]),y=function(e,t,o,i="en-US"){let n="";const r=Date.parse(e);if(!Number.isNaN(r)){const e=new Date(r),s=Date.parse(t);if(Number.isNaN(s))n=o?e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i):e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i)+" "+e.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"});else{const t=new Date(s);n=e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()?o?e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i):e.toLocaleString(i,{weekday:"short"})+" "+e.toLocaleDateString(i)+" "+e.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"})+" - "+t.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"}):o?e.toLocaleDateString(i)+" - "+t.toLocaleDateString(i):e.toLocaleDateString(i)+" "+e.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"})+" - "+t.toLocaleDateString(i)+" "+t.toLocaleTimeString(i,{hour:"numeric",minute:"2-digit"})}}return n}(a,l,c,b),w=(null==t?void 0:t.inlineSuggestions("recordText"))||"",C=m&&d?y+" | "+w:y;return{suggestionId:n,suggestionType:e.type,title:r,titleFontSize:p,icon:{type:m&&d?"EventRecorded":u?"EventSeries":"Event",fontSize:u?16:14,style:Object.assign(Object.assign({},g),{backgroundColor:(null===(S=null==i?void 0:i.fallbackIcon)||void 0===S?void 0:S.background)||(null==g?void 0:g.backgroundColor)}),primaryColor:null===(k=null==i?void 0:i.fallbackIcon)||void 0===k?void 0:k.color},style:v,subtitle:C,subtitleFontSize:f,truncateSubtitle:!0,tooltip:r+" "+C,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(l(e)){const{subject:n,sender:r,emailId:a}=e,l=(null==o?void 0:o.emailItemStyles)||{},{iconStyles:c,titleFontSize:u,subtitleFontSize:d}=l,h=s(l,["iconStyles","titleFontSize","subtitleFontSize"]),g=null===(T=t.inlineSuggestions("emailSentBy"))||void 0===T?void 0:T.replace("{0}",r);return{suggestionId:a,suggestionType:e.type,title:n,titleFontSize:u,icon:{type:"Emails",fontSize:null!==(x=h.iconFontSize)&&void 0!==x?x:16,style:Object.assign(Object.assign({},c),{backgroundColor:(null===(_=null==i?void 0:i.fallbackIcon)||void 0===_?void 0:_.background)||(null==c?void 0:c.backgroundColor)}),primaryColor:null===(I=null==i?void 0:i.fallbackIcon)||void 0===I?void 0:I.color},style:h,subtitle:g,subtitleFontSize:d,truncateSubtitle:!0,tooltip:n,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(p(e)){const{title:t,imageUrl:o,collectorId:n,appType:r,subtitle:s,isMoreButton:a}=e;return{tooltip:t,suggestionId:n,suggestionType:e.type,title:t,appType:r,subtitle:s,icon:o?void 0:a?{type:"ExploreMoreCopilot",fontSize:32,style:{backgroundColor:null===(E=null==i?void 0:i.fallbackIcon)||void 0===E?void 0:E.background,height:32,width:32}}:{type:"ChatBubblesQuestion",fontSize:32,style:{backgroundColor:null===(B=null==i?void 0:i.fallbackIcon)||void 0===B?void 0:B.background,height:32,width:32}},personaCoinProps:o?{text:t,imageUrl:o,color:"neutral",size:32}:void 0,truncateSubtitle:!0,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,disableAccessibilityExpanded:!0,style:{flexibleSize:!0}}}if(h(e)){const{name:t,chatMembers:n,threadId:r,lastMessageTime:a,imageUrl:l}=e,c=(null==o?void 0:o.chatItemStyles)||{},{iconStyles:u,titleFontSize:d,subtitleFontSize:h,personaCoinSize:g}=c,p=s(c,["iconStyles","titleFontSize","subtitleFontSize","personaCoinSize"]),f=2,m=n.length-f;let b=n.slice(0,f).map((e=>e.displayName)).join(", ");m>0&&(b+=`, +${m}`);const y=t||b,w=new Date(a),C=w.toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric",hour12:!0}),S=`${w.toLocaleDateString("en-US")} ${C}`;return Object.assign({title:y,tooltip:y,subtitle:t?b:S,suggestionId:r,suggestionType:e.type,truncateSubtitle:!0,titleFontSize:d,subtitleFontSize:h,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,style:p},l?{personaCoinProps:{text:y,imageUrl:l,size:v(g),borderColor:null==i?void 0:i.userAvatarBorderColor}}:{icon:{type:"TeamsChat",style:Object.assign(Object.assign({},u),{backgroundColor:(null===(A=null==i?void 0:i.fallbackIcon)||void 0===A?void 0:A.background)||(null==u?void 0:u.backgroundColor)}),primaryColor:null===(R=null==i?void 0:i.fallbackIcon)||void 0===R?void 0:R.color}})}if(g(e)){const t=(null==o?void 0:o.genericItemStyles)||{},{iconStyles:i,personaCoinSize:n,titleFontSize:r,subtitleFontSize:a}=t,l=s(t,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),c=e.previewCard,u=null===(D=null===(M=c.images)||void 0===M?void 0:M[0])||void 0===D?void 0:D.url;return{suggestionId:c.title,suggestionType:e.type,title:c.title,titleFontSize:r,personaCoinProps:u?{text:"",size:v(n),imageUrl:u,color:"neutral"}:void 0,style:l,subtitle:c.subtitle,subtitleFontSize:a,tooltip:c.title,displayNewItemTag:e.isNew,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}const{id:P,title:F,subtitle:O,imageUrl:N,tooltip:q,type:j,isHighlighted:L}=e,z=(null==o?void 0:o.genericItemStyles)||{},{iconStyles:H,personaCoinSize:W,titleFontSize:U,subtitleFontSize:G}=z,V=s(z,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),$=(0,n.S)(e.iconName);return{suggestionId:P,suggestionType:j,title:F,titleFontSize:U,icon:void 0!==$?{type:$,style:H}:void 0,personaCoinProps:N||$?{text:"",size:v(W),imageUrl:N,color:"neutral"}:void 0,style:V,subtitle:O,subtitleFontSize:G,truncateSubtitle:!!q,tooltip:null!=q?q:F,isHighlighted:L,hitHighlightIndexes:e.hitHighlightIndexes,displayNewItemTag:e.isNew}},v=e=>e?e<20?16:e<24?20:e<28?24:e<32?28:e<36?32:e<40?36:e<48?40:e<56?48:e<64?56:e<72?64:e<96?72:e<120?96:e<128?120:128:20},43046:(e,t,o)=>{"use strict";if(o.d(t,{j:()=>n}),3023==o.j)var i=o(22914);function n(e,t,o,n,r,s){const a=o?null==e?void 0:e.borderThicknessInitialSelection:n?null==e?void 0:e.borderThicknessWithKeyboardFocus:void 0,l=r&&a?a:null==e?void 0:e.borderThickness;let c="number"==typeof l?l:null==l?void 0:l.start,u="number"==typeof l?l:null==l?void 0:l.end,d="number"==typeof l?l:null==l?void 0:l.top,h="number"==typeof l?l:null==l?void 0:l.bottom;(0,i.I)()&&(null==s?void 0:s.useFluentV9)&&(c=0===c?1:c,u=0===u?1:u,d=0===d?1:d,h=0===h?1:h);let g="";return c&&(g+=`inset ${c}px 0 0 0 ${t},`),u&&(g+=`inset -${u}px 0 0 0 ${t},`),d&&(g+=`inset 0 ${d}px 0 0 ${t},`),h&&(g+=`inset 0 -${h}px 0 0 ${t},`),g.length>0&&(g=g.substring(0,g.length-1)),{borderThickness:l,shadows:g}}},5534:(e,t,o)=>{"use strict";o.d(t,{x:()=>A});var i=o(95734);if(3023==o.j)var n=o(54651);if(3023==o.j)var r=o(317);if(3023==o.j)var s=o(62989);if(3023==o.j)var a=o(16971);if(3023==o.j)var l=o(66563);if(3023==o.j)var c=o(75033);if(3023==o.j)var u=o(36694);if(3023==o.j)var d=o(7313);if(3023==o.j)var h=o(68803);if(3023==o.j)var g=o(26483);if(3023==o.j)var p=o(5076);if(3023==o.j)var f=o(82512);if(3023==o.j)var m=o(87123);if(3023==o.j)var v=o(44357);if(3023==o.j)var b=o(73543);if(3023==o.j)var y=o(5823);if(3023==o.j)var w=o(37582);if(3023==o.j)var C=o(55428);if(3023==o.j)var S=o(68937);if(3023==o.j)var k=o(9161);if(3023==o.j)var T=o(77871);if(3023==o.j)var x=o(36382);if(3023==o.j)var _=o(2114);if(3023==o.j)var I=o(21646);if(3023==o.j)var E=o(39386);var B=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o};const A=({definition:e,theme:t,style:o,styles:A,strings:R,layerHostId:M,queryString:D,results:P,isError:F,isLoading:O,menuType:N,enableScopedHeader:q,enablePrefixHighlighting:j,enableStickyFooter:L,keyboardHandlerTarget:z,showMoreEntitiesConfig:H,browseThisComputerConfig:W,showDiscoveryPromoFooter:U,listID:G,noSuggestionsHeaderInfo:V,disableTooltips:$,moveSelectionOnHover:K,locale:J,showMeetingBanner:Y,enableMeetingBanner:Q,meetingBannerText:Z,isUnsupported:X,showPartialLoadingEntities:ee,onGroupSelected:te,onAction:oe,onItemSelected:ie,onFocus:ne,onFooterAction:re,onAfterUpdate:se,appGptConfig:ae})=>{var le,ce,ue;const de=i.useContext(a.O),he=i.useContext(a.b),ge=P.every((e=>{var t;return!(null===(t=e.suggestions)||void 0===t?void 0:t.length)||e.alwaysDisplay})),[pe,fe]=i.useState({type:"item",groupIndex:0,itemIndex:0}),me=i.useCallback((e=>{var t;e.type===v.E9?e.id===v.Es?null==oe||oe(y.L.Retry):e.id===v.WM&&(je(""),null==oe||oe(y.L.ClearSearch)):e.type===E.c.App&&void 0===e.AppType?null===(t=null==ae?void 0:ae.onClickExploreMoreCopilots)||void 0===t||t.call(ae):ie(e)}),[oe,ie]),ve=null!=o?o:r.Js,be=i.useMemo((()=>(0,C.H)(A,ve)),[A,ve]),ye={RenderFooterIcons:"true"},we=i.useRef(null),Ce=i.createRef(),Se=i.useRef({groupLayouts:[]}),[ke,Te]=i.useState(0),[xe,_e]=i.useState(!1),[Ie,Ee]=i.useState(void 0),[Be,Ae]=i.useState([]),Re=i.useCallback((e=>{Ae(e)}),[Ae]),[Me,De]=i.useState(!1),[Pe,Fe]=i.useState(),[Oe,Ne]=i.useState(!1),[qe,je]=i.useState(""),[Le,ze]=i.useState(!1),[He,We]=i.useState(!1),[Ue,Ge]=i.useState(!1),[Ve,$e]=i.useState(!0),Ke=i.useRef(null),{baseInlineSuggestionsGroups:Je,isScopedHeaderEnabled:Ye,itemsCount:Qe,itemsAndGroupHeadingCount:Ze,isGptMenu:Xe}=i.useMemo((()=>{var e,t;let o=!1;if(null==ae?void 0:ae.enableAppGpt){P[0]||(P[0]={suggestions:[]}),o=null===(e=P[0].suggestions)||void 0===e?void 0:e.every((e=>e.type===E.c.App));const i=null===(t=P[0].suggestions)||void 0===t?void 0:t.some((e=>e.isMoreButton));if((null==ae?void 0:ae.onClickExploreMoreCopilots)&&o&&!i){const e={type:E.c.App,title:(null==ae?void 0:ae.moreCopilotsStringOverride)||"Get Copilot extensions",isMoreButton:!0};P[0].suggestions.push(e)}}const i=(0,v.Oz)(O,F,ge,R,P,V,X),n=i.filter((e=>!1!==e.isScopingEnabled&&!!e.title)).length,r=q&&!Oe&&n>0&&!o,s=i.reduce(((e,t)=>t.suggestions.length+e),0);return{baseInlineSuggestionsGroups:i,isScopedHeaderEnabled:r,itemsCount:s,itemsAndGroupHeadingCount:r?s+n:s,isGptMenu:o}}),[O,F,ge,R,P,V]),et=i.useRef(),tt=i.useMemo((()=>void 0===pe?Je:"group"===pe.type?Je.map(((e,t)=>t===pe.groupIndex?Object.assign(Object.assign({},e),{isHighlighted:!0}):e)):Je.map(((e,t)=>t===pe.groupIndex?Object.assign(Object.assign({},e),{suggestions:e.suggestions.map(((e,t)=>t===pe.itemIndex?Object.assign(Object.assign({},e),{isHighlighted:!0}):e))}):e))),[pe,Je]),ot=(0,v.O5)(N),it=N&&"brandingMode"in N&&void 0!==N.brandingMode?N.brandingMode:void 0,nt=N&&"flag"in N?N.critiquePosition:void 0,rt=N&&"flag"in N?N.critiqueSetSize:void 0,st=null!=t?t:x.nk(it,de,he);i.useEffect((()=>{Fe({top:0,bottom:0,isNewRender:!0})}),[D]),i.useEffect((()=>{if(O)return;let e=Ye&&Je.length>0&&Je[0].title?1:0;Oe&&(null==W?void 0:W.isBrowseThisComputerEnabled)&&(e=-1,Fe({top:0,bottom:0,isNewRender:!0}),_e(!0)),ut(e,1===e),Te(e)}),[O,Oe,Je]);const at=Je.length;i.useEffect((()=>{we.current&&(clearTimeout(we.current),we.current=null),O?at?we.current=setTimeout((()=>De(!0)),v.al):De(!0):De(!1)}),[O,at]),i.useEffect((()=>{se&&e&&se(e)}));const lt=i.useCallback((e=>{e(Se.current)}),[]),ct=i.useCallback(((e,t)=>{t.type===v.E9?t.id===v.Es?null==ne||ne({focusedItemHtmlId:v.E9,selection:{type:"retryButton"}}):t.id===v.WM&&(null==ne||ne({focusedItemHtmlId:v.E9,selection:{type:"clearSearchButton"}})):null==ne||ne({focusedItemHtmlId:(0,v.Bn)(e),selection:{type:"item",item:t,positionInSet:e,setSize:Ze}})}),[Ze,ne]),ut=i.useCallback(((e,t)=>{var o,i,n,r,s;if(void 0===e)return fe(void 0),-1;e%=Ze;let a=0;const l={top:0,bottom:0};for(let c=0;c<Je.length;c++){const u=Je[c];if(l.top=l.bottom+(null===(o=Se.current.groupLayouts[c])||void 0===o?void 0:o.separatorHeight),l.bottom=l.top+(null===(i=Se.current.groupLayouts[c])||void 0===i?void 0:i.headerHeight),Ye&&!1!==u.isScopingEnabled&&u.title){if(e===a)return Fe(Object.assign(Object.assign({},l),{isNewRender:!!t})),null==ne||ne({focusedItemHtmlId:(0,v.Bn)(e),selection:{type:"group",group:u,positionInSet:e,setSize:Ze}}),c<Je.length&&fe({type:"group",groupIndex:c}),e;a++}for(let o=0;o<u.suggestions.length;o++){const i=u.suggestions[o];if(0!==o&&(l.top=l.bottom),l.bottom=l.bottom+(null!==(r=null===(n=Se.current.groupLayouts[c])||void 0===n?void 0:n.itemHeights[o])&&void 0!==r?r:0),o===u.suggestions.length-1&&(l.bottom+=null===(s=Se.current.groupLayouts[c])||void 0===s?void 0:s.extraSpaceBottomHeight),e===a)return Fe(Object.assign(Object.assign({},l),{isNewRender:!!t})),ct(e,i),c<Je.length&&o<Je[c].suggestions.length&&fe({type:"item",groupIndex:c,itemIndex:o}),e;a++}}return e}),[Je]),dt=i.useCallback((e=>{Ee(e),null==ne||ne({focusedItemHtmlId:(0,b.k)(Be[e]),selection:{type:"action",action:Be[e],positionInSet:e,setSize:Be.length}})}),[Be,ne,Ee]),ht=i.useRef(!0),gt=i.useCallback((e=>{K?($e(!1),Te(ut(e))):(ht.current||(0,l.i)())&&(Te(e),ut(void 0))}),[K,Je,ut]),pt=i.useCallback((e=>{const t=(0,I.r)(e);if(!t)return;const o=(()=>{let o=0;for(const i of Je){Ye&&!1!==i.isScopingEnabled&&i.title&&o++;for(const n of i.suggestions){if(n.type===e.type&&(0,I.r)(n)===t)return o;o++}}return o})();gt(o)}),[gt]),ft=i.useCallback((e=>{const t=(()=>{let t=0;for(const o of Je){if(Ye&&!1!==o.isScopingEnabled&&o.title){if(e.title===o.title&&e.subtitle===o.subtitle)return t;t++}t+=o.suggestions.length}return t})();gt(t)}),[gt]);(0,c.c)((()=>{ht.current=!0}));const mt=e=>{var t;switch(e){case u.h.ArrowDown:void 0===Ie?(dt(0),fe(void 0),Fe({top:1e4,bottom:1e4,isNewRender:!1})):Ie<Be.length-1?(dt(Ie+1),Fe({top:1e4,bottom:1e4,isNewRender:!1})):Oe&&(null==W?void 0:W.isBrowseThisComputerEnabled)?yt(e):(Te(ut(0)),Ee(void 0));break;case u.h.ArrowUp:0===Ie?(Ee(void 0),(null==H?void 0:H.isShowMoreEntitiesEnabled)&&!Oe?(fe(void 0),ze(!0),Fe({top:1e4,bottom:1e4,isNewRender:!1})):Te(ut(Ze-1))):void 0!==Ie&&Ie>0?(dt(Ie-1),Fe({top:1e4,bottom:1e4,isNewRender:!1})):(ut(void 0,!1),dt(Be.length-1),Fe({top:1e4,bottom:1e4,isNewRender:!1}));break;case u.h.Enter:case u.h.Tab:if(void 0===Ie)break;Be[Ie]===s._R.Overflow?null===(t=Ce.current)||void 0===t||t.openOverflowMenu(!0):null==re||re(Be[Ie])}},vt=()=>{var e;et.current=tt[0],Ne(!0),ze(!1),null===(e=null==H?void 0:H.onClickShowMoreEntities)||void 0===e||e.call(H,!0),Te(void 0)},bt=e=>{switch(e){case u.h.ArrowDown:Le?Be.length>0?(ze(!1),Ee(0)):(ze(!1),Te(ut(0))):(ut(ke,!1),ze(!0),Fe({top:1e4,bottom:1e4,isNewRender:!1}));break;case u.h.ArrowUp:Le?(ze(!1),Te(ut(Ze-1))):(ut(ke,!1),Ee(void 0),ze(!0),Fe({top:1e4,bottom:1e4,isNewRender:!1}));break;case u.h.Enter:case u.h.Tab:vt()}},yt=e=>{var t;const o=Qe-1===ke;switch(e){case u.h.ArrowDown:if(ot&&Ie===Be.length-1)Ee(void 0),Te(ut(void 0)),_e(!0);else{const e=!ot&&o&&!xe;_e(e),Te(e?void 0:ut((null!=ke?ke:-1)+1))}break;case u.h.ArrowUp:xe?(_e(!1),ot&&void 0===Ie?mt(e):Te(ut(Ze-1))):(ut(ke,!1),Te(void 0),_e(!0));break;case u.h.Enter:case u.h.Tab:null===(t=null==W?void 0:W.onClickBrowseThisComputer)||void 0===t||t.call(W)}},wt=e=>{if(e!==u.h.ArrowDown&&e!==u.h.ArrowUp&&e!==u.h.Enter&&e!==u.h.Tab&&e!==u.h.Home&&e!==u.h.End)return!1;switch(e){case u.h.ArrowDown:if(We(!0),Ge(!1),$e(!1),ht.current=!1,void 0!==Ie||ke===Ze-1||Le)!(null==H?void 0:H.isShowMoreEntitiesEnabled)||Oe||void 0!==Ie&&!Le?Be.length>0?mt(e):(null==W?void 0:W.isBrowseThisComputerEnabled)&&!Xe?yt(e):Te(ut(0)):bt(e);else if(!(null==W?void 0:W.isBrowseThisComputerEnabled)||Xe){const e=ut((null!=ke?ke:-1)+1);Te(e)}else yt(e);break;case u.h.ArrowUp:We(!0),Ge(!1),$e(!1),ht.current=!1,xe&&Oe?yt(e):0===ke&&Oe?(null==W?void 0:W.isBrowseThisComputerEnabled)?yt(e):ot?mt(e):Te(ut(Ze-1)):void 0!==Ie||0===ke||Le?(0===ke||void 0!==Ie)&&Be.length>0&&!Le?mt(e):Le||0===ke&&(null==H?void 0:H.isShowMoreEntitiesEnabled)&&!Oe&&(0===Ie||void 0===Ie)?bt(e):Te(ut(Ze-1)):Te(ut((null!=ke?ke:-1)-1));break;case u.h.Home:We(!0),Ge(!1),$e(!1),Te(ut(0)),ht.current=!1;break;case u.h.End:We(!0),Ge(!1),$e(!1),Te(ut(Ze-1)),ht.current=!1;break;case u.h.Enter:case u.h.Tab:{if(Le){bt(e);break}if(void 0!==Ie){mt(e);break}if(xe){yt(e);break}let t=0;Je.forEach((e=>{Ye&&!1!==e.isScopingEnabled&&e.title&&(ke===t&&(null==te||te(e)),t++),void 0!==ke&&ke>=t&&ke<t+e.suggestions.length&&me(e.suggestions[ke-t]),t+=e.suggestions.length}));break}default:return!1}return!0},Ct=e=>{z||wt(e.key)};i.useEffect((()=>(null==z||z.setKeyPressHandler(wt),()=>{null==z||z.setKeyPressHandler(void 0)})));const St=i.useRef(),kt=()=>{St.current&&clearTimeout(St.current),St.current=setTimeout((()=>{clearTimeout(St.current),St.current=void 0,Ge(!0)}),50)};i.useEffect(kt,[Pe]);const Tt=be.containerStyles||{},{paddingStart:xt,paddingEnd:_t,paddingHorizontal:It,paddingTop:Et,paddingBottom:Bt,paddingVertical:At,paddingScrollTop:Rt,scrollbarThumbWidth:Mt,scrollbarPaddingBottom:Dt}=Tt,Pt=B(Tt,["paddingStart","paddingEnd","paddingHorizontal","paddingTop","paddingBottom","paddingVertical","paddingScrollTop","scrollbarThumbWidth","scrollbarPaddingBottom"]),[Ft,Ot]=i.useState(null!==(ce=null===(le=be.gptViewStyles)||void 0===le?void 0:le.defaultContainerHeight)&&void 0!==ce?ce:250),{maxHeight:Nt}=Pt,qt=B(Pt,["maxHeight"]),jt=(null==ae?void 0:ae.enableAppGpt)&&Xe?Object.assign(Object.assign({},qt),{maxHeight:Ft,height:Ft}):Pt,Lt=null!=xt?xt:It,zt=null!=_t?_t:It,Ht=U&&N&&"flag"in N&&N.flag===s.z4.File,Wt=()=>i.createElement(T.R,{strings:{inlineSuggestions:R.inlineSuggestions}}),Ut=()=>{var e,t;return!ot||(null==ae?void 0:ae.enableAppGpt)?i.createElement(i.Fragment,null):i.createElement(b.w,{ref:Ce,theme:x.Dj(st),definition:{critiqueType:s.L9.InlineSuggestion,flagType:N&&"flag"in N?N.flag:void 0,brandingMode:it,onlyShowFeedbackButton:L,actions:(0,v.Jx)(N),critiquePosition:nt,critiqueSetSize:rt},layerHostId:M,strings:R,settings:ye,onAction:re,overflowMenuCalloutStyle:null===(e=null==be?void 0:be.footerStyles)||void 0===e?void 0:e.overflowMenuCalloutStyles,footerContainerStyle:be.footerStyles,footerButtonStyle:be.footerStyles.buttonStyles,overflowMenuButtonStyle:null!==(t=be.footerStyles.buttonStyles)&&void 0!==t?t:be.footerStyles.overFlowButtonStyles,setFooterActionIdList:Re,selectedButtonIndex:Ie,showPreviewTooltipForBranding:!0})},Gt=(null==H?void 0:H.isShowMoreEntitiesEnabled)&&!Oe&&!(F||ge||X);return i.createElement(d.S,{style:Object.assign(Object.assign(Object.assign({},n.uI(st,void 0,{useFluentV9:de})),jt),{hideFocusBox:!0}),align:h.j5.Stretch,focusable:!0,onKeyDown:Ct,handledKeys:[u.h.ArrowDown,u.h.ArrowUp,u.h.Enter,u.h.Tab,u.h.Home,u.h.End],accessibilityRole:Me||F||ge||X?void 0:"group",accessible:!0,accessibilityLabel:R.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel"),nativeID:G},i.createElement(g.B,{scrollDirection:"vertical",style:{paddingStart:Lt,paddingEnd:zt,paddingTop:Et,paddingBottom:Bt,paddingVertical:At,paddingScrollTop:Rt,scrollbarThumbWidth:Mt,scrollbarPaddingBottom:Dt,borderRadius:Pt.borderRadius},theme:{thumbColor:null===(ue=null==st?void 0:st.scroll)||void 0===ue?void 0:ue.thumbColor},onScroll:kt,onScrollStatusChange:e=>{e&&$e(!1)},scrollTo:Pe,hidden:Me,alwaysShowScrollbar:(null==ae?void 0:ae.enableAppGpt)&&Xe},i.createElement(p.R,{disableInitialFocus:!0},i.createElement(d.S,{align:h.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:R.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel")},Oe&&i.createElement(i.Fragment,null,(null==H?void 0:H.displayGroupHeaderDuringSearch)&&et.current?i.createElement(_.h,{theme:st,styles:null==be?void 0:be.headerStyles,group:et.current,isScopableHeader:!1,onHeightChange:e=>{Se.current.groupLayouts[0]||(Se.current.groupLayouts[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),Se.current.groupLayouts[0].headerHeight=e},onHeightExtraSpaceBottomChange:e=>{Se.current.groupLayouts[0]||(Se.current.groupLayouts[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),Se.current.groupLayouts[0].extraSpaceBottomHeight=e},strings:R,displayNewItemTag:!1}):void 0,i.createElement(d.S,{direction:h.PR.LeftToRight},!0!==(null==H?void 0:H.shouldOnlyShowSearchBox)?i.createElement("span",{style:{flexGrow:0,flexShrink:0}},i.createElement(f.u,{appearance:"subtle",style:r.Ek,automationLabel:"InlineSuggestionBackButton",onClick:()=>{var e;Ne(!1),null===(e=null==H?void 0:H.onCloseShowMoreEntities)||void 0===e||e.call(H,!1),Te(0)},theme:x.VD(st),icon:{type:"Previous",style:r.dt}})):void 0,i.createElement(S.y,{theme:st,style:null==be?void 0:be.searchBoxStyles,htmlId:null==H?void 0:H.searchBoxHtmlId,autoFocus:!0,handledKeys:[u.h.ArrowDown,u.h.ArrowUp,u.h.Enter,u.h.Tab,u.h.Home,u.h.End],onKeyDown:e=>{wt(e.key)},placeholder:(null==H?void 0:H.searchBoxPlaceHolder)||"",value:qe,onValueChange:e=>{var t;je(e),null===(t=null==H?void 0:H.onSearchChange)||void 0===t||t.call(H,e)},onClear:()=>{var e;je(""),null===(e=null==H?void 0:H.onSearchClear)||void 0===e||e.call(H)}}))),(null==W?void 0:W.isBrowseThisComputerEnabled)&&Oe&&i.createElement(k.i,{handledKeys:[u.h.ArrowDown,u.h.ArrowUp,u.h.Enter,u.h.Tab,u.h.Home,u.h.End],onKeyDown:Ct,strings:R,browseThisComputerButtonLabel:null==W?void 0:W.browseThisComputerButtonLabel,isBrowseThisComputerEnabled:xe,hasSelectionBeenModifiedViaKeyboard:He,browseThisComputerHtmlId:null==W?void 0:W.browseThisComputerHtmlId,onClickBrowseThisComputer:null==W?void 0:W.onClickBrowseThisComputer,theme:x.Ui(st,xe)}),i.createElement(w.p,{suggestionsRef:Ke,theme:st,styles:be,strings:R,locale:J,results:tt,isShimmerVisible:Me,enableScopedHeader:Ye,itemsCount:Ze,itemQueryString:D,onGroupSelected:te,onGroupHovered:ft,onItemHovered:pt,onItemSelected:me,enablePrefixHighlighting:j,isGroupHeaderVisible:!Oe&&!Xe,hasSelectionBeenModifiedViaKeyboard:He,showKeyboardTooltip:Ue,isInitialSelection:Ve,layerHostId:M,disableTooltips:$,updateMenuLayout:lt,updateItemHeight:e=>{var t,o;const i=Math.min(null!==(o=null===(t=P[0])||void 0===t?void 0:t.suggestions.length)&&void 0!==o?o:1,5);Ot(e*i+(null!=Et?Et:0)+(null!=Bt?Bt:0))},showMeetingBanner:Y,enableMeetingBanner:Q,meetingBannerText:Z,showPartialLoadingEntities:ee}),Gt&&i.createElement(f.u,{appearance:"subtle",automationLabel:"InlineSuggestionMoreEntitiesButton",title:H.showMoreEntitiesButtonLabel,useFullWidth:!0,accessibilityRole:"option",theme:x.zN(st,Le),onClick:vt}))),N&&"flag"in N&&N.flag===s.z4.SatoriEntity&&i.createElement(d.S,{style:{paddingHorizontal:n.QL}},i.createElement(m.R,{url:(0,v.MN)(D),text:R.inlineSuggestions("seeMoreHyperLinkLabel"),theme:x.fj(st),style:r.v9(),inline:!1})),!L&&Ut(),!L&&Ht&&Wt()),L&&Ut(),L&&Ht&&Wt())}},37582:(e,t,o)=>{"use strict";o.d(t,{p:()=>h});var i=o(95734),n=o(16971),r=o(7313),s=o(68803),a=o(67787),l=o(5202),c=o(44357),u=o(317),d=o(36382);const h=i.memo((({theme:e,styles:t,strings:o,results:l,isShimmerVisible:h,enableScopedHeader:p,enablePrefixHighlighting:f,layerHostId:m,itemsCount:v,itemQueryString:b,isGroupHeaderVisible:y,hasSelectionBeenModifiedViaKeyboard:w,canDisableSuggestionTabFocus:C,showKeyboardTooltip:S,isInitialSelection:k,disableTooltips:T,showMeetingBanner:x,enableMeetingBanner:_,meetingBannerText:I,isSmallWindow:E,suggestionsRef:B,locale:A,showPartialLoadingEntities:R,onGroupSelected:M,onGroupHovered:D,onItemHovered:P,onItemSelected:F,updateMenuLayout:O,updateItemHeight:N})=>{var q,j;const L=i.useContext(n.O),z=i.useContext(n.b),H=null!=e?e:d.nk(void 0,L,z);let W=0;return h?i.createElement(a.I,{hideTitle:!y,style:null==t?void 0:t.shimmerStyles,inlineSuggestionsTheme:H}):i.createElement(r.S,{ref:B,style:{marginEnd:null===(q=null==t?void 0:t.containerStyles)||void 0===q?void 0:q.marginEnd,height:null===(j=null==t?void 0:t.gptViewStyles)||void 0===j?void 0:j.height,backgroundColor:z?H.background.resting:"unset"},align:s.j5.Stretch},l.map(((e,n)=>{const r=e.suggestions,s=p&&!1!==e.isScopingEnabled&&void 0!==e.title,a=i.createElement(g,{theme:H,styles:t,strings:o,key:`suggestion-group-${n}`,entryIndex:n,itemsCount:v,cumulativeCount:W,group:e,locale:A,layerHostId:m,accessibilitySetSize:v,headerHtmlId:(0,c.Bn)(W),headerStyles:null==t?void 0:t.headerStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:W,hasScopableHeader:s,enablePrefixHighlighting:f,onGroupSelected:M,onGroupHovered:D,itemsStyles:null==t?void 0:t.itemsStyles,itemQueryString:b,onItemHovered:P,onItemSelected:F,showSeparator:e.showSeparator,isHeaderVisible:y,canDisableTabFocus:C,separatorProps:e.showSeparator&&u.g4||void 0,hasSelectionBeenModifiedViaKeyboard:w,showKeyboardTooltip:S,isInitialSelection:k,disableTooltips:T||e.disableTooltips,showMeetingBanner:x&&0===n,enableMeetingBanner:_,meetingBannerText:I,isSmallWindow:E,updateMenuLayout:O,updateItemHeight:N,showPartialLoadingEntities:R,shimmerStyles:null==t?void 0:t.shimmerStyles});return s&&(W+=1),W+=r.length,a})))}));h.displayName="InlineSuggestionsResultBody";const g=e=>{var{styles:t,group:o,entryIndex:n,itemsCount:r,cumulativeCount:s,onGroupSelected:a,updateMenuLayout:u,updateItemHeight:d,showPartialLoadingEntities:h}=e,g=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["styles","group","entryIndex","itemsCount","cumulativeCount","onGroupSelected","updateMenuLayout","updateItemHeight","showPartialLoadingEntities"]);const p=i.useCallback((()=>null==a?void 0:a(o)),[a,o]),f=i.useCallback((e=>u((t=>{t.groupLayouts[n]||(t.groupLayouts[n]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),t.groupLayouts[n].headerHeight=e}))),[]),m=i.useCallback((e=>u((t=>{t.groupLayouts[n]||(t.groupLayouts[n]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),t.groupLayouts[n].extraSpaceBottomHeight=e}))),[]),v=i.useCallback((e=>u((t=>{t.groupLayouts[n]||(t.groupLayouts[n]={headerHeight:0,separatorHeight:e,extraSpaceBottomHeight:0,itemHeights:[]}),t.groupLayouts[n].separatorHeight=e}))),[]),b=i.useCallback(((e,t)=>u((o=>{o.groupLayouts[n]||(o.groupLayouts[n]={headerHeight:0,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),o.groupLayouts[n].itemHeights[t]=e}))),[]);return i.createElement(l.K,Object.assign({},g,{group:o,accessibilitySetSize:r,headerHtmlId:(0,c.Bn)(s),headerStyles:null==t?void 0:t.headerStyles,newItemTagStyles:null==t?void 0:t.newItemTagStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:s,onHeaderClick:p,onHeaderHeightChange:f,onHeightExtraSpaceBottomChange:m,onSeparatorHeightChange:v,itemsStyles:null==t?void 0:t.itemsStyles,onItemHeightChange:b,updateItemHeight:d,showPartialLoadingEntities:h}))}},44357:(e,t,o)=>{"use strict";o.d(t,{Bn:()=>a,E9:()=>i,Es:()=>r,Jx:()=>c,MN:()=>u,O5:()=>l,Oz:()=>d,WM:()=>s,al:()=>n});const i="noSuggestions",n=2e3,r="Retry",s="ClearSearch",a=(e,t)=>(t?"header-option":"option")+e,l=e=>!!e&&("InlineSuggestionsResultsUserInitiatedMenuType"===e.menuType?void 0!==e.brandingMode:"InlineSuggestionsResultsFlagMenuType"===e.menuType),c=e=>e&&"actions"in e?e.actions:[],u=e=>"https://www.bing.com/q="+e,d=(e=!1,t,o,n,a,l,c)=>{if(e&&o)return[];const u=h(a);if(t)return[Object.assign(Object.assign({},l),{disableTooltips:!0,suggestions:[{id:r,type:i,title:n.inlineSuggestions("tryAgainLabel"),noSuggestionsDescription:n.inlineSuggestions("somethingWentWrongLabel")}]}),...u.filter((e=>e.alwaysDisplay))];if(o||c){const e=o?"clearSearchLabel":"showAvailableSuggestionsLabel";return[Object.assign(Object.assign({},l),{disableTooltips:!0,suggestions:[{id:s,type:i,title:n.inlineSuggestions(e),noSuggestionsDescription:n.common("suggestionsGroupNoSuggestionsText")}]}),...u.filter((e=>e.alwaysDisplay))]}return u},h=e=>{if(e instanceof Array){const t=[];return e.forEach((e=>t.push(h(e)))),t}if("object"==typeof e){const t={};for(const o in e)t[o]=h(e[o]);return t}return e}},68937:(e,t,o)=>{"use strict";o.d(t,{y:()=>s});var i=o(95734),n=o(7313),r=o(48803);const s=i.memo((e=>{var t,o,s,a,l,c,u,d,h,g,p,f,m,v,{style:b,theme:y}=e,w=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["style","theme"]);return i.createElement(i.Fragment,null,i.createElement(n.S,{style:{marginBottom:null!==(t=null==b?void 0:b.marginBottom)&&void 0!==t?t:8,marginTop:null!==(o=null==b?void 0:b.marginTop)&&void 0!==o?o:8,marginStart:null!==(s=null==b?void 0:b.marginStart)&&void 0!==s?s:0,marginEnd:null!==(a=null==b?void 0:b.marginEnd)&&void 0!==a?a:12,width:"100%",minWidth:0}},i.createElement(r.G,Object.assign({},w,{autoComplete:!1,spellCheck:!1,accessibilityLabel:"InlineSuggestionsSearchBox",styles:{borderRadius:4,width:"100%",borderBottom:`${null===(l=null==y?void 0:y.searchBox)||void 0===l?void 0:l.borderBottomColor} solid 1px`},theme:{background:null==y?void 0:y.background.resting,textColor:null===(c=null==y?void 0:y.text)||void 0===c?void 0:c.resting,placeholderTextColor:null===(u=null==y?void 0:y.text)||void 0===u?void 0:u.disabled,clearButton:{hover:null===(d=null==y?void 0:y.background)||void 0===d?void 0:d.hover,resting:null===(h=null==y?void 0:y.background)||void 0===h?void 0:h.resting},iconColor:null===(g=null==y?void 0:y.searchBox)||void 0===g?void 0:g.iconColor,borderColor:{hover:null===(f=null===(p=null==y?void 0:y.searchBox)||void 0===p?void 0:p.borderColor)||void 0===f?void 0:f.hover,resting:null===(v=null===(m=null==y?void 0:y.searchBox)||void 0===m?void 0:m.borderColor)||void 0===v?void 0:v.resting}}}))))}));s.displayName="InlineSuggestionsSearchBox"},67787:(e,t,o)=>{"use strict";o.d(t,{I:()=>c,n:()=>l});var i=o(95734);if(3023==o.j)var n=o(84226);if(3023==o.j)var r=o(29572);if(3023==o.j)var s=o(7313);if(3023==o.j)var a=o(68803);const l=({style:e})=>{var t,o,s,a;const l=null!==(t=null==e?void 0:e.itemPaddingVertical)&&void 0!==t?t:6,c=null!==(o=null==e?void 0:e.itemPaddingHorizontal)&&void 0!==o?o:12,u=null!==(s=null==e?void 0:e.textPaddingLeft)&&void 0!==s?s:8,d=null!==(a=null==e?void 0:e.personaCoinSize)&&void 0!==a?a:24;return i.createElement(n.E,{style:{paddingTop:l,paddingBottom:l,paddingLeft:c,paddingRight:c}},i.createElement("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:u,alignItems:"center"}},i.createElement(r.H,{shape:"circle",style:{width:d,height:d}}),i.createElement("div",{style:{display:"flex",flexDirection:"column",gap:4,paddingTop:4,paddingBottom:4}},i.createElement(r.H,{style:{height:14}}),i.createElement(r.H,{style:{height:10,width:"80%"}}))))},c=({hideTitle:e,style:t})=>{var o,c;const u=null!==(o=null==t?void 0:t.itemPaddingHorizontal)&&void 0!==o?o:12,d=((null!==(c=null==t?void 0:t.titleLineHeight)&&void 0!==c?c:16)-12)/2+10;return i.createElement(s.S,{align:a.j5.Stretch,style:{width:"100%"}},!e&&i.createElement(n.E,{style:{paddingLeft:u,paddingRight:u}},i.createElement(r.H,{style:{height:12,width:80,marginTop:d,marginBottom:d}})),i.createElement(l,{style:t}),i.createElement(l,{style:t}),i.createElement(l,{style:t}),i.createElement(l,{style:t}),i.createElement(l,{style:t}))}},55428:(e,t,o)=>{"use strict";if(o.d(t,{H:()=>r}),3023==o.j)var i=o(54651);if(3023==o.j)var n=o(317);const r=(e={},t)=>Object.assign(Object.assign({},e),{containerStyles:s(e.containerStyles,t),shimmerStyles:a(e),headerStyles:l(e.headerStyles),itemsStyles:u(e.itemsStyles,t),footerStyles:C(e.footerStyles)}),s=(e={},t)=>{var o,i;return Object.assign({minWidth:240,maxWidth:null!==(o=null==t?void 0:t.menuMaxWidth)&&void 0!==o?o:240,maxHeight:null!==(i=null==t?void 0:t.menuHeight)&&void 0!==i?i:252,borderRadius:8,paddingTop:4,paddingBottom:4,paddingHorizontal:4},e)},a=(e={})=>{var t,o,i,n,r,s,a;const l=null===(t=null==e?void 0:e.itemsStyles)||void 0===t?void 0:t.genericItemStyles;return Object.assign({itemPaddingVertical:null!==(o=null==l?void 0:l.paddingVertical)&&void 0!==o?o:6,itemPaddingHorizontal:null!==(i=null==l?void 0:l.paddingHorizontal)&&void 0!==i?i:12,textPaddingLeft:null!==(n=null==l?void 0:l.textPaddingStart)&&void 0!==n?n:8,personaCoinSize:null!==(r=null==l?void 0:l.personaCoinSize)&&void 0!==r?r:24,titleLineHeight:null!==(a=null===(s=null==e?void 0:e.headerStyles)||void 0===s?void 0:s.titleLineHeight)&&void 0!==a?a:16},e.shimmerStyles)},l=(e={})=>Object.assign({},e),c=(e={},t={},o={})=>({item:Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),n.ZD.item),t),e.item),description:Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),n.ZD.description),t),e.description)}),u=(e={},t)=>({genericItemStyles:g(e.genericItemStyles,e.sharedItemStyles,t),personItemStyles:p(e.personItemStyles,e.sharedItemStyles,t),fileItemStyles:f(e.fileItemStyles,e.sharedItemStyles,t),scopeItemStyles:m(e.scopeItemStyles,e.sharedItemStyles,t),eventItemStyles:v(e.eventItemStyles,e.sharedItemStyles,t),emailItemStyles:b(e.emailItemStyles,e.sharedItemStyles,t),chatItemStyles:w(e.chatItemStyles,e.sharedItemStyles,t),appGptItemStyles:y(e.appGptItemStyles,e.sharedItemStyles,t),noSuggestionsStyles:c(e.noSuggestionsStyles,e.sharedItemStyles,t)}),d=e=>{var t,o;return Object.assign(Object.assign({},n.cK),{borderRadius:null!==(t=null==e?void 0:e.itemBorderRadius)&&void 0!==t?t:n.cK.borderRadius,height:null!==(o=null==e?void 0:e.itemHeight)&&void 0!==o?o:n.cK.height})},h=e=>Object.assign(Object.assign({},n.nI),(null==e?void 0:e.itemIconSize)?{width:e.itemIconSize,height:e.itemIconSize,minWidth:e.itemIconSize}:{}),g=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},p=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e)},f=(e={},t={},o)=>Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)}),m=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},v=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},b=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},y=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign(Object.assign({},h(o)),null==e?void 0:e.iconStyles)})},w=(e={},t={},o)=>{var i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},d(o)),{personaCoinSize:null!==(i=null==o?void 0:o.itemIconSize)&&void 0!==i?i:24}),t),e),{iconStyles:Object.assign({width:24,height:24,borderRadius:20},null==e?void 0:e.iconStyles)})},C=(e={})=>Object.assign(Object.assign(Object.assign({},i.Y_),{height:45,paddingTop:6,paddingBottom:4,paddingHorizontal:6,marginTop:-4,marginHorizontal:-4,marginBottom:4,transform:"translateY(4px)"}),e)},93098:(e,t,o)=>{"use strict";o.d(t,{Y:()=>P});var i=o(16971),n=o(95734),r=o(82512),s=o(46914),a=o(62153);const l={width:32,height:32,border:"0",borderRadius:4,paddingHorizontal:0,paddingVertical:0},c=e=>{const t=n.useContext(i.O),o=n.useCallback((()=>{var t;null===(t=e.onFocus)||void 0===t||t.call(e,e.item.menuItemFocusId)}),[e.onFocus,e.item.menuItemFocusId]);return n.createElement("div",{className:a.j,style:e.accentSuggestionColors,key:e.item.menuItemIcon},n.createElement(r.u,{htmlId:e.item.menuItemFocusId,key:e.item.menuItemText,accessibilityRole:"button",accessibilityLabel:e.item.menuItemText,automationLabel:e.item.menuItemText,appearance:"transparent",onClick:e.item.onClickHandler,onFocus:o,theme:e.theme,iconComponent:t?(e=>{if(e)return"ArrowUpload"===e?n.createElement(s.hhx,null):void 0})(e.item.menuItemIcon):void 0,icon:(e=>{if(e)switch(e){case"OneDrive":return{type:"OneDrive"};case"ArrowUpload":return t?void 0:{type:"Upload"};default:return}})(e.item.menuItemIcon),tooltip:e.item.menuItemText,style:l}))};var u=o(9306),d=o(58099),h=o(25161),g=o(89942),p=o(60839),f=o(18861),m=o(87579),v=o(36216),b=o(55009),y=o(27760),w=o(63649),C=o(35203);const S=(0,y.X)({base:{D0sxk3:"fxoiby5",t6yez3:"f15q0o9g"},outline:{g2u3we:"f1ly1fcm",h3c5rm:["fi8bssc","fj6btzu"],B9xav0g:"f1s9tnsa",zhjwy3:["fj6btzu","fi8bssc"],B4j52fo:"fgx37oo",Bekrc4i:["f130t4y6","f1efpmoh"],Bn0qgzm:"fv51ejd",ibv6hh:["f1efpmoh","f130t4y6"],sj55zd:"f14nttnl"},primary:{De3pzq:"f8w4g0q"},secondary:{De3pzq:"f1nfm20t",g2u3we:"f1ly1fcm",h3c5rm:["fi8bssc","fj6btzu"],B9xav0g:"f1s9tnsa",zhjwy3:["fj6btzu","fi8bssc"],sj55zd:"f14nttnl"},subtle:{De3pzq:"fq5gl1p",sj55zd:"f1eryozh"},transparent:{De3pzq:"f1q9pm1r",sj55zd:"f1qj7y59"}},{d:[".fxoiby5 .fui-Icon-filled{display:inline;}",".f15q0o9g .fui-Icon-regular{display:none;}",".f1ly1fcm{border-top-color:var(--colorNeutralStroke1Selected);}",".fi8bssc{border-right-color:var(--colorNeutralStroke1Selected);}",".fj6btzu{border-left-color:var(--colorNeutralStroke1Selected);}",".f1s9tnsa{border-bottom-color:var(--colorNeutralStroke1Selected);}",".fgx37oo{border-top-width:var(--strokeWidthThicker);}",".f130t4y6{border-right-width:var(--strokeWidthThicker);}",".f1efpmoh{border-left-width:var(--strokeWidthThicker);}",".fv51ejd{border-bottom-width:var(--strokeWidthThicker);}",".f14nttnl{color:var(--colorNeutralForeground1Selected);}",".f8w4g0q{background-color:var(--colorBrandBackgroundSelected);}",".f1nfm20t{background-color:var(--colorNeutralBackground1Selected);}",".fq5gl1p{background-color:var(--colorSubtleBackgroundSelected);}",".f1eryozh{color:var(--colorNeutralForeground2Selected);}",".f1q9pm1r{background-color:var(--colorTransparentBackgroundSelected);}",".f1qj7y59{color:var(--colorNeutralForeground2BrandSelected);}"]}),k=(0,y.X)({outline:{sj55zd:"f14nttnl"},primary:{},secondary:{sj55zd:"f14nttnl"},subtle:{sj55zd:"f1qj7y59"},transparent:{sj55zd:"f1qj7y59"},highContrast:{ze5xyy:"f4xjyn1"}},{d:[".f14nttnl{color:var(--colorNeutralForeground1Selected);}",".f1qj7y59{color:var(--colorNeutralForeground2BrandSelected);}"],m:[["@media (forced-colors: active){.f4xjyn1:hover{color:Highlight;}}",{m:"(forced-colors: active)"}]]}),T=(0,y.X)({base:{Bg96gwp:"fez10in"},small:{Be2twd7:"f1ugzwwg",Bqenvij:"fvblgha",Bg96gwp:"fwrc4pm",a9b677:"frx94fk"},medium:{Be2twd7:"f1ugzwwg",Bqenvij:"fvblgha",Bg96gwp:"fwrc4pm",a9b677:"frx94fk"},large:{Be2twd7:"f4ybsrx",Bqenvij:"fd461yt",Bg96gwp:"faaz57k",a9b677:"fjw5fx7"},notIconOnly:{Frg6f3:["fbyavb5","fm0x6gh"]}},{d:[".fez10in{line-height:0;}",".f1ugzwwg{font-size:12px;}",".fvblgha{height:12px;}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".frx94fk{width:12px;}",".f4ybsrx{font-size:16px;}",".fd461yt{height:16px;}",".faaz57k{line-height:var(--lineHeightBase400);}",".fjw5fx7{width:16px;}",".fbyavb5{margin-left:var(--spacingHorizontalXS);}",".fm0x6gh{margin-right:var(--spacingHorizontalXS);}"]});var x=o(34877);const _=n.forwardRef(((e,t)=>{const o=(({menuIcon:e,...t},o)=>{const i=(0,b.P)(t,o);return i.root["aria-expanded"]=!!t["aria-expanded"]&&("true"===t["aria-expanded"]||!0===t["aria-expanded"]),{...i,iconOnly:Boolean(!t.children),components:{root:"button",icon:"span",menuIcon:"span"},menuIcon:v.lq(e,{defaultProps:{children:n.createElement(m.yuG,null)},renderByDefault:!0,elementType:"span"})}})(e,t);return(e=>{const t=S(),o=k(),i=T();e.root.className=(0,w.z)("fui-MenuButton",e.root["aria-expanded"]&&t.base,e.root["aria-expanded"]&&t[e.appearance],e.root.className),e.icon&&(e.icon.className=(0,w.z)("fui-MenuButton__icon",e.root["aria-expanded"]&&o[e.appearance]&&o.highContrast,e.icon.className)),e.menuIcon&&(e.menuIcon.className=(0,w.z)("fui-MenuButton__menuIcon",i.base,i[e.size],!e.iconOnly&&i.notIconOnly,e.menuIcon.className)),(0,C.B)({...e,iconPosition:"before"})})(o),(0,x.$e)("useMenuButtonStyles_unstable")(o),(e=>{(0,f.C)(e);const{icon:t,iconOnly:o}=e;return(0,p.FD)(e.root,{children:[e.icon&&(0,p.Y)(e.icon,{}),!o&&e.root.children,(!o||!(null==t?void 0:t.children))&&e.menuIcon&&(0,p.Y)(e.menuIcon,{})]})})(o)}));_.displayName="MenuButton";var I=o(35818),E=o(87503),B=o(97782);const A=n.memo((({dropDownButtonFocusId:e,menuButtonText:t,menuButtonIcon:o,enableMenuButtonIcon:i,menuItems:r,open:s,isUploadButtonHighlighted:a,onTriggerFocus:l,onOpenChange:c,onClick:p,appearance:f,containerElement:m,menuButtonTooltip:v})=>{const b=n.useRef(null);n.useEffect((()=>{var e;a&&(null===(e=b.current)||void 0===e||e.focus())}),[a]);const y=r.map(((e,t)=>n.createElement(u.D,{id:e.menuItemFocusId,key:t,icon:e.enableMenuItemIcon&&e.menuItemIcon?n.createElement(B.I,{type:e.menuItemIcon,filled:!0}):void 0,onFocus:e.onFocus,onClick:()=>e.onClickHandler()},e.menuItemText)));return n.createElement(d.W,{positioning:"below-end",open:s,onOpenChange:c,mountNode:m},n.createElement(h.c,{disableButtonEnhancement:!0},n.createElement(g.m,{content:v||"",relationship:"label",visible:!!v&&void 0},n.createElement(_,{ref:b,id:e,menuIcon:null,onClick:p,onFocus:l,icon:i&&o?n.createElement(B.I,{type:o}):void 0,appearance:f},t))),n.createElement(I.b,null,n.createElement(E.c,null,y)))}));A.displayName="FluentMenu";var R=o(7313),M=o(68803),D=o(317);const P=n.memo((e=>{var{fluentMenuConfig:t,enableCloudPicker:o,strings:s,theme:a,uploadFileButtonA11yLabel:l,uploadFileButtonLabel:u,onClickBrowseThisComputer:d,hasSelectionBeenModifiedViaKeyboard:h,iconOnly:g,isUploadButtonHighlighted:p,open:f,onOpenChange:m,onTriggerButtonFocus:v,onMenuItemFocus:b,containerElement:y}=e,w=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(o[i[n]]=e[i[n]])}return o}(e,["fluentMenuConfig","enableCloudPicker","strings","theme","uploadFileButtonA11yLabel","uploadFileButtonLabel","onClickBrowseThisComputer","hasSelectionBeenModifiedViaKeyboard","iconOnly","isUploadButtonHighlighted","open","onOpenChange","onTriggerButtonFocus","onMenuItemFocus","containerElement"]);const C=n.useContext(i.b),S=(0,D.z0)(g),k=C?void 0:Object.assign(Object.assign({},S.icon),{width:16,height:16});return n.createElement(R.S,{direction:M.PR.LeftToRight,align:M.j5.Stretch},o&&t&&C?(e=>{const t=[],o=[],i=[];for(const n of e)"ArrowUpload"===n.menuItemIcon?t.push(Object.assign({onFocus:()=>b(n.menuItemFocusId)},n)):"OneDrive"===n.menuItemIcon?o.push(Object.assign({onFocus:()=>b(n.menuItemFocusId)},n)):i.push(Object.assign({onFocus:()=>b(n.menuItemFocusId)},n));return[...t,...o,...i]})(t.menuItems).map((e=>n.createElement(c,{item:e,theme:a,accentSuggestionColors:w.accentSuggestionColors,key:e.menuItemText,onFocus:e.onFocus}))):o&&t?n.createElement(A,{dropDownButtonFocusId:t.dropDownButtonFocusId,enableMenuButtonIcon:t.enableMenuButtonIcon,menuButtonIcon:"ArrowUpload",menuButtonText:t.menuButtonText,menuItems:t.menuItems,isUploadButtonHighlighted:p,open:f,onOpenChange:m,onClick:d,onTriggerFocus:v,onMenuItemFocus:b,appearance:void 0,containerElement:y,menuButtonTooltip:t.menuButtonTooltip}):n.createElement(r.u,Object.assign({},w,{accessibilityLabel:l,accessibilityRole:"menuitem",automationLabel:"InlineSuggestionsBrowseThisComputer",icon:{type:"ArrowUpload",style:k},isSelectedByKeyboard:h,onClick:d,onFocus:v,style:C?{border:"none"}:S.style,theme:a,title:g||C?void 0:u,tooltip:g?u:void 0})))}));P.displayName="InlineSuggestionsUploadFile"},15897:(e,t,o)=>{"use strict";function i(e,t,o){var i;return(null!==(i=e.inlineSuggestions("combineSentences"))&&void 0!==i?i:"{0}. {1}").replace("{0}",t).replace("{1}",o)}o.d(t,{w:()=>i})},36382:(e,t,o)=>{"use strict";if(o.d(t,{$d:()=>p,Dj:()=>y,FP:()=>v,Fr:()=>w,JE:()=>l,T_:()=>b,Ui:()=>h,VD:()=>f,fj:()=>m,nk:()=>a,vA:()=>u,wK:()=>g,yi:()=>c,zN:()=>d}),3023==o.j)var i=o(44357);if(3023==o.j)var n=o(45306);if(3023==o.j)var r=o(62989);const s={background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},text:{resting:"#201F1E",disabled:"#707070"},altText:{resting:"#605E5C"},actionButtonForeground:{resting:"#0078D4",disabled:"#707070"},highlighting:"#F5F5F5",highlightingBorderColor:"#201f1e",shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},focusRing:"#323130",searchBox:{borderColor:{resting:"#D1D1D1",hover:"#D1D1D1"},borderBottomColor:"#464FEB",iconColor:"#424242"},tooltip:{directionHint:1},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},meetingBanner:{backgroundColor:"#FAF9F8",text:"#424242",iconPrimaryColor:"#616161",borderColor:"#d1d1d1"}},a=(e,t,o)=>{var i,a;return t?Object.assign(Object.assign({},(e=>({background:{resting:e?"var(--colorNeutralBackground3)":"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},altIcon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground2BrandHover)",disabled:"var(--colorNeutralForegroundDisabled)"},altText:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},highlighting:"var(--colorNeutralBackground1Hover)",highlightingBorderColor:"var(--colorStrokeFocus2)",focusRing:"var(--colorStrokeFocus2)",footerButtonBackground:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},noSuggestions:{descriptionTextColor:"var(--colorNeutralForeground2)",item:{background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--editorNoSuggestionsTextColorResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorNoSuggestionsTextColorHover, var(--editorNoSuggestionsTextColorResting, var(--colorNeutralForeground2BrandHover)))",disabled:"var(--colorNeutralForegroundDisabled)"},actionButtonForeground:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},highlighting:"var(--colorNeutralBackground1Hover)"}},actionButtonForeground:{resting:"var(--editorActionButtonForegroundResting)",hover:"var(--editorActionButtonForegroundHover)",pressed:"var(--editorActionButtonForegroundPressed)",disabled:"var(--editorActionButtonForegroundDisabled)"},shimmer:{shimmerColor:"var(--editorShimmerColor)",shimmerWaveColor:"var(--editorShimmerWaveColor)"},scroll:{thumbColor:"var(--editorScrollThumbColor)"},searchBox:{borderColor:{resting:"var(--editorSearchBoxBorderColorResting)",hover:"var(--editorSearchBoxBorderColorHover)"},borderBottomColor:"var(--editorSearchBoxBorderBottomColor)",iconColor:"var(--editorSearchBoxIconColor)"},tooltip:{directionHint:1},tag:{background:"var(--editorTagBackground)",textColor:"var(--editorTagTextColor)"},meetingBanner:{backgroundColor:"var(--editorMeetingBannerBackgroundColor)",text:"var(--editorMeetingBannerText)",iconPrimaryColor:"var(--editorMeetingBannerIconPrimaryColor)",borderColor:"var(--editorMeetingBannerBorderColor)"}}))(o)),{branding:e?null===(i=n.no[e])||void 0===i?void 0:i.v9:void 0}):Object.assign(Object.assign({},s),{branding:e?null===(a=n.no[e])||void 0===a?void 0:a.v8[r.SV.light]:void 0})};function l(e,t){const o=Object.assign({},e.background);let i;return t&&e.highlighting&&(o.resting=e.highlighting,i=e.highlightingBorderColor),{background:o,border:i,title:Object.assign({},e.text)}}function c(e,t,o){return e===i.E9?function(e,t){var o,i,n;const r=null===(o=null==e?void 0:e.noSuggestions)||void 0===o?void 0:o.item;if(r){const e=Object.assign(Object.assign({},r.background),{disabled:void 0}),o=Object.assign(Object.assign({},r.text),{focused:r.text.hover});return t&&r.highlighting&&(o.resting=null!==(i=o.focused)&&void 0!==i?i:o.resting,e.resting=r.highlighting),{background:e,title:o,focusRing:"transparent"}}const a=null!=e?e:s,l=Object.assign(Object.assign({},a.background),{disabled:void 0}),c=Object.assign(Object.assign({},a.actionButtonForeground),{focused:a.actionButtonForeground.hover});return t&&a.highlighting&&(c.resting=null!==(n=c.focused)&&void 0!==n?n:c.resting,l.resting=a.highlighting),{background:l,title:c,focusRing:"transparent"}}(t,o):u(null!=t?t:s,o)}function u(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0}),i=Object.assign({},e.text),n=e.altText?Object.assign({},e.altText):void 0;let r;return t&&(e.highlighting&&(o.resting=e.highlighting,r=e.highlightingBorderColor),i.hover&&(i.resting=i.hover),(null==n?void 0:n.hover)&&(n.resting=n.hover)),{background:o,title:i,subtitle:n,focusRing:"transparent",border:r,tooltip:e.tooltip,underline:e.headerUnderlineColor}}function d(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});let i;return t&&e.highlighting&&(o.resting=e.highlighting,i=e.highlightingBorderColor),{background:o,title:e.actionButtonForeground,subtitle:e.altText,focusRing:"transparent",border:i}}function h(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(o.resting=e.highlighting),{background:o,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent"}}function g(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(o.resting=e.highlighting),{background:o,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent",border:"1px solid #D1D1D1"}}function p(e,t){const o=Object.assign(Object.assign({},e.background),{disabled:void 0,hover:void 0});return t&&e.highlighting&&(o.resting=e.highlighting),{background:o,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent"}}function f(e){return{background:{resting:"transparent",hover:"transparent"},title:e.actionButtonForeground}}function m(e){var t;return{focusRing:null!==(t=e.focusRing)&&void 0!==t?t:"#323130"}}function v(e,t){var o,n,r,a;const l=null!==(o=s.text.disabled)&&void 0!==o?o:s.text.resting;return e.type===i.E9?null!==(r=null===(n=null==t?void 0:t.noSuggestions)||void 0===n?void 0:n.descriptionTextColor)&&void 0!==r?r:l:null!==(a=null==t?void 0:t.text.disabled)&&void 0!==a?a:l}function b(e){var t,o;return{overflowItem:{resting:e.background.resting,hover:null!==(t=e.background.hover)&&void 0!==t?t:"#F5F5F5",color:null===(o=e.fallbackIcon)||void 0===o?void 0:o.color}}}const y=e=>{var t,o;if(e)return Object.assign(Object.assign({},e),{background:null!==(t=e.footerButtonBackground)&&void 0!==t?t:e.background,header:"",subheader:"",dialogText:"",iconText:"",contextText:"",errorText:"",border:"",separator:"",focusRing:null!==(o=e.focusRing)&&void 0!==o?o:"",link:"",linkPressed:"",tag:void 0})},w=(e,t)=>{const o={backgroundColor:e.background.resting};return t&&(o.borderColor="#E1DFDD"),o}},45306:(e,t,o)=>{"use strict";if(o.d(t,{C_:()=>h,ET:()=>u,Eq:()=>f,_s:()=>p,m0:()=>c,m7:()=>g,no:()=>a,pd:()=>d,qv:()=>v,zB:()=>m}),3023==o.j)var i=o(86399);if(3023==o.j)var n=o(77776);if(3023==o.j)var r=o(51395);var s=o(62989);const a={[s.nH.Text]:{v8:{[s.SV.light]:{type:"Text",textColor:"#616161"},[s.SV.dark]:{type:"Text",textColor:"#616161"}},v9:{type:"Text",textColor:"var(--editorTextBrandingTextColor, var(--colorNeutralForeground2))"}},[s.nH.Icon]:{v8:{[s.SV.light]:{type:"Icon",iconColor:"#616161"},[s.SV.dark]:{type:"Icon",iconColor:"#616161"}},v9:{type:"Icon",iconColor:"var(--editorIconBrandingIconColor, var(--colorNeutralForeground2))"}},[s.nH.IconButton]:{v8:{[s.SV.light]:{type:"IconButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#616161",disabled:"#BDBDBD"},focusRing:"#323130"},[s.SV.dark]:{type:"IconButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1"},focusRing:"#323130"}},v9:{type:"IconButton",background:{resting:"var(--editorIconButtonBrandingBackgroundResting, var(--colorNeutralBackground1))",hover:"var(--editorIconButtonBrandingBackgroundHover, var(--colorNeutralBackground1Hover))",pressed:"var(--editorIconButtonBrandingBackgroundPressed, var(--colorNeutralBackground1Pressed))",disabled:"var(--editorIconButtonBrandingBackgroundDisabled, var(--colorNeutralBackgroundDisabled))"},icon:{resting:"var(--editorIconButtonBrandingIconResting, var(--colorNeutralForeground2))",disabled:"var(--editorIconButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},focusRing:"var(--editorIconButtonBrandingFocusRing, var(--colorStrokeFocus2))"}},[s.nH.IconAndTextButton]:{v8:{[s.SV.light]:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},[s.SV.dark]:{type:"IconAndTextButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#6794D7"},title:{resting:"#6794D7"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"}},v9:{type:"IconAndTextButton",background:{resting:"var(--editorIconAndTextButtonBrandingBackgroundResting, var(--colorNeutralBackground1))",hover:"var(--editorIconAndTextButtonBrandingBackgroundHover, var(--colorNeutralBackground1Hover))",pressed:"var(--editorIconAndTextButtonBrandingBackgroundPressed, var(--colorNeutralBackground1Pressed))",disabled:"var(--editorIconAndTextButtonBrandingBackgroundDisabled, var(--colorNeutralBackgroundDisabled))"},icon:{resting:"var(--editorIconAndTextButtonBrandingIconResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorIconAndTextButtonBrandingIconHover, var(--colorNeutralForeground2BrandHover))",disabled:"var(--editorIconAndTextButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},title:{resting:"var(--editorIconAndTextButtonBrandingIconResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorIconAndTextButtonBrandingIconHover, var(--colorNeutralForeground2BrandHover))",disabled:"var(--editorIconAndTextButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},focusRing:"var(--editorIconAndTextButtonBrandingFocusRing, var(--colorStrokeFocus2))"}}};function l(e,t){const o=Object.assign({},e);return t&&(null==o?void 0:o.hover)&&(o.resting=o.hover),o}const c=(e,t)=>{var o,i;if(void 0===e)return;e===s.nH.MonochromeIcon&&(e=s.nH.Icon);const n=a[e];if(void 0===n)return;const r=null!==(o=null==t?void 0:t.themeType)&&void 0!==o?o:s.SV.light;return(null==t?void 0:t.useFluentV9)?n.v9:null!==(i=n.v8[r])&&void 0!==i?i:n.v9};function u(e,t,o){const n="Text"===(null==e?void 0:e.type)?e:c(s.nH.Text,o);return{fontWeight:i.IT.SemiBold,fontSize:t.xsmall,cssColor:null==n?void 0:n.textColor}}function d(e,t,o){const r="Text"===(null==e?void 0:e.type)?e:c(s.nH.Text,o);return{fontWeight:i.IT.SemiBold,fontFamily:n.V,fontSize:t.small,cssColor:null==r?void 0:r.textColor,userSelectable:!1}}function h(e,t){return("Icon"===(null==e?void 0:e.type)?e:c(s.nH.Icon,t)).iconColor}function g(e,t,o){var i;const n="IconButton"===(null==e?void 0:e.type)?e:c(s.nH.IconButton,o),r=l(n.icon,t);return Object.assign(Object.assign({},n),{background:Object.assign(Object.assign({},n.background),{resting:t&&null!==(i=n.background.hover)&&void 0!==i?i:n.background.resting}),title:r,icon:r,border:t?n.focusRing:void 0})}function p(e,t,o){var i;const n="IconAndTextButton"===(null==e?void 0:e.type)?e:c(s.nH.IconAndTextButton,o);return Object.assign(Object.assign({},n),{background:Object.assign(Object.assign({},n.background),{resting:t&&null!==(i=n.background.hover)&&void 0!==i?i:n.background.resting}),title:l(n.title,t),icon:l(n.icon,t),border:t?n.focusRing:void 0})}function f(e){return{textAlign:r.R.Center,borderRadius:4,iconFontSize:e.xlarge,paddingHorizontal:7,paddingBottom:0,textHorizontalPadding:0,iconTextSpacing:3}}function m(e){return{fontWeight:i.IT.SemiBold,fontFamily:n.V,fontSize:e.small}}function v(e){return{textAlign:r.R.Center,borderRadius:4,iconFontSize:e.xsmall}}},6284:(e,t,o)=>{"use strict";function i(e,t){return t<0||e.length<=t?e:e.substring(0,t).concat("…")}function n(e){const t=(e=(e=e.replace(/https:\/\//i,"")).replace(/http:\/\//i,"")).indexOf("/");return t>0?e.substring(0,t):e}function r(e,...t){if(t&&Array.isArray(t))for(let o=0;o<t.length;o++)e=e.replace(`{${o}}`,t[o].toString());return e}o.d(t,{EE:()=>i,JT:()=>r,SE:()=>n})},54651:(e,t,o)=>{"use strict";o.d(t,{$d:()=>z,B1:()=>H,B7:()=>S,B8:()=>se,Bd:()=>J,D0:()=>U,Dd:()=>$,F6:()=>Z,GP:()=>B,HV:()=>ie,ID:()=>f,J2:()=>M,JP:()=>v,LO:()=>O,MW:()=>D,Oc:()=>_,Ot:()=>K,P4:()=>L,PN:()=>de,Ps:()=>oe,QL:()=>a,RU:()=>G,VP:()=>b,Vn:()=>C,W0:()=>pe,WC:()=>p,Wi:()=>l,Xp:()=>ne,YV:()=>T,Y_:()=>m,_e:()=>P,cK:()=>I,cq:()=>ue,d4:()=>h,dG:()=>le,dU:()=>F,db:()=>ge,eO:()=>X,ej:()=>ce,gc:()=>s,i6:()=>he,k:()=>E,ki:()=>ee,kw:()=>w,lI:()=>k,lT:()=>g,lb:()=>te,nV:()=>Y,ol:()=>d,qL:()=>A,qw:()=>re,tJ:()=>x,uI:()=>W,uY:()=>Q,vP:()=>y,vy:()=>u,yl:()=>R,ys:()=>ae});var i=o(86399),n=o(51395);if(3023==o.j)var r=o(77776);const s=3,a=16,l=3,c=8,u={background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#F3F2F1"},text:{resting:"#201F1E",disabled:"#A19F9D"},tooltip:{textColor:"#201F1E",backgroundColor:"#FFFFFF"},tag:{resting:"#201F1E"},altText:{resting:"#605E5C"},icon:{resting:"#757470",disabled:"#CCCCCC"},altIcon:{resting:"#616161",hover:"#185ABD",disabled:"#CCCCCC"},grammarText:{resting:"#3355FF"},refinementText:{resting:"#5A45B6"},rewriteText:{resting:"#5A45B6"},suggestionMenuHoverBackground:"#E1DFDD",primaryButtonBackground:{resting:"#2E6AC5",hover:"#1651AA",pressed:"#0E336A",disabled:"#F3F2F1"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},header:"#3B3A39",subheader:"#605E5C",dialogText:"#323130",iconText:"#201F1E",contextText:"#201F1E",errorText:"red",border:"#201F1E",separator:"#E6E6E6",focusRing:"#969696",link:"#1651AA",linkPressed:"#002050",addOnFooterBackground:"#F2F6FD",addOnFooterMessage:"#11100F",addOnHeaderBackground:"#ebf3fc",premiumEmphasis:"#2E6AC5",addOnAction:"#2E6AC5",editorIcon:"#185ABD",accessibilityIcon:"#185ABD",correctionHighlight:"#D4EDD4",helpLink:{text:{resting:"#1651AA",hover:"#13458F",focused:"#1651AA",pressed:"#0E336A"},focusRing:"#323130"},badgeBackground:"#185ABD",badgeText:"#FFFFFF"},d={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},icon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},altIcon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground2BrandHover)",disabled:"var(--colorNeutralForegroundDisabled)"},suggestionMenuHoverForeground:"var(--colorNeutralForeground1Hover)",suggestionMenuHoverBackground:"var(--colorNeutralBackground1Hover)",tag:{resting:"var(--editorTagResting)",disabled:"var(--colorNeutralForegroundDisabled)"},altText:{resting:"var(--editorAltTextResting)",disabled:"var(--colorNeutralForegroundDisabled)"},grammarText:{resting:"var(--editorGrammarTextResting)",hover:"var(--editorGrammarTextHover)",disabled:"var(--colorNeutralForegroundDisabled)"},refinementText:{resting:"var(--editorRefinementTextResting)",hover:"var(--editorRefinementTextHover)",disabled:"var(--colorNeutralForegroundDisabled)"},rewriteText:{resting:"var(--editorRewriteTextResting)",hover:"var(--editorRewriteTextHover)"},primaryButtonBackground:{resting:"var(--editorPrimaryButtonBackgroundResting)",hover:"var(--editorPrimaryButtonBackgroundHover)",pressed:"var(--editorPrimaryButtonBackgroundPressed)",disabled:"var(--editorPrimaryButtonBackgroundDisabled)"},primaryButtonText:{resting:"var(--editorPrimaryButtonTextResting)",disabled:"var(--editorPrimaryButtonTextDisabled)"},header:"var(--editorHeader)",subheader:"var(--editorSubheader)",dialogText:"var(--editorDialogText)",iconText:"var(--editorIconText)",contextText:"var(--editorContextText)",errorText:"var(--editorErrorText)",border:"var(--editorBorder)",separator:"var(--editorSeparator)",focusRing:"var(--editorFocusRing)",addOnFooterBackground:"var(--editorAddOnFooterBackground)",addOnFooterMessage:"var(--editorAddOnFooterMessage)",addOnHeaderBackground:"var(--editorAddOnHeaderBackground)",premiumEmphasis:"var(--editorPremiumEmphasis)",addOnAction:"var(--editorAddOnAction)",editorIcon:"var(--editorEditorIcon)",accessibilityIcon:"var(--editorAccessibilityIcon)",correctionHighlight:"var(--editorCorrectionHighlight)",helpLink:{text:{resting:"var(--editorHelpLinkTextResting)",hover:"var(--editorHelpLinkTextHover)",focused:"var(--editorHelpLinkTextFocused)",pressed:"var(--editorHelpLinkTextPressed)"},focusRing:"var(--editorHelpLinkFocusRing)"},badgeBackground:"var(--editorBadgeBackground)",badgeText:"var(--editorBadgeText)"},h=(i.RV.Single,n.R.Center,{x4small:7,x3small:8,xxsmall:10,xsmall:12,small:14,medium:16,large:18,xlarge:20,xxlarge:22}),g={xsmall:8,small:12,medium:16},p={paddingHorizontal:a,paddingTop:10,paddingBottom:8},f={paddingHorizontal:a,paddingBottom:8},m={paddingHorizontal:c,paddingVertical:4,gap:4},v={paddingHorizontal:12,paddingVertical:8,backgroundColor:"#EBF3FC",marginTop:4,marginBottom:-8},b={width:32,height:32},y={paddingHorizontal:8,fontSize:12},w={paddingHorizontal:a,flexibleSize:!0,borderRadius:4};function C(e){var t,o;return Object.assign(Object.assign({},e),{paddingHorizontal:null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:a-c,borderRadius:null!==(o=null==e?void 0:e.borderRadius)&&void 0!==o?o:4})}function S(e){var t;return Object.assign(Object.assign({},e),{tooltipProps:null==e?void 0:e.tooltipButtonStyles,borderRadius:null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:4})}function k(e){var t;return Object.assign(Object.assign({},e),{borderRadius:null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:4})}n.R.Center;const T={marginTop:14};function x(e,t){return{backgroundColor:null==t?void 0:t.background.resting,minWidth:e?e.minWidth:void 0,maxWidth:e?e.maxWidth:void 0,paddingHorizontal:16,paddingTop:6,paddingBottom:22}}const _={paddingHorizontal:0,paddingVertical:0,borderThickness:0},I={marginHorizontal:a};function E(e,t,o){return{fontWeight:i.IT.SemiBold,fontFamily:r.V,fontSize:t.xsmall,cssColor:(null==o?void 0:o.useFluentV9)?"var(--colorNeutralForeground1)":e.header}}function B(e,t,o){let n=t.xsmall;((null==o?void 0:o.isLargeHeader)||(null==o?void 0:o.isIconHeader))&&(n=(null==o?void 0:o.isLargeHeader)?t.xxlarge:t.xxsmall);const s=(null==o?void 0:o.isIconHeader)?e.iconText:(null==o?void 0:o.useFluentV9)?"var(--colorNeutralForeground2)":e.subheader;return{fontWeight:(null==o?void 0:o.isIconHeader)?i.IT.SemiBold:i.IT.Normal,fontFamily:r.V,fontSize:n,cssColor:s}}function A(e,t){return{fontWeight:i.IT.SemiBold,fontFamily:r.V,fontSize:t.xsmall,cssColor:e.subheader}}function R(e,t){return{cssColor:e.contextText,fontSize:t.small}}function M(e,t){return{cssColor:e.addOnAction,fontSize:t.xlarge,fontWeight:i.IT.SemiBold,marginVertical:6}}function D(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,marginVertical:6,lineHeight:16}}function P(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,lineHeight:16}}function F(e,t){return{cssColor:e.text.resting,fontSize:t.xsmall,fontWeight:i.IT.SemiBold,lineHeight:16}}function O(e,t){return{cssColor:e.text.resting,fontSize:t.xsmall,lineHeight:16,fontWeight:i.IT.SemiBold,italic:!0}}function N(e,t,o){var i;return"primary"===t&&e.primaryButtonBackground?Object.assign(Object.assign({},e.primaryButtonBackground),{focused:e.primaryButtonBackground.hover}):"dialog"===t?Object.assign(Object.assign({},e.background),{focused:e.background.hover}):o?{resting:null!==(i=e.background.hover)&&void 0!==i?i:"",disabled:void 0}:Object.assign(Object.assign({},e.background),{disabled:void 0})}function q(e,t){return"primary"===t&&e.primaryButtonText?e.primaryButtonText:"grammar"===t&&e.grammarText?e.grammarText:"refinement"===t&&e.refinementText?e.refinementText:e.text}function j(e,t,o){var i;let n=t&&null!==(i=e.altIcon)&&void 0!==i?i:e.icon;return n=n&&Object.assign({},n),o&&(null==n?void 0:n.hover)&&(n.resting=n.hover),n}function L(e,t,o,i){return{background:N(e,t,i),title:q(e,t),tooltip:e.tooltip,tag:e.tag,subtitle:e.altText,icon:j(e,o,i),border:"dialog"===t||"primary"===t?e.border:i?e.focusRing:void 0,focusRing:e.focusRing}}function z(e,t){var o;let i=null!==(o=e.altIcon)&&void 0!==o?o:e.icon;return i=Object.assign(Object.assign({},i),{resting:i.hover}),{background:N(e,void 0,t),title:i,tooltip:e.tooltip,tag:e.tag,subtitle:e.altText,icon:i,border:t?e.focusRing:void 0,focusRing:e.focusRing}}function H(e,t){return Object.assign(Object.assign({},L(e,void 0,!0,t)),{separator:e.separator})}function W(e,t,o){return{minWidth:t?t.minWidth:void 0,maxWidth:t?t.maxWidth:void 0,minHeight:t?t.minHeight:void 0,maxHeight:t?t.maxHeight:void 0,backgroundColor:(null==o?void 0:o.useFluentV9)?"var(--colorNeutralBackground1)":e.background.resting,borderRadius:(null==t?void 0:t.hasBottomAttachment)?{topStart:8,topEnd:8}:8}}function U(e,t,o,n){return[{start:0,length:t,fontWeight:o?i.IT.Normal:i.IT.SemiBold,fontFamily:r.V,fontSize:n||e.small}]}function G(e){return{fontFamily:r.V,fontWeight:i.IT.Normal,fontSize:e.xsmall}}function V(e,t){return[{start:0,length:t,fontWeight:i.IT.Normal,fontFamily:r.V,fontSize:e.small}]}const $=3023==o.j?V:null,K=3023==o.j?V:null;function J(e){return{paddingHorizontal:8,borderRadius:2,iconFontSize:e.medium}}function Y(e){return{paddingHorizontal:8,borderRadius:4,iconFontSize:e.xlarge}}function Q(e,t){var o;return{paddingHorizontal:8,borderRadius:null!==(o=null==t?void 0:t.borderRadius)&&void 0!==o?o:4,iconFontSize:e.xlarge}}function Z(e,t){return{fontWeight:i.IT.Normal,fontSize:e.xsmall,cssColor:t.subheader}}function X(e){return{fontSize:e.xsmall,fontWeight:i.IT.SemiBold}}function ee(e){return{color:e.subheader,hoverColor:e.link,pressedColor:e.linkPressed,focusRing:e.focusRing}}function te(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,fontWeight:i.IT.SemiBold}}function oe(e){return{fontWeight:i.IT.Normal,fontSize:e.xxsmall}}function ie(e,t){return{fontWeight:i.IT.SemiBold,fontSize:t.xxsmall,cssColor:e.text.resting}}function ne(){return{lineHeight:20,truncate:!0}}function re(e,t,o,n){return{fontWeight:i.IT.Normal,fontFamily:r.V,fontSize:n||(t?e.xxsmall:e.xsmall),width:"100%",truncate:!!o,height:14}}function se(e){return{paddingTop:e.small,paddingBottom:3*e.small,paddingHorizontal:e.medium,widths:["91%","96%","71%"]}}function ae(e){return{paddingHorizontal:e.xsmall,widths:[5*e.medium]}}function le(e){var t,o,i,n,r;return{color:null===(t=e.helpLink)||void 0===t?void 0:t.text.resting,hoverColor:null===(o=e.helpLink)||void 0===o?void 0:o.text.hover,focusColor:null===(i=e.helpLink)||void 0===i?void 0:i.text.focused,pressedColor:null===(n=e.helpLink)||void 0===n?void 0:n.text.pressed,focusRing:e.helpLink?null===(r=e.helpLink)||void 0===r?void 0:r.focusRing:e.focusRing}}function ce(e){return{fontSize:e.xxsmall}}const ue={marginHorizontal:16,marginVertical:10};function de(){return{marginVertical:6}}function he(){return{paddingStart:0,paddingEnd:10,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}}function ge(){return{paddingStart:10,paddingEnd:0,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}}i.IT.SemiBold,n.R.Center;const pe=(e,t)=>{var o;return null!==(o=e.theme)&&void 0!==o?o:t?d:u}},98848:(e,t,o)=>{"use strict";if(o.d(t,{y:()=>r}),3023==o.j)var i=o(62989);if(3023==o.j)var n=o(40732);function r(e,t,o,r){if(o&&r)for(const s of r)switch(s.decorationType){case n.v.Spelling:{const n=o.substr(s.start,s.length);return t===i.L9.RepeatedWord?e("contextAccessibilityLabelForRepeatedWord").replace("{0}",n).replace("{1}",o):e("contextAccessibilityLabelForSpelling").replace("{0}",n).replace("{1}",o)}case n.v.Grammar:{const t=o.substr(s.start,s.length);return e("contextAccessibilityLabelForGrammar").replace("{0}",t).replace("{1}",o)}case n.v.Refinement:{const t=o.substr(s.start,s.length);return e("contextAccessibilityLabelForRefinement").replace("{0}",t).replace("{1}",o)}case n.v.Modification:{const t=o.substr(s.start,s.length);return e("contextAccessibilityLabelForCorrection").replace("{0}",t).replace("{1}",o)}}}},71418:(e,t,o)=>{"use strict";var i;o.d(t,{h:()=>i}),function(e){e[e.Accept=0]="Accept",e[e.Ignore=1]="Ignore",e[e.Reject=2]="Reject",e[e.OpenEditorSettings=3]="OpenEditorSettings",e[e.DismissRejectMessage=4]="DismissRejectMessage"}(i||(i={}))},68008:e=>{var t=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},o=-1;t.Diff=function(e,t){return[e,t]},t.prototype.diff_main=function(e,o,i,n){void 0===n&&(n=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var r=n;if(null==e||null==o)throw new Error("Null input. (diff_main)");if(e==o)return e?[new t.Diff(0,e)]:[];void 0===i&&(i=!0);var s=i,a=this.diff_commonPrefix(e,o),l=e.substring(0,a);e=e.substring(a),o=o.substring(a),a=this.diff_commonSuffix(e,o);var c=e.substring(e.length-a);e=e.substring(0,e.length-a),o=o.substring(0,o.length-a);var u=this.diff_compute_(e,o,s,r);return l&&u.unshift(new t.Diff(0,l)),c&&u.push(new t.Diff(0,c)),this.diff_cleanupMerge(u),u},t.prototype.diff_compute_=function(e,i,n,r){var s;if(!e)return[new t.Diff(1,i)];if(!i)return[new t.Diff(o,e)];var a=e.length>i.length?e:i,l=e.length>i.length?i:e,c=a.indexOf(l);if(-1!=c)return s=[new t.Diff(1,a.substring(0,c)),new t.Diff(0,l),new t.Diff(1,a.substring(c+l.length))],e.length>i.length&&(s[0][0]=s[2][0]=o),s;if(1==l.length)return[new t.Diff(o,e),new t.Diff(1,i)];var u=this.diff_halfMatch_(e,i);if(u){var d=u[0],h=u[1],g=u[2],p=u[3],f=u[4],m=this.diff_main(d,g,n,r),v=this.diff_main(h,p,n,r);return m.concat([new t.Diff(0,f)],v)}return n&&e.length>100&&i.length>100?this.diff_lineMode_(e,i,r):this.diff_bisect_(e,i,r)},t.prototype.diff_lineMode_=function(e,i,n){var r=this.diff_linesToChars_(e,i);e=r.chars1,i=r.chars2;var s=r.lineArray,a=this.diff_main(e,i,!1,n);this.diff_charsToLines_(a,s),this.diff_cleanupSemantic(a),a.push(new t.Diff(0,""));for(var l=0,c=0,u=0,d="",h="";l<a.length;){switch(a[l][0]){case 1:u++,h+=a[l][1];break;case o:c++,d+=a[l][1];break;case 0:if(c>=1&&u>=1){a.splice(l-c-u,c+u),l=l-c-u;for(var g=this.diff_main(d,h,!1,n),p=g.length-1;p>=0;p--)a.splice(l,0,g[p]);l+=g.length}u=0,c=0,d="",h=""}l++}return a.pop(),a},t.prototype.diff_bisect_=function(e,i,n){for(var r=e.length,s=i.length,a=Math.ceil((r+s)/2),l=a,c=2*a,u=new Array(c),d=new Array(c),h=0;h<c;h++)u[h]=-1,d[h]=-1;u[l+1]=0,d[l+1]=0;for(var g=r-s,p=g%2!=0,f=0,m=0,v=0,b=0,y=0;y<a&&!((new Date).getTime()>n);y++){for(var w=-y+f;w<=y-m;w+=2){for(var C=l+w,S=(I=w==-y||w!=y&&u[C-1]<u[C+1]?u[C+1]:u[C-1]+1)-w;I<r&&S<s&&e.charAt(I)==i.charAt(S);)I++,S++;if(u[C]=I,I>r)m+=2;else if(S>s)f+=2;else if(p&&(x=l+g-w)>=0&&x<c&&-1!=d[x]&&I>=(T=r-d[x]))return this.diff_bisectSplit_(e,i,I,S,n)}for(var k=-y+v;k<=y-b;k+=2){for(var T,x=l+k,_=(T=k==-y||k!=y&&d[x-1]<d[x+1]?d[x+1]:d[x-1]+1)-k;T<r&&_<s&&e.charAt(r-T-1)==i.charAt(s-_-1);)T++,_++;if(d[x]=T,T>r)b+=2;else if(_>s)v+=2;else if(!p){var I;if((C=l+g-k)>=0&&C<c&&-1!=u[C])if(S=l+(I=u[C])-C,I>=(T=r-T))return this.diff_bisectSplit_(e,i,I,S,n)}}}return[new t.Diff(o,e),new t.Diff(1,i)]},t.prototype.diff_bisectSplit_=function(e,t,o,i,n){var r=e.substring(0,o),s=t.substring(0,i),a=e.substring(o),l=t.substring(i),c=this.diff_main(r,s,!1,n),u=this.diff_main(a,l,!1,n);return c.concat(u)},t.prototype.diff_linesToChars_=function(e,t){var o=[],i={};function n(e){for(var t="",n=0,s=-1,a=o.length;s<e.length-1;){-1==(s=e.indexOf("\n",n))&&(s=e.length-1);var l=e.substring(n,s+1);(i.hasOwnProperty?i.hasOwnProperty(l):void 0!==i[l])?t+=String.fromCharCode(i[l]):(a==r&&(l=e.substring(n),s=e.length),t+=String.fromCharCode(a),i[l]=a,o[a++]=l),n=s+1}return t}o[0]="";var r=4e4,s=n(e);return r=65535,{chars1:s,chars2:n(t),lineArray:o}},t.prototype.diff_charsToLines_=function(e,t){for(var o=0;o<e.length;o++){for(var i=e[o][1],n=[],r=0;r<i.length;r++)n[r]=t[i.charCodeAt(r)];e[o][1]=n.join("")}},t.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var o=0,i=Math.min(e.length,t.length),n=i,r=0;o<n;)e.substring(r,n)==t.substring(r,n)?r=o=n:i=n,n=Math.floor((i-o)/2+o);return n},t.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var o=0,i=Math.min(e.length,t.length),n=i,r=0;o<n;)e.substring(e.length-n,e.length-r)==t.substring(t.length-n,t.length-r)?r=o=n:i=n,n=Math.floor((i-o)/2+o);return n},t.prototype.diff_commonOverlap_=function(e,t){var o=e.length,i=t.length;if(0==o||0==i)return 0;o>i?e=e.substring(o-i):o<i&&(t=t.substring(0,o));var n=Math.min(o,i);if(e==t)return n;for(var r=0,s=1;;){var a=e.substring(n-s),l=t.indexOf(a);if(-1==l)return r;s+=l,0!=l&&e.substring(n-s)!=t.substring(0,s)||(r=s,s++)}},t.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var o=e.length>t.length?e:t,i=e.length>t.length?t:e;if(o.length<4||2*i.length<o.length)return null;var n=this;function r(e,t,o){for(var i,r,s,a,l=e.substring(o,o+Math.floor(e.length/4)),c=-1,u="";-1!=(c=t.indexOf(l,c+1));){var d=n.diff_commonPrefix(e.substring(o),t.substring(c)),h=n.diff_commonSuffix(e.substring(0,o),t.substring(0,c));u.length<h+d&&(u=t.substring(c-h,c)+t.substring(c,c+d),i=e.substring(0,o-h),r=e.substring(o+d),s=t.substring(0,c-h),a=t.substring(c+d))}return 2*u.length>=e.length?[i,r,s,a,u]:null}var s,a,l,c,u,d=r(o,i,Math.ceil(o.length/4)),h=r(o,i,Math.ceil(o.length/2));return d||h?(s=h?d&&d[4].length>h[4].length?d:h:d,e.length>t.length?(a=s[0],l=s[1],c=s[2],u=s[3]):(c=s[0],u=s[1],a=s[2],l=s[3]),[a,l,c,u,s[4]]):null},t.prototype.diff_cleanupSemantic=function(e){for(var i=!1,n=[],r=0,s=null,a=0,l=0,c=0,u=0,d=0;a<e.length;)0==e[a][0]?(n[r++]=a,l=u,c=d,u=0,d=0,s=e[a][1]):(1==e[a][0]?u+=e[a][1].length:d+=e[a][1].length,s&&s.length<=Math.max(l,c)&&s.length<=Math.max(u,d)&&(e.splice(n[r-1],0,new t.Diff(o,s)),e[n[r-1]+1][0]=1,r--,a=--r>0?n[r-1]:-1,l=0,c=0,u=0,d=0,s=null,i=!0)),a++;for(i&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]==o&&1==e[a][0]){var h=e[a-1][1],g=e[a][1],p=this.diff_commonOverlap_(h,g),f=this.diff_commonOverlap_(g,h);p>=f?(p>=h.length/2||p>=g.length/2)&&(e.splice(a,0,new t.Diff(0,g.substring(0,p))),e[a-1][1]=h.substring(0,h.length-p),e[a+1][1]=g.substring(p),a++):(f>=h.length/2||f>=g.length/2)&&(e.splice(a,0,new t.Diff(0,h.substring(0,f))),e[a-1][0]=1,e[a-1][1]=g.substring(0,g.length-f),e[a+1][0]=o,e[a+1][1]=h.substring(f),a++),a++}a++}},t.prototype.diff_cleanupSemanticLossless=function(e){function o(e,o){if(!e||!o)return 6;var i=e.charAt(e.length-1),n=o.charAt(0),r=i.match(t.nonAlphaNumericRegex_),s=n.match(t.nonAlphaNumericRegex_),a=r&&i.match(t.whitespaceRegex_),l=s&&n.match(t.whitespaceRegex_),c=a&&i.match(t.linebreakRegex_),u=l&&n.match(t.linebreakRegex_),d=c&&e.match(t.blanklineEndRegex_),h=u&&o.match(t.blanklineStartRegex_);return d||h?5:c||u?4:r&&!a&&l?3:a||l?2:r||s?1:0}for(var i=1;i<e.length-1;){if(0==e[i-1][0]&&0==e[i+1][0]){var n=e[i-1][1],r=e[i][1],s=e[i+1][1],a=this.diff_commonSuffix(n,r);if(a){var l=r.substring(r.length-a);n=n.substring(0,n.length-a),r=l+r.substring(0,r.length-a),s=l+s}for(var c=n,u=r,d=s,h=o(n,r)+o(r,s);r.charAt(0)===s.charAt(0);){n+=r.charAt(0),r=r.substring(1)+s.charAt(0),s=s.substring(1);var g=o(n,r)+o(r,s);g>=h&&(h=g,c=n,u=r,d=s)}e[i-1][1]!=c&&(c?e[i-1][1]=c:(e.splice(i-1,1),i--),e[i][1]=u,d?e[i+1][1]=d:(e.splice(i+1,1),i--))}i++}},t.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,t.whitespaceRegex_=/\s/,t.linebreakRegex_=/[\r\n]/,t.blanklineEndRegex_=/\n\r?\n$/,t.blanklineStartRegex_=/^\r?\n\r?\n/,t.prototype.diff_cleanupEfficiency=function(e){for(var i=!1,n=[],r=0,s=null,a=0,l=!1,c=!1,u=!1,d=!1;a<e.length;)0==e[a][0]?(e[a][1].length<this.Diff_EditCost&&(u||d)?(n[r++]=a,l=u,c=d,s=e[a][1]):(r=0,s=null),u=d=!1):(e[a][0]==o?d=!0:u=!0,s&&(l&&c&&u&&d||s.length<this.Diff_EditCost/2&&l+c+u+d==3)&&(e.splice(n[r-1],0,new t.Diff(o,s)),e[n[r-1]+1][0]=1,r--,s=null,l&&c?(u=d=!0,r=0):(a=--r>0?n[r-1]:-1,u=d=!1),i=!0)),a++;i&&this.diff_cleanupMerge(e)},t.prototype.diff_cleanupMerge=function(e){e.push(new t.Diff(0,""));for(var i,n=0,r=0,s=0,a="",l="";n<e.length;)switch(e[n][0]){case 1:s++,l+=e[n][1],n++;break;case o:r++,a+=e[n][1],n++;break;case 0:r+s>1?(0!==r&&0!==s&&(0!==(i=this.diff_commonPrefix(l,a))&&(n-r-s>0&&0==e[n-r-s-1][0]?e[n-r-s-1][1]+=l.substring(0,i):(e.splice(0,0,new t.Diff(0,l.substring(0,i))),n++),l=l.substring(i),a=a.substring(i)),0!==(i=this.diff_commonSuffix(l,a))&&(e[n][1]=l.substring(l.length-i)+e[n][1],l=l.substring(0,l.length-i),a=a.substring(0,a.length-i))),n-=r+s,e.splice(n,r+s),a.length&&(e.splice(n,0,new t.Diff(o,a)),n++),l.length&&(e.splice(n,0,new t.Diff(1,l)),n++),n++):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,s=0,r=0,a="",l=""}""===e[e.length-1][1]&&e.pop();var c=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),c=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),c=!0)),n++;c&&this.diff_cleanupMerge(e)},t.prototype.diff_xIndex=function(e,t){var i,n=0,r=0,s=0,a=0;for(i=0;i<e.length&&(1!==e[i][0]&&(n+=e[i][1].length),e[i][0]!==o&&(r+=e[i][1].length),!(n>t));i++)s=n,a=r;return e.length!=i&&e[i][0]===o?a:a+(t-s)},t.prototype.diff_prettyHtml=function(e){for(var t=[],i=/&/g,n=/</g,r=/>/g,s=/\n/g,a=0;a<e.length;a++){var l=e[a][0],c=e[a][1].replace(i,"&amp;").replace(n,"&lt;").replace(r,"&gt;").replace(s,"&para;<br>");switch(l){case 1:t[a]='<ins style="background:#e6ffe6;">'+c+"</ins>";break;case o:t[a]='<del style="background:#ffe6e6;">'+c+"</del>";break;case 0:t[a]="<span>"+c+"</span>"}}return t.join("")},t.prototype.diff_text1=function(e){for(var t=[],o=0;o<e.length;o++)1!==e[o][0]&&(t[o]=e[o][1]);return t.join("")},t.prototype.diff_text2=function(e){for(var t=[],i=0;i<e.length;i++)e[i][0]!==o&&(t[i]=e[i][1]);return t.join("")},t.prototype.diff_levenshtein=function(e){for(var t=0,i=0,n=0,r=0;r<e.length;r++){var s=e[r][0],a=e[r][1];switch(s){case 1:i+=a.length;break;case o:n+=a.length;break;case 0:t+=Math.max(i,n),i=0,n=0}}return t+Math.max(i,n)},t.prototype.diff_toDelta=function(e){for(var t=[],i=0;i<e.length;i++)switch(e[i][0]){case 1:t[i]="+"+encodeURI(e[i][1]);break;case o:t[i]="-"+e[i][1].length;break;case 0:t[i]="="+e[i][1].length}return t.join("\t").replace(/%20/g," ")},t.prototype.diff_fromDelta=function(e,i){for(var n=[],r=0,s=0,a=i.split(/\t/g),l=0;l<a.length;l++){var c=a[l].substring(1);switch(a[l].charAt(0)){case"+":try{n[r++]=new t.Diff(1,decodeURI(c))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var u=parseInt(c,10);if(isNaN(u)||u<0)throw new Error("Invalid number in diff_fromDelta: "+c);var d=e.substring(s,s+=u);"="==a[l].charAt(0)?n[r++]=new t.Diff(0,d):n[r++]=new t.Diff(o,d);break;default:if(a[l])throw new Error("Invalid diff operation in diff_fromDelta: "+a[l])}}if(s!=e.length)throw new Error("Delta length ("+s+") does not equal source text length ("+e.length+").");return n},t.prototype.match_main=function(e,t,o){if(null==e||null==t||null==o)throw new Error("Null input. (match_main)");return o=Math.max(0,Math.min(o,e.length)),e==t?0:e.length?e.substring(o,o+t.length)==t?o:this.match_bitap_(e,t,o):-1},t.prototype.match_bitap_=function(e,t,o){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(t),n=this;function r(e,i){var r=e/t.length,s=Math.abs(o-i);return n.Match_Distance?r+s/n.Match_Distance:s?1:r}var s=this.Match_Threshold,a=e.indexOf(t,o);-1!=a&&(s=Math.min(r(0,a),s),-1!=(a=e.lastIndexOf(t,o+t.length))&&(s=Math.min(r(0,a),s)));var l,c,u=1<<t.length-1;a=-1;for(var d,h=t.length+e.length,g=0;g<t.length;g++){for(l=0,c=h;l<c;)r(g,o+c)<=s?l=c:h=c,c=Math.floor((h-l)/2+l);h=c;var p=Math.max(1,o-c+1),f=Math.min(o+c,e.length)+t.length,m=Array(f+2);m[f+1]=(1<<g)-1;for(var v=f;v>=p;v--){var b=i[e.charAt(v-1)];if(m[v]=0===g?(m[v+1]<<1|1)&b:(m[v+1]<<1|1)&b|(d[v+1]|d[v])<<1|1|d[v+1],m[v]&u){var y=r(g,v-1);if(y<=s){if(s=y,!((a=v-1)>o))break;p=Math.max(1,2*o-a)}}}if(r(g+1,o)>s)break;d=m}return a},t.prototype.match_alphabet_=function(e){for(var t={},o=0;o<e.length;o++)t[e.charAt(o)]=0;for(o=0;o<e.length;o++)t[e.charAt(o)]|=1<<e.length-o-1;return t},t.prototype.patch_addContext_=function(e,o){if(0!=o.length){if(null===e.start2)throw Error("patch not initialized");for(var i=o.substring(e.start2,e.start2+e.length1),n=0;o.indexOf(i)!=o.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)n+=this.Patch_Margin,i=o.substring(e.start2-n,e.start2+e.length1+n);n+=this.Patch_Margin;var r=o.substring(e.start2-n,e.start2);r&&e.diffs.unshift(new t.Diff(0,r));var s=o.substring(e.start2+e.length1,e.start2+e.length1+n);s&&e.diffs.push(new t.Diff(0,s)),e.start1-=r.length,e.start2-=r.length,e.length1+=r.length+s.length,e.length2+=r.length+s.length}},t.prototype.patch_make=function(e,i,n){var r,s;if("string"==typeof e&&"string"==typeof i&&void 0===n)r=e,(s=this.diff_main(r,i,!0)).length>2&&(this.diff_cleanupSemantic(s),this.diff_cleanupEfficiency(s));else if(e&&"object"==typeof e&&void 0===i&&void 0===n)s=e,r=this.diff_text1(s);else if("string"==typeof e&&i&&"object"==typeof i&&void 0===n)r=e,s=i;else{if("string"!=typeof e||"string"!=typeof i||!n||"object"!=typeof n)throw new Error("Unknown call format to patch_make.");r=e,s=n}if(0===s.length)return[];for(var a=[],l=new t.patch_obj,c=0,u=0,d=0,h=r,g=r,p=0;p<s.length;p++){var f=s[p][0],m=s[p][1];switch(c||0===f||(l.start1=u,l.start2=d),f){case 1:l.diffs[c++]=s[p],l.length2+=m.length,g=g.substring(0,d)+m+g.substring(d);break;case o:l.length1+=m.length,l.diffs[c++]=s[p],g=g.substring(0,d)+g.substring(d+m.length);break;case 0:m.length<=2*this.Patch_Margin&&c&&s.length!=p+1?(l.diffs[c++]=s[p],l.length1+=m.length,l.length2+=m.length):m.length>=2*this.Patch_Margin&&c&&(this.patch_addContext_(l,h),a.push(l),l=new t.patch_obj,c=0,h=g,u=d)}1!==f&&(u+=m.length),f!==o&&(d+=m.length)}return c&&(this.patch_addContext_(l,h),a.push(l)),a},t.prototype.patch_deepCopy=function(e){for(var o=[],i=0;i<e.length;i++){var n=e[i],r=new t.patch_obj;r.diffs=[];for(var s=0;s<n.diffs.length;s++)r.diffs[s]=new t.Diff(n.diffs[s][0],n.diffs[s][1]);r.start1=n.start1,r.start2=n.start2,r.length1=n.length1,r.length2=n.length2,o[i]=r}return o},t.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var i=this.patch_addPadding(e);t=i+t+i,this.patch_splitMax(e);for(var n=0,r=[],s=0;s<e.length;s++){var a,l,c=e[s].start2+n,u=this.diff_text1(e[s].diffs),d=-1;if(u.length>this.Match_MaxBits?-1!=(a=this.match_main(t,u.substring(0,this.Match_MaxBits),c))&&(-1==(d=this.match_main(t,u.substring(u.length-this.Match_MaxBits),c+u.length-this.Match_MaxBits))||a>=d)&&(a=-1):a=this.match_main(t,u,c),-1==a)r[s]=!1,n-=e[s].length2-e[s].length1;else if(r[s]=!0,n=a-c,u==(l=-1==d?t.substring(a,a+u.length):t.substring(a,d+this.Match_MaxBits)))t=t.substring(0,a)+this.diff_text2(e[s].diffs)+t.substring(a+u.length);else{var h=this.diff_main(u,l,!1);if(u.length>this.Match_MaxBits&&this.diff_levenshtein(h)/u.length>this.Patch_DeleteThreshold)r[s]=!1;else{this.diff_cleanupSemanticLossless(h);for(var g,p=0,f=0;f<e[s].diffs.length;f++){var m=e[s].diffs[f];0!==m[0]&&(g=this.diff_xIndex(h,p)),1===m[0]?t=t.substring(0,a+g)+m[1]+t.substring(a+g):m[0]===o&&(t=t.substring(0,a+g)+t.substring(a+this.diff_xIndex(h,p+m[1].length))),m[0]!==o&&(p+=m[1].length)}}}}return[t=t.substring(i.length,t.length-i.length),r]},t.prototype.patch_addPadding=function(e){for(var o=this.Patch_Margin,i="",n=1;n<=o;n++)i+=String.fromCharCode(n);for(n=0;n<e.length;n++)e[n].start1+=o,e[n].start2+=o;var r=e[0],s=r.diffs;if(0==s.length||0!=s[0][0])s.unshift(new t.Diff(0,i)),r.start1-=o,r.start2-=o,r.length1+=o,r.length2+=o;else if(o>s[0][1].length){var a=o-s[0][1].length;s[0][1]=i.substring(s[0][1].length)+s[0][1],r.start1-=a,r.start2-=a,r.length1+=a,r.length2+=a}return 0==(s=(r=e[e.length-1]).diffs).length||0!=s[s.length-1][0]?(s.push(new t.Diff(0,i)),r.length1+=o,r.length2+=o):o>s[s.length-1][1].length&&(a=o-s[s.length-1][1].length,s[s.length-1][1]+=i.substring(0,a),r.length1+=a,r.length2+=a),i},t.prototype.patch_splitMax=function(e){for(var i=this.Match_MaxBits,n=0;n<e.length;n++)if(!(e[n].length1<=i)){var r=e[n];e.splice(n--,1);for(var s=r.start1,a=r.start2,l="";0!==r.diffs.length;){var c=new t.patch_obj,u=!0;for(c.start1=s-l.length,c.start2=a-l.length,""!==l&&(c.length1=c.length2=l.length,c.diffs.push(new t.Diff(0,l)));0!==r.diffs.length&&c.length1<i-this.Patch_Margin;){var d=r.diffs[0][0],h=r.diffs[0][1];1===d?(c.length2+=h.length,a+=h.length,c.diffs.push(r.diffs.shift()),u=!1):d===o&&1==c.diffs.length&&0==c.diffs[0][0]&&h.length>2*i?(c.length1+=h.length,s+=h.length,u=!1,c.diffs.push(new t.Diff(d,h)),r.diffs.shift()):(h=h.substring(0,i-c.length1-this.Patch_Margin),c.length1+=h.length,s+=h.length,0===d?(c.length2+=h.length,a+=h.length):u=!1,c.diffs.push(new t.Diff(d,h)),h==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(h.length))}l=(l=this.diff_text2(c.diffs)).substring(l.length-this.Patch_Margin);var g=this.diff_text1(r.diffs).substring(0,this.Patch_Margin);""!==g&&(c.length1+=g.length,c.length2+=g.length,0!==c.diffs.length&&0===c.diffs[c.diffs.length-1][0]?c.diffs[c.diffs.length-1][1]+=g:c.diffs.push(new t.Diff(0,g))),u||e.splice(++n,0,c)}}},t.prototype.patch_toText=function(e){for(var t=[],o=0;o<e.length;o++)t[o]=e[o];return t.join("")},t.prototype.patch_fromText=function(e){var i=[];if(!e)return i;for(var n=e.split("\n"),r=0,s=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;r<n.length;){var a=n[r].match(s);if(!a)throw new Error("Invalid patch string: "+n[r]);var l=new t.patch_obj;for(i.push(l),l.start1=parseInt(a[1],10),""===a[2]?(l.start1--,l.length1=1):"0"==a[2]?l.length1=0:(l.start1--,l.length1=parseInt(a[2],10)),l.start2=parseInt(a[3],10),""===a[4]?(l.start2--,l.length2=1):"0"==a[4]?l.length2=0:(l.start2--,l.length2=parseInt(a[4],10)),r++;r<n.length;){var c=n[r].charAt(0);try{var u=decodeURI(n[r].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+u)}if("-"==c)l.diffs.push(new t.Diff(o,u));else if("+"==c)l.diffs.push(new t.Diff(1,u));else if(" "==c)l.diffs.push(new t.Diff(0,u));else{if("@"==c)break;if(""!==c)throw new Error('Invalid patch mode "'+c+'" in: '+u)}r++}}return i},(t.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:e="+";break;case o:e="-";break;case 0:e=" "}t[i+1]=e+encodeURI(this.diffs[i][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=t,e.exports.diff_match_patch=t,e.exports.DIFF_DELETE=o,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},85430:e=>{"use strict";var t=Object.prototype.hasOwnProperty,o="~";function i(){}function n(e,t,o){this.fn=e,this.context=t,this.once=o||!1}function r(e,t,i,r,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new n(i,r||e,s),l=o?o+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),a.prototype.eventNames=function(){var e,i,n=[];if(0===this._eventsCount)return n;for(i in e=this._events)t.call(e,i)&&n.push(o?i.slice(1):i);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},a.prototype.listeners=function(e){var t=o?o+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,r=i.length,s=new Array(r);n<r;n++)s[n]=i[n].fn;return s},a.prototype.listenerCount=function(e){var t=o?o+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,n,r,s){var a=o?o+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,n),!0;case 5:return u.fn.call(u.context,t,i,n,r),!0;case 6:return u.fn.call(u.context,t,i,n,r,s),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,g=u.length;for(c=0;c<g;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,i);break;case 4:u[c].fn.call(u[c].context,t,i,n);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,o){return r(this,e,t,o,!1)},a.prototype.once=function(e,t,o){return r(this,e,t,o,!0)},a.prototype.removeListener=function(e,t,i,n){var r=o?o+e:e;if(!this._events[r])return this;if(!t)return s(this,r),this;var a=this._events[r];if(a.fn)a.fn!==t||n&&!a.once||i&&a.context!==i||s(this,r);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||n&&!a[l].once||i&&a[l].context!==i)&&c.push(a[l]);c.length?this._events[r]=1===c.length?c[0]:c:s(this,r)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=o?o+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=o,a.EventEmitter=a,e.exports=a},26394:e=>{"use strict";e.exports=function e(t,o){if(t===o)return!0;if(t&&o&&"object"==typeof t&&"object"==typeof o){if(t.constructor!==o.constructor)return!1;var i,n,r;if(Array.isArray(t)){if((i=t.length)!=o.length)return!1;for(n=i;0!=n--;)if(!e(t[n],o[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===o.source&&t.flags===o.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===o.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===o.toString();if((i=(r=Object.keys(t)).length)!==Object.keys(o).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(o,r[n]))return!1;for(n=i;0!=n--;){var s=r[n];if(!e(t[s],o[s]))return!1}return!0}return t!=t&&o!=o}},7051:(e,t,o)=>{"use strict";o.d(t,{Pe:()=>c.P,PA:()=>v});var i=o(46546),n=o(95734);if(!n.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!i.makeObservable)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");var r=o(38883);var s=o(30540),a=function(){function e(e){var t=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(e){void 0===e&&(e=1e4),clearTimeout(t.sweepTimeout),t.sweepTimeout=void 0;var o=Date.now();t.registrations.forEach((function(i,n){o-i.registeredAt>=e&&(t.finalize(i.value),t.registrations.delete(n))})),t.registrations.size>0&&t.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){t.sweep(0)}})}return Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,o){this.registrations.set(o,{value:t,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.registrations.delete(e)}}),Object.defineProperty(e.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){void 0===this.sweepTimeout&&(this.sweepTimeout=setTimeout(this.sweep,1e4))}}),e}(),l=new("undefined"!=typeof FinalizationRegistry?FinalizationRegistry:a)((function(e){var t;null===(t=e.reaction)||void 0===t||t.dispose(),e.reaction=null})),c=o(9983),u=function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var i,n,r=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return s};function d(e){return"observer".concat(e)}var h=function(){};function g(){return new h}var p="function"==typeof Symbol&&Symbol.for,f=p?Symbol.for("react.forward_ref"):"function"==typeof n.forwardRef&&(0,n.forwardRef)((function(e){return null})).$$typeof,m=p?Symbol.for("react.memo"):"function"==typeof n.memo&&(0,n.memo)((function(e){return null})).$$typeof;function v(e,t){var o;if(m&&e.$$typeof===m)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");if((0,c.P)())return e;var r=null!==(o=null==t?void 0:t.forwardRef)&&void 0!==o&&o,a=e,h=e.displayName||e.name;if(f&&e.$$typeof===f&&(r=!0,"function"!=typeof(a=e.render)))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var p,v,b=function(e,t){return function(e,t){if(void 0===t&&(t="observed"),(0,c.P)())return e();var o=u(n.useState(g),1)[0],r=u(n.useState(),2)[1],a=function(){return r([])},h=n.useRef(null);h.current||(h.current={reaction:null,mounted:!1,changedBeforeMount:!1});var p,f,m=h.current;if(m.reaction||(m.reaction=new i.Reaction(d(t),(function(){m.mounted?a():m.changedBeforeMount=!0})),l.register(o,m,m)),n.useDebugValue(m.reaction,s.E),n.useEffect((function(){return l.unregister(m),m.mounted=!0,m.reaction?m.changedBeforeMount&&(m.changedBeforeMount=!1,a()):(m.reaction=new i.Reaction(d(t),(function(){a()})),a()),function(){m.reaction.dispose(),m.reaction=null,m.mounted=!1,m.changedBeforeMount=!1}}),[]),m.reaction.track((function(){try{p=e()}catch(e){f=e}})),f)throw f;return p}((function(){return a(e,t)}),h)};return""!==h&&(b.displayName=h),e.contextTypes&&(b.contextTypes=e.contextTypes),r&&(b=(0,n.forwardRef)(b)),b=(0,n.memo)(b),p=e,v=b,Object.keys(p).forEach((function(e){y[e]||Object.defineProperty(v,e,Object.getOwnPropertyDescriptor(p,e))})),b}var b,y={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};(b=r.unstable_batchedUpdates)||(b=function(e){e()}),(0,i.configure)({reactionScheduler:b}),l.finalizeAllImmediately},9983:(e,t,o)=>{"use strict";o.d(t,{P:()=>n});var i=!1;function n(){return i}},30540:(e,t,o)=>{"use strict";if(o.d(t,{E:()=>n}),3023==o.j)var i=o(46546);function n(e){return(0,i.getDependencyTree)(e)}},4984:(e,t,o)=>{"use strict";o.d(t,{PA:()=>E});var i=o(46546),n=o(95734),r=o(7051),s=0,a={};function l(e){return a[e]||(a[e]=function(e){if("function"==typeof Symbol)return Symbol(e);var t="__$mobx-react "+e+" ("+s+")";return s++,t}(e)),a[e]}function c(e,t){if(u(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var o=Object.keys(e),i=Object.keys(t);if(o.length!==i.length)return!1;for(var n=0;n<o.length;n++)if(!Object.hasOwnProperty.call(t,o[n])||!u(e[o[n]],t[o[n]]))return!1;return!0}function u(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function d(e,t,o){Object.hasOwnProperty.call(e,t)?e[t]=o:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:o})}var h=3023==o.j?l("patchMixins"):null,g=3023==o.j?l("patchedDefinition"):null;function p(e,t){for(var o=this,i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];t.locks++;try{var s;return null!=e&&(s=e.apply(this,n)),s}finally{t.locks--,0===t.locks&&t.methods.forEach((function(e){e.apply(o,n)}))}}function f(e,t){return function(){for(var o=arguments.length,i=new Array(o),n=0;n<o;n++)i[n]=arguments[n];p.call.apply(p,[this,e,t].concat(i))}}function m(e,t,o){var i=function(e,t){var o=e[h]=e[h]||{},i=o[t]=o[t]||{};return i.locks=i.locks||0,i.methods=i.methods||[],i}(e,t);i.methods.indexOf(o)<0&&i.methods.push(o);var n=Object.getOwnPropertyDescriptor(e,t);if(!n||!n[g]){var r=e[t],s=v(e,t,n?n.enumerable:void 0,i,r);Object.defineProperty(e,t,s)}}function v(e,t,o,i,n){var r,s=f(n,i);return(r={})[g]=!0,r.get=function(){return s},r.set=function(n){if(this===e)s=f(n,i);else{var r=v(this,t,o,i,n);Object.defineProperty(this,t,r)}},r.configurable=!0,r.enumerable=o,r}var b=3023==o.j?i.$mobx||"$mobx":null,y=3023==o.j?l("isMobXReactObserver"):null,w=3023==o.j?l("isUnmounted"):null,C=3023==o.j?l("skipRender"):null,S=3023==o.j?l("isForcingUpdate"):null;function k(e){var t=e.prototype;if(e[y]){var o=T(t);console.warn("The provided component class ("+o+")\n                has already been declared as an observer component.")}else e[y]=!0;if(t.componentWillReact)throw new Error("The componentWillReact life-cycle event is no longer supported");if(e.__proto__!==n.PureComponent)if(t.shouldComponentUpdate){if(t.shouldComponentUpdate!==_)throw new Error("It is not allowed to use shouldComponentUpdate in observer based components.")}else t.shouldComponentUpdate=_;I(t,"props"),I(t,"state"),e.contextType&&I(t,"context");var i=t.render;if("function"!=typeof i){var s=T(t);throw new Error("[mobx-react] class component ("+s+") is missing `render` method.\n`observer` requires `render` being a function defined on prototype.\n`render = () => {}` or `render = function() {}` is not supported.")}return t.render=function(){return this.render=(0,r.Pe)()?i:x.call(this,i),this.render()},m(t,"componentDidMount",(function(){this[w]=!1,this.render[b]||n.Component.prototype.forceUpdate.call(this)})),m(t,"componentWillUnmount",(function(){if(!(0,r.Pe)()){var e=this.render[b];if(e)e.dispose(),this.render[b]=null;else{var t=T(this);console.warn("The reactive render of an observer class component ("+t+")\n                was overridden after MobX attached. This may result in a memory leak if the\n                overridden reactive render was not properly disposed.")}this[w]=!0}})),e}function T(e){return e.displayName||e.name||e.constructor&&(e.constructor.displayName||e.constructor.name)||"<component>"}function x(e){var t=this;d(this,C,!1),d(this,S,!1);var o=T(this),r=e.bind(this),s=!1;return function e(){var a;s=!1;var l=null!=(a=e[b])?a:e[b]=function(){var e=new i.Reaction(o+".render()",(function(){if(!s&&(s=!0,!0!==t[w])){var o=!0;try{d(t,S,!0),t[C]||n.Component.prototype.forceUpdate.call(t),o=!1}finally{d(t,S,!1),o&&(e.dispose(),t.render[b]=null)}}}));return e.reactComponent=t,e}(),c=void 0,u=void 0;if(l.track((function(){try{u=(0,i._allowStateChanges)(!1,r)}catch(e){c=e}})),c)throw c;return u}}function _(e,t){return(0,r.Pe)()&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==t||!c(this.props,e)}function I(e,t){var o=l("reactProp_"+t+"_valueHolder"),n=l("reactProp_"+t+"_atomHolder");function r(){return this[n]||d(this,n,(0,i.createAtom)("reactive "+t)),this[n]}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){var e=!1;return i._allowStateReadsStart&&i._allowStateReadsEnd&&(e=(0,i._allowStateReadsStart)(!0)),r.call(this).reportObserved(),i._allowStateReadsStart&&i._allowStateReadsEnd&&(0,i._allowStateReadsEnd)(e),this[o]},set:function(e){this[S]||c(this[o],e)?d(this,o,e):(d(this,o,e),d(this,C,!0),r.call(this).reportChanged(),d(this,C,!1))}})}function E(e){return!0===e.isMobxInjector&&console.warn("Mobx observer: You are trying to use `observer` on a component that already has `inject`. Please apply `observer` before applying `inject`"),Object.prototype.isPrototypeOf.call(n.Component,e)||Object.prototype.isPrototypeOf.call(n.PureComponent,e)?k(e):(0,r.PA)(e)}if(!n.Component)throw new Error("mobx-react requires React to be available");if(!i.observable)throw new Error("mobx-react requires mobx to be available")},58276:(e,t,o)=>{"use strict";o.d(t,{Az:()=>Re,CP:()=>s,GD:()=>u,S:()=>Ae,U6:()=>X,_A:()=>Be,h7:()=>n,hC:()=>De,iA:()=>a,mz:()=>Me});var i=o(96406);const n="data-tabster",r=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]","details > summary","audio[controls]","video[controls]"].join(", "),s={Source:0,Target:1},a={Both:0,Vertical:1,Horizontal:2,Grid:3,GridLinear:4};function l(e,t){var o;return null===(o=e.storageEntry(t))||void 0===o?void 0:o.tabster}function c(e,t,o){var i,r;const s=o||e._noop?void 0:t.getAttribute(n);let a,l=e.storageEntry(t);if(s){if(s===(null===(i=null==l?void 0:l.attr)||void 0===i?void 0:i.string))return;try{const e=JSON.parse(s);if("object"!=typeof e)throw new Error(`Value is not a JSON object, got '${s}'.`);a={string:s,object:e}}catch(e){}}else if(!l)return;l||(l=e.storageEntry(t,!0)),l.tabster||(l.tabster={});const c=l.tabster||{},u=(null===(r=l.attr)||void 0===r?void 0:r.object)||{},d=(null==a?void 0:a.object)||{};for(const o of Object.keys(u))if(!d[o]){if("root"===o){const t=c[o];t&&e.root.onRoot(t,!0)}switch(o){case"deloser":case"root":case"groupper":case"modalizer":case"restorer":case"mover":const i=c[o];i&&(i.dispose(),delete c[o]);break;case"observed":delete c[o],e.observedElement&&e.observedElement.onObservedElementUpdate(t);break;case"focusable":case"outline":case"uncontrolled":case"sys":delete c[o]}}for(const o of Object.keys(d)){const i=d.sys;switch(o){case"deloser":c.deloser?c.deloser.setProps(d.deloser):e.deloser&&(c.deloser=e.deloser.createDeloser(t,d.deloser));break;case"root":c.root?c.root.setProps(d.root):c.root=e.root.createRoot(t,d.root,i),e.root.onRoot(c.root);break;case"modalizer":c.modalizer?c.modalizer.setProps(d.modalizer):e.modalizer&&(c.modalizer=e.modalizer.createModalizer(t,d.modalizer,i));break;case"restorer":c.restorer?c.restorer.setProps(d.restorer):e.restorer&&d.restorer&&(c.restorer=e.restorer.createRestorer(t,d.restorer));break;case"focusable":c.focusable=d.focusable;break;case"groupper":c.groupper?c.groupper.setProps(d.groupper):e.groupper&&(c.groupper=e.groupper.createGroupper(t,d.groupper,i));break;case"mover":c.mover?c.mover.setProps(d.mover):e.mover&&(c.mover=e.mover.createMover(t,d.mover,i));break;case"observed":e.observedElement&&(c.observed=d.observed,e.observedElement.onObservedElementUpdate(t));break;case"uncontrolled":c.uncontrolled=d.uncontrolled;break;case"outline":e.outline&&(c.outline=d.outline);break;case"sys":c.sys=d.sys;break;default:console.error(`Unknown key '${o}' in data-tabster attribute value.`)}}a?l.attr=a:(0===Object.keys(c).length&&(delete l.tabster,delete l.attr),e.storageEntry(t,!1))}const u="tabster:movefocus",d="tabster:mover:movefocus",h="tabster:mover:memorized-element",g="tabster:restorer:restore-focus",p="undefined"!=typeof CustomEvent?CustomEvent:function(){};class f extends p{constructor(e,t){super(e,{bubbles:!0,cancelable:!0,composed:!0,detail:t}),this.details=t}}class m extends f{constructor(e){super("tabster:focusin",e)}}class v extends f{constructor(e){super("tabster:focusout",e)}}class b extends f{constructor(e){super(u,e)}}class y extends f{constructor(e){super("tabster:mover:state",e)}}class w extends f{constructor(e){super("tabster:modalizer:active",e)}}class C extends f{constructor(e){super("tabster:modalizer:inactive",e)}}class S extends f{constructor(){super(g)}}class k extends f{constructor(e){super("tabster:root:focus",e)}}class T extends f{constructor(e){super("tabster:root:blur",e)}}const x={createMutationObserver:e=>new MutationObserver(e),createTreeWalker:(e,t,o,i)=>e.createTreeWalker(t,o,i),getParentNode:e=>e?e.parentNode:null,getParentElement:e=>e?e.parentElement:null,nodeContains:(e,t)=>!(!t||!(null==e?void 0:e.contains(t))),getActiveElement:e=>e.activeElement,querySelector:(e,t)=>e.querySelector(t),querySelectorAll:(e,t)=>Array.prototype.slice.call(e.querySelectorAll(t),0),getElementById:(e,t)=>e.getElementById(t),getFirstChild:e=>(null==e?void 0:e.firstChild)||null,getLastChild:e=>(null==e?void 0:e.lastChild)||null,getNextSibling:e=>(null==e?void 0:e.nextSibling)||null,getPreviousSibling:e=>(null==e?void 0:e.previousSibling)||null,getFirstElementChild:e=>(null==e?void 0:e.firstElementChild)||null,getLastElementChild:e=>(null==e?void 0:e.lastElementChild)||null,getNextElementSibling:e=>(null==e?void 0:e.nextElementSibling)||null,getPreviousElementSibling:e=>(null==e?void 0:e.previousElementSibling)||null,appendChild:(e,t)=>e.appendChild(t),insertBefore:(e,t,o)=>e.insertBefore(t,o),getSelection:e=>{var t;return(null===(t=e.ownerDocument)||void 0===t?void 0:t.getSelection())||null},getElementsByName:(e,t)=>e.ownerDocument.getElementsByName(t)};let _;const I="undefined"!=typeof DOMRect?DOMRect:class{constructor(e,t,o,i){this.left=e||0,this.top=t||0,this.right=(e||0)+(o||0),this.bottom=(t||0)+(i||0)}};let E=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),_=!1}catch(e){_=!0}function B(e){const t=e();let o=t.__tabsterInstanceContext;return o||(o={elementByUId:{},basics:{Promise:t.Promise||void 0,WeakRef:t.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},t.__tabsterInstanceContext=o),o}class A{constructor(e){this._target=e}deref(){return this._target}static cleanup(e,t){return!e._target||!(!t&&z(e._target.ownerDocument,e._target))&&(delete e._target,!0)}}class R{constructor(e,t,o){const i=B(e);let n;i.WeakRef?n=new i.WeakRef(t):(n=new A(t),i.fakeWeakRefs.push(n)),this._ref=n,this._data=o}get(){const e=this._ref;let t;return e&&(t=e.deref(),t||delete this._ref),t}getData(){return this._data}}function M(e,t){const o=B(e);o.fakeWeakRefs=o.fakeWeakRefs.filter((e=>!A.cleanup(e,t)))}function D(e){const t=B(e);t.fakeWeakRefsStarted||(t.fakeWeakRefsStarted=!0,t.WeakRef=function(e){return e.basics.WeakRef}(t)),t.fakeWeakRefsTimer||(t.fakeWeakRefsTimer=e().setTimeout((()=>{t.fakeWeakRefsTimer=void 0,M(e),D(e)}),12e4))}function P(e,t,o){if(t.nodeType!==Node.ELEMENT_NODE)return;const i=_?o:{acceptNode:o};return x.createTreeWalker(e,t,NodeFilter.SHOW_ELEMENT,i,!1)}function F(e,t){let o=t.__tabsterCacheId;const i=B(e),n=o?i.containerBoundingRectCache[o]:void 0;if(n)return n.rect;const r=t.ownerDocument&&t.ownerDocument.documentElement;if(!r)return new I;let s=0,a=0,l=r.clientWidth,c=r.clientHeight;if(t!==r){const e=t.getBoundingClientRect();s=Math.max(s,e.left),a=Math.max(a,e.top),l=Math.min(l,e.right),c=Math.min(c,e.bottom)}const u=new I(s<l?s:-1,a<c?a:-1,s<l?l-s:0,a<c?c-a:0);return o||(o="r-"+ ++i.lastContainerBoundingRectCacheId,t.__tabsterCacheId=o),i.containerBoundingRectCache[o]={rect:u,element:t},i.containerBoundingRectCacheTimer||(i.containerBoundingRectCacheTimer=window.setTimeout((()=>{i.containerBoundingRectCacheTimer=void 0;for(const e of Object.keys(i.containerBoundingRectCache))delete i.containerBoundingRectCache[e].element.__tabsterCacheId;i.containerBoundingRectCache={}}),50)),u}function O(e,t,o){const i=N(t);if(!i)return!1;const n=F(e,i),r=t.getBoundingClientRect(),s=r.height*(1-o),a=Math.max(0,n.top-r.top)+Math.max(0,r.bottom-n.bottom);return 0===a||a<=s}function N(e){const t=e.ownerDocument;if(t){for(let t=x.getParentElement(e);t;t=x.getParentElement(t))if(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)return t;return t.documentElement}return null}function q(e){return!!e.__shouldIgnoreFocus}function j(e,t){const o=B(e);let i=t.__tabsterElementUID;return i||(i=t.__tabsterElementUID=function(e){const t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(let e=0;e<t.length;e++)t[e]=4294967295*Math.random();const o=[];for(let e=0;e<t.length;e++)o.push(t[e].toString(36));return o.push("|"),o.push((++E).toString(36)),o.push("|"),o.push(Date.now().toString(36)),o.join("")}(e())),!o.elementByUId[i]&&z(t.ownerDocument,t)&&(o.elementByUId[i]=new R(e,t)),i}function L(e,t){const o=B(e);for(const e of Object.keys(o.elementByUId)){const i=o.elementByUId[e],n=i&&i.get();n&&t&&!x.nodeContains(t,n)||delete o.elementByUId[e]}}function z(e,t){return x.nodeContains(null==e?void 0:e.body,t)}function H(e,t){const o=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return o&&o.call(e,t)}let W=0;class U{constructor(e,t,o){const i=e.getWindow;this._tabster=e,this._element=new R(i,t),this._props={...o},this.id="i"+ ++W}getElement(){return this._element.get()}getProps(){return this._props}setProps(e){this._props={...e}}}class G{constructor(e,t,o,n,r){var s;this._focusIn=e=>{if(this._fixedTarget){const e=this._fixedTarget.get();return void(e&&(0,i.kG)(e))}const t=this.input;if(this.onFocusIn&&t){const o=e.relatedTarget;this.onFocusIn(this,this._isBackward(!0,t,o),o)}},this._focusOut=e=>{if(this._fixedTarget)return;this.useDefaultAction=!1;const t=this.input;if(this.onFocusOut&&t){const o=e.relatedTarget;this.onFocusOut(this,this._isBackward(!1,t,o),o)}};const a=e(),l=a.document.createElement("i");l.tabIndex=0,l.setAttribute("role","none"),l.setAttribute("data-tabster-dummy",""),l.setAttribute("aria-hidden","true");const c=l.style;c.position="fixed",c.width=c.height="1px",c.opacity="0.001",c.zIndex="-1",c.setProperty("content-visibility","hidden"),function(e){e.__shouldIgnoreFocus=!0}(l),this.input=l,this.isFirst=o.isFirst,this.isOutside=t,this._isPhantom=null!==(s=o.isPhantom)&&void 0!==s&&s,this._fixedTarget=r,l.addEventListener("focusin",this._focusIn),l.addEventListener("focusout",this._focusOut),l.__tabsterDummyContainer=n,this._isPhantom&&(this._disposeTimer=a.setTimeout((()=>{delete this._disposeTimer,this.dispose()}),0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(a.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}dispose(){var e;this._clearDisposeTimeout&&this._clearDisposeTimeout();const t=this.input;t&&(delete this._fixedTarget,delete this.onFocusIn,delete this.onFocusOut,delete this.input,t.removeEventListener("focusin",this._focusIn),t.removeEventListener("focusout",this._focusOut),delete t.__tabsterDummyContainer,null===(e=x.getParentNode(t))||void 0===e||e.removeChild(t))}setTopLeft(e,t){var o;const i=null===(o=this.input)||void 0===o?void 0:o.style;i&&(i.top=`${e}px`,i.left=`${t}px`)}_isBackward(e,t,o){return e&&!o?!this.isFirst:!!(o&&t.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING)}}class V{constructor(e,t,o,i,n,r){this._element=t,this._instance=new K(e,t,this,o,i,n,r)}_setHandlers(e,t){this._onFocusIn=e,this._onFocusOut=t}moveOut(e){var t;null===(t=this._instance)||void 0===t||t.moveOut(e)}moveOutWithDefaultAction(e,t){var o;null===(o=this._instance)||void 0===o||o.moveOutWithDefaultAction(e,t)}getHandler(e){return e?this._onFocusIn:this._onFocusOut}setTabbable(e){var t;null===(t=this._instance)||void 0===t||t.setTabbable(this,e)}dispose(){this._instance&&(this._instance.dispose(this),delete this._instance),delete this._onFocusIn,delete this._onFocusOut}static moveWithPhantomDummy(e,t,o,n,r){const s=new G(e.getWindow,!0,{isPhantom:!0,isFirst:!0}).input;if(s){let a,l;if("BODY"===t.tagName)a=t,l=o&&n||!o&&!n?x.getFirstElementChild(t):null;else{let i,r;o&&(!n||n&&!e.focusable.isFocusable(t,!1,!0,!0))?(a=t,l=n?t.firstElementChild:null):(a=x.getParentElement(t),l=o&&n||!o&&!n?t:x.getNextElementSibling(t));do{i=o&&n||!o&&!n?x.getPreviousElementSibling(l):l,r=Z(i),r===t?l=o&&n||!o&&!n?i:x.getNextElementSibling(i):r=null}while(r)}(null==a?void 0:a.dispatchEvent(new b({by:"root",owner:a,next:null,relatedEvent:r})))&&(x.insertBefore(a,s,l),(0,i.kG)(s))}}static addPhantomDummyWithTarget(e,t,o,i){const n=new G(e.getWindow,!0,{isPhantom:!0,isFirst:!0},void 0,new R(e.getWindow,i)).input;if(n){let e,i;t.querySelector(r)&&!o?(e=t,i=x.getFirstElementChild(t)):(e=x.getParentElement(t),i=o?t:x.getNextElementSibling(t)),e&&x.insertBefore(e,n,i)}}}class ${constructor(e){this._updateQueue=new Set,this._lastUpdateQueueTime=0,this._changedParents=new WeakSet,this._dummyElements=[],this._dummyCallbacks=new WeakMap,this._domChanged=e=>{var t;this._changedParents.has(e)||(this._changedParents.add(e),this._updateDummyInputsTimer||(this._updateDummyInputsTimer=null===(t=this._win)||void 0===t?void 0:t.call(this).setTimeout((()=>{delete this._updateDummyInputsTimer;for(const e of this._dummyElements){const t=e.get();if(t){const e=this._dummyCallbacks.get(t);if(e){const o=x.getParentNode(t);o&&!this._changedParents.has(o)||e()}}}this._changedParents=new WeakSet}),100)))},this._win=e}add(e,t){!this._dummyCallbacks.has(e)&&this._win&&(this._dummyElements.push(new R(this._win,e)),this._dummyCallbacks.set(e,t),this.domChanged=this._domChanged)}remove(e){this._dummyElements=this._dummyElements.filter((t=>{const o=t.get();return o&&o!==e})),this._dummyCallbacks.delete(e),0===this._dummyElements.length&&delete this.domChanged}dispose(){var e;const t=null===(e=this._win)||void 0===e?void 0:e.call(this);this._updateTimer&&(null==t||t.clearTimeout(this._updateTimer),delete this._updateTimer),this._updateDummyInputsTimer&&(null==t||t.clearTimeout(this._updateDummyInputsTimer),delete this._updateDummyInputsTimer),this._changedParents=new WeakSet,this._dummyCallbacks=new WeakMap,this._dummyElements=[],this._updateQueue.clear(),delete this.domChanged,delete this._win}updatePositions(e){this._win&&(this._updateQueue.add(e),this._lastUpdateQueueTime=Date.now(),this._scheduledUpdatePositions())}_scheduledUpdatePositions(){var e;this._updateTimer||(this._updateTimer=null===(e=this._win)||void 0===e?void 0:e.call(this).setTimeout((()=>{if(delete this._updateTimer,this._lastUpdateQueueTime+100<=Date.now()){const e=new Map,t=[];for(const o of this._updateQueue)t.push(o(e));this._updateQueue.clear();for(const e of t)e();e.clear()}else this._scheduledUpdatePositions()}),100))}}class K{constructor(e,t,o,n,r,s,a){this._wrappers=[],this._isOutside=!1,this._transformElements=new Set,this._onFocusIn=(e,t,o)=>{this._onFocus(!0,e,t,o)},this._onFocusOut=(e,t,o)=>{this._onFocus(!1,e,t,o)},this.moveOut=e=>{var t;const o=this._firstDummy,n=this._lastDummy;if(o&&n){this._ensurePosition();const r=o.input,s=n.input,a=null===(t=this._element)||void 0===t?void 0:t.get();if(r&&s&&a){let t;e?(r.tabIndex=0,t=r):(s.tabIndex=0,t=s),t&&(0,i.kG)(t)}}},this.moveOutWithDefaultAction=(e,t)=>{var o;const n=this._firstDummy,r=this._lastDummy;if(n&&r){this._ensurePosition();const s=n.input,a=r.input,l=null===(o=this._element)||void 0===o?void 0:o.get();if(s&&a&&l){let o;e?!n.isOutside&&this._tabster.focusable.isFocusable(l,!0,!0,!0)?o=l:(n.useDefaultAction=!0,s.tabIndex=0,o=s):(r.useDefaultAction=!0,a.tabIndex=0,o=a),o&&l.dispatchEvent(new b({by:"root",owner:l,next:null,relatedEvent:t}))&&(0,i.kG)(o)}}},this.setTabbable=(e,t)=>{var o,i;for(const o of this._wrappers)if(o.manager===e){o.tabbable=t;break}const n=this._getCurrent();if(n){const e=n.tabbable?0:-1;let t=null===(o=this._firstDummy)||void 0===o?void 0:o.input;t&&(t.tabIndex=e),t=null===(i=this._lastDummy)||void 0===i?void 0:i.input,t&&(t.tabIndex=e)}},this._addDummyInputs=()=>{this._addTimer||(this._addTimer=this._getWindow().setTimeout((()=>{delete this._addTimer,this._ensurePosition(),this._addTransformOffsets()}),0))},this._addTransformOffsets=()=>{this._tabster._dummyObserver.updatePositions(this._computeTransformOffsets)},this._computeTransformOffsets=e=>{var t,o;const i=(null===(t=this._firstDummy)||void 0===t?void 0:t.input)||(null===(o=this._lastDummy)||void 0===o?void 0:o.input),n=this._transformElements,r=new Set;let s=0,a=0;const l=this._getWindow();for(let t=i;t&&t.nodeType===Node.ELEMENT_NODE;t=x.getParentElement(t)){let o=e.get(t);if(void 0===o){const i=l.getComputedStyle(t).transform;i&&"none"!==i&&(o={scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),e.set(t,o||null)}o&&(r.add(t),n.has(t)||t.addEventListener("scroll",this._addTransformOffsets),s+=o.scrollTop,a+=o.scrollLeft)}for(const e of n)r.has(e)||e.removeEventListener("scroll",this._addTransformOffsets);return this._transformElements=r,()=>{var e,t;null===(e=this._firstDummy)||void 0===e||e.setTopLeft(s,a),null===(t=this._lastDummy)||void 0===t||t.setTopLeft(s,a)}};const l=t.get();if(!l)throw new Error("No element");this._tabster=e,this._getWindow=e.getWindow,this._callForDefaultAction=a;const c=l.__tabsterDummy;if((c||this)._wrappers.push({manager:o,priority:n,tabbable:!0}),c)return c;l.__tabsterDummy=this;const u=null==r?void 0:r.dummyInputsPosition,d=l.tagName;this._isOutside=u?2===u:(s||"UL"===d||"OL"===d||"TABLE"===d)&&!("LI"===d||"TD"===d||"TH"===d),this._firstDummy=new G(this._getWindow,this._isOutside,{isFirst:!0},t),this._lastDummy=new G(this._getWindow,this._isOutside,{isFirst:!1},t);const h=this._firstDummy.input;h&&e._dummyObserver.add(h,this._addDummyInputs),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=t,this._addDummyInputs()}dispose(e,t){var o,i,n,r;if(0===(this._wrappers=this._wrappers.filter((o=>o.manager!==e&&!t))).length){delete(null===(o=this._element)||void 0===o?void 0:o.get()).__tabsterDummy;for(const e of this._transformElements)e.removeEventListener("scroll",this._addTransformOffsets);this._transformElements.clear();const e=this._getWindow();this._addTimer&&(e.clearTimeout(this._addTimer),delete this._addTimer);const t=null===(i=this._firstDummy)||void 0===i?void 0:i.input;t&&this._tabster._dummyObserver.remove(t),null===(n=this._firstDummy)||void 0===n||n.dispose(),null===(r=this._lastDummy)||void 0===r||r.dispose()}}_onFocus(e,t,o,i){var n;const r=this._getCurrent();!r||t.useDefaultAction&&!this._callForDefaultAction||null===(n=r.manager.getHandler(e))||void 0===n||n(t,o,i)}_getCurrent(){return this._wrappers.sort(((e,t)=>e.tabbable!==t.tabbable?e.tabbable?-1:1:e.priority-t.priority)),this._wrappers[0]}_ensurePosition(){var e,t,o;const i=null===(e=this._element)||void 0===e?void 0:e.get(),n=null===(t=this._firstDummy)||void 0===t?void 0:t.input,r=null===(o=this._lastDummy)||void 0===o?void 0:o.input;if(i&&n&&r)if(this._isOutside){const e=x.getParentNode(i);if(e){const t=x.getNextSibling(i);t!==r&&x.insertBefore(e,r,t),x.getPreviousElementSibling(i)!==n&&x.insertBefore(e,n,i)}}else{x.getLastElementChild(i)!==r&&x.appendChild(i,r);const e=x.getFirstElementChild(i);e&&e!==n&&e.parentNode&&x.insertBefore(e.parentNode,n,e)}}}function J(e){let t=null;for(let o=x.getLastElementChild(e);o;o=x.getLastElementChild(o))t=o;return t||void 0}function Y(e,t,o,i){const n=e.storageEntry(t,!0);let r=!1;if(!n.aug){if(void 0===i)return r;n.aug={}}if(void 0===i){if(o in n.aug){const e=n.aug[o];delete n.aug[o],null===e?t.removeAttribute(o):t.setAttribute(o,e),r=!0}}else{let e;o in n.aug||(e=t.getAttribute(o)),void 0!==e&&e!==i&&(n.aug[o]=e,null===i?t.removeAttribute(o):t.setAttribute(o,i),r=!0)}return void 0===i&&0===Object.keys(n.aug).length&&(delete n.aug,e.storageEntry(t,!1)),r}function Q(e){return"INPUT"===e.tagName&&!!e.name&&"radio"===e.type}function Z(e){var t;return(null===(t=null==e?void 0:e.__tabsterDummyContainer)||void 0===t?void 0:t.get())||null}function X(e,t){const o=JSON.stringify(e);return!0===t?o:{[n]:o}}class ee extends V{constructor(e,t,o,n){super(e,t,1,n,void 0,!0),this._onDummyInputFocus=e=>{var t;if(e.useDefaultAction)this._setFocused(!1);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);const o=this._element.get();if(o){this._setFocused(!0);const t=this._tabster.focusedElement.getFirstOrLastTabbable(e.isFirst,{container:o,ignoreAccessibility:!0});if(t)return void(0,i.kG)(t)}null===(t=e.input)||void 0===t||t.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=e,this._setFocused=o}}class te extends U{constructor(e,t,o,n,r){super(e,t,n),this._isFocused=!1,this._setFocused=e=>{var t;if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===e)return;const o=this._element.get();o&&(e?(this._isFocused=!0,null===(t=this._dummyManager)||void 0===t||t.setTabbable(!1),o.dispatchEvent(new k({element:o}))):this._setFocusedTimer=this._tabster.getWindow().setTimeout((()=>{var e;delete this._setFocusedTimer,this._isFocused=!1,null===(e=this._dummyManager)||void 0===e||e.setTabbable(!0),o.dispatchEvent(new T({element:o}))}),0))},this._onFocusIn=e=>{const t=this._tabster.getParent,o=this._element.get();let i=e.composedPath()[0];do{if(i===o)return void this._setFocused(!0);i=i&&t(i)}while(i)},this._onFocusOut=()=>{this._setFocused(!1)},this._onDispose=o;const s=e.getWindow;this.uid=j(s,t),this._sys=r,(e.controlTab||e.rootDummyInputs)&&this.addDummyInputs();const a=s().document;a.addEventListener(i.Oy,this._onFocusIn),a.addEventListener(i.RY,this._onFocusOut),this._add()}addDummyInputs(){this._dummyManager||(this._dummyManager=new ee(this._tabster,this._element,this._setFocused,this._sys))}dispose(){var e;this._onDispose(this);const t=this._tabster.getWindow(),o=t.document;o.removeEventListener(i.Oy,this._onFocusIn),o.removeEventListener(i.RY,this._onFocusOut),this._setFocusedTimer&&(t.clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),null===(e=this._dummyManager)||void 0===e||e.dispose(),this._remove()}moveOutWithDefaultAction(e,t){const o=this._dummyManager;if(o)o.moveOutWithDefaultAction(e,t);else{const o=this.getElement();o&&ee.moveWithPhantomDummy(this._tabster,o,!0,e,t)}}_add(){}_remove(){}}class oe{constructor(e,t){this._autoRootWaiting=!1,this._roots={},this._forceDummy=!1,this.rootById={},this._autoRootCreate=()=>{var e;const t=this._win().document,o=t.body;if(o){this._autoRootUnwait(t);const i=this._autoRoot;if(i)return function(e,t,o){let i;if(o){const t=e.getAttribute(n);if(t)try{i=JSON.parse(t)}catch(e){}}i||(i={}),function(e,t){for(const o of Object.keys(t)){const i=t[o];i?e[o]=i:delete e[o]}}(i,t),Object.keys(i).length>0?e.setAttribute(n,X(i,!0)):e.removeAttribute(n)}(o,{root:i},!0),c(this._tabster,o),null===(e=l(this._tabster,o))||void 0===e?void 0:e.root}else this._autoRootWaiting||(this._autoRootWaiting=!0,t.addEventListener("readystatechange",this._autoRootCreate))},this._onRootDispose=e=>{delete this._roots[e.id]},this._tabster=e,this._win=e.getWindow,this._autoRoot=t,e.queueInit((()=>{this._autoRoot&&this._autoRootCreate()}))}_autoRootUnwait(e){e.removeEventListener("readystatechange",this._autoRootCreate),this._autoRootWaiting=!1}dispose(){const e=this._win();this._autoRootUnwait(e.document),delete this._autoRoot,Object.keys(this._roots).forEach((e=>{this._roots[e]&&(this._roots[e].dispose(),delete this._roots[e])})),this.rootById={}}createRoot(e,t,o){const i=new te(this._tabster,e,this._onRootDispose,t,o);return this._roots[i.id]=i,this._forceDummy&&i.addDummyInputs(),i}addDummyInputs(){this._forceDummy=!0;const e=this._roots;for(const t of Object.keys(e))e[t].addDummyInputs()}static getRootByUId(e,t){const o=e().__tabsterInstance;return o&&o.root.rootById[t]}static getTabsterContext(e,t,o){var i,n,r,s;if(void 0===o&&(o={}),!t.ownerDocument)return;const{checkRtl:a,referenceElement:c}=o,u=e.getParent;let d,h,g,p;e.drainInitQueue();let f,m,v,b,y=!1,w=c||t;const C={};for(;w&&(!d||a);){const o=l(e,w);if(a&&void 0===v){const e=w.dir;e&&(v="rtl"===e.toLowerCase())}if(!o){w=u(w);continue}const s=w.tagName;(o.uncontrolled||"IFRAME"===s||"WEBVIEW"===s)&&(b=w),p||!(null===(i=o.focusable)||void 0===i?void 0:i.excludeFromMover)||g||(y=!0);const c=o.modalizer,S=o.groupper,k=o.mover;!h&&c&&(h=c),g||!S||h&&!c||(h?(!S.isActive()&&S.getProps().tabbability&&h.userId!==(null===(n=e.modalizer)||void 0===n?void 0:n.activeId)&&(h=void 0,g=S),m=S):g=S),p||!k||h&&!c||S&&w===t||!w.contains(t)||(p=k,f=!!g&&g!==S),o.root&&(d=o.root),(null===(r=o.focusable)||void 0===r?void 0:r.ignoreKeydown)&&Object.assign(C,o.focusable.ignoreKeydown),w=u(w)}if(!d){const o=e.root;o._autoRoot&&(null===(s=t.ownerDocument)||void 0===s?void 0:s.body)&&(d=o._autoRootCreate())}return g&&!p&&(f=!0),d?{root:d,modalizer:h,groupper:g,mover:p,groupperBeforeMover:f,modalizerInGroupper:m,rtl:a?!!v:void 0,uncontrolled:b,excludedFromMover:y,ignoreKeydown:e=>!!C[e.key]}:void 0}static getRoot(e,t){var o;const i=e.getParent;for(let n=t;n;n=i(n)){const t=null===(o=l(e,n))||void 0===o?void 0:o.root;if(t)return t}}onRoot(e,t){t?delete this.rootById[e.uid]:this.rootById[e.uid]=e}}class ie{constructor(){this._callbacks=[]}dispose(){this._callbacks=[],delete this._val}subscribe(e){const t=this._callbacks;t.indexOf(e)<0&&t.push(e)}subscribeFirst(e){const t=this._callbacks,o=t.indexOf(e);o>=0&&t.splice(o,1),t.unshift(e)}unsubscribe(e){const t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)}setVal(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))}getVal(){return this._val}trigger(e,t){this._callCallbacks(e,t)}_callCallbacks(e,t){this._callbacks.forEach((o=>o(e,t)))}}class ne{constructor(e){this._tabster=e}dispose(){}getProps(e){const t=l(this._tabster,e);return t&&t.focusable||{}}isFocusable(e,t,o,i){return!(!H(e,r)||!t&&-1===e.tabIndex)&&(o||this.isVisible(e))&&(i||this.isAccessible(e))}isVisible(e){if(!e.ownerDocument||e.nodeType!==Node.ELEMENT_NODE)return!1;if(function(e){var t,o;const i=e.ownerDocument,n=null===(t=i.defaultView)||void 0===t?void 0:t.getComputedStyle(e);if(null===e.offsetParent&&i.body!==e&&"fixed"!==(null==n?void 0:n.position))return!0;if("hidden"===(null==n?void 0:n.visibility))return!0;if("fixed"===(null==n?void 0:n.position)){if("none"===n.display)return!0;if(null===(null===(o=e.parentElement)||void 0===o?void 0:o.offsetParent)&&i.body!==e.parentElement)return!0}return!1}(e))return!1;const t=e.ownerDocument.body.getBoundingClientRect();return 0!==t.width||0!==t.height}isAccessible(e){var t;for(let o=e;o;o=x.getParentElement(o)){const e=l(this._tabster,o);if(this._isHidden(o))return!1;if(!(null===(t=null==e?void 0:e.focusable)||void 0===t?void 0:t.ignoreAriaDisabled)&&this._isDisabled(o))return!1}return!0}_isDisabled(e){return e.hasAttribute("disabled")}_isHidden(e){var t;const o=e.getAttribute("aria-hidden");return!(!o||"true"!==o.toLowerCase()||(null===(t=this._tabster.modalizer)||void 0===t?void 0:t.isAugmented(e)))}findFirst(e,t){return this.findElement({...e},t)}findLast(e,t){return this.findElement({isBackward:!0,...e},t)}findNext(e,t){return this.findElement({...e},t)}findPrev(e,t){return this.findElement({...e,isBackward:!0},t)}findDefault(e,t){return this.findElement({...e,acceptCondition:t=>this.isFocusable(t,e.includeProgrammaticallyFocusable)&&!!this.getProps(t).isDefault},t)||null}findAll(e){return this._findElements(!0,e)||[]}findElement(e,t){const o=this._findElements(!1,e,t);return o?o[0]:o}_findElements(e,t,o){var i,n,r;const{container:s,currentElement:a=null,includeProgrammaticallyFocusable:l,useActiveModalizer:c,ignoreAccessibility:u,modalizerId:d,isBackward:h,onElement:g}=t;o||(o={});const p=[];let{acceptCondition:f}=t;const m=!!f;if(!s)return null;f||(f=e=>this.isFocusable(e,l,!1,u));const v={container:s,modalizerUserId:void 0===d&&c?null===(i=this._tabster.modalizer)||void 0===i?void 0:i.activeId:d||(null===(r=null===(n=oe.getTabsterContext(this._tabster,s))||void 0===n?void 0:n.modalizer)||void 0===r?void 0:r.userId),from:a||s,isBackward:h,isFindAll:e,acceptCondition:f,hasCustomCondition:m,includeProgrammaticallyFocusable:l,ignoreAccessibility:u,cachedGrouppers:{},cachedRadioGroups:{}},b=P(s.ownerDocument,s,(e=>this._acceptElement(e,v)));if(!b)return null;const y=t=>{var i,n;const r=null!==(i=v.foundElement)&&void 0!==i?i:v.foundBackward;return r&&p.push(r),e?!(r&&(v.found=!1,delete v.foundElement,delete v.foundBackward,delete v.fromCtx,v.from=r,g&&!g(r))||!r&&!t):(r&&o&&(o.uncontrolled=null===(n=oe.getTabsterContext(this._tabster,r))||void 0===n?void 0:n.uncontrolled),!(!t||r))};if(a||(o.outOfDOMOrder=!0),a&&x.nodeContains(s,a))b.currentNode=a;else if(h){const e=J(s);if(!e)return null;if(this._acceptElement(e,v)===NodeFilter.FILTER_ACCEPT&&!y(!0))return v.skippedFocusable&&(o.outOfDOMOrder=!0),p;b.currentNode=e}do{h?b.previousNode():b.nextNode()}while(y());return v.skippedFocusable&&(o.outOfDOMOrder=!0),p.length?p:null}_acceptElement(e,t){var o,i,n;if(t.found)return NodeFilter.FILTER_ACCEPT;const r=t.foundBackward;if(r&&(e===r||!x.nodeContains(r,e)))return t.found=!0,t.foundElement=r,NodeFilter.FILTER_ACCEPT;const s=t.container;if(e===s)return NodeFilter.FILTER_SKIP;if(!x.nodeContains(s,e))return NodeFilter.FILTER_REJECT;if(Z(e))return NodeFilter.FILTER_REJECT;if(x.nodeContains(t.rejectElementsFrom,e))return NodeFilter.FILTER_REJECT;const a=t.currentCtx=oe.getTabsterContext(this._tabster,e);if(!a)return NodeFilter.FILTER_SKIP;if(q(e))return this.isFocusable(e,void 0,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_SKIP;if(!t.hasCustomCondition&&("IFRAME"===e.tagName||"WEBVIEW"===e.tagName))return(null===(o=a.modalizer)||void 0===o?void 0:o.userId)===(null===(i=this._tabster.modalizer)||void 0===i?void 0:i.activeId)?(t.found=!0,t.rejectElementsFrom=t.foundElement=e,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT;if(!t.ignoreAccessibility&&!this.isAccessible(e))return this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_REJECT;let l,c=t.fromCtx;c||(c=t.fromCtx=oe.getTabsterContext(this._tabster,t.from));const u=null==c?void 0:c.mover;let d=a.groupper,h=a.mover;if(l=null===(n=this._tabster.modalizer)||void 0===n?void 0:n.acceptElement(e,t),void 0!==l&&(t.skippedFocusable=!0),void 0===l&&(d||h||u)){const o=null==d?void 0:d.getElement(),i=null==u?void 0:u.getElement();let n=null==h?void 0:h.getElement();n&&x.nodeContains(i,n)&&x.nodeContains(s,i)&&(!o||!h||x.nodeContains(i,o))&&(h=u,n=i),!o||o!==s&&x.nodeContains(s,o)||(d=void 0),n&&!x.nodeContains(s,n)&&(h=void 0),d&&h&&(n&&o&&!x.nodeContains(o,n)?h=void 0:d=void 0),d&&(l=d.acceptElement(e,t)),h&&(l=h.acceptElement(e,t))}if(void 0===l&&(l=t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,l===NodeFilter.FILTER_SKIP&&this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0)),l===NodeFilter.FILTER_ACCEPT&&!t.found){if(!t.isFindAll&&Q(e)&&!e.checked){const o=e.name;let i=t.cachedRadioGroups[o];if(i||(i=function(e){if(!Q(e))return;const t=e.name;let o,i=Array.from(x.getElementsByName(e,t));return i=i.filter((e=>!!Q(e)&&(e.checked&&(o=e),!0))),{name:t,buttons:new Set(i),checked:o}}(e),i&&(t.cachedRadioGroups[o]=i)),(null==i?void 0:i.checked)&&i.checked!==e)return NodeFilter.FILTER_SKIP}t.isBackward?(t.foundBackward=e,l=NodeFilter.FILTER_SKIP):(t.found=!0,t.foundElement=e)}return l}}const re="Home",se="ArrowLeft",ae="ArrowUp",le="ArrowRight",ce="ArrowDown",ue={2:0,3:1,1:2};class de extends ie{constructor(e,t){super(),this._init=()=>{const e=this._win(),t=e.document;t.addEventListener(i.Oy,this._onFocusIn,!0),t.addEventListener(i.RY,this._onFocusOut,!0),e.addEventListener("keydown",this._onKeyDown,!0);const o=x.getActiveElement(t);o&&o!==t.body&&this._setFocusedElement(o),this.subscribe(this._onChanged)},this._onFocusIn=e=>{const t=e.composedPath()[0];t&&this._setFocusedElement(t,e.detail.relatedTarget,e.detail.isFocusedProgrammatically)},this._onFocusOut=e=>{var t;this._setFocusedElement(void 0,null===(t=e.detail)||void 0===t?void 0:t.originalEvent.relatedTarget)},this._validateFocusedElement=e=>{},this._onKeyDown=e=>{if("Tab"!==e.key||e.ctrlKey)return;const t=this.getVal();if(!t||!t.ownerDocument||"true"===t.contentEditable)return;const o=this._tabster,n=o.controlTab,r=oe.getTabsterContext(o,t);if(!r||r.ignoreKeydown(e))return;const s=e.shiftKey,a=de.findNextTabbable(o,r,void 0,t,void 0,s,!0),c=r.root.getElement();if(!c)return;const u=null==a?void 0:a.element,d=function(e,t){var o;const i=e.getParent;let n=t;do{const t=null===(o=l(e,n))||void 0===o?void 0:o.uncontrolled;if(t&&e.uncontrolled.isUncontrolledCompletely(n,!!t.completely))return n;n=i(n)}while(n)}(o,t);if(u){const l=a.uncontrolled;if(r.uncontrolled||x.nodeContains(l,t)){if(!a.outOfDOMOrder&&l===r.uncontrolled||d&&!x.nodeContains(d,u))return;return void V.addPhantomDummyWithTarget(o,t,s,u)}if(l||"IFRAME"===u.tagName)return void(c.dispatchEvent(new b({by:"root",owner:c,next:u,relatedEvent:e}))&&V.moveWithPhantomDummy(this._tabster,null!=l?l:u,!1,s,e));(n||(null==a?void 0:a.outOfDOMOrder))&&c.dispatchEvent(new b({by:"root",owner:c,next:u,relatedEvent:e}))&&(e.preventDefault(),e.stopImmediatePropagation(),(0,i.kG)(u))}else!d&&c.dispatchEvent(new b({by:"root",owner:c,next:null,relatedEvent:e}))&&r.root.moveOutWithDefaultAction(s,e)},this._onChanged=(e,t)=>{var o,i;if(e)e.dispatchEvent(new m(t));else{const e=null===(o=this._lastVal)||void 0===o?void 0:o.get();if(e){const o={...t},n=oe.getTabsterContext(this._tabster,e),r=null===(i=null==n?void 0:n.modalizer)||void 0===i?void 0:i.userId;r&&(o.modalizerId=r),e.dispatchEvent(new v(o))}}},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){super.dispose();const e=this._win(),t=e.document;t.removeEventListener(i.Oy,this._onFocusIn,!0),t.removeEventListener(i.RY,this._onFocusOut,!0),e.removeEventListener("keydown",this._onKeyDown,!0),this.unsubscribe(this._onChanged);const o=this._asyncFocus;o&&(e.clearTimeout(o.timeout),delete this._asyncFocus),delete de._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(e,t){var o,i;let n=de._lastResetElement,r=n&&n.get();r&&x.nodeContains(t,r)&&delete de._lastResetElement,r=null===(i=null===(o=e._nextVal)||void 0===o?void 0:o.element)||void 0===i?void 0:i.get(),r&&x.nodeContains(t,r)&&delete e._nextVal,n=e._lastVal,r=n&&n.get(),r&&x.nodeContains(t,r)&&delete e._lastVal}getFocusedElement(){return this.getVal()}getLastFocusedElement(){var e;let t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return(!t||t&&!z(t.ownerDocument,t))&&(this._lastVal=t=void 0),t}focus(e,t,o,i){return!!this._tabster.focusable.isFocusable(e,t,!1,o)&&(e.focus({preventScroll:i}),!0)}focusDefault(e){const t=this._tabster.focusable.findDefault({container:e});return!!t&&(this._tabster.focusedElement.focus(t),!0)}getFirstOrLastTabbable(e,t){var o;const{container:i,ignoreAccessibility:n}=t;let r;if(i){const t=oe.getTabsterContext(this._tabster,i);t&&(r=null===(o=de.findNextTabbable(this._tabster,t,i,void 0,void 0,!e,n))||void 0===o?void 0:o.element)}return r&&!x.nodeContains(i,r)&&(r=void 0),r||void 0}_focusFirstOrLast(e,t){const o=this.getFirstOrLastTabbable(e,t);return!!o&&(this.focus(o,!1,!0),!0)}focusFirst(e){return this._focusFirstOrLast(!0,e)}focusLast(e){return this._focusFirstOrLast(!1,e)}resetFocus(e){if(!this._tabster.focusable.isVisible(e))return!1;if(this._tabster.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{const t=e.getAttribute("tabindex"),o=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),de._lastResetElement=new R(this._win,e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",t),this._setOrRemoveAttribute(e,"aria-hidden",o)}return!0}requestAsyncFocus(e,t,o){const i=this._tabster.getWindow(),n=this._asyncFocus;if(n){if(ue[e]>ue[n.source])return;i.clearTimeout(n.timeout)}this._asyncFocus={source:e,callback:t,timeout:i.setTimeout((()=>{this._asyncFocus=void 0,t()}),o)}}cancelAsyncFocus(e){const t=this._asyncFocus;(null==t?void 0:t.source)===e&&(this._tabster.getWindow().clearTimeout(t.timeout),this._asyncFocus=void 0)}_setOrRemoveAttribute(e,t,o){null===o?e.removeAttribute(t):e.setAttribute(t,o)}_setFocusedElement(e,t,o){var i,n;if(this._tabster._noop)return;const r={relatedTarget:t};if(e){const t=null===(i=de._lastResetElement)||void 0===i?void 0:i.get();if(de._lastResetElement=void 0,t===e||q(e))return;r.isFocusedProgrammatically=o;const s=oe.getTabsterContext(this._tabster,e),a=null===(n=null==s?void 0:s.modalizer)||void 0===n?void 0:n.userId;a&&(r.modalizerId=a)}const s=this._nextVal={element:e?new R(this._win,e):void 0,detail:r};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===s&&this.setVal(e,r),this._nextVal=void 0}setVal(e,t){super.setVal(e,t),e&&(this._lastVal=new R(this._win,e))}static findNextTabbable(e,t,o,i,n,r,s){const a=o||t.root.getElement();if(!a)return null;let l=null;const c=de._isTabbingTimer,u=e.getWindow();c&&u.clearTimeout(c),de.isTabbing=!0,de._isTabbingTimer=u.setTimeout((()=>{delete de._isTabbingTimer,de.isTabbing=!1}),0);const d=t.modalizer,h=t.groupper,g=t.mover,p=t=>{if(l=t.findNextTabbable(i,n,r,s),i&&!(null==l?void 0:l.element)){const n=t!==d&&x.getParentElement(t.getElement());if(n){const a=oe.getTabsterContext(e,i,{referenceElement:n});if(a){const i=t.getElement(),c=r?i:i&&J(i)||i;c&&(l=de.findNextTabbable(e,a,o,c,n,r,s),l&&(l.outOfDOMOrder=!0))}}}};if(h&&g)p(t.groupperBeforeMover?h:g);else if(h)p(h);else if(g)p(g);else if(d)p(d);else{const t={container:a,currentElement:i,referenceElement:n,ignoreAccessibility:s,useActiveModalizer:!0},o={},c=e.focusable[r?"findPrev":"findNext"](t,o);l={element:c,outOfDOMOrder:o.outOfDOMOrder,uncontrolled:o.uncontrolled}}return l}}de.isTabbing=!1;class he extends ie{constructor(e){super(),this._onChange=e=>{this.setVal(e,void 0)},this._keyborg=(0,i.SQ)(e()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,i.bd)(this._keyborg),delete this._keyborg)}setNavigatingWithKeyboard(e){var t;null===(t=this._keyborg)||void 0===t||t.setVal(e)}isNavigatingWithKeyboard(){var e;return!!(null===(e=this._keyborg)||void 0===e?void 0:e.isNavigatingWithKeyboard())}}let ge=0;const pe="aria-hidden";class fe extends V{constructor(e,t,o){super(t,e,2,o),this._setHandlers(((o,n)=>{var r,s;const a=e.get(),l=a&&(null===(r=oe.getRoot(t,a))||void 0===r?void 0:r.getElement()),c=o.input;let u;if(l&&c){const e=Z(c),o=oe.getTabsterContext(t,e||c);o&&(u=null===(s=de.findNextTabbable(t,o,l,c,void 0,n,!0))||void 0===s?void 0:s.element),u&&(0,i.kG)(u)}}))}}class me extends U{constructor(e,t,o,i,n,r){super(e,t,i),this._wasFocused=0,this.userId=i.id,this._onDispose=o,this._activeElements=r,e.controlTab||(this.dummyManager=new fe(this._element,e,n))}makeActive(e){if(this._isActive!==e){this._isActive=e;const t=this.getElement();if(t){const o=this._activeElements,i=o.map((e=>e.get())).indexOf(t);e?i<0&&o.push(new R(this._tabster.getWindow,t)):i>=0&&o.splice(i,1)}this._dispatchEvent(e)}}focused(e){return e||(this._wasFocused=++ge),this._wasFocused}setProps(e){e.id&&(this.userId=e.id),this._props={...e}}dispose(){var e;this.makeActive(!1),this._onDispose(this),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,this._activeElements=[],this._remove()}isActive(){return!!this._isActive}contains(e){return x.nodeContains(this.getElement(),e)}findNextTabbable(e,t,o,i){var n,r;if(!this.getElement())return null;const s=this._tabster;let a,l=null,c=!1;const u=e&&(null===(n=oe.getRoot(s,e))||void 0===n?void 0:n.getElement());if(u){const n={container:u,currentElement:e,referenceElement:t,ignoreAccessibility:i,useActiveModalizer:!0},d={};l=s.focusable[o?"findPrev":"findNext"](n,d),!l&&this._props.isTrapped&&(null===(r=s.modalizer)||void 0===r?void 0:r.activeId)?(l=s.focusable[o?"findLast":"findFirst"]({container:u,ignoreAccessibility:i,useActiveModalizer:!0},d),null===l&&(l=e),c=!0):c=!!d.outOfDOMOrder,a=d.uncontrolled}return{element:l,uncontrolled:a,outOfDOMOrder:c}}_dispatchEvent(e,t){const o=this.getElement();let i=!1;if(o){const n=t?this._activeElements.map((e=>e.get())):[o];for(const t of n)if(t){const n={id:this.userId,element:o},r=e?new w(n):new C(n);t.dispatchEvent(r),r.defaultPrevented&&(i=!0)}}return i}_remove(){}}class ve{constructor(e,t,o){this._onModalizerDispose=e=>{const t=e.id,o=e.userId,i=this._parts[o];if(delete this._modalizers[t],i&&(delete i[t],0===Object.keys(i).length)){delete this._parts[o];const e=this._activationHistory,t=[];let i;for(let n=e.length;n--;){const r=e[n];r!==o&&r!==i&&(i=r,(r||t.length>0)&&t.unshift(r))}if(this._activationHistory=t,this.activeId===o){const e=t[0],o=e?Object.values(this._parts[e])[0]:void 0;this.setActive(o)}}},this._onKeyDown=e=>{var t;if("Escape"!==e.key)return;const o=this._tabster,i=o.focusedElement.getFocusedElement();if(i){const n=oe.getTabsterContext(o,i),r=null==n?void 0:n.modalizer;if(n&&!n.groupper&&(null==r?void 0:r.isActive())&&!n.ignoreKeydown(e)){const i=r.userId;if(i){const n=this._parts[i];if(n){const i=Object.keys(n).map((e=>{var t;const i=n[e],r=i.getElement();let s;return r&&(s=null===(t=l(o,r))||void 0===t?void 0:t.groupper),i&&r&&s?{el:r,focusedSince:i.focused(!0)}:{focusedSince:0}})).filter((e=>e.focusedSince>0)).sort(((e,t)=>e.focusedSince>t.focusedSince?-1:e.focusedSince<t.focusedSince?1:0));if(i.length){const n=i[0].el;n&&(null===(t=o.groupper)||void 0===t||t.handleKeyPress(n,e,!0))}}}}}},this._onFocus=(e,t)=>{var o;const i=this._tabster,n=e&&oe.getTabsterContext(i,e);if(!n||!e)return;const r=this._augMap;for(let t=e;t;t=i.getParent(t))r.has(t)&&(r.delete(t),Y(i,t,pe));let s=n.modalizer;const a=l(i,e),c=null==a?void 0:a.modalizer;if(c&&(c.focused(),c.userId===this.activeId&&a.groupper)){const t=i.getParent(e),n=t&&(null===(o=oe.getTabsterContext(i,t))||void 0===o?void 0:o.modalizer);if(!n)return void this.setActive(void 0);s=n}if(null==s||s.focused(),(null==s?void 0:s.userId)!==this.activeId)if(t.isFocusedProgrammatically||this.currentIsOthersAccessible||(null==s?void 0:s.getProps().isAlwaysAccessible))this.setActive(s);else{const t=this._win();t.clearTimeout(this._restoreModalizerFocusTimer),this._restoreModalizerFocusTimer=t.setTimeout((()=>this._restoreModalizerFocus(e)),100)}else this.currentIsOthersAccessible=null==s?void 0:s.getProps().isOthersAccessible},this._tabster=e,this._win=e.getWindow,this._modalizers={},this._parts={},this._augMap=new WeakMap,this._aug=[],this._alwaysAccessibleSelector=t,this._accessibleCheck=o,this._activationHistory=[],this.activeElements=[],e.controlTab||e.root.addDummyInputs(),this._win().addEventListener("keydown",this._onKeyDown,!0),e.queueInit((()=>{this._tabster.focusedElement.subscribe(this._onFocus)}))}dispose(){const e=this._win();e.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._modalizers).forEach((e=>{this._modalizers[e]&&(this._modalizers[e].dispose(),delete this._modalizers[e])})),e.clearTimeout(this._restoreModalizerFocusTimer),e.clearTimeout(this._hiddenUpdateTimer),this._parts={},delete this.activeId,this.activeElements=[],this._augMap=new WeakMap,this._aug=[],this._tabster.focusedElement.unsubscribe(this._onFocus)}createModalizer(e,t,o){var i;const n=new me(this._tabster,e,this._onModalizerDispose,t,o,this.activeElements),r=n.id,s=t.id;this._modalizers[r]=n;let a=this._parts[s];a||(a=this._parts[s]={}),a[r]=n;const l=null!==(i=this._tabster.focusedElement.getFocusedElement())&&void 0!==i?i:null;return e!==l&&x.nodeContains(e,l)&&(s!==this.activeId?this.setActive(n):n.makeActive(!0)),n}isAugmented(e){return this._augMap.has(e)}hiddenUpdate(){this._hiddenUpdateTimer||(this._hiddenUpdateTimer=this._win().setTimeout((()=>{delete this._hiddenUpdateTimer,this._hiddenUpdate()}),250))}setActive(e){const t=null==e?void 0:e.userId,o=this.activeId;if(o===t)return;if(this.activeId=t,o){const e=this._parts[o];if(e)for(const t of Object.keys(e))e[t].makeActive(!1)}if(t){const e=this._parts[t];if(e)for(const t of Object.keys(e))e[t].makeActive(!0)}this.currentIsOthersAccessible=null==e?void 0:e.getProps().isOthersAccessible,this.hiddenUpdate();const i=this._activationHistory;i[0]!==t&&(void 0!==t||i.length>0)&&i.unshift(t)}focus(e,t,o){const i=this._tabster,n=oe.getTabsterContext(i,e),r=null==n?void 0:n.modalizer;if(r){this.setActive(r);const e=r.getProps(),n=r.getElement();if(n){if(void 0===t&&(t=e.isNoFocusFirst),!t&&i.keyboardNavigation.isNavigatingWithKeyboard()&&i.focusedElement.focusFirst({container:n}))return!0;if(void 0===o&&(o=e.isNoFocusDefault),!o&&i.focusedElement.focusDefault(n))return!0;i.focusedElement.resetFocus(n)}}return!1}activate(e){var t;const o=e?null===(t=oe.getTabsterContext(this._tabster,e))||void 0===t?void 0:t.modalizer:void 0;return!(e&&!o||(this.setActive(o),0))}acceptElement(e,t){var o;const i=t.modalizerUserId,n=null===(o=t.currentCtx)||void 0===o?void 0:o.modalizer;if(i)for(const t of this.activeElements){const o=t.get();if(o&&(x.nodeContains(e,o)||o===e))return NodeFilter.FILTER_SKIP}const r=i===(null==n?void 0:n.userId)||!i&&(null==n?void 0:n.getProps().isAlwaysAccessible)?void 0:NodeFilter.FILTER_SKIP;return void 0!==r&&(t.skippedFocusable=!0),r}_hiddenUpdate(){var e;const t=this._tabster,o=t.getWindow().document.body,i=this.activeId,n=this._parts,r=[],s=[],a=this._alwaysAccessibleSelector,l=a?Array.from(x.querySelectorAll(o,a)):[],c=[];for(const e of Object.keys(n)){const t=n[e];for(const o of Object.keys(t)){const n=t[o],a=n.getElement(),u=n.getProps().isAlwaysAccessible;a&&(e===i?(c.push(a),this.currentIsOthersAccessible||r.push(a)):u?l.push(a):s.push(a))}}const u=this._augMap,d=r.length>0?[...r,...l]:void 0,h=[],g=new WeakMap,p=(e,o)=>{var i;const n=e.tagName;if("SCRIPT"===n||"STYLE"===n)return;let r=!1;u.has(e)?o?r=!0:(u.delete(e),Y(t,e,pe)):o&&!(null===(i=this._accessibleCheck)||void 0===i?void 0:i.call(this,e,c))&&Y(t,e,pe,"true")&&(u.set(e,!0),r=!0),r&&(h.push(new R(t.getWindow,e)),g.set(e,!0))},f=e=>{var o;for(let i=x.getFirstElementChild(e);i;i=x.getNextElementSibling(i)){let e=!1,n=!1,r=!1;if(d){const s=t.getParent(i);for(const t of d){if(i===t){e=!0;break}if(x.nodeContains(i,t)){n=!0;break}x.nodeContains(t,s)&&(r=!0)}n||(null===(o=i.__tabsterElementFlags)||void 0===o?void 0:o.noDirectAriaHidden)?f(i):e||r||p(i,!0)}else p(i,!1)}};d||l.forEach((e=>p(e,!1))),s.forEach((e=>p(e,!0))),o&&f(o),null===(e=this._aug)||void 0===e||e.map((e=>e.get())).forEach((e=>{e&&!g.get(e)&&p(e,!1)})),this._aug=h,this._augMap=g}_restoreModalizerFocus(e){var t;const o=null==e?void 0:e.ownerDocument;if(!e||!o)return;const i=this._tabster.focusedElement.getFocusedElement(),n=i&&(null===(t=oe.getTabsterContext(this._tabster,i))||void 0===t?void 0:t.modalizer);if(!i||i&&(null==n?void 0:n.userId)===this.activeId)return;const r=this._tabster,s=oe.getTabsterContext(r,e),a=null==s?void 0:s.modalizer,l=this.activeId;if(!a&&!l||a&&l===a.userId)return;const c=null==s?void 0:s.root.getElement();if(c){let t=r.focusable.findFirst({container:c,useActiveModalizer:!0});if(t){if(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_PRECEDING&&(t=r.focusable.findLast({container:c,useActiveModalizer:!0}),!t))throw new Error("Something went wrong.");return void r.focusedElement.focus(t)}}e.blur()}}const be=3023==o.j?["input","textarea","*[contenteditable]"].join(", "):null;class ye extends V{constructor(e,t,o,n){super(t,e,3,n),this._onFocusDummyInput=e=>{var t,o;const n=this._element.get(),r=e.input;if(n&&r){const s=oe.getTabsterContext(this._tabster,n);let a;s&&(a=null===(t=de.findNextTabbable(this._tabster,s,void 0,r,void 0,!e.isFirst,!0))||void 0===t?void 0:t.element);const l=null===(o=this._getMemorized())||void 0===o?void 0:o.get();l&&this._tabster.focusable.isFocusable(l)&&(a=l),a&&(0,i.kG)(a)}},this._tabster=t,this._getMemorized=o,this._setHandlers(this._onFocusDummyInput)}}class we extends U{constructor(e,t,o,i,n){var r;super(e,t,i),this._visible={},this._onIntersection=e=>{for(const t of e){const e=t.target,o=j(this._win,e);let i,n=this._fullyVisible;if(t.intersectionRatio>=.25?(i=t.intersectionRatio>=.75?2:1,2===i&&(n=o)):i=0,this._visible[o]!==i){void 0===i?(delete this._visible[o],n===o&&delete this._fullyVisible):(this._visible[o]=i,this._fullyVisible=n);const t=this.getState(e);t&&e.dispatchEvent(new y(t))}}},this._win=e.getWindow,this.visibilityTolerance=null!==(r=i.visibilityTolerance)&&void 0!==r?r:.8,(this._props.trackState||this._props.visibilityAware)&&(this._intersectionObserver=new IntersectionObserver(this._onIntersection,{threshold:[0,.25,.5,.75,1]}),this._observeState()),this._onDispose=o;e.controlTab||(this.dummyManager=new ye(this._element,e,(()=>i.memorizeCurrent?this._current:void 0),n))}dispose(){var e;this._onDispose(this),this._intersectionObserver&&(this._intersectionObserver.disconnect(),delete this._intersectionObserver),delete this._current,delete this._fullyVisible,delete this._allElements,delete this._updateQueue,this._unobserve&&(this._unobserve(),delete this._unobserve);const t=this._win();this._setCurrentTimer&&(t.clearTimeout(this._setCurrentTimer),delete this._setCurrentTimer),this._updateTimer&&(t.clearTimeout(this._updateTimer),delete this._updateTimer),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager}setCurrent(e){this._current=e?new R(this._win,e):void 0,!this._props.trackState&&!this._props.visibilityAware||this._setCurrentTimer||(this._setCurrentTimer=this._win().setTimeout((()=>{var e;delete this._setCurrentTimer;const t=[];this._current!==this._prevCurrent&&(t.push(this._current),t.push(this._prevCurrent),this._prevCurrent=this._current);for(const o of t){const t=null==o?void 0:o.get();if(t&&(null===(e=this._allElements)||void 0===e?void 0:e.get(t))===this){const e=this._props;if(t&&(void 0!==e.visibilityAware||e.trackState)){const e=this.getState(t);e&&t.dispatchEvent(new y(e))}}}})))}getCurrent(){var e;return(null===(e=this._current)||void 0===e?void 0:e.get())||null}findNextTabbable(e,t,o,i){const n=this.getElement(),r=n&&Z(e)===n;if(!n)return null;let s,a=null,l=!1;if(this._props.tabbable||r||e&&!x.nodeContains(n,e)){const r={currentElement:e,referenceElement:t,container:n,ignoreAccessibility:i,useActiveModalizer:!0},c={};a=this._tabster.focusable[o?"findPrev":"findNext"](r,c),l=!!c.outOfDOMOrder,s=c.uncontrolled}return{element:a,uncontrolled:s,outOfDOMOrder:l}}acceptElement(e,t){var o,i;if(!de.isTabbing)return(null===(o=t.currentCtx)||void 0===o?void 0:o.excludedFromMover)?NodeFilter.FILTER_REJECT:void 0;const{memorizeCurrent:n,visibilityAware:r,hasDefault:s=!0}=this._props,a=this.getElement();if(a&&(n||r||s)&&(!x.nodeContains(a,t.from)||Z(t.from)===a)){let e;if(n){const o=null===(i=this._current)||void 0===i?void 0:i.get();o&&t.acceptCondition(o)&&(e=o)}if(!e&&s&&(e=this._tabster.focusable.findDefault({container:a,useActiveModalizer:!0})),!e&&r&&(e=this._tabster.focusable.findElement({container:a,useActiveModalizer:!0,isBackward:t.isBackward,acceptCondition:e=>{var o;const i=j(this._win,e),n=this._visible[i];return a!==e&&!!(null===(o=this._allElements)||void 0===o?void 0:o.get(e))&&t.acceptCondition(e)&&(2===n||1===n&&(1===r||!this._fullyVisible))}})),e)return t.found=!0,t.foundElement=e,t.rejectElementsFrom=a,t.skippedFocusable=!0,NodeFilter.FILTER_ACCEPT}}_observeState(){const e=this.getElement();if(this._unobserve||!e||"undefined"==typeof MutationObserver)return;const t=this._win(),o=this._allElements=new WeakMap,i=this._tabster.focusable;let n=this._updateQueue=[];const r=x.createMutationObserver((e=>{for(const t of e){const e=t.target,o=t.removedNodes,i=t.addedNodes;if("attributes"===t.type)"tabindex"===t.attributeName&&n.push({element:e,type:2});else{for(let e=0;e<o.length;e++)n.push({element:o[e],type:3});for(let e=0;e<i.length;e++)n.push({element:i[e],type:1})}}d()})),s=(e,t)=>{var i,n;const r=o.get(e);r&&t&&(null===(i=this._intersectionObserver)||void 0===i||i.unobserve(e),o.delete(e)),r||t||(o.set(e,this),null===(n=this._intersectionObserver)||void 0===n||n.observe(e))},a=e=>{const t=i.isFocusable(e);o.get(e)?t||s(e,!0):t&&s(e)},c=e=>{const{mover:o}=h(e);if(o&&o!==this){if(o.getElement()!==e||!i.isFocusable(e))return;s(e)}const n=P(t.document,e,(e=>{const{mover:t,groupper:o}=h(e);if(t&&t!==this)return NodeFilter.FILTER_REJECT;const n=null==o?void 0:o.getFirst(!0);return o&&o.getElement()!==e&&n&&n!==e?NodeFilter.FILTER_REJECT:(i.isFocusable(e)&&s(e),NodeFilter.FILTER_SKIP)}));if(n)for(n.currentNode=e;n.nextNode(););},u=e=>{o.get(e)&&s(e,!0);for(let t=x.getFirstElementChild(e);t;t=x.getNextElementSibling(t))u(t)},d=()=>{!this._updateTimer&&n.length&&(this._updateTimer=t.setTimeout((()=>{delete this._updateTimer;for(const{element:e,type:t}of n)switch(t){case 2:a(e);break;case 1:c(e);break;case 3:u(e)}n=this._updateQueue=[]}),0))},h=e=>{const t={};for(let o=e;o;o=x.getParentElement(o)){const e=l(this._tabster,o);if(e&&(e.groupper&&!t.groupper&&(t.groupper=e.groupper),e.mover)){t.mover=e.mover;break}}return t};n.push({element:e,type:1}),d(),r.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=()=>{r.disconnect()}}getState(e){const t=j(this._win,e);if(t in this._visible){const o=this._visible[t]||0;return{isCurrent:this._current?this._current.get()===e:void 0,visibility:o}}}}class Ce{constructor(e,t){this._init=()=>{const e=this._win();e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(d,this._onMoveFocus),e.addEventListener(h,this._onMemorizedElement),this._tabster.focusedElement.subscribe(this._onFocus)},this._onMoverDispose=e=>{delete this._movers[e.id]},this._onFocus=e=>{var t;let o=e,i=e;for(let n=x.getParentElement(e);n;n=x.getParentElement(n)){const e=null===(t=l(this._tabster,n))||void 0===t?void 0:t.mover;e&&(e.setCurrent(i),o=void 0),!o&&this._tabster.focusable.isFocusable(n)&&(o=i=n)}},this._onKeyDown=async e=>{var t;if(this._ignoredInputTimer&&(this._win().clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1),e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const o=e.key;let i;if(o===ce?i=2:o===le?i=4:o===ae?i=1:o===se?i=3:"PageDown"===o?i=6:"PageUp"===o?i=5:o===re?i=7:"End"===o&&(i=8),!i)return;const n=this._tabster.focusedElement.getFocusedElement();n&&!await this._isIgnoredInput(n,o)&&this._moveFocus(n,i,e)},this._onMoveFocus=e=>{var t;const o=e.composedPath()[0],i=null===(t=e.detail)||void 0===t?void 0:t.key;o&&void 0!==i&&!e.defaultPrevented&&(this._moveFocus(o,i),e.stopImmediatePropagation())},this._onMemorizedElement=e=>{var t;const o=e.composedPath()[0];let i=null===(t=e.detail)||void 0===t?void 0:t.memorizedElement;if(o){const t=oe.getTabsterContext(this._tabster,o),n=null==t?void 0:t.mover;n&&(i&&!x.nodeContains(n.getElement(),i)&&(i=void 0),n.setCurrent(i),e.stopImmediatePropagation())}},this._tabster=e,this._win=t,this._movers={},e.queueInit(this._init)}dispose(){var e;const t=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),null===(e=this._ignoredInputResolve)||void 0===e||e.call(this,!1),this._ignoredInputTimer&&(t.clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),t.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener(d,this._onMoveFocus),t.removeEventListener(h,this._onMemorizedElement),Object.keys(this._movers).forEach((e=>{this._movers[e]&&(this._movers[e].dispose(),delete this._movers[e])}))}createMover(e,t,o){const i=new we(this._tabster,e,this._onMoverDispose,t,o);return this._movers[i.id]=i,i}moveFocus(e,t){return this._moveFocus(e,t)}_moveFocus(e,t,o){var n,r;const s=this._tabster,c=oe.getTabsterContext(s,e,{checkRtl:!0});if(!c||!c.mover||c.excludedFromMover||o&&c.ignoreKeydown(o))return null;const u=c.mover,d=u.getElement();if(c.groupperBeforeMover){const e=c.groupper;if(!e||e.isActive(!0))return null;for(let t=x.getParentElement(e.getElement());t&&t!==d;t=x.getParentElement(t))if(null===(r=null===(n=l(s,t))||void 0===n?void 0:n.groupper)||void 0===r?void 0:r.isActive(!0))return null}if(!d)return null;const h=s.focusable,g=u.getProps(),p=g.direction||a.Both,f=p===a.Both,m=f||p===a.Vertical,v=f||p===a.Horizontal,y=p===a.GridLinear,w=y||p===a.Grid,C=g.cyclic;let S,k,T,_=0,I=0;if(w&&(T=e.getBoundingClientRect(),_=Math.ceil(T.left),I=Math.floor(T.right)),c.rtl&&(4===t?t=3:3===t&&(t=4)),2===t&&m||4===t&&(v||w))if(S=h.findNext({currentElement:e,container:d,useActiveModalizer:!0}),S&&w){const e=Math.ceil(S.getBoundingClientRect().left);!y&&I>e&&(S=void 0)}else!S&&C&&(S=h.findFirst({container:d,useActiveModalizer:!0}));else if(1===t&&m||3===t&&(v||w))if(S=h.findPrev({currentElement:e,container:d,useActiveModalizer:!0}),S&&w){const e=Math.floor(S.getBoundingClientRect().right);!y&&e>_&&(S=void 0)}else!S&&C&&(S=h.findLast({container:d,useActiveModalizer:!0}));else if(7===t)w?h.findElement({container:d,currentElement:e,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{var o;if(!h.isFocusable(t))return!1;const i=Math.ceil(null!==(o=t.getBoundingClientRect().left)&&void 0!==o?o:0);return t!==e&&_<=i||(S=t,!1)}}):S=h.findFirst({container:d,useActiveModalizer:!0});else if(8===t)w?h.findElement({container:d,currentElement:e,useActiveModalizer:!0,acceptCondition:t=>{var o;if(!h.isFocusable(t))return!1;const i=Math.ceil(null!==(o=t.getBoundingClientRect().left)&&void 0!==o?o:0);return t!==e&&_>=i||(S=t,!1)}}):S=h.findLast({container:d,useActiveModalizer:!0});else if(5===t){if(h.findElement({currentElement:e,container:d,useActiveModalizer:!0,isBackward:!0,acceptCondition:e=>!(!h.isFocusable(e)||O(this._win,e,u.visibilityTolerance)&&(S=e,1))}),w&&S){const e=Math.ceil(S.getBoundingClientRect().left);h.findElement({currentElement:S,container:d,useActiveModalizer:!0,acceptCondition:t=>{if(!h.isFocusable(t))return!1;const o=Math.ceil(t.getBoundingClientRect().left);return _<o||e>=o||(S=t,!1)}})}k=!1}else if(6===t){if(h.findElement({currentElement:e,container:d,useActiveModalizer:!0,acceptCondition:e=>!(!h.isFocusable(e)||O(this._win,e,u.visibilityTolerance)&&(S=e,1))}),w&&S){const e=Math.ceil(S.getBoundingClientRect().left);h.findElement({currentElement:S,container:d,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{if(!h.isFocusable(t))return!1;const o=Math.ceil(t.getBoundingClientRect().left);return _>o||e<=o||(S=t,!1)}})}k=!0}else if(w){const o=1===t,i=_,n=Math.ceil(T.top),r=I,s=Math.floor(T.bottom);let a,l,c=0;h.findAll({container:d,currentElement:e,isBackward:o,onElement:e=>{const t=e.getBoundingClientRect(),u=Math.ceil(t.left),d=Math.ceil(t.top),h=Math.floor(t.right),g=Math.floor(t.bottom);if(o&&n<g||!o&&s>d)return!0;const p=Math.ceil(Math.min(r,h))-Math.floor(Math.max(i,u)),f=Math.ceil(Math.min(r-i,h-u));if(p>0&&f>=p){const t=p/f;t>c&&(a=e,c=t)}else if(0===c){const t=function(e,t,o,i,n,r,s,a){const l=o<n?n-o:s<e?e-s:0,c=i<r?r-i:a<t?t-a:0;return 0===l?c:0===c?l:Math.sqrt(l*l+c*c)}(i,n,r,s,u,d,h,g);(void 0===l||t<l)&&(l=t,a=e)}else if(c>0)return!1;return!0}}),S=a}return S&&(!o||o&&d.dispatchEvent(new b({by:"mover",owner:d,next:S,relatedEvent:o})))?(void 0!==k&&function(e,t,o){const i=N(t);if(i){const n=F(e,i),r=t.getBoundingClientRect();i.scrollTop+=o?r.top-n.top:r.bottom-n.bottom}}(this._win,S,k),o&&(o.preventDefault(),o.stopImmediatePropagation()),(0,i.kG)(S),S):null}async _isIgnoredInput(e,t){if("true"===e.getAttribute("aria-expanded")&&e.hasAttribute("aria-activedescendant"))return!0;if(H(e,be)){let o,i=0,n=0,r=0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){const o=e.type,s=e.value;if(r=(s||"").length,"email"===o||"number"===o){if(r){const o=x.getSelection(e);if(o){const e=o.toString().length,i=t===se||t===ae;if(o.modify("extend",i?"backward":"forward","character"),e!==o.toString().length)return o.modify("extend",i?"forward":"backward","character"),!0;r=0}}}else{const t=e.selectionStart;if(null===t)return"hidden"===o;i=t||0,n=e.selectionEnd||0}}else"true"===e.contentEditable&&(o=new(function(e){const t=B(e);if(t.basics.Promise)return t.basics.Promise;throw new Error("No Promise defined.")}(this._win))((t=>{this._ignoredInputResolve=e=>{delete this._ignoredInputResolve,t(e)};const o=this._win();this._ignoredInputTimer&&o.clearTimeout(this._ignoredInputTimer);const{anchorNode:s,focusNode:a,anchorOffset:l,focusOffset:c}=x.getSelection(e)||{};this._ignoredInputTimer=o.setTimeout((()=>{var t,o,u;delete this._ignoredInputTimer;const{anchorNode:d,focusNode:h,anchorOffset:g,focusOffset:p}=x.getSelection(e)||{};if(d===s&&h===a&&g===l&&p===c){if(i=g||0,n=p||0,r=(null===(o=e.textContent)||void 0===o?void 0:o.length)||0,d&&h&&x.nodeContains(e,d)&&x.nodeContains(e,h)&&d!==e){let t=!1;const o=e=>{if(e===d)t=!0;else if(e===h)return!0;const r=e.textContent;if(r&&!x.getFirstChild(e)){const e=r.length;t?h!==d&&(n+=e):(i+=e,n+=e)}let s=!1;for(let t=x.getFirstChild(e);t&&!s;t=t.nextSibling)s=o(t);return s};o(e)}null===(u=this._ignoredInputResolve)||void 0===u||u.call(this,!0)}else null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1)}),0)})));if(o&&!await o)return!0;if(i!==n)return!0;if(i>0&&(t===se||t===ae||t===re))return!0;if(i<r&&(t===le||t===ce||"End"===t))return!0}return!1}}class Se{constructor(e){this._isUncontrolledCompletely=e}isUncontrolledCompletely(e,t){var o;const i=null===(o=this._isUncontrolledCompletely)||void 0===o?void 0:o.call(this,e,t);return void 0===i?t:i}}class ke extends U{constructor(e,t,o){var i;if(super(e,t,o),this._hasFocus=!1,this._onFocusOut=e=>{var t;const o=null===(t=this._element)||void 0===t?void 0:t.get();o&&null===e.relatedTarget&&o.dispatchEvent(new S),o&&!x.nodeContains(o,e.relatedTarget)&&(this._hasFocus=!1)},this._onFocusIn=()=>{this._hasFocus=!0},this._props.type===s.Source){const e=null===(i=this._element)||void 0===i?void 0:i.get();null==e||e.addEventListener("focusout",this._onFocusOut),null==e||e.addEventListener("focusin",this._onFocusIn),this._hasFocus=x.nodeContains(e,e&&x.getActiveElement(e.ownerDocument))}}dispose(){var e;if(this._props.type===s.Source){const t=null===(e=this._element)||void 0===e?void 0:e.get();null==t||t.removeEventListener("focusout",this._onFocusOut),null==t||t.removeEventListener("focusin",this._onFocusIn),this._hasFocus&&this._tabster.getWindow().document.body.dispatchEvent(new S)}}}class Te{constructor(e){this._stack=[],this._getWindow=e}push(e){var t;(null===(t=this._stack[this._stack.length-1])||void 0===t?void 0:t.get())!==e&&(this._stack.length>Te.DEPTH&&this._stack.shift(),this._stack.push(new R(this._getWindow,e)))}pop(e){var t;void 0===e&&(e=()=>!0);const o=this._getWindow().document;for(let i=this._stack.length-1;i>=0;i--){const i=null===(t=this._stack.pop())||void 0===t?void 0:t.get();if(i&&x.nodeContains(o.body,x.getParentElement(i))&&e(i))return i}}}Te.DEPTH=10;class xe{constructor(e){this._onRestoreFocus=e=>{var t,o;this._focusedElementState.cancelAsyncFocus(2);const i=e.composedPath()[0];if(i){const e=null===(o=null===(t=l(this._tabster,i))||void 0===t?void 0:t.restorer)||void 0===o?void 0:o.getProps().id;this._focusedElementState.requestAsyncFocus(2,(()=>this._restoreFocus(i,e)),0)}},this._onFocusIn=e=>{var t;if(!e)return;const o=l(this._tabster,e);(null===(t=null==o?void 0:o.restorer)||void 0===t?void 0:t.getProps().type)===s.Target&&this._history.push(e)},this._restoreFocus=(e,t)=>{var o;const i=this._getWindow().document;if(x.getActiveElement(i)!==i.body)return;if(!this._keyboardNavState.isNavigatingWithKeyboard()&&x.nodeContains(i.body,e))return;const n=e=>{var t,o;return null===(o=null===(t=l(this._tabster,e))||void 0===t?void 0:t.restorer)||void 0===o?void 0:o.getProps().id};null===(o=this._history.pop((e=>t===n(e))))||void 0===o||o.focus()},this._tabster=e,this._getWindow=e.getWindow,this._getWindow().addEventListener(g,this._onRestoreFocus),this._history=new Te(this._getWindow),this._keyboardNavState=e.keyboardNavigation,this._focusedElementState=e.focusedElement,this._focusedElementState.subscribe(this._onFocusIn)}dispose(){const e=this._getWindow();this._focusedElementState.unsubscribe(this._onFocusIn),this._focusedElementState.cancelAsyncFocus(2),e.removeEventListener(g,this._onRestoreFocus)}createRestorer(e,t){const o=new ke(this._tabster,e,t);return t.type===s.Target&&x.getActiveElement(e.ownerDocument)===e&&this._history.push(e),o}}class _e{static _overrideAttachShadow(e){const t=e.Element.prototype.attachShadow;t.__origAttachShadow||(Element.prototype.attachShadow=function(e){const o=t.call(this,e);for(const e of _e._shadowObservers)e._addSubObserver(o);return o},Element.prototype.attachShadow.__origAttachShadow=t)}constructor(e){this._isObserving=!1,this._callbackWrapper=(e,t)=>{for(const t of e)if("childList"===t.type){const e=t.removedNodes,o=t.addedNodes;for(let t=0;t<e.length;t++)this._walkShadows(e[t],!0);for(let e=0;e<o.length;e++)this._walkShadows(o[e])}this._callback(e,t)},this._callback=e,this._observer=new MutationObserver(this._callbackWrapper),this._subObservers=new Map}_addSubObserver(e){if(this._options&&this._callback&&!this._subObservers.has(e)&&this._options.subtree&&function(e,t){var o,i;if(!e||!t)return!1;let n=t;for(;n;){if(n===e)return!0;n="function"!=typeof n.assignedElements&&(null===(o=n.assignedSlot)||void 0===o?void 0:o.parentNode)?null===(i=n.assignedSlot)||void 0===i?void 0:i.parentNode:n.nodeType===document.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode}return!1}(this._root,e)){const t=new MutationObserver(this._callbackWrapper);this._subObservers.set(e,t),this._isObserving&&t.observe(e,this._options),this._walkShadows(e)}}disconnect(){this._isObserving=!1,delete this._options,_e._shadowObservers.delete(this);for(const e of this._subObservers.values())e.disconnect();this._subObservers.clear(),this._observer.disconnect()}observe(e,t){const o=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument,i=null==o?void 0:o.defaultView;o&&i&&(_e._overrideAttachShadow(i),_e._shadowObservers.add(this),this._root=e,this._options=t,this._isObserving=!0,this._observer.observe(e,t),this._walkShadows(e))}_walkShadows(e,t){const o=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument;if(o){if(e===o)e=o.body;else{const t=e.shadowRoot;if(t)return void this._addSubObserver(t)}o.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{if(e.nodeType===Node.ELEMENT_NODE)if(t){const t=this._subObservers.get(e);t&&(t.disconnect(),this._subObservers.delete(e))}else{const t=e.shadowRoot;t&&this._addSubObserver(t)}return NodeFilter.FILTER_SKIP}}).nextNode()}}takeRecords(){const e=this._observer.takeRecords();for(const t of this._subObservers.values())e.push(...t.takeRecords());return e}}_e._shadowObservers=new Set;class Ie{constructor(e){this.keyboardNavigation=e.keyboardNavigation,this.focusedElement=e.focusedElement,this.focusable=e.focusable,this.root=e.root,this.uncontrolled=e.uncontrolled,this.core=e}}class Ee{constructor(e,t){var o,i;this._forgetMemorizedElements=[],this._wrappers=new Set,this._initQueue=[],this._version="8.5.1",this._noop=!1,this.getWindow=()=>{if(!this._win)throw new Error("Using disposed Tabster.");return this._win},this._storage=function(e){const t=e.__tabsterInstanceContext;return new((null==t?void 0:t.basics.WeakMap)||WeakMap)}(e),this._win=e;const r=this.getWindow;(null==t?void 0:t.DOMAPI)&&function(e){for(const t of Object.keys(e))x[t]=e[t]}({...t.DOMAPI}),this.keyboardNavigation=new he(r),this.focusedElement=new de(this,r),this.focusable=new ne(this),this.root=new oe(this,null==t?void 0:t.autoRoot),this.uncontrolled=new Se((null==t?void 0:t.checkUncontrolledCompletely)||(null==t?void 0:t.checkUncontrolledTrappingFocus)),this.controlTab=null===(o=null==t?void 0:t.controlTab)||void 0===o||o,this.rootDummyInputs=!!(null==t?void 0:t.rootDummyInputs),this._dummyObserver=new $(r),this.getParent=null!==(i=null==t?void 0:t.getParent)&&void 0!==i?i:x.getParentNode,this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:e=>{if(!this._unobserve){const t=r().document;this._unobserve=function(e,t,o,i){if("undefined"==typeof MutationObserver)return()=>{};const r=t.getWindow;let s;function a(t,o){s||(s=B(r).elementByUId),c(t,o);const i=P(e,t,(e=>c(e,o)));if(i)for(;i.nextNode(););}function c(e,i){var a;if(!e.getAttribute)return NodeFilter.FILTER_SKIP;const c=e.__tabsterElementUID;return c&&s&&(i?delete s[c]:null!==(a=s[c])&&void 0!==a||(s[c]=new R(r,e))),(l(t,e)||e.hasAttribute(n))&&o(t,e,i),NodeFilter.FILTER_SKIP}const u=x.createMutationObserver((e=>{var i,r,s,l,c;const u=new Set;for(const c of e){const e=c.target,d=c.removedNodes,h=c.addedNodes;if("attributes"===c.type)c.attributeName===n&&(u.has(e)||o(t,e));else{for(let o=0;o<d.length;o++){const n=d[o];u.add(n),a(n,!0),null===(r=(i=t._dummyObserver).domChanged)||void 0===r||r.call(i,e)}for(let o=0;o<h.length;o++)a(h[o]),null===(l=(s=t._dummyObserver).domChanged)||void 0===l||l.call(s,e)}}u.clear(),null===(c=t.modalizer)||void 0===c||c.hiddenUpdate()}));return i&&a(r().document.body),u.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[n]}),()=>{u.disconnect()}}(t,this,c,e)}}},D(r),this.queueInit((()=>{this.internal.resumeObserver(!0)}))}_mergeProps(e){var t;e&&(this.getParent=null!==(t=e.getParent)&&void 0!==t?t:this.getParent)}createTabster(e,t){const o=new Ie(this);return e||this._wrappers.add(o),this._mergeProps(t),o}disposeTabster(e,t){t?this._wrappers.clear():this._wrappers.delete(e),0===this._wrappers.size&&this.dispose()}dispose(){var e,t,o,i,n,r,s,a;this.internal.stopObserver();const l=this._win;null==l||l.clearTimeout(this._initTimer),delete this._initTimer,this._initQueue=[],this._forgetMemorizedElements=[],l&&this._forgetMemorizedTimer&&(l.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null===(e=this.outline)||void 0===e||e.dispose(),null===(t=this.crossOrigin)||void 0===t||t.dispose(),null===(o=this.deloser)||void 0===o||o.dispose(),null===(i=this.groupper)||void 0===i||i.dispose(),null===(n=this.mover)||void 0===n||n.dispose(),null===(r=this.modalizer)||void 0===r||r.dispose(),null===(s=this.observedElement)||void 0===s||s.dispose(),null===(a=this.restorer)||void 0===a||a.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this._dummyObserver.dispose(),function(e){const t=B(e);t.fakeWeakRefsStarted=!1,t.fakeWeakRefsTimer&&(e().clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefsTimer=void 0,t.fakeWeakRefs=[])}(this.getWindow),L(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),l&&(function(e){const t=e.__tabsterInstanceContext;t&&(t.elementByUId={},delete t.WeakRef,t.containerBoundingRectCache={},t.containerBoundingRectCacheTimer&&e.clearTimeout(t.containerBoundingRectCacheTimer),t.fakeWeakRefsTimer&&e.clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefs=[],delete e.__tabsterInstanceContext)}(l),delete l.__tabsterInstance,delete this._win)}storageEntry(e,t){const o=this._storage;let i=o.get(e);return i?!1===t&&0===Object.keys(i).length&&o.delete(e):!0===t&&(i={},o.set(e,i)),i}forceCleanup(){this._win&&(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout((()=>{delete this._forgetMemorizedTimer;for(let e=this._forgetMemorizedElements.shift();e;e=this._forgetMemorizedElements.shift())L(this.getWindow,e),de.forgetMemorized(this.focusedElement,e)}),0),M(this.getWindow,!0)))}queueInit(e){var t;this._win&&(this._initQueue.push(e),this._initTimer||(this._initTimer=null===(t=this._win)||void 0===t?void 0:t.setTimeout((()=>{delete this._initTimer,this.drainInitQueue()}),0)))}drainInitQueue(){if(!this._win)return;const e=this._initQueue;this._initQueue=[],e.forEach((e=>e()))}}function Be(e,t){let o=function(e){return e.__tabsterInstance}(e);return o?o.createTabster(!1,t):(o=new Ee(e,t),e.__tabsterInstance=o,o.createTabster())}function Ae(e){const t=e.core;return t.mover||(t.mover=new Ce(t,t.getWindow)),t.mover}function Re(e,t,o){const i=e.core;return i.modalizer||(i.modalizer=new ve(i,t,o)),i.modalizer}function Me(e){const t=e.core;return t.restorer||(t.restorer=new xe(t)),t.restorer}function De(e,t){e.core.disposeTabster(e,t)}},50272:(e,t,o)=>{"use strict";if(o.d(t,{BN:()=>g,ER:()=>p,Ej:()=>f,UE:()=>a,UU:()=>l,__:()=>s,cY:()=>h,jD:()=>d,rD:()=>r}),3023==o.j)var i=o(34713);function n(e,t,o){let{reference:n,floating:r}=e;const s=(0,i.TV)(t),a=(0,i.Dz)(t),l=(0,i.sq)(a),c=(0,i.C0)(t),u="y"===s,d=n.x+n.width/2-r.width/2,h=n.y+n.height/2-r.height/2,g=n[l]/2-r[l]/2;let p;switch(c){case"top":p={x:d,y:n.y-r.height};break;case"bottom":p={x:d,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:h};break;case"left":p={x:n.x-r.width,y:h};break;default:p={x:n.x,y:n.y}}switch((0,i.Sg)(t)){case"start":p[a]-=g*(o&&u?-1:1);break;case"end":p[a]+=g*(o&&u?-1:1)}return p}const r=async(e,t,o)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:a}=o,l=s.filter(Boolean),c=await(null==a.isRTL?void 0:a.isRTL(t));let u=await a.getElementRects({reference:e,floating:t,strategy:r}),{x:d,y:h}=n(u,i,c),g=i,p={},f=0;for(let o=0;o<l.length;o++){const{name:s,fn:m}=l[o],{x:v,y:b,data:y,reset:w}=await m({x:d,y:h,initialPlacement:i,placement:g,strategy:r,middlewareData:p,rects:u,platform:a,elements:{reference:e,floating:t}});d=null!=v?v:d,h=null!=b?b:h,p={...p,[s]:{...p[s],...y}},w&&f<=50&&(f++,"object"==typeof w&&(w.placement&&(g=w.placement),w.rects&&(u=!0===w.rects?await a.getElementRects({reference:e,floating:t,strategy:r}):w.rects),({x:d,y:h}=n(u,g,c))),o=-1)}return{x:d,y:h,placement:g,strategy:r,middlewareData:p}};async function s(e,t){var o;void 0===t&&(t={});const{x:n,y:r,platform:s,rects:a,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:g=!1,padding:p=0}=(0,i._3)(t,e),f=(0,i.nI)(p),m=l[g?"floating"===h?"reference":"floating":h],v=(0,i.B1)(await s.getClippingRect({element:null==(o=await(null==s.isElement?void 0:s.isElement(m)))||o?m:m.contextElement||await(null==s.getDocumentElement?void 0:s.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),b="floating"===h?{x:n,y:r,width:a.floating.width,height:a.floating.height}:a.reference,y=await(null==s.getOffsetParent?void 0:s.getOffsetParent(l.floating)),w=await(null==s.isElement?void 0:s.isElement(y))&&await(null==s.getScale?void 0:s.getScale(y))||{x:1,y:1},C=(0,i.B1)(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:b,offsetParent:y,strategy:c}):b);return{top:(v.top-C.top+f.top)/w.y,bottom:(C.bottom-v.bottom+f.bottom)/w.y,left:(v.left-C.left+f.left)/w.x,right:(C.right-v.right+f.right)/w.x}}const a=e=>({name:"arrow",options:e,async fn(t){const{x:o,y:n,placement:r,rects:s,platform:a,elements:l,middlewareData:c}=t,{element:u,padding:d=0}=(0,i._3)(e,t)||{};if(null==u)return{};const h=(0,i.nI)(d),g={x:o,y:n},p=(0,i.Dz)(r),f=(0,i.sq)(p),m=await a.getDimensions(u),v="y"===p,b=v?"top":"left",y=v?"bottom":"right",w=v?"clientHeight":"clientWidth",C=s.reference[f]+s.reference[p]-g[p]-s.floating[f],S=g[p]-s.reference[p],k=await(null==a.getOffsetParent?void 0:a.getOffsetParent(u));let T=k?k[w]:0;T&&await(null==a.isElement?void 0:a.isElement(k))||(T=l.floating[w]||s.floating[f]);const x=C/2-S/2,_=T/2-m[f]/2-1,I=(0,i.jk)(h[b],_),E=(0,i.jk)(h[y],_),B=I,A=T-m[f]-E,R=T/2-m[f]/2+x,M=(0,i.qE)(B,R,A),D=!c.arrow&&null!=(0,i.Sg)(r)&&R!==M&&s.reference[f]/2-(R<B?I:E)-m[f]/2<0,P=D?R<B?R-B:R-A:0;return{[p]:g[p]+P,data:{[p]:M,centerOffset:R-M-P,...D&&{alignmentOffset:P}},reset:D}}}),l=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var o,n;const{placement:r,middlewareData:a,rects:l,initialPlacement:c,platform:u,elements:d}=t,{mainAxis:h=!0,crossAxis:g=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:v=!0,...b}=(0,i._3)(e,t);if(null!=(o=a.arrow)&&o.alignmentOffset)return{};const y=(0,i.C0)(r),w=(0,i.TV)(c),C=(0,i.C0)(c)===c,S=await(null==u.isRTL?void 0:u.isRTL(d.floating)),k=p||(C||!v?[(0,i.bV)(c)]:(0,i.WJ)(c)),T="none"!==m;!p&&T&&k.push(...(0,i.lP)(c,v,m,S));const x=[c,...k],_=await s(t,b),I=[];let E=(null==(n=a.flip)?void 0:n.overflows)||[];if(h&&I.push(_[y]),g){const e=(0,i.w7)(r,l,S);I.push(_[e[0]],_[e[1]])}if(E=[...E,{placement:r,overflows:I}],!I.every((e=>e<=0))){var B,A;const e=((null==(B=a.flip)?void 0:B.index)||0)+1,t=x[e];if(t)return{data:{index:e,overflows:E},reset:{placement:t}};let o=null==(A=E.filter((e=>e.overflows[0]<=0)).sort(((e,t)=>e.overflows[1]-t.overflows[1]))[0])?void 0:A.placement;if(!o)switch(f){case"bestFit":{var R;const e=null==(R=E.filter((e=>{if(T){const t=(0,i.TV)(e.placement);return t===w||"y"===t}return!0})).map((e=>[e.placement,e.overflows.filter((e=>e>0)).reduce(((e,t)=>e+t),0)])).sort(((e,t)=>e[1]-t[1]))[0])?void 0:R[0];e&&(o=e);break}case"initialPlacement":o=c}if(r!==o)return{reset:{placement:o}}}return{}}}};function c(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function u(e){return i.r_.some((t=>e[t]>=0))}const d=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:o}=t,{strategy:n="referenceHidden",...r}=(0,i._3)(e,t);switch(n){case"referenceHidden":{const e=c(await s(t,{...r,elementContext:"reference"}),o.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:u(e)}}}case"escaped":{const e=c(await s(t,{...r,altBoundary:!0}),o.floating);return{data:{escapedOffsets:e,escaped:u(e)}}}default:return{}}}}},h=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var o,n;const{x:r,y:s,placement:a,middlewareData:l}=t,c=await async function(e,t){const{placement:o,platform:n,elements:r}=e,s=await(null==n.isRTL?void 0:n.isRTL(r.floating)),a=(0,i.C0)(o),l=(0,i.Sg)(o),c="y"===(0,i.TV)(o),u=["left","top"].includes(a)?-1:1,d=s&&c?-1:1,h=(0,i._3)(t,e);let{mainAxis:g,crossAxis:p,alignmentAxis:f}="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&"number"==typeof f&&(p="end"===l?-1*f:f),c?{x:p*d,y:g*u}:{x:g*u,y:p*d}}(t,e);return a===(null==(o=l.offset)?void 0:o.placement)&&null!=(n=l.arrow)&&n.alignmentOffset?{}:{x:r+c.x,y:s+c.y,data:{...c,placement:a}}}}},g=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:o,y:n,placement:r}=t,{mainAxis:a=!0,crossAxis:l=!1,limiter:c={fn:e=>{let{x:t,y:o}=e;return{x:t,y:o}}},...u}=(0,i._3)(e,t),d={x:o,y:n},h=await s(t,u),g=(0,i.TV)((0,i.C0)(r)),p=(0,i.PG)(g);let f=d[p],m=d[g];if(a){const e="y"===p?"bottom":"right",t=f+h["y"===p?"top":"left"],o=f-h[e];f=(0,i.qE)(t,f,o)}if(l){const e="y"===g?"bottom":"right",t=m+h["y"===g?"top":"left"],o=m-h[e];m=(0,i.qE)(t,m,o)}const v=c.fn({...t,[p]:f,[g]:m});return{...v,data:{x:v.x-o,y:v.y-n,enabled:{[p]:a,[g]:l}}}}}},p=function(e){return void 0===e&&(e={}),{options:e,fn(t){const{x:o,y:n,placement:r,rects:s,middlewareData:a}=t,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=(0,i._3)(e,t),d={x:o,y:n},h=(0,i.TV)(r),g=(0,i.PG)(h);let p=d[g],f=d[h];const m=(0,i._3)(l,t),v="number"==typeof m?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(c){const e="y"===g?"height":"width",t=s.reference[g]-s.floating[e]+v.mainAxis,o=s.reference[g]+s.reference[e]-v.mainAxis;p<t?p=t:p>o&&(p=o)}if(u){var b,y;const e="y"===g?"width":"height",t=["top","left"].includes((0,i.C0)(r)),o=s.reference[h]-s.floating[e]+(t&&(null==(b=a.offset)?void 0:b[h])||0)+(t?0:v.crossAxis),n=s.reference[h]+s.reference[e]+(t?0:(null==(y=a.offset)?void 0:y[h])||0)-(t?v.crossAxis:0);f<o?f=o:f>n&&(f=n)}return{[g]:p,[h]:f}}}},f=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){var o,n;const{placement:r,rects:a,platform:l,elements:c}=t,{apply:u=(()=>{}),...d}=(0,i._3)(e,t),h=await s(t,d),g=(0,i.C0)(r),p=(0,i.Sg)(r),f="y"===(0,i.TV)(r),{width:m,height:v}=a.floating;let b,y;"top"===g||"bottom"===g?(b=g,y=p===(await(null==l.isRTL?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(y=g,b="end"===p?"top":"bottom");const w=v-h.top-h.bottom,C=m-h.left-h.right,S=(0,i.jk)(v-h[b],w),k=(0,i.jk)(m-h[y],C),T=!t.middlewareData.shift;let x=S,_=k;if(null!=(o=t.middlewareData.shift)&&o.enabled.x&&(_=C),null!=(n=t.middlewareData.shift)&&n.enabled.y&&(x=w),T&&!p){const e=(0,i.T9)(h.left,0),t=(0,i.T9)(h.right,0),o=(0,i.T9)(h.top,0),n=(0,i.T9)(h.bottom,0);f?_=m-2*(0!==e||0!==t?e+t:(0,i.T9)(h.left,h.right)):x=v-2*(0!==o||0!==n?o+n:(0,i.T9)(h.top,h.bottom))}await u({...t,availableWidth:_,availableHeight:x});const I=await l.getDimensions(c.floating);return m!==I.width||v!==I.height?{reset:{rects:!0}}:{}}}}},69929:(e,t,o)=>{"use strict";o.d(t,{UE:()=>V,rD:()=>K,__:()=>L,UU:()=>W,jD:()=>G,ER:()=>$,cY:()=>z,BN:()=>H,Ej:()=>U});var i=o(34713),n=o(50272);function r(){return"undefined"!=typeof window}function s(e){return c(e)?(e.nodeName||"").toLowerCase():"#document"}function a(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function l(e){var t;return null==(t=(c(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function c(e){return!!r()&&(e instanceof Node||e instanceof a(e).Node)}function u(e){return!!r()&&(e instanceof Element||e instanceof a(e).Element)}function d(e){return!!r()&&(e instanceof HTMLElement||e instanceof a(e).HTMLElement)}function h(e){return!(!r()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof a(e).ShadowRoot)}function g(e){const{overflow:t,overflowX:o,overflowY:i,display:n}=y(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+o)&&!["inline","contents"].includes(n)}function p(e){return["table","td","th"].includes(s(e))}function f(e){return[":popover-open",":modal"].some((t=>{try{return e.matches(t)}catch(e){return!1}}))}function m(e){const t=v(),o=u(e)?y(e):e;return["transform","translate","scale","rotate","perspective"].some((e=>!!o[e]&&"none"!==o[e]))||!!o.containerType&&"normal"!==o.containerType||!t&&!!o.backdropFilter&&"none"!==o.backdropFilter||!t&&!!o.filter&&"none"!==o.filter||["transform","translate","scale","rotate","perspective","filter"].some((e=>(o.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(o.contain||"").includes(e)))}function v(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function b(e){return["html","body","#document"].includes(s(e))}function y(e){return a(e).getComputedStyle(e)}function w(e){return u(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function C(e){if("html"===s(e))return e;const t=e.assignedSlot||e.parentNode||h(e)&&e.host||l(e);return h(t)?t.host:t}function S(e){const t=C(e);return b(t)?e.ownerDocument?e.ownerDocument.body:e.body:d(t)&&g(t)?t:S(t)}function k(e,t,o){var i;void 0===t&&(t=[]),void 0===o&&(o=!0);const n=S(e),r=n===(null==(i=e.ownerDocument)?void 0:i.body),s=a(n);if(r){const e=T(s);return t.concat(s,s.visualViewport||[],g(n)?n:[],e&&o?k(e):[])}return t.concat(n,k(n,[],o))}function T(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function x(e){const t=y(e);let o=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const r=d(e),s=r?e.offsetWidth:o,a=r?e.offsetHeight:n,l=(0,i.LI)(o)!==s||(0,i.LI)(n)!==a;return l&&(o=s,n=a),{width:o,height:n,$:l}}function _(e){return u(e)?e:e.contextElement}function I(e){const t=_(e);if(!d(t))return(0,i.Jx)(1);const o=t.getBoundingClientRect(),{width:n,height:r,$:s}=x(t);let a=(s?(0,i.LI)(o.width):o.width)/n,l=(s?(0,i.LI)(o.height):o.height)/r;return a&&Number.isFinite(a)||(a=1),l&&Number.isFinite(l)||(l=1),{x:a,y:l}}const E=(0,i.Jx)(0);function B(e){const t=a(e);return v()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:E}function A(e,t,o,n){void 0===t&&(t=!1),void 0===o&&(o=!1);const r=e.getBoundingClientRect(),s=_(e);let l=(0,i.Jx)(1);t&&(n?u(n)&&(l=I(n)):l=I(e));const c=function(e,t,o){return void 0===t&&(t=!1),!(!o||t&&o!==a(e))&&t}(s,o,n)?B(s):(0,i.Jx)(0);let d=(r.left+c.x)/l.x,h=(r.top+c.y)/l.y,g=r.width/l.x,p=r.height/l.y;if(s){const e=a(s),t=n&&u(n)?a(n):n;let o=e,i=T(o);for(;i&&n&&t!==o;){const e=I(i),t=i.getBoundingClientRect(),n=y(i),r=t.left+(i.clientLeft+parseFloat(n.paddingLeft))*e.x,s=t.top+(i.clientTop+parseFloat(n.paddingTop))*e.y;d*=e.x,h*=e.y,g*=e.x,p*=e.y,d+=r,h+=s,o=a(i),i=T(o)}}return(0,i.B1)({width:g,height:p,x:d,y:h})}function R(e,t){const o=w(e).scrollLeft;return t?t.left+o:A(l(e)).left+o}function M(e,t,o){void 0===o&&(o=!1);const i=e.getBoundingClientRect();return{x:i.left+t.scrollLeft-(o?0:R(e,i)),y:i.top+t.scrollTop}}function D(e,t,o){let n;if("viewport"===t)n=function(e,t){const o=a(e),i=l(e),n=o.visualViewport;let r=i.clientWidth,s=i.clientHeight,c=0,u=0;if(n){r=n.width,s=n.height;const e=v();(!e||e&&"fixed"===t)&&(c=n.offsetLeft,u=n.offsetTop)}return{width:r,height:s,x:c,y:u}}(e,o);else if("document"===t)n=function(e){const t=l(e),o=w(e),n=e.ownerDocument.body,r=(0,i.T9)(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=(0,i.T9)(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let a=-o.scrollLeft+R(e);const c=-o.scrollTop;return"rtl"===y(n).direction&&(a+=(0,i.T9)(t.clientWidth,n.clientWidth)-r),{width:r,height:s,x:a,y:c}}(l(e));else if(u(t))n=function(e,t){const o=A(e,!0,"fixed"===t),n=o.top+e.clientTop,r=o.left+e.clientLeft,s=d(e)?I(e):(0,i.Jx)(1);return{width:e.clientWidth*s.x,height:e.clientHeight*s.y,x:r*s.x,y:n*s.y}}(t,o);else{const o=B(e);n={x:t.x-o.x,y:t.y-o.y,width:t.width,height:t.height}}return(0,i.B1)(n)}function P(e,t){const o=C(e);return!(o===t||!u(o)||b(o))&&("fixed"===y(o).position||P(o,t))}function F(e,t,o){const n=d(t),r=l(t),a="fixed"===o,c=A(e,!0,a,t);let u={scrollLeft:0,scrollTop:0};const h=(0,i.Jx)(0);if(n||!n&&!a)if(("body"!==s(t)||g(r))&&(u=w(t)),n){const e=A(t,!0,a,t);h.x=e.x+t.clientLeft,h.y=e.y+t.clientTop}else r&&(h.x=R(r));const p=!r||n||a?(0,i.Jx)(0):M(r,u);return{x:c.left+u.scrollLeft-h.x-p.x,y:c.top+u.scrollTop-h.y-p.y,width:c.width,height:c.height}}function O(e){return"static"===y(e).position}function N(e,t){if(!d(e)||"fixed"===y(e).position)return null;if(t)return t(e);let o=e.offsetParent;return l(e)===o&&(o=o.ownerDocument.body),o}function q(e,t){const o=a(e);if(f(e))return o;if(!d(e)){let t=C(e);for(;t&&!b(t);){if(u(t)&&!O(t))return t;t=C(t)}return o}let i=N(e,t);for(;i&&p(i)&&O(i);)i=N(i,t);return i&&b(i)&&O(i)&&!m(i)?o:i||function(e){let t=C(e);for(;d(t)&&!b(t);){if(m(t))return t;if(f(t))return null;t=C(t)}return null}(e)||o}const j={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:o,offsetParent:n,strategy:r}=e;const a="fixed"===r,c=l(n),u=!!t&&f(t.floating);if(n===c||u&&a)return o;let h={scrollLeft:0,scrollTop:0},p=(0,i.Jx)(1);const m=(0,i.Jx)(0),v=d(n);if((v||!v&&!a)&&(("body"!==s(n)||g(c))&&(h=w(n)),d(n))){const e=A(n);p=I(n),m.x=e.x+n.clientLeft,m.y=e.y+n.clientTop}const b=!c||v||a?(0,i.Jx)(0):M(c,h,!0);return{width:o.width*p.x,height:o.height*p.y,x:o.x*p.x-h.scrollLeft*p.x+m.x+b.x,y:o.y*p.y-h.scrollTop*p.y+m.y+b.y}},getDocumentElement:l,getClippingRect:function(e){let{element:t,boundary:o,rootBoundary:n,strategy:r}=e;const a=[..."clippingAncestors"===o?f(t)?[]:function(e,t){const o=t.get(e);if(o)return o;let i=k(e,[],!1).filter((e=>u(e)&&"body"!==s(e))),n=null;const r="fixed"===y(e).position;let a=r?C(e):e;for(;u(a)&&!b(a);){const t=y(a),o=m(a);o||"fixed"!==t.position||(n=null),(r?!o&&!n:!o&&"static"===t.position&&n&&["absolute","fixed"].includes(n.position)||g(a)&&!o&&P(e,a))?i=i.filter((e=>e!==a)):n=t,a=C(a)}return t.set(e,i),i}(t,this._c):[].concat(o),n],l=a[0],c=a.reduce(((e,o)=>{const n=D(t,o,r);return e.top=(0,i.T9)(n.top,e.top),e.right=(0,i.jk)(n.right,e.right),e.bottom=(0,i.jk)(n.bottom,e.bottom),e.left=(0,i.T9)(n.left,e.left),e}),D(t,l,r));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}},getOffsetParent:q,getElementRects:async function(e){const t=this.getOffsetParent||q,o=this.getDimensions,i=await o(e.floating);return{reference:F(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:i.width,height:i.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:o}=x(e);return{width:t,height:o}},getScale:I,isElement:u,isRTL:function(e){return"rtl"===y(e).direction}},L=n.__,z=n.cY,H=n.BN,W=n.UU,U=n.Ej,G=n.jD,V=n.UE,$=n.ER,K=(e,t,o)=>{const i=new Map,r={platform:j,...o},s={...r.platform,_c:i};return(0,n.rD)(e,t,{...r,platform:s})}},34713:(e,t,o)=>{"use strict";o.d(t,{B1:()=>T,C0:()=>h,Dz:()=>v,Jx:()=>a,LI:()=>s,PG:()=>p,Sg:()=>g,T9:()=>r,TV:()=>m,WJ:()=>y,_3:()=>d,bV:()=>S,jk:()=>n,lP:()=>C,nI:()=>k,qE:()=>u,r_:()=>i,sq:()=>f,w7:()=>b});const i=3023==o.j?["top","right","bottom","left"]:null,n=Math.min,r=Math.max,s=Math.round,a=(Math.floor,e=>({x:e,y:e})),l={left:"right",right:"left",bottom:"top",top:"bottom"},c={start:"end",end:"start"};function u(e,t,o){return r(e,n(t,o))}function d(e,t){return"function"==typeof e?e(t):e}function h(e){return e.split("-")[0]}function g(e){return e.split("-")[1]}function p(e){return"x"===e?"y":"x"}function f(e){return"y"===e?"height":"width"}function m(e){return["top","bottom"].includes(h(e))?"y":"x"}function v(e){return p(m(e))}function b(e,t,o){void 0===o&&(o=!1);const i=g(e),n=v(e),r=f(n);let s="x"===n?i===(o?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[r]>t.floating[r]&&(s=S(s)),[s,S(s)]}function y(e){const t=S(e);return[w(e),t,w(t)]}function w(e){return e.replace(/start|end/g,(e=>c[e]))}function C(e,t,o,i){const n=g(e);let r=function(e,t,o){const i=["left","right"],n=["right","left"],r=["top","bottom"],s=["bottom","top"];switch(e){case"top":case"bottom":return o?t?n:i:t?i:n;case"left":case"right":return t?r:s;default:return[]}}(h(e),"start"===o,i);return n&&(r=r.map((e=>e+"-"+n)),t&&(r=r.concat(r.map(w)))),r}function S(e){return e.replace(/left|right|bottom|top/g,(e=>l[e]))}function k(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function T(e){const{x:t,y:o,width:i,height:n}=e;return{width:i,height:n,top:o,left:t,right:t+i,bottom:o+n,x:t,y:o}}},84217:(e,t,o)=>{"use strict";if(o.d(t,{AH:()=>n,O0:()=>r}),3023==o.j)var i=o(50421);const n=e=>i.Ss.from(e,"base64").toString("utf8"),r=e=>i.Ss.from(e,"utf8").toString("base64")},50421:(e,t,o)=>{"use strict";o.d(t,{Ss:()=>r});var i=o(75049);function n(e){const t=e;return e instanceof ArrayBuffer||"object"==typeof t&&null!==t&&"number"==typeof t.byteLength&&"function"==typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class r extends(3023==o.j?Uint8Array:null){toString(e){return function(e,t){switch(t){case"base64":return i.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}(this,e)}static from(e,t,o){if("string"==typeof e)return r.fromString(e,t);if(null!==e&&"object"==typeof e&&n(e.buffer))return r.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(n(e))return r.fromArrayBuffer(e,t,o);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,o){const i=t??0,n=o??e.byteLength-i;if(i<0||i>e.byteLength||n<0||n+i>e.byteLength)throw new RangeError("Invalid range specified.");return new r(e,i,n)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),o=i.toByteArray(t);return new r(o.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new r(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;return t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!=0&&(t+=["","===","==","="][t.length%4]),t}}},35896:(e,t,o)=>{"use strict";o.d(t,{W:()=>n,i:()=>i});const i="https://my.microsoftpersonalcontent.com",n="https://1drv.ms"},67299:(e,t,o)=>{"use strict";if(o.d(t,{Cu:()=>m,Mh:()=>v}),3023==o.j)var i=o(84217);if(3023==o.j)var n=o(35896);const r="1",s="fluid",a="s",l="d",c="f",u="c",d="a",h="p",g="v",p="x",f="nav";function m(e,t){const o=function(e){const t=new URL(e.siteUrl),o=encodeURIComponent(t.pathname),n=encodeURIComponent(e.driveId),f=encodeURIComponent(e.itemId),m=encodeURIComponent(e.dataStorePath);let v=`${a}=${o}&${l}=${n}&${c}=${f}&${u}=${m}&${s}=${r}`;return e.appName&&(v+=`&${d}=${encodeURIComponent(e.appName)}`),e.containerPackageName&&(v+=`&${h}=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(v+=`&${g}=${encodeURIComponent(e.fileVersion)}`),e.context&&(v+=`&${p}=${encodeURIComponent(e.context)}`),(0,i.O0)(v)}(t);e.searchParams.set(f,o)}function v(e,t=!0){const o=e.searchParams.get(f);if(o)return function(e,t,o=!0){const n=new URLSearchParams((0,i.AH)(e)),r=n.get(s);if(o&&"1"!==r)return;const f=n.get(a),m=n.get(l),v=n.get(c),b=n.get(u),y=n.get(d)??void 0,w=n.get(h)??void 0,C=n.get(g)??void 0,S=n.get(p)??void 0;if(!f||!m||!v||null===b)return;let k;try{k=new URL(f,t)}catch{}return k?{siteUrl:k.href,driveId:m,itemId:v,dataStorePath:b,appName:y,containerPackageName:w,fileVersion:C,context:S}:void 0}(o,e.origin.toLowerCase()===n.W?n.i:e.origin,t)}},81264:e=>{"use strict";e.exports={r:"2.35.2163"}}}]);
//# sourceMappingURL=shared.js.map