/*! For license information please see index.js.LICENSE.txt */
var TypeScriptModule;(()=>{var e,t,n,r,o={2777:(e,t,n)=>{"use strict";n.d(t,{Ed:()=>i,FT:()=>o,pb:()=>s});var r=n(7276);function o(e){return()=>e}function i(e){return t=>Math.pow(2,t)*e}function s(e,t,n){return a(e,[],new AbortController,t,n)}function a(e,t,n,o,i){let s;const c=[e(t.length).then((e=>(s=e,!1)))];return i&&i.timeoutMs>0&&c.push((0,r.c)(i.timeoutMs,n.signal).then((()=>!0))),Promise.race(c).then((c=>(c&&(s=i.onTimeout()),!o?.filter(s)||t.length>=o.maxRetries?(n.abort(),{result:s,tries:t}):(0,r.c)(o.backoffFn(t.length,s),n.signal).then((()=>(t.push(s),a(e,t,n,o,i)))))))}},7276:(e,t,n)=>{"use strict";function r(e,t){return new Promise((n=>{const r=setTimeout((()=>n()),e);t?.addEventListener("abort",(()=>{clearTimeout(r),n()}))}))}function o(e,t){const n=r(e).then((e=>!0)),o=t.map((e=>e.then((e=>!1)).catch((e=>!1))));return Promise.race([n,...o])}n.d(t,{c:()=>r,t:()=>o})},9885:(e,t,n)=>{"use strict";n.d(t,{J5:()=>l,sC:()=>c});var r=n(2777);const o=709,i=710;function s(){return"undefined"==typeof navigator||!1!==navigator.onLine}const a={durationMs:-1,body:null,bodyUsed:!1,headers:new Headers,ok:!1,redirected:!1,status:s()?i:o,statusText:"",type:"error",url:"",arrayBuffer:()=>Promise.resolve(new ArrayBuffer(0)),blob:()=>Promise.resolve(new Blob(void 0)),formData:()=>Promise.resolve(new FormData(void 0)),json:()=>Promise.resolve(void 0),text:()=>Promise.resolve(""),clone:()=>new Response};function c(e){return t=>e.includes(t.status)}function l(e,t,n,c=18e4){let l=n;n?.respectRetryAfterHeader&&(l={...n},l.backoffFn=(e,t)=>{if(429===t.status||503===t.status){const e=t.headers.get("Retry-After");if(e){const t=parseInt(e,10);if(!isNaN(t))return 1e3*t}}return n.backoffFn(e,t)});const u=new AbortController;t?.signal?.aborted?u.abort(t.signal.reason):t?.signal?.addEventListener("abort",(function(){u.abort(this.reason)}));const d={...t,signal:u.signal};return(0,r.pb)((()=>{const t="undefined"!=typeof performance?performance.now():Date.now();return fetch(e,d).then((e=>{const n=e;return n.durationMs=Math.round(performance.now()-t),n})).catch((e=>{if(function(e,t){return e===t?.reason||"object"==typeof e&&null!==e&&("AbortError"===e.name||20===e.code)}(e,d.signal))throw e;let n="Error does not provide a message";return e.name&&e.message?n=`Error type: ${e.name}, ${e.message}`:e.name?n=`Error type: ${e.name}`:e.message&&(n=`Error message: ${e.message}`),{...a,status:s()?i:o,ok:!1,durationMs:Math.round(performance.now()-t),statusText:n}}))}),l,{timeoutMs:c,onTimeout:()=>(u.abort(),{...a,status:707,ok:!1,durationMs:c})})}},1262:(e,t,n)=>{"use strict";var r,o;n.d(t,{Qq:()=>i,Tp:()=>o,hB:()=>r}),function(e){e.Generic="Generic",e.Error="Error",e.UserAction="UserAction",e.Activity="Activity",e.DNM="DNM"}(r||(r={})),function(e){e.Success="Success",e.Failure="Failure",e.Cancelled="Cancelled"}(o||(o={}));const i={Bool:"Bool",Int64:"Int64",Double:"Double"}},7419:(e,t,n)=>{"use strict";n.d(t,{F:()=>y});const r="https://hubblecontent.osi.office.net/contentsvc/",o="https://cdn.hubblecontent.osi.office.net/",i={aadAuthority:"https://login.microsoftonline.us",loki:"https://dod.loki.office365.us",graph:"https://dod-graph.microsoft.us",substrate:"https://substrate-dod.office365.us",outlook:"https://outlook-dod.office365.us",augloop:"https://augloop.dod.online.office365.us",augloopOld:"https://augloop.dod.online.office365.us",ocps:"",fs:"https://fs.microsoft.com",editor:"nleditor.osi.apps.mil",editorSynonyms:"editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.osi.apps.mil/ocs",ecs:"https://config.ecs.dod.teams.microsoft.us",project:"https://project.apps.mil/",teamsTasks:"",plannerOld:"https://tasks.osi.apps.mil",plannerNew:"",centro:"",iris:"",teams:"",teamsWebTasks:"",hubbleService:r,hubbleStorage:o},s={aadAuthority:"https://login.microsoftonline.us",loki:"https://gcchigh.loki.office365.us",graph:"https://graph.microsoft.us",substrate:"https://substrate.office365.us",outlook:"https://outlook.office365.us",augloop:"https://augloop.gov.online.office365.us",augloopOld:"https://augloop.gov.online.office365.us",ocps:"",fs:"https://fs.microsoft.com",editor:"nleditor.osi.office365.us",editorSynonyms:"editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.osi.office365.us/ocs",ecs:"https://config.ecs.gov.teams.microsoft.us",project:"https://project.office365.us",plannerOld:"https://tasks.office365.us",plannerNew:"",teamsTasks:"",centro:"",iris:"",teams:"",teamsWebTasks:"",hubbleService:r,hubbleStorage:o},a={aadAuthority:"https://login.microsoftonline.com",loki:"https://loki.delve.office.com",graph:"https://graph.microsoft.com",substrate:"https://substrate.office.com",outlook:"https://outlook.office.com",augloop:"https://gcc.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-gcc.office.com",ocps:"",fs:"https://fs.microsoft.com",editor:"nleditor.gcc.osi.office365.us",editorSynonyms:"editor-gccm-thesaurus.usgovtrafficmanager.net:9443",mru:"https://ocws.officeapps.live.com/ocs",ecs:"https://ecs.office.com",project:"https://gcc.project.microsoft.com",teamsTasks:"https://tasks.gcc.teams.microsoft.com",plannerOld:"https://tasks.office.com",plannerNew:"",centro:"",iris:"",teams:"",teamsWebTasks:"",hubbleService:r,hubbleStorage:o},c={aadAuthority:"https://login.microsoftonline.us",loki:"",graph:"",substrate:"",outlook:"",augloop:"",augloopOld:"",ocps:"",fs:"",editor:"",editorSynonyms:"",mru:"",ecs:"https://config.ecs.teams.eaglex.ic.gov",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:""},l={aadAuthority:"https://login.microsoftonline.us",loki:"",graph:"",substrate:"",outlook:"",augloop:"",augloopOld:"",ocps:"",fs:"",editor:"",editorSynonyms:"",mru:"",ecs:"https://config.ecs.teams.microsoft.scloud",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:""},u={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://sip.clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o},d={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"",teamsWebTasks:"",hubbleService:r,hubbleStorage:o},p={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o},h={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o},f={aadAuthority:"https://login.microsoftonline.com",augloop:"https://dogfood.augloop.svc.cloud.microsoft",augloopOld:"https://augloop-dogfood.officeppe.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.officeppe.net",editorSynonyms:"editor-edog-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws-df.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o},g={aadAuthority:"https://login.microsoftonline.com",augloop:"https://augloop.svc.cloud.microsoft",augloopOld:"https://augloop.office.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o},m={aadAuthority:"https://login.microsoftonline.com",augloop:"https://augloop.svc.cloud.microsoft",augloopOld:"https://augloop.office.com",centro:"https://admin-ignite.microsoft.com",ecs:"https://ecs.office.com",editor:"nleditor.osi.office.net",editorSynonyms:"editor-prod-thesaurus.trafficmanager.net:9443",fs:"https://fs.microsoft.com",graph:"https://graph.microsoft.com",iris:"https://arc.msn.com",loki:"https://loki.delve.office.com",mru:"https://ocws.officeapps.live.com/ocs",ocps:"https://clients.config.office.net",outlook:"https://outlook.office.com",plannerNew:"https://planner.cloud.microsoft",plannerOld:"https://tasks.office.com",project:"https://project.microsoft.com",substrate:"https://substrate.office.com",teamsTasks:"https://retailservices.teams.microsoft.com",teams:"https://teams.microsoft.com",teamsWebTasks:"https://tasks.teams.microsoft.com",hubbleService:r,hubbleStorage:o},v={aadAuthority:"https://login.chinacloudapi.cn",loki:"https://loki.office365.cn",graph:"https://microsoftgraph.chinacloudapi.cn",substrate:"https://substrate.partner.outlook.cn",outlook:"https://outlook.partner.outlook.cn",augloop:"https://augloop.microsoftonline.cn",augloopOld:"https://augloop.microsoftonline.cn",ocps:"",fs:"https://fs.microsoft.com",editor:"",editorSynonyms:"",mru:"https://ocws.officeapps.partner.office365.cn/ocs",ecs:"https://mooncake.ecs.office.com",project:"",teamsTasks:"",plannerOld:"",plannerNew:"",centro:"",iris:"",hubbleService:"",hubbleStorage:"",teams:"",teamsWebTasks:""};function y(e,t){switch(t){case"Local":return u[e];case"Automation":return d[e];case"Development":return p[e];case"Staging":return h[e];case"SyntheticTraffic":case"Dogfood":return f[e];case"Microsoft":return m[e];case"Preview":case"Production":return g[e];case"GCC":return a[e];case"GCC-High":return s[e];case"DoD":return i[e];case"USNat":return c[e];case"USSec":return l[e];case"Gallatin":return v[e]}}},3178:(e,t,n)=>{"use strict";n.d(t,{o:()=>o});var r=n(7419);const o=e=>(0,r.F)("graph",e)},7954:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});var r=n(1262),o=n(7288),i=n(4738);const s=new Set;class a{static start(e,t,n){const r=new a(e,t,n);return s.add(r),r}markSubActivityStart(e){this.subActivities[e]={startTime:performance.now(),startTimeSinceEpoch:Date.now()},this.addUserTiming&&performance.mark(this.getSubActivityName(e,"start"))}markSubActivityEnd(e,t){const n=this.subActivities[e];if(!n)return;if(this.addUserTiming){const t=this.getSubActivityName(e,"end");performance.mark(t),performance.measure(e,this.getSubActivityName(e,"start"),t)}const r={[`durationMs_${e}`]:Math.round(performance.now()-n.startTime)};this.logSubactivityStartTimes&&(r[`startTime_${e}`]=n.startTimeSinceEpoch),this.additionalPropsToLog={...r,...this.additionalPropsToLog,...t}}setResult(e,t,n,r){this.logActivityResult(e,t,n,r?.skipLogging,void 0,r?.sampleEvent)}cancel(e,t,n){this.logActivityResult(e,t,n,!1,!0)}addAdditionalProps(e){this.additionalPropsToLog={...this.additionalPropsToLog,...e}}dispose(){this.cancel();const e=e=>performance.clearMarks(e),t=e=>performance.clearMeasures(e);if(this.addUserTiming){e(this.activityStartName),e(this.activityEndName),this.cachedMeasureName&&t(this.cachedMeasureName);for(const n in this.subActivities)e(this.getSubActivityName(n,"start")),e(this.getSubActivityName(n,"end")),t(n)}}logActivityResult(e,t,n,o,a,c){if(this.hasAlreadyResolved)return;this.hasAlreadyResolved=!0,this.addUserTiming&&performance.mark(this.activityEndName);const l=performance.now(),u=Math.round(l-this.startTime);if(this.isAPerformanceMetric){(window._pageTimings||(window._pageTimings={}))[this.activityName]=t?.durationMs?Number(t.durationMs):u}if(this.logger&&!o){const o={eventName:this.activityName,startTime:this.startTimeSinceEpoch,durationMs:u,succeeded:e,sampleEvent:c,resultType:a?r.Tp.Cancelled:e?r.Tp.Success:r.Tp.Failure,...this.additionalPropsToLog,...t};(0,i.IA)(this.logger,o,n)}this.logger=void 0,s.delete(this),this.addUserTiming&&performance.measure(this.generateMeasureName(e),this.activityStartName,this.activityEndName)}generateMeasureName(e){return this.cachedMeasureName=`${this.activityName}${!1===e?"-FAILED":""}-${this.identifier}`,this.cachedMeasureName}getSubActivityName(e,t){return`${e}-${t}-${this.identifier}`}constructor(e,t,n){this.activityName=e,this.logger=t,this.isAPerformanceMetric=!1,this.additionalPropsToLog=n?.additionalPropsToLog,this.addUserTiming=n?.addUserTiming,this.isAPerformanceMetric=n?.isAPerformanceMetric||!1,this.logSubactivityStartTimes=n?.logSubactivityStartTimes??!0,this.subActivities={},this.identifier=(0,o.A)(),this.activityStartName=`${this.activityName}-start-${this.identifier}`,this.activityEndName=`${this.activityName}-end-${this.identifier}`,this.addUserTiming&&performance.mark(this.activityStartName),this.startTime=performance.now(),this.startTimeSinceEpoch=Date.now()}}},4738:(e,t,n)=>{"use strict";n.d(t,{LJ:()=>S,IA:()=>f,hO:()=>p,Ot:()=>d,A$:()=>u});var r=n(488),o={contractName:"Ms.ProductUsage.Action",instanceName:"BaseType",getFields:function(e){var t=this.instanceName,n=[];return n.push((0,r.m9)("zC.".concat(t),this.contractName)),e.ver&&n.push((0,r.m9)("".concat(t,".Ver"),e.ver)),n.push((0,r.m9)("".concat(t,".Name"),e.name)),e.featureName&&n.push((0,r.m9)("".concat(t,".FeatureName"),e.featureName)),e.featureCategory&&n.push((0,r.m9)("".concat(t,".FeatureCategory"),e.featureCategory)),e.inputMethod&&n.push((0,r.m9)("".concat(t,".InputMethod"),e.inputMethod)),n.push((0,r.LK)("".concat(t,".IsExportable"),e.isExportable)),n.push((0,r.LK)("".concat(t,".IsIntentional"),e.isIntentional)),e.subWorkload&&n.push((0,r.m9)("".concat(t,".SubWorkload"),e.subWorkload)),e.target&&n.push((0,r.m9)("".concat(t,".Target"),e.target)),n}},i=n(1262),s=n(1274);const a=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"],c=["res.cdn.office.net","res-sdf.cdn.office.net"];function l(e){for(const t in e)if(-1!==t.search(/message|error|stack/i)||a.includes(t)){const n=e[t];if("string"==typeof n){const r=/\b([A-Z0-9.!#$%&'*+-/=?^_`{|}~]+@[A-Z0-9.-]+\.[A-Z]{2,4})\b|\b((?:https?|ftp):\/\/([^\/\s]+)[^\s]*)\b/gi;e[t]=n.replace(r,((e,t,n,r)=>t?"(scrubbed_email)":n&&!c.includes(r)?"(scrubbed_URL)":e))}}return e}function u(e,t,n,r){if(t)switch(e){case i.hB.Generic:return d(t,n);case i.hB.Error:return p(t,n,r);case i.hB.Activity:return f(t,n,r);case i.hB.UserAction:return function(e,t,n){const r=t;if(n){const t=o.getFields(n);e.send({...r,dataFields:t,category:i.hB.UserAction})}else e.send({...r,category:i.hB.UserAction})}(t,n);default:return}}function d(e,t){const n=l(t);e.send({...n,category:i.hB.Generic})}function p(e,t,n){n&&b(t,n);const r=l(t);e.send({...r,category:i.hB.Error}),t.isUserImpacting&&g(e,r)}new Set,new Set,new Map([["Automation",1],["SyntheticTraffic",1],["Local",1],["Staging",1],["Dogfood",.1],["Preview",.1],["Microsoft",.01],["Production",.001],["GCC",0],["GCC-High",0],["DoD",0],["Gallatin",0]]);const h={Automation:!0,SyntheticTraffic:!0,Local:!0,Development:!0,Staging:!0,Dogfood:!0,Preview:!0,Microsoft:!0,Production:!1,GCC:!1,"GCC-High":!1,DoD:!1,USNat:!1,USSec:!1,Gallatin:!1};function f(e,t,n){n&&b(t,n),t.resultType||void 0===t.succeeded||(t.resultType=t.succeeded?i.Tp.Success:i.Tp.Failure);const r=l(t);e.send({...r,category:i.hB.Activity}),t.resultType===i.Tp.Failure&&t.isUserImpacting&&g(e,r)}function g(e,t){let n=e;const r=n.getNamespace?.(),o=`${r}_${t.eventName}`;n=new s.p("ContainerSession",e),n.send({...t,errorAction:o,category:i.hB.Error})}const m=e=>"object"==typeof e&&null!==e;function v(e,t){if(!m(t))return;const n=t[e];return"string"==typeof n?n:void 0}function y(e){const t="string"==typeof e?e:void 0,n=v("errorType",e);return{message:t??v("message",e),errorMessage:t??v("errorMessage",e),errorName:v("name",e),stack:v("stack",e),errorType:n,errorInstanceId:v("errorInstanceId",e)}}function b(e,t){!function(e,t){const n=y(e);if(t.message=n.message??t.message,t.errorMessage=n.errorMessage??t.message,t.errorName=n.errorName,t.stack=n.stack??("string"==typeof t.stack?t.stack:void 0),t.errorType=n.errorType||t.errorType,t.errorInstanceId=n.errorInstanceId,a.forEach((n=>{if(m(e)){const r=e[n];"boolean"!=typeof r&&"number"!=typeof r&&"string"!=typeof r&&void 0!==r||(t[n]=r),"object"==typeof r&&(t[n]=JSON.stringify(r))}})),"object"==typeof e&&e&&"cause"in e){const n=y(e.cause);t.causeMessage=n.message,t.causeStack=n.stack}}(t,e),e.message||(e.message=e.errorMessage),void 0===e.stack&&(e.stack=w())}function w(e){const t=Error.stackTraceLimit;void 0!==e&&(Error.stackTraceLimit=e);let n=(new Error).stack;if(!n)try{throw new Error}catch(e){n=e.stack}return Error.stackTraceLimit=t,n}function S(e){return h[e]}},1274:(e,t,n)=>{"use strict";n.d(t,{p:()=>r});class r{get NamespaceLogger(){return this}get PersistedProperties(){return this}get Disposable(){return this}dispose(){this.logger=null}addPersistedProperties(e){this.persistedProperties={...this.getPersistedProperties(),...e}}getPersistedProperties(){return{...this.baseLogger.PersistedProperties?.getPersistedProperties?.(),...this.persistedProperties}}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){this.logger?.sendWithNamespace({...this.persistedProperties,...e},t)}getNamespace(){return this.namespace}constructor(e,t,n){if(this.namespace=e,t instanceof r){const e={...t.getPersistedProperties(),...n};this.logger=t.logger,this.persistedProperties=e}else this.logger=t,this.persistedProperties=n;this.baseLogger=t}}},1787:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var r=n(488);const o=(e,t)=>{const n=function(e){const{value:t,tag:n}=null!==e&&"object"==typeof e?e:{value:e,tag:void 0};switch(n){case void 0:case"PackageData":case"CodeArtifact":return t;case"UserData":return"REDACTED (tag: UserData)";default:return`REDACTED (tag: ${n})`}}(e);if(void 0!==n)return"string"==typeof n?(0,r.m9)(t,n):"number"==typeof n?(0,r.ip)(t,n):(0,r.LK)(t,n)}},6276:(e,t,n)=>{"use strict";n.d(t,{Fr:()=>l});const r=()=>"undefined"==typeof window;let o,i,s;const a=function(){return void 0===o&&(o=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document),o},c=function(){if(void 0===i){const e=navigator.userAgentData;i=e?.platform?"Android"===e.platform:navigator.userAgent.indexOf("Android")>=0}return i},l=function(){if(r())return!1;if(void 0===s){const e=navigator.userAgentData;if(e?.mobile)return!0;s=/Android|BlackBerry|Windows Phone|IEMobile|Opera Mini|iPhone|iPad|iPod/i.test(navigator.userAgent)||a()||c()}return s}},7137:(e,t,n)=>{"use strict";n.d(t,{y:()=>p,g:()=>h});var r=n(7288);function o(e,t,n){e.headers instanceof Headers?e.headers.set(t,n):e.headers={...e.headers,[t]:n}}const i="Bearer";var s=n(9885),a=n(3788),c=n(8676);var l=n(4738);function u(){return"undefined"!=typeof performance?performance.now():Date.now()}function d(e){return{tenantId:e.tenantId,request:{url:e.url,method:e.requestInit?.method?e.requestInit.method:"GET"}}}function p(e){return g(e,d(e))}function h(e){return g(e,d(e))}const f=3;async function g(e,t,n=1){const l=e.retryPolicy?.maxAuthRetries??f,d=u(),{token:p,authorizationHeader:h}=await e.getToken(t),v=u(),{url:y,requestInit:b,retryPolicy:w,timeoutMs:S,tokenPolicy:C,additionalRequestHeaders:k}=e,{url:E,request:T}=function(e,t,n,s,a){const c=new URL(e),l=s.startsWith(i);let u=!1;l&&a.queryParam&&(c.searchParams.set(a.queryParam,n),u=!a.doNotExceedQueryParamsLength||c.search.length<=a.doNotExceedQueryParamsLength,u||c.searchParams.delete(a.queryParam));let d=t;if(!u){d={...t};let e=!1;if(l){const n=t?.method?t.method.toUpperCase():"GET";if(a.preferAuthorizationInMultipartFormBody&&["GET","POST"].includes(n)){d.method="POST";const i=(0,r.A)(),l=[];l.push(`--${i}`),l.push(`Authorization: ${s}`),l.push(`X-HTTP-Method-Override: ${n}`),l.push("_post: 1"),t?.body&&l.push(`\r\n${t.body}\r\n`),l.push(`\r\n--${i}--`);const u=l.join("\r\n");e=!a.doNotExceedMultipartFormBodyLength||u.length<=a.doNotExceedMultipartFormBodyLength,e&&(d.body=u,o(d,"Content-Type",`multipart/form-data;boundary=${i}`),c.searchParams.set("ump","1"))}}e||o(d,"Authorization",s)}return{url:c.href,request:d}}(y,b,p,h||`${i} ${p}`,C||{});k&&T&&k.forEach(((e,t)=>{!function(e,t,n){if(void 0===e.headers){const r=new Headers;r.set(t,n),e.headers=r}else if(e.headers instanceof Headers)e.headers.has(t)||e.headers.set(t,n);else if(Array.isArray(e.headers)){for(let n=0;n<e.headers.length;n+=1)if(e.headers[n][0]===t)return;e.headers=[...e.headers,[t,n]]}else e.hasOwnProperty("headers")&&(e.headers={[t]:n,...e.headers})}(T,t,e)}));const P=e=>401===e.status&&function(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;return t.split(",").map((e=>{const t=e.split("=");if(t.length>=2)if(r||"error"!==t[0].trim().toLowerCase()){if(!n&&"claims"===t[0].trim().toLowerCase()){const t=(0,c.X)(e.substring(e.indexOf("=")+1).trim());t&&(n=atob(t))}}else r="insufficient_claims"===(0,c.X)(t[1].trim().toLowerCase())})),r?n:void 0}(e.headers)||void 0,N=e=>401===e.status&&void 0!==function(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;for(const e of t.split(",")){const t=e.split("=");t.length>=2&&(r||"error"!==t[0].trim().toLowerCase()?void 0===n&&"error_description"===t[0].trim().toLowerCase()&&(n=(0,c.X)(t[1].trim())):r="invalid_token"===(0,c.X)(t[1].trim().toLowerCase()))}return r?{errorDescription:n}:void 0}(e.headers)||void 0,I=e=>{if(401===e.status){const n=function(e){const t=e.get("www-authenticate");if(!t)return;const n=t.indexOf(i);if(n<0)return;let r;return t.substring(n+i.length).split(",").map((e=>{if(!r){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}(e.headers);if(n&&n!==t.tenantId)return n}};let O,A;if(w&&(O={...w,filter:e=>!P(e)&&!N(e)&&!I(e)&&w.filter(e)}),"logger"in e&&"nameForLogging"in e){const t=async(t,n)=>{const r=await(e.getAdditionalProps?.(t,n));return{tokenFetchDurationMs:Math.round(v-d),...r}};A=await(0,a.R)(E,T,e.nameForLogging,e.logger,e.doNotLogOnSuccess,O,S,t)}else A=await(0,s.J5)(E,T,O,S);if(n<=l){const r=n===l,o=P(A.result);if(o)return m(e,"InsufficientClaims",n,r),g(e,{...t,claims:o,forceRefresh:!0},n+1);if(N(A.result))return m(e,"InvalidToken",n,r),g(e,{...t,forceRefresh:!0},n+1);const i=I(A.result);if(i)return m(e,"SpecificTenant",n,r),g(e,{...t,tenantId:i},n+1)}return A}function m(e,t,n,r){"logger"in e&&"nameForLogging"in e&&(0,l.Ot)(e.logger,{eventName:`Retry${e.nameForLogging}OnAuthError`,subCategory:t,attempt:n,isFinalAttempt:r})}},9277:(e,t,n)=>{"use strict";n.d(t,{u:()=>o});const r=[{headerName:"sprequestguid",logName:"spRequestGuid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"}];function o(e){const t={};return e?.headers&&r.forEach((n=>{const r=e.headers.get(n.headerName);r&&(t[n.logName]=r)})),t}},9602:(e,t,n)=>{"use strict";function r(e){return new URL(e).origin}n.d(t,{$:()=>r})},3788:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});var r=n(9885),o=n(4738);function i(e,t,n,o,i,a,c=0,l){return(0,r.J5)(e,t,a,c).then((async e=>o&&n?((!i&&e.result.ok||!e.result.ok)&&await s(n,!0,e.result,e.tries.length+1,o,l),await Promise.all(e.tries.map((async(e,t)=>await s(n,!1,e,t+1,o,l)))),e):e))}async function s(e,t,n,r,i,s){const a=s&&await s(n,t).catch((()=>({getAdditionalPropsError:!0})));(0,o.Ot)(i,{subCategory:"Request",eventName:e,isFinalAttempt:t,status:n.status,durationMs:n.durationMs,size:n.headers?.get("Content-Length")||-1,attempt:r,...a})}},4411:(e,t,n)=>{"use strict";n.d(t,{OF:()=>c,g2:()=>u});var r=n(9602),o=n(7137),i=n(9277),s=n(8960),a=n(4738);new Map;async function c(e,t,n,r,o,i,s){return l(e,t,n,r,void 0,o,i,s)}async function l(e,t,n,c,l,u,d,p){const h=(0,r.$)(t),f=void 0!==l?`:/${encodeURIComponent(l)}:/`:"",g={getToken:r=>{if(r){const o={...r,siteUrl:t,driveId:n,itemId:c};return e.getToken([`${h}/files.readwrite.all`],o)}throw Error("Options must be specified")},url:`${h}/_api/v2.0/drives/${n}/items/${c}${f}/?select=webUrl,webDavUrl,name,sharepointIds,parentReference`,tenantId:d,requestInit:{method:"GET",signal:p},retryPolicy:s._9,tokenPolicy:(0,s.N$)(e)},m=u?(0,o.g)({...g,logger:u,nameForLogging:"GetFileItemLite",doNotLogOnSuccess:!0,getAdditionalProps:async(e,t)=>(0,i.u)(e)}):(0,o.y)(g);let v;try{v=(await m).result}catch{}if(v?.ok)try{return await v.json()}catch(e){u&&(0,a.hO)(u,{eventName:"GetFileItemLiteResponseParseError"},e)}}const u=e=>"driveId"in e&&"siteUrl"in e&&"itemId"in e},8960:(e,t,n)=>{"use strict";n.d(t,{N$:()=>c,_9:()=>i});var r=n(2777),o=n(9885);const i={maxRetries:2,backoffFn:(0,r.FT)(500),filter:(0,o.sC)([408,409,503]),respectRetryAfterHeader:!0},s={queryParam:"access_token",doNotExceedQueryParamsLength:2048,preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920},a={preferAuthorizationInMultipartFormBody:!0,doNotExceedMultipartFormBodyLength:81920};function c(e,t=!0){return{..."Consumer"===e.identityType?a:s,preferAuthorizationInMultipartFormBody:t}}},8676:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var r=n(4738);function o(e,t,n){try{return JSON.parse(e,t)}catch(e){return void(n&&(0,r.hO)(n.logger,n.event,e))}}},5312:(e,t,n)=>{"use strict";n.d(t,{AU:()=>u});var r=n(8676),o=n(4225),i=n(7639);const s=new Map;function a(e,t){const n=function(e,t){const n=s.get(e);if(void 0!==n)return n;let r,a,l,u;u=void 0!==(r=function(e){const t=i.f.get(e);return c(t)}(e))?r:void 0!==(a=function(e){const t=(0,o.Ar)()?.getItem(e);return c(t)}(e))?a:void 0!==(l=function(e){const t=(0,o.RY)()?.getItem(e);return c(t)}(e))?l:t;return s.set(e,u),u}(e,t);return n}function c(e){if(null!=e){const t=(0,r.X)(e),n=void 0!==t?t:e;return"on"===n||"off"===n?"on"===n:n}}function l(e,t,n,r){return n?n.getSetting(e,t,r):a(e,t)}const u=(e,t,n)=>l(e,t,n,"FluidExperiences")},4225:(e,t,n)=>{"use strict";let r,o;n.d(t,{Ar:()=>i,RY:()=>s});try{localStorage.getItem("__storage_test__"),r=localStorage}catch{r=void 0}try{sessionStorage.getItem("__storage_test__"),o=sessionStorage}catch{o=void 0}function i(){return r}function s(){return o}},7639:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});const r=new URLSearchParams("undefined"!=typeof location?location.search:"")},5927:(e,t,n)=>{"use strict";n.d(t,{EW:()=>f,Il:()=>u,KJ:()=>d,Kz:()=>b,Nn:()=>m,OD:()=>c,ay:()=>h,qw:()=>g,rh:()=>p});var r=n(488);function o(e,t){return e?e+"."+t:t}function i(e,t,n,i,s){void 0===s&&(s=4),i&&e.push((0,r.m9)("".concat(o(t,n)),i,s))}function s(e,t,n,i){"boolean"==typeof i&&e.push((0,r.LK)("".concat(o(t,n)),i))}function a(e,t,n,i){"number"==typeof i&&e.push((0,r.Ug)("".concat(o(t,n)),i))}var c,l=function(e){var t="Activity.Result",n=[];return a(n,t,"Code",e.code),i(n,t,"Type",e.type),a(n,t,"Tag",e.tag),s(n,t,"IsExpected",e.isExpected),n.push((0,r.m9)("zC.Activity.Result","Office.System.Result")),n},u={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return i(n,t,"CV",e.cV),a(n,t,"Duration",e.duration),a(n,t,"Count",e.count),a(n,t,"AggMode",e.aggMode),s(n,t,"Success",e.success),e.result&&n.push.apply(n,l(e.result)),n.push((0,r.m9)("zC.Activity",this.contractName)),n}},d={getFields:function(e){var t="User",n=[];return i(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),i(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),i(n,t,"TenantId",e.tenantId,1),i(n,t,"TenantGroup",e.tenantGroup,1),s(n,t,"IsAnonymous",e.isAnonymous),s(n,t,"IsSignedIn",e.isSignedIn),n}},p={getFields:function(e,t){var n=[];return i(n,e,"Name",t.name),i(n,e,"State",t.state),n}},h={getFields:function(e){var t="UserAction",n=[];return a(n,t,"Id",e.id),i(n,t,"Name",e.name),i(n,t,"CommandSurface",e.commandSurface),i(n,t,"ParentName",e.parentName),i(n,t,"TriggerMethod",e.triggerMethod),a(n,t,"TimeOffsetMs",e.timeOffsetMs),n}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(c||(c={}));var f,g={getFields:function(e){var t="App",n=[];return i(n,t,"Name",e.name,1),i(n,t,"Platform",e.platform,1),i(n,t,"Version",e.version,1),n}},m={getFields:function(e){var t="Session",n=[];return i(n,t,"Id",e.id,1),i(n,t,"EcsETag",e.ecsETag,1),n}};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(f||(f={}));var v,y,b={getFields:function(e){var t=[];return i(t,"Release","AudienceGroup",e.audienceGroup,1),t}};!function(e){var t="Copilot";!function(e){e.IsEnabled="IsEnabled",e.IsSeen="IsSeen",e.IsTried="IsTried",e.IsKept="IsKept",e.IsRejected="IsRejected"}(e.FeatureActionType||(e.FeatureActionType={})),function(e){e.ContentGeneration="Content Generation",e.Commanding="Commanding",e.QAandSummaries="QA and Summaries",e.Collaboration="Collaboration",e.Suggestions="Suggestions"}(e.Capability||(e.Capability={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(e.EntryPoint||(e.EntryPoint={})),function(e){e.Create="Create",e.Command="Command",e.Ask="Ask",e.Summarize="Summarize",e.Share="Share",e.Analyze="Analyze"}(e.Verb||(e.Verb={})),e.getFields=function(e){var n=[];return i(n,t,"FeatureActionType",e.featureActionType),s(n,t,"IsUserInitiated",e.isUserInitiated),i(n,t,"FeatureName",e.featureName),i(n,t,"SubFeatureName",e.subFeatureName),i(n,t,"Capability",e.capability),s(n,t,"IsThumbsUp",e.isThumbsUp),i(n,t,"EntryPoint",e.entryPoint),i(n,t,"Verb",e.verb),i(n,t,"InteractionId",e.interactionId),i(n,t,"ConversationId",e.conversationId),n.push((0,r.m9)("zC.".concat(t),"Office.System.Copilot")),n}}(v||(v={})),function(e){var t="Asha";!function(e){e.Pillar="Pillar",e.Error="Error"}(e.EventType||(e.EventType={})),e.getFields=function(e){var n=[];return i(n,t,"EventType",e.eventType),i(n,t,"Pillar",e.pillar),i(n,t,"Scenario",e.scenario),i(n,t,"Veto",e.veto),i(n,t,"Error",e.error),s(n,t,"InStaging",e.inStaging),s(n,t,"IsSessionEndingError",e.isSessionEndingError),s(n,t,"IsIntentional",e.isIntentional),s(n,t,"IsInternal",e.isInternal),n.push((0,r.m9)("zC.".concat(t),"Office.System.Asha")),n}}(y||(y={}))},488:(e,t,n)=>{"use strict";function r(e,t,n){return a(e,1,t,n)}function o(e,t,n){return a(e,2,t,n)}function i(e,t,n){return a(e,3,t,n)}function s(e,t,n){return a(e,0,t,n)}function a(e,t,n,r){return{name:e,dataType:t,value:n,classification:r||4}}n.d(t,{LK:()=>r,Ug:()=>o,ip:()=>i,m9:()=>s})},8170:(e,t,n)=>{"use strict";n.d(t,{d$:()=>i,vV:()=>a,wC:()=>s});var r,o=(r=[],{fireEvent:function(e){r.forEach((function(t){return t(e)}))},addListener:function(e){e&&r.push(e)}});function i(){return o}function s(e,t,n){o.fireEvent({level:e,category:t,message:n})}function a(e,t,n){s(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}},5738:(e,t,n)=>{"use strict";n.d(t,{GV:()=>b,di:()=>v,EY:()=>y});var r=n(2065),o=n(8170),i={};function s(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?i[e]?(t.ariaTenantToken&&(i[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(i[e].dnmToken=t.dnmToken)):i[e]=t:(0,o.wC)(0,0,(function(){return"Namespace: ".concat(e)}))}function a(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(i[r]){var o=i[r];return t.ariaTenantToken=o.ariaTenantToken,t.dnmToken=o.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var c=9007199254740991,l=-c,u=98,d=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,p=/^[a-zA-Z0-9_\.]{1,95}$/;function h(e){if(!function(e){if(!e||e.length>u)return!1;return d.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!f(t.name))throw new Error("Invalid eventContract");g(t.dataFields)}g(e.dataFields)}function f(e){return p.test(e)}function g(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!f(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<l||e>c)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var m=n(488),v=-1;function y(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,r.Cl)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var b=function(){function e(e,t,n){var o,i,s;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(o=this.persistentDataFields).push.apply(o,e.persistentDataFields),this.config=(0,r.Cl)((0,r.Cl)({},e.getConfig()),this.config),(i=this.partAFields).push.apply(i,e.partAFields)),t&&(s=this.persistentDataFields).push.apply(s,t)}return e.prototype.addEventContentType=function(e,t){e.push((0,m.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=y(e),n=t.telemetryProperties;n.nexusTenantToken=v;var r=n.ariaTenantToken;if(!r&&(!a(t.eventName,n)&&!r))return void(0,o.wC)(0,0,(function(){return"No tenant token: "+e.eventName}));this.sendTelemetryEventInternal(t,1)},e.prototype.sendNonStandardEvent=function(e,t){var n=y(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=y(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=y(e),n=t.telemetryProperties;if(!n.dnmToken&&(!a(t.eventName,n)&&!n.dnmToken))return void(0,o.wC)(0,0,(function(){return"No dnm token: "+t.eventName}));this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):(0,o.wC)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void(0,o.vV)(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else(0,o.wC)(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,r,o;if(e.dataFields&&(null===(o=e.dataFields)||void 0===o||o.unshift((0,m.m9)("OTelJS.Version","4.20.30")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var i=e.eventContract||{name:"",dataFields:[]};(r=i.dataFields).push.apply(r,this.partAFields),e.eventContract=i}this.config.disableValidation||h(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],o=r[0],i=r[1];this.sendTelemetryEventInternal(o,i)}},e.prototype.setTenantToken=function(e,t,n){s(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){s(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return y(e)},e.prototype.getConfig=function(){return this.config},e}()},1575:(e,t,n)=>{"use strict";var r=n(7131),o=n(9307);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,s=void 0,s=function(e,t){if("object"!==i(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===i(s)?s:String(s)),r)}var o,s}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var c,l,u=n(9748).codes,d=u.ERR_AMBIGUOUS_ARGUMENT,p=u.ERR_INVALID_ARG_TYPE,h=u.ERR_INVALID_ARG_VALUE,f=u.ERR_INVALID_RETURN_VALUE,g=u.ERR_MISSING_ARGS,m=n(3155),v=n(1747).inspect,y=n(1747).types,b=y.isPromise,w=y.isRegExp,S=n(7072)(),C=n(1140)(),k=n(715)("RegExp.prototype.test");new Map;function E(){var e=n(4818);c=e.isDeepEqual,l=e.isDeepStrictEqual}var T=!1,P=e.exports=A,N={};function I(e){if(e.message instanceof Error)throw e.message;throw new m(e)}function O(e,t,n,r){if(!n){var o=!1;if(0===t)o=!0,r="No value argument passed to `assert.ok()`";else if(r instanceof Error)throw r;var i=new m({actual:n,expected:!0,message:r,operator:"==",stackStartFn:e});throw i.generatedMessage=o,i}}function A(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];O.apply(void 0,[A,t.length].concat(t))}P.fail=function e(t,n,i,s,a){var c,l=arguments.length;if(0===l)c="Failed";else if(1===l)i=t,t=void 0;else{if(!1===T)T=!0,(r.emitWarning?r.emitWarning:o.warn.bind(o))("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094");2===l&&(s="!=")}if(i instanceof Error)throw i;var u={actual:t,expected:n,operator:void 0===s?"fail":s,stackStartFn:a||e};void 0!==i&&(u.message=i);var d=new m(u);throw c&&(d.message=c,d.generatedMessage=!0),d},P.AssertionError=m,P.ok=A,P.equal=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");t!=n&&I({actual:t,expected:n,message:r,operator:"==",stackStartFn:e})},P.notEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");t==n&&I({actual:t,expected:n,message:r,operator:"!=",stackStartFn:e})},P.deepEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");void 0===c&&E(),c(t,n)||I({actual:t,expected:n,message:r,operator:"deepEqual",stackStartFn:e})},P.notDeepEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");void 0===c&&E(),c(t,n)&&I({actual:t,expected:n,message:r,operator:"notDeepEqual",stackStartFn:e})},P.deepStrictEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");void 0===c&&E(),l(t,n)||I({actual:t,expected:n,message:r,operator:"deepStrictEqual",stackStartFn:e})},P.notDeepStrictEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");void 0===c&&E();l(t,n)&&I({actual:t,expected:n,message:r,operator:"notDeepStrictEqual",stackStartFn:e})},P.strictEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");C(t,n)||I({actual:t,expected:n,message:r,operator:"strictEqual",stackStartFn:e})},P.notStrictEqual=function e(t,n,r){if(arguments.length<2)throw new g("actual","expected");C(t,n)&&I({actual:t,expected:n,message:r,operator:"notStrictEqual",stackStartFn:e})};var L=a((function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.forEach((function(e){e in t&&(void 0!==r&&"string"==typeof r[e]&&w(t[e])&&k(t[e],r[e])?o[e]=r[e]:o[e]=t[e])}))}));function F(e,t,n,r){if("function"!=typeof t){if(w(t))return k(t,e);if(2===arguments.length)throw new p("expected",["Function","RegExp"],t);if("object"!==i(e)||null===e){var o=new m({actual:e,expected:t,message:n,operator:"deepStrictEqual",stackStartFn:r});throw o.operator=r.name,o}var s=Object.keys(t);if(t instanceof Error)s.push("name","message");else if(0===s.length)throw new h("error",t,"may not be an empty object");return void 0===c&&E(),s.forEach((function(o){"string"==typeof e[o]&&w(t[o])&&k(t[o],e[o])||function(e,t,n,r,o,i){if(!(n in e)||!l(e[n],t[n])){if(!r){var s=new L(e,o),a=new L(t,o,e),c=new m({actual:s,expected:a,operator:"deepStrictEqual",stackStartFn:i});throw c.actual=e,c.expected=t,c.operator=i.name,c}I({actual:e,expected:t,message:r,operator:i.name,stackStartFn:i})}}(e,t,o,n,s,r)})),!0}return void 0!==t.prototype&&e instanceof t||!Error.isPrototypeOf(t)&&!0===t.call({},e)}function D(e){if("function"!=typeof e)throw new p("fn","Function",e);try{e()}catch(e){return e}return N}function x(e){return b(e)||null!==e&&"object"===i(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function R(e){return Promise.resolve().then((function(){var t;if("function"==typeof e){if(!x(t=e()))throw new f("instance of Promise","promiseFn",t)}else{if(!x(e))throw new p("promiseFn",["Function","Promise"],e);t=e}return Promise.resolve().then((function(){return t})).then((function(){return N})).catch((function(e){return e}))}))}function M(e,t,n,r){if("string"==typeof n){if(4===arguments.length)throw new p("error",["Object","Error","Function","RegExp"],n);if("object"===i(t)&&null!==t){if(t.message===n)throw new d("error/message",'The error message "'.concat(t.message,'" is identical to the message.'))}else if(t===n)throw new d("error/message",'The error "'.concat(t,'" is identical to the message.'));r=n,n=void 0}else if(null!=n&&"object"!==i(n)&&"function"!=typeof n)throw new p("error",["Object","Error","Function","RegExp"],n);if(t===N){var o="";n&&n.name&&(o+=" (".concat(n.name,")")),o+=r?": ".concat(r):".";var s="rejects"===e.name?"rejection":"exception";I({actual:void 0,expected:n,operator:e.name,message:"Missing expected ".concat(s).concat(o),stackStartFn:e})}if(n&&!F(t,n,r,e))throw t}function _(e,t,n,r){if(t!==N){if("string"==typeof n&&(r=n,n=void 0),!n||F(t,n)){var o=r?": ".concat(r):".",i="doesNotReject"===e.name?"rejection":"exception";I({actual:t,expected:n,operator:e.name,message:"Got unwanted ".concat(i).concat(o,"\n")+'Actual message: "'.concat(t&&t.message,'"'),stackStartFn:e})}throw t}}function U(e,t,n,r,o){if(!w(t))throw new p("regexp","RegExp",t);var s="match"===o;if("string"!=typeof e||k(t,e)!==s){if(n instanceof Error)throw n;var a=!n;n=n||("string"!=typeof e?'The "string" argument must be of type string. Received type '+"".concat(i(e)," (").concat(v(e),")"):(s?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(v(t),". Input:\n\n").concat(v(e),"\n"));var c=new m({actual:e,expected:t,message:n,operator:o,stackStartFn:r});throw c.generatedMessage=a,c}}function j(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];O.apply(void 0,[j,t.length].concat(t))}P.throws=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];M.apply(void 0,[e,D(t)].concat(r))},P.rejects=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return R(t).then((function(t){return M.apply(void 0,[e,t].concat(r))}))},P.doesNotThrow=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];_.apply(void 0,[e,D(t)].concat(r))},P.doesNotReject=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return R(t).then((function(t){return _.apply(void 0,[e,t].concat(r))}))},P.ifError=function e(t){if(null!=t){var n="ifError got unwanted exception: ";"object"===i(t)&&"string"==typeof t.message?0===t.message.length&&t.constructor?n+=t.constructor.name:n+=t.message:n+=v(t);var r=new m({actual:t,expected:null,operator:"ifError",message:n,stackStartFn:e}),o=t.stack;if("string"==typeof o){var s=o.split("\n");s.shift();for(var a=r.stack.split("\n"),c=0;c<s.length;c++){var l=a.indexOf(s[c]);if(-1!==l){a=a.slice(0,l);break}}r.stack="".concat(a.join("\n"),"\n").concat(s.join("\n"))}throw r}},P.match=function e(t,n,r){U(t,n,r,e,"match")},P.doesNotMatch=function e(t,n,r){U(t,n,r,e,"doesNotMatch")},P.strict=S(j,P,{equal:P.strictEqual,deepEqual:P.deepStrictEqual,notEqual:P.notStrictEqual,notDeepEqual:P.notDeepStrictEqual}),P.strict.strict=P.strict},3155:(e,t,n)=>{"use strict";var r=n(7131);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var t=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===m(t)?t:String(t)}function l(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){var t="function"==typeof Map?new Map:void 0;return d=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return p(e,arguments,g(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)},d(e)}function p(e,t,n){return p=h()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&f(o,n.prototype),o},p.apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}var v=n(1747).inspect,y=n(9748).codes.ERR_INVALID_ARG_TYPE;function b(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}var w="",S="",C="",k="",E={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"};function T(e){var t=Object.keys(e),n=Object.create(Object.getPrototypeOf(e));return t.forEach((function(t){n[t]=e[t]})),Object.defineProperty(n,"message",{value:e.message}),n}function P(e){return v(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function N(e,t,n){var o="",i="",s=0,a="",c=!1,l=P(e),u=l.split("\n"),d=P(t).split("\n"),p=0,h="";if("strictEqual"===n&&"object"===m(e)&&"object"===m(t)&&null!==e&&null!==t&&(n="strictEqualObject"),1===u.length&&1===d.length&&u[0]!==d[0]){var f=u[0].length+d[0].length;if(f<=10){if(!("object"===m(e)&&null!==e||"object"===m(t)&&null!==t||0===e&&0===t))return"".concat(E[n],"\n\n")+"".concat(u[0]," !== ").concat(d[0],"\n")}else if("strictEqualObject"!==n){if(f<(r.stderr&&r.stderr.isTTY?r.stderr.columns:80)){for(;u[0][p]===d[0][p];)p++;p>2&&(h="\n  ".concat(function(e,t){if(t=Math.floor(t),0==e.length||0==t)return"";var n=e.length*t;for(t=Math.floor(Math.log(t)/Math.log(2));t;)e+=e,t--;return e+e.substring(0,n-e.length)}(" ",p),"^"),p=0)}}}for(var g=u[u.length-1],v=d[d.length-1];g===v&&(p++<2?a="\n  ".concat(g).concat(a):o=g,u.pop(),d.pop(),0!==u.length&&0!==d.length);)g=u[u.length-1],v=d[d.length-1];var y=Math.max(u.length,d.length);if(0===y){var T=l.split("\n");if(T.length>30)for(T[26]="".concat(w,"...").concat(k);T.length>27;)T.pop();return"".concat(E.notIdentical,"\n\n").concat(T.join("\n"),"\n")}p>3&&(a="\n".concat(w,"...").concat(k).concat(a),c=!0),""!==o&&(a="\n  ".concat(o).concat(a),o="");var N=0,I=E[n]+"\n".concat(S,"+ actual").concat(k," ").concat(C,"- expected").concat(k),O=" ".concat(w,"...").concat(k," Lines skipped");for(p=0;p<y;p++){var A=p-s;if(u.length<p+1)A>1&&p>2&&(A>4?(i+="\n".concat(w,"...").concat(k),c=!0):A>3&&(i+="\n  ".concat(d[p-2]),N++),i+="\n  ".concat(d[p-1]),N++),s=p,o+="\n".concat(C,"-").concat(k," ").concat(d[p]),N++;else if(d.length<p+1)A>1&&p>2&&(A>4?(i+="\n".concat(w,"...").concat(k),c=!0):A>3&&(i+="\n  ".concat(u[p-2]),N++),i+="\n  ".concat(u[p-1]),N++),s=p,i+="\n".concat(S,"+").concat(k," ").concat(u[p]),N++;else{var L=d[p],F=u[p],D=F!==L&&(!b(F,",")||F.slice(0,-1)!==L);D&&b(L,",")&&L.slice(0,-1)===F&&(D=!1,F+=","),D?(A>1&&p>2&&(A>4?(i+="\n".concat(w,"...").concat(k),c=!0):A>3&&(i+="\n  ".concat(u[p-2]),N++),i+="\n  ".concat(u[p-1]),N++),s=p,i+="\n".concat(S,"+").concat(k," ").concat(F),o+="\n".concat(C,"-").concat(k," ").concat(L),N+=2):(i+=o,o="",1!==A&&0!==p||(i+="\n  ".concat(F),N++))}if(N>20&&p<y-2)return"".concat(I).concat(O,"\n").concat(i,"\n").concat(w,"...").concat(k).concat(o,"\n")+"".concat(w,"...").concat(k)}return"".concat(I).concat(c?O:"","\n").concat(i).concat(o).concat(a).concat(h)}var I=function(e,t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}(b,e);var n,o,s,c,d,p=(n=b,o=h(),function(){var e,t=g(n);if(o){var r=g(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return l(this,e)});function b(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),"object"!==m(e)||null===e)throw new y("options","Object",e);var n=e.message,o=e.operator,i=e.stackStartFn,s=e.actual,a=e.expected,c=Error.stackTraceLimit;if(Error.stackTraceLimit=0,null!=n)t=p.call(this,String(n));else if(r.stderr&&r.stderr.isTTY&&(r.stderr&&r.stderr.getColorDepth&&1!==r.stderr.getColorDepth()?(w="[34m",S="[32m",k="[39m",C="[31m"):(w="",S="",k="",C="")),"object"===m(s)&&null!==s&&"object"===m(a)&&null!==a&&"stack"in s&&s instanceof Error&&"stack"in a&&a instanceof Error&&(s=T(s),a=T(a)),"deepStrictEqual"===o||"strictEqual"===o)t=p.call(this,N(s,a,o));else if("notDeepStrictEqual"===o||"notStrictEqual"===o){var d=E[o],h=P(s).split("\n");if("notStrictEqual"===o&&"object"===m(s)&&null!==s&&(d=E.notStrictEqualObject),h.length>30)for(h[26]="".concat(w,"...").concat(k);h.length>27;)h.pop();t=1===h.length?p.call(this,"".concat(d," ").concat(h[0])):p.call(this,"".concat(d,"\n\n").concat(h.join("\n"),"\n"))}else{var f=P(s),g="",v=E[o];"notDeepEqual"===o||"notEqual"===o?(f="".concat(E[o],"\n\n").concat(f)).length>1024&&(f="".concat(f.slice(0,1021),"...")):(g="".concat(P(a)),f.length>512&&(f="".concat(f.slice(0,509),"...")),g.length>512&&(g="".concat(g.slice(0,509),"...")),"deepEqual"===o||"equal"===o?f="".concat(v,"\n\n").concat(f,"\n\nshould equal\n\n"):g=" ".concat(o," ").concat(g)),t=p.call(this,"".concat(f).concat(g))}return Error.stackTraceLimit=c,t.generatedMessage=!n,Object.defineProperty(u(t),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),t.code="ERR_ASSERTION",t.actual=s,t.expected=a,t.operator=o,Error.captureStackTrace&&Error.captureStackTrace(u(t),i),t.stack,t.name="AssertionError",l(t)}return s=b,(c=[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:t,value:function(e,t){return v(this,i(i({},t),{},{customInspect:!1,depth:0}))}}])&&a(s.prototype,c),d&&a(s,d),Object.defineProperty(s,"prototype",{writable:!1}),b}(d(Error),v.custom);e.exports=I},9748:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(i=o.key,s=void 0,s=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===r(s)?s:String(s)),o)}var i,s}function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=a(e);if(t){var i=a(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}var c,l,u={};function d(e,t,n){n||(n=Error);var r=function(n){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(u,n);var r,a,c,l=s(u);function u(n,r,o){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i=l.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,o)),i.code=e,i}return r=u,a&&o(r.prototype,a),c&&o(r,c),Object.defineProperty(r,"prototype",{writable:!1}),r}(n);u[e]=r}function p(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}d("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),d("ERR_INVALID_ARG_TYPE",(function(e,t,o){var i,s,a,l;if(void 0===c&&(c=n(1575)),c("string"==typeof e,"'name' must be a string"),"string"==typeof t&&(s="not ",t.substr(!a||a<0?0:+a,s.length)===s)?(i="must not be",t=t.replace(/^not /,"")):i="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))l="The ".concat(e," ").concat(i," ").concat(p(t,"type"));else{var u=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";l='The "'.concat(e,'" ').concat(u," ").concat(i," ").concat(p(t,"type"))}return l+=". Received type ".concat(r(o))}),TypeError),d("ERR_INVALID_ARG_VALUE",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid";void 0===l&&(l=n(1747));var o=l.inspect(t);return o.length>128&&(o="".concat(o.slice(0,128),"...")),"The argument '".concat(e,"' ").concat(r,". Received ").concat(o)}),TypeError,RangeError),d("ERR_INVALID_RETURN_VALUE",(function(e,t,n){var o;return o=n&&n.constructor&&n.constructor.name?"instance of ".concat(n.constructor.name):"type ".concat(r(n)),"Expected ".concat(e,' to be returned from the "').concat(t,'"')+" function but got ".concat(o,".")}),TypeError),d("ERR_MISSING_ARGS",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];void 0===c&&(c=n(1575)),c(t.length>0,"At least one arg needs to be specified");var o="The ",i=t.length;switch(t=t.map((function(e){return'"'.concat(e,'"')})),i){case 1:o+="".concat(t[0]," argument");break;case 2:o+="".concat(t[0]," and ").concat(t[1]," arguments");break;default:o+=t.slice(0,i-1).join(", "),o+=", and ".concat(t[i-1]," arguments")}return"".concat(o," must be specified")}),TypeError),e.exports.codes=u},4818:(e,t,n)=>{"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,s,a=[],c=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}var s=void 0!==/a/g.flags,a=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),t},c=function(e){var t=[];return e.forEach((function(e,n){return t.push([n,e])})),t},l=Object.is?Object.is:n(6991),u=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},d=Number.isNaN?Number.isNaN:n(4307);function p(e){return e.call.bind(e)}var h=p(Object.prototype.hasOwnProperty),f=p(Object.prototype.propertyIsEnumerable),g=p(Object.prototype.toString),m=n(1747).types,v=m.isAnyArrayBuffer,y=m.isArrayBufferView,b=m.isDate,w=m.isMap,S=m.isRegExp,C=m.isSet,k=m.isNativeError,E=m.isBoxedPrimitive,T=m.isNumberObject,P=m.isStringObject,N=m.isBooleanObject,I=m.isBigIntObject,O=m.isSymbolObject,A=m.isFloat32Array,L=m.isFloat64Array;function F(e){if(0===e.length||e.length>10)return!0;for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n<48||n>57)return!0}return 10===e.length&&e>=Math.pow(2,32)}function D(e){return Object.keys(e).filter(F).concat(u(e).filter(Object.prototype.propertyIsEnumerable.bind(e)))}function x(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0}var R=0,M=1,_=2,U=3;function j(e,t,n,r){if(e===t)return 0!==e||(!n||l(e,t));if(n){if("object"!==i(e))return"number"==typeof e&&d(e)&&d(t);if("object"!==i(t)||null===e||null===t)return!1;if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1}else{if(null===e||"object"!==i(e))return(null===t||"object"!==i(t))&&e==t;if(null===t||"object"!==i(t))return!1}var o,a,c,u,p=g(e);if(p!==g(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;var h=D(e),f=D(t);return h.length===f.length&&q(e,t,n,r,M,h)}if("[object Object]"===p&&(!w(e)&&w(t)||!C(e)&&C(t)))return!1;if(b(e)){if(!b(t)||Date.prototype.getTime.call(e)!==Date.prototype.getTime.call(t))return!1}else if(S(e)){if(!S(t)||(c=e,u=t,!(s?c.source===u.source&&c.flags===u.flags:RegExp.prototype.toString.call(c)===RegExp.prototype.toString.call(u))))return!1}else if(k(e)||e instanceof Error){if(e.message!==t.message||e.name!==t.name)return!1}else{if(y(e)){if(n||!A(e)&&!L(e)){if(!function(e,t){return e.byteLength===t.byteLength&&0===x(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}(e,t))return!1}else if(!function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(e,t))return!1;var m=D(e),F=D(t);return m.length===F.length&&q(e,t,n,r,R,m)}if(C(e))return!(!C(t)||e.size!==t.size)&&q(e,t,n,r,_);if(w(e))return!(!w(t)||e.size!==t.size)&&q(e,t,n,r,U);if(v(e)){if(a=t,(o=e).byteLength!==a.byteLength||0!==x(new Uint8Array(o),new Uint8Array(a)))return!1}else if(E(e)&&!function(e,t){return T(e)?T(t)&&l(Number.prototype.valueOf.call(e),Number.prototype.valueOf.call(t)):P(e)?P(t)&&String.prototype.valueOf.call(e)===String.prototype.valueOf.call(t):N(e)?N(t)&&Boolean.prototype.valueOf.call(e)===Boolean.prototype.valueOf.call(t):I(e)?I(t)&&BigInt.prototype.valueOf.call(e)===BigInt.prototype.valueOf.call(t):O(t)&&Symbol.prototype.valueOf.call(e)===Symbol.prototype.valueOf.call(t)}(e,t))return!1}return q(e,t,n,r,R)}function z(e,t){return t.filter((function(t){return f(e,t)}))}function q(e,t,n,o,s,l){if(5===arguments.length){l=Object.keys(e);var d=Object.keys(t);if(l.length!==d.length)return!1}for(var p=0;p<l.length;p++)if(!h(t,l[p]))return!1;if(n&&5===arguments.length){var g=u(e);if(0!==g.length){var m=0;for(p=0;p<g.length;p++){var v=g[p];if(f(e,v)){if(!f(t,v))return!1;l.push(v),m++}else if(f(t,v))return!1}var y=u(t);if(g.length!==y.length&&z(t,y).length!==m)return!1}else{var b=u(t);if(0!==b.length&&0!==z(t,b).length)return!1}}if(0===l.length&&(s===R||s===M&&0===e.length||0===e.size))return!0;if(void 0===o)o={val1:new Map,val2:new Map,position:0};else{var w=o.val1.get(e);if(void 0!==w){var S=o.val2.get(t);if(void 0!==S)return w===S}o.position++}o.val1.set(e,o.position),o.val2.set(t,o.position);var C=function(e,t,n,o,s,l){var u=0;if(l===_){if(!function(e,t,n,r){for(var o=null,s=a(e),c=0;c<s.length;c++){var l=s[c];if("object"===i(l)&&null!==l)null===o&&(o=new Set),o.add(l);else if(!t.has(l)){if(n)return!1;if(!H(e,t,l))return!1;null===o&&(o=new Set),o.add(l)}}if(null!==o){for(var u=a(t),d=0;d<u.length;d++){var p=u[d];if("object"===i(p)&&null!==p){if(!B(o,p,n,r))return!1}else if(!n&&!e.has(p)&&!B(o,p,n,r))return!1}return 0===o.size}return!0}(e,t,n,s))return!1}else if(l===U){if(!function(e,t,n,o){for(var s=null,a=c(e),l=0;l<a.length;l++){var u=r(a[l],2),d=u[0],p=u[1];if("object"===i(d)&&null!==d)null===s&&(s=new Set),s.add(d);else{var h=t.get(d);if(void 0===h&&!t.has(d)||!j(p,h,n,o)){if(n)return!1;if(!W(e,t,d,p,o))return!1;null===s&&(s=new Set),s.add(d)}}}if(null!==s){for(var f=c(t),g=0;g<f.length;g++){var m=r(f[g],2),v=m[0],y=m[1];if("object"===i(v)&&null!==v){if(!V(s,e,v,y,n,o))return!1}else if(!(n||e.has(v)&&j(e.get(v),y,!1,o)||V(s,e,v,y,!1,o)))return!1}return 0===s.size}return!0}(e,t,n,s))return!1}else if(l===M)for(;u<e.length;u++){if(!h(e,u)){if(h(t,u))return!1;for(var d=Object.keys(e);u<d.length;u++){var p=d[u];if(!h(t,p)||!j(e[p],t[p],n,s))return!1}return d.length===Object.keys(t).length}if(!h(t,u)||!j(e[u],t[u],n,s))return!1}for(u=0;u<o.length;u++){var f=o[u];if(!j(e[f],t[f],n,s))return!1}return!0}(e,t,n,l,o,s);return o.val1.delete(e),o.val2.delete(t),C}function B(e,t,n,r){for(var o=a(e),i=0;i<o.length;i++){var s=o[i];if(j(t,s,n,r))return e.delete(s),!0}return!1}function $(e){switch(i(e)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(d(e))return!1}return!0}function H(e,t,n){var r=$(n);return null!=r?r:t.has(r)&&!e.has(r)}function W(e,t,n,r,o){var i=$(n);if(null!=i)return i;var s=t.get(i);return!(void 0===s&&!t.has(i)||!j(r,s,!1,o))&&(!e.has(i)&&j(r,s,!1,o))}function V(e,t,n,r,o,i){for(var s=a(e),c=0;c<s.length;c++){var l=s[c];if(j(n,l,o,i)&&j(r,t.get(l),o,i))return e.delete(l),!0}return!1}e.exports={isDeepEqual:function(e,t){return j(e,t,false)},isDeepStrictEqual:function(e,t){return j(e,t,true)}}},3499:(e,t)=>{"use strict";t.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=a(e),s=i[0],c=i[1],l=new o(function(e,t,n){return 3*(t+n)/4-n}(0,s,c)),u=0,d=c>0?s-4:s;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,l[u++]=255&t);1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t);return l},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],s=16383,a=0,l=r-o;a<l;a+=s)i.push(c(e,a,a+s>l?l:a+s));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=i[s],r[i.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var o,i,s=[],a=t;a<r;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(i=o)>>18&63]+n[i>>12&63]+n[i>>6&63]+n[63&i]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},715:(e,t,n)=>{"use strict";var r=n(7216),o=n(9527),i=o(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&i(e,".prototype.")>-1?o(n):n}},9527:(e,t,n)=>{"use strict";var r=n(2790),o=n(7216),i=n(6650),s=n(9230),a=o("%Function.prototype.apply%"),c=o("%Function.prototype.call%"),l=o("%Reflect.apply%",!0)||r.call(c,a),u=n(7779),d=o("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new s("a function is required");var t=l(r,c,arguments);return i(t,1+d(0,e.length-(arguments.length-1)),!0)};var p=function(){return l(r,a,arguments)};u?u(e.exports,"apply",{value:p}):e.exports.apply=p},9307:(e,t,n)=>{var r=n(1747),o=n(1575);function i(){return(new Date).getTime()}var s,a=Array.prototype.slice,c={};s=void 0!==n.g&&n.g.console?n.g.console:"undefined"!=typeof window&&window.console?window.console:{};for(var l=[[function(){},"log"],[function(){s.log.apply(s,arguments)},"info"],[function(){s.log.apply(s,arguments)},"warn"],[function(){s.warn.apply(s,arguments)},"error"],[function(e){c[e]=i()},"time"],[function(e){var t=c[e];if(!t)throw new Error("No such label: "+e);delete c[e];var n=i()-t;s.log(e+": "+n+"ms")},"timeEnd"],[function(){var e=new Error;e.name="Trace",e.message=r.format.apply(null,arguments),s.error(e.stack)},"trace"],[function(e){s.log(r.inspect(e)+"\n")},"dir"],[function(e){if(!e){var t=a.call(arguments,1);o.ok(!1,r.format.apply(null,t))}},"assert"]],u=0;u<l.length;u++){var d=l[u],p=d[0],h=d[1];s[h]||(s[h]=p)}e.exports=s},6102:(e,t,n)=>{var r=n(9307),o=n(7131);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==o&&"env"in o&&(e=o.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,r.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=r.debug||r.log||(()=>{}),e.exports=n(553)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},553:(e,t,n)=>{var r=n(9307);e.exports=function(e){function t(e){let n,r,i,s=null;function a(...e){if(!a.enabled)return;const r=a,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];n=i.call(r,t),e.splice(s,1),s--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=o,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(r!==t.namespaces&&(r=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function o(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(2434),t.destroy=function(){r.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},3457:(e,t,n)=>{"use strict";var r=n(7779),o=n(325),i=n(9230),s=n(600);e.exports=function(e,t,n){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new i("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new i("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new i("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new i("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new i("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new i("`loose`, if provided, must be a boolean");var a=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,l=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],d=!!s&&s(e,t);if(r)r(e,t,{configurable:null===l&&d?d.configurable:!l,enumerable:null===a&&d?d.enumerable:!a,value:n,writable:null===c&&d?d.writable:!c});else{if(!u&&(a||c||l))throw new o("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=n}}},1392:(e,t,n)=>{"use strict";var r=n(5453),o="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),i=Object.prototype.toString,s=Array.prototype.concat,a=n(3457),c=n(3867)(),l=function(e,t,n,r){if(t in e)if(!0===r){if(e[t]===n)return}else if("function"!=typeof(o=r)||"[object Function]"!==i.call(o)||!r())return;var o;c?a(e,t,n,!0):a(e,t,n)},u=function(e,t){var n=arguments.length>2?arguments[2]:{},i=r(t);o&&(i=s.call(i,Object.getOwnPropertySymbols(t)));for(var a=0;a<i.length;a+=1)l(e,i[a],t[i[a]],n[i[a]])};u.supportsDescriptors=!!c,e.exports=u},8784:e=>{"use strict";function t(e){if(this._capacity=r(e),this._length=0,this._front=0,n(e)){for(var t=e.length,o=0;o<t;++o)this[o]=e[o];this._length=t}}t.prototype.toArray=function(){for(var e=this._length,t=new Array(e),n=this._front,r=this._capacity,o=0;o<e;++o)t[o]=this[n+o&r-1];return t},t.prototype.push=function(e){var t=arguments.length,n=this._length;if(t>1){var r=this._capacity;if(n+t>r){for(var o=0;o<t;++o){this._checkCapacity(n+1),this[i=this._front+n&this._capacity-1]=arguments[o],n++,this._length=n}return n}for(var i=this._front,o=0;o<t;++o)this[i+n&r-1]=arguments[o],i++;return this._length=n+t,n+t}return 0===t?n:(this._checkCapacity(n+1),this[o=this._front+n&this._capacity-1]=e,this._length=n+1,n+1)},t.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,n=this[t];return this[t]=void 0,this._length=e-1,n}},t.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,n=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,n}},t.prototype.unshift=function(e){var t=this._length,n=arguments.length;if(n>1){if(t+n>(o=this._capacity)){for(var r=n-1;r>=0;r--){this._checkCapacity(t+1);var o=this._capacity;this[s=(this._front-1&o-1^o)-o]=arguments[r],t++,this._length=t,this._front=s}return t}var i=this._front;for(r=n-1;r>=0;r--){var s;this[s=(i-1&o-1^o)-o]=arguments[r],i=s}return this._front=i,this._length=t+n,t+n}if(0===n)return t;this._checkCapacity(t+1);o=this._capacity;return this[r=(this._front-1&o-1^o)-o]=e,this._length=t+1,this._front=r,t+1},t.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},t.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},t.prototype.get=function(e){var t=e;if(t===(0|t)){var n=this._length;if(t<0&&(t+=n),!(t<0||t>=n))return this[this._front+t&this._capacity-1]}},t.prototype.isEmpty=function(){return 0===this._length},t.prototype.clear=function(){for(var e=this._length,t=this._front,n=this._capacity,r=0;r<e;++r)this[t+r&n-1]=void 0;this._length=0,this._front=0},t.prototype.toString=function(){return this.toArray().toString()},t.prototype.valueOf=t.prototype.toString,t.prototype.removeFront=t.prototype.shift,t.prototype.removeBack=t.prototype.pop,t.prototype.insertFront=t.prototype.unshift,t.prototype.insertBack=t.prototype.push,t.prototype.enqueue=t.prototype.push,t.prototype.dequeue=t.prototype.shift,t.prototype.toJSON=t.prototype.toArray,Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),t.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(r(1.5*this._capacity+16))},t.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,r=this._length;n+r>t&&function(e,t,n,r,o){for(var i=0;i<o;++i)n[i+r]=e[i+t],e[i+t]=void 0}(this,0,this,t,n+r&t-1)};var n=Array.isArray;function r(e){if("number"!=typeof e){if(!n(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16);var t}e.exports=t},7779:(e,t,n)=>{"use strict";var r=n(7216)("%Object.defineProperty%",!0)||!1;if(r)try{r({},"a",{value:1})}catch(e){r=!1}e.exports=r},2932:e=>{"use strict";e.exports=EvalError},6448:e=>{"use strict";e.exports=Error},8869:e=>{"use strict";e.exports=RangeError},221:e=>{"use strict";e.exports=ReferenceError},325:e=>{"use strict";e.exports=SyntaxError},9230:e=>{"use strict";e.exports=TypeError},8462:e=>{"use strict";e.exports=URIError},309:(e,t,n)=>{"use strict";var r,o=n(9307),i="object"==typeof Reflect?Reflect:null,s=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function c(){c.init.call(this)}e.exports=c,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}y(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,n)}(e,o,{once:!0})}))},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?c.defaultMaxListeners:e._maxListeners}function p(e,t,n,r){var i,s,a,c;if(u(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]),void 0===a)a=s[t]=n,++e._eventsCount;else if("function"==typeof a?a=s[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=d(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,c=l,o&&o.warn&&o.warn(c)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=h.bind(r);return o.listener=n,r.wrapFn=o,o}function g(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):v(o,o.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},c.prototype.getMaxListeners=function(){return d(this)},c.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)s(c,this,t);else{var l=c.length,u=v(c,l);for(n=0;n<l;++n)s(u[n],this,t)}return!0},c.prototype.addListener=function(e,t){return p(this,e,t,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(e,t){return p(this,e,t,!0)},c.prototype.once=function(e,t){return u(t),this.on(e,f(this,e,t)),this},c.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,f(this,e,t)),this},c.prototype.removeListener=function(e,t){var n,r,o,i,s;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},c.prototype.listeners=function(e){return g(this,e,!0)},c.prototype.rawListeners=function(e){return g(this,e,!1)},c.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},c.prototype.listenerCount=m,c.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},6580:(e,t,n)=>{"use strict";var r,o=n(9307),i="object"==typeof Reflect?Reflect:null,s=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function c(){c.init.call(this)}e.exports=c,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}y(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,n)}(e,o,{once:!0})}))},c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var l=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?c.defaultMaxListeners:e._maxListeners}function p(e,t,n,r){var i,s,a,c;if(u(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),a=s[t]),void 0===a)a=s[t]=n,++e._eventsCount;else if("function"==typeof a?a=s[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=d(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,c=l,o&&o.warn&&o.warn(c)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=h.bind(r);return o.listener=n,r.wrapFn=o,o}function g(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):v(o,o.length)}function m(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function v(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){r.once&&e.removeEventListener(t,o),n(i)}))}}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},c.prototype.getMaxListeners=function(){return d(this)},c.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var c=o[e];if(void 0===c)return!1;if("function"==typeof c)s(c,this,t);else{var l=c.length,u=v(c,l);for(n=0;n<l;++n)s(u[n],this,t)}return!0},c.prototype.addListener=function(e,t){return p(this,e,t,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(e,t){return p(this,e,t,!0)},c.prototype.once=function(e,t){return u(t),this.on(e,f(this,e,t)),this},c.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,f(this,e,t)),this},c.prototype.removeListener=function(e,t){var n,r,o,i,s;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},c.prototype.listeners=function(e){return g(this,e,!0)},c.prototype.rawListeners=function(e){return g(this,e,!1)},c.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},c.prototype.listenerCount=m,c.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},6034:(e,t,n)=>{"use strict";var r=n(2377),o=Object.prototype.toString,i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){if(!r(t))throw new TypeError("iterator must be a function");var s;arguments.length>=3&&(s=n),"[object Array]"===o.call(e)?function(e,t,n){for(var r=0,o=e.length;r<o;r++)i.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,s):"string"==typeof e?function(e,t,n){for(var r=0,o=e.length;r<o;r++)null==n?t(e.charAt(r),r,e):t.call(n,e.charAt(r),r,e)}(e,t,s):function(e,t,n){for(var r in e)i.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,s)}},4334:e=>{"use strict";var t=Object.prototype.toString,n=Math.max,r=function(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var o=0;o<t.length;o+=1)n[o+e.length]=t[o];return n};e.exports=function(e){var o=this;if("function"!=typeof o||"[object Function]"!==t.apply(o))throw new TypeError("Function.prototype.bind called on incompatible "+o);for(var i,s=function(e,t){for(var n=[],r=t||0,o=0;r<e.length;r+=1,o+=1)n[o]=e[r];return n}(arguments,1),a=n(0,o.length-s.length),c=[],l=0;l<a;l++)c[l]="$"+l;if(i=Function("binder","return function ("+function(e,t){for(var n="",r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n}(c,",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof i){var t=o.apply(this,r(s,arguments));return Object(t)===t?t:this}return o.apply(e,r(s,arguments))})),o.prototype){var u=function(){};u.prototype=o.prototype,i.prototype=new u,u.prototype=null}return i}},2790:(e,t,n)=>{"use strict";var r=n(4334);e.exports=Function.prototype.bind||r},7216:(e,t,n)=>{"use strict";var r,o=n(6448),i=n(2932),s=n(8869),a=n(221),c=n(325),l=n(9230),u=n(8462),d=Function,p=function(e){try{return d('"use strict"; return ('+e+").constructor;")()}catch(e){}},h=Object.getOwnPropertyDescriptor;if(h)try{h({},"")}catch(e){h=null}var f=function(){throw new l},g=h?function(){try{return f}catch(e){try{return h(arguments,"callee").get}catch(e){return f}}}():f,m=n(5834)(),v=n(9638)(),y=Object.getPrototypeOf||(v?function(e){return e.__proto__}:null),b={},w="undefined"!=typeof Uint8Array&&y?y(Uint8Array):r,S={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?r:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?r:ArrayBuffer,"%ArrayIteratorPrototype%":m&&y?y([][Symbol.iterator]()):r,"%AsyncFromSyncIteratorPrototype%":r,"%AsyncFunction%":b,"%AsyncGenerator%":b,"%AsyncGeneratorFunction%":b,"%AsyncIteratorPrototype%":b,"%Atomics%":"undefined"==typeof Atomics?r:Atomics,"%BigInt%":"undefined"==typeof BigInt?r:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?r:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?r:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?r:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":o,"%eval%":eval,"%EvalError%":i,"%Float32Array%":"undefined"==typeof Float32Array?r:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?r:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?r:FinalizationRegistry,"%Function%":d,"%GeneratorFunction%":b,"%Int8Array%":"undefined"==typeof Int8Array?r:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?r:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?r:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":m&&y?y(y([][Symbol.iterator]())):r,"%JSON%":"object"==typeof JSON?JSON:r,"%Map%":"undefined"==typeof Map?r:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&m&&y?y((new Map)[Symbol.iterator]()):r,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?r:Promise,"%Proxy%":"undefined"==typeof Proxy?r:Proxy,"%RangeError%":s,"%ReferenceError%":a,"%Reflect%":"undefined"==typeof Reflect?r:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?r:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&m&&y?y((new Set)[Symbol.iterator]()):r,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?r:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":m&&y?y(""[Symbol.iterator]()):r,"%Symbol%":m?Symbol:r,"%SyntaxError%":c,"%ThrowTypeError%":g,"%TypedArray%":w,"%TypeError%":l,"%Uint8Array%":"undefined"==typeof Uint8Array?r:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?r:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?r:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?r:Uint32Array,"%URIError%":u,"%WeakMap%":"undefined"==typeof WeakMap?r:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?r:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?r:WeakSet};if(y)try{null.error}catch(e){var C=y(y(e));S["%Error.prototype%"]=C}var k=function e(t){var n;if("%AsyncFunction%"===t)n=p("async function () {}");else if("%GeneratorFunction%"===t)n=p("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=p("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&y&&(n=y(o.prototype))}return S[t]=n,n},E={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},T=n(2790),P=n(9668),N=T.call(Function.call,Array.prototype.concat),I=T.call(Function.apply,Array.prototype.splice),O=T.call(Function.call,String.prototype.replace),A=T.call(Function.call,String.prototype.slice),L=T.call(Function.call,RegExp.prototype.exec),F=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,D=/\\(\\)?/g,x=function(e,t){var n,r=e;if(P(E,r)&&(r="%"+(n=E[r])[0]+"%"),P(S,r)){var o=S[r];if(o===b&&(o=k(r)),void 0===o&&!t)throw new l("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new c("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new l('"allowMissing" argument must be a boolean');if(null===L(/^%?[^%]*%?$/,e))throw new c("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=function(e){var t=A(e,0,1),n=A(e,-1);if("%"===t&&"%"!==n)throw new c("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new c("invalid intrinsic syntax, expected opening `%`");var r=[];return O(e,F,(function(e,t,n,o){r[r.length]=n?O(o,D,"$1"):t||e})),r}(e),r=n.length>0?n[0]:"",o=x("%"+r+"%",t),i=o.name,s=o.value,a=!1,u=o.alias;u&&(r=u[0],I(n,N([0,1],u)));for(var d=1,p=!0;d<n.length;d+=1){var f=n[d],g=A(f,0,1),m=A(f,-1);if(('"'===g||"'"===g||"`"===g||'"'===m||"'"===m||"`"===m)&&g!==m)throw new c("property names with quotes must have matching quotes");if("constructor"!==f&&p||(a=!0),P(S,i="%"+(r+="."+f)+"%"))s=S[i];else if(null!=s){if(!(f in s)){if(!t)throw new l("base intrinsic for "+e+" exists, but the property is not available.");return}if(h&&d+1>=n.length){var v=h(s,f);s=(p=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:s[f]}else p=P(s,f),s=s[f];p&&!a&&(S[i]=s)}}return s}},600:(e,t,n)=>{"use strict";var r=n(7216)("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(e){r=null}e.exports=r},3867:(e,t,n)=>{"use strict";var r=n(7779),o=function(){return!!r};o.hasArrayLengthDefineBug=function(){if(!r)return null;try{return 1!==r([],"length",{value:1}).length}catch(e){return!0}},e.exports=o},9638:e=>{"use strict";var t={__proto__:null,foo:{}},n=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!(t instanceof n)}},5834:(e,t,n)=>{"use strict";var r="undefined"!=typeof Symbol&&Symbol,o=n(2624);e.exports=function(){return"function"==typeof r&&("function"==typeof Symbol&&("symbol"==typeof r("foo")&&("symbol"==typeof Symbol("bar")&&o())))}},2624:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(e,t);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},9e3:(e,t,n)=>{"use strict";var r=n(2624);e.exports=function(){return r()&&!!Symbol.toStringTag}},9668:(e,t,n)=>{"use strict";var r=Function.prototype.call,o=Object.prototype.hasOwnProperty,i=n(2790);e.exports=i.call(r,o)},5515:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},4689:(e,t,n)=>{"use strict";var r=n(9e3)(),o=n(715)("Object.prototype.toString"),i=function(e){return!(r&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===o(e)},s=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==o(e)&&"[object Function]"===o(e.callee)},a=function(){return i(arguments)}();i.isLegacyArguments=s,e.exports=a?i:s},2377:e=>{"use strict";var t,n,r=Function.prototype.toString,o="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof o&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw n}}),n={},o((function(){throw 42}),null,t)}catch(e){e!==n&&(o=null)}else o=null;var i=/^\s*class\b/,s=function(e){try{var t=r.call(e);return i.test(t)}catch(e){return!1}},a=function(e){try{return!s(e)&&(r.call(e),!0)}catch(e){return!1}},c=Object.prototype.toString,l="function"==typeof Symbol&&!!Symbol.toStringTag,u=!(0 in[,]),d=function(){return!1};if("object"==typeof document){var p=document.all;c.call(p)===c.call(document.all)&&(d=function(e){if((u||!e)&&(void 0===e||"object"==typeof e))try{var t=c.call(e);return("[object HTMLAllCollection]"===t||"[object HTML document.all class]"===t||"[object HTMLCollection]"===t||"[object Object]"===t)&&null==e("")}catch(e){}return!1})}e.exports=o?function(e){if(d(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;try{o(e,null,t)}catch(e){if(e!==n)return!1}return!s(e)&&a(e)}:function(e){if(d(e))return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if(l)return a(e);if(s(e))return!1;var t=c.call(e);return!("[object Function]"!==t&&"[object GeneratorFunction]"!==t&&!/^\[object HTML/.test(t))&&a(e)}},6534:(e,t,n)=>{"use strict";var r,o=Object.prototype.toString,i=Function.prototype.toString,s=/^\s*(?:function)?\*/,a=n(9e3)(),c=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(s.test(i.call(e)))return!0;if(!a)return"[object GeneratorFunction]"===o.call(e);if(!c)return!1;if(void 0===r){var t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}();r=!!t&&c(t)}return c(e)===r}},2357:e=>{"use strict";e.exports=function(e){return e!=e}},4307:(e,t,n)=>{"use strict";var r=n(9527),o=n(1392),i=n(2357),s=n(7104),a=n(4874),c=r(s(),Number);o(c,{getPolyfill:s,implementation:i,shim:a}),e.exports=c},7104:(e,t,n)=>{"use strict";var r=n(2357);e.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:r}},4874:(e,t,n)=>{"use strict";var r=n(1392),o=n(7104);e.exports=function(){var e=o();return r(Number,{isNaN:e},{isNaN:function(){return Number.isNaN!==e}}),e}},4460:(e,t,n)=>{"use strict";var r=n(731);e.exports=function(e){return!!r(e)}},2434:e=>{var t=1e3,n=60*t,r=60*n,o=24*r,i=7*o,s=365.25*o;function a(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,c){c=c||{};var l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*s;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*o;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===l&&isFinite(e))return c.long?function(e){var i=Math.abs(e);if(i>=o)return a(e,i,o,"day");if(i>=r)return a(e,i,r,"hour");if(i>=n)return a(e,i,n,"minute");if(i>=t)return a(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=o)return Math.round(e/o)+"d";if(i>=r)return Math.round(e/r)+"h";if(i>=n)return Math.round(e/n)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},8513:e=>{"use strict";var t=function(e){return e!=e};e.exports=function(e,n){return 0===e&&0===n?1/e==1/n:e===n||!(!t(e)||!t(n))}},6991:(e,t,n)=>{"use strict";var r=n(1392),o=n(9527),i=n(8513),s=n(1140),a=n(1230),c=o(s(),Object);r(c,{getPolyfill:s,implementation:i,shim:a}),e.exports=c},1140:(e,t,n)=>{"use strict";var r=n(8513);e.exports=function(){return"function"==typeof Object.is?Object.is:r}},1230:(e,t,n)=>{"use strict";var r=n(1140),o=n(1392);e.exports=function(){var e=r();return o(Object,{is:e},{is:function(){return Object.is!==e}}),e}},2371:(e,t,n)=>{"use strict";var r;if(!Object.keys){var o=Object.prototype.hasOwnProperty,i=Object.prototype.toString,s=n(3549),a=Object.prototype.propertyIsEnumerable,c=!a.call({toString:null},"toString"),l=a.call((function(){}),"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(e){var t=e.constructor;return t&&t.prototype===e},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!p["$"+e]&&o.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{d(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();r=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===i.call(e),r=s(e),a=t&&"[object String]"===i.call(e),p=[];if(!t&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var f=l&&n;if(a&&e.length>0&&!o.call(e,0))for(var g=0;g<e.length;++g)p.push(String(g));if(r&&e.length>0)for(var m=0;m<e.length;++m)p.push(String(m));else for(var v in e)f&&"prototype"===v||!o.call(e,v)||p.push(String(v));if(c)for(var y=function(e){if("undefined"==typeof window||!h)return d(e);try{return d(e)}catch(e){return!1}}(e),b=0;b<u.length;++b)y&&"constructor"===u[b]||!o.call(e,u[b])||p.push(u[b]);return p}}e.exports=r},5453:(e,t,n)=>{"use strict";var r=Array.prototype.slice,o=n(3549),i=Object.keys,s=i?function(e){return i(e)}:n(2371),a=Object.keys;s.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return o(e)?a(r.call(e)):a(e)})}else Object.keys=s;return Object.keys||s},e.exports=s},3549:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var n=t.call(e),r="[object Arguments]"===n;return r||(r="[object Array]"!==n&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),r}},5781:(e,t,n)=>{"use strict";var r=n(5453),o=n(2624)(),i=n(715),s=Object,a=i("Array.prototype.push"),c=i("Object.prototype.propertyIsEnumerable"),l=o?Object.getOwnPropertySymbols:null;e.exports=function(e,t){if(null==e)throw new TypeError("target must be an object");var n=s(e);if(1===arguments.length)return n;for(var i=1;i<arguments.length;++i){var u=s(arguments[i]),d=r(u),p=o&&(Object.getOwnPropertySymbols||l);if(p)for(var h=p(u),f=0;f<h.length;++f){var g=h[f];c(u,g)&&a(d,g)}for(var m=0;m<d.length;++m){var v=d[m];if(c(u,v)){var y=u[v];n[v]=y}}}return n}},7072:(e,t,n)=>{"use strict";var r=n(5781);e.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),n={},r=0;r<t.length;++r)n[t[r]]=t[r];var o=Object.assign({},n),i="";for(var s in o)i+=s;return e!==i}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}return!1}()?r:Object.assign:r}},4808:e=>{"use strict";e.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]},7131:e=>{var t,n,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var a,c=[],l=!1,u=-1;function d(){l&&a&&(l=!1,a.length?c=a.concat(c):u=-1,c.length&&p())}function p(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(a=c,c=[];++u<t;)a&&a[u].run();u=-1,t=c.length}a=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function f(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=f,r.addListener=f,r.once=f,r.off=f,r.removeListener=f,r.removeAllListeners=f,r.emit=f,r.prependListener=f,r.prependOnceListener=f,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},9584:(e,t,n)=>{"use strict";var r=n(9307),o=n(7011),i=n(9593);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,c={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(c[e]=t,e=0;e<t.length;e++)a.add(t[e])}var d=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),p=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function m(e,t,n,r,o,i,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){v[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];v[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){v[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){v[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){v[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){v[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){v[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){v[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){v[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function w(e,t,n,r){var o=v.hasOwnProperty(t)?v[t]:null;(null!==o?0!==o.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!p.call(g,e)||!p.call(f,e)&&(h.test(e)?g[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,b);v[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,b);v[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,b);v[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),v.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){v[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var S=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),k=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),I=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var x=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function M(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=R&&e[R]||e["@@iterator"])?e:null}var _,U=Object.assign;function j(e){if(void 0===_)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);_=t&&t[1]||""}return"\n"+_+e}var z=!1;function q(e,t){if(!e||z)return"";z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var o=t.stack.split("\n"),i=r.stack.split("\n"),s=o.length-1,a=i.length-1;1<=s&&0<=a&&o[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==i[a]){if(1!==s||1!==a)do{if(s--,0>--a||o[s]!==i[a]){var c="\n"+o[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=s&&0<=a);break}}}finally{z=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function B(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=q(e.type,!1);case 11:return e=q(e.type.render,!1);case 1:return e=q(e.type,!0);default:return""}}function $(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case E:return"Fragment";case k:return"Portal";case P:return"Profiler";case T:return"StrictMode";case A:return"Suspense";case L:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case N:return(e._context.displayName||"Context")+".Provider";case O:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case F:return null!==(t=e.displayName||null)?t:$(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return $(e(t))}catch(e){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $(t);case 8:return t===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=V(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function J(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return U({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=W(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function Z(e,t){Y(e,t);var n=W(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?te(e,t.type,n):t.hasOwnProperty("defaultValue")&&te(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ee(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function te(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ne=Array.isArray;function re(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+W(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return U({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(ne(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:W(n)}}function se(e,t){var n=W(t.value),r=W(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ce(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ce(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,de,pe=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ve(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(fe).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ye=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(s(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Se=null;function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ee=null,Te=null;function Pe(e){if(e=So(e)){if("function"!=typeof ke)throw Error(s(280));var t=e.stateNode;t&&(t=ko(t),ke(e.stateNode,e.type,t))}}function Ne(e){Ee?Te?Te.push(e):Te=[e]:Ee=e}function Ie(){if(Ee){var e=Ee,t=Te;if(Te=Ee=null,Pe(e),t)for(e=0;e<t.length;e++)Pe(t[e])}}function Oe(e,t){return e(t)}function Ae(){}var Le=!1;function Fe(e,t,n){if(Le)return e(t,n);Le=!0;try{return Oe(e,t,n)}finally{Le=!1,(null!==Ee||null!==Te)&&(Ae(),Ie())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=ko(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(s(231,t,typeof n));return n}var xe=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){xe=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){xe=!1}function Me(e,t,n,r,o,i,s,a,c){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(e){this.onError(e)}}var _e=!1,Ue=null,je=!1,ze=null,qe={onError:function(e){_e=!0,Ue=e}};function Be(e,t,n,r,o,i,s,a,c){_e=!1,Ue=null,Me.apply(qe,arguments)}function $e(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if($e(e)!==e)throw Error(s(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=$e(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return We(o),e;if(i===r)return We(o),t;i=i.sibling}throw Error(s(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,c=o.child;c;){if(c===n){a=!0,n=o,r=i;break}if(c===r){a=!0,r=o,n=i;break}c=c.sibling}if(!a){for(c=i.child;c;){if(c===n){a=!0,n=i,r=o;break}if(c===r){a=!0,r=i,n=o;break}c=c.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Qe=i.unstable_scheduleCallback,Je=i.unstable_cancelCallback,Ke=i.unstable_shouldYield,Xe=i.unstable_requestPaint,Ye=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,et=i.unstable_ImmediatePriority,tt=i.unstable_UserBlockingPriority,nt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,ot=i.unstable_IdlePriority,it=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ct(e)/lt|0)|0},ct=Math.log,lt=Math.LN2;var ut=64,dt=4194304;function pt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,s=268435455&n;if(0!==s){var a=s&~o;0!==a?r=pt(a):0!==(i&=s)&&(r=pt(i))}else 0!==(s=n&~o)?r=pt(s):0!==i&&(r=pt(i));if(0===r)return 0;if(0!==t&&t!==r&&!(t&o)&&((o=r&-r)>=(i=t&-t)||16===o&&4194240&i))return t;if(4&r&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-at(t)),r|=e[n],t&=~o;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return!(4194240&(ut<<=1))&&(ut=64),e}function vt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var wt=0;function St(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var Ct,kt,Et,Tt,Pt,Nt=!1,It=[],Ot=null,At=null,Lt=null,Ft=new Map,Dt=new Map,xt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Ot=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Lt=null;break;case"pointerover":case"pointerout":Ft.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function _t(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},null!==t&&(null!==(t=So(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Ut(e){var t=wo(e.target);if(null!==t){var n=$e(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void Pt(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=So(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);Se=r,n.target.dispatchEvent(r),Se=null,t.shift()}return!0}function zt(e,t,n){jt(e)&&n.delete(t)}function qt(){Nt=!1,null!==Ot&&jt(Ot)&&(Ot=null),null!==At&&jt(At)&&(At=null),null!==Lt&&jt(Lt)&&(Lt=null),Ft.forEach(zt),Dt.forEach(zt)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,Nt||(Nt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,qt)))}function $t(e){function t(t){return Bt(t,e)}if(0<It.length){Bt(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ot&&Bt(Ot,e),null!==At&&Bt(At,e),null!==Lt&&Bt(Lt,e),Ft.forEach(t),Dt.forEach(t),n=0;n<xt.length;n++)(r=xt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<xt.length&&null===(n=xt[0]).blockedOn;)Ut(n),null===n.blockedOn&&xt.shift()}var Ht=S.ReactCurrentBatchConfig,Wt=!0;function Vt(e,t,n,r){var o=wt,i=Ht.transition;Ht.transition=null;try{wt=1,Qt(e,t,n,r)}finally{wt=o,Ht.transition=i}}function Gt(e,t,n,r){var o=wt,i=Ht.transition;Ht.transition=null;try{wt=4,Qt(e,t,n,r)}finally{wt=o,Ht.transition=i}}function Qt(e,t,n,r){if(Wt){var o=Kt(e,t,n,r);if(null===o)Wr(e,t,r,Jt,n),Mt(e,r);else if(function(e,t,n,r,o){switch(t){case"focusin":return Ot=_t(Ot,e,t,n,r,o),!0;case"dragenter":return At=_t(At,e,t,n,r,o),!0;case"mouseover":return Lt=_t(Lt,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return Ft.set(i,_t(Ft.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Dt.set(i,_t(Dt.get(i)||null,e,t,n,r,o)),!0}return!1}(o,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==o;){var i=So(o);if(null!==i&&Ct(i),null===(i=Kt(e,t,n,r))&&Wr(e,t,r,Jt,n),i===o)break;o=i}null!==o&&r.stopPropagation()}else Wr(e,t,r,null,n)}}var Jt=null;function Kt(e,t,n,r){if(Jt=null,null!==(e=wo(e=Ce(r))))if(null===(t=$e(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case et:return 1;case tt:return 4;case nt:case rt:return 16;case ot:return 536870912;default:return 16}default:return 16}}var Yt=null,Zt=null,en=null;function tn(){if(en)return en;var e,t,n=Zt,r=n.length,o="value"in Yt?Yt.value:Yt.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===o[i-t];t++);return en=o.slice(e,1<t?1-t:void 0)}function nn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rn(){return!0}function on(){return!1}function sn(e){function t(t,n,r,o,i){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(o):o[s]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?rn:on,this.isPropagationStopped=on,this}return U(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rn)},persist:function(){},isPersistent:rn}),t}var an,cn,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=sn(un),pn=U({},un,{view:0,detail:0}),hn=sn(pn),fn=U({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,cn=e.screenY-ln.screenY):cn=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:cn}}),gn=sn(fn),mn=sn(U({},fn,{dataTransfer:0})),vn=sn(U({},pn,{relatedTarget:0})),yn=sn(U({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=U({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=sn(bn),Sn=sn(U({},un,{data:0})),Cn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Pn(){return Tn}var Nn=U({},pn,{key:function(e){if(e.key){var t=Cn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=nn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pn,charCode:function(e){return"keypress"===e.type?nn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?nn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=sn(Nn),On=sn(U({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=sn(U({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pn})),Ln=sn(U({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Fn=U({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(Fn),xn=[9,13,27,32],Rn=d&&"CompositionEvent"in window,Mn=null;d&&"documentMode"in document&&(Mn=document.documentMode);var _n=d&&"TextEvent"in window&&!Mn,Un=d&&(!Rn||Mn&&8<Mn&&11>=Mn),jn=String.fromCharCode(32),zn=!1;function qn(e,t){switch(e){case"keyup":return-1!==xn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var $n=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Vn(e,t,n,r){Ne(r),0<(t=Gr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Qn=null;function Jn(e){jr(e,0)}function Kn(e){if(Q(Co(e)))return e}function Xn(e,t){if("change"===e)return t}var Yn=!1;if(d){var Zn;if(d){var er="oninput"in document;if(!er){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),er="function"==typeof tr.oninput}Zn=er}else Zn=!1;Yn=Zn&&(!document.documentMode||9<document.documentMode)}function nr(){Gn&&(Gn.detachEvent("onpropertychange",rr),Qn=Gn=null)}function rr(e){if("value"===e.propertyName&&Kn(Qn)){var t=[];Vn(t,Qn,e,Ce(e)),Fe(Jn,t)}}function or(e,t,n){"focusin"===e?(nr(),Qn=n,(Gn=t).attachEvent("onpropertychange",rr)):"focusout"===e&&nr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Qn)}function sr(e,t){if("click"===e)return Kn(t)}function ar(e,t){if("input"===e||"change"===e)return Kn(t)}var cr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lr(e,t){if(cr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!p.call(t,o)||!cr(e[o],t[o]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&pr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=void 0===r.end?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=dr(n,i);var s=dr(n,r);o&&s&&(1!==e.rangeCount||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=d&&"documentMode"in document&&11>=document.documentMode,vr=null,yr=null,br=null,wr=!1;function Sr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==vr||vr!==J(r)||("selectionStart"in(r=vr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&lr(br,r)||(br=r,0<(r=Gr(yr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vr)))}function Cr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:Cr("Animation","AnimationEnd"),animationiteration:Cr("Animation","AnimationIteration"),animationstart:Cr("Animation","AnimationStart"),transitionend:Cr("Transition","TransitionEnd")},Er={},Tr={};function Pr(e){if(Er[e])return Er[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Tr)return Er[e]=n[t];return e}d&&(Tr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Nr=Pr("animationend"),Ir=Pr("animationiteration"),Or=Pr("animationstart"),Ar=Pr("transitionend"),Lr=new Map,Fr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Lr.set(e,t),l(t,[e])}for(var xr=0;xr<Fr.length;xr++){var Rr=Fr[xr];Dr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Dr(Nr,"onAnimationEnd"),Dr(Ir,"onAnimationIteration"),Dr(Or,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Ar,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_r=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Ur(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,i,a,c,l){if(Be.apply(this,arguments),_e){if(!_e)throw Error(s(198));var u=Ue;_e=!1,Ue=null,je||(je=!0,ze=u)}}(r,t,void 0,e),e.currentTarget=null}function jr(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==i&&o.isPropagationStopped())break e;Ur(o,a,l),i=c}else for(s=0;s<r.length;s++){if(c=(a=r[s]).instance,l=a.currentTarget,a=a.listener,c!==i&&o.isPropagationStopped())break e;Ur(o,a,l),i=c}}}if(je)throw e=ze,je=!1,ze=null,e}function zr(e,t){var n=t[vo];void 0===n&&(n=t[vo]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function qr(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function $r(e){if(!e[Br]){e[Br]=!0,a.forEach((function(t){"selectionchange"!==t&&(_r.has(t)||qr(t,!1,e),qr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,qr("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Xt(t)){case 1:var o=Vt;break;case 4:o=Gt;break;default:o=Qt}n=o.bind(null,t,n,e),o=void 0,!xe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Wr(e,t,n,r,o){var i=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===o||8===a.nodeType&&a.parentNode===o)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===o||8===c.nodeType&&c.parentNode===o))return;s=s.return}for(;null!==a;){if(null===(s=wo(a)))return;if(5===(c=s.tag)||6===c){r=i=s;continue e}a=a.parentNode}}r=r.return}Fe((function(){var r=i,o=Ce(n),s=[];e:{var a=Lr.get(e);if(void 0!==a){var c=dn,l=e;switch(e){case"keypress":if(0===nn(n))break e;case"keydown":case"keyup":c=In;break;case"focusin":l="focus",c=vn;break;case"focusout":l="blur",c=vn;break;case"beforeblur":case"afterblur":c=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=An;break;case Nr:case Ir:case Or:c=yn;break;case Ar:c=Ln;break;case"scroll":c=hn;break;case"wheel":c=Dn;break;case"copy":case"cut":case"paste":c=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=On}var u=!!(4&t),d=!u&&"scroll"===e,p=u?null!==a?a+"Capture":null:a;u=[];for(var h,f=r;null!==f;){var g=(h=f).stateNode;if(5===h.tag&&null!==g&&(h=g,null!==p&&(null!=(g=De(f,p))&&u.push(Vr(f,g,h)))),d)break;f=f.return}0<u.length&&(a=new c(a,l,null,n,o),s.push({event:a,listeners:u}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Se||!(l=n.relatedTarget||n.fromElement)||!wo(l)&&!l[mo])&&(c||a)&&(a=o.window===o?o:(a=o.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=r,null!==(l=(l=n.relatedTarget||n.toElement)?wo(l):null)&&(l!==(d=$e(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(c=null,l=r),c!==l)){if(u=gn,g="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=On,g="onPointerLeave",p="onPointerEnter",f="pointer"),d=null==c?a:Co(c),h=null==l?a:Co(l),(a=new u(g,f+"leave",c,n,o)).target=d,a.relatedTarget=h,g=null,wo(o)===r&&((u=new u(p,f+"enter",l,n,o)).target=h,u.relatedTarget=d,g=u),d=g,c&&l)e:{for(p=l,f=0,h=u=c;h;h=Qr(h))f++;for(h=0,g=p;g;g=Qr(g))h++;for(;0<f-h;)u=Qr(u),f--;for(;0<h-f;)p=Qr(p),h--;for(;f--;){if(u===p||null!==p&&u===p.alternate)break e;u=Qr(u),p=Qr(p)}u=null}else u=null;null!==c&&Jr(s,a,c,u,!1),null!==l&&null!==d&&Jr(s,d,l,u,!0)}if("select"===(c=(a=r?Co(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var m=Xn;else if(Wn(a))if(Yn)m=ar;else{m=ir;var v=or}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=sr);switch(m&&(m=m(e,r))?Vn(s,m,n,o):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&te(a,"number",a.value)),v=r?Co(r):window,e){case"focusin":(Wn(v)||"true"===v.contentEditable)&&(vr=v,yr=r,br=null);break;case"focusout":br=yr=vr=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,Sr(s,n,o);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":Sr(s,n,o)}var y;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else $n?qn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&($n||"onCompositionStart"!==b?"onCompositionEnd"===b&&$n&&(y=tn()):(Zt="value"in(Yt=o)?Yt.value:Yt.textContent,$n=!0)),0<(v=Gr(r,b)).length&&(b=new Sn(b,e,null,n,o),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=Bn(n))&&(b.data=y))),(y=_n?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(zn=!0,jn);case"textInput":return(e=t.data)===jn&&zn?null:e;default:return null}}(e,n):function(e,t){if($n)return"compositionend"===e||!Rn&&qn(e,t)?(e=tn(),en=Zt=Yt=null,$n=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(o=new Sn("onBeforeInput","beforeinput",null,n,o),s.push({event:o,listeners:r}),o.data=y))}jr(s,t)}))}function Vr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=De(e,n))&&r.unshift(Vr(e,i,o)),null!=(i=De(e,t))&&r.push(Vr(e,i,o))),e=e.return}return r}function Qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jr(e,t,n,r,o){for(var i=t._reactName,s=[];null!==n&&n!==r;){var a=n,c=a.alternate,l=a.stateNode;if(null!==c&&c===r)break;5===a.tag&&null!==l&&(a=l,o?null!=(c=De(n,i))&&s.unshift(Vr(n,c,a)):o||null!=(c=De(n,i))&&s.push(Vr(n,c,a))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Kr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Yr(e){return("string"==typeof e?e:""+e).replace(Kr,"\n").replace(Xr,"")}function Zr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(s(425))}function eo(){}var to=null,no=null;function ro(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var oo="function"==typeof setTimeout?setTimeout:void 0,io="function"==typeof clearTimeout?clearTimeout:void 0,so="function"==typeof Promise?Promise:void 0,ao="function"==typeof queueMicrotask?queueMicrotask:void 0!==so?function(e){return so.resolve(null).then(e).catch(co)}:oo;function co(e){setTimeout((function(){throw e}))}function lo(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&8===o.nodeType)if("/$"===(n=o.data)){if(0===r)return e.removeChild(o),void $t(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=o}while(n);$t(t)}function uo(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function po(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ho=Math.random().toString(36).slice(2),fo="__reactFiber$"+ho,go="__reactProps$"+ho,mo="__reactContainer$"+ho,vo="__reactEvents$"+ho,yo="__reactListeners$"+ho,bo="__reactHandles$"+ho;function wo(e){var t=e[fo];if(t)return t;for(var n=e.parentNode;n;){if(t=n[mo]||n[fo]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=po(e);null!==e;){if(n=e[fo])return n;e=po(e)}return t}n=(e=n).parentNode}return null}function So(e){return!(e=e[fo]||e[mo])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Co(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function ko(e){return e[go]||null}var Eo=[],To=-1;function Po(e){return{current:e}}function No(e){0>To||(e.current=Eo[To],Eo[To]=null,To--)}function Io(e,t){To++,Eo[To]=e.current,e.current=t}var Oo={},Ao=Po(Oo),Lo=Po(!1),Fo=Oo;function Do(e,t){var n=e.type.contextTypes;if(!n)return Oo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function xo(e){return null!=(e=e.childContextTypes)}function Ro(){No(Lo),No(Ao)}function Mo(e,t,n){if(Ao.current!==Oo)throw Error(s(168));Io(Ao,t),Io(Lo,n)}function _o(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in t))throw Error(s(108,H(e)||"Unknown",o));return U({},n,r)}function Uo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Oo,Fo=Ao.current,Io(Ao,e),Io(Lo,Lo.current),!0}function jo(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=_o(e,t,Fo),r.__reactInternalMemoizedMergedChildContext=e,No(Lo),No(Ao),Io(Ao,e)):No(Lo),Io(Lo,n)}var zo=null,qo=!1,Bo=!1;function $o(e){null===zo?zo=[e]:zo.push(e)}function Ho(){if(!Bo&&null!==zo){Bo=!0;var e=0,t=wt;try{var n=zo;for(wt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}zo=null,qo=!1}catch(t){throw null!==zo&&(zo=zo.slice(e+1)),Qe(et,Ho),t}finally{wt=t,Bo=!1}}return null}var Wo=[],Vo=0,Go=null,Qo=0,Jo=[],Ko=0,Xo=null,Yo=1,Zo="";function ei(e,t){Wo[Vo++]=Qo,Wo[Vo++]=Go,Go=e,Qo=t}function ti(e,t,n){Jo[Ko++]=Yo,Jo[Ko++]=Zo,Jo[Ko++]=Xo,Xo=e;var r=Yo;e=Zo;var o=32-at(r)-1;r&=~(1<<o),n+=1;var i=32-at(t)+o;if(30<i){var s=o-o%5;i=(r&(1<<s)-1).toString(32),r>>=s,o-=s,Yo=1<<32-at(t)+o|n<<o|r,Zo=i+e}else Yo=1<<i|n<<o|r,Zo=e}function ni(e){null!==e.return&&(ei(e,1),ti(e,1,0))}function ri(e){for(;e===Go;)Go=Wo[--Vo],Wo[Vo]=null,Qo=Wo[--Vo],Wo[Vo]=null;for(;e===Xo;)Xo=Jo[--Ko],Jo[Ko]=null,Zo=Jo[--Ko],Jo[Ko]=null,Yo=Jo[--Ko],Jo[Ko]=null}var oi=null,ii=null,si=!1,ai=null;function ci(e,t){var n=Fl(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function li(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,oi=e,ii=uo(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,oi=e,ii=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xo?{id:Yo,overflow:Zo}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Fl(18,null,null,0)).stateNode=t,n.return=e,e.child=n,oi=e,ii=null,!0);default:return!1}}function ui(e){return!(!(1&e.mode)||128&e.flags)}function di(e){if(si){var t=ii;if(t){var n=t;if(!li(e,t)){if(ui(e))throw Error(s(418));t=uo(n.nextSibling);var r=oi;t&&li(e,t)?ci(r,n):(e.flags=-4097&e.flags|2,si=!1,oi=e)}}else{if(ui(e))throw Error(s(418));e.flags=-4097&e.flags|2,si=!1,oi=e}}}function pi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;oi=e}function hi(e){if(e!==oi)return!1;if(!si)return pi(e),si=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ro(e.type,e.memoizedProps)),t&&(t=ii)){if(ui(e))throw fi(),Error(s(418));for(;t;)ci(e,t),t=uo(t.nextSibling)}if(pi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ii=uo(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ii=null}}else ii=oi?uo(e.stateNode.nextSibling):null;return!0}function fi(){for(var e=ii;e;)e=uo(e.nextSibling)}function gi(){ii=oi=null,si=!1}function mi(e){null===ai?ai=[e]:ai.push(e)}var vi=S.ReactCurrentBatchConfig;function yi(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var o=r,i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=o.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function bi(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wi(e){return(0,e._init)(e._payload)}function Si(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=xl(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=Ul(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function l(e,t,n,r){var i=n.type;return i===E?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===D&&wi(i)===t.type)?((r=o(t,n.props)).ref=yi(e,t,n),r.return=e,r):((r=Rl(n.type,n.key,n.props,null,e.mode,r)).ref=yi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=jl(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Ml(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Ul(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case C:return(n=Rl(t.type,t.key,t.props,null,e.mode,n)).ref=yi(e,null,t),n.return=e,n;case k:return(t=jl(t,e.mode,n)).return=e,t;case D:return p(e,(0,t._init)(t._payload),n)}if(ne(t)||M(t))return(t=Ml(t,e.mode,n,null)).return=e,t;bi(e,t)}return null}function h(e,t,n,r){var o=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==o?null:c(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case C:return n.key===o?l(e,t,n,r):null;case k:return n.key===o?u(e,t,n,r):null;case D:return h(e,t,(o=n._init)(n._payload),r)}if(ne(n)||M(n))return null!==o?null:d(e,t,n,r,null);bi(e,n)}return null}function f(e,t,n,r,o){if("string"==typeof r&&""!==r||"number"==typeof r)return c(t,e=e.get(n)||null,""+r,o);if("object"==typeof r&&null!==r){switch(r.$$typeof){case C:return l(t,e=e.get(null===r.key?n:r.key)||null,r,o);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,o);case D:return f(e,t,n,(0,r._init)(r._payload),o)}if(ne(r)||M(r))return d(t,e=e.get(n)||null,r,o,null);bi(t,r)}return null}function g(o,s,a,c){for(var l=null,u=null,d=s,g=s=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var v=h(o,d,a[g],c);if(null===v){null===d&&(d=m);break}e&&d&&null===v.alternate&&t(o,d),s=i(v,s,g),null===u?l=v:u.sibling=v,u=v,d=m}if(g===a.length)return n(o,d),si&&ei(o,g),l;if(null===d){for(;g<a.length;g++)null!==(d=p(o,a[g],c))&&(s=i(d,s,g),null===u?l=d:u.sibling=d,u=d);return si&&ei(o,g),l}for(d=r(o,d);g<a.length;g++)null!==(m=f(d,o,g,a[g],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),s=i(m,s,g),null===u?l=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(o,e)})),si&&ei(o,g),l}function m(o,a,c,l){var u=M(c);if("function"!=typeof u)throw Error(s(150));if(null==(c=u.call(c)))throw Error(s(151));for(var d=u=null,g=a,m=a=0,v=null,y=c.next();null!==g&&!y.done;m++,y=c.next()){g.index>m?(v=g,g=null):v=g.sibling;var b=h(o,g,y.value,l);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(o,g),a=i(b,a,m),null===d?u=b:d.sibling=b,d=b,g=v}if(y.done)return n(o,g),si&&ei(o,m),u;if(null===g){for(;!y.done;m++,y=c.next())null!==(y=p(o,y.value,l))&&(a=i(y,a,m),null===d?u=y:d.sibling=y,d=y);return si&&ei(o,m),u}for(g=r(o,g);!y.done;m++,y=c.next())null!==(y=f(g,o,m,y.value,l))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=i(y,a,m),null===d?u=y:d.sibling=y,d=y);return e&&g.forEach((function(e){return t(o,e)})),si&&ei(o,m),u}return function e(r,i,s,c){if("object"==typeof s&&null!==s&&s.type===E&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case C:e:{for(var l=s.key,u=i;null!==u;){if(u.key===l){if((l=s.type)===E){if(7===u.tag){n(r,u.sibling),(i=o(u,s.props.children)).return=r,r=i;break e}}else if(u.elementType===l||"object"==typeof l&&null!==l&&l.$$typeof===D&&wi(l)===u.type){n(r,u.sibling),(i=o(u,s.props)).ref=yi(r,u,s),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===E?((i=Ml(s.props.children,r.mode,c,s.key)).return=r,r=i):((c=Rl(s.type,s.key,s.props,null,r.mode,c)).ref=yi(r,i,s),c.return=r,r=c)}return a(r);case k:e:{for(u=s.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===s.containerInfo&&i.stateNode.implementation===s.implementation){n(r,i.sibling),(i=o(i,s.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=jl(s,r.mode,c)).return=r,r=i}return a(r);case D:return e(r,i,(u=s._init)(s._payload),c)}if(ne(s))return g(r,i,s,c);if(M(s))return m(r,i,s,c);bi(r,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==i&&6===i.tag?(n(r,i.sibling),(i=o(i,s)).return=r,r=i):(n(r,i),(i=Ul(s,r.mode,c)).return=r,r=i),a(r)):n(r,i)}}var Ci=Si(!0),ki=Si(!1),Ei=Po(null),Ti=null,Pi=null,Ni=null;function Ii(){Ni=Pi=Ti=null}function Oi(e){var t=Ei.current;No(Ei),e._currentValue=t}function Ai(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Li(e,t){Ti=e,Ni=Pi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(wa=!0),e.firstContext=null)}function Fi(e){var t=e._currentValue;if(Ni!==e)if(e={context:e,memoizedValue:t,next:null},null===Pi){if(null===Ti)throw Error(s(308));Pi=e,Ti.dependencies={lanes:0,firstContext:e}}else Pi=Pi.next=e;return t}var Di=null;function xi(e){null===Di?Di=[e]:Di.push(e)}function Ri(e,t,n,r){var o=t.interleaved;return null===o?(n.next=n,xi(t)):(n.next=o.next,o.next=n),t.interleaved=n,Mi(e,r)}function Mi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var _i=!1;function Ui(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ji(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function qi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&Oc){var o=r.pending;return null===o?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Mi(e,n)}return null===(o=r.interleaved)?(t.next=t,xi(r)):(t.next=o.next,o.next=t),r.interleaved=t,Mi(e,n)}function Bi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}function $i(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=s:i=i.next=s,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Hi(e,t,n,r){var o=e.updateQueue;_i=!1;var i=o.firstBaseUpdate,s=o.lastBaseUpdate,a=o.shared.pending;if(null!==a){o.shared.pending=null;var c=a,l=c.next;c.next=null,null===s?i=l:s.next=l,s=c;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=l:a.next=l,u.lastBaseUpdate=c))}if(null!==i){var d=o.baseState;for(s=0,u=l=c=null,a=i;;){var p=a.lane,h=a.eventTime;if((r&p)===p){null!==u&&(u=u.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(p=t,h=n,g.tag){case 1:if("function"==typeof(f=g.payload)){d=f.call(h,d,p);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(p="function"==typeof(f=g.payload)?f.call(h,d,p):f))break e;d=U({},d,p);break e;case 2:_i=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(p=o.effects)?o.effects=[a]:p.push(a))}else h={eventTime:h,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(l=u=h,c=d):u=u.next=h,s|=p;if(null===(a=a.next)){if(null===(a=o.shared.pending))break;a=(p=a).next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}if(null===u&&(c=d),o.baseState=c,o.firstBaseUpdate=l,o.lastBaseUpdate=u,null!==(t=o.shared.interleaved)){o=t;do{s|=o.lane,o=o.next}while(o!==t)}else null===i&&(o.shared.lanes=0);_c|=s,e.lanes=s,e.memoizedState=d}}function Wi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!=typeof o)throw Error(s(191,o));o.call(r)}}}var Vi={},Gi=Po(Vi),Qi=Po(Vi),Ji=Po(Vi);function Ki(e){if(e===Vi)throw Error(s(174));return e}function Xi(e,t){switch(Io(Ji,t),Io(Qi,e),Io(Gi,Vi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}No(Gi),Io(Gi,t)}function Yi(){No(Gi),No(Qi),No(Ji)}function Zi(e){Ki(Ji.current);var t=Ki(Gi.current),n=le(t,e.type);t!==n&&(Io(Qi,e),Io(Gi,n))}function es(e){Qi.current===e&&(No(Gi),No(Qi))}var ts=Po(0);function ns(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var rs=[];function os(){for(var e=0;e<rs.length;e++)rs[e]._workInProgressVersionPrimary=null;rs.length=0}var is=S.ReactCurrentDispatcher,ss=S.ReactCurrentBatchConfig,as=0,cs=null,ls=null,us=null,ds=!1,ps=!1,hs=0,fs=0;function gs(){throw Error(s(321))}function ms(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!cr(e[n],t[n]))return!1;return!0}function vs(e,t,n,r,o,i){if(as=i,cs=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,is.current=null===e||null===e.memoizedState?ea:ta,e=n(r,o),ps){i=0;do{if(ps=!1,hs=0,25<=i)throw Error(s(301));i+=1,us=ls=null,t.updateQueue=null,is.current=na,e=n(r,o)}while(ps)}if(is.current=Zs,t=null!==ls&&null!==ls.next,as=0,us=ls=cs=null,ds=!1,t)throw Error(s(300));return e}function ys(){var e=0!==hs;return hs=0,e}function bs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===us?cs.memoizedState=us=e:us=us.next=e,us}function ws(){if(null===ls){var e=cs.alternate;e=null!==e?e.memoizedState:null}else e=ls.next;var t=null===us?cs.memoizedState:us.next;if(null!==t)us=t,ls=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ls=e).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===us?cs.memoizedState=us=e:us=us.next=e}return us}function Ss(e,t){return"function"==typeof t?t(e):t}function Cs(e){var t=ws(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=ls,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(null!==o){i=o.next,r=r.baseState;var c=a=null,l=null,u=i;do{var d=u.lane;if((as&d)===d)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(c=l=p,a=r):l=l.next=p,cs.lanes|=d,_c|=d}u=u.next}while(null!==u&&u!==i);null===l?a=r:l.next=c,cr(r,t.memoizedState)||(wa=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}if(null!==(e=n.interleaved)){o=e;do{i=o.lane,cs.lanes|=i,_c|=i,o=o.next}while(o!==e)}else null===o&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ks(e){var t=ws(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var a=o=o.next;do{i=e(i,a.action),a=a.next}while(a!==o);cr(i,t.memoizedState)||(wa=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Es(){}function Ts(e,t){var n=cs,r=ws(),o=t(),i=!cr(r.memoizedState,o);if(i&&(r.memoizedState=o,wa=!0),r=r.queue,_s(Is.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==us&&1&us.memoizedState.tag){if(n.flags|=2048,Fs(9,Ns.bind(null,n,r,o,t),void 0,null),null===Ac)throw Error(s(349));30&as||Ps(n,t,o)}return o}function Ps(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=cs.updateQueue)?(t={lastEffect:null,stores:null},cs.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ns(e,t,n,r){t.value=n,t.getSnapshot=r,Os(t)&&As(e)}function Is(e,t,n){return n((function(){Os(t)&&As(e)}))}function Os(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!cr(e,n)}catch(e){return!0}}function As(e){var t=Mi(e,1);null!==t&&rl(t,e,1,-1)}function Ls(e){var t=bs();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ss,lastRenderedState:e},t.queue=e,e=e.dispatch=Js.bind(null,cs,e),[t.memoizedState,e]}function Fs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=cs.updateQueue)?(t={lastEffect:null,stores:null},cs.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ds(){return ws().memoizedState}function xs(e,t,n,r){var o=bs();cs.flags|=e,o.memoizedState=Fs(1|t,n,void 0,void 0===r?null:r)}function Rs(e,t,n,r){var o=ws();r=void 0===r?null:r;var i=void 0;if(null!==ls){var s=ls.memoizedState;if(i=s.destroy,null!==r&&ms(r,s.deps))return void(o.memoizedState=Fs(t,n,i,r))}cs.flags|=e,o.memoizedState=Fs(1|t,n,i,r)}function Ms(e,t){return xs(8390656,8,e,t)}function _s(e,t){return Rs(2048,8,e,t)}function Us(e,t){return Rs(4,2,e,t)}function js(e,t){return Rs(4,4,e,t)}function zs(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qs(e,t,n){return n=null!=n?n.concat([e]):null,Rs(4,4,zs.bind(null,t,e),n)}function Bs(){}function $s(e,t){var n=ws();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Hs(e,t){var n=ws();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ms(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ws(e,t,n){return 21&as?(cr(n,t)||(n=mt(),cs.lanes|=n,_c|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,wa=!0),e.memoizedState=n)}function Vs(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var r=ss.transition;ss.transition={};try{e(!1),t()}finally{wt=n,ss.transition=r}}function Gs(){return ws().memoizedState}function Qs(e,t,n){var r=nl(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ks(e))Xs(t,n);else if(null!==(n=Ri(e,t,n,r))){rl(n,e,r,tl()),Ys(n,t,r)}}function Js(e,t,n){var r=nl(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ks(e))Xs(t,o);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=i(s,n);if(o.hasEagerState=!0,o.eagerState=a,cr(a,s)){var c=t.interleaved;return null===c?(o.next=o,xi(t)):(o.next=c.next,c.next=o),void(t.interleaved=o)}}catch(e){}null!==(n=Ri(e,t,o,r))&&(rl(n,e,r,o=tl()),Ys(n,t,r))}}function Ks(e){var t=e.alternate;return e===cs||null!==t&&t===cs}function Xs(e,t){ps=ds=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ys(e,t,n){if(4194240&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}var Zs={readContext:Fi,useCallback:gs,useContext:gs,useEffect:gs,useImperativeHandle:gs,useInsertionEffect:gs,useLayoutEffect:gs,useMemo:gs,useReducer:gs,useRef:gs,useState:gs,useDebugValue:gs,useDeferredValue:gs,useTransition:gs,useMutableSource:gs,useSyncExternalStore:gs,useId:gs,unstable_isNewReconciler:!1},ea={readContext:Fi,useCallback:function(e,t){return bs().memoizedState=[e,void 0===t?null:t],e},useContext:Fi,useEffect:Ms,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,xs(4194308,4,zs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return xs(4194308,4,e,t)},useInsertionEffect:function(e,t){return xs(4,2,e,t)},useMemo:function(e,t){var n=bs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Qs.bind(null,cs,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},bs().memoizedState=e},useState:Ls,useDebugValue:Bs,useDeferredValue:function(e){return bs().memoizedState=e},useTransition:function(){var e=Ls(!1),t=e[0];return e=Vs.bind(null,e[1]),bs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=cs,o=bs();if(si){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Ac)throw Error(s(349));30&as||Ps(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,Ms(Is.bind(null,r,i,e),[e]),r.flags|=2048,Fs(9,Ns.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=bs(),t=Ac.identifierPrefix;if(si){var n=Zo;t=":"+t+"R"+(n=(Yo&~(1<<32-at(Yo)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fs++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ta={readContext:Fi,useCallback:$s,useContext:Fi,useEffect:_s,useImperativeHandle:qs,useInsertionEffect:Us,useLayoutEffect:js,useMemo:Hs,useReducer:Cs,useRef:Ds,useState:function(){return Cs(Ss)},useDebugValue:Bs,useDeferredValue:function(e){return Ws(ws(),ls.memoizedState,e)},useTransition:function(){return[Cs(Ss)[0],ws().memoizedState]},useMutableSource:Es,useSyncExternalStore:Ts,useId:Gs,unstable_isNewReconciler:!1},na={readContext:Fi,useCallback:$s,useContext:Fi,useEffect:_s,useImperativeHandle:qs,useInsertionEffect:Us,useLayoutEffect:js,useMemo:Hs,useReducer:ks,useRef:Ds,useState:function(){return ks(Ss)},useDebugValue:Bs,useDeferredValue:function(e){var t=ws();return null===ls?t.memoizedState=e:Ws(t,ls.memoizedState,e)},useTransition:function(){return[ks(Ss)[0],ws().memoizedState]},useMutableSource:Es,useSyncExternalStore:Ts,useId:Gs,unstable_isNewReconciler:!1};function ra(e,t){if(e&&e.defaultProps){for(var n in t=U({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function oa(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:U({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ia={isMounted:function(e){return!!(e=e._reactInternals)&&$e(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tl(),o=nl(e),i=zi(r,o);i.payload=t,null!=n&&(i.callback=n),null!==(t=qi(e,i,o))&&(rl(t,e,o,r),Bi(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tl(),o=nl(e),i=zi(r,o);i.tag=1,i.payload=t,null!=n&&(i.callback=n),null!==(t=qi(e,i,o))&&(rl(t,e,o,r),Bi(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tl(),r=nl(e),o=zi(n,r);o.tag=2,null!=t&&(o.callback=t),null!==(t=qi(e,o,r))&&(rl(t,e,r,n),Bi(t,e,r))}};function sa(e,t,n,r,o,i,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(o,i))}function aa(e,t,n){var r=!1,o=Oo,i=t.contextType;return"object"==typeof i&&null!==i?i=Fi(i):(o=xo(t)?Fo:Ao.current,i=(r=null!=(r=t.contextTypes))?Do(e,o):Oo),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ia,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function ca(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ia.enqueueReplaceState(t,t.state,null)}function la(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Ui(e);var i=t.contextType;"object"==typeof i&&null!==i?o.context=Fi(i):(i=xo(t)?Fo:Ao.current,o.context=Do(e,i)),o.state=e.memoizedState,"function"==typeof(i=t.getDerivedStateFromProps)&&(oa(e,t,i,n),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&ia.enqueueReplaceState(o,o.state,null),Hi(e,n,o,r),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4194308)}function ua(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var o=n}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o,digest:null}}function da(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function pa(e,t){try{r.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var ha="function"==typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=zi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wc||(Wc=!0,Vc=r),pa(0,t)},n}function ga(e,t,n){(n=zi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){pa(0,t)}}var i=e.stateNode;return null!==i&&"function"==typeof i.componentDidCatch&&(n.callback=function(){pa(0,t),"function"!=typeof r&&(null===Gc?Gc=new Set([this]):Gc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ha;var o=new Set;r.set(t,o)}else void 0===(o=r.get(t))&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=Pl.bind(null,e,t,n),t.then(e,e))}function va(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,r,o){return 1&e.mode?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zi(-1,1)).tag=2,qi(n,t,1))),n.lanes|=1),e)}var ba=S.ReactCurrentOwner,wa=!1;function Sa(e,t,n,r){t.child=null===e?ki(t,null,n,r):Ci(t,e.child,n,r)}function Ca(e,t,n,r,o){n=n.render;var i=t.ref;return Li(t,o),r=vs(e,t,n,r,i,o),n=ys(),null===e||wa?(si&&n&&ni(t),t.flags|=1,Sa(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Wa(e,t,o))}function ka(e,t,n,r,o){if(null===e){var i=n.type;return"function"!=typeof i||Dl(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rl(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ea(e,t,i,r,o))}if(i=e.child,!(e.lanes&o)){var s=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Wa(e,t,o)}return t.flags|=1,(e=xl(i,r)).ref=t.ref,e.return=t,t.child=e}function Ea(e,t,n,r,o){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(wa=!1,t.pendingProps=r=i,!(e.lanes&o))return t.lanes=e.lanes,Wa(e,t,o);131072&e.flags&&(wa=!0)}}return Na(e,t,n,r,o)}function Ta(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Io(xc,Dc),Dc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Io(xc,Dc),Dc|=r}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Io(xc,Dc),Dc|=n;else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Io(xc,Dc),Dc|=r;return Sa(e,t,o,n),t.child}function Pa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Na(e,t,n,r,o){var i=xo(n)?Fo:Ao.current;return i=Do(t,i),Li(t,o),n=vs(e,t,n,r,i,o),r=ys(),null===e||wa?(si&&r&&ni(t),t.flags|=1,Sa(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Wa(e,t,o))}function Ia(e,t,n,r,o){if(xo(n)){var i=!0;Uo(t)}else i=!1;if(Li(t,o),null===t.stateNode)Ha(e,t),aa(t,n,r),la(t,n,r,o),r=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,l=n.contextType;"object"==typeof l&&null!==l?l=Fi(l):l=Do(t,l=xo(n)?Fo:Ao.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==r||c!==l)&&ca(t,s,r,l),_i=!1;var p=t.memoizedState;s.state=p,Hi(t,r,s,o),c=t.memoizedState,a!==r||p!==c||Lo.current||_i?("function"==typeof u&&(oa(t,n,u,r),c=t.memoizedState),(a=_i||sa(t,n,a,r,p,c,l))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=l,r=a):("function"==typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,ji(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:ra(t.type,a),s.props=l,d=t.pendingProps,p=s.context,"object"==typeof(c=n.contextType)&&null!==c?c=Fi(c):c=Do(t,c=xo(n)?Fo:Ao.current);var h=n.getDerivedStateFromProps;(u="function"==typeof h||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==d||p!==c)&&ca(t,s,r,c),_i=!1,p=t.memoizedState,s.state=p,Hi(t,r,s,o);var f=t.memoizedState;a!==d||p!==f||Lo.current||_i?("function"==typeof h&&(oa(t,n,h,r),f=t.memoizedState),(l=_i||sa(t,n,l,r,p,f,c)||!1)?(u||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,f,c),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,f,c)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),s.props=r,s.state=f,s.context=c,r=l):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Oa(e,t,n,r,i,o)}function Oa(e,t,n,r,o,i){Pa(e,t);var s=!!(128&t.flags);if(!r&&!s)return o&&jo(t,n,!1),Wa(e,t,i);r=t.stateNode,ba.current=t;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=Ci(t,e.child,null,i),t.child=Ci(t,null,a,i)):Sa(e,t,a,i),t.memoizedState=r.state,o&&jo(t,n,!0),t.child}function Aa(e){var t=e.stateNode;t.pendingContext?Mo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Mo(0,t.context,!1),Xi(e,t.containerInfo)}function La(e,t,n,r,o){return gi(),mi(o),t.flags|=256,Sa(e,t,n,r),t.child}var Fa,Da,xa,Ra,Ma={dehydrated:null,treeContext:null,retryLane:0};function _a(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ua(e,t,n){var r,o=t.pendingProps,i=ts.current,a=!1,c=!!(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&!!(2&i)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Io(ts,1&i),null===e)return di(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(c=o.children,e=o.fallback,a?(o=t.mode,a=t.child,c={mode:"hidden",children:c},1&o||null===a?a=_l(c,o,0,null):(a.childLanes=0,a.pendingProps=c),e=Ml(e,o,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=_a(n),t.memoizedState=Ma,e):ja(t,c));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,o,i,a){if(n)return 256&t.flags?(t.flags&=-257,za(e,t,a,r=da(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=_l({mode:"visible",children:r.children},o,0,null),(i=Ml(i,o,a,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,1&t.mode&&Ci(t,e.child,null,a),t.child.memoizedState=_a(a),t.memoizedState=Ma,i);if(!(1&t.mode))return za(e,t,a,null);if("$!"===o.data){if(r=o.nextSibling&&o.nextSibling.dataset)var c=r.dgst;return r=c,za(e,t,a,r=da(i=Error(s(419)),r,void 0))}if(c=!!(a&e.childLanes),wa||c){if(null!==(r=Ac)){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}0!==(o=o&(r.suspendedLanes|a)?0:o)&&o!==i.retryLane&&(i.retryLane=o,Mi(e,o),rl(r,e,o,-1))}return ml(),za(e,t,a,r=da(Error(s(421))))}return"$?"===o.data?(t.flags|=128,t.child=e.child,t=Il.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,ii=uo(o.nextSibling),oi=t,si=!0,ai=null,null!==e&&(Jo[Ko++]=Yo,Jo[Ko++]=Zo,Jo[Ko++]=Xo,Yo=e.id,Zo=e.overflow,Xo=t),t=ja(t,r.children),t.flags|=4096,t)}(e,t,c,o,r,i,n);if(a){a=o.fallback,c=t.mode,r=(i=e.child).sibling;var l={mode:"hidden",children:o.children};return 1&c||t.child===i?(o=xl(i,l)).subtreeFlags=14680064&i.subtreeFlags:((o=t.child).childLanes=0,o.pendingProps=l,t.deletions=null),null!==r?a=xl(r,a):(a=Ml(a,c,n,null)).flags|=2,a.return=t,o.return=t,o.sibling=a,t.child=o,o=a,a=t.child,c=null===(c=e.child.memoizedState)?_a(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},a.memoizedState=c,a.childLanes=e.childLanes&~n,t.memoizedState=Ma,o}return e=(a=e.child).sibling,o=xl(a,{mode:"visible",children:o.children}),!(1&t.mode)&&(o.lanes=n),o.return=t,o.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=o,t.memoizedState=null,o}function ja(e,t){return(t=_l({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function za(e,t,n,r){return null!==r&&mi(r),Ci(t,e.child,null,n),(e=ja(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qa(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ai(e.return,t,n)}function Ba(e,t,n,r,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function $a(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(Sa(e,t,r.children,n),2&(r=ts.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qa(e,n,t);else if(19===e.tag)qa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Io(ts,r),1&t.mode)switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===ns(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),Ba(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===ns(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}Ba(t,!0,n,null,i);break;case"together":Ba(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Ha(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),_c|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=xl(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=xl(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Va(e,t){if(!si)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ga(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=14680064&o.subtreeFlags,r|=14680064&o.flags,o.return=e,o=o.sibling;else for(o=e.child;null!==o;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qa(e,t,n){var r=t.pendingProps;switch(ri(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ga(t),null;case 1:case 17:return xo(t.type)&&Ro(),Ga(t),null;case 3:return r=t.stateNode,Yi(),No(Lo),No(Ao),os(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ai&&(al(ai),ai=null))),Da(e,t),Ga(t),null;case 5:es(t);var o=Ki(Ji.current);if(n=t.type,null!==e&&null!=t.stateNode)xa(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ga(t),null}if(e=Ki(Gi.current),hi(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[fo]=t,r[go]=i,e=!!(1&t.mode),n){case"dialog":zr("cancel",r),zr("close",r);break;case"iframe":case"object":case"embed":zr("load",r);break;case"video":case"audio":for(o=0;o<Mr.length;o++)zr(Mr[o],r);break;case"source":zr("error",r);break;case"img":case"image":case"link":zr("error",r),zr("load",r);break;case"details":zr("toggle",r);break;case"input":X(r,i),zr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},zr("invalid",r);break;case"textarea":ie(r,i),zr("invalid",r)}for(var a in be(n,i),o=null,i)if(i.hasOwnProperty(a)){var l=i[a];"children"===a?"string"==typeof l?r.textContent!==l&&(!0!==i.suppressHydrationWarning&&Zr(r.textContent,l,e),o=["children",l]):"number"==typeof l&&r.textContent!==""+l&&(!0!==i.suppressHydrationWarning&&Zr(r.textContent,l,e),o=["children",""+l]):c.hasOwnProperty(a)&&null!=l&&"onScroll"===a&&zr("scroll",r)}switch(n){case"input":G(r),ee(r,i,!0);break;case"textarea":G(r),ae(r);break;case"select":case"option":break;default:"function"==typeof i.onClick&&(r.onclick=eo)}r=o,t.updateQueue=r,null!==r&&(t.flags|=4)}else{a=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ce(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),"select"===n&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[fo]=t,e[go]=r,Fa(e,t,!1,!1),t.stateNode=e;e:{switch(a=we(n,r),n){case"dialog":zr("cancel",e),zr("close",e),o=r;break;case"iframe":case"object":case"embed":zr("load",e),o=r;break;case"video":case"audio":for(o=0;o<Mr.length;o++)zr(Mr[o],e);o=r;break;case"source":zr("error",e),o=r;break;case"img":case"image":case"link":zr("error",e),zr("load",e),o=r;break;case"details":zr("toggle",e),o=r;break;case"input":X(e,r),o=K(e,r),zr("invalid",e);break;case"option":default:o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=U({},r,{value:void 0}),zr("invalid",e);break;case"textarea":ie(e,r),o=oe(e,r),zr("invalid",e)}for(i in be(n,o),l=o)if(l.hasOwnProperty(i)){var u=l[i];"style"===i?ve(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&pe(e,u):"children"===i?"string"==typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"==typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(c.hasOwnProperty(i)?null!=u&&"onScroll"===i&&zr("scroll",e):null!=u&&w(e,i,u,a))}switch(n){case"input":G(e),ee(e,r,!1);break;case"textarea":G(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+W(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?re(e,!!r.multiple,i,!1):null!=r.defaultValue&&re(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=eo)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ga(t),null;case 6:if(e&&null!=t.stateNode)Ra(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(s(166));if(n=Ki(Ji.current),Ki(Gi.current),hi(t)){if(r=t.stateNode,n=t.memoizedProps,r[fo]=t,(i=r.nodeValue!==n)&&null!==(e=oi))switch(e.tag){case 3:Zr(r.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zr(r.nodeValue,n,!!(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[fo]=t,t.stateNode=r}return Ga(t),null;case 13:if(No(ts),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(si&&null!==ii&&1&t.mode&&!(128&t.flags))fi(),gi(),t.flags|=98560,i=!1;else if(i=hi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[fo]=t}else gi(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ga(t),i=!1}else null!==ai&&(al(ai),ai=null),i=!0;if(!i)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,1&t.mode&&(null===e||1&ts.current?0===Rc&&(Rc=3):ml())),null!==t.updateQueue&&(t.flags|=4),Ga(t),null);case 4:return Yi(),Da(e,t),null===e&&$r(t.stateNode.containerInfo),Ga(t),null;case 10:return Oi(t.type._context),Ga(t),null;case 19:if(No(ts),null===(i=t.memoizedState))return Ga(t),null;if(r=!!(128&t.flags),null===(a=i.rendering))if(r)Va(i,!1);else{if(0!==Rc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(a=ns(e))){for(t.flags|=128,Va(i,!1),null!==(r=a.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(a=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Io(ts,1&ts.current|2),t.child}e=e.sibling}null!==i.tail&&Ye()>$c&&(t.flags|=128,r=!0,Va(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ns(a))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Va(i,!0),null===i.tail&&"hidden"===i.tailMode&&!a.alternate&&!si)return Ga(t),null}else 2*Ye()-i.renderingStartTime>$c&&1073741824!==n&&(t.flags|=128,r=!0,Va(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(null!==(n=i.last)?n.sibling=a:t.child=a,i.last=a)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ye(),t.sibling=null,n=ts.current,Io(ts,r?1&n|2:1&n),t):(Ga(t),null);case 22:case 23:return pl(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&1&t.mode?!!(1073741824&Dc)&&(Ga(t),6&t.subtreeFlags&&(t.flags|=8192)):Ga(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ja(e,t){switch(ri(t),t.tag){case 1:return xo(t.type)&&Ro(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yi(),No(Lo),No(Ao),os(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return es(t),null;case 13:if(No(ts),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));gi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return No(ts),null;case 4:return Yi(),null;case 10:return Oi(t.type._context),null;case 22:case 23:return pl(),null;default:return null}}Fa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Da=function(){},xa=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Ki(Gi.current);var i,s=null;switch(n){case"input":o=K(e,o),r=K(e,r),s=[];break;case"select":o=U({},o,{value:void 0}),r=U({},r,{value:void 0}),s=[];break;case"textarea":o=oe(e,o),r=oe(e,r),s=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(e.onclick=eo)}for(u in be(n,r),n=null,o)if(!r.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var a=o[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(c.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=null!=o?o[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(null!=l||null!=a))if("style"===u)if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(s||(s=[]),s.push(u,n)),n=l;else"dangerouslySetInnerHTML"===u?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(s=s||[]).push(u,l)):"children"===u?"string"!=typeof l&&"number"!=typeof l||(s=s||[]).push(u,""+l):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(c.hasOwnProperty(u)?(null!=l&&"onScroll"===u&&zr("scroll",e),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Ra=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ka=!1,Xa=!1,Ya="function"==typeof WeakSet?WeakSet:Set,Za=null;function ec(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Tl(e,t,n)}else n.current=null}function tc(e,t,n){try{n()}catch(n){Tl(e,t,n)}}var nc=!1;function rc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,void 0!==i&&tc(t,n,i)}o=o.next}while(o!==r)}}function oc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ic(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function sc(e){var t=e.alternate;null!==t&&(e.alternate=null,sc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fo],delete t[go],delete t[vo],delete t[yo],delete t[bo])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ac(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ac(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=eo));else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}function uc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(uc(e,t,n),e=e.sibling;null!==e;)uc(e,t,n),e=e.sibling}var dc=null,pc=!1;function hc(e,t,n){for(n=n.child;null!==n;)fc(e,t,n),n=n.sibling}function fc(e,t,n){if(st&&"function"==typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(e){}switch(n.tag){case 5:Xa||ec(n,t);case 6:var r=dc,o=pc;dc=null,hc(e,t,n),pc=o,null!==(dc=r)&&(pc?(e=dc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dc.removeChild(n.stateNode));break;case 18:null!==dc&&(pc?(e=dc,n=n.stateNode,8===e.nodeType?lo(e.parentNode,n):1===e.nodeType&&lo(e,n),$t(e)):lo(dc,n.stateNode));break;case 4:r=dc,o=pc,dc=n.stateNode.containerInfo,pc=!0,hc(e,t,n),dc=r,pc=o;break;case 0:case 11:case 14:case 15:if(!Xa&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){o=r=r.next;do{var i=o,s=i.destroy;i=i.tag,void 0!==s&&(2&i||4&i)&&tc(n,t,s),o=o.next}while(o!==r)}hc(e,t,n);break;case 1:if(!Xa&&(ec(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(e){Tl(n,t,e)}hc(e,t,n);break;case 21:hc(e,t,n);break;case 22:1&n.mode?(Xa=(r=Xa)||null!==n.memoizedState,hc(e,t,n),Xa=r):hc(e,t,n);break;default:hc(e,t,n)}}function gc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ya),t.forEach((function(t){var r=Ol.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function mc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,a=t,c=a;e:for(;null!==c;){switch(c.tag){case 5:dc=c.stateNode,pc=!1;break e;case 3:case 4:dc=c.stateNode.containerInfo,pc=!0;break e}c=c.return}if(null===dc)throw Error(s(160));fc(i,a,o),dc=null,pc=!1;var l=o.alternate;null!==l&&(l.return=null),o.return=null}catch(e){Tl(o,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vc(t,e),t=t.sibling}function vc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),yc(e),4&r){try{rc(3,e,e.return),oc(3,e)}catch(t){Tl(e,e.return,t)}try{rc(5,e,e.return)}catch(t){Tl(e,e.return,t)}}break;case 1:mc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return);break;case 5:if(mc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return),32&e.flags){var o=e.stateNode;try{he(o,"")}catch(t){Tl(e,e.return,t)}}if(4&r&&null!=(o=e.stateNode)){var i=e.memoizedProps,a=null!==n?n.memoizedProps:i,c=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===c&&"radio"===i.type&&null!=i.name&&Y(o,i),we(c,a);var u=we(c,i);for(a=0;a<l.length;a+=2){var d=l[a],p=l[a+1];"style"===d?ve(o,p):"dangerouslySetInnerHTML"===d?pe(o,p):"children"===d?he(o,p):w(o,d,p,u)}switch(c){case"input":Z(o,i);break;case"textarea":se(o,i);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?re(o,!!i.multiple,f,!1):h!==!!i.multiple&&(null!=i.defaultValue?re(o,!!i.multiple,i.defaultValue,!0):re(o,!!i.multiple,i.multiple?[]:"",!1))}o[go]=i}catch(t){Tl(e,e.return,t)}}break;case 6:if(mc(t,e),yc(e),4&r){if(null===e.stateNode)throw Error(s(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(t){Tl(e,e.return,t)}}break;case 3:if(mc(t,e),yc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{$t(t.containerInfo)}catch(t){Tl(e,e.return,t)}break;case 4:default:mc(t,e),yc(e);break;case 13:mc(t,e),yc(e),8192&(o=e.child).flags&&(i=null!==o.memoizedState,o.stateNode.isHidden=i,!i||null!==o.alternate&&null!==o.alternate.memoizedState||(Bc=Ye())),4&r&&gc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xa=(u=Xa)||d,mc(t,e),Xa=u):mc(t,e),yc(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for(Za=e,d=e.child;null!==d;){for(p=Za=d;null!==Za;){switch(f=(h=Za).child,h.tag){case 0:case 11:case 14:case 15:rc(4,h,h.return);break;case 1:ec(h,h.return);var g=h.stateNode;if("function"==typeof g.componentWillUnmount){r=h,n=h.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(e){Tl(r,n,e)}}break;case 5:ec(h,h.return);break;case 22:if(null!==h.memoizedState){Cc(p);continue}}null!==f?(f.return=h,Za=f):Cc(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{o=p.stateNode,u?"function"==typeof(i=o.style).setProperty?i.setProperty("display","none","important"):i.display="none":(c=p.stateNode,a=null!=(l=p.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,c.style.display=me("display",a))}catch(t){Tl(e,e.return,t)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(t){Tl(e,e.return,t)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:mc(t,e),yc(e),4&r&&gc(e);case 21:}}function yc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ac(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var o=r.stateNode;32&r.flags&&(he(o,""),r.flags&=-33),uc(e,cc(e),o);break;case 3:case 4:var i=r.stateNode.containerInfo;lc(e,cc(e),i);break;default:throw Error(s(161))}}catch(t){Tl(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bc(e,t,n){Za=e,wc(e,t,n)}function wc(e,t,n){for(var r=!!(1&e.mode);null!==Za;){var o=Za,i=o.child;if(22===o.tag&&r){var s=null!==o.memoizedState||Ka;if(!s){var a=o.alternate,c=null!==a&&null!==a.memoizedState||Xa;a=Ka;var l=Xa;if(Ka=s,(Xa=c)&&!l)for(Za=o;null!==Za;)c=(s=Za).child,22===s.tag&&null!==s.memoizedState?kc(o):null!==c?(c.return=s,Za=c):kc(o);for(;null!==i;)Za=i,wc(i,t,n),i=i.sibling;Za=o,Ka=a,Xa=l}Sc(e)}else 8772&o.subtreeFlags&&null!==i?(i.return=o,Za=i):Sc(e)}}function Sc(e){for(;null!==Za;){var t=Za;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Xa||oc(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xa)if(null===n)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:ra(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Wi(t,i,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Wi(t,a,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&$t(p)}}}break;default:throw Error(s(163))}Xa||512&t.flags&&ic(t)}catch(e){Tl(t,t.return,e)}}if(t===e){Za=null;break}if(null!==(n=t.sibling)){n.return=t.return,Za=n;break}Za=t.return}}function Cc(e){for(;null!==Za;){var t=Za;if(t===e){Za=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Za=n;break}Za=t.return}}function kc(e){for(;null!==Za;){var t=Za;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{oc(4,t)}catch(e){Tl(t,n,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var o=t.return;try{r.componentDidMount()}catch(e){Tl(t,o,e)}}var i=t.return;try{ic(t)}catch(e){Tl(t,i,e)}break;case 5:var s=t.return;try{ic(t)}catch(e){Tl(t,s,e)}}}catch(e){Tl(t,t.return,e)}if(t===e){Za=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Za=a;break}Za=t.return}}var Ec,Tc=Math.ceil,Pc=S.ReactCurrentDispatcher,Nc=S.ReactCurrentOwner,Ic=S.ReactCurrentBatchConfig,Oc=0,Ac=null,Lc=null,Fc=0,Dc=0,xc=Po(0),Rc=0,Mc=null,_c=0,Uc=0,jc=0,zc=null,qc=null,Bc=0,$c=1/0,Hc=null,Wc=!1,Vc=null,Gc=null,Qc=!1,Jc=null,Kc=0,Xc=0,Yc=null,Zc=-1,el=0;function tl(){return 6&Oc?Ye():-1!==Zc?Zc:Zc=Ye()}function nl(e){return 1&e.mode?2&Oc&&0!==Fc?Fc&-Fc:null!==vi.transition?(0===el&&(el=mt()),el):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Xt(e.type):1}function rl(e,t,n,r){if(50<Xc)throw Xc=0,Yc=null,Error(s(185));yt(e,n,r),2&Oc&&e===Ac||(e===Ac&&(!(2&Oc)&&(Uc|=n),4===Rc&&cl(e,Fc)),ol(e,r),1===n&&0===Oc&&!(1&t.mode)&&($c=Ye()+500,qo&&Ho()))}function ol(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-at(i),a=1<<s,c=o[s];-1===c?a&n&&!(a&r)||(o[s]=ft(a,t)):c<=t&&(e.expiredLanes|=a),i&=~a}}(e,t);var r=ht(e,e===Ac?Fc:0);if(0===r)null!==n&&Je(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Je(n),1===t)0===e.tag?function(e){qo=!0,$o(e)}(ll.bind(null,e)):$o(ll.bind(null,e)),ao((function(){!(6&Oc)&&Ho()})),n=null;else{switch(St(r)){case 1:n=et;break;case 4:n=tt;break;case 16:default:n=nt;break;case 536870912:n=ot}n=Al(n,il.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function il(e,t){if(Zc=-1,el=0,6&Oc)throw Error(s(327));var n=e.callbackNode;if(kl()&&e.callbackNode!==n)return null;var r=ht(e,e===Ac?Fc:0);if(0===r)return null;if(30&r||r&e.expiredLanes||t)t=vl(e,r);else{t=r;var o=Oc;Oc|=2;var i=gl();for(Ac===e&&Fc===t||(Hc=null,$c=Ye()+500,hl(e,t));;)try{bl();break}catch(t){fl(e,t)}Ii(),Pc.current=i,Oc=o,null!==Lc?t=0:(Ac=null,Fc=0,t=Rc)}if(0!==t){if(2===t&&(0!==(o=gt(e))&&(r=o,t=sl(e,o))),1===t)throw n=Mc,hl(e,0),cl(e,r),ol(e,Ye()),n;if(6===t)cl(e,r);else{if(o=e.current.alternate,!(30&r||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!cr(i(),o))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(o)||(t=vl(e,r),2===t&&(i=gt(e),0!==i&&(r=i,t=sl(e,i))),1!==t)))throw n=Mc,hl(e,0),cl(e,r),ol(e,Ye()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Cl(e,qc,Hc);break;case 3:if(cl(e,r),(130023424&r)===r&&10<(t=Bc+500-Ye())){if(0!==ht(e,0))break;if(((o=e.suspendedLanes)&r)!==r){tl(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=oo(Cl.bind(null,e,qc,Hc),t);break}Cl(e,qc,Hc);break;case 4:if(cl(e,r),(4194240&r)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-at(r);i=1<<a,(a=t[a])>o&&(o=a),r&=~i}if(r=o,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tc(r/1960))-r)){e.timeoutHandle=oo(Cl.bind(null,e,qc,Hc),r);break}Cl(e,qc,Hc);break;default:throw Error(s(329))}}}return ol(e,Ye()),e.callbackNode===n?il.bind(null,e):null}function sl(e,t){var n=zc;return e.current.memoizedState.isDehydrated&&(hl(e,t).flags|=256),2!==(e=vl(e,t))&&(t=qc,qc=n,null!==t&&al(t)),e}function al(e){null===qc?qc=e:qc.push.apply(qc,e)}function cl(e,t){for(t&=~jc,t&=~Uc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function ll(e){if(6&Oc)throw Error(s(327));kl();var t=ht(e,0);if(!(1&t))return ol(e,Ye()),null;var n=vl(e,t);if(0!==e.tag&&2===n){var r=gt(e);0!==r&&(t=r,n=sl(e,r))}if(1===n)throw n=Mc,hl(e,0),cl(e,t),ol(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cl(e,qc,Hc),ol(e,Ye()),null}function ul(e,t){var n=Oc;Oc|=1;try{return e(t)}finally{0===(Oc=n)&&($c=Ye()+500,qo&&Ho())}}function dl(e){null!==Jc&&0===Jc.tag&&!(6&Oc)&&kl();var t=Oc;Oc|=1;var n=Ic.transition,r=wt;try{if(Ic.transition=null,wt=1,e)return e()}finally{wt=r,Ic.transition=n,!(6&(Oc=t))&&Ho()}}function pl(){Dc=xc.current,No(xc)}function hl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,io(n)),null!==Lc)for(n=Lc.return;null!==n;){var r=n;switch(ri(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Ro();break;case 3:Yi(),No(Lo),No(Ao),os();break;case 5:es(r);break;case 4:Yi();break;case 13:case 19:No(ts);break;case 10:Oi(r.type._context);break;case 22:case 23:pl()}n=n.return}if(Ac=e,Lc=e=xl(e.current,null),Fc=Dc=t,Rc=0,Mc=null,jc=Uc=_c=0,qc=zc=null,null!==Di){for(t=0;t<Di.length;t++)if(null!==(r=(n=Di[t]).interleaved)){n.interleaved=null;var o=r.next,i=n.pending;if(null!==i){var s=i.next;i.next=o,r.next=s}n.pending=r}Di=null}return e}function fl(e,t){for(;;){var n=Lc;try{if(Ii(),is.current=Zs,ds){for(var r=cs.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}ds=!1}if(as=0,us=ls=cs=null,ps=!1,hs=0,Nc.current=null,null===n||null===n.return){Rc=1,Mc=t,Lc=null;break}e:{var i=e,a=n.return,c=n,l=t;if(t=Fc,c.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var u=l,d=c,p=d.tag;if(!(1&d.mode||0!==p&&11!==p&&15!==p)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=va(a);if(null!==f){f.flags&=-257,ya(f,a,c,0,t),1&f.mode&&ma(i,u,t),l=u;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}if(!(1&t)){ma(i,u,t),ml();break e}l=Error(s(426))}else if(si&&1&c.mode){var v=va(a);if(null!==v){!(65536&v.flags)&&(v.flags|=256),ya(v,a,c,0,t),mi(ua(l,c));break e}}i=l=ua(l,c),4!==Rc&&(Rc=2),null===zc?zc=[i]:zc.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,$i(i,fa(0,l,t));break e;case 1:c=l;var y=i.type,b=i.stateNode;if(!(128&i.flags||"function"!=typeof y.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==Gc&&Gc.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,$i(i,ga(i,c,t));break e}}i=i.return}while(null!==i)}Sl(n)}catch(e){t=e,Lc===n&&null!==n&&(Lc=n=n.return);continue}break}}function gl(){var e=Pc.current;return Pc.current=Zs,null===e?Zs:e}function ml(){0!==Rc&&3!==Rc&&2!==Rc||(Rc=4),null===Ac||!(268435455&_c)&&!(268435455&Uc)||cl(Ac,Fc)}function vl(e,t){var n=Oc;Oc|=2;var r=gl();for(Ac===e&&Fc===t||(Hc=null,hl(e,t));;)try{yl();break}catch(t){fl(e,t)}if(Ii(),Oc=n,Pc.current=r,null!==Lc)throw Error(s(261));return Ac=null,Fc=0,Rc}function yl(){for(;null!==Lc;)wl(Lc)}function bl(){for(;null!==Lc&&!Ke();)wl(Lc)}function wl(e){var t=Ec(e.alternate,e,Dc);e.memoizedProps=e.pendingProps,null===t?Sl(e):Lc=t,Nc.current=null}function Sl(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Ja(n,t)))return n.flags&=32767,void(Lc=n);if(null===e)return Rc=6,void(Lc=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Qa(n,t,Dc)))return void(Lc=n);if(null!==(t=t.sibling))return void(Lc=t);Lc=t=e}while(null!==t);0===Rc&&(Rc=5)}function Cl(e,t,n){var r=wt,o=Ic.transition;try{Ic.transition=null,wt=1,function(e,t,n,r){do{kl()}while(null!==Jc);if(6&Oc)throw Error(s(327));n=e.finishedWork;var o=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-at(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}(e,i),e===Ac&&(Lc=Ac=null,Fc=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Qc||(Qc=!0,Al(nt,(function(){return kl(),null}))),i=!!(15990&n.flags),!!(15990&n.subtreeFlags)||i){i=Ic.transition,Ic.transition=null;var a=wt;wt=1;var c=Oc;Oc|=4,Nc.current=null,function(e,t){if(to=Wt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(e){n=null;break e}var a=0,c=-1,l=-1,u=0,d=0,p=e,h=null;t:for(;;){for(var f;p!==n||0!==o&&3!==p.nodeType||(c=a+o),p!==i||0!==r&&3!==p.nodeType||(l=a+r),3===p.nodeType&&(a+=p.nodeValue.length),null!==(f=p.firstChild);)h=p,p=f;for(;;){if(p===e)break t;if(h===n&&++u===o&&(c=a),h===i&&++d===r&&(l=a),null!==(f=p.nextSibling))break;h=(p=h).parentNode}p=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(no={focusedElem:e,selectionRange:n},Wt=!1,Za=t;null!==Za;)if(e=(t=Za).child,1028&t.subtreeFlags&&null!==e)e.return=t,Za=e;else for(;null!==Za;){t=Za;try{var g=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:ra(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(e){Tl(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Za=e;break}Za=t.return}g=nc,nc=!1}(e,n),vc(n,e),gr(no),Wt=!!to,no=to=null,e.current=n,bc(n,e,o),Xe(),Oc=c,wt=a,Ic.transition=i}else e.current=n;if(Qc&&(Qc=!1,Jc=e,Kc=o),i=e.pendingLanes,0===i&&(Gc=null),function(e){if(st&&"function"==typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),ol(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Wc)throw Wc=!1,e=Vc,Vc=null,e;!!(1&Kc)&&0!==e.tag&&kl(),i=e.pendingLanes,1&i?e===Yc?Xc++:(Xc=0,Yc=e):Xc=0,Ho()}(e,t,n,r)}finally{Ic.transition=o,wt=r}return null}function kl(){if(null!==Jc){var e=St(Kc),t=Ic.transition,n=wt;try{if(Ic.transition=null,wt=16>e?16:e,null===Jc)var r=!1;else{if(e=Jc,Jc=null,Kc=0,6&Oc)throw Error(s(331));var o=Oc;for(Oc|=4,Za=e.current;null!==Za;){var i=Za,a=i.child;if(16&Za.flags){var c=i.deletions;if(null!==c){for(var l=0;l<c.length;l++){var u=c[l];for(Za=u;null!==Za;){var d=Za;switch(d.tag){case 0:case 11:case 15:rc(8,d,i)}var p=d.child;if(null!==p)p.return=d,Za=p;else for(;null!==Za;){var h=(d=Za).sibling,f=d.return;if(sc(d),d===u){Za=null;break}if(null!==h){h.return=f,Za=h;break}Za=f}}}var g=i.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Za=i}}if(2064&i.subtreeFlags&&null!==a)a.return=i,Za=a;else e:for(;null!==Za;){if(2048&(i=Za).flags)switch(i.tag){case 0:case 11:case 15:rc(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Za=y;break e}Za=i.return}}var b=e.current;for(Za=b;null!==Za;){var w=(a=Za).child;if(2064&a.subtreeFlags&&null!==w)w.return=a,Za=w;else e:for(a=b;null!==Za;){if(2048&(c=Za).flags)try{switch(c.tag){case 0:case 11:case 15:oc(9,c)}}catch(e){Tl(c,c.return,e)}if(c===a){Za=null;break e}var S=c.sibling;if(null!==S){S.return=c.return,Za=S;break e}Za=c.return}}if(Oc=o,Ho(),st&&"function"==typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(e){}r=!0}return r}finally{wt=n,Ic.transition=t}}return!1}function El(e,t,n){e=qi(e,t=fa(0,t=ua(n,t),1),1),t=tl(),null!==e&&(yt(e,1,t),ol(e,t))}function Tl(e,t,n){if(3===e.tag)El(e,e,n);else for(;null!==t;){if(3===t.tag){El(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Gc||!Gc.has(r))){t=qi(t,e=ga(t,e=ua(n,e),1),1),e=tl(),null!==t&&(yt(t,1,e),ol(t,e));break}}t=t.return}}function Pl(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tl(),e.pingedLanes|=e.suspendedLanes&n,Ac===e&&(Fc&n)===n&&(4===Rc||3===Rc&&(130023424&Fc)===Fc&&500>Ye()-Bc?hl(e,0):jc|=n),ol(e,t)}function Nl(e,t){0===t&&(1&e.mode?(t=dt,!(130023424&(dt<<=1))&&(dt=4194304)):t=1);var n=tl();null!==(e=Mi(e,t))&&(yt(e,t,n),ol(e,n))}function Il(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nl(e,n)}function Ol(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;null!==o&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Nl(e,n)}function Al(e,t){return Qe(e,t)}function Ll(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fl(e,t,n,r){return new Ll(e,t,n,r)}function Dl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function xl(e,t){var n=e.alternate;return null===n?((n=Fl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rl(e,t,n,r,o,i){var a=2;if(r=e,"function"==typeof e)Dl(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case E:return Ml(n.children,o,i,t);case T:a=8,o|=8;break;case P:return(e=Fl(12,n,t,2|o)).elementType=P,e.lanes=i,e;case A:return(e=Fl(13,n,t,o)).elementType=A,e.lanes=i,e;case L:return(e=Fl(19,n,t,o)).elementType=L,e.lanes=i,e;case x:return _l(n,o,i,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case N:a=10;break e;case I:a=9;break e;case O:a=11;break e;case F:a=14;break e;case D:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Fl(a,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function Ml(e,t,n,r){return(e=Fl(7,e,r,t)).lanes=n,e}function _l(e,t,n,r){return(e=Fl(22,e,r,t)).elementType=x,e.lanes=n,e.stateNode={isHidden:!1},e}function Ul(e,t,n){return(e=Fl(6,e,null,t)).lanes=n,e}function jl(e,t,n){return(t=Fl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zl(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vt(0),this.expirationTimes=vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vt(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function ql(e,t,n,r,o,i,s,a,c){return e=new zl(e,t,n,a,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Fl(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ui(i),e}function Bl(e){if(!e)return Oo;e:{if($e(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(xo(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(xo(n))return _o(e,n,t)}return t}function $l(e,t,n,r,o,i,s,a,c){return(e=ql(n,r,!0,e,0,i,0,a,c)).context=Bl(null),n=e.current,(i=zi(r=tl(),o=nl(n))).callback=null!=t?t:null,qi(n,i,o),e.current.lanes=o,yt(e,o,r),ol(e,r),e}function Hl(e,t,n,r){var o=t.current,i=tl(),s=nl(o);return n=Bl(n),null===t.context?t.context=n:t.pendingContext=n,(t=zi(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=qi(o,t,s))&&(rl(e,o,s,i),Bi(e,o,s)),s}function Wl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gl(e,t){Vl(e,t),(e=e.alternate)&&Vl(e,t)}Ec=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Lo.current)wa=!0;else{if(!(e.lanes&n||128&t.flags))return wa=!1,function(e,t,n){switch(t.tag){case 3:Aa(t),gi();break;case 5:Zi(t);break;case 1:xo(t.type)&&Uo(t);break;case 4:Xi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Io(Ei,r._currentValue),r._currentValue=o;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Io(ts,1&ts.current),t.flags|=128,null):n&t.child.childLanes?Ua(e,t,n):(Io(ts,1&ts.current),null!==(e=Wa(e,t,n))?e.sibling:null);Io(ts,1&ts.current);break;case 19:if(r=!!(n&t.childLanes),128&e.flags){if(r)return $a(e,t,n);t.flags|=128}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),Io(ts,ts.current),r)break;return null;case 22:case 23:return t.lanes=0,Ta(e,t,n)}return Wa(e,t,n)}(e,t,n);wa=!!(131072&e.flags)}else wa=!1,si&&1048576&t.flags&&ti(t,Qo,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ha(e,t),e=t.pendingProps;var o=Do(t,Ao.current);Li(t,n),o=vs(null,t,r,e,o,n);var i=ys();return t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,xo(r)?(i=!0,Uo(t)):i=!1,t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,Ui(t),o.updater=ia,t.stateNode=o,o._reactInternals=t,la(t,r,e,n),t=Oa(null,t,r,!0,i,n)):(t.tag=0,si&&i&&ni(t),Sa(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ha(e,t),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"==typeof e)return Dl(e)?1:0;if(null!=e){if((e=e.$$typeof)===O)return 11;if(e===F)return 14}return 2}(r),e=ra(r,e),o){case 0:t=Na(null,t,r,e,n);break e;case 1:t=Ia(null,t,r,e,n);break e;case 11:t=Ca(null,t,r,e,n);break e;case 14:t=ka(null,t,r,ra(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,Na(e,t,r,o=t.elementType===r?o:ra(r,o),n);case 1:return r=t.type,o=t.pendingProps,Ia(e,t,r,o=t.elementType===r?o:ra(r,o),n);case 3:e:{if(Aa(t),null===e)throw Error(s(387));r=t.pendingProps,o=(i=t.memoizedState).element,ji(e,t),Hi(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=La(e,t,r,n,o=ua(Error(s(423)),t));break e}if(r!==o){t=La(e,t,r,n,o=ua(Error(s(424)),t));break e}for(ii=uo(t.stateNode.containerInfo.firstChild),oi=t,si=!0,ai=null,n=ki(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(gi(),r===o){t=Wa(e,t,n);break e}Sa(e,t,r,n)}t=t.child}return t;case 5:return Zi(t),null===e&&di(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,a=o.children,ro(r,o)?a=null:null!==i&&ro(r,i)&&(t.flags|=32),Pa(e,t),Sa(e,t,a,n),t.child;case 6:return null===e&&di(t),null;case 13:return Ua(e,t,n);case 4:return Xi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ci(t,null,r,n):Sa(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,Ca(e,t,r,o=t.elementType===r?o:ra(r,o),n);case 7:return Sa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Sa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,a=o.value,Io(Ei,r._currentValue),r._currentValue=a,null!==i)if(cr(i.value,a)){if(i.children===o.children&&!Lo.current){t=Wa(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var c=i.dependencies;if(null!==c){a=i.child;for(var l=c.firstContext;null!==l;){if(l.context===r){if(1===i.tag){(l=zi(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}i.lanes|=n,null!==(l=i.alternate)&&(l.lanes|=n),Ai(i.return,n,t),c.lanes|=n;break}l=l.next}}else if(10===i.tag)a=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(a=i.return))throw Error(s(341));a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Ai(a,n,t),a=i.sibling}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===t){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}Sa(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,Li(t,n),r=r(o=Fi(o)),t.flags|=1,Sa(e,t,r,n),t.child;case 14:return o=ra(r=t.type,t.pendingProps),ka(e,t,r,o=ra(r.type,o),n);case 15:return Ea(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:ra(r,o),Ha(e,t),t.tag=1,xo(r)?(e=!0,Uo(t)):e=!1,Li(t,n),aa(t,r,o),la(t,r,o,n),Oa(null,t,r,!0,e,n);case 19:return $a(e,t,n);case 22:return Ta(e,t,n)}throw Error(s(156,t.tag))};var Ql="function"==typeof reportError?reportError:function(e){r.error(e)};function Jl(e){this._internalRoot=e}function Kl(e){this._internalRoot=e}function Xl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Yl(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zl(){}function eu(e,t,n,r,o){var i=n._reactRootContainer;if(i){var s=i;if("function"==typeof o){var a=o;o=function(){var e=Wl(s);a.call(e)}}Hl(t,s,e,o)}else s=function(e,t,n,r,o){if(o){if("function"==typeof r){var i=r;r=function(){var e=Wl(s);i.call(e)}}var s=$l(t,r,e,0,null,!1,0,"",Zl);return e._reactRootContainer=s,e[mo]=s.current,$r(8===e.nodeType?e.parentNode:e),dl(),s}for(;o=e.lastChild;)e.removeChild(o);if("function"==typeof r){var a=r;r=function(){var e=Wl(c);a.call(e)}}var c=ql(e,0,!1,null,0,!1,0,"",Zl);return e._reactRootContainer=c,e[mo]=c.current,$r(8===e.nodeType?e.parentNode:e),dl((function(){Hl(t,c,n,r)})),c}(n,t,e,o,r);return Wl(s)}Kl.prototype.render=Jl.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Hl(e,t,null,null)},Kl.prototype.unmount=Jl.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dl((function(){Hl(null,e,null,null)})),t[mo]=null}},Kl.prototype.unstable_scheduleHydration=function(e){if(e){var t=Tt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<xt.length&&0!==t&&t<xt[n].priority;n++);xt.splice(n,0,e),0===n&&Ut(e)}},Ct=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=pt(t.pendingLanes);0!==n&&(bt(t,1|n),ol(t,Ye()),!(6&Oc)&&($c=Ye()+500,Ho()))}break;case 13:dl((function(){var t=Mi(e,1);if(null!==t){var n=tl();rl(t,e,1,n)}})),Gl(e,1)}},kt=function(e){if(13===e.tag){var t=Mi(e,134217728);if(null!==t)rl(t,e,134217728,tl());Gl(e,134217728)}},Et=function(e){if(13===e.tag){var t=nl(e),n=Mi(e,t);if(null!==n)rl(n,e,t,tl());Gl(e,t)}},Tt=function(){return wt},Pt=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},ke=function(e,t,n){switch(t){case"input":if(Z(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=ko(r);if(!o)throw Error(s(90));Q(r),Z(r,o)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&re(e,!!n.multiple,t,!1)}},Oe=ul,Ae=dl;var tu={usingClientEntryPoint:!1,Events:[So,Co,ko,Ne,Ie,ul]},nu={findFiberByHostInstance:wo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ou=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ou.isDisabled&&ou.supportsFiber)try{it=ou.inject(ru),st=ou}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xl(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xl(e))throw Error(s(299));var n=!1,r="",o=Ql;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(o=t.onRecoverableError)),t=ql(e,1,!1,null,0,n,0,r,o),e[mo]=t.current,$r(8===e.nodeType?e.parentNode:e),new Jl(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return dl(e)},t.hydrate=function(e,t,n){if(!Yl(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xl(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,o=!1,i="",a=Ql;if(null!=n&&(!0===n.unstable_strictMode&&(o=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=$l(t,null,e,1,null!=n?n:null,o,0,i,a),e[mo]=t.current,$r(e),r)for(e=0;e<r.length;e++)o=(o=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Kl(t)},t.render=function(e,t,n){if(!Yl(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Yl(e))throw Error(s(40));return!!e._reactRootContainer&&(dl((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[mo]=null}))})),!0)},t.unstable_batchedUpdates=ul,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Yl(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},5561:(e,t,n)=>{"use strict";var r=n(544);t.H=r.createRoot,r.hydrateRoot},544:(e,t,n)=>{"use strict";var r=n(9307);!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){r.error(e)}}(),e.exports=n(9584)},9306:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),o=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,g(w,v.prototype),w.isPureReactComponent=!0;var S=Array.isArray,C=Object.prototype.hasOwnProperty,k={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,r){var o,i={},s=null,a=null;if(null!=t)for(o in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)C.call(t,o)&&!E.hasOwnProperty(o)&&(i[o]=t[o]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var l=Array(c),u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(o in c=e.defaultProps)void 0===i[o]&&(i[o]=c[o]);return{$$typeof:n,type:e,key:s,ref:a,props:i,_owner:k.current}}function P(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var N=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function O(e,t,o,i,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return s=s(c=e),e=""===i?"."+I(c,0):i,S(s)?(o="",null!=e&&(o=e.replace(N,"$&/")+"/"),O(s,t,o,"",(function(e){return e}))):null!=s&&(P(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,o+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(N,"$&/")+"/")+e)),t.push(s)),1;if(c=0,i=""===i?".":i+":",S(e))for(var l=0;l<e.length;l++){var u=i+I(a=e[l],l);c+=O(a,t,o,u,s)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),l=0;!(a=e.next()).done;)c+=O(a=a.value,t,o,u=i+I(a,l++),s);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function A(e,t,n){if(null==e)return e;var r=[],o=0;return O(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function L(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var F={current:null},D={transition:null},x={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:D,ReactCurrentOwner:k};function R(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!P(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=o,t.Profiler=s,t.PureComponent=b,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x,t.act=R,t.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=g({},e.props),i=e.key,s=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,a=k.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)C.call(t,l)&&!E.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=r;else if(1<l){c=Array(l);for(var u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}return{$$typeof:n,type:e.type,key:i,ref:s,props:o,_owner:a}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=P,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:L}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=R,t.useCallback=function(e,t){return F.current.useCallback(e,t)},t.useContext=function(e){return F.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return F.current.useDeferredValue(e)},t.useEffect=function(e,t){return F.current.useEffect(e,t)},t.useId=function(){return F.current.useId()},t.useImperativeHandle=function(e,t,n){return F.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return F.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return F.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return F.current.useMemo(e,t)},t.useReducer=function(e,t,n){return F.current.useReducer(e,t,n)},t.useRef=function(e){return F.current.useRef(e)},t.useState=function(e){return F.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return F.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return F.current.useTransition()},t.version="18.3.1"},7011:(e,t,n)=>{"use strict";e.exports=n(9306)},358:(e,t,n)=>{"use strict";var r=n(9307);function o(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,o=e[r];if(!(0<a(o,t)))break e;e[r]=t,e[n]=o,n=r}}function i(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length,i=o>>>1;r<i;){var s=2*(r+1)-1,c=e[s],l=s+1,u=e[l];if(0>a(c,n))l<o&&0>a(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[s]=n,r=s);else{if(!(l<o&&0>a(u,n)))break e;e[r]=u,e[l]=n,r=l}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var c=performance;t.unstable_now=function(){return c.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var d=[],p=[],h=1,f=null,g=3,m=!1,v=!1,y=!1,b="function"==typeof setTimeout?setTimeout:null,w="function"==typeof clearTimeout?clearTimeout:null,S="undefined"!=typeof setImmediate?setImmediate:null;function C(e){for(var t=i(p);null!==t;){if(null===t.callback)s(p);else{if(!(t.startTime<=e))break;s(p),t.sortIndex=t.expirationTime,o(d,t)}t=i(p)}}function k(e){if(y=!1,C(e),!v)if(null!==i(d))v=!0,R(E);else{var t=i(p);null!==t&&M(k,t.startTime-e)}}function E(e,n){v=!1,y&&(y=!1,w(I),I=-1),m=!0;var r=g;try{for(C(n),f=i(d);null!==f&&(!(f.expirationTime>n)||e&&!L());){var o=f.callback;if("function"==typeof o){f.callback=null,g=f.priorityLevel;var a=o(f.expirationTime<=n);n=t.unstable_now(),"function"==typeof a?f.callback=a:f===i(d)&&s(d),C(n)}else s(d);f=i(d)}if(null!==f)var c=!0;else{var l=i(p);null!==l&&M(k,l.startTime-n),c=!1}return c}finally{f=null,g=r,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T,P=!1,N=null,I=-1,O=5,A=-1;function L(){return!(t.unstable_now()-A<O)}function F(){if(null!==N){var e=t.unstable_now();A=e;var n=!0;try{n=N(!0,e)}finally{n?T():(P=!1,N=null)}}else P=!1}if("function"==typeof S)T=function(){S(F)};else if("undefined"!=typeof MessageChannel){var D=new MessageChannel,x=D.port2;D.port1.onmessage=F,T=function(){x.postMessage(null)}}else T=function(){b(F,0)};function R(e){N=e,P||(P=!0,T())}function M(e,n){I=b((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,R(E))},t.unstable_forceFrameRate=function(e){0>e||125<e?r.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return i(d)},t.unstable_next=function(e){switch(g){case 1:case 2:case 3:var t=3;break;default:t=g}var n=g;g=t;try{return e()}finally{g=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=g;g=e;try{return t()}finally{g=n}},t.unstable_scheduleCallback=function(e,n,r){var s=t.unstable_now();switch("object"==typeof r&&null!==r?r="number"==typeof(r=r.delay)&&0<r?s+r:s:r=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:n,priorityLevel:e,startTime:r,expirationTime:a=r+a,sortIndex:-1},r>s?(e.sortIndex=r,o(p,e),null===i(d)&&e===i(p)&&(y?(w(I),I=-1):y=!0,M(k,r-s))):(e.sortIndex=a,o(d,e),v||m||(v=!0,R(E))),e},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(e){var t=g;return function(){var n=g;g=t;try{return e.apply(this,arguments)}finally{g=n}}}},9593:(e,t,n)=>{"use strict";e.exports=n(358)},6650:(e,t,n)=>{"use strict";var r=n(7216),o=n(3457),i=n(3867)(),s=n(600),a=n(9230),c=r("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new a("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||c(t)!==t)throw new a("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,l=!0;if("length"in e&&s){var u=s(e,"length");u&&!u.configurable&&(r=!1),u&&!u.writable&&(l=!1)}return(r||l||!n)&&(i?o(e,"length",t,!0,!0):o(e,"length",t)),e}},3489:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},994:(e,t,n)=>{"use strict";var r=n(4689),o=n(6534),i=n(731),s=n(4460);function a(e){return e.call.bind(e)}var c="undefined"!=typeof BigInt,l="undefined"!=typeof Symbol,u=a(Object.prototype.toString),d=a(Number.prototype.valueOf),p=a(String.prototype.valueOf),h=a(Boolean.prototype.valueOf);if(c)var f=a(BigInt.prototype.valueOf);if(l)var g=a(Symbol.prototype.valueOf);function m(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function v(e){return"[object Map]"===u(e)}function y(e){return"[object Set]"===u(e)}function b(e){return"[object WeakMap]"===u(e)}function w(e){return"[object WeakSet]"===u(e)}function S(e){return"[object ArrayBuffer]"===u(e)}function C(e){return"undefined"!=typeof ArrayBuffer&&(S.working?S(e):e instanceof ArrayBuffer)}function k(e){return"[object DataView]"===u(e)}function E(e){return"undefined"!=typeof DataView&&(k.working?k(e):e instanceof DataView)}t.isArgumentsObject=r,t.isGeneratorFunction=o,t.isTypedArray=s,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||E(e)},t.isUint8Array=function(e){return"Uint8Array"===i(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},t.isUint16Array=function(e){return"Uint16Array"===i(e)},t.isUint32Array=function(e){return"Uint32Array"===i(e)},t.isInt8Array=function(e){return"Int8Array"===i(e)},t.isInt16Array=function(e){return"Int16Array"===i(e)},t.isInt32Array=function(e){return"Int32Array"===i(e)},t.isFloat32Array=function(e){return"Float32Array"===i(e)},t.isFloat64Array=function(e){return"Float64Array"===i(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},v.working="undefined"!=typeof Map&&v(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(v.working?v(e):e instanceof Map)},y.working="undefined"!=typeof Set&&y(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(y.working?y(e):e instanceof Set)},b.working="undefined"!=typeof WeakMap&&b(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(b.working?b(e):e instanceof WeakMap)},w.working="undefined"!=typeof WeakSet&&w(new WeakSet),t.isWeakSet=function(e){return w(e)},S.working="undefined"!=typeof ArrayBuffer&&S(new ArrayBuffer),t.isArrayBuffer=C,k.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&k(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=E;var T="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function P(e){return"[object SharedArrayBuffer]"===u(e)}function N(e){return void 0!==T&&(void 0===P.working&&(P.working=P(new T)),P.working?P(e):e instanceof T)}function I(e){return m(e,d)}function O(e){return m(e,p)}function A(e){return m(e,h)}function L(e){return c&&m(e,f)}function F(e){return l&&m(e,g)}t.isSharedArrayBuffer=N,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===u(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===u(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===u(e)},t.isGeneratorObject=function(e){return"[object Generator]"===u(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===u(e)},t.isNumberObject=I,t.isStringObject=O,t.isBooleanObject=A,t.isBigIntObject=L,t.isSymbolObject=F,t.isBoxedPrimitive=function(e){return I(e)||O(e)||A(e)||L(e)||F(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(C(e)||N(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},1747:(e,t,n)=>{var r=n(7131),o=n(9307),i=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},s=/%[sdj%]/g;t.format=function(e){if(!w(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(u(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,i=String(e).replace(s,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),a=r[n];n<o;a=r[++n])y(a)||!k(a)?i+=" "+a:i+=" "+u(a);return i},t.deprecate=function(e,n){if(void 0!==r&&!0===r.noDeprecation)return e;if(void 0===r)return function(){return t.deprecate(e,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(n);r.traceDeprecation?o.trace(n):o.error(n),i=!0}return e.apply(this,arguments)}};var a={},c=/^$/;if(r.env.NODE_DEBUG){var l=r.env.NODE_DEBUG;l=l.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),c=new RegExp("^"+l+"$","i")}function u(e,n){var r={seen:[],stylize:p};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),v(n)?r.showHidden=n:n&&t._extend(r,n),S(r.showHidden)&&(r.showHidden=!1),S(r.depth)&&(r.depth=2),S(r.colors)&&(r.colors=!1),S(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=d),h(r,e,r.depth)}function d(e,t){var n=u.styles[t];return n?"["+u.colors[n][0]+"m"+e+"["+u.colors[n][1]+"m":e}function p(e,t){return e}function h(e,n,r){if(e.customInspect&&n&&P(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return w(o)||(o=h(e,o,r)),o}var i=function(e,t){if(S(t))return e.stylize("undefined","undefined");if(w(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(b(t))return e.stylize(""+t,"number");if(v(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(e,n);if(i)return i;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),T(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return f(n);if(0===s.length){if(P(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(C(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return f(n)}var l,u="",d=!1,p=["{","}"];(m(n)&&(d=!0,p=["[","]"]),P(n))&&(u=" [Function"+(n.name?": "+n.name:"")+"]");return C(n)&&(u=" "+RegExp.prototype.toString.call(n)),E(n)&&(u=" "+Date.prototype.toUTCString.call(n)),T(n)&&(u=" "+f(n)),0!==s.length||d&&0!=n.length?r<0?C(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=d?function(e,t,n,r,o){for(var i=[],s=0,a=t.length;s<a;++s)A(t,String(s))?i.push(g(e,t,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(g(e,t,n,r,o,!0))})),i}(e,n,r,a,s):s.map((function(t){return g(e,n,r,a,t,d)})),e.seen.pop(),function(e,t,n){var r=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(r>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(l,u,p)):p[0]+u+p[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function g(e,t,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),A(r,o)||(s="["+o+"]"),a||(e.seen.indexOf(c.value)<0?(a=y(n)?h(e,c.value,null):h(e,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(e){return"  "+e})).join("\n").slice(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),S(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.slice(1,-1),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function m(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function y(e){return null===e}function b(e){return"number"==typeof e}function w(e){return"string"==typeof e}function S(e){return void 0===e}function C(e){return k(e)&&"[object RegExp]"===N(e)}function k(e){return"object"==typeof e&&null!==e}function E(e){return k(e)&&"[object Date]"===N(e)}function T(e){return k(e)&&("[object Error]"===N(e)||e instanceof Error)}function P(e){return"function"==typeof e}function N(e){return Object.prototype.toString.call(e)}function I(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!a[e])if(c.test(e)){var n=r.pid;a[e]=function(){var r=t.format.apply(t,arguments);o.error("%s %d: %s",e,n,r)}}else a[e]=function(){};return a[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=n(994),t.isArray=m,t.isBoolean=v,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=b,t.isString=w,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=S,t.isRegExp=C,t.types.isRegExp=C,t.isObject=k,t.isDate=E,t.types.isDate=E,t.isError=T,t.types.isNativeError=T,t.isFunction=P,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(3489);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;o.log("%s - %s",(e=new Date,n=[I(e.getHours()),I(e.getMinutes()),I(e.getSeconds())].join(":"),[e.getDate(),O[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=n(5515),t._extend=function(e,t){if(!t||!k(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var L="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function F(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(L&&e[L]){var t;if("function"!=typeof(t=e[L]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,L,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,o)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),L&&Object.defineProperty(t,L,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,i(e))},t.promisify.custom=L,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var o=t.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,s=function(){return o.apply(i,arguments)};e.apply(this,t).then((function(e){r.nextTick(s.bind(null,null,e))}),(function(e){r.nextTick(F.bind(null,e,s))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,i(e)),t}},7288:(e,t,n)=>{"use strict";var r;n.d(t,{A:()=>d});var o=new Uint8Array(16);function i(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(o)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const a=function(e){return"string"==typeof e&&s.test(e)};for(var c=[],l=0;l<256;++l)c.push((l+256).toString(16).substr(1));const u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!a(n))throw TypeError("Stringified UUID is invalid");return n};const d=function(e,t,n){var r=(e=e||{}).random||(e.rng||i)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return u(r)}},9535:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});const r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const i=new Uint8Array(16);function s(){if(!o&&(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!o))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(i)}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function c(e,t=0){return a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]}const l=function(e,t,n){if(r.randomUUID&&!t&&!e)return r.randomUUID();const o=(e=e||{}).random||(e.rng||s)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=o[e];return t}return c(o)}},731:(e,t,n)=>{"use strict";var r=n(6034),o=n(276),i=n(9527),s=n(715),a=n(600),c=s("Object.prototype.toString"),l=n(9e3)(),u="undefined"==typeof globalThis?n.g:globalThis,d=o(),p=s("String.prototype.slice"),h=Object.getPrototypeOf,f=s("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},g={__proto__:null};r(d,l&&a&&h?function(e){var t=new u[e];if(Symbol.toStringTag in t){var n=h(t),r=a(n,Symbol.toStringTag);if(!r){var o=h(n);r=a(o,Symbol.toStringTag)}g["$"+e]=i(r.get)}}:function(e){var t=new u[e],n=t.slice||t.set;n&&(g["$"+e]=i(n))});e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!l){var t=p(c(e),8,-1);return f(d,t)>-1?t:"Object"===t&&function(e){var t=!1;return r(g,(function(n,r){if(!t)try{n(e),t=p(r,1)}catch(e){}})),t}(e)}return a?function(e){var t=!1;return r(g,(function(n,r){if(!t)try{"$"+n(e)===r&&(t=p(r,1))}catch(e){}})),t}(e):null}},7232:(e,t,n)=>{"use strict";t.b=void 0;var r=n(6580);Object.defineProperty(t,"b",{enumerable:!0,get:function(){return r.EventEmitter}})},276:(e,t,n)=>{"use strict";var r=n(4808),o="undefined"==typeof globalThis?n.g:globalThis;e.exports=function(){for(var e=[],t=0;t<r.length;t++)"function"==typeof o[r[t]]&&(e[e.length]=r[t]);return e}},8505:(e,t,n)=>{"use strict";n.d(t,{AH:()=>o,O0:()=>i});var r=n(6277);const o=e=>r.Ss.from(e,"base64").toString("utf8"),i=e=>r.Ss.from(e,"utf8").toString("base64")},6277:(e,t,n)=>{"use strict";n.d(t,{JR:()=>s,Km:()=>o,Ss:()=>c,Xg:()=>i});var r=n(3499);function o(e,t){switch(t){case"base64":return r.fromByteArray(e);case"utf8":case"utf-8":case void 0:return(new TextDecoder).decode(e);default:throw new Error("invalid/unsupported encoding")}}const i=(e,t)=>c.from(e,t).buffer,s=(e,t)=>c.from(e).toString(t);function a(e){const t=e;return e instanceof ArrayBuffer||"object"==typeof t&&null!==t&&"number"==typeof t.byteLength&&"function"==typeof t.slice&&void 0===t.byteOffset&&void 0===t.buffer}class c extends Uint8Array{toString(e){return o(this,e)}static from(e,t,n){if("string"==typeof e)return c.fromString(e,t);if(null!==e&&"object"==typeof e&&a(e.buffer))return c.fromArrayBuffer(e.buffer,e.byteOffset,e.byteLength);if(a(e))return c.fromArrayBuffer(e,t,n);throw new TypeError("Input value was neither a string nor an ArrayBuffer.")}static fromArrayBuffer(e,t,n){const r=t??0,o=n??e.byteLength-r;if(r<0||r>e.byteLength||o<0||o+r>e.byteLength)throw new RangeError("Invalid range specified.");return new c(e,r,o)}static fromString(e,t){switch(t){case"base64":{const t=this.sanitizeBase64(e),n=r.toByteArray(t);return new c(n.buffer)}case"utf8":case"utf-8":case void 0:{const t=(new TextEncoder).encode(e);return new c(t.buffer)}default:throw new Error("invalid/unsupported encoding")}}static isBuffer(e){throw new Error("unimplemented")}static sanitizeBase64(e){let t=e;if(t=t.split("=")[0],t=t.replace(/[^\w+-/]/g,""),t.length%4!=0){t+=["","===","==","="][t.length%4]}return t}}},9032:(e,t,n)=>{"use strict";n.d(t,{yi:()=>o});const r={supportedFeatures:new Set,generation:0,pkgVersion:"unknown"};function o(e,t){const n=t??r;let o=!0;const i=[];n.generation<e.minSupportedGeneration&&(o=!1);for(const t of e.requiredFeatures)n.supportedFeatures.has(t)||i.push(t);return o&&0===i.length?{isCompatible:!0}:{isCompatible:!1,isGenerationCompatible:o,unsupportedFeatures:i.length>0?i:void 0}}},1800:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});const r=()=>globalThis.performance.now()},4905:(e,t,n)=>{"use strict";n.d(t,{X:()=>o});var r=n(7232);class o extends r.b{constructor(){super(),this.addListener=super.addListener.bind(this),this.on=super.on.bind(this),this.once=super.once.bind(this),this.prependListener=super.prependListener.bind(this),this.prependOnceListener=super.prependOnceListener.bind(this),this.removeListener=super.removeListener.bind(this),this.off=super.off.bind(this)}}},7325:(e,t,n)=>{"use strict";var r;n.d(t,{d:()=>r}),function(e){e.cache="fluid-cache",e.clientDetails="fluid-client-details",e.loadMode="loadMode",e.reconnect="fluid-reconnect",e.sequenceNumber="fluid-sequence-number",e.version="version"}(r||(r={}))},3192:(e,t,n)=>{"use strict";var r;n.d(t,{d:()=>r}),function(e){e.Detached="Detached",e.Attaching="Attaching",e.Attached="Attached"}(r||(r={}))},8213:(e,t,n)=>{"use strict";n.d(t,{k:()=>r});const r={genericError:"genericError",throttlingError:"throttlingError",dataCorruptionError:"dataCorruptionError",dataProcessingError:"dataProcessingError",usageError:"usageError"}},6239:(e,t,n)=>{"use strict";n.d(t,{$:()=>r});const r={verbose:10,default:20,error:30}},9161:(e,t,n)=>{"use strict";function r(e,t){e||o(t)}function o(e){const t=new Error("number"==typeof e?`0x${e.toString(16).padStart(3,"0")}`:e);throw i(t),t}function i(e){for(const t of s)t(e)}n.d(t,{aT:()=>a,fJ:()=>o,vA:()=>r});const s=new Set;function a(e){l((()=>{if(c){const t=e();if(!0!==t){const e=new Error(`Debug assert failed: ${t.toString()}`);throw i(e),e}}}))}let c=!1;function l(e){}},7737:(e,t,n)=>{"use strict";n.d(t,{I:()=>o,d:()=>r});class r{constructor(e){this.valueGenerator=e,this._evaluated=!1}get evaluated(){return this._evaluated}get value(){return this._evaluated||(this._evaluated=!0,this._value=this.valueGenerator()),this._value}}class o{get[Symbol.toStringTag](){return"[object LazyPromise]"}constructor(e){this.execute=e}async then(e,t){return this.getPromise().then(...arguments)}async catch(e){return this.getPromise().catch(...arguments)}async finally(e){return this.getPromise().finally(...arguments)}async getPromise(){return void 0===this.result&&(this.result=this.execute()),this.result}}},3901:(e,t,n)=>{"use strict";n.d(t,{c:()=>r});class r{constructor(){this.completed=!1,this.p=new Promise(((e,t)=>{this.res=e,this.rej=t}))}get isCompleted(){return this.completed}get promise(){return this.p}resolve(e){void 0!==this.res&&(this.completed=!0,this.res(e))}reject(e){void 0!==this.rej&&(this.completed=!0,this.rej(e))}}},6148:(e,t,n)=>{"use strict";n.d(t,{$:()=>r});const r=e=>(e=>"object"==typeof e&&null!==e)(e)&&"then"in e&&"function"==typeof e.then},7269:(e,t,n)=>{"use strict";function r(e,t="Unreachable Case"){throw new Error(t)}n.d(t,{$:()=>r})},7185:(e,t,n)=>{"use strict";n.d(t,{a:()=>a});var r=n(8213);const{dataCorruptionError:o,dataProcessingError:i,...s}=r.k,a={...s,genericNetworkError:"genericNetworkError",authorizationError:"authorizationError",fileNotFoundOrAccessDeniedError:"fileNotFoundOrAccessDeniedError",offlineError:"offlineError",unsupportedClientProtocolVersion:"unsupportedClientProtocolVersion",writeError:"writeError",fetchFailure:"fetchFailure",fetchTokenError:"fetchTokenError",incorrectServerResponse:"incorrectServerResponse",fileOverwrittenInStorage:"fileOverwrittenInStorage",deltaStreamConnectionForbidden:"deltaStreamConnectionForbidden",locationRedirection:"locationRedirection",fluidInvalidSchema:"fluidInvalidSchema",fileIsLocked:"fileIsLocked",outOfStorageError:"outOfStorageError"}},8332:(e,t,n)=>{"use strict";var r,o,i;n.d(t,{Go:()=>r}),function(e){e.NoOp="noop",e.ClientJoin="join",e.ClientLeave="leave",e.Propose="propose",e.Reject="reject",e.Accept="accept",e.Summarize="summarize",e.SummaryAck="summaryAck",e.SummaryNack="summaryNack",e.Operation="op",e.NoClient="noClient",e.RoundTrip="tripComplete",e.Control="control"}(r||(r={})),function(e){e.ClientJoin="join",e.ClientLeave="leave"}(o||(o={})),function(e){e.ThrottlingError="ThrottlingError",e.InvalidScopeError="InvalidScopeError",e.BadRequestError="BadRequestError",e.LimitExceededError="LimitExceededError"}(i||(i={}))},7790:(e,t,n)=>{"use strict";var r;n.d(t,{Z:()=>r}),function(e){e.Tree=1,e.Blob=2,e.Handle=3,e.Attachment=4}(r||(r={}))},4826:(e,t,n)=>{"use strict";var r;n.d(t,{U:()=>r}),function(e){e.summarizingClient="fluid-client-summarizer",e.createNew="createNew"}(r||(r={}))},6283:(e,t,n)=>{"use strict";n.d(t,{E9:()=>b,Gi:()=>g,OI:()=>h,Of:()=>m,Tj:()=>p,WA:()=>r,YU:()=>y,c_:()=>d,d8:()=>c,dw:()=>f,ix:()=>v,sc:()=>s,yi:()=>u});var r,o=n(7185),i=n(4945);function s(){return"object"==typeof navigator&&null!==navigator&&"boolean"==typeof navigator.onLine?navigator.onLine?r.Online:r.Offline:r.Unknown}!function(e){e[e.Offline=0]="Offline",e[e.Online=1]="Online",e[e.Unknown=2]="Unknown"}(r||(r={}));class a extends i.iq{constructor(e,t,n){super(e,n),this.canRetry=t,this.errorType=o.a.genericNetworkError}}class c extends i.iq{constructor(e,t){super(e,t),this.errorType=o.a.fluidInvalidSchema,this.canRetry=!1}}class l extends i.iq{constructor(e,t,n){super(e,{...t,statusCode:400}),this.errorType=l.errorType,this.canRetry=!1,this.storageOnlyReason=n}}l.errorType=o.a.deltaStreamConnectionForbidden;class u extends i.iq{constructor(e,t,n,r){void 0!==t&&(r.claims=t),void 0!==n&&(r.tenantId=n),super(e,r,new Set(["claims","tenantId"])),this.errorType=o.a.authorizationError,this.canRetry=!1}}class d extends i.iq{constructor(e,t,n){super(e,n,new Set(["redirectUrl"])),this.redirectUrl=t,this.errorType=o.a.locationRedirection,this.canRetry=!1}}class p extends i.iq{constructor(e,t,n,r){super(e,r),this.errorType=t,this.canRetry=n}}class h extends p{constructor(e,t,n){super(e,t,!1,n),this.errorType=t}}class f extends p{constructor(e,t,n){super(e,t,!0,n),this.errorType=t}}class g extends i.iq{constructor(e,t,n){super(e,n),this.retryAfterSeconds=t,this.errorType=o.a.throttlingError,this.canRetry=!0}}const m=(e,t)=>new h(e,o.a.writeError,t);function v(e,t,n){return void 0!==t.retryAfterMs&&t.canRetry?new g(e,t.retryAfterMs/1e3,n):new a(e,t.canRetry,n)}const y=e=>!0===e?.canRetry,b=e=>void 0!==e?.retryAfterSeconds?1e3*e.retryAfterSeconds:void 0},1413:(e,t,n)=>{"use strict";n.d(t,{P:()=>o});var r=n(6277);async function o(e,t){const n=await e.readBlob(t),o=(0,r.JR)(n,"utf8");return JSON.parse(o)}},1680:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});const r={...n(7185).a,invalidFileNameError:"invalidFileNameError",snapshotTooBig:"snapshotTooBig",fetchTimeout:"fetchTimeout",fluidNotEnabled:"fluidNotEnabled",cannotCatchUp:"cannotCatchUp",serviceReadOnly:"serviceReadOnly",blockedIPAddress:"blockedIPAddress"}},4223:(e,t,n)=>{"use strict";n.d(t,{Mh:()=>y,jC:()=>m,Cu:()=>v});var r=n(8505);const o="https://my.microsoftpersonalcontent.com",i="https://1drv.ms",s="1",a="fluid",c="s",l="d",u="f",d="c",p="a",h="p",f="v",g="x";const m="nav";function v(e,t){const n=function(e){const t=new URL(e.siteUrl),n=encodeURIComponent(t.pathname),o=encodeURIComponent(e.driveId),i=encodeURIComponent(e.itemId),m=encodeURIComponent(e.dataStorePath);let v=`${c}=${n}&${l}=${o}&${u}=${i}&${d}=${m}&${a}=${s}`;return e.appName&&(v+=`&${p}=${encodeURIComponent(e.appName)}`),e.containerPackageName&&(v+=`&${h}=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(v+=`&${f}=${encodeURIComponent(e.fileVersion)}`),e.context&&(v+=`&${g}=${encodeURIComponent(e.context)}`),(0,r.O0)(v)}(t);e.searchParams.set(m,n)}function y(e,t=!0){const n=e.searchParams.get(m);if(!n)return;return function(e,t,n=!0){const o=new URLSearchParams((0,r.AH)(e)),i=o.get(a);if(n&&"1"!==i)return;const s=o.get(c),m=o.get(l),v=o.get(u),y=o.get(d),b=o.get(p)??void 0,w=o.get(h)??void 0,S=o.get(f)??void 0,C=o.get(g)??void 0;if(!s||!m||!v||null===y)return;let k;try{k=new URL(s,t)}catch{}return k?{siteUrl:k.href,driveId:m,itemId:v,dataStorePath:y,appName:b,containerPackageName:w,fileVersion:S,context:C}:void 0}(n,e.origin.toLowerCase()===i?o:e.origin,t)}},9073:(e,t,n)=>{"use strict";n.d(t,{z6:()=>x,wF:()=>F,bP:()=>A,bf:()=>I,cr:()=>N,ZR:()=>P,nb:()=>R,Yn:()=>O,gO:()=>T,bJ:()=>L});var r=n(1800),o=n(9161),i=n(6283),s=n(7185),a=n(1680),c=n(4066),l=n(4945);const u="2.41.0";var d=n(8505);const p="Bearer";const h=712,f="serviceReadOnly";function g(e){const t={sprequestduration:(0,c.ZK)(e.get("sprequestduration")),contentsize:(0,c.ZK)(e.get("content-length"))};[{headerName:"sprequestguid",logName:"sprequestguid"},{headerName:"request-id",logName:"requestId"},{headerName:"client-request-id",logName:"clientRequestId"},{headerName:"x-msedge-ref",logName:"xMsedgeRef"},{headerName:"X-Fluid-Retries",logName:"serverRetries"},{headerName:"content-encoding",logName:"contentEncoding"},{headerName:"content-type",logName:"contentType"}].forEach((n=>{const r=e.get(n.headerName);null!=r&&(t[n.logName]=r)}));const n=e.get("x-fluid-telemetry");if(null!=n){t.xFluidTelemetry=n;const e=n.split(",").map((e=>e.split("=")));for(const[n,r]of e)if("Origin"===n.trim()){let e;switch(r?.trim()){case"c":e="cache";break;case"g":e="graph";break;default:e=r?.trim()}t["responseOrigin"]=e;break}}return t}class m extends l.iq{constructor(e,t,n){super(e,n,new Set(["redirectLocation"])),this.redirectLocation=t,this.errorType=s.a.fileNotFoundOrAccessDeniedError,this.canRetry=!1}}function v(e,t,n,r,o,c={}){let l;const v=function(e){try{if(void 0!==e){const t=JSON.parse(e);if(function(e){const t=e?.error;return"string"==typeof t?.message&&(void 0===t?.code||"string"==typeof t?.code)}(t))return{success:!0,errorResponse:t}}}catch(e){}return{success:!1}}(o);let y,b,w;if(v.success){const e=v.errorResponse;c.responseMessage=e.error.message,y=function(e){const t=[];let n=e.error;for(;"object"==typeof n&&null!==n;)void 0!==n.code&&t.unshift(n.code),n=n.innerError;return t}(e),void 0!==y&&(b=y[0],c.innerMostErrorCode=b)}const S={driverVersion:u,statusCode:t,...c};switch(t){case 301:case 302:case 303:case 307:case 308:if(w=r?.headers.get("Location")??void 0,void 0!==w){l=new m(e,w,S);break}case 400:if("fluidInvalidSchema"===b){l=new i.d8(e,S);break}l=new i.OI(e,s.a.genericNetworkError,S);break;case 401:case 403:if(b===f)l=new i.dw(e,a.E.serviceReadOnly,S);else if("blockedIPAddress"===b||"conditionalAccessPolicyEnforced"===b)l=new i.OI("IP Address is blocked",a.E.blockedIPAddress,S);else{const t=r?.headers?function(e){const t=e.get("www-authenticate");if(!t)return;let n,r=!1;return t.split(",").map((e=>{const t=e.split("=");t.length>=2&&(r||"error"!==t[0].trim().toLowerCase()?n||"claims"!==t[0].trim().toLowerCase()||(n=(0,d.AH)(JSON.parse(e.substring(e.indexOf("=")+1).trim()))):r="insufficient_claims"===JSON.parse(t[1].trim().toLowerCase()))})),r?n:void 0}(r.headers):void 0,n=r?.headers?function(e){const t=e.get("www-authenticate");if(!t)return;const n=t.indexOf(p);if(n<0)return;let r;return t.substring(n+p.length).split(",").map((e=>{if(!r){const t=e.split("=");t.length>=2&&"realm"===t[0].trim().toLowerCase()&&(r=JSON.parse(t[1].trim()))}})),r}(r.headers):void 0;l=new i.yi(e,t,n,S)}break;case 404:if(v.success){const t=v?.errorResponse?.error;if(w=t?.["@error.redirectLocation"],void 0!==w){l=new m(e,w,S);break}}l=new i.OI(e,s.a.fileNotFoundOrAccessDeniedError,S);break;case 406:l=new i.OI(e,s.a.unsupportedClientProtocolVersion,S);break;case 410:l=new i.OI(e,a.E.cannotCatchUp,S);break;case 409:l=new i.OI(e,s.a.fileOverwrittenInStorage,S);break;case 412:l=new i.OI(e,s.a.genericNetworkError,S);break;case 413:l=new i.OI(e,a.E.snapshotTooBig,S);break;case 414:l=new i.OI(e,a.E.invalidFileNameError,S);break;case 423:if("resourceLocked"===b||"resourceCheckedOut"===b){l=new i.OI(e,s.a.fileIsLocked,S);break}case 500:l=new i.dw(e,s.a.genericNetworkError,S);break;case 501:l=new i.OI(e,a.E.fluidNotEnabled,S);break;case 507:l=new i.OI(e,s.a.outOfStorageError,S);break;case h:l=new i.OI(e,s.a.incorrectServerResponse,S);break;default:const t=void 0!==n?1e3*n:void 0;l=(0,i.ix)(e,{canRetry:!0,retryAfterMs:t},S)}return l.addTelemetryProperties({endpointReached:!0}),function(e,t,n,r={}){e.online=i.WA[(0,i.sc)()],void 0!==n&&(e.facetCodes=n);if(t&&(r.responseType=t.type,t.headers)){const n=g(t.headers);for(const e of Object.keys(n))r[e]=n[e];e.serverEpoch=t.headers.get("x-fluid-epoch")??void 0}e.addTelemetryProperties(r)}(l,r,y,void 0),l}function y(e,t,n,r,o){const i=v(e,t,function(e){if(null===e)return;const t=Number(e);if(Number.isNaN(t))return;return t}(n.headers.get("retry-after")),n,r,o);throw i.addTelemetryProperties({odspError:!0,storageServiceError:!0}),i}const b=e=>null===e||"string"==typeof e?e:void 0===e?null:e.token,w=e=>{if("object"==typeof e&&void 0!==e?.authorizationHeader)return e.authorizationHeader;const t=b(e);return null!==t?`Bearer ${t}`:null},S=e=>null===e||"string"==typeof e?void 0:e.fromCache;var C=n(4223),k=n(7330);const E="getWithRetryForTokenRefreshRepeat";async function T(e){return e({refresh:!1}).catch((async t=>{const n={refresh:!0,previousError:t};switch(t.errorType){case a.E.authorizationError:{const r=t;return e({...n,claims:r.claims,tenantId:r.tenantId})}case a.E.incorrectServerResponse:case a.E.fetchTokenError:return e(n);default:if(!0===t[E])return e(n);throw t}}))}async function P(e,t){const n=(0,r.l)();return fetch(e,t).then((async e=>{const t=e;if(!t)throw new i.OI("No response from ODSP fetch call",a.E.incorrectServerResponse,{driverVersion:k.z});(!t.ok||t.status<200||t.status>=300)&&y(`ODSP fetch error [${t.status}]`,t.status,t,await t.text());const o=function(e){const t=new Map;for(const[n,r]of e.entries())t.set(n,r);return t}(t.headers);return{content:t,headers:o,propsToLog:g(o),duration:(0,r.l)()-n}}),(e=>{const t=(0,i.sc)(),n={value:`${e}`,tag:c.mc.UserData},r=n.value.replace(/((http|https):\/\/(\S*))/i,"REDACTED_URL");if("AbortError"===e.name)throw new i.dw("Fetch Timeout (AbortError)",a.E.fetchTimeout,{driverVersion:k.z});if(r.includes("ETIMEDOUT"))throw new i.dw("Fetch Timeout (ETIMEDOUT)",a.E.fetchTimeout,{driverVersion:k.z});throw t===i.WA.Offline?new i.dw(`ODSP fetch failure (Offline): ${r}`,a.E.offlineError,{driverVersion:k.z,rawErrorMessage:n}):new i.dw(`ODSP fetch failure: ${r}`,a.E.fetchFailure,{driverVersion:k.z,rawErrorMessage:n})}))}async function N(e,t){const{content:n,headers:r,propsToLog:o,duration:i}=await P(e,t);let s;try{s=await n.arrayBuffer()}catch{y("Error while parsing fetch response",h,n,void 0,o)}return o.bodySize=s.byteLength,{headers:r,content:s,propsToLog:o,duration:i}}async function I(e,t){const{content:n,headers:r,propsToLog:o,duration:i}=await P(e,t);let s;try{s=await n.text()}catch{y("Error while parsing fetch response",h,n,s,o)}o.bodySize=s.length;return{headers:r,content:JSON.parse(s),propsToLog:o,duration:i}}function O(e){return(0,o.vA)(!0===e.odspResolvedUrl,478),e}P.fetch=fetch;const A=e=>(0,c.pW)({logger:e,namespace:"OdspDriver",properties:{all:{driverVersion:k.z}}});function L(e,t,n){const r=function(e,t,n,r,o){return async(s,u,d=!1)=>c.Bt.timedExecAsync(e,{eventName:`${u}_GetToken`,attempts:s.refresh?2:1,hasClaims:!!s.claims,hasTenantId:!!s.tenantId},(async e=>n({...s,...t}).then((t=>{const n=o?b(t):w(t);if((d||e.duration>=32)&&e.end({fromCache:S(t),isNull:null===n}),null===n&&r)throw new i.OI("The Host-provided token fetcher returned null",a.E.fetchTokenError,{method:u,driverVersion:k.z});return n}),(e=>{const t=e?.canRetry;throw(0,l.J4)(e,(e=>new i.Tj("The Host-provided token fetcher threw an error",a.E.fetchTokenError,"boolean"==typeof t&&t,{method:u,errorMessage:e,driverVersion:k.z})))}))),{cancel:"generic"})}(e,t,n,!0,!1);return r}function F(e){if(!e)return;let t=`createLinkScope=${e.scope}`;const n=e.role;return t=n?`${t}&createLinkRole=${n}`:t,t}const D=e=>"object"==typeof e&&"string"==typeof e?.name&&"object"==typeof e?.fluid;function x(e,t,n,r){const o=new URL(e),i=n||(t.dataStorePath??"");return(0,C.Cu)(o,{siteUrl:t.siteUrl,driveId:t.driveId,itemId:t.itemId,dataStorePath:i,appName:t.appName,containerPackageName:r,fileVersion:t.fileVersion,context:t.context}),o.href}function R(e){let t;return t=e&&"name"in e?e.name:D(e?.package)?e?.package.name:e?.package,t}},7330:(e,t,n)=>{"use strict";n.d(t,{z:()=>r});const r="2.41.0"},7900:(e,t,n)=>{"use strict";n.d(t,{SA:()=>d,oh:()=>a,jP:()=>l,zF:()=>i,Fz:()=>u});const r="IFluidHandle",o=Symbol.for("FluidHandle-3978c7cf-4675-49ba-a20c-bf35efbf43da"),i=e=>"__fluid_handle__"===e?.type,s=e=>"payloadPending"in e&&!0===e.payloadPending;function a(e){return s(e)?{type:"__fluid_handle__",url:e.absolutePath,payloadPending:!0}:{type:"__fluid_handle__",url:e.absolutePath}}const c=!0;function l(e){if("object"!=typeof e||null===e)return!1;if(o in e)return!0;if(c&&r in e){const t=e[r];return"object"==typeof t&&null!==t&&r in t}return!1}function u(e){if(!(o in e)||!(o in e[o])){if(c&&r in e)return e[r];throw new TypeError("Invalid IFluidHandle")}return e[o]}class d{get IFluidHandle(){return this}get[o](){return this}}},5373:(e,t,n)=>{"use strict";n.d(t,{X:()=>r});class r{static getPathParts(e){const t=e.indexOf("?");return e.substring(0,t<0?e.length:t).split("/").reduce(((e,t)=>(void 0!==t&&t.length>0&&e.push(decodeURIComponent(t)),e)),[])}static create(e){return e instanceof r?e:new r(e)}constructor(e){this.request=e;const t=this.request.url.indexOf("?");this.query=t>=0?this.request.url.substring(t):"",void 0!==e.headers&&(this.headers=e.headers)}get url(){return this.request.url}get pathParts(){return void 0===this.requestPathParts&&(this.requestPathParts=r.getPathParts(this.url)),this.requestPathParts}isLeaf(e){return""===this.query&&this.pathParts.length===e}createSubRequest(e){const t=this.pathParts.length;if(e<0||e>t)throw new Error("incorrect sub-request");if(e===t&&this.url.includes("?"))return{url:`/${this.query}`,headers:this.headers};const n=`/${this.pathParts.slice(e).join("/")}`;return{url:""===this.query?n:`${n}/${this.query}`,headers:this.headers}}}},240:(e,t,n)=>{"use strict";n.d(t,{CL:()=>m,G0:()=>d,Ln:()=>h,fG:()=>f,lh:()=>i,uz:()=>p});var r=n(7737),o=n(4066);const i=new r.d((()=>a(u()))),s={getRawConfig:()=>{}},a=e=>null!=e?new d(void 0,{getRawConfig:t=>{try{return l(e.getItem(t)??void 0)?.raw}catch{return}}}):s;function c(e){switch(e){case"boolean":case"number":case"string":return!0;default:return!1}}function l(e){let t,n=e;if("string"==typeof e)try{n=JSON.parse(e),t={raw:e,string:e}}catch{}if(void 0===n)return t;const r=typeof n;if(c(r))return{...t,raw:e,[r]:n};if(Array.isArray(n)){const r=typeof n[0];if(!c(r))return t;for(const e of n)if(typeof e!==r)return t;return{...t,raw:e,[`${r}[]`]:n}}return t}const u=()=>{try{return globalThis.sessionStorage??void 0}catch{return}};class d{constructor(e,...t){this.logger=e,this.configCache=new Map,this.orderedBaseProviders=[];const n=new Set,r=[...t];for(;r.length>0;){const e=r.shift();void 0!==e&&g(e)&&!n.has(e)&&(n.add(e),e instanceof d?r.push(...e.orderedBaseProviders):this.orderedBaseProviders.push(e))}}getBoolean(e){return this.getCacheEntry(e)?.boolean}getNumber(e){return this.getCacheEntry(e)?.number}getString(e){return this.getCacheEntry(e)?.string}getBooleanArray(e){return this.getCacheEntry(e)?.["boolean[]"]}getNumberArray(e){return this.getCacheEntry(e)?.["number[]"]}getStringArray(e){return this.getCacheEntry(e)?.["string[]"]}getRawConfig(e){return this.getCacheEntry(e)?.raw}getCacheEntry(e){if(!this.configCache.has(e)){for(const t of this.orderedBaseProviders){const n=l(t?.getRawConfig(e));if(void 0!==n)return this.configCache.set(e,n),this.logger?.send({category:"generic",eventName:"ConfigRead",...(0,o.Df)({configName:e,configValue:JSON.stringify(n)})}),n}this.configCache.set(e,{raw:void 0})}return this.configCache.get(e)}}function p(e){const t=e;return g(t?.config)&&void 0!==t?.logger}function h(e){return p(e)?e:f(e,i.value)}function f(e,...t){if(p(e))throw new Error("Logger is already a monitoring context");const n=e;return n.config=new d(e,...t),n.logger=e,n}function g(e){const t=e;return"function"==typeof t?.getRawConfig}function m(e){return h((0,o.pW)(e))}},6598:(e,t,n)=>{"use strict";n.d(t,{EW:()=>a,I9:()=>c,ds:()=>l,eb:()=>s,gn:()=>i});var r=n(8213),o=n(4945);class i extends o.iq{constructor(e,t,n){super(e,n,new Set(["error"])),this.error=t,this.errorType=r.k.genericError}}class s extends o.iq{constructor(e,t){super(e,{...t,usageError:!0}),this.errorType=r.k.usageError}}class a extends o.iq{constructor(e,t){super(e,{...t,dataProcessingError:1}),this.errorType=r.k.dataCorruptionError,this.canRetry=!1}}class c extends o.iq{constructor(e,t){super(e,t),this.errorType=r.k.dataProcessingError,this.canRetry=!1}static create(e,t,n,r={},o){const i=Error,s=i.stackTraceLimit;try{void 0!==o&&(i.stackTraceLimit=o);const s=c.wrapIfUnrecognized(e,t,n);return s.addTelemetryProperties(r),s}finally{void 0!==o&&(i.stackTraceLimit=s)}}static wrapIfUnrecognized(e,t,n){const r={dataProcessingError:1,dataProcessingCodepath:t,...void 0===n?void 0:l(n)},i=(0,o.cQ)(e,{props:r});if((0,o.vt)(i)||i.errorType===o.i5){const e=(0,o.J4)(i,(e=>new c(e)));return e.addTelemetryProperties(i.getTelemetryProperties()),e}return i}}const l=e=>({messageClientId:null===e.clientId?"null":e.clientId,messageSequenceNumber:e.sequenceNumber,messageClientSequenceNumber:e.clientSequenceNumber,messageReferenceSequenceNumber:e.referenceSequenceNumber,messageMinimumSequenceNumber:e.minimumSequenceNumber,messageTimestamp:e.timestamp})},4945:(e,t,n)=>{"use strict";n.d(t,{AV:()=>a,G:()=>f,J4:()=>h,aX:()=>p,cQ:()=>l,dy:()=>c,i5:()=>b,iq:()=>y,oD:()=>d,qp:()=>v,vt:()=>m});var r=n(9535),o=n(2973),i=n(4066);const s=e=>null!==e&&!Array.isArray(e)&&"object"==typeof e;function a(e,t){const n={message:"string"==typeof e?.message?e.message:String(e)};if(s(e)){const{errorType:r,stack:o,name:i}=e;if("string"==typeof r&&(n.errorType=r),"string"==typeof o){const e="string"==typeof i?i:void 0;n.stack=((e,n)=>{if(!t)return e;const r=e.split("\n");return r.shift(),void 0!==n&&r.unshift(n),r.join("\n")})(o,e)}}return n}const c=e=>"function"==typeof e?.getTelemetryProperties;function l(e,t={}){if((0,o.X)(e))return e.addTelemetryProperties(t.props??{}),e;const{message:n,stack:r}=a(e,!1),i=new w({message:n,stack:r});if("object"==typeof e&&null!==e){const t=e;let n;"canRetry"in e&&(n??={},n.canRetry=t.canRetry),"retryAfterSeconds"in e&&(n??={},n.retryAfterSeconds=t.retryAfterSeconds),void 0!==n&&Object.assign(i,n)}"object"!=typeof e&&i.addTelemetryProperties({typeofError:typeof e});const s=y.typeCheck(e)?e.getTelemetryProperties():{untrustedOrigin:1};return i.addTelemetryProperties({...s,...t.props}),i}let u;function d(e){const t=Error,n=t.stackTraceLimit;void 0!==e&&(t.stackTraceLimit=e);const r=new Error("<<generated stack>>");if(void 0===u&&(u=void 0!==r.stack),u)return t.stackTraceLimit=n,r;try{throw r}catch(e){return t.stackTraceLimit=n,e}}function p(e){return d(e).stack}function h(e,t){const{message:n,stack:r}=a(e,!1),i=t(n);return void 0!==r&&g(i,r),m(e)&&i.addTelemetryProperties({untrustedOrigin:1}),(0,o.f)(e)&&(i.overwriteErrorInstanceId(e.errorInstanceId),i.addTelemetryProperties({innerErrorInstanceId:e.errorInstanceId})),c(e)&&i.addTelemetryProperties(e.getTelemetryProperties()),i}function f(e,t,n){const r=h(e,t),o=r.errorInstanceId,i=o;return n.sendTelemetryEvent({eventName:"WrapError",errorInstanceId:o,wrappedByErrorInstanceId:i},e),r}function g(e,t){try{Object.assign(e,{stack:t})}catch{e.addTelemetryProperties({stack2:t})}}function m(e){if(y.typeCheck(e)){if(e.errorType===b){const t=e.getTelemetryProperties();return 1===t.untrustedOrigin||Boolean(t.errorRunningExternalCode)}return!1}return!0}function v(e){return"string"==typeof e?.tag}class y extends Error{get errorInstanceId(){return this._errorInstanceId}overwriteErrorInstanceId(e){this._errorInstanceId=e}constructor(e,t,n=new Set){super(e),this.omitPropsFromLogging=n,this._errorInstanceId=(0,r.A)(),n.add("omitPropsFromLogging"),n.add("_errorInstanceId"),t&&this.addTelemetryProperties(t)}static typeCheck(e){return"object"==typeof e&&null!==e&&("function"==typeof e.addTelemetryProperties&&"function"==typeof e.getTelemetryProperties&&"string"==typeof e.errorInstanceId)}addTelemetryProperties(e){!function(e,t){for(const[n,r]of Object.entries(t))void 0===e[n]&&(e[n]=r)}(this,e)}getTelemetryProperties(){const e={};for(const t of Object.keys(this)){if(this.omitPropsFromLogging.has(t))continue;const n=this[t];e[t]=(0,i.fV)(n)}return{...e,stack:this.stack,message:this.message,errorInstanceId:this._errorInstanceId}}}const b="genericError";class w extends y{constructor(e){super(e.message),this.errorType=b,void 0!==e.stack&&g(this,e.stack)}}},8201:(e,t,n)=>{"use strict";n.d(t,{o:()=>o});var r=n(4905);class o extends r.X{constructor(e){super(),this.errorHandler=e}emit(e,...t){try{return super.emit(e,...t)}catch(t){return this.errorHandler(e,t),!0}}}},5751:(e,t,n)=>{"use strict";n.d(t,{Tg:()=>r,aX:()=>s,uk:()=>i});const r="connected",o="disconnected";function i(e,t,n,...r){try{e.emit(n,...r)}catch(e){t.sendErrorEvent({eventName:"RaiseEventError",event:n},e)}}function s(e,t,n,i,s){try{n?t.emit(r,i):t.emit(o,s)}catch(t){e.sendErrorEvent({eventName:"RaiseConnectedEventError"},t)}}},2973:(e,t,n)=>{"use strict";n.d(t,{X:()=>i,f:()=>o});const r=e=>"function"==typeof e?.getTelemetryProperties&&"function"==typeof e?.addTelemetryProperties,o=e=>"string"==typeof e?.errorInstanceId;function i(e){return"string"==typeof e?.errorType&&"string"==typeof e?.message&&o(e)&&r(e)}},4066:(e,t,n)=>{"use strict";n.d(t,{Bt:()=>v,Df:()=>w,Hf:()=>d,T0:()=>u,Z:()=>g,ZK:()=>l,fV:()=>y,mc:()=>r,pW:()=>h});var r,o=n(1800),i=n(6239),s=n(240),a=n(4945),c=n(9307);function l(e){if(null==e)return;const t=Number(e);return Number.isNaN(t)?e:t}function u(e){return Math.floor(e)}!function(e){e.CodeArtifact="CodeArtifact",e.UserData="UserData"}(r||(r={}));const d=":";class p{static sanitizePkgName(e){return e.replace("@","").replace("/","-")}static prepareErrorObject(e,t,n){const{message:r,errorType:o,stack:i}=(0,a.AV)(t,!0);if(e.stack=i,e.error=r,e.errorType=o,(0,a.dy)(t)){const n=t.getTelemetryProperties();for(const t of Object.keys(n))void 0===e[t]&&(e[t]=n[t])}void 0===e.stack&&n&&(e.stack=(0,a.aX)())}constructor(e,t){this.namespace=e,this.properties=t}sendTelemetryEvent(e,t,n=i.$.default){this.sendTelemetryEventCore({...e,category:e.category??"generic"},t,"error"===e.category?i.$.error:n)}sendTelemetryEventCore(e,t,n){const r=function({category:e,eventName:t,...n}){const r={category:e,eventName:t};for(const e of Object.keys(n))r[e]=y(n[e]);return r}(e);void 0!==t&&p.prepareErrorObject(r,t,!1),"number"==typeof r.duration&&(r.duration=u(r.duration)),this.send(r,n)}sendErrorEvent(e,t){this.sendTelemetryEventCore({error:e.eventName,...e,category:"error"},t,i.$.error)}sendPerformanceEvent(e,t,n=i.$.default){const r={...e,category:e.category??"performance"};this.sendTelemetryEventCore(r,t,"error"===r.category?i.$.error:n)}prepareEvent(e){const t="error"===e.category||void 0!==e.error,n={...e};return void 0!==this.namespace&&(n.eventName=`${this.namespace}${p.eventNamespaceSeparator}${n.eventName}`),this.extendProperties(n,t)}extendProperties(e,t){const n=e;if(this.properties){const e=[];e.push(this.properties.all),t&&e.push(this.properties.error);for(const t of e)if(void 0!==t)for(const[e,r]of Object.entries(t)){if(void 0!==n[e])continue;const t="function"==typeof r?r():r;void 0!==t&&(n[e]=t)}}return e}}p.eventNamespaceSeparator=d;function h(e){return f.create(e?.logger,e?.namespace,e?.properties)}class f extends p{static create(e,t,n){if(e instanceof f){const r={};for(const t of[e.properties,n])void 0!==t&&(void 0!==t.all&&(r.all={...r.all,...t.all}),void 0!==t.error&&(r.error={...r.error,...t.error}));const o=void 0===e.namespace?t:void 0===t?e.namespace:`${e.namespace}${p.eventNamespaceSeparator}${t}`,i=new f(e.baseLogger,o,r);return!(0,s.uz)(i)&&(0,s.uz)(e)&&(0,s.fG)(i,e.config),i}return new f(e??{send(){}},t,n)}constructor(e,t,n){super(t,n),this.baseLogger=e,(0,s.uz)(e)&&(0,s.fG)(this,new s.G0(this,e.config))}get minLogLevel(){return this.baseLogger.minLogLevel}shouldFilterOutEvent(e,t){return(t??i.$.default)<(this.baseLogger.minLogLevel??i.$.default)}send(e,t){this.shouldFilterOutEvent(e,t)||this.baseLogger.send(this.prepareEvent(e),t)}}function g(e){return new m(e.namespace,e.properties,e.loggers?.filter((e=>void 0!==e)),e.tryInheritProperties)}class m extends p{constructor(e,t,n=[],r){let o=void 0===t?void 0:{...t};if(!0===r){const e=o??={};n.filter((e=>e instanceof p)).map((e=>e.properties??{})).forEach((t=>{Object.keys(t).forEach((n=>{e[n]={...t[n],...e?.[n]}}))}))}super(e,o),this.loggers=n,this._minLogLevelOfAllLoggers=i.$.default,this.calculateMinLogLevel()}get minLogLevel(){return this._minLogLevelOfAllLoggers}calculateMinLogLevel(){if(this.loggers.length>0){const e=[];for(const t of this.loggers)e.push(t.minLogLevel??i.$.default);this._minLogLevelOfAllLoggers=Math.min(...e)}}addLogger(e){null!=e&&(this.loggers.push(e),this.calculateMinLogLevel())}send(e){const t=this.prepareEvent(e);for(const e of this.loggers)e.send(t)}}class v{static start(e,t,n,r=!0){return new v(e,t,n,r)}static timedExec(e,t,n,r,o=1){const i=v.start(e,t,r,v.shouldReport(t,o));try{const e=n(i);return i.autoEnd(),e}catch(e){throw i.cancel(void 0,e),e}}static async timedExecAsync(e,t,n,r,o=1){const i=v.start(e,t,r,v.shouldReport(t,o));try{const e=await n(i);return i.autoEnd(),e}catch(e){throw i.cancel(void 0,e),e}}get duration(){return(0,o.l)()-this.startTime}constructor(e,t,n={end:!0,cancel:"generic"},r=!0){this.logger=e,this.markers=n,this.emitLogs=r,this.startTime=(0,o.l)(),this.event={...t},this.markers.start&&this.reportEvent("start"),"object"==typeof window&&void 0!==window?.performance?.mark&&null!==window?.performance?.mark&&(this.startMark=`${t.eventName}-start`,window.performance.mark(this.startMark))}reportProgress(e,t="update"){this.reportEvent(t,e)}autoEnd(){this.event&&this.markers.end&&this.reportEvent("end"),this.performanceEndMark(),this.event=void 0}end(e){this.reportEvent("end",e),this.performanceEndMark(),this.event=void 0}performanceEndMark(){if(void 0!==this.startMark&&this.event){const e=`${this.event.eventName}-end`;window.performance.mark(e),window.performance.measure(`${this.event.eventName}`,this.startMark,e),this.startMark=void 0}}cancel(e,t){void 0!==this.markers.cancel&&this.reportEvent("cancel",{category:this.markers.cancel,...e},t),this.event=void 0}reportEvent(e,t,n){if(!this.event)return;if(!this.emitLogs)return;const r={...this.event,...t};r.eventName=`${r.eventName}_${e}`,"start"!==e&&(r.duration=this.duration),this.logger.sendPerformanceEvent(r,n)}static shouldReport(e,t){const n=`.${e.category}.${e.eventName}`,r=v.eventHits.get(n)??0;return v.eventHits.set(n,r>=t?1:r+1),r%t==0}}function y(e){return(0,a.qp)(e)?{value:b(e.value),tag:e.tag}:b(e)}function b(e){switch(typeof e){case"string":case"number":case"boolean":case"undefined":return e;case"object":return JSON.stringify(e);default:return c.error(`convertToBasePropertyTypeUntagged: INVALID PROPERTY (typed as ${typeof e})`),`INVALID PROPERTY (typed as ${typeof e})`}}v.eventHits=new Map;const w=e=>((e,t)=>Object.entries(t).filter((e=>void 0!==e[1])).reduce(((t,n)=>{const[r,o]=n;return t[r]="function"==typeof o?()=>({tag:e,value:o()}):{tag:e,value:o},t}),{}))(r.CodeArtifact,e)},2065:(e,t,n)=>{"use strict";n.d(t,{C6:()=>o,Cl:()=>i});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError}},i={};function s(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return o[e](n,n.exports,s),n.exports}s.m=o,s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,s.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);s.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var a=2&r&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>i[e]=()=>n[e]));return i.default=()=>n,s.d(o,i),o},s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.f={},s.e=e=>Promise.all(Object.keys(s.f).reduce(((t,n)=>(s.f[n](e,t),t)),[])),s.u=e=>({160:"FluidDocumentServiceFactoryContainer",482:"FluidFramework-HashFallback",634:"MockComponent",873:"officeFluidOneDsSink",941:"AshaUtils"}[e]+".js"),s.miniCssF=e=>{},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},r="TypeScriptModule:",s.l=(e,t,o,i)=>{if(n[e])n[e].push(t);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==r+o){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",r+o),a.src=e),n[e]=[t];var p=(t,r)=>{a.onerror=a.onload=null,clearTimeout(h);var o=n[e];if(delete n[e],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(r))),t)return t(r)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=p.bind(null,a.onerror),a.onload=p.bind(null,a.onload),c&&document.head.appendChild(a)}},s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),(()=>{var e={57:0};s.f.j=(t,n)=>{var r=s.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var i=s.p+s.u(t),a=new Error;s.l(i,(n=>{if(s.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",a.name="ChunkLoadError",a.type=o,a.request=i,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[i,a,c]=n,l=0;if(i.some((t=>0!==e[t]))){for(r in a)s.o(a,r)&&(s.m[r]=a[r]);if(c)c(s)}for(t&&t(n);l<i.length;l++)o=i[l],s.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();(()=>{"use strict";var e=s(7011),t=s.t(e,2),n=s(5561);const r={afZa:"af-za",amEt:"am-et",arSa:"ar-sa",asIn:"as-in",azLatnAz:"az-latn-az",bgBg:"bg-bg",bnIn:"bn-in",bsLatnBa:"bs-latn-ba",caEs:"ca-es",caEsValencia:"ca-es-valencia",csCz:"cs-cz",cyGb:"cy-gb",daDk:"da-dk",deDe:"de-de",elGr:"el-gr",enGb:"en-gb",enUs:"en-us",esEs:"es-es",esMx:"es-mx",etEe:"et-ee",euEs:"eu-es",faIr:"fa-ir",fiFi:"fi-fi",filPh:"fil-ph",frCa:"fr-ca",frFr:"fr-fr",gaIe:"ga-ie",gdGb:"gd-gb",glEs:"gl-es",guIn:"gu-in",heIl:"he-il",hiIn:"hi-in",hrHr:"hr-hr",huHu:"hu-hu",hyAm:"hy-am",idId:"id-id",isIs:"is-is",itIt:"it-it",jaJp:"ja-jp",kaGe:"ka-ge",kkKz:"kk-kz",kmKh:"km-kh",knIn:"kn-in",kokIn:"kok-in",koKr:"ko-kr",lbLu:"lb-lu",loLa:"lo-la",ltLt:"lt-lt",lvLv:"lv-lv",miNz:"mi-nz",mkMk:"mk-mk",mlIn:"ml-in",mrIn:"mr-in",msMy:"ms-my",mtMt:"mt-mt",nbNo:"nb-no",neNp:"ne-np",nlNl:"nl-nl",nnNo:"nn-no",orIn:"or-in",paIn:"pa-in",plPl:"pl-pl",ptBr:"pt-br",ptPt:"pt-pt",quzPe:"quz-pe",roRo:"ro-ro",ruRu:"ru-ru",skSk:"sk-sk",slSi:"sl-si",sqAl:"sq-al",srCyrlBa:"sr-cyrl-ba",srCyrlRs:"sr-cyrl-rs",srLatnRs:"sr-latn-rs",svSe:"sv-se",taIn:"ta-in",teIn:"te-in",thTh:"th-th",trTr:"tr-tr",ttRu:"tt-ru",ugCn:"ug-cn",ukUa:"uk-ua",urPk:"ur-pk",viVn:"vi-vn",zhCn:"zh-cn",zhTw:"zh-tw"},o={af:r.afZa,am:r.amEt,ar:r.arSa,as:r.asIn,az:r.azLatnAz,bg:r.bgBg,bn:r.enGb,bs:r.bsLatnBa,"bs-cyrl-ba":r.enGb,ca:r.caEs,cs:r.csCz,cy:r.cyGb,da:r.daDk,de:r.deDe,el:r.elGr,"el-cy":r.enGb,en:r.enUs,es:r.esEs,et:r.etEe,eu:r.euEs,fa:r.faIr,fi:r.fiFi,fil:r.filPh,fr:r.frFr,ga:r.gaIe,gd:r.gdGb,gl:r.glEs,gu:r.guIn,he:r.heIl,hi:r.hiIn,hr:r.hrHr,hu:r.huHu,hy:r.hyAm,id:r.idId,is:r.isIs,it:r.itIt,iw:r.heIl,"iw-il":r.heIl,ja:r.jaJp,ka:r.kaGe,kk:r.kkKz,km:r.kmKh,kn:r.knIn,ko:r.koKr,kok:r.kokIn,lb:r.lbLu,lo:r.loLa,lt:r.ltLt,lv:r.lvLv,mi:r.miNz,mk:r.mkMk,ml:r.mlIn,mr:r.mrIn,ms:r.msMy,mt:r.mtMt,nb:r.nbNo,ne:r.neNp,nl:r.nlNl,nn:r.nnNo,or:r.orIn,pa:r.paIn,pl:r.plPl,pt:r.ptBr,quz:r.quzPe,ro:r.roRo,ru:r.ruRu,sk:r.skSk,sl:r.slSi,sq:r.sqAl,sv:r.svSe,ta:r.taIn,te:r.teIn,th:r.thTh,tr:r.trTr,"tr-cy":r.enGb,tt:r.ttRu,ug:r.ugCn,uk:r.ukUa,ur:r.urPk,uz:r.enUs,vi:r.viVn,zh:r.enUs,"zh-hans-tw":r.zhTw},i=r.enUs,a=/^([^-]+)-.+/;function c(e){if(null==e)return i;const t=e.toLowerCase();if(Object.values(r).includes(t))return t;const n=o[t];if(void 0!==n)return n;const s=function(e){const t=a.exec(e.trim().toLowerCase());if(null!==t&&t.length>1)return t[1];return}(t);if(void 0!==s){const e=o[s];if(void 0!==e)return e}return i}var l=s(309),u=s.n(l);new Set(["72f988bf-86f1-41af-91ab-2d7cd011db47","0000","f34444e5-e35c-4ceb-8a8b-7a0042451ccc","0a54704d-bba9-4e27-878e-fe460a591835","de21c301-a4ae-4292-aa09-6db710a590a6","49b6f6cd-6628-4bd2-8753-4d8c8a68fa04","fabbafd6-0003-4695-ada4-929dea5a0d36","5b73a072-2f1f-46ad-92ca-a9b3993e45aa","d4093791-9818-48dc-8880-35d134b8c79d","0d746a1c-f9a6-47a3-9d3a-4f3f1a79c0f6","13c6a44d-9b52-4b9e-aa34-0513ee7131f2","1f855c63-5a0d-47be-8300-914123519d11","21a4f3dd-ef15-47a5-bc51-1a31b80765be","26ed3691-0678-440d-9bc4-134f94a1beb1","35e07416-9027-4637-ae4d-72159981338a","3cbebbae-5ae7-4090-9654-f2df09940424","40ed3d74-3c8c-4399-866e-d1f7a95bb051","45c54e3f-1b2a-4a84-a2f5-5d5e86845726","4ad43d82-3f33-47ee-b8a0-273939d4570a","55ccf089-0e94-4a28-85df-629d0b273be1","6f6da031-e5cf-4e62-82cd-96636e80639e","73561903-7c11-4927-809d-b9a31fda7d61","78375574-4a4c-41a5-8b31-72e0374aa242","9188040d-6c67-4c5b-b112-36a304b66dad","a0effc3b-4ee4-4a46-9dcc-89fd35b439f6","af33e969-0b64-4c2d-bad6-329f25f2d990","b00367e2-193a-4f48-94de-7245d45c0947","b48595ab-4114-4783-883d-41872f68adfb","b68a597d-37e2-4254-a203-5fd9602367ee","c00cdc1a-23ab-45df-8a48-1f8d96fa2fab","c51071fb-f559-4967-ac4f-63ee879ca4ec","e1a132a4-2f3d-4ef5-9b14-2d4e94833544","e58c8e81-abd8-48a8-929d-eb67611b83bd","e73ba7cf-4e1b-40f5-805e-c3aae41e1b90","fc3fd415-e428-4884-bf6f-62c2e70a6682","8f474e12-1b0c-463d-a004-edbc2e2c72b0","6583636b-d156-492e-86ce-b8fccb790df1","91b036b7-fff3-4c61-8d5e-dba6d56268bd","7a55eed5-98d0-4f09-bf4e-17768961e804"]);class d extends Error{constructor(e,t){super(t),this.hresult=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}get errorCode(){return this.hresult}}d.E_FAIL=2147500037;class p extends d{constructor(e){super(p.E_NOTIMPL,e)}}p.E_NOTIMPL=2147500033;class h extends d{constructor(e){super(h.E_INVALIDARG,e)}}h.E_INVALIDARG=2147942487;var f=s(2065),g=s(5738),m=s(5927),v=s(8170),y=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(y=function(){return 1e3*Math.floor(window.performance.now())});var b,w=function(e){var t,n=y(),r=(0,g.EY)(e.telemetryEvent);return(0,f.Cl)((0,f.Cl)({cv:e.parentCv.getNext()},r),{createChildActivity:function(t){return w({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){var r,o,i=this;if(!t){void 0===this.success&&void 0===this.result&&(0,v.wC)(1,0,(function(){return"Activity does not have success or result set"}));var s=y();t=!0;var a={duration:s-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},c=null!==(o=null===(r=this.eventContract)||void 0===r?void 0:r.dataFields)&&void 0!==o?o:[];return c.push.apply(c,m.Il.getFields(a)),this.eventContract={name:m.Il.contractName,dataFields:c},e.sendTelemetryEvent(this)}(0,v.wC)(0,0,(function(){return"'".concat(i.eventName,"' already ended")}))}})},S=s(488),C=function(e){var t="Error",n=[];return n.push((0,S.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),n.push((0,S.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&n.push((0,S.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&n.push((0,S.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&n.push((0,S.Ug)("".concat(t,".Count"),e.count)),n},k=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();var E,T=function(e){function t(t,n,r){var o=e.call(this,t,n,r)||this;return o.baseCv=function(){if(!b){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(64*Math.random())));b=new k(t.join(""))}return b}(),o}return(0,f.C6)(t,e),t.prototype.createActivity=function(e){return w({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:m.Il.contractName,dataFields:m.Il.getFields(t)},dataFields:n,eventFlags:r})},t.prototype.sendError=function(e){var t=C(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return w({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(g.GV);!function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(E||(E={}));const{DataCategories:P,DiagnosticLevel:N}=E,I={dataCategories:P.ProductServiceUsage,diagnosticLevel:N.Optional},O={...{GetTokenFromProvider:I,InitialBizChatTokenAcquired:I,InitialTokenAcquired:I},...{ApiBridgeError:I,AuthError:I,AppInitError:I,BizChatAuthError:I,CdnCodeLoaderPreCacheError:I,ComponentDataWorkspaceListChangedEventError:I,ComponentNavigationEventError:I,DataActionError:I,FeatureGatesError:I,NativeEventHandlerError:I,NavigateToLinkError:I,NavigateToSearchResultError:I,NotifyClientError:I,WorkspaceManagerError:I},...{GetLoopView:I,LoadLoopComponent:I,LoadLoopWorkspaceComponent:I,RenderLoopComponent:I},...{NavigateTo:I,NavigateToLink:I,NavigateToSearchResult:I},...{GetRecentPages:I,GetWorkspaceForPage:I,GetWorkspaces:I}};var A;!function(e){e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.Info="Info"}(A||(A={}));var L=s(9307);const F={example:"Microsoft.Office.OneNote.fa000000174.example",useNavToPage:"Microsoft.Office.OneNote.fa000000174.UseNavToPage",useL2NavRefresh:"Microsoft.Office.OneNote.fa000000174.useL2NavRefresh",useOfficeWebScenario:"Microsoft.Office.OneNote.fa000000174.UseOfficeWebScenario"},D={useOfficeTelemetrySinkBatching:"Microsoft.Office.OneNote.fa000000174.UseOfficeTelemetrySinkBatching"},x=(e,t)=>{try{const n=F[e];return OfficeRuntime.experimentation.getBooleanFeatureGate(n,t)}catch(e){return _.Instance.logError("FeatureGatesError",e,{ErrorMethod:"getBooleanFeatureGate"}),L.error("Error getting feature gate",e),t}},R=e=>{try{return OfficeRuntime.experimentation.getBooleanFeatureGate(D[e],!0)}catch(e){return _.Instance.logError("FeatureGatesError",e,{ErrorMethod:"getBooleanChangeGate"}),L.error("Error getting change gate",e),!0}};class M{constructor(){this._telemetryQueue=[],this._processingQueue=!1}static get Instance(){return M._instance||(M._instance=new M),M._instance}sendTelemetryEvent(e,t){R("useOfficeTelemetrySinkBatching")?(this._telemetryQueue.push({FilledTelemetryEvent:e,timestamp:t}),this._processingQueue||this._startProcessingQueueTimer||(this._startProcessingQueueTimer=setTimeout((()=>{this._processingQueue=!0,this._startProcessingQueueTimer=void 0,this.processQueue()}),M.PROCESSING_QUEUE_INTERVAL))):Office.telemetrySink.sendTelemetryEvent(e,t)}sendCustomerContent(e){Office.telemetrySink.sendCustomerContent(e)}sendNonStandardEvent(e,t){Office.telemetrySink.sendNonStandardEvent(e,t)}async processQueue(){for(;this._telemetryQueue.length>0;){for(let e=0;e<M.MAX_EVENTS_PER_INTERVAL;e++){const e=this._telemetryQueue.shift();e&&Office.telemetrySink.sendTelemetryEvent(e.FilledTelemetryEvent,e.timestamp)}this._telemetryQueue.length>0&&await new Promise((e=>setTimeout(e,M.PROCESSING_QUEUE_INTERVAL)))}this._processingQueue=!1}}M.PROCESSING_QUEUE_INTERVAL=1e3,M.MAX_EVENTS_PER_INTERVAL=5;class _{constructor(){const e=_.AriaTenantToken,t=_.NexusTenantToken,n=_.Namespace;this.oTelLogger=new T,this.namespace=n,this.oTelLogger.setTenantToken(`${n}`,e,t),this.oTelLogger.addSink(M.Instance)}static get Instance(){return _.telemetryLogger||(_.telemetryLogger=new _),_.telemetryLogger}logEvent(e,t){const n=O[e],r={eventName:`${this.namespace}.${e}`,eventFlags:n,dataFields:_.getDataFields(t)};this.oTelLogger.sendTelemetryEvent(r)}logError(e,t,n){const r=O[e],o=[..._.getErrorDataFields(t),..._.getDataFields(n)],i={eventName:`${this.namespace}.${e}`,error:{errorGroup:A.Error,tag:0},eventFlags:r,dataFields:o};this.oTelLogger.sendError(i)}static getDataFields(e){return e?Object.keys(null!=e?e:{}).map((t=>{const n=e[t];switch(typeof n){case"number":return S.ip(t,n);case"string":default:return S.m9(t,n);case"boolean":return S.LK(t,n)}})):[]}static getErrorDataFields(e){if("object"!=typeof e||!e)return[];const t=[];return!("code"in e)||"string"!=typeof e.code&&"number"!=typeof e.code||t.push(S.m9("ErrorCode",`${e.code}`)),"message"in e&&"string"==typeof e.message&&t.push(S.m9("ErrorMessage",e.message)),t}}_.AriaTenantToken="3de38b41008a4da5a5381ef307f91597-636c040a-3c10-4912-9e28-de026a94600f-6848",_.NexusTenantToken=1718,_.Namespace="Office.OneNote.SDX.Integrations.HostedWorkspaces";class U{static withResolvers(){const e=Promise;if("function"==typeof e.withResolvers)return e.withResolvers();{let e=()=>{},t=()=>{};return{promise:new Promise(((n,r)=>{e=n,t=r})),resolve:e,reject:t}}}}class j{constructor(){this.defers={},this.results={},this.eventHandlers=[],this.initialized=!1}async initialize(){var e;if(!this.initialized&&(this.initialized=!0,window.OfficeFirstParty&&(null===(e=OfficeFirstParty.PrivateApi)||void 0===e?void 0:e.onPrivateEvent))){const e=this.onNativeEvent.bind(this);try{const t=await OfficeFirstParty.PrivateApi.onPrivateEvent(e);this.eventRevoker=t}catch(e){this.eventRevoker=void 0}}}cleanup(){this.eventRevoker&&this.eventRevoker(),this.eventRevoker=void 0}registerEvent(e){this.eventHandlers.push(e)}unregisterEvent(e){const t=this.eventHandlers.indexOf(e);t>=0&&this.eventHandlers.splice(t,1)}onNativeEvent(e){const t=JSON.parse(e);if("AsyncApiResult"===t.__type){const{__type:e,__apiId:n,__error:r,...o}=t;if(n in this.defers){const e=this.defers[n];if(delete this.defers[n],0!==r){const t=j.createErrorObject(e.api,r);e.reject(t)}else e.resolve(o)}else this.results[n]=t}else if("Event"===t.__type){const{__type:e,__eventName:n,...r}=t;for(const e of this.eventHandlers)e(n,r)}}execute(e,t){var n;if(!window.OfficeFirstParty||!(null===(n=OfficeFirstParty.PrivateApi)||void 0===n?void 0:n.execute))return Promise.reject(new d(d.E_FAIL,"PrivateApi is not available"));const r=Object.assign({__api:e},t),o=JSON.stringify(r);return OfficeFirstParty.PrivateApi.execute(o).then((t=>{const n=JSON.parse(t),{__error:r,__async:o,...i}=n;if(0!==r){const t=j.createErrorObject(e,r);throw _.Instance.logError("ApiBridgeError",r,{ErrorMethod:e,ErrorDetails:t.message,ErrorCode:t.errorCode,ErrorName:t.name}),t}if("string"!=typeof o)return i;if(o in this.results){const{__type:t,__apiId:n,__error:r,...i}=this.results[o];if(delete this.results[o],0!==r){throw j.createErrorObject(e,r)}return i}{const{promise:t,resolve:n,reject:r}=U.withResolvers();return this.defers[o]={api:e,resolve:n,reject:r},t}}))}static createErrorObject(e,t){const n=t>>>0;switch(n){case p.E_NOTIMPL:return new p(`The private API '${e}' is not implemented`);case h.E_INVALIDARG:return new h(`Invalid arguments are passed to the private API '${e}'`);default:return new d(t,`Calling private API '${e}' gives error code: ${t} | ${n} (converted error code)`)}}}var z=s(9307);const q=new j;class B{static failedToNavigateToSearchResult(e){return z.log("ApiBridge: SendToNative: Navigate Search Result Failed:",e),q.execute("notifyNavigateToSearchResultFailed",e)}static failedToNavigateToLink(e){return z.log("ApiBridge: SendToNative: Navigate Link Failed:",e),q.execute("notifyNavigateToLinkFailed",e)}static navigateToLinkStatus(e){return z.log("ApiBridge: SendToNative: Navigate Link Status:",e),q.execute("notifyNavigateToLinkStatus",e)}static navigateToHomeEvent(){return z.log("ApiBridge: SendToNative: Home Navigate"),q.execute("navigateToHome")}static navigateToNotebookEvent(e){return z.log("ApiBridge: SendToNative: Notebook Navigate:",e),q.execute("navigateToNotebook",e)}static navigateToPageEvent(e){return z.log("ApiBridge: SendToNative: Page Navigate:",e),q.execute("navigateToPage",e)}static navigateToSearchResultStatus(e){return z.log("ApiBridge: SendToNative: Navigate Search Result Status:",e),q.execute("notifyNavigateToSearchResultStatus",e)}static renderCompleteEvent(){return z.log("ApiBridge: SendToNative: Render Complete"),q.execute("renderComplete")}}class ${static removeWorkspace(e){return z.log("ApiBridge: SendToNative: Remove Workspace:",e),q.execute("removeWorkspace",e)}static renameWorkspace(e){return z.log("ApiBridge: SendToNative: Rename Workspace:",e),q.execute("renameWorkspace",e)}static setWorkspaces(e){return z.log("ApiBridge: SendToNative: Setting Workspaces:",e),q.execute("setWorkspaces",e)}static updateWorkspace(e){return z.log("ApiBridge: SendToNative: Update Workspace:",e),q.execute("updateWorkspace",e)}static getActiveUserIdentity(){return z.log("ApiBridge: SendToNative: Get Active User Identity"),q.execute("getActiveIdentity")}}const H={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let W;const V=new Uint8Array(16);function G(){if(!W){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");W=crypto.getRandomValues.bind(crypto)}return W(V)}const Q=[];for(let e=0;e<256;++e)Q.push((e+256).toString(16).slice(1));function J(e,t=0){return(Q[e[t+0]]+Q[e[t+1]]+Q[e[t+2]]+Q[e[t+3]]+"-"+Q[e[t+4]]+Q[e[t+5]]+"-"+Q[e[t+6]]+Q[e[t+7]]+"-"+Q[e[t+8]]+Q[e[t+9]]+"-"+Q[e[t+10]]+Q[e[t+11]]+Q[e[t+12]]+Q[e[t+13]]+Q[e[t+14]]+Q[e[t+15]]).toLowerCase()}const K=function(e,t,n){if(H.randomUUID&&!t&&!e)return H.randomUUID();const r=(e=e||{}).random||(e.rng||G)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return J(r)};var X,Y=s(9307);!function(e){e.HostAudienceGroup="HostAudienceGroup",e.LaunchDocUrl="LaunchDocUrl",e.LaunchDocUrlRequiresRedeem="LaunchDocUrlRequiresRedeem",e.LaunchPodId="LaunchPodId",e.LaunchSpoId="LaunchSpoId",e.LoopAudienceOverride="LoopAudienceOverride",e.IsUILessLoad="IsUILessLoad"}(X||(X={}));const Z=K(),ee=K();class te{static getSetting(e,t){var n;return null!==(n=Office.context.document.settings.get(e))&&void 0!==n?n:t}static getLocale(e){var t;return null!==(t=Office.context.displayLanguage)&&void 0!==t?t:e}static getPlatform(){switch(Office.context.platform){case Office.PlatformType.PC:return"Win32";case Office.PlatformType.OfficeOnline:return"Web";case Office.PlatformType.Mac:return"Mac";case Office.PlatformType.iOS:return"iOS";case Office.PlatformType.Android:return"Android";default:return"Win32"}}static getCorrelationId(){var e;return null!==(e=Office.context.document.settings.get("HostCorrelationId"))&&void 0!==e?e:ee}static getSessionId(){var e;return null!==(e=Office.context.document.settings.get("HostSessionId"))&&void 0!==e?e:Z}static isUILessLoad(){return Y.log(`Force Render: ${te.forceRender}`),!te.forceRender&&te.getSetting(X.IsUILessLoad,!1)}static clearOnRenderSettings(){Office.context.document.settings.remove(X.IsUILessLoad),Office.context.document.settings.remove(X.LaunchDocUrl),Office.context.document.settings.remove(X.LaunchDocUrlRequiresRedeem),Office.context.document.settings.remove(X.LaunchPodId),Office.context.document.settings.remove(X.LaunchSpoId)}}te.forceRender=!1;var ne=s(9307);let re,oe;function ie(){return re||(re=function(){const e=te.getSetting(X.LoopAudienceOverride,"");if(e)return function(e){const t=e.toLowerCase();switch(t){case"automation":return"Automation";case"development":return"Development";case"dod":return"DoD";case"dogfood":return"Dogfood";case"gcc":return"GCC";case"gcc-high":return"GCC-High";case"gallatin":return"Gallatin";case"local":return"Local";case"microsoft":return"Microsoft";case"preview":return"Preview";case"production":return"Production";case"staging":return"Staging";case"usnat":return"USNat";case"ussec":return"USSec";default:throw new Error(`Unhandled audience setting: ${t}`)}}(e);const t="Production",n=function(e){const t=e.toLowerCase();switch(t){case"automation":return m.EW.Automation;case"dogfood":return m.EW.Dogfood;case"insiders":return m.EW.Insiders;case"microsoft":return m.EW.Microsoft;case"production":return m.EW.Production;default:throw new Error(`Unhandled audience group setting: ${t}`)}}(te.getSetting(X.HostAudienceGroup,t));switch(n){case"Automation":case"Dogfood":return"Staging";case"Insiders":return"Preview";case"Microsoft":return"Dogfood";case"Production":return"Production";default:throw new Error(`Unhandled Loop audience mapping for Office audience groupd audienceGroup: ${n}`)}}(),ne.log("Configured Loop audience:",re)),re}function se(){return oe||(oe=function(){const e=ie();switch(e){case"DoD":case"Dogfood":case"GCC":case"GCC-High":case"Gallatin":case"Microsoft":case"Preview":case"Production":case"Staging":case"USNat":case"USSec":return{audience:e};case"Development":case"Local":return{audience:"Local",ring:"Staging"};default:throw new Error(`Unhandled Loop environment mapping for Loop audience: ${e}`)}}()),oe}var ae=s(3178),ce=s(7419);const le=e=>(0,ce.F)("substrate",e),ue="https://outlook.office365.com/connectors",de="https://ic3.teams.office.com",pe="https://apihub.azure.com",he="https://augloop.office.com/v2",fe="https://api.bap.microsoft.com",ge="https://www.bing.com",me="https://designerappservice.officeapps.live.com",ve="96ff4394-9197-43aa-b393-6a41652e21f8",ye="a522f059-bb65-47c0-8934-7db6e5286414",be="https://pushchannel.1drv.ms",we="https://gcs.office.com",Se="https://m365.cloud.microsoft",Ce="https://titles.prod.mos.microsoft.com",ke="https://api.office.net",Ee="https://learningtools.onenote.com",Te="083b36c3-2702-4850-972a-42894c3c6437",Pe="https://api.powerplatform.com/",Ne="https://api.test.powerplatform.com",Ie="https://api.preprod.powerplatform.com",Oe="https://service.flow.microsoft.com",Ae="https://safelinks.protection.office365.com",Le="https://dataservice.o365filtering.com",Fe="https://microsoft.sharepoint.com",De="https://api.spaces.skype.com",xe="00000003-0000-0ff1-ce00-000000000000",Re="a75e09c5-9ed5-4004-82d5-4a44c9fd7052",Me="https://urlp-v2.asm.skype.com",_e="https://www.yammer.com",Ue=[{tokenType:"AeaToken",scopes:[".default"],resource:()=>ue},{tokenType:"AmsToken",scopes:[".default"],resource:()=>de},{tokenType:"ApiHub",scopes:[".default"],resource:()=>pe},{tokenType:"AugLoop",scopes:[".default"],resource:()=>he},{tokenType:"Bap",scopes:[".default"],resource:()=>fe},{tokenType:"CopilotStudio",scopes:[".default"],resource:()=>ve},{tokenType:"CopilotStudioTest",scopes:[".default"],resource:()=>ye},{tokenType:"Designer",scopes:[".default"],resource:()=>me},{tokenType:"FluidPush",scopes:[".default"],resource:()=>be},{tokenType:"Gcs",scopes:[".default"],resource:()=>we},{tokenType:"Graph",scopes:[".default"],resource:e=>(0,ae.o)(null!=e?e:"Production")},{tokenType:"Iris",scopes:[".default"],resource:e=>(0,ce.F)("iris",null!=e?e:"Production")+"/v4"},{tokenType:"Loki",scopes:[".default"],resource:e=>(0,ce.F)("loki",null!=e?e:"Production")},{tokenType:"M365Prod",scopes:[".default"],resource:()=>Se},{tokenType:"MetaOS",scopes:[".default"],resource:()=>Ce},{tokenType:"MruPlusPlus",scopes:[".default"],resource:()=>ke},{tokenType:"Mss",scopes:[".default"],resource:()=>ge},{tokenType:"OboToken",scopes:[".default"],resource:e=>null!=e?e:""},{tokenType:"Ocps",scopes:[".default"],resource:e=>function(e){return(0,ce.F)("ocps",e)}(null!=e?e:"Production")},{tokenType:"OfficeApi",scopes:[".default"],resource:()=>ke},{tokenType:"OneNote",scopes:[".default"],resource:()=>Ee},{tokenType:"Outlook",scopes:[".default"],resource:e=>(e=>(0,ce.F)("outlook",e))(null!=e?e:"Production")},{tokenType:"Pacman",scopes:[".default"],resource:()=>Te},{tokenType:"PpapiProd",scopes:[".default"],resource:()=>Pe},{tokenType:"PpapiPreProd",scopes:[".default"],resource:()=>Ie},{tokenType:"PpapiTest",scopes:[".default"],resource:()=>Ne},{tokenType:"PowerAutomate",scopes:[".default"],resource:()=>Oe},{tokenType:"PushChannel",scopes:[".default"],resource:()=>be},{tokenType:"SafeLinks",scopes:[".default"],resource:()=>Ae},{tokenType:"SafeLinksLegacy",scopes:[".default"],resource:()=>Le},{tokenType:"Skype",scopes:[".default"],resource:()=>De},{tokenType:"SPAC",scopes:[".default"],resource:()=>xe},{tokenType:"Substrate",scopes:[".default"],resource:e=>le(null!=e?e:"Production")},{tokenType:"SubstrateSearch",scopes:[".default"],resource:e=>le(null!=e?e:"Production")+"/search"},{tokenType:"Sydney",scopes:[".default"],resource:e=>le(null!=e?e:"Production")+"/sydney"},{tokenType:"Teams",scopes:[".default"],resource:e=>(0,ce.F)("teams",null!=e?e:"Production")},{tokenType:"TenantFeedback",scopes:[".default"],resource:e=>le(null!=e?e:"Production")+"/tenantfeedback"},{tokenType:"Trouter",scopes:[".default"],resource:()=>Re},{tokenType:"Urlp",scopes:[".default"],resource:()=>Me},{tokenType:"Yammer",scopes:[".default"],resource:()=>_e}];var je=s(9307);const ze=new Map,qe=new Map;var Be=s(9307);class $e{constructor(e){this.audience="Local",this.bizChatTokenPromiseCache=new Map,this.appId="c0ab8ce9-e9a0-42e7-b064-33d422df41f1",this.redirectUri="brk-multihub://fa000000174.resources.office.net",this.augloop=()=>this.getBizChatTokenForTokenType("AugLoop"),this.substrate=()=>this.getBizChatTokenForTokenType("SubstrateSearch"),this.sydney=()=>this.getBizChatTokenForTokenType("Sydney"),this.tenantFeedback=()=>this.getBizChatTokenForTokenType("TenantFeedback"),this.loki=async()=>{const e=await this.getBizChatTokenForTokenType("Loki");return Promise.resolve({accessToken:e,expirationTime:0})},this.feed=()=>this.getBizChatTokenForTokenType("Substrate"),this.yammer=()=>this.getBizChatTokenForTokenType("Yammer"),this.spo=async(e,t)=>{var n;let r=null!==(n=null==e?void 0:e.toLowerCase())&&void 0!==n?n:"";r.includes(".sharepoint.")||(r=Fe);const o=await this.getBizChatTokenForResource(r,"SharePoint",[r+"/.default"]);return Promise.resolve({AuthToken:o,AuthTokenTtl:void 0})},this.mos=()=>this.getBizChatTokenForTokenType("MetaOS"),this.oboToken=e=>this.getBizChatTokenForTokenType("OboToken",e),this.aeaToken=()=>this.getBizChatTokenForTokenType("AeaToken"),this.amsToken=()=>this.getBizChatTokenForTokenType("AmsToken"),this.graph=()=>this.getBizChatTokenForTokenType("Graph"),this.powerAutomate=()=>this.getBizChatTokenForTokenType("PowerAutomate"),this.powerPlatform=e=>{let t;switch(e){case"prod":t="PpapiProd";break;case"preprod":t="PpapiPreProd";break;case"test":t="PpapiTest";break;default:return Promise.reject(new Error("Unknown clusterCategory"))}return this.getBizChatTokenForTokenType(t)},this.apiHub=()=>this.getBizChatTokenForTokenType("ApiHub"),this.apiSkype=()=>this.getBizChatTokenForTokenType("Skype"),this.teams=()=>this.getBizChatTokenForTokenType("Teams"),this.outlook=()=>this.getBizChatTokenForTokenType("Outlook"),this.designer=()=>this.getBizChatTokenForTokenType("Designer"),this.apiUrlp=()=>this.getBizChatTokenForTokenType("Urlp"),this.ocps=()=>this.getBizChatTokenForTokenType("Ocps"),this.powerbi=()=>this.getBizChatTokenForTokenType("PowerBI"),this.pushChannel=()=>this.getBizChatTokenForTokenType("PushChannel"),this.mss=()=>this.getBizChatTokenForTokenType("Mss"),this.copilotStudio=e=>this.getBizChatTokenForTokenType("prod"===e?"CopilotStudio":"CopilotStudioTest"),this.bap=()=>this.getBizChatTokenForTokenType("Bap"),this.gcs=()=>this.getBizChatTokenForTokenType("Gcs"),this.mruPlusPlus=()=>this.getBizChatTokenForTokenType("MruPlusPlus"),this.trouter=()=>this.getBizChatTokenForTokenType("Trouter"),this.onenote=()=>this.getBizChatTokenForTokenType("OneNote"),this.safeLinks=e=>this.getBizChatTokenForTokenType(null!=e&&e?"SafeLinksLegacy":"SafeLinks"),this.pacman=()=>this.getBizChatTokenForTokenType("Pacman"),this.audience=e}async getBizChatTokenForTokenType(e,t){const n=this.bizChatTokenPromiseCache.get(e);if(n)return Be.log(`acquire BizChat token of type: ${e} is already in progress`),n;const r=Ue.find((t=>t.tokenType===e));if(!r){const n=new Error("Unsupported token type");return Be.error(`Unsupported BizChat token type: ${e}:`,t),_.Instance.logError("BizChatAuthError",n,{ErrorMethod:"getBizChatTokenForResource",TokenType:e}),Promise.reject(`Unsupported BizChat token type: ${e}`)}const o=r.resource(null!=t?t:this.audience);return this.getBizChatTokenForResource(o,e,[o+"/"+r.scopes[0]])}async getBizChatTokenForResource(e,t,n){const r=this.bizChatTokenPromiseCache.get(e);if(r)return Be.log(`acquire BizChat token of type: ${e} is already in progress`),r;const o=K(),i=Date.now(),s=OfficeFirstPartyAuth.NestedAppAuth.load(this.appId,this.redirectUri).catch((e=>{throw _.Instance.logError("BizChatAuthError",e,{ErrorMethod:"load",ErrorCode:e.code,ErrorAppId:this.appId,ErrorRedirectUri:this.redirectUri}),Be.error("Nested App Auth load failed:",e.code),new Error(`Office FirstParty Nested App Auth load failed with error ${e.code}`)}));await s;const a=OfficeFirstPartyAuth.NestedAppAuth.getAccessToken({clientId:this.appId,scopes:n,popup:OfficeFirstPartyAuth.NestedAppAuth.PopupOptions.None,correlationId:o,redirectUri:this.redirectUri}).then((e=>{const n=Date.now()-i;var r,o;return r=t,o=n,qe.get(r)||(je.log(`Acquired initial BizChat token ${r} in ${o}ms`),_.Instance.logEvent("InitialBizChatTokenAcquired",{TokenType:r,Duration:o}),qe.set(r,!0)),e.accessToken})).catch((n=>{throw _.Instance.logError("BizChatAuthError",n,{ErrorMethod:"getAccessToken",TokenType:t}),Be.error(`acquire BizChat token of type: ${t} failed for resource ${e}:`,n),n})).finally((()=>{this.bizChatTokenPromiseCache.delete(e)}));return this.bizChatTokenPromiseCache.set(e,a),a}get BizChatTokenProvider(){return this}clearCache(){this.bizChatTokenPromiseCache.clear()}get Disposable(){return this}dispose(){this.clearCache()}}var He=s(9307);const We="identityChanged",Ve={id:"",name:"",tenantId:"",identityType:0};class Ge extends(u()){constructor(){super(),this.tokenPromiseCache=new Map,this.identity=void 0,this.audience="Local",this.isDisposed=!1,this.tokenFetchInProgress=!1,this.audience=ie(),this.bizChatAuthService=new $e(this.audience)}async initializePreAuthz(){if(!this.tokenFetchInProgress){this.tokenFetchInProgress=!0;try{await this.populateIdentity(),He.log("Acquiring required auth tokens");const e=async()=>{await Promise.all([this.getPreAuthToken("Graph"),this.getPreAuthToken("Substrate"),this.getPreAuthToken("Ocps")])},t=async()=>{await this.uiTokensFetchPromise,He.log("UI tokens acquired"),await Promise.all([this.bizChatAuthService.sydney(),this.getPreAuthToken("AugLoop"),this.getPreAuthToken("OfficeApi")]),await Promise.all([this.getPreAuthToken("FluidPush"),this.getPreAuthToken("Urlp"),this.getPreAuthToken("Loki")])};this.uiTokensFetchPromise=e().catch((e=>{_.Instance.logError("AuthError",e,{ErrorMethod:"fetchUIRequiredTokens"}),He.error("Failed to acquire ui tokens:",e)})),t().catch((e=>{_.Instance.logError("AuthError",e,{ErrorMethod:"fetchTokens"}),He.error("Failed to acquire pre-auth tokens:",e)})).finally((()=>{this.tokenFetchInProgress=!1}))}catch(e){throw _.Instance.logError("AuthError",e,{ErrorMethod:"initializePreAuthz"}),this.tokenFetchInProgress=!1,e}}}get Disposable(){return this}dispose(){this.isDisposed=!0}get TokenProvider(){return this}getIdentity(){if(!this.isDisposed)return this.identity}get identityType(){if(!this.isDisposed&&this.identity)switch(this.identity.identityType){case 2:case 4:return"Enterprise";case 1:return"Consumer";default:return}}async getOfficeFirstPartyAuthResultByTokenType(e,t,n,r){if(this.isDisposed)return Promise.reject("Provider has been disposed");let o="";const i=Ue.find((t=>t.tokenType.toLowerCase()===e.toLowerCase()));return i?(o=i.resource(this.audience),this.getOfficeFirstPartyAuthResultByResource(o,e,t,n,r)):Promise.reject(`Unsupported token type: ${e}`)}async getOfficeFirstPartyAuthResultByResource(e,t,n,r,o){if(this.isDisposed)return Promise.reject("Provider has been disposed");const i=this.tokenPromiseCache.get(e);if(i)return He.log(`acquire token for resource: ${e} is already in progress`),i;const s=Date.now(),a=(async()=>{var t;return await OfficeFirstPartyAuth.load(),OfficeFirstPartyAuth.getAccessToken({resource:e,authChallenge:n,policy:r,identityId:null===(t=this.identity)||void 0===t?void 0:t.id},{forceRefresh:o})})().then((e=>{const n=Date.now()-s;var r,o;return r=t,o=n,ze.get(r)||(je.log(`Acquired initial token ${r} in ${o}ms`),_.Instance.logEvent("InitialTokenAcquired",{TokenType:r,Duration:o}),ze.set(r,!0)),e})).catch((t=>{throw _.Instance.logError("AuthError",t,{ErrorMethod:"getOfficeFirstPartyAuthResultByResource"}),He.error(`acquire token for resource: ${e} failed:`,t),t})).finally((()=>{this.tokenPromiseCache.delete(e)}));return this.tokenPromiseCache.set(e,a),a}getOfficeFirstPartyParsedToken(e){const t=e.accessToken.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(window.atob(t))}async getToken(e,t){var n,r;if(this.isDisposed)return Promise.reject("Provider has been disposed");let o,i=this.getResourceForScopes(e),s=i.toLowerCase();if(""===s)try{const e=null!==(r=null===(n=t.request)||void 0===n?void 0:n.url)&&void 0!==r?r:"",o=new URL(e);i=o.origin,s=o.origin.toLowerCase()}catch(e){const t=new Error("Unsupported token request: invalid request URL");throw _.Instance.logError("AuthError",t,{ErrorMethod:"getToken"}),new Error("Unsupported token request: invalid request URL")}try{o=new URL(s)}catch(e){He.warn("Unsupported token request: Maybe invalid request URL: ",s)}const a=Ue.find((e=>{const t=e.resource(this.audience).toLowerCase();return t===s||t===(null==o?void 0:o.origin.toLowerCase())}));if(a)return new Promise(((e,n)=>{this.getOfficeFirstPartyAuthResultByResource(a.resource(this.audience).toLowerCase(),a.tokenType,t.claims,void 0,t.forceRefresh).then((t=>{e({token:t.accessToken})})).catch((e=>{He.error("Failed to acquire token for resource:",a.tokenType,a.resource(this.audience).toLowerCase(),e),_.Instance.logError("AuthError",e,{ErrorMethod:"getToken",TokenType:a.tokenType}),n(e)}))}));He.warn("Unknown token resource:",s,e,t);const c=s.includes(".sharepoint.")?"SharePoint":"Unknown";return new Promise(((e,n)=>{this.getOfficeFirstPartyAuthResultByResource(s,c,t.claims,void 0,t.forceRefresh).then((t=>{e({token:t.accessToken})})).catch((e=>{He.error("Failed to acquire token for resource:",s,e),_.Instance.logError("AuthError",e,{ErrorMethod:"getToken",TokenType:c}),n(e)}))}))}getUserContext(){let e=this.getIdentity();e||(e=Ve);const t=this.getUserIdSpaceFromTenant(e);return{get UserContext(){return this},user:{id:e.id,tenantId:e.tenantId,userIdSpace:t,oid:e.oid,upn:e.upn},signInState:["kmsi"],get Disposable(){return this},dispose(){}}}async getPreAuthToken(e,t){try{const n=Date.now(),r=await this.getOfficeFirstPartyAuthResultByTokenType(e),o=Date.now();if(He.log(`${e} token acquired in ${o-n}ms`),t){const e=this.getOfficeFirstPartyParsedToken(r);await t(e)}return r}catch(t){_.Instance.logError("AuthError",t,{ErrorMethod:"getPreAuthToken",TokenType:e}),He.error(`getPreAuthToken: Error fetching auth token for ${e}:`,t)}}getResourceForScopes(e){let t;return e.forEach((e=>{const n=e.lastIndexOf("/"),r=n>0?e.substring(0,n).toLowerCase():"";if(void 0===t)t=r;else if(t!==r){const e=new Error("All scopes must have the same resource");throw _.Instance.logError("AuthError",e,{ErrorMethod:"resourceForScopes"}),e}})),null!=t?t:""}getTenantGroupType(e){return"9188040d-6c67-4c5b-b112-36a304b66dad"===e?"Consumer":"Commercial"}getUserIdSpaceFromTenant(e){return"Consumer"===this.getTenantGroupType(e.tenantId)?"MSAPUID":"UserObjectId"}async populateIdentity(){var e,t;const n=$.getActiveUserIdentity().catch((e=>(_.Instance.logError("AuthError",e,{ErrorMethod:"populateIdentity"}),He.error("Failed to get primary identity info:",e),Promise.reject("Failed to get primary identity info from client")))),r=await n,o={id:r.userId,name:r.userName,tenantId:r.tenantId,identityType:r.accountType,upn:r.email};(o.tenantId!==(null===(e=this.identity)||void 0===e?void 0:e.tenantId)||o.id!==(null===(t=this.identity)||void 0===t?void 0:t.id))&&(this.tokenPromiseCache.clear(),this.bizChatAuthService.clearCache(),this.identity=o,He.log("Identity changed:",this.identity),this.emit(We))}}var Qe=s(9307);var Je=s(7737),Ke=s(1274),Xe=s(1262);const Ye="function"==typeof FinalizationRegistry;class Ze{get Disposable(){return this}dispose(){this.isDisposed=!0,this.loggingTimeout&&clearTimeout(this.loggingTimeout),this.logger?.Disposable.dispose(),this.logger=void 0}trackObject(e,t){this.isDisposed||(this.trackedObjects.add(e),this.finalizationRegistry?.register(t,e))}markParentAsClosed(){this.isDisposed||(this.parentClosedTime=globalThis.performance.now(),this.loggingTimeout=setTimeout((()=>this.closeAndSendTelemetry()),this.loggingDelay))}closeAndSendTelemetry(){const e={};for(const t of this.trackedObjects){const n=this.trackedObjectsGcTime.get(t);e[t]="number"==typeof n&&(!this.parentClosedTime||n-this.parentClosedTime)}const t=this.trackedObjects.size>0?this.trackedObjectsGcTime.size>0&&(!this.parentClosedTime||Math.max(...this.trackedObjectsGcTime.values())-this.parentClosedTime):void 0;this.logger?.send({category:Xe.hB.Generic,subCategory:this.subcategory,eventName:"MemoryCleanup",gcTimes:JSON.stringify(e),finalObjectGcTime:t,loggingDelay:this.loggingDelay}),this.Disposable.dispose()}constructor(e,t,n,r){this.loggingDelay=e,this.subcategory=n,this.trackedObjectsGcTime=new Map,this.trackedObjects=new Set,Ye?(this.logger=new Ke.p("MemoryLeakTracker",t,r),this.finalizationRegistry=new FinalizationRegistry((e=>{this.trackedObjectsGcTime.set(e,globalThis.performance.now()),this.trackedObjectsGcTime.size===this.trackedObjects.size&&this.closeAndSendTelemetry()}))):this.isDisposed=!0}}function et(e){return e?Object.keys(e).sort().join(","):""}class tt{get IFluidDependencySynthesizer(){return this}register(e,t){if(this.providers.has(e))throw new Error(`Attempting to register a provider of type ${String(e)} that already exists`);this.clearMemo(),this.providers.set(e,t)}unregister(e){this.providers.has(e)&&(this.providers.delete(e),this.clearMemo())}clearMemo(){this.memo.clear()}synthesize(e,t){const n=`required:${et(t)},optional:${et(e)}`;if(this.memo.has(n))return this.memo.get(n);const r={};return this.generateRequired(r,t),this.generateOptional(r,e),Object.defineProperty(r,"IFluidDependencySynthesizer",{get:()=>this}),this.memo.set(n,r),r}has(e,t){return!!this.providers.has(e)||!0!==t&&this.parents.some((t=>t.has(e)))}generateRequired(e,t){if(void 0===t)return;const n=this.generate(e,t);if(0!==n.size){const e=Array.from(n).join(", ");throw new Error(`Object attempted to be created without registered required providers ${e}`)}}generateOptional(e,t){if(void 0===t)return;const n=this.generate(e,t);for(const t of n){const n={get:async()=>{}};Object.defineProperty(e,t,n)}}generate(e,t){const n=new Set(Object.keys(t));for(const t of n){const r=this.resolveLocalProvider(t);r&&(n.delete(t),Object.defineProperty(e,t,r))}for(const t of this.parents){const r={};for(const e of n)r[e]=e;const o=t.synthesize(r,void 0);for(const t of n){const r=Object.getOwnPropertyDescriptor(o,t);r&&(n.delete(t),Object.defineProperty(e,t,r))}}return n}constructor(...e){this.providers=new Map,this.memo=new Map,this.resolveLocalProvider=e=>{const t=this.providers.get(e);if(t)return"function"==typeof t?{get:()=>{if("function"==typeof t)return Promise.resolve(this.IFluidDependencySynthesizer).then((async e=>t(e))).then((t=>t?.[e]))}}:{get:()=>new Je.I((async()=>Promise.resolve(t).then((t=>{if(t)return t[e]}))))}},this.parents=e.filter((e=>void 0!==e))}}class nt{get IFluidDependencySynthesizer(){return this}register(e,t){let n;this.dependencySynthesizer.has("DataConnector")&&(n=this.dependencySynthesizer.synthesize({DataConnector:"DataConnector"},void 0)),this.dependencySynthesizer.register(e,new Je.I((async()=>{const r=await Promise.resolve(t);if("DataConnector"!==e){const e=await(n?.DataConnector);e?.addComponentTracking(r)}return this.synthDependencies.set(e,r),this.memoryLeakTracker?.trackObject(e,r),r})))}registerIfNotAlreadyExists(e,t){this.dependencySynthesizer.has(e)||this.register(e,t)}synthesize(e,t={}){return this.dependencySynthesizer.synthesize(e,t)}has(e){return this.dependencySynthesizer.has(e)}unregister(e){return this.dependencySynthesizer.unregister(e)}dispose(){for(const[e,t]of this.synthDependencies)t.Disposable.dispose(),this.unregister(e);this.synthDependencies.clear(),this.memoryLeakTracker?.markParentAsClosed()}constructor(e,t){this.synthDependencies=new Map,this.dependencySynthesizer=new tt(e);const n=e?.synthesize({NamespaceLogger:"NamespaceLogger"},void 0);n?.NamespaceLogger?.then((e=>{e&&(this.memoryLeakTracker=new Ze(t?.memoryLeakDetectionWaitTime??3e5,e,"LoopDependencyContainer"))})).catch((()=>{}))}}const rt={productionOrigin:"https://loop.microsoft.com",previewOrigin:"https://preview.loop.microsoft.com",dogfoodOrigin:"https://df.loop.microsoft.com",stagingOrigin:"https://dev.loop.microsoft.com",localOrigins:["https://local.loop.microsoft.com","https://local.loop.microsoft.com:8080","https://local.loop.microsoft.com:8081","http://localhost:8094","http://localhost"]},ot={gallatinOrigin:"https://loop.microsoftonline.cn",dodOrigin:"https://loop.apps.mil",gcchOrigin:"https://loop.office365.us",publicOrigin:"https://loop.cloud.microsoft",developerOrigin:"https://loop.cloud-dev.microsoft"};function it(e){return encodeURIComponent(btoa(JSON.stringify(e)))}function st(e){return t=>{if("object"!=typeof t||!t)return!1;const n=t;for(const[t,r]of Object.entries(e)){const e=n[t];if(typeof e!==r||!e)return!1}return!0}}const at="/p";st({p:"object"}),st({w:"object"}),st({u:"string"});var ct=s(4223);const lt="fo";function ut(e){const t=function(e){const t=atob(e);if(!t.startsWith("ODSP"))throw new Error("Cannot parse id value when provided ID is not for ODSP pod");const n=t.split("|");return n.length>4?{siteDomain:n[1],driveId:n[2],itemId:n[3],podFileFolderPath:n[4]}:{siteDomain:n[1],driveId:n[2],itemId:n[3]}}(e),n=`https://${t.siteDomain}`,r=new URL(n);return(0,ct.Cu)(r,{siteUrl:n,driveId:t.driveId,itemId:t.itemId,dataStorePath:""}),t.podFileFolderPath&&r.searchParams.set(lt,btoa(t.podFileFolderPath)),r.toString()}const dt=ot.publicOrigin,pt=new URL("/notebooks",dt);function ht(e){const{docUrl:t,requiresRedeem:n,mfsPodId:r}=e,o={u:t,r:!!n},i=r?ft(r):void 0,s=`${at}/${it({w:i,p:o,ch:{c:void 0}})}`;return new URL(s,dt)}function ft(e){return{u:ut(e),r:!1}}const gt="@fluidx/loop-workspace-component",mt=(e,t)=>t.some((t=>e instanceof t));let vt,yt;const bt=new WeakMap,wt=new WeakMap,St=new WeakMap,Ct=new WeakMap,kt=new WeakMap;let Et={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return wt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||St.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Nt(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Tt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(yt||(yt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(It(this),t),Nt(bt.get(this))}:function(...t){return Nt(e.apply(It(this),t))}:function(t,...n){const r=e.call(It(this),t,...n);return St.set(r,t.sort?t.sort():[t]),Nt(r)}}function Pt(e){return"function"==typeof e?Tt(e):(e instanceof IDBTransaction&&function(e){if(wt.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));wt.set(e,t)}(e),mt(e,vt||(vt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Et):e)}function Nt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",i)},o=()=>{t(Nt(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&bt.set(t,e)})).catch((()=>{})),kt.set(t,e),t}(e);if(Ct.has(e))return Ct.get(e);const t=Pt(e);return t!==e&&(Ct.set(e,t),kt.set(t,e)),t}const It=e=>kt.get(e);const Ot=["get","getKey","getAll","getAllKeys","count"],At=["put","add","delete","clear"],Lt=new Map;function Ft(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Lt.get(t))return Lt.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=At.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!Ot.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,o?"readwrite":"readonly");let s=i.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),o&&i.done]))[0]};return Lt.set(t,i),i}var Dt;Dt=e=>({...e,get:(t,n,r)=>Ft(t,n)||e.get(t,n,r),has:(t,n)=>!!Ft(t,n)||e.has(t,n)}),Et=Dt(Et);const xt="fluidCodeLoaderCache",Rt="codeLoaderStorage";function Mt(){return function(e,t,{blocked:n,upgrade:r,blocking:o,terminated:i}={}){const s=indexedDB.open(e,t),a=Nt(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(Nt(s.result),e.oldVersion,e.newVersion,Nt(s.transaction))})),n&&s.addEventListener("blocked",(()=>n())),a.then((e=>{i&&e.addEventListener("close",(()=>i())),o&&e.addEventListener("versionchange",(()=>o()))})).catch((()=>{})),a}(xt,1,{async upgrade(e,t){e.createObjectStore(Rt).createIndex("lastUpdatedTime","lastUpdatedTime")},blocked:()=>{throw new Error("Could not open code loader cache DB since it is blocked by an older client that has the DB open")}})}function _t(e){return`${e.packageName}_${e.ring}`}var Ut=s(4738);function jt(e,t,n,r,o,i,s,a,c){const l=r(n),u=l.then((async r=>{const s=await Mt(),c=_t({packageName:t,ring:n}),l=await s.get(Rt,c);l&&l.codeDetailsPackage.version===i(r).version||o(e,r,a),await s.put(Rt,{codeDetailsPackage:i(r),lastUpdatedTime:Date.now()},c),s.close()})).catch((e=>{c&&(0,Ut.hO)(c,{eventName:"CodeDetailsFromNetworkAndUpdateCacheFailed",message:`Failed to update cache and return code details for ${t}`},e)}));return{codePackagePromise:l.then((e=>{const t=s?s(e):void 0;return{...i(e),maxUnsupportedVersion:t}})),cacheUpdatePromise:u}}function zt(e,t){if(t.length>0&&"string"==typeof t[0]){const n=e.find((e=>!function(e,t){const n=new URL(e);return t.includes(n.origin)}(e,t)));return void 0===n}return qt(e,t)}function qt(e,t){const n=function(e){const t=new Map;for(const n of e)for(const e of n.origin)if(void 0===n.paths)t.set(e,"ALL");else{const r=t.get(e);"ALL"===r||(void 0===r?t.set(e,n.paths.map(Bt)):t.set(e,r.concat(n.paths.map(Bt))))}return t}(t);return e.every((e=>{const t=new URL(e);if(t.pathname!==decodeURIComponent(t.pathname))return!1;const r=n.get(t.origin);if("ALL"===r)return!0;if(void 0===r)return!1;{const e=Bt(t.pathname);return r.some((t=>t.every(((t,n)=>t===e[n]))))}}))}function Bt(e){return e.split("/").filter((e=>""!==e))}async function $t(e,t,n){try{const n=await Mt();await n.delete(Rt,_t({packageName:e,ring:t})),n.close()}catch(e){n&&(0,Ut.hO)(n,{eventName:"DeleteContainerDetailsFromCacheFailed",message:"DeleteContainerDetailsFromCache failed to delete container details from cache"},e)}}let Ht=24192e5;async function Wt(e,t,n,r,o){try{const i=await Mt(),s=await i.get(Rt,_t({packageName:e,ring:t}));if(i.close(),s){const i=Date.now()-s.lastUpdatedTime;return i>Ht?{metadata:{cacheStatus:"expired",cacheAge:i},codeDetailsPackage:void 0}:zt(r(s.codeDetailsPackage),n)?{metadata:{cacheStatus:"hit",cacheAge:i},codeDetailsPackage:s.codeDetailsPackage}:($t(e,t,o).catch((()=>{})),{metadata:{cacheStatus:"unsafe"},codeDetailsPackage:void 0})}}catch(e){o&&(0,Ut.hO)(o,{eventName:"GetCodeDetailsPackageFromCacheFailed",message:"GetCodeDetailsPackageFromCacheFailed failed return response"},e)}return{metadata:{cacheStatus:"miss"},codeDetailsPackage:void 0}}var Vt=s(7954);const Gt=new Map;let Qt=!1,Jt=0;function Kt(){if(document.hidden){const e=Date.now();Gt.forEach(((t,n)=>{-1===t&&Gt.set(n,e)})),Xt()}}function Xt(){Qt=!1,document.removeEventListener("visibilitychange",Kt)}function Yt(e){document.hidden?Gt.set(e,0):(Qt||(Qt=!0,document.addEventListener("visibilitychange",Kt)),Gt.set(e,-1))}function Zt(){return Jt+=1,Yt(Jt),Jt}function en(e,t){const n=Gt.get(e);return t&&tn(e),n}function tn(e){Gt.delete(e),0===Gt.size&&Qt&&Xt()}async function nn(e,t,n,r,o,i){const s=Zt(),a=Vt.m.start("GetCodeDetailsPackage",i,{addUserTiming:!0}),c=Wt(e,t,n,o,i).then((e=>({method:"cache",cacheDetails:e}))),l=r(t,n).then((e=>({method:"network",codeDetails:e}))),u=await Promise.race([c,l]);let d={documentEverHidden:en(s,!0)>-1,packageVersion:"cache"===u.method?u.cacheDetails.codeDetailsPackage?.version:u.codeDetails.version,deploymentRing:t};if("cache"===u.method){const{cacheDetails:e}=u;if(d={...d,...e.metadata},e.codeDetailsPackage)return a.setResult(!0,{method:"cache",...d}),e.codeDetailsPackage}return l.then((e=>(a.setResult(!0,{method:"network",...d}),e.codeDetails)))}const rn=(e,t,n,r="low")=>{let o=3;return function i(){return on(e,t,n,r).catch((()=>(o-=1,0===o?on(e,t,n,r):i())))}()};async function on(e,t,n,r){return new Promise(((o,i)=>{const s=e.document,a=s.createElement("script");a.setAttribute("fetchpriority",r);const c=n?.trustedTypesPolicy?.createScriptURL(t,{allowedScriptOrigins:n.allowedOrigins})??t;a.src=c,a.async=!1,a.charset="utf-8",a.crossOrigin="anonymous",a.onload=o,a.onerror=()=>i(new Error(`Failed to download the script at url: ${t}, isUserDefinitelyOffline: ${!e.navigator.onLine}`)),s.head.appendChild(a)}))}function sn(e){switch(e){case"Development":return"Development";case"Staging":return"Staging";case"Dogfood":return"Dogfood";case"Preview":case"Microsoft":case"Production":return"Prod";case"GCC":return"Gcc";case"GCC-High":return"GccHigh";case"DoD":return"DoD";case"USNat":return"USNat";case"USSec":return"USSec";case"Gallatin":return"Gallatin";default:return}}function an(e){switch(e){case"Development":return{audience:"Development"};case"Staging":return{audience:"Staging"};case"Dogfood":return{audience:"Dogfood"};case"Gcc":return{audience:"GCC"};case"GccHigh":return{audience:"GCC-High"};case"DoD":return{audience:"DoD"};case"USNat":return{audience:"USNat"};case"USSec":return{audience:"USSec"};default:return{audience:"Production"}}}function cn(e,t){return e?function(e){const t=sn(e?.audience);return t||(e?.ring?e.ring:"Prod")}(e):sn(t)??"Prod"}const ln=["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.cloud.microsoft","https://whiteboard.cloud.dev.microsoft","https://whiteboard.microsoft.com","https://whiteboard.office.com","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft","https://hosted.loop.cloud.dev.microsoft","https://hosted.loop.cloud.microsoft"],un=["https://res-gcch.cdn.office.net","https://whiteboard.office365.us"],dn=["https://res-dod.cdn.office.net","https://whiteboard.apps.mil"],pn=["https://res-cn.cdn.partner.office365.cn"],hn=["https://whiteboard.eaglex.ic.gov"],fn=["https://whiteboard.microsoft.scloud"],gn=[...ln,...un,...dn,...hn,...fn,...pn],mn=[{origin:["https://cdn.dev.fluidpreview.office.net","https://cdn.fluidpreview.office.net","https://res-sdf.cdn.office.net","https://res.cdn.office.net","https://dev.loop.microsoft.com","https://df.loop.microsoft.com","https://preview.loop.microsoft.com","https://loop.microsoft.com","https://dev.ch5.fluidpreview.office.net","https://ch5.fluidpreview.office.net","https://loop.cloud.microsoft","https://loop.cloud-dev.microsoft","https://hosted.loop.cloud.dev.microsoft","https://hosted.loop.cloud.microsoft"],paths:["fluid/dev","fluid/df","fluid/stg","fluid/prod","fluid/gcc","fluid/gcch","fluid/dod","fluid/local-redirect-container"]},{origin:["https://dev.whiteboard.microsoft.com","https://app.int.whiteboard.microsoft.com","https://app.whiteboard.microsoft.com","https://whiteboard.cloud.microsoft","https://whiteboard.cloud.dev.microsoft","https://whiteboard.microsoft.com","https://whiteboard.office.com"],paths:void 0}],vn=[{origin:["https://res-gcch.cdn.office.net"],paths:["fluid/gcch"]},{origin:["https://whiteboard.office365.us"],paths:void 0}],yn=[{origin:["https://res-dod.cdn.office.net"],paths:["fluid/dod"]},{origin:["https://whiteboard.apps.mil"],paths:void 0}],bn=[{origin:["https://res-cn.cdn.partner.office365.cn"],paths:["fluid/gallatin"]}],wn=[{origin:["https://whiteboard.eaglex.ic.gov"],paths:void 0}],Sn=[{origin:["https://whiteboard.microsoft.scloud"],paths:void 0}],Cn=[...mn,...vn,...yn,...wn,...Sn,...bn],kn=(e,t)=>{if(!(t?.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0)??1))return Cn;switch(e){case"GccHigh":return vn;case"DoD":return yn;case"USNat":return wn;case"USSec":return Sn;case"Gallatin":return bn;default:return mn}},En={Automation:"https://res.cdn.office.net/fluid/prod",Development:"https://res-sdf.cdn.office.net/fluid/dev",DoD:"https://res-dod.cdn.office.net/fluid/dod",Dogfood:"https://res.cdn.office.net/fluid/df",GCC:"https://res.cdn.office.net/fluid/gcc","GCC-High":"https://res-gcch.cdn.office.net/fluid/gcch",Local:"https://res.cdn.office.net/fluid/prod",Microsoft:"https://res.cdn.office.net/fluid/prod",Preview:"https://res.cdn.office.net/fluid/prod",Production:"https://res.cdn.office.net/fluid/prod",Staging:"https://res-sdf.cdn.office.net/fluid/stg",SyntheticTraffic:"https://res.cdn.office.net/fluid/prod",USNat:"",USSec:"",Gallatin:"https://res-cn.cdn.partner.office365.cn/fluid/gallatin"},Tn={Automation:"https://res-sdp.public.cdn.office.net/fluid/prod",Development:"https://res-sdp.sdf.cdn.office.net/fluid/dev",DoD:"https://res-sdp.dod.cdn.office.net/fluid/dod",Dogfood:"https://res-sdp.public.cdn.office.net/fluid/df",GCC:"https://res-sdp.gcc.cdn.office.net/fluid/gcc","GCC-High":"https://res-sdp.gcch.cdn.office.net/fluid/gcch",Local:"https://res-sdp.public.cdn.office.net/fluid/prod",Microsoft:"https://res-sdp.public.cdn.office.net/fluid/prod",Preview:"https://res-sdp.public.cdn.office.net/fluid/prod",Production:"https://res-sdp.public.cdn.office.net/fluid/prod",Staging:"https://res-sdp.sdf.cdn.office.net/fluid/stg",SyntheticTraffic:"https://res-sdp.public.cdn.office.net/fluid/prod",USNat:"",USSec:"",Gallatin:""};function Pn(e){return En[e]}var Nn=s(9885),In=s(2777),On=s(3788);const An={maxRetries:3,filter:(0,Nn.sC)([429,503,709,710]),backoffFn:(0,In.Ed)(500)};function Ln(e,t){return t?(0,On.R)(e,{method:"GET"},t.eventName,t.logger,t.doNotLogOnSuccess,An,t.timeoutMs??0,t.getAdditionalProps):(0,Nn.J5)(e,{method:"GET"},An)}const Fn="workspaceComponentManifest.json",Dn=rt.localOrigins;async function xn(e,t){let n,r;if("Local"===e){try{n=await Promise.any(Dn.map((e=>async function(e){const t=await fetch(`${e}/${Fn}`);if(!t.ok)throw new Error(`Failed to fetch local manifest from ${e}.`);return t}(e))))}catch(e){throw new Error(`Failed to fetch local ${Fn} at any of the attempted ports. Did you remember to start the loop app locally?`)}r=new URL("./",n.url).href}else{const o=Pn(e);if(!o)throw new Error(`No CDN endpoint found for the audience: ${e}.`);r=function(e,t){if(t)return`${e}/loop-app/versionless/deployment/${t}`;return`${e}/loop-app/versionless`}(o,t),n=(await Ln(`${r}/${Fn}`)).result}if(!n.ok)throw new Error(`Failed to fetch manifest from ${r}.`);return{...await n.json(),baseUrl:r}}function Rn(e){return{bootResources:e.bootResources,globals:e.globals,importMap:e.importMap,version:e.version??e.globals?.__app_environment_script_version__??"",baseUrl:e.baseUrl}}function Mn(e){return""}function _n(e){return e.bootResources}function Un(e,t,n){const r=e.document,o=r.createDocumentFragment();t.forEach((e=>{const t=r.createElement("link");t.rel="prefetch",t.href=e,e.endsWith(".js")?(t.as="script",t.crossOrigin="anonymous",o.appendChild(t)):e.endsWith(".css")?(t.as="style",o.appendChild(t)):n&&(0,Ut.hO)(n,{eventName:"FluidXPrefetchAssetFailed",message:`Unsupported asset type for prefetching: ${e}`})})),r.head.appendChild(o)}function jn(e,t,n,r){const o=t.preload?.manifest?.assets;if(o){const i=t.preload?.jsBaseUrl,s=c(n),a=t.preload?.manifest?.localizedAssets?.[s]??[];Un(e,[...o,...a].map((e=>new URL(e,i).href)),r)}}function zn(e){const t=function(e){let t,n;try{n=e.localStorage.getItem("lwcRing")}catch{return}switch(n?.toLowerCase()){case"local":t="Local";break;case"stg":t="Staging";break;case"df":t="Dogfood";break;case"prod":t="Production"}return t}(e),n=function(e){return e.localStorage.getItem("lwcScriptVersion")}(e);return{audienceOverride:t,scriptVersionOverride:n}}class qn{canLoad(e){return e.packageName===gt}getCodeDetailsFromNetworkAndUpdateCache(e,t){return jt(this.windowContext,gt,sn(e),(()=>xn(e,this.scriptVersionOverride)),jn,Rn,Mn,this.localeHint,t)}loadStylesheet(e){return new Promise(((t,n)=>{const r=this.windowContext.document,o=r.createElement("link");return o.rel="stylesheet",o.type="text/css",o.href=e,o.onload=()=>{t()},o.onerror=()=>n(new Error(`Failed to download the style sheet at url: ${e}.`)),r.head.appendChild(o),o}))}async loadImportMap(e){const t=this.windowContext.document.createElement("script");t.type="importmap",t.textContent=e,this.windowContext.document.head.appendChild(t)}async loadScript(e,t){const n=await this.providers.LoopTrustedTypesPolicy;t?await new Promise(((t,r)=>{const o=this.windowContext.document.createElement("script"),i=n?.createScriptURL(e,{allowedScriptOrigins:[window.origin]})??e;o.src=i,o.async=!1,o.type="module",o.onload=t,o.onerror=()=>r(new Error(`Failed to download the script at url: ${e}`)),this.windowContext.document.head.appendChild(o)})):await rn(this.windowContext,e,{trustedTypesPolicy:n,allowedOrigins:[window.origin]})}async load(e){if(!this.canLoad(e))throw new Error("Incompatible loop code details.");try{return await this.loadInternal(this.audienceToUse,e)}catch(t){if("Local"===this.audienceToUse&&this.audienceToUse!==this.hostRequestedAudience)return this.audienceToUse=this.hostRequestedAudience,await this.loadInternal(this.hostRequestedAudience,e);throw t}}async loadInternal(e,t){if("Automation"===e){const e=await s.e(634).then(s.bind(s,2176));this.windowContext[gt]={loopExport:e.loopExport}}else{const t=sn(e),n=((e,t,n)=>{if(t?.getSetting("bohemiaCodeLoader.environmentSpecificCDNs",!0)??1){let t;switch(e){case"DoD":t=dn;break;case"GccHigh":t=un;break;case"USNat":t=hn;break;case"USSec":t=fn;break;case"Gallatin":t=pn;break;default:t=ln}return n&&((0,Ut.Ot)(n,{eventName:"DefaultAllowedCodeOrigins",environment:e}),0===t.length&&(0,Ut.hO)(n,{eventName:"DefaultAllowedCodeOriginsEmptyEnvironment"},"{message: ${deploymentRing} environment does not have any default code origins}")),t}return gn})(t),r=await this.providers.NamespaceLogger;let o;const i="Local"===e?[...n,...Dn]:n;if(this.scriptVersionOverride){const n=(await Wt(gt,t,i,_n,r)).codeDetailsPackage;o=n&&n.version===this.scriptVersionOverride?n:await this.getCodeDetailsFromNetworkAndUpdateCache(e,r).codePackagePromise}else o=await nn(gt,t,i,(async()=>this.getCodeDetailsFromNetworkAndUpdateCache(e,r).codePackagePromise),_n,r);const{baseUrl:s,...a}=o;if(a.importMap&&await this.loadImportMap(JSON.stringify(a.importMap)),!Array.isArray(a.bootResources)||0===a.bootResources.length)throw new Error("No boot resources found in manifest.");"object"==typeof a.globals&&null!==a.globals&&Object.entries(a.globals).forEach((([e,t])=>{this.windowContext[e]=t})),await Promise.all(a.bootResources.map((async e=>{const t=new URL(e,s);if(t.pathname.endsWith(".css"))await this.loadStylesheet(t.href);else if(t.pathname.endsWith(".js"))await this.loadScript(t.href,!!a.importMap);else{const e=await this.providers.NamespaceLogger;e?.send({eventName:"UnsupportedFilesinManifest",category:"error"})}})))}const n=this.windowContext[gt];if(!n)throw new Error("Could not fetch loop module from the window object.");return{module:n,details:t}}async preCache(e){if(e!==gt)return;const t=await this.providers.NamespaceLogger;return await this.getCodeDetailsFromNetworkAndUpdateCache(this.audienceToUse,t).cacheUpdatePromise}constructor(e){const{localeHint:t,audience:n,windowContext:r,dependencySynthesizer:o}=e;this.windowContext=r,this.hostRequestedAudience=n;const{audienceOverride:i,scriptVersionOverride:s}=zn(r);this.audienceToUse=s?"Staging":i??n,this.scriptVersionOverride=s,this.localeHint=t,this.providers=o?.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",NamespaceLogger:"NamespaceLogger"},void 0)??{}}}const Bn={instantiateLoopCodeLoader:e=>Promise.resolve(new qn(e))};class $n{canLoad(e){return this.config.codeLoaders.has(e.packageName)}async load(e){const t=e.packageName,n=this.codeLoadersCache.get(t);if(n)return n.load(e);if(!this.canLoad(e))throw new Error("Codeloader does not know how to load from this source");return(await this.createLoader({packageName:t})).load(e)}async createLoader(e){const t=e.packageName,{codeLoaders:n,...r}=this.config,o=n.get(t);if(!o)throw new Error(`Could not get code loader factory for registrationId: ${t}`);const i=await o.then(),s=await i.instantiateLoopCodeLoader(r);if(!s.canLoad(e))throw new Error("Could not create loader Codeloader");return this.codeLoadersCache.set(t,s),s}async preCache(e){const t=this.codeLoadersCache.get(e);if(t)return void await(t.preCache?.(e));const n=await this.createLoader({packageName:e});await(n.preCache?.(e))}constructor(e){this.config=e,this.codeLoadersCache=new Map}}class Hn{async dispose(){delete this.factory}get Disposable(){return this}get LoopCodeLoaderFactoryProvider(){return this}constructor(e){this.getLoopCodeLoaderFactory=async()=>{if(!this.factory)throw new Error("Loop Code Loader Bundle is already disposed");return this.factory},this.factory=new Je.I((async()=>({instantiateLoopCodeLoader:async t=>new $n({...t,codeLoaders:e})})))}}const Wn=e=>({get CopilotConfigurationContext(){return this},get Disposable(){return this},dispose(){},scenarioName:e?"officeweb":"OneNoteCopilotNotebook",sourceName:e?"officeweb":"OneNoteCopilotNotebook",bizChatFeedbackClientName:"NotebooksOneNoteWin32"});function Vn(e){switch(e){case"ar-sa":case"fa-ir":case"he-il":case"ug-cn":case"ur-pk":return"rtl";default:return"ltr"}}function Gn(e){const t=function(e){return Vn(e)}(e);return{get InternationalizationContext(){return this},uiLocale:e,defaultContentDirection:t,get Disposable(){return this},dispose(){}}}var Qn=s(4225),Jn=s(7639);const Kn={maxRetries:3,filter:(0,Nn.sC)([429,500,503]),backoffFn:(0,In.Ed)(500)},Xn=/.+\S\([^\(\)]+\)$/;function Yn(e){const t=Jn.f.get(e);if(null!=t)return tr(t)}function Zn(e){const t=(0,Qn.Ar)()?.getItem(e);if(null!=t)return tr(t)}function er(e){return 2===(e.cacheVersion||0)&&void 0!==e.expires&&e.expires.valueOf()>Date.now()}function tr(e){if(null!=e){let t;try{t=JSON.parse(e)}catch(e){}const n=void 0!==t?t:e;return"on"===n||"off"===n?"on"===n:n}}class nr{get settingsFetchedFromEcs(){return this._settingsFetchedFromEcs}async fetch(){if(this.ecsClientConfiguration.alwaysFetchNewSettings||void 0===this.ecsResponseFromCache||!er(this.ecsResponseFromCache)||this.ecsResponseFromCache.sessionId!==this.ecsClientConfiguration.sessionId){const e=function(e){const t=new URLSearchParams;if(t.append("agents",e.teamNames.join(",")),e.guestAgents){const n={};for(let t=0;t<e.guestAgents.length;t+=1){const r=e.guestAgents[t].substring(e.guestAgents[t].indexOf("(")+1,e.guestAgents[t].indexOf(")")),o=e.guestAgents[t].substring(0,e.guestAgents[t].indexOf("("));n[r]=n[r]?`${n[r]},${o}`:o}Object.entries(n).forEach((([e,n])=>{t.append("guestAgents",`${n}(${e})`)}))}Object.entries(e.filters).forEach((([e,n])=>{void 0!==n&&t.append(e,n)}));const n=t.toString();return`${e.host}/config/v1/${e.clientName}/${e.clientVersion}${""!==n?`?${n}`:""}`}(this.ecsClientConfiguration);return this.ecsResponsePromise||(this.ecsResponsePromise=this.fetchAndParse(e),this.ecsResponsePromise.then((e=>{e&&this.cacheEcsResponse(e),this._settingsFetchedFromEcs=!0})).catch((()=>{}))),this.ecsResponsePromise}}getSettingKey(e,t){return`${e}_${t}`}getSetting(e,t,n){return this.maybeLogLoadedEcsResponseFromCache(),this.getSettingInternal(e,t,n)}maybeLogLoadedEcsResponseFromCache(){!this._loadedEcsReponseEventSent&&this.ecsResponseFromCache&&(this.logger&&(0,Ut.Ot)(this.logger,{eventName:"loadedEcsResponseFromCache",settings:JSON.stringify(this.ecsResponseFromCache.ecsTeamsSettings),eTag:this.ecsResponseFromCache.eTag,configIds:JSON.stringify(this.ecsResponseFromCache.configIDs)}),this._loadedEcsReponseEventSent=!0)}logSettingsMetadata(){0!==nr.settingMetadataToBeLogged.length&&(this.logger&&(0,Ut.Ot)(this.logger,{eventName:"ECSSettingMetadatas",settings:JSON.stringify(nr.settingMetadataToBeLogged)}),nr.settingMetadataToBeLogged=[])}async getLiveSetting(e,t,n){return this.maybeLogLoadedEcsResponseFromCache(),this.getLiveSettingInternal(e,t,n)}getSettingInternal(e,t,n){let r;const o=this.getSettingKey(e,n);if(void 0!==(r=this.previouslyAccessedEcsSettings.get(o)))return r;let i="";return void 0!==(r=Yn(e))?i="QueryParam":void 0!==(r=Zn(e))?i="LocalStorage":void 0!==(r=this.getSettingFromCachedEcsResponse(e,n))?i="CachedEcsResponse":(i="DefaultValue",r=t),this.previouslyAccessedEcsSettings.set(o,r),this.ecsClientConfiguration.enableLogSettingsWithSource&&!nr.previouslyLoggedSettingMetadata.has(e)&&(nr.previouslyLoggedSettingMetadata.add(e),nr.settingMetadataToBeLogged.push({settingName:e,settingValue:r?.toString()??"",settingSource:i})),r}async getLiveSettingInternal(e,t,n){let r;const o=this.getSettingKey(e,n);if(void 0!==(r=this.previouslyAccessedEcsSettings.get(o)))return r;if(void 0!==(r=Yn(e))||(r=Zn(e)),void 0!==r)return this.previouslyAccessedEcsSettings.set(o,r),r;const i=this._settingsFetchedFromEcs?this.getAllCachedEcsResponses()?.[this.ecsClientConfiguration.cacheKey]:await this.fetch();return void 0!==(r=i?.ecsTeamsSettings[n]?.[e])||(r=t),this.previouslyAccessedEcsSettings.set(o,r),r}getSettingFromCachedEcsResponse(e,t){return this.ecsResponseFromCache?.ecsTeamsSettings[t]?.[e]}async fetchAndParse(e){const t=Vt.m.start("EcsFetch",this.logger,{addUserTiming:!0});let n;try{n=await(0,Nn.J5)(e,void 0,Kn)}catch(e){return void t.setResult(!1,void 0,e)}if(200!==n.result.status){const e=new Error("Failed to Fetch from ECS. Response is not 200");return void t.setResult(!1,{status:n.result.status,statusText:n.result.statusText},e)}const r=this.parseResponseToEcsResponse(n);return r.then((n=>{let r;performance.getEntriesByName(e).map((e=>{e.name.includes(this.ecsClientConfiguration.host)&&(r=e.duration)})),t.setResult(!0,{eTag:n.eTag,networkDurationMs:r,configIds:JSON.stringify(n.configIDs)})})).catch((e=>{t.setResult(!1,void 0,e)})),r}async parseResponseToEcsResponse(e){const t=await e.result.json(),n=[...this.ecsClientConfiguration.teamNames],r={};this.ecsClientConfiguration.guestAgents?.forEach((e=>{if(Xn.test(e)){const t=e.substring(0,e.indexOf("("));n.push(t)}else this.logger&&(0,Ut.hO)(this.logger,{eventName:"ecsTeamFormat"},new Error(`${e} doesn't match the format <EcsTeam>(<EcsClient>)`))}));for(let e=0;e<n.length;e+=1)t[n[e]]&&(r[n[e]]=t[n[e]]);const o=e.result.headers.get("ETag")||"",i=t.ConfigIDs||{};let s;if(this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin)s=new Date(Date.now()+6e4*this.ecsClientConfiguration.cacheExpiresDurationOverrideInMin);else{const t=e.result.headers.get("Expires");s=t?new Date(t):void 0}return{ecsTeamsSettings:r,eTag:o,configIDs:i,expires:s,cacheVersion:2,sessionId:this.ecsClientConfiguration.sessionId}}cacheEcsResponse(e){const t=(0,Qn.Ar)();if(t)try{const n=this.getAllCachedEcsResponses()||{};n[this.ecsClientConfiguration.cacheKey]=e,t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(n))}catch(e){this.logger&&(0,Ut.hO)(this.logger,{eventName:"cacheEcsResponse"},e)}}getAllCachedEcsResponses(){try{const e=(0,Qn.Ar)(),t=e?.getItem(this.ecsClientConfiguration.responsesCacheKey),n=t&&JSON.parse(t);if(!n||0===Object.keys(n).length)return;return Object.entries(n).forEach((([e,t])=>{"string"==typeof t.expires&&(t.expires=new Date(t.expires))})),n}catch(e){this.logger&&(0,Ut.hO)(this.logger,{eventName:"getAllCachedEcsResponses"},e)}}loadAndClearCache(){const e=this.getAllCachedEcsResponses();if(e){const t=e[this.ecsClientConfiguration.cacheKey];t&&(this.ecsResponseFromCache=t),this.clearExpiredEcsResponsesFromCache(e)}}clearExpiredEcsResponsesFromCache(e){try{const t=(0,Qn.Ar)();if(!t)return;const n={};Object.entries(e).forEach((([e,t])=>{(er(t)||e===this.ecsClientConfiguration.cacheKey)&&(n[e]=t)})),t.setItem(this.ecsClientConfiguration.responsesCacheKey,JSON.stringify(n))}catch(e){this.logger&&(0,Ut.hO)(this.logger,{eventName:"clearExpiredEcsResponsesFromCache"},e)}}constructor(e,t){this.ecsClientConfiguration=e,this.previouslyAccessedEcsSettings=new Map,this._settingsFetchedFromEcs=!1,this._loadedEcsReponseEventSent=!1,this.logger=t&&new Ke.p("EcsClient",t),this.loadAndClearCache(),this.ecsClientConfiguration.enableLogSettingsWithSource&&setInterval((()=>{this.logSettingsMetadata()}),nr.settingsMetadataLoggingInterval)}}function rr(e){return(0,ce.F)("ecs",e)}nr.previouslyLoggedSettingMetadata=new Set,nr.settingMetadataToBeLogged=[],nr.settingsMetadataLoggingInterval=1e4;function or(e){return"teamNames"in e}class ir{get SettingsProvider(){return this}get settingsFetchedFromEcs(){return this.ecsClient.settingsFetchedFromEcs}get Disposable(){return this}dispose(){}async fetchSettings(){await this.ecsClient.fetch()}getSetting(e,t,n){return this.ecsClient.getSetting(e,t,n)}async getLiveSetting(e,t,n){return this.ecsClient.getLiveSetting(e,t,n)}constructor(e,t){this.ecsClient=or(e)?new nr(e,t):new nr(function(e){const{ecsFilters:t,hostName:n,sessionId:r,responsesCacheKeyOverride:o,cacheExpiresDurationOverrideInMin:i,fetchFluidExperiencesSettings:s=!0,fetchHostExperiencesSettings:a=!0,fetchSegmentationSettings:c=!0,alwaysFetchNewSettings:l,enableLogSettingsWithSource:u=!1}=e,{userContext:d,audience:p}=t,h=d.user?.id,f=d.user?.tenantId,g={audience:p,userId:h,tenantId:f,hostName:n},m=`${h}${n}${p}`,v=o||"FluidEcsClientResponses",y=[];return s&&y.push("FluidExperiences"),a&&y.push("HostExperiences"),c&&y.push("Segmentation"),{host:rr(p),clientName:"Fluid",clientVersion:"0.0.0.1",teamNames:y,filters:g,cacheKey:m,responsesCacheKey:v,cacheExpiresDurationOverrideInMin:i,sessionId:r,alwaysFetchNewSettings:l,enableLogSettingsWithSource:u}}(e),t),this.audience=or(e)?e.filters.audience:e.ecsFilters.audience,this.fetchSettings().catch((()=>{}))}}var sr=s(9307);class ar extends ir{constructor(){super(...arguments),this.injectedSettings=new Map}getSetting(e,t,n){return this.injectedSettings.has(e)?this.injectedSettings.get(e):super.getSetting(e,t,n)}setSetting(e,t){this.injectedSettings.set(e,t)}}class cr{constructor(){this.Disposable=this}dispose(){}get TelemetryConfig(){return this}get disallowServiceTelemetry(){return!1}get hostCorrelationId(){return te.getCorrelationId()}get hostSessionId(){return te.getSessionId()}}var lr=s(9307);class ur extends(u()){constructor(){super(),this.setThemeName(),this.registerThemeChangeHandler()}get Theming(){return this}get Disposable(){return this}setThemeName(e){const t=window.matchMedia("(forced-colors: active)").matches;if(lr.log("Theme changed: isHighContrast",t),t)return void(this.themeName="high-contrast");const n=(e?e.officeTheme:Office.context.officeTheme).isDarkTheme;this.themeName=n?"dark":"default"}themeChangeHandler(e){lr.log("Theme changed: ",e),this.setThemeName(e),this.emit("themeNameChanged")}registerThemeChangeHandler(){Office.context.application.addHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeHandler.bind(this))}unRegisterThemeChangeHandler(){Office.context.application.removeHandlerAsync(Office.EventType.OfficeThemeChanged,this.themeChangeHandler)}dispose(){this.unRegisterThemeChangeHandler()}}var dr=s(9307);class pr extends M{get LoopTelemetrySink(){return this}get Disposable(){return this}dispose(){dr.log("Disposing Telemetry Sink")}}class hr{getDependencySynthesizer(){return this.dependencySynthesizer||(this.dependencySynthesizer=new nt),this.dependencySynthesizer}registerProviders(e,t,n,r){const o=x("useOfficeWebScenario",!1),i=this.getDependencySynthesizer();return i.register("CopilotConfigurationContext",Wn(o)),i.register("InternationalizationContext",Gn(n)),i.register("LoopCodeLoaderFactoryProvider",new Hn(new Map([[gt,Promise.resolve(Bn)]]))),i.register("LoopTelemetrySink",new pr),i.register("NamespaceLogger",t),i.register("SettingsProvider",function(e,t){const n=new ar({ecsFilters:{audience:e.audience,userContext:t},hostName:"Office"});n.setSetting("loopApp.isNotebooksExperienceEnabled",!0),n.setSetting("loopApp.isOneNoteNavbarEnabled",!0),n.setSetting("loopApp.isResetOnNavigationEnabled",!0),n.setSetting("loopApp.isNotebooksPodcastEnabled",!0),n.setSetting("loopApp.shouldCheckBizPolicyForNotebookCreation",!0);const r=x("useL2NavRefresh",!1);return n.setSetting("loopApp.isL2NavRefreshEnabled",r),sr.log("Loop settings injected:",n),n}(r,e.getUserContext())),i.register("Theming",new ur),i.register("TokenProvider",e),i.register("UserContext",e.getUserContext()),i.register("BizChatTokenProvider",e.bizChatAuthService),i.register("TelemetryConfig",new cr),i}unregisterProviders(){this.dependencySynthesizer&&(this.dependencySynthesizer.unregister("CopilotConfigurationContext"),this.dependencySynthesizer.unregister("InternationalizationContext"),this.dependencySynthesizer.unregister("LoopCodeLoaderFactoryProvider"),this.dependencySynthesizer.unregister("LoopTelemetrySink"),this.dependencySynthesizer.unregister("NamespaceLogger"),this.dependencySynthesizer.unregister("SettingsProvider"),this.dependencySynthesizer.unregister("Theming"),this.dependencySynthesizer.unregister("TokenProvider"),this.dependencySynthesizer.unregister("UserContext"),this.dependencySynthesizer.unregister("BizChatTokenProvider"),this.dependencySynthesizer.unregister("TelemetryConfig"),this.dependencySynthesizer=void 0)}}const fr="0",gr="",mr=!1;function vr(e,t){var n;const r=null!==(n=e.lastOpened)&&void 0!==n?n:"",o=Date.parse(r);return{title:e.title,podId:e.mfsPodId,spoId:e.spoId,isFavorite:e.isFavorite,lastOpened:Number.isNaN(o)?0:o,forceSetAsSelected:t}}var yr=s(9307);const br="navigateTo";class wr extends l.EventEmitter{constructor(){super(...arguments),this.workspaceMap=new Map,this.forceSelectNextAdd=!1}async Reset(){return this.workspaceMap.clear(),Promise.resolve()}async NavigateTo(e){var t;this.emit(br),yr.log("Requesting component navigation:",e);const n=Date.now();await(null===(t=this.workspaceNavigationHandler)||void 0===t?void 0:t.navigateTo(e).then((()=>{const t=Date.now()-n;_.Instance.logEvent("NavigateTo",{NavRoute:e.route,Duration:t})})).catch((e=>{const t=Date.now()-n;throw yr.error("navigateTo API failed:",e),_.Instance.logError("WorkspaceManagerError",e,{ErrorMethod:"NavigateTo",ErrorDetails:"navigateTo API failed",Duration:t}),e})))}async ProcessWorkspaces(){try{if(!this.workspaceAndPageManager)throw new Error("Workspace Manager instance of component manager not set");const e=Date.now(),t=await this.workspaceAndPageManager.getWorkspaces(),n=[];this.workspaceMap.clear(),t.forEach((e=>{void 0!==e.mfsPodId&&void 0!==e.spoId&&(n.push(e),this.workspaceMap.set(e.mfsPodId,e))}));const r=Date.now()-e;yr.log(`GetWorkspaces returned ${n.length} viable workspaces out of ${t.length} total workspaces in ${r}ms.`),_.Instance.logEvent("GetWorkspaces",{TotalWorkspaceCount:t.length,ViableWorkspaceCount:n.length,Duration:r});const o={workspaces:n.map((e=>vr(e,!1)))};$.setWorkspaces(o).catch((e=>{throw yr.error(e),_.Instance.logError("DataActionError",e,{ErrorMethod:"ProcessWorkspaces",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:"setWorkspaces"}),e}))}catch(e){return _.Instance.logError("WorkspaceManagerError",e,{ErrorMethod:"ProcessWorkspaces",ErrorDetails:"Error processing workspaces"}),yr.error(e),Promise.reject("Error processing workspaces")}}async GetWorkspaceForPage(e){const t=Date.now();try{if(!this.workspaceAndPageManager)throw new Error("Workspace Manager instance of component manager not set");const n=await this.workspaceAndPageManager.getWorkspaceForPage(e),r=Date.now()-t;return yr.log(`GetWorkspaceForPage returned in ${r}ms:`,n),_.Instance.logEvent("GetWorkspaceForPage",{FoundWorkspace:void 0!==n,Duration:r}),n}catch(e){const n=Date.now()-t;return yr.error(e),_.Instance.logError("WorkspaceManagerError",e,{ErrorMethod:"GetWorkspaceForPage",ErrorDetails:"Error getting workspace for page",Duration:n}),Promise.reject("Error getting workspace for page")}}SetWorkspaceAndPageManager(e){this.workspaceAndPageManager=e}SetWorkspaceNavigationHandler(e){this.workspaceNavigationHandler=e}async onWorkspaceListChangedEvent(e){yr.log("Workspace List Changed event:",e);try{let t=e.workspace;if(yr.log("Workspace List Changed event workspace:",t),void 0===t&&(yr.warn("Workspace List Changed event has undefined workspace; converting raw event"),t=e,yr.log("Workspace List Changed event as workspace:",t)),void 0===t)throw new Error(`Undefined workspace for workspaceListChanged event type: ${e.type}`);const n=this.forceSelectNextAdd;switch(e.type){case"add":if(this.forceSelectNextAdd=!1,void 0===t.mfsPodId)throw new Error(`Malformed workspace podId for event type: ${e.type}`);if(void 0===t.spoId)throw new Error(`Malformed workspace spoId for event type: ${e.type}`);this.workspaceMap.set(t.mfsPodId,t),$.updateWorkspace(vr(t,n)).catch((t=>{throw yr.error(t),_.Instance.logError("DataActionError",t,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:e.type}),t}));break;case"update":if(void 0===t.mfsPodId)throw new Error(`Malformed workspace podId for event type: ${e.type}`);if(void 0===t.spoId)throw new Error(`Malformed workspace spoId for event type: ${e.type}`);this.workspaceMap.set(t.mfsPodId,t),$.updateWorkspace(vr(t,!1)).catch((t=>{throw yr.error(t),_.Instance.logError("DataActionError",t,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:e.type}),t})),$.renameWorkspace(vr(t,!1)).catch((e=>{throw yr.error(e),_.Instance.logError("DataActionError",e,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:"rename"}),e}));break;case"remove":if(void 0===t.mfsPodId)throw new Error(`Malformed workspace podId for event type: ${e.type}`);this.workspaceMap.delete(t.mfsPodId),$.removeWorkspace(vr(t,!1)).catch((t=>{throw yr.error(t),_.Instance.logError("DataActionError",t,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:"Failed to notify client of data action event",ErrorEvent:e.type}),t}));break;default:throw new Error(`Unhandled workspaceListChanged event type: ${e.type}`)}}catch(t){return _.Instance.logError("ComponentDataWorkspaceListChangedEventError",t,{ErrorMethod:"onWorkspaceListChangedEvent",ErrorDetails:`Error handling workspaceListChanged event type: ${e.type}`}),yr.error(t,e),Promise.reject("Error handling workspaceListChanged event")}}async onComponentNavigationEvent(e){yr.log("Component navigation event:",e),this.forceSelectNextAdd&&(yr.log("Canceling next add notification for client UI selection due to navigation event"),this.forceSelectNextAdd=!1);try{if("notebooks"===e.route)B.navigateToHomeEvent().catch((t=>{yr.error(t,e),_.Instance.logError("NotifyClientError",t,{ErrorMethod:"onComponentNavigationEvent",ErrorDetails:"Failed to notify client of navigation event",NavigationRoute:e.route})}));else if("notebook"===e.route){if("createId"in e)return yr.log("Marking next add notification for client UI selection"),void(this.forceSelectNextAdd=!0);B.navigateToNotebookEvent(function(e){var t;return{podId:e.mfsPodId,spoId:null!==(t=e.spoId)&&void 0!==t?t:gr}}(e)).catch((t=>{yr.error(t,e),_.Instance.logError("NotifyClientError",t,{ErrorMethod:"onComponentNavigationEvent",ErrorDetails:"Failed to notify client of navigation event",NavigationRoute:e.route})}))}else{if("page"!==e.route)throw new Error(`Unhandled component navigation event: ${e.route}`);B.navigateToPageEvent(function(e,t){var n,r;return{title:null!=t?t:"",docUrl:e.docUrl,podId:null!==(n=e.mfsPodId)&&void 0!==n?n:gr,requiresRedeem:null!==(r=e.requiresRedeem)&&void 0!==r&&r}}(e)).catch((t=>{yr.error(t,e),_.Instance.logError("NotifyClientError",t,{ErrorMethod:"onComponentNavigationEvent",ErrorDetails:"Failed to notify client of navigation event",NavigationRoute:e.route})}))}}catch(t){return _.Instance.logError("ComponentNavigationEventError",t,{ErrorMethod:"onComponentNavigationEvent",ErrorDetails:`Error handling navigation event for route: ${e.route}`}),yr.error(t,e),Promise.reject("Error handling navigation event")}}}var Sr=s(9307);class Cr{constructor(e,t){this.authService=e,this.dependencySynthesizerService=t,this.workspaceManager=new wr,this.workspaceManager.on(br,(()=>{var e;null===(e=this.onNavigationEvent)||void 0===e||e.call(this)}))}getWorkspaceManager(){return this.workspaceManager}setWorkspaceAndPageManager(e){this.workspaceManager.SetWorkspaceAndPageManager(e)}setWorkspaceNavigationHandler(e){this.workspaceManager.SetWorkspaceNavigationHandler(e)}setOnNavigationEvent(e){this.onNavigationEvent=e}async appInitialize(){await this.authService.initializePreAuthz()}async appLoadDataModels(){await this.workspaceManager.ProcessWorkspaces()}async appOnIdentityChange(){await this.appInitialize()}async appNavigateToHome(){await this.workspaceManager.NavigateTo({route:"notebooks"})}async appNavigateToNotebook(e){const t=e.podId,n=e.spoId;if(t===gr||t===fr)return void await this.appNavigateToHome();const r={route:"notebook",mfsPodId:t,spoId:n!==gr&&n!==fr?n:void 0};await this.workspaceManager.NavigateTo(r)}async appNavigateToPage(e){var t;const n=null!==(t=e.podId)&&void 0!==t?t:gr;if(n===gr||n===fr)return void await this.appNavigateToHome();if(x("useNavToPage",mr)){const t=e.docUrl,r=e.requiresRedeem;if(""===t||"0"===t)return void await this.appNavigateToNotebook({podId:n});const o={route:"page",mfsPodId:n,requiresRedeem:r,docUrl:t};await this.workspaceManager.NavigateTo(o)}else await this.appNavigateToNotebook({podId:n})}async appNavigateToSearchResult(e){var t,n,r,o;let i="",s="";try{const{siteUrl:a}=e,c=/\/drives\/(?<Drive>[^/]+)\/items\/(?<Item>[^/]+)/.exec(a);if(null!==c&&(i=null!==(n=null===(t=c.groups)||void 0===t?void 0:t.Drive)&&void 0!==n?n:"",s=null!==(o=null===(r=c.groups)||void 0===r?void 0:r.Item)&&void 0!==o?o:""),""===i||""===s)throw new Error("Search result missing required ODSP locator parameters");const l={siteUrl:a,driveId:i,fileId:s};_.Instance.logEvent("NavigateToSearchResult",{HasDrive:""!==i,HasItem:""!==s});const u={siteUrl:a,driveId:i,itemId:s,dataStorePath:"/"},d=new URL(a);(0,ct.Cu)(d,u),await this.navigateToPageOdspLink(d,u,l),B.navigateToSearchResultStatus({...e,navSuccess:!0}).catch((t=>{Sr.error(t,e),_.Instance.logError("NotifyClientError",t,{ErrorMethod:"navigateToSearchResultStatus",ErrorDetails:"Failed to notify client of status",HasDrive:""!==i,HasItem:""!==s,NavigationSuccess:!0})}))}catch(t){return Sr.error(t,e),_.Instance.logError("NavigateToSearchResultError",t,{ErrorMethod:"appNavigateToSearchResult",ErrorDetails:"Failed to navigate to search result",HasDrive:""!==i,HasItem:""!==s}),B.navigateToSearchResultStatus({...e,navSuccess:!1}).catch((t=>{Sr.error(t,e),_.Instance.logError("NotifyClientError",t,{ErrorMethod:"navigateToSearchResultStatus",ErrorDetails:"Failed to notify client of status",HasDrive:""!==i,HasItem:""!==s,NavigationSuccess:!1}),B.failedToNavigateToSearchResult({...e,navSuccess:!1}).catch((t=>{Sr.error(t,e),_.Instance.logError("NotifyClientError",t,{ErrorMethod:"failedToNavigateToSearchResult",ErrorDetails:"Failed to notify client of status",HasDrive:""!==i,HasItem:""!==s,NavigationSuccess:!1})}))})),Promise.reject("Failed to navigate to search result")}}async appNavigateToLink(e){var t,n;const{linkUrl:r}=e;let o=!1,i=!1,s="";try{const a=new URL(r);o=!0,i=null!==a.searchParams.get(ct.jC);const c=/(?<FluidHint>\/:fl:\/[a-z]{1,2}\/)/.exec(r);null!==c&&(s=null!==(n=null===(t=c.groups)||void 0===t?void 0:t.FluidHint)&&void 0!==n?n:""),_.Instance.logEvent("NavigateToLink",{IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i}),Sr.log("Attempting to extract ODSP file locator from link url:",a);const l=(0,ct.Mh)(a,!1);if(!l)throw new Error("Failed to extract ODSP file locator from link url");Sr.log("Extracted ODSP file locator:",l);const u={siteUrl:r,driveId:l.driveId,fileId:l.itemId};await this.navigateToPageOdspLink(a,l,u),B.navigateToLinkStatus({originalUrl:r,navSuccess:!0}).catch((t=>{Sr.error(t,e),_.Instance.logError("NotifyClientError",t,{ErrorMethod:"navigateToLinkStatus",ErrorDetails:"Failed to notify client of status",IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i,NavigationSuccess:!0})}))}catch(t){return Sr.error(t,e),_.Instance.logError("NavigateToLinkError",t,{ErrorMethod:"appNavigateToLink",ErrorDetails:"Failed to navigate to link",IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i}),B.navigateToLinkStatus({originalUrl:r,navSuccess:!1}).catch((t=>{Sr.error(t,e),_.Instance.logError("NotifyClientError",t,{ErrorMethod:"navigateToLinkStatus",ErrorDetails:"Failed to notify client of status",IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i,NavigationSuccess:!1}),B.failedToNavigateToLink({originalUrl:r,navSuccess:!1}).catch((t=>{Sr.error(t,e),_.Instance.logError("NotifyClientError",t,{ErrorMethod:"failedToNavigateToLink",ErrorDetails:"Failed to notify client of status",IsValidUrlFormat:o,LinkType:s,HasOdspLocator:i,NavigationSuccess:!1})}))})),Promise.reject("Failed to navigate to link")}}getDependencySynthesizerService(){return this.dependencySynthesizerService}async navigateToPageOdspLink(e,t,n){Sr.log("Calling GetWorkspaceForPage with:",n);const r=await this.workspaceManager.GetWorkspaceForPage(n);if(Sr.log("GetWorkspaceForPage returned:",r),!r)throw new Error("GetWorkspaceForPage returned undefined");(0,ct.Cu)(e,t),await this.appNavigateToPage({docUrl:e.href,podId:r.mfsPodId})}}function kr(e){let t;switch(e.route){case"notebook":t=function(e){const t=ft(e.mfsPodId);return new URL(`/w/home/${it({w:t})}`,dt)}(e);break;case"notebooks":t=pt;break;case"page":t=ht(e);break;case"pages":t=new URL("/pages",dt);break;case"createPage":return function(e){const{body:t,pageTitle:n}=e;return{type:"Data",registrationId:gt,dataType:"Json",data:{route:"createPage",body:t,pageTitle:n}}}(e);case"createPageFromTemplate":return function(e){const{templateId:t,contentDisplayFlag:n}=e;return{type:"Data",registrationId:gt,dataType:"Json",data:{route:"createPageFromTemplate",templateId:t,contentDisplayFlag:n}}}(e);case"createNotebook":return function(e){const{linkedChats:t,linkedPages:n}=e;return{type:"Data",registrationId:gt,dataType:"Json",data:{route:"createNotebook",linkedChats:t,linkedPages:n}}}(e)}return{type:"Data",registrationId:gt,dataType:"URL",data:{url:t}}}const Er="RenderComponent",Tr="PostRender",Pr={RenderComponent:"RenderComponentByHost"};class Nr{static startScenario(e,t,n,r){if(n){const o=Nr.startScenario(e,t);return(async()=>{try{const e=await n(o);return o.setSuccess(r?.()),e}catch(e){throw o.setFailure(e,r?.()),e}})()}let o;return new Nr(t+"EndToEnd",e,(()=>{o=Zt();try{const t=e.PersistedProperties?.getPersistedProperties?.().hostScenarioStartTime;if(t&&"number"==typeof t){const e=performance.now()-(Date.now()-t);e>=0&&performance.measure("PreScenarioOverhead",{start:e})}}catch{}}),(()=>{o&&(tn(o),o=void 0)}),(()=>({documentHidden:o?en(o,!0)>-1:""})))}static startActivity(e,t,n,r){if(n){const o=Nr.startActivity(e,t);return(async()=>{try{const e=await n();return o.setSuccess(r?.()),e}catch(e){throw o.setFailure(e,r?.()),e}})()}return new Nr(Pr[t]||t,e)}getLogger(){return this.logger}scenarioEndsAfterRender(){return"LoadEndToEnd"===this.activityType||"PasteEndToEnd"===this.activityType}setSuccess(e){this.activityTracker&&(this.activityTracker.setResult(!0,{...e,...this.getExtraPropsToLog?.()}),this.dispose())}setFailure(e,t){this.activityTracker&&(this.activityTracker.setResult(!1,{...t,...this.getExtraPropsToLog?.(),errorType:e?e.errorType:void 0},e),this.dispose())}cancel(){this.dispose()}dispose(){this.additionalCleanup?.(),this.logger&&(0,Ut.Ot)(this.logger,{eventName:this.activityType,subCategory:"HostActivityTrackerDisposed"}),this.activityTracker?.dispose(),this.activityTracker=void 0,this.logger=void 0}constructor(e,t,n,r,o){this.activityType=e,this.additionalCleanup=r,this.getExtraPropsToLog=o,n?.(),this.logger=new Ke.p("HostTracker",t),this.activityTracker=Vt.m.start(e,this.logger,{addUserTiming:!0,isAPerformanceMetric:!0}),(0,Ut.Ot)(this.logger,{eventName:e,subCategory:"HostActivityTrackerCreated"})}}const Ir="16.20.0",Or="LoadComponentInDiv",Ar="GetDriver",Lr="LoadContainer",Fr="LoadComponentFromContainer",Dr="RequestComponent",xr="GetTemplateContent",Rr="RehydrateFromTemplateContent",Mr="LoadCodeFromHint",_r="GetLoopComponentCore",Ur="ContainerPostBootError",jr="ContainerPackagePreCacheError",zr="GetTemplateContentError",qr="UndefinedTemplateContentError",Br="ComponentNotSerializableError",$r="ComponentSerializationError",Hr="LoadComponentCancelledByHost",Wr="CodeHintExists",Vr="OfficeWebHost",Gr="LoopExperiences";function Qr(e){const t=Date.now(),n=Zt(),{logger:r,...o}=e;return{logger:r&&new Ke.p(Vr,r,{owhVersion:Ir}),newConfig:o,perfMetadata:{fluidBootstrapperStartTime:t},documentHiddenTrackerId:n}}const Jr="fluid";function Kr(e){return e===Jr||"fluid-odsp"===e||"fluid-odsp-extended"===e||"fluid-odsp-expansive"===e}var Xr=s(7185),Yr=s(4066);function Zr(e){return"object"==typeof e&&null!==e&&e.errorType===Xr.a.locationRedirection}class eo extends Error{constructor(e,t,n,r){if(super(e),this.internalError=n,this.name=t,r)try{this.stack=r}catch{}}}class to extends eo{constructor(e,t,n,r){super(e,"ComponentNotFound",t,r),this.code=n}}function no(e){if("object"!=typeof(t=e)||null===t)return!1;var t;const n=e.errorType,r=e.statusCode;return"fileNotFoundOrAccessDeniedError"===n&&404===r}let ro;class oo{then(e,t){return this.p.then(e,t)}catch(e){return this.p.catch(e)}resolve(e){this.isPending=!1,this.res(e)}reject(e){this.isPending=!1,this.rej(e)}pending(){return this.isPending}finally(e){return this.p.finally(e)}constructor(){this[ro]="Deferred",this.isPending=!0,this.p=new Promise(((e,t)=>{this.res=e,this.rej=t}))}}ro=Symbol.toStringTag;var io=s(6276);const so=(e,t)=>{if(void 0!==e&&void 0!==t)return e-t};var ao=s(3192),co=s(7276);const lo="Open",uo="PostBoot",po="FileOpenFailed",ho="ComponentLoadError",fo="ContainerConnectedTimeout",go="ContainerLoadError";var mo=s(1680);const vo="Loading chunk\\s[a-zA-Z0-9_-]+\\sfailed";function yo(e,t,n,r,o,i,s){const a=new Ke.p("QoS",e);(0,Ut.hO)(a,{eventName:t,pillar:n,veto:r,errorType:o,isAce:!bo(s),...i},s)}function bo(e){if(!e)return!1;const t=e;return!(!t.errorType||![Xr.a.offlineError,Xr.a.fileNotFoundOrAccessDeniedError,Xr.a.authorizationError,mo.E.snapshotTooBig,mo.E.invalidFileNameError,Xr.a.fileOverwrittenInStorage,fo].some((e=>e===t.errorType)))||!(!t.message||!new RegExp(vo).test(t.message))}const wo=(e,t,n)=>{(0,co.t)(6e4,[n]).then((n=>{if(n&&!e.closed){const e=fo;yo(t,Ur,uo,"ContainerConnectFailed",e,{},{message:"Timed out while connecting the container",errorType:e}),(0,Ut.hO)(t,{eventName:Ur,errorType:e,isUserImpacting:!0},{message:"Timed out while connecting the container",errorType:e})}})).catch((()=>{}))},So=(e,t)=>{const n={},r=e.resolvedUrl;r&&"id"in r&&(n.docId=r.id),t.PersistedProperties?.addPersistedProperties(n)},Co=(e,t)=>{const n=new oo;e.attachState!==ao.d.Attached?e.once("attached",(()=>{So(e,t),wo(e,t,n)})):(So(e,t),wo(e,t,n)),e.once("closed",(n=>{n&&(yo(t,Ur,uo,"PostBootContainerClosed",n.errorType,{},n),(0,Ut.hO)(t,{eventName:Ur,errorType:n.errorType||Ur,isUserImpacting:!0,isExpected:no(n),isDirty:e.isDirty},n))})),e.once("connected",(()=>{n.resolve()}))};function ko(e){return e.replace(/(https:\/\/)(\w)+(.sharepoint.com|-my.sharepoint.com|.sharepoint-df.com)/,"(redacted)").replace(/(https:\/\/)(dev.loop.microsoft.com|df.loop.microsoft.com|loop.microsoft.com|preview.loop.microsoft.com|loop.cloud.microsoft|loop.cloud-dev.microsoft)(\/p\/)([a-zA-Z0-9%]+)/,"(redacted)")}class Eo{get Disposable(){return this}get NamespaceLogger(){return this}sendWithNamespace(e,t){this.runtimeLogger.sendWithNamespace(e,t)}send(e){let t=e;if("performance"===e.category){const n=e.duration,r=Date.now(),o="number"==typeof n?r-n:void 0;t={...this.perfMetadata,startTime:o,documentEverHidden:this.documentHiddenTrackerId&&en(this.documentHiddenTrackerId)>-1,...t}}void 0===t.opMessageAgeMs&&"number"==typeof t.messageTimestamp&&(t={opMessageAgeMs:Date.now()-t.messageTimestamp,...t}),t.message&&(t.message=ko(t.message.toString())),t.stack&&(t.stack=ko(t.stack.toString())),t.error&&(t.error=ko(t.error.toString())),t.errorMessage&&(t.errorMessage=ko(t.errorMessage.toString())),t.responseMessage&&(t.responseMessage=ko(t.responseMessage.toString())),this.runtimeLogger.send(t)}dispose(){this.runtimeLogger.Disposable.dispose()}constructor(e,t,n,r){this.perfMetadata=t,this.documentHiddenTrackerId=n,this.runtimeLogger=new Ke.p("FluidRuntime",e,r)}}function To(e){e.closed||e.attachState!==ao.d.Attached&&void 0!==e.attachState||e.connect()}var Po;!function(e){e[e.Disconnected=0]="Disconnected",e[e.EstablishingConnection=3]="EstablishingConnection",e[e.CatchingUp=1]="CatchingUp",e[e.Connected=2]="Connected"}(Po||(Po={}));var No=s(1800),Io=s(4905);const Oo=e=>"object"==typeof e&&"string"==typeof e?.name&&"object"==typeof e?.fluid,Ao=e=>{const t=e;return"object"==typeof t&&("string"==typeof t?.package||Oo(t?.package))&&(void 0===t?.config||"object"==typeof t?.config)};var Lo=s(6239),Fo=s(9161),Do=s(6148),xo=s(7269),Ro=s(7790),Mo=s(8332);const _o=async e=>new Promise((t=>setTimeout((()=>t()),e)));var Uo=s(2973),jo=s(6283);async function zo(e,t,n,r){let o,i=!1,s=500,a=0;const c=(0,No.l)();let l;do{try{o=await e(r.cancel),i=!0}catch(e){if(!(0,jo.YU)(e))throw n.sendTelemetryEvent({eventName:`${t}_cancel`,retry:a,duration:(0,No.l)()-c,fetchCallName:t},e),e;if(!0===r.cancel?.aborted)throw n.sendTelemetryEvent({eventName:`${t}_runWithRetryAborted`,retry:a,duration:(0,No.l)()-c,fetchCallName:t,reason:r.cancel.reason},e),new jo.OI("runWithRetry was Aborted",Xr.a.genericError,{driverVersion:"2.41.0",fetchCallName:t,reason:r.cancel.reason});0===a&&n.sendTelemetryEvent({eventName:`${t}_firstFailed`,duration:(0,No.l)()-c,fetchCallName:t},e),a++,l=e,s=$o(s,e),r.onRetry&&r.onRetry(s,e),await _o(s)}}while(!i);return a>0&&n.sendTelemetryEvent({eventName:`${t}_lastError`,retry:a,duration:(0,No.l)()-c,fetchCallName:t},l),o}const qo=6e4,Bo=8e3;function $o(e,t){const n=(0,jo.E9)(t);let r=Math.max(n??0,2*e);return r=Math.min(r,(0,Uo.X)(t)&&!0===t.getTelemetryProperties().endpointReached?qo:Bo),r}function Ho(e,...t){if(void 0===e?.tree||e.tree?.[".app"]?.type!==Ro.Z.Tree||e.tree?.[".protocol"]?.type!==Ro.Z.Tree)return!1;return 2===Object.keys(e.tree).filter((e=>!t.includes(e))).length}function Wo(e){return void 0!==e&&"snapshotFormatV"in e&&1===e.snapshotFormatV}function Vo(e){return Wo(e)?e.snapshotTree:e}var Go=s(1413),Qo=s(6598),Jo=s(4945),Ko=s(5751),Xo=s(8201),Yo=s(240);const Zo="object"==typeof self?self:globalThis,ei=e=>((e,t)=>{const n=(t,n)=>(e.set(n,t),t),r=o=>{if(e.has(o))return e.get(o);const[i,s]=t[o];switch(i){case 0:case-1:return n(s,o);case 1:{const e=n([],o);for(const t of s)e.push(r(t));return e}case 2:{const e=n({},o);for(const[t,n]of s)e[r(t)]=r(n);return e}case 3:return n(new Date(s),o);case 4:{const{source:e,flags:t}=s;return n(new RegExp(e,t),o)}case 5:{const e=n(new Map,o);for(const[t,n]of s)e.set(r(t),r(n));return e}case 6:{const e=n(new Set,o);for(const t of s)e.add(r(t));return e}case 7:{const{name:e,message:t}=s;return n(new Zo[e](t),o)}case 8:return n(BigInt(s),o);case"BigInt":return n(Object(BigInt(s)),o)}return n(new Zo[i](s),o)};return r})(new Map,e)(0),ti="",{toString:ni}={},{keys:ri}=Object,oi=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const n=ni.call(e).slice(8,-1);switch(n){case"Array":return[1,ti];case"Object":return[2,ti];case"Date":return[3,ti];case"RegExp":return[4,ti];case"Map":return[5,ti];case"Set":return[6,ti]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},ii=([e,t])=>0===e&&("function"===t||"symbol"===t),si=(e,{json:t,lossy:n}={})=>{const r=[];return((e,t,n,r)=>{const o=(e,t)=>{const o=r.push(e)-1;return n.set(t,o),o},i=r=>{if(n.has(r))return n.get(r);let[s,a]=oi(r);switch(s){case 0:{let t=r;switch(a){case"bigint":s=8,t=r.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+a);t=null;break;case"undefined":return o([-1],r)}return o([s,t],r)}case 1:{if(a)return o([a,[...r]],r);const e=[],t=o([s,e],r);for(const t of r)e.push(i(t));return t}case 2:{if(a)switch(a){case"BigInt":return o([a,r.toString()],r);case"Boolean":case"Number":case"String":return o([a,r.valueOf()],r)}if(t&&"toJSON"in r)return i(r.toJSON());const n=[],c=o([s,n],r);for(const t of ri(r))!e&&ii(oi(r[t]))||n.push([i(t),i(r[t])]);return c}case 3:return o([s,r.toISOString()],r);case 4:{const{source:e,flags:t}=r;return o([s,{source:e,flags:t}],r)}case 5:{const t=[],n=o([s,t],r);for(const[n,o]of r)(e||!ii(oi(n))&&!ii(oi(o)))&&t.push([i(n),i(o)]);return n}case 6:{const t=[],n=o([s,t],r);for(const n of r)!e&&ii(oi(n))||t.push(i(n));return n}}const{message:c}=r;return o([s,{name:a,message:c}],r)};return i})(!(t||n),!!t,new Map,r)(e),r},ai="function"==typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?ei(si(e,t)):structuredClone(e):(e,t)=>ei(si(e,t));var ci=s(9535),li=s(6277);function ui(e){const t=new URL(e);if("string"!=typeof t.pathname)throw new Jo.iq("Failed to parse pathname");const n=t.search??"",r=/^\/([^/]*\/[^/]*)(\/?.*)$/.exec(t.pathname);return 3===r?.length?{id:r[1],path:r[2],query:n,version:t.searchParams.get("version")??void 0}:void 0}function di(e,t){(0,Fo.vA)(!Ho(e),1448),(0,Fo.vA)(!Ho(t),1449);return{type:Ro.Z.Tree,tree:{".protocol":t,".app":e}}}function pi(e){let t={};const n={blobs:{},trees:{},id:(0,ci.A)(),unreferenced:e.unreferenced,groupId:e.groupId};for(const[r,o]of Object.entries(e.tree))switch(o.type){case Ro.Z.Tree:{const e=pi(o);n.trees[r]=e.baseSnapshot,t={...t,...e.snapshotBlobs};break}case Ro.Z.Attachment:n.blobs[r]=o.id;break;case Ro.Z.Blob:{const e=(0,ci.A)();n.blobs[r]=e;const i=o.content instanceof Uint8Array?(0,li.Km)(o.content):o.content;t[e]=i;break}case Ro.Z.Handle:throw new Jo.iq("No handles should be there in summary in detached container!!");default:(0,xo.$)(o,`Unknown tree type ${o.type}`)}return{baseSnapshot:n,snapshotBlobs:t}}function hi(e){(0,Fo.vA)(void 0!==e.sequenceNumber,2362);const t={};for(const[n,r]of e.blobContents.entries())t[n]=(0,li.JR)(r,"utf8");return{baseSnapshot:e.snapshotTree,snapshotBlobs:t,snapshotSequenceNumber:e.sequenceNumber}}function fi(e,t){const n={type:Ro.Z.Tree,tree:{...t.tree}};n.tree[".protocol"]=e;return pi(n)}const gi=e=>{(0,Fo.vA)(Ho(e),2278);return fi(e.tree[".protocol"],e.tree[".app"])};function mi(e){return".protocol"in e.trees?e.trees[".protocol"]:e}const vi=(e,t)=>{const n={};for(const[,r]of Object.entries(e.blobs))void 0!==t[r]&&(n[r]=(0,li.Xg)(t[r],"utf8"));const r={};for(const[n,o]of Object.entries(e.trees))r[n]=vi(o,t);return{...e,blobsContents:n,trees:r}};function yi(e){return"object"==typeof e&&null!==e&&e?.errorType===Xr.a.deltaStreamConnectionForbidden}const bi=e=>{let t;return(...n)=>void 0!==t?((e,t,n=(e,t)=>Object.is(e,t))=>e===t||e.length===t.length&&e.every(((e,r)=>n(e,t[r],r))))(t.args,n)?t.result:Promise.reject(new Qo.eb("Subsequent calls cannot use different arguments.")):(t={args:n,result:e(...n).finally((()=>t=void 0))},t.result)};async function wi(e,t){if(void 0===t)return{minimumSequenceNumber:0,sequenceNumber:0};const n=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"];return await(0,Go.P)(e,n)}class Si extends Io.X{constructor(){super(),this.members=new Map,super.setMaxListeners(0)}getSelf(){return void 0===this._currentClientId?void 0:{clientId:this._currentClientId,client:this.getMember(this._currentClientId)}}setCurrentClientId(e){if(this._currentClientId!==e){const t=this._currentClientId;this._currentClientId=e,this.emit("selfChanged",void 0===t?void 0:{clientId:t},{clientId:e,client:this.getMember(e)})}}addMember(e,t){if(this.members.has(e)){const n=this.members.get(e);(0,Fo.vA)(JSON.stringify(n)===JSON.stringify(t),1202)}else this.members.set(e,t),this.emit("addMember",e,t)}removeMember(e){const t=this.members.get(e);return void 0!==t&&(this.members.delete(e),this.emit("removeMember",e,t),!0)}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}}var Ci,ki;function Ei(e,t,n){const r={...t},o=n?.online;if(r.online="string"==typeof o?o:jo.WA[(0,jo.sc)()],"object"==typeof navigator&&null!==navigator){const e=navigator,t=e.connection??e.mozConnection??e.webkitConnection;null!==t&&"object"==typeof t&&(r.connectionType=t.type)}r.category=(0,jo.YU)(n)?"generic":"error",e.sendTelemetryEvent(r,n)}function Ti(e){return e.type===Mo.Go.Operation}!function(e){e.DocRead="doc:read",e.DocWrite="doc:write",e.SummaryWrite="summary:write"}(Ci||(Ci={})),function(e){e.Never="Never",e.Disabled="Disabled",e.Enabled="Enabled"}(ki||(ki={}));var Pi=s(8784);class Ni extends Io.X{get disposed(){return this.isDisposed}get paused(){return 0!==this.pauseCount}get length(){return this.q.length}get idle(){return void 0===this.processingPromise&&0===this.q.length}async waitTillProcessingDone(){return this.processingPromise??{count:0,duration:0}}constructor(e){super(),this.worker=e,this.isDisposed=!1,this.q=new Pi,this.pauseCount=1}dispose(){throw new Error("Not implemented.")}clear(){this.q.clear()}peek(){return this.q.peekFront()}toArray(){return this.q.toArray()}push(e){try{this.q.push(e),this.emit("push",e),this.ensureProcessing()}catch(e){this.emit("error",e)}}async pause(){this.pauseCount++,await this.waitTillProcessingDone()}resume(){(0,Fo.vA)(this.pauseCount>0,244),this.pauseCount--,this.ensureProcessing()}ensureProcessing(){this.anythingToProcess()&&void 0===this.processingPromise&&(this.processingPromise=Promise.resolve().then((()=>{(0,Fo.vA)(void 0!==this.processingPromise,895);const e=this.processDeltas();return(0,Fo.vA)(void 0!==this.processingPromise,896),this.processingPromise=void 0,e})).catch((e=>(this.error=e,this.processingPromise=void 0,this.emit("error",e),{count:0,duration:0}))),(0,Fo.vA)(void 0!==this.processingPromise,897))}anythingToProcess(){return this.q.length>0&&!this.paused&&void 0===this.error}processDeltas(){const e=(0,No.l)();let t=0;for(;this.anythingToProcess();){const e=this.q.shift();t++,this.worker(e),this.emit("op",e)}const n=(0,No.l)()-e;return 0===this.q.length&&this.emit("idle",t,n),{count:t,duration:n}}}var Ii=s(6580);const{EventEmitter:Oi}=Ii;class Ai{constructor(e,t,n,r){this.sequenceNumber=e,this.key=t,this.value=n,this.local=r}}class Li extends Io.X{get disposed(){return this.isDisposed}constructor(e){super(),this.isDisposed=!1,this.members=new Map(e),this.snapshotCache=e}snapshot(){return this.snapshotCache??=[...this.members],this.snapshotCache}addMember(e,t){(0,Fo.vA)(!!e,2464),(0,Fo.vA)(!this.members.has(e),2465),this.members.set(e,t),this.emit("addMember",e,t),this.snapshotCache=void 0}removeMember(e){(0,Fo.vA)(!!e,2466),(0,Fo.vA)(this.members.has(e),2467),this.members.delete(e),this.emit("removeMember",e),this.snapshotCache=void 0}getMembers(){return new Map(this.members)}getMember(e){return this.members.get(e)}dispose(){this.isDisposed=!0}}class Fi extends Io.X{get disposed(){return this.isDisposed}constructor(e,t){super(),this.sendProposal=t,this.isDisposed=!1,this.stateEvents=new Oi,this.proposals=new Map(e.proposals.map((([,e])=>[e.sequenceNumber,new Ai(e.sequenceNumber,e.key,e.value,!1)]))),this.values=new Map(e.values),this.proposalsSnapshotCache=e.proposals,this.valuesSnapshotCache=e.values}snapshot(){return this.proposalsSnapshotCache??=[...this.proposals].map((([e,t])=>[e,{sequenceNumber:e,key:t.key,value:t.value},[]])),this.valuesSnapshotCache??=[...this.values],{proposals:this.proposalsSnapshotCache,values:this.valuesSnapshotCache}}has(e){return this.values.has(e)}get(e){return this.values.get(e)?.value}async propose(e,t){const n=this.sendProposal(e,t);if(n<0)throw this.emit("error",{eventName:"ProposalInDisconnectedState",key:e}),new Error("Can't propose in disconnected state");return new Promise(((e,t)=>{let r;const o=(e,t)=>{e===n&&(r=t,this.stateEvents.off("localProposalSequenced",o),this.stateEvents.off("disconnected",s),this.stateEvents.on("localProposalApproved",i))},i=t=>{t===r&&(e(),c())},s=()=>{void 0===r&&this.stateEvents.once("connected",(()=>{void 0===r&&(t(new Error("Client disconnected without successfully sending proposal")),c())}))},a=()=>{t(new Error("QuorumProposals was disposed")),c()},c=()=>{this.stateEvents.off("localProposalSequenced",o),this.stateEvents.off("localProposalApproved",i),this.stateEvents.off("disconnected",s),this.stateEvents.off("disposed",a)};this.stateEvents.on("localProposalSequenced",o),this.stateEvents.on("disconnected",s),this.stateEvents.on("disposed",a)}))}addProposal(e,t,n,r,o){(0,Fo.vA)(!this.proposals.has(n),2468);const i=new Ai(n,e,t,r);this.proposals.set(n,i),this.emit("addProposal",i),r&&this.stateEvents.emit("localProposalSequenced",o,n),this.proposalsSnapshotCache=void 0}updateMinimumSequenceNumber(e){const t=e.minimumSequenceNumber,n=[];for(const[e,r]of this.proposals)e<=t&&n.push(r);n.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));for(const t of n){const n={approvalSequenceNumber:e.sequenceNumber,commitSequenceNumber:-1,key:t.key,sequenceNumber:t.sequenceNumber,value:t.value};this.values.set(n.key,n),this.valuesSnapshotCache=void 0;let r=!1,o=!1;for(const[,e]of this.proposals)if(e.key===n.key){if(o){r=!1;break}r=!0,o=!0}this.emit("approveProposal",n.sequenceNumber,n.key,n.value,n.approvalSequenceNumber),r&&this.emit("approveProposalComplete",n.sequenceNumber,n.key,n.value,n.approvalSequenceNumber),this.proposals.delete(t.sequenceNumber),this.proposalsSnapshotCache=void 0,t.local&&this.stateEvents.emit("localProposalApproved",t.sequenceNumber)}}setConnectionState(e){e?this.stateEvents.emit("connected"):this.stateEvents.emit("disconnected")}dispose(){this.isDisposed=!0,this.stateEvents.emit("disposed")}}class Di extends Io.X{get disposed(){return this.isDisposed}constructor(e,t,n,r){super(),this.isDisposed=!1,this.quorumClients=new Li(e),this.quorumClients.on("addMember",((e,t)=>{this.emit("addMember",e,t)})),this.quorumClients.on("removeMember",(e=>{this.emit("removeMember",e)})),this.quorumProposals=new Fi({proposals:t,values:n},r),this.quorumProposals.on("addProposal",(e=>{this.emit("addProposal",e)})),this.quorumProposals.on("approveProposal",((e,t,n,r)=>{this.emit("approveProposal",e,t,n,r)}))}close(){this.removeAllListeners()}snapshot(){const e=this.quorumClients.snapshot(),{proposals:t,values:n}=this.quorumProposals.snapshot();return{members:e,proposals:t,values:n}}has(e){return this.quorumProposals.has(e)}get(e){return this.quorumProposals.get(e)}addMember(e,t){this.quorumClients.addMember(e,t)}removeMember(e){this.quorumClients.removeMember(e)}getMembers(){return this.quorumClients.getMembers()}getMember(e){return this.quorumClients.getMember(e)}async propose(e,t){return this.quorumProposals.propose(e,t)}addProposal(e,t,n,r,o){return this.quorumProposals.addProposal(e,t,n,r,o)}updateMinimumSequenceNumber(e){this.quorumProposals.updateMinimumSequenceNumber(e)}setConnectionState(e,t){this.quorumProposals.setConnectionState(e)}dispose(){throw new Error("Not implemented.")}}class xi{get quorum(){return this._quorum}constructor(e,t,n,r,o,i){this.minimumSequenceNumber=e,this.sequenceNumber=t,this._quorum=new Di(n,r,o,i)}get attributes(){return{minimumSequenceNumber:this.minimumSequenceNumber,sequenceNumber:this.sequenceNumber}}setConnectionState(e,t){this._quorum.setConnectionState(e,t)}snapshot(){return this._quorum.snapshot()}close(){this._quorum.close()}processMessage(e,t){if(e.sequenceNumber!==this.sequenceNumber+1)throw new Error(`Protocol state is not moving sequentially. Current is ${this.sequenceNumber}. Next is ${e.sequenceNumber}`);this.sequenceNumber=e.sequenceNumber,this.minimumSequenceNumber=e.minimumSequenceNumber;let n=!1;switch(e.type){case Mo.Go.ClientJoin:{const t=e,n=JSON.parse(t.data),r={client:n.detail,sequenceNumber:t.sequenceNumber};this._quorum.addMember(n.clientId,r);break}case Mo.Go.ClientLeave:{const t=e,n=JSON.parse(t.data);this._quorum.removeMember(n);break}case Mo.Go.Propose:{"string"==typeof e.contents&&(e.contents=JSON.parse(e.contents));const r=e.contents;this._quorum.addProposal(r.key,r.value,e.sequenceNumber,t,e.clientSequenceNumber),n=!0;break}}return this._quorum.updateMinimumSequenceNumber(e),{immediateNoOp:n}}getProtocolState(e=!1){const t=this._quorum.snapshot();return e&&(t.members=t.members.map((([e,t])=>[e,{...t,client:{...t.client,user:{id:""}}}]))),{sequenceNumber:this.sequenceNumber,minimumSequenceNumber:this.minimumSequenceNumber,...t}}}var Ri;!function(e){e.ClientJoin="join",e.ClientLeave="leave",e.Clear="clear"}(Ri||(Ri={}));class Mi extends xi{constructor(e,t,n,r,o){super(e.minimumSequenceNumber,e.sequenceNumber,t.members,t.proposals,t.values,n),this.audience=r,this.shouldClientHaveLeft=o;for(const[e,t]of this.quorum.getMembers())r.addMember(e,t.client);this.quorum.on("addMember",((e,t)=>r.addMember(e,t.client))),this.quorum.on("removeMember",(e=>r.removeMember(e)))}processMessage(e,t){if(null!=e.clientId){if(void 0===this.quorum.getMember(e.clientId)&&e.type!==Mo.Go.ClientJoin)throw new Error("Remote message's clientId is missing from the quorum");if(this.shouldClientHaveLeft(e.clientId)&&!function(e){return e.type===Mo.Go.NoOp||e.type===Mo.Go.Accept}(e))throw new Error("Remote message's clientId already should have left")}return super.processMessage(e,t)}processSignal(e){const t=e.content;switch(t.type){case Ri.Clear:{const e=this.audience.getMembers();for(const[t,n]of e)"read"===n.mode&&this.audience.removeMember(t);break}case Ri.ClientJoin:{const e=t.content;"read"===e.client.mode&&this.audience.addMember(e.clientId,e.client);break}case Ri.ClientLeave:{const e=t.content;"read"===this.audience.getMember(e)?.mode&&this.audience.removeMember(e);break}}}}const _i={fatalConnectError:!0};const Ui={mode:"read",details:{capabilities:{interactive:!0}},permission:[],user:{id:"storage-only client"},scopes:[]},ji="storage-only client";class zi extends Io.X{constructor(e,t){super(),this.storageOnlyReason=e,this.readonlyConnectionReason=t,this.clientId=ji,this.claims={scopes:[Ci.DocRead]},this.mode="read",this.existing=!0,this.maxMessageSize=0,this.version="",this.initialMessages=[],this.initialSignals=[],this.initialClients=[{client:Ui,clientId:ji}],this.serviceConfiguration={maxMessageSize:0,blockSize:0},this.checkpointSequenceNumber=void 0,this._disposed=!1}submit(e){this.emit("nack",this.clientId,e.map((e=>({operation:e,content:{message:"Cannot submit with storage-only connection",code:403}}))))}submitSignal(e){this.emit("nack",this.clientId,{operation:e,content:{message:"Cannot submit signal with storage-only connection",code:403}})}get disposed(){return this._disposed}dispose(){this._disposed=!0}}function qi(e){return e instanceof zi}const Bi=async()=>{if(!1===globalThis.navigator?.onLine&&void 0!==globalThis.addEventListener)return new Promise((e=>{const t=()=>{e(),globalThis.removeEventListener("online",t)};globalThis.addEventListener("online",t)}))};class $i{get connectionVerboseProps(){return this._connectionVerboseProps}get connectionMode(){return this.connection?.mode??"read"}get connected(){return void 0!==this.connection}get clientId(){return this.connection?.clientId}get connectionDetails(){return this._connectionDetails}get reconnectMode(){return this._reconnectMode}get maxMessageSize(){return this.connection?.serviceConfiguration?.maxMessageSize??16384}get version(){if(void 0===this.connection)throw new Error("Cannot check version without a connection");return this.connection.version}get serviceConfiguration(){return this.connection?.serviceConfiguration}get scopes(){return this.connection?.claims.scopes}get outbound(){return this._outbound}get connectionProps(){return void 0===this.connection?{...this._connectionProps,sentOps:this.clientSequenceNumber}:this._connectionProps}shouldJoinWrite(){const e=this.clientSequenceNumberObserved<this.clientSequenceNumber-this.localOpsToIgnore,t=this.containerDirty();return e!==t&&this.logger.sendTelemetryEvent({eventName:"DesiredConnectionModeMismatch",details:JSON.stringify({outstandingOps:e,isDirty:t})}),e||t}get readonly(){return this.readOnlyInfo.readonly}get readOnlyInfo(){let e,t=!1;return qi(this.connection)&&(t=!0,e=this.connection.storageOnlyReason),t||this._forceReadonly||!0===this._readonlyPermissions?{readonly:!0,forced:this._forceReadonly,permissions:this._readonlyPermissions,storageOnly:t,storageOnlyReason:e}:{readonly:this._readonlyPermissions}}static detailsFromConnection(e,t){return{claims:e.claims,clientId:e.clientId,checkpointSequenceNumber:e.checkpointSequenceNumber,get initialClients(){return e.initialClients},mode:e.mode,serviceConfiguration:e.serviceConfiguration,version:e.version,reason:t}}constructor(e,t,n,r,o,i){this.serviceProvider=e,this.containerDirty=t,this.client=n,this.logger=o,this.props=i,this._forceReadonly=!1,this.pendingReconnect=!1,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0,this.localOpsToIgnore=0,this.connectFirstConnection=!0,this._connectionVerboseProps={},this._connectionProps={},this._disposed=!1,this.opHandler=(e,t)=>{const n=Array.isArray(t)?t:[t];this.props.incomingOpHandler(n,"opHandler")},this.signalHandler=e=>{const t=Array.isArray(e)?e:[e];this.props.signalHandler(t)},this.nackHandler=(e,t)=>{const n=t[0];if(!0===this._readonlyPermissions)return void this.props.closeHandler((0,jo.Of)("writeOnReadOnlyDocument",{driverVersion:void 0}));const r=function(e){const t=`Nack (${e.type}): ${e.message}`,n=403!==e.code,r=void 0===e.retryAfter?void 0:1e3*e.retryAfter;return(0,jo.ix)(t,{canRetry:n,retryAfterMs:r},{statusCode:e.code,driverVersion:void 0})}(n.content);r.canRetry?this.reconnectOnError("write",r):this.props.closeHandler(r)},this.disconnectHandlerInternal=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.errorHandler=e=>{this.reconnectOnError(this.defaultReconnectionMode,e)},this.clientDetails=this.client.details,this.defaultReconnectionMode=this.client.mode,this._reconnectMode=r?ki.Enabled:ki.Never,this._outbound=new Ni((e=>{if(void 0===this.connection)throw new Error("Attempted to submit an outbound message without connection");this.connection.submit(e)})),this._outbound.on("error",(e=>{this.props.closeHandler((0,Jo.cQ)(e))}))}dispose(e,t=!0){if(this._disposed)return;this._disposed=!0,this._reconnectMode=ki.Never,this._outbound.clear();const n={text:"Closing DeltaManager",error:e},r=this.readonly;this.disconnectFromDeltaStream(n),t&&this.set_readonlyPermissions(!0,r,n)}setAutoReconnect(e,t){(0,Fo.vA)(e!==ki.Never&&this._reconnectMode!==ki.Never,632),this._reconnectMode=e,e!==ki.Enabled&&this.disconnectFromDeltaStream(t)}forceReadonly(e){e!==this._forceReadonly&&this.logger.sendTelemetryEvent({eventName:"ForceReadOnly",value:e});const t=this.readonly;if(this._forceReadonly=e,t!==this.readonly){if(this._reconnectMode===ki.Never)throw new Qo.eb("API is not supported for non-connecting or closed container");let e=!1;!0===this.readonly&&(this.shouldJoinWrite()&&this.logger.sendErrorEvent({eventName:"ForceReadonlyPendingChanged"}),e=this.disconnectFromDeltaStream({text:"Force readonly"})),this.props.readonlyChangeHandler(this.readonly),e&&this.triggerConnect({text:"Force Readonly"},"read")}}set_readonlyPermissions(e,t,n){this._readonlyPermissions=e,t!==this.readonly&&this.props.readonlyChangeHandler(this.readonly,n)}connect(e,t){this.connectCore(e,t).catch((e=>{const t=(0,Jo.cQ)(e,{props:_i});this.props.closeHandler(t)}))}async connectCore(e,t){(0,Fo.vA)(!this._disposed,618);let n=t??this.defaultReconnectionMode;if(this.shouldJoinWrite()&&(n="write"),void 0!==this.connection||void 0!==this.pendingConnection){const e=this.connection?.mode??this.pendingConnection?.connectionMode;return void(e!==n&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",connected:void 0!==this.connection,mode:e,requestedMode:n,stack:(0,Jo.aX)()}))}const r=this.serviceProvider();let o;if((0,Fo.vA)(void 0!==r,679),this.props.establishConnectionHandler(e),!0===r.policies?.storageOnly)return o=new zi,this.setupNewSuccessfulConnection(o,"read",e),void(0,Fo.vA)(void 0===this.pendingConnection,691);let i=500,s=0;const a=(0,No.l)();let c;const l=new AbortController,u=l.signal;for(this.pendingConnection={abort:()=>{l.abort()},connectionMode:n};void 0===o;){if(this._disposed)throw new Error("Attempting to connect a closed DeltaManager");if(!0===u.aborted)return void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:s,duration:(0,Yr.T0)((0,No.l)()-a),connectionEstablished:!1});s++;try{this.client.mode=n,o=await r.connectToDeltaStream({...this.client,mode:n}),o.disposed&&(this.logger.sendTelemetryEvent({eventName:"ReceivedClosedConnection"}),o=void 0),this.logger.sendTelemetryEvent({eventName:"ConnectionReceived",connected:void 0!==o&&!1===o.disposed},void 0,Lo.$.verbose)}catch(e){if(this.logger.sendTelemetryEvent({eventName:"ConnectToDeltaStreamException",connected:void 0!==o&&!1===o.disposed},void 0,Lo.$.verbose),yi(e)){o=new zi(e.storageOnlyReason,{text:e.message,error:e}),n="read";break}if((0,Uo.X)(e)&&e.errorType===Xr.a.outOfStorageError){o=new zi(void 0,{text:e.message,error:e}),n="read";break}if(!(0,jo.YU)(e)){const t=(0,Jo.cQ)(e,{props:_i});throw this.props.closeHandler(t),t}if(Ei(this.logger,{attempts:s,delay:i,eventName:"DeltaConnectionFailureToConnect",duration:(0,Yr.T0)((0,No.l)()-a)},e),c=e,this.reconnectMode!==ki.Enabled)return;const t=(0,No.l)(),r=(0,jo.E9)(e);void 0===r&&!1===globalThis.navigator?.onLine||(i=$o(i,e)),void 0!==r&&this.props.reconnectionDelayHandler(i,e),await new Promise((e=>{setTimeout(e,i)})),await Bi(),this.logger.sendPerformanceEvent({eventName:"WaitBetweenConnectionAttempts",duration:(0,No.l)()-t,details:JSON.stringify({retryDelayFromError:r,delayMs:i})})}}if(s>1&&Ei(this.logger,{eventName:"MultipleDeltaConnectionFailures",attempts:s,duration:(0,Yr.T0)((0,No.l)()-a)},c),!0===u.aborted||this._disposed)return o.dispose(),void this.logger.sendTelemetryEvent({eventName:"ConnectionAttemptCancelled",attempts:s,duration:(0,Yr.T0)((0,No.l)()-a),connectionEstablished:!0});this.setupNewSuccessfulConnection(o,n,e)}triggerConnect(e,t){this.reconnectMode===ki.Enabled&&this.connect(e,t)}disconnectFromDeltaStream(e){if(this.pendingReconnect=!1,void 0===this.connection)return void 0!==this.pendingConnection&&(this.cancelConnection(e),!0);(0,Fo.vA)(void 0===this.pendingConnection,635);const t=this.connection;return this.connection=void 0,this._connectionDetails=void 0,t.off("op",this.opHandler),t.off("signal",this.signalHandler),t.off("nack",this.nackHandler),t.off("disconnect",this.disconnectHandlerInternal),t.off("error",this.errorHandler),t.off("pong",this.props.pongHandler),this._outbound.pause(),this._outbound.clear(),t.dispose(),this.props.disconnectHandler(e),this._connectionVerboseProps={},!0}cancelConnection(e){(0,Fo.vA)(void 0!==this.pendingConnection,837),this.pendingConnection.abort(),this.pendingConnection=void 0,this.logger.sendTelemetryEvent({eventName:"ConnectionCancelReceived",reason:e.text}),this.props.cancelConnectionHandler({text:`Cancel Pending Connection due to ${e.text}`,error:e.error})}setupNewSuccessfulConnection(e,t,n){(0,Fo.vA)(void 0===this.connection,230),(0,Fo.vA)(!e.disposed,650),this.pendingConnection=void 0;const r=this.readonly;this.connection=e;const o=!e.claims.scopes.includes(Ci.DocWrite);if(e.mode!==t&&this.logger.sendTelemetryEvent({eventName:"ConnectionModeMismatch",requestedMode:t,mode:e.mode}),(0,Fo.vA)(!o||"read"===this.connectionMode,232),this.set_readonlyPermissions(o,r,qi(e)?e.readonlyConnectionReason:void 0),this._disposed)return void this.disconnectFromDeltaStream({text:"ConnectionManager already closed"});this._outbound.resume(),e.on("op",this.opHandler),e.on("signal",this.signalHandler),e.on("nack",this.nackHandler),e.on("disconnect",this.disconnectHandlerInternal),e.on("error",this.errorHandler),e.on("pong",this.props.pongHandler);const i=e.initialMessages.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));let s=e.checkpointSequenceNumber;this._connectionVerboseProps={clientId:e.clientId,mode:e.mode},this._connectionProps={},void 0!==e.relayServiceAgent&&(this._connectionVerboseProps.relayServiceAgent=e.relayServiceAgent,this._connectionProps.relayServiceAgent=e.relayServiceAgent),this._connectionProps.socketDocumentId=e.claims.documentId,this._connectionProps.connectionMode=e.mode;let a=-1;i.length>0&&(this._connectionVerboseProps.connectionInitialOpsFrom=i[0].sequenceNumber,a=i[i.length-1].sequenceNumber,this._connectionVerboseProps.connectionInitialOpsTo=a+1,(void 0===s||s<a)&&(s=a)),this.props.incomingOpHandler(i,this.connectFirstConnection?"InitialOps":"ReconnectOps"),this._connectionDetails=$i.detailsFromConnection(e,n),this._connectionDetails.checkpointSequenceNumber=s,this.props.connectHandler(this._connectionDetails),this.connectFirstConnection=!1;let c=[{clientId:null,content:JSON.stringify({type:Ri.Clear})}];const l=(e.initialClients??[]).map((e=>({clientId:null,content:JSON.stringify({type:Ri.ClientJoin,content:e})})));l.length>0&&(c=[...c,...l]),void 0!==e.initialSignals&&e.initialSignals.length>0&&(c=[...c,...e.initialSignals]),this.props.signalHandler(c)}reconnectOnError(e,t){this.reconnect(e,{text:t.message,error:t}).catch(this.props.closeHandler)}async reconnect(e,t){if((0,Fo.vA)(void 0!==this.connection,235),this.disconnectFromDeltaStream(t),!1===t.error?.canRetry&&this.logger.sendTelemetryEvent({eventName:"reconnectingDespiteFatalError",reconnectMode:this.reconnectMode},t.error),this.reconnectMode===ki.Never&&this.props.closeHandler(),this._disposed||this.reconnectMode!==ki.Enabled)return;const n=(0,jo.E9)(t.error);void 0!==t.error&&void 0!==n&&(this.props.reconnectionDelayHandler(n,t.error),await new Promise((e=>{setTimeout(e,n)}))),await Bi(),this.triggerConnect({text:void 0===t.error?`Reconnecting due to: ${t.text}`:"Reconnecting due to Error",error:t.error},e)}prepareMessageToSend(e){if(!0!==this.readonly)return(0,Fo.vA)(!!this.connection,228),this.lastSubmittedClientId!==this.connection?.clientId&&(this.lastSubmittedClientId=this.connection?.clientId,this.clientSequenceNumber=0,this.clientSequenceNumberObserved=0),Ti(e)?this.localOpsToIgnore=0:this.localOpsToIgnore++,{...e,clientSequenceNumber:++this.clientSequenceNumber};{(0,Fo.vA)(!0===this.readOnlyInfo.readonly,496);const e=new Qo.gn("deltaManagerReadonlySubmit",void 0,{readonly:this.readOnlyInfo.readonly,forcedReadonly:this.readOnlyInfo.forced,readonlyPermissions:this.readOnlyInfo.permissions,storageOnly:this.readOnlyInfo.storageOnly,storageOnlyReason:this.readOnlyInfo.storageOnlyReason});this.props.closeHandler(e)}}submitSignal(e,t){void 0===this.connection?this.logger.sendErrorEvent({eventName:"submitSignalDisconnected"}):this.connection.submitSignal(e,t)}sendMessages(e){(0,Fo.vA)(this.connected,692),"read"!==this.connectionMode?((0,Fo.vA)(!this.pendingReconnect,693),this._outbound.push(e)):this.pendingReconnect||(this.pendingReconnect=!0,Promise.resolve().then((async()=>{this.pendingReconnect&&await this.reconnect("write",{text:"Switch to write"})})).catch((()=>{})))}beforeProcessingIncomingOp(e){if((0,Fo.vA)(this.clientId!==e.clientId||this.lastSubmittedClientId===e.clientId,238),void 0!==this.lastSubmittedClientId&&this.lastSubmittedClientId===e.clientId){const t=e.clientSequenceNumber;(0,Fo.vA)(this.clientSequenceNumberObserved<t,239),(0,Fo.vA)(t<=this.clientSequenceNumber,240),this.clientSequenceNumberObserved=t}if(e.type===Mo.Go.ClientLeave){const t=e;JSON.parse(t.data)===this.clientId&&(this.logger.sendPerformanceEvent({eventName:"ReadConnectionTransition"}),this.reconnect("read",{text:"Switch to read"}).catch((e=>{this.logger.sendErrorEvent({eventName:"SwitchToReadConnection"},e)})))}}}const Hi=2147483647;function Wi(e,t,n){let r;if(t>Hi){const o=t-Hi;r=setTimeout((()=>Wi(e,o,n)),Hi)}else r=setTimeout((()=>e()),Math.max(t,0));return n?.(r),r}class Vi{get hasTimer(){return!!this.runningState}constructor(e,t,n){this.defaultTimeout=e,this.defaultHandler=t,this.exceptionHandler=n,this.getCurrentTick=()=>Date.now()}start(e=this.defaultTimeout,t=this.defaultHandler){this.startCore(e,t,e)}clear(){this.runningState&&(clearTimeout(this.runningState.timeout),this.runningState=void 0)}restart(e,t){if(this.runningState){const n=e??this.runningState.intendedDuration,r=t??this.runningState.restart?.handler??this.runningState.handler,o=this.calculateRemainingTime(this.runningState);n<o?this.start(n,r):n===o?(this.runningState.handler=r,this.runningState.restart=void 0,this.runningState.intendedDuration=n):this.runningState.restart={startTick:this.getCurrentTick(),duration:n,handler:r}}else this.start(e,t)}startCore(e,t,n){this.clear(),this.runningState={startTick:this.getCurrentTick(),duration:e,intendedDuration:n,handler:t,timeout:Wi((()=>this.handler()),e,(e=>{void 0!==this.runningState&&(this.runningState.timeout=e)}))}}handler(){(0,Fo.vA)(!!this.runningState,1892);const e=this.runningState.restart;if(void 0===e){const e=this.runningState.handler;this.clear();try{e()}catch(e){if(!this.exceptionHandler)throw e;this.exceptionHandler(e)}}else{const t=this.calculateRemainingTime(e);this.startCore(t,(()=>e.handler()),e.duration)}}calculateRemainingTime(e){const t=this.getCurrentTick()-e.startTick;return e.duration-t}}class Gi{constructor(e,t){this.deltaManager=e,this.listener=t,this.caughtUp=!1,this.opHandler=e=>{!this.caughtUp&&e.sequenceNumber>=this.targetSeqNumber&&(this.caughtUp=!0,this.listener())},this._disposed=!1,this.targetSeqNumber=this.deltaManager.lastKnownSeqNumber,(0,Fo.vA)(this.targetSeqNumber>=this.deltaManager.lastSequenceNumber,892),this.deltaManager.on("op",this.opHandler),this.opHandler({sequenceNumber:this.deltaManager.lastSequenceNumber})}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this.deltaManager.off("op",this.opHandler))}}function Qi(e,t,n){const r=e.mc.config;return function(e,t,n,r,o){const i=e=>new Xi(e,t,o);return e?new Ki(n,i,r):i(n)}(!0!==r.getBoolean("Fluid.Container.DisableCatchUpBeforeDeclaringConnected"),!0!==r.getBoolean("Fluid.Container.DisableJoinSignalWait"),e,t,n)}class Ji{constructor(e,t){this.inputs=e,this.pimpl=t(this)}get connectionState(){return this.pimpl.connectionState}get pendingClientId(){return this.pimpl.pendingClientId}get clientId(){return this.pimpl.clientId}containerSaved(){return this.pimpl.containerSaved()}dispose(){return this.pimpl.dispose()}initProtocol(e){return this.pimpl.initProtocol(e)}receivedDisconnectEvent(e){return this.pimpl.receivedDisconnectEvent(e)}establishingConnection(e){return this.pimpl.establishingConnection(e)}cancelEstablishingConnection(e){return this.pimpl.cancelEstablishingConnection(e)}receivedConnectEvent(e){return this.pimpl.receivedConnectEvent(e)}get logger(){return this.inputs.logger}get mc(){return this.inputs.mc}connectionStateChanged(e,t,n){return this.inputs.connectionStateChanged(e,t,n)}shouldClientJoinWrite(){return this.inputs.shouldClientJoinWrite()}get maxClientLeaveWaitTime(){return this.inputs.maxClientLeaveWaitTime}logConnectionIssue(e,t,n){return this.inputs.logConnectionIssue(e,t,n)}clientShouldHaveLeft(e){return this.inputs.clientShouldHaveLeft(e)}onCriticalError(e){return this.inputs.onCriticalError(e)}}class Ki extends Ji{constructor(e,t,n){super(e,t),this.deltaManager=n,this.transitionToConnectedState=()=>{const e=this.pimpl.connectionState;(0,Fo.vA)(e===Po.Connected,997),(0,Fo.vA)(this._connectionState===Po.CatchingUp,998),this._connectionState=Po.Connected,this.inputs.connectionStateChanged(Po.Connected,Po.CatchingUp,{text:"caught up"})},this._connectionState=this.pimpl.connectionState}get connectionState(){return this._connectionState}connectionStateChanged(e,t,n){switch(e){case Po.Connected:return(0,Fo.vA)(this._connectionState===Po.CatchingUp,993),(0,Fo.vA)(void 0===this.catchUpMonitor,1003),void(this.catchUpMonitor=new Gi(this.deltaManager,this.transitionToConnectedState));case Po.Disconnected:this.catchUpMonitor?.dispose(),this.catchUpMonitor=void 0;break;case Po.EstablishingConnection:(0,Fo.vA)(this._connectionState===Po.Disconnected,1746);break;case Po.CatchingUp:(0,Fo.vA)(this._connectionState===Po.EstablishingConnection,995)}this._connectionState=e,this.inputs.connectionStateChanged(e,t,n)}}class Xi{get connectionState(){return this._connectionState}get clientId(){return this._clientId}get pendingClientId(){return this._pendingClientId}constructor(e,t,n){this.handler=e,this.readClientsWaitForJoinSignal=t,this._connectionState=Po.Disconnected,this._clientId=n;const r=e=>this.handler.onCriticalError(e);this.prevClientLeftTimer=new Vi(this.handler.maxClientLeaveWaitTime??3e5,(()=>{(0,Fo.vA)(this.connectionState!==Po.Connected,684),this.applyForConnectedState("timeout")}),r),this.joinTimer=new Vi(0,(()=>{if(this.connectionState!==Po.CatchingUp)return;const e={protocolInitialized:void 0!==this.protocol,pendingClientId:this.pendingClientId,clientJoined:this.hasMember(this.pendingClientId),waitingForLeaveOp:this.waitingForLeaveOp};this.handler.logConnectionIssue("read"===this.connection?.mode?"NoJoinSignal":"NoJoinOp","error",e)}),r)}startjoinTimer(){(0,Fo.vA)(!this.joinTimer.hasTimer,564),(0,Fo.vA)(void 0!==this.connection,1203),this.joinTimer.start("write"===this.connection.mode?45e3:1e4)}stopjoinTimer(){(0,Fo.vA)(this.joinTimer.hasTimer,565),this.joinTimer.clear()}get waitingForLeaveOp(){return this.prevClientLeftTimer.hasTimer}dispose(){(0,Fo.vA)(!this.joinTimer.hasTimer,677),this.prevClientLeftTimer.clear()}containerSaved(){this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("containerSaved"))}receivedAddMemberEvent(e){e===this.pendingClientId&&(this.joinTimer.hasTimer?this.stopjoinTimer():this.shouldWaitForSelf()&&this.handler.logConnectionIssue("read"===this.connection?.mode?"ReceivedJoinSignal":"ReceivedJoinOp","generic"),this.waitingForLeaveOp&&(this.waitEvent=Yr.Bt.start(this.handler.logger,{eventName:"WaitBeforeClientLeave",details:JSON.stringify({waitOnClientId:this._clientId,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.applyForConnectedState("addMemberEvent"))}applyForConnectedState(e){if((0,Fo.vA)(void 0!==this.protocol,566),(0,Fo.vA)(!this.waitingForLeaveOp||this.hasMember(this.clientId),738),this.pendingClientId!==this.clientId&&this.hasMember(this.pendingClientId)&&!this.waitingForLeaveOp)this.waitEvent?.end({source:e}),this.setConnectionState(Po.Connected);else{const t="timeout"===e&&this.connectionState!==Po.Disconnected;this.handler.logger.sendTelemetryEvent({eventName:"connectedStateRejected",category:t?"error":"generic",details:JSON.stringify({source:e,pendingClientId:this.pendingClientId,clientId:this.clientId,waitingForLeaveOp:this.waitingForLeaveOp,clientJoined:this.hasMember(this.pendingClientId)})})}}receivedRemoveMemberEvent(e){this.clientId===e&&this.waitingForLeaveOp&&(this.prevClientLeftTimer.clear(),this.applyForConnectedState("removeMemberEvent"))}receivedDisconnectEvent(e){this.connection=void 0,this.setConnectionState(Po.Disconnected,e)}cancelEstablishingConnection(e){(0,Fo.vA)(this._connectionState===Po.EstablishingConnection,1747),(0,Fo.vA)(void 0===this.connection,1748);const t=this._connectionState;this._connectionState=Po.Disconnected,this.handler.connectionStateChanged(Po.Disconnected,t,e)}establishingConnection(e){const t=this._connectionState;this._connectionState=Po.EstablishingConnection,this.handler.connectionStateChanged(Po.EstablishingConnection,t,{text:`Establishing Connection due to ${e.text}`,error:e.error})}shouldWaitForSelf(){return(0,Fo.vA)(void 0!==this.connection,1204),"write"===this.connection.mode||this.readClientsWaitForJoinSignal}receivedConnectEvent(e){this.connection=e;const t=this._connectionState;this._connectionState=Po.CatchingUp,this._pendingClientId=e.clientId,this.handler.connectionStateChanged(Po.CatchingUp,t,e.reason),!this.hasMember(this._pendingClientId)&&this.shouldWaitForSelf()?this.startjoinTimer():this.waitingForLeaveOp||this.setConnectionState(Po.Connected)}setConnectionState(e,t){if(this.connectionState===e)return void this.handler.logger.sendErrorEvent({eventName:"setConnectionStateSame",value:e});const n=this._connectionState;this._connectionState=e;const r=void 0!==this._clientId&&void 0!==this.protocol?.quorum?.getMember(this._clientId);e===Po.Connected?((0,Fo.vA)(n===Po.CatchingUp,472),r&&this.handler.clientShouldHaveLeft(this._clientId),this._clientId=this.pendingClientId):e===Po.Disconnected&&(this.joinTimer.hasTimer&&this.stopjoinTimer(),r&&this.handler.shouldClientJoinWrite()&&!this.waitingForLeaveOp?this.prevClientLeftTimer.restart():this.handler.logger.sendTelemetryEvent({eventName:"noWaitOnDisconnected",details:JSON.stringify({clientId:this._clientId,inQuorum:r,waitingForLeaveOp:this.waitingForLeaveOp,hadOutstandingOps:this.handler.shouldClientJoinWrite()})})),this.handler.connectionStateChanged(this._connectionState,n,t),e===Po.Disconnected&&(this._pendingClientId=void 0)}get membership(){return this.readClientsWaitForJoinSignal?this.protocol?.audience:this.protocol?.quorum}initProtocol(e){this.protocol=e,this.membership?.on("addMember",((t,n)=>{(0,Fo.vA)("read"===n.mode||void 0!==e.quorum.getMember(t),1205),this.receivedAddMemberEvent(t)})),this.membership?.on("removeMember",(t=>{(0,Fo.vA)(void 0===e.quorum.getMember(t),1206),this.receivedRemoveMemberEvent(t)})),this.hasMember(this.pendingClientId)&&this.receivedAddMemberEvent(this.pendingClientId),(0,Fo.vA)(!this.waitingForLeaveOp,2461),void 0!==this._clientId&&void 0!==e.quorum?.getMember(this._clientId)&&this.prevClientLeftTimer.restart()}hasMember(e){return void 0!==this.membership?.getMember(e??"")}}var Yi=s(9032);const Zi="2.41.0",es={...{pkgVersion:Zi,generation:1},supportedFeatures:new Set},ts={minSupportedGeneration:0,requiredFeatures:[]};class ns{get clientId(){return this._getClientId()}get id(){return this._getContainerDiagnosticId()??""}get connected(){return this._getConnected()}get ILayerCompatDetails(){return es}constructor(e,t,n,r,o,i,s,a,c,l,u,d,p,h,f,g,m,v,y,b,w,S,C,k,E,T){this.options=e,this.scope=t,this.baseSnapshot=n,this._version=r,this.deltaManager=o,this.storage=i,this.quorum=s,this.audience=a,this.loader=c,this.submitFn=l,this.submitSummaryFn=u,this.submitBatchFn=d,this.submitSignalFn=p,this.disposeFn=h,this.closeFn=f,this.updateDirtyContainerState=g,this.getAbsoluteUrl=m,this._getContainerDiagnosticId=v,this._getClientId=y,this._getAttachState=b,this._getConnected=w,this.clientDetails=S,this.existing=C,this.taggedLogger=k,this.pendingLocalState=E,this.snapshotWithContents=T,this.supportedFeatures=new Map([["referenceSequenceNumbers",!0]])}getLoadedFromVersion(){return this._version}get attachState(){return this._getAttachState()}}class rs extends Jo.iq{constructor(e){super(e,{usageError:!0}),this.errorType=Xr.a.usageError,this.canRetry=!1}}class os{constructor(e,t,n){this.internalStorageService=e,this.addProtocolSummaryIfMissing=t,this.shouldSummarizeProtocolTree=n,this.getSnapshotTree=e.getSnapshotTree.bind(e),this.getSnapshot=e.getSnapshot?.bind(e),this.getVersions=e.getVersions.bind(e),this.createBlob=e.createBlob.bind(e),this.readBlob=e.readBlob.bind(e),this.downloadSummary=e.downloadSummary.bind(e),this.dispose=e.dispose.bind(e)}get policies(){return this.internalStorageService.policies}get disposed(){return this.internalStorageService.disposed}async uploadSummaryWithContext(e,t){return this.shouldSummarizeProtocolTree()?this.internalStorageService.uploadSummaryWithContext(this.addProtocolSummaryIfMissing(e),t):this.internalStorageService.uploadSummaryWithContext(e,t)}}class is{constructor(e,t){this.internalStorageServiceP=e,this.logger=t,this._disposed=!1,this.internalStorageServiceP.then((e=>this.internalStorageService=e)).catch((()=>{}))}get policies(){if(this.internalStorageService)return this.internalStorageService.policies;throw new Error("storage service not yet instantiated")}get disposed(){return this._disposed}dispose(){this._disposed=!0}async getSnapshotTree(e,t){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async n=>n.getSnapshotTree(e,t)))),"storage_getSnapshotTree")}async getSnapshot(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>{if(void 0!==t.getSnapshot)return t.getSnapshot(e);throw new Qo.eb("getSnapshot api should exist on internal storage in RetriableDocStorageService class")}))),"storage_getSnapshot")}async readBlob(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>t.readBlob(e)))),"storage_readBlob")}async getVersions(e,t,n,r){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async o=>o.getVersions(e,t,n,r)))),"storage_getVersions")}async uploadSummaryWithContext(e,t){return(0,Fo.vA)(0===t.referenceSequenceNumber==(void 0===t.ackHandle),593),0!==t.referenceSequenceNumber?this.internalStorageServiceP.then((async n=>n.uploadSummaryWithContext(e,t))):this.runWithRetry((async()=>this.internalStorageServiceP.then((async n=>n.uploadSummaryWithContext(e,t)))),"storage_uploadSummaryWithContext")}async downloadSummary(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>t.downloadSummary(e)))),"storage_downloadSummary")}async createBlob(e){return this.runWithRetry((async()=>this.internalStorageServiceP.then((async t=>t.createBlob(e)))),"storage_createBlob")}checkStorageDisposed(e,t){if(this._disposed)throw this.logger.sendTelemetryEvent({eventName:`${e}_abortedStorageDisposed`,fetchCallName:e},t),new Qo.gn("Storage Service is disposed. Cannot retry",{canRetry:!1})}async runWithRetry(e,t){return zo(e,t,this.logger,{onRetry:(e,n)=>this.checkStorageDisposed(t,n)})}}class ss{get summarizeProtocolTree(){return!0===this._summarizeProtocolTree}get loadedGroupIdSnapshots(){return this._loadedGroupIdSnapshots}constructor(e,t,n={},r,o,i){this.logger=t,this.blobContents=n,this.loadingGroupIdSnapshotsFromPendingState=r,this.addProtocolSummaryIfMissing=o,this.enableSummarizeProtocolTree=i,this._loadedGroupIdSnapshots={},this.disposed=!1,this._storageService=new as(e,t)}dispose(e){this._storageService?.dispose?.(e),this.disposed=!0}connectToService(e){if(!(this._storageService instanceof as))return;const t=e.connectToStorage(),n=this._storageService=new is(t,this.logger);this._storageService=new os(n,((...e)=>(this.logger.sendTelemetryEvent({eventName:"summarizeProtocolTreeEnabled"}),this.addProtocolSummaryIfMissing(...e))),(()=>{const t=e.policies?.summarizeProtocolTree??this.enableSummarizeProtocolTree??!1;return this._summarizeProtocolTree!==t&&this.logger.sendTelemetryEvent({eventName:"isSummarizeProtocolTreeEnabled",details:{value:t}}),this._summarizeProtocolTree=t,this._summarizeProtocolTree}))}loadSnapshotFromSnapshotBlobs(e){for(const[t,n]of Object.entries(e))this.blobContents[t]=n}clearPendingState(){this.loadingGroupIdSnapshotsFromPendingState=void 0}get policies(){try{return this._storageService.policies}catch{}}async getSnapshotTree(e,t){return this._storageService.getSnapshotTree(e,t)}async getSnapshot(e){let t;if(void 0!==this.loadingGroupIdSnapshotsFromPendingState&&void 0!==e?.loadingGroupIds){const n=this.loadingGroupIdSnapshotsFromPendingState[e.loadingGroupIds[0]];(0,Fo.vA)(void 0!==n,2416),t=function(e,t){const n=new Map;for(const[t,r]of Object.entries(e.snapshotBlobs))n.set(t,(0,li.Xg)(r,"utf8"));return{snapshotTree:e.baseSnapshot,blobContents:n,ops:[],sequenceNumber:t,latestSequenceNumber:void 0,snapshotFormatV:1}}(n,n.snapshotSequenceNumber)}else{if(void 0===this._storageService.getSnapshot)throw new rs("getSnapshot api should exist in internal storage in ContainerStorageAdapter");t=await this._storageService.getSnapshot(e)}const n=e?.loadingGroupIds;if((0,Fo.vA)(void 0!==t.sequenceNumber,2417),void 0!==n)for(const e of n){(this._loadedGroupIdSnapshots[e]?.sequenceNumber??-1)<t.sequenceNumber&&(this._loadedGroupIdSnapshots[e]=t)}return t}async readBlob(e){const t=this.blobContents[e];if(void 0!==t){if("string"==typeof t){return(0,li.Xg)(t,"utf8")}return t}return this._storageService.readBlob(e)}async getVersions(e,t,n,r){return this._storageService.getVersions(e,t,n,r)}async uploadSummaryWithContext(e,t){return this._storageService.uploadSummaryWithContext(e,t)}async downloadSummary(e){return this._storageService.downloadSummary(e)}async createBlob(e){return this._storageService.createBlob(e)}}class as{constructor(e,t){this.detachedStorage=e,this.logger=t,this.getSnapshotTree=this.notCalled,this.getSnapshot=this.notCalled,this.getVersions=this.notCalled,this.write=this.notCalled,this.uploadSummaryWithContext=this.notCalled,this.downloadSummary=this.notCalled}async createBlob(e){return this.verifyStorage().createBlob(e)}async readBlob(e){return this.verifyStorage().readBlob(e)}verifyStorage(){if(void 0===this.detachedStorage)throw new rs("Real storage calls not allowed in Unattached container");return this.detachedStorage}get policies(){return this.notCalled()}notCalled(){this.verifyStorage();try{throw new Error("BlobOnlyStorage not implemented method used")}catch(e){throw this.logger.sendTelemetryEvent({eventName:"BlobOnlyStorageWrongCall"},e),e}}}const cs=".blobs",ls=".redirectTable";async function us(e,t){const n={};if(Wo(e)){const t=e.blobContents;for(const[e,r]of t.entries())n[e]=(0,li.JR)(r,"utf8")}else await ds(e,n,t);return n}async function ds(e,t,n,r=!0){const o=[];for(const[i,s]of Object.entries(e.trees))r&&i===cs?o.push(ps(s,t,n)):o.push(ds(s,t,n,!1));for(const r of Object.values(e.blobs)){const e=await n.readBlob(r);t[r]=(0,li.JR)(e,"utf8")}return Promise.all(o)}async function ps(e,t,n){const r=e.blobs[ls];(0,Fo.vA)(void 0!==r,2510);const o=await n.readBlob(r);t[r]=(0,li.JR)(o,"utf8")}const hs={...s(8213).k,clientSessionExpiredError:"clientSessionExpiredError"};class fs extends Jo.iq{constructor(e,t,n){super(e,n),this.retryAfterSeconds=t,this.errorType=hs.throttlingError}static wrap(e,t,n){return(0,Jo.G)(e,(e=>new fs(e,t)),n)}}function gs(e){if(Ti(e))return!0;switch(e.type){case Mo.Go.Propose:case Mo.Go.Reject:case Mo.Go.NoOp:case Mo.Go.Accept:case Mo.Go.Summarize:return!0;default:return!1}}class ms extends Xo.o{get active(){return this._active()}get disposed(){return this._closed}get IDeltaSender(){return this}get inbound(){return this._inbound}get inboundSignal(){return this._inboundSignal}get initialSequenceNumber(){return this.initSequenceNumber}get lastSequenceNumber(){return this.lastProcessedSequenceNumber}get lastMessage(){return this.lastProcessedMessage}get lastKnownSeqNumber(){return this.lastObservedSeqNumber}get minimumSequenceNumber(){return this.minSequenceNumber}get hasCheckpointSequenceNumber(){return(0,Fo.vA)(this.connectionManager.connected,223),void 0!==this._checkpointSequenceNumber}get maxMessageSize(){return this.connectionManager.maxMessageSize}get version(){return this.connectionManager.version}get serviceConfiguration(){return this.connectionManager.serviceConfiguration}get outbound(){return this.connectionManager.outbound}get readOnlyInfo(){return this.connectionManager.readOnlyInfo}get clientDetails(){return this.connectionManager.clientDetails}submit(e,t,n=!1,r,o,i){const s={contents:t,metadata:r,referenceSequenceNumber:i??this.lastProcessedSequenceNumber,type:e,compression:o};n||this.flush();const a=this.connectionManager.prepareMessageToSend(s);return void 0===a?-1:((0,Fo.vA)(gs(a),1049),void 0!==t&&(this.opsSize+=t.length),this.messageBuffer.push(a),a.type===Mo.Go.NoOp&&this.noOpCount++,this.emit("submitOp",a),n||this.flush(),a.clientSequenceNumber)}submitSignal(e,t){return this.connectionManager.submitSignal(e,t)}flush(){const e=this.messageBuffer;0!==e.length&&(this.messageBuffer=[],this.emit("prepareSend",e),1===e.length?(0,Fo.vA)(void 0===e[0].metadata?.batch,969):((0,Fo.vA)(!0===e[0].metadata?.batch,970),(0,Fo.vA)(!1===e[e.length-1].metadata?.batch,971)),this.connectionManager.sendMessages(e),(0,Fo.vA)(0===this.messageBuffer.length,972))}get connectionProps(){return{sequenceNumber:this.lastSequenceNumber,opsSize:this.opsSize>0?this.opsSize:void 0,deltaManagerState:this._disposed?"disposed":this._closed?"closed":"open",...this.connectionManager.connectionProps}}logConnectionIssue(e){(0,Fo.vA)(this.connectionManager.connected,568);const t=this.pending.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));this.logger.sendTelemetryEvent({...e,fetchReason:this.fetchReason,lastQueuedSequenceNumber:this.lastQueuedSequenceNumber,lastProcessedSequenceNumber:this.lastProcessedSequenceNumber,lastObserved:this.lastObservedSeqNumber,...this.connectionManager.connectionVerboseProps,pendingOps:this.pending.length,pendingFirst:t[0]?.sequenceNumber,haveHandler:void 0!==this.handler,inboundLength:this.inbound.length,inboundPaused:this.inbound.paused})}constructor(e,t,n,r){super(((e,t)=>{this.logger.sendErrorEvent({eventName:"DeltaManagerEventHandlerException",name:"string"==typeof e?e:void 0},t),this.close((0,Jo.cQ)(t))})),this.serviceProvider=e,this.logger=t,this._active=n,this.pending=[],this.currentlyProcessingOps=!1,this.minSequenceNumber=0,this.lastQueuedSequenceNumber=0,this.lastObservedSeqNumber=0,this.lastProcessedSequenceNumber=0,this.noOpCount=0,this.lastClientSequenceNumber=0,this.opsSize=0,this.initSequenceNumber=0,this._closed=!1,this._disposed=!1,this.throttlingIdSet=new Set,this.timeTillThrottling=0,this.closeAbortController=new AbortController,this.deltaStorageDelayId=(0,ci.A)(),this.deltaStreamDelayId=(0,ci.A)(),this.messageBuffer=[];const o={incomingOpHandler:(e,t)=>{try{this.enqueueMessages(e,t)}catch(e){this.logger.sendErrorEvent({eventName:"EnqueueMessages_Exception"},e),this.close((0,Jo.cQ)(e))}},signalHandler:e=>{for(const t of e)this._inboundSignal.push(t)},reconnectionDelayHandler:(e,t)=>this.emitDelayInfo(this.deltaStreamDelayId,e,t),closeHandler:e=>this.close(e),disconnectHandler:e=>this.disconnectHandler(e),connectHandler:e=>this.connectHandler(e),pongHandler:e=>this.emit("pong",e),readonlyChangeHandler:(e,t)=>{(0,Ko.uk)(this,this.logger,"readonly",e,t)},establishConnectionHandler:e=>this.establishingConnection(e),cancelConnectionHandler:e=>this.cancelEstablishingConnection(e)};this.connectionManager=r(o),this._inbound=new Ni((e=>{this.processInboundMessage(e)})),this._inbound.on("error",(e=>{this.close(Qo.I9.wrapIfUnrecognized(e,"deltaManagerInboundErrorHandler",this.lastMessage))})),this._inboundSignal=new Ni((e=>{if(void 0===this.handler)throw new Error("Attempted to process an inbound signal without a handler attached");this.handler.processSignal({...e,content:JSON.parse(e.content)})})),this._inboundSignal.on("error",(e=>{this.close((0,Jo.cQ)(e))}))}cancelEstablishingConnection(e){this.emit("cancelEstablishingConnection",e)}establishingConnection(e){this.emit("establishingConnection",e)}connectHandler(e){this.refreshDelayInfo(this.deltaStreamDelayId);const t=this.connectionManager.connectionVerboseProps;t.connectionLastQueuedSequenceNumber=this.lastQueuedSequenceNumber,t.connectionLastObservedSeqNumber=this.lastObservedSeqNumber;const n=e.checkpointSequenceNumber;this._checkpointSequenceNumber=n,void 0!==n&&this.updateLatestKnownOpSeqNumber(n),(0,Fo.vA)(0===this.messageBuffer.length,233),this.opsSize=0,this.noOpCount=0,this.emit("connect",e,void 0===n?void 0:this.lastObservedSeqNumber-this.lastSequenceNumber),void 0!==n?n>this.lastQueuedSequenceNumber&&this.fetchMissingDeltas("AfterConnection"):"read"===e.mode&&this.fetchMissingDeltas("AfterReadConnection")}async attachOpHandler(e,t,n,r="none",o=t){if(this.initSequenceNumber=t,this.lastProcessedSequenceNumber=o,this.minSequenceNumber=e,this.lastQueuedSequenceNumber=o,this.lastObservedSeqNumber=o,(0,Fo.vA)(void 0===this.handler,226),this.handler=n,(0,Fo.vA)(!!this.handler,227),(0,Fo.vA)(void 0===this.fetchReason,616),!this._closed){if(this._inbound.resume(),this._inboundSignal.resume(),"none"!==r){const e="cached"===r;await this.fetchMissingDeltasCore(`DocumentOpen_${r}`,e),e&&this.fetchMissingDeltas("PostDocumentOpen")}(0,Fo.vA)(void 0!==this.fetchReason||0===this.pending.length,617)}}connect(e){const t=e.fetchOpsFromStorage??!0;!function(e,t,n){if(e)return!0;const r="string"==typeof n?{eventName:n,category:"error"}:{category:"error",...n};t.send(r)}(void 0!==this.handler||!t,this.logger,"CantFetchWithoutBaseline"),t&&this.fetchMissingDeltas(e.reason.text),this.connectionManager.connect(e.reason,e.mode)}async getDeltas(e,t,n,r,o){const i=this.serviceProvider();if(void 0===i)throw new Error("Delta manager is not attached");let s;if(void 0===this.deltaStorage&&(this.deltaStorage=await i.connectToDeltaStorage()),void 0===t)s=e=>e.sequenceNumber>=this.lastObservedSeqNumber;else{const r=t-1;if(this.lastQueuedSequenceNumber>=r)return void this.logger.sendPerformanceEvent({reason:n,eventName:"ExtraStorageCall",early:!0,from:e,to:t,...this.connectionManager.connectionVerboseProps});s=e=>e.sequenceNumber>=r}const a=new AbortController;let c=!1;const l=e=>{(0,Fo.vA)(e.sequenceNumber===this.lastQueuedSequenceNumber,570),!c&&s(e)&&(a.abort("DeltaManager getDeltas fetch cancelled"),this._inbound.off("push",l))};try{this._inbound.on("push",l),(0,Fo.vA)(null===this.closeAbortController.signal.onabort,488),this.closeAbortController.signal.addEventListener("abort",(()=>a.abort(this.closeAbortController.signal.reason)));const i=this.deltaStorage.fetchMessages(e,t,a.signal,o,n);for(;;){const e=await i.read();if(e.done)break;try{c=!0,r(e.value)}finally{c=!1}}}finally{a.signal.aborted&&this.logger.sendTelemetryEvent({eventName:"DeltaManager_GetDeltasAborted",fetchReason:n,reason:a.signal.reason}),this.closeAbortController.signal.onabort=null,this._inbound.off("push",l),(0,Fo.vA)(!c,649)}}close(e){this._closed||(this._closed=!0,this.connectionManager.dispose(e,!0),this.clearQueues(),this.emit("closed",e))}dispose(e){if(!this._disposed){if(void 0!==e&&!(0,Uo.X)(e))throw new Qo.eb("Error must be a Fluid error");this._disposed=!0,this._closed=!0,this.connectionManager.dispose(e,!1),this.clearQueues(),this.emit("disposed",e),this.removeAllListeners()}}clearQueues(){this.closeAbortController.abort("DeltaManager is closed"),this._inbound.clear(),this._inboundSignal.clear(),this._inbound.pause(),this._inboundSignal.pause(),this.pending=[]}refreshDelayInfo(e){this.throttlingIdSet.delete(e),0===this.throttlingIdSet.size&&(this.timeTillThrottling=0)}disconnectHandler(e){this.messageBuffer.length=0,this.emit("disconnect",e.text,e.error)}emitDelayInfo(e,t,n){const r=Date.now();if(this.throttlingIdSet.add(e),t>0&&r+t>this.timeTillThrottling){this.timeTillThrottling=r+t;const e=fs.wrap(n,t/1e3,this.logger);this.emit("throttled",e)}}comparableMessagePayload(e){return`${e.clientId}-${e.type}-${e.minimumSequenceNumber}-${e.referenceSequenceNumber}-${e.timestamp}`}enqueueMessages(e,t,n=!1){if(void 0===this.handler)return void(this.pending=[...this.pending,...e]);if((0,Fo.vA)(0===this.pending.length||void 0!==this.fetchReason,489),0===e.length)return;const r=e[0].sequenceNumber,o=e[e.length-1].sequenceNumber;if(o>this.lastQueuedSequenceNumber){let i=r-1;const s=i-this.lastQueuedSequenceNumber;let a,c,l=0,u=0;for(const t of e)t.sequenceNumber===i?l++:t.sequenceNumber!==i+1&&(u++,void 0===a&&(a=i+1)),i=t.sequenceNumber;0!==l||0!==u&&!n||s>0&&void 0===this.fetchReason?c="enqueueMessages":void 0!==this.fetchReason&&this.fetchReason!==t&&r<=this.lastQueuedSequenceNumber+1&&o>this.lastQueuedSequenceNumber&&(c="enqueueMessagesExtraFetch"),void 0!==c&&this.logger.sendPerformanceEvent({eventName:c,reason:t,previousReason:this.prevEnqueueMessagesReason,from:r,to:o+1,length:e.length,fetchReason:this.fetchReason,duplicate:l>0?l:void 0,initialGap:0===s?void 0:s,gap:u>0?u:void 0,firstMissing:a,dmInitialSeqNumber:this.initialSequenceNumber,...this.connectionManager.connectionVerboseProps})}this.updateLatestKnownOpSeqNumber(e[e.length-1].sequenceNumber);const i=this.previouslyProcessedMessage?.sequenceNumber;(0,Fo.vA)(void 0===i||i===this.lastQueuedSequenceNumber,236);for(const n of e)if(n.sequenceNumber<=this.lastQueuedSequenceNumber){if(this.previouslyProcessedMessage?.sequenceNumber===n.sequenceNumber){const e=this.comparableMessagePayload(this.previouslyProcessedMessage),t=this.comparableMessagePayload(n);if(e!==t){const r=new jo.OI("Found two messages with the same sequenceNumber but different payloads. Likely to be a service issue",Xr.a.fileOverwrittenInStorage,{clientId:this.connectionManager.clientId,sequenceNumber:n.sequenceNumber,message1:e,message2:t,driverVersion:void 0});this.close(r)}}}else n.sequenceNumber===this.lastQueuedSequenceNumber+1?(this.lastQueuedSequenceNumber=n.sequenceNumber,this.previouslyProcessedMessage=n,this._inbound.push(n)):(this.pending.push(n),this.fetchMissingDeltas(t,n.sequenceNumber));this.prevEnqueueMessagesReason=this.pending.length>0?"unknown":t}processInboundMessage(e){const t=Date.now();(0,Fo.vA)(!this.currentlyProcessingOps,943),this.currentlyProcessingOps=!0,this.lastProcessedMessage=e;const n="string"==typeof e.clientId;if((0,Fo.vA)(null===e.clientId||n,1050),!n&&gs(e)&&e.type!==Mo.Go.NoOp)throw new Qo.EW("Mismatch in clientId",{...(0,Qo.ds)(e),messageType:e.type});if(void 0!==this.connectionManager.clientId&&this.connectionManager.clientId===e.clientId){e.type===Mo.Go.NoOp&&this.noOpCount--;const t=e.clientSequenceNumber-this.lastClientSequenceNumber-1;if(this.noOpCount-=t,this.noOpCount<0)throw new Error(`gap in client sequence number: ${t}`);this.lastClientSequenceNumber=e.clientSequenceNumber}if(this.connectionManager.beforeProcessingIncomingOp(e),this.minSequenceNumber>e.minimumSequenceNumber)throw Qo.I9.create("Invalid MinimumSequenceNumber from service - document may have been restored to previous state","DeltaManager.processInboundMessage",e,{clientId:this.connectionManager.clientId});const r=e.sequenceNumber-e.minimumSequenceNumber;if(r<0||0===r&&null!==e.clientId)throw new Qo.EW("MSN has to be lower than sequence #",(0,Qo.ds)(e));if(this.minSequenceNumber=e.minimumSequenceNumber,e.sequenceNumber!==this.lastProcessedSequenceNumber+1)throw new Qo.EW("Found a non-Sequential sequenceNumber",{...(0,Qo.ds)(e),clientId:this.connectionManager.clientId});if(this.lastProcessedSequenceNumber=e.sequenceNumber,(0,Fo.vA)(this.lastProcessedSequenceNumber<=this.lastObservedSeqNumber,615),void 0===this.handler)throw new Error("Attempted to process an inbound message without a handler attached");this.handler.process(e),this.currentlyProcessingOps=!1;const o=Date.now();this.emit("op",e,o-t)}fetchMissingDeltas(e,t){this.fetchMissingDeltasCore(e,!1,t).catch((e=>{this.logger.sendErrorEvent({eventName:"fetchMissingDeltasException"},e)}))}async fetchMissingDeltasCore(e,t,n){if(void 0===this.fetchReason)if(this._closed)this.logger.sendTelemetryEvent({eventName:"fetchMissingDeltasClosedConnection",reason:e});else if(void 0!==this.handler)try{let r=this.lastQueuedSequenceNumber+1;const o=this.previouslyProcessedMessage?.sequenceNumber;void 0!==o&&((0,Fo.vA)(o===this.lastQueuedSequenceNumber,242),(0,Fo.vA)(r>1,243),r--);const i=`${e}_fetch`;this.fetchReason=i,await this.getDeltas(r,n,i,(e=>{this.refreshDelayInfo(this.deltaStorageDelayId),this.enqueueMessages(e,i)}),t)}catch(e){this.logger.sendErrorEvent({eventName:"GetDeltas_Exception"},e),this.close((0,Jo.cQ)(e))}finally{this.refreshDelayInfo(this.deltaStorageDelayId),this.fetchReason=void 0,this.processPendingOps(e)}else(0,Fo.vA)(0===this.lastQueuedSequenceNumber,619)}processPendingOps(e){if(this._closed)return;(0,Fo.vA)(void 0!==this.handler,620);const t=this.pending.sort(((e,t)=>e.sequenceNumber-t.sequenceNumber));this.pending=[],this.enqueueMessages(t,`${e}_pending`,!0),void 0===this.fetchReason&&this.lastQueuedSequenceNumber<this.lastObservedSeqNumber&&this.fetchMissingDeltas("OpsBehind")}updateLatestKnownOpSeqNumber(e){this.lastObservedSeqNumber<e&&(this.lastObservedSeqNumber=e)}}var vs=s(7325),ys=s(6102),bs=s(9307);const{debug:ws}=ys;class Ss{static mixinDebugLogger(e,t,n){const r=ws(e),o=ws(e);return o.log=function(...e){!0===r.enabled?ws.log(...e):bs.error(...e)},o.enabled=!0,(0,Yr.Z)({namespace:e,loggers:[t,new Ss(r,o)],properties:n,tryInheritProperties:!0})}constructor(e,t){this.debug=e,this.debugErr=t}send(e){const t={...e},n="error"===t.category;let r=n?this.debugErr:this.debug;const o=e.eventName.lastIndexOf(Yr.Hf),i=e.eventName.slice(Math.max(0,o+1));o>0&&(r=r.extend(e.eventName.slice(0,o))),t.eventName=void 0;let s="";s=`tick=${(0,Yr.T0)((0,No.l)())}`;const a=t.stack??"";let c;t.stack=void 0;try{c=JSON.stringify(t)}catch{t.error=void 0,c=JSON.stringify(t)}"{}"===c&&(c=""),n&&(r.enabled=!0),r(`${i} ${c} ${s} ${a}`)}}function Cs(e){if(void 0===e)throw new Error("Object is not a IResolveUrl.")}class ks{constructor(e,t){this.container=e,this.loader=t}async resolve(e){if(e.url.startsWith("/")){Cs(this.container.resolvedUrl);return await this.container.clone({resolvedUrl:{...this.container.resolvedUrl},version:e.headers?.[vs.d.version]??void 0,loadMode:e.headers?.[vs.d.loadMode]},{canReconnect:e.headers?.[vs.d.reconnect],clientDetailsOverride:e.headers?.[vs.d.clientDetails]})}if(void 0===this.loader)throw new Error("Cannot resolve external containers");return this.loader.resolve(e)}}class Es{constructor(e){const{urlResolver:t,documentServiceFactory:n,codeLoader:r,options:o,scope:i,logger:s,configProvider:a,protocolHandlerBuilder:c}=e,l={loaderId:(0,ci.A)(),loaderVersion:Zi},u=(0,Yo.fG)(Ss.mixinDebugLogger("fluid:telemetry",s,{all:l}),Yo.lh.value,a);this.services={urlResolver:t,documentServiceFactory:n,codeLoader:r,options:o??{},scope:!1===o?.provideScopeLoader?{...i}:{...i,ILoader:this},protocolHandlerBuilder:c,subLogger:u.logger},this.mc=(0,Yo.CL)({logger:this.services.subLogger,namespace:"Loader"})}async createDetachedContainer(e,t){return Ds.createDetached({...t,...this.services},e)}async rehydrateDetachedContainerFromSnapshot(e,t){return Ds.rehydrateDetachedFromSnapshot({...t,...this.services},e)}async resolve(e,t){const n=void 0===t?"Resolve":"ResolveWithPendingState";return Yr.Bt.timedExecAsync(this.mc.logger,{eventName:n},(async()=>{return this.resolveCore(e,void 0===(n=t)?void 0:JSON.parse(n));var n}))}async resolveCore(e,t){const n=await this.services.urlResolver.resolve(e);Cs(n);const r=ui(n.url);if(void 0===r)throw new Error(`Invalid URL ${n.url}`);if(void 0!==t){const e=ui(t.url);if(e?.id!==r.id||e?.path.replace(/\/$/,"")!==r.path.replace(/\/$/,"")){const e=`URL ${n.url} does not match pending state URL ${t.url}`;throw new Error(e)}}return e.headers??={},e.headers[vs.d.version]=r.version??e.headers[vs.d.version],this.loadContainer(e,n,t)}async loadContainer(e,t,n){return Ds.load({resolvedUrl:t,version:e.headers?.[vs.d.version]??void 0,loadMode:e.headers?.[vs.d.loadMode],pendingLocalState:n},{canReconnect:e.headers?.[vs.d.reconnect],clientDetailsOverride:e.headers?.[vs.d.clientDetails],...this.services})}}class Ts extends Io.X{constructor(e=2e3,t=50){super(),this.NoopCountFrequency=t,this.opsProcessedSinceOpSent=0,e!==Number.POSITIVE_INFINITY&&(this.timer=new Vi(e,(()=>{0!==this.opsProcessedSinceOpSent&&this.emit("wantsNoop")})))}notifyMessageProcessed(e){Ti(e)&&(this.opsProcessedSinceOpSent++,this.opsProcessedSinceOpSent===this.NoopCountFrequency&&queueMicrotask((()=>{this.opsProcessedSinceOpSent>=this.NoopCountFrequency&&(this.emit("wantsNoop"),(0,Fo.vA)(0===this.opsProcessedSinceOpSent,579))})),void 0!==this.timer&&(1===this.opsProcessedSinceOpSent&&this.timer.restart(),(0,Fo.vA)(this.timer.hasTimer,578)))}notifyDisconnect(){this.opsProcessedSinceOpSent=0}notifyMessageSent(){this.opsProcessedSinceOpSent=0}}var Ps,Ns;!function(e){e[e.NoCaching=0]="NoCaching",e[e.Prefetch=1]="Prefetch"}(Ps||(Ps={})),function(e){e.default="default",e.noCache="noCache"}(Ns||(Ns={}));class Is{constructor(e,t,n,r,o,i,s,a){if(this.pendingLocalState=e,this.storageAdapter=n,this._offlineLoadEnabled=r,this.containerDirty=i,this.supportGetSnapshotApi=s,this.processedOps=[],this.lastSavedOpSequenceNumber=0,this.snapshotRefreshTimeoutMs=864e5,this.mc=(0,Yo.CL)({logger:t,namespace:"serializedStateManager"}),this.snapshotRefreshTimeoutMs=a??this.snapshotRefreshTimeoutMs,this.refreshTimer=new Vi(this.snapshotRefreshTimeoutMs,(()=>this.tryRefreshSnapshot())),e&&e.savedOps.length>0){const t=e.savedOps.length;this.lastSavedOpSequenceNumber=e.savedOps[t-1].sequenceNumber}o.on("saved",(()=>this.updateSnapshotAndProcessedOpsMaybe()))}get offlineLoadEnabled(){return this._offlineLoadEnabled}get refreshSnapshotP(){return this._refreshSnapshotP}addProcessedOp(e){this.offlineLoadEnabled&&(this.processedOps.push(e),this.updateSnapshotAndProcessedOpsMaybe())}async fetchSnapshot(e){if(void 0===this.pendingLocalState){const{baseSnapshot:t,version:n}=await Os(this.mc,this.storageAdapter,this.supportGetSnapshotApi(),e),r=Vo(t);if(this.offlineLoadEnabled){const e=await us(t,this.storageAdapter),n=await wi(this.storageAdapter,r);this.snapshot={baseSnapshot:r,snapshotBlobs:e,snapshotSequenceNumber:n.sequenceNumber},this.refreshTimer.start()}return{baseSnapshot:t,version:n}}{const{baseSnapshot:e,snapshotBlobs:t}=this.pendingLocalState,n=await wi(this.storageAdapter,e);this.snapshot={baseSnapshot:e,snapshotBlobs:t,snapshotSequenceNumber:n.sequenceNumber},this.tryRefreshSnapshot();const r=new Map;for(const[e,n]of Object.entries(t))r.set(e,(0,li.Xg)(n,"utf8"));return{baseSnapshot:{sequenceNumber:this.snapshot.snapshotSequenceNumber,snapshotTree:e,blobContents:r,latestSequenceNumber:void 0,ops:[],snapshotFormatV:1},version:void 0}}}tryRefreshSnapshot(){!0===this.mc.config.getBoolean("Fluid.Container.enableOfflineSnapshotRefresh")&&void 0===this._refreshSnapshotP&&void 0===this.latestSnapshot&&(this._refreshSnapshotP=this.refreshLatestSnapshot(this.supportGetSnapshotApi()),this._refreshSnapshotP.catch((e=>{this.mc.logger.sendTelemetryEvent({eventName:"RefreshLatestSnapshotFailed",error:e})})).finally((()=>{this._refreshSnapshotP=void 0})))}async refreshLatestSnapshot(e){this.latestSnapshot=await async function(e,t,n){return Yr.Bt.timedExecAsync(e.logger,{eventName:"GetLatestSnapshotInfo"},(async()=>{const r=await t.getVersions(null,1,"getLatestSnapshotInfo",Ns.noCache),{baseSnapshot:o}=await Os(e,t,n,r[0]?.id),i=Vo(o),s=Date.now();return{baseSnapshot:i,snapshotBlobs:await us(o,t),snapshotSequenceNumber:(await wi(t,i)).sequenceNumber,snapshotFetchedTime:s}})).catch((()=>{}))}(this.mc,this.storageAdapter,e);const t=Object.keys(this.storageAdapter.loadedGroupIdSnapshots);if(e&&t.length>0){(0,Fo.vA)(void 0!==this.storageAdapter.getSnapshot,2418);const e=await this.storageAdapter.getSnapshot({versionId:void 0,scenarioName:"getLatestSnapshotInfo",cacheSnapshot:!1,loadingGroupIds:t,fetchSource:Ns.noCache});(0,Fo.vA)(void 0!==e,2419)}return this.updateSnapshotAndProcessedOpsMaybe()}updateSnapshotAndProcessedOpsMaybe(){const e=this.latestSnapshot?.snapshotSequenceNumber;if(void 0===e||0===this.processedOps.length||this.processedOps[this.processedOps.length-1].sequenceNumber<this.lastSavedOpSequenceNumber||this.containerDirty())return-1;const t=this.processedOps[0].sequenceNumber,n=this.processedOps[this.processedOps.length-1].sequenceNumber;return e<t?(this.mc.logger.sendTelemetryEvent({eventName:"OldSnapshotFetchWhileRefreshing",snapshotSequenceNumber:e,firstProcessedOpSequenceNumber:t,lastProcessedOpSequenceNumber:n,stashedSnapshotSequenceNumber:this.snapshot?.snapshotSequenceNumber}),this.latestSnapshot=void 0,this.refreshTimer.restart()):e<=n&&(this.processedOps.splice(0,e-t+1),this.snapshot=this.latestSnapshot,this.latestSnapshot=void 0,this.refreshTimer.restart(),this.mc.logger.sendTelemetryEvent({eventName:"SnapshotRefreshed",snapshotSequenceNumber:e,firstProcessedOpSequenceNumber:t,newFirstProcessedOpSequenceNumber:0===this.processedOps.length?void 0:this.processedOps[0].sequenceNumber})),e}setInitialSnapshot(e){if(this.offlineLoadEnabled){(0,Fo.vA)(void 0===this.snapshot,2359),(0,Fo.vA)(void 0!==e,2360);const{baseSnapshot:t,snapshotBlobs:n}=e,r=".protocol"in t.trees?t.trees[".protocol"].blobs.attributes:t.blobs[".attributes"],o=JSON.parse(n[r]);(0,Fo.vA)(0===o.sequenceNumber,2361),this.snapshot={...e,snapshotSequenceNumber:o.sequenceNumber},this.refreshTimer.start()}}async getPendingLocalState(e,t,n,r){return Yr.Bt.timedExecAsync(this.mc.logger,{eventName:"getPendingLocalState",details:{notifyImminentClosure:e.notifyImminentClosure,sessionExpiryTimerStarted:e.sessionExpiryTimerStarted,snapshotSequenceNumber:e.snapshotSequenceNumber,processedOpsSize:this.processedOps.length},clientId:t},(async()=>{if(!this.offlineLoadEnabled)throw new Qo.eb("Can't get pending local state unless offline load is enabled");(0,Fo.vA)(void 0!==this.snapshot,2277);const o=await n.getPendingLocalState({...e,snapshotSequenceNumber:this.snapshot.snapshotSequenceNumber,sessionExpiryTimerStarted:this.snapshot.snapshotFetchedTime}),i={};let s=!1;const a=Object.entries(this.storageAdapter.loadedGroupIdSnapshots);if(a.length>0)for(const[e,t]of a)s=!0,i[e]=hi(t);const c={attached:!0,pendingRuntimeState:o,baseSnapshot:this.snapshot.baseSnapshot,snapshotBlobs:this.snapshot.snapshotBlobs,loadedGroupIdSnapshots:s?i:void 0,savedOps:this.processedOps,url:r.url,clientId:t};return JSON.stringify(c)}))}}async function Os(e,t,n,r){const{snapshot:o,version:i}=n?await async function(e,t,n){const r=await(t.getSnapshot?.({versionId:n})),o=void 0===r?.snapshotTree.id?void 0:{id:r.snapshotTree.id,treeId:r.snapshotTree.id};void 0===r&&void 0!==n?e.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:n}):void 0!==r&&void 0===o?.id&&e.logger.sendErrorEvent({eventName:"getSnapshotFetchedTreeWithoutVersionId",hasVersion:void 0!==o});return{snapshot:r,version:o}}(e,t,r):await async function(e,t,n){const r=await t.getVersions(n??null,1),o=r[0];void 0===o&&void 0!==n&&e.logger.sendErrorEvent({eventName:"NoVersionFoundWhenSpecified",id:n});const i=await t.getSnapshotTree(o)??void 0;void 0===i&&void 0!==o?e.logger.sendErrorEvent({eventName:"getSnapshotTreeFailed",id:o.id}):void 0!==i&&void 0===o?.id&&e.logger.sendErrorEvent({eventName:"getSnapshotFetchedTreeWithoutVersionId",hasVersion:void 0!==o});return{snapshot:i,version:o}}(e,t,r);return(0,Fo.vA)(void 0!==o,2276),{baseSnapshot:o,version:i}}const As="saved";async function Ls(e){if(e.closed)throw new Qo.eb("waitContainerToCatchUp: Container closed");return new Promise(((t,n)=>{const r=e.deltaManager,o=t=>{e.off("closed",o);const r="Container closed while waiting to catch up";n(void 0===t?new Qo.gn(r):(0,Jo.J4)(t,(e=>new Qo.gn(`${r}: ${e}`))))};e.on("closed",o);const i=()=>{(0,Fo.vA)(e.connectionState===Po.CatchingUp||e.connectionState===Po.Connected,205);const n=r.hasCheckpointSequenceNumber,i=r.lastKnownSeqNumber;if((0,Fo.vA)(r.lastSequenceNumber<=i,614),r.lastSequenceNumber===i)return e.off("closed",o),void t(n);const s=a=>{i<=a.sequenceNumber&&(e.off("closed",o),t(n),r.off("op",s))};r.on("op",s)};if(e.connectionState===Po.Connected)return void i();const s=()=>{e.off(Ko.Tg,s),i()};e.on(Ko.Tg,s),e.connectionState===Po.Disconnected&&e.connect()}))}const Fs="summarizer";class Ds extends Xo.o{static async load(e,t){const{version:n,pendingLocalState:r,loadMode:o,resolvedUrl:i}=e,s=new Ds(t,e);return Yr.Bt.timedExecAsync(s.mc.logger,{eventName:"Load",...o},(async e=>new Promise(((t,a)=>{const c={opsBeforeReturn:"cached"},l=r?{...o??c,opsBeforeReturn:void 0}:o??c,u=e=>{a(e??new Qo.gn("Container closed without error during load"))};s.on("closed",u),s.load(n,l,i,r).finally((()=>{s.removeListener("closed",u)})).then((n=>{e.end({...n}),t(s)}),(e=>{const t=(0,Jo.cQ)(e);s.close(t),s.dispose(t),u(t)}))}))),{start:!0,end:!0,cancel:"generic"})}static async createDetached(e,t){const n=new Ds(e);return Yr.Bt.timedExecAsync(n.mc.logger,{eventName:"CreateDetached"},(async e=>(await n.createDetached(t),n)),{start:!0,end:!0,cancel:"generic"})}static async rehydrateDetachedFromSnapshot(e,t){const n=new Ds(e);return Yr.Bt.timedExecAsync(n.mc.logger,{eventName:"RehydrateDetachedFromSnapshot"},(async e=>{const r=function(e){const t=JSON.parse(e);if(n=t,void 0!==n?.attached&&void 0!==n?.baseSnapshot&&void 0!==n?.snapshotBlobs&&void 0!==n?.hasAttachmentBlobs)return t;if(Ho(t)){const{baseSnapshot:e,snapshotBlobs:n}=gi(t);return{attached:!1,baseSnapshot:e,snapshotBlobs:n,hasAttachmentBlobs:void 0!==t.tree[".hasAttachmentBlobs"]}}throw new Qo.eb("Cannot rehydrate detached container. Incorrect format");var n}(t);return await n.rehydrateDetachedFromSnapshot(r),n}),{start:!0,end:!0,cancel:"generic"})}setLoaded(){if("loading"===this._lifecycleState){this._lifecycleState="loaded",(0,Fo.vA)(this.connectionState!==Po.Connected,2409),this.connectionStateHandler.initProtocol(this.protocolHandler);const e=this.readOnlyInfo.readonly??!1;this.setContextConnectedState(!1,e);const t=this._deltaManager.connectionManager;if(t.connected){const e=t.connectionDetails;(0,Fo.vA)(void 0!==e,2410),this.connectionStateHandler.receivedConnectEvent(e)}}}get closed(){return"closing"===this._lifecycleState||"closed"===this._lifecycleState||this.disposed}get loaded(){return"loaded"===this._lifecycleState}get disposed(){return"disposing"===this._lifecycleState||"disposed"===this._lifecycleState}get runtime(){if(void 0===this._runtime)throw new Error("Attempted to access runtime before it was defined");return this._runtime}get protocolHandler(){if(void 0===this._protocolHandler)throw new Error("Attempted to access protocolHandler before it was defined");return this._protocolHandler}get connectionMode(){return this._deltaManager.connectionManager.connectionMode}get resolvedUrl(){return this.service?.resolvedUrl}get readOnlyInfo(){return this._deltaManager.readOnlyInfo}get containerMetadata(){return this._containerMetadata}forceReadonly(e){this._deltaManager.connectionManager.forceReadonly(e)}get deltaManager(){return this._deltaManager}get connectionState(){return this.connectionStateHandler.connectionState}get connected(){return this.connectionStateHandler.connectionState===Po.Connected}get clientId(){return this.protocolHandler.audience.getSelf()?.clientId}get isInteractiveClient(){return this.deltaManager.clientDetails.capabilities.interactive}supportGetSnapshotApi(){return!0===this.mc.config.getBoolean("Fluid.Container.UseLoadingGroupIdForSnapshotFetch2")&&!0===this.service?.policies?.supportGetSnapshotApi}getSpecifiedCodeDetails(){return this.getCodeDetailsFromQuorum()}getLoadedCodeDetails(){return this._loadedCodeDetails}get audience(){return this.protocolHandler.audience}get isDirty(){return this._dirtyContainer}async getEntryPoint(){if(this._disposed)throw new Qo.eb("The context is already disposed");return void 0!==this._runtime?this._runtime.getEntryPoint?.():new Promise(((e,t)=>{const n=()=>{(0,Fo.vA)(void 0!==this._runtime,1443),e(this._runtime.getEntryPoint?.()),this._lifecycleEvents.off("disposed",r)},r=()=>{t(new Error("ContainerContext was disposed")),this._lifecycleEvents.off("runtimeInstantiated",n)};this._lifecycleEvents.once("runtimeInstantiated",n),this._lifecycleEvents.once("disposed",r)}))}constructor(e,t){super(((e,t)=>{this.mc.logger.sendErrorEvent({eventName:"ContainerEventHandlerException",name:"string"==typeof e?e:void 0},t),this.close((0,Jo.cQ)(t))})),this._lifecycleState="loading",this.inboundQueuePausedFromInit=!0,this.connectionCount=0,this.connectionTransitionTimes=[],this._dirtyContainer=!1,this.attachmentData={state:ao.d.Detached},this.clientsWhoShouldHaveLeft=new Set,this._containerMetadata={},this.setAutoReconnectTime=(0,No.l)(),this._lifecycleEvents=new Io.X,this.verifyClosedAfterCalls=0,this._disposed=!1,this.attach=bi((async(e,t)=>{await Yr.Bt.timedExecAsync(this.mc.logger,{eventName:"Attach"},(async()=>{if("loaded"!==this._lifecycleState||this.attachmentData.state===ao.d.Attached)throw new Qo.eb(`The Container is not in a valid state for attach [${this._lifecycleState}] and [${this.attachState}]`);const n=e=>{const t=(0,Jo.cQ)(e);return this.close(t),t.addTelemetryProperties({resolvedUrl:this.service?.resolvedUrl?.url}),t};let r=(async({detachedBlobStorage:e,createOrGetStorageService:t,setAttachmentData:n,createAttachmentSummary:r,offlineLoadEnabled:o,initialAttachmentData:i})=>{let s=i;void 0===s.blobs&&(s=void 0!==e&&e.size>0?{state:ao.d.Detached,blobs:"outstanding",redirectTable:new Map}:{state:ao.d.Attaching,summary:r(),blobs:"none"},n(s));const a=await t(s.summary);if("outstanding"===s.blobs){const{redirectTable:t}=s;for((0,Fo.vA)(!!e,590);t.size<e.size;){const n=e.getBlobIds().filter((e=>!t.has(e)));for(const r of n){const n=await e.readBlob(r),o=await a.createBlob(n);t.set(r,o.id)}}n(s={state:ao.d.Attaching,summary:r(t),blobs:"done"})}(0,Fo.vA)(s.state===ao.d.Attaching,2274),"done"===s.blobs&&await a.uploadSummaryWithContext(s.summary,{referenceSequenceNumber:0,ackHandle:void 0,proposalHandle:void 0});const c=o?gi(s.summary):void 0;return n(s={state:ao.d.Attached}),c})({initialAttachmentData:this.attachmentData,offlineLoadEnabled:this.serializedStateManager.offlineLoadEnabled,detachedBlobStorage:this.detachedBlobStorage,setAttachmentData:e=>{const t=this.attachmentData.state;this.attachmentData=e;const r=this.attachmentData.state;if(r!==t&&r!==ao.d.Detached)try{this.runtime.setAttachState(r),this.emit(r.toLocaleLowerCase())}catch(e){throw n(e)}},createAttachmentSummary:e=>{try{return(0,Fo.vA)(0===this._deltaManager.inbound.length,214),di(this.runtime.createSummary(e),this.captureProtocolSummary())}catch(e){throw n(e)}},createOrGetStorageService:async t=>{if(void 0===this.service){const n=await this.urlResolver.resolve(e);(0,Fo.vA)(this.client.details.type!==Fs&&void 0!==n,708),this.service=await zo((async()=>this.serviceFactory.createContainer(t,n,this.subLogger,!1)),"containerAttach",this.mc.logger,{cancel:this._deltaManager.closeAbortController.signal})}return this.storageAdapter.connectToService(this.service),this.storageAdapter}});!0!==this.mc.config.getBoolean("Fluid.Container.RetryOnAttachFailure")&&(r=r.catch((e=>{throw n(e)})));const o=await r;this.serializedStateManager.setInitialSnapshot(o),this.closed||(this.detachedBlobStorage?.dispose?.(),this.handleDeltaConnectionArg(t?.deltaConnection,{fetchOpsFromStorage:!1,reason:{text:"createDetached"}}))}),{start:!0,end:!0,cancel:"generic"})})),this.getAbsoluteUrl=async e=>{var t;if(void 0!==this.resolvedUrl)return this.urlResolver.getAbsoluteUrl(this.resolvedUrl,e,(t=this._loadedCodeDetails,{name:Oo(t?.package)?t?.package.name:t?.package}))},this.metadataUpdateHandler=e=>{this._containerMetadata={...this._containerMetadata,...e},this.emit("metadataUpdate",e)},this.updateDirtyContainerState=e=>{this._dirtyContainer!==e&&(this._dirtyContainer=e,this.emit(e?"dirty":As))};const{canReconnect:n,clientDetailsOverride:r,urlResolver:o,documentServiceFactory:i,codeLoader:s,options:a,scope:c,subLogger:l,protocolHandlerBuilder:u}=e;this.connectionTransitionTimes[Po.Disconnected]=(0,No.l)();const d=t?.pendingLocalState;this._canReconnect=n??!0,this.clientDetailsOverride=r,this.urlResolver=o,this.serviceFactory=i,this.codeLoader=s,this.options={...a},this.scope=c,this.protocolHandlerBuilder=u??((e,t,n)=>new Mi(e,t,n,new Si,(e=>this.clientsWhoShouldHaveLeft.has(e)))),this.clone=async(t,n)=>Ds.load(t,{...e,...n}),this._containerId=(0,ci.A)(),this.client=Ds.setupClient(this._containerId,a.client,this.clientDetailsOverride);const p=this.client.details.type,h=this.client.details.capabilities.interactive,f=`${h?"interactive":"noninteractive"}${void 0!==p&&""!==p?`/${p}`:""}`;this.subLogger=(0,Yr.pW)({logger:l,properties:{all:{clientType:f,containerId:this._containerId,docId:()=>this.resolvedUrl?.id,containerAttachState:()=>this.attachState,containerLifecycleState:()=>this._lifecycleState,containerConnectionState:()=>Po[this.connectionState],serializedContainer:void 0!==d},error:{dmInitialSeqNumber:()=>this._deltaManager?.initialSequenceNumber,dmLastProcessedSeqNumber:()=>this._deltaManager?.lastSequenceNumber,dmLastKnownSeqNumber:()=>this._deltaManager?.lastKnownSeqNumber,containerLoadedFromVersionId:()=>this._loadedFromVersion?.id,containerLoadedFromVersionDate:()=>this._loadedFromVersion?.date,dmLastMsqSeqNumber:()=>this.deltaManager?.lastMessage?.sequenceNumber,dmLastMsqSeqTimestamp:()=>this.deltaManager?.lastMessage?.timestamp,dmLastMsqSeqClientId:()=>null===this.deltaManager?.lastMessage?.clientId?"null":this.deltaManager?.lastMessage?.clientId,dmLastMsgClientSeq:()=>this.deltaManager?.lastMessage?.clientSequenceNumber,connectionStateDuration:()=>(0,No.l)()-this.connectionTransitionTimes[this.connectionState]}}}),this.mc=(0,Yo.CL)({logger:this.subLogger,namespace:"Container"}),this._deltaManager=this.createDeltaManager(),this.connectionStateHandler=Qi({logger:this.mc.logger,mc:(0,Yo.Ln)(l),connectionStateChanged:(e,t,n)=>{this.logConnectionStateChangeTelemetry(e,t,n),this.loaded&&this.propagateConnectionState(e===Po.Disconnected?n:void 0)},shouldClientJoinWrite:()=>this._deltaManager.connectionManager.shouldJoinWrite(),maxClientLeaveWaitTime:a.maxClientLeaveWaitTime,logConnectionIssue:(e,t,n)=>{const r=this.connectionMode;if(this._deltaManager.logConnectionIssue({eventName:e,mode:r,category:"loading"===this._lifecycleState?"generic":t,duration:(0,No.l)()-this.connectionTransitionTimes[Po.CatchingUp],...void 0===n?{}:{details:JSON.stringify(n)}}),(0,Fo.vA)(this.loaded,2411),"read"===r&&"error"===t){const e={text:"NoJoinSignal"};this.disconnectInternal(e),this.connectInternal({reason:e,fetchOpsFromStorage:!1})}},clientShouldHaveLeft:e=>{this.clientsWhoShouldHaveLeft.add(e)},onCriticalError:e=>{this.close((0,Jo.cQ)(e))}},this.deltaManager,d?.clientId),this.on(As,(()=>{this.connectionStateHandler.containerSaved()}));const g=this.mc.config.getBoolean("Fluid.Container.summarizeProtocolTree2");this.detachedBlobStorage=this.attachState===ao.d.Attached?void 0:function(){const e=[];return{createBlob:async t=>({id:""+(e.push(t)-1)}),readBlob:async t=>e[Number(t)]??Promise.reject(new Error(`Blob not found: ${t}`)),get size(){return e.length},getBlobIds:()=>e.map(((e,t)=>`${t}`)),dispose:()=>e.splice(0),serialize:()=>e.length>0?JSON.stringify(e.map((e=>(0,li.JR)(e,"utf8")))):void 0,initialize:t=>e.push(...t.map((e=>(0,li.Xg)(e,"utf8"))))}}(),this.storageAdapter=new ss(this.detachedBlobStorage,this.mc.logger,d?.snapshotBlobs,d?.loadedGroupIdSnapshots,(e=>!0===Ho(e)?e:di(e,this.captureProtocolSummary())),g);const m=(this.isInteractiveClient&&this.mc.config.getBoolean("Fluid.Container.enableOfflineLoad"))??!0===a.enableOfflineLoad;this.serializedStateManager=new Is(d,this.subLogger,this.storageAdapter,m,this,(()=>this._deltaManager.connectionManager.shouldJoinWrite()),(()=>this.supportGetSnapshotApi()),this.mc.config.getNumber("Fluid.Container.snapshotRefreshTimeoutMs"));"object"==typeof document&&null!==document&&"function"==typeof document.addEventListener&&null!==document.addEventListener&&h&&(this.lastVisible=document.hidden?(0,No.l)():void 0,this.visibilityEventHandler=()=>{document.hidden?this.lastVisible=(0,No.l)():setTimeout((()=>{this.lastVisible=void 0}),0)},document.addEventListener("visibilitychange",this.visibilityEventHandler))}getQuorum(){return this.protocolHandler.quorum}dispose(e){this.verifyClosedAfter((()=>this._deltaManager.dispose(e)))}close(e){this.verifyClosedAfter((()=>this._deltaManager.close(e)))}verifyClosedAfter(e){this.verifyClosedAfterCalls++;try{e()}finally{this.verifyClosedAfterCalls--}0===this.verifyClosedAfterCalls&&((0,Fo.vA)(this.connectionState===Po.Disconnected,207),(0,Fo.vA)("closed"===this._lifecycleState||"disposed"===this._lifecycleState,788))}closeCore(e){(0,Fo.vA)(!this.closed,789);try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerClose",category:"loading"!==this._lifecycleState&&void 0!==e?"error":"generic"},e),this._lifecycleState="closing",void 0!==this.service?.off&&this.service?.off("metadataUpdate",this.metadataUpdateHandler),this._protocolHandler?.close(),this.connectionStateHandler.dispose()}catch(e){this.mc.logger.sendErrorEvent({eventName:"ContainerCloseException"},e)}this.emit("closed",e),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="closed",this.client.details.type===Fs&&this.dispose(e)}}disposeCore(e){(0,Fo.vA)(!this._disposed,1356),this._disposed=!0;try{try{this.mc.logger.sendTelemetryEvent({eventName:"ContainerDispose",category:this.closed||void 0===e?"generic":"error"},e),"closed"!==this._lifecycleState&&(this._lifecycleState="disposing"),this._protocolHandler?.close(),this.connectionStateHandler.dispose();const t=void 0===e?void 0:new Error(e.message);this._runtime?.dispose(t),this.storageAdapter.dispose(),this.service?.dispose(e)}catch(e){this.mc.logger.sendErrorEvent({eventName:"ContainerDisposeException"},e)}this.emit("disposed",e),this.removeAllListeners(),void 0!==this.visibilityEventHandler&&document.removeEventListener("visibilitychange",this.visibilityEventHandler)}finally{this._lifecycleState="disposed",this._lifecycleEvents.emit("disposed")}}async closeAndGetPendingLocalState(e){const t=await this.getPendingLocalStateCore({notifyImminentClosure:!0,stopBlobAttachingSignal:e});return this.close(),t}async getPendingLocalState(){return this.getPendingLocalStateCore({notifyImminentClosure:!1})}async getPendingLocalStateCore(e){if(this.closed||this._disposed)throw new Qo.eb("Pending state cannot be retried if the container is closed or disposed");(0,Fo.vA)(this.attachmentData.state===ao.d.Attached,209),(0,Fo.vA)(void 0!==this.resolvedUrl&&"fluid"===this.resolvedUrl.type,210);return await this.serializedStateManager.getPendingLocalState(e,this.clientId,this.runtime,this.resolvedUrl)}get attachState(){return this.attachmentData.state}serialize(){if(this.attachmentData.state===ao.d.Attached||this.closed)throw new Qo.eb("Container must not be attached or closed.");const e=this.attachmentData.state===ao.d.Attaching?this.attachmentData:void 0,t=e?.summary??di(this.runtime.createSummary(),this.captureProtocolSummary()),{baseSnapshot:n,snapshotBlobs:r}=gi(t),o=void 0===e?void 0:this.runtime.getPendingLocalState();(0,Fo.vA)(!(0,Do.$)(o),2275);const i={attached:!1,baseSnapshot:n,snapshotBlobs:r,pendingRuntimeState:o,hasAttachmentBlobs:void 0!==this.detachedBlobStorage&&this.detachedBlobStorage.size>0,attachmentBlobs:this.detachedBlobStorage?.serialize()};return JSON.stringify(i)}setAutoReconnectInternal(e,t){if(this._deltaManager.connectionManager.reconnectMode===e)return;const n=(0,No.l)(),r=n-this.setAutoReconnectTime;this.setAutoReconnectTime=n,this.mc.logger.sendTelemetryEvent({eventName:e===ki.Enabled?"AutoReconnectEnabled":"AutoReconnectDisabled",connectionMode:this.connectionMode,connectionState:Po[this.connectionState],duration:r}),this._deltaManager.connectionManager.setAutoReconnect(e,t)}connect(){if(this.closed)throw new Qo.eb("The Container is closed and cannot be connected");if(this.attachState!==ao.d.Attached)throw new Qo.eb("The Container is not attached and cannot be connected");this.connected||this.connectInternal({reason:{text:"DocumentConnect"},fetchOpsFromStorage:!1})}connectInternal(e){(0,Fo.vA)(!this.closed,709),(0,Fo.vA)(this.attachState===ao.d.Attached,710);const t=ki.Enabled;this.setAutoReconnectInternal(t,e.reason),this.resumeInternal(e)}disconnect(){if(this.closed)throw new Qo.eb("The Container is closed and cannot be disconnected");this.disconnectInternal({text:"DocumentDisconnect"})}disconnectInternal(e){(0,Fo.vA)(!this.closed,711);const t=ki.Disabled;this.setAutoReconnectInternal(t,e)}resumeInternal(e){(0,Fo.vA)(!this.closed,217),this.inboundQueuePausedFromInit&&((0,Fo.vA)(this.loaded,2412),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume()),this.connectToDeltaStream(e)}async proposeCodeDetails(e){if(!Ao(e))throw new Error("Provided codeDetails are not IFluidCodeDetails");if(this.codeLoader.IFluidCodeDetailsComparer){const t=await this.codeLoader.IFluidCodeDetailsComparer.compare(e,this.getCodeDetailsFromQuorum());if(void 0!==t&&t<=0)throw new Error("Proposed code details should be greater than the current")}return this.protocolHandler.quorum.propose("code",e).then((()=>!0)).catch((()=>!1))}async processCodeProposal(){const e=this.getCodeDetailsFromQuorum();if(await Promise.all([this._deltaManager.inbound.pause(),this._deltaManager.inboundSignal.pause()]),!0===await this.satisfies(e))return this._deltaManager.inbound.resume(),void this._deltaManager.inboundSignal.resume();const t=new Qo.gn("Existing context does not satisfy incoming proposal");this.close(t)}async satisfies(e){if(void 0===this._loadedModule)return!1;const t=[],n=this.codeLoader;void 0!==n.IFluidCodeDetailsComparer&&t.push(n.IFluidCodeDetailsComparer);const r=this._loadedModule?.module.fluidExport;if(void 0!==r?.IFluidCodeDetailsComparer&&t.push(r.IFluidCodeDetailsComparer),0===t.length)return!1;for(const n of t){if(!1===await n.satisfies(this._loadedModule?.details,e))return!1}return!0}connectToDeltaStream(e){this._canReconnect&&this.client.details.capabilities.interactive||(e.mode="write"),this._deltaManager.connect(e)}async createDocumentService(e){const t=await e();return void 0!==t.on&&t.on("metadataUpdate",this.metadataUpdateHandler),t}async load(e,t,n,r){const o={phase1:(0,No.l)()};this.service=await this.createDocumentService((async()=>this.serviceFactory.createDocumentService(n,this.subLogger,this.client.details.type===Fs)));const i={reason:{text:"DocumentOpen"},mode:!0===this.mc.config.getBoolean("Fluid.Container.ForceWriteConnection")||(r?.savedOps.length??0)>0?"write":"read",fetchOpsFromStorage:!1};void 0===t.deltaConnection&&this.connectToDeltaStream(i),this.storageAdapter.connectToService(this.service),this.attachmentData={state:ao.d.Attached},o.phase2=(0,No.l)();const{baseSnapshot:s,version:a}=await this.serializedStateManager.fetchSnapshot(e),c=Vo(s);this._loadedFromVersion=a;const l=await wi(this.storageAdapter,c),u=r?.savedOps[r.savedOps.length-1]?.sequenceNumber??l.sequenceNumber;let d;switch(t.opsBeforeReturn){case void 0:this.attachDeltaManagerOpHandler(l,"none"===t.deltaConnection?"none":"all",u);break;case"cached":case"all":d=this.attachDeltaManagerOpHandler(l,t.opsBeforeReturn,u);break;default:(0,xo.$)(t.opsBeforeReturn)}await this.initializeProtocolStateFromSnapshot(l,this.storageAdapter,c),(0,Fo.vA)(void 0===this.clientId,2413),void 0!==r?.clientId&&this.protocolHandler.audience.setCurrentClientId(r?.clientId),o.phase3=(0,No.l)();const p=this.getCodeDetailsFromQuorum();if(await this.instantiateRuntime(p,c,r?r?.pendingRuntimeState??{}:void 0,Wo(s)?s:void 0),r){for(const e of r.savedOps)this.processRemoteMessage({...e,metadata:{...e.metadata,savedOp:!0}}),await(this.runtime.notifyOpReplay?.(e));r.savedOps=[],this.storageAdapter.clearPendingState()}if(this.closed||(void 0!==d&&(this._deltaManager.inbound.resume(),await Yr.Bt.timedExecAsync(this.mc.logger,{eventName:"WaitOps"},(async()=>d)),await Yr.Bt.timedExecAsync(this.mc.logger,{eventName:"WaitOpProcessing"},(async()=>this._deltaManager.inbound.waitTillProcessingDone())),this._deltaManager.inbound.pause()),this.setLoaded(),this.handleDeltaConnectionArg(t.deltaConnection)),this.closed)throw new Error("Container was closed while load()");return o.end=(0,No.l)(),this.subLogger.sendTelemetryEvent({eventName:"LoadStagesTimings",details:JSON.stringify(o)},void 0,Lo.$.verbose),{sequenceNumber:l.sequenceNumber,version:a?.id,dmLastProcessedSeqNumber:this._deltaManager.lastSequenceNumber,dmLastKnownSeqNumber:this._deltaManager.lastKnownSeqNumber}}async createDetached(e){const t={sequenceNumber:0,minimumSequenceNumber:0};await this.attachDeltaManagerOpHandler(t);const n=[["code",{key:"code",value:e,approvalSequenceNumber:0,commitSequenceNumber:0,sequenceNumber:0}]];this.initializeProtocolState(t,{members:[],proposals:[],values:n}),await this.instantiateRuntime(e,void 0),this.setLoaded()}async rehydrateDetachedFromSnapshot({baseSnapshot:e,snapshotBlobs:t,hasAttachmentBlobs:n,attachmentBlobs:r,pendingRuntimeState:o}){n&&(void 0!==r&&((0,Fo.vA)(void 0!==this.detachedBlobStorage,2958),function(e,t){(0,Fo.vA)(0===e.size,2462);const n=JSON.parse(t);(0,Fo.vA)(Array.isArray(n),2463),e.initialize(n)}(this.detachedBlobStorage,r)),(0,Fo.vA)(void 0!==this.detachedBlobStorage&&this.detachedBlobStorage.size>0,592));const i=vi(e,t);this.storageAdapter.loadSnapshotFromSnapshotBlobs(t);const s=await wi(this.storageAdapter,i);await this.attachDeltaManagerOpHandler(s);const a=mi(i),c=await(0,Go.P)(this.storageAdapter,a.blobs.quorumValues);this.initializeProtocolState(s,{members:[],proposals:[],values:c});const l=this.getCodeDetailsFromQuorum();await this.instantiateRuntime(l,i,o),this.setLoaded()}async initializeProtocolStateFromSnapshot(e,t,n){const r={members:[],proposals:[],values:[]};if(void 0!==n){const e=mi(n);[r.members,r.proposals,r.values]=await Promise.all([(0,Go.P)(t,e.blobs.quorumMembers),(0,Go.P)(t,e.blobs.quorumProposals),(0,Go.P)(t,e.blobs.quorumValues)])}this.initializeProtocolState(e,r)}initializeProtocolState(e,t){const n=this.protocolHandlerBuilder(e,t,((e,t)=>this.submitMessage(Mo.Go.Propose,JSON.stringify({key:e,value:t})))),r=(0,Yr.pW)({logger:this.subLogger,namespace:"ProtocolHandler"});n.quorum.on("error",(e=>{r.sendErrorEvent(e)})),n.quorum.on("addProposal",(e=>{"code"!==e.key&&"code2"!==e.key||this.emit("codeDetailsProposed",e.value,e)})),n.quorum.on("approveProposal",((e,t,n)=>{"code"!==t&&"code2"!==t||(Ao(n)||this.mc.logger.sendErrorEvent({eventName:"CodeProposalNotIFluidCodeDetails"}),this.processCodeProposal().catch((e=>{const t=(0,Jo.cQ)(e);throw this.close(t),e})))})),this._protocolHandler=n}captureProtocolSummary(){const e=this.protocolHandler.snapshot();return{tree:{attributes:{content:JSON.stringify(this.protocolHandler.attributes),type:Ro.Z.Blob},quorumMembers:{content:JSON.stringify(e.members),type:Ro.Z.Blob},quorumProposals:{content:JSON.stringify(e.proposals),type:Ro.Z.Blob},quorumValues:{content:JSON.stringify(e.values),type:Ro.Z.Blob}},type:Ro.Z.Tree}}getCodeDetailsFromQuorum(){const e=(e=>e.get("code")??e.get("code2"))(this.protocolHandler.quorum);return e}static setupClient(e,t,n){const r=void 0===t?{details:{capabilities:{interactive:!0}},mode:"read",permission:[],scopes:[],user:{id:""}}:ai(t);return void 0!==n&&(r.details={...r.details,...n,capabilities:{...r.details.capabilities,...n?.capabilities}}),r.details.environment=[r.details.environment,` loaderVersion:${Zi}`,` containerId:${e}`].join(";"),r}activeConnection(){return this.connectionState===Po.Connected&&"write"===this.connectionMode}createDeltaManager(){const e=()=>this.service,t=new ms(e,(0,Yr.pW)({logger:this.subLogger,namespace:"DeltaManager"}),(()=>this.activeConnection()),(t=>new $i(e,(()=>this.isDirty),this.client,this._canReconnect,(0,Yr.pW)({logger:this.subLogger,namespace:"ConnectionManager"}),t)));return t.inbound.pause(),t.inboundSignal.pause(),t.on("connect",((e,t)=>{(0,Fo.vA)(this.connectionMode===e.mode,1207),this.loaded&&this.connectionStateHandler.receivedConnectEvent(e)})),t.on("establishingConnection",(e=>{this.connectionStateHandler.establishingConnection(e)})),t.on("cancelEstablishingConnection",(e=>{this.connectionStateHandler.cancelEstablishingConnection(e)})),t.on("disconnect",((e,t)=>{this.noopHeuristic?.notifyDisconnect();const n={text:e,error:t};this.loaded?this.connectionStateHandler.receivedDisconnectEvent(n):this.closed||this.connectionStateHandler.cancelEstablishingConnection(n)})),t.on("throttled",(e=>{const t=e;!0!==t.logged&&this.mc.logger.sendTelemetryEvent({eventName:"ContainerWarning"},t),this.emit("warning",t)})),t.on("readonly",(e=>{this.loaded&&this.setContextConnectedState(this.connectionState===Po.Connected,e),this.emit("readonly",e)})),t.on("closed",(e=>{this.closeCore(e)})),t.on("disposed",(e=>{this.disposeCore(e)})),t}async attachDeltaManagerOpHandler(e,t,n){return this._deltaManager.attachOpHandler(e.minimumSequenceNumber,e.sequenceNumber,{process:e=>this.processRemoteMessage(e),processSignal:e=>{this.processSignal(e)}},t,n)}logConnectionStateChangeTelemetry(e,t,n){const r=(0,No.l)();this.connectionTransitionTimes[e]=r;const o=r-this.connectionTransitionTimes[t];let i,s,a,c;e===Po.Disconnected?s=this._deltaManager.connectionManager.reconnectMode:e===Po.Connected?(i=r-this.connectionTransitionTimes[Po.Disconnected],i=(0,Yr.T0)(i)):e===Po.CatchingUp&&(a=this.deltaManager.lastKnownSeqNumber,this.deltaManager.hasCheckpointSequenceNumber&&this.loaded&&(c=a-this.deltaManager.lastSequenceNumber)),this.mc.logger.sendPerformanceEvent({eventName:`ConnectionStateChange_${Po[e]}`,from:Po[t],duration:o,durationFromDisconnected:i,reason:n?.text,connectionCount:this.connectionCount,pendingClientId:this.connectionStateHandler.pendingClientId,clientId:this.connectionStateHandler.clientId,autoReconnect:s,opsBehind:c,online:jo.WA[(0,jo.sc)()],lastVisible:void 0===this.lastVisible?void 0:(0,No.l)()-this.lastVisible,checkpointSequenceNumber:a,quorumSize:this._protocolHandler?.quorum.getMembers().size,audienceSize:this._protocolHandler?.audience.getMembers().size,isDirty:this.isDirty,...this._deltaManager.connectionProps},n?.error),e===Po.Connected&&this.connectionCount++}propagateConnectionState(e){const t=this.connectionState===Po.Connected;if(t){const e=this.connectionStateHandler.clientId;(0,Fo.vA)(void 0!==e,2414),this.protocolHandler.audience.setCurrentClientId(e)}this.connectionState!==Po.Connected&&this.connectionState!==Po.Disconnected||(this.setContextConnectedState(t,this.readOnlyInfo.readonly??!1),this.protocolHandler.setConnectionState(t,this.clientId),(0,Ko.aX)(this.mc.logger,this,t,this.clientId,e?.text))}submitContainerMessage(e,t,n,r){switch(e){case Mo.Go.Operation:return this.submitMessage(e,JSON.stringify(t),n,r);case Mo.Go.Summarize:return this.submitSummaryMessage(t);default:{const t=new Qo.gn("invalidContainerSubmitOpType",void 0,{messageType:e});return this.close(t),-1}}}submitBatch(e,t){let n=-1;for(const r of e)n=this.submitMessage(Mo.Go.Operation,r.contents,!0,r.metadata,r.compression,t);return this._deltaManager.flush(),n}submitSummaryMessage(e,t){return void 0===e.details&&(e.details={}),e.details.includesProtocolTree=this.storageAdapter.summarizeProtocolTree,this.submitMessage(Mo.Go.Summarize,JSON.stringify(e),!1,void 0,void 0,t)}submitMessage(e,t,n,r,o,i){return this.connectionState!==Po.Connected?(this.mc.logger.sendErrorEvent({eventName:"SubmitMessageWithNoConnection",type:e}),-1):(this.noopHeuristic?.notifyMessageSent(),this._deltaManager.submit(e,t,n,r,o,i))}processRemoteMessage(e){const t=this.clientId===e.clientId,n=this.protocolHandler.processMessage(e,t);if(this.runtime.process(e,t),this.serializedStateManager.addProcessedOp(e),this.activeConnection()){if(void 0===this.noopHeuristic){const e=this.deltaManager.serviceConfiguration;(0,Fo.vA)(void 0!==e,740),this.noopHeuristic=new Ts(e.noopTimeFrequency,e.noopCountFrequency),this.noopHeuristic.on("wantsNoop",(()=>{(0,Fo.vA)(this.activeConnection(),577),this.submitMessage(Mo.Go.NoOp)}))}this.noopHeuristic.notifyMessageProcessed(e),!0===n.immediateNoOp&&this.submitMessage(Mo.Go.Accept)}this.emit("op",e)}submitSignal(e,t){this._deltaManager.submitSignal(JSON.stringify(e),t)}processSignal(e){if(function(e){if(null===e.clientId){const t=e.content;return t.type===Ri.Clear||t.type===Ri.ClientJoin||t.type===Ri.ClientLeave}return!1}(e))this.protocolHandler.processSignal(e);else{const t=this.clientId===e.clientId;this.runtime.processSignal(e,t)}}async instantiateRuntime(e,t,n,r){(0,Fo.vA)(!1!==this._runtime?.disposed,221);const o=this.scope,i=new ks(this,o.ILoader),s=await Yr.Bt.timedExecAsync(this.subLogger,{eventName:"CodeLoad"},(async()=>this.codeLoader.load(e)));this._loadedModule={module:s.module,details:s.details??e};const a=this._loadedModule.module.fluidExport,c=a?.IRuntimeFactory;if(void 0===c)throw new Error("Code package does not implement IRuntimeFactory");const l=void 0!==t,u=new ns(this.options,this.scope,t,this._loadedFromVersion,this._deltaManager,this.storageAdapter,this.protocolHandler.quorum,this.protocolHandler.audience,i,((e,t,n,r)=>this.submitContainerMessage(e,t,n,r)),((e,t)=>this.submitSummaryMessage(e,t)),((e,t)=>this.submitBatch(e,t)),((e,t)=>this.submitSignal(e,t)),(e=>this.dispose(e)),(e=>this.close(e)),this.updateDirtyContainerState,this.getAbsoluteUrl,(()=>this.resolvedUrl?.id),(()=>this.clientId),(()=>this.attachState),(()=>this.connected),this._deltaManager.clientDetails,l,this.subLogger,n,r),d=await Yr.Bt.timedExecAsync(this.subLogger,{eventName:"InstantiateRuntime"},(async()=>c.instantiateRuntime(u,l)));!function(e,t){const n=(0,Yi.yi)(ts,e);if(!n.isCompatible){const r=new Qo.eb("Loader is not compatible with Runtime",{errorDetails:JSON.stringify({loaderVersion:es.pkgVersion,runtimeVersion:e?.pkgVersion,loaderGeneration:es.generation,runtimeGeneration:e?.generation,minSupportedGeneration:ts.minSupportedGeneration,isGenerationCompatible:n.isGenerationCompatible,unsupportedFeatures:n.unsupportedFeatures})});throw t(r),r}}(d.ILayerCompatDetails,(e=>this.dispose(e))),this._runtime=d,this._lifecycleEvents.emit("runtimeInstantiated"),this._loadedCodeDetails=e}setContextConnectedState(e,t){!1===this._runtime?.disposed&&this.loaded&&this.runtime.setConnectionState(e&&!t,this.clientId)}handleDeltaConnectionArg(e,t){switch((0,Fo.vA)(this.loaded,2415),e){case void 0:t&&this.connectToDeltaStream(t);case"delayed":(0,Fo.vA)(this.inboundQueuePausedFromInit,838),this.inboundQueuePausedFromInit=!1,this._deltaManager.inbound.resume(),this._deltaManager.inboundSignal.resume();break;case"none":break;default:(0,xo.$)(e)}}}var xs=s(4411);class Rs extends l.EventEmitter{emit(e,...t){return super.emit(e,...t)}trackContainerEvents(){this.container.audience.on("addMember",this.addMemberEventHandler),this.container.audience.on("removeMember",this.removeMemberEventHandler),this.container.on("connected",this.connectedEventHandler),this.container.on("disconnected",this.disconnectedEventHandler),this.container.on("dirty",this.dirtyEventHandler),this.container.on("saved",this.savedEventHandler),this.container.on("readonly",this.readonlyEventHandler),this.container.on("closed",this.closedEventHandler),this.container.on("disposed",this.disposedEventHandler),this.container.on("warning",this.waringEventHandler)}trackComponentEvents(){const e=this.component.Lifecycle??this.component.ComponentLifecycle;e?.on("dirty",this.dirtyEventHandler),e?.on("readonlyChanged",this.readonlyEventHandler)}removeContainerListeners(){this.container.audience.off("addMember",this.addMemberEventHandler),this.container.audience.off("removeMember",this.removeMemberEventHandler),this.container.off("connected",this.connectedEventHandler),this.container.off("disconnected",this.disconnectedEventHandler),this.container.off("dirty",this.dirtyEventHandler),this.container.off("saved",this.savedEventHandler),this.container.off("readonly",this.readonlyEventHandler),this.container.off("closed",this.closedEventHandler),this.container.off("disposed",this.disposedEventHandler),this.container.off("warning",this.waringEventHandler)}removeComponentListeners(){const e=this.component.Lifecycle??this.component.ComponentLifecycle;e?.off("dirty",this.dirtyEventHandler),e?.off("readonlyChanged",this.readonlyEventHandler)}get ComponentLifecycle(){return this}get disposed(){return this.container.disposed||this._disposed}get isDirty(){return this._isDirty}get isReadOnly(){const e=this.component.Lifecycle??this.component.ComponentLifecycle;return(this.container.readOnlyInfo.readonly||e?.isReadOnly)??!1}getReadonly(){const e=this.component.Lifecycle??this.component.ComponentLifecycle;return e?.getReadonly?.()??{isReadOnly:this.isReadOnly}}get Lifecycle(){return this}async waitForAllData(){await Ls(this.container)}updateLastCachedTimestamp(){this._isDirty=!1,this.lastCachedTimestamp=Date.now()}get Disposable(){return this}dispose(){this._disposed||(this._disposed=!0,this.component.Disposable?.dispose(),this.logger&&(0,Ut.Ot)(this.logger,{eventName:"ComponentDisposed",isDirty:this.isDirty,attachState:this.container.attachState,componentCriticalError:this.componentCriticalError?.name,componentCriticalErrorMessage:this.componentCriticalError?.message,connectionState:this.container.connectionState,lastDisconnectReason:this.lastDisconnectReason,lastCachedTimestamp:this.lastCachedTimestamp,lastEditedTimestamp:this.lastEditedTimestamp,isOnline:navigator.onLine}),this.container.dispose())}get ConnectionManager(){return this}get isConnected(){return this.container.connectionState===Po.Connected}connect(){this.container.connect()}disconnect(){this.container.disconnect()}get CollaboratorInfo(){return this}get clientId(){return this.container.clientId}getMembers(){const e=new Map;return this.container.audience.getMembers().forEach(((t,n)=>{const r=t.user;e.set(n,{id:r.id,name:r.name,email:r.email,joinTime:t.timestamp,isGuest:r.isGuest,mode:t.mode})})),e}get FluidMetadataProvider(){return this}getCodeDetails(){return this.container.getLoadedCodeDetails()}getSnapshot(){return this.container.serialize()}get LoopComponentUrl(){return this}async initializeLoopComponentUrl(e){if(!e)throw new Error("File name is required to initialize component url.");const t=await this.documentServiceFactoryProviderPromise;if(!t?.getCreateDocumentRequest)throw new Error("FluidDocumentServiceFactoryProvider.getCreateDocumentRequest is required to initialize component url");const n=await t.getCreateDocumentRequest(e);await this.container.attach(n)}async getLoopComponentUrl(){const e=this.documentUrl?this.documentUrl:await this.container.getAbsoluteUrl("/");if(e)return new URL(e)}get FluidShareLinkInfo(){return this}getShareLink(){const e=this.container.resolvedUrl;if(e&&(0,xs.g2)(e))return e.shareLinkInfo}constructor(e,t,n,r,o){super(),this.container=e,this.documentUrl=t,this.documentServiceFactoryProviderPromise=n,this.component=r,this.logger=o,this.addMemberEventHandler=()=>{this.emit("membersChanged",!0)},this.removeMemberEventHandler=()=>{this.emit("membersChanged",!1)},this.connectedEventHandler=()=>{this.emit("connected")},this.disconnectedEventHandler=e=>{this.emit("disconnected",e),this.lastDisconnectReason=e},this.dirtyEventHandler=()=>{this._isDirty=!0,this.emit("dirty"),this.lastEditedTimestamp=Date.now()},this.savedEventHandler=()=>{this._isDirty=!1,this.emit("saved")},this.readonlyEventHandler=()=>{this.emit("readonlyChanged",this.getReadonly().isReadOnly)},this.closedEventHandler=e=>{this.emit("error",e),this.componentCriticalError=e},this.disposedEventHandler=()=>{this.removeContainerListeners(),this.removeComponentListeners(),this.removeAllListeners(),this.dispose(),this.emit("disposed")},this.waringEventHandler=e=>{this.emit("warning",e)},this.trackContainerEvents(),this.trackComponentEvents(),this.container.forceReadonly&&(this.setReadonly=(e,t)=>{if(t){const t=this.component.Lifecycle??this.component.ComponentLifecycle;t?.setReadonly?.(e,!0)}else this.container.forceReadonly?.(e)}),this._disposed=!1,this._isDirty=void 0!==this.component.Lifecycle?.isDirty?this.container.isDirty||this.component.Lifecycle.isDirty:this.container.isDirty}}function Ms(e,t,n,r,o,i){const s={};let a;const c={Disposable:"Disposable",...n};t&&(a=new Rs(t,o,r,e,i));for(const t of Object.keys(c)){const n=a&&t in a?{value:a[t]}:{value:e[t]};Object.defineProperty(s,t,n)}return s}var _s=s(5373);async function Us(e,t,n,r){let o="/";if(r){const e=await t.resolve({url:r.url});if(!e)throw new Error(`Get undefined for resolvedUrl with ${r.url}`);const n=ui(function(e){try{const t=new URL(e);if("fluid-odsp:"===t.protocol)return t.protocol="https",t.href}catch{}return e}(e.url));void 0!==n&&(o=`${n.path}${n.query}`)}const i={url:o,headers:n},s=await(e.getEntryPoint?.());if(s){const e={status:200,mimeType:"fluid/object",value:s};if("/"===i.url||""===i.url)return e;const t=await(s.UrlRouterFetcher?.getUrlRouter());return await(t?.request(_s.X.create(i)))??e}const a=e.runtime?.request;if(a&&"function"==typeof a)return a(i);throw new Error("Could not invoke the request via the legacy back-compat path: `container.runtime.request` not found.")}var js=s(7900);async function zs(e,t,n,r,o,i,s,a,c){const l=Vt.m.start(Fr,r,{addUserTiming:!0,isAPerformanceMetric:!0}),u=Zt();let d;try{d=await async function(e,t,n,r,o,i,s){const a=Vt.m.start(Dr,r,{addUserTiming:!0});let c;if(o){const r={...n?.headers,wait:!1,externalRequest:!1};if(c=await Us(e,t,r,n),404===c.status){To(e);const r={...n?.headers,externalRequest:!1};c=await Us(e,t,r,n)}}else{const r={...n?.headers,externalRequest:!1};c=await Us(e,t,r,n)}if(200!==c.status||"fluid/component"!==c.mimeType&&"fluid/object"!==c.mimeType||!c.value){const e=new to(`Component not found: status=${c.status}, value=${c.value}`,void 0,c.status,c.stack),t={externalRequest:!1,mimeType:c.mimeType};throw a.setResult(!1,t,e),e}const l=c.value;if(a.setResult(!0),s){const t=i?.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Ms(l,e,s,t?.FluidDocumentServiceFactoryProvider,n?.url,r)}return l}(e,t,n,r,s,a)}catch(e){return function(e){tn(u),l.setResult(!1,void 0,e)}(e),Promise.reject(e)}const p=d.ComponentTelemetryMetadata,h=p?.entityName,f=void 0===d.IFluidLoadable?.handle?void 0:(0,js.Fz)(d.IFluidLoadable.handle).absolutePath,g=en(u,!0),m=en(i);if(l.setResult(!0,{...o,componentType:h,componentUrl:f,documentEverHidden:m>-1,documentHidden:g>-1}),s&&function(e,t,n){void 0===n||n<=0?To(e):Promise.race([(0,co.c)(n),t]).then((()=>{setTimeout((()=>{To(e)}),50)})).catch((()=>{}))}(e,void 0,0),c){const t=a?.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Ms(d,e,c,t?.FluidDocumentServiceFactoryProvider,n?.url,r)}return d}const qs="@ms/office-fluid-container",Bs="@ms/onenote-meetings",$s="@ms/whiteboard-container",Hs="@fluidx/loop-page-container";function Ws(e){return Pn(an(e??"Prod").audience)}function Vs(e){const t=an(e??"Prod");return n=t.audience,Tn[n];var n}function Gs(e,t,n,r){const o=t.preload.manifest,i=[...o.assets];if(o.localizedAssets){const e=c(n),t=o.localizedAssets[e];t&&i.push(...t)}Un(e,i.map((e=>`${t.preload.jsBaseUrl}/${e}`)),r)}async function Qs(e,t){const n=t?{logger:t,eventName:"GetCodeLoadDetailsFromNetwork",doNotLogOnSuccess:!0}:void 0,r=await Ln(e,n);if(r.result.ok)return r.result.json();throw new Error(`getCodeLoadDetailsFromNetwork: Failed to fetch: ${e}; StatusCode: ${r.result.status}`)}function Js(e){return!isNaN(e)&&isFinite(e)}function Ks(e,t,n){const r=parseFloat(e);if(!Js(r))return!1;const o=parseFloat(t);return!!Js(o)&&(r<=o||function(e){try{return JSON.parse(e)}catch(e){return[]}}(n).includes(r))}const Xs=(e,t,n,r,o)=>function(e,t,n,r,o){const{getLatestContainerCodeDetails:i,upgradeNeeded:s,preCacheContainerCode:a}=n,c=n=>jt(e,t,n,i,a,(e=>e.fluidCodeDetailsOverride.package),(e=>e.maxUnsupportedContainerScriptVersion),o,r);return{getCodeDetailsPackage:(e,n)=>nn(t,e,n,(e=>c(e).codePackagePromise),(e=>e.fluid.browser.umd.files),r),upgradeNeeded:async(e,n)=>{if(!s)return!1;const o=await s(e,n);return o&&(await $t(t,e,r),c(e)),o},preCacheLatestContainerCode:async e=>await c(e).cacheUpdatePromise}}(e,t,{getLatestContainerCodeDetails:n,preCacheContainerCode:Gs,upgradeNeeded:async(e,t)=>{try{const r=await n(e);return Ks(t,r.maxUnsupportedContainerScriptVersion,r.unsupportedContainerScriptVersions)}catch{return!1}}},r,o),Ys={Automation:"https://whiteboard.office.com",Development:"https://dev.whiteboard.microsoft.com",Dogfood:"https://whiteboard.office.com",DoD:"https://whiteboard.apps.mil",GCC:"https://whiteboard.office.com","GCC-High":"https://whiteboard.office365.us",Local:"https://whiteboard.office.com",Microsoft:"https://whiteboard.office.com",Preview:"https://whiteboard.office.com",Production:"https://whiteboard.office.com",Staging:"https://app.int.whiteboard.microsoft.com",SyntheticTraffic:"https://whiteboard.office.com",USNat:"https://whiteboard.eaglex.ic.gov",USSec:"https://whiteboard.microsoft.scloud",Gallatin:""};const Zs=(e,t,n,r)=>Xs(e,qs,(e=>async function(e,t,n){return Qs(n?`${Vs(e)}/container/versionless/_1cdn_bucketedcontent/officeContainerCodeLoadDetails.json`:`${Ws(e)}/container/versionless/officeContainerCodeLoadDetails.json`,t)}(e,t,r)),t,n);const ea=(e,t,n)=>Xs(e,Hs,(e=>async function(e,t){return Qs(`${Ws(e)}/loop-page-container/versionless/loopPageContainerCodeLoadDetails.json`,t)}(e,t)),t,n),ta=e=>{const t=an(e??"Prod");return n=t.audience,Ys[n];var n},na=e=>Oo(e)&&"string"==typeof e?.fluid?.browser?.umd?.library&&Array.isArray(e?.fluid?.browser?.umd?.files),ra=e=>{switch(e){case Bs:case qs:case"@msstream/experiences-fluid-embed":case"@office-start/space-container":case $s:case Hs:case"@fluidx/copilot-board-container":return e;default:return"(redacted)"}},oa="NPM",ia="CDN";function sa(e,t){return new Promise(((n,r)=>{const o=e.document,i=o.createElement("link");return i.rel="stylesheet",i.type="text/css",i.href=t,i.onload=()=>{n()},i.onerror=()=>r(new Error(`Failed to download the style sheet at url: ${t}, isUserDefinitelyOffline: ${!e.navigator.onLine}`)),o.head.appendChild(i),i}))}let aa=new WeakMap;const ca=e=>"string"==typeof e.package?e.package:e.package.name,la="0.0.1",ua=e=>!Number.isNaN(e)&&Number.isFinite(e),da=e=>{return"string"!=typeof e.package&&(t=e.package,na(t)&&(t.version===la||ua(Number(t.version))))?{name:e.package.name,version:e.package.version===la?la:Number(e.package.version)}:void 0;var t};class pa{get IRuntimeFactory(){return this}instantiateRuntime(e,t){return this.wrappedFactory.configure(this.config),this.wrappedFactory.instantiateRuntime(e,t)}constructor(e,t){this.wrappedFactory=e,this.config=t}}class ha{get IFluidCodeDetailsComparer(){return this}tryFormActualCodeDetailsMapKey(e){const t=da(e);if(void 0!==t)return`${t.version}|${t.name}`}getActualCodeDetails(e){const t=this.tryFormActualCodeDetailsMapKey(e);return void 0===t?void 0:this.actualCodeDetailsMap.get(t)}async load(e){const t=ca(e),n=e.config,r=Vt.m.start("SimpleCodeLoaderLoad",this.logger,{addUserTiming:!0});try{const{windowContext:o,getBundledPackageFactoryOverride:i,disableCdnCodeLoadingFallback:s}=this.config;let a=s?void 0:aa.get(o);const c=a?.get(t);if(void 0!==c){const t=await c,o=t.fluidExport.ConfigurableRuntimeFactory,i=void 0!==o?{module:{fluidExport:new pa(o,n)},details:e}:{module:t,details:e};return r.setResult(!0,{source:"InMemoryCache"}),i}let l=i?.(t);const u=l?"Bundled":"CDN";if(l)l.then((e=>{const n=e.fluidExport,r=n.CodeVersionDetailsProvider?.codeVersionDetails?.version;fa(this.logger,{packageName:t,deliveryType:oa,codeVersion:r})})).catch((()=>{this.logger&&(0,Ut.hO)(this.logger,{eventName:"NpmCodeLoaderOverrideFailed",packageName:ra(t)})}));else{if(s)throw new Error(`CDN code loading fallback set to false but no factory provided by host for container named ${ra(t)}`);this.logger&&(0,Ut.Ot)(this.logger,{eventName:"CodeLoaderFallbackToCDN",containerType:ra(t)}),l=this.loadInternal(e,this.logger)}s||(a||(a=new Map,aa.set(o,a),o!==window&&o.addEventListener("pagehide",(e=>{e.persisted||aa.delete(o)}))),a.set(t,l),l.catch((()=>a?.delete(t))));const d=await l,p=d.fluidExport.ConfigurableRuntimeFactory,h=void 0!==p?{module:{fluidExport:new pa(p,n)},details:e}:{module:d,details:e};return r.setResult(!0,{source:u}),h}catch(e){throw r.setResult(!1,void 0,e),e}}async loadInternal(e,t){const{windowContext:n,trustedTypesPolicy:r,getFluidCodeVersionDetails:o}=this.config;let i;i="allowedCodeOrigins"in this.config?this.config.allowedCodeOrigins:this.config.allowedCodeSources.flatMap((e=>e.origin));const s=await this.getEffectiveFluidCodeDetailsPackage(e);if(fa(t,{packageName:ca(e),deliveryType:ia,codeVersion:s.version}),void 0===s)throw new Error(`Failed to get Fluid Package. Trying to load ContainerType: ${ra(e.package.name)}`);const a=s.fluid.browser.umd;if(!this.shouldLoad(a.files))throw new Error("Unsupported container files, check that CDN is on allow list");const c=this.tryFormActualCodeDetailsMapKey(e);if(void 0!==c&&"string"!=typeof e.package){const t={...e,package:{...e.package,...s}};this.actualCodeDetailsMap.set(c,t)}const l=r&&{trustedTypesPolicy:await r,allowedOrigins:i};await Promise.all(a.files.map((e=>{const t=e.toLowerCase();if(t.endsWith(".js"))return rn(n,e,l,"high");if(t.endsWith(".css"))return((e,t)=>{let n=3;return function r(){return sa(e,t).catch((()=>(n-=1,0===n?sa(e,t):r())))}()})(n,e);throw new Error(`Codeloader does not know how to load: ${e}`)})));const u=n[a.library];if(void 0===u)throw new Error(`Entry point of loaded package not a Fluid module. Trying to load ContainerType: ${ra(e.package.name)}`);const{CodeVersionDetailsProvider:d}=u.fluidExport;if(d){const e=o?.(s);e&&d.setCodeVersionDetails(e)}return u}async preCache(e){const{getFluidCodeDetailsPackageOverride:t,windowContext:n}=this.config;if(t){const r=await t(e);if(r){const e=r.fluid.browser.umd;if(!this.shouldLoad(e.files))throw new Error("Unsupported container files, check that CDN is on allow list");Un(n,e.files,this.logger)}}}async getEffectiveFluidCodeDetailsPackage(e){const t="string"==typeof e.package?e.package:e.package.name,n=await(this.config.getFluidCodeDetailsPackageOverride?.(t))||e.package;if("string"==typeof n)throw new Error("Codeloader does not know how to load from this source");return function(e){if(!na(e)||void 0===e.version)throw new Error("Codeloader does not know how to load from this source")}(n),n}shouldLoad(e){return"allowedCodeOrigins"in this.config?zt(e,this.config.allowedCodeOrigins):qt(e,this.config.allowedCodeSources)}async satisfies(e,t){const n=this.getActualCodeDetails(e);if(void 0===n)return!0;if("string"==typeof t.package||"string"==typeof n.package)return!0;const r=(e=>{const t=Number(e.maxUnsupportedVersion);return ua(t)?t:void 0})(t.package);if(void 0!==r){const e=da(n)?.version;if(void 0!==e)return e===la||e>r}return!0}async compare(e,t){const n=da(e);if(void 0===n)return;const r=da(t);return void 0!==r&&n.name===r.name?n.version===r.version?0:n.version===la?-1:r.version===la?1:n.version-r.version:void 0}constructor(e){this.config=e,this.actualCodeDetailsMap=new Map,this.logger=e.logger}}function fa(e,{packageName:t,deliveryType:n,codeVersion:r}){if(!e)return;const o={eventName:"FluidCodeDetails",subCategory:"FluidCodeDetails",containerType:ra(t),deliveryType:n};r&&(o.codeVersion=r),(0,Ut.Ot)(e,o)}function ga(e){const t=(0,Qn.Ar)()?.AllowListOverride;return t?(e&&(0,Ut.Ot)(e,{eventName:"CodeLoaderAllowListOverwritten",subCategory:"LocalStorageOverride"}),JSON.parse(t)):[]}class ma{get IFluidCodeDetailsComparer(){return this.simpleCodeLoader}getActualCodeDetails(e){return this.simpleCodeLoader.getActualCodeDetails(e)}async preCache(e){if(this.config.locallyBundledPackageFactories?.has(e))return;const t=this.containerCodeDetailsProviderMap.get(e);return t?.preCacheLatestContainerCode?t.preCacheLatestContainerCode(this.config.containerEnvironment):this.simpleCodeLoader.preCache(e)}async load(e){return this.simpleCodeLoader.load(e)}constructor(e){this.config=e;const t=e.additionalAllowedCodeOrigins??[],{windowContext:n,logger:r,localeHint:o,sdpEnabled:i}=this.config,s=r?.NamespaceLogger?new Ke.p("OfficeWebHost",r.NamespaceLogger):r;this.settingsProvider=e.settingsProvider;const a=Zs(n,s,o,i),c=ea(n,s,o),l={getCodeDetailsPackage:e=>{const t=ta(e),n={name:$s,version:"0.0.1",fluid:{browser:{umd:{files:[`${t}/root/index.fluid.js`],library:"microsoftWhiteboard"}}}};return Promise.resolve(n)}};this.containerCodeDetailsProviderMap=new Map([[qs,a],[Bs,a],[Hs,c],[$s,l],["@fluidx/loop-db-container",c]]),e.additionalCodeDetailsProviders?.forEach((([e,t])=>this.containerCodeDetailsProviderMap.set(e,t)));const u=[...ga(s),...t],d=[...kn(this.config.containerEnvironment,this.settingsProvider),{origin:u,paths:void 0}],p={windowContext:e.windowContext,trustedTypesPolicy:e.trustedTypesPolicy,logger:s,getBundledPackageFactoryOverride:t=>{const n=e.locallyBundledPackageFactories?.get(t);return n?Promise.resolve(n):void 0},disableCdnCodeLoadingFallback:e.disableCdnCodeLoadingFallback,getFluidCodeDetailsPackageOverride:async t=>{const n=this.containerCodeDetailsProviderMap.get(t);if(n)return n.getCodeDetailsPackage(e.containerEnvironment,d)},getFluidCodeVersionDetails:t=>{const{containerEnvironment:n}=e,r=t.version,o=this.containerCodeDetailsProviderMap.get(t.name)?.upgradeNeeded;return{version:r,containerEnvironment:n||"Local",needUpgrade:o?()=>o(n,r):async()=>!1}}};this.simpleCodeLoader=new ha({...p,allowedCodeSources:d})}}class va{get FluidCodeLoaderFactory(){return this}get Disposable(){return this}dispose(){}constructor(e){this.bohemiaConfig=e,this.instantiateFluidCodeLoader=async e=>{const t=e.dependencySynthesizer.synthesize({LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy",NamespaceLogger:"NamespaceLogger",SettingsProvider:"SettingsProvider"},void 0),[n,r,o]=await Promise.all([t.LoopTrustedTypesPolicy,t.SettingsProvider,t.NamespaceLogger]);return new ma({...this.bohemiaConfig,windowContext:e.windowContext,trustedTypesPolicy:n,settingsProvider:r,logger:o})}}}var ya=s(5312);class ba{getRawConfig(e){const t=(0,ya.AU)(e,null,this.settingsProvider);return null===t?void 0:t}constructor(e){this.settingsProvider=e}}function wa(e){if("string"!=typeof e.package&&Oo(e.package))return e.package.name}function Sa(e,t){if(!t)return;const n=e?ra(e):"Unknown",r={};r.containerCodeDetailsName=n,t.PersistedProperties?.addPersistedProperties(r)}const Ca="FluidCodeLoaderFactory";function ka(e,t){(async()=>{const n=function(e){if(void 0!==e.getSpecifiedCodeDetails)return e.getSpecifiedCodeDetails();const t=e.getQuorum();return t.getMember("code")??t.getMember("code2")}(e);if(n){const r=t.getActualCodeDetails?.(n);if(r&&t.IFluidCodeDetailsComparer){const o=await t.IFluidCodeDetailsComparer.compare(n,r);void 0!==o&&o<0&&await e.proposeCodeDetails(r)}}})().catch((()=>{}))}function Ea(){const e=(0,Qn.Ar)()?.FluidCodeDetailsOverride;if(void 0!==e)return JSON.parse(e)}async function Ta(e,t,n,r,o,s,a,c){const l=new nt(o);a&&!l.has("NamespaceLogger")&&l.register("NamespaceLogger",new Ke.p(Gr,a));const u={SettingsProvider:"SettingsProvider",FluidCodeLoaderFactory:Ca},d=l.synthesize(u,void 0);let[p,h]=await Promise.all([d.SettingsProvider,d.FluidCodeLoaderFactory]);if(!h){const e=await async function({hostConfig:e,dependencySynthesizer:t}){const n=t.synthesize({SettingsProvider:"SettingsProvider",InternationalizationContext:"InternationalizationContext"},void 0),[r,o]=await Promise.all([n.SettingsProvider,n.InternationalizationContext]),s=cn(e.environment,r?.audience);return new va({containerEnvironment:s,localeHint:o?.uiLocale||i})}({hostConfig:n,dependencySynthesizer:l});l.registerIfNotAlreadyExists(Ca,e),h=e}const f=await h.instantiateFluidCodeLoader({windowContext:e,dependencySynthesizer:l});let g,m;if("Existing"===t.type&&(g=t.containerCodeHint),g){if(a&&(0,Ut.Ot)(a,{eventName:Wr}),void 0===n.loadCodeFromHint||n.loadCodeFromHint){const e=Vt.m.start(Mr,a,{addUserTiming:!0});f.load({package:g}).then((()=>{e.setResult(!0)})).catch((t=>{e.setResult(!1,void 0,t)}))}(function(e){return"preCache"in e&&!!e.preCache})(f)&&(c?.addAdditionalProps({precachedContainerPackageName:ra(g)}),f.preCache(g).catch((e=>{a&&(0,Ut.hO)(a,{eventName:jr},e)})))}p&&(m=new ba(p));const v={urlResolver:await r.urlResolver,documentServiceFactory:await r.documentServiceFactory,options:n.loaderOptions,scope:{IFluidDependencySynthesizer:l},codeLoader:f,logger:s,configProvider:m};return new Es(v)}async function Pa(e,t,n,r,o){const i={[vs.d.loadMode]:{opsBeforeReturn:"cached",deltaConnection:n.startContainerInPausedState?"none":"delayed"}};let s,a;const c=e.services.codeLoader;switch(t.type){case"Existing":{const r=t.containerRequest,o={url:r.url,headers:{...i,...r.headers}};a=t.containerCodeHint,s=e.resolve(o,n.pendingLocalState);break}case"DetachedFromCode":{const n=Ea()||t.codeDetails;a=wa(n),s=e.createDetachedContainer(n);break}case"DetachedFromSnapshot":s=e.rehydrateDetachedContainerFromSnapshot(t.snapshot);break;default:throw new Error("loadContainerProps type is invalid")}return Sa(a,o),s.then((async e=>{!0===n.closeBeforeDisposing&&e.once("closed",(t=>e.dispose(t))),n.startContainerInPausedState||To(e);const i=e.getSpecifiedCodeDetails(),s=i&&wa(i);if("DetachedFromSnapshot"===t.type&&Sa(s,o),r?.addAdditionalProps({containerPackageMatchedCodeHint:a===s}),e.deltaManager.active)ka(e,c);else{const t=()=>{e.deltaManager.active&&(ka(e,c),e.off("connected",t))};e.on("connected",t)}})).catch((()=>{})),s}const Na="ContainerLoadFailed",Ia="ComponentLoadFailedOnContainerBoot";class Oa extends Error{constructor(){super("The container could not be loaded because its hosting window has already been unloaded."),this.name=Hr,this.errorType=Hr}}function Aa(e){switch(e){case"Automation":return 0;case"Local":return 1;case"Staging":return 2;case"Dogfood":return 3;case"Preview":return 4;case"Microsoft":case"SyntheticTraffic":return 5;case"Production":return 6;case"GCC":return 7;case"GCC-High":case"DoD":return 8;default:return}}const La=e=>(0,ya.AU)("owh.handleLocationRedirection",!0,e),Fa=e=>{const t=function(e,t){const n=Aa(e),r=Aa(t??"Production");return void 0!==n&&void 0!==r&&r<=n}("Automation",e?.audience);return(0,ya.AU)("useNestedDependencyContainer",t,e)};function Da(e,t,n,r,o,i,s,a,c,l){const u=new oo,d=new oo;return async function(){const e=Vt.m.start(Ar,i,{addUserTiming:!0}),t={...s,documentEverHidden:en(a)>-1},{driverImplementationOverride:n}=o;if(n)return e.setResult(!0,{...t,driverType:"Override"}),n;const{DriverImplementation:c,FluidDocumentServiceFactoryProvider:l,FluidUrlResolverProvider:u}=r.synthesize({DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider",FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0),[d,p,h]=await Promise.all([c,u?.then((e=>e?.urlResolver)),l?.then((e=>e?.documentServiceFactory))]);if(d)return e.setResult(!0,{...t,driverType:"SynthesizedLegacy"}),d;if(p&&h)return e.setResult(!0,{...t,driverType:"Synthesized"}),{documentServiceFactory:h,urlResolver:p};const f=new Error("Driver unavailable");throw e.setResult(!1,t,f),f}().then((async p=>{const h=xa(e,t,p,n,r,o,i,s,a,c,l);u.resolve(h.containerPromise),d.resolve(h.componentPromise)})).catch((e=>{u.reject(e),d.reject(e)})),{containerPromise:u,componentPromise:d}}function xa(e,t,n,r,o,s,a,c,l,u,d){const p=c.fluidBootstrapperStartTime,h="Existing"!==t.type&&{createNew:"DetachedFromCode"===t.type?"DetachedContainer":t.type};let f=r;const g=h&&{additionalPropsToLog:h}||void 0,m=o.synthesize({InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider"},void 0);Promise.resolve(m.InternationalizationContext).then((e=>{a&&(0,Ut.Ot)(a,{eventName:"HostLocaleContext",subCategory:"HostLocaleContext",uiLanguage:e?.uiLocale||i})})).catch((()=>{}));const v=Vt.m.start(Or,a,{addUserTiming:!0,...g});a&&function(e){const t=navigator?.connection;(0,Ut.Ot)(e,{eventName:"Metadata",subCategory:"browserMetadata",doNotTrack:navigator.doNotTrack?navigator.doNotTrack:"false",documentHidden:document.hidden,networkType:t?.effectiveType,networkRoundTripTime:t?.rtt,cpuCoreCount:navigator.hardwareConcurrency,isMobile:(0,io.Fr)(),timeStamp:Date.now()})}(a);const y=a&&new Eo(a,c,l),b=Vt.m.start(Lr,a,{addUserTiming:!0,additionalPropsToLog:{LoadContainerType:t.type},isAPerformanceMetric:!0}),w=Ta(e,t,s,n,o,y,a,b),S=Promise.all([w,m.SettingsProvider]).then((([e,n])=>{if(La(n)&&"Existing"===t.type){let n=0;return async function(e,t,n,r){let o=t;const i=(0,Yr.pW)({logger:r,namespace:"LocationRedirection"});for(;;)try{return await e(o)}catch(e){if(!Zr(e))throw e;i.sendTelemetryEvent({eventName:"LocationRedirectionError"});const t=e.redirectUrl;o={url:await n.getAbsoluteUrl(t,"",void 0),headers:o.headers}}}((async r=>(n+=1,n>1&&a&&(0,Ut.Ot)(a,{eventName:"LocationRedirectionCallbackCalled",loadContainerAPICounter:n,loadContainerType:t.type}),t.containerRequest=r,f=r,Pa(e,t,s,b,a))),t.containerRequest,e.services.urlResolver,y)}return a&&(0,Ut.hO)(a,{eventName:"LocationRedirectionHandlingError",errorType:"LocationRedirectionHandlingDisabled",loadContainerType:t.type},new Error("Location redirection handling is disabled in the settings provider. And is not using resolveWithLocationRedirectionHandling")),Pa(e,t,s,b,a)})).then((t=>{if(e.closed)throw function(e,t){t&&e.close(),e.dispose()}(t,!0===s.closeBeforeDisposing),new Oa;return t}));S.then((e=>{a&&Co(e,a);const t=en(l),n=b.startTimeSinceEpoch;b.setResult(!0,{...c,offsetFromFluidBootstrapperStartTime:so(n,p),documentEverHidden:t>-1})})).catch((e=>{b.setResult(!1,{errorType:e.errorType},e),v.setResult(!1,{errorType:e.errorType||Na,isUserImpacting:!0},e),a&&yo(a,Or,lo,po,e.errorType||ho,{},e)}));const C=S.then((e=>{if(!e)throw v.setResult(!1),a&&yo(a,Or,lo,po,go),new Error("Failed to Load Container");const t=w.then((t=>zs(e,t.services.urlResolver,f,a,c,l,s.startContainerInPausedState,o)));let n=t;if(d?.fromExistingTemplateUrl){const e=async function(e,t,n,r,o,i){const s=Vt.m.start(xr,r,{addUserTiming:!0});return t.then((async t=>{s.markSubActivityStart("TemplateLoadContainer");const a=await Pa(t,{type:"Existing",containerRequest:{url:e.fromExistingTemplateUrl,headers:e.loadTemplateRequestHeaders}},n,void 0,r);return s.markSubActivityEnd("TemplateLoadContainer"),await Ls(a),s.markSubActivityStart("TemplateLoadComponent"),zs(a,t.services.urlResolver,{url:e.fromExistingTemplateUrl},r,o,i,n.startContainerInPausedState).then((async e=>{if(s.markSubActivityEnd("TemplateLoadComponent"),!e?.ComponentSerializable)throw new eo("Component doesn't implement ComponentSerializable",Br);try{const t=await e.ComponentSerializable.serialize();return s.setResult(!0),t}catch(e){throw new eo("Component serialization failed",$r,e)}})).finally((()=>{a.dispose()}))})).catch((e=>{throw s.setResult(!1,void 0,e),e.name=e.name||zr,e}))}(d,w,s,a,c,l);n=t.then((t=>{const n=t.ComponentSerializable;if(!n)throw new eo("Component doesn't implement ComponentSerializable",Br);let r;return e.then((async e=>{if(r=Vt.m.start(Rr,a,{addUserTiming:!0}),void 0===e)throw new Error(qr);return await n.rehydrate(e),r.setResult(!0),t})).catch((e=>{throw r?.setResult(!1,void 0,e),e}))}))}return n=n.then((t=>{if(u){const n=o.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Ms(t,e,u,n.FluidDocumentServiceFactoryProvider,f?.url,a)}return t})),n.then((()=>{v.setResult(!0)})).catch((t=>{let n;t&&"errorType"in t&&"message"in t&&(n=t),e.dispose(n),v.setResult(!1,{errorType:t.errorType||"Error"!==t.name?t.name:Ia,isUserImpacting:!0,isExpected:no(t)},t),a&&yo(a,Or,lo,po,t.errorType||t.name||ho,{},t)})),n}));return{containerPromise:S,componentPromise:C}}const Ra=new Error("Invalid configuration for driver. Please provide either a driver or а driverImplementationOverride.");function Ma(e,t,n){const r=e||t.driverImplementationOverride||function(e){return e.has("DriverImplementation")||["FluidUrlResolverProvider","FluidDocumentServiceFactoryProvider"].every((t=>e.has(t)))}(n);if(!r)throw Ra}var _a,Ua,ja=s(4826);function za(e){let t=`${e.siteUrl}?driveId=${encodeURIComponent(e.driveId)}&itemId=${encodeURIComponent(e.itemId)}&path=${encodeURIComponent(e.dataStorePath)}`;return e.containerPackageName&&(t+=`&containerPackageName=${encodeURIComponent(e.containerPackageName)}`),e.fileVersion&&(t+=`&fileVersion=${encodeURIComponent(e.fileVersion)}`),t}!function(e){e.isSharingLinkToRedeem="isSharingLinkToRedeem"}(_a||(_a={})),function(e){e.isClpCompliantApp="X-CLP-Compliant-App"}(Ua||(Ua={}));var qa=s(3499);async function Ba(e,t="SHA-1",n="hex"){if(void 0===crypto.subtle)return s.e(482).then(s.bind(s,8289)).then((async r=>r.hashFile(e,t,n)));const r=await async function(e,t){const n=await crypto.subtle.digest(t,e);return new Uint8Array(n)}(e,t);return function(e,t){switch(t){case"hex":return Array.prototype.map.call(e,(e=>e.toString(16).padStart(2,"0"))).join("");case"base64":return qa.fromByteArray(e)}}(r,n)}function $a(e){return e.origin.endsWith("onedrive.com")||e.origin.endsWith("storage.live.com")||e.origin.endsWith("storage.live-int.com")||e.origin.endsWith("onedrive-tst.com")}var Ha=s(9073),Wa=s(7330);function Va(e,t,n,r){const o=r?`versions/${r}/`:"";return`${function(e){let t="_api/";return $a(e)&&(t=""),`${e.origin}/${t}v2.1`}(new URL(e))}/drives/${t}/items/${n}/${o}`}function Ga(e,t,n,r){return`${Va(e,t,n,r)}opStream/snapshots`}function Qa(e,t,n,r){return`${Va(e,t,n,r)}opStream/attachment`}function Ja(e,t,n,r){return`${Va(e,t,n,r)}opStream/attachments`}function Ka(e,t,n,r){return`${Va(e,t,n,r)}opStream`}class Xa{constructor(){}async resolve(e){if(e.headers?.[ja.U.createNew]){const[t,n]=e.url.split("?"),r=new URLSearchParams(n),o=e.headers[ja.U.createNew].fileName,i=r.get("driveId"),s=r.get("path"),a=r.get("containerPackageName");if(!(o&&t&&i&&null!=s))throw new jo.OI("Proper new file params should be there",mo.E.genericError,{driverVersion:Wa.z});return{endpoints:{snapshotStorageUrl:"",attachmentGETStorageUrl:"",attachmentPOSTStorageUrl:"",deltaStorageUrl:""},tokens:{},type:"fluid",odspResolvedUrl:!0,id:"odspCreateNew",url:`https://${t}?${n}&version=null`,siteUrl:t,hashedDocumentId:"",driveId:i,itemId:"",fileName:o,summarizer:!1,codeHint:{containerPackageName:a??void 0},fileVersion:void 0,shareLinkInfo:void 0,isClpCompliantApp:e.headers?.[Ua.isClpCompliantApp]}}const{siteUrl:t,driveId:n,itemId:r,path:o,containerPackageName:i,fileVersion:s}=function(e){const[t,n]=e.split("?"),r=new URLSearchParams(n),o=r.get("driveId"),i=r.get("itemId"),s=r.get("path"),a=r.get("containerPackageName"),c=r.get("fileVersion");if(null===o)throw new Error("ODSP URL did not contain a drive id");if(null===i)throw new Error("ODSP Url did not contain an item id");if(null===s)throw new Error("ODSP Url did not contain a path");return{siteUrl:t,driveId:decodeURIComponent(o),itemId:decodeURIComponent(i),path:decodeURIComponent(s),containerPackageName:a?decodeURIComponent(a):void 0,fileVersion:c?decodeURIComponent(c):void 0}}(e.url),a=await async function(e,t){const n=li.Ss.from(`${e}_${t}`);return encodeURIComponent(await Ba(n,"SHA-256","base64"))}(n,r);(0,Fo.vA)(!a.includes("/"),168);const c=`https://placeholder/placeholder/${a}/${l=o,l.startsWith("/")?l.slice(1):l}`;var l;const u=!!e.headers?.[ja.U.summarizingClient];return{type:"fluid",odspResolvedUrl:!0,endpoints:{snapshotStorageUrl:Ga(t,n,r,s),attachmentPOSTStorageUrl:Qa(t,n,r,s),attachmentGETStorageUrl:Ja(t,n,r,s),deltaStorageUrl:Ka(t,n,r,s)},id:a,tokens:{},url:c,hashedDocumentId:a,siteUrl:t,driveId:n,itemId:r,dataStorePath:o,fileName:"",summarizer:u,codeHint:{containerPackageName:i},fileVersion:s,isClpCompliantApp:e.headers?.[Ua.isClpCompliantApp]}}async getAbsoluteUrl(e,t,n){const r=(0,Ha.Yn)(e);let o,i=t;var s;return""===t&&void 0!==r.dataStorePath&&(i=r.dataStorePath),i.startsWith("/")&&(i=i.slice(1)),n&&"name"in n?o=n.name:(s=n?.package,o="object"==typeof s&&"string"==typeof s?.name&&"object"==typeof s?.fluid?n?.package.name:n?.package),o=o??r.codeHint?.containerPackageName,za({...r,containerPackageName:o,dataStorePath:i})}}class Ya{constructor(e,t){this.expiry=e,this.cleanup=t,this.gcTimeouts=new Map}schedule(e){"indefinite"!==this.expiry.policy&&this.gcTimeouts.set(e,setTimeout((()=>{this.cleanup(e),this.cancel(e)}),this.expiry.durationMs))}cancel(e){const t=this.gcTimeouts.get(e);void 0!==t&&(clearTimeout(t),this.gcTimeouts.delete(e))}update(e){"sliding"===this.expiry.policy&&(this.cancel(e),this.schedule(e))}}class Za{constructor({expiry:e={policy:"indefinite"},removeOnError:t=()=>!0}={}){this.cache=new Map,this.removeOnError=t,this.gc=new Ya(e,(e=>this.remove(e)))}has(e){return this.cache.has(e)}get(e){return this.has(e)&&this.gc.update(e),this.cache.get(e)}remove(e){return this.gc.cancel(e),this.cache.delete(e)}async addOrGet(e,t){let n=this.get(e);if(void 0===n){n=(async()=>t())(),this.cache.set(e,n),n.catch((t=>{this.removeOnError(t)&&this.remove(e)})),this.gc.schedule(e)}return n}add(e,t){const n=this.has(e);return this.addOrGet(e,t).catch((()=>{})),!n}async addValueOrGet(e,t){return this.addOrGet(e,(async()=>t))}addValue(e,t){return this.add(e,(async()=>t))}}function ec(e){return(0,Fo.vA)(!!e,2358),{Authorization:e}}const tc=Symbol("`mockify` mock function key");function nc(e){const t=(...e)=>t[tc](...e);return t[tc]=e,t}nc.key=tc;s(3901);const rc="Odsp409Error";const oc=new Map,ic=nc((async(e,t,n)=>{const r=`${t.siteUrl}_${t.driveId}_${t.itemId}`,o=oc.get(r);if(void 0!==o)return o;const i=async function(){let o;try{let r=0;o=await zo((async()=>async function(e,t,n,r){let o=1e3;const i=(0,No.l)();let s;for(let a=1;;a++){void 0!==r&&r();try{const r=await e();return a>1&&n.sendTelemetryEvent({eventName:"MultipleRetries",callName:t,attempts:a,duration:(0,No.l)()-i},s),r}catch(e){const r=(0,jo.YU)(e),c=!0===e?.[rc],l=e?.errorType===mo.E.serviceReadOnly;if(1===a&&n.sendTelemetryEvent({eventName:`${t}_firstFailed`,callName:t,attempts:a,duration:(0,No.l)()-i},e),!c&&!l||!r)throw e;if(5===a)throw n.sendErrorEvent({eventName:c?"CoherencyErrorTooManyRetries":"ServiceReadonlyErrorTooManyRetries",callName:t,attempts:a,duration:(0,No.l)()-i},e),e.canRetry=!1,e;o=(0,jo.E9)(e)??o,await _o(Math.floor(o)),o+=o/4*(1+Math.random()),s=e}}}((async()=>async function(e,t,n){let r,o=!1;for(let i=1;i<=5;i++)try{const r=await cc(e,t,n),s=new URL(t.siteUrl).origin,a=new URL(r.sharepointIds.siteUrl).origin;return s!==a&&(o=!0,n.sendTelemetryEvent({eventName:"LocationRedirectionErrorForGetOdspFileLink",retryCount:i}),lc(t,a)),await sc(e,t,n,r)}catch(e){if(r=e,(0,Uo.X)(e)&&o&&(e.errorType===mo.E.fileNotFoundOrAccessDeniedError||e.errorType===mo.E.authorizationError))continue;throw e}throw r}(e,t,n)),"getFileLinkCore",n)),"getShareLink",n,{onRetry(e,t){if(r++,5===r){if(void 0!==t&&"object"==typeof t)throw t.canRetry=!1,t;throw t}}})}catch(e){throw oc.delete(r),e}return(0,Fo.vA)(void 0!==o,658),o}();return oc.set(r,i),i}));async function sc(e,t,n,r){return Yr.Bt.timedExecAsync(n,{eventName:"odspFileLink",requestName:"getSharingInformation"},(async o=>{let i,s=0;const a=await(0,Ha.gO)((async o=>{s++;const a=(0,Ha.bJ)(n,t,e),c=`${t.siteUrl}/_api/web/GetFileById(@a1)/ListItemAllFields/GetSharingInformation?@a1=guid${encodeURIComponent(`'${r.sharepointIds.listItemUniqueId}'`)}`,l="POST",u={method:l,headers:{"Content-Type":"application/json;odata=verbose",Accept:"application/json;odata=verbose",...ec(await a({...o,request:{url:c,method:l}},"GetFileLinkCore"))}},d=await(0,Ha.ZR)(c,u);i=d.propsToLog;const p=await d.content.json(),h=p?.d?.directUrl;if("string"!=typeof h)throw new jo.OI("Malformed GetSharingInformation response",mo.E.incorrectServerResponse,{driverVersion:Wa.z});return h}));return o.end({...i,attempts:s}),a}))}const ac=e=>"string"==typeof e.webUrl&&"string"==typeof e.webDavUrl&&"object"==typeof e.sharepointIds;async function cc(e,t,n){return Yr.Bt.timedExecAsync(n,{eventName:"odspFileLink",requestName:"getFileItemLite"},(async r=>{let o,i=0;const s=await(0,Ha.gO)((async r=>{i++;const{siteUrl:s,driveId:a,itemId:c}=t,l=(0,Ha.bJ)(n,t,e),u=`${s}/_api/v2.0/drives/${a}/items/${c}?select=webUrl,webDavUrl,sharepointIds`,d=await l({...r,request:{url:u,method:"GET"}},"GetFileItemLite");(0,Fo.vA)(null!==d,700);const p={method:"GET",headers:ec(d)},h=await(0,Ha.ZR)(u,p);o=h.propsToLog;const f=await h.content.json();if(!ac(f))throw new jo.OI("Malformed getFileItemLite response",mo.E.incorrectServerResponse,{driverVersion:Wa.z});return f}));return r.end({...o,attempts:i}),s}))}function lc(e,t){const n=`${t}${new URL(e.siteUrl).pathname}`;e.siteUrl=n,e.endpoints.attachmentGETStorageUrl&&(e.endpoints.attachmentGETStorageUrl=`${t}${new URL(e.endpoints.attachmentGETStorageUrl).pathname}`),e.endpoints.attachmentPOSTStorageUrl&&(e.endpoints.attachmentPOSTStorageUrl=`${t}${new URL(e.endpoints.attachmentPOSTStorageUrl).pathname}`),e.endpoints.deltaStorageUrl&&(e.endpoints.deltaStorageUrl=`${t}${new URL(e.endpoints.deltaStorageUrl).pathname}`),e.endpoints.snapshotStorageUrl&&(e.endpoints.snapshotStorageUrl=`${t}${new URL(e.endpoints.snapshotStorageUrl).pathname}`)}class uc{constructor(e,t,n,r,o){this.appName=n,this.getContext=r,this.containerPackageInfo=o,this.sharingLinkCache=new Za,this.logger=(0,Ha.bP)(t),e&&(this.shareLinkFetcherProps={...e,tokenFetcher:e.tokenFetcher})}appendDataStorePath(e,t){const n=(0,ct.Mh)(e);if(!n)return;const r=new URL(n.dataStorePath,`${e.protocol}//${e.hostname}`);if(t.startsWith("/?")||t.startsWith("?")){const e=new URLSearchParams(t);for(const[t,n]of e.entries())r.searchParams.append(t,n);n.dataStorePath=`${r.pathname}${r.search}`}else n.dataStorePath=`${r.pathname}${r.pathname.endsWith("/")||t.startsWith("/")?"":"/"}${t}/${r.search}`;return(0,ct.Cu)(e,n),e.href}getKey(e){return`${e.siteUrl},${e.driveId},${e.itemId}`}async resolve(e){const t={headers:e.headers,url:e.url},n=t.headers?.[_a.isSharingLinkToRedeem];try{const n=new URL(e.url),r=(0,ct.Mh)(n);r&&(t.url=za(r))}catch{}const r=await(new Xa).resolve(t);return r.context=await(this.getContext?.(r,r.dataStorePath??"")),r.appName=this.appName,r.codeHint=r.codeHint?.containerPackageName?r.codeHint:{containerPackageName:(0,Ha.nb)(this.containerPackageInfo)},n&&(r.shareLinkInfo=Object.assign(r.shareLinkInfo??{},{sharingLinkToRedeem:this.removeNavParam(e.url)})),r.itemId&&this.getShareLinkPromise(r).catch((()=>{})),r}removeNavParam(e){const t=new URL(e),n=new URLSearchParams(t.search);return n.delete(ct.jC),t.search=n.toString(),t.href}async getShareLinkPromise(e){if(void 0===this.shareLinkFetcherProps)throw new Error("Failed to get share link because share link fetcher props are missing");if(!(e.siteUrl&&e.driveId&&e.itemId))throw new Error("Failed to get share link because necessary information is missing (e.g. siteUrl, driveId or itemId)");const t=this.getKey(e),n=this.sharingLinkCache.get(t);if(n)return n;const r=ic(this.shareLinkFetcherProps.tokenFetcher,e,this.logger).catch((e=>{throw this.logger.sendErrorEvent({eventName:"FluidFileUrlError"},e),this.sharingLinkCache.remove(t),e}));return this.sharingLinkCache.add(t,(async()=>r)),r}async getAbsoluteUrl(e,t,n){const r=(0,Ha.Yn)(e),o=await this.getShareLinkPromise(r);return this.appendLocatorParams(o,e,t,n)}async appendLocatorParams(e,t,n,r){const o=(0,Ha.Yn)(t),i=n||(o.dataStorePath??"");o.context=await(this.getContext?.(o,i));const s=(0,Ha.nb)(r)??o.codeHint?.containerPackageName??(0,Ha.nb)(this.containerPackageInfo);return o.appName=this.appName,(0,Ha.z6)(e,o,i,s)}static createDocumentUrl(e,t){const n=new URL(e);return(0,ct.Cu)(n,t),n.href}}async function dc(e,t){if("Data"!==e.type||"URL"!==e.dataType)return;const n=e.data.url,r=await t;if(!r||r instanceof Xa||r instanceof uc)return function(e){const t=(0,ct.Mh)(e);if(!t)return;let n;try{t?.siteUrl&&(n=new URL(t?.siteUrl).origin)}catch{}return{codeDetailsHint:t?.containerPackageName,criticalBootDomains:n?[n]:void 0}}(n);try{const e=await r.resolve({url:n.href});if("fluid"===e?.type)return{}}catch{}}class pc{async instantiateLoopComponent(e){const{loopCodeLoader:t,dependencySynthesizer:n}=this.props,{registrationId:r}=e;if(!r)throw new Error("registrationId is required.");const o=await t.load({packageName:r}),i=new nt(n);this.logger&&i.register("NamespaceLogger",this.logger);const s="Data"===e.type?{creationData:e,manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:"Creation"===e.type?{creationData:{},manifestData:e.manifestData,componentPersistentInputData:e.componentPersistentInputData,storagePartitionKey:e.storagePartitionKey}:e;return o.module.loopExport.instantiateLoopComponent(s,i)}constructor(e){this.props=e,e.logger&&(this.logger=new Ke.p("LoopLoader",e.logger))}}async function hc(e){const{loopComponentRouterInput:t,windowContextForLoader:n,dependencySynthesizer:r,config:o,logger:s,loopCodeLoaderFactory:a,requiredProviderTypes:c}=e,l=await async function(e,t,n,r,o){const{environment:s}=e,a=n.synthesize({InternationalizationContext:"InternationalizationContext",SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",LoopTrustedTypesPolicy:"LoopTrustedTypesPolicy"},void 0),[c,l,u,d]=await Promise.all([a.InternationalizationContext,a.SettingsProvider,a.TokenProvider,a.LoopTrustedTypesPolicy]),p=c?.uiLocale,h={audience:s?.audience||"Production",localeHint:p||i,settingsProvider:l,windowContext:t,trustedTypesPolicy:d,tokenProvider:u,dependencySynthesizer:n,logger:r},f=await o.instantiateLoopCodeLoader(h);return new pc({loopCodeLoader:f,dependencySynthesizer:n,logger:r})}(o,n,r,s,a),u=await l.instantiateLoopComponent(t);if(c){return Ms(u,void 0,c,r.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0).FluidDocumentServiceFactoryProvider,void 0,s)}return u}async function fc(e){const{windowContextForLoader:t,loopComponentRouterInput:n,dependencySynthesizer:r,config:o={},logger:i,perfMetadata:s,documentHiddenTrackerId:a,fluidRequestHeaders:c}=e,{registrationId:l,manifestData:u}=n;if(l&&!Kr(l)){const e={LoopCodeLoaderFactoryProvider:"LoopCodeLoaderFactoryProvider"},{LoopCodeLoaderFactoryProvider:s}=r.synthesize(e,void 0),a=await s,c=await(a?.getLoopCodeLoaderFactory());if(!c)throw new Error("loopCodeLoaderFactory is required for non-fluid components.");return{component:hc({loopComponentRouterInput:n,windowContextForLoader:t,dependencySynthesizer:r,config:o,logger:i,loopCodeLoaderFactory:c}),container:Promise.resolve(void 0)}}if("Data"===n.type&&"URL"===n.dataType){let e;if(l&&Kr(l)&&(e=u&&"object"==typeof u?u:void 0),e||(e=await dc(n,async function(e){const{dependencySynthesizer:t,config:n}=e;if(n?.driverImplementationOverride)return n.driverImplementationOverride.urlResolver;const r={DriverImplementation:"DriverImplementation",FluidUrlResolverProvider:"FluidUrlResolverProvider"},{DriverImplementation:o,FluidUrlResolverProvider:i}=t.synthesize(r,void 0),[s,a]=await Promise.all([o,i]);return s?.urlResolver??a?.urlResolver}({dependencySynthesizer:r,config:o}))),!e)throw new Error("Failed to create Fluid component from the provided url.");Sa(e.codeDetailsHint,i);const d=function({windowContextForLoader:e,dependencySynthesizer:t,hostConfig:n,logger:r,perfMetadata:o,documentEverHiddenTrackerID:i,containerRequest:s,driver:a,preCheckInfo:c,requiredProviderTypes:l}){Ma(a,n,t);const u={type:"Existing",containerRequest:s,containerCodeHint:c?.codeDetailsHint},{containerPromise:d,componentPromise:p}=a?xa(e,u,a,s,t,n,r,o,i,l,void 0):Da(e,u,s,t,n,r,o,i,l,void 0);return{container:d,component:p}}({windowContextForLoader:t,dependencySynthesizer:r,hostConfig:o,logger:i,perfMetadata:s,documentEverHiddenTrackerID:a,containerRequest:{url:n.data.url.href,headers:c},driver:void 0,preCheckInfo:e});return d}throw new Error("Failed to create component.")}function gc(e){const{windowContextForLoader:t,loopComponentRouterInput:n,dependencySynthesizer:r,config:o,logger:i,perfMetadata:s,documentHiddenTrackerId:a,requiredProviderTypes:c}=e,l={...o},u=l.driverImplementationOverride,d=Vt.m.start(_r,i,{addUserTiming:!0});if("Fluid"===n.type){if(i?.PersistedProperties){const e={isFluid:!0};i.PersistedProperties.addPersistedProperties(e)}const e=wa(n.codeDetails);Sa(e,i);try{if(n.pendingLocalState){const o=function(e,t,n,r,o,i,s){Ma(n,r,t.dependencySynthesizer);const{componentPromise:a,containerPromise:c}=n?xa(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},n,void 0,t.dependencySynthesizer,r,o,i,s,t.requiredProviderTypes,void 0):Da(e,{type:"DetachedFromSnapshot",snapshot:t.snapshot},void 0,t.dependencySynthesizer,r,o,i,s,t.requiredProviderTypes,void 0);return{component:a,container:c}}(t,{dependencySynthesizer:r,snapshot:n.pendingLocalState,requiredProviderTypes:c},u,l,i,s,a);return d.setResult(!0,{packageName:e}),o}const o=function(e,t,n,r,o,i,s){Ma(n,r,t.dependencySynthesizer);const{componentPromise:a,containerPromise:c}=n?xa(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},n,void 0,t.dependencySynthesizer,r,o,i,s,t.requiredProviderTypes,t.loadTemplateProps):Da(e,{type:"DetachedFromCode",codeDetails:t.codeDetails},void 0,t.dependencySynthesizer,r,o,i,s,t.requiredProviderTypes,t.loadTemplateProps);return{component:a,container:c}}(t,{dependencySynthesizer:r,codeDetails:n.codeDetails,loadTemplateProps:n.templateProps,requiredProviderTypes:c},u,l,i,s,a);return d.setResult(!0,{packageName:e}),o}catch(t){throw d.setResult(!1,{packageName:e},t),t}}const p=fc({...e,loopComponentRouterInput:n});if(i?.PersistedProperties){const{registrationId:e}=n,t=!e||Kr(e),r=en(a),o=t?{isFluid:!0,documentEverHidden:r}:{isFluid:!1,loopRegistrationId:e,documentEverHidden:r};i.PersistedProperties.addPersistedProperties(o)}return{component:p.then((async e=>{const[t,o]=await Promise.all([e.container,e.component]);await async function(e,t){e.ComponentInitializer&&(t.markSubActivityStart("ComponentInitialize"),await e.ComponentInitializer.initialize(),t.markSubActivityEnd("ComponentInitialize"))}(o,d);const s=vc(o);i?.PersistedProperties&&s&&i.PersistedProperties.addPersistedProperties({identityName:s}),d.setResult(!0),i&&function(e,t,n){const r=vc(e);r&&!mc.has(r)&&((0,Ut.Ot)(n,{eventName:"LoadComponentMetadata",identityName:r,source:t}),mc.add(r))}(o,"owh-getLoopComponentInternal",i);const a=t&&"Data"===n.type&&"URL"===n.dataType?n.data.url.href:void 0;if(c){const e=r.synthesize({FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"},void 0);return Ms(o,t,c,e.FluidDocumentServiceFactoryProvider,a,i)}return o})).catch((e=>{throw d.setResult(!1,void 0,e),e})),container:p.then((e=>e.container)).catch((e=>{throw d.setResult(!1,void 0,e),e}))}}const mc=new Set;function vc(e){return e.ComponentTelemetryMetadata?.entityName}const yc=new Map;function bc(e,t){t.then((async t=>{t?(t.attachState!==ao.d.Attached&&await new Promise((e=>{t.once("attached",e)})),e.resolve(t.resolvedUrl)):e.resolve(void 0)})).catch((()=>{e.resolve(void 0)}))}function wc(e,t){const n="LoopComponentLoader";if(e.has(n)&&window===t.windowContextForLoader)return e;const r=new nt(e);var o;return r.register(n,(o=t.windowContextForLoader,new Cc(o))),r}function Sc(e,t,n){const r=new nt(e);return r.register("NestedLoopComponentHosting",async function(e,t,n){const r="NestedLoopComponentHosting",o="NestedLoopComponentLoader",i=e.synthesize({SettingsProvider:"SettingsProvider",NestedLoopComponentHosting:r,NestedLoopComponentLoader:o},void 0),a=await i.NestedLoopComponentHosting,c=await i.NestedLoopComponentLoader,l=a?.getNestedDependencyContainer?.bind(a)??c?.getNestedDependencyContainer?.bind(c),u=Fa(await i.SettingsProvider)?function(e,t,n){return r=>{if(!r.has("FluidDocumentServiceFactoryProvider"))return n&&(0,Ut.Ot)(n,{eventName:"NoFluidDocumentServiceFactoryForNestedDependencyContainer"}),t?.(r)??r;const o={SettingsProvider:"SettingsProvider",TokenProvider:"TokenProvider",UserContext:"UserContext"},i=r.synthesize(o,{FluidDocumentServiceFactoryProvider:"FluidDocumentServiceFactoryProvider"}),a=new nt(r),c=e.then((e=>{if(e&&(0,xs.g2)(e))return function(e,t,n){return new Je.I((async()=>{const[r,o,i,a]=await Promise.all([e.FluidDocumentServiceFactoryProvider,e.SettingsProvider,e.TokenProvider,e.UserContext]);return s.e(160).then(s.bind(s,1236)).then((e=>new e.OdspFluidDocumentServiceFactory({hostDocumentServiceFactory:r,settingsProvider:o,tokenProvider:i,userContext:a},t,yc,n)))}))}({FluidDocumentServiceFactoryProvider:i.FluidDocumentServiceFactoryProvider,SettingsProvider:i.SettingsProvider,TokenProvider:i.TokenProvider,UserContext:i.UserContext},e,n);{const t=e?"ResolvedUrlNotOdsp":"ResolvedUrlUndefined";return(0,Ut.A$)(Xe.hB.Generic,n,{eventName:t}),i.FluidDocumentServiceFactoryProvider.then((e=>function({documentServiceFactory:e,createDocumentRequest:t}){return{get FluidDocumentServiceFactoryProvider(){return this},documentServiceFactory:e,getCreateDocumentRequest:t,get Disposable(){return this},dispose:()=>{}}}({documentServiceFactory:e.documentServiceFactory,createDocumentRequest:e.getCreateDocumentRequest})))}}));return a.register("FluidDocumentServiceFactoryProvider",c),t?.(a)??a}}(t,l,n):l;return new kc(u)}(e,t,n)),r}class Cc{dispose(){}get LoopComponentLoader(){return this}get Disposable(){return this}async getLoopComponent({loopComponentRouterInput:e,dependencySynthesizer:t,fluidRequestHeaders:n,requiredProviderTypes:r}){const{logger:o,perfMetadata:i,documentHiddenTrackerId:s}=Qr({logger:await t.synthesize({NamespaceLogger:"NamespaceLogger"},void 0).NamespaceLogger}),a=new oo,c=gc({windowContextForLoader:this.windowContextForLoader,loopComponentRouterInput:e,dependencySynthesizer:Sc(t,a,o),logger:o,perfMetadata:i,documentHiddenTrackerId:s,fluidRequestHeaders:n,requiredProviderTypes:r});return bc(a,c.container),Promise.all([c.container,c.component]).then((([e,t])=>t))}constructor(e){this.windowContextForLoader=e}}class kc{get NestedLoopComponentHosting(){return this}getNestedDependencyContainer(e){return this.getNestedDependencyContainerImpl?this.getNestedDependencyContainerImpl(e):e}dispose(){}get Disposable(){return this}constructor(e){this.getNestedDependencyContainerImpl=e}}const Ec=1e4;class Tc{get NamespaceLogger(){return this}get PersistedProperties(){return this}send(e){this.sendWithNamespace(e,this.namespace)}sendWithNamespace(e,t){const n=t||this.namespace;let{category:r,...o}={...this.persistentProps,...e},i=!1;o.sampleEvent&&(i=Boolean(o.sampleEvent),delete o.sampleEvent);const s=Object.keys(o).length>100;"error"!==r&&"Error"!==r||(o=(e=>{let t;return"string"==typeof e.message&&e.message.length>Ec&&(t="message",e.message=e.message.substr(0,Ec)),"string"==typeof e.stack&&e.stack.length>Ec&&(t=t?t.concat(", stack"):"stack",e.stack=e.stack.substr(0,Ec)),t?{...e,cappedFields:t}:e})(o)),this.logEvent({category:r,props:{...o,exceedsMaxAllowedFields:s},sampleEvent:i,namespace:n})}addPersistedProperties(e){this.persistentProps={...this.persistentProps,...e}}getPersistedProperties(){return{...this.persistentProps}}constructor(e,t){this.namespace=t,this.persistentProps=e||{},this.namespace=t}}var Pc=s(9307);const Nc=new class{logEvent(e){if(e.category===Xe.hB.Error)Pc.error("%cPurple: %cSession_Id:%s %s","color: purple; font-style: italic","",this.sessionId,JSON.stringify(e));else Pc.log("%cPurple: %cSession_Id:%s %s","color: purple; font-style: italic","",this.sessionId,JSON.stringify(e))}setSessionId(e){this.sessionId=e}setUserContext(e){}shutdown(){}loadFull(){return Promise.resolve()}loadAsha(){}constructor(){this.sessionId=""}};var Ic=s(1787);const Oc={Open:"Open",Interruptions:"Interruptions",VetoMissingClassification:"VetoMissingClassification"},Ac="LoadFailed",Lc="UnhandledError",Fc="UnhandledRejection",Dc=[{pillar:Oc.Open,vetos:[Ac]},{pillar:Oc.Interruptions,vetos:[Lc,Fc]}];function xc(e){for(const t of Dc)if(t.vetos.includes(e))return t.pillar;return Oc.VetoMissingClassification}const Rc={token:"6a8929bcfc6d44e9b13fee392ada9cf0-4dea6a88-32c5-404b-8af1-4a43b94ef559-7393",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"},Mc={token:"742fa5a288b045e5beab1a2b8e445a71-66618038-43f3-4a1f-a680-59d90da7d572-7251",directNumericMeasurementToken:"970a2f2bd232416db9f00ce2dc4e0490-505d1603-e4f2-4da4-9ba3-13325ddc1915-7112",namespacePrefix:"Office.Fluid"},_c={token:"954f09bf2c8a4321823cdeae34562b5c-d0886c33-e264-4c84-8ae5-a767e01b42cb-7479",namespacePrefix:"Office.Fluid.Workspaces"};function Uc(e){return function(){let e=!1;try{e=!!localStorage.getItem("FluidCodeDetailsOverride")}catch{}return e}()||function(e){return"Local"===e||"Automation"===e||"SyntheticTraffic"===e}(e)?Mc:Rc}var jc=s(9307);class zc{async logEvent(e){let{namespace:t,category:n,props:r,sampleEvent:o}=e;if(n===Xe.hB.UserAction)this.logUserActionEventToOtel(e);else if(n===Xe.hB.Activity)this.logActivityEventToOtel(e);else if(n===Xe.hB.DNM)this.ariaInfo.directNumericMeasurementToken&&this.logDNMEventToOTel(e);else{if(["AshaPillarAdd","AshaPillarRemove","AshaError"].includes(r.eventName))return this.loadAsha(),void this.ashaUtils?.then((({handleAshaEvent:t})=>t(e))).catch((()=>{this.logDefaultEventToOtel({category:Xe.hB.Error,namespace:t,props:{eventName:`${r.eventName}Failure`},sampleEvent:o})}));n===Xe.hB.Error&&function(e){return"eventName"in e&&"veto"in e}(r)&&(r=function(e){return{...e,pillar:e.pillar??xc(e.veto),isIntentional:e.isIntentional??!1,isInternal:e.isInternal??!0,alertOnPillar:e.alertOnPillar??!0,isSessionEndingError:e.isSessionEndingError??!1}}(r)),this.logDefaultEventToOtel({namespace:t,category:n,props:r,sampleEvent:o})}}shutdown(){this.ashaUtils?.then((({shutdownAshaForFluid:e})=>e())).catch((()=>{this.logDefaultEventToOtel({category:Xe.hB.Error,props:{eventName:"AshaShutdownFailure"}})}))}logDefaultEventToOtel(e){this.logEventToOtelInternal(e,(t=>{this.prepareDefaultOtelEvent(t,e)}))}logActivityEventToOtel(e){this.logEventToOtelInternal(e,(t=>{this.prepareActivityOtelEvent(t,{...e.props})}))}logUserActionEventToOtel(e){this.logEventToOtelInternal(e,(t=>{this.prepareUserActionOtelEvent(t,{...e.props},e.namespace)}))}logDNMEventToOTel(e){const t=e.props.eventName,n=e.props.dataName,r=e.props.dataMeasurement;if("string"!=typeof t||"string"!=typeof n||"number"!=typeof r&&"boolean"!=typeof r)return;const o={eventName:t,dataName:n,dataMeasurement:r,dataType:e.props.dataType,interval:e.props.interval};this.logDirectNumericMeasurementEvent(o)}logDirectNumericMeasurementEvent(e){const t=[];switch(e.dataType){case Xe.Qq.Bool:t.push((0,S.LK)(e.dataName,e.dataMeasurement));break;case Xe.Qq.Double:t.push((0,S.ip)(e.dataName,e.dataMeasurement));break;case Xe.Qq.Int64:t.push((0,S.Ug)(e.dataName,e.dataMeasurement))}if(!e.eventName||0===e.eventName.length)return;const n=e.eventName[0].toUpperCase()+e.eventName.slice(1),r={telemetryProperties:{dnmToken:this.ariaInfo.directNumericMeasurementToken,dnmInterval:e.interval,dnmAllowedPartA:[3,4,5,1]},eventName:"Office.DNM.Loop."+n,eventFlags:{dataCategories:E.DataCategories.ProductServicePerformance,diagnosticLevel:E.DiagnosticLevel.RequiredServiceData},dataFields:t};this.telemetryLogger.sendDirectNumericEvent(r)}getTelemetryConfig(e){const t={enableQueue:!0};return this.isNonProductionAudience(e)?t:{...t,disableValidation:!0}}isNonProductionAudience(e){return"Automation"===e||"Local"===e||"Staging"===e}registerOtelErrorsListener(){(0,v.d$)().addListener((e=>{0===e.category&&0===e.level&&jc.error(e.message())}))}getDataFieldsFromProps(e){const t=[];if(Object.keys(e).forEach((n=>{const r=(0,Ic.R)(e[n],n);r&&t.push(r)})),e.dataFields){const n=e.dataFields;t.push(...n)}return t}logEventToOtelInternal(e,t){const n=this.getBasicOtelEvent(e);t(n),this.telemetryLogger.sendTelemetryEvent(n)}getBasicOtelEvent(e){let t=e.category&&`${e.category.charAt(0).toUpperCase()}${e.category.substring(1)}`;e.props.subCategory&&e.category===Xe.hB.Generic&&(t+=`.${e.props.subCategory.charAt(0).toUpperCase()}${e.props.subCategory.substring(1)}`);let n=!1;return e.sampleEvent&&(n=e.sampleEvent),{eventName:`${this.ariaInfo.namespacePrefix}${e.namespace?"."+e.namespace:""}.${t}`,eventFlags:{diagnosticLevel:E.DiagnosticLevel.RequiredServiceData,samplingPolicy:n?E.SamplingPolicy.Measure:void 0}}}prepareDefaultOtelEvent(e,t){e.eventFlags.dataCategories=E.DataCategories.ProductServicePerformance,e.dataFields=this.getDataFieldsFromProps({...t.props})}mapActivityResultTypeToCode(e){switch(e){case Xe.Tp.Failure:return 0;case Xe.Tp.Success:return 1;case Xe.Tp.Cancelled:return 2}}prepareBaseActivityOtelEvent(e,t,n){t.durationMs||(t.durationMs=0);const r=Math.floor(1e3*t.durationMs),{durationMs:o,succeeded:i,resultType:s,...a}=t;return e.eventContract={name:m.Il.contractName,dataFields:m.Il.getFields({duration:r,count:1,aggMode:0,success:i,result:!n&&s?{code:this.mapActivityResultTypeToCode(s),type:s}:void 0})},a}prepareActivityOtelEvent(e,t){const n=t.eventName;e.eventName+=`.${n.charAt(0).toUpperCase()}${n.substring(1)}`,e.eventFlags.dataCategories=E.DataCategories.ProductServicePerformance;const r=this.prepareBaseActivityOtelEvent(e,t,!1);e.dataFields=this.getDataFieldsFromProps(r||{})}prepareUserActionOtelEvent(e,t,n){const r=t.eventName;e.eventName+=`.${r.charAt(0).toUpperCase()}${r.substring(1)}`,e.eventFlags.dataCategories=E.DataCategories.ProductServiceUsage;const o=m.rh.getFields("Funnel",{name:n,state:"Successful"}),i=t,s=m.ay.getFields({id:i.actionId,name:r,commandSurface:i.commandSurface,parentName:i.parentName,triggerMethod:i.triggerMethod,timeOffsetMs:i.timeOffsetMs}),a=this.prepareBaseActivityOtelEvent(e,t,!0),{eventName:c,actionId:l,commandSurface:u,parentName:d,triggerMethod:p,timeOffsetMs:h,...f}=a;e.dataFields=[...o,...s,...this.getDataFieldsFromProps(f||{})]}loadAsha(){this.ashaLoadStarted||(this.ashaLoadStarted=!0,this.ashaUtils=s.e(941).then(s.bind(s,6990)),this.ashaUtils.then((({initializeAshaForFluid:e})=>e(this.ariaInfo.namespacePrefix,this.initialPersistentProps,(e=>{delete e.eventContract,this.telemetryLogger.sendTelemetryEvent(e)})))).catch((()=>{this.ashaLoadStarted=!1,this.logDefaultEventToOtel({category:Xe.hB.Error,props:{eventName:"AshaLoadFailure"}})})))}constructor(e,t,n){this.initialPersistentProps=t,this.ashaLoadStarted=!1,this.telemetryLogger=new g.GV(void 0,void 0,this.getTelemetryConfig(e)),this.telemetryLogger.partAFields.push((0,S.m9)("Loop.Audience",e)),this.ariaInfo=n?.useFluidWorkspacesAriaInfo?_c:Uc(e),this.telemetryLogger.setTenantToken(this.ariaInfo.namespacePrefix,this.ariaInfo.token,g.di),this.isNonProductionAudience(e)&&this.registerOtelErrorsListener()}}class qc extends zc{setUserContext(e){}replaceTelemetrySink(e){this.hostTelemetrySink=e,this.telemetryLogger.telemetrySinks.pop(),this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}async loadFull(){if(!this.loadFullCalled){this.loadFullCalled=!0;try{const e=await this.hostTelemetrySink;this.telemetryLogger.addSink(e),this.telemetryLogger.flushQueue()}catch(e){this.logDefaultEventToOtel({category:Xe.hB.Error,props:{eventName:"FailedToLoadTelemetrySink",message:`${e}`}})}}}constructor(e,t,n,r){super(t,n,r),this.hostTelemetrySink=e,this.loadFullCalled=!1}}class Bc{get Disposable(){return this}dispose(){}get LoopTelemetrySink(){return this}sendTelemetryEvent(e,t){this.telemetrySink.sendTelemetryEvent(e,t)}sendCustomerContent(e){this.telemetrySink.sendCustomerContent?.(e)}sendNonStandardEvent(e,t){this.telemetrySink.sendNonStandardEvent?.(e,t)}constructor(e){this.telemetrySink=e}}class $c extends zc{getLoopTelemetrySinkPromise(){return this.loopTelemetrySinkPromise.then()}async logEvent(e){return this.allowedToLogEupi||(e.props={...e.props,hostCorrelationId:""}),e.category===Xe.hB.Error&&(this.loadFullCalled||this.loadFull().catch((()=>{}))),super.logEvent(e)}scrubContextIfNecessary(){this.allowedToLogEupi||(this.context.sessionId="",this.context.user=void 0)}setUserContext(e){this.context={...this.context,...e},this.scrubContextIfNecessary(),this.telemetrySink?.setPartADataFields(this.context)}shutdown(){super.shutdown(),this.loadFull().then((()=>this.telemetrySink?.shutdown())).catch((()=>{}))}async loadFull(){this.loadFullCalled||(this.loadFullCalled=!0,s.e(873).then(s.bind(s,4324)).then((e=>{this.telemetrySink=new e.OfficeFluidOneDsSink(this.context);const t=this.telemetrySink.createOneDsSink();this.telemetryLogger.addSink(t),this.telemetryLogger.flushQueue(),this.loopTelemetrySinkPromiseResolve?.(new Bc(t))})).catch((e=>{this.logDefaultEventToOtel({category:Xe.hB.Error,props:{eventName:"LoggerLoadFailure",message:e.message,stack:e.stack}})})))}constructor(e,t){const n=(0,Ut.LJ)(e.audience),r=n?t:{...t,hostCorrelationId:""};super(e.audience,r),this.context=e,this.loadFullCalled=!1,this.allowedToLogEupi=!1,this.loopTelemetrySinkPromise=new Promise((e=>this.loopTelemetrySinkPromiseResolve=e)),this.allowedToLogEupi=n,this.scrubContextIfNecessary()}}var Hc=s(9307);class Wc extends Tc{get Disposable(){return this}get PersistedProperties(){return this}getTelemetrySinkPromise(){return this.telemetrySinkPromise.then()}async loadFull(){try{await Promise.allSettled([this.logProcessors.map((e=>e.loadFull()))])}catch{}}setUserContext(e){this.logProcessors.forEach((t=>t.setUserContext(e)))}logEvent(e){this.logProcessors.forEach((t=>t.logEvent(e)));if("Local"===this.audience){const t="UnhandledError"!==e.props.eventName&&"UnhandledRejection"!==e.props.eventName,n=e.category===Xe.hB.Error||e.category===Xe.hB.Activity&&!1===e.props.succeeded;t&&n&&!this.forceTelemetryToConsole&&Hc.error("OfficeFluidLogger %s %s event:",e.props.eventName,e.category,e.props,e.props.stack)}}addPersistedProperties(e){super.addPersistedProperties(e),s.e(941).then(s.bind(s,6990)).then((({updateAshaAdditionalPartCEventDataFromTelemetryProperties:t})=>t(e))).catch((()=>{this.send({category:"Error",eventName:"AshaUpdatePartCEventDataFailure"})}))}constructor(e){const t=e.hostTelemetryContext,n={...e.persistentProps,hostCorrelationId:t.hostCorrelationId,hostScenarioName:[t.hostScenarioLifecycle,t.hostScenarioName,t.hostScenarioEntryPoint].filter((e=>e)).join("_"),hostName:t.hostName,hostScenarioStartTime:t.hostScenarioStartTime,loopAudience:e.audience,hostSessionId:t.hostSessionId,hostAppVersion:t.hostAppVersion,hostAppPlatform:t.hostAppPlatform};super(n,e.namespace),this.forceTelemetryToConsole=!1,this.dispose=()=>{this.logProcessors.forEach((e=>e.shutdown()))},this.shutdown=()=>{this.Disposable.dispose()};const{delayLoadLogger:r,hostTelemetrySink:o}=e;this.audience=e.audience,this.logProcessors=[...e.additionalLogProcessors||[]];try{this.forceTelemetryToConsole="1"===localStorage.getItem("debugPurple"),this.forceTelemetryToConsole&&(Nc.setSessionId(e.hostTelemetryContext.hostSessionId),this.logProcessors.push(Nc))}catch{}if(o)this.telemetrySinkPromise=Promise.resolve(o).then((e=>new Bc(e))),this.logProcessors.push(new qc(o,this.audience,n,{useFluidWorkspacesAriaInfo:e.useFluidWorkspacesAriaInfo}));else{this.sendWithNamespace({eventName:"HostPassedTelemetrySinkNotPassed",sinkPassed:!1,category:"Error",sampleEvent:!0},"HostPassedTelemetrySink");const r=new $c({appPlatform:t.hostAppPlatform,appName:t.hostAppName,appVersion:t.hostAppVersion,user:t.userContext?.user,sessionId:t.hostSessionId,audience:this.audience,uiLanguage:e.hostTelemetryContext.uiLanguage},n);this.telemetrySinkPromise=r.getLoopTelemetrySinkPromise(),this.logProcessors.push(r)}if(r||this.loadFull().catch((()=>{})),e.hostMetadata&&!e.skipInitializationLogs){const{hostMetadata:t}=e,n=t.hostFlights,r=t.hostFlightsMetadata;this.sendWithNamespace({eventName:"HostMetadata",hostRing:t.hostRing,hostFlights:n&&JSON.stringify(n),hostFlightsMetadata:r&&JSON.stringify(r),category:"Generic"},"HostMetadata")}}}var Vc=s(9307);class Gc{constructor(e){this.telemetryData={},this.activityName=e}finishWithFailure(e){_.Instance.logError(this.activityName,e,this.telemetryData)}finishWithSuccess(){_.Instance.logEvent(this.activityName,this.telemetryData)}addData(e,t){this.telemetryData[e]=t}static async runActivity(e,t){const n=new Gc(e);try{const e=Date.now(),r=await t(n),o=Date.now();return n.addData("Duration",o-e),n.finishWithSuccess(),r}catch(e){throw n.finishWithFailure(e),e}}}var Qc=s(9307);const Jc={HTMLViewable:"HTMLViewable",Disposable:"Disposable",WorkspaceAndPageManager:"WorkspaceAndPageManager",WorkspaceNavigationHandler:"WorkspaceNavigationHandler"},Kc=async(e,t,n,r,o,i,s)=>{var a;const c=((e,t,n,r,o)=>{const i=te.getCorrelationId(),s=te.getSessionId(),a=Date.now();return Vc.log("Host Correlation Id: ",i),Vc.log("Host Session Id: ",s),new Wc({hostTelemetryContext:{hostName:"OneNote",hostAppPlatform:te.getPlatform(),hostAppName:"OneNote",hostCorrelationId:i,hostScenarioLifecycle:null!=t?t:"Load",hostScenarioName:null!=r?r:"Notebook",hostScenarioEntryPoint:null!=n?n:"NotebooksModuleHome",hostScenarioStartTime:null!=o?o:a,hostSessionId:s,hostAppVersion:Office.context.diagnostics.version,userContext:e},hostTelemetrySink:M.Instance,audience:ie()})})(e.getUserContext()),l=t.registerProviders(e,c,r,n);await Yc(n,r);const u={dependencySynthesizer:l,loopComponentRouterInput:kr(o),config:{environment:n,logger:c},requiredProviderTypes:Jc},d=Nr.startScenario(c,"Load");try{Qc.log("HostedWorkspaceUI loadAndRender: awaiting component");const e=await Zc(u),t=null===(a=await el(e))||void 0===a?void 0:a.HTMLView;return i&&s?await Xc(t,s,c,d):d.setSuccess({inViewport:!1}),{loopComponent:e,fluidLogger:c,view:t}}catch(e){throw d.setFailure(e,{inViewport:i}),_.Instance.logError("LoadLoopWorkspaceComponent",e,{ErrorMethod:"loadLoopWorkspaceComponent"}),Qc.error("HostedWorkspaceUI loadAndRender: error loading component",e),e}},Xc=async(e,t,n,r)=>{const o=Nr.startActivity(n,Er);try{Qc.log("HostedWorkspaceUI loadAndRender: rendering view"),await tl(e,t);const i=Nr.startActivity(n,Tr);requestAnimationFrame((()=>{null==r||r.setSuccess({inViewport:!0}),i.setSuccess(),o.setSuccess(),B.renderCompleteEvent()})),Qc.log("HostedWorkspaceUI loadAndRender: view rendered")}catch(e){throw o.setFailure(e),e}},Yc=async(e,t)=>{var n;const r=await Bn.instantiateLoopCodeLoader({windowContext:window,trustedTypesPolicy:void 0,audience:e.audience,localeHint:t});null===(n=r.preCache)||void 0===n||n.call(r,gt).then((()=>{Qc.log("HostedWorkspaceUI loadAndRender: pre-caching complete")})).catch((e=>{_.Instance.logError("CdnCodeLoaderPreCacheError",e,{ErrorMethod:"LoadLoopWorkspaceComponent"}),Qc.error("HostedWorkspaceUI loadAndRender: pre-caching failed",e)}))},Zc=async e=>Gc.runActivity("LoadLoopComponent",(async()=>await function({loopComponentRouterInput:e,dependencySynthesizer:t,config:n,fluidRequestHeaders:r,requiredProviderTypes:o}){const{logger:i,newConfig:s,perfMetadata:a,documentHiddenTrackerId:c}=Qr(n||{}),l=window;let u=wc(t,{windowContextForLoader:l});const d=new oo;u=Sc(u,d,i);const p=gc({windowContextForLoader:l,loopComponentRouterInput:e,dependencySynthesizer:u,config:s,logger:i,perfMetadata:a,documentHiddenTrackerId:c,fluidRequestHeaders:r,requiredProviderTypes:o});return bc(d,p.container),Promise.all([p.container,p.component]).then((([e,t])=>t))}(e))),el=async e=>Gc.runActivity("GetLoopView",(async()=>{var t;return await(null===(t=e.HTMLViewable)||void 0===t?void 0:t.getView())})),tl=async(e,t)=>Gc.runActivity("RenderLoopComponent",(async()=>await(null==e?void 0:e.render(t)))),nl=()=>{const e={};return function(t,n){void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}};function rl(e){for(var t,n=0,r=0,o=e.length;o>=4;++r,o-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(o){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}function ol(e){return e.reduce((function(e,t){var n=t[0],r=t[1];return e[n]=r,e[r]=n,e}),{})}function il(e){return"number"==typeof e}function sl(e,t){return-1!==e.indexOf(t)}function al(e,t,n,r){return t+(o=n,0===parseFloat(o)?o:"-"===o[0]?o.slice(1):"-"+o)+r;var o}function cl(e){return e.replace(/ +/g," ").split(" ").map((function(e){return e.trim()})).filter(Boolean).reduce((function(e,t){var n=e.list,r=e.state,o=(t.match(/\(/g)||[]).length,i=(t.match(/\)/g)||[]).length;return r.parensDepth>0?n[n.length-1]=n[n.length-1]+" "+t:n.push(t),r.parensDepth+=o-i,{list:n,state:r}}),{list:[],state:{parensDepth:0}}).list}function ll(e){var t=cl(e);if(t.length<=3||t.length>4)return e;var n=t[0],r=t[1],o=t[2];return[n,t[3],o,r].join(" ")}var ul={padding:function(e){var t=e.value;return il(t)?t:ll(t)},textShadow:function(e){var t=function(e){for(var t=[],n=0,r=0,o=!1;r<e.length;)o||","!==e[r]?"("===e[r]?(o=!0,r++):")"===e[r]?(o=!1,r++):r++:(t.push(e.substring(n,r).trim()),n=++r);return n!=r&&t.push(e.substring(n,r+1)),t}(e.value).map((function(e){return e.replace(/(^|\s)(-*)([.|\d]+)/,(function(e,t,n,r){return"0"===r?e:""+t+(""===n?"-":"")+r}))}));return t.join(",")},borderColor:function(e){return ll(e.value)},borderRadius:function(e){var t=e.value;if(il(t))return t;if(sl(t,"/")){var n=t.split("/"),r=n[0],o=n[1];return ul.borderRadius({value:r.trim()})+" / "+ul.borderRadius({value:o.trim()})}var i=cl(t);switch(i.length){case 2:return i.reverse().join(" ");case 4:var s=i[0],a=i[1],c=i[2];return[a,s,i[3],c].join(" ");default:return t}},background:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgImgDirectionRegex,i=e.bgPosDirectionRegex;if(il(t))return t;var s=t.replace(/(url\(.*?\))|(rgba?\(.*?\))|(hsl\(.*?\))|(#[a-fA-F0-9]+)|((^| )(\D)+( |$))/g,"").trim();return t=t.replace(s,ul.backgroundPosition({value:s,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:i})),ul.backgroundImage({value:t,valuesToConvert:n,bgImgDirectionRegex:o})},backgroundImage:function(e){var t=e.value,n=e.valuesToConvert,r=e.bgImgDirectionRegex;return sl(t,"url(")||sl(t,"linear-gradient(")?t.replace(r,(function(e,t,r){return e.replace(r,n[r])})):t},backgroundPosition:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgPosDirectionRegex;return t.replace(r?/^((-|\d|\.)+%)/:null,(function(e,t){return function(e){var t=e.indexOf(".");if(-1===t)e=100-parseFloat(e)+"%";else{var n=e.length-t-2;e=(e=100-parseFloat(e)).toFixed(n)+"%"}return e}(t)})).replace(o,(function(e){return n[e]}))},backgroundPositionX:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,o=e.bgPosDirectionRegex;return il(t)?t:ul.backgroundPosition({value:t,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:o})},transition:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map((function(e){var t=e.split(" ");return t[0]=n[t[0]]||t[0],t.join(" ")})).join(", ")},transitionProperty:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map((function(e){return n[e]||e})).join(", ")},transform:function(e){var t=e.value,n="[^\\u0020-\\u007e]",r="(?:(?:(?:\\[0-9a-f]{1,6})(?:\\r\\n|\\s)?)|\\\\[^\\r\\n\\f0-9a-f])",o="((?:-?(?:[0-9]*\\.[0-9]+|[0-9]+)(?:\\s*(?:em|ex|px|cm|mm|in|pt|pc|deg|rad|grad|ms|s|hz|khz|%)|-?(?:[_a-z]|"+n+"|"+r+")(?:[_a-z0-9-]|"+n+"|"+r+")*)?)|(?:inherit|auto))",i=new RegExp("(translateX\\s*\\(\\s*)"+o+"(\\s*\\))","gi"),s=new RegExp("(translate\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,1}\\s*\\))","gi"),a=new RegExp("(translate3d\\s*\\(\\s*)"+o+"((?:\\s*,\\s*"+o+"){0,2}\\s*\\))","gi"),c=new RegExp("(rotate[ZY]?\\s*\\(\\s*)"+o+"(\\s*\\))","gi");return t.replace(i,al).replace(s,al).replace(a,al).replace(c,al)}};ul.objectPosition=ul.backgroundPosition,ul.margin=ul.padding,ul.borderWidth=ul.padding,ul.boxShadow=ul.textShadow,ul.webkitBoxShadow=ul.boxShadow,ul.mozBoxShadow=ul.boxShadow,ul.WebkitBoxShadow=ul.boxShadow,ul.MozBoxShadow=ul.boxShadow,ul.borderStyle=ul.borderColor,ul.webkitTransform=ul.transform,ul.mozTransform=ul.transform,ul.WebkitTransform=ul.transform,ul.MozTransform=ul.transform,ul.transformOrigin=ul.backgroundPosition,ul.webkitTransformOrigin=ul.transformOrigin,ul.mozTransformOrigin=ul.transformOrigin,ul.WebkitTransformOrigin=ul.transformOrigin,ul.MozTransformOrigin=ul.transformOrigin,ul.webkitTransition=ul.transition,ul.mozTransition=ul.transition,ul.WebkitTransition=ul.transition,ul.MozTransition=ul.transition,ul.webkitTransitionProperty=ul.transitionProperty,ul.mozTransitionProperty=ul.transitionProperty,ul.WebkitTransitionProperty=ul.transitionProperty,ul.MozTransitionProperty=ul.transitionProperty,ul["text-shadow"]=ul.textShadow,ul["border-color"]=ul.borderColor,ul["border-radius"]=ul.borderRadius,ul["background-image"]=ul.backgroundImage,ul["background-position"]=ul.backgroundPosition,ul["background-position-x"]=ul.backgroundPositionX,ul["object-position"]=ul.objectPosition,ul["border-width"]=ul.padding,ul["box-shadow"]=ul.textShadow,ul["-webkit-box-shadow"]=ul.textShadow,ul["-moz-box-shadow"]=ul.textShadow,ul["border-style"]=ul.borderColor,ul["-webkit-transform"]=ul.transform,ul["-moz-transform"]=ul.transform,ul["transform-origin"]=ul.transformOrigin,ul["-webkit-transform-origin"]=ul.transformOrigin,ul["-moz-transform-origin"]=ul.transformOrigin,ul["-webkit-transition"]=ul.transition,ul["-moz-transition"]=ul.transition,ul["transition-property"]=ul.transitionProperty,ul["-webkit-transition-property"]=ul.transitionProperty,ul["-moz-transition-property"]=ul.transitionProperty;var dl=ol([["paddingLeft","paddingRight"],["marginLeft","marginRight"],["left","right"],["borderLeft","borderRight"],["borderLeftColor","borderRightColor"],["borderLeftStyle","borderRightStyle"],["borderLeftWidth","borderRightWidth"],["borderTopLeftRadius","borderTopRightRadius"],["borderBottomLeftRadius","borderBottomRightRadius"],["padding-left","padding-right"],["margin-left","margin-right"],["border-left","border-right"],["border-left-color","border-right-color"],["border-left-style","border-right-style"],["border-left-width","border-right-width"],["border-top-left-radius","border-top-right-radius"],["border-bottom-left-radius","border-bottom-right-radius"]]),pl=["content"],hl=ol([["ltr","rtl"],["left","right"],["w-resize","e-resize"],["sw-resize","se-resize"],["nw-resize","ne-resize"]]),fl=new RegExp("(^|\\W|_)((ltr)|(rtl)|(left)|(right))(\\W|_|$)","g"),gl=new RegExp("(left)|(right)");function ml(e){return Object.keys(e).reduce((function(t,n){var r=e[n];if("string"==typeof r&&(r=r.trim()),sl(pl,n))return t[n]=r,t;var o=vl(n,r),i=o.key,s=o.value;return t[i]=s,t}),Array.isArray(e)?[]:{})}function vl(e,t){var n,r=/\/\*\s?@noflip\s?\*\//.test(t),o=r?e:dl[n=e]||n,i=r?t:function(e,t){if(!function(e){return t=e,!("boolean"==typeof t||function(e){return null==e}(e));var t}(t))return t;if(n=t,n&&"object"==typeof n)return ml(t);var n;var r,o=il(t),i=function(e){return"function"==typeof e}(t),s=o||i?t:t.replace(/ !important.*?$/,""),a=!o&&s.length!==t.length,c=ul[e];r=c?c({value:s,valuesToConvert:hl,propertiesToConvert:dl,isRtl:!0,bgImgDirectionRegex:fl,bgPosDirectionRegex:gl}):hl[s]||s;if(a)return r+" !important";return r}(o,t);return{key:o,value:i}}const yl="undefined"==typeof window?s.g:window,bl="@griffel/";function wl(e,t){return yl[Symbol.for(bl+e)]||(yl[Symbol.for(bl+e)]=t),yl[Symbol.for(bl+e)]}const Sl=wl("DEFINITION_LOOKUP_TABLE",{}),Cl="data-make-styles-bucket",kl="data-priority",El="f",Tl=7,Pl="___",Nl=(Pl.length,{all:1,borderColor:1,borderStyle:1,borderWidth:1,borderBlock:1,borderBlockEnd:1,borderBlockStart:1,borderInline:1,borderInlineEnd:1,borderInlineStart:1}),Il="DO_NOT_USE_DIRECTLY: @griffel/reset-value",Ol=/[A-Z]/g,Al=/^ms-/,Ll={};function Fl(e){return"-"+e.toLowerCase()}function Dl(e){if(Object.prototype.hasOwnProperty.call(Ll,e))return Ll[e];if("--"===e.substr(0,2))return e;const t=e.replace(Ol,Fl);return Ll[e]=Al.test(t)?"-"+t:t}function xl(e){return"&"===e.charAt(0)?e.slice(1):e}var Rl="-moz-",Ml="-webkit-",_l="comm",Ul="rule",jl="decl",zl="@import",ql="@keyframes",Bl="@layer",$l=Math.abs,Hl=String.fromCharCode,Wl=Object.assign;function Vl(e){return e.trim()}function Gl(e,t){return(e=t.exec(e))?e[0]:e}function Ql(e,t,n){return e.replace(t,n)}function Jl(e,t,n){return e.indexOf(t,n)}function Kl(e,t){return 0|e.charCodeAt(t)}function Xl(e,t,n){return e.slice(t,n)}function Yl(e){return e.length}function Zl(e){return e.length}function eu(e,t){return t.push(e),e}function tu(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function nu(e,t,n,r){switch(e.type){case Bl:if(e.children.length)break;case zl:case jl:return e.return=e.return||e.value;case _l:return"";case ql:return e.return=e.value+"{"+tu(e.children,r)+"}";case Ul:if(!Yl(e.value=e.props.join(",")))return""}return Yl(n=tu(e.children,r))?e.return=e.value+"{"+n+"}":""}var ru=1,ou=1,iu=0,su=0,au=0,cu="";function lu(e,t,n,r,o,i,s,a){return{value:e,root:t,parent:n,type:r,props:o,children:i,line:ru,column:ou,length:s,return:"",siblings:a}}function uu(e,t){return Wl(lu("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function du(){return au=su>0?Kl(cu,--su):0,ou--,10===au&&(ou=1,ru--),au}function pu(){return au=su<iu?Kl(cu,su++):0,ou++,10===au&&(ou=1,ru++),au}function hu(){return Kl(cu,su)}function fu(){return su}function gu(e,t){return Xl(cu,e,t)}function mu(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function vu(e){return ru=ou=1,iu=Yl(cu=e),su=0,[]}function yu(e){return cu="",e}function bu(e){return Vl(gu(su-1,ku(91===e?e+2:40===e?e+1:e)))}function wu(e){return yu(function(e){for(;pu();)switch(mu(au)){case 0:eu(Tu(su-1),e);break;case 2:eu(bu(au),e);break;default:eu(Hl(au),e)}return e}(vu(e)))}function Su(e){for(;(au=hu())&&au<33;)pu();return mu(e)>2||mu(au)>3?"":" "}function Cu(e,t){for(;--t&&pu()&&!(au<48||au>102||au>57&&au<65||au>70&&au<97););return gu(e,fu()+(t<6&&32==hu()&&32==pu()))}function ku(e){for(;pu();)switch(au){case e:return su;case 34:case 39:34!==e&&39!==e&&ku(au);break;case 40:41===e&&ku(e);break;case 92:pu()}return su}function Eu(e,t){for(;pu()&&e+au!==57&&(e+au!==84||47!==hu()););return"/*"+gu(t,su-1)+"*"+Hl(47===e?e:pu())}function Tu(e){for(;!mu(hu());)pu();return gu(e,su)}function Pu(e){return yu(Nu("",null,null,null,[""],e=vu(e),0,[0],e))}function Nu(e,t,n,r,o,i,s,a,c){for(var l=0,u=0,d=s,p=0,h=0,f=0,g=1,m=1,v=1,y=0,b="",w=o,S=i,C=r,k=b;m;)switch(f=y,y=pu()){case 40:if(108!=f&&58==Kl(k,d-1)){-1!=Jl(k+=Ql(bu(y),"&","&\f"),"&\f",$l(l?a[l-1]:0))&&(v=-1);break}case 34:case 39:case 91:k+=bu(y);break;case 9:case 10:case 13:case 32:k+=Su(f);break;case 92:k+=Cu(fu()-1,7);continue;case 47:switch(hu()){case 42:case 47:eu(Ou(Eu(pu(),fu()),t,n,c),c);break;default:k+="/"}break;case 123*g:a[l++]=Yl(k)*v;case 125*g:case 59:case 0:switch(y){case 0:case 125:m=0;case 59+u:-1==v&&(k=Ql(k,/\f/g,"")),h>0&&Yl(k)-d&&eu(h>32?Au(k+";",r,n,d-1,c):Au(Ql(k," ","")+";",r,n,d-2,c),c);break;case 59:k+=";";default:if(eu(C=Iu(k,t,n,l,u,o,a,b,w=[],S=[],d,i),i),123===y)if(0===u)Nu(k,t,C,C,w,i,d,a,S);else switch(99===p&&110===Kl(k,3)?100:p){case 100:case 108:case 109:case 115:Nu(e,C,C,r&&eu(Iu(e,C,C,0,0,o,a,b,o,w=[],d,S),S),o,S,d,a,r?w:S);break;default:Nu(k,C,C,C,[""],S,0,a,S)}}l=u=h=0,g=v=1,b=k="",d=s;break;case 58:d=1+Yl(k),h=f;default:if(g<1)if(123==y)--g;else if(125==y&&0==g++&&125==du())continue;switch(k+=Hl(y),y*g){case 38:v=u>0?1:(k+="\f",-1);break;case 44:a[l++]=(Yl(k)-1)*v,v=1;break;case 64:45===hu()&&(k+=bu(pu())),p=hu(),u=d=Yl(b=k+=Tu(fu())),y++;break;case 45:45===f&&2==Yl(k)&&(g=0)}}return i}function Iu(e,t,n,r,o,i,s,a,c,l,u,d){for(var p=o-1,h=0===o?i:[""],f=Zl(h),g=0,m=0,v=0;g<r;++g)for(var y=0,b=Xl(e,p+1,p=$l(m=s[g])),w=e;y<f;++y)(w=Vl(m>0?h[y]+" "+b:Ql(b,/&\f/g,h[y])))&&(c[v++]=w);return lu(e,t,n,0===o?Ul:a,c,l,u,d)}function Ou(e,t,n,r){return lu(e,t,n,_l,Hl(au),Xl(e,2,-2),0,r)}function Au(e,t,n,r,o){return lu(e,t,n,jl,Xl(e,0,r),Xl(e,r+1,-1),r,o)}function Lu(e){var t=Zl(e);return function(n,r,o,i){for(var s="",a=0;a<t;a++)s+=e[a](n,r,o,i)||"";return s}}function Fu(e){return function(t){t.root||(t=t.return)&&e(t)}}const Du=e=>{if(e.type===Ul){if("string"==typeof e.props)return void 0;e.props=e.props.map((e=>-1===e.indexOf(":global(")?e:wu(e).reduce(((e,t,n,r)=>{if(""===t)return e;if(":"===t&&"global"===r[n+1]){const t=r[n+2].slice(1,-1)+" ";return e.unshift(t),r[n+1]="",r[n+2]="",e}return e.push(t),e}),[]).join("")))}};function xu(e,t,n){switch(function(e,t){return 45^Kl(e,0)?(((t<<2^Kl(e,0))<<2^Kl(e,1))<<2^Kl(e,2))<<2^Kl(e,3):0}(e,t)){case 5103:return Ml+"print-"+e+e;case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:return Ml+e+e;case 4215:if(102===Kl(e,9))return Ml+e+e;if(116===Kl(e,t+1))return Ml+e+e;break;case 4789:return Rl+e+e;case 5349:case 4246:case 6968:return Ml+e+Rl+e+e;case 6187:if(!Gl(e,/grab/))return Ql(Ql(Ql(e,/(zoom-|grab)/,Ml+"$1"),/(image-set)/,Ml+"$1"),e,"")+e;case 5495:case 3959:return Ql(e,/(image-set\([^]*)/,Ml+"$1$`$1");case 4095:case 3583:case 4068:case 2532:return Ql(e,/(.+)-inline(.+)/,Ml+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Yl(e)-1-t>6)switch(Kl(e,t+1)){case 102:if(108===Kl(e,t+3))return Ql(e,/(.+:)(.+)-([^]+)/,"$1"+Ml+"$2-$3$1"+Rl+(108==Kl(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Jl(e,"stretch")?xu(Ql(e,"stretch","fill-available"),t)+e:e}}return e}function Ru(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case jl:return void(e.return=xu(e.value,e.length));case Ul:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(Gl(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return tu([uu(e,{props:[Ql(t,/:(read-\w+)/,":"+Rl+"$1")]})],r);case"::placeholder":return tu([uu(e,{props:[Ql(t,/:(plac\w+)/,":"+Ml+"input-$1")]}),uu(e,{props:[Ql(t,/:(plac\w+)/,":"+Rl+"$1")]})],r)}return""}))}}const Mu=e=>{(function(e){switch(e.type){case"@container":case"@media":case"@supports":case Bl:return!0}return!1})(e)&&Array.isArray(e.children)&&e.children.sort(((e,t)=>e.props[0]>t.props[0]?1:-1))};function _u(){}const Uu=/,( *[^ &])/g;function ju(e,t,n){let r=t;return n.length>0&&(r=n.reduceRight(((e,t)=>{return`${n=t,"&"+xl(n.replace(Uu,",&$1"))} { ${e} }`;var n}),t)),`${e}{${r}}`}function zu(e,t){const{className:n,selectors:r,property:o,rtlClassName:i,rtlProperty:s,rtlValue:a,value:c}=e,{container:l,layer:u,media:d,supports:p}=t;let h=ju(`.${n}`,Array.isArray(c)?`${c.map((e=>`${Dl(o)}: ${e}`)).join(";")};`:`${Dl(o)}: ${c};`,r);if(s&&i){h+=ju(`.${i}`,Array.isArray(a)?`${a.map((e=>`${Dl(s)}: ${e}`)).join(";")};`:`${Dl(s)}: ${a};`,r)}return d&&(h=`@media ${d} { ${h} }`),u&&(h=`@layer ${u} { ${h} }`),p&&(h=`@supports ${p} { ${h} }`),l&&(h=`@container ${l} { ${h} }`),function(e,t){const n=[];return tu(Pu(e),Lu([Du,t?Mu:_u,Ru,nu,Fu((e=>n.push(e)))])),n}(h,!0)}function qu(e){let t="";for(const n in e){const r=e[n];if("string"!=typeof r&&"number"!=typeof r){if(Array.isArray(r))for(const e of r)t+=Dl(n)+":"+e+";"}else t+=Dl(n)+":"+r+";"}return t}function Bu(e){let t="";for(const n in e)t+=`${n}{${qu(e[n])}}`;return t}function $u(e,t){const n=[];return tu(Pu(`@keyframes ${e} {${t}}`),Lu([nu,Ru,Fu((e=>n.push(e)))])),n}const Hu={animation:[-1,["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimeline","animationTimingFunction"]],animationRange:[-1,["animationRangeEnd","animationRangeStart"]],background:[-2,["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"]],backgroundPosition:[-1,["backgroundPositionX","backgroundPositionY"]],border:[-2,["borderBottom","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderTop","borderTopColor","borderTopStyle","borderTopWidth"]],borderBottom:[-1,["borderBottomColor","borderBottomStyle","borderBottomWidth"]],borderImage:[-1,["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"]],borderLeft:[-1,["borderLeftColor","borderLeftStyle","borderLeftWidth"]],borderRadius:[-1,["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"]],borderRight:[-1,["borderRightColor","borderRightStyle","borderRightWidth"]],borderTop:[-1,["borderTopColor","borderTopStyle","borderTopWidth"]],caret:[-1,["caretColor","caretShape"]],columnRule:[-1,["columnRuleColor","columnRuleStyle","columnRuleWidth"]],columns:[-1,["columnCount","columnWidth"]],containIntrinsicSize:[-1,["containIntrinsicHeight","containIntrinsicWidth"]],container:[-1,["containerName","containerType"]],flex:[-1,["flexBasis","flexGrow","flexShrink"]],flexFlow:[-1,["flexDirection","flexWrap"]],font:[-1,["fontFamily","fontSize","fontStretch","fontStyle","fontVariant","fontWeight","lineHeight"]],gap:[-1,["columnGap","rowGap"]],grid:[-1,["columnGap","gridAutoColumns","gridAutoFlow","gridAutoRows","gridColumnGap","gridRowGap","gridTemplateAreas","gridTemplateColumns","gridTemplateRows","rowGap"]],gridArea:[-1,["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"]],gridColumn:[-1,["gridColumnEnd","gridColumnStart"]],gridRow:[-1,["gridRowEnd","gridRowStart"]],gridTemplate:[-1,["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"]],inset:[-1,["bottom","left","right","top"]],insetBlock:[-1,["insetBlockEnd","insetBlockStart"]],insetInline:[-1,["insetInlineEnd","insetInlineStart"]],listStyle:[-1,["listStyleImage","listStylePosition","listStyleType"]],margin:[-1,["marginBottom","marginLeft","marginRight","marginTop"]],marginBlock:[-1,["marginBlockEnd","marginBlockStart"]],marginInline:[-1,["marginInlineEnd","marginInlineStart"]],mask:[-1,["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPosition","maskRepeat","maskSize"]],maskBorder:[-1,["maskBorderMode","maskBorderOutset","maskBorderRepeat","maskBorderSlice","maskBorderSource","maskBorderWidth"]],offset:[-1,["offsetAnchor","offsetDistance","offsetPath","offsetPosition","offsetRotate"]],outline:[-1,["outlineColor","outlineStyle","outlineWidth"]],overflow:[-1,["overflowX","overflowY"]],overscrollBehavior:[-1,["overscrollBehaviorX","overscrollBehaviorY"]],padding:[-1,["paddingBottom","paddingLeft","paddingRight","paddingTop"]],paddingBlock:[-1,["paddingBlockEnd","paddingBlockStart"]],paddingInline:[-1,["paddingInlineEnd","paddingInlineStart"]],placeContent:[-1,["alignContent","justifyContent"]],placeItems:[-1,["alignItems","justifyItems"]],placeSelf:[-1,["alignSelf","justifySelf"]],scrollMargin:[-1,["scrollMarginBottom","scrollMarginLeft","scrollMarginRight","scrollMarginTop"]],scrollMarginBlock:[-1,["scrollMarginBlockEnd","scrollMarginBlockStart"]],scrollMarginInline:[-1,["scrollMarginInlineEnd","scrollMarginInlineStart"]],scrollPadding:[-1,["scrollPaddingBottom","scrollPaddingLeft","scrollPaddingRight","scrollPaddingTop"]],scrollPaddingBlock:[-1,["scrollPaddingBlockEnd","scrollPaddingBlockStart"]],scrollPaddingInline:[-1,["scrollPaddingInlineEnd","scrollPaddingInlineStart"]],scrollTimeline:[-1,["scrollTimelineAxis","scrollTimelineName"]],textDecoration:[-1,["textDecorationColor","textDecorationLine","textDecorationStyle","textDecorationThickness"]],textEmphasis:[-1,["textEmphasisColor","textEmphasisStyle"]],transition:[-1,["transitionBehavior","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"]],viewTimeline:[-1,["viewTimelineAxis","viewTimelineName"]]};function Wu(e,t){return 0===e.length?t:`${e} and ${t}`}function Vu(e){return"@media"===e.substr(0,6)}function Gu(e){return"@layer"===e.substr(0,6)}const Qu=/^(:|\[|>|&)/;function Ju(e){return Qu.test(e)}function Ku(e){return"@supports"===e.substr(0,9)}function Xu(e){return"@container"===e.substring(0,10)}const Yu={"us-w":"w","us-v":"i",nk:"l",si:"v",cu:"f",ve:"h",ti:"a"};function Zu(e,t){if(t.media)return"m";if(t.layer||t.supports)return"t";if(t.container)return"c";if(e.length>0){const t=e[0].trim();if(58===t.charCodeAt(0))return Yu[t.slice(4,8)]||Yu[t.slice(3,5)]||"d"}return"d"}function ed(e,t){return e?t+e:e}function td(e){return ed(e.container,"c")+ed(e.media,"m")+ed(e.layer,"l")+ed(e.supports,"s")}function nd(e,t,n){const r=rl(e+td(n)+t),o=r.charCodeAt(0);return o>=48&&o<=57?String.fromCharCode(o+17)+r.slice(1):r}function rd({property:e,selector:t,salt:n,value:r},o){return El+rl(n+t+td(o)+e+r.trim())}function od(e){return e===Il}function id(e){return e.replace(/>\s+/g,">")}function sd(...e){0}function ad(e){return Hu[e]}function cd(e){var t;return null!==(t=null==e?void 0:e[0])&&void 0!==t?t:0}function ld(e,t,n,r){e[t]=r?[n,r]:n}function ud(e,t){return t.length>0?[e,Object.fromEntries(t)]:e}function dd(e,t,n,r,o,i){var s;const a=[];0!==i&&a.push(["p",i]),"m"===t&&o&&a.push(["m",o]),null!==(s=e[t])&&void 0!==s||(e[t]=[]),n&&e[t].push(ud(n,a)),r&&e[t].push(ud(r,a))}function pd(e,t="",n=[],r={container:"",layer:"",media:"",supports:""},o={},i={},s){for(const c in e){if(Nl.hasOwnProperty(c)){e[c],sd();continue}const l=e[c];if(null!=l)if(od(l)){ld(o,nd(id(n.join("")),c,r),0,void 0)}else if("string"==typeof l||"number"==typeof l){const e=id(n.join("")),a=ad(c);if(a){const e=a[1],s=Object.fromEntries(e.map((e=>[e,Il])));pd(s,t,n,r,o,i)}const u=nd(e,c,r),d=rd({value:l.toString(),salt:t,selector:e,property:c},r),p=s&&{key:c,value:s}||vl(c,l),h=p.key!==c||p.value!==l,f=h?rd({value:p.value.toString(),property:p.key,salt:t,selector:e},r):void 0,g=h?{rtlClassName:f,rtlProperty:p.key,rtlValue:p.value}:void 0,m=Zu(n,r),[v,y]=zu(Object.assign({className:d,selectors:n,property:c,value:l},g),r);ld(o,u,d,f),dd(i,m,v,y,r.media,cd(a))}else if("animationName"===c){const e=Array.isArray(l)?l:[l],s=[],a=[];for(const t of e){const e=Bu(t),n=Bu(ml(t)),o=El+rl(e);let c;const l=$u(o,e);let u=[];e===n?c=o:(c=El+rl(n),u=$u(c,n));for(let e=0;e<l.length;e++)dd(i,"k",l[e],u[e],r.media,0);s.push(o),a.push(c)}pd({animationName:s.join(", ")},t,n,r,o,i,a.join(", "))}else if(Array.isArray(l)){if(0===l.length){0;continue}const e=id(n.join("")),s=ad(c);if(s){const e=s[1],a=Object.fromEntries(e.map((e=>[e,Il])));pd(a,t,n,r,o,i)}const a=nd(e,c,r),u=rd({value:l.map((e=>(null!=e?e:"").toString())).join(";"),salt:t,selector:e,property:c},r),d=l.map((e=>vl(c,e)));if(!!d.some((e=>e.key!==d[0].key))){0;continue}const p=d[0].key!==c||d.some(((e,t)=>e.value!==l[t])),h=p?rd({value:d.map((e=>{var t;return(null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"").toString()})).join(";"),salt:t,property:d[0].key,selector:e},r):void 0,f=p?{rtlClassName:h,rtlProperty:d[0].key,rtlValue:d.map((e=>e.value))}:void 0,g=Zu(n,r),[m,v]=zu(Object.assign({className:u,selectors:n,property:c,value:l},f),r);ld(o,a,u,h),dd(i,g,m,v,r.media,cd(s))}else if(null!=(a=l)&&"object"==typeof a&&!1===Array.isArray(a))if(Ju(c))pd(l,t,n.concat(xl(c)),r,o,i);else if(Vu(c)){const e=Wu(r.media,c.slice(6).trim());pd(l,t,n,Object.assign({},r,{media:e}),o,i)}else if(Gu(c)){const e=(r.layer?`${r.layer}.`:"")+c.slice(6).trim();pd(l,t,n,Object.assign({},r,{layer:e}),o,i)}else if(Ku(c)){const e=Wu(r.supports,c.slice(9).trim());pd(l,t,n,Object.assign({},r,{supports:e}),o,i)}else if(Xu(c)){const e=c.slice(10).trim();pd(l,t,n,Object.assign({},r,{container:e}),o,i)}else sd()}var a;return[o,i]}function hd(e){const t=e.length;if(t===Tl)return e;for(let n=t;n<Tl;n++)e+="0";return e}function fd(e,t,n=[]){return Pl+hd(rl(e+t))}function gd(e,t){let n="",r="";for(const o in e){const i=e[o];if(0===i){r+=o+" ";continue}const s=Array.isArray(i),a="rtl"===t?(s?i[1]:i)+" ":(s?i[0]:i)+" ";n+=a,r+=a}return[n.slice(0,-1),r.slice(0,-1)]}function md(e,t){const n={};for(const r in e){const[o,i]=gd(e[r],t);if(""===i){n[r]="";continue}const s=fd(i,t),a=s+(""===o?"":" "+o);Sl[s]=[e[r],t],n[r]=a}return n}function vd(e,t=nl){const n=t();let r=null,o=null,i=null,s=null;return function(t){const{dir:a,renderer:c}=t;null===r&&([r,o]=function(e,t=""){const n={},r={};for(const o in e){const i=e[o],[s,a]=pd(i,t);n[o]=s,Object.keys(a).forEach((e=>{r[e]=(r[e]||[]).concat(a[e])}))}return[n,r]}(e,c.classNameHashSalt));const l="ltr"===a;return l?null===i&&(i=md(r,a)):null===s&&(s=md(r,a)),n(c,o),l?i:s}}const yd=t.useInsertionEffect?t.useInsertionEffect:void 0,bd=()=>{const e={};return function(t,n){yd&&"undefined"!=typeof window&&window.document&&window.document.createElement?yd((()=>{t.insertCSSRules(n)}),[t,n]):void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}};function wd(e,t,n,r){const o=[];if(r[Cl]=t,r[kl]=String(n),e)for(const t in r)e.setAttribute(t,r[t]);return{elementAttributes:r,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):o.push(t)},element:e,bucketName:t,cssRules:()=>(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map((e=>e.cssText)):o}}const Sd=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce(((e,t,n)=>(e[t]=n,e)),{});function Cd(e,t,n){return("m"===e?e+t:e)+n}function kd(e,t,n,r,o={}){var i,s;const a="m"===e,c=null!==(i=o.m)&&void 0!==i?i:"0",l=null!==(s=o.p)&&void 0!==s?s:0,u=Cd(e,c,l);if(!r.stylesheets[u]){const i=t&&t.createElement("style"),s=wd(i,e,l,Object.assign({},r.styleElementAttributes,a&&{media:c}));r.stylesheets[u]=s,t&&i&&t.head.insertBefore(i,function(e,t,n,r,o={}){var i,s;const a=Sd[n],c=null!==(i=o.m)&&void 0!==i?i:"",l=null!==(s=o.p)&&void 0!==s?s:0;let u=e=>a-Sd[e.getAttribute(Cl)],d=e.head.querySelectorAll(`[${Cl}]`);if("m"===n){const t=e.head.querySelectorAll(`[${Cl}="${n}"]`);t.length&&(d=t,u=e=>r.compareMediaQueries(c,e.media))}const p=e=>function(e,t,n){var r,o;const i=t+(null!==(r=n.m)&&void 0!==r?r:""),s=e.getAttribute(Cl)+(null!==(o=e.media)&&void 0!==o?o:"");return i===s}(e,n,o)?l-Number(e.getAttribute("data-priority")):u(e),h=d.length;let f=h-1;for(;f>=0;){const e=d.item(f);if(p(e)>0)return e.nextSibling;f--}if(h>0)return d.item(0);return t?t.nextSibling:null}(t,n,e,r,o))}return r.stylesheets[u]}function Ed(e,t){try{e.insertRule(t)}catch(e){0}}let Td=0;const Pd=(e,t)=>e<t?-1:e>t?1:0;function Nd(e=("undefined"==typeof document?void 0:document),t={}){const{classNameHashSalt:n,unstable_filterCSSRule:r,insertionPoint:o,styleElementAttributes:i,compareMediaQueries:s=Pd}=t,a={classNameHashSalt:n,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(i),compareMediaQueries:s,id:"d"+Td++,insertCSSRules(t){for(const i in t){const s=t[i];for(let t=0,c=s.length;t<c;t++){const[c,l]=(n=s[t],Array.isArray(n)?n:[n]),u=kd(i,e,o||null,a,l);a.insertionCache[c]||(a.insertionCache[c]=i,r?r(c)&&Ed(u,c):Ed(u,c))}}var n}};return a}const Id=e.createContext(Nd());const Od=e.createContext("ltr");const Ad=function(t){const n=vd(t,bd);return function(){const t=e.useContext(Od),r=e.useContext(Id);return n({dir:t,renderer:r})}}({contentContainer:{height:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"stretch"}});var Ld=s(9307);const Fd=t=>{Ld.log("HostedWorkspaceUI invoked");const{authService:n,dependencySynthesizerService:r,environment:o,locale:i,loadNavParams:s,appWorkspaceManager:a}=t,c=Ad(),l=e.useRef(null),u=e.useRef(),d=e.useRef(),p=e.useRef(),h=e.useRef(!1),f=e.useCallback((async()=>{h.current||u.current&&l.current&&d.current&&(await Xc(p.current,l.current,d.current),h.current=!0,te.clearOnRenderSettings())}),[]),g=e.useCallback((async e=>{if(!e)return te.clearOnRenderSettings(),void(h.current=!0);te.forceRender?await f():a.setOnNavigationEvent(f)}),[a,f]),m=e.useCallback((async()=>{var e,t;if(l.current)try{const c=te.isUILessLoad(),{loopComponent:h,fluidLogger:f,view:m}=await Kc(n,r,o,i,s,!c,l.current);await g(c),u.current=h,d.current=f,p.current=m,a.setWorkspaceAndPageManager(h.WorkspaceAndPageManager),a.setWorkspaceNavigationHandler(h.WorkspaceNavigationHandler),await a.appLoadDataModels(),null===(e=u.current.WorkspaceAndPageManager)||void 0===e||e.on("workspaceListChanged",(e=>{a.getWorkspaceManager().onWorkspaceListChangedEvent(e)})),a.setWorkspaceNavigationHandler(h.WorkspaceNavigationHandler),null===(t=u.current.WorkspaceNavigationHandler)||void 0===t||t.on("navigation",(e=>{a.getWorkspaceManager().onComponentNavigationEvent(e)}))}catch(e){_.Instance.logError("LoadLoopWorkspaceComponent",e,{ErrorMethod:"HostedWorkspaceUI.renderLoopComponent"}),Ld.error("Error rendering loop component",e)}}),[n,r,o,i,s,a,g]),v=e.useCallback((async()=>{var e;r.unregisterProviders(),p.current&&(await p.current.dispose(),p.current=void 0),u.current&&(null===(e=u.current.Disposable)||void 0===e||e.dispose(),u.current=void 0),d.current&&(d.current.dispose(),d.current=void 0)}),[r]);return e.useEffect((()=>{l.current&&(m(),n.on(We,(async()=>{Ld.log("User changed, re-rendering loop component"),await v(),m()})))}),[n,v,r,m]),e.createElement("div",{className:c.contentContainer,ref:l})};var Dd=s(9307);var xd=s(9307);document.onkeydown=e=>{switch(e.key){case"F5":e.preventDefault();break;case"r":e.ctrlKey&&e.preventDefault()}},xd.log("Initializing Copilot Notebook SDX");const Rd=document.getElementById("index-react-root");if(!Rd)throw new Error("Index root container not found");(0,n.H)(Rd).render(e.createElement((()=>{const t=e.useRef(!1),n=e.useCallback((()=>{t.current||(Dd.log("Window focused before app init"),te.forceRender=!0),t.current=!0}),[t]);window.addEventListener("focus",n);const[o,i]=(0,e.useState)(void 0),s=e.useCallback((async()=>{try{const e=new Ge,t=new hr,o=new Cr(e,t);await o.appInitialize(),q.initialize().then((()=>{q.registerEvent((e=>(t,n)=>{Qe.log(`ApiBridge: NativeEvent: ${t}:`,n);try{if("identityChange"===t)e.appOnIdentityChange();else if("navigateToModuleHome"===t)e.appNavigateToHome();else if("navigateToNotebookHome"===t)e.appNavigateToNotebook(n);else if("navigateToNotebookPage"===t)e.appNavigateToPage(n);else if("tryNavigateToLink"===t)e.appNavigateToLink(n);else{if("tryNavigateToSearchResult"!==t)throw new Error("Unsupported native event");e.appNavigateToSearchResult(n)}}catch(e){Qe.error(`ApiBridge: Error executing event '${t}':`,e),_.Instance.logError("NativeEventHandlerError",e,{ErrorMethod:"GetNativeEventHandler",ErrorEvent:t})}})(o)),window.removeEventListener("focus",n)})).catch((e=>{_.Instance.logError("AppInitError",e,{ErrorMethod:"appInitialize",ErrorDetails:"Error initializing API bridge"}),Dd.error("Error initializing API bridge",e)}));const s=te.getLocale(r.enUs);let a={route:"notebooks"};const c=te.getSetting(X.LaunchPodId,gr),l=te.getSetting(X.LaunchSpoId,gr);if(c!==gr&&c!==fr){a={route:"notebook",mfsPodId:c,spoId:l!==gr&&l!==fr?l:void 0};if(x("useNavToPage",mr)){const e=te.getSetting(X.LaunchDocUrl,""),t=te.getSetting(X.LaunchDocUrlRequiresRedeem,false);""!==e&&"0"!==e&&(a={route:"page",mfsPodId:c,docUrl:e,requiresRedeem:t})}}const u={authService:e,environment:se(),locale:s,loadNavParams:a,appWorkspaceManager:o,dependencySynthesizerService:t};i(u)}catch(e){_.Instance.logError("AppInitError",e,{ErrorMethod:"appInitialize",ErrorDetails:"Error initializing app"}),Dd.error(e)}window.onbeforeunload=()=>{q.cleanup()}}),[n]);return e.useEffect((()=>{Office.onReady(s)}),[s]),o?e.createElement(Fd,{...o}):e.createElement(e.Fragment,null)}),null))})(),TypeScriptModule={}})();
//# sourceMappingURL=index.js.map