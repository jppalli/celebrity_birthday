/*! For license information please see sccserviceciq.js.LICENSE.txt */
(self.webpackChunksdx_pptslidebuilderview=self.webpackChunksdx_pptslidebuilderview||[]).push([[1034],{67042:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CiqAnchorElementId:()=>Qf,EditorServiceImplementation:()=>Vf,initCiq:()=>Zf,mapSuggestions:()=>Gf});var i={};n.r(i),n.d(i,{Rc:()=>Qp});var r=n(30206),o=n(39386),a=n(97719);const s=[{id:"818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",name:"Frequentlyconfusedwords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"4ee98de6-ea40-48db-ae36-ca82fc8473f7",name:"AcademicDegrees",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"5cb7fc16-cd78-449c-86d9-5d047be21ac4",name:"AdjectiveUsedinsteadofAdverb",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"8778ba37-ca99-4ab9-a964-55abd18f7eba",name:"AdverbinsteadofAdjective",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"f57c12d6-03e4-4f48-9b7b-f95802a6c669",name:"AgreementwithinNounPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a127d2c9-2faf-491b-8d6a-e9b027fec098",name:"AnAnd Confusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"63e72d3d-62d7-4e73-8d66-c137d8841121",name:"Capitalization",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"79d4a5c7-11c0-4be1-8d3c-c322f9941323",name:"Capitalizationof March and May",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"822bb35e-0608-466e-a771-a315fcf95821",name:"CapitalizationofPersonalTitles",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7b3c279b-14c8-4e5f-83da-1cc446ed7f6a",name:"CommaafterGreetings",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"9d62fd01-8804-4485-a5f0-257131e4f6aa",name:"CommabeforeQuotations",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"fd8f4ff7-fa09-492c-9c74-1a6b9f71e488",name:"CommaMissingafterIntroductoryPhrase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"72e604b0-a185-413b-bd45-ad555288c746",name:"CommaSplice",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e3994139-ff36-44da-ae72-500b70d9b80f",name:"CommawithConjunctiveAdverbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e805847a-9050-45de-b767-f48ed68ad848",name:"CommawithConjunction",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"0c576af1-54af-4acb-8065-4616bb73820d",name:"CommasaroundDescriptiveClause",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"413425d5-5a64-4ea6-84df-aae06c596439",name:"CommonlyConfusedPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"aea1e72a-abf4-4cc8-8b7a-43d15be8fc55",name:"CommonlyConfusedWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"02c15397-df70-4f00-aa4d-7269e6d4e712",name:"ComparativeUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"25714ab1-190b-4ef3-8d3d-e45bfd591c45",name:"CorrelativeConjunctionMismatch",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"8cf6f68e-f693-4e6f-b253-5092cd19b9e2",name:"DateFormatting",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"03522a58-4044-4bab-b796-0630ae2ad00a",name:"EmbarrassingWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"84275a90-df79-4b9e-a208-9ec8b5e59622",name:"Hyphenation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"708198dd-ecbf-44fb-a428-ff2bc10e4d17",name:"IncorrectAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6c49e04e-c556-43f3-94dc-2fe5dc18d8e5",name:"IncorrectNegation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7d9778b3-89e4-4974-b38f-086d39b32c21",name:"IncorrectNumberEnding",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"ca649e0f-48de-4f54-b687-2bda07e40728",name:"IncorrectPronounCase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"631a3185-4bb6-4d1a-b275-f16c7f5dcc3a",name:"IncorrectReflexivePronounUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"296f8f65-02fb-45a7-b4ab-5dc137edc563",name:"IncorrectUseof That",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:1,CritiqueTag:0},{id:"0941dabb-e993-4a10-8a92-70a95ca5389d",name:"IncorrectVerbForm",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"7c2ff4d7-41a9-4310-949b-863a0dfa4257",name:"IncorrectVerbFormafterAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6dbfae4c-9818-4dec-a769-2595168927f2",name:"IndefiniteArticle",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e006985e-33eb-42e1-9196-1333c4ecad9c",name:"IndirectQuestions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"4b1218e3-a124-4d36-b993-eb9ad6e80ddd",name:"MisheardPhrases",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"2700d569-bd6f-4806-9bf1-49abd64d9fd3",name:"MissingComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"b3613809-76ab-4b7b-91e6-ee9b6b9b60b2",name:"ModalConfusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"875c19b3-5769-4e9b-8d32-9c9dd4d74c13",name:"MultipleModals",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"f1a2ad0b-0b26-4bb5-aede-e88c9fe47492",name:"PossessiveandPluralForms",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"3f2eda01-e8a5-4ed9-9494-6de566bc5333",name:"Punctuation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"76e3d0aa-bb80-461e-89c3-9fa640190616",name:"QuestionMarkMissing",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"12d7f72e-e53e-4b27-b1ed-4ee115f54994",name:"RedundantColon",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"b956d579-6d99-4278-8b7d-e281ab8c576b",name:"RedundantCommabeforeComplementClause",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"2d08dbe8-c11b-4190-a428-9a2c0a37bd68",name:"RedundantCommabeforeObject",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"aa78ec66-2078-42bf-84f5-c241eb53a531",name:"RedundantCommafollowingSubject",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"1346c3e5-5bf2-4176-ad29-9e25d88da4c6",name:"RedundantQuestionMark",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"e8c121e0-1ecd-4e88-8694-2fb17acb519d",name:"RepeatedAuxiliary",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"39d0acfc-05aa-4d25-ae88-32ebcee3bbeb",name:"SemicolonUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6d1d8c3d-62d5-45d1-b850-d8a98a24964b",name:"Spacing",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"d7746119-e7e5-4e97-9979-bcd2114f9fe9",name:"Subject-VerbAgreement",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"27783a58-c44f-4778-9856-36d9eab63693",name:"TooManyDeterminers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a7927082-e6bb-4061-a134-3051e5969222",name:"UnnecessaryHyphen",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"26bdc172-02a8-4f0a-8ec0-6049906f1f7c",name:"UseofPlainVerbForm",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"39e466f1-6ebd-4ada-a7db-e0cc74048f1e",name:"UseoftheWord Lack",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"a9ca4ef4-12a5-4ad2-b8d5-b1310cc0d2af",name:"UseofWillandWould",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"352579fc-6ae6-4eb1-8d3b-895ab239714e",name:"VerbUse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"ff12bbbd-0795-409a-8ed0-c8d7b2793e3a",name:"WhoWhomConfusion",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"6a0e1c97-430e-4d83-889d-8c4fea315a83",name:"WordSplit",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:1,CritiqueTag:0},{id:"c4301606-9bc2-4389-bb1a-c08370627172",name:"AdverbPlacement",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"0da5de95-d496-4d23-8f93-693ef6592ae6",name:"DoubleNegation",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3be567ea-4951-4e59-bdab-6b99c790f28d",name:"Jargon",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"ab60d6cb-98df-4b9d-9a69-f6c12d8099fe",name:"PassiveVoice",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"8aa31cca-af48-4d21-8fb5-a0f314fab6ce",name:"PassiveVoicewithUnknownActor",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"28c70cb7-e358-4b32-8756-725aa7af1d69",name:"SentenceStructure",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"7f6d979b-d0de-4367-aa9d-589b5134b7a6",name:"SimplerWording",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"79dd443b-0b94-45a1-90ad-02807565324d",name:"SplitInfinitives",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"007c6707-7280-4c94-b469-8caee77d8313",name:"UseofEuphemisms",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"e24fd819-cc17-4be9-afec-dd103055198e",name:"ConjunctionOveruse",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"71384165-a4b9-45a7-9a73-7d0830c8c426",name:"Nominalizations",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"cfc8ef49-66b1-4ea0-8930-43d2ccd842e0",name:"Wordiness",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"6bdf8d88-1ed5-4506-9b5f-a17e7f8c2a48",name:"WordsExpressingUncertainty",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"67718619-a6b1-43ec-af18-1c48bbc27acd",name:"ColloquialVerbPhrase",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"f4aa4a0a-f81a-41ac-b710-de4a60b99282",name:"Contractions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"6d60d9da-9e38-4d1e-bfc5-05a04120eef9",name:"InformalLanguage",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"d124712e-74ac-43eb-9bb6-373b2398f448",name:"OpinionMarkers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"aa4e5a53-9b76-49fe-8bf1-2f35fd0d091d",name:"Slang",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"c68edc3b-9340-4b68-9d18-268bb82e2d94",name:"SubjunctiveMood",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"932288af-0af4-43f8-94af-206e06e43fce",name:"AgeBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"dd116cd6-2adb-4be9-809f-7b8de7cace91",name:"EthnicSlurs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"6cd66cca-c2c2-48cf-8353-9791327aaea1",name:"GenderBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"e77bbc2a-f896-4012-a711-6041ea1e8964",name:"Gender-SpecificLanguage",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"36869146-3cc3-40fd-ae3c-bb30f6988335",name:"RacialBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"cbac7e3d-9058-442c-9f24-78fe164069b4",name:"SexualOrientationBias",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"3f2e6b47-fc23-4f99-ad25-1758e7f179b6",name:"CommawithAdverbials",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"55aa25a5-e28a-4f22-8410-34a4df965e30",name:"OxfordComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3fd9c226-3925-4855-ba1e-49eb9ee46d24",name:"UnnecessaryComma",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"5b75d94a-856d-461b-9bb4-879f4502b4c3",name:"PunctuationRequiredWithQuotes",IsBinaryCritiqueType:!1,CritiqueTypeValues:["don'tcheck","inside","outside"],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"a44ac718-8213-42ff-87a5-1e5d6592c352",name:"SpaceBetweenSentences",IsBinaryCritiqueType:!1,CritiqueTypeValues:["don'tcheck","onespace","twospaces"],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"487d4873-3793-45a7-b881-7f18cac3f16c",name:"AvoidFirstPersonReferences",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"ac135410-a38a-4398-a759-ac6e2e5f779c",name:"SuperfluousExpressions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"2b188727-cb05-4a4b-86a2-b35073e34c0b",name:"UnsuitableExpressions",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"348f4088-d907-41dc-9007-3cecf9837b61",name:"VagueQuantifiers",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"d07b8e0e-37e7-476e-99e6-477fd9f1b394",name:"VagueVerbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"923cc720-1624-4973-946a-30a0c6ec4163",name:"ClichÃ©s",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:1,CritiquePriority:2,CritiqueTag:0},{id:"3ae3b3e9-6e99-4113-9962-b52b7fe539f3",name:"Region-SpecificWords",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"9725ea09-959d-48b9-9678-1844896547b3",name:"VagueAdjectives",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"64213f24-0943-4585-8dd4-ee4f26b47a37",name:"VagueorUnnecessaryAdverbs",IsBinaryCritiqueType:!0,CritiqueTypeValues:[],defaultCritiqueValue:0,CritiquePriority:2,CritiqueTag:0},{id:"2e33dc1f-0106-4182-b52a-ad94e479fb9a",name:"WeakVerbs",defaultCritiqueValue:0}];n(69207);var l=n(63837);const u=(0,l.f)("ITerminalNodeBuilder");var d=n(79442),c=n(41533),h=n(88215),g=n(99828),p=n(53920),f=n(47954),m=n(98287),v=n(86278),y=n(86310),_=n(9654),b=n(79993),C=n(45118),T=n(97436),S=n(25195),I=n(43880),w=n(80728),E=n(51218),x=n(21206),A=n(85996);const D=(0,l.f)("ICritiqueValueStore");var N=n(35744),F=n(36271),P=n(31409),k=n(13608),O=n(8773),B=n(40617),R=n(33300),L=n(90858),M=n(13494),q=n(8903),U=n(23094),W=n(59886),j=n(91822),z=n(74847),H=n(95481),V=n(96993),G=n(36230),Q=n(2579),K=n(17288),$=n(75943);class Z{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Text_RangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class J{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Text_MultiTileRangeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class Y{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Text_LanguageDetectionSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class X{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class ee{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Text_LanguageCountAnnotationLocalized"}static getBaseTypes(){return["AugLoop_Text_LanguageCountAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(te,this,e)}static getTypeName(){return"AugLoop_Text_Definition"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class ne{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_Text_SuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()};class ie{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ie,this,e)}static getTypeName(){return"AugLoop_Text_Critique"}static getBaseTypes(){return["AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ie.getTypeName()])}}ie.H_={T_:ie.getTypeName(),B_:ie.getBaseTypes()};class re{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(re,this,e)}static getTypeName(){return"AugLoop_Text_NeuralRewriteCritique"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[re.getTypeName()])}}re.H_={T_:re.getTypeName(),B_:re.getBaseTypes()};class oe{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_Text_CritiqueCategoryCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class ae{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ae,this,e)}static getTypeName(){return"AugLoop_Text_UniqueWordsCountAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ae.getTypeName()])}}ae.H_={T_:ae.getTypeName(),B_:ae.getBaseTypes()};class se{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(se,this,e)}static getTypeName(){return"AugLoop_Text_EmptyDocumentAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()};class le{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(le,this,e)}static getTypeName(){return"AugLoop_Text_IdeasPersonalizationSettingsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[le.getTypeName()])}}le.H_={T_:le.getTypeName(),B_:le.getBaseTypes()};class ue{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ue,this,e)}static getTypeName(){return"AugLoop_Text_TextToSpeechAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ue.getTypeName()])}}ue.H_={T_:ue.getTypeName(),B_:ue.getBaseTypes()};class de{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(de,this,e)}static getTypeName(){return"AugLoop_Text_AutoreplaceAnnotation"}static getBaseTypes(){return["AugLoop_Text_Critique","AugLoop_Text_SuggestionsAnnotation","AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[de.getTypeName()])}}de.H_={T_:de.getTypeName(),B_:de.getBaseTypes()};class ce{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){$.h.assign(ce,this,e)}static getTypeName(){return"AugLoop_Text_TextStreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_StreamAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return $.h.matchesTypesFor(e,[ce.getTypeName()])}}ce.H_={T_:ce.getTypeName(),B_:ce.getBaseTypes()};var he=n(66526),ge=n(6754),pe=n(18054);const fe=(0,l.f)("ILanguageDetectionSubscriber");var me=n(58889),ve=n(90725),ye=n(46546);const _e=(0,l.f)("IReactComponentInitializer");var be=n(13111),Ce=n(97645),Te=n(71115);const Se=(0,l.f)("IEditorClient");var Ie=n(44680),we=n(16103);const Ee=(0,l.f)("ReactComponentModules");var xe=n(29594);class Ae{constructor(e,t,n,i=void 0,r,o,a=new Date){this.hostSettings=e,this.isEditorClientShutdown=!1,this.isInitialized=!1,this.isUXInitialized=!1,this._proofingDisabled=!1,this.onWindowUnloaded=()=>{this.shutDown()},this.rootInjector=((e,t,n,i,r,o,a)=>{const s=new be.J(t.generateModuleKey),l=s.container;l.bind(Te.p).toValue(l),l.bind(Te.k).toValue(l.resolveNew),l.bind(be.J).toValue(s),l.bind(Se).toValue(e),l.bind(Ie.n).toValue(t),l.bind(Ee).toValue(o),n&&l.bind(Ce.P).toValue(n),null==a||a(l),"configureRootServices"in i?s.addModule(i):l.bind(we.qy).toValue(i);for(const e of r)s.addModule(e);return s})(this,e,i,r,t,n,o),this.diContainer=this.rootInjector.container,this.roamingDictionaryFeatureObj=this.diContainer.get(B.Zp),this.externalSettingsFeatureObj=this.diContainer.get(R.In),this.userInfoUpdater=this.diContainer.get(L.M),this.hostEmitter=this.diContainer.get(M.M5),this.logger=this.diContainer.get(v.g),this.proofingDom=this.diContainer.get(he.w),this.proofingPersistedStore=this.diContainer.get(m.K),this.featureFlagReader=this.diContainer.get(q.c),e.enableOrchestration&&(this.orchestrator=this.diContainer.get(pe.J)),window.frameElement&&(this.windowEventListener=new U.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnloaded)),this._editorInitializationStartTime=a}registerTextTileEventListener(e){try{return this.hostEmitter.on(M.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983245,"Failed to register hostModelTextTile listener",e),!1}}registerDeltaEventListener(e){try{return this.hostEmitter.on(M.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983244,"Failed to register hostModelDelta listener",e),!1}}registerTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.on(M.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257550,"Failed to register hostModelTextTileEmittedToAugloop listener",e),!1}}unregisterTextTileEventListener(e){try{return this.hostEmitter.off(M.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983243,"Unable to unregister hostModelTextTile listener - no listener registered",e),!1}}unregisterDeltaEventListener(e){try{return this.hostEmitter.off(M.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983242,"Unable to unregister hostModelDelta listener - no listener registered",e),!1}}unregisterTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.off(M.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257549,"Unable to unregister hostModelTextTileEmittedToAugloop listener - no listener registered",e),!1}}async setLocale(e){let t="string"==typeof e?[e]:e;0===t.length&&(t=[this.hostSettings.defaultLocale]);const n=await this.proofingPersistedStore.read(f.l.ProofingLanguages),i=t.toString()!==n.toString();await this.proofingPersistedStore.write(f.l.ProofingLanguages,t);const r=this.diContainer.getOptional(W.o);return null==r||r.emit("proofingLanguageChanged",{data:new j.I(t),messageType:g.G.ChangeData,proofingLanguagesChanged:i}),!!r}async setMultiLingualProofingLocales(e){await this.setLocale(e)}async enableSpelling(){await this._enableDisableSpelling(!0)}async disableSpelling(){await this._enableDisableSpelling(!1)}async enableGrammar(){await this._enableDisableGrammar(!0)}async enableRefinements(){await this._enableDisableRefinements(!0)}async setOverriddenCritiqueTypeOptions(e){await this.proofingPersistedStore.write(f.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(S.D).setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}async disableGrammar(){await this._enableDisableGrammar(!1)}async disableRefinements(){await this._enableDisableRefinements(!1)}async isSpellingEnabled(){return this.proofingPersistedStore.read(f.l.EnableSpelling)}async isGrammarEnabled(){return this.proofingPersistedStore.read(f.l.EnableGrammar)}async areRefinementsEnabled(){return this.proofingPersistedStore.read(f.l.EnableRefinements)}async _enableDisableSpelling(e){await this.proofingPersistedStore.read(f.l.EnableSpelling)!==e&&(await this.proofingPersistedStore.write(f.l.EnableSpelling,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableGrammar(e){await this.proofingPersistedStore.read(f.l.EnableGrammar)!==e&&(await this.proofingPersistedStore.write(f.l.EnableGrammar,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableRefinements(e){await this.proofingPersistedStore.read(f.l.EnableRefinements)!==e&&(await this.proofingPersistedStore.write(f.l.EnableRefinements,e),this._emitEnabledCritiqueTypesChanged())}_refreshTileNodes(){this.diContainer.get(T.G).pollNodes(g.G.ChangeData,this.proofingDom.tileNodes,p.Q0.Code,void 0,!0)}clearResources(){const e=this.diContainer.getOptional(ge.s);null==e||e.clearIgnoredWords()}shutDown(){var e,t,n,i;if(!this.isEditorClientShutdown)try{this.isEditorClientShutdown=!0,null===(e=this.diContainer.getOptional(ve.H))||void 0===e||e.logTelemetry(),this.diContainer.unbind(z.jh),this.diContainer.unbind(z.sh),this.diContainer.unbind(z.q4),this.diContainer.unbind(z.Ze),this.diContainer.unbind(z.cg),this.diContainer.unbind(z.oA),this.clearResources(),this.diContainer.get(_e).shutDown(),null===(t=this.windowEventListener)||void 0===t||t.removeAllListeners(),this.windowEventListener=void 0,null===(n=this.orchestrator)||void 0===n||n.shutDown(),this.diContainer.get(H.V).shutDown(),this.diContainer.get(be.J).clear()}catch(e){this.logger.error(520983241,"error while shutting down the editor client.",e),null===(i=this.onError)||void 0===i||i.call(this,"Error while shutting down the editor client.",e)}}logout(){this.hostEmitter.emit(M.pD.logout,{address:void 0,message:void 0})}get roamingDictionaryFeature(){return this.roamingDictionaryFeatureObj}get externalSettingsFeature(){return this.externalSettingsFeatureObj}updateUserInfo(e){this.userInfoUpdater.update(e)}async initialize(e){this.isEditorClientShutdown||(await this.initializeSDK(),await this.initializeUX(e))}async initializeSDK(){var e;if(this.isEditorClientShutdown)return;if(this.isInitialized)return;this.isInitialized=!0,(0,ye.configure)({enforceActions:"observed"});const t=(0,xe.$)();if(await(null==t?void 0:t.loadLocale(this.hostSettings.defaultLocale)),await(null===(e=this.orchestrator)||void 0===e?void 0:e.initialize()),!this.isEditorClientShutdown){await this.diContainer.get(V.H).initializeComponent();try{await this.diContainer.get(G.e).executeAsync(!0)}catch(e){}}}async initializeUX(e){var t,n,i;if(!this.isEditorClientShutdown&&!this.isUXInitialized){this.isUXInitialized=!0;try{this.diContainer.bind(z.jh).toValue(new Q.O(null!=e?e:document)),this.diContainer.bind(z.sh).toValue(new Q.O(null!==(t=(null!=e?e:document).defaultView)&&void 0!==t?t:window)),await this.diContainer.get(_e).initializeComponent()}catch(e){this.logger.error(509634378,"Failed to initialize ux",e),null===(n=this.onError)||void 0===n||n.call(this,"Failed to initialize ux.",e)}null===(i=this.diContainer.getOptional(me.$))||void 0===i||i.schedule(1e3,3e5),await this.initLocale(this.hostSettings.defaultLocale),this.languageDetectionSubscriber=this.diContainer.getOptional(fe),this.logEditorInitializationComplete()}}logEditorInitializationComplete(){const e=new Date,t=(0,K.W)(["initializationEndTime",e.toISOString()],["initializationStartTime",this._editorInitializationStartTime.toISOString()],["initializationTime",e.getTime()-this._editorInitializationStartTime.getTime()],["isCIQEnabled",(this.hostSettings.flightsToTrack||[]).includes("mc-editor-oa")]);if(this.featureFlagReader.flags.enableLoggingModulesAndBindings){const e=this.diContainer.getBindings().map((e=>{const t="function"!=typeof e.token?e.token.toString():e.token.name,n=e.boundServices.map((e=>{var t;return null===(t=e.cache)||void 0===t?void 0:t.constructor.name}));return`${t}: [${n}]`})).toString();t.push(...(0,K.W)(["addedModuleClassNamesSize",this.rootInjector.addedModuleClassNames.size],["addedModuleClassNames",[...this.rootInjector.addedModuleClassNames].join(", ")],["modulesSharingSameModuleKeyButDifferentClassname",[...this.rootInjector.modulesSharingSameModuleKeyButDifferentClassname].join(", ")],["bindings",e]))}this.logger.logActivity("EditorInitializationComplete",void 0,t)}async initLocale(e){await this.setLocale(e)}setAvailableCritiqueTypes(e,t){const n=this.diContainer.getOptional(S.D);n&&(n.setAvailableCritiqueTypes(e,t),this._emitEnabledCritiqueTypesChanged())}async setPaneOnlyOverriddenCritiqueTypeOptions(e){const t=this.diContainer.getOptional(I.M);t&&(await this.proofingPersistedStore.write(f.l.PaneOverriddenCritiqueTypeOptions,e),t.setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}setAvailablePaneOnlyCritiqueTypes(e){const t=this.diContainer.getOptional(I.M);t&&(t.setAvailableCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}_emitEnabledCritiqueTypesChanged(){this.diContainer.get(W.o).emit("enabledCritiqueTypesChanged",{messageType:g.G.ChangeData})}async disableProofing(){var e;if(this._proofingDisabled)return!0;if(!this.orchestrator)return!1;const t=await this.orchestrator.deactivateAnnotations([ie.getTypeName()]);for(const t of this.proofingDom.tileNodes)this.hostEmitter.emit(M.pD.clearCritiquesForNode,{message:{nodeId:t.id,seqId:(null!==(e=t.eventSeqId)&&void 0!==e?e:0).toString()},address:void 0});return this._proofingDisabled=!0,t}async enableProofing(){var e,t;if(this._proofingDisabled&&(null===(e=this.orchestrator)||void 0===e?void 0:e.activateAnnotations([ie.getTypeName()]))){for(const e of this.proofingDom.tileNodes)this.hostEmitter.emit(M.pD.restoreNodeForCritiqueStore,{message:{nodeId:e.id,seqId:(null!==(t=e.eventSeqId)&&void 0!==t?t:0).toString()},address:void 0});this._refreshTileNodes(),this._emitEnabledCritiqueTypesChanged(),this._proofingDisabled=!1}}addWordsToIgnoreList(e){const t=this.diContainer.getOptional(ge.s);null==t||t.addWordsToIgnoreList(e)}setLanguageDetectedCallback(e){var t;null===(t=this.languageDetectionSubscriber)||void 0===t||t.setLanguageDetectedOnSignalCallback(e)}}var De=n(83240),Ne=n(21648);class Fe extends Ae{constructor(e,t,n,i=void 0,r,o,a=new Date){super(e,t,n,i,r,o,a),this.critiqueSuggestionClearanceCallbacks=[],this.updateDarkMode=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDarkMode(e)},this.getComponentsSupportedForTheming=()=>{var e,t;return null!==(t=null===(e=this.themeStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.updateDefaultTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDefaultTheme(e)},this.updateCurrentTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateCurrentTheme(e)},this.getComponentsSupportedForStyling=()=>{var e,t;return null!==(t=null===(e=this.styleStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.isPremiumUser=this.diContainer.get(h.r),this.themeStore=this.diContainer.getOptional(k.YQ),this.styleStore=this.diContainer.getOptional(k.UC),this.themeStore&&k.Cx.forEach(((e,t)=>{var n;null===(n=this.themeStore)||void 0===n||n.updateComponentThemes(t,e)})),this.styleStore&&k.w.forEach(((e,t)=>{var n;null===(n=this.styleStore)||void 0===n||n.updateComponentStyle(t,e)}))}async initLocale(e){var t,n;const i=null!==(n=this.hostSettings.isMultilingualProofingEnabled&&(null===(t=this.hostSettings.proofingLocales)||void 0===t?void 0:t.length)?this.hostSettings.proofingLocales:void 0)&&void 0!==n?n:[e];await this.setLocale(i),await this.setUiLocale(e)}async setLocale(e){const t="string"==typeof e?[e]:e;return super.setLocale(t)}async setUiLocale(e){var t;const n=(0,xe.$)().loadLocale(e);await n;const i=this.diContainer.getOptional(De.C);if(i)try{await i.setUiLocale(e)}catch(n){this.logger.error(507885057,"Failed to initialize categories locale for: "+e,n),null===(t=this.onError)||void 0===t||t.call(this,"Failed to initialize categories locale for: "+e,n)}}setLocaleForTile(e,t){const n=this.proofingDom.findTileNode(e);return!!n&&(n.specifiedLocale=t,n.resetState(),this.diContainer.get(b.$).resetNode(n.id),this.diContainer.get(T.G).pollNodes(g.G.NewData,[n],p.Q0.Code,void 0,!0),!0)}registerCustomIconSet(e){for(const t of Object.keys(e))(0,O.Z)(t,e[t])}async setBothOverrideAndPaneOnlyOverriddenCritiqueTypeOptions(e,t){await this.proofingPersistedStore.write(f.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(S.D).setOverriddenCritiqueTypes(e);const n=this.diContainer.getOptional(I.M);n&&(await this.diContainer.get(m.K).write(f.l.PaneOverriddenCritiqueTypeOptions,t),n.setOverriddenCritiqueTypes(t)),this._emitEnabledCritiqueTypesChanged(),this._refreshTileNodes()}enablePremiumUntil(e){this.isPremiumUser.setGracePeriodUntil(e)}setPremiumCritiqueTypes(e){this.diContainer.get(w.g).setPremiumCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}setPreviewCritiquesCount(e,t){const n=this.diContainer.get(E.Ey);n.setPreviewModeActive(!0),n.setPreviewCount(e,!0),n.setPreviewUnit(t)}setPremiumPreviewActive(e){this.diContainer.get(E.Ey).setPreviewModeActive(e)}setLightUpPremiumSquiggles(e){this.diContainer.get(E.Ey).setLightUpPremiumSquiggles(e)}onPremiumCountChange(e){this.diContainer.get(E.Ey).setOnPremiumCountChange(e)}onPreviewCritiquesCountChange(e){this.diContainer.get(E.Ey).setOnPreviewCritiquesCountChange(e)}onDisableCritique(e){this.diContainer.get(x.W).setOnDisableCritique(e)}onFeedbackIconClicked(e){this.diContainer.get(A.M).setOnFeedbackIconClicked(e)}async setLanguageValueFromConfigResponses(e,t,n){const i=this.diContainer.get(D);await i.setLanguageValueFromConfigResponses(e,t,n)}onApplyCritiqueSuggestion(e,t){const n=this.diContainer.get(C.a).handleApplyCritiqueSuggestion(e,t);this.critiqueSuggestionClearanceCallbacks.push(n)}exp_getActivityLogger(){return this.diContainer.get(v.g)}exp_getOaLogger(){return this.diContainer.get(y.m)}exp_getQueryDetection(){return this.diContainer.get(_.J)}onTryPremiumPreview(e){this.diContainer.get(E.Ey).setOnTryPremiumPreview(e)}onPremiumPreviewExpired(e){this.diContainer.get(E.Ey).setOnPremiumPreviewExpired(e)}getComponentThemes(e){var t;return null===(t=this.themeStore)||void 0===t?void 0:t.getComponentThemes(e)}getDefaultTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.defaultTheme}getCurrentTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme}updateComponentThemes(e,t){var n;null===(n=this.themeStore)||void 0===n||n.updateComponentThemes(e,t)}getComponentStyle(e){var t;return null===(t=this.styleStore)||void 0===t?void 0:t.getComponentStyle(e)}updateComponentStyle(e,t){var n;null===(n=this.styleStore)||void 0===n||n.updateComponentStyle(e,t)}updateFluentThemes(e){var t;null===(t=this.themeStore)||void 0===t||t.updateFluentThemes(e)}setOnCritiqueAdded(e){this.diContainer.get(N.y).setOnCritiqueAdded(e)}enableInlineSuggestionsMenu(e,t,n,i,r,o,a,s,l,u,d,c,h,g,p,f,m,v,y,_,b,C,T,S){if(!t)throw Error("You must specify a query character.");this.enableMenu(Object.assign({queryChar:t,onItemSelected:n,styles:a,onOpen:s,onClose:l,onAction:u,shouldRemoveTextOnItemSelection:d,specifiedItemsToDisplay:i,onSuggestionsUpdated:c,onRestoreFocus:h,onPreventDismissCalloutOnEvent:g,onGroupSelected:p,brandingMode:f,getLocalItems:v,isDividerShown:y,noSuggestionsHeaderInfo:_,newEntityTypes:b,newItemsById:T},C?{enableExpandedECC:!0,enableExpandedMenuSearchBar:S,supportedEntityTypes:null!=e?e:[]}:{enableExpandedECC:!1,supportedEntityTypes:e,enableScopedHeader:m}))}enableMenu(e){var t;(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)&&(this.diContainer.get(Ne.V).enableMenu(e),this.logger.logActivity("ECCMenuEnabled"))}disableInlineSuggestionsMenu(e){var t;(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)&&this.diContainer.get(Ne.V).disableInlineSuggestionsMenu(e)}showInlineSuggestionsMenuWithItems(e,t,n,i,r,o,a,s){var l;return(null===(l=this.hostSettings.oaSettings)||void 0===l?void 0:l.isContextualCardEnabled)?this.diContainer.get(Ne.V).renderMenuWithItems(e,t,n,i,r,o,a,s):Promise.resolve(!1)}async showExistingMenu(e,t,n,i,r,o,a,s,l,u){var d;if(null===(d=this.hostSettings.oaSettings)||void 0===d?void 0:d.isContextualCardEnabled){const d=this.diContainer.get(Ne.V);await d.showExistingMenu(e,t,n,i,r,o,a,s,l,u)}}async showExistingMenuAtCursor(e,t,n){var i;if(!(null===(i=this.hostSettings.oaSettings)||void 0===i?void 0:i.isContextualCardEnabled))return;const r=this.diContainer.get(F.d),o=await r.getTextSelection();(null==o?void 0:o.endParagraphNode)&&void 0!==o.endPositionInParagraphNode&&await this.showExistingMenu(o.endParagraphNode.id,o.endPositionInParagraphNode-e,e,t,!1,n)}async insertAndDisplayInlineSuggestionsMenu(e,t,n){var i;if(!e)return!1;if(null===(i=this.hostSettings.oaSettings)||void 0===i?void 0:i.isContextualCardEnabled){const i=this.diContainer.get(F.d);let r,o;if(t&&n){const e=this.proofingDom.findParagraphNode(t);if(!(0,P.l)(e))return!1;r=e.parent,o=await i.getNodeInsertionPosition(r,e.element.offset+n,!0)}else{const e=await i.getTextSelection();if(!e||e.startParentElement.id!==e.endParentElement.id)return!1;r=e.startParentElement,o=e.startPosition===e.endPosition?await i.getNodeInsertionPosition(r,e.startPosition,!0):await i.getRangeOfNode(r,void 0,e.startPosition,e.endPosition-e.startPosition)}return!!o&&(await i.insert(r,void 0,0,e,!0,o,!0),!0)}return!1}shutDown(){try{super.shutDown();for(const e of this.critiqueSuggestionClearanceCallbacks)e();this.critiqueSuggestionClearanceCallbacks=[]}catch(e){this.logger.error(509690076,"error while shutting down the editor client.",e)}}notifyMenuTriggeringMethod(e){this.diContainer.get(Ne.V).notifyMenuTriggeringMethod(e)}}var Pe=n(92037),ke=n(90935),Oe=n(86388),Be=n(20399),Re=n(59834),Le=n(48828),Me=n(90424);let qe=class{constructor(e,t){this.logger=e,this.proofingEmitter=t,this.loggerEventName="AggregateEventCount",this.dataToLog={eventCountMap:{},metadata:{locales:[]}}}async initialize(){this.proofingEmitter.on("proofingLanguageChanged",(e=>{this.updateMetadata({locales:e.data.codesList.slice()})}))}incrementEventCount(e,t,n=1){var i,r,o;const a=null!==(i=(o=this.dataToLog.eventCountMap)[e])&&void 0!==i?i:o[e]={};null!==(r=a[t])&&void 0!==r||(a[t]=0),a[t]+=n}shutDown(){this.logger.logEvent(512304030,this.loggerEventName,Be.q.Info,void 0,Re.o.SamplingPolicy.Measure,this.dataToLog,void 0)}updateMetadata(e){this.dataToLog.metadata=Object.assign(Object.assign({},this.dataToLog.metadata),e)}};qe=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(v.g)),(0,r.__param)(1,(0,Me.W)(W.o))],qe);var Ue=n(29320),We=n(29714),je=n(33984),ze=n(31685),He=n(98242),Ve=n(83225),Ge=n(76511);let Qe=class{getUILanguage(){return navigator.language}async getBrowserLanguages(){return Promise.resolve([navigator.language])}};Qe=(0,r.__decorate)([(0,Le._)()],Qe);let Ke=class{getUrl(e){return e}};Ke=(0,r.__decorate)([(0,Le._)()],Ke);var $e=n(60933),Ze=n(38714),Je=n(97428);class Ye{constructor(){this.imports=[$e.u]}get uniqueId(){return(0,Je.z)(507918421)}configureRootServices(e){e.bind(je.n).to(Ke),e.bind(Ve.v).to(Qe),e.bind(ze.j).to(ze.c),e.bind(We.S).toExisting(ze.j),e.bind(z.oA).toDynamicValue((e=>()=>e.getOptional(z.q4))),e.bind(z.Ze).toDynamicValue((e=>()=>e.getOptional(z.jh))),e.bind(z.cg).toDynamicValue((e=>()=>e.getOptional(z.sh))),e.bind(Ue.m).to(Ue.r),e.bind(Ge.H).toSelf(),e.bind(Ze.W).toSelf(),e.bind(He.DS).to(He.KW)}}var Xe=n(13915);class et{constructor(){this.imports=[Ye]}get uniqueId(){return(0,Je.z)(507918427)}configureRootServices(e){e.bind(We.S).toExisting(Xe.v),e.bind(Xe.v).to(qe)}}const tt=(0,l.f)("IChildElementFinderFactory"),nt=(0,l.f)("IGrammarTerminalSymbol"),it=(0,l.f)("IGrammarNonTerminalSymbolExpanded"),rt=((0,l.f)("IGrammarRules"),(0,l.f)("IGraphNodeFactory")),ot=(0,l.f)("IParagraphNodeFactory");var at=n(3755),st=n(39441);const lt=(0,l.f)("INodeObserverFactory"),ut=(0,l.f)("IMutationObserverFactory");var dt=n(6638);const ct=(0,l.f)("IParagraphNodesBuilderFactory"),ht=(0,l.f)("IParagraphNodesBuilder");var gt,pt=n(61758),ft=n(37629),mt=n(82629),vt=n(85999);!function(e){e.DefaultOutlineNodeObserver="DefaultOutlineNodeObserver",e.TerminalNodeObserver="TerminalNodeObserver",e.InputNodeObserver="InputNodeObserver",e.AttributeObserver="AttributeObserver"}(gt||(gt={}));var yt=n(40144);class _t{constructor(e,t,n,i,r,o){this._observer=t,this.nodeType=e,this.id=null!=o?o:(0,yt.h)(),this._children=n,this.element=i,this.parent=r}get children(){return this._children}set children(e){this._children=e}retire(){if(this._observer.disconnect(this.element),this.children)for(const e of this.children)e.retire();this.children=void 0}move(e,t){return this._observer.disconnect(this.element),this.id=(0,yt.h)(),e&&(this.element=e),t&&(this.parent=t),this}resetState(){}}let bt=class extends _t{constructor(e,t,n,i,r,o,a,s,l,u){super(n,i,void 0,r,o,a),this._proofingDom=e,this._tileContent=t,this.nodeType=n,this._observer=i,this.element=r,this.parent=o,this._logger=s,this._nodeTraverser=l,this._hostSettings=u,this._children=[],this.id=(0,yt.h)(),this._proofingDom.registerNode(this)}get children(){var e,t;return(null===(e=this._hostSettings)||void 0===e?void 0:e.sdkV2Enabled)?null!==(t=this._proofingDom.getTileNodeV2Paragraphs(this))&&void 0!==t?t:[]:this._children}set children(e){this._children=e}retire(){var e;this.parent=void 0,null===(e=this._logger)||void 0===e||e.debug(0,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}move(e,t){return this._proofingDom.unregisterNode(this),super.move(e,t),this._proofingDom.registerNode(this),this}resetState(e){}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,n,i,r,o){}get plainText(){return this.pullText().content}getPreviousTileId(){var e;const t=null===(e=this._nodeTraverser)||void 0===e?void 0:e.findPreviousTileNode(this);return"#head#"===t?t:null==t?void 0:t.id}getNextTileId(){var e;const t=null===(e=this._nodeTraverser)||void 0===e?void 0:e.findNextTileNode(this);return"#tail#"===t?t:null==t?void 0:t.id}};bt=(0,r.__decorate)([(0,Le._)()],bt);let Ct=class extends _t{constructor(e,t,n,i){super(vt.Z.TerminalNode,e,void 0,t,n,i),this._observer=e,this.retiredCallbacks=[],this.visualizationRemovedCallbacks=[],this.element&&this._observer.observe(this.element)}retire(){for(const e of this.retiredCallbacks)e();this.retiredCallbacks=[],this.visualizationWasRemoved(),super.retire()}move(e,t){if(super.move(e,t),this.children)for(const t of this.children)t.move(e);return this.element&&this._observer.observe(this.element),this}resetState(){}registerRetireCallback(e){this.retiredCallbacks.push(e)}registerVisualizationRemovedCallback(e){this.visualizationRemovedCallbacks.push(e)}visualizationWasRemoved(){for(const e of this.visualizationRemovedCallbacks)e();this.visualizationRemovedCallbacks=[]}};function Tt(e,t,n){if(e.spellcheck){const n=e.closest("[contenteditable=true]"),i=null==n?void 0:n.getAttribute("spellcheck"),r=e.getAttribute("spellcheck");return n?n.setAttribute("spellcheck","false"):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(n||e).setAttribute(t.editorSpellcheckAttribute,"true"),n=>{const o=n.closest("[contenteditable=true]");o?i?o.setAttribute("spellcheck",i):o.removeAttribute("spellcheck"):r?(e.setAttribute("spellcheck",r),e.spellcheck=!1):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(o||n).removeAttribute(t.editorSpellcheckAttribute)}}return(null==n?void 0:n.some((t=>t(e))))?((e.closest("[contenteditable=true]")||e).setAttribute(t.editorSpellcheckAttribute,"true"),e=>{(e.closest("[contenteditable=true]")||e).removeAttribute(t.editorSpellcheckAttribute)}):()=>{}}Ct=(0,r.__decorate)([(0,Le._)()],Ct);var St=n(30225);let It=class{constructor(e,t,n,i,r,o,a,s,l,u,d,c,h,f,m){this._observerFactory=e,this._tileContent=t,this._proofingDom=n,this._nodePoller=i,this._tileNodeReader=r,this._settings=o,this._hostSettings=a,this._childElementsFinderFactory=s,this._hostEmitter=u,this._graphNodeFactory=d,this.shadowElementsStore=h,this.textEventPublisher=f,this.nodeTraverser=m,this.buildNode=(e,t,n,i)=>{var r,o;const a=this._observerFactory(this._graphNodeBuilderTerminalRule.observerType,this._graphNodeBuilderTerminalRule),s=new Ct(a,e,t,i),l=this._childElementsFinderFactory(this._graphNodeBuilderTerminalRule.elementsFinder),u=this._getNewTopology(s,l,s).map((e=>this.createTileNode(e,s)));s.children=u,s.documentModel=n;const d=Tt(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);return s.registerVisualizationRemovedCallback((()=>{const e=this._tileContent.getContainingElement(s);e&&d(e)})),((0,at.C)(e,"HTMLInputElement")||(0,at.C)(e,"HTMLTextAreaElement"))&&(null===(r=this.shadowElementsStore)||void 0===r||r.setCanvasElement(u[0].id,e)),a.onElementAdded=(e,t)=>{var n;s.element&&!s.element.contains(e)||this._nodePoller.pollNodes(g.G.NewData,null!==(n=s.children)&&void 0!==n?n:[],t,void 0,void 0,void 0,!this._hostSettings.enableOrchestration)},a.onElementChanged=(e,t,n,i)=>{this._nodePoller.pollNodes(g.G.ChangeData,this._getChildrenToReconcile(s,e),t,void 0,void 0,void 0,void 0,i)},a.onElementRemoved=(e,t)=>{var n;this._nodePoller.pollNodes(g.G.ChangeData,null!==(n=s.children)&&void 0!==n?n:[],t)},a.onVisualStateChanged=(e,t)=>{var n,i,r,o,a;if("StyleChange"!==t){if("Created"===t){const e=this._tileContent.getContainingElement(s);if(e){const t=Tt(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);s.registerRetireCallback((()=>{const e=this._tileContent.getContainingElement(s);e&&t(e)}))}}else s.visualizationWasRemoved();this._nodePoller.pollNodes(g.G.ChangeData,null!==(i=s.children)&&void 0!==i?i:[],p.Q0.Code,void 0,!0,void 0,void 0);for(const e of null!==(r=s.children)&&void 0!==r?r:[])null===(o=this._hostEmitter)||void 0===o||o.emit(M.pD.hostModelVisualStateChange,{address:void 0,message:{tileId:e.id,tileVersion:null!==(a=e.eventSeqId)&&void 0!==a?a:0,created:"Created"===t}})}else null===(n=this.textEventPublisher)||void 0===n||n.publishTextStyleEvent()},this._nodePoller.pollNodes(g.G.NewData,s.children,null!==(o=this._graphNodeBuilderTerminalRule.initialContentChangeType)&&void 0!==o?o:p.Q0.Code),s},this._getNewTopology=(e,t,n)=>e.element?t.find(e.element,this._graphNodeBuilderTerminalRule.filterSelector).filter((e=>this._graphNodeBuilderTerminalRule.filters.every((t=>t(e,n,this._graphNodeBuilderTerminalRule))))):[],this._graphNodeBuilderTerminalRule=l.nodeMetaType,this._paragraphNodesBuilder=null==c?void 0:c(this._graphNodeBuilderTerminalRule.completeTileTextUnit,this._graphNodeBuilderTerminalRule.partialTileTextUnit)}_getChildrenToReconcile(e,t){return[...(e.children||[]).filter((e=>{var n,i;return null!==(i=null===(n=e.element)||void 0===n?void 0:n.contains(t))&&void 0!==i?i:!this._settings.narrowOnChangeReconciliation&&this._tileNodeReader.critiques(e).length}))]}createTileNode(e,t){const n=this._observerFactory(gt.AttributeObserver),i=this._paragraphNodesBuilder&&this._graphNodeFactory?this._graphNodeFactory(vt.Z.TileNode,n,e,t,void 0,this._paragraphNodesBuilder):new bt(this._proofingDom,this._tileContent,vt.Z.TileNode,n,e,t,void 0,void 0,this.nodeTraverser,this._hostSettings);return this._hostSettings.disableTileNodeObserver||(n.onElementChanged=(e,t)=>{this._nodePoller.pollNodes(g.G.NewData,[i],t)},n.observe(document.body)),i}};It=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(lt)),(0,r.__param)(1,(0,Me.W)(F.d)),(0,r.__param)(2,(0,Me.W)(he.w)),(0,r.__param)(3,(0,Me.W)(T.G)),(0,r.__param)(4,(0,Me.W)(mt.j)),(0,r.__param)(5,(0,Me.W)(st.k)),(0,r.__param)(6,(0,Me.W)(Ie.n)),(0,r.__param)(7,(0,Me.W)(tt)),(0,r.__param)(8,(0,Me.W)(it)),(0,r.__param)(9,(0,St.l)()),(0,r.__param)(9,(0,Me.W)(M.M5)),(0,r.__param)(10,(0,St.l)()),(0,r.__param)(10,(0,Me.W)(rt)),(0,r.__param)(11,(0,St.l)()),(0,r.__param)(11,(0,Me.W)(ct)),(0,r.__param)(12,(0,St.l)()),(0,r.__param)(12,(0,Me.W)(pt.S)),(0,r.__param)(13,(0,St.l)()),(0,r.__param)(13,(0,Me.W)(ft.n)),(0,r.__param)(14,(0,St.l)()),(0,r.__param)(14,(0,Me.W)(dt.M))],It);var wt=n(28121);let Et=class{constructor(e,t,n){this._mutationObserverFactory=e,this.elementTransformers=t,this._logger=n,this.connectMutationObserver=(e,t,n,i)=>{this._mutationObserver=this._mutationObserverFactory((e=>{e.forEach(((e,r,o)=>{const a=null==i?void 0:i.filterSelector;let s=!1;t.ignoredMutationElementsSelectors&&(0,at.C)(e.target,"Element")&&(s=e.target.matches(t.ignoredMutationElementsSelectors)),a&&a!==e.target.nodeName&&s||this.handleMutation(e,p.Q0.Local,null==n?void 0:n(e,r,o))}))})),this._mutationObserver.observe(e,t)},this.flushMutationObserver=e=>{this._mutationObserver&&this._mutationObserver.takeRecords().forEach(((t,n,i)=>this.handleMutation(t,p.Q0.Local,e?e(t,n,i):void 0)))},this.handleMutation=(e,t,n)=>{var i;try{const i=this.onElementRemoved,r=this.onElementAdded,o=this.onElementChanged;switch(e.type){case"childList":i&&Array.from(e.removedNodes).forEach((e=>{i(e,t,n)})),r&&Array.from(e.addedNodes).forEach((e=>{r(e,t,n)}));break;case"characterData":o&&o(e.target,t);break;case"attributes":this.handleAttributeChange(e,t,r,o,i)}}catch(e){null===(i=this._logger)||void 0===i||i.logEvent(508146690,wt.s.MutationError,Be.q.Error,"Error while processing a mutation.",Re.o.SamplingPolicy.CriticalBusinessImpact,e)}}}handleAttributeChange(e,t,n,i,r){const o=e.attributeName,a=e.target;this.elementTransformers&&o&&this.elementTransformers.forEach((e=>{e.attributeList.includes(o)&&e.transform(a)})),null==i||i(a,t,void 0)}disconnect(e){this._mutationObserver&&(this._mutationObserver.takeRecords(),this._mutationObserver.disconnect())}};Et=(0,r.__decorate)([(0,Le._)()],Et);let xt=class extends Et{constructor(e,t,n){super(e,void 0,n),this.mutationObserverFactory=e,this.hostSettings=t,this.logger=n}observe(e){this.connectMutationObserver(e,{attributes:!0,attributeFilter:["style"],characterData:!1,childList:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1,ignoredMutationElementsSelectors:this.hostSettings.ignoredMutationElementsSelectors})}};xt=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(ut)),(0,r.__param)(1,(0,Me.W)(Ie.n)),(0,r.__param)(2,(0,St.l)()),(0,r.__param)(2,(0,Me.W)(v.g))],xt);let At=class extends Et{constructor(e,t,n){super(e,null==n?void 0:n.elementTransformers,t),this.mutationObserverFactory=e,this._logger=t,this._lastCharacterModificationReplacedCharacters=!1,this.connectMutationObserver=(e,t,n)=>{this._mutationObserver=this._mutationObserverFactory((e=>{var t;let i=!1,r=!1;for(let o=0;o<e.length;o++){const a=e[o],s=e;try{const e=this.onElementRemoved,t=this.onElementAdded,l=this.onElementChanged;switch(a.type){case"childList":if(e){const t=Array.from(a.removedNodes);t.length&&!r&&(e(t.pop(),p.Q0.Local,void 0),r=!0)}if(t){const e=Array.from(a.addedNodes);e.length&&!i&&(t(e.pop(),p.Q0.Local,null==n?void 0:n(a,o,s)),i=!0)}break;case"characterData":l&&l(a.target,p.Q0.Local,void 0,this._lastCharacterModificationReplacedCharacters);break;case"attributes":this.handleAttributeChange(a,p.Q0.Local,t,l,e)}}catch(e){null===(t=this._logger)||void 0===t||t.logEvent(508146694,wt.s.MutationError,Be.q.Error,"Error while processing a mutation.",Re.o.SamplingPolicy.CriticalBusinessImpact,e)}finally{this._lastCharacterModificationReplacedCharacters=!1}}})),this._mutationObserver.observe(e,t),this.eventListener=new U.J(e),this.eventListener.addListener("keypress",this.onKeyPress,{passive:!0,capture:!0})},this.onKeyPress=e=>{const t=e.currentTarget.ownerDocument.getSelection();(null==t?void 0:t.toString().startsWith(e.key))?this._lastCharacterModificationReplacedCharacters=!0:this._lastCharacterModificationReplacedCharacters=!1},this._mutationContextBuilder=null==n?void 0:n.mutationContextBuilder,this.elementTransformers=null==n?void 0:n.elementTransformers}observe(e){const t={attributes:!1,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1};if(this.elementTransformers){const e=new Set;for(const t of this.elementTransformers)for(const n of t.attributeList)e.add(n);e.size&&(t.attributes=!0,t.attributeFilter=Array.from(e.values()))}this.connectMutationObserver(e,t,this._mutationContextBuilder),this._styleChangeObserver=this.mutationObserverFactory((e=>{this.onVisualStateChanged&&e.length>0&&this.onVisualStateChanged(e[0].target,"StyleChange")})),this._styleChangeObserver.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style"]})}disconnect(e){var t,n,i;super.disconnect(e),null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,null===(n=this._styleChangeObserver)||void 0===n||n.takeRecords(),null===(i=this._styleChangeObserver)||void 0===i||i.disconnect()}};At=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(ut)),(0,r.__param)(1,(0,St.l)()),(0,r.__param)(1,(0,Me.W)(v.g)),(0,r.__param)(2,(0,St.l)()),(0,r.__param)(2,(0,Me.W)(nt))],At);let Dt=class extends Et{constructor(e,t){super(e,void 0,t),this.mutationObserverFactory=e,this.logger=t,this._onElementChangedEvent=e=>{const t=this.onElementChanged;t&&this._element&&t(this._element,p.Q0.Local,void 0)}}observe(e){var t;((0,at.C)(e,"HTMLInputElement")||(0,at.C)(e,"HTMLTextAreaElement")||(0,at.C)(e,"HTMLDivElement"))&&(this._element=e,null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=new U.J(e),this.eventListener.addListener("input",this._onElementChangedEvent,{passive:!0}),this.eventListener.addListener("BX-ForceReflow",this._onElementChangedEvent,{passive:!0}),this.connectMutationObserver(this._element,{attributes:!1,characterData:!1,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}))}disconnect(e){var t;null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,super.disconnect(e),this._element=void 0}};Dt=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(ut)),(0,r.__param)(1,(0,St.l)()),(0,r.__param)(1,(0,Me.W)(v.g))],Dt);let Nt=class{constructor(e,t,n,i,r,o,a,s,l,u,d,c,h){this.hostSettings=e,this.proofingDom=t,this._settings=n,this._tileContent=i,this._tileNodeReader=r,this._nodePoller=o,this._textEventPublisher=a,this.logger=s,this.targetDocumentFactory=l,this._hostEmitter=u,this._graphNodeFactory=d,this._paragraphNodesBuilderFactory=c,this.shadowElementsStore=h}createGraphNode(e){const{element:t,filterSelector:n,parent:i,initialContentChangeType:r,documentModel:o,terminalNodeId:a}=e;if(this._validateElementWithProofingDom(t))return this.getGraphNodeBuilderFactory(t,n,r).buildNode(t,i,o,a)}getGraphNodeBuilderFactory(e,t,n){const i=this.getObserverTypeBasedOnElement(e),r={ruleName:"",nodeMetaType:{nodeType:vt.Z.TerminalNode,observerType:i,filters:[],filterSelector:t,initialContentChangeType:n},childMetaType:null};return new It(((e,t)=>function(e,t,n,i){const r=e=>new MutationObserver(e);switch(e){case gt.InputNodeObserver:return new Dt(r,n);case gt.TerminalNodeObserver:return new At(r,n);default:return new xt(r,{ignoredMutationElementsSelectors:i},n)}}(e,0,this.logger,this.hostSettings.ignoredMutationElementsSelectors)),this._tileContent,this.proofingDom,this._nodePoller,this._tileNodeReader,this._settings,this.hostSettings,(()=>({find:e=>[e]})),r,this._hostEmitter,this._graphNodeFactory,this._paragraphNodesBuilderFactory,this.shadowElementsStore,this._textEventPublisher)}getObserverTypeBasedOnElement(e){return(0,at.C)(e,"HTMLInputElement")||(0,at.C)(e,"HTMLTextAreaElement")?gt.InputNodeObserver:gt.TerminalNodeObserver}_validateElementWithProofingDom(e){var t,n,i,r;if(!(0,at.C)(e,"HTMLElement"))return!0;for(const n of this.proofingDom.tileNodes.values())if((0,at.C)(n.element,"HTMLElement")&&(n.element.contains(e)||e.contains(n.element)))return null===(t=this.logger)||void 0===t||t.error(508146704,"The element is already contained within another attached element."),!1;if(!this.hostSettings.doNotLimitToTargetDocument&&this.targetDocumentFactory){const t=null===(n=this.targetDocumentFactory())||void 0===n?void 0:n.deref();if(t&&e.ownerDocument!==t)return null===(i=this.logger)||void 0===i||i.error(508146703,"The element must be within the target document."),!1}return!!((0,at.C)(e,"HTMLInputElement")&&["text","search"].includes(e.type)||(0,at.C)(e,"HTMLTextAreaElement")||e.isContentEditable)||(null===(r=this.logger)||void 0===r||r.error(508146702,"Unsupported element - only input (of type search and text only), textarea, and content editable elements are supported."),!1)}};var Ft,Pt,kt,Ot,Bt,Rt,Lt,Mt,qt,Ut,Wt,jt;Nt=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(Ie.n)),(0,r.__param)(1,(0,Me.W)(he.w)),(0,r.__param)(2,(0,Me.W)(st.k)),(0,r.__param)(3,(0,Me.W)(F.d)),(0,r.__param)(4,(0,Me.W)(mt.j)),(0,r.__param)(5,(0,Me.W)(T.G)),(0,r.__param)(6,(0,St.l)()),(0,r.__param)(6,(0,Me.W)(ft.n)),(0,r.__param)(7,(0,St.l)()),(0,r.__param)(7,(0,Me.W)(v.g)),(0,r.__param)(8,(0,St.l)()),(0,r.__param)(8,(0,Me.W)(z.Ze)),(0,r.__param)(9,(0,St.l)()),(0,r.__param)(9,(0,Me.W)(M.M5)),(0,r.__param)(10,(0,St.l)()),(0,r.__param)(10,(0,Me.W)(rt)),(0,r.__param)(11,(0,St.l)()),(0,r.__param)(11,(0,Me.W)(ct)),(0,r.__param)(12,(0,St.l)()),(0,r.__param)(12,(0,Me.W)(pt.S))],Nt),function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(Ft||(Ft={}));class zt{constructor(e,t){this._textRetrieverFactory=e,this._indexReadjuster=t,this.findOffsetPositions=async(e,t,n=!1,i)=>{const r=new Map;let o=0;t.sort(((e,t)=>e.index-t.index));const a=this.getTargetDocument(e).createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let s,l=0;if(s=void 0!==i?i:this._textRetrieverFactory(e).retrieve().content,t[0]&&t[0].index<0||t[t.length-1]&&t[t.length-1].index>s.length)return r;const u=await this._indexReadjuster.getReadjustedIndices(e,t,s);let d;for(;a.nextNode();){const e=a.currentNode,i=o,s=e.textContent?e.textContent.length:0,c=i+s;for(let o=l;o<t.length;o+=1){const a=u[o];if(a.indexType===Ft.Start&&a.index>=i&&(n?a.index<=c:a.index<c))l+=1,r.set(t[o].startIndex,{startNode:e,startOffset:a.index-i});else{if(!(a.indexType===Ft.End&&a.index>=i&&a.index<=c))break;{l+=1;const n=r.get(t[o].startIndex);if(!n)throw new Error("The critique's end index has no conforming start index.");n.endNode=e,n.endOffset=a.index-i,r.set(t[o].startIndex,n)}}}if(o+=s,s>0&&(d=e),l===t.length)break}if(l!==t.length)if(d){const e=o-(d.textContent?d.textContent.length:0);for(let n=l;n<t.length;n+=1){const i=u[n];if(i.indexType===Ft.Start&&i.index===o)l+=1,r.set(t[n].startIndex,{startNode:d,startOffset:i.index-e});else{if(i.indexType!==Ft.End||i.index!==o)break;{l+=1;const o=r.get(t[n].startIndex);if(!o)throw new Error("The critique's end index has no conforming start index.");o.endNode=d,o.endOffset=i.index-e,r.set(t[n].startIndex,o)}}}}else for(let n=l;n<t.length;n+=1){const i=u[n];if(i.indexType===Ft.Start&&0===i.index)r.set(t[n].startIndex,{startNode:e,startOffset:0});else{if(i.indexType!==Ft.End||0!==i.index)break;{const i=r.get(t[n].startIndex);if(!i)throw new Error("The critique's end index has no conforming start index.");i.endNode=e,i.endOffset=0,r.set(t[n].startIndex,i)}}}return r},this.createRange=(e,t)=>{if(!(null==t?void 0:t.endNode)||void 0===t.endOffset)return;const n=e.createRange();return n.setStart(t.startNode,t.startOffset),n.setEnd(t.endNode,t.endOffset),n},this.getTargetDocument=e=>{var t;return null!==(t=e.ownerDocument)&&void 0!==t?t:document}}async getCritiqueRanges(e,t){const n=[];for(const e of t)n.push({index:e.start,indexType:Ft.Start,startIndex:e.start}),n.push({index:e.start+e.length,indexType:Ft.End,startIndex:e.start});const i=await this.findOffsetPositions(e,n),r=this.getTargetDocument(e);return t.map((e=>{const t=i.get(e.start);return{critique:e,range:this.createRange(r,t)}}))}async getRangeOfNode(e,t,n,i){const r=[];r.push({index:t,indexType:Ft.Start,startIndex:t}),r.push({index:t+n,indexType:Ft.End,startIndex:t});const o=await this.findOffsetPositions(e,r,!1,i),a=this.getTargetDocument(e);return this.createRange(a,o.get(t))}async getNodeInsertionPosition(e,t,n){const i=[];i.push({index:t,indexType:Ft.Start,startIndex:t}),i.push({index:t,indexType:Ft.End,startIndex:t});const r=await this.findOffsetPositions(e,i,n),o=this.getTargetDocument(e);return this.createRange(o,r.get(t))}includePrecedingSpace(e,t){let n;if(t.startOffset>=0&&t.startContainer.textContent&&" "===t.startContainer.textContent.charAt(t.startOffset-1))n={startNode:t.startContainer,startOffset:t.startOffset-1};else if(0===t.startOffset){const i=this.getTargetDocument(e).createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(i.currentNode=t.startContainer;i.previousNode();){const e=i.currentNode;if(e.nodeType===e.TEXT_NODE&&e.textContent&&e.textContent.length>0){e.textContent.endsWith(" ")&&(n={startNode:e,startOffset:e.textContent.length-1});break}}}return n&&t.setStart(n.startNode,n.startOffset),t}}class Ht{constructor(e){this.element=e}retrieve(){return{content:this.element.value}}}class Vt{constructor(e){this.element=e}retrieve(){return{content:this.element?Gt(this.element.innerText):""}}}function Gt(e){if(!e.includes("ââ"))return e;const t=e.split("ââ");let n="";return t.forEach(((e,t)=>{t%2==0&&(n+=e)})),n}!function(e){e[e.Unspecified=0]="Unspecified",e[e.Inline=1]="Inline",e[e.Floating=2]="Floating"}(Pt||(Pt={})),function(e){e[e.ThumbsUp=0]="ThumbsUp"}(kt||(kt={})),function(e){e[e.Active=0]="Active",e[e.Resolved=1]="Resolved",e[e.Closed=2]="Closed"}(Ot||(Ot={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered",e[e.Lim=3]="Lim",e[e.Nil=4]="Nil",e[e.Any=5]="Any",e[e.NoList=6]="NoList",e[e.Invalid=7]="Invalid"}(Bt||(Bt={})),function(e){e[e.DontCare=1]="DontCare",e[e.Thin=2]="Thin",e[e.ExtraLight=3]="ExtraLight",e[e.Light=4]="Light",e[e.Normal=5]="Normal",e[e.Medium=6]="Medium",e[e.SemiBold=7]="SemiBold",e[e.Bold=8]="Bold",e[e.ExtraBold=9]="ExtraBold",e[e.Heavy=10]="Heavy"}(Rt||(Rt={})),function(e){e[e.NoCaps=0]="NoCaps",e[e.SmallCaps=1]="SmallCaps",e[e.AllCaps=2]="AllCaps",e[e.AllPetiteCaps=3]="AllPetiteCaps",e[e.PetiteCaps=4]="PetiteCaps",e[e.Unicase=5]="Unicase",e[e.Titling=6]="Titling",e[e.Other=7]="Other"}(Lt||(Lt={})),function(e){e[e.None=0]="None",e[e.Words=1]="Words",e[e.SingleLine=2]="SingleLine",e[e.DoubleLine=3]="DoubleLine",e[e.HeavyLine=4]="HeavyLine",e[e.DottedLine=5]="DottedLine",e[e.DottedHeavyLine=6]="DottedHeavyLine",e[e.DashLine=7]="DashLine",e[e.DashHeavyLine=8]="DashHeavyLine",e[e.DashLongLine=9]="DashLongLine",e[e.DashLongHeavyLine=10]="DashLongHeavyLine",e[e.DotDashLine=11]="DotDashLine",e[e.DotDashHeavyLine=12]="DotDashHeavyLine",e[e.DotDotDashLine=13]="DotDotDashLine",e[e.DotDotDashHeavyLine=14]="DotDotDashHeavyLine",e[e.WavyLine=15]="WavyLine",e[e.WavyHeavyLine=16]="WavyHeavyLine",e[e.WavyDoubleLine=17]="WavyDoubleLine"}(Mt||(Mt={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justified=3]="Justified",e[e.Other=4]="Other",e[e.None=5]="None",e[e.JustifyLow=6]="JustifyLow",e[e.Distributed=7]="Distributed",e[e.ThaiDistributed=8]="ThaiDistributed"}(qt||(qt={})),function(e){e[e.Image=0]="Image",e[e.TextBox=1]="TextBox",e[e.Chart=2]="Chart",e[e.SmartArt=3]="SmartArt",e[e.Drawing=4]="Drawing",e[e.EquationObject=5]="EquationObject",e[e.Ink=6]="Ink",e[e.InkSpace=7]="InkSpace",e[e.InkEndOfLine=8]="InkEndOfLine",e[e.LineBreak=9]="LineBreak",e[e.PageBreak=10]="PageBreak",e[e.PageNumbers=11]="PageNumbers",e[e.FootnoteEndnote=12]="FootnoteEndnote",e[e.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark",e[e.Tab=14]="Tab",e[e.UnsupportedObject=15]="UnsupportedObject",e[e.Other=16]="Other",e[e.Person=17]="Person",e[e.Date=18]="Date"}(Ut||(Ut={})),function(e){e[e.Initial=0]="Initial",e[e.FirstLine=1]="FirstLine",e[e.Hanging=2]="Hanging"}(Wt||(Wt={})),function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(jt||(jt={}));var Qt=n(37120);class Kt extends Vt{constructor(e){super(e),this.parentContentEditable=(0,Qt.m)(e)}retrieve(){const e=super.retrieve();return Object.assign(Object.assign(Object.assign({},e),{isInsideTable:this.getIsInsideTable()}),this.getListTypeAndIndentation())}getIsInsideTable(){if(!this.parentContentEditable)return;let e=this.element;for(;e&&e!==this.parentContentEditable;){if("TABLE"===e.nodeName)return!0;e=e.parentElement}return!1}getListTypeAndIndentation(){if(!this.parentContentEditable)return;let e,t,n=this.element;for(;n&&n!==this.parentContentEditable;)"OL"===n.nodeName&&(e||(e=Bt.Numbered),t=(null!=t?t:-1)+1),"UL"===n.nodeName&&(e||(e=Bt.Bullet),t=(null!=t?t:-1)+1),n=n.parentElement;return{listType:null!=e?e:Bt.NoList,indentation:t}}}class $t{setHtmlElement(e){this.element!==e&&(this.element=e,this.ownerDocument=e.ownerDocument||void 0)}dispatchInputEvent(){if(this.element){const e=new Event("input",{bubbles:!0});this.element.dispatchEvent(e)}}}const Zt="createUndoCheckpoint",Jt=(e,t)=>new Promise((n=>t.requestAnimationFrame(n,e)));class Yt extends $t{constructor(e,t,n){super(),this.textNodeRangeBuilder=e,this._safeWindow=t,this._logger=n,this._textInterceptionMaxTimeoutMs=2e3,this._keysCache="",this._disposed=!1,this.documentKeyboardEventHandler=e=>("keydown"!==e.type||1!==e.key.length||e.altKey||e.ctrlKey||e.metaKey||(this._keysCache+=e.key),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),this.inputInterceptionTimeoutHandler=e=>{this._logger&&this._logger.warn(507248854,`Input interception is shutting down on timeout after ${this._textInterceptionMaxTimeoutMs}ms`),this.stopInputInterception(e)},this.getRange=async(e,t)=>{if(this.element&&this.ownerDocument)return this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)},this.selectRange=(e,t)=>{const n=e.getSelection();if(!n)return;const i=[];for(let e=0;e<n.rangeCount;e++)i.push(n.getRangeAt(e));return n.removeAllRanges(),n.addRange(t),n.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),i},this.selectRanges=(e,t)=>{const n=e.getSelection();if(!n)return!1;if(n.removeAllRanges(),t)for(const e of t)n.addRange(e);return!0},this.focusElementAndPrepareRange=async(e,t,n,i)=>(n.focus(),this.prepareRange(e,t,i)),this.prepareRange=async(e,t,n)=>(await Jt(this.targetWindow,this._safeWindow),!n||n.collapsed?this.getRange(e,t):n)}get targetWindow(){return this.element?(0,at.e)(this.element):window}get disposed(){return this._disposed}async dispose(){var e;this.stopInputInterception(null!==(e=this.ownerDocument)&&void 0!==e?e:this.targetWindow.document),this._disposed=!0}async insert(e,t,n,i,r,o=!0){if(!this.element||!this.ownerDocument)return;const a=this.ownerDocument;o&&await Jt(this.targetWindow,this._safeWindow);let s=i;if(s||(s=await this.textNodeRangeBuilder.getNodeInsertionPosition(this.element,e,n)),s){const e=this.selectRange(a,s);await this.doReplacement(a,t),r&&this.selectRanges(a,e)}}async replace(e,t,n,i){if(!this.element||!this.ownerDocument)return;const{ownerDocument:r,element:o}=this,a=await this.focusElementAndPrepareRange(e,t,o,i);a&&(this.selectRange(r,a),await this.doReplacement(r,n))}async remove(e,t,n,i,r=!0,o){if(!this.element||!this.ownerDocument)return;const{ownerDocument:a}=this;r&&await Jt(this.targetWindow,this._safeWindow);let s=n;if(s&&!s.collapsed||(s=await this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)),s){o&&this.textNodeRangeBuilder.includePrecedingSpace(this.element,s);const n=this.selectRange(a,s);await this.doRemoval(a,(async()=>this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t))),i&&this.selectRanges(a,n)}return s}async autoCorrect(e,t,n,i,r){if(!this.element||!this.ownerDocument)return;let o,a=null;a=this.ownerDocument.getSelection(),a&&a.rangeCount>0&&(o={node:a.focusNode,offset:a.focusOffset}),r&&(this.startInputInterception(this.ownerDocument),this._interceptStartTime=Date.now(),this._logger&&this._logger.debug(507248859,`Starting text input interception ${this._interceptStartTime}`));let s=0;const l=this.ownerDocument;try{const r=await this.prepareRange(e,t,i);if(r){const e=r.toString();return this.selectRange(l,r),await this.doReplacement(l,n),s=n.length-t,e}}catch(e){throw r&&this._logger&&this._logger.error(507248858,"An error occurred during the auto correction text replacement while text interception is ON",e),e}finally{await this.restoreTextAndPosition(l,s,a,o,r)}}async restoreTextAndPosition(e,t,n,i,r){try{n&&i&&this.restorePosition(n,t,i)}catch(e){throw r&&this._logger&&this._logger.error(507248857,"An error occurred while trying to restore the cursor position after the auto correction and text interception is ON",e),e}finally{r&&await this.restoreText(e)}}restorePosition(e,t,n){var i,r,o;const a=n.offset+t,s=null!==(o=null===(r=null===(i=n.node)||void 0===i?void 0:i.textContent)||void 0===r?void 0:r.length)&&void 0!==o?o:a,l=Math.min(s,a);e.removeAllRanges(),e.setPosition(n.node,l)}async restoreText(e){try{await this.doReplacement(e,this._keysCache)}catch(e){throw this._logger&&this._logger.error(507248856,"An error occurred while trying to restore the cached text after the auto correction.",e),e}finally{if(this.stopInputInterception(e),this._interceptStartTime){const e=Date.now()-this._interceptStartTime;this._logger&&this._logger.debug(507248855,`Stop text input interception. Time take ${e} ms.`),this._interceptStartTime=void 0}}}startInputInterception(e){var t;this._keysCache="",this._textInterceptionTimeout=this.targetWindow.setTimeout((()=>this.inputInterceptionTimeoutHandler(e)),this._textInterceptionMaxTimeoutMs),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=new U.J(e),this._textInterceptionEventListener.addListener("keyup",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keydown",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keypress",this.documentKeyboardEventHandler,{capture:!0})}stopInputInterception(e){var t;this._textInterceptionTimeout&&(this.targetWindow.clearTimeout(this._textInterceptionTimeout),this._textInterceptionTimeout=void 0),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=void 0,this._keysCache=""}doReplacement(e,t){const n=new Event(Zt);return e.dispatchEvent(n),this.innerDoReplacement(e,t),e.dispatchEvent(n),Promise.resolve()}async doRemoval(e,t){const n=new Event(Zt);e.dispatchEvent(n),await this.innerDoRemoval(e,t),e.dispatchEvent(n)}innerDoReplacement(e,t){e.execCommand("insertText",!1,t),this.dispatchInputEvent()}async innerDoRemoval(e,t){var n,i,r,o;const a=e.getSelection();if(a&&a.anchorNode===a.focusNode&&(null===(n=a.anchorNode)||void 0===n?void 0:n.textContent)){const n=a.anchorNode,s=null===(i=n.textContent)||void 0===i?void 0:i.length;e.execCommand("delete",!1),n.isConnected&&(null===(r=n.textContent)||void 0===r?void 0:r.length)===s&&(null===(o=await t())||void 0===o||o.deleteContents())}else e.execCommand("delete",!1);this.dispatchInputEvent()}}class Xt extends $t{constructor(){super(...arguments),this.doReplacement=(e,t,n,i,r)=>{e.setRangeText(t,n,i,r),this.dispatchInputEvent()},this.calculateBoundaries=(e,t,n)=>{const i=e.value.length,r=Math.min(t,i);return{start:r,end:Math.min(r+n,i)}}}async insert(e,t){if(!this.element)return;const n=this.calculateBoundaries(this.element,e,0);this.doReplacement(this.element,t,n.start,n.end,"end")}async replace(e,t,n){if(!this.element)return;const i=this.calculateBoundaries(this.element,e,t);this.doReplacement(this.element,n,i.start,i.end,"end")}async autoCorrect(e,t,n){if(!this.element)return;const i=this.calculateBoundaries(this.element,e,t),r=this.element.value.substring(i.start,i.end);return this.doReplacement(this.element,n,i.start,i.end,"preserve"),r}async remove(e,t,n,i,r,o){if(!this.element)return;const a=this.calculateBoundaries(this.element,o?e-1:e,o?t+1:t);this.doReplacement(this.element,"",a.start,a.end)}}class en extends $t{constructor(e){super(),this.textRetrieverFactory=e}async insert(e,t){if(!this.element)return;const n=this.getReplacedText(e,e,t);this.element.innerText=n.text}async replace(e,t,n){if(!this.element)return;const i=this.getReplacedText(e,e+t,n);this.element.innerText=i.text}async autoCorrect(e,t,n){if(!this.element)return;const i=this.getReplacedText(e,e+t,n);return this.element.innerText=i.text,i.replacedPart}async remove(e,t,n,i,r,o=!1){if(!this.element)return;const a=this.getReplacedText(e,e+t,void 0,!o);this.element.innerText=a.text}getReplacedText(e,t,n,i){const r=this.getText(),o=r.length;let a=Math.min(e,o);const s=Math.min(t,o);return i||n||" "!==r[a-1]||(a-=1),{text:`${r.substring(0,a)}${null!=n?n:""}${r.substring(s)}`,replacedPart:r.substring(a,s)}}getText(){return this.element?this.textRetrieverFactory(this.element).retrieve().content:""}}const tn=(0,l.f)("IIndexReadjuster");class nn{constructor(e,t,n,i){this._proofingDom=e,this._tileContent=t,this._indexReadjuster=n,this.targetWindow=i,this.getTextSelection=()=>{var e,t;const n=(null!==(t=null===(e=this.targetWindow)||void 0===e?void 0:e.deref())&&void 0!==t?t:window).getSelection();if(n){const e=this.getParentTileElement(n.anchorNode),t=this.getParentTileElement(n.focusNode);if(e&&t)return this.attemptToFindSelectionRange(e,t,n)}return Promise.resolve(void 0)},this.attemptToFindOffsetsIntoParentElement=(e,t)=>{const n=[],i=e.element&&this._tileContent.getContainingElement(e.element);if(!i)return n;const r=document.createTreeWalker(i,NodeFilter.SHOW_ALL,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let o=0;for(;r.nextNode();){const e=r.currentNode,i=e.textContent&&e.nodeType===e.TEXT_NODE?e.textContent.length:0;for(let i=0;i<t.length;i++)e===t[i]&&(n[i]=o);if(o+=i,n.length===t.length)break}if(0===o)for(let e=0;e<t.length;e++)i===t[e]&&(n[e]=o);return n},this.attemptToFindSelectionRange=async(e,t,n)=>{var i,r,o,a,s,l,u,d,c,h,g,p,f,m;let v,y;if(e.id===t.id){const t=this.attemptToFindOffsetsIntoParentElement(e,[n.anchorNode,n.focusNode]);v=t[0],y=t[1]}else v=this.attemptToFindOffsetsIntoParentElement(e,[n.anchorNode])[0],y=this.attemptToFindOffsetsIntoParentElement(t,[n.focusNode])[0];if(void 0!==v&&void 0!==y&&e.element&&t.element){let _,b,C,T,S,I,w=0,E=0;if(v>y?(w=y+n.focusOffset,E=v+n.anchorOffset,S=t,I=e):(w=v+n.anchorOffset,E=y+n.focusOffset,S=e,I=t),e.id===t.id){const t=this._tileContent.getContainingElement(e.element);if(!t)return;S=I=e;const g=null!==(r=null===(i=this._tileContent.getText(e))||void 0===i?void 0:i.content)&&void 0!==r?r:"";if(this._indexReadjuster)if(w===E){const e=0!==w&&"\n"===g.charAt(w),n=await this._indexReadjuster.getReadjustedIndices(t,[e?w-1:w],g,!0);e?(w=n[0]+1,E=n[0]+1):(w=n[0],E=n[0])}else{const e=await this._indexReadjuster.getReadjustedIndices(t,[w,E],g,!0);w=e[0],E=e[1]}if(!e.children)return{startParentElement:S,endParentElement:I,isCollapsed:n.isCollapsed,selectedText:n.toString(),startPosition:w,endPosition:E,startParagraphNode:_,endParagraphNode:b,startPositionInParagraphNode:C,endPositionInParagraphNode:T};for(const t of e.children){const e=t.element;w===E&&0!==w?w-1>=e.offset&&w-1<e.offset+e.span&&(_=t,C=w-e.offset,b=t,T=w-e.offset):(w>=e.offset&&(w<e.offset+e.span||0===w&&e.offset+e.span===0)&&(_=t,C=w-e.offset),E>=e.offset&&(E<e.offset+e.span||0===E&&e.offset+e.span===0)&&(b=t,T=E-e.offset))}if(!b){let t;for(const n of e.children)(!t||(null!==(a=null===(o=n.element)||void 0===o?void 0:o.offset)&&void 0!==a?a:0)>(null!==(l=null===(s=t.element)||void 0===s?void 0:s.offset)&&void 0!==l?l:0))&&(t=n);(null==t?void 0:t.element)&&E===t.element.offset+t.element.span&&(b=t,T=E-t.element.offset)}if(w===E&&!_&&!b){let t;for(const n of e.children)(!t||(null!==(d=null===(u=n.element)||void 0===u?void 0:u.offset)&&void 0!==d?d:0)>(null!==(h=null===(c=t.element)||void 0===c?void 0:c.offset)&&void 0!==h?h:0))&&(t=n);(null==t?void 0:t.element)&&w===t.element.offset+t.element.span+1&&(_=t,C=w-t.element.offset,b=t,T=w-t.element.offset)}}else{if(w=y+n.focusOffset,E=v+n.anchorOffset,S=t,I=e,!S.element||!I.element)return;const i=this._tileContent.getContainingElement(S.element),r=this._tileContent.getContainingElement(I.element);if(this._indexReadjuster&&i&&r){const e=null!==(p=null===(g=this._tileContent.getText(S))||void 0===g?void 0:g.content)&&void 0!==p?p:"";w=(await this._indexReadjuster.getReadjustedIndices(i,[w],e,!0))[0];const t=null!==(m=null===(f=this._tileContent.getText(I))||void 0===f?void 0:f.content)&&void 0!==m?m:"";E=(await this._indexReadjuster.getReadjustedIndices(r,[E],t,!0))[0]}if(S.children)for(const e of S.children)w>=e.element.offset&&w<e.element.offset+e.element.span&&(_=e,C=w-e.element.offset);if(I.children)for(const e of I.children)E>=e.element.offset&&E<e.element.offset+e.element.span&&(b=e,T=E-e.element.offset)}return{startParentElement:S,endParentElement:I,isCollapsed:n.isCollapsed,selectedText:n.toString(),startPosition:w,endPosition:E,startParagraphNode:_,endParagraphNode:b,startPositionInParagraphNode:C,endPositionInParagraphNode:T}}},this.getParentTileElement=e=>{let t;for(const n of this._proofingDom.tileNodes)this._tileContent.getContainingElement(n)===e&&(t=n);return t||((null==e?void 0:e.parentNode)?this.getParentTileElement(e.parentNode):void 0)}}}var rn=n(47408);let on=class{constructor(e,t,n,i,r){this._proofingDom=e,this.indexReadjuster=t,this.safeWindow=n,this.logger=i,this.targetWindowRef=r,this.attachedToParagraphLevelDivs=!1}getText(e){const t=this.getTextRetriever(e,void 0);if(t)return t.retrieve()}getTextSelection(){return new nn(this._proofingDom,this,this.indexReadjuster,this.targetWindowRef).getTextSelection()}getContainingElement(e){return(0,at.C)(e,"HTMLElement")?e:(t=e)&&"id"in t&&"nodeType"in t&&(0,P.l)(e)?an(e.parent):an(e);var t}async insert(e,t,n,i,r,o,a,s){const l=this.getTextWriter(e,t);if(l)return l.insert(n,i,r,o,a,s)}async replace(e,t,n,i,r,o){const a=this.getTextWriter(e,t);if(a)return a.replace(n,i,r,o)}async remove(e,t,n,i,r,o,a,s){const l=this.getTextWriter(e,t);if(l)return l.remove(n,i,o,a,s,r)}async autoCorrect(e,t,n,i,r,o,a){const s=this.getTextWriter(e,t);if(s)return s.autoCorrect(n,i,r,o,a)}async getCritiqueRanges(e,t,n){const i=null!=t?t:an(e);if(!i)return n.map((e=>({critique:e,range:void 0})));const r=this.getTextNodeRangeBuilder(e,t);return r?r.getCritiqueRanges(i,n):n.map((e=>({critique:e,range:void 0})))}async getRangeOfNode(e,t,n,i){const r=null!=t?t:an(e);if(!r)return;const o=this.getTextNodeRangeBuilder(e,t);return o?o.getRangeOfNode(r,n,i,(0,rn.$)(e)?e.plainText:void 0):void 0}async getNodeInsertionPosition(e,t,n){const i=an(e);if(!i)return;const r=this.getTextNodeRangeBuilder(e,void 0);return r?r.getNodeInsertionPosition(i,t,n):void 0}getTextNodeRangeBuilder(e,t){const n=this.getTextRetriever(e,t);if(n)return new zt((()=>n),this.indexReadjuster)}getTextRetriever(e,t){const n=null!=t?t:an(e);if(!n)return;let i;return i=(0,at.C)(n,"HTMLInputElement")||(0,at.C)(n,"HTMLTextAreaElement")?new Ht(n):this.attachedToParagraphLevelDivs?new Kt(n):new Vt(n),i}getTextWriter(e,t){var n;const i=null!==(n=an(e))&&void 0!==n?n:t,r=this.getTextNodeRangeBuilder(e,t),o=this.getTextRetriever(e,t);if(!i||!r||!o)return;let a;var s,l,u;return l="contenteditable",u="true",a=(s=i).hasAttribute(l)&&s.getAttribute(l)===u||null!==s.closest(`[${l}=${u}]`)?new Yt(r,this.safeWindow,this.logger):(0,at.C)(i,"HTMLInputElement")||(0,at.C)(i,"HTMLTextAreaElement")?new Xt:new en((()=>o)),a.setHtmlElement(i),a}};function an(e){return(0,P.l)(e)?e.parent.element:e.element}on=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(he.w)),(0,r.__param)(1,(0,Me.W)(tn)),(0,r.__param)(2,(0,Me.W)(ze.j)),(0,r.__param)(3,(0,Me.W)(v.g)),(0,r.__param)(3,(0,St.l)()),(0,r.__param)(4,(0,Me.W)(z.sh)),(0,r.__param)(4,(0,St.l)())],on);let sn=class extends on{constructor(e,t,n,i,r){super(e,t,i,n,r),this.attachedToParagraphLevelDivs=!0}};sn=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(he.w)),(0,r.__param)(1,(0,Me.W)(tn)),(0,r.__param)(2,(0,Me.W)(v.g)),(0,r.__param)(3,(0,Me.W)(ze.j)),(0,r.__param)(4,(0,Me.W)(z.sh)),(0,r.__param)(4,(0,St.l)())],sn);class ln{constructor(e){this.attachedToParagraphLevelDivs=e,this.imports=[]}get uniqueId(){return(0,Je.z)(507918412)}configureRootServices(e){e.bind(F.d).to(this.attachedToParagraphLevelDivs?sn:on),e.bind(u).to(Nt)}}let un=class{retrieveElements(e,t){if(!e.querySelectorAll)return[];const n=t.join(",");return e.querySelector(n)?Array.from(e.querySelectorAll(n)):[]}};un=(0,r.__decorate)([(0,Le._)()],un);var dn=n(35761),cn=n(90630),hn=n(3327),gn=n(6510),pn=n(95988);function fn(e){switch(e){case pn.fT.Word:return hn.OD.Word;case pn.fT.Sentence:return hn.OD.Sentence;case pn.fT.Paragraph:return hn.OD.Paragraph;default:return hn.OD.Sentence}}function mn(e){return e&&(e.formattedRanges||e.attributionRanges)}function vn(e,t){const n=e.start<t.start?e:t,i=n===e?t:e;if(!(n.end<i.start))return{start:i.start,end:n.end<i.end?n.end:i.end}}function yn(e,t,n){if(!e)return;const i=e.content.substring(t,n);let r;if(e.formattedRanges){r=[];for(const i of e.formattedRanges){const e=vn({start:i.start,end:i.start+i.length},{start:t,end:n});e&&r.push(Object.assign(Object.assign({},i),{start:e.start,length:e.end-e.start}))}}return Object.assign(Object.assign({},e),{content:i,formattedRanges:r})}function _n(e,t,n){const i=[];for(const r of e){const e=r.start+r.length,o=Math.max(t,r.start),a=Math.min(n,e);a<=o||i.push(Object.assign(Object.assign({},r),{start:o,length:a-o}))}return i}function bn(e,t,n){return e.formattedRanges?_n(e.formattedRanges,t,n):[]}function Cn(e,t,n){return{formattedRanges:e.formattedRanges?_n(e.formattedRanges,t,n):[],attributionRanges:e.attributionRanges?_n(e.attributionRanges,t,n):[]}}const Tn=["queryRange","ipPosition","isColdIp","content","formattedRanges","attributionRanges","objectReferences"];function Sn(e,t){if(!e!=!t)return!1;if(!e||!t)return!0;const n=In(e);return!!wn(n,In(e))&&n.every((n=>e[n]===t[n]))}function In(e){return Object.keys(e).filter((e=>!Tn.includes(e)))}function wn(e,t){return!e==!t&&(!e||!t||e.length===t.length&&e.every(((n,i)=>function(e,t){if("string"==typeof e&&"string"==typeof t)return e===t;const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const i of n)if(Array.isArray(e[i])&&Array.isArray(t[i])){if(!wn(e[i],t[i]))return!1}else if(e[i]!==t[i])return!1;return!0}(e[i],t[i]))))}function En(e,t,n,i,r,o,a,s,l,u,d,c,h){var g;let p,f,m=0;const v=null!==(g=null==i?void 0:i.content)&&void 0!==g?g:"",y=r.content,_=o.firstDiffLeft,b=v.length-o.firstDiffRight,C=y.length-o.firstDiffRight,T=function(e,t,n,i,r){return e===t?hn.WI.Update:n===r?hn.WI.Add:i===r?hn.WI.Delete:hn.WI.Update}(v.length,y.length,b,C,_);let S;const I=()=>function(e,t,n,i){if(!i||void 0===t)return;if(void 0===e)return t;if(t.length<e.length||t.length-e.length>2)return t;let r;for(r=0;r<e.length;r++){const n=e[r],i=t[r];if(n.start!==i.start||n.length<i.length||!(0,dn.G)(n.attribution,i.attribution))break}return t[r]?t[r].start!==n?t:t.slice(r):[]}(null==i?void 0:i.attributionRanges,r.attributionRanges,_,d);switch(T){case hn.WI.Update:m=b-_,p=y.substring(_,C),S=I(),f=v.substring(_,b);break;case hn.WI.Add:m=0,p=y.substring(_,C),S=I();break;case hn.WI.Delete:m=b-_,f=v.substring(_,b),S=I()}return{message:{tileId:e,tileVersion:t,documentModel:n,delta:new gn.s({deltaType:T,unit:s,position:_,length:m,content:p,wordCount:a,invalidationRanges:c,userInfo:{userType:Dn(u)},attributionRanges:S}),sourceType:l,changeType:u,deletedOrReplacedCharacters:f,tileText:y,wordBoundaries:h},attributionData:d?Nn(S,S===r.attributionRanges):void 0}}function xn(e,t,n,i,r){return{tileId:e,tileVersion:t,documentModel:n,delta:mn(r)?new gn.s({deltaType:hn.WI.FormattingUpdate,formattedRanges:r.formattedRanges,attributionRanges:r.attributionRanges}):Array.isArray(r)?new gn.s({deltaType:hn.WI.FormattingUpdate,formattedRanges:r}):new gn.s({deltaType:hn.WI.OtherNonContentUpdate,otherNonContentData:r}),sourceType:i}}function An(e,t){var n;return{tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:e.mutationChangeType,isTextNode:!0,tile:e.content?new cn.Cg(Object.assign(Object.assign({},e.content),{formattedRanges:[...null!==(n=e.content.formattedRanges)&&void 0!==n?n:[],{start:0,length:e.content.content.length,languageId:t}]})):void 0,prevId:e.prevTileId,nextId:e.nextTileId}}function Dn(e){switch(e){case p.Q0.Local:return hn.HS.SessionUser;case p.Q0.Remote:return hn.HS.Collaborator;default:return hn.HS.Programmatic}}function Nn(e,t){if(!e||0===e.length)return;const n={deltaType:hn.WI.AttributionUpdate,attributionData:{ranges:e,isFullUpdate:t}},i=new gn.s(n);return(0,p.Bb)(i)?i:n}var Fn=n(55871),Pn=n(30122);let kn=class{constructor(e,t,n,i,r,o,a){this._hostEmitters=e,this._proofingStore=t,this._featureFlagReader=n,this._logger=i,this._proofingDom=r,this._queryDetection=o,this._nodeTraverser=a,this.tileTracked=new Set}emitTileEvent(e,t,n,i,r,o,a,s,l,u){var d,c;r===g.G.NewData?this.tileTracked.add(t):r===g.G.RemoveData&&(this.tileTracked.delete(t),null===(d=this._queryDetection)||void 0===d||d.handleTileRemoved(t));const h=(0,Fn.F)(e);for(const e of this._hostEmitters)e.emit(M.pD.hostModelTextTile,{address:void 0,message:{messageType:r,data:{tileId:t,tileVersion:i,documentModel:null==h?void 0:h.documentModel,changeType:o,isTextNode:a===vt.Z.ParagraphNode,tile:n?new cn.Cg(Object.assign(Object.assign({},n),{formattedRanges:[...null!==(c=n.formattedRanges)&&void 0!==c?c:[],{start:0,length:n.content.length,languageId:null!=s?s:this.getProofingLanguage()}]})):void 0,prevId:l,nextId:u}}})}emitParagraphDiffEvent(e){this.tileTracked.has(e.paragraphNode.id)||this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(540915291,"Delta event sent when no parent tile node was created."),this.emitDiffEvent(e.paragraphNode,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,p.pf.ParagraphNode,e.mutationChangeType,e.invalidationRanges)}emitTileDiffEvent(e,t,n,i,r,o,a,s,l){const u=a.unreconciledContent.some((e=>e.textUnit===pn.fT.Paragraph))?hn.OD.Paragraph:a.unreconciledContent.some((e=>e.textUnit===pn.fT.Sentence))?hn.OD.Sentence:r?hn.OD.Word:hn.OD.Chars,d=this.getProofingLanguage(),c=a.unreconciledContent.map((e=>({position:e.header.elementId.offset,length:e.header.elementId.span,unit:fn(e.textUnit),languageId:null!=l?l:d})));this.emitDiffEvent(e,t,n,i,o,u,p.pf.TileNode,s,c)}emitMoveTileEvent(e,t,n,i,r,o,a,s,l){var u;for(const d of this._hostEmitters)d.emit(M.pD.hostModelMoveTextTile,{address:void 0,message:{oldTileId:e,newTileId:t,tileVersion:i,oldDocumentModel:s,newDocumentModel:l,tile:new cn.Cg(Object.assign(Object.assign({},n),{formattedRanges:[...null!==(u=n.formattedRanges)&&void 0!==u?u:[],{start:0,length:n.content.length,languageId:null!=r?r:this.getProofingLanguage()}]})),prevId:o,nextId:a}})}emitParagraphNodeTileEvents(e,t,n,i){const r=(0,Fn.F)(e),o=t.removedNodes.map((t=>{var i;return{messageType:g.G.RemoveData,data:{tileId:t,tileVersion:null!==(i=e.eventSeqId)&&void 0!==i?i:0,documentModel:null==r?void 0:r.documentModel,changeType:n,isTextNode:!0,tile:void 0}}}));o.push(...t.unreconciledContent.map((o=>{var a,s,l;const u=this._proofingDom.findParagraphNode(o.header.elementId.id),d=u?null===(a=this._nodeTraverser)||void 0===a?void 0:a.findPreviousParagraphNode(u):void 0,c=u?null===(s=this._nodeTraverser)||void 0===s?void 0:s.findNextParagraphNode(u):void 0;return{messageType:this._featureFlagReader.flags.enableParagraphUpdates&&!t.addedNodes.includes(o.header.elementId.id)?g.G.ChangeData:g.G.NewData,data:{tileId:o.header.elementId.id,tileVersion:null!==(l=e.eventSeqId)&&void 0!==l?l:0,documentModel:null==r?void 0:r.documentModel,changeType:n,isTextNode:!0,tile:new cn.Cg(Object.assign(Object.assign({},i),{content:o.data,formattedRanges:[{start:0,length:o.data.length,languageId:this.getProofingLanguage(o.proofingLanguages)}]})),prevId:"#head#"===d?d:null==d?void 0:d.id,nextId:"#tail#"===c?c:null==c?void 0:c.id}}})));for(const e of this._hostEmitters)e.emit(M.pD.hostModelParagraphTextTiles,{address:void 0,message:o})}getProofingLanguage(e){return j.I.getDefaultLanguageCode(null!=e?e:this._proofingStore.getCachedEntry(f.l.ProofingLanguages).storeEntryValue)}findAttributionRangesForDelta(e,t,n){if(!this._featureFlagReader.flags.enableAttributionRangeInAddDelta||void 0===t)return;if(void 0===e)return t;if(t.length<e.length||t.length-e.length>2)return t;let i;for(i=0;i<e.length;i++){const n=e[i],r=t[i];if(n.start!==r.start||n.length<r.length||!(0,dn.G)(n.attribution,r.attribution))break}return t[i]?t[i].start!==n?t:t.slice(i):[]}createAttributionDelta(e,t){const n={deltaType:hn.WI.AttributionUpdate,attributionData:{ranges:e,isFullUpdate:t}},i=new gn.s(n);return(0,p.Bb)(i)?i:(this._logger.error(506204486,"Delta is not a formatted text tile delta with attribution ranges even though it should be"),n)}emitDiffEvent(e,t,n,i,r,o,a,s,l){var u,d,c,h;const g=null!==(u=null==t?void 0:t.content)&&void 0!==u?u:"",f=n.content,m=i.firstDiffLeft,v=g.length-i.firstDiffRight,y=f.length-i.firstDiffRight,_=g.length===f.length?hn.WI.Update:v===m?hn.WI.Add:y===m?hn.WI.Delete:hn.WI.Update;let b,C,T,S;const I=()=>this.findAttributionRangesForDelta(null==t?void 0:t.attributionRanges,n.attributionRanges,m);switch(_){case hn.WI.Update:b=v-m,C=f.substring(m,y),S=I(),T=g.substring(m,v);break;case hn.WI.Add:b=0,C=f.substring(m,y),S=I();break;case hn.WI.Delete:b=v-m,T=g.substring(m,v),S=I()}let w=new gn.s({deltaType:_,unit:o,position:m,length:b,content:C,wordCount:r,invalidationRanges:l,userInfo:{userType:s===p.Q0.Local?hn.HS.SessionUser:s===p.Q0.Remote?hn.HS.Collaborator:hn.HS.Programmatic}});console.debug("emitDiffEvent sourceType",a,!!this._queryDetection);const E=a===p.pf.ParagraphNode?null===(d=this._queryDetection)||void 0===d?void 0:d.handleTileDelta(e.id,w,f,s,T):void 0;w=Object.assign(Object.assign({},w),E),console.debug("emitDiffEvent delta",w);const x=(0,Fn.F)(e);for(const t of this._hostEmitters)t.emit(M.pD.hostModelDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(c=e.eventSeqId)&&void 0!==c?c:0,documentModel:null==x?void 0:x.documentModel,delta:w,sourceType:a,changeType:s,deletedOrReplacedCharacters:T}}),this._featureFlagReader.flags.enableAttributionRangeInAddDelta&&S&&S.length>0&&e.id&&void 0!==e.eventSeqId&&t.emit(M.pD.hostModelAttributionDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(h=e.eventSeqId)&&void 0!==h?h:0,documentModel:null==x?void 0:x.documentModel,sourceType:a,delta:this.createAttributionDelta(S,S===n.attributionRanges)}})}emitFormattingDiffEventDeprecated(e,t,n){var i;const r=(0,Fn.F)(e),o=Array.isArray(n)?new gn.s({deltaType:hn.WI.FormattingUpdate,formattedRanges:n}):new gn.s({deltaType:hn.WI.OtherNonContentUpdate,otherNonContentData:n});for(const n of this._hostEmitters)n.emit(M.pD.hostModelFormattingDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(i=e.eventSeqId)&&void 0!==i?i:0,documentModel:null==r?void 0:r.documentModel,delta:o,sourceType:t}})}emitFormattingDiffEvent(e,t,n){var i;if(!this._featureFlagReader.flags.enableAttributionRangeExceptionInFormattedTextDeltas)return mn(n)?void this._logger.error(506331489,"Unexpected formatted text range props in deprecated formatted text deltas"):this.emitFormattingDiffEventDeprecated(e,t,n);const r=(0,Fn.F)(e);for(const o of this._hostEmitters)o.emit(M.pD.hostModelFormattingDelta,{address:void 0,message:xn(e.id,null!==(i=e.eventSeqId)&&void 0!==i?i:0,null==r?void 0:r.documentModel,t,n)})}};kn=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Pn.t)(M.zJ)),(0,r.__param)(1,(0,Me.W)(m.K)),(0,r.__param)(2,(0,Me.W)(q.c)),(0,r.__param)(3,(0,Me.W)(v.g)),(0,r.__param)(4,(0,Me.W)(he.w)),(0,r.__param)(5,(0,St.l)()),(0,r.__param)(5,(0,Me.W)(_.J)),(0,r.__param)(6,(0,St.l)()),(0,r.__param)(6,(0,Me.W)(dt.M))],kn);const On=(0,l.f)("ISentenceTextUnitSeparator"),Bn=(0,l.f)("IParagraphTextUnitSeparator"),Rn=(0,l.f)("IDefaultTextUnitSeparator"),Ln=(0,l.f)("IDocumentTextUnitSeparator"),Mn="[\0-\b\n--Â\u2028-\u2029â¯â]",qn="[!-#%-*,-/:-;?-@_{}Â¡Â«Â¬Â·Â»Â¿Í¾ÎÕ-ÕÖ-ÖÖ¾××××³-×´Ø-ØØ-ØØØ-ØÙª-Ù­Ûà¥¤-à¥¥à¥°à·´à¹à¹-à¹à¼-à¼à¼º-à¼½à¾à¿-à¿á-áá»á¡-á¨á­-á®á-áá-áá -á â-â§â°-ââ-ââ-âã-ãã-ãã-ãã°ã½ã ã»ï¼-ï¼ï¼-ï¼ï¼-ï¼ï¼-ï¼ï¼-ï¼ ï¼»-ï¼½ï¼¿ï½ï½ï½-ï½¥]",Un="[Ø-ØÛá â-ââ -â¤âª-â¯]",Wn="[?!.ÖÛÜÜà¥¤à¥¥á¢á®á á â³¹â³¾ãê¿êê³ï¸ï¹ï¼ï½¡]",jn="[ãï½¡]",zn="[ Â â-ââ¯âã\t]",Hn="[Â»âââº\"']",Vn="[)]}à¼»à¼½âãããããããããããï¼ï¼½ï½ï½ ï½£]|[â¹âºâ»]|[ââ]",Gn="[\u2028\u2029\n\r]",Qn=`[.ãï¹ï¼ï½¡]{2,6}|[.]([ ][.]){1,5}|([ï¼¡-ï¼ºï½-ï½])[.ï¹ï¼]|(${zn}|${Mn}|${qn}|${Un})((((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]|((([ï¼¬]?[ï¼¸]{1,3}|[ï¼¸][ï¼¬ï¼£]|[ï¼¬])?([ï¼¶]?[ï¼©]{1,3}|[ï¼©][ï¼¶ï¼¸]|[ï¼¶]))|([ï¼¬]?[ï¼¸]{1,3}|[ï¼¸][ï¼¬ï¼£]|[ï¼¬])|(([ï½]?[ï½]{1,3}|[ï½][ï½ï½]|[ï½])?([ï½]?[ï½]{1,3}|[ï½][ï½ï½]|[ï½]))|([ï½]?[ï½]{1,3}|[ï½][ï½ï½]|[ï½]))[.ï¹ï¼]|([0-9]{1,4}[.]|[ï¼-ï¼]{1,4}[.ï¹ï¼])|([0-9]+(([aoÂªÂºáµáµ])|((er)[ao]?)|(([áµ][Ê³])[áµáµ]?)|([mdtvn][ao])|([áµáµáµáµâ¿][áµÊ³]))[.]|[A-Za-zÃÃÃÃÃÃÃÃÃ Ã¤Ã¨Ã©Ã´Ã¶Ã¼]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-zÃÃÃÃÃÃÃÃÃ Ã¤Ã¨Ã©Ã´Ã¶Ã¼]+((STR)|(str))[.]))|(${zn}|${Mn}|${qn}|[$+<=>^\`|~Â¢Â£Â¤Â¥-Â©Â¬Â®Â¯Â°Â±Â´Â¶Â¸ÃÃ·Ë-ËË-ËË¥-Ë«Ë­Ë¯-Ë¿ÍµÎÎÏ¶ÒØØØØØØÛÛ©Û½Û¾à§²à§³à§ºà«±à­°à¯³-à¯ºà±¿àµ¹à¸¿à¼à¼à¼à¼à¼à¼à¼à¼-à¼à¼´à¼¶à¼¸à¾¾-à¿à¿-à¿à¿à¿ááá-ááââãããã ã¶ã·ã¾ã¿ããï¼ï¼ï¼ï¼ï¼ï¼¾ï½ï½ï½ï¿ -ï¿¦ï¿¨-ï¿®]|${Un}|[0-9Ù -Ù©Û°-Û¹à¥¦-à¥¯à§¦-à§¯à©¦-à©¯à«¦-à«¯à­¦-à­¯à¯¦-à¯¯à±¦-à±¯à³¦-à³¯àµ¦-àµ¯à¹-à¹à»-à»à¼ -à¼©á-áá-áá -á©á -á ï¼-ï¼]|[Â²Â³Â¹Â¼Â½Â¾à§´-à§¹à¯°à¯±à¯²à±¸-à±¾àµ°-àµµà¼ª-à¼³á©-á¼á°-á¹ãã¡-ã©ã¸ã¹ãº])((([A-Za-zÂªÂµÂºÃ-ÃÃ-ÃÃ-Ã¶Ã¸-ÆºÆ¼-Æ¿Ç-ÊÊ-Í³Í¶Í·Í»Í¼Í½ÎÎÎÎÎÎ-Î¡Î£-ÏµÏ·-ÒÒ-Ô£Ô±-ÕÕ¡-Öá -á]|[Æ»Ç-ÇÊ×-×ª×°×±×²Ø¡-Ø¿Ù-ÙÙ®Ù¯-ÛÙ±ÛÛ®Û¯ÛºÛ»Û¼Û¿à¤-à¤¹à¤½à¥à¥-à¥¡à¥²à¥»-à¥¿à¦-à¦à¦à¦à¦-à¦¨à¦ª-à¦°à¦²à¦¶-à¦¹à¦½à§à§à§à§à§ à§¡à§°à§±à¨-à¨à¨à¨à¨-à¨à¨-à¨¨à¨ª-à¨°à¨²à¨³à¨µà¨¶à¨¸à¨¹à©-à©à©à©²-à©´àª-àªàª-àªàª-àª¨àªª-àª°àª²àª³àªµ-àª¹àª½à«à« à«¡à¬-à¬à¬à¬à¬-à¬¨à¬ª-à¬°à¬²à¬³à¬µ-à¬¹à¬½à­à­à­-à­¡à­±à®à®-à®à®-à®à®-à®à®à®à®à®à®à®£à®¤à®¨-à®ªà®®-à®¹à¯à°-à°à°-à°à°-à°¨à°ª-à°³à°µ-à°¹à°½à±à±à± à±¡à²-à²à²-à²à²-à²¨à²ª-à²³à²µ-à²¹à²½à³à³ à³¡à³±à³²à´-à´à´-à´à´-à´¨à´ª-à´¹à´½àµ àµ¡àµº-àµ¿à¶-à¶à¶-à¶±à¶³-à¶»à¶½à·-à·àºàºàºàºàºàºàºàº-àºàº-àºàº¡-àº£àº¥àº§àºªàº«àº­-àº°àº²àº³àº½à»-à»à»à»à»à¼à½-à½à½-à½¬à¾-à¾á-á³ááá-áªá¿á-áá-áá¡á¥á¦á®-á°áµ-ááá-áºá-ááá -á¢á¨-á¹á-áá-áá-ááá-áá -áá-áá-á°á²-áµá¸-á¾áá-áá-áá-áá-áá-áá-áá -á´á-á¬á¯-á¶á  -á¡·á¢-á¢¨á¢ªãã¼ê°-í£ï¾ -ï¾¾ï¿-ï¿ï¿-ï¿ï¿-ï¿ï¿-ï¿]|[à¸-à¸°à¸²à¸³à¹-à¹])[.])+|(([ã-ããã¡-ãºã¿ï¤-ï¨­ï¨°-ï©ªï©°-ï«ï½¦-ï¾])[.ï¹ï¼])+)`,Kn=new RegExp(`${Wn}|${jn}`,"ig"),$n=new RegExp(`${Wn}|${jn}|${Gn}`,"ig"),Zn=new RegExp(Qn,"g");function Jn(e,t,n=0){const i=[];let r=t.exec(e);for(;null!==r;){if(r[n]){const e=r.index;i.push({begin:e,end:e+r[n].length})}r=t.exec(e)}return i}const Yn=`(${Wn}(${Vn}|${Hn}|${zn})*${Gn})`,Xn=`(${Wn}(${Vn})*(${zn})+)`,ei=`(${jn}(${Vn})*)`,ti=`((${Gn})+)`,ni=`(${Wn}(${Vn}|${Hn}|${zn})*(${Gn})+)`,ii=[new RegExp(Yn,"ig"),new RegExp(Xn,"ig"),new RegExp(ei,"ig")],ri=[new RegExp(Xn,"ig"),new RegExp(ei,"ig"),new RegExp(ti,"ig"),new RegExp(ni,"ig")],oi=new RegExp(`${Yn}|${Xn}|${ei}`,"ig"),ai=new RegExp(`${Xn}|${ei}\n    |${ti}|${ni}`,"ig");let si=class{constructor(e){this._hostSettings=e}expandEndRange(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?ri:ii;for(const n of t){const t=Jn(e,n);if(t.length>0&&0===t[0].begin)return t[0].end-1}return this._hostSettings.newLineSentenceSeparatorEnabled?-1:0}isEndPuncSpecialCase(e){const t=Jn(e,Zn),n=this._hostSettings.newLineSentenceSeparatorEnabled?e.length-1:e.length;return t.some((e=>e.end===n))}findBeginBoundary(e,t,n){const i=this._hostSettings.newLineSentenceSeparatorEnabled?$n:Kn,r=e.substring(n,t),o=Jn(r,i);for(let e=o.length-1;e>=0;e-=1){const t=r.substring(0,o[e].end);if(!this.isEndPuncSpecialCase(t)){const t=r.substring(o[e].begin,r.length),i=this.expandEndRange(t);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===i:!i)continue;return n+o[e].end+i}}return n}findEndBoundary(e,t,n){const i=e.substring(t,n),r=Jn(i,this._hostSettings.newLineSentenceSeparatorEnabled?$n:Kn);for(const e of r){const n=i.substring(0,e.end);if(!this.isEndPuncSpecialCase(n)){const n=i.substring(e.begin,i.length),r=this.expandEndRange(n);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===r:!r)continue;return t+e.end+r}}return-1}splitInUnits(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?ai:oi;return Jn(e.replace(Zn,(e=>"#".repeat(e.length))),t).map((e=>e.end))}};si=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(Ie.n))],si);let li=class{findBeginBoundary(e,t,n){const i=e.lastIndexOf("\n",t-1);return-1===i||i<=n?n:i+1}findEndBoundary(e,t,n){const i=e.indexOf("\n",t+1);return-1===i||i>n?-1:i+1}splitInUnits(e){const t=[];let n=-1;do{n=e.indexOf("\n",n+1),-1!==n&&t.push(n+1)}while(-1!==n);return t}};li=(0,r.__decorate)([(0,Le._)()],li);let ui=class{findBeginBoundary(e,t,n){return Math.min(t,n)}findEndBoundary(e,t,n){return e.length<n?-1:Math.max(t,n)}splitInUnits(e){return[e.length]}};ui=(0,r.__decorate)([(0,Le._)()],ui);const di=(0,l.f)("ITextUnitChunker");let ci=class{constructor(e,t,n){this._sentenceSeparator=e,this._paragraphSeparator=t,this._unitySeparator=n}splitInUnitsFromExtendedBoundaries(e,t,n,i){return hi(e,t,this.getUnitSeparator(n),i)}extendBoundariesFromDiffBounds(e,t,n){return gi(e,t,this.getUnitSeparator(n))}getUnitSeparator(e){switch(e){case pn.fT.Sentence:return this._sentenceSeparator;case pn.fT.Paragraph:return this._paragraphSeparator;default:return this._unitySeparator}}};function hi(e,t,n,i){const r=function(e,t,n,i){if(!n.firstDiffLeft&&!n.firstDiffRight&&!i.offset&&i.span===t.length)return function(e,t){const n=[],i=e.splitInUnits(t);let r=0;for(const e of i)n.push({offset:r,span:e-r,validEndBoundary:-1!==e}),r=e;return(!i.length||i.length&&i[i.length-1]!==t.length)&&n.push({offset:r,span:t.length-r,validEndBoundary:!1}),n}(e,t);const r=t.slice(i.offset,i.offset+i.span),o=n.firstDiffLeft-i.offset,a=n.firstDiffRight-(t.length-i.offset-i.span);let s=0,l=0;const u=[],d=Math.min(r.length,r.length-a+2);do{const t=s;s=e.findEndBoundary(r,Math.max(s,o-2),d),l=-1!==s&&s<d?s:r.length,l-t&&u.push({offset:t+i.offset,span:l-t,validEndBoundary:-1!==s,enforcedCompleteTileTextUnit:i.enforcedCompleteTileTextUnit})}while(l<r.length);return u}(n,e,t,i||gi(e,t,n));return!r.length||r[r.length-1].validEndBoundary&&!1!==r[r.length-1].validEndBoundary||(r[r.length-1]=function(e,t,n){if(!1===t.validEndBoundary&&t.span>=2){let i,r=t.span;do{i=e.slice(t.offset+r-2,t.offset+r),r-=1}while(!/\S/.test(i)&&r>=2);t.validEndBoundary=-1!==n.findEndBoundary(i,0,i.length)}return t}(e,r[r.length-1],n)),r}function gi(e,t,n){let i,r=0,o=e.length,a=t.firstDiffLeft+1;if(e.length)do{if(a-=1,r=n.findBeginBoundary(e,a,0),o=n.findEndBoundary(e,e.length-t.firstDiffRight,e.length),i=-1!==o,o=-1!==o?o:e.length,a<e.length&&r===n.findBeginBoundary(e,a+1,0))continue;let s=r,l=0;for(;s&&a===s+l;){l+=1;const t=s;if(s=n.findBeginBoundary(e,s-1,0),s<t-1){r=s;break}}}while(!(o-r));return{offset:r,span:o-r,validEndBoundary:i}}ci=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(On)),(0,r.__param)(1,(0,Me.W)(Bn)),(0,r.__param)(2,(0,Me.W)(Rn))],ci);const pi=(0,l.f)("IWordCount");var fi=n(94077);const mi=(0,l.f)("IWordCountDetector");let vi=class{constructor(e,t){this._wordCount=e,this._hostSettings=t}hasWordCountChanged(e,t,n,i=!1){let r,o=0;i?({wordCount:o,wordBoundaries:r}=this.computeValidWordCountAndBoundariesForRange(n,0,n.length)):o=this.computeValidWordCountForRange(n,0,n.length);const a={isWordCountChanged:!1,wordCount:o,wordBoundaries:r};if(o>0&&0===e.firstDiffLeft&&0===e.firstDiffRight)return a.isWordCountChanged=!0,a;if(e.firstDiffLeft+e.firstDiffRight<=n.length&&this._wordCount.getWordCountInRange(n,e.firstDiffLeft,n.length-e.firstDiffRight)>1)return a.isWordCountChanged=!0,a;if(t>o)return a.isWordCountChanged=!0,a;const s=this.computeValidWordCountForRange(n,0,n.length-e.firstDiffRight);if(0===s)return a.isWordCountChanged=!1,a;const l=this.computeValidWordCountForRange(n,0,e.firstDiffLeft);return a.isWordCountChanged=s>l,a}getWordCount(e){return this.computeValidWordCountForRange(e,0,e.length)}computeValidWordCountForRange(e,t,n){if(t>=n||t<0||n>e.length)return 0;const{wordCount:i,wordBreaks:r}=this._wordCount.getWordCountAndBreaksInRange(e,t,n);return this.correctWordCountForIncompleteWord(r,e.length,i)}computeValidWordCountAndBoundariesForRange(e,t,n){if(t>=n||t<0||n>e.length)return{wordCount:0,wordBoundaries:[]};const{wordCount:i,wordBreaks:r,wordBoundaries:o}=this._wordCount.getWordCountWithBoundariesAndBreaksInRange(e,t,n);return{wordCount:this.correctWordCountForIncompleteWord(r,e.length,i),wordBoundaries:o}}correctWordCountForIncompleteWord(e,t,n){if(n<=0||0===e.length)return 0;const i=e.length-1;return"WhiteSpace"!==e[i].wordBreakType&&(this._hostSettings.newLineSentenceSeparatorEnabled||this._hostSettings.useParagraphAsTileSeparator||"Punctuation"!==e[i].wordBreakType)&&e[i].cp+1<=t?n-1:n}};vi=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(pi)),(0,r.__param)(1,(0,Me.W)(Ie.n))],vi);const yi=(0,l.f)("IElementsRetriever"),_i=(0,l.f)("IHostTilingEmitter"),bi=(0,l.f)("IParagraphFormattingExtractor"),Ci=(0,l.f)("IParagraphNodeDictionary");let Ti=class{};Ti=(0,r.__decorate)([(0,Le._)()],Ti);const Si=(0,l.f)("IParagraphNodesEventEmitter");var Ii=n(86539);const wi=(0,l.f)("IPreOrderTraverser"),Ei=(0,l.f)("ITerminalNodeDictionary");let xi=class{};xi=(0,r.__decorate)([(0,Le._)()],xi);const Ai=(0,l.f)("ITileNodeDictionary");let Di=class{};Di=(0,r.__decorate)([(0,Le._)()],Di);let Ni=class{constructor(e){this._proofingDom=e}getFormattingAt(e,t=0,n=-1){let i=null;if(i="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,P.l)(i)){const e=i.parent.textFormattingInfo;if(e){const r=i.element.offset+t;return bn(e,r,n<0?r+i.element.span:r+n)}}}};Ni=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(he.w))],Ni);const Fi=(0,l.f)("CompleteTileTextUnitToken"),Pi=(0,l.f)("PartialTileTextUnit");let ki=class{constructor(e,t,n,i,r,o,a,s,l,u,d,c,h){this._proofingPersistedStore=e,this._graphNodeFactory=t,this._textUnitChunker=n,this.settings=i,this._hostSettings=r,this._featureFlagReader=o,this._hostTilingEmitter=a,this._paragraphNodesEventEmitter=s,this._paragraphDeltasEnabled=l,this._logger=u,this.nodeTraverser=d,this._completeTileTextUnit=null!=c?c:i.completeTileTextUnit,this._partialTileTextUnit=null!=h?h:i.partialTileTextUnit}updateParagraphNodes(e,t,n,i,r,o,a){if(!this._hostSettings.enableOrchestration||!this._featureFlagReader.flags.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,n,i,r);const s={oldTextInfo:t,newTextInfo:n,tileNode:e,sequenceId:r,minDiffBounds:i,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(s),this._addNewChildren(s),this._buildGraphTransaction(s,o,a),s.graphTransaction}_updateExistingChildren(e){var t,n,i;if(!(null===(t=e.tileNode.children)||void 0===t?void 0:t.length))return;const r=null!==(i=null===(n=e.oldTextInfo)||void 0===n?void 0:n.content)&&void 0!==i?i:"",o=e.newTextInfo.content,a=r!==o,s={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let l=e.tileNode.children.length-1;for(;l>=0;){const t=e.tileNode.children[l].element;if(t){if(r.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=o.length-r.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!a)){t.offset<e.minDiffBounds.firstDiffLeft&&(s.firstDiffLeft=Math.min(t.offset,s.firstDiffLeft));const n=r.length-t.offset-t.span;n<e.minDiffBounds.firstDiffRight&&(s.firstDiffRight=Math.min(n,s.firstDiffRight));const i=e.tileNode.children.splice(l,1);e.nodesToRetire.length&&s.firstDiffRight!==n?s.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...i):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...i):e.nodesToRetire.push(...i)}l-=1}else l-=1}e.unitRange={offset:s.firstDiffLeft,span:o.length-s.firstDiffRight-s.firstDiffLeft,enforcedCompleteTileTextUnit:!a&&this._hostSettings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(e.newTextInfo.content,e.minDiffBounds,this._completeTileTextUnit,e.unitRange);for(const n of t){const t=this._graphNodeFactory(n,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.element&&(e.element.textUnit=!1===e.element.validEndBoundary&&this._hostSettings.enableOptimizedCallingPattern&&!0!==e.element.enforcedCompleteTileTextUnit?this._partialTileTextUnit:this._completeTileTextUnit)}_buildTile(e,t,n,i){var r,o,a,s,l;const u=null!==(o=null===(r=t.element)||void 0===r?void 0:r.offset)&&void 0!==o?o:0,d=null!==(s=null===(a=t.element)||void 0===a?void 0:a.span)&&void 0!==s?s:n.length;return{header:{nodeId:e.id,seqId:i.toString(),elementId:{id:t.id,offset:u,span:d},length:n.length},data:n.slice(u,u+d),proofingLanguages:this._proofingPersistedStore.getCachedEntry(f.l.ProofingLanguages).storeEntryValue,textUnit:null===(l=t.element)||void 0===l?void 0:l.textUnit}}_convertToUpdate(e,t,n,i,r,o){var a,s;if(!(null==e?void 0:e.element)||!(null==t?void 0:t.element))return;const l=null!==(s=null===(a=n.oldTextInfo)||void 0===a?void 0:a.content)&&void 0!==s?s:"",u=n.newTextInfo.content,d=l.length-e.element.offset-e.element.span,c=u.length-t.element.offset-t.element.span;if(!i&&e.element.offset!==t.element.offset||i&&d!==c)return;const h=this._emitParagraphDeltaUpdate(e,t,n,r,o);return e.element.offset=t.element.offset,e.element.span=t.element.span,e.element.validEndBoundary=t.element.validEndBoundary,e.element.enforcedCompleteTileTextUnit=t.element.enforcedCompleteTileTextUnit,e.element.textUnit=t.element.textUnit,t.retire(),n.nodesToAdd.splice(i?n.nodesToAdd.length-1:0,1),n.nodesToInsert.splice(i?n.nodesToInsert.length-1:0,1,e),n.nodesToRetire.splice(i?n.nodesToRetire.length-1:0,1),n.nodesToUpdate.push(e),n.graphTransaction.unreconciledContent.find((n=>{const i=n.header.elementId.id===t.id;return i&&(n.header.elementId.id=e.id),i})),h}_buildGraphTransaction(e,t,n){e.nodesToInsert=[...e.nodesToAdd];const i=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,n),r=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,n);Oi(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();i&&this._hostTilingEmitter.emitParagraphDiffEvent(i),r&&this._hostTilingEmitter.emitParagraphDiffEvent(r),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,n,i,r){var o;const a={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},s=this._updateExistingChildrenDeprecated(e,null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"",n.content,i,a);return this._addNewChildrenDeprecated(e,n,i,r,s,a)}_updateExistingChildrenDeprecated(e,t,n,i,r){var o;if(null===(o=e.children)||void 0===o?void 0:o.length){const o=Object.assign({},i),a=t!==n;let s=e.children.length-1;for(;s>=0;){const l=e.children[s].element;if(l)if(l.offset<i.firstDiffLeft&&l.offset+l.span<i.firstDiffLeft||l.offset+l.span===i.firstDiffLeft&&l.validEndBoundary&&a);else if(t.length-l.offset<i.firstDiffRight)l.offset=n.length-t.length+l.offset,r.updatedNodes.push(e.children[s].id);else{l.offset<i.firstDiffLeft&&(o.firstDiffLeft=Math.min(l.offset,o.firstDiffLeft));const n=t.length-l.offset-l.span;n<i.firstDiffRight&&(o.firstDiffRight=Math.min(n,o.firstDiffRight));const a=e.children.splice(s,1);for(const e of a)r.removedNodes.push(e.id),e.retire()}s-=1}return{offset:o.firstDiffLeft,span:n.length-o.firstDiffRight-o.firstDiffLeft,enforcedCompleteTileTextUnit:!a&&this._hostSettings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,n,i,r,o){const a=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(t.content,n,this._completeTileTextUnit,r),s=[];for(const n of a){const r=this._graphNodeFactory(n,e);this._attachTextUnit(r),s.push(r),o.unreconciledContent.push(this._buildTile(e,r,t.content,i)),o.addedNodes.push(r.id)}return Oi(e,s),o}_emitParagraphDeltaUpdate(e,t,n,i,r){if(this._paragraphDeltasEnabled.check()){if(!e.element||!t.element)return;const o=yn(n.oldTextInfo,e.element.offset,e.element.offset+e.element.span),a=yn(n.newTextInfo,t.element.offset,t.element.offset+t.element.span);if(e.registered||this._emitParagraphAdd(n,e,i),void 0!==e.eventSeqId){e.eventSeqId+=1;const n=this._paragraphNodesEventEmitter.generateDeltaEventInformation(e,o,a,!!t.element.validEndBoundary,!!t.element.enforcedCompleteTileTextUnit,i,r,e.cachedWordCount);return e.cachedWordCount=n.wordCount,n}}}_emitParagraphDeltaAdd(e,t){if(this._paragraphDeltasEnabled.check())for(const n of e.nodesToAdd)this._emitParagraphAdd(e,n,t)}_emitParagraphAdd(e,t,n){var i,r;if(t.registered)return void(this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.info(539002012,"The node has been registered, skipping"));const o=this._featureFlagReader.flags.enableParagraphDeltasEmptyInitialTile&&n===p.Q0.Local;if(t.element){const a=yn(e.newTextInfo,t.element.offset,t.element.offset+t.element.span);t.eventSeqId=0;const s=null===(i=this.nodeTraverser)||void 0===i?void 0:i.findPreviousParagraphNode(t),l=null===(r=this.nodeTraverser)||void 0===r?void 0:r.findNextParagraphNode(t);this._hostTilingEmitter.emitTileEvent(e.tileNode,t.id,Object.assign(Object.assign({},a),{content:o?"":a.content,attributionRanges:o?[]:a.attributionRanges}),t.eventSeqId,g.G.NewData,n,vt.Z.ParagraphNode,this.getSpecifiedLocaleForNode(t),"#head#"===s?s:null==s?void 0:s.id,"#tail#"===l?l:null==l?void 0:l.id),o&&(t.eventSeqId+=1,this._hostTilingEmitter.emitParagraphDiffEvent(this._paragraphNodesEventEmitter.generateDeltaEventInformation(t,void 0,a,!!t.element.validEndBoundary,!0,n,!1,0))),t.registered=!0}else this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(539002013,"Anchor element is undefined for the node to add")}_emitParagraphDeltaRetire(e,t){var n;if(this._paragraphDeltasEnabled.check())for(const i of e.nodesToRetire)i.registered=!1,this._hostTilingEmitter.emitTileEvent(e.tileNode,i.id,{content:""},null!==(n=i.eventSeqId)&&void 0!==n?n:0,g.G.RemoveData,t,vt.Z.ParagraphNode,this.getSpecifiedLocaleForNode(i))}getSpecifiedLocaleForNode(e){var t,n;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(n=e.parent)||void 0===n?void 0:n.specifiedLocale}};function Oi(e,t){if(t.length&&e.children&&t[0].element){const n=t[0].element.offset;if(e.children.length){let i=e.children.length-1,r=t;for(;i>=0;){const t=e.children[i].element;if(t&&n>t.offset){e.children.splice(i,0,...r),r=[];break}i-=1}r.length&&e.children.splice(0,0,...r)}else e.children=t}}ki=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(m.K)),(0,r.__param)(1,(0,Me.W)(ot)),(0,r.__param)(2,(0,Me.W)(di)),(0,r.__param)(3,(0,Me.W)(st.k)),(0,r.__param)(4,(0,Me.W)(Ie.n)),(0,r.__param)(5,(0,Me.W)(q.c)),(0,r.__param)(6,(0,Me.W)(_i)),(0,r.__param)(7,(0,Me.W)(Si)),(0,r.__param)(8,(0,Me.W)(Ge.H)),(0,r.__param)(9,(0,Me.W)(v.g)),(0,r.__param)(10,(0,Me.W)(dt.M)),(0,r.__param)(10,(0,St.l)()),(0,r.__param)(11,(0,St.l)()),(0,r.__param)(11,(0,Me.W)(Fi)),(0,r.__param)(12,(0,St.l)()),(0,r.__param)(12,(0,Me.W)(Pi))],ki);var Bi=n(60040);let Ri=class{constructor(e,t,n){this._wordCountDetector=e,this._hostModelSettings=t,this._textUnitChunker=n}generateDeltaEventInformation(e,t,n,i,r,o,a,s){var l;const u=null!==(l=null==t?void 0:t.content)&&void 0!==l?l:"",d=n.content,c=Bi.CC(u,d);a&&(c.firstDiffLeft-=1);let h=!1;if(!i&&this._hostModelSettings.partialTileTextUnit!==pn.fT.Phrase&&this._hostModelSettings.partialTileTextUnit!==this._hostModelSettings.completeTileTextUnit){const e=c.firstDiffLeft,t=d.length-c.firstDiffRight;h=-1!==this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit).findEndBoundary(d,e-1,t)}const g=null!=s?s:this._wordCountDetector.getWordCount(u),p=this._wordCountDetector.hasWordCountChanged(c,g,d),f=r?fn(this._hostModelSettings.completeTileTextUnit):h?fn(this._hostModelSettings.partialTileTextUnit):p.isWordCountChanged?i?fn(this._hostModelSettings.completeTileTextUnit):hn.OD.Word:hn.OD.Chars;let m;if(this._hostModelSettings.completeTileTextUnit===pn.fT.Paragraph&&this._hostModelSettings.partialTileTextUnit===pn.fT.Sentence&&f!==hn.OD.Paragraph){const e=c.firstDiffLeft,t=this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit),n=t.findBeginBoundary(d,e,0),i=t.findEndBoundary(d,e-1,d.length);m=[{position:n,length:(-1===i?d.length:i)-n,unit:hn.OD.Sentence}]}return{paragraphNode:e,oldTextInfo:t,newTextInfo:n,minDiffBounds:c,wordCount:p.wordCount,deltaUnit:f,mutationChangeType:o,invalidationRanges:m}}};Ri=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(mi)),(0,r.__param)(1,(0,Me.W)(st.k)),(0,r.__param)(2,(0,Me.W)(di))],Ri);var Li=n(34756);let Mi=class{constructor(){this._rootNodes=[]}rootAtNodes(e){this._rootNodes=e}*getIterator(){var e;if(this._rootNodes.length){const t=[];for(t.push(...this._rootNodes);t.length;){const n=t.pop();yield n,(null===(e=null==n?void 0:n.children)||void 0===e?void 0:e.length)&&t.push(...n.children)}}yield}};Mi=(0,r.__decorate)([(0,Le._)()],Mi);let qi=class{constructor(){this._contexts=[]}get rootNodes(){return this._contexts}addRootNode(e){this._contexts.push(e)}clear(){this._contexts=[]}};function Ui(e,t){if(!t)return;const n={nodeType:vt.Z.TileNode,id:e.id,parent:t.parent,element:t.element,children:void 0,critiques:[],textFormattingInfo:e.cachedText,plainText:e.cachedText.content,pullText:()=>e.cachedText,retire:()=>e.retire,resetState:()=>e.resetState,reconcile:(t,n,i,r,o,a)=>e.reconcile({text:e.cachedText,mutationChangeType:t,rehydrateCritiques:r,forceTileDiffEmission:o,mutationWasTextReplacement:a,brokerOptions:{critiques:n,forceReflow:i}}),move:(t,i)=>(e.move(),n),getPreviousTileId:()=>e.previousNodeId,getNextTileId:()=>e.nextNodeId};return e.children.length>0&&(n.children=e.children.map((e=>Wi(e,n)))),n}function Wi(e,t){const n={nodeType:vt.Z.ParagraphNode,id:e.id,element:e.range,parent:t,children:void 0,eventSeqId:e.eventSeqId,retire:()=>e.retire,move:()=>(e.move(),n),resetState:()=>{}};return n}qi=(0,r.__decorate)([(0,Le._)()],qi);let ji=class{constructor(e){this._hostEmitter=e,this._tileNodeDictionary={},this._terminalNodeDictionary={},this._paragraphNodeDictionary={},this._preOrderTraverser=new Mi}get shadowGraph(){return this._shadowGraph}registerNode(e){const t=this._selectDictionary(e.nodeType);t&&(t[e.id]=e)}unregisterNode(e){const t=this._selectDictionary(e.nodeType);t&&delete t[e.id]}findNode(e){var t,n;return(null!==(n=null!==(t=this.findParagraphNode(e))&&void 0!==t?t:this.findTileNode(e))&&void 0!==n?n:this.findTerminalNode(e))||(this.ensureCanFindNode()?this._iterateGraph(e):null)}findTileNode(e){var t;return null!==(t=this.findTileRootNode(e))&&void 0!==t?t:this._tileNodeDictionary[e]}get tileNodes(){const e=Object.values(this._tileNodeDictionary);if(!this._paragraphFinder)return e;const t=[];for(const n of e){const e=this.findTileRootNode(n.id);e?t.push(e):t.push(n)}return t}findParagraphNode(e){var t;return null!==(t=this.findTextTileNode(e))&&void 0!==t?t:this._paragraphNodeDictionary[e]}findTerminalNode(e){return this._terminalNodeDictionary[e]}getTileNodeV2Paragraphs(e){var t;const n=null===(t=this._paragraphFinder)||void 0===t?void 0:t.getTileNodeParagraphs(e.id);return n?n.map((t=>Wi(t,e))):null}addNode(e){var t;if(e.parent){const t=this.findNode(e.parent.id);t&&(t.children||(t.children=[]),t.children.push(e))}else{this._shadowGraph||(this._shadowGraph=new qi),this._shadowGraph.rootNodes.push(e);const n=this._selectDictionary(e.nodeType);n&&(n[e.id]=e),null===(t=this._hostEmitter)||void 0===t||t.emit(M.pD.hostModelAddedRootNode,{address:void 0,message:e.id})}}removeNode(e){var t;if(!this.findNode(e.id))return;let n,i=!1;if(e.parent?n=e.parent.children:this._shadowGraph&&(n=this._shadowGraph.rootNodes,i=!0),i){const n=this._selectDictionary(e.nodeType);n&&delete n[e.id],null===(t=this._hostEmitter)||void 0===t||t.emit(M.pD.hostModelRemovedRootNode,{address:void 0,message:e.id})}!function(e,t){if(t){const n=t.indexOf(e);if(-1!==n)t.splice(n,1)}}(e,n),e.retire()}async initialize(){}shutDown(){var e;this.retireAllShadowGraphRootNodes(),null===(e=this._shadowGraph)||void 0===e||e.clear()}_selectDictionary(e){switch(e){case vt.Z.TileNode:return this._tileNodeDictionary;case vt.Z.ParagraphNode:return this._paragraphNodeDictionary;case vt.Z.TerminalNode:return this._terminalNodeDictionary;default:return}}ensureCanFindNode(){return!!this._shadowGraph&&(this._preOrderTraverser.rootAtNodes(this._shadowGraph.rootNodes),!0)}retireAllShadowGraphRootNodes(){if(this._shadowGraph)for(const e of this._shadowGraph.rootNodes)e.retire()}_iterateGraph(e){const t=this._preOrderTraverser.getIterator();let n=t.next();for(;!n.done;){if(n.value&&n.value.id===e)return n.value;n=t.next()}return null}setTextProcessingParagraphFinder(e){this._paragraphFinder=e}findTileRootNode(e){var t;if(!this._paragraphFinder)return null;const n=this._paragraphFinder.getTileRootNodeById(e);return n&&null!==(t=Ui(n,this._tileNodeDictionary[e]))&&void 0!==t?t:null}findTextTileNode(e){if(!this._paragraphFinder)return null;const t=this._paragraphFinder.findParagraph(e);if(!t)return null;let n;if(t.parent){const e=this._tileNodeDictionary[t.parent.id];n=Ui(t.parent,e)}return Wi(t,n)}};ji=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,St.l)()),(0,r.__param)(0,(0,Me.W)(M.M5))],ji);let zi=class{isTileNode(e){return e.nodeType===vt.Z.TileNode}reconcile(e,t,n,i,r,o,a){return e.reconcile(t,n,!!i,!!r,!!o,!!a)}critiques(e){return e.critiques}getPreviousTileId(e){return e.getPreviousTileId()}getNextTileId(e){return e.getNextTileId()}};zi=(0,r.__decorate)([(0,Le._)()],zi);let Hi=class{constructor(e,t,n,i){this._hostEmitters=e,this._nodePoller=t,this._proofingDom=n,this._queryDetection=i,this.rehydrateTiles=e=>{const t=e.message;if(t.length>0)for(const e of t){const t=this._proofingDom.findTileNode(e);null==t||t.resetState()}else for(const e of this._proofingDom.tileNodes)e.resetState();this._nodePoller.pollNodes(g.G.NewData,this._proofingDom.tileNodes,p.Q0.Code,void 0,!0)}}async initialize(){for(const e of this._hostEmitters)e.on(M.pD.hostModelRehydrateTiles,this._handleRehydrate.bind(this))}shutDown(){}_handleRehydrate(e){this._queryDetection?this._queryDetection.handleAugloopReconnection((()=>{this.rehydrateTiles(e)})):this.rehydrateTiles(e)}};Hi=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Pn.t)(M.zJ)),(0,r.__param)(1,(0,Me.W)(T.G)),(0,r.__param)(2,(0,Me.W)(he.w)),(0,r.__param)(3,(0,St.l)()),(0,r.__param)(3,(0,Me.W)(_.J))],Hi);var Vi=n(40747);const Gi=(0,l.f)("IConditionalAttributeFilterFactory");class Qi{constructor(e){this.filters=e,this.attributeList=Array.from(e.keys())}shouldProofElement(e){let t=!1;return this.filters.forEach((n=>{t=t||n(e)})),!t}}const Ki=(0,l.f)("IShadowGraphFactory");var $i=n(67127),Zi=n(11387),Ji=n(26042);const Yi=(0,l.f)("ITextProcessingControllerFactory"),Xi=(0,l.f)("ITextAugmentationProcessingControllerFactory");(0,l.f)("ITextProcessingControllerLegacyWrapper");let er=class{constructor(e,t,n,i,r,o,a,s,l,u,d,c){this.proofingEmitter=e,this.proofingDom=t,this._textProcessorCoreFactory=n,this._textAugmentationCoreFactory=i,this._hostModelSettings=r,this._textEventPublisher=o,this._hostEmitters=a,this._featureFlagsReader=s,this._hostSettings=l,this._paragraphDeltasEnabled=u,this._queryDetection=d,this._wordDictionary=c,this.handleTextChangeEvent=e=>{this.textProcessingController.pushText(e.data,e.messageType)},this.handleTextStyleChangeEvent=()=>{this.proofingEmitter.emit("recomputeSquiggles")},this.initializeTextProcessingController=()=>{const e=this._textProcessorCoreFactory();return e.subscribe("critiquesAvailable",this._critiquesAvailableHandler),e.subscribe("clearTiles",this._clearTilesHandler),e.subscribe("tilesAvailable",this._tilesAvailableHandler),e.subscribe("stateReset",this._tileStateResetHandler),e.subscribe("tilingEvent",this._tilingEventHandler),e.subscribe("handleRemovedNodes",this._handleRemovedNodesHandler),this.proofingDom.setTextProcessingParagraphFinder(e.getParagraphFinder()),e},this.initializeTextAugmentationCore=()=>{const e=this.textProcessingController.getParagraphFinder(),t=this._textAugmentationCoreFactory(e);return t.subscribe("critiquesReceived",this._onCritiquesReceived),t.subscribe("clearTiles",this._handleOnRemoveTiles),t.subscribe("userRevertedAutoCorrection",this._handleUserRevertedAutoCorrection),t},this._tilingEventHandler=async e=>this.textAugmentationController.processTilingMessage(e),this._tileStateResetHandler=e=>{for(const t of this._hostEmitters)t.emit(M.pD.hostModelTileStateReset,{address:void 0,message:e.tileNodeId})},this._handleOnRemoveTiles=e=>{const t=e.tiles.map((e=>({tileId:e.header,supportedActions:0,suggestions:[],start:0,length:0,priority:0,languageId:""})));this.proofingEmitter.emit("critiqueEvent",{data:t,messageType:g.G.RemoveData})},this._onCritiquesReceived=e=>{if(e.tileId)return void this.textProcessingController.processTileCritiques({tileNodeId:e.tileId,critiques:e.critiques,messageType:0===e.critiques.length?g.G.RemoveData:g.G.ChangeData});const t=(0,$i.PD)(e.critiques);for(const e of t.keys()){const n=t.get(e);this.textProcessingController.processTileCritiques({tileNodeId:e,critiques:null!=n?n:[],messageType:0===(null==n?void 0:n.length)?g.G.RemoveData:g.G.ChangeData})}},this._critiquesAvailableHandler=e=>{const t=this.proofingDom.findNode(e.tileNodeId);t&&this.proofingEmitter.emit("squiggleDataEvent",{messageType:e.messageType,data:{critiquesToElementsMap:[{elementId:e.tileNodeId,element:t.element,critiques:e.critiques.map(Zi.OE)}]}})},this._clearTilesHandler=e=>{this._handleOnRemoveTiles({tiles:e})},this._handleUserRevertedAutoCorrection=e=>{(0,Ji.yf)(e.critique,this._wordDictionary)},this._tilesAvailableHandler=async e=>{const{schedulerDefaultWaitingTime:t,schedulerDefaultWaitingTimeIncrement:n,schedulerDefaultMaxTime:i}=this._hostModelSettings;this._proofingTimeout&&(window.clearTimeout(this._proofingTimeout),this._proofingTimeout=void 0,this._timeoutLength||(this._timeoutLength=t),this._timeoutLength=Math.min(this._timeoutLength+n,i)),this._proofingTimeout=window.setTimeout((async()=>{this._timeoutLength=t,await this.textAugmentationController.processTilingMessage(Object.assign({messageName:"textTilesMessage"},e)),this._proofingTimeout=void 0}),this._timeoutLength)},this._onFeatureFlagsChanged=e=>{const t=Object.assign(Object.assign(Object.assign(Object.assign({},e),this._hostModelSettings),this._hostSettings),{paragraphDeltasEnabled:this._paragraphDeltasEnabled.check()});this.textProcessingController.updateSettings(t)},this._handleRemovedNodesHandler=e=>{if(this._queryDetection)for(const t of e.nodesToRetire)this._queryDetection.handleTileRemoved(t)}}async initialize(){this._textEventPublisher.subscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.subscribe("styleChange",this.handleTextStyleChangeEvent),this._featureFlagsReader.subscribe("flagsChanged",this._onFeatureFlagsChanged)}shutDown(){var e,t,n,i,r,o,a,s,l;this._textEventPublisher.unsubscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.unsubscribe("styleChange",this.handleTextStyleChangeEvent),this._featureFlagsReader.unsubscribe("flagsChanged",this._onFeatureFlagsChanged),null===(e=this._textAugmentationController)||void 0===e||e.unsubscribe("critiquesReceived",this._onCritiquesReceived),null===(t=this._textAugmentationController)||void 0===t||t.unsubscribe("clearTiles",this._handleOnRemoveTiles),null===(n=this._textAugmentationController)||void 0===n||n.unsubscribe("userRevertedAutoCorrection",this._handleUserRevertedAutoCorrection),null===(i=this._textProcessingController)||void 0===i||i.unsubscribe("critiquesAvailable",this._critiquesAvailableHandler),null===(r=this._textProcessingController)||void 0===r||r.unsubscribe("clearTiles",this._clearTilesHandler),null===(o=this._textProcessingController)||void 0===o||o.unsubscribe("tilesAvailable",this._tilesAvailableHandler),null===(a=this._textProcessingController)||void 0===a||a.unsubscribe("stateReset",this._tileStateResetHandler),null===(s=this._textProcessingController)||void 0===s||s.unsubscribe("tilingEvent",this._tilingEventHandler),null===(l=this._textProcessingController)||void 0===l||l.unsubscribe("handleRemovedNodes",this._handleRemovedNodesHandler)}setProofingLanguages(e){this.textProcessingController.setProofingLanguages(e)}async pushText(e,t){return this.textProcessingController.pushText(e,t)}get textProcessingController(){return this._textProcessingController||(this._textProcessingController=this.initializeTextProcessingController()),this._textProcessingController}get textAugmentationController(){return this._textAugmentationController||(this._textAugmentationController=this.initializeTextAugmentationCore()),this._textAugmentationController}};er=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(W.o)),(0,r.__param)(1,(0,Me.W)(he.w)),(0,r.__param)(2,(0,Me.W)(Yi)),(0,r.__param)(3,(0,Me.W)(Xi)),(0,r.__param)(4,(0,Me.W)(st.k)),(0,r.__param)(5,(0,Me.W)(ft.n)),(0,r.__param)(6,(0,Pn.t)(M.zJ)),(0,r.__param)(7,(0,Me.W)(q.c)),(0,r.__param)(8,(0,Me.W)(Ie.n)),(0,r.__param)(9,(0,Me.W)(Ge.H)),(0,r.__param)(10,(0,St.l)()),(0,r.__param)(10,(0,Me.W)(_.J)),(0,r.__param)(11,(0,St.l)()),(0,r.__param)(11,(0,Me.W)(ge.s))],er);let tr=class extends _t{constructor(e,t,n,i,r){super(vt.Z.OutlineNode,e,t,n,i,r),this._observer=e,this.element&&this._observer.observe(this.element)}move(e,t){return super.move(e,t),this.element&&this._observer.observe(this.element),this}};tr=(0,r.__decorate)([(0,Le._)()],tr);var nr=n(19432),ir=n(10059);class rr{constructor(e,t){this.id=(0,yt.h)(),this.range=e,this.parent=t,t.registerChild(this)}retire(){var e;null===(e=this.parent)||void 0===e||e.unregisterChild(this),this.parent=void 0}move(e,t){return e&&(this.range=e),t&&(this.parent=t),this.id=(0,yt.h)(),this}}function or(e,t=!1){switch(e){case pn.fT.Sentence:return new si({newLineSentenceSeparatorEnabled:t});case pn.fT.Paragraph:return new li;default:return new ui}}class ar extends nr.z{constructor(e,t){super(),this._settings=e,this._logger=t}updateSettings(e){this._settings=e}updateParagraphNodes(e,t,n,i,r,o,a){if(!this._settings.enableOrchestration||!this._settings.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,n,i,r);const s={oldTextInfo:t,newTextInfo:n,tileNode:e,sequenceId:r,minDiffBounds:i,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(s),this._addNewChildren(s),this._buildGraphTransaction(s,o,a),s.graphTransaction}_updateExistingChildren(e){var t,n;if(!e.tileNode.children.length)return;const i=null!==(n=null===(t=e.oldTextInfo)||void 0===t?void 0:t.content)&&void 0!==n?n:"",r=e.newTextInfo.content,o=i!==r,a={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let s=e.tileNode.children.length-1;for(;s>=0;){const t=e.tileNode.children[s].range;if(i.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=r.length-i.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!o)){t.offset<e.minDiffBounds.firstDiffLeft&&(a.firstDiffLeft=Math.min(t.offset,a.firstDiffLeft));const n=i.length-t.offset-t.span;n<e.minDiffBounds.firstDiffRight&&(a.firstDiffRight=Math.min(n,a.firstDiffRight));const r=e.tileNode.children.splice(s,1);e.nodesToRetire.length&&a.firstDiffRight!==n?a.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...r):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...r):e.nodesToRetire.push(...r)}s-=1}e.unitRange={offset:a.firstDiffLeft,span:r.length-a.firstDiffRight-a.firstDiffLeft,enforcedCompleteTileTextUnit:!o&&this._settings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=hi(e.newTextInfo.content,e.minDiffBounds,or(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),e.unitRange);for(const n of t){const t=new rr(n,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.range.textUnit=(!1===e.range.validEndBoundary&&this._settings.enableOptimizedCallingPattern&&e.range.enforcedCompleteTileTextUnit,this._settings.completeTileTextUnit)}_buildTile(e,t,n,i){const r=t.range.offset,o=t.range.span;return{header:{nodeId:e.id,seqId:i.toString(),elementId:{id:t.id,offset:r,span:o},length:n.length},data:n.slice(r,r+o),proofingLanguages:this._settings.proofingLanguages,textUnit:t.range.textUnit}}_convertToUpdate(e,t,n,i,r,o){var a,s;if(!(null==e?void 0:e.range)||!(null==t?void 0:t.range))return;const l=null!==(s=null===(a=n.oldTextInfo)||void 0===a?void 0:a.content)&&void 0!==s?s:"",u=n.newTextInfo.content,d=l.length-e.range.offset-e.range.span,c=u.length-t.range.offset-t.range.span;if(!i&&e.range.offset!==t.range.offset||i&&d!==c)return;const h=this._emitParagraphDeltaUpdate(e,t,n,r,o);return e.range.offset=t.range.offset,e.range.span=t.range.span,e.range.validEndBoundary=t.range.validEndBoundary,e.range.enforcedCompleteTileTextUnit=t.range.enforcedCompleteTileTextUnit,e.range.textUnit=t.range.textUnit,t.retire(),n.nodesToAdd.splice(i?n.nodesToAdd.length-1:0,1),n.nodesToInsert.splice(i?n.nodesToInsert.length-1:0,1,e),n.nodesToRetire.splice(i?n.nodesToRetire.length-1:0,1),n.nodesToUpdate.push(e),n.graphTransaction.unreconciledContent.find((n=>{const i=n.header.elementId.id===t.id;return i&&(n.header.elementId.id=e.id),i})),h}_buildGraphTransaction(e,t,n){e.nodesToInsert=[...e.nodesToAdd];const i=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,n),r=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,n);sr(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();i&&this.publishEvent("deltaEvent",i),r&&this.publishEvent("deltaEvent",r),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,n,i,r){var o;const a={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},s=this._updateExistingChildrenDeprecated(e,null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"",n.content,i,a);return this._addNewChildrenDeprecated(e,n,i,r,s,a)}_updateExistingChildrenDeprecated(e,t,n,i,r){if(e.children.length){const o=Object.assign({},i),a=t!==n;let s=e.children.length-1;for(;s>=0;){const l=e.children[s].range;if(l.offset<i.firstDiffLeft&&l.offset+l.span<i.firstDiffLeft||l.offset+l.span===i.firstDiffLeft&&l.validEndBoundary&&a);else if(t.length-l.offset<i.firstDiffRight)l.offset=n.length-t.length+l.offset,r.updatedNodes.push(e.children[s].id);else{l.offset<i.firstDiffLeft&&(o.firstDiffLeft=Math.min(l.offset,o.firstDiffLeft));const n=t.length-l.offset-l.span;n<i.firstDiffRight&&(o.firstDiffRight=Math.min(n,o.firstDiffRight));const a=e.children.splice(s,1);for(const e of a)r.removedNodes.push(e.id),e.retire()}s-=1}return{offset:o.firstDiffLeft,span:n.length-o.firstDiffRight-o.firstDiffLeft,enforcedCompleteTileTextUnit:!a&&this._settings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,n,i,r,o){const a=hi(t.content,n,or(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),r),s=[];for(const n of a){const r=new rr(n,e);this._attachTextUnit(r),s.push(r),o.unreconciledContent.push(this._buildTile(e,r,t.content,i)),o.addedNodes.push(r.id)}return sr(e,s),o}_emitParagraphDeltaUpdate(e,t,n,i,r){if(this._settings.paragraphDeltasEnabled){const o=yn(n.oldTextInfo,e.range.offset,e.range.offset+e.range.span),a=yn(n.newTextInfo,t.range.offset,t.range.offset+t.range.span);if(e.registered||this._emitParagraphAdd(n,e,i),void 0!==e.eventSeqId){e.eventSeqId+=1;const n=lr(e,o,a,!!t.range.validEndBoundary,!!t.range.enforcedCompleteTileTextUnit,i,r,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,e.cachedWordCount);return e.cachedWordCount=n.wordCount,n}}}_emitParagraphDeltaAdd(e,t){if(this._settings.paragraphDeltasEnabled)if(e.nodesToAdd.length<=2||!this._settings.batchTileProcessingEnabled)for(const n of e.nodesToAdd)this._emitParagraphAdd(e,n,t);else this._emitParagraphBatchAdd(e,t)}_emitParagraphAdd(e,t,n){var i;if(t.registered)return void(this._settings.enableParagraphDeltasVerboseLogging&&(null===(i=this._logger)||void 0===i||i.info(539002012,"The node has been registered, skipping")));const r=this._settings.enableParagraphDeltasEmptyInitialTile&&n===p.Q0.Local,o=yn(e.newTextInfo,t.range.offset,t.range.offset+t.range.span);t.eventSeqId=0;const a=r?Object.assign(Object.assign({},o),{content:""}):o,s=this._getNodeAddEventData(e.tileNode,t,a,n);if(this.publishEvent("nodeEvent",s),r){t.eventSeqId+=1;const e=this._getDeltaEventData(t,o,n);this.publishEvent("deltaEvent",e)}t.registered=!0}_emitParagraphBatchAdd(e,t){const n=[];for(const i of e.nodesToAdd){if(i.registered)continue;const r=yn(e.newTextInfo,i.range.offset,i.range.offset+i.range.span);i.eventSeqId=0;const o=this._getNodeAddEventData(e.tileNode,i,r,t);n.push(o),i.registered=!0}this.publishEvent("nodeBatchEvent",n)}_getNodeAddEventData(e,t,n,i){var r;const o=e.findPreviousChildNode(t),a=e.findNextChildNode(t);return{tileNodeId:e.id,id:t.id,content:n,eventSeqId:null!==(r=t.eventSeqId)&&void 0!==r?r:0,mutationChangeType:i,messageType:g.G.NewData,documentModel:e.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(t),prevTileId:"#head#"===o?o:null==o?void 0:o.id,nextTileId:"#tail#"===a?a:null==a?void 0:a.id}}_getDeltaEventData(e,t,n){return lr(e,void 0,t,!!e.range.validEndBoundary,!0,n,!1,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,0)}_emitParagraphDeltaRetire(e,t){if(this._settings.paragraphDeltasEnabled&&0!==e.nodesToRetire.length)if(this._settings.batchTileProcessingEnabled&&e.nodesToRetire.length>1)this._emitParagraphBatchRetire(e,t);else for(const n of e.nodesToRetire)n.registered=!1,this.publishEvent("nodeEvent",this._getNodeRetireEventData(e,n,t))}_emitParagraphBatchRetire(e,t){const n=[];for(const i of e.nodesToRetire)i.registered=!1,n.push(this._getNodeRetireEventData(e,i,t));n.length>0&&this.publishEvent("nodeBatchEvent",n)}_getNodeRetireEventData(e,t,n){var i;return{tileNodeId:e.tileNode.id,id:t.id,content:{content:""},eventSeqId:null!==(i=t.eventSeqId)&&void 0!==i?i:0,mutationChangeType:n,messageType:g.G.RemoveData,documentModel:e.tileNode.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(t)}}getSpecifiedLocaleForNode(e){var t,n;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(n=e.parent)||void 0===n?void 0:n.specifiedLocale}}function sr(e,t){if(t.length){const n=t[0].range.offset;if(e.children.length){let i=e.children.length-1,r=t;for(;i>=0;){if(n>e.children[i].range.offset){e.children.splice(i,0,...r),r=[];break}i-=1}r.length&&e.children.splice(0,0,...r)}else e.children=t}}function lr(e,t,n,i,r,o,a,s,l,u,d){var c,h;const g=null!==(c=null==t?void 0:t.content)&&void 0!==c?c:"",p=n.content,f=Bi.CC(g,p);a&&(f.firstDiffLeft-=1);let m=!1;if(!i&&l!==pn.fT.Phrase&&l!==s){const e=f.firstDiffLeft,t=p.length-f.firstDiffRight;m=-1!==or(l).findEndBoundary(p,e-1,t)}const v=new vi(new fi.a,u),y=null!=d?d:v.getWordCount(g),_=v.hasWordCountChanged(f,y,p,!0);let b,C=hn.OD.Word;if(r?C=fn(s):m?C=fn(l):_.isWordCountChanged?i&&(C=fn(s)):C=hn.OD.Chars,s===pn.fT.Paragraph&&l===pn.fT.Sentence&&C!==hn.OD.Paragraph){const e=f.firstDiffLeft,t=or(l),n=t.findBeginBoundary(p,e,0),i=t.findEndBoundary(p,e-1,p.length);b=[{position:n,length:(-1===i?p.length:i)-n,unit:hn.OD.Sentence}]}return{textTileNode:e,oldTextInfo:t,newTextInfo:n,minDiffBounds:f,wordCount:_.wordCount,deltaUnit:C,mutationChangeType:o,invalidationRanges:b,wordBoundaries:null!==(h=_.wordBoundaries)&&void 0!==h?h:[]}}class ur extends nr.z{constructor(e,t,n){super(),this.id=e,this._settings=t,this._logger=n,this._cachedWordCount=0,this._cachedTiles=new Map,this._dirtyParagraphIds=new Set,this.seqId=0,this._eventSeqId=0,this.children=[],this.childrenIdMap=new Map,this._disposed=!1,this._publishDirtyParagraphsDiff=(e,t)=>{for(const n of this._dirtyParagraphIds){const i=this.childrenIdMap.get(n);if(!i)continue;const r=yn(e,i.range.offset,i.range.offset+i.range.span);this.publishEvent("paragraphDiff",{paragraph:i,textInfo:r,mutationChangeType:t})}this._dirtyParagraphIds.clear()},this._publishLastParagraphDiff=(e,t)=>{if(0===this.children.length)return;let n=this.children[0];for(const e of this.children)e.range.offset>n.range.offset&&(n=e);const i=yn(e,n.range.offset,n.range.offset+n.range.span);this.publishEvent("paragraphDiff",{paragraph:n,textInfo:i,mutationChangeType:t})},this.isForceRehydrationExpected=!1,this._republishTextTileDeltaEvent=e=>{this._detectDirtyTextTile(e),this.publishEvent("textTileDeltaEvent",e)},this._republishTextTileNodeEvent=e=>{this.publishEvent("textTileNodeEvent",e)},this._republishTextTileNodeBatchEvent=e=>{this.publishEvent("textTileNodeBatchEvent",e)},this._detectDirtyTextTile=e=>{e.deltaUnit===hn.OD.Sentence||e.deltaUnit===hn.OD.Paragraph?this._dirtyParagraphIds.delete(e.textTileNode.id):this._dirtyParagraphIds.add(e.textTileNode.id)},this._wordCount=new fi.a,this._wordCountDetector=new vi(this._wordCount,this._settings),this._textTileNodeManager=new ar(this._settings,this._logger),this._textTileNodeManager.subscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.subscribe("nodeEvent",this._republishTextTileNodeEvent),this._textTileNodeManager.subscribe("nodeBatchEvent",this._republishTextTileNodeBatchEvent),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetInternal()}get eventSeqId(){return this._eventSeqId}get cachedText(){var e;return null!==(e=this._cachedTextInfo)&&void 0!==e?e:{content:""}}get disposed(){return this._disposed}get previousNodeId(){return void 0===this.previousNode||"#head#"===this.previousNode?this.previousNode:this.previousNode.id}get nextNodeId(){return void 0===this.nextNode||"#tail#"===this.nextNode?this.nextNode:this.nextNode.id}resetInternal(){this._cachedTextInfo=void 0,this._cachedWordCount=0,this.documentModel=void 0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();this.children=[],this.childrenIdMap.clear(),this._invalidationDiffBounds=void 0}updateSettings(e){this._settings=e,this._wordCountDetector=new vi(this._wordCount,this._settings),this._textTileNodeManager.updateSettings(e)}resetState(){if(this.removeAllParagraphNodesFromAugloop(),this.resetInternal(),!this._settings.enableOrchestration){const e={firstDiffLeft:0,firstDiffRight:0};this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:"",newText:"",minDiffBounds:e,maxDiffBounds:e,seqId:this.seqId,forceReflow:!0})}this.publishEvent("stateReset",{tileNodeId:this.id})}async dispose(){this.resetInternal(),this._textTileNodeManager.unsubscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.unsubscribe("nodeEvent",this._republishTextTileNodeEvent),this._textTileNodeManager.unsubscribe("nodeBatchEvent",this._republishTextTileNodeBatchEvent),this._disposed=!0}reconcile(e){var t,n,i,r,o,a,s,l,u;if(e.rehydrateCritiques&&e.idleReconcileTrigger&&!this.isForceRehydrationExpected)return;const d=null!==(n=null===(t=this._cachedTextInfo)||void 0===t?void 0:t.content)&&void 0!==n?n:"",c=e.text.content,h=Bi.CC(d,c);return this.documentModel=e.documentModel,e.mutationWasTextReplacement&&(h.firstDiffLeft-=1),c!==d&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},h)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,h.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,h.firstDiffRight)),this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:null===(i=e.brokerOptions)||void 0===i?void 0:i.critiques,oldText:d,newText:c,minDiffBounds:h,maxDiffBounds:null!==(r=this._invalidationDiffBounds)&&void 0!==r?r:{firstDiffLeft:d.length,firstDiffRight:0},seqId:this.seqId,forceReflow:null!==(a=null===(o=e.brokerOptions)||void 0===o?void 0:o.forceReflow)&&void 0!==a?a:void 0!==(null===(s=e.brokerOptions)||void 0===s?void 0:s.critiques)}),c===d&&this.children.length>0&&(!e.rehydrateCritiques||e.optimizedRehydrationEnabled)?(e.rehydrateCritiques&&(e.useDirtyParagraphReconciliation?this._publishDirtyParagraphsDiff(e.text,e.mutationChangeType):this._publishLastParagraphDiff(e.text,e.mutationChangeType)),this._settings.enableOrchestration&&(e.forceTileDiffEmission||e.rehydrateCritiques)&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,cachedTextInfo:this._cachedTextInfo,newTextInfo:e.text,minDiffBounds:h,hasWordChanges:!1,cachedWordCount:this._cachedWordCount,cachedTiles:Array.from(this._cachedTiles.values()),mutationChangeType:e.mutationChangeType,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e.text),void(this._cachedTextInfo=e.text)):this._reconcileState(e.text,h,null!==(l=e.rehydrateCritiques)&&void 0!==l&&l,e.mutationChangeType,null!==(u=e.mutationWasTextReplacement)&&void 0!==u&&u)}findPreviousChildNode(e){var t;const n=e.range.offset;for(const t of this.children)if(t!==e&&t.range.offset+t.range.span===n)return t;return"#head#"===this.previousNode?this.previousNode:null===(t=this.previousNode)||void 0===t?void 0:t.findLastChildNode()}findNextChildNode(e){var t;const n=e.range.offset+e.range.span;for(const t of this.children)if(t!==e&&t.range.offset===n)return t;return"#tail#"===this.nextNode?this.nextNode:null===(t=this.nextNode)||void 0===t?void 0:t.findFirstChildNode()}findLastChildNode(){let e;for(const t of this.children)(!e||t.range.offset>e.range.offset)&&(e=t);return e}findFirstChildNode(){let e;for(const t of this.children)(!e||t.range.offset<e.range.offset)&&(e=t);return e}_reconcileFormatting(e){var t,n;if(this._cachedTextInfo){if(this._settings.enableAttributionRangeExceptionInFormattedTextDeltas){const n=this._settings.enableAttributionRangeInAddDelta&&!wn(this._cachedTextInfo.attributionRanges,e.attributionRanges);if(!wn(this._cachedTextInfo.formattedRanges,e.formattedRanges)||n){for(const t of this.children){const i=t.range.offset+t.range.span,r=Cn(this._cachedTextInfo,t.range.offset,i),o=Cn(e,t.range.offset,i);wn(r.formattedRanges,o.formattedRanges)&&!n||this.publishEvent("formattingDiff",{paragraph:t,sourceType:p.pf.ParagraphNode,data:{formattedRanges:o.formattedRanges,attributionRanges:n?o.attributionRanges:void 0}})}this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:p.pf.TileNode,data:null!==(t=e.formattedRanges)&&void 0!==t?t:[]})}}else if(!wn(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){const n=Cn(this._cachedTextInfo,t.range.offset,t.range.offset+t.range.span),i=Cn(e,t.range.offset,t.range.offset+t.range.span);wn(n.formattedRanges,i.formattedRanges)&&wn(n.attributionRanges,i.attributionRanges)||this.publishEvent("formattingDiff",{paragraph:t,sourceType:p.pf.ParagraphNode,data:i})}this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:p.pf.TileNode,data:null!==(n=e.formattedRanges)&&void 0!==n?n:[]})}if(!wn(this._cachedTextInfo.objectReferences,e.objectReferences)||!Sn(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of Tn)"objectReferences"!==e&&delete t[e];for(const e of this.children)this.publishEvent("formattingDiff",{paragraph:e,sourceType:p.pf.ParagraphNode,data:t});this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:p.pf.TileNode,data:t})}}}retire(){var e,t,n;this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:null!==(t=null===(e=this._cachedTextInfo)||void 0===e?void 0:e.content)&&void 0!==t?t:"",newText:"",minDiffBounds:this._invalidationDiffBounds,maxDiffBounds:this._invalidationDiffBounds,seqId:this.seqId,forceReflow:!0}),this._settings.enableOrchestration&&(this.publishEvent("removeTileNode",{tileNodeId:this.id}),this.removeAllParagraphNodesFromAugloop()),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),null===(n=this._logger)||void 0===n||n.debug(562057756,"Retire node",this.id)}removeAllParagraphNodesFromAugloop(){if(!this._settings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._settings.paragraphDeltasEnabled)for(const t of e)this.publishEvent("textTileNodeEvent",{tileNodeId:this.id,id:t,eventSeqId:this.seqId,mutationChangeType:p.Q0.Code,messageType:g.G.RemoveData,specifiedLocale:this.specifiedLocale,documentModel:this.documentModel});else this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},mutationChangeType:p.Q0.Code})}move(e){const t=this.id;return this.id=(0,yt.h)(),this.publishEvent("brokerNodeChange",{oldNodeId:t,newNodeId:this.id}),this.documentModel=e,this.id}_reconcileState(e,t,n,i,r){const o=this.seqId+1,a=e.content;let s;if(this._settings.paragraphDeltasEnabled)s=!1,this._cachedWordCount=0;else if(this._settings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,a);s=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else s=this._reconcileWordCount(t,a);const l=this._textTileNodeManager.updateParagraphNodes(this,this._cachedTextInfo,e,t,o,i,r);if(this._reconcileParagraphs(l,o),this._settings.enableOrchestration&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,newTextInfo:e,minDiffBounds:t,cachedWordCount:this._cachedWordCount,mutationChangeType:i,hasWordChanges:s,graphTransaction:l,cachedTextInfo:this._cachedTextInfo,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e),this._cachedTextInfo=e,n||s||this._settings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._settings.enableOptimizedCallingPattern&&i!==p.Q0.Code&&this.setIsForceRehydrationExpected(),this._settings.enableOrchestration){for(const e of l.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);l.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._settings.paragraphDeltasEnabled?l.removedNodes.length>0&&this.publishEvent("handleRemovedNodes",{tileNodeId:this.id,nodesToRetire:l.removedNodes}):this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:l,mutationChangeType:i,newTextInfo:e})}return this._resetInvalidationStateAndReturnTiles(l.unreconciledContent,o)}this.setIsForceRehydrationExpected()}setIsForceRehydrationExpected(){this._invalidationDiffBounds&&(this.isForceRehydrationExpected=!0)}clearIsForceRehydrationExpected(){this.isForceRehydrationExpected=!1}critiqueAction(e,t){return!this._settings.enableOrchestration&&(this.publishEvent("brokerProcessCritiqueAction",{tileNodeId:this.id,actionType:e,offset:t}),e===ir.$w.ApplySuggestion&&this.reconcile({text:this.cachedText,mutationChangeType:p.Q0.Local}),!0)}_reconcileWordCount(e,t){const n=this._wordCountDetector.getWordCount(t);let i=0;e.firstDiffLeft<=t.length&&(i=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const r=n>0&&(n!==this._cachedWordCount||i>1);return this._cachedWordCount=n,r}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,n]of this._cachedTiles)-1===this.children.findIndex((t=>t.id===e))?this._cachedTiles.delete(e):n.header.seqId=t.toString();e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._settings.enableOptimizedCallingPattern||this.clearIsForceRehydrationExpected(),this._invalidationDiffBounds=void 0,this.seqId=t,e}registerChild(e){this.childrenIdMap.set(e.id,e),this.publishEvent("registerChildNode",{tileNodeId:this.id,childNodeId:e.id})}unregisterChild(e){this.childrenIdMap.delete(e.id),this.publishEvent("unregisterChildNode",{childNodeId:e.id})}getChildById(e){return this.childrenIdMap.get(e)}}class dr extends nr.z{constructor(e,t,n){super(),this._settings=e,this._proofingLanguages=t,this._logger=n,this._textTileNodes=new Map,this._textTileNodeToRootNode=new Map,this._disposed=!1,this._brokerMoveEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerMove"},e))},this._brokerCritiqueActionEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerCritiqueAction"},e))},this._brokerReconcileEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerReconcile"},e))},this._removeTileNodeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const n={tileId:e.tileNodeId,tileVersion:t.eventSeqId,documentModel:t.documentModel,changeType:p.Q0.Code,isTextNode:!1,tile:void 0};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:n,messageType:g.G.RemoveData})},this._tileDiffEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const n=function(e,t,n,i,r){var o,a;const s=null!==(o=e.graphTransaction)&&void 0!==o?o:{addedNodes:[],unreconciledContent:null!==(a=e.cachedTiles)&&void 0!==a?a:[],removedNodes:[],updatedNodes:[]};let l=hn.OD.Chars;s.unreconciledContent.some((e=>e.textUnit===pn.fT.Paragraph))?l=hn.OD.Paragraph:s.unreconciledContent.some((e=>e.textUnit===pn.fT.Sentence))?l=hn.OD.Sentence:e.hasWordChanges&&(l=hn.OD.Word);const u=s.unreconciledContent.map((e=>{var i;return{position:e.header.elementId.offset,length:e.header.elementId.span,unit:fn(e.textUnit),languageId:null!==(i=t.specifiedLocale)&&void 0!==i?i:n}}));return En(e.tileNodeId,t.eventSeqId,i,e.cachedTextInfo,e.newTextInfo,e.minDiffBounds,e.cachedWordCount,l,p.pf.TileNode,e.mutationChangeType,r,u)}(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel,this._settings.enableAttributionRangeInAddDelta);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},n.message)),this._handleAttributionDelta(n.message,n.attributionData)},this._paragraphDiffEventHandler=e=>{var t,n,i;const r=En(e.paragraph.id,null!==(t=e.paragraph.eventSeqId)&&void 0!==t?t:0,null===(n=e.paragraph.parent)||void 0===n?void 0:n.documentModel,e.textInfo,e.textInfo,{firstDiffLeft:e.paragraph.range.span,firstDiffRight:0},null!==(i=e.paragraph.cachedWordCount)&&void 0!==i?i:0,hn.OD.Sentence,p.pf.ParagraphNode,e.mutationChangeType,this._settings.enableAttributionRangeInAddDelta);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},r.message)),this._handleAttributionDelta(r.message,r.attributionData)},this._paragraphNodeChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const n=function(e,t,n,i,r){var o,a,s;const l=null!==(o=e.graphTransaction)&&void 0!==o?o:{addedNodes:[],unreconciledContent:[],removedNodes:null!==(a=e.nodesToRetire)&&void 0!==a?a:[],updatedNodes:[]},u=null!==(s=e.mutationChangeType)&&void 0!==s?s:p.Q0.Code,d=l.removedNodes.map((e=>({messageType:g.G.RemoveData,data:{tileId:e,tileVersion:t.eventSeqId,documentModel:i,changeType:u,isTextNode:!0,tile:void 0}})));return d.push(...l.unreconciledContent.map((o=>{const{prev:a,next:s}=function(e,t){const n=e.getChildById(t);if(!n)return{prev:void 0,next:void 0};const i=e.findPreviousChildNode(n),r=e.findNextChildNode(n);return{prev:"#head#"===i?i:null==i?void 0:i.id,next:"#tail#"===r?r:null==r?void 0:r.id}}(t,o.header.elementId.id);return{messageType:r&&!l.addedNodes.includes(o.header.elementId.id)?g.G.ChangeData:g.G.NewData,data:{tileId:o.header.elementId.id,tileVersion:t.eventSeqId,documentModel:i,changeType:u,isTextNode:!0,tile:new cn.Cg(Object.assign(Object.assign({},e.newTextInfo),{content:o.data,formattedRanges:[{start:0,length:o.data.length,languageId:n}]})),prevId:a,nextId:s}}}))),d}(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel,this._settings.enableParagraphUpdates);this.publishEvent("tilingEvent",{messageName:"hostModelParagraphTextTiles",data:n})},this._formattingDiffEventHandler=e=>{var t,n,i;let r,o,a=0;if(e.tileNodeId){const n=this.getTileRootNodeById(e.tileNodeId);r=null==n?void 0:n.id,a=null!==(t=null==n?void 0:n.eventSeqId)&&void 0!==t?t:0,o=null==n?void 0:n.documentModel}if(!r&&e.paragraph&&(r=e.paragraph.id,a=null!==(n=e.paragraph.eventSeqId)&&void 0!==n?n:0,o=null===(i=e.paragraph.parent)||void 0===i?void 0:i.documentModel),!r)return;const s=xn(r,a,o,e.sourceType,e.data);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelFormattingDelta"},s))},this._textTileNodeEventHandler=e=>{const t=An(e,this._proofingLanguages.defaultLanguageCode);this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:e.messageType})},this._textTileNodeBatchEventHandler=e=>{const t=e.map((e=>({messageType:e.messageType,data:An(e,this._proofingLanguages.defaultLanguageCode)})));this.publishEvent("tilingEvent",{messageName:"hostModelBatchTextTile",data:t})},this._textTileDeltaEventHandler=e=>{var t,n;const i=En(e.textTileNode.id,null!==(t=e.textTileNode.eventSeqId)&&void 0!==t?t:0,null===(n=e.textTileNode.parent)||void 0===n?void 0:n.documentModel,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,p.pf.ParagraphNode,e.mutationChangeType,this._settings.enableAttributionRangeInAddDelta,e.invalidationRanges,e.wordBoundaries);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},i.message)),this._handleAttributionDelta(i.message,i.attributionData)},this._handleAttributionDelta=(e,t)=>{(null==t?void 0:t.length)&&this._settings.enableAttributionRangeInAddDelta&&this.publishEvent("tilingEvent",{messageName:"hostModelAttributionDelta",tileId:e.tileId,tileVersion:e.tileVersion,documentModel:e.documentModel,sourceType:e.sourceType,delta:t})},this._stateChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);t&&this._sendNewTextTileEvent(t),this.publishEvent("stateReset",e)},this._handleRemovedNodesEventHandler=e=>{this.publishEvent("handleRemovedNodes",e)},this._registerChildNodeEventHandler=e=>{this._textTileNodeToRootNode.set(e.childNodeId,e.tileNodeId)},this._unregisterChildNodeEventHandler=e=>{this._textTileNodeToRootNode.delete(e.childNodeId)},this._sendNewTextTileEvent=e=>{const t={tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:p.Q0.Code,isTextNode:!1,tile:void 0,prevId:e.previousNodeId,nextId:e.nextNodeId};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:g.G.NewData})},this._findTextTileNodeById=e=>{var t;const n=this._textTileNodeToRootNode.get(e);if(n)return null===(t=this._textTileNodes.get(n))||void 0===t?void 0:t.getChildById(e)}}get disposed(){return this._disposed}async dispose(){if(!this._disposed){for(const e of this._textTileNodes.values())e.unsubscribe("stateReset",this._stateChangeEventHandler),e.unsubscribe("removeTileNode",this._removeTileNodeEventHandler),e.unsubscribe("tileDiff",this._tileDiffEventHandler),e.unsubscribe("paragraphDiff",this._paragraphDiffEventHandler),e.unsubscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),e.unsubscribe("formattingDiff",this._formattingDiffEventHandler),e.unsubscribe("registerChildNode",this._registerChildNodeEventHandler),e.unsubscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),e.unsubscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),e.unsubscribe("textTileNodeEvent",this._textTileNodeEventHandler),e.unsubscribe("textTileNodeBatchEvent",this._textTileNodeBatchEventHandler),e.unsubscribe("textTileDeltaEvent",this._textTileDeltaEventHandler),e.unsubscribe("brokerNodeChange",this._brokerMoveEventHandler),e.unsubscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),e.unsubscribe("brokerReconcile",this._brokerReconcileEventHandler),await e.dispose();this._textTileNodes.clear(),this._disposed=!0}}resetState(){for(const e of this._textTileNodes.values())e.resetState()}setProofingLanguages(e){this._proofingLanguages=e;for(const e of this._textTileNodes.values())e.reconcile({text:e.cachedText,mutationChangeType:p.Q0.Code})}updateSettings(e){this._settings=e;for(const e of this._textTileNodes.values())e.updateSettings(this._getTileRootNodeSettings())}async pushText(e,t){const n=[];for(const t of e){const e=this._getTileRootNodeForExternalId(t.tileNodeId);e.previousNode=this.getPreviousTileRootNode(t.previousNodeId),e.nextNode=this.getNextTileRootNode(t.nextNodeId);const i=e.reconcile(t);i&&n.push(...i)}if(0===n.length)return;const i=this._buildTilesToSend(n,this._proofingLanguages),r={messageType:t,data:{tiles:i,uxLanguage:this._proofingLanguages.defaultLanguageCode}};t!==g.G.RemoveData?this.publishEvent("tilesAvailable",r):this.publishEvent("clearTiles",i)}retireTileNode(e){const t=this._textTileNodes.get(e);t&&(t.retire(),this._textTileNodes.delete(e))}moveTileNode(e,t,n){const i=this._textTileNodes.get(e);if(!i)return;const r=i.documentModel,o=null!=n?n:r,a=i.id,s=i.move(o);this._textTileNodes.delete(e),this._textTileNodes.set(t,i);const l=function(e,t,n,i,r,o,a,s,l){var u;return{oldTileId:e,newTileId:t,tileVersion:n,oldDocumentModel:s,newDocumentModel:l,tile:new cn.Cg(Object.assign(Object.assign({},i),{formattedRanges:[...null!==(u=i.formattedRanges)&&void 0!==u?u:[],{start:0,length:i.content.length,languageId:r}]})),prevId:o,nextId:a}}(a,s,i.eventSeqId,i.cachedText,this._proofingLanguages.defaultLanguageCode,i.previousNodeId,i.nextNodeId,r,o);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelMoveTextTile"},l))}_buildTilesToSend(e,t){const n=[];for(const i of e)for(const e of t.codesList)n.push(Object.assign(Object.assign({},i),{proofingLanguages:[e]}));return n}_getTileRootNodeForExternalId(e){let t=this._textTileNodes.get(e);return t||(t=this._textTileNodes.get(e)),t||(t=new ur(e,this._getTileRootNodeSettings(),this._logger),this._textTileNodes.set(e,t),t.subscribe("stateReset",this._stateChangeEventHandler),t.subscribe("removeTileNode",this._removeTileNodeEventHandler),t.subscribe("tileDiff",this._tileDiffEventHandler),t.subscribe("paragraphDiff",this._paragraphDiffEventHandler),t.subscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),t.subscribe("formattingDiff",this._formattingDiffEventHandler),t.subscribe("textTileNodeEvent",this._textTileNodeEventHandler),t.subscribe("textTileNodeBatchEvent",this._textTileNodeBatchEventHandler),t.subscribe("textTileDeltaEvent",this._textTileDeltaEventHandler),t.subscribe("registerChildNode",this._registerChildNodeEventHandler),t.subscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),t.subscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),t.subscribe("brokerNodeChange",this._brokerMoveEventHandler),t.subscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),t.subscribe("brokerReconcile",this._brokerReconcileEventHandler),this._sendNewTextTileEvent(t)),t}getTileRootNodeById(e){return this._textTileNodes.get(e)}_getTileRootNodeSettings(){return Object.assign(Object.assign({},this._settings),{proofingLanguages:this._proofingLanguages.codesList})}getParagraphFinder(){return{findParagraph:e=>this._findTextTileNodeById(e),getParagraphText:e=>{const t=e.parent;if(t)return t.cachedText.content.slice(e.range.offset,e.range.offset+e.range.span)},getParagraphTextForCritique:(e,t)=>{const n=e.parent;if(!n)return;const i=t.endNode?this._findTextTileNodeById(t.endNode.nodeId):e;if(!i)return;const r=t.endNode?i.range.offset+t.endNode.end:t.start+t.length,o=n.cachedText.content;if(i.parent===n)return o.substring(t.start,r).replace(/\u00A0/g," ");let a,s=o.substring(t.start)+"\n",l=n;do{if(a=l.nextNode,!a||"#tail#"===a)return;l=a;const e=l===i.parent,t=e?r:void 0,n=e?"":"\n";s+=l.cachedText.content.substring(0,t)+n}while(l!==i.parent);return s},isCritiqueInNode:(e,t)=>t.nodeId!==e.id&&!(t.start>=e.range.offset+e.range.span||e.range.offset>=t.start+t.length),getTileRootNodeById:e=>this.getTileRootNodeById(e),getTileNodeParagraphs:e=>{var t;return null===(t=this._textTileNodes.get(e))||void 0===t?void 0:t.children}}}async processTileCritiques(e){const t=e.tileNodeId;for(const n of e.critiques)n.tileId&&(n.tileId.nodeId=t);this.publishEvent("critiquesAvailable",{tileNodeId:t,critiques:e.critiques,messageType:e.messageType})}getPreviousTileRootNode(e){return void 0===e||"#head#"===e?e:this._getTileRootNodeForExternalId(e)}getNextTileRootNode(e){return void 0===e||"#tail#"===e?e:this._getTileRootNodeForExternalId(e)}}let cr=class extends _t{constructor(e,t,n,i,r,o,a,s,l,u,d,c,h,f,m,v,y,_,b,C,T,S){super(f,m,void 0,y,C,T),this._guidGenerator=e,this._logger=t,this._wordCount=n,this._wordCountDetector=i,this._settings=r,this._nodePoller=o,this._proofingDom=a,this._tileContent=s,this._hostSettings=l,this.featureFlagsReader=u,this._paragraphDeltasEnabled=d,this._optimizedRehydrationEnabled=c,this._hostTilingEmitter=h,this.nodeType=f,this._observer=m,this._paragraphNodesBuilder=v,this.element=y,this._hostEmitters=_,this.nodeTraverser=b,this.parent=C,this.queryDetection=S,this._children=[],this._cachedWordCount=0,this._cachedTiles=new Map,this._seqId=0,this._eventSeqId=0,this.id=this._guidGenerator.generate(),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetState(!0),this._proofingDom.registerNode(this),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,g.G.NewData,p.Q0.Code,vt.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}get children(){var e;return this._hostSettings.sdkV2Enabled?null!==(e=this._proofingDom.getTileNodeV2Paragraphs(this))&&void 0!==e?e:[]:this._children}set children(e){this._children=e}getPreviousTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findPreviousTileNode(this);return"#head#"===t?t:null==t?void 0:t.id}getNextTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findNextTileNode(this);return"#tail#"===t?t:null==t?void 0:t.id}retire(){this._nodePoller.removeQueuedTiles(this.id),this._clearReconcileTimer(),this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this._hostSettings.enableOrchestration&&(this._hostTilingEmitter.emitTileEvent(this,this.id,void 0,this._eventSeqId,g.G.RemoveData,p.Q0.Code,vt.Z.TileNode,this.specifiedLocale),this.removeAllParagraphNodesFromAugloop()),this.parent=void 0,this._cachedTextInfo=void 0,this._currentText=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._logger.debug(562057756,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}removeAllParagraphNodesFromAugloop(){if(!this._hostSettings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._paragraphDeltasEnabled.check())for(const t of e)this._hostTilingEmitter.emitTileEvent(this,t,void 0,this._eventSeqId,g.G.RemoveData,p.Q0.Code,vt.Z.ParagraphNode,this.specifiedLocale);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},p.Q0.Code,void 0)}move(e,t){var n;const i=(0,Fn.F)(this),r=(0,Fn.F)(null!=t?t:this);this._nodePoller.removeQueuedTiles(this.id),this._proofingDom.unregisterNode(this);const o=this.id;return super.move(e,t),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitMoveTileEvent(o,this.id,null!==(n=this._cachedTextInfo)&&void 0!==n?n:{content:""},this._eventSeqId,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId(),null==i?void 0:i.documentModel,null==r?void 0:r.documentModel),this._proofingDom.registerNode(this),this}resetState(e){e||this.removeAllParagraphNodesFromAugloop(),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();if(this.children=[],this._invalidationDiffBounds=void 0,!e){for(const e of this._hostEmitters)e.emit(M.pD.hostModelTileStateReset,{address:void 0,message:this.id});this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,g.G.NewData,p.Q0.Code,vt.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,n,i,r,o){var a,s,l,u,d,c;if(this.parent){const t=null!==(a=this._tileContent.getText(this))&&void 0!==a?a:{content:""},n=null!==(l=null===(s=this._cachedTextInfo)||void 0===s?void 0:s.content)&&void 0!==l?l:"",h=t.content;this._currentText=t;const g=Bi.CC(n,h);if(o&&(g.firstDiffLeft-=1),h!==n&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},g)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,g.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,g.firstDiffRight)),h===n&&this.children.length>0&&(!i||this._optimizedRehydrationEnabled.check())){if(i){let n=this.children[0];for(const e of this.children)e.element&&e.element.offset>(null!==(d=null===(u=n.element)||void 0===u?void 0:u.offset)&&void 0!==d?d:0)&&(n=e);if(n.element){const i=yn(t,n.element.offset,n.element.offset+n.element.span);this._hostTilingEmitter.emitParagraphDiffEvent({paragraphNode:n,oldTextInfo:i,newTextInfo:i,minDiffBounds:{firstDiffLeft:n.element.span,firstDiffRight:0},wordCount:null!==(c=n.cachedWordCount)&&void 0!==c?c:0,deltaUnit:hn.OD.Sentence,mutationChangeType:e,invalidationRanges:void 0})}}return this._hostSettings.enableOrchestration&&(r||i)&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,t,g,!1,this._cachedWordCount,{addedNodes:[],removedNodes:[],updatedNodes:[],unreconciledContent:Array.from(this._cachedTiles.values())},e,this.specifiedLocale)),this._reconcileFormatting(t,!this.featureFlagsReader.flags.enableAttributionRangeInAddDelta),void(this._cachedTextInfo=t)}return this._reconcileState(t,g,null!=i&&i,e,null!=o&&o)}return this._resetInvalidationStateAndReturnTiles(Array.from(this._cachedTiles.values()),this._seqId)}get critiques(){return[]}get textFormattingInfo(){return this._currentText}_reconcileState(e,t,n,i,r){var o;const a=this._seqId+1,s=e.content;let l;if(this._paragraphDeltasEnabled.check())l=!1,this._cachedWordCount=0;else if(this._hostSettings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,s);l=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else l=this._reconcileWordCount(t,s);const u=this._paragraphNodesBuilder.updateParagraphNodes(this,this._cachedTextInfo,e,t,a,i,r);if(this._reconcileParagraphs(u,a),this._hostSettings.enableOrchestration&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,e,t,l,this._cachedWordCount,u,i,this.specifiedLocale)),this._reconcileFormatting(e,!this.featureFlagsReader.flags.enableAttributionRangeInAddDelta),this._cachedTextInfo=e,n||l||this._hostSettings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._hostSettings.enableOptimizedCallingPattern&&i!==p.Q0.Code&&this._tryScheduleReconcileTimer(),this._hostSettings.enableOrchestration){for(const e of u.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);if(u.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._paragraphDeltasEnabled.check())for(const e of u.removedNodes)null===(o=this.queryDetection)||void 0===o||o.handleTileRemoved(e);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,u,i,e)}return this._resetInvalidationStateAndReturnTiles(u.unreconciledContent,a)}this._tryScheduleReconcileTimer()}_reconcileFormatting(e,t){var n,i;if(this._cachedTextInfo){if(this.featureFlagsReader.flags.enableAttributionRangeExceptionInFormattedTextDeltas){const i=t&&!wn(this._cachedTextInfo.attributionRanges,e.attributionRanges);if(!wn(this._cachedTextInfo.formattedRanges,e.formattedRanges)||i){for(const t of this.children){if(!t.element)continue;const n=t.element.offset+t.element.span,r=Cn(this._cachedTextInfo,t.element.offset,n),o=Cn(e,t.element.offset,n);wn(r.formattedRanges,o.formattedRanges)&&!i||(i?this._hostTilingEmitter.emitFormattingDiffEvent(t,p.pf.ParagraphNode,{formattedRanges:o.formattedRanges,attributionRanges:o.attributionRanges}):this._hostTilingEmitter.emitFormattingDiffEvent(t,p.pf.ParagraphNode,{formattedRanges:o.formattedRanges}))}this._hostTilingEmitter.emitFormattingDiffEvent(this,p.pf.TileNode,null!==(n=e.formattedRanges)&&void 0!==n?n:[])}}else if(!wn(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){if(!t.element)continue;const n=bn(this._cachedTextInfo,t.element.offset,t.element.offset+t.element.span),i=bn(e,t.element.offset,t.element.offset+t.element.span);wn(n,i)||this._hostTilingEmitter.emitFormattingDiffEvent(t,p.pf.ParagraphNode,i)}this._hostTilingEmitter.emitFormattingDiffEvent(this,p.pf.TileNode,null!==(i=e.formattedRanges)&&void 0!==i?i:[])}if(!wn(this._cachedTextInfo.objectReferences,e.objectReferences)||!Sn(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of Tn)"objectReferences"!==e&&delete t[e];for(const e of this.children)e.element&&this._hostTilingEmitter.emitFormattingDiffEvent(e,p.pf.ParagraphNode,t);this._hostTilingEmitter.emitFormattingDiffEvent(this,p.pf.TileNode,t)}}}_reconcileWordCount(e,t){const n=this._wordCountDetector.getWordCount(t);let i=0;e.firstDiffLeft<=t.length&&(i=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const r=n>0&&(n!==this._cachedWordCount||i>1);return this._cachedWordCount=n,r}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,n]of this._cachedTiles)this._proofingDom.findParagraphNode(e)?n.header.seqId=t.toString():this._cachedTiles.delete(e);e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._hostSettings.enableOptimizedCallingPattern||this._clearReconcileTimer(),this._invalidationDiffBounds=void 0,this._seqId=t,e}_tryScheduleReconcileTimer(){return!(!this._settings.enableTileNodeAutoReconciliation||!this._invalidationDiffBounds||(this._clearReconcileTimer(),this._reconcileCritiqueTimer=window.setTimeout((()=>{this._logger.debug(562057757,"Dirty range timer has fired."),this._nodePoller.pollNodes(g.G.NewData,[this],p.Q0.Code,void 0,!0),this._clearReconcileTimer()}),this._settings.reconcileTileNodeTime),0))}_clearReconcileTimer(){this._reconcileCritiqueTimer&&(clearTimeout(this._reconcileCritiqueTimer),this._reconcileCritiqueTimer=void 0,this._logger.debug(562057758,"Dirty range timer has been cleared."))}get eventSeqId(){return this._eventSeqId}get plainText(){var e,t;return null!==(t=null===(e=this._currentText)||void 0===e?void 0:e.content)&&void 0!==t?t:""}};cr=(0,r.__decorate)([(0,Le._)()],cr);class hr{constructor(){this.imports=[Ye]}get uniqueId(){return(0,Je.z)(507918410)}configureRootServices(e){e.bind(ht).to(ki),(e=>{e.bind(Ki).toDynamicValue((()=>()=>new qi))})(e),(e=>{e.bind(rt).toDynamicValue((e=>{const t=e.get(Vi.G),n=e.get(v.g),i=e.get(pi),r=e.get(mi),o=e.get(st.k),a=e.get(T.G),s=e.get(he.w),l=e.get(F.d),u=e.get(Ie.n),d=e.get(Ge.H),c=e.get(Ze.W),h=e.get(_i),g=e.get(ht),p=e.getAll(M.zJ),f=e.getOptional(_.J),m=e.getOptional(dt.M),y=e.get(q.c);return(e,v,_,b,C,T,S)=>{switch(e){case vt.Z.OutlineNode:return new tr(v,C,_,b,S);case vt.Z.TerminalNode:return new Ct(v,_,b,S);case vt.Z.TileNode:return new cr(t,n,i,r,o,a,s,l,u,y,d,c,h,e,v,null!=T?T:g,_,p,m,b,S,f);default:throw Error(`This factory cannot build ${vt.Z[e]}.`)}}}))})(e),(e=>{e.bind(ot).toDynamicValue((e=>{const t=e.get(Vi.G),n=e.get(he.w);return(e,i)=>new P.f(t,n,e,i)}))})(e),(e=>{e.bind(ct).toDynamicValue((e=>{const t=e.get(m.K),n=e.get(ot),i=e.get(di),r=e.get(st.k),o=e.get(Ie.n),a=e.get(q.c),s=e.get(_i),l=e.get(Si),u=e.get(Ge.H),d=e.get(v.g),c=e.getOptional(dt.M);return(e,h)=>new ki(t,n,i,r,o,a,s,l,u,d,c,e,h)}))})(e),(e=>{e.bind(Gi).toDynamicValue((()=>e=>new Qi(e)))})(e),(e=>{e.bind(Yi).toDynamicValue((()=>()=>{const t=e.get(Ie.n),n=e.get(st.k),i=e.get(q.c),r=e.get(Ge.H),o=e.get(m.K),a=e.get(v.g),s=new j.I(o.getCachedEntry(f.l.ProofingLanguages).storeEntryValue),l=Object.assign(Object.assign(Object.assign(Object.assign({},i.flags),n),t),{paragraphDeltasEnabled:r.check()});return new dr(l,s,a)}))})(e),e.bind(yi).to(un),e.bind(mt.j).to(zi),e.bind(wi).to(Mi),e.bind(Ai).to(Di),e.bind(Ei).toTransient(xi),e.bind(Ci).to(Ti),e.bind(_i).to(kn),e.bind(Si).to(Ri),e.bind(he.w).to(ji),e.bind(We.S).toExisting(he.w),e.bind(We.S).to(Hi),e.bind(Ii.b).to(Li.o),e.bind(bi).to(Ni),e.bind(On).to(si),e.bind(Bn).to(li),e.bind(Ln).to(ui),e.bind(Rn).to(ui),e.bind(di).to(ci),e.bind(pi).to(fi.a),e.bind(mi).to(vi)}}var gr=n(70578),pr=n(17677);let fr=class{constructor(e,t,n,i){var r,o;this._featureFlagReader=e,this.hostSettings=t,this._logger=n,this._oaMetric=i,this._isNextDeltaProgrammaticallyInserted=!1,this._augloopReconnectionOccurring=!1,this._unsupportedEntities=[],this.registeredQueryDetectionStartChars=[],this.FORBIDDEN_CHARS=['"',"<",">","/","\\","|"],this.PUNCTUATION_CHARS=[",",".",":","!","?","'",";","&"],this.ALLOWED_PREVIOUS_CHARS=["(","/","+","×"],this.registerQueryDetectionStartCharacter=e=>{console.debug(`Registering query detection start character: ${e}`),this.registeredQueryDetectionStartChars.includes(e)||this.registeredQueryDetectionStartChars.push(e)},this.getRegisteredTriggers=()=>this.registeredQueryDetectionStartChars,this.unregisterQueryDetectionStartCharacter=e=>{const t=this.registeredQueryDetectionStartChars.indexOf(e);t>-1&&this.registeredQueryDetectionStartChars.splice(t,1)},this.handleAugloopReconnection=e=>{this._augloopReconnectionOccurring=!0;try{e()}finally{this._augloopReconnectionOccurring=!1}},this.handleTileRemoved=e=>{var t,n;return(null===(t=this._currentQuery)||void 0===t?void 0:t.tileId)===e&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),null===(n=this._currentQuery)||void 0===n?void 0:n.queryRange},this.getCurrentQuery=()=>this._currentQuery,this.getIsSameWordQueriesDismissed=()=>{var e;return null!==(e=this._isCurrentQueryDismissed)&&void 0!==e&&e},this.updateCurrentQuery=e=>{var t,n,i,r,o,a,s;if(this._currentQuery=e,this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1),!(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.e2eMetric))return;const l=this._currentQuery.queryRange.length===(null!==(i=null===(n=this._currentQuery.queryRange.prefix)||void 0===n?void 0:n.length)&&void 0!==i?i:1),u={logicalId:this._currentQuery.additionalData.logicalId||"",conversationId:this._currentQuery.additionalData.conversationId||"",clientCorrelationId:this._clientCorrelationId||"",triggerCharacter:null!==(r=this._currentQuery.queryRange.prefix)&&void 0!==r?r:"@",isEmptyQuery:l,queryLength:this._currentQuery.queryRange.length-(null!==(a=null===(o=this._currentQuery.queryRange.prefix)||void 0===o?void 0:o.length)&&void 0!==a?a:1)};null===(s=this._oaMetric)||void 0===s||s.startEntry(this._currentQuery.additionalData.logicalId,u)},this.getCurrentQueryTileId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.tileId},this.getCurrentQueryLogicalId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.logicalId},this.getCurrentQueryConversationId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.conversationId},this.getCurrentQueryCorrelationKeys=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData},this.getPreviousQueryCorrelationKeys=()=>this._previousData,this.removeDetectedQuery=()=>{var e;this._previousData=null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData,this._currentQuery=void 0,this._currentScope=void 0,this._unsupportedEntities=[]},this.setCurrentQueryRange=(e,t,n,i,r)=>{var o,a;return this.updateCurrentQuery({tileId:e,queryRange:t,additionalData:{triggerCharacter:r,scopeInfo:i,logicalId:this.registerNewLogicalId(),conversationId:n?(null===(o=this._currentQuery)||void 0===o?void 0:o.additionalData.conversationId)||"":(new gr.L).generate(),clientCorrelationId:this._clientCorrelationId||""}}),null===(a=this._currentQuery)||void 0===a?void 0:a.additionalData},this.getCurrentScope=()=>this._currentScope,this.setCurrentScope=(e,t=!0)=>{this._currentScope=e,this._currentQuery&&t&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope})}))},this.getUnsupportedEntities=()=>this._unsupportedEntities,this.setUnsupportedEntities=e=>{this._unsupportedEntities=e,this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{unsupportedEntities:this._unsupportedEntities})}))},this.setClientCorrelationId=e=>{this._clientCorrelationId=e},this.setNextDeltaProgramaticallyInserted=e=>{this._isNextDeltaProgrammaticallyInserted=!0,this._programmaticallyInsertedSource=e},this.resetNextDeltaProgramaticallyInserted=()=>{this._isNextDeltaProgrammaticallyInserted=!1,this._programmaticallyInsertedSource=void 0},this.dismissCurrentQuery=(e,t,n,i)=>{var r,o,a;this._currentQuery&&(e&&(null===(r=this._logger)||void 0===r||r.logActivity(null!=n?n:"OACurrentQueryDismiss",void 0,[...null!=i?i:[],...(0,K.W)(["interaction",null!=t?t:"escape"],["conversationId",null!==(o=this.getCurrentQueryConversationId())&&void 0!==o?o:""],["logicalId",null!==(a=this.getCurrentQueryLogicalId())&&void 0!==a?a:""])])),this._isCurrentQueryDismissed=!0)},this.handleTileDelta=(e,t,n,i,r)=>{var o,a,s,l,u,d,c,h,g,p,f;const{deltaType:m,unit:v,length:y,content:_,position:b}=t;return m!==hn.WI.Update||0!==y||_?void 0===y||void 0===b?this.getIfLocal(i)?{queryRange:null===(s=this._currentQuery)||void 0===s?void 0:s.queryRange,additionalData:null===(l=this._currentQuery)||void 0===l?void 0:l.additionalData}:{queryRange:void 0,additionalData:void 0}:v!==hn.OD.Sentence&&v!==hn.OD.Paragraph||m!==hn.WI.Add&&m!==hn.WI.Update||!((null!==(d=null===(u=null==_?void 0:_.trim())||void 0===u?void 0:u.length)&&void 0!==d?d:0)>1||0===(null===(c=null==_?void 0:_.trim())||void 0===c?void 0:c.length))||1===(null==_?void 0:_.length)&&Bi.xC(_.charCodeAt(0))?this.getIfLocal(i)?(this.handleLocalTileDelta(e,b,y,m,_,n,r),{queryRange:null===(p=this._currentQuery)||void 0===p?void 0:p.queryRange,additionalData:null===(f=this._currentQuery)||void 0===f?void 0:f.additionalData}):(this.handleRemoteTileDelta(e,b,y,m,_),{queryRange:void 0,additionalData:void 0}):(this._currentQuery&&this._currentQuery.tileId===e&&m===hn.WI.Update&&_&&r&&_.length!==r.length&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),this.getIfLocal(i)?{queryRange:null===(h=this._currentQuery)||void 0===h?void 0:h.queryRange,additionalData:null===(g=this._currentQuery)||void 0===g?void 0:g.additionalData}:{queryRange:void 0,additionalData:void 0}):this.getIfLocal(i)?{queryRange:null===(o=this._currentQuery)||void 0===o?void 0:o.queryRange,additionalData:null===(a=this._currentQuery)||void 0===a?void 0:a.additionalData}:{queryRange:void 0,additionalData:void 0}},this.getIfLocal=e=>this._featureFlagReader.flags.enableQueryOnlyOnLocalChange?e===p.Q0.Local:e===p.Q0.Local||e===p.Q0.Code,this.logQueryDetected=()=>{var e,t,n;null===(e=this._logger)||void 0===e||e.logActivity("OAQueryDetected",void 0,(0,K.W)(["conversationId",null!==(t=this.getCurrentQueryConversationId())&&void 0!==t?t:""],["logicalId",null!==(n=this.getCurrentQueryLogicalId())&&void 0!==n?n:""]))},this.handleLocalTileDelta=(e,t,n,i,r,o,a)=>{var s,l,u;const d=this._isNextDeltaProgrammaticallyInserted,c=this._programmaticallyInsertedSource;if(!this._augloopReconnectionOccurring)if(this._currentQuery){if(this._currentQuery.tileId!==e)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const{isWithinSearchQuery:h,updatedEditedPosition:g}=this.isWithinSearchQuery(i,t,n,r,null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,o,a);if(!h)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(r&&void 0!==this.FORBIDDEN_CHARS.find((e=>r.includes(e))))return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(t=g,i===hn.WI.Add&&void 0!==r){const e=o.substring(this._currentQuery.queryRange.start,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length);if(1===r.length&&this.isWhitespace(r.charCodeAt(0))&&this._currentQuery.queryRange.prefix){let t=!0;for(let n=0;n<e.length;n++)if(e.charAt(n)!==this._currentQuery.queryRange.prefix){t=!1;break}if(t)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}this._currentQuery.queryRange.length+=r.length}else if(i===hn.WI.Update&&void 0!==r&&n){const e=t-this._currentQuery.queryRange.start,i=this._currentQuery.queryRange.length-e,o=Math.min(n,i);if(this._currentQuery.queryRange.length+=r.length,this._currentQuery.queryRange.length-=o,0===this._currentQuery.queryRange.length)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}else if(i===hn.WI.Delete){const e=t-this._currentQuery.queryRange.start,i=Math.min(this._currentQuery.queryRange.length-e,n);this._currentQuery.queryRange.length-=i}if((this._currentQuery.queryRange.length<(null!==(u=null===(l=this._currentQuery.queryRange.prefix)||void 0===l?void 0:l.length)&&void 0!==u?u:1)||o.substring(this._currentQuery.queryRange.start+1,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length).trim().split(" ").length>4)&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),this._currentQuery&&this._currentQuery.queryRange.length>this.maxQueryLength)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope,clientCorrelationId:this._clientCorrelationId||"",isUserInsertion:!d,source:c})}))}else if((i===hn.WI.Add||i===hn.WI.Update)&&r){const n=r,i=r.trim();if(this.registeredQueryDetectionStartChars.includes(i)){const r=n.indexOf(i),a=o[t+r-1];if(a&&!(this.isWhitespace(a.charCodeAt(0),!1)||this.ALLOWED_PREVIOUS_CHARS.includes(a)&&!this.registeredQueryDetectionStartChars.includes(a)))return;this.updateCurrentQuery({tileId:e,queryRange:{start:t+r,length:1,prefix:i},additionalData:{triggerCharacter:i,logicalId:this.registerNewLogicalId(),conversationId:(new gr.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!d,source:c}}),this.logQueryDetected()}else if(r.length>0){for(let e=0;e<r.length;e++)Bi.Yv(r.charCodeAt(e))&&this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1);for(let e=0;e<r.length;e++)if(Bi.Yv(r.charCodeAt(e))||this.FORBIDDEN_CHARS.includes(r.charAt(e)))return;if(this.PUNCTUATION_CHARS.includes(r))return;const n=this.getWordBeforeChange(o,t+r.length-1);if(this.registeredQueryDetectionStartChars.includes(n[0])){if(n.indexOf(n[0],1)>0)return;if(this._isCurrentQueryDismissed)return;if(n.length>this.maxQueryLength)return;this.updateCurrentQuery({tileId:e,queryRange:{start:t-n.length+r.length,length:n.length,prefix:n[0]},additionalData:{triggerCharacter:n[0],logicalId:this.registerNewLogicalId(),conversationId:(new gr.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!d,source:c}}),this.logQueryDetected()}}}},this.handleRemoteTileDelta=(e,t,n,i,r)=>{var o,a;if(!this._currentQuery)return;if(e!==this._currentQuery.tileId)return;if(t>=this._currentQuery.queryRange.start+this._currentQuery.queryRange.length)return;if(t>this._currentQuery.queryRange.start)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const s=i===hn.WI.Add?null!==(o=null==r?void 0:r.length)&&void 0!==o?o:0:i===hn.WI.Delete?-1*n:i===hn.WI.Update?(null!==(a=null==r?void 0:r.length)&&void 0!==a?a:0)-n:0;this._currentQuery.queryRange.start+=s},this.isWithinSearchQuery=(e,t,n,i,r,o,a)=>{let s=t;if(!this._currentQuery)return{isWithinSearchQuery:!1,updatedEditedPosition:s};if(""===this._currentQuery.queryRange.prefix)return{isWithinSearchQuery:!0,updatedEditedPosition:s};if(s<this._currentQuery.queryRange.start)return{isWithinSearchQuery:!1,updatedEditedPosition:s};if(s===this._currentQuery.queryRange.start&&(e!==hn.WI.Update||i!==this._currentQuery.queryRange.prefix))return{isWithinSearchQuery:!1,updatedEditedPosition:s};if(e===hn.WI.Add&&void 0!==i&&1===r&&s>0){const e=o.charAt(s-1);(e===i||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(i.charCodeAt(0)))&&(s-=1)}if(e===hn.WI.Delete&&1===n&&a){const e=o.charAt(s-1),t=a;(e===t||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(t.charCodeAt(0)))&&(s-=1)}return s>this._currentQuery.queryRange.start+this._currentQuery.queryRange.length+(e!==hn.WI.Delete?0:-1)?{isWithinSearchQuery:!1,updatedEditedPosition:s}:{isWithinSearchQuery:!0,updatedEditedPosition:s}},this.isWhitespace=(e,t)=>8203===e||Bi.Yv(e,t),this.getWordBeforeChange=(e,t)=>{let n;for(n=t;n>=0&&!this.isWhitespace(e.charCodeAt(n));n--);return e.substring(n+1,t+1)},this.registerNewLogicalId=()=>(new gr.L).generate(),this.maxQueryLength=null!==(o=null===(r=this.hostSettings.oaSettings)||void 0===r?void 0:r.maxQueryLength)&&void 0!==o?o:300}};fr=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(q.c)),(0,r.__param)(1,(0,Me.W)(Ie.n)),(0,r.__param)(2,(0,Me.W)(v.g)),(0,r.__param)(2,(0,St.l)()),(0,r.__param)(3,(0,Me.W)(pr.u)),(0,r.__param)(3,(0,St.l)())],fr);class mr{get uniqueId(){return(0,Je.z)(507917961)}configureRootServices(e){e.bind(_.J).to(fr)}}var vr=n(63282);let yr=class extends nr.z{constructor(){super(...arguments),this.stores=new Map}setCanvasElement(e,t){this.stores.set(e,new _r(t)),this.publishEvent("stateUpdated",{stores:this.stores})}getShadowElementStore(e){return this.stores.get(e)}removeShadowElementStore(e){this.stores.delete(e),this.publishEvent("stateUpdated",{stores:this.stores})}};yr=(0,r.__decorate)([(0,Le._)()],yr);class _r extends nr.z{constructor(e){super(),this.anchor=e,this.container=void 0,this.overlay=void 0,this._updateOverlay=()=>new Promise((()=>{})),this.updateOverlay=async()=>{await this._updateOverlay()},this.setUpdateOverlay=e=>{this._updateOverlay=e,this.publishStateChange()},this.setShadowElement=(e,t)=>{this.container=e,this.overlay=t,this.publishStateChange()}}publishStateChange(){this.publishEvent("stateUpdated",{anchor:this.anchor,container:this.container,overlay:this.overlay})}}var br=n(37842),Cr=n(8676),Tr=n(95734),Sr=n(10383);const Ir=(0,br.F5)({safeWindow:Cr.A.on(ze.j)}),wr=e=>{const{safeWindow:t}=(0,br.KN)(Ir),{store:n}=e,i=n.anchor,r=Tr.useRef(!1),o=Tr.useRef(null),a=Tr.useRef(null),s=Tr.useRef({top:0,left:0}),l=Tr.useRef([]),[u,d]=Tr.useState({container:{display:"none"},overlay:{display:"none"},anchorStyle:{position:"static"}}),c=(0,Sr.uE)(i,u.overlay.paddingBottom),h=Object.assign({},u.overlay),g=()=>{const e=(0,Sr.dB)(i,a.current,s),t=(0,Sr.Cf)(i);s.current={top:e.top,left:e.left},d((()=>((()=>{const e=i.scrollLeft,t=i.scrollTop;o.current&&(o.current.scrollLeft=e,o.current.scrollTop=t)})(),{container:e,overlay:t.overlay,anchorStyle:t.anchor}))),n.setShadowElement(a.current,o.current)},p=()=>{var e;e=g,t.requestAnimationFrame((()=>{r.current||e()}))},f=()=>new Promise((e=>{p(),l.current.push(e)}));return Tr.useEffect((()=>(p(),n.setUpdateOverlay(f),()=>{r.current=!0})),[]),Tr.useEffect((()=>{for(const e of l.current)e();l.current=[]}),[u]),i.isConnected?Tr.createElement("div",{ref:a,style:u.container},Tr.createElement("div",{style:h,className:"hc-noadjust"},Tr.createElement("div",{style:c,ref:o},Tr.createElement("span",{"aria-hidden":"true"},i.value)))):null};var Er=n(38883),xr=n(13956);const Ar=(0,br.F5)({store:Cr.A.on(pt.S)}),Dr=()=>{const{store:e}=(0,br.KN)(Ar),[t,n]=Tr.useState(e.stores);return Tr.useEffect((()=>{const t=e=>{n(e.stores)};return e.subscribe("stateUpdated",t),()=>{e.unsubscribe("stateUpdated",t)}}),[e]),Tr.createElement(Tr.Fragment,null,Array.from(t.values()).map((e=>{var t;return Er.createPortal(Tr.createElement("editor-shadow",{style:{overflow:"auto"}},Tr.createElement(Tr.Fragment,null,Tr.createElement("style",null,"\n  @media print {\n    .ms-editor-shadow-container {\n      display:none !important;\n    }\n  }\n  .ms-editor-shadow-container {\n    all: initial;\n  }"),Tr.createElement(xr.Ay.div,{className:"ms-editor-shadow-container"},Tr.createElement(wr,{store:e})))),null!==(t=e.anchor.parentElement)&&void 0!==t?t:window.document.body)})))};class Nr{get uniqueId(){return(0,Je.z)(507918362)}configureRootServices(e){e.bind(pt.S).to(yr),e.bind(vr.i).toValue(Dr)}}var Fr=n(68023),Pr=n(7044),kr=n(36747),Or=n(17954),Br=n(89416),Rr=n(63666),Lr=n(70262),Mr=function(e){var t=e.className,n=Tr.useState((function(){return(0,Br.O)()}))[0],i=e.id,o=void 0===i?n:i,a=Tr.useRef({hostId:o,rootRef:Tr.useRef(null),notifyLayersChanged:function(){}});return Tr.useImperativeHandle(e.componentRef,(function(){return a.current})),Tr.useEffect((function(){(0,Lr.$K)(o,a.current),(0,Lr.K3)(o)}),[]),(0,Or.i)((function(){(0,Lr.a$)(o,a.current),(0,Lr.K3)(o)})),Tr.createElement("div",(0,r.__assign)({},e,{className:(0,Rr.A)("ms-LayerHost",t),ref:a.current.rootRef}))};n(29308);var qr=n(75901),Ur=Tr.createContext(void 0).Provider;function Wr(e,t){var n;const i=e;var r;return Boolean((null==i||null===(n=i.ownerDocument)||void 0===n?void 0:n.defaultView)&&i instanceof i.ownerDocument.defaultView[null!==(r=null==t?void 0:t.constructorName)&&void 0!==r?r:"HTMLElement"])}var jr=n(96406);const zr="data-fui-focus-visible";function Hr(e,t){if(Vr(e))return()=>{};const n={current:void 0},i=(0,jr.SQ)(t);function r(e){i.isNavigatingWithKeyboard()&&Wr(e)&&(n.current=e,e.setAttribute(zr,""))}function o(){n.current&&(n.current.removeAttribute(zr),n.current=void 0)}i.subscribe((e=>{e||o()}));const a=e=>{o(),r(e.composedPath()[0])},s=t=>{(!t.relatedTarget||Wr(t.relatedTarget)&&!e.contains(t.relatedTarget))&&o()};return e.addEventListener(jr.Oy,a),e.addEventListener("focusout",s),e.focusVisible=!0,e.contains(t.document.activeElement)&&r(t.document.activeElement),()=>{o(),e.removeEventListener(jr.Oy,a),e.removeEventListener("focusout",s),delete e.focusVisible,(0,jr.bd)(i)}}function Vr(e){return!!e&&(!!e.focusVisible||Vr(null==e?void 0:e.parentElement))}const Gr=new RegExp("([^\\s]*fui-FluentProvider\\w+)","g"),Qr=e=>{const{children:t}=e,n=function(){const e=(0,qr.q)();return Tr.useMemo((()=>{var t;return null!==(t=e.match(Gr))&&void 0!==t?t:[]}),[e])}(),i=Tr.useCallback((e=>{let t=()=>{};return e.classList.add(...n),e.ownerDocument.defaultView&&(t=Hr(e,e.ownerDocument.defaultView)),()=>{e.classList.remove(...n),t()}}),[n]);return Tr.createElement(Ur,{value:i},t)};var Kr=n(63503);const $r=(0,br.F5)({editorCanvasInjectableComponents:Cr.A.onAll(vr.i).optional(),guidGenerator:Cr.A.on(Vi.G),languageScriptDirectionDetector:Cr.A.on(kr.iw).optional(),targetWindowRef:Cr.A.on(z.sh),hostSettings:Cr.A.on(Ie.n),themeStore:Cr.A.on(k.YQ)}),Zr=()=>{const{editorCanvasInjectableComponents:e,guidGenerator:t,hostSettings:n,languageScriptDirectionDetector:i,targetWindowRef:r,themeStore:o}=(0,br.KN)($r),a=Tr.useRef(t.generate()),[s,l]=Tr.useState(null==i?void 0:i.uxLanguageDir),[u,d]=Tr.useState(o.getFluentActiveTheme());Tr.useEffect((()=>{if(i){const e=e=>{l(e.uxLanguageDir)};return i.subscribe("stateUpdated",e),()=>{i.unsubscribe("stateUpdated",e)}}return()=>{}}),[i]),Tr.useEffect((()=>{const e=()=>{d(o.getFluentActiveTheme())};return o.subscribe("currentThemeUpdated",e),o.subscribe("defaultThemeUpdated",e),o.subscribe("fluentThemesUpdated",e),()=>{o.unsubscribe("currentThemeUpdated",e),o.unsubscribe("defaultThemeUpdated",e),o.unsubscribe("fluentThemesUpdated",e)}}),[o]);const c=()=>{const t=null==e?void 0:e.map(((e,t)=>Tr.createElement(e,{key:"injectableComponent"+t})));return Tr.createElement(Pr.q,{theme:u},Tr.createElement(k.O1.Provider,{value:!!n.useFluentV9},Tr.createElement(Qr,null,t)))},h=r.deref();return Tr.createElement("div",{dir:s,style:{all:"initial"}},Tr.createElement(Kr.IF,{window:null!=h?h:window},n.renderWithinShadowDOM||!n.useFluentV9&&n.renderWithinSeparateLayer?(()=>{var e;return Tr.createElement(Tr.Fragment,null,Tr.createElement(Mr,{id:a.current,style:{position:"fixed",zIndex:null!==(e=n.editorCardZIndex)&&void 0!==e?e:1e6,inset:0,visibility:"hidden"}}),Tr.createElement(Fr.d.Provider,{value:a.current},c()))})():c()))};var Jr=n(94940);class Yr extends Tr.Component{constructor(e){super(e),this.retryTimer=0,this.labelErrorStyle={display:"none"},this.tryRecover=()=>{var e;this.props.maxRecoveryRetry>(this.state.retryNumber||0)&&(window.clearTimeout(this.retryTimer),this.retryTimer=window.setTimeout((()=>{var e;const t=(null!==(e=this.state.retryNumber)&&void 0!==e?e:0)+1;this.setState({hasError:!1,retryNumber:t})}),1e3*(null!==(e=this.state.retryNumber)&&void 0!==e?e:1)))},this.state={hasError:!1,retryNumber:0}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){var n;const{logger:i,errorEventName:r,errorMessage:o}=this.props;Jr.R.logUnhandledError(i,{error:e,errorInfo:t,retryCount:null!==(n=this.state.retryNumber)&&void 0!==n?n:0},r,o)}componentWillUnmount(){window.clearTimeout(this.retryTimer)}componentDidUpdate(){this.state.hasError&&this.tryRecover()}render(){return this.state.hasError?Tr.createElement("div",{"aria-hidden":"true",style:this.labelErrorStyle,className:"ms-editor-rendering-error"},`${this.state.retryNumber}/${this.props.maxRecoveryRetry}`):this.props.children}}var Xr=n(39584);class eo extends Q.O{constructor(e,t,n){super(e),this.logger=t,this.derefFailedLogMessage=n}deref(){const e=super.deref();return e||this.logger.error(508143266,this.derefFailedLogMessage,new Error(this.derefFailedLogMessage)),e}}const to="__reactEvents";class no{constructor(e){this.element=new Q.O(e),this.replacedElements=[],this.ownerDocument=new Q.O(e.ownerDocument)}replaceListener(e){var t;if(!e)return;const n=new Q.O(e),i=e.addEventListener,r=new Q.O(i),o={},a=[];for(const t in e)t.startsWith(to)&&a.push(t);e.addEventListener=(e,t,i)=>{const a=r.deref(),s=n.deref();a&&s&&(e in o||(o[e]=[]),o[e].push({listener:t,options:i}),a.apply(s,[e,t,i]))},null===(t=this.replacedElements)||void 0===t||t.push({element:n,eventHandlers:o,restoreOriginalAddEventListener:()=>{e.addEventListener=i},existingReactEvents:a})}render(e){var t,n;const i=null===(t=this.element)||void 0===t?void 0:t.deref(),r=null===(n=this.ownerDocument)||void 0===n?void 0:n.deref();if(r&&i){this.replaceListener(i),this.replaceListener(i.firstElementChild),this.replaceListener(i.host),this.replaceListener(r),this.replaceListener(r.defaultView);try{return e()}finally{if(this.replacedElements)for(let e=this.replacedElements.length-1;e>=0;e--){const t=this.replacedElements[e],n=t.element.deref(),i=t.restoreOriginalAddEventListener;if(null==i||i(),t.restoreOriginalAddEventListener=void 0,n&&t.existingReactEvents){t.reactEventsToClear=[];for(const e in n)e.startsWith(to)&&!t.existingReactEvents.includes(e)&&t.reactEventsToClear.push(e)}t.existingReactEvents=void 0}}}}cleanup(){var e;if(!this.replacedElements||!this.ownerDocument)return;const t=this.ownerDocument.deref();for(const n of this.replacedElements){for(const i in n.eventHandlers){const r=n.element.deref();for(const o of n.eventHandlers[i])null==r||r.removeEventListener(i,o.listener,o.options),null===(e=null==t?void 0:t.defaultView)||void 0===e||e.removeEventListener(i,o.listener,o.options);if(r&&n.reactEventsToClear)for(const e of n.reactEventsToClear)r[e]=void 0}n.eventHandlers={}}this.replacedElements=void 0,this.ownerDocument=void 0,this.element=void 0}}var io=n(53756),ro=n(42727),oo=n(19635);const ao=e=>{const t=(0,oo.G)();return Tr.createElement(so,Object.assign({},e,{parentContainer:t}))};class so extends Tr.Component{constructor(e){super(e),this.state={injector:void 0}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){const e=ro.z.createContainer(this.props.parentContainer),t=new io.E(e,this.rootInjector.generateModuleKey);this.props.onConfigureInjector(t),this.setState({injector:t})}render(){const{injector:e}=this.state;return e?Tr.createElement(io.r.Provider,{value:e},this.props.children):null}}so.contextType=be.S;class lo extends Tr.Component{constructor(e){super(e),this.onConfigureInjector=e=>{e.addModule(this.props.value)},this.state={rootInjectorConfigured:!1}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){this.onConfigureInjector(this.rootInjector),this.setState({rootInjectorConfigured:!0})}render(){return this.state.rootInjectorConfigured?Tr.createElement(ao,{onConfigureInjector:this.onConfigureInjector},this.props.children):null}}lo.contextType=be.S;class uo extends Tr.PureComponent{constructor(e){var t;super(e),this.injector=null!==(t=e.injector)&&void 0!==t?t:new be.J,this.entryModule=e.entryModule}render(){return this.entryModule?Tr.createElement(be.S.Provider,{value:this.injector},Tr.createElement(lo,{value:this.entryModule},this.props.children)):Tr.createElement(be.S.Provider,{value:this.injector},this.props.children)}}var co=n(44207);function ho(e,t,n){var i,r;for(const o of e)if((!o.dataset.bindId||!t.head.querySelector(`style[data-bind-id='${o.dataset.bindId}']`))&&(null===(i=o.sheet)||void 0===i?void 0:i.cssRules.length)){const e=t.createElement("style");Array.from(o.attributes).forEach((t=>{t.nodeValue&&e.setAttribute(t.nodeName,t.nodeValue)}));const i=o.dataset.bindId||n.generate();o.dataset.bindId=i,e.dataset.bindId=i,t.head.appendChild(e);for(let t=0;t<o.sheet.cssRules.length;t++){const n=o.sheet.cssRules.item(t);n&&(null===(r=e.sheet)||void 0===r||r.insertRule(n.cssText,t))}}}function go(e,t,n,i){var r,o,a,s;const l=null!=i?i:Array.from(e.querySelectorAll(t)),u=Array.from(n.querySelectorAll(t));for(const e of u)(null===(r=e.originalElement)||void 0===r?void 0:r.isConnected)||(e.originalElement=void 0,e.remove());for(const e of l)if(null===(o=e.sheet)||void 0===o?void 0:o.cssRules.length){const t=u.find((t=>t.originalElement===e));if(null===(a=null==t?void 0:t.sheet)||void 0===a?void 0:a.cssRules.length)for(let n=t.sheet.cssRules.length;n<e.sheet.cssRules.length;n++){const i=e.sheet.cssRules.item(n);i&&t.sheet.insertRule(i.cssText,n)}else{t&&(t.originalElement=void 0,t.remove());const i=n.ownerDocument.createElement("style");i.originalElement=e;for(const t of Array.from(e.attributes))t.nodeValue&&i.setAttribute(t.nodeName,t.nodeValue);n.appendChild(i);for(let t=0;t<e.sheet.cssRules.length;t++){const n=e.sheet.cssRules.item(t);n&&(null===(s=i.sheet)||void 0===s||s.insertRule(n.cssText,t))}}}}var po=n(99120);class fo{constructor(e){var t,n,i;this.injector=e,this.render=()=>{var e,t;const n=this.injector.container.get(v.g),i=Tr.createElement(Yr,{errorEventName:Xr.s.UnhandledContentError,logger:n,maxRecoveryRetry:10,errorMessage:"Unhandled render content script error"},Tr.createElement(uo,{injector:this.injector},Tr.createElement(Zr,null))),r=null!==(t=null===(e=this.editorCardShadowRoot)||void 0===e?void 0:e.firstElementChild)&&void 0!==t?t:this.editorCard;(0,po.d)(r,i)},this.onWindowUnload=()=>{try{this.shutDown()}catch(e){}};const r=this.injector.container.get(Ie.n);this.targetDocument=null!==(t=this.injector.container.getOptional(z.jh))&&void 0!==t?t:new Q.O(document);const o=this.injector.container.getOptional(kr.iw),a=this.targetDocument.deref();a&&(this.editorCard=a.createElement("editor-card"),this.editorCard.setAttribute("style",`position:absolute;top:0px;left:0px;z-index:${null!==(n=r.editorCardZIndex)&&void 0!==n?n:"auto"};display: block !important`),o&&this.editorCard.setAttribute("dir",o.dir()),a.body.appendChild(this.editorCard),this.editorCardShadowRoot=r.renderWithinShadowDOM&&a!==document?this.editorCard.attachShadow({mode:"open"}):void 0,this.editorCardShadowRoot&&(this.editorCardShadowRoot.appendChild(document.createElement("div")),(null===(i=r.disposalSettings)||void 0===i?void 0:i.enableReactEventCleanup)&&(this.reactEventCleanup=new no(this.editorCardShadowRoot))))}async initialize(){var e;if(!this.targetDocument||!this.editorCard)return;const t=this.targetDocument.deref();if(!t)return;const n=this.injector.container.get(v.g);n.debug(520984577,"[ReactApp] Render main app view");const i=this.injector.container.get(Ie.n);if(this.editorCardShadowRoot||!i.disableStyleCopying&&t!==document){const n=this.injector.container.get(Vi.G);this.disposal=i.enablePersistentStyleCopying?function(e,t,n='style[data-merge-styles="true"], style[data-load-themed-styles="true"], style#ms-prediction-style',i=document){ho(Array.from(i.querySelectorAll(n)),e,t);const r=new MutationObserver((r=>{const o=[],a=Array.from(i.querySelectorAll(n));for(const e of r){const t=Array.from(e.addedNodes).filter((e=>(0,at.C)(e,"HTMLStyleElement")));for(const e of t){const t=a.find((t=>t.isSameNode(e)));t&&o.push(t)}}o.length&&ho(o,e,t)}));r.observe(i.head,{childList:!0,subtree:!0});const o=co.nr.getInstance().onInsertRule((()=>{!function(e,t){var n,i;if(e.length)for(const r of e){const e=t.head.querySelector(`style[data-bind-id="${r.dataset.bindId}"]`);if((null===(n=r.sheet)||void 0===n?void 0:n.cssRules.length)&&(null===(i=null==e?void 0:e.sheet)||void 0===i?void 0:i.cssRules.length))for(let t=e.sheet.cssRules.length;t<r.sheet.cssRules.length;t++){const n=r.sheet.cssRules.item(t);n&&e.sheet.insertRule(n.cssText,t)}}}(Array.from(i.querySelectorAll("style[data-bind-id]")),e)}));return()=>{r.disconnect(),o()}}(t,n):function(e,t='style[data-merge-styles="true"], style[data-make-styles-bucket], style[data-load-themed-styles="true"], style#ms-prediction-style',n=document){go(n,t,e);const i=new MutationObserver((i=>{const r=[];for(const e of i)r.push(...Array.from(e.addedNodes).concat(Array.from(e.removedNodes)).concat(Array.from([e.target])).map((e=>{var t;return"STYLE"===e.nodeName?e:"STYLE"===(null===(t=e.parentElement)||void 0===t?void 0:t.nodeName)?e.parentElement:void 0})).filter((e=>!!e)));r.length&&go(n,t,e,r)})),r=co.nr.getInstance().onInsertRule((()=>{go(n,t,e)}));return i.observe(n.head,{childList:!0,subtree:!0,attributes:!0}),()=>{r(),i.disconnect();const n=Array.from(e.querySelectorAll(t));for(const e of n)e.originalElement&&(e.originalElement=void 0,e.remove());for(const t of Array.from(e.childNodes))t.originalElement&&(t.originalElement=void 0,t.remove())}}(null!==(e=this.editorCardShadowRoot)&&void 0!==e?e:t.head)}window.frameElement&&(this.windowEventListener=new U.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnload,{once:!0})),this.injector.container.bind(z.q4).toValue(new eo(this.editorCard,n,"Target render element ref is unavailable")),this.reactEventCleanup?this.reactEventCleanup.render(this.render):this.render()}shutDown(){var e,t,n,i,r,o;try{null===(e=this.disposal)||void 0===e||e.call(this)}catch(e){}if(this.editorCard)try{Er.unmountComponentAtNode(null!==(n=null===(t=this.editorCardShadowRoot)||void 0===t?void 0:t.firstElementChild)&&void 0!==n?n:this.editorCard)}catch(e){}null===(i=this.reactEventCleanup)||void 0===i||i.cleanup(),this.reactEventCleanup=void 0,null===(r=this.windowEventListener)||void 0===r||r.removeAllListeners(),this.windowEventListener=void 0,this.disposal=void 0,null===(o=this.editorCard)||void 0===o||o.remove(),this.editorCard=void 0,this.editorCardShadowRoot=void 0,this.targetDocument=void 0}}let mo=class{constructor(e){this._injector=e,this._initialized=!1,this._shutDown=!1}async initializeComponent(){if(this._initialized)return;this._initialized=!0;const e=this._injector.container.getOptional(Ee);if(e){const t=e.map((e=>e())),n=await Promise.all(t);for(const e of n)if(Array.isArray(e))for(const t of e)this._injector.addModule(t);else this._injector.addModule(e);await this._injector.container.get(H.V).recheckRegistrables(this._injector.container)}this._shutDown||(this.reactApp=await this.loadReactApp(),this._shutDown?this.reactApp.shutDown():await this.reactApp.initialize())}shutDown(){var e;this._shutDown=!0,null===(e=this.reactApp)||void 0===e||e.shutDown(),this.reactApp=void 0}};mo=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(be.J))],mo);let vo=class extends mo{async loadReactApp(){return new fo(this._injector)}};vo=(0,r.__decorate)([(0,Le._)()],vo);class yo{constructor(){this.imports=[]}get uniqueId(){return(0,Je.z)(507918243)}configureRootServices(e){e.bind(_e).to(vo)}}var _o=n(97105),bo=n(61137);class Co{constructor(){this.imports=[bo.N,_o.J]}get uniqueId(){return(0,Je.z)(50786e4)}configureRootServices(e){}}let To=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map,this._ignoreAllHandlerMap=new Map,this._disableHandlerMap=new Map}handleApplyFlag(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyFlag(e,t,n,i){const r=this._applyHandlerMap.get(t.typeId);return!!r&&r(e,t,n,i)}handleIgnoreFlag(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreFlag(e,t){const n=this._ignoreHandlerMap.get(t.typeId);return!!n&&n(e,t)}handleIgnoreAllOfFlag(e,t){return this._ignoreAllHandlerMap.set(e,t),()=>this._ignoreAllHandlerMap.delete(e)}onIgnoreAllOfFlag(e,t){const n=this._ignoreAllHandlerMap.get(t.typeId);return!!n&&n(e,t)}handleDisableFlag(e,t){return this._disableHandlerMap.set(e,t),()=>this._disableHandlerMap.delete(e)}onDisableFlag(e,t){const n=this._disableHandlerMap.get(t.typeId);return!!n&&n(e,t)}};To=(0,r.__decorate)([(0,Le._)()],To);var So=n(41887);(0,l.f)("IEditorCritiqueGroups");const Io=(0,l.f)("ICIQFlagEditorCategories");function wo(e,t){return t?t.OnCanvasCalloutStrings[e]:(0,xe.$)().getString("OnCanvasCalloutStrings",e)}const Eo=Tr.createContext(void 0),xo={};Eo.Provider;var Ao=n(30513),Do=n(29944);const No=(0,Ao.X)({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in",ycbfsm:"fg4l7m0"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);transform:scaleX(-1);}"],t:["@media (forced-colors: active){.fg4l7m0{forced-color-adjust:auto;}}"]}),Fo=(e,t)=>{const{title:n,primaryFill:i="currentColor",...r}=e,o={...r,title:void 0,fill:i},a=No(),s=Tr.useContext(Eo)?Tr.useContext(Eo):xo;return o.className=(0,Do.z)(a.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==s?void 0:s.textDirection)&&a.rtl,o.className),n&&(o["aria-label"]=n),o["aria-label"]||o["aria-labelledby"]?o.role="img":o["aria-hidden"]=!0,o},Po=(e,t,n,i)=>{const r="1em"===t?"20":t,o=Tr.forwardRef(((e,o)=>{const a={...Fo(e,{flipInRtl:null==i?void 0:i.flipInRtl}),ref:o,width:t,height:t,viewBox:`0 0 ${r} ${r}`,xmlns:"http://www.w3.org/2000/svg"};return Tr.createElement("svg",a,...n.map((e=>Tr.createElement("path",{d:e,fill:a.fill}))))}));return o.displayName=e,o},ko=Po("CalendarDate20Filled","20",["M17 7v7.5a2.5 2.5 0 0 1-2.34 2.5H5.5A2.5 2.5 0 0 1 3 14.66V7h14Zm-5.48 1.23c-.53 0-.96.15-1.27.43-.31.28-.47.67-.47 1.15 0 .28.07.53.21.75.15.21.34.39.58.51-.29.13-.51.32-.67.56-.17.24-.25.51-.25.82 0 .5.17.9.51 1.19a2 2 0 0 0 1.36.44 2 2 0 0 0 1.35-.44c.34-.3.51-.7.51-1.2 0-.3-.08-.56-.24-.8a1.62 1.62 0 0 0-.69-.57c.25-.12.45-.3.59-.51.14-.22.21-.47.21-.75 0-.48-.15-.87-.46-1.15a1.82 1.82 0 0 0-1.27-.43ZM8.5 8.3h-.13l-2.21.82v.8l1.4-.48V14h.94V8.3Zm3.01 3.17c.28 0 .5.09.67.26.17.17.25.4.25.68 0 .3-.08.52-.24.68a.9.9 0 0 1-.67.24.9.9 0 0 1-.67-.25.91.91 0 0 1-.25-.67c0-.28.09-.5.25-.68a.88.88 0 0 1 .66-.26Zm0-2.46c.25 0 .44.08.58.24.15.16.22.36.22.6 0 .27-.07.48-.21.63a.75.75 0 0 1-.58.23.75.75 0 0 1-.58-.23.88.88 0 0 1-.2-.62c0-.27.06-.47.2-.63a.74.74 0 0 1 .58-.22Zm2.99-6A2.5 2.5 0 0 1 17 5.34V6H3v-.5A2.5 2.5 0 0 1 5.34 3h9.16Z"]),Oo=Po("CalendarDate20Regular","20",["M14.5 3A2.5 2.5 0 0 1 17 5.34v9.16a2.5 2.5 0 0 1-2.34 2.5H5.5A2.5 2.5 0 0 1 3 14.66V5.5A2.5 2.5 0 0 1 5.34 3h9.16ZM16 7H4v7.5c0 .78.6 1.42 1.36 1.5h9.14c.78 0 1.42-.6 1.5-1.36V7Zm-4.48 1.23c.53 0 .95.15 1.27.43.3.28.46.67.46 1.15 0 .28-.07.53-.21.75-.14.21-.34.39-.59.51.3.14.53.33.69.57.16.24.24.5.24.8 0 .5-.17.9-.5 1.2a2 2 0 0 1-1.36.44 2 2 0 0 1-1.36-.44 1.5 1.5 0 0 1-.5-1.2c0-.3.07-.57.24-.81.16-.24.38-.43.67-.56-.24-.12-.43-.3-.58-.51a1.33 1.33 0 0 1-.2-.75c0-.48.15-.87.46-1.15.31-.28.74-.43 1.27-.43ZM8.5 8.3V14h-.95V9.43l-1.4.48v-.8l2.22-.82h.13Zm3.01 3.17c-.27 0-.5.09-.66.26a.94.94 0 0 0-.25.68c0 .28.08.5.25.67a.9.9 0 0 0 .67.25.9.9 0 0 0 .67-.24.92.92 0 0 0 .24-.68c0-.28-.08-.5-.25-.68a.89.89 0 0 0-.67-.26Zm0-2.46a.74.74 0 0 0-.57.22.88.88 0 0 0-.2.63c0 .26.06.47.2.62.15.15.34.23.58.23.24 0 .43-.08.58-.23a.88.88 0 0 0 .2-.62.88.88 0 0 0-.2-.61.74.74 0 0 0-.58-.24Zm2.99-5h-9c-.78 0-1.42.6-1.5 1.36V6h12v-.5c0-.78-.6-1.42-1.36-1.5h-.14Z"]);var Bo=n(91752),Ro=n(38716),Lo=n(21077),Mo=n(26878),qo=n(48574),Uo=n(26017),Wo=n(44332);let jo=class{constructor(e,t,n,i,r,o,a,s){this._hostEmitters=e,this._hostSettings=t,this._proofingDom=n,this._logger=i,this._critiqueStore=r,this._disableCritiqueHandler=o,this._instrumentationProcessor=a,this._applyFlagHandler=s,this._annotationMap=new Map,this._isDisabled=!1,this.shutDownCallbacks=[],this.ignoredStrings=[],this.shutDown=()=>{for(const e of this.shutDownCallbacks)e();this.flagHandlerShutdown()},this.getFlagData=e=>this._annotationMap.get(e),this.onIgnoreAllOfFlag=(e,t)=>{},this.removeFlag=(e,t)=>{const n=this._annotationMap.get(t);if(!n)return;const i=this.getCommonCritiqueById(n.critique.annotationId);i&&i.isIgnored||(this.emitEvent(g.G.RemoveData,[n.critique],n.critique.nodeId,e),this._annotationMap.delete(t))},this.onHostModelCritiques=e=>{for(const t of e.message.data.critiqueIdsRemoved)this._annotationMap.delete(t)},this.getCommonCritiqueById=e=>{let t;for(const n of this._critiqueStore.getAllCritiques())for(const i of n.critiques)i.annotationId===e&&(t=i);return t},this.onApplyFlag_Internal=(e,t,n,i)=>{if(!t.annotationId)return!0;const r=this._annotationMap.get(t.annotationId);if(r){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,P.l)(e))return this._logger.error(508146688,"Unable to find paragraph node while applying flag"),!1;this.onApplyFlag(e,t,n,i),this._annotationMap.delete(t.annotationId),this.emitEvent(g.G.RemoveData,[r.critique],r.critique.nodeId),this._instrumentationProcessor.process({critique:(0,ye.toJS)(t),eventId:pn.xp.ChangeAllSuggOther})}else this._logger.error(508146659,"Unable to find flag data while applying flag");return!1},this.onIgnoreFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const n=this._annotationMap.get(t.annotationId);if(n){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,P.l)(e))return this._logger.error(508146658,"Unable to find paragraph node while ignoring flag"),!1;n.critique.isIgnored=!0,this.onIgnoreFlag(e,t),this._annotationMap.delete(t.annotationId),this._instrumentationProcessor.process({critique:(0,ye.toJS)(t),eventId:pn.xp.Ignore})}else this._logger.error(508146657,"Unable to find flag data while ignoring flag");return!1},this.onIgnoreAllOfFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const n=this._annotationMap.get(t.annotationId);if(n){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,P.l)(e))return this._logger.error(507574145,"Unable to find paragraph node while ignoring all of flag"),!1;if(!t.textInContext)return this._logger.error(507574097,"Unable to find flag textInContext while ignoring all of flag"),!1;this.ignoredStrings.push(t.textInContext),n.critique.isIgnored=!0,this.onIgnoreAllOfFlag(e,t),this._instrumentationProcessor.process({critique:(0,ye.toJS)(t),eventId:pn.xp.IgnoreAll})}else this._logger.error(507574096,"Unable to find flag data while ignoring all of flag");return!1},this.onDisableFlag_Internal=(e,t)=>{var n;if(!t.annotationId)return!1;this._isDisabled=!0,this.onDisableFlag();for(const e of this._annotationMap.values())this.removeFlag(void 0,e.critique.annotationId);return null===(n=this._disableCritiqueHandler)||void 0===n||n.disableCritique(t),this._instrumentationProcessor.process({critique:(0,ye.toJS)(t),eventId:pn.xp.DoNotCheckThisIssue}),!1}}async initialize(){if(this._hostSettings.enableOrchestration){for(const e of this._hostEmitters)e.on(M.pD.hostModelCritiques,this.onHostModelCritiques);this._applyFlagHandler&&(this.shutDownCallbacks.push(this._applyFlagHandler.handleApplyFlag(this.getCritiqueType(),this.onApplyFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreFlag(this.getCritiqueType(),this.onIgnoreFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreAllOfFlag(this.getCritiqueType(),this.onIgnoreAllOfFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleDisableFlag(this.getCritiqueType(),this.onDisableFlag_Internal))),this.flagHandlerInitialize()}}addFlags(e,t){const n=new Map;for(const e of t){const t=n.get(e.nodeId);t?t.push(e):n.set(e.nodeId,[e])}for(const[t,i]of n)this.addFlagsInSameTile(e,t,i[0].nodeVersion,i)}addFlagsInSameTile(e,t,n,i){if(this._isDisabled)return;const r=i.map((e=>Object.assign(Object.assign({isFlagCritique:!0},e),{nodeId:t,nodeVersion:n,priority:Bo.bx.Informational,suggestions:[],typeId:this.getCritiqueType(),isIgnored:!1}))).filter((e=>{var t,n,i,r,o;if(e.annotationId&&this._annotationMap.get(e.annotationId))return!1;if(e.textInContext&&this.ignoredStrings.includes(e.textInContext))return!1;const a=this._proofingDom.findParagraphNode(e.nodeId);return!!(null===(t=null==a?void 0:a.parent)||void 0===t?void 0:t.element)&&(null===(o=null===(r=null===(i=null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.flagAnnotationSettings)||void 0===i?void 0:i.shouldRenderFlag)||void 0===r?void 0:r.call(i,(0,Zi.OE)(e),a.parent.element,e.nodeId,e.start,length))||void 0===o||o)}));this.emitEvent(g.G.NewData,r,t,e,n);for(const e of r)this._annotationMap.set(e.annotationId,{tileId:t,critique:e,additionalData:e.additionalData})}addFlag(e,t,n,i,r,o,a,s,l,u,d,c,h,g,p,f,m){this.addFlagsInSameTile(e,r,o,[{annotationId:t,textInContext:a,length:l,start:s,languageId:i,traceId:n,supportedActions:u,supportedEntityTypes:d,suggestionItems:c,groupTitle:g,groupSubtitle:p,tooltipTitle:f,categoryTitle:m,additionalData:h}])}emitEvent(e,t,n,i=void 0,r=0){for(const o of this._hostEmitters)o.emit(M.pD.hostModelFlags,{address:i,message:{messageType:g.G.ChangeData,data:{critiquesAdded:e===g.G.NewData?t:[],critiqueIdsRemoved:e===g.G.RemoveData?t.map((e=>e.annotationId)):[],tileId:n,tileVersion:r,source:"Local"}}})}};jo=(0,r.__decorate)([(0,Le._)()],jo);let zo=class extends jo{constructor(e,t,n,i,r,o,a,s,l){super(e,t,n,i,o,a,s,l),this._localizer=r,this.onFlagAnnotationUpdate=e=>{var t,n;const i=e.message.messageType,r=e.message.data;if(i===g.G.NewData&&r.results.length>0){const n=[];for(const e of r.results){if(!qo.uH.typeGuard(e))continue;if(1!==e.results.length||e.results[0].entityType!==Uo.c.DateTime||!Ho(this._hostSettings))continue;const i=e.results[0].subType,o=e.results[0].text;let a,s;try{const e=JSON.parse(o);e.start&&e.end&&("DateRange"===i?(a=Vo(e.start).getTime(),s=Vo(e.end).getTime()):(a=Date.parse(e.start),s=Date.parse(e.end)))}catch(e){}a||s||!Date.parse(o)||(a="Date"===i?Vo(o).getTime():Date.parse(o),s=a);const l=[{entities:[{entityType:Uo.c.DateTime,text:this.getTextForEntity(i),icon:{iconName:Go()},confidence:e.modelMetadata.score,startDateTime:null==a?void 0:a.toString(),endDateTime:null==s?void 0:s.toString(),subType:i}],entityType:Uo.c.DateTime,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle")}];let u;switch(i){case"Date":u=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTooltipTitle");break;case"Datetime":case"DateTime":u=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeTooltipTitle");break;case"DateRange":u=this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeTooltipTitle");break;case"Time":u=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeTooltipTitle");break;case"TimeRange":u=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeTooltipTitle")}const d=r.tileId+e.id;n.push({annotationId:d,traceId:d,languageId:this._hostSettings.defaultLocale,nodeId:r.tileId,nodeVersion:r.tileVersion,textInContext:null!==(t=e.context)&&void 0!==t?t:"",start:e.range.start,length:e.range.length,supportedActions:Bo.lb.Ignore,supportedEntityTypes:[Uo.c.DateTime],suggestionItems:l,additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:u,categoryTitle:this._localizer.getMessage("ebx_DateEntityRecognitionCategoryTitle")})}this.addFlags(e.address,n)}else if(i===g.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(r.annotationId);if(t){const n=[...t];for(const t of n)this.removeFlag(e.address,t)}else this.removeFlag(e.address,r.annotationId)}},this.getTextForEntity=e=>{switch(e){case"Date":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateLabel");case"Datetime":case"DateTime":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeLabel");case"DateRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeLabel");case"Time":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeLabel");case"TimeRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeLabel");default:return""}},this.onApplyFlag=(e,t,n,i)=>{var r,o;t.annotationId&&this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(r=this._hostSettings.serviceSettings)||void 0===r?void 0:r.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(n,i,e.parent.element,n,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ir.L9.CIQFlag_DateEntityRecognition}};function Ho(e){var t,n;return(0,Mo.i$)(null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Uo.c.DateTime)}function Vo(e){const t=e.split(/\D+/).map((e=>parseInt(e,10)));return t[1]=t[1]-1,new Date(t[0],t[1],t[2])}function Go(){const e="DateFlag";return(0,O.Z)(e,{regular:Oo,filled:ko}),e}zo=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Pn.t)(M.zJ)),(0,r.__param)(1,(0,Me.W)(Ie.n)),(0,r.__param)(2,(0,Me.W)(he.w)),(0,r.__param)(3,(0,Me.W)(v.g)),(0,r.__param)(4,(0,Me.W)(Ro.H)),(0,r.__param)(5,(0,Me.W)(b.$)),(0,r.__param)(6,(0,Me.W)(x.W)),(0,r.__param)(6,(0,St.l)()),(0,r.__param)(7,(0,Me.W)(Lo.f)),(0,r.__param)(8,(0,St.l)()),(0,r.__param)(8,(0,Me.W)(Wo.K))],zo);let Qo=class extends jo{constructor(e,t,n,i,r,o,a,s,l,u){super(e,t,n,i,o,a,s,u),this._localizer=r,this._paragraphTextExtractor=l,this.onFlagAnnotationUpdate=e=>{var t,n,i;const r=e.message.messageType,o=e.message.data;if(r===g.G.NewData&&o.results.length>0){const i=o.results.filter((e=>"GraphSearch"===e.ownerId));if(Ko(this._hostSettings)){const r=i.filter((e=>e.results[0].entityType===Uo.c.File)),a=[];for(const e of r){const i={entities:e.results,entityType:Uo.c.File,groupTitle:this._localizer.getMessage("fileEntityLabel")},r=this._paragraphTextExtractor.getParagraphText(o.tileId),s=null!==(t=e.context)&&void 0!==t?t:null==r?void 0:r.substring(e.range.start,e.range.start+e.range.length),l=o.annotationId+(null===(n=e.M_)||void 0===n?void 0:n.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(o.annotationId);e||(e=new Set),e.add(l)}s&&a.push({annotationId:l,traceId:l,languageId:e.language,nodeId:o.tileId,nodeVersion:o.tileVersion,textInContext:s,start:e.range.start,length:e.range.length,supportedActions:Bo.lb.Ignore,supportedEntityTypes:[Uo.c.File],suggestionItems:[i],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle")})}this.addFlags(e.address,a)}}else if(r===g.G.RemoveData){const t=null===(i=this._annotationIdMap)||void 0===i?void 0:i.get(o.annotationId);if(t){const n=[...t];for(const t of n)this.removeFlag(e.address,t)}else this.removeFlag(e.address,o.annotationId)}},this.onApplyFlag=(e,t,n,i)=>{var r,o;t.annotationId&&this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(r=this._hostSettings.serviceSettings)||void 0===r?void 0:r.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(n,i,e.parent.element,n,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ir.L9.CIQFlag_File}};function Ko(e){var t,n;return(0,Mo.f1)(e.flightsToTrack,null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Uo.c.File,"mc-editor-oa-files-flag")}Qo=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Pn.t)(M.zJ)),(0,r.__param)(1,(0,Me.W)(Ie.n)),(0,r.__param)(2,(0,Me.W)(he.w)),(0,r.__param)(3,(0,Me.W)(v.g)),(0,r.__param)(4,(0,Me.W)(Ro.H)),(0,r.__param)(5,(0,Me.W)(b.$)),(0,r.__param)(6,(0,Me.W)(x.W)),(0,r.__param)(6,(0,St.l)()),(0,r.__param)(7,(0,Me.W)(Lo.f)),(0,r.__param)(8,(0,Me.W)(Ii.b)),(0,r.__param)(9,(0,St.l)()),(0,r.__param)(9,(0,Me.W)(Wo.K))],Qo);let $o=class extends jo{constructor(e,t,n,i,r,o,a,s,l,u,d){super(e,t,n,i,o,a,s,d),this._localizer=r,this._paragraphTextExtractor=l,this._tileContent=u,this.onFlagAnnotationUpdate=e=>{var t,n,i;const r=e.message.messageType,o=e.message.data;if(Zo(this._hostSettings))if(r===g.G.NewData&&o.results.length>0){const i=o.results.filter((e=>e.results.length>0&&e.results[0].entityType===Uo.c.People)),r=[];for(const e of i){const i=[];for(const t of e.results){if(!t.DisplayName)continue;const e=["JobTitle","Company","Department","OfficeLocation"],n=t;n.PropertyHits&&e.includes(n.PropertyHits[0])?i.push(Object.assign(Object.assign({},t),{subtitlePropertyOverride:n.PropertyHits[0]})):i.push(t)}const a={entities:i,entityType:Uo.c.People,groupTitle:this._localizer.getMessage("peopleEntityLabel")},s=this._paragraphTextExtractor.getParagraphText(o.tileId),l=null!==(t=e.context)&&void 0!==t?t:null==s?void 0:s.substring(e.range.start,e.range.start+e.range.length),u=o.annotationId+(null===(n=e.M_)||void 0===n?void 0:n.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(o.annotationId);e||(e=new Set),e.add(u)}l&&r.push({annotationId:u,traceId:u,languageId:e.language,nodeId:o.tileId,nodeVersion:o.tileVersion,textInContext:l,start:e.range.start,length:e.range.length,supportedActions:Bo.lb.Ignore,supportedEntityTypes:[Uo.c.People],suggestionItems:0===i.length?void 0:[a],additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:this._localizer.getMessage("ebx_CIQFlagPeopleTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_PersonEntityRecognitionCategoryTitle")})}this.addFlags(e.address,r)}else if(r===g.G.RemoveData){const t=null===(i=this._annotationIdMap)||void 0===i?void 0:i.get(o.annotationId);if(t){const n=[...t];for(const t of n)this.removeFlag(e.address,t)}else this.removeFlag(e.address,o.annotationId)}},this.onApplyFlag=(e,t,n,i)=>{var r,o;if(!t.annotationId)return;const a=this._annotationMap.get(t.annotationId);if(a&&(this._annotationMap.delete(t.annotationId),null===(o=null===(r=this._hostSettings.serviceSettings)||void 0===r?void 0:r.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)){const r=a.additionalData.replacementRange;if(r){const i=r.start-a.additionalData.range.start,o=t.start+i;this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+o,r.length).then((i=>{if(!i)return void this._logger.logDiagnostics("Unable to find replacement flag range",void 0,(0,K.W)(["FlagTypeId",a.critique.typeId],["Start",a.additionalData.range.start],["Length",a.additionalData.range.length],["ReplacementStart",r.start],["ReplacementLength",r.length],["InTextReplacementStart",o]));const s=Object.assign(Object.assign({},t),{start:o,length:r.length});this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(n,i,e.parent.element,n,s)})).catch((e=>{this._logger.logDiagnostics("Unable to find replacement flag range",void 0,(0,K.W)(["Exception",e],["FlagTypeID",a.critique.typeId],["Start",a.additionalData.range.start],["Length",a.additionalData.range.length],["ReplacementStart",r.start],["ReplacementLength",r.length],["InTextReplacementStart",o]))}))}else this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(n,i,e.parent.element,n,t)}},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ir.L9.CIQFlag_PersonEntityRecognition}};function Zo(e){var t,n;return(0,Mo.i$)(null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Uo.c.People)}$o=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Pn.t)(M.zJ)),(0,r.__param)(1,(0,Me.W)(Ie.n)),(0,r.__param)(2,(0,Me.W)(he.w)),(0,r.__param)(3,(0,Me.W)(v.g)),(0,r.__param)(4,(0,Me.W)(Ro.H)),(0,r.__param)(5,(0,Me.W)(b.$)),(0,r.__param)(6,(0,Me.W)(x.W)),(0,r.__param)(6,(0,St.l)()),(0,r.__param)(7,(0,Me.W)(Lo.f)),(0,r.__param)(8,(0,Me.W)(Ii.b)),(0,r.__param)(9,(0,Me.W)(F.d)),(0,r.__param)(10,(0,St.l)()),(0,r.__param)(10,(0,Me.W)(Wo.K))],$o);var Jo=n(41567),Yo=function(){function e(t){Jo.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_TimeResult"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ResultInfo"]},e.typeGuard=function(t){return Jo.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();const Xo=Po("GlobeFilled","1em",["M7.99 4.18c-.28.66-.5 1.45-.67 2.32h5.36c-.17-.87-.4-1.66-.67-2.32-.3-.73-.65-1.3-1-1.66C10.64 2.15 10.3 2 10 2c-.3 0-.65.15-1 .52-.36.37-.71.93-1.01 1.66Zm-.1-1.9c-.31.43-.59.94-.83 1.52-.32.78-.58 1.7-.76 2.7H2.8c1-2.05 2.85-3.6 5.1-4.22Zm4.22 0c.31.43.59.94.83 1.52.32.78.58 1.7.76 2.7h3.5a8.02 8.02 0 0 0-5.09-4.22Zm5.5 5.22h-3.76a20.52 20.52 0 0 1 0 5h3.75a8 8 0 0 0 0-5Zm-.41 6h-3.5c-.18 1-.44 1.92-.76 2.7-.24.58-.52 1.1-.83 1.52a8.02 8.02 0 0 0 5.09-4.22ZM10 18c.3 0 .65-.15 1-.52.36-.37.71-.93 1.01-1.66.28-.66.5-1.45.67-2.32H7.32c.17.87.4 1.66.67 2.32.3.73.65 1.3 1 1.66.36.37.7.52 1.01.52Zm-2.1-.28a8.02 8.02 0 0 1-5.1-4.22h3.5c.18 1 .44 1.92.76 2.7.24.58.52 1.1.83 1.52ZM2.4 12.5h3.75a20.52 20.52 0 0 1 0-5H2.4a8 8 0 0 0 0 5ZM7 10c0-.87.06-1.71.16-2.5h5.68a19.44 19.44 0 0 1 0 5H7.16C7.06 11.71 7 10.87 7 10Z"]),ea=Po("GlobeRegular","1em",["M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm0-15c.66 0 1.4.59 2.02 1.9.22.47.4 1.01.56 1.6H7.42c.15-.59.34-1.13.56-1.6C8.59 3.6 9.34 3 10 3ZM7.07 4.49c-.27.59-.5 1.27-.68 2.01H3.94A7.02 7.02 0 0 1 7.7 3.38c-.24.33-.45.7-.64 1.1ZM6.2 7.5a15.97 15.97 0 0 0 0 5H3.46a6.98 6.98 0 0 1 0-5h2.73Zm.2 6c.17.74.4 1.42.68 2.01.19.4.4.78.64 1.1a7.02 7.02 0 0 1-3.77-3.11h2.45Zm1.03 0h5.16a9.25 9.25 0 0 1-.56 1.6C11.41 16.4 10.66 17 10 17c-.66 0-1.4-.59-2.02-1.9-.22-.47-.4-1.01-.56-1.6Zm5.37-1H7.21a14.87 14.87 0 0 1 0-5h5.58a14.86 14.86 0 0 1 0 5Zm.82 1h2.45a7.02 7.02 0 0 1-3.77 3.12c.24-.33.45-.7.64-1.1.27-.6.5-1.28.68-2.02Zm2.93-1h-2.73a15.97 15.97 0 0 0 0-5h2.73a6.98 6.98 0 0 1 0 5Zm-4.25-9.12a7.02 7.02 0 0 1 3.77 3.12h-2.45a10.5 10.5 0 0 0-.68-2.01c-.19-.4-.4-.78-.64-1.1Z"]);let ta=class extends jo{constructor(e,t,n,i,r,o,a,s,l,u){super(e,t,n,i,a,s,l,u),this._tileContent=r,this._localizer=o,this.onFlagAnnotationUpdate=e=>{const t=e.message.messageType,n=e.message.data;if(t===g.G.NewData&&n.results.length>0){const t=[];for(const e of n.results){if(!qo.uH.typeGuard(e))continue;if(0===e.results.length)continue;const i=e.results[0];if(!Yo.typeGuard(i))continue;const r=[{entities:[{entityType:Uo.c.Text,text:i.context+i.hint,subtitle:void 0,icon:{iconName:ia()},confidence:1}],entityType:Uo.c.Text,groupTitle:this._localizer.getMessage("ebx_CIQFlagTimeTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTimeSubtitle")}];t.push({annotationId:n.annotationId,traceId:n.annotationId,languageId:e.language,nodeId:n.tileId,nodeVersion:n.tileVersion,textInContext:i.context,start:e.range.start,length:e.range.length,supportedActions:Bo.lb.Ignore,supportedEntityTypes:[Uo.c.Text],suggestionItems:r,additionalData:i,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTimeTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTimeCategoryTitle")})}this.addFlags(e.address,t)}else t===g.G.RemoveData&&this.removeFlag(e.address,n.annotationId)},this.onApplyFlag=(e,t,n,i)=>{t.annotationId&&this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),this._tileContent.replace(e.parent,void 0,t.start,t.length,n.text.trim(),i))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{}}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ir.L9.CIQFlag_Time}};function na(e){var t,n;return(0,Mo.f1)(e.flightsToTrack,null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Uo.c.Time,"mc-unified-text-prediction-timezone-perspectives")}function ia(){const e="TimeFlag";return(0,O.Z)(e,{regular:ea,filled:Xo}),e}ta=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Pn.t)(M.zJ)),(0,r.__param)(1,(0,Me.W)(Ie.n)),(0,r.__param)(2,(0,Me.W)(he.w)),(0,r.__param)(3,(0,Me.W)(v.g)),(0,r.__param)(4,(0,Me.W)(F.d)),(0,r.__param)(5,(0,Me.W)(Ro.H)),(0,r.__param)(6,(0,Me.W)(b.$)),(0,r.__param)(7,(0,Me.W)(x.W)),(0,r.__param)(7,(0,St.l)()),(0,r.__param)(8,(0,Me.W)(Lo.f)),(0,r.__param)(9,(0,St.l)()),(0,r.__param)(9,(0,Me.W)(Wo.K))],ta);let ra=class extends jo{constructor(e,t,n,i,r,o,a,s,l,u){super(e,t,n,i,o,a,s,u),this._localizer=r,this._paragraphTextExtractor=l,this.onFlagAnnotationUpdate=e=>{var t,n,i;const r=e.message.messageType,o=e.message.data;if(r===g.G.NewData&&o.results.length>0){const i=o.results.filter((e=>"GraphSearch"===e.ownerId));if(oa(this._hostSettings)){const r=i.filter((e=>e.results[0].entityType===Uo.c.Topic)),a=[];for(const e of r){const i={entities:e.results.map((e=>Object.assign(Object.assign({},e),{icon:{iconName:"Hashtag"}}))),entityType:Uo.c.Topic,groupTitle:this._localizer.getMessage("ebx_CIQFlagTopicTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTopicSubtitle")},r=this._paragraphTextExtractor.getParagraphText(o.tileId),s=null!==(t=e.context)&&void 0!==t?t:null==r?void 0:r.substring(e.range.start,e.range.start+e.range.length);if(!s)continue;const l=o.annotationId+(null===(n=e.M_)||void 0===n?void 0:n.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(o.annotationId);e||(e=new Set),e.add(l)}a.push({annotationId:l,traceId:l,languageId:e.language,nodeId:o.tileId,nodeVersion:o.tileVersion,textInContext:s,start:e.range.start,length:e.range.length,supportedActions:Bo.lb.Ignore|Bo.lb.IgnoreAll,supportedEntityTypes:[Uo.c.Topic],suggestionItems:[i],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle")})}this.addFlags(e.address,a)}}else if(r===g.G.RemoveData){const t=null===(i=this._annotationIdMap)||void 0===i?void 0:i.get(o.annotationId);if(t){const n=[...t];for(const t of n)this.removeFlag(e.address,t)}else this.removeFlag(e.address,o.annotationId)}},this.onApplyFlag=(e,t,n,i)=>{var r,o;if(!t.annotationId)return;const a=this._annotationMap.get(t.annotationId);a&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(r=this._hostSettings.serviceSettings)||void 0===r?void 0:r.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(a.additionalData,i,e.parent.element,n,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(M.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return ir.L9.CIQFlag_Topic}};function oa(e){var t,n;return(0,Mo.f1)(e.flightsToTrack,null===(n=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.entityConfigs,Uo.c.Topic,"mc-editor-oa-topics-flags")}ra=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Pn.t)(M.zJ)),(0,r.__param)(1,(0,Me.W)(Ie.n)),(0,r.__param)(2,(0,Me.W)(he.w)),(0,r.__param)(3,(0,Me.W)(v.g)),(0,r.__param)(4,(0,Me.W)(Ro.H)),(0,r.__param)(5,(0,Me.W)(b.$)),(0,r.__param)(6,(0,Me.W)(x.W)),(0,r.__param)(6,(0,St.l)()),(0,r.__param)(7,(0,Me.W)(Lo.f)),(0,r.__param)(8,(0,Me.W)(Ii.b)),(0,r.__param)(9,(0,St.l)()),(0,r.__param)(9,(0,Me.W)(Wo.K))],ra);class aa{get uniqueId(){return(0,Je.z)(507781790)}configureRootServices(e){var t,n;const i=e.get(Ie.n);(null===(n=null===(t=i.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.enabled)&&(Ho(i)&&sa(e,ir.L9.CIQFlag_DateEntityRecognition,"ebx_DateEntityRecognitionCategoryTitle"),Ko(i)&&sa(e,ir.L9.CIQFlag_File,"ebx_CIQFlagFileTooltipTitle"),Zo(i)&&sa(e,ir.L9.CIQFlag_PersonEntityRecognition,"ebx_PersonEntityRecognitionCategoryTitle"),na(i)&&sa(e,ir.L9.CIQFlag_Time,"ebx_CIQFlagTimeCategoryTitle"),oa(i)&&sa(e,ir.L9.CIQFlag_Topic,"ebx_CIQFlagTopicCategoryTitle"))}}function sa(e,t,n){e.bind(Io).toValue((e=>({id:t,name:wo(n,e)})))}var la=n(11394);class ua{constructor(){this.imports=[la.v,So.d,aa]}get uniqueId(){return(0,Je.z)(507918358)}configureRootServices(e){var t,n;e.bind(Wo.K).to(To);const i=e.get(Ie.n);(null===(n=null===(t=i.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===n?void 0:n.enabled)&&(Ho(i)&&e.bind(We.S).to(zo),Ko(i)&&e.bind(We.S).to(Qo),Zo(i)&&e.bind(We.S).to($o),na(i)&&e.bind(We.S).to(ta),oa(i)&&e.bind(We.S).to(ra))}}var da=n(13304);class ca{constructor(){this.imports=[ua,da.r,la.v,_o.J]}get uniqueId(){return(0,Je.z)(507918295)}configureRootServices(e){}}var ha=n(41977);let ga=class{constructor(e){this._hostSettings=e,this._getWorkerUrl=()=>new Promise((e=>{var t;const n=new MessageChannel;n.port1.onmessage=({data:t})=>{var i;n.port1.close(),e(null!==(i=null==t?void 0:t.url)&&void 0!==i?i:null)},null===(t=this._dmp)||void 0===t||t.postMessage(["get-url"],[n.port2])})),this._callworker=(e,t,n)=>new Promise(((i,r)=>{var o;const a=new MessageChannel;a.port1.onmessage=({data:e})=>{a.port1.close(),e.error?r(e.error):i(e.result)},null===(o=this._dmp)||void 0===o||o.postMessage([e,t,n],[a.port2])}))}async initialize(){var e;if(null===(e=this._dmp)||void 0===e||e.terminate(),this._hostSettings.disableInlineWorkerLoader)this._dmp=new Worker(new URL(n.p+n.u(2063),n.b));else{const e=n(90994);this._dmp=new e.default}if(this._hostSettings.validateWorkerUrl){const e=await this._getWorkerUrl();await this._hostSettings.validateWorkerUrl(e)||this.shutDown()}}shutDown(){var e;null===(e=this._dmp)||void 0===e||e.terminate(),this._dmp=void 0}async getReadjustedIndices(e,t,n,i){var r;const o=null!==(r=e.textContent)&&void 0!==r?r:"",a=i?n:o,s=i?o:n;return await this._callworker(a,s,t)}};ga=(0,r.__decorate)([(0,Le._)(),(0,r.__param)(0,(0,Me.W)(Ie.n))],ga);class pa{constructor(){this.imports=[]}get uniqueId(){return(0,Je.z)(507918239)}configureRootServices(e){e.bind(tn).to(ga),e.bind(We.S).toExisting(tn)}}var fa,ma=(fa=[],{fireEvent:function(e){fa.forEach((function(t){return t(e)}))},addListener:function(e){e&&fa.push(e)}});function va(e,t,n){ma.fireEvent({level:e,category:t,message:n})}function ya(e,t,n){va(0,e,(function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)}))}var _a="function",ba="object",Ca="undefined",Ta="prototype",Sa="hasOwnProperty",Ia=Object,wa=Ia[Ta],Ea=Ia.assign,xa=Ia.create,Aa=Ia.defineProperty,Da=wa[Sa],Na=null;function Fa(e){void 0===e&&(e=!0);var t=!1===e?null:Na;return t||(typeof globalThis!==Ca&&(t=globalThis),t||typeof self===Ca||(t=self),t||typeof window===Ca||(t=window),t||typeof n.g===Ca||(t=n.g),Na=t),t}function Pa(e){throw new TypeError(e)}function ka(e){if(xa)return xa(e);if(null==e)return{};var t=typeof e;function n(){}return t!==ba&&t!==_a&&Pa("Object prototype may only be an Object:"+e),n[Ta]=e,new n}var Oa="initialize",Ba="name",Ra="getNotifyMgr",La="identifier",Ma="push",qa="isInitialized",Ua="config",Wa="instrumentationKey",ja="logger",za="length",Ha="time",Va="processNext",Ga="getProcessTelContext",Qa="addNotificationListener",Ka="removeNotificationListener",$a="stopPollingInternalLogs",Za="onComplete",Ja="getPlugin",Ya="flush",Xa="_extensions",es="splice",ts="teardown",ns="messageId",is="message",rs="isAsync",os="_doTeardown",as="update",ss="getNext",ls="diagLog",us="setNextPlugin",ds="createNew",cs="cookieCfg",hs="indexOf",gs="substring",ps="userAgent",fs="split",ms="setEnabled",vs="substr",ys="nodeType",_s="apply",bs="replace",Cs="enableDebugExceptions",Ts="toLowerCase",Ss="call",Is="type",ws="handler",Es="listeners",xs="isChildEvt",As="getCtx",Ds="setCtx",Ns="complete",Fs="traceId",Ps="spanId",ks="traceFlags",Os="",Bs="channels",Rs="core",Ls="createPerfMgr",Ms="disabled",qs="extensionConfig",Us="processTelemetry",Ws="priority",js="eventsSent",zs="eventsDiscarded",Hs="eventsSendRequest",Vs="perfEvent",Gs="errorToConsole",Qs="warnToConsole",Ks="getPerfMgr",$s="toISOString",Zs="endsWith",Js="startsWith",Ys="indexOf",Xs="trim",el="toString",tl="__proto__",nl="constructor",il=Aa,rl=Ia.freeze,ol=(Ia.seal,Ia.keys),al=String[Ta],sl=al[Xs],ll=al[Zs],ul=al[Js],dl=Date[Ta][$s],cl=Array.isArray,hl=wa[el],gl=Da[el],pl=gl[Ss](Ia),fl=/-([a-z])/g,ml=/([^\w\d_$])/g,vl=/^(\d+[\w\d_$])/,yl=Object.getPrototypeOf;function _l(e){return void 0===e||typeof e===Ca}function bl(e){return null===e||_l(e)}function Cl(e){return!bl(e)}function Tl(e,t){return!(!e||!Da[Ss](e,t))}function Sl(e){return!(!e||typeof e!==ba)}function Il(e){return!(!e||typeof e!==_a)}function wl(e){var t=e;return t&&Nl(t)&&(t=(t=(t=t[bs](fl,(function(e,t){return t.toUpperCase()})))[bs](ml,"_"))[bs](vl,(function(e,t){return"_"+t}))),t}function El(e,t){if(e)for(var n in e)Da[Ss](e,n)&&t[Ss](e,n,e[n])}function xl(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=ul?e[Js](t):function(e,t){var n=!1,i=t?t[za]:0;if(e&&i&&e[za]>=i&&!(n=e===t)){for(var r=0;r<i;r++)if(e[r]!==t[r])return!1;n=!0}return n}(e,t)),n}function Al(e,t){return!(!e||!t)&&-1!==e[hs](t)}var Dl=cl||function(e){return!(!e||"[object Array]"!==hl[Ss](e))};function Nl(e){return"string"==typeof e}function Fl(e){return"number"==typeof e}function Pl(e){return"boolean"==typeof e}function kl(e){var t=!1;if(e&&"object"==typeof e){var n=yl?yl(e):function(e){if(e){if(yl)return yl(e);var t=e[tl]||e[Ta]||e[nl];if(t)return t}return null}(e);n?(n[nl]&&Da[Ss](n,nl)&&(n=n[nl]),t=typeof n===_a&&gl[Ss](n)===pl):t=!0}return t}function Ol(e){if(e)return dl?e[$s]():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t[za]&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function Bl(e,t,n){var i=e[za];try{for(var r=0;r<i&&(!(r in e)||-1!==t[Ss](n||e,e[r],r,e));r++);}catch(e){}}function Rl(e,t,n){if(e){if(e[Ys])return e[Ys](t,n);var i=e[za],r=n||0;try{for(var o=Math.max(r>=0?r:i-Math.abs(r),0);o<i;o++)if(o in e&&e[o]===t)return o}catch(e){}}return-1}function Ll(e){return e&&(e=sl&&e[Xs]?e[Xs]():e[bs]?e[bs](/^\s+|(?=\s)\s+$/g,Os):e),e}var Ml=!{toString:null}.propertyIsEnumerable("toString"),ql=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Ul(e){var t=typeof e;if(t===_a||t===ba&&null!==e||Pa("objKeys called on non-object"),!Ml&&ol)return ol(e);var n=[];for(var i in e)e&&Da[Ss](e,i)&&n[Ma](i);if(Ml)for(var r=ql[za],o=0;o<r;o++)e&&Da[Ss](e,ql[o])&&n[Ma](ql[o]);return n}function Wl(e,t,n,i){if(il)try{var r={enumerable:!0,configurable:!0};return n&&(r.get=n),i&&(r.set=i),il(e,t,r),!0}catch(e){}return!1}var jl=rl||function(e){return e};function zl(){var e=Date;return e.now?e.now():(new e).getTime()}function Hl(e){return function(e){return!(!e||"[object Error]"!==hl[Ss](e))}(e)?e[Ba]:Os}function Vl(e,t,n,i,r){var o=n;return e&&((o=e[t])===n||r&&!r(o)||i&&!i(n)||(o=n,e[t]=o)),o}function Gl(e,t,n){var i;return e?!(i=e[t])&&bl(i)&&(i=_l(n)?{}:n,e[t]=i):i=_l(n)?{}:n,i}function Ql(e,t){return bl(e)?t:e}function Kl(e){return!!e}function $l(e){throw new Error(e)}function Zl(e,t,n,i,r){e&&t&&n&&(!1!==r||_l(e[t]))&&(e[t]=function(e,t){var n=null,i=null;return Il(e)?n=e:i=e,function(){var e=arguments;if(n&&(i=n()),i)return i[t][_s](i,e)}}(n,i))}function Jl(e){return e&&Ea&&(e=Ia(Ea({},e))),e}function Yl(e,t,n,i,r,o){var a=arguments,s=a[0]||{},l=a[za],u=!1,d=1;for(l>0&&Pl(s)&&(u=s,s=a[d]||{},d++),Sl(s)||(s={});d<l;d++){var c=a[d],h=Dl(c),g=Sl(c);for(var p in c)if(h&&p in c||g&&Da[Ss](c,p)){var f=c[p],m=void 0;if(u&&f&&((m=Dl(f))||kl(f))){var v=s[p];m?Dl(v)||(v=[]):kl(v)||(v={}),f=Yl(u,v,f)}void 0!==f&&(s[p]=f)}}return s}function Xl(e,t,n){return eu(e,0,t,n)}function eu(e,t,n,i){return{name:e,dataType:t,value:n,classification:i||4}}function tu(e,t){return e?e+"."+t:t}function nu(e,t,n,i,r){void 0===r&&(r=4),i&&e.push(Xl("".concat(tu(t,n)),i,r))}function iu(e,t,n,i){"boolean"==typeof i&&e.push(function(e,t,n){return eu(e,1,t,n)}("".concat(tu(t,n)),i))}var ru;!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(ru||(ru={}));var ou;!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(ou||(ou={}));var au,su;!function(e){var t,n,i,r,o="Copilot";(r=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",r.IsSeen="IsSeen",r.IsTried="IsTried",r.IsKept="IsKept",r.IsRejected="IsRejected",(i=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",i.Commanding="Commanding",i.QAandSummaries="QA and Summaries",i.Collaboration="Collaboration",i.Suggestions="Suggestions",(n=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",n.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return nu(t,o,"FeatureActionType",e.featureActionType),iu(t,o,"IsUserInitiated",e.isUserInitiated),nu(t,o,"FeatureName",e.featureName),nu(t,o,"SubFeatureName",e.subFeatureName),nu(t,o,"Capability",e.capability),iu(t,o,"IsThumbsUp",e.isThumbsUp),nu(t,o,"EntryPoint",e.entryPoint),nu(t,o,"Verb",e.verb),nu(t,o,"InteractionId",e.interactionId),t.push(Xl("zC.".concat(o),"Office.System.Copilot")),t}}(au||(au={})),function(e){var t,n="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return nu(t,n,"EventType",e.eventType),nu(t,n,"Pillar",e.pillar),nu(t,n,"Scenario",e.scenario),nu(t,n,"Veto",e.veto),nu(t,n,"Error",e.error),iu(t,n,"InStaging",e.inStaging),iu(t,n,"IsSessionEndingError",e.isSessionEndingError),iu(t,n,"IsIntentional",e.isIntentional),iu(t,n,"IsInternal",e.isInternal),t.push(Xl("zC.".concat(n),"Office.System.Asha")),t}}(su||(su={}));var lu="Data.",uu="User.PrimaryIdentityHash",du="User.PrimaryIdentitySpace",cu="User.TenantId",hu="User.IsAnonymous",gu="User.IsSignedIn";function pu(e,t,n,i){var r=!0;if(t)for(var o=function(t){var o=t.classification,a=t.dataType,s=t.name;if(o&&!(4===o||1===o||2===i&&32===o||3===i&&2048===o))return r=!1,"break";if(3===i&&n&&3!==a&&1!==a&&2!==a&&"OTelJS.Version"!==s&&"OTelJS.Sink"!==s)return va(0,1,(function(){return"DNM: Invalid field type "+s})),r=!1,"break";var l;l=n?"zC."===s.substr(0,3)?"zC."+lu+s.substr(3):lu+s:s;var u=void 0;switch(a){case 3:u=6;break;case 2:u=4;break;case 4:u=8;break;case 0:return e[l]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";default:return e[l]=t.value,"continue"}var d={value:t.value,propertyType:u};e[l]=d},a=0,s=t;a<s.length&&"break"!==o(s[a]);a++);return r}function fu(e){va(0,1,(function(){return"Invalid "+e}))}function mu(e){return Nl(e)&&""!==e}function vu(e,t){return Object.values(t).includes(e)}function yu(e){return vu(e,ru)}function _u(e){return vu(e,ou)}function bu(e){return["MSACID","MSAPUID","OrgIdCID","OrgIdPUID","UserObjectId","Other"].includes(e)}function Cu(e){return!e||"Other"===e}function Tu(e,t){var n=!0;function i(t,i){i(e[t])||(fu(t),n=!1)}function r(e){return new RegExp("^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$",t?"":"i").test(e)}return i("App.Name",mu),i("App.Platform",t?yu:mu),i("App.Version",mu),i("Session.Id",r),t?(i("Release.AudienceGroup",_u),i(gu,Pl),e[gu]?(i(uu,mu),i(du,bu),["OrgIdCID","OrgIdPUID","UserObjectId"].includes(e[du])?i(cu,r):i(cu,bl)):(i(du,Cu),i(cu,bl))):e[hu]||!1===e[gu]||(i(uu,mu),i(du,mu),e[cu]&&i(cu,r)),bl(e[hu])||e[gu]!==e[hu]||(fu(hu),n=!1),n}var Su={};function Iu(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?Su[e]?(t.ariaTenantToken&&(Su[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(Su[e].dnmToken=t.dnmToken)):Su[e]=t:va(0,0,(function(){return"Namespace: ".concat(e)}))}function wu(e,t){for(var n=e.length;n>0;){var i=e.substr(0,n);if(Su[i]){var r=Su[i];return t.ariaTenantToken=r.ariaTenantToken,t.dnmToken=r.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var Eu=9007199254740991,xu=-Eu,Au=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,Du=/^[a-zA-Z0-9_\.]{1,95}$/;function Nu(e){return Du.test(e)}function Fu(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!Nu(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<xu||e>Eu)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}function Pu(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,r.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}!function(){function e(e,t,n){var i,o,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=(0,r.__assign)((0,r.__assign)({},e.getConfig()),this.config),(o=this.partAFields).push.apply(o,e.partAFields)),t&&(a=this.persistentDataFields).push.apply(a,t)}e.prototype.addEventContentType=function(e,t){var n;e.push(eu("EventContent.Type",2,t,n))},e.prototype.sendTelemetryEvent=function(e){var t=Pu(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var i=n.ariaTenantToken;i||wu(t.eventName,n)||i?this.sendTelemetryEventInternal(t,1):va(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var n=Pu(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=Pu(e),n=t.telemetryProperties,i=n.customerContentVersion;return(!i||i>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=Pu(e),n=t.telemetryProperties;n.dnmToken||wu(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):va(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):va(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void ya(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else va(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,i,r;if(e.dataFields&&(null===(r=e.dataFields)||void 0===r||r.unshift(Xl("OTelJS.Version","4.20.7")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(i=o.dataFields).push.apply(i,this.partAFields),e.eventContract=o}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!Au.test(t))throw new Error("Invalid eventName");var t,n=e.eventContract;if(n){if(n.name&&!Nu(n.name))throw new Error("Invalid eventContract");Fu(n.dataFields)}Fu(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var i=n[t],r=i[0],o=i[1];this.sendTelemetryEventInternal(r,o)}},e.prototype.setTenantToken=function(e,t,n){Iu(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){Iu(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return Pu(e)},e.prototype.getConfig=function(){return this.config}}();var ku,Ou,Bu="undefined",Ru="constructor",Lu="prototype",Mu="function",qu="_dynInstFuncs",Uu="_isDynProxy",Wu="_dynClass",ju="_dynInstChk",zu=ju,Hu="_dfOpts",Vu="_unknown_",Gu="__proto__",Qu="_dyn"+Gu,Ku="__dynProto$Gbl",$u="_dynInstProto",Zu="useBaseInst",Ju="setInstFuncs",Yu=Object,Xu=Yu.getPrototypeOf,ed=Yu.getOwnPropertyNames,td=(typeof globalThis!==Bu&&(Ou=globalThis),Ou||typeof self===Bu||(Ou=self),Ou||typeof window===Bu||(Ou=window),Ou||typeof n.g===Bu||(Ou=n.g),Ou||{}),nd=td[Ku]||(td[Ku]={o:(ku={},ku[Ju]=!0,ku[Zu]=!0,ku),n:1e3});function id(e,t){return e&&Yu[Lu].hasOwnProperty.call(e,t)}function rd(e){return e&&(e===Yu[Lu]||e===Array[Lu])}function od(e){return rd(e)||e===Function[Lu]}function ad(e){var t;if(e){if(Xu)return Xu(e);var n=e[Gu]||e[Lu]||(e[Ru]?e[Ru][Lu]:null);t=e[Qu]||n,id(e,Qu)||(delete e[$u],t=e[Qu]=e[$u]||e[Qu],e[$u]=n)}return t}function sd(e,t){var n=[];if(ed)n=ed(e);else for(var i in e)"string"==typeof i&&id(e,i)&&n.push(i);if(n&&n.length>0)for(var r=0;r<n.length;r++)t(n[r])}function ld(e,t,n){return t!==Ru&&typeof e[t]===Mu&&(n||id(e,t))&&t!==Gu&&t!==Lu}function ud(e){throw new TypeError("DynamicProto: "+e)}function dd(){return Object.create?(null,(e=Object.create)?e(null):{}):{};var e}function cd(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function hd(e,t,n,i,r){if(!rd(e)){var o=n[qu]=n[qu]||dd();if(!rd(o)){var a=o[t]=o[t]||dd();!1!==o[zu]&&(o[zu]=!!r),rd(a)||sd(n,(function(t){ld(n,t,!1)&&n[t]!==i[t]&&(a[t]=n[t],delete n[t],(!id(e,t)||e[t]&&!e[t][Uu])&&(e[t]=function(e,t){var n=function(){var i=function(e,t,n,i){var r=null;if(e&&id(n,Wu)){var o=e[qu]||dd();if((r=(o[n[Wu]]||dd())[t])||ud("Missing ["+t+"] "+Mu),!r[ju]&&!1!==o[zu]){for(var a=!id(e,t),s=ad(e),l=[];a&&s&&!od(s)&&!cd(l,s);){var u=s[t];if(u){a=u===i;break}l.push(s),s=ad(s)}try{a&&(e[t]=r),r[ju]=1}catch(e){o[zu]=!1}}}return r}(this,t,e,n)||function(e,t,n){var i=t[e];return i===n&&(i=ad(t)[e]),typeof i!==Mu&&ud("["+e+"] is not a "+Mu),i}(t,e,n);return i.apply(this,arguments)};return n[Uu]=1,n}(e,t)))}))}}}function gd(e,t){return id(e,Lu)?e.name||t||Vu:((e||{})[Ru]||{}).name||t||Vu}function pd(e,t,n,i){id(e,Lu)||ud("theClass is an invalid class definition.");var r=e[Lu];(function(e,t){if(Xu){for(var n=[],i=ad(t);i&&!od(i)&&!cd(n,i);){if(i===e)return!0;n.push(i),i=ad(i)}return!1}return!0})(r,t)||ud("["+gd(e)+"] not in hierarchy of ["+gd(t)+"]");var o=null;id(r,Wu)?o=r[Wu]:(o="_dynCls$"+gd(e,"_")+"$"+nd.n,nd.n++,r[Wu]=o);var a=pd[Hu],s=!!a[Zu];s&&i&&void 0!==i[Zu]&&(s=!!i[Zu]);var l=function(e){var t=dd();return sd(e,(function(n){!t[n]&&ld(e,n,!1)&&(t[n]=e[n])})),t}(t),u=function(e,t,n,i){function r(e,t,n){var r=t[n];if(r[Uu]&&i){var o=e[qu]||{};!1!==o[zu]&&(r=(o[t[Wu]]||{})[n]||r)}return function(){return r.apply(e,arguments)}}var o=dd();sd(n,(function(e){o[e]=r(t,n,e)}));for(var a=ad(e),s=[];a&&!od(a)&&!cd(s,a);)sd(a,(function(e){!o[e]&&ld(a,e,!Xu)&&(o[e]=r(t,a,e))})),s.push(a),a=ad(a);return o}(r,t,l,s);n(t,u);var d=!!Xu&&!!a[Ju];d&&i&&(d=!!i[Ju]),hd(r,o,t,l,!1!==d)}pd[Hu]=nd.o;var fd="window",md="document",vd="navigator",yd="location",_d="performance",bd="JSON",Cd="crypto",Td="msCrypto",Sd="msie",Id="trident/",wd="XMLHttpRequest",Ed=null,xd=null,Ad=!1,Dd=null,Nd=null;function Fd(e,t){var n=!1;if(e){try{if(!(n=t in e)){var i=e[Ta];i&&(n=t in i)}}catch(e){}if(!n)try{n=!_l((new e)[t])}catch(e){}}return n}function Pd(e){var t=Fa();return t&&t[e]?t[e]:e===fd&&kd()?window:null}function kd(){return Boolean(typeof window===ba&&window)}function Od(){return kd()?window:Pd(fd)}function Bd(){return Boolean(typeof document===ba&&document)?document:Pd(md)}function Rd(){return Boolean(typeof navigator===ba&&navigator)}function Ld(){return Rd()?navigator:Pd(vd)}function Md(e){if(e&&Ad){var t=Pd("__mockLocation");if(t)return t}return typeof location===ba&&location?location:Pd(yd)}function qd(){return Boolean(typeof JSON===ba&&JSON||null!==Pd(bd))}function Ud(){return qd()?JSON||Pd(bd):null}function Wd(){var e=Ld();return!(!e||!e.product)&&"ReactNative"===e.product}function jd(){var e=Ld();if(e&&(e[ps]!==xd||null===Ed)){var t=((xd=e[ps])||Os)[Ts]();Ed=Al(t,Sd)||Al(t,Id)}return Ed}function zd(e){var t=Object[Ta].toString[Ss](e),n=Os;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[Ba]+"'":qd()&&(n=Ud().stringify(e)),t+n}function Hd(){return null===Nd&&(Nd=Rd()&&Boolean(Ld().sendBeacon)),Nd}function Vd(e){var t=!1;try{t=!!Pd("fetch");var n=Pd("Request");t&&e&&n&&(t=Fd(n,"keepalive"))}catch(e){}return t}function Gd(){var e=!1;try{e=!!Pd(wd)}catch(e){}return e}var Qd,Kd=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],$d=null;function Zd(e,t){return function(){var n=arguments,i=Jd(t);if(i){var r=i.listener;r&&r[e]&&r[e][_s](r,n)}}}function Jd(e){var t,n=$d;return n||!0===e.disableDbgExt||(n=$d||((t=Pd("Microsoft"))&&($d=t.ApplicationInsights),$d)),n?n.ChromeDbgExt:null}function Yd(e){if(!Qd){Qd={};for(var t=0;t<Kd[za];t++)Qd[Kd[t]]=Zd(Kd[t],e)}return Qd}function Xd(e){return e?'"'+e[bs](/\"/g,Os)+'"':Os}function ec(e,t){var n=typeof console!==Ca?console:Pd("console");if(n){var i="log";n[e]&&(i=e),Il(n[i])&&n[i](t)}}var tc=function(){function e(e,t,n,i){void 0===n&&(n=!1);var r=this;r[ns]=e,r[is]=(n?"AI: ":"AI (Internal): ")+e;var o=Os;qd()&&(o=Ud().stringify(i));var a=(t?" message:"+Xd(t):Os)+(i?" props:"+Xd(o):Os);r[is]+=a}return e.dataType="MessageData",e}(),nc=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,i,r,o,a=0,s={};pd(e,this,(function(e){function l(t,n){if(!(a>=r)){var o=!0,l="AITR_"+n[ns];if(s[l]?o=!1:s[l]=!0,o&&(t<=i&&(e.queue[Ma](n),a++,u(1===t?"error":"warn",n)),a===r)){var d="Internal events throttle limit per PageView reached for this app.",c=new tc(23,d,!1);e.queue[Ma](c),1===t?e[Gs](d):e[Qs](d)}}}function u(e,n){var i=Jd(t||{});i&&i[ls]&&i[ls](e,n)}!function(e){n=Ql(e.loggingLevelConsole,0),i=Ql(e.loggingLevelTelemetry,1),r=Ql(e.maxMessageLimit,25),o=Ql(e.enableDebug,Ql(e[Cs],!1))}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return i},e.maxInternalMessageLimit=function(){return r},e[Cs]=function(){return o},e.throwInternal=function(t,i,r,a,d){void 0===d&&(d=!1);var c=new tc(i,r,d,a);if(o)throw zd(c);var h=1===t?Gs:Qs;if(_l(c[is]))u("throw"+(1===t?"Critical":"Warning"),c);else{if(d){var g=+c[ns];!s[g]&&n>=t&&(e[h](c[is]),s[g]=!0)}else n>=t&&e[h](c[is]);l(t,c)}},e[Qs]=function(e){ec("warn",e),u("warning",e)},e[Gs]=function(e){ec("error",e),u("error",e)},e.resetInternalMessageCount=function(){a=0,s={}},e.logInternalMessage=l}))}return e.__ieDyn=1,e}();function ic(e){return e||new nc}function rc(e,t,n,i,r,o){void 0===o&&(o=!1),ic(e).throwInternal(t,n,i,r,o)}function oc(e,t){ic(e)[Qs](t)}var ac="toGMTString",sc="toUTCString",lc="cookie",uc="expires",dc="enabled",cc="isCookieUseDisabled",hc="disableCookiesUsage",gc="_ckMgr",pc=null,fc=null,mc=null,vc=Bd(),yc={},_c={};function bc(e){return!e||e.isEnabled()}function Cc(e,t){return!!(t&&e&&Dl(e.ignoreCookies))&&-1!==e.ignoreCookies[hs](t)}function Tc(e,t){var n,i=function(e){var t=e[cs]=e[cs]||{};if(Vl(t,"domain",e.cookieDomain,Cl,bl),Vl(t,"path",e.cookiePath||"/",null,bl),bl(t[dc])){var n=void 0;_l(e[cc])||(n=!e[cc]),_l(e[hc])||(n=!e[hc]),t[dc]=n}return t}(e||_c),r=i.path||"/",o=i.domain,a=!1!==i[dc],s=((n={isEnabled:function(){var e=a&&Sc(t),n=_c[gc];return e&&n&&s!==n&&(e=bc(n)),e}})[ms]=function(e){a=!1!==e},n.set=function(e,t,n,a,l){var u,d=!1;if(bc(s)&&!function(e,t){return!!(t&&e&&Dl(e.blockedCookies)&&-1!==e.blockedCookies[hs](t))||Cc(e,t)}(i,e)){var c={},h=Ll(t||Os),g=h[hs](";");if(-1!==g&&(h=Ll(t[gs](0,g)),c=Ic(t[gs](g+1))),Vl(c,"domain",a||o,Kl,_l),!bl(n)){var p=jd();if(_l(c[uc])){var f=zl()+1e3*n;if(f>0){var m=new Date;m.setTime(f),Vl(c,uc,wc(m,p?ac:sc)||wc(m,p?ac:sc)||Os,Kl)}}p||Vl(c,"max-age",Os+n,null,_l)}var v=Md();v&&"https:"===v.protocol&&(Vl(c,"secure",null,null,_l),null===fc&&(u=(Ld()||{})[ps],fc=!(Nl(u)&&(Al(u,"CPU iPhone OS 12")||Al(u,"iPad; CPU OS 12")||Al(u,"Macintosh; Intel Mac OS X 10_14")&&Al(u,"Version/")&&Al(u,"Safari")||Al(u,"Macintosh; Intel Mac OS X 10_14")&&function(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=ll?e[Zs](t):function(e,t){var n=!1,i=t?t[za]:0,r=e?e[za]:0;if(i&&r&&r>=i&&!(n=e===t)){for(var o=r-1,a=i-1;a>=0;a--){if(e[o]!=t[a])return!1;o--}n=!0}return n}(e,t)),n}(u,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Al(u,"Chrome/5")||Al(u,"Chrome/6")||Al(u,"UnrealEngine")&&!Al(u,"Chrome")||Al(u,"UCBrowser/12")||Al(u,"UCBrowser/11")))),fc&&Vl(c,"SameSite","None",null,_l)),Vl(c,"path",l||r,null,_l),(i.setCookie||Ac)(e,Ec(h,c)),d=!0}return d},n.get=function(e){var t=Os;return bc(s)&&!Cc(i,e)&&(t=(i.getCookie||xc)(e)),t},n.del=function(e,t){var n=!1;return bc(s)&&(n=s.purge(e,t)),n},n.purge=function(e,n){var r,o=!1;if(Sc(t)){var a=((r={}).path=n||"/",r[uc]="Thu, 01 Jan 1970 00:00:01 GMT",r);jd()||(a["max-age"]="0"),(i.delCookie||Ac)(e,Ec(Os,a)),o=!0}return o},n);return s[gc]=s,s}function Sc(e){if(null===pc){pc=!1;try{pc=void 0!==(vc||{})[lc]}catch(t){rc(e,2,68,"Cannot access document.cookie - "+Hl(t),{exception:zd(t)})}}return pc}function Ic(e){var t={};return e&&e[za]&&Bl(Ll(e)[fs](";"),(function(e){if(e=Ll(e||Os)){var n=e[hs]("=");-1===n?t[e]=null:t[Ll(e[gs](0,n))]=Ll(e[gs](n+1))}})),t}function wc(e,t){return Il(e[t])?e[t]():null}function Ec(e,t){var n=e||Os;return El(t,(function(e,t){n+="; "+e+(bl(t)?Os:"="+t)})),n}function xc(e){var t=Os;if(vc){var n=vc[lc]||Os;mc!==n&&(yc=Ic(n),mc=n),t=Ll(yc[e]||Os)}return t}function Ac(e,t){vc&&(vc[lc]=e+"="+t)}var Dc=4294967296,Nc=4294967295,Fc=!1,Pc=123456789,kc=987654321;function Oc(){try{var e=2147483647&zl();(t=(Math.random()*Dc^e)+e)<0&&(t>>>=0),Pc=123456789+t&Nc,kc=987654321-t&Nc,Fc=!0}catch(e){}var t}function Bc(e){var t=0,n=Pd(Cd)||Pd(Td);return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&Nc),0===t&&jd()&&(Fc||Oc(),t=function(e){var t=((kc=36969*(65535&kc)+(kc>>16)&Nc)<<16)+(65535&(Pc=18e3*(65535&Pc)+(Pc>>16)&Nc))>>>0&Nc;return e||(t>>>=0),t}()&Nc),0===t&&(t=Math.floor(Dc*Math.random()|0)),e||(t>>>=0),t}var Rc=Aa,Lc="2.8.18",Mc="."+function(e){void 0===e&&(e=22);for(var t=Bc()>>>0,n=0,i=Os;i[za]<e;)n++,i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Bc()<<2&4294967295|3&t)>>>0,n=0);return i}(6),qc=0;function Uc(e){return 1===e[ys]||9===e[ys]||!+e[ys]}function Wc(e,t){return void 0===t&&(t=!1),wl(e+qc+++(t?"."+Lc:Os)+Mc)}function jc(e){var t={id:Wc("_aiData-"+(e||Os)+"."+Lc),accept:function(e){return Uc(e)},get:function(e,n,i,r){var o=e[t.id];return o?o[wl(n)]:(r&&((o=function(e,t){var n=t[e.id];if(!n){n={};try{Uc(t)&&(function(e,t,n){if(Rc)try{return Rc(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[wl(n)]=i),i)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var zc="on",Hc="attachEvent",Vc="addEventListener",Gc="detachEvent",Qc="removeEventListener",Kc="events",$c="visibilitychange",Zc="pagehide",Jc="pageshow",Yc="unload",Xc="beforeunload",eh=Wc("aiEvtPageHide"),th=Wc("aiEvtPageShow"),nh=/\.[\.]+/g,ih=/[\.]+$/,rh=1,oh=jc("events"),ah=/^([^.]*)(?:\.(.+)|)/;function sh(e){return e&&e[bs]?e[bs](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,Os):e}function lh(e,t){var n;if(t){var i=Os;Dl(t)?(i=Os,Bl(t,(function(e){(e=sh(e))&&("."!==e[0]&&(e="."+e),i+=e)}))):i=sh(t),i&&("."!==i[0]&&(i="."+i),e=(e||Os)+i)}var r=ah.exec(e||Os)||[];return(n={})[Is]=r[1],n.ns=(r[2]||Os).replace(nh,".").replace(ih,Os)[fs](".").sort().join("."),n}function uh(e,t,n){void 0===n&&(n=!0);var i=oh.get(e,Kc,{},n),r=i[t];return r||(r=i[t]=[]),r}function dh(e,t,n,i){e&&t&&t[Is]&&(e[Qc]?e[Qc](t[Is],n,i):e[Gc]&&e[Gc](zc+t[Is],n))}function ch(e,t,n,i){for(var r=t[za];r--;){var o=t[r];o&&(n.ns&&n.ns!==o.evtName.ns||i&&!i(o)||(dh(e,o.evtName,o[ws],o.capture),t[es](r,1)))}}function hh(e,t){return t?lh("xx",Dl(t)?[e].concat(t):[e,t]).ns[fs]("."):e}function gh(e,t,n,i,r){var o;void 0===r&&(r=!1);var a=!1;if(e)try{var s=lh(t,i);if(a=function(e,t,n,i){var r=!1;return e&&t&&t[Is]&&n&&(e[Vc]?(e[Vc](t[Is],n,i),r=!0):e[Hc]&&(e[Hc](zc+t[Is],n),r=!0)),r}(e,s,n,r),a&&oh.accept(e)){var l=((o={guid:rh++,evtName:s})[ws]=n,o.capture=r,o);uh(e,s.type)[Ma](l)}}catch(e){}return a}function ph(e,t,n,i,r){if(void 0===r&&(r=!1),e)try{var o=lh(t,i),a=!1;!function(e,t,n){if(t[Is])ch(e,uh(e,t[Is]),t,n);else{var i=oh.get(e,Kc,{});El(i,(function(i,r){ch(e,r,t,n)})),0===Ul(i)[za]&&oh.kill(e,Kc)}}(e,o,(function(e){return!((!o.ns||n)&&e[ws]!==n||(a=!0,0))})),a||dh(e,o,n,r)}catch(e){}}function fh(e,t,n,i){var r=!1;return t&&e&&e[za]>0&&Bl(e,(function(e){e&&(n&&-1!==Rl(n,e)||(r=function(e,t,n){var i=!1,r=Od();r&&(i=gh(r,e,t,n),i=gh(r.body,e,t,n)||i);var o=Bd();return o&&(i=gh(o,e,t,n)||i),i}(e,t,i)||r))})),r}function mh(e,t,n){e&&Dl(e)&&Bl(e,(function(e){e&&function(e,t,n){var i=Od();i&&(ph(i,e,t,n),ph(i.body,e,t,n));var r=Bd();r&&ph(r,e,t,n)}(e,t,n)}))}function vh(e,t,n){var i=hh(eh,n),r=fh([Zc],e,t,i);return t&&-1!==Rl(t,$c)||(r=fh([$c],(function(t){var n=Bd();e&&n&&"hidden"===n.visibilityState&&e(t)}),t,i)||r),!r&&t&&(r=vh(e,null,n)),r}function yh(e,t,n){var i=hh(th,n),r=fh([Jc],e,t,i);return!(r=fh([$c],(function(t){var n=Bd();e&&n&&"visible"===n.visibilityState&&e(t)}),t,i)||r)&&t&&(r=yh(e,null,n)),r}function _h(){var e=function(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=Os,i=0;i<4;i++)n+=t[15&(e=Bc())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var r=t[8+(3&Bc())|0];return n[vs](0,8)+n[vs](9,4)+"4"+n[vs](13,3)+r+n[vs](16,3)+n[vs](19,12)}();return e[gs](0,8)+"-"+e[gs](8,12)+"-"+e[gs](12,16)+"-"+e[gs](16,20)+"-"+e[gs](20)}var bh=((Fa()||{}).Symbol,(Fa()||{}).Reflect,function(e,t){return bh=Ia.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[Sa](n)&&(e[n]=t[n])},bh(e,t)});function Ch(e,t){function n(){this.constructor=e}typeof t!==_a&&null!==t&&Pa("Class extends value "+String(t)+" is not a constructor or null"),bh(e,t),e[Ta]=null===t?ka(t):(n[Ta]=t[Ta],new n)}function Th(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e}var Sh="ctx",Ih="ParentContextKey",wh="ChildrenContextKey",Eh=function(){function e(t,n,i){var r,o=this,a=!1;o.start=zl(),o[Ba]=t,o[rs]=i,o[xs]=function(){return!1},Il(n)&&(a=Wl(o,"payload",(function(){return!r&&Il(n)&&(r=n(),n=null),r}))),o[As]=function(t){return t?t===e[Ih]||t===e[wh]?o[t]:(o[Sh]||{})[t]:null},o[Ds]=function(t,n){t&&(t===e[Ih]?(o[t]||(o[xs]=function(){return!0}),o[t]=n):t===e[wh]?o[t]=n:(o[Sh]=o[Sh]||{})[t]=n)},o[Ns]=function(){var t=0,i=o[As](e[wh]);if(Dl(i))for(var r=0;r<i[za];r++){var s=i[r];s&&(t+=s[Ha])}o[Ha]=zl()-o.start,o.exTime=o[Ha]-t,o[Ns]=function(){},!a&&Il(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),xh=function(){function e(t){this.ctx={},pd(e,this,(function(e){e.create=function(e,t,n){return new Eh(e,t,n)},e.fire=function(e){e&&(e[Ns](),t&&Il(t[Vs])&&t[Vs](e))},e[Ds]=function(t,n){t&&((e[Sh]=e[Sh]||{})[t]=n)},e[As]=function(t){return(e[Sh]||{})[t]}}))}return e.__ieDyn=1,e}(),Ah="CoreUtils.doPerf";function Dh(e,t,n,i,r){if(e){var o=e;if(o[Ks]&&(o=o[Ks]()),o){var a=void 0,s=o[As](Ah);try{if(a=o.create(t(),i,r)){if(s&&a[Ds]&&(a[Ds](Eh[Ih],s),s[As]&&s[Ds])){var l=s[As](Eh[wh]);l||(l=[],s[Ds](Eh[wh],l)),l[Ma](a)}return o[Ds](Ah,a),n(a)}}catch(e){a&&a[Ds]&&a[Ds]("exception",e)}finally{a&&o.fire(a),o[Ds](Ah,s)}}}return n()}function Nh(e,t,n){return!(!e||e[za]!==t||e===n||!e.match(/^[\da-f]*$/i))}var Fh=jc("plugin");function Ph(e){return Fh.get(e,"state",{},!0)}function kh(e,t){for(var n,i=[],r=null,o=e[ss]();o;){var a=o[Ja]();a&&(r&&Il(r[us])&&Il(a[Us])&&r[us](a),(Il(a[qa])?a[qa]():(n=Ph(a))[qa])||i[Ma](a),r=a,o=o[ss]())}Bl(i,(function(i){var r=e[Rs]();i[Oa](e.getCfg(),r,t,e[ss]()),n=Ph(i),i[Rs]||n[Rs]||(n[Rs]=r),n[qa]=!0,delete n[ts]}))}function Oh(e){return e.sort((function(e,t){var n=0;if(t){var i=Il(t[Us]);Il(e[Us])?n=i?e[Ws]-t[Ws]:1:i&&(n=-1)}else n=e?1:-1;return n}))}var Bh="TelemetryPluginChain",Rh="_hasRun",Lh="_getTelCtx",Mh=0;function qh(e,t,n,i){var r=null,o=[];null!==i&&(r=i?function(e,t,n){for(;e;){if(e[Ja]()===n)return e;e=e[ss]()}return zh([n],t[Ua]||{},t)}(e,n,i):e);var a={_next:function(){var e=r;if(r=e?e[ss]():null,!e){var t=o;t&&t[za]>0&&(Bl(t,(function(e){try{e.func[Ss](e.self,e.args)}catch(e){rc(n[ja],2,73,"Unexpected Exception during onComplete - "+zd(e))}})),o=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{})[ja]||new nc(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,i){void 0===i&&(i=!1);var r,o=s(e,null);return o&&!bl(o[n])?r=o[n]:t&&!bl(t[n])&&(r=t[n]),bl(r)?i:r},hasNext:function(){return!!r},getNext:function(){return r},setNext:function(e){r=e},iterate:function(e){for(var t;t=a._next();){var n=t[Ja]();n&&e(n)}},onComplete:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];e&&o[Ma]({func:e,self:_l(t)?a.ctx:t,args:n})}}};function s(e,n,i){var r;if(void 0===n&&(n={}),void 0===i&&(i=0),t){var o=t[qs];o&&e&&(r=o[e])}if(r){if(Sl(n)&&0!==i){var a=Yl(!0,n,r);t&&2===i&&El(n,(function(e){if(bl(a[e])){var n=t[e];bl(n)||(a[e]=n)}})),r=a}}else r=n;return r}return a}function Uh(e,t,n,i){var r=qh(e,t,n,i),o=r.ctx;return o[Va]=function(e){var t=r._next();return t&&t[Us](e,o),!t},o[ds]=function(e,i){return void 0===e&&(e=null),Dl(e)&&(e=zh(e,t,n,i)),Uh(e||o[ss](),t,n,i)},o}function Wh(e,t,n){var i=t[Ua]||{},r=qh(e,i,t,n),o=r.ctx;return o[Va]=function(e){var t=r._next();return t&&t.unload(o,e),!t},o[ds]=function(e,n){return void 0===e&&(e=null),Dl(e)&&(e=zh(e,i,t,n)),Wh(e||o[ss](),t,n)},o}function jh(e,t,n){var i=t[Ua]||{},r=qh(e,i,t,n).ctx;return r[Va]=function(e){return r.iterate((function(t){Il(t[as])&&t[as](r,e)}))},r[ds]=function(e,n){return void 0===e&&(e=null),Dl(e)&&(e=zh(e,i,t,n)),jh(e||r[ss](),t,n)},r}function zh(e,t,n,i){var r=null,o=!i;if(Dl(e)&&e[za]>0){var a=null;Bl(e,(function(e){if(o||i!==e||(o=!0),o&&e&&Il(e[Us])){var s=function(e,t,n){var i,r=null,o=Il(e[Us]),a=Il(e[us]),s={getPlugin:function(){return e},getNext:function(){return r},processTelemetry:function(i,u){l(u=u||function(){var i;return e&&Il(e[Lh])&&(i=e[Lh]()),i||(i=Uh(s,t,n)),i}(),(function(t){if(!e||!o)return!1;var n=Ph(e);return!n[ts]&&!n[Ms]&&(a&&e[us](r),e[Us](i,t),!0)}),"processTelemetry",(function(){return{item:i}}),!i.sync)||u[Va](i)},unload:function(t,n){l(t,(function(){var i=!1;if(e){var r=Ph(e),o=e[Rs]||r[Rs];!e||o&&o!==t.core()||r[ts]||(r[Rs]=null,r[ts]=!0,r[qa]=!1,e[ts]&&!0===e[ts](t,n)&&(i=!0))}return i}),"unload",(function(){}),n[rs])||t[Va](n)},update:function(t,n){l(t,(function(){var i=!1;if(e){var r=Ph(e),o=e[Rs]||r[Rs];!e||o&&o!==t.core()||r[ts]||e[as]&&!0===e[as](t,n)&&(i=!0)}return i}),"update",(function(){}),!1)||t[Va](n)},_id:i=e?e[La]+"-"+e[Ws]+"-"+Mh++:"Unknown-0-"+Mh++,_setNext:function(e){r=e}};function l(t,n,o,a,s){var l=!1,u=e?e[La]:Bh,d=t[Rh];return d||(d=t[Rh]={}),t.setNext(r),e&&Dh(t[Rs](),(function(){return u+":"+o}),(function(){d[i]=!0;try{var e=r?r._id:Os;e&&(d[e]=!1),l=n(t)}catch(e){var a=!r||d[r._id];a&&(l=!0),r&&a||rc(t[ls](),1,73,"Plugin ["+u+"] failed during "+o+" - "+zd(e)+", run flags: "+zd(d))}}),a,s),l}return jl(s)}(e,t,n);r||(r=s),a&&a._setNext(s),a=s}}))}return i&&!r?zh([i],t,n):r}var Hh=500;function Vh(e,t,n){t&&Dl(t)&&t[za]>0&&(Bl(t=t.sort((function(e,t){return e[Ws]-t[Ws]})),(function(e){e[Ws]<Hh&&$l("Channel has invalid priority - "+e[La])})),e[Ma]({queue:jl(t),chain:zh(t,n[Ua],n)}))}function Gh(){var e=[];return{add:function(t){t&&e[Ma](t)},run:function(t,n){Bl(e,(function(e){try{e(t,n)}catch(e){rc(t[ls](),2,73,"Unexpected error calling unload handler - "+zd(e))}})),e=[]}}}var Qh="getPlugin",Kh=function(){function e(){var t,n,i,r,o,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var r=n||Uh(null,{},a[Rs]);t=i&&i[Qh]?r[ds](null,i[Qh]):r[ds](null,i)}return t}function l(e,t,r){e&&Vl(e,qs,[],null,bl),!r&&t&&(r=t[Ga]()[ss]());var o=i;i&&i[Qh]&&(o=i[Qh]()),a[Rs]=t,n=Uh(r,e,t,o)}function u(){t=!1,a[Rs]=null,n=null,i=null,o=[],r=Gh()}u(),pd(e,a,(function(e){e[Oa]=function(e,n,i,r){l(e,n,r),t=!0},e[ts]=function(t,n){var a,s=e[Rs];if(s&&(!t||s===t[Rs]())){var l,d=!1,c=t||Wh(null,s,i&&i[Qh]?i[Qh]():i),h=n||((a={reason:0})[rs]=!1,a);return e[os]&&!0===e[os](c,h,g)?l=!0:g(),l}function g(){if(!d){d=!0,r.run(c,n);var e=o;o=[],Bl(e,(function(e){e.rm()})),!0===l&&c[Va](h),u()}}},e[as]=function(t,n){var r=e[Rs];if(r&&(!t||r===t[Rs]())){var o,a=!1,s=t||jh(null,r,i&&i[Qh]?i[Qh]():i),u=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,u,d)?o=!0:d(),o}function d(){a||(a=!0,l(s.getCfg(),s.core(),s[ss]()))}},e._addHook=function(e){e&&(Dl(e)?o=o.concat(e):o[Ma](e))},Zl(e,"_addUnloadCb",(function(){return r}),"add")})),a[ls]=function(e){return s(e)[ls]()},a[qa]=function(){return t},a.setInitialized=function(e){t=e},a[us]=function(e){i=e},a[Va]=function(e,t){t?t[Va](e):i&&Il(i[Us])&&i[Us](e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}(),$h=function(e){function t(){var n,i,r=e.call(this)||this;function o(){n=0,i=[]}return r.identifier="TelemetryInitializerPlugin",r.priority=199,o(),pd(t,r,(function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return i[Ma](t),{remove:function(){Bl(i,(function(e,n){if(e.id===t.id)return i[es](n,1),-1}))}}},e[Us]=function(t,n){for(var r=!1,o=i[za],a=0;a<o;++a){var s=i[a];if(s)try{if(!1===s.fn[_s](null,[t])){r=!0;break}}catch(e){rc(n[ls](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Hl(e),{exception:zd(e)},!0)}}r||e[Va](t,n)},e[os]=function(){o()}})),r}return Ch(t,e),t.__ieDyn=1,t}(Kh),Zh="Plugins must provide initialize method",Jh="_notificationManager",Yh="SDK is still unloading...",Xh={loggingLevelConsole:1};function eg(e,t){return new xh(t)}function tg(e,t){var n=!1;return Bl(t,(function(t){if(t===e)return n=!0,-1})),n}var ng=function(){function e(){var t,n,i,r,o,a,s,l,u,d,c,h,g,p,f,m,v,y,_,b,C=0,T=!1;pd(e,this,(function(e){function S(n){if(!C&&!T&&(n||e[ja]&&e[ja].queue[za]>0)){var i=Ql(t.diagnosticLogInterval);i&&i>0||(i=1e4),C=setInterval((function(){clearInterval(C),C=0,N()}),i)}return C}function I(){n=!1,t=Yl(!0,{},Xh),e[Ua]=t,e[ja]=new nc(t),e[Xa]=[],f=new $h,i=[],r=null,o=null,a=null,s=null,l=null,d=null,u=[],c=null,h=null,g=null,p=!1,m=null,v=Wc("AIBaseCore",!0),y=Gh(),b=null}function w(){var n=Uh(A(),t,e);return n[Za](S),n}function E(n){var i=function(e,t,n){var i,r=[],o={};return Bl(n,(function(t){(bl(t)||bl(t[Oa]))&&$l(Zh);var n=t[Ws],i=t[La];t&&n&&(bl(o[n])?o[n]=i:oc(e,"Two extensions have same priority #"+n+" - "+o[n]+", "+i)),(!n||n<500)&&r[Ma](t)})),(i={all:n})[Rs]=r,i}(e[ja],0,u);d=i[Rs],l=null;var r=i.all;if(g=jl(function(e,t,n){var i=[];if(e&&Bl(e,(function(e){return Vh(i,e,n)})),t){var r=[];Bl(t,(function(e){e[Ws]>Hh&&r[Ma](e)})),Vh(i,r,n)}return i}(h,r,e)),c){var o=Rl(r,c);-1!==o&&r[es](o,1),-1!==(o=Rl(d,c))&&d[es](o,1),c._setQueue(g)}else c=function(e,t){function n(){return Uh(null,t[Ua],t,null)}function i(e,t,n,i){var r=e?e[za]+1:1;function o(){0==--r&&(i&&i(),i=null)}r>0&&Bl(e,(function(e){if(e&&e.queue[za]>0){var i=e.chain,a=t[ds](i);a[Za](o),n(a)}else r--})),o()}var r=!1,o={identifier:"ChannelControllerPlugin",priority:Hh,initialize:function(t,n,i,o){r=!0,Bl(e,(function(e){e&&e.queue[za]>0&&kh(Uh(e.chain,t,n),i)}))},isInitialized:function(){return r},processTelemetry:function(t,r){i(e,r||n(),(function(e){e[Va](t)}),(function(){r[Va](t)}))},update:function(t,n){var r=n||{reason:0};return i(e,t,(function(e){e[Va](r)}),(function(){t[Va](r)})),!0},pause:function(){i(e,n(),(function(e){e.iterate((function(e){e.pause&&e.pause()}))}),null)},resume:function(){i(e,n(),(function(e){e.iterate((function(e){e.resume&&e.resume()}))}),null)},teardown:function(t,n){var o=n||{reason:0,isAsync:!1};return i(e,t,(function(e){e[Va](o)}),(function(){t[Va](o),r=!1})),!0},getChannel:function(t){var n=null;return e&&e[za]>0&&Bl(e,(function(e){if(e&&e.queue[za]>0&&(Bl(e.queue,(function(e){if(e[La]===t)return n=e,-1})),n))return-1})),n},flush:function(t,r,o,a){var s=1,l=!1,u=null;function d(){s--,l&&0===s&&(u&&(clearTimeout(u),u=null),r&&r(l),r=null)}return a=a||5e3,i(e,n(),(function(e){e.iterate((function(e){if(e[Ya]){s++;var n=!1;e[Ya](t,(function(){n=!0,d()}),o)||n||(t&&null==u?u=setTimeout((function(){u=null,d()}),a):d())}}))}),(function(){l=!0,d()})),!0},_setQueue:function(t){e=t}};return o}(g,e);r[Ma](c),d[Ma](c),e[Xa]=Oh(r),c[Oa](t,e,r),kh(w(),r),e[Xa]=jl(Oh(d||[])).slice(),n&&function(t){var n=jh(A(),e);n[Za](S),e._updateHook&&!0===e._updateHook(n,t)||n[Va](t)}(n)}function x(t){var n,i=null,r=null;return Bl(e[Xa],(function(e){if(e[La]===t&&e!==c&&e!==f)return r=e,-1})),!r&&c&&(r=c.getChannel(t)),r&&((n={plugin:r})[ms]=function(e){Ph(r)[Ms]=!e},n.isEnabled=function(){var e=Ph(r);return!e[ts]&&!e[Ms]},n.remove=function(e,t){var n;void 0===e&&(e=!0);var i=[r],o=((n={reason:1})[rs]=e,n);D(i,o,(function(e){e&&E({reason:32,removed:i}),t&&t(e)}))},i=n),i}function A(){if(!l){var n=(d||[]).slice();-1===Rl(n,f)&&n[Ma](f),l=zh(Oh(n),t,e)}return l}function D(n,i,r){if(n&&n[za]>0){var o=Wh(zh(n,t,e),e);o[Za]((function(){var e=!1,t=[];Bl(u,(function(i,r){tg(i,n)?e=!0:t[Ma](i)})),u=t;var i=[];h&&(Bl(h,(function(t,r){var o=[];Bl(t,(function(t){tg(t,n)?e=!0:o[Ma](t)})),i[Ma](o)})),h=i),r&&r(e),S()})),o[Va](i)}else r(!1)}function N(){if(e[ja]&&e[ja].queue){var n=e[ja].queue.slice(0);e[ja].queue[za]=0,Bl(n,(function(n){var i,r=((i={})[Ba]=m||"InternalMessageId: "+n[ns],i.iKey=Ql(t[Wa]),i.time=Ol(new Date),i.baseType=tc.dataType,i.baseData={message:n[is]},i);e.track(r)}))}}function F(e,t,n,i){return c?c[Ya](e,t,n||6,i):(t&&t(!1),!0)}function P(t){var n=e[ja];n?(rc(n,2,73,t),S()):$l(t)}var k,O,B,R;I(),e[qa]=function(){return n},e[Oa]=function(i,o,s,l){var d,c;p&&$l(Yh),e[qa]()&&$l("Core should not be initialized more than once"),t=i||{},e[Ua]=t,bl(i[Wa])&&$l("Please provide instrumentation key"),r=l,e[Jh]=l,!0===(c=Ql(t.disableDbgExt))&&_&&(r[Ka](_),_=null),r&&!_&&!0!==c&&(_=Yd(t),r[Qa](_)),!(d=Ql(t.enablePerfMgr))&&a&&(a=null),d&&Gl(t,Ls,eg),Gl(t,qs,{}).NotificationManager=r,s&&(e[ja]=s);var f=Gl(t,"extensions",[]);(u=[])[Ma].apply(u,Th(Th([],o),f)),h=Gl(t,Bs,[]),E(null),g&&0!==g[za]||$l("No "+Bs+" available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return g&&Bl(g,(function(t){e[Ma](t.queue)})),jl(e)},e.track=function(n){n.iKey=n.iKey||t[Wa],n[Ha]=n[Ha]||Ol(new Date),n.ver=n.ver||"4.0",!p&&e[qa]()?w()[Va](n):i[Ma](n)},e[Ga]=w,e[Ra]=function(){return r||(r=function(){var e;return ka(((e={})[Qa]=function(e){},e[Ka]=function(e){},e[js]=function(e){},e[zs]=function(e,t){},e[Hs]=function(e,t){},e))}(),e[Jh]=r),r},e[Qa]=function(e){r&&r[Qa](e)},e[Ka]=function(e){r&&r[Ka](e)},e.getCookieMgr=function(){return s||(s=Tc(t,e[ja])),s},e.setCookieMgr=function(e){s=e},e[Ks]=function(){if(!o&&!a&&Ql(t.enablePerfMgr)){var n=Ql(t[Ls]);Il(n)&&(a=n(e,e[Ra]()))}return o||a||null},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return i[za]},e.releaseQueue=function(){if(n&&i[za]>0){var e=i;i=[],Bl(e,(function(e){w()[Va](e)}))}},e.pollInternalLogs=function(e){return m=e||null,T=!1,C&&(clearInterval(C),C=null),S(!0)},e[$a]=function(){T=!0,C&&(clearInterval(C),C=0,N())},O=function(){return f},B=["addTelemetryInitializer"],(k=e)&&O&&Sl(k)&&Dl(B)&&Bl(B,(function(e){Nl(e)&&Zl(k,e,O,e,R)})),e.unload=function(t,i,r){var o;void 0===t&&(t=!0),n||$l("SDK is not initialized"),p&&$l(Yh);var a=((o={reason:50})[rs]=t,o.flushComplete=!1,o),s=Wh(A(),e);function l(t){a.flushComplete=t,p=!0,y.run(s,a),e[$a](),s[Va](a)}s[Za]((function(){I(),i&&i(a)}),e),N(),F(t,l,6,r)||l(!1)},e[Ja]=x,e.addPlugin=function(e,t,n,i){if(!e)return i&&i(!1),void P(Zh);var r=x(e[La]);if(r&&!t)return i&&i(!1),void P("Plugin ["+e[La]+"] is already loaded!");var o={reason:16};function a(t){u[Ma](e),o.added=[e],E(o),i&&i(!0)}if(r){var s=[r.plugin];D(s,{reason:2,isAsync:!!n},(function(e){e?(o.removed=s,o.reason|=32,a()):i&&i(!1)}))}else a()},e.evtNamespace=function(){return v},e[Ya]=F,e.getTraceCtx=function(e){var t;return b||(t={},b={getName:function(){return t[Ba]},setName:function(e){t[Ba]=e},getTraceId:function(){return t[Fs]},setTraceId:function(e){Nh(e,32,"00000000000000000000000000000000")&&(t[Fs]=e)},getSpanId:function(){return t[Ps]},setSpanId:function(e){Nh(e,16,"0000000000000000")&&(t[Ps]=e)},getTraceFlags:function(){return t[ks]},setTraceFlags:function(e){t[ks]=e}}),b},e.setTraceCtx=function(e){b=e||null},Zl(e,"addUnloadCb",(function(){return y}),"add")}))}return e.__ieDyn=1,e}();function ig(e,t,n,i){Bl(e,(function(e){if(e&&e[t])if(n)setTimeout((function(){return i(e)}),0);else try{i(e)}catch(e){}}))}var rg,og=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;pd(e,this,(function(e){e[Qa]=function(t){e.listeners[Ma](t)},e[Ka]=function(t){for(var n=Rl(e[Es],t);n>-1;)e.listeners[es](n,1),n=Rl(e[Es],t)},e[js]=function(t){ig(e[Es],js,!0,(function(e){e[js](t)}))},e[zs]=function(t,n){ig(e[Es],zs,!0,(function(e){e[zs](t,n)}))},e[Hs]=function(t,n){ig(e[Es],Hs,n,(function(e){e[Hs](t,n)}))},e[Vs]=function(t){t&&(!n&&t[xs]()||ig(e[Es],Vs,!1,(function(e){t[rs]?setTimeout((function(){return e[Vs](t)}),0):e[Vs](t)})))}}))}return e.__ieDyn=1,e}(),ag=function(e){function t(){var n=e.call(this)||this;return pd(t,n,(function(e,t){function n(t){var n=e[Ra]();n&&n[zs]([t],2)}e[Oa]=function(e,n,i,r){t[Oa](e,n,i||new nc(e),r||new og(e))},e.track=function(i){Dh(e[Ks](),(function(){return"AppInsightsCore:track"}),(function(){null===i&&(n(i),$l("Invalid telemetry item")),function(e){bl(e[Ba])&&(n(e),$l("telemetry name required"))}(i),t.track(i)}),(function(){return{item:i}}),!i.sync)}})),n}return Ch(t,e),t.__ieDyn=1,t}(ng),sg="",lg="version",ug="properties",dg="1DS-Web-JS-3.2.18",cg="withCredentials",hg=((rg={})[0]=0,rg[2]=6,rg[1]=1,rg[3]=7,rg[4098]=6,rg[4097]=1,rg[4099]=7,rg);function gg(e){return!(e===sg||bl(e))}function pg(e,t,n){var i=-1;if(!_l(e))if(t>0&&(32===t?i=8192:t<=13&&(i=t<<5)),function(e){return e>=0&&e<=9}(n))-1===i&&(i=0),i|=n;else{var r=hg[yg(e)]||-1;-1!==i&&-1!==r?i|=r:6===r&&(i=r)}return i}function fg(e,t,n,i,r){var o={},a=!1,s=0,l=arguments.length,u=arguments;for("[object Boolean]"===Object[Ta].toString.call(u[0])&&(a=u[0],s++);s<l;s++)El(u[s],(function(e,t){a&&t&&Sl(t)?Dl(t)?(o[e]=o[e]||[],Bl(t,(function(t,n){t&&Sl(t)?o[e][n]=fg(!0,o[e][n],t):o[e][n]=t}))):o[e]=fg(!0,o[e],t):o[e]=t}));return o}Boolean(Bd()),Boolean(Od());var mg=function(){var e=Pd(_d);return e&&e.now?e.now():zl()};function vg(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=mg()}function yg(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===ba&&(t=4,Dl(e)?(t=4096,e.length>0&&(t|=yg(e[0]))):Da.call(e,"value")&&(t=8192|yg(e.value)))}return t}var _g=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],pd(t,n,(function(e,t){e.logger&&e.logger.queue||(e.logger=new nc({loggingLevelConsole:1})),e.initialize=function(n,i,r,o){Dh(e,(function(){return"AppInsightsCore.initialize"}),(function(){var a=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;!s||s.getProperty&&s.setProperty||$l("Invalid property storage override passed."),n.channels&&Bl(n.channels,(function(e){e&&Bl(e,(function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},i&&Bl(i,(function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}})),e.pluginVersionString=a.join(";"),e.pluginVersionStringArr=a;try{t.initialize(n,i,r,o),e.pollInternalLogs("InternalLog")}catch(t){var l=e.logger,u=zd(t);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),rc(l,1,514,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:n,extensions:i,logger:r,notificationManager:o}}))},e.track=function(n){Dh(e,(function(){return"AppInsightsCore.track"}),(function(){var i,r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=mg(),(i=r.latency)&&Fl(i)&&i>=1&&i<=4||(r.latency=1);var o=r.ext=r.ext||{};o.sdk=o.sdk||{},o.sdk.ver=dg;var a=r.baseData=r.baseData||{};a[ug]=a[ug]||{};var s=a[ug];s[lg]=s[lg]||e.pluginVersionString||sg}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return Ch(t,e),t.__ieDyn=1,t}(ag);const bg=_g;var Cg,Tg,Sg=(Tg={},El({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},(function(e,t){Tg[e]=t,Tg[t]=e})),Cg=Tg,rl&&El(Cg,(function(e,t){(Dl(t)||Sl(t))&&rl(t)})),jl(Cg)),Ig="REAL_TIME",wg="",Eg="POST",xg="drop",Ag="requeue",Dg="application/x-json-stream",Ng="cache-control",Fg="content-type",Pg="kill-duration",kg="time-delta-millis",Og="client-version",Bg="client-id",Rg="time-delta-to-apply-millis",Lg="upload-time",Mg="apikey",qg="AuthMsaDeviceTicket",Ug="AuthXToken",Wg="msfpc",jg="trace",zg="user";function Hg(e){var t=(e.ext||{}).intweb;return t&&gg(t[Wg])?t[Wg]:null}function Vg(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=Hg(e[n]);return t}var Gg=function(){function e(t,n){var i=n?[].concat(n):[],r=this,o=Vg(i);r.iKey=function(){return t},r.Msfpc=function(){return o||wg},r.count=function(){return i.length},r.events=function(){return i},r.addEvent=function(e){return!!e&&(i.push(e),o||(o=Hg(e)),!0)},r.split=function(n,r){var a;if(n<i.length){var s=i.length-n;bl(r)||(s=r<s?r:s),a=i.splice(n,s),o=Vg(i)}return new e(t,a)}}return e.create=function(t,n){return new e(t,n)},e}();const Qg=function(){function e(){var t=!0,n=!0,i=!0,r="use-collector-delta",o=!1;pd(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){i&&(i=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return r},e.setClockSkew=function(e){o||(e?(r=e,n=!0,o=!0):n=!1,t=!0)}}))}return e.__ieDyn=1,e}();var Kg=function(){function e(){var t={};pd(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var i=function(e){var t=[];return e&&Bl(e,(function(e){t.push(Ll(e))})),t}(e.split(","));if("this-request-only"===n)return i;for(var r=1e3*parseInt(n,10),o=0;o<i.length;++o)t[i[o]]=zl()+r}catch(e){return[]}return[]},e.isTenantKilled=function(e){var n=t,i=Ll(e);return void 0!==n[i]&&n[i]>zl()||(delete n[i],!1)}}))}return e.__ieDyn=1,e}();const $g=Kg;function Zg(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var Jg,Yg=2e6,Xg=Math.min(Yg,65e3),ep="metadata",tp="f",np=/\./,ip=function(){function e(t,n,i,r){var o="data",a="baseData",s=!!r,l=!0,u=n,d={};pd(e,this,(function(e){function n(e,t,r,o,a,l,c){El(e,(function(e,h){var g=null;if(h||gg(h)){var p=r,f=e,m=a,v=t;if(s&&!o&&np.test(e)){var y=e.split("."),_=y.length;if(_>1){m&&(m=m.slice());for(var b=0;b<_-1;b++){var C=y[b];v=v[C]=v[C]||{},p+="."+C,m&&m.push(C)}f=y[_-1]}}var T=o&&function(e,t){var n=d[e];return void 0===n&&(e.length>=7&&(n=xl(e,"ext.metadata")||xl(e,"ext.web")),d[e]=n),n}(p);if(g=!T&&u&&u.handleField(p,f)?u.value(p,f,h,i):function(e,t,n){if(!t&&!gg(t)||"string"!=typeof e)return null;var i=typeof t;if("string"===i||"number"===i||"boolean"===i||Dl(t))t={value:t};else if("object"!==i||Da.call(t,"value")){if(bl(t.value)||t.value===sg||!Nl(t.value)&&!Fl(t.value)&&!Pl(t.value)&&!Dl(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Dl(t.value)&&!(t.value.length>0))return null;if(!bl(t.kind)){if(Dl(t.value)||!(0===(r=t.kind)||r>0&&r<=13||32===r))return null;t.value=t.value.toString()}var r;return t}(f,h,i)){var S=g.value;if(v[f]=S,l&&l(m,f,g),c&&"object"==typeof S&&!Dl(S)){var I=m;I&&(I=I.slice()).push(f),n(h,S,p+"."+f,o,I,l,c)}}}}))}e.createPayload=function(e,t,n,i,r,o){return{apiKeys:[],payloadBlob:wg,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:i,sendType:o,sendReason:r}},e.appendPayload=function(n,i,r){var o=n&&i&&!n.overflow;return o&&Dh(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=i.events(),o=n.payloadBlob,a=n.numEvents,s=!1,l=[],u=[],d=n.isBeacon,c=d?65e3:3984588,h=d?Xg:Yg,g=0,p=0;g<t.length;){var f=t[g];if(f){if(a>=r){n.overflow=i.split(g);break}var m=e.getEventBlob(f);if(m&&m.length<=h){var v=m.length;if(o.length+v>c){n.overflow=i.split(g);break}o&&(o+="\n"),o+=m,++p>20&&(o.substr(0,1),p=0),s=!0,a++}else m?l.push(f):u.push(f),t.splice(g,1),g--}g++}if(l&&l.length>0&&n.sizeExceed.push(Gg.create(i.iKey(),l)),u&&u.length>0&&n.failedEvts.push(Gg.create(i.iKey(),u)),s){n.batches.push(i),n.payloadBlob=o,n.numEvents=a;var y=i.iKey();-1===Rl(n.apiKeys,y)&&n.apiKeys.push(y)}}),(function(){return{payload:n,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),o},e.getEventBlob=function(e){try{return Dh(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return sg}(e.iKey);var i={},r=e.ext;r&&(t.ext=i,El(r,(function(e,t){n(t,i[e]={},"ext."+e,!0,null,null,!0)})));var s=t[o]={};s.baseType=e.baseType;var u=s[a]={};return n(e.baseData,u,a,!1,[a],(function(e,t,n){rp(i,e,t,n)}),l),n(e.data,s,o,!1,[],(function(e,t,n){rp(i,e,t,n)}),l),JSON.stringify(t)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function rp(e,t,n,i){if(i&&e){var r=pg(i.value,i.kind,i.propertyType);if(r>-1){var o=e[ep];o||(o=e[ep]={f:{}});var a=o[tp];if(a||(a=o[tp]={}),t)for(var s=0;s<t.length;s++){var l=t[s];a[l]||(a[l]={f:{}});var u=a[l][tp];u||(u=a[l][tp]={}),a=u}a=a[n]={},Dl(i.value)?a.a={t:r}:a.t=r}}}var op="sendAttempt",ap="&NoResponseBody=true",sp=((Jg={})[1]=Ag,Jg[100]=Ag,Jg[200]="sent",Jg[8004]=xg,Jg[8003]=xg,Jg),lp={},up={};function dp(e,t,n){lp[e]=t,!1!==n&&(up[t]=e)}function cp(e){try{return e.responseText}catch(e){}return wg}function hp(e,t){var n=!1;if(e&&t){var i=Ul(e);if(i&&i.length>0)for(var r=t.toLowerCase(),o=0;o<i.length;o++){var a=i[o];if(a&&Tl(t,a)&&a.toLowerCase()===r){n=!0;break}}}return n}function gp(e,t,n,i){t&&n&&n.length>0&&(i&&lp[t]?(e.hdrs[lp[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}function pp(e,t){return t&&(Fl(t)?e=[t].concat(e):Dl(t)&&(e=t.concat(e))),e}dp(qg,qg,!1),dp(Og,Og),dp(Bg,"Client-Id"),dp(Mg,Mg),dp(Rg,Rg),dp(Lg,Lg),dp(Ug,Ug);var fp=function(){function e(t,n,i,r,o){this._responseHandlers=[];var a,s,l,u,d,c,h,g,p,f,m="?cors=true&"+Fg.toLowerCase()+"="+Dg,v=new $g,y=!1,_=new Qg,b=!1,C=0,T=!0,S=[],I={},w=[],E=null,x=!1,A=!1,D=!1;pd(e,this,(function(e){var N=!0;function F(e,t){for(var n=0,i=null,r=0;null==i&&r<e.length;)1===(n=e[r])?(null===Dd&&(Dd=typeof XDomainRequest!==Ca)&&Gd()&&(Dd=Dd&&!Fd(Pd(wd),"withCredentials")),Dd?i=P:Gd()&&(i=O)):2===n&&Vd(t)&&(!t||t&&!g)?i=k:b&&3===n&&Hd()&&(i=R),r++;return i?{_transport:n,_isSync:t,sendPOST:i}:null}function P(e,t,n){var i=new XDomainRequest;i.open(Eg,e.urlString),e.timeout&&(i.timeout=e.timeout),i.onload=function(){var e=cp(i);B(t,200,{},e),Q(e)},i.onerror=function(){B(t,400,{})},i.ontimeout=function(){B(t,500,{})},i.onprogress=function(){},n?i.send(e.data):o.set((function(){i.send(e.data)}),0)}function k(e,t,n){var i,r=e.urlString,a=!1,s=!1,l=((i={body:e.data,method:Eg}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,i);n&&(l.keepalive=!0,2===e._sendReason&&(a=!0,f&&(r+=ap))),N&&(l.credentials="include"),e.headers&&Ul(e.headers).length>0&&(l.headers=e.headers),fetch(r,l).then((function(e){var n={},i=wg,r=e.headers;r&&r.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){i=e})),s||(s=!0,B(t,e.status,n,i),Q(i))})).catch((function(e){s||(s=!0,B(t,0,{}))})),a&&!s&&(s=!0,B(t,200,{})),!s&&e.timeout>0&&o.set((function(){s||(s=!0,B(t,500,{}))}),e.timeout)}function O(e,t,n){var i=e.urlString;function r(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var i=t.getResponseHeader(n);i&&(e[n]=Ll(i))}return e}function o(e,n){B(t,e.status,function(e){var t,n,i={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},Nl(t)&&Bl(Ll(t).split(/[\r\n]+/),(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var i=Ll(e.substring(0,t)).toLowerCase(),r=Ll(e.substring(t+1));n[i]=r}else n[Ll(e)]=1}})),i=n):(i=r(i,e,kg),i=r(i,e,Pg),i=r(i,e,"kill-duration-seconds")),i}(e),n)}n&&e.disableXhrSync&&(n=!1);var a=function(e,t,n,i,r,o){function a(e,t,n){try{e[t]=n}catch(e){}}void 0===i&&(i=!1),void 0===r&&(r=!1);var s=new XMLHttpRequest;return i&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",i),n&&a(s,cg,n),s.open(e,t,!r),n&&a(s,cg,n),!r&&o&&a(s,"timeout",o),s}(Eg,i,N,!0,n,e.timeout);El(e.headers,(function(e,t){a.setRequestHeader(e,t)})),a.onload=function(){var e=cp(a);o(a,e),Q(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function B(e,t,n,i){try{e(t,n,i)}catch(e){rc(s,2,518,zd(e))}}function R(e,t,n){var i=200,r=e._thePayload,o=e.urlString+(f?ap:wg);try{var a=Ld();if(!a.sendBeacon(o,e.data))if(r){var l=[];Bl(r.batches,(function(e){if(l&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!a.sendBeacon(o,E.getEventBlob(t[n]))){l.push(e.split(n));break}}else l.push(e.split(0))})),K(l,8003,r.sendType,!0)}else i=0}catch(e){oc(s,"Failed to send telemetry using sendBeacon API. Ex:"+zd(e)),i=0}finally{B(t,i,{},wg)}}function L(e){return 2===e||3===e}function M(e){return A&&L(e)&&(e=2),e}function q(){return!y&&C<n}function U(){var e=w;return w=[],e}function W(e,t,n){var i=!1;return e&&e.length>0&&!y&&l[t]&&E&&(i=0!==t||q()&&(n>0||_.allowRequestSending())),i}function j(e){var t={};return e&&Bl(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function z(e,n,i,r,o){if(e&&0!==e.length)if(y)K(e,1,r);else{r=M(r);try{var a=e,d=0!==r;Dh(u,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var s=[],u=null,c=mg(),h=l[r]||(d?l[1]:l[0]),g=h&&h._transport,f=p&&(A||L(r)||3===g||h._isSync&&2===g);W(e,r,n);){var m=e.shift();m&&m.count()>0&&(v.isTenantKilled(m.iKey())?s.push(m):(u=u||E.createPayload(n,i,d,f,o,r),E.appendPayload(u,m,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,V(u,c,mg(),o),c=mg(),u=null):(V(u,c,mg(),o),c=mg(),e=[m].concat(e),u=null)))}u&&V(u,c,mg(),o),e.length>0&&(w=e.concat(w)),K(s,8004,r)}),(function(){return{batches:j(a),retryCount:n,isTeardown:i,isSynchronous:d,sendReason:o,useSendBeacon:L(r),sendType:r}}),!d)}catch(e){rc(s,2,48,"Unexpected Exception sending batch: "+zd(e))}}}function H(e,t,n){e[t]=e[t]||{},e[t][a.identifier]=n}function V(t,n,r,o){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var d=!!e.sendHook,p=l[t.sendType];!L(t.sendType)&&t.isBeacon&&2===t.sendReason&&(p=l[2]||l[3]||p);var f=D;(t.isBeacon||3===p._transport)&&(f=!1);var y=function(e,t){var n={url:m,hdrs:{},useHdrs:!1};t?(n.hdrs=fg(n.hdrs,I),n.useHdrs=Ul(n.hdrs).length>0):El(I,(function(e,t){up[e]?gp(n,up[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)})),gp(n,Bg,"NO_AUTH",t),gp(n,Og,dg,t);var i=wg;Bl(e.apiKeys,(function(e){i.length>0&&(i+=","),i+=e})),gp(n,Mg,i,t),gp(n,Lg,zl().toString(),t);var r=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return wg}(e);if(gg(r)&&(n.url+="&ext.intweb.msfpc="+r),_.shouldAddClockSkewHeaders()&&gp(n,Rg,_.getClockSkewHeaderValue(),t),u.getWParam){var o=u.getWParam();o>=0&&(n.url+="&w="+o)}for(var a=0;a<S.length;a++)n.url+="&"+S[a].name+"="+S[a].value;return n}(t,f);f=f||y.useHdrs;var b=mg();Dh(u,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var l=0;l<t.batches.length;l++)for(var m=t.batches[l].events(),S=0;S<m.length;S++){var I=m[S];if(x){var w=I.timings=I.timings||{};H(w,"sendEventStart",b),H(w,"serializationStart",n),H(w,"serializationCompleted",r)}I[op]>0?I[op]++:I[op]=1}K(t.batches,1e3+(o||0),t.sendType,!0);var E={data:t.payloadBlob,urlString:y.url,headers:y.hdrs,_thePayload:t,_sendReason:o,timeout:c,disableXhrSync:h,disableFetchKeepAlive:g};f&&(hp(E.headers,Ng)||(E.headers[Ng]="no-cache, no-store"),hp(E.headers,Fg)||(E.headers[Fg]=Dg));var D=null;p&&(D=function(n){_.firstRequestSent();var r=function(n,r){!function(t,n,r,o){var s,l=9e3,u=null,d=!1,c=!1;try{var h=!0;if(typeof t!==Ca){if(n){_.setClockSkew(n[kg]);var g=n[Pg]||n["kill-duration-seconds"];Bl(v.setKillSwitchTenants(n["kill-tokens"],g),(function(e){Bl(r.batches,(function(t){if(t.iKey()===e){u=u||[];var n=t.split(0);r.numEvents-=n.count(),u.push(n)}}))}))}if(200==t||204==t)return void(l=200);((s=t)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||r.numEvents<=0)&&(h=!1),l=9e3+t%1e3}if(h){l=100;var p=r.retryCnt;0===r.sendType&&(p<i?(d=!0,G((function(){0===r.sendType&&C--,z(r.batches,p+1,r.isTeardown,A?2:r.sendType,5)}),A,Zg(p))):(c=!0,A&&(l=8001)))}}finally{d||(_.setClockSkew(),function(t,n,i,r){try{r&&a._backOffTransmission(),200===n&&(r||t.isSync||a._clearBackOff(),function(e){if(x){var t=mg();Bl(e,(function(e){e&&e.count()>0&&function(e,t){x&&Bl(e,(function(e){H(e.timings=e.timings||{},"sendEventCompleted",t)}))}(e.events(),t)}))}}(t.batches)),K(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(C--,5!==i&&e.sendQueuedRequests(t.sendType,i))}}(r,l,o,c)),K(u,8004,r.sendType)}}(n,r,t,o)},l=t.isTeardown||t.isSync;try{p.sendPOST(n,r,l),e.sendListener&&e.sendListener(E,n,l,t.isBeacon)}catch(e){oc(s,"Unexpected exception sending payload. Ex:"+zd(e)),B(r,0,{})}}),Dh(u,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(D)if(0===t.sendType&&C++,d&&!t.isBeacon&&3!==p._transport){var n={data:E.data,urlString:E.urlString,headers:fg({},E.headers),timeout:E.timeout,disableXhrSync:E.disableXhrSync,disableFetchKeepAlive:E.disableFetchKeepAlive},i=!1;Dh(u,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){i=!0,T||e._thePayload||(e._thePayload=e._thePayload||E._thePayload,e._sendReason=e._sendReason||E._sendReason),D(e)}),t.isSync||t.isTeardown)}catch(e){i||D(E)}}))}else D(E)}))}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:r,sendReason:o}}),t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&K(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&K(t.failedEvts,8002,t.sendType)}function G(e,t,n){t?e():o.set(e,n)}function Q(t){var n=e._responseHandlers;try{for(var i=0;i<n.length;i++)try{n[i](t)}catch(e){rc(s,1,519,"Response handler failed: "+e)}if(t){var r=JSON.parse(t);gg(r.webResult)&&gg(r.webResult[Wg])&&d.set("MSFPC",r.webResult[Wg],31536e3)}}catch(e){}}function K(e,t,n,i){if(e&&e.length>0&&r){var o=r[(l=t,d=sp[l],gg(d)||(d="oth",l>=9e3&&l<=9999?d="rspFail":l>=8e3&&l<=8999?d=xg:l>=1e3&&l<=1999&&(d="send")),d)];if(o){var a=0!==n;Dh(u,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){G((function(){try{o.call(r,e,t,a,n)}catch(e){rc(s,1,74,"send request notification failed: "+e)}}),i||a,0)}),(function(){return{batches:j(e),reason:t,isSync:a,sendSync:i,sendType:n}}),!a)}}var l,d}e.initialize=function(e,t,n,i,r){var o;r||(r={}),m=e+m,D=!!_l(r.avoidOptions)||!r.avoidOptions,u=t,d=t.getCookieMgr(),x=!u.config.disableEventTimings;var v=!!u.config.enableCompoundKey;s=(a=n).diagLog();var y=r.valueSanitizer,_=r.stringifyObjects;_l(r.enableCompoundKey)||(v=!!r.enableCompoundKey),c=r.xhrTimeout,h=!!r.disableXhrSync,g=!!r.disableFetchKeepAlive,f=!1!==r.addNoResponse,b=!Wd(),E=new ip(u,y,_,v),bl(r.useSendBeacon)||(b=!!r.useSendBeacon);var C=i,S=r.alwaysUseXhrOverride?i:null,I=r.alwaysUseXhrOverride?i:null,w=[3,2];if(!i){T=!1;var A=Md();A&&A.protocol&&"file:"===A.protocol.toLowerCase()&&(N=!1);var P=[];Wd()?(P=[2,1],w=[2,1,3]):P=[1,2,3],(i=F(P=pp(P,r.transports),!1))||oc(s,"No available transport to send events"),C=F(P,!0)}S||(S=F(w=pp(w,r.unloadTransports),!0)),p=!T&&(b&&Hd()||!g&&Vd(!0)),(o={})[0]=i,o[1]=C||F([1,2,3],!0),o[2]=S||C||F([1],!0),o[3]=I||F([2,3],!0)||C||F([1],!0),l=o},e._getDbgPlgTargets=function(){return[l[0],v,E,l]},e.addQueryStringParameter=function(e,t){for(var n=0;n<S.length;n++)if(S[n].name===e)return void(S[n].value=t);S.push({name:e,value:t})},e.addHeader=function(e,t){I[e]=t},e.canSendRequest=function(){return q()&&_.allowRequestSending()},e.sendQueuedRequests=function(e,t){_l(e)&&(e=0),A&&(e=M(e),t=2),W(w,e,0)&&z(U(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!y&&0===C&&0===w.length},e.setUnloading=function(e){A=e},e.addBatch=function(e){if(e&&e.count()>0){if(v.isTenantKilled(e.iKey()))return!1;w.push(e)}return!0},e.teardown=function(){w.length>0&&z(U(),0,!0,2,2)},e.pause=function(){y=!0},e.resume=function(){y=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(bl(t)&&(t=1),A&&(t=M(t),n=2),z([e],0,!1,t,n||0))}}))}return e.__ieDyn=1,e}();function mp(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return setTimeout(e,t,n)}function vp(e){clearTimeout(e)}function yp(e,t){return{set:e||mp,clear:t||vp}}var _p="eventsDiscarded",bp="overrideInstrumentationKey",Cp="maxEventRetryAttempts",Tp="maxUnloadEventRetryAttempts";const Sp=function(e){function t(){var n,i=e.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.2.18";var r,o,a,s,l,u,d,c=!1,h=[],g=null,p=!1,f=0,m=500,v=0,y=1e4,_={},b=Ig,C=null,T=null,S=0,I=0,w={},E=-1,x=!0,A=!1,D=6,N=2;return pd(t,i,(function(e,t){function i(e){"beforeunload"!==(e||Od().event).type&&(A=!0,o.setUnloading(A)),q(2,2)}function F(e){A=!1,o.setUnloading(A)}function P(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[jg]&&delete e.ext[jg],e.ext&&e.ext[zg]&&e.ext[zg].id&&delete e.ext[zg].id,x&&(e.ext=Jl(e.ext),e.baseData&&(e.baseData=Jl(e.baseData)),e.data&&(e.data=Jl(e.data))),e.sync)if(S||p)e.latency=3,e.sync=!1;else if(o)return x&&(e=Jl(e)),void o.sendSynchronousBatch(Gg.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,i=v,r=y;4===n&&(i=f,r=m);var a=!1;if(i<r)a=!j(e,t);else{var s=1,l=20;4===n&&(s=4,l=1),a=!0,function(e,t,n,i){for(;n<=t;){var r=U(e,t,!0);if(r&&r.count()>0){var o=r.split(0,i),a=o.count();if(a>0)return 4===n?f-=a:v-=a,J(_p,[o],Sg.QueueFull),!0}n++}return z(),!1}(e.iKey,e.latency,s,l)&&(a=!j(e,t))}a&&Z(_p,[e],Sg.QueueFull)}function k(e,t,n){var i=H(e,t,n);return o.sendQueuedRequests(t,n),i}function O(){return v>0}function B(){if(E>=0&&H(E,0,l)&&o.sendQueuedRequests(0,l),f>0&&!T&&!p){var e=_[b][2];e>=0&&(T=L((function(){T=null,k(4,0,1),B()}),e))}var t=_[b][1];!C&&!g&&t>=0&&!p&&(O()?C=L((function(){C=null,k(0===I?3:1,0,1),I++,I%=2,B()}),t):I=0)}function R(){n=null,c=!1,h=[],g=null,p=!1,f=0,m=500,v=0,y=1e4,_={},b=Ig,C=null,T=null,S=0,I=0,r=null,w={},a=void 0,s=0,E=-1,l=null,x=!0,A=!1,D=6,N=2,u=null,d=yp(),o=new fp(500,2,1,{requeue:K,send:Y,sent:X,drop:ee,rspFail:te,oth:ne},d),Q(),w[4]={batches:[],iKeyMap:{}},w[3]={batches:[],iKeyMap:{}},w[2]={batches:[],iKeyMap:{}},w[1]={batches:[],iKeyMap:{}},ie()}function L(e,t){0===t&&S&&(t=1);var n=1e3;return S&&(n=Zg(S-1)),d.set(e,t*n)}function M(){return null!==C&&(d.clear(C),C=null,I=0,!0)}function q(e,t){M(),g&&(d.clear(g),g=null),p||k(1,e,t)}function U(e,t,n){var i=w[t];i||(i=w[t=1]);var r=i.iKeyMap[e];return!r&&n&&(r=Gg.create(e),i.batches.push(r),i.iKeyMap[e]=r),r}function W(t,n){o.canSendRequest()&&!S&&(a>0&&v>a&&(n=!0),n&&null==g&&e.flush(t,null,20))}function j(e,t){x&&(e=Jl(e));var n=e.latency,i=U(e.iKey,n,!0);return!!i.addEvent(e)&&(4!==n?(v++,t&&0===e.sendAttempt&&W(!e.sync,s>0&&i.count()>=s)):f++,!0)}function z(){for(var e=0,t=0,n=function(n){var i=w[n];i&&i.batches&&Bl(i.batches,(function(i){4===n?e+=i.count():t+=i.count()}))},i=1;i<=4;i++)n(i);v=t,f=e}function H(t,n,i){var r=!1,a=0===n;return!a||o.canSendRequest()?Dh(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=4;n>=t;){var i=w[n];i&&i.batches&&i.batches.length>0&&(Bl(i.batches,(function(t){o.addBatch(t)?r=r||t&&t.count()>0:e=e.concat(t.events()),4===n?f-=t.count():v-=t.count()})),i.batches=[],i.iKeyMap={}),n--}e.length>0&&Z(_p,e,Sg.KillSwitch),r&&E>=t&&(E=-1,l=0)}),(function(){return{latency:t,sendType:n,sendReason:i}}),!a):(E=E>=0?Math.min(E,t):t,l=Math.max(l,i)),r}function V(e,t){k(1,0,t),z(),G((function(){e&&e(),h.length>0?g=L((function(){g=null,V(h.shift(),t)}),0):(g=null,B())}))}function G(e){o.isCompletelyIdle()?e():g=L((function(){g=null,G(e)}),.25)}function Q(){(_={})[Ig]=[2,1,0],_.NEAR_REAL_TIME=[6,3,0],_.BEST_EFFORT=[18,9,0]}function K(t,n){var i=[],r=D;A&&(r=N),Bl(t,(function(t){t&&t.count()>0&&Bl(t.events(),(function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<r?(vg(t,e.identifier),P(t,!1)):i.push(t))}))})),i.length>0&&Z(_p,i,Sg.NonRetryableStatus),A&&q(2,2)}function $(t,n){var i=e._notificationManager||{},r=i[t];if(r)try{r.apply(i,n)}catch(n){rc(e.diagLog(),1,74,t+" notification failed: "+n)}}function Z(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&$(e,[t].concat(n))}function J(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&Bl(t,(function(t){t&&t.count()>0&&$(e,[t.events()].concat(n))}))}function Y(e,t,n){e&&e.length>0&&$("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function X(e,t){J("eventsSent",e,t),B()}function ee(e,t){J(_p,e,t>=8e3&&t<=8999?t-8e3:Sg.Unknown)}function te(e){J(_p,e,Sg.NonRetryableStatus),B()}function ne(e,t){J(_p,e,Sg.Unknown),B()}function ie(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,y/6)}R(),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(s,l,c){Dh(l,(function(){return"PostChannel:initialize"}),(function(){var h=l;t.initialize(s,l,c);try{l.addUnloadCb,u=hh(Wc(e.identifier),l.evtNamespace&&l.evtNamespace());var g=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=g.getExtCfg(e.identifier),d=yp(n.setTimeoutOverride,n.clearTimeoutOverride),x=!n.disableOptimizeObj&&!!Pd("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(h),n.eventsLimitInMem>0&&(y=n.eventsLimitInMem),n.immediateEventLimit>0&&(m=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),Fl(n[Cp])&&(D=n[Cp]),Fl(n[Tp])&&(N=n[Tp]),ie(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(r=n.httpXHROverride),gg(s.anonCookieName)&&o.addQueryStringParameter("anoncknm",s.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var p=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=l.getNotifyMgr(),o.initialize(p,e.core,e,r,n);var f=s.disablePageUnloadEvents||[];(function(e,t,n,i){var r=!1;t&&e&&Dl(e)&&!(r=fh(e,t,n,i))&&n&&n[za]>0&&(r=fh(e,t,null,i))})([Xc,Yc,Zc],i,f,u),vh(i,f,u),yh(F,s.disablePageShowEvents,u)}catch(t){throw e.setInitialized(!1),t}}),(function(){return{coreConfig:s,core:l,extensions:c}}))},e.processTelemetry=function(t,i){vg(t,e.identifier);var r=(i=e._getTelCtx(i)).getExtCfg(e.identifier),o=!!n.disableTelemetry;r&&(o=o||!!r.disableTelemetry);var a=t;o||c||(n[bp]&&(a.iKey=n[bp]),r&&r[bp]&&(a.iKey=r[bp]),P(a,!0),A?q(2,2):B()),e.processNext(a,i)},e._doTeardown=function(e,t){var n;q(2,2),c=!0,o.teardown(),mh([Xc,Yc,Zc],null,u),n=hh(eh,u),mh([Zc],null,n),mh([$c],null,n),function(e,t){var n=hh(th,t);mh([Jc],null,n),mh([$c],null,n)}(0,u),R()},e.setEventQueueLimits=function(e,t){y=e>0?e:1e4,a=t>0?t:0,ie();var n=v>e;if(!n&&s>0)for(var i=1;!n&&i<=3;i++){var r=w[i];r&&r.batches&&Bl(r.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}W(!0,n)},e.pause=function(){M(),p=!0,o.pause()},e.resume=function(){p=!1,o.resume(),B()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){M(),Q(),b=Ig,B(),El(e,(function(e,t){var n=t.length;if(n>=2){var i=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var r=t[0]/t[1];t[0]=Math.ceil(r)*t[1]}i>=0&&t[1]>=0&&i>t[1]&&(i=t[1]),t.push(i),_[e]=t}}))},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!p)if(n=n||1,e)null==g?(M(),H(1,0,n),g=L((function(){g=null,V(t,n)}),0)):h.push(t);else{var i=M();k(1,1,n),null!=t&&t(),i&&B()}},e.setMsaAuthTicket=function(e){o.addHeader(qg,e)},e.hasEvents=O,e._setTransmitProfile=function(e){b!==e&&void 0!==_[e]&&(M(),b=e,B())},e._backOffTransmission=function(){S<4&&(S++,M(),B())},e._clearBackOff=function(){S&&(S=0,M(),B())},Wl(e,"_setTimeoutOverride",(function(){return d.set}),(function(e){d=yp(e,d.clear)})),Wl(e,"_clearTimeoutOverride",(function(){return d.clear}),(function(e){d=yp(d.set,e)}))})),i}return Ch(t,e),t.__ieDyn=1,t}(Kh);var Ip,wp,Ep="HttpManager:_sendBatches",xp="PrivacyGuard:_processTelemetry",Ap=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),Dp=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return e===Ep||e===xp?new Ap(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case Ep:this.handleSendBatches(e);break;case xp:this.handlePrivacyGuardNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){if(this._callbacks.requestProcessingStats){var t=0;if(e.payload){var n=e.payload();if(n.batches)for(var i in n.batches)t+=n.batches[i].evts.length}this._callbacks.requestProcessingStats(e.time||0,t)}},e.prototype.handlePrivacyGuardNotification=function(e){this._callbacks.privacyGuardStats&&e.time&&e.time>0&&this._callbacks.privacyGuardStats(e.time)},e}(),Np=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.__extends)(t,e),t.prototype.initialize=function(t,n){this._postChannel=new Sp;var i=null!=n?n:[];t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=(0,r.__assign)((0,r.__assign)({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,i={};i.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(i),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(bg),Fp=function(e){function t(t,n){var i,o=e.call(this,t,n)||this;o.sendTelemetryEvent=function(e){return function(t,n){try{return void((r=o.getOneDSTelemetryEvent(e))&&i&&i.track(r))}catch(e){return void ya(1,"1DS Sink",e)}var r}()},o.sendCustomerContent=function(e){},o.sendNonStandardEvent=function(e,t){var n=!1;l.forEach((function(i){i.canHandle(t)&&(i.processEvent(e),n=!0)})),n||va(0,1,(function(){return"Missing Handler for "+t+"to process"+e.eventName}))},o.flush=function(e){null==i||i.flush(e),l.forEach((function(t){t.flush(e)}))},o.shutdown=function(){try{null==i||i.shutdown(),l.forEach((function(e){e.shutdown()}))}catch(e){va(0,2,(function(){return"An error occurred on shutdown"}))}};var a,s,l=n.nonStandardEventHandlers||[];if(i=function(e,t){var n=e.httpXHROverride,i={instrumentationKey:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",endpointUrl:e.endpointUrl,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:n,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},enableWParam:!n,disableCookiesUsage:!0,extensionConfig:(0,r.__assign)({},e.extensionConfig)};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(t,n){var i,r=n||t;r.data&&(null===(i=e.stats)||void 0===i||i.networkStats(r.data.length))});var o=new Np;return o.initialize(i,e.plugins),o.setUploadFrequency(e.uploadFrequency),e.notificationListener&&o.addNotificationListener(e.notificationListener),e.stats&&o.setPerfMgr(new Dp(e.stats)),o}(n),l.forEach((function(e){e.initialize(o,n)})),!n.endpointUrl)throw new Error("Missing Endpoint Url");return n.disableStatsTracking||(a=o,(s=i)&&s.addNotificationListener({eventsSent:function(e){va(2,2,(function(){return"Successfully sent ".concat(e.length," event(s)")})),va(3,2,(function(){return"Sent event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsSent+=e.length},eventsDiscarded:function(e,t){va(0,2,(function(){return"Discarded ".concat(e.length," event(s) because ").concat(t)})),va(3,2,(function(){return"Discarded event(s) details : ".concat(JSON.stringify(e,null,2))})),a.eventsDiscarded+=e.length}})),o}return(0,r.__extends)(t,e),t}((function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var i=[],r=!1,o=!0,a={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return r||10===t||110===t||120===t}},s={},l=_h();this.init=function(e){return Tu(s,!1)},this.begin=function(){return o=o&&Tu(s,!0)},this.getOneDSTelemetryEvent=function(e){return u(e,{eventType:1})},this.getOneDSCustomerContent=function(e){var t=e.telemetryProperties.customerContentVersion;if(t&&Math.floor(t)<=2&&1===e.telemetryProperties.customerContentType)return u(e,{eventType:2})};var u=function(e,t){if(o){var r=Pu(e);if(function(e,t){for(var n=function(n){var i=t[n];if(!i.processEvent(e))return va(2,1,(function(){return"".concat(e.eventName," suppressed by ").concat(i.name)})),{value:!1}},i=0;i<t.length;i++){var r=n(i);if("object"==typeof r)return r.value}return!0}(r,i)){var a=(g=r,g.timestamp?new Date(g.timestamp):new Date).toISOString(),u={"Event.Name":r.eventName,"Event.Source":"OTelJS","Event.Time":{value:a,propertyType:9}};for(var d in n.eventsProcessed++,u["Event.Sequence"]={value:n.eventsProcessed,propertyType:4},u["Event.Id"]=l+"."+n.eventsProcessed,s)u[d]=s[d];if(!pu(u,r.dataFields,!0,t.eventType))return void va(0,1,(function(){return"Dropping Event: "+r.eventName}));var c="custom";r.eventContract&&(r.eventContract.name&&(u["Event.Contract"]=r.eventContract.name,c+="."+r.eventContract.name.toLowerCase().replace(/\./g,"_")),pu(u,r.eventContract.dataFields,!1,t.eventType));var h=function(e,t){return 2===t?"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121":e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void va(0,1,(function(){return"Missing Aria Token"}))}(r,t.eventType);if(!h)return;return{iKey:h,name:r.eventName,data:u,time:a,baseType:c,ext:{sdk:{seq:n.eventsProcessed}}}}}var g};this.addPreprocessor=function(e){i.push(e)},this.getOneDSPersistentDataFields=function(){return s},this.getPreprocessors=function(){return i};var d=function(e){pu(s,e,!1,1)};this.addPersistentDataFields=d,this.setOptionalEventsEnabled=function(e){r=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(r=!0),d(e);var c,h=t.coreFields;if(h){d(function(e){var t="App",n=[];return nu(n,t,"Name",e.name,1),nu(n,t,"Platform",e.platform,1),nu(n,t,"Version",e.version,1),n}(h.app)),d(function(e){var t="User",n=[];return nu(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),nu(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),nu(n,t,"TenantId",e.tenantId,1),nu(n,t,"TenantGroup",e.tenantGroup,1),iu(n,t,"IsAnonymous",e.isAnonymous),iu(n,t,"IsSignedIn",e.isSignedIn),n}(h.user)),d(function(e){var t="Session",n=[];return nu(n,t,"Id",e.id,1),nu(n,t,"EcsETag",e.ecsETag,1),n}(h.session));var g=h.release;g&&d((nu(c=[],"Release","AudienceGroup",g.audienceGroup,1),c))}this.addPreprocessor(a)}));(wp=Ip||(Ip={})).USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",wp.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",wp.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",wp.CUSTOMER_CONTENT="",wp.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/";var Pp=n(109);class kp{constructor(){this.imports=[]}get uniqueId(){return(0,Je.z)(507918277)}configureRootServices(e){e.getOptional(we.qy)||e.bind(we.qy).toDynamicValue((e=>{var t;const n=e.get(Ie.n),{sessionId:i=e.get(Vi.G).generate(),appPlatform:r="DefaultAppPlatform",appName:o="DefaultAppName",appScenario:a="",releaseAudienceGroup:s="",clientVersion:l=""}=null!==(t=n.hostMetadata)&&void 0!==t?t:{},u=[(0,Pp.m9)("Session.Id",i),(0,Pp.m9)("App.Platform",r),(0,Pp.m9)("App.Name",o),(0,Pp.m9)("App.Scenario",a),(0,Pp.m9)("Release.AudienceGroup",s),(0,Pp.m9)("App.Version",l)],d=new Fp(u,{endpointUrl:Ip.PUBLIC});return d.setFullEventsEnabled(!1),d}))}}var Op=n(63302),Bp=n(99938),Rp=n(50630),Lp=n(98016);class Mp{constructor(){this.imports=[Bp.B,_o.J]}get uniqueId(){return(0,Je.z)(507918296)}configureRootServices(e){e.bind(Rp.Tc).to(Lp.l),e.bind(We.S).toExisting(Rp.Tc)}}var qp=n(1180),Up=n(74840);class Wp{constructor(){this.imports=[Bp.B,_o.J]}get uniqueId(){return(0,Je.z)(507918305)}configureRootServices(e){e.bind(Rp.Tc).to(qp.O),e.bind(We.S).toExisting(Rp.Tc),e.bind(vr.i).toValue(Up.q)}}var jp=n(19100),zp=n(68008),Hp=n.n(zp);let Vp=class{constructor(){this.getIndex=e=>e.index>=0?e.index:e,this.getNewValue=(e,t)=>e.index>=0?(e.index=t,e):t,this._dmp=new(Hp()),this._dmp.Diff_Timeout=0}getReadjustedIndices(e,t,n,i){var r;const o=[],a=null!==(r=e.textContent)&&void 0!==r?r:"",s=i?this._dmp.diff_main(n,a):this._dmp.diff_main(a,n);if(1===s.length&&0===s[0][0])return t;let l=0,u=0,d=0,c=0,h=0,g=0;for(const e of s){const n=e[0],i=e[1].length;switch(n){case 0:h=i,g=i;break;case 1:h=0,g=i;break;case-1:d+=i;continue}u+=d,d=0;for(let e=l;e<t.length;e+=1){const i=this.getIndex(t[e]);if(i<c)throw new Error("Indices are not sorted!");if(!(i>=c&&i<c+g))break;o[e]=0===n?this.getNewValue(t[e],i+u-c):this.getNewValue(t[e],u),l+=1}if(l===t.length)break;u+=h,c+=g}for(let e=l;e<t.length;e+=1)o[e]=this.getNewValue(t[e],u);return o}};Vp=(0,r.__decorate)([(0,Le._)()],Vp);class Gp{constructor(){this.imports=[]}get uniqueId(){return(0,Je.z)(507918221)}configureRootServices(e){e.bind(tn).to(Vp)}}async function Qp(e,t,i,r=new Date){try{await(0,Pe.iJ)();const{modules:o,uxModules:a,telemetrySinkOrModule:s}=await async function(e,t,i){const r=[],o=[];return r.push(ln),r.push(hr),r.push(yo),r.push(Nr),r.push(Co),r.push(mr),r.push(Op.I),r.push(jp.p),r.push((await n.e(1804).then(n.bind(n,36458))).InlineSuggestionsWebUXModule),i||r.push((await n.e(1804).then(n.bind(n,61907))).CreateAugloopSessionModule),e.serviceSettings?.hybridAugloop?.enabled&&e.serviceSettings.hybridAugloop.enableGraphSearchLocal&&r.push((await n.e(1804).then(n.bind(n,94673))).HybridModule),e.serviceSettings?.predictions?.enabled&&(void 0===e.serviceSettings.predictions.domInsertion||e.serviceSettings.predictions.domInsertion?r.push(Mp):r.push(Wp)),e.serviceSettings?.flagAnnotationSettings?.enabled&&(r.push(ca),o.push((async()=>(await n.e(1804).then(n.bind(n,11440))).UXModules)),o.push((async()=>(await Promise.all([n.e(1804),n.e(9108)]).then(n.bind(n,65233))).CategoryLocalizationSlimModule))),e.serviceSettings?.nudge?.enabled&&(r.push(ha.Q),o.push((async()=>(await n.e(1804).then(n.bind(n,72803))).NudgeUXModule))),e.isAggregatedLoggingEnabled&&r.push(et),window.Worker?r.push(pa):r.push(Gp),{modules:r,uxModules:o,telemetrySinkOrModule:t??new kp}}(e,t,i);return new Kp(e,o,a,i,s,void 0,r)}catch(e){throw(0,ke.C)().logEvent(0,"Diagnostics",Oe.h.Host,Be.q.Error,{Text_Message:`Failed to initialize Editor Client: ${e}`}),new Error(`Failed to initialize Editor Client: ${e}`)}}class Kp extends Fe{constructor(e,t,n,i=void 0,r,o,a=new Date){super(e,t,n,i,r,o,a)}readLocales(){throw new Error("Method not implemented.")}writeLocales(e){throw new Error("Method not implemented.")}spellCheck(e,t,n){return this.attach(e,n)}attach(e,t){const n=this.diContainer.get(u).createGraphNode({element:e,initialContentChangeType:t});return n&&this.proofingDom.addNode(n),n}detach(e){this.proofingDom.removeNode(e)}async setLocale(e){const t="string"==typeof e?[e]:e;return await super.setLocale(t)}clearPreloadedSuggestions(){this.diContainer.get(c.W).clearPreloadedSuggestions()}async clearPersistentData(){await this.diContainer.get(d.B).removePersistentKeys(),await this.diContainer.get(me.$).removePersistentKeys()}}var $p,Zp;!function(e){e.Int="nleditor.osi.office-int.net",e.Staging="nleditor.osi.officeppe.net",e.Lab="wus-001.nleditor.osi.officeppe.net",e.Prod="nleditor.osi.office.net",e.GCC="nleditor.gcc.osi.office365.us",e.GCCHigh="nleditor.osi.office365.us",e.USDoD="nleditor.osi.apps.mil",e.USNat="nleditor.osi.eaglex.ic.gov",e.USSec="nleditor.osi.microsoft.scloud"}($p||($p={})),function(e){e.Int="editor-thesaurus.northeurope.cloudapp.azure.com:9443",e.Staging="editor-edog-thesaurus.trafficmanager.net:9443",e.Lab="editor-edog-thesaurus.trafficmanager.net:9443",e.Prod="editor-prod-thesaurus.trafficmanager.net:9443",e.GCCModerate="editor-gccm-thesaurus.usgovtrafficmanager.net:9443",e.GCCHigh="editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",e.USDoD="editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",e.USNat="editor-usnat-thesaurus.trafficmanager.eaglex.ic.gov:9443",e.USSec="editor-ussec-thesaurus.trafficmanager.microsoft.scloud:9443"}(Zp||(Zp={}));var Jp=n(72783),Yp="https://",Xp=Yp+"outlook-1-cdn.azureedge.",ef="midgard/",tf="/agsc-"+ef,nf="versionless/",rf=Yp+"res.cdn.office.net/"+ef;const of={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let af;const sf=new Uint8Array(16),lf=[];for(let e=0;e<256;++e)lf.push((e+256).toString(16).slice(1));const uf=function(e,t,n){if(of.randomUUID&&!t&&!e)return of.randomUUID();const i=(e=e||{}).random??e.rng?.()??function(){if(!af){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");af=crypto.getRandomValues.bind(crypto)}return af(sf)}();if(i.length<16)throw new Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=i[e];return t}return function(e,t=0){return(lf[e[t+0]]+lf[e[t+1]]+lf[e[t+2]]+lf[e[t+3]]+"-"+lf[e[t+4]]+lf[e[t+5]]+"-"+lf[e[t+6]]+lf[e[t+7]]+"-"+lf[e[t+8]]+lf[e[t+9]]+"-"+lf[e[t+10]]+lf[e[t+11]]+lf[e[t+12]]+lf[e[t+13]]+lf[e[t+14]]+lf[e[t+15]]).toLowerCase()}(i)};var df;!function(e){e.GPT="GPT",e.MessageExtension="MessageExtension",e.PowerPlatform="PowerPlatform",e.OpenAIPlugin="OpenAIPlugin"}(df||(df={}));const cf="https://dogfood.augloop.svc.cloud.microsoft",hf=15,gf="@",pf=[{id:"spelling",name:"Spelling"},{id:"grammar",name:"Grammar"}],ff=[{id:"headingDetection",name:"Heading Detection"},{id:"entityDetection",name:"People / Date Recognition"},{id:"taskRecognition",name:"Task Recognition"},{id:"textToTable",name:"Table Suggestions"},{id:"addressDetection",name:"Address Detection"},{id:"satoriEntity",name:"Entity Suggestion"}],mf=[{id:"clarity",name:"Clarity"},{id:"conciseness",name:"Conciseness"},{id:"formality",name:"Formality"},{id:"inclusiveness",name:"Inclusiveness"},{id:"puncConventions",name:"Punctuation Conventions"},{id:"sensitiveGpRef",name:"Sensitive Geopolitical References"},{id:"vocabulary",name:"Vocabulary"}],vf=[df.MessageExtension,df.PowerPlatform,df.OpenAIPlugin];var yf,_f,bf,Cf,Tf,Sf,If,wf,Ef,xf,Af,Df;function Nf(e,t,n){return{Type:"Entity",Name:null,ReferenceId:e,EntityType:t,LayoutType:null,Position:n,ResultsView:null}}function Ff(e){switch(null==e?void 0:e.toLowerCase()){case yf.DOGFOOD:case yf.SDFV2:return _f.DOGFOOD;case yf.MSIT:case yf.MICROSOFT:return _f.MICROSOFT;case yf.WW:default:return _f.PRODUCTION}}function Pf(e,t){if(void 0===e)return cf;switch(null==e?void 0:e.toLowerCase()){case yf.DOGFOOD:case yf.SDFV2:return cf;case yf.MSIT:case yf.MICROSOFT:case yf.WW:default:return(null==t?void 0:t.enableLegacyAugLoopEndpoint)?"https://augloop.office.com":"https://augloop.svc.cloud.microsoft"}}!function(e){e.DOGFOOD="dogfood",e.SDFV2="sdfv2",e.MSIT="msit",e.MICROSOFT="microsoft",e.WW="ww"}(yf||(yf={})),function(e){e.DOGFOOD="Dogfood",e.MICROSOFT="Microsoft",e.PRODUCTION="Production"}(_f||(_f={})),function(e){e.Unknown="Unknown",e.File="File",e.Folder="Folder",e.Attachment="Attachment",e.Link="Link"}(bf||(bf={})),function(e){e.Unknown="Unknown",e.SharepointOnline="SharepointOnline",e.ModernAttachment="ModernAttachment",e.ClassicAttachment="ClassicAttachment",e.EmailLink="EmailLink",e.OneDriveForBusiness="OneDriveForBusiness"}(Cf||(Cf={})),function(e){e.Unknown="Unknown",e.DownloadableUrl="DownloadableUrl",e.ReaderUrl="ReaderUrl"}(Tf||(Tf={})),function(e){e.Person="Person",e.Group="Group",e.Other="Other"}(Sf||(Sf={})),function(e){e.OrganizationUser="OrganizationUser",e.OrganizationContact="OrganizationContact",e.PersonalContact="PersonalContact",e.ImplicitContact="ImplicitContact",e.ChatImplicitContact="ChatImplicitContact",e.Room="Room",e.Guest="Guest",e.UnifiedGroup="UnifiedGroup",e.PublicDistributionList="PublicDistributionList",e.PersonalDistributionList="PersonalDistributionList"}(If||(If={})),function(e){e.None="None",e.Organizer="Organizer",e.TentativelyAccepted="TentativelyAccepted",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(wf||(wf={})),function(e){e.Membership="Membership",e.Address="Address",e.Invalid="Invalid"}(Ef||(Ef={})),function(e){e.Message="Message",e.Email="Email",e.Conversation="Conversation",e.Document="Document",e.Keywords="Keywords",e.People="People",e.Bookmark="Bookmark",e.Building="Building",e.EditorialQnA="EditorialQnA",e.Floorplan="Floorplan",e.Flight="Flight",e.Acronym="Acronym",e.TuringQnA="TuringQnA",e.Task="Task",e.External="External",e.Topic="Topic",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Report="Report",e.Streams="Streams",e.Group="Group",e.Site="Site",e.Team="Team",e.Chat="Chat",e.Channel="Channel",e.Link="Link",e.EmployeeOffer="EmployeeOffer",e.Fact="Fact",e.Text="Text",e.Event="Event",e.File="File",e.SharePoint="SharePoint",e.Attachment="Attachment",e.PIM="PIM",e.MessageExtensionApp="MessageExtensionApp",e.Scope="Scope",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(xf||(xf={})),function(e){e.Off="Off",e.Forward="Forward",e.Reverse="Reverse"}(Af||(Af={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning"}(Df||(Df={}));const kf=e=>{const t=[];return(null==e?void 0:e.enableAppGptsInCiq)&&t.push({Term:{AppType:df.GPT}}),(null==e?void 0:e.enableAppMessageExtensionsInCiq)&&t.push({Term:{AppType:df.MessageExtension}}),(null==e?void 0:e.enableAppTypeBInCiq)&&t.push({Term:{AppType:df.OpenAIPlugin}}),(null==e?void 0:e.enableAppPPInCiq)&&t.push({Term:{AppType:df.PowerPlatform}}),(null==e?void 0:e.enableAppPluginsInCiq)&&vf.forEach((e=>{t.push({Term:{AppType:e}})})),t},Of=(e,t,n)=>{const i=!!((null==t?void 0:t.enableAppGptsInCiq)||(null==t?void 0:t.enableAppPluginsInCiq)||(null==t?void 0:t.enableAppPPInCiq)||(null==t?void 0:t.enableAppTypeBInCiq)||(null==t?void 0:t.enableAppMessageExtensionsInCiq));let r=[...e,o.c.App,o.c.Topic];r=r.filter((e=>e===o.c.App?i:e!==o.c.Topic||(null==t?void 0:t.enableTopicCIQ)||(null==t?void 0:t.enableTopicECC)));const a=[];return r.forEach((e=>{e===o.c.App&&i?a.push({enabled:!0,entityType:o.c.App,maxResults:hf,customProps:[{name:"Filter",value:JSON.stringify({Or:kf(t)})}]}):e===o.c.People?a.push({enabled:!0,entityType:o.c.People,maxResults:hf,customProps:[{name:"Filter",value:JSON.stringify({And:[{Or:[{Term:{PeopleType:Sf.Person}},{Term:{PeopleType:Sf.Other}}]},{Or:[{Term:{PeopleSubtype:If.OrganizationUser}},{Term:{PeopleSubtype:If.Guest}},{Term:{PeopleSubtype:If.OrganizationContact}}]}]})}]}):e===o.c.File?a.push({enabled:!0,entityType:e,maxResults:(null==t?void 0:t.enableSingleEntityStyle)?void 0:hf,customProps:null==n?void 0:n.File}):(e===o.c.Topic&&((null==t?void 0:t.enableTopicCIQ)||null==t||t.enableTopicECC),a.push({enabled:!0,entityType:e,maxResults:hf}))})),a.map((e=>(null==t?void 0:t.enableECCNudge)?Object.assign(Object.assign({},e),{queryPrefix:[e.entityType===o.c.App?gf:"/"]}):e)),a},Bf=(e,t)=>t||"DogFood"===e?$p.Staging:"GCC"===e?$p.GCC:"GCCH"===e?$p.GCCHigh:"DOD"===e?$p.USDoD:$p.Prod,Rf=["mc-officeEditorTonalEnabled","mc-officeEditorALEnabled","mc-enable-override-critiques:true","mc-editor-oa","maps-editor-locationsuggestions","mc-graphIntentDetection-workflow","mc-graphIntentDetection-model-flight07","mc-graphIntentDetection-model-flight15","mc-graphIntentDetection-allowlist-flight02","mc-editor-oa-mid-tile-predictions","mc-editor-oa-flags","mc-editor-oa-address-detection","mc-editor-oa-local-business-detection","mc-editor-oa-satori-entity-detection","oa-graph-bestmatch","enable-scope-suggestions","scd-suggestions-toplevel","mc-editor-oa-settings","mc-editor-oa-ecc-annotation","mc-editor-oa-event-ecc","mc-editor-oa-scopes","mc-editor-enable-meeting-banner"],Lf=(e,t)=>{const n=[...Rf];return(null==t?void 0:t.enableChatCIQ)&&n.push("mc-editor-oa-groupchat-ecc"),(null==t?void 0:t.enableEmailCIQ)&&n.push("mc-editor-oa-email-ecc"),((null==t?void 0:t.enableTopicECC)||(null==t?void 0:t.enableTopicCIQ))&&n.push("vivatopics"),((null==t?void 0:t.enableAppGptsInCiq)||(null==t?void 0:t.enableAppPluginsInCiq)||(null==t?void 0:t.enableAppPPInCiq)||(null==t?void 0:t.enableAppTypeBInCiq)||(null==t?void 0:t.enableAppMessageExtensionsInCiq))&&n.push("mc-editor-oa-app-ecc"),e&&n.push("mc-editor-oa-client-ecc"),(null==t?void 0:t.enableResponsiveExpandedECC)&&n.push("mc-editor-expanded-ecc-responsive"),(null==t?void 0:t.enableNewFileTidbits)&&n.push("mc-editor-enable-files-new-tidbits"),(null==t?void 0:t.enableSearchBar)&&(n.push("mc-editor-enable-searchbar"),n.push("mc-editor-attachbutton-searchbar-position")),(null==t?void 0:t.enableECCNudge)&&(n.push("mc-editor-oa-nudge"),n.push("mc-editor-oa-nudge-all-entities")),(null==t?void 0:t.enableGradientPlaceholder)&&n.push("immersive-bizchat-enable-gradient-placeholder"),(null==t?void 0:t.enableExperimentalPredictionTimeout)&&n.push("mc-editor-oa-experimental-prediction-timeout"),(null==t?void 0:t.enableAttachmentHint)&&n.push("mc-editor-enable-attachment-hint"),(null==t?void 0:t.enableShowCIQAfterRemoveAttachment)&&n.push("mc-editor-show-menu-after-remove-attachment"),n},Mf=(e,t,n,i,o,a)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){return yield Qp((({augLoopAuthTokenCallback:e,getProfilePictureUrl:t,substrateAuthTokenCallback:n,appId:i,appName:r,appPlatform:o,appScenario:a,sessionId:s,isDogfoodEnvironment:l,appEnvironment:u,accountType:d,puid:c,tenantId:h,accountRing:g,locale:p,oaResultsTimeout:f,sourceName:m,browseThisComputerSettings:v,enableZeroQueryHintText:y,customizedEmptyECCSuggestionsString:_,onOpenGptStorefront:b,moreCopilotsStringOverride:C,enableVisualRefresh:T,doNotLimitToTargetDocument:S},I,w,E)=>{const x=`${N={environment:"Prod"},N?N.publicPath?N.publicPath:function(e){switch(e.environment){case"Gallatin":return Yp+"res-1.cdn.partner.office365.cn/"+ef;case"AG08":return Xp+"eaglex.ic.gov"+tf;case"AG09":return Xp+"microsoft.scloud"+tf;case"GccHigh":return Yp+"res-gcch.cdn.office.net/"+ef;case"DoD":return Yp+"res-dod.cdn.office.net/"+ef;default:return rf}}(N)+nf:rf+nf}graph-search-local-0.4.3505-0.14.3`,A=!!(null==w?void 0:w.enableHybridWorkflow),D=!!((null==w?void 0:w.enableAppGptsInCiq)||(null==w?void 0:w.enableAppPluginsInCiq)||(null==w?void 0:w.enableAppPPInCiq)||(null==w?void 0:w.enableAppTypeBInCiq)||(null==w?void 0:w.enableAppMessageExtensionsInCiq));var N;return{appId:i,showSquiggleTooltip:!0,enableStealthSquiggles:!0,showOptionsButton:!0,flightsToTrack:Lf(A,w),tonalFreEnabledForUser:!0,useFluentV9:(null==w?void 0:w.enableECCForMobile)||T,oaSettings:{enableECCForMobileDevice:{enabled:!!(null==w?void 0:w.enableECCForMobile),mainAxisOverride:195},preventAllTabBackfill:null==w?void 0:w.enablePreventAllTabBackfill,isContextualCardEnabled:!0,mockResults:!1,mockNoAugloopResults:!1,mockResultState:"Default",enableZeroQueryHintText:y,bestMatchConfig:{enabled:!0,maxResults:hf},getProfilePictureUrl:t,scopesConfig:{enabled:!0,maxResults:hf,enableAutomaticScoping:!0},enableOaClient:A,entitiesEnabled:Of(I,w,E),e2eMetric:!0,updateResultsTimeout:f||5e3,customizedEmptyECCSuggestionsString:_,scopeToAppGptInlineSuggestion:D},hostMetadata:{appName:r,appPlatform:o,appScenario:a,releaseAudienceGroup:g?Ff(g):l?_f.DOGFOOD:_f.PRODUCTION,sessionId:null!=s?s:uf()},isTextPredictionEnabled:!0,isFeedbackEnabled:!0,serviceSettings:Object.assign({nudge:{enabled:!!(null==w?void 0:w.enableECCNudge),enableInlineNudge:!0,insertionCharacter:"/",automaticallyScope:!0},hybridAugloop:{enabled:A,enableGraphSearchLocal:A,enablePeriodicUpdates:null==w?void 0:w.enableHybridWorkflowPeriodicUpdates,wasmConfig:{binaryPath:x,scriptPath:x,disableModuleCache:"owa"!=(null==m?void 0:m.toLowerCase())&&"owahub"!=(null==m?void 0:m.toLocaleLowerCase())}},predictions:{enabled:!0,domInsertion:!0,allowMiddleOfSentencePredictions:!1},browseThisComputerSettings:v},D?{appGptConfig:{enableAppGpt:!0,onClickExploreMoreCopilots:b,moreCopilotsStringOverride:C}}:{}),defaultLocale:p||"en-US",controlIconSetName:"FabricMDL2Icons",synonymsEndPoint:Zp.Prod,editorEndPoint:Bf(u,l),userId:{puid:c||"testUserId",tenantId:h||"testTenantId",userDisplayName:"",identityProvider:"MSA"===d?0:1},licenseType:Jp.G_.Subscription,sessionType:0,upsellLink:"https://upselllink",ignoreAllEnabled:!0,ignoreOnceEnabled:!0,enableOptimizedCallingPattern:!0,maxSuggestionItemsDisplayNumber:3,maxSuggestionDisplayPerLanguageNumber:2,enableOrchestration:!0,newLineSentenceSeparatorEnabled:!0,enableE2eMetric:!0,orchestratorSettings:{enableAugLoop:!0,augLoopEndpoint:Pf(g,w),augLoopAuthTokenCallback:e,substrateAuthTokenCallback:n},manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enhancedUpsellEnabled:!1,premiumPreviewEnabled:!1,wordCountDetectorEnabled:!0,enabledCorrectionCategories:pf,enabledRefinementCategories:mf,enabledEnhancementCategories:ff,enableStopCheckingForThis:!0,useUiCoherence:T,doNotLimitToTargetDocument:!!S}})(e,t,n,a),o,i)})),qf={itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},Uf={calloutStyles:{marginTop:4,width:300,borderRadius:2},containerStyles:{maxWidth:300,minWidth:300,borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},headerStyles:{paddingHorizontal:12},shimmerStyles:{circleSize:32,gapSize:12,lineSize:160,paddingTop:8,paddingHorizontal:12},itemsStyles:{sharedItemStyles:{height:48,paddingHorizontal:12,borderRadius:0,textHorizontalPadding:12,titleFontSize:14,subtitleFontSize:12},personItemStyles:{personaCoinSize:32},fileItemStyles:{iconStyles:{margin:4}},scopeItemStyles:{height:32,iconFontSize:16,personaCoinSize:16}},footerStyles:{height:44,marginHorizontal:0,marginBottom:-4}};let Wf=!1;const jf=(e,t)=>{Wf&&(null==t?console.log("EditorService:",e):console.log("EditorService:",e,t))},zf=(e,t)=>{null==t?console.error("EditorService:",e):console.error("EditorService:",e,t)},Hf=(e,t)=>{null==t?console.warn("EditorService:",e):console.warn("EditorService:",e,t)};class Vf{constructor(){this.editorProps=null,this.editorClient=null,this.currentQuery=null,this.currentTab=null,this.openCount=0,this.suggestionCount=0}static getInstance(){return Vf.instance||(Vf.instance=new Vf),Vf.instance}updateFlyoutStartTime(e=!1){this.flyoutStartTime=e?void 0:Date.now()}getLatencyForFlyout(){if(!this.flyoutStartTime)return;const e=(Date.now()-this.flyoutStartTime)/1e3;return this.updateFlyoutStartTime(!0),e}getEditorProps(){return this.editorProps?this.editorProps:void 0}getEditorClient(){return this.editorClient}getCurrentQuery(){return this.currentQuery}getCurrentTab(){return this.currentTab}getCurrentInvocationSource(){return this.currentInvocationSource}getScenario(){return this.scenario}bootstrapEditor(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){var t,n,i,o,a,l,u,d,c,h,{eccQueryCharacter:g,targetElement:p,onEntitySelected:f,featureFlags:m,alSession:v,telemetrySink:y,entitiesEnabled:_,telemetryLogger:b,entityCustomProps:C}=e,T=(0,r.__rest)(e,["eccQueryCharacter","targetElement","onEntitySelected","featureFlags","alSession","telemetrySink","entitiesEnabled","telemetryLogger","entityCustomProps"]);h=function(e){var t,n;return null!==(t=null==e?void 0:e.isDogfoodEnvironment)&&void 0!==t?t:(null===(n=null==e?void 0:e.accountRing)||void 0===n?void 0:n.toLowerCase())===yf.DOGFOOD}(T),Wf=h,jf("BootstrapEditor Called"),this.telemetryLogger=b,null==b||b.logEvent({eventId:"EditorBootstrapTriggered"});const S=yield Mf(T,_,m,v,y,C);this.editorClient=S,this.scenario=`${T.appName}.${T.appPlatform}.${null!==(t=T.appScenario)&&void 0!==t?t:""}`,jf("EditorClient Created"),null==b||b.logEvent({eventId:"EditorClientCreated",editorSessionId:null===(n=S.hostSettings.hostMetadata)||void 0===n?void 0:n.sessionId,metaData:JSON.stringify({enabledEntities:null===(o=null===(i=S.hostSettings)||void 0===i?void 0:i.oaSettings)||void 0===o?void 0:o.entitiesEnabled})}),S.onError=(e,t)=>{zf("EditorClient onError called",e),null==b||b.logEvent({eventId:(null==S?void 0:S.isEditorClientShutdown)?"ESDKShutdownError":"ESDKInitializeError",errorMessage:JSON.stringify(e)})},S.setAvailableCritiqueTypes(s);try{localStorage.removeItem("featureFlags");const e={value:'{"enableVisibilityTracker":"True","enableSimplifiedHost":"True","enableParagraphUpdates":"True","enableOrchestratorEmitAll":"True","enablePhraseTextUnitClientSide":"True","enableParagraphDeltas":"True","enableParagraphDeltasVerboseLogging":"True","enableParagraphDeltasEmptyInitialTile":"True","enableRequiredServiceDataOnly":"True","enableExperimentalECCQueryDetectionFixes":"True","enableLoggingModulesAndBindings":"False"}',lastUpdated:(new Date).getTime(),manualOverride:!0};localStorage.setItem("featureFlags",JSON.stringify(e))}catch(e){zf("Error setting localStorage feature flags",e),null==b||b.logEvent({eventId:"EditorClientLocalStorageFFOverrideError",editorSessionId:null===(a=S.hostSettings.hostMetadata)||void 0===a?void 0:a.sessionId,errorMessage:String(e)})}return yield S.initializeSDK(),yield S.initializeUX(document),jf("EditorClient Initialized"),this.updateEditorClientCorrelationID(null===(l=T.getClientCorrelationId)||void 0===l?void 0:l.call(T)),null==b||b.logEvent({eventId:"EditorClientInitialized",editorSessionId:null===(u=S.hostSettings.hostMetadata)||void 0===u?void 0:u.sessionId,metaData:JSON.stringify({enabledEntities:null===(c=null===(d=S.hostSettings)||void 0===d?void 0:d.oaSettings)||void 0===c?void 0:c.entitiesEnabled})}),S}))}enableInlineSuggestionsMenu({targetElement:e,eccQueryCharacter:t,entitiesEnabled:n,enableExpandedECC:i,onEntitySelected:r,onItemSelected:s,onClose:l,onOpen:u,telemetryLogger:d,featureFlags:c,theme:h=a.SV.light,suggestionTitleAndSubTitle:g,inlineSuggestionsStyles:p,getCIQSuggestionsFromClient:f,fluentV9Theme:m}){var v,y,_,b;jf("EnableInlineSuggestionsMenu Called");const C=this.editorClient;if(null==C||C.attach(e),!(null==c?void 0:c.disableClientConfigQueryCharacterForEditorService))try{this.enableInlineSuggestions({entitiesEnabled:n,eccQueryCharacter:t,enableExpandedECC:i,onEntitySelected:r,onItemSelected:s,onClose:l,onOpen:u,telemetryLogger:d,featureFlags:c,suggestionTitleAndSubTitle:g,inlineSuggestionsStyles:p,fluentV9Theme:m})}catch(e){zf("Error in enableInlineSuggestionsMenu",e),null===(v=this.telemetryLogger)||void 0===v||v.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${t}. Error: `+JSON.stringify(e)})}if((null==c?void 0:c.enableAppGptsInCiq)||(null==c?void 0:c.enableAppPluginsInCiq)||(null==c?void 0:c.enableAppMessageExtensionsInCiq)||(null==c?void 0:c.enableAppPPInCiq)||(null==c?void 0:c.enableAppTypeBInCiq)){const e=[o.c.App],t=gf;try{this.enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:t,enableExpandedECC:!1,onEntitySelected:r,onItemSelected:s,onClose:l,onOpen:u,telemetryLogger:d,featureFlags:c,suggestionTitleAndSubTitle:g,inlineSuggestionsStyles:p,getCIQSuggestionsFromClient:f,fluentV9Theme:m})}catch(e){zf("Error in enableInlineSuggestionsMenu",e),null===(y=this.telemetryLogger)||void 0===y||y.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${t}. Error: `+JSON.stringify(e)})}}if(null==c?void 0:c.enableTopicECC){const e=[o.c.Topic],t="#";try{this.enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:t,enableExpandedECC:!0,onEntitySelected:r,onItemSelected:s,onClose:l,onOpen:u,telemetryLogger:d,featureFlags:c,suggestionTitleAndSubTitle:g,inlineSuggestionsStyles:p,fluentV9Theme:m})}catch(e){zf("Error in enableInlineSuggestionsMenu",e),null===(_=this.telemetryLogger)||void 0===_||_.logEvent({eventId:"ECCEnableInlineSuggestionMenuFailed",errorMessage:`Error in Enable Menu for ciq char ${t}. Error: `+JSON.stringify(e)})}}null==C||C.updateCurrentTheme(h),null===(b=this.telemetryLogger)||void 0===b||b.logEvent({eventId:"EditorClientThemeChanged",message:`Theme changed to ${h} in enableInlineSuggestionsMenu`})}disableInlineSuggestionsMenu({eccQueryCharacter:e,featureFlags:t},n){var i,r,o;jf("DisableInlineSuggestionsMenu Called");const a=null!=n?n:this.editorClient;if(!(null==t?void 0:t.disableClientConfigQueryCharacterForEditorService))try{null==a||a.disableInlineSuggestionsMenu(e)}catch(t){zf("Error in disableInlineSuggestionsMenu",t),null===(i=this.telemetryLogger)||void 0===i||i.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:`Error in Disable Menu for ciq char ${e}. Error: `+JSON.stringify(t)})}if(null==t?void 0:t.enableTopicECC)try{null==a||a.disableInlineSuggestionsMenu("#")}catch(e){zf("Error in disableInlineSuggestionsMenu",e),null===(r=this.telemetryLogger)||void 0===r||r.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:"Error in Disable Menu for ciq char #. Error: "+JSON.stringify(e)})}if((null==t?void 0:t.enableAppGptsInCiq)||(null==t?void 0:t.enableAppPluginsInCiq)||(null==t?void 0:t.enableAppMessageExtensionsInCiq)||(null==t?void 0:t.enableAppPPInCiq)||(null==t?void 0:t.enableAppTypeBInCiq))try{null==a||a.disableInlineSuggestionsMenu(gf)}catch(e){zf("Error in disableInlineSuggestionsMenu",e),null===(o=this.telemetryLogger)||void 0===o||o.logEvent({eventId:"ECCDisableInlineSuggestionMenuFailed",errorMessage:`Error in Disable Menu for ciq char ${gf}. Error: `+JSON.stringify(e)})}}destroyEditor(e){var t,n,i;jf("destroyEditor called");try{const t=null!=e?e:this.editorClient;!1===(null==t?void 0:t.isEditorClientShutdown)&&(null==t||t.shutDown())}catch(e){zf("Error in destroyEditor",e)}null===(t=this.telemetryLogger)||void 0===t||t.logEvent({eventId:"EditorClientDestroyed",editorSessionId:null===(i=null===(n=this.editorClient)||void 0===n?void 0:n.hostSettings.hostMetadata)||void 0===i?void 0:i.sessionId}),this.editorClient=null}setEntityScope(e){if(!this.editorClient)return;const t=((e="")=>{switch(!0){case/file/i.test(e):return o.c.File;case/(people)|(person)/i.test(e):return o.c.People;case/(event)|(meeting)/i.test(e):return o.c.Event;case/chat/i.test(e):return o.c.Chat;case/(message)|(email)/i.test(e):return o.c.Message;case/(topic)/i.test(e):return o.c.Topic;default:return}})(e);if(void 0===t)return void Hf(`Invoked setEntityScope with unsupported entity type ${e}`);const n=this.editorClient.exp_getQueryDetection();null==n||n.setCurrentScope({entityType:t},!1)}eccManuallyInitiated(e){if(!this.editorClient)return;const t=this.editorClient.exp_getQueryDetection();null==t||t.setNextDeltaProgramaticallyInserted(e)}notifyTriggeringType(e){if(!this.editorClient)return;const t=e;this.editorClient.notifyMenuTriggeringMethod(t)}updateCurrentTheme(e){var t,n;if(this.editorClient){try{this.editorClient.updateCurrentTheme(e),jf("Theme updated for CIQ to ",e)}catch(e){return zf("Exception updating theme for CIQ:",e),void(null===(t=this.telemetryLogger)||void 0===t||t.logEvent({eventId:"EditorClientThemeChangedError",errorMessage:e?`${e}`:""}))}null===(n=this.telemetryLogger)||void 0===n||n.logEvent({eventId:"EditorClientThemeChanged",message:`Theme changed to ${e}`})}else Hf("updateCurrentTheme, EditorClient not initialized")}setUnsupportedEntities(e){if(!this.editorClient)return;0===e.length&&Hf("unSupported enities list is empty");const t=this.editorClient.exp_getQueryDetection();null==t||t.setUnsupportedEntities(e)}updateEditorClientCorrelationID(e){if(!this.editorClient)return;const t=this.editorClient.exp_getQueryDetection(),n=null!=e?e:"";null==t||t.setClientCorrelationId(n)}onItemSelected(e,t,n,i,r,s){var l,u,d;if(jf("onItemSelected called Suggestion: ",e),!t)return void Hf("ECC injection failed due to undefined queryRange");const c=e;null==r||r.logEvent({eventId:"ECCEntitySelected",editorSessionId:null===(u=null===(l=this.editorClient)||void 0===l?void 0:l.hostSettings.hostMetadata)||void 0===u?void 0:u.sessionId,entityType:e.type,metaData:JSON.stringify({expansionType:this.currentTab,logicalId:c.logicalId,InvocationSource:this.currentInvocationSource,id:c.ReferenceId})}),(null==r?void 0:r.log3sEvent)&&(null==r||r.log3sEvent({eventType:"SearchEntityActions",localTime:(new Date).toISOString(),logicalId:null!==(d=c.logicalId)&&void 0!==d?d:"",id:c.ReferenceId,scenario:this.scenario,metaData:JSON.stringify({expansionType:this.currentTab,InvocationSource:this.currentInvocationSource})}));const h=((e,t,n)=>{var i,r,s,l,u,d,c,h,g,p,f,m,v;let y,_,b,C,T,S,I,w;switch(e.type){case o.c.People:{const s=e;if(!(null==s?void 0:s.EmailAddresses)||!s.DisplayName)return Hf("People ECC injection failed due to missing EmailAddresses or DisplayName"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.People,message:"People ECC injection failed due to missing EmailAddresses or DisplayName"}));_=s.DisplayName,b=(null==t?void 0:t.enablePeopleQueryAnnotationV2)&&null!==(i=s.Id)&&void 0!==i?i:s.EmailAddresses[0],C="",T="",y={queryAnnotationType:a.in.People,text:_,id:b},I={id:b,referenceId:null!==(r=s.ReferenceId)&&void 0!==r?r:"",displayName:s.DisplayName,emailAddresses:s.EmailAddresses};break}case o.c.File:{const t=e;if(!(null==t?void 0:t.AccessUrl))return Hf("File ECC injection failed due to missing AccessUrl"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.File,message:"File ECC injection failed due to missing AccessUrl"}));_=t.FileName,b=null!==(l=null!==(s=t.SpoId)&&void 0!==s?s:t.SpoUniqueId)&&void 0!==l?l:"",C=t.AccessUrl,T=t.AlternateAccessUrl,S=t.FileExtension,y={queryAnnotationType:a.in.File,text:_,id:b},I={id:b,referenceId:null!==(u=t.ReferenceId)&&void 0!==u?u:"",fileName:t.FileName,accessUrl:t.AccessUrl,spoId:b,dateModified:null!==(d=t.DateModified)&&void 0!==d?d:"",lastModifiedDisplayName:null!==(c=t.ModifiedByDisplayName)&&void 0!==c?c:"",fileSize:t.FileSize,alternateAccessUrl:t.AlternateAccessUrl};break}case o.c.Event:{const t=e;if(!(null==t?void 0:t.OriginalId))return Hf("Event ECC injection failed due to missing OriginalId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.Event,message:"Event ECC injection failed due to missing OriginalId"}));_=t.Subject,b=t.OriginalId,C=null!==(h=t.WebLink)&&void 0!==h?h:"",T="";const i={id:null!==(p=null===(g=t.EventId)||void 0===g?void 0:g.Id)&&void 0!==p?p:""};y={queryAnnotationType:a.in.Event,text:_,id:b},I={id:b,referenceId:null!==(f=t.ReferenceId)&&void 0!==f?f:"",originalId:t.OriginalId,subject:t.Subject,skypeTeamsMeetingUrl:t.SkypeTeamsMeetingUrl,start:t.Start,end:t.End,organizerName:t.OrganizerName,organizerAddress:t.OrganizerAddress,eventId:i,attendees:null===(m=t.Attendees)||void 0===m?void 0:m.map((e=>{var t,n;return{emailAddress:{name:null!==(t=e.EmailAddress.Name)&&void 0!==t?t:"",address:null!==(n=e.EmailAddress.Address)&&void 0!==n?n:""}}}))};break}case o.c.Chat:{const t=e;if(!(null==t?void 0:t.ThreadId))return Hf("Chat ECC injection failed due to missing ThreadId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.Chat,message:"Chat ECC injection failed due to missing ThreadId"}));if(t.Name)_=t.Name;else if(t.ChatMembers){const e=2,n=t.ChatMembers.length-e;let i=t.ChatMembers.slice(0,e).map((e=>e.DisplayName)).join(", ");n>0&&(i+=`, +${n}`),_=i}else _="";b=t.ThreadId,C="",T="",y={queryAnnotationType:a.in.Chat,text:_,id:b};break}case o.c.Message:{const t=e;if(!(null==t?void 0:t.ImmutableId))return Hf("Email ECC injection failed due to missing ImmutableId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.Message,message:"Email ECC injection failed due to missing ImmutableId"}));_=t.Subject,b=null===(v=t.ImmutableId)||void 0===v?void 0:v.Id,C="",T="",y={queryAnnotationType:a.in.Message,text:_,id:b};break}case o.c.Topic:{const t=e;if(!(null==t?void 0:t.TopicId))return Hf("Topic ECC injection failed due to missing TopicId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.Topic,message:"Topic ECC injection failed due to missing TopicId"}));_=t.DisplayName,b=t.TopicId,C=t.Url,T="",y={queryAnnotationType:a.in.Topic,text:_,id:b};break}case o.c.App:if(!(null==e?void 0:e.AppId))return Hf("App ECC injection failed due to missing AppId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.App,message:"App ECC injection failed due to missing AppId"}));b=e.AppId,_="",C="",T="",w={appId:e.AppId,collectorId:e.CollectorId,appType:e.AppType,title:e.Title,iconUrl:e.IconAnonymousUrl};break;default:return Hf(`onItemSelected called with unsupported suggestion type ${e.type}`),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:e.type,message:`onItemSelected called with unsupported suggestion type ${e.type}`}))}return{ciqEntityElement:{entityType:e.type,id:b,text:_,url:C,fileExtension:S,alternateUrl:T},annotation:y,rawEntityData:I,atMentionApp:w}})(e,s,r);h&&(this.currentQuery=null,this.currentTab=null,null==i||i(h.ciqEntityElement,h.annotation,t,n,h.rawEntityData,h.atMentionApp))}onOpen(e,t,n){var i,r;this.currentInvocationSource=e.invocationSource?e.invocationSource:e.triggerCharacter;let o={expansionSource:this.currentInvocationSource};const a=this.getLatencyForFlyout();a&&this.currentInvocationSource===gf&&(o=Object.assign(Object.assign({},o),{suggestionUpdateLatency:a,openCount:this.openCount,suggestionCount:this.suggestionCount})),this.updateFlyoutStartTime(),null==t||t.logEvent({eventId:"ECCOpened",editorSessionId:null===(r=null===(i=this.editorClient)||void 0===i?void 0:i.hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId,metaData:JSON.stringify(o)}),n&&n()}onClose(e,t,n,i){var r,o;jf(`onClose, searchResultAccepted: ${e}, persistTime: `,t),null==n||n.logEvent({eventId:"ECCClosed",editorSessionId:null===(o=null===(r=this.editorClient)||void 0===r?void 0:r.hostSettings.hostMetadata)||void 0===o?void 0:o.sessionId,metaData:JSON.stringify({selectedEntity:e,openedTime:t})}),i&&i(e,t)}onAction(e,t){var n,i;jf("onAction",e),null==t||t.logEvent({eventId:"ECCAction",editorSessionId:null===(i=null===(n=this.editorClient)||void 0===n?void 0:n.hostSettings.hostMetadata)||void 0===i?void 0:i.sessionId,metaData:JSON.stringify({actionId:e})})}onSuggestionsUpdatedFromClient(e,t,n,i,a){return(0,r.__awaiter)(this,void 0,void 0,(function*(){var r,s,l,u,d,c;const h=null!==(l=null===(s=null===(r=null==t?void 0:t[0])||void 0===r?void 0:r.entities[0])||void 0===s?void 0:s.logicalId)&&void 0!==l?l:"",g=yield e(null!==(u=this.currentInvocationSource)&&void 0!==u?u:"",null!=n?n:"");t[0]?t[0]=Object.assign(Object.assign({},t[0]),{entities:g}):t.push({entities:g,groupTitle:null==a?void 0:a.title,groupSubtitle:null==a?void 0:a.subtitle,entityType:o.c.App});const p=this.getLatencyForFlyout();return null==i||i.logEvent({eventId:"ECCSuggestionUpdated",editorSessionId:null===(c=null===(d=this.editorClient)||void 0===d?void 0:d.hostSettings.hostMetadata)||void 0===c?void 0:c.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:h,suggestionCount:t[0].entities.length.toString(),isQueryStringEmpty:""===n?"true":"false",suggestionUpdateLatency:null!=p?p:void 0,openCount:this.openCount,clientOverride:"true"})}),t}))}onSuggestionsUpdated(e,t,n,i,r,a,s){var l,u,d,c,h,g,p;let f,m="";if(0===t&&e[0]&&e[0].entities.length>0&&s&&(null==n?void 0:n.entityType)===o.c.App){const n=e[0].entities.filter((e=>{var t;return!(null===(t=null==e?void 0:e.GptIdentifier)||void 0===t?void 0:t.Id.includes("ProjectedDeclarativeAgent"))}));e[0]=Object.assign(Object.assign({},e[0]),{entities:n}),t=n.length>0?0:1}if(0===t&&e[0]&&e[0].entities.length>0){m=null!==(l=e[0].entities[0].logicalId)&&void 0!==l?l:"",this.currentTab=null!==(u=null==n?void 0:n.entityType)&&void 0!==u?u:"All";const t=((e,t)=>{var n,i,r,o,a;let s=null!==(n=e[0].entities[0].logicalId)&&void 0!==n?n:"",l=1;const u=[];if(t)for(const n of e[0].entities){const e=n;s=""!=s?s:null!==(i=e.logicalId)&&void 0!==i?i:"",u.push(Nf(null!==(r=e.ReferenceId)&&void 0!==r?r:"",t.entityType,l)),l++}else for(const t of e)for(const e of t.entities)if(e.isBestMatch){const t=e;s=""!=s?s:null!==(o=t.logicalId)&&void 0!==o?o:"",u.push(Nf(null!==(a=t.ReferenceId)&&void 0!==a?a:"",e.entityType,l)),l++}return u})(e,n);if(n)try{f=JSON.stringify({Type:"Group",Name:this.currentTab,ReferenceId:null,EntityType:null,LayoutType:"Vertical",Position:1,ResultsView:t})}catch(e){zf("Error in onSuggestionsUpdated",e)}if(r)for(const t of e)t.groupTitle=r.title,t.groupSubtitle=r.subtitle;const o=this.getLatencyForFlyout();null==i||i.logEvent({eventId:"ECCSuggestionUpdated",editorSessionId:null===(c=null===(d=this.editorClient)||void 0===d?void 0:d.hostSettings.hostMetadata)||void 0===c?void 0:c.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:m,suggestionCount:e[0].entities.length.toString(),isQueryStringEmpty:""===a?"true":"false",suggestionUpdateLatency:null!=o?o:void 0})}),(null==i?void 0:i.log3sEvent)&&(null==i||i.log3sEvent({localTime:(new Date).toISOString(),eventType:"ClientLayout",logicalId:m,id:m,scenario:this.scenario,resultsView:f?JSON.stringify(f):void 0,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:m})}))}else if(1===t||3===t){this.currentTab=null!==(h=null==n?void 0:n.entityType)&&void 0!==h?h:"All";const e=this.getLatencyForFlyout();null==i||i.logEvent({eventId:"ECCEmptySuggestionUpdated",editorSessionId:null===(p=null===(g=this.editorClient)||void 0===g?void 0:g.hostSettings.hostMetadata)||void 0===p?void 0:p.sessionId,metaData:JSON.stringify({expansionType:this.currentTab,expansionSource:this.currentInvocationSource,logicalId:m,isQueryStringEmpty:""===a?"true":"false",suggestionUpdateLatency:null!=e?e:void 0,status:1===t?"NoResults":"Timeout"})})}}enableInlineSuggestions({entitiesEnabled:e,eccQueryCharacter:t,enableExpandedECC:n,onEntitySelected:i,onItemSelected:a,onClose:s,onOpen:l,telemetryLogger:u,featureFlags:d,suggestionTitleAndSubTitle:c,inlineSuggestionsStyles:h,getCIQSuggestionsFromClient:g,fluentV9Theme:p}){var f;const m=this.editorClient;null==m||m.enableInlineSuggestionsMenu(e,t,a||((e,t,n)=>{this.onItemSelected(e,t,n,i,u,d)}),void 0,void 0,{fitToContent:!0},h||((null==d?void 0:d.enableSingleEntityStyle)?Uf:qf),(e=>{this.onOpen(e,u,l)}),((e,t)=>{this.onClose(e,t,u,s)}),(e=>{this.onAction(e,u)}),void 0,((e,t,n,i,a,s)=>(0,r.__awaiter)(this,void 0,void 0,(function*(){const n=g&&(null==s?void 0:s.entityType)===o.c.App;if(a&&!n)return this.openCount=0,void(this.suggestionCount=0);if(n){const n=yield this.onSuggestionsUpdatedFromClient(g,e,t,u,c);return a&&""===t&&(this.openCount++,this.suggestionCount=n[0].entities.length,this.updateFlyoutStartTime()),n}return this.onSuggestionsUpdated(e,i,s,u,c,t,null==d?void 0:d.disablePluginsAsDAInFlyout),e}))),(()=>{}),void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,n,void 0,void 0,p),null==u||u.logEvent({eventId:"EditorClientInlineSuggestionsEnabled",editorSessionId:null===(f=null==m?void 0:m.hostSettings.hostMetadata)||void 0===f?void 0:f.sessionId,metaData:JSON.stringify({eccQueryCharacter:t})})}}const Gf=(e,t,n)=>{var i,r,s,l,u,d,c,h,g,p,f,m,v;let y,_,b,C,T,S,I;switch(e.type){case"People":{const s=e;if(I=o.c.People,!s.details.emailAddresses||!s.name)return Hf("People ECC injection failed due to missing EmailAddresses or DisplayName"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.People,message:"People ECC injection failed due to missing EmailAddresses or DisplayName"}));_=s.name,b=(null==t?void 0:t.enablePeopleQueryAnnotationV2)&&null!==(i=s.id)&&void 0!==i?i:s.details.emailAddresses[0],C="",y={queryAnnotationType:a.in.People,text:_,id:b},S={id:b,referenceId:null!==(r=s.details.referenceId)&&void 0!==r?r:"",displayName:s.name,emailAddresses:s.details.emailAddresses};break}case"File":{const t=e;if(I=o.c.File,!(null==t?void 0:t.details.accessUrl))return Hf("File ECC injection failed due to missing AccessUrl"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:o.c.File,message:"File ECC injection failed due to missing AccessUrl"}));_=null!==(s=t.details.fileName)&&void 0!==s?s:t.name,b=null!==(u=null!==(l=t.details.spoId)&&void 0!==l?l:t.details.spoUniqueId)&&void 0!==u?u:"",C=null!==(d=t.details.accessUrl)&&void 0!==d?d:"",T=t.details.fileExtension,y={queryAnnotationType:a.in.File,text:_,id:b},S={id:b,referenceId:null!==(c=t.details.referenceId)&&void 0!==c?c:"",fileName:t.details.fileName,accessUrl:t.details.accessUrl,spoId:b,dateModified:null!==(h=t.details.dateModified)&&void 0!==h?h:"",lastModifiedDisplayName:null!==(g=t.details.modifiedByDisplayName)&&void 0!==g?g:"",fileSize:t.details.fileSize};break}case"Event":{const t=e;if(I=o.c.Event,!(null==t?void 0:t.details.originalId))return Hf("Event ECC injection failed due to missing OriginalId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:I,message:"Event ECC injection failed due to missing OriginalId"}));_=t.details.subject,b=t.details.originalId,C=null!==(p=t.details.webLink)&&void 0!==p?p:"";const i={id:null!==(f=t.details.eventId)&&void 0!==f?f:""};y={queryAnnotationType:a.in.Event,text:_,id:b},S={id:b,referenceId:null!==(m=t.details.referenceId)&&void 0!==m?m:"",originalId:t.details.originalId,subject:t.details.subject,skypeTeamsMeetingUrl:t.details.skypeTeamsMeetingUrl,start:t.details.start,end:t.details.end,organizerName:t.details.organizerName,organizerAddress:t.details.organizerAddress,eventId:i,attendees:null===(v=t.details.attendees)||void 0===v?void 0:v.map((e=>{var t,n;return{emailAddress:{name:null!==(t=e.EmailAddress.Name)&&void 0!==t?t:"",address:null!==(n=e.EmailAddress.Address)&&void 0!==n?n:""}}}))};break}case"Message":{const t=e;if(I=o.c.Message,!(null==t?void 0:t.details.immutableId))return Hf("Email ECC injection failed due to missing ImmutableId"),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:I,message:"Email ECC injection failed due to missing ImmutableId"}));_=t.details.subject,b=t.details.immutableId,C="",y={queryAnnotationType:a.in.Message,text:_,id:b};break}default:return Hf(`onItemSelected called with unsupported suggestion type ${e.type}`),void(null==n||n.logEvent({eventId:"ECCEntityInjectionFailed",entityType:e.type,message:`onItemSelected called with unsupported suggestion type ${e.type}`}))}return{ciqEntityElement:{entityType:I,id:b,text:_,url:C,fileExtension:T},annotation:y,rawEntityData:S,atMentionApp:void 0}},Qf="ciq-anchor",Kf=({appName:e,appPlatform:t,appScenario:n,sessionId:r,appId:o,appEnvironment:a,appVersion:s,clientId:l,userId:u,tenantId:d})=>({appName:e,appPlatform:t,appScenario:n,isCopilotScenario:"yes",appId:o,sessionId:r,clientId:l,userId:u,userType:i.UserTypeV2.AAD,releaseAudienceGroup:a,clientVersion:s,tenantId:d,identityProvider:i.IdentityProvider.AAD.toString(),licenseType:Jp.G_.Subscription,flightsToTrack:["mc-officeEditorTonalEnabled","mc-officeEditorDNNGrammarEnabled","mc-editor-oa"].join(";")}),$f=()=>new Date(Date.now()).toISOString().replace("T"," ").replace("Z",""),Zf=e=>(0,r.__awaiter)(void 0,[e],void 0,(function*({appName:e,appPlatform:t,sessionId:n,appEnvironment:o,appScenario:a,appVersion:s,locale:l,puid:u,tenantId:d,featureFlags:c,telemetryLogger:h,ciqV2Configuration:g,alSession:p,targetElement:f,onEntitySelected:m}){if(!p)throw new Error("Augloop session is required");if(!g)throw new Error("CIQ v2 configuration is required");const v=null!=l?l:"en-US";yield(e=>(0,r.__awaiter)(void 0,[e],void 0,(function*({appName:e,appPlatform:t,appScenario:n,sessionId:r,appEnvironment:o,appVersion:a,clientId:s,userId:l,tenantId:u}){yield(0,i.initializeCiqLogger)({clientMetadata:Kf({appName:e,appPlatform:t,appScenario:n,sessionId:r,appId:e,appEnvironment:o,appVersion:a,clientId:s,userId:l,tenantId:u}),transportActivityLogger:i.ciqConsoleLogger})})))({appName:e,appPlatform:t,sessionId:null!=n?n:"unknown",appScenario:null!=a?a:"AppChat",appId:e,appEnvironment:null!=o?o:"local",appVersion:null!=s?s:"unknown",clientId:g.clientId,userId:null!=u?u:"unknown",tenantId:null!=d?d:"unknown"});const y=(0,i.getCiqLogger)();y.info(0,"CIQ init started at "+$f());const _=new i.TextProcessorDefinition({settings:{locales:[v]}}),{ciqDefinition:b}=yield function(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const n=(0,i.getCiqLogger)();n.info(0,"CIQ definition: "+$f());const r=yield(0,i.initAugloopSource)({},t,e),o=yield(0,i.createCiqDefinition)({bootstrapConfig:{hostAppCiqConfig:t,rankerSetup:{rankerType:"MergingRanker"}},dataSources:[r]});return n.info(0,"CIQ definition: "+$f()),{ciqDefinition:o}}))}(p,g),C=new i.Editor({definitions:{textProcessor:_,ciq:b}});y.info(0,"CIQ core: Editor init "+$f()),yield C.init(),y.info(0,"Editor CIQ adapter "+$f());const T=new i.DomElementManager({targetDocument:document}),S=new i.DomTextReader({target:f,elementManager:T,editor:C});yield S.init();const I=new i.DomContentEditableTextWriter({elementManager:T,settings:{keepSelectionPosition:!0}}),w=(e=>{const t=document.querySelector(e);if(!t)throw new Error(`Element with selector ${e} not found in the document.`);return t})(`#${Qf}`),{ciqUiAdapter:E}=yield function(e,t,n,o,a,s){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const r=(0,i.getCiqLogger)();r.info(0,"CIQ UI Adapter: "+$f());const l=new Map(t.triggers.map((({char:e,enabledTabs:t})=>[e,{enabledTabs:t}]))),u=new i.EditorSdkCiqUiAdapter({targetCiqElement:n,targetEditorElement:o,editor:e,locale:s,onItemSelected:a,triggerCharacterConfig:l,fullWidth:!0});return u.init(),r.info(0,"Finished CIQ core: "+$f()),{ciqUiAdapter:u}}))}(C,g,w,f,((e,t)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){var n;const i=Gf(e,c,h);i&&(yield I.remove({start:t.startOffset,length:t.endOffset-t.startOffset,elementId:null!==(n=S.elementId)&&void 0!==n?n:"",range:t}),null==m||m(i.ciqEntityElement,i.annotation,t,void 0,i.rawEntityData,i.atMentionApp))}))),v);return yield((e,t)=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){const n=new i.EditorSdkQueryAdapter({queryDetectorConfig:{triggers:new Set(t.triggers.map((({char:e})=>e)))}},e);return n.init(),{queryAdapter:n}})))(C,g),y.info(0,"CIQ init finished at "+$f()),{disposeCiq:()=>(0,r.__awaiter)(void 0,void 0,void 0,(function*(){yield S.dispose(),yield I.dispose(),E.dispose(),yield C.dispose()}))}}))},28356:(e,t,n)=>{"use strict";n.d(t,{Xr:()=>l,fZ:()=>c,g0:()=>b,n4:()=>h,xU:()=>y});var i=n(75943);class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class o{constructor(e){i.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return i.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class g{constructor(e){i.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class p{constructor(e){i.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){i.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class m{constructor(e){i.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class v{constructor(e){i.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class y{constructor(e){i.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class _{constructor(e){i.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class b{constructor(e){i.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class C{constructor(e){i.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Core_CancelSignalTriggeredWorkflowExecutionOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return i.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()}},75943:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});class i{constructor(e){i.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=i.getTypeNameFor(e);return t?[t,...i.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=i.getTypeNameFor(e),r=i.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(r.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},41567:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});class i{constructor(e){i.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]}static getAllTypesFor(e){const t=i.getTypeNameFor(e);return t?[t,...i.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=i.getTypeNameFor(e),r=i.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(r.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},52484:(e,t,n)=>{"use strict";var i,r;n.d(t,{F:()=>i,b:()=>r}),function(e){e[e.Client=0]="Client",e[e.Server=1]="Server"}(i||(i={})),function(e){e.None="None",e.RecentlyAccessed="RecentlyAccessed",e.Frequent="Frequent",e.Trending="Trending",e.Uploaded="Uploaded"}(r||(r={}))},26017:(e,t,n)=>{"use strict";var i;n.d(t,{c:()=>i}),function(e){e.Acronym="Acronym",e.Address="Address",e.Attachment="Attachment",e.Bookmark="Bookmark",e.Building="Building",e.Channel="Channel",e.Chat="Chat",e.Conversation="Conversation",e.CopilotPlugin="CopilotPlugin",e.DateTime="DateTime",e.Document="Document",e.EditorialQnA="EditorialQnA",e.Email="Email",e.EmployeeOffer="EmployeeOffer",e.Event="Event",e.External="External",e.Fact="Fact",e.File="File",e.Flight="Flight",e.Floorplan="Floorplan",e.Folder="Folder",e.Group="Group",e.Keywords="Keywords",e.Link="Link",e.LocalBusiness="LocalBusiness",e.Loop="Loop",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Message="Message",e.MessageExtensionApp="MessageExtensionApp",e.PIM="PIM",e.People="People",e.Report="Report",e.Satori="Satori",e.Scope="Scope",e.SharePoint="SharePoint",e.Site="Site",e.Streams="Streams",e.Task="Task",e.Team="Team",e.Text="Text",e.Time="Time",e.Topic="Topic",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.TuringQnA="TuringQnA",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(i||(i={}))},48574:(e,t,n)=>{"use strict";n.d(t,{KL:()=>o,SM:()=>u,Yd:()=>s,aO:()=>r,k2:()=>l,uH:()=>a});var i=n(41567),r=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),o=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_NudgeAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_NudgeAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),a=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagAnnotation"},e.getBaseTypes=function(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),s=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_PredictionAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_PredictionAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}());!function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedAnnotation","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}()},84382:(e,t,n)=>{"use strict";n.d(t,{$g:()=>o,Fe:()=>r,J2:()=>s,Nh:()=>h,Vm:()=>c,Vn:()=>g,Zx:()=>u,c$:()=>l,gh:()=>d,os:()=>a});var i=n(41567),r=function(){function e(t){i.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UxTreatments"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),o=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),s=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_EccResultAnnotationODSP"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_EccResultAnnotation","AugLoop_ObservationalAssistance_EccResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),d=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_UserInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),c=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),h=(function(){function e(t){i.h.assign(e,this,t)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationClient"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationHybrid"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_SystemInitiatedResultAnnotationBase","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),g=function(){function e(t){i.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_ObservationalAssistance_FlagResultAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return i.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},48741:(e,t,n)=>{"use strict";var i;n.d(t,{i:()=>i}),function(e){e[e.Success=0]="Success",e[e.NoResults=1]="NoResults",e[e.Cancelled=2]="Cancelled",e[e.Timeout=3]="Timeout",e[e.UnexpectedError=4]="UnexpectedError",e[e.EarlyExit=5]="EarlyExit"}(i||(i={}))},93381:(e,t,n)=>{"use strict";var i,r,o,a,s,l,u,d,c,h;n.d(t,{Nm:()=>u,ck:()=>d}),function(e){e.Unknown="Unknown",e.File="File",e.Folder="Folder",e.Attachment="Attachment",e.Link="Link"}(i||(i={})),function(e){e.Unknown="Unknown",e.SharepointOnline="SharepointOnline",e.ModernAttachment="ModernAttachment",e.ClassicAttachment="ClassicAttachment",e.EmailLink="EmailLink",e.OneDriveForBusiness="OneDriveForBusiness"}(r||(r={})),function(e){e.Unknown="Unknown",e.DownloadableUrl="DownloadableUrl",e.ReaderUrl="ReaderUrl"}(o||(o={})),function(e){e.Person="Person",e.Group="Group",e.Other="Other"}(a||(a={})),function(e){e.OrganizationUser="OrganizationUser",e.OrganizationContact="OrganizationContact",e.PersonalContact="PersonalContact",e.ImplicitContact="ImplicitContact",e.ChatImplicitContact="ChatImplicitContact",e.Room="Room",e.Guest="Guest",e.UnifiedGroup="UnifiedGroup",e.PublicDistributionList="PublicDistributionList",e.PersonalDistributionList="PersonalDistributionList"}(s||(s={})),function(e){e.None="None",e.Organizer="Organizer",e.TentativelyAccepted="TentativelyAccepted",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded"}(l||(l={})),function(e){e.Membership="Membership",e.Address="Address",e.Invalid="Invalid"}(u||(u={})),function(e){e.Message="Message",e.Email="Email",e.Conversation="Conversation",e.Document="Document",e.Keywords="Keywords",e.People="People",e.Bookmark="Bookmark",e.Building="Building",e.EditorialQnA="EditorialQnA",e.Floorplan="Floorplan",e.Flight="Flight",e.Acronym="Acronym",e.TuringQnA="TuringQnA",e.Task="Task",e.External="External",e.Topic="Topic",e.MeetingCatchUp="MeetingCatchUp",e.MeetingProposal="MeetingProposal",e.MeetingRoomProposal="MeetingRoomProposal",e.Report="Report",e.Streams="Streams",e.Group="Group",e.Site="Site",e.Team="Team",e.Chat="Chat",e.Channel="Channel",e.Link="Link",e.EmployeeOffer="EmployeeOffer",e.Fact="Fact",e.Text="Text",e.Event="Event",e.File="File",e.SharePoint="SharePoint",e.Attachment="Attachment",e.PIM="PIM",e.MessageExtensionApp="MessageExtensionApp",e.Scope="Scope",e.TranscriptLlmAnswer="TranscriptLlmAnswer",e.Prompt="Prompt",e.PeopleInGroup="PeopleInGroup",e.App="App"}(d||(d={})),function(e){e.Off="Off",e.Forward="Forward",e.Reverse="Reverse"}(c||(c={})),function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning"}(h||(h={}))},91752:(e,t,n)=>{"use strict";var i,r,o,a;n.d(t,{bx:()=>i,lb:()=>r,xv:()=>o}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(i||(i={})),function(e){e[e.NotificationOnly=0]="NotificationOnly",e[e.Delete=1]="Delete",e[e.Ignore=2]="Ignore",e[e.IgnoreAll=4]="IgnoreAll",e[e.IgnoreCritiqueType=8]="IgnoreCritiqueType",e[e.AddToDictionary=16]="AddToDictionary",e[e.ShowDetails=32]="ShowDetails"}(r||(r={})),function(e){e[e.None=0]="None",e[e.ChangeOnce=1]="ChangeOnce",e[e.ChangeAll=2]="ChangeAll",e[e.AutoCorrect=4]="AutoCorrect",e[e.ReadAloud=8]="ReadAloud",e[e.PersonalizedAutoCorrect=16]="PersonalizedAutoCorrect"}(o||(o={})),function(e){e[e.None=0]="None",e[e.CAT_Spelling=1]="CAT_Spelling",e[e.CAT_Grammar=2]="CAT_Grammar",e[e.CAT_Clarity=3]="CAT_Clarity",e[e.CAT_Conciseness=4]="CAT_Conciseness",e[e.CAT_Formality=5]="CAT_Formality",e[e.CAT_Inclusiveness=6]="CAT_Inclusiveness",e[e.CAT_PunctuationConventions=7]="CAT_PunctuationConventions",e[e.CAT_Resume=8]="CAT_Resume",e[e.CAT_SensitiveGeopoliticalReferences=9]="CAT_SensitiveGeopoliticalReferences",e[e.CAT_Vocabulary=10]="CAT_Vocabulary",e[e.CAT_ConsistentWrittenForms=11]="CAT_ConsistentWrittenForms",e[e.CAT_ErrorCorrections=12]="CAT_ErrorCorrections",e[e.CAT_WritingConventions=13]="CAT_WritingConventions",e[e.CAT_Acronyms=14]="CAT_Acronyms",e[e.CAT_Perspectives=15]="CAT_Perspectives",e[e.CAT_UncommonWords=16]="CAT_UncommonWords",e[e.CAT_TypingErrors=17]="CAT_TypingErrors",e[e.CAT_Rewrite=18]="CAT_Rewrite"}(a||(a={}))},3327:(e,t,n)=>{"use strict";var i,r,o;n.d(t,{HS:()=>o,OD:()=>r,WI:()=>i}),function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(i||(i={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(r||(r={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(o||(o={}))},6510:(e,t,n)=>{"use strict";n.d(t,{s:()=>o});var i=n(75943);class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class o{constructor(e){i.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return i.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},90630:(e,t,n)=>{"use strict";n.d(t,{Cg:()=>o});var i=n(75943);class r{constructor(e){i.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class o{constructor(e){i.h.assign(o,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[o.getTypeName()])}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()};class a{constructor(e){i.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class s{constructor(e){i.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return i.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class l{constructor(e){i.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class u{constructor(e){i.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){i.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class c{constructor(e){i.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return i.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class h{constructor(e){i.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Text_CommentTile"}static getBaseTypes(){return[]}static typeGuard(e){return i.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()}},72971:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i=(0,n(63837).f)("ISessionContextProvider")},10059:(e,t,n)=>{"use strict";var i,r,o;function a(e){return e?Object.values(r).find((t=>t===e)):void 0}function s(e){const t=new Set([r.CIQFlag_DateEntityRecognition,r.CIQFlag_PersonEntityRecognition,r.CIQFlag_Location,r.CIQFlag_LocalBusiness,r.CIQFlag_TaskRecognition,r.HeadingDetection,r.CIQFlag_Topic,r.CIQFlag_SatoriEntityRecognition,r.CIQFlag_File,r.CIQFlag_Time]);return!!e&&t.has(e)}n.d(t,{$w:()=>o,L9:()=>r,bx:()=>i,e3:()=>a,oe:()=>s}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(i||(i={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec",e.TopicSuggestion="9bf58f9f-4159-40a1-80b8-4fe1f87c010d",e.CIQFlag_Location="1d456e3c-f436-4b8f-a315-1cc430bc2ee1",e.CIQFlag_LocalBusiness="1ECDDA98-C954-9863-87BD-4B0F493558FB",e.CIQFlag_PersonEntityRecognition="ffa21afe-fab3-423c-b579-8de8-128429f1cc8e",e.CIQFlag_DateEntityRecognition="349483fb-b654-4b4c-aefe-9f22bf147cd7",e.CIQFlag_TaskRecognition="c45ba192-bfae-4965-a833-694b55b1bd1d",e.CIQFlag_Topic="21422617-6650-456a-97cd-a7cd3116c39c",e.HeadingDetection="37e3346c-be6a-462c-afd7-282da13f6328",e.CIQFlag_SatoriEntityRecognition="9d9ccfb3-598c-e24c-3cda-11d260ae57d3",e.CIQFlag_File="17f49c82-b9f8-42d0-ab4e-dc076355d77a",e.CIQFlag_Time="9bd06192-906b-4693-99d3-7d58a1cf1770",e.Synonyms="23bd41d4-28ac-4cbc-ba24-2bba684c07da",e.DoubleSpaceGrammar="6d1d8c3d-62d5-45d1-b850-d8a98a24964b"}(r||(r={})),function(e){e.IgnoreOnce="IgnoreOnce",e.IgnoreAll="IgnoreAll",e.ApplySuggestion="ApplySuggestion",e.DisableCritiqueType="DisableCritiqueType",e.ShowFeedback="ShowFeedback"}(o||(o={}))},11387:(e,t,n)=>{"use strict";n.d(t,{r3:()=>c,_K:()=>d,OE:()=>u});var i=n(30206),r=n(20522),o=n(10059),a=n(87432);function s(e){const{text:t,action:n,languages:r,metadataJSON:o,description:s}=e,l=(0,i.__rest)(e,["text","action","languages","metadataJSON","description"]);return Object.assign({text:t,action:(0,a.fO)(n),languages:r,metadataJSON:o,description:s},l)}function l(e){const{text:t,action:n,languages:r,metadataJSON:o,description:s}=e,l=(0,i.__rest)(e,["text","action","languages","metadataJSON","description"]),{confidenceLevel:u,source:d}=l;return Object.assign({text:t,action:(0,a.BJ)(n),languages:r,metadataJSON:o,description:s,confidenceLevel:u||0,source:d||0},l)}function u(e){const{annotationId:t,typeId:n,traceId:a,sourceData:l,priority:u,supportedActions:d,suggestions:c,textInContext:h,start:g,length:p,metadata:f,nodeId:m,tileId:v,categoryTitle:y,isStealth:_,endNode:b,explanationTitle:C,explanationLabel:T,explanation:S,shouldShowMultilingualFre:I,languageId:w,shouldAttemptLanguageDetection:E}=e,x=(0,i.__rest)(e,["annotationId","typeId","traceId","sourceData","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign({annotationId:t,typeId:(0,o.e3)(n),typeIdRaw:n,traceId:a,sourceData:l,priority:u,supportedActions:(0,r.z)(d),suggestions:c.map(s),textInContext:h,start:g,length:p,metadata:f,nodeId:m,tileId:v,categoryTitle:y,isStealth:_,endNode:b,explanationTitle:C,explanationLabel:T,explanation:S,shouldShowMultilingualFre:I,languageId:w,shouldAttemptLanguageDetection:E},x)}function d(e){const{annotationId:t,typeIdRaw:n,traceId:o,sourceData:a,priority:s,supportedActions:u,suggestions:d,textInContext:c,start:h,length:g,metadata:p,nodeId:f,tileId:m,categoryTitle:v,isStealth:y,endNode:_,explanationTitle:b,explanationLabel:C,explanation:T,shouldShowMultilingualFre:S,languageId:I,shouldAttemptLanguageDetection:w}=e,E=(0,i.__rest)(e,["annotationId","typeIdRaw","traceId","sourceData","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign({annotationId:t,typeId:n,traceId:o,sourceData:a,priority:s,supportedActions:(0,r.N)(u),suggestions:d.map(l),textInContext:c,start:h,length:g,metadata:p,nodeId:f,tileId:m,categoryTitle:v,isStealth:y,endNode:_,explanationTitle:b,explanationLabel:C,explanation:T,shouldShowMultilingualFre:S,languageId:I,shouldAttemptLanguageDetection:w},E)}function c(e){return"isFlagCritique"in e}},20522:(e,t,n)=>{"use strict";n.d(t,{N:()=>r,z:()=>o});var i=n(91752);function r(e){let t=0;return e.delete&&(t|=i.lb.Delete),e.ignore&&(t|=i.lb.Ignore),e.ignoreAll&&(t|=i.lb.IgnoreAll),e.ignoreCritiqueType&&(t|=i.lb.IgnoreCritiqueType),e.addToDictionary&&(t|=i.lb.AddToDictionary),e.showDetails&&(t|=i.lb.ShowDetails),t}function o(e){return 0===e?a:{notificationOnly:!1,delete:!!(e&i.lb.Delete),ignore:!!(e&i.lb.Ignore),ignoreAll:!!(e&i.lb.IgnoreAll),ignoreCritiqueType:!!(e&i.lb.IgnoreCritiqueType),addToDictionary:!!(e&i.lb.AddToDictionary),showDetails:!!(e&i.lb.ShowDetails)}}const a={notificationOnly:!0,delete:!1,ignore:!1,ignoreAll:!1,ignoreCritiqueType:!1,addToDictionary:!1,showDetails:!1}},53920:(e,t,n)=>{"use strict";n.d(t,{Bb:()=>a,Q0:()=>r,pf:()=>i});var i,r,o=n(3327);function a(e){return e.deltaType===o.WI.AttributionUpdate&&void 0!==e.attributionData}!function(e){e.TileNode="TileNode",e.ParagraphNode="ParagraphNode"}(i||(i={})),function(e){e[e.Local=0]="Local",e[e.Code=1]="Code",e[e.Remote=2]="Remote"}(r||(r={}))},87432:(e,t,n)=>{"use strict";n.d(t,{BJ:()=>r,fO:()=>o,gA:()=>a});var i=n(91752);function r(e){let t=0;return e.changeOnce&&(t|=i.xv.ChangeOnce),e.changeAll&&(t|=i.xv.ChangeAll),e.autoCorrect&&(t|=i.xv.AutoCorrect),e.readAloud&&(t|=i.xv.ReadAloud),e.personalizedAutoCorrect&&(t|=i.xv.PersonalizedAutoCorrect),t}function o(e){return{changeOnce:(e&i.xv.ChangeOnce)===i.xv.ChangeOnce,changeAll:(e&i.xv.ChangeAll)===i.xv.ChangeAll,autoCorrect:(e&i.xv.AutoCorrect)===i.xv.AutoCorrect,readAloud:(e&i.xv.ReadAloud)===i.xv.ReadAloud,personalizedAutoCorrect:(e&i.xv.PersonalizedAutoCorrect)===i.xv.PersonalizedAutoCorrect}}function a(e){return!(e.changeOnce||e.changeAll||e.autoCorrect||e.readAloud||e.personalizedAutoCorrect)}},21813:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});const i={NumProofingLanguages:"NumProofingLanguages"}},85553:(e,t,n)=>{"use strict";n.d(t,{W:()=>a});var i,r=n(30206),o=n(48828);!function(e){e[e.NoReaction=0]="NoReaction",e[e.EnableFeature=1]="EnableFeature",e[e.DisableFeature=2]="DisableFeature"}(i||(i={}));let a=class{constructor(){this._listenerId=0,this._callbacks=new Map,this.ignoreDisablers=!1,this.disablers=[],this.enablers=[]}triggerListeners(e){const t=this._callbacks.get(e.eventId);if(!t||0===t.length)return;let n=!0;return t.forEach((t=>{const[i,r]=t.callback(e);n=this.processCallBackResult(n,i,r)})),n}processCallBackResult(e,t,n){return t!==i.NoReaction?e&&t===i.EnableFeature:e}nextListenerId(){return this._listenerId+=1,this._listenerId}addListener(e,t){const n={callback:t,id:this.nextListenerId()};let i=this._callbacks.get(e);return i||(i=[],this._callbacks.set(e,i)),i.push(n),n.id}removeListener(e){e&&this._callbacks.forEach(((t,n,i)=>{t&&-1!==t.findIndex((t=>t.id===e))&&i.set(n,t.filter((t=>t.id!==e)))}))}emitAndEvaluate(e){const t=this.triggerListeners(e);if(!this.ignoreDisablers)for(const e of this.disablers){if(!0===e)return!1;if(!1!==e&&e.check())return!1}let n=!1;for(const e of this.enablers)if(!0===e||!1!==e&&e.check()){n=!0;break}return void 0===t?n:n&&t}};a=(0,r.__decorate)([(0,o._)()],a)},8903:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});const i=(0,n(63837).f)("IFeatureFlagsReader")},33300:(e,t,n)=>{"use strict";n.d(t,{In:()=>a,d2:()=>i,kY:()=>r});var i,r,o=n(63837);!function(e){e[e.SettingsClicked=0]="SettingsClicked"}(i||(i={})),function(e){e[e.dropdown=0]="dropdown",e[e.languageDetectionNotificationBar=1]="languageDetectionNotificationBar",e[e.toneRewriteFre=2]="toneRewriteFre",e[e.multilingualFooterFre=3]="multilingualFooterFre",e[e.manageLanguages=4]="manageLanguages"}(r||(r={}));const a=(0,o.f)("IExternalSettingsFeature")},40617:(e,t,n)=>{"use strict";n.d(t,{FS:()=>r,U1:()=>i,Zp:()=>a});var i,r,o=n(63837);!function(e){e[e.ClientInitialized=0]="ClientInitialized"}(i||(i={})),function(e){e[e.WordDictionaryInit=0]="WordDictionaryInit"}(r||(r={}));const a=(0,o.f)("IRoamingDictionaryFeature")},98242:(e,t,n)=>{"use strict";n.d(t,{DS:()=>c,KW:()=>h,OV:()=>i,xr:()=>r});var i,r,o=n(30206),a=n(63837),s=n(48828),l=n(90424),u=n(85553),d=n(88215);!function(e){e[e.ShowPage=0]="ShowPage",e[e.GetMoreCommands=1]="GetMoreCommands"}(i||(i={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout"}(r||(r={}));const c=(0,a.f)("IShowSynonymsFeature");let h=class extends u.W{constructor(e){super(),this._isPremiumUser=e,this.disablers=[],this.enablers=[!1,this._isPremiumUser]}};h=(0,o.__decorate)([(0,s._)(),(0,o.__param)(0,(0,l.W)(d.r))],h)},72700:(e,t,n)=>{"use strict";n.d(t,{Gv:()=>p,o9:()=>i,tq:()=>g,v$:()=>r});var i,r,o=n(30206),a=n(63837),s=n(48828),l=n(90424),u=n(85553),d=n(8903),c=n(83225),h=n(75361);!function(e){e[e.SettingsShown=0]="SettingsShown",e[e.CalloutShown=1]="CalloutShown",e[e.PageContext=2]="PageContext"}(i||(i={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout",e[e.PageContext=2]="PageContext"}(r||(r={}));const g=(0,a.f)("IUnsignedInEditorFeature");let p=class extends u.W{constructor(e,t,n){super(),this._featureFlagsReader=t,this._languageDetector=n,this.enablers=[!0],this.disablers.push(this),this.disablers.push(e)}check(){return!this._featureFlagsReader.flags.enableUnsignedInEditor}async emitAndEvaluateAsync(e){return this.emitAndEvaluate(e)&&this.checkForMultipleLanguages()}async checkForMultipleLanguages(){const e=await this.countUniqueLanguages();return!this._featureFlagsReader.flags.enableSuppressUnsignedInEditorForMultiLang||e<=1}async countUniqueLanguages(){return(await this._languageDetector.getBrowserLanguages()).reduce(((e,t)=>{const n=t.split("-");if(n.length>0){const t=n[0];e.add(t)}return e}),new Set).size}};p=(0,o.__decorate)([(0,s._)(),(0,o.__param)(0,(0,l.W)(h.Z)),(0,o.__param)(1,(0,l.W)(d.c)),(0,o.__param)(2,(0,l.W)(c.v))],p)},88215:(e,t,n)=>{"use strict";n.d(t,{r:()=>u});var i=n(30206),r=n(48828),o=n(90424),a=n(36230),s=n(72783),l=n(1149);let u=class extends l.t{constructor(e){super(e)}checkUserInfo(){return this._expiry?Date.now()<=this._expiry:this.licenseType===s.G_.Subscription}setGracePeriodUntil(e){this._expiry=e}};u=(0,i.__decorate)([(0,r._)(),(0,i.__param)(0,(0,o.W)(a.e))],u)},75361:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l});var i=n(30206),r=n(36230),o=n(48828),a=n(90424),s=n(1149);let l=class extends s.t{constructor(e){super(e)}checkUserInfo(){return!!this.isLoggedIn}};l=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(r.e))],l)},38714:(e,t,n)=>{"use strict";n.d(t,{W:()=>l});var i=n(30206),r=n(48828),o=n(90424),a=n(8903),s=n(76511);let l=class{constructor(e,t){this._featureFlagsReader=e,this._paragraphDeltasEnabled=t}check(){return this._paragraphDeltasEnabled.check()&&this._featureFlagsReader.flags.enableOptimizedRehydration}};l=(0,i.__decorate)([(0,r._)(),(0,i.__param)(0,(0,o.W)(a.c)),(0,i.__param)(1,(0,o.W)(s.H))],l)},76511:(e,t,n)=>{"use strict";n.d(t,{H:()=>l});var i=n(30206),r=n(48828),o=n(90424),a=n(8903),s=n(44680);let l=class{constructor(e,t){this._hostSettings=e,this._featureFlagsReader=t}check(){return!!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableParagraphUpdates&&this._featureFlagsReader.flags.enableParagraphDeltas}};l=(0,i.__decorate)([(0,r._)(),(0,i.__param)(0,(0,o.W)(s.n)),(0,i.__param)(1,(0,o.W)(a.c))],l)},1149:(e,t,n)=>{"use strict";n.d(t,{t:()=>o});var i=n(30206),r=n(48828);let o=class{constructor(e){this._userInfoStrategy=e}check(){return this._userInfoStrategy.execute(!1,(e=>(this.setUserInfo(e),e))),this.checkUserInfo()}setUserInfo(e){e&&(this.licenseType=e.licenseType,this.identityProvider=e.identityProvider,this.ageGroup=e.ageGroup,this.ctry=e.ctry),this.isLoggedIn=!!e}};o=(0,i.__decorate)([(0,r._)()],o)},72783:(e,t,n)=>{"use strict";var i,r,o,a,s,l;n.d(t,{G_:()=>s,P2:()=>l}),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(i||(i={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(r||(r={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(o||(o={})),function(e){e.GCC="GCC",e.Worldwide="WW"}(a||(a={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(l||(l={}))},36230:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var i,r=n(63837);!function(e){e.StorageUserInfoV2Strategy="StorageUserInfoV2Strategy",e.None="None"}(i||(i={}));const o=(0,r.f)("IUserInfoStrategy")},90858:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});const i=(0,n(63837).f)("IUserInfoUpdater")},96993:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});var i,r=n(63837);!function(e){e[e.Undefined=0]="Undefined",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(i||(i={}));const o=(0,r.f)("IComponentInitializer")},29714:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const i=(0,n(63837).f)("IRegistrable")},95481:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});const i=(0,n(63837).f)("IRegistrar")},83225:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i=(0,n(63837).f)("IUxLanguageDetector")},91822:(e,t,n)=>{"use strict";n.d(t,{I:()=>a});var i=n(30206),r=n(46546),o=n(92037);class a{constructor(e){this.equalsTo=e=>{if(!e||this._codesList.length!==e.length)return!1;for(let t=0;t<this._codesList.length;t+=1)if(this._codesList[t].toLocaleLowerCase()!==e[t].toLocaleLowerCase())return!1;return!0},this.add=e=>!this._codesList.includes(e)&&(this._codesList.push(e),!0),this.remove=e=>{const t=this._codesList.indexOf(e);return!(t<0||(this._codesList.splice(t,1),0))},this.moveUp=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const n=this._codesList[t-1];return this._codesList[t-1]=this._codesList[t],this._codesList[t]=n,!0},this.moveDown=e=>{const t=this._codesList.indexOf(e);if(t<0||t===this._codesList.length-1)return!1;const n=this._codesList[t+1];return this._codesList[t+1]=this._codesList[t],this._codesList[t]=n,!0},this.moveToTop=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const n=this._codesList[t];for(let e=t;e>0;e-=1)this._codesList[e]=this._codesList[e-1];return this._codesList[0]=n,!0},this._codesList=e,(0,o.Gn)(this)}get count(){var e;return null!==(e=this._codesList.length)&&void 0!==e?e:0}get defaultLanguageCode(){return a.getDefaultLanguageCode(this._codesList)}static getDefaultLanguageCode(e){return e&&e.length>0?e[0]:""}get codesList(){return this._codesList||[]}}(0,i.__decorate)([r.observable],a.prototype,"_codesList",void 0),(0,i.__decorate)([r.computed],a.prototype,"count",null),(0,i.__decorate)([r.computed],a.prototype,"defaultLanguageCode",null),(0,i.__decorate)([r.computed],a.prototype,"codesList",null)},36747:(e,t,n)=>{"use strict";n.d(t,{K3:()=>i,aP:()=>a,iw:()=>o});var i,r=n(63837);!function(e){e.auto="auto",e.ltr="ltr",e.rtl="rtl"}(i||(i={}));const o=(0,r.f)("ILanguageScriptDirectionDetector"),a=(0,r.f)("ILanguageScriptDirectionDetectorFactory")},38716:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});const i=(0,n(63837).f)("ILocalizer")},44579:(e,t,n)=>{"use strict";var i,r;n.d(t,{f:()=>r,n:()=>i}),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized",e.ActionDisableCritique="ActionDisableCritique",e.OverflowMenuClicked="OverflowMenuClicked",e.UndoCalloutShown="UndoCalloutShown",e.PersonalizedUndoCalloutShown="PersonalizedUndoCalloutShown",e.SquiggleTooltipShown="SquiggleTooltipShown",e.CritiquesShown="CritiquesShown"}(i||(i={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError"}(r||(r={}))},13915:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});const i=(0,n(63837).f)("IAggregateLogger")},86278:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i=(0,n(63837).f)("ILogger")},86310:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});const i=(0,n(63837).f)("IOaLogger")},13494:(e,t,n)=>{"use strict";n.d(t,{M5:()=>r,pD:()=>a,zJ:()=>o});var i=n(63837);const r=(0,i.f)("IHostEmitter"),o=(0,i.f)("IHostEmitterArray");var a;!function(e){e.tileCheckRequestV1="tileCheckRequestV1",e.configV2RequestEvent="configV2RequestEvent",e.hostModelTileStateReset="hostModelTileStateReset",e.hostModelVisualStateChange="hostModelTileVisualStateChange",e.hostModelDelta="hostModelDelta",e.hostModelFormattingDelta="hostModelFormattingDelta",e.hostModelAttributionDelta="hostModelAttributionDelta",e.hostModelTextTile="hostModelTextTile",e.hostModelParagraphTextTiles="hostModelParagraphTextTiles",e.hostModelMoveTextTile="hostModelMoveTextTile",e.hostModelRehydrateTiles="hostModelRehydrateTiles",e.hostModelRehydrateTilesFinished="hostModelRehydrateTilesFinished",e.hostModelAddedRootNode="hostModelAddedRootNode",e.hostModelRemovedRootNode="hostModelRemovedRootNode",e.hostModelCritiques="hostModelCritiques",e.hostModelCritiqueAction="hostModelCritiqueAction",e.hostModelFlags="hostModelFlags",e.hostModelTextTileEmittedToAugloop="hostModelTextTileEmittedToAugloop",e.oaRankedAnnotations="oaRankedAnnotations",e.oaAnnotationsTriggered="oaAnnotationsTriggered",e.oaFlagAnnotationsTriggered="oaFlagAnnotationsTriggered",e.oaMenuControlSignal="oaMenuControlSignal",e.predictionTriggered="predictionTriggered",e.nudgeTriggered="nudgeTriggered",e.nudgeAccepted="nudgeAccepted",e.headingDetectionRecognized="headingDetectionRecognized",e.instrumentationRequestV1="instrumentationRequestV1",e.tileCheckResponseV1="tileCheckResponseV1",e.configV2ResponseEvent="configV2ResponseEvent",e.clearTileCritiques="clearTileCritiques",e.clearCritiquesForNode="clearCritiquesForNode",e.restoreNodeForCritiqueStore="restoreNodeForCritiqueStore",e.telemetryEvent="telemetryEvent",e.newActivityTelemetryEvent="newActivityTelemetryEvent",e.activitySetSuccessTelemetryEvent="activitySetSuccessTelemetryEvent",e.activitySetResultTelemetryEvent="activitySetResultTelemetryEvent",e.activityAddDataFieldTelemetryEvent="activityAddDataFieldTelemetryEvent",e.activityEndNowTelemetryEvent="activityEndNowTelemetryEvent",e.saveCritiqueSettings="saveCritiqueSettings",e.critiqueSettingsChange="critiqueSettingsChange",e.ciqSettingsChange="ciqSettingsChange",e.critiqueValuePerLanguageChanged="critiqueValuePerLanguageChanged",e.saveInlineEditingSettings="saveInlineEditingSettings",e.autoCorrectLanguagesUpdated="autoCorrectLanguagesUpdated",e.addWordToDictionaryLocally="addWordToDictionaryLocally",e.setRoamingDictionaryState="setRoamingDictionaryState",e.enableRoamingDictionary="enableRoamingDictionary",e.updateCurrentSessionDictionary="updateCurrentSessionDictionary",e.setAugLoopState="setAugLoopState",e.getAugLoopState="getAugLoopState",e.squiggleClick="squiggleClick",e.taskRecognitionSignal="taskRecognitionSignal",e.toneDetection="toneDetection",e.autoCorrectionTriggered="autoCorrectionTriggered",e.writeProofingLanguage="writeProofingLanguage",e.readProofingLanguage="readProofingLanguage",e.readProofingUserDictionary="readProofingUserDictionary",e.readRoamingProofingOverriddenOptions="readRoamingProofingOverriddenOptions",e.copywriterRequestSuggestions="copywriterRequestSuggestions",e.copywriterSuggestionsReady="copywriterSuggestionsReady",e.seenEventTriggered="seenEventTriggered",e.addWordsToRoamingUserDictionary="addWordsToRoamingUserDictionary",e.requestSynonyms="requestSynonyms",e.receivedSynonyms="receivedSynonyms",e.writeProofingSettingsToRoaming="writeProofingSettingsToRoaming",e.readOASettings="readOASettings",e.writeOASettings="writeOASettings",e.conditionalOrchestratorSettingsChanged="conditionalOrchestratorSettingsChanged",e.aiInsertRequestSuggestions="aiInsertRequestSuggestions",e.aiInsertSuggestionsReady="aiInsertSuggestionsReady",e.logout="logout",e.textAugmentationCoreResponse="textAugmentationCoreResponse",e.textAugmentationCoreRemovalResponse="textAugmentationCoreRemovalResponse",e.textAugmentationCoreRequest="textAugmentationCoreRequest"}(a||(a={}))},21077:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});const i=(0,n(63837).f)("IInstrumentationMessageProcessor")},59886:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});const i=(0,n(63837).f)("IProofingEmitter")},99828:(e,t,n)=>{"use strict";var i;n.d(t,{G:()=>i}),function(e){e.NewData="NewData",e.RemoveData="RemoveData",e.ChangeData="ChangeData"}(i||(i={}))},97428:(e,t,n)=>{"use strict";function i(e){return e}n.d(t,{z:()=>i})},84878:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});const i=(0,n(63837).f)("IsMobile")},60933:(e,t,n)=>{"use strict";n.d(t,{u:()=>Ye});var i=n(86432),r=n(97428),o=n(19846),a=n(48828);class s{constructor(){this.imports=[]}get uniqueId(){return(0,r.z)(507918419)}configureRootServices(e){!function(e,t,n){try{(0,o.Yi)(e,t,void 0)}catch(e){}}((0,a._)(),i.bk)}}var l,u=n(70532),d=n(30206),c=(l=[],{fireEvent:function(e){l.forEach((function(t){return t(e)}))},addListener:function(e){e&&l.push(e)}});function h(e,t,n){c.fireEvent({level:e,category:t,message:n})}var g={};function p(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?g[e]?(t.ariaTenantToken&&(g[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(g[e].dnmToken=t.dnmToken)):g[e]=t:h(0,0,(function(){return"Namespace: ".concat(e)}))}function f(e,t){for(var n=e.length;n>0;){var i=e.substr(0,n);if(g[i]){var r=g[i];return t.ariaTenantToken=r.ariaTenantToken,t.dnmToken=r.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var m=9007199254740991,v=-m,y=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,_=/^[a-zA-Z0-9_\.]{1,95}$/;function b(e){return _.test(e)}function C(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!b(e.name))throw new Error("Invalid dataField name");2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<v||e>m)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)}))}var T=n(109);function S(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,d.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var I=function(){function e(e,t,n){var i,r,o;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=(0,d.__assign)((0,d.__assign)({},e.getConfig()),this.config),(r=this.partAFields).push.apply(r,e.partAFields)),t&&(o=this.persistentDataFields).push.apply(o,t)}return e.prototype.addEventContentType=function(e,t){e.push((0,T.Ug)("EventContent.Type",t))},e.prototype.sendTelemetryEvent=function(e){var t=S(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var i=n.ariaTenantToken;i||f(t.eventName,n)||i?this.sendTelemetryEventInternal(t,1):h(0,0,(function(){return"No tenant token: "+e.eventName}))},e.prototype.sendNonStandardEvent=function(e,t){var n=S(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=S(e),n=t.telemetryProperties,i=n.customerContentVersion;return(!i||i>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=S(e),n=t.telemetryProperties;n.dnmToken||f(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):h(0,0,(function(){return"No dnm token: "+t.eventName}))},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):h(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e,t)}catch(e){return void function(e,t,n){h(0,0,(function(){var e=n instanceof Error?n.message:"";return"".concat("SendTelemetryEvent",": ").concat(e)}))}(0,0,e)}this.telemetrySinks.forEach((function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}}))}else h(0,0,(function(){return"Customer content"}))},e.prototype.processTelemetryEvent=function(e,t){var n,i,r;if(e.dataFields&&(null===(r=e.dataFields)||void 0===r||r.unshift((0,T.m9)("OTelJS.Version","4.20.30")),3!==t&&this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.partAFields.length>0){var o=e.eventContract||{name:"",dataFields:[]};(i=o.dataFields).push.apply(i,this.partAFields),e.eventContract=o}this.config.disableValidation||function(e){if(!(t=e.eventName)||t.length>98||!y.test(t))throw new Error("Invalid eventName");var t,n=e.eventContract;if(n){if(n.name&&!b(n.name))throw new Error("Invalid eventContract");C(n.dataFields)}C(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var i=n[t],r=i[0],o=i[1];this.sendTelemetryEventInternal(r,o)}},e.prototype.setTenantToken=function(e,t,n){p(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){p(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return S(e)},e.prototype.getConfig=function(){return this.config},e}();function w(e,t){return e?e+"."+t:t}function E(e,t,n,i,r){void 0===r&&(r=4),i&&e.push((0,T.m9)("".concat(w(t,n)),i,r))}function x(e,t,n,i){"boolean"==typeof i&&e.push((0,T.LK)("".concat(w(t,n)),i))}function A(e,t,n,i){"number"==typeof i&&e.push((0,T.Ug)("".concat(w(t,n)),i))}var D,N,F,P,k={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",n=[];return E(n,t,"CV",e.cV),A(n,t,"Duration",e.duration),A(n,t,"Count",e.count),A(n,t,"AggMode",e.aggMode),x(n,t,"Success",e.success),e.result&&n.push.apply(n,function(e){var t="Activity.Result",n=[];return A(n,t,"Code",e.code),E(n,t,"Type",e.type),A(n,t,"Tag",e.tag),x(n,t,"IsExpected",e.isExpected),n.push((0,T.m9)("zC.Activity.Result","Office.System.Result")),n}(e.result)),n.push((0,T.m9)("zC.Activity",this.contractName)),n}};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.iOS="iOS",e.Android="Android"}(D||(D={})),function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(N||(N={})),function(e){var t,n,i,r,o="Copilot";(r=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",r.IsSeen="IsSeen",r.IsTried="IsTried",r.IsKept="IsKept",r.IsRejected="IsRejected",(i=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",i.Commanding="Commanding",i.QAandSummaries="QA and Summaries",i.Collaboration="Collaboration",i.Suggestions="Suggestions",(n=e.EntryPoint||(e.EntryPoint={})).Chat="Chat",n.Canvas="Canvas",(t=e.Verb||(e.Verb={})).Create="Create",t.Command="Command",t.Ask="Ask",t.Summarize="Summarize",t.Share="Share",t.Analyze="Analyze",e.getFields=function(e){var t=[];return E(t,o,"FeatureActionType",e.featureActionType),x(t,o,"IsUserInitiated",e.isUserInitiated),E(t,o,"FeatureName",e.featureName),E(t,o,"SubFeatureName",e.subFeatureName),E(t,o,"Capability",e.capability),x(t,o,"IsThumbsUp",e.isThumbsUp),E(t,o,"EntryPoint",e.entryPoint),E(t,o,"Verb",e.verb),E(t,o,"InteractionId",e.interactionId),E(t,o,"ConversationId",e.conversationId),t.push((0,T.m9)("zC.".concat(o),"Office.System.Copilot")),t}}(F||(F={})),function(e){var t,n="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return E(t,n,"EventType",e.eventType),E(t,n,"Pillar",e.pillar),E(t,n,"Scenario",e.scenario),E(t,n,"Veto",e.veto),E(t,n,"Error",e.error),x(t,n,"InStaging",e.inStaging),x(t,n,"IsSessionEndingError",e.isSessionEndingError),x(t,n,"IsIntentional",e.isIntentional),x(t,n,"IsInternal",e.isInternal),t.push((0,T.m9)("zC.".concat(n),"Office.System.Asha")),t}}(P||(P={}));var O=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(O=function(){return 1e3*Math.floor(window.performance.now())});var B,R,L,M,q,U,W,j=function(e){var t,n=O(),i=S(e.telemetryEvent);return(0,d.__assign)((0,d.__assign)({cv:e.parentCv.getNext()},i),{createChildActivity:function(t){return j({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){var i,r,o=this;if(!t){void 0===this.success&&void 0===this.result&&h(1,0,(function(){return"Activity does not have success or result set"}));var a=O();t=!0;var s={duration:a-n,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},l=null!==(r=null===(i=this.eventContract)||void 0===i?void 0:i.dataFields)&&void 0!==r?r:[];return l.push.apply(l,k.getFields(s)),this.eventContract={name:k.contractName,dataFields:l},e.sendTelemetryEvent(this)}h(0,0,(function(){return"'".concat(o.eventName,"' already ended")}))}})},z=n(17570),H=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.baseCv=(0,z.N)(),r}return(0,d.__extends)(t,e),t.prototype.createActivity=function(e){return j({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t.prototype.sendActivity=function(e,t,n,i){return this.sendTelemetryEvent({eventName:e,eventContract:{name:k.contractName,dataFields:k.getFields(t)},dataFields:n,eventFlags:i})},t.prototype.sendError=function(e){var t=function(e){var t="Error",n=[];return n.push((0,T.m9)("".concat(t,".ErrorGroup"),e.errorGroup)),n.push((0,T.Ug)("".concat(t,".Tag"),e.tag)),void 0!==e.code&&n.push((0,T.Ug)("".concat(t,".Code"),e.code)),void 0!==e.id&&n.push((0,T.Ug)("".concat(t,".Id"),e.id)),void 0!==e.count&&n.push((0,T.Ug)("".concat(t,".Count"),e.count)),n}(e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t.prototype.createCustomerContentActivity=function(e){return j({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},t}(I),V=n(59834);(B||(B={})).getFields=function(e,t){var n=[];return n.push((0,T.Ug)("".concat(e,".Code"),t.code)),void 0!==t.type&&n.push((0,T.m9)("".concat(e,".Type"),t.type)),void 0!==t.tag&&n.push((0,T.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&n.push((0,T.LK)("".concat(e,".IsExpected"),t.isExpected)),n.push((0,T.m9)("zC.Activity.Result","Office.System.Result")),n},function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n="Activity",i=[];return void 0!==t.cV&&i.push((0,T.m9)("".concat(n,".CV"),t.cV)),i.push((0,T.Ug)("".concat(n,".Duration"),t.duration)),i.push((0,T.Ug)("".concat(n,".Count"),t.count)),i.push((0,T.Ug)("".concat(n,".AggMode"),t.aggMode)),void 0!==t.success&&i.push((0,T.LK)("".concat(n,".Success"),t.success)),void 0!==t.result&&i.push.apply(i,B.getFields("".concat(n,".Result"),t.result)),i.push((0,T.m9)("zC.Activity",e.contractName)),i}}(R||(R={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,T.m9)("".concat(e,".Id"),t.id)),void 0!==t.version&&n.push((0,T.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&n.push((0,T.m9)("".concat(e,".SessionId"),t.sessionId)),n}}(L||(L={})),(M||(M={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push((0,T.m9)("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&n.push((0,T.m9)("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push((0,T.m9)("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push((0,T.m9)("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&n.push((0,T.m9)("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&n.push((0,T.LK)("".concat(e,".IsAnonymous"),t.isAnonymous)),n},(q||(q={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push((0,T.m9)("".concat(e,".Name"),t.name)),void 0!==t.state&&n.push((0,T.m9)("".concat(e,".State"),t.state)),n},(U||(U={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,T.Ug)("".concat(e,".Id"),t.id)),void 0!==t.name&&n.push((0,T.m9)("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&n.push((0,T.m9)("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&n.push((0,T.m9)("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&n.push((0,T.m9)("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push((0,T.Ug)("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),n},function(e){e.getFields=function(e,t){var n=[];return n.push((0,T.m9)("".concat(e,".ErrorGroup"),t.errorGroup)),n.push((0,T.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.code&&n.push((0,T.Ug)("".concat(e,".Code"),t.code)),void 0!==t.id&&n.push((0,T.Ug)("".concat(e,".Id"),t.id)),void 0!==t.count&&n.push((0,T.Ug)("".concat(e,".Count"),t.count)),n}}(W||(W={}));var G,Q=R,K=B,$=W,Z=q,J=L,Y=U,X=M;!function(e){var t,n;t=e.Office||(e.Office={}),(n=t.System||(t.System={})).Activity=Q,n.Result=K,n.Error=$,n.Funnel=Z,n.Host=J,n.User=X,n.UserAction=Y}(G||(G={}));var ee=n(86388),te=n(20399),ne=n(72896);class ie{constructor(e,t,n=!1,i=new H){this.kpisEnabled=n,this._oTelTelemetryLogger=i;const{logGroupName:r,tenant:o}=e,{tenantName:a,ariaTenantToken:s,nexusTenantToken:l}=o;this._logGroupName=r,this._oTelTelemetryLogger.addSink(t),this._oTelTelemetryLogger.setTenantToken(`Office.${a}`,s,l),this._namespace=`Office.${a}.${r}`}logEvent(e,t,n,i,r,o,a,s,l){const u=n===ee.h.Undefined?t:`${n}.${t}`;if(i===te.q.Debug)return;const d=[(0,T.Ug)("Tag",e),(0,T.Ug)("Level",i)];r&&d.push((0,T.m9)(null!=l?l:"Data",(0,ne.v)(r))),d.forEach((e=>e.classification=V.o.DataClassification.SystemMetadata)),this.uploadEvent(u,d,null!=o?o:ie.DEFAULT_SAMPLING_POLICY,null!=a?a:ie.DEFAULT_DIAGNOSTIC_LEVEL,null!=s?s:ie.DEFAULT_DATA_CATEGORIES)}logKpi(e,t,n,i,r){if(!this.kpisEnabled)return;const o=`KPIs.${e}`,a=[(0,T.m9)("Entity_Id",t),(0,T.LK)("IsPremium",i)];r&&a.push((0,T.m9)("Data",JSON.stringify(r))),a.forEach((e=>e.classification=V.o.DataClassification.SystemMetadata));const s=G.Office.System.Funnel.getFields("Funnel",{name:this._logGroupName,state:n});a.push(...s),this.uploadEvent(o,a,V.o.SamplingPolicy.CriticalUsage,V.o.DiagnosticLevel.RequiredServiceData,V.o.DataCategories.ProductServiceUsage)}logStandaloneMetric(e,t,n,i,r=[]){const o=null!=t?t:ie.DEFAULT_SAMPLING_POLICY,a=null!=n?n:ie.DEFAULT_DIAGNOSTIC_LEVEL,s=null!=i?i:ie.DEFAULT_DATA_CATEGORIES;this.uploadEvent(e,r,o,a,s)}createActivity(e,t,n){const i=t?`${t}.${e}`:e;return this._oTelTelemetryLogger.createActivity({eventName:this.getFullEventName(i),eventFlags:null!=n?n:{dataCategories:V.o.DataCategories.ProductServiceUsage}})}uploadEvent(e,t,n,i,r){const o=this.getFullEventName(e);this._oTelTelemetryLogger.sendTelemetryEvent({eventName:o,dataFields:t,eventFlags:{dataCategories:r,diagnosticLevel:i,costPriority:V.o.CostPriority.Normal,persistencePriority:V.o.PersistencePriority.Normal,samplingPolicy:n}})}getFullEventName(e){return this.capitalize(`${this._namespace}.${e}`)}capitalize(e){return e.split(".").map(this.capitalizeWord).join(".")}capitalizeWord(e){return e.charAt(0).toUpperCase()+e.slice(1)}}ie.DEFAULT_SAMPLING_POLICY=V.o.SamplingPolicy.Measure,ie.DEFAULT_DIAGNOSTIC_LEVEL=V.o.DiagnosticLevel.RequiredServiceData,ie.DEFAULT_DATA_CATEGORIES=V.o.DataCategories.ProductServiceUsage;var re=n(90935),oe=n(85553),ae=n(33300);let se=class extends oe.W{constructor(){super(),this.disablers=[],this.enablers=[!1]}openSettings(e){const t={eventId:ae.d2.SettingsClicked,sender:e};this.emitAndEvaluate(t)}};se=(0,d.__decorate)([(0,a._)()],se);var le=n(70578),ue=n(16103),de=n(40747),ce=n(13494),he=n(44680),ge=n(36747),pe=n(86278),fe=n(59886),me=n(29714),ve=n(95481),ye=n(40617),_e=n(72971),be=n(63837);const Ce=(0,be.f)("ITransportActivity"),Te=(0,be.f)("ITransportLogger");var Se=n(72700),Ie=n(88215),we=n(75361),Ee=n(47954);const xe=(e,t,n,i)=>{const r={eventName:e,tagID:`0x${`00000000${t.toString(16)}`.slice(-8)}`,message:n,data:i};return JSON.stringify(r)};let Ae=class{async initialize(e){}addCorrelationID(e){console.log(`CorrelationID is: ${e}`)}log(e,t,n,i){this.dispatchLog(null,e,t,n,i)}debug(e,t,n){this.dispatchLog(null,e,te.q.Debug,t,n)}error(e,t,n){this.dispatchLog(null,e,te.q.Error,t,n)}warn(e,t,n){this.dispatchLog(null,e,te.q.Warn,t,n)}info(e,t,n){this.dispatchLog(null,e,te.q.Info,t,n)}logEvent(e,t,n,i,r,o){this.dispatchLog(t,e,n,i,o)}dispatchLog(e,t,n,i,r){switch(n){case te.q.Debug:console.log(xe(e,t,i,r));break;case te.q.Error:console.error(xe(e,t,i,r));break;case te.q.Info:console.info(xe(e,t,i,r));break;case te.q.Warn:console.warn(xe(e,t,i,r));break;default:throw new Error("Invalid logging level")}}getNewActivity(e,t,n){console.log(e)}};Ae=(0,d.__decorate)([(0,a._)()],Ae);var De=n(17288),Ne=n(30122),Fe=n(90424);let Pe=class{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1,this._diagosticEventName="GeneralDiagnostics",this.logDiagnostics=(e,t,n,i)=>{this.logActivityBase(this._diagosticEventName,e,t,n,i)},this.logActivity=(e,t,n,i)=>{this.logActivityBase(e,void 0,t,n,i)},this.logActivityBase=(e,t,n,i,r)=>{const o=this.getNewActivity(e,V.o.SamplingPolicy.CriticalExperimentation);t&&(null==o||o.dataFields.push((0,De.n)("message",t))),n&&(null==o||o.dataFields.push((0,De.n)("data",JSON.stringify(n)))),i&&(null==o||o.dataFields.push(...i)),o&&(o.success=!0,o.endNow())}}async initialize(e,t,n,i,r){var o;if(!this._initialized){if(!this._initializing)try{this._debugMode=null!==(o=await(null==e?void 0:e.read(Ee.l.DebugMode)))&&void 0!==o&&o,this._debugMode&&this._transports.push(new Ae);for(const o of this._transports)await o.initialize(e,n,i,t,r);this._activityTransport&&await this._activityTransport.initialize(e,n,i,t,r)}finally{this._initializing=!1}this._initialized=!0}}config({transports:e,activityTransport:t}){return this._transports=e,this._activityTransport=t,this}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,n,i){this.logEvent(e,null,t,n,V.o.SamplingPolicy.Measure,i)}info(e,t,n){this.logEvent(e,null,te.q.Info,t,V.o.SamplingPolicy.Measure,n)}warn(e,t,n){this.logEvent(e,null,te.q.Warn,t,V.o.SamplingPolicy.Measure,n)}error(e,t,n){this.logEvent(e,null,te.q.Error,t,V.o.SamplingPolicy.CriticalBusinessImpact,n)}debug(e,t,n){this.logEvent(e,null,te.q.Debug,t,V.o.SamplingPolicy.Diagnostics,n)}logServiceRequest(e,t,n,i,r){for(const o of this._transports)t&&(o.serviceRequestID=t),this.logEvent(e,null,n,i,V.o.SamplingPolicy.Measure,r)}logEvent(e,t,n,i,r,o,a){if(this._initialized&&(this._debugMode||n!==te.q.Debug))for(const s of this._transports)s.logEvent(e,t,n,i,r,o,a)}getNewActivity(e,t,n){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,n):void 0}dispose(){}};var ke;Pe=(0,d.__decorate)([(0,a._)(),(0,d.__param)(0,(0,Ne.t)(Te)),(0,d.__param)(1,(0,Fe.W)(Ce))],Pe),function(e){e.Offered="Offered",e.Seen="Seen",e.Tried="Tried",e.Kept="Kept",e.Rejected="Rejected"}(ke||(ke={}));var Oe=n(36230);const Be=["facetCodes","statusCode","innerMostErrorCode","sprequestguid"];function Re(e){return e.map((e=>e[1]?Le(e[0],e[1]):void 0)).filter((e=>!!e))}function Le(e,t,n){return(0,De.n)(e,t,V.o.DataClassification.SystemMetadata,n)}function Me(e){const t={};return function(e,t){var n;const i="object"==typeof e&&null!==e;function r(t){if(!i)return;const n=e[t];return"string"==typeof n?n:void 0}t.errorMessage=null!==(n=r("message"))&&void 0!==n?n:String(e),t.errorName=r("name"),t.stack=r("stack"),t.errorType=r("errorType"),t.errorInstanceId=r("errorInstanceId"),Be.forEach((n=>{const i=e[n];i&&(t[n]="object"==typeof i?JSON.stringify(i):i)}))}(e,t),t.message?t.message=`${t.message}\n${t.errorMessage}`:t.message=t.errorMessage,void 0===t.stack&&(t.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}()),t}var qe;let Ue=qe=class{constructor(e,t,n){this._telemetrySink=e,this._loggerSettings=t,this._userInfoStrategy=n,this._appId="",this._clientId="",this._initialized=!1,this._initializing=!1,this._configurationId=""}async initialize(e,t,n,i,r){if(!this._initialized){if(!this._initializing){this._initializing=!0;try{this._hostSettings=r,this._sessionContext=t,this._configurationId=await e.read(Ee.l.ConfigurationId),this._appId=await e.read(Ee.l.AppId),this._clientId=await e.read(Ee.l.ClientId),this._internalLogger=new ie(this._loggerSettings,this._telemetrySink)}finally{this._initializing=!1}}this._initialized=!0}}logEvent(e,t,n,i,r,o,a){if(this._initialized&&this._loggerSettings.defaultEventName){const s=t||this._loggerSettings.defaultEventName;this.sendLog(s,e,n,i,r,o,a)}}getNewActivity(e,t,n){var i,r,o,a;if(!this._initialized)return;const s=this._internalLogger.createActivity(e,void 0,{dataCategories:V.o.DataCategories.ProductServiceUsage,diagnosticLevel:V.o.DiagnosticLevel.RequiredServiceData});if(null===(i=this._userInfoStrategy)||void 0===i||i.execute(!1,(e=>(e&&s.dataFields.push(...Re([["User_Id",e.userId],["Tenant_Id",e.tenantId],["Identity_Provider",JSON.stringify(e.identityProvider)],["License_Type",e.licenseType]])),e))),s.dataFields.push(...this.getSessionContextDataFields()),s.dataFields.push(...Re([["App_Id",this._appId],["Client_Id",this._clientId],["CorrelationID",null!==(r=this._sessionCorrelationId)&&void 0!==r?r:""],["ConfigurationId",this._configurationId],["FlightsToTrack",null===(a=null===(o=this._hostSettings)||void 0===o?void 0:o.flightsToTrack)||void 0===a?void 0:a.join(";")]])),n){const t=qe.createFunnelContract(e,n);s.dataFields.push(...t)}return s}getSessionContextDataFields(){var e,t;return this._sessionContext?Re([["Browser_Type",this._sessionContext.browserType],["Browser_Version",null!==(e=this._sessionContext.browserVersion)&&void 0!==e?e:""],["Store_Runtime_Id",null!==(t=this._sessionContext.extensionStoreId)&&void 0!==t?t:""],["Extension_Version",this._sessionContext.extensionVersion],["Extension_Version_Name",this._sessionContext.extensionVersionName]]):[]}addCorrelationID(e){this._sessionCorrelationId=e}sendLog(e,t,n,i,r,o,a){var s,l,u;if(!this._initialized||n===te.q.Debug)return;const d=[];this.serviceRequestId&&d.push(Le("Service_Request_Id",this.serviceRequestId,V.o.DataFieldType.Guid.valueOf())),this._sessionContext&&d.push(...this.getSessionContextDataFields());let c="",h="",g="";null===(s=this._userInfoStrategy)||void 0===s||s.execute(!1,(e=>{var t;return e&&(c=e.userId,h=null!==(t=e.tenantId)&&void 0!==t?t:"",g=e.identityProvider.toString()),e})),d.push(...Re([["Tag",t.toString()],["Tag_Hex",t.toString(16)],["Level",te.q[n]],["App_Id",this._appId],["Client_Id",this._clientId],["User_Id",c],["Tenant_Id",h],["Identity_Provider",g],["Text_Message",i],["Correlation_Id",this._sessionCorrelationId],["Data",o instanceof Error?JSON.stringify(Me(o)):o?JSON.stringify(o):void 0],["FlightsToTrack",null===(u=null===(l=this._hostSettings)||void 0===l?void 0:l.flightsToTrack)||void 0===u?void 0:u.join(";")]])),a&&qe.createFunnelContract(e,a).forEach((e=>d.push(e))),this._internalLogger.logStandaloneMetric(e,r,V.o.DiagnosticLevel.RequiredServiceData,V.o.DataCategories.NotSet,d)}static createFunnelContract(e,t){const n=ke[t];return G.Office.System.Funnel.getFields(e,{name:e,state:n})}};Ue=qe=(0,d.__decorate)([(0,a._)(),(0,d.__param)(0,(0,Fe.W)(ue.qy)),(0,d.__param)(1,(0,Fe.W)(ue.k_)),(0,d.__param)(2,(0,Fe.W)(Oe.e))],Ue);let We=class extends i.bk{constructor(){super(...arguments),this.eventNamesUsed=new Set}async initialize(){}shutDown(){for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}on(e,t){super.on(e,t),this.eventNamesUsed.add(e)}off(e,t){try{super.off(e,t)}catch(e){}}};We=(0,d.__decorate)([(0,a._)()],We);let je=class{constructor(e){this.registrables=e,this.initializeCalled=!1,this.shutDownCalled=!1}async initialize(){var e;if(!this.initializeCalled){this.initializeCalled=!0;for(const e of this.registrables)await e.initialize();for(const t of this.registrables)await(null===(e=t.servicesInitialized)||void 0===e?void 0:e.call(t));this.shutDownCalled=!1}}shutDown(){if(!this.shutDownCalled){this.shutDownCalled=!0;for(const e of this.registrables)e.shutDown()}}async addRegistrable(e){var t;await e.initialize(),await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e)),this.registrables.push(e)}async recheckRegistrables(e){var t;const n=e.getAll(me.S),i=[];for(const e of n)this.registrables.includes(e)||(await e.initialize(),this.registrables.push(e),i.push(e));for(const e of i)await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e))}};var ze;je=(0,d.__decorate)([(0,a._)(),(0,d.__param)(0,(0,Ne.t)(me.S))],je),function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.LOAD_ERROR=3]="LOAD_ERROR"}(ze||(ze={}));let He=class extends oe.W{constructor(e){super(),this.hostSettings=e,this.disablers=[],this.enablers=[!0]}check(){return!this.hostSettings.enableRoamingDictionary&&!this.hostSettings.enableV2RoamingDictionary}getRoamingDictionary(){return this._roamingDictionary}setRoamingDictionary(e){this._roamingDictionary=e}isReady(){return!this.check()&&void 0!==this._roamingDictionary&&this._roamingDictionary.getLoadState()===ze.LOADED}processCallBackResult(e,t,n){return this._roamingDictionary=n.roamingDictionary,super.processCallBackResult(e,t,n)}};He=(0,d.__decorate)([(0,a._)(),(0,d.__param)(0,(0,Fe.W)(he.n))],He);class Ve{constructor(e,t){this.name=e,this.version=t}}class Ge{constructor(e){this.version=e,this.name="node"}}class Qe{constructor(){this.bot=!0,this.name="bot",this.version=null}}const Ke=3,$e=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]];function Ze(e){const t=""!==e&&$e.reduce(((t,[n,i])=>{if(t)return t;const r=i.exec(e);return!!r&&[n,r]}),!1);if(!t)return null;const[n,i]=t;if("searchbot"===n)return new Qe;let r=i[1].split(/[._]/).slice(0,3);return r?r.length<Ke&&(r=[...r,...Je(Ke-r.length)]):r=[],new Ve(n,r.join("."))}function Je(e){const t=[];for(let n=0;n<e;n+=1)t.push("0");return t}class Ye{constructor(){this.imports=[s]}get uniqueId(){return(0,r.z)(507918415)}configureRootServices(e){e.bind(ve.V).to(je),e.bind(ce.M5).to(We),e.bind(me.S).toExisting(ce.M5),e.bind(ce.zJ).toExisting(ce.M5),e.bind(fe.o).to(We),e.bind(me.S).toExisting(fe.o),e.bind(de.G).to(le.L),e.bind(Ue).toSelf(),e.bind(Te).toExisting(Ue),e.bind(Ce).toExisting(Ue),e.bind(pe.g).to(Pe);const t=new u.a,n=e.getOptional(ue.qy);if(n){const{logGroupName:i,tenant:r,logToConsole:o,logToKusto:a}=t,s=new ie({logGroupName:i,tenant:r,defaultEventName:"",logToConsole:o,logToKusto:a},n,!0);(0,re.L)(s),e.bind(ue.ZL).toValue(s)}e.bind(ue.k_).toValue(t),e.bind(ge.aP).toValue((()=>e.getOptional(ge.iw))),e.bind(Ie.r).toSelf(),e.bind(ae.In).to(se),e.bind(ye.Zp).to(He),e.bind(we.Z).toSelf(),e.bind(Se.tq).to(Se.Gv),e.bind(_e.a).toDynamicValue((e=>{let t;const n=e.get(he.n);return async()=>t?Promise.resolve(t):new Promise((i=>{var r,o,a,s,l,u;const d=c?Ze(c):navigator?Ze(navigator.userAgent):process.version?new Ge(process.version.slice(1)):null;var c;t={os:void 0,arch:void 0,browserType:null!==(r=null==d?void 0:d.name)&&void 0!==r?r:"",browserVersion:null!==(o=null==d?void 0:d.version)&&void 0!==o?o:null,extensionStoreId:"",languageUxId:"",extensionVersion:"",extensionVersionName:"",sessionId:null!==(s=null===(a=n.hostMetadata)||void 0===a?void 0:a.sessionId)&&void 0!==s?s:e.get(de.G).generate(),composeSessionId:null!==(u=null===(l=n.hostMetadata)||void 0===l?void 0:l.composeSessionId)&&void 0!==u?u:e.get(de.G).generate()},i(t)}))}))}}},7523:(e,t,n)=>{"use strict";n.d(t,{k:()=>s});var i=n(29714),r=n(1628),o=n(32847),a=n(97428);class s{get uniqueId(){return(0,a.z)(507347844)}configureRootServices(e){e.bind(r.J).to(o.k),e.bind(i.S).toExisting(r.J)}}},2612:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});const i=(0,n(63837).f)("IPaneOpenState")},47954:(e,t,n)=>{"use strict";var i;n.d(t,{l:()=>i}),function(e){e.AppId="appId",e.EnableCopilotInsert="enableCopilotInsert",e.EnableCopilotRewrite="enableCopilotRewrite",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.EnableSynonymsToggle="enableSynonymsToggle",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.HashedUserDictionary="hashedUserDictionary",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.OverriddenInlineEditingSettings="overriddenInlineEditingSettings",e.PaneOverriddenCritiqueTypeOptions="paneOverriddenCritiqueTypeOptions",e.StealthOverriddenCritiqueTypeOptions="stealthOverriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.DefaultLoggingLevel="defaultLoggingLevel",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId",e.CritiqueValuePerLanguage="critiqueValuePerLanguage",e.EnableTextPrediction="enableTextPrediction",e.EnableCIQFlags="enableCIQFlags",e.EnableCIQMenu="enableCIQMenu",e.IsLanguageAutoDetectEnabled="isLanguageAutoDetectEnabled",e.TonalFREAccepted="tonalFREAccepted"}(i||(i={}))},98287:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i=(0,n(63837).f)("IProofingPersistedStore")},11117:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});const i=(0,n(63837).f)("IRoamingDictionaryBroker")},70532:(e,t,n)=>{"use strict";var i;n.d(t,{a:()=>r}),function(e){e.Diagnostics="Diagnostics"}(i||(i={}));class r{constructor(){this.logGroupName="EditorBx",this.tenant={tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},this.defaultEventName=i.Diagnostics,this.logToConsole=!1,this.logToKusto=!0}}},26878:(e,t,n)=>{"use strict";function i(e,t){var n;return!!e&&!0===(null===(n=e.find((e=>e.entityType===t)))||void 0===n?void 0:n.enabled)}function r(e,t){var n;if(e)return null===(n=e.find((e=>e.entityType===t)))||void 0===n?void 0:n.maxResults}function o(e,t,n,r){return!!(null!=e?e:[]).includes(r)||i(t,n)}n.d(t,{Z$:()=>r,f1:()=>o,i$:()=>i})},83732:(e,t,n)=>{"use strict";n.d(t,{e:()=>r,rI:()=>o});var i=n(63837);const r=(0,i.f)("ILanguageListStateStore"),o=((0,i.f)("SupportsIndividualCIQFlagDisabling"),(0,i.f)("IEditorSettingsManager"))},44680:(e,t,n)=>{"use strict";n.d(t,{d:()=>i,n:()=>o});var i,r=n(63837);!function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email",e[e.EditorLandingPage=3]="EditorLandingPage"}(i||(i={}));const o=(0,r.f)("IHostSettings")},35761:(e,t,n)=>{"use strict";function i(e,t){return e.dataSource===t.dataSource&&e.userId===t.userId&&e.timestamp===t.timestamp}n.d(t,{G:()=>i})},67127:(e,t,n)=>{"use strict";function i(e,t){return!(!e||!t)&&e.start===t.start&&e.length===t.length&&e.priority===t.priority&&e.textInContext===t.textInContext&&e.nodeId===t.nodeId}function r(e,t){return!(e.start>=t.start+t.length||t.start>=e.start+e.length)}function o(e){const t=new Map;for(const n of e){if(!n.tileId)continue;const e=t.get(n.tileId.nodeId);e?e.push(n):t.set(n.tileId.nodeId,[n])}return t}n.d(t,{PD:()=>o,gS:()=>i,tw:()=>r})},23094:(e,t,n)=>{"use strict";n.d(t,{J:()=>r});var i=n(2579);class r{constructor(e){this.listeners={},this.captureListeners={},this.element=(0,i.E)(e)?e:new i.O(e)}addListener(e,t,n){const i=this.element.deref();if(i){if(null==n?void 0:n.capture){if(e in this.captureListeners)throw new Error(`Event ${e} previously registered.`);this.captureListeners[e]=t}else{if(e in this.listeners)throw new Error(`Event ${e} previously registered.`);this.listeners[e]=t}i.addEventListener(e,t,n)}}removeListener(e,t){const n=this.element.deref();n&&((null==t?void 0:t.capture)?e in this.captureListeners&&(n.removeEventListener(e,this.captureListeners[e],t),delete this.captureListeners[e]):e in this.listeners&&(n.removeEventListener(e,this.listeners[e]),delete this.listeners[e]))}removeAllListeners(){for(const e of Object.keys(this.listeners))this.removeListener(e);this.listeners={};for(const e of Object.keys(this.captureListeners))this.removeListener(e,{capture:!0});this.captureListeners={}}}},19432:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});class i{constructor(){this.listeners={}}subscribe(e,t){var n;const i=null!==(n=this.listeners[e])&&void 0!==n?n:[];i.push(t),this.listeners[e]=i}unsubscribe(e,t){var n;let i=null!==(n=this.listeners[e])&&void 0!==n?n:[];i=i.filter((e=>e!==t)),this.listeners[e]=i}publishEvent(e,t){var n;const i=null!==(n=this.listeners[e])&&void 0!==n?n:[];for(const e of i)try{e(t)}catch(e){}}}},70578:(e,t,n)=>{"use strict";n.d(t,{L:()=>a});var i=n(30206),r=n(48828),o=n(4413);let a=class{generate(){return(0,o.A)()}};a=(0,i.__decorate)([(0,r._)()],a)},85079:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});const i=(0,n(63837).f)("ICompositionEventHandler")},40747:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});const i=(0,n(63837).f)("IGuidGenerator")},9654:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});const i=(0,n(63837).f)("IQueryDetection")},33984:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});const i=(0,n(63837).f)("IResourceUrlFormatter")},9420:(e,t,n)=>{"use strict";n.d(t,{K2:()=>s,KV:()=>l,Pe:()=>a,Sg:()=>d,ug:()=>u});var i=n(10056),r=n(11272),o=n(3755);const a=e=>{const t=e;return void 0!==t.x&&void 0!==t.y},s=e=>{const t=e;return void 0!==t.left&&void 0!==t.top&&void 0!==t.width&&void 0!==t.height};function l(e){return e?(0,o.C)(e,"HTMLElement")?e:s(e)?new r.M(e.left,e.right,e.top,e.bottom):a(e)?e:e.getBoundingClientRect():null}function u(e){if(e)return s(e)?{getBoundingClientRect:()=>{var t,n;return{x:e.left,y:e.top,top:e.top,left:e.left,bottom:null!==(t=e.bottom)&&void 0!==t?t:0,right:null!==(n=e.right)&&void 0!==n?n:0,width:e.width,height:e.height}}}:a(e)?{getBoundingClientRect:()=>({x:e.x,y:e.y,top:e.y,left:e.x,bottom:e.y,right:e.x,width:0,height:0})}:e}function d(e){if(void 0===e)return{position:"below",align:"start"};switch(e){case i.A.topLeftEdge:return{position:"above",align:"start"};case i.A.topCenter:case i.A.topAutoEdge:return{position:"above",align:"center"};case i.A.topRightEdge:return{position:"above",align:"end"};case i.A.bottomLeftEdge:return{position:"below",align:"start"};case i.A.bottomCenter:case i.A.bottomAutoEdge:return{position:"below",align:"center"};case i.A.bottomRightEdge:return{position:"below",align:"end"};case i.A.leftTopEdge:return{position:"before",align:"top"};case i.A.leftCenter:return{position:"before",align:"center"};case i.A.leftBottomEdge:return{position:"before",align:"bottom"};case i.A.rightTopEdge:return{position:"after",align:"top"};case i.A.rightCenter:return{position:"after",align:"center"};case i.A.rightBottomEdge:return{position:"after",align:"bottom"}}}},1628:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});const i=(0,n(63837).f)("ITimer")},3755:(e,t,n)=>{"use strict";function i(e){var t;const n=e&&(e.commonAncestorContainer||e),i=n&&(n.ownerDocument||("[object HTMLDocument]"===Object.prototype.toString.apply(n)?n:null));return i&&(null!==(t=i.defaultView)&&void 0!==t?t:window)}function r(e,t){const n=i(e),r=n&&n[t],o=window,a=o&&o[t];return a&&e instanceof a||r&&e instanceof r}n.d(t,{C:()=>r,e:()=>i})},31685:(e,t,n)=>{"use strict";n.d(t,{c:()=>c,j:()=>u});var i=n(30206),r=n(44680),o=n(2579),a=n(63837),s=n(48828),l=n(90424);const u=(0,a.f)("ISafeWindow"),d=1e4;let c=class{constructor(e){this._hostSettings=e,this._clearanceIntervalId=void 0,this._requestedFrames=[],this._requestedIdleFrames=[]}async initialize(){this._hostSettings.enableClearingOfRequestedAnimationFrames&&this.setIntervals()}shutDown(){var e;this._clearanceIntervalId&&(clearInterval(this._clearanceIntervalId),this._clearanceIntervalId=void 0);for(const{id:t,targetWindowRef:n}of this._requestedFrames)null===(e=n.deref())||void 0===e||e.cancelAnimationFrame(t);this._requestedFrames=[]}requestAnimationFrame(e,t=window){const n=(0,o.E)(t)?t:new o.O(t),i=n.deref();if(!i)return-1;const r=i.requestAnimationFrame(e);return this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedFrames.push({id:r,targetWindowRef:n,time:(new Date).getTime()}),r}cancelAnimationFrame(e,t=window){const n=((0,o.E)(t)?t:new o.O(t)).deref();if(n&&(n.cancelAnimationFrame(e),this._hostSettings.enableClearingOfRequestedAnimationFrames)){const t=this._requestedFrames.findIndex((t=>t.id===e));-1!==t&&this._requestedFrames.splice(t,1)}}requestIdleCallback(e,t,n=window){const i=(0,o.E)(n)?n:new o.O(n),r=i.deref();if(!r)return-1;let a;return a="requestIdleCallback"in r?r.requestIdleCallback(e,{timeout:t}):r.setTimeout(e,t),this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedIdleFrames.push({id:a,targetWindowRef:i,time:(new Date).getTime()}),a}cancelIdleCallback(e,t=window){const n=((0,o.E)(t)?t:new o.O(t)).deref();n&&("requestIdleCallback"in n?n.cancelIdleCallback(e):n.clearTimeout(e))}setIntervals(){this._clearanceIntervalId=setInterval((()=>{var e;const t=(new Date).getTime();let n=this._requestedFrames.findIndex((({time:e})=>t-e<d)),i=-1===n?this._requestedFrames.splice(0,this._requestedFrames.length):this._requestedFrames.splice(0,n);if(i.length)for(const{id:t,targetWindowRef:n}of i)null===(e=n.deref())||void 0===e||e.cancelAnimationFrame(t);if(n=this._requestedIdleFrames.findIndex((({time:e})=>t-e<d)),i=-1===n?this._requestedIdleFrames.splice(0,this._requestedIdleFrames.length):this._requestedIdleFrames.splice(0,n),i.length)for(const{id:e,targetWindowRef:t}of i){const n=t.deref();n&&("requestIdleCallback"in n?n.cancelIdleCallback(e):n.clearTimeout(e))}}),d)}};c=(0,i.__decorate)([(0,s._)(),(0,i.__param)(0,(0,l.W)(r.n))],c)},60040:(e,t,n)=>{"use strict";function i(e,t){let n,i,o={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(n=e,i=t):(n=t,i=e),n=n.replace("Â "," "),i=i.replace("Â "," "),i.startsWith(n)?(o.firstDiffLeft=n.length,o.firstDiffRight=0):i.endsWith(n)?(o.firstDiffLeft=0,o.firstDiffRight=n.length):(o=function(e,t){const n={firstDiffLeft:0,firstDiffRight:t.length};return n.firstDiffLeft=r(e,t,!0),n.firstDiffRight=r(e,t,!1),n}(e,t),o.firstDiffLeft+o.firstDiffRight>n.length&&(o.firstDiffRight=n.length-o.firstDiffLeft)),function(e,t,n){if(e.firstDiffLeft>0){const i=e.firstDiffLeft<t.length&&c(t,e.firstDiffLeft),r=e.firstDiffLeft<n.length&&c(n,e.firstDiffLeft);(i||r)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight<=1)return;const i=e.firstDiffRight<t.length&&c(t,t.length-e.firstDiffRight),r=e.firstDiffRight<n.length&&c(n,n.length-e.firstDiffRight);(i||r)&&(e.firstDiffRight-=1)}(o,e,t),o.firstDiffLeft<e.length&&c(e,o.firstDiffLeft)||o.firstDiffLeft<t.length&&c(t,o.firstDiffLeft),o.firstDiffRight>0&&(o.firstDiffRight<e.length&&c(e,e.length-o.firstDiffRight)||o.firstDiffRight<t.length&&c(t,t.length-o.firstDiffRight)),o}function r(e,t,n){let i;for(i=0;i<e.length&&i<t.length;i+=1){const r=e.charCodeAt(n?i:e.length-i-1),o=t.charCodeAt(n?i:t.length-i-1);if(r!==o&&!(l(r,!0)&&l(o,!0)||d(r)&&d(o)))break}return i}let o;function a(e){try{return o||(o=new RegExp("[\\p{Extended_Pictographic}\\u{1F3FB}-\\u{1F3FF}\\u{1F9B0}-\\u{1F9B3}]","u")),o.test(e)}catch(e){return!1}}function s(e){return!!e&&/[\u0E81-\u0EDF\u0f00-\u0FFF\u1000-\u109F\u1780-\u17F9\u1980-\u19DF\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\u0E00-\u0E7F\uff66-\uff9f]/g.test(e)}function l(e,t=!1){if(d(e))return!t;if(u(e))return!0;switch(e){case 11:case 9:return!0}return!1}function u(e){switch(e){case 12288:case 8194:case 8195:case 8197:case 32:case 160:return!0}return!1}function d(e){switch(e){case 13:case 10:case 65532:return!0}return!1}function c(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}n.d(t,{CC:()=>i,Fc:()=>g,Yv:()=>l,_1:()=>a,tF:()=>s,xC:()=>u});const h="0123456789";function g(e){return function(e){const t=e.toString();return t.toLowerCase()!==t.toUpperCase()}(e)||function(e){return h.includes(e)}(e)}},74847:(e,t,n)=>{"use strict";n.d(t,{Ze:()=>l,cg:()=>u,jh:()=>o,oA:()=>s,q4:()=>r,sh:()=>a});var i=n(63837);const r=(0,i.f)("TargetRenderElement"),o=(0,i.f)("TargetDocument"),a=(0,i.f)("TargetWindow"),s=(0,i.f)("TargetRenderElementFactory"),l=(0,i.f)("TargetDocumentFactory"),u=(0,i.f)("TargetWindowFactory")},29320:(e,t,n)=>{"use strict";n.d(t,{m:()=>m,r:()=>v});var i=n(30206),r=n(63837),o=n(48828),a=n(90424),s=n(59834),l=n(44680),u=n(86278),d=n(47954),c=n(98287),h=n(31685),g=n(84916),p=n(21813),f=n(17288);const m=(0,r.f)("IE2eMetric");let v=class{constructor(e,t,n,i){var r;this._logger=e,this._hostSettings=t,this._proofingStore=n,this._eventName="End2EndTelemetry",this._alEventName="IsAL",this._performanceApiGarbageCollectorIntervalInMs=1e4,this._logToTelemetry=e=>{const t=this._logger.getNewActivity(this._eventName,s.o.SamplingPolicy.CriticalExperimentation);if(!t)return;const n=this._proofingStore.getCachedEntry(d.l.ProofingLanguages).storeEntryValue;t.dataFields.push(...e.map((e=>(0,f.n)(e.name,e.duration,void 0,s.o.DataFieldType.Double.valueOf())))),t.dataFields.push(...(0,f.W)([this._alEventName,this._isAlEnabled],[p.o.NumProofingLanguages,n.length])),t.success=!0,t.endNow()},this._isAlEnabled=!0===this._hostSettings.enableOrchestration&&!0===(null===(r=this._hostSettings.orchestratorSettings)||void 0===r?void 0:r.enableAugLoop),this.metric=new g.J(e,i,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry)}startEntry(e){this._hostSettings.enableE2eMetric&&this.metric.startEntry(e)}addMeasure(e,t,n){this._hostSettings.enableE2eMetric&&this.metric.addMeasure(e,t,n)}commitEntry(e,t=this._eventName){this._hostSettings.enableE2eMetric&&this.metric.commitEntry(e,t)}setOnTimeout(e){this.metric.setOnTimeout(e)}};v=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(u.g)),(0,i.__param)(1,(0,a.W)(l.n)),(0,i.__param)(2,(0,a.W)(c.K)),(0,i.__param)(3,(0,a.W)(h.j))],v)},17677:(e,t,n)=>{"use strict";n.d(t,{u:()=>i});const i=(0,n(63837).f)("IOaMetric")},84916:(e,t,n)=>{"use strict";n.d(t,{J:()=>u});var i,r=n(30206),o=n(44579),a=n(20399),s=n(59834),l=n(48828);let u=i=class{constructor(e,t,n,i,r,o){this._logger=e,this._safeWindow=t,this._eventName=n,this._performanceApiGarbageCollectorIntervalInMs=i,this._logToTelemetry=r,this._onTimeout=o,this._performanceMarksInGarbageCollection=[],this._measuresNames=new Map,this._performanceMarksInGCCorrelationKeysHistory=new Map}startEntry(e,t,n){const[i]=this._getPerformanceEntryNames(e);let r=window.performance.mark(i);if(void 0===r){const e=window.performance.getEntriesByName(i);if(1!==e.length)return void this._logger.logEvent(541099735,o.f.TelemetryError,a.q.Error,`Unable to find performance entry by name: ${i}`,s.o.SamplingPolicy.CriticalExperimentation);r=e[0]}this._performanceMarksInGarbageCollection.push(r),t&&this._performanceMarksInGCCorrelationKeysHistory.set(r.name,{correlationKeys:t,customData:n}),this._scheduleGarbageCollection(!1)}_getPerformanceEntryNames(e,t=this._eventName){const n=`${t}-${e}`;return[e,`${n}--${i.END_SUFFIX}`,n]}addMeasure(e,t,n){const[i,r,l]=this._getPerformanceEntryNames(e,t);if(0!==window.performance.getEntriesByName(i).length)try{if(window.performance.mark(r),window.performance.measure(l,i,r),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(l)[0].duration}]),window.performance.clearMarks(r),window.performance.clearMeasures(l),n){const e=this._performanceMarksInGCCorrelationKeysHistory.get(i);if(null==e?void 0:e.correlationKeys){const t=e.correlationKeys,r=e.customData;this._performanceMarksInGCCorrelationKeysHistory.set(i,{correlationKeys:t,customData:Object.assign(Object.assign({},r),n)})}}}catch(e){this._logger.logEvent(523646680,o.f.TelemetryError,a.q.Error,`Error while adding a checkpoint measure to a telemetry entry, error: ${e}`,s.o.SamplingPolicy.CriticalExperimentation)}}commitEntry(e,t=this._eventName,n){const[i,r,l]=this._getPerformanceEntryNames(e,t),u=window.performance.getEntriesByName(i);if(0!==u.length)try{window.performance.mark(r),window.performance.measure(l,i,r),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:window.performance.getEntriesByName(l)[0].duration}]);const o=this._performanceMarksInGCCorrelationKeysHistory.get(i);this._logToTelemetry(this._measuresNames.get(e)||[],null==o?void 0:o.correlationKeys,null==o?void 0:o.customData,n),window.performance.clearMarks(i),window.performance.clearMarks(r),window.performance.clearMeasures(l),this._measuresNames.delete(e),this._removeGCTracedPerformanceMark(u[0])}catch(e){this._logger.logEvent(521417349,o.f.TelemetryError,a.q.Error,`Error while commiting a telemetry entry, error: ${e}`,s.o.SamplingPolicy.CriticalExperimentation)}}setOnTimeout(e){this._onTimeout=e}_clearAndReschedule(e){const t=Date.now(),n=[],i=this._performanceMarksInGarbageCollection.filter((i=>{const r=window.performance.timeOrigin+i.startTime;if(e&&!e.didTimeout&&0===e.timeRemaining()||t-r<this._performanceApiGarbageCollectorIntervalInMs)return!0;if(this._onTimeout){const e=this._performanceMarksInGCCorrelationKeysHistory.get(i.name)||{};e.isTimeout=!0,this._onTimeout(e.logicalId,e)}return n.push(i),window.performance.clearMarks(i.name),window.performance.clearMeasures(i.name),this._measuresNames.delete(i.name),!1}));for(const e of n)this._removeGCTracedPerformanceMark(e);this._garbageCollectionScheduler=void 0,i.length>0&&this._scheduleGarbageCollection(!0)}_removeGCTracedPerformanceMark(e){const t=this._performanceMarksInGarbageCollection.indexOf(e);t>=0&&this._performanceMarksInGarbageCollection.splice(t,1),this._performanceMarksInGCCorrelationKeysHistory.has(e.name)&&this._performanceMarksInGCCorrelationKeysHistory.delete(e.name)}_scheduleGarbageCollection(e){this._garbageCollectionScheduler||(!e&&"requestIdleCallback"in window?this._garbageCollectionScheduler=this._safeWindow.requestIdleCallback((e=>this._clearAndReschedule(e)),this._performanceApiGarbageCollectorIntervalInMs):this._garbageCollectionScheduler=window.setTimeout((()=>{this._clearAndReschedule()}),this._performanceApiGarbageCollectorIntervalInMs))}};u.END_SUFFIX="end",u=i=(0,r.__decorate)([(0,l._)()],u)},17288:(e,t,n)=>{"use strict";n.d(t,{W:()=>o,n:()=>r});var i=n(59834);function r(e,t,n,r){return{name:e,value:t,dataType:(null!=r?r:"boolean"==typeof t)?i.o.DataFieldType.Boolean.valueOf():"number"==typeof t?i.o.DataFieldType.Int64.valueOf():i.o.DataFieldType.String.valueOf(),classification:null!=n?n:i.o.DataClassification.EssentialServiceMetadata}}function o(...e){return e.map((([e,t,n,i])=>r(e,t,n,i)))}},40664:(e,t,n)=>{"use strict";function i(e,t,n,i){return r((n=>e.requestAnimationFrame(n,t)),n,i)}function r(e,t,n){let i=!1,o=!1;const a=[];let s=!1;return()=>new Promise((async l=>{if("Immediately"===n){if(!i){i=!0;try{await t()}catch(e){}e((()=>{i=!1,l()}))}}else i?(s&&(o=!0),a.push(l)):(i=!0,e((async()=>{s=!0;try{await t()}catch(e){}s=!1,i=!1,l();for(const e of a)e();o&&(o=!1,r(e,t,n))})))}))}n.d(t,{ek:()=>r,hQ:()=>i})},19613:(e,t,n)=>{"use strict";n.d(t,{_:()=>r});var i=n(40664);class r{constructor(e){this.targetWindow=e,this.timeoutIds=[]}throttle(e,t,n){return(0,i.ek)((e=>{var n;const i=null===(n=this.targetWindow.deref())||void 0===n?void 0:n.setTimeout(e,t);i&&this.timeoutIds.push(i)}),e,n)}throttleUntilNextAnimationFrameAndAdditionalTime(e,t,n,r){return(0,i.ek)((t=>e.requestAnimationFrame((()=>{var e;const i=null===(e=this.targetWindow.deref())||void 0===e?void 0:e.setTimeout(t,n);i&&this.timeoutIds.push(i)}),this.targetWindow)),t,r)}dispose(){const e=this.targetWindow.deref();if(void 0!==e)for(const t of this.timeoutIds)e.clearTimeout(t);this.timeoutIds=[]}}},2579:(e,t,n)=>{"use strict";var i,r;n.d(t,{E:()=>s,O:()=>a});class o{constructor(e){this[i]="WeakRef",this.weakMap=new WeakMap,this.weakMap.set(this,e)}deref(){return this.weakMap.get(this)}}i=Symbol.toStringTag;class a{constructor(e){this[r]="WeakRef","object"==typeof n.g&&n.g&&void 0===n.g.WeakRef?this.weakRef=new o(e):this.weakRef=new n.g.WeakRef(e)}deref(){return this.weakRef.deref()}}function s(e){return"WeakRef"===e[Symbol.toStringTag]}r=Symbol.toStringTag},32847:(e,t,n)=>{"use strict";n.d(t,{k:()=>a});var i=n(30206),r=n(48828);class o{constructor(e){this._customWindow=e,this._timeouts=new Map,this._intervals=new Map}get targetWindow(){var e;return null!==(e=this._customWindow)&&void 0!==e?e:window}clearTimer(e){const t=this._timeouts.get(e);t&&(this.targetWindow.clearTimeout(t),this._timeouts.delete(e));const n=this._intervals.get(e);n&&(this.targetWindow.clearInterval(n),this._intervals.delete(e))}setInterval(e,t,n){this.clearTimer(e);const i=this.targetWindow.setInterval(t,n);return this._intervals.set(e,i),e}setIntervalWithDelay(e,t,n,i){this.clearTimer(e);const r=this.targetWindow.setTimeout((()=>{t();const i=this.targetWindow.setInterval(t,n);this._intervals.set(e,i)}),i);return this._timeouts.set(e,r),e}setTimeout(e,t,n){this.clearTimer(e);const i=this.targetWindow.setTimeout(t,n);return this._timeouts.set(e,i),e}async initialize(){}shutDown(){for(const e of this._timeouts.values())this.targetWindow.clearTimeout(e);for(const e of this._intervals.values())this.targetWindow.clearInterval(e);this._intervals.clear(),this._timeouts.clear()}}let a=class{constructor(){this._timer=new o}clearTimer(e){this._timer.clearTimer(e)}setInterval(e,t,n){return this._timer.setInterval(e,t,n)}setIntervalWithDelay(e,t,n,i){return this._timer.setIntervalWithDelay(e,t,n,i)}setTimeout(e,t,n){return this._timer.setTimeout(e,t,n)}async initialize(){}shutDown(){this._timer.shutDown()}};a=(0,i.__decorate)([(0,r._)()],a)},16103:(e,t,n)=>{"use strict";n.d(t,{ZL:()=>o,k_:()=>r,qy:()=>a});var i=n(63837);(0,i.f)("IOnCanvasKpiHelper");const r=(0,i.f)("ILoggerSettings"),o=(0,i.f)("IEditorSdkLogger"),a=((0,i.f)("IKpiTracker"),(0,i.f)("TelemetrySink"))},28121:(e,t,n)=>{"use strict";var i,r;n.d(t,{M:()=>i,s:()=>r}),function(e){e.WebSiteProvedOnce="WebSiteProvedOnce",e.ActionCritiqueSettingsChange="ActionCritiqueSettingsChange",e.TonalFRE="TonalFRE",e.ActionInlineSettingChange="ActionInlineSettingChange"}(i||(i={})),function(e){e.MutationError="MutationError",e.UpdateCritiqueException="RunTimeErrors.UpdateCritiqueException"}(r||(r={}))},79442:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});const i=(0,n(63837).f)("IHostModelPersistedStore")},26042:(e,t,n)=>{"use strict";function i(e,t){e.isApplying||e.suggestions[0].text&&(null==t||t.addWordToIgnoreList(e.suggestions[0].text,!0))}n.d(t,{yf:()=>i})},92052:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i=(0,n(63837).f)("ICritiqueFilters")},96950:(e,t,n)=>{"use strict";n.d(t,{A_:()=>y,MG:()=>v,W:()=>d,dP:()=>f,dt:()=>g,ht:()=>c,qB:()=>h,r:()=>u,r6:()=>p});var i=n(30206),r=n(10059),o=n(20522),a=n(87432),s=n(63837),l=n(48828);function u(e){const t=[r.L9.ContextualSpelling,r.L9.WrongSpelling];return!!e&&e.typeId!==r.L9.Synonyms&&(e.priority===r.bx.High||!!e.typeId&&t.includes(e.typeId))}function d(e){return!!e&&e.typeId===r.L9.TopicSuggestion}function c(e){return!0===("number"==typeof e.supportedActions?(0,o.z)(e.supportedActions):e.supportedActions).delete}function h(e){const t="number"==typeof e.action?(0,a.fO)(e.action):e.action;return!0===t.changeAll||!0===t.changeOnce||!0===t.autoCorrect||!0===t.personalizedAutoCorrect}function g(e){return!!e&&c(e)&&!e.suggestions.some((e=>h(e)))}function p(e){return(null==e?void 0:e.typeId)===r.L9.TonalRewrite}function f(e){return!0===("number"==typeof e.action?(0,a.fO)(e.action):e.action).personalizedAutoCorrect}function m(e){for(const t of e.suggestions)if(4===t.action)return t}function v(e){for(const t of e.suggestions)if(!0===t.action.autoCorrect)return t}function y(e){return!!m(e)}(0,s.f)("ICritiqueInterpreter");let _=class{isSpellingCritique(e){return!!e&&u({priority:e.priority,typeId:(0,r.e3)(e.typeId)})}isTopicSuggestionCritique(e){return!!e&&d({typeId:(0,r.e3)(e.typeId)})}isDeleteActionAvailable(e){return c(e)}isChangeActionAvailable(e){return h(e)}isRepeatedWord(e){return g(e)}isRewrite(e){return p({typeId:(0,r.e3)(e.typeId)})}isPersonalized(e){return f(e)}hasAtLeastOneSynonym(e){return function(e){return e.suggestions.some((e=>function(e){return!!e.description&&!e.description.match(/\[(.*)\]/g)}(e)))}(e)}getAutoCorrectionSuggestion(e){return m(e)}};_=(0,i.__decorate)([(0,l._)()],_)},21206:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});const i=(0,n(63837).f)("IDisableCritiqueHandler")},80728:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});const i=(0,n(63837).f)("IEnabledCritiqueTypes")},25195:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i=(0,n(63837).f)("IEnabledCritiqueTypesSetter")},85996:(e,t,n)=>{"use strict";n.d(t,{M:()=>r,g:()=>o});var i=n(63837);const r=(0,i.f)("IFeedbackStore"),o=(0,i.f)("IFeedbackStoreFactory")},35744:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});const i=(0,n(63837).f)("IIndicatorStore")},43880:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});const i=(0,n(63837).f)("IPaneOnlyEnabledCritiqueTypes")},61758:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const i=(0,n(63837).f)("IShadowElementsStore")},51218:(e,t,n)=>{"use strict";n.d(t,{Ey:()=>a,mq:()=>i,nz:()=>r});var i,r,o=n(63837);!function(e){e[e.Days=0]="Days",e[e.Suggestions=1]="Suggestions"}(i||(i={})),function(e){e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden"}(r||(r={}));const a=(0,o.f)("IUpsellStore")},6754:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});const i=(0,n(63837).f)("IWordDictionary")},97436:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});const i=(0,n(63837).f)("INodePoller")},66526:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});const i=(0,n(63837).f)("IProofingDom")},82629:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});const i=(0,n(63837).f)("ITileNodeReader")},39441:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i=(0,n(63837).f)("IHostModelSettings")},6638:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});const i=(0,n(63837).f)("INodeTraverser")},86539:(e,t,n)=>{"use strict";n.d(t,{b:()=>i});const i=(0,n(63837).f)("IParagraphTextExtractor")},47408:(e,t,n)=>{"use strict";n.d(t,{$:()=>r});var i=n(85999);function r(e){return(null==e?void 0:e.nodeType)===i.Z.TileNode&&!!e.element&&!!e.children&&e.children.every((e=>e.nodeType===i.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element))}},85999:(e,t,n)=>{"use strict";var i;n.d(t,{Z:()=>i}),function(e){e[e.OutlineNode=0]="OutlineNode",e[e.TerminalNode=1]="TerminalNode",e[e.TileNode=2]="TileNode",e[e.ParagraphNode=3]="ParagraphNode"}(i||(i={}))},31409:(e,t,n)=>{"use strict";n.d(t,{f:()=>l,l:()=>u});var i=n(30206),r=n(40747),o=n(90424),a=n(66526),s=n(85999);let l=class{constructor(e,t,n,i){this._guidGenerator=e,this._proofingDom=t,this.eventSeqId=0,this.nodeType=s.Z.ParagraphNode,this.id=this._guidGenerator.generate(),this.children=void 0,this.element=n,this.parent=i,this._proofingDom.registerNode(this)}retire(){this.parent=void 0,this._proofingDom.unregisterNode(this)}move(e,t){return this._proofingDom.unregisterNode(this),e&&(this.element=e),t&&(this.parent=t),this.id=this._guidGenerator.generate(),this._proofingDom.registerNode(this),this}resetState(){}};function u(e){var t;return(null==e?void 0:e.nodeType)===s.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element&&(null===(t=e.parent)||void 0===t?void 0:t.nodeType)===s.Z.TileNode&&!!e.parent.element&&!!e.parent.children}l=(0,i.__decorate)([(0,i.__param)(0,(0,o.W)(r.G)),(0,i.__param)(1,(0,o.W)(a.w))],l)},34756:(e,t,n)=>{"use strict";n.d(t,{o:()=>d});var i=n(30206),r=n(6638),o=n(66526),a=n(48828),s=n(90424),l=n(30225),u=n(31409);let d=class{constructor(e,t){this._proofingDom=e,this._tileNodeTraverser=t}getParagraphText(e){let t=null;if(t="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,u.l)(t)){const e=t.parent.plainText,n=t.element.offset,i=t.element.span,r=t.element.span?n+i:void 0;return e.substring(n,r).replace(/\u00A0/g," ")}}getQueryString(e,t,n){const i=this.getParagraphText(e);return i?i.substring(t.start+(n?0:void 0===t.prefix?1:t.prefix.length),t.start+t.length):0===t.start&&0===t.length&&""===t.prefix?"":void 0}getTextBetween(e,t,n=0,i=-1){var r;let o=null;o="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let a=null;if(a="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,u.l)(o)&&(0,u.l)(a)){if(o.parent.element===a.parent.element)return this.getSubsetOfParagraph(o.parent,o.element.offset+n,a.element.offset+(-1===i?a.element.span:i));{let e,t=this.getSubsetOfParagraph(o.parent,o.element.offset+n,void 0)+"\n",s=o.parent;do{if(e=null===(r=this._tileNodeTraverser)||void 0===r?void 0:r.findNextTileNode(s),!e||"#tail#"===e)return;s=e,t+=this.getSubsetOfParagraph(s,0,s.id===a.parent.id?a.element.offset+(-1===i?a.element.span:i):void 0)+(s.id===a.parent.id?"":"\n")}while(s.id!==a.parent.id);return t}}}getSubsetOfParagraph(e,t,n){return e.plainText.substring(t,n).replace(/\u00A0/g," ")}};d=(0,i.__decorate)([(0,a._)(),(0,i.__param)(0,(0,s.W)(o.w)),(0,i.__param)(1,(0,s.W)(r.M)),(0,i.__param)(1,(0,l.l)())],d)},36271:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});const i=(0,n(63837).f)("ITileContent")},37629:(e,t,n)=>{"use strict";n.d(t,{n:()=>g});var i=n(30206),r=n(19432),o=n(32847),a=n(53920),s=n(1628),l=n(39441),u=n(63837),d=n(48828),c=n(90424),h=n(30225);const g=(0,u.f)("ITextEventPublisher");let p=class extends r.z{constructor(e,t){super(),this._settings=e,this._timer=null!=t?t:new o.k}dispose(){return this._timer.shutDown(),Promise.resolve()}publishTextChangeEvent(e,t){this.publishEvent("textChange",{data:e,messageType:t}),this.scheduleSendIdleTextEvent(e,t)}publishTextStyleEvent(){this.publishEvent("styleChange",{})}scheduleSendIdleTextEvent(e,t){if(this._settings.enableTileNodeAutoReconciliation&&0!==e.length)for(const n of e)n.mutationChangeType!==a.Q0.Code&&(this._timer.clearTimer(n.tileNodeId),this._timer.setTimeout(n.tileNodeId,(()=>{this.publishEvent("textChange",{data:[{tileNodeId:n.tileNodeId,text:n.text,mutationChangeType:a.Q0.Code,rehydrateCritiques:!0,idleReconcileTrigger:!0,optimizedRehydrationEnabled:n.optimizedRehydrationEnabled,useDirtyParagraphReconciliation:this._settings.useDirtyParagraphReconciliation}],messageType:t}),this._timer.clearTimer(n.tileNodeId)}),this._settings.reconcileTileNodeTime))}};p=(0,i.__decorate)([(0,d._)(),(0,i.__param)(0,(0,c.W)(l.k)),(0,i.__param)(1,(0,h.l)()),(0,i.__param)(1,(0,c.W)(s.J))],p)},55871:(e,t,n)=>{"use strict";function i(e){let t=e.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t}n.d(t,{F:()=>i})},95885:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});var i=n(37120);function r(e,t){var n;const r=t&&e.getContainingElement(t);if(r)return null!==(n=(0,i.m)(r))&&void 0!==n?n:r}},2672:(e,t,n)=>{"use strict";function i(e){var t,n,i,r,o,a,s;const{oaSettings:l,serviceSettings:u,hostMetadata:d}=e,{flagAnnotationSettings:c,nudge:h,predictions:g}=null!=u?u:{};return{ecc:{enabled:null!==(t=null==l?void 0:l.isContextualCardEnabled)&&void 0!==t&&t,entities:null==l?void 0:l.entitiesEnabled,bestMatch:null==l?void 0:l.bestMatchConfig,scopes:(null==l?void 0:l.scopesConfig)&&{entities:l.scopesConfig.entities,enabled:l.scopesConfig.enabled,maxResults:l.scopesConfig.maxResults}},flag:{enabled:null!==(n=null==c?void 0:c.enabled)&&void 0!==n&&n,entities:null!==(i=null==c?void 0:c.entityConfigs)&&void 0!==i?i:[]},nudge:{enabled:null!==(r=null==h?void 0:h.enabled)&&void 0!==r&&r,entities:null!==(o=null==h?void 0:h.entityConfigs)&&void 0!==o?o:[]},prediction:{enabled:null!==(a=null==g?void 0:g.enabled)&&void 0!==a&&a,entities:null!==(s=null==g?void 0:g.entityConfigs)&&void 0!==s?s:[],enableMiddleOfSentencePredictions:null==g?void 0:g.allowMiddleOfSentencePredictions,enableMultiPredict:null==g?void 0:g.enableMultiPredict},metadata:{appScenario:null==d?void 0:d.appScenario}}}n.d(t,{e:()=>i})},32450:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});const i=(0,n(63837).f)("IClientSubscriber")},18054:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,a:()=>r});var i=n(63837);const r=(0,i.f)("AugloopSessionFactory"),o=(0,i.f)("IOrchestrator")},97645:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var i=n(63837);const r=(0,i.f)("IALSessionFromHost");(0,i.f)("ProofingSettingsRequestTypes")},97105:(e,t,n)=>{"use strict";n.d(t,{J:()=>B});var i=n(32450),r=n(30206),o=n(41567),a=(function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ControlSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_InteractionModeSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()),s=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_StartupSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ClientConfigSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=(function(){function e(t){o.h.assign(e,this,t)}e.getTypeName=function(){return"AugLoop_ObservationalAssistance_ShutdownSignal"},e.getBaseTypes=function(){return["AugLoop_ObservationalAssistance_ControlSignal","AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}}(),n(3755));const d=e=>{var t,n,i,r;return(null===(t=null==e?void 0:e.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)||(null===(n=null==e?void 0:e.oaSettings)||void 0===n?void 0:n.enablePredictions)||(null===(r=null===(i=null==e?void 0:e.serviceSettings)||void 0===i?void 0:i.flagAnnotationSettings)||void 0===r?void 0:r.enabled)};var c=n(13494),h=n(23094),g=n(86278),p=n(44680),f=n(17677),m=n(9654),v=n(74847),y=n(66526),_=n(75943),b=n(28356);class C{constructor(e,t){this._hostEmitter=e,this._logger=t,this._activationTokens=[]}async activateAnnotationsBase(e,t,n){if(e)if(this._activationTokens.length)this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation which is already initialized.`);else{this._session=e,this._sessionId=t;try{const e=await Promise.all(n());this._activationTokens=e.map((e=>e.token))}catch(e){this._logger.error(508044171,`Trying to activate ${this.annotationListenerType} failed due to an exception.`,e)}}else this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation with no session.`)}async deactivateAnnotations(e){if(!e||!this._activationTokens.length)return!1;try{const t=await Promise.all(this._activationTokens.map((t=>e.releaseAnnotation(t))));return this._activationTokens=[],t.every(Boolean)}catch(e){return this._logger.error(508044170,`Trying to deactivate ${this.annotationListenerType} failed due to an exception.`,e),!1}}async updateAnnotationActivationConfig(e){this._session?this._activationTokens.length?e&&this._activationTokens.map((t=>{var n;return null===(n=this._session)||void 0===n?void 0:n.updateAnnotationConfig(t,e)})):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid token.`):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid session object.`)}}var T=n(84382),S=n(48574),I=n(26017),w=n(99828),E=n(48741);const x={[E.i.Success]:"200",[E.i.NoResults]:"200",[E.i.Cancelled]:"400",[E.i.Timeout]:"408",[E.i.UnexpectedError]:"500",[E.i.EarlyExit]:"200"};class A extends C{constructor(e,t,n,i,r){super(e,t),this._hostEmitter=e,this._logger=t,this._e2eMetric=n,this._queryDetection=i,this._hostSettings=r,this.annotationListenerType="OAAnnotationListener",this._onAnnotationResult=e=>{var t,n,i,r,o,a,s,l,u,d,h,g,p,f,m,v,y,C,E,A,D,N,F;const P=null===(t=e.items[0])||void 0===t?void 0:t.body;if(!P)return;let k;const O=_.h.getTypeNameFor(e);switch(O){case b.Xr.getTypeName():k=w.G.NewData;break;case b.fZ.getTypeName():k=w.G.ChangeData;break;case b.n4.getTypeName():k=w.G.RemoveData;break;default:return void this._logger.logDiagnostics("[OAAnnotationListener]: Unexpected annotation operation",{opType:O})}const B=null!==(n=e.parentPath[e.parentPath.length-1])&&void 0!==n?n:"",R=Number.parseInt(null!==(i=e.parentRevId)&&void 0!==i?i:"0",10);if(T.gh.typeGuard(P)){if(S.Yd.typeGuard(P.result)){if(null===(a=null===(o=null===(r=this._hostSettings)||void 0===r?void 0:r.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===a?void 0:a.augloopPredictionsDisabled)return;const t=P.result;if(this.isValidSuggestionType(t.entityType)){let n=t.entityType;(n===I.c.People&&!t.entityResults||n===I.c.External)&&(n=I.c.PIM);const i=Object.assign(Object.assign({tileId:B,tileVersion:R,annotationId:e.items[0].id},t),{entityType:n,startIndex:t.startIndex>0?t.startIndex:(null!==(l=null===(s=t.context)||void 0===s?void 0:s.length)&&void 0!==l?l:0)+t.startIndex});this._hostEmitter.emit(c.pD.predictionTriggered,{address:this._sessionId,message:{messageType:k,data:i}})}}else if(S.aO.typeGuard(P.result)){const t=P.result;this.isValidSuggestionType(t.entityType)&&this._hostEmitter.emit(c.pD.nudgeTriggered,{address:this._sessionId,message:{messageType:k,data:Object.assign(Object.assign({},t),{tileId:B,tileVersion:R,annotationId:e.items[0].id,entityType:t.entityType})}})}}else if(T.Zx.typeGuard(P)||T.$g.typeGuard(P)){const t=null===(d=null===(u=this._queryDetection)||void 0===u?void 0:u.getCurrentQuery())||void 0===d?void 0:d.queryRange,n={logicalId:P.logicalId||(null===(h=this._queryDetection)||void 0===h?void 0:h.getCurrentQueryLogicalId())||"",conversationId:P.conversationId||(null===(g=this._queryDetection)||void 0===g?void 0:g.getCurrentQueryConversationId())||"",isEmptyQuery:!t||t.length===(null!==(f=null===(p=t.prefix)||void 0===p?void 0:p.length)&&void 0!==f?f:1),isTimeout:!1,queryLength:(null==t?void 0:t.length)?t.length-(null!==(v=null===(m=t.prefix)||void 0===m?void 0:m.length)&&void 0!==v?v:1):0},i=(e=>{if(T.$g.typeGuard(e)){const t=e;if(t.instrumentation&&t.instrumentation.length>0)return t.instrumentation[0].TraceId}})(P),r=i?Object.assign({TraceId:i||""},"number"==typeof P.status?{status:(L=P.status,x[L])}:{}):void 0;let o,a,s;if(this._e2eMetric.addMeasure(n.logicalId,"OAAnnotationResultsReceived",r),T.$g.typeGuard(P)){s=P.resultSummary;const e=P;for(const t of e.entityResults)if((null===(E=null===(C=null===(y=this._hostSettings)||void 0===y?void 0:y.oaSettings)||void 0===C?void 0:C.bestMatchConfig)||void 0===E?void 0:E.enabled)&&(null===(A=e.treatments)||void 0===A?void 0:A.bestMatchEntries))for(const n of e.treatments.bestMatchEntries)for(const e of t.entities)e.entityId===n.entityId&&(e.isBestMatch=!0);o=e.entityResults,a=e.entityResults.map((e=>e.modelInfo.elapsedTime)).filter(Number.isInteger).reduce(((e,t)=>e>t?e:t),0)}else{let e=[];try{(null===(F=null===(N=null===(D=this._hostSettings)||void 0===D?void 0:D.oaSettings)||void 0===N?void 0:N.bestMatchConfig)||void 0===F?void 0:F.enabled)&&(e=>{const t=e.results.findIndex((e=>e.bestMatchEntries&&e.bestMatchEntries.length>0));if(t>-1){const n=e.results[t],i=n.bestMatchEntries;i&&i.length>0&&n.results.forEach((e=>{e.isBestMatch=i.findIndex((t=>t.entityId===e.ReferenceId))>-1}))}})(P);for(const t of P.results)e=e.concat(t.results)}catch(e){this._logger.logDiagnostics("[OAAnnotationListener] unexpected annotation item format")}const t=new Map;for(const n of e){const e=t.get(n.entityType);e?e.entities.push(n):t.set(n.entityType,{entities:[n],entityType:n.entityType})}o=Array.from(t.values())}this._hostEmitter.emit(c.pD.oaRankedAnnotations,{address:this._sessionId,message:{messageType:k,data:{tileId:B,tileVersion:R,annotationId:e.items[0].id,results:o,resultStatus:P.status,resultSummary:s,queryCorrelationKeys:n,latency:a}}})}else T.Vn.typeGuard(P)&&this._hostEmitter.emit(c.pD.oaFlagAnnotationsTriggered,{address:this._sessionId,message:{messageType:k,data:{tileId:B,tileVersion:R,annotationId:e.items[0].id,results:P.results}}});var L},this.isValidSuggestionType=e=>Object.values(I.c).includes(e)}async activateAnnotations(e,t){await super.activateAnnotationsBase(e,t,(()=>{var t,n,i,r;if(!e)return[];const o=[T.Zx];return(null===(n=null===(t=this._hostSettings)||void 0===t?void 0:t.oaSettings)||void 0===n?void 0:n.enableOaClient)?o.push(T.c$):o.push(T.os),(null===(r=null===(i=this._hostSettings)||void 0===i?void 0:i.oaSettings)||void 0===r?void 0:r.enableOaClientPredictions)?o.push(T.Nh):o.push(T.Vm),o.push(T.Vn),o.map((t=>e.activateAnnotation(t.getTypeName(),{callback:this._onAnnotationResult})))}))}}var D=n(2672),N=n(48828),F=n(90424);let P=class{constructor(e,t,n,i,r,o,s){this._hostEmitter=e,this._logger=t,this._hostSettings=n,this._oaMetric=i,this._queryDetection=r,this._proofingDom=o,this.targetDocumentFactory=s,this._oaStartupSignalSeq=0,this._startSignalIntervalId=null,this._lastStartSignalTime=0,this._elementsToProof=[],this._targetWindow=window,this._oaSendALMenuControlSignal=async e=>{if(!this._sessionsProvider)return;const t=await this._sessionsProvider.getOrCreateSession(e.address);this._oaStartupSignalSeq=this._oaStartupSignalSeq+1,null==t||t.submitSignal(new a(e.message),this._oaStartupSignalSeq.toString(),e.message.documentModel)},this._isSameOrDescendantElement=(e,t)=>e===t||(0,u.C)(e,"HTMLDivElement")&&e.contains(t),this._handleDocumentFocusIn=e=>{const t=e.target;(0,u.C)(t,"HTMLElement")&&this._elementsToProof.some((e=>this._isSameOrDescendantElement(t,e)))&&(this._submitStartupSignal(),this._initStartupSignalTimer())},this._handleDocumentFocusOut=e=>{this._clearStartupSignalTimer()},this._attachFocusEventToProofedElements=async e=>{var t,n;const i=null===(t=this._proofingDom.findNode(e.message))||void 0===t?void 0:t.element;if(!i||!(0,u.C)(i,"HTMLElement"))return;this._elementsToProof.push(i);const r=(null===(n=this.targetDocumentFactory())||void 0===n?void 0:n.deref())||document;(0,u.C)(r.activeElement,"HTMLElement")&&this._isSameOrDescendantElement(r.activeElement,i)&&(this._submitStartupSignal(),this._initStartupSignalTimer())}}register(e,t){var n;if(!d(this._hostSettings))return;this._sessionsProvider=e,this._augloopDocumentSerializer=t,this._hostEmitter.on(c.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.on(c.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements);const i=(null===(n=this.targetDocumentFactory())||void 0===n?void 0:n.deref())||document;this._focusInListener=new h.J(i),this._focusInListener.addListener("focusin",this._handleDocumentFocusIn),this._focusOutListener=new h.J(i),this._focusOutListener.addListener("focusout",this._handleDocumentFocusOut),i.defaultView&&(this._targetWindow=i.defaultView)}unregister(){var e,t;this._elementsToProof=[],d(this._hostSettings)&&(this._hostEmitter.off(c.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.off(c.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements),null===(e=this._focusInListener)||void 0===e||e.removeListener("focusin"),this._focusInListener=void 0,null===(t=this._focusOutListener)||void 0===t||t.removeListener("focusout"),this._focusOutListener=void 0),this._clearStartupSignalTimer()}createAnnotationListener(){return new A(this._hostEmitter,this._logger,this._oaMetric,this._queryDetection,this._hostSettings)}onInitialize(e){this._initStartupSignal(e)}onSessionReconnected(e){this._initStartupSignal(e)}onDocumentCreated(e,t){var n,i,r;if(!d(this._hostSettings))return;this._oaStartupSignalSeq=this._oaStartupSignalSeq+1;const o=null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.tokenOverride,a=this.getClientConfig(),s=null===(i=a.metadata)||void 0===i?void 0:i.appScenario;this._hostSettings.appId.startsWith("PowerPoint")&&"Copilot"!==s&&this._logger.logDiagnostics(`[OAClientSubscriber] client config for PowerPoint doesn't have correct appScenario: ${s}`),e.submitSignal(new l({sessionConfig:{clientConfig:a,debugConfig:{tokenOverride:o}},parentPath:null===(r=this._augloopDocumentSerializer)||void 0===r?void 0:r.getParentPath(e,t).join("\\")}),this._oaStartupSignalSeq.toString(),t)}get isEnabled(){return!0}getClientConfig(){return(0,D.e)(this._hostSettings)}_submitStartupSignal(){var e;if(!d(this._hostSettings)||!this._currentSession)return;if(!(Date.now()-this._lastStartSignalTime>9800))return;this._oaStartupSignalSeq++;const t=null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.tokenOverride;this._lastStartSignalTime=Date.now(),this._currentSession.submitSignal(new s({debugOptions:{tokenOverride:t}}),this._oaStartupSignalSeq.toString())}_initStartupSignal(e){this._clearStartupSignalTimer(),this._currentSession=e,this._submitStartupSignal()}_initStartupSignalTimer(){this._startSignalIntervalId||(this._startSignalIntervalId=this._targetWindow.setInterval((()=>{this._submitStartupSignal()}),1e4))}_clearStartupSignalTimer(){this._startSignalIntervalId&&(this._targetWindow.clearInterval(this._startSignalIntervalId),this._startSignalIntervalId=null)}};P=(0,r.__decorate)([(0,N._)(),(0,r.__param)(0,(0,F.W)(c.M5)),(0,r.__param)(1,(0,F.W)(g.g)),(0,r.__param)(2,(0,F.W)(p.n)),(0,r.__param)(3,(0,F.W)(f.u)),(0,r.__param)(4,(0,F.W)(m.J)),(0,r.__param)(5,(0,F.W)(y.w)),(0,r.__param)(6,(0,F.W)(v.Ze))],P);var k=n(85574),O=n(97428);class B{constructor(){this.imports=[k.E]}get uniqueId(){return(0,O.z)(507918404)}configureRootServices(e){e.bind(i.T).to(P)}}},31928:(e,t,n)=>{"use strict";n.d(t,{g:()=>A});var i=n(30206),r=n(47954),o=n(98287),a=n(44680),s=n(48828),l=n(90424);let u=class{constructor(e,t){this._proofingStore=e,this._hostSettings=t}async buildDescriptors(){var e;const t="FlightIds";let n;try{n=JSON.parse(await this._proofingStore.read(r.l.Descriptors))}catch(e){n=JSON.parse(this._proofingStore.getDefaultValue(r.l.Descriptors))}let i="";if(this._hostSettings.flightsToTrack&&this._hostSettings.flightsToTrack.length>0&&(i=`${i}${this._hostSettings.flightsToTrack.join(";")}`),""!==i){const e=n.find((e=>e.name===t));e?e.value=`${e.value};${i}`:n.push({name:t,value:i})}return(null===(e=this._hostSettings.hostMetadata)||void 0===e?void 0:e.releaseAudienceGroup)&&n.push({name:"Audience",value:d(this._hostSettings.hostMetadata.releaseAudienceGroup)}),n}};function d(e){switch(e){case"Local":case"Staging":case"Dogfood":case"DogFood":return"DogFood";case"Microsoft":return"Microsoft";default:return"Production"}}u=(0,i.__decorate)([(0,s._)(),(0,i.__param)(0,(0,l.W)(o.K)),(0,i.__param)(1,(0,l.W)(a.n))],u);var c=n(32927),h=n(97428),g=n(21077),p=n(91822);var f,m,v=n(21813),y=n(10059),_=n(11387),b=n(13494),C=n(17288),T=n(86278),S=n(2612),I=n(59834),w=n(95988),E=n(30225);!function(e){e.InstrumentationCall="InstrumentationCall"}(f||(f={})),function(e){e.TileIdParseException="RunTimeErrors.TileIdParseException",e.InvalidTileFormat="RunTimeErrors.InvalidTileFormat"}(m||(m={}));let x=class{constructor(e,t,n,i,r){this._hostEmitter=e,this._proofingStore=t,this._descriptorManager=n,this._logger=i,this._paneOpenState=r}async process(e){const t=await this.getRequest(e);return!!t&&(this.emitInstrumentationRequest(t,e),this.logActivity(t),!0)}async getRequest(e){if(e.critique.traceId&&e.critique.typeId&&e.critique.textInContext)return{appId:await this._proofingStore.read(r.l.AppId),descriptors:await this._descriptorManager.buildDescriptors(),languageId:p.I.getDefaultLanguageCode(await this._proofingStore.read(r.l.ProofingLanguages)),traceId:e.critique.traceId,critiquePriority:e.critique.priority,critiqueTypeId:e.critique.typeId,eventId:e.eventId,flaggedText:e.critique.textInContext,suggestions:e.critique.suggestions.map((e=>e.text)),suggestionText:this.getSuggestionText(e),metadata:this.getMetadata(e),substrateEventCustomFields:e.customProperties}}getSuggestionText(e){const t=e.critique.suggestions.map((e=>e.text));let n=t[e.eventId-4];return e.eventId!==w.xp.Autoreplace&&e.eventId!==w.xp.AutoreplaceUndo||(n=t[0]),e.eventId>=w.xp.ChangeAllSugg0&&e.eventId<=w.xp.ChangeAllSugg2&&(n=t[e.eventId-8]),n}getMetadata(e){var t,n;const i=null!==(n=null===(t=e.critique.metadata)||void 0===t?void 0:t.slice())&&void 0!==n?n:[];this._paneOpenState&&i.push({name:"IsPaneOpen",value:String(this._paneOpenState.isPaneOpen)},{name:"IsPaneOpenedInSession",value:String(this._paneOpenState.isPaneOpenedInSession)});const o=this._proofingStore.getCachedEntry(r.l.ProofingLanguages).storeEntryValue;return i.push({name:v.o.NumProofingLanguages,value:String(o.length)}),i}emitInstrumentationRequest(e,t){e.critiqueTypeId===y.L9.TopicSuggestion||(0,_.r3)(t.critique)||this._hostEmitter.emit(b.pD.instrumentationRequestV1,{address:void 0,message:e})}logActivity(e){const t=this._logger.getNewActivity(f.InstrumentationCall,I.o.SamplingPolicy.Measure),n=e.substrateEventCustomFields&&"true"===e.substrateEventCustomFields.isPersonalized||!1;t&&(t.dataFields.push(...(0,C.W)(["EventID",e.eventId],["CritiquePriority",e.critiquePriority],["CritiqueTypeId",e.critiqueTypeId],["IsPersonalizedEvent",n])),t.success=!0,t.endNow())}};x=(0,i.__decorate)([(0,s._)(),(0,i.__param)(0,(0,l.W)(b.M5)),(0,i.__param)(1,(0,l.W)(o.K)),(0,i.__param)(2,(0,l.W)(c.o)),(0,i.__param)(3,(0,l.W)(T.g)),(0,i.__param)(4,(0,E.l)()),(0,i.__param)(4,(0,l.W)(S.F))],x);class A{constructor(){this.imports=[]}get uniqueId(){return(0,h.z)(507918406)}configureRootServices(e){e.bind(g.f).to(x),e.bind(c.o).to(u)}}},85574:(e,t,n)=>{"use strict";n.d(t,{E:()=>X});var i=n(97436),r=n(30206),o=n(44680),a=n(38714),s=n(86278),l=n(37629),u=n(82629),d=n(55871),c=n(48828),h=n(90424),g=n(30225);let p=class{constructor(e,t,n,i,r){this._tileNodeReader=e,this._hostSettings=t,this._optimizedRehydrationEnabled=n,this._logger=i,this._textEventPublisher=r}pollNodes(e,t,n,i,r,o,a,s){var l,u,c,h;if(this._textEventPublisher&&!0===this._hostSettings.sdkV2Enabled){const i=[];for(const e of t)if(this._tileNodeReader.isTileNode(e))try{const t=(0,d.F)(e);i.push({text:e.pullText(),mutationChangeType:n,tileNodeId:e.id,rehydrateCritiques:r,forceTileDiffEmission:a,mutationWasTextReplacement:s,documentModel:null==t?void 0:t.documentModel,previousNodeId:this._tileNodeReader.getPreviousTileId(e),nextNodeId:this._tileNodeReader.getNextTileId(e),optimizedRehydrationEnabled:this._optimizedRehydrationEnabled.check(),brokerOptions:{critiques:null==o?void 0:o.get(e.id),forceReflow:!0}})}catch(e){null===(u=this._logger)||void 0===u||u.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(l=this._logger)||void 0===l||l.error(0,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack});this._textEventPublisher.publishTextChangeEvent(i,e)}else for(const e of t)if(this._tileNodeReader.isTileNode(e))try{this._tileNodeReader.reconcile(e,n,null==o?void 0:o.get(e.id),!0,r,a,s)}catch(e){null===(h=this._logger)||void 0===h||h.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(c=this._logger)||void 0===c||c.error(509727256,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack})}removeQueuedTiles(e){}};p=(0,r.__decorate)([(0,c._)(),(0,r.__param)(0,(0,h.W)(u.j)),(0,r.__param)(1,(0,h.W)(o.n)),(0,r.__param)(2,(0,h.W)(a.W)),(0,r.__param)(3,(0,g.l)()),(0,r.__param)(3,(0,h.W)(s.g)),(0,r.__param)(4,(0,g.l)()),(0,r.__param)(4,(0,h.W)(l.n))],p);var f=n(18054),m=n(31928),v=n(28356);class y{constructor(){this.mutex=Promise.resolve()}lock(){let e=e=>{};return this.mutex=this.mutex.then((()=>new Promise(e))),new Promise((t=>{e=t}))}}var _=n(20399),b=n(13494),C=n(53920),T=n(99828),S=n(29320),I=n(76511),w=n(13915),E=n(74847),x=n(30122),A=n(75943);class D{constructor(e,t,n,i,r,o,a,s){this._sessionId=e,this._logger=t,this._annotationListeners=n,this._session=i,this._aggregateLogger=r,this._augloopDocumentSerializer=o,this._hostEmitter=a,this._clientSubscribers=s,this.sessionWasDisconnected=!1,this.initialize=async()=>{try{this._session.setConnectCallback(this.onSessionConnected),this._session.setDisconnectCallback(this.onSessionDisconnected)}catch(e){this._logger.error(561534362,"Failed to initialize AugLoop session callbacks",e)}try{await this.activateAnnotations(this._annotationListeners.map((e=>e.annotationListenerType)))}catch(e){this._logger.error(508614281,"Failed to initialize AugLoop session annotations",e)}},this.close=()=>{this._session.close()},this.submitDelta=(e,t,n)=>{var i;const r=new v.xU({parentPath:e,items:[{id:e[e.length-1],revId:`${n}`,body:t,sourceTimestamp:Date.now()}]});this._session.submitOperation(r),null===(i=this._aggregateLogger)||void 0===i||i.incrementEventCount(512337430,`submitDelta. unit: ${t.unit}`)},this.getSessionId=()=>this._sessionId,this.getSession=()=>this._session,this.updateAnnotationActivationConfig=async()=>{await Promise.all(this._annotationListeners.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325704,`updateAnnotationActivationConfig called for ${e.annotationListenerType}`),e.updateAnnotationActivationConfig()})))},this.activateAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325703,`activateAnnotations called for ${e.annotationListenerType}`),e.activateAnnotations(this._session,this._sessionId)})))},this.releaseAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));return(await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325702,`deactivateAnnotations called for ${e.annotationListenerType}`),e.deactivateAnnotations(this._session)})))).every(Boolean)},this.submitSignal=(e,t,n)=>{var i,r,o;const a=new v.g0({parentPath:this._augloopDocumentSerializer.getParentPath(this,n),items:[{id:t,body:e}]});this._session.submitOperation(a),null===(i=this._aggregateLogger)||void 0===i||i.incrementEventCount(512325701,`submitted a signal of type: ${null!==(o=null===(r=e.H_)||void 0===r?void 0:r.T_)&&void 0!==o?o:"unknown"}`)},this.onDocumentCreated=e=>{for(const t of this._clientSubscribers)t.onDocumentCreated(this,e)},this.onSessionDisconnected=()=>{this.sessionWasDisconnected=!0,this._logger.warn(507773218,"Augloop session has disconnected")},this.onSessionConnected=async e=>{if(!e)return;const t=this.sessionWasDisconnected;if(this.sessionWasDisconnected=!1,t){this._logger.warn(508631257,"Augloop session has reconnected"),this._augloopDocumentSerializer.sessionReconnected(this._session),this._augloopDocumentSerializer.submitSeedOperations(this._session);for(const e of this._clientSubscribers)e.onSessionReconnected(this);this._hostEmitter.emit(b.pD.hostModelRehydrateTiles,{address:this._sessionId,message:[]}),this._hostEmitter.emit(b.pD.hostModelRehydrateTilesFinished,{address:this._sessionId,message:[]})}else this._logger.warn(508421253,"Augloop session has initially connected"),this._augloopDocumentSerializer.submitSeedOperations(this._session)}}submitOperation(e){var t,n;this._session.submitOperation(e);const i=A.h.getTypeNameFor(e);null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325706,`_submitItemsOperation called with ${i}`),null===(n=this._aggregateLogger)||void 0===n||n.incrementEventCount(512325705,`items submitted through ${i}`,e.items.length)}}class N{constructor(e){A.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class F{constructor(e){A.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class P{constructor(e){A.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class k{constructor(e){A.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return A.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class O{constructor(e){A.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return A.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class B{constructor(e){A.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class R{constructor(e){A.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class L{constructor(e){A.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class M{constructor(e){A.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class q{constructor(e){A.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class U{constructor(e){A.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class W{constructor(e){A.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return A.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class j{constructor(e){A.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return A.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class z{constructor(e){A.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return A.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class H{constructor(e){A.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return A.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};var V=n(32450);let G=class{constructor(e){this._clientSubscribers=e,this.hasCreatedDocument=!1}sessionReconnected(e){this.hasCreatedDocument=!1}submitSeedOperations(e){const t={id:"doc",body:new O({isReadonly:!1})},n=new v.Xr({parentPath:["session"],items:[t]});try{e.submitSeedOperations([n])}catch(e){}}getParentPath(e,t){if(!this.hasCreatedDocument){this.hasCreatedDocument=!0;for(const n of this._clientSubscribers)n.onDocumentCreated(e,t)}return["session","doc"]}};G=(0,r.__decorate)([(0,c._)(),(0,r.__param)(0,(0,x.t)(V.T)),(0,r.__param)(0,(0,g.l)())],G);var Q=n(97645);const K=(0,n(63837).f)("IAugloopDocumentSerializer");var $=n(35761);class Z{constructor(e,t){this.logger=e,this.getOrCreateSession=t,this.pendingDeltas=new Map,this.pendingDeltaMutex=new y,this.targetWindow=window,this.sendAttributionRangesIfNecessary=async()=>{this.hasPendingDeltas()&&await this.submitPendingDeltas(this.getOrCreateSession)}}getKeyFromParentPath(e){return e.join()}shouldAttemptMergeDeltas(e,t){return e.modelDelta.tileId===t.modelDelta.tileId&&e.modelDelta.delta.deltaType===t.modelDelta.delta.deltaType}clearPendingTimeout(){this.pendingTimeoutId&&(this.targetWindow.clearTimeout(this.pendingTimeoutId),this.pendingTimeoutId=void 0)}getIndexForRangeMerge(e,t){if(0===t.length||t[t.length-1].start<e.start)return t.length;const n=t.findIndex((t=>t.start>e.start));return-1===n?t.length-1:n}addOrMerge(e,t){if(e.start<0||e.length<0)return void this.logger.error(506033676,"Range to merge has a negative start or length value",{start:e.start,length:e.length});0===t.length&&t.push(e);const n=this.getIndexForRangeMerge(e,t);if(t[n]&&t[n].start===e.start)return void(t[n].length!==e.length&&(t[n].length=e.length,t.splice(n+1)));const i=t[n-1];let r=n,o=0;i&&i.start+i.length>=e.start&&((0,$.G)(i.attribution,e.attribution)?(e.length=e.start-i.start+e.length,e.start=i.start,r=n-1,o=1):(i.length=e.start-i.start,r=i.length<=0?n-1:n)),t[r+1]&&t[r+1].start<e.start+e.length&&(o=Math.max(t.length-r,0)),t.splice(r,o,e)}shutdown(){this.clearPendingTimeout()}setTargetDocument(e){const t=(null==e?void 0:e.deref())||document;t.defaultView&&(this.targetWindow=t.defaultView)}hasPendingDeltas(){return this.pendingDeltas.size>0}async add(e){var t;const n=e.modelDelta.delta.attributionData;if(0===n.ranges.length&&!n.isFullUpdate)return;const i=await this.pendingDeltaMutex.lock();let r=this.pendingDeltas.get(e.address);r||(r=new Map,this.pendingDeltas.set(e.address,r));const o=this.getKeyFromParentPath(e.parentPath);r.has(o)||r.set(o,[]);const a=null!==(t=r.get(o))&&void 0!==t?t:[];if(n.isFullUpdate)r.set(o,[e]);else{const t=a.findIndex((t=>this.shouldAttemptMergeDeltas(t,e)));if(-1!==t){const e=a[t].modelDelta.delta.attributionData.ranges,i=n.ranges;for(const t of i)this.addOrMerge(t,e)}else a.push(e)}this.pendingTimeoutId||(this.pendingTimeoutId=this.targetWindow.setTimeout(this.sendAttributionRangesIfNecessary,1e3)),i()}async submitPendingDeltas(e){const t=await this.pendingDeltaMutex.lock(),n=new Map(this.pendingDeltas);this.pendingDeltas.clear(),this.clearPendingTimeout(),t();for(const[t,i]of n){const n=await e(t);if(n)for(const e of i.values())for(const t of e)n.submitDelta(t.parentPath,t.modelDelta.delta,t.modelDelta.tileVersion)}}}let J=class{constructor(e,t,n,i,r,o,a,s,l,u,d){this._hostEmitter=e,this._hostSettings=t,this._logger=n,this._e2eMetric=i,this._paragraphDeltasEnabled=r,this._clientSubscribers=o,this._sessionOrPromise=a,this._aggregateLogger=s,this._augloopSessionFactory=l,this._targetDocumentFactory=d,this._sessions=new Map,this._runtimeInstances=new Set,this._listenersInitialized=!1,this._fetchALSessionMutex=new y,this._pendingAttributionRangeManager=new Z(this._logger,(async e=>this.getOrCreateSession(e))),this.initialize=async()=>{var e,t;this._sessionOrPromise||this._augloopSessionFactory||this._logger.error(509694866,"Failed to initialize AugLoop, there is no runtime available"),this._hostSettings.enableOrchestration&&(this._logger.log(570782413,_.q.Info,"Initializing Orchestrator."),this._hostEmitter.on(b.pD.hostModelParagraphTextTiles,this._handleTiles),this._hostEmitter.on(b.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(b.pD.hostModelAttributionDelta,this._handleAttributionDelta),this._hostEmitter.on(b.pD.hostModelFormattingDelta,this._handleDelta),this._hostEmitter.on(b.pD.hostModelTextTile,this._handleTile),this._hostEmitter.on(b.pD.hostModelMoveTextTile,this._handleMove));for(const e of this._clientSubscribers)e.register(this,this._augloopDocumentSerializer);this._listenersInitialized=!0,null===(e=this._pendingAttributionRangeManager)||void 0===e||e.setTargetDocument(null===(t=this._targetDocumentFactory)||void 0===t?void 0:t.call(this))},this.shutDown=()=>{var e;this._logger.log(570782414,_.q.Debug,"Shutting down Orchestrator."),this._listenersInitialized||this._logger.log(570782415,_.q.Error,"Trying to delete event listeners in Orchestrator when they have already been deleted.");for(const e of this._clientSubscribers)e.unregister();for(const e of this._sessions.values())e.getSession()!==this._sessionFromHost&&e.close();for(const e of this._runtimeInstances)e.uninitialize();this._sessions.clear(),this._runtimeInstances.clear(),this._listenersInitialized=!1,this._sessionOrPromise=void 0,this._sessionFromHost=void 0,null===(e=this._pendingAttributionRangeManager)||void 0===e||e.shutdown(),this._pendingAttributionRangeManager=void 0},this.deactivateAnnotations=async e=>{const t=(await Promise.all([...this._sessions.keys()].map((t=>{var n;return null===(n=this._sessions.get(t))||void 0===n?void 0:n.releaseAnnotations(e)})))).every(Boolean);return t||this._logger.error(526209822,"Some annotations failed to be deactivated."),t},this.activateAnnotations=async e=>{for(const t of this._sessions.values())await t.activateAnnotations(e)},this.getOrCreateSession=async e=>{var t;const n=await this._fetchALSessionMutex.lock(),i=null!==(t=this._sessions.get(e))&&void 0!==t?t:await this._createSession(e);return n(),i},this.getSessions=async e=>{if(!e)return this._sessions;const t=new Map;for(const n of e)t.set(n,await this.getOrCreateSession(n));return t},this._createSession=async e=>{const t=[];for(const e of this._clientSubscribers)t.push(e.createAnnotationListener());let n="function"==typeof this._sessionOrPromise?await this._sessionOrPromise():this._sessionOrPromise;if(n)this._sessionFromHost=n;else{if(!this._augloopSessionFactory)return;{const{session:t,runtime:i}=await this._augloopSessionFactory(this._augloopDocumentSerializer,e);n=t,i&&this._runtimeInstances.add(i)}}if(!n)return;const i=new D(e,this._logger,t,n,this._aggregateLogger,this._augloopDocumentSerializer,this._hostEmitter,this._clientSubscribers);await i.initialize();for(const e of this._clientSubscribers)e.onInitialize(i);return this._sessions.set(e,i),i},this._handleDelta=async e=>{const t=e.message;if(t.sourceType===C.pf.TileNode)return;const n=await this.getOrCreateSession(e.address);n&&(this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),n.submitDelta([...this._augloopDocumentSerializer.getParentPath(n,t.documentModel),t.tileId],t.delta,t.tileVersion))},this._handleAttributionDelta=async e=>{var t;const n=e.message;if(n.sourceType===C.pf.TileNode)return;const i=await this.getOrCreateSession(e.address);i&&await(null===(t=this._pendingAttributionRangeManager)||void 0===t?void 0:t.add({address:e.address,parentPath:[...this._augloopDocumentSerializer.getParentPath(i,n.documentModel),n.tileId],modelDelta:n}))},this._handleTiles=async e=>{this._paragraphDeltasEnabled.check()||await this._handleTileMessages(e.address,e.message)},this._handleTile=async e=>{this._paragraphDeltasEnabled.check()&&e.message.data.isTextNode&&await this._handleTileMessages(e.address,[e.message])},this._handleTileMessages=async(e,t)=>{const n=await this.getOrCreateSession(e);if(n)for(const i of t){const t=i.data;let r;switch(i.messageType){case T.G.NewData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),r=new v.Xr({parentPath:this._augloopDocumentSerializer.getParentPath(n,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}],prevId:i.data.prevId,nextId:i.data.nextId});break;case T.G.RemoveData:r=new v.n4({parentPath:this._augloopDocumentSerializer.getParentPath(n,t.documentModel),items:[{id:t.tileId,sourceTimestamp:Date.now()}]});break;case T.G.ChangeData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),r=new v.fZ({parentPath:this._augloopDocumentSerializer.getParentPath(n,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}]})}n.submitOperation(r),this._hostEmitter.emit(b.pD.hostModelTextTileEmittedToAugloop,{address:e,message:i})}},this._handleMove=async e=>{const t=e.message;await this._handleTileMessages(e.address,[{messageType:T.G.RemoveData,data:{tileId:t.oldTileId,tileVersion:t.tileVersion,documentModel:t.oldDocumentModel,tile:void 0,changeType:C.Q0.Code,isTextNode:!1}},{messageType:T.G.NewData,data:{tileId:t.newTileId,tileVersion:t.tileVersion,documentModel:t.newDocumentModel,tile:t.tile,changeType:C.Q0.Code,isTextNode:!1,prevId:t.prevId,nextId:t.nextId}}])},this._augloopDocumentSerializer=null!=u?u:new G(o)}};J=(0,r.__decorate)([(0,c._)(),(0,r.__param)(0,(0,h.W)(b.M5)),(0,r.__param)(1,(0,h.W)(o.n)),(0,r.__param)(2,(0,h.W)(s.g)),(0,r.__param)(3,(0,h.W)(S.m)),(0,r.__param)(4,(0,h.W)(I.H)),(0,r.__param)(5,(0,x.t)(V.T)),(0,r.__param)(5,(0,g.l)()),(0,r.__param)(6,(0,h.W)(Q.P)),(0,r.__param)(6,(0,g.l)()),(0,r.__param)(7,(0,g.l)()),(0,r.__param)(7,(0,h.W)(w.v)),(0,r.__param)(8,(0,g.l)()),(0,r.__param)(8,(0,h.W)(f.a)),(0,r.__param)(9,(0,g.l)()),(0,r.__param)(9,(0,h.W)(K)),(0,r.__param)(10,(0,g.l)()),(0,r.__param)(10,(0,h.W)(E.Ze))],J);var Y=n(97428);class X{constructor(){this.imports=[m.g]}get uniqueId(){return(0,Y.z)(507918371)}configureRootServices(e){e.bind(f.J).to(J),e.bind(i.G).to(p)}}},32927:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});const i=(0,n(63837).f)("IDescriptorManager")},54218:(e,t,n)=>{"use strict";n.d(t,{JY:()=>d,Th:()=>c,yi:()=>h});var i=n(30206),r=n(19432),o=n(23094),a=n(8903),s=n(63837),l=n(48828),u=n(90424);const d=(0,s.f)("IAriaStatusStateStore"),c=(0,s.f)("IAriaStatusStateStoreFactory");let h=class extends r.z{constructor(e){super(),this.featureFlagsReader=e,this.purgeDelay=1e4,this.logPurgeTimeout={},this._politeUpdates=[],this._assertiveUpdates=[],this._status=void 0,this._statusSeverity="off",this.postMessageIfIframe=e=>window.self!==window.top&&(this.featureFlagsReader.flags.enableAriaStatusPostMessage?(window.parent.postMessage(e,"*"),!0):!this.featureFlagsReader.flags.enableAriaStatusInNonRootIFrames),this.reset=(e,t,n)=>{this.postMessageIfIframe({messageType:"msAriaResetMessage",resetStatus:e,resetAssertiveLogs:t,resetPoliteLogs:n})||(e&&(this._status=void 0,this._statusSeverity="off"),t&&(this._assertiveUpdates=[]),n&&(this._politeUpdates=[]),this.publishStateChange())},this.scheduleLogCleanup=e=>{this.cancelScheduledCleanup(e),this.logPurgeTimeout[e]=window.setTimeout((()=>{const t="assertive"===e,n="polite"===e;this.reset(!1,t,n)}),this.purgeDelay)},this.cancelScheduledCleanup=e=>{const t=this.logPurgeTimeout[e];t&&(window.clearTimeout(t),this.logPurgeTimeout[e]=void 0)},this.onMessage=e=>{var t;if(null===(t=e.data)||void 0===t?void 0:t.messageType)if("msAriaSetMessage"===e.data.messageType){const t=e.data;void 0===t.status||"assertive"!==t.severity&&"polite"!==t.severity&&"off"!==t.severity||(Array.isArray(t.status)?this.addPreservedStatuses(t.status,t.severity):this.setStatus(t.status,t.severity,!!t.preserve))}else if("msAriaResetMessage"===e.data.messageType){const t=e.data;void 0!==t.resetAssertiveLogs&&void 0!==t.resetPoliteLogs&&void 0!==t.resetStatus&&this.reset(t.resetStatus,t.resetAssertiveLogs,t.resetPoliteLogs)}}}async initialize(){this.featureFlagsReader.flags.enableAriaStatusPostMessage&&window.self===window.top&&(this.eventListener=new o.J(window),this.eventListener.addListener("message",this.onMessage,{passive:!0,capture:!0}))}shutDown(){var e;null===(e=this.eventListener)||void 0===e||e.removeAllListeners(),this.eventListener=void 0}setStatus(e,t,n=!1){if(!this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:n})){if(n){if("polite"===t||"assertive"===t){const n="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),n.push(e),this.scheduleLogCleanup(t)}}else this._statusSeverity=t,this._status=e;this.publishStateChange()}}addPreservedStatuses(e,t){if(this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:!0}))return;if("off"===t)return;const n="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),n.push(...e),this.scheduleLogCleanup(t),this.publishStateChange()}resetAll(){this.reset(!0,!0,!0)}resetPreserved(){this.reset(!1,!0,!0)}resetStatus(){this.reset(!0,!1,!1)}publishStateChange(){this.publishEvent("stateUpdated",{status:this._status,statusSeverity:this._statusSeverity,politeUpdates:this._politeUpdates,assertiveUpdates:this._assertiveUpdates})}};h=(0,i.__decorate)([(0,l._)(),(0,i.__param)(0,(0,u.W)(a.c))],h)},68023:(e,t,n)=>{"use strict";n.d(t,{U:()=>g,d:()=>c});var i=n(61483),r=n(37842),o=n(8676),a=n(36747),s=n(74847),l=n(44680),u=n(20193),d=n(95734);const c=d.createContext(void 0),h=(0,r.F5)({languageScriptDirectionDetector:o.A.on(a.iw).optional(),targetWindowRef:o.A.on(s.sh).optional(),hostSettings:o.A.on(l.n).optional()}),g=e=>{const{hostSettings:t,languageScriptDirectionDetector:n,targetWindowRef:o}=(0,r.SM)(h),a=d.useContext(c),s=null==o?void 0:o.deref();d.useEffect((()=>{var e;return null===(e=null==t?void 0:t.onCalloutOpened)||void 0===e||e.call(t,null,void 0,a),()=>{var e;null===(e=null==t?void 0:t.onCalloutClosed)||void 0===e||e.call(t,null,void 0,a)}}),[t,a,e.target,s]);const l={hostId:a,eventBubblingEnabled:!0};return d.createElement(i.P,Object.assign({dir:null==n?void 0:n.dir(),layerProps:l},e,{target:e.target,doNotLayer:!a&&e.doNotLayer}),void 0===n?e.children:d.createElement(u.K,{rtl:n.isRtl()},e.children))}},80120:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});const i=(0,n(63837).f)("ICalloutDismissalHandler")},23300:(e,t,n)=>{"use strict";n.d(t,{j:()=>i});const i=(0,n(63837).f)("IInlineSuggestionsCalloutPlacement")},99119:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});const i=(0,n(63837).f)("IInlineSuggestionsCalloutSizeAndDirectionUtils")},21648:(e,t,n)=>{"use strict";n.d(t,{P:()=>i,V:()=>o});var i,r=n(63837);!function(e){e.AttachFile="AttachFile",e.TriggerChar="TriggerChar",e.Fre="Fre"}(i||(i={}));const o=(0,r.f)("IInlineSuggestionsRenderer")},16081:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=(0,n(63837).f)("IUserProfilePictureCache")},41533:(e,t,n)=>{"use strict";n.d(t,{W:()=>ut});var i,r=n(30206),o=n(40628),a=n(4497),s=n(4326),l=n(26017),u=n(48741);!function(e){e.Disabled="Disabled",e.Predictive="Predictive",e.UserInitiated="UserInitiated"}(i||(i={}));var d=n(13494),c=n(33300),h=n(99828),g=n(53920),p=n(17288),f=n(5823),m=n(23094),v=n(19613),y=n(2579),_=n(40664),b=n(26878),C=n(44680),T=n(86310),S=n(86278),I=n(40747),w=n(17677),E=n(9654),x=n(38716),A=n(8903),D=n(59886),N=n(31685),F=n(36747),P=n(74847),k=n(2612),O=n(21077),B=n(84878),R=n(31409),L=n(95885),M=n(55871),q=n(66526),U=n(86539),W=n(36271),j=n(35744),z=n(85996),H=n(22322),V=n(95988),G=n(3327),Q=n(48828),K=n(90424),$=n(30225),Z=n(30122),J=n(62989);const Y="keptMetricEnabled",X="OACurrentQueryDismiss",ee="OAPanelRequestUpdate",te="OAShowMoreEntitiesError",ne="OAShowMoreEntitiesSearchCleared",ie="ExpandedEccUploadMenuEvent";var re=n(54218),oe=n(80120),ae=n(13608),se=n(36694),le=n(40313),ue=n(70496),de=n(49691),ce=n(46546),he=n(10056);class ge{getPluginCalloutMaxHeight(e,t,n){var i;const r=null!==(i=e.y)&&void 0!==i?i:e.top;if(r)return Math.max(t.innerHeight-r,r)-20}getCalloutDirection(e,t,n,i){return e?he.A.bottomRightEdge:he.A.bottomLeftEdge}}var pe=n(90630),fe=n(70578),me=n(21648),ve=n(10059);function ye(e){switch(e){case ve.L9.CIQFlag_PersonEntityRecognition:return J.z4.Person;case ve.L9.CIQFlag_File:return J.z4.File;case ve.L9.CIQFlag_LocalBusiness:case ve.L9.CIQFlag_Location:case ve.L9.CIQFlag_Time:return J.z4.Location;case ve.L9.CIQFlag_Topic:return J.z4.Topic;case ve.L9.CIQFlag_TaskRecognition:case ve.L9.CIQFlag_SatoriEntityRecognition:case ve.L9.CIQFlag_DateEntityRecognition:case ve.L9.HeadingDetection:return J.z4.Location;default:return}}var _e=n(6510);function be(e,t,n,i,r,o,a){const s=e.queryDetection.setCurrentQueryRange(r.id,i,a,o,t);s&&(s.scopeInfo=o);const l=new _e.s({deltaType:G.WI.Update,unit:G.OD.Chars,position:i.start,length:i.length,content:n,queryRange:i,additionalData:s,userInfo:{userType:G.HS.SessionUser}});Ce(e.hostEmitter,r,l)}function Ce(e,t,n){const i=(0,M.F)(t);e.emit(d.pD.hostModelDelta,{address:void 0,message:{tileId:t.id,tileVersion:t.eventSeqId||0,documentModel:null==i?void 0:i.documentModel,delta:n,sourceType:g.pf.ParagraphNode,changeType:g.Q0.Code,deletedOrReplacedCharacters:void 0}})}function Te(e,t){var n,i,r,o,a,s,l;const u=null!==(r=null!==(i=null===(n=t.queryDetection.getCurrentQuery())||void 0===n?void 0:n.queryRange.prefix)&&void 0!==i?i:e.triggerCharacter)&&void 0!==r?r:"@",d=t.queryDetection.getCurrentScope();return(0,p.W)(["scope",null!==(o=null==d?void 0:d.entityType)&&void 0!==o?o:""],["keyStrokes",e.keyStrokes],["isEmptyQuery",e.queryRange.length===u.length],["wasOpenedViaNudge",e.wasOpenedViaNudge],["triggerCharacter",u],["wasOpenedIsViaNudgeAndHasEntityResults",null!==(s=null===(a=e.wasOpenedViaNudgeInfo)||void 0===a?void 0:a.hasEntityResults)&&void 0!==s&&s],["wasOpenedViaAutomaticAtMention",e.wasOpenedViaAutomaticAtMention],["wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===e.menuType.menuType],["wasOpenedInBlankTile",e.wasOpenedInBlankTile],["parentTileType",null!==(l=e.parentTileType)&&void 0!==l?l:"unknown"],["menuType",e.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")],[Y,!!t.hostSettings.enableKeptMetric])}class Se{constructor(e,t,n){this._services=e,this._calloutState=t,this.wrapInClearingSearch=n,this._searchBoxQueryUpdated=!1,this._localizer=e.localizer,this._oaLogger=e.oaLogger,this._hostEmitter=e.hostEmitter,this._proofingDom=e.proofingDom,this._oaResultStore=e.oaResultStore,this._queryDetection=e.queryDetection}buildExpandedEccSearchBarConfig(e){return{enableExpandedECCSearchBar:e,onSearchChange:(e="")=>{var t,n;const i=this._calloutState.menuCurrentlyOpen;if(!(null==i?void 0:i.expandedEccSearchBarConfig))return;const r=this._proofingDom.findParagraphNode(i.tileId);if(!(0,R.l)(r))return;const o=i.triggerCharacter,a=o+e,s=e.length+(null!==(t=null==o?void 0:o.length)&&void 0!==t?t:0);null!==(n=this.lastComposingBoxQuery)&&void 0!==n||(this.lastComposingBoxQuery=this._calloutState.queryString),this._calloutState.setSearchBoxQueryString(e),be(this._services,o,a,{start:0,length:s,prefix:o},r,this._queryDetection.getCurrentScope()),this._oaLogger.logActivity("ExpandedEccSearchBarTextChaged",void 0,this.getDefaultLogDataForMenu())},onSearchClear:()=>{this._calloutState.setSearchBoxQueryString(""),this.wrapInClearingSearch((()=>this.removeComposingBoxQuery(!0)))}}}initShowMoreEntitiesParagraph(e,t,n){const i=this._calloutState.menuCurrentlyOpen;if(!i)return;const r=this.createSearchBoxTextTile(i);return t&&(this._previouslySpecifiedItemsToDisplay=i.specifiedItemsToDisplay,i.specifiedItemsToDisplay=void 0),this._oaResultStore.updateLoadingStatus(!0,!0),be(this._services,i.triggerCharacter,n,{start:0,length:n.length,prefix:""},r,e?{entityType:e}:void 0),r}buildShowMoreEntitiesConfig(e,t,n,i){var r,o;if(null===(r=this._services.hostSettings.oaSettings)||void 0===r?void 0:r.disableFlagShowMoreEntities)return;const a=ye(e.typeId);if(a===J.z4.File||a===J.z4.Person){const e=a===J.z4.File?l.c.File:l.c.People,r=a===J.z4.File?this._localizer.getMessage("ebx_ECCSearchFileButtonLabel"):this._localizer.getMessage("ebx_ECCSearchPeopleButtonLabel");return Object.assign(Object.assign({},null===(o=this._services.hostSettings.serviceSettings)||void 0===o?void 0:o.showMoreEntitiesSettings),{isShowMoreEntitiesEnabled:!0,showMoreEntitiesButtonLabel:r,searchBoxPlaceHolder:r,onSearchChange:(t="")=>{this.onSearchBoxQueryChange(t,e)},onClickShowMoreEntities:()=>{const t=this._calloutState.searchBoxQueryString;this.initShowMoreEntitiesParagraph(e,!0,t)?this._oaLogger.logActivity("OAShowMoreEntitiesOpened",void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(te,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},onCloseShowMoreEntities:()=>{const e=this._calloutState.menuCurrentlyOpen;e&&(this._previouslySpecifiedItemsToDisplay?(e.specifiedItemsToDisplay=this._previouslySpecifiedItemsToDisplay,this._oaResultStore.updateResults(e.specifiedItemsToDisplay,i.id,0===e.specifiedItemsToDisplay.length?u.i.NoResults:u.i.Success,void 0,void 0,0===e.specifiedItemsToDisplay.length?{NoResults:1}:{Success:1})):(e.specifiedItemsToDisplay=void 0,this._oaResultStore.updateLoadingStatus(!0,!0),be(this._services,e.triggerCharacter,t,n,i,void 0)),this.removeSearchBoxTextTile(e)),this._oaLogger.logActivity("OAShowMoreEntitiesClosed",void 0,this.getDefaultLogDataForMenu())},onSearchClear:()=>{this.initShowMoreEntitiesParagraph(e,!1,"")?this._oaLogger.logActivity(ne,void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(te,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},entityType:e})}}getIsSearchBarAvailable(){const e=this._calloutState.menuCurrentlyOpen;return(null==e?void 0:e.enableExpandedECCSearchBar)&&this._calloutState.searchBoxQueryString.length>0||this._searchBoxQueryUpdated}onSearchBoxQueryChange(e,t){var n;this._searchBoxQueryUpdated=!0,this._calloutState.setSearchBoxQueryString(e),null!==(n=this.lastComposingBoxQuery)&&void 0!==n||(this.lastComposingBoxQuery=this._calloutState.queryString);const i=this._calloutState.menuCurrentlyOpen;if(!(null==i?void 0:i.searchBoxGeneratedParagraphId)&&!this.initShowMoreEntitiesParagraph(t,!0,e))return void this._oaLogger.logActivity(te,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu());const r=(null==i?void 0:i.searchBoxGeneratedParagraphId)?this._proofingDom.findParagraphNode(i.searchBoxGeneratedParagraphId):void 0;r?(this._oaResultStore.updateLoadingStatus(!0,!0),be(this._services,null==i?void 0:i.triggerCharacter,e,{start:0,length:e.length,prefix:""},r,t?{entityType:t}:void 0,!0),this._oaLogger.logActivity("OAShowMoreEntitiesSearchChanged",void 0,this.getDefaultLogDataForMenu())):this._oaLogger.logActivity(te,{error:"Could not find paragraph node for search bar"},this.getDefaultLogDataForMenu())}menuDismissed(e){this.removeSearchBoxTextTile(e),this._searchBoxQueryUpdated=!1,this.lastComposingBoxQuery=void 0}removeSearchBoxTextTile(e){this._previouslySpecifiedItemsToDisplay=void 0,e.searchBoxGeneratedParagraphId&&(this._hostEmitter.emit(d.pD.hostModelTextTile,{address:void 0,message:{messageType:h.G.RemoveData,data:{tileId:e.searchBoxGeneratedParagraphId,tileVersion:0,changeType:g.Q0.Code,isTextNode:!0,tile:new pe.Cg({content:""})}}}),e.searchBoxGeneratedParagraphId=void 0)}async removeComposingBoxQuery(e){var t,n,i;try{const r=this._calloutState.menuCurrentlyOpen;if(!r)return;const o=this._proofingDom.findParagraphNode(r.tileId);if(!(0,R.l)(o))return;const a=this._calloutState.triggerMethod!==me.P.AttachFile&&this._calloutState.triggerMethod!==me.P.Fre,s=a?1:null!==(n=null===(t=r.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==n?n:1;if(r.queryRange.length===s&&this._calloutState.triggerMethod!==me.P.AttachFile)return;const l=o.element.offset+r.initialQueryStartPosition;let u=r.queryRange.length;if(a&&(u=(null!==(i=this.lastComposingBoxQuery)&&void 0!==i?i:this._calloutState.queryString).length+1),a&&u-s==0)return;this._calloutState.triggerMethod===me.P.AttachFile?(this._queryDetection.setCurrentQueryRange(r.tileId,{start:r.queryRange.start,length:1,prefix:""},!0,this._queryDetection.getCurrentScope()),await this._services.tileContent.replace(o.parent,void 0,l,u," ").then((()=>{var e,t,n,i,r,o,a,s;const l=null===(i=null===(n=null===(t=(e=this._services).targetDocumentFactory)||void 0===t?void 0:t.call(e))||void 0===n?void 0:n.deref())||void 0===i?void 0:i.querySelectorAll(".ms-ecc-callout input[type=search]")[0];l&&(l.setAttribute("placeholder",this._localizer.getMessage("expandedInlineSuggestionsSearchBarPlaceholder")),null===(s=null===(a=null===(o=(r=this._services).targetWindowFactory)||void 0===o?void 0:o.call(r))||void 0===a?void 0:a.deref())||void 0===s||s.requestAnimationFrame((()=>{l.focus()})))}))):await this._services.tileContent.remove(o.parent,void 0,l+s,u-s).then((()=>{var t,n,i,r,o,a,s,l;if(!e)return;this.lastComposingBoxQuery=void 0,this._calloutState.clearQueryString(!0);const u=null===(r=null===(i=null===(n=(t=this._services).targetDocumentFactory)||void 0===n?void 0:n.call(t))||void 0===i?void 0:i.deref())||void 0===r?void 0:r.querySelectorAll(".ms-ecc-callout input[type=search]")[0];u&&(u.setAttribute("placeholder",this._localizer.getMessage("expandedInlineSuggestionsSearchBarPlaceholder")),null===(l=null===(s=null===(a=(o=this._services).targetWindowFactory)||void 0===a?void 0:a.call(o))||void 0===s?void 0:s.deref())||void 0===l||l.requestAnimationFrame((()=>{u.focus()})))})).finally((()=>{var t;if(!e)return;const n=r.triggerCharacter,i=r.tileId;if(!i)return;const o=this._proofingDom.findParagraphNode(i);o&&be(this._services,n,n+"",{start:0,length:null!==(t=null==n?void 0:n.length)&&void 0!==t?t:0,prefix:n},o,this._queryDetection.getCurrentScope())}))}finally{this.lastComposingBoxQuery=void 0}}getDefaultLogDataForMenu(e){const t=null!=e?e:this._calloutState.menuCurrentlyOpen;return t?Te(t,this._services):[]}createSearchBoxTextTile(e){this.removeSearchBoxTextTile(e);const t=this.generateNewParagraphNode();return e.searchBoxGeneratedParagraphId=t.id,t}generateNewParagraphNode(){const e=new R.f(new fe.L,this._proofingDom,{offset:0,span:0});return this._hostEmitter.emit(d.pD.hostModelTextTile,{address:void 0,message:{messageType:h.G.NewData,data:{tileId:e.id,tileVersion:e.eventSeqId,changeType:g.Q0.Local,isTextNode:!0,tile:new pe.Cg({content:""})}}}),e}}const Ie=(0,n(63837).f)("IDefaultInlineSuggestionItems");var we=n(23300),Ee=n(99119),xe=n(16081),Ae=n(19432),De=n(9420);class Ne{constructor(){this._onUpdate=void 0}onKeyPressed(e,t,n){return!!this._onUpdate&&this._onUpdate(e,t,n)}setKeyPressHandler(e){this._onUpdate=e}}var Fe=n(37156),Pe=n(29594);function ke(e,t,n){const i=null==t?void 0:t.getComponentActiveTheme(n?ae.yF.expandedInlineSuggestionComponentName:ae.yF.inlineSuggestionComponentName);let r;return e&&(r=JSON.parse(JSON.stringify(e))),r=Oe(r,i),r}function Oe(e,t){if(!e)return t;if(t)for(const n in t){const i=n;"object"==typeof t[i]?e[i]?Oe(e[i],t[i]):e[i]=t[i]:e[i]||(e[i]=t[i])}return e}class Be extends Ae.z{constructor(e,t,n,i){super(),this._inlineSuggestionsCalloutPlacement=t,this._inlineSuggestionsCalloutSizeAndDirectionUtils=n,this.callbackMethods=i,this.keyboardHandlerTarget=new Ne,this.queryString="",this.searchBoxQueryString="",this.isError=!1,this.isLoading=!0,this.resultReset=!1,this.hasTargetLocationBeenCalculated=!1,this._suggestions=void 0,this._preloadedSuggestions=void 0,this._triggeringMethod=void 0,this.overrideTargetLocation=void 0,this.menuParentElement=void 0,this.setPreloadedSuggestions=e=>{this._preloadedSuggestions=e,this.isLoading=0===e.length,this.publishUpdateEvent()},this.clearPreloadedSuggestions=()=>{var e;(null===(e=this._preloadedSuggestions)||void 0===e?void 0:e.length)&&(this._preloadedSuggestions=[],this.publishUpdateEvent())},this.setSearchBoxQueryString=e=>{this.searchBoxQueryString=e,this.publishUpdateEvent()},this.inlineSuggestionsStrings=(0,Pe.$)().getStringsFor("InlineSuggestionStrings"),this.calloutStrings=(0,Pe.$)().getStringsFor("OnCanvasCalloutStrings"),this.getLocale=()=>this._hostSettings.defaultLocale,this.isFlightEnabled=this.callbackMethods.isFlightEnabled,this.onFeedbackButtonClicked=this.callbackMethods.onFeedbackButtonClicked,this.onFirstRender=this.callbackMethods.onFirstRender,this.onProcessedResults=this.callbackMethods.onProcessedResults,this.onRenderResults=this.callbackMethods.onRenderResults,this.onAction=this.callbackMethods.onAction,this.onFooterAction=this.callbackMethods.onFooterAction,this.onDismissed=this.callbackMethods.onDismissed,this.onPreventDismissOnEvent=this.callbackMethods.onPreventDismissOnEvent,this.onRestoreFocus=this.callbackMethods.onRestoreFocus,this.onSearchBoxQueryChange=this.callbackMethods.onSearchBoxQueryChange,this.onUserInteraction=this.callbackMethods.onUserInteraction,this.onGroupSelected=this.callbackMethods.onGroupSelected,this.onItemSelected=this.callbackMethods.onItemSelected,this.removeComposingBoxQuery=this.callbackMethods.removeComposingBoxQuery,this.handleKeyDown=this.callbackMethods.handleKeyDown,this.getQueryRangeBoundingClientRect=this.callbackMethods.getQueryRangeBoundingClientRect,this.handleEccUploadMenuEvent=this.callbackMethods.handleEccUploadMenuEvent,this.directionalHintCallback=(e,t,n,i)=>this._inlineSuggestionsCalloutSizeAndDirectionUtils.getCalloutDirection(i,e,t,n),this.maxHeightCallback=(e,t,n,i)=>{let r=this._inlineSuggestionsCalloutSizeAndDirectionUtils.getPluginCalloutMaxHeight(e,t,n);return(null==i?void 0:i.maxHeight)&&(r=Math.min(i.maxHeight,null!=r?r:Number.MAX_SAFE_INTEGER)),r},this._queryDetection=e.queryDetection,this._hostSettings=e.hostSettings,this._languageScriptDirectionDetector=e.languageScriptDirectionDetector,this._themeStore=e.themeStore,this._targetWindowFactory=e.targetWindowFactory,this._proofingDom=e.proofingDom,this._oaLogger=e.oaLogger}getCalloutState(){var e,t,n;if(this.menuCurrentlyOpen)return{calloutProps:this,targetLocation:this.hasTargetLocationBeenCalculated?this.menuCurrentlyOpen.targetLocation:void 0,targetWindow:null!==(t=null===(e=this._targetWindowFactory)||void 0===e?void 0:e.call(this))&&void 0!==t?t:new y.O(window),currentThemeType:null===(n=this._themeStore)||void 0===n?void 0:n.currentTheme,directionalHintCallback:(e,t,n)=>this.directionalHintCallback(e,t,n,this.isRtl),maxHeightCallback:(e,t)=>{var n;return this.maxHeightCallback(e,t,this.queryChar,(0,ce.toJS)(null===(n=this.styles)||void 0===n?void 0:n.containerStyles))}}}updateCurrentMenu(e,t,n){const i=this.menuCurrentlyOpen,r=!i&&e,o=i&&!e;this.menuCurrentlyOpen=e,this.overrideTargetLocation=t,this.isLoading=!0,this.isError=!1,this.resultReset=!0,this._suggestions=[],this.queryString=null!=n?n:"",this.searchBoxQueryString="",this.menuParentElement=o?void 0:this.callbackMethods.menuParentElement,r?(this.hasTargetLocationBeenCalculated=!1,this.publishEvent("menuUpdated",{messageType:h.G.NewData,data:{tileId:e.tileId,queryRange:e.queryRange}})):o?(this.hasTargetLocationBeenCalculated=!1,this._triggeringMethod=void 0,this._queryDetection.removeDetectedQuery(),this.publishEvent("menuUpdated",{messageType:h.G.RemoveData,data:{tileId:i.tileId,queryRange:i.queryRange}})):this.publishUpdateEvent()}publishUpdateEvent(){this.menuCurrentlyOpen&&this.publishEvent("menuUpdated",{messageType:h.G.ChangeData,data:{tileId:this.menuCurrentlyOpen.tileId,queryRange:this.menuCurrentlyOpen.queryRange}})}async calculateTargetLocationAndShow(){if(!this.menuCurrentlyOpen)return;this.menuParentElement=this.callbackMethods.menuParentElement;const e=this._queryDetection.getCurrentQueryLogicalId();let t=this.overrideTargetLocation;if(!t){const n=this._proofingDom.findParagraphNode(this.menuCurrentlyOpen.tileId);if(!(0,R.l)(n))return void this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid parent HTML element could be found");const i=await this._inlineSuggestionsCalloutPlacement.getTargetLocationOfECC(n,this);if(!i)return;if(this._queryDetection.getCurrentQueryLogicalId()!==e)return;t=i}"x"in t&&"InlineSuggestionsResultsFlagMenuType"===this.menuCurrentlyOpen.menuType.menuType&&(t.x=t.x-11);const n=!this.hasTargetLocationBeenCalculated||(i=this.menuCurrentlyOpen.targetLocation,r=t,!((0,De.Pe)(i)&&(0,De.Pe)(r)?i.x===r.x&&i.y===r.y:(0,De.K2)(i)&&(0,De.K2)(r)&&i.left===r.left&&i.top===r.top&&i.width===r.width&&i.height===r.height));var i,r;this.menuCurrentlyOpen.targetLocation=t,this.hasTargetLocationBeenCalculated=!0,n&&this.publishUpdateEvent()}setIsLoading(){this.isLoading=!0,this._suggestions=[],this.publishUpdateEvent()}setHadUnexpectedError(){this.isLoading=!1,this.isError=!0,this._suggestions=[],this.publishUpdateEvent()}setHasSuggestions(e,t,n){this.isLoading=!1,this.isError=!1,this.resultReset=t,this._suggestions=e,this.queryString=n,this.publishUpdateEvent()}setQueryString(e){this.queryString!==e&&(this.queryString=e,this.publishUpdateEvent())}setExplicitLoadingState(e,t){var n;const i=this.isLoading!==e||this.resultReset!==t||this.isError||(null===(n=this._suggestions)||void 0===n?void 0:n.length);this.isLoading=e,this.isError=!1,this.resultReset=t,this._suggestions=[],i&&this.publishUpdateEvent()}clearQueryString(e){let t=""!==this.queryString;this.queryString="",e&&(t=t||""!==this.searchBoxQueryString,this.searchBoxQueryString=""),t&&this.publishUpdateEvent()}setTriggerMethod(e){this._triggeringMethod=e}get preloadedSuggestions(){var e;return null!==(e=this._preloadedSuggestions)&&void 0!==e?e:[]}get currentScope(){return this._queryDetection.getCurrentScope()}get menuType(){var e,t;return null!==(t=null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.menuType)&&void 0!==t?t:{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",actions:[]}}get theme(){var e,t,n;return ke(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.theme,this._themeStore,null!==(n=null===(t=this.menuCurrentlyOpen)||void 0===t?void 0:t.enableExpandedECC)&&void 0!==n&&n)}get style(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.style}get styles(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.styles}get oaSettings(){return this._hostSettings.oaSettings}get accessibilitySettings(){return this._hostSettings}get enableScopedHeader(){var e,t,n,i;return(void 0===(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.enableScopedHeader)||this.menuCurrentlyOpen.enableScopedHeader)&&"InlineSuggestionsResultsUserInitiatedMenuType"===(null===(t=this.menuCurrentlyOpen)||void 0===t?void 0:t.menuType.menuType)&&!0===(null===(i=null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.scopesConfig)||void 0===i?void 0:i.enabled)}get unsupportedEntities(){return this._queryDetection.getUnsupportedEntities()}get queryChar(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.triggerCharacter}get showMoreEntitiesConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.showMoreEntitiesConfig}get browseThisComputerConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.browseThisComputerConfig}get appGptConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.appGptConfig}get isFeedbackEnabled(){return!0===this._hostSettings.isFeedbackEnabledForEcc}get isFeedbackButtonEnabled(){var e,t;return!0===(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.isFeedbackButtonEnabled)}get enableExpandedECC(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.enableExpandedECC}get isDividerShown(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.isDividerShown}get isRtl(){var e,t;return null!==(t=null===(e=this._languageScriptDirectionDetector())||void 0===e?void 0:e.isRtl())&&void 0!==t&&t}get expandedEccSearchBarConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.expandedEccSearchBarConfig}get fluentTheme(){var e;return null===(e=this._themeStore)||void 0===e?void 0:e.getExpandedEccFluentTheme()}get triggerMethod(){return this._triggeringMethod}get suggestions(){var e,t,n;if(!this.resultReset&&(null===(e=this._preloadedSuggestions)||void 0===e?void 0:e.length)&&(void 0===this.currentScope||this._preloadedSuggestions.some((e=>{var t;return e.entityType===(null===(t=this.currentScope)||void 0===t?void 0:t.entityType)})))){const e=this._preloadedSuggestions;return[...e,...(null!==(t=this._suggestions)&&void 0!==t?t:[]).filter((t=>!e.some((e=>e.entityType===t.entityType))))]}return null!==(n=this._suggestions)&&void 0!==n?n:[]}get noSuggestionsHeaderInfo(){var e;if(!this.isLoading&&0===this.suggestions.length){if(this.currentScope)return{title:(0,Fe.X)(this.currentScope.entityType),isScoped:!0,isScopingEnabled:!0,suggestions:[]};if(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.noSuggestionsHeaderInfo)return Object.assign({},this.menuCurrentlyOpen.noSuggestionsHeaderInfo)}}get expandedECCHeader(){var e;const t=(0,Pe.$)().getStringsFor("InlineSuggestionStrings"),n=null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.supportedEntityTypes;if(!this.enableExpandedECC||!n)return[{type:l.c.Scope,title:t("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}];const i=n.map((e=>({type:l.c.Scope,title:(0,Fe.X)(e),iconName:e,scopeInfo:{entityType:e},isSelected:1===n.length,id:e})));return n.length>1&&i.unshift({type:l.c.Scope,title:t("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}),i}}var Re=n(42608);function Le(e,t,n){var i,r;const o=(null===(r=null===(i=e.hostSettings.serviceSettings)||void 0===i?void 0:i.browseThisComputerSettings)||void 0===r?void 0:r.enableBrowseThisComputerOnFileFlags)&&(!n||n.typeId===ve.L9.CIQFlag_File);if(!o)return;const{browseThisComputerSettings:a}=e.hostSettings.serviceSettings||{},s=null==a?void 0:a.fluentMenuConfig,l=null==s?void 0:s.menuItems.map((n=>Object.assign(Object.assign({},n),{onClickHandler:()=>{const i=t(),r=i?Te(i,e):[];e.oaLogger.logActivity(ie,void 0,[...r,(0,p.n)("eventType",n.menuItemId||"Unknown")]),n.onClickHandler()}})));return{isBrowseThisComputerEnabled:o,isUploadFileButtonEnabled:!n&&(null==a?void 0:a.isUploadFileButtonEnabled),onClickBrowseThisComputer:()=>{var n;const i=t(),r=i?Te(i,e):[];e.oaLogger.logActivity(ie,void 0,[...r,(0,p.n)("eventType","CIQUploadButtonClicked")]),null===(n=null==a?void 0:a.onBrowseThisComputerCallback)||void 0===n||n.call(a)},browseThisComputerButtonLabel:e.localizer.getMessage("ebx_browseThisComputerLabel"),enableCloudPicker:null==a?void 0:a.enableCloudPicker,fluentMenuConfig:s&&Object.assign(Object.assign({},s),{menuItems:l||[]}),eventTarget:null==a?void 0:a.eventTarget}}function Me(e){const t=Math.floor(Math.abs(e));return(t<10?"0":"")+t}const qe=(e,t,n,i,r,o)=>({ConversationId:t,ImpressionType:i,LocalTime:(new Date).toISOString(),ProviderName:r,Results:o,LogicalId:e,TraceId:n,Version:2});function Ue(e,t){const n="TopHits",i={};i[n]=[],e.forEach((e=>{e.entities.forEach((e=>{if(e.isBestMatch)i[n].push(e);else{const t=e.entityType;i[t]?i[t].push(e):i[t]=[e]}}))})),0===i[n].length&&delete i[n];const r=[];let o=1;for(const e in i){const a=i[e];let s=1;r.push(Object.assign({Type:"Group",Name:e===n?n:a[0].entityType,LayoutType:"Vertical",Position:o,ResultsView:i[e].map((e=>({Type:"Entity",EntityType:`${e.entityType}Suggestion`,ReferenceId:e.ReferenceId,Position:s++,PlacementType:"Visible"})))},t&&{MetaData:t})),o++}return r}var We,je,ze;!function(e){e[e.Unknown=0]="Unknown",e[e.Title=1]="Title",e[e.Subtitle=2]="Subtitle",e[e.Heading1=3]="Heading1",e[e.Heading2=4]="Heading2",e[e.Heading3=5]="Heading3"}(We||(We={})),function(e){e.Installed="Installed",e.NotInstalled="NotInstalled"}(je||(je={})),function(e){e.Query="Query",e.Action="Action"}(ze||(ze={}));var He=n(93381),Ve=n(52484);const Ge=6e4,Qe=60*Ge,Ke=24*Qe,$e=7,Ze=24,Je=1,Ye=2,Xe=.8,et=-10*Ge;function tt(e,t){const n=(0,Pe.$)().getStringsFor("DateTimeStrings"),i=(e,...t)=>{let i=n(e);return t.filter(Boolean).forEach(((e,t)=>{i=i.replace(`{${t}}`,e)})),i},r=t.getTime()-e.getTime();if(r<0)return r<=et?"":i("justNow");const o=Math.round(r/Ke),a=Math.round(r/Qe);if(o>$e)return function(e,t){const n=(0,Pe.$)().getStringsFor("MonthsNames"),i=[n("January"),n("February"),n("March"),n("April"),n("May"),n("June"),n("July"),n("August"),n("September"),n("October"),n("November"),n("December")][e.getMonth()],r=`${i} ${e.getDate().toString()}, ${e.getFullYear().toString()}`,o=`${i} ${e.getDate().toString()}`;return t.getFullYear()===e.getFullYear()?o:r}(e,t);if(a>=Ze)return o>1?i("daysAgo",o.toString()):i("oneDayAgo");if(a>=Ye)return a>1?i("hoursAgo",a.toString()):i("oneHourAgo");if(a>=Xe)return Je>1?i("hoursAgo",Je.toString()):i("oneHourAgo");const s=Math.round(r/Ge);return s<=Ye?i("justNow"):i("minutesAgo",s.toString())}var nt;!function(e){e[e.AuthorName=0]="AuthorName",e[e.EmailSenderName=1]="EmailSenderName",e[e.FallbackValue=2]="FallbackValue",e[e.LastModifiedByUser=3]="LastModifiedByUser",e[e.LastModifiedByContact=4]="LastModifiedByContact",e[e.LastAccessedByUser=5]="LastAccessedByUser",e[e.SentByUser=6]="SentByUser",e[e.DateCreatedByUser=7]="DateCreatedByUser",e[e.UserCreatedBy=8]="UserCreatedBy"}(nt||(nt={}));const it=e=>{if(!e)return"";const t=e.includes("Z")?e:`${e}Z`;return tt(new Date(t),new Date)};var rt=n(11663);function ot(e,t,n,i,r,o,a,s,u){return function(e){return e.entityType===l.c.People}(e)?at(e,t):function(e){return e.entityType===l.c.File}(e)?function(e,t,n,i){var r;if(!(e.AccessUrl&&e.FileName&&e.FileExtension&&e.FileSourceType))return;const{FileExtension:o,FileName:a,FileSourceType:s,AccessUrl:u}=e,d=function(e){if(!e)return"";const t=e.lastIndexOf(".");return t>-1?e.substring(0,t):e}(a),c=((e,t,n,i)=>{var r,o,a,s;const l=(0,Pe.$)().getStringsFor("FileTidbitStrings"),u=(e,...t)=>{let n=l(e);return t.filter(Boolean).forEach(((e,t)=>{n=n.replace(`{${t}}`,e)})),n},d=((e,t,n,i)=>{var r;const{Author:o,From:a,DateAccessed:s,DateCreated:l,DateModified:u,SharedDateTime:d,propertyHits:c,UserRelationshipType:h}=e;if(n&&i&&h!==Ve.b.Uploaded)return nt.LastAccessedByUser;const g=(o||(null===(r=null==a?void 0:a.EmailAddress)||void 0===r?void 0:r.Name)||"").trim(),p=g===t;if(n){const e=(null==c?void 0:c.includes("EmailSenderName"))||(null==c?void 0:c.includes("EmailSenderAddress")),t=(null==c?void 0:c.includes("Author"))||(null==c?void 0:c.includes("AuthorEmail"));if(h===Ve.b.Uploaded)return t?nt.UserCreatedBy:nt.DateCreatedByUser;if(e)return p?nt.SentByUser:nt.EmailSenderName;if(t)return nt.AuthorName;if(h===Ve.b.None&&(null==a?void 0:a.EmailAddress)&&d)return nt.EmailSenderName;if(s){const e=s.includes("Z")?s:`${s}Z`,t=new Date(e),n=new Date;if(Math.floor((n.getTime()-t.getTime())/864e5)<10)return nt.LastAccessedByUser;if((null==a?void 0:a.EmailAddress)&&d){const e=d.includes("Z")?d:`${d}Z`;if(new Date(e)>t)return p?nt.SentByUser:nt.EmailSenderName}return nt.LastAccessedByUser}}return(null==a?void 0:a.EmailAddress)&&d?p?nt.SentByUser:nt.EmailSenderName:u&&g?p?nt.LastModifiedByUser:nt.LastModifiedByContact:p&&s?nt.LastAccessedByUser:g&&l?nt.AuthorName:nt.FallbackValue})(e,t,n,i),c=e.Author||(null===(o=null===(r=e.From)||void 0===r?void 0:r.EmailAddress)||void 0===o?void 0:o.Name)||"",h=(null===(s=null===(a=e.From)||void 0===a?void 0:a.EmailAddress)||void 0===s?void 0:s.Name)||"";switch(d){case nt.AuthorName:return u("userCreatedOnDate",c,it(e.DateCreated));case nt.DateCreatedByUser:return u("youCreatedOnDate",it(e.DateCreated));case nt.UserCreatedBy:return u("userCreatedBy",c);case nt.LastAccessedByUser:return u("youOpenedOnDate",it(e.DateAccessed));case nt.LastModifiedByUser:return u("youModifiedOnDate",it(e.DateModified));case nt.LastModifiedByContact:return u("userModifiedOnDate",c,it(e.DateModified));case nt.EmailSenderName:return u("userSentOnDate",h,it(e.SharedDateTime));case nt.SentByUser:return u("youSentOnDate",it(e.SharedDateTime));case nt.FallbackValue:return void 0!==e.SecondaryText?e.SecondaryText:u("weFoundThisFile")}})(e,t,i,n);return Object.assign(Object.assign({},e),{type:l.c.File,sourceType:st(s),fileName:a,hitFileName:d,fileExtension:o,url:u,lastAccessDateTime:e.DateAccessed,lastModifiedDateTime:e.DateModified,createdDateTime:e.DateCreated,itemId:e.Id,fileSize:null!==(r=e.FileSize)&&void 0!==r?r:0,subject:c,titleHitHighlightProperty:"hitFileName",subtitleHitHighlightProperty:"subject"})}(e,n,i,s):function(e){return e.entityType===l.c.Topic}(e)?function(e){return Object.assign(Object.assign({},e),{type:e.entityType,id:e.TopicId,title:e.DisplayName,subtitle:e.Description,iconName:"Hashtag",tooltip:e.Description})}(e):function(e){return e.entityType===l.c.MessageExtensionApp}(e)?function(e,t){const n=!!t&&t.get(e.AppId);var i;if(n&&((i=n.State)&&i!==je.NotInstalled))return Object.assign(Object.assign({},e),{type:e.entityType,id:e.AppId,title:e.DisplayName,subtitle:n.Description,imageUrl:n.IconUrl,tooltip:n.Description})}(e,a):function(e){return e.entityType===l.c.External}(e)?function(e,t,n){var i,r;const o=function(e,t){let n="";return e.SecondaryText?n=e.SecondaryText:e.ContentDomainName?n=e.ContentDomainName:e.Authors.length>0?n=1===e.Authors.length?`${t.getMessage("authorLabel")}: ${e.Authors[0]}`:`${t.getMessage("authorsLabel")}: ${e.Authors.join(", ")}`:e.LastModifiedDateTimeUtc&&(n=`${t.getMessage("lastModifiedDateLabel")} ${tt(new Date(e.LastModifiedDateTimeUtc),new Date)}`),n}(e,t);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:n&&null!==(i=e.GroupDisplayName)&&void 0!==i?i:e.entityType,id:e.ItemId,title:e.text,subtitle:o,tooltip:e.text}),!e.IconUrl&&{iconName:null===(r=e.icon)||void 0===r?void 0:r.iconName}),e.IconUrl&&{imageUrl:e.IconUrl}),{subtitleHitHighlightProperty:"ContentDomainName"})}(e,r,u):function(e){return e.entityType===l.c.Event}(e)?function(e){return Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,eventId:e.OriginalId||e.entityId||e.text,eventName:e.text,eventStartDateTime:e.Start,eventEndDateTime:e.End,isAllDay:e.IsAllDay,isSeries:!!e.SeriesMasterId,hasRecording:e.HasRecording})}(e):function(e){return e.entityType===l.c.Message}(e)?function(e){var t,n,i,r,o,a;return Object.assign(Object.assign({},e),{type:l.c.Message,id:e.text,subject:e.Subject,sender:null!==(a=null!==(i=null===(n=null===(t=e.From)||void 0===t?void 0:t.EmailAddress)||void 0===n?void 0:n.Name)&&void 0!==i?i:null===(o=null===(r=e.From)||void 0===r?void 0:r.EmailAddress)||void 0===o?void 0:o.Address)&&void 0!==a?a:"",emailId:e.ItemId.Id})}(e):function(e){return e.entityType===l.c.Chat}(e)?function(e){var t,n,i,r,o,a,s,l,u,d;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{id:e.text}),!e.IconUrl&&{iconName:null!==(n=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==n?n:"OfficeChat"}),{type:e.entityType,title:e.Name,name:e.Name,threadId:e.ThreadId,threadType:null!==(r=null===(i=e.ThreadType)||void 0===i?void 0:i.toString())&&void 0!==r?r:"",teamName:e.Name,groupId:e.GroupId,matchingMembers:null!==(a=null===(o=e.MatchingMembers)||void 0===o?void 0:o.map((e=>at(e,void 0))))&&void 0!==a?a:[],chatMembers:null!==(l=null===(s=e.ChatMembers)||void 0===s?void 0:s.map((e=>at(e,void 0))))&&void 0!==l?l:[],totalChatMembersCount:null!==(u=e.TotalChatMembersCount)&&void 0!==u?u:0,lastMessageTime:null!==(d=e.LastMessageTime)&&void 0!==d?d:"",imageUrl:e.IconUrl})}(e):function(e){return e.entityType===l.c.Channel}(e)?function(e,t){var n,i;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,subtitle:t.getMessage("channelOfTeamLabel",e.TeamName),tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(i=null===(n=e.icon)||void 0===n?void 0:n.iconName)&&void 0!==i?i:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})}(e,r):function(e){return e.entityType===l.c.Team}(e)?function(e){var t,n;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(n=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==n?n:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})}(e):function(e){return e.entityType===l.c.App}(e)?function(e){return Object.assign(Object.assign({},e),{id:e.CollectorId,type:l.c.App,title:e.Title,imageUrl:e.IconAnonymousUrl})}(e):function(e){return e.entityType===l.c.PIM}(e)?function(e){const t=function(e){let t="PhoneNumber";return e===He.Nm.Address?t="Location":e===He.Nm.Membership&&(t="Member"),t}(e.IntentId),n=function(e){var t;let n="";return e.entityType===l.c.PIM?n=null!==(t=e.SecondaryText)&&void 0!==t?t:"":"Phones"in e&&e.Phones&&e.Phones.length>0&&e.Phones[0].Type&&(n=e.Phones[0].Type),n}(e);return Object.assign(Object.assign({},e),{type:l.c.PIM,id:e.text,title:e.text,tooltip:e.text,subtitle:n,iconName:t})}(e):function(e){return e.entityType===l.c.Scope}(e)?function(e,t){var n,i;const r=e.entityType,o=e.ScopeDisplayName||"";let a;a="Meetings"===e.ScopeDisplayName?"Event":e.ScopeDisplayName;let s=!1;const l=new Date;if(t)for(const i of t){const t=new Date(i[1]);i[0]===(null===(n=e.scopeInfo)||void 0===n?void 0:n.entityType)&&l<=new Date(t.setDate(t.getDate()+14))&&(s=!0)}return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:r,id:null!==(i=e.id)&&void 0!==i?i:e.text,title:o}),!e.IconUrl&&{iconName:a}),e.IconUrl&&{imageUrl:e.IconUrl}),{isNew:s})}(e,o):function(e){var t,n,i;const r=e.entityType,o=e.subtitle,a=null!==(t=e.tooltip)&&void 0!==t?t:"",s=(r===l.c.Scope?e.ScopeDisplayName:e.text)||"";return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:r,id:null!==(n=e.id)&&void 0!==n?n:e.text,title:s,subtitle:o,tooltip:a}),!e.IconUrl&&{iconName:null===(i=e.icon)||void 0===i?void 0:i.iconName}),e.IconUrl&&{imageUrl:e.IconUrl})}(e)}function at(e,t){var n;const i=(0,rt.u)(e);let r=e.imageUrl;r||(r=null==t?void 0:t.fetchCachedProfilePicture(i));const o=e.subtitlePropertyOverride;return Object.assign(Object.assign({},e),{ReferenceId:e.ReferenceId||e.entityId,type:l.c.People,displayName:e.text,primaryEmailAddress:i,subtitleOverride:o?e[o]:void 0,imageUrl:r,titleHitHighlightProperty:"displayName",subtitleHitHighlightProperty:null!==(n=o)&&void 0!==n?n:"primaryEmailAddress"})}function st(e){switch(e){case"ClassicAttachment":return f.x.ClassicAttachment;case"OneDriveForBusiness":return f.x.OneDriveForBusiness;case"SharepointOnline":return f.x.SharepointOnline;default:return f.x.Undefined}}function lt(e,t){const{browseThisComputerConfig:n,getQueryRangeBoundingClientRect:i,handleEccUploadMenuEvent:r,handleKeyDown:o,menuParentElement:a,onDismissed:s,onPreventDismissOnEvent:l}=e.calloutProps,u=async e=>{await async function(e,t){const n=await(null==t?void 0:t());return!!n&&(e.clientX>=n.x&&e.clientX<=n.x+n.width&&e.clientY>=n.y&&e.clientY<=n.y+n.height)}(e,i)||(0,de.m)(e.target)||(0,de.Y)(e.target)||s(!1)},d=async e=>{l&&!l(e)&&s(!1)},c=[];if(a){const e=new m.J(a),i=new m.J(a.ownerDocument);let s;e.addListener("keydown",o),i.addListener("mouseup",u,{capture:!0}),t&&i.addListener("scroll",d,{capture:!0}),c.push(e),c.push(i),(null==n?void 0:n.eventTarget)&&r&&(s=new m.J(n.eventTarget),s.addListener("AttachCloudFilesSelected",r),s.addListener("UploadLocalFilesSelected",r)),s&&c.push(s)}return()=>{for(const e of c)e.removeAllListeners()}}let ut=class{constructor(e,t,n,i,r,_,b,C,T,S,I,w,E,x,A,D,N,F,P,k,O,B,M,q,U,W,j,z,H,Q,K,$){var Z;this._hostSettings=e,this._oaLogger=t,this._logger=n,this._guidGenerator=i,this._oaMetric=r,this._hostEmitter=_,this._proofingDom=b,this._paragraphTextExtractor=C,this._tileContent=T,this._oaResultStore=S,this._queryDetection=I,this._localizer=w,this._featureFlagsReader=E,this._proofingEmitter=x,this._safeWindow=A,this.languageScriptDirectionDetector=D,this._targetWindowFactory=F,this._targetDocumentFactory=P,this._paneOpenState=k,this._ariaStatusStateStoreFactory=O,this._indicatorStore=B,this._calloutDismissalHandler=M,this._externalSettingsFeature=q,this._instrumentationProcessor=U,this.feedbackStoreFactory=W,this._messageExtensionAppDataProvider=j,this.defaultInlineSuggestionItems=z,this.themeStore=H,this.userProfilePictureCache=Q,this._isMobile=$,this._menus=new Map,this.resultStatus=void 0,this._isClearingSearch=!1,this._isCIQMentionsEnabled=!0,this._isFirstMenuUpdate=!1,this._fileCount=0,this._queryCorrelationKeys=void 0,this.initialize=async()=>{var e;this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled)&&(this._hostEmitter.on(d.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(d.pD.hostModelTextTile,this._handleTextTile),this._hostEmitter.on(d.pD.nudgeAccepted,this.handleNudgeAccepted),this._hostEmitter.on(d.pD.ciqSettingsChange,this.ciqSettingsChange),this._hostEmitter.on(d.pD.hostModelRehydrateTilesFinished,this.hostModelRehydrateTilesFinished),this._hostEmitter.on(d.pD.hostModelVisualStateChange,this.hostModelVisualStateChange),this._calloutState.subscribe("menuUpdated",this.onMenuChanged))},this.shutDown=()=>{var e;null===(e=this._menuEventListenersDisposal)||void 0===e||e.call(this),this._menus.clear(),this._calloutState.updateCurrentMenu(void 0,void 0,void 0),this._scrollThrottle=void 0,this._resizeThrottle=void 0,this._calloutState.unsubscribe("menuUpdated",this.onMenuChanged)},this.onMenuChanged=e=>{this._proofingEmitter.emit("eccStateChanged",e)},this.hostModelVisualStateChange=e=>{var t,n;if(this._menuCurrentlyOpen&&e.message.tileId===this._menuCurrentlyOpen.parentTileId)if(e.message.created){this.renderECC(!1),null===(t=this._menuEventListenersDisposal)||void 0===t||t.call(this);const e=this._calloutState.getCalloutState();e&&(this._menuEventListenersDisposal=lt(e,null!==(n=this._hostSettings.useFluentV9)&&void 0!==n&&n))}else this._isMobile||this.dismissECC(!1)},this.renderMenuWithItems=async(e,t,n,i,r,o,a,s,l)=>{const u=this.isFlightEnabled("mc-editor-enable-searchbar");return this.showMenu(e,0,0,void 0,!0,{supportedEntityTypes:void 0,onItemSelected:r,theme:o,style:a,styles:s,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:i,getLocalItems:l,expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(u),browseThisComputerConfig:Le(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig(),enableExpandedECCSearchBar:u},n,!1,t)},this.showExistingMenu=async(e,t,n,i,r,o,a,s,l,u,d)=>{const c=this._menus.get(i);return!!c&&this.showMenu(e,t,n,i,r,Object.assign(Object.assign({},c),{shouldRemoveTextOnItemSelection:o,specifiedItemsToDisplay:l,expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(c.enableExpandedECCSearchBar),browseThisComputerConfig:Le(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig(),onItemSelected:null!=s?s:c.onItemSelected,supportedEntityTypes:a||l?a:c.supportedEntityTypes,onSuggestionsUpdated:l?void 0:c.onSuggestionsUpdated}),u,d)},this.showMenu=async(e,t,n,i,r,o,a,s,l)=>{var u,d;if(this._menuCurrentlyOpen)return!1;const c=this._proofingDom.findParagraphNode(e);if((0,R.l)(c)){const e=this._paragraphTextExtractor.getParagraphText(c);if(void 0!==e){const h=e.substring(t,t+n),g=h.charAt(0)===i,p={start:t,length:n,prefix:void 0!==i&&g?i:""};return this.setMenuCurrentlyOpen(i,o,c,p,void 0,null!=a?a:{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},r,o.shouldRemoveTextOnItemSelection,s,null===(u=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===u?void 0:u.source,l,h),(null===(d=this._calloutState.menuCurrentlyOpen)||void 0===d?void 0:d.specifiedItemsToDisplay)||be(this.getServices(),i,h,p,c,void 0),this.prepareAndRenderECC(c,h)}}return!1},this.showEntityPrediction=async(e,t,n,i,r,o)=>{var a,s;const l=null!==(s=null!==(a=this._menus.get(void 0))&&void 0!==a?a:this._menus.get(this._hostSettings.ciqTriggeringChar||"/"))&&void 0!==s?s:this.getDefaultMenuInformation();return this.showMenu(e,t,0,void 0,!0,Object.assign(Object.assign({},l),{supportedEntityTypes:void 0,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:n,onItemSelected:(e,t)=>{i(e,t)},onOpen:void 0,onClose:()=>{null==r||r()}}),{menuType:"InlineSuggestionsEntityPredictionMenuType"},!1,o)},this.onSearchBoxQueryChange=(e,t)=>{this._searchBox.onSearchBoxQueryChange(e,t)},this.buildAppGptConfig=()=>{var e;const{appGptConfig:t}=null!==(e=this._hostSettings.serviceSettings)&&void 0!==e?e:{};if(null==t?void 0:t.enableAppGpt)return t},this.showFlag=async(e,t,n,i,r,a,s,l,u)=>{var d,h,g,p,f,m,v;if(!e.nodeId)return!1;this._oaResultStore.clearResults(),this._queryDetection.removeDetectedQuery();const y=null!==(h=null!==(d=this._menus.get(void 0))&&void 0!==d?d:this._menus.get(this._hostSettings.ciqTriggeringChar||"/"))&&void 0!==h?h:this.getDefaultMenuInformation(),_=ye(e.typeId);if(void 0===_)return this._oaLogger.logDiagnostics("Unable to determine type of flag for critique type: "+e.typeId),!1;const b=this._proofingDom.findParagraphNode(e.nodeId);if((0,R.l)(b)){const d={start:e.start-b.element.offset,length:e.length,prefix:""},h=null!==(g=this._paragraphTextExtractor.getQueryString(b,d))&&void 0!==g?g:"";if(h){let g=!1;return this.setMenuCurrentlyOpen(void 0,Object.assign(Object.assign({},y),{supportedEntityTypes:e.supportedEntityTypes,specifiedItemsToDisplay:null!==(p=e.suggestionItems)&&void 0!==p?p:y.specifiedItemsToDisplay,shouldRemoveTextOnItemSelection:!1,onOpen:void 0,onClose:t=>{var i;t||null===(i=this._instrumentationProcessor)||void 0===i||i.process({critique:(0,ce.toJS)(e),eventId:V.xp.ClickNoAction}),n(void 0,g)},critiqueRange:d,onItemSelected:(i,r)=>{var o;null===(o=this._instrumentationProcessor)||void 0===o||o.process({critique:(0,ce.toJS)(e),eventId:V.xp.ChangeSuggOther}),t(e,i,r),n(!1,!1)},onFooterAction:async t=>{var l,d,h,p;let f;switch(t){case J._R.IgnoreOnce:f=V.xp.Ignore,null==i||i(e);break;case J._R.IgnoreAll:f=V.xp.IgnoreAll,null==r||r(e);break;case J._R.IgnoreRule:f=V.xp.DoNotCheckThisIssue,null==a||a(e);break;case J._R.OpenEditorPane:null===(d=null===(l=this._indicatorStore)||void 0===l?void 0:l.onOpenEditorPane)||void 0===d||d.call(l,o.k.ContextualCard),n(void 0,!1);break;case J._R.Options:null===(h=this._externalSettingsFeature)||void 0===h||h.openSettings(c.kY.dropdown);break;case J._R.Feedback:null==s||s(e);break;case J._R.Next:return g=!0,this.dismissECC(!1),void this.navigateWithDelay(u,1);case J._R.Previous:return g=!0,this.dismissECC(!1),void this.navigateWithDelay(u,-1)}f&&(null===(p=this._instrumentationProcessor)||void 0===p||p.process({critique:(0,ce.toJS)(e),eventId:f})),this.dismissECC(!1)},onSuggestionsUpdated:async(t,n,i,r,o,a,s,l,u,d,c,h,g)=>{let p=t;if(!e.suggestionItems&&y.onSuggestionsUpdated){if(p=await y.onSuggestionsUpdated(t,n,i,r,o,a,s,l,u,d,c,this.logWithMenuData,g),!p)return;e.supportedEntityTypes&&(p=p.filter((t=>{var n;return null===(n=e.supportedEntityTypes)||void 0===n?void 0:n.includes(t.entityType)})))}for(const t of p){e.groupTitle&&(t.groupTitle=e.groupTitle),e.groupSubtitle&&(t.groupSubtitle=e.groupSubtitle);for(const e of t.entities)e.isBestMatch=!1}return p},showMoreEntitiesConfig:this._searchBox.buildShowMoreEntitiesConfig(e,h,d,b),browseThisComputerConfig:Le(this.getServices(),(()=>this._menuCurrentlyOpen),e),appGptConfig:this.buildAppGptConfig(),expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(y.enableExpandedECCSearchBar)}),b,d,{x:0,y:3},{menuType:"InlineSuggestionsResultsFlagMenuType",flag:_,brandingMode:this._hostSettings.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("flag",!1,_!==J.z4.Topic,void 0!==u),critiqueSetSize:l?(0,ue.v)(l).length:void 0,critiquePosition:null==l?void 0:l.currentIndex},_!==J.z4.File,!0,!1,null===(f=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===f?void 0:f.source,void 0,h),(null===(m=this._menuCurrentlyOpen)||void 0===m?void 0:m.specifiedItemsToDisplay)||be(this.getServices(),null===(v=this._menuCurrentlyOpen)||void 0===v?void 0:v.triggerCharacter,h,d,b,void 0),this.prepareAndRenderECC(b,h)}}return!1},this.onFooterAction=e=>{var t;(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.onFooterAction)?this._menuCurrentlyOpen.onFooterAction(e):this.runDefaultFooterActionIfAvailable(e)},this.onSuggestionsUpdated=async(e,t,n,i,r,o,a,s,l,u,d,c,h)=>{var g,p,f;if(this._menuCurrentlyOpen)return this._menuCurrentlyOpen.specifiedItemsToDisplay&&(e=await n(this._menuCurrentlyOpen.specifiedItemsToDisplay)),null!==(f=null===(p=(g=this._menuCurrentlyOpen).onSuggestionsUpdated)||void 0===p?void 0:p.call(g,e,t,n,i,r,o,a,s,l,u,d,this.logWithMenuData,h))&&void 0!==f?f:e;this._oaLogger.logDiagnostics("Received suggestions update with no menu open")},this.logWithMenuData=(e,t,n)=>{const i=this.getDefaultLogDataForMenu();i.push(...null!=n?n:[]),this._oaLogger.logActivity(e,t,i)},this.handleNudgeAccepted=e=>{const t=e.message.data.nudge,n={hasEntityResults:void 0!==t.entityResults,entityType:t.entityType};!e.message.data.fromUserAction&&this._menuCurrentlyOpen?(this._menuCurrentlyOpen.wasOpenedViaNudge=!0,this._menuCurrentlyOpen.wasOpenedViaNudgeInfo=n):this._nextMenuOpenIsViaNudge=n},this._handleTextTile=e=>{if(e.message.messageType===h.G.RemoveData){const t=e.message.data.tileId;if(this._menuCurrentlyOpen){const e=t===this._menuCurrentlyOpen.tileId,n=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);(e||!n&&!this._isClearingSearch)&&this.dismissECC(!1)}}},this.ciqSettingsChange=e=>{this._isCIQMentionsEnabled=e.message.isCIQMenuEnabled},this.hostModelRehydrateTilesFinished=()=>{var e;if(!(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.parentTileId)||void 0===this._menuCurrentlyOpen.parentTileOffset)return;if(this._featureFlagsReader.flags.disableECCMenuRecreationOnALReconnection)return;const t=this._proofingDom.findTileNode(this._menuCurrentlyOpen.parentTileId);if(!t)return;const n=this._menuCurrentlyOpen.parentTileOffset+this._menuCurrentlyOpen.queryRange.start;let i;if(t.children)for(const e of t.children)if(e.element&&e.element.offset<=n&&e.element.offset+e.element.span>=n){i=e;break}if(!i)return;this._menuCurrentlyOpen.tileId=i.id;const r=this._paragraphTextExtractor.getQueryString(i,this._menuCurrentlyOpen.queryRange,!0);void 0!==r&&(this._oaResultStore.updateLoadingStatus(!0),be(this.getServices(),this._menuCurrentlyOpen.triggerCharacter,r,this._menuCurrentlyOpen.queryRange,i,this._queryDetection.getCurrentScope()))},this.notifyMenuTriggeringMethod=e=>{this._calloutState.setTriggerMethod(e)},this._handleDelta=async e=>{var t,n,i,r,o,a,s,u,d,c,h,p,f,m,v,y,_,b,C,T,S;const I=e.message;if(I.sourceType===g.pf.TileNode)return;const{changeType:w,delta:E,tileId:x}=I,A="InlineSuggestionsResultsUserInitiatedMenuType"!==(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.menuType.menuType);if((E.unit===G.OD.Sentence||E.unit===G.OD.Paragraph)&&(E.deltaType===G.WI.Add||E.deltaType===G.WI.Update)&&((null!==(i=null===(n=E.content)||void 0===n?void 0:n.length)&&void 0!==i?i:0)>1||0===(null===(r=E.content)||void 0===r?void 0:r.length))&&void 0===E.queryRange===(void 0===this._menuCurrentlyOpen||A))return;const D=!this._isClearingSearch;if(w!==g.Q0.Local){if(this._menuCurrentlyOpen){const e=null===(o=this._queryDetection.getCurrentQuery())||void 0===o?void 0:o.queryRange;if(e)this._menuCurrentlyOpen.queryRange=e,this._menuCurrentlyOpen.searchBoxGeneratedParagraphId||(null===(a=E.additionalData)||void 0===a?void 0:a.scopeInfo)||this.tryToUpdatePreloadedItems(E,x,!0);else{if(!D)return void(this._isClearingSearch=!1);this.dismissECC(!1)}}return}(null===(s=this._menuCurrentlyOpen)||void 0===s?void 0:s.shouldDismissOnTyping)&&this.dismissECC(!1);const N=this._proofingDom.findParagraphNode(x),F=null===(u=E.queryRange)||void 0===u?void 0:u.prefix;if(E.queryRange){if(!this._isCIQMentionsEnabled&&!1!==this._hostSettings.isHidingCIQMenuSupported&&(null!==(d=E.queryRange.prefix)&&void 0!==d?d:"@")===(null!==(c=this._hostSettings.ciqTriggeringChar)&&void 0!==c?c:"/"))return;const e=!this._menuCurrentlyOpen,t=!N&&(null===(h=this._menuCurrentlyOpen)||void 0===h?void 0:h.searchBoxGeneratedParagraphId)?E.content:this._paragraphTextExtractor.getQueryString(N,E.queryRange);if(this._menuCurrentlyOpen){if(void 0===t)return void this.dismissECC(!1);this._menuCurrentlyOpen.queryRange=E.queryRange,this._menuCurrentlyOpen.keyStrokes=this._menuCurrentlyOpen.keyStrokes+1,this.updateSpecifiedItemsToDisplay(x,t,!1),null===(f=(p=this._menuCurrentlyOpen).onQueryUpdated)||void 0===f||f.call(p,t),this._oaLogger.logActivity(ee,void 0,[...this.getDefaultLogDataForMenu()])}else if((0,R.l)(N)&&void 0!==t){const e=this._menus.get(F),n=this._hostSettings.eccTargetOffset;if(e){if((e.enableExpandedECC||(null===(v=null===(m=this._hostSettings.oaSettings)||void 0===m?void 0:m.scopesConfig)||void 0===v?void 0:v.enabled))&&E.additionalData){let t;(null===(y=this._nextMenuOpenIsViaNudge)||void 0===y?void 0:y.entityType)===l.c.File&&!this._nextMenuOpenIsViaNudge.hasEntityResults&&(null===(b=null===(_=this._hostSettings.serviceSettings)||void 0===_?void 0:_.nudge)||void 0===b?void 0:b.automaticallyScope)&&(t=l.c.File),e.enableExpandedECC&&(null===(C=this._hostSettings.oaSettings)||void 0===C?void 0:C.scopeToPeopleTabInExpandedECC)&&"@"===F&&(t=l.c.People),!e.enableExpandedECC&&(null===(T=this._hostSettings.oaSettings)||void 0===T?void 0:T.scopeToAppGptInlineSuggestion)&&"@"===F&&(t=l.c.App),t&&(this._queryDetection.setCurrentScope({entityType:t},!1),E.additionalData.scopeInfo={entityType:t})}this.setMenuCurrentlyOpen(F,Object.assign(Object.assign({},e),{expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(e.enableExpandedECCSearchBar),browseThisComputerConfig:Le(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig()}),N,E.queryRange,n,{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",brandingMode:e.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},!1,!0,!1,null===(S=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===S?void 0:S.source,void 0,t),1!==E.queryRange.length&&this._calloutState.menuCurrentlyOpen&&(this._calloutState.menuCurrentlyOpen.keyStrokes=this._calloutState.menuCurrentlyOpen.keyStrokes+1),this.prepareAndRenderECC(N,t),this._oaLogger.logActivity(ee,void 0,[...this.getDefaultLogDataForMenu()])}}this.tryToUpdatePreloadedItems(E,x,e)}else D&&this.dismissECC(!1)},this.updatePreloadedItemsDebounced=(0,le.debounce)(this.updatePreloadedItems,200),this.handleEccUploadMenuEvent=e=>{this._menuCurrentlyOpen&&function(e,t,n){try{const i=n.detail,r=Te(t,e);e.oaLogger.logActivity(ie,i,[...r,(0,p.n)("eventType",n.type)])}catch(t){e.logger.error(506557473,`Failed to log uploadMenuEvent ${n.type}`,t)}}(this.getServices(),this._menuCurrentlyOpen,e)},this.handleKeyDown=e=>{(async e=>{var t,n,i,r;if(this._menuCurrentlyOpen){for(const t of[a.m.arrowDown,a.m.arrowUp,a.m.arrowLeft,a.m.arrowRight,a.m.enter,a.m.tab,a.m.end,a.m.home])if((s.x.isKey(e,t)||s.x.isKey(e,t,!1,!1,!1,!0))&&this.handleExternalKeyboardEvents(t,e.altKey,e.shiftKey))return e.stopPropagation(),void e.preventDefault();if(!s.x.isKey(e,a.m.arrowLeft)&&!s.x.isKey(e,a.m.arrowRight)||await this.isKeyCursorOverParagraph(e)||(0,de.m)(e.target)){if(s.x.isKey(e,a.m.space)&&(null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.queryRange.length)===(null===(i=null===(n=this._queryDetection.getCurrentQuery())||void 0===n?void 0:n.queryRange.prefix)||void 0===i?void 0:i.length)&&this._oaLogger.logActivity(X,void 0,[...this.getDefaultLogDataForMenu(),(0,p.n)("interaction","Space")]),s.x.isKey(e,a.m.delete)){const e=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,t=await this._tileContent.getTextSelection();(null==t?void 0:t.startPositionInParagraphNode)===e&&this.dismissECC(!1)}s.x.isKey(e,a.m.escape)&&((null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.enableCurrentQueryDismissalOnEscape)&&this._queryDetection.dismissCurrentQuery(!0,"Escape",X,this.getDefaultLogDataForMenu()),this.dismissECC(!1),e.stopPropagation(),e.preventDefault())}else this.dismissECC(!1)}})(e).catch((e=>{this._logger.error(506803665,"handleKeyDown threw an exception",e)}))},this.getQueryRangeBoundingClientRect=async()=>{if(!this._menuCurrentlyOpen)return;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!(0,R.l)(e))return;const t=await this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+this._menuCurrentlyOpen.queryRange.start,this._menuCurrentlyOpen.queryRange.length);return null==t?void 0:t.getBoundingClientRect()},this.dismissMenu=async()=>{this.dismissECC(!1)},this.onDismissed=async e=>{this.dismissECC(e)},this.dismissECC=e=>{var t,n;if(!this._menuCurrentlyOpen)return;this._queryDetection.resetNextDeltaProgramaticallyInserted(),!e&&this._searchBox.getIsSearchBarAvailable()&&this.removeComposingBoxQuery(),null===(t=this._menuEventListenersDisposal)||void 0===t||t.call(this);const i=this._menuCurrentlyOpen;this._calloutState.updateCurrentMenu(void 0,void 0,void 0);const r=this._queryDetection.getPreviousQueryCorrelationKeys();this._oaLogger.logActivity("OAPanelClosed",void 0,[...(0,p.W)(["keyStrokeToSuccess",i.keyStrokes],["persistTime",i.openTime?Date.now()-i.openTime:0],["accepted",e]),...this.getDefaultLogDataForMenu(i)],r),this._searchBox.menuDismissed(i),null===(n=i.onClose)||void 0===n||n.call(i,e,i.openTime?Date.now()-i.openTime:0),this._queryDetection.removeDetectedQuery();const o=this.isAtTriggeringChar(i);e?this.setAriaStatus(o?"ebx_AtCIQMentionsClosedViaInsertionAriaLabel":"ebx_SlashCIQMentionsClosedViaInsertionAriaLabel"):this.setAriaStatus(o?"ebx_AtCIQMentionsClosedAriaLabel":"ebx_SlashCIQMentionsClosedAriaLabel")},this.renderECC=(e=!1)=>{if(!this._menuCurrentlyOpen)return;const t=()=>{var e;(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.onOpen)&&this._menuCurrentlyOpen.onOpen(this._menuCurrentlyOpen),this._menuCurrentlyOpen&&(this._menuCurrentlyOpen.wasOpenedViaNudge?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByNudgeAriaLabel":"ebx_SlashCIQMentionsOpenedByNudgeAriaLabel"):"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByUserTypingAriaLabel":"ebx_SlashCIQMentionsOpenedByUserTypingAriaLabel",this._menuCurrentlyOpen.queryRange.prefix):"InlineSuggestionsResultsFlagMenuType"===this._menuCurrentlyOpen.menuType.menuType&&this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByFlagAriaLabel":"ebx_SlashCIQMentionsOpenedByFlagAriaLabel"));const t=this._queryDetection.getCurrentQueryLogicalId();t&&this._oaMetric.addMeasure(t,"InlineSuggestionsCalloutDisplay")};this._calloutState.calculateTargetLocationAndShow().then((()=>{e&&t()})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to display callout: ${e}`)}))},this.onAction=e=>{var t,n,i,r,o,a,s;if(this._menuCurrentlyOpen){if(e===f.L.Retry)this.retryQuery();else{this._oaResultStore.clearResults(),(null===(t=this._calloutState.currentScope)||void 0===t?void 0:t.entityType)&&this.resetStateAndUpdateScope(void 0);const a=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!a)return void this._oaLogger.logDiagnostics("No parent found for clearing search");this._oaLogger.logActivity("OAPanelClearQuery",void 0,this.getDefaultLogDataForMenu());const s=null!==(i=null===(n=this._menuCurrentlyOpen.queryRange.prefix)||void 0===n?void 0:n.length)&&void 0!==i?i:1,l=this._menuCurrentlyOpen.menuType.menuType,u=this._menuCurrentlyOpen.queryRange.length;if("InlineSuggestionsResultsFlagMenuType"===l){if(u===s)return this._oaLogger.logDiagnostics("ECC query cleared with no query"),this.retryQuery(),void(null===(o=(r=this._menuCurrentlyOpen).onAction)||void 0===o||o.call(r,e));this.wrapInClearingSearch((()=>{var e,t;this._searchBox.initShowMoreEntitiesParagraph(null===(t=null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.showMoreEntitiesConfig)||void 0===t?void 0:t.entityType,!1,""),this._oaLogger.logActivity(ne,void 0,this.getDefaultLogDataForMenu())}))}else if(u!==s){const e=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,this._menuCurrentlyOpen.queryRange.start),t=this._menuCurrentlyOpen.queryRange.length-s;this.wrapInClearingSearch((()=>this._tileContent.remove(a,void 0,e+s,t)))}}null===(s=(a=this._menuCurrentlyOpen).onAction)||void 0===s||s.call(a,e)}this._hostEmitter.emit(d.pD.oaAnnotationsTriggered,{address:void 0,message:void 0})},this.onPreventDismissOnEvent=e=>{var t,n,i,r,o;if(!this._menuCurrentlyOpen)return!1;if(this._isClearingSearch)return!0;if("InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType){if(["click","mouseup"].includes(e.type))return!0;if("resize"===e.type&&(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableResizeDismissal))return!1;if("resize"===e.type)return this.getResizeThrottle()(),!0;if("scroll"===e.type||"wheel"===e.type)return this._hostSettings.useFluentV9?!!(null===(i=(n=e.target).closest)||void 0===i?void 0:i.call(n,".ms-ecc-callout")):(this.getScrollThrottle()(),!0)}return!!(null===(o=(r=this._menuCurrentlyOpen).onPreventDismissCalloutOnEvent)||void 0===o?void 0:o.call(r,e,this._menuCurrentlyOpen))||"focus"===e.type&&"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType||!(!this._calloutDismissalHandler||this._calloutDismissalHandler.shouldDismissCallout(e,"ECC",this._menuCurrentlyOpen))},this.onRestoreFocus=(e,t)=>{var n;(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.onRestoreFocus)?this._menuCurrentlyOpen.onRestoreFocus(e,t):t()},this.telemetryKeptCallback=(e,t)=>{const n=this._oaLogger;e&&setTimeout((()=>{e()&&this._hostSettings.enableKeptMetric&&n.logActivity("OAValueKept",void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(t)])}),3e4)},this.onItemSelected=e=>{var t,n,i,r,o,a,s;if(!this._menuCurrentlyOpen)return;const u=e;if((null===(n=null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===n?void 0:n.enabled)&&u.scopeInfo&&u.entityType===l.c.Scope)this.resetStateAndUpdateScope(u.scopeInfo);else if("feedback"!==u.key)if(u.entityType&&u.key){const e=u.entityType;this.resetStateAndUpdateScope(e?{entityType:e}:void 0)}else if(u.type!==l.c.Scope)try{u.wasOpenedViaNudge=this._menuCurrentlyOpen.wasOpenedViaNudge,u.wasOpenedViaNudgeAndHasEntityResults=null===(r=this._menuCurrentlyOpen.wasOpenedViaNudgeInfo)||void 0===r?void 0:r.hasEntityResults,this._oaLogger.logActivity("OAValueInserted",void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(u)]);const e=this._searchBox.getIsSearchBarAvailable(),t=null!==(o=this._menuCurrentlyOpen.critiqueRange)&&void 0!==o?o:this._menuCurrentlyOpen.queryRange,n=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,e?this._menuCurrentlyOpen.initialQueryStartPosition:t.start);e&&this._calloutState.searchBoxQueryString.length>0&&this._oaLogger.logActivity("ExpandedEccSearchBarResultSelected",void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(u)]);const i=this._menuCurrentlyOpen.onItemSelected,l=e=>this.telemetryKeptCallback(e,u);if(this._menuCurrentlyOpen.shouldRemoveTextOnItemSelection){const r=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!r)return void this._oaLogger.logDiagnostics("No parent found for selecting ECC item.");let o;o=!e||void 0===this._searchBox.lastComposingBoxQuery&&this._calloutState.triggerMethod!==me.P.AttachFile&&this._calloutState.triggerMethod!==me.P.Fre?t.length:(null!==(s=null===(a=this._searchBox.lastComposingBoxQuery)||void 0===a?void 0:a.length)&&void 0!==s?s:0)+(t.prefix?t.prefix.length:1),this._tileContent.remove(r,void 0,n,o).then((e=>{i(u,e,r.element,l)})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to remove text range for ECC application: ${e}`)}))}else if(this._menuCurrentlyOpen.shouldCalculateRemovalRange){const e=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!e)return void this._oaLogger.logDiagnostics("No tile found for selecting ECC item.");this._tileContent.getRangeOfNode(e,void 0,n,t.length).then((t=>{t?i(u,t,e.element,l):this._oaLogger.logDiagnostics("Could not determine Range for the search query after selected ECC item.")})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to determine range for ECC application: ${e}`)}))}else i(u,void 0,void 0,l)}finally{this.dismissECC(!0)}else{const t=null===(i=e.scopeInfo)||void 0===i?void 0:i.entityType;this.resetStateAndUpdateScope(t?{entityType:t}:void 0)}else this.onFooterAction(J._R.Feedback)},this.removeComposingBoxQuery=e=>{this.wrapInClearingSearch((()=>this._searchBox.removeComposingBoxQuery(e)))},this.wrapInClearingSearch=e=>(this._isClearingSearch=!0,Promise.resolve(e()).then((()=>{this._isClearingSearch=!1}))),this.onFeedbackButtonClicked=()=>{var e,t,n,i,r,o;if(!(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.onFeedbackButtonClicked))return;const a=[];this._calloutState.suggestions.map((e=>{e.entities.map((e=>{a.push(e)}))}));const s={conversationId:null===(n=this._queryCorrelationKeys)||void 0===n?void 0:n.conversationId,logicalId:null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.logicalId,sessionId:null===(r=this._hostSettings.hostMetadata)||void 0===r?void 0:r.sessionId,query:this._calloutState.queryString,tab:null===(o=this._calloutState.currentScope)||void 0===o?void 0:o.entityType,entities:a};this._hostSettings.serviceSettings.ECCFeedbackSettings.onFeedbackButtonClicked(s)},this.isFlightEnabled=e=>(this._hostSettings.flightsToTrack||[]).includes(e),this.setPreloadedSuggestions=(e,t)=>{this._calloutState.setPreloadedSuggestions(this.convertNewSuggestions(e,void 0,t,void 0,!0,!0)),this.resultStatus=u.i.Success},this.handleExternalKeyboardEvents=(e,t,n)=>{if(!this._menuCurrentlyOpen)return!1;if(t)return!1;if(n&&!this._menuCurrentlyOpen.enableExpandedECC)return!1;const i=new Map([[a.m.arrowDown,se.h.ArrowDown],[a.m.arrowUp,se.h.ArrowUp],[a.m.arrowLeft,se.h.ArrowLeft],[a.m.arrowRight,se.h.ArrowRight],[a.m.home,se.h.Home],[a.m.end,se.h.End],[a.m.tab,se.h.Tab],[a.m.enter,se.h.Enter]]).get(e);return void 0!==i?(this.onUserInteraction(e),this._calloutState.keyboardHandlerTarget.onKeyPressed(i,t,n)):(this._oaLogger.logDiagnostics("[InlineSuggestionStore] unexpected keyboard event",{key:e}),!1)},this.onGroupSelected=e=>{var t,n,i,r;if(!(null===(n=null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===n?void 0:n.enabled))return;const o=e.suggestions[0],a=null==o?void 0:o.entityType,s=e.isScoped;null===(r=null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.onGroupSelected)||void 0===r||r.call(i,e);const l=!s&&a?{entityType:a,contentSources:o.GroupContentSources}:void 0;if(this.resetStateAndUpdateScope(l),!this._hostSettings.oaSettings.mockResults){const e={results:[],isLoading:!0,resultStatus:void 0,queryCorrelationKeys:this._queryCorrelationKeys?Object.assign(Object.assign({},this._queryCorrelationKeys),{scopeInfo:l}):void 0,nodeId:void 0,resultReset:!0};this._calloutState.clearQueryString(!0),this.updateState(e)}},this.onUserInteraction=e=>{const t=new Map([[a.m.arrowDown,"DownArrow"],[a.m.arrowUp,"UpArrow"],[a.m.enter,"Enter"],[a.m.tab,"Tab"],[void 0,"MouseEntering"]]).get(e);t&&this._oaLogger.logActivity("OAPanelUserInteraction",void 0,[(0,p.n)("interaction",t)],this._queryCorrelationKeys)},this.getCurrentQueryString=()=>{var e;const t=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange,n=this._queryDetection.getCurrentQueryTileId(),i=t&&n&&this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(n),t)||"";return this._calloutState.searchBoxQueryString||i},this.onFirstRender=()=>{var e,t,n,i,r,o;this._oaLogger.logActivity("OAPanelDisplayed",void 0,(0,p.W)(["numOfSonoraSuggestionsDisplayed",this._calloutState.suggestions.length],["numOfSonoraFileSuggestionsDisplayed",this._fileCount],["triggerCharacter",null!==(t=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange.prefix)&&void 0!==t?t:"@"],["isUserInsertion",null===(i=null===(n=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===n?void 0:n.isUserInsertion)||void 0===i||i],["source",null!==(o=null===(r=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===r?void 0:r.source)&&void 0!==o?o:""],[Y,!!this._hostSettings.enableKeptMetric],["wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===this._calloutState.menuType.menuType],["menuType",this._calloutState.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")])),this.handleOAMetric("InlineSuggestionRendered","add")},this.onProcessedResults=()=>{this.handleOAMetric("InlineSuggestionProcessedResults","add")},this.onRenderResults=()=>{this.handleOAMetric("InlineSuggestionResultsRendered","commit")},this.updateState=e=>{var t,n;e.results.length<1&&!(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.specifiedItemsToDisplay)&&!(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.onSuggestionsUpdated)?this.updateInternalState(e,[]):(this._messageExtensionAppDataProvider?this._messageExtensionAppDataProvider.getAppDefinitionIdMap():Promise.resolve(void 0)).then((t=>{var n;const i=this.getCurrentQueryString(),r=this.convertNewSuggestions(e.results,e.queryCorrelationKeys,e.nodeId,t,e.isLocalSuggestion);this.onSuggestionsUpdated(r,i,(n=>Promise.resolve(this.convertNewSuggestions(n,e.queryCorrelationKeys,e.nodeId,t,!0))),e.resultStatus,e.isLoading,this._queryDetection.getCurrentScope(),e.resultReset,e.latency,this._calloutState.menuType,null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.supportedEntityTypes,void 0,this.logWithMenuData,e.resultSummary).then((t=>{var n;t?((null===(n=this._queryCorrelationKeys)||void 0===n?void 0:n.logicalId)&&this._oaMetric.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionUpdated"),this.updateInternalState(Object.assign(Object.assign({},e),{isLoading:!(e.isLoading&&t.length>0)&&e.isLoading,resultStatus:t.length>0?u.i.Success:e.results.length>0&&0===t.length?u.i.NoResults:e.resultStatus}),t,i)):this._calloutState.setQueryString(i)})).catch((e=>this._oaLogger.logDiagnostics(`Failed to convert suggestions: ${e}`)))})).catch((e=>this._oaLogger.logDiagnostics(`Failed to get ME app definitions: ${e}`)))},this.resetStateAndUpdateScope=e=>{var t;this.reset({scope:null==e?void 0:e.entityType,isLoading:!0,resultReset:!0,dueToScope:!0}),this._queryDetection.setCurrentScope(e);const n=this._proofingDom.findParagraphNode(this._queryDetection.getCurrentQueryTileId()||""),i=null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.queryRange;if(!n||!i)return;this._hostSettings.oaSettings&&!this._hostSettings.oaSettings.mockResults&&this._oaResultStore.updateLoadingStatus(!0),function(e,t,n){const i=new _e.s({deltaType:G.WI.Update,unit:G.OD.Chars,position:t.start,length:0,content:"",queryRange:t,additionalData:e.queryDetection.getCurrentQueryCorrelationKeys(),userInfo:{userType:G.HS.SessionUser}});Ce(e.hostEmitter,n,i)}(this.getServices(),i,n);const r=(0,L.q)(this._tileContent,n);if(!(null==r?void 0:r.ownerDocument.defaultView))return;const o=new m.J(r.ownerDocument.defaultView);o.addListener("focus",(e=>{e.stopPropagation(),o.removeAllListeners()}),{capture:!0,once:!0}),r.focus()},this.convertNewSuggestions=(e,t,n,i,r,o)=>{var a,s,u,d,c,h,g,p;if(e.length<1)return[];const f=[];for(const p of e){const e=[];for(const f of p.entities){const p=(this._hostSettings.flightsToTrack||[]).includes("mc-editor-enable-files-new-tidbits"),v=ot(f,this.userProfilePictureCache,null===(a=this._hostSettings.userId)||void 0===a?void 0:a.userDisplayName,0===this._calloutState.queryString.length,this._localizer,null===(s=this._menuCurrentlyOpen)||void 0===s?void 0:s.newEntityTypes,i,p,null!==(d=null===(u=this._hostSettings.oaSettings)||void 0===u?void 0:u.enableConnectorGroupHeadings)&&void 0!==d&&d);if(!v)continue;v.logicalId=null==t?void 0:t.logicalId,v.nodeId=n;const y=v.type;if(!o&&(m=y,Object.values(l.c).includes(m))&&(null===(c=this._menuCurrentlyOpen)||void 0===c?void 0:c.supportedEntityTypes)&&!this._menuCurrentlyOpen.supportedEntityTypes.includes(y))continue;const _=new Date,b=v.id?null===(g=null===(h=this._menuCurrentlyOpen)||void 0===h?void 0:h.newItemsById)||void 0===g?void 0:g.get(v.id):void 0;b&&_<b&&(v.isNew=!0),(r||e.length<this.getMaxEntityCount(y,this._queryDetection.getCurrentScope()))&&e.push(v)}f.push(Object.assign(Object.assign({},p),{entities:e}))}var m;return(null===(p=this._queryCorrelationKeys)||void 0===p?void 0:p.logicalId)&&this._oaMetric.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionConvertedSuggestions"),f},this._calloutState=new Be(this.getServices(),N,null!=K?K:new ge,this),this._searchBox=new Se(this.getServices(),this._calloutState,this.wrapInClearingSearch),this._oaResultStore.setOnUpdate(this.updateState),this.reset(),this._throttleManager=new v._(null!==(Z=this._targetWindowFactory())&&void 0!==Z?Z:new y.O(window))}get _menuCurrentlyOpen(){return this._calloutState.menuCurrentlyOpen}getResizeThrottle(){return this._resizeThrottle||(this._resizeThrottle=this._throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this._safeWindow,this.renderECC,25,"After")),this._resizeThrottle}getScrollThrottle(){var e;return this._scrollThrottle||(this._scrollThrottle=(0,_.hQ)(this._safeWindow,null!==(e=this._targetWindowFactory())&&void 0!==e?e:window,this.renderECC,"After")),this._scrollThrottle}getServices(){return{hostSettings:this._hostSettings,localizer:this._localizer,logger:this._logger,oaLogger:this._oaLogger,hostEmitter:this._hostEmitter,proofingDom:this._proofingDom,oaResultStore:this._oaResultStore,queryDetection:this._queryDetection,tileContent:this._tileContent,languageScriptDirectionDetector:this.languageScriptDirectionDetector,themeStore:this.themeStore,targetWindowFactory:this._targetWindowFactory,targetDocumentFactory:this._targetDocumentFactory}}getCurrentMenuInfo(){return this._menuCurrentlyOpen}getCalloutStateStore(){return this._calloutState}enableMenu(e){var t,n,i;const r=e.queryChar;if(this._menus.get(r))throw Error("This character is already being used for menu creation.");this._menus.set(r,Object.assign(Object.assign({},e),{shouldRemoveTextOnItemSelection:null===(t=e.shouldRemoveTextOnItemSelection)||void 0===t||t,browseThisComputerConfig:null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.browseThisComputerSettings,appGptConfig:null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.appGptConfig,enableExpandedECCSearchBar:e.enableExpandedECC&&void 0!==e.enableExpandedMenuSearchBar?e.enableExpandedMenuSearchBar:this.isFlightEnabled("mc-editor-enable-searchbar")})),this._queryDetection.registerQueryDetectionStartCharacter(r)}disableInlineSuggestionsMenu(e){if(!e)throw Error("You must specify a query character.");if(!this._menus.get(e))throw Error("This character is not being used for menu creation.");this._menus.delete(e),this._queryDetection.unregisterQueryDetectionStartCharacter(e),this._menuCurrentlyOpen&&this._menuCurrentlyOpen.queryRange.prefix===e&&this.dismissECC(!1)}getMenuInfo(e){return this._menus.get(e)}prepareAndRenderECC(e,t){var n,i;this._isFirstMenuUpdate=!0;const r=this._queryDetection.getCurrentQueryLogicalId();r&&this._oaMetric.addMeasure(r,"InlineSuggestionsRenderer"),this._calloutState.setQueryString(t),null===(n=this._menuEventListenersDisposal)||void 0===n||n.call(this);const o=this._calloutState.getCalloutState();return o&&(this._menuEventListenersDisposal=lt(o,null!==(i=this._hostSettings.useFluentV9)&&void 0!==i&&i)),this.updateSpecifiedItemsToDisplay(e.id,t,!0),this.renderECC(!0),!0}navigateWithDelay(e,t){setTimeout((()=>{e(t)}),50)}getDefaultMenuInformation(){return{supportedEntityTypes:void 0,onItemSelected:()=>{},shouldRemoveTextOnItemSelection:!0,enableExpandedECCSearchBar:this.isFlightEnabled("mc-editor-enable-searchbar")}}async tryToUpdatePreloadedItems(e,t,n=!1){var i;if(!(null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.getLocalItems))return void this._calloutState.clearPreloadedSuggestions();const r=this._proofingDom.findParagraphNode(t),o=e.queryRange&&this._paragraphTextExtractor.getQueryString(r,e.queryRange);if(void 0!==o){const i=await this._menuCurrentlyOpen.getLocalItems(o);n?await this.updatePreloadedItems(i,e,t):await this.updatePreloadedItemsDebounced(i,e,t)}}async updatePreloadedItems(e,t,n){var i;const r=null===(i=t.additionalData)||void 0===i?void 0:i.scopeInfo,o=new Set,a=new Set,s=new Set;for(const e of this._calloutState.preloadedSuggestions)for(const t of e.entities)t.entityId&&o.add(t.entityId),t.nodeId&&s.add(t.nodeId);for(const t of e)for(const e of t.entities)e.entityId&&a.add(e.entityId);const l=o.size===a.size&&[...o].every((e=>a.has(e))),u=s.has(n),d=0===e.length&&0!==this._calloutState.preloadedSuggestions.length;l&&u&&!d||r&&!e.some((e=>e.entityType===r.entityType))||this.setPreloadedSuggestions(e,n)}updateSpecifiedItemsToDisplay(e,t,n){var i;if(this._menuCurrentlyOpen){if(n){const e=this._menuCurrentlyOpen.getLocalItems?{isLoading:!1,resultReset:!1}:void 0;this.reset(e)}if(this._menuCurrentlyOpen.specifiedItemsToDisplay){const n=[];for(const e of this._menuCurrentlyOpen.specifiedItemsToDisplay){const i=e.entities.filter((e=>e.text.toLowerCase().includes(t.toLowerCase())));i.length>0&&n.push(Object.assign(Object.assign({},e),{entities:i}))}this._oaResultStore.updateResults(n,e,0===n.length?u.i.NoResults:u.i.Success,void 0,void 0,0===n.length?{NoResults:1}:{Success:1})}else(null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.mockResults)||(n?this._oaResultStore.startNewECCMenu():this._oaResultStore.updateLoadingStatus(!0))}}getCurrentPositionInDocument(e,t){var n,i;const r=this._proofingDom.findParagraphNode(e);let o=null!==(i=null===(n=null==r?void 0:r.element)||void 0===n?void 0:n.offset)&&void 0!==i?i:0;return o+=t,o}get menuParentElement(){return this._menuCurrentlyOpen?(0,L.q)(this._tileContent,this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId)):void 0}async isKeyCursorOverParagraph(e){var t;if(!this._menuCurrentlyOpen)return!1;const n=this._menuCurrentlyOpen.queryRange.start,i=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,r=await this._tileContent.getTextSelection();return void 0!==(null==r?void 0:r.startPositionInParagraphNode)&&(null===(t=r.startParagraphNode)||void 0===t?void 0:t.id)===this._menuCurrentlyOpen.tileId&&n!==i&&(r.startPositionInParagraphNode>n&&r.startPositionInParagraphNode<i||!(r.startPositionInParagraphNode!==n||n===i||!s.x.isKey(e,a.m.arrowRight))||!(r.startPositionInParagraphNode!==i||n===i||!s.x.isKey(e,a.m.arrowLeft)))}isAtTriggeringChar(e){return"@"===e.queryRange.prefix}getTileNode(e){const t=this._proofingDom.findParagraphNode(e);return null==t?void 0:t.parent}clearPreloadedSuggestions(){this._calloutState.clearPreloadedSuggestions()}retryQuery(){if(!this._menuCurrentlyOpen)return;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!e)return;const t=(0,M.F)(e);this._oaLogger.logActivity("OAPanelRetry",void 0,this.getDefaultLogDataForMenu()),this._hostEmitter.emit(d.pD.oaMenuControlSignal,{address:void 0,message:{mode:i.UserInitiated,retry:!0,documentModel:null==t?void 0:t.documentModel}})}getDefaultLogDataForMenu(e){const t=null!=e?e:this._menuCurrentlyOpen;return t?Te(t,this.getServices()):[]}setAriaStatus(e,t){var n,i;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(i=null===(n=this._ariaStatusStateStoreFactory)||void 0===n?void 0:n.call(this))||void 0===i||i.setStatus(this._localizer.getMessage(e,t),"assertive",!1))}getLogDataForSuggestion(e){var t,n;return e.entityType===l.c.File?(0,p.W)(["selectedType",e.entityType],["fileType",null!==(t=e.FileExtension)&&void 0!==t?t:"Unknown"],["fileSource",e.FileSourceType]):e.entityType===l.c.Loop?(0,p.W)(["selectedType",e.entityType],["loopType",null!==(n=e.id)&&void 0!==n?n:"Unknown"]):[(0,p.n)("selectedType",e.entityType)]}setMenuCurrentlyOpen(e,t,n,i,r,o,a=!1,s=!0,l=!1,u,d,c){var h;const g=Object.assign(Object.assign({triggerCharacter:e},t),{onFooterAction:e=>{var n;this.runDefaultFooterActionIfAvailable(e)||null===(n=t.onFooterAction)||void 0===n||n.call(t,e),this.dismissECC(!1)},targetLocation:{x:0,y:0},targetOffset:r,tileId:n.id,parentTileId:n.parent.id,parentTileOffset:n.element.offset,wasOpenedInBlankTile:n.parent.plainText.length<=(null!=e?e:"@").length,parentTileType:null===(h=n.parent.textFormattingInfo)||void 0===h?void 0:h.tileType,shouldDismissOnTyping:a,shouldCalculateRemovalRange:s,menuType:o,openTime:Date.now(),queryRange:i,initialQueryStartPosition:i.start,close:()=>{this.dismissECC(!1)},getQuery:()=>{if(this._menuCurrentlyOpen){const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);return this._paragraphTextExtractor.getQueryString(e,this._menuCurrentlyOpen.queryRange)}},onQueryUpdated:void 0,wasOpenedViaNudge:!!this._nextMenuOpenIsViaNudge,wasOpenedViaNudgeInfo:this._nextMenuOpenIsViaNudge,keyStrokes:0,wasOpenedViaAutomaticAtMention:l,invocationSource:u});this._nextMenuOpenIsViaNudge=void 0,this._calloutState.updateCurrentMenu(g,d,c)}runDefaultFooterActionIfAvailable(e){var t,n,i,r,a,s,l;if(e===J._R.OpenEditorPane)null===(n=null===(t=this._indicatorStore)||void 0===t?void 0:t.onOpenEditorPane)||void 0===n||n.call(t,o.k.ContextualCard);else if(e===J._R.Options)null===(i=this._externalSettingsFeature)||void 0===i||i.openSettings(c.kY.dropdown);else{if(e!==J._R.Feedback)return!1;null===(a=null===(r=this.feedbackStoreFactory)||void 0===r?void 0:r.call(this))||void 0===a||a.feedbackIconClicked("",null!==(l=null===(s=this._menuCurrentlyOpen)||void 0===s?void 0:s.triggerCharacter)&&void 0!==l?l:"Unknown menu type")}return!0}buildInlineSuggestionsResultsMenuActions(e,t,n,i){var r;const o=[];switch(this._hostSettings.isFeedbackEnabledForEcc&&o.push(J._R.Feedback),this._hostSettings.showOptionsButton&&o.push(J._R.Options),e){case"flag":t&&o.push(J._R.ReadAloud),n&&o.push(J._R.IgnoreRule),this._hostSettings.ignoreAllEnabled&&o.push(J._R.IgnoreAll),this._hostSettings.ignoreOnceEnabled&&o.push(J._R.IgnoreOnce),this._paneOpenState&&(this._paneOpenState.isPaneOpen?i&&(o.push(J._R.Previous),o.push(J._R.Next)):o.push(J._R.OpenEditorPane));break;case"userInitiated":(null===(r=this._paneOpenState)||void 0===r?void 0:r.isPaneOpen)||o.push(J._R.OpenEditorPane)}return o}reset(e){var t,n,i,r;if(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.mockResults)this.resetData(),this.mockAnnotations(null==e?void 0:e.scope);else if((null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.specifiedItemsToDisplay)||(null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.onSuggestionsUpdated)){this.resetData(e);const t=this.getNewCorrelationKeys(),n={results:[],isLoading:void 0!==(null==e?void 0:e.isLoading)?e.isLoading:this._calloutState.isLoading,resultStatus:this.resultStatus,queryCorrelationKeys:null!==(r=this._queryCorrelationKeys)&&void 0!==r?r:t,nodeId:void 0,resultReset:void 0===(null==e?void 0:e.resultReset)||e.resultReset};this._calloutState.clearQueryString(!(null==e?void 0:e.dueToScope)),this.updateState(n)}else this.resetData(e)}resetData(e){this._fileCount=0,this.resultStatus=void 0,this._calloutState.setExplicitLoadingState(void 0===(null==e?void 0:e.isLoading)||e.isLoading,void 0===(null==e?void 0:e.resultReset)||e.resultReset),this._queryCorrelationKeys=void 0}mockAnnotations(e){var t;switch(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.mockResultState){case"Loading":this._calloutState.setIsLoading();break;case"NoResult":this._calloutState.setHasSuggestions([],!0,"");break;case"Error":this._calloutState.setHadUnexpectedError(),this.resultStatus=u.i.UnexpectedError;break;default:n.e(1804).then(n.bind(n,4172)).then((t=>{this._calloutState.setHasSuggestions(this.convertNewSuggestions(t.mockInlineSuggestions.filter((t=>!e||t.entityType===e)),void 0,void 0,void 0,!0),!0,this.getCurrentQueryString())}))}}handleOAMetric(e,t){const n=this._queryDetection.getCurrentQueryLogicalId();n&&this._queryCorrelationKeys&&("commit"===t?this._oaMetric.commitEntry:this._oaMetric.addMeasure).bind(this._oaMetric)(n,e)}getNewCorrelationKeys(){var e,t,n,i,r;const o=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange,a=this._queryDetection.getCurrentQueryCorrelationKeys();return o&&a?Object.assign(Object.assign({},a),{isEmptyQuery:o.length===(null!==(n=null===(t=o.prefix)||void 0===t?void 0:t.length)&&void 0!==n?n:1),isTimeout:!1,queryLength:o.length-(null!==(r=null===(i=o.prefix)||void 0===i?void 0:i.length)&&void 0!==r?r:1)}):{logicalId:"",conversationId:"",isEmptyQuery:!0,queryLength:0}}_logResultStatus(e,t,n,i){const r=null!=n?n:this._guidGenerator.generate(),o=new Map([["QueryLength",this._calloutState.queryString.length.toString()]]),a=((e,t,n,i,r)=>Object.assign(Object.assign(Object.assign({Version:2,TraceId:e,LocalTime:(new Date).toISOString(),Status:t},i&&{ProviderName:i}),n&&{Latency:n}),r&&{RequestParams:r}))(r,u.i[e],t,i,o);this._oaLogger.logDiagnostics("OAResponseReceived",a)}updateInternalState(e,t,n){var i,o,a,s,d,c,h,g,f,m,v,y,_,b,C,T,S,I,w,E,x,A,D,N,F,P,k,O,B,R,L,M,q,U,W,j,z,H,V,G,Q,K,$,Z,J,Y,X,ee,te,ne;if(!this._menuCurrentlyOpen)return;let ie,re=t;if(this._isFirstMenuUpdate&&(null===(o=null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.scopesConfig)||void 0===o?void 0:o.enabled)&&this._hostSettings.oaSettings.scopesConfig.enableAutomaticScoping){const e=t.filter((e=>e.intent&&e.intent>0)).sort(((e,t)=>{var n,i;return(null!==(n=t.intent)&&void 0!==n?n:0)-(null!==(i=e.intent)&&void 0!==i?i:0)}))[0];e&&(void 0===e.isScopingEnabled||e.isScopingEnabled)&&(null!==(a=e.intent)&&void 0!==a?a:0)>(null!==(s=this._hostSettings.oaSettings.scopesConfig.automaticScopingIntentCutoff)&&void 0!==s?s:.9)&&(this._queryDetection.setCurrentScope({entityType:e.entityType},!1),re=t.filter((t=>t.entityType===e.entityType)))}if(this._isFirstMenuUpdate=!1,void 0!==n)ie=n;else{const e=null===(d=this._queryDetection.getCurrentQuery())||void 0===d?void 0:d.queryRange,t=this._queryDetection.getCurrentQueryTileId();if(e&&t)if(this._searchBox.getIsSearchBarAvailable()&&void 0!==this._searchBox.lastComposingBoxQuery){const n=Object.assign(Object.assign({},e),{prefix:this._menuCurrentlyOpen.triggerCharacter,start:this._menuCurrentlyOpen.initialQueryStartPosition+(null!==(h=null===(c=this._menuCurrentlyOpen.triggerCharacter)||void 0===c?void 0:c.length)&&void 0!==h?h:1),length:this._searchBox.lastComposingBoxQuery.length});ie=null!==(g=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),n))&&void 0!==g?g:""}else ie=null!==(f=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),e))&&void 0!==f?f:"";else ie=""}if(e.resultStatus===u.i.NoResults||e.resultStatus===u.i.Timeout||e.resultStatus===u.i.UnexpectedError)this._logResultStatus(e.resultStatus,e.latency);else if(e.resultStatus===u.i.Success){const t=this._guidGenerator.generate(),n=re.reduce(((e,t)=>e.concat(t.entities)),[]).filter((e=>e.providerName)).reduce(((e,t)=>{var n;const i=t.providerName;return e[i]||(e[i]=[]),e[i].push({Type:t.entityType,ReferenceId:null!==(n=t.entityId)&&void 0!==n?n:""}),e}),{});for(const[i,r]of Object.entries(n))if(this._logResultStatus(e.resultStatus,e.latency,t,i),"GraphSearch"!==i){const n=qe((null===(m=e.queryCorrelationKeys)||void 0===m?void 0:m.logicalId)||"",(null===(v=e.queryCorrelationKeys)||void 0===v?void 0:v.conversationId)||"",t,"suggestions",i,r);this._oaLogger.logDiagnostics("OAClientDataSource",Object.assign({logicalId:(null===(y=e.queryCorrelationKeys)||void 0===y?void 0:y.logicalId)||""},n))}}const oe=null===(_=this._queryDetection.getCurrentQuery())||void 0===_?void 0:_.queryRange;if(this._queryCorrelationKeys=Object.assign(Object.assign({},e.queryCorrelationKeys),{logicalId:null!==(C=null===(b=e.queryCorrelationKeys)||void 0===b?void 0:b.logicalId)&&void 0!==C?C:"",conversationId:null!==(S=null===(T=e.queryCorrelationKeys)||void 0===T?void 0:T.conversationId)&&void 0!==S?S:"",triggerCharacter:null!==(I=null==oe?void 0:oe.prefix)&&void 0!==I?I:"@",isEmptyQuery:!oe||oe.length===(null!==(E=null===(w=oe.prefix)||void 0===w?void 0:w.length)&&void 0!==E?E:1),queryLength:oe?oe.length-(null!==(A=null===(x=oe.prefix)||void 0===x?void 0:x.length)&&void 0!==A?A:1):0}),(null===(D=e.queryCorrelationKeys)||void 0===D?void 0:D.logicalId)&&this._oaMetric.addMeasure(e.queryCorrelationKeys.logicalId,"InlineSuggestionInternalStateUpdated"),this.resultStatus=e.resultStatus,!e.isLoading&&e.resultStatus!==u.i.UnexpectedError&&e.resultStatus!==u.i.Cancelled&&this.defaultInlineSuggestionItems)for(const e of this.defaultInlineSuggestionItems)for(const t of e(ie,this._calloutState.menuType,this._menuCurrentlyOpen.triggerCharacter,this._menuCurrentlyOpen.supportedEntityTypes,this._queryCorrelationKeys.scopeInfo))re.push(t),this.resultStatus=u.i.Success;if(this._fileCount=re.filter((e=>e.entityType===l.c.File)).length||0,0!==re.length||!e.isLoading){const t=re.reduce(((e,t)=>(e[t.entityType]=t.entities.length,e.total+=e[t.entityType],e)),{total:0}),{total:n}=t,i=(0,r.__rest)(t,["total"]);this._oaLogger.logActivity("OAPanelUpdated",void 0,(0,p.W)(["numOfSonoraSuggestionsDisplayed",n],["numOfSuggestionsDisplayed",JSON.stringify(i)],["status",null!==(N=e.resultStatus)&&void 0!==N?N:-1],["responseCancelled",null!==(P=null===(F=e.resultSummary)||void 0===F?void 0:F.Cancelled)&&void 0!==P?P:0],["responseEarlyExit",null!==(O=null===(k=e.resultSummary)||void 0===k?void 0:k.EarlyExit)&&void 0!==O?O:0],["responseNoResults",null!==(R=null===(B=e.resultSummary)||void 0===B?void 0:B.NoResults)&&void 0!==R?R:0],["responseSuccess",null!==(M=null===(L=e.resultSummary)||void 0===L?void 0:L.Success)&&void 0!==M?M:0],["responseTimeout",null!==(U=null===(q=e.resultSummary)||void 0===q?void 0:q.Timeout)&&void 0!==U?U:0],["responseUnexpectedError",null!==(j=null===(W=e.resultSummary)||void 0===W?void 0:W.UnexpectedError)&&void 0!==j?j:0],["isError",this._calloutState.isError],["latency",null!==(z=e.latency)&&void 0!==z?z:-1],["triggeringChar",null!==(H=this._queryCorrelationKeys.triggerCharacter)&&void 0!==H?H:"@"],["queryLength",this._calloutState.queryString.length],["scopeType",null!==(G=null===(V=this._queryCorrelationKeys.scopeInfo)||void 0===V?void 0:V.entityType)&&void 0!==G?G:""],["menuType",this._calloutState.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")],["hybrid",null!==($=null===(K=null===(Q=this._hostSettings.serviceSettings)||void 0===Q?void 0:Q.hybridAugloop)||void 0===K?void 0:K.enabled)&&void 0!==$&&$]),this._queryCorrelationKeys);const o=(null===(J=null===(Z=this._hostSettings.oaSettings)||void 0===Z?void 0:Z.scopesConfig)||void 0===J?void 0:J.enabled)?{HasClickableScopeHeader:!0}:void 0;this._oaLogger.logDiagnostics("OAClientLayout",((e,t,n)=>{return{LogicalId:e,Version:2,LocalTime:(i=new Date,function(e,t){const n=-e.getTimezoneOffset(),i=n>=0?"+":"-";return e.getFullYear()+"-"+Me(e.getMonth()+1)+"-"+Me(e.getDate())+"T"+Me(e.getHours())+":"+Me(e.getMinutes())+":"+Me(e.getSeconds())+"."+Me(e.getMilliseconds())+i+Me(n/60)+":"+Me(n%60)}(i)),LayoutType:"Vertical",ResultsView:Ue(t,n),PageNumber:0};var i})(null!==(X=null===(Y=e.queryCorrelationKeys)||void 0===Y?void 0:Y.logicalId)&&void 0!==X?X:"",this._calloutState.suggestions,o)),(null===(ee=e.queryCorrelationKeys)||void 0===ee?void 0:ee.logicalId)&&this._oaMetric.addMeasure(e.queryCorrelationKeys.logicalId,"InlineSuggestionAppendedConvertedSuggestions")}e.resultStatus===u.i.UnexpectedError||e.resultStatus===u.i.Cancelled?this._calloutState.setHadUnexpectedError():e.isLoading?this._calloutState.setExplicitLoadingState(!0,null!==(te=e.resultReset)&&void 0!==te&&te):(this._calloutState.setHasSuggestions(re,null!==(ne=e.resultReset)&&void 0!==ne&&ne,ie),this.fetchAndUpdateProfilePictureAndUpdateSuggestionsList(re))}getMaxEntityCount(e,t){var n,i,r;const o=!!(null==t?void 0:t.entityType),a=o?null===(i=null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.scopesConfig)||void 0===i?void 0:i.maxResults:(0,b.Z$)(null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.entitiesEnabled,e);return null!=a?a:o?5:3}async fetchAndUpdateProfilePictureAndUpdateSuggestionsList(e){const t=[];for(const n of e)t.push(...n.entities.filter((e=>e.entityType===l.c.People)));await Promise.all(t.map((async e=>{var t,n,i,r;(null===(t=this._queryCorrelationKeys)||void 0===t?void 0:t.logicalId)&&this._oaMetric.startEntry(this._queryCorrelationKeys.logicalId+e.Id,this._queryCorrelationKeys);const o=(0,rt.u)(e),a=await(null===(n=this.userProfilePictureCache)||void 0===n?void 0:n.fetchProfilePicture(o));e.imageUrl=a,a?(null===(r=this._queryCorrelationKeys)||void 0===r?void 0:r.logicalId)&&this._oaMetric.commitEntry(this._queryCorrelationKeys.logicalId+e.Id,"Success","ProfilePictureLoadingTime"):(null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.logicalId)&&this._oaMetric.commitEntry(this._queryCorrelationKeys.logicalId+e.Id,"Error","ProfilePictureLoadingTime")}))),this._calloutState.setHasSuggestions(this._calloutState.suggestions,!1,this._calloutState.queryString)}};ut=(0,r.__decorate)([(0,Q._)(),(0,r.__param)(0,(0,K.W)(C.n)),(0,r.__param)(1,(0,K.W)(T.m)),(0,r.__param)(2,(0,K.W)(S.g)),(0,r.__param)(3,(0,K.W)(I.G)),(0,r.__param)(4,(0,K.W)(w.u)),(0,r.__param)(5,(0,K.W)(d.M5)),(0,r.__param)(6,(0,K.W)(q.w)),(0,r.__param)(7,(0,K.W)(U.b)),(0,r.__param)(8,(0,K.W)(W.d)),(0,r.__param)(9,(0,K.W)(H.C)),(0,r.__param)(10,(0,K.W)(E.J)),(0,r.__param)(11,(0,K.W)(x.H)),(0,r.__param)(12,(0,K.W)(A.c)),(0,r.__param)(13,(0,K.W)(D.o)),(0,r.__param)(14,(0,K.W)(N.j)),(0,r.__param)(15,(0,K.W)(F.aP)),(0,r.__param)(16,(0,K.W)(we.j)),(0,r.__param)(17,(0,K.W)(P.cg)),(0,r.__param)(18,(0,K.W)(P.Ze)),(0,r.__param)(19,(0,$.l)()),(0,r.__param)(19,(0,K.W)(k.F)),(0,r.__param)(20,(0,$.l)()),(0,r.__param)(20,(0,K.W)(re.Th)),(0,r.__param)(21,(0,$.l)()),(0,r.__param)(21,(0,K.W)(j.y)),(0,r.__param)(22,(0,$.l)()),(0,r.__param)(22,(0,K.W)(oe.J)),(0,r.__param)(23,(0,$.l)()),(0,r.__param)(23,(0,K.W)(c.In)),(0,r.__param)(24,(0,$.l)()),(0,r.__param)(24,(0,K.W)(O.f)),(0,r.__param)(25,(0,$.l)()),(0,r.__param)(25,(0,K.W)(z.g)),(0,r.__param)(26,(0,$.l)()),(0,r.__param)(26,(0,K.W)(Re.Z)),(0,r.__param)(27,(0,$.l)()),(0,r.__param)(27,(0,Z.t)(Ie)),(0,r.__param)(28,(0,$.l)()),(0,r.__param)(28,(0,K.W)(ae.YQ)),(0,r.__param)(29,(0,$.l)()),(0,r.__param)(29,(0,K.W)(xe.A)),(0,r.__param)(30,(0,$.l)()),(0,r.__param)(30,(0,K.W)(Ee.e)),(0,r.__param)(31,(0,$.l)()),(0,r.__param)(31,(0,K.W)(B.n))],ut)},42608:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var i=n(30206),r=n(44680),o=n(86310),a=n(48828),s=n(90424);function l(e){return null==e}let u=class{constructor(e,t){this._hostSettings=e,this._oaLogger=t,this._appDefinitionIdMapCacheTTLInMilliseconds=6e4,this._appDefinitionIdMapCacheDisabled=!1,this.getAppDefinitionIdMap=async()=>{var e;if(null===(e=this._messageExtensionAppSuggestionSetting)||void 0===e?void 0:e.enabled)return!this._appDefinitionIdMapCacheDisabled&&this._appDefinitionIdMapLastNetwrokCallTime&&this._appDefinitionIdMapLastNetwrokCallTime+this._appDefinitionIdMapCacheTTLInMilliseconds>(new Date).getTime()?this._appDefinitionIdMap:(this.clearTimeout(),Promise.race([this.getAndAddAppDefinitionIdMapToCache(),this.getTimeoutPromise()]))},this.getAndAddAppDefinitionIdMapToCache=()=>new Promise((e=>this._getAppDefinitionIdMapCallback?this._getAppDefinitionIdMapCallback().then((t=>(this.clearTimeout(),this._appDefinitionIdMapCacheDisabled||(this._appDefinitionIdMap=t,this._appDefinitionIdMapLastNetwrokCallTime=(new Date).getTime()),e(t)))).catch((()=>(this.clearTimeout(),this._oaLogger.logDiagnostics("Failed to get appDefinitionIdMap from Host"),e(void 0)))):e(void 0))),this.getTimeoutPromise=(e=3e3)=>new Promise((t=>{this._timeoutId=setTimeout((()=>(this._oaLogger.logDiagnostics("getAppDefinitionIdMap:: request timeout"),t(void 0))),e)})),this.clearTimeout=()=>{this._timeoutId&&clearTimeout(this._timeoutId)},this.initialize()}initialize(){var e,t;this._messageExtensionAppSuggestionSetting=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.messageExtensionAppSuggestion,(null===(t=this._messageExtensionAppSuggestionSetting)||void 0===t?void 0:t.enabled)&&(this._getAppDefinitionIdMapCallback=this._messageExtensionAppSuggestionSetting.getAppDefinitionIdMapCallback,this._appDefinitionIdMapCacheDisabled=!l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)&&0===this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds,this._appDefinitionIdMapCacheTTLInMilliseconds=l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)?this._appDefinitionIdMapCacheTTLInMilliseconds:this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)}};u=(0,i.__decorate)([(0,a._)(),(0,i.__param)(0,(0,s.W)(r.n)),(0,i.__param)(1,(0,s.W)(o.m))],u)},4812:(e,t,n)=>{"use strict";n.d(t,{S:()=>o});var i=n(97782),r=n(23612);function o(e){if(e)return function(e){const t=(0,r.S)(e);return i.I.shouldRenderTypeName(t)}(e)?e:"Cloud"}},37156:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var i=n(26017),r=n(93381),o=n(29594);function a(e,t){const n=(0,o.$)().getStringsFor("InlineSuggestionStrings");switch(e){case i.c.File:return n("fileEntityLabel");case i.c.People:return n("peopleEntityLabel");case i.c.Loop:return n("loopsEntityLabel");case i.c.Topic:return n("topicsEntityLabel");case i.c.External:return n("externalEntityLabel");case i.c.MessageExtensionApp:return n("appEntityLabel");case i.c.Scope:return n("scopeEntityLabel");case i.c.Event:return n("eventEntityLabel");case i.c.Channel:return n("channelEntityLabel");case i.c.Chat:return n("chatEntityLabel");case i.c.Team:return n("teamEntityLabel");case i.c.Message:return n("emailEntityLabel");case i.c.PIM:return t===r.Nm.Address?n("addressEntityLabel"):t===r.Nm.Membership?n("membershipEntityLabel"):n("phoneEntityLabel");default:return e}}},11663:(e,t,n)=>{"use strict";n.d(t,{u:()=>r});var i=n(46546);function r(e){return(0,i.isObservableArray)(e.EmailAddresses)||Array.isArray(e.EmailAddresses)?e.EmailAddresses[0]:e.EmailAddresses}},95920:(e,t,n)=>{"use strict";n.d(t,{V:()=>D,S:()=>N});var i=n(30206),r=n(19432),o=n(13494),a=n(17288),s=n(2579),l=n(99828),u=n(53920),d=n(60040),c=n(38716),h=n(44680),g=n(86310),p=n(9654),f=n(8903),m=n(54218),v=n(21648),y=n(28871),_=n(51579),b=n(31409),C=n(66526),T=n(36271),S=n(86539),I=n(3327),w=n(63837),E=n(48828),x=n(90424),A=n(30225);const D=(0,w.f)("INudgeStateStore");let N=class extends r.z{constructor(e,t,n,i,r,d,c,h,g,p,f,m,v){super(),this.localizer=e,this.hostSettings=t,this.hostEmitter=n,this.oaLogger=i,this.proofingDom=r,this.nudgeStore=d,this.tileContent=c,this._queryDetection=h,this.paragraphTextExtractor=g,this._ariaStatusStateStoreFactory=p,this._featureFlagsReader=f,this.inlineSuggestionsRenderer=m,this.predictionStore=v,this._nudgeDisplayTime=void 0,this._nudge=void 0,this._nudgeDisplayLocation=void 0,this._nudgeTargetDocumentRef=void 0,this.enableInlineNudge=!1,this.initialize=async()=>{var e,t;this.hostEmitter.on(o.pD.hostModelDelta,this.handleDelta),this.hostEmitter.on(o.pD.hostModelTextTile,this.handleTextTile),this.enableInlineNudge=!!(null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.enableInlineNudge)},this.shutDown=()=>{},this.onNudgeUpdated=async()=>{var e,t,n,i,r,o,s,l,u,d,c,h,g,p,f;const m=this.nudgeStore.getCurrentNudge();if(m){if(this.oaLogger.logActivity("OANudgeReceived",void 0,[(0,a.n)("entityType",m.entityType.toString())],void 0),this.isNudgeDisabledForEntityType(null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge,m.entityType))return void await this.nudgeStore.clearNudge();if((null===(n=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===n?void 0:n.shouldRenderNudge)&&!this.hostSettings.serviceSettings.nudge.shouldRenderNudge(m))return void await this.nudgeStore.clearNudge();if(m.entityResults&&!(null===(r=null===(i=this.hostSettings.serviceSettings)||void 0===i?void 0:i.nudge)||void 0===r?void 0:r.entityNudgeClicked))return void await this.nudgeStore.clearNudge();if(m.entityResults&&(null===(l=null===(s=null===(o=this.inlineSuggestionsRenderer)||void 0===o?void 0:o.getCurrentMenuInfo())||void 0===s?void 0:s.wasOpenedViaNudgeInfo)||void 0===l?void 0:l.hasEntityResults))return void await this.nudgeStore.clearNudge();if(null===(u=this.predictionStore)||void 0===u?void 0:u.getCurrentPrediction())return void await this.nudgeStore.clearNudge();if(this._nudge&&this._nudge.text===m.text&&this._nudge.tileId===m.tileId&&this._nudge.entityType===m.entityType)return;const v=this.proofingDom.findParagraphNode(m.tileId);if(!(0,b.l)(v))return void await this.nudgeStore.clearNudge();const y=this.paragraphTextExtractor.getTextBetween(v,v,v.element.span-2,v.element.span);if(y&&""!==y){if(" :"===y)return void await this.onNudgeDismiss("space character precedes :");if(y.includes("@"))return void await this.onNudgeDismiss("@ character detected");if(y.includes("/"))return void await this.onNudgeDismiss("/ character detected")}const _=await this.tileContent.getNodeInsertionPosition(v.parent,v.element.offset+m.startIndex,!0);if(!_)return void await this.nudgeStore.clearNudge();if(!await this.isInputPointerAtNudge(m))return void await this.nudgeStore.clearNudge();const C=_.endContainer.parentElement;if(C&&this.containsInvalidNudgeSelector(C,null===(c=null===(d=this.hostSettings.serviceSettings)||void 0===d?void 0:d.nudge)||void 0===c?void 0:c.invalidNudgeSelectors))return void await this.nudgeStore.clearNudge();const T=_.getBoundingClientRect();this.updateNudge(m,null!==(h=null==C?void 0:C.ownerDocument)&&void 0!==h?h:document,T),this.oaLogger.logActivity("OANudgeDisplayed",void 0,[(0,a.n)("entityType",m.entityType.toString())],void 0),null===(f=null===(p=null===(g=this.hostSettings.serviceSettings)||void 0===g?void 0:g.nudge)||void 0===p?void 0:p.onNudgeDisplayed)||void 0===f||f.call(p,m),this.setAriaStatus("ebx_CIQNudgeDisplayed",m.text)}else this.clearNudge()},this.isInputPointerAtNudge=async e=>{var t;const n=await this.tileContent.getTextSelection();return!!n&&n.startPosition===n.endPosition&&(null===(t=n.startParagraphNode)||void 0===t?void 0:t.id)===e.tileId&&n.endPositionInParagraphNode===e.startIndex},this.updateNudge=(e,t,n)=>{this._nudge=e,this._nudgeTargetDocumentRef=new s.O(t),this._nudgeDisplayLocation=n,this._nudgeDisplayTime=Date.now(),this.publishStateChange()},this.clearNudge=()=>{this._nudge=void 0,this._nudgeTargetDocumentRef=void 0,this._nudgeDisplayLocation=void 0,this._nudgeDisplayTime=void 0,this.publishStateChange()},this.handleTextTile=e=>{if(this.nudge&&e.message.messageType===l.G.RemoveData){const t=e.message.data.tileId;this.nudge.tileId!==t&&this.proofingDom.findParagraphNode(this.nudge.tileId)||this.onNudgeDismiss("tile removed")}},this.handleDelta=async e=>{var t;const n=e.message;if(n.sourceType===u.pf.TileNode)return;if(!this.nudge)return;const i=await this.tileContent.getTextSelection();if(!this.nudge)return;let r;if((null==i?void 0:i.isCollapsed)&&i.startParagraphNode&&i.startParagraphNode.id===this.nudge.tileId&&i.startPositionInParagraphNode){if(r=await this.tileContent.getNodeInsertionPosition(i.startParentElement,i.startParagraphNode.element.offset+i.startPositionInParagraphNode,!0),!r)return this.oaLogger.logDiagnostics("Nudge text update: could not determine range for nudge insertion"),void await this.onNudgeDismiss("could not determine position");if(n.delta.deltaType===I.WI.Add&&(null===(t=n.delta.content)||void 0===t?void 0:t.includes(":"))&&" "===this.paragraphTextExtractor.getTextBetween(i.startParagraphNode,i.startParagraphNode,n.delta.position-1,n.delta.position))return void await this.onNudgeDismiss(": was proceeded with a space");const e=r.getBoundingClientRect();this._nudgeDisplayLocation&&(this._nudgeDisplayLocation=e,this.publishStateChange())}else(null==i?void 0:i.startParagraphNode)&&i.startPositionInParagraphNode?(i.isCollapsed||await this.onNudgeDismiss("Text range was selected"),0===i.startPositionInParagraphNode?await this.onNudgeDismiss("A new sentence was started"):await this.onNudgeDismiss("Text selection moved to another sentence")):await this.onNudgeDismiss("Unable to determine text selection")},this.nudgeStore.setOnUpdatedNudge(this.onNudgeUpdated)}get nudge(){return this._nudge}get nudgeDisplayLocation(){return this._nudgeDisplayLocation}get nudgeTargetDocumentRef(){return this._nudgeTargetDocumentRef}get insertionCharacter(){var e,t,n;return null!==(n=null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.insertionCharacter)&&void 0!==n?n:"@"}async onNudgeDismiss(e,t){var n,i,r;const o=this.nudgeStore.getCurrentNudge();if(!o)return;const s=this.proofingDom.findParagraphNode(o.tileId);if(!(0,b.l)(s))return void await this.nudgeStore.clearNudge();let l="";if(t){const e=this.paragraphTextExtractor.getTextBetween(s,s,s.element.span-2,s.element.span);l=": "===e?'user pasted text after ": "':(null==e?void 0:e.includes(":"))?'user pasted text after ":"':"user pasted text"}const u=Date.now()-this._nudgeDisplayTime;this.oaLogger.logActivity("OANudgeDismissed",void 0,(0,a.W)(["entityType",o.entityType.toString()],["dismissTrigger",t?l:e],["persistTime",u])),await this.nudgeStore.clearNudge(),null===(r=null===(i=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.nudge)||void 0===i?void 0:i.onNudgeDismissed)||void 0===r||r.call(i,o,u,t?l:e)}async onNudgeAccepted(e,t){var n,i,r,s,u,c,h,g,p,f;const m=this.nudgeStore.getCurrentNudge();if(!m)return void this.oaLogger.logDiagnostics("Nudge click: could not find nudge in store");const v=Date.now()-this._nudgeDisplayTime;if(this.oaLogger.logActivity("OANudgeClicked",void 0,(0,a.W)(["entityType",m.entityType.toString()],["persistTime",v],["userAction",e])),null===(r=null===(i=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.nudge)||void 0===i?void 0:i.onNudgeAccepted)||void 0===r||r.call(i,m,v,e,t),await this.nudgeStore.clearNudge(),t)if(null===(s=this.hostSettings.oaSettings)||void 0===s?void 0:s.isContextualCardEnabled){const e=this.proofingDom.findParagraphNode(m.tileId);if(!(0,b.l)(e))return void this.oaLogger.logDiagnostics("Nudge click: could not find paragraph node");const n=await this.tileContent.getTextSelection();let i;n||this.oaLogger.logDiagnostics("Nudge click: could not determine text selection");let r=0,a=!1;if((null==n?void 0:n.isCollapsed)&&n.startParagraphNode&&n.startParagraphNode.id===e.id&&n.startPositionInParagraphNode){const t=this.paragraphTextExtractor.getParagraphText(n.startParagraphNode);t&&!d.Yv(t.charCodeAt(n.startPositionInParagraphNode-1))&&(a=!0),r=e.element.offset+n.startPositionInParagraphNode,i=await this.tileContent.getNodeInsertionPosition(n.startParentElement,r,!0)}if(i||(r=e.element.offset+m.startIndex,i=await this.tileContent.getNodeInsertionPosition(e.parent,r,!0)),!i)return void this.oaLogger.logDiagnostics("Nudge click: could not determine range for nudge insertion");if(this.hostEmitter.emit(o.pD.nudgeAccepted,{message:{data:{nudge:m,fromUserAction:t},messageType:l.G.NewData},address:void 0}),m.entityResults){if(!(null===(c=null===(u=this.hostSettings.serviceSettings)||void 0===u?void 0:u.nudge)||void 0===c?void 0:c.entityNudgeClicked))return void this.oaLogger.logDiagnostics("Nudge click: entity nudge was clicked, but no callback was provided");if(m.entityResults.entities.length>1&&this.inlineSuggestionsRenderer){const t=[],n=m.entityResults.entities;t.push({entities:n,intent:m.entityResults.intent,entityType:m.entityResults.entityType});const i=r-e.element.offset,o=t=>{this.hostSettings.serviceSettings.nudge.entityNudgeClicked(t,e.parent.element,e.id,i)};await this.inlineSuggestionsRenderer.showExistingMenu(e.id,i,0,null!==(h=this.hostSettings.serviceSettings.nudge.insertionCharacter)&&void 0!==h?h:"@",!0,!1,void 0,o,t)}else this.hostSettings.serviceSettings.nudge.entityNudgeClicked(m.entityResults.entities[0],e.parent.element,e.id,r-e.element.offset)}else this._queryDetection.setNextDeltaProgramaticallyInserted("Nudge"),await this.tileContent.insert(e.parent,void 0,r,(a?" ":"")+(null!==(f=null===(p=null===(g=this.hostSettings.serviceSettings)||void 0===g?void 0:g.nudge)||void 0===p?void 0:p.insertionCharacter)&&void 0!==f?f:"@"),!0,i,!1)}else this.oaLogger.logDiagnostics("Nudge click: ECC was not enabled");else this.hostEmitter.emit(o.pD.nudgeAccepted,{message:{data:{nudge:m,fromUserAction:t},messageType:l.G.NewData},address:void 0})}isNudgeDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}containsInvalidNudgeSelector(e,t){var n;let i=!1;if(t)for(const r of t)(e.matches(r)||(null===(n=e.nextElementSibling)||void 0===n?void 0:n.matches(r)))&&(i=!0);return i}setAriaStatus(e,t){var n;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(n=this._ariaStatusStateStoreFactory())||void 0===n||n.setStatus(this.localizer.getMessage(e,t),"assertive",!1))}publishStateChange(){this.publishEvent("stateUpdated",{nudge:this._nudge,nudgeTargetDocumentRef:this._nudgeTargetDocumentRef,nudgeDisplayLocation:this._nudgeDisplayLocation})}};N=(0,i.__decorate)([(0,E._)(),(0,i.__param)(0,(0,x.W)(c.H)),(0,i.__param)(1,(0,x.W)(h.n)),(0,i.__param)(2,(0,x.W)(o.M5)),(0,i.__param)(3,(0,x.W)(g.m)),(0,i.__param)(4,(0,x.W)(C.w)),(0,i.__param)(5,(0,x.W)(y.Y)),(0,i.__param)(6,(0,x.W)(T.d)),(0,i.__param)(7,(0,x.W)(p.J)),(0,i.__param)(8,(0,x.W)(S.b)),(0,i.__param)(9,(0,x.W)(m.Th)),(0,i.__param)(10,(0,x.W)(f.c)),(0,i.__param)(11,(0,A.l)()),(0,i.__param)(11,(0,x.W)(v.V)),(0,i.__param)(12,(0,A.l)()),(0,i.__param)(12,(0,x.W)(_.o))],N)},92910:(e,t,n)=>{"use strict";n.d(t,{PF:()=>u,Qr:()=>l});var i,r=n(30206),o=n(48828),a=n(63837),s=n(51285);!function(e){e[e.None=0]="None",e[e.Processed=1]="Processed",e[e.SquiggleInitialized=2]="SquiggleInitialized"}(i||(i={}));let l=class{constructor(){this._processedCritiques=new Map,this._invalidatedItems=new Map,this._keystrokesCount=0,this.items=new Map,this.setItem=(e,t)=>{this.items.set(e,t)},this.process=e=>!(!e||this._processedCritiques.has(e)||(this._processedCritiques.set(e,{status:i.Processed,progress:0}),0)),this.setInitializationProgress=(e,t)=>{if(!e)return!1;const n=this._processedCritiques.get(e);return!(!n||n.status!==i.Processed&&n.status!==i.SquiggleInitialized||(this._processedCritiques.set(e,{status:i.SquiggleInitialized,progress:t}),0))},this.getSquiggleInitializationProgress=e=>{if(!e)return 0;const t=this._processedCritiques.get(e);return(null==t?void 0:t.status)===i.SquiggleInitialized?t.progress:0},this.forEachCritiqueForItems=(e,t)=>{for(const n of e){const e=this.items.get(n);if(!e)return;for(const i of e){const r=i[0];t({squiggles:i[1],key:r,elementCritiques:e,elementId:n})}}},this.removeForCritique=(e,t,n=!1)=>{const i=this.items.get(e);if(!i)return;const r=i.get(t);return r?(n&&this._invalidatedItems.set(t,{squiggles:r,keystrokes:this._keystrokesCount}),i.delete(t),r):void 0},this.isEmpty=e=>void 0===this.items.get(e)&&0===this._invalidatedItems.size,this.checkInvalidatedAutoCorrections=e=>{if(0===this._invalidatedItems.size)return void(this._keystrokesCount=0);if(this._keystrokesCount+=1,!e)return;const t=[];for(const n of this._invalidatedItems.entries()){const i=n[1];this._keystrokesCount-i.keystrokes>s.tB&&t.push(n[0]),e(i.squiggles)&&t.push(n[0])}for(const e of t)this._invalidatedItems.delete(e)}}};l=(0,r.__decorate)([(0,o._)()],l),(0,a.f)("IContentEditableAutoCorrectionCache");const u=(0,a.f)("IFormElementAutoCorrectionCache")},23751:(e,t,n)=>{"use strict";n.d(t,{n:()=>D});var i=n(30206),r=n(10059),o=n(60040),a=n(11387),s=n(3755),l=n(13494),u=n(31685),d=n(86278),c=n(83732),h=n(79993),g=n(71905),p=n(45118),f=n(44332),m=n(96950),v=n(31409),y=n(36271),_=n(66526),b=n(21206),C=n(6754),T=n(92910),S=n(51285),I=n(96120),w=n(48828),E=n(30122),x=n(90424),A=n(30225);let D=class{constructor(e,t,n,i,u,d,c,g,p,f,y,_,b){this._hostEmitters=e,this.tileContent=t,this.critiqueRangeBuilder=n,this.proofingDom=i,this.safeWindow=u,this._disableCritiqueHandler=d,this.logger=c,this.critiqueStore=g,this.applyCritiqueSuggestionHandler=p,this.applyFlagHandler=f,this.wordDictionary=y,this.editorSettingsManager=_,this._formElementAutoCorrectionCache=b,this.applyCritiqueSuggestion=async(e,t,n,i,a,s,l,u)=>{var d;await this.applySuggestion(e,t,{nodeId:n,offset:i.start,typeId:i.typeId,traceId:i.traceId,textInContext:i.textInContext},(async()=>{var n,l,u,d;(null===(n=i.textInContext)||void 0===n?void 0:n.includes("ï¿¼"))&&(i.start+=(i.textInContext.match(new RegExp("^ï¿¼+"))||[""])[0].length,i.length-=(i.textInContext.match(/ï¿¼/g)||[]).length,i.textInContext=i.textInContext.replace(/ï¿¼/g,""),a.text=a.text.replace(/ï¿¼/g,""));let c=!1;if(this.applyCritiqueSuggestionHandler&&this.critiqueRangeBuilder){const n=s||(null===(l=(await this.critiqueRangeBuilder.getCritiqueRanges([i],t))[0])||void 0===l?void 0:l.range);c=!!n&&!!this.applyCritiqueSuggestionHandler.onApplyCritiqueSuggestion(e,i,a,n)}const h=i.nodeId?this.proofingDom.findNode(i.nodeId):i.tileId?this.proofingDom.findNode(i.tileId.nodeId):null;if(h){if(!c){if(!(0,m.qB)(a)&&(0,m.ht)(i))this.tileContent.remove(h,t,i.start,i.length,!0,s);else{let{start:e,length:n}=i,l=a.text,u=s;if(i.textInContext&&i.typeId===r.L9.DoubleSpaceGrammar){const t=o.CC(i.textInContext,l),r=l.length-t.firstDiffRight;t.firstDiffLeft===r&&(e+=t.firstDiffLeft,n=1,l="",u=void 0)}this.tileContent.replace(h,t,e,n,l,u)}(0,m.MG)(i)&&(null===(d=this.wordDictionary)||void 0===d||d.addWordToIgnoreList(a.text))}}else null===(u=this.logger)||void 0===u||u.error(508146699,"Unable to find node while applying critique suggestion")})),!u||l!==S.Ah.autocorrection&&l!==S.Ah.personalizedAutocorrection||null===(d=this._formElementAutoCorrectionCache)||void 0===d||d.removeForCritique(u,i.traceId||"")},this.applyFlagSuggestion=(e,t,n,i,r,o)=>this.applySuggestion(e,t,{nodeId:n,offset:i.start,typeId:i.typeId,traceId:i.traceId,textInContext:i.textInContext},(async()=>{var n,a,s;const l=o||!this.critiqueRangeBuilder?o:null===(n=(await this.critiqueRangeBuilder.getCritiqueRanges([i],t))[0])||void 0===n?void 0:n.range;l?this.applyFlagHandler?this.applyFlagHandler.onApplyFlag(e,i,r,l):null===(s=this.logger)||void 0===s||s.error(523633800,"Flag application failed due to no applyFlagHandler"):null===(a=this.logger)||void 0===a||a.error(523633799,"Unable to determine range for flag application")})),this.ignoreCritiqueOnce=(e,t,n,i)=>{var o;(null===(o=this.applyCritiqueSuggestionHandler)||void 0===o?void 0:o.onIgnoreCritiqueSuggestion(e,i))||this.callbackOnProofedElement({nodeId:n,offset:i.start,typeId:i.typeId,traceId:i.traceId,textInContext:i.textInContext},r.$w.IgnoreOnce)},this.ignoreFlagOnce=(e,t,n,i)=>{var o;(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onIgnoreFlag(e,i))||this.callbackOnProofedElement({nodeId:n,offset:i.start,typeId:i.typeId,traceId:i.traceId,textInContext:i.textInContext},r.$w.IgnoreOnce)},this.ignoreAllOfFlag=(e,t,n)=>{var i,o;const a=this.proofingDom.findParagraphNode(n.nodeId);(0,v.l)(a)?(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onIgnoreAllOfFlag(e,n))||this.callbackOnProofedElement({nodeId:n.nodeId,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},r.$w.IgnoreAll):null===(i=this.logger)||void 0===i||i.error(507574144,"Unable to find paragraph node while ignoring all flags")},this.ignoreAllOfCritique=(e,t,n,i)=>{var r,o,s,l;if(!n)return;let u;u=(0,m.MG)(i)?i.suggestions[0].text:i.textInContext,u&&(null===(r=this.wordDictionary)||void 0===r||r.addWordToIgnoreList(u));const d=this.proofingDom.findParagraphNode(null!==(o=i.nodeId)&&void 0!==o?o:n);(0,v.l)(d)&&(null===(s=this.critiqueStore)||void 0===s||s.updateNode([{critique:(0,a._K)(i),critiqueDiffType:h.K.Delete}],d.parent.id,null!==(l=d.eventSeqId)&&void 0!==l?l:0))},this.disableCritiqueType=async(e,t,n,i)=>{var o,a;n&&(i.typeId&&await(null===(o=this.editorSettingsManager)||void 0===o?void 0:o.stopCheckingForCritiqueType(i.typeId)),this.callbackOnProofedElement({nodeId:n,offset:i.start,typeId:i.typeId,traceId:i.traceId,textInContext:i.textInContext},r.$w.DisableCritiqueType),await(null===(a=this._disableCritiqueHandler)||void 0===a?void 0:a.disableCritique(i)))},this.disableFlagType=(e,t,n,i)=>{var o;(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onDisableFlag(e,i))||this.callbackOnProofedElement({nodeId:n,offset:i.start,typeId:i.typeId,traceId:i.traceId,textInContext:i.textInContext},r.$w.DisableCritiqueType)},this.applySuggestion=async(e,t,n,i)=>{var o,a,l,u;const d=null!==(o=this.tileContent.getContainingElement(e))&&void 0!==o?o:t;if(!d)return void(null===(a=this.logger)||void 0===a||a.error(508146698,"Unable to find containing element"));const c=(0,I.m)(d),h=null!==(l=null==c?void 0:c.scrollTop)&&void 0!==l?l:0,g=null!==(u=null==c?void 0:c.scrollLeft)&&void 0!==u?u:0;await i(),this.callbackOnProofedElement(n,r.$w.ApplySuggestion);const p=(0,s.e)(d);this.safeWindow.requestAnimationFrame((()=>{c&&(c.scrollTop=h,c.scrollLeft=g)}),p)},this.callbackOnProofedElement=(e,t)=>{if(e.nodeId)for(const n of this._hostEmitters)n.emit(l.pD.hostModelCritiqueAction,{address:void 0,message:{critiqueInfo:e,actionType:t}})}}};D=(0,i.__decorate)([(0,w._)(),(0,i.__param)(0,(0,E.t)(l.zJ)),(0,i.__param)(1,(0,x.W)(y.d)),(0,i.__param)(2,(0,x.W)(g.s)),(0,i.__param)(2,(0,A.l)()),(0,i.__param)(3,(0,x.W)(_.w)),(0,i.__param)(4,(0,x.W)(u.j)),(0,i.__param)(5,(0,A.l)()),(0,i.__param)(5,(0,x.W)(b.W)),(0,i.__param)(6,(0,x.W)(d.g)),(0,i.__param)(6,(0,A.l)()),(0,i.__param)(7,(0,x.W)(h.$)),(0,i.__param)(7,(0,A.l)()),(0,i.__param)(8,(0,x.W)(p.a)),(0,i.__param)(8,(0,A.l)()),(0,i.__param)(9,(0,x.W)(f.K)),(0,i.__param)(9,(0,A.l)()),(0,i.__param)(10,(0,x.W)(C.s)),(0,i.__param)(10,(0,A.l)()),(0,i.__param)(11,(0,x.W)(c.rI)),(0,i.__param)(11,(0,A.l)()),(0,i.__param)(12,(0,A.l)()),(0,i.__param)(12,(0,x.W)(T.PF))],D)},79788:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i=(0,n(63837).f)("ICritiqueApplicationHandler")},51285:(e,t,n)=>{"use strict";n.d(t,{Ah:()=>r,eO:()=>o,kI:()=>a,tB:()=>i});const i=15;var r;function o(e){return function(e){return void 0!==e.range}(e)?e.range:void 0}function a(e){return e===r.autocorrection||e===r.personalizedAutocorrection}!function(e){e.autocorrection="autocorrection",e.critique="critique",e.personalizedAutocorrection="personalized-autocorrection"}(r||(r={}))},46746:(e,t,n)=>{"use strict";n.d(t,{C:()=>r,Q:()=>o});var i=n(63837);const r=(0,i.f)("ISquigglerCanvasRenderingState"),o=(0,i.f)("ISquigglerCanvasRenderingStateFactory")},96120:(e,t,n)=>{"use strict";function i(e){return null===e?null:e.scrollHeight>e.clientHeight?e:i(e.parentNode)}function r(){return/Macintosh|Mac OS X/i.test(navigator.userAgent)}n.d(t,{i:()=>r,m:()=>i})},10383:(e,t,n)=>{"use strict";n.d(t,{dB:()=>l,Cf:()=>s,uE:()=>u});var i=n(3755);const r=[];let o;const a=e=>{o||(o=(()=>{const e=window.document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.top="-9999px",e.style.overflow="scroll",e.style.position="absolute",window.document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return window.document.body.removeChild(e),t})());const t=r.find((e=>{var t;return!!(null===(t=e.search)||void 0===t?void 0:t.test(window.location.href))}));if(!(null==t?void 0:t.getWidth)){const t=!e.isInput&&"hidden"!==e.computedOverflow&&e.anchor.scrollHeight-e.anchor.clientHeight&&"content-box"!==e.boxSizing&&!navigator.platform.startsWith("mac"),n=Number.parseFloat(e.computedWidth);return t?n-o:e.computedWidth}return t.getWidth(e)},s=e=>{const t={},n=window.getComputedStyle(e),r=(0,i.C)(e,"HTMLInputElement");if(t.whiteSpace="pre-wrap",t.wordWrap="break-word",["position","direction","boxSizing","writingMode","width","height","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize","display","visibility"].forEach((e=>{t[e]=n[e]})),t.paddingBottom="0px"===t.paddingBottom?0:t.paddingBottom,r){const i=n.boxSizing&&"content-box"!==n.boxSizing?parseFloat(n.height)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderTopWidth)-parseFloat(n.borderBottomWidth):n.height;t.lineHeight=Number.isNaN(Number(i))?i:`${i}px`,t.whiteSpace="pre",t.overflow="hidden",t.height=parseFloat(t.height)+3,"search"===e.getAttribute("type")&&(t.direction&&"ltr"!==t.direction?t.paddingLeft=`${parseFloat(n.paddingLeft||0)+15}px`:t.paddingRight=`${parseFloat(n.paddingRight||0)+15}px`)}const o={anchor:e,computedWidth:t.width,computedOverflow:n.overflowY||"",boxSizing:n.boxSizing,isInput:r};let s="auto";if(n.zIndex&&"auto"!==n.zIndex){const e=parseInt(n.zIndex,10);s=isNaN(e)?0:e+1}return{overlay:Object.assign(Object.assign({},t),{left:0,top:0,position:"absolute",pointerEvents:"none",resize:"unset",backgroundColor:"transparent",borderColor:"transparent",WebkitTextFillColor:"none",color:"transparent",willChange:"contents",outline:"none",zIndex:s,lineHeight:Number.isNaN(t.lineHeight)?"unset":t.lineHeight,height:Number.isNaN(t.height)?"unset":t.height,width:Number.isNaN(t.width)?"unset":a(o)}),anchor:t}},l=(e,t,n)=>{var i;if(!t)return{top:0,left:0};const r=null!==(i=n.current)&&void 0!==i?i:{top:0,left:0},o=e.getBoundingClientRect(),a=t.getBoundingClientRect(),s=o.top-a.top,l=o.left-a.left;return{top:Math.abs(s)>0?r.top+s:r.top,left:Math.abs(l)>0?r.left+l:r.left,position:"relative",height:"0px"}},u=(e,t)=>({width:"100%",overflow:"hidden",height:e.scrollHeight-e.clientHeight==0?`calc(100% + ${null!=t?t:"2px"})`:"calc(100% + 2px)"})},66279:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var i=n(54218),r=n(97428);class o{constructor(){this.imports=[]}get uniqueId(){return(0,r.z)(507918369)}configureRootServices(e){e.bind(i.Th).toDynamicValue((()=>()=>e.getOptional(i.JY)))}}},13304:(e,t,n)=>{"use strict";n.d(t,{r:()=>R});var i=n(11394),r=n(30206),o=n(13494),a=n(20399),s=n(10059),l=n(86278),u=n(79993),d=n(66526),c=n(48828),h=n(30122),g=n(30225),p=n(90424);let f=class{constructor(e,t,n,i){this._hostEmitters=e,this._critiqueStore=t,this._proofingDom=n,this._logger=i,this.initialize=async()=>{for(const e of this._hostEmitters)e.on(o.pD.hostModelCritiqueAction,this.onHostModelCritiqueActionEvent)},this.shutDown=()=>{},this.onHostModelCritiqueActionEvent=e=>{if(!e.message.critiqueInfo.nodeId)return void this._logger.log(523871251,a.q.Error,`IHostModelCritiqueAction message: Received undefined args. ActionType:${e.message.actionType}`);let t=this._proofingDom.findTileNode(e.message.critiqueInfo.nodeId);if(!t){const n=this._proofingDom.findParagraphNode(e.message.critiqueInfo.nodeId);if(!(null==n?void 0:n.parent))return void this._logger.log(523896789,a.q.Error,"CritiqueActionEventHandler: Received event args with unknown node id.");t=n.parent}if(this._critiqueStore)switch(e.message.actionType){case s.$w.IgnoreOnce:case s.$w.ApplySuggestion:this._critiqueStore.removeCritique(e.message.critiqueInfo.traceId,e.message.critiqueInfo.nodeId);break;case s.$w.DisableCritiqueType:break;case s.$w.IgnoreAll:if(!e.message.critiqueInfo.typeId){this._logger.log(507574115,a.q.Error,"critique is missing typeId");break}if(!e.message.critiqueInfo.textInContext){this._logger.log(507574098,a.q.Error,"critique is missing textInContext");break}this._critiqueStore.removeAllCritiquesOfTypeAndText(e.message.critiqueInfo.typeId,e.message.critiqueInfo.textInContext);break;default:this._logger.log(523896792,a.q.Error,"CritiqueActionEventHandler: Received unexpected actionType.")}else this._logger.log(523896791,a.q.Error,"CritiqueActionEventHandler: No critique store is available.")}}};f=(0,r.__decorate)([(0,c._)(),(0,r.__param)(0,(0,h.t)(o.zJ)),(0,r.__param)(1,(0,g.l)()),(0,r.__param)(1,(0,p.W)(u.$)),(0,r.__param)(2,(0,p.W)(d.w)),(0,r.__param)(3,(0,p.W)(l.g))],f);var m=n(45118);let v=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map}handleApplyCritiqueSuggestion(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyCritiqueSuggestion(e,t,n,i){const r=this._applyHandlerMap.get(t.typeId);return!!r&&r(e,t,n,i)}handleIgnoreCritiqueSuggestion(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreCritiqueSuggestion(e,t){const n=this._ignoreHandlerMap.get(t.typeId);return!!n&&n(e,t)}};v=(0,r.__decorate)([(0,c._)()],v);var y=n(71905),_=n(23751),b=n(85996),C=n(21206),T=n(47954),S=n(99828),I=n(53920),w=n(98287),E=n(44680),x=n(97436);let A=class{constructor(e,t,n,i,r,o){this._logger=e,this._proofingDom=t,this._proofingPersistedStore=n,this._nodePoller=i,this._hostEmitter=r,this._hostSettings=o,this.getLocalesForSameLanguage=async e=>{var t,n,i,r;const o=[],a=await this._proofingPersistedStore.read(T.l.ProofingLanguages),s=e.suggestions.length&&(null===(t=e.suggestions[0].languages)||void 0===t?void 0:t.length)?e.suggestions[0].languages[0]:null!==(r=null!==(n=a[0])&&void 0!==n?n:null===(i=this._hostSettings.proofingLocales)||void 0===i?void 0:i[0])&&void 0!==r?r:this._hostSettings.defaultLocale;if(s){const e=s.split("-")[0];for(const t of a)e===t.split("-")[0]&&o.push(t)}else this._logger.error(557953868,"Expected language in ISuggestion or the list of Proofing Languages");return o}}async disableCritique(e){if(void 0===e.typeId)return;const t=await this._proofingPersistedStore.read(T.l.OverriddenCritiqueTypeOptions);let n=!1;for(const i of t)i.id===e.typeId&&(i.value="0",n=!0);if(!n){const n=await this.getLocalesForSameLanguage(e);for(const i of n)t.push({id:e.typeId,languageId:i,name:"",value:"0"})}await this._proofingPersistedStore.write(T.l.OverriddenCritiqueTypeOptions,t),this._hostEmitter.emit(o.pD.critiqueSettingsChange,{address:void 0,message:t}),this._nodePoller.pollNodes(S.G.ChangeData,this._proofingDom.tileNodes,I.Q0.Code),this._onDisableCritique&&this._onDisableCritique(e.typeId)}setOnDisableCritique(e){this._onDisableCritique=e}};A=(0,r.__decorate)([(0,c._)(),(0,r.__param)(0,(0,p.W)(l.g)),(0,r.__param)(1,(0,p.W)(d.w)),(0,r.__param)(2,(0,p.W)(w.K)),(0,r.__param)(3,(0,p.W)(x.G)),(0,r.__param)(4,(0,p.W)(o.M5)),(0,r.__param)(5,(0,p.W)(E.n))],A);var D=n(79788),N=n(97428),F=n(29714),P=n(71115),k=n(59886),O=n(46746);let B=class{constructor(e,t){this.proofingEventListener=e,this.container=t,this.messages=[],this.uxInitialized=!1,this.onCritiqueForUiEvent=e=>{this.uxInitialized?this.container.get(O.C).onCritiqueForUiEvent(e):this.messages.push(e)},this.onSquiggleUXReadyEvent=async e=>{const t=this.container.get(O.C);let n;for(;n=this.messages.shift();)await t.onCritiqueForUiEvent(n);this.uxInitialized=!0},this.onRecomputeSquigglesEvent=async e=>{this.uxInitialized&&this.container.get(O.C).updateSquiggleRanges()}}async initialize(){this.proofingEventListener.on("squiggleUXReadyEvent",this.onSquiggleUXReadyEvent),this.proofingEventListener.on("recomputeSquiggles",this.onRecomputeSquigglesEvent),this.proofingEventListener.on("squiggleDataEvent",this.onCritiqueForUiEvent)}shutDown(){}};B=(0,r.__decorate)([(0,c._)(),(0,r.__param)(0,(0,p.W)(k.o)),(0,r.__param)(1,(0,p.W)(P.p))],B);class R{constructor(){this.imports=[i.v]}get uniqueId(){return(0,N.z)(507918354)}configureRootServices(e){e.bind(b.g).toDynamicValue((e=>()=>e.getOptional(b.M))),e.bind(F.S).to(f),e.bind(m.a).to(v),e.bind(C.W).to(A),e.bind(D.i).to(_.n),e.bind(y.s).to(y.$),e.bind(F.S).to(B)}}},61137:(e,t,n)=>{"use strict";n.d(t,{N:()=>M});var i=n(66279),r=n(41887),o=n(30206),a=n(13494),s=n(99828),l=n(44680),u=n(9654),d=n(48828),c=n(30122),h=n(90424),g=n(22322);let p=class{constructor(e,t,n,i){this._hostEmitters=e,this._hostSettings=t,this._oaResultsStore=n,this._queryDetection=i,this.onOARankedAnnotationsEvent=e=>{const t=e.message.data,n=Object.assign(Object.assign({},t),{eventType:e.message.messageType,isLoading:!1});this.onEvent(n)},this.oaAnnotationsTriggeredEvent=e=>{this._oaResultsStore.updateLoadingStatus(!0)}}async initialize(){var e;if(this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled))for(const e of this._hostEmitters)e.on(a.pD.oaAnnotationsTriggered,this.oaAnnotationsTriggeredEvent),e.on(a.pD.oaRankedAnnotations,this.onOARankedAnnotationsEvent)}shutDown(){}onEvent(e){const{results:t,tileId:n,latency:i,resultStatus:r,queryCorrelationKeys:o,resultSummary:a}=e;switch(e.eventType){case s.G.NewData:case s.G.ChangeData:this._oaResultsStore.updateResults(t,n,r,o?Object.assign(Object.assign({},o),{scopeInfo:this._queryDetection.getCurrentScope()}):void 0,i,a);break;case s.G.RemoveData:this._oaResultsStore.clearResults()}}};p=(0,o.__decorate)([(0,d._)(),(0,o.__param)(0,(0,c.t)(a.zJ)),(0,o.__param)(1,(0,h.W)(l.n)),(0,o.__param)(2,(0,h.W)(g.C)),(0,o.__param)(3,(0,h.W)(u.J))],p);var f=n(21648),m=n(66526);let v=class{constructor(e,t){this._inlineSuggestionsRenderer=e,this._proofingDom=t}filter(e){const t=this._inlineSuggestionsRenderer.getCurrentMenuInfo();if(!t||"InlineSuggestionsResultsUserInitiatedMenuType"!==t.menuType.menuType)return!0;if(e.nodeId===t.tileId){const n=this._proofingDom.findParagraphNode(t.tileId);if((null==n?void 0:n.element)&&"offset"in n.element)return!this.intersects(e.start,e.start+e.length,n.element.offset+t.queryRange.start,n.element.offset+t.queryRange.start+t.queryRange.length)}return!0}intersects(e,t,n,i){return e<=i&&n<=t}};v=(0,o.__decorate)([(0,d._)(),(0,o.__param)(0,(0,h.W)(f.V)),(0,o.__param)(1,(0,h.W)(m.w))],v);var y=n(3755),_=n(86310),b=n(95885),C=n(36271),T=n(61758),S=n(30225);let I=class{constructor(e,t,n,i){this._hostSettings=e,this._oaLogger=t,this._tileContent=n,this._shadowElementsStore=i}async getTargetLocationOfECC(e,t){var n,i,r,o,a,s,l;if((null===(n=t.menuCurrentlyOpen)||void 0===n?void 0:n.enableExpandedECCSearchBar)&&(this._hostSettings.flightsToTrack||[]).includes("mc-editor-attachbutton-searchbar-position")&&t.triggerMethod===f.P.AttachFile){const t=null===(i=(0,b.q)(this._tileContent,e))||void 0===i?void 0:i.parentNode,n=null!==t?t.getBoundingClientRect():void 0;if(n)return{x:n.left,y:n.top}}if(!t.menuCurrentlyOpen)return null;const{targetOffset:u,queryRange:d}=t.menuCurrentlyOpen,c=e.element.offset+d.start;let h=this._tileContent.getContainingElement(e);if((0,y.C)(h,"HTMLInputElement")||(0,y.C)(h,"HTMLTextAreaElement")){const t=null===(r=this._shadowElementsStore)||void 0===r?void 0:r.getShadowElementStore(e.parent.id);t?(await t.updateOverlay(),h=t.container):this._oaLogger.logDiagnostics("Attempted to render ECC on an input/textarea, but no shadow element store was available, so the ECC will most likely be placed in the wrong place.")}const g=await this._tileContent.getRangeOfNode(e.parent,h,c,null!==(a=null===(o=d.prefix)||void 0===o?void 0:o.length)&&void 0!==a?a:1);if(!h)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element could not be determined"),null;if(!h.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element was disconnected"),null;if(!g)return this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid range for the menu character could be found"),null;if(!g.startContainer.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range was returned containing a detached HTML node"),null;if((null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.atMentionClassName)&&this.hasSomeParentWithAnyClass(g.startContainer,[this._hostSettings.oaSettings.atMentionClassName]))return null;if((null===(l=this._hostSettings.oaSettings)||void 0===l?void 0:l.disabledClassNames)&&this.hasSomeParentWithAnyClass(g.startContainer,this._hostSettings.oaSettings.disabledClassNames))return null;let p=g.getBoundingClientRect();if(0===p.top&&0===p.bottom&&0===p.left&&0===p.right&&0===p.height&&0===p.width){if(g.startContainer!==g.endContainer||!g.startContainer.parentElement)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;if(p=g.startContainer.parentElement.getBoundingClientRect(),0===p.top&&0===p.bottom&&0===p.left&&0===p.right&&0===p.height&&0===p.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found"),null}const m=u?new DOMRect(p.left-u.x,p.top-u.y,p.width+2*u.x,p.height+2*u.y):p;return function(e,t,n){const i=t.commonAncestorContainer.ownerDocument,r=null==i?void 0:i.defaultView;if(!r)return!1;const o={x:e.left+e.width/2,y:e.top+e.height/2};let a=i.elementFromPoint(o.x,o.y),s=!1;do{if(a===n){s=!0;break}a=null==a?void 0:a.parentNode}while(a);return!!s&&(o.x<0||o.y<0||o.x>(r.innerWidth||i.documentElement.clientWidth)||o.y>(r.innerHeight||i.documentElement.clientHeight))}(m,g,h)?null:m}hasSomeParentWithAnyClass(e,t){return!!t.find((t=>{var n;return null===(n=e.className)||void 0===n?void 0:n.split(" ").includes(t)}))||!!e.parentElement&&this.hasSomeParentWithAnyClass(e.parentElement,t)}};I=(0,o.__decorate)([(0,d._)(),(0,o.__param)(0,(0,h.W)(l.n)),(0,o.__param)(1,(0,h.W)(_.m)),(0,o.__param)(2,(0,h.W)(C.d)),(0,o.__param)(3,(0,S.l)()),(0,o.__param)(3,(0,h.W)(T.S))],I);var w=n(92052),E=n(97428),x=n(29714),A=n(23300),D=n(99119),N=n(16081),F=n(41533),P=n(42608),k=n(74847);let O=class{constructor(e,t,n){this._hostSettings=e,this._oaLogger=t,this.targetDocumentFactory=n}async getTargetLocationOfECC(e,t){var n,i,r,o,a,s,l,u,d,c,h;const g=null===(i=null===(n=this.targetDocumentFactory)||void 0===n?void 0:n.call(this))||void 0===i?void 0:i.deref(),p=null==g?void 0:g.getElementById(null!==(a=null===(o=null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.enableECCForMobileDevice)||void 0===o?void 0:o.inputBoxId)&&void 0!==a?a:"m365chat-input-formTextBox"),f=null==p?void 0:p.getBoundingClientRect();if(!p||!f||0===f.top&&0===f.bottom&&0===f.left&&0===f.right&&0===f.height&&0===f.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;const m=null!==(u=null===(l=null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.enableECCForMobileDevice)||void 0===l?void 0:l.mainAxisOverride)&&void 0!==u?u:0,v=null!==(h=null===(c=null===(d=this._hostSettings.oaSettings)||void 0===d?void 0:d.enableECCForMobileDevice)||void 0===c?void 0:c.crossAxisOverride)&&void 0!==h?h:0,y=new DOMRect(f.left-v,f.top-m,f.width,f.height);return function(e,t,n){const i=null==t?void 0:t.defaultView;if(!i)return!1;const r={x:e.left+e.width/2,y:e.top+e.height/2};let o=t.elementFromPoint(r.x,r.y),a=!1;do{if(o===n){a=!0;break}o=null==o?void 0:o.parentNode}while(o);return!!a&&(r.x<0||r.y<0||r.x>(i.innerWidth||t.documentElement.clientWidth)||r.y>(i.innerHeight||t.documentElement.clientHeight))}(y,g,p)?null:y}};O=(0,o.__decorate)([(0,d._)(),(0,o.__param)(0,(0,h.W)(l.n)),(0,o.__param)(1,(0,h.W)(_.m)),(0,o.__param)(2,(0,S.l)()),(0,o.__param)(2,(0,h.W)(k.Ze))],O);var B=n(10056);let R=class{getPluginCalloutMaxHeight(e,t,n){var i;const r=null!==(i=e.y)&&void 0!==i?i:e.top;if(r)return Math.max(t.innerHeight-r,r)-20}getCalloutDirection(e,t,n,i){return e?B.A.topRightEdge:B.A.topLeftEdge}};R=(0,o.__decorate)([(0,d._)()],R);let L=class{constructor(e){this.hostSettings=e,this._profilePicturesUrlsCache={},this.fetchProfilePicture=async e=>{if(!e)return;if(this._profilePicturesUrlsCache[e])return this._profilePicturesUrlsCache[e];const t=await this.getProfilePictureUrl(e);return this._profilePicturesUrlsCache[e]=t,t},this.fetchCachedProfilePicture=e=>{if(e)return this._profilePicturesUrlsCache[e]},this.getDefaultProfilePictureUrl=e=>`https://microsoft.sharepoint-df.com/_layouts/15/UserPhoto.aspx?size=m&accountName=${e}&default=none`}async getProfilePictureUrl(e){var t;return(null==e?void 0:e.includes("@"))?(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.getProfilePictureUrl)?await this.hostSettings.oaSettings.getProfilePictureUrl(e):this.getDefaultProfilePictureUrl(e):""}};L=(0,o.__decorate)([(0,d._)(),(0,o.__param)(0,(0,h.W)(l.n))],L);class M{constructor(){this.imports=[r.d,i.w]}get uniqueId(){return(0,E.z)(507918360)}configureRootServices(e){var t,n;e.bind(x.S).to(p),e.bind(g.C).to(g.L),e.bind(N.A).to(L),e.bind(f.V).to(F.W),e.bind(x.S).toExisting(f.V),e.bind(P.Z).toSelf(),(null===(n=null===(t=e.get(l.n).oaSettings)||void 0===t?void 0:t.enableECCForMobileDevice)||void 0===n?void 0:n.enabled)?(e.bind(A.j).to(O),e.bind(D.e).to(R)):e.bind(A.j).to(I),e.bind(w.D).to(v)}}},91864:(e,t,n)=>{"use strict";n.d(t,{D:()=>i});const i=(0,n(63837).f)("IPresentationDomSettings")},15885:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=(0,n(63837).f)("GetIsHighContrastTheme")},49691:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o,m:()=>r});const i=[".ms-ecc-callout",".ms-critique-callout","editor-card","ms-cc-overflow",".ms-cc-overflow"];function r(e,t){return!!(e&&"closest"in e&&e.closest((null!=t?t:i).join(", ")))}function o(e){return!!(e&&"isConnected"in e&&!e.isConnected&&"closest"in e&&e.closest('[role="menuitem"]'))}},70496:(e,t,n)=>{"use strict";function i(e){if(!e)return[];const t=[];for(const n of e.stores){const e=n.getCritiques();e.sort(((e,t)=>e.start-t.start));for(const i of e){const e={critique:i,store:n};t.push(e)}}return t}n.d(t,{v:()=>i})},71905:(e,t,n)=>{"use strict";n.d(t,{$:()=>m,s:()=>f});var i=n(30206),r=n(31409),o=n(34756),a=n(85999),s=n(47408),l=n(36271),u=n(66526),d=n(6638),c=n(63837),h=n(48828),g=n(90424),p=n(30225);const f=(0,c.f)("ICritiqueRangeBuilder");let m=class{constructor(e,t,n){this._tileContent=e,this._proofingDom=t,this._tileNodeTraverser=n,this.getCritiqueRangeAcrossTileNodes=e=>{const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!t)return Promise.resolve(void 0);let n;return n=e.endNode?this.getParagraphNodeAndOffset(e.endNode.nodeId,e.endNode.end):this.getParagraphNodeAndOffset(e.nodeId,e.length),n?this.getRangeAcrossTileNodes(t.paragraphNode,n.paragraphNode,t.offset,n.offset):Promise.resolve(void 0)},this.getParagraphNodeAndOffset=(e,t)=>{const n=this._proofingDom.findParagraphNode(e);if(n)return{paragraphNode:n,offset:t};const i=this._proofingDom.findTileNode(e);if(!(null==i?void 0:i.children))return;let o;for(const e of i.children)(0,r.l)(e)&&t>=e.element.offset&&t<e.element.offset+e.element.span&&(o=e);return o?{paragraphNode:o,offset:t-o.element.offset}:void 0},this.getRangeAcrossTileNodes=async(e,t,n=0,i=-1)=>{let o=null;o="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let a=null;if(a="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,r.l)(o)&&(0,r.l)(a)){const e=await this._tileContent.getNodeInsertionPosition(o.parent,o.element.offset+n,!0),t=await this._tileContent.getNodeInsertionPosition(a.parent,a.element.offset+(-1===i?a.element.span:i),!1);if(!(null==e?void 0:e.startContainer.ownerDocument)||!(null==t?void 0:t.endContainer.ownerDocument)||e.startContainer.ownerDocument!==t.endContainer.ownerDocument)return;const r=e.startContainer.ownerDocument.createRange();return r.setStart(e.startContainer,e.startOffset),r.setEnd(t.endContainer,t.endOffset),r}},this.ensureNoLeadingOrTrailingWhitespace=e=>{if(e.endNode)return e;const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!(null==t?void 0:t.paragraphNode.element)||!e.nodeId)return e;const n=t.offset-t.paragraphNode.element.offset,i=this._paragraphTextExtractor.getTextBetween(e.nodeId,e.nodeId,n,n+e.length);if(!i)return e;let r=e.start,o=e.length;const a=i.trimStart(),s=i.trimEnd();return i.length!==a.length&&(r+=i.length-a.length,o-=i.length-a.length),i.length!==s.length&&(o-=i.length-s.length),Object.assign(Object.assign({},e),{start:r,length:o})},this._paragraphTextExtractor=new o.o(this._proofingDom,this._tileNodeTraverser)}async getCritiqueRanges(e,t){var n,i,r;const o=new Map;for(const t of e){const e=t.nodeId?this._proofingDom.findNode(t.nodeId):t.tileId?this._proofingDom.findNode(t.tileId.nodeId):null,r=(null==e?void 0:e.nodeType)===a.Z.ParagraphNode?e.parent:(null==e?void 0:e.nodeType)===a.Z.TileNode?e:void 0;if((0,s.$)(r)){const e=null!==(i=null===(n=o.get(r.id))||void 0===n?void 0:n[0])&&void 0!==i?i:[];e.push(t),o.set(r.id,[e,r])}}const l=new Map;for(const[e,n]of o.values()){const i=[],o=[];for(const t of e)if(t.endNode){const e=this._proofingDom.findParagraphNode(t.endNode.nodeId);(null===(r=null==e?void 0:e.parent)||void 0===r?void 0:r.id)!==n.id?o.push(t):i.push(t)}else i.push(t);if(i.length>0){const e=await this._tileContent.getCritiqueRanges(n,t,i.map(this.ensureNoLeadingOrTrailingWhitespace));for(const t of e)l.set(i.find((e=>e.traceId===t.critique.traceId)),t.range)}if(o.length>0)for(const e of o)l.set(e,await this.getCritiqueRangeAcrossTileNodes(this.ensureNoLeadingOrTrailingWhitespace(e)))}return e.map((e=>({critique:e,range:l.get(e)})))}};m=(0,i.__decorate)([(0,h._)(),(0,i.__param)(0,(0,g.W)(l.d)),(0,i.__param)(1,(0,g.W)(u.w)),(0,i.__param)(2,(0,g.W)(d.M)),(0,i.__param)(2,(0,p.l)())],m)},45118:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i=(0,n(63837).f)("IApplyCritiqueSuggestionHandler")},44332:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});const i=(0,n(63837).f)("IApplyFlagHandler")},12376:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});const i=(0,n(63837).f)("IAutoCorrectionBroker")},79993:(e,t,n)=>{"use strict";n.d(t,{$:()=>o,K:()=>i});var i,r=n(63837);!function(e){e[e.Add=0]="Add",e[e.Move=1]="Move",e[e.Update=2]="Update",e[e.Delete=4]="Delete"}(i||(i={}));const o=(0,r.f)("ICritiqueStore")},41887:(e,t,n)=>{"use strict";n.d(t,{d:()=>y});var i=n(97428),r=n(86310),o=n(30206),a=n(9654),s=n(48828),l=n(90424),u=n(59834),d=n(86278),c=n(17288);let h=class{constructor(e,t){this._queryDetection=e,this._logger=t,this._diagosticEventName="OAPanelDiagnostics",this.logDiagnostics=(e,t,n,i)=>{this.logInternal(this._diagosticEventName,e,t,n,i)},this.logActivity=(e,t,n,i)=>{this.logInternal(e,void 0,t,n,i)},this.logInternal=(e,t,n,i,r)=>{var o,a;const s=this._logger.getNewActivity(e,u.o.SamplingPolicy.CriticalExperimentation);null==s||s.dataFields.push(...(0,c.W)(["conversationId",null!==(o=null==r?void 0:r.conversationId)&&void 0!==o?o:this._queryDetection.getCurrentQueryConversationId()||""],["logicalId",null!==(a=null==r?void 0:r.logicalId)&&void 0!==a?a:this._queryDetection.getCurrentQueryLogicalId()||""])),t&&(null==s||s.dataFields.push((0,c.n)("message",t))),n&&(null==s||s.dataFields.push((0,c.n)("data",JSON.stringify(n)))),i&&(null==s||s.dataFields.push(...i)),s&&(s.success=!0,s.endNow())}}};h=(0,o.__decorate)([(0,s._)(),(0,o.__param)(0,(0,l.W)(a.J)),(0,o.__param)(1,(0,l.W)(d.g))],h);var g=n(17677),p=n(44680),f=n(31685),m=n(84916);let v=class{constructor(e,t,n){this._logger=e,this._hostSettings=t,this._eventName="OASuggestionLoadTime",this._dataEventName="Data",this._performanceApiGarbageCollectorIntervalInMs=12e4,this._logToTelemetry=(e,t,n,i)=>{var r,o,a,s,l;const d=this._logger.getNewActivity(i||this._eventName,u.o.SamplingPolicy.CriticalExperimentation);if(d){for(const t of e)d.dataFields.push((0,c.n)(t.name,t.duration,void 0,u.o.DataFieldType.Double.valueOf()));d.dataFields.push(...(0,c.W)(["conversationId",null!==(r=null==t?void 0:t.conversationId)&&void 0!==r?r:""],["logicalId",null!==(o=null==t?void 0:t.logicalId)&&void 0!==o?o:""],["triggeringChar",null!==(a=null==t?void 0:t.triggerCharacter)&&void 0!==a?a:"@"],[this._dataEventName,JSON.stringify(Object.assign({isEmptyQuery:null===(s=null==t?void 0:t.isEmptyQuery)||void 0===s||s,dataSource:void 0,isAL:!0,workflow:"oa",logicalId:null==t?void 0:t.logicalId},n))],["queryLength",null!==(l=null==t?void 0:t.queryLength)&&void 0!==l?l:0])),d.success=!0,d.endNow()}},this.metric=new m.J(e,n,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry),this.setOnTimeout(((e="",t)=>{t&&this.commitEntry(e,"Timeout")}))}log(e,t,n,i){this._logger.log(e,t,n,i)}info(e,t,n){this._logger.info(e,t,n)}warn(e,t,n){this._logger.warn(e,t,n)}error(e,t,n){this._logger.error(e,t,n)}debug(e,t,n){this._logger.debug(e,t,n)}logEvent(e,t,n,i,r,o,a){this._logger.logEvent(e,t,n,i,r,o,a)}getNewActivity(e,t,n){return this._logger.getNewActivity(e,t,n)}addCorrelationID(e){this._logger.addCorrelationID(e)}async initialize(e,t,n,i,r){return this._logger.initialize(e,t,n,i,r)}logDiagnostics(e,t,n,i){this._logger.logDiagnostics(e,t,n,i)}logActivity(e,t,n,i){this._logger.logActivity(e,t,n,i)}config({transports:e,activityTransport:t}){return this._logger.config({transports:e,activityTransport:t}),this._logger}startEntry(e,t,n){var i;(null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.e2eMetric)&&this.metric.startEntry(e,t,n)}setOnTimeout(e){var t;(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.e2eMetric)&&this.metric.setOnTimeout(e)}addMeasure(e,t,n){var i;(null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.e2eMetric)&&this.metric.addMeasure(e,t,n)}commitEntry(e,t,n){var i;(null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.e2eMetric)&&this.metric.commitEntry(e,t,n)}};v=(0,o.__decorate)([(0,s._)(),(0,o.__param)(0,(0,l.W)(d.g)),(0,o.__param)(1,(0,l.W)(p.n)),(0,o.__param)(2,(0,l.W)(f.j))],v);class y{get uniqueId(){return(0,i.z)(507918355)}configureRootServices(e){e.bind(r.m).to(h),e.bind(g.u).to(v)}}},11394:(e,t,n)=>{"use strict";n.d(t,{v:()=>He});var i=n(30206),r=n(10059),o=n(48828),a=n(90424),s=n(6754);let l=class{constructor(e){this._wordDictionary=e}filter(e){return!!e.textInContext&&(e.typeId===r.L9.CIQFlag_DateEntityRecognition||e.typeId===r.L9.CIQFlag_PersonEntityRecognition||e.typeId===r.L9.CIQFlag_Location||e.typeId===r.L9.CIQFlag_Time||e.typeId===r.L9.CIQFlag_LocalBusiness||e.typeId===r.L9.CIQFlag_TaskRecognition||e.typeId===r.L9.CIQFlag_Topic||e.typeId===r.L9.CIQFlag_SatoriEntityRecognition||e.typeId===r.L9.CIQFlag_File||!this._wordDictionary.isWordIgnored(e.textInContext)&&!e.wasAddedToDictionaryInCurrentSession)}};l=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(s.s))],l);var u=n(44680),d=n(8903),c=n(30122),h=n(30225),g=n(63837);const p=(0,g.f)("ISelectedCritiqueCategory");let f=class{constructor(e){this._selectedCritiqueCategory=e}filter(e){return!!e&&(!this._selectedCritiqueCategory.isAnyCategorySelected()||void 0!==e.categoryTitle&&this._selectedCritiqueCategory.isCritiqueCategorySelected(e.categoryTitle))}};f=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(p))],f);var m=n(92052);(0,g.f)("StealthSquiggleEnabledCritiqueTypesArray");const v=(0,g.f)("IStealthSquiggleEnabledCritiqueTypes");var y=n(11387),_=n(80728),b=n(51218);let C=class{constructor(e,t,n){this._enabledCritiqueTypes=e,this._upsellStore=t,this._hostSettings=n}filter(e){var t,n;let i=!0;if(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser){const t=null!==(n=e.typeId)&&void 0!==n?n:"";this._enabledCritiqueTypes.isCritiqueTypePremium(t)&&(this._hostSettings.enableOrchestration&&this._upsellStore.addPremiumCritique((0,y.OE)(e)),i=this._upsellStore.previewPremiumSquiggles)}return i}};C=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(_.g)),(0,i.__param)(1,(0,h.l)()),(0,i.__param)(1,(0,a.W)(b.Ey)),(0,i.__param)(2,(0,a.W)(u.n))],C);const T=(0,g.f)("ISpellingSettingsStore");let S=class{constructor(e){this._spellingSettingsStore=e}filter(e){var t;if(!e)return!1;if(e.priority!==r.bx.High||!this._spellingSettingsStore.isSpellingDisabledForAnyLanguage())return!0;const n=[];for(const i of e.suggestions){const e=null!==(t=i.languages)&&void 0!==t?t:[];i.languages=e.filter((e=>this._spellingSettingsStore.isSpellingEnabledForLanguage(e))),i.languages.length&&n.push(i)}return e.suggestions=n,!!n.length}};S=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(T))],S);let I=class{constructor(e,t,n,i,r,o,a,s){this._dictionaryCritiqueFilter=e,this._basicCritiqueFilters=t,this._hostSettings=n,this._featureFlagsReader=i,this._premiumCritiqueFilter=r,this._spellingCritiqueFilter=o,this._categoryCritiqueFilter=a,this._stealthSquiggleEnabledCritiqueTypes=s,this._critiqueFilters=[]}async initialize(){this._critiqueFilters.push(this._dictionaryCritiqueFilter),!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableCritiqueSettings&&this._spellingCritiqueFilter&&this._critiqueFilters.push(this._spellingCritiqueFilter),this._critiqueFilters.push(...this._basicCritiqueFilters),this._hostSettings.enhancedUpsellEnabled&&this._premiumCritiqueFilter&&this._critiqueFilters.push(this._premiumCritiqueFilter),this._categoryCritiqueFilter&&this._critiqueFilters.push(this._categoryCritiqueFilter)}shutDown(){this._critiqueFilters.splice(0,this._critiqueFilters.length)}applyFilters(e){return e?e.filter((e=>{var t,n,i;const r=e.isVisible,o=e.isStealth;let a=!0;const s=null!==(i=null===(t=this._stealthSquiggleEnabledCritiqueTypes)||void 0===t?void 0:t.isCritiqueTypeEnabled(null!==(n=e.typeId)&&void 0!==n?n:"",e.priority))&&void 0!==i&&i;for(const t of this._critiqueFilters)if(a=t.filter(e),!a)break;return e.isVisible=a,e.isStealth=s,e.isVisible!==r||e.isStealth!==o})):[]}};I=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(l)),(0,i.__param)(1,(0,c.t)(m.D)),(0,i.__param)(1,(0,h.l)()),(0,i.__param)(2,(0,a.W)(u.n)),(0,i.__param)(3,(0,a.W)(d.c)),(0,i.__param)(4,(0,h.l)()),(0,i.__param)(4,(0,a.W)(C)),(0,i.__param)(5,(0,h.l)()),(0,i.__param)(5,(0,a.W)(S)),(0,i.__param)(6,(0,h.l)()),(0,i.__param)(6,(0,a.W)(f)),(0,i.__param)(7,(0,h.l)()),(0,i.__param)(7,(0,a.W)(v))],I);var w=n(28121),E=n(20399),x=n(59834),A=n(99828),D=n(53920),N=n(59886),F=n(98287),P=n(36230),k=n(86278),O=n(29320),B=n(97436),R=n(66526),L=n(47954),M=n(17288);const q=(e,t,n,i)=>{if(!e||!t)return;const r=e.getNewActivity(w.M.WebSiteProvedOnce,x.o.SamplingPolicy.CriticalBusinessImpact),o=t.getCachedEntry(L.l.ProofingLanguages).storeEntryValue;let a;i.execute(!1,(e=>(a=null==e?void 0:e.regionScope,e))),r&&(r.dataFields.push(...(0,M.W)(["Proofing_Languages",o.join(",")],["Region_Scope",null!=a?a:"unknown"],["IsAL",!0===n.enableOrchestration&&n.orchestratorSettings&&!0===n.orchestratorSettings.enableAugLoop||!1])),r.success=!0,r.endNow())};let U=class{constructor(e,t,n,i,r,o,a,s){this._proofingDom=e,this._proofingEmitter=t,this._nodePoller=n,this._proofingPersistedStore=i,this._hostSettings=r,this._userInfoStrategy=o,this._logger=a,this._e2eMetric=s,this._websiteProvedOnce=!1,this.onCritiqueEvent=e=>{try{this._detectWebSiteProved(e),this.updateCritiques(e)}catch(e){this._logger.logEvent(536978384,w.s.UpdateCritiqueException,E.q.Error,"Error while updating critiques on the shadow graph.",x.o.SamplingPolicy.CriticalBusinessImpact,e)}},this.updateCritiques=e=>{const t=e.data,n=new Map,i=[],r=new Set;for(const e of t){if(!e.tileId)continue;const t=e.tileId.elementId.id;r.has(t)||(this._e2eMetric.commitEntry(t),r.add(t));const o=n.get(e.tileId.nodeId);if(o)o.push(e);else{n.set(e.tileId.nodeId,[e]);const t=this._proofingDom.findTileNode(e.tileId.nodeId);t&&i.push(t)}}i.length&&this._nodePoller.pollNodes(A.G.NewData,i,D.Q0.Code,void 0,!1,n)}}async initialize(){this._proofingEmitter.on("critiqueEvent",this.onCritiqueEvent)}shutDown(){}_detectWebSiteProved(e){!this._websiteProvedOnce&&e.messageType===A.G.NewData&&e.data&&e.data.length&&(this._websiteProvedOnce=!0,q(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}};U=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(R.w)),(0,i.__param)(1,(0,a.W)(N.o)),(0,i.__param)(2,(0,a.W)(B.G)),(0,i.__param)(3,(0,a.W)(F.K)),(0,i.__param)(4,(0,a.W)(u.n)),(0,i.__param)(5,(0,a.W)(P.e)),(0,i.__param)(6,(0,a.W)(k.g)),(0,i.__param)(7,(0,a.W)(O.m))],U);var W=n(91822);let j=class{constructor(e,t,n,i,r){this._proofingStore=e,this._emitter=t,this.nodePoller=n,this.proofingDom=i,this._logger=r,this._proofingLanguages=new W.I(this._proofingStore.getDefaultValue(L.l.ProofingLanguages))}async initialize(){this._proofingLanguages=new W.I(await this._proofingStore.read(L.l.ProofingLanguages)),this._emitter.on("proofingLanguageChanged",(async e=>{this.switchProofingLanguage(e.data)}))}shutDown(){}switchProofingLanguage(e){this._proofingLanguages.equalsTo(e.codesList)||(this._proofingLanguages=e,this._logger.debug(536978383,`Proofing languages list switched to ${e.codesList}`),this.proofingDom.tileNodes.map((e=>e.resetState())),this.nodePoller.pollNodes(A.G.NewData,this.proofingDom.tileNodes,D.Q0.Code,void 0,!0))}};j=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(F.K)),(0,i.__param)(1,(0,a.W)(N.o)),(0,i.__param)(2,(0,a.W)(B.G)),(0,i.__param)(3,(0,a.W)(R.w)),(0,i.__param)(4,(0,a.W)(k.g))],j);var z=n(13494);const H="19a112ec-21fd-432a-9d1f-195e5e94a00b";let V=class{constructor(e,t,n){this._hostEmitter=e,this._logger=t,this._proofingPersistedStore=n,this._hasSpellingBeenDisabled=!1,this._spellingSettings=new Set,this._readSpellingSettings=async e=>{const t=new Set;for(const n of e)n.id===H&&"0"===n.value&&(n.languageId?t.add(n.languageId):this._logger.error(545067014,"Undefined languageId in Spelling overriddenCritiqueTypeOption"));this._spellingSettings=t},this._updateSpellingSettings=async e=>{const t=e.message;await this._readSpellingSettings(t)}}async initialize(){const e=await this._proofingPersistedStore.read(L.l.OverriddenCritiqueTypeOptions);await this._readSpellingSettings(e),this._hostEmitter.on(z.pD.critiqueSettingsChange,this._updateSpellingSettings)}shutDown(){}isSpellingDisabledForAnyLanguage(){const e=this._spellingSettings.size>0;return e&&(this._hasSpellingBeenDisabled=!0),this._hasSpellingBeenDisabled||e}isSpellingEnabledForLanguage(e){return!this._spellingSettings.has(e)}};V=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(z.M5)),(0,i.__param)(1,(0,a.W)(k.g)),(0,i.__param)(2,(0,a.W)(F.K))],V);var G=n(72783);function Q(e,t,n,i){var o,a,s;e.set(r.L9.ContextualSpelling,1),e.set(r.L9.WrongSpelling,1),(null===(o=null==i?void 0:i.taskRecognition)||void 0===o?void 0:o.enabled)&&e.set(r.L9.CIQFlag_TaskRecognition,1),(null===(a=null==i?void 0:i.headingDetection)||void 0===a?void 0:a.enabled)&&e.set(r.L9.HeadingDetection,1),(null===(s=null==i?void 0:i.flagAnnotationSettings)||void 0===s?void 0:s.enabled)&&(e.set(r.L9.CIQFlag_Location,1),e.set(r.L9.CIQFlag_File,1),e.set(r.L9.CIQFlag_Time,1),e.set(r.L9.CIQFlag_LocalBusiness,1),e.set(r.L9.CIQFlag_Topic,1),e.set(r.L9.CIQFlag_SatoriEntityRecognition,1),e.set(r.L9.CIQFlag_DateEntityRecognition,1),e.set(r.L9.CIQFlag_PersonEntityRecognition,1));for(const i of t){const t=i.toLowerCase();"mc-officeeditortonalenabled"===t&&n===G.G_.Subscription?e.set(r.L9.TonalRewrite,1):"csi-editor-topicsuggestions"===t&&e.set(r.L9.TopicSuggestion,1)}}let K=class{constructor(e,t,n){var i;this._proofingPersistedStore=e,this._hostSettings=t,this._hostEmitter=n,this._availableCritiqueTypes=new Map,this._overriddenCritiqueTypes=new Map,this._premiumCritiqueTypes=new Map,this._ciqFlagsEnabled=!0,this.critiqueSettingsChange=e=>{this.setOverriddenCritiqueTypes(e.message)},this.ciqSettingsChange=e=>{this._ciqFlagsEnabled=e.message.ciqFlagsEnabled};const r=this._proofingPersistedStore.getCachedEntry(L.l.OverriddenCritiqueTypeOptions);Q(this._availableCritiqueTypes,null!==(i=this._hostSettings.flightsToTrack)&&void 0!==i?i:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this.setOverriddenCritiqueTypes(r.storeEntryValue),r.isSynced||this.readOverriddenCritiqueTypesFromStorage()}async initialize(){this._hostEmitter.on(z.pD.critiqueSettingsChange,this.critiqueSettingsChange),this._hostEmitter.on(z.pD.ciqSettingsChange,this.ciqSettingsChange)}shutDown(){}async readOverriddenCritiqueTypesFromStorage(){const e=await this._proofingPersistedStore.read(L.l.OverriddenCritiqueTypeOptions);this.setOverriddenCritiqueTypes(e)}isCritiqueTypeEnabled(e,t){if((0,r.oe)(e)&&!this._ciqFlagsEnabled)return!1;const n=this._availableCritiqueTypes.get(e);let i=this._overriddenCritiqueTypes.get(e);if(this._critiqueToCategoryIdMap){const n=t===r.bx.High?H:this._critiqueToCategoryIdMap.get(e);n&&0===this._overriddenCritiqueTypes.get(n)&&(i=0)}return void 0===i?1===n:1===i}isCritiqueTypePremium(e){return e===r.L9.TonalRewrite||(this._hostSettings.enableOrchestration?1===this._premiumCritiqueTypes.get(e):1!==this._availableCritiqueTypes.get(e))}setOverriddenCritiqueTypes(e){if(e){this._overriddenCritiqueTypes.clear();for(const t of e)this._overriddenCritiqueTypes.set(t.id,parseInt(t.value,10))}}setAvailableCritiqueTypes(e,t){var n;if(e){this._availableCritiqueTypes.clear(),Q(this._availableCritiqueTypes,null!==(n=this._hostSettings.flightsToTrack)&&void 0!==n?n:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this._critiqueToCategoryIdMap=t;for(const t of e)this._availableCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}setPremiumCritiqueTypes(e){if(e){this._premiumCritiqueTypes.clear();for(const t of e)this._premiumCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}};K=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(F.K)),(0,i.__param)(1,(0,a.W)(u.n)),(0,i.__param)(2,(0,a.W)(z.M5))],K);var $=n(25195);const Z=(0,g.f)("IEnabledPremiumCritiqueTypes");var J=n(97428),Y=n(29714);class X{constructor(){this.imports=[]}get uniqueId(){return(0,J.z)(507360220)}configureRootServices(e){e.bind(_.g).to(K),e.bind(Y.S).toExisting(_.g),e.bind($.D).toExisting(_.g),e.bind(Z).toExisting(_.g)}}const ee=(0,g.f)("ICritiqueFilterer");var te;!function(e){e.IgnoreListUpdate="IgnoreListUpdate",e.CustomDictionaryUpdate="CustomDictionaryUpdate"}(te||(te={}));var ne=n(40617),ie=n(11117);let re=class{constructor(e,t,n,i,r,o){this._proofingDom=e,this._proofingEmitter=t,this.hostSettings=i,this._roamingDictionaryFeature=r,this._roamingDictionaryBroker=o,this._ignoredWords=new Set,this.isWordIgnored=e=>{var t;const n=e.trim();return!!this._ignoredWords.has(n)||!!(null===(t=this._roamingDictionaryFeature.getRoamingDictionary())||void 0===t?void 0:t.testWord(n,!0))},this.clearIgnoredWords=()=>{var e;this._ignoredWords.clear(),null===(e=this._nodePoller)||void 0===e||e.pollNodes(A.G.ChangeData,this._proofingDom.tileNodes,D.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:A.G.RemoveData,data:te.IgnoreListUpdate})},this.addWordToIgnoreList=(e,t=!1)=>{this.addWordsToIgnoreList([e],t)},this.addWordsToIgnoreList=(e,t=!1)=>{var n;let i=!1;for(let t=0;t<e.length;t++){const n=e[t];if(n){const e=n.trim();if(this._ignoredWords.has(e))continue;this._ignoredWords.add(e),i=!0}}i&&!t&&(null===(n=this._nodePoller)||void 0===n||n.pollNodes(A.G.ChangeData,this._proofingDom.tileNodes,D.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:A.G.NewData,data:te.IgnoreListUpdate}))},this.addWordToCustomDictionary=e=>{var t,n;if(e){if(this.hostSettings.enableV2RoamingDictionary&&(null===(t=this._roamingDictionaryBroker)||void 0===t?void 0:t.isRoamingDictionaryReady))return this._roamingDictionaryBroker.addWordToRoamingDictionary(e),!0;{const t=e.trim();if(this.roamingDictionary&&this._roamingDictionaryFeature.isReady())return!!this.roamingDictionary.addWord(t)&&(null===(n=this._nodePoller)||void 0===n||n.pollNodes(A.G.ChangeData,this._proofingDom.tileNodes,D.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:A.G.NewData,data:te.CustomDictionaryUpdate}),!0)}}return!1},this._nodePoller=i.enableOrchestration?void 0:n}get roamingDictionary(){if(this.hostSettings.enableRoamingDictionary)return this._roamingDictionaryFeature.getRoamingDictionary()}async initialize(){this.hostSettings.enableRoamingDictionary&&this._roamingDictionaryFeature.emitAndEvaluate({eventId:ne.U1.ClientInitialized,sender:ne.FS.WordDictionaryInit})}shutDown(){}get roamingDictionaryEnabled(){var e;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!this._roamingDictionaryFeature.isReady()}};re=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(R.w)),(0,i.__param)(1,(0,a.W)(N.o)),(0,i.__param)(2,(0,a.W)(B.G)),(0,i.__param)(3,(0,a.W)(u.n)),(0,i.__param)(4,(0,a.W)(ne.Zp)),(0,i.__param)(5,(0,h.l)()),(0,i.__param)(5,(0,a.W)(ie.C))],re);class oe{constructor(){this.imports=[X]}get uniqueId(){return(0,J.z)(507908323)}configureRootServices(e){e.bind(ee).to(I),e.bind(Y.S).toExisting(ee),e.bind(l).toSelf(),e.bind(Y.S).to(U),e.bind(Y.S).to(j),e.bind(Y.S).toExisting(s.s),e.bind(s.s).to(re)}}var ae=n(2612),se=n(35744),le=n(43880);let ue=class{constructor(e,t,n,i,r,o){this._enabledCritiqueTypes=e,this._paneEnabledCritiqueTypes=t,this._paneOpenState=n,this._proofingPersistedStore=i,this._upsellStore=r,this._indicatorStore=o}filter(e){return this.addCritiqueToIndicatorMapIfNeeded(e),void 0!==e.typeId&&this.isCritiqueCategoryEnabled(e.priority)&&this.isCritiqueTypeEnabled(e.typeId,e.priority)||e.typeId===r.L9.TopicSuggestion}isCritiqueCategoryEnabled(e){var t;return e===r.bx.High&&!!this._proofingPersistedStore.getCachedEntry(L.l.EnableSpelling).storeEntryValue||e===r.bx.Medium&&!!this._proofingPersistedStore.getCachedEntry(L.l.EnableGrammar).storeEntryValue||e===r.bx.Low&&((null===(t=this._upsellStore)||void 0===t?void 0:t.previewPremiumSquiggles)||!!this._proofingPersistedStore.getCachedEntry(L.l.EnableRefinements).storeEntryValue)||e===r.bx.Informational}isCritiqueTypeEnabled(e,t){var n,i;const r=void 0!==this._paneOpenState,o=r&&(null===(n=this._paneOpenState)||void 0===n?void 0:n.isPaneOpen)&&(null===(i=this._paneEnabledCritiqueTypes)||void 0===i?void 0:i.isCritiqueTypeEnabled(e,t));return this._enabledCritiqueTypes.isCritiqueTypeEnabled(e,t)||o||!!this._upsellStore&&(!r||this._upsellStore.previewPremiumSquiggles)&&this._enabledCritiqueTypes.isCritiqueTypePremium(e)}addCritiqueToIndicatorMapIfNeeded(e){var t,n;if(!(e.typeId&&e.traceId&&this._paneEnabledCritiqueTypes&&this._indicatorStore))return;const i=e.priority===r.bx.Low,o=this.isCritiqueCategoryEnabled(e.priority)||(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser)&&i,a=this._paneEnabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority),s=this._enabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority);let l=!0;e.typeId!==r.L9.TopicSuggestion&&e.typeId!==r.L9.CIQFlag_Topic||(l=e.isVisible),o&&(a||s)&&l&&this._indicatorStore.addPaneCritique(e.traceId,i,e.categoryTitle,a&&!s&&!(null===(n=this._paneOpenState)||void 0===n?void 0:n.isPaneOpen))}};ue=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(_.g)),(0,i.__param)(1,(0,h.l)()),(0,i.__param)(1,(0,a.W)(le.M)),(0,i.__param)(2,(0,h.l)()),(0,i.__param)(2,(0,a.W)(ae.F)),(0,i.__param)(3,(0,a.W)(F.K)),(0,i.__param)(4,(0,h.l)()),(0,i.__param)(4,(0,a.W)(b.Ey)),(0,i.__param)(5,(0,h.l)()),(0,i.__param)(5,(0,a.W)(se.y))],ue);const de=String.fromCharCode(65532);let ce=class{constructor(){}filter(e){var t;return!(null===(t=e.textInContext)||void 0===t?void 0:t.includes(de))}};ce=(0,i.__decorate)([(0,o._)()],ce);var he=n(79993),ge=n(19432),pe=n(67127);function fe(e){return e.typeId===r.L9.TopicSuggestion?function(e){let t=0;try{e.suggestions.forEach((e=>{const n=JSON.parse(e.metadataJSON||"{}");t=Math.max(n.annotationScore,t)}))}catch(e){}return t}(e):e.typeId===r.L9.CIQFlag_Topic?function(e){var t;let n=0;return null===(t=e.suggestionItems)||void 0===t||t.forEach((e=>{e.entities.forEach((e=>{n=Math.max(e.confidence,n)}))})),n}(e):0}const me=[r.L9.TopicSuggestion,r.L9.CIQFlag_Topic];class ve extends ge.z{constructor(e,t,n){super(),this._settings=e,this._logger=t,this._fre=n,this._critiquesByNode=new Map,this._latestNodeVersion=new Map,this._wordBoundaries=new Map,this.removeCritique=(e,t,n)=>{const i=null==n?void 0:n(t);if(!i)return"removeCritique - Unable to find tileNode";const r=this._critiquesByNode.get(i),o=r?this.findCritiqueInCritiques(r,e):void 0;if(!r||!o)return"removeCritique - Unable to find critique on tile";this.removeKnownCritique(o,r,o),this.dispatchCritiquesForNode(i,"Update")},this.getCritique=(e,t,n)=>{var i;const r=null==n?void 0:n(t);if(!r)return void(null===(i=this._logger)||void 0===i||i.error(507900049,"getCritique - Unable to find tileNode"));const o=this._critiquesByNode.get(r);return o?this.findCritiqueInCritiques(o,e):void 0},this.dispatchCritiquesForNode=(e,t)=>{const n=this._critiquesByNode.get(e),i=n?this.getCritiquesToDispatch(n):[];this.publishEvent("dispatchCritiques",{critiques:i,nodeId:e,messageType:A.G.NewData,reason:t})},this.removeAllCritiquesOfType=e=>{for(const t of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeFromNode(t,e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{for(const n of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeAndTextFromNode(n,e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{const n=this.getCritiques(e);if(!n)return;const i=[];for(const e of n.critiques.values())e.typeId===t&&i.push(e);if(i.length>0){for(const e of i)this.removeSpecifiedCritique(e,n.critiques);this.dispatchCritiquesForNode(n.tileId,"Clear")}},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,n)=>{const i=this.getCritiques(e);if(!i)return;const r=[];for(const e of i.critiques.values())e.typeId===t&&e.textInContext===n&&r.push(e);if(r.length>0){for(const e of r)this.removeSpecifiedCritique(e,i.critiques);this.dispatchCritiquesForNode(i.tileId,"Clear")}},this.removeSpecifiedCritique=(e,t)=>{for(const n of t.values())if(n.traceId===e.traceId)return this.removeKnownCritique(e,t,n),!0;return!1},this.removeKnownCritique=(e,t,n)=>{(function(e){return"isFlagCritique"in e})(e)&&e.isIgnored||t.delete(n),this.publishEvent("removeCritiques",{critiques:new Set([n])})},this.getOverlappingCritiques=(e,t)=>{var n;const i=[];let o=1/0,a=!1,s=!1;for(const l of e)l.traceId!==t.traceId&&(0,pe.tw)(l,t)&&(o=Math.min(o,l.priority),a=a||l.typeId===r.L9.TopicSuggestion,s=s||null!==(n=l.isIgnored)&&void 0!==n&&n,i.push(l));return{shouldOverrideCritiques:!s&&(t.typeId===r.L9.TopicSuggestion||!a&&o>=t.priority),critiques:i}},this.getCritiquesToDispatch=e=>{var t;const n=Array.from(e.values()).filter((e=>e.isVisible&&!e.isIgnored));return null===(t=this._fre)||void 0===t||t.setFor(n),n},this.findCritiqueInCritiques=(e,t)=>{for(const n of e.values())if(n.traceId===t)return n}}clearNode(e){let t=!1;const n=this._critiquesByNode.get(e);n&&(this._critiquesByNode.delete(e),this._wordBoundaries.delete(e),this.publishEvent("removeCritiques",{critiques:n}),this._latestNodeVersion.has(e)&&this._latestNodeVersion.delete(e),t=!0),t&&this.publishEvent("dispatchCritiques",{critiques:[],nodeId:e,messageType:A.G.RemoveData,reason:"Clear"})}resetNode(e){this.clearNode(e),this.updateNode([],e,0)}getAllCritiques(){const e=[];for(const t of this._critiquesByNode.keys()){const n=this.getCritiques(t);n&&e.push(n)}return e}getCritiques(e){var t;const n=this._critiquesByNode.get(e);if(n)return{critiques:n,tileId:e,tileVersion:null!==(t=this._latestNodeVersion.get(e))&&void 0!==t?t:0}}setWordBoundaries(e,t,n,i){var r,o;let a=this._wordBoundaries.get(e);a||(a=new Map,this._wordBoundaries.set(e,a));const s=null!==(o=null===(r=a.get(t.id))||void 0===r?void 0:r.length)&&void 0!==o?o:0,l=t.range.span-s;if(a.set(t.id,{offset:t.range.offset,length:i&&s?s:t.range.span,boundaries:n}),!i)for(const e of a.values())e.offset>t.range.offset&&(e.offset+=l)}removeWordBoundariesByPosition(e,t,n){const i=this._wordBoundaries.get(e);if(!i)return;const r=t+n-1;for(const[e,o]of i)if(o.offset<t){const e=o.offset+o.length-1;e>t&&(o.length-=e-t)}else o.offset>=t&&o.offset+o.length-1<=r?i.delete(e):o.offset>=t&&o.offset<=r?(o.length-=t+n-o.offset,o.offset=t):o.offset-=n}updateNode(e,t,n,i=!1){var r,o;n>=(null!==(r=this._latestNodeVersion.get(t))&&void 0!==r?r:0)&&this._latestNodeVersion.set(t,n);const a=this._critiquesByNode.get(t),s=this._wordBoundaries.get(t);if(a){if(i||(null!==(o=this._settings.enableDispatchCritiquesOnEmptyDiffs)&&void 0!==o?o:e.length>0)){for(const t of e){const e=this.getOverlappingCritiques(a,t.critique);switch(t.critiqueDiffType){case he.K.Add:case he.K.Update:if(e.critiques.length){if(e.shouldOverrideCritiques){for(const t of e.critiques)this.removeSpecifiedCritique(t,a);this.isNotPartialCritique(t.critique,s)&&a.add(t.critique)}}else this.isNotPartialCritique(t.critique,s)&&a.add(t.critique);break;case he.K.Delete:this.removeSpecifiedCritique(t.critique,a);case he.K.Move:}}const n=[];if(n.push(t),function(e){return e.some((e=>e.critiqueDiffType!==he.K.Move&&me.includes(e.critique.typeId)))}(e)){const e=function(e,t){const n=[];return n.concat(function(e,t){const n=[];for(const t of e.values())for(const e of t)me.includes(e.typeId)&&n.push(e);return function(e,t,n,i){var r;const o=[];let a=0;const s=new Set;for(const{critique:t}of e){let e=!1;const n=(null===(r=t.textInContext)||void 0===r?void 0:r.toLowerCase())||"";e=s.has(n),a<3&&!e?t.isVisible&&(i&&t.isStealth&&(t.isStealth=!1,o.push(t)),s.add(n),a++):e&&t.isVisible?(t.isVisible=!1,o.push(t)):t.isVisible&&(i&&!t.isStealth?(t.isStealth=!0,o.push(t)):i||(t.isVisible=!1,o.push(t)),s.add(n))}return o}(function(e){const t=[];return e.forEach((e=>{t.push({confidenceScore:fe(e),critique:e})})),t.sort(((e,t)=>t.confidenceScore-e.confidenceScore)),t}(n),0,0,t)}(e,t)),n}(this._critiquesByNode,!!this._settings.enableStealthSquiggles);for(const t of e)t.nodeId&&n.push(t.nodeId)}for(const e of n)this.dispatchCritiquesForNode(e,"Update")}}else this._critiquesByNode.set(t,new Set)}isNotPartialCritique(e,t){if(!0===this._settings.disableWordBoundaries||!t||0===t.size)return!0;for(const n of t.values())if(e.start>=n.offset&&e.start<n.offset+n.length){const t=n.offset;for(const i of n.boundaries){const n=i.start+t,r=i.end+t+1,o=r-n;if(e.start>=n&&e.start+e.length<=r&&e.length<o)return!1}return!0}return!0}setAugLoopProcessingHandler(e){}}const ye=(0,g.f)("ICritiquesFre");var _e=n(85999),be=n(90725);let Ce=class{constructor(e,t,n,i,r,o,a,s,l){this._hostSettings=e,this._upsellStore=t,this._proofingEmitter=n,this._hostEmitter=i,this._proofingDom=r,this._logger=o,this._indicatorStore=a,this._fre=s,this._sessionTelemetryTracker=l,this.removeCritique=(e,t)=>{const n=this._critiqueStoreCore.removeCritique(e,t,this.nodeIdFinder);return n&&this._logger.error(505816774,n),n},this.getCritique=(e,t)=>this._critiqueStoreCore.getCritique(e,t,this.nodeIdFinder),this.nodeIdFinder=e=>{var t;if(!e)return;const n=this._proofingDom.findNode(e);return(null==n?void 0:n.nodeType)===_e.Z.TileNode?n.id:(null==n?void 0:n.nodeType)===_e.Z.ParagraphNode?null===(t=n.parent)||void 0===t?void 0:t.id:void 0},this.removeAllCritiquesOfType=e=>{this._critiqueStoreCore.removeAllCritiquesOfType(e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndText(e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeFromNode(e,t)},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,n)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndTextFromNode(e,t,n)},this.onDispatchCritiques=({critiques:e,nodeId:t,messageType:n,reason:i})=>{var r;const o=this._proofingDom.findTileNode(t);if(o){if("VisualStateChange"===i&&0===e.length)return;this._proofingEmitter.emit("squiggleDataEvent",{messageType:n,data:{critiquesToElementsMap:[{elementId:t,element:o.element,critiques:e.map(y.OE)}],isVisualStateChange:"VisualStateChange"===i}}),null===(r=this._sessionTelemetryTracker)||void 0===r||r.update(e,t)}},this.onRemoveCritiques=e=>{var t,n;for(const i of e.critiques.values())null===(t=this._upsellStore)||void 0===t||t.removePremiumCritique(i),null===(n=this._indicatorStore)||void 0===n||n.removePaneCritique(i.traceId,i.categoryTitle)},this._critiqueStoreCore=new ve(this._hostSettings,this._logger,this._fre),this._critiqueStoreCore.subscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.subscribe("removeCritiques",this.onRemoveCritiques)}get core(){return this._critiqueStoreCore}async initialize(){this._proofingEmitter.on("proofingLanguageChanged",(e=>{if(e.proofingLanguagesChanged&&!this.augLoopProcessingHandler)for(const e of this._proofingDom.tileNodes)this.resetNode(e.id)})),this._hostEmitter.on(z.pD.hostModelTileStateReset,(e=>{this.augLoopProcessingHandler||this.resetNode(e.message)})),this._hostEmitter.on(z.pD.hostModelVisualStateChange,(e=>{e.message.created&&!this.augLoopProcessingHandler&&this._critiqueStoreCore.dispatchCritiquesForNode(e.message.tileId,"VisualStateChange")}))}shutDown(){this._proofingEmitter.off("proofingLanguageChanged"),this._hostEmitter.off(z.pD.hostModelTileStateReset),this._hostEmitter.off(z.pD.hostModelVisualStateChange),this._critiqueStoreCore.unsubscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.unsubscribe("removeCritiques",this.onRemoveCritiques)}clearNode(e){this.augLoopProcessingHandler?this.augLoopProcessingHandler.clearNode(e):this._critiqueStoreCore.clearNode(e)}resetNode(e){this.augLoopProcessingHandler||this._critiqueStoreCore.resetNode(e)}getAllCritiques(){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getAllCritiques():this._critiqueStoreCore.getAllCritiques()}getCritiques(e){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getCritiques(e):this._critiqueStoreCore.getCritiques(e)}updateNode(e,t,n,i=!1){this.augLoopProcessingHandler?this.augLoopProcessingHandler.updateNode(e,t,n,i):this._critiqueStoreCore.updateNode(e,t,n,i)}setAugLoopProcessingHandler(e){this.augLoopProcessingHandler=e}};Ce=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(u.n)),(0,i.__param)(1,(0,h.l)()),(0,i.__param)(1,(0,a.W)(b.Ey)),(0,i.__param)(2,(0,a.W)(N.o)),(0,i.__param)(3,(0,a.W)(z.M5)),(0,i.__param)(4,(0,a.W)(R.w)),(0,i.__param)(5,(0,a.W)(k.g)),(0,i.__param)(6,(0,h.l)()),(0,i.__param)(6,(0,a.W)(se.y)),(0,i.__param)(7,(0,h.l)()),(0,i.__param)(7,(0,a.W)(ye)),(0,i.__param)(8,(0,h.l)()),(0,i.__param)(8,(0,a.W)(be.H))],Ce);var Te=n(31409),Se=n(86539),Ie=n(95988),we=n(60040),Ee=n(94077);class xe{constructor(e){this.paragraphNode=e}get id(){return this.paragraphNode.id}get range(){var e,t,n,i,r,o,a;return{offset:null!==(t=null===(e=this.paragraphNode.element)||void 0===e?void 0:e.offset)&&void 0!==t?t:0,span:null!==(i=null===(n=this.paragraphNode.element)||void 0===n?void 0:n.span)&&void 0!==i?i:0,textUnit:null===(r=this.paragraphNode.element)||void 0===r?void 0:r.textUnit,validEndBoundary:null===(o=this.paragraphNode.element)||void 0===o?void 0:o.validEndBoundary,enforcedCompleteTileTextUnit:null===(a=this.paragraphNode.element)||void 0===a?void 0:a.enforcedCompleteTileTextUnit}}}class Ae{constructor(e={enablePhraseTextUnitClientSide:!0,ignoreNonLatinZeroSquiggles:!0,enableSquigglesOnlyOnWholeWords:!0}){this.settings=e}isValid(e,t,n,i,o){var a,s,l,u;if(!e.nodeId||!t)return!1;const d=new Ee.a;if(this.settings.enablePhraseTextUnitClientSide&&e.priority!==r.bx.High&&!(0,r.oe)(e.typeId)&&t.range.textUnit!==Ie.fT.Sentence&&t.range.textUnit!==Ie.fT.Paragraph)return!1;if(this.settings.ignoreNonLatinZeroSquiggles&&(!e.suggestions.length||0===e.suggestions[0].action)&&((c=e.textInContext)&&/[^\u0000-\u007f]/.test(c)))return!1;var c;null==o||o(e);let h=e.textInContext;h&&(h=h.replace(/\u00A0/g," "));const g=t.range.offset,p=i(e);if(h!==p)return!1;if((e.priority===r.bx.High||e.priority===r.bx.Informational)&&(void 0===e.endNode||e.endNode.nodeId===t.id)&&this.settings.enableSquigglesOnlyOnWholeWords){const t=n;if(!t)return!1;const i=e.start-g,r=i+e.length,o=r===t.length;let[c,h]=function(e,t,n,i,r){if(!e)return["",0];let o=0;return(t===i||t+1===i&&we.Yv(e.charCodeAt(t+1)))&&(o+=1),n===r&&(o+=1),[e.substring(t,n),o]}(t,null!==(s=null===(a=d.getBackwardBreak(t,i+1))||void 0===a?void 0:a.cp)&&void 0!==s?s:0,null!==(u=null===(l=d.getForwardBreak(t,r-1))||void 0===l?void 0:l.cp)&&void 0!==u?u:r,i,r);return p&&!o&&"ï¿¼"===p[p.length-1]&&(h+=1),we._1(c)?!0:!!we.tF(c)||2===h}return!0}}var De=n(12376);function Ne(e,t){var n;const i=e?t.findParagraphNode(e):null;return{paragraphNode:i,htmlElement:null===(n=null==i?void 0:i.parent)||void 0===n?void 0:n.element}}let Fe=class{constructor(e,t,n,i,r,o,a,s,l,u,d){this._critiqueStore=e,this._critiqueFilterer=t,this._logger=n,this._hostSettings=i,this._proofingPersistedStore=r,this._userInfoStrategy=o,this._e2eMetric=a,this._featureFlagReader=s,this._proofingDom=l,this._paragraphTextExtractor=u,this._autoCorrectionBroker=d,this._websiteProvedOnce=!1}onEvent(e){var t,n;const{added:i,removedIds:r,source:o,tileId:a,tileVersion:s}=e,{paragraphNode:l}=Ne(a,this._proofingDom),u=null!==(n=null===(t=null==l?void 0:l.parent)||void 0===t?void 0:t.id)&&void 0!==n?n:a,d=this.onCommonCritiquesRemoved(r,o),c=i.filter((e=>{const t=d.findIndex((t=>(0,pe.gS)(e,t.critique)));return!(t>=0&&(d.splice(t,1),1))}));d.push(...this.onCommonCritiquesAdded(c,a)),d.length>0&&this._critiqueStore.updateNode(d,u,s),this._e2eMetric.commitEntry(`${a}--${s}`)}logWebsiteProvedOnce(){this._websiteProvedOnce||(this._websiteProvedOnce=!0,q(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}onCommonCritiquesAdded(e,t){var n,i;if(0===e.length)return[];const{paragraphNode:r}=Ne(t,this._proofingDom),o=null!==(i=null===(n=null==r?void 0:r.parent)||void 0===n?void 0:n.id)&&void 0!==i?i:t,a=new Ae({enablePhraseTextUnitClientSide:this._featureFlagReader.flags.enablePhraseTextUnitClientSide,ignoreNonLatinZeroSquiggles:!!this._hostSettings.ignoreNonLatinZeroSquiggles,enableSquigglesOnlyOnWholeWords:this._featureFlagReader.flags.enableSquigglesOnlyOnWholeWords}),s=this._paragraphTextExtractor.getParagraphText(r),l=function(e,t,n,i,r,o,a,s,l,u,d){if(0===e.length)return[];const c=a.getCritiques(n);if(!c)return[];const h=new Map,g=new Set;for(const e of c.critiques)l(e)&&h.set(e.start,e);const p=[];for(const n of e)if(n&&d.isValid(n,t,i,r,s)){const e=h.get(n.start);if(e&&(0,pe.gS)(e,n)){e.annotationId=n.annotationId,p.push({critique:e,critiqueDiffType:he.K.Update}),g.add(n.start);continue}if(!o)for(const e of h.values())(0,pe.tw)(e,n)&&p.push({critique:e,critiqueDiffType:he.K.Delete});u.applyFilters([n]),p.push({critique:n,critiqueDiffType:he.K.Add})}if(o)for(const e of h.values())g.has(e.start)||p.push({critique:e,critiqueDiffType:he.K.Delete});return p}(e,null===r?null:new xe(r),o,s,(e=>{var t,n;const i=null!==(n=null===(t=null==r?void 0:r.element)||void 0===t?void 0:t.offset)&&void 0!==n?n:0;let o="";return o=void 0===e.endNode?this._paragraphTextExtractor.getTextBetween(r,r,e.start-i,e.start-i+e.length):this._paragraphTextExtractor.getTextBetween(r,e.endNode.nodeId,e.start-i,e.endNode.end),o}),this._featureFlagReader.flags.enableForceClearCritiques,this._critiqueStore,(e=>{(0,Te.l)(r)&&(e.start=e.start+r.element.offset)}),(e=>((e,t)=>!!(0,Te.l)(t)&&e.nodeId!==t.id&&!(e.start>=t.element.offset+t.element.span||t.element.offset>=e.start+e.length))(e,r)),this._critiqueFilterer,a);return l.length>0&&this.logWebsiteProvedOnce(),l}onCommonCritiquesRemoved(e,t){return function(e,t,n,i){if(0===e.length)return[];const r=n.getAllCritiques().reduce(((e,t)=>{for(const n of t.critiques)e.set(n.annotationId,{critique:n,tileId:t.tileId,tileVersion:t.tileVersion});return e}),new Map),o=[];for(const n of e){const e=r.get(n);if(e){if("Augloop"===t&&(null==i?void 0:i.getHasAutoCorrectionBeenApplied(e.critique)))continue;o.push({critique:e.critique,critiqueDiffType:he.K.Delete})}}return o}(e,t,this._critiqueStore,this._autoCorrectionBroker)}};Fe=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(he.$)),(0,i.__param)(1,(0,a.W)(ee)),(0,i.__param)(2,(0,a.W)(k.g)),(0,i.__param)(3,(0,a.W)(u.n)),(0,i.__param)(4,(0,a.W)(F.K)),(0,i.__param)(5,(0,a.W)(P.e)),(0,i.__param)(6,(0,a.W)(O.m)),(0,i.__param)(7,(0,a.W)(d.c)),(0,i.__param)(8,(0,a.W)(R.w)),(0,i.__param)(9,(0,a.W)(Se.b)),(0,i.__param)(10,(0,h.l)()),(0,i.__param)(10,(0,a.W)(De.m))],Fe);var Pe=n(3327);let ke=class{constructor(e,t,n){this._critiqueStore=e,this._critiqueFilterer=t,this._indicatorStore=n}onEvent(e){var t;const n=this._critiqueStore.getAllCritiques();null===(t=this._indicatorStore)||void 0===t||t.clearPaneCritiques();for(const e of n){const t=this._critiqueFilterer.applyFilters(Array.from(e.critiques.values())).map((e=>({critique:e,critiqueDiffType:he.K.Update})));t.length>0&&this._critiqueStore.updateNode(t,e.tileId,e.tileVersion)}}};function Oe(e,t){return t>=e.tileVersion}ke=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(he.$)),(0,i.__param)(1,(0,a.W)(ee)),(0,i.__param)(2,(0,h.l)()),(0,i.__param)(2,(0,a.W)(se.y))],ke);let Be=class{constructor(e){this._critiqueStore=e}onEvent(e){const t=this._critiqueStore.getCritiques(e.tileId);t&&Oe(t,e.tileVersion)&&this._critiqueStore.updateNode([],e.tileId,e.tileVersion,!0)}};Be=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(he.$))],Be);let Re=class{constructor(e){this._critiqueStore=e}onEvent(e){switch(e.eventType){case A.G.NewData:this._critiqueStore.updateNode([],e.tileId,e.tileVersion);break;case A.G.RemoveData:this._critiqueStore.clearNode(e.tileId)}}};Re=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(he.$))],Re);var Le=n(96950),Me=n(26042);let qe=class{constructor(e,t,n,i,o){this._critiqueStore=e,this._featureFlagsReader=t,this._logger=n,this._wordDictionary=i,this._autoCorrectionBroker=o,this.calcLengths=e=>function(e,t,n,i=!1){var r;let o=null!=t?t:0,a=0;switch(n){case A.G.NewData:a=null!==(r=null==e?void 0:e.length)&&void 0!==r?r:o,i||(o=a);break;case A.G.RemoveData:a=-o;break;case A.G.ChangeData:a=e?e.length-o:a}return{length:o,lengthDiff:a}}(e.content,e.length,e.eventType,this._featureFlagsReader.flags.disableCalcLengthForAddDeltasInPresentation),this.deletedDiff=(e,t,n,i,o,a,s=!1)=>function(e,t,n,i,o,a,s=!1,l,u,d=!0){if(!t&&0===i&&!o)return;const c={offset:e.start,span:e.length},h={offset:n,span:i},g=(!Ue(t,d)||n===e.start)&&(n!==e.start+e.length||a!==A.G.RemoveData||void 0===o||!Ue(o,d))&&(s||n+i===e.start||n===e.start+e.length)&&function(e){return!(0,r.oe)(e.typeId)||e.typeId===r.L9.CIQFlag_DateEntityRecognition||e.typeId===r.L9.CIQFlag_PersonEntityRecognition||e.typeId===r.L9.HeadingDetection||e.typeId===r.L9.CIQFlag_TaskRecognition}(e);if(f=h,!(!(p=c)||!f||p.offset>=f.offset+f.span||f.offset>=p.offset+p.span)||g&&function(e,t){return!(!e||!t||e.offset!==t.offset+t.span&&t.offset!==e.offset+e.span)}(c,h)){if((0,Le.A_)(e)){if(null==u?void 0:u.getAutoCorrectionIsBeingApplied(e))return;(0,Me.yf)(e,l)}return{critique:e,critiqueDiffType:he.K.Delete}}var p,f}(e,t,n,i,o,a,s,this._wordDictionary,this._autoCorrectionBroker)}onEvent(e){var t,n;const i=this._critiqueStore.getCritiques(e.tileId);if(!i||!Oe(i,e.tileVersion))return;const{length:r,lengthDiff:o}=this.calcLengths(e),a=null!==(t=e.position)&&void 0!==t?t:0,s=[];for(const t of i.critiques){const i=this.deletedDiff(t,null!==(n=e.content)&&void 0!==n?n:"",a,r,e.deletedOrReplacedCharacters,e.eventType,e.eventType!==A.G.ChangeData);if(i)s.push(i);else if(t.start>=a&&0!==o){const e=t.start;t.start+=o,s.push({critique:t,critiqueDiffType:he.K.Move,oldStart:e})}}this._critiqueStore.updateNode(s,e.tileId,e.tileVersion)}};function Ue(e,t){return 1===e.length&&(we.xC(e.charCodeAt(0))||t&&(0,Ee.B)(e))}qe=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(he.$)),(0,i.__param)(1,(0,a.W)(d.c)),(0,i.__param)(2,(0,a.W)(k.g)),(0,i.__param)(3,(0,h.l)()),(0,i.__param)(3,(0,a.W)(s.s)),(0,i.__param)(4,(0,h.l)()),(0,i.__param)(4,(0,a.W)(De.m))],qe);let We=class{constructor(e,t,n,i,r,o,a,s,l){this._hostEmitters=e,this._proofingEmitter=t,this._critiquesEventHandler=n,this._filteringEventHandler=i,this._nodeEventHandler=r,this._spanEventHandler=o,this._formattingEventHandler=a,this._hostSettings=s,this._logger=l,this.shutDown=()=>{this._logger.log(556372812,E.q.Debug,"Shutting down EventHub.")},this.onFilterChangedEvent=e=>{this._filteringEventHandler.onEvent({eventType:e.messageType})},this.onHostModelCritiquesEvent=e=>{const t={added:e.data.critiquesAdded,removedIds:e.data.critiqueIdsRemoved,eventType:e.messageType,source:e.data.source,tileId:e.data.tileId,tileVersion:e.data.tileVersion};this._critiquesEventHandler.onEvent(t)},this.onHostModelDeltaEvent=e=>{const{delta:t,deletedOrReplacedCharacters:n,sourceType:i,tileId:r,tileVersion:o}=e.message;if(!0===this._hostSettings.sdkV2Enabled||i!==D.pf.TileNode)return;const a={position:t.position,length:t.length,content:t.content,eventType:t.deltaType===Pe.WI.Add?A.G.NewData:t.deltaType===Pe.WI.Delete?A.G.RemoveData:A.G.ChangeData,tileId:r,tileVersion:o,deletedOrReplacedCharacters:n};this._spanEventHandler.onEvent(a)},this.onHostModelFormattingDelta=e=>{const t=e.message.delta,n=e.message.tileId,i=e.message.tileVersion,r={formattedRanges:t.formattedRanges,eventType:t.deltaType===Pe.WI.Add?A.G.NewData:t.deltaType===Pe.WI.Delete?A.G.RemoveData:A.G.ChangeData,tileId:n,tileVersion:i};this._formattingEventHandler.onEvent(r)},this.onHostModelTextTileEvent=e=>{if(!0===this._hostSettings.sdkV2Enabled)return;const t=e.data.tileId,n=e.data.tileVersion,i={eventType:e.messageType,tileId:t,tileVersion:n};this._nodeEventHandler.onEvent(i)},this.onClearCritiquesForNode=e=>{const t={eventType:A.G.RemoveData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)},this.onRestoreNodeForCritiqueStore=e=>{const t={eventType:A.G.NewData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)}}async initialize(){if(this._logger.log(556372811,E.q.Debug,"Initializing EventHub."),this._hostSettings.enableOrchestration){this._proofingEmitter.on("enabledCritiqueTypesChanged",(e=>this.filterMessageType("enabledCritiqueTypesChanged",e,this.onFilterChangedEvent,void 0,A.G.ChangeData)));for(const e of["eccStateChanged","wordDictionaryEvent"])this._proofingEmitter.on(e,(t=>this.filterMessageType(e,t,this.onFilterChangedEvent,A.G.ChangeData)));for(const e of this._hostEmitters)e.on(z.pD.hostModelCritiques,(e=>this.filterMessageType("hostModelCritiques",e.message,this.onHostModelCritiquesEvent,void 0,A.G.ChangeData))),e.on(z.pD.hostModelFlags,(e=>this.filterMessageType("hostModelFlags",e.message,this.onHostModelCritiquesEvent,void 0,A.G.ChangeData))),e.on(z.pD.hostModelTextTile,(e=>this.filterMessageType("hostModelTextTile",e.message,this.onHostModelTextTileEvent,A.G.ChangeData))),e.on(z.pD.hostModelDelta,this.onHostModelDeltaEvent),e.on(z.pD.clearCritiquesForNode,this.onClearCritiquesForNode),e.on(z.pD.restoreNodeForCritiqueStore,this.onRestoreNodeForCritiqueStore),e.on(z.pD.hostModelFormattingDelta,this.onHostModelFormattingDelta)}}filterMessageType(e,t,n,i,r){r&&t.messageType!==r||i&&t.messageType===i?this._logger.log(556372815,E.q.Warn,`${e} message: Unexpected MessageType.`):n(t)}};We=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,c.t)(z.zJ)),(0,i.__param)(1,(0,a.W)(N.o)),(0,i.__param)(2,(0,a.W)(Fe)),(0,i.__param)(3,(0,a.W)(ke)),(0,i.__param)(4,(0,a.W)(Re)),(0,i.__param)(5,(0,a.W)(qe)),(0,i.__param)(6,(0,a.W)(Be)),(0,i.__param)(7,(0,a.W)(u.n)),(0,i.__param)(8,(0,a.W)(k.g))],We);var je=n(44579);let ze=class{constructor(e){this._logger=e,this._renderedCritiques=new Map}update(e,t){const n=this._renderedCritiques.get(t)||new Map;for(const t of e){const e=`${t.textInContext}#${t.typeId}`;n.set(e,t)}this._renderedCritiques.set(t,n)}logTelemetry(){const e=this._logger.getNewActivity(je.n.CritiquesShown,x.o.SamplingPolicy.CriticalExperimentation);if(!e)return;let t=[];Array.from(this._renderedCritiques.values()).forEach((e=>{t=t.concat(Array.from(e.values()))}));const n={};try{const e=Array.from(t.values()).reduce(((e,t)=>{if(t.typeId){let n=new Set;t.typeId===r.L9.TopicSuggestion&&(n=t.suggestions.reduce(((e,t)=>{const n=t.metadataJSON;if(n){const t=JSON.parse(n).id;t&&e.add(t)}return e}),new Set)),t.typeId in e?(e[t.typeId].count+=1,n.forEach(e[t.typeId].suggestions.add,e[t.typeId].suggestions)):e[t.typeId]={count:1,suggestions:n}}return e}),{});for(const t in e)n[t]={count:e[t].count,suggestions:[...e[t].suggestions]}}catch(e){this._logger.error(524116174,"Data preparation failed for CritiquesShown",e)}e.dataFields.push((0,M.n)("Critiques",JSON.stringify(n))),e.success=!0,e.endNow()}};ze=(0,i.__decorate)([(0,o._)(),(0,i.__param)(0,(0,a.W)(k.g))],ze);class He{constructor(){this.imports=[oe]}get uniqueId(){return(0,J.z)(507908322)}configureRootServices(e){e.bind(Y.S).to(We),e.bind(Fe).toSelf(),e.bind(ke).toSelf(),e.bind(Be).toSelf(),e.bind(Re).toSelf(),e.bind(qe).toSelf(),e.bind(be.H).to(ze),e.bind(he.$).to(Ce),e.bind(Y.S).toExisting(he.$),e.bind(m.D).to(ue),e.bind(m.D).to(ce)}}},28871:(e,t,n)=>{"use strict";n.d(t,{Y:()=>a,h:()=>s});var i=n(30206),r=n(63837),o=n(48828);const a=(0,r.f)("INudgeStore");let s=class{constructor(){this.updateNudge=async e=>{this._currentNudge=e,this._onUpdate&&await this._onUpdate()},this.clearNudge=async()=>{this._currentNudge=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentNudge=()=>this._currentNudge,this.setOnUpdatedNudge=e=>{this._onUpdate=e}}};s=(0,i.__decorate)([(0,o._)()],s)},22322:(e,t,n)=>{"use strict";n.d(t,{C:()=>g,L:()=>p});var i=n(30206),r=n(86310),o=n(44680),a=n(9654),s=n(17677),l=n(713),u=n(48741),d=n(63837),c=n(48828),h=n(90424);const g=(0,d.f)("IOAResultStore");let p=class{constructor(e,t,n,i){this._oaLogger=e,this._hostSettings=t,this._queryDetection=n,this._oaMetric=i,this._results=[],this._resultsByNode=new Map,this._isLoading=!0,this._isTimeout=!1,this._resultReset=!1,this.setOnUpdate=e=>{this.onUpdate=e},this.updateResults=(e,t,n,i,r,o)=>{var a,s;if(null===(a=this._hostSettings.oaSettings)||void 0===a?void 0:a.mockNoAugloopResults)return;const l=(null==i?void 0:i.logicalId)&&i.logicalId!==this._queryDetection.getCurrentQueryLogicalId();this.logStoreUpdate(e,!!l,n,i),l?this._oaMetric.commitEntry(i.logicalId,"OAAnnotationResultsDropped"):(i&&this._oaMetric.addMeasure(i.logicalId,"OAResultsReceived"),this.cancelTimeout(),this._isLoading=!1,this._isTimeout=!1,this._resultSummary=o,this._resultStatus=n,this._resultReset=!1,this._results=this._results.concat(e),this._resultsByNode.set(t,e),this.update(n,e,null!==(s=null!=i?i:this._queryDetection.getCurrentQueryCorrelationKeys())&&void 0!==s?s:{conversationId:"",logicalId:""},t,r,o))},this.updateLoadingStatus=(e,t=!1)=>{this._isLoading=e,this._isTimeout=!1,this._resultSummary=void 0,this._resultStatus=void 0,this._resultReset=t,e&&(this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())),this.update()},this.startNewECCMenu=()=>{this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())},this.clearResults=()=>{this._results=[],this._isTimeout=!1,this._isLoading=!0,this._resultReset=!1,this._resultsByNode.clear()},this.getResults=()=>this._results,this.getResultSummary=()=>this._resultSummary,this.getResultStatus=()=>this._resultStatus,this.getLoadingStatus=()=>this._isLoading,this.getTimeoutStatus=()=>this._isTimeout||this._resultStatus===u.i.UnexpectedError,this.timeoutFunc=()=>{var e;this._isTimeout=!0,this._isLoading=!1,this._resultSummary={Timeout:1},this._resultStatus=u.i.Timeout,this._resultReset=!1,this.update(u.i.Timeout,void 0,null!==(e=this._queryDetection.getCurrentQueryCorrelationKeys())&&void 0!==e?e:{conversationId:"",logicalId:""},void 0,this.getTimeoutThreshold(),this._resultSummary)},this.cancelTimeout=()=>{this._timeoutID&&clearTimeout(this._timeoutID)},this.update=(e=void 0,t=[],n=void 0,i,r,o=void 0)=>{this.onUpdate&&this.onUpdate({results:t,isLoading:this._isLoading,queryCorrelationKeys:n,resultSummary:o,resultStatus:e,resultReset:this._resultReset,nodeId:i,latency:r})}}logStoreUpdate(e,t,n,i){const r={};for(const t of e)r[t.entityType]=t.entities.length;this._oaLogger.logActivity(l.y,{actualLogicalId:null==i?void 0:i.logicalId,actualConversationId:null==i?void 0:i.conversationId,annotationCount:e.length,resultStatus:null!=n?n:-1,annotations:r,dropped:t})}getTimeoutThreshold(){var e;return(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.updateResultsTimeout)||3500}};p=(0,i.__decorate)([(0,c._)(),(0,i.__param)(0,(0,h.W)(r.m)),(0,i.__param)(1,(0,h.W)(o.n)),(0,i.__param)(2,(0,h.W)(a.J)),(0,i.__param)(3,(0,h.W)(s.u))],p)},713:(e,t,n)=>{"use strict";n.d(t,{$:()=>r,y:()=>i});const i="OAResultStoreUpdates",r="OAPredictionReceived"},51579:(e,t,n)=>{"use strict";n.d(t,{X:()=>s,o:()=>a});var i=n(30206),r=n(63837),o=n(48828);const a=(0,r.f)("IPredictionStore");let s=class{constructor(){this.updatePrediction=async e=>{this._currentPrediction=e,this._onUpdate&&await this._onUpdate()},this.clearPrediction=async()=>{this._currentPrediction=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentPrediction=()=>this._currentPrediction,this.setOnUpdatedPrediction=e=>{this._onUpdate=e}}};s=(0,i.__decorate)([(0,o._)()],s)},50955:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});const i=(0,n(63837).f)("IPresentationSettings")},63282:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});const i=(0,n(63837).f)("EditorCanvasInjectableComponent")},90725:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});const i=(0,n(63837).f)("ISessionTelemetryTracker")},46785:(e,t,n)=>{"use strict";n.d(t,{qq:()=>Nn,R9:()=>Fn});var i={};function r(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function o(e){const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}n.r(i),n.d(i,{BrowserExtensionRequestV1:()=>on,BrowserExtensionResponseV1:()=>dn,CommonAppIdProperty:()=>Rt,CommonAppVersionProperty:()=>en,CommonCritique:()=>$t,CommonDescriptorsProperty:()=>zt,CommonLanguageIdProperty:()=>Ut,CommonLanguageUXIdProperty:()=>Vt,CommonOverriddenCritiqueTypeOptions:()=>Qt,CommonRequestIdProperty:()=>Mt,CommonResponseStatusProperty:()=>Lt,CommonRevisionIdProperty:()=>Yt,CommonRunOnProfileIdProperty:()=>Gt,CommonTextUnitProperty:()=>Wt,CommonTileIdProperty:()=>Jt,ConfigRequestV2:()=>sn,ConfigResponseV2:()=>hn,CritiqueCategoryInfo:()=>tn,CritiqueTypeInfo:()=>nn,CritiqueTypeOption:()=>mn,Descriptor:()=>Ht,EditorServiceConfigV2Headers:()=>bn,EditorServiceInstrumentationHeaders:()=>Tn,EditorServiceLanguageinfoHeaders:()=>Cn,EditorServicePostTileCheckHeaders:()=>_n,InstrumentationRequestV1:()=>un,LanguageInfoRequestV1:()=>ln,LanguageInfoResponseV1:()=>gn,Metadatum:()=>Zt,Suggestion:()=>Kt,SupportedActions:()=>Xt,SupportedLanguage:()=>vn,TileCheckCritique:()=>yn,TileCheckRequestV1:()=>an,TileCheckResponseV1:()=>cn,TileCheckSpan:()=>pn,TileContent:()=>qt,TileElement:()=>fn,TopologyNode:()=>jt,UserIdentity:()=>rn});const a="$",s="_",l=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,u=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function d(e,t){var n,i;const r=e.parsedHeaders;if("HEAD"===e.request.method)return Object.assign(Object.assign({},r),{body:e.parsedBody});const o=t&&t.bodyMapper,a=Boolean(null==o?void 0:o.nullable),s=null==o?void 0:o.type.name;if("Stream"===s)return Object.assign(Object.assign({},r),{blobBody:e.blobBody,readableStreamBody:e.readableStreamBody});const l="Composite"===s&&o.type.modelProperties||{},u=Object.keys(l).some((e=>""===l[e].serializedName));if("Sequence"===s||u){const t=null!==(n=e.parsedBody)&&void 0!==n?n:[];for(const n of Object.keys(l))l[n].serializedName&&(t[n]=null===(i=e.parsedBody)||void 0===i?void 0:i[n]);if(r)for(const e of Object.keys(r))t[e]=r[e];return!a||e.parsedBody||r||0!==Object.getOwnPropertyNames(l).length?t:null}return function(e){const t=Object.assign(Object.assign({},e.headers),e.body);return e.hasNullableType&&0===Object.getOwnPropertyNames(t).length?e.shouldWrapBody?{body:null}:null:e.shouldWrapBody?Object.assign(Object.assign({},e.headers),{body:e.body}):t}({body:e.parsedBody,headers:r,hasNullableType:a,shouldWrapBody:(d=e.parsedBody,c=s,"Composite"!==c&&"Dictionary"!==c&&("string"==typeof d||"number"==typeof d||"boolean"==typeof d||null!==(null==c?void 0:c.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i))||null==d))});var d,c}class c{constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,n){const i=(e,i)=>{throw new Error(`"${n}" with value "${t}" should satisfy the constraint "${e}": ${i}.`)};if(e.constraints&&null!=t){const{ExclusiveMaximum:n,ExclusiveMinimum:r,InclusiveMaximum:o,InclusiveMinimum:a,MaxItems:s,MaxLength:l,MinItems:u,MinLength:d,MultipleOf:c,Pattern:h,UniqueItems:g}=e.constraints;if(void 0!==n&&t>=n&&i("ExclusiveMaximum",n),void 0!==r&&t<=r&&i("ExclusiveMinimum",r),void 0!==o&&t>o&&i("InclusiveMaximum",o),void 0!==a&&t<a&&i("InclusiveMinimum",a),void 0!==s&&t.length>s&&i("MaxItems",s),void 0!==l&&t.length>l&&i("MaxLength",l),void 0!==u&&t.length<u&&i("MinItems",u),void 0!==d&&t.length<d&&i("MinLength",d),void 0!==c&&t%c!=0&&i("MultipleOf",c),h){const e="string"==typeof h?new RegExp(h):h;"string"==typeof t&&null!==t.match(e)||i("Pattern",h)}g&&t.some(((e,t,n)=>n.indexOf(e)!==t))&&i("UniqueItems",g)}}serialize(e,t,n,i={xml:{}}){var o,d,c;const m={xml:{rootName:null!==(o=i.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(d=i.xml.includeRoot)&&void 0!==d&&d,xmlCharKey:null!==(c=i.xml.xmlCharKey)&&void 0!==c?c:s}};let _={};const b=e.type.name;n||(n=e.serializedName),null!==b.match(/^Sequence$/i)&&(_=[]),e.isConstant&&(t=e.defaultValue);const{required:C,nullable:T}=e;if(C&&T&&void 0===t)throw new Error(`${n} cannot be undefined.`);if(C&&!T&&null==t)throw new Error(`${n} cannot be null or undefined.`);if(!C&&!1===T&&null===t)throw new Error(`${n} cannot be null.`);return null==t||null!==b.match(/^any$/i)?_=t:null!==b.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?_=function(e,t,n){if(null!=n)if(null!==e.match(/^Number$/i)){if("number"!=typeof n)throw new Error(`${t} with value ${n} must be of type number.`)}else if(null!==e.match(/^String$/i)){if("string"!=typeof n.valueOf())throw new Error(`${t} with value "${n}" must be of type string.`)}else if(null!==e.match(/^Uuid$/i)){if("string"!=typeof n.valueOf()||(i=n,!u.test(i)))throw new Error(`${t} with value "${n}" must be of type string and a valid uuid.`)}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof n)throw new Error(`${t} with value ${n} must be of type boolean.`)}else if(null!==e.match(/^Stream$/i)){const e=typeof n;if(!("string"===e||"function"==typeof n.pipe||"function"==typeof n.tee||n instanceof ArrayBuffer||ArrayBuffer.isView(n)||("function"==typeof Blob||"object"==typeof Blob)&&n instanceof Blob||"function"===e))throw new Error(`${t} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}var i;return n}(b,n,t):null!==b.match(/^Enum$/i)?_=function(e,t,n){if(!t)throw new Error(`Please provide a set of allowedValues to validate ${e} as an Enum Type.`);if(!t.some((e=>"string"==typeof e.valueOf()?e.toLowerCase()===n.toLowerCase():e===n)))throw new Error(`${n} is not a valid value for ${e}. The valid values are: ${JSON.stringify(t)}.`);return n}(n,e.type.allowedValues,t):null!==b.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?_=function(e,t,n){if(null!=t)if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123 format.`);t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw new Error(`${n} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);t=function(e){if(e)return"string"==typeof e.valueOf()&&(e=new Date(e)),Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)&&!function(e){return l.test(e)}(t))throw new Error(`${n} must be a string in ISO 8601 format. Instead was "${t}".`);return t}(b,t,n):null!==b.match(/^ByteArray$/i)?_=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=r(t)}return t}(n,t):null!==b.match(/^Base64Url$/i)?_=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw new Error(`${e} must be of type Uint8Array.`);t=function(e){if(e){if(!(e instanceof Uint8Array))throw new Error("Please provide an input of type Uint8Array for converting to Base64Url.");return function(e,t){let n=e.length;for(;n-1>=0&&"="===e[n-1];)--n;return e.substr(0,n)}(r(e)).replace(/\+/g,"-").replace(/\//g,"_")}}(t)}return t}(n,t):null!==b.match(/^Sequence$/i)?_=function(e,t,n,i,r,o){var s;if(!Array.isArray(n))throw new Error(`${i} must be of type Array.`);let l=t.type.element;if(!l||"object"!=typeof l)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${i}.`);"Composite"===l.type.name&&l.type.className&&(l=null!==(s=e.modelMappers[l.type.className])&&void 0!==s?s:l);const u=[];for(let t=0;t<n.length;t++){const s=e.serialize(l,n[t],i,o);if(r&&l.xmlNamespace){const e=l.xmlNamespacePrefix?`xmlns:${l.xmlNamespacePrefix}`:"xmlns";"Composite"===l.type.name?(u[t]=Object.assign({},s),u[t][a]={[e]:l.xmlNamespace}):(u[t]={},u[t][o.xml.xmlCharKey]=s,u[t][a]={[e]:l.xmlNamespace})}else u[t]=s}return u}(this,e,t,n,Boolean(this.isXML),m):null!==b.match(/^Dictionary$/i)?_=function(e,t,n,i,r,o){if("object"!=typeof n)throw new Error(`${i} must be of type object.`);const s=t.type.value;if(!s||"object"!=typeof s)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${i}.`);const l={};for(const t of Object.keys(n)){const a=e.serialize(s,n[t],i,o);l[t]=f(s,a,r,o)}if(r&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns",n=l;return n[a]={[e]:t.xmlNamespace},n}return l}(this,e,t,n,Boolean(this.isXML),m):null!==b.match(/^Composite$/i)&&(_=function(e,t,n,i,r,o){if(y(e,t)&&(t=v(e,t,n,"clientName")),null!=n){const s={},l=p(e,t,i);for(const u of Object.keys(l)){const d=l[u];if(d.readOnly)continue;let c,g=s;if(e.isXML)c=d.xmlIsWrapped?d.xmlName:d.xmlElementName||d.xmlName;else{const e=h(d.serializedName);c=e.pop();for(const t of e){null==g[t]&&(void 0!==n[u]&&null!==n[u]||void 0!==d.defaultValue)&&(g[t]={}),g=g[t]}}if(null!=g){if(r&&t.xmlNamespace){const e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns";g[a]=Object.assign(Object.assign({},g[a]),{[e]:t.xmlNamespace})}const s=""!==d.serializedName?i+"."+d.serializedName:i;let l=n[u];const h=y(e,t);h&&h.clientName===u&&null==l&&(l=t.serializedName);const p=e.serialize(d,l,s,o);if(void 0!==p&&null!=c){const e=f(d,p,r,o);r&&d.xmlIsAttribute?(g[a]=g[a]||{},g[a][c]=p):r&&d.xmlIsWrapped?g[c]={[d.xmlElementName]:e}:g[c]=e}}}const u=function(e,t,n){const i=t.type.additionalProperties;if(!i&&t.type.className){const i=g(e,t,n);return null==i?void 0:i.type.additionalProperties}return i}(e,t,i);if(u){const t=Object.keys(l);for(const r in n)t.every((e=>e!==r))&&(s[r]=e.serialize(u,n[r],i+'["'+r+'"]',o))}return s}return n}(this,e,t,n,Boolean(this.isXML),m)),_}deserialize(e,t,n,i={xml:{}}){var r,l,u,d;const c={xml:{rootName:null!==(r=i.xml.rootName)&&void 0!==r?r:"",includeRoot:null!==(l=i.xml.includeRoot)&&void 0!==l&&l,xmlCharKey:null!==(u=i.xml.xmlCharKey)&&void 0!==u?u:s},ignoreUnknownProperties:null!==(d=i.ignoreUnknownProperties)&&void 0!==d&&d};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;let g;const f=e.type.name;if(n||(n=e.serializedName),null!==f.match(/^Composite$/i))g=function(e,t,n,i,r){var o,l;const u=null!==(o=r.xml.xmlCharKey)&&void 0!==o?o:s;y(e,t)&&(t=v(e,t,n,"serializedName"));const d=p(e,t,i);let c={};const g=[];for(const o of Object.keys(d)){const s=d[o],p=h(d[o].serializedName);g.push(p[0]);const{serializedName:f,xmlName:m,xmlElementName:v}=s;let y=i;""!==f&&void 0!==f&&(y=i+"."+f);const _=s.headerCollectionPrefix;if(_){const t={};for(const i of Object.keys(n))i.startsWith(_)&&(t[i.substring(_.length)]=e.deserialize(s.type.value,n[i],y,r)),g.push(i);c[o]=t}else if(e.isXML)if(s.xmlIsAttribute&&n[a])c[o]=e.deserialize(s,n[a][m],y,r);else if(s.xmlIsMsText)void 0!==n[u]?c[o]=n[u]:"string"==typeof n&&(c[o]=n);else{const t=v||m||f;if(s.xmlIsWrapped){const t=n[m],i=null!==(l=null==t?void 0:t[v])&&void 0!==l?l:[];c[o]=e.deserialize(s,i,y,r),g.push(m)}else{const i=n[t];c[o]=e.deserialize(s,i,y,r),g.push(t)}}else{let i,a=n,l=0;for(const e of p){if(!a)break;l++,a=a[e]}null===a&&l<p.length&&(a=void 0),i=a;const u=t.type.polymorphicDiscriminator;let h;if(u&&o===u.clientName&&null==i&&(i=t.serializedName),Array.isArray(n[o])&&""===d[o].serializedName){i=n[o];const t=e.deserialize(s,i,y,r);for(const[e,n]of Object.entries(c))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=n);c=t}else void 0===i&&void 0===s.defaultValue||(h=e.deserialize(s,i,y,r),c[o]=h)}}const f=t.type.additionalProperties;if(f){const t=e=>{for(const t in d)if(h(d[t].serializedName)[0]===e)return!1;return!0};for(const o in n)t(o)&&(c[o]=e.deserialize(f,n[o],i+'["'+o+'"]',r))}else if(n&&!r.ignoreUnknownProperties)for(const e of Object.keys(n))void 0!==c[e]||g.includes(e)||m(e,r)||(c[e]=n[e]);return c}(this,e,t,n,c);else{if(this.isXML){const e=c.xml.xmlCharKey;void 0!==t[a]&&void 0!==t[e]&&(t=t[e])}null!==f.match(/^Number$/i)?(g=parseFloat(t),isNaN(g)&&(g=t)):null!==f.match(/^Boolean$/i)?g="true"===t||"false"!==t&&t:null!==f.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?g=t:null!==f.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?g=new Date(t):null!==f.match(/^UnixTime$/i)?g=function(e){if(e)return new Date(1e3*e)}(t):null!==f.match(/^ByteArray$/i)?g=o(t):null!==f.match(/^Base64Url$/i)?g=function(e){if(e){if(e&&"string"!=typeof e.valueOf())throw new Error("Please provide an input of type string for converting to Uint8Array");return o(e=e.replace(/-/g,"+").replace(/_/g,"/"))}}(t):null!==f.match(/^Sequence$/i)?g=function(e,t,n,i,r){var o;let a=t.type.element;if(!a||"object"!=typeof a)throw new Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${i}`);if(n){Array.isArray(n)||(n=[n]),"Composite"===a.type.name&&a.type.className&&(a=null!==(o=e.modelMappers[a.type.className])&&void 0!==o?o:a);const t=[];for(let o=0;o<n.length;o++)t[o]=e.deserialize(a,n[o],`${i}[${o}]`,r);return t}return n}(this,e,t,n,c):null!==f.match(/^Dictionary$/i)&&(g=function(e,t,n,i,r){const o=t.type.value;if(!o||"object"!=typeof o)throw new Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${i}`);if(n){const t={};for(const a of Object.keys(n))t[a]=e.deserialize(o,n[a],i,r);return t}return n}(this,e,t,n,c))}return e.isConstant&&(g=e.defaultValue),g}}function h(e){const t=[];let n="";if(e){const i=e.split(".");for(const e of i)"\\"===e.charAt(e.length-1)?n+=e.substr(0,e.length-1)+".":(n+=e,t.push(n),n="")}return t}function g(e,t,n){const i=t.type.className;if(!i)throw new Error(`Class name for model "${n}" is not provided in the mapper "${JSON.stringify(t,void 0,2)}".`);return e.modelMappers[i]}function p(e,t,n){let i=t.type.modelProperties;if(!i){const r=g(e,t,n);if(!r)throw new Error(`mapper() cannot be null or undefined for model "${t.type.className}".`);if(i=null==r?void 0:r.type.modelProperties,!i)throw new Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(r)}" of type "${t.type.className}" for object "${n}".`)}return i}function f(e,t,n,i){if(!n||!e.xmlNamespace)return t;const r={[e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns"]:e.xmlNamespace};if(["Composite"].includes(e.type.name)){if(t[a])return t;{const e=Object.assign({},t);return e[a]=r,e}}const o={};return o[i.xml.xmlCharKey]=t,o[a]=r,o}function m(e,t){return[a,t.xml.xmlCharKey].includes(e)}function v(e,t,n,i){var r;const o=y(e,t);if(o){let a=o[i];if(a){"serializedName"===i&&(a=a.replace(/\\/gi,""));const o=n[a],s=null!==(r=t.type.uberParent)&&void 0!==r?r:t.type.className;if("string"==typeof o&&s){const n=function(e,t,n){const i=[n];for(;i.length;){const n=i.shift(),r=t===n?t:n+"."+t;if(Object.prototype.hasOwnProperty.call(e,r))return e[r];for(const[t,r]of Object.entries(e))t.startsWith(n+".")&&r.type.uberParent===n&&r.type.className&&i.push(r.type.className)}}(e.modelMappers.discriminators,o,s);n&&(t=n)}}}return t}function y(e,t){return t.type.polymorphicDiscriminator||_(e,t.type.uberParent)||_(e,t.type.className)}function _(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}const b="Sequence",C="String",T="Stream",S=new Set(["Deserialize","Serialize","Retry","Sign"]);class I{constructor(e){var t;this._policies=[],this._policies=null!==(t=null==e?void 0:e.slice(0))&&void 0!==t?t:[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!S.has(t.phase))throw new Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!S.has(t.afterPhase))throw new Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){const t=[];return this._policies=this._policies.filter((n=>!(e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase)||(t.push(n.policy),!1))),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight(((e,t)=>n=>t.sendRequest(n,e)),(t=>e.sendRequest(t)))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new I(this._policies)}static create(){return new I}orderPolicies(){const e=[],t=new Map;function n(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}const i=n("Serialize"),r=n("None"),o=n("Deserialize"),a=n("Retry"),s=n("Sign"),l=[i,r,o,a,s];function u(e){return"Retry"===e?a:"Serialize"===e?i:"Deserialize"===e?o:"Sign"===e?s:r}for(const e of this._policies){const n=e.policy,i=e.options,r=n.name;if(t.has(r))throw new Error("Duplicate policy names not allowed in pipeline");const o={policy:n,dependsOn:new Set,dependants:new Set};i.afterPhase&&(o.afterPhase=u(i.afterPhase),o.afterPhase.hasAfterPolicies=!0),t.set(r,o),u(i.phase).policies.add(o)}for(const e of this._policies){const{policy:n,options:i}=e,r=n.name,o=t.get(r);if(!o)throw new Error(`Missing node for policy ${r}`);if(i.afterPolicies)for(const e of i.afterPolicies){const n=t.get(e);n&&(o.dependsOn.add(n),n.dependants.add(o))}if(i.beforePolicies)for(const e of i.beforePolicies){const n=t.get(e);n&&(n.dependsOn.add(o),o.dependants.add(n))}}function d(n){n.hasRun=!0;for(const i of n.policies)if((!i.afterPhase||i.afterPhase.hasRun&&!i.afterPhase.policies.size)&&0===i.dependsOn.size){e.push(i.policy);for(const e of i.dependants)e.dependsOn.delete(i);t.delete(i.policy.name),n.policies.delete(i)}}function c(){for(const e of l){if(d(e),e.policies.size>0&&e!==r)return void(r.hasRun||d(r));e.hasAfterPolicies&&d(r)}}let h=0;for(;t.size>0;){h++;const t=e.length;if(c(),e.length<=t&&h>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}const w="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0;let E,x=[],A=[];const D=[];w&&F(w);const N=Object.assign((e=>k(e)),{enable:F,enabled:P,disable:function(){const e=E||"";return F(""),e},log:function(...e){if(e.length>0){const t=String(e[0]);t.includes(":error")?console.error(...e):t.includes(":warning")?console.warn(...e):t.includes(":info")?console.info(...e):(t.includes(":verbose"),console.debug(...e))}}});function F(e){E=e,x=[],A=[];const t=/\*/g,n=e.split(",").map((e=>e.trim().replace(t,".*?")));for(const e of n)e.startsWith("-")?A.push(new RegExp(`^${e.substr(1)}$`)):x.push(new RegExp(`^${e}$`));for(const e of D)e.enabled=P(e.namespace)}function P(e){if(e.endsWith("*"))return!0;for(const t of A)if(t.test(e))return!1;for(const t of x)if(t.test(e))return!0;return!1}function k(e){const t=Object.assign((function(...n){t.enabled&&(n.length>0&&(n[0]=`${e} ${n[0]}`),t.log(...n))}),{enabled:P(e),destroy:O,log:N.log,namespace:e,extend:B});return D.push(t),t}function O(){const e=D.indexOf(this);return e>=0&&(D.splice(e,1),!0)}function B(e){const t=k(`${this.namespace}:${e}`);return t.log=this.log,t}const R=N,L=new Set,M="undefined"!=typeof process&&process.env&&process.env.AZURE_LOG_LEVEL||void 0;let q;const U=R("azure");U.log=(...e)=>{R.log(...e)};const W=["verbose","info","warning","error"];M&&(Q(M)?function(e){if(e&&!Q(e))throw new Error(`Unknown log level '${e}'. Acceptable values: ${W.join(",")}`);q=e;const t=[];for(const e of L)G(e)&&t.push(e.namespace);R.enable(t.join(","))}(M):console.error(`AZURE_LOG_LEVEL set to unknown log level '${M}'; logging is not enabled. Acceptable values: ${W.join(", ")}.`));const j={verbose:400,info:300,warning:200,error:100};function z(e){const t=U.extend(e);return H(U,t),{error:V(t,"error"),warning:V(t,"warning"),info:V(t,"info"),verbose:V(t,"verbose")}}function H(e,t){t.log=(...t)=>{e.log(...t)}}function V(e,t){const n=Object.assign(e.extend(t),{level:t});if(H(e,n),G(n)){const e=R.disable();R.enable(e+","+n.namespace)}return L.add(n),n}function G(e){return Boolean(q&&j[e.level]<=j[q])}function Q(e){return W.includes(e)}const K=z("core-rest-pipeline");class $ extends Error{constructor(e){super(e),this.name="AbortError"}}function Z(e){return!("object"!=typeof e||null===e||Array.isArray(e)||e instanceof RegExp||e instanceof Date)}function J(e){if(Z(e)){const t="string"==typeof e.name,n="string"==typeof e.message;return t&&n}return!1}function Y(e){if(J(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return`Unknown error ${t}`}}function X(e,t){switch(t){case"utf-8":return function(e){return(new TextEncoder).encode(e)}(e);case"base64":return ee(e);case"base64url":return function(e){return ee(e.replace(/-/g,"+").replace(/_/g,"/"))}(e);case"hex":return function(e){const t=new Uint8Array(e.length/2);for(let n=0;n<e.length/2;++n){const i=e[2*n],r=e[2*n+1];if(!te.has(i)||!te.has(r))return t.slice(0,n);t[n]=parseInt(`${i}${r}`,16)}return t}(e)}}function ee(e){return new Uint8Array([...atob(e)].map((e=>e.charCodeAt(0))))}const te=new Set("0123456789abcdefABCDEF");var ne;const ie="function"==typeof(null===(ne=null===globalThis||void 0===globalThis?void 0:globalThis.crypto)||void 0===ne?void 0:ne.randomUUID)?globalThis.crypto.randomUUID.bind(globalThis.crypto):function(){let e="";for(let t=0;t<32;t++){const n=Math.floor(16*Math.random());e+=12===t?"4":16===t?3&n|8:n.toString(16),7!==t&&11!==t&&15!==t&&19!==t||(e+="-")}return e};function re(){return ie()}var oe,ae,se,le;"undefined"!=typeof window&&window.document,"object"==typeof self&&"function"==typeof(null===self||void 0===self?void 0:self.importScripts)&&("DedicatedWorkerGlobalScope"===(null===(oe=self.constructor)||void 0===oe?void 0:oe.name)||"ServiceWorkerGlobalScope"===(null===(ae=self.constructor)||void 0===ae?void 0:ae.name)||null===(se=self.constructor)||void 0===se||se.name),"undefined"!=typeof Deno&&void 0!==Deno.version&&Deno.version.deno,"undefined"!=typeof Bun&&Bun.version;const ue=void 0!==globalThis.process&&Boolean(globalThis.process.version)&&Boolean(null===(le=globalThis.process.versions)||void 0===le?void 0:le.node),de=("undefined"!=typeof navigator&&(null===navigator||void 0===navigator||navigator.product),"REDACTED"),ce=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],he=["api-version"];class ge{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=ce.concat(e),t=he.concat(t),this.allowedHeaderNames=new Set(e.map((e=>e.toLowerCase()))),this.allowedQueryParameters=new Set(t.map((e=>e.toLowerCase())))}sanitize(e){const t=new Set;return JSON.stringify(e,((e,n)=>{if(n instanceof Error)return Object.assign(Object.assign({},n),{name:n.name,message:n.message});if("headers"===e)return this.sanitizeHeaders(n);if("url"===e)return this.sanitizeUrl(n);if("query"===e)return this.sanitizeQuery(n);if("body"!==e&&"response"!==e&&"operationSpec"!==e){if(Array.isArray(n)||Z(n)){if(t.has(n))return"[Circular]";t.add(n)}return n}}),2)}sanitizeUrl(e){if("string"!=typeof e||null===e||""===e)return e;const t=new URL(e);if(!t.search)return e;for(const[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,de);return t.toString()}sanitizeHeaders(e){const t={};for(const n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?t[n]=e[n]:t[n]=de;return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;const t={};for(const n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?t[n]=e[n]:t[n]=de;return t}}const pe="redirectPolicy",fe=["GET","HEAD"];function me(e={}){const{maxRetries:t=20}=e;return{name:pe,async sendRequest(e,n){const i=await n(e);return ve(n,i,t)}}}async function ve(e,t,n,i=0){const{request:r,status:o,headers:a}=t,s=a.get("location");if(s&&(300===o||301===o&&fe.includes(r.method)||302===o&&fe.includes(r.method)||303===o&&"POST"===r.method||307===o)&&i<n){const t=new URL(s,r.url);r.url=t.toString(),303===o&&(r.method="GET",r.headers.delete("Content-Length"),delete r.body),r.headers.delete("Authorization");const a=await e(r);return ve(e,a,n,i+1)}return t}const ye="1.16.3",_e=3;async function be(e){const t=new Map;t.set("core-rest-pipeline",ye),await async function(e){const t=globalThis.navigator;let n="unknown";if(null==t?void 0:t.userAgentData){const i=await t.userAgentData.getHighEntropyValues(["architecture","platformVersion"]);n=`${i.architecture}-${i.platform}-${i.platformVersion}`;const r=function(e){const t=["Google Chrome","Microsoft Edge","Opera","Brave","Chromium"];for(const n of t){const t=e.find((e=>e.brand===n));if(t)return t}}(t.userAgentData.brands);r&&e.set(r.brand,r.version)}else if(null==t?void 0:t.platform){n=t.platform;const i=function(e){const t=[{name:"Firefox",regex:/Firefox\/([\d.]+)/},{name:"Safari",regex:/Version\/([\d.]+).*Safari/}];for(const n of t){const t=e.match(n.regex);if(t)return{brand:n.name,version:t[1]}}}(t.userAgent);i&&e.set(i.brand,i.version)}else"string"==typeof globalThis.EdgeRuntime&&e.set("EdgeRuntime",globalThis.EdgeRuntime);e.set("OS",n)}(t);const n=function(e){const t=[];for(const[n,i]of e){const e=i?`${n}/${i}`:n;t.push(e)}return t.join(" ")}(t);return e?`${e} ${n}`:n}const Ce="x-ms-useragent",Te="userAgentPolicy",Se=Symbol("rawContent");function Ie(e){return"function"==typeof e[Se]?e[Se]():e.stream()}function we(e){return Boolean(e&&"function"==typeof e.pipe)}function Ee(e){return Boolean(e&&"function"==typeof e.getReader&&"function"==typeof e.tee)}async function xe(e){if(e instanceof Blob||e instanceof Uint8Array)return e;if(Ee(e))return new Response(e).blob();const t=Ie(e);if(we(t))throw new Error("Encountered unexpected type. In the browser, `concat` supports Web ReadableStream, Blob, Uint8Array, and files created using `createFile` only.");return xe(t)}function Ae(e){let t="";for(const[n,i]of e)t+=`${n}: ${i}\r\n`;return t}function De(e){return e instanceof Uint8Array?e.byteLength:"function"==typeof e.stream?-1===e.size?void 0:e.size:void 0}const Ne="multipartPolicy",Fe=70,Pe=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?");function ke(){return{name:Ne,async sendRequest(e,t){var n;if(!e.multipartBody)return t(e);if(e.body)throw new Error("multipartBody and regular body cannot be set at the same time");let i=e.multipartBody.boundary;const r=null!==(n=e.headers.get("Content-Type"))&&void 0!==n?n:"multipart/mixed",o=r.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!o)throw new Error(`Got multipart request body, but content-type header was not multipart: ${r}`);const[,a,s]=o;if(s&&i&&s!==i)throw new Error(`Multipart boundary was specified as ${s} in the header, but got ${i} in the request body`);return null!=i||(i=s),i?function(e){if(e.length>Fe)throw new Error(`Multipart boundary "${e}" exceeds maximum length of 70 characters`);if(Array.from(e).some((e=>!Pe.has(e))))throw new Error(`Multipart boundary "${e}" contains invalid characters`)}(i):i=`----AzSDKFormBoundary${re()}`,e.headers.set("Content-Type",`${a}; boundary=${i}`),await async function(e,t,n){const i=[X(`--${n}`,"utf-8"),...t.flatMap((e=>[X("\r\n","utf-8"),X(Ae(e.headers),"utf-8"),X("\r\n","utf-8"),e.body,X(`\r\n--${n}`,"utf-8")])),X("--\r\n\r\n","utf-8")],r=function(e){let t=0;for(const n of e){const e=De(n);if(void 0===e)return;t+=e}return t}(i);r&&e.headers.set("Content-Length",r),e.body=await async function(e){const t=[];for(const n of e)t.push(await xe("function"==typeof n?n():n));return new Blob(t)}(i)}(e,e.multipartBody.parts,i),e.multipartBody=void 0,t(e)}}}const Oe="The operation was aborted.";function Be(e,t,n){return new Promise(((i,r)=>{let o,a;const s=()=>r(new $((null==n?void 0:n.abortErrorMsg)?null==n?void 0:n.abortErrorMsg:Oe)),l=()=>{(null==n?void 0:n.abortSignal)&&a&&n.abortSignal.removeEventListener("abort",a)};if(a=()=>(o&&clearTimeout(o),l(),s()),(null==n?void 0:n.abortSignal)&&n.abortSignal.aborted)return s();o=setTimeout((()=>{l(),i(t)}),e),(null==n?void 0:n.abortSignal)&&n.abortSignal.addEventListener("abort",a)}))}function Re(e,t){const n=e.headers.get(t);if(!n)return;const i=Number(n);return Number.isNaN(i)?void 0:i}const Le="Retry-After",Me=["retry-after-ms","x-ms-retry-after-ms",Le];function qe(e){if(e&&[429,503].includes(e.status))try{for(const t of Me){const n=Re(e,t);if(0===n||n)return n*(t===Le?1e3:1)}const t=e.headers.get(Le);if(!t)return;const n=Date.parse(t)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch(e){return}}const Ue=1e3,We=64e3;function je(e={}){var t,n;const i=null!==(t=e.retryDelayInMs)&&void 0!==t?t:Ue,r=null!==(n=e.maxRetryDelayInMs)&&void 0!==n?n:We;let o=i;return{name:"exponentialRetryStrategy",retry({retryCount:t,response:n,responseError:i}){const a=!!(c=i)&&("ETIMEDOUT"===c.code||"ESOCKETTIMEDOUT"===c.code||"ECONNREFUSED"===c.code||"ECONNRESET"===c.code||"ENOENT"===c.code||"ENOTFOUND"===c.code),s=a&&e.ignoreSystemErrors,l=function(e){return Boolean(e&&void 0!==e.status&&(e.status>=500||408===e.status)&&501!==e.status&&505!==e.status)}(n),u=l&&e.ignoreHttpStatusCodes,d=n&&(function(e){return Number.isFinite(qe(e))}(n)||!l);var c;if(d||u||s)return{skipStrategy:!0};if(i&&!a&&!l)return{errorToThrow:i};const h=o*Math.pow(2,t),g=Math.min(r,h);var p,f;return o=g/2+(p=0,f=g/2,p=Math.ceil(p),f=Math.floor(f),Math.floor(Math.random()*(f-p+1))+p),{retryAfterInMs:o}}}}const ze=z("core-rest-pipeline retryPolicy"),He="retryPolicy";function Ve(e,t={maxRetries:_e}){const n=t.logger||ze;return{name:He,async sendRequest(i,r){var o,a;let s,l,u=-1;e:for(;;){u+=1,s=void 0,l=void 0;try{n.info(`Retry ${u}: Attempting to send request`,i.requestId),s=await r(i),n.info(`Retry ${u}: Received a response from request`,i.requestId)}catch(e){if(n.error(`Retry ${u}: Received an error from request`,i.requestId),l=e,!e||"RestError"!==l.name)throw e;s=l.response}if(null===(o=i.abortSignal)||void 0===o?void 0:o.aborted)throw n.error(`Retry ${u}: Request aborted.`),new $;if(u>=(null!==(a=t.maxRetries)&&void 0!==a?a:_e)){if(n.info(`Retry ${u}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),l)throw l;if(s)return s;throw new Error("Maximum retries reached with no response or error to throw")}n.info(`Retry ${u}: Processing ${e.length} retry strategies.`);t:for(const t of e){const e=t.logger||ze;e.info(`Retry ${u}: Processing retry strategy ${t.name}.`);const n=t.retry({retryCount:u,response:s,responseError:l});if(n.skipStrategy){e.info(`Retry ${u}: Skipped.`);continue t}const{errorToThrow:r,retryAfterInMs:o,redirectTo:a}=n;if(r)throw e.error(`Retry ${u}: Retry strategy ${t.name} throws error:`,r),r;if(o||0===o){e.info(`Retry ${u}: Retry strategy ${t.name} retries after ${o}`),await Be(o,void 0,{abortSignal:i.abortSignal});continue e}if(a){e.info(`Retry ${u}: Retry strategy ${t.name} redirects to ${a}`),i.url=a;continue e}}if(l)throw n.info("None of the retry strategies could work with the received error. Throwing it."),l;if(s)return n.info("None of the retry strategies could work with the received response. Returning it."),s}}}}function Ge(e){return e.toLowerCase()}class Qe{constructor(e){if(this._headersMap=new Map,e)for(const t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(Ge(e),{name:e,value:String(t).trim()})}get(e){var t;return null===(t=this._headersMap.get(Ge(e)))||void 0===t?void 0:t.value}has(e){return this._headersMap.has(Ge(e))}delete(e){this._headersMap.delete(Ge(e))}toJSON(e={}){const t={};if(e.preserveCase)for(const e of this._headersMap.values())t[e.name]=e.value;else for(const[e,n]of this._headersMap)t[e]=n.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(const t of e.values())yield[t.name,t.value]}(this._headersMap)}}function Ke(e){return new Qe(e)}const $e="formDataPolicy";const Ze="setClientRequestIdPolicy",Je={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};function Ye(e={}){let t=new Xe(e.parentContext);return e.span&&(t=t.setValue(Je.span,e.span)),e.namespace&&(t=t.setValue(Je.namespace,e.namespace)),t}class Xe{constructor(e){this._contextMap=e instanceof Xe?new Map(e._contextMap):new Map}setValue(e,t){const n=new Xe(this);return n._contextMap.set(e,t),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){const t=new Xe(this);return t._contextMap.delete(e),t}}const et={instrumenterImplementation:void 0};function tt(){return et.instrumenterImplementation||(et.instrumenterImplementation={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}},tracingContext:Ye({parentContext:t.tracingContext})}),withContext:(e,t,...n)=>t(...n)}),et.instrumenterImplementation}const nt={},it=new ge;class rt extends Error{constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1}),Object.setPrototypeOf(this,rt.prototype)}[nt](){return`RestError: ${this.message} \n ${it.sanitize(Object.assign(Object.assign({},this),{request:this.request,response:this.response}))}`}}rt.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR",rt.PARSE_ERROR="PARSE_ERROR";const ot="tracingPolicy";function at(e){var t;const n=I.create();var i;return ue&&(e.tlsOptions&&n.addPolicy((i=e.tlsOptions,{name:"tlsPolicy",sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=i),t(e))})),n.addPolicy(function(){throw new Error("proxyPolicy is not supported in browser environment")}(e.proxyOptions)),n.addPolicy(function(){throw new Error("decompressResponsePolicy is not supported in browser environment")}())),n.addPolicy({name:$e,async sendRequest(e,t){if(ue&&"undefined"!=typeof FormData&&e.body instanceof FormData&&(e.formData=function(e){var t;const n={};for(const[i,r]of e.entries())null!==(t=n[i])&&void 0!==t||(n[i]=[]),n[i].push(r);return n}(e.body),e.body=void 0),e.formData){const t=e.headers.get("Content-Type");t&&-1!==t.indexOf("application/x-www-form-urlencoded")?e.body=function(e){const t=new URLSearchParams;for(const[n,i]of Object.entries(e))if(Array.isArray(i))for(const e of i)t.append(n,e.toString());else t.append(n,i.toString());return t.toString()}(e.formData):await async function(e,t){const n=t.headers.get("Content-Type");if(n&&!n.startsWith("multipart/form-data"))return;t.headers.set("Content-Type",null!=n?n:"multipart/form-data");const i=[];for(const[t,n]of Object.entries(e))for(const e of Array.isArray(n)?n:[n])if("string"==typeof e)i.push({headers:Ke({"Content-Disposition":`form-data; name="${t}"`}),body:X(e,"utf-8")});else{if(null==e||"object"!=typeof e)throw new Error(`Unexpected value for key ${t}: ${e}. Value should be serialized to string first.`);{const n=e.name||"blob",r=Ke();r.set("Content-Disposition",`form-data; name="${t}"; filename="${n}"`),r.set("Content-Type",e.type||"application/octet-stream"),i.push({headers:r,body:e})}}t.multipartBody={parts:i}}(e.formData,e),e.formData=void 0}return t(e)}},{beforePolicies:[Ne]}),n.addPolicy(function(e={}){const t=be(e.userAgentPrefix);return{name:Te,sendRequest:async(e,n)=>(e.headers.has(Ce)||e.headers.set(Ce,await t),n(e))}}(e.userAgentOptions)),n.addPolicy(function(e="x-ms-client-request-id"){return{name:Ze,sendRequest:async(t,n)=>(t.headers.has(e)||t.headers.set(e,t.requestId),n(t))}}(null===(t=e.telemetryOptions)||void 0===t?void 0:t.clientRequestIdHeaderName)),n.addPolicy(ke(),{afterPhase:"Deserialize"}),n.addPolicy(function(e={}){var t;return{name:"defaultRetryPolicy",sendRequest:Ve([{name:"throttlingRetryStrategy",retry({response:e}){const t=qe(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}},je(e)],{maxRetries:null!==(t=e.maxRetries)&&void 0!==t?t:_e}).sendRequest}}(e.retryOptions),{phase:"Retry"}),n.addPolicy(function(e={}){const t=be(e.userAgentPrefix),n=new ge({additionalAllowedQueryParameters:e.additionalAllowedQueryParameters}),i=function(){try{return function(e){const{namespace:t,packageName:n,packageVersion:i}=e;function r(e,r,o){var a;const s=tt().startSpan(e,Object.assign(Object.assign({},o),{packageName:n,packageVersion:i,tracingContext:null===(a=null==r?void 0:r.tracingOptions)||void 0===a?void 0:a.tracingContext}));let l=s.tracingContext;const u=s.span;return l.getValue(Je.namespace)||(l=l.setValue(Je.namespace,t)),u.setAttribute("az.namespace",l.getValue(Je.namespace)),{span:u,updatedOptions:Object.assign({},r,{tracingOptions:Object.assign(Object.assign({},null==r?void 0:r.tracingOptions),{tracingContext:l})})}}function o(e,t,...n){return tt().withContext(e,t,...n)}return{startSpan:r,withSpan:async function(e,t,n,i){const{span:a,updatedOptions:s}=r(e,t,i);try{const e=await o(s.tracingOptions.tracingContext,(()=>Promise.resolve(n(s,a))));return a.setStatus({status:"success"}),e}catch(e){throw a.setStatus({status:"error",error:e}),e}finally{a.end()}},withContext:o,parseTraceparentHeader:function(e){return tt().parseTraceparentHeader(e)},createRequestHeaders:function(e){return tt().createRequestHeaders(e)}}}({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:ye})}catch(e){return void K.warning(`Error when creating the TracingClient: ${Y(e)}`)}}();return{name:ot,async sendRequest(e,r){var o,a;if(!i||!(null===(o=e.tracingOptions)||void 0===o?void 0:o.tracingContext))return r(e);const s=await t,l={"http.url":n.sanitizeUrl(e.url),"http.method":e.method,"http.user_agent":s,requestId:e.requestId};s&&(l["http.user_agent"]=s);const{span:u,tracingContext:d}=null!==(a=function(e,t,n){try{const{span:i,updatedOptions:r}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:n});if(!i.isRecording())return void i.end();const o=e.createRequestHeaders(r.tracingOptions.tracingContext);for(const[e,n]of Object.entries(o))t.headers.set(e,n);return{span:i,tracingContext:r.tracingOptions.tracingContext}}catch(e){return void K.warning(`Skipping creating a tracing span due to an error: ${Y(e)}`)}}(i,e,l))&&void 0!==a?a:{};if(!u||!d)return r(e);try{const t=await i.withContext(d,r,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);const n=t.headers.get("x-ms-request-id");n&&e.setAttribute("serviceRequestId",n),e.setStatus({status:"success"}),e.end()}catch(e){K.warning(`Skipping tracing span processing due to an error: ${Y(e)}`)}}(u,t),t}catch(e){throw function(e,t){try{e.setStatus({status:"error",error:J(t)?t:void 0}),((n=t)instanceof rt||J(n)&&"RestError"===n.name)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(n){K.warning(`Skipping tracing span processing due to an error: ${Y(n)}`)}var n}(u,e),e}}}}(Object.assign(Object.assign({},e.userAgentOptions),e.loggingOptions)),{afterPhase:"Retry"}),ue&&n.addPolicy(me(e.redirectOptions),{afterPhase:"Retry"}),n.addPolicy(function(e={}){var t;const n=null!==(t=e.logger)&&void 0!==t?t:K.info,i=new ge({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:"logPolicy",async sendRequest(e,t){if(!n.enabled)return t(e);n(`Request: ${i.sanitize(e)}`);const r=await t(e);return n(`Response status code: ${r.status}`),n(`Headers: ${i.sanitize(r.headers)}`),r}}}(e.loggingOptions),{afterPhase:"Sign"}),n}class st{async sendRequest(e){if("https:"!==new URL(e.url).protocol&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);if(e.proxySettings)throw new Error("HTTP proxy is not supported in browser environment");try{return await async function(e){const{abortController:t,abortControllerCleanup:n}=function(e){const t=new AbortController;let n,i;if(e.abortSignal){if(e.abortSignal.aborted)throw new $("The operation was aborted.");i=e=>{"abort"===e.type&&t.abort()},e.abortSignal.addEventListener("abort",i),n=()=>{var t;i&&(null===(t=e.abortSignal)||void 0===t||t.removeEventListener("abort",i))}}return e.timeout>0&&setTimeout((()=>{t.abort()}),e.timeout),{abortController:t,abortControllerCleanup:n}}(e);try{const i=function(e){const t=new Headers;for(const[n,i]of e)t.append(n,i);return t}(e.headers),{streaming:r,body:o}=function(e){const t="function"==typeof e.body?e.body():e.body;if(we(t))throw new Error("Node streams are not supported in browser environment.");return Ee(t)?{streaming:!0,body:lt(t,{onProgress:e.onUploadProgress})}:{streaming:!1,body:t}}(e),a=Object.assign(Object.assign({body:o,method:e.method,headers:i,signal:t.signal},"credentials"in Request.prototype?{credentials:e.withCredentials?"include":"same-origin"}:{}),"cache"in Request.prototype?{cache:"no-store"}:{});r&&(a.duplex="half");const s=await fetch(e.url,a);return function(e){return("function"==typeof Blob||"object"==typeof Blob)&&e instanceof Blob}(e.body)&&e.onUploadProgress&&e.onUploadProgress({loadedBytes:e.body.size}),async function(e,t,n){var i,r;const o=function(e){const t=Ke();for(const[n,i]of e.headers)t.set(n,i);return t}(e),a={request:t,headers:o,status:e.status},s=Ee(e.body)?lt(e.body,{onProgress:t.onDownloadProgress,onEnd:n}):e.body;if((null===(i=t.streamResponseStatusCodes)||void 0===i?void 0:i.has(Number.POSITIVE_INFINITY))||(null===(r=t.streamResponseStatusCodes)||void 0===r?void 0:r.has(a.status)))if(t.enableBrowserStreams)a.browserStreamBody=null!=s?s:void 0;else{const e=new Response(s);a.blobBody=e.blob(),null==n||n()}else{const e=new Response(s);a.bodyAsText=await e.text(),null==n||n()}return a}(s,e,n)}catch(e){throw null==n||n(),e}}(e)}catch(t){throw function(e,t){var n;return e&&"AbortError"===(null==e?void 0:e.name)?e:new rt(`Error sending request: ${e.message}`,{code:null!==(n=null==e?void 0:e.code)&&void 0!==n?n:rt.REQUEST_SEND_ERROR,request:t})}(t,e)}}}function lt(e,t={}){let n=0;const{onProgress:i,onEnd:r}=t;if(function(e){return void 0!==e.pipeThrough&&void 0!==self.TransformStream}(e))return e.pipeThrough(new TransformStream({transform(e,t){null!==e?(t.enqueue(e),n+=e.length,i&&i({loadedBytes:n})):t.terminate()},flush(){null==r||r()}}));{const t=e.getReader();return new ReadableStream({async pull(e){var o;const{done:a,value:s}=await t.read();if(a||!s)return null==r||r(),e.close(),void t.releaseLock();n+=null!==(o=null==s?void 0:s.length)&&void 0!==o?o:0,e.enqueue(s),i&&i({loadedBytes:n})},cancel:e=>(null==r||r(),t.cancel(e))})}}class ut{constructor(e){var t,n,i,r,o,a,s;this.url=e.url,this.body=e.body,this.headers=null!==(t=e.headers)&&void 0!==t?t:Ke(),this.method=null!==(n=e.method)&&void 0!==n?n:"GET",this.timeout=null!==(i=e.timeout)&&void 0!==i?i:0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=null!==(r=e.disableKeepAlive)&&void 0!==r&&r,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=null!==(o=e.withCredentials)&&void 0!==o&&o,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||re(),this.allowInsecureConnection=null!==(a=e.allowInsecureConnection)&&void 0!==a&&a,this.enableBrowserStreams=null!==(s=e.enableBrowserStreams)&&void 0!==s&&s}}const dt={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};const ct="bearerTokenAuthenticationPolicy";async function ht(e){const{scopes:t,getAccessToken:n,request:i}=e,r={abortSignal:i.abortSignal,tracingOptions:i.tracingOptions},o=await n(t,r);o&&e.request.headers.set("Authorization",`Bearer ${o.token}`)}function gt(e){var t;const{credential:n,scopes:i,challengeCallbacks:r}=e,o=e.logger||K,a=Object.assign({authorizeRequest:null!==(t=null==r?void 0:r.authorizeRequest)&&void 0!==t?t:ht,authorizeRequestOnChallenge:null==r?void 0:r.authorizeRequestOnChallenge},r),s=n?function(e,t){let n,i=null,r=null;const o=Object.assign(Object.assign({},dt),t),a={get isRefreshing(){return null!==i},get shouldRefresh(){var e;return!a.isRefreshing&&(null!==(e=null==r?void 0:r.expiresOnTimestamp)&&void 0!==e?e:0)-o.refreshWindowInMs<Date.now()},get mustRefresh(){return null===r||r.expiresOnTimestamp-o.forcedRefreshWindowInMs<Date.now()}};function s(t,s){var l;return a.isRefreshing||(i=async function(e,t,n){async function i(){if(!(Date.now()<n)){const t=await e();if(null===t)throw new Error("Failed to refresh access token.");return t}try{return await e()}catch(e){return null}}let r=await i();for(;null===r;)await Be(t),r=await i();return r}((()=>e.getToken(t,s)),o.retryIntervalInMs,null!==(l=null==r?void 0:r.expiresOnTimestamp)&&void 0!==l?l:Date.now()).then((e=>(i=null,r=e,n=s.tenantId,r))).catch((e=>{throw i=null,r=null,n=void 0,e}))),i}return async(e,t)=>{const i=Boolean(t.claims),o=n!==t.tenantId;return i&&(r=null),o||i||a.mustRefresh?s(e,t):(a.shouldRefresh&&s(e,t),r)}}(n):()=>Promise.resolve(null);return{name:ct,async sendRequest(e,t){if(!e.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");let n,r;await a.authorizeRequest({scopes:Array.isArray(i)?i:[i],request:e,getAccessToken:s,logger:o});try{n=await t(e)}catch(e){r=e,n=e.response}if(a.authorizeRequestOnChallenge&&401===(null==n?void 0:n.status)&&function(e){const t=e.headers.get("WWW-Authenticate");if(401===e.status&&t)return t}(n)&&await a.authorizeRequestOnChallenge({scopes:Array.isArray(i)?i:[i],request:e,response:n,getAccessToken:s,logger:o}))return t(e);if(r)throw r;return n}}}const pt={operationRequestMap:new WeakMap};function ft(e,t,n){let i=t.parameterPath;const r=t.mapper;let o;if("string"==typeof i&&(i=[i]),Array.isArray(i)){if(i.length>0)if(r.isConstant)o=r.defaultValue;else{let t=mt(e,i);!t.propertyFound&&n&&(t=mt(n,i));let a=!1;t.propertyFound||(a=r.required||"options"===i[0]&&2===i.length),o=a?r.defaultValue:t.propertyValue}}else{r.required&&(o={});for(const t in i){const a=r.type.modelProperties[t],s=ft(e,{parameterPath:i[t],mapper:a},n);void 0!==s&&(o||(o={}),o[t]=s)}}return o}function mt(e,t){const n={propertyFound:!1};let i=0;for(;i<t.length;++i){const n=t[i];if(!e||!(n in e))break;e=e[n]}return i===t.length&&(n.propertyValue=e,n.propertyFound=!0),n}const vt=Symbol.for("@azure/core-client original request");function yt(e){if(function(e){return vt in e}(e))return yt(e[vt]);let t=pt.operationRequestMap.get(e);return t||(t={},pt.operationRequestMap.set(e,t)),t}const _t=["application/json","text/json"],bt=["application/xml","application/atom+xml"];function Ct(e){const{parameterPath:t,mapper:n}=e;let i;return i="string"==typeof t?t:Array.isArray(t)?t.join("."):n.serializedName,i}let Tt;const St={CSV:",",SSV:" ",Multi:"Multi",TSV:"\t",Pipes:"|"};function It(e,t,n,i){const r=function(e,t,n){var i;const r=new Map;if(null===(i=e.urlParameters)||void 0===i?void 0:i.length)for(const i of e.urlParameters){let o=ft(t,i,n);const a=Ct(i);o=e.serializer.serialize(i.mapper,o,a),i.skipEncoding||(o=encodeURIComponent(o)),r.set(`{${i.mapper.serializedName||a}}`,o)}return r}(t,n,i);let o=!1,a=wt(e,r);if(t.path){let e=wt(t.path,r);"/{nextLink}"===t.path&&e.startsWith("/")&&(e=e.substring(1)),e.includes("://")?(a=e,o=!0):a=function(e,t){if(!t)return e;const n=new URL(e);let i=n.pathname;i.endsWith("/")||(i=`${i}/`),t.startsWith("/")&&(t=t.substring(1));const r=t.indexOf("?");if(-1!==r){const e=t.substring(0,r),o=t.substring(r+1);i+=e,o&&(n.search=n.search?`${n.search}&${o}`:o)}else i+=t;return n.pathname=i,n.toString()}(a,e)}const{queryParams:s,sequenceParams:l}=function(e,t,n){var i;const r=new Map,o=new Set;if(null===(i=e.queryParameters)||void 0===i?void 0:i.length)for(const i of e.queryParameters){"Sequence"===i.mapper.type.name&&i.mapper.serializedName&&o.add(i.mapper.serializedName);let a=ft(t,i,n);if(null!=a||i.mapper.required){a=e.serializer.serialize(i.mapper,a,Ct(i));const t=i.collectionFormat?St[i.collectionFormat]:"";if(Array.isArray(a)&&(a=a.map((e=>null==e?"":e))),"Multi"===i.collectionFormat&&0===a.length)continue;!Array.isArray(a)||"SSV"!==i.collectionFormat&&"TSV"!==i.collectionFormat||(a=a.join(t)),i.skipEncoding||(a=Array.isArray(a)?a.map((e=>encodeURIComponent(e))):encodeURIComponent(a)),!Array.isArray(a)||"CSV"!==i.collectionFormat&&"Pipes"!==i.collectionFormat||(a=a.join(t)),r.set(i.mapper.serializedName||Ct(i),a)}}return{queryParams:r,sequenceParams:o}}(t,n,i);return a=function(e,t,n,i=!1){if(0===t.size)return e;const r=new URL(e),o=function(e){const t=new Map;if(!e||"?"!==e[0])return t;const n=(e=e.slice(1)).split("&");for(const e of n){const[n,i]=e.split("=",2),r=t.get(n);r?Array.isArray(r)?r.push(i):t.set(n,[r,i]):t.set(n,i)}return t}(r.search);for(const[e,r]of t){const t=o.get(e);if(Array.isArray(t))if(Array.isArray(r)){t.push(...r);const n=new Set(t);o.set(e,Array.from(n))}else t.push(r);else t?(Array.isArray(r)?r.unshift(t):n.has(e)&&o.set(e,[t,r]),i||o.set(e,r)):o.set(e,r)}const a=[];for(const[e,t]of o)if("string"==typeof t)a.push(`${e}=${t}`);else if(Array.isArray(t))for(const n of t)a.push(`${e}=${n}`);else a.push(`${e}=${t}`);return r.search=a.length?`?${a.join("&")}`:"",r.toString()}(a,s,l,o),a}function wt(e,t){let n=e;for(const[e,i]of t)n=n.split(e).join(i);return n}const Et=z("core-client");class xt{constructor(e={}){var t,n;if(this._requestContentType=e.requestContentType,this._endpoint=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri,e.baseUri&&Et.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||(Tt||(Tt=new st),Tt),this.pipeline=e.pipeline||function(e){const t=function(e){if(e.credentialScopes)return e.credentialScopes;if(e.endpoint)return`${e.endpoint}/.default`;if(e.baseUri)return`${e.baseUri}/.default`;if(e.credential&&!e.credentialScopes)throw new Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}(e),n=e.credential&&t?{credentialScopes:t,credential:e.credential}:void 0;return function(e={}){const t=at(null!=e?e:{});return e.credentialOptions&&t.addPolicy(gt({credential:e.credentialOptions.credential,scopes:e.credentialOptions.credentialScopes})),t.addPolicy(function(e={}){const t=e.stringifyXML;return{name:"serializationPolicy",async sendRequest(e,n){const i=yt(e),r=null==i?void 0:i.operationSpec,o=null==i?void 0:i.operationArguments;return r&&o&&(function(e,t,n){var i,r;if(n.headerParameters)for(const i of n.headerParameters){let r=ft(t,i);if(null!=r||i.mapper.required){r=n.serializer.serialize(i.mapper,r,Ct(i));const t=i.mapper.headerCollectionPrefix;if(t)for(const n of Object.keys(r))e.headers.set(t+n,r[n]);else e.headers.set(i.mapper.serializedName||Ct(i),r)}}const o=null===(r=null===(i=t.options)||void 0===i?void 0:i.requestOptions)||void 0===r?void 0:r.customHeaders;if(o)for(const t of Object.keys(o))e.headers.set(t,o[t])}(e,o,r),function(e,t,n,i=function(){throw new Error("XML serialization unsupported!")}){var r,o,l,u,d;const c=null===(r=t.options)||void 0===r?void 0:r.serializerOptions,h={xml:{rootName:null!==(o=null==c?void 0:c.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(l=null==c?void 0:c.xml.includeRoot)&&void 0!==l&&l,xmlCharKey:null!==(u=null==c?void 0:c.xml.xmlCharKey)&&void 0!==u?u:s}},g=h.xml.xmlCharKey;if(n.requestBody&&n.requestBody.mapper){e.body=ft(t,n.requestBody);const r=n.requestBody.mapper,{required:o,serializedName:s,xmlName:l,xmlElementName:u,xmlNamespace:c,xmlNamespacePrefix:p,nullable:f}=r,m=r.type.name;try{if(void 0!==e.body&&null!==e.body||f&&null===e.body||o){const t=Ct(n.requestBody);e.body=n.serializer.serialize(r,e.body,t,h);const o=m===T;if(n.isXML){const t=p?`xmlns:${p}`:"xmlns",n=function(e,t,n,i,r){if(e&&!["Composite","Sequence","Dictionary"].includes(n)){const n={};return n[r.xml.xmlCharKey]=i,n[a]={[t]:e},n}return i}(c,t,m,e.body,h);m===b?e.body=i(function(e,t,n,i){if(Array.isArray(e)||(e=[e]),!n||!i)return{[t]:e};const r={[t]:e};return r[a]={[n]:i},r}(n,u||l||s,t,c),{rootName:l||s,xmlCharKey:g}):o||(e.body=i(n,{rootName:l||s,xmlCharKey:g}))}else{if(m===C&&((null===(d=n.contentType)||void 0===d?void 0:d.match("text/plain"))||"text"===n.mediaType))return;o||(e.body=JSON.stringify(e.body))}}}catch(e){throw new Error(`Error "${e.message}" occurred in serializing the payload - ${JSON.stringify(s,void 0,"  ")}.`)}}else if(n.formDataParameters&&n.formDataParameters.length>0){e.formData={};for(const i of n.formDataParameters){const r=ft(t,i);if(null!=r){const t=i.mapper.serializedName||Ct(i);e.formData[t]=n.serializer.serialize(i.mapper,r,Ct(i),h)}}}}(e,o,r,t)),n(e)}}}(e.serializationOptions),{phase:"Serialize"}),t.addPolicy(function(e={}){var t,n,i,r,o,a,l;const u=null!==(n=null===(t=e.expectedContentTypes)||void 0===t?void 0:t.json)&&void 0!==n?n:_t,d=null!==(r=null===(i=e.expectedContentTypes)||void 0===i?void 0:i.xml)&&void 0!==r?r:bt,c=e.parseXML,h=e.serializerOptions,g={xml:{rootName:null!==(o=null==h?void 0:h.xml.rootName)&&void 0!==o?o:"",includeRoot:null!==(a=null==h?void 0:h.xml.includeRoot)&&void 0!==a&&a,xmlCharKey:null!==(l=null==h?void 0:h.xml.xmlCharKey)&&void 0!==l?l:s}};return{name:"deserializationPolicy",async sendRequest(e,t){const n=await t(e);return async function(e,t,n,i,r){const o=await async function(e,t,n,i,r){var o;if(!(null===(o=n.request.streamResponseStatusCodes)||void 0===o?void 0:o.has(n.status))&&n.bodyAsText){const o=n.bodyAsText,a=n.headers.get("Content-Type")||"",s=a?a.split(";").map((e=>e.toLowerCase())):[];try{if(0===s.length||s.some((t=>-1!==e.indexOf(t))))return n.parsedBody=JSON.parse(o),n;if(s.some((e=>-1!==t.indexOf(e)))){if(!r)throw new Error("Parsing XML not supported.");const e=await r(o,i.xml);return n.parsedBody=e,n}}catch(e){const t=`Error "${e}" occurred while parsing the response body - ${n.bodyAsText}.`,i=e.code||rt.PARSE_ERROR;throw new rt(t,{code:i,statusCode:n.status,request:n.request,response:n})}}return n}(e,t,n,i,r);if(!function(e){const t=yt(e.request),n=null==t?void 0:t.shouldDeserialize;let i;return i=void 0===n||("boolean"==typeof n?n:n(e)),i}(o))return o;const a=yt(o.request),s=null==a?void 0:a.operationSpec;if(!s||!s.responses)return o;const l=function(e){let t;const n=yt(e.request),i=null==n?void 0:n.operationSpec;return i&&(t=(null==n?void 0:n.operationResponseGetter)?null==n?void 0:n.operationResponseGetter(i,e):i.responses[e.status]),t}(o),{error:u,shouldReturnResponse:d}=function(e,t,n,i){var r;const o=200<=e.status&&e.status<300,a=function(e){const t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?o:!!n;if(a){if(!n)return{error:null,shouldReturnResponse:!1};if(!n.isError)return{error:null,shouldReturnResponse:!1}}const s=null!=n?n:t.responses.default,l=(null===(r=e.request.streamResponseStatusCodes)||void 0===r?void 0:r.has(e.status))?`Unexpected status code: ${e.status}`:e.bodyAsText,u=new rt(l,{statusCode:e.status,request:e.request,response:e});if(!s)throw u;const d=s.bodyMapper,c=s.headersMapper;try{if(e.parsedBody){const n=e.parsedBody;let r;if(d){let e=n;if(t.isXML&&d.type.name===b){e=[];const t=d.xmlElementName;"object"==typeof n&&t&&(e=n[t])}r=t.serializer.deserialize(d,e,"error.response.parsedBody",i)}const o=n.error||r||n;u.code=o.code,o.message&&(u.message=o.message),d&&(u.response.parsedBody=r)}e.headers&&c&&(u.response.parsedHeaders=t.serializer.deserialize(c,e.headers.toJSON(),"operationRes.parsedHeaders"))}catch(t){u.message=`Error "${t.message}" occurred in deserializing the responseBody - "${e.bodyAsText}" for the default response.`}return{error:u,shouldReturnResponse:!1}}(o,s,l,i);if(u)throw u;if(d)return o;if(l){if(l.bodyMapper){let e=o.parsedBody;s.isXML&&l.bodyMapper.type.name===b&&(e="object"==typeof e?e[l.bodyMapper.xmlElementName]:[]);try{o.parsedBody=s.serializer.deserialize(l.bodyMapper,e,"operationRes.parsedBody",i)}catch(e){throw new rt(`Error ${e} occurred in deserializing the responseBody - ${o.bodyAsText}`,{statusCode:o.status,request:o.request,response:o})}}else"HEAD"===s.httpMethod&&(o.parsedBody=n.status>=200&&n.status<300);l.headersMapper&&(o.parsedHeaders=s.serializer.deserialize(l.headersMapper,o.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return o}(u,d,n,g,c)}}}(e.deserializationOptions),{phase:"Deserialize"}),t}(Object.assign(Object.assign({},e),{credentialOptions:n}))}(e),null===(n=e.additionalPolicies)||void 0===n?void 0:n.length)for(const{policy:t,position:n}of e.additionalPolicies){const e="perRetry"===n?"Sign":void 0;this.pipeline.addPolicy(t,{afterPhase:e})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){const n=t.baseUrl||this._endpoint;if(!n)throw new Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");const i=function(e){return new ut(e)}({url:It(n,t,e,this)});i.method=t.httpMethod;const r=yt(i);r.operationSpec=t,r.operationArguments=e;const o=t.contentType||this._requestContentType;o&&t.requestBody&&i.headers.set("Content-Type",o);const a=e.options;if(a){const e=a.requestOptions;e&&(e.timeout&&(i.timeout=e.timeout),e.onUploadProgress&&(i.onUploadProgress=e.onUploadProgress),e.onDownloadProgress&&(i.onDownloadProgress=e.onDownloadProgress),void 0!==e.shouldDeserialize&&(r.shouldDeserialize=e.shouldDeserialize),e.allowInsecureConnection&&(i.allowInsecureConnection=!0)),a.abortSignal&&(i.abortSignal=a.abortSignal),a.tracingOptions&&(i.tracingOptions=a.tracingOptions)}this._allowInsecureConnection&&(i.allowInsecureConnection=!0),void 0===i.streamResponseStatusCodes&&(i.streamResponseStatusCodes=function(e){const t=new Set;for(const n in e.responses){const i=e.responses[n];i.bodyMapper&&i.bodyMapper.type.name===T&&t.add(Number(n))}return t}(t));try{const e=await this.sendRequest(i),n=d(e,t.responses[e.status]);return(null==a?void 0:a.onResponse)&&a.onResponse(e,n),n}catch(e){if("object"==typeof e&&(null==e?void 0:e.response)){const n=e.response,i=d(n,t.responses[e.statusCode]||t.responses.default);e.details=i,(null==a?void 0:a.onResponse)&&a.onResponse(n,i,e)}throw e}}}async function At(e){const{scopes:t,response:n}=e,i=e.logger||Et,r=n.headers.get("WWW-Authenticate");if(!r)return i.info("The WWW-Authenticate header was missing. Failed to perform the Continuous Access Evaluation authentication flow."),!1;const o=function(e){return`, ${e.trim()}`.split(", Bearer ").filter((e=>e)).map((e=>`${e.trim()}, `.split('", ').filter((e=>e)).map((e=>(([e,t])=>({[e]:t}))(e.trim().split('="')))).reduce(((e,t)=>Object.assign(Object.assign({},e),t)),{})))}(r)||[],a=o.find((e=>e.claims));if(!a)return i.info('The WWW-Authenticate header was missing the necessary "claims" to perform the Continuous Access Evaluation authentication flow.'),!1;const s=await e.getAccessToken(a.scope?[a.scope]:t,{claims:(l=a.claims,atob(l))});var l;return!!s&&(e.request.headers.set("Authorization",`Bearer ${s.token}`),!0)}const Dt="Composite",Nt="String",Ft="Number",Pt="Sequence",kt={xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}};function Ot(e){const t={};for(const o of e)t[(r=o[0],r.charAt(0).toLowerCase()+r.slice(1))]=(n=o[0],i=o[1],{serializedName:n,required:o[2],defaultValue:o[3],type:{name:i}});var n,i,r;return t}function Bt(e,t){return{type:{name:Dt,className:e,modelProperties:t}}}const Rt=Bt("CommonAppIdProperty",Ot([["AppId",Nt]])),Lt=Bt("CommonResponseStatusProperty",Ot([["ResponseStatus",Ft,!1,0]])),Mt=Bt("CommonRequestIdProperty",Ot([["RequestId",Nt]])),qt=Bt("TileContent",Object.assign(Object.assign({},Ot([["TileId",Nt,!0],["RevisionId",Nt,!0]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},tileElements:{serializedName:"TileElements",type:{name:Pt,element:{type:{name:Dt,className:"TileElement"}}}}})),Ut=Bt("CommonLanguageIdProperty",Ot([["LanguageId",Nt]])),Wt=Bt("CommonTextUnitProperty",Ot([["TextUnit",Ft]])),jt=Bt("TopologyNode",Object.assign(Object.assign({},Ot([["Id",Nt,!0],["RevisionId",Nt,!0],["Type",Ft,!0],["NumberOfChildren",Ft],["AreChildsOrdered","Boolean",void 0,!1]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},children:{serializedName:"Children",type:{name:Pt,element:{type:{name:Dt,className:"TopologyNode"}}}}})),zt=Bt("CommonDescriptorsProperty",{descriptors:{serializedName:"Descriptors",type:{name:Pt,element:{type:{name:Dt,className:"Descriptor"}}}}}),Ht=Bt("Descriptor",Ot([["Name",Nt,!0],["Value",Nt,!0]])),Vt=Bt("CommonLanguageUXIdProperty",Ot([["LanguageUXId",Nt]])),Gt=Bt("CommonRunOnProfileIdProperty",Ot([["RunOnProfileId","Uuid"]])),Qt=Bt("CommonOverriddenCritiqueTypeOptions",{overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:Pt,element:{type:{name:Dt,className:"CritiqueTypeOption"}}}}}),Kt=Bt("Suggestion",Ot([["Text",Nt,!0],["Description",Nt],["ConfidenceLevel",Ft],["Source",Ft],["Action",Ft,!0],["BucketId",Ft],["NumberOfInstances",Ft]])),$t=Bt("CommonCritique",Object.assign(Object.assign({},Ot([["TraceId","Uuid"],["TypeId","Uuid"],["CategoryTitle",Nt],["Context",Nt],["Start",Ft,void 0,0],["StartInContext",Ft,void 0,0],["Length",Ft,void 0,0],["LanguageId",Nt],["Priority",Ft]])),{metadata:{serializedName:"Metadata",type:{name:Pt,element:{type:{name:Dt,className:"Metadatum"}}}}})),Zt=Bt("Metadatum",Ot([["Name",Nt,!0],["Value",Nt,!0]])),Jt=Bt("CommonTileIdProperty",Ot([["TileId",Nt]])),Yt=Bt("CommonRevisionIdProperty",Ot([["RevisionId",Nt]])),Xt=Bt("SupportedActions",Ot([["SupportedActions",Ft]])),en=Bt("CommonAppVersionProperty",Ot([["AppVersion",Nt]])),tn=Bt("CritiqueCategoryInfo",Object.assign(Object.assign({},Ot([["Id","Uuid",!0],["Name",Nt,!0],["Priority",Ft]])),{critiqueTypeInfoList:{serializedName:"CritiqueTypeInfoList",type:{name:Pt,element:{type:{name:Dt,className:"CritiqueTypeInfo"}}}}})),nn=Bt("CritiqueTypeInfo",Object.assign(Object.assign({},Ot([["Id","Uuid",!0],["Name",Nt,!0],["IsBinaryCritiqueType","Boolean"],["DefaultCritiqueValue",Ft,!0],["CritiquePriority",Ft],["CritiqueTag",Nt]])),{critiqueTypeValues:{serializedName:"CritiqueTypeValues",type:{name:Pt,element:{type:{name:Nt}}}}})),rn=Bt("UserIdentity",Ot([["IdentityProvider",Ft,!0],["Puid",Nt,!0],["TenantId",Nt],["Cid",Nt]])),on=Bt("BrowserExtensionRequestV1",Object.assign(Object.assign({},Rt.type.modelProperties),Ot([["Browser",Nt],["BrowserVersion",Nt],["ClientId",Nt],["Email",Nt],["ExtensionId",Nt],["FirstInstallVersion",Nt],["LanguageId",Nt],["LanguageUxId",Nt],["LicenseType",Nt],["StoreId",Nt],["TenantId",Nt]]))),an=Bt("TileCheckRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Rt.type.modelProperties),zt.type.modelProperties),Vt.type.modelProperties),Gt.type.modelProperties),Qt.type.modelProperties),Ot([["SessionId",Nt,!0],["RequestOrderInSession",Ft]])),{content:{serializedName:"Content",type:{name:Pt,element:{type:{name:Dt,className:"TileContent"}}}},topology:{serializedName:"Topology",type:{name:Dt,className:"TopologyNode"}}})),sn=Bt("ConfigRequestV2",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Rt.type.modelProperties),en.type.modelProperties),zt.type.modelProperties),Ut.type.modelProperties),Vt.type.modelProperties),Gt.type.modelProperties)),ln=Bt("LanguageInfoRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Rt.type.modelProperties),zt.type.modelProperties),Ut.type.modelProperties),Vt.type.modelProperties),Gt.type.modelProperties)),un=Bt("InstrumentationRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Rt.type.modelProperties),Ut.type.modelProperties),zt.type.modelProperties),Ot([["TraceId","Uuid",!0],["CritiqueGenerationTime",Ft],["CritiquePriority",Ft,!0],["CritiqueTypeId","Uuid",!0],["EventId",Ft,!0],["OriginalText",Nt],["PreContextBegin",Ft],["PostContextEnd",Ft],["SubstrateEventName",Nt]])),{flaggedText:{constraints:{MaxLength:2e4,MinLength:1},serializedName:"FlaggedText",required:!0,type:{name:Nt}},metadata:{serializedName:"Metadata",type:{name:Pt,element:{type:{name:Dt,className:"Metadatum"}}}},substrateEventCustomFields:{serializedName:"SubstrateEventCustomFields",type:{name:"Dictionary",value:{type:{name:"any"}}}},suggestions:{serializedName:"Suggestions",type:{name:Pt,element:{type:{name:Nt}}}},suggestionText:{constraints:{MaxLength:2e4},serializedName:"SuggestionText",type:{name:Nt}}})),dn=Bt("BrowserExtensionResponseV1",Object.assign(Object.assign(Object.assign(Object.assign({},Lt.type.modelProperties),Mt.type.modelProperties),Ot([["UseTileCheck","Boolean",void 0,!1],["Descriptors",Nt],["StyleObserverIntervalTime",Ft,void 0,0],["StyleSampleTime",Ft,void 0,0],["RootContentMaxLengthInChars",Ft,void 0,2e3],["SchedulerDefaultWaitingTime",Ft,void 0,0],["SchedulerDefaultWaitingTimeIncrement",Ft,void 0,0],["SchedulerDefaultMaxTime",Ft,void 0,0],["RefreshCritiqueWaitingTime",Ft,void 0,0],["RequestCritiqueDelay",Ft,void 0,0],["EnableDirtyRangeAutoRehydration","Boolean",void 0,!1],["TelemetryTenant",Nt],["LogGroupName",Nt],["SendToAria","Boolean",void 0,!1],["IntervalForActivityCleanup",Ft,void 0,0],["MaxAllowedTimeForActivities",Ft,void 0,0],["CalloutHoverTimeout",Ft,void 0,0],["MaxSuggestionItemsDisplayNumber",Ft,void 0,0],["EditorClientState",Ft],["ConfigurationId",Nt]])),{disabledWebSites:{serializedName:"DisabledWebSites",type:{name:Pt,element:{type:{name:Nt}}}},allowedUrls:{serializedName:"AllowedUrls",type:{name:Pt,element:{type:{name:Nt}}}},disabledGrammars:{serializedName:"DisabledGrammars",type:{name:Pt,element:{type:{name:Nt}}}},versionEmergencyOverrides:{serializedName:"VersionEmergencyOverrides",type:{name:"Dictionary",value:{type:{name:Nt}}}},featureFlags:{serializedName:"FeatureFlags",type:{name:"Dictionary",value:{type:{name:Nt}}}},dynamicSettings:{serializedName:"DynamicSettings",type:{name:"Dictionary",value:{type:{name:"any"}}}},spellCheckAttributes:{serializedName:"SpellCheckAttributes",type:{name:Pt,element:{type:{name:Nt}}}},conflictingElements:{serializedName:"ConflictingElements",type:{name:Pt,element:{type:{name:Nt}}}},editorCanvas:{serializedName:"EditorCanvas",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),cn=Bt("TileCheckResponseV1",Object.assign(Object.assign({},Lt.type.modelProperties),{critiques:{serializedName:"Critiques",type:{name:Pt,element:{type:{name:Dt,className:"TileCheckCritique"}}}}})),hn=Bt("ConfigResponseV2",Object.assign(Object.assign({},Lt.type.modelProperties),{critiqueCategoryInfoList:{serializedName:"CritiqueCategoryInfoList",required:!0,type:{name:Pt,element:{type:{name:Dt,className:"CritiqueCategoryInfo"}}}}})),gn=Bt("LanguageInfoResponseV1",Object.assign(Object.assign({},Lt.type.modelProperties),{supportedLanguages:{serializedName:"SupportedLanguages",required:!0,type:{name:Pt,element:{type:{name:Dt,className:"SupportedLanguage"}}}}})),pn=Bt("TileCheckSpan",Object.assign(Object.assign(Object.assign({},Ut.type.modelProperties),Ot([["Start",Ft,void 0,0],["Length",Ft,void 0,"tileElement.Text.Length - span.Start"],["DoNotCheck","Boolean"]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),fn=Bt("TileElement",Object.assign(Object.assign(Object.assign(Object.assign({},Ut.type.modelProperties),Wt.type.modelProperties),Ot([["Text",Nt,!0],["IsClean","Boolean"]])),{enabledLanguages:{serializedName:"EnabledLanguages",type:{name:Pt,element:{type:{name:Pt,element:{type:{name:Dt,className:"CommonLanguageIdProperty"}}}}}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},spans:{serializedName:"Spans",type:{name:Pt,element:{type:{name:Dt,className:"TileCheckSpan"}}}}})),mn=Bt("CritiqueTypeOption",Object.assign(Object.assign({},Ut.type.modelProperties),Ot([["Id","Uuid",!0],["Name",Nt],["TypeName",Nt],["Value",Nt,!0]]))),vn=Bt("SupportedLanguage",Object.assign(Object.assign(Object.assign({},Ut.type.modelProperties),Wt.type.modelProperties),Ot([["SupportedCritiqueTag",Nt]]))),yn=Bt("TileCheckCritique",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},$t.type.modelProperties),Jt.type.modelProperties),Yt.type.modelProperties),Xt.type.modelProperties),Ot([["BucketId",Ft],["ExplanationTitle",Nt],["ExplanationLabel",Nt],["Explanation",Nt],["Status",Ft],["Tag",Ft]])),{suggestions:{serializedName:"Suggestions",type:{name:Pt,element:{type:{name:Dt,className:"Suggestion"}}}}})),_n=Bt("EditorServicePostTileCheckHeaders",kt),bn=Bt("EditorServiceConfigV2Headers",kt),Cn=Bt("EditorServiceLanguageinfoHeaders",kt),Tn=Bt("EditorServiceInstrumentationHeaders",kt),Sn={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},In={parameterPath:"body",mapper:on},wn={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},En={parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},xn={parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}},An={parameterPath:"body",mapper:un};class Dn extends xt{constructor(e){var t,n;e||(e={});const i="@editor/client-rest-api/2.0.0",r=e.userAgentOptions&&e.userAgentOptions.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${i}`:`${i}`,o=Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),e),{userAgentOptions:{userAgentPrefix:r},baseUri:null!==(n=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri)&&void 0!==n?n:"https://nleditor.osi.officeppe.net/NLEditor"});super(o);let a=!1;(null==e?void 0:e.pipeline)&&e.pipeline.getOrderedPolicies().length>0&&(a=e.pipeline.getOrderedPolicies().some((e=>e.name===ct))),e&&e.pipeline&&0!=e.pipeline.getOrderedPolicies().length&&a||(this.pipeline.removePolicy({name:ct}),this.pipeline.addPolicy(gt({credential:null==e?void 0:e.credential,scopes:`${o.credentialScopes}`,challengeCallbacks:{authorizeRequestOnChallenge:At}}))),this.pipeline.removePolicy({name:Ze}),this.pipeline.removePolicy({name:Te}),this.$host=e.$host||"https://nleditor.osi.officeppe.net/NLEditor"}}class Nn extends Dn{browserextension(e,t){return this.sendOperationRequest({body:e,options:t},kn)}}class Fn extends Dn{instrumentation(e,t){return this.sendOperationRequest({body:e,options:t},On)}}const Pn=function(e={},t=!1){return new c(e,t)}(i,!1),kn={path:"/api/V1/BrowserExtension",httpMethod:"POST",responses:{200:{bodyMapper:dn},400:{},500:{}},requestBody:In,urlParameters:[wn],headerParameters:[Sn,{parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},En,xn,{parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}}],mediaType:"json",serializer:Pn},On={path:"/api/V1/Instrumentation",httpMethod:"POST",responses:{200:{headersMapper:Tn},400:{},500:{}},requestBody:An,urlParameters:[wn],headerParameters:[Sn,En,xn,{parameterPath:"xUserComposeSessionId",mapper:{serializedName:"X-UserComposeSessionId",type:{name:"Uuid"}}},{parameterPath:"authorization",mapper:{serializedName:"Authorization",type:{name:"String"}}},{parameterPath:"serverToServerId",mapper:{serializedName:"ServerToServerId",type:{name:"String"}}}],mediaType:"json",serializer:Pn}},89928:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});const i={aa:["aa-ET","Qafar"],af:"af-ZA",agq:["agq-CM","Aghem"],ak:["ak-GH","Akan"],am:"am-ET",ar:"ar-SA",arn:"arn-CL",as:"as-IN",asa:["asa-TZ","Kipare"],ast:["ast-ES","asturianu"],az:["az-Latn-AZ","azÉrbaycan"],"az-cyrl":["az-Cyrl-AZ","ÐÐ·ÓÑÐ±Ð°ÑÒ¹Ð°Ð½Â Ð´Ð¸Ð»Ð¸ (ÐÐ¸ÑÐ¸Ð»)"],"az-latn":["az-Latn-AZ","AzÉrbaycanÂ­Ä±lÄ± (LatÄ±n)"],ba:"ba-RU",bas:["bas-CM","ÆÃ sÃ a"],be:"be-BY",bem:["bem-ZM","Ichibemba"],bez:["bez-TZ","Hibena"],bg:"bg-BG",bin:"bin-NG",bm:["bm-Latn-ML","bamanakan"],"bm-latn":["bm-Latn-ML","bamanakan (Latin)"],bn:"bn-BD",bo:"bo-CN",br:"br-FR",brx:["brx-IN","à¤¬à¤¡à¤¼à¥"],bs:["bs-Latn-BA","bosanski"],"bs-cyrl":["bs-Cyrl-BA","Ð±Ð¾ÑÐ°Ð½ÑÐºÐ¸ (ÐÐ¸ÑÐ¸Ð»Ð¸ÑÐ°)"],"bs-latn":["bs-Latn-BA","bosanski (Latinica)"],byn:["byn-ER","á¥áá"],ca:"ca-ES",ccp:["ccp-Cakm-BD","ððð´ðð³ð¦"],"ccp-cakm":["ccp-Cakm-BD","ððð´ðð³ð¦ (ððð´ð)"],ce:["ce-RU","Ð½Ð¾ÑÑÐ¸Ð¹Ð½"],ceb:["ceb-Latn-PH","Cebuano"],"ceb-latn":["ceb-Latn-PH","Cebuano (Latin)"],cgg:["cgg-UG","Rukiga"],chr:"chr-Cher-US","chr-cher":"chr-Cher-US",co:"co-FR",cs:"cs-CZ",cu:["cu-RU","ÑÐµÑÐºÐ¾Ð²Ð½Ð¾ÑÐ»Ð¾Ð²ÐµÌÐ½ÑÐºÑÐ¹"],cy:"cy-GB",da:"da-DK",dav:["dav-KE","Kitaita"],de:"de-DE",dje:["dje-NE","Zarmaciine"],dsb:"dsb-DE",dua:["dua-CM","duÃ¡lÃ¡"],dv:"dv-MV",dyo:["dyo-SN","joola"],dz:["dz-BT","à½¢à¾«à½¼à½à¼à½"],ebu:["ebu-KE","KÄ©embu"],ee:["ee-GH","EÊegbe"],el:"el-GR",en:"en-US",eo:["eo-001","esperanto"],es:"es-ES",et:"et-EE",eu:"eu-ES",ewo:["ewo-CM","ewondo"],fa:"fa-IR",ff:"ff-Latn-SN","ff-latn":"ff-Latn-SN",fi:"fi-FI",fil:"fil-PH",fo:"fo-FO",fr:"fr-FR",fur:["fur-IT","furlan"],fy:"fy-NL",ga:"ga-IE",gd:"gd-GB",gl:"gl-ES",gn:"gn-PY",gsw:"gsw-CH",gu:"gu-IN",guz:["guz-KE","Ekegusii"],gv:["gv-IM","Gaelg"],ha:["ha-Latn-NG","Hausa"],"ha-latn":["ha-Latn-NG","Hausa (Latin)"],haw:"haw-US",he:"he-IL",hi:"hi-IN",hr:"hr-HR",hsb:"hsb-DE",hu:"hu-HU",hy:"hy-AM",ia:["ia-001","interlingua"],ibb:"ibb-NG",id:"id-ID",ig:"ig-NG",ii:"ii-CN",is:"is-IS",it:"it-IT",iu:["iu-Latn-CA","Inuktitut"],"iu-cans":["iu-Cans-CA","áááááá¦ (áááá®áá¸áá¦)"],"iu-latn":["iu-Latn-CA","Inuktitut (Qaliujaaqpait)"],ja:"ja-JP",jgo:["jgo-CM","Ndaêa"],jmc:["jmc-TZ","Kimachame"],jv:"jv-Latn-ID","jv-java":"jv-Java-ID","jv-latn":"jv-Latn-ID",ka:"ka-GE",kab:["kab-DZ","Taqbaylit"],kam:["kam-KE","Kikamba"],kde:["kde-TZ","Chimakonde"],kea:["kea-CV","kabuverdianu"],khq:["khq-ML","Koyra ciini"],ki:["ki-KE","Gikuyu"],kk:"kk-KZ",kkj:["kkj-CM","kakÉ"],kl:"kl-GL",kln:["kln-KE","Kalenjin"],km:"km-KH",kn:"kn-IN",ko:"ko-KR",kok:"kok-IN",kr:"kr-Latn-NG","kr-latn":"kr-Latn-NG",ks:["ks-Arab-IN","Ú©Ù²Ø´ÙØ±"],"ks-arab":["ks-Arab-IN","Ú©Ù²Ø´ÙØ± (Ø§ÙØ±Ø¨Û)"],"ks-deva":"ks-Deva-IN",ksb:["ksb-TZ","Kishambaa"],ksf:["ksf-CM","rikpa"],ksh:["ksh-DE","KÃ¶lsch"],ku:"ku-Arab-IQ","ku-arab":"ku-Arab-IQ",kw:["kw-GB","kernewek"],ky:"ky-KG",la:"la-001",lag:["lag-TZ","KÉ¨laangi"],lb:"lb-LU",lg:["lg-UG","Luganda"],lkt:["lkt-US","LakÈÃ³lÊ¼iyapi"],ln:["ln-CD","lingÃ¡la"],lo:"lo-LA",lrc:["lrc-IR","ÙÛØ±Û Ø´ÙÙØ§ÙÛ"],lt:"lt-LT",lu:["lu-CD","Tshiluba"],luo:["luo-KE","Dholuo"],luy:["luy-KE","Luluhia"],lv:"lv-LV",mas:["mas-KE","Maa"],mer:["mer-KE","KÄ©mÄ©rÅ©"],mfe:["mfe-MU","kreol morisien"],mg:["mg-MG","Malagasy"],mgh:["mgh-MZ","Makua"],mgo:["mgo-CM","metaÊ¼"],mi:"mi-NZ",mk:"mk-MK",ml:["ml-IN","à´®à´²à´¯à´¾à´³à´"],mn:["mn-MN","ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÑÐ»"],"mn-cyrl":["mn-MN","ÐÐ¾Ð½Ð³Ð¾Ð»Â ÑÑÐ» (ÐÐ¸ÑÐ¸Ð»Ð» Ò¯ÑÑÐ³)"],"mn-mong":["mn-Mong-CN","á ®á £á ©á ­á £á ¤á ¯ á ¬á ¡á ¯á ¡ (á ®á £á ©á ­á £á ¤á ¯ á ¬á ¡á ¯á ¡)"],mni:"mni-IN",moh:"moh-CA",mr:"mr-IN",ms:"ms-MY",mt:"mt-MT",mua:["mua-CM","MUNDAÅ"],my:["my-MM","ááá¬"],mzn:["mzn-IR","ÙØ§Ø²Ø±ÙÙÛ"],naq:["naq-NA","Khoekhoegowab"],nb:"nb-NO",nd:["nd-ZW","isiNdebele"],nds:["nds-DE","Neddersassâsch"],ne:"ne-NP",nl:"nl-NL",nmg:["nmg-CM","Kwasio"],nn:"nn-NO",nnh:["nnh-CM","ShwÃ³ÅÃ² ngiembÉÉn"],no:["nb-NO","norsk"],nqo:"nqo-GN",nr:["nr-ZA","isiNdebele"],nso:"nso-ZA",nus:["nus-SS","Thok Nath"],nyn:["nyn-UG","Runyankore"],oc:"oc-FR",om:["om-ET","Oromoo"],or:"or-IN",os:["os-GE","Ð¸ÑÐ¾Ð½"],pa:"pa-IN","pa-arab":"pa-Arab-PK","pa-guru":"pa-IN",pap:"pap-029",pl:"pl-PL",prg:["prg-001","prÅ«siskan"],prs:"prs-AF",ps:"ps-AF",pt:"pt-BR",quc:"quc-Latn-GT","quc-latn":"quc-Latn-GT",quz:"quz-BO",rm:"rm-CH",rn:["rn-BI","Ikirundi"],ro:"ro-RO",rof:["rof-TZ","Kihorombo"],ru:"ru-RU",rw:"rw-RW",rwk:["rwk-TZ","Kiruwa"],sa:"sa-IN",sah:"sah-RU",saq:["saq-KE","Kisampur"],sbp:["sbp-TZ","Ishisangu"],sd:"sd-Arab-PK","sd-arab":"sd-Arab-PK","sd-deva":"sd-Deva-IN",se:"se-NO",seh:["seh-MZ","sena"],ses:["ses-ML","Koyraboro senni"],sg:["sg-CF","SÃ¤ngÃ¶"],shi:["shi-Tfng-MA","âµâ´°âµâµâµâµâµ"],"shi-latn":["shi-Latn-MA","Tashelá¸¥iyt (Latin)"],"shi-tfng":["shi-Tfng-MA","âµâ´°âµâµâµâµâµ (Tifinagh)"],si:"si-LK",sk:"sk-SK",sl:"sl-SI",sma:"sma-SE",smj:"smj-SE",smn:"smn-FI",sms:"sms-FI",sn:["sn-Latn-ZW","chiShona"],"sn-latn":["sn-Latn-ZW","chiShona (Latin)"],so:["so-SO","Soomaali"],sq:"sq-AL",sr:["sr-Latn-RS","srpski"],"sr-cyrl":["sr-Cyrl-RS","ÑÑÐ¿ÑÐºÐ¸ (ÐÐ¸ÑÐ¸Ð»Ð¸ÑÐ°)"],"sr-latn":["sr-Latn-RS","srpski (latinica)"],ss:["ss-ZA","Siswati"],ssy:["ssy-ER","Saho"],st:"st-ZA",sv:"sv-SE",sw:"sw-KE",syr:"syr-SY",ta:"ta-IN",te:"te-IN",teo:["teo-UG","Kiteso"],tg:["tg-Cyrl-TJ","Ð¢Ð¾Ò·Ð¸ÐºÓ£"],"tg-cyrl":["tg-Cyrl-TJ","Ð¢Ð¾Ò·Ð¸ÐºÓ£ (ÐÐ¸ÑÐ¸Ð»Ð»Ð¸ÐºÓ£)"],th:"th-TH",ti:"ti-ER",tig:["tig-ER","áµáá¨"],tk:"tk-TM",tn:"tn-ZA",to:["to-TO","lea fakatonga"],tr:"tr-TR",ts:["ts-ZA","Xitsonga"],tt:"tt-RU",twq:["twq-NE","Tasawaq senni"],tzm:["tzm-Latn-DZ","TamaziÉ£t n laá¹­laá¹£"],"tzm-arab":"tzm-Arab-MA","tzm-latn":["tzm-Latn-DZ","TamaziÉ£t n laá¹­laá¹£ (Latin)"],"tzm-tfng":["tzm-Tfng-MA","Tamazight (Tifinagh)"],ug:"ug-CN",uk:"uk-UA",ur:"ur-PK",uz:"uz-Latn-UZ","uz-arab":["uz-Arab-AF","Ø§ÙØ²Ø¨ÛÚ© (Ø¹Ø±Ø¨Û)"],"uz-cyrl":["uz-Cyrl-UZ","ÐÐ·Ð±ÐµÐº (ÐÐ¸ÑÐ¸Ð»)"],"uz-latn":"uz-Latn-UZ",vai:["vai-Vaii-LR","êê¤"],"vai-latn":["vai-Latn-LR","Vai (Latin)"],"vai-vaii":["vai-Vaii-LR","êê¤ (Vai)"],ve:["ve-ZA","Tshivená¸a"],vi:"vi-VN",vo:["vo-001","VolapÃ¼k"],vun:["vun-TZ","Kyivunjo"],wae:["wae-CH","Walser"],wal:["wal-ET","ááá­á³á±"],wo:"wo-SN",xh:"xh-ZA",xog:["xog-UG","Olusoga"],yav:["yav-CM","nuasue"],yi:["yi-001","××Ö´×××©"],yo:"yo-NG",zgh:["zgh-Tfng-MA","âµâ´°âµâ´°âµ£âµâµâµ"],"zgh-tfng":["zgh-Tfng-MA","âµâ´°âµâ´°âµ£âµâµâµ (Tifinagh)"],zh:["zh-CN","ä¸­æ"],"zh-hans":"zh-CN","zh-hant":["zh-HK","ä¸­æ(ç¹é«)"],zu:"zu-ZA"}},95988:(e,t,n)=>{"use strict";var i,r,o,a,s,l,u,d,c,h,g;n.d(t,{ED:()=>i,fT:()=>r,xp:()=>h}),function(e){e[e.Success=0]="Success",e[e.PartialSuccess=1]="PartialSuccess",e[e.Error=2]="Error",e[e.Disabled=3]="Disabled"}(i||(i={})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.Paragraph=1]="Paragraph",e[e.Group=2]="Group",e[e.Page=3]="Page",e[e.Document=4]="Document"}(o||(o={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"}(a||(a={})),function(e){e[e.None=0]="None",e[e.OfficeOrthospeller=1]="OfficeOrthospeller",e[e.BingOneSpeller=2]="BingOneSpeller",e[e.ContextSpeller=3]="ContextSpeller",e[e.Grammar=4]="Grammar"}(s||(s={})),function(e){e[e.None=0]="None",e[e.Active=1]="Active",e[e.Provisional=2]="Provisional"}(l||(l={})),function(e){e[e.None=0]="None",e[e.Consistency=1]="Consistency"}(u||(u={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(d||(d={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(c||(c={})),function(e){e[e.Ignore=0]="Ignore",e[e.IgnoreAll=1]="IgnoreAll",e[e.AddToDictionary=2]="AddToDictionary",e[e.Delete=3]="Delete",e[e.ChangeSugg0=4]="ChangeSugg0",e[e.ChangeSugg1=5]="ChangeSugg1",e[e.ChangeSugg2=6]="ChangeSugg2",e[e.ChangeSuggOther=7]="ChangeSuggOther",e[e.ChangeAllSugg0=8]="ChangeAllSugg0",e[e.ChangeAllSugg1=9]="ChangeAllSugg1",e[e.ChangeAllSugg2=10]="ChangeAllSugg2",e[e.ChangeAllSuggOther=11]="ChangeAllSuggOther",e[e.ClickNoAction=12]="ClickNoAction",e[e.DoNotCheckThisIssue=13]="DoNotCheckThisIssue",e[e.ManualEdit=14]="ManualEdit",e[e.Autoreplace=15]="Autoreplace",e[e.AutoreplaceUndo=16]="AutoreplaceUndo",e[e.IgnoreUndo=17]="IgnoreUndo",e[e.IgnoreAllUndo=18]="IgnoreAllUndo",e[e.ChangeSugg0Undo=19]="ChangeSugg0Undo",e[e.ChangeSugg1Undo=20]="ChangeSugg1Undo",e[e.ChangeSugg2Undo=21]="ChangeSugg2Undo"}(h||(h={})),function(e){e[e.Zero=0]="Zero",e[e.One=1]="One"}(g||(g={}))},63302:(e,t,n)=>{"use strict";n.d(t,{I:()=>Oe});var i=n(30206),r=n(39584),o=n(40747),a=n(95481),s=n(98287),l=n(72971),u=n(86278),d=n(8903),c=n(44680),h=n(94940),g=n(48828),p=n(90424),f=n(30225);let m=class{constructor(e,t,n,i,r,o,a){this._guidGenerator=e,this._registrar=t,this._proofingPersistedStore=n,this._sessionContextProvider=i,this._logger=r,this._featureFlagsReader=o,this._hostSettings=a}async initializeComponent(){let e;await this._featureFlagsReader.refreshFlags();try{this._sessionContextProvider&&(e=await this._sessionContextProvider())}catch(e){}await this._logger.initialize(this._proofingPersistedStore,this._featureFlagsReader,e,void 0,this._hostSettings),this._logger.debug(520984581,"Logger initialized"),h.R.addUnhandledExceptionsListeners(this._logger,r.s.UnhandledContentError,"Unhandled async content script error"),this._logger.debug(520984580,"Initializing telemetry");const t=this._guidGenerator.generate();this._logger.addCorrelationID(t),this._logger.debug(520984579,"Registering listeners"),await this._registrar.initialize()}};m=(0,i.__decorate)([(0,g._)(),(0,i.__param)(0,(0,p.W)(o.G)),(0,i.__param)(1,(0,p.W)(a.V)),(0,i.__param)(2,(0,p.W)(s.K)),(0,i.__param)(3,(0,p.W)(l.a)),(0,i.__param)(3,(0,f.l)()),(0,i.__param)(4,(0,p.W)(u.g)),(0,i.__param)(5,(0,p.W)(d.c)),(0,i.__param)(6,(0,p.W)(c.n))],m);var v=n(70532),y=n(95988);let _=class extends v.a{constructor(e){super(),this.hostSettings=e,this.defaultUxLanguage="en-US",this.editorSpellcheckAttribute="data-ms-editor",this.completeTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?y.fT.Paragraph:y.fT.Sentence,this.partialTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?y.fT.Sentence:y.fT.Phrase,this.emitRemoval=!0,this.styleObserverIntervalTime=1,this.styleSampleTime=10,this.reconcileTileNodeTime=3e3,this.enableTileNodeAutoReconciliation=!0,this.maxSuggestionItemsDisplayNumber=3,this.maxSuggestionDisplayPerLanguageNumber=2,this.maxProofingLanguages=3,this.fabricFontsDefinitionPath="fonts/fabric-icons.css",this.enableSplitSuggestionButton=!1,this.narrowOnChangeReconciliation=!1,this.schedulerDefaultWaitingTime=50,this.schedulerDefaultMaxTime=2e3,this.schedulerDefaultWaitingTimeIncrement=400,this.maxServiceContentLengthInChars=350,this.maxContentLengthInChars=2e4}};_=(0,i.__decorate)([(0,g._)(),(0,i.__param)(0,(0,p.W)(c.n))],_);var b=n(15885),C=n(91864),T=n(60933),S=n(97428),I=n(96993),w=n(29714),E=n(36230),x=n(90858),A=n(63837);const D=(0,A.f)("IEditorClientSettings");var N=n(39441),F=n(79442);const P=(0,A.f)("IOrchestratorSettings");var k=n(50955),O=n(13608);let B=class{constructor(e,t){this._storeEntryReader=e,this._storeEntryWriter=t,this._storeEntryMap=this.populateStoreEntryMap()}_fetchStoreEntry(e){const t=this._storeEntryMap.get(e);if(!t)throw Error("Cannot find the entry key.");return t}async read(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readOrInitialize(t)}async write(e,t){await this._storeEntryWriter.write(this._fetchStoreEntry(e).storeEntry,t)}async getLastUpdatedTimestamp(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readLastUpdatedTimestamp(t)}getCachedEntry(e){const t=this._fetchStoreEntry(e),n=t.storeEntry;return{storeEntryValue:void 0===n.lastValueFromStorage?n.defaultValue:n.lastValueFromStorage,isSynced:!!t.isSynced}}getDefaultValue(e){return this._fetchStoreEntry(e).storeEntry.defaultValue}async removePersistentKeys(){}};B=(0,i.__decorate)([(0,g._)()],B);var R=n(53024),L=n(889),M=n(31957),q=n(48845),U=n(47954),W=n(20399);const j=new Map([[U.l.EnableCopilotInsert,!0],[U.l.EnableCopilotRewrite,!0],[U.l.EnableSpelling,!0],[U.l.EnableGrammar,!0],[U.l.EnableRefinements,!0],[U.l.EnableTelemetry,!0]]),z=new Map([[U.l.AppId,"EditorBX_Online"],[U.l.Descriptors,JSON.stringify([{name:"FlightIds",value:"Wac-WordEditorServiceSuggestionDescriptionsNoReferenceInformation-Treatment;Wac-WordEditorServiceMultipleGrammarCritiquesPerSentence-Treatment"}])],[U.l.ProofingLanguages,[]],[U.l.CritiqueValuePerLanguage,JSON.stringify([])],[U.l.DefaultProofingLanguageInitialized,!1],[U.l.ProofingLanguageListInitialized,!1],[U.l.IsLanguageAutoDetectEnabled,!0],[U.l.TonalFREAccepted,!1],[U.l.EnableEditor,!0],[U.l.EnableTextPrediction,!0],[U.l.EnableCIQFlags,!0],[U.l.EnableCIQMenu,!0],[U.l.OverriddenCritiqueTypeOptions,[]],[U.l.OverriddenInlineEditingSettings,[]],[U.l.PaneOverriddenCritiqueTypeOptions,[]],[U.l.StealthOverriddenCritiqueTypeOptions,[]],[U.l.ShowSynonyms,!1],[U.l.EnableSynonymsToggle,!1],[U.l.ConfigurationId,""],[U.l.ClientId,""],[U.l.HashedUserDictionary,[]]]),H=new Map([[U.l.DefaultLoggingLevel,W.q.Info],[U.l.DebugMode,!1]]);let V=class extends B{constructor(e,t,n,i){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=n,this._hostSettings=i,this.write(U.l.AppId,this._hostSettings.appId)}populateStoreEntryMap(){const e=new Map;return j.forEach(((t,n)=>{e.set(n,{storeEntry:(0,R.EM)(n,t),isSynced:!0})})),z.forEach(((t,n)=>{e.set(n,{storeEntry:(0,R.EM)(n,t)})})),H.forEach(((t,n)=>{e.set(n,{storeEntry:(0,R.EM)(n,t,!0)})})),e}async initialize(){for(const e of j.keys())await this.read(e);await this.read(U.l.ConfigurationId);const e=Array.from(j.keys());e.push(...Array.from(z.keys())),e.push(...Array.from(H.keys()));for(const t of e)this._emitter.on(t,(()=>this.read(t)))}shutDown(){}async read(e){return e===U.l.AppId?Promise.resolve(this._hostSettings.appId):super.read(e)}async removePersistentKeys(){const e=Array.from(j.keys());e.push(...Array.from(z.keys())),e.push(...Array.from(H.keys())),e.length&&await this.storeEntryWriter.remove(e)}};V=(0,i.__decorate)([(0,g._)(),(0,i.__param)(0,(0,p.W)(L.A)),(0,i.__param)(1,(0,p.W)(M.a)),(0,i.__param)(2,(0,p.W)(q.E)),(0,i.__param)(3,(0,p.W)(c.n))],V);let G=class{triggerCallback(e,t){t?(this.userInfo=void 0,this.lastError=t):this.lastError=void 0,this.userInfo=e(this.userInfo)}async executeAsync(e=!0){return new Promise(((t,n)=>{this.execute(e,(e=>(this.lastError?n(this.lastError):t(e),e)))}))}};G=(0,i.__decorate)([(0,g._)()],G);let Q=class extends G{constructor(e){super(),this._hostSettings=e}update(e){this._updatedUserInfo=e}execute(e=!0,t){this._updatedUserInfo?this.userInfo=this._updatedUserInfo:this._hostSettings.userId&&(this.userInfo={userId:this._hostSettings.userId.puid,tenantId:this._hostSettings.userId.tenantId,email:void 0,licenseType:this._hostSettings.licenseType,identityProvider:this._hostSettings.userId.identityProvider}),this.triggerCallback(t)}};var K;Q=(0,i.__decorate)([(0,g._)(),(0,i.__param)(0,(0,p.W)(c.n))],Q),function(e){e.CourtesyAttributes="CourtesyAttributes",e.RootContentMaxLengthInChars="RootContentMaxLengthInChars"}(K||(K={}));const $=new Map([[K.CourtesyAttributes,["data-gramm"]],[K.RootContentMaxLengthInChars,500]]);let Z=class extends B{constructor(e,t,n){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=n}populateStoreEntryMap(){const e=new Map;return $.forEach(((t,n)=>{e.set(n,{storeEntry:(0,R.Tm)(n,t),isSynced:!1})})),e}async initialize(){for(const e of $.keys())await this.read(e),this._emitter.on(e,(async()=>{await this.read(e)}))}shutDown(){}async removePersistentKeys(){const e=Array.from($.keys());e.length&&await this.storeEntryWriter.remove(e)}};Z=(0,i.__decorate)([(0,g._)(),(0,i.__param)(0,(0,p.W)(L.A)),(0,i.__param)(1,(0,p.W)(M.a)),(0,i.__param)(2,(0,p.W)(q.E))],Z);class J{constructor(){this.imports=[T.u]}get uniqueId(){return(0,S.z)(507918284)}configureRootServices(e){e.bind(I.H).to(m),e.bind(O.UC).to(O.h1),e.bind(O.YQ).to(O.ZP),e.bind(b.A).toDynamicValue((e=>{const t=e.get(O.YQ);return()=>t.currentTheme===O.SV.highContrast})),e.bind(D).to(_),e.bind(N.k).toExisting(D),e.bind(k.z).toExisting(D),e.bind(C.D).toExisting(D),e.bind(P).toExisting(D),e.bind(Z).toSelf(),e.bind(F.B).toExisting(Z),e.bind(s.K).to(V),e.bind(w.S).toExisting(Z),e.bind(w.S).toExisting(s.K),e.bind(E.e).to(Q),e.bind(x.M).toExisting(E.e)}}var Y=n(46746),X=n(29594);class ee{static hash(e){let t=0,n=0;for(;n<e.length;)t=(t<<5)-t+e.charCodeAt(n++)|0;return t>0?t:-1*t}static format(e,...t){const n=t.length;return e.replace(/\{(\d+)\}/g,((e,i)=>i<n?t[i]:e))}static trimLeft(e){return e.replace(/^\s+/,"")}static trimRight(e){return e.replace(/\s+$/,"")}}let te=class{getMessage(e,t){const n=(0,X.$)(),i=n.getString("OnCanvasCalloutStrings",e)||n.getString("CopywriterStrings",e)||n.getString("EditorBrowserExtensionStrings",e)||n.getString("AiInsertStrings",e)||n.getString("InlineSuggestionStrings",e)||"";if(void 0===t)return i;const r=Array.isArray(t)?t:[t];return ee.format(i,...r)}};te=(0,i.__decorate)([(0,g._)()],te);var ne=n(38716),ie=n(90935),re=n(86388),oe=n(89928);const ae=new Map([["es-419","es-MX"]]);class se{async importStrings(e,t=!1){var i;let r=null!==(i=ae.get(e))&&void 0!==i?i:e;if(r in oe.Y){const e=oe.Y[r];r=Array.isArray(e)?e[0]:e}const o=(0,ie.C)();return n(11311)(`./${function(e){try{const t=e.split("-");return 2===t.length?t[0].toLowerCase()+"-"+t[1].toUpperCase():t[0].toLowerCase()+"-"+t[1][0].toUpperCase()+t[1].substring(1).toLowerCase()+"-"+t[2].toUpperCase()}catch(t){throw(0,ie.C)().logEvent(0,"Diagnostics",re.h.Host,W.q.Error,{locale:e,Text_Message:`Unknown locale while loading strings from localization file dynamically: ${t}`}),Error(`Unknown locale : ${e} while loading strings from localization file dynamically: ${t}`)}}(r).toLowerCase()}/ui-strings.json`).then((async e=>e)).catch((n=>{try{if(!t){const t=e.split("-")[0];if(t in oe.Y){const e=oe.Y[t],n=Array.isArray(e)?e[0]:e;return this.importStrings(n,!0)}}o.logEvent(508351959,"Diagnostics",re.h.Undefined,W.q.Error,`Failed to load strings for locale ${e} from localization file dynamically: ${n}`,void 0,void 0,void 0,"Text_Message")}catch(t){o.logEvent(508351958,"Diagnostics",re.h.Undefined,W.q.Error,`Failed to load neutral strings for locale ${e} from localization file dynamically: ${n}`,void 0,void 0,void 0,"Text_Message")}}))}}class le{constructor(){this._fallbackLocale="en-US",this._languageCache=new Map,this._localizationFileImporter=new se}get strings(){var e;return null!==(e=this._strings)&&void 0!==e?e:{}}getString(e,t){return this._strings?this._strings[e][t]:""}getStringsFor(e){return this._strings?t=>this._strings[e][t]:()=>""}async getStringsForLocale(e){var t;const n=null!==(t=this._languageCache.get(e))&&void 0!==t?t:await this._localizationFileImporter.importStrings(e);return n&&this._languageCache.set(e,n),n}async getStringForLocale(e,t,n){const i=await this.getStringsForLocale(e);return null==i?void 0:i[t][n]}async getStringForFallbackLocale(e,t){return(await this.getStringsForFallbackLocale())[e][t]}async getStringsForFallbackLocale(){const e=await this.getStringsForLocale(this._fallbackLocale);if(!e)throw new Error("Failed to load strings from localization file dynamically");return e}setFallbackLocale(e){this._fallbackLocale=e}get fallbackLocale(){return this._fallbackLocale}async loadLocale(e){if(!e)throw(0,ie.C)().logEvent(0,"Diagnostics",re.h.Undefined,W.q.Error,"Undefined locale while loading strings from localization file dynamically.",void 0,void 0,void 0,"Text_Message"),Error("Undefined locale language while loading strings dynamically");let t;if(!(t=this._languageCache.get(e))){if(t=await this._localizationFileImporter.importStrings(e),!t)throw Error(`Failed to load strings from localization file dynamically: ${e}`);this._languageCache.set(e,t)}this._strings=t}}new le;class ue{constructor(){this.imports=[]}get uniqueId(){return(0,S.z)(507918298)}configureRootServices(e){var t;const n=null!==(t=(0,X.$)())&&void 0!==t?t:new le;(0,X.Y)(n),e.bind(ne.H).to(te)}}class de{constructor(){this.imports=[J,ue]}get uniqueId(){return(0,S.z)(507918337)}configureRootServices(e){e.bind(Y.Q).toDynamicValue((e=>()=>e.getOptional(Y.C)))}}var ce=n(36747);const he=(0,A.f)("IIconRegistrable");var ge=n(30122),pe=n(44207);let fe=class{constructor(e){this.iconGroups=e}async initialize(){const e={};for(const t of this.iconGroups)for(const n of await t.getIcons())e[n.iconName]=n.icon;(0,pe.K1)({icons:e})}shutDown(){}};fe=(0,i.__decorate)([(0,g._)(),(0,i.__param)(0,(0,ge.t)(he)),(0,i.__param)(0,(0,f.l)())],fe);const me=(0,A.f)("ILanguageInfoProvider");function ve(e,t,n){const i={};for(const r in n)i[e+"-"+r]=`${t} (${n[r]})`;return i}const ye=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({"aa-dj":"Qafar (Yabuuti)","aa-er":"Qafar (Eretria)","aa-et":"Qafar (Otobbia)","af-na":"Afrikaans (NamibiÃ«)","af-za":"Afrikaans (Suid-Afrika)","agq-cm":"Aghem (KÃ mÃ lÃ»Å)","ak-gh":"Akan (Gaana)","am-et":"á áá­á (á¢áµá®áµá«)","ar-001":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¹Ø§ÙÙ)",!0],"ar-ae":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¥ÙØ§Ø±Ø§Øª Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙÙØªØ­Ø¯Ø©)",!0],"ar-bh":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¨Ø­Ø±ÙÙ)",!0],"ar-dj":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø¬ÙØ¨ÙØªÙ)",!0],"ar-dz":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¬Ø²Ø§Ø¦Ø±)",!0],"ar-eg":["Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙØµØ±)",!0],"ar-er":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø¥Ø±ÙØªØ±ÙØ§)",!0],"ar-il":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø¥Ø³Ø±Ø§Ø¦ÙÙ)",!0],"ar-iq":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ¹Ø±Ø§Ù)",!0],"ar-jo":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ£Ø±Ø¯Ù)",!0],"ar-km":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø¬Ø²Ø± Ø§ÙÙÙØ±)",!0],"ar-kw":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙØª)",!0],"ar-lb":["Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙØ¨ÙØ§Ù)",!0],"ar-ly":["Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙÙØ¨ÙØ§)",!0],"ar-ma":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙÙØ© Ø§ÙÙØºØ±Ø¨ÙØ©)",!0],"ar-mr":["Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙÙØ±ÙØªØ§ÙÙØ§)",!0],"ar-om":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø¹ÙØ§Ù)",!0],"ar-ps":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ³ÙØ·Ø© Ø§ÙÙÙØ³Ø·ÙÙÙØ©)",!0],"ar-qa":["Ø§ÙØ¹Ø±Ø¨ÙØ© (ÙØ·Ø±)",!0],"ar-sa":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙÙØ© Ø§ÙØ¹Ø±Ø¨ÙØ© Ø§ÙØ³Ø¹ÙØ¯ÙØ©)",!0],"ar-sd":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØ³ÙØ¯Ø§Ù)",!0],"ar-so":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙØµÙÙØ§Ù)",!0],"ar-ss":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø¬ÙÙØ¨ Ø§ÙØ³ÙØ¯Ø§Ù)",!0],"ar-sy":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø³ÙØ±ÙØ§)",!0],"ar-td":["Ø§ÙØ¹Ø±Ø¨ÙØ© (ØªØ´Ø§Ø¯)",!0],"ar-tn":["Ø§ÙØ¹Ø±Ø¨ÙØ© (ØªÙÙØ³)",!0],"ar-ye":["Ø§ÙØ¹Ø±Ø¨ÙØ© (Ø§ÙÙÙÙ)",!0],"arn-cl":"Mapudungun (Chile)","as-in":"à¦à¦¸à¦®à§à§à¦¾ (à¦­à¦¾à§°à¦¤)","asa-tz":"Kipare (Tadhania)","ast-es":"asturianu (EspaÃ±a)","az-cyrl-az":"Ð°Ð·ÓÑÐ±Ð°ÑÒ¹Ð°Ð½ (ÐÐ·ÓÑÐ±Ð°ÑÒ¹Ð°Ð½)","az-latn-az":"azÉrbaycan (AzÉrbaycan)","ba-ru":"ÐÐ°ÑÒ¡Ð¾ÑÑ (Ð ÓÑÓÐ¹)","bas-cm":"ÆÃ sÃ a (KÃ mÉÌrÃ»n)","be-by":"ÐÐµÐ»Ð°ÑÑÑÐºÐ°Ñ (ÐÐµÐ»Ð°ÑÑÑÑ)","bem-zm":"Ichibemba (Zambia)","bez-tz":"Hibena (Hutanzania)","bg-bg":"Ð±ÑÐ»Ð³Ð°ÑÑÐºÐ¸ (ÐÑÐ»Ð³Ð°ÑÐ¸Ñ)","bin-ng":"áº¸ÌdÃ³ (Nigeria)","bm-latn-ml":"bamanakan (Mali)","bn-bd":"à¦¬à¦¾à¦à¦²à¦¾ (à¦¬à¦¾à¦à¦²à¦¾à¦¦à§à¦¶)","bn-in":"à¦¬à¦¾à¦à¦²à¦¾ (à¦­à¦¾à¦°à¦¤)","bo-cn":"à½à½¼à½à¼à½¡à½²à½ (à½à¾²à½´à½à¼à½§à¾­à¼à½à½²à¼à½à½à½à½¦à¼à½¦à¾¤à¾±à½²à¼à½à½à½´à½à¼à½¢à¾à¾±à½£à¼à½à½à¼)","bo-in":"à½à½¼à½à¼à½¦à¾à½à¼ (à½¢à¾à¾±à¼à½à½¢à¼)","br-fr":"brezhoneg (FraÃ±s)","brx-in":"à¤¬à¤¡à¤¼à¥ (à¤­à¤¾à¤°à¤¤)","bs-cyrl-ba":"Ð±Ð¾ÑÐ°Ð½ÑÐºÐ¸ (ÐÐ¾ÑÐ½Ð° Ð¸ Ð¥ÐµÑÑÐµÐ³Ð¾Ð²Ð¸Ð½Ð°)","bs-latn-ba":"bosanski (Bosna i Hercegovina)","byn-er":"á¥áá (á¤á­áµá«)","ca-ad":"catalÃ  (Andorra)","ca-es":"catalÃ  (catalÃ )","ca-es-valencia":"valenciÃ  (Espanya)","ca-fr":"catalÃ  (FranÃ§a)","ca-it":"catalÃ  (ItÃ lia)","ccp-cakm-bd":"ððð´ðð³ð¦ (ððð£ðð¬ðð´)","ccp-cakm-in":"ððð´ðð³ð¦ (ðð¢ð§ðð´)","ce-ru":"Ð½Ð¾ÑÑÐ¸Ð¹Ð½ (Ð Ð¾ÑÑÐ¸)","ceb-latn-ph":"Cebuano (Pilipinas)","cgg-ug":"Rukiga (Uganda)","chr-cher-us":"á£á³á© (áá á¢á³á¾áµááá áá¦áá©)","co-fr":"Corsu (Francia)","cs-cz":"ÄeÅ¡tina (Äesko)","cu-ru":"ÑÐµÑÐºÐ¾Ð²Ð½Ð¾ÑÐ»Ð¾Ð²ÐµÌÐ½ÑÐºÑÐ¹ (ÑÑ¡ÑÑÑÌÐ°)","cy-gb":"Cymraeg (Y Deyrnas Unedig)","da-dk":"dansk (Danmark)","da-gl":"dansk (GrÃ¸nland)","dav-ke":"Kitaita (Kenya)"},ve("de","Deutsch",{at:"Ãsterreich",be:"Belgien",ch:"Schweiz",de:"Deutschland",it:"Italien",li:"Liechtenstein",lu:"Luxemburg"})),{"dje-ne":"Zarmaciine (NiÅ¾er)","dsb-de":"dolnoserbÅ¡Äina (Nimska)","dua-cm":"duÃ¡lÃ¡ (Cameroun)","dv-mv":["ÞÞ¨ÞÞ¬ÞÞ¨ÞÞ¦ÞÞ° (ÞÞ¨ÞÞ¬ÞÞ¨ ÞÞ§ÞÞ°ÞÞ¬)",!0],"dyo-sn":"joola (Senegal)","dz-bt":"à½¢à¾«à½¼à½à¼à½ (à½ à½à¾²à½´à½)","ebu-ke":"KÄ©embu (Kenya)","ee-gh":"EÊegbe (Ghana nutome)","ee-tg":"EÊegbe (Togo nutome)","el-cy":"ÎÎ»Î»Î·Î½Î¹ÎºÎ¬ (ÎÏÏÏÎ¿Ï)","el-gr":"ÎÎ»Î»Î·Î½Î¹ÎºÎ¬ (ÎÎ»Î»Î¬Î´Î±)"}),ve("en","English",{"001":"World","029":"Caribbean",150:"Europe",ae:"United Arab Emirates",ag:"Antigua & Barbuda",ai:"Anguilla",as:"American Samoa",at:"Austria",au:"Australia",bb:"Barbados",be:"Belgium",bi:"Burundi",bm:"Bermuda",bs:"Bahamas",bw:"Botswana",bz:"Belize",ca:"Canada",cc:"Cocos (Keeling) Islands",ch:"Switzerland",ck:"Cook Islands",cm:"Cameroon",cx:"Christmas Island",cy:"Cyprus",de:"Germany",dk:"Denmark",dm:"Dominica",er:"Eritrea",fi:"Finland",fj:"Fiji",fk:"Falkland Islands",fm:"Micronesia",gb:"United Kingdom",gd:"Grenada",gg:"Guernsey",gh:"Ghana",gi:"Gibraltar",gm:"Gambia",gu:"Guam",gy:"Guyana",hk:"Hong Kong SAR",id:"Indonesia",ie:"Ireland",il:"Israel",im:"Isle of Man",in:"India",io:"British Indian Ocean Territory",je:"Jersey",jm:"Jamaica",ke:"Kenya",ki:"Kiribati",kn:"St. Kitts & Nevis",ky:"Cayman Islands",lc:"St. Lucia",lr:"Liberia",ls:"Lesotho",mg:"Madagascar",mh:"Marshall Islands",mo:"Macao SAR",mp:"Northern Mariana Islands",ms:"Montserrat",mt:"Malta",mu:"Mauritius",mw:"Malawi",my:"Malaysia",na:"Namibia",nf:"Norfolk Island",ng:"Nigeria",nl:"Netherlands",nr:"Nauru",nu:"Niue",nz:"New Zealand",pg:"Papua New Guinea",ph:"Philippines",pk:"Pakistan",pn:"Pitcairn Islands",pr:"Puerto Rico",pw:"Palau",rw:"Rwanda",sb:"Solomon Islands",sc:"Seychelles",sd:"Sudan",se:"Sweden",sg:"Singapore",sh:"St Helena, Ascension, Tristan da Cunha",si:"Slovenia",sl:"Sierra Leone",ss:"South Sudan",sx:"Sint Maarten",sz:"Eswatini",tc:"Turks & Caicos Islands",tk:"Tokelau",to:"Tonga",tt:"Trinidad & Tobago",tv:"Tuvalu",tz:"Tanzania",ug:"Uganda",um:"U.S. Outlying Islands",us:"United States",vc:"St. Vincent & Grenadines",vg:"British Virgin Islands",vi:"U.S. Virgin Islands",vu:"Vanuatu",ws:"Samoa",za:"South Africa",zm:"Zambia",zw:"Zimbabwe"})),{"eo-001":"esperanto (Mondo)"}),ve("es","espaÃ±ol",{419:"LatinoamÃ©rica",ar:"Argentina",bo:"Bolivia",br:"Brasil",bz:"Belice",cl:"Chile",co:"Colombia",cr:"Costa Rica",cu:"Cuba",do:"RepÃºblica Dominicana",ec:"Ecuador",es:"EspaÃ±a, alfabetizaciÃ³n internacional",es_tradnl:"EspaÃ±a, alfabetizaciÃ³n tradicional",gq:"Guinea Ecuatorial",gt:"Guatemala",hn:"Honduras",mx:"MÃ©xico",ni:"Nicaragua",pa:"PanamÃ¡",pe:"PerÃº",ph:"Filipinas",pr:"Puerto Rico",py:"Paraguay",sv:"El Salvador",us:"Estados Unidos",uy:"Uruguay",ve:"Venezuela"})),{"et-ee":"eesti (Eesti)","eu-es":"euskara (euskara)","ewo-cm":"ewondo (KamÉrÃºn)","fa-ir":["ÙØ§Ø±Ø³Û (Ø§ÛØ±Ø§Ù)",!0]}),ve("ff-latn","Pulaar",{bf:"Burkibaa Faaso",cm:"Kameruun",gh:"Ganaa",gm:"Gammbi",gn:"Gine",gw:"Gine-Bisaawo",lr:"Liberiyaa",mr:"Muritani",ne:"Nijeer",ng:"Nijeriyaa",sl:"Seraa liyon",sn:"Senegaal"})),{"fi-fi":"suomi (Suomi)","fil-ph":"Filipino (Pilipinas)","fo-dk":"fÃ¸royskt (Danmark)","fo-fo":"fÃ¸royskt (FÃ¸royar)"}),ve("fr","franÃ§ais",{"029":"caraÃ¯bes",be:"Belgique",bf:"Burkina Faso",bi:"Burundi",bj:"BÃ©nin",bl:"Saint-BarthÃ©lemy",ca:"Canada",cd:"Congo, RÃ©publique dÃ©mocratique du",cf:"RÃ©publique centrafricaine",cg:"Congo",ch:"Suisse",ci:"CÃ´te dâIvoire",cm:"Cameroun",dj:"Djibouti",dz:"AlgÃ©rie",fr:"France",ga:"Gabon",gf:"Guyane franÃ§aise",gn:"GuinÃ©e",gp:"Guadeloupe",gq:"GuinÃ©e Ã©quatoriale",ht:"HaÃ¯ti",km:"Comores",lu:"Luxembourg",ma:"Maroc",mc:"Monaco",mf:"Saint-Martin",mg:"Madagascar",ml:"Mali",mq:"Martinique",mr:"Mauritanie",mu:"Maurice",nc:"Nouvelle-CalÃ©donie",ne:"Niger",pf:"PolynÃ©sie franÃ§aise",pm:"Saint-Pierre-et-Miquelon",re:"La RÃ©union",rw:"Rwanda",sc:"Seychelles",sn:"SÃ©nÃ©gal",sy:"Syrie",td:"Tchad",tg:"Togo",tn:"Tunisie",vu:"Vanuatu",wf:"Wallis-et-Futuna",yt:"Mayotte"})),{"fur-it":"furlan (Italie)","fy-nl":"Frysk (NederlÃ¢n)","ga-ie":"Gaeilge (Ãire)","gd-gb":"GÃ idhlig (An RÃ¬oghachd Aonaichte)","gl-es":"galego (galego)","gn-py":"AvaÃ±eâáº½ (ParaguÃ¡i)","gsw-ch":"SchwiizertÃ¼Ã¼tsch (Schwiiz)","gsw-fr":"ElsÃ¤ssisch (FrÃ nkrisch)","gsw-li":"SchwiizertÃ¼Ã¼tsch (LiÃ¤chteschtÃ¤i)","gu-in":"àªà«àªàª°àª¾àª¤à« (àª­àª¾àª°àª¤)","guz-ke":"Ekegusii (Kenya)","gv-im":"Gaelg (Ellan Vannin)","ha-latn-gh":"Hausa (Gana)","ha-latn-ne":"Hausa (Nijar)","ha-latn-ng":"Hausa (Najeriya)","haw-us":"Ê»Ålelo HawaiÊ»i (Ê»Amelika Hui PÅ« Ê»Ia)","he-il":["×¢××¨××ª (××©×¨××)",!0],"hi-in":"à¤¹à¤¿à¤¨à¥à¤¦à¥ (à¤­à¤¾à¤°à¤¤)","hr-ba":"hrvatski (Bosna i Hercegovina)","hr-hr":"hrvatski (Hrvatska)","hsb-de":"hornjoserbÅ¡Äina (NÄmska)","hu-hu":"magyar (MagyarorszÃ¡g)","hy-am":"ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶ (ÕÕ¡ÕµÕ¡Õ½Õ¿Õ¡Õ¶)","ia-001":"interlingua (Mundo)","ibb-ng":"Ibibio-Efik (Nigeria)","id-id":"Indonesia (Indonesia)","ig-ng":"Asá»¥sá»¥ Igbo (Naá»já»rá»a)","ii-cn":"êê ê±ê· (êê¸êê±ê­ê¼ê©)","is-is":"Ã­slenska (Ãsland)","it-ch":"italiano (Svizzera)","it-it":"italiano (Italia)","it-sm":"italiano (San Marino)","it-va":"italiano (CittÃ  del Vaticano)","iu-cans-ca":"áááááá¦ (á²ááá¥)","iu-latn-ca":"Inuktitut (Kanatami)","ja-jp":"æ¥æ¬èª (æ¥æ¬)","jgo-cm":"Ndaêa (KamÉlÃ»n)","jmc-tz":"Kimachame (Tanzania)","jv-java-id":"ê¦§ê¦±ê¦ê¦® (Indonesia)","jv-latn-id":"Basa Jawa (Indonesia)","ka-ge":"á¥áá áá£áá (á¡áá¥áá ááááá)","kab-dz":"Taqbaylit (Lezzayer)","kam-ke":"Kikamba (Kenya)","kde-tz":"Chimakonde (Tanzania)","kea-cv":"kabuverdianu (Kabu Verdi)","khq-ml":"Koyra ciini (Maali)","ki-ke":"Gikuyu (Kenya)","kk-kz":"ÒÐ°Ð·Ð°Ò ÑÑÐ»Ñ (ÒÐ°Ð·Ð°ÒÑÑÐ°Ð½)","kkj-cm":"kakÉ (KamÉrun)","kl-gl":"kalaallisut (Kalaallit Nunaat)","kln-ke":"Kalenjin (Emetab Kenya)","km-kh":"ááááá (ááááá»áá¶)","kn-in":"à²à²¨à³à²¨à²¡ (à²­à²¾à²°à²¤)","ko-kp":"íêµ­ì´ (ì¡°ì ë¯¼ì£¼ì£¼ìì¸ë¯¼ê³µíêµ­)","ko-kr":"íêµ­ì´(ëíë¯¼êµ­)","kok-in":"à¤à¥à¤à¤à¤£à¥ (à¤­à¤¾à¤°à¤¤)","kr-latn-ng":"Kanuri (Nigeria)","ks-arab-in":"Ú©Ù²Ø´ÙØ± (Ø§ÙØ±Ø¨Û)","ks-deva-in":"à¤à¥à¤¶à¥à¤°","ksb-tz":"Kishambaa (Tanzania)","ksf-cm":"rikpa (kamÉrÃºn)","ksh-de":"KÃ¶lsch (DoÃ¼tschland)","ku-arab-iq":["Ú©ÙØ±Ø¯ÛÛ ÙØ§ÙÛÚØ§Ø³Øª (Ø¹ÛØ±Ø§Ù)",!0],"ku-arab-ir":"Ú©ÙØ±Ø¯Û (Ø¦ÛØ±Ø§Ù)","kw-gb":"kernewek (Rywvaneth Unys)","ky-kg":"ÐºÑÑÐ³ÑÐ·ÑÐ° (ÐÑÑÐ³ÑÐ·ÑÑÐ°Ð½)","la-001":"lingua latÄ«na (World)","lag-tz":"KÉ¨laangi (TaansanÃ­a)","lb-lu":"LÃ«tzebuergesch (LÃ«tzebuerg)","lg-ug":"Luganda (Yuganda)","lkt-us":"LakÈÃ³lÊ¼iyapi (MÃ­lahaÅska TÈamÃ¡kÈoÄhe)","ln-ao":"lingÃ¡la (AngÃ³la)","ln-cd":"lingÃ¡la (RepublÃ­ki ya KongÃ³ DemokratÃ­ki)","ln-cf":"lingÃ¡la (Repibiki ya AfrÃ­ka ya KÃ¡ti)","ln-cg":"lingÃ¡la (Kongo)","lo-la":"àº¥àº²àº§ (àº¥àº²àº§)","lrc-iq":"ÙÛØ±Û Ø´ÙÙØ§ÙÛ (Iraq)","lrc-ir":"ÙÛØ±Û Ø´ÙÙØ§ÙÛ (Iran)","lt-lt":"lietuviÅ³ (Lietuva)","lu-cd":"Tshiluba (Ditunga wa Kongu)","luo-ke":"Dholuo (Kenya)","luy-ke":"Luluhia (Kenya)","lv-lv":"latvieÅ¡u (Latvija)","mas-ke":"Maa (Kenya)","mas-tz":"Maa (Tansania)","mer-ke":"KÄ©mÄ©rÅ© (Kenya)","mfe-mu":"kreol morisien (Moris)","mg-mg":"Malagasy (Madagasikara)","mgh-mz":"Makua (Umozambiki)","mgo-cm":"metaÊ¼ (Kamalun)","mi-nz":"te reo MÄori (Aotearoa)","mk-mk":"Ð¼Ð°ÐºÐµÐ´Ð¾Ð½ÑÐºÐ¸ (Ð¡ÐµÐ²ÐµÑÐ½Ð° ÐÐ°ÐºÐµÐ´Ð¾Ð½Ð¸ÑÐ°)","ml-in":"à´®à´²à´¯à´¾à´³à´ (à´à´¨àµà´¤àµà´¯)","mn-mn":"Ð¼Ð¾Ð½Ð³Ð¾Ð» (ÐÐ¾Ð½Ð³Ð¾Ð»)","mn-mong-cn":"á ®á £á ©á ­á £á ¤á ¯ á ¬á ¡á ¯á ¡ (á ªá ¦á ­á ¦á ³á ¡ á ¨á  á ¢á ·á  á ®á ³á  á ¬á ¤ á ³á ¤á ®á ³á  á ³á ¤ á  á ·á  á ³ á £á ¯á £á °)","mn-mong-mn":"á ®á £á ©á ­á £á ¯ á ¬á ¡á ¯á ¡ (á ®á £á ©á ­á £á ¯ á £á ¯á £á °)","mni-in":"à¦®à§à¦¤à§à¦²à§à¦¨à§ (India)","moh-ca":"Kanien'kÃ©ha","mr-in":"à¤®à¤°à¤¾à¤ à¥ (à¤­à¤¾à¤°à¤¤)","ms-bn":"Melayu (Brunei)","ms-my":"Melayu (Malaysia)","ms-sg":"Melayu (Singapura)","mt-mt":"Malti (Malta)","mua-cm":"MUNDAÅ (kameruÅ)","my-mm":"áá¼ááºáá¬ (áá¼ááºáá¬)","mzn-ir":"ÙØ§Ø²Ø±ÙÙÛ (Ø§ÛØ±Ø§Ù)","naq-na":"Khoekhoegowab (Namibiab)","nb-no":"norsk bokmÃ¥l (Norge)","nb-sj":"norsk bokmÃ¥l (Svalbard og Jan Mayen)","nd-zw":"isiNdebele (Zimbabwe)","nds-de":"Neddersassâsch (DÃ¼Ã¼tschland)","nds-nl":"Neddersassâsch (Nedderlannen)","ne-in":"à¤¨à¥à¤ªà¤¾à¤²à¥ (à¤­à¤¾à¤°à¤¤)","ne-np":"à¤¨à¥à¤ªà¤¾à¤²à¥ (à¤¨à¥à¤ªà¤¾à¤²)"}),ve("nl","Nederlands",{aw:"Aruba",be:"BelgiÃ«",bq:"Bonaire, Sint Eustatius en Saba",cw:"CuraÃ§ao",nl:"Nederland",sr:"Suriname",sx:"Sint-Maarten"})),{"nmg-cm":"Kwasio (Kamerun)","nn-no":"nynorsk (Noreg)","nnh-cm":"ShwÃ³ÅÃ² ngiembÉÉn (KÃ malÃ»m)","nqo-gn":["ßßß (ßßß¬ß£ßß¬ ßßß²ßßß²)",!0],"nr-za":"isiNdebele (South Africa)","nso-za":"Sesotho sa Leboa (Afrika Borwa)","nus-ss":"Thok Nath (South Sudan)","nyn-ug":"Runyankore (Uganda)","oc-fr":"Occitan (FranÃ§a)","om-et":"Oromoo (Itoophiyaa)","om-ke":"Oromoo (Keeniyaa)","or-in":"à¬à­à¬¿à¬ (à¬­à¬¾à¬°à¬¤)","os-ge":"Ð¸ÑÐ¾Ð½ (ÐÑÑÑÐ´Ð·ÑÑÑÐ¾Ð½)","os-ru":"Ð¸ÑÐ¾Ð½ (Ð£ÓÑÓÑÐµ)","pa-arab-pk":["Ù¾ÙØ¬Ø§Ø¨Û (Ù¾Ø§Ú©Ø³ØªØ§Ù)",!0],"pa-in":"à¨ªà©°à¨à¨¾à¨¬à© (à¨­à¨¾à¨°à¨¤)","pap-029":"Papiamentu (Caribbean)","pl-pl":"polski (Polska)","prg-001":"prÅ«siskan (swÄ«tai)","prs-af":["Ø¯Ø±Ù (Ø§ÙØºØ§ÙØ³ØªØ§Ù)",!0],"ps-af":["Ù¾ÚØªÙ (Ø§ÙØºØ§ÙØ³ØªØ§Ù)",!0],"ps-pk":["Ù¾ÚØªÙ (Ù¾Ø§Ú©Ø³ØªØ§Ù)",!0]}),ve("pt","portuguÃªs",{ao:"Angola",br:"Brasil",ch:"SuÃ­Ã§a",cv:"Cabo Verde",gq:"GuinÃ© Equatorial",gw:"GuinÃ©-Bissau",lu:"Luxemburgo",mo:"RAE de Macau",mz:"MoÃ§ambique",pt:"Portugal",st:"SÃ£o TomÃ© e PrÃ­ncipe",tl:"Timor-Leste"})),{"qps-latn-x-sh":"PÅÄÃ¼ÄÏ SÄÅfhÃ³Å¡Å¥","qps-ploc":"[ÃÅ¡Ã©Å³Î´Ã´ (Î¡ÅÎ­Å©Î´Î¸) !!! !!]","qps-ploca":"[Î¡Å¡ÄÅ­ÄÃµ â¤Ã¡Î·ÄÅ±Ã£ÄÃ¨ (ÃÂ§ÑÅ«Ã°Ã² ÎÅÄ©Ã¤) !!! !!! ]","qps-plocm":["[ÃÂ§ÄÎ°Ã°Ï Â£Ã¤ÏÄÃºÐ°ÄÄ (Ð ÅÃ©Ã»ÄÐ± ÎÎ¯ÑÅÃ³Åâ®Ä) !!! !!! !]",!0],"quc-latn-gt":"K'iche' (Guatemala)","quz-bo":"Runasimi (Bolivia)","quz-ec":"Runasimi (Ecuador)","quz-pe":"Runasimi (PerÃº)","rm-ch":"rumantsch (Svizra)","rn-bi":"Ikirundi (Uburundi)","ro-md":"romÃ¢nÄ (Republica Moldova)","ro-ro":"romÃ¢nÄ (RomÃ¢nia)","rof-tz":"Kihorombo (Tanzania)"}),ve("ru","ÑÑÑÑÐºÐ¸Ð¹",{by:"ÐÐµÐ»Ð°ÑÑÑÑ",kg:"ÐÐ¸ÑÐ³Ð¸Ð·Ð¸Ñ",kz:"ÐÐ°Ð·Ð°ÑÑÑÐ°Ð½",md:"ÐÐ¾Ð»Ð´Ð¾Ð²Ð°",ru:"Ð Ð¾ÑÑÐ¸Ñ",ua:"Ð£ÐºÑÐ°Ð¸Ð½Ð°"})),{"rw-rw":"Kinyarwanda (U Rwanda)","rwk-tz":"Kiruwa (Tanzania)","sa-in":"à¤¸à¤à¤¸à¥à¤à¥à¤¤ (à¤­à¤¾à¤°à¤¤à¤®à¥)","sah-ru":"Ð¡Ð°ÑÐ° (Ð Ð¾ÑÑÐ¸Ñ)","saq-ke":"Kisampur (Kenya)","sbp-tz":"Ishisangu (Tansaniya)","sd-arab-pk":["Ø³ÙÚÙ (Ù¾Ø§Ú©Ø³ØªØ§Ù)",!0],"sd-deva-in":"à¤¸à¤¿à¤¨à¥à¤§à¥ (India)","se-fi":"davvisÃ¡megiella (Suopma)","se-no":"davvisÃ¡megiella (Norga)","se-se":"davvisÃ¡megiella (RuoÅ§Å§a)","seh-mz":"sena (MoÃ§ambique)","ses-ml":"Koyraboro senni (Maali)","sg-cf":"SÃ¤ngÃ¶ (KÃ¶dÃ¶rÃ¶sÃªse tÃ® BÃªafrÃ®ka)","shi-latn-ma":"Tashelá¸¥iyt (lmÉ£rib)","shi-tfng-ma":"âµâ´°âµâµâµâµâµ (âµâµâµâµâµâ´±)","si-lk":"à·à·à¶à·à¶½ (à·à·âà¶»à· à¶½à¶à¶à·à·)","sk-sk":"slovenÄina (Slovensko)","sl-si":"slovenÅ¡Äina (Slovenija)","sma-no":"Ã¥arjelsaemiengÃ¯ele (NÃ¶Ã¶rje)","sma-se":"Ã¥arjelsaemiengÃ¯ele (Sveerje)","smj-no":"julevusÃ¡megiella (Vuodna)","smj-se":"julevusÃ¡megiella (Svierik)","smn-fi":"anarÃ¢Å¡kielÃ¢ (SuomÃ¢)","sms-fi":"sÃ¤Ã¤Â´mÇ©iÃµll (LÃ¤Ã¤Â´ddjÃ¢nnam)","sn-latn-zw":"chiShona (Zimbabwe)"}),ve("so","Soomaali",{dj:"Jabuuti",et:"Itoobiya",ke:"Kenya",so:"Soomaaliya"})),{"sq-al":"shqip (ShqipÃ«ri)","sq-mk":"shqip (Maqedonia e Veriut)","sq-xk":"shqip (KosovÃ«)"}),ve("sr-cyrl","ÑÑÐ¿ÑÐºÐ¸",{ba:"ÐÐ¾ÑÐ½Ð° Ð¸ Ð¥ÐµÑÑÐµÐ³Ð¾Ð²Ð¸Ð½Ð°",cs:"Ð¡ÑÐ±Ð¸ÑÐ° Ð¸ Ð¦ÑÐ½Ð° ÐÐ¾ÑÐ° (ÐÐ¸Ð²ÑÐ°)",me:"Ð¦ÑÐ½Ð° ÐÐ¾ÑÐ°",rs:"Ð¡ÑÐ±Ð¸ÑÐ°",xk:"ÐÐ¾ÑÐ¾Ð²Ð¾"})),ve("sr-latn","srpski",{ba:"Bosna i Hercegovina",cs:"Srbija i Crna Gora (BivÅ¡a)",me:"Crna Gora",rs:"Srbija",xk:"Kosovo"})),{"ss-sz":"siSwati (eSwatini)","ss-za":"siSwati (South Africa)","ssy-er":"Saho (Eretria)","st-ls":"Sesotho (Lesotho)","st-za":"Sesotho (South Africa)","sv-ax":"svenska (Ãland)","sv-fi":"svenska (Finland)","sv-se":"svenska (Sverige)"}),ve("sw","Kiswahili",{cd:"Jamhuri ya Kidemokrasia ya Kongo",ke:"Kenya",tz:"Tanzania",ug:"Uganda"})),{"syr-sy":["Ü£ÜÜªÜÜÜ (Ü£ÜÜªÜÜ)",!0],"ta-in":"à®¤à®®à®¿à®´à¯ (à®à®¨à¯à®¤à®¿à®¯à®¾)","ta-lk":"à®¤à®®à®¿à®´à¯ (à®à®²à®à¯à®à¯)","ta-my":"à®¤à®®à®¿à®´à¯ (à®®à®²à¯à®à®¿à®¯à®¾)","ta-sg":"à®¤à®®à®¿à®´à¯ (à®à®¿à®à¯à®à®ªà¯à®ªà¯à®°à¯)","te-in":"à°¤à±à°²à±à°à± (à°­à°¾à°°à°¤à°¦à±à°¶à°)","teo-ke":"Kiteso (Kenia)","teo-ug":"Kiteso (Uganda)","tg-cyrl-tj":"ÑÐ¾Ò·Ð¸ÐºÓ£ (Ð¢Ð¾Ò·Ð¸ÐºÐ¸ÑÑÐ¾Ð½)","th-th":"à¹à¸à¸¢ (à¹à¸à¸¢)","ti-er":"áµáá­á (á¤á­áµá«)","ti-et":"áµáá­á (á¢áµá®áµá«)","tig-er":"áµáá¨ (á¤á­áµá«)","tk-tm":"TÃ¼rkmen dili (TÃ¼rkmenistan)","tn-bw":"Setswana (Botswana)","tn-za":"Setswana (Aforika Borwa)","to-to":"lea fakatonga (Tonga)","tr-cy":"TÃ¼rkÃ§e (KÄ±brÄ±s)","tr-tr":"TÃ¼rkÃ§e (TÃ¼rkiye)","ts-za":"Xitsonga (South Africa)","tt-ru":"Ð¢Ð°ÑÐ°Ñ (Ð Ð¾ÑÑÐ¸Ñ)","twq-ne":"Tasawaq senni (NiÅ¾er)","tzm-arab-ma":["Ø£Ø·ÙØ³ Ø§ÙÙØ±ÙØ²ÙØ© Ø§ÙØªØ§ÙØ§Ø²ÙØªÙØ© (Morocco)",!0],"tzm-latn-dz":"TamaziÉ£t n laá¹­laá¹£ (DjazaÃ¯r)","tzm-latn-ma":"TamaziÉ£t n laá¹­laá¹£ (Meá¹á¹uk)","tzm-tfng-ma":"âµâ´°âµâ´°âµ£âµâµâµ (âµâµâµâµâµâ´±)","ug-cn":["Ø¦ÛÙØºÛØ±ÚÛ (Ø¬ÛÚ­Ø®ÛØ§ Ø®ÛÙÙ Ø¬ÛÙÚ¾ÛØ±ÙÙÙØªÙ)",!0],"uk-ua":"ÑÐºÑÐ°ÑÐ½ÑÑÐºÐ° (Ð£ÐºÑÐ°ÑÐ½Ð°)","ur-in":["Ø§Ø±Ø¯Ù (Ø¨Ú¾Ø§Ø±Øª)",!0],"ur-pk":["Ø§ÙØ±Ø¯Ù (Ù¾Ø§Ú©Ø³ØªØ§Ù)",!0],"uz-arab-af":"Ø§ÙØ²Ø¨ÛÚ© (Ø§ÙØºØ§ÙØ³ØªØ§Ù)","uz-cyrl-uz":"ÑÐ·Ð±ÐµÐºÑÐ° (ÐÐ·Ð±ÐµÐºÐ¸ÑÑÐ¾Ð½)","uz-latn-uz":"oâzbek (OÊ»zbekiston)","vai-latn-lr":"Vai (Laibhiya)","vai-vaii-lr":"êê¤ (êê¤ê«ê©)","ve-za":"Tshivená¸a (South Africa)","vi-vn":"TiÃªÌng Viá»t (Viá»t Nam)","vo-001":"VolapÃ¼k (World)","vun-tz":"Kyivunjo (Tanzania)","wae-ch":"Walser (Schwiz)","wal-et":"ááá­á³á± (á¢áµá®áµá«)","wo-sn":"Wolof (Senegaal)","xh-za":"isiXhosa (eMzantsi Afrika)","xog-ug":"Olusoga (Yuganda)","yav-cm":"nuasue (KemelÃºn)","yi-001":["××Ö´×××© (×××¢××)",!0],"yo-bj":"ÃdÃ¨ YorÃ¹bÃ¡ (OrÃ­lÉÌÃ¨de BÉÌnÉÌ)","yo-ng":"ÃdÃ¨ YorÃ¹bÃ¡ (Oriláº¹Ì-Ã¨dÃ¨ NÃ Ã¬jÃ­rÃ­Ã )","zgh-tfng-ma":"âµâ´°âµâ´°âµ£âµâµâµ (âµâµâµâµâµâ´±)","zh-cn":"ä¸­æ(ä¸­å½)","zh-hk":"ä¸­æ(é¦æ¸¯ç¹å¥è¡æ¿å)","zh-hans-hk":"ä¸­æ (é¦æ¸¯ç¹å«è¡æ¿åº)","zh-hans-mo":"ä¸­æ (æ¾³é¨ç¹å«è¡æ¿åº)","zh-mo":"ä¸­æ(æ¾³éç¹å¥è¡æ¿å)","zh-sg":"ä¸­æ(æ°å å¡)","zh-tw":"ä¸­æ(å°ç£)","zu-za":"isiZulu (iNingizimu Afrika)"}),_e=(e,t=!1,n)=>{let i;const r=e.toLocaleLowerCase(),o=ye[r];if(o&&(i=Array.isArray(o)?{languageId:e,languageName:o[0],isRtl:o[1]}:{languageId:e,languageName:o,isRtl:!1}),!i&&t){const e=oe.Y[r];if(e){const t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[1]:void 0,r=ye[t.toLocaleLowerCase()],o=!!Array.isArray(r)&&r[1],a=Array.isArray(r)?r[0]:r;i={languageId:t,languageName:null!=n?n:a,isRtl:o}}}if(i&&n){const e=i.languageId.toLocaleLowerCase();n.find((t=>t.toLocaleLowerCase()===e))||(i=void 0)}return i},be=e=>{const t=new Map;for(const n of e){if(!n.languageId)continue;const e=_e(n.languageId);e&&!t.has(n.languageId)&&t.set(n.languageId,e)}return Array.from(t.values())},Ce=["af-ZA","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-YE","as-IN","az-Latn-AZ","bg-BG","bn-BD","bn-IN","bs-Latn-BA","ca-ES","ca-ES-valencia","cs-CZ","cy-GB","da-DK","de-AT","de-CH","de-DE","de-LI","de-LU","el-GR","en-029","en-AU","en-BZ","en-CA","en-CB","en-GB","en-HK","en-ID","en-IE","en-IN","en-JM","en-MY","en-NZ","en-PH","en-SG","en-TT","en-US","en-ZA","en-ZW","es-419","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-ES","es-ES_tradnl","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et-EE","eu-ES","fa-IR","fi-FI","fr-BE","fr-CA","fr-CD","fr-CH","fr-CI","fr-CM","fr-FR","fr-HT","fr-LU","fr-MA","fr-MC","fr-ML","fr-RE","fr-SN","ga-IE","gd-GB","gl-ES","gu-IN","ha-Latn-NG","he-IL","hi-IN","hr-BA","hr-HR","hu-HU","hy-AM","id-ID","ig-NG","is-IS","it-CH","it-IT","ja-JP","ka-GE","kk-KZ","kn-IN","kok-IN","ko-KR","ky-KG","lb-LU","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-BN","ms-MY","mt-MT","nb-NO","ne-IN","ne-NP","nl-BE","nl-NL","nn-NO","nso-ZA","or-IN","pa-IN","pl-PL","ps-AF","pt-BR","pt-PT","rm-CH","ro-MD","ro-RO","ru-MD","ru-RU","rw-RW","si-LK","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-CS","sr-Cyrl-ME","sr-Cyrl-RS","sr-Latn-BA","sr-Latn-CS","sr-Latn-ME","sr-Latn-RS","sv-FI","sv-SE","sw-KE","ta-IN","te-IN","th-TH","tn-BW","tn-ZA","tr-TR","tt-RU","uk-UA","ur-IN","ur-PK","uz-Latn-UZ","vi-VN","wo-SN","xh-ZA","yo-NG","zu-ZA"];let Te=class{constructor(){this.bxSupportedLanguages=Ce.map((e=>({languageId:e})))}getLanguageInfo(e){return _e(e,!0,Ce)}mapToLanguageInfo(e){return be(e)}bxDefaultSupportedLanguages(){return be(this.bxSupportedLanguages)}};Te=(0,i.__decorate)([(0,g._)()],Te);var Se=n(83732),Ie=n(91822),we=n(46546),Ee=n(92037);let xe=class{constructor(e,t,n,i,r){this._proofingStore=e,this._logger=t,this._settingsEmitter=n,this._localizer=i,this._languageInfo=r,this._languageAddMode=!1,this._actionStatus="",this._selectedKey=null,this.getLocalized=e=>this._localizer.getMessage(e),this.getLanguageName=e=>{var t;const n=this._languageInfo.getLanguageInfo(e);return null!==(t=null==n?void 0:n.languageName)&&void 0!==t?t:e},this.updateProofingLanguages=async()=>{const e=new Ie.I(await this._proofingStore.read(U.l.ProofingLanguages));(0,we.runInAction)((()=>{this.proofingLanguages=e}))},this.setActionStatus=(e,t)=>{const n=this.getLanguageName(t),i=t===n?t:`${t}. ${n}`,r=this._localizer.getMessage(e,i);this._actionStatus=r},this.proofingLanguages=new Ie.I(this._proofingStore.getDefaultValue(U.l.ProofingLanguages)),(0,Ee.Gn)(this)}get languageAddMode(){return this._languageAddMode}get actionStatus(){return this._actionStatus}get canAddLanguage(){return this.proofingLanguages.count<3}get canRemoveLanguage(){return this.proofingLanguages.count>1}get selectedKey(){return this._selectedKey}addSelected(){const e=this._selectedKey;!e||this.proofingLanguages.count>=3||(this.proofingLanguages.add(e),this.setActionStatus("ebx_languageAdded",e),this.setLanguageAddMode(!1))}remove(e){this.proofingLanguages.count>1&&(this.proofingLanguages.remove(e),this.setActionStatus("ebx_languageRemoved",e))}moveUp(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveUp(e),this.setActionStatus("ebx_languageMovedUp",e))}moveDown(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveDown(e),this.setActionStatus("ebx_languageMovedDown",e))}moveToTop(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveToTop(e),this.setActionStatus("ebx_languageMovedToTop",e))}setLanguageAddMode(e){this._languageAddMode=e}async revertChanges(){const e=new Ie.I(await this._proofingStore.read(U.l.ProofingLanguages));(0,we.runInAction)((()=>{this.proofingLanguages=e}))}async save(){await this._proofingStore.write(U.l.ProofingLanguages,this.proofingLanguages.codesList),this._logger.debug(512242964,`[ProofingLanguageStateStore] Saved proofing languages setting: ${this.proofingLanguages.codesList}`),await this._proofingStore.read(U.l.ProofingLanguageListInitialized)||await this._proofingStore.write(U.l.ProofingLanguageListInitialized,!0)}async initialize(){this._settingsEmitter.on(U.l.ProofingLanguages,this.updateProofingLanguages),this._logger.debug(512242963,"[ProofingLanguageStateStore] Sending load languages request to background script"),this.proofingLanguages=new Ie.I(await this._proofingStore.read(U.l.ProofingLanguages))}shutDown(){}setSelectedKey(e){this._selectedKey=e}};(0,i.__decorate)([we.observable],xe.prototype,"proofingLanguages",void 0),(0,i.__decorate)([we.observable],xe.prototype,"_languageAddMode",void 0),(0,i.__decorate)([we.computed],xe.prototype,"languageAddMode",null),(0,i.__decorate)([we.observable],xe.prototype,"_actionStatus",void 0),(0,i.__decorate)([we.computed],xe.prototype,"actionStatus",null),(0,i.__decorate)([we.computed],xe.prototype,"canAddLanguage",null),(0,i.__decorate)([we.computed],xe.prototype,"canRemoveLanguage",null),(0,i.__decorate)([we.observable],xe.prototype,"_selectedKey",void 0),(0,i.__decorate)([we.computed],xe.prototype,"selectedKey",null),(0,i.__decorate)([we.action],xe.prototype,"addSelected",null),(0,i.__decorate)([we.action],xe.prototype,"remove",null),(0,i.__decorate)([we.action],xe.prototype,"moveUp",null),(0,i.__decorate)([we.action],xe.prototype,"moveDown",null),(0,i.__decorate)([we.action],xe.prototype,"moveToTop",null),(0,i.__decorate)([we.action],xe.prototype,"setLanguageAddMode",null),(0,i.__decorate)([we.action],xe.prototype,"setSelectedKey",null),(0,i.__decorate)([we.action],xe.prototype,"setActionStatus",void 0),xe=(0,i.__decorate)([(0,g._)(),(0,i.__param)(0,(0,p.W)(s.K)),(0,i.__param)(1,(0,p.W)(u.g)),(0,i.__param)(2,(0,p.W)(q.E)),(0,i.__param)(3,(0,p.W)(ne.H)),(0,i.__param)(4,(0,p.W)(me))],xe);class Ae{constructor(){this.imports=[]}get uniqueId(){return(0,S.z)(507918307)}configureRootServices(e){e.bind(me).to(Te),e.bind(Se.e).to(xe),e.bind(w.S).toExisting(Se.e)}}var De=n(19432),Ne=n(83225),Fe=n(74847),Pe=n(59886);let ke=class extends De.z{constructor(e,t,n,i,r,o){super(),this.languageInfoProvider=e,this.languageDetector=t,this.proofingStore=n,this.hostSettings=i,this.targetRenderElement=r,this.emitter=o,this._proofingLanguageDirCache={},this._defaultProofingLanguageDir=ce.K3.auto,this._uxLanguageDir=ce.K3.auto,this.updateProofingLanguageDir=e=>{this._defaultProofingLanguageDir=this.getLanguageDir(e)},this.updateUxLanguageDir=()=>{const e=this.languageDetector.getUILanguage();this._uxLanguageDir=this.getLanguageDir(e),this.publishEvent("stateUpdated",{uxLanguageDir:this.uxLanguageDir,optionsUxLanguageDir:this.optionsUxLanguageDir})},this.getLanguageDir=e=>{const t=this.languageInfoProvider.getLanguageInfo(e);return t?t.isRtl?ce.K3.rtl:ce.K3.ltr:ce.K3.auto},(0,Ee.Gn)(this),this.updateUxLanguageDir(),this.proofingStore.read(U.l.ProofingLanguages).then((e=>this.updateProofingLanguageDir(Ie.I.getDefaultLanguageCode(e)))).catch((()=>{})),this.emitter&&this.emitter.on("proofingLanguageChanged",(async e=>{e.proofingLanguagesChanged&&this.updateProofingLanguageDir(e.data.defaultLanguageCode)}))}get uxLanguageDir(){return this.hostSettings.manageRtlInEditorUx?this._uxLanguageDir:ce.K3.auto}get optionsUxLanguageDir(){return this._uxLanguageDir}isRtl(){var e,t;if(this.uxLanguageDir!==ce.K3.auto)return this.uxLanguageDir===ce.K3.rtl;const n=null===(e=this.targetRenderElement())||void 0===e?void 0:e.deref();return void 0!==n&&(null!==(t=n.ownerDocument.defaultView)&&void 0!==t?t:window).getComputedStyle(n).direction===ce.K3.rtl}dir(){return this.isRtl()?"rtl":"ltr"}getProofingLanguageDir(e){if(!this.hostSettings.manageRtlForProofingLanguage)return ce.K3.auto;if(!e)return this._defaultProofingLanguageDir;let t=this._proofingLanguageDirCache[e];return t||(t=this.getLanguageDir(e),this._proofingLanguageDirCache[e]=t),t}};(0,i.__decorate)([we.observable],ke.prototype,"_uxLanguageDir",void 0),(0,i.__decorate)([we.computed],ke.prototype,"uxLanguageDir",null),(0,i.__decorate)([we.action],ke.prototype,"updateProofingLanguageDir",void 0),(0,i.__decorate)([we.action],ke.prototype,"updateUxLanguageDir",void 0),ke=(0,i.__decorate)([(0,g._)(),(0,i.__param)(0,(0,p.W)(me)),(0,i.__param)(1,(0,p.W)(Ne.v)),(0,i.__param)(2,(0,p.W)(s.K)),(0,i.__param)(3,(0,p.W)(c.n)),(0,i.__param)(4,(0,p.W)(Fe.oA)),(0,i.__param)(5,(0,f.l)()),(0,i.__param)(5,(0,p.W)(Pe.o))],ke);class Oe{constructor(){this.imports=[de,Ae]}get uniqueId(){return(0,S.z)(507918214)}configureRootServices(e){e.bind(ce.iw).to(ke),e.bind(w.S).to(fe)}}},94940:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var i=n(20399),r=n(59834);class o{static logUnhandledError(e,t,n,o){e.logEvent(508055843,n,i.q.Error,o,r.o.SamplingPolicy.CriticalExperimentation,t)}static addUnhandledExceptionsListeners(e,t,n){}}},39584:(e,t,n)=>{"use strict";var i;n.d(t,{s:()=>i}),function(e){e.UnhandledContentError="RunTimeErrors.UnhandledContentError",e.UnhandledBackgroundError="RunTimeErrors.UnhandledBackgroundError",e.UnhandledOptionsPageError="RunTimeErrors.UnhandledOptionsPageError"}(i||(i={}))},41977:(e,t,n)=>{"use strict";n.d(t,{Q:()=>T});var i=n(66279),r=n(95920),o=n(41887),a=n(30206),s=n(20399),l=n(13494),u=n(99828),d=n(44680),c=n(86278),h=n(38716),g=n(48828),p=n(30122),f=n(90424),m=n(26017),v=n(28871);let y=class{constructor(e,t,n,i,r){this._hostEmitters=e,this._hostSettings=t,this._logger=n,this._nudgeStore=i,this._localizer=r,this.onNudgeEvent=e=>{if(!e.message.data.tileId)return void this._logger.log(510248464,s.q.Error,"INudge message: Received undefined args.");const t=e.message.data;t.text=this.getNudgeMessage(t.entityType);const n=Object.assign(Object.assign({eventType:e.message.messageType},t),{nudge:t});this.onEvent(n)},this.messagePerEntityType={[m.c.File]:"nudgeTextForFile",[m.c.People]:"nudgeTextForPeople",[m.c.Event]:"nudgeTextForMeetings",[m.c.Message]:"nudgeTextForEmails"}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(l.pD.nudgeTriggered,this.onNudgeEvent)}shutDown(){}async onEvent(e){e.eventType===u.G.NewData?await this._nudgeStore.updateNudge(e.nudge):await this._nudgeStore.clearNudge()}getNudgeMessage(e){var t,n,i;const r=null!==(i=null===(n=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===n?void 0:n.insertionCharacter)&&void 0!==i?i:"@";return this._localizer.getMessage(this.messagePerEntityType[e],r)}};y=(0,a.__decorate)([(0,g._)(),(0,a.__param)(0,(0,p.t)(l.zJ)),(0,a.__param)(1,(0,f.W)(d.n)),(0,a.__param)(2,(0,f.W)(c.g)),(0,a.__param)(3,(0,f.W)(v.Y)),(0,a.__param)(4,(0,f.W)(h.H))],y);var _=n(97105),b=n(97428),C=n(29714);class T{constructor(){this.imports=[o.d,_.J,i.w]}get uniqueId(){return(0,b.z)(507918280)}configureRootServices(e){e.bind(y).toSelf(),e.bind(C.S).toExisting(y),e.bind(v.Y).to(v.h),e.bind(r.V).to(r.S),e.bind(C.S).toExisting(r.V)}}},53024:(e,t,n)=>{"use strict";var i,r;n.d(t,{Hs:()=>s,Tm:()=>o,EM:()=>a}),(r=i||(i={}))[r.Remote=0]="Remote",r[r.System=1]="System",r[r.User=2]="User";const o=(e,t)=>({name:e,storeEntryType:i.Remote,defaultValue:t,lastValueFromStorage:void 0}),a=(e,t,n)=>({name:e,storeEntryType:i.User,defaultValue:t,lastValueFromStorage:void 0,shouldNotWriteDefaultValue:n});var s;!function(e){e.FeatureFlags="featureFlags",e.DynamicSettings="dynamicSettings"}(s||(s={}))},889:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const i=(0,n(63837).f)("IStoreEntryReader")},31957:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});const i=(0,n(63837).f)("IStoreEntryWriter")},48845:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});const i=(0,n(63837).f)("ISettingsEmitterBase")},19100:(e,t,n)=>{"use strict";n.d(t,{p:()=>Y});var i=n(46785),r=n(7523),o=n(97428),a=n(44680),s=n(29714),l=n(58889),u=n(30206),d=n(19432),c=n(20399),h=n(59834),g=n(86278),p=n(48828),f=n(90424),m=n(72783),v=n(36230),y=n(1149);let _=class extends y.t{constructor(e){super(e)}checkUserInfo(){return void 0===this.ageGroup||this.ageGroup===m.P2.Adult||this.ageGroup===m.P2.MinorNoParentalConsentRequired||this.ageGroup===m.P2.Unknown}};_=(0,u.__decorate)([(0,p._)(),(0,u.__param)(0,(0,f.W)(v.e))],_);let b=class extends y.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===m.P2.NotAdult}};b=(0,u.__decorate)([(0,p._)(),(0,u.__param)(0,(0,f.W)(v.e))],b);let C=class extends y.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===m.P2.MinorWithoutParentalConsent||this.ageGroup===m.P2.MinorWithParentalConsent}};C=(0,u.__decorate)([(0,p._)(),(0,u.__param)(0,(0,f.W)(v.e))],C);var T,S,I=n(30225);!function(e){e.RemoteSettingSync="RemoteSettingSync"}(T||(T={})),function(e){e.SettingsSyncWriteError="RunTimeErrors.SettingSyncWriteError",e.SettingsSyncEditorRequestBuildError="RunTimeErrors.SettingsSyncEditorRequestBuildError",e.SettingsSyncEditorServiceError="RunTimeErrors.SettingSyncEditorServiceError",e.SettingsSyncReadOverrideError="RunTimeErrors.SettingSyncReadOverrideError",e.SettingReadError="RunTimeErrors.SettingReadError",e.SettingInitializeError="RunTimeErrors.SettingInitializeError",e.SettingManualOverrideWarning="RunTimeErrors.SettingManualOverrideWarning",e.SettingWriteError="RunTimeErrors.SettingWriteError",e.FeatureFlagParsingError="RunTimeErrors.FeatureFlagParsingError",e.DynamicSettingsParsingError="RunTimeErrors.DynamicSettingsParsingError"}(S||(S={}));var w=n(48845),E=n(889),x=n(53024);const A={enableConflictDetectionAnnouncement:!1,enableUpsellFeature:!1,enableMultiLanguageAnnouncement:!1,enableNotifications:!1,enableOptimizedCallingPattern:!1,enableOptimizedRehydration:!1,enablePostUpsellAnnouncement:!1,enableInternalMailFeedback:!1,enableOrchestration:!1,enableV2RoamingDictionary:!1,enableSignInAnnouncement:!1,enableSignInAnnouncementAlternativeText:!1,enableRateExtensionPrompt:!1,enableRateExtensionPromptEdge:!1,enableRateExtensionPromptFpsSurvey:!1,enableEnhancedUpsell:!1,enablePremiumPreview:!1,enableUnsignedInEditor:!1,enableSuppressUnsignedInEditorForMultiLang:!1,enableCritiqueSettings:!1,enableOcvIntEndpoint:!1,enableOcvFeedbackUi:!1,enableE2eMetric:!1,enableKeptMetric:!1,enableAriaStatusElement:!1,enableCssHighlightApiAnnouncementsOnly:!1,enableLineNavAriaAnnouncement:!1,enableCSSHighlightApiSquiggleRendering:!1,enableVisibilityTracker:!1,enableSquigglesUpdateThrottling:!1,mutationObserverBasedRelativePosition:!1,visibilityTrackerShouldTrackSquiggles:!0,enableCursorIntersectionObserver:!1,isMsitUser:!1,enableDispatchCritiquesOnEmptyDiffs:!0,enableSignInAnnouncementReshownWeekly:!1,enableSignInAnnouncementReshownBiweekly:!1,enableSignInAnnouncementReshownMonthly:!1,enableTargetedUpsell:!1,inferenceCritiqueCloudIconEnabled:!1,enableAutoCorrect:!1,enablePersonalizedAutoCorrect:!1,enableParagraphUpdates:!1,enableForceClearCritiques:!0,enableConditionalSignInMessage:!1,disableCalcLengthForAddDeltasInPresentation:!0,enableAnnotationActivationConfig:!0,enableAutoCorrectInputCache:!1,enableBetaExperience:!1,enableRoamingService:!1,enableWacCrossPromo:!1,enableAriaStatusPostMessage:!1,enableAriaStatusInNonRootIFrames:!1,enablePhraseTextUnitClientSide:!1,enableAadc:!1,enableBetaExperienceTelemetry:!1,enableUserDictionaryAnnouncement:!1,enableParagraphDeltas:!1,enableOrchestratorOverriddenCritiqueTypeOptions:!1,enableOrchestratorCritiqueDeletion:!1,enableRequiredServiceDataOnly:!1,disableBxOptionalPrivacySetting:!1,enableParagraphDeltasVerboseLogging:!1,enableParagraphDeltasEmptyInitialTile:!1,enableGDocsAnnotatedCanvas:!1,disableTileNodeObserver:!1,enableQueryOnlyOnLocalChange:!1,enableSvgSquiggleUnderline:!1,enableEditorServiceRouting:!1,enableCopywriter:!1,disableCalloutOnDoubleClick:!1,disableAutoBrowserVirtualizationOfSquiggles:!1,enableGDocsSuppressNativeSquiggles:!1,enableUserInfoCountry:!1,enableNonProveableElements:!0,enableSynonyms:!1,enableAiInsert:!1,enableAiInsertForInputTexarea:!1,enableSquigglesOnlyOnWholeWords:!1,disableECCMenuRecreationOnALReconnection:!1,enableLoggingModulesAndBindings:!1,enableResignInPrompt:!1,enableMagicWindow:!1,enableAttributionRangeExceptionInFormattedTextDeltas:!1,enableAttributionRangeInAddDelta:!1};let D=class{constructor(e,t,n,i,r,o){this._emitter=e,this._storeEntryReader=t,this._logger=n,this._isAdult=i,this._isMinor=r,this._isChild=o,this._defaultAdultOnlyFeature={enableUpsellFeature:!0},this._defaultMinorAndAboveFeature={enableBxTelemetry:!0,enableRateExtensionPrompt:!0,enableRateExtensionPromptEdge:!0,enableRateExtensionPromptFpsSurvey:!0,enableOcvIntEndpoint:!0,enableOcvFeedbackUi:!0,enableUninstallSurvey:!0},this._defaultFeatureFlags=Object.assign(Object.assign(Object.assign({},this._defaultMinorAndAboveFeature),this._defaultAdultOnlyFeature),A),this._rolloutFeatureFlags=(0,x.Tm)(x.Hs.FeatureFlags,A),this._localFlags=Object.assign({},this._defaultFeatureFlags),this._flagOverrides={},this.updatedAdultOnlyFeatureFlags=e=>{var t;const n=!this.areAgeGroupPredicatesProvided()||!!(null===(t=this._isAdult)||void 0===t?void 0:t.check()),i=Object.assign({},this._defaultAdultOnlyFeature);for(const t in this._defaultAdultOnlyFeature)i[t]=n&&e[t];return i},this.updateMinorAndAboveFeatureFlags=e=>{var t,n;const i=!this.areAgeGroupPredicatesProvided()||!!(null===(t=this._isMinor)||void 0===t?void 0:t.check())||!!(null===(n=this._isAdult)||void 0===n?void 0:n.check()),r=Object.assign({},this._defaultMinorAndAboveFeature);for(const t in this._defaultMinorAndAboveFeature)r[t]=i&&e[t];return r},this.areAgeGroupPredicatesProvided=()=>!!(this._isAdult&&this._isChild&&this._isMinor),this._eventPublisher=new d.z}get flags(){return this._localFlags}overrideFlags(e){this._flagOverrides=e,this.applyFlagOverrides()}applyFlagOverrides(){this._localFlags=Object.assign(Object.assign({},this._localFlags),this._flagOverrides)}async refreshFlags(){return await this.updateFlags(),this.flags}async initialize(){this._emitter.on(x.Hs.FeatureFlags,(()=>{this.updateFlags()})),await this.updateFlags()}shutDown(){}async updateFlags(){try{const e=await this._storeEntryReader.readOrInitialize(this._rolloutFeatureFlags);let t=Object.assign(Object.assign({},this._defaultFeatureFlags),...Object.entries(e).map((([e,t])=>{return{[e]:(n=t,"string"==typeof n?"true"===n.toLowerCase():!0===n)};var n})));if(t.enableAadc){const e=this.updateMinorAndAboveFeatureFlags(t),n=this.updatedAdultOnlyFeatureFlags(t);t=Object.assign(Object.assign(Object.assign({},t),e),n)}this._localFlags=t,this.applyFlagOverrides(),this.publishEvent("flagsChanged",this.flags)}catch(e){this._logger.logEvent(571318787,S.FeatureFlagParsingError,c.q.Error,void 0,h.o.SamplingPolicy.Diagnostics)}}subscribe(e,t){this._eventPublisher.subscribe(e,t)}unsubscribe(e,t){this._eventPublisher.unsubscribe(e,t)}publishEvent(e,t){this._eventPublisher.publishEvent(e,t)}};D=(0,u.__decorate)([(0,p._)(),(0,u.__param)(0,(0,f.W)(w.E)),(0,u.__param)(1,(0,f.W)(E.A)),(0,u.__param)(2,(0,f.W)(g.g)),(0,u.__param)(3,(0,I.l)()),(0,u.__param)(3,(0,f.W)(_)),(0,u.__param)(4,(0,I.l)()),(0,u.__param)(4,(0,f.W)(b)),(0,u.__param)(5,(0,I.l)()),(0,u.__param)(5,(0,f.W)(C))],D);var N,F=n(63837);!function(e){e.LocalStorageApi="LocalStorageApi"}(N||(N={}));const P=(0,F.f)("IBrowserStorageApi");var k,O=n(8903),B=n(31957),R=n(23094);let L=k=class{constructor(){this.eventListener=new R.J(document)}async initialize(){}shutDown(){this.eventListener.removeAllListeners()}async set(e){const t=Object.keys(e),n={};for(const i of t){const t=e[i];n[i]={oldValue:localStorage.getItem(i),newValue:t};try{localStorage.setItem(i,t)}catch(e){return Promise.reject(e)}}const i=new CustomEvent("storageItemInserted",{detail:n});return document.dispatchEvent(i),Promise.resolve()}async remove(e){if("string"==typeof e)localStorage.removeItem(e);else if(Array.isArray(e))for(const t of e)localStorage.removeItem(t);return Promise.resolve()}async get(e){const t={};if("string"==typeof e)t[e]=k._getItem(e);else if(Array.isArray(e))for(const n of e)t[n]=k._getItem(n);else if(e instanceof Object){const n=Object.keys(e);for(const i of n){const n=k._getItem(i);t[i]=n||e[i]}}return Promise.resolve(t)}addChangeListener(e){this.eventListener.addListener("storageItemInserted",(t=>{t.detail&&e(t.detail,"")}))}removeEventListener(e){this.eventListener.removeAllListeners()}static _getItem(e){const t=localStorage.getItem(e);if(t)try{const e=JSON.parse(t);return void 0!==e.value&&e.lastUpdated&&void 0!==e.manualOverride?t:e}catch(e){return t}return null}};L=k=(0,u.__decorate)([(0,p._)()],L);let M=class{constructor(e){this._browserStorage=e,this.registrations={},this.eventNamesUsed=new Set,this._storageChangeDispatcherCallback=async(e,t)=>this._storageChangeDispatcher(e,t)}safelyGetRegistration(e){return this.registrations[e]||(this.registrations[e]={listeners:[]}),this.registrations[e]}on(e,t){this.safelyGetRegistration(e).listeners.push(t),this.eventNamesUsed.add(e)}async initialize(){this._browserStorage.addChangeListener(this._storageChangeDispatcherCallback)}shutDown(){this._browserStorage.removeEventListener(this._storageChangeDispatcherCallback);for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}_storageChangeDispatcher(e,t){for(const t of Object.keys(e)){const n=JSON.parse(e[t].oldValue),i=JSON.parse(e[t].newValue);(null==n?void 0:n.value)!==(null==i?void 0:i.value)&&this.callListeners(t,e[t].newValue)}}callListeners(e,t){const n=e,i=this.safelyGetRegistration(n);for(const e of i.listeners)e(t)}onFirst(e,t){throw Error("onFirst is not implemented for SettingsEmitter")}onAny(e){throw Error("onAny is not implemented for SettingsEmitter")}async waitFor(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}async waitForFirst(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}off(e,t){if(void 0!==e)if(void 0!==t){if(!((e,t)=>{let n=!1;for(let i=0;i<e.length;i+=1)e[i]===t&&(n=!0,e.splice(i,1),i-=1);return n})(this.safelyGetRegistration(e).listeners,t))throw new Error(`Tried to remove a non-existent listener for event name '${e}'.`)}else this.registrations[e]={listeners:[]};else this.registrations={}}emit(e,...t){const n=this.safelyGetRegistration(e);for(const e of n.listeners)e(...t)}};M=(0,u.__decorate)([(0,p._)(),(0,u.__param)(0,(0,f.W)(P))],M);let q=class{constructor(e){this._extensionStorage=e}getLastError(){return this._lastError}setLastError(e){this._lastError=e}async writeSetting(e,t){const n={value:JSON.stringify(t),lastUpdated:Date.now(),manualOverride:!1},i={};i[e]=JSON.stringify(n),await this._extensionStorage.set(i)}};q=(0,u.__decorate)([(0,p._)(),(0,u.__param)(0,(0,f.W)(P))],q);let U=class extends q{constructor(e,t){super(e),this._logger=t}async readOrInitialize(e){try{const t=await this.readStoredSetting(e);if(t){if(t.value){const n=JSON.parse(t.value);return t.manualOverride&&void 0!==n?n:(e.lastValueFromStorage=n,void 0!==n?n:e.defaultValue)}}else try{return e.shouldNotWriteDefaultValue||await this.writeSetting(e.name,e.defaultValue),e.defaultValue}catch(e){this._logger.logEvent(521479644,S.SettingInitializeError,c.q.Error,void 0,h.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}catch(e){this._logger.logEvent(521479643,S.SettingReadError,c.q.Error,void 0,h.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return void 0!==e.lastValueFromStorage?e.lastValueFromStorage:e.defaultValue}async readLastUpdatedTimestamp(e){try{const t=await this.readStoredSetting(e);if(t)return t.lastUpdated}catch(e){this._logger.logEvent(521479642,S.SettingReadError,c.q.Error,void 0,h.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async readStoredSetting(e){const t=await this._extensionStorage.get(e.name);if(t[e.name])return JSON.parse(t[e.name])}};U=(0,u.__decorate)([(0,p._)(),(0,u.__param)(0,(0,f.W)(P)),(0,u.__param)(1,(0,f.W)(g.g))],U);let W=class extends q{constructor(e,t){super(e),this._logger=t}async write(e,t){try{let n=!1;const i=await this._extensionStorage.get(e.name);i[e.name]&&(n=JSON.parse(i[e.name]).manualOverride),n?this._logger.logEvent(521479641,S.SettingManualOverrideWarning,c.q.Warn,`manual override for store entry ${e.name} - writing skipped`,h.o.SamplingPolicy.Measure):await this.writeSetting(e.name,t)}catch(e){this._logger.logEvent(521479640,S.SettingWriteError,c.q.Error,void 0,h.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async remove(e){await this._extensionStorage.remove(e)}};W=(0,u.__decorate)([(0,p._)(),(0,u.__param)(0,(0,f.W)(P)),(0,u.__param)(1,(0,f.W)(g.g))],W);class j{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918231)}configureRootServices(e){e.bind(O.c).to(D),e.bind(s.S).toExisting(O.c),e.bind(E.A).to(U),e.bind(B.a).to(W),e.bind(P).to(L),e.bind(s.S).toExisting(P),e.bind(w.E).to(M),e.bind(s.S).toExisting(w.E)}}var z=n(95988),H=n(47954),V=n(98287),G=n(72971),Q=n(40747),K=n(1628);function $(e){const t={value:JSON.stringify(e),lastUpdated:Date.now(),manualOverride:!1};return JSON.stringify(t)}function Z(e){return{descriptors:$(e.descriptors),disabledWebSites:$(e.disabledWebSites),allowedUrls:$(e.allowedUrls),disabledGrammars:$(e.disabledGrammars),editorClientState:$(e.editorClientState),configurationId:$(e.configurationId),featureFlags:$(e.featureFlags),dynamicSettings:$(e.dynamicSettings),intervalForActivityCleanup:$(e.intervalForActivityCleanup),conflictingElements:$(e.conflictingElements)}}let J=class extends q{constructor(e,t,n,i,r,o,a,s){super(e),this._editorService=t,this._proofingStore=n,this._logger=i,this._userInfoStrategy=r,this._sessionContextProvider=o,this._guidGenerator=a,this._timer=s,this._timerName="RemoteSettingsSyncerTimer"}async initialize(){}shutDown(){this._timer.clearTimer(this._timerName)}schedule(e,t){this._timer.setIntervalWithDelay(this._timerName,(async()=>this.sync()),t,e)}async sync(){this._logger.debug(537518984,"Starting remote settings sync");const e=await this.buildRequest();if(e){const t=await this.fetchRemoteSettings(e);if(t&&t.responseStatus===z.ED.Success){this.logTelemetry(e);const n=Z(t),i=await this.removeManualOverrides(n);if(i)return this._logger.debug(537518985,"Writing remote settings to local storage"),this.writeSettings(i)}}return this._logger.debug(537518986,"No remote settings were synced"),!1}async writeSettings(e){try{return await this._extensionStorage.set(e),!0}catch(e){this._logger.logEvent(537518987,S.SettingsSyncWriteError,c.q.Error,void 0,h.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return!1}async fetchClientId(){try{const e=await this._proofingStore.read(H.l.ClientId);if(!e||""===e){const e=this._guidGenerator.generate();return await this._proofingStore.write(H.l.ClientId,e),e}return e}catch(e){return""}}async buildRequest(){var e;try{const t=await this._sessionContextProvider();let n,i;const r=await this.fetchClientId(),o=await this._userInfoStrategy.executeAsync(!1);return(null==o?void 0:o.userId)?(this._editorService.xUserId=o.userId,n=o.tenantId,i=o.email):this._editorService.xUserId=r,{appId:await this._proofingStore.read(H.l.AppId),browser:t.browserType,browserVersion:null!==(e=t.browserVersion)&&void 0!==e?e:"",email:i,extensionId:t.extensionVersion,languageUxId:t.languageUxId,storeId:t.extensionStoreId,tenantId:n,firstInstallVersion:void 0}}catch(e){this._logger.logEvent(537518988,S.SettingsSyncEditorRequestBuildError,c.q.Error,void 0,h.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}logTelemetry(e){if(this._lastConfigRequestUserId&&this._lastConfigRequestUserId===this._editorService.xUserId&&this._lastConfigRequest&&this._lastConfigRequest.browserVersion===e.browserVersion&&this._lastConfigRequest.email===e.email&&this._lastConfigRequest.languageUxId===e.languageUxId&&this._lastConfigRequest.tenantId===e.tenantId)return;this._lastConfigRequest=e,this._lastConfigRequestUserId=this._editorService.xUserId;const t=this._logger.getNewActivity(T.RemoteSettingSync,h.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())}async fetchRemoteSettings(e){var t;try{return await this._editorService.browserextension(e,{requestOptions:{customHeaders:{"X-UserId":null!==(t=this._editorService.xUserId)&&void 0!==t?t:""}}})}catch(e){this._logger.logEvent(537518989,S.SettingsSyncEditorServiceError,c.q.Error,void 0,h.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async removeManualOverrides(e){const t={};try{const n=await this._extensionStorage.get(e);for(const i of Object.keys(n))JSON.parse(n[i]).manualOverride?this._logger.debug(537518990,"Manual override for remote setting",i):t[i]=e[i]}catch(e){return this._logger.logEvent(537518991,S.SettingsSyncReadOverrideError,c.q.Error,void 0,h.o.SamplingPolicy.CriticalBusinessImpact,e),void this.setLastError(e)}return t}async removePersistentKeys(){const e=Object.keys(Z({}));e.length&&await this._extensionStorage.remove(e)}};J=(0,u.__decorate)([(0,p._)(),(0,u.__param)(0,(0,f.W)(P)),(0,u.__param)(1,(0,f.W)(i.qq)),(0,u.__param)(2,(0,f.W)(V.K)),(0,u.__param)(3,(0,f.W)(g.g)),(0,u.__param)(4,(0,f.W)(v.e)),(0,u.__param)(5,(0,f.W)(G.a)),(0,u.__param)(6,(0,f.W)(Q.G)),(0,u.__param)(7,(0,f.W)(K.J))],J);class Y{constructor(){this.imports=[j,r.k]}get uniqueId(){return(0,o.z)(507918238)}configureRootServices(e){e.bind(i.qq).toDynamicValue((e=>{const t=e.get(a.n);return new i.qq({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(l.$).to(J),e.bind(s.S).toExisting(l.$)}}},58889:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});const i=(0,n(63837).f)("IRemoteSettingsSyncer")},37120:(e,t,n)=>{"use strict";function i(e){var t;if(e)return"true"===(null===(t=e.contentEditable)||void 0===t?void 0:t.toLowerCase())?e:i(e.parentElement)}n.d(t,{m:()=>i})},94077:(e,t,n)=>{"use strict";n.d(t,{B:()=>g,a:()=>s});var i=n(30206),r=n(48828),o=n(60040);const a=new Set(["Â¡","Â¦","Â§","Â©","Â«","Â¬","Â®","Â°","Â±","Â»","Â¿","Ã","Ã·","Ç","Í¾","â¯","â°","â¹","âº","â¼","â½","â","â","â ","â","â","â","â","â","â¢","â","â","â","â","â«","â","â ","â¤","â¥","â¡","âª","â«","â","â","â¦","â¢","ã","\ufeff","ï¼","ï¼","ï¼","ï¼","ï½¡"]);let s=class{constructor(){this.supportsBrowserWordBreaking=!1}getForwardBreakByWord(e,t){let n=this.getForwardBreak(e,t);return"WhiteSpace"===(null==n?void 0:n.wordBreakType)&&(n=this.getForwardBreak(e,n.cp)),n?n.cp:e.length}getBackwardBreakByWord(e,t){let n=this.getBackwardBreak(e,t);return"WhiteSpace"===(null==n?void 0:n.wordBreakType)&&(n=this.getBackwardBreak(e,n.cp)),n?n.cp:0}getForwardBreak(e,t){return this.getForwardBreakInternal(e,t,e.length)}getBackwardBreak(e,t){if(t<=1)return;let n=t;for(;n>0;){const t=u(e,n-1);switch(t){case"Undetermined":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(n<=1)return;const i=n-1,r=u(e,i-1);if(t!==r&&l(t,r)&&("Undetermined"!==r||!this.supportsBrowserWordBreaking))return{cp:i,wordBreakType:t};break}}n-=1}}getTextStartWordBreak(e){return this.getTextWordBreak(e,0)}getTextWordBreak(e,t){return{cp:t,wordBreakType:u(e,t)}}getBreaks(e){const t=this.getBreaksForRange(e,0,e.length);return e.length&&t.splice(0,0,this.getTextStartWordBreak(e)),t}getBreaksForRange(e,t,n){const i=[];if(!e)return i;let r,o=t;do{r&&(i.push(r),o=r.cp),r=this.getForwardBreakInternal(e,o,n)}while(r);return i}getWordCount(e,t){return this.getWordCountFromWordBreaks(e,t).wordCount}getWordCountInRange(e,t,n){return this.getWordCountAndBreaksInRange(e,t,n).wordCount}getWordCountAndBreaksInRange(e,t,n){const i=this.getBreaksForRange(e,t,n);return i.splice(0,0,this.getTextWordBreak(e,t)),{wordCount:this.getWordCount(i,e),wordBreaks:i}}getWordCountWithBoundariesAndBreaksInRange(e,t,n){const i=this.getBreaksForRange(e,t,n);i.splice(0,0,this.getTextWordBreak(e,t));const r=this.getWordCountFromWordBreaks(i,e);return{wordCount:r.wordCount,wordBoundaries:r.wordBoundaries,wordBreaks:i}}getWordCountFromWordBreaks(e,t){const n={browserWordBreakCount:0,wordCount:0,wordBoundaries:[]};let i;for(let r=0;r<e.length;r+=1){const o=e[r];"AlphaNumeric"===o.wordBreakType||"Undetermined"===o.wordBreakType?("Undetermined"===o.wordBreakType&&(n.browserWordBreakCount+=1),d(r,e,t)&&(n.wordCount+=1,i=o.cp)):(void 0!==i&&(n.wordBoundaries.push({start:i,end:o.cp-1}),i=void 0),"Punctuation"!==o.wordBreakType&&"PuncuationWithoutBreak"!==o.wordBreakType||!c(r,e,t)||(n.wordCount+=1))}return void 0!==i&&n.wordBoundaries.push({start:i,end:t.length-1}),n}getForwardBreakInternal(e,t,n){if(t>=n-1)return;let i=t;for(;i<n;){const t=u(e,i);switch(t){case"Undetermined":case"Ignore":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(i>=n-1)return;let r=i+1,o=u(e,r);for(;"Ignore"===o;){if(r+=1,r>=n)return;o=u(e,r)}if(t!==o&&l(t,o)&&("Undetermined"!==o||!this.supportsBrowserWordBreaking))return{cp:r,wordBreakType:o};break}}i+=1}}};function l(e,t){return"PuncuationWithoutBreak"===e&&"AlphaNumeric"!==t||"AlphaNumeric"===e&&"PuncuationWithoutBreak"!==t||"Punctuation"===e||"FootnoteEndnotePunctuation"===e||"WhiteSpace"===e}function u(e,t){const n=e.charAt(t).toString();return o.Fc(n)?"AlphaNumeric":function(e){const t=e.charCodeAt(0);return t>=0&&t<=31||32===t||t>=127&&t<=159||160===t||t>=8192&&t<=8202||8239===t||8287===t||9248===t||t>=9250&&t<=9252||12288===t||65282===t}(n)?"WhiteSpace":g(n)?"Punctuation":function(e){return"'"===e||"â"===e||"â"===e}(n)?"PuncuationWithoutBreak":function(e){return"î"===e}(n)?"FootnoteEndnotePunctuation":function(e){return"â"===e||"â"===e}(n)?"Ignore":"Undetermined"}function d(e,t,n){if(!e)return!0;const i=t[e];if(!i.cp)return!0;const r=t[e-1];let o=!0;if("Punctuation"===r.wordBreakType){let e=!1;for(let t=r.cp;t<i.cp;t+=1){const i=n.charAt(t);if("-"===i){if(e)return!0;e=!0}else e=!1;if(o=h(i),o)return!0}}else if("Undetermined"===r.wordBreakType)return!1;return("Undetermined"!==i.wordBreakType||"WhiteSpace"===r.wordBreakType)&&o}function c(e,t,n){const i=t[e];if(h(n.charAt(i.cp)))return!1;if(!e)return!0;if(!i.cp)return!1;const r=t[e-1];return"WhiteSpace"===r.wordBreakType||"FootnoteEndnotePunctuation"===r.wordBreakType}function h(e){return"â"===e||"â"===e}function g(e){return!!a.has(e)||e>="!"&&e<="$"||e>="("&&e<="/"||e>=":"&&e<="@"||e>="["&&e<="`"||e>="{"&&e<="~"||e>="â"&&e<="â"||e>="â"&&e<="â¢"||e>="â¤"&&e<="â¦"||e>="â¹ "&&e<="â»"||e>="ã "&&e<="ã"}s=(0,i.__decorate)([(0,r._)()],s)},4326:(e,t,n)=>{"use strict";n.d(t,{x:()=>o});var i=n(91578),r=n(4497);class o{static createEvaluator(e,t,n,i,r){return a=>o.isKey(a,e,t,n,i,r)}static isKey(e,t,n,r,a,s){if(void 0!==n&&e.altKey!==n||void 0!==r&&e.ctrlKey!==r||void 0!==a&&e.metaKey!==a||void 0!==s&&e.shiftKey!==s)return!1;if(Array.isArray(t))return t.some((t=>o.isKey(e,t,n,r,a,s)));if(e.key===t)return!0;if(t in i.c){const n=i.c[t];return e.which===n||e.keyCode===n}return!1}}o.isEnterKey=e=>{const t=r.m.enter;return o.isKey(e,t)},o.isEnterOrSpaceKey=e=>{const t=r.m.enter,n=r.m.space;return o.isKey(e,[t,n])},o.isEscapeKey=e=>{const t=r.m.escape;return o.isKey(e,t)},o.focusIfEscapeKey=e=>{o.isKey(e,r.m.escape)&&(e.currentTarget.focus(),e.stopPropagation())},o.isSpaceKey=e=>{const t=r.m.space;return o.isKey(e,t)}},4497:(e,t,n)=>{"use strict";var i;n.d(t,{m:()=>i}),function(e){e.arrowDown="ArrowDown",e.arrowLeft="ArrowLeft",e.arrowRight="ArrowRight",e.arrowUp="ArrowUp",e.backspace="Backspace",e.delete="Delete",e.control="Control",e.enter="Enter",e.escape="Escape",e.space=" ",e.tab="Tab",e.home="Home",e.end="End",e.j="j",e.r="r",e.t="t",e.J="J",e.R="R",e.T="T"}(i||(i={}))},99120:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});var i=n(38883);const r=(e,t)=>{i.render(t,e)}},40628:(e,t,n)=>{"use strict";var i;n.d(t,{k:()=>i}),function(e){e[e.ContextualCard=0]="ContextualCard"}(i||(i={}))},40144:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var i=n(4413);function r(){return(0,i.A)()}},71115:(e,t,n)=>{"use strict";n.d(t,{k:()=>o,p:()=>r});var i=n(63837);const r=(0,i.f)("IContainer"),o=(0,i.f)("IResolveNew")},8676:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(9028);class r{constructor(e,t,n){this.injectionIdentifier=e,this.isOptional=t,this.isArray=n}resolveFrom(e){if(!this.shouldSkipResolving(e))return this.isArray?this.resolveArray(e):this.resolveSingular(e)}resolveSingular(e){return this.isOptional?e.getOptional(this.injectionIdentifier):e.get(this.injectionIdentifier)}resolveArray(e){if(!this.isOptional&&!e.isBound(this.injectionIdentifier))throw new Error("No matching bindings found for serviceIdentifier: "+this.injectionIdentifier.toString());return e.getAll(this.injectionIdentifier)}isBoundTo(e){return!!e.isBound(this.injectionIdentifier)}setupBinding(e,t){if(this.isArray&&Array.isArray(t))for(const n of t)this.setupSingleBinding(e,n);else this.setupSingleBinding(e,t)}setupSingleBinding(e,t){const n=e.bind(this.injectionIdentifier);(0,i.C)(t)?n.to(t):n.toValue(t)}toString(){const e={};return e.identifier=this.injectionIdentifier instanceof Function?this.injectionIdentifier.name:this.injectionIdentifier.toString(),this.isOptional&&(e.isOptional=this.isOptional),this.isArray&&(e.isArray=this.isArray),`ConfiguredDep(${JSON.stringify(e)})`}shouldSkipResolving(e){return!!this.isOptional&&!this.isBoundTo(e)}}class o{constructor(e,t){this._isOptional=!1,this._injectionIdentifier=e,this._isArray=t}static on(e){return new o(e,!1)}static onAll(e){return new o(e,!0)}optional(){return this._isOptional=!0,this}build(){return new r(this._injectionIdentifier,this._isOptional,this._isArray)}}},9028:(e,t,n)=>{"use strict";n.d(t,{C:()=>r});const i=new(n(29688).P);function r(e){return e instanceof Function&&!!i.getConstructorMetadata(e).compilerGeneratedMetadata}},37842:(e,t,n)=>{"use strict";n.d(t,{F5:()=>o,KN:()=>a,SM:()=>s});var i=n(19635),r=n(95734);function o(e){const t={};for(const n of Object.keys(e)){const i=e[n];t[n]=i.build()}return t}function a(e){const t=(0,i.G)();return(0,r.useMemo)((()=>{const n={};for(const i of Object.keys(e))n[i]=e[i].resolveFrom(t);return n}),[t,e])}function s(e){const t=(0,i.N)();return(0,r.useMemo)((()=>{const n={};for(const i of Object.keys(e))n[i]=t&&e[i].resolveFrom(t);return n}),[t,e])}},53756:(e,t,n)=>{"use strict";n.d(t,{E:()=>o,r:()=>a});var i=n(42727),r=n(95734);class o extends i.z{constructor(e,t){super(e,t)}onAddModule(e){var t;"configureScopedServices"in e?null===(t=e.configureScopedServices)||void 0===t||t.call(e,this.container):"scopedProviders"in e&&e.scopedProviders&&this.bindProvidersToContainer(this.container,e.scopedProviders)}}const a=(0,r.createContext)(void 0)},42727:(e,t,n)=>{"use strict";n.d(t,{z:()=>Ae});var i="Request",r="Singleton",o="Transient",a={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},s={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},l=0;function u(){return l++}var d=function(){function e(e,t){this.id=u(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=a.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=t.scope===r&&this.activated,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.onDeactivation=this.onDeactivation,t.cache=this.cache,t},e}(),c=n(5e3),h=n(61647),g=n(29688),p={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function f(e){return e instanceof RangeError||e.message===c.U_}function m(e){return"function"==typeof e?e.name:"symbol"==typeof e?e.toString():e}function v(e,t,n){var i="",r=n(e,t);return 0!==r.length&&(i="\nRegistered bindings:",r.forEach((function(e){var t="Object";null!==e.implementationType&&(t=b(e.implementationType)),i=i+"\n "+t,e.constraint.metaData&&(i=i+" - "+e.constraint.metaData)}))),i}function y(e,t){return null!==e.parentRequest&&(e.parentRequest.serviceIdentifier===t||y(e.parentRequest,t))}function _(e){e.childRequests.forEach((function(e){if(y(e,e.serviceIdentifier)){var t=function(e){return function e(t,n){void 0===n&&(n=[]);var i=m(t.serviceIdentifier);return n.push(i),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(e);throw new Error(c.ML+" "+t)}_(e)}))}function b(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}var C=function(){function e(e){this.id=u(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}(),T=n(15348),S=function(e,t){this.parentContext=e,this.rootRequest=t},I=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}(),w=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}(),E=function(){function e(e,t,n,i){this.id=u(),this.type=e,this.serviceIdentifier=n;var r="symbol"==typeof t?t.toString().slice(7,-1):t;this.name=new w(r||""),this.identifier=t,this.metadata=new Array;var o=null;"string"==typeof i?o=new T.O(h.P7,i):i instanceof T.O&&(o=i),null!==o&&this.metadata.push(o)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++)if(n[t].key===e)return!0;return!1},e.prototype.isArray=function(){return this.hasTag(h.jf)},e.prototype.matchesArray=function(e){return this.matchesTag(h.jf)(e)},e.prototype.isNamed=function(){return this.hasTag(h.P7)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return h.eV.every((function(t){return e.key!==t}))}))},e.prototype.isOptional=function(){return this.matchesTag(h.Q2)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===h.P7}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return h.eV.every((function(t){return e.key!==t}))})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(h.P7)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,r=t.metadata;i<r.length;i++){var o=r[i];if(o.key===e&&o.value===n)return!0}return!1}},e}(),x=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function A(e,t,n,i){var r=e.getConstructorMetadata(n),o=r.compilerGeneratedMetadata;if(void 0===o){var a=c.z4+" "+t+".";throw new Error(a)}var s=r.userGeneratedMetadata,l=Object.keys(s),u=0===n.length&&l.length>0,d=l.length>n.length,h=function(e,t,n,i,r){for(var o=[],a=0;a<r;a++){var s=D(a,e,t,n,i);null!==s&&o.push(s)}return o}(i,t,o,s,u||d?l.length:n.length),g=F(e,n,t);return x(x([],h,!0),g,!0)}function D(e,t,n,i,r){var o=r[e.toString()]||[],a=k(o),l=!0!==a.unmanaged,u=i[e];if((u=a.inject||a.multiInject||u)instanceof I&&(u=u.unwrap()),l){if(!t&&(u===Object||u===Function||void 0===u)){var d=c.Ds+" argument "+e+" in class "+n+".";throw new Error(d)}var h=new E(s.ConstructorArgument,a.targetName,u);return h.metadata=o,h}return null}function N(e,t,n,i){var r=e||t;if(void 0===r){var o=c.z4+" for property "+String(n)+" in class "+i+".";throw new Error(o)}return r}function F(e,t,n){for(var i=e.getPropertiesMetadata(t),r=[],o=Object.getOwnPropertySymbols(i),a=0,l=Object.keys(i).concat(o);a<l.length;a++){var u=l[a],d=i[u],c=k(d),h=c.targetName||u,g=N(c.inject,c.multiInject,u,n),p=new E(s.ClassProperty,h,g);p.metadata=d,r.push(p)}var f=Object.getPrototypeOf(t.prototype).constructor;if(f!==Object){var m=F(e,f,n);r=x(x([],r,!0),m,!0)}return r}function P(e,t){var n=Object.getPrototypeOf(t.prototype).constructor;if(n!==Object){var i=A(e,b(n),n,!0),r=i.map((function(e){return e.metadata.filter((function(e){return e.key===h.Af}))})),o=[].concat.apply([],r).length,a=i.length-o;return a>0?a:P(e,n)}return 0}function k(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[h.n8],multiInject:t[h.jf],targetName:t[h.LX],unmanaged:t[h.Af]}}var O=function(){function e(e,t,n,i,r){this.id=u(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=r,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,i){var r=new e(t,this.parentContext,this,n,i);return this.childRequests.push(r),r},e}();function B(e){return e._bindingDictionary}function R(e,t,n,i,r){var o,a=M(n.container,r.serviceIdentifier);return a.length===p.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"==typeof r.serviceIdentifier&&e.getConstructorMetadata(r.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(r.serviceIdentifier).toSelf(),a=M(n.container,r.serviceIdentifier)),o=t?a:a.filter((function(e){var t=new O(e.serviceIdentifier,n,i,e,r);return e.constraint(t)})),function(e,t,n,i){switch(t.length){case p.NoBindingsAvailable:if(n.isOptional())return t;var r=m(e),o=c.BT;throw o+=function(e,t){if(t.isTagged()||t.isNamed()){var n="",i=t.getNamedTag(),r=t.getCustomTags();return null!==i&&(n+=i.toString()+"\n"),null!==r&&r.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e}(r,n),o+=v(i,r,M),new Error(o);case p.OnlyOneBindingAvailable:return t;case p.MultipleBindingsAvailable:default:if(n.isArray())return t;throw r=m(e),o=c.No+" "+r,o+=v(i,r,M),new Error(o)}}(r.serviceIdentifier,o,r,n.container),o}function L(e,t,n,i,r,o){var s,l;if(null===r){s=R(e,t,i,null,o),l=new O(n,i,null,s,o);var u=new S(i,l);i.addPlan(u)}else s=R(e,t,i,r,o),l=r.addChildRequest(o.serviceIdentifier,s,o);s.forEach((function(t){var n=null;if(o.isArray())n=l.addChildRequest(t.serviceIdentifier,t,o);else{if(t.cache)return;n=l}if(t.type===a.Instance&&null!==t.implementationType){var r=function(e,t){return A(e,b(t),t,!1)}(e,t.implementationType);if(!i.container.options.skipBaseClassChecks){var s=P(e,t.implementationType);if(r.length<s){var u=c.Z_(b(t.implementationType));throw new Error(u)}}r.forEach((function(t){L(e,!1,t.serviceIdentifier,i,n,t)}))}}))}function M(e,t){var n=[],i=B(e);return i.hasKey(t)?n=i.get(t):null!==e.parent&&(n=M(e.parent,t)),n}function q(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function U(e){return!!q(e)||Array.isArray(e)&&e.some(q)}var W,j=function(e,t){return n=void 0,i=void 0,o=function(){var n,i;return function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t];case 1:return n=r.sent(),e.cache=n,[3,3];case 2:throw i=r.sent(),e.cache=null,e.activated=!1,i;case 3:return[2]}}))},new((r=void 0)||(r=Promise))((function(e,t){function a(e){try{l(o.next(e))}catch(e){t(e)}}function s(e){try{l(o.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,s)}l((o=o.apply(n,i||[])).next())}));var n,i,r,o};!function(e){e.DynamicValue="toDynamicValue",e.Factory="toFactory",e.Provider="toProvider"}(W||(W={}));var z=function(){return z=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},z.apply(this,arguments)},H=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},V=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},G=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))};function Q(e){var t,n=new((t=e.constr).bind.apply(t,G([void 0],e.constructorInjections,!1)));return e.propertyRequests.forEach((function(t,i){var r=t.target.identifier,o=e.propertyInjections[i];t.target.isOptional()&&void 0===o||(n[r]=o)})),n}function K(e){return H(this,void 0,void 0,(function(){var t,n,i,r;return V(this,(function(o){for(t=[],n=0,i=e;n<i.length;n++)r=i[n],Array.isArray(r)?t.push(Promise.all(r)):t.push(r);return[2,Promise.all(t)]}))}))}function $(e,t){var n=function(e,t){var n,i;if(Reflect.hasMetadata(h.Z_,e)){var r=Reflect.getMetadata(h.Z_,e);try{return null===(i=(n=t)[r.value])||void 0===i?void 0:i.call(n)}catch(t){if(t instanceof Error)throw new Error((0,c.CE)(e.name,t.message))}}}(e,t);return q(n)?n.then((function(){return t})):t}var Z=function(e){return function(t){t.parentContext.setCurrentRequest(t);var n=t.bindings,i=t.childRequests,r=t.target&&t.target.isArray(),o=!(t.parentRequest&&t.parentRequest.target&&t.target&&t.parentRequest.target.matchesArray(t.target.serviceIdentifier));if(r&&o)return i.map((function(t){return Z(e)(t)}));if(!t.target.isOptional()||0!==n.length){var a=n[0];return ee(e,t,a)}}},J=function(e,t){var n=function(e){switch(e.type){case a.Factory:return{factory:e.factory,factoryType:W.Factory};case a.Provider:return{factory:e.provider,factoryType:W.Provider};case a.DynamicValue:return{factory:e.dynamicValue,factoryType:W.DynamicValue};default:throw new Error("Unexpected factory type "+e.type)}}(e);return function(i,r){try{return n.factory.bind(e)(t)}catch(e){throw f(e)&&(e=new Error(c.NF(n.factoryType,t.currentRequest.serviceIdentifier.toString()))),e}}()},Y=function(e,t,n){var o,l=t.childRequests;switch(function(e){var t=null;switch(e.type){case a.ConstantValue:case a.Function:t=e.cache;break;case a.Constructor:case a.Instance:t=e.implementationType;break;case a.DynamicValue:t=e.dynamicValue;break;case a.Provider:t=e.provider;break;case a.Factory:t=e.factory}if(null===t){var n=m(e.serviceIdentifier);throw new Error(c.F5+" "+n)}}(n),n.type){case a.ConstantValue:case a.Function:o=n.cache;break;case a.Constructor:o=n.implementationType;break;case a.Instance:o=function(e,t,n,o){!function(e,t){e.scope!==r&&function(e,t){var n="Class cannot be instantiated in "+(e.scope===i?"request":"transient")+" scope.";if("function"==typeof e.onDeactivation)throw new Error((0,c.bQ)(t.name,n));if(Reflect.hasMetadata(h.Vh,t))throw new Error((0,c.Wj)(t.name,n))}(e,t)}(e,t);var a=function(e,t,n){var i;if(t.length>0){var r=function(e,t){return e.reduce((function(e,n){var i=t(n);return n.target.type===s.ConstructorArgument?e.constructorInjections.push(i):(e.propertyRequests.push(n),e.propertyInjections.push(i)),e.isAsync||(e.isAsync=U(i)),e}),{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}(t,n),o=z(z({},r),{constr:e});i=r.isAsync?function(e){return H(this,void 0,void 0,(function(){var t,n;return V(this,(function(i){switch(i.label){case 0:return[4,K(e.constructorInjections)];case 1:return t=i.sent(),[4,K(e.propertyInjections)];case 2:return n=i.sent(),[2,Q(z(z({},e),{constructorInjections:t,propertyInjections:n}))]}}))}))}(o):Q(o)}else i=new e;return i}(t,n,o);return q(a)?a.then((function(e){return $(t,e)})):$(t,a)}(n,n.implementationType,l,Z(e));break;default:o=J(n,t.parentContext)}return o},X=function(e,t,n){var o=function(e,t){return t.scope===r&&t.activated?t.cache:t.scope===i&&e.has(t.id)?e.get(t.id):null}(e,t);return null!==o||function(e,t,n){t.scope===r&&function(e,t){e.cache=t,e.activated=!0,q(t)&&j(e,t)}(t,n),t.scope===i&&function(e,t,n){e.has(t.id)||e.set(t.id,n)}(e,t,n)}(e,t,o=n()),o},ee=function(e,t,n){return X(e,n,(function(){var i=Y(e,t,n);return q(i)?i.then((function(e){return te(t,n,e)})):te(t,n,i)}))};function te(e,t,n){var i,r=ne(e.parentContext,t,n),o=ae(e.parentContext.container),a=o.next();do{i=a.value;var s=e.parentContext,l=e.serviceIdentifier,u=oe(i,l);r=q(r)?re(u,s,r):ie(u,s,r),a=o.next()}while(!0!==a.done&&!B(i).hasKey(e.serviceIdentifier));return r}var ne=function(e,t,n){return"function"==typeof t.onActivation?t.onActivation(e,n):n},ie=function(e,t,n){for(var i=e.next();!i.done;){if(q(n=i.value(t,n)))return re(e,t,n);i=e.next()}return n},re=function(e,t,n){return i=void 0,r=void 0,a=function(){var i,r;return function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(o){switch(o.label){case 0:return[4,n];case 1:i=o.sent(),r=e.next(),o.label=2;case 2:return r.done?[3,4]:[4,r.value(t,i)];case 3:return i=o.sent(),r=e.next(),[3,2];case 4:return[2,i]}}))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{l(a.next(e))}catch(e){t(e)}}function s(e){try{l(a.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o((function(e){e(i)}))).then(n,s)}l((a=a.apply(i,r||[])).next())}));var i,r,o,a},oe=function(e,t){var n=e._activations;return n.hasKey(t)?n.get(t).values():[].values()},ae=function(e){for(var t=[e],n=e.parent;null!==n;)t.push(n),n=n.parent;return{next:function(){var e=t.pop();return void 0!==e?{done:!1,value:e}:{done:!0,value:void 0}}}},se=function(e,t){var n=e.parentRequest;return null!==n&&(!!t(n)||se(n,t))},le=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new T.O(e,t),n}},ue=le(h.P7),de=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"==typeof e)return n.serviceIdentifier===e;var i=t.bindings[0].implementationType;return e===i}return!1}},ce=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new he(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=ue(e),new he(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e&&null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new he(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=le(e)(t),new he(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return null!==t&&de(e)(t.parentRequest)},new he(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return null!==t&&ue(e)(t.parentRequest)},new he(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&le(e)(t)(n.parentRequest)},new he(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&se(t,de(e))},new he(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return null!==t&&!se(t,de(e))},new he(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&se(t,ue(e))},new he(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return null!==t&&!se(t,ue(e))},new he(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&se(n,le(e)(t))},new he(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return null!==n&&!se(n,le(e)(t))},new he(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&se(t,e)},new he(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return null!==t&&!se(t,e)},new he(this._binding)},e}(),he=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new ce(this._binding)},e.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new ce(this._binding)},e}(),ge=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ce(this._binding),this._bindingOnSyntax=new he(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),pe=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=i,new ge(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=r,new ge(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=o,new ge(this._binding)},e}(),fe=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new ce(this._binding),this._bindingOnSyntax=new he(this._binding),this._bindingInSyntax=new pe(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},e}(),me=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=a.Instance,this._binding.implementationType=e,new fe(this._binding)},e.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+c.jf);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=a.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=r,new ge(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=a.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new fe(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=a.Constructor,this._binding.implementationType=e,this._binding.scope=r,new ge(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=a.Factory,this._binding.factory=e,this._binding.scope=r,new ge(this._binding)},e.prototype.toFunction=function(e){if("function"!=typeof e)throw new Error(c.rg);var t=this.toConstantValue(e);return this._binding.type=a.Function,this._binding.scope=r,t},e.prototype.toAutoFactory=function(e){return this._binding.type=a.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},this._binding.scope=r,new ge(this._binding)},e.prototype.toAutoNamedFactory=function(e){return this._binding.type=a.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new ge(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=a.Provider,this._binding.provider=e,this._binding.scope=r,new ge(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}(),ve=function(){function e(){}return e.of=function(t,n,i,r,o){var a=new e;return a.bindings=t,a.middleware=n,a.deactivations=r,a.activations=i,a.moduleActivationStore=o,a},e}(),ye=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null==e)throw new Error(c.EC);if(null==t)throw new Error(c.EC);var n=this._map.get(e);void 0!==n?n.push(t):this._map.set(e,[t])},e.prototype.get=function(e){if(null==e)throw new Error(c.EC);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(c.Jk)},e.prototype.remove=function(e){if(null==e)throw new Error(c.EC);if(!this._map.delete(e))throw new Error(c.Jk)},e.prototype.removeIntersection=function(e){var t=this;this.traverse((function(n,i){var r=e.hasKey(n)?e.get(n):void 0;if(void 0!==r){var o=i.filter((function(e){return!r.some((function(t){return e===t}))}));t._setValue(n,o)}}))},e.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach((function(i,r){for(var o=[],a=0,s=i;a<s.length;a++){var l=s[a];e(l)?n.push(l):o.push(l)}t._setValue(r,o)})),n},e.prototype.hasKey=function(e){if(null==e)throw new Error(c.EC);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,"object"==typeof(i=e)&&null!==i&&"clone"in i&&"function"==typeof i.clone?e.clone():e);var i}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},e}(),_e=function(){function e(){this._map=new Map}return e.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},e.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},e.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){t._map.set(n,{onActivations:e.onActivations.clone(),onDeactivations:e.onDeactivations.clone()})})),t},e.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return void 0===t&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},e.prototype._getEmptyHandlersStore=function(){return{onActivations:new ye,onDeactivations:new ye}},e}(),be=function(){return be=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},be.apply(this,arguments)},Ce=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))},Te=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Se=function(){function e(e){var t=e||{};if("object"!=typeof t)throw new Error(""+c.li);if(void 0===t.defaultScope)t.defaultScope=o;else if(t.defaultScope!==r&&t.defaultScope!==o&&t.defaultScope!==i)throw new Error(""+c.KU);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!=typeof t.autoBindInjectable)throw new Error(""+c.jC);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!=typeof t.skipBaseClassChecks)throw new Error(""+c.SW);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=u(),this._bindingDictionary=new ye,this._snapshots=[],this._middleware=null,this._activations=new ye,this._deactivations=new ye,this.parent=null,this._metadataReader=new g.P,this._moduleActivationStore=new _e}return e.merge=function(t,n){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=new e,a=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}([t,n],i,!0).map((function(e){return B(e)})),s=B(o);return a.forEach((function(e){var t;t=s,e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))})),o},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,r=e;i<r.length;i++){var o=r[i],a=n(o.id);o.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ce(this,void 0,void 0,(function(){var t,n,i,r,o;return Te(this,(function(a){switch(a.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,i=e,a.label=1;case 1:return n<i.length?(r=i[n],o=t(r.id),[4,r.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction,o.unbindAsyncFunction,o.onActivationFunction,o.onDeactivationFunction)]):[3,4];case 2:a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach((function(t){var n=e._removeModuleBindings(t.id);e._deactivateSingletons(n),e._removeModuleHandlers(t.id)}))},e.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ce(this,void 0,void 0,(function(){var t,n,i,r;return Te(this,(function(o){switch(o.label){case 0:t=0,n=e,o.label=1;case 1:return t<n.length?(i=n[t],r=this._removeModuleBindings(i.id),[4,this._deactivateSingletonsAsync(r)]):[3,4];case 2:o.sent(),this._removeModuleHandlers(i.id),o.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))},e.prototype.bind=function(e){var t=this.options.defaultScope||o,n=new d(e,t);return this._bindingDictionary.add(e,n),new me(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.rebindAsync=function(e){return Ce(this,void 0,void 0,(function(){return Te(this,(function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}}))}))},e.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},e.prototype.unbindAsync=function(e){return Ce(this,void 0,void 0,(function(){var t;return Te(this,(function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}}))}))},e.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse((function(t,n){e._deactivateSingletons(n)})),this._bindingDictionary=new ye},e.prototype.unbindAllAsync=function(){return Ce(this,void 0,void 0,(function(){var e,t=this;return Te(this,(function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse((function(n,i){e.push(t._deactivateSingletonsAsync(i))})),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new ye,[2]}}))}))},e.prototype.onActivation=function(e,t){this._activations.add(e,t)},e.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,h.P7,t)},e.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var r=this._bindingDictionary.get(e),o=function(e,t,n,i){var r=new E(s.Variable,"",t,new T.O(n,i)),o=new C(e);return new O(t,o,null,[],r)}(this,e,t,n);i=r.some((function(e){return e.constraint(o)}))}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},e.prototype.snapshot=function(){this._snapshots.push(ve.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(c.U9);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},e.prototype.getAsync=function(e){return Ce(this,void 0,void 0,(function(){var t;return Te(this,(function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]}))}))},e.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},e.prototype.getTaggedAsync=function(e,t,n){return Ce(this,void 0,void 0,(function(){var i;return Te(this,(function(r){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]}))}))},e.prototype.getNamed=function(e,t){return this.getTagged(e,h.P7,t)},e.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,h.P7,t)},e.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},e.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},e.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},e.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,h.P7,t)},e.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,h.P7,t)},e.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},e.prototype._preDestroy=function(e,t){var n,i;if(Reflect.hasMetadata(h.Vh,e))return null===(i=(n=t)[Reflect.getMetadata(h.Vh,e).value])||void 0===i?void 0:i.call(n)},e.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},e.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition((function(t){return t.moduleId===e}))},e.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var r=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(q(r))return this._handleDeactivationError(r.then((function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)})),i)}var o=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if(q(o))return this._handleDeactivationError(o,i)}catch(e){if(e instanceof Error)throw new Error(c.bQ(i.name,e.message))}},e.prototype._handleDeactivationError=function(e,t){return Ce(this,void 0,void 0,(function(){var n;return Te(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:if((n=i.sent())instanceof Error)throw new Error(c.bQ(t.name,n.message));return[3,3];case 3:return[2]}}))}))},e.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var r=i.value(e);if(q(r))return r.then((function(){return n._deactivateContainerAsync(e,t)}));i=t.next()}},e.prototype._deactivateContainerAsync=function(e,t){return Ce(this,void 0,void 0,(function(){var n;return Te(this,(function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}}))}))},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(i){var r=e.rebind(i);return t(r,n),r}},i=function(t){return function(n,i){e._moduleActivationStore.addActivation(t,n,i),e.onActivation(n,i)}},r=function(t){return function(n,i){e._moduleActivationStore.addDeactivation(t,n,i),e.onDeactivation(n,i)}};return function(o){return{bindFunction:(a=o,function(n){var i=e.bind(n);return t(i,a),i}),isboundFunction:function(t){return e.isBound(t)},onActivationFunction:i(o),onDeactivationFunction:r(o),rebindFunction:n(o),unbindFunction:function(t){return e.unbind(t)},unbindAsyncFunction:function(t){return e.unbindAsync(t)}};var a}},e.prototype._getAll=function(e){return Promise.all(this._get(e))},e.prototype._get=function(e){var t=be(be({},e),{contextInterceptor:function(e){return e},targetType:s.Variable});if(this._middleware){var n=this._middleware(t);if(null==n)throw new Error(c.Y1);return n}return this._planAndResolve()(t)},e.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(U(t))throw new Error(c.Ft(e.serviceIdentifier));return t},e.prototype._getAllArgs=function(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}},e.prototype._getNotAllArgs=function(e,t,n,i){return{avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i}},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=function(e,t,n,i,r,o,a,s){void 0===s&&(s=!1);var l=new C(t),u=function(e,t,n,i,r,o){var a=e?h.jf:h.n8,s=new T.O(a,n),l=new E(t,"",n,s);if(void 0!==r){var u=new T.O(r,o);l.metadata.push(u)}return l}(n,i,r,0,o,a);try{return L(e,s,r,l,null,u),l}catch(e){throw f(e)&&_(l.plan.rootRequest),e}}(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return function(e){return Z(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}(n=t.contextInterceptor(n))}},e.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return q(e.cache)?e.cache.then((function(n){return t._deactivate(e,n)})):this._deactivate(e,e.cache)},e.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];if(q(this._deactivateIfSingleton(i)))throw new Error(c.Y3)}},e.prototype._deactivateSingletonsAsync=function(e){return Ce(this,void 0,void 0,(function(){var t=this;return Te(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return t._deactivateIfSingleton(e)})))];case 1:return n.sent(),[2]}}))}))},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},e.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return Ce(this,void 0,void 0,(function(){return Te(this,(function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))},e.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(c.fG+" "+m(e))}},e.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if("function"==typeof e.onDeactivation){var r=e.onDeactivation(t);if(q(r))return r.then((function(){return i._preDestroy(n,t)}))}return this._preDestroy(n,t)},e.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return Ce(this,void 0,void 0,(function(){return Te(this,(function(i){switch(i.label){case 0:return"function"!=typeof e.onDeactivation?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}}))}))},e}();const Ie={defaultScope:"Singleton",skipBaseClassChecks:!0};class we{constructor(e){this.container=e}bind(e){return new Ee(this,this.container.bind(e))}rebind(e){return new Ee(this,this.container.rebind(e))}unbind(e){try{return this.container.unbind(e),!0}catch(e){return!1}}get(e){return this.container.get(e)}getOptional(e){return this.container.isBound(e)?this.container.get(e):void 0}getAll(e){return this.container.isBound(e)?this.container.getAll(e):[]}isBound(e){return this.container.isBound(e)}createChildContainer(){return new we(this.container.createChild(Ie))}unbindAll(){this.container.unbindAll()}resolveNew(e){return this.container.resolve(e)}getBindings(){const e=(t=this.container,t._bindingDictionary).getMap();var t;const n=[];for(const[t,i]of e)n.push({token:t,boundServices:i});return n}}class Ee{constructor(e,t){this.container=e,this.bindingTo=t}to(e){this.bindingTo.to(e)}toSelf(){this.bindingTo.toSelf()}toValue(e){this.bindingTo.toConstantValue(e)}toDynamicValue(e){this.bindingTo.toDynamicValue((()=>e(this.container)))}toFactory(e){this.bindingTo.toFactory((()=>e(this.container)))}toExisting(e){this.bindingTo.toService(e)}toTransient(e){this.bindingTo.to(e).inTransientScope()}}var xe=n(9028);class Ae{constructor(e,t){this.addedModuleKeys=new Set,this._addedModuleClassNames=new Set,this._modulesSharingSameModuleKeyButDifferentClassname=new Set,this.container=e,this.generateModuleKey=t}static createContainer(e){return e?e.createChildContainer():function(){const e=new Se(Ie);return new we(e)}()}clear(){this.container.unbindAll(),this.addedModuleKeys.clear(),this._addedModuleClassNames.clear(),this._modulesSharingSameModuleKeyButDifferentClassname.clear()}get addedModuleClassNames(){return this._addedModuleClassNames}get modulesSharingSameModuleKeyButDifferentClassname(){return this._modulesSharingSameModuleKeyButDifferentClassname}addModule(e){var t;const n="function"!=typeof e?e.constructor.name:e.name,i=this.getModuleKey(e);if(this.addedModuleKeys.has(i))return void(this._addedModuleClassNames.has(n)||this._modulesSharingSameModuleKeyButDifferentClassname.add(n));this._addedModuleClassNames.add(n),this.addedModuleKeys.add(i);const r=this.getModuleInstance(e);this.addModules(null!==(t=r.imports)&&void 0!==t?t:[]),this.onAddModule(r)}addModules(e){for(const t of e)t&&(Array.isArray(t)?this.addModules(t):this.addModule(t))}bindProvidersToContainer(e,t){for(const n of t)if(n)if((0,xe.C)(n))e.isBound(n)||e.bind(n).toSelf();else{const t=n.provide;if(!n.multiple&&e.isBound(t))throw new Error(`Duplicate provider type: ${String(t)}`);if("useClass"in n)e.bind(t).to(n.useClass);else if("useDynamicValue"in n)e.bind(t).toDynamicValue(n.useDynamicValue);else if("useExisting"in n)e.bind(t).toExisting(n.useExisting);else{if(!("useValue"in n))throw new Error("Unknown provider type");e.bind(t).toValue(n.useValue)}}}getModuleKey(e){var t,n;const i=this.getModuleInstance(e);return i.uniqueId?i.uniqueId:e instanceof Function&&null!==(n=null===(t=this.generateModuleKey)||void 0===t?void 0:t.call(this,e))&&void 0!==n?n:e}getModuleInstance(e){return e instanceof Function?new e:e}}},13111:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,S:()=>a});var i=n(42727),r=n(95734);class o extends i.z{constructor(e){super(i.z.createContainer(),e)}onAddModule(e){"configureRootServices"in e?e.configureRootServices(this.container):e.providers&&this.bindProvidersToContainer(this.container,e.providers)}}const a=(0,r.createContext)(void 0)},19635:(e,t,n)=>{"use strict";n.d(t,{G:()=>a,N:()=>s});var i=n(53756),r=n(13111),o=n(95734);function a(){const e=s();if(!e)throw new Error("No Injector context available");return e}function s(){const e=(0,o.useContext)(i.r),t=(0,o.useContext)(r.S),n=null!=e?e:t;return null==n?void 0:n.container}},63837:(e,t,n)=>{"use strict";function i(e){return Symbol.for(e)}n.d(t,{f:()=>i})},92037:(e,t,n)=>{"use strict";let i,r;async function o(){try{const e=await Promise.resolve().then(n.bind(n,46546));i=e.makeObservable,r=e.makeAutoObservable}catch(e){}}function a(e,t,n){return i?i(e,t,n):e}n.d(t,{Gn:()=>a,iJ:()=>o})},83240:(e,t,n)=>{"use strict";n.d(t,{C:()=>r});var i=n(63837);(0,i.f)("ICategoryLocalization");const r=(0,i.f)("ICategoryLocalizationSlim")},99938:(e,t,n)=>{"use strict";n.d(t,{B:()=>E});var i=n(66279),r=n(41887),o=n(30206),a=n(26017),s=n(20399),l=n(13494),u=n(99828),d=n(44680),c=n(86278),h=n(86310),g=n(85079),p=n(51579),f=n(713),m=n(48828),v=n(30122),y=n(90424);let _=class{constructor(e,t,n,i,r,o){this._hostEmitters=e,this._hostSettings=t,this._logger=n,this._oaLogger=i,this._predictionStore=r,this._compositionEventHandler=o,this.onPredictionEvent=e=>{if(this.isDisabledOrComposing())return;if(!e.message.data.tileId)return void this._logger.log(510248457,s.q.Error,"IPrediction message: Received undefined args.");const t=e.message.data,n={eventType:e.message.messageType,tileId:t.tileId,tileVersion:t.tileVersion,prediction:t};this.onEvent(n)}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(l.pD.predictionTriggered,this.onPredictionEvent)}shutDown(){}isDisabledOrComposing(){return!this._hostSettings.isTextPredictionEnabled||this._compositionEventHandler.isComposing}async onEvent(e){this.isDisabledOrComposing()||(e.eventType===u.G.NewData?(this._oaLogger.logActivity(f.$,{predictionText:e.prediction.entityType!==a.c.Text?e.prediction.entityType.toString():e.prediction.text,entityType:e.prediction.entityType,replacingExistingPrediction:void 0!==this._predictionStore.getCurrentPrediction()}),e.prediction.isFromAugLoop=!0,await this._predictionStore.updatePrediction(e.prediction)):await this._predictionStore.clearPrediction())}};_=(0,o.__decorate)([(0,m._)(),(0,o.__param)(0,(0,v.t)(l.zJ)),(0,o.__param)(1,(0,y.W)(d.n)),(0,o.__param)(2,(0,y.W)(c.g)),(0,o.__param)(3,(0,y.W)(h.m)),(0,o.__param)(4,(0,y.W)(p.o)),(0,o.__param)(5,(0,y.W)(g.q))],_);var b=n(97428),C=n(29714),T=n(23094),S=n(74847),I=n(30225);let w=class{constructor(e){this.targetWindowFactory=e,this.isComposing=!1,this._isInitalized=!1}async initialize(){var e,t;this._isInitalized||(this._windowEventListener=new T.J(null!==(t=null===(e=this.targetWindowFactory)||void 0===e?void 0:e.call(this))&&void 0!==t?t:window),this._windowEventListener.addListener("compositionstart",this.onCompositionStart),this._windowEventListener.addListener("compositionend",this.onCompositionEnd),this._isInitalized=!0)}shutDown(){var e;null===(e=this._windowEventListener)||void 0===e||e.removeAllListeners(),this._windowEventListener=void 0,this._isInitalized=!1}onCompositionStart(){this.isComposing=!0}onCompositionEnd(){this.isComposing=!1}};w=(0,o.__decorate)([(0,m._)(),(0,o.__param)(0,(0,y.W)(S.cg)),(0,o.__param)(0,(0,I.l)())],w);class E{constructor(){this.imports=[r.d,i.w]}get uniqueId(){return(0,b.z)(507918222)}configureRootServices(e){e.bind(_).toSelf(),e.bind(C.S).toExisting(_),e.bind(p.o).to(p.X),e.bind(g.q).to(w),e.bind(C.S).toExisting(g.q)}}},50630:(e,t,n)=>{"use strict";n.d(t,{R8:()=>s,Tc:()=>i,Vn:()=>o,XG:()=>a,r7:()=>r});const i=(0,n(63837).f)("IPredictionStateStore"),r=0,o=-1,a=-2;var s;!function(e){e[e.NotSeen=0]="NotSeen",e[e.TypeNotMatchingCharacter=1]="TypeNotMatchingCharacter",e[e.ExplicitRejection=2]="ExplicitRejection",e[e.ImplicitRejection=3]="ImplicitRejection"}(s||(s={}))},34242:(e,t,n)=>{"use strict";n.d(t,{p:()=>m});var i=n(30206),r=n(26017),o=n(99828),a=n(53920),s=n(17288),l=n(13494),u=n(60040),d=n(50630),c=n(3327),h=n(37120),g=n(11663),p=n(48828),f=n(31409);let m=class{constructor(e,t,n,i,l,u,h,p,f,m,v,y,_){this._localizer=e,this._hostSettings=t,this._logger=n,this._oaLogger=i,this._predictionStore=l,this._proofingDom=u,this._paragraphTextExtractor=h,this._tileContent=p,this._hostEmitter=f,this._userProfilePictureCache=m,this._inlineSuggestionsRenderer=v,this._nudgeStore=y,this._proofingEmitter=_,this._isActivelyAddingWrappingNewLines=!1,this._predictionUpdate=0,this._multiPredictionMenuOpen=!1,this.supportsPredictionType=e=>e===r.c.Text||e===r.c.PIM||e===r.c.Topic||this.isEntityPrediction(e),this.isEntityPrediction=e=>e===r.c.File||e===r.c.People||e===r.c.Loop||e===r.c.PIM,this.eccStateChanged=e=>{var t;e.messageType===o.G.RemoveData&&(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableZeroQueryHintText)&&this._predictionStore.clearPrediction()},this.getPredictionFirstItem=e=>e.entityResults&&e.entityResults.entities[0],this.onPredictionUpdatedInternal=async()=>{var e,t,n,i,r,o,a,s;const l=this._predictionStore.getCurrentPrediction();if(l){if(this.isPredictionDisabledForEntityType(null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions,l.entityType))return void await this._predictionStore.clearPrediction();if((null===(n=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===n?void 0:n.shouldRenderPrediction)&&!this._hostSettings.serviceSettings.predictions.shouldRenderPrediction(l))return void await this._predictionStore.clearPrediction();if(void 0!==(null===(i=this._inlineSuggestionsRenderer)||void 0===i?void 0:i.getCurrentMenuInfo())&&!l.isHelperText)return void(this._multiPredictionMenuOpen||(this._prediction?await this.clearCurrentPrediction(l,"ECC open",d.R8.ImplicitRejection):await this._predictionStore.clearPrediction()));if(this.isEntityPrediction(l.entityType)){if(!(null===(o=null===(r=this._hostSettings.serviceSettings)||void 0===r?void 0:r.predictions)||void 0===o?void 0:o.onInsertEntityPrediction)||!this._inlineSuggestionsRenderer)return void await this._predictionStore.clearPrediction();if(!await this.prepareEntityPredictions(l))return void await this._predictionStore.clearPrediction()}if((null===(a=this._prediction)||void 0===a?void 0:a.context)&&l.context&&l.context+l.text===this._prediction.context+this._prediction.text&&l.context.startsWith(this._prediction.context))return;(null===(s=this._nudgeStore)||void 0===s?void 0:s.getCurrentNudge())&&await this._nudgeStore.clearNudge()}await this.onPredictionUpdated()},this.prepareEntityPredictions=async e=>{var t,n,i;if(e.entityType===r.c.People){if(e.entityResults){if((null===(t=e.context)||void 0===t?void 0:t.endsWith(e.text))||(null===(n=e.context)||void 0===n?void 0:n.endsWith(e.text+" ")))return!1;for(const t of e.entityResults.entities)t.imageUrl=await(null===(i=this._userProfilePictureCache)||void 0===i?void 0:i.fetchProfilePicture((0,g.u)(t)))}}else e.shouldDismissOnTextChange=!0;return!0},this.checkIfEntityPredictionContextIsValid=(e,t,n)=>(e.entityType===r.c.People&&e.entityResults&&(t.endsWith(" ")||this.prepareEntityPredictionForTextUpdate(e,t)),!0),this.prepareEntityPredictionForTextUpdate=(e,t)=>{var n;if(e.entityType===r.c.People){if(null===(n=e.entityResults)||void 0===n?void 0:n.entities){const n=t.substring(e.startIndex);for(const t of e.entityResults.entities)if(t.text.startsWith(n)){e.text=t.text;break}}e.entityResults=void 0}},this.onEntityDropdownOpened=(e,t)=>{var n;if(!this._prediction)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no prediction was available");let i=[];const o=this._prediction.entityType;if(o===r.c.File)i=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:r.c.File,text:e.FileName,isBestMatch:!1}))),entityType:this._prediction.entityType}];else if(o===r.c.People){const e=this._prediction;if(!e.entityResults)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no people prediction items were available");i=[{entities:e.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:r.c.People,text:e.DisplayName,isBestMatch:!1}))),entityType:this._prediction.entityType}]}else o===r.c.Loop?i=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:r.c.Loop,text:e.text,isBestMatch:!1}))),entityType:this._prediction.entityType}]:o===r.c.PIM&&(i=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:r.c.PIM,isBestMatch:!1}))),entityType:this._prediction.entityType}]);this._multiPredictionMenuOpen=!0,null===(n=this._inlineSuggestionsRenderer)||void 0===n||n.showEntityPrediction(this._prediction.tileId,this._prediction.startIndex,i,this.onApplyEntityPrediction,(()=>{this._multiPredictionMenuOpen=!1}),t.getBoundingClientRect())},this.onApplyEntityPrediction=e=>{this.applyCurrentPrediction(d.Vn,e)},this.handleTextTile=e=>{if(this._prediction&&e.message.messageType===o.G.RemoveData){const t=e.message.data.tileId;this._prediction.tileId!==t&&this._proofingDom.findParagraphNode(this._prediction.tileId)||this.clearCurrentPrediction(this._prediction,"tile removed",d.R8.ImplicitRejection)}},this.hostModelVisualStateChange=e=>{var t,n;const i=null!==(t=this._prediction)&&void 0!==t?t:this._predictionStore.getCurrentPrediction();if(i&&e.message.created){const t=this._proofingDom.findParagraphNode(i.tileId);if(t&&(i.tileId===e.message.tileId||(null===(n=t.parent)||void 0===n?void 0:n.id)===e.message.tileId)){const e=this._predictionUpdate+1;this._predictionUpdate=e,this.determineIfPredictionIsValidAndApply(i,e)}}},this.handleDelta=e=>{var t,n;const i=e.message;if(i.sourceType===a.pf.TileNode)return;if(this.checkForECCHintTextPrediction())return;if(this._isActivelyAddingWrappingNewLines)return;if(!i.delta||!this._prediction)return void(this.lastPredictedTile&&i.tileId!==this.lastPredictedTile.id&&(this.lastPredictedTile=void 0));if(i.delta.deltaType===c.WI.Add&&!i.delta.content)return;if(i.delta.deltaType===c.WI.Update&&!i.delta.content&&!i.delta.length)return;if(i.delta.deltaType===c.WI.Update&&(i.delta.unit===c.OD.Sentence||i.delta.unit===c.OD.Paragraph)&&"\n"===i.delta.content&&0===i.delta.position)return;if((i.delta.unit===c.OD.Sentence||i.delta.unit===c.OD.Paragraph)&&(i.delta.deltaType===c.WI.Add||i.delta.deltaType===c.WI.Update)&&(null!==(n=null===(t=i.delta.content)||void 0===t?void 0:t.length)&&void 0!==n?n:0)>1)return;const r=this._predictionUpdate+1;this._predictionUpdate=r,this.determineIfPredictionIsValidAndApply(this._prediction,r,this._predictionDisplayText,i.tileId,i.changeType,i.delta,i.deletedOrReplacedCharacters)},this.trimLineEnding=e=>e&&"\n"===e[e.length-1]?e.substring(0,e.length-1):e,this.logDisplayedTelemetry=e=>{var t,n;e.isFromAugLoop&&((null===(n=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===n?void 0:n.onPredictionDisplayed)&&this._hostSettings.serviceSettings.predictions.onPredictionDisplayed(e),this._oaLogger.logActivity("OAPredictionDisplayed",void 0,this.getBasePredictionLogFields(e)))},this.logAcceptedTelemetry=(e,t,n,i,r)=>{var o,a;e.isFromAugLoop&&((null===(a=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===a?void 0:a.onPredictionAccepted)&&this._hostSettings.serviceSettings.predictions.onPredictionAccepted(e,t,n),this._oaLogger.logActivity("OAPredictionApplied",void 0,[...this.getBasePredictionLogFields(e),...(0,s.W)(["charactersTyped",t],["acceptedViaUserAction",n],["keyPressedForAccept",i],["acceptanceTime",(new Date).toISOString()],["isOpeningECCForEntityPrediction",r])]))},this.logDismissedTelemetry=(e,t,n)=>{var i,r;e.isFromAugLoop&&((null===(r=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===r?void 0:r.onPredictionDismissed)&&this._hostSettings.serviceSettings.predictions.onPredictionDismissed(e,e.currentEndIndex?e.currentEndIndex-e.startIndex:0,t),void 0!==this._prediction&&this._oaLogger.logActivity("OAPredictionDismissed",void 0,[...this.getBasePredictionLogFields(e),...(0,s.W)(["charactersTyped",e.currentEndIndex?e.currentEndIndex-e.startIndex:0],["dismissalReason",t],["dismissalType",n],["rejectionTime",(new Date).toISOString()])]))},this._predictionStore.setOnUpdatedPrediction(this.onPredictionUpdatedInternal)}get prediction(){return this._prediction}get predictionDisplayText(){return this._predictionDisplayText}get predictionDisplayLocation(){return this._predictionDisplayLocation}get predictionParentElement(){return this._predictionParentElement}get predictionContentEditableParentElement(){return this._predictionContentEditableParentElement}get multiPredictionMenuOpen(){return this._multiPredictionMenuOpen}get predictionFirstDisplayedTime(){return this._predictionFirstDisplayedTime}get localizer(){return this._localizer}async initialize(){this._hostEmitter.on(l.pD.hostModelDelta,this.handleDelta),this._hostEmitter.on(l.pD.hostModelTextTile,this.handleTextTile),this._hostEmitter.on(l.pD.hostModelVisualStateChange,this.hostModelVisualStateChange),this._proofingEmitter.on("eccStateChanged",this.eccStateChanged)}shutDown(){this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0}setOnUpdate(e){this._onUpdate=e}async clearCurrentPrediction(e,t,n){this.logDismissedTelemetry(e,t,n),await this._predictionStore.clearPrediction()}isPredictionDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}checkForECCHintTextPrediction(){return!1}async handleRemotePredictionUpdate(e,t,n,i){var r,o,a,s,l;if(e.tileId!==n)return;const u=null!==(r=i.position)&&void 0!==r?r:0,h=e.startIndex+t.length;if(u>=e.startIndex&&u<h)await this.clearCurrentPrediction(e,"remote edit dismissed",d.R8.ImplicitRejection);else{const t=i.deltaType===c.WI.Add?null!==(a=null===(o=i.content)||void 0===o?void 0:o.length)&&void 0!==a?a:0:i.deltaType===c.WI.Delete?-1*i.length:i.deltaType===c.WI.Update?(null!==(l=null===(s=i.content)||void 0===s?void 0:s.length)&&void 0!==l?l:0)-i.length:0,n=this._predictionUpdate+1;this._predictionUpdate=n,await this.determineIfPredictionIsValidAndApply(Object.assign(Object.assign({},e),{startIndex:e.startIndex+t}),n)}}determineIfPredictionTextIsValid(e,t,n){var i,o,a,s,l,g,p,m,v;const y=this._proofingDom.findParagraphNode(e.tileId),_=this.trimLineEnding(this._paragraphTextExtractor.getParagraphText(y)),b=null!==(o=null===(i=this.lastPredictedTile)||void 0===i?void 0:i.predictionContext.length)&&void 0!==o?o:0;if(e.entityType===r.c.Loop&&e.tileId===(null===(a=this.lastPredictedTile)||void 0===a?void 0:a.id)&&e.entityType===this.lastPredictedTile.predictionType&&(null!==(l=null===(s=e.context)||void 0===s?void 0:s.length)&&void 0!==l?l:0)>b+3)return{result:!1};if(t&&e.shouldDismissOnTextChange)return{result:!1};const C=null!==(g=null==t?void 0:t.position)&&void 0!==g?g:0;if(_&&(0,f.l)(y)){const i=_.substring(e.startIndex);t&&this.isEntityPrediction(e.entityType)&&this.prepareEntityPredictionForTextUpdate(e,_);const r=(e.context?e.context.substring(0,e.startIndex):_.substring(0,e.startIndex))+e.text;let o=0;for(let r=0;r<e.text.length;r++){const a=e.text.charAt(r),s=(null==t?void 0:t.deltaType)===c.WI.Delete?1:0;if(r>=i.length||t&&r+e.startIndex>C-s)break;if(t&&t.deltaType===c.WI.Delete&&r+e.startIndex===C-s&&n&&1===n.length&&a===n)break;if(a===i.charAt(r))o++;else{if(!this.allowMiddleOfSentencePredictions()){if(e.shouldDismissOnTextChange)break;return{result:!1}}if(!t)break;if(t.deltaType!==c.WI.Add||!t.content||!(t.content===i.charAt(r)||u.Yv(t.content.charCodeAt(0))&&u.Yv(i.charCodeAt(r))))return{result:!1}}}const a=_.substring(0,e.startIndex+o);if(e.currentEndIndex&&e.currentEndIndex>a.length&&(!t||t.deltaType!==c.WI.Delete||C<e.startIndex))return{result:!1};if(e.currentEndIndex=a.length,e.entityResults&&!this.checkIfEntityPredictionContextIsValid(e,_,o))return{result:!1};if(r.startsWith(a)&&a!==r){const t=a.length,n=this._tileContent.getContainingElement(y);if(!n)return{result:!1,dueToMissingContainingHTMLElement:!0};const i=null!==(p=(0,h.m)(n))&&void 0!==p?p:n;return(null===(m=this.lastPredictedTile)||void 0===m?void 0:m.id)!==e.tileId&&(this.lastPredictedTile={id:e.tileId,predictionType:e.entityType,predictionContext:null!==(v=e.context)&&void 0!==v?v:""}),{paragraphNode:y,paragraphNodeOffset:y.element.offset,insertableTextStart:t,htmlParentElement:n,contentEditableHtmlParentElement:i,predictionText:r}}if(a===r)return this.logAcceptedTelemetry(e,e.text.length,!1,d.r7,!!e.entityResults),{result:!1,dueToEntirePredictionTyped:!0}}return{result:!1}}getBasePredictionLogFields(e){const t=(0,s.W)(["predictionTextLength",e.text.length],["entityType",e.entityType]);return void 0!==this._predictionFirstDisplayedTime&&t.push((0,s.n)("firstDisplayedTime",this._predictionFirstDisplayedTime.toISOString())),t}};m=(0,i.__decorate)([(0,p._)()],m)},70916:(e,t,n)=>{"use strict";n.d(t,{J:()=>s});var i=n(13608),r=n(59901),o=n(63503),a=n(95734);const s=e=>{const{hostSettings:t,themeStore:n}=e,s=(0,o.ZY)(),[l,u]=a.useState(null==n?void 0:n.getComponentActiveTheme(i.yF.predictionContainerComponentName,!0));a.useEffect((()=>{if(!n)return()=>{};const e=()=>{u(n.getComponentActiveTheme(i.yF.predictionContainerComponentName,!0))};return n.subscribe("currentThemeUpdated",e),n.subscribe("defaultThemeUpdated",e),n.subscribe("themesUpdated",e),()=>{n.unsubscribe("currentThemeUpdated",e),n.unsubscribe("defaultThemeUpdated",e),n.unsubscribe("themesUpdated",e)}}),[n]);const d=(e=>{var t,n,i,o,a,s,l;return`\n  .ms-text-prediction {\n    color: ${null==e?void 0:e.text};\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-ghost-text {\n    color: ${null!==(t=null==e?void 0:e.text)&&void 0!==t?t:r.L.colorNeutralForeground4};\n    position: relative;\n    user-select: none;\n    background: ${null!==(n=null==e?void 0:e.highlightColor)&&void 0!==n?n:r.L.colorNeutralBackground5};\n  }\n\n  .ms-entity-prediction {\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-entity-prediction-wrapper {\n    background: ${null!==(i=null==e?void 0:e.background.resting)&&void 0!==i?i:r.L.colorNeutralBackground3};\n    color: ${null!==(o=null==e?void 0:e.entityText.resting)&&void 0!==o?o:r.L.colorNeutralForeground4};\n    border-radius: 4px;\n    padding: 0px 4px;\n    gap: 4px;\n    user-select: none;\n    display: inline-flex;\n    pointer-events: all;\n    cursor: pointer;\n  }\n\n  .ms-entity-prediction-wrapper:hover {\n    background: ${null!==(a=null==e?void 0:e.background.hover)&&void 0!==a?a:r.L.colorNeutralBackground3Hover};\n    color: ${null==e?void 0:e.entityText.hover};\n  }\n\n  .ms-prediction-tab-hint {\n    align-content: center;\n    border-color: ${null!==(s=null==e?void 0:e.tabBorder)&&void 0!==s?s:null==e?void 0:e.text};\n    border-radius: 2px;\n    border-style: solid;\n    border-width: 1px;\n    box-sizing: border-box;\n    color: ${null!==(l=null==e?void 0:e.tabText)&&void 0!==l?l:r.L.colorNeutralForeground4};\n    display: inline-grid;\n    font-size: 0.630em;\n    height: 1.5em;\n    margin-left: 4px;\n    padding: 1px 4px;\n    position: relative;\n    vertical-align: 10%;\n    white-space: nowrap;\n    width: 2.5em;\n  }\n\n  .ms-entity-prediction-icon {\n    align-self: center\n  }\n\n  .ms-entity-prediction-dropdown {\n    align-self: center\n  }\n  `})(l);return a.useEffect((()=>{if(!t.disableInlineStyleTagInCanvas||!s||!d)return;const e=s.getElementById("ms-prediction-style");if(null===e){const e=s.createElement("style");e.type="text/css",e.id="ms-prediction-style",e.appendChild(s.createTextNode(d)),s.head.appendChild(e)}else e.innerText=d}),[t,s,d]),t.disableInlineStyleTagInCanvas?null:a.createElement("style",{type:"text/css"},d)}},12087:(e,t,n)=>{"use strict";n.d(t,{r:()=>y});var i=n(26017),r=n(87579),o=n(95734);const a=o.memo((e=>{const{children:t,predictionDisplayText:n,shouldShowInsertionHelperText:i,showDropdownChevron:a,localizer:s,isMobile:l,onTextMayOverlapLine:u,onDropdownOpened:d,leftPadding:c,parentElement:h,showIconWithMultipleComponents:g}=e,p=o.useRef(null),f=o.useRef(null),m=o.useCallback((()=>{a&&p.current&&d(p.current)}),[p,d,a]),v=o.useCallback((e=>{"Tab"===e.code&&a&&p.current&&d(p.current)}),[p,d,a]);o.useEffect((()=>{if(!f.current)return;let e=0;const t=f.current.getClientRects();1!==t.length&&(e+=t.length-1),u(e)}));const y=parseInt(window.getComputedStyle(h).fontSize,10);return o.createElement(o.Fragment,null,o.createElement("span",{className:"ms-entity-prediction-wrapper",style:{marginLeft:c?c+"px":void 0},ref:p,onClick:m,onKeyDown:v,role:"combobox"},"ââ",(!a||g)&&o.createElement("span",{className:"ms-entity-prediction-icon"},t),o.createElement("span",{id:"textPrediction",className:"ms-entity-prediction",contentEditable:!1,ref:f},n),a?o.createElement("span",{className:"ms-entity-prediction-dropdown"},o.createElement(r.yuG,{style:{width:y-4,height:y-4}})):o.createElement(o.Fragment,null),"ââ"),i?o.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"ââ",s.getMessage(l?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),"ââ"):o.createElement(o.Fragment,null))}));var s=n(97782),l=n(59132);const u=o.memo((e=>{var t,n;const{prediction:i,parentElement:r}=e,u=parseInt(window.getComputedStyle(r).fontSize,10),d=null!==(n=null===(t=i.entityResults.entities[0].FileExtension)||void 0===t?void 0:t.toLocaleLowerCase())&&void 0!==n?n:"",c=Object.prototype.hasOwnProperty.call(l.L,d)?l.L[d].iconType:"Cloud";return o.createElement(a,Object.assign({},e,{showDropdownChevron:i.entityResults.entities.length>1}),o.createElement(s.I,{type:c,style:{width:u,height:u},fontSize:u}))}));var d=n(4812);const c=o.memo((e=>{var t,n;const{prediction:i,parentElement:r}=e,l=parseInt(window.getComputedStyle(r).fontSize,10),u=(0,d.S)(null!==(n=null===(t=i.entityResults.entities[0].icon)||void 0===t?void 0:t.iconName)&&void 0!==n?n:"");return o.createElement(a,Object.assign({},e,{showDropdownChevron:i.entityResults.entities.length>1}),o.createElement(s.I,{type:null!=u?u:"Cloud",style:{width:l,height:l},fontSize:l}))}));var h=n(99265);const g=o.memo((e=>{const{prediction:t,parentElement:n}=e,i=parseInt(window.getComputedStyle(n).fontSize,10);return o.createElement(a,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1,showIconWithMultipleComponents:!0}),o.createElement(h.c,{coinSize:i,text:"",imageUrl:t.entityResults.entities[0].imageUrl,imageInitials:t.entityResults.entities[0].imageInitials}))})),p=o.memo((e=>{const{prediction:t}=e;return o.createElement(a,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1}))}));var f=n(20193);const m="textPrediction",v=o.memo((e=>{const{predictionDisplayText:t,shouldShowInsertionHelperText:n,isPIMPrediction:i,isMobile:r,localizer:a,onTextMayOverlapLine:s,leftPadding:l,onDropdownOpened:u,isHelperText:d,appName:c}=e,h=t.split(" "),g=o.useRef({}),p=o.useCallback((()=>{i&&g.current[0]&&u(g.current[0])}),[u]);if(o.useEffect((()=>{if(!g.current[0]||!g.current[h.length-1])return;let e=0,t=0;for(let n=0;n<h.length;n++){if(!g.current[n])continue;const i=0===n,r=n===h.length-1,o=g.current[n].getBoundingClientRect();if(i?e=o.top:o.top!==e&&(t++,e=o.top),r){const e=g.current[n].getClientRects();1!==e.length&&(t+=e.length-1)}}s(t)})),!h)return o.createElement(o.Fragment,null);const f=["BingAtWork","BizChat"].some((e=>null==c?void 0:c.includes(e)))&&d;return o.createElement(o.Fragment,null,h.map(((e,t,i)=>{const s=0===t,u=t+1===i.length,d=e+(u?"":" ");return o.createElement("span",{key:`${m}-${t}`,id:`${m}-${t}`,className:f?"ms-ghost-text":"ms-text-prediction",style:{paddingLeft:s&&l?l+"px":void 0,whiteSpace:u&&n?"nowrap":void 0,borderRadius:s&&f?"4px 0 0 4px":t===i.length-2?"0 4px 4px 0":void 0},contentEditable:!1,ref:e=>{g.current[t]=e},onMouseOver:p,onFocus:p},"ââ",d,"ââ",u&&n?o.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"ââ",a.getMessage(r?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),"ââ"):o.createElement(o.Fragment,null))})))}));function y(e,t,n,r,a,s,l,d,h,m,y){return o.createElement(f.K,{rtl:n.isRtl()},function(e,t,n,r,a,s,l,d,h,f){var m,y,_,b,C,T,S;return n.entityType===i.c.File&&n.entityResults&&r?o.createElement(u,{predictionDisplayText:r,prediction:n,shouldShowInsertionHelperText:null===(m=n.shouldShowInsertionHelperText)||void 0===m||m,leftPadding:d,localizer:e,isMobile:t,parentElement:a,onTextMayOverlapLine:l,onDropdownOpened:s}):n.entityType===i.c.People&&n.entityResults&&r?o.createElement(g,{predictionDisplayText:r,prediction:n,shouldShowInsertionHelperText:null===(y=n.shouldShowInsertionHelperText)||void 0===y||y,leftPadding:d,localizer:e,isMobile:t,parentElement:a,onTextMayOverlapLine:l,onDropdownOpened:s}):n.entityType===i.c.Loop&&n.entityResults&&r?o.createElement(c,{predictionDisplayText:r,prediction:n,shouldShowInsertionHelperText:null===(_=n.shouldShowInsertionHelperText)||void 0===_||_,leftPadding:d,localizer:e,isMobile:t,parentElement:a,onTextMayOverlapLine:l,onDropdownOpened:s}):n.entityType===i.c.PIM&&r&&h&&(null!==(C=null===(b=n.entityResults)||void 0===b?void 0:b.entities.length)&&void 0!==C?C:0)>1?o.createElement(p,{predictionDisplayText:r,prediction:n,shouldShowInsertionHelperText:null===(T=n.shouldShowInsertionHelperText)||void 0===T||T,leftPadding:d,localizer:e,isMobile:t,parentElement:a,onTextMayOverlapLine:l,onDropdownOpened:s}):[i.c.Text,i.c.People,i.c.PIM,i.c.Topic].includes(n.entityType)&&r?o.createElement(v,{predictionDisplayText:r,shouldShowInsertionHelperText:null===(S=n.shouldShowInsertionHelperText)||void 0===S||S,isPIMPrediction:n.entityType===i.c.PIM,leftPadding:d,localizer:e,isMobile:t,onTextMayOverlapLine:l,onDropdownOpened:s,isHelperText:n.isHelperText,appName:f}):o.createElement(o.Fragment,null)}(e,t,r,a,s,l,d,h,m,y))}},98016:(e,t,n)=>{"use strict";n.d(t,{l:()=>z});var i=n(30206),r=n(53920),o=n(99120),a=n(20399),s=n(38716),l=n(44680),u=n(86278),d=n(86310),c=n(13494),h=n(8903),g=n(36747),p=n(59886),f=n(85079),m=n(84878),v=n(48828),y=n(90424),_=n(30225),b=n(26017),C=n(16081),T=n(21648),S=n(54218),I=n(51579),w=n(28871),E=n(66526),x=n(86539),A=n(36271),D=n(13608),N=n(23094),F=n(4326),P=n(4497),k=n(50630),O=n(70916),B=n(49691),R=n(12087),L=n(95734);const M=L.memo((e=>{var t,n,i,r,o,a,s;const{hostSettings:l,isMobile:u,languageScriptDirectionDetector:d,predictionStateStore:c,themeStore:h}=e,g=c.predictionContentEditableParentElement,p=L.createRef(),[f,m]=L.useState(c.prediction),[v,y]=L.useState(c.predictionDisplayText),_=L.useCallback((()=>{c.prediction&&c.predictionDisplayText&&(m(c.prediction),y(c.predictionDisplayText))}),[c.prediction,c.predictionDisplayText]);L.useEffect((()=>(c.setOnUpdate(_),()=>{c.setOnUpdate(void 0)})),[c,_]);const C=L.useCallback((e=>{c.onEntityDropdownOpened(f,e)}),[c,f]),T=L.useCallback((async e=>{var t,n,i;F.x.isKey(e,P.m.tab)?(e.stopPropagation(),e.preventDefault(),(null===(t=c.prediction)||void 0===t?void 0:t.entityResults)&&c.prediction.entityResults.entities.length>1&&(c.prediction.entityType!==b.c.PIM||(null===(i=null===(n=l.serviceSettings)||void 0===n?void 0:n.predictions)||void 0===i?void 0:i.enablePimMultiPredict))?p.current&&C(p.current):await c.applyCurrentPrediction(e.keyCode)):F.x.isKey(e,[P.m.arrowLeft,P.m.arrowRight,P.m.escape])?await c.clearCurrentPrediction(f,"invalid key press",k.R8.ExplicitRejection):F.x.isKey(e,[P.m.arrowUp,P.m.arrowDown,P.m.enter])&&(c.multiPredictionMenuOpen||await c.clearCurrentPrediction(f,"invalid key press",k.R8.ExplicitRejection))}),[null===(n=null===(t=l.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===n?void 0:n.enablePimMultiPredict,C,f,c,p]),S=L.useCallback((async e=>{e.preventDefault(),e.stopPropagation(),u&&await c.applyCurrentPrediction(k.XG)}),[u,c]),I=L.useCallback((async e=>{if(!p.current)return;let t=Array.from(p.current.getClientRects());t=t.map((e=>{return t=e,new DOMRect(t.x-q,t.y-U,t.width+q+q,t.height+U+U);var t})),t.find((t=>{return n=t,i=e.pageX,r=e.pageY,n.x<=i&&i<=n.x+n.width&&n.y<=r&&r<=n.y+n.height;var n,i,r}))&&(e.preventDefault(),e.stopPropagation(),await c.applyCurrentPrediction(k.XG))}),[p,c]),w=L.useCallback((async e=>{f.isHelperText&&((0,B.m)(e.target)||(0,B.m)(e.relatedTarget))||c.multiPredictionMenuOpen||await c.clearCurrentPrediction(f,"lost focus",k.R8.ImplicitRejection)}),[f,c]),E=L.useCallback((async()=>{await c.isInputPointerAtPrediction()||await c.clearCurrentPrediction(f,"input pointer not at prediction",k.R8.ImplicitRejection)}),[f,c]);L.useEffect((()=>{const e={passive:!0,capture:!0},t=g&&new N.J(g),n=new N.J(document);return null==t||t.addListener("keydown",T),null==t||t.addListener("focusout",w,e),n.addListener("selectionchange",E,e),()=>{null==t||t.removeAllListeners(),n.removeAllListeners()}}),[g,T,w,E]),L.useEffect((()=>{if(!p.current)return;const e=new N.J(p.current),t=new N.J(document);return e.addListener("pointerdown",S,{capture:!0}),u&&t.addListener("pointerdown",I,{capture:!0}),()=>{e.removeAllListeners(),t.removeAllListeners()}}),[I,S,u,p]),L.useEffect((()=>{var e,t,n;null===(n=null===(t=null===(e=l.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onPredictionUpdate)||void 0===n||n.call(t)}),[null===(i=l.serviceSettings)||void 0===i?void 0:i.predictions,v]);const x=L.useCallback((e=>Promise.resolve()),[]);return g?L.createElement("span",{className:"suggestedCompletion",ref:p},L.createElement(O.J,{hostSettings:l,themeStore:h}),(0,R.r)(c.localizer,u,d,f,v,c.predictionParentElement,C,x,f.isHelperText&&"BizChat"===(null===(r=l.hostMetadata)||void 0===r?void 0:r.appName)?4:void 0,null===(a=null===(o=l.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===a?void 0:a.enablePimMultiPredict,null===(s=l.hostMetadata)||void 0===s?void 0:s.appName)):null})),q=20,U=20;var W=n(34242),j=n(38883);let z=class extends W.p{constructor(e,t,n,i,r,o,a,s,l,u,d,c,h,g,p,f,m,v,y){super(e,t,n,i,r,o,a,s,l,u,d,m,f),this._ariaStatusStateStoreFactory=c,this._featureFlagsReader=h,this._themeStore=g,this.languageScriptDirectionDetector=p,this.compositionEventHandler=v,this._isMobile=y,this.shutDown=()=>{this._predictionHTMLElement=void 0,super.shutDown()},this.isInputPointerAtPrediction=async()=>{var e;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const t=await this._tileContent.getTextSelection();return!!t&&!!this._prediction&&t.startPosition===t.endPosition&&(null===(e=t.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&t.endPositionInParagraphNode===this._prediction.currentEndIndex},this.predictionMayOverlapNextLine=e=>Promise.resolve()}allowMiddleOfSentencePredictions(){var e,t,n;return null!==(n=null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.allowMiddleOfSentencePredictions)&&void 0!==n&&n}async applyCurrentPrediction(e,t){var n,i,r;if(!this._prediction)return;const o=this._prediction;if(o.isHelperText)return;const a=this.determineIfPredictionTextIsValid(o);if("result"in a)return void await this.clearCurrentPrediction(o,"invalid application",k.R8.ImplicitRejection);const{paragraphNode:s,paragraphNodeOffset:l,insertableTextStart:u,predictionText:d}=a,c=d.substring(u);let h;if(h=this.isEntityPrediction(o.entityType)&&o.entityResults&&u!==o.startIndex?await this._tileContent.getRangeOfNode(s.parent,void 0,l+o.startIndex,u-o.startIndex):await this._tileContent.getNodeInsertionPosition(s.parent,l+u,!0),await this._predictionStore.clearPrediction(),this.isEntityPrediction(o.entityType)&&o.entityResults){const e=null!=t?t:this.getPredictionFirstItem(o);e&&h&&(null===(i=null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.predictions)||void 0===i?void 0:i.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(o,e,h,s.parent.element)}else await this._tileContent.insert(s.parent,void 0,l+u,c,!0,h,!1,!1),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(r=this._ariaStatusStateStoreFactory())||void 0===r||r.setStatus(this._localizer.getMessage("ebx_PredictionAppliedMessage",c),"assertive",!1));this.logAcceptedTelemetry(o,u-o.startIndex,!0,e,!!o.entityResults)}async onPredictionUpdated(){var e,t;const n=this._predictionUpdate+1;this._predictionUpdate=n;const i=this._predictionStore.getCurrentPrediction();if(i)await this.determineIfPredictionIsValidAndApply(i,n);else{const n=this._predictionHTMLElement,i=this._predictionParentElement;if(this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionFirstDisplayedTime=void 0,this._predictionHTMLElement=void 0,n)if(j.unmountComponentAtNode(n),null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onDomRemoval)this._hostSettings.serviceSettings.predictions.onDomRemoval(n,i);else{const e=n.parentElement;n.remove(),e&&"div"===e.nodeName.toLowerCase()&&!e.textContent&&0===e.childElementCount&&e.appendChild(e.ownerDocument.createElement("br"))}this._onUpdate&&this._onUpdate()}}async determineIfPredictionIsValidAndApply(e,t,n,i,s,l,u){var d,c,h,g,p,f;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,k.R8.NotSeen);if(void 0!==s&&s!==r.Q0.Local&&l&&i&&n)return void await this.handleRemotePredictionUpdate(e,n,i,l);if(i&&i!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",k.R8.ExplicitRejection);const m=this.determineIfPredictionTextIsValid(e,l,u);if("result"in m){if(m.dueToMissingContainingHTMLElement)return;return void(m.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",k.R8.TypeNotMatchingCharacter))}const{insertableTextStart:v,htmlParentElement:y,contentEditableHtmlParentElement:_,predictionText:b}=m;if(this._prediction=e,this._predictionParentElement=y,this._predictionContentEditableParentElement=_,b.substring(v)!==this._predictionDisplayText){if(this._predictionDisplayText=b.substring(v),!this._predictionHTMLElement){if(null===(d=this.compositionEventHandler)||void 0===d?void 0:d.isComposing)return void(this._predictionHTMLElement=void 0);if(this._predictionHTMLElement=y.ownerDocument.createElement("span"),this._predictionHTMLElement.contentEditable="false",this._predictionHTMLElement.classList.add("ms-prediction"),null===(c=this.compositionEventHandler)||void 0===c?void 0:c.isComposing)return void(this._predictionHTMLElement=void 0);if(t<this._predictionUpdate)return;const n=this._predictionHTMLElement.ownerDocument.getSelection(),i=1===(null==n?void 0:n.rangeCount)?n.getRangeAt(0):void 0;if(!i)return this._logger.log(524882904,a.q.Warn,"Unable to find range of prediction text insertion point in PredictionStateStore."),void await this.clearCurrentPrediction(e,"unable to determine range for prediction",k.R8.NotSeen);{const t=L.createElement(M,{predictionStateStore:this,themeStore:this._themeStore,isMobile:null!==(h=this._isMobile)&&void 0!==h&&h,hostSettings:this._hostSettings,languageScriptDirectionDetector:this.languageScriptDirectionDetector});if((0,o.d)(this._predictionHTMLElement,t),null===(p=null===(g=this._hostSettings.serviceSettings)||void 0===g?void 0:g.predictions)||void 0===p?void 0:p.onDomInsertion){if(!this._hostSettings.serviceSettings.predictions.onDomInsertion(i,this._predictionHTMLElement,y))return void await this.clearCurrentPrediction(e,"host unable to insert prediction",k.R8.NotSeen)}else i.insertNode(this._predictionHTMLElement),n&&n.setBaseAndExtent(i.startContainer,i.startOffset,i.startContainer,i.startOffset)}this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(f=this._ariaStatusStateStoreFactory())||void 0===f||f.setStatus(this._localizer.getMessage(this._isMobile?"ebx_MobilePredictionAvailableMessage":"ebx_PredictionAvailableMessage",e.text),"assertive",!1))}this._onUpdate&&this._onUpdate()}}checkForECCHintTextPrediction(){var e,t,n,i,r,o,a;const s=null===(e=this._inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo();if(!s||s.searchBoxGeneratedParagraphId||"InlineSuggestionsResultsUserInitiatedMenuType"!==s.menuType.menuType||s.queryRange.length!==(null!==(n=null===(t=s.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==n?n:1)||!(null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.enableZeroQueryHintText)&&(!s.enableExpandedECC||!s.enableExpandedECCSearchBar))return!1;const l=this._paragraphTextExtractor.getParagraphText(s.tileId),u=s.queryRange.start+(null!==(o=null===(r=s.queryRange.prefix)||void 0===r?void 0:r.length)&&void 0!==o?o:1),d="BizChat"===(null===(a=this._hostSettings.hostMetadata)||void 0===a?void 0:a.appName)?this.localizer.getMessage("ebx_ECCZeroQueryBizChatHintText")+" ":this.localizer.getMessage("ebx_ECCZeroQueryHintText")+" ";return this._predictionStore.updatePrediction({text:d,context:null==l?void 0:l.substring(0,u),annotationId:"1",tileId:s.tileId,tileVersion:0,entityType:b.c.Text,startIndex:u,length:d.length,shouldDismissOnTextChange:!0,shouldShowInsertionHelperText:!1,isHelperText:!0}),!0}};z=(0,i.__decorate)([(0,v._)(),(0,i.__param)(0,(0,y.W)(s.H)),(0,i.__param)(1,(0,y.W)(l.n)),(0,i.__param)(2,(0,y.W)(u.g)),(0,i.__param)(3,(0,y.W)(d.m)),(0,i.__param)(4,(0,y.W)(I.o)),(0,i.__param)(5,(0,y.W)(E.w)),(0,i.__param)(6,(0,y.W)(x.b)),(0,i.__param)(7,(0,y.W)(A.d)),(0,i.__param)(8,(0,y.W)(c.M5)),(0,i.__param)(9,(0,_.l)()),(0,i.__param)(9,(0,y.W)(C.A)),(0,i.__param)(10,(0,_.l)()),(0,i.__param)(10,(0,y.W)(T.V)),(0,i.__param)(11,(0,y.W)(S.Th)),(0,i.__param)(12,(0,y.W)(h.c)),(0,i.__param)(13,(0,y.W)(D.YQ)),(0,i.__param)(14,(0,y.W)(g.iw)),(0,i.__param)(15,(0,y.W)(p.o)),(0,i.__param)(16,(0,_.l)()),(0,i.__param)(16,(0,y.W)(w.Y)),(0,i.__param)(17,(0,_.l)()),(0,i.__param)(17,(0,y.W)(f.q)),(0,i.__param)(18,(0,_.l)()),(0,i.__param)(18,(0,y.W)(m.n))],z)},74840:(e,t,n)=>{"use strict";n.d(t,{q:()=>w});var i=n(37842),r=n(8676),o=n(50630),a=n(38716),s=n(44680),l=n(36747),u=n(31685),d=n(84878),c=n(23094),h=n(13608),g=n(4326),p=n(4497),f=n(10383),m=n(70916);const v=(e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let n=e.parentElement,i=window.getComputedStyle(n);for(;n&&"relative"!==i.position&&n!==document.body;)n=n.parentElement,i=window.getComputedStyle(n);return n},y=()=>!0;var _=n(12087),b=n(95734),C=n(13956);const T=(0,i.F5)({predictionStateStore:r.A.on(o.Tc),localizer:r.A.on(a.H),themeStore:r.A.on(h.YQ).optional(),hostSettings:r.A.on(s.n),languageScriptDirectionDetector:r.A.on(l.iw),safeWindow:r.A.on(u.j),isMobile:r.A.on(d.n).optional()}),S=b.memo((e=>{var t;const{prediction:n,predictionDisplayText:r,targetLocation:a,onApplyCurrentPrediction:s,onClearCurrentPrediction:l,isInputPointerAtPrediction:u,onCurrentPredictionMayOverlapNextLine:d,onEntityDropdownOpened:h,predictionContentEditableParentElement:S,predictionParentElement:I}=e,{hostSettings:w,isMobile:E,languageScriptDirectionDetector:x,localizer:A,predictionStateStore:D,themeStore:N,safeWindow:F}=(0,i.KN)(T),P=b.useRef(null),k=b.useRef(null),O=b.useRef(),B=b.useRef({top:0,left:0}),[R,L]=b.useState({zIndex:"auto",element:void 0,shouldRender:()=>!0,shouldRenderPrediction:()=>!0,shouldObserveSize:()=>[],addHandlers:()=>()=>null,predictionInlineStyles:()=>{},transformPredictionRects:e=>e,getForbiddenRects:()=>[]}),[M,q]=b.useState(!1),[U,W]=b.useState({container:{},overlay:{},anchorStyle:{position:"static"}}),j=Object.assign(Object.assign({},U.overlay),{zIndex:null!==(t=R.zIndex)&&void 0!==t?t:U.overlay.zIndex}),z=b.useCallback((()=>{const e=S.scrollLeft,t=S.scrollTop;P.current&&(P.current.scrollLeft=e,P.current.scrollTop=t)}),[S.scrollLeft,S.scrollTop]),H=b.useCallback((e=>F.requestAnimationFrame(e)),[F]),V=b.useCallback((()=>{const e=(0,f.dB)(S,k.current,B),t=(0,f.Cf)(S);B.current={top:e.top,left:e.left},W((()=>(z(),q(!0),{container:e,overlay:t.overlay,anchorStyle:t.anchor})))}),[S,z]),G=b.useCallback((()=>{H(V)}),[H,V]),Q=()=>(setTimeout((()=>{G(),S.dispatchEvent(new Event("BX-ForceReflow",{bubbles:!0}))}),500),!0),K=()=>{H(z)},$=async e=>{g.x.isKey(e,p.m.tab)?(e.stopPropagation(),e.preventDefault(),await s(e.keyCode)):g.x.isKey(e,[p.m.arrowLeft,p.m.arrowUp,p.m.arrowRight,p.m.arrowDown,p.m.enter,p.m.escape])&&await l("invalid key press",o.R8.ExplicitRejection)},Z=async e=>{e.preventDefault(),e.stopPropagation(),E&&await s(o.XG)},J=()=>{setTimeout((async()=>{D.multiPredictionMenuOpen||await l("lost focus",o.R8.ImplicitRejection)}),100)},Y=()=>{F.requestIdleCallback((async()=>{await X()}),100)},X=async()=>{await u()||await l("input pointer not at prediction",o.R8.ImplicitRejection)};b.useEffect((()=>{G()}),[G]),b.useEffect((()=>{L(((e,t,n=!0)=>{var i;const r=y,o=y,a=()=>[],s=()=>()=>null,l=()=>{},u=e=>e,d=()=>[];return"body"!==e.tagName.toLowerCase()&&e.parentElement?{element:n?v(e,t):e.parentElement,zIndex:void 0,shouldRender:r,shouldRenderPrediction:o,shouldObserveSize:a,addHandlers:s,predictionInlineStyles:l,transformPredictionRects:u,getForbiddenRects:d}:{element:null!==(i=e.parentElement)&&void 0!==i?i:window.document.body,zIndex:"auto",shouldRender:r,shouldRenderPrediction:o,shouldObserveSize:a,addHandlers:s,predictionInlineStyles:l,transformPredictionRects:u,getForbiddenRects:d}})(S,U.anchorStyle.position))}),[U.anchorStyle.position,S]),b.useEffect((()=>{const e={passive:!0,capture:!0},t=new c.J(window),n=new c.J(document),i=new c.J(S);t.addListener("resize",G,e),t.addListener("hashchange",Q,e),t.addListener("popstate",Q,e),n.addListener("mouseup",Q,e),n.addListener("selectionchange",Y,e),i.addListener("paste",Q,e),i.addListener("scroll",K,e),i.addListener("keydown",$),i.addListener("focusout",J,e),(()=>{if(!O.current&&window.ResizeObserver&&(Q(),O.current=new window.ResizeObserver((()=>{G()}))),O.current){O.current.observe(S);for(const e of R.shouldObserveSize(S))O.current.observe(e)}})();const r=R.addHandlers(S,{queueUpdateOverlay:G,updateOverlayAndNotifyInput:Q});return()=>{t.removeAllListeners(),n.removeAllListeners(),i.removeAllListeners(),O.current&&O.current.disconnect(),r()}}),[]),b.useEffect((()=>{if(!k.current)return;const e=new c.J(k.current);return e.addListener("mousedown",Z),()=>{e.removeAllListeners()}}),[k,Z]);const ee=b.useCallback((async e=>{await d(e)}),[d]),te=b.useCallback((e=>{h(e)}),[h]),ne=window.getComputedStyle(S),ie=parseInt(ne.paddingLeft,10),re=parseInt(ne.paddingTop,10),oe=(a.x,a.y-re);return R.element?b.createElement(C.Ay.div,{className:"ms-editor-text-prediction"},b.createElement(m.J,{hostSettings:w,themeStore:N}),b.createElement("div",{ref:k,style:U.container},b.createElement("div",{id:"ms-editor-text-prediction-overlay",style:j,className:"hc-noadjust"},b.createElement("div",{style:{paddingTop:oe+"px"}}),M&&(0,_.r)(A,null!=E&&E,x,n,r,I,te,ee,ie)))):null})),I=(0,i.F5)({predictionStateStore:r.A.on(o.Tc)}),w=()=>{const{predictionStateStore:e}=(0,i.KN)(I),[t,n]=b.useState(),[r,o]=b.useState(),a=()=>{n(e.prediction),o(e.predictionDisplayText)};b.useEffect((()=>(e.setOnUpdate(a),()=>{e.setOnUpdate(void 0)})),[e]);const s=b.useCallback((async t=>{await e.applyCurrentPrediction(t)}),[]),l=b.useCallback((async(t,n)=>{e.prediction&&await e.clearCurrentPrediction(e.prediction,t,n)}),[]),u=b.useCallback((async()=>e.isInputPointerAtPrediction()),[]),d=b.useCallback((async t=>{await e.predictionMayOverlapNextLine(t)}),[]),c=b.useCallback((n=>{e.onEntityDropdownOpened(t,n)}),[]);return t&&e.prediction&&e.predictionDisplayLocation&&e.predictionParentElement&&e.predictionContentEditableParentElement?b.createElement(S,{prediction:t,predictionDisplayText:r,targetLocation:e.predictionDisplayLocation,predictionContentEditableParentElement:e.predictionContentEditableParentElement,predictionParentElement:e.predictionParentElement,onApplyCurrentPrediction:s,onClearCurrentPrediction:l,isInputPointerAtPrediction:u,onCurrentPredictionMayOverlapNextLine:d,onEntityDropdownOpened:c}):null}},1180:(e,t,n)=>{"use strict";n.d(t,{O:()=>w});var i=n(30206),r=n(53920),o=n(3755),a=n(38716),s=n(44680),l=n(86278),u=n(86310),d=n(13494),c=n(59886),h=n(48828),g=n(90424),p=n(30225),f=n(26017),m=n(16081),v=n(21648),y=n(51579),_=n(28871),b=n(66526),C=n(86539),T=n(36271),S=n(50630),I=n(34242);let w=class extends I.p{constructor(e,t,n,i,r,o,a,s,l,u,d,c,h){super(e,t,n,i,r,o,a,l,s,d,c,h,u),this._predictionHasWrappedOntoNewLineCount=0,this.isInputPointerAtPrediction=async()=>{var e,t;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const n=await this._tileContent.getTextSelection();return!!n&&!!this._prediction&&n.startPosition===n.endPosition&&(null===(e=n.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&n.endPositionInParagraphNode===(null===(t=n.endParagraphNode)||void 0===t?void 0:t.element).span-(void 0===this.getNextParagraphAfterPrediction()?0:1)},this.removeWrappingNewLines=async()=>{var e;const t=this.getNextParagraphAfterPrediction();(null===(e=null==t?void 0:t.parent)||void 0===e?void 0:e.element)&&t.element&&0!==this._predictionHasWrappedOntoNewLineCount&&await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount)},this.insertNewLines=async(e,t,n)=>{let i="";for(let e=0;e<n;e++)i+="\n";this._isActivelyAddingWrappingNewLines=!0,await this._tileContent.insert(e,void 0,t,i,!1,void 0,!0,!1),this._isActivelyAddingWrappingNewLines=!1},this.removeNewLines=async(e,t,n)=>{this._isActivelyAddingWrappingNewLines=!0;for(let i=0;i<n;i++)await this._tileContent.remove(e,void 0,t-1,1,!1,void 0,!0,!1);this._isActivelyAddingWrappingNewLines=!1},this.getNextParagraphAfterPrediction=()=>{var e;if(this._prediction){const t=this._proofingDom.findParagraphNode(this._prediction.tileId);if((null==t?void 0:t.parent)&&t.element&&"offset"in t.element){const n=t.element.offset+t.element.span;let i;return null===(e=t.parent.children)||void 0===e||e.forEach((e=>{e.element&&"offset"in e.element&&e.element.offset>=n&&(!i||i.element&&e.element.offset<i.element.offset)&&(i=e)})),i}}}}allowMiddleOfSentencePredictions(){return!1}async applyCurrentPrediction(e,t){var n,i;if(!this._prediction)return;const r=this._prediction,o=this.determineIfPredictionTextIsValid(r);if("result"in o)return void await this.clearCurrentPrediction(r,"invalid application",S.R8.ImplicitRejection);const{paragraphNode:a,paragraphNodeOffset:s,insertableTextStart:l,predictionText:u}=o,d=u.substring(l);this._predictionHasWrappedOntoNewLineAtStartOfTile&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0);const c=await this._tileContent.getNodeInsertionPosition(a.parent,s+l,!0);if(await this._predictionStore.clearPrediction(),this.isEntityPrediction(r.entityType)){const e=null!=t?t:this.getPredictionFirstItem(r);e&&c&&(null===(i=null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.predictions)||void 0===i?void 0:i.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(r,e,c,a.parent.element)}else a.parent&&await this._tileContent.insert(a.parent,void 0,s+l,d,!0,c,!1,!1);this.logAcceptedTelemetry(r,l-r.startIndex,!0,e,!!r.entityResults)}async predictionMayOverlapNextLine(e){var t,n,i;if(!this._prediction||this._prediction.entityType!==f.c.File&&this._prediction.entityType!==f.c.People){if(this._predictionHasWrappedOntoNewLineAtStartOfTile){if(e>this._predictionHasWrappedOntoNewLineCount){const n=this.getNextParagraphAfterPrediction();(null===(t=null==n?void 0:n.parent)||void 0===t?void 0:t.element)&&n.element&&(await this.insertNewLines(n.parent,n.element.offset,e-this._predictionHasWrappedOntoNewLineCount),this._predictionHasWrappedOntoNewLineAtStartOfTile=n.id,this._predictionHasWrappedOntoNewLineCount=e)}else if(e<this._predictionHasWrappedOntoNewLineCount){const t=this.getNextParagraphAfterPrediction();(null===(n=null==t?void 0:t.parent)||void 0===n?void 0:n.element)&&t.element&&(await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount-e),this._predictionHasWrappedOntoNewLineCount=e)}}else if(0!==e){const t=this.getNextParagraphAfterPrediction();(null===(i=null==t?void 0:t.parent)||void 0===i?void 0:i.element)&&t.element&&(this._predictionHasWrappedOntoNewLineAtStartOfTile=t.id,this._predictionHasWrappedOntoNewLineCount=e,await this.insertNewLines(t.parent,t.element.offset,e))}}else 0!==e&&await this.clearCurrentPrediction(this._prediction,"Entity cannot wrap",S.R8.NotSeen)}async onPredictionUpdated(){const e=this._predictionUpdate+1;this._predictionUpdate=e;const t=this._predictionStore.getCurrentPrediction();t?await this.determineIfPredictionIsValidAndApply(t,e):(this._predictionHasWrappedOntoNewLineAtStartOfTile&&await this.removeWrappingNewLines(),this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionDisplayLocation=void 0,this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0,this._predictionFirstDisplayedTime=void 0,this._onUpdate&&this._onUpdate())}async determineIfPredictionIsValidAndApply(e,t,n,i,a,s,l){var u;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,S.R8.NotSeen);if(void 0!==a&&a!==r.Q0.Local&&s&&i&&n)return void await this.handleRemotePredictionUpdate(e,n,i,s);if(i&&i!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",S.R8.ExplicitRejection);const d=this.determineIfPredictionTextIsValid(e,s,l);if("result"in d){if(d.dueToMissingContainingHTMLElement)return;return void(d.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",S.R8.ExplicitRejection))}const{paragraphNode:c,paragraphNodeOffset:h,insertableTextStart:g,htmlParentElement:p,contentEditableHtmlParentElement:f,predictionText:m}=d,v=this._paragraphTextExtractor.getParagraphText(e.tileId),y=await this._tileContent.getRangeOfNode(c.parent,void 0,h+g-1,1),_=null==y?void 0:y.commonAncestorContainer.parentElement;if(y&&_){const n=y.getBoundingClientRect(),i=p.getBoundingClientRect();let r=0;if((0,o.C)(_,"HTMLElement")){const e=_.getBoundingClientRect(),t=new Range;t.setStart(_,0),t.setEnd(_,1),r=t.getBoundingClientRect().top-e.top}if(this._predictionHasWrappedOntoNewLineAtStartOfTile&&(null===(u=this.prediction)||void 0===u?void 0:u.annotationId)!==e.annotationId&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0),t<this._predictionUpdate)return;if(v!==this._paragraphTextExtractor.getParagraphText(e.tileId)){this._predictionDisplayText=void 0;const t=this._predictionUpdate+1;return this._predictionUpdate=t,void await this.determineIfPredictionIsValidAndApply(e,t)}const a=void 0===this._prediction;if(this._prediction=e,this._predictionParentElement=p,this._predictionContentEditableParentElement=f,this._predictionDisplayLocation={x:n.right-i.left,y:n.top-r-i.top},m.substring(g)===this._predictionDisplayText)return;this._predictionDisplayText=m.substring(g),a&&(this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e)),this._onUpdate&&this._onUpdate()}else await this.clearCurrentPrediction(e,"unable to determine range for prediction",S.R8.NotSeen)}};w=(0,i.__decorate)([(0,h._)(),(0,i.__param)(0,(0,g.W)(a.H)),(0,i.__param)(1,(0,g.W)(s.n)),(0,i.__param)(2,(0,g.W)(l.g)),(0,i.__param)(3,(0,g.W)(u.m)),(0,i.__param)(4,(0,g.W)(y.o)),(0,i.__param)(5,(0,g.W)(b.w)),(0,i.__param)(6,(0,g.W)(C.b)),(0,i.__param)(7,(0,g.W)(d.M5)),(0,i.__param)(8,(0,g.W)(T.d)),(0,i.__param)(9,(0,g.W)(c.o)),(0,i.__param)(10,(0,p.l)()),(0,i.__param)(10,(0,g.W)(m.A)),(0,i.__param)(11,(0,p.l)()),(0,i.__param)(11,(0,g.W)(v.V)),(0,i.__param)(12,(0,p.l)()),(0,i.__param)(12,(0,g.W)(_.Y))],w)},11311:(e,t,n)=>{var i={"./af-za/ui-strings.json":[2272,4077],"./am-et/ui-strings.json":[25729,6152],"./ar-sa/ui-strings.json":[67375,7814],"./as-in/ui-strings.json":[20085,9212],"./az-latn-az/ui-strings.json":[33608,4661],"./bg-bg/ui-strings.json":[17970,2263],"./bn-in/ui-strings.json":[14217,1208],"./bs-latn-ba/ui-strings.json":[47202,9551],"./ca-es-valencia/ui-strings.json":[3608,9765],"./ca-es/ui-strings.json":[90544,3629],"./cs-cz/ui-strings.json":[22945,7248],"./cy-gb/ui-strings.json":[10959,2606],"./da-dk/ui-strings.json":[54492,2881],"./de-de/ui-strings.json":[52450,263],"./el-gr/ui-strings.json":[16402,1471],"./en-gb/ui-strings.json":[38020,7377],"./en-us/ui-strings.json":[16279,5398],"./es-es/ui-strings.json":[82232,5133],"./es-mx/ui-strings.json":[26455,8446],"./et-ee/ui-strings.json":[59419,1698],"./eu-es/ui-strings.json":[22254,91],"./fa-ir/ui-strings.json":[6712,9925],"./fi-fi/ui-strings.json":[27590,5867],"./fil-ph/ui-strings.json":[77009,4920],"./fr-ca/ui-strings.json":[44548,3233],"./fr-fr/ui-strings.json":[63868,2625],"./ga-ie/ui-strings.json":[53434,4831],"./gd-gb/ui-strings.json":[55992,8197],"./gl-es/ui-strings.json":[16819,9842],"./gu-in/ui-strings.json":[14985,368],"./he-il/ui-strings.json":[21660,4529],"./hi-in/ui-strings.json":[11934,6075],"./hr-hr/ui-strings.json":[70520,5581],"./hu-hu/ui-strings.json":[57138,9047],"./hy-am/ui-strings.json":[28537,9536],"./id-id/ui-strings.json":[23794,5559],"./is-is/ui-strings.json":[46448,5],"./it-it/ui-strings.json":[61426,2839],"./ja-jp/ui-strings.json":[61887,4230],"./ka-ge/ui-strings.json":[27556,6121],"./kk-kz/ui-strings.json":[43913,9320],"./km-kh/ui-strings.json":[73289,1184],"./kn-in/ui-strings.json":[59456,3077],"./ko-kr/ui-strings.json":[97333,1756],"./kok-in/ui-strings.json":[7656,3109],"./lb-lu/ui-strings.json":[21755,682],"./lo-la/ui-strings.json":[72540,2921],"./lt-lt/ui-strings.json":[99072,7061],"./lv-lv/ui-strings.json":[71280,8597],"./mi-nz/ui-strings.json":[46090,7551],"./mk-mk/ui-strings.json":[78200,189],"./ml-in/ui-strings.json":[94792,6277],"./mr-in/ui-strings.json":[88290,8151],"./ms-my/ui-strings.json":[11566,2067],"./mt-mt/ui-strings.json":[7706,9311],"./nb-no/ui-strings.json":[3201,6024],"./ne-np/ui-strings.json":[7763,3058],"./nl-nl/ui-strings.json":[1428,9881],"./nn-no/ui-strings.json":[38653,9916],"./or-in/ui-strings.json":[96008,2781],"./pa-in/ui-strings.json":[13470,4955],"./pl-pl/ui-strings.json":[37624,2461],"./pt-br/ui-strings.json":[69912,309],"./pt-pt/ui-strings.json":[25288,1149],"./quz-pe/ui-strings.json":[40591,2686],"./ro-ro/ui-strings.json":[35458,903],"./ru-ru/ui-strings.json":[82374,6107],"./sk-sk/ui-strings.json":[8360,4061],"./sl-si/ui-strings.json":[17007,8062],"./sq-al/ui-strings.json":[17823,7278],"./sr-cyrl-ba/ui-strings.json":[39527,6902],"./sr-cyrl-rs/ui-strings.json":[58649,2832],"./sr-latn-rs/ui-strings.json":[28014,6811],"./sv-se/ui-strings.json":[50749,300],"./ta-in/ui-strings.json":[78458,4255],"./te-in/ui-strings.json":[90422,8979],"./th-th/ui-strings.json":[3704,317],"./tr-tr/ui-strings.json":[33848,2413],"./tt-ru/ui-strings.json":[93455,1662],"./ug-cn/ui-strings.json":[14827,8730],"./uk-ua/ui-strings.json":[98766,2659],"./ur-pk/ui-strings.json":[32624,7069],"./uz-latn-uz/ui-strings.json":[65488,9773],"./vi-vn/ui-strings.json":[87565,7572],"./zh-cn/ui-strings.json":[33561,9952],"./zh-tw/ui-strings.json":[37873,2128]};function r(e){if(!n.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],r=t[0];return n.e(t[1]).then((()=>n.t(r,19)))}r.keys=()=>Object.keys(i),r.id=11311,e.exports=r},29594:(e,t,n)=>{"use strict";n.d(t,{$:()=>o,Y:()=>r});const i=(()=>{const e=(()=>{if("undefined"==typeof globalThis){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window}return globalThis})();return void 0===e.Office&&(e.Office={}),void 0===e.Office.Editor&&(e.Office.Editor={}),e})().Office.Editor;function r(e){i.stringProvider=e}function o(){return i.stringProvider}},86388:(e,t,n)=>{"use strict";var i;n.d(t,{h:()=>i}),function(e){e.Undefined="Undefined",e.Host="Host",e.Authentication="Authentication",e.ExceptionHandling="ExceptionHandling",e.Navigation="Navigation",e.UiRendering="UiRendering",e.FeatureSuppression="FeatureSuppression",e.AtAGlance="AtAGlance",e.BxPromo="BxPromo",e.ContentCreation="ContentCreation",e.CritiqueUpsell="CritiqueUpsell",e.WritingAnalytics="WritingAnalytics",e.TableStyles="TableStyles",e.Similarity="Similarity",e.Goals="Goals",e.Feedback="Feedback",e.PremiumSquigglesPreview="PremiumSquigglesPreview",e.Proofing="Proofing",e.EditorScore="EditorScore",e.PremiumPreview="PremiumPreview",e.TonalRewriteFre="TonalRewriteFre",e.WritersUnblock="WritersUnblock",e.AIFeedback="AIFeedback"}(i||(i={}))},20399:(e,t,n)=>{"use strict";var i;n.d(t,{q:()=>i}),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error",e[e.Debug=3]="Debug"}(i||(i={}))},72896:(e,t,n)=>{"use strict";function i(e){return e instanceof Error?JSON.stringify(e,["name","message","stack"]):JSON.stringify(e)}n.d(t,{v:()=>i})},90935:(e,t,n)=>{"use strict";n.d(t,{C:()=>u,L:()=>l});var i=n(17570),r=n(72896);class o{constructor(e){this._loggerSettings=e}logData(e){this._loggerSettings.logToConsole&&console.log((0,r.v)(e))}}const a=new class{constructor(e=!1){this.useConsoleLogger=e,this._consoleLogger=new o({logToConsole:!0})}logEvent(e,t,n,i,r,o,a,s){const l=`${n}.${t}`;this.useConsoleLogger&&this._consoleLogger.logData({message:l,data:r})}logKpi(e,t,n,i,r){const o=`KPIs.${e}`;this.useConsoleLogger&&this._consoleLogger.logData({kpiEvent:`${o}.${t}`,engagement:n,data:r})}logStandaloneMetric(e,t,n,i,r){this.useConsoleLogger&&this._consoleLogger.logData({standaloneMetric:e})}createActivity(e,t){const n=`${t}.${e}`;return this.useConsoleLogger&&this._consoleLogger.logData({activity:n}),{cv:new i.CV(""),setResult:()=>{},endNow:()=>{},createChildActivity:()=>{throw new Error("Not implemented")},telemetryProperties:{},dataFields:[],eventName:"",eventFlags:{}}}};let s;function l(e){s=e}function u(){return s||a}},13608:(e,t,n)=>{"use strict";n.d(t,{UC:()=>R,YQ:()=>o,h1:()=>z,ZP:()=>xe,SV:()=>i,O1:()=>Ae.O,w:()=>O,Cx:()=>P,iN:()=>B,yF:()=>k});var i,r=n(63837);!function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}(i||(i={}));const o=(0,r.f)("IThemeStore"),a=new Map([[i.light,{fill:{color:"#424242"}}],[i.dark,{fill:{color:"#FFFFFF"}}],[i.highContrast,{fill:{color:"#FFFFFF"}}]]),s="CopilotEccIcon",l=new Map([[i.light,{background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#A19F9D"},border:"#FFFFFF",text:{resting:"#201F1E",disabled:"#A19F9D"},tag:{resting:"#605E5C"},altText:{resting:"#605E5C"},icon:{resting:"#797775",disabled:"#A19F9D"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},grammarText:{resting:"#3355FF"},refinementText:{resting:"#5A4EBC"},rewriteText:{resting:"#5A4EBC"},suggestionMenuHoverBackground:"#F3F2F1",header:"#3B3A39",subheader:"#605E5C",dialogText:"#605E5C",iconText:"#605E5C",contextText:"#605E5C",errorText:"#FF0000",separator:"#E1DFDD",focusRing:"#201F1E",link:"#1651AA",linkPressed:"#13458F",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},addOnFooterBackground:"#F3F2F1",upsellFooterColor:"#EFF6FC",addOnFooterMessage:"#201F1E",premiumEmphasis:"#185ABD",addOnAction:"#185ABD",editorIcon:"#185ABD",correctionHighlight:"#D4EDD4",helpLink:{text:{resting:"#1651AA",hover:"#13458F",pressed:"#13458F",disabled:"#A19F9D"},focusRing:"#201F1E"}}],[i.dark,{background:{resting:"#1B1A19",hover:"#252423",pressed:"#292827",disabled:"#797775"},border:"#1B1A19",text:{resting:"#FAF9F8",disabled:"#797775"},tag:{resting:"#A19F9D"},altText:{resting:"#A19F9D"},icon:{resting:"#A19F9D",disabled:"#797775"},altIcon:{resting:"#616161",hover:"#82ABF1",pressed:"#82ABF1",disabled:"#797775"},grammarText:{resting:"#99AAF5"},refinementText:{resting:"#ADA2F2"},rewriteText:{resting:"#ADA2F2"},suggestionMenuHoverBackground:"#252423",header:"#C8C6C4",subheader:"#A19F9D",dialogText:"#A19F9D",iconText:"#A19F9D",contextText:"#A19F9D",errorText:"#FF0000",separator:"#484644",focusRing:"#C8C6C4",link:"#3D7CE8",linkPressed:"#598FEC",branding:{type:"IconAndTextButton",background:{resting:"#1B1A19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},addOnFooterBackground:"#252423",upsellFooterColor:"#092C47",addOnFooterMessage:"#FAF9F8",premiumEmphasis:"#598FEC",addOnAction:"#598FEC",editorIcon:"#598FEC",correctionHighlight:"#095E09",helpLink:{text:{resting:"#3D7CE8",hover:"#598FEC",pressed:"#598FEC",disabled:"#797775"},focusRing:"#C8C6C4"}}],[i.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},border:"#FFFFFF",text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tag:{resting:"#FFFFFF",hover:"#000000"},altText:{resting:"#FFFFFF",hover:"#000000"},icon:{resting:"#FFFFFF",disabled:"#FFFFFF"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},grammarText:{resting:"#FFFFFF",hover:"#000000"},refinementText:{resting:"#FFFFFF",hover:"#000000"},rewriteText:{resting:"#FFFFFF"},suggestionMenuHoverBackground:"#000000",header:"#FFFFFF",subheader:"#FFFFFF",dialogText:"#FFFFFF",iconText:"#FFFFFF",contextText:"#FFFFFF",errorText:"#FFFFFF",separator:"#FFFFFF",focusRing:"#1AEBFF",link:"#FFFF01",linkPressed:"#FFFF01",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},addOnFooterBackground:"#000000",upsellFooterColor:"#000000",addOnFooterMessage:"#FFFFFF",premiumEmphasis:"#FFFFFF",addOnAction:"#FFFFFF",editorIcon:"#FFFFFF",correctionHighlight:"#FFFFFF",helpLink:{text:{resting:"#FFFF01",hover:"#FFFF01",pressed:"#FFFF01",disabled:"#FFFF01"},focusRing:"#FFFF01"},callout:{borderColor:"#FFFFFF"}}]]),u="CritiqueCallout";var d,c,h,g=n(62989);!function(e){e.shade30="#004578",e.shade20="#005a9e",e.shade10="#106ebe",e.primary="#0078d4",e.tint10="#2b88d8",e.tint20="#c7e0f4",e.tint30="#deecf9",e.tint40="#eff6fc"}(d||(d={})),function(e){e.black="#000000",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(c||(c={})),function(e){e.pinkRed10="#750b1c",e.red20="#a4262c",e.red10="#d13438",e.redOrange20="#603d30",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan40="#005e50",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta40="#373277",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(h||(h={}));const p=new Map([[i.light,{background:{resting:c.white,hover:"#F5F5F5",pressed:"#CFE4FA"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:c.gray190,disabled:"#707070"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},actionButtonForeground:{resting:"#0078D4"},highlightingBorderColor:c.gray190,branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},highlighting:"#EBF3FC",altText:{resting:c.gray130},shimmer:{shimmerColor:c.gray20,shimmerWaveColor:c.gray30},scroll:{thumbColor:"#676767"},tooltip:{directionHint:g.A8.rightCenter},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#EBEBEB"},meetingBanner:{backgroundColor:"#FAF9F8",text:"#424242",iconPrimaryColor:"#616161",borderColor:"#d1d1d1"}}],[i.dark,{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD"},footerButtonBackground:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},text:{resting:c.white,disabled:"#707070"},highlightingBorderColor:c.white,altText:{resting:"#D6D6D6"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#115EA3",branding:{type:"IconAndTextButton",background:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#FFFFFF80"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF",directionHint:g.A8.rightCenter},tag:{background:"#082338",textColor:"#62ABF5"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#3D3D3D"},meetingBanner:{backgroundColor:"#141414",text:"#ffffff",iconPrimaryColor:"#adadad",borderColor:"#666666"},noSuggestions:{descriptionTextColor:"#707070",item:{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD",disabled:void 0},text:{resting:"#598FEC"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}]]),f="ExpandedInlineSuggestion",m=new Map([[i.light,{background:"linear-gradient(93.85deg, #EEF3FB 58.87%, #EAE9FF 100%)",buttonBackground:"white",textColor:"#323130",linkColor:"#2E6AC5",dismissColor:"#323130",iconColor:"#185ABD",newTag:{shadow:"0px 1.6px 3.56px 0px rgba(0, 0, 0, 0.13)",background:"#FFFFFF",textColor:"#185ABD"},pagination:{textColor:"#185ABD",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#FFFFFF",textColor:"#201F1E"}}],[i.dark,{background:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",buttonBackground:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",textColor:"white",linkColor:"#82ABF1",dismissColor:"white",iconColor:"#82ABF1",newTag:{background:"#82ABF1",textColor:"#0C2145"},pagination:{textColor:"#82ABF1",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#1B1A19",textColor:"#FFFFFF"},shimmer:{shimmerColor:"#052865"}}]]),v="FooterFRE",y=new Map([[i.light,{background:"#0F6CBD",shadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",borderRadius:{default:"4px",disabled:"0px"},display:"flex",width:"32px",height:"32px",color:"#FFFFFF",border:"none",critiqueCategoryText:{fontFamily:"segoeUi",fontSize:"14px",lineHeight:"18px",fontStyle:"normal",padding:"5px",color:"#000000",minWidth:"unset",fontWeight:"600"},critiqueCategoryNumber:{fontFamily:"bahnschrift",font:"bahnschrift",fontSize:"16px",lineHeight:"18px"},indicatorButtonText:{textAlign:"center",fontFamily:"bahnschrift",fontSize:"16px",minWidth:"unset",padding:"12px",fontWeight:"600"},suggestionNumberText:{padding:"3px"}}]]),_="Indicator",b=new Map([[i.light,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[i.dark,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[i.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),C="InlineNudgeBubble",T=new Map([[i.light,{background:{resting:"#FFFFFF",hover:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:"#201F1E",disabled:"#A19F9D"},altIcon:{resting:"#424242",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},altText:{resting:"#605E5C"},highlightingBorderColor:"#201F1E",actionButtonForeground:{resting:"#0078D4"},highlighting:"#F5F5F5",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},noSuggestions:{descriptionTextColor:"#616161",item:{background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},text:{resting:"#185ABD",disabled:"#707070"},actionButtonForeground:{resting:"#0078D4",disabled:"#707070"},highlighting:"#F5F5F5"}}}],[i.dark,{background:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},footerButtonBackground:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#FAF9F8",disabled:"#797775"},highlightingBorderColor:"#FAF9F8",altText:{resting:"#A19F9D"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929",branding:{type:"IconAndTextButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#D6D6D6"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF"},tag:{background:"#082338",textColor:"#62ABF5"},noSuggestions:{descriptionTextColor:"#D6D6D6",item:{background:{resting:"#1b1a19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#296FE6",disabled:"#707070"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}],[i.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},footerButtonBackground:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},highlightingBorderColor:"#FFFFFF",altText:{resting:"#FFFFFF",hover:"#000000"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},shimmer:{shimmerColor:"#FFFFFF",shimmerWaveColor:"#FFFFFF"},scroll:{thumbColor:"#FFFFFF"},tooltip:{backgroundColor:"#000000",textColor:"#FFFFFF"},callout:{border:"1px solid #FFFFFF"},userAvatarBorderColor:"#FFFFFF",noSuggestions:{descriptionTextColor:"#FFFFFF",item:{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF"}}}]]),S="InlineSuggestion",I=new Map([[i.light,{background:{resting:"#FFFFFF",hover:"#f3f2f1"},text:{resting:"#605e5c"}}],[i.dark,{background:{resting:"#333333",hover:"#212121"},text:{resting:"#f4f4f4"}}],[i.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),w="NudgeBubble",E=new Map([[i.light,{background:{resting:"#f5f5f5",hover:"#eee8ff"},text:"#605e5c",entityText:{resting:"#707070",hover:"#8230ff"},tabText:"#707070",highlightColor:"#EBEBEB"}],[i.dark,{background:{resting:"#141414",hover:"#4c0aa8"},text:"#a19f9d",entityText:{resting:"#999999",hover:"#a375ff"},tabText:"#999999"}],[i.highContrast,{background:{resting:"#000000",hover:"#8ee3f0"},text:"#3FF23F",entityText:{resting:"#ffffff",hover:"#263b50"},tabText:"#3FF23F"}]]),x="PredictionContainer",A=new Map([[i.light,{background:"#FFFFFF",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#424242",altText:"#616161"}],[i.dark,{background:"#1B1A19",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#FFFFFF",altText:"#ADADAD"}]]),D="SquiggleTooltip",N=new Map([[i.light,{primaryButtonBackground:{resting:"#0078D4",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9"},defaultButtonText:{resting:"#201F1E",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",primaryButtonFocusRing:"#FFFFFF",backgroundColor:"#FFFFFF",link:"#1651AA",titleColor:"#201F1E",descriptionColor:"#605E5C",rejectionTextColor:"#201F1E",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#DEECF9",dismissButtonColor:"#000000",highContrast:{iconPrimaryColor:"#000000",iconSecondaryColor:"#FFFFFF"}}],[i.dark,{primaryButtonBackground:{resting:"#2899F5",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#1B1A19",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#1B1A19",hover:"#484644",pressed:"#979593"},defaultButtonText:{resting:"#FAF9F8",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",backgroundColor:"#1B1A19",link:"#2899F5",titleColor:"#FAF9F8",descriptionColor:"#C8C6C4",rejectionTextColor:"#FAF9F8",primaryButtonFocusRing:"#FFFFFF",defaultButtonFocusRing:"#FFFFFF",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#043862",dismissButtonColor:"#FAF9F8",highContrast:{iconPrimaryColor:"#FFFFFF",iconSecondaryColor:"#000000"}}]]),F="TonalFirstRunCard",P=new Map([[u,l],[f,p],[v,m],[S,T],[s,a],[F,N],[w,I],[C,b],[x,E],[D,A],[_,y]]),k={critiqueCalloutComponentName:u,expandedInlineSuggestionComponentName:f,footerFreComponentName:v,inlineSuggestionComponentName:S,copilotEccIconComponentName:s,indicatorComponentName:_,tonalFreComponentName:F,nudgeBubbleComponentName:w,inlineNudgeBubbleComponentName:C,predictionContainerComponentName:x,squiggleTooltipComponentName:D},O=new Map([[w,{}]]),B={critiqueCalloutComponentName:u,footerFreComponentName:v,nudgeBubbleComponentName:w,advancedEditorSettingsDialogComponentName:"AdvancedEditorSettingsDialog"},R=(0,r.f)("IStyleStore");var L=n(30206),M=n(46546);function q(e){return new Map(JSON.parse(JSON.stringify(Array.from(e))))}function U(e){return e&&"object"==typeof e&&Object.keys(e).length?JSON.parse(JSON.stringify(e)):e}var W=n(48828),j=n(92037);let z=class{constructor(){this._styles=new Map,(0,j.Gn)(this)}get components(){return Array.from(this._styles.keys())}getComponentStyle(e){const t=this._styles.get(e);return t&&U(t)}updateComponentStyle(e,t){this._styles.set(e,t)}};(0,L.__decorate)([M.observable],z.prototype,"_styles",void 0),(0,L.__decorate)([M.computed],z.prototype,"components",null),(0,L.__decorate)([M.action],z.prototype,"getComponentStyle",null),(0,L.__decorate)([M.action],z.prototype,"updateComponentStyle",null),z=(0,L.__decorate)([(0,W._)()],z);var H=n(18322);const V=(0,H.a)({semanticColors:{cardShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12),0px 2px 4px 0px rgba(0, 0, 0, 0.08)",cardShadowHovered:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",buttonBackground:"#ffffff",buttonBackgroundHovered:"#f5f5f5",buttonBackgroundPressed:"#e0e0e0",buttonBorder:"#e1dfdd",bodyStandoutBackground:"#c4c4c4",buttonText:"#242424",buttonTextDisabled:"#616161",primaryButtonText:"#ffffff",disabledText:"#bdbdbd",disabledBodyText:"#605e5c",errorText:"#a80000",accentButtonText:"#185abd",accentButtonBackground:"#d2e0f4",bodyDivider:"#c7e0f4",focusBorder:"#242424",variantBorder:"#bdbdbd",infoIcon:"#185abd",successBackground:"#d2e0f4",successIcon:"#185ABD",menuDivider:"#e0e0e0",warningBackground:"#d4edd4",warningIcon:"#094609",errorBackground:"#fde5e5",errorIcon:"#3f1011",buttonTextChecked:"#185ABD",buttonBackgroundChecked:"#d2e0f4",buttonTextCheckedHovered:"#185ABD",buttonBackgroundCheckedHovered:"#d2e0f4",actionLink:"#185ABD",actionLinkHovered:"#185ABD",linkHovered:"#185ABD",bodySubtext:"#616161",bodyBackground:"#f5f5f5",cardStandoutBackground:"#ebf3fc",infoBackground:"#F0F0F0",listItemBackgroundHovered:"#f3f2f1",inputBackground:"F5F5F5",primaryButtonBackground:"#185ABD",primaryButtonBackgroundHovered:"#1651AA",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#616161",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#f5f5f5",white:"#ffffff"}}),G=(0,H.a)({semanticColors:{cardShadow:"none",cardShadowHovered:"none",buttonBackground:"#292929",buttonBackgroundHovered:"#3d3d3d",buttonBackgroundPressed:"#1f1f1f",buttonBorder:"#3d3d3d",bodyStandoutBackground:"default",buttonText:"#ffffff",buttonTextDisabled:"#ADADAD",primaryButtonText:"#ffffff",disabledText:"#ADADAD",disabledBodyText:"#d6d6d6",errorText:"#f1707b",accentButtonText:"#82ABF1",accentButtonBackground:"#0c2145",bodyDivider:"#598fec",focusBorder:"#ffffff",variantBorder:"#5c5c5c",infoIcon:"#82ABF1",successBackground:"#071225",successIcon:"#82ABF1",menuDivider:"#666666",warningBackground:"#094609",warningIcon:"#d4edd4",errorBackground:"#3f1011",errorIcon:"#fde5e5",buttonTextChecked:"#82ABF1",buttonBackgroundChecked:"#0c2145",buttonTextCheckedHovered:"#82ABF1",buttonBackgroundCheckedHovered:"#0c2145",actionLink:"#82ABF1",actionLinkHovered:"#82ABF1",linkHovered:"#82ABF1",bodySubtext:"#adadad",bodyBackground:"#141414",cardStandoutBackground:"#3d3d3d",infoBackground:"#292929",listItemBackgroundHovered:"#1651AA",inputBackground:"#141414",primaryButtonBackground:"#1651AA",primaryButtonBackgroundHovered:"#185ABD",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#82abf1",themeTertiary:"#82abf1",themeLight:"#0c2145",themeLighter:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#adadad",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#1f1f1f",neutralLighter:"#3d3d3d",neutralLighterAlt:"#292929",white:"#141414"},isInverted:!0});var Q;let K;function $(){return null!=K?K:K=(0,M.observable)({theme:V})}!function(e){e.Light="Light",e.Dark="Dark"}(Q||(Q={}));const Z=(0,M.action)((e=>{$().theme=e===Q.Dark?G:V}));(0,M.action)((e=>{$().theme=e}));var J=n(59901);const Y={[g.SV.light]:{editorTagResting:"#201F1E",editorAltTextResting:"#605E5C",editorGrammarTextResting:"#3355FF",editorGrammarTextHover:"#3355FF",editorRefinementTextResting:"#5A4EBC",editorRefinementTextHover:"#5A4EBC",editorRewriteTextResting:"#5A4EBC",editorRewriteTextHover:"#5A4EBC",editorPrimaryButtonBackgroundResting:"#2E6AC5",editorPrimaryButtonBackgroundHover:"#1651AA",editorPrimaryButtonBackgroundPressed:"#0E336A",editorPrimaryButtonBackgroundDisabled:"#F3F2F1",editorPrimaryButtonTextResting:"#FFFFFF",editorPrimaryButtonTextDisabled:"#A19F9D",editorHeader:"#3B3A39",editorSubheader:"#605E5C",editorDialogText:"#323130",editorIconText:"#201F1E",editorContextText:"#201F1E",editorErrorText:"red",editorBorder:"#201F1E",editorSeparator:"#E6E6E6",editorFocusRing:"#969696",editorAddOnFooterBackground:J.L.colorBrandBackground2,editorAddOnFooterMessage:"#11100F",editorAddOnHeaderBackground:"#ebf3fc",editorPremiumEmphasis:J.L.colorBrandForeground1,editorAddOnAction:"#2E6AC5",editorEditorIcon:"#185ABD",editorAccessibilityIcon:"#185ABD",editorCorrectionHighlight:"#D4EDD4",editorHelpLinkTextResting:"#1651AA",editorHelpLinkTextHover:"#13458F",editorHelpLinkTextFocused:"#1651AA",editorHelpLinkTextPressed:"#0E336A",editorHelpLinkFocusRing:"#323130",editorBadgeBackground:J.L.colorBrandForeground1,editorBadgeText:"#FFFFFF",editorTonalFreCardIconPrimaryColor:J.L.colorBrandForeground1,editorTonalFreCardIconSecondaryColor:J.L.colorBrandBackground2},[g.SV.dark]:{editorTagResting:c.gray90,editorAltTextResting:c.gray90,editorGrammarTextResting:"#99AAF5",editorGrammarTextHover:"#99AAF5",editorRefinementTextResting:"#ADA2F2",editorRefinementTextHover:"#ADA2F2",editorRewriteTextResting:"#ADA2F2",editorRewriteTextHover:"#ADA2F2",editorHeader:c.gray60,editorSubheader:c.gray90,editorDialogText:c.gray90,editorIconText:c.gray90,editorContextText:c.gray90,editorErrorText:"red",editorBorder:c.gray200,editorSeparator:c.gray140,editorFocusRing:c.gray60,editorAddOnFooterBackground:"#092C47",editorAddOnFooterMessage:c.gray10,editorAddOnHeaderBackground:"#0c2145",editorPremiumEmphasis:"#598FEC",editorAddOnAction:"#598FEC",editorEditorIcon:"#598FEC",editorAccessibilityIcon:"#095E09",editorCorrectionHighlight:"#095E09",editorHelpLinkTextResting:"#3D7CE8",editorHelpLinkTextHover:"#598FEC",editorHelpLinkTextFocused:"#598FEC",editorHelpLinkTextPressed:c.gray120,editorHelpLinkFocusRing:c.gray60,editorBadgeBackground:"#296FE6",editorBadgeText:"#FFFFFF"},[g.SV.highContrast]:{editorTagResting:c.gray90,editorAltTextResting:c.gray90,editorGrammarTextResting:J.L.colorNeutralForeground1,editorGrammarTextHover:J.L.colorNeutralForeground1Hover,editorRefinementTextResting:J.L.colorNeutralForeground1,editorRefinementTextHover:J.L.colorNeutralForeground1Hover,editorRewriteTextResting:J.L.colorNeutralForeground1,editorRewriteTextHover:J.L.colorNeutralForeground1Hover,editorHeader:c.gray60,editorSubheader:c.gray90,editorDialogText:c.gray90,editorIconText:c.gray90,editorContextText:c.gray90,editorErrorText:"red",editorBorder:c.gray200,editorSeparator:c.gray140,editorFocusRing:c.gray60,editorAddOnFooterBackground:J.L.colorBrandBackground2,editorAddOnFooterMessage:c.gray10,editorAddOnHeaderBackground:"#0c2145",editorPremiumEmphasis:J.L.colorBrandForeground1,editorAddOnAction:"#598FEC",editorEditorIcon:"#598FEC",editorAccessibilityIcon:"#095E09",editorCorrectionHighlight:"#095E09",editorHelpLinkTextResting:"#3D7CE8",editorHelpLinkTextHover:"#598FEC",editorHelpLinkTextFocused:"#598FEC",editorHelpLinkTextPressed:c.gray120,editorHelpLinkFocusRing:c.gray60,editorBadgeBackground:"#296FE6",editorBadgeText:"#FFFFFF",editorTonalFreCardIconPrimaryColor:J.L.colorBrandForeground1,editorTonalFreCardIconSecondaryColor:J.L.colorBrandBackground2}},X={[g.SV.light]:{editorActionButtonForegroundResting:J.L.colorBrandForeground2,editorActionButtonForegroundHover:J.L.colorBrandForeground2Hover,editorActionButtonForegroundPressed:J.L.colorBrandForeground2Pressed,editorActionButtonForegroundDisabled:J.L.colorNeutralForegroundDisabled,editorShimmerColor:"#F3F2F1",editorShimmerWaveColor:"#EDEBE9",editorScrollThumbColor:"#bdbdbd",editorSearchBoxBorderColorResting:"#D1D1D1",editorSearchBoxBorderColorHover:"#D1D1D1",editorSearchBoxBorderBottomColor:"#464FEB",editorSearchBoxIconColor:"#424242",editorTagBackground:"#EBF3FC",editorTagTextColor:"#0F6CBD",editorMeetingBannerBackgroundColor:"#FAF9F8",editorMeetingBannerText:"#424242",editorMeetingBannerIconPrimaryColor:"#616161",editorMeetingBannerBorderColor:"#d1d1d1"},[g.SV.dark]:{editorActionButtonForegroundResting:J.L.colorBrandForeground2,editorActionButtonForegroundHover:J.L.colorBrandForeground2Hover,editorActionButtonForegroundPressed:J.L.colorBrandForeground2Pressed,editorActionButtonForegroundDisabled:J.L.colorNeutralForegroundDisabled,editorShimmerColor:"#3D3D3D",editorShimmerWaveColor:"#474747",editorScrollThumbColor:"#707070",editorTagBackground:"#082338",editorTagTextColor:"#62ABF5",editorMeetingBannerBackgroundColor:"#141414",editorMeetingBannerText:"#ffffff",editorMeetingBannerIconPrimaryColor:"#adadad",editorMeetingBannerBorderColor:"#666666"},[g.SV.highContrast]:{editorNoSuggestionsTextColorResting:J.L.colorNeutralForeground2,editorNoSuggestionsTextColorHover:J.L.colorNeutralForeground2BrandHover,editorActionButtonForegroundResting:J.L.colorBrandForeground2,editorActionButtonForegroundHover:J.L.colorNeutralForeground2BrandHover,editorActionButtonForegroundPressed:J.L.colorNeutralForeground2BrandPressed,editorActionButtonForegroundDisabled:J.L.colorNeutralForegroundDisabled,editorShimmerColor:"#3D3D3D",editorShimmerWaveColor:"#474747",editorScrollThumbColor:"#707070",editorTagBackground:"#082338",editorTagTextColor:"#62ABF5",editorMeetingBannerBackgroundColor:"#141414",editorMeetingBannerText:"#ffffff",editorMeetingBannerIconPrimaryColor:"#adadad",editorMeetingBannerBorderColor:"#666666"}},ee={[g.SV.light]:{editorTextBrandingTextColor:J.L.colorNeutralForeground2,editorIconBrandingIconColor:J.L.colorNeutralForeground2,editorIconButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconButtonBrandingIconResting:J.L.colorNeutralForeground2,editorIconButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconButtonBrandingFocusRing:J.L.colorStrokeFocus2,editorIconAndTextButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconAndTextButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconAndTextButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconAndTextButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconAndTextButtonBrandingIconResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingTitleResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingTitleDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingFocusRing:J.L.colorStrokeFocus2},[g.SV.dark]:{editorTextBrandingTextColor:J.L.colorNeutralForeground2,editorIconBrandingIconColor:J.L.colorNeutralForeground2,editorIconButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconButtonBrandingIconResting:J.L.colorNeutralForeground2,editorIconButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconButtonBrandingFocusRing:J.L.colorStrokeFocus2,editorIconAndTextButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconAndTextButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconAndTextButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconAndTextButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconAndTextButtonBrandingIconResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingTitleResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingTitleDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingFocusRing:J.L.colorStrokeFocus2},[g.SV.highContrast]:{editorTextBrandingTextColor:J.L.colorNeutralForeground2,editorIconBrandingIconColor:J.L.colorNeutralForeground2,editorIconButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconButtonBrandingIconResting:J.L.colorNeutralForeground2,editorIconButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconButtonBrandingFocusRing:J.L.colorStrokeFocus2,editorIconAndTextButtonBrandingBackgroundResting:J.L.colorNeutralBackground1,editorIconAndTextButtonBrandingBackgroundHover:J.L.colorNeutralBackground1Hover,editorIconAndTextButtonBrandingBackgroundPressed:J.L.colorNeutralBackground1Pressed,editorIconAndTextButtonBrandingBackgroundDisabled:J.L.colorTransparentBackground,editorIconAndTextButtonBrandingIconResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingIconDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingTitleResting:J.L.colorBrandForeground1,editorIconAndTextButtonBrandingTitleDisabled:J.L.colorNeutralForegroundDisabled,editorIconAndTextButtonBrandingFocusRing:J.L.colorStrokeFocus2}};var te=n(19432),ne=n(44680),ie=n(90424),re=n(60970),oe=n(68916),ae=n(75435),se=n(51815),le=n(36934);const ue=se.TQ.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),i={[`colorPalette${n}Background1`]:ae.mY,[`colorPalette${n}Background2`]:ae.mY,[`colorPalette${n}Background3`]:ae.Fn,[`colorPalette${n}Foreground1`]:ae.Fn,[`colorPalette${n}Foreground2`]:ae.Fn,[`colorPalette${n}Foreground3`]:ae.Fn,[`colorPalette${n}BorderActive`]:ae.Si,[`colorPalette${n}Border1`]:ae.Fn,[`colorPalette${n}Border2`]:ae.Fn};return Object.assign(e,i)}),{});ue.colorPaletteRedForegroundInverted=ae.Fn,ue.colorPaletteGreenForegroundInverted=ae.Fn,ue.colorPaletteYellowForegroundInverted=ae.Fn;const de=se.dt.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),i={[`colorPalette${n}Background2`]:ae.mY,[`colorPalette${n}Foreground2`]:ae.Fn,[`colorPalette${n}BorderActive`]:ae.Si};return Object.assign(e,i)}),{}),ce={...ue,...de},he=Object.entries(le.s).reduce(((e,[t,n])=>{const i=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorStatus${i}Background1`]:ae.mY,[`colorStatus${i}Background2`]:ae.mY,[`colorStatus${i}Background3`]:ae.Fn,[`colorStatus${i}Foreground1`]:ae.Fn,[`colorStatus${i}Foreground2`]:ae.Fn,[`colorStatus${i}Foreground3`]:ae.Fn,[`colorStatus${i}BorderActive`]:ae.Si,[`colorStatus${i}ForegroundInverted`]:ae.Fn,[`colorStatus${i}Border1`]:ae.Fn,[`colorStatus${i}Border2`]:ae.Fn};return Object.assign(e,r)}),{});he.colorStatusDangerBackground3Hover=ae.Si,he.colorStatusDangerBackground3Pressed=ae.Si;var ge=n(61883),pe=n(54661),fe=n(68106),me=n(6388),ve=n(3442),ye=n(30975),_e=n(83601);const be={...pe.aI,fontFamilyBase:'-apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, "Apple Color Emoji", "Segoe UI Emoji", sans-serif'},Ce={...(()=>{const e={colorNeutralForeground1:ae.Fn,colorNeutralForeground1Hover:ae.fo,colorNeutralForeground1Pressed:ae.fo,colorNeutralForeground1Selected:ae.fo,colorNeutralForeground2:ae.Fn,colorNeutralForeground2Hover:ae.fo,colorNeutralForeground2Pressed:ae.fo,colorNeutralForeground2Selected:ae.fo,colorNeutralForeground2BrandHover:ae.fo,colorNeutralForeground2BrandPressed:ae.fo,colorNeutralForeground2BrandSelected:ae.fo,colorNeutralForeground3:ae.Fn,colorNeutralForeground3Hover:ae.fo,colorNeutralForeground3Pressed:ae.fo,colorNeutralForeground3Selected:ae.fo,colorNeutralForeground3BrandHover:ae.fo,colorNeutralForeground3BrandPressed:ae.fo,colorNeutralForeground3BrandSelected:ae.fo,colorNeutralForeground4:ae.Fn,colorNeutralForegroundDisabled:ae.m4,colorNeutralForegroundInvertedDisabled:ae.m4,colorBrandForegroundLink:ae.aJ,colorBrandForegroundLinkHover:ae.aJ,colorBrandForegroundLinkPressed:ae.aJ,colorBrandForegroundLinkSelected:ae.aJ,colorNeutralForeground2Link:ae.aJ,colorNeutralForeground2LinkHover:ae.aJ,colorNeutralForeground2LinkPressed:ae.aJ,colorNeutralForeground2LinkSelected:ae.aJ,colorCompoundBrandForeground1:ae.Si,colorCompoundBrandForeground1Hover:ae.Si,colorCompoundBrandForeground1Pressed:ae.Si,colorBrandForeground1:ae.Fn,colorBrandForeground2:ae.Fn,colorBrandForeground2Hover:ae.Fn,colorBrandForeground2Pressed:ae.Fn,colorNeutralForeground1Static:ae.mY,colorNeutralForegroundStaticInverted:ae.Fn,colorNeutralForegroundInverted:ae.fo,colorNeutralForegroundInvertedHover:ae.fo,colorNeutralForegroundInvertedPressed:ae.fo,colorNeutralForegroundInvertedSelected:ae.fo,colorNeutralForegroundInverted2:ae.Fn,colorNeutralForegroundOnBrand:ae.p1,colorNeutralForegroundInvertedLink:ae.aJ,colorNeutralForegroundInvertedLinkHover:ae.aJ,colorNeutralForegroundInvertedLinkPressed:ae.aJ,colorNeutralForegroundInvertedLinkSelected:ae.aJ,colorBrandForegroundInverted:ae.Fn,colorBrandForegroundInvertedHover:ae.fo,colorBrandForegroundInvertedPressed:ae.fo,colorBrandForegroundOnLight:ae.p1,colorBrandForegroundOnLightHover:ae.fo,colorBrandForegroundOnLightPressed:ae.fo,colorBrandForegroundOnLightSelected:ae.fo,colorNeutralBackground1:ae.mY,colorNeutralBackground1Hover:ae.Si,colorNeutralBackground1Pressed:ae.Si,colorNeutralBackground1Selected:ae.Si,colorNeutralBackground2:ae.mY,colorNeutralBackground2Hover:ae.Si,colorNeutralBackground2Pressed:ae.Si,colorNeutralBackground2Selected:ae.Si,colorNeutralBackground3:ae.mY,colorNeutralBackground3Hover:ae.Si,colorNeutralBackground3Pressed:ae.Si,colorNeutralBackground3Selected:ae.Si,colorNeutralBackground4:ae.mY,colorNeutralBackground4Hover:ae.Si,colorNeutralBackground4Pressed:ae.Si,colorNeutralBackground4Selected:ae.Si,colorNeutralBackground5:ae.mY,colorNeutralBackground5Hover:ae.Si,colorNeutralBackground5Pressed:ae.Si,colorNeutralBackground5Selected:ae.Si,colorNeutralBackground6:ae.mY,colorNeutralBackgroundInverted:ae.mY,colorNeutralBackgroundStatic:ae.mY,colorNeutralBackgroundAlpha:ae.mY,colorNeutralBackgroundAlpha2:ae.mY,colorSubtleBackground:"transparent",colorSubtleBackgroundHover:ae.Si,colorSubtleBackgroundPressed:ae.Si,colorSubtleBackgroundSelected:ae.Si,colorSubtleBackgroundLightAlphaHover:ae.Si,colorSubtleBackgroundLightAlphaPressed:ae.Si,colorSubtleBackgroundLightAlphaSelected:ae.Si,colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:ae.Si,colorSubtleBackgroundInvertedPressed:ae.Si,colorSubtleBackgroundInvertedSelected:ae.Si,colorTransparentBackground:"transparent",colorTransparentBackgroundHover:ae.Si,colorTransparentBackgroundPressed:ae.Si,colorTransparentBackgroundSelected:ae.Si,colorNeutralBackgroundDisabled:ae.mY,colorNeutralBackgroundInvertedDisabled:ae.mY,colorNeutralStencil1:ae.Fn,colorNeutralStencil2:ae.Fn,colorNeutralStencil1Alpha:ae.Fn,colorNeutralStencil2Alpha:ae.Fn,colorBackgroundOverlay:ae.Q1[50],colorScrollbarOverlay:ae.p6,colorBrandBackground:ae.p6,colorBrandBackgroundHover:ae.Si,colorBrandBackgroundPressed:ae.Si,colorBrandBackgroundSelected:ae.Si,colorCompoundBrandBackground:ae.Si,colorCompoundBrandBackgroundHover:ae.Si,colorCompoundBrandBackgroundPressed:ae.Si,colorBrandBackgroundStatic:ae.mY,colorBrandBackground2:ae.mY,colorBrandBackground2Hover:ae.mY,colorBrandBackground2Pressed:ae.mY,colorBrandBackground3Static:ae.mY,colorBrandBackground4Static:ae.mY,colorBrandBackgroundInverted:ae.p6,colorBrandBackgroundInvertedHover:ae.Si,colorBrandBackgroundInvertedPressed:ae.Si,colorBrandBackgroundInvertedSelected:ae.Si,colorNeutralCardBackground:ae.mY,colorNeutralCardBackgroundHover:ae.Si,colorNeutralCardBackgroundPressed:ae.Si,colorNeutralCardBackgroundSelected:ae.Si,colorNeutralCardBackgroundDisabled:ae.mY,colorNeutralStrokeAccessible:ae.Fn,colorNeutralStrokeAccessibleHover:ae.Si,colorNeutralStrokeAccessiblePressed:ae.Si,colorNeutralStrokeAccessibleSelected:ae.Si,colorNeutralStroke1:ae.Fn,colorNeutralStroke1Hover:ae.Si,colorNeutralStroke1Pressed:ae.Si,colorNeutralStroke1Selected:ae.Si,colorNeutralStroke2:ae.Fn,colorNeutralStroke3:ae.Fn,colorNeutralStrokeSubtle:ae.Fn,colorNeutralStrokeOnBrand:ae.mY,colorNeutralStrokeOnBrand2:ae.Fn,colorNeutralStrokeOnBrand2Hover:ae.Fn,colorNeutralStrokeOnBrand2Pressed:ae.Fn,colorNeutralStrokeOnBrand2Selected:ae.Fn,colorBrandStroke1:ae.Fn,colorBrandStroke2:ae.Fn,colorBrandStroke2Hover:ae.Si,colorBrandStroke2Pressed:ae.Si,colorBrandStroke2Contrast:ae.mY,colorCompoundBrandStroke:ae.Si,colorCompoundBrandStrokeHover:ae.Si,colorCompoundBrandStrokePressed:ae.Si,colorNeutralStrokeDisabled:ae.m4,colorNeutralStrokeInvertedDisabled:ae.m4,colorTransparentStroke:ae.Fn,colorTransparentStrokeInteractive:ae.Si,colorTransparentStrokeDisabled:ae.m4,colorNeutralStrokeAlpha:ae.Fn,colorNeutralStrokeAlpha2:ae.mY,colorStrokeFocus1:ae.mY,colorStrokeFocus2:ae.Si,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"};return{...ge.V,...pe.GR,...pe.lm,...pe.aI,...pe.NM,...fe.k,..._e.b,..._e.F,...ve.S,...ye.L,...e,...ce,...he,...(0,me.t)(e.colorNeutralShadowAmbient,e.colorNeutralShadowKey),...(0,me.t)(e.colorBrandShadowAmbient,e.colorBrandShadowKey,"Brand")}})(),...be};var Te=n(62056),Se=n(71122);const Ie={...(0,Te.a)(Se.U1),...be};var we=n(93656);const Ee={...(e=>{const t=(e=>({colorNeutralForeground1:ae.ON,colorNeutralForeground1Hover:ae.ON,colorNeutralForeground1Pressed:ae.ON,colorNeutralForeground1Selected:ae.ON,colorNeutralForeground2:ae.Oh[84],colorNeutralForeground2Hover:ae.ON,colorNeutralForeground2Pressed:ae.ON,colorNeutralForeground2Selected:ae.ON,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:ae.Oh[68],colorNeutralForeground3Hover:ae.Oh[84],colorNeutralForeground3Pressed:ae.Oh[84],colorNeutralForeground3Selected:ae.Oh[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:ae.Oh[60],colorNeutralForegroundDisabled:ae.Oh[36],colorNeutralForegroundInvertedDisabled:ae.c8[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:ae.Oh[84],colorNeutralForeground2LinkHover:ae.ON,colorNeutralForeground2LinkPressed:ae.ON,colorNeutralForeground2LinkSelected:ae.ON,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[120],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:ae.Oh[14],colorNeutralForegroundStaticInverted:ae.ON,colorNeutralForegroundInverted:ae.Oh[14],colorNeutralForegroundInvertedHover:ae.Oh[14],colorNeutralForegroundInvertedPressed:ae.Oh[14],colorNeutralForegroundInvertedSelected:ae.Oh[14],colorNeutralForegroundInverted2:ae.Oh[14],colorNeutralForegroundOnBrand:ae.ON,colorNeutralForegroundInvertedLink:ae.ON,colorNeutralForegroundInvertedLinkHover:ae.ON,colorNeutralForegroundInvertedLinkPressed:ae.ON,colorNeutralForegroundInvertedLinkSelected:ae.ON,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:ae.Oh[16],colorNeutralBackground1Hover:ae.Oh[24],colorNeutralBackground1Pressed:ae.Oh[12],colorNeutralBackground1Selected:ae.Oh[22],colorNeutralBackground2:ae.Oh[14],colorNeutralBackground2Hover:ae.Oh[22],colorNeutralBackground2Pressed:ae.Oh[10],colorNeutralBackground2Selected:ae.Oh[20],colorNeutralBackground3:ae.Oh[12],colorNeutralBackground3Hover:ae.Oh[20],colorNeutralBackground3Pressed:ae.Oh[8],colorNeutralBackground3Selected:ae.Oh[18],colorNeutralBackground4:ae.Oh[8],colorNeutralBackground4Hover:ae.Oh[16],colorNeutralBackground4Pressed:ae.Oh[4],colorNeutralBackground4Selected:ae.Oh[14],colorNeutralBackground5:ae.Oh[4],colorNeutralBackground5Hover:ae.Oh[12],colorNeutralBackground5Pressed:ae.Ql,colorNeutralBackground5Selected:ae.Oh[10],colorNeutralBackground6:ae.Oh[20],colorNeutralBackgroundInverted:ae.ON,colorNeutralBackgroundStatic:ae.Oh[24],colorNeutralBackgroundAlpha:ae.ti[50],colorNeutralBackgroundAlpha2:ae.Z1[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:ae.Oh[22],colorSubtleBackgroundPressed:ae.Oh[18],colorSubtleBackgroundSelected:ae.Oh[20],colorSubtleBackgroundLightAlphaHover:ae.Xv[80],colorSubtleBackgroundLightAlphaPressed:ae.Xv[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:ae.Q1[10],colorSubtleBackgroundInvertedPressed:ae.Q1[30],colorSubtleBackgroundInvertedSelected:ae.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:ae.Oh[8],colorNeutralBackgroundInvertedDisabled:ae.c8[10],colorNeutralStencil1:ae.Oh[34],colorNeutralStencil2:ae.Oh[20],colorNeutralStencil1Alpha:ae.c8[10],colorNeutralStencil2Alpha:ae.c8[5],colorBackgroundOverlay:ae.Q1[50],colorScrollbarOverlay:ae.c8[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:ae.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:ae.Oh[20],colorNeutralCardBackgroundHover:ae.Oh[24],colorNeutralCardBackgroundPressed:ae.Oh[18],colorNeutralCardBackgroundSelected:ae.Oh[22],colorNeutralCardBackgroundDisabled:ae.Oh[8],colorNeutralStrokeAccessible:ae.Oh[68],colorNeutralStrokeAccessibleHover:ae.Oh[74],colorNeutralStrokeAccessiblePressed:ae.Oh[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:ae.Oh[40],colorNeutralStroke1Hover:ae.Oh[46],colorNeutralStroke1Pressed:ae.Oh[42],colorNeutralStroke1Selected:ae.Oh[44],colorNeutralStroke2:ae.Oh[32],colorNeutralStroke3:ae.Oh[24],colorNeutralStrokeSubtle:ae.Oh[4],colorNeutralStrokeOnBrand:ae.Oh[16],colorNeutralStrokeOnBrand2:ae.ON,colorNeutralStrokeOnBrand2Hover:ae.ON,colorNeutralStrokeOnBrand2Pressed:ae.ON,colorNeutralStrokeOnBrand2Selected:ae.ON,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[90],colorCompoundBrandStrokeHover:e[100],colorCompoundBrandStrokePressed:e[80],colorNeutralStrokeDisabled:ae.Oh[26],colorNeutralStrokeInvertedDisabled:ae.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:ae.c8[10],colorNeutralStrokeAlpha2:ae.c8[20],colorStrokeFocus1:ae.Ql,colorStrokeFocus2:ae.ON,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...ge.V,...pe.GR,...pe.lm,...pe.aI,...pe.NM,...fe.k,..._e.b,..._e.F,...ve.S,...ye.L,...t,...we.h,...we.m,...(0,me.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,me.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})(Se.U1),...be};let xe=class extends te.z{constructor(e){super(),this.hostSettings=e,this._defaultTheme=i.light,this._currentTheme=i.light,this._themes=new Map,this._fluentThemes=new Map,this._isDarkMode=void 0,this._useFluentV9=void 0,(0,j.Gn)(this),this._isDarkMode=this.hostSettings.isDarkMode,this._currentTheme=this.hostSettings.isDarkMode?i.dark:i.light,this._currentTheme===i.dark?Z(Q.Dark):Z(Q.Light),this._useFluentV9=this.hostSettings.useFluentV9}get isDarkMode(){return this._isDarkMode}get defaultTheme(){return this._defaultTheme}get currentTheme(){return this._currentTheme}get components(){return Array.from(this._themes.keys())}getFluentActiveTheme(){let e={};if(!this._fluentThemes.get(this._currentTheme))switch(this._currentTheme){case i.light:e=re.o;break;case i.dark:e=oe.C;break;case i.highContrast:e=Ce}const t=this._currentTheme===i.light?0:this._currentTheme===i.dark?1:this._currentTheme===i.highContrast?2:0,n=Object.assign(Object.assign(Object.assign({},Y[t]),X[t]),ee[t]);return Object.assign(Object.assign({},e),n)}getComponentActiveTheme(e,t=!1){var n;if(this._useFluentV9&&!t)return;const i=this._themes.get(e),r=U(null==i?void 0:i.get(this._currentTheme)),o=U(null==i?void 0:i.get(this._defaultTheme));return null!==(n=null!=r?r:o)&&void 0!==n?n:void 0}getComponentThemes(e){const t=this._themes.get(e);return t&&q(t)}updateDarkMode(e){this._isDarkMode=e,this.hostSettings.isDarkMode=e,this._currentTheme=e?i.dark:i.light,Z(e?Q.Dark:Q.Light),this.publishEvent("currentThemeUpdated",this._currentTheme)}updateDefaultTheme(e){this._defaultTheme=e,this.publishEvent("defaultThemeUpdated",this._defaultTheme)}updateCurrentTheme(e){this._currentTheme=e,e===i.dark?Z(Q.Dark):Z(Q.Light),this.publishEvent("currentThemeUpdated",this._currentTheme)}updateComponentThemes(e,t){this._themes.set(e,q(t)),this.publishEvent("themesUpdated",{})}updateFluentThemes(e){this._fluentThemes.clear();for(const[t,n]of e)this._fluentThemes.set(t,n);this.publishEvent("fluentThemesUpdated",{})}getExpandedEccFluentTheme(){switch(this._currentTheme){case i.light:default:return Ie;case i.dark:return Ee}}};(0,L.__decorate)([M.observable],xe.prototype,"_defaultTheme",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_currentTheme",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_themes",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_fluentThemes",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_isDarkMode",void 0),(0,L.__decorate)([M.observable],xe.prototype,"_useFluentV9",void 0),(0,L.__decorate)([M.computed],xe.prototype,"isDarkMode",null),(0,L.__decorate)([M.computed],xe.prototype,"defaultTheme",null),(0,L.__decorate)([M.computed],xe.prototype,"currentTheme",null),(0,L.__decorate)([M.computed],xe.prototype,"components",null),(0,L.__decorate)([M.action],xe.prototype,"updateDarkMode",null),(0,L.__decorate)([M.action],xe.prototype,"updateDefaultTheme",null),(0,L.__decorate)([M.action],xe.prototype,"updateCurrentTheme",null),(0,L.__decorate)([M.action],xe.prototype,"updateComponentThemes",null),(0,L.__decorate)([M.action],xe.prototype,"updateFluentThemes",null),xe=(0,L.__decorate)([(0,W._)(),(0,L.__param)(0,(0,ie.W)(ne.n))],xe);var Ae=n(16971)},17875:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});var i=n(30915);function r(e,t,n){void 0===n&&(n=!0);var r=!1;if(e&&t)if(n)if(e===t)r=!0;else for(r=!1;t;){var o=(0,i.P)(t);if(o===e){r=!0;break}t=o}else e.contains&&(r=e.contains(t));return r}},97951:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var i=n(30915);function r(e,t,n){return null!=n||(n=document),!e||e===n.body||e instanceof Document?null:t(e)?e:r((0,i.P)(e),t)}},30915:(e,t,n)=>{"use strict";function i(e,t){var n,i;if(void 0===t&&(t=!0),!e)return null;var r=t&&function(e){var t,n;return e&&(n=e)&&n._virtual&&(t=e._virtual.parent),t}(e);return r||("function"!=typeof e.assignedElements&&(null===(n=e.assignedSlot)||void 0===n?void 0:n.parentNode)?e.assignedSlot:11===(null===(i=e.parentNode)||void 0===i?void 0:i.nodeType)?e.parentNode.host:e.parentNode)}n.d(t,{P:()=>i})},79970:(e,t,n)=>{"use strict";n.d(t,{V:()=>r,r:()=>i});var i="data-portal-element";function r(e){e.setAttribute(i,"true")}},80072:(e,t,n)=>{"use strict";n.d(t,{T:()=>o});var i=n(30206),r=n(31860);function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e&&1===e.length&&e[0]&&!e[0].subComponentStyles&&!(0,r.db)(e[0]))return e[0];for(var n={},a={},s=0,l=e;s<l.length;s++){var u=l[s];if(u&&!(0,r.db)(u))for(var d in u)if(u.hasOwnProperty(d)){if("subComponentStyles"===d&&void 0!==u.subComponentStyles){var c=u.subComponentStyles;for(var h in c)c.hasOwnProperty(h)&&(a.hasOwnProperty(h)?a[h].push(c[h]):a[h]=[c[h]]);continue}var g=n[d],p=u[d];n[d]=void 0===g?p:(0,i.__spreadArray)((0,i.__spreadArray)([],Array.isArray(g)?g:[g],!0),Array.isArray(p)?p:[p],!0)}}if(Object.keys(a).length>0){n.subComponentStyles={};var f=n.subComponentStyles,m=function(e){if(a.hasOwnProperty(e)){var t=a[e];f[e]=function(e){return o.apply(void 0,t.map((function(t){return"function"==typeof t?t(e):t})))}}};for(var h in a)m(h)}return n}},17596:(e,t,n)=>{"use strict";n.d(t,{p:()=>r});var i=n(80072);function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=[],o=0,a=t;o<a.length;o++){var s=a[o];s&&r.push("function"==typeof s?s(e):s)}return 1===r.length?r[0]:r.length?i.T.apply(void 0,r):{}}},76437:(e,t,n)=>{"use strict";n.d(t,{i:()=>a});var i=n(38106),r=n(83702),o=n(30006);function a(e){var t=r.nr.getInstance(),n=[];for(var a in e)e.hasOwnProperty(a)&&n.push(a,"{",(0,o.bz)((0,i.Iy)(),e[a]),"}");var s=n.join(""),l=t.classNameFromKey(s);if(l)return l;var u=t.getClassName();return t.insertRule("@keyframes ".concat(u,"{").concat(s,"}"),!0),t.cacheClassName(u,s,[],["keyframes",s]),u}},68678:(e,t,n)=>{"use strict";n.d(t,{L:()=>c,l:()=>d});var i=n(30206),r=n(80072),o=n(16288),a=n(38106),s=n(30006),l=n(31860),u=n(83702);function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return c(e,(0,a.Iy)())}function c(e,t){var n,a={subComponentStyles:{}},d=void 0;(0,l.db)(e[0])?(d=e[0],n=e[1]):n=e[0],null!=d||(d=null==t?void 0:t.shadowConfig);var c=(0,i.__assign)((0,i.__assign)({},t),{shadowConfig:d});if(!n&&e.length<=1)return{subComponentStyles:{}};var h=u.nr.getInstance(d);c.stylesheet=h;var g=r.T.apply(void 0,e),p=[];for(var f in g)if(g.hasOwnProperty(f)){if("subComponentStyles"===f){a.subComponentStyles=g.subComponentStyles||{};continue}if("__shadowConfig__"===f)continue;var m=g[f],v=(0,o.h)(h,m),y=v.classes,_=v.objects;(null==_?void 0:_.length)?(T=(0,s.GJ)(c||{},{displayName:f},_))&&(p.push(T),a[f]=y.concat([T.className]).join(" ")):a[f]=y.join(" ")}for(var b=0,C=p;b<C.length;b++){var T;(T=C[b])&&(0,s.Ae)(T,null==t?void 0:t.specificityMultiplier,d)}return a}},83758:(e,t,n)=>{"use strict";n.d(t,{Y:()=>o});var i=n(47161),r=n(95734);function o(){var e=r.useRef();return e.current||(e.current=new i.j),r.useEffect((function(){return function(){var t;null===(t=e.current)||void 0===t||t.dispose(),e.current=void 0}}),[]),e.current}},54465:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});var i=n(95734);function r(e){var t=i.useRef();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}},28482:(e,t,n)=>{"use strict";n.d(t,{a:()=>o});var i=n(30206),r=n(95734);function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.useCallback((function(t){n.current=t;for(var i=0,r=e;i<r.length;i++){var o=r[i];"function"==typeof o?o(t):o&&(o.current=t)}}),(0,i.__spreadArray)([],e,!0));return n}},52053:(e,t,n)=>{"use strict";n.d(t,{x:()=>o});var i=n(6657),r=n(95734);function o(e,t,n,o){var a=r.useRef(n);a.current=n,r.useEffect((function(){var n=e&&"current"in e?e.current:e;if(n&&n.addEventListener)return(0,i.on)(n,t,(function(e){return a.current(e)}),o)}),[e,t,o])}},91449:(e,t,n)=>{"use strict";n.d(t,{P:()=>a});var i=n(98675),r=n(95734),o=n(18465);function a(e,t){var n,a,s,l=r.useRef(),u=r.useRef(null),d=(0,o.ox)();if(!e||e!==l.current||"string"==typeof e){var c=null==t?void 0:t.current;if(e)if("string"==typeof e)if(null===(n=null==c?void 0:c.getRootNode())||void 0===n?void 0:n.host)u.current=null!==(s=null===(a=null==c?void 0:c.getRootNode())||void 0===a?void 0:a.querySelector(e))&&void 0!==s?s:null;else{var h=(0,i.Y)(c);u.current=h?h.querySelector(e):null}else u.current="stopPropagation"in e||"getBoundingClientRect"in e?e:"current"in e?e.current:e;l.current=e}return[u,d]}},17954:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});var i=n(95734),r=function(e){var t=i.useRef(e);t.current=e,i.useEffect((function(){return function(){var e;null===(e=t.current)||void 0===e||e.call(t)}}),[])}},74074:(e,t,n)=>{"use strict";n.d(t,{Y:()=>d,FD:()=>c});var i=n(23297);function r(e){return Boolean(null==e?void 0:e.hasOwnProperty(i.o))}var o=n(95734);function a(e,t){return function(n,o,a,s,l){return r(o)?t(function(e,t){return{...t,[i.o]:e}}(n,o),null,a,s,l):r(n)?t(n,o,a,s,l):e(n,o,a,s,l)}}function s(e){const{as:t,[i.o]:n,[i.Y]:r,...o}=e,a=o,s="string"==typeof n&&null!=t?t:n;return"string"!=typeof s&&t&&(a.as=t),{elementType:s,props:a,renderFunction:r}}n(1185);var l=n(86886);const u=n.t(l,2),d=a(u.jsx,((e,t,n)=>{const{elementType:i,renderFunction:r,props:a}=s(e),l={...a,...t};return r?u.jsx(o.Fragment,{children:r(i,l)},n):u.jsx(i,l,n)})),c=a(u.jsxs,((e,t,n)=>{const{elementType:i,renderFunction:r,props:a}=s(e),l={...a,...t};return r?u.jsx(o.Fragment,{children:r(i,{...l,children:u.jsxs(o.Fragment,{children:l.children},void 0)})},n):u.jsxs(i,l,n)}))},7044:(e,t,n)=>{"use strict";n.d(t,{q:()=>O});var i=n(95734),r=n.t(i,2),o=n(74074),a=n(64671),s=n(10723),l=n(27737),u=n(71057);const d=i.createContext(void 0),c=d.Provider;var h=n(75901),g=n(19821);const p=i.createContext(void 0).Provider,f=i.createContext(void 0),m=f.Provider;var v=n(6313),y=n(48427),_=n(17190),b=n(39366),C=n(35333),T=n(89693),S=n(44877),I=n(51507),w=n(29308),E=n(29944);const x="fui-FluentProvider",A=(0,w.X)({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),D=r.useInsertionEffect?r.useInsertionEffect:S.E,N={},F={},P=(e,t)=>{const n=(0,u.Y)(),r=i.useContext(d),o=null!==(a=i.useContext(f))&&void 0!==a?a:{};var a;const s=i.useContext(g.k7)||N,{applyStylesToPortals:l=!0,customStyleHooks_unstable:c,dir:h=n.dir,targetDocument:p=n.targetDocument,theme:m,overrides_unstable:v={}}=e,S=k(r,m),w=k(o,v),E=k(s,c),A=(0,y.J)();var P;const{styleTagId:O,rule:B}=(e=>{const{targetDocument:t,theme:n,rendererAttributes:r}=e,o=i.useRef(),a=(0,I.Bi)(x),s=r,l=i.useMemo((()=>function(e,t){return t?`${e} { ${Object.keys(t).reduce(((e,n)=>`${e}--${n}: ${t[n]}; `),"")} }`:`${e} {}`}(`.${a}`,n)),[n,a]);return function(e,t){i.useState((()=>{if(!e)return;const n=e.getElementById(t);n&&e.head.append(n)}))}(t,a),D((()=>{const e=null==t?void 0:t.getElementById(a);return e?o.current=e:(o.current=((e,t)=>{if(!e)return;const n=e.createElement("style");return Object.keys(t).forEach((e=>{n.setAttribute(e,t[e])})),e.head.appendChild(n),n})(t,{...s,id:a}),o.current&&((e,t)=>{const n=e.sheet;n&&(n.cssRules.length>0&&n.deleteRule(0),n.insertRule(t,0))})(o.current,l)),()=>{var e;null===(e=o.current)||void 0===e||e.remove()}}),[a,t,l,s]),{styleTagId:a,rule:l}})({theme:S,targetDocument:p,rendererAttributes:null!==(P=A.styleElementAttributes)&&void 0!==P?P:F});return{applyStylesToPortals:l,customStyleHooks_unstable:E,dir:h,targetDocument:p,theme:S,overrides_unstable:w,themeClassName:O,components:{root:"div"},root:b.Gk((0,C.g)("div",{...e,dir:h,ref:(0,T.a)(t,(0,_.Y)({targetDocument:p}))}),{elementType:"div"}),serverStyleProps:{cssRule:B,attributes:{...A.styleElementAttributes,id:O}}}};function k(e,t){return e&&t?{...e,...t}:e||t}const O=i.forwardRef(((e,t)=>{const n=P(e,t);(e=>{const t=(0,y.J)(),n=A({dir:e.dir,renderer:t});e.root.className=(0,E.z)(x,e.themeClassName,n.root,e.root.className)})(n);const r=function(e){const{applyStylesToPortals:t,customStyleHooks_unstable:n,dir:r,root:o,targetDocument:a,theme:s,themeClassName:l,overrides_unstable:u}=e,d=i.useMemo((()=>({dir:r,targetDocument:a})),[r,a]),[c]=i.useState((()=>({}))),h=i.useMemo((()=>({textDirection:r})),[r]);return{customStyleHooks_unstable:n,overrides_unstable:u,provider:d,textDirection:r,iconDirection:h,tooltip:c,theme:s,themeClassName:t?o.className:l}}(n);return((e,t)=>((0,a.C)(e),(0,o.Y)(u.K,{value:t.provider,children:(0,o.Y)(c,{value:t.theme,children:(0,o.Y)(h.I,{value:t.themeClassName,children:(0,o.Y)(g.gH,{value:t.customStyleHooks_unstable,children:(0,o.Y)(p,{value:t.tooltip,children:(0,o.Y)(l.e,{dir:t.textDirection,children:(0,o.Y)(v.F,{value:t.iconDirection,children:(0,o.Y)(m,{value:t.overrides_unstable,children:(0,o.FD)(e.root,{children:[(0,s.S)()?null:(0,o.Y)("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})})))(n,r)}));O.displayName="FluentProvider"},19821:(e,t,n)=>{"use strict";n.d(t,{$e:()=>s,gH:()=>a,k7:()=>r});var i=n(95734);const r=i.createContext(void 0),o=()=>{},a=r.Provider,s=e=>{var t,n;return null!==(n=null===(t=i.useContext(r))||void 0===t?void 0:t[e])&&void 0!==n?n:o}},71057:(e,t,n)=>{"use strict";n.d(t,{K:()=>a,Y:()=>s});var i=n(95734);const r=i.createContext(void 0),o={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},a=r.Provider;function s(){var e;return null!==(e=i.useContext(r))&&void 0!==e?e:o}},75901:(e,t,n)=>{"use strict";n.d(t,{I:()=>a,q:()=>s});var i=n(95734);const r=i.createContext(void 0),o="",a=r.Provider;function s(){var e;return null!==(e=i.useContext(r))&&void 0!==e?e:o}},17190:(e,t,n)=>{"use strict";n.d(t,{Y:()=>d});var i=n(95734),r=n(71057),o=n(54034),a=n(96406);const s="data-fui-focus-visible";function l(e,t){if(u(e))return()=>{};const n={current:void 0},i=(0,a.SQ)(t);function r(e){i.isNavigatingWithKeyboard()&&(0,o.s)(e)&&(n.current=e,e.setAttribute(s,""))}function l(){n.current&&(n.current.removeAttribute(s),n.current=void 0)}i.subscribe((e=>{e||l()}));const d=e=>{l(),r(e.composedPath()[0])},c=t=>{(!t.relatedTarget||(0,o.s)(t.relatedTarget)&&!e.contains(t.relatedTarget))&&l()};return e.addEventListener(a.Oy,d),e.addEventListener("focusout",c),e.focusVisible=!0,e.contains(t.document.activeElement)&&r(t.document.activeElement),()=>{l(),e.removeEventListener(a.Oy,d),e.removeEventListener("focusout",c),delete e.focusVisible,(0,a.bd)(i)}}function u(e){return!!e&&(!!e.focusVisible||u(null==e?void 0:e.parentElement))}function d(e={}){const t=(0,r.Y)(),n=i.useRef(null);var o;const a=null!==(o=e.targetDocument)&&void 0!==o?o:t.targetDocument;return i.useEffect((()=>{if((null==a?void 0:a.defaultView)&&n.current)return l(n.current,a.defaultView)}),[n,a]),n}},64671:(e,t,n)=>{"use strict";function i(e){}n.d(t,{C:()=>i}),n(95734)},23297:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i,o:()=>r});const i=Symbol.for("fui.slotRenderFunction"),r=Symbol.for("fui.slotElementType")},35333:(e,t,n)=>{"use strict";n.d(t,{g:()=>v}),n(95734);const i=(...e)=>{const t={};for(const n of e){const e=Array.isArray(n)?n:Object.keys(n);for(const n of e)t[n]=1}return t},r=i(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),o=i(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),a=i(["itemID","itemProp","itemRef","itemScope","itemType"]),s=i(o,r,a),l=i(s,["form"]),u=i(s,["height","loop","muted","preload","src","width"]),d=i(u,["poster"]),c=i(s,["start"]),h=i(s,["value"]),g=i(s,["download","href","hrefLang","media","rel","target","type"]),p=i(s,["dateTime"]),f=i(s,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),m={label:l,audio:u,video:d,ol:c,li:h,a:g,button:f,input:i(f,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:i(f,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:i(f,["form","multiple","required"]),option:i(s,["selected","value"]),table:i(s,["cellPadding","cellSpacing"]),tr:s,th:i(s,["colSpan","rowSpan","scope"]),td:i(s,["colSpan","headers","rowSpan","scope"]),colGroup:i(s,["span"]),col:i(s,["span"]),fieldset:i(s,["disabled","form"]),form:i(s,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:i(s,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:i(s,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:p,dialog:i(s,["open","onCancel","onClose"])};const v=(e,t,n)=>{var i;return function(e,t,n){const i=e&&m[e]||s;return i.as=1,function(e,t,n){const i=Array.isArray(t),r={},o=Object.keys(e);for(const a of o)!(!i&&t[a]||i&&t.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(a))||(r[a]=e[a]);return r}(t,i,n)}(null!==(i=t.as)&&void 0!==i?i:e,t,n)}},39366:(e,t,n)=>{"use strict";n.d(t,{Gk:()=>o,lq:()=>a});var i=n(95734),r=n(23297);function o(e,t){const{defaultProps:n,elementType:o}=t,a=function(e){return"string"==typeof e||"number"==typeof e||Array.isArray(e)||i.isValidElement(e)?{children:e}:e}(e),s={...n,...a,[r.o]:o};return a&&"function"==typeof a.children&&(s[r.Y]=a.children,s.children=null==n?void 0:n.children),s}function a(e,t){if(null!==e&&(void 0!==e||t.renderByDefault))return o(e,t)}},51507:(e,t,n)=>{"use strict";n.d(t,{Bi:()=>l});var i=n(95734),r=n.t(i,2);const o={current:0},a=i.createContext(void 0);const s=i.createContext(void 0);function l(e="fui-",t){const n=null!==(d=i.useContext(a))&&void 0!==d?d:o,l=i.useContext(s)||"",u=r.useId;var d;if(u){const n=u(),r=i.useMemo((()=>n.replace(/:/g,"")),[n]);return t||`${l}${e}${r}`}return i.useMemo((()=>t||`${l}${e}${++n.current}`),[l,e,t,n])}s.Provider},44877:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});var i=n(95734);const r=(0,n(10723).S)()?i.useLayoutEffect:i.useEffect},89693:(e,t,n)=>{"use strict";n.d(t,{a:()=>r});var i=n(95734);function r(...e){const t=i.useCallback((n=>{t.current=n;for(const t of e)"function"==typeof t?t(n):t&&(t.current=n)}),[...e]);return t}},10723:(e,t,n)=>{"use strict";function i(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}n.d(t,{S:()=>i})},54034:(e,t,n)=>{"use strict";function i(e,t){var n;const i=e;var r;return Boolean((null==i||null===(n=i.ownerDocument)||void 0===n?void 0:n.defaultView)&&i instanceof i.ownerDocument.defaultView[null!==(r=null==t?void 0:t.constructorName)&&void 0!==r?r:"HTMLElement"])}n.d(t,{s:()=>i})},63503:(e,t,n)=>{"use strict";n.d(t,{IF:()=>a,ZY:()=>o});var i=n(95734),r=i.createContext({window:"object"==typeof window?window:void 0}),o=function(){var e;return null===(e=i.useContext(r).window)||void 0===e?void 0:e.document},a=function(e){return i.createElement(r.Provider,{value:e},e.children)}},18465:(e,t,n)=>{"use strict";n.d(t,{ZY:()=>a,_0:()=>r,ox:()=>o});var i=n(95734),r=i.createContext({window:"object"==typeof window?window:void 0}),o=function(){return i.useContext(r).window},a=function(){var e;return null===(e=i.useContext(r).window)||void 0===e?void 0:e.document}},10056:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var i={topLeftEdge:0,topCenter:1,topRightEdge:2,topAutoEdge:3,bottomLeftEdge:4,bottomCenter:5,bottomRightEdge:6,bottomAutoEdge:7,leftTopEdge:8,leftCenter:9,leftBottomEdge:10,rightTopEdge:11,rightCenter:12,rightBottomEdge:13}},61483:(e,t,n)=>{"use strict";n.d(t,{P:()=>$e});var i,r=n(30206),o=n(95734),a=n(82330),s=n(10056),l=n(19440),u=n(17875),d=n(6657),c=n(23401),h=n(13668),g=n(63666),p=n(67234),f=n(24607),m=n(58086),v=n(98288),y=n(35240),_=n(11272);function b(e,t,n){return{targetEdge:e,alignmentEdge:t,isAuto:n}}var C=((i={})[s.A.topLeftEdge]=b(y.x.top,y.x.left),i[s.A.topCenter]=b(y.x.top),i[s.A.topRightEdge]=b(y.x.top,y.x.right),i[s.A.topAutoEdge]=b(y.x.top,void 0,!0),i[s.A.bottomLeftEdge]=b(y.x.bottom,y.x.left),i[s.A.bottomCenter]=b(y.x.bottom),i[s.A.bottomRightEdge]=b(y.x.bottom,y.x.right),i[s.A.bottomAutoEdge]=b(y.x.bottom,void 0,!0),i[s.A.leftTopEdge]=b(y.x.left,y.x.top),i[s.A.leftCenter]=b(y.x.left),i[s.A.leftBottomEdge]=b(y.x.left,y.x.bottom),i[s.A.rightTopEdge]=b(y.x.right,y.x.top),i[s.A.rightCenter]=b(y.x.right),i[s.A.rightBottomEdge]=b(y.x.right,y.x.bottom),i);function T(e,t){return!(e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)}function S(e,t){var n=[];return e.top<t.top&&n.push(y.x.top),e.bottom>t.bottom&&n.push(y.x.bottom),e.left<t.left&&n.push(y.x.left),e.right>t.right&&n.push(y.x.right),n}function I(e,t){return e[y.x[t]]}function w(e,t,n){return e[y.x[t]]=n,e}function E(e,t){var n=M(t);return(I(e,n.positiveEdge)+I(e,n.negativeEdge))/2}function x(e,t){return e>0?t:-1*t}function A(e,t){return x(e,I(t,e))}function D(e,t,n){return x(n,I(e,n)-I(t,n))}function N(e,t,n,i){void 0===i&&(i=!0);var r=I(e,t)-n,o=w(e,t,n);return i&&(o=w(e,-1*t,I(e,-1*t)-r)),o}function F(e,t,n,i){return void 0===i&&(i=0),N(e,n,I(t,n)+x(n,i))}function P(e,t,n){return A(n,e)>A(n,t)}function k(e,t){for(var n=0,i=0,r=S(e,t);i<r.length;i++){var o=r[i];n+=Math.pow(D(e,t,o),2)}return n}function O(e,t,n,i){return void 0===i&&(i=200),(n===y.x.bottom||n===y.x.top)&&D(e,t,n)>=i}function B(e,t,n,i){for(var r=0,o=e;r<o.length;r++){var a=o[r],s=void 0;i&&i===-1*a?(s=N(t.elementRectangle,a,I(n,a),!1),t.forcedInBounds=!0):P(s=F(t.elementRectangle,n,a),n,-1*a)||(s=N(s,-1*a,I(n,-1*a),!1),t.forcedInBounds=!0),t.elementRectangle=s}return t}function R(e,t,n){var i=M(t).positiveEdge;return N(e,i,n-(E(e,t)-I(e,i)))}function L(e,t,n,i,r){void 0===i&&(i=0);var o=new _.M(e.left,e.right,e.top,e.bottom),a=n.alignmentEdge,s=n.targetEdge,l=r?s:-1*s;return o=r?F(o,t,s,i):function(e,t,n,i){void 0===i&&(i=0);var r=x(-1*n,i);return N(e,-1*n,I(t,n)+r)}(o,t,s,i),o=a?F(o,t,a):R(o,l,E(t,s))}function M(e){return e===y.x.top||e===y.x.bottom?{positiveEdge:y.x.left,negativeEdge:y.x.right}:{positiveEdge:y.x.top,negativeEdge:y.x.bottom}}function q(e,t,n){return n&&Math.abs(D(e,n,t))>Math.abs(D(e,n,-1*t))?-1*t:t}function U(e,t,n,i,r,o,a,s){var l,u={},d=z(t),c=o?n:-1*n,h=r||M(n).positiveEdge;return a&&!function(e,t,n){return void 0!==n&&I(e,t)===I(n,t)}(e,(l=h,-1*l),i)||(h=q(e,h,i)),u[y.x[c]]=D(e,d,c),u[y.x[h]]=D(e,d,h),s&&(u[y.x[-1*c]]=D(e,d,-1*c),u[y.x[-1*h]]=D(e,d,-1*h)),u}function W(e,t,n){var i=E(t,e),r=E(n,e),o=M(e),a=o.positiveEdge,s=o.negativeEdge;return i<=r?a:s}function j(e,t,n,i,r,o,a,s,l){void 0===o&&(o=!1);var u=L(e,t,i,r,l);return T(u,n)?{elementRectangle:u,targetEdge:i.targetEdge,alignmentEdge:i.alignmentEdge}:function(e,t,n,i,r,o,a,s,l){void 0===r&&(r=!1),void 0===a&&(a=0);var u=i.alignmentEdge,d=i.alignTargetEdge,c={elementRectangle:e,targetEdge:i.targetEdge,alignmentEdge:u};s||l||(c=function(e,t,n,i,r,o,a){void 0===r&&(r=!1),void 0===a&&(a=0);var s=[y.x.left,y.x.right,y.x.bottom,y.x.top];(0,f.jI)()&&(s[0]*=-1,s[1]*=-1);for(var l,u=e,d=i.targetEdge,c=i.alignmentEdge,h=d,g=c,p=0;p<4;p++){if(P(u,n,d))return{elementRectangle:u,targetEdge:d,alignmentEdge:c};if(r&&O(t,n,d,o)){switch(d){case y.x.bottom:u.bottom=n.bottom;break;case y.x.top:u.top=n.top}return{elementRectangle:u,targetEdge:d,alignmentEdge:c,forcedInBounds:!0}}var m=k(u,n);(!l||m<l)&&(l=m,h=d,g=c),s.splice(s.indexOf(d),1),s.length>0&&(s.indexOf(-1*d)>-1?d*=-1:(c=d,d=s.slice(-1)[0]),u=L(e,t,{targetEdge:d,alignmentEdge:c},a))}return{elementRectangle:u=L(e,t,{targetEdge:h,alignmentEdge:g},a),targetEdge:h,alignmentEdge:g}}(e,t,n,i,r,o,a));var h=S(c.elementRectangle,n),g=s?-c.targetEdge:void 0;if(h.length>0)if(d)if(c.alignmentEdge&&h.indexOf(-1*c.alignmentEdge)>-1){var p=function(e,t,n,i){var r=e.alignmentEdge,o=e.targetEdge,a=-1*r;return{elementRectangle:L(e.elementRectangle,t,{targetEdge:o,alignmentEdge:a},n,i),targetEdge:o,alignmentEdge:a}}(c,t,a,l);if(T(p.elementRectangle,n))return p;c=B(S(p.elementRectangle,n),c,n,g)}else c=B(h,c,n,g);else c=B(h,c,n,g);return c}(u,t,n,i,o,a,r,s,l)}function z(e){var t=e.getBoundingClientRect();return new _.M(t.left,t.right,t.top,t.bottom)}function H(e,t,n,i,o,a){void 0===o&&(o=!1);var l=e.gapSpace?e.gapSpace:0,u=function(e,t){var n;if(t){if(t.preventDefault){var i=t;n=new _.M(i.clientX,i.clientX,i.clientY,i.clientY)}else if(t.getBoundingClientRect)n=z(t);else{var r=t,o=r.left||r.x,a=r.top||r.y,s=r.right||o,l=r.bottom||a;n=new _.M(o,s,a,l)}if(!T(n,e))for(var u=0,d=S(n,e);u<d.length;u++){var c=d[u];n[y.x[c]]=e[y.x[c]]}}else n=new _.M(0,0,0,0);return n}(n,e.target),d=function(e,t,n,i,r){return e.isAuto&&(e.alignmentEdge=W(e.targetEdge,t,n)),e.alignTargetEdge=r,e}(function(e,t,n){if(void 0===e&&(e=s.A.bottomAutoEdge),n)return{alignmentEdge:n.alignmentEdge,isAuto:n.isAuto,targetEdge:n.targetEdge};var i=(0,r.__assign)({},C[e]);return(0,f.jI)()?(i.alignmentEdge&&i.alignmentEdge%2==0&&(i.alignmentEdge=-1*i.alignmentEdge),void 0!==t?C[t]:i):i}(e.directionalHint,e.directionalHintForRTL,i),u,n,e.coverTarget,e.alignTargetEdge),c=j(z(t),u,n,d,l,o,a,e.directionalHintFixed,e.coverTarget);return(0,r.__assign)((0,r.__assign)({},c),{targetRectangle:u})}function V(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),function(e){return Math.sqrt(e*e*2)}(e?t:0)/2+n}function G(e,t,n,i,o,a,s,l){void 0===o&&(o=!1);var u=null!=l?l:(0,m.z)(),d=e.isBeakVisible&&e.beakWidth||0,c=V(e.isBeakVisible,e.beakWidth,e.gapSpace),h=e;h.gapSpace=c;var g,p,f,b,C,T,S,w,x,k=e.bounds?(x=e.bounds,new _.M(x.left,x.right,x.top,x.bottom)):new _.M(0,u.innerWidth-(0,v.XJ)(),0,u.innerHeight),O=H(h,n,k,i,o,a),B=(g=O,p=function(e,t){var n=t.targetRectangle,i=M(t.targetEdge),r=i.positiveEdge,o=i.negativeEdge,a=E(n,t.targetEdge),s=new _.M(e/2,t.elementRectangle.width-e/2,e/2,t.elementRectangle.height-e/2),l=new _.M(0,e,0,e);return P(l=R(l=N(l,-1*t.targetEdge,-e/2),-1*t.targetEdge,a-A(r,t.elementRectangle)),s,r)?P(l,s,o)||(l=F(l,s,o)):l=F(l,s,r),l}(d,O),f=k,b=-1*g.targetEdge,C=new _.M(0,g.elementRectangle.width,0,g.elementRectangle.height),T={},S=q(g.elementRectangle,g.alignmentEdge?g.alignmentEdge:M(b).positiveEdge,f),w=D(g.elementRectangle,g.targetRectangle,b)>Math.abs(I(p,b)),T[y.x[b]]=I(p,b),T[y.x[S]]=D(p,C,S),{elementPosition:(0,r.__assign)({},T),closestEdge:W(g.targetEdge,p,C),targetEdge:b,hideBeak:!w});return(0,r.__assign)((0,r.__assign)({},function(e,t,n,i,r){return{elementPosition:U(e.elementRectangle,t,e.targetEdge,n,e.alignmentEdge,i,r,e.forcedInBounds),targetEdge:e.targetEdge,alignmentEdge:e.alignmentEdge}}(O,t,k,e.coverTarget,s)),{beakPosition:B})}var Q=n(98675),K=n(11192),$=n(91578),Z=n(83758),J=n(52053),Y=n(28482),X=n(18465);function ee(e){var t=e.originalElement,n=e.containsFocus;t&&n&&t!==(0,m.z)()&&setTimeout((function(){var e;null===(e=t.focus)||void 0===e||e.call(t)}),0)}var te=o.forwardRef((function(e,t){var n=(0,c.N)({shouldRestoreFocus:!0,enableAriaHiddenSiblings:!0},e),i=o.useRef(),a=(0,Y.a)(i,t);!function(e,t){var n="true"===String(e["aria-modal"]).toLowerCase()&&e.enableAriaHiddenSiblings;o.useEffect((function(){if(n&&t.current)return(0,K.q)(t.current)}),[t,n])}(n,i),function(e,t){var n=e.onRestoreFocus,i=void 0===n?ee:n,r=o.useRef(),a=o.useRef(!1);o.useEffect((function(){return r.current=(0,Q.Y)().activeElement,(0,l.SE)(t.current)&&(a.current=!0),function(){var e;null==i||i({originalElement:r.current,containsFocus:a.current,documentContainsFocus:(null===(e=(0,Q.Y)())||void 0===e?void 0:e.hasFocus())||!1}),r.current=void 0}}),[]),(0,J.x)(t,"focus",o.useCallback((function(){a.current=!0}),[]),!0),(0,J.x)(t,"blur",o.useCallback((function(e){t.current&&e.relatedTarget&&!t.current.contains(e.relatedTarget)&&(a.current=!1)}),[]),!0)}(n,i);var s=n.role,u=n.className,d=n.ariaLabel,g=n.ariaLabelledBy,p=n.ariaDescribedBy,f=n.style,m=n.children,v=n.onDismiss,y=function(e,t){var n=(0,Z.Y)(),i=o.useState(!1),r=i[0],a=i[1];return o.useEffect((function(){return n.requestAnimationFrame((function(){var n;if(!e.style||!e.style.overflowY){var i=!1;if(t&&t.current&&(null===(n=t.current)||void 0===n?void 0:n.firstElementChild)){var o=t.current.clientHeight,s=t.current.firstElementChild.clientHeight;o>0&&s>o&&(i=s-o>1)}r!==i&&a(i)}})),function(){return n.dispose()}})),r}(n,i),_=o.useCallback((function(e){e.which===$.c.escape&&v&&(v(e),e.preventDefault(),e.stopPropagation())}),[v]),b=(0,X.ox)();return(0,J.x)(b,"keydown",_),o.createElement("div",(0,r.__assign)({ref:a},(0,h.G1)(n,h.JM),{className:u,role:s,"aria-label":d,"aria-labelledby":g,"aria-describedby":p,onKeyDown:_,style:(0,r.__assign)({overflowY:y?"scroll":void 0,outline:"none"},f)}),m)}));te.displayName="Popup";var ne,ie=n(30205),re=n(44207),oe=n(54465),ae=n(91449),se=n(43488),le=((ne={})[y.x.top]=re.lw.slideUpIn10,ne[y.x.bottom]=re.lw.slideDownIn10,ne[y.x.left]=re.lw.slideLeftIn10,ne[y.x.right]=re.lw.slideRightIn10,ne),ue={opacity:0,filter:"opacity(0)",pointerEvents:"none"},de=["role","aria-roledescription"],ce={preventDismissOnLostFocus:!1,preventDismissOnScroll:!1,preventDismissOnResize:!1,isBeakVisible:!0,beakWidth:16,gapSpace:0,minPagePadding:8,directionalHint:s.A.bottomAutoEdge},he=(0,ie.Z)({disableCaching:!0});function ge(e,t,n,i){var r,a=e.calloutMaxHeight,s=e.finalHeight,l=e.directionalHint,u=e.directionalHintFixed,d=e.hidden,c=e.gapSpace,h=e.beakWidth,g=e.isBeakVisible,p=e.coverTarget,f=o.useState(),m=f[0],v=f[1],b=null!==(r=null==i?void 0:i.elementPosition)&&void 0!==r?r:{},C=b.top,T=b.bottom,S=(null==n?void 0:n.current)?function(e){var t,n,i,r,o=e,a=e,s=e,l=null!==(t=s.left)&&void 0!==t?t:s.x,u=null!==(n=s.top)&&void 0!==n?n:s.y,d=null!==(i=s.right)&&void 0!==i?i:l,c=null!==(r=s.bottom)&&void 0!==r?r:u;return o.stopPropagation?new _.M(o.clientX,o.clientX,o.clientY,o.clientY):void 0!==l&&void 0!==u?new _.M(l,d,u,c):z(a)}(n.current):void 0;return o.useEffect((function(){var e,n,r=null!==(e=t())&&void 0!==e?e:{},o=r.top,s=r.bottom;(null==i?void 0:i.targetEdge)===y.x.top&&(null==S?void 0:S.top)&&!p&&(s=S.top-function(e,t,n){return V(e,t,n)}(g,h,c)),"number"==typeof C&&s?n=s-C:"number"==typeof T&&"number"==typeof o&&s&&(n=s-o-T),v(!a&&!d||a&&n&&a>n?n:a||void 0)}),[T,a,s,l,u,t,d,i,C,c,h,g,S,p]),m}function pe(e,t,n,i,a,s){var l,u=o.useState(),d=u[0],c=u[1],h=o.useRef(0),g=o.useRef(),p=(0,Z.Y)(),f=e.hidden,v=e.target,y=e.finalHeight,_=e.calloutMaxHeight,b=e.onPositioned,C=e.directionalHint,T=e.hideOverflow,S=e.preferScrollResizePositioning,I=(0,se.bX)(),w=o.useRef();w.current!==s.current&&(w.current=s.current,l=s.current?null==I?void 0:I.getComputedStyle(s.current):void 0);var E=null==l?void 0:l.overflowY;return o.useEffect((function(){if(!f){var o=p.requestAnimationFrame((function(){var o,s,l,u;if(t.current&&n){var p=(0,r.__assign)((0,r.__assign)({},e),{target:i.current,bounds:a()}),f=n.cloneNode(!0);f.style.maxHeight=_?"".concat(_):"",f.style.visibility="hidden",null===(o=n.parentElement)||void 0===o||o.appendChild(f);var C=g.current===v?d:void 0,w=S&&!(T||"clip"===E||"hidden"===E),x=y?function(e,t,n,i,r){return function(e,t,n,i,r){return G(e,t,n,i,!1,void 0,!0,null!=r?r:(0,m.z)())}(e,t,n,i,r)}(p,t.current,f,C,I):function(e,t,n,i,r,o,a){return G(e,t,n,i,r,void 0,void 0,a)}(p,t.current,f,C,w,0,I);null===(s=n.parentElement)||void 0===s||s.removeChild(f),!d&&x||d&&x&&(u=x,!ve((l=d).elementPosition,u.elementPosition)||!ve(l.beakPosition.elementPosition,u.beakPosition.elementPosition))&&h.current<5?(h.current++,c(x)):h.current>0&&(h.current=0,null==b||b(d))}}),n);return g.current=v,function(){p.cancelAnimationFrame(o),g.current=void 0}}c(void 0),h.current=0}),[f,C,p,n,_,t,i,y,a,b,d,e,v,T,S,E,I]),d}var fe=o.memo(o.forwardRef((function(e,t){var n=(0,c.N)(ce,e),i=n.styles,a=n.style,s=n.ariaLabel,p=n.ariaDescribedBy,f=n.ariaLabelledBy,m=n.className,v=n.isBeakVisible,y=n.children,_=n.beakWidth,b=n.calloutWidth,C=n.calloutMaxWidth,T=n.calloutMinWidth,S=n.doNotLayer,I=n.finalHeight,w=n.hideOverflow,E=void 0===w?!!I:w,x=n.backgroundColor,A=n.calloutMaxHeight,D=n.onScroll,N=n.shouldRestoreFocus,F=void 0===N||N,P=n.target,k=n.hidden,O=n.onLayerMounted,B=n.popupProps,R=o.useRef(null),L=o.useRef(null),M=(0,Y.a)(L,null==B?void 0:B.ref),q=o.useState(null),U=q[0],W=q[1],j=o.useCallback((function(e){W(e)}),[]),z=(0,Y.a)(R,t),H=(0,ae.P)(n.target,{current:U}),V=H[0],G=H[1],Q=function(e,t,n){var i=e.bounds,r=e.minPagePadding,a=void 0===r?ce.minPagePadding:r,s=e.target,l=o.useState(!1),u=l[0],d=l[1],c=o.useRef(),h=o.useCallback((function(){if(!c.current||u){var e="function"==typeof i?n?i(s,n):void 0:i;!e&&n&&(e=function(e,t){return function(e,t){var n=void 0;if(t.getWindowSegments&&(n=t.getWindowSegments()),void 0===n||n.length<=1)return{top:0,left:0,right:t.innerWidth,bottom:t.innerHeight,width:t.innerWidth,height:t.innerHeight};var i=0,r=0;if(null!==e&&e.getBoundingClientRect){var o=e.getBoundingClientRect();i=(o.left+o.right)/2,r=(o.top+o.bottom)/2}else null!==e&&(i=e.left||e.x,r=e.top||e.y);for(var a={top:0,left:0,right:0,bottom:0,width:0,height:0},s=0,l=n;s<l.length;s++){var u=l[s];i&&u.left<=i&&u.right>=i&&r&&u.top<=r&&u.bottom>=r&&(a={top:u.top,left:u.left,right:u.right,bottom:u.bottom,width:u.width,height:u.height})}return a}(e,t)}(t.current,n),e={top:e.top+a,left:e.left+a,right:e.right-a,bottom:e.bottom-a,width:e.width-2*a,height:e.height-2*a}),c.current=e,u&&d(!1)}return c.current}),[i,a,s,t,n,u]),g=(0,Z.Y)();return(0,J.x)(n,"resize",g.debounce((function(){d(!0)}),500,{leading:!0})),h}(n,V,G),K=pe(n,R,U,V,Q,M),$=ge(n,Q,V,K),X=function(e,t,n,i,r){var a=e.hidden,s=e.onDismiss,l=e.preventDismissOnScroll,c=e.preventDismissOnResize,h=e.preventDismissOnLostFocus,g=e.dismissOnTargetClick,p=e.shouldDismissOnWindowFocus,f=e.preventDismissOnEvent,m=o.useRef(!1),v=(0,Z.Y)(),y=(0,oe.d)([function(){m.current=!0},function(){m.current=!1}]),_=!!t;return o.useEffect((function(){var e=function(e){_&&!l&&y(e)},t=function(e){c||f&&f(e)||null==s||s(e)},o=function(e){h||y(e)},y=function(e){var t=e.composedPath?e.composedPath():[],o=t.length>0?t[0]:e.target,a=n.current&&!(0,u.s)(n.current,o);if(a&&m.current)m.current=!1;else if(!i.current&&a||e.target!==r&&a&&(!i.current||"stopPropagation"in i.current||g||o!==i.current&&!(0,u.s)(i.current,o))){if(f&&f(e))return;null==s||s(e)}},b=function(e){p&&((!f||f(e))&&(f||h)||(null==r?void 0:r.document.hasFocus())||null!==e.relatedTarget||null==s||s(e))},C=new Promise((function(n){v.setTimeout((function(){if(!a&&r){var i=[(0,d.on)(r,"scroll",e,!0),(0,d.on)(r,"resize",t,!0),(0,d.on)(r.document.documentElement,"focus",o,!0),(0,d.on)(r.document.documentElement,"click",o,!0),(0,d.on)(r,"blur",b,!0)];n((function(){i.forEach((function(e){return e()}))}))}}),0)}));return function(){C.then((function(e){return e()}))}}),[a,v,n,i,r,s,p,g,h,c,l,_,f]),y}(n,K,R,V,G),ee=X[0],ne=X[1],ie=(null==K?void 0:K.elementPosition.top)&&(null==K?void 0:K.elementPosition.bottom),re=(0,r.__assign)((0,r.__assign)({},null==K?void 0:K.elementPosition),{maxHeight:$});if(ie&&(re.bottom=void 0),function(e,t,n){var i=e.hidden,r=e.setInitialFocus,a=(0,Z.Y)(),s=!!t;o.useEffect((function(){if(!i&&r&&s&&n){var e=a.requestAnimationFrame((function(){return(0,l.vO)(n)}),n);return function(){return a.cancelAnimationFrame(e)}}}),[i,s,a,n,r])}(n,K,U),o.useEffect((function(){k||null==O||O()}),[k]),!G)return null;var se=E,fe=v&&!!P,ve=he(i,{theme:n.theme,className:m,overflowYHidden:se,calloutWidth:b,positions:K,beakWidth:_,backgroundColor:x,calloutMaxWidth:C,calloutMinWidth:T,doNotLayer:S}),ye=(0,r.__assign)((0,r.__assign)({maxHeight:A||"100%"},a),se&&{overflowY:"hidden"}),_e=n.hidden?{visibility:"hidden"}:void 0;return o.createElement("div",{ref:z,className:ve.container,style:_e},o.createElement("div",(0,r.__assign)({},(0,h.G1)(n,h.JM,de),{className:(0,g.A)(ve.root,K&&K.targetEdge&&le[K.targetEdge]),style:K?(0,r.__assign)({},re):ue,tabIndex:-1,ref:j}),fe&&o.createElement("div",{className:ve.beak,style:me(K)}),fe&&o.createElement("div",{className:ve.beakCurtain}),o.createElement(te,(0,r.__assign)({role:n.role,"aria-roledescription":n["aria-roledescription"],ariaDescribedBy:p,ariaLabel:s,ariaLabelledBy:f,className:ve.calloutMain,onDismiss:n.onDismiss,onMouseDown:ee,onMouseUp:ne,onRestoreFocus:n.onRestoreFocus,onScroll:D,shouldRestoreFocus:F,style:ye},B,{ref:M}),y)))})),(function(e,t){return!(t.shouldUpdateWhenHidden||!e.hidden||!t.hidden)||(0,p.ab)(e,t)}));function me(e){var t,n,i=(0,r.__assign)((0,r.__assign)({},null===(t=null==e?void 0:e.beakPosition)||void 0===t?void 0:t.elementPosition),{display:(null===(n=null==e?void 0:e.beakPosition)||void 0===n?void 0:n.hideBeak)?"none":void 0});return i.top||i.bottom||i.left||i.right||(i.left=0,i.top=0),i}function ve(e,t){for(var n in t)if(t.hasOwnProperty(n)){var i=e[n],r=t[n];if(void 0===i||void 0===r)return!1;if(i.toFixed(2)!==r.toFixed(2))return!1}return!0}function ye(e){return{height:e,width:e}}fe.displayName="CalloutContentBase";var _e={container:"ms-Callout-container",root:"ms-Callout",beak:"ms-Callout-beak",beakCurtain:"ms-Callout-beakCurtain",calloutMain:"ms-Callout-main"},be=(0,a.I)(fe,(function(e){var t,n=e.theme,i=e.className,r=e.overflowYHidden,o=e.calloutWidth,a=e.beakWidth,s=e.backgroundColor,l=e.calloutMaxWidth,u=e.calloutMinWidth,d=e.doNotLayer,c=(0,re.Km)(_e,n),h=n.semanticColors,g=n.effects;return{container:[c.container,{position:"relative"}],root:[c.root,n.fonts.medium,{position:"absolute",display:"flex",zIndex:d?re.nA.Layer:void 0,boxSizing:"border-box",borderRadius:g.roundedCorner2,boxShadow:g.elevation16,selectors:(t={},t[re.up]={borderWidth:1,borderStyle:"solid",borderColor:"WindowText"},t)},(0,re.QN)(),i,!!o&&{width:o},!!l&&{maxWidth:l},!!u&&{minWidth:u}],beak:[c.beak,{position:"absolute",backgroundColor:h.menuBackground,boxShadow:"inherit",border:"inherit",boxSizing:"border-box",transform:"rotate(45deg)"},ye(a),s&&{backgroundColor:s}],beakCurtain:[c.beakCurtain,{position:"absolute",top:0,right:0,bottom:0,left:0,backgroundColor:h.menuBackground,borderRadius:g.roundedCorner2}],calloutMain:[c.calloutMain,{backgroundColor:h.menuBackground,overflowX:"hidden",overflowY:"auto",position:"relative",width:"100%",borderRadius:g.roundedCorner2},r&&{overflowY:"hidden"},s&&{backgroundColor:s}]}}),void 0,{scope:"CalloutContent"}),Ce=o.createContext(void 0),Te=function(){return function(){}};Ce.Provider;var Se=n(38883),Ie=n(413),we=n(33795),Ee=n(33072),xe=n(9414);function Ae(e,t){void 0===e&&(e={});var n=De(t)?t:function(e){return function(t){return e?(0,r.__assign)((0,r.__assign)({},t),e):t}}(t);return n(e)}function De(e){return"function"==typeof e}var Ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onCustomizationChange=function(){return t.forceUpdate()},t}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){Ee.X.observe(this._onCustomizationChange)},t.prototype.componentWillUnmount=function(){Ee.X.unobserve(this._onCustomizationChange)},t.prototype.render=function(){var e=this,t=this.props.contextTransform;return o.createElement(xe.z.Consumer,null,(function(n){var i=function(e,t){var n,i,o,a=(t||{}).customizations,s=void 0===a?{settings:{},scopedSettings:{}}:a;return{customizations:{settings:Ae(s.settings,e.settings),scopedSettings:(n=s.scopedSettings,i=e.scopedSettings,void 0===n&&(n={}),(De(i)?i:(void 0===(o=i)&&(o={}),function(e){var t=(0,r.__assign)({},e);for(var n in o)o.hasOwnProperty(n)&&(t[n]=(0,r.__assign)((0,r.__assign)({},e[n]),o[n]));return t}))(n)),inCustomizerContext:!0}}}(e.props,n);return t&&(i=t(i)),o.createElement(xe.z.Provider,{value:i},e.props.children)}))},t}(o.Component),Fe=n(18322),Pe=(0,ie.Z)(),ke=(0,Ie.J9)((function(e,t){return(0,Fe.a)((0,r.__assign)((0,r.__assign)({},e),{rtl:t}))})),Oe=o.forwardRef((function(e,t){var n=e.className,i=e.theme,a=e.applyTheme,s=e.applyThemeToBody,l=e.styles,u=Pe(l,{theme:i,applyTheme:a,className:n}),d=o.useRef(null);return function(e,t,n){var i=t.bodyThemed;o.useEffect((function(){if(e){var t=(0,Q.Y)(n.current);if(t)return t.body.classList.add(i),function(){t.body.classList.remove(i)}}}),[i,e,n])}(s,u,d),o.createElement(o.Fragment,null,function(e,t,n,i){var a=t.root,s=e.as,l=void 0===s?"div":s,u=e.dir,d=e.theme,c=(0,h.G1)(e,h.JM,["dir"]),g=function(e){var t=e.theme,n=e.dir,i=(0,f.jI)(t)?"rtl":"ltr",r=(0,f.jI)()?"rtl":"ltr",o=n||i;return{rootDir:o!==i||o!==r?o:n,needsTheme:o!==i}}(e),p=g.rootDir,m=g.needsTheme,v=o.createElement(we.N,{providerRef:n},o.createElement(l,(0,r.__assign)({dir:p},c,{className:a,ref:(0,Y.a)(n,i)})));return m&&(v=o.createElement(Ne,{settings:{theme:ke(d,"rtl"===u)}},v)),v}(e,u,d,t))}));Oe.displayName="FabricBase";var Be,Re={fontFamily:"inherit"},Le={root:"ms-Fabric",bodyThemed:"ms-Fabric-bodyThemed"},Me=(0,a.I)(Oe,(function(e){var t=e.applyTheme,n=e.className,i=e.preventBlanketFontInheritance,r=e.theme;return{root:[(0,re.Km)(Le,r).root,r.fonts.medium,{color:r.palette.neutralPrimary},!i&&{"& button":Re,"& input":Re,"& textarea":Re},t&&{color:r.semanticColors.bodyText,backgroundColor:r.semanticColors.bodyBackground},n],bodyThemed:[{backgroundColor:r.semanticColors.bodyBackground}]}}),void 0,{scope:"Fabric"}),qe=n(39977),Ue=n(52302),We=n(79970),je=n(70262),ze=n(66e3),He=(0,ie.Z)(),Ve=o.forwardRef((function(e,t){var n,i=null!==(n=o.useContext(Ce))&&void 0!==n?n:Te,a=o.useRef(null),s=(0,Y.a)(a,t),l=o.useRef(),u=o.useRef(null),d=o.useContext(Ue.dM),c=o.useState(!1),h=c[0],p=c[1],f=o.useCallback((function(e){var t,n=!!(null==(t=null==d?void 0:d.providerRef)?void 0:t.current)&&t.current.classList.contains(qe.Y2);e&&n&&e.classList.add(qe.Y2)}),[d]),m=e.children,v=e.className,y=e.eventBubblingEnabled,_=e.fabricProps,b=e.hostId,C=e.insertFirst,T=e.onLayerDidMount,S=void 0===T?function(){}:T,I=e.onLayerMounted,w=void 0===I?function(){}:I,E=e.onLayerWillUnmount,x=e.styles,A=e.theme,D=(0,Y.a)(u,null==_?void 0:_.ref,f),N=He(x,{theme:A,className:v,isNotHost:!b}),F=function(){null==E||E();var e=l.current;l.current=void 0,e&&e.parentNode&&e.parentNode.removeChild(e)},P=function(){var e,t,n,i,r=(0,Q.Y)(a.current),o=(null===(t=null===(e=a.current)||void 0===e?void 0:e.getRootNode())||void 0===t?void 0:t.host)?null===(n=null==a?void 0:a.current)||void 0===n?void 0:n.getRootNode():void 0;if(r&&(r||o)){var s=function(e,t){var n,i;void 0===t&&(t=null);var r=null!=t?t:e;if(b){var o=(0,je.Ao)(b);return o?null!==(n=o.rootRef.current)&&void 0!==n?n:null:null!==(i=r.getElementById(b))&&void 0!==i?i:null}var a=(0,je.Ju)(),s=a?r.querySelector(a):null;return s||(s=(0,je.tQ)(e,t)),s}(r,o);if(s){s.__tabsterElementFlags||(s.__tabsterElementFlags={}),s.__tabsterElementFlags.noDirectAriaHidden=!0,F();var u=(null!==(i=s.ownerDocument)&&void 0!==i?i:r).createElement("div");u.className=N.root,(0,We.V)(u),function(e,t){var n=e,i=t;n._virtual||(n._virtual={children:[]});var r=n._virtual.parent;if(r&&r!==t){var o=r._virtual.children.indexOf(n);o>-1&&r._virtual.children.splice(o,1)}n._virtual.parent=i||void 0,i&&(i._virtual||(i._virtual={children:[]}),i._virtual.children.push(n))}(u,a.current),C?s.insertBefore(u,s.firstChild):s.appendChild(u),l.current=u,p(!0)}}};return(0,ze.E)((function(){P(),b&&(0,je.vh)(b,P);var e=l.current?i(l.current):void 0;return function(){e&&e(),F(),b&&(0,je.GU)(b,P)}}),[b]),o.useEffect((function(){l.current&&h&&(null==w||w(),null==S||S(),p(!1))}),[h,w,S]),o.createElement("span",{className:"ms-layer",ref:s},l.current&&Se.createPortal(o.createElement(we.N,{layerRoot:!0,providerRef:D},o.createElement(Me,(0,r.__assign)({},!y&&(Be||(Be={},["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOver","onMouseOut","onMouseUp","onTouchMove","onTouchStart","onTouchCancel","onTouchEnd","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onInvalid","onSubmit"].forEach((function(e){return Be[e]=Ge}))),Be),_,{className:(0,g.A)(N.content,null==_?void 0:_.className),ref:D}),m)),l.current))}));Ve.displayName="LayerBase";var Ge=function(e){e.eventPhase===Event.BUBBLING_PHASE&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type&&e.stopPropagation()},Qe={root:"ms-Layer",rootNoHost:"ms-Layer--fixed",content:"ms-Layer-content"},Ke=(0,a.I)(Ve,(function(e){var t=e.className,n=e.isNotHost,i=e.theme,r=(0,re.Km)(Qe,i);return{root:[r.root,i.fonts.medium,n&&[r.rootNoHost,{position:"fixed",zIndex:re.nA.Layer,top:0,left:0,bottom:0,right:0,visibility:"hidden"}],t],content:[r.content,{visibility:"visible"}]}}),void 0,{scope:"Layer",fields:["hostId","theme","styles"]}),$e=o.forwardRef((function(e,t){var n=e.layerProps,i=e.doNotLayer,a=(0,r.__rest)(e,["layerProps","doNotLayer"]),s=o.createElement(be,(0,r.__assign)({},a,{doNotLayer:i,ref:t}));return i?s:o.createElement(Ke,(0,r.__assign)({},n),s)}));$e.displayName="Callout"},90298:(e,t,n)=>{"use strict";n.d(t,{l8:()=>c,ne:()=>d});var i=n(30206),r=n(95734),o=n(34771),a=n(413),s=n(13668),l=n(63666),u=n(44207),d=(0,a.J9)((function(e){var t=(0,u.sW)(e)||{subset:{},code:void 0},n=t.code,i=t.subset;return n?{children:n,iconClassName:i.className,fontFamily:i.fontFace&&i.fontFace.fontFamily,mergeImageProps:i.mergeImageProps}:null}),void 0,!0),c=function(e){var t=e.iconName,n=e.className,a=e.style,u=void 0===a?{}:a,c=d(t)||{},h=c.iconClassName,g=c.children,p=c.fontFamily,f=c.mergeImageProps,m=(0,s.G1)(e,s.vt),v=e["aria-label"]||e.title,y=e["aria-label"]||e["aria-labelledby"]||e.title?{role:f?void 0:"img"}:{"aria-hidden":!0},_=g;return f&&"object"==typeof g&&"object"==typeof g.props&&v&&(_=r.cloneElement(g,{alt:v})),r.createElement("i",(0,i.__assign)({"data-icon-name":t},y,m,f?{title:void 0,"aria-label":void 0}:{},{className:(0,l.A)(o.xD,o.xW.root,h,!t&&o.xW.placeholder,n),style:(0,i.__assign)({fontFamily:p},u)}),_)};(0,a.J9)((function(e,t,n){return c({iconName:e,className:t,"aria-label":n})}))},34771:(e,t,n)=>{"use strict";n.d(t,{$f:()=>o,xD:()=>r,xW:()=>i});var i=(0,n(44207).l8)({root:{display:"inline-block",textDecoration:"inherit"},placeholder:["ms-Icon-placeHolder",{width:"1em"}],image:["ms-Icon-imageContainer",{overflow:"hidden"}]}),r="ms-Icon",o=function(e){var t=e.className,n=e.iconClassName,r=e.isPlaceholder,o=e.isImage,a=e.styles;return{root:[r&&i.placeholder,i.root,o&&i.image,n,t,a&&a.root,a&&a.imageContainer]}}},70262:(e,t,n)=>{"use strict";n.d(t,{$K:()=>d,Ao:()=>u,GU:()=>l,Ju:()=>p,K3:()=>g,a$:()=>c,tQ:()=>h,vh:()=>s});var i={},r={},o="fluent-default-layer-host",a="#".concat(o);function s(e,t){i[e]||(i[e]=[]),i[e].push(t);var n=r[e];if(n)for(var o=0,a=n;o<a.length;o++)a[o].notifyLayersChanged()}function l(e,t){var n=i[e];if(n){var o=n.indexOf(t);o>=0&&(n.splice(o,1),0===n.length&&delete i[e])}var a=r[e];if(a)for(var s=0,l=a;s<l.length;s++)l[s].notifyLayersChanged()}function u(e){var t=r[e];return t&&t[0]||void 0}function d(e,t){(r[e]||(r[e]=[])).unshift(t)}function c(e,t){var n=r[e];if(n){var i=n.indexOf(t);i>=0&&n.splice(i,1),0===n.length&&delete r[e]}}function h(e,t){void 0===t&&(t=null);var n=e.createElement("div");return n.setAttribute("id",o),n.style.cssText="position:fixed;z-index:1000000",t?t.appendChild(n):null==e||e.body.appendChild(n),n}function g(e){i[e]&&i[e].forEach((function(e){return e()}))}function p(){return a}},43488:(e,t,n)=>{"use strict";n.d(t,{LW:()=>o,bX:()=>r});var i=n(18465),r=function(){var e;return null!==(e=(0,i.ox)())&&void 0!==e?e:"undefined"!=typeof window?window:void 0},o=function(e){var t,n;return null!==(n=null===(t=null==e?void 0:e.window)||void 0===t?void 0:t.document)&&void 0!==n?n:"undefined"!=typeof document?document:void 0}},35240:(e,t,n)=>{"use strict";var i,r;n.d(t,{x:()=>i}),function(e){e[e.top=1]="top",e[e.bottom=-1]="bottom",e[e.left=2]="left",e[e.right=-2]="right"}(i||(i={})),function(e){e[e.top=0]="top",e[e.bottom=1]="bottom",e[e.start=2]="start",e[e.end=3]="end"}(r||(r={}))},44207:(e,t,n)=>{"use strict";n.d(t,{lw:()=>K,s:()=>ve.s,BO:()=>ve.BO,up:()=>X,fF:()=>ve.fF,mm:()=>ee,nr:()=>Z.nr,nA:()=>ie,TW:()=>De.T,pB:()=>Ne.p,QN:()=>ae,gm:()=>oe,Km:()=>Y,Qg:()=>ne,sW:()=>we,L6:()=>te,O4:()=>me,dX:()=>$,l8:()=>Fe.l,Zq:()=>i.Z,K1:()=>Ie});var i=n(48614),r=n(76437),o="cubic-bezier(.1,.9,.2,1)",a="cubic-bezier(.1,.25,.75,.9)",s="0.167s",l="0.267s",u="0.367s",d="0.467s",c=(0,r.i)({from:{opacity:0},to:{opacity:1}}),h=(0,r.i)({from:{opacity:1},to:{opacity:0,visibility:"hidden"}}),g=H(-10),p=H(-20),f=H(-40),m=H(-400),v=H(10),y=H(20),_=H(40),b=H(400),C=V(10),T=V(20),S=V(-10),I=V(-20),w=G(10),E=G(20),x=G(40),A=G(400),D=G(-10),N=G(-20),F=G(-40),P=G(-400),k=Q(-10),O=Q(-20),B=Q(10),R=Q(20),L=(0,r.i)({from:{transform:"scale3d(.98,.98,1)"},to:{transform:"scale3d(1,1,1)"}}),M=(0,r.i)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(.98,.98,1)"}}),q=(0,r.i)({from:{transform:"scale3d(1.03,1.03,1)"},to:{transform:"scale3d(1,1,1)"}}),U=(0,r.i)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(1.03,1.03,1)"}}),W=(0,r.i)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(90deg)"}}),j=(0,r.i)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(-90deg)"}});function z(e,t,n){return{animationName:e,animationDuration:t,animationTimingFunction:n,animationFillMode:"both"}}function H(e){return(0,r.i)({from:{transform:"translate3d(".concat(e,"px,0,0)"),pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function V(e){return(0,r.i)({from:{transform:"translate3d(0,".concat(e,"px,0)"),pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function G(e){return(0,r.i)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(".concat(e,"px,0,0)")}})}function Q(e){return(0,r.i)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(0,".concat(e,"px,0)")}})}var K=function(e){var t={},n=function(n){var r;e.hasOwnProperty(n)&&Object.defineProperty(t,n,{get:function(){return void 0===r&&(r=(0,i.Z)(e[n]).toString()),r},enumerable:!0,configurable:!0})};for(var r in e)n(r);return t}({slideRightIn10:z("".concat(c,",").concat(g),u,o),slideRightIn20:z("".concat(c,",").concat(p),u,o),slideRightIn40:z("".concat(c,",").concat(f),u,o),slideRightIn400:z("".concat(c,",").concat(m),u,o),slideLeftIn10:z("".concat(c,",").concat(v),u,o),slideLeftIn20:z("".concat(c,",").concat(y),u,o),slideLeftIn40:z("".concat(c,",").concat(_),u,o),slideLeftIn400:z("".concat(c,",").concat(b),u,o),slideUpIn10:z("".concat(c,",").concat(C),u,o),slideUpIn20:z("".concat(c,",").concat(T),u,o),slideDownIn10:z("".concat(c,",").concat(S),u,o),slideDownIn20:z("".concat(c,",").concat(I),u,o),slideRightOut10:z("".concat(h,",").concat(w),u,o),slideRightOut20:z("".concat(h,",").concat(E),u,o),slideRightOut40:z("".concat(h,",").concat(x),u,o),slideRightOut400:z("".concat(h,",").concat(A),u,o),slideLeftOut10:z("".concat(h,",").concat(D),u,o),slideLeftOut20:z("".concat(h,",").concat(N),u,o),slideLeftOut40:z("".concat(h,",").concat(F),u,o),slideLeftOut400:z("".concat(h,",").concat(P),u,o),slideUpOut10:z("".concat(h,",").concat(k),u,o),slideUpOut20:z("".concat(h,",").concat(O),u,o),slideDownOut10:z("".concat(h,",").concat(B),u,o),slideDownOut20:z("".concat(h,",").concat(R),u,o),scaleUpIn100:z("".concat(c,",").concat(L),u,o),scaleDownIn100:z("".concat(c,",").concat(q),u,o),scaleUpOut103:z("".concat(h,",").concat(U),s,a),scaleDownOut98:z("".concat(h,",").concat(M),s,a),fadeIn100:z(c,s,a),fadeIn200:z(c,l,a),fadeIn400:z(c,u,a),fadeIn500:z(c,d,a),fadeOut100:z(h,s,a),fadeOut200:z(h,l,a),fadeOut400:z(h,u,a),fadeOut500:z(h,d,a),rotate90deg:z(W,"0.1s",a),rotateN90deg:z(j,"0.1s",a)}),$={position:"absolute",width:1,height:1,margin:-1,padding:0,border:0,overflow:"hidden",whiteSpace:"nowrap"},Z=n(83702),J=(0,n(413).J9)((function(e,t){var n=Z.nr.getInstance();return t?Object.keys(e).reduce((function(t,i){return t[i]=n.getClassName(e[i]),t}),{}):e}));function Y(e,t,n){return J(e,void 0!==n?n:t.disableGlobalClassNames)}var X="@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)",ee=639;function te(e,t){var n="number"==typeof e?" and (min-width: ".concat(e,"px)"):"",i="number"==typeof t?" and (max-width: ".concat(t,"px)"):"";return"@media only screen".concat(n).concat(i)}function ne(){return{forcedColorAdjust:"none",MsHighContrastAdjust:"none"}}var ie,re=n(39977);function oe(e,t,n,i,r,o,a,s){return function(e,t){var n,i;void 0===t&&(t={});var r=t.borderRadius,o=t.inset,a=void 0===o?0:o,s=t.width,l=void 0===s?1:s,u=t.position,d=void 0===u?"relative":u,c=t.highContrastStyle,h=t.borderColor,g=void 0===h?e.palette.white:h,p=t.outlineColor,f=void 0===p?e.palette.neutralSecondary:p,m=t.isFocusedOnly,v=void 0===m||m,y=t.pointerEvents;return{outline:"transparent",position:d,selectors:(n={"::-moz-focus-inner":{border:"0"}},n[".".concat(re.Y2," &").concat(v?":focus":"",":after, :host(.").concat(re.Y2,") &").concat(v?":focus":"",":after")]={content:'""',position:"absolute",pointerEvents:y,left:a+1,top:a+1,bottom:a+1,right:a+1,border:"".concat(l,"px solid ").concat(g),outline:"".concat(l,"px solid ").concat(f),zIndex:ie.FocusStyle,borderRadius:r,selectors:(i={},i[X]=c,i)},n)}}(e,"number"!=typeof t&&t?t:{inset:t,position:n,highContrastStyle:i,borderColor:r,outlineColor:o,isFocusedOnly:a,borderRadius:s})}function ae(){return{selectors:{"&::-moz-focus-inner":{border:0},"&":{outline:"transparent"}}}}!function(e){e.Nav=1,e.ScrollablePane=1,e.FocusStyle=1,e.Coachmark=1e3,e.Layer=1e6,e.KeytipLayer=1000001}(ie||(ie={}));var se=n(30206),le=n(58086),ue=n(33072),de=n(54167),ce=n(56664),he=(0,ce.a)({}),ge=[],pe="theme";function fe(){var e,t,n,i=(0,le.z)();(null===(t=null==i?void 0:i.FabricConfig)||void 0===t?void 0:t.legacyTheme)?function(e,t){var n;void 0===t&&(t=!1),he=(0,ce.a)(e,t),(0,de.EQ)((0,se.__assign)((0,se.__assign)((0,se.__assign)((0,se.__assign)({},he.palette),he.semanticColors),he.effects),function(e){for(var t={},n=0,i=Object.keys(e.fonts);n<i.length;n++)for(var r=i[n],o=e.fonts[r],a=0,s=Object.keys(o);a<s.length;a++){var l=s[a],u=r+l.charAt(0).toUpperCase()+l.slice(1),d=o[l];"fontSize"===l&&"number"==typeof d&&(d+="px"),t[u]=d}return t}(he))),ue.X.applySettings(((n={})[pe]=he,n)),ge.forEach((function(e){try{e(he)}catch(e){}}))}(i.FabricConfig.legacyTheme):ue.X.getSettings([pe]).theme||((null===(n=null==i?void 0:i.FabricConfig)||void 0===n?void 0:n.theme)&&(he=(0,ce.a)(i.FabricConfig.theme)),ue.X.applySettings(((e={})[pe]=he,e)))}function me(e){return void 0===e&&(e=!1),!0===e&&(he=(0,ce.a)({},e)),he}fe();var ve=n(36253),ye=n(52783);function _e(e){console&&console.warn&&console.warn(e)}var be=n(1798),Ce=ye.h.getValue("icons",{__options:{disableWarnings:!1,warnOnMissingIcons:!0},__remapped:{}}),Te=Z.nr.getInstance();Te&&Te.onReset&&Te.onReset((function(){for(var e in Ce)Ce.hasOwnProperty(e)&&Ce[e].subset&&(Ce[e].subset.className=void 0)}));var Se=function(e){return e.toLowerCase()};function Ie(e,t){var n=(0,se.__assign)((0,se.__assign)({},e),{isRegistered:!1,className:void 0}),i=e.icons;for(var r in t=t?(0,se.__assign)((0,se.__assign)({},Ce.__options),t):Ce.__options,i)if(i.hasOwnProperty(r)){var o=i[r],a=Se(r);Ce[a]?Ae(r):Ce[a]={code:o,subset:n}}}function we(e){var t=void 0,n=Ce.__options;if(e=e?Se(e):"",e=Ce.__remapped[e]||e)if(t=Ce[e]){var r=t.subset;r&&r.fontFace&&(r.isRegistered||((0,be.n)(r.fontFace),r.isRegistered=!0),r.className||(r.className=(0,i.Z)(r.style,{fontFamily:r.fontFace.fontFamily,fontWeight:r.fontFace.fontWeight||"normal",fontStyle:r.fontFace.fontStyle||"normal"})))}else!n.disableWarnings&&n.warnOnMissingIcons&&_e('The icon "'.concat(e,'" was used but not registered. See https://github.com/microsoft/fluentui/wiki/Using-icons for more information.'));return t}var Ee=[],xe=void 0;function Ae(e){Ce.__options.disableWarnings||(Ee.push(e),void 0===xe&&(xe=setTimeout((function(){_e("Some icons were re-registered. Applications should only call registerIcons for any given icon once. Redefining what an icon is may have unintended consequences. Duplicates include: \n"+Ee.slice(0,10).join(", ")+(Ee.length>10?" (+ ".concat(Ee.length-10," more)"):"")),xe=void 0,Ee=[]}),2e3)))}var De=n(80072),Ne=n(17596),Fe=n(68678);(0,n(7829).v)("@fluentui/style-utilities","8.12.0"),fe()},18322:(e,t,n)=>{"use strict";n.d(t,{a:()=>A});var i,r={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"};!function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(i||(i={}));var o,a,s,l,u,d={elevation4:i.depth4,elevation8:i.depth8,elevation16:i.depth16,elevation64:i.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},c=n(1798);!function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(o||(o={})),function(e){e.Arabic="'".concat(o.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(o.Cyrillic,"'"),e.EastEuropean="'".concat(o.EastEuropean,"'"),e.Greek="'".concat(o.Greek,"'"),e.Hebrew="'".concat(o.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(o.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(o.Vietnamese,"'"),e.WestEuropean="'".concat(o.WestEuropean,"'"),e.Armenian="'".concat(o.Armenian,"'"),e.Georgian="'".concat(o.Georgian,"'")}(a||(a={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(s||(s={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(l||(l={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(u||(u={}));var h="'Segoe UI', '".concat(o.WestEuropean,"'"),g={ar:a.Arabic,bg:a.Cyrillic,cs:a.EastEuropean,el:a.Greek,et:a.EastEuropean,he:a.Hebrew,hi:a.Hindi,hr:a.EastEuropean,hu:a.EastEuropean,ja:a.Japanese,kk:a.EastEuropean,ko:a.Korean,lt:a.EastEuropean,lv:a.EastEuropean,pl:a.EastEuropean,ru:a.Cyrillic,sk:a.EastEuropean,"sr-latn":a.EastEuropean,th:a.Thai,tr:a.EastEuropean,uk:a.Cyrillic,vi:a.Vietnamese,"zh-hans":a.ChineseSimplified,"zh-hant":a.ChineseTraditional,hy:a.Armenian,ka:a.Georgian};function p(e,t,n){return{fontFamily:n,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var f,m,v,y,_,b=n(45566),C=n(58086),T=(f=function(e){for(var t in g)if(g.hasOwnProperty(t)&&e&&0===t.indexOf(e))return g[t];return h}((0,b.Z)()),m="".concat(f,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif"),{tiny:p(s.mini,l.regular,m),xSmall:p(s.xSmall,l.regular,m),small:p(s.small,l.regular,m),smallPlus:p(s.smallPlus,l.regular,m),medium:p(s.medium,l.regular,m),mediumPlus:p(s.mediumPlus,l.regular,m),large:p(s.large,l.regular,m),xLarge:p(s.xLarge,l.semibold,m),xLargePlus:p(s.xLargePlus,l.semibold,m),xxLarge:p(s.xxLarge,l.semibold,m),xxLargePlus:p(s.xxLargePlus,l.semibold,m),superLarge:p(s.superLarge,l.semibold,m),mega:p(s.mega,l.semibold,m)});function S(e,t,n,i){e="'".concat(e,"'");var r=void 0!==i?"local('".concat(i,"'),"):"";(0,c.n)({fontFamily:e,src:r+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:n,fontStyle:"normal",fontDisplay:"swap"})}function I(e,t,n,i,r){void 0===i&&(i="segoeui");var o="".concat(e,"/").concat(n,"/").concat(i);S(t,o+"-light",l.light,r&&r+" Light"),S(t,o+"-semilight",l.semilight,r&&r+" SemiLight"),S(t,o+"-regular",l.regular,r),S(t,o+"-semibold",l.semibold,r&&r+" SemiBold"),S(t,o+"-bold",l.bold,r&&r+" Bold")}!function(e){if(e){var t="".concat(e,"/fonts");I(t,o.Thai,"leelawadeeui-thai","leelawadeeui"),I(t,o.Arabic,"segoeui-arabic"),I(t,o.Cyrillic,"segoeui-cyrillic"),I(t,o.EastEuropean,"segoeui-easteuropean"),I(t,o.Greek,"segoeui-greek"),I(t,o.Hebrew,"segoeui-hebrew"),I(t,o.Vietnamese,"segoeui-vietnamese"),I(t,o.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),I(t,a.Selawik,"selawik","selawik"),I(t,o.Armenian,"segoeui-armenian"),I(t,o.Georgian,"segoeui-georgian"),S("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),l.light),S("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),l.semibold)}}((_=null===(v=(0,C.z)())||void 0===v?void 0:v.FabricConfig,null!==(y=null==_?void 0:_.fontBaseUrl)&&void 0!==y?y:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets"));var w=n(34484),E={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"},x=n(68867);function A(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var n=!!e.isInverted,i={palette:r,effects:d,fonts:T,spacing:E,isInverted:n,disableGlobalClassNames:!1,semanticColors:(0,x.b)(r,d,void 0,n,t),rtl:void 0};return(0,w.z)(i,e)}},34484:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var i=n(34941),r=n(68867);function o(e,t){var n,o,a;void 0===t&&(t={});var s=(0,i.h)({},e,t,{semanticColors:(0,r.B)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(n=t.palette)||void 0===n?void 0:n.themePrimary)&&!(null===(o=t.palette)||void 0===o?void 0:o.accent)&&(s.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var l=0,u=Object.keys(s.fonts);l<u.length;l++){var d=u[l];s.fonts[d]=(0,i.h)(s.fonts[d],t.defaultFontStyle,null===(a=null==t?void 0:t.fonts)||void 0===a?void 0:a[d])}return s}},68867:(e,t,n)=>{"use strict";n.d(t,{B:()=>o,b:()=>r});var i=n(30206);function r(e,t,n,r,a){return void 0===a&&(a=!1),function(e,t){var n="";return!0===t&&(n=" /* @deprecated */"),e.listTextColor=e.listText+n,e.menuItemBackgroundChecked+=n,e.warningHighlight+=n,e.warningText=e.messageText+n,e.successText+=n,e}(o(e,t,(0,i.__assign)({primaryButtonBorder:"transparent",errorText:r?"#F1707B":"#a4262c",messageText:r?"#F3F2F1":"#323130",messageLink:r?"#6CB8F6":"#005A9E",messageLinkHovered:r?"#82C7FF":"#004578",infoIcon:r?"#C8C6C4":"#605e5c",errorIcon:r?"#F1707B":"#A80000",blockingIcon:r?"#442726":"#FDE7E9",warningIcon:r?"#C8C6C4":"#797775",severeWarningIcon:r?"#FCE100":"#D83B01",successIcon:r?"#92C353":"#107C10",infoBackground:r?"#323130":"#f3f2f1",errorBackground:r?"#442726":"#FDE7E9",blockingBackground:r?"#442726":"#FDE7E9",warningBackground:r?"#433519":"#FFF4CE",severeWarningBackground:r?"#4F2A0F":"#FED9CC",successBackground:r?"#393D1B":"#DFF6DD",warningHighlight:r?"#fff100":"#ffb900",successText:r?"#92c353":"#107C10"},n),r),a)}function o(e,t,n,r,o){void 0===o&&(o=!1);var a={},s=e||{},l=s.white,u=s.black,d=s.themePrimary,c=s.themeDark,h=s.themeDarker,g=s.themeDarkAlt,p=s.themeLighter,f=s.neutralLight,m=s.neutralLighter,v=s.neutralDark,y=s.neutralQuaternary,_=s.neutralQuaternaryAlt,b=s.neutralPrimary,C=s.neutralSecondary,T=s.neutralSecondaryAlt,S=s.neutralTertiary,I=s.neutralTertiaryAlt,w=s.neutralLighterAlt,E=s.accent;return l&&(a.bodyBackground=l,a.bodyFrameBackground=l,a.accentButtonText=l,a.buttonBackground=l,a.primaryButtonText=l,a.primaryButtonTextHovered=l,a.primaryButtonTextPressed=l,a.inputBackground=l,a.inputForegroundChecked=l,a.listBackground=l,a.menuBackground=l,a.cardStandoutBackground=l),u&&(a.bodyTextChecked=u,a.buttonTextCheckedHovered=u),d&&(a.link=d,a.primaryButtonBackground=d,a.inputBackgroundChecked=d,a.inputIcon=d,a.inputFocusBorderAlt=d,a.menuIcon=d,a.menuHeader=d,a.accentButtonBackground=d),c&&(a.primaryButtonBackgroundPressed=c,a.inputBackgroundCheckedHovered=c,a.inputIconHovered=c),h&&(a.linkHovered=h),g&&(a.primaryButtonBackgroundHovered=g),p&&(a.inputPlaceholderBackgroundChecked=p),f&&(a.bodyBackgroundChecked=f,a.bodyFrameDivider=f,a.bodyDivider=f,a.variantBorder=f,a.buttonBackgroundCheckedHovered=f,a.buttonBackgroundPressed=f,a.listItemBackgroundChecked=f,a.listHeaderBackgroundPressed=f,a.menuItemBackgroundPressed=f,a.menuItemBackgroundChecked=f),m&&(a.bodyBackgroundHovered=m,a.buttonBackgroundHovered=m,a.buttonBackgroundDisabled=m,a.buttonBorderDisabled=m,a.primaryButtonBackgroundDisabled=m,a.disabledBackground=m,a.listItemBackgroundHovered=m,a.listHeaderBackgroundHovered=m,a.menuItemBackgroundHovered=m),y&&(a.primaryButtonTextDisabled=y,a.disabledSubtext=y),_&&(a.listItemBackgroundCheckedHovered=_),S&&(a.disabledBodyText=S,a.variantBorderHovered=(null==n?void 0:n.variantBorderHovered)||S,a.buttonTextDisabled=S,a.inputIconDisabled=S,a.disabledText=S),b&&(a.bodyText=b,a.actionLink=b,a.buttonText=b,a.inputBorderHovered=b,a.inputText=b,a.listText=b,a.menuItemText=b),w&&(a.bodyStandoutBackground=w,a.defaultStateBackground=w),v&&(a.actionLinkHovered=v,a.buttonTextHovered=v,a.buttonTextChecked=v,a.buttonTextPressed=v,a.inputTextHovered=v,a.menuItemTextHovered=v),C&&(a.bodySubtext=C,a.focusBorder=C,a.inputBorder=C,a.smallInputBorder=C,a.inputPlaceholderText=C),T&&(a.buttonBorder=T),I&&(a.disabledBodySubtext=I,a.disabledBorder=I,a.buttonBackgroundChecked=I,a.menuDivider=I),E&&(a.accentButtonBackground=E),(null==t?void 0:t.elevation4)&&(a.cardShadow=t.elevation4),!r&&(null==t?void 0:t.elevation8)?a.cardShadowHovered=t.elevation8:a.variantBorderHovered&&(a.cardShadowHovered="0 0 1px "+a.variantBorderHovered),(0,i.__assign)((0,i.__assign)({},a),n)}},93656:(e,t,n)=>{"use strict";n.d(t,{h:()=>l,m:()=>u});var i=n(71737),r=n(51815),o=n(36934);const a=r.TQ.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background1`]:i.yd[t].shade40,[`colorPalette${n}Background2`]:i.yd[t].shade30,[`colorPalette${n}Background3`]:i.yd[t].primary,[`colorPalette${n}Foreground1`]:i.yd[t].tint30,[`colorPalette${n}Foreground2`]:i.yd[t].tint40,[`colorPalette${n}Foreground3`]:i.yd[t].tint20,[`colorPalette${n}BorderActive`]:i.yd[t].tint30,[`colorPalette${n}Border1`]:i.yd[t].primary,[`colorPalette${n}Border2`]:i.yd[t].tint20};return Object.assign(e,r)}),{});a.colorPaletteRedForeground3=i.yd.red.tint30,a.colorPaletteRedBorder2=i.yd.red.tint30,a.colorPaletteGreenForeground3=i.yd.green.tint40,a.colorPaletteGreenBorder2=i.yd.green.tint40,a.colorPaletteDarkOrangeForeground3=i.yd.darkOrange.tint30,a.colorPaletteDarkOrangeBorder2=i.yd.darkOrange.tint30,a.colorPaletteRedForegroundInverted=i.yd.red.primary,a.colorPaletteGreenForegroundInverted=i.yd.green.primary,a.colorPaletteYellowForegroundInverted=i.yd.yellow.shade30;const s=r.dt.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background2`]:i.cc[t].shade30,[`colorPalette${n}Foreground2`]:i.cc[t].tint40,[`colorPalette${n}BorderActive`]:i.cc[t].tint30};return Object.assign(e,r)}),{});s.colorPaletteDarkRedBackground2=i.cc.darkRed.shade20,s.colorPalettePlumBackground2=i.cc.plum.shade20;const l={...a,...s},u=Object.entries(o.s).reduce(((e,[t,n])=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${r}Background1`]:i.Ul[n].shade40,[`colorStatus${r}Background2`]:i.Ul[n].shade30,[`colorStatus${r}Background3`]:i.Ul[n].primary,[`colorStatus${r}Foreground1`]:i.Ul[n].tint30,[`colorStatus${r}Foreground2`]:i.Ul[n].tint40,[`colorStatus${r}Foreground3`]:i.Ul[n].tint20,[`colorStatus${r}BorderActive`]:i.Ul[n].tint30,[`colorStatus${r}ForegroundInverted`]:i.Ul[n].shade10,[`colorStatus${r}Border1`]:i.Ul[n].primary,[`colorStatus${r}Border2`]:i.Ul[n].tint20};return Object.assign(e,o)}),{});u.colorStatusDangerBackground3Hover=i.Ul[o.s.danger].shade10,u.colorStatusDangerBackground3Pressed=i.Ul[o.s.danger].shade20,u.colorStatusDangerForeground3=i.Ul[o.s.danger].tint40,u.colorStatusDangerBorder2=i.Ul[o.s.danger].tint30,u.colorStatusSuccessForeground3=i.Ul[o.s.success].tint40,u.colorStatusSuccessBorder2=i.Ul[o.s.success].tint40,u.colorStatusWarningForegroundInverted=i.Ul[o.s.warning].shade20},61883:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});const i={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"}},71122:(e,t,n)=>{"use strict";n.d(t,{U1:()=>r,oZ:()=>i});const i={10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"},r={10:"#2b2b40",20:"#2f2f4a",30:"#333357",40:"#383966",50:"#3d3e78",60:"#444791",70:"#4f52b2",80:"#5b5fc7",90:"#7579eb",100:"#7f85f5",110:"#9299f7",120:"#aab1fa",130:"#b6bcfa",140:"#c5cbfa",150:"#dce0fa",160:"#e8ebfa"}},71737:(e,t,n)=>{"use strict";n.d(t,{Ul:()=>a,cc:()=>o,yd:()=>r});var i=n(75435);const r={red:i.wv,green:i.wL,darkOrange:i.je,yellow:i.D9,berry:i.pT,lightGreen:i.EM,marigold:i.KK},o={darkRed:i.ik,cranberry:i.jF,pumpkin:i.Vv,peach:i.WB,gold:i.bK,brass:i.YA,brown:i.Xk,forest:i.CE,seafoam:i.$T,darkGreen:i.AV,lightTeal:i.JW,teal:i.$S,steel:i.s$,blue:i.z1,royalBlue:i.Os,cornflower:i.um,navy:i.Z,lavender:i.Us,purple:i.Zp,grape:i.QH,lilac:i.qn,pink:i.Vu,magenta:i.GC,plum:i.t1,beige:i.Zz,mink:i.QJ,platinum:i.X1,anchor:i.Y3},a={cranberry:i.jF,green:i.wL,orange:i.T_}},75435:(e,t,n)=>{"use strict";n.d(t,{$S:()=>L,$T:()=>P,AV:()=>B,CE:()=>F,D9:()=>x,EM:()=>k,Fn:()=>f,GC:()=>$,JW:()=>R,KK:()=>E,ON:()=>u,Oh:()=>i,Os:()=>U,Q1:()=>o,QH:()=>V,QJ:()=>Y,Ql:()=>d,Si:()=>h,T_:()=>I,Us:()=>z,Vu:()=>K,Vv:()=>S,WB:()=>w,X1:()=>X,Xk:()=>N,Xv:()=>l,Y3:()=>ee,YA:()=>D,Z:()=>j,Z1:()=>s,Zp:()=>H,Zz:()=>J,aJ:()=>c,bK:()=>A,c8:()=>r,fo:()=>m,ik:()=>_,jF:()=>b,je:()=>T,m4:()=>g,mY:()=>p,p1:()=>v,p6:()=>y,pT:()=>G,qn:()=>Q,s$:()=>M,t1:()=>Z,ti:()=>a,um:()=>W,wL:()=>O,wv:()=>C,z1:()=>q});const i={2:"#050505",4:"#0a0a0a",6:"#0f0f0f",8:"#141414",10:"#1a1a1a",12:"#1f1f1f",14:"#242424",16:"#292929",18:"#2e2e2e",20:"#333333",22:"#383838",24:"#3d3d3d",26:"#424242",28:"#474747",30:"#4d4d4d",32:"#525252",34:"#575757",36:"#5c5c5c",38:"#616161",40:"#666666",42:"#6b6b6b",44:"#707070",46:"#757575",48:"#7a7a7a",50:"#808080",52:"#858585",54:"#8a8a8a",56:"#8f8f8f",58:"#949494",60:"#999999",62:"#9e9e9e",64:"#a3a3a3",66:"#a8a8a8",68:"#adadad",70:"#b3b3b3",72:"#b8b8b8",74:"#bdbdbd",76:"#c2c2c2",78:"#c7c7c7",80:"#cccccc",82:"#d1d1d1",84:"#d6d6d6",86:"#dbdbdb",88:"#e0e0e0",90:"#e6e6e6",92:"#ebebeb",94:"#f0f0f0",96:"#f5f5f5",98:"#fafafa"},r={5:"rgba(255, 255, 255, 0.05)",10:"rgba(255, 255, 255, 0.1)",20:"rgba(255, 255, 255, 0.2)",30:"rgba(255, 255, 255, 0.3)",40:"rgba(255, 255, 255, 0.4)",50:"rgba(255, 255, 255, 0.5)",60:"rgba(255, 255, 255, 0.6)",70:"rgba(255, 255, 255, 0.7)",80:"rgba(255, 255, 255, 0.8)",90:"rgba(255, 255, 255, 0.9)"},o={5:"rgba(0, 0, 0, 0.05)",10:"rgba(0, 0, 0, 0.1)",20:"rgba(0, 0, 0, 0.2)",30:"rgba(0, 0, 0, 0.3)",40:"rgba(0, 0, 0, 0.4)",50:"rgba(0, 0, 0, 0.5)",60:"rgba(0, 0, 0, 0.6)",70:"rgba(0, 0, 0, 0.7)",80:"rgba(0, 0, 0, 0.8)",90:"rgba(0, 0, 0, 0.9)"},a={5:"rgba(26, 26, 26, 0.05)",10:"rgba(26, 26, 26, 0.1)",20:"rgba(26, 26, 26, 0.2)",30:"rgba(26, 26, 26, 0.3)",40:"rgba(26, 26, 26, 0.4)",50:"rgba(26, 26, 26, 0.5)",60:"rgba(26, 26, 26, 0.6)",70:"rgba(26, 26, 26, 0.7)",80:"rgba(26, 26, 26, 0.8)",90:"rgba(26, 26, 26, 0.9)"},s={5:"rgba(31, 31, 31, 0.05)",10:"rgba(31, 31, 31, 0.1)",20:"rgba(31, 31, 31, 0.2)",30:"rgba(31, 31, 31, 0.3)",40:"rgba(31, 31, 31, 0.4)",50:"rgba(31, 31, 31, 0.5)",60:"rgba(31, 31, 31, 0.6)",70:"rgba(31, 31, 31, 0.7)",80:"rgba(31, 31, 31, 0.8)",90:"rgba(31, 31, 31, 0.9)"},l={5:"rgba(36, 36, 36, 0.05)",10:"rgba(36, 36, 36, 0.1)",20:"rgba(36, 36, 36, 0.2)",30:"rgba(36, 36, 36, 0.3)",40:"rgba(36, 36, 36, 0.4)",50:"rgba(36, 36, 36, 0.5)",60:"rgba(36, 36, 36, 0.6)",70:"rgba(36, 36, 36, 0.7)",80:"rgba(36, 36, 36, 0.8)",90:"rgba(36, 36, 36, 0.9)"},u="#ffffff",d="#000000",c="#ffff00",h="#1aebff",g="#3ff23f",p="#000000",f="#ffffff",m="#000000",v="#000000",y="#ffffff",_={shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},b={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},C={shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},T={shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},S={shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},I={shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"},w={shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},E={shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"},x={shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},A={shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},D={shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},N={shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},F={shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},P={shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},k={shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},O={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},B={shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},R={shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},L={shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},M={shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},q={shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},U={shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},W={shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},j={shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},z={shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},H={shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},V={shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},G={shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},Q={shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},K={shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},$={shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},Z={shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},J={shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},Y={shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},X={shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},ee={shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},30975:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});const i={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"}},3442:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});const i={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"}},54661:(e,t,n)=>{"use strict";n.d(t,{GR:()=>i,NM:()=>o,aI:()=>a,lm:()=>r});const i={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},r={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},o={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},a={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"}},83601:(e,t,n)=>{"use strict";n.d(t,{F:()=>d,b:()=>u});const i="10px",r="12px",o="16px",a="20px",s="24px",l="32px",u={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:i,spacingHorizontalM:r,spacingHorizontalL:o,spacingHorizontalXL:a,spacingHorizontalXXL:s,spacingHorizontalXXXL:l},d={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:i,spacingVerticalM:r,spacingVerticalL:o,spacingVerticalXL:a,spacingVerticalXXL:s,spacingVerticalXXXL:l}},68106:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});const i={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"}},51815:(e,t,n)=>{"use strict";n.d(t,{TQ:()=>i,dt:()=>r});const i=["red","green","darkOrange","yellow","berry","lightGreen","marigold"],r=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"]},36934:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});const i={success:"green",warning:"orange",danger:"cranberry"}},68916:(e,t,n)=>{"use strict";n.d(t,{C:()=>h});var i=n(93656),r=n(75435),o=n(61883),a=n(54661),s=n(68106),l=n(6388),u=n(3442),d=n(30975),c=n(83601);const h=(e=>{const t=(e=>({colorNeutralForeground1:r.ON,colorNeutralForeground1Hover:r.ON,colorNeutralForeground1Pressed:r.ON,colorNeutralForeground1Selected:r.ON,colorNeutralForeground2:r.Oh[84],colorNeutralForeground2Hover:r.ON,colorNeutralForeground2Pressed:r.ON,colorNeutralForeground2Selected:r.ON,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:r.Oh[68],colorNeutralForeground3Hover:r.Oh[84],colorNeutralForeground3Pressed:r.Oh[84],colorNeutralForeground3Selected:r.Oh[84],colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:r.Oh[60],colorNeutralForegroundDisabled:r.Oh[36],colorNeutralForegroundInvertedDisabled:r.c8[40],colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:r.Oh[84],colorNeutralForeground2LinkHover:r.ON,colorNeutralForeground2LinkPressed:r.ON,colorNeutralForeground2LinkSelected:r.ON,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:r.Oh[14],colorNeutralForegroundStaticInverted:r.ON,colorNeutralForegroundInverted:r.Oh[14],colorNeutralForegroundInvertedHover:r.Oh[14],colorNeutralForegroundInvertedPressed:r.Oh[14],colorNeutralForegroundInvertedSelected:r.Oh[14],colorNeutralForegroundInverted2:r.Oh[14],colorNeutralForegroundOnBrand:r.ON,colorNeutralForegroundInvertedLink:r.ON,colorNeutralForegroundInvertedLinkHover:r.ON,colorNeutralForegroundInvertedLinkPressed:r.ON,colorNeutralForegroundInvertedLinkSelected:r.ON,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:r.Oh[16],colorNeutralBackground1Hover:r.Oh[24],colorNeutralBackground1Pressed:r.Oh[12],colorNeutralBackground1Selected:r.Oh[22],colorNeutralBackground2:r.Oh[12],colorNeutralBackground2Hover:r.Oh[20],colorNeutralBackground2Pressed:r.Oh[8],colorNeutralBackground2Selected:r.Oh[18],colorNeutralBackground3:r.Oh[8],colorNeutralBackground3Hover:r.Oh[16],colorNeutralBackground3Pressed:r.Oh[4],colorNeutralBackground3Selected:r.Oh[14],colorNeutralBackground4:r.Oh[4],colorNeutralBackground4Hover:r.Oh[12],colorNeutralBackground4Pressed:r.Ql,colorNeutralBackground4Selected:r.Oh[10],colorNeutralBackground5:r.Ql,colorNeutralBackground5Hover:r.Oh[8],colorNeutralBackground5Pressed:r.Oh[2],colorNeutralBackground5Selected:r.Oh[6],colorNeutralBackground6:r.Oh[20],colorNeutralBackgroundInverted:r.ON,colorNeutralBackgroundStatic:r.Oh[24],colorNeutralBackgroundAlpha:r.ti[50],colorNeutralBackgroundAlpha2:r.Z1[70],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:r.Oh[22],colorSubtleBackgroundPressed:r.Oh[18],colorSubtleBackgroundSelected:r.Oh[20],colorSubtleBackgroundLightAlphaHover:r.Xv[80],colorSubtleBackgroundLightAlphaPressed:r.Xv[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:r.Q1[10],colorSubtleBackgroundInvertedPressed:r.Q1[30],colorSubtleBackgroundInvertedSelected:r.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:r.Oh[8],colorNeutralBackgroundInvertedDisabled:r.c8[10],colorNeutralStencil1:r.Oh[34],colorNeutralStencil2:r.Oh[20],colorNeutralStencil1Alpha:r.c8[10],colorNeutralStencil2Alpha:r.c8[5],colorBackgroundOverlay:r.Q1[50],colorScrollbarOverlay:r.c8[60],colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:r.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:r.Oh[20],colorNeutralCardBackgroundHover:r.Oh[24],colorNeutralCardBackgroundPressed:r.Oh[18],colorNeutralCardBackgroundSelected:r.Oh[22],colorNeutralCardBackgroundDisabled:r.Oh[8],colorNeutralStrokeAccessible:r.Oh[68],colorNeutralStrokeAccessibleHover:r.Oh[74],colorNeutralStrokeAccessiblePressed:r.Oh[70],colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:r.Oh[40],colorNeutralStroke1Hover:r.Oh[46],colorNeutralStroke1Pressed:r.Oh[42],colorNeutralStroke1Selected:r.Oh[44],colorNeutralStroke2:r.Oh[32],colorNeutralStroke3:r.Oh[24],colorNeutralStrokeSubtle:r.Oh[4],colorNeutralStrokeOnBrand:r.Oh[16],colorNeutralStrokeOnBrand2:r.ON,colorNeutralStrokeOnBrand2Hover:r.ON,colorNeutralStrokeOnBrand2Pressed:r.ON,colorNeutralStrokeOnBrand2Selected:r.ON,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:r.Oh[26],colorNeutralStrokeInvertedDisabled:r.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:r.c8[10],colorNeutralStrokeAlpha2:r.c8[20],colorStrokeFocus1:r.Ql,colorStrokeFocus2:r.ON,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...o.V,...a.GR,...a.lm,...a.aI,...a.NM,...s.k,...c.b,...c.F,...u.S,...d.L,...t,...i.h,...i.m,...(0,l.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,l.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})(n(71122).oZ)},60970:(e,t,n)=>{"use strict";n.d(t,{o:()=>o});var i=n(62056),r=n(71122);const o=(0,i.a)(r.oZ)},62056:(e,t,n)=>{"use strict";n.d(t,{a:()=>y});var i=n(71737),r=n(51815),o=n(36934);const a=r.TQ.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background1`]:i.yd[t].tint60,[`colorPalette${n}Background2`]:i.yd[t].tint40,[`colorPalette${n}Background3`]:i.yd[t].primary,[`colorPalette${n}Foreground1`]:i.yd[t].shade10,[`colorPalette${n}Foreground2`]:i.yd[t].shade30,[`colorPalette${n}Foreground3`]:i.yd[t].primary,[`colorPalette${n}BorderActive`]:i.yd[t].primary,[`colorPalette${n}Border1`]:i.yd[t].tint40,[`colorPalette${n}Border2`]:i.yd[t].primary};return Object.assign(e,r)}),{});a.colorPaletteYellowForeground1=i.yd.yellow.shade30,a.colorPaletteRedForegroundInverted=i.yd.red.tint20,a.colorPaletteGreenForegroundInverted=i.yd.green.tint20,a.colorPaletteYellowForegroundInverted=i.yd.yellow.tint40;const s=r.dt.reduce(((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background2`]:i.cc[t].tint40,[`colorPalette${n}Foreground2`]:i.cc[t].shade30,[`colorPalette${n}BorderActive`]:i.cc[t].primary};return Object.assign(e,r)}),{}),l={...a,...s},u=Object.entries(o.s).reduce(((e,[t,n])=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),o={[`colorStatus${r}Background1`]:i.Ul[n].tint60,[`colorStatus${r}Background2`]:i.Ul[n].tint40,[`colorStatus${r}Background3`]:i.Ul[n].primary,[`colorStatus${r}Foreground1`]:i.Ul[n].shade10,[`colorStatus${r}Foreground2`]:i.Ul[n].shade30,[`colorStatus${r}Foreground3`]:i.Ul[n].primary,[`colorStatus${r}ForegroundInverted`]:i.Ul[n].tint30,[`colorStatus${r}BorderActive`]:i.Ul[n].primary,[`colorStatus${r}Border1`]:i.Ul[n].tint40,[`colorStatus${r}Border2`]:i.Ul[n].primary};return Object.assign(e,o)}),{});u.colorStatusDangerBackground3Hover=i.Ul[o.s.danger].shade10,u.colorStatusDangerBackground3Pressed=i.Ul[o.s.danger].shade20,u.colorStatusWarningForeground1=i.Ul[o.s.warning].shade20,u.colorStatusWarningForeground3=i.Ul[o.s.warning].shade20,u.colorStatusWarningBorder2=i.Ul[o.s.warning].shade20;var d=n(75435),c=n(61883),h=n(54661),g=n(68106),p=n(6388),f=n(3442),m=n(30975),v=n(83601);const y=e=>{const t=(e=>({colorNeutralForeground1:d.Oh[14],colorNeutralForeground1Hover:d.Oh[14],colorNeutralForeground1Pressed:d.Oh[14],colorNeutralForeground1Selected:d.Oh[14],colorNeutralForeground2:d.Oh[26],colorNeutralForeground2Hover:d.Oh[14],colorNeutralForeground2Pressed:d.Oh[14],colorNeutralForeground2Selected:d.Oh[14],colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:d.Oh[38],colorNeutralForeground3Hover:d.Oh[26],colorNeutralForeground3Pressed:d.Oh[26],colorNeutralForeground3Selected:d.Oh[26],colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:d.Oh[44],colorNeutralForegroundDisabled:d.Oh[74],colorNeutralForegroundInvertedDisabled:d.c8[40],colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:d.Oh[26],colorNeutralForeground2LinkHover:d.Oh[14],colorNeutralForeground2LinkPressed:d.Oh[14],colorNeutralForeground2LinkSelected:d.Oh[14],colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:d.Oh[14],colorNeutralForegroundStaticInverted:d.ON,colorNeutralForegroundInverted:d.ON,colorNeutralForegroundInvertedHover:d.ON,colorNeutralForegroundInvertedPressed:d.ON,colorNeutralForegroundInvertedSelected:d.ON,colorNeutralForegroundInverted2:d.ON,colorNeutralForegroundOnBrand:d.ON,colorNeutralForegroundInvertedLink:d.ON,colorNeutralForegroundInvertedLinkHover:d.ON,colorNeutralForegroundInvertedLinkPressed:d.ON,colorNeutralForegroundInvertedLinkSelected:d.ON,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:d.ON,colorNeutralBackground1Hover:d.Oh[96],colorNeutralBackground1Pressed:d.Oh[88],colorNeutralBackground1Selected:d.Oh[92],colorNeutralBackground2:d.Oh[98],colorNeutralBackground2Hover:d.Oh[94],colorNeutralBackground2Pressed:d.Oh[86],colorNeutralBackground2Selected:d.Oh[90],colorNeutralBackground3:d.Oh[96],colorNeutralBackground3Hover:d.Oh[92],colorNeutralBackground3Pressed:d.Oh[84],colorNeutralBackground3Selected:d.Oh[88],colorNeutralBackground4:d.Oh[94],colorNeutralBackground4Hover:d.Oh[98],colorNeutralBackground4Pressed:d.Oh[96],colorNeutralBackground4Selected:d.ON,colorNeutralBackground5:d.Oh[92],colorNeutralBackground5Hover:d.Oh[96],colorNeutralBackground5Pressed:d.Oh[94],colorNeutralBackground5Selected:d.Oh[98],colorNeutralBackground6:d.Oh[90],colorNeutralBackgroundInverted:d.Oh[16],colorNeutralBackgroundStatic:d.Oh[20],colorNeutralBackgroundAlpha:d.c8[50],colorNeutralBackgroundAlpha2:d.c8[80],colorSubtleBackground:"transparent",colorSubtleBackgroundHover:d.Oh[96],colorSubtleBackgroundPressed:d.Oh[88],colorSubtleBackgroundSelected:d.Oh[92],colorSubtleBackgroundLightAlphaHover:d.c8[70],colorSubtleBackgroundLightAlphaPressed:d.c8[50],colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:d.Q1[10],colorSubtleBackgroundInvertedPressed:d.Q1[30],colorSubtleBackgroundInvertedSelected:d.Q1[20],colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:d.Oh[94],colorNeutralBackgroundInvertedDisabled:d.c8[10],colorNeutralStencil1:d.Oh[90],colorNeutralStencil2:d.Oh[98],colorNeutralStencil1Alpha:d.Q1[10],colorNeutralStencil2Alpha:d.Q1[5],colorBackgroundOverlay:d.Q1[40],colorScrollbarOverlay:d.Q1[50],colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:d.ON,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:d.Oh[98],colorNeutralCardBackgroundHover:d.ON,colorNeutralCardBackgroundPressed:d.Oh[96],colorNeutralCardBackgroundSelected:d.Oh[92],colorNeutralCardBackgroundDisabled:d.Oh[94],colorNeutralStrokeAccessible:d.Oh[38],colorNeutralStrokeAccessibleHover:d.Oh[34],colorNeutralStrokeAccessiblePressed:d.Oh[30],colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:d.Oh[82],colorNeutralStroke1Hover:d.Oh[78],colorNeutralStroke1Pressed:d.Oh[70],colorNeutralStroke1Selected:d.Oh[74],colorNeutralStroke2:d.Oh[88],colorNeutralStroke3:d.Oh[94],colorNeutralStrokeSubtle:d.Oh[88],colorNeutralStrokeOnBrand:d.ON,colorNeutralStrokeOnBrand2:d.ON,colorNeutralStrokeOnBrand2Hover:d.ON,colorNeutralStrokeOnBrand2Pressed:d.ON,colorNeutralStrokeOnBrand2Selected:d.ON,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:d.Oh[88],colorNeutralStrokeInvertedDisabled:d.c8[40],colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:d.Q1[5],colorNeutralStrokeAlpha2:d.c8[20],colorStrokeFocus1:d.ON,colorStrokeFocus2:d.Ql,colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...c.V,...h.GR,...h.lm,...h.aI,...h.NM,...g.k,...v.b,...v.F,...f.S,...m.L,...t,...l,...u,...(0,p.t)(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...(0,p.t)(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}}},6388:(e,t,n)=>{"use strict";function i(e,t,n=""){return{[`shadow2${n}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${n}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${n}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${n}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${n}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${n}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}n.d(t,{t:()=>i})},47161:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var i=n(58086),r=function(){function e(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=function(){}}return e.prototype.dispose=function(){var e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}},e.prototype.setTimeout=function(e,t){var n=this,i=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),i=setTimeout((function(){try{n._timeoutIds&&delete n._timeoutIds[i],e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._timeoutIds[i]=!0),i},e.prototype.clearTimeout=function(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])},e.prototype.setImmediate=function(e,t){var n=this,r=0,o=(0,i.z)(t);return this._isDisposed||(this._immediateIds||(this._immediateIds={}),r=o.setTimeout((function(){try{n._immediateIds&&delete n._immediateIds[r],e.apply(n._parent)}catch(e){n._logError(e)}}),0),this._immediateIds[r]=!0),r},e.prototype.clearImmediate=function(e,t){var n=(0,i.z)(t);this._immediateIds&&this._immediateIds[e]&&(n.clearTimeout(e),delete this._immediateIds[e])},e.prototype.setInterval=function(e,t){var n=this,i=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),i=setInterval((function(){try{e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._intervalIds[i]=!0),i},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var i=this;if(this._isDisposed)return this._noop;var r,o,a=t||0,s=!0,l=!0,u=0,d=null;n&&"boolean"==typeof n.leading&&(s=n.leading),n&&"boolean"==typeof n.trailing&&(l=n.trailing);var c=function(t){var n=Date.now(),h=n-u,g=s?a-h:a;return h>=a&&(!t||s)?(u=n,d&&(i.clearTimeout(d),d=null),r=e.apply(i._parent,o)):null===d&&l&&(d=i.setTimeout(c,g)),r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,c(!0)}},e.prototype.debounce=function(e,t,n){var i=this;if(this._isDisposed){var r=function(){};return r.cancel=function(){},r.flush=function(){return null},r.pending=function(){return!1},r}var o,a,s=t||0,l=!1,u=!0,d=null,c=0,h=Date.now(),g=null;n&&"boolean"==typeof n.leading&&(l=n.leading),n&&"boolean"==typeof n.trailing&&(u=n.trailing),n&&"number"==typeof n.maxWait&&!isNaN(n.maxWait)&&(d=n.maxWait);var p=function(e){g&&(i.clearTimeout(g),g=null),h=e},f=function(t){p(t),o=e.apply(i._parent,a)},m=function(e){var t=Date.now(),n=!1;e&&(l&&t-c>=s&&(n=!0),c=t);var r=t-c,a=s-r,p=t-h,v=!1;return null!==d&&(p>=d&&g?v=!0:a=Math.min(a,d-p)),r>=s||v||n?f(t):null!==g&&e||!u||(g=i.setTimeout(m,a)),o},v=function(){return!!g},y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a=e,m(!0)};return y.cancel=function(){v()&&p(Date.now())},y.flush=function(){return v()&&f(Date.now()),o},y.pending=v,y},e.prototype.requestAnimationFrame=function(e,t){var n=this,r=0,o=(0,i.z)(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var a=function(){try{n._animationFrameIds&&delete n._animationFrameIds[r],e.apply(n._parent)}catch(e){n._logError(e)}};r=o.requestAnimationFrame?o.requestAnimationFrame(a):o.setTimeout(a,0),this._animationFrameIds[r]=!0}return r},e.prototype.cancelAnimationFrame=function(e,t){var n=(0,i.z)(t);this._animationFrameIds&&this._animationFrameIds[e]&&(n.cancelAnimationFrame?n.cancelAnimationFrame(e):n.clearTimeout(e),delete this._animationFrameIds[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}()},33795:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var i=n(95734),r=n(52302),o=function(e){var t=e.providerRef,n=e.layerRoot,o=i.useState([])[0],a=i.useContext(r.dM),s=void 0!==a&&!n,l=i.useMemo((function(){return s?void 0:{providerRef:t,registeredProviders:o,registerProvider:function(e){o.push(e),null==a||a.registerProvider(e)},unregisterProvider:function(e){null==a||a.unregisterProvider(e);var t=o.indexOf(e);t>=0&&o.splice(t,1)}}}),[t,o,a,s]);return i.useEffect((function(){if(l)return l.registerProvider(l.providerRef),function(){return l.unregisterProvider(l.providerRef)}}),[l]),l?i.createElement(r.dM.Provider,{value:l},e.children):i.createElement(i.Fragment,null,e.children)}},91578:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});var i={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pauseBreak:19,capslock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,del:46,zero:48,one:49,two:50,three:51,four:52,five:53,six:54,seven:55,eight:56,nine:57,colon:58,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindow:91,rightWindow:92,select:93,zero_numpad:96,one_numpad:97,two_numpad:98,three_numpad:99,four_numpad:100,five_numpad:101,six_numpad:102,seven_numpad:103,eight_numpad:104,nine_numpad:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrollLock:145,semicolon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBracket:221,singleQuote:222}},11272:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});var i=function(){function e(e,t,n,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=0),this.top=n,this.bottom=i,this.left=e,this.right=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this.right-this.left},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!1,configurable:!0}),e.prototype.equals=function(e){return parseFloat(this.top.toFixed(4))===parseFloat(e.top.toFixed(4))&&parseFloat(this.bottom.toFixed(4))===parseFloat(e.bottom.toFixed(4))&&parseFloat(this.left.toFixed(4))===parseFloat(e.left.toFixed(4))&&parseFloat(this.right.toFixed(4))===parseFloat(e.right.toFixed(4))},e}()},30205:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var i=n(83702),r=n(68678),o=n(24607),a=n(58086),s=50,l=5,u=0,d=i.nr.getInstance();d&&d.onReset&&d.onReset((function(){return u++}));var c="__retval__";function h(e){void 0===e&&(e={});var t=new Map,n=0,i=0,d=u;return function(h,g){var f;if(void 0===g&&(g={}),e.useStaticStyles&&"function"==typeof h&&h.__noStyleOverride__)return h(g);i++;var m=h?h.__shadowConfig__:void 0,v=m&&m.window?m.window:"__default__";t.has(v)||t.set(v,new Map);var y=t.get(v),_=g.theme,b=_&&void 0!==_.rtl?_.rtl:(0,o.jI)(),C=e.disableCaching;if(d!==u&&(d=u,t.set(v,new Map),y=t.get(v),n=0),e.disableCaching||(y=p(t.get(v),h),y=p(y,g)),!C&&y[c]||(y[c]=void 0===h?{}:(0,r.L)(["function"==typeof h?h(g):h],{shadowConfig:h.__shadowConfig__,rtl:!!b,specificityMultiplier:e.useStaticStyles?l:void 0}),C||n++),n>(e.cacheSize||s)){var T=(0,a.z)();(null===(f=null==T?void 0:T.FabricConfig)||void 0===f?void 0:f.enableClassNameCacheFullWarning)&&(console.warn("Styles are being recalculated too frequently. Cache miss rate is ".concat(n,"/").concat(i,".")),console.trace()),t.get(v).clear(),n=0,e.disableCaching=!0}return y[c]}}function g(e,t){return t=function(e){switch(e){case void 0:return"__undefined__";case null:return"__null__";default:return e}}(t),e.has(t)||e.set(t,new Map),e.get(t)}function p(e,t){if("function"==typeof t)if(t.__cachedInputs__)for(var n=0,i=t.__cachedInputs__;n<i.length;n++)e=g(e,i[n]);else e=g(e,t);else if("object"==typeof t)for(var r in t)t.hasOwnProperty(r)&&(e=g(e,t[r]));return e}},63666:(e,t,n)=>{"use strict";function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],i=0,r=e;i<r.length;i++){var o=r[i];if(o)if("string"==typeof o)n.push(o);else if(o.hasOwnProperty("toString")&&"function"==typeof o.toString)n.push(o.toString());else for(var a in o)o[a]&&n.push(a)}return n.join(" ")}n.d(t,{A:()=>i})},9414:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var i=n(95734).createContext({customizations:{inCustomizerContext:!1,settings:{},scopedSettings:{}}})},20683:(e,t,n)=>{"use strict";n.d(t,{m:()=>a});var i=n(95734),r=n(33072),o=n(9414);function a(e,t){var n,a=(n=i.useState(0)[1],function(){return n((function(e){return++e}))}),s=i.useContext(o.z).customizations,l=s.inCustomizerContext;return i.useEffect((function(){return l||r.X.observe(a),function(){l||r.X.unobserve(a)}}),[l]),r.X.getSettings(e,t,s)}},6657:(e,t,n)=>{"use strict";function i(e,t,n,i){return e.addEventListener(t,n,i),function(){return e.removeEventListener(t,n,i)}}n.d(t,{on:()=>i})},19440:(e,t,n)=>{"use strict";n.d(t,{SE:()=>I,lo:()=>x,vO:()=>m,Ep:()=>D,j5:()=>h,oR:()=>p,nA:()=>A,dm:()=>g,Cm:()=>f,eX:()=>y,yv:()=>v,Z5:()=>S,HC:()=>T,S0:()=>C,F2:()=>b,_l:()=>w});var i=n(97951),r=n(17875),o=n(30915),a=n(58086),s=n(98675),l="data-is-focusable",u="data-is-visible",d="data-focuszone-id",c="data-is-sub-focuszone";function h(e,t,n,i){return y(e,t,!0,!1,!1,n,void 0,void 0,void 0,i)}function g(e,t,n,i){return v(e,t,!0,!1,!0,n,void 0,void 0,i)}function p(e,t,n,i,r){return void 0===i&&(i=!0),y(e,t,i,!1,!1,n,!1,!0,void 0,r)}function f(e,t,n,i,r){return void 0===i&&(i=!0),v(e,t,i,!1,!0,n,!1,!0,r)}function m(e,t,n){var i=y(e,e,!0,!1,!1,!0,void 0,void 0,t,n);return!!i&&(x(i),!0)}function v(e,t,n,i,r,o,a,s,l){var u;if(!t||!a&&t===e)return null;var d=_(t);if(r&&d&&(o||!T(t)&&!S(t))){var c=v(e,t.lastElementChild||l&&(null===(u=t.shadowRoot)||void 0===u?void 0:u.lastElementChild),!0,!0,!0,o,a,s,l);if(c){if(s&&C(c,!0,l)||!s)return c;var h=v(e,c.previousElementSibling,!0,!0,!0,o,a,s,l);if(h)return h;for(var g=c.parentElement;g&&g!==t;){var p=v(e,g.previousElementSibling,!0,!0,!0,o,a,s,l);if(p)return p;g=g.parentElement}}}return n&&d&&C(t,s,l)?t:v(e,t.previousElementSibling,!0,!0,!0,o,a,s,l)||(i?null:v(e,t.parentElement,!0,!1,!1,o,a,s,l))}function y(e,t,n,i,r,o,a,s,l,u){var d;if(!t||t===e&&r&&!a)return null;var c=(l?b:_)(t);if(n&&c&&C(t,s,u))return t;if(!r&&c&&(o||!T(t)&&!S(t))){var h=y(e,t.firstElementChild||u&&(null===(d=t.shadowRoot)||void 0===d?void 0:d.firstElementChild),!0,!0,!1,o,a,s,l,u);if(h)return h}return t===e?null:y(e,t.nextElementSibling,!0,!0,!1,o,a,s,l,u)||(i?null:y(e,t.parentElement,!1,!1,!0,o,a,s,l,u))}function _(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute(u);return null!=t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function b(e,t){var n=null!=t?t:(0,a.z)();return!!e&&_(e)&&!e.hidden&&"hidden"!==n.getComputedStyle(e).visibility}function C(e,t,n){if(void 0===n&&(n=!0),!e||e.disabled)return!1;var i=0,r=null;e&&e.getAttribute&&(r=e.getAttribute("tabIndex"))&&(i=parseInt(r,10));var o=e.getAttribute?e.getAttribute(l):null,a=null!==r&&i>=0,s=!(!n||!e.shadowRoot||!e.shadowRoot.delegatesFocus),u=!!e&&"false"!==o&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||"true"===o||a||s);return t?-1!==i&&u:u}function T(e){return!!(e&&e.getAttribute&&e.getAttribute(d))}function S(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(c))}function I(e){var t=(0,s.Y)(e),n=t&&t.activeElement;return!(!n||!(0,r.s)(e,n))}function w(e,t,n){return"true"!==function(e,t,n){var r=(0,i.w)(e,(function(e){return e.hasAttribute(t)}),n);return r&&r.getAttribute(t)}(e,t,null!=n?n:(0,s.Y)())}var E=void 0;function x(e){if(e){var t=(0,a.z)(e);t&&(void 0!==E&&t.cancelAnimationFrame(E),E=t.requestAnimationFrame((function(){e&&e.focus(),E=void 0})))}}function A(e,t){for(var n=e,i=0,r=t;i<r.length;i++){var o=r[i],a=n.children[Math.min(o,n.children.length-1)];if(!a)break;n=a}return C(n)&&_(n)?n:y(e,n,!0)||v(e,n)}function D(e,t){for(var n=[];t&&e&&t!==e;){var i=(0,o.P)(t,!0);if(null===i)return[];n.unshift(Array.prototype.indexOf.call(i.children,t)),t=i}return n}},89416:(e,t,n)=>{"use strict";n.d(t,{O:()=>u});var i=n(58086),r=n(83702),o="__currentId__",a="id__",s=(0,i.z)()||{};void 0===s[o]&&(s[o]=0);var l=!1;function u(e){if(!l){var t=r.nr.getInstance();t&&t.onReset&&t.onReset(d),l=!0}var n=s[o]++;return(void 0===e?a:e)+n}function d(e){void 0===e&&(e=0),s[o]=e}},23401:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var i=n(30206);function r(e,t){for(var n=(0,i.__assign)({},t),r=0,o=Object.keys(e);r<o.length;r++){var a=o[r];void 0===n[a]&&(n[a]=e[a])}return n}},413:(e,t,n)=>{"use strict";n.d(t,{J5:()=>c,J9:()=>d});var i=n(83702),r=!1,o=0,a={empty:!0},s={},l="undefined"==typeof WeakMap?null:WeakMap;function u(){o++}function d(e,t,n){if(void 0===t&&(t=100),void 0===n&&(n=!1),!l)return e;if(!r){var d=i.nr.getInstance();d&&d.onReset&&i.nr.getInstance().onReset(u),r=!0}var c,g=0,p=o;return function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var l,u=c;(void 0===c||p!==o||t>0&&g>t)&&(c=h(),g=0,p=o),u=c;for(var d=0;d<i.length;d++){var f=(l=i[d])?"object"==typeof l||"function"==typeof l?l:(s[l]||(s[l]={val:l}),s[l]):a;u.map.has(f)||u.map.set(f,h()),u=u.map.get(f)}return u.hasOwnProperty("value")||(u.value=e.apply(void 0,i),g++),!n||null!==u.value&&void 0!==u.value||(u.value=e.apply(void 0,i)),u.value}}function c(e){if(!l)return e;var t=new l;return function(n){if(!n||"function"!=typeof n&&"object"!=typeof n)return e(n);if(t.has(n))return t.get(n);var i=e(n);return t.set(n,i),i}}function h(){return{map:l?new l:null}}},11192:(e,t,n)=>{"use strict";n.d(t,{q:()=>o});var i=n(98675),r=["TEMPLATE","STYLE","SCRIPT"];function o(e){var t=(0,i.Y)(e);if(!t)return function(){};for(var n=[];e!==t.body&&e.parentElement;){for(var o=0,a=e.parentElement.children;o<a.length;o++){var s=a[o],l=s.getAttribute("aria-hidden");s!==e&&"true"!==(null==l?void 0:l.toLowerCase())&&-1===r.indexOf(s.tagName)&&n.push([s,l])}e=e.parentElement}return n.forEach((function(e){e[0].setAttribute("aria-hidden","true")})),function(){!function(e){e.forEach((function(e){var t=e[0],n=e[1];n?t.setAttribute("aria-hidden",n):t.removeAttribute("aria-hidden")}))}(n),n=[]}}},67234:(e,t,n)=>{"use strict";function i(e,t){if(!e||!t)return!e&&!t;for(var n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||t[n]!==e[n]))return!1;for(var n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o.apply(this,[null,e].concat(t))}function o(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t=t||{};for(var r=0,o=n;r<o.length;r++){var a=o[r];if(a)for(var s in a)!a.hasOwnProperty(s)||e&&!e(s)||(t[s]=a[s])}return t}function a(e,t){var n={};for(var i in e)-1===t.indexOf(i)&&e.hasOwnProperty(i)&&(n[i]=e[i]);return n}n.d(t,{ab:()=>i,cJ:()=>a,kp:()=>r})},13668:(e,t,n)=>{"use strict";n.d(t,{Cq:()=>m,Cs:()=>w,Fo:()=>u,G1:()=>A,Gp:()=>I,JM:()=>x,P4:()=>c,QQ:()=>p,Qf:()=>S,Sg:()=>l,Sh:()=>f,al:()=>y,cr:()=>b,g0:()=>_,k3:()=>C,lA:()=>T,p3:()=>d,q6:()=>s,t0:()=>h,tK:()=>v,uw:()=>g,vt:()=>a,xM:()=>E});var i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},i=0,r=e;i<r.length;i++)for(var o=r[i],a=0,s=Array.isArray(o)?o:Object.keys(o);a<s.length;a++)n[s[a]]=1;return n},r=i(["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),o=i(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),a=i(o,r),s=i(a,["form"]),l=i(a,["height","loop","muted","preload","src","width"]),u=i(l,["poster"]),d=i(a,["start"]),c=i(a,["value"]),h=i(a,["download","href","hrefLang","media","rel","target","type"]),g=i(a,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),p=i(g,["accept","alt","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),f=i(g,["autoCapitalize","cols","dirname","form","maxLength","minLength","placeholder","readOnly","required","rows","wrap"]),m=i(g,["form","multiple","required"]),v=i(a,["selected","value"]),y=i(a,["cellPadding","cellSpacing"]),_=a,b=i(a,["rowSpan","scope"]),C=i(a,["colSpan","headers","rowSpan","scope"]),T=i(a,["span"]),S=i(a,["span"]),I=i(a,["acceptCharset","action","encType","encType","method","noValidate","target"]),w=i(a,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),E=i(a,["alt","crossOrigin","height","src","srcSet","useMap","width"]),x=a;function A(e,t,n){for(var i=Array.isArray(t),r={},o=0,a=Object.keys(e);o<a.length;o++){var s=a[o];!(!i&&t[s]||i&&t.indexOf(s)>=0||0===s.indexOf("data-")||0===s.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(s))||(r[s]=e[s])}return r}},24607:(e,t,n)=>{"use strict";n.d(t,{jI:()=>l});var i,r=n(98675),o=n(1048),a=n(38106),s="isRTL";function l(e){if(void 0===e&&(e={}),void 0!==e.rtl)return e.rtl;if(void 0===i){var t=(0,o.G)(s);null!==t&&function(e,t){void 0===t&&(t=!1);var n=(0,r.Y)();n&&n.documentElement.setAttribute("dir",e?"rtl":"ltr"),t&&(0,o.S)(s,e?"1":"0"),i=e,(0,a.DU)(i)}(i="1"===t);var n=(0,r.Y)();void 0===i&&n&&(i="rtl"===(n.body&&n.body.getAttribute("dir")||n.documentElement.getAttribute("dir")),(0,a.DU)(i))}return!!i}},98288:(e,t,n)=>{"use strict";n.d(t,{Hc:()=>u,XJ:()=>l});var i,r=n(98675),o=n(48614),a=n(58086),s=((0,o.Z)({overflow:"hidden !important"}),"data-is-scrollable");function l(e){if(void 0===i){var t=null!=e?e:(0,r.Y)(),n=t.createElement("div");n.style.setProperty("width","100px"),n.style.setProperty("height","100px"),n.style.setProperty("overflow","scroll"),n.style.setProperty("position","absolute"),n.style.setProperty("top","-9999px"),t.body.appendChild(n),i=n.offsetWidth-n.clientWidth,t.body.removeChild(n)}return i}function u(e){for(var t=e,n=(0,r.Y)(e);t&&t!==n.body;){if("true"===t.getAttribute(s))return t;t=t.parentElement}for(t=e;t&&t!==n.body;){if("false"!==t.getAttribute(s)){var i=getComputedStyle(t),o=i?i.getPropertyValue("overflow-y"):"";if(o&&("scroll"===o||"auto"===o))return t}t=t.parentElement}return t&&t!==n.body||(t=(0,a.z)(e)),t}},39977:(e,t,n)=>{"use strict";n.d(t,{Fy:()=>s,Y2:()=>r});var i=n(58086),r="ms-Fabric--isFocusVisible",o="ms-Fabric--isFocusHidden";function a(e,t){e&&(e.classList.add(t?r:o),e.classList.remove(t?o:r))}function s(e,t,n){var r;n?n.forEach((function(t){return a(t.current,e)})):a(null===(r=(0,i.z)(t))||void 0===r?void 0:r.document.body,e)}},47126:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var i=n(95734),r=n(31860),o=function(){return!1},a=function(){},s=i.createContext({stylesheets:new Map,useAdoptedStylesheetEx:o,useAdoptedStylesheet:o,useShadowConfig:function(){return r.ou},useMergeStylesShadowRootContext:a,useHasMergeStylesShadowRootContext:o,useMergeStylesRootStylesheets:function(){return new Map},useWindow:a,useStyled:a}),l=function(){var e=i.useContext(s);return{useAdoptedStylesheet:e.useAdoptedStylesheet,useAdoptedStylesheetEx:e.useAdoptedStylesheetEx,useShadowConfig:e.useShadowConfig,useMergeStylesShadowRootContext:e.useMergeStylesShadowRootContext,useHasMergeStylesShadowRootContext:e.useHasMergeStylesShadowRootContext,useMergeStylesRootStylesheets:e.useMergeStylesRootStylesheets,useWindow:e.useWindow,useStyled:e.useStyled}}},82330:(e,t,n)=>{"use strict";n.d(t,{I:()=>u});var i=n(30206),r=n(95734),o=n(17596),a=n(47126),s=n(20683),l=["theme","styles"];function u(e,t,n,u,d){var c=(u=u||{scope:"",fields:void 0}).scope,h=u.fields,g=void 0===h?l:h,p=r.forwardRef((function(l,u){var d=r.useRef(),h=(0,s.m)(g,c),p=h.styles,f=(h.dir,(0,i.__rest)(h,["styles","dir"])),m=n?n(l):void 0,v=(0,a.A)().useStyled,y=d.current&&d.current.__cachedInputs__||[],_=l.styles;if(!d.current||p!==y[1]||_!==y[2]){var b=function(e){return(0,o.p)(e,t,p,_)};b.__cachedInputs__=[t,p,_],b.__noStyleOverride__=!p&&!_,d.current=b}return d.current.__shadowConfig__=v(c),r.createElement(e,(0,i.__assign)({ref:u},f,m,l,{styles:d.current}))}));p.displayName="Styled".concat(e.displayName||e.name);var f=d?r.memo(p):p;return p.displayName&&(f.displayName=p.displayName),f}},52302:(e,t,n)=>{"use strict";n.d(t,{MO:()=>f,dM:()=>p});var i,r=n(95734),o=n(58086),a=n(91578),s=((i={})[a.c.up]=1,i[a.c.down]=1,i[a.c.left]=1,i[a.c.right]=1,i[a.c.home]=1,i[a.c.end]=1,i[a.c.tab]=1,i[a.c.pageUp]=1,i[a.c.pageDown]=1,i);function l(e){return!!s[e]}var u=n(39977),d=new WeakMap,c=new WeakMap;function h(e,t){var n,i=d.get(e);return n=i?i+t:1,d.set(e,n),n}function g(e){var t=c.get(e);return t||(t={onMouseDown:function(t){return m(t,e.registeredProviders)},onPointerDown:function(t){return v(t,e.registeredProviders)},onKeyDown:function(t){return y(t,e.registeredProviders)},onKeyUp:function(t){return _(t,e.registeredProviders)}},c.set(e,t),t)}var p=r.createContext(void 0),f=function(e){var t,n;return t=e.rootRef,n=r.useContext(p),r.useEffect((function(){var e,i,r,a,s=(0,o.z)(null==t?void 0:t.current);if(s&&!0!==(null===(e=s.FabricConfig)||void 0===e?void 0:e.disableFocusRects)){var l,u,d,c,p=s;if((null===(i=null==n?void 0:n.providerRef)||void 0===i?void 0:i.current)&&(null===(a=null===(r=null==n?void 0:n.providerRef)||void 0===r?void 0:r.current)||void 0===a?void 0:a.addEventListener)){p=n.providerRef.current;var f=g(n);l=f.onMouseDown,u=f.onPointerDown,d=f.onKeyDown,c=f.onKeyUp}else l=m,u=v,d=y,c=_;var b=h(p,1);return b<=1&&(p.addEventListener("mousedown",l,!0),p.addEventListener("pointerdown",u,!0),p.addEventListener("keydown",d,!0),p.addEventListener("keyup",c,!0)),function(){var e;s&&!0!==(null===(e=s.FabricConfig)||void 0===e?void 0:e.disableFocusRects)&&0===(b=h(p,-1))&&(p.removeEventListener("mousedown",l,!0),p.removeEventListener("pointerdown",u,!0),p.removeEventListener("keydown",d,!0),p.removeEventListener("keyup",c,!0))}}}),[n,t]),null};function m(e,t){(0,u.Fy)(!1,e.target,t)}function v(e,t){"mouse"!==e.pointerType&&(0,u.Fy)(!1,e.target,t)}function y(e,t){l(e.which)&&(0,u.Fy)(!0,e.target,t)}function _(e,t){l(e.which)&&(0,u.Fy)(!0,e.target,t)}},66e3:(e,t,n)=>{"use strict";n.d(t,{E:()=>r});var i=n(95734),r=(0,n(68781).S)()?i.useLayoutEffect:i.useEffect},17570:(e,t,n)=>{"use strict";var i;n.d(t,{CV:()=>r,N:()=>o});var r=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}();function o(){if(!i){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));i=new r(e.join(""))}return i}},109:(e,t,n)=>{"use strict";function i(e,t,n){return a(e,1,t,n)}function r(e,t,n){return a(e,2,t,n)}function o(e,t,n){return a(e,0,t,n)}function a(e,t,n,i){return{name:e,dataType:t,value:n,classification:i||4}}n.d(t,{LK:()=>i,Ug:()=>r,m9:()=>o})},59834:(e,t,n)=>{"use strict";var i;n.d(t,{o:()=>i}),function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(i||(i={}))},7313:(e,t,n)=>{"use strict";n.d(t,{S:()=>l});var i=n(95734),r=n(44626),o=n(68803),a=n(34034),s=n(20193);class l extends i.PureComponent{constructor(){super(...arguments),this.divRef=i.createRef()}isFocusWithin(){const e=this.divRef.current;return!!e&&(e===document.activeElement||e.contains(document.activeElement))}render(){return i.createElement(s.q.Consumer,null,(e=>i.createElement("div",Object.assign({},this.getRootDivAttributes(e),{ref:this.divRef}),this.props.children)))}focus(e){var t,n,i;e&&(null===(n=null===(t=this.divRef.current)||void 0===t?void 0:t.children[e])||void 0===n||n.focus()),null===(i=this.divRef.current)||void 0===i||i.focus()}el(){return this.divRef.current}getChildItem(e,t=0){const n=this.el(),i=null==n?void 0:n.querySelectorAll(e);return(null==i?void 0:i.length)&&(null==i?void 0:i.length)>=t+1?i[t]:null}getRootDivAttributes(e){const t={style:this.computeStyles(this.props.style,e)};return r.tO(this.props,t),this.props.accessible?(t["aria-hidden"]=!1,t["aria-label"]=this.props.accessibilityLabel,t.role=this.getAccessibilityRole()):!1===this.props.accessible&&(t["aria-hidden"]=!0),void 0!==this.props.accessibleLive&&(t["aria-live"]=this.getAriaLive()),this.props.focusable&&(t.tabIndex=0),this.props.onFocus&&(t.onFocus=this.props.onFocus),t.id=this.props.nativeID,t}computeStyles(e,t){const n={display:"flex",paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0};switch(this.props.direction===o.PR.LeftToRight?n.flexDirection="row":n.flexDirection="column",this.props.align){case o.j5.Stretch:n.alignItems="stretch";break;case o.j5.Center:n.alignItems="center";break;case o.j5.Baseline:n.alignItems="baseline";break;default:n.alignItems="flex-start"}switch(this.props.justifyContent){case o.Pr.Center:n.justifyContent="center";break;case o.Pr.End:n.justifyContent="flex-end";break;case o.Pr.SpaceBetween:n.justifyContent="space-between";break;default:n.justifyContent="flex-start"}if(e){switch(e.flexibleSize&&(n.flexGrow=1,n.flexShrink=1),void 0!==e.paddingStart&&(n.paddingLeft=t?e.paddingEnd:e.paddingStart),void 0!==e.paddingEnd&&(n.paddingRight=t?e.paddingStart:e.paddingEnd),void 0!==e.paddingHorizontal&&(n.paddingRight=e.paddingHorizontal,n.paddingLeft=e.paddingHorizontal),void 0!==e.paddingTop&&(n.paddingTop=e.paddingTop),void 0!==e.paddingBottom&&(n.paddingBottom=e.paddingBottom),void 0!==e.paddingVertical&&(n.paddingTop=n.paddingTop||0+e.paddingVertical,n.paddingBottom=n.paddingBottom||0+e.paddingVertical),void 0!==e.marginTop&&(n.marginTop=e.marginTop),void 0!==e.marginBottom&&(n.marginBottom=e.marginBottom),void 0!==e.marginVertical&&(n.marginTop=(e.marginTop||0)+e.marginVertical,n.marginBottom=(e.marginBottom||0)+e.marginVertical),t?(void 0!==e.marginStart&&(n.marginRight=e.marginStart),void 0!==e.marginEnd&&(n.marginLeft=e.marginEnd)):(void 0!==e.marginStart&&(n.marginLeft=e.marginStart),void 0!==e.marginEnd&&(n.marginRight=e.marginEnd)),void 0!==e.marginHorizontal&&(n.marginLeft=(t?e.marginEnd||0:e.marginStart||0)+e.marginHorizontal,n.marginRight=(t?e.marginStart||0:e.marginEnd||0)+e.marginHorizontal),void 0!==e.gap&&(n.gap=e.gap),void 0!==e.maxWidth&&(n.maxWidth=e.maxWidth),void 0!==e.minWidth&&(n.minWidth=e.minWidth),void 0!==e.width&&(n.width=e.width),void 0!==e.minHeight&&(n.minHeight=e.minHeight),void 0!==e.maxHeight&&(n.maxHeight=e.maxHeight),void 0!==e.height&&(n.height=e.height),e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.backgroundImage&&(n.backgroundImage=e.backgroundImage),void 0!==e.borderColor&&(n.borderColor=e.borderColor),void 0!==e.borderStyle&&(n.borderStyle=e.borderStyle),typeof e.borderWidth){case"number":n.borderWidth=e.borderWidth;break;case"object":n.borderTopWidth=e.borderWidth.top,n.borderRightWidth=t?e.borderWidth.start:e.borderWidth.end,n.borderBottomWidth=e.borderWidth.bottom,n.borderLeftWidth=t?e.borderWidth.end:e.borderWidth.start}switch(typeof e.borderRadius){case"number":n.borderRadius=(0,a.W)(e);break;case"object":const i=(0,a.W)(e,"topStart",0),r=(0,a.W)(e,"topEnd",0),o=(0,a.W)(e,"bottomStart",0),s=(0,a.W)(e,"bottomEnd",0);n.borderTopLeftRadius=t?r:i,n.borderTopRightRadius=t?i:r,n.borderBottomRightRadius=t?o:s,n.borderBottomLeftRadius=t?s:o}e.hideFocusBox&&(n.outline="none"),e.transform&&(n.transform=e.transform),void 0!==e.zIndex&&(n.zIndex=e.zIndex),e.position&&(n.position=e.position),(e.top||0===e.top)&&(n.top=e.top),(e.bottom||0===e.bottom)&&(n.bottom=e.bottom),(e.right||0===e.right)&&(n.right=e.right),(e.left||0===e.left)&&(n.left=e.left),e.overflow&&(n.overflow=e.overflow),e.boxShadow&&(n.boxShadow=e.boxShadow)}return n}getAccessibilityRole(){switch(this.props.accessibilityRole){case"list":case"listbox":case"menu":case"tablist":case"application":return this.props.accessibilityRole;default:return"group"}}getAriaLive(){return this.props.accessibleLive===o.pq.Polite?"polite":void 0}}},68803:(e,t,n)=>{"use strict";var i,r,o,a;n.d(t,{PR:()=>i,Pr:()=>o,j5:()=>r,pq:()=>a}),function(e){e[e.TopToBottom=0]="TopToBottom",e[e.LeftToRight=1]="LeftToRight"}(i||(i={})),function(e){e[e.Start=0]="Start",e[e.Stretch=1]="Stretch",e[e.Baseline=2]="Baseline",e[e.Center=3]="Center"}(r||(r={})),function(e){e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.SpaceBetween=2]="SpaceBetween",e[e.End=3]="End"}(o||(o={})),function(e){e[e.Polite=0]="Polite",e[e.Off=1]="Off"}(a||(a={}))},78585:(e,t,n)=>{"use strict";n.d(t,{c:()=>l});var i=n(95734),r=n(86399);class o extends i.PureComponent{constructor(e){super(e),this.state={focused:!1},this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this)}getRunText(e,t){const n=this.props.text.length,i=Math.max(0,Math.min(n,e)),r=Math.max(0,Math.min(n,t));return i<r?this.props.text.substr(i,r-i):""}renderTextRuns(){const e=[];if(this.props.formatting&&this.props.formatting.length>0){let t=0,n=0;const i=this.props.text.length;for(;t<i;)if(n<this.props.formatting.length){const r=this.props.formatting[n],o=r.start,a=o+r.length,s=Math.max(t,Math.min(i,o)),l=Math.max(t,Math.min(i,a));if(s>=l){n+=1;continue}t<s&&(e.push(this.renderTextRun(t,s)),t=s),t<l&&(e.push(this.renderTextRun(t,l,r)),t=l),n+=1}else t<i&&(e.push(this.renderTextRun(t,i)),t=i)}return e}onFocus(){this.setState({focused:!0})}onBlur(){this.setState({focused:!1})}computeTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:o.defaultTheme}computeBorderColor(){const e=this.computeTheme();return this.state.focused?e.focusRing:e.border}computePadding(e){var t,n,i,r,o,a;const s=null!==(t=this.props.style)&&void 0!==t?t:{},l=null!==(i=null===(n=this.props.style)||void 0===n?void 0:n.padding)&&void 0!==i?i:this.props.focusable?1:0,u=(null!==(r=s[e])&&void 0!==r?r:0)+l,d=null!==(a=null===(o=this.props.style)||void 0===o?void 0:o.borderWidth)&&void 0!==a?a:this.props.focusable?1:0;return void 0!==this.computeBorderColor()?u:u+d}computeMargin(e){var t,n,i;const r=null!==(t=this.props.style)&&void 0!==t?t:{};return(null!==(n=r[e])&&void 0!==n?n:0)+(null!==(i=r["marginStart"===e||"marginEnd"===e?"marginHorizontal":"marginVertical"])&&void 0!==i?i:0)}computeBorderWidth(){var e,t;const n=null!==(t=null===(e=this.props.style)||void 0===e?void 0:e.borderWidth)&&void 0!==t?t:this.props.focusable?1:0;return void 0!==this.computeBorderColor()?n:0}getAccessibilityLabel(){return this.props.accessibilityHidden?void 0:this.props.accessibilityLabel?this.props.accessibilityLabel:this.props.text}}o.defaultTheme={focusRing:"#000000"},o.baseFontWeightValuesByType={[r.IT.Bold]:"bold",[r.IT.Normal]:"normal"};var a=n(87123),s=n(20193);class l extends o{constructor(){super(...arguments),this.spanRef=i.createRef()}render(){const e={},t=this.renderTextRuns();if(this.props.focusable&&(e.tabIndex=0,e.onFocus=this.onFocus,e.onBlur=this.onBlur),this.props.onHeightChange&&this.spanRef.current){const e=this.spanRef.current.getBoundingClientRect().height,t=this.computeMargin("marginTop"),n=this.computeMargin("marginBottom");this.props.onHeightChange(e+n+t)}return i.createElement(s.q.Consumer,null,(n=>i.createElement("span",Object.assign({},e,{ref:this.spanRef,style:this.renderRootFormatting(this.props.style,n,t.length>0),"aria-hidden":this.props.accessibilityHidden,"aria-posinset":this.props.accessibilityPositionInSet,"aria-setsize":this.props.accessibilitySetSize,"aria-label":0===t.length?this.getAccessibilityLabel():void 0,"aria-level":this.props.accessibilityHidden||"heading"!==this.props.accessibilityRole?void 0:1,role:this.props.accessibilityHidden?void 0:this.getAccessibilityRole(),"data-automation-id":this.props.accessibilityHidden?void 0:this.props.automationLabel}),0!==t.length?t:this.props.text)))}focus(){this.props.focusable&&this.spanRef.current&&this.spanRef.current.focus()}renderTextRun(e,t,n){return(null==n?void 0:n.hyperlink)?i.createElement(a.R,Object.assign({},n.hyperlink)):i.createElement("span",{key:e,style:this.renderFormatting(n)},this.getRunText(e,t))}computeTheme(){const e=super.computeTheme();return delete e.focusRing,e}renderBold(e,t){e.fontWeight=l.fontWeightValueByType[t]}renderUnderline(e,t){let n=!1;switch(t){case r.RV.Single:e.textDecorationLine="underline",e.textDecorationSkipInk="none";break;case r.RV.Double:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmRvdWJsZV9saW5lPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImRvdWJsZV9saW5lIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiPgogICAgICAgIDxnIGlkPSJUaWxlLUNvcHkiIHN0cm9rZT0iIzAwMDAwMCI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",n=!0;break;case r.RV.SpellingSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjRweCIgdmlld0JveD0iMCAwIDUgNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTYuMiAoODE2NzIpIC0gaHR0cHM6Ly9za2V0Y2guY29tIC0tPgogICAgPHRpdGxlPnNwZWxsaW5nX3NxdWlnZ2xlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkZsYWdzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTAxMC4wMDAwMDAsIC0yOTYuMDAwMDAwKSIgaWQ9InNwZWxsaW5nX3NxdWlnZ2xlIj4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAxMC4wMDAwMDAsIDI5Ni4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDMgQzEuMjUsMyAxLjI1LDEgMi41LDEgQzMuNzUsMSAzLjc1LDMgNSwzIiBpZD0iUGF0aCIgc3Ryb2tlPSIjRUIwMDAwIiBzdHJva2Utd2lkdGg9IjEiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",n=!0;break;case r.RV.GrammarSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmdyYW1tYXJfZG91YmxlX2xpbmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZ3JhbW1hcl9kb3VibGVfbGluZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iR3JhbW1hci1UaWxlLUNvcHkiIHN0cm9rZT0iIzMzNTVGRiI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",n=!0;break;case r.RV.CritiqueSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTBweCIgaGVpZ2h0PSIycHgiIHZpZXdCb3g9IjAgMCAxMCAyIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1Ny4xICg4MzA4OCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+aW5zaWdodF90ZXh0dXJlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Imluc2lnaHRfdGV4dHVyZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikdyb3VwLTItQ29weSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIyIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xLDEgTDUsMSIgaWQ9IkxpbmUtNCIgc3Ryb2tlPSIjNzE2MEU4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",n=!0}n&&(e.backgroundRepeat="repeat-x",e.backgroundPosition="bottom left",e.borderBottom="solid 1px transparent")}renderFormatting(e){const t={};return(null==e?void 0:e.fontWeight)&&this.renderBold(t,e.fontWeight),t.fontFamily=null==e?void 0:e.fontFamily,t.fontSize=null==e?void 0:e.fontSize,t.fontStyle=(null==e?void 0:e.italic)?"italic":void 0,t.color=null==e?void 0:e.cssColor,(null==e?void 0:e.underlineType)&&this.renderUnderline(t,e.underlineType),(null==e?void 0:e.lineHeight)&&(t.lineHeight=e.lineHeight+"px"),(null==e?void 0:e.wrapMode)===r.bd.NoWrap?t.whiteSpace="nowrap":(t.whiteSpace="normal",t.overflowWrap="anywhere"),(null==e?void 0:e.highlightColor)&&(t.background=null==e?void 0:e.highlightColor,(null==e?void 0:e.highlightRadius)&&(t.borderRadius=e.highlightRadius+"px")),t.paddingLeft=null==e?void 0:e.paddingHorizontal,t.paddingRight=null==e?void 0:e.paddingHorizontal,t.marginLeft=null==e?void 0:e.marginHorizontal,t.marginRight=null==e?void 0:e.marginHorizontal,t}renderRootFormatting(e,t,n){var i;const r=this.computeTheme(),o=this.renderFormatting(e),a=this.computeMargin("marginStart"),s=this.computeMargin("marginEnd");return o.backgroundColor=r.background,o.paddingLeft=this.computePadding("paddingHorizontal"),o.paddingRight=this.computePadding("paddingHorizontal"),o.paddingTop=this.computePadding("paddingVertical"),o.paddingBottom=this.computePadding("paddingVertical"),o.marginLeft=t?s:a,o.marginRight=t?a:s,o.marginTop=this.computeMargin("marginTop"),o.marginBottom=this.computeMargin("marginBottom"),o.borderWidth=this.computeBorderWidth(),o.borderColor=this.computeBorderColor(),o.borderRadius=null===(i=this.props.style)||void 0===i?void 0:i.borderRadius,o.borderStyle="solid",o.width=null==e?void 0:e.width,o.height=null==e?void 0:e.height,o.textAlign=null==e?void 0:e.textAlign,void 0!==(null==e?void 0:e.userSelectable)&&(o.userSelect=e.userSelectable?"auto":"none"),(null==e?void 0:e.truncate)&&(o.overflow="hidden",o.textOverflow="ellipsis",o.whiteSpace="nowrap",n&&(o.display="-webkit-box",o.WebkitLineClamp=1,o["-webkit-box-orient"]="vertical")),o}getAccessibilityRole(){return"heading"===this.props.accessibilityRole?this.props.accessibilityRole:"text"}}l.fontWeightValueByType=Object.assign(Object.assign({},o.baseFontWeightValuesByType),{[r.IT.SemiBold]:600})},86399:(e,t,n)=>{"use strict";var i,r,o;n.d(t,{IT:()=>i,RV:()=>r,bd:()=>o}),function(e){e[e.Normal=0]="Normal",e[e.Bold=1]="Bold",e[e.SemiBold=2]="SemiBold"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SpellingSquiggle=3]="SpellingSquiggle",e[e.GrammarSquiggle=4]="GrammarSquiggle",e[e.CritiqueSquiggle=5]="CritiqueSquiggle"}(r||(r={})),function(e){e[e.Normal=0]="Normal",e[e.NoWrap=1]="NoWrap"}(o||(o={}))},87123:(e,t,n)=>{"use strict";n.d(t,{R:()=>T});var i=n(95734),r=n(36216),o=n(48701);const a=i.createContext(void 0);a.Provider;var s=n(35985);const l=i.createContext(void 0),u={inline:!1},d=(l.Provider,(e,t)=>{const n=i.useContext(a),{inline:d}=null!==(c=i.useContext(l))&&void 0!==c?c:u;var c;const{appearance:h="default",disabled:g=!1,disabledFocusable:p=!1,inline:f=!1}=e,m=e.as||(e.href?"a":"button"),v={role:"span"===m?"button":void 0,type:"button"===m?"button":void 0,...e,as:m},y={appearance:h,disabled:g,disabledFocusable:p,inline:null!=f?f:!!d,components:{root:m},root:r.Gk((0,o.g)(m,{ref:t,...v}),{elementType:m}),backgroundAppearance:n};return(e=>{const{disabled:t,disabledFocusable:n}=e,{onClick:i,onKeyDown:r,role:o,tabIndex:a}=e.root;"a"===e.root.as&&(e.root.href=t?void 0:e.root.href,(t||n)&&(e.root.role=o||"link")),"a"!==e.root.as&&"span"!==e.root.as||(e.root.tabIndex=null!=a?a:t&&!n?void 0:0),e.root.onClick=e=>{t||n?e.preventDefault():null==i||i(e)},e.root.onKeyDown=i=>{const o=i.key===s.xyI||i.key===s.$xS;(t||n)&&o?(i.preventDefault(),i.stopPropagation()):(null==r||r(i),"span"===e.root.as&&e.root.onClick&&!r&&o&&(i.preventDefault(),i.currentTarget.click()))},e.disabled=t||n,e.root["aria-disabled"]=t||n||void 0,"button"===e.root.as&&(e.root.disabled=t&&!n)})(y),y});var c=n(27760),h=n(63649);const g=(0,c.X)({focusIndicator:{Bttzg6e:"fhgqx19",B3uz8dt:"f1olyrje",B6ihwck:"f1p93eir",g9k6zt:"f1nev41a"},root:{B486eqv:"f2hkw1w",De3pzq:"f3rmtva",B7ck84d:"f1ewtqcl",sj55zd:"fyind8e",Bceei9c:"f1k6fduh",mc9l5x:"f1w7gpdv",Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1s184ao",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai",B68tc82:0,Bmxbyg5:0,Bpg54ce:"fnbmjn9",fsow6f:["f1o700av","fes3tcz"],w71qe1:"f1iuv45f",Bkioxbp:"f1cmlufx",ygn44y:"f9n3di6",famaaq:"f1ids18y",Bde5pd6:"f1tx3yz7",Bi91k9c:"f1deo86v",i089h6:"f1eh06m1",lj723h:"f1iescvh"},button:{icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],oivjwe:"f1h8hb77",wvpqe5:["f1deefiw","f1n71otn"]},href:{Be2twd7:"fjoy568"},subtle:{sj55zd:"fkfq4zb",Bde5pd6:"f1tx3yz7",Bi91k9c:"fnwyq0v",i089h6:"f1eh06m1",lj723h:"flvvhsy"},inline:{w71qe1:"f13mvf36"},disabled:{w71qe1:"f1iuv45f",sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bde5pd6:"fbnuktb",Bi91k9c:"fvgxktp",i089h6:"fljg2da",lj723h:"f19wldhg"},inverted:{sj55zd:"f1qz2gb0",Bi91k9c:"f1mlt8il",lj723h:"f1hsd4st"}},{d:[".fhgqx19[data-fui-focus-visible]{text-decoration-color:var(--colorStrokeFocus2);}",".f1olyrje[data-fui-focus-visible]{text-decoration-line:underline;}",".f1p93eir[data-fui-focus-visible]{text-decoration-style:double;}",".f1nev41a[data-fui-focus-visible]{outline-style:none;}",".f3rmtva{background-color:transparent;}",".f1ewtqcl{box-sizing:border-box;}",".fyind8e{color:var(--colorBrandForegroundLink);}",".f1k6fduh{cursor:pointer;}",".f1w7gpdv{display:inline;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",[".f1s184ao{margin:0;}",{p:-1}],[".f1mk8lai{padding:0;}",{p:-1}],[".fnbmjn9{overflow:inherit;}",{p:-1}],".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".f1iuv45f{text-decoration-line:none;}",".f1cmlufx{text-decoration-thickness:var(--strokeWidthThin);}",".f9n3di6{text-overflow:inherit;}",".f1ids18y{-webkit-user-select:text;-moz-user-select:text;user-select:text;}",".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1h8hb77{border-bottom-style:none;}",".fjoy568{font-size:inherit;}",".fkfq4zb{color:var(--colorNeutralForeground2);}",".f13mvf36{text-decoration-line:underline;}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f1qz2gb0{color:var(--colorBrandForegroundInverted);}"],i:[".f2hkw1w:focus-visible{outline-style:none;}"],h:[".f1tx3yz7:hover{text-decoration-line:underline;}",".f1deo86v:hover{color:var(--colorBrandForegroundLinkHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".fbnuktb:hover{text-decoration-line:none;}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".f1mlt8il:hover{color:var(--colorBrandForegroundInvertedHover);}"],a:[".f1eh06m1:active{text-decoration-line:underline;}",".f1iescvh:active{color:var(--colorBrandForegroundLinkPressed);}",".flvvhsy:active{color:var(--colorNeutralForeground2Pressed);}",".fljg2da:active{text-decoration-line:none;}",".f19wldhg:active{color:var(--colorNeutralForegroundDisabled);}",".f1hsd4st:active{color:var(--colorBrandForegroundInvertedPressed);}"]});var p=n(60839),f=n(18861),m=n(34877);const v=i.forwardRef(((e,t)=>{const n=d(e,t);return(e=>{const t=g(),{appearance:n,disabled:i,inline:r,root:o,backgroundAppearance:a}=e;e.root.className=(0,h.z)("fui-Link",t.root,t.focusIndicator,"a"===o.as&&o.href&&t.href,"button"===o.as&&t.button,"subtle"===n&&t.subtle,"inverted"===a&&t.inverted,r&&t.inline,i&&t.disabled,e.root.className)})(n),(0,m.$e)("useLinkStyles_unstable")(n),(e=>((0,f.C)(e),(0,p.Y)(e.root,{})))(n)}));v.displayName="Link";var y=n(78585),_=n(86399);class b extends i.PureComponent{constructor(e){super(e),this.state={isFocused:!1,isHovered:!1,isPressed:!1},this.onFocus=this.onFocus.bind(this),this.onBlur=this.onBlur.bind(this),this.onHoverIn=this.onHoverIn.bind(this),this.onHoverOut=this.onHoverOut.bind(this),this.onPressIn=this.onPressIn.bind(this),this.onPressOut=this.onPressOut.bind(this)}computeTextColor(){const e=this.props.theme;return this.state.isPressed&&(null==e?void 0:e.pressedColor)?null==e?void 0:e.pressedColor:this.state.isHovered&&(null==e?void 0:e.hoverColor)?null==e?void 0:e.hoverColor:this.state.isFocused&&(null==e?void 0:e.focusColor)?null==e?void 0:e.focusColor:null==e?void 0:e.color}computeTextStyling(){var e;const t=this.props.style;return{fontSize:t.fontSize,fontWeight:t.fontWeight,cssColor:this.computeTextColor(),underlineType:null!==(e=this.props.style.underlineType)&&void 0!==e?e:_.RV.Single}}renderContents(){return this.props.text?i.createElement(y.c,{text:this.props.text,style:this.props.theme||this.props.style?this.computeTextStyling():void 0}):void 0}onFocus(){this.setState({isFocused:!0})}onBlur(){this.setState({isFocused:!1})}onHoverIn(){this.setState({isHovered:!0})}onHoverOut(){this.setState({isHovered:!1})}onPressIn(){this.setState({isPressed:!0})}onPressOut(){this.setState({isPressed:!1})}}var C=n(16971);class T extends b{constructor(e){super(e)}render(){const{inline:e,url:t,text:n,onClick:r}=this.props;return this.context?i.createElement("div",{style:{display:e?"inline-flex":"block"}},i.createElement(v,{target:"_blank",href:t,style:{boxShadow:"none"},onClick:r},n?i.createElement(y.c,{text:n,style:Object.assign(Object.assign({},this.computeTextStyling()),{cssColor:void 0})}):void 0)):i.createElement("div",{style:{display:e?"inline-flex":"block"}},i.createElement(v,{target:"_blank",href:t,style:this.getStyle(),onMouseEnter:this.onHoverIn,onMouseLeave:this.onHoverOut,onPointerDown:this.onPressIn,onPointerUp:this.onPressOut,onFocus:this.onFocus,onBlur:this.onBlur},this.renderContents()))}getStyle(){return{color:this.computeTextColor(),boxShadow:"none"}}}T.contextType=C.O},90970:(e,t,n)=>{"use strict";n.d(t,{q:()=>r,w:()=>o});var i=n(44207);const r=(e,t)=>void 0!==o(e,t),o=(e,t)=>{const n=`${e}Filled`;return t&&(0,i.sW)(n)?n:(0,i.sW)(e)?e:void 0}},8773:(e,t,n)=>{"use strict";n.d(t,{X:()=>i,Z:()=>r});const i={};function r(e,t){i[e]=t}},96895:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var i=n(95734),r=n(8773),o=n(20193),a=n(90992);function s(e){var t,n;const s=i.useContext(o.q),l=e.type,u=r.X[l];let d;return s&&(d=e.filled&&null!==(t=u.rtlFilled)&&void 0!==t?t:u.rtlRegular),void 0===d&&(d=e.filled&&null!==(n=u.filled)&&void 0!==n?n:u.regular),i.createElement(d,Object.assign({},(0,a.Vm)(e),{pointerEvents:"none"}))}},90992:(e,t,n)=>{"use strict";n.d(t,{Vm:()=>d,j2:()=>l,ku:()=>u});var i=n(78585),r=n(16895),o=n(8773);const a=["Accept","Accessibility","AddToDictionary","ArrowReset","BowTie","Cancel","Checkmark","Cloud","Color","Completed","Copy","Delete","EditorSettings","FirstRowAsHeader","Hide","GiveFeedback","Ignore","IgnoreAll","IgnoreRule","Info","MergeCells","Next","Overflow","Plus","PremiumDiamond","Previous","ReadAloud","ShowExplanation","SplitCells"],s=[...a,"AddBot","AddPeople","Apps","ArrowUpload","ChatBubblesQuestion","Dislike","DropdownChevron","ECCFeedback","Emails","ErrorBadge","Event","EventRecorded","EventSeries","FFXCBulletedList","FFXCCallout","FFXCChecklist","FFXCCodeBlock","FFXCCompleted","FFXCInsertTextBox","FFXCKanbanBoard","FFXCNumberedList","FFXQuestionAnswer","FFXCQuote","FFXCRetroBoard","FFXCStatusTracker","FFXCTable","FFXCVote","Files","Hashtag","Laptop","Location","Like","Link","Meeting","Member","People","Person","PhoneNumber","Record","Repeat","Sparkle","TeamsChat","Undo","Upload"],l=(e,t)=>t?a.some((t=>t===e)):s.some((t=>t===e)),u=e=>void 0!==o.X[e],d=e=>{const{primaryColor:t,fontWeight:n,style:o,fontSize:a}=e;return{primaryFill:t,color:t,"aria-hidden":"true",fontSize:null!=a?a:r.Q.fontSize,style:Object.assign({fontSize:null!=a?a:r.Q.fontSize,margin:null==o?void 0:o.margin},o),fontWeight:n?i.c.fontWeightValueByType[n]:r.Q.fontWeight}}},57794:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var i=n(95734),r=n(87579),o=n(90992);function a(e){return i.createElement(r.iNx,Object.assign({},(0,o.Vm)(Object.assign(Object.assign({},e),{primaryColor:"transparent"}))))}},97782:(e,t,n)=>{"use strict";n.d(t,{I:()=>f});var i=n(95734),r=n(16971),o=n(92968),a=n(90970),s=n(90298);function l(e){return i.createElement(s.l8,{iconName:(0,a.w)(e.type,e.filled),style:(0,o.MD)(e),"aria-hidden":!0})}var u=n(90992),d=n(57794),c=n(96895),h=n(66466);const g=i.lazy((()=>Promise.all([n.e(1804),n.e(1519)]).then(n.bind(n,38481)))),p=i.lazy((()=>n.e(490).then(n.bind(n,74475))));class f extends i.Component{static shouldRender(e,t){return(0,h.R)(e,t)}static shouldRenderTypeName(e,t,n){return!!((0,u.j2)(e)||(0,u.ku)(e)||(0,o.tv)(e))||!(null==n?void 0:n.useFluentV9)&&(0,a.q)(e,t)}render(){const e=!!this.context;return f.shouldRender(this.props,{useFluentV9:e})?i.createElement(m,Object.assign({},this.props)):null}}f.contextType=r.O;const m=e=>{const t=i.useContext(r.O),n=i.useContext(r.b),s="Upload"===e.type&&n;return(0,u.j2)(e.type)&&!s?i.createElement(i.Suspense,{fallback:i.createElement(d.A,Object.assign({},e))},i.createElement(g,Object.assign({},e))):(0,u.ku)(e.type)?i.createElement(c.A,Object.assign({},e)):(0,o.tv)(e.type)?i.createElement(i.Suspense,{fallback:i.createElement(d.A,Object.assign({},e))},i.createElement(p,Object.assign({},e))):t?null:(0,a.q)(e.type,e.filled)?i.createElement(l,Object.assign({},e)):null}},92968:(e,t,n)=>{"use strict";n.d(t,{MD:()=>l,tv:()=>s});var i=n(16895),r=n(78585);const o=["ColorfulCopilot","Dot","Editor","EditorSingleColor","EditorWithStars","EditorWithStarsAnimated","EditorWithStarsDarkMode","EditorWithStarsDarkModeAnimated","LocalLanguage","LocaleLanguage","NewFeature"],a=[...o,"AllItems","ClipboardList","CsvFiles","TxtFiles","Excel","Folder","ForwardSlashPromo","ExploreMoreCopilot","LineCopilot","Loop","OneDrive","OneNoteNotebook","Pdf","PowerPoint","QuickSync","SignUpSheet","UnknownFile","Visio","Word"],s=(e,t)=>t?o.some((t=>t===e)):a.some((t=>t===e)),l=e=>{const{primaryColor:t,fontSize:n,fontWeight:o,style:a}=e;return Object.assign({color:t,fontSize:null!=n?n:i.Q.fontSize,width:null!=n?n:i.Q.fontSize,height:null!=n?n:i.Q.fontSize,fontWeight:o?r.c.fontWeightValueByType[o]:i.Q.fontWeight,display:"flex",alignItems:"center",justifyContent:"center"},a)}},16895:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i,S:()=>r});const i={fontSize:20,fontWeight:400};function r(e){return null!=e?e:i.fontSize}},66466:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var i=n(92968),r=n(90970),o=n(90992);function a(e,t){const n=e.type,a=e.filled;return!!((0,o.j2)(n)||(0,o.ku)(n)||(0,i.tv)(n))||!(null==t?void 0:t.useFluentV9)&&(0,r.q)(n,a)}},99265:(e,t,n)=>{"use strict";n.d(t,{c:()=>L});var i=n(95734),r=n(60839),o=n(18861),a=n(50344),s=n(36216),l=n(48701),u=n(29875);const d=/[\(\[\{][^\)\]\}]*[\)\]\}]/g,c=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,h=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,g=/\s+/g,p=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;var f=n(51485),m=n(79440),v=n(98721);const y=i.createContext(void 0),_={},b=(y.Provider,{active:"active",inactive:"inactive"}),C=e=>e>=96?"extra-large":e>=64?"large":e>=56?"medium":e>=40?"small":e>=28?"extra-small":"tiny",T=["dark-red","cranberry","red","pumpkin","peach","marigold","gold","brass","brown","forest","seafoam","dark-green","light-teal","teal","steel","blue","royal-blue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"],S=e=>{let t=0;for(let n=e.length-1;n>=0;n--){const i=e.charCodeAt(n),r=n%8;t^=(i<<r)+(i>>8-r)}return t};var I=n(34877),w=n(11612),E=n(27760),x=n(63649);const A=(0,w.y)("r81b29z","r1aatmv",{r:[".r81b29z{display:inline-block;flex-shrink:0;position:relative;vertical-align:middle;border-radius:var(--borderRadiusCircular);font-family:var(--fontFamilyBase);font-weight:var(--fontWeightSemibold);font-size:var(--fontSizeBase300);width:32px;height:32px;}",".r81b29z::before,.r81b29z::after{position:absolute;top:0;left:0;bottom:0;right:0;z-index:-1;margin:calc(-2 * var(--fui-Avatar-ringWidth, 0px));border-radius:inherit;transition-property:margin,opacity;transition-timing-function:var(--curveEasyEaseMax),var(--curveLinear);transition-duration:var(--durationUltraSlow),var(--durationSlower);}",".r81b29z::before{border-style:solid;border-width:var(--fui-Avatar-ringWidth);}",".r1aatmv{display:inline-block;flex-shrink:0;position:relative;vertical-align:middle;border-radius:var(--borderRadiusCircular);font-family:var(--fontFamilyBase);font-weight:var(--fontWeightSemibold);font-size:var(--fontSizeBase300);width:32px;height:32px;}",".r1aatmv::before,.r1aatmv::after{position:absolute;top:0;right:0;bottom:0;left:0;z-index:-1;margin:calc(-2 * var(--fui-Avatar-ringWidth, 0px));border-radius:inherit;transition-property:margin,opacity;transition-timing-function:var(--curveEasyEaseMax),var(--curveLinear);transition-duration:var(--durationUltraSlow),var(--durationSlower);}",".r1aatmv::before{border-style:solid;border-width:var(--fui-Avatar-ringWidth);}"],s:["@media screen and (prefers-reduced-motion: reduce){.r81b29z::before,.r81b29z::after{transition-duration:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r1aatmv::before,.r1aatmv::after{transition-duration:0.01ms;}}"]}),D=(0,w.y)("r136dc0n","rjly0nl",[".r136dc0n{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;object-fit:cover;vertical-align:top;}",".rjly0nl{position:absolute;top:0;right:0;width:100%;height:100%;border-radius:inherit;object-fit:cover;vertical-align:top;}"]),N=(0,w.y)("rip04v","r31uzil",[".rip04v{position:absolute;box-sizing:border-box;top:0;left:0;width:100%;height:100%;line-height:1;border:var(--strokeWidthThin) solid var(--colorTransparentStroke);display:flex;align-items:center;justify-content:center;vertical-align:center;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;border-radius:inherit;}",".r31uzil{position:absolute;box-sizing:border-box;top:0;right:0;width:100%;height:100%;line-height:1;border:var(--strokeWidthThin) solid var(--colorTransparentStroke);display:flex;align-items:center;justify-content:center;vertical-align:center;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;border-radius:inherit;}"]),F=(0,E.X)({textCaption2Strong:{Be2twd7:"f13mqy1h"},textCaption1Strong:{Be2twd7:"fy9rknc"},textSubtitle2:{Be2twd7:"fod5ikn"},textSubtitle1:{Be2twd7:"f1pp30po"},textTitle3:{Be2twd7:"f1x0m3f5"},squareSmall:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fq9zq91"},squareMedium:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5"},squareLarge:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1o0qvyv"},squareXLarge:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1kijzfu"},activeOrInactive:{Bz10aip:"ftfx35i",Bmy1vo4:"fv0atk9",B3o57yi:"f1iry5bo",Bkqvd7p:"f15n41j8",Hwfdqs:"f1onx1g3"},ring:{Ftih45:"f1wl9k8s"},ringBadgeCutout:{f4a502:"fp2gujx"},ringThick:{of393c:"fq1w1vq"},ringThicker:{of393c:"fzg6ace"},ringThickest:{of393c:"f1nu8p71"},shadow:{Bsft5z2:"f13zj6fq"},shadow4:{Be6vj1x:"fcjn15l"},shadow8:{Be6vj1x:"f1tm8t9f"},shadow16:{Be6vj1x:"f1a1aohj"},shadow28:{Be6vj1x:"fond6v5"},inactive:{abs64n:"fp25eh",Bz10aip:"f1clczzi",Bkqvd7p:"f1l3s34x",Bfgortx:0,Bnvr3x9:0,b2tv09:0,Bucmhp4:0,iayac2:"flkahu5",b6ubon:"fw457kn",Bqinb2h:"f1wmllxl"},badge:{qhf8xq:"f1euv43f",B5kzvoi:"f1yab3r1",j35jbq:["f1e31b4d","f1vgc2s3"]},badgeCutout:{btxmck:"f1eugkqs"},badgeAlign:{Dnlfbu:["f1tlnv9o","f1y9kyih"]},tiny:{Bdjeniz:"f1uwoubl",niu6jh:"fid048z"},"extra-small":{Bdjeniz:"f13ar0e0",niu6jh:"fid048z"},small:{Bdjeniz:"fwwuruf",niu6jh:"fid048z"},medium:{Bdjeniz:"f1af27q5",niu6jh:"fid048z"},large:{Bdjeniz:"f18yy57a",niu6jh:"f924bxt"},"extra-large":{Bdjeniz:"f2jg042",niu6jh:"f924bxt"},icon12:{Be2twd7:"f1ugzwwg"},icon16:{Be2twd7:"f4ybsrx"},icon20:{Be2twd7:"fe5j1ua"},icon24:{Be2twd7:"f1rt2boy"},icon28:{Be2twd7:"f24l1pt"},icon32:{Be2twd7:"ffl51b"},icon48:{Be2twd7:"f18m8u13"}},{d:[".f13mqy1h{font-size:var(--fontSizeBase100);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".f1pp30po{font-size:var(--fontSizeBase500);}",".f1x0m3f5{font-size:var(--fontSizeBase600);}",[".fq9zq91{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".f1o0qvyv{border-radius:var(--borderRadiusLarge);}",{p:-1}],[".f1kijzfu{border-radius:var(--borderRadiusXLarge);}",{p:-1}],".ftfx35i{transform:perspective(1px);}",".fv0atk9{transition-property:transform,opacity;}",".f1iry5bo{transition-duration:var(--durationUltraSlow),var(--durationFaster);}",".f15n41j8{transition-timing-function:var(--curveEasyEaseMax),var(--curveLinear);}",'.f1wl9k8s::before{content:"";}',".fp2gujx::before{-webkit-mask-image:radial-gradient(circle at bottom calc(var(--fui-Avatar-badgeRadius) + 2 * var(--fui-Avatar-ringWidth)) var(--fui-Avatar-badgeAlign) calc(var(--fui-Avatar-badgeRadius) + 2 * var(--fui-Avatar-ringWidth)), transparent calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) - 0.25px), white calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) + 0.25px));mask-image:radial-gradient(circle at bottom calc(var(--fui-Avatar-badgeRadius) + 2 * var(--fui-Avatar-ringWidth)) var(--fui-Avatar-badgeAlign) calc(var(--fui-Avatar-badgeRadius) + 2 * var(--fui-Avatar-ringWidth)), transparent calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) - 0.25px), white calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) + 0.25px));}",".fq1w1vq{--fui-Avatar-ringWidth:var(--strokeWidthThick);}",".fzg6ace{--fui-Avatar-ringWidth:var(--strokeWidthThicker);}",".f1nu8p71{--fui-Avatar-ringWidth:var(--strokeWidthThickest);}",'.f13zj6fq::after{content:"";}',".fcjn15l::after{box-shadow:var(--shadow4);}",".f1tm8t9f::after{box-shadow:var(--shadow8);}",".f1a1aohj::after{box-shadow:var(--shadow16);}",".fond6v5::after{box-shadow:var(--shadow28);}",".fp25eh{opacity:0.8;}",".f1clczzi{transform:scale(0.875);}",".f1l3s34x{transition-timing-function:var(--curveDecelerateMin),var(--curveLinear);}",[".flkahu5::before,.flkahu5::after{margin:0;}",{p:-1}],".fw457kn::before,.fw457kn::after{opacity:0;}",".f1wmllxl::before,.f1wmllxl::after{transition-timing-function:var(--curveDecelerateMin),var(--curveLinear);}",".f1euv43f{position:absolute;}",".f1yab3r1{bottom:0;}",".f1e31b4d{right:0;}",".f1vgc2s3{left:0;}",".f1eugkqs{-webkit-mask-image:radial-gradient(circle at bottom var(--fui-Avatar-badgeRadius) var(--fui-Avatar-badgeAlign) var(--fui-Avatar-badgeRadius), transparent calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) - 0.25px), white calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) + 0.25px));mask-image:radial-gradient(circle at bottom var(--fui-Avatar-badgeRadius) var(--fui-Avatar-badgeAlign) var(--fui-Avatar-badgeRadius), transparent calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) - 0.25px), white calc(var(--fui-Avatar-badgeRadius) + var(--fui-Avatar-badgeGap) + 0.25px));}",".f1tlnv9o{--fui-Avatar-badgeAlign:right;}",".f1y9kyih{--fui-Avatar-badgeAlign:left;}",".f1uwoubl{--fui-Avatar-badgeRadius:3px;}",".fid048z{--fui-Avatar-badgeGap:var(--strokeWidthThin);}",".f13ar0e0{--fui-Avatar-badgeRadius:5px;}",".fwwuruf{--fui-Avatar-badgeRadius:6px;}",".f1af27q5{--fui-Avatar-badgeRadius:8px;}",".f18yy57a{--fui-Avatar-badgeRadius:10px;}",".f924bxt{--fui-Avatar-badgeGap:var(--strokeWidthThick);}",".f2jg042{--fui-Avatar-badgeRadius:14px;}",".f1ugzwwg{font-size:12px;}",".f4ybsrx{font-size:16px;}",".fe5j1ua{font-size:20px;}",".f1rt2boy{font-size:24px;}",".f24l1pt{font-size:28px;}",".ffl51b{font-size:32px;}",".f18m8u13{font-size:48px;}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f1onx1g3{transition-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}]]}),P=(0,E.X)({16:{a9b677:"fjw5fx7",Bqenvij:"fd461yt"},20:{a9b677:"f64fuq3",Bqenvij:"fjamq6b"},24:{a9b677:"fq4mcun",Bqenvij:"frvgh55"},28:{a9b677:"f1w9dchk",Bqenvij:"fxldao9"},32:{a9b677:"f1szoe96",Bqenvij:"f1d2rq10"},36:{a9b677:"fpdz1er",Bqenvij:"f8ljn23"},40:{a9b677:"feqmc2u",Bqenvij:"fbhnoac"},48:{a9b677:"f124akge",Bqenvij:"ff2sm71"},56:{a9b677:"f1u66zr1",Bqenvij:"fzki0ko"},64:{a9b677:"fa9ln6p",Bqenvij:"f16k9i2m"},72:{a9b677:"fhcae8x",Bqenvij:"f1shusfg"},96:{a9b677:"f1kyr2gn",Bqenvij:"fypu0ge"},120:{a9b677:"fwfqyga",Bqenvij:"fjr5b71"},128:{a9b677:"f1iksgmy",Bqenvij:"fele2au"}},{d:[".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".f64fuq3{width:20px;}",".fjamq6b{height:20px;}",".fq4mcun{width:24px;}",".frvgh55{height:24px;}",".f1w9dchk{width:28px;}",".fxldao9{height:28px;}",".f1szoe96{width:32px;}",".f1d2rq10{height:32px;}",".fpdz1er{width:36px;}",".f8ljn23{height:36px;}",".feqmc2u{width:40px;}",".fbhnoac{height:40px;}",".f124akge{width:48px;}",".ff2sm71{height:48px;}",".f1u66zr1{width:56px;}",".fzki0ko{height:56px;}",".fa9ln6p{width:64px;}",".f16k9i2m{height:64px;}",".fhcae8x{width:72px;}",".f1shusfg{height:72px;}",".f1kyr2gn{width:96px;}",".fypu0ge{height:96px;}",".fwfqyga{width:120px;}",".fjr5b71{height:120px;}",".f1iksgmy{width:128px;}",".fele2au{height:128px;}"]}),k=(0,E.X)({neutral:{sj55zd:"f11d4kpn",De3pzq:"f18f03hv"},brand:{sj55zd:"fonrgv7",De3pzq:"f1blnnmj"},"dark-red":{sj55zd:"fqjd1y1",De3pzq:"f1vq2oo4"},cranberry:{sj55zd:"fg9gses",De3pzq:"f1lwxszt"},red:{sj55zd:"f23f7i0",De3pzq:"f1q9qhfq"},pumpkin:{sj55zd:"fjnan08",De3pzq:"fz91bi3"},peach:{sj55zd:"fknu15p",De3pzq:"f1b9nr51"},marigold:{sj55zd:"f9603vw",De3pzq:"f3z4w6d"},gold:{sj55zd:"fmq0uwp",De3pzq:"fg50kya"},brass:{sj55zd:"f28g5vo",De3pzq:"f4w2gd0"},brown:{sj55zd:"ftl572b",De3pzq:"f14wu1f4"},forest:{sj55zd:"f1gymlvd",De3pzq:"f19ut4y6"},seafoam:{sj55zd:"fnnb6wn",De3pzq:"f1n057jc"},"dark-green":{sj55zd:"ff58qw8",De3pzq:"f11t05wk"},"light-teal":{sj55zd:"f1up9qbj",De3pzq:"f42feg1"},teal:{sj55zd:"f135dsb4",De3pzq:"f6hvv1p"},steel:{sj55zd:"f151dlcp",De3pzq:"f1lnp8zf"},blue:{sj55zd:"f1rjv50u",De3pzq:"f1ggcpy6"},"royal-blue":{sj55zd:"f1emykk5",De3pzq:"f12rj61f"},cornflower:{sj55zd:"fqsigj7",De3pzq:"f8k7hur"},navy:{sj55zd:"f1nj97xi",De3pzq:"f19gw0ux"},lavender:{sj55zd:"fwctg0i",De3pzq:"ff379vm"},purple:{sj55zd:"fjrsgpu",De3pzq:"f1mzf1e1"},grape:{sj55zd:"f1fiiydq",De3pzq:"f1o4k8oy"},lilac:{sj55zd:"f1res9jt",De3pzq:"f1x6mz1o"},pink:{sj55zd:"fv3fbbi",De3pzq:"fydlv6t"},magenta:{sj55zd:"f1f1fwnz",De3pzq:"f4xb6j5"},plum:{sj55zd:"f8ptl6j",De3pzq:"fqo8e26"},beige:{sj55zd:"f1ntv3ld",De3pzq:"f101elhj"},mink:{sj55zd:"f1fscmp",De3pzq:"f13g8o5c"},platinum:{sj55zd:"f1dr00v2",De3pzq:"fkh7blw"},anchor:{sj55zd:"f1f3ti53",De3pzq:"fu4yj0j"}},{d:[".f11d4kpn{color:var(--colorNeutralForeground3);}",".f18f03hv{background-color:var(--colorNeutralBackground6);}",".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".f1blnnmj{background-color:var(--colorBrandBackgroundStatic);}",".fqjd1y1{color:var(--colorPaletteDarkRedForeground2);}",".f1vq2oo4{background-color:var(--colorPaletteDarkRedBackground2);}",".fg9gses{color:var(--colorPaletteCranberryForeground2);}",".f1lwxszt{background-color:var(--colorPaletteCranberryBackground2);}",".f23f7i0{color:var(--colorPaletteRedForeground2);}",".f1q9qhfq{background-color:var(--colorPaletteRedBackground2);}",".fjnan08{color:var(--colorPalettePumpkinForeground2);}",".fz91bi3{background-color:var(--colorPalettePumpkinBackground2);}",".fknu15p{color:var(--colorPalettePeachForeground2);}",".f1b9nr51{background-color:var(--colorPalettePeachBackground2);}",".f9603vw{color:var(--colorPaletteMarigoldForeground2);}",".f3z4w6d{background-color:var(--colorPaletteMarigoldBackground2);}",".fmq0uwp{color:var(--colorPaletteGoldForeground2);}",".fg50kya{background-color:var(--colorPaletteGoldBackground2);}",".f28g5vo{color:var(--colorPaletteBrassForeground2);}",".f4w2gd0{background-color:var(--colorPaletteBrassBackground2);}",".ftl572b{color:var(--colorPaletteBrownForeground2);}",".f14wu1f4{background-color:var(--colorPaletteBrownBackground2);}",".f1gymlvd{color:var(--colorPaletteForestForeground2);}",".f19ut4y6{background-color:var(--colorPaletteForestBackground2);}",".fnnb6wn{color:var(--colorPaletteSeafoamForeground2);}",".f1n057jc{background-color:var(--colorPaletteSeafoamBackground2);}",".ff58qw8{color:var(--colorPaletteDarkGreenForeground2);}",".f11t05wk{background-color:var(--colorPaletteDarkGreenBackground2);}",".f1up9qbj{color:var(--colorPaletteLightTealForeground2);}",".f42feg1{background-color:var(--colorPaletteLightTealBackground2);}",".f135dsb4{color:var(--colorPaletteTealForeground2);}",".f6hvv1p{background-color:var(--colorPaletteTealBackground2);}",".f151dlcp{color:var(--colorPaletteSteelForeground2);}",".f1lnp8zf{background-color:var(--colorPaletteSteelBackground2);}",".f1rjv50u{color:var(--colorPaletteBlueForeground2);}",".f1ggcpy6{background-color:var(--colorPaletteBlueBackground2);}",".f1emykk5{color:var(--colorPaletteRoyalBlueForeground2);}",".f12rj61f{background-color:var(--colorPaletteRoyalBlueBackground2);}",".fqsigj7{color:var(--colorPaletteCornflowerForeground2);}",".f8k7hur{background-color:var(--colorPaletteCornflowerBackground2);}",".f1nj97xi{color:var(--colorPaletteNavyForeground2);}",".f19gw0ux{background-color:var(--colorPaletteNavyBackground2);}",".fwctg0i{color:var(--colorPaletteLavenderForeground2);}",".ff379vm{background-color:var(--colorPaletteLavenderBackground2);}",".fjrsgpu{color:var(--colorPalettePurpleForeground2);}",".f1mzf1e1{background-color:var(--colorPalettePurpleBackground2);}",".f1fiiydq{color:var(--colorPaletteGrapeForeground2);}",".f1o4k8oy{background-color:var(--colorPaletteGrapeBackground2);}",".f1res9jt{color:var(--colorPaletteLilacForeground2);}",".f1x6mz1o{background-color:var(--colorPaletteLilacBackground2);}",".fv3fbbi{color:var(--colorPalettePinkForeground2);}",".fydlv6t{background-color:var(--colorPalettePinkBackground2);}",".f1f1fwnz{color:var(--colorPaletteMagentaForeground2);}",".f4xb6j5{background-color:var(--colorPaletteMagentaBackground2);}",".f8ptl6j{color:var(--colorPalettePlumForeground2);}",".fqo8e26{background-color:var(--colorPalettePlumBackground2);}",".f1ntv3ld{color:var(--colorPaletteBeigeForeground2);}",".f101elhj{background-color:var(--colorPaletteBeigeBackground2);}",".f1fscmp{color:var(--colorPaletteMinkForeground2);}",".f13g8o5c{background-color:var(--colorPaletteMinkBackground2);}",".f1dr00v2{color:var(--colorPalettePlatinumForeground2);}",".fkh7blw{background-color:var(--colorPalettePlatinumBackground2);}",".f1f3ti53{color:var(--colorPaletteAnchorForeground2);}",".fu4yj0j{background-color:var(--colorPaletteAnchorBackground2);}"]}),O=(0,E.X)({neutral:{Bic5iru:"f1uuiafn"},brand:{Bic5iru:"f1uuiafn"},"dark-red":{Bic5iru:"f1t2x9on"},cranberry:{Bic5iru:"f1pvshc9"},red:{Bic5iru:"f1ectbk9"},pumpkin:{Bic5iru:"fvzpl0b"},peach:{Bic5iru:"fwj2kd7"},marigold:{Bic5iru:"fr120vy"},gold:{Bic5iru:"f8xmmar"},brass:{Bic5iru:"f1hbety2"},brown:{Bic5iru:"f1vg3s4g"},forest:{Bic5iru:"f1m3olm5"},seafoam:{Bic5iru:"f17xiqtr"},"dark-green":{Bic5iru:"fx32vyh"},"light-teal":{Bic5iru:"f1mkihwv"},teal:{Bic5iru:"fecnooh"},steel:{Bic5iru:"f15hfgzm"},blue:{Bic5iru:"fqproka"},"royal-blue":{Bic5iru:"f17v2w59"},cornflower:{Bic5iru:"fp0q1mo"},navy:{Bic5iru:"f1nlym55"},lavender:{Bic5iru:"f62vk8h"},purple:{Bic5iru:"f15zl69q"},grape:{Bic5iru:"f53w4j7"},lilac:{Bic5iru:"fu2771t"},pink:{Bic5iru:"fzflscs"},magenta:{Bic5iru:"fb6rmqc"},plum:{Bic5iru:"f1a4gm5b"},beige:{Bic5iru:"f1qpf9z1"},mink:{Bic5iru:"f1l7or83"},platinum:{Bic5iru:"fzrj0iu"},anchor:{Bic5iru:"f8oz6wf"}},{d:[".f1uuiafn::before{color:var(--colorBrandStroke1);}",".f1t2x9on::before{color:var(--colorPaletteDarkRedBorderActive);}",".f1pvshc9::before{color:var(--colorPaletteCranberryBorderActive);}",".f1ectbk9::before{color:var(--colorPaletteRedBorderActive);}",".fvzpl0b::before{color:var(--colorPalettePumpkinBorderActive);}",".fwj2kd7::before{color:var(--colorPalettePeachBorderActive);}",".fr120vy::before{color:var(--colorPaletteMarigoldBorderActive);}",".f8xmmar::before{color:var(--colorPaletteGoldBorderActive);}",".f1hbety2::before{color:var(--colorPaletteBrassBorderActive);}",".f1vg3s4g::before{color:var(--colorPaletteBrownBorderActive);}",".f1m3olm5::before{color:var(--colorPaletteForestBorderActive);}",".f17xiqtr::before{color:var(--colorPaletteSeafoamBorderActive);}",".fx32vyh::before{color:var(--colorPaletteDarkGreenBorderActive);}",".f1mkihwv::before{color:var(--colorPaletteLightTealBorderActive);}",".fecnooh::before{color:var(--colorPaletteTealBorderActive);}",".f15hfgzm::before{color:var(--colorPaletteSteelBorderActive);}",".fqproka::before{color:var(--colorPaletteBlueBorderActive);}",".f17v2w59::before{color:var(--colorPaletteRoyalBlueBorderActive);}",".fp0q1mo::before{color:var(--colorPaletteCornflowerBorderActive);}",".f1nlym55::before{color:var(--colorPaletteNavyBorderActive);}",".f62vk8h::before{color:var(--colorPaletteLavenderBorderActive);}",".f15zl69q::before{color:var(--colorPalettePurpleBorderActive);}",".f53w4j7::before{color:var(--colorPaletteGrapeBorderActive);}",".fu2771t::before{color:var(--colorPaletteLilacBorderActive);}",".fzflscs::before{color:var(--colorPalettePinkBorderActive);}",".fb6rmqc::before{color:var(--colorPaletteMagentaBorderActive);}",".f1a4gm5b::before{color:var(--colorPalettePlumBorderActive);}",".f1qpf9z1::before{color:var(--colorPaletteBeigeBorderActive);}",".f1l7or83::before{color:var(--colorPaletteMinkBorderActive);}",".fzrj0iu::before{color:var(--colorPalettePlatinumBorderActive);}",".f8oz6wf::before{color:var(--colorPaletteAnchorBorderActive);}"]}),B=i.forwardRef(((e,t)=>{const n=((e,t)=>{const{dir:n}=(0,v.Y)(),{shape:r,size:o}=null!==(I=i.useContext(y))&&void 0!==I?I:_;var I;const{name:w,size:E=(null!=o?o:32),shape:x=(null!=r?r:"circular"),active:A="unset",activeAppearance:D="ring",idForColor:N}=e;let{color:F="neutral"}=e;var P;"colorful"===F&&(F=T[S(null!==(P=null!=N?N:w)&&void 0!==P?P:"")%T.length]);const k=(0,a.Bi)("avatar-"),O=s.Gk((0,l.g)("span",{role:"img",id:k,...e,ref:t},["name"]),{elementType:"span"}),[B,R]=i.useState(void 0);let L=s.lq(e.image,{defaultProps:{alt:"",role:"presentation","aria-hidden":!0,hidden:B},elementType:"img"});(null==L?void 0:L.src)||(L=void 0),L&&(L.onError=(0,u.p)(L.onError,(()=>R(!0))),L.onLoad=(0,u.p)(L.onLoad,(()=>R(void 0))));let M,q=s.lq(e.initials,{renderByDefault:!0,defaultProps:{children:(U=w,W="rtl"===n,j={firstInitialOnly:E<=16},U?(U=function(e){return(e=(e=(e=e.replace(d,"")).replace(c,"")).replace(g," ")).trim()}(U),p.test(U)||!(null==j?void 0:j.allowPhoneInitials)&&h.test(U)?"":function(e,t,n){let i="";const r=e.split(" ");return 0!==r.length&&(i+=r[0].charAt(0).toUpperCase()),n||(2===r.length?i+=r[1].charAt(0).toUpperCase():3===r.length&&(i+=r[2].charAt(0).toUpperCase())),t&&i.length>1?i.charAt(1)+i.charAt(0):i}(U,W,null==j?void 0:j.firstInitialOnly)):""),id:k+"__initials"},elementType:"span"});var U,W,j;(null==q?void 0:q.children)||(q=void 0),q||L&&!B||(M=s.lq(e.icon,{renderByDefault:!0,defaultProps:{children:i.createElement(f.aUx,null),"aria-hidden":!0},elementType:"span"}));const z=s.lq(e.badge,{defaultProps:{size:C(E),id:k+"__badge"},elementType:m.n});let H;if(!O["aria-label"]&&!O["aria-labelledby"]&&(w?(O["aria-label"]=w,z&&(O["aria-labelledby"]=O.id+" "+z.id)):q&&(O["aria-labelledby"]=q.id+(z?" "+z.id:"")),"active"===A||"inactive"===A)){const e=b[A];if(O["aria-labelledby"]){const t=k+"__active";O["aria-labelledby"]+=" "+t,H=i.createElement("span",{hidden:!0,id:t},e)}else O["aria-label"]&&(O["aria-label"]+=" "+e)}return{size:E,shape:x,active:A,activeAppearance:D,activeAriaLabelElement:H,color:F,components:{root:"span",initials:"span",icon:"span",image:"img",badge:m.n},root:O,initials:q,icon:M,image:L,badge:z}})(e,t);return(e=>{const{size:t,shape:n,active:i,activeAppearance:r,color:o}=e,a=A(),s=D(),l=N(),u=F(),d=P(),c=k(),h=O(),g=[a,32!==t&&d[t]];if(e.badge&&g.push(u.badgeAlign,u[e.badge.size||"medium"]),t<=24?g.push(u.textCaption2Strong):t<=28?g.push(u.textCaption1Strong):t<=40||(t<=56?g.push(u.textSubtitle2):t<=96?g.push(u.textSubtitle1):g.push(u.textTitle3)),"square"===n&&(t<=24?g.push(u.squareSmall):t<=48?g.push(u.squareMedium):t<=72?g.push(u.squareLarge):g.push(u.squareXLarge)),"active"!==i&&"inactive"!==i||(g.push(u.activeOrInactive),"ring"!==r&&"ring-shadow"!==r||(g.push(u.ring,h[o]),e.badge&&g.push(u.ringBadgeCutout),t<=48?g.push(u.ringThick):t<=64?g.push(u.ringThicker):g.push(u.ringThickest)),"shadow"!==r&&"ring-shadow"!==r||(g.push(u.shadow),t<=28?g.push(u.shadow4):t<=48?g.push(u.shadow8):t<=64?g.push(u.shadow16):g.push(u.shadow28)),"inactive"===i&&g.push(u.inactive)),e.root.className=(0,x.z)("fui-Avatar",...g,e.root.className),e.badge&&(e.badge.className=(0,x.z)("fui-Avatar__badge",u.badge,e.badge.className)),e.image&&(e.image.className=(0,x.z)("fui-Avatar__image",s,c[o],e.badge&&u.badgeCutout,e.image.className)),e.initials&&(e.initials.className=(0,x.z)("fui-Avatar__initials",l,c[o],e.badge&&u.badgeCutout,e.initials.className)),e.icon){let n;n=t<=16?u.icon12:t<=24?u.icon16:t<=40?u.icon20:t<=48?u.icon24:t<=56?u.icon28:t<=72?u.icon32:u.icon48,e.icon.className=(0,x.z)("fui-Avatar__icon",l,n,c[o],e.badge&&u.badgeCutout,e.icon.className)}})(n),(0,I.$e)("useAvatarStyles_unstable")(n),(e=>((0,o.C)(e),(0,r.FD)(e.root,{children:[e.initials&&(0,r.Y)(e.initials,{}),e.icon&&(0,r.Y)(e.icon,{}),e.image&&(0,r.Y)(e.image,{}),e.badge&&(0,r.Y)(e.badge,{}),e.activeAriaLabelElement]})))(n)}));B.displayName="Avatar";var R=n(7313);(0,n(54167).hN)([{rawString:"@-webkit-keyframes fadeIn_04b4b0a2{from{opacity:0}to{opacity:1}}@keyframes fadeIn_04b4b0a2{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadeOut_04b4b0a2{from{opacity:1}to{opacity:0}}@keyframes fadeOut_04b4b0a2{from{opacity:1}to{opacity:0}}.coinFadeIn_04b4b0a2{-webkit-animation:fadeIn_04b4b0a2 var(--animation-time) forwards !important;animation:fadeIn_04b4b0a2 var(--animation-time) forwards !important}.coinFadeOut_04b4b0a2{-webkit-animation:fadeOut_04b4b0a2 var(--animation-time) forwards !important;animation:fadeOut_04b4b0a2 var(--animation-time) forwards !important}"}]);const L=e=>{var t,n,r,o,a,s,l,u,d;const[c,h]=i.useState(!1),g=i.useRef(void 0),p=i.useRef(void 0);g.current===e.imageUrl||c||h(!0),i.useEffect((()=>(c&&!p.current&&(p.current=setTimeout((()=>{p.current=void 0,g.current=e.imageUrl,h(!1)}),e.animationTimeMs?e.animationTimeMs+200:1e3)),()=>clearTimeout(p.current))),[c,p.current]);const f=Object.assign({left:0,top:0,position:"absolute","--animation-time":`${null!==(t=e.animationTimeMs)&&void 0!==t?t:800}ms`},e.borderColor?{border:`2px solid ${e.borderColor}`,borderRadius:"50%"}:{}),m={animation:"none !important"},v=M(e.coinSize);return i.createElement(R.S,{style:{position:"relative",width:null!==(n=e.size)&&void 0!==n?n:v,height:null!==(r=e.size)&&void 0!==r?r:v}},c&&i.createElement(B,Object.assign({},e,{image:{src:g.current,style:m},className:"coinFadeOut_04b4b0a2",style:Object.assign({},f),initials:null!==(o=e.initials)&&void 0!==o?o:e.imageInitials,name:e.text,color:null!==(a=e.color)&&void 0!==a?a:"brand",size:null!==(s=e.size)&&void 0!==s?s:v})),i.createElement(B,Object.assign({},e,{image:{src:e.imageUrl,style:m},className:c?"coinFadeIn_04b4b0a2":"",style:Object.assign({},f),initials:null!==(l=e.initials)&&void 0!==l?l:e.imageInitials,name:e.text,color:null!==(u=e.color)&&void 0!==u?u:"brand",size:null!==(d=e.size)&&void 0!==d?d:v})))},M=e=>e?e<20?16:e<24?20:e<28?24:e<32?28:e<36?32:e<40?36:e<48?40:e<56?48:e<64?56:e<72?64:e<96?72:e<120?96:e<128?120:128:20},20193:(e,t,n)=>{"use strict";n.d(t,{q:()=>o,K:()=>a});var i=n(95734),r=n(24607);const o=i.createContext((0,r.jI)());class a extends i.Component{constructor(e){super(e),this.rtl=e.rtl}render(){return i.createElement(o.Provider,{value:this.rtl},this.props.children)}}},34034:(e,t,n)=>{"use strict";function i(e,t,n=1){var i,r;return void 0===t?void 0===(null==e?void 0:e.borderRadius)||"number"==typeof(null==e?void 0:e.borderRadius)?null!==(i=null==e?void 0:e.borderRadius)&&void 0!==i?i:n:void 0:"object"==typeof(null==e?void 0:e.borderRadius)?null!==(r=e.borderRadius[t])&&void 0!==r?r:0:void 0}n.d(t,{W:()=>i})},16971:(e,t,n)=>{"use strict";n.d(t,{O:()=>r,b:()=>o});var i=n(95734);const r=i.createContext(!1);r.displayName="UseFluentV9Context";const o=i.createContext(!1);o.displayName="UseUiCoherenceContext"},44626:(e,t,n)=>{"use strict";n.d(t,{tO:()=>a});var i=n(36694);const r={ArrowDown:i.h.ArrowDown,ArrowUp:i.h.ArrowUp,ArrowLeft:i.h.ArrowLeft,ArrowRight:i.h.ArrowRight,Enter:i.h.Enter,End:i.h.End,Escape:i.h.Escape,Home:i.h.Home,Tab:i.h.Tab," ":i.h.Space,Down:i.h.ArrowDown,Up:i.h.ArrowUp,Left:i.h.ArrowLeft,Right:i.h.ArrowRight,Spacebar:i.h.Space,Esc:i.h.Escape};function o(e,t,n){void 0!==r[n.key]&&-1!==t.indexOf(r[n.key])&&!1!==e({key:r[n.key],alt:n.altKey,ctrl:n.ctrlKey,shift:n.shiftKey,meta:n.metaKey})&&(n.preventDefault(),n.stopPropagation())}function a(e,t){e.onKeyDown&&e.handledKeys&&(t.onKeyDown=o.bind(void 0,e.onKeyDown,e.handledKeys)),e.onKeyUp&&e.handledKeys&&(t.onKeyUp=o.bind(void 0,e.onKeyUp,e.handledKeys))}},36694:(e,t,n)=>{"use strict";var i;n.d(t,{h:()=>i}),function(e){e[e.ArrowDown=0]="ArrowDown",e[e.ArrowUp=1]="ArrowUp",e[e.ArrowLeft=2]="ArrowLeft",e[e.ArrowRight=3]="ArrowRight",e[e.End=4]="End",e[e.Enter=5]="Enter",e[e.Escape=6]="Escape",e[e.Home=7]="Home",e[e.Space=8]="Space",e[e.Tab=9]="Tab"}(i||(i={}))},5823:(e,t,n)=>{"use strict";var i,r;n.d(t,{L:()=>i,x:()=>r}),function(e){e[e.Retry=0]="Retry",e[e.ClearSearch=1]="ClearSearch"}(i||(i={})),function(e){e[e.Undefined=0]="Undefined",e[e.ClassicAttachment=1]="ClassicAttachment",e[e.OneDriveForBusiness=2]="OneDriveForBusiness",e[e.SharepointOnline=3]="SharepointOnline"}(r||(r={}))},23612:(e,t,n)=>{"use strict";n.d(t,{S:()=>r});const i=Object.freeze({Apps:"Apps"});function r(e){return e&&e in i?i[e]:e}},59132:(e,t,n)=>{"use strict";n.d(t,{L:()=>i,Z:()=>r});const i=Object.freeze({doc:{iconType:"Word"},docx:{iconType:"Word"},dot:{iconType:"Word"},dotx:{iconType:"Word"},docm:{iconType:"Word"},docb:{iconType:"Word"},ppt:{iconType:"PowerPoint"},pptx:{iconType:"PowerPoint"},xls:{iconType:"Excel"},xlm:{iconType:"Excel"},xlsx:{iconType:"Excel"},xlsm:{iconType:"Excel"},xlsb:{iconType:"Excel"},xltx:{iconType:"Excel"},pdf:{iconType:"Pdf"},vsd:{iconType:"Visio"},vsdx:{iconType:"Visio"},loop:{iconType:"Loop"},fluid:{iconType:"Loop"},one:{iconType:"OneNoteNotebook"},wbk:{iconType:"Files"},dotm:{iconType:"Files"},xlb:{iconType:"Files"},xlc:{iconType:"Files"},xlt:{iconType:"Files"},xltm:{iconType:"Files"},xla:{iconType:"Files"},xll:{iconType:"Files"},xlam:{iconType:"Files"},xlw:{iconType:"Files"},odc:{iconType:"Files"},ods:{iconType:"Files"},pot:{iconType:"Files"},potx:{iconType:"Files"},potm:{iconType:"Files"},ppam:{iconType:"Files"},ppsx:{iconType:"Files"},ppsm:{iconType:"Files"},sldx:{iconType:"Files"},rtf:{iconType:"Files"},sldm:{iconType:"Files"},ppa:{iconType:"Files"},htm:{iconType:"Files"},html:{iconType:"Files"},odt:{iconType:"Files"},odp:{iconType:"Files"},csv:{iconType:"CsvFiles"},txt:{iconType:"TxtFiles"},folder:{iconType:"Folder"}});function r(e){var t,n;const r=e.toLocaleLowerCase();return null!==(n=null===(t=i[r])||void 0===t?void 0:t.iconType)&&void 0!==n?n:"UnknownFile"}},62989:(e,t,n)=>{"use strict";var i,r,o,a,s,l,u,d;n.d(t,{A8:()=>l,L9:()=>r,SV:()=>d,_R:()=>a,nH:()=>i,vr:()=>o,z4:()=>u}),function(e){e[e.Text=0]="Text",e[e.Icon=1]="Icon",e[e.MonochromeIcon=2]="MonochromeIcon",e[e.IconButton=3]="IconButton",e[e.IconAndTextButton=4]="IconAndTextButton",e[e.CustomImageAndText=5]="CustomImageAndText"}(i||(i={})),function(e){e[e.Classification=0]="Classification",e[e.Spelling=1]="Spelling",e[e.RepeatedWord=2]="RepeatedWord",e[e.Grammar=3]="Grammar",e[e.Refinement=4]="Refinement",e[e.NeuralRewrite=5]="NeuralRewrite",e[e.SimilarityChecker=6]="SimilarityChecker",e[e.TonalRewrite=7]="TonalRewrite",e[e.Topic=8]="Topic",e[e.DictationCorrection=9]="DictationCorrection",e[e.AccColorChecker=10]="AccColorChecker",e[e.WritersUnblock=11]="WritersUnblock",e[e.AIFeedback=12]="AIFeedback",e[e.TextPenAlternates=13]="TextPenAlternates",e[e.AltText=14]="AltText",e[e.InlineSuggestion=15]="InlineSuggestion",e[e.AddinCritique=16]="AddinCritique",e[e.MergeSplitCell=17]="MergeSplitCell",e[e.MissingTableHeader=18]="MissingTableHeader"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Spelling=1]="Spelling",e[e.Grammar=2]="Grammar",e[e.Refinement=3]="Refinement",e[e.Rewrite=4]="Rewrite",e[e.SimilarityChecker=5]="SimilarityChecker",e[e.AccColorChecker=6]="AccColorChecker",e[e.Modification=7]="Modification",e[e.PremiumEmphasis=8]="PremiumEmphasis",e[e.TrackChangeContent=9]="TrackChangeContent",e[e.TrackChangePlaceholder=10]="TrackChangePlaceholder",e[e.CatchUp=11]="CatchUp"}(o||(o={})),function(e){e[e.Accept=0]="Accept",e[e.ReadAloud=1]="ReadAloud",e[e.SpellOut=2]="SpellOut",e[e.ChangeAll=3]="ChangeAll",e[e.AddToAutoCorrect=4]="AddToAutoCorrect",e[e.AutoCorrectOptions=5]="AutoCorrectOptions",e[e.IgnoreOnce=6]="IgnoreOnce",e[e.IgnoreAll=7]="IgnoreAll",e[e.IgnoreRule=8]="IgnoreRule",e[e.AddToDictionary=9]="AddToDictionary",e[e.Options=10]="Options",e[e.ShowExplanation=11]="ShowExplanation",e[e.ManageLanguages=12]="ManageLanguages",e[e.Next=13]="Next",e[e.Previous=14]="Previous",e[e.ToggleContext=15]="ToggleContext",e[e.ToggleDescription=16]="ToggleDescription",e[e.ReadContext=17]="ReadContext",e[e.ShowMenu=18]="ShowMenu",e[e.Feedback=19]="Feedback",e[e.Report=20]="Report",e[e.Dismiss=21]="Dismiss",e[e.AddOnFooterAction=22]="AddOnFooterAction",e[e.OpenEditorPane=23]="OpenEditorPane",e[e.LearnMore=24]="LearnMore",e[e.Complete=25]="Complete",e[e.IntextCitation=26]="IntextCitation",e[e.FullCitation=27]="FullCitation",e[e.Reject=28]="Reject",e[e.AcceptHoverIn=29]="AcceptHoverIn",e[e.AcceptHoverOut=30]="AcceptHoverOut",e[e.RejectHoverIn=31]="RejectHoverIn",e[e.RejectHoverOut=32]="RejectHoverOut",e[e.OpenCustomDictionary=33]="OpenCustomDictionary",e[e.MoreSources=34]="MoreSources",e[e.SourceSelected=35]="SourceSelected",e[e.Accessibility=36]="Accessibility",e[e.OpenColorPicker=37]="OpenColorPicker",e[e.TurnOffAccChecker=38]="TurnOffAccChecker",e[e.ApplyColor=39]="ApplyColor",e[e.Allow=40]="Allow",e[e.AllowAll=41]="AllowAll",e[e.FixSimilarColors=42]="FixSimilarColors",e[e.FixAllColors=43]="FixAllColors",e[e.AutoGenAltText=44]="AutoGenAltText",e[e.MissingAltText=45]="MissingAltText",e[e.UseFirstRowAsHeader=46]="UseFirstRowAsHeader",e[e.SplitCell=47]="SplitCell",e[e.MergeCells=48]="MergeCells",e[e.MarkAsDecorative=49]="MarkAsDecorative",e[e.MarkAsLayout=50]="MarkAsLayout",e[e.MoreFontColors=51]="MoreFontColors",e[e.ChangeColors=52]="ChangeColors",e[e.ResetGraphic=53]="ResetGraphic",e[e.UndoInsertSummarization=54]="UndoInsertSummarization",e[e.RefreshSummary=55]="RefreshSummary",e[e.Overflow=56]="Overflow",e[e.CatchUp=57]="CatchUp",e[e.Cancel=58]="Cancel",e[e.InsertBelow=59]="InsertBelow",e[e.Regenerate=60]="Regenerate",e[e.StopGenerating=61]="StopGenerating",e[e.ContainerHoverIn=62]="ContainerHoverIn",e[e.ContainerHoverOut=63]="ContainerHoverOut",e[e.LaunchAIRewrite=64]="LaunchAIRewrite",e[e.LaunchAIRewriteHoverIn=65]="LaunchAIRewriteHoverIn",e[e.LaunchAIRewriteHoverOut=66]="LaunchAIRewriteHoverOut"}(a||(a={})),function(e){e[e.Undefined=0]="Undefined",e[e.ClassicAttachment=1]="ClassicAttachment",e[e.OneDriveForBusiness=2]="OneDriveForBusiness",e[e.SharepointOnline=3]="SharepointOnline"}(s||(s={})),function(e){e[e.centered=0]="centered",e[e.rightCenter=1]="rightCenter",e[e.bottomCenter=2]="bottomCenter"}(l||(l={})),function(e){e[e.Location=0]="Location",e[e.Person=1]="Person",e[e.SatoriEntity=2]="SatoriEntity",e[e.Topic=3]="Topic",e[e.File=4]="File"}(u||(u={})),function(e){e[e.light=0]="light",e[e.dark=1]="dark",e[e.highContrast=2]="highContrast",e[e.custom=3]="custom",e[e.teamsLight=4]="teamsLight",e[e.teamsDark=5]="teamsDark"}(d||(d={}))},40313:e=>{function t(e,t,n){var i,r,o,a,s;function l(){var u=Date.now()-a;u<t&&u>=0?i=setTimeout(l,t-u):(i=null,n||(s=e.apply(o,r),o=r=null))}null==t&&(t=100);var u=function(){o=this,r=arguments,a=Date.now();var u=n&&!i;return i||(i=setTimeout(l,t)),u&&(s=e.apply(o,r),o=r=null),s};return u.clear=function(){i&&(clearTimeout(i),i=null)},u.flush=function(){i&&(s=e.apply(o,r),o=r=null,clearTimeout(i),i=null)},u}t.debounce=t,e.exports=t},19846:(e,t,n)=>{"use strict";n.d(t,{OZ:()=>a,Yi:()=>u});var i=n(5e3),r=n(61647);function o(e,t,n,r){var o=function(e){var t=[];if(Array.isArray(e)){var n=function(e){for(var t=new Set,n=0,i=e;n<i.length;n++){var r=i[n];if(t.has(r))return r;t.add(r)}}((t=e).map((function(e){return e.key})));if(void 0!==n)throw new Error(i.YG+" "+n.toString())}else t=[e];return t}(r),a={};Reflect.hasOwnMetadata(e,t)&&(a=Reflect.getMetadata(e,t));var s=a[n];if(void 0===s)s=[];else for(var l=function(e){if(o.some((function(t){return t.key===e.key})))throw new Error(i.YG+" "+e.key.toString())},u=0,d=s;u<d.length;u++)l(d[u]);s.push.apply(s,o),a[n]=s,Reflect.defineMetadata(e,a,t)}function a(e){return function(t,n,a){"number"==typeof a?function(e,t,n,a){!function(e){if(void 0!==e)throw new Error(i.A1)}(t),o(r.Bc,e,n.toString(),a)}(t,n,a,e):function(e,t,n){if(void 0!==e.prototype)throw new Error(i.A1);o(r.b2,e.constructor,t,n)}(t,n,e)}}function s(e,t){Reflect.decorate(e,t)}function l(e,t){return function(n,i){t(n,i,e)}}function u(e,t,n){"number"==typeof n?s([l(n,e)],t):"string"==typeof n?Reflect.decorate([e],t,n):s([e],t)}},90424:(e,t,n)=>{"use strict";n.d(t,{W:()=>r});var i=n(61647),r=(0,n(11650).H)(i.n8)},11650:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});var i=n(5e3),r=n(15348),o=n(19846);function a(e){return function(t){return function(n,a,s){if(void 0===t){var l="function"==typeof n?n.name:n.constructor.name;throw new Error((0,i.bI)(l))}return(0,o.OZ)(new r.O(e,t))(n,a,s)}}}},48828:(e,t,n)=>{"use strict";n.d(t,{_:()=>o});var i=n(5e3),r=n(61647);function o(){return function(e){if(Reflect.hasOwnMetadata(r.O2,e))throw new Error(i.aK);var t=Reflect.getMetadata(r.vI,e)||[];return Reflect.defineMetadata(r.O2,t,e),e}}},30122:(e,t,n)=>{"use strict";n.d(t,{t:()=>r});var i=n(61647),r=(0,n(11650).H)(i.jf)},30225:(e,t,n)=>{"use strict";n.d(t,{l:()=>a});var i=n(61647),r=n(15348),o=n(19846);function a(){return(0,o.OZ)(new r.O(i.Q2,!0))}},5e3:(e,t,n)=>{"use strict";n.d(t,{A1:()=>b,BT:()=>u,CE:()=>x,Ds:()=>c,EC:()=>o,F5:()=>p,Ft:()=>y,Jk:()=>a,KU:()=>S,ML:()=>g,NF:()=>N,No:()=>s,SW:()=>w,U9:()=>f,U_:()=>F,Wj:()=>A,Y1:()=>m,Y3:()=>E,YG:()=>r,Z_:()=>C,aK:()=>i,bI:()=>h,bQ:()=>D,fG:()=>l,jC:()=>I,jf:()=>_,li:()=>T,rg:()=>v,z4:()=>d});var i="Cannot apply @injectable decorator multiple times.",r="Metadata key was used more than once in a parameter:",o="NULL argument",a="Key Not Found",s="Ambiguous match found for serviceIdentifier:",l="Could not unbind serviceIdentifier:",u="No matching bindings found for serviceIdentifier:",d="Missing required @injectable annotation in:",c="Missing required @inject or @multiInject annotation in:",h=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation."},g="Circular dependency found:",p="Invalid binding type:",f="No snapshot available to restore.",m="Invalid return type in middleware. Middleware must return!",v="Value provided to function binding must be a function!",y=function(e){return"You are attempting to construct '"+e+"' in a synchronous way\n but it has asynchronous dependencies."},_="The toSelf function can only be applied when a constructor is used as service identifier",b="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",C=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},T="Invalid Container constructor argument. Container options must be an object.",S='Invalid Container option. Default scope must be a string ("singleton" or "transient").',I="Invalid Container option. Auto bind injectable must be a boolean",w="Invalid Container option. Skip base check must be a boolean",E="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",x=function(e,t){return"@postConstruct error in class "+e+": "+t},A=function(e,t){return"@preDestroy error in class "+e+": "+t},D=function(e,t){return"onDeactivation() error in class "+e+": "+t},N=function(e,t){return"It looks like there is a circular dependency in one of the '"+e+"' bindings. Please investigate bindings with service identifier '"+t+"'."},F="Maximum call stack size exceeded"},61647:(e,t,n)=>{"use strict";n.d(t,{Af:()=>o,Bc:()=>u,LX:()=>r,O2:()=>c,P7:()=>i,Q2:()=>a,Vh:()=>p,Z_:()=>g,b2:()=>d,eV:()=>f,jf:()=>l,n8:()=>s,vI:()=>h});var i="named",r="name",o="unmanaged",a="optional",s="inject",l="multi_inject",u="inversify:tagged",d="inversify:tagged_props",c="inversify:paramtypes",h="design:paramtypes",g="post_construct",p="pre_destroy",f=[s,l,r,o,i,a]},15348:(e,t,n)=>{"use strict";n.d(t,{O:()=>r});var i=n(61647),r=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===i.P7?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},e}()},29688:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var i=n(61647),r=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(i.O2,e),userGeneratedMetadata:Reflect.getMetadata(i.Bc,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(i.b2,e)||[]},e}()},46546:(e,t,n)=>{"use strict";function i(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];throw new Error("number"==typeof e?"[MobX] minified error nr: "+e+(n.length?" "+n.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}n.r(t),n.d(t,{$mobx:()=>G,FlowCancellationError:()=>mn,ObservableMap:()=>Ci,ObservableSet:()=>Ii,Reaction:()=>Nt,_allowStateChanges:()=>$e,_allowStateChangesInsideComputed:()=>Kt,_allowStateReadsEnd:()=>pt,_allowStateReadsStart:()=>gt,_autoAction:()=>Qt,_endAction:()=>Ke,_getAdministration:()=>Gi,_getGlobalState:()=>Ct,_interceptReads:()=>In,_isComputingDerivation:()=>st,_resetGlobalState:()=>Tt,_startAction:()=>Qe,action:()=>Gt,autorun:()=>Zt,comparer:()=>Z,computed:()=>Ue,configure:()=>un,createAtom:()=>$,defineProperty:()=>qn,entries:()=>On,extendObservable:()=>dn,flow:()=>bn,flowResult:()=>Tn,get:()=>Mn,getAtom:()=>Vi,getDebugName:()=>Qi,getDependencyTree:()=>cn,getObserverTree:()=>gn,has:()=>Ln,intercept:()=>wn,isAction:()=>$t,isBoxedObservable:()=>Xe,isComputed:()=>xn,isComputedProp:()=>An,isFlow:()=>Sn,isFlowCancellationError:()=>vn,isObservable:()=>Nn,isObservableArray:()=>vi,isObservableMap:()=>Ti,isObservableObject:()=>Pi,isObservableProp:()=>Fn,isObservableSet:()=>wi,keys:()=>Pn,makeAutoObservable:()=>oi,makeObservable:()=>ii,observable:()=>Re,observe:()=>Wn,onBecomeObserved:()=>nn,onBecomeUnobserved:()=>rn,onReactionError:()=>Ft,override:()=>ee,ownKeys:()=>Un,reaction:()=>Xt,remove:()=>Rn,runInAction:()=>Kt,set:()=>Bn,spy:()=>Lt,toJS:()=>Hn,trace:()=>Vn,transaction:()=>Gn,untracked:()=>dt,values:()=>kn,when:()=>Qn});var r={};function o(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:r}var a=Object.assign,s=Object.getOwnPropertyDescriptor,l=Object.defineProperty,u=Object.prototype,d=[];Object.freeze(d);var c={};Object.freeze(c);var h="undefined"!=typeof Proxy,g=Object.toString();function p(){h||i("Proxy not available")}function f(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var m=function(){};function v(e){return"function"==typeof e}function y(e){switch(typeof e){case"string":case"symbol":case"number":return!0}return!1}function _(e){return null!==e&&"object"==typeof e}function b(e){if(!_(e))return!1;var t=Object.getPrototypeOf(e);if(null==t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n.toString()===g}function C(e){var t=null==e?void 0:e.constructor;return!!t&&("GeneratorFunction"===t.name||"GeneratorFunction"===t.displayName)}function T(e,t,n){l(e,t,{enumerable:!1,writable:!0,configurable:!0,value:n})}function S(e,t,n){l(e,t,{enumerable:!1,writable:!1,configurable:!0,value:n})}function I(e,t){var n="isMobX"+e;return t.prototype[n]=!0,function(e){return _(e)&&!0===e[n]}}function w(e){return null!=e&&"[object Map]"===Object.prototype.toString.call(e)}function E(e){return null!=e&&"[object Set]"===Object.prototype.toString.call(e)}var x=void 0!==Object.getOwnPropertySymbols,A="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:x?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function D(e){return null===e?null:"object"==typeof e?""+e:e}function N(e,t){return u.hasOwnProperty.call(e,t)}var F=Object.getOwnPropertyDescriptors||function(e){var t={};return A(e).forEach((function(n){t[n]=s(e,n)})),t};function P(e,t){return!!(e&t)}function k(e,t,n){return n?e|=t:e&=~t,e}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function B(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,W(i.key),i)}}function R(e,t,n){return t&&B(e.prototype,t),n&&B(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function L(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return O(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},M.apply(null,arguments)}function q(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,U(e,t)}function U(e,t){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},U(e,t)}function W(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,"string");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}var j=Symbol("mobx-stored-annotations");function z(e){return Object.assign((function(t,n){if(V(n))return e.decorate_20223_(t,n);H(t,n,e)}),e)}function H(e,t,n){N(e,j)||T(e,j,M({},e[j])),function(e){return e.annotationType_===X}(n)||(e[j][t]=n)}function V(e){return"object"==typeof e&&"string"==typeof e.kind}var G=Symbol("mobx administration"),Q=function(){function e(e){void 0===e&&(e="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=tt.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=e}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach((function(e){return e()}))},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach((function(e){return e()}))},t.reportObserved=function(){return At(this)},t.reportChanged=function(){Et(),Dt(this),xt()},t.toString=function(){return this.name_},R(e,[{key:"isBeingObserved",get:function(){return P(this.flags_,e.isBeingObservedMask_)},set:function(t){this.flags_=k(this.flags_,e.isBeingObservedMask_,t)}},{key:"isPendingUnobservation",get:function(){return P(this.flags_,e.isPendingUnobservationMask_)},set:function(t){this.flags_=k(this.flags_,e.isPendingUnobservationMask_,t)}},{key:"diffValue",get:function(){return P(this.flags_,e.diffValueMask_)?1:0},set:function(t){this.flags_=k(this.flags_,e.diffValueMask_,1===t)}}])}();Q.isBeingObservedMask_=1,Q.isPendingUnobservationMask_=2,Q.diffValueMask_=4;var K=I("Atom",Q);function $(e,t,n){void 0===t&&(t=m),void 0===n&&(n=m);var i=new Q(e);return t!==m&&nn(i,t),n!==m&&rn(i,n),i}var Z={identity:function(e,t){return e===t},structural:function(e,t){return Zi(e,t)},default:function(e,t){return Object.is?Object.is(e,t):e===t?0!==e||1/e==1/t:e!=e&&t!=t},shallow:function(e,t){return Zi(e,t,1)}};function J(e,t,n){return Nn(e)?e:Array.isArray(e)?Re.array(e,{name:n}):b(e)?Re.object(e,void 0,{name:n}):w(e)?Re.map(e,{name:n}):E(e)?Re.set(e,{name:n}):"function"!=typeof e||$t(e)||Sn(e)?e:C(e)?bn(e):Qt(n,e)}function Y(e){return e}var X="override",ee=z({annotationType_:X,make_:function(e,t){return 0},extend_:function(e,t,n,r){i("'"+this.annotationType_+"' can only be used with 'makeObservable'")},decorate_20223_:function(e,t){console.warn("'"+this.annotationType_+"' cannot be used with decorators - this is a no-op")}});function te(e,t){return{annotationType_:e,options_:t,make_:ne,extend_:ie,decorate_20223_:re}}function ne(e,t,n,i){var r;if(null!=(r=this.options_)&&r.bound)return null===this.extend_(e,t,n,!1)?0:1;if(i===e.target_)return null===this.extend_(e,t,n,!1)?0:2;if($t(n.value))return 1;var o=oe(e,this,t,n,!1);return l(i,t,o),2}function ie(e,t,n,i){var r=oe(e,this,t,n);return e.defineProperty_(t,r,i)}function re(e,t){var n=t.kind,r=t.name,o=t.addInitializer,a=this;if("field"!=n){var s,l,u,d,c,h;if("method"==n)return $t(e)||(l=e,e=Ve(null!=(u=null==(d=a.options_)?void 0:d.name)?u:r.toString(),l,null!=(c=null==(h=a.options_)?void 0:h.autoAction)&&c)),null!=(s=this.options_)&&s.bound&&o((function(){var e=this,t=e[r].bind(e);t.isMobxAction=!0,e[r]=t})),e;i("Cannot apply '"+a.annotationType_+"' to '"+String(r)+"' (kind: "+n+"):\n'"+a.annotationType_+"' can only be used on properties with a function value.")}else o((function(){H(this,r,a)}))}function oe(e,t,n,i,r){var o,a,s,l,u,d,c,h;void 0===r&&(r=bt.safeDescriptors),h=i,t.annotationType_,h.value;var g,p=i.value;return null!=(o=t.options_)&&o.bound&&(p=p.bind(null!=(g=e.proxy_)?g:e.target_)),{value:Ve(null!=(a=null==(s=t.options_)?void 0:s.name)?a:n.toString(),p,null!=(l=null==(u=t.options_)?void 0:u.autoAction)&&l,null!=(d=t.options_)&&d.bound?null!=(c=e.proxy_)?c:e.target_:void 0),configurable:!r||e.isPlainObject_,enumerable:!1,writable:!r}}function ae(e,t){return{annotationType_:e,options_:t,make_:se,extend_:le,decorate_20223_:ue}}function se(e,t,n,i){var r;if(i===e.target_)return null===this.extend_(e,t,n,!1)?0:2;if(null!=(r=this.options_)&&r.bound&&(!N(e.target_,t)||!Sn(e.target_[t]))&&null===this.extend_(e,t,n,!1))return 0;if(Sn(n.value))return 1;var o=de(e,this,0,n,!1,!1);return l(i,t,o),2}function le(e,t,n,i){var r,o=de(e,this,0,n,null==(r=this.options_)?void 0:r.bound);return e.defineProperty_(t,o,i)}function ue(e,t){var n,i=t.name,r=t.addInitializer;return Sn(e)||(e=bn(e)),null!=(n=this.options_)&&n.bound&&r((function(){var e=this,t=e[i].bind(e);t.isMobXFlow=!0,e[i]=t})),e}function de(e,t,n,i,r,o){var a;void 0===o&&(o=bt.safeDescriptors),a=i,t.annotationType_,a.value;var s,l=i.value;return Sn(l)||(l=bn(l)),r&&((l=l.bind(null!=(s=e.proxy_)?s:e.target_)).isMobXFlow=!0),{value:l,configurable:!o||e.isPlainObject_,enumerable:!1,writable:!o}}function ce(e,t){return{annotationType_:e,options_:t,make_:he,extend_:ge,decorate_20223_:pe}}function he(e,t,n){return null===this.extend_(e,t,n,!1)?0:1}function ge(e,t,n,i){return r=n,this.annotationType_,r.get,e.defineComputedProperty_(t,M({},this.options_,{get:n.get,set:n.set}),i);var r}function pe(e,t){var n=this,i=t.name;return(0,t.addInitializer)((function(){var t=Di(this)[G],r=M({},n.options_,{get:e,context:this});r.name||(r.name="ObservableObject."+i.toString()),t.values_.set(i,new et(r))})),function(){return this[G].getObservablePropValue_(i)}}function fe(e,t){return{annotationType_:e,options_:t,make_:me,extend_:ve,decorate_20223_:ye}}function me(e,t,n){return null===this.extend_(e,t,n,!1)?0:1}function ve(e,t,n,i){var r,o;return this.annotationType_,e.defineObservableProperty_(t,n.value,null!=(r=null==(o=this.options_)?void 0:o.enhancer)?r:J,i)}function ye(e,t){var n=this,i=t.kind,r=t.name,o=new WeakSet;function a(e,t){var i,a,s=Di(e)[G],l=new Ye(t,null!=(i=null==(a=n.options_)?void 0:a.enhancer)?i:J,"ObservableObject."+r.toString(),!1);s.values_.set(r,l),o.add(e)}if("accessor"==i)return{get:function(){return o.has(this)||a(this,e.get.call(this)),this[G].getObservablePropValue_(r)},set:function(e){return o.has(this)||a(this,e),this[G].setObservablePropValue_(r,e)},init:function(e){return o.has(this)||a(this,e),e}}}var _e="true",be=Ce();function Ce(e){return{annotationType_:_e,options_:e,make_:Te,extend_:Se,decorate_20223_:Ie}}function Te(e,t,n,i){var r,o,a,s;if(n.get)return Ue.make_(e,t,n,i);if(n.set){var u=Ve(t.toString(),n.set);return i===e.target_?null===e.defineProperty_(t,{configurable:!bt.safeDescriptors||e.isPlainObject_,set:u})?0:2:(l(i,t,{configurable:!0,set:u}),2)}if(i!==e.target_&&"function"==typeof n.value)return C(n.value)?(null!=(s=this.options_)&&s.autoBind?bn.bound:bn).make_(e,t,n,i):(null!=(a=this.options_)&&a.autoBind?Qt.bound:Qt).make_(e,t,n,i);var d,c=!1===(null==(r=this.options_)?void 0:r.deep)?Re.ref:Re;return"function"==typeof n.value&&null!=(o=this.options_)&&o.autoBind&&(n.value=n.value.bind(null!=(d=e.proxy_)?d:e.target_)),c.make_(e,t,n,i)}function Se(e,t,n,i){var r,o,a;return n.get?Ue.extend_(e,t,n,i):n.set?e.defineProperty_(t,{configurable:!bt.safeDescriptors||e.isPlainObject_,set:Ve(t.toString(),n.set)},i):("function"==typeof n.value&&null!=(r=this.options_)&&r.autoBind&&(n.value=n.value.bind(null!=(a=e.proxy_)?a:e.target_)),(!1===(null==(o=this.options_)?void 0:o.deep)?Re.ref:Re).extend_(e,t,n,i))}function Ie(e,t){i("'"+this.annotationType_+"' cannot be used as a decorator")}var we={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};function Ee(e){return e||we}Object.freeze(we);var xe=fe("observable"),Ae=fe("observable.ref",{enhancer:Y}),De=fe("observable.shallow",{enhancer:function(e,t,n){return null==e||Pi(e)||vi(e)||Ti(e)||wi(e)?e:Array.isArray(e)?Re.array(e,{name:n,deep:!1}):b(e)?Re.object(e,void 0,{name:n,deep:!1}):w(e)?Re.map(e,{name:n,deep:!1}):E(e)?Re.set(e,{name:n,deep:!1}):void 0}}),Ne=fe("observable.struct",{enhancer:function(e,t){return Zi(e,t)?t:e}}),Fe=z(xe);function Pe(e){return!0===e.deep?J:!1===e.deep?Y:(t=e.defaultDecorator)&&null!=(n=null==(i=t.options_)?void 0:i.enhancer)?n:J;var t,n,i}function ke(e,t,n){return V(t)?xe.decorate_20223_(e,t):y(t)?void H(e,t,xe):Nn(e)?e:b(e)?Re.object(e,t,n):Array.isArray(e)?Re.array(e,t):w(e)?Re.map(e,t):E(e)?Re.set(e,t):"object"==typeof e&&null!==e?e:Re.box(e,t)}a(ke,Fe);var Oe,Be,Re=a(ke,{box:function(e,t){var n=Ee(t);return new Ye(e,Pe(n),n.name,!0,n.equals)},array:function(e,t){var n=Ee(t);return(!1===bt.useProxies||!1===n.proxy?Hi:di)(e,Pe(n),n.name)},map:function(e,t){var n=Ee(t);return new Ci(e,Pe(n),n.name)},set:function(e,t){var n=Ee(t);return new Ii(e,Pe(n),n.name)},object:function(e,t,n){return Ki((function(){return dn(!1===bt.useProxies||!1===(null==n?void 0:n.proxy)?Di({},n):function(e,t){var n,i;return p(),null!=(i=(n=(e=Di(e,t))[G]).proxy_)?i:n.proxy_=new Proxy(e,Zn)}({},n),e,t)}))},ref:z(Ae),shallow:z(De),deep:Fe,struct:z(Ne)}),Le="computed",Me=ce(Le),qe=ce("computed.struct",{equals:Z.structural}),Ue=function(e,t){if(V(t))return Me.decorate_20223_(e,t);if(y(t))return H(e,t,Me);if(b(e))return z(ce(Le,e));var n=b(t)?t:{};return n.get=e,n.name||(n.name=e.name||""),new et(n)};Object.assign(Ue,Me),Ue.struct=z(qe);var We=0,je=1,ze=null!=(Oe=null==(Be=s((function(){}),"name"))?void 0:Be.configurable)&&Oe,He={value:"action",configurable:!0,writable:!1,enumerable:!1};function Ve(e,t,n,i){function r(){return Ge(e,n,t,i||this,arguments)}return void 0===n&&(n=!1),r.isMobxAction=!0,r.toString=function(){return t.toString()},ze&&(He.value=e,l(r,"name",He)),r}function Ge(e,t,n,i,r){var o=Qe(0,t);try{return n.apply(i,r)}catch(e){throw o.error_=e,e}finally{Ke(o)}}function Qe(e,t,n,i){var r=bt.trackingDerivation,o=!t||!r;Et();var a=bt.allowStateChanges;o&&(ct(),a=Ze(!0));var s={runAsAction_:o,prevDerivation_:r,prevAllowStateChanges_:a,prevAllowStateReads_:gt(!0),notifySpy_:!1,startTime_:0,actionId_:je++,parentActionId_:We};return We=s.actionId_,s}function Ke(e){We!==e.actionId_&&i(30),We=e.parentActionId_,void 0!==e.error_&&(bt.suppressReactionErrors=!0),Je(e.prevAllowStateChanges_),pt(e.prevAllowStateReads_),xt(),e.runAsAction_&&ht(e.prevDerivation_),bt.suppressReactionErrors=!1}function $e(e,t){var n=Ze(e);try{return t()}finally{Je(n)}}function Ze(e){var t=bt.allowStateChanges;return bt.allowStateChanges=e,t}function Je(e){bt.allowStateChanges=e}var Ye=function(e){function t(t,n,i,r,o){var a;return void 0===i&&(i="ObservableValue"),void 0===r&&(r=!0),void 0===o&&(o=Z.default),(a=e.call(this,i)||this).enhancer=void 0,a.name_=void 0,a.equals=void 0,a.hasUnreportedChange_=!1,a.interceptors_=void 0,a.changeListeners_=void 0,a.value_=void 0,a.dehancer=void 0,a.enhancer=n,a.name_=i,a.equals=o,a.value_=n(t,void 0,i),a}q(t,e);var n=t.prototype;return n.dehanceValue=function(e){return void 0!==this.dehancer?this.dehancer(e):e},n.set=function(e){this.value_,(e=this.prepareNewValue_(e))!==bt.UNCHANGED&&this.setNewValue_(e)},n.prepareNewValue_=function(e){if(Jn(this)){var t=Xn(this,{object:this,type:si,newValue:e});if(!t)return bt.UNCHANGED;e=t.newValue}return e=this.enhancer(e,this.value_,this.name_),this.equals(this.value_,e)?bt.UNCHANGED:e},n.setNewValue_=function(e){var t=this.value_;this.value_=e,this.reportChanged(),ei(this)&&ni(this,{type:si,object:this,newValue:e,oldValue:t})},n.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},n.intercept_=function(e){return Yn(this,e)},n.observe_=function(e,t){return t&&e({observableKind:"value",debugObjectName:this.name_,object:this,type:si,newValue:this.value_,oldValue:void 0}),ti(this,e)},n.raw=function(){return this.value_},n.toJSON=function(){return this.get()},n.toString=function(){return this.name_+"["+this.value_+"]"},n.valueOf=function(){return D(this.get())},n[Symbol.toPrimitive]=function(){return this.valueOf()},t}(Q),Xe=I("ObservableValue",Ye),et=function(){function e(e){this.dependenciesState_=tt.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=tt.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new rt(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=nt.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,e.get||i(31),this.derivation=e.get,this.name_=e.name||"ComputedValue",e.set&&(this.setter_=Ve("ComputedValue-setter",e.set)),this.equals_=e.equals||(e.compareStructural||e.struct?Z.structural:Z.default),this.scope_=e.context,this.requiresReaction_=e.requiresReaction,this.keepAlive_=!!e.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){!function(e){e.lowestObserverState_===tt.UP_TO_DATE_&&(e.lowestObserverState_=tt.POSSIBLY_STALE_,e.observers_.forEach((function(e){e.dependenciesState_===tt.UP_TO_DATE_&&(e.dependenciesState_=tt.POSSIBLY_STALE_,e.onBecomeStale_())})))}(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach((function(e){return e()}))},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach((function(e){return e()}))},t.get=function(){if(this.isComputing&&i(32,this.name_,this.derivation),0!==bt.inBatch||0!==this.observers_.size||this.keepAlive_){if(At(this),at(this)){var e=bt.trackingContext;this.keepAlive_&&!e&&(bt.trackingContext=this),this.trackAndCompute()&&function(e){e.lowestObserverState_!==tt.STALE_&&(e.lowestObserverState_=tt.STALE_,e.observers_.forEach((function(t){t.dependenciesState_===tt.POSSIBLY_STALE_?t.dependenciesState_=tt.STALE_:t.dependenciesState_===tt.UP_TO_DATE_&&(e.lowestObserverState_=tt.UP_TO_DATE_)})))}(this),bt.trackingContext=e}}else at(this)&&(this.warnAboutUntrackedRead_(),Et(),this.value_=this.computeValue_(!1),xt());var t=this.value_;if(ot(t))throw t.cause;return t},t.set=function(e){if(this.setter_){this.isRunningSetter&&i(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,e)}finally{this.isRunningSetter=!1}}else i(34,this.name_)},t.trackAndCompute=function(){var e=this.value_,t=this.dependenciesState_===tt.NOT_TRACKING_,n=this.computeValue_(!0),i=t||ot(e)||ot(n)||!this.equals_(e,n);return i&&(this.value_=n),i},t.computeValue_=function(e){this.isComputing=!0;var t,n=Ze(!1);if(e)t=lt(this,this.derivation,this.scope_);else if(!0===bt.disableErrorBoundaries)t=this.derivation.call(this.scope_);else try{t=this.derivation.call(this.scope_)}catch(e){t=new rt(e)}return Je(n),this.isComputing=!1,t},t.suspend_=function(){this.keepAlive_||(ut(this),this.value_=void 0)},t.observe_=function(e,t){var n=this,i=!0,r=void 0;return Zt((function(){var o=n.get();if(!i||t){var a=ct();e({observableKind:"computed",debugObjectName:n.name_,type:si,object:n,newValue:o,oldValue:r}),ht(a)}i=!1,r=o}))},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return D(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},R(e,[{key:"isComputing",get:function(){return P(this.flags_,e.isComputingMask_)},set:function(t){this.flags_=k(this.flags_,e.isComputingMask_,t)}},{key:"isRunningSetter",get:function(){return P(this.flags_,e.isRunningSetterMask_)},set:function(t){this.flags_=k(this.flags_,e.isRunningSetterMask_,t)}},{key:"isBeingObserved",get:function(){return P(this.flags_,e.isBeingObservedMask_)},set:function(t){this.flags_=k(this.flags_,e.isBeingObservedMask_,t)}},{key:"isPendingUnobservation",get:function(){return P(this.flags_,e.isPendingUnobservationMask_)},set:function(t){this.flags_=k(this.flags_,e.isPendingUnobservationMask_,t)}},{key:"diffValue",get:function(){return P(this.flags_,e.diffValueMask_)?1:0},set:function(t){this.flags_=k(this.flags_,e.diffValueMask_,1===t)}}])}();et.isComputingMask_=1,et.isRunningSetterMask_=2,et.isBeingObservedMask_=4,et.isPendingUnobservationMask_=8,et.diffValueMask_=16;var tt,nt,it=I("ComputedValue",et);!function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"}(tt||(tt={})),function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"}(nt||(nt={}));var rt=function(e){this.cause=void 0,this.cause=e};function ot(e){return e instanceof rt}function at(e){switch(e.dependenciesState_){case tt.UP_TO_DATE_:return!1;case tt.NOT_TRACKING_:case tt.STALE_:return!0;case tt.POSSIBLY_STALE_:for(var t=gt(!0),n=ct(),i=e.observing_,r=i.length,o=0;o<r;o++){var a=i[o];if(it(a)){if(bt.disableErrorBoundaries)a.get();else try{a.get()}catch(e){return ht(n),pt(t),!0}if(e.dependenciesState_===tt.STALE_)return ht(n),pt(t),!0}}return ft(e),ht(n),pt(t),!1}}function st(){return null!==bt.trackingDerivation}function lt(e,t,n){var i=gt(!0);ft(e),e.newObserving_=new Array(0===e.runId_?100:e.observing_.length),e.unboundDepsCount_=0,e.runId_=++bt.runId;var r,o=bt.trackingDerivation;if(bt.trackingDerivation=e,bt.inBatch++,!0===bt.disableErrorBoundaries)r=t.call(n);else try{r=t.call(n)}catch(e){r=new rt(e)}return bt.inBatch--,bt.trackingDerivation=o,function(e){for(var t=e.observing_,n=e.observing_=e.newObserving_,i=tt.UP_TO_DATE_,r=0,o=e.unboundDepsCount_,a=0;a<o;a++){var s=n[a];0===s.diffValue&&(s.diffValue=1,r!==a&&(n[r]=s),r++),s.dependenciesState_>i&&(i=s.dependenciesState_)}for(n.length=r,e.newObserving_=null,o=t.length;o--;){var l=t[o];0===l.diffValue&&It(l,e),l.diffValue=0}for(;r--;){var u=n[r];1===u.diffValue&&(u.diffValue=0,St(u,e))}i!==tt.UP_TO_DATE_&&(e.dependenciesState_=i,e.onBecomeStale_())}(e),pt(i),r}function ut(e){var t=e.observing_;e.observing_=[];for(var n=t.length;n--;)It(t[n],e);e.dependenciesState_=tt.NOT_TRACKING_}function dt(e){var t=ct();try{return e()}finally{ht(t)}}function ct(){var e=bt.trackingDerivation;return bt.trackingDerivation=null,e}function ht(e){bt.trackingDerivation=e}function gt(e){var t=bt.allowStateReads;return bt.allowStateReads=e,t}function pt(e){bt.allowStateReads=e}function ft(e){if(e.dependenciesState_!==tt.UP_TO_DATE_){e.dependenciesState_=tt.UP_TO_DATE_;for(var t=e.observing_,n=t.length;n--;)t[n].lowestObserverState_=tt.UP_TO_DATE_}}var mt=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED","useProxies"],vt=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},yt=!0,_t=!1,bt=function(){var e=o();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(yt=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==(new vt).version&&(yt=!1),yt?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new vt):(setTimeout((function(){_t||i(35)}),1),new vt)}();function Ct(){return bt}function Tt(){var e=new vt;for(var t in e)-1===mt.indexOf(t)&&(bt[t]=e[t]);bt.allowStateChanges=!bt.enforceActions}function St(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function It(e,t){e.observers_.delete(t),0===e.observers_.size&&wt(e)}function wt(e){!1===e.isPendingUnobservation&&(e.isPendingUnobservation=!0,bt.pendingUnobservations.push(e))}function Et(){bt.inBatch++}function xt(){if(0==--bt.inBatch){Ot();for(var e=bt.pendingUnobservations,t=0;t<e.length;t++){var n=e[t];n.isPendingUnobservation=!1,0===n.observers_.size&&(n.isBeingObserved&&(n.isBeingObserved=!1,n.onBUO()),n instanceof et&&n.suspend_())}bt.pendingUnobservations=[]}}function At(e){var t=bt.trackingDerivation;return null!==t?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved&&bt.trackingContext&&(e.isBeingObserved=!0,e.onBO())),e.isBeingObserved):(0===e.observers_.size&&bt.inBatch>0&&wt(e),!1)}function Dt(e){e.lowestObserverState_!==tt.STALE_&&(e.lowestObserverState_=tt.STALE_,e.observers_.forEach((function(e){e.dependenciesState_===tt.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=tt.STALE_})))}var Nt=function(){function e(e,t,n,i){void 0===e&&(e="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=tt.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=nt.NONE,this.name_=e,this.onInvalidate_=t,this.errorHandler_=n,this.requiresObservable_=i}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled||(this.isScheduled=!0,bt.pendingReactions.push(this),Ot())},t.runReaction_=function(){if(!this.isDisposed){Et(),this.isScheduled=!1;var e=bt.trackingContext;if(bt.trackingContext=this,at(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(e){this.reportExceptionInDerivation_(e)}}bt.trackingContext=e,xt()}},t.track=function(e){if(!this.isDisposed){Et(),this.isRunning=!0;var t=bt.trackingContext;bt.trackingContext=this;var n=lt(this,e,void 0);bt.trackingContext=t,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&ut(this),ot(n)&&this.reportExceptionInDerivation_(n.cause),xt()}},t.reportExceptionInDerivation_=function(e){var t=this;if(this.errorHandler_)this.errorHandler_(e,this);else{if(bt.disableErrorBoundaries)throw e;var n="[mobx] uncaught error in '"+this+"'";bt.suppressReactionErrors||console.error(n,e),bt.globalReactionErrorHandlers.forEach((function(n){return n(e,t)}))}},t.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(Et(),ut(this),xt()))},t.getDisposer_=function(e){var t=this,n=function n(){t.dispose(),null==e||null==e.removeEventListener||e.removeEventListener("abort",n)};return null==e||null==e.addEventListener||e.addEventListener("abort",n),n[G]=this,n},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(e){void 0===e&&(e=!1)},R(e,[{key:"isDisposed",get:function(){return P(this.flags_,e.isDisposedMask_)},set:function(t){this.flags_=k(this.flags_,e.isDisposedMask_,t)}},{key:"isScheduled",get:function(){return P(this.flags_,e.isScheduledMask_)},set:function(t){this.flags_=k(this.flags_,e.isScheduledMask_,t)}},{key:"isTrackPending",get:function(){return P(this.flags_,e.isTrackPendingMask_)},set:function(t){this.flags_=k(this.flags_,e.isTrackPendingMask_,t)}},{key:"isRunning",get:function(){return P(this.flags_,e.isRunningMask_)},set:function(t){this.flags_=k(this.flags_,e.isRunningMask_,t)}},{key:"diffValue",get:function(){return P(this.flags_,e.diffValueMask_)?1:0},set:function(t){this.flags_=k(this.flags_,e.diffValueMask_,1===t)}}])}();function Ft(e){return bt.globalReactionErrorHandlers.push(e),function(){var t=bt.globalReactionErrorHandlers.indexOf(e);t>=0&&bt.globalReactionErrorHandlers.splice(t,1)}}Nt.isDisposedMask_=1,Nt.isScheduledMask_=2,Nt.isTrackPendingMask_=4,Nt.isRunningMask_=8,Nt.diffValueMask_=16;var Pt=100,kt=function(e){return e()};function Ot(){bt.inBatch>0||bt.isRunningReactions||kt(Bt)}function Bt(){bt.isRunningReactions=!0;for(var e=bt.pendingReactions,t=0;e.length>0;){++t===Pt&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var n=e.splice(0),i=0,r=n.length;i<r;i++)n[i].runReaction_()}bt.isRunningReactions=!1}var Rt=I("Reaction",Nt);function Lt(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var Mt="action",qt="autoAction",Ut="<unnamed action>",Wt=te(Mt),jt=te("action.bound",{bound:!0}),zt=te(qt,{autoAction:!0}),Ht=te("autoAction.bound",{autoAction:!0,bound:!0});function Vt(e){return function(t,n){return v(t)?Ve(t.name||Ut,t,e):v(n)?Ve(t,n,e):V(n)?(e?zt:Wt).decorate_20223_(t,n):y(n)?H(t,n,e?zt:Wt):y(t)?z(te(e?qt:Mt,{name:t,autoAction:e})):void 0}}var Gt=Vt(!1);Object.assign(Gt,Wt);var Qt=Vt(!0);function Kt(e){return Ge(e.name,!1,e,this,void 0)}function $t(e){return v(e)&&!0===e.isMobxAction}function Zt(e,t){var n,i,r,o;void 0===t&&(t=c);var a,s=null!=(n=null==(i=t)?void 0:i.name)?n:"Autorun";if(t.scheduler||t.delay){var l=Yt(t),u=!1;a=new Nt(s,(function(){u||(u=!0,l((function(){u=!1,a.isDisposed||a.track(d)})))}),t.onError,t.requiresObservable)}else a=new Nt(s,(function(){this.track(d)}),t.onError,t.requiresObservable);function d(){e(a)}return null!=(r=t)&&null!=(r=r.signal)&&r.aborted||a.schedule_(),a.getDisposer_(null==(o=t)?void 0:o.signal)}Object.assign(Qt,zt),Gt.bound=z(jt),Qt.bound=z(Ht);var Jt=function(e){return e()};function Yt(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:Jt}function Xt(e,t,n){var i,r,o;void 0===n&&(n=c);var a,s,l,u=null!=(i=n.name)?i:"Reaction",d=Gt(u,n.onError?(a=n.onError,s=t,function(){try{return s.apply(this,arguments)}catch(e){a.call(this,e)}}):t),h=!n.scheduler&&!n.delay,g=Yt(n),p=!0,f=!1,m=n.compareStructural?Z.structural:n.equals||Z.default,v=new Nt(u,(function(){p||h?y():f||(f=!0,g(y))}),n.onError,n.requiresObservable);function y(){if(f=!1,!v.isDisposed){var t=!1,i=l;v.track((function(){var n=$e(!1,(function(){return e(v)}));t=p||!m(l,n),l=n})),(p&&n.fireImmediately||!p&&t)&&d(l,i,v),p=!1}}return null!=(r=n)&&null!=(r=r.signal)&&r.aborted||v.schedule_(),v.getDisposer_(null==(o=n)?void 0:o.signal)}var en="onBO",tn="onBUO";function nn(e,t,n){return on(en,e,t,n)}function rn(e,t,n){return on(tn,e,t,n)}function on(e,t,n,i){var r="function"==typeof i?Vi(t,n):Vi(t),o=v(i)?i:n,a=e+"L";return r[a]?r[a].add(o):r[a]=new Set([o]),function(){var e=r[a];e&&(e.delete(o),0===e.size&&delete r[a])}}var an="never",sn="always",ln="observed";function un(e){!0===e.isolateGlobalState&&function(){if((bt.pendingReactions.length||bt.inBatch||bt.isRunningReactions)&&i(36),_t=!0,yt){var e=o();0==--e.__mobxInstanceCount&&(e.__mobxGlobals=void 0),bt=new vt}}();var t,n,r=e.useProxies,a=e.enforceActions;if(void 0!==r&&(bt.useProxies=r===sn||r!==an&&"undefined"!=typeof Proxy),"ifavailable"===r&&(bt.verifyProxies=!0),void 0!==a){var s=a===sn?sn:a===ln;bt.enforceActions=s,bt.allowStateChanges=!0!==s&&s!==sn}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach((function(t){t in e&&(bt[t]=!!e[t])})),bt.allowStateReads=!bt.observableRequiresReaction,e.reactionScheduler&&(t=e.reactionScheduler,n=kt,kt=function(e){return t((function(){return n(e)}))})}function dn(e,t,n,i){var r=F(t);return Ki((function(){var t=Di(e,i)[G];A(r).forEach((function(e){t.extend_(e,r[e],!n||!(e in n)||n[e])}))})),e}function cn(e,t){return hn(Vi(e,t))}function hn(e){var t,n={name:e.name_};return e.observing_&&e.observing_.length>0&&(n.dependencies=(t=e.observing_,Array.from(new Set(t))).map(hn)),n}function gn(e,t){return pn(Vi(e,t))}function pn(e){var t={name:e.name_};return function(e){return e.observers_&&e.observers_.size>0}(e)&&(t.observers=Array.from(function(e){return e.observers_}(e)).map(pn)),t}var fn=0;function mn(){this.message="FLOW_CANCELLED"}function vn(e){return e instanceof mn}mn.prototype=Object.create(Error.prototype);var yn=ae("flow"),_n=ae("flow.bound",{bound:!0}),bn=Object.assign((function(e,t){if(V(t))return yn.decorate_20223_(e,t);if(y(t))return H(e,t,yn);var n=e,i=n.name||"<unnamed flow>",r=function(){var e,t=arguments,r=++fn,o=Gt(i+" - runid: "+r+" - init",n).apply(this,t),a=void 0,s=new Promise((function(t,n){var s=0;function l(e){var t;a=void 0;try{t=Gt(i+" - runid: "+r+" - yield "+s++,o.next).call(o,e)}catch(e){return n(e)}d(t)}function u(e){var t;a=void 0;try{t=Gt(i+" - runid: "+r+" - yield "+s++,o.throw).call(o,e)}catch(e){return n(e)}d(t)}function d(e){if(!v(null==e?void 0:e.then))return e.done?t(e.value):(a=Promise.resolve(e.value)).then(l,u);e.then(d,n)}e=n,l(void 0)}));return s.cancel=Gt(i+" - runid: "+r+" - cancel",(function(){try{a&&Cn(a);var t=o.return(void 0),n=Promise.resolve(t.value);n.then(m,m),Cn(n),e(new mn)}catch(t){e(t)}})),s};return r.isMobXFlow=!0,r}),yn);function Cn(e){v(e.cancel)&&e.cancel()}function Tn(e){return e}function Sn(e){return!0===(null==e?void 0:e.isMobXFlow)}function In(e,t,n){var i;return Ti(e)||vi(e)||Xe(e)?i=Gi(e):Pi(e)&&(i=Gi(e,t)),i.dehancer="function"==typeof t?t:n,function(){i.dehancer=void 0}}function wn(e,t,n){return v(n)?function(e,t,n){return Gi(e,t).intercept_(n)}(e,t,n):function(e,t){return Gi(e).intercept_(t)}(e,t)}function En(e,t){if(void 0===t)return it(e);if(!1===Pi(e))return!1;if(!e[G].values_.has(t))return!1;var n=Vi(e,t);return it(n)}function xn(e){return En(e)}function An(e,t){return En(e,t)}function Dn(e,t){return!!e&&(void 0!==t?!!Pi(e)&&e[G].values_.has(t):Pi(e)||!!e[G]||K(e)||Rt(e)||it(e))}function Nn(e){return Dn(e)}function Fn(e,t){return Dn(e,t)}function Pn(e){return Pi(e)?e[G].keys_():Ti(e)||wi(e)?Array.from(e.keys()):vi(e)?e.map((function(e,t){return t})):void i(5)}function kn(e){return Pi(e)?Pn(e).map((function(t){return e[t]})):Ti(e)?Pn(e).map((function(t){return e.get(t)})):wi(e)?Array.from(e.values()):vi(e)?e.slice():void i(6)}function On(e){return Pi(e)?Pn(e).map((function(t){return[t,e[t]]})):Ti(e)?Pn(e).map((function(t){return[t,e.get(t)]})):wi(e)?Array.from(e.entries()):vi(e)?e.map((function(e,t){return[t,e]})):void i(7)}function Bn(e,t,n){if(2!==arguments.length||wi(e))Pi(e)?e[G].set_(t,n):Ti(e)?e.set(t,n):wi(e)?e.add(t):vi(e)?("number"!=typeof t&&(t=parseInt(t,10)),t<0&&i("Invalid index: '"+t+"'"),Et(),t>=e.length&&(e.length=t+1),e[t]=n,xt()):i(8);else{Et();var r=t;try{for(var o in r)Bn(e,o,r[o])}finally{xt()}}}function Rn(e,t){Pi(e)?e[G].delete_(t):Ti(e)||wi(e)?e.delete(t):vi(e)?("number"!=typeof t&&(t=parseInt(t,10)),e.splice(t,1)):i(9)}function Ln(e,t){return Pi(e)?e[G].has_(t):Ti(e)||wi(e)?e.has(t):vi(e)?t>=0&&t<e.length:void i(10)}function Mn(e,t){if(Ln(e,t))return Pi(e)?e[G].get_(t):Ti(e)?e.get(t):vi(e)?e[t]:void i(11)}function qn(e,t,n){if(Pi(e))return e[G].defineProperty_(t,n);i(39)}function Un(e){if(Pi(e))return e[G].ownKeys_();i(38)}function Wn(e,t,n,i){return v(n)?function(e,t,n,i){return Gi(e,t).observe_(n,i)}(e,t,n,i):function(e,t,n){return Gi(e).observe_(t,n)}(e,t,n)}function jn(e,t,n){return e.set(t,n),n}function zn(e,t){if(null==e||"object"!=typeof e||e instanceof Date||!Nn(e))return e;if(Xe(e)||it(e))return zn(e.get(),t);if(t.has(e))return t.get(e);if(vi(e)){var n=jn(t,e,new Array(e.length));return e.forEach((function(e,i){n[i]=zn(e,t)})),n}if(wi(e)){var i=jn(t,e,new Set);return e.forEach((function(e){i.add(zn(e,t))})),i}if(Ti(e)){var r=jn(t,e,new Map);return e.forEach((function(e,n){r.set(n,zn(e,t))})),r}var o=jn(t,e,{});return Un(e).forEach((function(n){u.propertyIsEnumerable.call(e,n)&&(o[n]=zn(e[n],t))})),o}function Hn(e,t){return zn(e,new Map)}function Vn(){}function Gn(e,t){void 0===t&&(t=void 0),Et();try{return e.apply(t)}finally{xt()}}function Qn(e,t,n){return 1===arguments.length||t&&"object"==typeof t?function(e,t){var n,i,r;if(null!=t&&null!=(n=t.signal)&&n.aborted)return Object.assign(Promise.reject(new Error("WHEN_ABORTED")),{cancel:function(){return null}});var o=new Promise((function(n,o){var a,s=Kn(e,n,M({},t,{onError:o}));i=function(){s(),o(new Error("WHEN_CANCELLED"))},r=function(){s(),o(new Error("WHEN_ABORTED"))},null==t||null==(a=t.signal)||null==a.addEventListener||a.addEventListener("abort",r)})).finally((function(){var e;return null==t||null==(e=t.signal)||null==e.removeEventListener?void 0:e.removeEventListener("abort",r)}));return o.cancel=i,o}(e,t):Kn(e,t,n||{})}function Kn(e,t,n){var i;if("number"==typeof n.timeout){var r=new Error("WHEN_TIMEOUT");i=setTimeout((function(){if(!a[G].isDisposed){if(a(),!n.onError)throw r;n.onError(r)}}),n.timeout)}n.name="When";var o=Ve("When-effect",t),a=Zt((function(t){$e(!1,e)&&(t.dispose(),i&&clearTimeout(i),o())}),n);return a}function $n(e){return e[G]}bn.bound=z(_n);var Zn={has:function(e,t){return $n(e).has_(t)},get:function(e,t){return $n(e).get_(t)},set:function(e,t,n){var i;return!!y(t)&&(null==(i=$n(e).set_(t,n,!0))||i)},deleteProperty:function(e,t){var n;return!!y(t)&&(null==(n=$n(e).delete_(t,!0))||n)},defineProperty:function(e,t,n){var i;return null==(i=$n(e).defineProperty_(t,n))||i},ownKeys:function(e){return $n(e).ownKeys_()},preventExtensions:function(e){i(13)}};function Jn(e){return void 0!==e.interceptors_&&e.interceptors_.length>0}function Yn(e,t){var n=e.interceptors_||(e.interceptors_=[]);return n.push(t),f((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function Xn(e,t){var n=ct();try{for(var r=[].concat(e.interceptors_||[]),o=0,a=r.length;o<a&&((t=r[o](t))&&!t.type&&i(14),t);o++);return t}finally{ht(n)}}function ei(e){return void 0!==e.changeListeners_&&e.changeListeners_.length>0}function ti(e,t){var n=e.changeListeners_||(e.changeListeners_=[]);return n.push(t),f((function(){var e=n.indexOf(t);-1!==e&&n.splice(e,1)}))}function ni(e,t){var n=ct(),i=e.changeListeners_;if(i){for(var r=0,o=(i=i.slice()).length;r<o;r++)i[r](t);ht(n)}}function ii(e,t,n){return Ki((function(){var i=Di(e,n)[G];null!=t||(t=function(e){return N(e,j)||T(e,j,M({},e[j])),e[j]}(e)),A(t).forEach((function(e){return i.make_(e,t[e])}))})),e}var ri=Symbol("mobx-keys");function oi(e,t,n){return b(e)?dn(e,e,t,n):(Ki((function(){var i=Di(e,n)[G];if(!e[ri]){var r=Object.getPrototypeOf(e),o=new Set([].concat(A(e),A(r)));o.delete("constructor"),o.delete(G),T(r,ri,o)}e[ri].forEach((function(e){return i.make_(e,!t||!(e in t)||t[e])}))})),e)}var ai="splice",si="update",li={get:function(e,t){var n=e[G];return t===G?n:"length"===t?n.getArrayLength_():"string"!=typeof t||isNaN(t)?N(ci,t)?ci[t]:e[t]:n.get_(parseInt(t))},set:function(e,t,n){var i=e[G];return"length"===t&&i.setArrayLength_(n),"symbol"==typeof t||isNaN(t)?e[t]=n:i.set_(parseInt(t),n),!0},preventExtensions:function(){i(15)}},ui=function(){function e(e,t,n,i){void 0===e&&(e="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=n,this.legacyMode_=i,this.atom_=new Q(e),this.enhancer_=function(e,n){return t(e,n,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.dehanceValues_=function(e){return void 0!==this.dehancer&&e.length>0?e.map(this.dehancer):e},t.intercept_=function(e){return Yn(this,e)},t.observe_=function(e,t){return void 0===t&&(t=!1),t&&e({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),ti(this,e)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(e){("number"!=typeof e||isNaN(e)||e<0)&&i("Out of range: "+e);var t=this.values_.length;if(e!==t)if(e>t){for(var n=new Array(e-t),r=0;r<e-t;r++)n[r]=void 0;this.spliceWithArray_(t,0,n)}else this.spliceWithArray_(e,t-e)},t.updateArrayLength_=function(e,t){e!==this.lastKnownLength_&&i(16),this.lastKnownLength_+=t,this.legacyMode_&&t>0&&zi(e+t+1)},t.spliceWithArray_=function(e,t,n){var i=this;this.atom_;var r=this.values_.length;if(void 0===e?e=0:e>r?e=r:e<0&&(e=Math.max(0,r+e)),t=1===arguments.length?r-e:null==t?0:Math.max(0,Math.min(t,r-e)),void 0===n&&(n=d),Jn(this)){var o=Xn(this,{object:this.proxy_,type:ai,index:e,removedCount:t,added:n});if(!o)return d;t=o.removedCount,n=o.added}if(n=0===n.length?n:n.map((function(e){return i.enhancer_(e,void 0)})),this.legacyMode_){var a=n.length-t;this.updateArrayLength_(r,a)}var s=this.spliceItemsIntoValues_(e,t,n);return 0===t&&0===n.length||this.notifyArraySplice_(e,n,s),this.dehanceValues_(s)},t.spliceItemsIntoValues_=function(e,t,n){var i;if(n.length<1e4)return(i=this.values_).splice.apply(i,[e,t].concat(n));var r=this.values_.slice(e,e+t),o=this.values_.slice(e+t);this.values_.length+=n.length-t;for(var a=0;a<n.length;a++)this.values_[e+a]=n[a];for(var s=0;s<o.length;s++)this.values_[e+n.length+s]=o[s];return r},t.notifyArrayChildUpdate_=function(e,t,n){var i=!this.owned_&&!1,r=ei(this),o=r||i?{observableKind:"array",object:this.proxy_,type:si,debugObjectName:this.atom_.name_,index:e,newValue:t,oldValue:n}:null;this.atom_.reportChanged(),r&&ni(this,o)},t.notifyArraySplice_=function(e,t,n){var i=!this.owned_&&!1,r=ei(this),o=r||i?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:ai,index:e,removed:n,added:t,removedCount:n.length,addedCount:t.length}:null;this.atom_.reportChanged(),r&&ni(this,o)},t.get_=function(e){if(!(this.legacyMode_&&e>=this.values_.length))return this.atom_.reportObserved(),this.dehanceValue_(this.values_[e]);console.warn("[mobx] Out of bounds read: "+e)},t.set_=function(e,t){var n=this.values_;if(this.legacyMode_&&e>n.length&&i(17,e,n.length),e<n.length){this.atom_;var r=n[e];if(Jn(this)){var o=Xn(this,{type:si,object:this.proxy_,index:e,newValue:t});if(!o)return;t=o.newValue}(t=this.enhancer_(t,r))!==r&&(n[e]=t,this.notifyArrayChildUpdate_(e,t,r))}else{for(var a=new Array(e+1-n.length),s=0;s<a.length-1;s++)a[s]=void 0;a[a.length-1]=t,this.spliceWithArray_(n.length,0,a)}},e}();function di(e,t,n,i){return void 0===n&&(n="ObservableArray"),void 0===i&&(i=!1),p(),Ki((function(){var r=new ui(n,t,i,!1);S(r.values_,G,r);var o=new Proxy(r.values_,li);return r.proxy_=o,e&&e.length&&r.spliceWithArray_(0,0,e),o}))}var ci={clear:function(){return this.splice(0)},replace:function(e){var t=this[G];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];var o=this[G];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray_(e);case 2:return o.spliceWithArray_(e,t)}return o.spliceWithArray_(e,t,i)},spliceWithArray:function(e,t,n){return this[G].spliceWithArray_(e,t,n)},push:function(){for(var e=this[G],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[G].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[G],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return bt.trackingDerivation&&i(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){bt.trackingDerivation&&i(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[G],n=t.dehanceValues_(t.values_).indexOf(e);return n>-1&&(this.splice(n,1),!0)}};function hi(e,t){"function"==typeof Array.prototype[e]&&(ci[e]=t(e))}function gi(e){return function(){var t=this[G];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_);return n[e].apply(n,arguments)}}function pi(e){return function(t,n){var i=this,r=this[G];return r.atom_.reportObserved(),r.dehanceValues_(r.values_)[e]((function(e,r){return t.call(n,e,r,i)}))}}function fi(e){return function(){var t=this,n=this[G];n.atom_.reportObserved();var i=n.dehanceValues_(n.values_),r=arguments[0];return arguments[0]=function(e,n,i){return r(e,n,i,t)},i[e].apply(i,arguments)}}hi("at",gi),hi("concat",gi),hi("flat",gi),hi("includes",gi),hi("indexOf",gi),hi("join",gi),hi("lastIndexOf",gi),hi("slice",gi),hi("toString",gi),hi("toLocaleString",gi),hi("toSorted",gi),hi("toSpliced",gi),hi("with",gi),hi("every",pi),hi("filter",pi),hi("find",pi),hi("findIndex",pi),hi("findLast",pi),hi("findLastIndex",pi),hi("flatMap",pi),hi("forEach",pi),hi("map",pi),hi("some",pi),hi("toReversed",pi),hi("reduce",fi),hi("reduceRight",fi);var mi=I("ObservableArrayAdministration",ui);function vi(e){return _(e)&&mi(e[G])}var yi={},_i="add",bi="delete",Ci=function(){function e(e,t,n){var r=this;void 0===t&&(t=J),void 0===n&&(n="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[G]=yi,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=t,this.name_=n,v(Map)||i(18),Ki((function(){r.keysAtom_=$("ObservableMap.keys()"),r.data_=new Map,r.hasMap_=new Map,e&&r.merge(e)}))}var t=e.prototype;return t.has_=function(e){return this.data_.has(e)},t.has=function(e){var t=this;if(!bt.trackingDerivation)return this.has_(e);var n=this.hasMap_.get(e);if(!n){var i=n=new Ye(this.has_(e),Y,"ObservableMap.key?",!1);this.hasMap_.set(e,i),rn(i,(function(){return t.hasMap_.delete(e)}))}return n.get()},t.set=function(e,t){var n=this.has_(e);if(Jn(this)){var i=Xn(this,{type:n?si:_i,object:this,newValue:t,name:e});if(!i)return this;t=i.newValue}return n?this.updateValue_(e,t):this.addValue_(e,t),this},t.delete=function(e){var t=this;if(this.keysAtom_,Jn(this)&&!Xn(this,{type:bi,object:this,name:e}))return!1;if(this.has_(e)){var n=ei(this),i=n?{observableKind:"map",debugObjectName:this.name_,type:bi,object:this,oldValue:this.data_.get(e).value_,name:e}:null;return Gn((function(){var n;t.keysAtom_.reportChanged(),null==(n=t.hasMap_.get(e))||n.setNewValue_(!1),t.data_.get(e).setNewValue_(void 0),t.data_.delete(e)})),n&&ni(this,i),!0}return!1},t.updateValue_=function(e,t){var n=this.data_.get(e);if((t=n.prepareNewValue_(t))!==bt.UNCHANGED){var i=ei(this),r=i?{observableKind:"map",debugObjectName:this.name_,type:si,object:this,oldValue:n.value_,name:e,newValue:t}:null;n.setNewValue_(t),i&&ni(this,r)}},t.addValue_=function(e,t){var n=this;this.keysAtom_,Gn((function(){var i,r=new Ye(t,n.enhancer_,"ObservableMap.key",!1);n.data_.set(e,r),t=r.value_,null==(i=n.hasMap_.get(e))||i.setNewValue_(!0),n.keysAtom_.reportChanged()}));var i=ei(this),r=i?{observableKind:"map",debugObjectName:this.name_,type:_i,object:this,name:e,newValue:t}:null;i&&ni(this,r)},t.get=function(e){return this.has(e)?this.dehanceValue_(this.data_.get(e).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var e=this,t=this.keys();return Xi({next:function(){var n=t.next(),i=n.done,r=n.value;return{done:i,value:i?void 0:e.get(r)}}})},t.entries=function(){var e=this,t=this.keys();return Xi({next:function(){var n=t.next(),i=n.done,r=n.value;return{done:i,value:i?void 0:[r,e.get(r)]}}})},t[Symbol.iterator]=function(){return this.entries()},t.forEach=function(e,t){for(var n,i=L(this);!(n=i()).done;){var r=n.value,o=r[0],a=r[1];e.call(t,a,o,this)}},t.merge=function(e){var t=this;return Ti(e)&&(e=new Map(e)),Gn((function(){var n,r,o;b(e)?function(e){var t=Object.keys(e);if(!x)return t;var n=Object.getOwnPropertySymbols(e);return n.length?[].concat(t,n.filter((function(t){return u.propertyIsEnumerable.call(e,t)}))):t}(e).forEach((function(n){return t.set(n,e[n])})):Array.isArray(e)?e.forEach((function(e){var n=e[0],i=e[1];return t.set(n,i)})):w(e)?(n=e,r=Object.getPrototypeOf(n),o=Object.getPrototypeOf(r),null!==Object.getPrototypeOf(o)&&i(19,e),e.forEach((function(e,n){return t.set(n,e)}))):null!=e&&i(20,e)})),this},t.clear=function(){var e=this;Gn((function(){dt((function(){for(var t,n=L(e.keys());!(t=n()).done;){var i=t.value;e.delete(i)}}))}))},t.replace=function(e){var t=this;return Gn((function(){for(var n,r=function(e){if(w(e)||Ti(e))return e;if(Array.isArray(e))return new Map(e);if(b(e)){var t=new Map;for(var n in e)t.set(n,e[n]);return t}return i(21,e)}(e),o=new Map,a=!1,s=L(t.data_.keys());!(n=s()).done;){var l=n.value;if(!r.has(l))if(t.delete(l))a=!0;else{var u=t.data_.get(l);o.set(l,u)}}for(var d,c=L(r.entries());!(d=c()).done;){var h=d.value,g=h[0],p=h[1],f=t.data_.has(g);if(t.set(g,p),t.data_.has(g)){var m=t.data_.get(g);o.set(g,m),f||(a=!0)}}if(!a)if(t.data_.size!==o.size)t.keysAtom_.reportChanged();else for(var v=t.data_.keys(),y=o.keys(),_=v.next(),C=y.next();!_.done;){if(_.value!==C.value){t.keysAtom_.reportChanged();break}_=v.next(),C=y.next()}t.data_=o})),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(e,t){return ti(this,e)},t.intercept_=function(e){return Yn(this,e)},R(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),Ti=I("ObservableMap",Ci),Si={},Ii=function(){function e(e,t,n){var r=this;void 0===t&&(t=J),void 0===n&&(n="ObservableSet"),this.name_=void 0,this[G]=Si,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=n,v(Set)||i(22),this.enhancer_=function(e,i){return t(e,i,n)},Ki((function(){r.atom_=$(r.name_),e&&r.replace(e)}))}var t=e.prototype;return t.dehanceValue_=function(e){return void 0!==this.dehancer?this.dehancer(e):e},t.clear=function(){var e=this;Gn((function(){dt((function(){for(var t,n=L(e.data_.values());!(t=n()).done;){var i=t.value;e.delete(i)}}))}))},t.forEach=function(e,t){for(var n,i=L(this);!(n=i()).done;){var r=n.value;e.call(t,r,r,this)}},t.add=function(e){var t=this;if(this.atom_,Jn(this)&&!Xn(this,{type:_i,object:this,newValue:e}))return this;if(!this.has(e)){Gn((function(){t.data_.add(t.enhancer_(e,void 0)),t.atom_.reportChanged()}));var n=ei(this),i=n?{observableKind:"set",debugObjectName:this.name_,type:_i,object:this,newValue:e}:null;n&&ni(this,i)}return this},t.delete=function(e){var t=this;if(Jn(this)&&!Xn(this,{type:bi,object:this,oldValue:e}))return!1;if(this.has(e)){var n=ei(this),i=n?{observableKind:"set",debugObjectName:this.name_,type:bi,object:this,oldValue:e}:null;return Gn((function(){t.atom_.reportChanged(),t.data_.delete(e)})),n&&ni(this,i),!0}return!1},t.has=function(e){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(e))},t.entries=function(){var e=0,t=Array.from(this.keys()),n=Array.from(this.values());return Xi({next:function(){var i=e;return e+=1,i<n.length?{value:[t[i],n[i]],done:!1}:{done:!0}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var e=this,t=0,n=Array.from(this.data_.values());return Xi({next:function(){return t<n.length?{value:e.dehanceValue_(n[t++]),done:!1}:{done:!0}}})},t.intersection=function(e){return E(e)?e.intersection(this):new Set(this).intersection(e)},t.union=function(e){return E(e)?e.union(this):new Set(this).union(e)},t.difference=function(e){return new Set(this).difference(e)},t.symmetricDifference=function(e){return E(e)?e.symmetricDifference(this):new Set(this).symmetricDifference(e)},t.isSubsetOf=function(e){return new Set(this).isSubsetOf(e)},t.isSupersetOf=function(e){return new Set(this).isSupersetOf(e)},t.isDisjointFrom=function(e){return E(e)?e.isDisjointFrom(this):new Set(this).isDisjointFrom(e)},t.replace=function(e){var t=this;return wi(e)&&(e=new Set(e)),Gn((function(){Array.isArray(e)||E(e)?(t.clear(),e.forEach((function(e){return t.add(e)}))):null!=e&&i("Cannot initialize set from "+e)})),this},t.observe_=function(e,t){return ti(this,e)},t.intercept_=function(e){return Yn(this,e)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[Symbol.iterator]=function(){return this.values()},R(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),wi=I("ObservableSet",Ii),Ei=Object.create(null),xi="remove",Ai=function(){function e(e,t,n,i){void 0===t&&(t=new Map),void 0===i&&(i=be),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=e,this.values_=t,this.name_=n,this.defaultAnnotation_=i,this.keysAtom_=new Q("ObservableObject.keys"),this.isPlainObject_=b(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(e){return this.values_.get(e).get()},t.setObservablePropValue_=function(e,t){var n=this.values_.get(e);if(n instanceof et)return n.set(t),!0;if(Jn(this)){var i=Xn(this,{type:si,object:this.proxy_||this.target_,name:e,newValue:t});if(!i)return null;t=i.newValue}if((t=n.prepareNewValue_(t))!==bt.UNCHANGED){var r=ei(this),o=r?{type:si,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:n.value_,name:e,newValue:t}:null;n.setNewValue_(t),r&&ni(this,o)}return!0},t.get_=function(e){return bt.trackingDerivation&&!N(this.target_,e)&&this.has_(e),this.target_[e]},t.set_=function(e,t,n){return void 0===n&&(n=!1),N(this.target_,e)?this.values_.has(e)?this.setObservablePropValue_(e,t):n?Reflect.set(this.target_,e,t):(this.target_[e]=t,!0):this.extend_(e,{value:t,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,n)},t.has_=function(e){if(!bt.trackingDerivation)return e in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var t=this.pendingKeys_.get(e);return t||(t=new Ye(e in this.target_,Y,"ObservableObject.key?",!1),this.pendingKeys_.set(e,t)),t.get()},t.make_=function(e,t){if(!0===t&&(t=this.defaultAnnotation_),!1!==t){if(!(e in this.target_)){var n;if(null!=(n=this.target_[j])&&n[e])return;i(1,t.annotationType_,this.name_+"."+e.toString())}for(var r=this.target_;r&&r!==u;){var o=s(r,e);if(o){var a=t.make_(this,e,o,r);if(0===a)return;if(1===a)break}r=Object.getPrototypeOf(r)}ki(this,0,e)}},t.extend_=function(e,t,n,i){if(void 0===i&&(i=!1),!0===n&&(n=this.defaultAnnotation_),!1===n)return this.defineProperty_(e,t,i);var r=n.extend_(this,e,t,i);return r&&ki(this,0,e),r},t.defineProperty_=function(e,t,n){void 0===n&&(n=!1),this.keysAtom_;try{Et();var i=this.delete_(e);if(!i)return i;if(Jn(this)){var r=Xn(this,{object:this.proxy_||this.target_,name:e,type:_i,newValue:t.value});if(!r)return null;var o=r.newValue;t.value!==o&&(t=M({},t,{value:o}))}if(n){if(!Reflect.defineProperty(this.target_,e,t))return!1}else l(this.target_,e,t);this.notifyPropertyAddition_(e,t.value)}finally{xt()}return!0},t.defineObservableProperty_=function(e,t,n,i){void 0===i&&(i=!1),this.keysAtom_;try{Et();var r=this.delete_(e);if(!r)return r;if(Jn(this)){var o=Xn(this,{object:this.proxy_||this.target_,name:e,type:_i,newValue:t});if(!o)return null;t=o.newValue}var a=Fi(e),s={configurable:!bt.safeDescriptors||this.isPlainObject_,enumerable:!0,get:a.get,set:a.set};if(i){if(!Reflect.defineProperty(this.target_,e,s))return!1}else l(this.target_,e,s);var u=new Ye(t,n,"ObservableObject.key",!1);this.values_.set(e,u),this.notifyPropertyAddition_(e,u.value_)}finally{xt()}return!0},t.defineComputedProperty_=function(e,t,n){void 0===n&&(n=!1),this.keysAtom_;try{Et();var i=this.delete_(e);if(!i)return i;if(Jn(this)&&!Xn(this,{object:this.proxy_||this.target_,name:e,type:_i,newValue:void 0}))return null;t.name||(t.name="ObservableObject.key"),t.context=this.proxy_||this.target_;var r=Fi(e),o={configurable:!bt.safeDescriptors||this.isPlainObject_,enumerable:!1,get:r.get,set:r.set};if(n){if(!Reflect.defineProperty(this.target_,e,o))return!1}else l(this.target_,e,o);this.values_.set(e,new et(t)),this.notifyPropertyAddition_(e,void 0)}finally{xt()}return!0},t.delete_=function(e,t){if(void 0===t&&(t=!1),this.keysAtom_,!N(this.target_,e))return!0;if(Jn(this)&&!Xn(this,{object:this.proxy_||this.target_,name:e,type:xi}))return null;try{var n;Et();var i,r=ei(this),o=this.values_.get(e),a=void 0;if(!o&&r&&(a=null==(i=s(this.target_,e))?void 0:i.value),t){if(!Reflect.deleteProperty(this.target_,e))return!1}else delete this.target_[e];if(o&&(this.values_.delete(e),o instanceof Ye&&(a=o.value_),Dt(o)),this.keysAtom_.reportChanged(),null==(n=this.pendingKeys_)||null==(n=n.get(e))||n.set(e in this.target_),r){var l={type:xi,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:a,name:e};r&&ni(this,l)}}finally{xt()}return!0},t.observe_=function(e,t){return ti(this,e)},t.intercept_=function(e){return Yn(this,e)},t.notifyPropertyAddition_=function(e,t){var n,i=ei(this);if(i){var r=i?{type:_i,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:e,newValue:t}:null;i&&ni(this,r)}null==(n=this.pendingKeys_)||null==(n=n.get(e))||n.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),A(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function Di(e,t){var n;if(N(e,G))return e;var i=null!=(n=null==t?void 0:t.name)?n:"ObservableObject",r=new Ai(e,new Map,String(i),function(e){var t;return e?null!=(t=e.defaultDecorator)?t:Ce(e):void 0}(t));return T(e,G,r),e}var Ni=I("ObservableObjectAdministration",Ai);function Fi(e){return Ei[e]||(Ei[e]={get:function(){return this[G].getObservablePropValue_(e)},set:function(t){return this[G].setObservablePropValue_(e,t)}})}function Pi(e){return!!_(e)&&Ni(e[G])}function ki(e,t,n){var i;null==(i=e.target_[j])||delete i[n]}var Oi,Bi,Ri=Wi(0),Li=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,!1===e}(),Mi=0,qi=function(){};Oi=qi,Bi=Array.prototype,Object.setPrototypeOf?Object.setPrototypeOf(Oi.prototype,Bi):void 0!==Oi.prototype.__proto__?Oi.prototype.__proto__=Bi:Oi.prototype=Bi;var Ui=function(e){function t(t,n,i,r){var o;return void 0===i&&(i="ObservableArray"),void 0===r&&(r=!1),o=e.call(this)||this,Ki((function(){var e=new ui(i,n,r,!0);e.proxy_=o,S(o,G,e),t&&t.length&&o.spliceWithArray(0,0,t),Li&&Object.defineProperty(o,"0",Ri)})),o}q(t,e);var n=t.prototype;return n.concat=function(){this[G].atom_.reportObserved();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.prototype.concat.apply(this.slice(),t.map((function(e){return vi(e)?e.slice():e})))},n[Symbol.iterator]=function(){var e=this,t=0;return Xi({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})},R(t,[{key:"length",get:function(){return this[G].getArrayLength_()},set:function(e){this[G].setArrayLength_(e)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(qi);function Wi(e){return{enumerable:!1,configurable:!0,get:function(){return this[G].get_(e)},set:function(t){this[G].set_(e,t)}}}function ji(e){l(Ui.prototype,""+e,Wi(e))}function zi(e){if(e>Mi){for(var t=Mi;t<e+100;t++)ji(t);Mi=e}}function Hi(e,t,n){return new Ui(e,t,n)}function Vi(e,t){if("object"==typeof e&&null!==e){if(vi(e))return void 0!==t&&i(23),e[G].atom_;if(wi(e))return e.atom_;if(Ti(e)){if(void 0===t)return e.keysAtom_;var n=e.data_.get(t)||e.hasMap_.get(t);return n||i(25,t,Qi(e)),n}if(Pi(e)){if(!t)return i(26);var r=e[G].values_.get(t);return r||i(27,t,Qi(e)),r}if(K(e)||it(e)||Rt(e))return e}else if(v(e)&&Rt(e[G]))return e[G];i(28)}function Gi(e,t){return e||i(29),void 0!==t?Gi(Vi(e,t)):K(e)||it(e)||Rt(e)||Ti(e)||wi(e)?e:e[G]?e[G]:void i(24,e)}function Qi(e,t){var n;if(void 0!==t)n=Vi(e,t);else{if($t(e))return e.name;n=Pi(e)||Ti(e)||wi(e)?Gi(e):Vi(e)}return n.name_}function Ki(e){var t=ct(),n=Ze(!0);Et();try{return e()}finally{xt(),Je(n),ht(t)}}Object.entries(ci).forEach((function(e){var t=e[0],n=e[1];"concat"!==t&&T(Ui.prototype,t,n)})),zi(1e3);var $i=u.toString;function Zi(e,t,n){return void 0===n&&(n=-1),Ji(e,t,n)}function Ji(e,t,n,i,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var o=typeof e;if("function"!==o&&"object"!==o&&"object"!=typeof t)return!1;var a=$i.call(e);if(a!==$i.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return"undefined"!=typeof Symbol&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":n>=0&&n++}e=Yi(e),t=Yi(t);var s="[object Array]"===a;if(!s){if("object"!=typeof e||"object"!=typeof t)return!1;var l=e.constructor,u=t.constructor;if(l!==u&&!(v(l)&&l instanceof l&&v(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1}if(0===n)return!1;n<0&&(n=-1),r=r||[];for(var d=(i=i||[]).length;d--;)if(i[d]===e)return r[d]===t;if(i.push(e),r.push(t),s){if((d=e.length)!==t.length)return!1;for(;d--;)if(!Ji(e[d],t[d],n-1,i,r))return!1}else{var c,h=Object.keys(e);if(d=h.length,Object.keys(t).length!==d)return!1;for(;d--;)if(!N(t,c=h[d])||!Ji(e[c],t[c],n-1,i,r))return!1}return i.pop(),r.pop(),!0}function Yi(e){return vi(e)?e.slice():w(e)||Ti(e)||E(e)||wi(e)?Array.from(e.entries()):e}function Xi(e){return e[Symbol.iterator]=er,e}function er(){return this}["Symbol","Map","Set"].forEach((function(e){void 0===o()[e]&&i("MobX requires global '"+e+"' to be available or polyfilled")})),"object"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Lt,extras:{getDebugName:Qi},$mobx:G})},82009:(e,t,n)=>{"use strict";var i=n(53730);function r(){}function o(){}o.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,o,a){if(a!==i){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:r};return n.PropTypes=n,n}},92949:(e,t,n)=>{e.exports=n(82009)()},53730:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},12709:(e,t,n)=>{"use strict";var i=n(21355),r=n(95734);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=60106,s=60107,l=60108,u=60114,d=60109,c=60110,h=60112,g=60113,p=60120,f=60115,m=60116,v=60121,y=60117,_=60119,b=60129,C=60131;if("function"==typeof Symbol&&Symbol.for){var T=Symbol.for;a=T("react.portal"),s=T("react.fragment"),l=T("react.strict_mode"),u=T("react.profiler"),d=T("react.provider"),c=T("react.context"),h=T("react.forward_ref"),g=T("react.suspense"),p=T("react.suspense_list"),f=T("react.memo"),m=T("react.lazy"),v=T("react.block"),y=T("react.fundamental"),_=T("react.scope"),b=T("react.debug_trace_mode"),C=T("react.legacy_hidden")}function S(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case s:return"Fragment";case a:return"Portal";case u:return"Profiler";case l:return"StrictMode";case g:return"Suspense";case p:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case c:return(e.displayName||"Context")+".Consumer";case d:return(e._context.displayName||"Context")+".Provider";case h:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case f:return S(e.type);case v:return S(e._render);case m:t=e._payload,e=e._init;try{return S(e(t))}catch(e){}}return null}var I=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w={};function E(e,t){for(var n=0|e._threadCount;n<=t;n++)e[n]=e._currentValue2,e._threadCount=n+1}for(var x=new Uint16Array(16),A=0;15>A;A++)x[A]=A+1;x[15]=0;var D=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,N=Object.prototype.hasOwnProperty,F={},P={};function k(e){return!!N.call(P,e)||!N.call(F,e)&&(D.test(e)?P[e]=!0:(F[e]=!0,!1))}function O(e,t,n,i,r,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var B={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){B[e]=new O(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];B[t]=new O(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){B[e]=new O(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){B[e]=new O(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){B[e]=new O(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){B[e]=new O(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){B[e]=new O(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){B[e]=new O(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){B[e]=new O(e,5,!1,e.toLowerCase(),null,!1,!1)}));var R=/[\-:]([a-z])/g;function L(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(R,L);B[t]=new O(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(R,L);B[t]=new O(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(R,L);B[t]=new O(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){B[e]=new O(e,1,!1,e.toLowerCase(),null,!1,!1)})),B.xlinkHref=new O("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){B[e]=new O(e,1,!1,e.toLowerCase(),null,!0,!0)}));var M=/["'&<>]/;function q(e){if("boolean"==typeof e||"number"==typeof e)return""+e;e=""+e;var t=M.exec(e);if(t){var n,i="",r=0;for(n=t.index;n<e.length;n++){switch(e.charCodeAt(n)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#x27;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}r!==n&&(i+=e.substring(r,n)),r=n+1,i+=t}e=r!==n?i+e.substring(r,n):i}return e}function U(e,t){var n,i=B.hasOwnProperty(e)?B[e]:null;return(n="style"!==e)&&(n=null!==i?0===i.type:2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])),n||function(e,t,n,i){if(null==t||function(e,t,n,i){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e;default:return!1}}(e,t,n))return!0;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(e,t,i)?"":null!==i?(e=i.attributeName,3===(n=i.type)||4===n&&!0===t?e+'=""':(i.sanitizeURL&&(t=""+t),e+'="'+q(t)+'"')):k(e)?e+'="'+q(t)+'"':""}var W="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},j=null,z=null,H=null,V=!1,G=!1,Q=null,K=0;function $(){if(null===j)throw Error(o(321));return j}function Z(){if(0<K)throw Error(o(312));return{memoizedState:null,queue:null,next:null}}function J(){return null===H?null===z?(V=!1,z=H=Z()):(V=!0,H=z):null===H.next?(V=!1,H=H.next=Z()):(V=!0,H=H.next),H}function Y(e,t,n,i){for(;G;)G=!1,K+=1,H=null,n=e(t,i);return X(),n}function X(){j=null,G=!1,z=null,K=0,H=Q=null}function ee(e,t){return"function"==typeof t?t(e):t}function te(e,t,n){if(j=$(),H=J(),V){var i=H.queue;if(t=i.dispatch,null!==Q&&void 0!==(n=Q.get(i))){Q.delete(i),i=H.memoizedState;do{i=e(i,n.action),n=n.next}while(null!==n);return H.memoizedState=i,[i,t]}return[H.memoizedState,t]}return e=e===ee?"function"==typeof t?t():t:void 0!==n?n(t):t,H.memoizedState=e,e=(e=H.queue={last:null,dispatch:null}).dispatch=ie.bind(null,j,e),[H.memoizedState,e]}function ne(e,t){if(j=$(),t=void 0===t?null:t,null!==(H=J())){var n=H.memoizedState;if(null!==n&&null!==t){var i=n[1];e:if(null===i)i=!1;else{for(var r=0;r<i.length&&r<t.length;r++)if(!W(t[r],i[r])){i=!1;break e}i=!0}if(i)return n[0]}}return e=e(),H.memoizedState=[e,t],e}function ie(e,t,n){if(!(25>K))throw Error(o(301));if(e===j)if(G=!0,e={action:n,next:null},null===Q&&(Q=new Map),void 0===(n=Q.get(t)))Q.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}}function re(){}var oe=null,ae={readContext:function(e){var t=oe.threadID;return E(e,t),e[t]},useContext:function(e){$();var t=oe.threadID;return E(e,t),e[t]},useMemo:ne,useReducer:te,useRef:function(e){j=$();var t=(H=J()).memoizedState;return null===t?(e={current:e},H.memoizedState=e):t},useState:function(e){return te(ee,e)},useLayoutEffect:function(){},useCallback:function(e,t){return ne((function(){return e}),t)},useImperativeHandle:re,useEffect:re,useDebugValue:re,useDeferredValue:function(e){return $(),e},useTransition:function(){return $(),[function(e){e()},!1]},useOpaqueIdentifier:function(){return(oe.identifierPrefix||"")+"R:"+(oe.uniqueID++).toString(36)},useMutableSource:function(e,t){return $(),t(e._source)}},se="http://www.w3.org/1999/xhtml";function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}var ue={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},de=i({menuitem:!0},ue),ce={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];Object.keys(ce).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ce[t]=ce[e]}))}));var ge=/([A-Z])/g,pe=/^ms-/,fe=r.Children.toArray,me=I.ReactCurrentDispatcher,ve={listing:!0,pre:!0,textarea:!0},ye=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,_e={},be={},Ce=Object.prototype.hasOwnProperty,Te={children:null,dangerouslySetInnerHTML:null,suppressContentEditableWarning:null,suppressHydrationWarning:null};function Se(e,t){if(void 0===e)throw Error(o(152,S(t)||"Component"))}var Ie=function(){function e(e,t,n){r.isValidElement(e)?e.type!==s?e=[e]:(e=e.props.children,e=r.isValidElement(e)?[e]:fe(e)):e=fe(e),e={type:null,domNamespace:se,children:e,childIndex:0,context:w,footer:""};var i=x[0];if(0===i){var a=x,l=2*(i=a.length);if(!(65536>=l))throw Error(o(304));var u=new Uint16Array(l);for(u.set(a),(x=u)[0]=i+1,a=i;a<l-1;a++)x[a]=a+1;x[l-1]=0}else x[0]=x[i];this.threadID=i,this.stack=[e],this.exhausted=!1,this.currentSelectValue=null,this.previousWasTextNode=!1,this.makeStaticMarkup=t,this.suspenseDepth=0,this.contextIndex=-1,this.contextStack=[],this.contextValueStack=[],this.uniqueID=0,this.identifierPrefix=n&&n.identifierPrefix||""}var t=e.prototype;return t.destroy=function(){if(!this.exhausted){this.exhausted=!0,this.clearProviders();var e=this.threadID;x[e]=x[0],x[0]=e}},t.pushProvider=function(e){var t=++this.contextIndex,n=e.type._context,i=this.threadID;E(n,i);var r=n[i];this.contextStack[t]=n,this.contextValueStack[t]=r,n[i]=e.props.value},t.popProvider=function(){var e=this.contextIndex,t=this.contextStack[e],n=this.contextValueStack[e];this.contextStack[e]=null,this.contextValueStack[e]=null,this.contextIndex--,t[this.threadID]=n},t.clearProviders=function(){for(var e=this.contextIndex;0<=e;e--)this.contextStack[e][this.threadID]=this.contextValueStack[e]},t.read=function(e){if(this.exhausted)return null;var t=oe;oe=this;var n=me.current;me.current=ae;try{for(var i=[""],r=!1;i[0].length<e;){if(0===this.stack.length){this.exhausted=!0;var a=this.threadID;x[a]=x[0],x[0]=a;break}var s=this.stack[this.stack.length-1];if(r||s.childIndex>=s.children.length){var l=s.footer;if(""!==l&&(this.previousWasTextNode=!1),this.stack.pop(),"select"===s.type)this.currentSelectValue=null;else if(null!=s.type&&null!=s.type.type&&s.type.type.$$typeof===d)this.popProvider(s.type);else if(s.type===g){this.suspenseDepth--;var u=i.pop();if(r){r=!1;var c=s.fallbackFrame;if(!c)throw Error(o(303));this.stack.push(c),i[this.suspenseDepth]+="\x3c!--$!--\x3e";continue}i[this.suspenseDepth]+=u}i[this.suspenseDepth]+=l}else{var h=s.children[s.childIndex++],p="";try{p+=this.render(h,s.context,s.domNamespace)}catch(e){if(null!=e&&"function"==typeof e.then)throw Error(o(294));throw e}i.length<=this.suspenseDepth&&i.push(""),i[this.suspenseDepth]+=p}}return i[0]}finally{me.current=n,oe=t,X()}},t.render=function(e,t,n){if("string"==typeof e||"number"==typeof e)return""==(n=""+e)?"":this.makeStaticMarkup?q(n):this.previousWasTextNode?"\x3c!-- --\x3e"+q(n):(this.previousWasTextNode=!0,q(n));if(e=(t=function(e,t,n){function a(r,a){var s=a.prototype&&a.prototype.isReactComponent,l=function(e,t,n,i){if(i&&"object"==typeof(i=e.contextType)&&null!==i)return E(i,n),i[n];if(e=e.contextTypes){for(var r in n={},e)n[r]=t[r];t=n}else t=w;return t}(a,t,n,s),u=[],d=!1,c={isMounted:function(){return!1},enqueueForceUpdate:function(){if(null===u)return null},enqueueReplaceState:function(e,t){d=!0,u=[t]},enqueueSetState:function(e,t){if(null===u)return null;u.push(t)}};if(s){if(s=new a(r.props,l,c),"function"==typeof a.getDerivedStateFromProps){var h=a.getDerivedStateFromProps.call(null,r.props,s.state);null!=h&&(s.state=i({},s.state,h))}}else if(j={},s=a(r.props,l,c),null==(s=Y(a,r.props,s,l))||null==s.render)return void Se(e=s,a);if(s.props=r.props,s.context=l,s.updater=c,void 0===(c=s.state)&&(s.state=c=null),"function"==typeof s.UNSAFE_componentWillMount||"function"==typeof s.componentWillMount)if("function"==typeof s.componentWillMount&&"function"!=typeof a.getDerivedStateFromProps&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&"function"!=typeof a.getDerivedStateFromProps&&s.UNSAFE_componentWillMount(),u.length){c=u;var g=d;if(u=null,d=!1,g&&1===c.length)s.state=c[0];else{h=g?c[0]:s.state;var p=!0;for(g=g?1:0;g<c.length;g++){var f=c[g];null!=(f="function"==typeof f?f.call(s,h,r.props,l):f)&&(p?(p=!1,h=i({},h,f)):i(h,f))}s.state=h}}else u=null;if(Se(e=s.render(),a),"function"==typeof s.getChildContext&&"object"==typeof(r=a.childContextTypes)){var m=s.getChildContext();for(var v in m)if(!(v in r))throw Error(o(108,S(a)||"Unknown",v))}m&&(t=i({},t,m))}for(;r.isValidElement(e);){var s=e,l=s.type;if("function"!=typeof l)break;a(s,l)}return{child:e,context:t}}(e,t,this.threadID)).child,t=t.context,null===e||!1===e)return"";if(!r.isValidElement(e)){if(null!=e&&null!=e.$$typeof){if((n=e.$$typeof)===a)throw Error(o(257));throw Error(o(258,n.toString()))}return e=fe(e),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),""}var v=e.type;if("string"==typeof v)return this.renderDOM(e,t,n);switch(v){case C:case b:case l:case u:case p:case s:return e=fe(e.props.children),this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case g:throw Error(o(294));case _:throw Error(o(343))}if("object"==typeof v&&null!==v)switch(v.$$typeof){case h:j={};var T=v.render(e.props,e.ref);return T=Y(v.render,e.props,T,e.ref),T=fe(T),this.stack.push({type:null,domNamespace:n,children:T,childIndex:0,context:t,footer:""}),"";case f:return e=[r.createElement(v.type,i({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),"";case d:return n={type:e,domNamespace:n,children:v=fe(e.props.children),childIndex:0,context:t,footer:""},this.pushProvider(e),this.stack.push(n),"";case c:v=e.type,T=e.props;var I=this.threadID;return E(v,I),v=fe(T.children(v[I])),this.stack.push({type:e,domNamespace:n,children:v,childIndex:0,context:t,footer:""}),"";case y:throw Error(o(338));case m:return v=(T=(v=e.type)._init)(v._payload),e=[r.createElement(v,i({ref:e.ref},e.props))],this.stack.push({type:null,domNamespace:n,children:e,childIndex:0,context:t,footer:""}),""}throw Error(o(130,null==v?v:typeof v,""))},t.renderDOM=function(e,t,n){var a=e.type.toLowerCase();if(n===se&&le(a),!_e.hasOwnProperty(a)){if(!ye.test(a))throw Error(o(65,a));_e[a]=!0}var s=e.props;if("input"===a)s=i({type:void 0},s,{defaultChecked:void 0,defaultValue:void 0,value:null!=s.value?s.value:s.defaultValue,checked:null!=s.checked?s.checked:s.defaultChecked});else if("textarea"===a){var l=s.value;if(null==l){l=s.defaultValue;var u=s.children;if(null!=u){if(null!=l)throw Error(o(92));if(Array.isArray(u)){if(!(1>=u.length))throw Error(o(93));u=u[0]}l=""+u}null==l&&(l="")}s=i({},s,{value:void 0,children:""+l})}else if("select"===a)this.currentSelectValue=null!=s.value?s.value:s.defaultValue,s=i({},s,{value:void 0});else if("option"===a){u=this.currentSelectValue;var d=function(e){if(null==e)return e;var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(s.children);if(null!=u){var c=null!=s.value?s.value+"":d;if(l=!1,Array.isArray(u)){for(var h=0;h<u.length;h++)if(""+u[h]===c){l=!0;break}}else l=""+u===c;s=i({selected:void 0,children:void 0},s,{selected:l,children:d})}}if(l=s){if(de[a]&&(null!=l.children||null!=l.dangerouslySetInnerHTML))throw Error(o(137,a));if(null!=l.dangerouslySetInnerHTML){if(null!=l.children)throw Error(o(60));if("object"!=typeof l.dangerouslySetInnerHTML||!("__html"in l.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=l.style&&"object"!=typeof l.style)throw Error(o(62))}l=s,u=this.makeStaticMarkup,d=1===this.stack.length,c="<"+e.type;e:if(-1===a.indexOf("-"))h="string"==typeof l.is;else switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":h=!1;break e;default:h=!0}for(C in l)if(Ce.call(l,C)){var g=l[C];if(null!=g){if("style"===C){var p=void 0,f="",m="";for(p in g)if(g.hasOwnProperty(p)){var v=0===p.indexOf("--"),y=g[p];if(null!=y){if(v)var _=p;else if(_=p,be.hasOwnProperty(_))_=be[_];else{var b=_.replace(ge,"-$1").toLowerCase().replace(pe,"-ms-");_=be[_]=b}f+=m+_+":",m=p,f+=v=null==y||"boolean"==typeof y||""===y?"":v||"number"!=typeof y||0===y||ce.hasOwnProperty(m)&&ce[m]?(""+y).trim():y+"px",m=";"}}g=f||null}p=null,h?Te.hasOwnProperty(C)||(p=k(p=C)&&null!=g?p+'="'+q(g)+'"':""):p=U(C,g),p&&(c+=" "+p)}}u||d&&(c+=' data-reactroot=""');var C=c;l="",ue.hasOwnProperty(a)?C+="/>":(C+=">",l="</"+e.type+">");e:{if(null!=(u=s.dangerouslySetInnerHTML)){if(null!=u.__html){u=u.__html;break e}}else if("string"==typeof(u=s.children)||"number"==typeof u){u=q(u);break e}u=null}return null!=u?(s=[],ve.hasOwnProperty(a)&&"\n"===u.charAt(0)&&(C+="\n"),C+=u):s=fe(s.children),e=e.type,n=null==n||"http://www.w3.org/1999/xhtml"===n?le(e):"http://www.w3.org/2000/svg"===n&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":n,this.stack.push({domNamespace:n,type:a,children:s,childIndex:0,context:t,footer:l}),this.previousWasTextNode=!1,C},e}();t.renderToString=function(e,t){e=new Ie(e,!1,t);try{return e.read(1/0)}finally{e.destroy()}}},13918:(e,t,n)=>{"use strict";e.exports=n(12709)},13956:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>b});var i=n(95734),r=n(38883),o=n(13918),a=n(92949),s=n.n(a),l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};function u(e,t){return e(t={exports:{}},t.exports),t.exports}var d=u((function(e){!function(t){var n=function(e,t,i){if(!l(t)||d(t)||c(t)||h(t)||s(t))return t;var r,o=0,a=0;if(u(t))for(r=[],a=t.length;o<a;o++)r.push(n(e,t[o],i));else for(var g in r={},t)Object.prototype.hasOwnProperty.call(t,g)&&(r[e(g,i)]=n(e,t[g],i));return r},i=function(e){return g(e)?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1)},r=function(e){var t=i(e);return t.substr(0,1).toUpperCase()+t.substr(1)},o=function(e,t){return function(e,t){var n=(t=t||{}).separator||"_",i=t.split||/(?=[A-Z])/;return e.split(i).join(n)}(e,t).toLowerCase()},a=Object.prototype.toString,s=function(e){return"function"==typeof e},l=function(e){return e===Object(e)},u=function(e){return"[object Array]"==a.call(e)},d=function(e){return"[object Date]"==a.call(e)},c=function(e){return"[object RegExp]"==a.call(e)},h=function(e){return"[object Boolean]"==a.call(e)},g=function(e){return(e-=0)==e},p=function(e,t){var n=t&&"process"in t?t.process:t;return"function"!=typeof n?e:function(t,i){return n(t,e,i)}},f={camelize:i,decamelize:o,pascalize:r,depascalize:o,camelizeKeys:function(e,t){return n(p(i,t),e)},decamelizeKeys:function(e,t){return n(p(o,t),e,t)},pascalizeKeys:function(e,t){return n(p(r,t),e)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};e.exports?e.exports=f:t.humps=f}(l)})).decamelize,c=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i},h=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},g=u((function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},t.apply(this,arguments)}e.exports=t})),p=function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r},f=(0,i.createContext)(null);function m(e){var t=e.children,n=void 0===t?"":t,r=p(e,["children"]);return"string"!=typeof n&&(n=(0,o.renderToString)(n)),i.createElement("template",g({},r,{dangerouslySetInnerHTML:{__html:n}}))}function v(e){var t=e.root,n=e.children;return(0,r.createPortal)(void 0===n?null:n,t)}m.propTypes={children:s().oneOfType([s().string,s().node])},v.propTypes={root:s().object.isRequired,children:s().node};var y=new Map,_=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"core",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e.children};return new Proxy(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{get:function(n,r){var o=d(r,{separator:"-"}),a="".concat(e,"-").concat(o);return y.has(a)||y.set(a,function(e){var t=(0,i.forwardRef)((function(t,n){var r,o,a=t.mode,s=void 0===a?"open":a,l=t.delegatesFocus,u=void 0!==l&&l,d=t.styleSheets,c=void 0===d?[]:d,y=t.ssr,_=void 0!==y&&y,b=t.children,C=p(t,["mode","delegatesFocus","styleSheets","ssr","children"]),T=(o=(0,i.useRef)((r=n)&&r.current),(0,i.useEffect)((function(){r&&(r.current=o.current)}),[r]),o),S=(0,i.useState)(null),I=h(S,2),w=I[0],E=I[1],x="node_".concat(s).concat(u);return(0,i.useLayoutEffect)((function(){if(T.current)try{if("function"==typeof n&&n(T.current),_){var e=T.current.shadowRoot;return void E(e)}var t=T.current.attachShadow({mode:s,delegatesFocus:u});c.length>0&&(t.adoptedStyleSheets=c),E(t)}catch(e){!function(e){var t=e.error,n=e.styleSheets,i=e.root;if("NotSupportedError"!==t.name)throw t;n.length>0&&(i.adoptedStyleSheets=n)}({error:e,styleSheets:c,root:w})}}),[n,T,c]),i.createElement(i.Fragment,null,i.createElement(e.tag,g({key:x,ref:T},C),(w||_)&&i.createElement(f.Provider,{value:w},_?i.createElement(m,{shadowroot:s,shadowrootmode:s},e.render({root:w,ssr:_,children:b})):i.createElement(v,{root:w},e.render({root:w,ssr:_,children:b})))))}));return t.propTypes={mode:s().oneOf(["open","closed"]),delegatesFocus:s().bool,styleSheets:s().arrayOf(s().instanceOf(globalThis.CSSStyleSheet)),ssr:s().bool,children:s().node},t}({tag:o,render:t})),y.get(a)}})}();const b=_},69207:(e,t,n)=>{var i;!function(e){!function(t){var i="object"==typeof n.g?n.g:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=o(e);function o(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===i.Reflect?i.Reflect=e:r=o(i.Reflect,r),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,l={create:o?function(){return B(Object.create(null))}:a?function(){return B({__proto__:null})}:function(){return B({})},has:s?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:s?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),d="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,c=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[r]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var i=this._keys.length,r=n+1;r<i;r++)this._keys[r-1]=this._keys[r],this._values[r-1]=this._values[r];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,i)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[r]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}}():Map,h=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function e(){this._map=new c}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[r]=function(){return this.keys()},e}():Set,g=new(d||"function"!=typeof WeakMap?function(){var e=16,n=l.create(),i=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&l.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?l.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var e;do{e="@@WeakMap@@"+s()}while(l.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,i)){if(!n)return;Object.defineProperty(e,i,{value:l.create()})}return e[i]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(){var t,n=(t=e,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):a(new Uint8Array(t),t):a(new Array(t),t));n[6]=79&n[6]|64,n[8]=191&n[8]|128;for(var i="",r=0;r<e;++r){var o=n[r];4!==r&&6!==r&&8!==r||(i+="-"),o<16&&(i+="0"),i+=o.toString(16).toLowerCase()}return i}}():WeakMap);function p(e,t,n){var i=g.get(e);if(S(i)){if(!n)return;i=new c,g.set(e,i)}var r=i.get(t);if(S(r)){if(!n)return;r=new c,i.set(t,r)}return r}function f(e,t,n){if(m(e,t,n))return!0;var i=O(t);return!I(i)&&f(e,i,n)}function m(e,t,n){var i=p(t,n,!1);return!S(i)&&!!i.has(e)}function v(e,t,n){if(m(e,t,n))return y(e,t,n);var i=O(t);return I(i)?void 0:v(e,i,n)}function y(e,t,n){var i=p(t,n,!1);if(!S(i))return i.get(e)}function _(e,t,n,i){p(n,i,!0).set(e,t)}function b(e,t){var n=C(e,t),i=O(e);if(null===i)return n;var r=b(i,t);if(r.length<=0)return n;if(n.length<=0)return r;for(var o=new h,a=[],s=0,l=n;s<l.length;s++){var u=l[s];o.has(u)||(o.add(u),a.push(u))}for(var d=0,c=r;d<c.length;d++)u=c[d],o.has(u)||(o.add(u),a.push(u));return a}function C(e,t){var n=[],i=p(e,t,!1);if(S(i))return n;for(var o=function(e){var t=F(e,r);if(!D(t))throw new TypeError;var n=t.call(e);if(!w(n))throw new TypeError;return n}(i.keys()),a=0;;){var s=P(o);if(!s)return n.length=a,n;var l=s.value;try{n[a]=l}catch(e){try{k(o)}finally{throw e}}a++}}function T(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function S(e){return void 0===e}function I(e){return null===e}function w(e){return"object"==typeof e?null!==e:"function"==typeof e}function E(e,t){switch(T(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=F(e,i);if(void 0!==r){var o=r.call(e,n);if(w(o))throw new TypeError;return o}return function(e,t){if("string"===t){var n=e.toString;if(D(n)&&!w(r=n.call(e)))return r;if(D(i=e.valueOf)&&!w(r=i.call(e)))return r}else{var i;if(D(i=e.valueOf)&&!w(r=i.call(e)))return r;var r,o=e.toString;if(D(o)&&!w(r=o.call(e)))return r}throw new TypeError}(e,"default"===n?"number":n)}function x(e){var t=E(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function A(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function D(e){return"function"==typeof e}function N(e){return"function"==typeof e}function F(e,t){var n=e[t];if(null!=n){if(!D(n))throw new TypeError;return n}}function P(e){var t=e.next();return!t.done&&t}function k(e){var t=e.return;t&&t.call(e)}function O(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var r=i.constructor;return"function"!=typeof r||r===e?t:r}function B(e){return e.__=void 0,delete e.__,e}e("decorate",(function(e,t,n,i){if(S(n)){if(!A(e))throw new TypeError;if(!N(t))throw new TypeError;return function(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!S(i)&&!I(i)){if(!N(i))throw new TypeError;t=i}}return t}(e,t)}if(!A(e))throw new TypeError;if(!w(t))throw new TypeError;if(!w(i)&&!S(i)&&!I(i))throw new TypeError;return I(i)&&(i=void 0),function(e,t,n,i){for(var r=e.length-1;r>=0;--r){var o=(0,e[r])(t,n,i);if(!S(o)&&!I(o)){if(!w(o))throw new TypeError;i=o}}return i}(e,t,n=x(n),i)})),e("metadata",(function(e,t){return function(n,i){if(!w(n))throw new TypeError;if(!S(i)&&!function(e){switch(T(e)){case 3:case 4:return!0;default:return!1}}(i))throw new TypeError;_(e,t,n,i)}})),e("defineMetadata",(function(e,t,n,i){if(!w(n))throw new TypeError;return S(i)||(i=x(i)),_(e,t,n,i)})),e("hasMetadata",(function(e,t,n){if(!w(t))throw new TypeError;return S(n)||(n=x(n)),f(e,t,n)})),e("hasOwnMetadata",(function(e,t,n){if(!w(t))throw new TypeError;return S(n)||(n=x(n)),m(e,t,n)})),e("getMetadata",(function(e,t,n){if(!w(t))throw new TypeError;return S(n)||(n=x(n)),v(e,t,n)})),e("getOwnMetadata",(function(e,t,n){if(!w(t))throw new TypeError;return S(n)||(n=x(n)),y(e,t,n)})),e("getMetadataKeys",(function(e,t){if(!w(e))throw new TypeError;return S(t)||(t=x(t)),b(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!w(e))throw new TypeError;return S(t)||(t=x(t)),C(e,t)})),e("deleteMetadata",(function(e,t,n){if(!w(t))throw new TypeError;S(n)||(n=x(n));var i=p(t,n,!1);if(S(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var r=g.get(t);return r.delete(n),r.size>0||g.delete(t),!0}))}(r)}()}(i||(i={}))},86432:(e,t)=>{"use strict";var n=function(e,t){for(var n=!1,i=0;i<e.length;i+=1)e[i]===t&&(n=!0,e.splice(i,1),i-=1);return n},i=function(){function e(){this.anyRegistrations=[],this.registrations={}}return e.prototype.on=function(e,t){this.safelyGetRegistration(e).listeners.push(t)},e.prototype.onFirst=function(e,t){var n=this.safelyGetRegistration(e);void 0!==n.firstArgs&&t.apply(void 0,n.firstArgs),n.firstOnlyListeners.push(t)},e.prototype.onAny=function(e){this.anyRegistrations.push(e)},e.prototype.off=function(e,t){if(void 0!==e)if(void 0!==t){var i=this.safelyGetRegistration(e),r=n(i.listeners,t),o=n(i.firstOnlyListeners,t);if(!r&&!o)throw new Error("Tried to remove a non-existent listener for event name '"+e+"'.")}else this.registrations[e]={firstOnlyListeners:[],listeners:[]};else this.registrations={}},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=this.safelyGetRegistration(e);if(void 0===i.firstArgs){for(var r=0,o=i.firstOnlyListeners;r<o.length;r++)o[r].apply(void 0,t);i.firstArgs=t,i.firstOnlyListeners=[]}for(var a=0,s=i.listeners;a<s.length;a++)s[a].apply(void 0,t);for(var l=0,u=this.anyRegistrations;l<u.length;l++)u[l].apply(void 0,[e].concat(t))},e.prototype.waitFor=function(e){var t=this;return new Promise((function(n){var i=function(r){n(r),t.off(e,i)};t.on(e,i)}))},e.prototype.waitForFirst=function(e){var t=this;return new Promise((function(n){var i=function(r){n(r),t.off(e,i)};t.onFirst(e,i)}))},e.prototype.safelyGetRegistration=function(e){return void 0===this.registrations[e]&&(this.registrations[e]={firstOnlyListeners:[],listeners:[]}),this.registrations[e]},e}();t.bk=i},4413:(e,t,n)=>{"use strict";var i;n.d(t,{A:()=>d});var r=new Uint8Array(16);function o(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)}const a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=[],l=0;l<256;++l)s.push((l+256).toString(16).substr(1));const u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&a.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n},d=function(e,t,n){var i=(e=e||{}).random||(e.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return u(i)}},90994:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});var i=n(14269),r=n.n(i);function o(){return r()('(()=>{var t={8:t=>{var e=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},n=-1;e.Diff=function(t,e){return[t,e]},e.prototype.diff_main=function(t,n,i,r){void 0===r&&(r=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var s=r;if(null==t||null==n)throw new Error("Null input. (diff_main)");if(t==n)return t?[new e.Diff(0,t)]:[];void 0===i&&(i=!0);var h=i,f=this.diff_commonPrefix(t,n),a=t.substring(0,f);t=t.substring(f),n=n.substring(f),f=this.diff_commonSuffix(t,n);var l=t.substring(t.length-f);t=t.substring(0,t.length-f),n=n.substring(0,n.length-f);var g=this.diff_compute_(t,n,h,s);return a&&g.unshift(new e.Diff(0,a)),l&&g.push(new e.Diff(0,l)),this.diff_cleanupMerge(g),g},e.prototype.diff_compute_=function(t,i,r,s){var h;if(!t)return[new e.Diff(1,i)];if(!i)return[new e.Diff(n,t)];var f=t.length>i.length?t:i,a=t.length>i.length?i:t,l=f.indexOf(a);if(-1!=l)return h=[new e.Diff(1,f.substring(0,l)),new e.Diff(0,a),new e.Diff(1,f.substring(l+a.length))],t.length>i.length&&(h[0][0]=h[2][0]=n),h;if(1==a.length)return[new e.Diff(n,t),new e.Diff(1,i)];var g=this.diff_halfMatch_(t,i);if(g){var o=g[0],c=g[1],u=g[2],p=g[3],d=g[4],_=this.diff_main(o,u,r,s),b=this.diff_main(c,p,r,s);return _.concat([new e.Diff(0,d)],b)}return r&&t.length>100&&i.length>100?this.diff_lineMode_(t,i,s):this.diff_bisect_(t,i,s)},e.prototype.diff_lineMode_=function(t,i,r){var s=this.diff_linesToChars_(t,i);t=s.chars1,i=s.chars2;var h=s.lineArray,f=this.diff_main(t,i,!1,r);this.diff_charsToLines_(f,h),this.diff_cleanupSemantic(f),f.push(new e.Diff(0,""));for(var a=0,l=0,g=0,o="",c="";a<f.length;){switch(f[a][0]){case 1:g++,c+=f[a][1];break;case n:l++,o+=f[a][1];break;case 0:if(l>=1&&g>=1){f.splice(a-l-g,l+g),a=a-l-g;for(var u=this.diff_main(o,c,!1,r),p=u.length-1;p>=0;p--)f.splice(a,0,u[p]);a+=u.length}g=0,l=0,o="",c=""}a++}return f.pop(),f},e.prototype.diff_bisect_=function(t,i,r){for(var s=t.length,h=i.length,f=Math.ceil((s+h)/2),a=f,l=2*f,g=new Array(l),o=new Array(l),c=0;c<l;c++)g[c]=-1,o[c]=-1;g[a+1]=0,o[a+1]=0;for(var u=s-h,p=u%2!=0,d=0,_=0,b=0,v=0,m=0;m<f&&!((new Date).getTime()>r);m++){for(var w=-m+d;w<=m-_;w+=2){for(var x=a+w,M=(E=w==-m||w!=m&&g[x-1]<g[x+1]?g[x+1]:g[x-1]+1)-w;E<s&&M<h&&t.charAt(E)==i.charAt(M);)E++,M++;if(g[x]=E,E>s)_+=2;else if(M>h)d+=2;else if(p&&(k=a+u-w)>=0&&k<l&&-1!=o[k]&&E>=(D=s-o[k]))return this.diff_bisectSplit_(t,i,E,M,r)}for(var y=-m+b;y<=m-v;y+=2){for(var D,k=a+y,A=(D=y==-m||y!=m&&o[k-1]<o[k+1]?o[k+1]:o[k-1]+1)-y;D<s&&A<h&&t.charAt(s-D-1)==i.charAt(h-A-1);)D++,A++;if(o[k]=D,D>s)v+=2;else if(A>h)b+=2;else if(!p){var E;if((x=a+u-y)>=0&&x<l&&-1!=g[x])if(M=a+(E=g[x])-x,E>=(D=s-D))return this.diff_bisectSplit_(t,i,E,M,r)}}}return[new e.Diff(n,t),new e.Diff(1,i)]},e.prototype.diff_bisectSplit_=function(t,e,n,i,r){var s=t.substring(0,n),h=e.substring(0,i),f=t.substring(n),a=e.substring(i),l=this.diff_main(s,h,!1,r),g=this.diff_main(f,a,!1,r);return l.concat(g)},e.prototype.diff_linesToChars_=function(t,e){var n=[],i={};function r(t){for(var e="",r=0,h=-1,f=n.length;h<t.length-1;){-1==(h=t.indexOf("\\n",r))&&(h=t.length-1);var a=t.substring(r,h+1);(i.hasOwnProperty?i.hasOwnProperty(a):void 0!==i[a])?e+=String.fromCharCode(i[a]):(f==s&&(a=t.substring(r),h=t.length),e+=String.fromCharCode(f),i[a]=f,n[f++]=a),r=h+1}return e}n[0]="";var s=4e4,h=r(t);return s=65535,{chars1:h,chars2:r(e),lineArray:n}},e.prototype.diff_charsToLines_=function(t,e){for(var n=0;n<t.length;n++){for(var i=t[n][1],r=[],s=0;s<i.length;s++)r[s]=e[i.charCodeAt(s)];t[n][1]=r.join("")}},e.prototype.diff_commonPrefix=function(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(s,r)==e.substring(s,r)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonSuffix=function(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,i=Math.min(t.length,e.length),r=i,s=0;n<r;)t.substring(t.length-r,t.length-s)==e.substring(e.length-r,e.length-s)?s=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonOverlap_=function(t,e){var n=t.length,i=e.length;if(0==n||0==i)return 0;n>i?t=t.substring(n-i):n<i&&(e=e.substring(0,n));var r=Math.min(n,i);if(t==e)return r;for(var s=0,h=1;;){var f=t.substring(r-h),a=e.indexOf(f);if(-1==a)return s;h+=a,0!=a&&t.substring(r-h)!=e.substring(0,h)||(s=h,h++)}},e.prototype.diff_halfMatch_=function(t,e){if(this.Diff_Timeout<=0)return null;var n=t.length>e.length?t:e,i=t.length>e.length?e:t;if(n.length<4||2*i.length<n.length)return null;var r=this;function s(t,e,n){for(var i,s,h,f,a=t.substring(n,n+Math.floor(t.length/4)),l=-1,g="";-1!=(l=e.indexOf(a,l+1));){var o=r.diff_commonPrefix(t.substring(n),e.substring(l)),c=r.diff_commonSuffix(t.substring(0,n),e.substring(0,l));g.length<c+o&&(g=e.substring(l-c,l)+e.substring(l,l+o),i=t.substring(0,n-c),s=t.substring(n+o),h=e.substring(0,l-c),f=e.substring(l+o))}return 2*g.length>=t.length?[i,s,h,f,g]:null}var h,f,a,l,g,o=s(n,i,Math.ceil(n.length/4)),c=s(n,i,Math.ceil(n.length/2));return o||c?(h=c?o&&o[4].length>c[4].length?o:c:o,t.length>e.length?(f=h[0],a=h[1],l=h[2],g=h[3]):(l=h[0],g=h[1],f=h[2],a=h[3]),[f,a,l,g,h[4]]):null},e.prototype.diff_cleanupSemantic=function(t){for(var i=!1,r=[],s=0,h=null,f=0,a=0,l=0,g=0,o=0;f<t.length;)0==t[f][0]?(r[s++]=f,a=g,l=o,g=0,o=0,h=t[f][1]):(1==t[f][0]?g+=t[f][1].length:o+=t[f][1].length,h&&h.length<=Math.max(a,l)&&h.length<=Math.max(g,o)&&(t.splice(r[s-1],0,new e.Diff(n,h)),t[r[s-1]+1][0]=1,s--,f=--s>0?r[s-1]:-1,a=0,l=0,g=0,o=0,h=null,i=!0)),f++;for(i&&this.diff_cleanupMerge(t),this.diff_cleanupSemanticLossless(t),f=1;f<t.length;){if(t[f-1][0]==n&&1==t[f][0]){var c=t[f-1][1],u=t[f][1],p=this.diff_commonOverlap_(c,u),d=this.diff_commonOverlap_(u,c);p>=d?(p>=c.length/2||p>=u.length/2)&&(t.splice(f,0,new e.Diff(0,u.substring(0,p))),t[f-1][1]=c.substring(0,c.length-p),t[f+1][1]=u.substring(p),f++):(d>=c.length/2||d>=u.length/2)&&(t.splice(f,0,new e.Diff(0,c.substring(0,d))),t[f-1][0]=1,t[f-1][1]=u.substring(0,u.length-d),t[f+1][0]=n,t[f+1][1]=c.substring(d),f++),f++}f++}},e.prototype.diff_cleanupSemanticLossless=function(t){function n(t,n){if(!t||!n)return 6;var i=t.charAt(t.length-1),r=n.charAt(0),s=i.match(e.nonAlphaNumericRegex_),h=r.match(e.nonAlphaNumericRegex_),f=s&&i.match(e.whitespaceRegex_),a=h&&r.match(e.whitespaceRegex_),l=f&&i.match(e.linebreakRegex_),g=a&&r.match(e.linebreakRegex_),o=l&&t.match(e.blanklineEndRegex_),c=g&&n.match(e.blanklineStartRegex_);return o||c?5:l||g?4:s&&!f&&a?3:f||a?2:s||h?1:0}for(var i=1;i<t.length-1;){if(0==t[i-1][0]&&0==t[i+1][0]){var r=t[i-1][1],s=t[i][1],h=t[i+1][1],f=this.diff_commonSuffix(r,s);if(f){var a=s.substring(s.length-f);r=r.substring(0,r.length-f),s=a+s.substring(0,s.length-f),h=a+h}for(var l=r,g=s,o=h,c=n(r,s)+n(s,h);s.charAt(0)===h.charAt(0);){r+=s.charAt(0),s=s.substring(1)+h.charAt(0),h=h.substring(1);var u=n(r,s)+n(s,h);u>=c&&(c=u,l=r,g=s,o=h)}t[i-1][1]!=l&&(l?t[i-1][1]=l:(t.splice(i-1,1),i--),t[i][1]=g,o?t[i+1][1]=o:(t.splice(i+1,1),i--))}i++}},e.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,e.whitespaceRegex_=/\\s/,e.linebreakRegex_=/[\\r\\n]/,e.blanklineEndRegex_=/\\n\\r?\\n$/,e.blanklineStartRegex_=/^\\r?\\n\\r?\\n/,e.prototype.diff_cleanupEfficiency=function(t){for(var i=!1,r=[],s=0,h=null,f=0,a=!1,l=!1,g=!1,o=!1;f<t.length;)0==t[f][0]?(t[f][1].length<this.Diff_EditCost&&(g||o)?(r[s++]=f,a=g,l=o,h=t[f][1]):(s=0,h=null),g=o=!1):(t[f][0]==n?o=!0:g=!0,h&&(a&&l&&g&&o||h.length<this.Diff_EditCost/2&&a+l+g+o==3)&&(t.splice(r[s-1],0,new e.Diff(n,h)),t[r[s-1]+1][0]=1,s--,h=null,a&&l?(g=o=!0,s=0):(f=--s>0?r[s-1]:-1,g=o=!1),i=!0)),f++;i&&this.diff_cleanupMerge(t)},e.prototype.diff_cleanupMerge=function(t){t.push(new e.Diff(0,""));for(var i,r=0,s=0,h=0,f="",a="";r<t.length;)switch(t[r][0]){case 1:h++,a+=t[r][1],r++;break;case n:s++,f+=t[r][1],r++;break;case 0:s+h>1?(0!==s&&0!==h&&(0!==(i=this.diff_commonPrefix(a,f))&&(r-s-h>0&&0==t[r-s-h-1][0]?t[r-s-h-1][1]+=a.substring(0,i):(t.splice(0,0,new e.Diff(0,a.substring(0,i))),r++),a=a.substring(i),f=f.substring(i)),0!==(i=this.diff_commonSuffix(a,f))&&(t[r][1]=a.substring(a.length-i)+t[r][1],a=a.substring(0,a.length-i),f=f.substring(0,f.length-i))),r-=s+h,t.splice(r,s+h),f.length&&(t.splice(r,0,new e.Diff(n,f)),r++),a.length&&(t.splice(r,0,new e.Diff(1,a)),r++),r++):0!==r&&0==t[r-1][0]?(t[r-1][1]+=t[r][1],t.splice(r,1)):r++,h=0,s=0,f="",a=""}""===t[t.length-1][1]&&t.pop();var l=!1;for(r=1;r<t.length-1;)0==t[r-1][0]&&0==t[r+1][0]&&(t[r][1].substring(t[r][1].length-t[r-1][1].length)==t[r-1][1]?(t[r][1]=t[r-1][1]+t[r][1].substring(0,t[r][1].length-t[r-1][1].length),t[r+1][1]=t[r-1][1]+t[r+1][1],t.splice(r-1,1),l=!0):t[r][1].substring(0,t[r+1][1].length)==t[r+1][1]&&(t[r-1][1]+=t[r+1][1],t[r][1]=t[r][1].substring(t[r+1][1].length)+t[r+1][1],t.splice(r+1,1),l=!0)),r++;l&&this.diff_cleanupMerge(t)},e.prototype.diff_xIndex=function(t,e){var i,r=0,s=0,h=0,f=0;for(i=0;i<t.length&&(1!==t[i][0]&&(r+=t[i][1].length),t[i][0]!==n&&(s+=t[i][1].length),!(r>e));i++)h=r,f=s;return t.length!=i&&t[i][0]===n?f:f+(e-h)},e.prototype.diff_prettyHtml=function(t){for(var e=[],i=/&/g,r=/</g,s=/>/g,h=/\\n/g,f=0;f<t.length;f++){var a=t[f][0],l=t[f][1].replace(i,"&amp;").replace(r,"&lt;").replace(s,"&gt;").replace(h,"&para;<br>");switch(a){case 1:e[f]=\'<ins style="background:#e6ffe6;">\'+l+"</ins>";break;case n:e[f]=\'<del style="background:#ffe6e6;">\'+l+"</del>";break;case 0:e[f]="<span>"+l+"</span>"}}return e.join("")},e.prototype.diff_text1=function(t){for(var e=[],n=0;n<t.length;n++)1!==t[n][0]&&(e[n]=t[n][1]);return e.join("")},e.prototype.diff_text2=function(t){for(var e=[],i=0;i<t.length;i++)t[i][0]!==n&&(e[i]=t[i][1]);return e.join("")},e.prototype.diff_levenshtein=function(t){for(var e=0,i=0,r=0,s=0;s<t.length;s++){var h=t[s][0],f=t[s][1];switch(h){case 1:i+=f.length;break;case n:r+=f.length;break;case 0:e+=Math.max(i,r),i=0,r=0}}return e+Math.max(i,r)},e.prototype.diff_toDelta=function(t){for(var e=[],i=0;i<t.length;i++)switch(t[i][0]){case 1:e[i]="+"+encodeURI(t[i][1]);break;case n:e[i]="-"+t[i][1].length;break;case 0:e[i]="="+t[i][1].length}return e.join("\\t").replace(/%20/g," ")},e.prototype.diff_fromDelta=function(t,i){for(var r=[],s=0,h=0,f=i.split(/\\t/g),a=0;a<f.length;a++){var l=f[a].substring(1);switch(f[a].charAt(0)){case"+":try{r[s++]=new e.Diff(1,decodeURI(l))}catch(t){throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var g=parseInt(l,10);if(isNaN(g)||g<0)throw new Error("Invalid number in diff_fromDelta: "+l);var o=t.substring(h,h+=g);"="==f[a].charAt(0)?r[s++]=new e.Diff(0,o):r[s++]=new e.Diff(n,o);break;default:if(f[a])throw new Error("Invalid diff operation in diff_fromDelta: "+f[a])}}if(h!=t.length)throw new Error("Delta length ("+h+") does not equal source text length ("+t.length+").");return r},e.prototype.match_main=function(t,e,n){if(null==t||null==e||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,t.length)),t==e?0:t.length?t.substring(n,n+e.length)==e?n:this.match_bitap_(t,e,n):-1},e.prototype.match_bitap_=function(t,e,n){if(e.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var i=this.match_alphabet_(e),r=this;function s(t,i){var s=t/e.length,h=Math.abs(n-i);return r.Match_Distance?s+h/r.Match_Distance:h?1:s}var h=this.Match_Threshold,f=t.indexOf(e,n);-1!=f&&(h=Math.min(s(0,f),h),-1!=(f=t.lastIndexOf(e,n+e.length))&&(h=Math.min(s(0,f),h)));var a,l,g=1<<e.length-1;f=-1;for(var o,c=e.length+t.length,u=0;u<e.length;u++){for(a=0,l=c;a<l;)s(u,n+l)<=h?a=l:c=l,l=Math.floor((c-a)/2+a);c=l;var p=Math.max(1,n-l+1),d=Math.min(n+l,t.length)+e.length,_=Array(d+2);_[d+1]=(1<<u)-1;for(var b=d;b>=p;b--){var v=i[t.charAt(b-1)];if(_[b]=0===u?(_[b+1]<<1|1)&v:(_[b+1]<<1|1)&v|(o[b+1]|o[b])<<1|1|o[b+1],_[b]&g){var m=s(u,b-1);if(m<=h){if(h=m,!((f=b-1)>n))break;p=Math.max(1,2*n-f)}}}if(s(u+1,n)>h)break;o=_}return f},e.prototype.match_alphabet_=function(t){for(var e={},n=0;n<t.length;n++)e[t.charAt(n)]=0;for(n=0;n<t.length;n++)e[t.charAt(n)]|=1<<t.length-n-1;return e},e.prototype.patch_addContext_=function(t,n){if(0!=n.length){if(null===t.start2)throw Error("patch not initialized");for(var i=n.substring(t.start2,t.start2+t.length1),r=0;n.indexOf(i)!=n.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)r+=this.Patch_Margin,i=n.substring(t.start2-r,t.start2+t.length1+r);r+=this.Patch_Margin;var s=n.substring(t.start2-r,t.start2);s&&t.diffs.unshift(new e.Diff(0,s));var h=n.substring(t.start2+t.length1,t.start2+t.length1+r);h&&t.diffs.push(new e.Diff(0,h)),t.start1-=s.length,t.start2-=s.length,t.length1+=s.length+h.length,t.length2+=s.length+h.length}},e.prototype.patch_make=function(t,i,r){var s,h;if("string"==typeof t&&"string"==typeof i&&void 0===r)s=t,(h=this.diff_main(s,i,!0)).length>2&&(this.diff_cleanupSemantic(h),this.diff_cleanupEfficiency(h));else if(t&&"object"==typeof t&&void 0===i&&void 0===r)h=t,s=this.diff_text1(h);else if("string"==typeof t&&i&&"object"==typeof i&&void 0===r)s=t,h=i;else{if("string"!=typeof t||"string"!=typeof i||!r||"object"!=typeof r)throw new Error("Unknown call format to patch_make.");s=t,h=r}if(0===h.length)return[];for(var f=[],a=new e.patch_obj,l=0,g=0,o=0,c=s,u=s,p=0;p<h.length;p++){var d=h[p][0],_=h[p][1];switch(l||0===d||(a.start1=g,a.start2=o),d){case 1:a.diffs[l++]=h[p],a.length2+=_.length,u=u.substring(0,o)+_+u.substring(o);break;case n:a.length1+=_.length,a.diffs[l++]=h[p],u=u.substring(0,o)+u.substring(o+_.length);break;case 0:_.length<=2*this.Patch_Margin&&l&&h.length!=p+1?(a.diffs[l++]=h[p],a.length1+=_.length,a.length2+=_.length):_.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(a,c),f.push(a),a=new e.patch_obj,l=0,c=u,g=o)}1!==d&&(g+=_.length),d!==n&&(o+=_.length)}return l&&(this.patch_addContext_(a,c),f.push(a)),f},e.prototype.patch_deepCopy=function(t){for(var n=[],i=0;i<t.length;i++){var r=t[i],s=new e.patch_obj;s.diffs=[];for(var h=0;h<r.diffs.length;h++)s.diffs[h]=new e.Diff(r.diffs[h][0],r.diffs[h][1]);s.start1=r.start1,s.start2=r.start2,s.length1=r.length1,s.length2=r.length2,n[i]=s}return n},e.prototype.patch_apply=function(t,e){if(0==t.length)return[e,[]];t=this.patch_deepCopy(t);var i=this.patch_addPadding(t);e=i+e+i,this.patch_splitMax(t);for(var r=0,s=[],h=0;h<t.length;h++){var f,a,l=t[h].start2+r,g=this.diff_text1(t[h].diffs),o=-1;if(g.length>this.Match_MaxBits?-1!=(f=this.match_main(e,g.substring(0,this.Match_MaxBits),l))&&(-1==(o=this.match_main(e,g.substring(g.length-this.Match_MaxBits),l+g.length-this.Match_MaxBits))||f>=o)&&(f=-1):f=this.match_main(e,g,l),-1==f)s[h]=!1,r-=t[h].length2-t[h].length1;else if(s[h]=!0,r=f-l,g==(a=-1==o?e.substring(f,f+g.length):e.substring(f,o+this.Match_MaxBits)))e=e.substring(0,f)+this.diff_text2(t[h].diffs)+e.substring(f+g.length);else{var c=this.diff_main(g,a,!1);if(g.length>this.Match_MaxBits&&this.diff_levenshtein(c)/g.length>this.Patch_DeleteThreshold)s[h]=!1;else{this.diff_cleanupSemanticLossless(c);for(var u,p=0,d=0;d<t[h].diffs.length;d++){var _=t[h].diffs[d];0!==_[0]&&(u=this.diff_xIndex(c,p)),1===_[0]?e=e.substring(0,f+u)+_[1]+e.substring(f+u):_[0]===n&&(e=e.substring(0,f+u)+e.substring(f+this.diff_xIndex(c,p+_[1].length))),_[0]!==n&&(p+=_[1].length)}}}}return[e=e.substring(i.length,e.length-i.length),s]},e.prototype.patch_addPadding=function(t){for(var n=this.Patch_Margin,i="",r=1;r<=n;r++)i+=String.fromCharCode(r);for(r=0;r<t.length;r++)t[r].start1+=n,t[r].start2+=n;var s=t[0],h=s.diffs;if(0==h.length||0!=h[0][0])h.unshift(new e.Diff(0,i)),s.start1-=n,s.start2-=n,s.length1+=n,s.length2+=n;else if(n>h[0][1].length){var f=n-h[0][1].length;h[0][1]=i.substring(h[0][1].length)+h[0][1],s.start1-=f,s.start2-=f,s.length1+=f,s.length2+=f}return 0==(h=(s=t[t.length-1]).diffs).length||0!=h[h.length-1][0]?(h.push(new e.Diff(0,i)),s.length1+=n,s.length2+=n):n>h[h.length-1][1].length&&(f=n-h[h.length-1][1].length,h[h.length-1][1]+=i.substring(0,f),s.length1+=f,s.length2+=f),i},e.prototype.patch_splitMax=function(t){for(var i=this.Match_MaxBits,r=0;r<t.length;r++)if(!(t[r].length1<=i)){var s=t[r];t.splice(r--,1);for(var h=s.start1,f=s.start2,a="";0!==s.diffs.length;){var l=new e.patch_obj,g=!0;for(l.start1=h-a.length,l.start2=f-a.length,""!==a&&(l.length1=l.length2=a.length,l.diffs.push(new e.Diff(0,a)));0!==s.diffs.length&&l.length1<i-this.Patch_Margin;){var o=s.diffs[0][0],c=s.diffs[0][1];1===o?(l.length2+=c.length,f+=c.length,l.diffs.push(s.diffs.shift()),g=!1):o===n&&1==l.diffs.length&&0==l.diffs[0][0]&&c.length>2*i?(l.length1+=c.length,h+=c.length,g=!1,l.diffs.push(new e.Diff(o,c)),s.diffs.shift()):(c=c.substring(0,i-l.length1-this.Patch_Margin),l.length1+=c.length,h+=c.length,0===o?(l.length2+=c.length,f+=c.length):g=!1,l.diffs.push(new e.Diff(o,c)),c==s.diffs[0][1]?s.diffs.shift():s.diffs[0][1]=s.diffs[0][1].substring(c.length))}a=(a=this.diff_text2(l.diffs)).substring(a.length-this.Patch_Margin);var u=this.diff_text1(s.diffs).substring(0,this.Patch_Margin);""!==u&&(l.length1+=u.length,l.length2+=u.length,0!==l.diffs.length&&0===l.diffs[l.diffs.length-1][0]?l.diffs[l.diffs.length-1][1]+=u:l.diffs.push(new e.Diff(0,u))),g||t.splice(++r,0,l)}}},e.prototype.patch_toText=function(t){for(var e=[],n=0;n<t.length;n++)e[n]=t[n];return e.join("")},e.prototype.patch_fromText=function(t){var i=[];if(!t)return i;for(var r=t.split("\\n"),s=0,h=/^@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@$/;s<r.length;){var f=r[s].match(h);if(!f)throw new Error("Invalid patch string: "+r[s]);var a=new e.patch_obj;for(i.push(a),a.start1=parseInt(f[1],10),""===f[2]?(a.start1--,a.length1=1):"0"==f[2]?a.length1=0:(a.start1--,a.length1=parseInt(f[2],10)),a.start2=parseInt(f[3],10),""===f[4]?(a.start2--,a.length2=1):"0"==f[4]?a.length2=0:(a.start2--,a.length2=parseInt(f[4],10)),s++;s<r.length;){var l=r[s].charAt(0);try{var g=decodeURI(r[s].substring(1))}catch(t){throw new Error("Illegal escape in patch_fromText: "+g)}if("-"==l)a.diffs.push(new e.Diff(n,g));else if("+"==l)a.diffs.push(new e.Diff(1,g));else if(" "==l)a.diffs.push(new e.Diff(0,g));else{if("@"==l)break;if(""!==l)throw new Error(\'Invalid patch mode "\'+l+\'" in: \'+g)}s++}}return i},(e.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var t,e=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\\n"],i=0;i<this.diffs.length;i++){switch(this.diffs[i][0]){case 1:t="+";break;case n:t="-";break;case 0:t=" "}e[i+1]=t+encodeURI(this.diffs[i][1])+"\\n"}return e.join("").replace(/%20/g," ")},t.exports=e,t.exports.diff_match_patch=e,t.exports.DIFF_DELETE=n,t.exports.DIFF_INSERT=1,t.exports.DIFF_EQUAL=0}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";const t=new(n(8).diff_match_patch);t.Diff_Timeout=0;const e=(t,e)=>t.index>=0?(t.index=e,t):e;addEventListener("message",(n=>{"get-url"!==n.data[0]?(n=>{try{const r=[],s=n.data[0],h=n.data[1],f=n.data[2],a=t.diff_main(s,h);1===a.length&&0===a[0][0]&&n.ports[0].postMessage({result:f});let l=0,g=0,o=0,c=0,u=0,p=0;for(const t of a){const n=t[0],s=t[1].length;switch(n){case 0:u=s,p=s;break;case 1:u=0,p=s;break;case-1:o+=s;continue}g+=o,o=0;for(let t=l;t<f.length;t+=1){const s=(i=f[t]).index>=0?i.index:i;if(s<c)throw new Error("Indices are not sorted!");if(!(s>=c&&s<c+p))break;r[t]=e(f[t],0===n?s+g-c:g),l+=1}if(l===f.length)break;g+=u,c+=p}for(let t=l;t<f.length;t+=1)r[t]=e(f[t],g);n.ports[0].postMessage({result:r})}catch(t){n.ports[0].postMessage({error:t})}var i})(n):n.ports[0].postMessage({url:self.location.href})}),!1)})()})();\n//# sourceMappingURL=index-readjuster-worker.worker.js.map',"Worker",void 0,n.p+"index-readjuster-worker.worker.js")}},14269:e=>{"use strict";e.exports=function(e,t,n,i){var r=self||window;try{try{var o;try{o=new r.Blob([e])}catch(t){(o=new(r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder)).append(e),o=o.getBlob()}var a=r.URL||r.webkitURL,s=a.createObjectURL(o),l=new r[t](s,n);return a.revokeObjectURL(s),l}catch(i){return new r[t]("data:application/javascript,".concat(encodeURIComponent(e)),n)}}catch(e){if(!i)throw Error("Inline worker is not supported");return new r[t](i,n)}}}}]);
//# sourceMappingURL=sccserviceciq.js.map