/*! For license information please see vendor.js.LICENSE.txt */
(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([[121],{81958:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DictationEventsType:()=>i.Ff,SpeechToTextProfile:()=>s.A,VoiceSession:()=>v});var o=n(97953),r=n(52865),s=n(90913),i=n(21965),a=n(72514),l=n(3316),c=n(54585),u=n(82058),d=n(88943),h=n(48316);class p{constructor(){this.count=0,this.total={service:0,perceived:0},this.min={service:Number.MAX_VALUE,perceived:Number.MAX_VALUE},this.max={service:0,perceived:0}}add(e){this.count++,this.total.perceived+=e.perceived,this.total.service+=e.service,this.min.perceived=Math.min(e.perceived,this.min.perceived),this.min.service=Math.min(e.service,this.min.service),this.max.perceived=Math.max(e.perceived,this.max.perceived),this.max.service=Math.max(e.service,this.max.service)}getAverages(){return 0===this.count?{perceived:-1,service:-1}:{perceived:this.total.perceived/this.count,service:this.total.service/this.count}}}class f{constructor(e,t,n,o){this.finals=new p,this.partials=new p,this.getNow=Date.now,this.list=[],this.maxListLength=e,this.warnListLength=.8*e,this.getNow=t??Date.now,this.onInfo=n,this.onWarning=o}get length(){return this.list.length}getChunk(e){return this.list[e]}track(e,t,n){const o={audioStart:e-t,audioEnd:e,localEnd:this.getNow(),seq:n};let r=this.list.length-1;if(-1===r||o.audioStart>=this.list[r].audioEnd)this.list.push(o);else if(o.audioEnd<=this.list[0].audioStart)this.list.unshift(o);else{for(;r>0&&o.audioEnd<this.list[r].audioStart;)r--;if(r>=0&&o.audioStart===this.list[r].audioStart)throw new Error(`Why are we double tracking the same chunk of audio? newChunk: ${JSON.stringify(o)}, existing chunk: ${JSON.stringify(this.list[r])}`);this.list.splice(r,0,o)}if(this.list.length>this.maxListLength){const e=this.list.length-this.maxListLength;this.list.splice(0,e),this.onWarning?this.onWarning(`AudioStreamPerfTracker.track: list length has exceeded max by ${e} items!`,523568153):c.Hv.sendTraceTag(523568153,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.track: list length has exceeded max by ${e} items!`)}else this.list.length>=this.warnListLength&&(this.onWarning?this.onWarning(`AudioStreamPerfTracker.track: list length: ${this.list.length} approaching max: ${this.maxListLength}`,523568154):c.Hv.sendTraceTag(523568154,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.track: list length: ${this.list.length} approaching max: ${this.maxListLength}`))}trimBefore(e){if(0===this.list.length)return void(this.onInfo?this.onInfo("AudioStreamPerfTracker.trimBefore: list is empty - nothing to trim!",523568155):c.Hv.sendTraceTag(523568155,u.n.msoulscat_Wac_Dictation,d.k.Info,"AudioStreamPerfTracker.trimBefore: list is empty - nothing to trim!"));const t=`${this.list[0].audioStart} to ${this.list[this.list.length-1].audioEnd}`;let n=0;for(;n<this.list.length&&this.list[n].audioEnd<e;)n++;n===this.list.length&&(this.onWarning?this.onWarning(`AudioStreamPerfTracker.trimBefore: no match found for audioEnd: ${e}. List length: ${this.list.length}, audio span: ${t}`,523568156):c.Hv.sendTraceTag(523568156,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.trimBefore: no match found for audioEnd: ${e}. List length: ${this.list.length}, audio span: ${t}`));const o=this.list.splice(0,n),r=o.length>0?`${o[0].audioStart} to ${o[o.length-1].audioEnd}`:"none",s=this.list.length>0?`${this.list[0].audioStart} to ${this.list[this.list.length-1].audioEnd}`:"none";this.onInfo?this.onInfo(`AudioStreamPerfTracker.trimBefore: audioEnd: ${e}, culling ${o.length} chunks (audio span ${r}), new list.length: ${this.list.length}. Audio span was: ${t}, now: ${s}`,523568157):c.Hv.sendTraceTag(523568157,u.n.msoulscat_Wac_Dictation,d.k.Info,`AudioStreamPerfTracker.trimBefore: audioEnd: ${e}, culling ${o.length} chunks (audio span ${r}), new list.length: ${this.list.length}. Audio span was: ${t}, now: ${s}`)}getChunksFrom(e,t){const n=e+t;let o,r,s=0;for(;s<this.list.length&&(!o||!r);){const t=this.list[s];!o&&e>=t.audioStart&&e<=t.audioEnd&&(o=t),!r&&n>=t.audioStart&&n<=t.audioEnd&&(r=t),s++}return[o,r]}measureLatency(e,t,n){const o=this.getNow(),r=e+t,[s,i]=this.getChunksFrom(e,t);if(!s&&!i)return this.onWarning?this.onWarning(`AudioStreamPerfTracker.getRelatedAudioChunks: Zero audio chunks not found for speechEnd: ${r} (${e} + ${t})`,523568158):c.Hv.sendTraceTag(523568158,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.getRelatedAudioChunks: Zero audio chunks not found for speechEnd: ${r} (${e} + ${t})`),{service:-1,perceived:-1};if(!s||!i){const n=s?"end":"start";let o="none",i=NaN;this.list.length>0&&(o=`${this.list[0].audioStart} to ${this.list[this.list.length-1].audioEnd}`,i=s?r-this.list[this.list.length-1].audioEnd:r-this.list[0].audioStart),this.onWarning?this.onWarning(`AudioStreamPerfTracker.getRelatedAudioChunks: Expected audio chunk not found for ${n} of audio, for speechEnd: ${r} (${e} + ${t}), tracked audio span: ${o}, delta: ${i}`,523568159):c.Hv.sendTraceTag(523568159,u.n.msoulscat_Wac_Dictation,d.k.Warning,`AudioStreamPerfTracker.getRelatedAudioChunks: Expected audio chunk not found for ${n} of audio, for speechEnd: ${r} (${e} + ${t}), tracked audio span: ${o}, delta: ${i}`)}const a=o-Math.max(s?.localEnd||0,i?.localEnd||0),l=s?this.getLatencyForChunk(s,e,t,o):-1,h=i?this.getLatencyForChunk(i,r,0,o):-1,p={service:a,perceived:Math.max(l,h)};return(n?this.finals:this.partials).add(p),p}getLatencyForChunk(e,t,n,o){return o-(e.localEnd-(e.audioEnd-t))-n}}var g=n(63564),m=n(62510),y=n(54998);class v{constructor(e,t,n=!1,o,r,i=s.A.Dictation,l,c,u,d){this.audioContext=null,this.microphoneSessionState=null,this.responseVersion=a.wM.version2,this.fileBytes=null,this._wavFileAudioChunkSize=16e3,this.endVoiceSessionCalled=!1,this.totalAudioInputDurationMs=0,this.resolveSendVoiceTilesUsingVoicePacketsPromise=null,this.runtimeManager=e,this.fdSpeechClientObserver=t,this.useFrontdoorWorkflow=n,o&&(this.commandTelemetry=o),r&&(this.sessionTelemetry=r,r.audioPerfTracker=this.audioPerfTracker),this.speechToTextProfile=i,l?this.alSession=l:(0,m.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&e.getSession().then((e=>{this.alSession=e})).catch((e=>{d&&d(e)})),this.onInfo=c,this.onWarning=u,this.onError=d,this.audioPerfTracker=new f(1e3,void 0,c,u)}async startVoiceSessionFromMicrophoneInput(e,t,n){this.endVoiceSessionCalled=!1,this.totalAudioInputDurationMs=0,await this.startAudioCaptureAsync((t=>{if(this.endVoiceSessionCalled)return;e&&e(t.inputBuffer);const s=this.audioContext?this.audioContext.sampleRate:t.inputBuffer.sampleRate,i=(0,r.eG)(t.inputBuffer.getChannelData(0),s);let a;a=this.alSession?g.vh(this.alSession,i,r.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry,n?.getCommandSet()):o.vh(this.runtimeManager,i,r.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry,n?.getCommandSet());const c=1e3*t.inputBuffer.duration;this.totalAudioInputDurationMs+=c,this.audioPerfTracker.track(this.totalAudioInputDurationMs,c,a.seq),this.fdSpeechClientObserver.onAudioData&&this.fdSpeechClientObserver.onAudioData(new Int16Array(i.buffer))}),t).catch((e=>Promise.reject(e)))}sendVoiceTilesUsingVoicePackets(e,t){return new Promise((async(n,s)=>{try{null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&s(new Error("Please finish sending an audio file (i.e. call endVoiceSession) before sending another one.")),this.resolveSendVoiceTilesUsingVoicePacketsPromise=n;const i=this._wavFileAudioChunkSize;let a=0,c=i,u=!1;for(;a<e.byteLength&&!this.endVoiceSessionCalled;){const n=e.slice(a,c),s=new DataView(n);this.alSession?g.vh(this.alSession,s,r.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry):o.vh(this.runtimeManager,s,r.b2,this.useFrontdoorWorkflow,l.A.dictationSettings,this.responseVersion,this.speechToTextProfile,this.sessionTelemetry);const d=t&&t.audioFileStreamDelay||300;if(await this.wait(+d),u)break;a=c,c+=i,c>e.byteLength&&(c=e.byteLength,u=!0)}null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&(this.resolveSendVoiceTilesUsingVoicePacketsPromise(),this.resolveSendVoiceTilesUsingVoicePacketsPromise=null)}catch(e){s(e)}}))}resendFileFromTimeOffset(e,t){if(!this.fileBytes)throw new Error("Can't resend a file if startVoiceSessionFromAudioFile (or equivalent) has not been called.");if(!this.endVoiceSessionCalled||null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise)throw new Error("Can't resend a file when we are currently sending one. End the voice session first.");const n=e/1e3*r.b2*(r.FA/8),o=t?t/1e3*r.b2*(r.FA/8):void 0;return this.fileBytes=this.fileBytes.slice(n,o),this.endVoiceSessionCalled=!1,this.sendVoiceTilesUsingVoicePackets(this.fileBytes)}async startVoiceSessionFromAudioFileFromServer(e,t){return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),this.fileBytes=e,this.sendVoiceTilesUsingVoicePackets(this.fileBytes,t)}readAndSendFile(e,t=!1,n){const o=new FileReader,s=new Promise(((e,s)=>{o.onload=async()=>{try{if(this.fileBytes=o.result,t){const e=Date.now(),t=new OfflineAudioContext(1,1,r.b2);if(null==t.decodeAudioData)throw new Error("Browser does not support decodeAudioData");const o=await function(e,t){return new Promise(((n,o)=>{t.decodeAudioData(e,n,o)}))}(this.fileBytes,t);this.fileBytes=(0,r.eG)(o.getChannelData(0),r.b2).buffer;const s=o.duration;n&&n(Date.now()-e,s)}await this.sendVoiceTilesUsingVoicePackets(this.fileBytes),e()}catch(e){s(e)}},o.onabort=()=>{s(new Error("Aborted fileReader"))},o.onerror=()=>{s(o.error)}}));return o.readAsArrayBuffer(e),s}async startVoiceSessionFromAudioFile(e,t=!1,n){return this.fdSpeechClientObserver.onSpeechRecognitionStarted(),this.readAndSendFile(e,t,n)}async stopVoiceSession(){await this.stopMicrophoneInputAsync(),this.endVoiceSession()}endVoiceSession(){this.alSession?g.Yf(this.alSession,this.useFrontdoorWorkflow,l.A.dictationSettings,this.sessionTelemetry,this.onInfo):o.Yf(this.runtimeManager,this.useFrontdoorWorkflow,l.A.dictationSettings,this.sessionTelemetry),this.endVoiceSessionCalled=!0,null!=this.resolveSendVoiceTilesUsingVoicePacketsPromise&&(this.resolveSendVoiceTilesUsingVoicePacketsPromise(),this.resolveSendVoiceTilesUsingVoicePacketsPromise=null)}async stopMicrophoneInputAsync(){if(this.microphoneSessionState&&(this.microphoneSessionState.mediaStream.getAudioTracks().map((e=>{e.stop()})),this.microphoneSessionState=null),this.audioContext&&"closed"!==this.audioContext.state)try{await this.audioContext.close()}catch(e){if(this.onWarning?this.onWarning(`Error closing audioContext: ${e}`,528871704):c.Hv.sendTraceTag(528871704,u.n.msoulscat_Wac_Dictation,d.k.Warning,`Error closing audioContext: ${e}`),"InvalidStateError"!==e.name)throw e}}async startAudioCaptureAsync(e,t){const n=Date.now();let o=!1;try{const{context:n,sessionState:r}=await this.createAudioContextAndMicrophoneSessionState(t);o=!0,this.sessionTelemetry?.setRecordingStartTime(Date.now()),this.commandTelemetry?.setRecordingStartTime(Date.now()),this.microphoneSessionState=r,this.audioContext=n,this.endVoiceSessionCalled?this.onWarning?this.onWarning("Audio Capture is cancelled due to VoiceSession closed",573391628):c.Hv.sendTraceTag(573391628,u.n.msoulscat_Wac_Dictation,d.k.Warning,"Audio Capture is cancelled due to VoiceSession closed"):(r.processor.onaudioprocess=e,r.source.connect(r.processor),r.processor.connect(n.destination),window.self.document.hasFocus()||await this.waitForWindowFocus(20),this.fdSpeechClientObserver.onSpeechRecognitionStarted())}catch(e){const t=this.parseMicrophoneErrorMessage(e);return this.fdSpeechClientObserver.onError(t),t===h.J.ErrorAudioCaptureAsync?Promise.reject(e):Promise.reject(t)}finally{const e=Date.now()-n;this.onInfo?this.onInfo(`Mic enablement - success: ${o}, duration: ${e}, endVoiceSessionCalled: ${this.endVoiceSessionCalled}`,589886626):c.Hv.sendTraceTag(589886626,u.n.msoulscat_Wac_Dictation,d.k.Info,`Mic enablement - success: ${o}, duration: ${e}, endVoiceSessionCalled: ${this.endVoiceSessionCalled}`),this.endVoiceSessionCalled&&(0,m.isChangeGateEnabled)("OfficeVSO:8355217_HandleVoiceSessionMicrophoneInputRaceCondition")&&await this.stopMicrophoneInputAsync()}}waitForWindowFocus(e=20){const t=Date.now();let n=e;return new Promise(((e,o)=>{const r=()=>{if(n-=1,window.self.document.hasFocus()||n<0){const o=Date.now()-t;this.onInfo?this.onInfo(`waitForWindowFocus duration: ${o}, count: ${n}, window has focus: ${window.self.document.hasFocus()}`,553747910):c.Hv.sendTraceTag(553747910,u.n.msoulscat_Wac_Dictation,d.k.Info,`waitForWindowFocus duration: ${o}, count: ${n}, window has focus: ${window.self.document.hasFocus()}`),e()}else setTimeout(r,50)};r()}))}parseMicrophoneErrorMessage(e){const t=(0,y.rq)(e,this.onError);return t.startsWith("NotAllowedError")||t.endsWith("PermissionDeniedError")||t.startsWith("PermissionDeniedError")?h.J.ErrorAudioPermissionDeniedError:t.endsWith("NotFoundError")||t.startsWith("NotFoundError")||t.startsWith("DevicesNotFoundError")?h.J.ErrorAudioDevicesNotFoundError:t.endsWith("MediaDeviceNotSupported")||t.startsWith("NotSupportedError")||t.startsWith("NotReadableError")||t.startsWith("TrackStartError")?h.J.ErrorAudioNotReadableError:(this.onError?this.onError(`Unexpected microphone error: ${t} (${e?.name}-${e?.message})`,538481308):c.Hv.sendTraceTag(538481308,u.n.msoulscat_Wac_Dictation,d.k.Error,`Unexpected microphone error: ${t} (${e?.name}-${e?.message})`),h.J.ErrorAudioCaptureAsync)}wait(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}async createAudioContextAndMicrophoneSessionState(e){let t=0;try{t=window.setTimeout((()=>{t=0,this.fdSpeechClientObserver.showPermissionPrompt&&this.fdSpeechClientObserver.showPermissionPrompt()}),2e3);const n=!e||{deviceId:e},o=await navigator.mediaDevices.getUserMedia({audio:n}),r=window.AudioContext||window.webkitAudioContext;if(null===r)return Promise.reject("Browser doesn't support AudioContext");const s=new r;return{context:s,sessionState:{mediaStream:o,source:s.createMediaStreamSource(o),processor:s.createScriptProcessor(16384,1,1)}}}finally{t>0&&window.clearTimeout(t)}}}},2217:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SpeechToTextClient:()=>v,SpeechToTextResultType:()=>o,sendSpeechToTextFinalResultToSpeechClientObserver:()=>b});var o,r=n(97953),s=n(90913),i=n(3316),a=n(76483),l=n(72514),c=n(57144),u=n(21965),d=n(54585),h=n(82058),p=n(88943),f=n(98787),g=n(63564),m=n(54998),y=n(62510);!function(e){e[e.FinalResult=0]="FinalResult",e[e.PartialResult=1]="PartialResult"}(o||(o={}));class v{constructor(e,t,n=!0,o=!0,r,a=s.A.Dictation,l,c,u,d,h){this.initialized=!1,this.speechSessionEventToken=null,this.speechToTextPartialResultToken=null,this.speechToTextFinalResultToken=null,this.speechErrorEventToken=null,this.speechQualityEventToken=null,this.useDebugDictation=!1,this.runtimeManager=e,this.fdSpeechClientObserver=t,this.useFrontdoorWorkflow=n,this.startRecognitionInSpeechToTextClient=o,this.enableSetAnnotationsFromALVoiceClient=!!r,this.speechToTextProfile=a,l?this.alSession=l:(0,y.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&e.getSession().then((e=>{this.alSession=e})).catch((e=>{d&&d(e)})),this.onInfo=c,this.onWarning=u,this.onError=d,v.onTelemetryEvent=h,this.annotationObserver={onAnnotationResult:e=>{this.onAnnotationResult(e)}};const p=new URLSearchParams(window.location.search?.toLowerCase()),f=i.A.dictationSettings.properties??{};this.useDebugDictation="true"===p.get("wddictationdebugmode"),this.useDebugDictation&&(f.EnableAudioLogging="true");const g=p.get("wdspeechdomain");g&&(f.wdSpeechDomain=decodeURIComponent(g)),i.A.dictationSettings={properties:f}}static logPhraseId(e,t,n){const o=n.properties.JsonResult?.Id;if(o&&t&&n)if(v.onTelemetryEvent)v.onTelemetryEvent(e,n);else{const r={name:"Office.Voice.Online.PhraseReceived",dataFields:[{name:"PhraseID",string:o},{name:"ConnectionID",string:t.connectionID},{name:"SessionID",string:t.sessionID},{name:"MessageType",string:e},{name:"voiceLatency",int64:n.properties.audioLatency}]};if(n.properties.commandLatency&&r.dataFields.push({name:"commandLatency",int64:n.properties.commandLatency}),t.audioPerfTracker&&n.properties.JsonResult&&n.properties.JsonResult.Offset&&n.properties.JsonResult.Duration){const o=n.properties.JsonResult.Offset/1e4,s=n.properties.JsonResult.Duration/1e4,i="final"===e,a=t.audioPerfTracker.measureLatency(o,s,i);r.dataFields.push({name:"perceivedLatency",int64:a.perceived}),r.dataFields.push({name:"serviceLatency",int64:a.service})}(0,f.Ot)(r)}}async initializeAsync(e,t){const n=this.checkAnnotationActive();this.onInfo?this.onInfo(`SpeechToTextClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${n}`,521417154):d.Hv.sendTraceTag(521417154,h.n.msoulscat_Wac_Dictation,p.k.Info,`SpeechToTextClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${n}`),n&&(this.onWarning?this.onWarning("Releasing old annotations",521417153):d.Hv.sendTraceTag(521417153,h.n.msoulscat_Wac_Dictation,p.k.Warning,"Releasing old annotations"),await this.uninitializeAsync()),t&&(this.sessionTelemetry=t);try{await this.activateAnnotations(e),this.warmUpAugloop(),this.initialized=!0}catch(e){const t="SpeechToTextClient.initializeAsync - Activate Annotations - "+e.message,n={errorType:m.yA.ErrorAugloopActivateAnnotations,errorMsg:t+" - Error stack: "+e.stack};if(!e.message)try{const t={};Object.getOwnPropertyNames(e).forEach((n=>t[n]=e[n])),this.onError?this.onError("Odd error: "+JSON.stringify(t),509745299):d.Hv.sendTraceTag(509745299,h.n.msoulscat_Wac_Dictation,p.k.Error,"Odd error: "+JSON.stringify(t))}catch(e){this.onError?this.onError("Failed to diagnose odd error: "+(0,m.rq)(e,this.onError),509745298):d.Hv.sendTraceTag(509745298,h.n.msoulscat_Wac_Dictation,p.k.Error,"Failed to diagnose odd error: "+(0,m.rq)(e,this.onError))}t.includes("Timeout waiting for response")?this.fdSpeechClientObserver.onWarning(n):this.fdSpeechClientObserver.onError(n)}}async uninitializeAsync(){const e=this.checkAnnotationActive();this.onInfo?this.onInfo(`SpeechToTextClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`,521417152):d.Hv.sendTraceTag(521417152,h.n.msoulscat_Wac_Dictation,p.k.Info,`SpeechToTextClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`),this.initialized=!1;const t=["speechSessionEventToken","speechToTextPartialResultToken","speechToTextFinalResultToken","speechQualityEventToken","speechErrorEventToken"],n=t.map((e=>this[e])).filter((e=>!!e));try{this.alSession?await g.yw(this.alSession,n,this.onInfo,this.onError):await r.yw(this.runtimeManager,n)}catch(e){const t="SpeechToTextClient.uninitializeAsync - Release Annotations - "+e.message;this.sessionTelemetry?.onAugloopError(t),this.onError?this.onError("SpeechToTextClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack,521417123):d.Hv.sendTraceTag(521417123,h.n.msoulscat_Wac_Dictation,p.k.Error,"SpeechToTextClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack)}t.forEach((e=>this[e]=null))}checkAnnotationActive(){return null!==this.speechSessionEventToken||null!==this.speechToTextPartialResultToken||null!==this.speechToTextFinalResultToken||null!==this.speechQualityEventToken||null!==this.speechErrorEventToken}getAnnotationObserver(){return this.annotationObserver}async activateAnnotations(e){this.alSession?await this.activateAnnotationsUsingALSession(this.alSession,e):await this.activateAnnotationsUsingRuntimeManager(e)}async activateAnnotationsUsingRuntimeManager(e){const t=r.Rd(this.runtimeManager,a.lM.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),n=r.Rd(this.runtimeManager,a.D_.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient);let s=null;e.indexOf(o.PartialResult)>=0&&(s=r.Rd(this.runtimeManager,a.ZF.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient));let i=null;e.indexOf(o.FinalResult)>=0&&(i=r.Rd(this.runtimeManager,a.mh.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient));const l=r.Rd(this.runtimeManager,a._K.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient);this.useDebugDictation&&console.warn("This dictation session will be logging audio"),[this.speechSessionEventToken,this.speechToTextPartialResultToken,this.speechToTextFinalResultToken,this.speechQualityEventToken,this.speechErrorEventToken]=await Promise.all([n,s,i,l,t])}warmUpAugloop(){this.alSession?g.j9(this.alSession,this.useFrontdoorWorkflow,i.A.dictationSettings,l.wM.version2,this.speechToTextProfile,this.sessionTelemetry,this.onInfo):r.j9(this.runtimeManager,this.useFrontdoorWorkflow,i.A.dictationSettings,l.wM.version2,this.speechToTextProfile,this.sessionTelemetry)}onAnnotationResult(e){(0,m.Jh)(e,a.lM.getTypeName()).map((e=>{this.handleSpeechErrorEvent(e.body)})),(0,m.Jh)(e,a.D_.getTypeName()).map((e=>{this.handleSpeechSessionEvent(e.body)})),(0,m.Jh)(e,a.ZF.getTypeName()).map((e=>{this.handleSpeechToTextPartialResult(e.body)})),(0,m.Jh)(e,a.mh.getTypeName()).map((e=>{const t=e.body,n=t.text;b(this.fdSpeechClientObserver,t,n,this.sessionTelemetry)})),(0,m.Jh)(e,a._K.getTypeName()).map((e=>{const t=e.body;t.eventInfo&&t.eventInfo.eventName===c.$O.QualityStatusUpdate&&this.handleSpeechQualityEvent(t.eventInfo)}))}handleSpeechErrorEvent(e){e&&(this.onWarning?this.onWarning(JSON.stringify(e),521417122):d.Hv.sendTraceTag(521417122,h.n.msoulscat_Wac_Dictation,p.k.Warning,JSON.stringify(e)),e.ErrorState===l.o2.FINAL&&e.ErrorImpact===l.$O.NO_DICTATION?(this.onError?this.onError(JSON.stringify(e),521417121):d.Hv.sendTraceTag(521417121,h.n.msoulscat_Wac_Dictation,p.k.Error,JSON.stringify(e)),this.fdSpeechClientObserver.onError(e.ErrorCode)):e.ErrorState===l.o2.INTERMITTENT&&e.ErrorImpact===l.$O.NO_DICTATION?this.onWarning?this.onWarning(JSON.stringify(e),521417120):d.Hv.sendTraceTag(521417120,h.n.msoulscat_Wac_Dictation,p.k.Warning,JSON.stringify(e)):e.ErrorState===l.o2.FINAL&&e.ErrorImpact===l.$O.NO_COMMANDING&&(this.onWarning?this.onWarning(JSON.stringify(e),521417120):d.Hv.sendTraceTag(521417119,h.n.msoulscat_Wac_Dictation,p.k.Warning,JSON.stringify(e)),this.fdSpeechClientObserver.showDictationWarning(e.ErrorCode,e.ErrorImpact)))}handleSpeechSessionEvent(e){switch(e.eventId){case u.P_.SpeechRecognitionStarted:this.transcriberId=e.sessionId,this.useDebugDictation&&console.warn(`Speech transcriberId: ${this.transcriberId}`),this.startRecognitionInSpeechToTextClient&&this.fdSpeechClientObserver.onSpeechRecognitionStarted();break;case u.P_.SpeechRecognitionStopped:this.sessionTelemetry?.setEndReason("SpeechRecognitionStopped"),this.fdSpeechClientObserver.onSpeechEnd();break;case u.P_.SpeechSessionStarted:if(this.speechSessionId=e.sessionId,this.useDebugDictation&&console.warn(`Speech speechSessionId: ${this.speechSessionId}`),this.fdSpeechClientObserver.onSpeechSessionStarted&&this.speechSessionId){const e={speechSessionId:this.speechSessionId,transcriptionSignature:""};this.fdSpeechClientObserver.onSpeechSessionStarted(e)}break;case u.P_.SpeechSessionStopped:this.fdSpeechClientObserver.onSpeechSessionStopped&&this.fdSpeechClientObserver.onSpeechSessionStopped();break;default:console.warn(`Unexpected speechSessionEventId: ${e.eventId}`)}}handleSpeechToTextPartialResult(e){if(""!==e.text){const t=new Map([[e.language,e.text]]);this.sessionTelemetry?.onPartialResultAnnotationResponse(Date.now(),e.properties.JsonResult?.Offset,e.properties.JsonResult?.Duration);const n=new Map;n.set("JsonResult",JSON.stringify(e.properties.JsonResult)),this.fdSpeechClientObserver.onFragmentText(t,n),this.sessionTelemetry&&v.logPhraseId("partial",this.sessionTelemetry,e)}}handleSpeechQualityEvent(e){this.fdSpeechClientObserver.onEventUpdate(e)}async activateAnnotationsUsingALSession(e,t){const n=g.Rd(e,a.lM.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError),r=g.Rd(e,a.D_.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError);let s=null;t.indexOf(o.PartialResult)>=0&&(s=g.Rd(e,a.ZF.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError));let i=null;t.indexOf(o.FinalResult)>=0&&(i=g.Rd(e,a.mh.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError));const l=g.Rd(e,a._K.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError);this.useDebugDictation&&console.warn("This dictation session will be logging audio"),[this.speechSessionEventToken,this.speechToTextPartialResultToken,this.speechToTextFinalResultToken,this.speechQualityEventToken,this.speechErrorEventToken]=await Promise.all([r,s,i,l,n])}}function b(e,t,n,o){const r=new Map([[t.language,n]]);o&&""!==n&&o.onFinalResultAnnotationResponse(Date.now(),t.properties.JsonResult?.Offset,t.properties.JsonResult?.Duration);const s=new Map;s.set("JsonResult",JSON.stringify(t.properties.JsonResult)),e.onFinalText(r,s),o&&""!==n&&v.logPhraseId("final",o,t)}},48316:(e,t,n)=>{"use strict";var o;n.d(t,{J:()=>o}),function(e){e.ErrorAudioPermissionDeniedError="ErrorAudioPermissionDeniedError",e.ErrorAudioDevicesNotFoundError="ErrorAudioDevicesNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioCaptureAsync="ErrorAudioCaptureAsync"}(o||(o={}))},35305:(e,t,n)=>{"use strict";n.r(t),n.d(t,{BatchTranscriptionClientError:()=>q,BatchTranscriptionClientErrorCode:()=>H,BatchTranscriptionClientRequest:()=>Q,BatchTranscriptionClientRequestPoller:()=>J,CommandSuggestionClient:()=>I,CopilotLicensingClientError:()=>pe,CopilotLicensingClientErrorCode:()=>Y,CopilotLicensingClientRequest:()=>ve,CopilotLicensingClientRequestPoller:()=>be,DictationSettingsManager:()=>o.A,MicrophoneError:()=>M.J,SpeechToTextClient:()=>a.SpeechToTextClient,SpeechToTextResultType:()=>a.SpeechToTextResultType,VoiceCommandingClient:()=>A,VoiceSession:()=>P.VoiceSession,initializeBatchTranscriptionClient:()=>j,initializeCopilotLicensingClient:()=>me,uninitializeBatchTranscriptionClient:()=>z,uninitializeCopilotLicensingClient:()=>ye});var o=n(3316),r=n(69382),s=n(21965),i=n(97953),a=n(2217),l=n(35859);const c=new Set([s.oJ.Paste,s.oJ.Redo]);var u,d;!function(e){e.ZoomIn="Word.View.ZoomIn",e.ZoomOut="Word.View.ZoomOut",e.ShowOutline="Word.View.ShowOutline",e.ScrollUp="Word.View.ScrollUp",e.ScrollDown="Word.View.ScrollDown",e.ReadBack="Word.Editing.ReadBack",e.PageBreak="Word.Editing.PageBreak",e.SpellOut="Word.Editing.SpellOut",e.ShowSuggestions="Word.Editing.ShowSuggestions"}(u||(u={})),function(e){e.ReadBack="ReadBack",e.ChangeViews="ChangeViews",e.PageBreak="PageBreak",e.SpellOut="SpellOut",e.Discovery="Discovery"}(d||(d={}));const h=new Map([[d.ReadBack,new Set([u.ReadBack])],[d.ChangeViews,new Set([u.ZoomIn,u.ZoomOut,u.ShowOutline,u.ScrollDown,u.ScrollUp])],[d.PageBreak,new Set([u.PageBreak])],[d.SpellOut,new Set([u.SpellOut])],[d.Discovery,new Set([u.ShowSuggestions])]]),p=new Set([s.oJ.Bold,s.oJ.Italics,s.oJ.Underline,s.oJ.Highlight,s.oJ.Select,s.oJ.Superscript,s.oJ.Subscript,s.oJ.StrikeThrough,s.oJ.RemoveBold,s.oJ.RemoveItalics,s.oJ.RemoveUnderline,s.oJ.RemoveHighlight,s.oJ.RemoveSuperscript,s.oJ.RemoveSubscript,s.oJ.RemoveStrikeThrough,s.oJ.Delete,s.oJ.Quote,s.oJ.Navigation,s.oJ.AllCaps,s.oJ.LowerCase,s.oJ.SentenceCase]),f=Object.keys(u),g=Object.keys(s.oJ);function m(e){const t=new Set;return e.forEach((e=>{const n=h.get(e);null!=n&&n.forEach((e=>{t.add(e)}))})),t}const y=e=>!p.has(e.commandId)||!(e.selection&&v(e.selection,e.commandId)),v=(e,t)=>t===s.oJ.Navigation&&(e.which!==l.uR.Next&&e.which!==l.uR.Previous&&e.which!==l.uR.End||e.type!==l.hO.Word&&e.type!==l.hO.Bullet&&e.type!==l.hO.Sentence&&e.type!==l.hO.Paragraph),b=e=>(e.commandId===s.oJ.InsertComment&&(e.sourceText=e?.comment?.commentCommand||e.sourceText),e);var S=n(54585),w=n(82058),T=n(88943),_=n(98787),C=n(63564),k=n(54998),E=n(62510);class A{constructor(e,t,n,o,r,i,a,l,h,p){this.initialized=!1,this.voiceCommandRequestToken=null,this.alRuntimeManager=e,this.fdVoiceCommandClientObserver=t,this.fdSpeechClientObserver=n,this.enableSetAnnotationsFromALVoiceClient=r,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(i?this.alSession=i:e.getSession().then((e=>{this.alSession=e})).catch((e=>{h&&h(e)}))),this.onInfo=a,this.onWarning=l,this.onError=h,this.onTelemetryEvent=p,this.validVoiceCommands=(e=>{const t=new Set,n=m(e),o=m(Object.keys(d));for(const e of g)o.has(s.oJ[e])&&!n.has(s.oJ[e])||c.has(s.oJ[e])||t.add(s.oJ[e]);for(const e of f)n.has(u[e])&&o.has(u[e])&&t.add(u[e]);return t})(o),this.annotationObserver={onAnnotationResult:e=>{this.onAnnotationResult(e)}},this.workflowUsesCommandSets=!1}async initializeAsync(e){const t=!!this.voiceCommandRequestToken;this.onInfo?this.onInfo(`VoiceCommandingClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${t}`,521417118):S.Hv.sendTraceTag(521417118,w.n.msoulscat_Wac_Dictation,T.k.Info,`VoiceCommandingClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${t}`),t&&(this.onWarning?this.onWarning("Releasing old annotations",521417117):S.Hv.sendTraceTag(521417117,w.n.msoulscat_Wac_Dictation,T.k.Warning,"Releasing old annotations"),await this.uninitializeAsync()),e&&(this.sessionTelemetry=e);try{this.alSession?this.voiceCommandRequestToken=await C.Rd(this.alSession,r.VJ.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError):this.voiceCommandRequestToken=await i.Rd(this.alRuntimeManager,r.VJ.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),this.initialized=!0}catch(e){("VoiceCommandingClient.initializeAsync - Activate Annotations - "+e.message).includes("Timeout waiting for response")?this.fdSpeechClientObserver.onWarning(e):this.fdSpeechClientObserver.onError(e)}}async uninitializeAsync(){const e=!!this.voiceCommandRequestToken;if(this.onInfo?this.onInfo(`VoiceCommandingClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`,521417116):S.Hv.sendTraceTag(521417116,w.n.msoulscat_Wac_Dictation,T.k.Info,`VoiceCommandingClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`),this.initialized=!1,e){try{this.alSession?await C.yw(this.alSession,[this.voiceCommandRequestToken],this.onInfo,this.onError):await i.yw(this.alRuntimeManager,[this.voiceCommandRequestToken])}catch(e){const t="VoiceCommandingClient.uninitializeAsync - Release Annotations - "+e.message;this.sessionTelemetry?.onAugloopError(t),this.onError?this.onError("VoiceCommandingClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack,521417115):S.Hv.sendTraceTag(521417115,w.n.msoulscat_Wac_Dictation,T.k.Error,"VoiceCommandingClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack)}this.voiceCommandRequestToken=null}}getAnnotationObserver(){return this.annotationObserver}onAnnotationResult(e){(0,k.Jh)(e,r.VJ.getTypeName()).forEach((e=>{this.handleCommandResult(e.body)}))}handleCommandResult(e){e.textAnnotation?.properties?.commandSet&&e.textAnnotation.properties.commandSet.length>0&&(this.workflowUsesCommandSets=!0),e.error&&this.sessionTelemetry&&this.sessionTelemetry.onCommandError(`handleCommandResult:${e.error}`);const t=e.textAnnotation.properties?.JsonResult?.Id;for(const o of e.commandList){const r=!((n=o.commandId)===s.oJ.Correction||n===s.oJ.CorrectionOption)||this.workflowUsesCommandSets,i=this.validVoiceCommands.has(o.commandId)&&y(o)&&r;if(i||(this.onTelemetryEvent?this.onTelemetryEvent("Office.Voice.Online.UnsupportedCommandReceived",t,o):(0,_.Ot)({name:"Office.Voice.Online.UnsupportedCommandReceived",dataFields:[{name:"PhraseID",string:t},{name:"ConnectionID",string:this.sessionTelemetry?.connectionID},{name:"SessionID",string:this.sessionTelemetry?.sessionID},{name:"CommandID",string:o.commandId},{name:"CommandVersion",int64:o.ver}]})),o.commandId!==s.oJ.InsertText&&i){const n=b(o);this.fdVoiceCommandClientObserver.onVoiceCommand(n,t),this.sessionTelemetry&&a.SpeechToTextClient.logPhraseId("final",this.sessionTelemetry,e.textAnnotation)}else(0,a.sendSpeechToTextFinalResultToSpeechClientObserver)(this.fdSpeechClientObserver,e.textAnnotation,o.sourceText,this.sessionTelemetry)}var n}}class I{constructor(e,t,n,o,r,s,i){this.initialized=!1,this.commandSuggestionRequestToken=null,this.alRuntimeManager=e,this.commandSuggestionManagerObserver=t,this.enableSetAnnotationsFromALVoiceClient=n,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(o?this.alSession=o:e.getSession().then((e=>{this.alSession=e})).catch((e=>{i&&i(e)}))),this.onInfo=r,this.onWarning=s,this.onError=i,this.annotationObserver={onAnnotationResult:e=>{this.onAnnotationResult(e)}}}async initializeAsync(e){const t=null!==this.commandSuggestionRequestToken;this.onInfo?this.onInfo(`CommandSuggestionClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${t}`,521417160):S.Hv.sendTraceTag(521417160,w.n.msoulscat_Wac_Dictation,T.k.Info,`CommandSuggestionClient.initializeAsync - initialized: ${this.initialized}, annotationsActive: ${t}`),t&&(this.onWarning?this.onWarning("Releasing old annotations",521417159):S.Hv.sendTraceTag(521417159,w.n.msoulscat_Wac_Dictation,T.k.Warning,"Releasing old annotations"),await this.uninitializeAsync()),e&&(this.sessionTelemetry=e);try{this.alSession?this.commandSuggestionRequestToken=await C.Rd(this.alSession,r.z4.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient,this.onInfo,this.onError):this.commandSuggestionRequestToken=await i.Rd(this.alRuntimeManager,r.z4.getTypeName(),this.annotationObserver,this.enableSetAnnotationsFromALVoiceClient),this.initialized=!0}catch(e){`CommandSuggestionClient.initializeAsync - Activate Annotations - ${e.message}`.includes("Timeout waiting for response")?this.commandSuggestionManagerObserver.onWarning(e):this.commandSuggestionManagerObserver.onError(e)}}async uninitializeAsync(){const e=null!==this.commandSuggestionRequestToken;if(this.onInfo?this.onInfo(`CommandSuggestionClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`,521417158):S.Hv.sendTraceTag(521417158,w.n.msoulscat_Wac_Dictation,T.k.Info,`CommandSuggestionClient.uninitializeAsync - initialized: ${this.initialized}, annotationsActive: ${e}`),this.initialized=!1,e){try{this.alSession?await C.yw(this.alSession,[this.commandSuggestionRequestToken],this.onInfo,this.onError):await i.yw(this.alRuntimeManager,[this.commandSuggestionRequestToken])}catch(e){const t=`CommandSuggestionClient.uninitializeAsync - Release Annotations - ${e.message}`;this.sessionTelemetry?.onAugloopError(t),this.onError?this.onError("CommandSuggestionClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack,521417157):S.Hv.sendTraceTag(521417157,w.n.msoulscat_Wac_Dictation,T.k.Error,"CommandSuggestionClient.uninitializeAsync - Release Annotations - Error message: "+t+" - Error stack: "+e.stack)}this.commandSuggestionRequestToken=null}}getAnnotationObserver(){return this.annotationObserver}onAnnotationResult(e){(0,k.Jh)(e,r.z4.getTypeName()).forEach((e=>{this.commandSuggestionManagerObserver.onCommandSuggestion(e.body)}))}}var P=n(81958),M=n(48316),x=n(15372),R=n(76483),D=n(57144),O=n(72514),N=n(47401);const L={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let F;const B=new Uint8Array(16);function W(){if(!F&&(F="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!F))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return F(B)}const U=[];for(let e=0;e<256;++e)U.push((e+256).toString(16).slice(1));const G=function(e,t,n){if(L.randomUUID&&!t&&!e)return L.randomUUID();const o=(e=e||{}).random||(e.rng||W)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=o[e];return t}return function(e,t=0){return(U[e[t+0]]+U[e[t+1]]+U[e[t+2]]+U[e[t+3]]+"-"+U[e[t+4]]+U[e[t+5]]+"-"+U[e[t+6]]+U[e[t+7]]+"-"+U[e[t+8]]+U[e[t+9]]+"-"+U[e[t+10]]+U[e[t+11]]+U[e[t+12]]+U[e[t+13]]+U[e[t+14]]+U[e[t+15]]).toLowerCase()}(o)};var H;!function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.UNSUPPORTED_FILE_FORMAT="UNSUPPORTED_FILE_FORMAT",e.INVALID_REQUEST="INVALID_REQUEST",e.REQUEST_DISPOSED="REQUEST_DISPOSED",e.POLLER_DISPOSED="POLLER_DISPOSED",e.PROCESSING="PROCESSING",e.DELETED="DELETED",e.FILE_NOT_EXIST="FILE_NOT_EXIST",e.FILE_DECODE_ERROR="FILE_DECODE_ERROR",e.REQUEST_TIMEOUT_ERROR="REQUEST_TIMEOUT_ERROR"}(H||(H={}));class q extends Error{constructor(e,t){super(t),this.code=e}}const $=[];function V(e,t,n,o,r,s,i,a,l,c,u){const d=new N.Xr({parentPath:["session"],items:[{id:t,body:new x.Qu({stage:n,downloadUrl:o,conversationId:r,speechFDUrl:i,corelationId:s,sourceLanguage:a,transcriberType:l})}]});(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?c?c.submitOperation(d):e.getSession().then((e=>{e.submitOperation(d)})).catch((e=>{u&&u(e)})):e.submitOperation({operation:d})}async function j(e,t,n,o,r,s){(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?o?($.push(await C.Rd(o,R.U1.getTypeName(),t,n,r,s)),V(void 0,G(),D.Cu.GetBatchResult,void 0,"",void 0,void 0,void 0,void 0,o,s)):e.getSession().then((async e=>{$.push(await C.Rd(e,R.U1.getTypeName(),t,n,r,s)),V(void 0,G(),D.Cu.GetBatchResult,void 0,"",void 0,void 0,void 0,void 0,e,s)})).catch((e=>{s&&s(e)})):($.push(await i.Rd(e,R.U1.getTypeName(),t,n)),V(e,G(),D.Cu.GetBatchResult))}function z(e,t,n,o){return(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?new Promise(((r,s)=>{t?r(C.yw(t,$,n,o)):e.getSession().then((e=>{r(C.yw(e,$,n,o))})).catch((e=>{o&&(o(e),s())}))})):i.yw(e,$)}class Q{constructor(e,t=D.Cu.GetBatchResult,n,o,r,s,i,a,l,c,u,d,h){this.getResultCallbacks=null,this.alRuntimeManager=e,this.conversationId=o,this.corelationId=r,this.speechFdUrl=s,this.sourceLanguage=i,this.transcriberType=a,this.logMessage=l,this.workflowStage=t,this.downloadUrl=n,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(c?this.augloopSession=c:e.getSession().then((e=>{this.augloopSession=e})).catch((e=>{h&&h(e)}))),this.onInfo=u,this.onWarning=d,this.onError=h}makeRequest(){if(null!==this.getResultCallbacks)throw new q(H.INVALID_REQUEST,"getResult can only be called once per instance. If you want to make another request, create another instance.");return new Promise(((e,t)=>{const n=G();this.onInfo?this.onInfo(`Request tile submitted with requestId ${n}, conversationId ${this.conversationId}, correlation Id ${this.corelationId}.`,520435273):S.Hv.sendTraceTag(520435273,w.n.msoulscat_Wac_Dictation,T.k.Info,`Request tile submitted with requestId ${n}, conversationId ${this.conversationId}, correlation Id ${this.corelationId}.`),this.augloopSession?V(void 0,n,this.workflowStage,this.downloadUrl,this.conversationId,this.corelationId,this.speechFdUrl,this.sourceLanguage,this.transcriberType,this.augloopSession,this.onError):V(this.alRuntimeManager,n,this.workflowStage,this.downloadUrl,this.conversationId,this.corelationId,this.speechFdUrl,this.sourceLanguage,this.transcriberType),this.getResultCallbacks={resolve:e,reject:t,requestId:n}}))}dispose(){null!=this.getResultCallbacks&&this.getResultCallbacks.reject(new q(H.REQUEST_DISPOSED,"Caller disposed the BatchTranscriptionClientRequest instance")),this.getResultCallbacks=null}onAnnotationResult(e){const t=(0,k.Jh)(e,R.U1.getTypeName()),n=e.parentPath[e.parentPath.length-1];t.forEach((e=>{const t=e.body;if(null!=this.getResultCallbacks&&this.getResultCallbacks.requestId===n){try{!function(e,t){if(e.errorCode)throw t?t(`The result error code received in on AnnotationsResultcall back is ${e.errorCode}.`,520435270):S.Hv.sendTraceTag(520435270,w.n.msoulscat_Wac_Dictation,T.k.Warning,`The result error code received in on AnnotationsResultcall back is ${e.errorCode}.`),new q(function(e){switch(e){case O.sP.UNSUPPORTED_FILE_FORMAT:return H.UNSUPPORTED_FILE_FORMAT;case O.sP.PROCESSING:return H.PROCESSING;case O.sP.FILE_NOT_EXIST:return H.FILE_NOT_EXIST;case O.sP.FILE_DECODE_ERROR:return H.FILE_DECODE_ERROR;case O.sP.DELETED:return H.DELETED;case O.sP.REQUEST_TIMEOUT_ERROR:return H.REQUEST_TIMEOUT_ERROR;default:return H.UNKNOWN_ERROR}}(e.errorCode),e.errorMessage)}(t,this.onWarning)}catch(e){if(this.getResultCallbacks.reject(e),e.errorCode===H.FILE_NOT_EXIST||e.errorCode===H.FILE_DECODE_ERROR||e.code===H.DELETED)throw e}try{if(this.onInfo?this.onInfo(`Parsing batch transcription result segments for request Id ${n}, error message ${t.errorMessage}.`,520435272):S.Hv.sendTraceTag(520435272,w.n.msoulscat_Wac_Dictation,T.k.Info,`Parsing batch transcription result segments for request Id ${n}, error message ${t.errorMessage}.`),this.workflowStage===D.Cu.GetBatchResult){const e=function(e){if(!e.transcriptionsJson)throw new q(H.UNKNOWN_ERROR,"Received invalid transcriptionsJson");return JSON.parse(e.transcriptionsJson).map((e=>({offsetInTicks:e.offsetInTicks,durationInTicks:e.durationInTicks,userId:e.userId,text:e.text})))}(t);this.getResultCallbacks.resolve({conversationId:this.conversationId,transcriptSegments:e})}else if(this.workflowStage===D.Cu.AnalyzeAudio){const e=t.conversationId;this.getResultCallbacks.resolve({conversationId:e,transcriptSegments:[]})}}catch(e){this.onWarning?this.onWarning(`Batch transcription result segments failed for request Id ${n}, error message ${e.message}.`,520435271):S.Hv.sendTraceTag(520435271,w.n.msoulscat_Wac_Dictation,T.k.Warning,`Batch transcription result segments failed for request Id ${n}, error message ${e.message}.`),this.getResultCallbacks.reject(new q(H.UNKNOWN_ERROR,"Error parsing workflow response "+e.message))}}else this.workflowStage===D.Cu.GetBatchResult&&t.conversationId===this.conversationId&&this.logMessage&&this.logMessage("Dropped response for conversation ID that didn't belong to this request. Should we reuse results for the same conversation ID across requests?")}))}}class J{constructor(e,t,n=D.Cu.GetBatchResult,o,r,s,i,a,l,c,u,d,h,p){this.isDisposed=!1,this.lastRequest=null,this.pollingDelayMilliseconds=e,this.conversationId=r,this.corelationId=s,this.alRuntimeManager=t,this.speechFdUrl=i,this.workflowStage=n,this.downloadUrl=o,this.sourceLanguage=a,this.transcriberType=l,this.logMessage=c,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(u?this.augloopSession=u:t.getSession().then((e=>{this.augloopSession=e})).catch((e=>{p&&p(e)}))),this.onInfo=d,this.onWarning=h,this.onError=p}async makeRequest(){let e=null;do{let t;if(null!=e&&await K(this.pollingDelayMilliseconds),this.throwIfDisposed(),t=this.augloopSession?this.augloopSession:await this.alRuntimeManager.getSession(),!1!==t.isConnected){this.augloopSession?this.lastRequest=new Q(void 0,this.workflowStage,this.downloadUrl,this.conversationId,this.corelationId,this.speechFdUrl,this.sourceLanguage,this.transcriberType,this.logMessage,this.augloopSession,this.onInfo,this.onWarning,this.onError):this.lastRequest=new Q(this.alRuntimeManager,this.workflowStage,this.downloadUrl,this.conversationId,this.corelationId,this.speechFdUrl,this.sourceLanguage,this.transcriberType,this.logMessage);try{return await this.lastRequest.makeRequest()}catch(t){t.code===H.REQUEST_DISPOSED&&this.throwIfDisposed(),e=t}}else this.onWarning?this.onWarning("augloopSession isConnected is false, skipping BatchTranscriptionClient request to next turn.",521417155):S.Hv.sendTraceTag(521417155,w.n.msoulscat_Wac_Dictation,T.k.Warning,"augloopSession isConnected is false, skipping BatchTranscriptionClient request to next turn.")}while(e.code===H.PROCESSING);throw e}onAnnotationResult(e){null!=this.lastRequest&&this.lastRequest.onAnnotationResult(e)}dispose(){this.isDisposed=!0,null!=this.lastRequest&&this.lastRequest.dispose()}throwIfDisposed(){if(this.isDisposed)throw this.onWarning?this.onWarning("Caller disposed the BatchTranscriptionClientPoller instance.",520435269):S.Hv.sendTraceTag(520435269,w.n.msoulscat_Wac_Dictation,T.k.Warning,"Caller disposed the BatchTranscriptionClientPoller instance."),new q(H.POLLER_DISPOSED,"Caller disposed the BatchTranscriptionClientPoller instance")}}function K(e){return new Promise((t=>{setTimeout(t,e)}))}var Y,X=n(65512),Z=n(66300);class ee{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(te,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class ne{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForBusinessChatAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()};class oe{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForIntelligentSearchAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class re{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(re,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365TeamsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[re.getTypeName()])}}re.H_={T_:re.getTypeName(),B_:re.getBaseTypes()};class se{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(se,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForM365AppsAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()};class ie{constructor(e){Z.h.assign(ie,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CheckCopilotLicenseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ie.getTypeName()])}}ie.H_={T_:ie.getTypeName(),B_:ie.getBaseTypes()};class ae{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ae,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicenseEnabledForSharePointAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ae.getTypeName()])}}ae.H_={T_:ae.getTypeName(),B_:ae.getBaseTypes()};class le{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(le,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_PlannerPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[le.getTypeName()])}}le.H_={T_:le.getTypeName(),B_:le.getBaseTypes()};class ce{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ce,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsPremiumLicenseEnabledAnnotation"}static getBaseTypes(){return["AugLoop_CopilotLicensing_CopilotLicensingAnnotation","AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ce.getTypeName()])}}ce.H_={T_:ce.getTypeName(),B_:ce.getBaseTypes()};class ue{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(ue,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotLicensingOnDemandAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[ue.getTypeName()])}}ue.H_={T_:ue.getTypeName(),B_:ue.getBaseTypes()};class de{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(de,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_TeamsCopilotLicensingAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[de.getTypeName()])}}de.H_={T_:de.getTypeName(),B_:de.getBaseTypes()};class he{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){Z.h.assign(he,this,e)}static getTypeName(){return"AugLoop_CopilotLicensing_CopilotUserContextAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return Z.h.matchesTypesFor(e,[he.getTypeName()])}}he.H_={T_:he.getTypeName(),B_:he.getBaseTypes()},function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.INVALID_REQUEST="INVALID_REQUEST",e.REQUEST_DISPOSED="REQUEST_DISPOSED",e.REQUEST_TIMEOUT_ERROR="REQUEST_TIMEOUT_ERROR"}(Y||(Y={}));class pe extends Error{constructor(e,t){super(t),this.code=e}}const fe=[];function ge(e,t,n,o){const r=new N.Xr({parentPath:["session"],items:[{id:t,body:new X.hD}]});(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?n?n.submitOperation(r):e.getSession().then((e=>{e.submitOperation(r)})).catch((e=>{o&&o(e)})):e.submitOperation({operation:r})}async function me(e,t,n,o,r,s){(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?o?(fe.push(await C.Rd(o,ee.getTypeName(),t,n,r,s)),ge(void 0,G(),o,s)):e.getSession().then((async e=>{fe.push(await C.Rd(e,ee.getTypeName(),t,n,r,s)),ge(void 0,G(),e,s)})).catch((e=>{s&&s(e)})):(fe.push(await i.Rd(e,ee.getTypeName(),t,n)),ge(e,G(),o,s))}function ye(e,t,n,o){return(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")?new Promise(((r,s)=>{t?r(C.yw(t,fe,n,o)):e.getSession().then((e=>{r(C.yw(e,fe,n,o))})).catch((e=>{o&&(o(e),s())}))})):i.yw(e,fe)}class ve{constructor(e,t,n,o,r){this.getResultCallbacks=null,this.alRuntimeManager=e,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(t?this.augloopSession=t:e.getSession().then((e=>{this.augloopSession=e})).catch((e=>{r&&r(e)}))),this.onInfo=n,this.onWarning=o,this.onError=r}makeRequest(){if(null!==this.getResultCallbacks)throw new pe(Y.INVALID_REQUEST,"getResult can only be called once per instance. If you want to make another request, create another instance.");return new Promise(((e,t)=>{const n=G();this.onInfo?this.onInfo(`Request tile submitted with requestId ${n}`,520435273):S.Hv.sendTraceTag(505415009,w.n.msoulscat_Wac_Dictation,T.k.Info,`Request tile submitted with requestId ${n}`),this.augloopSession?ge(void 0,n,this.augloopSession,this.onError):ge(this.alRuntimeManager,n),this.getResultCallbacks={resolve:e,reject:t,requestId:n}}))}dispose(){null!=this.getResultCallbacks&&this.getResultCallbacks.reject(new pe(Y.REQUEST_DISPOSED,"Caller disposed the CopilotLicensingClientRequest instance")),this.getResultCallbacks=null}onAnnotationResult(e){const t=(0,k.Jh)(e,ee.getTypeName()),n=e.parentPath[e.parentPath.length-1];t.forEach((e=>{const t=e.body;if(null!=this.getResultCallbacks&&this.getResultCallbacks.requestId===n)try{this.onInfo?this.onInfo(`Parsing Copilot licensing result for request Id ${n}`,520435272):S.Hv.sendTraceTag(505415008,w.n.msoulscat_Wac_Dictation,T.k.Info,`Parsing Copilot licensing result for request Id ${n}`),this.getResultCallbacks.resolve(t)}catch(e){this.onWarning?this.onWarning(`Copilot licensing result failed for request Id ${n}, error message ${e.message}`,520435271):S.Hv.sendTraceTag(505415007,w.n.msoulscat_Wac_Dictation,T.k.Warning,`Copilot licensing result failed for request Id ${n}, error message ${e.message}`),this.getResultCallbacks.reject(new pe(Y.UNKNOWN_ERROR,"Error parsing workflow response "+e.message))}}))}}class be{constructor(e,t,n,o,r,s){this.isDisposed=!1,this.lastRequest=null,this.pollingDelayMilliseconds=e,this.alRuntimeManager=t,(0,E.isChangeGateEnabled)("OfficeVSO:8765828_UseALSession")&&(n?this.augloopSession=n:t.getSession().then((e=>{this.augloopSession=e})).catch((e=>{s&&s(e)}))),this.onInfo=o,this.onWarning=r,this.onError=s}async makeRequest(){let e=null;do{let t;if(null!=e&&await Se(this.pollingDelayMilliseconds),this.throwIfDisposed(),t=this.augloopSession?this.augloopSession:await this.alRuntimeManager.getSession(),!1!==t.isConnected){this.augloopSession?this.lastRequest=new ve(void 0,this.augloopSession,this.onInfo,this.onWarning,this.onError):this.lastRequest=new ve(this.alRuntimeManager,void 0,this.onInfo,this.onWarning,this.onError);try{return await this.lastRequest.makeRequest()}catch(t){t.code===Y.REQUEST_DISPOSED&&this.throwIfDisposed(),e=t}}else this.onWarning?this.onWarning("augloopSession isConnected is false, skipping CopilotLicensingClient request to next turn.",521417155):S.Hv.sendTraceTag(505415006,w.n.msoulscat_Wac_Dictation,T.k.Warning,"augloopSession isConnected is false, skipping CopilotLicensingClient request to next turn.")}while(e.code===Y.REQUEST_TIMEOUT_ERROR);throw e}onAnnotationResult(e){null!=this.lastRequest&&this.lastRequest.onAnnotationResult(e)}dispose(){this.isDisposed=!0,null!=this.lastRequest&&this.lastRequest.dispose()}throwIfDisposed(){if(this.isDisposed)throw this.onWarning?this.onWarning("Caller disposed the CopilotLicensingClientPoller instance.",520435269):S.Hv.sendTraceTag(505415005,w.n.msoulscat_Wac_Dictation,T.k.Warning,"Caller disposed the CopilotLicensingClientPoller instance."),new pe(Y.REQUEST_DISPOSED,"Caller disposed the CopilotLicensingClientPoller instance")}}function Se(e){return new Promise((t=>{setTimeout(t,e)}))}},52865:(e,t,n)=>{"use strict";n.d(t,{FA:()=>r,b2:()=>o,eG:()=>s});const o=16e3,r=16,s=(e,t)=>{const n=i(e,t,o),r=new ArrayBuffer(2*n.length),s=new DataView(r);return a(s,0,n),s},i=(e,t,n)=>{if(n===t||n>t)return e;if(null==e)return new Float32Array(0);const o=t/n,r=Math.round(e.length/o),s=new Float32Array(r);let i=0,a=0;for(;a<r;){const t=Math.round((a+1)*o);let n=0,r=0;for(;i<t&&i<e.length;)n+=e[i],i+=1,r+=1;s[a]=n/r,a+=1}return s},a=(e,t,n)=>{for(let o=0,r=t;o<n.length;o+=1,r+=2){const t=Math.max(-1,Math.min(1,n[o]));e.setInt16(r,t<0?32768*t:32767*t,!0)}}},97953:(e,t,n)=>{"use strict";n.d(t,{Rd:()=>h,Yf:()=>g,j9:()=>f,vh:()=>m,yw:()=>p});var o=n(35519),r=n(15372),s=n(52865),i=n(54585),a=n(82058),l=n(88943),c=n(54998);let u=0;const d=(e,t,n)=>{const r=new o.VR({item:{id:u.toString(),body:t}});e.submitCustomMessage({message:r}).catch((e=>{(0,c.bU)(e,n)}))},h=async(e,t,n,o)=>{i.Hv.sendTraceTag(508151006,a.n.msoulscat_Wac_Dictation,l.k.Info,"Start to activate annotations of: "+t);const r=o?await e.activateAnnotation({annotationType:t,handler:e=>{n&&n.onAnnotationResult(e)}}):await e.activateAnnotation({annotationType:t});return r||i.Hv.sendTraceTag(508151005,a.n.msoulscat_Wac_Dictation,l.k.Error,"activateAnnotationAsync: Missing activationResult!"),r?.token},p=async(e,t)=>{i.Hv.sendTraceTag(508151004,a.n.msoulscat_Wac_Dictation,l.k.Info,`Releasing annotation tokens: ${t}`);const n=t.map((t=>(i.Hv.sendTraceTag(508151003,a.n.msoulscat_Wac_Dictation,l.k.Info,"Start to release annotation of: "+t),t?e.releaseAnnotation({token:t}).catch((e=>{i.Hv.sendTraceTag(508151002,a.n.msoulscat_Wac_Dictation,l.k.Error,`Failed to release annotation ${t}: ${e.message}`)})):Promise.resolve())));await Promise.all(n)},f=(e,t,n,o,c,h)=>{const{dictationLanguage:p,useAutoPunctuation:f,useCorrections:g,useVoiceCommands:m}=n;i.Hv.sendTraceTag(508151001,a.n.msoulscat_Wac_Dictation,l.k.Info,`Sending empty warm-up tile, seq: ${u}, dictationLanguage: ${p}, useAutoPunctuation: ${f}, useCorrections: ${g}, useVoiceCommands: ${m}, speechToTextProfile: ${c}`);const y=new r.jP({sampleRate:s.b2,useFrontdoorWorkflow:t,seq:u,dictationSettings:n,responseVersion:o,speechToTextProfile:c,commandSet:["warm-up"]});d(e,y,h),u+=1},g=(e,t,n,o)=>{i.Hv.sendTraceTag(508151e3,a.n.msoulscat_Wac_Dictation,l.k.Info,`Sending empty tile with endVoiceSession:true, seq: ${u}`);const c=new r.jP({endVoiceSession:!0,sampleRate:s.b2,useFrontdoorWorkflow:t,seq:u,dictationSettings:n});d(e,c,o),u+=1},m=(e,t,n,o,s,i,a,l,c=[])=>{const h=new r.jP({sampleRate:n,useFrontdoorWorkflow:o,seq:u,dictationSettings:s,responseVersion:i,data:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),speechToTextProfile:a,commandSet:c});return d(e,h,l),u+=1,h}},63564:(e,t,n)=>{"use strict";n.d(t,{Rd:()=>h,Yf:()=>g,j9:()=>f,vh:()=>m,yw:()=>p});var o=n(54585),r=n(82058),s=n(88943),i=n(15372),a=n(52865),l=n(35519),c=n(54998);let u=0;const d=(e,t,n)=>{const o=new l.VR({item:{id:u.toString(),body:t}});e.submitCustomMessage(o).catch((e=>{(0,c.bU)(e,n)}))},h=async(e,t,n,i,a,l)=>{a?a("Start to activate annotations of: "+t,508151266):o.Hv.sendTraceTag(508151266,r.n.msoulscat_Wac_Dictation,s.k.Info,"Start to activate annotations of: "+t);const c=i?await e.activateAnnotation(t,{callback:e=>{n&&n.onAnnotationResult(e)}}):await e.activateAnnotation(t);return c||(l?l("activateAnnotationAsync: Missing activationResult!",508151265):o.Hv.sendTraceTag(508151265,r.n.msoulscat_Wac_Dictation,s.k.Error,"activateAnnotationAsync: Missing activationResult!")),c?.token},p=async(e,t,n,i)=>{n?n(`Releasing annotation tokens: ${t}`,508151298):o.Hv.sendTraceTag(508151298,r.n.msoulscat_Wac_Dictation,s.k.Info,`Releasing annotation tokens: ${t}`);const a=t.map((t=>(n?n("Start to release annotation of: "+t,508151297):o.Hv.sendTraceTag(508151297,r.n.msoulscat_Wac_Dictation,s.k.Info,"Start to release annotation of: "+t),t?e?.releaseAnnotation(t).catch((e=>{i?i(`Failed to release annotation ${t}: ${e.message}`,508151296):o.Hv.sendTraceTag(508151296,r.n.msoulscat_Wac_Dictation,s.k.Error,`Failed to release annotation ${t}: ${e.message}`)})):Promise.resolve())));await Promise.all(a)},f=(e,t,n,l,c,h,p)=>{const{dictationLanguage:f,useAutoPunctuation:g,useCorrections:m,useVoiceCommands:y}=n;p?p(`Sending empty warm-up tile, seq: ${u}, dictationLanguage: ${f}, useAutoPunctuation: ${g}, useCorrections: ${m}, useVoiceCommands: ${y}, speechToTextProfile: ${c}`,508151267):o.Hv.sendTraceTag(508151267,r.n.msoulscat_Wac_Dictation,s.k.Info,`Sending empty warm-up tile, seq: ${u}, dictationLanguage: ${f}, useAutoPunctuation: ${g}, useCorrections: ${m}, useVoiceCommands: ${y}, speechToTextProfile: ${c}`);const v=new i.jP({sampleRate:a.b2,useFrontdoorWorkflow:t,seq:u,dictationSettings:n,responseVersion:l,speechToTextProfile:c,commandSet:["warm-up"]});d(e,v,h),u+=1},g=(e,t,n,l,c)=>{c?c(`Sending empty tile with endVoiceSession:true, seq: ${u}`,508151264):o.Hv.sendTraceTag(508151264,r.n.msoulscat_Wac_Dictation,s.k.Info,`Sending empty tile with endVoiceSession:true, seq: ${u}`);const h=new i.jP({endVoiceSession:!0,sampleRate:a.b2,useFrontdoorWorkflow:t,seq:u,dictationSettings:n});d(e,h,l),u+=1},m=(e,t,n,o,r,s,a,l,c=[])=>{const h=new i.jP({sampleRate:n,useFrontdoorWorkflow:o,seq:u,dictationSettings:r,responseVersion:s,data:new Uint8Array(t.buffer,t.byteOffset,t.byteLength),speechToTextProfile:a,commandSet:c});return d(e,h,l),u+=1,h}},54998:(e,t,n)=>{"use strict";n.d(t,{Jh:()=>l,bU:()=>d,rq:()=>c,yA:()=>u});var o=n(66300),r=n(47401),s=n(54585),i=n(82058),a=n(88943);const l=(e,t)=>o.h.getTypeNameFor(e)!==r.Xr.getTypeName()&&o.h.getTypeNameFor(e)!==r.fZ.getTypeName()||0===e.items.length?[]:e.items.filter((e=>e.body&&o.h.getTypeNameFor(e.body)===t)),c=(e,t)=>{const n=`${e}`.trimLeft();if(n.startsWith("[object "))try{const t=e?.name&&e?.message?`${e.name}: ${e.message}`:e?.message?e.message:e?.name?e.name:JSON.stringify(e);return t?n+" "+t:n}catch(e){const o=`stringifyException error: ${e.name}: ${e.message}`;return t?t(o,507377506):s.Hv.sendTraceTag(507377506,i.n.msoulscat_Wac_Dictation,a.k.Error,o),n+" "+o}return n};var u;function d(e,t){t?.onTileSubmitFailed&&t.onTileSubmitFailed();const n=e?.error??e?.message??e?.toString();switch(n){case"Timeout waiting for response":case"Cancelled":case"Message is dropped as oldest in full queue":return;default:t?.onAugloopError(`submitVoiceTile error: ${c(n)}`)}}!function(e){e.ErrorAugloopActivateAnnotations="ErrorAugloopActivateAnnotations"}(u||(u={}))},98526:(e,t)=>{"use strict";function n(){return void 0===globalThis.__get_change_gate_dictionary_variable?{}:globalThis.__get_change_gate_dictionary_variable()}Object.defineProperty(t,"__esModule",{value:!0}),t.getChangeGateDictionary=n,t.isChangeGateEnabled=function(e){return n()[e]??!0},t.setChangeGateDictionaryGetter=function(e){const t=globalThis.__get_change_gate_dictionary_variable;return globalThis.__get_change_gate_dictionary_variable=e,t}},28869:(e,t)=>{"use strict";function n(e){return e.split("")}Object.defineProperty(t,"__esModule",{value:!0}),t.editDistance=function(e,t){const o=n(e),r=n(t);let s=[];for(let e=0;e<=r.length;++e)s[e]=e;for(let e=1;e<=o.length;++e){const t=[e];for(let n=1;n<=r.length;++n)t[n]=o[e-1]===r[n-1]?s[n-1]:1+Math.min(s[n],s[n-1],t[n-1]);s=t}return s[r.length]}},27806:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disableVerboseMode=function(){globalThis.__office_online_feature_gates_verbose_log_callback=void 0},t.enableVerboseMode=function(e){globalThis.__office_online_feature_gates_verbose_log_callback=e},t.getFeatureGateDictionary=s,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){const n=i(e)?.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){const n=i(e)?.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;const o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){const n=i(e)?.trim();if(void 0===n)return t;const o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){const t=globalThis.__get_feature_gate_dictionary_variable;return globalThis.__get_feature_gate_dictionary_variable=e,t};const o=n(28869),r={};function s(){return void 0===globalThis.__get_feature_gate_dictionary_variable?r:globalThis.__get_feature_gate_dictionary_variable()}function i(e,t){if(void 0===globalThis.__office_online_feature_gates_verbose_log_callback)return s()[e]??t;const n=s();if(Object.hasOwn(n,e))return n[e]??t;const r=globalThis.__office_online_feature_gates_verbose_log_callback;r(`Failed lookup for FeatureGate ${e}...`);const i=[],a=e.toLowerCase();for(const e of Object.keys(n))(0,o.editDistance)(e.toLowerCase(),a)<=4&&i.push(e);return i.length>0&&r(`Potential candidates found (edit distance <= 4, case-insensitive): [${i.join(", ")}]`),r(`FeatureGate override not found, returning default: ${t}`),t}},62510:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(5866);o.__exportStar(n(27806),t),o.__exportStar(n(83009),t),o.__exportStar(n(98526),t),o.__exportStar(n(86338),t),o.__exportStar(n(2070),t),o.__exportStar(n(83398),t)},83009:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=function(e){return function(t){const n=e[t];switch(typeof n){case"boolean":return(0,o.getBooleanFeatureGate)(t,n);case"number":return(0,o.getNumberFeatureGate)(t,n);case"string":return(0,o.getStringFeatureGate)(t,n);default:throw new Error("Wrong defaultValue type")}}};const o=n(27806)},86338:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=function(e){return e=>(0,o.isChangeGateEnabled)(e)};const o=n(98526)},2070:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideChangeGates=r,t.overrideTypedChangeGates=function(e,t){return r(t)};const o=n(98526);function r(e){const t=(0,o.setChangeGateDictionaryGetter)(void 0);return(0,o.setChangeGateDictionaryGetter)((()=>({...void 0!==t?t():{},...e}))),t}},83398:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideFeatureGates=r,t.overrideTypedFeatureGates=function(e,t){return r(t)};const o=n(27806);function r(e){const t={};for(const n of Object.keys(e))t[n]=e[n]?.toString();const n=(0,o.setFeatureGateDictionaryGetter)(void 0)??(()=>({}));return(0,o.setFeatureGateDictionaryGetter)((()=>({...n(),...t}))),n}},98787:(e,t,n)=>{"use strict";n.d(t,{Ot:()=>c});let o,r=!1,s=[],i=0;const a=2e4;var l;function c(e){!function(e){r&&(o?o(e):s.length<=a?s.push(e):i+=1)}({kind:"event",event:e,timestamp:(new Date).getTime()})}!function(e){e.Count="Count",e.Avg="Avg",e.Sum="Sum"}(l||(l={}))},82058:(e,t,n)=>{"use strict";var o;n.d(t,{n:()=>o}),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_Wac_UniversalPrint=3068]="msoulscat_Wac_UniversalPrint",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",e[e.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",e[e.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",e[e.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",e[e.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",e[e.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",e[e.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",e[e.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",e[e.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",e[e.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",e[e.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",e[e.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",e[e.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint",e[e.msoulscat_AIHub_CreateModuleUI_Artifacts=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",e[e.msoulscat_AIHub_CreateModuleUI_BrandKit=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",e[e.msoulscat_AIHub_CreateModuleUI_Forms=4102]="msoulscat_AIHub_CreateModuleUI_Forms",e[e.msoulscat_AIHub_CreateModuleUI_Homepage=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",e[e.msoulscat_AIHub_CreateModuleUI_Text=4104]="msoulscat_AIHub_CreateModuleUI_Text",e[e.msoulscat_AIHub_CreateModuleUI_Video=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(o||(o={}))},88943:(e,t,n)=>{"use strict";var o;n.d(t,{k:()=>o}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={}))},54585:(e,t,n)=>{"use strict";n.d(t,{Hv:()=>r});class o{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const r=new class{constructor(){this.externalLogger=new o}setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,n,o){this.externalLogger.sendTraceTag(e,t,n,o)}debugAssertTag(e,t,n,o){this.externalLogger.debugAssertTag(e,t,n,o)}shipAssertTag(e,t,n,o){this.externalLogger.shipAssertTag(e,t,n,o)}}},27821:(e,t,n)=>{"use strict";var o,r,s,i,a;n.d(t,{OY:()=>o,Om:()=>s}),function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp",e[e.Dropbox=27]="Dropbox",e[e.GooglePhotos=28]="GooglePhotos",e[e.EditorApp=29]="EditorApp",e[e.AmazonKindle=30]="AmazonKindle",e[e.ShredderApp=31]="ShredderApp",e[e.FormsLowPrivilege=32]="FormsLowPrivilege",e[e.VivaSalesLowPrivilege=33]="VivaSalesLowPrivilege",e[e.IntentSvcApp=34]="IntentSvcApp",e[e.DcgLowPrivilege=35]="DcgLowPrivilege",e[e.CSALowPrivilege=36]="CSALowPrivilege",e[e.ConsumerSydneyLowPrivilege=37]="ConsumerSydneyLowPrivilege",e[e.CompliantSydneyApp=38]="CompliantSydneyApp",e[e.M365AdminApp=39]="M365AdminApp",e[e.MeetingArtifactsServiceLowPrivilege=40]="MeetingArtifactsServiceLowPrivilege",e[e.AlchemyApp=41]="AlchemyApp",e[e.M365Admin=42]="M365Admin",e[e.ConsumerShellApp=43]="ConsumerShellApp",e[e.PowerQueryLowPrivilege=44]="PowerQueryLowPrivilege",e[e.CIIApp=45]="CIIApp",e[e.ConsumerShell=46]="ConsumerShell",e[e.AssistCopilotLowPrivilege=47]="AssistCopilotLowPrivilege",e[e.Pva=48]="Pva",e[e.TeamsCopilotServiceLowPrivilege=49]="TeamsCopilotServiceLowPrivilege",e[e.CallAnalytics=50]="CallAnalytics",e[e.IncomingPFT=51]="IncomingPFT",e[e.GraphExchange=52]="GraphExchange",e[e.EXOAdmin=53]="EXOAdmin",e[e.InsightsServicesLowPrivilege=54]="InsightsServicesLowPrivilege",e[e.VivaServicesLowPrivilege=55]="VivaServicesLowPrivilege",e[e.EcsAppOnly=56]="EcsAppOnly",e[e.ShredderLowPrivilege=57]="ShredderLowPrivilege",e[e.SpoLowPrivilege=58]="SpoLowPrivilege",e[e.PromptValidationApp=59]="PromptValidationApp",e[e.CompliantSydneyLowPrivilege=60]="CompliantSydneyLowPrivilege",e[e.SubstrateTenantFeedbackApp=61]="SubstrateTenantFeedbackApp",e[e.MonitoringPlatform=62]="MonitoringPlatform",e[e.YammerLowPrivilege=63]="YammerLowPrivilege",e[e.VivaLearningLowPrivilege=64]="VivaLearningLowPrivilege",e[e.VivaInsightsLowPrivilege=65]="VivaInsightsLowPrivilege",e[e.ClientAugLoopApp=66]="ClientAugLoopApp",e[e.AssistAuthLowPrivilege=67]="AssistAuthLowPrivilege",e[e.VivaLearningSearchPreProdLowPrivilege=68]="VivaLearningSearchPreProdLowPrivilege",e[e.SubstrateSearchApp=69]="SubstrateSearchApp",e[e.SparkContentPlatformLowPrivilege=70]="SparkContentPlatformLowPrivilege",e[e.SparkContentPlatformPopApp=71]="SparkContentPlatformPopApp",e[e.ConsumerSydneyApp=72]="ConsumerSydneyApp",e[e.BusinessAssistAuthLowPrivilege=73]="BusinessAssistAuthLowPrivilege",e[e.AzureResourceManager=74]="AzureResourceManager",e[e.AlchemyPortal=75]="AlchemyPortal",e[e.VivaUserSkillsApp=76]="VivaUserSkillsApp",e[e.VivaEngageAppPop=77]="VivaEngageAppPop",e[e.SubstrateAppOnly=78]="SubstrateAppOnly",e[e.PowerAutomateFlowCreationLowPrivilege=79]="PowerAutomateFlowCreationLowPrivilege",e[e.PowerAutomateConnectionCreationLowPrivilege=80]="PowerAutomateConnectionCreationLowPrivilege",e[e.PowerAutomateAuthorizeConnectionLowPrivilege=81]="PowerAutomateAuthorizeConnectionLowPrivilege",e[e.TCAAppPop=82]="TCAAppPop",e[e.BusinessAssistAuthAppPop=83]="BusinessAssistAuthAppPop",e[e.HolmesApp=84]="HolmesApp",e[e.GraphAppOnly=85]="GraphAppOnly",e[e.SimsApp=86]="SimsApp",e[e.VivaOrgInsightsLowPrivilege=87]="VivaOrgInsightsLowPrivilege",e[e.VivaGoalsAppPop=88]="VivaGoalsAppPop",e[e.GCBotAppPop=89]="GCBotAppPop",e[e.ShredderV2App=90]="ShredderV2App",e[e.ShredderV2LowPrivilege=91]="ShredderV2LowPrivilege",e[e.AmplifyProfileService=92]="AmplifyProfileService",e[e.AzureDevopsLowPrivilege=93]="AzureDevopsLowPrivilege",e[e.CommuteServices=94]="CommuteServices",e[e.GCBotAppOnly=95]="GCBotAppOnly",e[e.TCAAppOnly=96]="TCAAppOnly",e[e.MavenAgentLowPrivilege=97]="MavenAgentLowPrivilege",e[e.VivaOrgInsightsAppPop=98]="VivaOrgInsightsAppPop",e[e.EduAssignmentsPftAtPop=99]="EduAssignmentsPftAtPop",e[e.AugloopAppPop=100]="AugloopAppPop",e[e.OneNoteLowPrivilege=101]="OneNoteLowPrivilege",e[e.TeamsAuthzSvcAppPop=102]="TeamsAuthzSvcAppPop",e[e.LoopAppPop=103]="LoopAppPop",e[e.LoopAppOnly=104]="LoopAppOnly",e[e.BapLowPrivilege=105]="BapLowPrivilege",e[e.IC3AppPop=106]="IC3AppPop",e[e.PowerPlatformApiGateway=107]="PowerPlatformApiGateway",e[e.OdspNotifyAppPop=108]="OdspNotifyAppPop",e[e.MIPSyncService=109]="MIPSyncService",e[e.RightsManagementServices=110]="RightsManagementServices",e[e.TCAV2AppPop=111]="TCAV2AppPop",e[e.SubstrateLLMLowPrivilege=112]="SubstrateLLMLowPrivilege",e[e.SubstrateSearchLowPrivilege=113]="SubstrateSearchLowPrivilege",e[e.CloudPolicyServiceAppPop=114]="CloudPolicyServiceAppPop",e[e.TCAV2LowPrivilege=115]="TCAV2LowPrivilege",e[e.AiHubServicesAppPop=116]="AiHubServicesAppPop",e[e.TMRAppOnly=117]="TMRAppOnly",e[e.PacmanAppPop=118]="PacmanAppPop",e[e.AugloopAlternativeIdentity=119]="AugloopAlternativeIdentity",e[e.SpoAppOnly=120]="SpoAppOnly",e[e.DataverseLowPrivilege=121]="DataverseLowPrivilege",e[e.SubstrateLLMApp=122]="SubstrateLLMApp",e[e.SimsAppOnly=123]="SimsAppOnly",e[e.PythonService=124]="PythonService",e[e.PythonServiceAppOnly=125]="PythonServiceAppOnly",e[e.DesignerAppServiceLowPrivilege=126]="DesignerAppServiceLowPrivilege",e[e.DesignerAppServiceAppPop=127]="DesignerAppServiceAppPop",e[e.AmplifyProfileServiceAppOnly=128]="AmplifyProfileServiceAppOnly",e[e.MARSAppPop=129]="MARSAppPop",e[e.PlannerAppPop=130]="PlannerAppPop",e[e.BingForBusinessLowPrivilege=131]="BingForBusinessLowPrivilege",e[e.OLS=132]="OLS",e[e.OLSAppPop=133]="OLSAppPop",e[e.GCS=134]="GCS",e[e.AugLoopConsumer=135]="AugLoopConsumer",e[e.ContentValidationServiceAppOnly=136]="ContentValidationServiceAppOnly",e[e.FabricLowPrivilege=137]="FabricLowPrivilege",e[e.FeatureAccessManagementAppPop=138]="FeatureAccessManagementAppPop",e[e.FireIntelligenceAppOnly=139]="FireIntelligenceAppOnly",e[e.MARSLowPrivilege=140]="MARSLowPrivilege",e[e.EXOAdminAppPop=141]="EXOAdminAppPop",e[e.IncomingAT=142]="IncomingAT",e[e.CopilotLabLowPrivilege=143]="CopilotLabLowPrivilege",e[e.VivaPulseLowPrivilege=144]="VivaPulseLowPrivilege",e[e.WacAppPop=145]="WacAppPop",e[e.PowerAppsAiBuilderLowPrivilege=146]="PowerAppsAiBuilderLowPrivilege",e[e.CognitiveApiAppOnly=147]="CognitiveApiAppOnly",e[e.CopilotMetricsAppOnly=148]="CopilotMetricsAppOnly",e[e.ShredderAppOnly=149]="ShredderAppOnly",e[e.TeamsAuthzSvcLowPrivilege=150]="TeamsAuthzSvcLowPrivilege",e[e.PlannerLowPrivilege=151]="PlannerLowPrivilege"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(r||(r={})),function(e){e[e.Default=0]="Default",e[e.EDPSCompliant=1]="EDPSCompliant"}(s||(s={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials",e.RefreshToken="refresh_token"}(i||(i={})),function(e){e[e.LoggedIn=0]="LoggedIn",e[e.LoggedOut=1]="LoggedOut"}(a||(a={}))},45040:(e,t,n)=>{"use strict";var o;n.d(t,{q:()=>o}),function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug",e[e.disabled=7]="disabled"}(o||(o={}))},62531:(e,t,n)=>{"use strict";n.d(t,{tG:()=>b,nh:()=>N,OD:()=>k});var o,r=n(45040),s=n(27821);!function(e){e.Log="Log"}(o||(o={}));const i="undefined"!=typeof process&&process.env?process.env.SERVICE_NAME:"client",a="abcdefghijklmnopqrstuvwxyz0123456789",l={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35};let c,u=[],d=[],h=e=>null,p=e=>{};const f=new Map,g=new Map,m=new Map,y=new Map;var v,b;!function(e){e.Default="",e.EDPSCompliant="edps"}(v||(v={})),function(e){e.defineCoreLogCategory=e=>({root:"Core",name:e}),e.defineWorkflowLogCategory=e=>({root:"Workflow",name:e}),e.clearLoggers=()=>{u=[],d=[],g.clear(),m.clear()},e.clearAggregators=()=>{f.clear()},e.addLogger=e=>{-1===u.indexOf(e)&&(u.push(e),S(g,e))},e.addDecidingLogger=e=>{-1===d.indexOf(e)&&(d.push(e),S(m,e))},e.setCorrelationContextCallback=e=>{c=e},e.setStartPerformanceEventCallback=e=>{h=e},e.setStopPerformanceEventCallback=e=>{p=e},e.addAggregator=e=>{e.init(((e,t)=>{P(e,t)})),f.has(e.eventName)?f.get(e.eventName).push(e):f.set(e.eventName,[e])},e.flushAggregators=e=>{f.forEach((t=>{t.forEach((t=>t.flush(e)))}))},e.setTagLevelOverride=(e,t)=>{const n=O(e);y.set(n,t)},e.resetTagLevelOverrides=()=>{y.clear()},e.error=(e,t,n,o,s,i,a,l,c,u)=>{I(e,t,r.q.error,n,o,s,i,a,l,c,u)},e.warn=(e,t,n,o,s,i,a,l,c,u)=>{I(e,t,r.q.warn,n,o,s,i,a,l,c,u)},e.info=(e,t,n,o,s,i,a,l,c,u)=>{I(e,t,r.q.info,n,o,s,i,a,l,c,u)},e.verbose=(e,t,n,o,s,i,a,l,c,u)=>{I(e,t,r.q.verbose,n,o,s,i,a,l,c,u)},e.debug=(e,t,n,o,s,i,a,l,c,u)=>{I(e,t,r.q.debug,n,o,s,i,a,l,c,u)},e.metric=(e,t,n,o,s,i,a,l,c,u)=>{I(e,t,r.q.metric,n,o,s,i,a,l,c,u)},e.formatMetric=(e,t,n,o)=>{const r={};return r[e]={dimensionNames:n,dimensionValues:o,value:t},r},e.dynamic=e=>{P(e)}}(b||(b={}));const S=(e,t)=>{const n=t.level;Object.keys(r.q).map((e=>r.q[e])).filter((e=>"string"!=typeof e)).filter((e=>e<=n)).forEach((n=>{e.has(n)?e.get(n).push(t):e.set(n,[t])}))},w=e=>{if("string"==typeof e)return e;let t="";for(let n=0;n<e.length;n++){n>0&&(t+=" ");const o=e[n];o instanceof Error?t+=JSON.stringify({message:o.message,name:o.name,stack:o.stack}):t+="object"==typeof o?JSON.stringify(o):o}return t},T=[],_=["Level","Tag"],C=["Level","Tag","Workflow"],k=e=>E(e).length,E=e=>void 0!==e?g.get(e)||T:u,A=(e,t)=>(void 0!==e?m.get(e)||[]:d).filter((e=>e.shouldLog(t))),I=(e,t,n,r,s,i,a,l,u,d,g)=>{n=y.get(e)||n;const m=E(n),v=A(n,r);if(0==m.length&&0==v.length)return;const b=h(o.Log),S=D(e),T=((e,t,n,o,r,s,i,a)=>{if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();const l=[];for(const c of[e,t,n,o,r,s,i,a])void 0!==c&&l.push("function"==typeof c?c():c);return l})(r,s,i,a,l,u,d,g);if(M(t))x(T)&&P({eventName:"Metrics",tagId:S,category:`${t.root}.${t.name}`,traceLevel:n,message:"",getMetrics:()=>T},!1,m,v);else if(x(T)){const e=T;e.tagId=S,e.category=`${t.root}.${t.name}`,"Operation"===e.eventName&&"Workflow"===t.root&&(e.eventName="WorkflowOperation",c&&(e.joinContextId=c().joinContextId,e.workflow=c().workflow)),e.traceLevel=n;const o=f.get(e.eventName);if(o)for(let t=0;t<o.length;++t){const n=o[t];if(n&&n.add(e,t===o.length-1))break}else P(e,!1,m,v)}else{const e=()=>{var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:()=>_,dimensionValues:[String(n),S],value:1}}:{WorkflowTraceEvent:{dimensionNames:()=>C,dimensionValues:[String(n),S,c?null===(e=c())||void 0===e?void 0:e.workflow:""],value:1}}};P({eventName:"Log",tagId:S,category:`${t.root}.${t.name}`,traceLevel:n,message:w(T),getMetrics:e},!1,m,v)}p(b)},P=(e,t=!1,n,o)=>{var r,s,a,l,u,d,h,p,f,g,m,y,v,b;let S;if(null==n&&(n=E(e.traceLevel)),o=o||T,n.length>0||o.length>0){if(e.serviceName=i,!t&&c){const t=c();t&&(S={disableLogging:t.disableLogging,userDataBoundaryType:null===(s=null===(r=t.sessionDescriptor)||void 0===r?void 0:r.userContext)||void 0===s?void 0:s.userDataBoundaryType},e.cv=e.cv?e.cv:t.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:t.sessionKey,e.userTenantId=e.userTenantId?e.userTenantId:t.userTenantId,e.workflow=e.workflow?e.workflow:t.workflow,e.clientAppName=e.clientAppName?e.clientAppName:null===(a=t.clientMetadata)||void 0===a?void 0:a.appName,e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:null===(l=t.clientMetadata)||void 0===l?void 0:l.appPlatform,e.clientAppVersion=e.clientAppVersion?e.clientAppVersion:null===(u=t.clientMetadata)||void 0===u?void 0:u.appVersion,e.clientDocSessionId=e.clientDocSessionId?e.clientDocSessionId:null===(d=t.clientMetadata)||void 0===d?void 0:d.docSessionId,e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:null===(h=t.clientMetadata)||void 0===h?void 0:h.releaseAudienceGroup,e.clientReleaseChannel=e.clientReleaseChannel?e.clientReleaseChannel:null===(p=t.clientMetadata)||void 0===p?void 0:p.releaseChannel,e.clientReleaseFork=e.clientReleaseFork?e.clientReleaseFork:null===(f=t.clientMetadata)||void 0===f?void 0:f.releaseFork,e.clientRuntimeVersion=e.clientRuntimeVersion?e.clientRuntimeVersion:null===(g=t.clientMetadata)||void 0===g?void 0:g.runtimeVersion,e.clientSessionId=e.clientSessionId?e.clientSessionId:null===(m=t.clientMetadata)||void 0===m?void 0:m.sessionId,e.clientUserAgent=e.clientUserAgent?e.clientUserAgent:null===(y=t.clientMetadata)||void 0===y?void 0:y.userAgent,e.traceId=e.traceId||t.traceId,e.isClientTelemetrySampled=e.isClientTelemetrySampled?e.isClientTelemetrySampled:null===(v=t.clientMetadata)||void 0===v?void 0:v.isClientTelemetrySampled,e.userDataBoundaryType=R(S),e.ecsConfigIDs=null===(b=t.ecsConfigIDsManager)||void 0===b?void 0:b.getAllConfigIDsString())}for(const t of n)t.log(e,S);for(const t of o)t.log(e)}},M=e=>e.name===N.WorkflowMetricsOnly.name&&e.root===N.WorkflowMetricsOnly.root,x=e=>!Array.isArray(e)&&"object"==typeof e,R=e=>(null==e?void 0:e.userDataBoundaryType)===s.Om.EDPSCompliant?v.EDPSCompliant:v.Default,D=e=>a[e>>24&63]+a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[63&e],O=e=>e&&5===e.length?l[e.charCodeAt(0)]<<24|l[e.charCodeAt(1)]<<18|l[e.charCodeAt(2)]<<12|l[e.charCodeAt(3)]<<6|l[e.charCodeAt(4)]:-1;class N{}N.CoreDefault=b.defineCoreLogCategory("Default"),N.CoreSystem=b.defineCoreLogCategory("System"),N.CoreUnsampled=b.defineCoreLogCategory("Unsampled"),N.WorkflowDefault=b.defineWorkflowLogCategory("Default"),N.WorkflowUnsampled=b.defineWorkflowLogCategory("Unsampled"),N.WorkflowMetricsOnly=b.defineWorkflowLogCategory("MetricsOnly"),N.PrivacyGuardEvent=b.defineCoreLogCategory("PrivacyGuardEvent")},64384:(e,t,n)=>{"use strict";n.d(t,{g:()=>r,t:()=>o});const o="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?()=>performance.now():()=>Date.now(),r="undefined"!=typeof process&&process.hrtime?()=>{const e=process.hrtime();return 1e6*e[0]+e[1]/1e3}:"undefined"!=typeof performance&&performance.now?()=>Math.round(1e3*performance.now()):()=>1e3*Date.now()},36182:(e,t,n)=>{"use strict";n.d(t,{I:()=>c});var o={util:{},roots:{default:{}}},r=(o.util,o.roots.default||(o.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultJSON="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/OperationEvent"},e}()),s=n(64384);const i=Symbol("dataFieldsObject"),a=Symbol("dataFieldsAreDirty"),l=Symbol("_dataFields");class c extends r{constructor(e,t){super(e),this.eventName="Operation",this.options=t,this.durationMs=null==e?void 0:e.durationMs,e&&null!=e.count||(this.count=1),(null==e?void 0:e.dataFields)&&(this.dataFields=e.dataFields)}setClientMetadata(e,t){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,null!=t&&t||(this.clientFlights=e.flights),this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setMetricCustomDimensions(e,t){if(!this.options)throw new Error(`Attempting to set custom dimensions ${e} to operation ${this.operationName} without activating MetricCount or MetricDuration`);this.options.metricCustomDimensions=this.options.metricCustomDimensions||{},this.options.metricCustomDimensions[e]=t}setDataField(e,t){this[i]||(this[i]={}),this[i][e]=t,this[a]=!0}setDataFields(e){this[i]||(this[i]={}),this[i]=Object.assign(Object.assign({},this[i]),e),this[a]=!0}start(){return this.startTime=(0,s.t)(),this}recordStep(e){return this.setDataField(e,Math.floor((0,s.t)()-this.startTime)),this}stop(){const e=(0,s.t)();return this.durationMs=Math.round(e-this.startTime),this}addCustomMetric(e){void 0===this.customMetrics&&(this.customMetrics=[]),this.customMetrics.push(e)}getCustomMetrics(){const e=[];if(void 0!==this.customMetrics){const t=e=>[...this.getDimensionNames(),...e.extraDimensions.map((e=>e.name))];for(const n of this.customMetrics){const o={};o[`${this.operationName}.${n.nameSuffix}`]={dimensionNames:()=>t(n),dimensionValues:[...this.getDimensionValues(),...n.extraDimensions.map((e=>e.value))],value:n.value},e.push(o)}}return e}getMetrics(e){var t,n;const o={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":o[this.operationName+".CountV2"]={dimensionNames:c.getOrphanedSessionHealthDimensionNames.bind(c),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":o[this.operationName+".Reason"]={dimensionNames:c.getSessionHealthDimensionNames.bind(c),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:if("matchmaker_timer"===this.operationName&&(o["Workflow.DurationMs"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},o["Workflow.Count"]={dimensionNames:c.getWorkflowDimensionNames.bind(c),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==this.durationMs){const n=`${this.operationName}.DurationMsV2`;((null===(t=this.options)||void 0===t?void 0:t.metricDuration)||e.indexOf(n)>=0)&&(o[n]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs})}{const t=`${this.operationName}.CountV2`;((null===(n=this.options)||void 0===n?void 0:n.metricCount)||e.indexOf(t)>=0)&&(o[t]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}}return o}getDimensionNames(){var e,t;let n=c.dimensionNames;if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions){n=n.slice();for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)n.push(e)}return n}getDimensionValues(){var e,t;const n=[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3];if(null===(e=this.options)||void 0===e?void 0:e.metricCustomDimensions)for(const e in null===(t=this.options)||void 0===t?void 0:t.metricCustomDimensions)n.push(this.options.metricCustomDimensions[e]);return n}static getOrphanedSessionHealthDimensionNames(){return this.orphanedSessionHealthDimensionNames}getOrphanedSessionHealthDimensionValues(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getSessionHealthDimensionNames(){return this.sessionHealthDimensionNames}getSessionHealthDimensionValues(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}static getWorkflowDimensionNames(){return this.workflowDimensionNames}getWorkflowDimensionValues(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]}}c.dimensionNames=["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.orphanedSessionHealthDimensionNames=["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],c.sessionHealthDimensionNames=["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"],c.workflowDimensionNames=["ResultSignature","WorkflowId","ResourceId","Success"],Object.defineProperty(c.prototype,"dataFields",{get:function(){var e,t;return this[a]&&(this[l]=JSON.stringify(null!==(e=this[i])&&void 0!==e?e:{}),this[a]=!1),void 0!==this[a]?this[l]:null!==(t=this[l])&&void 0!==t?t:""},set:function(e){this[i]=e&&""!==e?JSON.parse(e):{},this[l]=e,this[a]=!1},enumerable:!0,configurable:!0})},30712:(e,t,n)=>{"use strict";var o;n.r(t),n.d(t,{ALFactoryGlobal:()=>ns,Alignment:()=>us,AsyncClientRequestBuilder:()=>M,AugLoopFactory:()=>ts,AugLoopRuntimeManager:()=>zr,AugLoopStandardSchema:()=>ms,AuthTokenResponseError:()=>dt,CapsType:()=>is,CrudAugLoopStandardSchema:()=>ys,DataObject:()=>fs,FontWeight:()=>ls,FormattedSpan:()=>ds,IdentityProvider:()=>ct,Lambda:()=>ps,LambdaException:()=>gs,ListType:()=>cs,MockAugLoopRuntimeManager:()=>vs,ServerAuthenticationState:()=>mt.f,TextTile:()=>hs,Tile:()=>os,Tile$1:()=>rs,TileType:()=>ss,UnderlineType:()=>as}),function(e){e[e.SingleAnnotation=0]="SingleAnnotation",e[e.Streaming=1]="Streaming",e[e.CustomMessage=2]="CustomMessage"}(o||(o={}));var r=n(66300);class s{constructor(){this._fulfilled=!1,this.completion=new Promise(((e,t)=>{this.onResolve=e,this.onReject=t}))}resolve(e){this._fulfilled=!0,this.onResolve(e)}reject(e){this._fulfilled=!0,this.onReject(e)}get fulfilled(){return this._fulfilled}}class i extends Error{constructor(e){super(e),Object.setPrototypeOf(this,i.prototype)}}class a extends Error{constructor(e){super(e),Object.setPrototypeOf(this,a.prototype)}}class l extends Error{constructor(e,t){super(e),Object.setPrototypeOf(this,l.prototype),this.erroInfo=t}}class c extends Error{constructor(e){super(e),Object.setPrototypeOf(this,c.prototype)}}class u extends Error{constructor(e){super(e),Object.setPrototypeOf(this,u.prototype)}}Error;class d{executeAfter(e,t){let n=setTimeout((()=>{n=null,e()}),t);return()=>{null!==n&&(clearTimeout(n),n=null)}}}const h=new d;class p{constructor(){this._isCancellationRequested=!1,this.onCancelCallbacks=[]}cancel(){if(!this._isCancellationRequested){this._isCancellationRequested=!0;for(const e of this.onCancelCallbacks)e(this);this.onCancelCallbacks=[]}}get IsCancellationRequested(){return this._isCancellationRequested}onCancel(e){this._isCancellationRequested?e(this):this.onCancelCallbacks.push(e)}rejectWhenCancellationRequested(){return new Promise(((e,t)=>{this.onCancel((()=>t(new i("Token cancelled"))))}))}removeCancelCallback(e){const t=this.onCancelCallbacks.indexOf(e);t>-1&&this.onCancelCallbacks.splice(t,1)}dispose(){this.onCancelCallbacks=[]}}class f{constructor(e){this.internalToken=new p,this.clearScheduledCancel=null,this.scheduler=null!=e?e:h}get token(){return this.internalToken}cancel(){var e;this.internalToken.IsCancellationRequested||(this.internalToken.cancel(),null===(e=this.clearScheduledCancel)||void 0===e||e.call(this))}cancelAfter(e){var t;if(this.token.IsCancellationRequested)return;if(e<0)throw new Error("Duration can not be negative");null===(t=this.clearScheduledCancel)||void 0===t||t.call(this);const n=this.scheduler.executeAfter((()=>{this.cancel(),this.clearScheduledCancel=null}),e);this.clearScheduledCancel=()=>{n(),this.clearScheduledCancel=null}}dispose(){var e;this.internalToken&&(null===(e=this.clearScheduledCancel)||void 0===e||e.call(this),this.internalToken.dispose(),this.internalToken=null)}}class g{constructor(...e){this.innerCancelSource=new f,this.unsubscribeFromTokens=null,this.onLinkedTokenCancelled=()=>{var e;this.innerCancelSource.cancel(),null===(e=this.unsubscribeFromTokens)||void 0===e||e.call(this)},this.subscribeToTokens(e)}get token(){return this.innerCancelSource.token}dispose(){var e;null===(e=this.unsubscribeFromTokens)||void 0===e||e.call(this)}subscribeToTokens(e){e.some((e=>e.IsCancellationRequested))?this.innerCancelSource.cancel():(e.forEach((e=>e.onCancel(this.onLinkedTokenCancelled))),this.unsubscribeFromTokens=()=>{this.unsubscribeFromTokens=null,e.forEach((e=>e.removeCancelCallback(this.onLinkedTokenCancelled)))})}}class m{constructor(e,t,n){this.scheduler=e,this.callerCancelToken=t,this.timeoutMs=n}runWithCombinedToken(e){return t=this,n=void 0,r=function*(){const t=new f(this.scheduler),n=new g(this.callerCancelToken,t.token);try{return void 0!==this.timeoutMs&&t.cancelAfter(this.timeoutMs),yield e(n.token)}catch(e){if(e instanceof i&&!this.callerCancelToken.IsCancellationRequested&&t.token.IsCancellationRequested)throw new a(`strategy timeout: ${this.timeoutMs}`);throw e}finally{n.dispose(),t.dispose()}},new((o=void 0)||(o=Promise))((function(e,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,a)}l((r=r.apply(t,n||[])).next())}));var t,n,o,r}}class y{constructor(e,t){this.value=null,this.error=null,this.value=e,this.error=t}static createValue(e){return new y(e,null)}static createError(e){return new y(null,e)}isError(){return null!==this.error}}class v{constructor(){this.items=[],this.pendingDequeuePromise=null}enqueue(e){var t;this.items.push(y.createValue(e)),null===(t=this.pendingDequeuePromise)||void 0===t||t.resolve()}enqueueError(e){var t;this.items.push(y.createError(e)),null===(t=this.pendingDequeuePromise)||void 0===t||t.resolve()}dequeue(e){return t=this,n=void 0,r=function*(){if(0===this.items.length){if(this.pendingDequeuePromise)throw new Error("Cannot have simultaneous dequeues");this.pendingDequeuePromise=new s;try{yield Promise.race([this.pendingDequeuePromise.completion,e.rejectWhenCancellationRequested()])}finally{this.pendingDequeuePromise=null}}return this.items.shift()},new((o=void 0)||(o=Promise))((function(e,s){function i(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(i,a)}l((r=r.apply(t,n||[])).next())}));var t,n,o,r}empty(){return 0===this.items.length}}var b=n(62531),S=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class w{constructor(e,t,n,o){this.operation=e,this.params=t,this.timeout=n,this.cv=o}build(){var e;return{type:o.Streaming,operation:this.operation,cv:this.cv,firstAnnotationTimeoutMs:null!==(e=this.timeout.firstAnnotationTimeoutMs)&&void 0!==e?e:void 0,perAnnotationTimeoutMs:this.timeout.perAnnotationTimeoutMs,chunks:this.params.chunks,completion:this.params.completion}}}class T{constructor(e,t,n,o,r){this.session=e,this.request=t,this.cancelToken=n,this.scheduler=o,this.logOp=r,this.logOp.resourceId="StreamingRequest"}execute(){return S(this,void 0,void 0,(function*(){const e=this.request.firstAnnotationTimeoutMs?Math.min(this.request.firstAnnotationTimeoutMs,this.request.perAnnotationTimeoutMs):this.request.perAnnotationTimeoutMs,t={annotationType:[this.request.chunks.getTypeName(),this.request.completion.getTypeName()],transientItems:this.request.operation.items.map((e=>Object.assign(Object.assign({},e),{parentPath:this.request.operation.parentPath}))),maxDelayMs:e,sourceInfo:{}},n=this.session.getAnnotations(t,this.cancelToken),o=new v,r=new _(n,this.scheduler,this.cancelToken,this.request,o,this.logOp);return r.initialize().catch((e=>{o.enqueueError(e)})),Promise.resolve(r)}))}}class _{constructor(e,t,n,o,r,i){this.iterable=e,this.scheduler=t,this.cancelToken=n,this.request=o,this.queue=r,this.logOp=i,this.completionPromise=new s,this.complete=!1,this.isFirstAnnotation=!0}subscribeResults(e){var t,n,o,r,s,i,a;return S(this,void 0,void 0,(function*(){try{try{for(t=!0,n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}(e);o=yield n.next(),!(r=o.done);t=!0){a=o.value,t=!1;const e=a;if(this.completionPromise.fulfilled)break;this.onGetAnnotationResponse(e)}}catch(e){s={error:e}}finally{try{t||r||!(i=n.return)||(yield i.call(n))}finally{if(s)throw s.error}}}catch(e){this.queue.enqueueError(e)}}))}initialize(){return S(this,void 0,void 0,(function*(){return this.subscribeResults(this.iterable)}))}onGetAnnotationResponse(e){if(e.error)throw new l(JSON.stringify(e.error),e.error);const t=e.content.map((e=>e.body));for(const e of t)this.isFirstAnnotation&&(this.isFirstAnnotation=!1),this.queue.enqueue(e);e.finalResponse&&(this.complete=!0)}[Symbol.asyncIterator](){return this}get chunks(){return this}get completion(){return this.completionPromise.completion}next(){return S(this,void 0,void 0,(function*(){try{const e=this.request.firstAnnotationTimeoutMs&&this.request.firstAnnotationTimeoutMs?this.request.firstAnnotationTimeoutMs:this.request.perAnnotationTimeoutMs,t=new m(this.scheduler,this.cancelToken,e),n=yield t.runWithCombinedToken(this.waitForNextEvent.bind(this)),{value:o}=n;return n.isError()?this.handleError(n.error):this.complete&&this.queue.empty()?this.request.completion.typeGuard(o)?(this.completionPromise.resolve(o),this.handleFinalResult(o)):this.handleError(new c(`(Streaming completion) expect: ${this.request.completion.getTypeName()}, received: ${r.h.getTypeNameFor(o)}`)):this.request.chunks.typeGuard(o)?{done:!1,value:o}:this.handleError(new c(`(Streaming chunks) expect: ${this.request.chunks.getTypeName()}, received: ${r.h.getTypeNameFor(o)}`))}catch(e){return this.handleError(e)}}))}handleError(e){return this.completionPromise.reject(e),this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,this.handleFinalResult(e)}handleFinalResult(e){return b.tG.info(505427165,b.nh.CoreDefault,this.logOp.stop()),{done:!0,value:e}}waitForNextEvent(e){return S(this,void 0,void 0,(function*(){return yield this.queue.dequeue(e)}))}}var C=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class k{constructor(e,t,n,o){this.operation=e,this.annotation=t,this.timeoutMs=n,this.cv=o}build(){return{type:o.SingleAnnotation,operation:this.operation,cv:this.cv,annotation:this.annotation,timeoutMs:this.timeoutMs}}}class E{constructor(e,t,n,o,r){this.session=e,this.request=t,this.cancelToken=n,this.scheduler=o,this.logOp=r,this.completionPromise=new s,this.logOp.resourceId="SingleAnnotationRequest"}execute(){return C(this,void 0,void 0,(function*(){try{const e=new m(this.scheduler,this.cancelToken,this.request.timeoutMs);return yield e.runWithCombinedToken(this.executeOnAnnotation.bind(this))}catch(e){throw this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,e}finally{b.tG.info(505427166,b.nh.CoreDefault,this.logOp.stop())}}))}executeOnAnnotation(e){return C(this,void 0,void 0,(function*(){try{const t={annotationType:[this.request.annotation.getTypeName()],transientItems:this.request.operation.items.map((e=>Object.assign(Object.assign({},e),{parentPath:this.request.operation.parentPath}))),maxDelayMs:this.request.timeoutMs,sourceInfo:{}},n=this.session.getAnnotations(t,e);return yield Promise.race([this.subscribeAnnotations(n),e.rejectWhenCancellationRequested()])}catch(e){throw e}}))}subscribeAnnotations(e){var t,n,o,s,i,a,d;return C(this,void 0,void 0,(function*(){try{for(t=!0,n=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}(e);o=yield n.next(),!(s=o.done);t=!0){d=o.value,t=!1;const e=d;if(e.error){this.completionPromise.reject(new l(JSON.stringify(e.error),e.error));break}const n=e.content.map((e=>e.body));1==n.length?this.request.annotation.typeGuard(n[0])?this.completionPromise.resolve(n[0]):this.completionPromise.reject(new c(`(SingleAnnotation) expect: ${this.request.annotation.getTypeName()}, received: ${r.h.getTypeNameFor(n[0])}`)):this.completionPromise.reject(new u(`Number of annotations received: ${n.length}`));break}}catch(e){i={error:e}}finally{try{t||s||!(a=n.return)||(yield a.call(n))}finally{if(i)throw i.error}}return this.completionPromise.completion}))}}var A=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class I{constructor(e,t,n){this.message=e,this.responseType=t,this.timeoutMs=n}build(){return{type:o.CustomMessage,message:this.message,responseType:this.responseType,timeoutMs:this.timeoutMs}}}class P{constructor(e,t,n,o,r){this.session=e,this.request=t,this.cancelToken=n,this.scheduler=o,this.logOp=r,this.logOp.resourceId="CustomMessageRequest"}execute(){return A(this,void 0,void 0,(function*(){try{const e=new m(this.scheduler,this.cancelToken,this.request.timeoutMs);return yield e.runWithCombinedToken(this.executeOnAnnotation.bind(this))}catch(e){throw this.logOp.success=!1,this.logOp.resultDescription=`[name, message, stack]: [${e.name}, ${e.message}, ${e.stack}]`,e}finally{b.tG.info(505427164,b.nh.CoreDefault,this.logOp.stop())}}))}executeOnAnnotation(e){return A(this,void 0,void 0,(function*(){return yield Promise.race([this.submitRequest(),e.rejectWhenCancellationRequested()])}))}submitRequest(){return A(this,void 0,void 0,(function*(){const e=yield this.session.submitCustomMessage(this.request.message);if(!this.request.responseType.typeGuard(e))throw new c(`Response type do not match. Actual: ${r.h.getTypeNameFor(e)}, Expected: ${this.request.responseType}`);return e}))}}class M{constructor(){}static forOperation(e,t){return new x(e,t)}static forMessage(e){return new R(e)}}class x{constructor(e,t){this.op=e,this.cv=t}withSingleAnnotation(e,t){return new k(this.op,e,t,this.cv)}withStreaming(e,t){return new w(this.op,e,t,this.cv)}}class R{constructor(e){this.message=e}withResponse(e,t){return new I(this.message,e,t)}}var D,O,N=n(45040),L=n(36182);!function(e){e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance"}(D||(D={})),function(e){e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.RequiredServiceDataEvent=110]="RequiredServiceDataEvent"}(O||(O={}));const F=/\|\~/g;class B{constructor(){this.count=0,this.measureSums=new Map}}class W{constructor(e,t,n,o,r){this.buckets=new Map,this.init=e=>{this.log=e},this.add=(e,t=!0)=>{if(!this.condition||!this.condition(e))return!0===t&&this.log(e,!1),!1;const n=[];for(const t of this.dimensions)if(void 0===e[t]||null===e[t])n.push(null);else{let o="";"boolean"==typeof e[t]?o="b~":"number"==typeof e[t]&&(o="n~"),n.push(`${o}${e[t].toString().replace(F,"_")}`)}const o=n.join("|");let r=this.buckets.get(o);if(!r){r=new B,r.traceLevel=e.traceLevel;for(const e of this.avgMeasures)r.measureSums.set(e,0);this.buckets.set(o,r)}r.count++;for(const t of this.avgMeasures)e[t]&&r.measureSums.set(t,r.measureSums.get(t)+e[t]);return!0},this.flush=(e=!1)=>{this.buckets.forEach(((e,t)=>{const n={traceLevel:e.traceLevel,eventName:this.eventName,count:e.count},o=t.split("|");for(let e=0;e<this.dimensions.length;e++){const t=this.dimensions[e],r=o[e];0===r.indexOf("b~")?n[t]="b~true"===r:0===r.indexOf("n~")?n[t]=parseInt(r.slice(2),10):n[t]=r}for(const t of this.avgMeasures)n[t]=Math.round(e.measureSums.get(t)/e.count);this.log(n,!0)})),this.buckets.clear(),e&&(this.condition=null,clearInterval(this.interval))},this.eventName=e,this.condition=t,this.dimensions=n,this.avgMeasures=o,r>0&&(this.interval=setInterval(this.flush,1e3*r))}}const U=["cloud.dev.microsoft","officeppe.com","cloud.microsoft","office.com","office365.us","ic.gov","microsoft.scloud","microsoftonline.cn"],G=(e,t,n,o)=>new W(e,(e=>e.success&&n.indexOf(e[t])>=0),[t,"ariaNamespace","resourceId","success","resultSignature","clientDocSessionId","dimension0","dimension1","dimension2","dimension3"],["durationMs"],o),H=e=>{if(!e)return e;for(const t of U)if(e.indexOf(t)>=0)return e;return"**redacted**"};class q{constructor(e){this.level=N.q.info,this.hostCallbacks=e}log(e){if(null==this.hostCallbacks||null==this.hostCallbacks.sendTelemetryEvent)return;const t=(e,t,n,o,r)=>{let s=t.charAt(0).toUpperCase()+t.slice(1),i={DocSessionId:e.clientDocSessionId,ResourceId:e.resourceId,ResultDescription:e.resultDescription,ResultSignature:e.resultSignature,Dimension0:e.dimension0,Dimension1:e.dimension1,Dimension2:e.dimension2,Dimension3:e.dimension3,JoinContextId:e.joinContextId,ServerSessionKey:this.serverSessionKey};n&&(i=Object.assign(Object.assign({},i),JSON.parse(n)));const a=o||q.augLoopAriaTenantToken,l=r||a!=q.augLoopAriaTenantToken?r:q.augLoopAriaNamespace;s=s||q.operationNamePlaceholder;const c={CV:e.cv,Duration:1e3*(e.durationMs||0),Count:e.count,AggMode:2,Success:e.success};this.hostCallbacks.sendTelemetryEvent(a,l?`${l}_${s}`:s,i,"Office.System.Activity",c,!1,D.ProductServiceUsage|D.ProductServicePerformance,O.RequiredServiceDataEvent)};if("Workflow.MetricsOnly"==e.category);else if("Operation"===e.eventName){const n=e;t(n,n.operationName,n.dataFields,void 0,n.ariaNamespace)}else if("SessionHealth"===e.eventName)t(e,e.sessionHealthEventName);else if("WorkflowOperation"===e.eventName){const n=e;t(n,n.operationName,n.dataFields,n.ariaTenant,n.ariaNamespace)}else"Log"===e.eventName&&((e,t,n)=>{this.hostCallbacks.sendDiagnosticTrace&&this.hostCallbacks.sendDiagnosticTrace(e,t,n)})(e.tagId,e.traceLevel,e.message)}setServerSessionKey(e){this.serverSessionKey=e}}q.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",q.augLoopAriaNamespace="Office_AugLoop_Client",q.operationNamePlaceholder="OperationNameNotProvided";var $=null;"undefined"!=typeof WebSocket?$=WebSocket:"undefined"!=typeof MozWebSocket?$=MozWebSocket:void 0!==n.g?$=n.g.WebSocket||n.g.MozWebSocket:"undefined"!=typeof window?$=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&($=self.WebSocket||self.MozWebSocket);const V=$,j="object"==typeof process&&"object"==typeof process.versions&&void 0!==process.versions.node,z=1e5;class Q{constructor(e,t){this.networkOverrideOptions=e,this.settings=t,this.hadEgressError=!1,this.isClosing=!1,this.pendingEgress=[]}get egressByteCountOp(){return this._egressByteCountOp||(this._egressByteCountOp=new L.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0}),this._egressByteCountOp.setClientMetadata(this.clientMetadata,!0)),this._egressByteCountOp}init(e,t,n,o,r){var s,i;if(this.clientMetadata=r,j&&this.networkOverrideOptions){const t={servername:null===(s=this.networkOverrideOptions)||void 0===s?void 0:s.hostHeader,headers:(null===(i=this.networkOverrideOptions)||void 0===i?void 0:i.hostHeader)?{host:this.networkOverrideOptions.hostHeader}:void 0};this.ws=new V(e,t)}else this.ws=new V(e);this.logOp=new L.I({operationName:Q.className,success:!0}).start(),this.logOp.setClientMetadata(r,!0),this.ingressByteCountOp=new L.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0}),this.ingressByteCountOp.setClientMetadata(r,!0),this.ws.addEventListener("open",(e=>{n(),this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),b.tG.info(508843801,b.nh.CoreDefault,this.logOp.stop())})),this.ws.addEventListener("message",(e=>{this.logIngressCount(e.data),t(e.data)})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,b.tG.info(508843800,b.nh.CoreDefault,this.logOp.stop()),this.ws?this.ws.close():this.logWsUndefinedError("error event handler")})),this.ws.addEventListener("close",(e=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,b.tG.info(508843799,b.nh.CoreDefault,this.logOp.stop()),o(this.errorMessage),this.isClosing=!1}))}egress(e){var t;const n=e.obj;(null===(t=this.settings)||void 0===t?void 0:t.webSocketWorkerShouldLogEgressCount)&&this.logEgressCount(n),this.ws.send(n,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,this.logOp.resourceId="OnEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,b.tG.info(508843797,b.nh.CoreDefault,this.logOp.stop()))}))}close(){this.isClosing||(this.isClosing=!0,this.ws?this.ws.close():this.logWsUndefinedError("close"))}logIngressCount(e){const t=e.length;t>z&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),b.tG.info(508843794,b.nh.CoreDefault,this.ingressByteCountOp.stop()))}logEgressCount(e){const t="string"==typeof e?e.length:e.byteLength;t>z&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=t.toString().length.toString(),b.tG.info(505710625,b.nh.CoreDefault,this.egressByteCountOp.stop()))}logWsUndefinedError(e){const t=new L.I({operationName:Q.className,success:!1}).start();t.setClientMetadata(this.clientMetadata,!0),t.resourceId="webSocketUndefined",t.resultDescription=e+": this.ws null or undefined",b.tG.info(506566722,b.nh.CoreDefault,t.stop())}}Q.className="WebSocketWorker";class J{constructor(e){this.childCount=0,this.id=e||function(){for(let e=0;e<Y;e++)X[e]=K[Math.floor(Math.random()*K.length)];return X.join("")}()}static fromString(e,t){if(!e)throw new Error("Received invalid correlation vector string");let n;return n=e.endsWith(".0")?new J(e.substring(0,e.length-2)):new J(e),t&&(n.childCount=t),n}newChild(){return++this.childCount,new J(this.id+"."+this.childCount.toString())}toString(){return this.id.length>127?this.id.substring(0,127)+"!":this.id}}const K=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],Y=22,X=new Array(Y);var Z,ee=n(50762),te=n(35519),ne=n(59810),oe=n(6731);!function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(Z||(Z={}));var re=n(44319),se=n(96708),ie=n(47401),ae=n(92792),le=n.n(ae);class ce{static createHealthCheckRequest(e){return{payload:{},payloadSchema:{category:Z.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:Z.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:e}}static isFeatureEnabled(e,t,n=!1,o="None"){return e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,o).catch((()=>Promise.resolve(n))):Promise.resolve(n)}static isChangeGateEnabled(e,t){return e&&e.isChangeGateEnabled?e.isChangeGateEnabled(t):Promise.resolve(!1)}static convertWebSocketUrlToHttp(e){return this.convertUrl(e,!1)}static convertServiceUrlToWebSocket(e){return this.convertUrl(e,!0)}static convertUrl(e,t){if(!e)return e;const n=e.split(":");let o=n[0].toLowerCase();return 0==o.indexOf(t?"http":"ws")?(o=t?o.replace("http","ws"):o.replace("ws","http"),n[0]=o,n.join(":")):e}static deepEquals(e,t){return le()(e,t)}static collectTelemetry(e,t,n,o,r,s){var i,a,l,c;e.start(),e.resultSignature=null!=o?o:"",e.resultDescription=null!=r?r:"",e.success=n,s?(e.dimension0=null!==(i=s[0])&&void 0!==i?i:"",e.dimension1=null!==(a=s[1])&&void 0!==a?a:"",e.dimension2=null!==(l=s[2])&&void 0!==l?l:"",e.dimension3=null!==(c=s[3])&&void 0!==c?c:""):(e.dimension0="",e.dimension1="",e.dimension2="",e.dimension3=""),t.log((()=>b.tG.info(508367457,b.nh.CoreDefault,e.stop())))}}ce.getCurrentTimeMs=()=>Date.now?Date.now():(new Date).getTime();class ue{constructor(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}log(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){const e=new L.I({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:`Limit for number of logs for id: ${this.id} reached - all next logs will be dropped`});b.tG.warn(572838107,b.nh.CoreDefault,e)}}}const de=[r.h.getTypeName(),re.YH.getTypeName(),se.HN.getTypeName()],he=e=>{const t=new Set;for(const n of e)if("string"==typeof n)-1===de.indexOf(n)&&t.add(n);else for(const e of[n.getTypeName(),...n.getBaseTypes()])-1===de.indexOf(e)&&t.add(e);return Array.from(t)},pe=(e,t=0)=>Number.isFinite(e)?e:t;var fe,ge,me=n(60221),ye=n.n(me);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue",e.DroppedBecauseClientDisconnected="Message is dropped because client is disconnected from server"}(fe||(fe={}));class ve{constructor(e){this.logOp=new L.I({operationName:"MessageQueue",success:!0}),this.queue=new(ye())(1e3),this.callbacks=e}clear(){this.queue.clear()}size(){return this.queue.length}push(e,t,n){this.logOp.start();const o=this.queue;if(1e3===o.length){this.logOp.resourceId="QueueFull",this.logOp.success=!1,b.tG.warn(508843746,b.nh.CoreDefault,this.logOp.stop());const e=o.shift();e.onResponse&&e.onResponse(new te._p({error:fe.DroppedAsOldestInQueue}))}o.push({message:e,onResponse:t,timeQueued:ce.getCurrentTimeMs(),attemptNumber:n})}sendOnSessionInitialized(e){this.logOp.start();const t=this.queue.length;let n=0;if(t>0){const o=ce.getCurrentTimeMs()-this.queue.get(0).timeQueued;for(;this.queue.length>0&&this.callbacks.canSendMessage();){const t=this.queue.shift();e&&this.containSequencedSyncMessage(t)?(n++,t.onResponse&&t.onResponse(new te._p({error:fe.ArrivedBeforeReseeding}))):t.message instanceof Uint8Array?this.callbacks.sendBytes(t.message):this.callbacks.sendMessage(t.message,t.onResponse,t.attemptNumber)}this.logOp.resourceId="SendOnSessionInitialized",this.logOp.resultDescription=`Queue size before: ${t}, after: ${this.queue.length}. droppedSyncMessages: ${n}`,this.logOp.setDataField("OldestMessageInQueueTimeWaitingMs",o),this.logOp.success=!0,b.tG.warn(508843745,b.nh.CoreDefault,this.logOp.stop())}}containSequencedSyncMessage(e){return e.message instanceof te.Tb&&r.h.matchesTypesFor(e.message,[te.Tb.getTypeName()])&&e.message.seq>=0||e.message instanceof te.l0&&r.h.matchesTypesFor(e.message,[te.l0.getTypeName()])}}!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(ge||(ge={}));const be=(e,t,n,o)=>{t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,((t,o)=>{t||r.h.getTypeNameFor(o)!==te.fZ.getTypeName()||(e.stats.lastSyncMessage=Date.now()),n&&n(t,o)}),void 0,o))},Se=(e,t,n,o)=>{t&&(e.messageQueue.push(t,n,o),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{const t=new L.I({operationName:"WorkerManagerInit",success:!1,resultDescription:`${e}`});b.tG.error(508843789,b.nh.CoreDefault,t)})))},we=(e,t)=>{t&&(e.messageQueue.push(t),e.networkWorkerManager.init(void 0,e.customInitPromise).catch((e=>{b.tG.error(508843788,b.nh.CoreDefault,`Init failed: ${e}`)})))};class Te{constructor(e){this.context=e}onEnter(e){}sendMessage(e,t,n,o){}sendBytes(e){}canSendMessage(){return!1}onConnectionClose(){}}class _e extends Te{constructor(){super(...arguments),this.stateName=ge.Initing,this.possibleNextStates=[ge.Running,ge.Disconnected,ge.Closed]}sendMessage(e,t,n){r.h.matchesTypesFor(e,[te.eE.getTypeName()])?be(this.context,e,t,n):Se(this.context,e,t)}sendBytes(e){we(this.context,e)}onConnectionClose(){this.context.setState(ge.Disconnected)}}class Ce extends Te{constructor(){super(...arguments),this.stateName=ge.Running,this.possibleNextStates=[ge.Disconnected,ge.Closed]}onEnter(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)}sendMessage(e,t,n,o){be(this.context,e,t,n)}sendBytes(e){e&&this.context.networkWorkerManager.egressBytes(e)}canSendMessage(){return!0}onConnectionClose(){this.context.setState(ge.Disconnected)}}class ke extends Te{constructor(){super(...arguments),this.stateName=ge.Disconnected,this.possibleNextStates=[ge.Initing,ge.Closed]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(ee.Ef.ClientDisconnected)}sendMessage(e,t,n,o){if(r.h.matchesTypesFor(e,[te.eE.getTypeName()]))this.context.setState(ge.Initing),be(this.context,e,t,n);else if(r.h.matchesTypesFor(e,[te.w9.getTypeName()]))this.context.setState(ge.Closed);else{if(!o)return void Se(this.context,e,t,n);t&&t(new te._p({messageId:e.messageId,error:fe.DroppedBecauseClientDisconnected}))}}sendBytes(e){we(this.context,e)}}class Ee extends Te{constructor(){super(...arguments),this.stateName=ge.Closed,this.possibleNextStates=[]}onEnter(e){this.context.messageEndpoint.cancelPendingResponseCallbacks(ee.Ef.ClientClosed)}}const{AugLoopTextEncoder:Ae,AugLoopTextDecoder:Ie}=(()=>{if("undefined"==typeof TextEncoder||"undefined"==typeof TextDecoder){n(20731);const e={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,e}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}})();var Pe=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class Me{static extractFragments(e){if(e[0]!==Me.IDENTIFIERBYTE)throw new Error("Invalid Binary: Incorrect Identifier");let t=1;const n=[],o=new DataView(e.buffer,e.byteOffset,e.byteLength);for(;t<e.byteLength;){if(t+4>e.byteLength)throw new Error("Invalid Binary: Error reading fragment length");const r=o.getUint32(t);if(t+r+4>e.byteLength)throw new Error("Invalid Binary: Fragment out of range");"undefined"!=typeof Buffer&&Buffer.from?n.push(Buffer.from(e.buffer,e.byteOffset+t+4,r)):n.push(new Uint8Array(e.buffer,e.byteOffset+t+4,r)),t+=4+r}if(n.length<1)throw new Error("Invalid Binary: No fragments found");return n}static deserialize(e,t=e=>e){const n=Me.extractFragments(e),o=Me.textDecoder.decode(n[0]);return JSON.parse(o,((e,o)=>{if("string"==typeof o){if(o.substring(0,Me.BINARYKEYWORD.length)===Me.BINARYKEYWORD){const e=parseInt(o.substring(Me.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=n.length-1)throw new Error("Invalid Binary: Binary index out of range");return t(n[e+1])}if(o.substring(0,Me.ESCAPEKEYWORD.length)===Me.ESCAPEKEYWORD)return o.substring(Me.ESCAPEKEYWORD.length)}return o}))}static deserializeAsync(e,t=e=>Pe(this,void 0,void 0,(function*(){return e}))){return Pe(this,void 0,void 0,(function*(){const n=Me.extractFragments(e),o=Me.textDecoder.decode(n[0]),r=[],s=Symbol("placeholder"),i=e=>{if(Array.isArray(e)){for(let t=0;t<e.length;t++)e[t]=i(e[t]);return e}if(null!==e&&"object"==typeof e){if(e[s])return e.value;for(const t of Object.keys(e))e[t]=i(e[t]);return e}return e};let a=JSON.parse(o,((e,o)=>{if("string"==typeof o){if(o.startsWith(Me.BINARYKEYWORD)){const e=parseInt(o.substring(Me.BINARYKEYWORD.length),10);if("number"!=typeof e||e>=n.length-1)throw new Error("Invalid Binary: Binary index out of range");const i=t(n[e+1]);return r.push(i),(e=>{const t={[s]:!0,value:void 0};return e.then((e=>{t.value=e})),t})(i)}if(o.startsWith(Me.ESCAPEKEYWORD))return o.substring(Me.ESCAPEKEYWORD.length)}return o}));return yield Promise.all(r),a=yield i(a),a}))}static serializeInternal(e){const t=[void 0],n=JSON.stringify(e,((e,n)=>ArrayBuffer.isView(n)?(t.push(n),`${Me.BINARYKEYWORD}${t.length-2}`):n&&"Buffer"===n.type&&Array.isArray(n.data)?(t.push(new Uint8Array(n.data)),`${Me.BINARYKEYWORD}${t.length-2}`):"string"==typeof n&&n.substring(0,Me.ESCAPEKEYWORD.length)===Me.ESCAPEKEYWORD?Me.ESCAPEKEYWORD+n:n));t[0]=Me.textEncoder.encode(n);const o=t.reduce(((e,t)=>e+4+t.byteLength),0),r=new Uint8Array(o+1);r[0]=Me.IDENTIFIERBYTE;let s=1;const i=new DataView(r.buffer,r.byteOffset,r.byteLength);for(const e of t)i.setUint32(s,e.byteLength),r.set(e,s+4),s+=4+e.byteLength;return r}static serialize(e){return Me.serializeInternal(e)}static serializeAsync(e){return Pe(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{try{t(Me.serializeInternal(e))}catch(e){n(e)}}))}))}}Me.IDENTIFIERBYTE=3,Me.BINARYKEYWORD=":b",Me.ESCAPEKEYWORD=":",Me.textDecoder=new Ie,Me.textEncoder=new Ae;var xe=n(65618);const Re="Request timed out";function De(e,t,n){const o=new xe.Request(e,t);return Oe.add(o,n)}const Oe=new class{constructor(e,t,n){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=n}tryProcessNextRequest(){if(this.requestInProgress=!1,this.queuedRequests.length>0){const[e,t,n]=this.queuedRequests.shift();clearTimeout(n),this.add(e,t)}}add(e,t){if(this.requestInProgress){const n=setTimeout((()=>{t(new Error("Timed out waiting in queue"),null),this.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,n])}else this.requestInProgress=!0,new Promise(((t,n)=>{let o=!1;const r=setTimeout((()=>{o=!0,n(new Error("Fetch timed out"))}),this.fetchTimeout);this.fetch(e).then((e=>{o||(clearTimeout(r),t(e))})).catch((e=>{o||(clearTimeout(r),n(e))}))})).then((e=>{t(null,e),this.tryProcessNextRequest()})).catch((e=>{t(e,null),this.tryProcessNextRequest()}))}}(xe.fetch,2e4,12e4);class Ne{constructor(e){r.h.assign(Ne,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Ne.getTypeName()])}}Ne.H_={T_:Ne.getTypeName(),B_:Ne.getBaseTypes()};class Le{constructor(e){r.h.assign(Le,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Le.getTypeName()])}}Le.H_={T_:Le.getTypeName(),B_:Le.getBaseTypes()};class Fe{constructor(e){r.h.assign(Fe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowCancellationRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Fe.getTypeName()])}}Fe.H_={T_:Fe.getTypeName(),B_:Fe.getBaseTypes()};class Be{constructor(e){r.h.assign(Be,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Be.getTypeName()])}}Be.H_={T_:Be.getTypeName(),B_:Be.getBaseTypes()};class We{constructor(e){r.h.assign(We,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[We.getTypeName()])}}We.H_={T_:We.getTypeName(),B_:We.getBaseTypes()};class Ue{constructor(e){r.h.assign(Ue,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Ue.getTypeName()])}}Ue.H_={T_:Ue.getTypeName(),B_:Ue.getBaseTypes()};class Ge{constructor(e){r.h.assign(Ge,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Ge.getTypeName()])}}Ge.H_={T_:Ge.getTypeName(),B_:Ge.getBaseTypes()};class He{constructor(e){r.h.assign(He,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[He.getTypeName()])}}He.H_={T_:He.getTypeName(),B_:He.getBaseTypes()};class qe{constructor(e){r.h.assign(qe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return r.h.matchesTypesFor(e,[qe.getTypeName()])}}qe.H_={T_:qe.getTypeName(),B_:qe.getBaseTypes()};class $e{constructor(e){r.h.assign($e,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[$e.getTypeName()])}}$e.H_={T_:$e.getTypeName(),B_:$e.getBaseTypes()};class Ve{constructor(e){r.h.assign(Ve,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingRequest","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Ve.getTypeName()])}}Ve.H_={T_:Ve.getTypeName(),B_:Ve.getBaseTypes()};class je{constructor(e){r.h.assign(je,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Internal_GetAnnotationsResponseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_StreamingResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return r.h.matchesTypesFor(e,[je.getTypeName()])}}je.H_={T_:je.getTypeName(),B_:je.getBaseTypes()};const ze=3e4;class Qe{constructor(e,t,n,o){this.lastPingTime=0,this.lastPongTime=0,this.lastEgressTime=0,this.remainingPingFailures=3,this.isPingPongSuccessful=!1,this.reducedPingPongRetryEnabled=o,this.pingPongLogOp=new L.I({operationName:"WebSocketReliabilityManager",success:!0,resourceId:this.reducedPingPongRetryEnabled?"reducedPingPongRetryEnabled":""}).start(),this.pingPongLogOp.setClientMetadata(n,!0),this.worker=e,this.rateControllerClose=t}start(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.resultSignature="initial ping"):this.logOperation(!0,"ping","initial ping"),this.ping(),this.isPingPongSuccessful=!0,this.startInterval()}onResponse(){this.lastPongTime=Date.now(),this.reducedPingPongRetryEnabled&&(this.pingPongLogOp.success=!0,b.tG.info(506795283,b.nh.CoreDefault,this.pingPongLogOp.stop()))}isReliabilityResponse(e){return"string"==typeof e&&1===e.length&&e===Qe.pingPongMessage}close(){this.reducedPingPongRetryEnabled?(this.pingPongLogOp.start(),this.pingPongLogOp.success=!0,this.pingPongLogOp.resultSignature="close",b.tG.info(506795282,b.nh.CoreDefault,this.pingPongLogOp.stop())):this.logOperation(!0,"ping","close"),this.lastPingTime=0,this.lastPongTime=0,this.isPingPongSuccessful=!1,this.clearPingInterval(),this.worker=void 0}checkConnection(){return this.isPingPongSuccessful}postEgress(){this.lastEgressTime=Date.now()}needsParsedResponses(){return!1}ping(){this.reducedPingPongRetryEnabled?this.worker||(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="websocket worker undefined",this.rateControllerClose(),b.tG.info(506795281,b.nh.CoreDefault,this.pingPongLogOp.stop())):this.lastPingTime=Date.now(),this.worker&&(this.reducedPingPongRetryEnabled&&(this.lastPingTime=Date.now()),this.worker.egress({obj:Qe.pingPongMessage}))}startInterval(){this.pingInterval=setInterval((()=>{if(this.reducedPingPongRetryEnabled){if(this.lastPongTime<this.lastPingTime&&Date.now()-this.lastPingTime<ze)return;this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime,this.pingPongLogOp.start(),this.isPingPongSuccessful?(this.pingPongLogOp.resultSignature="ping",this.ping()):(this.pingPongLogOp.success=!1,this.pingPongLogOp.resultDescription="Pong not received",b.tG.info(506795280,b.nh.CoreDefault,this.pingPongLogOp.stop()),this.worker?this.worker.close():this.rateControllerClose())}else{if(this.isPingPongSuccessful=this.lastPongTime>=this.lastPingTime&&this.lastPongTime-this.lastPingTime<=ze,this.lastPongTime>this.lastEgressTime)return;const e=this.lastPongTime-this.lastPingTime;this.isPingPongSuccessful?(this.remainingPingFailures=3,this.ping()):this.remainingPingFailures>0?(--this.remainingPingFailures,this.ping()):(this.logOperation(!1,"ping","Pong still not received after all retry attempts",[`${e}`,`${this.remainingPingFailures}`]),this.worker?this.worker.close():this.rateControllerClose())}}),ze)}clearPingInterval(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0)}logOperation(e,t,n,o){var r,s,i,a;this.pingPongLogOp.start(),this.pingPongLogOp.success=e,this.pingPongLogOp.resultSignature=t,this.pingPongLogOp.resultDescription=n,o&&(this.pingPongLogOp.dimension0=null!==(r=o[0])&&void 0!==r?r:"",this.pingPongLogOp.dimension1=null!==(s=o[1])&&void 0!==s?s:"",this.pingPongLogOp.dimension2=null!==(i=o[2])&&void 0!==i?i:"",this.pingPongLogOp.dimension3=null!==(a=o[3])&&void 0!==a?a:""),b.tG.info(507320073,b.nh.CoreDefault,this.pingPongLogOp.stop())}}Qe.pingPongMessage="~";const Je="Request timed out";class Ke{constructor(e,t,n){this.remainingRetryAttempts=4,this.isAsleep=!1,this.isLongPollSuccessful=!1,this.isActiveLongPoll=!1,this.isResponseReceived=!1,this.lastEgressTime=0,this.longPollLogOp=new L.I({operationName:"OnLongPollMessage",success:!0}),this.clientMetadata=t,this.sessionCorrelationVector=n,this.longPollLogOp.setClientMetadata(this.clientMetadata,!0),this.worker=e}start(){const e=new L.I({operationName:"StartHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),b.tG.info(508163399,b.nh.CoreDefault,e.stop()),this.trySendLongPoll(ne.PO.Start,!0),this.isLongPollSuccessful=!0}onResponse(e){if(!e||this.isResponseReceived){const e=new L.I({operationName:"HttpReliabilityManagerFailure",success:!1}).start();return e.setClientMetadata(this.clientMetadata,!0),void b.tG.info(508162497,b.nh.CoreDefault,e.stop())}this.isResponseReceived=!0,this.isActiveLongPoll=!1;const t=e;if(t.error)if(this.isLongPollSuccessful=!1,--this.remainingRetryAttempts,this.remainingRetryAttempts>0){this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription=`Retry attempts left : ${this.remainingRetryAttempts}`,this.longPollLogOp.resultSignature=t.error,b.tG.info(508163398,b.nh.CoreDefault,this.longPollLogOp.stop());const e=t.error===Je?ne.PO.TimeoutResend:ne.PO.FailResend;t.error===Je||3===this.remainingRetryAttempts?this.trySendLongPoll(e,!0):this.enqueueSendLongPoll(e)}else this.longPollLogOp.success=!1,this.longPollLogOp.resultDescription="Long poll still not received after all retry attempts",b.tG.info(508163397,b.nh.CoreDefault,this.longPollLogOp.stop()),this.worker&&this.worker.close();else this.longPollLogOp.success=!0,this.longPollLogOp.resultDescription="Long poll received",b.tG.info(508163401,b.nh.CoreDefault,this.longPollLogOp.stop()),this.remainingRetryAttempts=4,this.isLongPollSuccessful=!0,this.trySendLongPoll(ne.PO.Regular)}close(){const e=new L.I({operationName:"CloseHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),b.tG.info(508162467,b.nh.CoreDefault,e.stop()),this.sendLongPollTimer&&(clearTimeout(this.sendLongPollTimer),this.sendLongPollTimer=void 0),this.isActiveLongPoll=!1,this.isLongPollSuccessful=!1,this.worker=void 0}checkConnection(){if(this.isAsleep){this.isAsleep=!1;const e=new L.I({operationName:"AwakenHttpReliabilityManager",success:!0}).start();e.setClientMetadata(this.clientMetadata,!0),b.tG.info(508162496,b.nh.CoreDefault,e.stop()),this.trySendLongPoll(ne.PO.CheckConnection,!0)}return this.isLongPollSuccessful}isReliabilityResponse(e){return"string"!=typeof e&&te.ry.typeGuard(e)}postEgress(){this.lastEgressTime=Date.now(),this.trySendLongPoll(ne.PO.PostEgress)}needsParsedResponses(){return!0}enqueueSendLongPoll(e){this.sendLongPollTimer=setTimeout((()=>{this.trySendLongPoll(e,!0)}),2e4)}trySendLongPoll(e,t){if(!this.worker){const e=new L.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Worker is undefined",void b.tG.info(507281438,b.nh.CoreDefault,e.stop())}if(!0===this.isActiveLongPoll){const e=new L.I({operationName:"LongPollNoOp",success:!0}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Already active long poll",void b.tG.info(508163396,b.nh.CoreDefault,e.stop())}if(this.isActiveLongPoll=!0,Date.now()-this.lastEgressTime>6e4&&!t){this.isActiveLongPoll=!1,this.isAsleep=!0;const e=new L.I({operationName:"LongPollSleep",success:!0}).start();return e.setClientMetadata(this.clientMetadata),e.resultDescription=`isAsleep: ${this.isAsleep}, isActiveLongPoll: ${this.isActiveLongPoll}`,void b.tG.info(507278739,b.nh.CoreDefault,e.stop())}this.longPollLogOp.start(),this.isResponseReceived=!1,this.worker.egress({obj:this.getLongPollMessageString(e),isHttpSessionLongPollMessage:!0,isHttpSessionInitMessage:!1})}getLongPollMessageString(e){const t=new te.LQ({longPollTimeoutHint:15e3,type:e});return this.sessionCorrelationVector&&(t.cv=this.sessionCorrelationVector().newChild().toString()),JSON.stringify(t)}}const Ye=JSON.stringify(new te.ry({error:Re}));class Xe{constructor(e){this.networkOverrideOptions=e,this.isClosed=!1,this.pendingEgress=[]}init(e,t,n,o){const r=new L.I({operationName:"HttpWorkerInit",success:!0}).start(),s=e.split("/?x-origin=");2===s.length?(this.url=ce.convertWebSocketUrlToHttp(s[0]),this.origin=s[1]):(this.url=ce.convertWebSocketUrlToHttp(e),this.origin=void 0),this.ingress=t,this.onOpen=n,this.onClose=o,b.tG.info(507839180,b.nh.CoreDefault,r.stop())}egress(e){const t=new L.I({operationName:"HttpEgress",success:!0}).start();if(!this.isConnectedToSession()&&!e.isHttpSessionInitMessage)return this.pendingEgress.push(e),t.success=!1,t.resultDescription="NotConnected, pendingQueueSize:  "+this.pendingEgress.length.toString(),void b.tG.info(508163394,b.nh.CoreDefault,t.stop());const n=this.getRequestInfo(e,t);if(!n.url)return t.success=!1,t.resultDescription="Could not generate HTTP request",void b.tG.error(508163393,b.nh.CoreDefault,t.stop());e.isHttpSessionLongPollMessage?this.egressLongPoll(n,t):De(n.url,n.request,((e,n)=>{e?this.onEgressError(t,"OnEgressError:"+(null==e?void 0:e.message)):n&&n.ok?n.text().then((e=>{t.success=!0,b.tG.info(508163362,b.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"OnEgressParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"OnEgressResponseError: "+(null==e?void 0:e.message)+`, Status ${null==n?void 0:n.status}: ${null==n?void 0:n.statusText}`)}))}close(){const e=new L.I({operationName:"HttpWorkerClose",success:!0}).start();if(this.isClosed)return e.resultDescription="AlreadyClosed",void b.tG.info(508163360,b.nh.CoreDefault,e.stop());b.tG.info(508163359,b.nh.CoreDefault,e.stop()),this.isClosed=!0,this.sessionSettings=void 0,this.onClose&&(this.onClose(void 0),this.onClose=void 0)}onEgressError(e,t){e.success=!1,e.resultDescription=t,b.tG.error(508163358,b.nh.CoreDefault,e.stop()),this.isClosed||this.close()}ingressInternal(e,t){let n=e;t||(n=this.formatServerInput(e));n&&(this.logIngressCount(n),this.ingress(n,(e=>{te.uN.typeGuard(e)&&this.onSessionInitResponse(e)})))}onSessionInitResponse(e){const t=new L.I({operationName:"HttpWorkerOpen",success:!0}).start();if(!(e.sessionKey&&e.origin&&e.anonymousToken&&e.sessionUrlBase))return t.success=!1,t.resultDescription="SessionInitResponse missing information",void b.tG.error(507809949,b.nh.CoreDefault,t.stop());b.tG.info(508163357,b.nh.CoreDefault,t.stop()),this.setSessionSettings(e.sessionKey,e.origin,e.anonymousToken,e.sessionUrlBase),this.onOpen(),this.pendingEgress.forEach((e=>{this.egress(e)})),this.pendingEgress=[]}egressLongPoll(e,t){var n,o;(n=e.url,o=e.request,new Promise(((e,t)=>{const r=setTimeout((()=>{t(new Error(Re))}),2e4);(0,xe.fetch)(n,o||{}).then((t=>{clearTimeout(r),e(t)})).catch((e=>{clearTimeout(r),t(e)}))}))).then((e=>{e&&e.ok?e.text().then((e=>{t.success=!0,t.resourceId="LongPoll",b.tG.info(508163355,b.nh.CoreDefault,t.stop()),this.ingressInternal(e)})).catch((e=>{this.onEgressError(t,"LongPollFetchParseError: "+(null==e?void 0:e.message))})):this.onEgressError(t,"LongPollFetchStatusFailure: "+(null==e?void 0:e.statusText))})).catch((e=>{e.message===Re?(t.success=!1,t.resultDescription="LongPollFetchResponseTimeout:"+(null==e?void 0:e.message),b.tG.error(508163353,b.nh.CoreDefault,t.stop()),this.ingressInternal(Ye,!0)):this.onEgressError(t,"LongPollFetchResponseError: "+(null==e?void 0:e.message))}))}getRequestInfo(e,t){const n=this.getUrl(null==e?void 0:e.isHttpSessionInitMessage),o=this.getHeader(e,t);return t.resultSignature=n,{url:n,request:{method:"POST",headers:o,body:e.obj}}}getUrl(e){const t=this.sessionSettings&&this.sessionSettings.sliceUrl?this.sessionSettings.sliceUrl:this.url;return e?t+"/sessioninit":this.isConnectedToSession()?t+"/session/"+this.sessionSettings.sessionKey:""}getHeader(e,t){var n;const o=new xe.Headers;return(null==e?void 0:e.isHttpSessionInitMessage)?(o.set("Content-Type","application/json"),this.origin&&o.set("x-origin",this.origin)):this.isConnectedToSession()&&(e.obj instanceof Uint8Array||e.obj instanceof ArrayBuffer?(o.set("Content-Type","application/jsond2"),t.dimension0=e.obj.byteLength.toString().length.toString()):o.set("Content-Type","application/json"),o.append("Authorization",`Bearer ${this.sessionSettings.anonymousToken}`),o.set("x-origin",this.sessionSettings.origin)),(null===(n=this.networkOverrideOptions)||void 0===n?void 0:n.hostHeader)&&o.set("host",this.networkOverrideOptions.hostHeader),o}setSessionSettings(e,t,n,o){const r=o.replace("/session","");this.sessionSettings={sessionKey:e,origin:t,anonymousToken:n,sliceUrl:r}}isConnectedToSession(){return this.sessionSettings&&this.sessionSettings.sessionKey.length>0&&this.sessionSettings.anonymousToken.length>0&&this.sessionSettings.origin.length>0&&this.sessionSettings.sliceUrl.length>0&&!this.isClosed}formatServerInput(e){return e.length>1?e.substring(1,e.length-1):""}logIngressCount(e){const t=e.length;if(t>1e5){const e=new L.I({operationName:"HttpIngressByteOrderOfMagnitude",success:!0}).start();e.dimension2=t.toString().length.toString(),b.tG.info(508409622,b.nh.CoreDefault,e.stop())}}}const Ze=e=>{var t,n;if(te.B_.typeGuard(e)){const n=e.ops.filter((e=>r.h.matchesTypesFor(e,["AugLoop_Core_AddOperation"])));for(const e of n)for(const n of e.items)if(n.body&&(null===(t=n.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse))return!0}else if(je.typeGuard(e))return null===(n=e.content)||void 0===n?void 0:n.some((e=>{var t;return null===(t=e.body)||void 0===t?void 0:t.isFirstUserPerceivedResponse}));return!1},et=(e,t,n,o,s)=>{const i=(e=>{const t=e.filter((e=>r.h.matchesTypesFor(e,["AugLoop_Signals_SignalOperation"])));for(const e of t)for(const t of e.items)if(t.body&&r.h.matchesTypesFor(t.body,["AugLoop_CopilotChatHistory_CopilotChatHistorySignal","AugLoop_Copilot_CopilotInputSignal"]))return t})(e);i&&(s.setDataField("CurrentTimestamp",n),s.cv=t||"",s.resultSignature=o,s.resourceId=r.h.getTypeNameFor(i.body),i.contextId&&s.setDataField("ContextId",i.contextId),i.sourceTimestamp&&s.setDataField("SourceTimestamp",i.sourceTimestamp),b.tG.info(505983429,b.nh.CoreDefault,s.stop()))},tt=(e,t,n,o,r)=>{o&&!Ze(e)||(r.setDataField("CurrentTimestamp",t),r.cv=e.cv,r.resultSignature=n,r.resourceId=e.annotationType,r.dimension1=`AreApologies: ${e.areApologies}`,b.tG.info(505983428,b.nh.CoreDefault,r.stop()))};var nt=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};const ot=1e5;class rt{constructor(e){var t;this.emptyMessageId=0,this.egressMessageCount=0,this.egressByteCount=0,this.prevSeq=-1,this.rpsThreshold=150,this.bpsThreshold=5e8,this.isClosing=!1,this.messageQueue=void 0,this.egressRateLogOp=new L.I({operationName:"NetworkEgressRate",success:!0}),this.egressedCache=new Map,this.initPromise=new Promise((e=>{this.resolveInitPromise=e})),this.messageQueue=new(ye()),this.reducedPingPongRetryEnabled=null!==(t=null==e?void 0:e.reducedPingPongRetryEnabled)&&void 0!==t&&t}init(e,t,n,o,r){this.worker=e,this.ingress=t,this.clientMetadata=o,this.networkMode=n,this.reliabilityManager=((e,t,n,o,r)=>e instanceof Xe?new Ke(e,n,o):new Qe(e,t,n,r))(this.worker,this.close.bind(this),void 0,r,this.reducedPingPongRetryEnabled),this.egressRateLogOp.setClientMetadata(this.clientMetadata,!0),this.resetRateLimiter(),this.onCloseController=new Promise((e=>{this.resolveCloseControllerPromise=e})),this.queueProcessingCompletePromise=new Promise((e=>{this.resolveQueueProcessingCompletePromise=e})),this.resolveInitPromise()}open(){const e=new L.I({operationName:"NetworkRateControllerOpen",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),this.initPromise.then((()=>{if(!this.reliabilityManager)return e.success=!1,void(e.resultDescription="Reliability Manager is undefined");this.egressRateControlIntervalStart=Date.now(),this.reliabilityManager.start(),this.processQueue()})).catch((t=>{var n;e.success=!1,e.resultDescription="Catch: "+(null!==(n=null==t?void 0:t.message)&&void 0!==n?n:"")})).finally((()=>{b.tG.info(507834384,b.nh.CoreDefault,e.stop())}))}ingressFromWorker(e,t){this.reliabilityManager?this.reliabilityManager.needsParsedResponses()||!this.reliabilityManager.isReliabilityResponse(e)?this.ingress(e,(e=>{null==t||t(e),this.reliabilityManager.needsParsedResponses()&&this.reliabilityManager.isReliabilityResponse(e)&&this.reliabilityManager.onResponse(e)})):this.reliabilityManager.onResponse():this.ingress(e,t)}onRateLimitErrorResponse(e){const t=new L.I({operationName:"NetworkRateControllerOnRateLimitResponse",success:!0}).start();t.setClientMetadata(this.clientMetadata,!0),t.resultSignature=`rateLimitAlreadyStarted: ${void 0!==this.rateLimitTimeout}`,t.setDataField("RetryAfterMs",e.retryAfterMs),t.setDataField("QueueSize",this.messageQueue.length),this.startRateLimiting(e.retryAfterMs),b.tG.info(507388684,b.nh.CoreDefault,t.stop())}setRpsBps(e,t){const n=new L.I({operationName:"NetworkRateControllerRateLimitsSet",success:!0}).start();n.setClientMetadata(this.clientMetadata,!0),e&&(this.rpsThreshold=.8*e,n.resultDescription+=`maxRPS: ${e}, rpsThreshold: ${this.rpsThreshold}; `),t&&(this.bpsThreshold=.8*t,n.resultDescription+=`maxRPS: ${t}, rpsThreshold: ${this.bpsThreshold}; `),b.tG.info(507388683,b.nh.CoreDefault,n.stop())}close(){var e,t;return nt(this,void 0,void 0,(function*(){const n=new L.I({operationName:"NetworkRateControllerClose",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();n.setClientMetadata(this.clientMetadata,!0),this.isClosing=!0,null===(e=this.resolveCloseControllerPromise)||void 0===e||e.call(this);const o=null===(t=this.reliabilityManager)||void 0===t?void 0:t.checkConnection();n.setDataField("QueueSizeBeforeFlush",this.messageQueue.length),0!=this.messageQueue.length&&o&&(yield this.queueProcessingCompletePromise),n.setDataField("QueueSizeAfterFlush",this.messageQueue.length),n.setDataField("IsConnected",o),this.reliabilityManager?this.reliabilityManager.close():n.resultDescription="Reliability Manager is undefined",this.worker=void 0,this.prevSeq=-1,this.clearEgressControlTimeout(),this.reliabilityManager=void 0,b.tG.info(507834381,b.nh.CoreDefault,n.stop())}))}clearMessageQueues(){this.egressedCache.clear(),this.messageQueue=void 0}egress(e,t=0){var n,o;if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","");const r=this.getMessageSize(e);if(r>=3e6)return void this.logEgressActivity(!1,"Message size exceeded 3000000",`Message size: ${r}`);if((e.obj instanceof ArrayBuffer||e.isHttpSessionInitMessage)&&this.worker)return this.logEgressActivity(!0,`isArrayBuffer: ${e.obj instanceof ArrayBuffer}, isHttpSessionInitMessage: ${e.isHttpSessionInitMessage}`,""),void this.worker.egress(e);this.validateSyncMessage(e.messageId,e.seqId);const s=null!==(n=e.messageId)&&void 0!==n?n:"id"+this.emptyMessageId++,i={obj:e.obj,seqId:null==e?void 0:e.seqId,messageId:s,isHttpSessionInitMessage:null==e?void 0:e.isHttpSessionInitMessage},a=t>0,l=new L.I({operationName:"NetworkRateControllerQueueItem",success:!0,dimension3:`isRetry: ${a}`}).start();l.setClientMetadata(this.clientMetadata,!0);const c={message:i,logOp:l};if(a?this.messageQueue.unshift(c):this.messageQueue.push(c),this.messageQueue.length>1e4){const e=this.messageQueue.shift(),t=`NetworkRateControllerQueue max size reached. Dropping messageId: ${e.message.messageId}`;throw e.logOp.resultDescription=t,e.logOp.success=!1,b.tG.info(506001225,b.nh.CoreDefault,e.logOp.stop()),new Error(t)}null===(o=this.resolveQueueNotEmptyPromise)||void 0===o||o.call(this)}getMessageSize(e){return e.obj instanceof ArrayBuffer?e.obj.byteLength:e.obj.length}sendToNetworkWorker(e){var t;try{if(!this.worker)return void this.logEgressActivity(!1,"NetworkWorker is undefined","SendToNetworkWorkerFailure");if(!this.reliabilityManager)return void this.logEgressActivity(!1,"Reliability Manager is undefined","SendToNetworkWorkerFailure");this.worker.egress(e),this.onSendToNetworkWorker(e),null===(t=this.reliabilityManager)||void 0===t||t.postEgress();const n=this.getMessageSize(e);this.logEgressCount(n)}catch(e){this.logEgressActivity(!1,"SendToNetworkWorkerFailure",e?e.message:"")}}onSendToNetworkWorker(e){if("string"==typeof e.obj)try{const a=JSON.parse(e.obj);te.Tb.typeGuard(a)?((e,t,n,o)=>{et(e.ops,e.cv,t,"SendToNetwork",o)})(a,Date.now(),0,new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()):Ve.typeGuard(a)&&(t=a,(n=new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()).resultSignature="GetAnnotationsSendToNetwork",n.resourceId=`${null===(o=t.sourceInfo)||void 0===o?void 0:o.featureId}-${null===(r=t.sourceInfo)||void 0===r?void 0:r.entryPoint}`,n.cv=t.cv,n.setDataFields({AnnotationTypes:null===(s=t.annotationTypes)||void 0===s?void 0:s.toString(),MaxDelayMs:null===(i=t.maxDelayMs)||void 0===i?void 0:i.toString()}),b.tG.info(505455200,b.nh.CoreDefault,n.stop()))}catch(e){}var t,n,o,r,s,i}processQueue(){var e,t,n;return nt(this,void 0,void 0,(function*(){if(!this.reliabilityManager){const e=new L.I({operationName:"NetworkRateControllerProcessQueueFailure",success:!1,dimension3:`networkMode: ${this.networkMode}`}).start();return e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Reliability Manager is undefined",void b.tG.info(507573643,b.nh.CoreDefault,e.stop())}const o=new L.I({operationName:"NetworkRateControllerProcessQueue",success:!0}).start();for(;;){if(0===this.messageQueue.length){if(this.isClosing){o.setDataField("ExitReason","Stage#1 Closing");break}yield Promise.race([this.queueNotEmpty(),this.onCloseController])}if(this.rateLimitTimeout){const e=new L.I({operationName:"NetworkRateControllerRateLimitBackoff",dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.setDataField("QueueLengthBeforeBackoff",this.messageQueue.length),yield Promise.race([this.rateLimitTimeout,this.onCloseController]),e.setDataField("QueueLengthAfterBackoff",this.messageQueue.length),e.setDataField("IsClosing",this.isClosing),e.success=!0,this.rateLimitTimeout=void 0,this.resetRateLimiter(),b.tG.info(507281410,b.nh.CoreDefault,e.stop())}if(!(null===(e=this.reliabilityManager)||void 0===e?void 0:e.checkConnection())){if(this.isClosing){o.setDataField("ExitReason","Stage#2 Closing");break}yield this.checkConnectionPromise(),this.connectionPromise=void 0}if(!this.reliabilityManager){o.setDataField("ExitReason","Stage#2 ReliabilityManager null");break}for(;this.messageQueue.length>0&&this.reliabilityManager.checkConnection();){if(Date.now()-this.egressRateControlIntervalStart>=1e3)this.resetRateLimiter();else if(this.egressMessageCount>=this.rpsThreshold||this.egressByteCount>=this.bpsThreshold){const e=1100;let t="";this.egressMessageCount>=this.rpsThreshold&&(t+="RPS exceeded."),this.egressByteCount>=this.bpsThreshold&&(t+="BPS exceeded.");const n="rateLimitHit",o=new L.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();o.setClientMetadata(this.clientMetadata,!0),o.success=!0,o.resultDescription=n,o.resultSignature=t,o.dimension0=this.messageQueue.length.toString().length.toString(),o.dimension1="rateLimitHit",o.setDataField("QueueLength",this.messageQueue.length),o.setDataField("RateLimitDelayMs",e),b.tG.info(507281409,b.nh.CoreDefault,o.stop()),this.startRateLimiting(e);break}const e=this.messageQueue.shift();this.sendToNetworkWorker(e.message),b.tG.info(507388682,b.nh.CoreDefault,e.logOp.stop())}this.onQueueNotEmpty=void 0,this.resolveQueueNotEmptyPromise=void 0}null===(t=this.resolveQueueProcessingCompletePromise)||void 0===t||t.call(this),this.resolveQueueProcessingCompletePromise=void 0,o.setClientMetadata(this.clientMetadata,!0),o.setDataField("QueueSize",this.messageQueue.length),o.setDataField("IsConnected",null===(n=this.reliabilityManager)||void 0===n?void 0:n.checkConnection()),o.setDataField("IsClosing",this.isClosing),b.tG.info(507368671,b.nh.CoreDefault,o.stop())}))}queueNotEmpty(){return this.onQueueNotEmpty||(this.onQueueNotEmpty=new Promise((e=>{this.resolveQueueNotEmptyPromise=e}))),this.onQueueNotEmpty}checkConnectionPromise(){return this.connectionPromise||(this.connectionPromise=new Promise((e=>{setTimeout(e,1e3)}))),this.connectionPromise}startRateLimiting(e){this.rateLimitTimeout||(this.rateLimitTimeout=new Promise((t=>{setTimeout(t,e)})))}resetRateLimiter(){this.egressRateControlIntervalStart=Date.now(),this.egressMessageCount=0,this.egressByteCount=0}clearEgressControlTimeout(){this.egressRateControlTimer&&(clearInterval(this.egressRateControlTimer),this.egressRateControlTimer=void 0)}validateSyncMessage(e,t){if(!(void 0===t||void 0===e||t<=this.prevSeq)){if(t&&t!==this.prevSeq+1){const e=new L.I({operationName:"NetworkRateControllerAbandonedSyncMessage",success:!0,dimension3:`networkMode: ${this.networkMode}`}).start();e.setClientMetadata(this.clientMetadata,!0),e.resultDescription="Gap in sync message",e.dimension0=`${this.prevSeq}`,e.dimension1=`${t}`,e.dimension2=""+(t-this.prevSeq),b.tG.info(507834370,b.nh.CoreDefault,e.stop())}this.prevSeq=t}}logEgressActivity(e,t,n,o){var r,s,i,a;const l=new L.I({operationName:"NetworkRateControllerEgress",dimension3:`networkMode: ${this.networkMode}`}).start();l.setClientMetadata(this.clientMetadata,!0),l.success=e,l.resultDescription=t,l.resultSignature=n,o&&(l.dimension0=null!==(r=o[0])&&void 0!==r?r:"",l.dimension1=null!==(s=o[1])&&void 0!==s?s:"",l.dimension2=null!==(i=o[2])&&void 0!==i?i:"",l.dimension3=null!==(a=o[3])&&void 0!==a?a:""),b.tG.info(507626007,b.nh.CoreDefault,l.stop())}logEgressCount(e){const t=Date.now();t-this.egressRateControlIntervalStart>1e3&&((this.egressMessageCount>50||this.egressByteCount>ot)&&(this.egressRateLogOp.start(),this.egressRateLogOp.resultDescription=this.egressMessageCount>50?"rps logging threshold exceeded":"",this.egressRateLogOp.resultDescription=this.egressByteCount>ot?"bps logging threshold exceeded":"",this.egressRateLogOp.dimension0=(t-this.egressRateControlIntervalStart).toString(),this.egressRateLogOp.dimension1=`${this.egressMessageCount}`,this.egressRateLogOp.dimension2=`${this.egressByteCount}`,this.egressRateLogOp.dimension3=`networkMode: ${this.networkMode}`,b.tG.info(508843792,b.nh.CoreDefault,this.egressRateLogOp.stop())),this.egressRateControlIntervalStart=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}}var st,it;!function(e){e[e.JSWebSockets=0]="JSWebSockets",e[e.LocalWorkflowsOnly=1]="LocalWorkflowsOnly",e[e.HostWebSockets=2]="HostWebSockets",e[e.HttpFallback=3]="HttpFallback"}(st||(st={})),function(e){e.Workflow="Workflow",e.Client="Client",e.HttpEndpoint="HttpEndpoint"}(it||(it={}));class at{constructor(e,t,n,o,r,s,i,a,l){this.logCountLimiter=new ue(at.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.workerOpenCount=0,this.testHttpConnection=e=>{const t=ce.convertWebSocketUrlToHttp(this.globalUrl),n=!e,o=null!=e?e:new L.I({operationName:"HttpsTest",resourceId:H(t),success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start();De(t,{method:"POST",headers:{"content-type":"application/json","X-CorrelationId":o.cv},body:JSON.stringify(ce.createHealthCheckRequest(this.clientMetadata))},((e,t)=>{e?(o.dimension1="HttpErr",o.resultDescription+=`HttpErr: ${e.message}`):t&&t.ok?(o.dimension1="HttpOK",this.leaveOfflineMode(),this.httpTestsSuccessCount++,n&&(o.success=!0)):(o.dimension1="HttpNoResp",o.resultDescription+=`HttpStatus: ${null==t?void 0:t.status}`),n&&o.stop(),this.logCountLimiter.log((()=>{b.tG.info(508843780,b.nh.CoreDefault,o)}))}))},this.globalUrl=e,this.clientMetadata=t,this.workerFactory=n,this.sessionInitializer=o,this.ingress=r,this.onConnectionClose=s,this.sessionCorrelationVector=i,this.reducedPingPongRetryEnabled=a.reducedPingPongRetryEnabled,this.networkWorkerLogOp=new L.I({operationName:"CreateNetworkWorker",success:!0}),this.networkMode=l||st.JSWebSockets,this.initNetworkMode=this.networkMode}init(e,t,n=!1){if(this.permanentlyClosed)return Promise.reject(new Error("permanentlyClosed"));if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=e||this.extensionConfigs;const o=()=>{if(n||!this.alreadyLoggedReconnectAttempt){const e=n?at.initialAttemptTimeout:at.reconnectAttemptTimeout;this.connTimeout=setTimeout((()=>{const t=new L.I({operationName:"ConnectionFailingOrSlow",dimension0:n?"Initial":"Reconnect",dimension1:e.toString(),dimension2:this.currentReconnectAttempt.toString()});b.tG.info(508843787,b.nh.CoreDefault,t),this.alreadyLoggedReconnectAttempt=!n,this.connTimeout=void 0}),e)}};return t?this.pendingInitPromise=t().catch((e=>{const t=new L.I({operationName:"WorkerManagerCustomInit",success:!1,resultDescription:`${e}`});b.tG.error(508843786,b.nh.CoreDefault,t)})).then((()=>{o(),this.initInternal()})):(this.pendingInitPromise=Promise.resolve(),o(),this.initInternal()),this.pendingInitPromise}egress(e,t){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressInternal(e,t)})):(this.egressInternal(e,t),Promise.resolve())}egressBytes(e){return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((()=>{this.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())}getNetworkMode(){return this.networkMode}getInitNetworkMode(){return this.initNetworkMode}onRateLimitErrorResponse(e){this.getNetworkRateController().onRateLimitErrorResponse(e)}close(e){this.isWorkerReady=!1,this.networkRateController&&this.getNetworkRateController().close(),this.worker&&(this.worker.close(),this.worker=null),this.networkRateController=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))}initInternal(){if(this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()){const e=new L.I({operationName:"WorkerManagerInitOffline",success:!0,resultSignature:this.permanentlyClosed?"PermanentlyClosed":"Offline"});b.tG.info(508843785,b.nh.CoreDefault,e)}else this.currentReconnectAttempt>0?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),((e,t,n)=>{let o=0;const r=ce.getCurrentTimeMs()?ce.getCurrentTimeMs()-t:0,s=[1e3,2e3,5e3,1e4,6e4];return o=s[Math.max(0,Math.min(s.length-1,e-1))],o=Math.max(o-r,1e3),o=n&&n>0?Math.min(5e3,o):o,o})(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs,this.httpTestsSuccessCount)):this.getNetworkMode()===st.HttpFallback?setTimeout((()=>{this.tryToConnectAndInitializeSession()}),100):this.tryToConnectAndInitializeSession()}egressInternal(e,t){if(!this.isWorkerReady&&!r.h.matchesTypesFor(e,[te.eE.getTypeName()]))return void(r.h.matchesTypesFor(e,[te.YK.getTypeName()])||b.tG.error(508843784,b.nh.CoreDefault,new L.I({operationName:"UnexpectedEgressCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`})));let n,o;if(r.h.matchesTypesFor(e,[te.VR.getTypeName()])?(this.castBinaryData(e),n=Me.serialize(e)):n=JSON.stringify(e),te.Tb.typeGuard(e)&&(o=e.seq),this.bypassRateController(e))return void this.worker.egress({obj:n});const s=te.eE.typeGuard(e)&&this.getNetworkMode()===st.HttpFallback;this.getNetworkRateController().egress({obj:n,isHttpSessionInitMessage:s,messageId:e.messageId,seqId:o},t)}bypassRateController(e){return te.w9.typeGuard(e)}egressBytesInternal(e){this.isWorkerReady?this.getNetworkRateController().egress({obj:e}):b.tG.error(508843783,b.nh.CoreDefault,new L.I({operationName:"UnexpectedEgressBytesCall",resultDescription:`isWorkerReady: ${this.isWorkerReady}`}))}tryToConnectAndInitializeSession(){this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=ce.getCurrentTimeMs();const e=t=>{if(this.permanentlyClosed||this.isOffline())return;const n=this.sliceUrl?this.sliceUrl:this.globalUrl;t.setDataField("connectionUrl",H(n)),this.connect(n),this.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!this.sliceUrl,extensionConfigs:this.extensionConfigs,onResponse:(n,o)=>{if(t.success=!n,t.resourceId=o?H(o.sliceUrl):"",t.dimension2=this.getNetworkModeLogString(),this.getNetworkMode()===st.HttpFallback?(t.resultDescription=n?`HTTP Error: ${n.error}`:"",t.dimension0=t.success?"HTTPOK":"HTTPFail"):(t.resultDescription=n?`WS Error: ${n.error}`:"",t.dimension0=t.success?"WSOK":"WSFail"),n||!this.worker)return this.sliceUrl=void 0,this.close(),this.httpTestsLeft>0?(this.httpTestsLeft--,this.testHttpConnection(t.stop())):(this.getNetworkMode()===st.JSWebSockets?0===this.workerOpenCount&&this.httpTestsSuccessCount>=5?(t.dimension1="WSBlocked",t.dimension3="HTTP Fallback",this.networkMode=st.HttpFallback,this.currentReconnectAttempt=0,this.resetHttpTestsCounter()):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="WSOffline"):0===this.httpTestsSuccessCount&&(this.startOfflineMode(),t.dimension1="HTTPOffline"),this.logCountLimiter.log((()=>{b.tG.info(508843782,b.nh.CoreDefault,t.stop())}))),void this.initInternal();if(this.logCountLimiter.log((()=>{b.tG.info(508843781,b.nh.CoreDefault,t.stop())})),o.forceReconnect){this.close();const t=new L.I({operationName:"ForcedReconnect"}).start();t.resultSignature=`globalUrl: ${this.globalUrl}. sliceUrl: ${this.sliceUrl}`,this.sliceUrl=void 0,setTimeout((()=>{e(t)}),1e3)}else clearTimeout(this.connTimeout),this.sliceUrl=o.sliceUrl,this.getNetworkRateController().setRpsBps(o.maxRPS,o.maxBPS),this.ready();this.resetHttpTestsCounter()}})},t=new L.I({operationName:"TryToConnectAndInitializeSession",resultSignature:`Reconnection attempt #${this.currentReconnectAttempt}`}).start();e(t)}getNetworkRateController(){return this.networkRateController||(this.networkRateController=new rt({reducedPingPongRetryEnabled:this.reducedPingPongRetryEnabled})),this.networkRateController}connect(e){const t=this.getNetworkMode();this.networkWorkerLogOp.start(),this.networkWorkerLogOp.resultDescription=this.getNetworkModeLogString(),this.networkWorkerLogOp.dimension0=t.toString(),this.logCountLimiter.log((()=>b.tG.info(508372418,b.nh.CoreDefault,this.networkWorkerLogOp.stop()))),this.worker=this.workerFactory(t),this.worker.init(e,this.getNetworkRateController().ingressFromWorker.bind(this.networkRateController),(()=>{this.workerOpenCount++,this.getNetworkRateController().open(),this.leaveOfflineMode()}),(e=>{this.close(),this.onConnectionClose(e)}),this.clientMetadata),this.getNetworkRateController().init(this.worker,this.ingress,t,this.clientMetadata,this.sessionCorrelationVector)}ready(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0}castBinaryData(e){if(e){if(Array.isArray(e.__binaryMembers__))for(const t of e.__binaryMembers__)ArrayBuffer.isView(e[t])||(e[t]=new Uint8Array(e[t]));for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&this.castBinaryData(e[t])}}isOffline(){return!!this.offlineInterval}startOfflineMode(){this.offlineInterval=setInterval((()=>{this.testHttpConnection()}),6e4)}leaveOfflineMode(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())}resetHttpTestsCounter(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0}getNetworkModeLogString(){return"NetworkMode: "+(this.getNetworkMode()===st.JSWebSockets?"WebSocket":"HTTP")}}at.initialAttemptTimeout=1e5,at.reconnectAttemptTimeout=2e4,at.className="NetworkWorkerManager";class lt extends oe.EventEmitter{constructor(e,t,n,o,r,s,i,a,l){super(),this.cvParent=new J,this.logOp=new L.I({operationName:"SessionState",success:!0}).start(),this.sessionStateChangeLogCountLimiter=new ue("SessionState"),this.logRetryTelemetry=!0,this.isImproveRetriesChangeGateEnabled=!0,this.shouldNotRetryOnSessionClosedError=!0,this.stats=t,this.allStates={[ge.Initing]:new _e(this),[ge.Running]:new Ce(this),[ge.Disconnected]:new ke(this),[ge.Closed]:new Ee(this)},this.setState(ge.Initing),this.messageEndpoint=new ee.N0({messageIdPrefix:"c",responseTimeoutMs:3e4,resendPendingMessagesOnReconnect:!1}),this.messageEndpoint.setClientMetadata(r),this.messageEndpoint.setEgress(this.egress.bind(this)),this.messageEndpoint.onMessage(te.w9.getTypeName(),((e,t)=>{this.onSessionCloseMessage(e,t)})),this.networkWorkerManager=new at(e,r,n,o,this.ingress.bind(this),this.onConnectionClose.bind(this),this.getCorrelationVector.bind(this),i,l),this.messageQueue=new ve({sendMessage:(e,t,n,o)=>this.state.sendMessage(e,t,n,o),sendBytes:this.sendBytes.bind(this),canSendMessage:()=>this.state.canSendMessage()}),o.on("connect",((e,t,n,o,r,s,i,a)=>{this.setState(ge.Running,"",{isSessionReseedingStarted:e&&t}),this.emit("connect",e,n,o,r,s,i,a)})),o.on("reconnect",(()=>this.emit("reconnect"))),o.on("serverAuthenticationStateChange",(e=>this.emit("serverAuthenticationStateChange",e))),this.resetNextSyncSequenceId=()=>this.emit("resetNextSyncSequenceId"),this.tokenRefreshManager=s,this.gateUtils=a,this.gateUtils&&(this.gateUtils.isChangeGateEnabled("LogRetryMessageEventV2").then((e=>{this.logRetryTelemetry=e})).catch((()=>{})),this.gateUtils.isChangeGateEnabled("ImproveClientRetries").then((e=>{this.isImproveRetriesChangeGateEnabled=e})).catch((()=>{})),this.gateUtils.isChangeGateEnabled("ShouldNotRetryOnSessionClosedError").then((e=>{this.shouldNotRetryOnSessionClosedError=e})).catch((()=>{})))}setState(e,t,n){if(this.state&&e===this.state.stateName)return;const o=this.state?ge[this.state.stateName]:"undefined",r=this.state?this.state.possibleNextStates.indexOf(e)>=0:e===ge.Initing;this.sessionStateChangeLogCountLimiter.log((()=>{this.logOp.stop(),this.logOp.resourceId=`New state: ${r?ge[e]:o}`,this.logOp.resultDescription=`Previous state: ${o}`,this.logOp.dimension0=`Attempted state: ${ge[e]||"undefined"}`,this.logOp.resultSignature=t+(this.state&&!r?"Unexpected state change":""),this.logOp.success=r,b.tG.info(508843791,b.nh.CoreDefault,this.logOp)})),r&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(n))}init(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.networkWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)}sendMessage(e,t,n){this.retrySendMessage(e,t,lt.maxRetries,n)}sendBytes(e){this.state.sendBytes(e)}onMessage(e,t){this.messageEndpoint.onMessage(e,t)}getCorrelationVector(){return this.cvParent}getNetworkWorkerManager(){return this.networkWorkerManager}forceReconnect(e){return this.extensionConfigs=e||this.extensionConfigs,this.networkWorkerManager.close(!1),new Promise((e=>setTimeout((()=>{e(this.networkWorkerManager.init(this.extensionConfigs))}),100)))}closeSession(e){this.sendMessage(new te.w9),this.networkWorkerManager.close(!0);const t=e||new te.Zy({reasonDescription:"ClientRequested"});this.onSessionClose(new te.w9({reconnectAllowed:!1,reason:t}),"ClientRequested")}ingress(e,t){let n;try{n=JSON.parse(e)}catch(e){b.tG.error(508843790,b.nh.CoreDefault,new L.I({operationName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0}))}if(n){if(t&&te.YK.typeGuard(n)&&t(n),this.networkWorkerManager.getNetworkMode()===st.HttpFallback&&te.ry.typeGuard(n)){const e=n;if(e.batch)for(const t of e.batch)this.messageEndpoint.ingress(t,((e,t)=>this.egress(e||t,(()=>{}))));return}this.messageEndpoint.ingress(n,((e,t)=>this.egress(e||t,(()=>{}))))}}egress(e,t,n){e&&this.networkWorkerManager.egress(e,n).then((()=>t())).catch((e=>t(e)))}onSessionCloseMessage(e,t){e.reconnectAllowed?this.networkWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()}onSessionClose(e,t){this.setState(ge.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)}onConnectionClose(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=ce.getCurrentTimeMs(),this.emit("disconnect",e)}retrySendMessage(e,t,n,o,s){const i=lt.maxRetries-n;this.state.sendMessage(e,((a,l)=>{var c,u,d,h,p,f;s&&(a&&0==n?(s.dimension0=(i+1).toString(),s.success=!1,b.tG.info(507025311,b.nh.CoreDefault,s.stop())):a&&n>0?(s.dimension0=(i+1).toString(),s.dimension1=null!==(u=null===(c=a.code)||void 0===c?void 0:c.toString())&&void 0!==u?u:"NoErrorCode",s.resultSignature=null!==(d=a.error)&&void 0!==d?d:"NoErrorMessage"):(s.success=!0,b.tG.info(507025310,b.nh.CoreDefault,s.stop()))),a&&n>0&&this.canBeRetried(e)&&this.isTransientError(a)?(this.logRetryTelemetry&&!s&&((s=new L.I({operationName:"RetrySendMessage",success:!0,dimension0:(i+1).toString()}).start()).resourceId=r.h.getTypeNameFor(e),s.dimension1=null!==(p=null===(h=a.code)||void 0===h?void 0:h.toString())&&void 0!==p?p:"NoErrorCode",s.resultSignature=null!==(f=a.error)&&void 0!==f?f:"NoErrorMessage",s.resultDescription=`Retrying message with messageId: ${e.messageId}${te.Tb.typeGuard(e)?`, seq: ${e.seq}`:""}`),r.h.matchesTypesFor(a,[te.ru.getTypeName()])&&this.networkWorkerManager.onRateLimitErrorResponse(a),this.retrySendMessage(e,t,n-1,o,s)):t&&t(a,l)}),i,o)}canBeRetried(e){return!r.h.matchesTypesFor(e,[te.eE.getTypeName(),te.VR.getTypeName(),Ve.getTypeName()])}isTransientError(e){const t=e.error,n=e.code;return!(this.isImproveRetriesChangeGateEnabled&&n===ne.xv.TokenValidationError||n===ne.xv.TokenDecryptError||n===ne.xv.SyncMessageTooLateOrDuplicate||this.shouldNotRetryOnSessionClosedError&&n===ne.xv.Gone)&&t!==ee.Ef.SyncMessageUnsupportedBatch&&t!==ee.Ef.UnexpectedSeedMessage&&t!==ee.Ef.UnsupportedSyncMessage&&t!==ee.Ef.AnnotationTokenNotFound&&t!==fe.ArrivedBeforeReseeding&&t!==fe.DroppedAsOldestInQueue&&t!==fe.DroppedBecauseClientDisconnected}}lt.maxRetries=2;var ct,ut,dt,ht,pt,ft,gt,mt=n(25686),yt=n(50605),vt=n(26850);!function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(ct||(ct={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(ut||(ut={})),function(e){e[e.Unknown=0]="Unknown",e[e.TokenMissingInteractionRequired=1]="TokenMissingInteractionRequired"}(dt||(dt={}));class bt{constructor(e,t,n,o){this.sendMessage=e,this.annotationType=t,this.options=n,this.token=`${t}-${bt.nextActivationResultBatchId++}`,this.annotationDoesNotExistOnServiceEnabled=o}activate(e,t,n){return new Promise(((o,r)=>{this.sendMessage(new te.n4({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0,forceReturnCachedAnnotations:this.options?this.options.forceReturnCachedAnnotations:void 0,returnAnnotationDoesNotExist:this.annotationDoesNotExistOnServiceEnabled||!1,sendApologies:n}),((e,t)=>{e?r(new Error(e.error)):(te.PY.typeGuard(t)&&this.annotationDoesNotExistOnServiceEnabled&&(this.annotationDoesNotExistOnService=t.annotationNotExists),o({token:this.token}))}),t)}))}release(){return new Promise(((e,t)=>{this.annotationDoesNotExistOnService&&this.annotationDoesNotExistOnServiceEnabled?e(!1):this.sendMessage(new te.GA({token:this.token}),((n,o)=>{n?t(new Error(n.error)):e(o.lastRelease)}))}))}}bt.nextActivationResultBatchId=1,(gt=ht||(ht={}))[gt.Input=0]="Input",gt[gt.Exception=1]="Exception",gt[gt.WaitOn=2]="WaitOn",gt[gt.StopAndFilterWorkflow=3]="StopAndFilterWorkflow",function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(pt||(pt={})),function(e){e[e.ExceedingMaxSize=0]="ExceedingMaxSize",e[e.GroupComplete=1]="GroupComplete",e[e.BatchIntervalElapsed=2]="BatchIntervalElapsed"}(ft||(ft={}));class St{constructor(e,t,n,o,r){this.batchesByGroupingKey=new Map,this.getOrderOfMagnitudeDimension=e=>e<0?"Negative":0===e?"0":1===e?"1":`Magnitude ${e.toString().length}`,this.submit=e,this.onSummary=o,this.reduceBatchOperationsEnabled=t,this.batchMessagesEnabled=n,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=r}addBatchItem(e,t,n,o,r,s){const{delayMs:i,delayMsMax:a,maxInputSize:l,estimateSize:c,groupingKeyExtractor:u}=t,d=c(e),h=u(e);if(t.split&&d>l){let i;try{i=t.split(e)}catch(e){const t=new Error("Split error: "+e.message);return void(s?s(t):b.tG.error(573366352,b.nh.CoreDefault,t))}if(i&&Array.isArray(i.inputs)&&i.inputs.length>1){let e;const a=[],l=s?(t,n)=>{if(e=e||t,a.push(n),a.length===i.inputs.length){let n;try{n=i.join(a)}catch(t){return void s(new Error("Join error: "+t.message))}s(e,n)}}:void 0;for(let e=0;e<i.inputs.length;e++){const s=i.inputs[e];this.addBatchItem(s,t,n,o,r&&e===i.inputs.length-1,l)}return}}let p=this.batchesByGroupingKey.get(h);if(p&&p.size+d>l&&(this.executeBatch(h,p,t,ft.ExceedingMaxSize),p=void 0),p||(p={items:[],size:0,hasItemsWithCallbacks:!1,context:n,creationTime:Date.now()},this.batchesByGroupingKey.set(h,p)),this.batchMessagesEnabled){const t=p.items[p.items.length-1];t&&t.cv===o&&t.callback===s?(t.input=[...t.input,...e],t.size+=d):p.items.push({input:e,size:d,cv:o,callback:s})}else p.items.push({input:e,size:d,callback:s});p.size+=d,p.hasItemsWithCallbacks=p.hasItemsWithCallbacks||!!s,this.batchMessagesEnabled||(p.cv=o),p.groupComplete=r,p.groupComplete?this.executeBatch(h,p,t,ft.GroupComplete):(Date.now()-p.creationTime+i<a&&(clearTimeout(p.timeout),p.timeout=void 0),p.timeout||(p.timeout=setTimeout((()=>{this.executeBatch(h,p,t,ft.BatchIntervalElapsed)}),i)))}removeAllBatchedItems(){this.batchesByGroupingKey.forEach((e=>{e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()}reduceBatchOperations(e){const t=new L.I({operationName:"ReduceBatchOperations"}).start();let n=0,o=0,r=0;const s=new Set,i=[],a=(e,t)=>e.parentPath.toString()+"/"+e.parentRevId+"/"+t.id;for(const t of e.input.reverse()){const e=[];for(const i of t.input.reverse())if(ie.fZ.typeGuard(i)){const t=[];for(const e of i.items){r++;const l=a(i,e);s.has(l)?o++:(t.push(e),s.add(l),n++)}0!==t.length&&(i.items=t,e.push(i))}else if(ie.Xr.typeGuard(i)){for(const e of i.items){const t=a(i,e);s.delete(t)}e.push(i)}else e.push(i);0!==e.length&&i.push({input:e.reverse(),size:t.size,cv:t.cv,callback:t.callback})}e.input=i.reverse(),0!=r&&(t.dimension0=`${this.getOrderOfMagnitudeDimension(o)}`,t.dimension1=`noOp: ${0===o}`),t.success=r-o==n,b.tG.info(507839488,b.nh.CoreDefault,t.stop())}maxNumberOfDeltaUpdateOpsPerItemPerBatch(e){const t=(e,t)=>e.parentPath.toString()+"/"+t.id;let n=0;const o=new Map;for(const r of e.input)if(ie.xU.typeGuard(r))for(const e of r.items){const s=t(r,e);o.has(s)||o.set(s,0),o.set(s,o.get(s)+1),n=Math.max(n,o.get(s))}return n}executeBatch(e,t,n,o){clearTimeout(t.timeout),t.timeout=void 0,this.batchesByGroupingKey.delete(e);const r=t.items,s=new L.I({operationName:"ExecuteBatch",cv:this.batchMessagesEnabled?"":t.cv,resourceId:t.context.name,resultDescription:`batching duration: ${Date.now()-t.creationTime}ms`,dimension0:`${this.batchMessagesEnabled?"Batched items count":"Batched ops count:"} ${this.getOrderOfMagnitudeDimension(r.length)}`,dimension1:`Size ${this.getOrderOfMagnitudeDimension(t.size)}`,dimension2:o.toString()}).start(),i=(e,n,o)=>{let i;if(n&&n.exceptionType===pt.NoOutput)s.success=!0,b.tG.info(573366353,b.nh.CoreDefault,s.stop());else{const o=`${e} error: ${n?n.message||n:"Unknown error"}`;i=n||new Error(o),s.success=!1,s.resultDescription=`Batch of ${r.length} items of size ${t.size} with ${o}`,s.resultSignature=`${e} Error`,b.tG.error(573366354,b.nh.CoreDefault,s.stop())}if(t.hasItemsWithCallbacks)for(const e of r)e.callback&&e.callback(i,o)};let a;try{a=n.multiplex(this.batchMessagesEnabled?r:r.map((e=>e.input)))}catch(e){return void i("Multiplex",e)}this.reduceBatchOperationsEnabled&&this.batchMessagesEnabled&&"operations"==e&&this.reduceBatchOperations(a),!this.batchMessagesEnabled&&"operations"==e&&this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled&&(s.dimension3=this.getOrderOfMagnitudeDimension(this.maxNumberOfDeltaUpdateOpsPerItemPerBatch(a))),this.submit(a.input,t,((e,o)=>{if(e||o&&("exceptionType"in o||o instanceof Error))i("Submit",e||o,o);else if(t.hasItemsWithCallbacks||n.summaryExtractor){let l,c,u;if(t.hasItemsWithCallbacks)try{if(l=a.demultiplex(o),l.length!==r.length)throw new Error("Mismatched output length")}catch(e){return void i("Demultiplex",e)}if(n.summaryExtractor)try{[u,c]=n.summaryExtractor(o)}catch(e){return void i("SummaryExtractor",e)}if(s.success=!0,b.tG.info(573366342,b.nh.CoreDefault,s.stop()),t.hasItemsWithCallbacks)for(let e=0;e<r.length;e++)r[e].callback&&r[e].callback(void 0,l[e]);c&&this.onSummary(u,c,t.context)}else s.success=!0,b.tG.info(573366343,b.nh.CoreDefault,s.stop())}))}}var wt,Tt,_t,Ct,kt,Et,At,It,Pt,Mt,xt,Rt,Dt,Ot,Nt,Lt=n(27821);!function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(wt||(wt={})),function(e){e.Default="Default",e.Copilot="Copilot"}(Tt||(Tt={})),function(e){e[e.None=0]="None",e[e.ContentFiltering_M365Copilot=1]="ContentFiltering_M365Copilot"}(_t||(_t={})),function(e){e[e.Default=0]="Default",e[e.LocalOnly=1]="LocalOnly",e[e.Exclusive=2]="Exclusive"}(Ct||(Ct={})),function(e){e[e.PreActivate=0]="PreActivate",e[e.Default=1]="Default",e[e.DelayActivate=1]="DelayActivate",e[e.NeverActivate=2]="NeverActivate"}(kt||(kt={})),(Nt=Et||(Et={}))[Nt.Required=-3]="Required",Nt[Nt.Optional=-1]="Optional",(Ot=At||(At={}))[Ot.Never=0]="Never",Ot[Ot.Always=1]="Always",function(e){e[e.PreSeed=1]="PreSeed",e[e.OnSeed=2]="OnSeed",e[e.PostSeed=4]="PostSeed",e[e.All=5]="All"}(It||(It={})),(Dt=Pt||(Pt={}))[Dt.UpstreamWorkflowsReady=0]="UpstreamWorkflowsReady",Dt[Dt.AnnotationMetadataUpdated=1]="AnnotationMetadataUpdated",Dt[Dt.DeltaUpdate=2]="DeltaUpdate",Dt[Dt.NonExclusiveTriggerSignals=3]="NonExclusiveTriggerSignals",function(e){e[e.Character=1]="Character",e[e.Paragraph=2]="Paragraph"}(Mt||(Mt={})),function(e){e.Input="Input",e.Delta="Delta",e.UILanguage="UILanguage",e.MaxInputCount="MaxInputCount",e.ExtensionLimits="ExtensionLimits"}(xt||(xt={})),function(e){e.SetPredefinedAnnotation="SetPredefinedAnnotation",e.ClearAnnotations="ClearAnnotations"}(Rt||(Rt={}));const Ft=(e,t)=>{const n=[];for(const o of null!=e?e:[])if(void 0===t||t===o.cardinality)for(const e of o.contextTypes)n.push([e,o.cardinality,o.producerWaitPolicy]);return n},Bt="\\",Wt=(e,t)=>Object.assign(Object.assign({},t),{parentPath:e}),Ut=e=>Array.isArray(e)?5===e.length?`${e[0]}${Bt}${e[1]}${Bt}${e[2]}${Bt}${e[3]}${Bt}${e[4]}`:4===e.length?`${e[0]}${Bt}${e[1]}${Bt}${e[2]}${Bt}${e[3]}`:3===e.length?`${e[0]}${Bt}${e[1]}${Bt}${e[2]}`:2===e.length?`${e[0]}${Bt}${e[1]}`:1===e.length?e[0]:e.join(Bt):"(malformed path)";var Gt;!function(e){e[e.Local=0]="Local",e[e.External=1]="External"}(Gt||(Gt={}));class Ht{constructor(){this.graphNodeByLocationAndWorkflowId=new Map}getWorkflow(e,t){var n;const o=this.getLocation(t);return null===(n=this.graphNodeByLocationAndWorkflowId.get(o))||void 0===n?void 0:n.get(e)}addWorkflow(e,t=!1){if(this.getWorkflow(e.id,t)){const n=new L.I({operationName:"AddWorkflowToGraphFailure",success:!1,resourceId:e.id,resultDescription:`Adding a new with workflow with a duplicated workflowId: ${t}`}).start();return void b.tG.error(524300630,b.nh.CoreDefault,n.stop())}const n=this.getLocation(t),o=new qt(e,n);this.addWorkflowAsDependency(o);let r=this.graphNodeByLocationAndWorkflowId.get(n);r||(r=new Map,this.graphNodeByLocationAndWorkflowId.set(n,r)),r.set(e.id,o)}getUpstreamRuntimeVisibleWorkflows(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const n of t.values()||[]){const t=this.createWorkflowDefinition(n.workflow);n.workflow.visibility===Ct.LocalOnly?this.compressDownstreamWorkflows(t,n):t.outputTypes.push(...n.workflow.outputTypes),0!==t.inputTypes.length&&e.push(t)}return e}removeWorkflows(e){const t=this.getLocation(e),n=this.graphNodeByLocationAndWorkflowId.get(t),o=Array.from((null==n?void 0:n.values())||[]);for(const e of o){for(const t of e.upstreamWorkflows.values())t.downstreamWorkflows.delete(e);for(const t of e.downstreamWorkflows.values())t.upstreamWorkflows.delete(e);n.delete(e.workflow.id)}}getWorkflowsDefinitions(){const e=[];for(const t of this.graphNodeByLocationAndWorkflowId.values()||[])for(const n of t.values()||[])e.push(n.workflow);return e}getWorkflowNodes(e){const t=[];for(const e of this.graphNodeByLocationAndWorkflowId.values())for(const n of e.values())t.push(n);return t}getLocation(e){return e?Gt.External:Gt.Local}createWorkflowDefinition(e){return Object.assign(Object.assign({},e),{outputTypes:[]})}compressDownstreamWorkflows(e,t){for(const n of t.downstreamWorkflows)if(n.workflow.visibility!==Ct.LocalOnly){if(n.workflow.kind!==wt.Join||-1!==e.inputTypes.indexOf(n.workflow.collectionScopeType))for(const t of n.workflow.outputTypes)-1===e.outputTypes.indexOf(t)&&e.outputTypes.push(t)}else this.compressDownstreamWorkflows(e,n)}addWorkflowAsDependency(e){for(const t of this.graphNodeByLocationAndWorkflowId.values())for(const n of t.values()){for(const t of n.workflow.inputTypes)-1!==e.workflow.outputTypes.indexOf(t)&&this.addWorkflowChain(e,n);for(const t of n.workflow.outputTypes)-1!==e.workflow.inputTypes.indexOf(t)&&this.addWorkflowChain(n,e)}}addWorkflowChain(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)}}class qt{constructor(e,t){this.isActivated=!0,this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.location=t,this.workflow=Object.assign(Object.assign({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}}new(n(95759).eU)("enableRichContentApis",!1);const $t=e=>({id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}),Vt=(e,t)=>null!=e&&null!=t&&e.length>0&&(e===t||0===t.indexOf(e)&&"."===t.charAt(e.length));class jt{constructor(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}static mergeDefinitions(e,t,n){return Object.assign(Object.assign(Object.assign({},e),t),n)}mergeWorkflowDefinition(e,t,n){if(n){const o=((e,t)=>{let n=e.get(t);return n||(n=new Map,e.set(t,n)),n})(this.workflowDefByWorkflowAndContextId,e.id);o.set(n,jt.mergeDefinitions(e,o.get(n),t))}else this.workflowDefByWorkflow.set(e.id,jt.mergeDefinitions(e,this.workflowDefByWorkflow.get(e.id),t))}getWorkflowDefinition(e,t){var n;let o;return t&&(o=null===(n=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===n?void 0:n.get(t)),o||(o=this.workflowDefByWorkflow.get(e.id)),o||(o=e),o}deleteWorkflowDefinition(e,t){const n=this.workflowDefByWorkflowAndContextId.get(e.id);n&&(n.delete(t),0===n.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))}}var zt;!function(e){e.JsClient="C",e.Server="S"}(zt||(zt={}));const Qt=new Set([ie.Xr.getTypeName(),ie.fZ.getTypeName(),ie.g0.getTypeName(),ie.xU.getTypeName()]);class Jt{constructor(e,t){this.nextId=1,this.runtimeKind=e,this.workflowGraph=t}static isParentContextId(e,t){return Vt(e,t)}applyContextIdOnOperations(e){for(const t of e){const e=r.h.getTypeNameFor(t);if(this.isSupportedOperation(e))for(const e of t.items)e.contextId?e.source&&this.workflowGraph.getWorkflow(e.source,!1)?e.contextId=this.addNewContextId(e.contextId):this.tryLogMessage(new L.I({operationName:"ApplyContextIdOnOperations",success:!0}).start(),"Item with a contextId but without a workflow source atribute"):e.contextId=this.addNewContextId()}}addNewContextId(e){const t=`${this.runtimeKind}${this.nextId++}`;return e?`${e}.${t}`:t}isSupportedOperation(e){return Qt.has(e)}tryLogMessage(e,t,n=!0){e&&(e.success=n,e.resultDescription=t,b.tG.verbose(527308633,b.nh.CoreDefault,e.stop()))}}var Kt,Yt,Xt,Zt;!function(e){e[e.Idle=1]="Idle",e[e.Pending=2]="Pending",e[e.Running=3]="Running",e[e.Executed=4]="Executed"}(Kt||(Kt={}));class en{constructor(e){this.scopeItemsByContextId=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e}setScopeItem(e,t){var n;const o=e.contextId;if(o)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(o,[]),this.scopeItemsByContextId.has(o)){if(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.has(o)){const n=new L.I({resultDescription:`Trying to set new scope item: ${e.id} with already existing contextId ${o} for workflow ${t.id}`,operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();b.tG.verbose(527291288,b.nh.CoreDefault,n.stop())}}else this.scopeItemsByContextId.set(o,e)}updateScopeItemPath(e,t,n){var o,r;if(!e)return;const s=this.scopeItemsByContextId.get(e);if(!s)return;const i=s.parentPath;this.scopeItemsByContextId.set(e,Wt(t,s));const a=null!==(r=null===(o=this.itemsByWorkflowAndContextId.get(n.id))||void 0===o?void 0:o.get(e))&&void 0!==r?r:[];for(let e=0;e<a.length;e++)a[e]=Wt([...t,...a[e].parentPath.slice(0,i.length)],a[e])}getScopeItem(e,t){var n;for(const o of(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.keys())||[])if(Vt(o,e))return this.scopeItemsByContextId.get(o)}addItemToWorkflowList(e,t){const n=e.contextId;if(!n)return;const o=this.itemsByWorkflowAndContextId.get(t.id);if(o)for(const[r,s]of o)if(Vt(r,n)){s.push(e);const n=new L.I({resultDescription:`Items for contextId ${r}: [${s.map((e=>e.id)).join(",")}]`,operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();b.tG.info(526403808,b.nh.CoreDefault,n.stop())}}isWorkflowReady(e,t){const n=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=n}getItemsToExecute(e,t){const n=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),n}onWorkflowExecuted(e,t){const n=e.contextId,o=this.itemsByWorkflowAndContextId.get(t.id);o&&(o.delete(n),0===o.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(n)||this.scopeItemsByContextId.delete(n)}getGeneratedItems(e,t){var n;if(!(null===(n=this.itemsByWorkflowAndContextId.get(t.id))||void 0===n?void 0:n.get(e)))return[];const o=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,o)}hasWorkflowsAwaitingExecution(e){for(const t of this.itemsByWorkflowAndContextId.values())for(const n of t.keys())if(n===e)return!0;return!1}}class tn{constructor(e){r.h.assign(tn,this,e)}static getTypeName(){return"AugLoop_Text_TextTile"}static getBaseTypes(){return[]}static typeGuard(e){return r.h.matchesTypesFor(e,[tn.getTypeName()])}}tn.H_={T_:tn.getTypeName(),B_:tn.getBaseTypes()};class nn{constructor(e){r.h.assign(nn,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[nn.getTypeName()])}}nn.H_={T_:nn.getTypeName(),B_:nn.getBaseTypes()};class on{constructor(e){r.h.assign(on,this,e)}static getTypeName(){return"AugLoop_Text_InlineTile"}static getBaseTypes(){return["AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[on.getTypeName()])}}on.H_={T_:on.getTypeName(),B_:on.getBaseTypes()};class rn{constructor(e){r.h.assign(rn,this,e)}static getTypeName(){return"AugLoop_Text_DynamicTextContext"}static getBaseTypes(){return["AugLoop_Core_DynamicContext"]}static typeGuard(e){return r.h.matchesTypesFor(e,[rn.getTypeName()])}}rn.H_={T_:rn.getTypeName(),B_:rn.getBaseTypes()};class sn{constructor(e){r.h.assign(sn,this,e)}static getTypeName(){return"AugLoop_Text_TaskTile"}static getBaseTypes(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[sn.getTypeName()])}}sn.H_={T_:sn.getTypeName(),B_:sn.getBaseTypes()};class an{constructor(e){r.h.assign(an,this,e)}static getTypeName(){return"AugLoop_Text_PersonTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[an.getTypeName()])}}an.H_={T_:an.getTypeName(),B_:an.getBaseTypes()};class ln{constructor(e){r.h.assign(ln,this,e)}static getTypeName(){return"AugLoop_Text_DateTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[ln.getTypeName()])}}ln.H_={T_:ln.getTypeName(),B_:ln.getBaseTypes()};class cn{constructor(e){r.h.assign(cn,this,e)}static getTypeName(){return"AugLoop_Text_LinkTile"}static getBaseTypes(){return["AugLoop_Text_InlineTile","AugLoop_Text_TextTile"]}static typeGuard(e){return r.h.matchesTypesFor(e,[cn.getTypeName()])}}cn.H_={T_:cn.getTypeName(),B_:cn.getBaseTypes()};class un{constructor(e){r.h.assign(un,this,e)}static getTypeName(){return"AugLoop_Text_CommentTile"}static getBaseTypes(){return[]}static typeGuard(e){return r.h.matchesTypesFor(e,[un.getTypeName()])}}un.H_={T_:un.getTypeName(),B_:un.getBaseTypes()},function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate",e[e.AttributionUpdate=6]="AttributionUpdate"}(Yt||(Yt={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(Xt||(Xt={})),function(e){e[e.SessionUser=0]="SessionUser",e[e.Programmatic=1]="Programmatic",e[e.Collaborator=2]="Collaborator"}(Zt||(Zt={}));class dn{constructor(e){r.h.assign(dn,this,e)}static getTypeName(){return"AugLoop_Text_TextTileDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return r.h.matchesTypesFor(e,[dn.getTypeName()])}}dn.H_={T_:dn.getTypeName(),B_:dn.getBaseTypes()};class hn{constructor(e){r.h.assign(hn,this,e)}static getTypeName(){return"AugLoop_Text_FormattedTextTileDelta"}static getBaseTypes(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]}static typeGuard(e){return r.h.matchesTypesFor(e,[hn.getTypeName()])}}function pn(e,t=!1){switch(e){case 12288:case 8197:case 32:case 11:case 9:case 160:return!0;case 13:case 10:case 65532:return!t}return!1}function fn(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}hn.H_={T_:hn.getTypeName(),B_:hn.getBaseTypes()};const gn=/[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]/g,mn=/[.!?]/g;function yn(e,t){const n=[],o=bn(e,t);return o&&n.push(o),n}function vn(e,t){const n=[],o=bn(e,t);o&&n.push(o);const r=function(e,t,n){var o,r,s,i,a,l;const c=e,u=t;if((null==c?void 0:c.ipPosition)!==(null==u?void 0:u.ipPosition)||(null==c?void 0:c.isColdIp)!==(null==u?void 0:u.isColdIp)){if((null==c?void 0:c.isColdIp)===(null==u?void 0:u.isColdIp)&&n)if(n.deltaType===Yt.Add){if((null==u?void 0:u.ipPosition)===(null!==(o=n.position)&&void 0!==o?o:0)+(null!==(r=n.length)&&void 0!==r?r:0))return}else if(n.deltaType===Yt.Update){if((null==u?void 0:u.ipPosition)===(null!==(s=n.position)&&void 0!==s?s:0)+(null!==(a=null===(i=n.content)||void 0===i?void 0:i.length)&&void 0!==a?a:0))return}else if(n.deltaType===Yt.Delete&&(null==u?void 0:u.ipPosition)===(null!==(l=n.position)&&void 0!==l?l:0))return;return new hn({deltaType:Yt.CursorUpdate,cursorData:{ipPosition:null==u?void 0:u.ipPosition,isColdIp:null==u?void 0:u.isColdIp}})}}(e,t,o);r&&n.push(r);const s=function(e,t,n){var o,r,s,i,a,l,c;const u=e,d=t;if((null===(o=d.formattedRanges)||void 0===o?void 0:o.length)<=(null===(r=u.formattedRanges)||void 0===r?void 0:r.length))if(n){let e=u.formattedRanges?[...u.formattedRanges]:[];const t=function(e,t,n){if(!e)return;if(t.deltaType===Yt.Add){const t=e.find((e=>e.start===n&&0===e.length));if(t)return t;n=Math.max(n-1,0)}const o=e.find((e=>0===e.length?e.start===n:e.start<=n&&n<e.start+e.length));return o}(u.formattedRanges,n,n.position),o=t?e.indexOf(t):-1;if(-1!==o&&(n.position+(n.length||0)>t.start+t.length?t.length=n.position+(null!==(s=n.content)&&void 0!==s?s:"").length-t.start:t.length+=(null!==(i=n.content)&&void 0!==i?i:"").length-(n.length||0),e[o]=t),e.length>0){for(const t of e.slice(o+1))t.start<n.position||(n.position+(n.length||0)>t.start?(t.length=t.start+t.length-(n.position+(n.length||0)),t.start=n.position+(null!==(a=n.content)&&void 0!==a?a:"").length):t.start+=(null!==(l=n.content)&&void 0!==l?l:"").length-(n.length||0));e=e.filter((e=>e.length>0))}const r=null!==(c=null==d?void 0:d.formattedRanges)&&void 0!==c?c:[];if(le()(e,r)||0===e.length&&0===r.length)return}else if(le()(null==u?void 0:u.formattedRanges,null==d?void 0:d.formattedRanges))return;return new hn({deltaType:Yt.FormattingUpdate,formattedRanges:null==d?void 0:d.formattedRanges})}(e,t,o);s&&n.push(s);const i=function(e,t,n){var o;const r=e,s=t;if(((null==r?void 0:r.attributionRanges)||s.attributionRanges||(null===(o=null==n?void 0:n.attributionData)||void 0===o?void 0:o.ranges))&&!le()(null==r?void 0:r.attributionRanges,null==s?void 0:s.attributionRanges)){if(r.attributionRanges&&s.attributionRanges){const e=[];for(const t of s.attributionRanges)r.attributionRanges.some((e=>le()(e,t)))||e.push(t);if(0===e.length)return;return new hn({deltaType:Yt.AttributionUpdate,attributionData:{ranges:e}})}return new hn({deltaType:Yt.AttributionUpdate,attributionData:{ranges:null==s?void 0:s.attributionRanges}})}}(e,t,o);i&&n.push(i);const a=function(e,t){const n=e,o=t;let r;const s={};let i=!1;for(r in o)-1===["ipPosition","isColdIp","content","formattedRanges","attributionRanges"].indexOf(r)&&(le()(o[r],n[r])||(i=!0,s[r]=o[r]));if(i)return new hn({deltaType:Yt.OtherNonContentUpdate,otherNonContentData:s})}(e,t);return a&&n.push(a),n}function bn(e,t){const n=e.content,o=t.content,r=function(e,t,n=!1){let o,r,s={firstDiffLeft:0,firstDiffRight:t.length};return e.length<t.length?(o=e,r=t):(o=t,r=e),0===r.indexOf(o)?(s.firstDiffLeft=o.length,s.firstDiffRight=0):r.endsWith(o)?(s.firstDiffLeft=0,s.firstDiffRight=o.length):(s=function(e,t,n=!1){const o={firstDiffLeft:0,firstDiffRight:t.length};let r;for(r=0;r<e.length&&r<t.length;r+=1){const o=e.charCodeAt(r),s=t.charCodeAt(r);if(!(o===s||pn(o,n)&&pn(s,n)))break}for(o.firstDiffLeft=r,r=0;r<e.length&&r<t.length;r+=1){const o=e.charCodeAt(e.length-r-1),s=t.charCodeAt(t.length-r-1);if(!(o===s||pn(o,n)&&pn(s,n)))break}return o.firstDiffRight=r,o}(e,t,n),s.firstDiffLeft+s.firstDiffRight>o.length&&(s.firstDiffRight=o.length-s.firstDiffLeft)),function(e,t,n){if(e.firstDiffLeft>0){const o=e.firstDiffLeft<t.length&&fn(t,e.firstDiffLeft),r=e.firstDiffLeft<n.length&&fn(n,e.firstDiffLeft);(o||r)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight>1){const o=e.firstDiffRight<t.length&&fn(t,t.length-e.firstDiffRight),r=e.firstDiffRight<n.length&&fn(n,n.length-e.firstDiffRight);(o||r)&&(e.firstDiffRight-=1)}}(s,e,t),s}(n,o),s=r.firstDiffLeft,i=n.length-r.firstDiffRight,a=o.length-r.firstDiffRight;let l,c=Yt.Update;if(n.length!==o.length)i===s?(c=Yt.Add,l=n[n.length-1]):a===s&&(c=Yt.Delete,l=o[o.length-1]);else if(n===o)return;let u,d=0;switch(c){case Yt.Update:d=i-s,u=o.substring(s,a);break;case Yt.Add:u=o.substring(s,a);break;case Yt.Delete:d=i-s,u=n.substring(s,i)}const h=function(e,t){const n=Array.from(e.matchAll(gn));if(gn.lastIndex=0,0===n.length)return Xt.Chars;if(1===n.length){if(0===n[0].index)return t&&mn.test(t)?Xt.Sentence:t&&!gn.test(t)?Xt.Word:Xt.Chars;if(n[0].index+1===e.length)return mn.test(e[n[0].index-1])?Xt.Sentence:gn.test(e[n[0].index-1])?Xt.Chars:Xt.Word;if(e[n[0].index-1]){const t=e[n[0].index-1];if(mn.test(t))return Xt.Sentence;if(gn.test(t))return Xt.Chars}return Xt.Word}const o=Array.from(e.matchAll(mn));return mn.lastIndex=0,0===o.length?Xt.PartialSentence:o.length>1?Xt.Paragraph:o[0].index+1<=e.length?gn.test(e[o[0].index+1])?Xt.Sentence:Xt.Paragraph:void 0}(u,l);if(void 0!==h)return new hn({content:c!==Yt.Delete?u:void 0,deltaType:c,unit:h,position:s,length:c!==Yt.Add?d:0})}class Sn{constructor(){this.deltaBuilderHandlers=new Map,this.registerDeltaBuilderHandler(tn.getTypeName(),yn),this.registerDeltaBuilderHandler(nn.getTypeName(),vn)}registerDeltaBuilderHandler(e,t){this.deltaBuilderHandlers.set(e,t)}executeDeltaBuilderHandler(e,t,n){const o=this.deltaBuilderHandlers.get(e);return o?o(t,n):[]}}const wn=(e,t)=>t?Tn([...t,e]):e,Tn=e=>e.join("\\");class _n{constructor(e){this.createTextTileDeltasFromItem=(e,t)=>{var n;const o=new L.I({operationName:"CreateTextTileDeltaFromItem",success:!0}).start();try{if(!e)return o.success=!1,o.resultDescription="Unable to create text tile delta, parent item is undefined",void b.tG.info(524883085,b.nh.CoreDefault,o.stop());if(!e.body)return o.success=!1,o.resultDescription="Unable to create text tile delta, parent item has undefined body",void b.tG.info(524883086,b.nh.CoreDefault,o.stop());const s=e.body;if(!tn.typeGuard(s))return o.success=!1,void(o.resultDescription=`Unable to create text tile delta, parent item body is not proper type: expected ${tn.getTypeName()}, received ${r.h.getTypeNameFor(s)}`);const i=wn(e.id,t),a=null!==(n=this.lastSeenTileByTileId.get(i))&&void 0!==n?n:new tn({content:""}),l=this.createDeltas(a,s);return l&&0!==l.length?(o.dimension0=l.length.toString(),this.lastSeenTileByTileId.set(i,s)):(o.dimension0="0",o.resultDescription="No delta differences found"),b.tG.info(524883087,b.nh.CoreDefault,o.stop()),l}catch(e){return o.success=!1,o.resultDescription=`Error creating text tile delta: ${e}`,void b.tG.info(524883088,b.nh.CoreDefault,o.stop())}},this.lastSeenTileByTileId=null!=e?e:new Map,this.deltaBuilder=new Sn}addItemToLocalMap(e,t){const n=wn(e.id,t),o=e.body;tn.typeGuard(o)&&!this.lastSeenTileByTileId.has(n)&&this.lastSeenTileByTileId.set(n,o)}deleteItemFromLocalMap(e,t){const n=wn(e.id,t);this.lastSeenTileByTileId.has(n)&&this.lastSeenTileByTileId.delete(n)}moveItemsInLocalMap(e,t,n){const o=new Set(n),r=Tn(t),s=Tn(e),i=[],a=(e,t)=>e.length>t.length?e.substring(t.length+1).split("\\")[0]:void 0;for(const[e,t]of this.lastSeenTileByTileId)if(e.startsWith(r)){const n=a(e,r);if(void 0===n||o.has(n)){const n=e.replace(r,s);i.push({item:t,newPathKey:n,prevPathKey:e})}}for(const e of i)this.lastSeenTileByTileId.delete(e.prevPathKey),this.lastSeenTileByTileId.set(e.newPathKey,e.item)}createDeltas(e,t){return this.deltaBuilder.executeDeltaBuilderHandler(r.h.getTypeNameFor(t),e,t)}}function Cn(){return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}const kn=e=>En(e,Number.POSITIVE_INFINITY),En=(e,t)=>{let n=0;const o=[],r=[e];for(;r.length>0;){const e=r.pop(),s=typeof e;if("boolean"===s)n+=4;else if("string"===s)n+=2*e.length;else if("number"===s)n+=8;else if("object"===s&&e&&-1===o.indexOf(e))if(e instanceof Uint8Array)n+=e.length;else{o.push(e);for(const t in e)r.push(e[t])}if(n>t)return n}return n};var An=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};function In(e,t){return An(this,void 0,void 0,(function*(){const{authToken:n,origin:o,sessionUrl:r}=e,{body:s,cv:i,method:a,requestUrl:l}=t,c=yield(0,xe.fetch)(l||r,{method:a,headers:Object.assign({Authorization:`Bearer ${n}`,"x-origin":o,"x-correlationid":i},t.headers),body:s});if(200!==c.status)throw new Error(`Unexpected status code: ${c.status}`);return c}))}const Pn=(e,t)=>{t?(e.resultDescription=t,e.success=!1,b.tG.error(507646878,b.nh.CoreDefault,e.stop())):b.tG.info(507646877,b.nh.CoreDefault,e.stop())};function Mn(e,t,n,o){let r;In(e,{headers:{"Content-Type":"application/jsond"},body:Me.serialize(t),cv:n.cv,method:"POST"}).then((e=>e.json())).catch((e=>{r=new te._p({messageId:t.messageId,error:e.message})})).then((e=>{Pn(n,r?r.error:void 0),o(r,e)}))}function xn(e,t,n,o){let r;In(e,{headers:{"Content-Type":"application/octet-stream"},body:t,cv:n.cv,method:"POST",requestUrl:`${e.sessionUrl}/blob`}).then((e=>e.json())).catch((e=>{r=new te._p({error:e.message})})).then((e=>{Pn(n,r?r.error:void 0),o(r,e)}))}function Rn(e,t,n,o){const{sessionUrl:r}=e;let s;In(e,{cv:o.cv,method:"GET",requestUrl:t.refType===yt.J1.AlCodedLocation?`${r}/blob/${t.value}`:t.value}).then((e=>e.arrayBuffer())).then((e=>new Uint8Array(e))).catch((e=>{s=e})).then((e=>{Pn(o,s?s.message:void 0),n(s,e)}))}class Dn extends oe.EventEmitter{init(){return Promise.resolve()}sendMessage(e,t,n){}onMessage(e,t){}forceReconnect(){return Promise.resolve()}closeSession(){}sendBytes(e){}getCorrelationVector(){return new J}getNetworkWorkerManager(){}setState(e){}}var On,Nn=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},Ln=function(e){return this instanceof Ln?(this.v=e,this):new Ln(e)};!function(e){e[e.LocalWorkflow=0]="LocalWorkflow",e[e.ServerWorkflow=1]="ServerWorkflow",e[e.Submitted=2]="Submitted"}(On||(On={}));const Fn=(e,t)=>{t?(e.resultDescription=t,e.success=!1,b.tG.error(509203144,b.nh.CoreDefault,e.stop())):b.tG.info(509203143,b.nh.CoreDefault,e.stop())},Bn=e=>!e.items.some((e=>e.source&&0===e.source.indexOf("ThirdParty")));class Wn{constructor(e){var t,n;this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.apologyCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.serverAuthenticationState=mt.f.NotAuthenticated,this.sessionCloseCallbacks=new Map,this.connectCallbacks=new Map,this.reconnectCallbacks=new Map,this.disconnectCallbacks=new Map,this.sessionStateCallbackToken=0,this.workflowGraph=new Ht,this.workflowDefinitionManager=new jt,this.contextIdManager=new Jt(zt.JsClient,this.workflowGraph),this.workflowItemStorage=new en(this.workflowDefinitionManager),this.pendingConnectCallbacks=[],this.onAnnotationsSubmittedEnabled=!1,this.reduceBatchOperationsEnabled=!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=!1,this.batchMessagesEnabled=!1,this.seedingStatus=ne.e9.NotStarted,this.isChangeGateForceUserInteractiveAuth=void 0,this.onConnectTelemetryCG=void 0,this.cachedClaimsChallenge={claimsVersion:0,actionRequired:!1},this.tokenMessageVersion=1,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.batchMessagesEnabled=e.batchMessagesEnabled||!1,this.reduceBatchOperationsEnabled=e.reduceBatchOperationsEnabled||!1,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||!1,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,this.gateUtils=e.gateUtils,this.localRegisteredWorkflows=e.localRegisteredWorkflows||[],this.enableRemoteExecutionNotification=e.enableRemoteExecutionNotification||!1,this.networkMode=e.networkMode,this.egress=e.egress,this.serverAuthenticationStateChangeCallback=[],this.claimsChallengeCallback=[],this.seedingStatusChangeCallbacks=[],this.onAnnotationsSubmittedEnabled=e.onAnnotationsSubmittedEnabled||!1,this.annotationDoesNotExistOnServiceEnabled=e.annotationDoesNotExistOnServiceEnabled||!1,this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.on("serverAuthenticationStateChange",this.onServerAuthenticationStateChange.bind(this)),this.sessionManager.onMessage(te.B_.getTypeName(),this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(te.$j.getTypeName(),this.onAnnotationResultStateMessage.bind(this)),this.sessionManager.onMessage(te.Gs.getTypeName(),this.onWorkflowExecutionCompleteMessage.bind(this)),this.sessionManager.onMessage(te.Sy.getTypeName(),this.onClaimsChallengeMessage.bind(this)),this.sessionManager.onMessage(te.fr.getTypeName(),this.onSeedingStatusChangeMessage.bind(this)),e.isDeltaGeneratorEnabled&&(this.enableSyncDeltaSending=!e.disableSyncDeltaSending,this.syncDeltaTimeout=null!==(t=e.syncDeltaTimeout)&&void 0!==t?t:700,this.enableDeltaGenerator()),this.setServerAuthenticationStateChangeCallback(this.updateGraphOnAuthStateChange.bind(this)),(null===(n=this.gateUtils)||void 0===n?void 0:n.isChangeGateEnabledSync(ko))||this.setClaimsChallengeCallback(this.requestAuthTokenWithClaims.bind(this))}enabledRemoteExecutionNotification(){return this.enableRemoteExecutionNotification}getSessionReconnectParams(){if(!this.connectParams)throw new Error("Session has not been established yet.");return{sessionUrl:this.connectParams.sessionUrl,origin:this.connectParams.origin,authToken:this.connectParams.authToken,nextSyncSequenceId:this.nextSyncSequenceId}}setNextSequenceId(e){this.nextSyncSequenceId=e}tryGetDocSessionId(){if(this.clientMetadata&&this.clientMetadata.docSessionId)return this.clientMetadata.docSessionId}getSessionStateCallbackToken(e){var t;return e+"-callback-"+(null!==(t=this.tryGetDocSessionId())&&void 0!==t?t:"unknown")+"-"+this.sessionStateCallbackToken++}updateGraphOnAuthStateChange(e){this.tryActivateWorkflows()}tryActivateWorkflows(){if(this.enableRemoteExecutionNotification){const e=new L.I({operationName:"GraphServerWorkflowActivation",success:!0}).setClientMetadata(this.clientMetadata).start(),t=[];this.workflowGraph.getWorkflowNodes().filter((e=>e.location===Gt.External)).forEach((e=>{this.localWorkflowManager.canActivateWorkflow(e,this)?e.isActivated=!0:(this.localWorkflowManager.deactivateServerWorkflow(e,this),t.push(e.workflow.id))})),e.resultDescription=`deactivated workflows: [${t.join()}]`,b.tG.info(508879493,b.nh.CoreDefault,e.stop())}}initialize(){return Nn(this,void 0,void 0,(function*(){return this.localWorkflowManager&&this.localWorkflowManager.addSession(this),this.registerLocalWorkflowsWithoutGraphInit(this.localRegisteredWorkflows),this.gateUtils&&!this.onConnectTelemetryCG&&(this.onConnectTelemetryCG=yield this.gateUtils.isChangeGateEnabled("OnConnectTelemetry")),yield this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0,this.egress),this.localWorkflowManager&&this.localWorkflowManager.setTokenCallback(this.getAuthToken.bind(this)),this}))}isLocalWorkflowRegistered(e){return this.getLocalRegisteredWorkflows().some((t=>e===t.id))}get isConnected(){return!!this.connectParams}get hasConnected(){return this.hasSessionConnected}get isClosed(){return this.isSessionClosed}getServerAuthenticationState(){return this.serverAuthenticationState}getContextIdManager(){return this.contextIdManager}getWorkflowItemStorage(){return this.workflowItemStorage}getWorkflowDefinition(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)}registerLocalWorkflows(e){this.registerLocalWorkflowsWithoutGraphInit(e),this.trySendWorkflowGraphInitMessage()}registerLocalWorkflowsWithoutGraphInit(e){if(e.length&&this.localWorkflowManager)for(const t of e)this.localWorkflowManager.registerLocalWorkflow(t,this)}registerLocalWorkflow(e){this.registerLocalWorkflows([e]);const t=new L.I({operationName:"SessionRegisterLocalWorkflow",resourceId:e.id,success:!0}).setClientMetadata(this.clientMetadata).start();Fn(t)}activateAnnotation(e,t,n){var o;const r=new bt(this.sendMessageToSession.bind(this),e,t,this.annotationDoesNotExistOnServiceEnabled),s=(t,n)=>{let o=t.get(e);o||(o=new Map,t.set(e,o)),o.set(r.token,n)};(null==t?void 0:t.callback)&&s(this.annotationCallbacks,null==t?void 0:t.callback),(null==t?void 0:t.apologyCallback)&&s(this.apologyCallbacks,null==t?void 0:t.apologyCallback);const i=null!==(o=this.tokensByAnnotationType.get(e))&&void 0!==o?o:[];return-1===i.indexOf(r.token)&&i.push(r.token),this.tokensByAnnotationType.set(e,i),this.annotationActivationTrackers.set(r.token,r),this.activateAnnotationForTracker(r,{ignoreExistingAnnotations:!1,sendOnlyIfConnected:!1,sendApologies:void 0!==(null==t?void 0:t.apologyCallback)})}activateServerRequestResponse(e,t,n){return Nn(this,void 0,void 0,(function*(){yield this.activateAnnotation(e,{callback:(e,n)=>{for(const n of e.items){const e=new L.I({operationName:"ServerRequestResponseAnnotationReceived",success:!0}).setClientMetadata(this.clientMetadata).start(),o=n.body;if(!(null==o?void 0:o.workflowExecutionCorrelation)){const t="Received annotation without workflowExecutionCorrelation";throw Fn(e,t),new Error(t)}let r=!1;const s=(t,n)=>{if(r){const t="Final response has already been sent for this annotation";throw Fn(e,t),new Error(t)}r=void 0===n||n;const s=new te.iT({workflowExecutionCorrelation:o.workflowExecutionCorrelation,finalResponse:r,content:t}),i=this.submitCustomMessage(s).catch((t=>{throw Fn(e,`Error submitting response: ${t.message}`),t}));return n&&Fn(e),i};null==t||t.onAnnotationCallback(o,s).catch((t=>{Fn(e,`Error in onAnnotationCallback: ${t.message}`)}))}}},n)}))}activateAnnotationForTracker(e,t){const n=new L.I({operationName:"ActivateAnnotation",resourceId:e.annotationType,success:!0}).setClientMetadata(this.clientMetadata).start();return n.setDataField("StartTimestamp",Date.now()),e.activate(t.ignoreExistingAnnotations,t.sendOnlyIfConnected,t.sendApologies).then((o=>(n.resultSignature="Ok",n.resultDescription=`Activated annotation ${e.annotationType} with token ${e.token}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`,Fn(n),o))).catch((o=>{throw Fn(n,`error on activate annotation type ${e.annotationType}: ${o}; sendOnlyIfConnected: ${t.sendOnlyIfConnected}`),o}))}updateAnnotationConfig(e,t){const n=new te.Ol({token:e,config:t});this.sendMessageToSession(n);const o=this.annotationActivationTrackers.get(e);o&&o.options&&(o.options.config=t)}releaseAnnotation(e){const t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);const n=n=>{const o=n.get(t.annotationType);o&&(o.delete(e),0==o.size&&n.delete(t.annotationType))};return n(this.annotationCallbacks),n(this.apologyCallbacks),t.release()}return Promise.resolve(!1)}setAnnotationState(e,t,n){const o={state:n};this.submitOperation(new ie.XP({parentPath:e,items:[{id:t}],M_:o}))}setAnnotationMetadata(e,t,n){this.submitOperation(new ie.XP({parentPath:e,items:[{id:t}],M_:n}))}submitOperation(e,t){this.submitOperations([e],t)}submitOperations(e,t){var n,o;if(t||(t=this.generateCorrelationId()),et(e,t,Date.now(),"SubmitInRuntimeClient",new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.contextIdManager.applyContextIdOnOperations(e),this.updateWorkflowExecutionStates(e),!this.onAnnotationsSubmittedEnabled){const[n,o]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(n,t)}const r=e.filter(this.filterOperationsForSession.bind(this)).filter(Bn),s=[];if(this.deltaGenerator){const e=new L.I({operationName:"ExecuteDeltaGenerator",success:!0}).setClientMetadata(this.clientMetadata).start();for(const e of r)if(ie.fZ.typeGuard(e))s.push(...this.createDeltasFromUpdateOperation(e));else{const t=e;for(const r of t.items)ie.Xr.typeGuard(e)?this.deltaGenerator.addItemToLocalMap(r,t.parentPath):ie.n4.typeGuard(e)?this.deltaGenerator.deleteItemFromLocalMap(r,t.parentPath):ie.hW.typeGuard(e)&&this.deltaGenerator.moveItemsInLocalMap(e.parentPath,e.prevParentPath,null!==(o=null===(n=e.items)||void 0===n?void 0:n.map((e=>e.id)))&&void 0!==o?o:[]);s.push(e)}Fn(e)}if(this.onAnnotationsSubmittedEnabled){const[e,n]=this.partitionAnnotationOperations(s.length?s:r);this.onAnnotationsSubmitted(e,t),this.submitOperationsToSession(n,t)}else this.submitOperationsToSession(s.length?s:r,t);this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e,this,!0)}submitSeedOperations(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");if(this.networkMode===st.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);t||(t=this.generateCorrelationId()),this.allowSeed=!1,this.allowGroupSeed=!1;const[n,o]=this.partitionAnnotationOperations(e);this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(n,t):this.executeCallbacksOnAnnotationSubmitted(n,t),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?o:e,!0,t):this.sendMessageToSession(new te.Tb({cv:t,seq:0,ops:this.onAnnotationsSubmittedEnabled?o:e}))}submitSeedGroupOperations(e,t,n){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");if(this.networkMode===st.LocalWorkflowsOnly&&this.localWorkflowManager)return void this.localWorkflowManager.runLocalWorkflows(e,this);n||(n=this.generateCorrelationId()),t&&(this.allowGroupSeed=!1),this.allowSeed=!1;const[o,r]=this.partitionAnnotationOperations(e);this.executeCallbacksOnAnnotationSubmitted(o,n),this.onAnnotationsSubmittedEnabled?this.onAnnotationsSubmitted(o,n):this.executeCallbacksOnAnnotationSubmitted(o,n),this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(this.onAnnotationsSubmittedEnabled?r:e,!!t,n):(this.seedGroupSize++,this.sendMessageToSession(new te.Tb({cv:n,seq:0,ops:this.onAnnotationsSubmittedEnabled?r:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))}submitCustomMessage(e){return new Promise(((t,n)=>{this.sendMessageToSession(e,((o,s)=>{o?n(new Error(`${o.error}; for message type: ${r.h.getTypeNameFor(e)}`)):t(s)}))}))}submitLargeBinaryDataMessage(e){return new Promise(((t,n)=>{this.sendMessageToSessionPostEndpoint(e,((e,o)=>{e?n(new Error(e.error)):t(o)}))}))}submitBinaryStreamUploadMessage(e){return new Promise(((t,n)=>{const o=new L.I({operationName:"sendBinaryStreamUploadMessage",success:!0}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)xn(this.connectParams,e,o,((e,o)=>{e?n(new Error(e.error)):t(o)}));else{const r=(r=>xn(r,e,o,((e,o)=>{e?n(new Error(e.error)):t(o)}))).bind(this);this.pendingConnectCallbacks.push(r)}}))}requestBinaryDataForBlob(e){return e.data?Promise.resolve(e.data):e.dataPointer&&e.dataPointer.refType!==yt.J1.None?new Promise(((t,n)=>{this.requestBinaryDataFromSessionBlobEndpoint(e.dataPointer,((e,o)=>{e?n(e):t(o)}))})):Promise.reject(new Error("Blob does not have a data pointer"))}requestCacheDump(e){if(e)throw new Error("NYI");return this.submitCustomMessage(new te.z_)}forceReconnect(e){return this.extensionConfigs=e,this.sessionManager.forceReconnect(e)}close(e){this.isSessionClosed=!0,this.sessionManager.closeSession(e),this.localWorkflowManager&&this.localWorkflowManager.closeSession(this),this.graphInitMessageTimer&&(clearTimeout(this.graphInitMessageTimer),this.graphInitMessageTimer=void 0)}authenticateInteractive(e){return Nn(this,void 0,void 0,(function*(){if(this.gateUtils&&!this.isChangeGateForceUserInteractiveAuth&&(this.isChangeGateForceUserInteractiveAuth=yield this.gateUtils.isChangeGateEnabled("CGForceUserInteractiveAuth")),!(this.isChangeGateForceUserInteractiveAuth&&e&&e.forceUserPrompt)&&this.cachedClaimsChallenge.claimsVersion>0&&!this.cachedClaimsChallenge.actionRequired)return;const t=yield this.requestAuthTokenInteractive(this.cachedClaimsChallenge,{interactive:!0});if(te.D0.typeGuard(t))throw new Error(t.reason)}))}getClientMetadata(){return this.clientMetadata}getUserContext(){return this.userContext}setSessionCloseCallback(e){const t=this.getSessionStateCallbackToken("close");return e&&this.sessionCloseCallbacks.set(t,e),t}setConnectCallback(e){const t=this.getSessionStateCallbackToken("connect");return e&&this.connectCallbacks.set(t,e),t}setDisconnectCallback(e){const t=this.getSessionStateCallbackToken("disconnect");return e&&this.disconnectCallbacks.set(t,e),t}setReconnectCallback(e){const t=this.getSessionStateCallbackToken("reconnect");return e&&this.reconnectCallbacks.set(t,e),t}removeSessionStateCallback(e){function t(t){return!!t.has(e)&&(t.delete(e),!0)}return t(this.sessionCloseCallbacks)||t(this.reconnectCallbacks)||t(this.disconnectCallbacks)||t(this.connectCallbacks)}setServerAuthenticationStateChangeCallback(e){this.serverAuthenticationStateChangeCallback.push(e),e(this.serverAuthenticationState)}setClaimsChallengeCallback(e){this.cachedClaimsChallenge.actionRequired&&e(this.cachedClaimsChallenge),this.claimsChallengeCallback.push(e)}setSeedingStatusChangeCallback(e){e(new te.fr({newStatus:this.seedingStatus})),this.seedingStatusChangeCallbacks.push(e)}getConnectParams(){return this.connectParams}setOfflineMode(){this.sessionManager=new Dn}onAnnotationResults(e,t,n){b.tG.info(508916486,b.nh.CoreDefault,new L.I({operationName:"OnAnnotationResultsEgress",dimension0:null==e?void 0:e.annotationType,success:!0,cv:e.cv})),n(void 0,new te.YK),t===On.LocalWorkflow&&this.contextIdManager.applyContextIdOnOperations(e.ops),this.updateWorkflowExecutionStates(e.ops),this.egress&&this.egress(e,(()=>{})),this.annotationResultsProcessor.process(e,((e,n)=>{this.applyOperationForContext(e,n,t)}),((n,o)=>{const r=Date.now();this.triggerRegisteredAnnotationCallbacks(n,e.annotationType,o,e.areApologies),t===On.ServerWorkflow&&tt(e,r,"CallbackInRuntimeClient",!0,new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start())}),(e=>{if(t!==On.ServerWorkflow){const t=e.ops.filter(this.filterOperationsForSession.bind(this)).filter(Bn);this.submitOperationsToSession(t,e.cv)}this.localWorkflowManager&&this.localWorkflowManager.runLocalWorkflows(e.ops,this)}))}onAnnotationResultStateMessage(e,t){var n;t(void 0,new te.YK);for(const t of e.updates){const{annotationType:e,state:o}=t;if(!this.tokensByAnnotationType.has(e))continue;let r;r=this.annotationResultStates.has(e)?this.annotationResultStates.get(e):o===ne.K7.Idle?ne.K7.Pending:ne.K7.Idle;for(const t of this.tokensByAnnotationType.get(e)){const e=this.annotationActivationTrackers.get(t);(null===(n=e.options)||void 0===n?void 0:n.stateUpdateCallback)&&e.options.stateUpdateCallback(r,o)}}}submitOperationsToSession(e,t){t||(t=this.generateCorrelationId());const n=e.filter((e=>ie.g0.typeGuard(e))),o=e.filter((e=>!ie.g0.typeGuard(e)));if(n.length>0&&this.sendMessageToSession(new te.Tb({cv:t,ops:n})),o.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,n)=>{if(e.length){const t=new te.l0;t.messages=[],e.forEach((e=>{t.messages.push(new te.Tb({cv:e.cv,seq:this.nextSyncSequenceId++,ops:e.input}))})),this.sendMessageToSession(t,(e=>{n(e?new Error(e.error):void 0)}))}}:(e,t,n)=>{this.sendMessageToSession(new te.Tb({cv:t.cv,seq:this.nextSyncSequenceId++,ops:e}),(e=>{n(e?new Error(e.error):void 0)}))},this.batchedOperationsManager=new St(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.batchedOperationsManager.addBatchItem(o,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.sendMessageToSession(new te.Tb({cv:t,seq:this.nextSyncSequenceId++,ops:o}))}sendMessageToSession(e,t){this.sessionManager.sendMessage(e,t),te.w9.typeGuard(e)&&this.close()}sendMessageToSessionPostEndpoint(e,t){const n=new L.I({operationName:"SendLargeBinaryDataMessage",success:!0,cv:e.cv}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)Mn(this.connectParams,e,n,t);else{const o=(o=>Mn(o,e,n,t)).bind(this);this.pendingConnectCallbacks.push(o)}}requestBinaryDataFromSessionBlobEndpoint(e,t){const n=new L.I({operationName:"RequestBinaryData",success:!0,cv:(new J).toString()}).setClientMetadata(this.clientMetadata).start();if(this.connectParams)Rn(this.connectParams,e,t,n);else{const o=(o=>Rn(o,e,t,n)).bind(this);this.pendingConnectCallbacks.push(o)}}registerContextTypes(e){for(const t of e)this.activateAnnotation(t),this.registeredContextTypes.add(t)}applyOperationForContext(e,t,n){let o=r.h.getTypeNameFor(e);if(o!=ie.Xr.getTypeName()&&o!=ie.I.getTypeName()&&o!=ie.fZ.getTypeName()&&o!=ie.n4.getTypeName())return;o==ie.I.getTypeName()&&(o=ie.Xr.getTypeName());const s=Wt(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),i=Ut(s.parentPath);if(o==ie.Xr.getTypeName()||o==ie.fZ.getTypeName()){if(!s.body)return;const e=r.h.getTypeNameFor(s.body);if(!this.registeredContextTypes.has(e))return;let t=this.availableContexts.get(e);t||(t=new Map,this.availableContexts.set(e,t));let a=t.get(n);if(a||(a=[],t.set(n,a)),s.id||this.localWorkflowManager&&(s.id=this.localWorkflowManager.getNextClientAnnotationId()),o==ie.Xr.getTypeName())0==a.filter((e=>Ut(e.parentPath)==i&&e.id==s.id)).length?a.push(s):b.tG.info(540848911,b.nh.CoreDefault,`AddOperation for (${n}, ${s.id}, ${s.source}) can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead.`);else for(let e=0;e<a.length;e++)if(a[e].id==s.id&&Ut(a[e].parentPath)==i){if(a[e].source==s.source){a[e]=s;break}b.tG.warn(540848912,b.nh.CoreDefault,`UpdateOperation for (${n}, ${s.id}, ${s.source}) can't be applied as the context item with provided path and ID has different source: ${a[e].source}`)}else b.tG.warn(540848913,b.nh.CoreDefault,`UpdateOperation for (${n}, ${s.id}, ${s.source}) can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead`)}else if(o==ie.n4.getTypeName()){if(!s.id)return;this.availableContexts.forEach(((e,t)=>{let o=e.get(n);o&&(o=o.filter((e=>!(Ut(e.parentPath)==i&&e.id==s.id))),0==o.length?e.delete(n):e.set(n,o),0==e.size?this.availableContexts.delete(t):this.availableContexts.set(t,e))}))}}updateWorkflowExecutionStates(e){if(this.localWorkflowManager){const t=this.enableRemoteExecutionNotification?this.workflowGraph.getWorkflowNodes().map((e=>e.workflow)):this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this);for(const n of e)if(Qt.has(r.h.getTypeNameFor(n)))for(const e of n.items)for(const n of t||[])this.localWorkflowManager.preProcessItemToWorkflow(n,e,this)}}resolveRequestedContexts(e){const t=[];for(const[n,o,r]of Ft(e.requestedContextTypesRules)){if(!this.availableContexts.has(n)){if(o==Et.Required)return[!1,[]];continue}const e=Array.from(this.availableContexts.get(n).values()).reduce(((e,t)=>e.concat(t)),[]);if(0==e.length)throw new Error(`Assert: availableContexts have the entry for ${n} which does not contain any context annotation.`);t.push(...e)}return[!0,this.removeDuplicatedContextItems(t)]}removeDuplicatedContextItems(e){return e.filter(((e,t,n)=>n.findIndex((t=>ce.deepEquals(t,e)))===t))}getContextAnnotations(e,t,n,o){var r,s;const i=n?Ut(n):void 0;return null===(s=null===(r=this.availableContexts.get(e))||void 0===r?void 0:r.get(t))||void 0===s?void 0:s.filter((e=>!(i&&Ut(e.parentPath)!=i||o&&e.source!=o)))}onWorkflowDefinitionOverrideMessage(e){const t=new L.I({operationName:"WorkflowDefinitionOverride",success:!0}).setClientMetadata(this.clientMetadata).start(),n=e=>{throw Fn(t,e),Error(`WorkflowDefinitionOverride: ${e}`)};if(!this.localWorkflowManager)return void n("Not supported by this local SessionProxy instance.");const o=this.localWorkflowManager.getWorkflowDefinitionsByName(this),r=o.get(e.sourceWorkflowId);if(!r)return void n(`Workflow registration for source workflow '${e.targetWorkflowId}' was not found.`);t.resourceId=r.id;const s=o.get(e.targetWorkflowId);s&&(s.allowDefinitionOverride?r.definitionOverrideTargetWorkflows&&-1!==r.definitionOverrideTargetWorkflows.indexOf(s.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(s,e.definition,e.contextId),t.resultDescription=`Updated config for workflow: ${e.targetWorkflowId}, context id: ${e.contextId}`,Fn(t)):n(`Workflow '${r.id}' does not allow workflow definition for workflow '${s.id}'.`):n(`Workflow '${s.id}' does not allow workflow definition override.`))}applyContextIdOnOperations(e){this.contextIdManager.applyContextIdOnOperations(e)}attachToWorkflowGraph(e){this.addToWorkflowGraph(e),this.attachExecutionTrackerToEachWorkflow()}triggerRegisteredAnnotationCallbacks(e,t,n,o){if(this.callAnnotationCallbacks(e,t,n,o),this.hostCallbacks.onAnnotationResult)try{o?this.hostCallbacks.onApologyResult&&this.hostCallbacks.onApologyResult(e,n):this.hostCallbacks.onAnnotationResult(e,n)}catch(e){b.tG.error(540301151,b.nh.CoreDefault,new L.I({operationName:"HostCallbackOnAnnotationResultError",dimension0:t,resultDescription:`onAnnotationResult error: ${e}`}))}}attachExecutionTrackerToEachWorkflow(){this.localWorkflowManager&&this.localWorkflowManager.attachExecutionTrackerToEachWorkflow(this.workflowGraph,this,this.onWorkflowExecutionComplete.bind(this))}onWorkflowExecutionCompleteMessage(e,t){t(void 0,new te.YK),this.localWorkflowManager&&this.localWorkflowManager.onExternalWorkflowExecuted(e.contextId,e.workflowId,this)}onWorkflowExecutionComplete(e,t){}enableDeltaGenerator(){var e,t;this.deltaGenerator=null!==(e=this.deltaGenerator)&&void 0!==e?e:new _n,this.syncDeltaTimers=null!==(t=this.syncDeltaTimers)&&void 0!==t?t:new Map}createDeltasFromUpdateOperation(e){var t,n;const o=[];b.tG.info(523776396,b.nh.CoreDefault,`Calling delta create for UpdateOperation under parent path [${e.parentPath}] (${null===(t=e.items)||void 0===t?void 0:t.length} item(s), first item id: ${(null===(n=e.items)||void 0===n?void 0:n.length)>0?e.items[0].id:"(no items)"})`);let r=[...e.parentPath];for(const t of e.items){const n=[],s=this.deltaGenerator.createTextTileDeltasFromItem(t,e.parentPath);if(null==s?void 0:s.length){for(const o of s){const s=Cn();r=[...e.parentPath,t.id];const i={id:s,revId:t.revId,body:o,contextId:t.contextId,source:t.source};n.push(i)}n.length>0&&(o.push(new ie.xU({parentPath:r,items:n})),this.enableSyncDeltaSending&&this.setupSyncDeltaAfterDelay(t,r,n))}else b.tG.info(523329632,b.nh.CoreDefault,`Failed to create delta on item ${t.id}`)}return o}setupSyncDeltaAfterDelay(e,t,n){var o,r,s;const i=this.syncDeltaTimers.get(e.id);i&&(clearTimeout(i),this.syncDeltaTimers.delete(e.id));const a=n.find((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.unit)===Xt.Chars}));if(a){const n=a.body,i={content:"",deltaType:Yt.Update,length:0,position:(null!==(o=null==n?void 0:n.position)&&void 0!==o?o:0)+(null!==(s=null===(r=null==n?void 0:n.content)||void 0===r?void 0:r.length)&&void 0!==s?s:0),unit:Xt.Sentence},l=nn.typeGuard(e.body)?new hn(i):new dn(i),c={id:Cn(),revId:e.revId,body:l,contextId:e.contextId,source:e.source},u=new ie.xU({parentPath:t,items:[c]}),d=setTimeout(((e,t)=>{this.submitOperation(e),this.syncDeltaTimers.delete(t)}),this.syncDeltaTimeout,u,e.id);this.syncDeltaTimers.set(e.id,d)}}addToWorkflowGraph(e){this.workflowGraph.addWorkflow($t(e))}getAnnotations(e,t){var n,o,r;const s=null!==(n=e.cv)&&void 0!==n?n:this.sessionManager.getCorrelationVector().newChild().toString(),i=new L.I({operationName:"GetAnnotations",success:!0,resultSignature:"GetAnnotationsEntry",resourceId:`${e.sourceInfo.featureId}-${e.sourceInfo.entryPoint}`,cv:s}).setClientMetadata(this.clientMetadata).start();i.setDataFields({AnnotationType:null===(o=e.annotationType)||void 0===o?void 0:o.toString(),MaxDelayMs:null===(r=e.maxDelayMs)||void 0===r?void 0:r.toString()});const a=new Ve({annotationTypes:e.annotationType,transientItems:e.transientItems,configs:e.configs,maxDelayMs:e.maxDelayMs,sourceInfo:e.sourceInfo,caller:it.Client,tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,correlationInfo:{cvString:s},cv:s}),l=[];let c;Fn(i),this.sendMessageToSession(a,((e,n)=>{(null==t?void 0:t.IsCancellationRequested)||(l.push({error:e,response:n}),null==c||c(!0))}));const u=this;let d=!1;const h=new Promise(((e,n)=>{null==t||t.onCancel((t=>{d?e():n(new Error(Wn.requestCancelledError))}))}));return{[Symbol.asyncIterator](){var e,n,o,r,s,a,p;return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),s=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){r[e]&&(o[e]=function(t){return new Promise((function(n,o){s.push([e,t,n,o])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof Ln?Promise.resolve(n.value.v).then(l,c):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,(function*(){for(;!d;)try{0===l.length&&(yield Ln(Promise.race([new Promise((e=>c=e)),h]))),i.resultSignature="AnnotationReceived";const f=l.shift();if(null==t?void 0:t.IsCancellationRequested)throw new Error(Wn.requestCancelledError);d=(null===(e=f.response)||void 0===e?void 0:e.finalResponse)||void 0!==f.error,i.setDataField("FinalResponse",d);const g=Ze(f.response);let m,y,v;if(i.setDataField("FirstUserPerceivedResponse",g),f.error){const e=`ErrorCode: ${f.error.code}, Error: ${f.error.error}, Retryable: ${f.error.retryable}`;i.setDataField("ServerError",e),v=f.error.error,m={serviceError:[{code:ne.Qn.ServerError,error:f.error.error,retryable:null==u?void 0:u.canBeRetried(f.error)}]}}else if((null===(o=null===(n=f.response)||void 0===n?void 0:n.errorInfo)||void 0===o?void 0:o.length)>0){const e=f.response.errorInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");i.setDataField("WorkflowErrors",e),v="Workflow execution error",m={serviceError:f.response.errorInfo}}else i.resultDescription="OK";if((null===(s=null===(r=f.response)||void 0===r?void 0:r.warningInfo)||void 0===s?void 0:s.length)>0){y={serviceError:f.response.warningInfo};const e=f.response.warningInfo.map((e=>`ErrorCode: ${e.code}, Error: ${e.error}, Retryable: ${e.retryable}, ResourceId: ${e.resourceId}`)).join("\n");i.setDataField("WorkflowWarnings",e)}Fn(i,v),yield yield Ln({content:null===(a=f.response)||void 0===a?void 0:a.content,error:null!=m?m:void 0,warning:null!=y?y:void 0,finalResponse:null===(p=f.response)||void 0===p?void 0:p.finalResponse})}catch(e){const t=e.message===Wn.requestCancelledError?ne.zy.RequestCancelled:ne.zy.Unknown;i.setDataField("ClientError",`ErrorCode: ${t}, Error: ${e.message}`),Fn(i,null==e?void 0:e.message),yield yield Ln({content:void 0,error:{clientError:{code:t,error:null==e?void 0:e.message}}}),d=!0;break}}))}}}isHttpFallback(){const e=this.sessionManager.getNetworkWorkerManager();return!(!e||e.getInitNetworkMode()!==st.JSWebSockets||e.getNetworkMode()!==st.HttpFallback)}canBeRetried(e){return(null==e?void 0:e.code)===ne.xv.TooManyRequests||(null==e?void 0:e.code)===ne.xv.RequestTimeout||e.error.includes(ee.Ef.ClientDisconnected)}getAuthToken(e,t){const n={Tickets:[]};this.clientMetadata.docSessionId&&(n.DocSessionId=this.clientMetadata.docSessionId);const o=(e=>{if(e===Lt.OY.Substrate)return ut.Substrate})(e);o&&(n.TokenType=o),this.hostCallbacks.requestAuthToken(n).then((n=>{var o;if(!n)throw new Error("Missing AuthTokenResponse from requestAuthToken");if(!n.Token)throw new Error("Missing Token from requestAuthToken");t(void 0,n.Token,{returnedTokenType:e,timeToLiveSec:null===(o=n.TokenProperties)||void 0===o?void 0:o.timeToLiveSec})})).catch((e=>{t(e)}))}resetNextSyncSequenceId(){this.nextSyncSequenceId=1}onReconnect(){if(this.annotationActivationTrackers.forEach((e=>{var t;this.activateAnnotationForTracker(e,{ignoreExistingAnnotations:!0,sendOnlyIfConnected:!0,sendApologies:void 0!==(null===(t=e.options)||void 0===t?void 0:t.apologyCallback)}).catch((()=>{}))})),this.reconnectCallbacks.forEach(((e,t)=>{e()})),!this.connectParams)throw new Error("Expected onConnect before onReconnect")}onSessionClose(e){this.isSessionClosed=!0,this.connectParams=void 0,this.sessionCloseCallbacks.forEach(((t,n)=>{t(e)}))}onConnect(e,t,n,o,r,s,i){const a=new L.I({operationName:"OnConnect",success:!0}).setClientMetadata(this.clientMetadata).start();a.setDataField("HasSessionConnected",this.hasSessionConnected),a.setDataField("IsSeedingRequired",e),a.setDataField("SeedingStatus",this.seedingStatus);let l=!1;e&&(this.hasSessionConnected&&(this.allowSeed=!0,this.allowGroupSeed=!0,l=this.changeSeedingStatus(ne.e9.NotStarted,"ReconnectReset",!1),this.seedGroupSize=0,this.batchedSeedMessageGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0)),this.cachedClaimsChallenge=Object.assign(Object.assign({},this.cachedClaimsChallenge),{claimsVersion:0})),this.enableRemoteExecutionNotification&&!this.hasSessionConnected&&this.addDownstreamWorkflowsIntoClientGraph(s),this.connectParams={isSeedingRequired:e,sessionUrl:t,origin:n,authToken:o,routingSessionKey:i},this.hasSessionConnected=!0,this.tryActivateWorkflows();for(const e of this.pendingConnectCallbacks)e(this.connectParams);this.connectCallbacks.forEach(((r,s)=>{r(e,t,n,o,i)})),l&&this.triggerSeedingStatusChangeCallbacks(),this.serverInputTypes=r,this.onConnectTelemetryCG&&Fn(a)}onDisconnect(e){this.connectParams=void 0,this.disconnectCallbacks.forEach(((t,n)=>{t(e)}))}onSeedingStatusChangeMessage(e,t){t(void 0,new te.YK),this.changeSeedingStatus(e.newStatus,"SeedingStatusChangeMessage")}changeSeedingStatus(e,t,n=!0){const o=new L.I({operationName:"SeedingStatusChange",success:!0}).setClientMetadata(this.clientMetadata).start();return o.setDataField("Status",ne.e9[e]),o.setDataField("Reason",t),Fn(o),this.seedingStatus!=e&&(this.seedingStatus=e,n&&this.triggerSeedingStatusChangeCallbacks(),!0)}triggerSeedingStatusChangeCallbacks(){this.seedingStatusChangeCallbacks.forEach((e=>{e(new te.fr({newStatus:this.seedingStatus}))}))}onServerAuthenticationStateChange(e){if(e!=this.serverAuthenticationState){if(this.serverAuthenticationState==mt.f.Authenticated&&e==mt.f.Pending)return;const t=new L.I({operationName:"ServerAuthStateChange",dimension0:mt.f[e],dimension1:mt.f[this.serverAuthenticationState],success:!0}).setClientMetadata(this.clientMetadata).start();t.resultDescription=`Changing Server Authentication State newState: ${mt.f[e]}, previousState: ${mt.f[this.serverAuthenticationState]}`,Fn(t),this.serverAuthenticationState=e;for(const e of this.serverAuthenticationStateChangeCallback)e(this.serverAuthenticationState)}}callAnnotationCallbacks(e,t,n,o){if(0===this.annotationCallbacks.size&&0===this.apologyCallbacks.size)return;const r=o?this.apologyCallbacks.get(t):this.annotationCallbacks.get(t);r&&r.forEach((t=>{t(e,n)}))}getOperationBatchConfig(e){let t;return t=this.batchMessagesEnabled?e=>({input:e,demultiplex:()=>[[]]}):e=>({input:e.filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),demultiplex:()=>[[]]}),{delayMs:e.delayMs,delayMsMax:e.delayMsMax,maxInputSize:e.maxInputSize,estimateSize:kn,groupingKeyExtractor:()=>"operations",multiplex:t,split:e=>{if(!(e.length<=1))return{inputs:e.reduce(((e,t)=>(e.push([t]),e)),[]),join:()=>[]}}}}sendSeedMessagesViaBatchManager(e,t,n){if(!this.seedBatchedOperationsManager){let e;e=this.batchMessagesEnabled?(e,t,n)=>{if(this.batchedSeedMessageGroupSize+=e.length,e.length){const o=new te.l0;o.messages=[],e.forEach((e=>{o.messages.push(new te.Tb({cv:e.cv,seq:0,ops:e.input,groupId:"Seed",groupSize:t.groupComplete?this.batchedSeedMessageGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}))})),this.sendMessageToSession(o,(e=>{n(e?new Error(e.error):void 0)}))}}:(e,t,n)=>{this.seedGroupSize++,this.sendMessageToSession(new te.Tb({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?this.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(e=>{n(e?new Error(e.error):void 0)}))},this.seedBatchedOperationsManager=new St(e,this.reduceBatchOperationsEnabled,this.batchMessagesEnabled,void 0,this.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled)}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},n,t)}onAnnotationResultsFromServer(e,t){tt(e,Date.now(),"ReceiveFromNetwork",!0,new L.I({operationName:"AugloopClientPerfTracker",success:!0}).setClientMetadata(this.clientMetadata).start()),this.onAnnotationResults(e,On.ServerWorkflow,t)}getLocalRegisteredWorkflows(){return this.localWorkflowManager?this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((e=>$t(e))):[]}sendWorkflowGraphInitMessage(){const e=this.getLocalRegisteredWorkflows(),t=new L.I({operationName:"WorkflowGraphInit",success:!0}).setClientMetadata(this.clientMetadata).start(),n=new te.TV({upstreamRuntimeWorkflows:e});this.sendMessageToSession(n,((n,o)=>{n?Fn(t,n.error):(t.resultDescription=`local workflows: ${e.map((e=>e.id))}, remote workflows: ${o.downstreamRuntimeWorkflows.map((e=>e.id))}`,Fn(t),this.onWorkflowGraphInitResponse(o))}))}trySendWorkflowGraphInitMessage(){!this.graphInitMessageTimer&&this.enableRemoteExecutionNotification&&(this.graphInitMessageTimer=setTimeout((()=>{this.graphInitMessageTimer=void 0,this.sendWorkflowGraphInitMessage()}),10))}onWorkflowGraphInitResponse(e){this.addDownstreamWorkflowsIntoClientGraph(e.downstreamRuntimeWorkflows),this.tryActivateWorkflows()}addDownstreamWorkflowsIntoClientGraph(e){this.workflowGraph.removeWorkflows(!0);for(const t of e||[])this.workflowGraph.addWorkflow(t,!0);this.attachExecutionTrackerToEachWorkflow()}resolvePlaceholdersInOperationParentPath(e){let t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(b.tG.info(540848914,b.nh.CoreDefault,`Replacing user context placeholder for: ${Ut(e)}.`),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(b.tG.info(540848915,b.nh.CoreDefault,`Replacing tenant context placeholder for: ${Ut(e)}.`),t=["session","#tenantContext#"]),t}filterOperationsForSession(e){return((e,t)=>{if(!Array.isArray(t)||0===t.length)return!0;if(ie.xU.typeGuard(e)||ie.XP.typeGuard(e))return!0;for(const n of e.items)if(!n.body||r.h.matchesTypesFor(n.body,t))return!0;return!1})(e,this.serverInputTypes)}executeCallbacksOnAnnotationSubmitted(e,t){const{annotationOpsMap:n,apologyOpsMap:o}=this.getAnnotationOperationsByType(e);n.forEach(((e,n)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,n,t,!1)))})),o.forEach(((e,n)=>{Array.from(e).forEach((e=>this.triggerRegisteredAnnotationCallbacks(e,n,t,!0)))}))}partitionAnnotationOperations(e){return e.reduce((([e,t],n)=>n.items.some((e=>e.body&&re.YH.typeGuard(e.body)))?[[...e,n],t]:[e,[...t,n]]),[[],[]])}onAnnotationsSubmitted(e,t){const{annotationOpsMap:n,apologyOpsMap:o}=this.getAnnotationOperationsByType(e);n.forEach(((e,n)=>{const o=Array.from(e);this.onAnnotationResults(new te.B_({annotationType:n,ops:o,cv:t,areApologies:!1}),On.Submitted,(()=>{}))})),o.forEach(((e,n)=>{const o=Array.from(e);this.onAnnotationResults(new te.B_({annotationType:n,ops:o,cv:t,areApologies:!0}),On.Submitted,(()=>{}))}))}getAnnotationOperationsByType(e){const t=new Map,n=new Map;for(const o of e)for(const e of o.items)if(e.body&&re.YH.typeGuard(e.body)){const s=(e,t)=>{const n=e.get(t)||new Set;n.add(o),e.set(t,n)};vt.k$.typeGuard(e.body)?s(n,e.body.annotationTypeName):s(t,r.h.getTypeNameFor(e.body))}return{annotationOpsMap:t,apologyOpsMap:n}}onClaimsChallengeMessage(e,t){var n;const o=new L.I({operationName:"OnClaimsChallengeMessage",dimension0:e.claimsVersion.toString(),dimension1:e.error,success:!0}).setClientMetadata(this.clientMetadata).start(),r=e.claims&&e.claims.length>0;o.resultSignature=`HasClaims: ${r}`,o.resultDescription="Received Claims Challenge Message from Server",Fn(o),e.claimsVersion>this.cachedClaimsChallenge.claimsVersion&&(this.cachedClaimsChallenge=Object.assign(Object.assign({},e),{actionRequired:!0})),(null===(n=this.gateUtils)||void 0===n?void 0:n.isChangeGateEnabledSync(ko))?this.requestAuthTokenInteractive(e).then((e=>{te.D0.typeGuard(e)&&this.invokeClaimsChallengeCallbacks()})).catch((()=>{})):this.invokeClaimsChallengeCallbacks(),t(void 0,new te.YK)}generateCorrelationId(){return this.sessionManager.getCorrelationVector().newChild().toString()}onTokenProvisionResponse(e){e&&this.onServerAuthenticationStateChange(mt.f.Authenticated)}invokeClaimsChallengeCallbacks(){for(const e of this.claimsChallengeCallback)e(this.cachedClaimsChallenge)}requestAuthTokenWithClaims(e){this.requestAuthTokenInteractive(e).catch((()=>{}))}requestAuthTokenInteractive(e,t){var n;const o=new L.I({operationName:"RequestAuthTokenInteractive",success:!0,dimension0:`isInteractive: ${null!==(n=null==t?void 0:t.interactive)&&void 0!==n&&n}`}).start();o.dimension1=`HasClaims: ${!!e.claims&&e.claims.length>0}`;const r={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:ut.Augloop,ConnectParams:this.connectParams,Claims:e.claims,Interactive:null==t?void 0:t.interactive};return this.hostCallbacks.requestAuthToken(r).then((t=>{if(!t)throw new Error("Missing AuthTokenResponse from requestAuthToken claims");if(!t.Token)throw new Error("Missing Token from requestAuthToken claims");return o.resultSignature="Token",new te.kd({authToken:t.Token,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion})})).catch((t=>(o.resultSignature="NoToken",o.dimension2=t.message,new te.D0({reason:t.message,version:++this.tokenMessageVersion,claimsVersion:e.claimsVersion,clientHandlesResponse:!0})))).then((e=>new Promise(((t,n)=>{this.sendMessageToSession(e,((r,s)=>{Fn(o,null==r?void 0:r.error),r?n(new Error(r.error)):(te.kd.typeGuard(e)&&(this.cachedClaimsChallenge.actionRequired=!1,this.onTokenProvisionResponse(s)),t(e))}))}))))}ensureConnection(){return Promise.resolve()}keepAlive(){}}Wn.requestCancelledError="Request cancelled";class Un{}var Gn;!function(e){e[e.Anonymous=0]="Anonymous",e[e.Host=1]="Host"}(Gn||(Gn={}));class Hn{constructor(){this.timers=new Map}scheduleRefresh(e,t,n,o){let r=this.timers.get(e);r||(r={numberOfAttempts:0},this.timers.set(e,r)),r.refreshTimeoutId&&(clearTimeout(r.refreshTimeoutId),r.refreshTimeoutId=void 0),r.expiredTimeoutId&&(clearTimeout(r.expiredTimeoutId),r.expiredTimeoutId=void 0);let s=1e3*t-Hn.tokenRefreshBufferMs,i=1e3*t-Hn.tokenExpirationBufferMs;s>0?r.numberOfAttempts=0:(++r.numberOfAttempts,s=Hn.tokenRefreshBackoffIntervalMs,i=Hn.tokenExpirationBufferMs),r.numberOfAttempts<=Hn.tokenRefreshMaximumAttempts&&(r.refreshTimeoutId=setTimeout((()=>{n()}),s)),o&&(r.expiredTimeoutId=setTimeout((()=>{o()}),i))}clearRefreshTimeouts(){this.clearTimeouts(!1)}clearAllTimeouts(){this.clearTimeouts(!0)}clearTimeouts(e){this.timers.forEach(((t,n)=>{t.refreshTimeoutId&&(clearTimeout(t.refreshTimeoutId),t.refreshTimeoutId=void 0),e&&t.expiredTimeoutId&&(clearTimeout(t.expiredTimeoutId),t.expiredTimeoutId=void 0),t.expiredTimeoutId||this.timers.delete(n)}))}}Hn.tokenRefreshBufferMs=24e4,Hn.tokenExpirationBufferMs=12e4,Hn.tokenRefreshBackoffIntervalMs=3e4,Hn.tokenRefreshMaximumAttempts=3;class qn extends oe.EventEmitter{constructor(e,t,n,o,r){if(super(),this.getSessionStats=e,this.clientMetadata=t,this.tokenRefreshManager=n,this.sendMessage=o,this.options=r||{},this.options.overrideSessionInitMessage=this.options.overrideSessionInitMessage||(e=>e),this.clientMetadata&&!this.clientMetadata.userSystemTimezone)try{this.clientMetadata.userSystemTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(e){}}initSession(e){e.onResponse=e.onResponse||(()=>{});const t=ce.getCurrentTimeMs(),n=this.getSessionStats().lastConnectionClose&&t-this.getSessionStats().lastConnectionClose,o=this.getSessionStats().lastSyncMessage&&t-this.getSessionStats().lastSyncMessage,r=new L.I({operationName:"SessionInit"}).start(),s={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:n,timeSinceLastSyncMessage:o,isTokenRefresh:e.isTokenRefresh,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,error:void 0,isSeedingRequired:void 0,enableCreateBlobStorageContainer:this.options.createBlobStorageContainerEnabled},i=this.options.overrideSessionInitMessage(new te.eE({protocolVersion:ne.mH,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0,enableRemoteExecutionNotification:this.options.enableRemoteExecutionNotification,createBlobStorageContainer:this.options.createBlobStorageContainerEnabled}));this.sendMessage(i,((t,n)=>{if(r.success=!t,r.resultSignature=this.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",r.resourceId=H(null==n?void 0:n.sliceUrl),r.setClientMetadata(this.clientMetadata),(null==n?void 0:n.sessionKey)&&s.sessionKey!==n.sessionKey&&(s.sessionKey=n.sessionKey),t&&(s.error=t.error),s.isSeedingRequired=this.sessionKey!==(null==n?void 0:n.sessionKey),r.resultDescription=JSON.stringify(s),b.tG.info(508843779,b.nh.CoreDefault,r.stop()),e.onResponse(t,n),t)this.emit("serverAuthenticationStateChange",mt.f.NotAuthenticated);else if(e.isReconnectOnSameSlice&&n.forceReconnect)this.emit("serverAuthenticationStateChange",mt.f.NotAuthenticated);else{if(!n.anonymousToken||!n.tokenExpirationSeconds)return this.emit("serverAuthenticationStateChange",mt.f.NotAuthenticated),void b.tG.error(508843778,b.nh.CoreDefault,"AL Anonymous token was not generated for the session");this.anonymousToken=n.anonymousToken,this.onSuccessfulSessionInitOnServerSide(n)}}))}onSuccessfulSessionInitOnServerSide(e){var t,n;this.tokenRefreshManager.scheduleRefresh(Gn.Anonymous,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(()=>{this.anonymousToken=void 0})),this.connectParams={isSeedingRequired:this.sessionKey!==e.sessionKey,sessionUrl:`${e.sessionUrlBase}/${e.sessionKey}`,origin:e.origin,authToken:this.anonymousToken},(null===(t=this.options)||void 0===t?void 0:t.dontSendTokenOnReconnectChangeGate)&&e.existingTokenProvisionResponse&&(null===(n=e.existingTokenProvisionResponse)||void 0===n?void 0:n.tokenType)===Lt.OY.AugLoopLowPrivilege||(this.options.sendTokenFailureMessageChangeGate?this.initHostAuthTokenNew().catch((()=>{})):this.initHostAuthToken());const o=!!this.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",this.connectParams.isSeedingRequired,o,this.connectParams.sessionUrl,this.connectParams.origin,this.connectParams.authToken,e.workflowInputTypes,e.downstreamRuntimeWorkflows,e.routingSessionKey),o&&this.emit("reconnect")}getAuthToken(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:ut.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e)).catch((()=>{}))}getAuthTokenNew(){const e={Tickets:[],DocSessionId:this.clientMetadata.docSessionId,TokenType:ut.Augloop,ConnectParams:this.connectParams};return this.options.requestAuthToken(e).then((e=>e))}getAuthTokenTimeoutPromise(){const e=this.options.authTokenTimeoutMs;return new Promise(((t,n)=>{setTimeout((()=>{n(new Error(`Host auth token provision took longer than ${e} ms`))}),e)}))}initHostAuthToken(){const e=this.getAuthToken.bind(this);if(this.options.requestAuthToken&&e){const t=new L.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();e().then((e=>{if(e){if(!e.Token)return e.TokenError==dt.TokenMissingInteractionRequired?(this.emit("serverAuthenticationStateChange",mt.f.TokenMissingInteractionRequired),t.resultDescription="Host auth token provision failed interaction required"):(this.emit("serverAuthenticationStateChange",mt.f.NotAuthenticated),t.resultDescription="Host auth token provision failed"),t.success=!1,void b.tG.info(508843777,b.nh.CoreDefault,t.stop());b.tG.info(508843776,b.nh.CoreDefault,t.stop()),this.sendTokenProvisionMessage(e.Token)}else t.resultDescription="TokenResponse is not set"})).catch((e=>{this.emit("serverAuthenticationStateChange",mt.f.NotAuthenticated),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`,b.tG.error(508843747,b.nh.CoreDefault,t.stop())}))}}initHostAuthTokenNew(){return e=this,t=void 0,o=function*(){const e=this.getAuthTokenNew.bind(this);if(this.options.requestAuthToken&&e){const t=new L.I({operationName:"RefreshAuthToken",success:!0}).setClientMetadata(this.clientMetadata).start();let n,o,r=mt.f.NotAuthenticated;try{if(n=this.options.authTokenTimeoutMs>0?yield Promise.race([e(),this.getAuthTokenTimeoutPromise()]):yield e(),!n)throw new Error("TokenResponse is not set");if(!n.Token)throw n.TokenError==dt.TokenMissingInteractionRequired?(r=mt.f.TokenMissingInteractionRequired,new Error("Host auth token provision failed interaction required")):new Error("Host auth token provision failed")}catch(e){o=e.message,this.emit("serverAuthenticationStateChange",r),t.success=!1,t.resultDescription=`Error happened while attempting to fetch host token: ${e}`}try{o?this.sendMessage(new te.D0({reason:o,version:qn.initialTokenVersion,clientHandlesResponse:!0})):this.sendTokenProvisionMessage(n.Token)}catch(e){o||(o=e.message,this.emit("serverAuthenticationStateChange",r),t.success=!1,t.resultDescription=`Error happened while attempting to send host token: ${e}`)}finally{o?b.tG.error(506074845,b.nh.CoreDefault,t.stop()):b.tG.info(506074846,b.nh.CoreDefault,t.stop())}}},new((n=void 0)||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}));var e,t,n,o}sendTokenProvisionMessage(e){const t=new te.kd({authToken:e,version:qn.initialTokenVersion});this.emit("serverAuthenticationStateChange",mt.f.Pending),this.sendMessage(t,this.onTokenProvisionResponse.bind(this),!0)}onTokenProvisionResponse(e,t){!e&&t&&t.tokenExpirationSeconds?(this.emit("serverAuthenticationStateChange",mt.f.Authenticated),this.tokenRefreshManager.scheduleRefresh(Gn.Host,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))):this.emit("serverAuthenticationStateChange",mt.f.NotAuthenticated)}}qn.initialTokenVersion=1;var $n,Vn=n(65512),jn=n(87214);!function(e){e[e.JoinContext=0]="JoinContext",e[e.Session=1]="Session"}($n||($n={})),Error;var zn={util:{},roots:{default:{}}},Qn=(zn.util,zn.roots.default||(zn.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e.prototype.traceId="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/AnnotationMetaDataChangeEvent"},e}());class Jn extends Qn{constructor(e){super(e),this.eventName="AnnotationMetaDataChange"}}class Kn{constructor(e){this.item=e,this.operation=e.op,this.delta=e.delta,this.deltas=e.deltas,this.id=Ut(this.itemPath),this.revId=e.revId}get itemPath(){return[...this.item.parentPath,this.item.id]}getModelIterator(){throw new Error("Method not implemented.")}getBody(){return this.item.body}getItemReference(){throw new Error("Method not implemented.")}getParentItem(e){throw new Error("Method not implemented.")}getParentItemBody(e){throw new Error("Method not implemented.")}getPrevItem(e,t){throw new Error("Method not implemented.")}getPrevItemBody(e,t){throw new Error("Method not implemented.")}getNextItem(e,t){throw new Error("Method not implemented.")}getNextItemBody(e,t){throw new Error("Method not implemented.")}getChildItem(e){throw new Error("Method not implemented.")}getChildItemBody(e){throw new Error("Method not implemented.")}getChildItems(e){throw new Error("Method not implemented.")}getChildItemBodies(e){throw new Error("Method not implemented.")}getSubtreeItem(e){throw new Error("Method not implemented.")}getSubtreeItemBody(e){throw new Error("Method not implemented.")}getSubtreeItems(e){throw new Error("Method not implemented.")}getSubtreeItemBodies(e){throw new Error("Method not implemented.")}getContextItem(e){throw new Error("Method not implemented.")}getContextItemBody(e){throw new Error("Method not implemented.")}getContextItems(e){throw new Error("Method not implemented.")}getContextItemBodies(e){throw new Error("Method not implemented.")}addAnnotation(e,t){throw new Error("Method not implemented.")}updateAnnotation(e,t){throw new Error("Method not implemented.")}deleteAnnotation(e){throw new Error("Method not implemented.")}loadSubtree(e){throw new Error("Method not implemented.")}getSourceTimestamp(){return this.item.sourceTimestamp}getContextId(){return this.item.contextId}}class Yn{constructor(e,t=[]){this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=e=>{if(!e)return e=>void 0!==e;if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return t=>t&&r.h.matchesTypesFor(t.body,[e.itemType]);if(e.itemTypes)return t=>t&&r.h.matchesTypesFor(t.body,e.itemTypes);throw new Error("Not implemented yet")},this.items=[...t,e],this.scopeItem=new Kn(e)}getItem(e){throw new Error("Method not implemented.")}getItems(e){throw new Error("Method not implemented.")}getItemBody(e){return this.getItemBodies(e)[0]}getItemBodies(e){const t=this.normalizeFilter(e);return this.items.filter(t).map((e=>e.body))}getItemByReference(e){throw new Error("Method not implemented.")}getItemBodyByReference(e){throw new Error("Method not implemented.")}}const Xn=[Yt.CursorUpdate,Yt.FormattingUpdate,Yt.OtherNonContentUpdate,Yt.AttributionUpdate];function Zn(e,t,n){const o=new L.I({operationName:"ApplyTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();try{if(!t)return o.success=!1,o.resultDescription="Unable to apply text tile delta, parent tile is undefined",void b.tG.info(538798173,b.nh.CoreDefault,o.stop());if(r.h.getTypeNameFor(t)!==tn.getTypeName())return o.success=!1,o.resultDescription=`Unable to apply text tile delta, parent tile is not proper type: expected ${dn.getTypeName()}, received ${r.h.getTypeNameFor(t)}`,void b.tG.info(538798174,b.nh.CoreDefault,o.stop());const n=e,s=t.content;let i="";if(void 0===n.position||n.position<0)return o.success=!1,o.resultDescription="Unable to apply text tile delta, invalid text tile position",void b.tG.info(538798175,b.nh.CoreDefault,o.stop());switch(n.deltaType){case Yt.Add:i=n.position<s.length?`${s.slice(0,n.position)}${n.content}${s.slice(n.position,s.length)}`:s+n.content;break;case Yt.Update:n.content||n.unit!==Xt.Sentence||(o.dimension0="1"),i=`${s.slice(0,n.position)}${n.content}${s.slice(n.position+(n.length||0),s.length)}`;break;case Yt.Delete:i=`${s.slice(0,n.position)}${s.slice(n.position+(n.length||0),s.length)}`}return b.tG.info(538837071,b.nh.CoreDefault,o.stop()),new tn({content:i})}catch(e){return o.success=!1,o.resultDescription=`Error applying text tile delta: ${e}`,void b.tG.info(538798176,b.nh.CoreDefault,o.stop())}}function eo(e,t){var n,o,r,s,i;const a=(null===(n=t.attributionData)||void 0===n?void 0:n.ranges)||t.attributionRanges;if((null===(o=t.attributionData)||void 0===o?void 0:o.isFullUpdate)||t.deltaType!==Yt.AttributionUpdate&&void 0!==a)return a;if(!(null===(r=e.attributionRanges)||void 0===r?void 0:r.length)&&!a||t.deltaType===Yt.Update&&0===t.length)return e.attributionRanges;let l=e.attributionRanges?[...e.attributionRanges]:[];if(t.deltaType!==Yt.AttributionUpdate){const n=no(e.attributionRanges,t.deltaType,t.position),o=n?l.indexOf(n):-1;-1!==o&&(n.length=t.position-n.start);const r=(null!==(s=t.content)&&void 0!==s?s:"").length,a=null!==(i=t.length)&&void 0!==i?i:0,c=t.position+a,u=t.position+r;for(const e of l.slice(o+1)){if(e.start<t.position)continue;const n=e.start+e.length;c>e.start&&(e.length=n-c),e.start=Math.max(e.start+r-a,u)}return l=l.filter((e=>e.length>0)),l}const c=[];for(const e of a)0!==c.length&&c[c.length-1].start+c[c.length-1].length>=e.start?c[c.length-1].length=e.start+e.length-c[c.length-1].start:c.push({start:e.start,length:e.length});l=l.filter((e=>e.length>0&&!(e=>{for(const t of c)if(t.start<=e.start&&t.start+t.length>=e.start+e.length)return!0;return!1})(e))),null==a||a.forEach((e=>{l.push(e)})),l.sort(((e,t)=>e.start-t.start));const u=[];for(const e of l){const t=u.length>0?u[u.length-1]:void 0;t&&t.start+t.length>e.start&&(t.length=Math.max(e.start-t.start,0)),!t||(h=e,(d=t).attribution.userId!==h.attribution.userId||d.attribution.timestamp!==h.attribution.timestamp||d.attribution.dataSource!==h.attribution.dataSource)||e.start>t.start+t.length?u.push(e):t.length+=Math.max(e.start+e.length-(t.start+t.length),0)}var d,h;return u}function to(e,t,n){var o,s,i,a;const l=new L.I({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",dimension0:"0",success:!0}).start();l.clientFlights=n;try{if(!t)return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void b.tG.info(538798177,b.nh.CoreDefault,l.stop());if(r.h.getTypeNameFor(t)!==nn.getTypeName())return l.success=!1,l.resultDescription=`Unable to apply formatted text tile delta, parent tile is not proper type: expected ${nn.getTypeName()}, received ${r.h.getTypeNameFor(t)}`,void b.tG.info(538798178,b.nh.CoreDefault,l.stop());const n=t,c=e,u=n.content;let d="";if((void 0===c.position||c.position<0)&&!ro(c.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void b.tG.info(538798179,b.nh.CoreDefault,l.stop());if(void 0===c.content&&!ro(c.deltaType))return l.success=!1,l.resultDescription="Unable to apply formatted text tile delta, non-delete, non-formatting, non-other-non-content-update and non-cursor-update operation without content defined",void b.tG.info(538798208,b.nh.CoreDefault,l.stop());if(c.deltaType===Yt.Add&&0!==c.length?b.tG.info(538798209,b.nh.CoreDefault,new L.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):ro(c.deltaType)&&void 0!==c.content&&b.tG.info(538798210,b.nh.CoreDefault,new L.I({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete or non-content related operation with content defined, expected undefined",success:!0})),!oo(c.deltaType)){const e=function(e,t){var n,o,r,s;const i=no(e.formattedRanges,t.deltaType,t.position);let a=e.formattedRanges?[...e.formattedRanges]:[];const l=i?a.indexOf(i):-1;-1!==l&&(t.position+(t.length||0)>i.start+i.length?i.length=t.position+(null!==(n=t.content)&&void 0!==n?n:"").length-i.start:i.length+=(null!==(o=t.content)&&void 0!==o?o:"").length-(t.length||0),a[l]=i);for(const e of a.slice(l+1))e.start<t.position||(t.position+(t.length||0)>e.start?(e.length=e.start+e.length-(t.position+(t.length||0)),e.start=t.position+(null!==(r=t.content)&&void 0!==r?r:"").length):e.start+=(null!==(s=t.content)&&void 0!==s?s:"").length-(t.length||0));return a=a.filter((e=>e.length>0)),a}(n,c),t=eo(n,c);let r=n.ipPosition;switch(c.deltaType){case Yt.Add:d=c.position<u.length?`${u.slice(0,c.position)}${c.content}${u.slice(c.position,u.length)}`:u+c.content,r=c.position+c.length;break;case Yt.Update:c.content||c.unit!==Xt.Sentence||(l.dimension0="1"),d=`${u.slice(0,c.position)}${c.content}${u.slice(c.position+(null!==(o=c.length)&&void 0!==o?o:0),u.length)}`,r=c.position+c.content.length;break;case Yt.Delete:d=`${u.slice(0,c.position)}${u.slice(c.position+(null!==(s=c.length)&&void 0!==s?s:0),u.length)}`,r=c.position}const i=new nn(Object.assign(Object.assign({},n),{ipPosition:r,content:d,formattedRanges:e,attributionRanges:t,queryRange:c.queryRange}));return b.tG.info(538837073,b.nh.CoreDefault,l.stop()),i}if(c.deltaType===Yt.CursorUpdate)return new nn(Object.assign(Object.assign({},n),{ipPosition:null===(i=c.cursorData)||void 0===i?void 0:i.ipPosition,isColdIp:null===(a=c.cursorData)||void 0===a?void 0:a.isColdIp}));if(c.deltaType===Yt.FormattingUpdate)return new nn(Object.assign(Object.assign({},n),{formattedRanges:c.formattedRanges}));if(c.deltaType===Yt.OtherNonContentUpdate){let e;const t={};for(e in c.otherNonContentData)t[e]=c.otherNonContentData[e];return new nn(Object.assign(Object.assign({},n),t))}return c.deltaType===Yt.AttributionUpdate?new nn(Object.assign(Object.assign({},n),{attributionRanges:eo(n,c)})):void 0}catch(e){return l.success=!1,l.resultDescription=`Error applying formatted text tile delta: ${e}`,void b.tG.info(538798211,b.nh.CoreDefault,l.stop())}}function no(e,t,n){const o=new L.I({operationName:"FindRangeForDelta",success:!0});if(o.start(),!e)return o.resultDescription="No formatted ranges found within the tile, skipping.",void b.tG.info(538798212,b.nh.CoreDefault,o.stop());if(t===Yt.Add){const t=e.find((e=>e.start===n&&0===e.length));if(t)return o.resultDescription=`Found a zero-length formatted range for add operation with start ${t.start}.`,b.tG.info(538798213,b.nh.CoreDefault,o.stop()),t;n=Math.max(n-1,0)}const r=e.find((e=>0===e.length?e.start===n:e.start<=n&&n<e.start+e.length));return r?(o.resultDescription=`Updating formatted range for operation with start: ${r.start} and length: ${r.length}`,b.tG.info(538798214,b.nh.CoreDefault,o.stop())):(o.resultDescription=`Unable to find formatted range for operation at position ${n}, skipping.`,b.tG.info(538798215,b.nh.CoreDefault,o.stop())),r}function oo(e){return-1!==Xn.indexOf(e)}function ro(e){return oo(e)||Yt.Delete===e}function so(e){if(!e)return new io([],new Set,new Map,new Map);const t=e.split(";"),n=new Set,o=new Map,r=new Map;for(const e of t){const t=e.trim();if(""===t)continue;n.add(io.normalizeName(t));const[s,...i]=t.split(":"),a=i.join(":"),l=io.normalizeName(s);if(l){o.set(l,a);const e=io.parseName(l);e&&e!==l&&r.set(e,l)}}return new io(t,n,o,r)}class io{constructor(e,t,n,o){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=n,this.parsedFlightsMap=o}static normalizeName(e){return null==e?void 0:e.toLowerCase()}static parseName(e){const t=null==e?void 0:e.split(".");return t?t[t.length-1]:void 0}hasFlight(e){const t=io.normalizeName(e),n=this.normalizedFlights.has(t),o=this.keyValueFlightsMap.has(t),r=this.parsedFlightsMap.has(t);return n||o||r}getBooleanValue(e,t){var n,o;const r=null===(n=this.getStringValue(e))||void 0===n?void 0:n.toLowerCase(),s=null===(o=this.getStringValue(this.parsedFlightsMap.get(io.normalizeName(e))))||void 0===o?void 0:o.toLowerCase();return"true"===r||"true"===s||"false"!==r&&"false"!==s&&t}getIntValue(e,t){const n=this.getStringValue(e),o=Number.parseInt(n,10);return Number.isNaN(o)?t:o}getStringValue(e,t){var n;return null!==(n=this.keyValueFlightsMap.get(io.normalizeName(e)))&&void 0!==n?n:t}getAll(){return this.originalFlights}getAllParsed(){const e=[];return this.keyValueFlightsMap.forEach(((t,n)=>{const o=null==t?void 0:t.toLowerCase();switch(o){case"true":e.push({name:n,value:!0});break;case"false":e.push({name:n,value:!1});break;default:{const r=Number.parseInt(o,10);Number.isNaN(r)?e.push({name:n,value:t}):e.push({name:n,value:r})}}})),e}}class ao{constructor(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.userContext=e.userContext,this.site=e.site,this.getTokenCallback=e.getTokenCallback}get flights(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=so(this.clientMetadata.flights)),this._flights}getToken(e,t){return this.getTokenCallback(e,t)}getTokenAsync(e){return new Promise(((t,n)=>{this.getToken(e,((e,o,r)=>{e?n(e):t(Object.assign(Object.assign({},r),{token:o}))}))}))}}class lo{constructor(e,t,n){this.itemsContextId=new Set,this.executionState=new Map,this.graphNode=e,this.onContextIdWorkflowExecutionComplete=t,n&&(this.itemsContextId=n.itemsContextId,this.executionState=n.executionState)}addInputItemToProcess(e){this.itemsContextId.add(e)}removeProcessedInputItem(e){this.itemsContextId.delete(e)}countItemsToProcess(e){let t=0;for(const n of this.itemsContextId)0===n.indexOf(e)&&(t+=1);return t}getExecutionState(){return this.executionState}setExecutionState(e,t){return this.graphNode.isActivated?e?(this.executionState.set(e,t),!0):(b.tG.info(520217546,b.nh.CoreDefault,new L.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a undefined contextId (setExecutionState)`})),!1):(b.tG.info(508883415,b.nh.CoreDefault,new L.I({operationName:"WorkflowExecutionTracker",resourceId:this.graphNode.workflow.id,joinContextId:e,resultDescription:`Trying to set state ${t} for a not activated workflow`})),!1)}beforeWorkflowExecution(e){this.setExecutionState(e,Kt.Pending)}afterWorkflowExecution(e){this.setExecutionState(e,Kt.Executed)&&this.tryToCompleteWorkflowExecution(e)}clearWorkflowExecutions(){this.executionState.forEach(((e,t)=>this.afterWorkflowExecution(t)))}tryToCompleteWorkflowExecution(e){if(this.executionState.get(e)===Kt.Executed&&this.canCompleteExecution(e)){this.executionState.delete(e),this.onContextIdWorkflowExecutionComplete&&this.onContextIdWorkflowExecutionComplete(this.graphNode.workflow.id,e);for(const t of this.downstreamWorkflowExecutionTrackers)for(const[n,o]of t.getExecutionState())o===Kt.Executed&&Jt.isParentContextId(e,n)&&t.tryToCompleteWorkflowExecution(n)}}canCompleteExecution(e){for(const t of this.upstreamWorkflowExecutionTrackers)for(const n of t.getExecutionState().keys())if(Jt.isParentContextId(n,e))return!1;return!0}}var co;!function(e){e.Unknown="",e.InputReceived="input",e.JoinMaxAnnnotation="maxAnnotation",e.JoinMaxTimeout="maxTimeout",e.JoinEarlyCompletion="earlyCompletion"}(co||(co={}));class uo{constructor(e,t,n){this.executionTrackersByWorkflowNameBySession=new Map,this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=(e,t,n)=>this.modelDownloader?this.modelDownloader.getResourceAsArrayBuffer(e,t,n):Promise.reject(new Error("Resource Downloader never created")),this.getResourceAsURL=(e,t,n)=>this.modelDownloader?this.modelDownloader.getResourceAsURL(e,t,n):Promise.reject(new Error("Resource Downloader never created")),this.createModel=e=>(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService?this.inferenceService.then((t=>t.createModel(e))):Promise.reject(new Error("Inference Service never created"))),this.createModelInputs=()=>{if(!this.inferenceService&&this.inferenceServiceFactory&&(this.inferenceService=this.inferenceServiceFactory()),this.inferenceService)return this.inferenceService.then((e=>e.createInputs()));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,n.enableDeltas&&(this.deltaHandlers=(new Map).set(r.h.getTypeNameFor(dn),Zn).set(r.h.getTypeNameFor(hn),to),this.itemsForDelta=new Map),this.enableEarlyJoin=n.enableEarlyJoin||!1,this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}getNextClientAnnotationId(){return"#AC"+this.nextAnnotationId++}getNextClientSignalId(){return"#SC"+this.nextSignalId++}registerLocalWorkflow(e,t){const n=new L.I({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes(Ft(e.requestedContextTypesRules).map((([e,t])=>e))),t.attachToWorkflowGraph(e),n.setClientMetadata(t.getClientMetadata())):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach(((t,n)=>{t.push(this.createWorkflowImplementation(e,n))}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach(((t,n)=>{n.registerContextTypes(Ft(e.requestedContextTypesRules).map((([e,t])=>e))),n.attachToWorkflowGraph(e)}))),n.success=!0,b.tG.info(572838110,b.nh.CoreDefault,n.stop())}getAllRegisteredWorkflowsFromSession(e){const t=[];return t.push(...this.workflowsWithoutSessionAffinity||[]),t.push(...this.workflowsWithSessionAffinity.get(e)||[]),t.map((e=>e.workflow))}getWorkflowDefinitionsByName(e){var t;const n=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((e=>n.set(e.workflow.id,e.workflow))),n}getWorkflowDefinitionsWithSessionAffinity(){return this.workflowDefinitionsWithSessionAffinity}attachExecutionTrackerToEachWorkflow(e,t,n){const o=e.getWorkflowNodes(),r=this.executionTrackersByWorkflowNameBySession.get(t),s=(e,o)=>{n&&n(e,o),this.enableEarlyJoin&&(()=>{var e;for(const n of(null===(e=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===e?void 0:e.values())||[])if(n.graphNode.workflow.kind===wt.Join)for(const e of n.getExecutionState().keys())if(Jt.isParentContextId(e,o))return!0;return!1})()&&(this.cancelSweepTimer(t),this.ensureSweepTimer(t),this.sweepScopeExecutionNotifications())};if(r){for(const e of o){const t=r.get(e.workflow.id),n=new lo(e,s.bind(this),t);r.set(e.workflow.id,n)}for(const e of r.values())this.setDownstreamWorkflowExecutionTrackers(e,r),this.setUpstreamWorkflowExecutionTrackers(e,r)}}canActivateWorkflow(e,t){var n;return e.location===Gt.Local||!!t.hasConnected&&!((null===(n=e.workflow.requiredTokenTypes)||void 0===n?void 0:n.length)>0&&t.getServerAuthenticationState()===mt.f.NotAuthenticated)}setDownstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.downstreamWorkflowExecutionTrackers)return;e.downstreamWorkflowExecutionTrackers=new Set;const{graphNode:n}=e;for(const o of n.downstreamWorkflows||[]){const n=t.get(o.workflow.id);this.setDownstreamWorkflowExecutionTrackers(n,t),e.downstreamWorkflowExecutionTrackers.add(n)}}setUpstreamWorkflowExecutionTrackers(e,t){if(void 0!==e.upstreamWorkflowExecutionTrackers)return;e.upstreamWorkflowExecutionTrackers=new Set;const{graphNode:n}=e;for(const o of n.upstreamWorkflows||[]){const n=t.get(o.workflow.id);this.setUpstreamWorkflowExecutionTrackers(n,t),e.upstreamWorkflowExecutionTrackers.add(n)}}deactivateServerWorkflow(e,t){var n,o;e.location!==Gt.Local&&(null===(o=null===(n=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===n?void 0:n.get(e.workflow.id))||void 0===o||o.clearWorkflowExecutions(),e.isActivated=!1)}addSession(e){this.isWorkflowTrackingEnabled(e)&&this.executionTrackersByWorkflowNameBySession.set(e,new Map);const t=[];for(const n of this.workflowDefinitionsWithSessionAffinity)t.push(this.createWorkflowImplementation(n)),e.attachToWorkflowGraph(n);this.workflowsWithSessionAffinity.set(e,t);for(const t of this.workflowsWithoutSessionAffinity)e.attachToWorkflowGraph(t.workflow)}isWorkflowTrackingEnabled(e){return this.enableEarlyJoin||e.enabledRemoteExecutionNotification()}closeSession(e){this.cancelSweepTimer(e);for(const t of this.workflowsWithSessionAffinity.get(e)||[])t.workflowLambda.dispose();this.workflowsWithSessionAffinity.delete(e),this.isWorkflowTrackingEnabled(e)&&this.executionTrackersByWorkflowNameBySession.delete(e)}setTokenCallback(e){this.getAuthTokenCallback=e}preProcessItemToWorkflow(e,t,n){var o;const s=null===(o=this.executionTrackersByWorkflowNameBySession.get(n))||void 0===o?void 0:o.get(e.id);s&&(e.kind===wt.Join&&r.h.matchesTypesFor(t.body,e.inputTypes)&&s.addInputItemToProcess(t.contextId),(e.kind===wt.SingleItem&&r.h.matchesTypesFor(t.body,e.inputTypes)||e.kind===wt.Join&&r.h.matchesTypesFor(t.body,[e.collectionScopeType]))&&s.beforeWorkflowExecution(t.contextId))}isReadyToEarlyJoin(e,t,n){if(!e)return!1;const o=o=>{var r;const s=Array.from(null!==(r=o.states)&&void 0!==r?r:[]).map((e=>`${e[0]}: ${e[1].map((e=>e.join()))}`)).join(),i=new L.I({operationName:"EarlyJoinCompletion",resourceId:e.graphNode.workflow.id,joinContextId:t,success:!0}).start();i.setClientMetadata(n),i.resultDescription=`isReadyToEarlyJoin (${this.enableEarlyJoin}) -> hasProcessedAllInputItems: ${o.hasProcessedAllInputItems}, allUpstreamComplete: ${o.allUpstreamComplete}, states: ${s}`,b.tG.info(512550800,b.nh.CoreDefault,i.stop())},r=0===e.countItemsToProcess(t);if(!r)return this.enableEarlyJoin||o({hasProcessedAllInputItems:r}),!1;const{allUpstreamComplete:s,states:i}=this.areAllUpstreamWorkflowComplete(e,t);return this.enableEarlyJoin?s:(o({hasProcessedAllInputItems:r,allUpstreamComplete:s,states:i}),!1)}areAllUpstreamWorkflowComplete(e,t){const n=new Map;for(const o of e.upstreamWorkflowExecutionTrackers){const e=[];for(const[r,s]of o.getExecutionState())if(e.push([r,s]),Jt.isParentContextId(t,r))return n.set(o.graphNode.workflow.id,e),{allUpstreamComplete:!1,states:n};e.length>0&&n.set(o.graphNode.workflow.id,e)}return{allUpstreamComplete:!0,states:n}}runLocalWorkflows(e,t,n=!1){var o,s,i;const a=(e,n,o)=>{var s,i;const a=t.getWorkflowItemStorage(),{workflow:l}=e,c=null===(s=this.executionTrackersByWorkflowNameBySession.get(t))||void 0===s?void 0:s.get(l.id),u=l.inputTypes.concat(l.kind===wt.Join?l.collectionScopeType:[]),d=new L.I({operationName:"RunLocalWorkflows",success:!0,resourceId:l.id,joinContextId:n.contextId}).start();if(d.setClientMetadata(t.getClientMetadata()),r.h.matchesTypesFor(n.body,u)){const s=Wt(o.parentPath,n);if(l.kind===wt.Join){if(r.h.matchesTypesFor(s.body,[l.collectionScopeType]))return a.setScopeItem(s,l),d.resultDescription=`Scope item: ${n.id} (${r.h.getTypeNameFor(n.body)})`,b.tG.info(524126153,b.nh.CoreDefault,d.stop()),void this.setScopeExecutionNotification(t,e,s);{null==c||c.removeProcessedInputItem(s.contextId);const e=a.getScopeItem(s.contextId,l);if(!e)return d.resultDescription=`Filtered out join invalidation: out of scope type (${l.collectionScopeType}), item id: ${s.id}`,void b.tG.info(541173894,b.nh.CoreDefault,d.stop());a.addItemToWorkflowList(s,l),d.joinContextId=e.contextId,d.resultDescription=`Input item: ${n.id} (${r.h.getTypeNameFor(n.body)})`}}if(r.h.getBaseTypesFor(s.body).indexOf(Vn.W1.getTypeName())>=0){const e=[...s.parentPath,s.id];let n=!0;for(const o of null!==(i=l.outputTypes)&&void 0!==i?i:[])if(!t.getContextAnnotations(o,On.LocalWorkflow,e,l.id)){n=!1;break}if(n)return}const u=()=>{var o;const[r,i]=t.resolveRequestedContexts(l);if(!r)return d.resultDescription=`Required contexts are not ready for ${l.id}. Retrying execution in 500 milliseconds...`,b.tG.info(545837259,b.nh.CoreDefault,d.stop()),void setTimeout(u,500);if(l.kind===wt.SingleItem)this.queueWorkflow({workflowInfo:e,scopeItem:s,inputItems:[s],requestedContexts:i,session:t,triggerReason:co.InputReceived,onCompleteCallback:this.onWorkflowExecuted.bind(this,s,l,t)}).then((()=>{b.tG.info(509154263,b.nh.WorkflowDefault,d.stop())})).catch((e=>{d.resultDescription=e,b.tG.error(572838111,b.nh.CoreDefault,d.stop())}));else if(l.kind===wt.Join){const r=n.contextId,s=a.getScopeItem(r,e.workflow);if(!s)return d.resultDescription=`No scope item for ${l.id} workflow from contextId ${r}`,void b.tG.info(526758475,b.nh.CoreDefault,d.stop());const u=this.isReadyToEarlyJoin(c,s.contextId,t.getClientMetadata()),h=u?co.JoinEarlyCompletion:co.JoinMaxAnnnotation;if(a.isWorkflowReady(s.contextId,l)||u){if(!(null===(o=this.pendingScopeExecutionNotificationsByWorkflow.get(l.id))||void 0===o?void 0:o.get(s.contextId)))return d.resultDescription=`Workflow ${l.id}, contextId ${s.contextId}, already queued, skipping new scope execution`,void b.tG.info(528048977,b.nh.CoreDefault,d.stop());const n=a.getItemsToExecute(s.contextId,l);this.queueWorkflow({workflowInfo:e,scopeItem:s,inputItems:n,requestedContexts:i,session:t,triggerReason:h,onCompleteCallback:this.onWorkflowExecuted.bind(this,s,l,t)}).then((()=>{b.tG.info(509154262,b.nh.WorkflowDefault,d.stop())})).catch((e=>{d.resultDescription=e,b.tG.error(541173895,b.nh.CoreDefault,d.stop())})),this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).delete(s.contextId),0===this.pendingScopeExecutionNotificationsByWorkflow.get(l.id).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(l.id)}}};u()}};let l=e;n&&(l=[new ie.Xr({parentPath:["session"],items:[{id:"#userContext#",body:new Vn.hD}]}),new ie.Xr({parentPath:["session"],items:[{id:"#tenantContext#",body:new Vn.SB}]})],t.getContextIdManager().applyContextIdOnOperations(l),l=l.concat(e));for(const e of l){const n=r.h.getTypeNameFor(e);for(const r of e.items)if(t.applyOperationForContext(e,r,On.Submitted),n!==ie.n4.getTypeName()){if(r.body)if(n===ie.xU.getTypeName()&&this.deltaHandlers&&this.itemsForDelta)this.handleLocalDeltaUpdate(r,e,t);else{null===(s=this.itemsForDelta)||void 0===s||s.set(e.parentPath.concat(r.id).toString(),r);for(const t of this.workflowsWithoutSessionAffinity)a(t,r,e);for(const n of null!==(i=this.workflowsWithSessionAffinity.get(t))&&void 0!==i?i:[])a(n,r,e)}}else null===(o=this.itemsForDelta)||void 0===o||o.delete(e.parentPath.concat(r.id).toString())}}handleLocalDeltaUpdate(e,t,n){const o=new L.I({operationName:"LocalDeltaUpdate",dimension0:r.h.getTypeNameFor(e.body),success:!0});o.start();try{const s=this.deltaHandlers.get(r.h.getTypeNameFor(e.body)),i=this.itemsForDelta.get(t.parentPath.toString());if(s&&i){const r=t.parentPath.length>0?t.parentPath.slice(0,t.parentPath.length-1):t.parentPath,a=s(e.body,i.body);if(a){const t={id:i.id,revId:e.revId,body:a,parentPath:r,delta:e.body,contextId:e.contextId},s=new ie.I({parentPath:t.parentPath,items:[t]});b.tG.info(539637591,b.nh.CoreDefault,o.stop()),this.runLocalWorkflows([s],n)}else o.success=!1,o.resultDescription="Failed because the handler did not produce valid updated item",b.tG.info(539637592,b.nh.CoreDefault,o.stop())}else o.success=!1,o.resultDescription="Failed due to lack of handler or parent item",b.tG.info(539637593,b.nh.CoreDefault,o.stop())}catch(e){o.success=!1,o.resultDescription=`Failed to apply delta, error: ${e}`,b.tG.info(539637594,b.nh.CoreDefault,o.stop())}}createWorkflowImplementation(e,t){const n=e.factory();return{workflow:e,workflowLambda:n,initPromise:this.initWorkflow(e.kind,n,t)}}initWorkflow(e,t,n){const o=new ao({model:void 0,clientMetadata:n?n.getClientMetadata():void 0,userContext:n?n.getUserContext():void 0,site:this.site,getTokenCallback:this.getAuthTokenCallback});return e===wt.SingleItem||e===wt.Join?t.init(this.site,o):Promise.resolve()}queueWorkflow(e){var t,n;return null===(n=null===(t=this.executionTrackersByWorkflowNameBySession.get(e.session))||void 0===t?void 0:t.get(e.workflowInfo.workflow.id))||void 0===n||n.setExecutionState(e.scopeItem.contextId,Kt.Running),this.executeLocalWorkflow(e.workflowInfo,e.scopeItem,e.inputItems,e.session,e.requestedContexts,e.triggerReason).then((t=>{this.processAnnotationResults(t,e.session),e.onCompleteCallback()})).catch((t=>{throw e.onCompleteCallback(),t}))}processAnnotationResults(e,t){for(const n of e)t.onAnnotationResults(n,On.LocalWorkflow,(()=>{}))}executeLocalWorkflow(e,t,n,o,s,i){return new Promise(((a,l)=>{var c,u,d;const h=[],p=e.workflow,f=new L.I({operationName:"ExecuteWorkflow",resourceId:p.id,joinContextId:null!==(c=null==t?void 0:t.contextId)&&void 0!==c?c:"",resultDescription:null!=i?i:"",success:!0}).setClientMetadata(o.getClientMetadata());f.start();const g=null!==(u=null==t?void 0:t.contextId)&&void 0!==u?u:n[0].contextId,m=null!==(d=null==t?void 0:t.revId)&&void 0!==d?d:n[0].revId,y=(()=>{const e=new Map;if(t&&(t.parentPath||b.tG.error(525382231,b.nh.CoreDefault,`Missing scope item parent. Workflow: ${p.id}. Type: ${r.h.getTypeNameFor(t.body)}`),e.set(t.body,t)),Array.isArray(n))for(const t of n)t&&t.body&&(t.parentPath||b.tG.error(525382232,b.nh.CoreDefault,`Missing parent. Workflow: ${p.id}. Type: ${r.h.getTypeNameFor(t.body)}`),e.set(t.body,t));return e})(),v=(e,t=f)=>{if(e)return t.success=!1,t.resultDescription+="string"==typeof e?e:e.message,t.resultSignature="Exception",b.tG.error(572838112,b.nh.CoreDefault,t.stop()),"string"==typeof e?new Error(e):e;b.tG.info(572838113,b.nh.CoreDefault,t.stop())},S=new ao({model:new Yn(n[0],s),clientMetadata:o.getClientMetadata(),userContext:o.getUserContext(),site:this.site,getTokenCallback:this.getAuthTokenCallback}),w=e=>{v(e?e.message:void 0),e?l(e):a(h)},T={setAnnotations:(s,i,a,c)=>{var u;const d=new L.I({operationName:"SetAnnotations",resourceId:i,joinContextId:null!==(u=null==t?void 0:t.contextId)&&void 0!==u?u:"",success:!0}).setClientMetadata(o.getClientMetadata());d.start();const f=t=>{b.tG.info(555866112,b.nh.CoreDefault,new Jn({annotationType:i,annotationState:t,workflowId:e.workflow.id}))};for(const e of a)e.metadata=Object.assign(Object.assign({},e.metadata),{state:jn.r.Created}),f(jn.r.Created);const S=y.get(s),w=r.h.getTypeNameFor(S.body),T=(()=>{var e;if(p.kind===wt.SingleItem&&n[0].body!==s){const e=`Expected obj to be ${n[0].body} but instead it was ${s}`;return v(e,d),void l(v(e))}let t,u;if(Array.isArray(a))if(!p.outputTypes||p.outputTypes.indexOf(i)<0)t=`Workflow said it would output one of [${p.outputTypes}] but instead output ${i}`;else if(S)for(const e of a)r.h.matchesTypesFor(e,[re.YH.getTypeName()])?r.h.getTypeNameFor(e)!==i&&(t=`Workflow produced inconsistent annotation types in setAnnotations call (${r.h.getTypeNameFor(e)} did not match expected ${i})`):t=`Workflow produced an output that is not an annotation ${r.h.getTypeNameFor(e)}`;else t="No item provided";else t="Workflow produced an invalid annotation array";if(t)return v(t,d),void l(v(t));u=c&&c.isSessionAnnotation?["session"]:c&&c.ancestorType?S.parentPath:S.parentPath.concat(S.id);const h=[],y=[];for(const t of a){t.metadata=Object.assign(Object.assign({},t.metadata),{state:jn.r.Sent}),f(jn.r.Sent);const n=t.id,r=n?null===(e=o.getContextAnnotations(i,On.LocalWorkflow,u,p.id))||void 0===e?void 0:e.filter((e=>{var t;return(null===(t=e.body)||void 0===t?void 0:t.id)==n})):void 0;1==(null==r?void 0:r.length)?1==r.length?y.push({id:r[0].id,source:p.id,revId:m,body:t,contextId:g}):b.tG.error(545837260,b.nh.CoreDefault,`Assert: Multiple existing context annotations with body id ${n} found for ${i} and local workflow ${p.id}).`):h.push({id:this.getNextClientAnnotationId(),source:p.id,revId:m,body:t,contextId:g})}const w=[];return h.length>0&&w.push(new ie.Xr({parentPath:u,items:h,parentRevId:m})),y.length>0&&w.push(new ie.fZ({parentPath:u,items:y,parentRevId:m})),new te.B_({annotationType:i,ops:w})})();T?(c&&c.immediate?o.onAnnotationResults(T,On.LocalWorkflow,(()=>{})):h.push(T),(w==Vn.hD.getTypeName()||w==Vn.SB.getTypeName()||r.h.matchesTypesFor(S.body,[Vn.yo.getTypeName(),Vn.I3.getTypeName()]))&&o.submitOperationsToSession(T.ops),b.tG.info(509644822,b.nh.CoreDefault,d.stop())):b.tG.info(509644823,b.nh.CoreDefault,d.stop())},submitSignals:e=>{const t=new L.I({operationName:"submitSignalsAction",resourceId:p.id,success:!0}).setClientMetadata(o.getClientMetadata());for(const n of e){const e=r.h.getTypeNameFor(n);r.h.matchesTypesFor(n,[se.HN.getTypeName()])||(t.resultDescription=`Workflow produced an output that is not an signal (${r.h.getTypeNameFor(n)})`,b.tG.info(521413954,b.nh.CoreDefault,t)),p.outputTypes&&-1!==p.outputTypes.indexOf(e)||(t.resultDescription=`Workflow said it would output one of [${p.outputTypes}] but instead output ${e}`,b.tG.info(521413953,b.nh.CoreDefault,t)),n.timestamp&&(uo.logTimestampUsageByWorkflowId.has(p.id)||(uo.logTimestampUsageByWorkflowId.add(p.id),t.resultDescription=`Workflow "${p.id}" sets signal.timeStamp`,b.tG.info(509212803,b.nh.CoreDefault,t)))}const n=e.map((e=>({id:this.getNextClientSignalId(),source:p.id,revId:m,body:e,contextId:g}))),s=new ie.g0({parentPath:["session"],parentRevId:m,items:n});o.submitOperations([s])},done:w,overrideWorkflowDefinition:(e,n,r)=>{let s;switch(r){case $n.JoinContext:if(!t.contextId){const e="ContextId is not defined for this scope item.";throw b.tG.error(527472289,b.nh.CoreDefault,e),new Error(e)}s=t.contextId;break;case $n.Session:s=void 0;break;default:{const e="Defined scope is not supported. "+r;throw b.tG.error(527472290,b.nh.CoreDefault,e),new Error(e)}}const i=new $e({definition:n,contextId:s,sourceWorkflowId:p.id,targetWorkflowId:e});o.onWorkflowDefinitionOverrideMessage(i)},getDynamicAnnotations:void 0,setBillingDomain:void 0,sendClientRequest:void 0,sendClientRequestStreaming:void 0},_=e.workflowLambda;if(p.kind===wt.SingleItem){1!==n.length&&w(new Error("Single item workflows expect a single input")),S.delta=n[0].delta,S.deltas=n[0].deltas;try{const t=_;e.initPromise||(e.initPromise=t.init(this.site,S)),e.initPromise.then((()=>{t.execute(n[0].body,S,T)})).catch((e=>{v(e)}))}catch(e){v(e)}}else if(p.kind===wt.Join){0===n.length&&w(new Error("Join workflows expect an inputs array")),S.delta=t.delta,S.deltas=t.deltas;try{const o=_;e.initPromise||(e.initPromise=o.init(this.site,S)),e.initPromise.then((()=>{o.execute(t.body,n.map((e=>e.body)),S,T)})).catch((e=>{v(e)}))}catch(e){v(e)}}else v(`Workflow kind ${p.kind} not supported`)}))}ensureSweepTimer(e){if(!this.sweepTimers.get(e)){const t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}}cancelSweepTimer(e){const t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))}onSweep(){this.sweepScopeExecutionNotifications()}setScopeExecutionNotification(e,t,n){var o,r;const s=Date.now(),i={session:e,workflowImplementation:t,scopeItem:n,startTime:s,minTime:s+pe(t.workflow.minDelayMs,1e3),maxTime:s+pe(t.workflow.maxDelayMs,5e3)},a=t.workflow.kind===wt.Join?n.contextId:i.scopeItem.parentPath.concat(n.id).join("\\");if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(a)){const o=new L.I({resultDescription:`Duplicated pending scope execution for ${t.workflow.id} at ${a}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(r=null==n?void 0:n.contextId)&&void 0!==r?r:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();b.tG.info(509727899,b.nh.CoreDefault,o.stop())}else{const r=new L.I({resultDescription:`New pending scope execution for ${t.workflow.id} at ${a}`,operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,joinContextId:null!==(o=null==n?void 0:n.contextId)&&void 0!==o?o:"",success:!0}).setClientMetadata(e.getClientMetadata()).start();b.tG.info(539883075,b.nh.CoreDefault,r.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(a,i)}this.ensureSweepTimer(e)}sweepScopeExecutionNotifications(){var e,t;const n=new Set(Array.from(this.sweepTimers.keys()));for(const[o,r]of Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries()))for(const[s,i]of Array.from(r.entries())){const{session:r,workflowImplementation:{workflow:a}}=i,l=r.getWorkflowItemStorage(),c=new L.I({operationName:"LocalScopeExecutionNotification",resourceId:a.id,joinContextId:null!==(t=null===(e=i.scopeItem)||void 0===e?void 0:e.contextId)&&void 0!==t?t:"",success:!0}).setClientMetadata(r.getClientMetadata()).start(),u=()=>{var e;if(a.kind===wt.Join){const t=Date.now(),{workflow:n}=i.workflowImplementation,o=i.scopeItem.contextId,s=r.getWorkflowDefinition(n,o).maxDelayMs;return l.isWorkflowReady(o,n)?(c.resultDescription=`Join Workflow: ${n.id} queuing by maxAnnotation, contextId: ${o}`,b.tG.info(528048978,b.nh.CoreDefault,c.stop()),{isValid:!0,triggerReason:co.JoinMaxAnnnotation}):i.startTime+s<t?(c.resultDescription=`Join Workflow: ${n.id} queuing by maxTimeout, contextId: ${o}`,b.tG.info(528048979,b.nh.CoreDefault,c.stop()),{isValid:!0,triggerReason:co.JoinMaxTimeout}):this.isReadyToEarlyJoin(null===(e=this.executionTrackersByWorkflowNameBySession.get(r))||void 0===e?void 0:e.get(n.id),o,r.getClientMetadata())?(b.tG.info(512550856,b.nh.CoreDefault,`Workflow: ${n.id} queuing by early completion, contextId: ${o}, timeout: ${s}`),{isValid:!0,triggerReason:co.JoinEarlyCompletion}):{isValid:!1,triggerReason:co.Unknown}}return{isValid:!0,triggerReason:co.Unknown}};(()=>{const{isValid:e,triggerReason:t}=u();if(!e)return!1;const[n,o]=r.resolveRequestedContexts(a);if(!n)return!1;try{if(a.kind===wt.Join){const e=i.scopeItem.contextId,n=l.getScopeItem(e,a);if(n){const s=l.getItemsToExecute(n.contextId,a);if(0===s.length)return c.resultDescription=`Failed to retrieve items for workflow: ${a.id}, contextId: ${e}, skipping execution`,b.tG.info(527472291,b.nh.CoreDefault,c.stop()),this.onWorkflowExecuted(n,a,r),!0;this.queueWorkflow({workflowInfo:i.workflowImplementation,scopeItem:n,inputItems:s,requestedContexts:o,session:r,triggerReason:t,onCompleteCallback:this.onWorkflowExecuted.bind(this,n,a,r)}).catch((e=>{c.success=!1,c.resultDescription=e.message,b.tG.error(509092189,b.nh.CoreDefault,c.stop())}))}else c.resultDescription="ContextId no longer exists, skipping workflow execution",b.tG.info(539883076,b.nh.CoreDefault,c.stop())}else c.resultDescription=`Workflow in type ${a.kind} is not supported`,b.tG.error(539883077,b.nh.CoreDefault,c.stop())}catch(e){c.resultDescription=`Trying to execute ${a.id} caused an exception: ${e}`,b.tG.warn(539883078,b.nh.CoreDefault,c.stop())}return!0})()?(this.pendingScopeExecutionNotificationsByWorkflow.get(o).delete(s),0===this.pendingScopeExecutionNotificationsByWorkflow.get(o).size&&this.pendingScopeExecutionNotificationsByWorkflow.delete(o)):n.delete(r)}if(0!==n.size)for(const e of Array.from(n)){const t=new L.I({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();b.tG.debug(539883079,b.nh.CoreDefault,t.stop()),this.cancelSweepTimer(e)}}onExternalWorkflowExecuted(e,t,n){const o={id:"",parentPath:[],contextId:e},r={id:t};this.onWorkflowExecuted(o,r,n,!1)}onWorkflowExecuted(e,t,n,o=!0){var r,s;null===(s=null===(r=this.executionTrackersByWorkflowNameBySession.get(n))||void 0===r?void 0:r.get(t.id))||void 0===s||s.afterWorkflowExecution(e.contextId),o&&t.kind===wt.Join&&n.getWorkflowItemStorage().onWorkflowExecuted(e,t)}}class ho{constructor(e=500,t=!1){this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}sequence(e){return new Promise(((t,n)=>{if(e<this.prevSeq){if(this.rejectOutdatedSequenceNumbers){const t=new Error(`BufferingSequencer: Item out of order. Expecting seqId > ${this.prevSeq}. Actual seqId ${e}`);return t.name=ho.Rejected,void n(t)}this.prevSeq=-1}e!=this.prevSeq+1&&b.tG.warn(542712385,b.nh.CoreDefault,`BufferingSequencer: got out of order sequence number. Got ${e}, expected ${this.prevSeq+1}`);const o={seq:e,resolve:t};this.insertItem(o),this.runInOrder(o,!0,!1)}))}insertItem(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);let t=this.lastQueueItem,n=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(n?(n.prev=e,e.next=n):this.lastQueueItem=e);n=t,t=t.prev}while(t);n&&(n.prev=e),e.next=n,this.firstQueueItem=e}runInOrder(e,t,n){let o=this.prevSeq,r=!1;const s=[];for(;this.firstQueueItem;){const t=this.firstQueueItem;if(o+1!=t.seq&&(!n||t.seq>e.seq))break;o=t.seq,t.timeout&&clearTimeout(t.timeout),s.push(t),e==t&&(r=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}s.length>0&&setTimeout((()=>{for(const e of s)e.resolve(e.seq)}),0),this.prevSeq=o,!r&&t&&(e.timeout=setTimeout((()=>{this.runInOrder(e,!1,!0)}),this.bufferingTimeMs))}}ho.Rejected="SequenceItemRejected";class po{constructor(e=500){this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}create(e){if(!e.ownerId)return null;let t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new ho(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t}}class fo{constructor(e=500,t){this.sequencerFactory=null!=t?t:new po(e)}sequence(e){var t,n,o,r,s;return n=this,o=void 0,s=function*(){if(null==(null===(t=null==e?void 0:e.M_)||void 0===t?void 0:t.seq))return;const n=this.sequencerFactory.create(e);n&&(yield n.sequence(e.M_.seq))},new((r=void 0)||(r=Promise))((function(e,t){function i(e){try{l(s.next(e))}catch(e){t(e)}}function a(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,a)}l((s=s.apply(n,o||[])).next())}))}}class go{constructor(e){this.annotationSequencer=null!=e?e:new fo}process(e,t,n,o){const r=[];for(const o of e.ops){const s=[];if(null==o?void 0:o.items)for(const e of o.items){const n=this.annotationSequencer.sequence(e.body).then((()=>{t(o,e)}));s.push(n)}r.push(Promise.all(s).then((()=>{n(o,e.cv)})))}Promise.all(r).then((()=>o(e)))}}class mo{process(e,t,n,o){for(const o of e.ops){if(null==o?void 0:o.items)for(const e of o.items)t(o,e);n(o,e.cv)}o(e)}}class yo{constructor(e,t,n){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new go,this.unorderedAnnotationResultsProcessor=null!=n?n:new mo}process(e,t,n,o){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,n,o):this.unorderedAnnotationResultsProcessor.process(e,t,n,o)}}var vo=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class bo{constructor(e,t){this.changeGatesInitialized=!1,this.hostCallbacks=e,this.changeGateMap=t||new Map}init(){return vo(this,void 0,void 0,(function*(){const e=[];this.hostCallbacks&&this.hostCallbacks.isChangeGateEnabled&&this.changeGateMap.forEach(((t,n)=>{e.push(this.hostCallbacks.isChangeGateEnabled(n).then((e=>{this.changeGateMap.set(n,e)})))})),yield Promise.all(e).then((()=>{this.changeGatesInitialized=!0})).catch((e=>{}))}))}isFeatureEnabled(e,t=!1,n="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled(e,n).catch((()=>Promise.resolve(t))):Promise.resolve(t)}isChangeGateEnabled(e){var t;return vo(this,void 0,void 0,(function*(){return!this.changeGateMap||(this.changeGatesInitialized&&this.changeGateMap.has(e)?this.changeGateMap.get(e):!(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled))||(yield this.hostCallbacks.isChangeGateEnabled(e)))}))}isChangeGateEnabledSync(e){var t;if(!this.changeGatesInitialized&&(null===(t=this.hostCallbacks)||void 0===t?void 0:t.isChangeGateEnabled)){const t=new L.I({operationName:"GateUtilsNotInitialized",success:!1,resultDescription:`${e}`});b.tG.error(505529628,b.nh.CoreDefault,t)}return!this.changeGateMap||!this.changeGatesInitialized||!this.changeGateMap.has(e)||this.changeGateMap.get(e)}isChangeGatesInitialized(){return this.changeGatesInitialized}getChangeGateMap(){return this.changeGateMap}}var So=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};const wo="CloseSessionsOnRuntimeUninit",To="ShouldAppendClientFeatureFlights",_o="DontSendNewTokenOnReconnect",Co="WebSocketWorkerShouldLogEgressCount",ko="FixIncorrectInvocationOfClaimsCallbacks",Eo=()=>n(60041).r;class Ao{constructor(e,t,n,o){this.sessionsByDocSessionId=new Map,this.isDeltaGeneratorEnabled=!1,this.disableSyncDeltaSending=!1,this.hasBeenInitialized=!1,this.telemetryLogger=null,this.changeGateList=new Map([["SkipCheckingCachedClaimsChallenge",!0],["LogRetryMessageEvent",!0],["ImproveClientRetries",!0],["ShouldNotRetryOnSessionClosedError",!0],[wo,!0],[To,!0],[_o,!0],[Co,!0],[ko,!0]]),this.settings={annotationsOrderingEnabled:!0,deltaOperationsEnabled:!1,defaultBatchingEnabled:!0,batchingWith20msIntervalEnabled:!0,onAnnotationsSubmittedEnabled:!1,reduceBatchOperationsEnabled:!1,batchMessagesEnabled:!1,removeDuplicateFlights:!0,annotationDoesNotExistOnService:!0,reducedPingPongRetryEnabled:!1,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:!1,sendTokenFailureMessage:!0,closeSessionsOnRuntimeUninit:!1,shouldAppendClientFeatureFlights:!0,authTokenTimeoutMs:0,doNotSendNewTokenOnReconnect:!1,webSocketWorkerShouldLogEgressCount:!0,createBlobStorageContainerEnabled:!1},this.settingToChangeGateName={closeSessionsOnRuntimeUninit:wo,shouldAppendClientFeatureFlights:To,doNotSendNewTokenOnReconnect:_o,webSocketWorkerShouldLogEgressCount:Co},this.isDownloaderCompatible=()=>"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL,o&&(this.settings=o),this.workerFactory=e||(e=>e&&e===st.HttpFallback?new Xe:new Q(void 0,this.settings));const r=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=(...e)=>(null==t?void 0:t(...e))||r(...e),this.sessionFactory=n||(e=>new Wn(e))}init(e,t,n,o){var r,s,i,a,l,c,u,d,h,p;const f=new L.I({operationName:"InitRuntime",resourceId:H(e),dimension1:this.hasBeenInitialized.toString()});f.start(),this.hasBeenInitialized=!0,this.hostCallbacks=n,this.gateUtils=new bo(this.hostCallbacks,this.changeGateList),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=Eo()),this.telemetryLogger=new q(this.hostCallbacks),this.shouldAddLogger(f)?(b.tG.addLogger(this.telemetryLogger),this.addLoggingAggregator(o)):(b.tG.clearLoggers(),b.tG.addLogger(this.telemetryLogger)),Ao.haveCalledInit=!0,this.annotationResultsProcessor=new yo((()=>this.settings.annotationsOrderingEnabled)),this.inferenceServiceFactory=o.inferenceServiceFactory,f.dimension2=(0,b.OD)(N.q.info).toString();const g=[];e&&(this.defaultServiceUrl=ce.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase()),g.push(this.gateUtils.init().then((()=>So(this,void 0,void 0,(function*(){yield Promise.all(Object.keys(this.settingToChangeGateName).map((e=>So(this,void 0,void 0,(function*(){try{const t=yield this.gateUtils.isChangeGateEnabled(this.settingToChangeGateName[e]);this.settings[e]=t}catch(t){this.settings[e]=!1}})))))}))))),g.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!0).then((e=>{this.settings.annotationsOrderingEnabled=e}))),g.push(this.isFeatureEnabled("DefaultBatchingDisabled").then((e=>{var t;(t=this.settings).defaultBatchingEnabled&&(t.defaultBatchingEnabled=!e)}))),g.push(this.isFeatureEnabled("BatchingWith20msIntervalDisabled").then((e=>{var t;(t=this.settings).batchingWith20msIntervalEnabled&&(t.batchingWith20msIntervalEnabled=!e)}))),g.push(this.isFeatureEnabled("OnAnnotationsSubmittedDisabled").then((e=>{var t;(t=this.settings).onAnnotationsSubmittedEnabled&&(t.onAnnotationsSubmittedEnabled=!e)}))),g.push(this.isFeatureEnabled("ReduceBatchOperationsEnabled").then((e=>{var t;(t=this.settings).reduceBatchOperationsEnabled||(t.reduceBatchOperationsEnabled=e)}))),g.push(this.isFeatureEnabled("BatchMessagesEnabled").then((e=>{var t;(t=this.settings).batchMessagesEnabled||(t.batchMessagesEnabled=e)}))),g.push(ce.isChangeGateEnabled(this.hostCallbacks,"AnnotationDoesNotExistOnService").then((e=>{this.settings.annotationDoesNotExistOnService=e}))),g.push(ce.isFeatureEnabled(this.hostCallbacks,"ReducedPingPongRetryEnabled").then((e=>{var t;(t=this.settings).reducedPingPongRetryEnabled||(t.reducedPingPongRetryEnabled=e)}))),g.push(this.isFeatureEnabled("MaxNumberOfDeltaUpdateOpsPerItemPerBatch").then((e=>{var t;(t=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(t.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=e)}))),g.push(ce.isChangeGateEnabled(this.hostCallbacks,"SendTokenFailureMessage").then((e=>{this.settings.sendTokenFailureMessage=e}))),g.push(this.isFeatureEnabled("CreateBlobStorageContainerEnabled").then((e=>{var t;(t=this.settings).createBlobStorageContainerEnabled||(t.createBlobStorageContainerEnabled=e)})));const m={enableDeltas:!1,enableEarlyJoin:!1};g.push(Promise.all([this.isFeatureEnabled("DeltaOperationsEnabled").then((e=>m.enableDeltas=e)).catch((()=>m.enableDeltas=!1)),this.isFeatureEnabled("EarlyJoinCompletionEnabled").then((e=>m.enableEarlyJoin=e)).catch((()=>m.enableEarlyJoin=!1))]).then((()=>{this.localWorkflowManager=new uo(o.modelDownloader&&this.isDownloaderCompatible()?o.modelDownloader:void 0,this.inferenceServiceFactory,m)})));const y=so(null!==(r=t.flights)&&void 0!==r?r:"");var v;return this.isDeltaGeneratorEnabled=y.getBooleanValue("Microsoft.Office.WordOnline.AugloopDeltas",null!==(s=o.isDeltaGeneratorEnabled)&&void 0!==s&&s),this.disableSyncDeltaSending=y.getBooleanValue("Microsoft.Office.WordOnline.DisableSyncDeltaSending",null!==(i=o.disableSyncDeltaSending)&&void 0!==i&&i),this.syncDeltaTimeout=y.getIntValue("Microsoft.Office.WordOnline.SyncDeltaTimeout",o.syncDeltaTimeout),(a=this.settings).defaultBatchingEnabled&&(a.defaultBatchingEnabled=!y.getBooleanValue("DefaultBatchingDisabled",!1)),(l=this.settings).batchingWith20msIntervalEnabled&&(l.batchingWith20msIntervalEnabled=!y.getBooleanValue("BatchingWith20msIntervalDisabled",!1)),(c=this.settings).reduceBatchOperationsEnabled||(c.reduceBatchOperationsEnabled=y.getBooleanValue("ReduceBatchOperationsEnabled",!1)),(u=this.settings).batchMessagesEnabled||(u.batchMessagesEnabled=y.getBooleanValue("BatchMessagesEnabled",!1)),(d=this.settings).removeDuplicateFlights&&(d.removeDuplicateFlights=y.getBooleanValue("RemoveDuplicateFlights",!0)),(h=this.settings).reducedPingPongRetryEnabled||(h.reducedPingPongRetryEnabled=y.getBooleanValue("ReducedPingPongRetryEnabled",!1)),(p=this.settings).maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled||(p.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled=y.getBooleanValue("maxNumberOfDeltaUpdateOpsPerItemPerBatch",!1)),this.settings.authTokenTimeoutMs=y.getIntValue("AuthTokenTimeoutMs",0),f.setDataField("Flights",JSON.stringify(this.settings)),o&&o.loggableUrls&&(v=o.loggableUrls,U.push(...v)),Promise.all(g).then((()=>{this.batchOptions=o.batchOptions,!this.batchOptions&&this.settings.defaultBatchingEnabled&&(this.batchOptions={delayMs:1,maxInputSize:1e6,delayMsMax:50},this.settings.batchingWith20msIntervalEnabled&&(this.batchOptions.delayMs=20)),this.batchOptions&&!this.batchOptions.delayMsMax&&(this.batchOptions.delayMsMax=50),o&&o.networkMode&&(this.networkMode=o.networkMode,o.networkMode===st.LocalWorkflowsOnly&&(this.sessionManagerFactory=()=>new Dn)),f.dimension0=JSON.stringify(this.batchOptions),this.logOperation(f,!0)})).catch((e=>{this.logOperation(f,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerLocalWorkflow(e){this.localWorkflowManager.registerLocalWorkflow(e)}flushTelemetry(e){b.tG.flushAggregators(e)}createSession(e){var t;const n=e&&e.docSessionId?e.docSessionId:Cn(),o=e&&e.documentId?e.documentId:void 0,r=this.sessionsByDocSessionId.get(n),s=new L.I({operationName:"CreateSession",resourceId:n,dimension1:this.hasBeenInitialized.toString()});if(s.start(),r&&!1===r.isClosed)throw this.logOperation(s,!1,"Error","docSessionId already exists"),new Error("docSessionId already exists");let i=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;i=ce.convertServiceUrlToWebSocket(i),i||((e=e||{}).networkMode=st.LocalWorkflowsOnly),!this.networkMode||void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)||((e=e||{}).networkMode=this.networkMode),void 0!==(null==e?void 0:e.networkMode)&&null!==(null==e?void 0:e.networkMode)&&(null==e?void 0:e.networkMode)!==st.JSWebSockets||!this.hasHttpFallbackSession()||((e=e||{}).networkMode=st.HttpFallback);const a=Object.assign({},this.clientMetadata);if(a.docSessionId=n,o&&(a.documentId=o),e&&e.tid3pHost&&(a.tid3pHost=e.tid3pHost),e&&e.flights&&(a.flights=a.flights?a.flights+";"+e.flights:e.flights),this.settings.shouldAppendClientFeatureFlights){const e=["_acceptsClaimsChallengeMessages","_acceptsSeedingStatusChangeMessages"].join(";");a.flights=a.flights?`${a.flights};${e}`:e}this.settings.removeDuplicateFlights&&a.flights&&(a.flights=function(e){if(!e)return"";const t=new Set,n=[];for(const o of e.split(";").reverse()){const e=o.split(":")[0],r=io.normalizeName(e);t.has(r)||(t.add(r),n.push(o))}return n.reverse().join(";")}(a.flights)),s.setDataField("Flights",a.flights||"");const l=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(a,i,e),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:a,userContext:e?e.userContext:void 0,localWorkflowManager:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor,localRegisteredWorkflows:(null==e?void 0:e.localRegisteredWorkflows)||[],enableRemoteExecutionNotification:(null==e?void 0:e.enableRemoteExecutionNotification)||!1,networkMode:null==e?void 0:e.networkMode,egress:e?e.egress:void 0,isDeltaGeneratorEnabled:this.isDeltaGeneratorEnabled,onAnnotationsSubmittedEnabled:this.settings.onAnnotationsSubmittedEnabled,disableSyncDeltaSending:this.disableSyncDeltaSending,syncDeltaTimeout:this.syncDeltaTimeout,reduceBatchOperationsEnabled:this.settings.reduceBatchOperationsEnabled,batchMessagesEnabled:this.settings.batchMessagesEnabled,annotationDoesNotExistOnServiceEnabled:this.settings.annotationDoesNotExistOnService,maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled:this.settings.maxNumberOfDeltaUpdateOpsPerItemPerBatchEnabled,gateUtils:this.gateUtils});return this.sessionsByDocSessionId.set(n,l),e&&(e.onSessionConnect&&l.setConnectCallback(e.onSessionConnect),e.onSessionDisconnect&&l.setDisconnectCallback(e.onSessionDisconnect),e.onSessionReconnect&&l.setReconnectCallback(e.onSessionReconnect),e.onSessionClose&&l.setSessionCloseCallback(e.onSessionClose),e.onServerAuthenticationStateChangeCallback&&l.setServerAuthenticationStateChangeCallback(e.onServerAuthenticationStateChangeCallback),e.onClaimsChallengeCallback&&l.setClaimsChallengeCallback(e.onClaimsChallengeCallback),e.onSeedingStatusChangeCallback&&l.setSeedingStatusChangeCallback(e.onSeedingStatusChangeCallback)),this.logOperation(s,!0),l.initialize?l.initialize():Promise.resolve(l)}getSession(e){return this.sessionsByDocSessionId.get(e)}getSessionManagerFactory(){return this.sessionManagerFactory}shouldAddLogger(e){if(Ao.haveCalledInit){const t=new Error("Runtime already initialized");return e.dimension3=t.stack,e.dimension2=(0,b.OD)(N.q.info).toString(),this.logOperation(e,!1,"Error",t.message),!1}return!0}createDefaultSessionManagerFactory(){return(e,t,n)=>{if(n&&n.networkMode==st.LocalWorkflowsOnly)return new Dn;const o=new Hn,r=new Un;let s=()=>{b.tG.error(573321615,b.nh.CoreDefault,"Unexpectedly not set sendMessage")};const i=new qn((()=>r),e,o,((e,t,n)=>{s(e,t,n)}),{requestAuthToken:this.hostCallbacks.requestAuthToken,overrideSessionInitMessage:this.hostCallbacks.overrideSessionInitMessage,enableRemoteExecutionNotification:(null==n?void 0:n.enableRemoteExecutionNotification)||!1,sendTokenFailureMessageChangeGate:this.settings.sendTokenFailureMessage,authTokenTimeoutMs:this.settings.authTokenTimeoutMs,dontSendTokenOnReconnectChangeGate:this.settings.doNotSendNewTokenOnReconnect,createBlobStorageContainerEnabled:this.settings.createBlobStorageContainerEnabled}),a=new lt(ce.convertServiceUrlToWebSocket(t),r,this.workerFactory,i,e,o,this.settings,this.gateUtils,null==n?void 0:n.networkMode);return s=a.sendMessage.bind(a),a.on("disconnect",(()=>o.clearRefreshTimeouts())),a.on("connect",((e,t,n,o)=>{e&&this.hostCallbacks.setSessionData&&this.hostCallbacks.setSessionData(t,n,o);const r=t.substring(t.lastIndexOf("/")+1);this.telemetryLogger.setServerSessionKey(r)})),a}}isFeatureEnabled(e,t=!1,n="None"){return ce.isFeatureEnabled(this.hostCallbacks,e,t,n)}hasHttpFallbackSession(){let e=!1;return this.sessionsByDocSessionId.forEach((t=>{t.isHttpFallback()&&(e=!0)})),e}logOperation(e,t,n,o){e.stop(),e.success=t,e.resultSignature=n,e.resultDescription=o,b.tG.info(573321622,b.nh.CoreDefault,e)}addLoggingAggregator(e){var t,n,o,r;"Dogfood"!==this.clientMetadata.releaseAudienceGroup&&"Automation"!==this.clientMetadata.releaseAudienceGroup&&(b.tG.addAggregator(G("Operation","operationName",["ExecuteBatch","ReduceBatchOperations","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource","CreateTextTileDeltaFromItem","NetworkEgressControl","HttpEgress","LongPollNoOp","NetworkRateControllerAbandonedSyncMessage","NetworkRateControllerEgress","NetworkRateControllerQueueItem","NetworkRateControllerOnRateLimitResponse","NetworkRateControllerOnRateLimitError","NetworkRateControllerRateLimitsSet"],null!==(t=e.telemetryAggregationIntervalSec)&&void 0!==t?t:30)),b.tG.addAggregator(G("Operation","operationName",["ExecuteWorkflow","ExecuteLambda","EarlyJoinCompletion","OnLongPollMessage","OnAnnotationResultsEgress"],null!==(n=e.telemetryAggregationIntervalSec)&&void 0!==n?n:60)),b.tG.addAggregator(G("Operation","operationName",["LocalScopeExecutionNotification","RunLocalWorkflows","EarlyJoinCompletion","SetAnnotations","WIS.addItemOnContextIdList","WIS.setScopeItem"],null!==(o=e.telemetryAggregationIntervalSec)&&void 0!==o?o:120)),b.tG.addAggregator(G("SessionHealth","sessionHealthEventName",["SendMessage","ProcessMessage"],null!==(r=e.telemetryAggregationIntervalSec)&&void 0!==r?r:60)))}uninitialize(){this.settings.closeSessionsOnRuntimeUninit&&(this.sessionsByDocSessionId.forEach((e=>{e.close()})),this.sessionsByDocSessionId.clear()),this.flushTelemetry(!0),this.hostCallbacks=null,this.hasBeenInitialized=!1,this.telemetryLogger=null,Ao.haveCalledInit=!1,b.tG.clearAggregators(),b.tG.clearLoggers()}}const Io=new Ao;class Po{static create(e){var t;return new Po(e.session,null!==(t=e.scheduler)&&void 0!==t?t:new d)}constructor(e,t){this.session=e,this.scheduler=t}execute(e,t){return this.createExecutor(e,t).execute()}createExecutor(e,t){const n=new L.I({operationName:"AsyncClientExecute",success:!0}).setClientMetadata(this.session.getClientMetadata()).start();switch(e.type){case o.SingleAnnotation:return n.resourceId="SingleAnnotationRequest",new E(this.session,e,t,this.scheduler,n);case o.Streaming:return n.resourceId="StreamingRequest",new T(this.session,e,t,this.scheduler,n);case o.CustomMessage:return n.resourceId="CustomMessageRequest",new P(this.session,e,t,this.scheduler,n);default:throw new Error("Request Type not supported")}}}const Mo={category:Z.Schema,schema:{name:"Exception",path:"message-schema.proto"}},xo=(Z.Schema,(e,t=!1)=>{if(null==e)return"Invalid message passed";if(null==e.payload)return`${pt[pt.NoOutput]}: Payload is null`;if(null==e.payload.exceptionType)return"Payload is not an exception";{let n=pt[e.payload.exceptionType];return n+=e.payload.message?`: ${e.payload.message}`:": No description",n+=t&&e.payload.data?`\n${e.payload.data.toString()}`:"",n}}),Ro=(e,t)=>{if(null==e)throw new Error("Cannot set exception on null message");e.payload=t,e.payloadSchema=Mo,e.messageType=ht.Exception};var Do,Oo;!function(e){let t,n,o,r,s,i;!function(e){e[e.Unknown=0]="Unknown",e[e.Text=1]="Text",e[e.Slide=2]="Slide"}(t=e.TileType||(e.TileType={})),function(e){e[e.Generic=0]="Generic",e[e.Title=1]="Title",e[e.SmartArt=2]="SmartArt",e[e.TableCell=3]="TableCell",e[e.TextBox=4]="TextBox",e[e.Notes=5]="Notes"}(n=e.TextTileType||(e.TextTileType={})),function(e){e[e.Undefined=0]="Undefined",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(o=e.TextTileElementUnit||(e.TextTileElementUnit={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered"}(r=e.ListType||(e.ListType={})),function(e){e[e.Undefined=0]="Undefined",e[e.AlphaLcParenBoth=1]="AlphaLcParenBoth",e[e.AlphaUcParenBoth=2]="AlphaUcParenBoth",e[e.AlphaLcParenR=3]="AlphaLcParenR",e[e.AlphaUcParenR=4]="AlphaUcParenR",e[e.AlphaLcPeriod=5]="AlphaLcPeriod",e[e.AlphaUcPeriod=6]="AlphaUcPeriod",e[e.ArabicParenBoth=7]="ArabicParenBoth",e[e.ArabicParenR=8]="ArabicParenR",e[e.ArabicPeriod=9]="ArabicPeriod",e[e.ArabicPlain=10]="ArabicPlain",e[e.RomanLcParenBoth=11]="RomanLcParenBoth",e[e.RomanUcParenBoth=12]="RomanUcParenBoth",e[e.RomanLcParenR=13]="RomanLcParenR",e[e.RomanUcParenR=14]="RomanUcParenR",e[e.RomanLcPeriod=15]="RomanLcPeriod",e[e.RomanUcPeriod=16]="RomanUcPeriod",e[e.CircleNumDbPlain=17]="CircleNumDbPlain",e[e.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain",e[e.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain",e[e.ArabicDbPeriod=20]="ArabicDbPeriod",e[e.ArabicDbPlain=21]="ArabicDbPlain",e[e.Ea1ChsPeriod=22]="Ea1ChsPeriod",e[e.Ea1ChsPlain=23]="Ea1ChsPlain",e[e.Ea1ChtPeriod=24]="Ea1ChtPeriod",e[e.Ea1ChtPlain=25]="Ea1ChtPlain",e[e.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod",e[e.Ea1JpnKorPlain=27]="Ea1JpnKorPlain",e[e.Ea1JpnKorPeriod=28]="Ea1JpnKorPeriod",e[e.Arabic1Minus=29]="Arabic1Minus",e[e.Arabic2Minus=30]="Arabic2Minus",e[e.Hebrew2Minus=31]="Hebrew2Minus",e[e.ThaiAlphaPeriod=32]="ThaiAlphaPeriod",e[e.ThaiAlphaParenR=33]="ThaiAlphaParenR",e[e.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth",e[e.ThaiNumPeriod=35]="ThaiNumPeriod",e[e.ThaiNumParenR=36]="ThaiNumParenR",e[e.ThaiNumParenBoth=37]="ThaiNumParenBoth",e[e.HindiAlphaPeriod=38]="HindiAlphaPeriod",e[e.HindiNumPeriod=39]="HindiNumPeriod",e[e.HindiNumParenR=40]="HindiNumParenR",e[e.HindiAlpha1Period=41]="HindiAlpha1Period"}(s=e.ListNumeration||(e.ListNumeration={})),function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(i=e.TextTileEventType||(e.TextTileEventType={}))}(Do||(Do={})),function(e){let t;!function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(t=e.SlideTileEventType||(e.SlideTileEventType={}))}(Oo||(Oo={}));class No{constructor(){this.cache=new Map}setReduceTimer(e,t,n,o=500,r=()=>!1,s=5e3){this.cache.has(e)||this.cache.set(e,new Map);const i=this.cache.get(e);i.has(t)&&clearTimeout(i.get(t).timer);const a=()=>{const a=i.get(t),l=Date.now()-a.start;r()&&l<s?a.timer=setTimeout(a.timerCallback,Math.min(o,s-l)):(i.size>1?i.delete(t):this.cache.delete(e),n())};i.set(t,{start:Date.now(),timerCallback:a,timer:setTimeout(a,o)})}clear(e,t){this.cache.forEach(((n,o)=>{e&&e!==o||n.forEach(((e,n)=>{t&&t!==n||clearTimeout(e.timer)}))})),this.cache.clear()}}class Lo{constructor(e=33e5){this.tokenCache=new Map,this.requestMap=new Map,this.requestRecordMap=new Map,this.tokenExpirationMs=e}updateAuthToken(e,t){const n=JSON.stringify(t);let o=this.requestRecordMap.get(n);return(void 0===o||this.isTokenExpired(o))&&(o={requestPromise:e.requestAuthToken(t).then((e=>{if(!e||!e.Token)throw new Error(`No token available for request ${n}`);this.tokenCache.set(n,e.Token)})),requestTime:ce.getCurrentTimeMs()},this.requestRecordMap.set(n,o)),o.requestPromise}getAuthTokenEntries(e,t){return Array.from(this.tokenCache.keys()).map((e=>{let t=this.requestMap.get(e);return void 0===t&&(t=JSON.parse(e),this.requestMap.set(e,t)),{requestKey:e,request:t}})).filter((({request:e})=>!t||e.DocId===t)).map((({requestKey:t,request:n})=>(this.isTokenExpired(this.requestRecordMap.get(t))&&this.updateAuthToken(e,n),{ticket:n.Tickets[0],token:this.tokenCache.get(t)})))}isTokenExpired(e){return ce.getCurrentTimeMs()>e.requestTime+this.tokenExpirationMs}}let Fo;const Bo=()=>{Fo=new Lo};Bo();const Wo=(e,t,n,o,r,s,i,a,l,c)=>{const u={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":r},body:JSON.stringify({payload:t.payload,payloadSchema:n,requestedSchema:o,clientMetadata:s,tokens:Fo.getAuthTokenEntries(i,l.docId)})};De(e,u,((u,d)=>{u?c(new Error(`Fetch error in remote lambda request to ${e}: ${u}`)):401===d.status?a>0?(b.tG.info(572838109,b.nh.CoreDefault,"Auth token required for remote lambda request"),d.json().then((e=>Fo.updateAuthToken(i,{Tickets:[e],DocId:l.docId}))).then((()=>{Wo(e,t,n,o,r,s,i,a-1,l,c)})).catch((e=>{c({exceptionType:pt.Authentication,message:e.message})}))):c({exceptionType:pt.Authentication,message:"Remote lambda request retry with authentication token failed"}):d.ok?d.json().then((e=>{if(Array.isArray(e))if(e.length>0){let n=0;for(const o of e)t.moreResults=++n<e.length,c(null,o)}else c(new Error("No output"));else c(new Error("Did not receive a valid response for remote lambda request"))})).catch((e=>{c({exceptionType:pt.LambdaThrow,message:e.message})})):c(new Error(`Remote lambda request failed with status ${d.status}`))}))},Uo=(e,t,n,o,r,s,i,a,l)=>{Array.isArray(a.authTickets)?Fo.updateAuthToken(i,{Tickets:a.authTickets,DocId:a.docId}).then((()=>{Wo(e,t,n,o,r.id,s,i,1,a,l)})).catch((e=>{l({exceptionType:pt.Authentication,message:e.message})})):Wo(e,t,n,o,r.id,s,i,1,a,l)};class Go{constructor(){this.hasBeenOpened=!1,this.hadEgressError=!1,this.lastEgressTime=0,this.lastPongTime=0,this.remainingPingFailures=3,this.egressMessageCount=0,this.egressByteCount=0,this.isClosing=!1,this.pendingEgress=[]}init(e,t,n,o){this.ws=new V(e),this.logOp=new L.I({operationName:Go.className,success:!0,dimension1:"V1"}).start(),this.egressTimer=Date.now(),this.egressMessageCountOp=new L.I({operationName:"WSEgressMessageCount",success:!0,dimension1:"V1"}),this.egressByteCountOp=new L.I({operationName:"WSEgressByteOrderOfMagnitude",success:!0,dimension1:"V1"}),this.ingressByteCountOp=new L.I({operationName:"WSIngressByteOrderOfMagnitude",success:!0,dimension1:"V1"});const r=e=>{this.logPingLatencyOp&&(this.logPingLatencyOp.success=e,b.tG.info(507789790,b.nh.CoreDefault,this.logPingLatencyOp.stop()),this.logPingLatencyOp=void 0)};this.ws.addEventListener("open",(e=>{n(),Go.logCountLimiter.log((()=>{this.logOp.resourceId="OnOpen",this.logOp.resultDescription="",this.logOp.success=!0,this.logOp.dimension0=this.pendingEgress.length.toString(),b.tG.info(507789789,b.nh.CoreDefault,this.logOp.stop())})),this.hasBeenOpened=!0,this.pendingEgress.forEach((e=>{this.egress({obj:e})})),this.pendingEgress=[],this.pingInterval=setInterval((()=>{this.logPingLatencyOp&&(--this.remainingPingFailures,r(!1)),this.remainingPingFailures>0&&this.hasBeenOpened&&this.lastPongTime<this.lastEgressTime&&(this.logPingLatencyOp=new L.I({operationName:"Ping",success:!0,dimension0:this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString().length.toString():void 0,dimension1:"V1"}).start(),this.ws.send(Go.pingPongMessage,(e=>{e&&(--this.remainingPingFailures,r(!1))})))}),3e4)})),this.ws.addEventListener("message",(e=>{this.logPingLatencyOp&&"string"==typeof e.data&&1===e.data.length&&e.data[0]===Go.pingPongMessage?(r(!0),this.lastPongTime=Date.now()):(this.logIngressCount(e.data),t(e.data))})),this.ws.addEventListener("error",(e=>{this.errorMessage=e.message,Go.logCountLimiter.log((()=>{this.logOp.resourceId="OnError",this.logOp.resultDescription=this.errorMessage,this.logOp.success=!1,b.tG.info(507789788,b.nh.CoreDefault,this.logOp.stop())})),this.ws.close()})),this.ws.addEventListener("close",(e=>{Go.logCountLimiter.log((()=>{this.logOp.resourceId="OnClose",this.logOp.resultDescription=e?`code: ${e.code}. reason: ${e.reason}`:"",this.logOp.success=!0,b.tG.info(507789787,b.nh.CoreDefault,this.logOp.stop())})),this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),o(this.errorMessage),this.isClosing=!1}))}egress(e){const t=e.obj;this.logEgressCount(t instanceof ArrayBuffer||t instanceof Uint8Array?t.byteLength:t.length),this.lastEgressTime=Date.now(),this.hasBeenOpened?this.ws.send(t,(e=>{e&&!this.hadEgressError&&(this.hadEgressError=!0,Go.logCountLimiter.log((()=>{this.logOp.resourceId="OnFirstEgressError",this.logOp.resultDescription=e.message,this.logOp.success=!1,b.tG.info(507789786,b.nh.CoreDefault,this.logOp.stop())})))})):this.pendingEgress.push(t)}close(){this.isClosing||(this.isClosing=!0,this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),this.ws.close())}logEgressCount(e){const t=Date.now(),n=t-this.egressTimer;n>1e3&&(this.egressMessageCount>50&&(this.egressMessageCountOp.start(),this.egressMessageCountOp.resultDescription="Egress message count: "+this.egressMessageCount.toString()+", Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+n.toString(),b.tG.info(507789785,b.nh.CoreDefault,this.egressMessageCountOp.stop())),this.egressByteCount>1e5&&(this.egressByteCountOp.start(),this.egressByteCountOp.dimension2=this.egressByteCount.toString().length.toString(),this.egressMessageCountOp.resultDescription="Buffered amount: "+(this.ws.bufferedAmount>=0?this.ws.bufferedAmount.toString():"-")+", Time elapsed: "+n.toString(),b.tG.info(507789784,b.nh.CoreDefault,this.egressByteCountOp.stop())),this.egressTimer=t,this.egressMessageCount=0,this.egressByteCount=0),this.egressMessageCount++,this.egressByteCount+=null!=e?e:0}logIngressCount(e){const t=e.length;t>1e5&&(this.ingressByteCountOp.start(),this.ingressByteCountOp.dimension2=t.toString().length.toString(),b.tG.info(507789783,b.nh.CoreDefault,this.ingressByteCountOp.stop()))}}Go.className="WebSocketWorker",Go.logCountLimiter=new ue(Go.className),Go.pingPongMessage="~";class Ho{constructor(e,t,n,o,r,s){this.requestId=e,this.correlationId=t,this.schemaName=n,this.data=o,this.callback=r,this.requestTimeoutInMs=s,this.ended=!1,this.startTime=0}startRequest(){this.startTime=ce.getCurrentTimeMs()}getMsUntilTimeout(){const e=ce.getCurrentTimeMs()-this.startTime;return this.requestTimeoutInMs-e}endRequest(e){this.ended||(this.invokeCallback(null,e,!0),this.ended=!0)}addResponseData(e){this.invokeCallback(e,null,!1)}invokeCallback(e,t,n){new Promise((()=>this.callback(e,t,n))).catch((e=>{}))}}let qo;const $o=()=>{qo=new Lo};$o();const Vo=new class{constructor(e,t,n){this.requestCounter=0,this.activeRequests=[],this.pendingRequests=[],this.requestTimeoutInMs=e,this.workerFactory=t,this.maxActiveRequests=n}testConnection(e,t){let n=!1;const o=new L.I({cv:(new J).toString(),operationName:"WebSocketTest",resourceId:H(e),success:!0}).start();return new Promise((r=>{const s=ce.createHealthCheckRequest(t);e?this.addRequest(e,s,o.cv,"HealthCheckRequest",((e,t,s)=>{t&&(o.success=!1,o.resultSignature="Error",o.resultDescription=t.message||t),e&&"OK"===e.status&&(n=!0),s&&(o.success&&!n&&(o.success=!1,o.resultSignature="NoResponseData"),b.tG.info(556617949,b.nh.CoreDefault,o.stop()),r(o.success))})):(o.success=!1,o.resultSignature="EmptyUrl",b.tG.info(557641870,b.nh.CoreDefault,o.stop()),r(o.success))}))}addRequest(e,t,n,o,r){const s=(this.requestCounter++).toString(),i=new Ho(s,n,o,t,r,this.requestTimeoutInMs);this.getWorker(e),this.pendingRequests.push(i),this.egressPendingRequests()}egressPendingRequests(){for(;this.pendingRequests.length>0&&this.activeRequests.length<this.maxActiveRequests;){const e=this.pendingRequests.shift();if(this.activeRequests.push(e),1===this.activeRequests.length){const t=e.getMsUntilTimeout();setTimeout(this.onTimeout.bind(this),t)}e.startRequest(),this.worker&&this.worker.egress({obj:this.createRequestMessage(e.data,e.requestId,e.correlationId)})}}createRequestMessage(e,t,n){return JSON.stringify({correlationId:n,requestId:t,body:e})}onTimeout(){for(;this.activeRequests.length>0;){const e=this.activeRequests[0],t=e.getMsUntilTimeout();if(!(t<=0))return void setTimeout(this.onTimeout.bind(this),t);{const t=new Error("Request timed out");e.endRequest(t),this.activeRequests.shift(),this.egressPendingRequests()}}}onMessage(e){try{const t=JSON.parse(e);for(let e=0;e<this.activeRequests.length;e++){const n=this.activeRequests[e];if(n.requestId===t.requestId){t.end?(this.activeRequests.splice(e,1),n.endRequest(t.error),this.egressPendingRequests()):t.body&&n.addResponseData(t.body);break}}}catch(e){b.tG.error(557641871,b.nh.CoreDefault,e)}}onClose(e){const t=new Error(`Connection closed: ${e}`);for(const e of this.activeRequests)e.endRequest(t);this.activeRequests=[];for(const e of this.pendingRequests)e.endRequest(t);this.pendingRequests=[],this.worker=void 0}getWorker(e){return this.worker||(this.worker=this.workerFactory(),this.worker.init(e,this.onMessage.bind(this),(()=>{}),this.onClose.bind(this))),this.worker}}(3e4,(()=>new Go),50),jo=(e,t,n,o,r,s,i,a,l,c)=>{const u={payload:t.payload,payloadSchema:n,requestedSchema:o,clientMetadata:s,tokens:qo.getAuthTokenEntries(i,l.docId)};let d="";o&&o.schema&&(d=o.schema.name);let h=!1;Vo.addRequest(e,u,r,d,((u,d,p)=>{if(!h)if(h=!0,null!=d)if(d.exceptionType===pt.Authentication)try{const u=JSON.parse(d.data);a>0?(b.tG.info(572838108,b.nh.CoreDefault,"Auth token required for remote lambda WebSocket request"),qo.updateAuthToken(i,{Tickets:[u],DocId:l.docId}).then((()=>{jo(e,t,n,o,r,s,i,a-1,l,c)})).catch((e=>{c({exceptionType:pt.Authentication,message:e.message})}))):c({exceptionType:pt.Authentication,message:"Remote lambda request retry with authentication token failed"})}catch(e){c({exceptionType:pt.Authentication,message:e.message})}else c(new Error(`Error in remote lambda WebSocket request to ${e}: ${d}`));else t.moreResults=!1,c(null,u)}))},zo=(e,t,n,o,r,s,i,a,l)=>{Array.isArray(a.authTickets)?qo.updateAuthToken(i,{Tickets:a.authTickets,DocId:a.docId}).then((()=>{jo(e,t,n,o,r.id,s,i,1,a,l)})).catch((e=>{l({exceptionType:pt.Authentication,message:e.message})})):jo(e,t,n,o,r.id,s,i,1,a,l)};class Qo{constructor(){this.cache=new Map,this.bucketSizes=new Map}setBucketSize(e,t){this.bucketSizes.set(e,t)}setResult(e,t,n){if(!t.primary)return;let o=this.cache.get(e);o||(o=new Map,this.cache.set(e,o));let r=o.get(t.primary);if(r||(r=t.secondary?new Map:[],o.set(t.primary,r)),t.secondary)r.set(t.secondary,n);else{const t=r;t.length==this.getBucketSize(e)&&t.shift(),t.push(n)}}getResults(e,t){const n=this.cache.get(e);if(n){const e=n.get(t.primary);if(e){if(!t.secondary)return e;const n=Array.from(e.values());if(n.length>0)return n}}return[]}clear(e,t){t?this.cache.forEach(((n,o)=>{if(!e||e===o)if(t.secondary){const e=n.get(t.primary);e&&e.delete(t.secondary)}else n.delete(t.primary)})):e?this.cache.delete(e):this.cache.clear()}getBucketSize(e){return this.bucketSizes.get(e)||10}}var Jo,Ko;!function(e){e[e.Unknown=0]="Unknown",e[e.Local=1]="Local",e[e.Custom=2]="Custom",e[e.Remote=3]="Remote",e[e.BatchedRemote=4]="BatchedRemote"}(Jo||(Jo={}));class Yo{constructor(){this.throttleInfoMap=new Map}execute(e,t,n){if(t.throttleSettings.shouldBeThrottled&&t.throttleSettings.throttlingInterval>0){const o=this.getWorkflowThrottleInfo(t.name);if(null==o.currentTileId)o.currentTileId=e,o.timeOfPreviousStartedEvent=ce.getCurrentTimeMs(),n();else if(o.currentTileId===e){const e=ce.getCurrentTimeMs(),r=this.delayTime(o,e,t.throttleSettings.throttlingInterval);r>0?(o.latestCallback=n,null==o.lastTimeout&&(o.lastTimeout=setTimeout((()=>{const e=this.getWorkflowThrottleInfo(t.name);e.lastTimeout=void 0,e.timeOfPreviousStartedEvent=ce.getCurrentTimeMs(),e.latestCallback()}),r))):(o.timeOfPreviousStartedEvent=e,n())}else null!=o.lastTimeout&&(clearTimeout(o.lastTimeout),o.latestCallback(),o.lastTimeout=void 0),o.currentTileId=e,o.timeOfPreviousStartedEvent=ce.getCurrentTimeMs(),n()}else n()}delayTime(e,t,n){const o=t-e.timeOfPreviousStartedEvent;return Math.max(n-o,0)}getWorkflowThrottleInfo(e){let t=this.throttleInfoMap.get(e);return t||(t={currentTileId:void 0,timeOfPreviousStartedEvent:-1,latestCallback:()=>{},lastTimeout:void 0},this.throttleInfoMap.set(e,t)),t}}!function(e){e[e.Restricted=0]="Restricted",e[e.Unrestricted=1]="Unrestricted",e[e.Suppressed=2]="Suppressed"}(Ko||(Ko={}));class Xo{constructor(){this.canaryTextTileEventSubmittedByDocSessionId=new Set,this.stateByDocSessionId=new Map,this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map}getOutputSchema(){return this.lambdas[this.lambdas.length-1].outputSchema}scheduleExecution(e,t){const n=this.docSessionIdExtractor?this.docSessionIdExtractor(e):void 0,o=this.getStateForDocSessionId(n);if(o===Ko.Restricted){const e=this.getExecutionQueueForDocSessionId(n);e.push(t),1===e.length&&t()}else o===Ko.Unrestricted?t():Ko.Suppressed}onStart(e){this.incrementExecutionCountForDocSessionId(e)}onFinish(e,t){if(this.decrementExecutionCountForDocSessionId(e),t===pt.Authentication)this.stateByDocSessionId.set(e,Ko.Suppressed),this.executionQueueByDocSessionId.delete(e);else if(this.stateByDocSessionId.get(e)===Ko.Restricted){const n=this.getExecutionQueueForDocSessionId(e);if(n.shift(),void 0===t){this.stateByDocSessionId.set(e,Ko.Unrestricted),this.executionQueueByDocSessionId.delete(e);for(const e of n)e()}else n.length>0&&(0,n[0])()}}onRefresh(e){this.stateByDocSessionId=new Map,this.triggerOnRefresh&&(e?(this.executionQueueByDocSessionId.delete(e),this.executionCountByDocSessionId.delete(e)):(this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map)),this.canaryTextTileEventSubmittedByDocSessionId.delete(e)}getStateForDocSessionId(e){let t=this.stateByDocSessionId.get(e);return void 0===t&&(t=Xo.executionQueuesEnabled?Ko.Restricted:Ko.Unrestricted,this.stateByDocSessionId.set(e,t)),t}getExecutionQueueForDocSessionId(e){let t=this.executionQueueByDocSessionId.get(e);return void 0===t&&(t=[],this.executionQueueByDocSessionId.set(e,t)),t}incrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;this.executionCountByDocSessionId.set(e,t+1)}decrementExecutionCountForDocSessionId(e){const t=this.executionCountByDocSessionId.get(e)||0;t<=1?this.executionCountByDocSessionId.delete(e):this.executionCountByDocSessionId.set(e,t-1)}}Xo.executionQueuesEnabled=!0;const Zo=e=>({category:Z.Schema,schema:{name:e}}),er="Tiling.TextTileEvent",tr="ClpSlideTile",nr=(e,t)=>e===er&&t&&t.type==Do.TextTileEventType.Refresh,or=(e,t)=>e===tr&&t&&t.eventType==Oo.SlideTileEventType.Refresh,rr=(e,t)=>nr(e,t)||or(e,t),sr=(e,t)=>{var n,o;return e===er?null===(o=null===(n=t.tile)||void 0===n?void 0:n.metadata)||void 0===o?void 0:o.docSessionId:e===tr?t.docId:void 0},ir=new class{constructor(){this.inputSchemasToWorkflows=new Map,this.inputSchemasToReduceWorkflows=new Map,this.reduceWorkflowsGroupingKeyExtractors=new Map,this.defaultWorkflowOptions={canProduceNullResult:!1,shouldSendResultsToHost:!0,enabledByDefault:!1,throttleSettings:{shouldBeThrottled:!1},triggerOnRefresh:!1},this.resultCache=new Qo,this.reduceTimerCache=new No,this.lookupTableCache=new Map,this.throttling=new Yo,this.lastTileRefreshSeq=-1,this.lastTileRefreshSeqByDocSessionId=new Map,this.tileRefreshByDocSessionIdEnabled=!0}init(e,t,n){const o=new L.I({operationName:"InitRuntimeALv1",resourceId:H(e)});o.start(),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=Eo()),this.hostCallbacks=n;const r=[];return r.push(this.isFeatureEnabled("DisableWebSocket").then((n=>!n&&(!(["Outlook Mac","Outlook Win32","PowerPoint Mac","PowerPoint Web","PowerPoint Win32","Word Mac","Word Win32"].indexOf(`${t.appName} ${t.appPlatform}`)>=0)||((e,t)=>Vo.testConnection(e,t))(ce.convertServiceUrlToWebSocket(e),this.clientMetadata)))).then((t=>{e&&(this.serviceUrl=t?ce.convertServiceUrlToWebSocket(e):e,this.executeRemoteLambda=t?zo:Uo,this.clearRemoteLambdaTokenCache=t?$o:Bo,this.serviceProtocol=this.serviceUrl.split(":")[0].toLowerCase())}))),r.push(this.isFeatureEnabled("WorkflowQueuesDisabled").then((e=>{Xo.executionQueuesEnabled=!e}))),r.push(this.isFeatureEnabled("TileRefreshByDocSessionIdDisabled").then((e=>{this.tileRefreshByDocSessionIdEnabled=!e}))),Promise.all(r).then((()=>{this.logOperation(o,!0)})).catch((e=>{this.logOperation(o,!1,"Error",e?e.message:"(no error)")}))}getServiceProtocol(){return this.serviceProtocol}registerSchemas(e,t){return Promise.resolve()}registerSimpleLocalWorkflow(e,t,n=this.defaultWorkflowOptions){return t.source=t.source||Jo.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToWorkflows,n)}registerSimpleRemoteWorkflow(e,t,n,o,r=this.defaultWorkflowOptions){const s=[];return t&&(t.source=Jo.Custom,s.push(t)),n.source=n.func?Jo.Custom:Jo.Remote,s.push(n),o&&(o.source=Jo.Custom,s.push(o)),this.registerHardcodedWorkflow(e,s,this.inputSchemasToWorkflows,r)}registerMultipleLambdasWorkflow(e,t,n=this.defaultWorkflowOptions){return this.registerHardcodedWorkflow(e,t,this.inputSchemasToWorkflows,n)}registerReduceWorkflow(e,t,n,o=10,r=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t.inputSchema,n),this.resultCache.setBucketSize(t.inputSchema,o),t.source=t.source||Jo.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToReduceWorkflows,r)}registerMultipleLambdasReduceWorkflow(e,t,n,o=10,r=this.defaultWorkflowOptions){return this.reduceWorkflowsGroupingKeyExtractors.set(t[0].inputSchema,n),this.resultCache.setBucketSize(t[0].inputSchema,o),this.registerHardcodedWorkflow(e,t,this.inputSchemasToReduceWorkflows,r)}submit(e,t,n){this.submitToWorkflows(e,t,n,this.inputSchemasToWorkflows)}getGroupingKey(e,t,n){const o=this.reduceWorkflowsGroupingKeyExtractors.get(n);if(null==o)throw new Error("Reduce workflow does not have a grouping extractor");return o(t,e)}submitToWorkflows(e,t,n,o=this.inputSchemasToWorkflows){if(!this.hostCallbacks)return;let r;r=n?J.fromString(n):new J,this.handleTileRefresh(e,t,r);const s=o.get(e)||[];for(const n of s)rr(e,t)&&!n.triggerOnRefresh||(n.useCanaryTextTile&&e===er&&!n.canaryTextTileEventSubmittedByDocSessionId.has(sr(e,t))&&(this.submitToWorkflow(er,{type:(i=t).type,tile:{metadata:{docSessionId:i.tile.metadata.docSessionId,docId:i.tile.metadata.docId,seqnoCLPRefresh:i.tile.metadata.seqnoCLPRefresh,tileId:"A56B3127DBDFD0D6"},elements:[{text:"B91153AE828B4E48"}]}},r,n,o),n.canaryTextTileEventSubmittedByDocSessionId.add(sr(e,t))),this.submitToWorkflow(e,t,r,n,o));var i}submitToWorkflow(e,t,n,o,r){const s={messageType:ht.Input,correlationVector:n.newChild(),payload:t,payloadSchema:Zo(o.lambdas[0].inputSchema),clientMetadata:this.clientMetadata},i=new L.I({cv:s.correlationVector.toString(),operationName:"ExecuteWorkflow",resourceId:o.name});i.setClientMetadata(this.clientMetadata),i.start(),o.scheduleExecution(t,(()=>{try{if(s.payload&&s.payload.tile&&s.payload.tile.metadata&&s.payload.tile.metadata.tileId){const n=s.payload.tile.metadata.tileId;this.throttling.execute(n,o,(()=>this.executeWorkflow(i,s,t,o,e,r)))}else this.executeWorkflow(i,s,t,o,e,r)}catch(e){i.success=!1,i.resultSignature="ExecuteException",i.resultDescription=e?e.message:"(no error)",b.tG.error(559290447,b.nh.CoreDefault,i.stop())}}))}handleTileRefresh(e,t,n){if(!rr(e,t))return;const o=this.tileRefreshByDocSessionIdEnabled?sr(e,t):void 0,r=((e,t)=>{var n,o;return nr(e,t)?null===(o=null===(n=t.tile)||void 0===n?void 0:n.metadata)||void 0===o?void 0:o.seqnoCLPRefresh:(or(e,t),-1)})(e,t);if(this.tileRefreshByDocSessionIdEnabled){const e=this.lastTileRefreshSeqByDocSessionId.get(o);if(e>=0&&r<=e)return}else if(r<=this.lastTileRefreshSeq)return;const s=new L.I({cv:n.toString(),operationName:"TileRefresh",resultDescription:"",success:!0});if(s.start(),this.tileRefreshByDocSessionIdEnabled&&!o)return s.success=!1,s.resultDescription="NoDocSessionId",void b.tG.info(559290448,b.nh.CoreDefault,s.stop());this.inputSchemasToReduceWorkflows.forEach(((e,t)=>{e.some((e=>e.triggerOnRefresh))&&(this.tileRefreshByDocSessionIdEnabled?(this.resultCache.clear(t,{primary:o}),this.resultCache.clear(this.getForcedDocLevelSchema(t),{primary:o}),this.reduceTimerCache.clear(t,o)):(this.resultCache.clear(t),this.resultCache.clear(this.getForcedDocLevelSchema(t)),this.reduceTimerCache.clear(t)),e.some((e=>!e.triggerOnRefresh))&&(s.resultDescription+="X_"),s.resultDescription+=t+" ")})),this.clearRemoteLambdaTokenCache();const i=[];this.inputSchemasToWorkflows.forEach((e=>i.push(...e))),this.inputSchemasToReduceWorkflows.forEach((e=>i.push(...e)));for(const e of i)this.tileRefreshByDocSessionIdEnabled?e.onRefresh(o):e.onRefresh();this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.set(o,r):this.lastTileRefreshSeq=r,b.tG.info(559290449,b.nh.CoreDefault,s.stop())}executeWorkflow(e,t,n,o,r,s){const i=o.docIdExtractor?o.docIdExtractor(t.payload):void 0,a=o.docSessionIdExtractor(n),l=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(a):this.lastTileRefreshSeq;o.onStart(a);const c=t=>{const i=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(a):this.lastTileRefreshSeq;if(o.triggerOnRefresh&&i!==l)return e.success=!0,e.resultSignature="TileRefreshIgnore",void b.tG.info(559290450,b.nh.CoreDefault,e.stop());const c=t.messageType==ht.Exception&&t.payload.exceptionType==pt.NoOutput,u=c&&o.canProduceNullResult,d=u?o.lambdas[o.lambdas.length-1].outputSchema:t.payloadSchema.schema.name,h=u?null:t.payload;t.messageType===ht.Input||u?(o.shouldSendResultsToHost&&(s===this.inputSchemasToReduceWorkflows?this.hostCallbacks.onResult("Reduce.Input",n,d,h):this.hostCallbacks.onResult(r,n,d,h)),e.success=!0,e.resultSignature=c?"NoOutput":"ValidOutput"):c?(e.success=!0,e.resultSignature="NoOutput"):(e.success=!1,e.resultSignature="Exception",e.resultDescription=xo(t)),s!==this.inputSchemasToReduceWorkflows&&this.updateResultCacheForReduceWorkflows(r,n,d,h,t.correlationVector.toString()),t.moreResults||(e.stop(),b.tG.info(559290451,b.nh.CoreDefault,e),o.onFinish(a,t.payload&&t.payload.exceptionType?(e=>null==e||null==e.payload||null==e.payload.exceptionType?pt.Unknown:e.payload.exceptionType)(t):void 0))};o.preExecutionPromise.then((()=>{const e={lookupTable:this.lookupTableCache.get(o.name),docId:i,docSessionId:a};let n=c;for(let t=o.lambdas.length-1;t>=0;t--)n=this.createLambdaExecutionStep(o.name,o.lambdas[t],e,n,c);n(t)}))}getForcedDocLevelSchema(e){return`~${e}`}updateResultCacheForReduceWorkflows(e,t,n,o,r){const s=this.inputSchemasToReduceWorkflows.get(n);if(s){let i;"docSessionId"===e?(i=this.getGroupingKey(e,t,n),this.resultCache.setResult(this.getForcedDocLevelSchema(n),i,o),i.secondary="*"):(i=this.getGroupingKey(e,t,n),((e,t)=>e===er&&t&&t.type==Do.TextTileEventType.Delete||e===tr&&t&&t.eventType==Oo.SlideTileEventType.Delete)(e,t)&&null!=i.primary&&null!=i.secondary?this.resultCache.clear(void 0,i):this.resultCache.setResult(n,i,o));const a=s.some((e=>e.deferReduceUntilIdle)),l=[];this.inputSchemasToWorkflows.forEach((e=>l.push(...e.filter((e=>e.getOutputSchema()===n)))));const c=()=>a&&l.some((e=>e.executionCountByDocSessionId.get(i.primary)>0)),u=s.map((e=>e.deferReduceUntilIdleMaxDelayMs||0)).reduce(((e,t)=>Math.max(e,t)));this.reduceTimerCache.setReduceTimer(n,i.primary,(()=>{const e=this.resultCache.getResults(n,i);if(e.push(...this.resultCache.getResults(this.getForcedDocLevelSchema(n),{primary:i.primary})),Array.isArray(e)){const t={id:i.primary,values:e,isReduceInput:!0};this.submitToWorkflows(n,t,r,this.inputSchemasToReduceWorkflows)}else b.tG.error(559290452,b.nh.CoreDefault,`Cached results have unexpected type "${typeof e}"`)}),500,c,u)}}isFeatureEnabled(e,t=!1,n="None"){return this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+e,n).catch((()=>Promise.resolve(t))):Promise.resolve(t)}areLicenseFeaturesEnabled(e){return this.hostCallbacks&&this.hostCallbacks.areLicenseFeaturesEnabled?this.hostCallbacks.areLicenseFeaturesEnabled(e).catch((()=>Promise.resolve(!1))):Promise.resolve(!1)}isWorkflowEnabled(e,t,n,o,r){if(t.some((e=>e.source===Jo.Remote||e.source===Jo.BatchedRemote))){if(!this.serviceUrl)return r.resultDescription="Disabled because no service URL available for remote workflow",Promise.resolve(!1);if(this.clientMetadata&&this.clientMetadata.privateMode&&t.some((e=>(e.source===Jo.Remote||e.source===Jo.BatchedRemote)&&!e.canRunInPrivateMode)))return r.resultDescription="Disabled because we are running in private mode",Promise.resolve(!1)}let s;return(!this.clientMetadata||"Mac"!==this.clientMetadata.appPlatform&&"Win32"!==this.clientMetadata.appPlatform)&&(o=!0,r.resultDescription="Enabled by default due to platform name"),s=o?Promise.resolve(!0):this.isFeatureEnabled("WorkflowEnabled."+e),s.then((t=>t?this.isFeatureEnabled("WorkflowDisabled."+e).then((e=>e?(r.resultDescription="Disabled because explicitly disabled",!1):!n||this.areLicenseFeaturesEnabled(n).then((e=>(e||(r.resultDescription="Disabled because license check failed"),e))))):(r.resultDescription="Disabled because not explicitly enabled",!1)))}registerHardcodedWorkflow(e,t,n=this.inputSchemasToWorkflows,o){if(!e||e.length>40)throw new Error("Workflow name has invalid length");if(!1===new RegExp(/^[A-Z][a-zA-Z0-9_]+$/).test(e))throw new Error("Workflow name has invalid format");n.forEach((t=>{if(t.some((t=>t.name===e)))throw new Error("Workflow name already registered.")}));const r=new L.I({operationName:"WorkflowRegistration",resourceId:e,success:!0});return r.setClientMetadata(this.clientMetadata),r.start(),this.isWorkflowEnabled(e,t,o.licenseFeatures,o.enabledByDefault,r).then((s=>{if(r.resultSignature=s?"Enabled":"Disabled",r.stop(),b.tG.info(559290453,b.nh.CoreDefault,r),s){const r=t[0].inputSchema;let s=n.get(r);s||(s=[],n.set(r,s));let i=Promise.resolve();o.lookupTableLambda&&(i=new Promise(((t,n)=>{const r=new J,s={messageType:ht.Input,correlationVector:r,payloadSchema:Zo(o.lookupTableLambda.inputSchema),clientMetadata:this.clientMetadata,payload:{}},i=n=>{n.messageType===ht.Input&&n.payload&&this.lookupTableCache.set(e,n.payload),t()};this.createLambdaExecutionStep("",o.lookupTableLambda,{},i,i)(s)})));const a=new Xo;a.name=e,a.lambdas=t,a.canProduceNullResult=o.canProduceNullResult,a.shouldSendResultsToHost=o.shouldSendResultsToHost,a.triggerOnRefresh=o.triggerOnRefresh,a.throttleSettings=o.throttleSettings||this.defaultWorkflowOptions.throttleSettings,a.docIdExtractor=o.docIdExtractor,a.docSessionIdExtractor=e=>e.isReduceInput?e.id:sr(r,e),a.deferReduceUntilIdle=o.deferReduceUntilIdle,a.deferReduceUntilIdleMaxDelayMs=o.deferReduceUntilIdleMaxDelayMs,a.useCanaryTextTile=o.useCanaryTextTile,a.preExecutionPromise=i,s.push(a)}}))}logOperation(e,t,n,o){e.stop(),e.success=t,e.resultSignature=n,e.resultDescription=o,b.tG.info(559290454,b.nh.CoreDefault,e)}handleLambdaError(e,t,n,o,r){null!=e.exceptionType?Ro(t,e):e instanceof Error?Ro(t,{exceptionType:o,message:e.message}):Ro(t,{exceptionType:pt.Unknown,message:e?e.toString():void 0}),this.logOperation(n,!1,"Exception",xo(t)),r(t)}handleLambdaOutput(e,t,n,o,r,s){e&&e.exceptionType!==pt.NoOutput?null!=e.exceptionType?this.handleLambdaError(e,t,n,e.exceptionType,s):e instanceof Error?this.handleLambdaError(e,t,n,pt.LambdaErrorCallback,s):(t.payload=e,t.payloadSchema=Zo(o),this.logOperation(n,!0),r(t)):(Ro(t,{exceptionType:pt.NoOutput}),this.logOperation(n,!0,"NoOutput"),s(t))}executeCustomLambdaStep(e,t,n,o,r,s){if(null==n.func)Ro(e,{exceptionType:pt.LambdaThrow,message:"No lambda function set"}),this.logOperation(t,!1,"Error",xo(e)),s(e);else{const i=o=>{this.handleLambdaOutput(o,e,t,n.outputSchema,r,s)},a=(n,o)=>{this.handleLambdaOutput(n,e,t,o,s,s)};try{n.func(e.payload,n.config,o,i,a)}catch(n){this.handleLambdaError(n,e,t,pt.LambdaThrow,s)}}}executeLocalLambdaStep(e,t,n,o,r){null==this.hostCallbacks.executeLocalLambda?(Ro(e,{exceptionType:pt.LambdaThrow,message:"No local lambda host callback set"}),this.logOperation(t,!1,"Error",xo(e)),r(e)):this.hostCallbacks.executeLocalLambda(n.inputSchema,e.payload,n.outputSchema).then((s=>{this.handleLambdaOutput(s,e,t,n.outputSchema,o,r)})).catch((n=>{this.handleLambdaError(n,e,t,pt.LambdaThrow,r)}))}executeRemoteLambdaStep(e,t,n,o,r,s){if(this.serviceUrl){t.resourceId+=`.${this.serviceProtocol}`;const i=(o,i)=>{o?this.handleLambdaError(o,e,t,o.exceptionType||pt.LambdaErrorCallback,s):this.handleLambdaOutput(i,e,t,n.outputSchema,r,s)};if(o.authTickets=n.authTickets,n.source===Jo.Remote)this.executeRemoteLambda(this.serviceUrl,e,Zo(n.inputSchema),Zo(n.outputSchema),e.correlationVector,this.clientMetadata,this.hostCallbacks,o,i);else{this.batchedRemoteLambdaManager||(this.batchedRemoteLambdaManager=new St(((e,t,n)=>{const{remoteLambda:o,lambdaContext:r}=t.context;this.executeRemoteLambda(this.serviceUrl,{messageType:ht.Input,correlationVector:{id:t.cv},payload:e,payloadSchema:Zo(o.inputSchema),clientMetadata:this.clientMetadata},Zo(o.remoteInputSchema),Zo(o.remoteOutputSchema),{id:t.cv},this.clientMetadata,this.hostCallbacks,r,n)}),!1,!1,((e,t,n)=>{var o;const{lambdaContext:r}=n;this.updateResultCacheForReduceWorkflows("docSessionId",null!==(o=r.docSessionId)&&void 0!==o?o:r.docId,e,t)})));const{batchOptions:t}=n,r=this.normalizeBatchOptions(t),{groupingKeyExtractor:s}=r;r.groupingKeyExtractor=e=>`${n.name}-${s(e)}`;const a={name:n.name,remoteLambda:n,lambdaContext:o};this.batchedRemoteLambdaManager.addBatchItem(e.payload,r,a,e.correlationVector.id.length>127?e.correlationVector.id.substring(0,127)+"!":e.correlationVector.id,void 0,i)}}else Ro(e,{exceptionType:pt.LambdaThrow,message:"No URL for remote lambda"}),this.logOperation(t,!1,"Error",xo(e)),s(e)}createLambdaExecutionStep(e,t,n,o,r){return s=>{const i=new L.I({cv:s.correlationVector.toString(),operationName:"ExecuteLambda",resourceId:t.name,dimension0:e});i.start(),t.source===Jo.Custom?this.executeCustomLambdaStep(s,i,t,n,o,r):t.source===Jo.Local?this.executeLocalLambdaStep(s,i,t,o,r):t.source===Jo.Remote||t.source===Jo.BatchedRemote?this.executeRemoteLambdaStep(s,i,t,n,o,r):(Ro(s,{exceptionType:pt.LambdaThrow,message:"Unknown/No lambda location set"}),this.logOperation(i,!1,"Error",xo(s)),r(s))}}normalizeBatchOptions(e){if(!e)throw new Error("Expected batchConfig");const t=Object.assign({},e);return e.estimateSize||(t.estimateSize=kn),t}},ar=(e,t)=>t.some((t=>e instanceof t));let lr,cr;const ur=new WeakMap,dr=new WeakMap,hr=new WeakMap,pr=new WeakMap,fr=new WeakMap;let gr={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return dr.get(e);if("objectStoreNames"===t)return e.objectStoreNames||hr.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return yr(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function mr(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(cr||(cr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(vr(this),e),yr(ur.get(this))}:function(...e){return yr(t.apply(vr(this),e))}:function(e,...n){const o=t.call(vr(this),e,...n);return hr.set(o,e.sort?e.sort():[e]),yr(o)}:(e instanceof IDBTransaction&&function(e){if(dr.has(e))return;const t=new Promise(((t,n)=>{const o=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",s),e.removeEventListener("abort",s)},r=()=>{t(),o()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",r),e.addEventListener("error",s),e.addEventListener("abort",s)}));dr.set(e,t)}(e),ar(e,lr||(lr=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,gr):e);var t}function yr(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const o=()=>{e.removeEventListener("success",r),e.removeEventListener("error",s)},r=()=>{t(yr(e.result)),o()},s=()=>{n(e.error),o()};e.addEventListener("success",r),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&ur.set(t,e)})).catch((()=>{})),fr.set(t,e),t}(e);if(pr.has(e))return pr.get(e);const t=mr(e);return t!==e&&(pr.set(e,t),fr.set(t,e)),t}const vr=e=>fr.get(e),br=["get","getKey","getAll","getAllKeys","count"],Sr=["put","add","delete","clear"],wr=new Map;function Tr(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(wr.get(t))return wr.get(t);const n=t.replace(/FromIndex$/,""),o=t!==n,r=Sr.includes(n);if(!(n in(o?IDBIndex:IDBObjectStore).prototype)||!r&&!br.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,r?"readwrite":"readonly");let i=s.store;return o&&(i=i.index(t.shift())),(await Promise.all([i[n](...t),r&&s.done]))[0]};return wr.set(t,s),s}var _r,Cr,kr;kr=gr,gr={...kr,get:(e,t,n)=>Tr(e,t)||kr.get(e,t,n),has:(e,t)=>!!Tr(e,t)||kr.has(e,t)},function(e){e.URL="URL",e.ArrayBuffer="ArrayBuffer"}(_r||(_r={}));class Er{constructor(e,t,n,o){this.dbName="ALModels_db",this.osName="ALModels_os",this.dbVersion=2,this.modelPathsCache=new Map,this.isPolymerSupported=Boolean(n),this.baseURL=`https://${t}/web/${e}`,this.polymerBaseURL=this.isPolymerSupported?`https://${n}`:"",this.fetchResource=null!=o?o:"undefined"!=typeof fetch?fetch:xe.fetch;const r=new L.I({operationName:"CreateModelDownloader",success:!0,resultDescription:""});r.start(),this.isBrowserIdbCompatible().then((e=>{if(e){let e,t=0,n=0,o=0;const s=new Promise(((t,n)=>{e=setTimeout((()=>{n(new Error("Took longer than 10000 ms"))}),1e4)})),i=this.accessDB().then((e=>{const r=e.transaction(this.osName,"readwrite");return r.objectStore(this.osName).openCursor().then((function e(s){if(o++,s){const o=s.value;let r;return o.timesSinceUsage||(o.timesSinceUsage=0),o.timesSinceUsage++,o.timesSinceUsage>5?(n++,r=s.delete()):(t++,r=s.update(o)),r.then((()=>s.continue())).then(e)}return r.done}))}));this.initPromise=Promise.race([s,i]).catch((e=>{r.success=!1,r.resultDescription+=`${e.message} `})).then((()=>{r.dimension0=`${o}`,r.dimension1=`${t}`,r.dimension2=`${n}`,clearTimeout(e),this.closeDBAndEndLog(r,"initializing idb storage")}))}else r.resultDescription="Incompatible browser for IDB",b.tG.info(538706242,b.nh.CoreDefault,r.stop())})).catch((()=>{r.resultDescription="Issue determining idb compatibility",b.tG.info(536966936,b.nh.CoreDefault,r.stop())}))}getResourceAsArrayBuffer(e,t,n){const o=new L.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:_r.ArrayBuffer,dimension1:e,dimension2:t});o.start();const r={};return this.getResource(e,t,n,_r.ArrayBuffer,o,(e=>Promise.all(Array.from(e.keys()).map((t=>{const n=e.get(t);return n.arrayBuffer?n.arrayBuffer().then((e=>{r[t]=e})):new Promise(((e,o)=>{const s=new FileReader;s.readAsArrayBuffer(n),s.onload=n=>{const s=n.target.result;s instanceof ArrayBuffer?(r[t]=s,e()):o(new Error("Unable to obtain ArrayBuffer"))}}))}))))).then((()=>r))}getKey(e,t,n){return n?`${e}_${t}_${JSON.stringify(Array.from(n.entries()))}`:`${e}_${t}`}updateCache(e,t,n,o){this.modelPathsCache.set(this.getKey(e,t,n),o)}getCache(e,t,n){return this.modelPathsCache.get(this.getKey(e,t,n))}getResourceAsURL(e,t,n){const o=new L.I({operationName:"GetResource",success:!0,resultDescription:"",dimension0:_r.URL,dimension1:e,dimension2:t});o.start();const r={},s=this.getCache(e,t,n);return s?Promise.resolve(s):this.getResource(e,t,n,_r.URL,o,(e=>Promise.all(Array.from(e.keys()).map((t=>{r[t]=URL.createObjectURL(e.get(t))}))))).then((()=>this.getCache(e,t,n)||(this.updateCache(e,t,n,r),r)))}getResource(e,t,n,o,r,s){return this.getFiles(e,t,n,r).then((e=>s(e))).then((()=>{this.closeDBAndEndLog(r,`retrieving ${e}`)})).catch((t=>{throw r.resultDescription.indexOf(t.message)>=0&&(r.success=!1,r.resultDescription+=`${t.message} `),r.resultSignature=`Issue retrieving from CDN or translating to ${o}`,this.closeDBAndEndLog(r,`retrieving ${e}`),t}))}checkFirefoxCompatibility(e){const t=globalThis.navigator.userAgent.substring(e+8,e+11);return t.replace(".",""),parseInt(t,10)<=70?new Promise((function(e,t){const n=globalThis.indexedDB.open(this.dbName,this.dbVersion);n.onsuccess=function(){e(!0)},n.onerror=function(e){return t(e),!0}})):Promise.resolve(!0)}isBrowserIdbCompatible(){var e,t;return"undefined"==typeof Array||void 0===Array.from||"undefined"==typeof Proxy||"undefined"==typeof URL||void 0===URL.createObjectURL?Promise.resolve(!1):"undefined"!=typeof globalThis&&(null===(e=globalThis.navigator)||void 0===e?void 0:e.userAgent)?globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")>-1?globalThis.indexedDB?this.checkFirefoxCompatibility(globalThis.navigator.userAgent.toLowerCase().indexOf("firefox")):Promise.resolve(!1):globalThis.navigator.userAgent.toLowerCase().indexOf("safari")>-1&&globalThis.navigator.userAgent.toLowerCase().indexOf("chrome")<=-1?(null===(t=globalThis.document)||void 0===t?void 0:t.hasStorageAccess)?globalThis.document.hasStorageAccess().then((()=>!0)).catch((()=>!1)):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)}accessDB(){return this.accessDBPromise?this.accessDBPromise.then((e=>e.transaction(this.osName).done)).then((()=>this.accessDBPromise)).catch((()=>this.callOpenDB())):this.callOpenDB()}callOpenDB(){return this.accessDBPromise=function(e,t,{blocked:n,upgrade:o,blocking:r,terminated:s}={}){const i=indexedDB.open(e,t),a=yr(i);return o&&i.addEventListener("upgradeneeded",(e=>{o(yr(i.result),e.oldVersion,e.newVersion,yr(i.transaction))})),n&&i.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),r&&e.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}(this.dbName,this.dbVersion,{upgrade:e=>{e.objectStoreNames.contains(this.osName)&&e.deleteObjectStore(this.osName),e.createObjectStore(this.osName,{keyPath:"id",autoIncrement:!0})}})}endLog(e,t){e.success?(e.resultDescription=`Success ${t}`,b.tG.info(573329487,b.nh.CoreDefault,e.stop())):(e.resultDescription+=`error ${t}`,b.tG.error(573329488,b.nh.CoreDefault,e.stop()))}closeDBAndEndLog(e,t){this.accessDBPromise?this.accessDBPromise.then((e=>{e.close()})).catch((t=>{e.resultDescription.indexOf(t.message)>=0&&(e.success=!1,e.resultDescription+=`${t.message?t.message:"Error closing db"} `,e.resultSignature="Issue closing db")})).then((()=>{this.accessDBPromise=void 0,this.endLog(e,t)})):this.endLog(e,t)}getFiles(e,t,n,o){return this.isBrowserIdbCompatible().catch((e=>(o.success=!1,o.resultDescription+=`${e.message} `,o.resultSignature="Issue determining idb compatibility",!1))).then((r=>{const s=()=>{if(n){if(this.isPolymerSupported)return this.downloadFiles1CDN(e,t,n,o,r);throw new Error("Missing polymerBaseURL provided at host level for queries with modelFilters")}return this.downloadFiles(e,t,o,r)};return r?this.getFilesFromIDB(e,t,n,o).catch((e=>(e&&(o.resultDescription.indexOf(e.message)>=0&&(o.success=!1,o.resultDescription+=`${e.message} `),o.resultSignature="Issue retrieving from DB"),s()))):s()}))}getFilesFromIDB(e,t,n,o){return this.initPromise.catch((e=>{o.success=!1,o.resultDescription+=`${e.message} `,o.resultSignature="Issue initializing"})).then((()=>this.getModelOptions(e))).then((r=>{for(const s of r)if(s&&s.model&&s.version==t){if(!this.checkModelFiltersPass(n,s.filters))continue;return this.putModel(e,s.model,t,s.filters,o,s.id),Promise.resolve(s.model)}return Promise.reject()}))}checkModelFiltersPass(e,t){var n;for(const o of e){const e=null===(n=t.get(o[0]))||void 0===n?void 0:n.map((e=>e.toLocaleLowerCase()));if(!e)throw new Error(`Expected filter ${o[0]} to exist in metadata file`);if(e.indexOf(o[1].toLocaleLowerCase())<0)return!1}return!0}downloadFiles1CDN(e,t,n,o,r){let s;return o.dimension3="Polymer",n||(n=new Map),this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/metadata.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((r=>{var i,a;const l=JSON.parse(r);if(l.name!==e||l.version!==t)throw new Error(`Expected: ${e} version ${t}, received: ${l.name} version ${l.version}`);for(const e of l.variants)if(s=new Map(Object.entries(e)),this.checkModelFiltersPass(n,s))return(l.catalog?n.size+2:n.size+1!==s.size)&&(o.success=!1,o.resultDescription+=`Expected ${null===(i=s.keys)||void 0===i?void 0:i.length} # of filters, received ${null===(a=n.keys)||void 0===a?void 0:a.length}`),e.model_files;throw new Error("No model found with given filters")})).then((n=>Promise.all(n.map((n=>this.fetchResource(`${this.polymerBaseURL}/${e}/${t}/${n}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((e=>[n,e]))))))).then((n=>{const i=new Map(n);return r?this.putModel(e,i,t,s,o):i}))}downloadFiles(e,t,n,o){return n.dimension3="FS",this.fetchResource(`${this.baseURL}/catalog_${e}_${t}.json`).then((e=>{if(e.ok)return e.text();throw new Error(`CDN download response status: ${e.status}`)})).then((n=>{const o=JSON.parse(n),r=`${o.MajorVersion}.${o.MinorVersion}/ModelResources`,s=`${e}/${t}/`;return Promise.all(o.Resources.map((e=>(e.Name.length>s.length&&e.Name.substring(0,s.length)===s&&(e.Name=e.Name.substring(s.length)),this.fetchResource(`${this.baseURL}/${r}/${s}${e.Name}.${e.Type}`).then((e=>{if(e.ok)return e.blob();throw new Error(`CDN download response status: ${e.status}`)})).then((t=>[`${e.Name}.${e.Type}`,t]))))))})).then((r=>{const s=new Map(r);return o?this.putModel(e,s,t,new Map,n):s}))}getModelOptions(e){return this.accessDB().then((t=>{const n=[],o=t.transaction(this.osName,"readonly");return o.objectStore(this.osName).openCursor().then((function t(r){if(r){const o=r.value;return o.modelId==e&&n.push(o),r.continue().then(t)}return o.done})).then((()=>n))}))}putModel(e,t,n,o,r,s){return o||(o=new Map),this.accessDB().then((r=>r.put(this.osName,{modelId:e,model:t,version:n,filters:o,timesSinceUsage:0},s))).catch((e=>{r.resultDescription.indexOf(e.message)>=0&&(r.success=!1,r.resultDescription+=`${e.message} `),r.resultSignature="Issue adding to DB"})).then((()=>t))}}!function(e){e[e.None=0]="None",e[e.Booleans=1]="Booleans",e[e.Float32s=2]="Float32s",e[e.Float64s=3]="Float64s",e[e.Int8s=4]="Int8s",e[e.Int16s=5]="Int16s",e[e.Int32s=6]="Int32s",e[e.Strings=7]="Strings",e[e.UnsignedInt8s=8]="UnsignedInt8s",e[e.UnsignedInt16s=9]="UnsignedInt16s",e[e.UnsignedInt32s=10]="UnsignedInt32s"}(Cr||(Cr={}));var Ar=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class Ir{constructor(e,t,n){this.session=e,this.onnxObject=n,this.modelName=t}static create(e,t,n){return Ar(this,void 0,void 0,(function*(){const o=new L.I({operationName:"CreateModelForInferencing",success:!0,resourceId:t});return o.start(),n[e]?(o.resultDescription="Model already existed",b.tG.info(509699716,b.nh.CoreDefault,o.stop()),n[e]):n[e]=this.getInferenceSession(n).create(e).then((e=>(b.tG.info(540406807,b.nh.CoreDefault,o.stop()),new Ir(e,t,n)))).catch((e=>{throw o.resultDescription=`Error: ${e}`,b.tG.info(540406808,b.nh.CoreDefault,o.stop()),e}))}))}static getInferenceSession(e){if(null==e?void 0:e.InferenceSession)return e.InferenceSession;throw new Error("InferenceSession is not defined")}run(e){var t;return Ar(this,void 0,void 0,(function*(){const n=new L.I({operationName:"RunModelForInferencing",success:!0,resourceId:this.modelName});if(n.start(),null===(t=this.onnxObject)||void 0===t?void 0:t.Tensor){const t=e.getInputs(),o={};return Object.keys(t).forEach((e=>{const n=t[e];if(Array.isArray(n.values)&&n.values.length>0&&"boolean"==typeof n.values[0]){const t=new Uint8Array(n.values);o[e]=new this.onnxObject.Tensor(t,n.dimensions)}else o[e]=new this.onnxObject.Tensor(n.values,n.dimensions)})),this.session.run(o).then((e=>(b.tG.info(540406809,b.nh.CoreDefault,n.stop()),new Mr(e)))).catch((e=>{n.resultDescription=`Problem running model. ${e.message}`,b.tG.info(540406810,b.nh.CoreDefault,n.stop())}))}throw n.resultDescription="Unable to run model. Tensor not defined",b.tG.info(540406811,b.nh.CoreDefault,n.stop()),new Error("Tensor is not defined")}))}}class Pr{constructor(){this.map={}}static create(){return new Pr}getInputs(){return this.map}add(e,t,n){return this.map[e]={dimensions:t,values:n},this}}class Mr{constructor(e){for(const t of Object.keys(e))this[t]=new xr(t,e[t])}}class xr{constructor(e,t){this.resultName=e,this.result=t}name(){return this.resultName}outputType(){switch(this.result.type){case"string":return Cr.Strings;case"int8":return Cr.Int8s;case"int16":return Cr.Int16s;case"int32":return Cr.Int32s;case"bool":return Cr.Booleans;case"uint8":return Cr.UnsignedInt8s;case"uint16":return Cr.UnsignedInt16s;case"uint32":return Cr.UnsignedInt32s;case"float32":return Cr.Float32s;case"float64":return Cr.Float64s;default:throw new Error(`The output type ${this.result.type} is not supported.`)}}dimensions(){return this.result.dims}asBooleans(){if(this.outputType()===Cr.Booleans)return this.result.data.map((e=>!!e));throw new Error(`asBooleans() was called; however, outputType() is ${this.outputType()}, not Type.Booleans.`)}asFloat32s(){if(this.outputType()===Cr.Float32s)return this.result.data;throw new Error(`asFloat32s() was called; however, outputType() is ${this.outputType()}, not Type.Float32s.`)}asFloat64s(){if(this.outputType()===Cr.Float64s)return this.result.data;throw new Error(`asFloat64s() was called; however, outputType() is ${this.outputType()}, not Type.Float64s.`)}asInt8s(){if(this.outputType()===Cr.Int8s)return this.result.data;throw new Error(`asInt8s() was called; however, outputType() is ${this.outputType()}, not Type.Int8s.`)}asInt16s(){if(this.outputType()===Cr.Int16s)return this.result.data;throw new Error(`asInt16s() was called; however, outputType() is ${this.outputType()}, not Type.Int16s.`)}asInt32s(){if(this.outputType()===Cr.Int32s)return this.result.data;throw new Error(`asInt32s() was called; however, outputType() is ${this.outputType()}, not Type.Int32s.`)}asStrings(){if(this.outputType()===Cr.Strings)return this.result.data;throw new Error(`asStrings() was called; however, outputType() is ${this.outputType()}, not Type.Strings.`)}asUnsignedInt8s(){if(this.outputType()===Cr.UnsignedInt8s)return this.result.data;throw new Error(`asUnsignedInt8s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt8s.`)}asUnsignedInt16s(){if(this.outputType()===Cr.UnsignedInt16s)return this.result.data;throw new Error(`asUnsignedInt16s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt16s.`)}asUnsignedInt32s(){if(this.outputType()===Cr.UnsignedInt32s)return this.result.data;throw new Error(`asUnsignedInt32s() was called; however, outputType() is ${this.outputType()}, not Type.UnsignedInt32s.`)}}function Rr(){return globalThis&&!globalThis.top&&(globalThis.top={}),null===globalThis||void 0===globalThis?void 0:globalThis.top}function Dr(e,t){e.src=t}function Or(e,t){const n=globalThis[t];if(n&&n.InferenceSession&&n.Tensor){const o=e();return o&&!o[t]&&(o[t]=n),!0}return!1}class Nr{static createFactory(e,t,n,o,r){return s=>{var i;const a=o||Rr;return!Nr.onnxRetrievalPromise||s?e&&t?((null===(i=a())||void 0===i?void 0:i.ort)&&!s?Promise.resolve():function(e,t,n,o,r){const s=new L.I({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});if(s.start(),function(e){let t="";if("undefined"!=typeof navigator&&navigator.userAgent){const e=navigator.userAgent;!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0?t="Error: IE lacks necessary support":"undefined"==typeof Promise?t="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(t="Error: WASM is not supported")}else t="Error: No window userAgent";return""!=t&&(e.resultDescription=t,b.tG.info(540406806,b.nh.CoreDefault,e.stop()),!0)}(s)){const e="Browser lacks necessary support for inference service";return s.success=!1,s.resultDescription=e,b.tG.info(540406803,b.nh.CoreDefault,s.stop()),Promise.reject(new Error(e))}return new Promise(((s,i)=>{if("undefined"!=typeof document){const a=document.createElement("script");(r||Dr)(a,e),a.onload=()=>{Or(t,n)?(o&&(t()[n].env.wasm.wasmPaths=o),s()):(a.remove(),i(new Error("ort.Tensor and/or ort.InferenceSession are undefined")))},a.onerror=i,document.body.appendChild(a)}else globalThis.importScripts?(globalThis.importScripts(e),globalThis[n]=self[n],Or(t,n)?(o&&(t()[n].env.wasm.wasmPaths=o),s()):i(new Error("ort.Tensor and/or ort.InferenceSession are undefined"))):i(new Error("Unexpected lack of document and importScripts"))})).then((()=>{b.tG.info(540406804,b.nh.CoreDefault,s.stop())})).catch((e=>{throw s.success=!1,s.resultDescription=e.message,b.tG.info(509871835,b.nh.CoreDefault,s.stop()),e}))}(this.createCdnUrl(e,t),a,"ort",n,r)).then((()=>{Nr.onnxRetrievalPromise=Promise.resolve(new Nr(a))})).catch((e=>{Nr.onnxRetrievalPromise=Promise.reject(e)})).then((()=>Nr.onnxRetrievalPromise)):Promise.reject(new Error("Error: appName and/or version not provided")):Nr.onnxRetrievalPromise}}static createCdnUrl(e,t){return`https://${e}${t}`}constructor(e){this.getCache=null,this.getCache=e}createModel(e,t){var n;return function(e,t,n){return Ir.create(e,t,n)}(e,t||"",null===(n=this.getCache())||void 0===n?void 0:n.ort)}createInputs(){return Pr.create()}}var Lr=n(30773);class Fr{constructor(){this.bridgeMessageSequenceId=0,this.sessionCloseReasonMap=new Map,this.addCallbacksAlreadySet=new Set,this.sendBridgeMessage=e=>{this.messageBridge&&(e.seq=this.bridgeMessageSequenceId++,this.messageBridge.sendMessage(JSON.stringify(new te.vG(e))))},this.sendResponseAcrossBridge=(e,t,n,o)=>{e.catch((e=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message),new te._p({messageId:t.messageId,error:e.message})))).then((e=>{this.sendBridgeMessage({bridgeId:n,docSessionId:o,response:e})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}}initialize(e){this.messageBridge=e.messageBridge,this.getSessionCallback=e.getSessionCallback,this.hostTelemetryCallbacks=e.hostTelemetryCallbacks,this.messageBridge.registerMessageReceivedCallback(this.onBridgeMessageReceived.bind(this))}setInterceptor(e){this.interceptorBridge=e,this.interceptorBridge.registerMessageReceivedCallback(this.onBridgeMessageReceivedFromInterceptor.bind(this))}onBridgeMessageReceived(e){null!=this.interceptorBridge?this.interceptorBridge.sendMessage(e):this.handleBridgeMessage(e)}onBridgeMessageReceivedFromInterceptor(e){this.handleBridgeMessage(e)}handleBridgeMessage(e){try{const{bridgeId:t,docSessionId:n,message:o}=JSON.parse(e),s=r.h.getTypeNameFor(o);this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Received message with messageTypeName ${s} on bridgeId ${t} and docSessionId ${n}`);const i=this.getSessionCallback(n);if(this.sessionCloseReasonMap.has(n)){const e=this.sessionCloseReasonMap.get(n);this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new te.w9({reason:e})}),this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Session whose doc session id is ${n} is close due to ${e}`)}if(Lr.Cs.typeGuard(o))if(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Sending GetHostBridgeSessionResponse to bridge with docSessionId ${n}`),i)i.then((e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Lr.f8({messageId:o.messageId,isConnected:e.isConnected,isClosed:e.isClosed})})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new te._p({messageId:o.messageId,error:e})})}));else{const e="GetHostBridgeSessionRequestMessage called before session init";this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new te._p({messageId:o.messageId,error:e})})}else if(te.n4.typeGuard(o))this.handleAnnotationActivationMessage(o,t,n,i);else if(Ve.typeGuard(o))this.handleGetAnnotationRequestBridgeMessage(o,t,n,i);else if(te.Tb.typeGuard(o)){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Receiving Sync Message");for(const e of o.ops)i.then((t=>{t.submitOperation(e,o.cv)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}));this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new te.YK({messageId:o.messageId})})}else if(te.GA.typeGuard(o)){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Releasing Annotation Activation token = ${o.token}`);const e=i.then((e=>e.releaseAnnotation(o.token).then((e=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Sending Annotation Activation token = ${o.token}`),new te.Qq({messageId:o.messageId,lastRelease:e}))))));this.sendResponseAcrossBridge(e,o,t,n)}else if(te.g$.typeGuard(o))this.handleSubmittedCustomMessage(o,t,n,i);else if(te.eE.typeGuard(o))this.handleSessionInitMessage(t,n,i);else if(r.h.matchesTypesFor(o,[Lr.i2.getTypeName()]))this.handleInteractiveAuthMessage(o,t,n,i);else if(r.h.matchesTypesFor(o,[Lr.og.getTypeName()])){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Setting seeding status change callback");const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Lr.U8({messageId:o.messageId,seedingStatusChangeMessage:e})})}).bind(this);i.then((t=>{t.setSeedingStatusChangeCallback(e)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}else if(r.h.matchesTypesFor(o,[Lr.tj.getTypeName()])){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Setting claims challenge callback");const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Lr.Td({messageId:o.messageId,claimsChallengeMessage:e})})}).bind(this);i.then((t=>{t.setClaimsChallengeCallback(e)})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}else this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,`Did not respond to ${s} with Id ${o.messageId}`),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new te._p({messageId:o.messageId,error:"Unknown message type to handle"})})}catch(e){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message),this.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new te._p({messageId:"unknown",error:e.message})})}}addBridgeCallbacksForSession(e,t){e.then((e=>{e.setServerAuthenticationStateChangeCallback((e=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new te.wU({serverAuthenticationState:e})})})),e.setSessionCloseCallback((e=>{this.sessionCloseReasonMap.set(t,e.reason),this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:e})})),e.setConnectCallback(((e,n,o,r,s)=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new te.uN({origin:o,sessionKey:n.split("/").pop(),sessionUrlBase:n.split("/").slice(0,-1).join("/"),anonymousToken:r,routingSessionKey:s})}),this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new te.gy({isSeedingRequired:e,sessionUrl:n,origin:o,authToken:r,routingSessionKey:s})})})),e.setReconnectCallback((()=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new te.lj})})),e.setDisconnectCallback((e=>{this.sendBridgeMessage({bridgeId:"*",docSessionId:t,message:new te.eG({error:e})})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}handleAnnotationActivationMessage(e,t,n,o){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Activate Annotation of type = ${e.annotationType} token = ${e.token}`);const r=((o,r)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new te.B_({annotationType:e.annotationType,areApologies:!0,ops:[o],cv:r})})}).bind(this),s=o.then((o=>o.activateAnnotation(e.annotationType,{config:e.config,callback:(o,r)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new te.B_({annotationType:e.annotationType,ops:[o],cv:r})})},apologyCallback:e.sendApologies?r:void 0,forceReturnCachedAnnotations:e.forceReturnCachedAnnotations}).then((t=>(this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Annotation Activation Response Recieved with token = ${t.token}`),new te.PY({messageId:e.messageId,token:t.token}))))));this.sendResponseAcrossBridge(s,e,t,n)}handleSessionInitMessage(e,t,n){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Initing session with doc session id ${t}`),this.addCallbacksAlreadySet.has(t)||(this.addBridgeCallbacksForSession(n,t),this.addCallbacksAlreadySet.add(t)),n.then((n=>{const o=n.getConnectParams();if(void 0===o)return;const r=o.sessionUrl;this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new te.uN({origin:o.origin,sessionKey:r.split("/").pop(),sessionUrlBase:r.split("/").slice(0,-1).join("/"),anonymousToken:o.authToken,routingSessionKey:o.routingSessionKey})}),this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Inited session with doc session id ${t}`),this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new te.wU({serverAuthenticationState:n.getServerAuthenticationState()})})})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}handleGetAnnotationRequestBridgeMessage(e,t,n,o){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Sending Get Annotation request");const r=o.then((t=>t.getAnnotations({annotationType:e.annotationTypes,sourceInfo:e.sourceInfo,configs:e.configs,transientItems:e.transientItems,maxDelayMs:e.maxDelayMs,tryResolveUpstreamDependencies:e.tryResolveUpstreamDependencies,cv:e.cv})));Promise.resolve(r).then((o=>{var r,s,i,a,l,c,u;return a=this,l=void 0,u=function*(){var a,l,c,u,d,h,p;try{for(r=!0,s=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}(o);!(a=(i=yield s.next()).done);r=!0){u=i.value,r=!1;const o=u;this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,"Receiving Get Annotation request");const s=new je({content:o.content,errorInfo:null===(d=o.error)||void 0===d?void 0:d.serviceError,warningInfo:null===(h=o.warning)||void 0===h?void 0:h.serviceError}),a=new Lr.wR({messageId:e.messageId,serverResponse:JSON.stringify(s),clientError:null===(p=o.error)||void 0===p?void 0:p.clientError,finalResponse:o.finalResponse});this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:a})}}catch(e){l={error:e}}finally{try{r||a||!(c=s.return)||(yield c.call(s))}finally{if(l)throw l.error}}},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{r(u.next(e))}catch(e){t(e)}}function o(e){try{r(u.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof c?r:new c((function(e){e(r)}))).then(n,o)}r((u=u.apply(a,l||[])).next())}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}handleSubmittedCustomMessage(e,t,n,o){this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Receiving SubmittedCustomMessage via message ${e.messageId}`),o.then((o=>{o.submitCustomMessage(e.customMessage).then((o=>{te.YK.typeGuard(o)?o.messageId=e.messageId:this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,"Unexpeced response type from SubmitCustomMessage"),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:o})})).catch((o=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,o.message),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new te._p({messageId:e.messageId,error:o.message})})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}handleInteractiveAuthMessage(e,t,n,o){let r;this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Interactive auth requested via message ${e.messageId}`),o.then((o=>{o.authenticateInteractive().then((()=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.info,`Interactive auth succeeded for message ${e.messageId}`),r=new te.YK({messageId:e.messageId})})).catch((t=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,`Interactive auth failed for message ${e.messageId}`),r=new te._p({messageId:e.messageId,error:t.message})})).finally((()=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:r})}))})).catch((e=>{this.hostTelemetryCallbacks.sendDiagnosticTrace(0,N.q.error,e.message)}))}}class Br{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const Wr=new class{constructor(){this.externalLogger=new Br}setCorrelationId(e){this.externalLogger.setCorrelationId(e)}setLogger(e){this.externalLogger=e}sendTraceTag(e,t,n,o){this.externalLogger.sendTraceTag(e,t,n,o)}debugAssertTag(e,t,n,o){this.externalLogger.debugAssertTag(e,t,n,o)}shipAssertTag(e,t,n,o){this.externalLogger.shipAssertTag(e,t,n,o)}};var Ur,Gr;!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotComposeLaunchpad=3054]="msoulscat_Wac_CopilotComposeLaunchpad",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor"}(Ur||(Ur={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(Gr||(Gr={}));class Hr{constructor(e){r.h.assign(Hr,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Hr.getTypeName()])}}Hr.H_={T_:Hr.getTypeName(),B_:Hr.getBaseTypes()};class qr{constructor(e){r.h.assign(qr,this,e)}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionExtensionConfig"}static getBaseTypes(){return[]}static typeGuard(e){return r.h.matchesTypesFor(e,[qr.getTypeName()])}}qr.H_={T_:qr.getTypeName(),B_:qr.getBaseTypes()};var $r=function(e){return this instanceof $r?(this.v=e,this):new $r(e)};const Vr=(e,t)=>{const n=[];for(const r of Object.keys(e)){if(void 0===e[r]||null===e[r])continue;const s={name:t?`${t}.${r}`:r,dataType:(o=e[r],"string"==typeof o?0:"boolean"==typeof o?1:"number"==typeof o?2:void Wr.sendTraceTag(572838285,Ur.msoulscat_Wac_BrowserGeneral,Gr.Warning,"Unsupported data field type")),value:e[r],classification:4};n.push(s)}var o;return n},jr=e=>Promise.resolve(!1);class zr{constructor(){this._telemetryAggregationIntervalSec=30,this._eventHandlerDictionary={},this._changeGateEnabledCallback=void 0,this._bridge=null,this._bridgeInterceptor=null,this._sessionCloseReason=null,this._isSessionClosed=null,this._isSessionConnected=null,this._sessionConnectParams=null,this._serverAuthenticationState=mt.f.NotAuthenticated,this._connectCallbacks=new Map,this._connectionStateCallbackToken=0,this._claimsChallengeCallbacks=[],this._seedingStatusChangeCallbacks=[],this._bridgeMessageSequenceId=0,this._runtimeClientBridge=void 0,this._useBridgePackage=void 0,this.initialize=e=>{if(this._runtimeInitPromise)return void Wr.sendTraceTag(572838286,Ur.msoulscat_Wac_BrowserGeneral,Gr.Info,"Runtime already initialized");Wr.sendTraceTag(572838287,Ur.msoulscat_Wac_BrowserGeneral,Gr.Info,"Start and initialize augloop runtime ..."),this.checkParametersAndThrow("initialize",e);const t=[];t.push(this.isFeatureEnabled("Microsoft.Office.AugLoop.UseBridgePackage","None").then((e=>{this._useBridgePackage=e,Wr.sendTraceTag(505419218,Ur.msoulscat_Wac_BrowserGeneral,Gr.Info,`Use bridge package: ${e}`)}))),t.push(this.isFeatureEnabled("ModelDownloaderEbrake","None").then((t=>{t?Wr.sendTraceTag(556376070,Ur.msoulscat_Wac_BrowserGeneral,Gr.Info,"Resource downloader not created due to feature gate"):this.modelDownloaderFromCDN=e.appName&&e.downloadBaseUrl||e.downloadPolymerBaseUrl?new Er(e.appName,e.downloadBaseUrl,e.downloadPolymerBaseUrl):void 0}))),this.inferenceServiceFactory=e.appName&&e.inferenceServiceVersion?Nr.createFactory(e.appName,e.inferenceServiceVersion):void 0,this.powerpointParameters=e.powerpoint;const n={appName:e.appName,appPlatform:"Web",appVersion:e.appVersion,uiLanguage:e.uiLanguage,releaseAudienceGroup:e.releaseAudienceGroup,releaseChannel:e.releaseChannel,releaseCustomAudience:e.releaseCustomAudience,releaseFork:e.releaseFork,sessionId:e.sessionId,flights:e.flights,privateMode:e.privateMode,disabledServiceGroups:e.disabledServiceGroups,userSystemTimezone:e.userSystemTimezone,isClientTelemetrySampled:e.isClientTelemetrySampled},o={onResult:this.onResult.bind(this),onAnnotationResult:this.onAnnotationResult.bind(this),sendTelemetryEvent:this.sendTelemetryEvent.bind(this),sendDiagnosticTrace:this.sendDiagnosticTrace.bind(this),requestAuthToken:this.requestAuthToken.bind(this),isFeatureEnabled:this.isFeatureEnabled.bind(this),isChangeGateEnabled:this.isChangeGateEnabled.bind(this),setSessionData:this.setSessionData.bind(this),areLicenseFeaturesEnabled:jr,onInitSession:this.onInitSession.bind(this),overrideSessionInitMessage:this.overrideSessionInitMessage.bind(this)},r=Promise.all(t).then((()=>Io.init(e.serviceUrl,n,o,{telemetryAggregationIntervalSec:this._telemetryAggregationIntervalSec,modelDownloader:this.modelDownloaderFromCDN,inferenceServiceFactory:this.inferenceServiceFactory,isDeltaGeneratorEnabled:e.isDeltaGeneratorEnabled,disableSyncDeltaSending:e.disableSyncDeltaSending,syncDeltaTimeout:e.syncDeltaTimeout}))).then((()=>ir.init(e.serviceUrl,n,o)));this.createSession=()=>{this._runtimeInitPromise=r.then((()=>{let t=e.sessionCreationOptions;if(t||(t={}),this._useBridgePackage){if(this._runtimeClientBridge=new Fr,this._bridge){const e={sendDiagnosticTrace:(e,t,n)=>{const o=(()=>{switch(t){case N.q.error:return Gr.Error;case N.q.warn:return Gr.Warning;case N.q.info:return Gr.Info;case N.q.verbose:case N.q.debug:return Gr.Verbose;default:return Gr.Info}})();Wr.sendTraceTag(e,Ur.msoulscat_Wac_BrowserGeneral,o,n)},sendTelemetryEvent:(e,t,n,o,r,s,i,a)=>{throw new Error("Method not implemented.")}};this._runtimeClientBridge.initialize({messageBridge:this._bridge,getSessionCallback:this.getSessionCallback.bind(this),hostTelemetryCallbacks:e,changeGateFeatureGateCallbacks:{isFeatureEnabled:this.isFeatureEnabled.bind(this),isChangeGateEnabled:this.isChangeGateEnabled.bind(this)}})}else Wr.sendTraceTag(505415107,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,"bridge is not set, cannot initialize RuntimeClientBridge");this._bridgeInterceptor&&this._runtimeClientBridge.setInterceptor(this._bridgeInterceptor)}else{this._bridge&&this._bridge.registerMessageReceivedCallback(this.onBridgeMessage.bind(this)),this._bridgeInterceptor&&this._bridgeInterceptor.registerMessageReceivedCallback(this.onBridgeMessageFromInterceptor.bind(this));const e=t.onServerAuthenticationStateChangeCallback;t.onServerAuthenticationStateChangeCallback=t=>{this._serverAuthenticationState=t,e&&e(t),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new te.wU({serverAuthenticationState:t})})};const n=t.onSessionClose;t.onSessionClose=e=>{this._sessionCloseReason=e.reason,this._isSessionClosed=!0,n&&n(e),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:e})};const o=t.onSessionReconnect;t.onSessionReconnect=()=>{o&&o(),this._bridge&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new te.lj})};const r=t.onSessionDisconnect;t.onSessionDisconnect=e=>{this._isSessionConnected=!1,r&&r(e),this._bridge&&(this._sessionConnectParams=void 0,this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new te.eG({error:e})}))}}const n=t.onSessionConnect;t.onSessionConnect=(e,t,o,r,s)=>{this._isSessionConnected=!0,this._isSessionClosed=!1,n&&n(e,t,o,r,s),this._connectCallbacks.forEach(((n,i)=>{n(e,t,o,r,s)})),this._bridge&&!this._useBridgePackage&&(this._sessionConnectParams||(this._sessionConnectParams={authToken:r,isSeedingRequired:e,sessionUrl:t,origin:o,routingSessionKey:s},this.sendSessionInitResponseToBridge("*","*")),this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new te.gy({isSeedingRequired:e,sessionUrl:t,origin:o,authToken:r,routingSessionKey:s})}))};const o=t.onClaimsChallengeCallback;t.onClaimsChallengeCallback=e=>{o&&o(e),this._claimsChallengeCallbacks.forEach((t=>{t(e)}))};const r=t.onSeedingStatusChangeCallback;t.onSeedingStatusChangeCallback=e=>{r&&r(e),this._seedingStatusChangeCallbacks.forEach((t=>{t(e)}))};const s=t&&t.docSessionId||e.sessionId;return Io.createSession(Object.assign(Object.assign({},t),{docSessionId:s}))}))},this.createSession()},this.getSession=()=>this._runtimeInitPromise,this.setULSLogger=e=>{this.checkParametersAndThrow("setULSLogger",e&&e.ulsLogger),Wr.setLogger(e.ulsLogger)},this.setSendOTelEventCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendOTelEventCallback",e&&e.sendOTelEvent,this._sendOTelEventCallback),this._sendOTelEventCallback=e.sendOTelEvent},this.setSendDiagnosticTraceCallback=e=>{this.checkParametersAndPropertyAndThrow("setSendDiagnosticTraceCallback",e&&e.sendDiagnosticTraceCallback,this._sendDiagnosticTraceCallback),this._sendDiagnosticTraceCallback=e.sendDiagnosticTraceCallback},this.setRequestAuthTokenCallback=e=>{this.checkParametersAndPropertyAndThrow("setRequestAuthTokenCallback",e&&e.requestAuthTokenCallback,this._requestAuthTokenCallback),this._requestAuthTokenCallback=e.requestAuthTokenCallback},this.setIsFeatureEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsFeatureEnabledCallback",e&&e.featureEnabledCallback,this._featureEnabledCallback),this._featureEnabledCallback=e.featureEnabledCallback},this.setIsChangeGateEnabledCallback=e=>{this.checkParametersAndPropertyAndThrow("setIsChangeGateEnabledCallback",e&&e.changeGateEnabledCallback,this._changeGateEnabledCallback),this._changeGateEnabledCallback=e.changeGateEnabledCallback},this.registerLocalWorkflow=e=>{const t="registerLocalWorkflow";this.checkParametersAndThrow(t,e&&e.workflow),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.registerLocalWorkflow(e.workflow)}))},this.activateAnnotation=e=>{const t="activateAnnotation",n=this.checkParameters(t,e&&e.annotationType)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>{let n;return(e.config||e.handler||e.stateUpdateHandler)&&(n={config:e.config,callback:e.handler,apologyCallback:e.apologyHandler,stateUpdateCallback:e.stateUpdateHandler,forceReturnCachedAnnotations:e.forceReturnCachedAnnotations}),t.activateAnnotation(e.annotationType,n)}))},this.updateAnnotationConfig=e=>{const t="updateAnnotationConfig",n=this.checkParameters(t,e&&e.token&&e.config)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>{t.updateAnnotationConfig(e.token,e.config)}))},this.releaseAnnotation=e=>{const t="releaseAnnotation",n=this.checkParameters(t,e&&e.token)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>t.releaseAnnotation(e.token)))},this.submitOperation=e=>{const t="submitOperation";this.checkParametersAndThrow(t,e&&e.operation),this.checkRuntimeInit(t),this._runtimeInitPromise.then((t=>{t.submitOperation(e.operation,e.cv)}))},this.setSessionDataCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionDataCallback",e&&(e.sessionDataCallback||e.handler),this._setSessionDataCallback),e.sessionDataCallback?this._setSessionDataCallback=e.sessionDataCallback:e.handler&&(this._setSessionDataCallback=(t,n,o)=>e.handler(t,n))},this.setAnnotationResultCallback=e=>{const t="setAnnotationResultCallback";if(this.checkParametersAndThrow(t,e&&e.handler),this._annotationResultCallback){const e=`${t} already called`;Wr.sendTraceTag(537401028,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,e)}this._annotationResultCallback=e.handler},this.setAnnotationState=e=>{const t="setAnnotationState";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationState(e.parentPath,e.id,e.value)}))},this.setAnnotationMetadata=e=>{const t="setAnnotationMetadata";this.checkParametersAndThrow(t,e&&e.parentPath&&e.id&&e.value),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((t=>{t.setAnnotationMetadata(e.parentPath,e.id,e.value)}))},this.setInitSessionCallback=e=>{this.checkParametersAndPropertyAndThrow("setInitSessionCallback",e&&e.initSessionCallback,this._initSessionCallback),this._initSessionCallback=e.initSessionCallback},this.setSessionInitOverrideCallback=e=>{this.checkParametersAndPropertyAndThrow("setSessionInitOverrideCallback",e&&e.handler,this._sessionInitOverrideCallback),this._sessionInitOverrideCallback=e.handler},this.setMessageBridge=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridge",e&&e.bridge,this._bridge),this._bridge=e.bridge},this.setMessageBridgeToALInterceptor=e=>{this.checkParametersAndPropertyAndThrow("setMessageBridgeToALInterceptor",e&&e.bridge,this._bridgeInterceptor),this._bridgeInterceptor=e.bridge},this.forceReconnectSession=e=>{const t="forceReconnectSession",n=this.checkParameters(t,e)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((e=>e.forceReconnect()))},this.setSessionCloseCallback=e=>{const t="setSessionCloseCallback",n=this.checkParameters(t,e&&e.callback)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>{t.setSessionCloseCallback(e.callback)}))},this.setConnectCallback=e=>{const t=this.getSessionStateCallbackToken("connect");return e.callback&&this._connectCallbacks.set(t,e.callback),t},this.removeConnectionStateCallback=e=>!!this._connectCallbacks.has(e.token)&&(this._connectCallbacks.delete(e.token),!0),this.setSeedingStatusChangeCallback=e=>{this._seedingStatusChangeCallbacks.push(e.callback)},this.submitCustomMessage=e=>{const t="submitCustomMessage",n=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>t.submitCustomMessage(e.message)))},this.submitLargeBinaryDataMessage=e=>{const t="submitLargeBinaryDataMessage",n=this.checkParameters(t,e&&e.message)||this.checkRuntimeInit(t);return n?Promise.reject(n):te.VR.typeGuard(e.message)?this._runtimeInitPromise.then((t=>t.submitLargeBinaryDataMessage(e.message))):Promise.reject(`${t} only supports MicroSyncMessage`)},this.requestBinaryDataForBlob=e=>{const t="requestBinaryDataForBlob",n=this.checkParameters(t,e&&e.blob)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((t=>t.requestBinaryDataForBlob(e.blob)))},this.closeSession=()=>{const e=this.checkRuntimeInit("closeSession");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>{e.close()}))},this.startNewSession=()=>{if(!this.createSession){const e="startNewSession called before runtime init";throw Wr.sendTraceTag(537408074,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,e),new Error(e)}this.createSession(),this._sessionCloseReason=null,this._sessionConnectParams=null},this.authenticateInteractive=()=>{const e=this.checkRuntimeInit("authenticateInteractive");return e?Promise.reject(e):this._runtimeInitPromise.then((e=>e.authenticateInteractive()))},this.getAnnotations=e=>{const t="getAnnotations",n=this.checkParameters(t,e&&e.request),o=this.checkRuntimeInit(t),r=n||o;return r?Promise.resolve({[Symbol.asyncIterator](){return function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),s=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(e){r[e]&&(o[e]=function(t){return new Promise((function(n,o){s.push([e,t,n,o])>1||a(e,t)}))})}function a(e,t){try{(n=r[e](t)).value instanceof $r?Promise.resolve(n.value.v).then(l,c):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}(this,arguments,(function*(){const e=n?ne.zy.InvalidRequest:ne.zy.RuntimeNotInitialized;Wr.sendTraceTag(505952348,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,`ClientError. Code: ${e}, Error: ${null==r?void 0:r.message}`),yield yield $r({content:void 0,error:{clientError:{code:e,error:null==r?void 0:r.message}}})}))}}):this._runtimeInitPromise.then((t=>t.getAnnotations(e.request,e.cancellationToken)))},this.getAsyncClient=e=>{const t=this.checkRuntimeInit("getAsyncClient");return t?Promise.reject(t):this._runtimeInitPromise.then((t=>Po.create({session:t,scheduler:e.scheduler})))},this.submit=e=>{const t="submit";this.checkParametersAndThrow(t,e&&e.inputSchema&&e.input),this.checkRuntimeInitAndThrow(t),this._runtimeInitPromise.then((()=>{ir.submit(e.inputSchema,e.input,e.correlationVector)}))},this.addEventHandler=e=>{this.checkParametersAndThrow("addEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName]||[];t.push(e.handler),this._eventHandlerDictionary[e.schemaName]=t},this.removeEventHandler=e=>{this.checkParametersAndThrow("removeEventHandler",e&&e.schemaName&&e.handler);const t=this._eventHandlerDictionary[e.schemaName];if(!Array.isArray(t))return;const n=t.indexOf(e.handler);n>=0&&t.splice(n,1)},this.registerSimpleRemoteWorkflow=e=>{const t="registerSimpleRemoteWorkflow",n=this.checkParameters(t,e&&e.name&&e.lambdaRemote)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((()=>ir.registerSimpleRemoteWorkflow(e.name,e.lambdaBefore,e.lambdaRemote,e.lambdaAfter)))},this.registerSimpleLocalWorkflow=e=>{const t="registerSimpleLocalWorkflow",n=this.checkParameters(t,e&&e.name&&e.lambda)||this.checkRuntimeInit(t);return n?Promise.reject(n):this._runtimeInitPromise.then((()=>ir.registerSimpleLocalWorkflow(e.name,e.lambda)))},this.registerReduceWorkflow=e=>Promise.resolve(),this.registerSchemas=e=>Promise.resolve(),this.onResult=(e,t,n,o)=>{const r=this._eventHandlerDictionary[n];if(r)for(const s of r)s&&s({inputSchema:e,input:t,outputSchema:n,output:o})},this.onAnnotationResult=(e,t)=>{this._annotationResultCallback&&this._annotationResultCallback(e,t)},this.requestAuthToken=e=>this._requestAuthTokenCallback?(this._requestAuthTokenCallback(e)||Promise.resolve("")).then((e=>{const t=e||"";return Promise.resolve({Token:t})})):Promise.resolve({Token:""}),this.sendTelemetryEvent=(e,t,n,o,r,s,i,a)=>{this._sendOTelEventCallback&&this._sendOTelEventCallback(((e,t,n,o,r,s,i)=>{const a={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:Vr(n),eventFlags:{dataCategories:s,diagnosticLevel:i,samplingPolicy:1}};return o&&(a.eventContract={name:o,dataFields:Vr(r,o.split(".").slice(-1)[0])}),a})(e,t,n,o,r,i,a))},this.sendDiagnosticTrace=(e,t,n)=>{this._sendDiagnosticTraceCallback&&this._sendDiagnosticTraceCallback(e,t,n)},this.isFeatureEnabled=(e,t)=>{if(!e)return Promise.resolve(!1);if(0===e.indexOf("Microsoft.Office.AugLoop.")&&this._featureEnabledCallback){const t=e.slice(25);return Promise.resolve(this._featureEnabledCallback(t)||this._featureEnabledCallback(e))}return Promise.resolve(!1)},this.isChangeGateEnabled=e=>e&&this._changeGateEnabledCallback?Promise.resolve(this._changeGateEnabledCallback(e)):Promise.resolve(!1),this.setSessionData=(e,t,n)=>{this._setSessionDataCallback&&this._setSessionDataCallback(e,t,n)},this.overrideSessionInitMessage=e=>this._sessionInitOverrideCallback?this._sessionInitOverrideCallback(e):0===e.clientMetadata.appName.indexOf("PowerPoint")&&this.powerpointParameters?this.overridePowerPointSessionInitMessage(e):e,this.overridePowerPointSessionInitMessage=e=>{const t={downloadUrl:this.powerpointParameters.downloadUrl,getItemsEndPoint:this.powerpointParameters.getItemsEndPoint,documentOpenType:this.powerpointParameters.documentOpenType};for(const n of Object.keys(e))t[n]=e[n];return new Hr(t)},this.onInitSession=()=>this._initSessionCallback?this._initSessionCallback():Promise.resolve(),this.checkParameters=(e,t)=>{if(!t){const t=`${e} called with invalid parameters`;return Wr.sendTraceTag(537408075,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,t),new Error(t)}},this.checkParametersAndThrow=(e,t)=>{const n=this.checkParameters(e,t);if(n)throw n},this.checkParametersAndPropertyAndThrow=(e,t,n)=>{if(this.checkParametersAndThrow(e,t),n){const t=`${e} already called`;throw Wr.sendTraceTag(537408076,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,t),new Error(t)}},this.checkRuntimeInit=e=>{if(!this._runtimeInitPromise){const t=`${e} called before runtime init`;return Wr.sendTraceTag(537408077,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,t),new Error(t)}},this.checkRuntimeInitAndThrow=e=>{const t=this.checkRuntimeInit(e);if(t)throw t},this.sendBridgeMessage=e=>{this._bridge&&(e.seq=this._bridgeMessageSequenceId++,this._bridge.sendMessage(JSON.stringify(new te.vG(e))))},this.onBridgeMessage=e=>{null!=this._bridgeInterceptor?this._bridgeInterceptor.sendMessage(e):this.handleReceivedBridgeMessage(e)},this.sendSessionInitResponseToBridge=(e,t)=>{if(this._sessionConnectParams){const n=this._sessionConnectParams.sessionUrl;this.sendBridgeMessage({bridgeId:e,docSessionId:t,message:new te.uN({origin:this._sessionConnectParams.origin,sessionKey:n.split("/").pop(),sessionUrlBase:n.split("/").slice(0,-1).join("/"),anonymousToken:this._sessionConnectParams.authToken,routingSessionKey:this._sessionConnectParams.routingSessionKey})})}},this.handleReceivedBridgeMessage=e=>{try{const{bridgeId:t,docSessionId:n,message:o}=JSON.parse(e),s=r.h.getTypeNameFor(o);if(Wr.sendTraceTag(509092291,Ur.msoulscat_Wac_BrowserGeneral,Gr.Info,`Received ${s}`),null!=this._sessionCloseReason&&this.sendBridgeMessage({bridgeId:"*",docSessionId:"*",message:new te.w9({reason:this._sessionCloseReason})}),Lr.Cs.typeGuard(o)){Wr.sendTraceTag(505448338,Ur.msoulscat_Wac_BrowserGeneral,Gr.Info,`Sending GetHostBridgeSessionResponse to bridge with docSessionId ${n}`);const e=this.checkRuntimeInit("GetHostBridgeSessionRequestMessage");e?this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new te._p({messageId:o.messageId,error:e.message})}):this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new Lr.f8({messageId:o.messageId,isConnected:this._isSessionConnected,isClosed:this._isSessionClosed})})}else if(te.n4.typeGuard(o)){const e=((e,r)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new te.B_({annotationType:o.annotationType,areApologies:!0,ops:[e],cv:r})})}).bind(this),r=this.activateAnnotation({annotationType:o.annotationType,config:o.config,handler:(e,r)=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new te.B_({annotationType:o.annotationType,ops:[e],cv:r})})},apologyHandler:o.sendApologies?e:void 0,forceReturnCachedAnnotations:o.forceReturnCachedAnnotations}).then((e=>new te.PY({messageId:o.messageId,token:e.token})));this.sendResponseAcrossBridge(r,o,t,n)}else if(Ve.typeGuard(o))this.handleGetAnnotationsRequestMessage(t,n,o);else if(te.Tb.typeGuard(o)){for(const e of o.ops)this.submitOperation({operation:e,cv:o.cv});this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new te.YK({messageId:o.messageId})}),Wr.sendTraceTag(509092288,Ur.msoulscat_Wac_BrowserGeneral,Gr.Info,`Responded to ${s}`)}else if(te.GA.typeGuard(o)){const e=this.releaseAnnotation({token:o.token}).then((e=>new te.Qq({messageId:o.messageId,lastRelease:e})));this.sendResponseAcrossBridge(e,o,t,n)}else if(te.g$.typeGuard(o))this.submitCustomMessage({message:o.customMessage}).then((e=>{te.YK.typeGuard(e)?(e.messageId=o.messageId,Wr.sendTraceTag(508432467,Ur.msoulscat_Wac_BrowserGeneral,Gr.Info,`Responded to ${s}`)):Wr.sendTraceTag(508420946,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,"Unexpeced response type from SubmitCustomMessage"),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:e})})).catch((e=>{Wr.sendTraceTag(508436636,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,e.message),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new te._p({messageId:o.messageId,error:e.message})})}));else if(te.eE.typeGuard(o))this.sendSessionInitResponseToBridge(t,n),this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new te.wU({serverAuthenticationState:this._serverAuthenticationState})});else if(r.h.matchesTypesFor(o,[Lr.i2.getTypeName()])){const e=this._runtimeInitPromise.then((e=>e.authenticateInteractive())).then((()=>new te.YK({messageId:o.messageId})));this.sendResponseAcrossBridge(e,o,t,n)}else if(r.h.matchesTypesFor(o,[Lr.og.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Lr.U8({messageId:o.messageId,seedingStatusChangeMessage:e})})}).bind(this);this._runtimeInitPromise.then((t=>{t.setSeedingStatusChangeCallback(e)})).catch((e=>{Wr.sendTraceTag(506474634,Ur.msoulscat_Wac_BrowserGeneral,Gr.Warning,`RuntimeInitPromiseException for message with Id ${o.messageId}`)}))}else if(r.h.matchesTypesFor(o,[Lr.tj.getTypeName()])){const e=(e=>{this.sendBridgeMessage({bridgeId:t,docSessionId:n,message:new Lr.Td({messageId:o.messageId,claimsChallengeMessage:e})})}).bind(this);this._runtimeInitPromise.then((t=>{t.setClaimsChallengeCallback(e)})).catch((e=>{Wr.sendTraceTag(506987159,Ur.msoulscat_Wac_BrowserGeneral,Gr.Warning,`RuntimeInitPromiseException for message with Id ${o.messageId}`)}))}else Wr.sendTraceTag(509092259,Ur.msoulscat_Wac_BrowserGeneral,Gr.Warning,`Did not respond to ${s} with Id ${o.messageId}`),this.sendBridgeMessage({bridgeId:t,docSessionId:n,response:new te._p({messageId:o.messageId,error:"Unknown message type to handle"})})}catch(e){Wr.sendTraceTag(509092363,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,e.message),this.sendBridgeMessage({bridgeId:"unknown",docSessionId:"unknown",response:new te._p({messageId:"unknown",error:e.message})})}},this.handleGetAnnotationsRequestMessage=(e,t,n)=>{const o={request:{annotationType:n.annotationTypes,sourceInfo:n.sourceInfo,configs:n.configs,transientItems:n.transientItems,maxDelayMs:n.maxDelayMs,tryResolveUpstreamDependencies:n.tryResolveUpstreamDependencies,cv:n.cv}};this.getAnnotations(o).then((o=>{var r,s,i,a,l,c,u;return a=this,l=void 0,u=function*(){var a,l,c,u,d,h,p;try{for(r=!0,s=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}(o);!(a=(i=yield s.next()).done);r=!0){u=i.value,r=!1;const o=u,s=new je({content:o.content,errorInfo:null===(d=o.error)||void 0===d?void 0:d.serviceError,warningInfo:null===(h=o.warning)||void 0===h?void 0:h.serviceError}),a=new Lr.wR({messageId:n.messageId,serverResponse:JSON.stringify(s),clientError:null===(p=o.error)||void 0===p?void 0:p.clientError,finalResponse:o.finalResponse});this.sendResponseAcrossBridge(Promise.resolve(a),n,e,t)}}catch(e){l={error:e}}finally{try{r||a||!(c=s.return)||(yield c.call(s))}finally{if(l)throw l.error}}},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{r(u.next(e))}catch(e){t(e)}}function o(e){try{r(u.throw(e))}catch(e){t(e)}}function r(t){var r;t.done?e(t.value):(r=t.value,r instanceof c?r:new c((function(e){e(r)}))).then(n,o)}r((u=u.apply(a,l||[])).next())}))}))},this.sendResponseAcrossBridge=(e,t,n,o)=>{e.catch((e=>new te._p({messageId:t.messageId,error:e.message}))).then((e=>{this.sendBridgeMessage({bridgeId:n,docSessionId:o,response:e}),Wr.sendTraceTag(508937624,Ur.msoulscat_Wac_BrowserGeneral,Gr.Info,`Responded to ${r.h.getTypeNameFor(t)}`)})).catch((e=>{Wr.sendTraceTag(508937623,Ur.msoulscat_Wac_BrowserGeneral,Gr.Error,e.message)}))},this.onBridgeMessageFromInterceptor=e=>{this.handleReceivedBridgeMessage(e)},this.getSessionCallback=e=>this._runtimeInitPromise}getSessionStateCallbackToken(e){return e+"-callback-"+this._connectionStateCallbackToken++}}class Qr{constructor(e,t){var n,o,r,s,i,a;this.kind=wt.SingleItem,this.isStateful=!1,this.id=e,t&&(this.inputTypes=null!==(n=t.inputTypes)&&void 0!==n?n:this.inputTypes,this.outputTypes=null!==(o=t.outputTypes)&&void 0!==o?o:this.outputTypes,this.isStateful=null!==(r=t.isStateful)&&void 0!==r?r:this.isStateful,this.requestedContextTypesRules=null!==(s=t.requestedContextTypesRules)&&void 0!==s?s:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(i=t.definitionOverrideTargetWorkflows)&&void 0!==i?i:this.definitionOverrideTargetWorkflows,this.correlatedSignals=0!==(null===(a=t.correlatedSignals)||void 0===a?void 0:a.length)?t.correlatedSignals:this.correlatedSignals)}static create(e){return new Qr(e)}setInputTypes(e){return this.inputTypes=he(e),this}setOutputTypes(e){return this.outputTypes=he(e),this}setStateful(){return this.isStateful=!0,this}setRequestedContexts(e){var t;return this.requestedContextTypesRules=(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).concat(e),this}setLambdaType(e){return this.factory=e,this}setDefinitionOverrideTargetWorkflows(e){return this.definitionOverrideTargetWorkflows=e,this}setCorrelatedSignals(e){return 0!==e.length&&(this.correlatedSignals=e),this}setLambda(e,t){return this.factory=()=>({init:t||(e=>Promise.resolve()),execute:e,dispose:()=>{}}),this}validateOptions(){return{isValid:!0}}}class Jr{constructor(e){r.h.assign(Jr,this,e)}static getTypeName(){return"AugLoop_Chat_ChatsHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Jr.getTypeName()])}}Jr.H_={T_:Jr.getTypeName(),B_:Jr.getBaseTypes()};class Kr{constructor(e){r.h.assign(Kr,this,e)}static getTypeName(){return"AugLoop_Chat_Chat"}static getBaseTypes(){return[]}static typeGuard(e){return r.h.matchesTypesFor(e,[Kr.getTypeName()])}}Kr.H_={T_:Kr.getTypeName(),B_:Kr.getBaseTypes()};class Yr{constructor(e){r.h.assign(Yr,this,e)}static getTypeName(){return"AugLoop_Chat_MessagesHolder"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Yr.getTypeName()])}}Yr.H_={T_:Yr.getTypeName(),B_:Yr.getBaseTypes()};class Xr{constructor(e){r.h.assign(Xr,this,e)}static getTypeName(){return"AugLoop_Chat_ChatMessage"}static getBaseTypes(){return[]}static typeGuard(e){return r.h.matchesTypesFor(e,[Xr.getTypeName()])}}Xr.H_={T_:Xr.getTypeName(),B_:Xr.getBaseTypes()};class Zr{constructor(e){r.h.assign(Zr,this,e)}static getTypeName(){return"AugLoop_Chat_TextChatMessage"}static getBaseTypes(){return["AugLoop_Chat_ChatMessage"]}static typeGuard(e){return r.h.matchesTypesFor(e,[Zr.getTypeName()])}}Zr.H_={T_:Zr.getTypeName(),B_:Zr.getBaseTypes()};class es{static create(e){const t=new es(e);return t.activateAnnotation(e.responseType).then((()=>t))}constructor(e){this.config=e,this.nextMessageId=0,this.responseCallbacks=new Map;const t=["session","chats"],n=Cn(),o="messages",r=[...t,n];this.messagesPath=[...r,o],this.config.session.submitOperations([new ie.Xr({parentPath:t,items:[{id:n,body:e.chat}]}),new ie.Xr({parentPath:r,items:[{id:o,body:new Yr}]})])}send(e,t){const n=""+this.nextMessageId++;this.responseCallbacks.set(n,t),this.config.session.submitOperations([new ie.Xr({parentPath:this.messagesPath,items:[{id:n,body:e}]})])}close(){return this.config.session.releaseAnnotation(this.activatedAnnotationToken)}activateAnnotation(e){return this.config.session.activateAnnotation(e,{callback:e=>{if(ie.Xr.typeGuard(e)&&this.isUnderSubtree(e.parentPath,this.messagesPath))for(const t of e.items){const n=e.parentPath[e.parentPath.length-1],o=this.responseCallbacks.get(n);o&&(o(t.body),this.responseCallbacks.delete(n))}}}).then((({token:e})=>{this.activatedAnnotationToken=e}))}isUnderSubtree(e,t){if(e.length<t.length)return!1;for(let n=0;n<t.length;n++)if(e[n]!==t[n])return!1;return!0}}class ts{constructor(){this._augLoopRuntimeManager=new zr}getAugLoopRuntimeManager(){return this._augLoopRuntimeManager}createSingleItemWorkflow(e){return Qr.create(e)}createChatHelper(e){return this.getAugLoopRuntimeManager().getSession().then((t=>es.create(Object.assign({session:t},e))))}createAugLoopRuntimeManager(){return new zr}}const ns=new ts;class os extends r.h{constructor(e){super(),this.Id=null,this.Id=e}}class rs extends os{constructor(e,t){super(e),this.Content=null,this.Content=t}}var ss,is,as,ls,cs,us;!function(e){e[e.Unknown=0]="Unknown",e[e.Text=1]="Text",e[e.Slide=2]="Slide"}(ss||(ss={}));class ds{constructor(e,t,n,o,r,s,i,a,l){this.Start=0,this.Length=0,this.FontWeight=ls.DontCare,this.Italic=!1,this.Underline=as.None,this.Capitalization=is.NoCaps,this.FontSize=0,this.Color=0,this.StyleName=null,this.Start=e,this.Length=t,this.FontWeight=n,this.Italic=o,this.Underline=r,this.Capitalization=s,this.FontSize=i,this.Color=a,this.StyleName=l}}class hs extends rs{constructor(e,t,n){super(e,t),this.Language=null,this.RevisionId=null,this.RevisionSequence=0,this.Indentation=0,this.OutlineLevel=0,this.ListType=cs.Number,this.Alignment=us.Left,this.FormattedRanges=null,this.Language=n}}!function(e){e[e.NoCaps=0]="NoCaps",e[e.SmallCaps=1]="SmallCaps",e[e.AllCaps=2]="AllCaps",e[e.AllPetiteCaps=3]="AllPetiteCaps",e[e.PetiteCaps=4]="PetiteCaps",e[e.Unicase=5]="Unicase",e[e.Titling=6]="Titling",e[e.Other=7]="Other"}(is||(is={})),function(e){e[e.None=0]="None",e[e.Words=1]="Words",e[e.SingleLine=2]="SingleLine",e[e.DoubleLine=3]="DoubleLine",e[e.HeavyLine=4]="HeavyLine",e[e.DottedLine=5]="DottedLine",e[e.DottedHeavyLine=6]="DottedHeavyLine",e[e.DashLine=7]="DashLine",e[e.DashHeavyLine=8]="DashHeavyLine",e[e.DashLongLine=9]="DashLongLine",e[e.DashLongHeavyLine=10]="DashLongHeavyLine",e[e.DotDashLine=11]="DotDashLine",e[e.DotDashHeavyLine=12]="DotDashHeavyLine",e[e.DotDotDashLine=13]="DotDotDashLine",e[e.DotDotDashHeavyLine=14]="DotDotDashHeavyLine",e[e.WavyLine=15]="WavyLine",e[e.WavyHeavyLine=16]="WavyHeavyLine",e[e.WavyDoubleLine=17]="WavyDoubleLine"}(as||(as={})),function(e){e[e.DontCare=0]="DontCare",e[e.Thin=1]="Thin",e[e.ExtraLight=2]="ExtraLight",e[e.Light=3]="Light",e[e.Normal=4]="Normal",e[e.Medium=5]="Medium",e[e.SemiBold=6]="SemiBold",e[e.Bold=7]="Bold",e[e.ExtraBold=8]="ExtraBold",e[e.Heavy=9]="Heavy"}(ls||(ls={})),function(e){e[e.Number=0]="Number",e[e.Bullet=1]="Bullet",e[e.Lim=13]="Lim",e[e.Nil=14]="Nil",e[e.Any=15]="Any",e[e.NoList=16]="NoList",e[e.Invalid=42]="Invalid"}(cs||(cs={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justified=3]="Justified",e[e.Other=4]="Other",e[e.None=5]="None"}(us||(us={}));class ps{}class fs{constructor(e,t){this.type=e,this.data=t}}class gs{constructor(e,t,n){this.exceptionType=e,this.message=t,this.data=n}static exceptionTypeToString(e){switch(e){case 0:return"Unknown";case 1:return"NoOutput";case 2:return"Authentication";case 3:return"JoinTimedOut";case 4:return"LambdaThrow";case 5:return"LambdaErrorCallback";default:return"Invalid Error Type"}}static parseExceptionData(e){let t="";try{t=String.fromCharCode.apply(null,e)}catch(e){return"Failed to decode exception data:"+e.toString()}return t}}class ms{constructor(e,t){this._proto=e,this._schemas=t}get proto(){return this._proto}get schemas(){return this._schemas}registerSchemas(e){return e.registerSchemas({proto:this.proto,schemaNames:this.schemas})}}class ys{constructor(e,t){this._tileName=e,this._tileSchema=t,this._addedSchemaName=e+"Added",this._attachedSchemaName=e+"Attached",this._changedSchemaName=e+"Changed",this._deletedSchemaName=e+"Deleted"}get tileName(){return this._tileName}get tileSchema(){return this._tileSchema}get addedSchemaName(){return this._addedSchemaName}get attachedSchemaName(){return this._attachedSchemaName}get changedSchemaName(){return this._changedSchemaName}get deletedSchemaName(){return this._deletedSchemaName}registerSchemas(e){const t='syntax="proto3";message '+this.addedSchemaName+" "+this.tileSchema+"; message "+this.changedSchemaName+" "+this.tileSchema+"; message "+this.attachedSchemaName+" "+this.tileSchema+"; message "+this.deletedSchemaName+" "+this.tileSchema+"; ",n=[this.addedSchemaName,this.changedSchemaName,this.attachedSchemaName,this.deletedSchemaName];return e.registerSchemas({proto:t,schemaNames:n})}}class vs{initialize(e){}getSession(){return null}setULSLogger(e){}setSendOTelEventCallback(e){}setSendDiagnosticTraceCallback(e){}setRequestAuthTokenCallback(e){}setIsFeatureEnabledCallback(e){}setIsChangeGateEnabledCallback(e){}registerLocalWorkflow(e){}activateAnnotation(e){return null}updateAnnotationConfig(e){}releaseAnnotation(e){return null}submitCustomMessage(e){return null}submitLargeBinaryDataMessage(e){return null}requestBinaryDataForBlob(e){return null}submitOperation(e){}setSessionDataCallback(e){}setAnnotationResultCallback(e){}setAnnotationState(e){}setAnnotationMetadata(e){}setInitSessionCallback(e){}setSessionInitOverrideCallback(e){}setMessageBridge(e){}setMessageBridgeToALInterceptor(e){}forceReconnectSession(e){return null}setSessionCloseCallback(e){return null}setConnectCallback(e){return null}removeConnectionStateCallback(e){return!1}closeSession(){return null}startNewSession(){}authenticateInteractive(){return null}submit(e){}addEventHandler(e){}removeEventHandler(e){}registerSimpleLocalWorkflow(e){return null}registerSimpleRemoteWorkflow(e){return null}registerReduceWorkflow(e){return null}registerSchemas(e){return null}getAnnotations(e){return null}getAsyncClient(e){return null}}},25686:(e,t,n)=>{"use strict";var o;n.d(t,{f:()=>o}),function(e){e[e.NotAuthenticated=0]="NotAuthenticated",e[e.Pending=1]="Pending",e[e.Authenticated=2]="Authenticated",e[e.WacUserInfoAuthenticated=3]="WacUserInfoAuthenticated",e[e.TokenMissingInteractionRequired=4]="TokenMissingInteractionRequired"}(o||(o={}))},30773:(e,t,n)=>{"use strict";n.d(t,{Cs:()=>u,Td:()=>s,U8:()=>a,f8:()=>d,i2:()=>l,og:()=>i,tj:()=>r,wR:()=>c});var o=n(66300);class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetClaimsChallengeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireClaimsChallengeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SetSeedingStatusChangeCallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_FireSeedingStatusChangeCallbackResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_InteractiveAuthMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsResponseBridgeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetHostBridgeSessionRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetHostBridgeSessionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()}},35519:(e,t,n)=>{"use strict";n.d(t,{$j:()=>k,B_:()=>N,D0:()=>F,F_:()=>h,Fz:()=>z,GA:()=>E,Gs:()=>H,HZ:()=>G,LQ:()=>m,Nn:()=>T,Ol:()=>I,PR:()=>W,PY:()=>C,QB:()=>r,Qq:()=>A,Re:()=>l,Sv:()=>j,Sy:()=>te,TV:()=>U,Tb:()=>x,VR:()=>R,Wx:()=>c,XE:()=>re,YK:()=>s,Yp:()=>a,ZH:()=>O,Zy:()=>v,_4:()=>P,_p:()=>d,ah:()=>B,dx:()=>$,eE:()=>f,eG:()=>Y,fZ:()=>D,fr:()=>q,g$:()=>Z,gy:()=>K,i:()=>i,iT:()=>se,iU:()=>Q,kd:()=>L,l0:()=>M,lZ:()=>oe,lj:()=>X,n4:()=>_,o5:()=>ne,p3:()=>u,pr:()=>b,ru:()=>p,ry:()=>y,uN:()=>g,vG:()=>J,w9:()=>S,wU:()=>ee,z_:()=>w,zk:()=>V});var o=n(66300);class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_Response"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_StreamingRequest"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionError"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsClientError"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetAnnotationsErrorInfo"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_RateLimitErrorResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionLongPollResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseReason"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){o.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionSwapOnClose"}static getBaseTypes(){return["AugLoop_Session_Protocol_SessionCloseReason"]}static typeGuard(e){return o.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionCloseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class w{constructor(e){o.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()};class T{constructor(e){o.h.assign(T,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[T.getTypeName()])}}T.H_={T_:T.getTypeName(),B_:T.getBaseTypes()};class _{constructor(e){o.h.assign(_,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[_.getTypeName()])}}_.H_={T_:_.getTypeName(),B_:_.getBaseTypes()};class C{constructor(e){o.h.assign(C,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[C.getTypeName()])}}C.H_={T_:C.getTypeName(),B_:C.getBaseTypes()};class k{constructor(e){o.h.assign(k,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[k.getTypeName()])}}k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class E{constructor(e){o.h.assign(E,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[E.getTypeName()])}}E.H_={T_:E.getTypeName(),B_:E.getBaseTypes()};class A{constructor(e){o.h.assign(A,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[A.getTypeName()])}}A.H_={T_:A.getTypeName(),B_:A.getBaseTypes()};class I{constructor(e){o.h.assign(I,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[I.getTypeName()])}}I.H_={T_:I.getTypeName(),B_:I.getBaseTypes()};class P{constructor(e){o.h.assign(P,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[P.getTypeName()])}}P.H_={T_:P.getTypeName(),B_:P.getBaseTypes()};class M{constructor(e){o.h.assign(M,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BatchedMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[M.getTypeName()])}}M.H_={T_:M.getTypeName(),B_:M.getBaseTypes()};class x{constructor(e){o.h.assign(x,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[x.getTypeName()])}}x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()};class R{constructor(e){o.h.assign(R,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_MicroSyncMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[R.getTypeName()])}}R.H_={T_:R.getTypeName(),B_:R.getBaseTypes()};class D{constructor(e){o.h.assign(D,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SyncResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[D.getTypeName()])}}D.H_={T_:D.getTypeName(),B_:D.getBaseTypes()};class O{constructor(e){o.h.assign(O,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDeleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[O.getTypeName()])}}O.H_={T_:O.getTypeName(),B_:O.getBaseTypes()};class N{constructor(e){o.h.assign(N,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[N.getTypeName()])}}N.H_={T_:N.getTypeName(),B_:N.getBaseTypes()};class L{constructor(e){o.h.assign(L,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[L.getTypeName()])}}L.H_={T_:L.getTypeName(),B_:L.getBaseTypes()};class F{constructor(e){o.h.assign(F,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenFailureMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[F.getTypeName()])}}F.H_={T_:F.getTypeName(),B_:F.getBaseTypes()};class B{constructor(e){o.h.assign(B,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_TokenProvisionResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[B.getTypeName()])}}B.H_={T_:B.getTypeName(),B_:B.getBaseTypes()};class W{constructor(e){o.h.assign(W,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_KeepAlive"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[W.getTypeName()])}}W.H_={T_:W.getTypeName(),B_:W.getBaseTypes()};class U{constructor(e){o.h.assign(U,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[U.getTypeName()])}}U.H_={T_:U.getTypeName(),B_:U.getBaseTypes()};class G{constructor(e){o.h.assign(G,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[G.getTypeName()])}}G.H_={T_:G.getTypeName(),B_:G.getBaseTypes()};class H{constructor(e){o.h.assign(H,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_WorkflowExecutionCompleteMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[H.getTypeName()])}}H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()};class q{constructor(e){o.h.assign(q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SeedingStatusChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[q.getTypeName()])}}q.H_={T_:q.getTypeName(),B_:q.getBaseTypes()};class ${constructor(e){o.h.assign($,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Message"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[$.getTypeName()])}}$.H_={T_:$.getTypeName(),B_:$.getBaseTypes()};class V{constructor(e){o.h.assign(V,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitV2Response"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[V.getTypeName()])}}V.H_={T_:V.getTypeName(),B_:V.getBaseTypes()};class j{constructor(e){o.h.assign(j,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[j.getTypeName()])}}j.H_={T_:j.getTypeName(),B_:j.getBaseTypes()};class z{constructor(e){o.h.assign(z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2InitResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[z.getTypeName()])}}z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class Q{constructor(e){o.h.assign(Q,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Q.getTypeName()])}}Q.H_={T_:Q.getTypeName(),B_:Q.getBaseTypes()};class J{constructor(e){o.h.assign(J,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BridgeMessage"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[J.getTypeName()])}}J.H_={T_:J.getTypeName(),B_:J.getBaseTypes()};class K{constructor(e){o.h.assign(K,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionConnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[K.getTypeName()])}}K.H_={T_:K.getTypeName(),B_:K.getBaseTypes()};class Y{constructor(e){o.h.assign(Y,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionDisconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Y.getTypeName()])}}Y.H_={T_:Y.getTypeName(),B_:Y.getBaseTypes()};class X{constructor(e){o.h.assign(X,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SessionReconnectMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[X.getTypeName()])}}X.H_={T_:X.getTypeName(),B_:X.getBaseTypes()};class Z{constructor(e){o.h.assign(Z,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_SubmittedCustomMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[Z.getTypeName()])}}Z.H_={T_:Z.getTypeName(),B_:Z.getBaseTypes()};class ee{constructor(e){o.h.assign(ee,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ServerAuthenticationStateChangeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[ee.getTypeName()])}}ee.H_={T_:ee.getTypeName(),B_:ee.getBaseTypes()};class te{constructor(e){o.h.assign(te,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ClaimsChallengeMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[te.getTypeName()])}}te.H_={T_:te.getTypeName(),B_:te.getBaseTypes()};class ne{constructor(e){o.h.assign(ne,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_BlobUploadResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[ne.getTypeName()])}}ne.H_={T_:ne.getTypeName(),B_:ne.getBaseTypes()};class oe{constructor(e){o.h.assign(oe,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataMessage"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[oe.getTypeName()])}}oe.H_={T_:oe.getTypeName(),B_:oe.getBaseTypes()};class re{constructor(e){o.h.assign(re,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_GetPluginsMetadataResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Response"]}static typeGuard(e){return o.h.matchesTypesFor(e,[re.getTypeName()])}}re.H_={T_:re.getTypeName(),B_:re.getBaseTypes()};class se{constructor(e){o.h.assign(se,this,e)}static getTypeName(){return"AugLoop_Session_Protocol_ExecutionCorrelatedClientResponse"}static getBaseTypes(){return["AugLoop_Session_Protocol_Message"]}static typeGuard(e){return o.h.matchesTypesFor(e,[se.getTypeName()])}}se.H_={T_:se.getTypeName(),B_:se.getBaseTypes()}},69644:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AnnotationActivationMessage:()=>s.n4,AnnotationActivationResponse:()=>s.PY,AnnotationConfigUpdateMessage:()=>s.Ol,AnnotationConfigUpdateResponse:()=>s._4,AnnotationReleaseMessage:()=>s.GA,AnnotationReleaseResponse:()=>s.Qq,AnnotationResultState:()=>r.K7,AnnotationResultStateMessage:()=>s.$j,AnnotationResultsMessage:()=>s.B_,BatchedMessage:()=>s.l0,BlobUploadResponse:()=>s.o5,BridgeMessage:()=>s.vG,CacheDumpRequestMessage:()=>s.z_,CacheDumpRequestResponse:()=>s.Nn,ClaimsChallengeMessage:()=>s.Sy,ErrorResponse:()=>s._p,ErrorResponseCode:()=>r.xv,ExecutionCorrelatedClientResponse:()=>s.iT,ExecutionError:()=>s.Re,ExecutionErrorCode:()=>r.Qn,FireClaimsChallengeCallbackResponse:()=>a.Td,FireSeedingStatusChangeCallbackResponse:()=>a.U8,GetAnnotationsClientError:()=>s.Wx,GetAnnotationsClientErrorCode:()=>r.zy,GetAnnotationsErrorInfo:()=>s.p3,GetAnnotationsResponseBridgeMessage:()=>a.wR,GetHostBridgeSessionRequestMessage:()=>a.Cs,GetHostBridgeSessionResponse:()=>a.f8,GetPluginsMetadataMessage:()=>s.lZ,GetPluginsMetadataResponse:()=>s.XE,InteractiveAuthMessage:()=>a.i2,KeepAlive:()=>s.PR,Message:()=>s.QB,MessageEndpoint:()=>o.N0,MicroSyncMessage:()=>s.VR,OAuth2CallbackMessage:()=>s.iU,OAuth2InitMessage:()=>s.Sv,OAuth2InitResponse:()=>s.Fz,OAuth2InitV2Message:()=>s.dx,OAuth2InitV2Response:()=>s.zk,ProcessMessageErrorReason:()=>o.N2,RateLimitErrorResponse:()=>s.ru,Response:()=>s.YK,SeedingProgressCode:()=>r.e9,SeedingStatusChangeMessage:()=>s.fr,SendMessageErrorReason:()=>o.Ef,ServerAuthenticationState:()=>i.f,ServerAuthenticationStateChangeMessage:()=>s.wU,SessionCloseMessage:()=>s.w9,SessionCloseReason:()=>s.Zy,SessionConnectMessage:()=>s.gy,SessionDeleteMessage:()=>s.ZH,SessionDisconnectMessage:()=>s.eG,SessionInitMessage:()=>s.eE,SessionInitResponse:()=>s.uN,SessionLongPollMessage:()=>s.LQ,SessionLongPollMessageType:()=>r.PO,SessionLongPollResponse:()=>s.ry,SessionReconnectMessage:()=>s.lj,SessionSwapOnClose:()=>s.pr,SessionSwapReason:()=>r.ey,SetClaimsChallengeCallbackMessage:()=>a.tj,SetSeedingStatusChangeCallbackMessage:()=>a.og,StreamingRequest:()=>s.Yp,StreamingResponse:()=>s.i,SubmittedCustomMessage:()=>s.g$,SyncMessage:()=>s.Tb,SyncResponse:()=>s.fZ,TimeoutErrorResponse:()=>s.F_,TokenFailureMessage:()=>s.D0,TokenProvisionMessage:()=>s.kd,TokenProvisionResponse:()=>s.ah,WorkflowExecutionCompleteMessage:()=>s.Gs,WorkflowGraphInitMessage:()=>s.TV,WorkflowGraphInitResponse:()=>s.HZ,currentProtocolVersion:()=>r.mH,extractMessageNameFromTypeName:()=>o.L9});var o=n(50762),r=n(59810),s=n(35519),i=n(25686),a=n(30773)},50762:(e,t,n)=>{"use strict";n.d(t,{N0:()=>_,N2:()=>w,Ef:()=>S,L9:()=>T});var o,r,s,i={util:{},roots:{default:{}}},a=(i.util,i.roots.default||(i.roots.default={}),function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.traceId="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.userTenantId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.joinContextId="",e.prototype.userDataBoundaryType="",e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/SessionHealthEvent"},e}()),l=n(64384);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(s||(s={}));class c extends a{constructor(e,t){var n,i;super({source:o[e.source],reason:r[e.reason],reasonDependency:e.reasonDependency,subReason:e.subReason,sessionHealthEventName:e.sessionHealthEventName,impact:s[e.impact],success:e.success,durationMs:null!==(n=e.durationMs)&&void 0!==n?n:0,count:"number"==typeof e.count?e.count:1,message:e.message,affectedWorkflows:(null!==(i=e.affectedWorkflows)&&void 0!==i?i:[]).join(","),resourceId:e.resourceId,dimension0:e.dimension0,dimension1:e.dimension1,dimension2:e.dimension2,dimension3:e.dimension3,cv:e.cv,resultSignature:e.resultSignature,resultDescription:e.resultDescription,joinContextId:e.joinContextId}),this.eventName="SessionHealth",this.aggregationEnabled=!1,t&&this.setClientMetadata(t),this.metricCount=e.metricCount,this.metricDuration=e.metricDuration}getMetrics(){const e={};return(void 0===this.metricCount||this.metricCount)&&(e[`${this.sessionHealthEventName}.CountV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.count}),(void 0===this.metricDuration||this.metricDuration)&&(e[`${this.sessionHealthEventName}.DurationMsV2`]={dimensionNames:()=>c.dimensionNames,dimensionValues:this.getDimensionValues(),value:this.durationMs}),e}setClientMetadata(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDocSessionId=e.docSessionId,this.clientUserAgent=e.userAgent),this}setUserContext(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString(),this.userTenantId=e.tid),this}setReason(e){return this.reason=r[e],this}setSource(e){return this.source=o[e],this}setImpact(e){return this.impact=s[e],this}setAffectedWorkflows(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this}getAffectedWorkflows(){return this.affectedWorkflows.split(",")}enableAggregation(){return this.aggregationEnabled=!0,this}shouldBeAggregated(){return this.aggregationEnabled}start(){return this.startTime=(0,l.t)(),this}stop(){const e=(0,l.t)();return this.durationMs=Math.round(e-this.startTime),this}getDimensionValues(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0",`${this.reason}_${this.reasonDependency}`,this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]}}c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"];var u=n(62531),d=n(36182),h=n(95759);const p=new h.eU("disabledChangeGates",[]),f=(e,t,...n)=>{const o=-1===p.getValue().indexOf(e);return t?o?t(...n):void 0:o};var g=n(66300),m=n(59810),y=n(35519);class v{constructor(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}static setLogIntervalError(e){v.logIntervalError=e}put(e,t,n,o,r,s,i){if(null==n||n<=0)throw new Error("Cache timeout must be a positive number");(null==r||r<=0)&&(r=this.options.idleDurationMs);const a={value:t,lastUsed:r?Date.now():void 0,expire:n+Date.now(),idleDurationMs:r,expireCallback:o,expiringTriggerTime:s+Date.now(),expiringCallback:i};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t}del(e){if(this.options.delCallback){const t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}const t=this.cache.delete(e);return 0===this.size()&&this.clear(),t}clear(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()}get(e){let t=this.cache.get(e);if(t){if(this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.expire<Date.now()&&(this.del(e),t.expireCallback&&t.expireCallback(e,t.value),t=this.cache.get(e),!t))return;return t.value}}keys(){return this.cache.keys()}forEach(e){this.cache.forEach(((t,n)=>{e(t.value,n)}))}size(){return this.cache.size}updateExpireTime(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)}onInterval(){const e=Date.now();this.cache.forEach(((t,n)=>{try{if(t.idleDurationMs&&t.lastUsed<e-t.idleDurationMs)return this.del(n),void(this.options.idleCallback&&this.options.idleCallback(n,t.value));t.expire<e&&(this.del(n),t.expireCallback&&t.expireCallback(n,t.value)),t.expiringTriggerTime<e&&t.expiringCallback&&(t.expiringCallback(n,t.value),t.expiringCallback=void 0)}catch(e){v.logIntervalError&&v.logIntervalError(e)}}))}}const b=new h.eU("processMessageEndpointValidation",!1);var S,w;function T(e){const t=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];let n;for(const o of t)if(0===e.indexOf(o)){n=o;break}if(!n)return"MalformedMessageName";const o=e.indexOf("Message",e.length-7)===e.length-7;return e.slice(n.length,o?-7:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.ClientClosed="Client closed",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found",e.TooManyDeltaOperations="SyncMessage with too many delta operations",e.UnsupportedSyncMessageSeq0NonSeeding="SyncMessages with seq 0 are not supported in non seeding sequencer (SenderId)."}(S||(S={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(w||(w={}));class _{constructor(e){this.config=e,this.nextMessageId=1,this.pendingResponseCallbacks=new v({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageValidators=new Map,this.messageIdPrefix=e.messageIdPrefix,this.source="c"===e.messageIdPrefix?o.ClientRuntime:o.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}setClientMetadata(e){this.clientMetadata=e}setEgress(e){this.egress=e,this.config.resendPendingMessagesOnReconnect&&this.egress&&this.pendingResponseCallbacks.forEach(((e,t)=>{e.logOp.dimension1=(e.sendCount++).toString(),this.egress(e.message,(t=>this.onEgressError(t,e)))}))}ingress(e,t){y.YK.typeGuard(e)?(this.processResponse(e),t()):this.processMessage(e,t),y.w9.typeGuard(e)&&!e.reconnectAllowed&&this.clearAllPendingResponses()}sendMessage(e,t,n,i=0){var a,l;const d=new c({sessionHealthEventName:"SendMessage",source:this.source,reason:r.Client,impact:this.source===o.ClientRuntime?s.MissingInput:s.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:T(g.h.getTypeNameFor(e)),dimension0:i.toString()}).start().enableAggregation(),h=()=>{if(d.setClientMetadata(this.clientMetadata),d.success)u.tG.info(572836e3,u.nh.CoreDefault,d.stop());else{const e="ErrorWithoutPendingResponse"===d.resultSignature||"ResponseCallbackException"===d.resultSignature||"We called into done callback"!==d.message;d.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),u.tG.error(572836001,u.nh.CoreDefault,d.stop())}};f("PersistMessageId")?e.messageId=null!==(a=e.messageId)&&void 0!==a?a:`${this.messageIdPrefix}${this.nextMessageId++}`:e.messageId=`${this.messageIdPrefix}${this.nextMessageId++}`,y.l0.typeGuard(e)&&e.messages.forEach(((t,n)=>t.messageId=e.messageId+"."+n));const p=g.h.getTypeNameFor(e)===y.w9.getTypeName(),v={message:e,logOp:d,logEvent:h,callback:void 0,sendCount:1};if(!n&&!p){v.callback=(n,o)=>{var r;if(n?f("IgnoreUnsupportedMessageErrorForOldClientVersion")&&n.code===m.xv.UnsupportedMessage?(d.resultSignature="Success",d.resultDescription=`Ignore error for ${g.h.getTypeNameFor(e)} message ${e.messageId}${y.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${n.error}`):(d.success=!1,d.resultSignature=n.error,d.resultDescription=`Error for ${g.h.getTypeNameFor(e)} message ${e.messageId}${y.Tb.typeGuard(e)?`, seq ${e.seq}`:""}: ${n.error}`):d.resultSignature="Success",t)try{d.message="We called into done callback",t(n,o)}catch(e){d.success=!1,d.resultSignature="ResponseCallbackException",d.resultDescription="Web"===(null===(r=this.clientMetadata)||void 0===r?void 0:r.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}h(),this.updateSendMessageStats(d.success,d.durationMs,n?new Error(n.error):void 0)};const n=()=>{v.callback(new y.F_({code:m.xv.RequestTimeout,error:"Timeout waiting for response"}),void 0)};let o=this.config.responseTimeoutMs;if(y.LQ.typeGuard(e)){const t=e;o=t.longPollTimeoutHint>=15e3&&t.longPollTimeoutHint<=3e5?t.longPollTimeoutHint+5e3:12e4}else y.Yp.typeGuard(e)&&(o=null!==(l=e.maxDelayMs)&&void 0!==l?l:12e4);this.pendingResponseCallbacks.put(e.messageId,v,o,n)}this.egress&&this.egress(e,(e=>this.onEgressError(e,v)),i)}onEgressError(e,t){var n,o;if(e){const r=t.message,s=this.pendingResponseCallbacks.get(t.message.messageId);s?(this.pendingResponseCallbacks.del(r.messageId),s.callback(new y._p({messageId:r.messageId,code:m.xv.EgressError,error:e.message}))):y.w9.typeGuard(r)?(t.logOp.success=null!==(o=null===(n=e.message)||void 0===n?void 0:n.endsWith("Client disconnected."))&&void 0!==o&&o,t.logOp.resultSignature="ErrorSendingSessionCloseMessage",t.logOp.resultDescription=`Error for ${g.h.getTypeNameFor(r)} message ${r.messageId}: ${e.message}`,t.logEvent()):(t.logOp.success=!1,t.logOp.resultSignature="ErrorWithoutPendingResponse",t.logOp.resultDescription=`Error for ${g.h.getTypeNameFor(r)} message ${r.messageId}: ${e.message}`,t.logEvent())}}queryEgressCacheSize(){return this.pendingResponseCallbacks.size()}onMessage(e,t,n){this.messageCallbacks.set(e,t),n&&this.messageValidators.set(e,n)}onMessageAsync(e,t,n){this.messageCallbacks.set(e,((e,n)=>{return o=this,r=void 0,i=function*(){try{const o=yield t(e);y._p.typeGuard(o)?n(o,void 0):n(void 0,o)}catch(e){n(e)}},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{l(i.next(e))}catch(e){t(e)}}function a(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var o;t.done?e(t.value):(o=t.value,o instanceof s?o:new s((function(e){e(o)}))).then(n,a)}l((i=i.apply(o,r||[])).next())}));var o,r,s,i})),n&&this.messageValidators.set(e,n)}getStats(){return this.stats}hasMessageCallback(e){return this.messageCallbacks.has(e)}cancelPendingResponseCallbacks(e){this.pendingResponseCallbacks.forEach(((t,n)=>{t&&(this.pendingResponseCallbacks.del(n),t.callback(new y._p({messageId:n,code:m.xv.Cancelled,error:`Cancelled. Reason: ${e}`})))}))}clearAllPendingResponses(){if(0==this.pendingResponseCallbacks.size())return;const e=new d.I({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});u.tG.info(572836002,u.nh.CoreDefault,e),this.pendingResponseCallbacks.clear()}processMessage(e,t){const n=new c({sessionHealthEventName:"ProcessMessage",source:this.source,reason:r.Client,impact:this.source===o.ClientRuntime?s.MissingOutput:s.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start().enableAggregation(),i=()=>{if(n.setClientMetadata(this.clientMetadata),n.success)u.tG.info(572836003,u.nh.CoreDefault,n.stop());else{const e="UnsupportedMessage"===n.resourceId||"Timeout"===n.resultSignature||"OnResponseInvokedMoreThanOnce"===n.resultSignature||"MessageCallbackException"===n.resultSignature||"We called into messageCallback"!==n.message;n.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),u.tG.error(572836032,u.nh.CoreDefault,n.stop())}};let a=this.messageCallbacks.get(g.h.getTypeNameFor(e));a?n.resourceId=T(g.h.getTypeNameFor(e)):a=(e,t)=>{n.resourceId=T(g.h.getTypeNameFor(e)),"MalformedMessageName"!==n.resourceId&&(n.resourceId="UnsupportedMessage"),t(new y._p({messageId:e.messageId,code:m.xv.UnsupportedMessage,error:`Message type ${g.h.getTypeNameFor(e)} is not supported`}))};const d=(e,t,n)=>!0===b.getValue()?JSON.stringify({message:e,validationSuccess:null==t?void 0:t.success,validationError:null==t?void 0:t.error,validationDurationMicroseconds:null==t?void 0:t.durationMicroseconds,stack:n}):void 0!==n?JSON.stringify({message:e,stack:n}):e;let h;const p=this.messageValidators.get(g.h.getTypeNameFor(e));if(p&&b.getValue()){const t=(0,l.g)(),n=p.validate(e),o=(0,l.g)();h={success:n.success,error:n.error,durationMicroseconds:Math.round(o-t)}}let f=!1;const v=(o,r)=>{if(f){n.success=!1,n.resultSignature="OnResponseInvokedMoreThanOnce";const t=`Invoked onResponse for ${g.h.getTypeNameFor(e)} message ${e.messageId} more than once`;n.resultDescription=d(t,h)}else if(o){n.success=!1,n.resultSignature=o.error,void 0!==o.code&&(n.dimension0=m.xv[o.code]);const t=`Error for ${g.h.getTypeNameFor(e)} message ${e.messageId}: ${o.error}`;n.resultDescription=d(t,h)}else n.resultSignature="Success",n.resultDescription=d("",h);f=!0,i(),o&&!g.h.matchesTypesFor(o,[y._p.getTypeName()])&&(o=new y._p({error:"Internal Server Error"})),this.updateProcessMessageStats(n.success,n.durationMs,o?new Error(o.error):void 0),o?(o.messageId=e.messageId,t(o)):r?(r.messageId=e.messageId,t(void 0,r)):t()};try{n.message="We called into messageCallback",a(e,v)}catch(e){n.success=!1,n.resultSignature="MessageCallbackException",n.resultDescription=d(e.message,h,e.stack),i(),this.updateProcessMessageStats(!1,n.durationMs,e),t()}}processResponse(e){var t;const n=new d.I({operationName:"ProcessResponse"});if(n.success=!0,n.setClientMetadata(this.clientMetadata),n.start(),e.messageId){const t=this.pendingResponseCallbacks.get(e.messageId),o=null==t?void 0:t.callback;if(o){if(y.i.typeGuard(e)&&!e.finalResponse){const n=t.message.maxDelayMs;this.pendingResponseCallbacks.updateExpireTime(e.messageId,n)}else this.pendingResponseCallbacks.del(e.messageId);g.h.matchesTypesFor(e,[y._p.getTypeName()])?o(e):o(void 0,e)}else n.resultSignature="NoPendingMessage",n.resultDescription=`${e.messageId}`,n.success=!1}else n.resultSignature="NoMessageIdSetInResponse",y._p.typeGuard(e)?n.resultDescription=e.error:n.resultDescription="MessageId is not available",n.success=!1;"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(n.resourceId=T(g.h.getTypeNameFor(e)),u.tG.info(572836034,u.nh.CoreDefault,n.stop()))}updateSendMessageStats(e,t,n){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||n?e&&n&&u.tG.warn(572836036,u.nh.CoreDefault,"Succeeded send message provided error object."):u.tG.warn(572836035,u.nh.CoreDefault,"Failed send message did not provide error object."),e||(n&&n.message===S.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)}updateProcessMessageStats(e,t,n){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||n?e&&n&&u.tG.warn(572836038,u.nh.CoreDefault,"Succeeded process message provided error object."):u.tG.warn(572836037,u.nh.CoreDefault,"Failed process message did not provide error object."),e||(n&&n.message===w.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)}}},59810:(e,t,n)=>{"use strict";n.d(t,{K7:()=>c,PO:()=>a,Qn:()=>r,e9:()=>u,ey:()=>l,mH:()=>o,xv:()=>i,zy:()=>s});const o=2;var r,s,i,a,l,c,u;!function(e){e[e.ServerError=0]="ServerError",e[e.WorkflowDisabled=100]="WorkflowDisabled",e[e.TokenNotReady=101]="TokenNotReady",e[e.FlightNotReady=102]="FlightNotReady",e[e.ContextNotReady=103]="ContextNotReady",e[e.WorkflowExcluded=104]="WorkflowExcluded",e[e.WorkflowExecutionTimeout=105]="WorkflowExecutionTimeout",e[e.LambdaExecutionError=106]="LambdaExecutionError",e[e.UnexpectedOutput=107]="UnexpectedOutput",e[e.FailedToFetchInputs=108]="FailedToFetchInputs",e[e.FailedToFetchRequestedContexts=109]="FailedToFetchRequestedContexts"}(r||(r={})),function(e){e[e.Unknown=0]="Unknown",e[e.InvalidRequest=1]="InvalidRequest",e[e.InvalidResponse=2]="InvalidResponse",e[e.RuntimeNotInitialized=3]="RuntimeNotInitialized",e[e.RequestCancelled=4]="RequestCancelled",e[e.ResponseReceivedAfterFinalResponse=5]="ResponseReceivedAfterFinalResponse"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.Found=302]="Found",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.UnprocessableContent=422]="UnprocessableContent",e[e.TooManyRequests=429]="TooManyRequests",e[e.SocketDisconnect=499]="SocketDisconnect",e[e.InternalServerError=500]="InternalServerError",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.UnsupportedMessage=1e3]="UnsupportedMessage",e[e.Cancelled=1001]="Cancelled",e[e.EgressError=1002]="EgressError",e[e.SyncMessageException=2e3]="SyncMessageException",e[e.SyncMessageUnsupported=2001]="SyncMessageUnsupported",e[e.SyncMessageUnexpectedSeed=2002]="SyncMessageUnexpectedSeed",e[e.SyncMessageUnsupportedBatch=2003]="SyncMessageUnsupportedBatch",e[e.SyncMessageQueueFull=2004]="SyncMessageQueueFull",e[e.SyncMessageTooLateOrDuplicate=2005]="SyncMessageTooLateOrDuplicate",e[e.SyncMessageGroupIdMismatch=2006]="SyncMessageGroupIdMismatch",e[e.SyncMessageGroupStop=2007]="SyncMessageGroupStop",e[e.SyncMessageLost=2008]="SyncMessageLost",e[e.SyncMessageUnprocessedDuplicate=2009]="SyncMessageUnprocessedDuplicate",e[e.SyncMessageSessionClosed=2010]="SyncMessageSessionClosed",e[e.SyncMessageAbandoned=2011]="SyncMessageAbandoned",e[e.SyncMessageTooManyDeltaOperations=2012]="SyncMessageTooManyDeltaOperations",e[e.SyncMessageSessionSizeLimitExceeded=2013]="SyncMessageSessionSizeLimitExceeded",e[e.TokenValidationError=2100]="TokenValidationError",e[e.TokenDecryptError=2101]="TokenDecryptError",e[e.TokenTypeError=2102]="TokenTypeError",e[e.TokenUserBlocked=2103]="TokenUserBlocked",e[e.AnnotationActivationInvalidType=2200]="AnnotationActivationInvalidType",e[e.AnnotationReleaseTokenNotFound=2300]="AnnotationReleaseTokenNotFound"}(i||(i={})),function(e){e[e.UnKnown=0]="UnKnown",e[e.Start=1]="Start",e[e.Regular=2]="Regular",e[e.CheckConnection=3]="CheckConnection",e[e.PostEgress=4]="PostEgress",e[e.TimeoutResend=5]="TimeoutResend",e[e.FailResend=6]="FailResend"}(a||(a={})),function(e){e[e.IdentityChange=0]="IdentityChange"}(l||(l={})),function(e){e[e.Idle=0]="Idle",e[e.Pending=1]="Pending"}(c||(c={})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Started=1]="Started",e[e.Incomplete=2]="Incomplete",e[e.Finished=3]="Finished"}(u||(u={}))},95759:(e,t,n)=>{"use strict";n.d(t,{eU:()=>p});var o,r,s=n(62531),i=n(36182),a=n(92792),l=n.n(a);class c{constructor(){this.listeners=new Map,this.lastId=0}addListener(e){if(!e)throw new Error("No callback provided for data listener");return this.listeners.set(this.lastId,e),this.lastId++}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach((t=>{t(e)}))}}!function(e){e.Add="Add",e.Remove="Remove",e.Set="Set",e.Delete="Delete"}(r||(r={}));class u{static applyECSPatchOperation(e,t){let n=!1;if("object"==typeof t||Array.isArray(t))switch(e.operation){case r.Add:case r.Remove:n=u.applyAddOrRemoveOperation(e.path,t,e.value,e.operation);break;case r.Set:n=u.applySetOperation(e.path,t,e.value);break;case r.Delete:n=u.applyDeleteOperation(e.path,t,e.value)}return n?s.tG.verbose(505956121,s.nh.CoreDefault,`PATCH operation succeeded for ${e.operation} on ${e.settingName} with path: ${e.path}.`):s.tG.error(505956122,s.nh.CoreDefault,`PATCH operation failed for ${e.operation} on ${e.settingName} with path: ${e.path}`),n}static applyAddOrRemoveOperation(e,t,n,o){let i=!1;try{let s=[];if("object"!=typeof t||Array.isArray(t)?Array.isArray(t)&&(s=t):s=e.reduce(((e,t)=>e&&e[t]),t),Array.isArray(s))if(o===r.Add)s.push(n),i=!0;else if(o===r.Remove){const e=s.indexOf(n);e>=0&&(s.splice(e,1),i=!0)}}catch(e){s.tG.info(505968832,s.nh.CoreDefault,`Exception thrown while applying operation type: ${o} for an array. Error: ${e}`),i=!1}return i}static applySetOperation(e,t,n){let o=!1;try{const r=e.slice(0,-1),s=e[e.length-1];let i={};"object"!=typeof t||Array.isArray(t)||(i=r.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof i||Array.isArray(i)||(i[s]=n,o=!0))}catch(e){s.tG.info(505968802,s.nh.CoreDefault,`Exception thrown while applying set operation. Error: ${e}`),o=!1}return o}static applyDeleteOperation(e,t,n){let o=!1;try{let r={};"object"!=typeof t||Array.isArray(t)||(r=e.reduce(((e,t)=>e&&e[t]),t),"object"!=typeof r||Array.isArray(r)||"string"!=typeof n||r.hasOwnProperty(n)&&(delete r[n],o=!0))}catch(e){s.tG.info(505968801,s.nh.CoreDefault,`Exception thrown while applying delete operation. Error: ${e}`),o=!1}return o}}o=u,u.parseECSOperation=(e,t)=>{if(!t.hasOwnProperty("operationType")||!t.hasOwnProperty("path")||!t.hasOwnProperty("value"))throw new Error(`Invalid format for PATCH operation on setting: ${e}`);const n=t.operationType.toLowerCase(),r=o.convertToConfigPatchOperationType(n);return{settingName:e,path:t.path?t.path.split("."):[],operation:r,value:t.value}},u.convertToConfigPatchOperationType=e=>{switch(e){case"add":return r.Add;case"remove":return r.Remove;case"set":return r.Set;case"delete":return r.Delete;default:throw new Error(`Invalid operation type: ${e}`)}};var d=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))};class h extends c{constructor(e){super(),this.name=e}static initEcsSettingsProvider(e){s.tG.info(505999498,s.nh.CoreDefault,"Initializing ECS settings provider."),h.ecsSettingsProvider=e}static enableEcsPatchConfig(e){h.ecsPatchConfigEnabled=e}static getInstance(e){let t=this.allSettings.get(e);if(!t){t=new h(e);const n=h.tryGetConfigProperty(h.currentConfig,e);n.success&&t.updateValue(n.value),this.allSettings.set(e,t)}return t}static getPatternInstance(e){let t=this.allPatternSettings.get(e);if(!t){t={regex:new RegExp(e),setting:new h(e)};const n=h.tryGetConfigPropertyByPattern(h.currentConfig,t.regex);t.setting.updateValue(n),this.allPatternSettings.set(e,t)}return t.setting}static setNewConfig(e){h.currentConfig=e,s.tG.info(572837966,s.nh.CoreDefault,`New config: ${JSON.stringify(e)}`),h.allSettings.forEach(((e,t)=>{const n=h.tryGetConfigProperty(h.currentConfig,t).value;e.updateValue(n)&&(s.tG.info(572837967,s.nh.CoreDefault,`Setting new value for ${t}: ${n instanceof Object?JSON.stringify(n):n}`),e.notifyListeners(n))})),h.allPatternSettings.forEach(((t,n)=>{const o=h.tryGetConfigPropertyByPattern(e,t.regex);t.setting.updateValue(o)&&(s.tG.info(508432774,s.nh.CoreDefault,`Setting new value for pattern ${n}: ${JSON.stringify(o)}`),t.setting.notifyListeners(o))}))}static tryGetConfigProperty(e,t){return e&&e.hasOwnProperty(t)?{success:!0,value:h.selectApplicableValue(e[t])}:{success:!1,value:void 0}}static tryGetConfigPropertyByPattern(e,t){const n=[];if(e){const o=Object.getOwnPropertyNames(e).filter((e=>t.test(e)));for(const t of o)n.push({name:t,value:h.selectApplicableValue(e[t])})}return n}static setGlobalFilter(e){h.globalFilter=e}static setLocalConfig(e){h.localConfig=e,s.tG.info(506053841,s.nh.CoreDefault,`Setting localConfig field in Setting class: ${JSON.stringify(h.localConfig)}`)}static clear(){h.currentConfig=void 0,h.localConfig=void 0,h.allSettings.clear(),h.allPatternSettings.clear(),h.ecsSettingsProvider=void 0}static selectApplicableValue(e){let t;if(e){const n=e.find((e=>!h.globalFilter||h.globalFilter(e)));n&&(t=n.value)}return t}getName(){return this.name}getValue(){if(function(){var e;return void 0!==globalThis.process&&"true"===(null===(e=globalThis.process.env)||void 0===e?void 0:e.VALIDATE_CORRECT_USAGE_OF_GET_VALUE)}()&&0===this.listeners.size){const e=new Error(`SettingInstance or ChangeGate is being used incorrectly. Make sure .getValue() or ChangeGate is called during runtime or there is a listener set up on the setting. For more info visit: ${h.troubleshootUrl}`);throw e.name="Incorrect usage of getValue()",e}return this.value}getValueAdvancedAsync(e){return d(this,void 0,void 0,(function*(){const t=new i.I({operationName:"ECSGetValueAsync"},{metricDuration:!0}).start();let n;try{const o=yield h.ecsSettingsProvider.getSettingValue(this.name,e);t.dimension0=o.userAuthenticated?"Authenticated":"Anonymous",t.success=!0;let r=o.value,s=o.ecsSection;return r||(r=h.tryGetConfigProperty(h.localConfig,this.name).value,r&&o.patchValue&&(r=h.applyPatchOperationOnSetting(this.name,r,o.patchValue),s=o.ecsPatchSection)),n=`Setting value for ${this.name} is ${JSON.stringify(r)}.\n Config IDs: ${JSON.stringify(s)}.`,r}catch(e){s.tG.error(505226379,s.nh.CoreDefault,`Exception thrown while getting setting value for ${this.name}. Error: ${e}`),t.success=!1;const o=h.tryGetConfigProperty(h.localConfig,this.name).value;return n=`Setting value for ${this.name} is ${JSON.stringify(o)}.`,o}finally{s.tG.info(506053839,s.nh.CoreDefault,t.stop()),s.tG.info(505821320,s.nh.CoreDefault,n)}}))}updateValue(e){return!l()(this.value,e)&&(s.tG.info(572837968,s.nh.CoreDefault,`Received new property value for ${this.getName()}:`,e),this.value=e,!0)}static applyPatchOperationsOnConfig(e){try{if(!h.ecsPatchConfigEnabled)return e;const t=this.tryGetConfigProperty(e,"patchOperations").value;if(!t||0===t.length)return e;const n=[];for(const[e,o]of Object.entries(t))try{n.push(u.parseECSOperation(e,o))}catch(t){s.tG.error(505734922,s.nh.CoreDefault,`Exception thrown while parsing ECS PATCH operation for setting: ${e}. Error: ${t}`);continue}const o=new Map;for(const t of n)if(null==e?void 0:e.hasOwnProperty(t.settingName)){const n=JSON.parse(JSON.stringify(e[t.settingName])),r=h.selectApplicableValue(n);u.applyECSPatchOperation(t,r)&&(o.set(t.settingName,r),e[t.settingName]=n)}return o.size>0&&s.tG.info(505788322,s.nh.CoreDefault,`Resulting settings after PATCHes were applied: ${JSON.stringify(Object.fromEntries(o))}`),e}catch(t){return s.tG.error(505788321,s.nh.CoreDefault,`Exception thrown while applying ECS PATCH operations. Error: ${t}`),e}}static applyPatchOperationOnSetting(e,t,n){try{if(!h.ecsPatchConfigEnabled)return t;const o=JSON.parse(JSON.stringify(t)),r=n,s=u.parseECSOperation(e,r);return u.applyECSPatchOperation(s,o),o}catch(e){return s.tG.error(505788323,s.nh.CoreDefault,`Exception thrown while applying ECS PATCH operation on setting. Error: ${e}`),t}}}h.allSettings=new Map,h.allPatternSettings=new Map,h.ecsPatchConfigEnabled=!1,h.troubleshootUrl="https://eng.ms/docs/experiences-devices/opg/office-ai/augloop-ai-platform/augmentation-loop/documentation/server-workflow-tutorials/settings/troubleshoot";class p extends c{constructor(e,t){super(),this.listenerId=NaN,this.defaultValue=t,this.setting=h.getInstance(e)}getDefaultValue(){return this.defaultValue}addListener(e){return Number.isNaN(this.listenerId)&&(this.listenerId=this.setting.addListener((()=>{this.notifyListeners(this.getValue())}))),super.addListener(e)}removeListener(e){super.removeListener(e),0!=this.listeners.size||Number.isNaN(this.listenerId)||(this.setting.removeListener(this.listenerId),this.listenerId=NaN)}getValue(){const e=this.setting.getValue();return void 0===e?this.defaultValue:e}getValueAdvancedAsync(e){return d(this,void 0,void 0,(function*(){const t=yield this.setting.getValueAdvancedAsync(e);return void 0===t?this.defaultValue:t}))}}},87214:(e,t,n)=>{"use strict";var o;n.d(t,{r:()=>o}),function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(o||(o={}))},44319:(e,t,n)=>{"use strict";n.d(t,{DA:()=>a,Iz:()=>i,YH:()=>r,h_:()=>s});var o=n(66300);class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Annotation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_BinaryClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class i{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_StreamAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_ExecutionCorrelatedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},26850:(e,t,n)=>{"use strict";n.d(t,{W8:()=>i,ay:()=>s,k$:()=>r,tX:()=>l,u$:()=>a});var o=n(66300);class r{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Apology"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_SecondaryApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_WorkflowActivationFailureDetails"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_AuthTokenIsMissingDetails"}static getBaseTypes(){return["AugLoop_Core_WorkflowActivationFailureDetails"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_NotActivatedWorkflowApology"}static getBaseTypes(){return["AugLoop_Core_Apology","AugLoop_Core_Annotation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()}},47401:(e,t,n)=>{"use strict";n.d(t,{A5:()=>m,B9:()=>s,GH:()=>w,I:()=>i,Vm:()=>f,XP:()=>u,Xr:()=>l,Z5:()=>g,Zw:()=>p,fZ:()=>d,g0:()=>S,hK:()=>b,hW:()=>c,mX:()=>y,n4:()=>h,sT:()=>r,vg:()=>a,xU:()=>v});var o=n(66300);class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class b{constructor(e){o.h.assign(b,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[b.getTypeName()])}}b.H_={T_:b.getTypeName(),B_:b.getBaseTypes()};class S{constructor(e){o.h.assign(S,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[S.getTypeName()])}}S.H_={T_:S.getTypeName(),B_:S.getBaseTypes()};class w{constructor(e){o.h.assign(w,this,e)}static getTypeName(){return"AugLoop_Core_CancelSignalTriggeredWorkflowExecutionOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return o.h.matchesTypesFor(e,[w.getTypeName()])}}w.H_={T_:w.getTypeName(),B_:w.getBaseTypes()}},66300:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});class o{constructor(e){o.assign(o,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_&&Array.isArray(e.H_.B_)?e.H_.B_:[]}static getAllTypesFor(e){const t=o.getTypeNameFor(e);return t?[t,...o.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=o.getTypeNameFor(e),r=o.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(r.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}o.H_={T_:o.getTypeName(),B_:o.getBaseTypes()}},96708:(e,t,n)=>{"use strict";n.d(t,{HN:()=>r,M_:()=>s,WJ:()=>i});var o=n(66300);class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Signals_Signal"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_DirtyAreaSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_DirtyDocumentSignal"}static getBaseTypes(){return["AugLoop_Core_DirtyAreaSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()}},65512:(e,t,n)=>{"use strict";n.d(t,{I3:()=>c,LX:()=>u,Nn:()=>a,QG:()=>v,SB:()=>m,W1:()=>f,YQ:()=>r,hD:()=>g,iS:()=>i,sD:()=>h,u7:()=>y,wX:()=>d,yI:()=>s,yo:()=>l,zB:()=>p});var o=n(66300);class r{constructor(e){o.h.assign(r,this,e)}static getTypeName(){return"AugLoop_Core_Blob"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[r.getTypeName()])}}r.H_={T_:r.getTypeName(),B_:r.getBaseTypes()};class s{constructor(e){o.h.assign(s,this,e)}static getTypeName(){return"AugLoop_Core_Binary"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[s.getTypeName()])}}s.H_={T_:s.getTypeName(),B_:s.getBaseTypes()};class i{constructor(e){o.h.assign(i,this,e)}static getTypeName(){return"AugLoop_Core_TileGroup"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[i.getTypeName()])}}i.H_={T_:i.getTypeName(),B_:i.getBaseTypes()};class a{constructor(e){o.h.assign(a,this,e)}static getTypeName(){return"AugLoop_Core_Session"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[a.getTypeName()])}}a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class l{constructor(e){o.h.assign(l,this,e)}static getTypeName(){return"AugLoop_Core_Document"}static getBaseTypes(){return["AugLoop_Core_TileGroup"]}static typeGuard(e){return o.h.matchesTypesFor(e,[l.getTypeName()])}}l.H_={T_:l.getTypeName(),B_:l.getBaseTypes()};class c{constructor(e){o.h.assign(c,this,e)}static getTypeName(){return"AugLoop_Core_SubDocument"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[c.getTypeName()])}}c.H_={T_:c.getTypeName(),B_:c.getBaseTypes()};class u{constructor(e){o.h.assign(u,this,e)}static getTypeName(){return"AugLoop_Core_GridCell"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[u.getTypeName()])}}u.H_={T_:u.getTypeName(),B_:u.getBaseTypes()};class d{constructor(e){o.h.assign(d,this,e)}static getTypeName(){return"AugLoop_Core_GridNeighborhoodContext"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[d.getTypeName()])}}d.H_={T_:d.getTypeName(),B_:d.getBaseTypes()};class h{constructor(e){o.h.assign(h,this,e)}static getTypeName(){return"AugLoop_Core_ItemFilter"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[h.getTypeName()])}}h.H_={T_:h.getTypeName(),B_:h.getBaseTypes()};class p{constructor(e){o.h.assign(p,this,e)}static getTypeName(){return"AugLoop_Core_DynamicContext"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[p.getTypeName()])}}p.H_={T_:p.getTypeName(),B_:p.getBaseTypes()};class f{constructor(e){o.h.assign(f,this,e)}static getTypeName(){return"AugLoop_Core_ContextHolder"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[f.getTypeName()])}}f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class g{constructor(e){o.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_UserContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class m{constructor(e){o.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_TenantContextHolder"}static getBaseTypes(){return["AugLoop_Core_ContextHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class y{constructor(e){o.h.assign(y,this,e)}static getTypeName(){return"AugLoop_Core_EventsHolder"}static getBaseTypes(){return[]}static typeGuard(e){return o.h.matchesTypesFor(e,[y.getTypeName()])}}y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class v{constructor(e){o.h.assign(v,this,e)}static getTypeName(){return"AugLoop_Core_UserCommandsHolder"}static getBaseTypes(){return["AugLoop_Core_EventsHolder"]}static typeGuard(e){return o.h.matchesTypesFor(e,[v.getTypeName()])}}v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()}},74901:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AddOperation:()=>y.Xr,Annotation:()=>p.YH,AnnotationState:()=>l.r,Apology:()=>S.k$,AuthTokenIsMissingDetails:()=>S.u$,Binary:()=>b.yI,BinaryClassificationAnnotation:()=>p.h_,Blob:()=>b.YQ,BlobRefType:()=>h.J1,CancelSignalTriggeredWorkflowExecutionOperation:()=>y.GH,ContextHolder:()=>b.W1,CopilotLicenseType:()=>o,DeleteOperation:()=>y.n4,DeltaUpdateOperation:()=>y.xU,DirtyAreaSignal:()=>v.M_,DirtyDocumentSignal:()=>v.WJ,Document:()=>b.yo,DynamicContext:()=>b.zB,EntryPoint:()=>r,Event:()=>g,EventsHolder:()=>b.u7,ExecutionCorrelatedAnnotation:()=>p.DA,FocusOperation:()=>y.A5,GridCell:()=>b.LX,GridConstants:()=>h.u5,GridNeighborhoodContext:()=>b.wX,ItemChanges:()=>i,ItemChangesDelta:()=>y.B9,ItemDelta:()=>y.sT,ItemFilter:()=>b.sD,ItemOperation:()=>s,MicroSyncOperation:()=>y.hK,MoveOperation:()=>y.hW,NotActivatedWorkflowApology:()=>S.tX,OpenType:()=>h.h6,Operation:()=>y.I,OperationErrorCode:()=>a,OperationWithSiblingContext:()=>y.vg,PurgeByTypesOperation:()=>y.Z5,PurgeOperation:()=>y.Zw,PurgeSubtreeExceptTypesOperation:()=>y.Vm,Scenario:()=>d,SchemaObject:()=>f.h,SecondaryApology:()=>S.ay,Session:()=>b.Nn,Signal:()=>v.HN,SignalOperation:()=>y.g0,StreamAnnotation:()=>p.Iz,SubDocument:()=>b.I3,TenantContextHolder:()=>b.SB,TileGroup:()=>b.iS,UpdateAnnotationMetaDataOperation:()=>y.XP,UpdateOperation:()=>y.fZ,UserCommand:()=>m,UserCommandsHolder:()=>b.QG,UserContextHolder:()=>b.hD,VisibilityOperation:()=>y.mX,WorkflowActivationFailureDetails:()=>S.W8,WorkflowExecutionErrorCode:()=>c,WorkflowNotActivatedReasonCode:()=>u,ecsMetadataBlockHeight:()=>h.Xo,ecsMetadataBlockWidth:()=>h.KY});var o,r,s,i,a,l=n(87214);!function(e){e[e.Unknown=0]="Unknown",e[e.CopilotInM365=1]="CopilotInM365",e[e.CopilotPro=2]="CopilotPro",e[e.CopilotEnterprise=3]="CopilotEnterprise"}(o||(o={})),function(e){e.Unknown="Unknown",e.Canvas="Canvas",e.CopilotChat="CopilotChat",e.Test="Test"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Added=1]="Added",e[e.Updated=2]="Updated",e[e.Deleted=3]="Deleted"}(s||(s={})),function(e){e[e.ContentChanged=0]="ContentChanged",e[e.ContentWasEmpty=1]="ContentWasEmpty",e[e.FormattingChanged=2]="FormattingChanged",e[e.ContentWasInsideOfTheTable=3]="ContentWasInsideOfTheTable"}(i||(i={})),function(e){e[e.AddOfZeroElements=0]="AddOfZeroElements",e[e.AddOfItemsWithExtraOrMissingIds=1]="AddOfItemsWithExtraOrMissingIds",e[e.AddOfItemWithUndefinedId=2]="AddOfItemWithUndefinedId",e[e.AddOfUndefinedItem=3]="AddOfUndefinedItem",e[e.AddOfItemsWithDuplicateIds=4]="AddOfItemsWithDuplicateIds",e[e.SetHeadToNonExistingItem=5]="SetHeadToNonExistingItem",e[e.DeleteOfNonExistingItem=6]="DeleteOfNonExistingItem",e[e.UpdateOfNonExistentItem=7]="UpdateOfNonExistentItem",e[e.UpdateOfStubbedItem=8]="UpdateOfStubbedItem",e[e.MoveOfNonExistentItem=9]="MoveOfNonExistentItem",e[e.UpdateMetaDataOfNonAnnotationType=10]="UpdateMetaDataOfNonAnnotationType",e[e.SequentialyInvertedUpdate=11]="SequentialyInvertedUpdate",e[e.MoveToTheSamePath=12]="MoveToTheSamePath",e[e.UnknownOperation=13]="UnknownOperation",e[e.DeltaOfNonExistingItem=100]="DeltaOfNonExistingItem"}(a||(a={}));var c,u,d,h=n(50605);!function(e){e[e.LambdaExecutionUnhandledError=0]="LambdaExecutionUnhandledError",e[e.LambdaExecutionError=1]="LambdaExecutionError",e[e.WorkflowExecutionTimeout=2]="WorkflowExecutionTimeout",e[e.NetworkError=3]="NetworkError",e[e.SignalNotGotToExecution=4]="SignalNotGotToExecution",e[e.RequestTruncated=5]="RequestTruncated",e[e.WorkflowWrongAnnotationType=6]="WorkflowWrongAnnotationType",e[e.SequenceOutOfOrder=7]="SequenceOutOfOrder",e[e.WorkflowExecutionThrottled=8]="WorkflowExecutionThrottled",e[e.WorkflowExecutionCancelled=9]="WorkflowExecutionCancelled",e[e.NetworkTimeoutOrWorkflowIsBusy=10]="NetworkTimeoutOrWorkflowIsBusy",e[e.RequiredTokenNotAvailable=11]="RequiredTokenNotAvailable",e[e.InvalidInputQuantityForSingleItemWorkflow=12]="InvalidInputQuantityForSingleItemWorkflow",e[e.ExceededRequestSizeLimit=13]="ExceededRequestSizeLimit",e[e.UnknownAnnotationParent=14]="UnknownAnnotationParent",e[e.AnnotationsNotArray=15]="AnnotationsNotArray",e[e.UnexpectedOutput=16]="UnexpectedOutput",e[e.MixedOutput=17]="MixedOutput",e[e.OutputIsNotAnnotation=18]="OutputIsNotAnnotation",e[e.UnexpectedError=19]="UnexpectedError",e[e.WorkflowNotActivated=20]="WorkflowNotActivated"}(c||(c={})),function(e){e[e.Unknown=0]="Unknown",e[e.AuthTokenIsMissing=1]="AuthTokenIsMissing",e[e.UserContextIsMissing=2]="UserContextIsMissing",e[e.SeedingNotCompleted=3]="SeedingNotCompleted"}(u||(u={})),function(e){e.Unknown="Unknown",e.Testing="Testing",e.CopilotSummary="Copilot Summary",e.CopilotCompose="Copilot Compose",e.Rewrite="Copilot Rewrite",e.ChatQnA="Copilot Chat Question & Answer",e.CIQ="Context IQ",e.Editor="Editor",e.Handoff="Handoff",e.ReadAloud="Read Aloud"}(d||(d={}));var p=n(44319),f=n(66300);class g{constructor(e){f.h.assign(g,this,e)}static getTypeName(){return"AugLoop_Core_Event"}static getBaseTypes(){return[]}static typeGuard(e){return f.h.matchesTypesFor(e,[g.getTypeName()])}}g.H_={T_:g.getTypeName(),B_:g.getBaseTypes()};class m{constructor(e){f.h.assign(m,this,e)}static getTypeName(){return"AugLoop_Core_UserCommand"}static getBaseTypes(){return["AugLoop_Core_Event"]}static typeGuard(e){return f.h.matchesTypesFor(e,[m.getTypeName()])}}m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};var y=n(47401),v=n(96708),b=n(65512),S=n(26850)},50605:(e,t,n)=>{"use strict";n.d(t,{J1:()=>s,KY:()=>r,Xo:()=>o,h6:()=>i,u5:()=>a});const o=512,r=32;var s,i;!function(e){e[e.None=0]="None",e[e.HttpsGetDownloadUrl=1]="HttpsGetDownloadUrl",e[e.AlCodedLocation=2]="AlCodedLocation",e[e.Token=3]="Token",e[e.SpeAlCodedLocation=4]="SpeAlCodedLocation"}(s||(s={})),function(e){e[e.NewDocument=0]="NewDocument",e[e.EditDocument=1]="EditDocument",e[e.ViewOnlyDocument=2]="ViewOnlyDocument"}(i||(i={}));class a{}a.lowerIndexBound=1,a.maxNumberOfRows=1048576,a.maxNumberOfColumns=16384,a.firstColumnName="A",a.lastColumnName="XFD"},35859:(e,t,n)=>{"use strict";var o,r,s,i,a,l;n.d(t,{Ih:()=>o,bt:()=>r,hO:()=>i,pL:()=>s,uR:()=>a,wk:()=>l}),function(e){e.Persistent="Persistent",e.Discardable="Discardable"}(o||(o={})),function(e){e.NONE="none",e.BLANK="blankDocument",e.PARAGRAPH="paragraph",e.LIST="list",e.TABLE="table",e.WHATCANISAY="whatCanISay"}(r||(r={})),function(e){e.Final="Final",e.Fragment="Fragment",e.Hypothesis="Hypothesis"}(s||(s={})),function(e){e.Paragraph="paragraph",e.Sentence="sentence",e.Character="character",e.Word="word",e.That="that",e.This="this",e.Table="table",e.Row="row",e.Column="column",e.Cell="cell",e.Page="page",e.Bullet="bullet",e.To="to",e.Bcc="bcc",e.Cc="cc",e.Subject="subject",e.EmailBody="emailBody",e.Field="field",e.All="all"}(i||(i={})),function(e){e.Next="next",e.Last="last",e.Previous="previous",e.Current="current",e.Left="left",e.Right="right",e.Above="above",e.Below="below",e.Start="start",e.End="end",e.Up="up",e.Down="down",e.Before="before",e.After="after",e.Beginning="start"}(a||(a={})),function(e){e.Play="play",e.Pause="pause",e.Resume="resume"}(l||(l={}))},72514:(e,t,n)=>{"use strict";var o,r,s,i,a,l;n.d(t,{$O:()=>s,El:()=>a,Y3:()=>o,o2:()=>r,sP:()=>l,wM:()=>i}),function(e){e.UNKNOWN="Unknown",e.CONNECTION_RETRY="ConnectionRetry",e.CONNECTION_RETRY_FAILURE="ErrorConnectionRetryFailure",e.SPEECH_HANDLER_WS_FAILURE="ErrorSpeechHandlerWebSocketFailure",e.PROTOBUF_DESERIALIZATION_FAILURE="ErrorProtobufDeserializationFailure",e.EXPLICITLY_DISABLED="ExplicitlyDisabled",e.SPEECH_RECOGNITION_CANCELED="ErrorSpeechRecognitionCanceled"}(o||(o={})),function(e){e.INTERMITTENT="Intermittent",e.FINAL="Final"}(r||(r={})),function(e){e.NO_DICTATION="NoDictation",e.NO_COMMANDING="NoCommanding",e.NO_TOKEN="NoPfaToken"}(s||(s={})),function(e){e.version1="1",e.version2="2"}(i||(i={})),function(e){e[e.NoMatch=0]="NoMatch"}(a||(a={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.UNSUPPORTED_FILE_FORMAT="UNSUPPORTED_FILE_FORMAT",e.UPLOADING="UPLOADING",e.PROCESSING="PROCESSING",e.DELETED="DELETED",e.FILE_NOT_EXIST="FILE_NOT_EXIST",e.FILE_DECODE_ERROR="FILE_DECODE_ERROR",e.REQUEST_TIMEOUT_ERROR="REQUEST_TIMEOUT_ERROR"}(l||(l={}))},3316:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var o=function(){function e(e){this.mergeDictationSettings(e)}return e.prototype.mergeDictationSettings=function(e){var t=this;Object.keys(e).forEach((function(n){t[n]=e[n]}))},e}(),r=function(){function e(){}return Object.defineProperty(e,"dictationSettings",{get:function(){if(e._instance)return e._instance;throw new Error("Dictation Settings not initialized")},set:function(t){e._instance?e._instance.mergeDictationSettings(t):e._instance=new o(t)},enumerable:!1,configurable:!0}),e}()},69382:(e,t,n)=>{"use strict";n.d(t,{Cd:()=>d,LT:()=>a,VJ:()=>s,dn:()=>u,mZ:()=>r,oS:()=>i,pn:()=>l,z4:()=>h,zc:()=>c});var o=n(66300),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),s=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultV2"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandInternalResult"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandResult","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandResultsInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionInternalSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceDictationSessionInitiatedSignal"},e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BaseVoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),d=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestion"},e.getBaseTypes=function(){return["AugLoop_Voice_BaseVoiceCommandSuggestion","AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),h=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandSuggestionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},76483:(e,t,n)=>{"use strict";n.d(t,{Al:()=>u,D_:()=>l,KI:()=>h,Pm:()=>a,U1:()=>d,ZF:()=>s,_K:()=>c,lM:()=>i,mh:()=>r});var o=n(66300),r=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextFinalResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),s=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechToTextPartialResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechErrorEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceCommandRequest"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechSessionEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),c=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_SpeechQualityEvent"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyOutput"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),d=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),h=function(){function e(t){o.h.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Voice_RehearsalRealTimeResult"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},15372:(e,t,n)=>{"use strict";n.d(t,{IQ:()=>s,Qu:()=>l,VR:()=>a,jP:()=>i,nO:()=>r});var o=n(66300),r=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceBlobContent"},e.getBaseTypes=function(){return["AugLoop_Core_Blob"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),s=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceBlobTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),i=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceTile"},e.getBaseTypes=function(){return["AugLoop_Core_Binary"]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),a=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceLatencyInput"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),l=function(){function e(t){o.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_BatchTranscriptionConversation"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return o.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}()},71711:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AudioMode:()=>h.wk,BaseVoiceCommandResult:()=>p.mZ,BaseVoiceCommandSuggestion:()=>p.dn,BatchTranscriptionConversation:()=>u.Qu,BatchTranscriptionErrorCode:()=>r.sP,BatchTranscriptionResult:()=>a.U1,BatchWorkflowStage:()=>o.Cu,ClientApp:()=>o.jr,CommandSuggestionContextType:()=>h.bt,CommandSuggestionDisplayType:()=>h.Ih,DictationEventsType:()=>d.Ff,DictationSettingsManager:()=>s.A,IEventName:()=>o.$O,ISpeechError:()=>o.IZ,QualityStatusCode:()=>o.ZE,RehearsalRealTimeResult:()=>a.KI,SelectionType:()=>h.hO,SelectionWhich:()=>h.uR,SpeechErrorEvent:()=>a.lM,SpeechErrorEventCode:()=>r.Y3,SpeechErrorEventImpact:()=>r.$O,SpeechErrorEventState:()=>r.o2,SpeechQualityEvent:()=>a._K,SpeechSessionEvent:()=>a.D_,SpeechSessionEventIds:()=>d.P_,SpeechToTextFinalResult:()=>a.mh,SpeechToTextPartialResult:()=>a.ZF,SpeechToTextProfile:()=>i.A,TraceLevel:()=>o.kp,TranscriberType:()=>i.y,UtteranceRecognitionType:()=>h.pL,VoiceBlobContent:()=>u.nO,VoiceBlobTile:()=>u.IQ,VoiceCommandError:()=>r.El,VoiceCommandInternalResult:()=>p.oS,VoiceCommandRequest:()=>a.Pm,VoiceCommandResultV2:()=>p.VJ,VoiceCommandResultsInternalSignal:()=>p.LT,VoiceCommandSuggestion:()=>p.Cd,VoiceCommandSuggestionInternalSignal:()=>p.pn,VoiceCommandSuggestionResult:()=>p.z4,VoiceDictationSessionInitiatedSignal:()=>p.zc,VoiceLatencyInput:()=>u.VR,VoiceLatencyOutput:()=>a.Al,VoiceOperation:()=>c,VoiceResponseVersion:()=>r.wM,VoiceTile:()=>u.jP,WordVoiceCommandIds:()=>d.oJ,WordVoiceCommandValueKeys:()=>d.n4,internalCommandIds:()=>d.XH});var o=n(57144),r=n(72514),s=n(3316),i=n(90913),a=n(76483),l=n(66300),c=function(){function e(t){l.h.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Voice_VoiceOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return l.h.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}(),u=n(15372),d=n(21965),h=n(35859),p=n(69382)},57144:(e,t,n)=>{"use strict";var o,r,s,i,a,l,c;n.d(t,{$O:()=>a,Cu:()=>r,IZ:()=>i,ZE:()=>l,jr:()=>s,kp:()=>o}),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={})),function(e){e.AnalyzeAudio="AnalyzeAudio",e.GetBatchResult="GetBatchResult"}(r||(r={})),function(e){e[e.PowerPoint=0]="PowerPoint",e[e.Word=1]="Word",e[e.OneNote=2]="OneNote",e[e.Outlook=3]="Outlook",e[e.Unknown=4]="Unknown",e[e.LinkedIn=5]="LinkedIn",e[e.Flipgrid=6]="Flipgrid",e[e.OfficeMobie=7]="OfficeMobie",e[e.OfficeSuite=8]="OfficeSuite",e[e.Teams=9]="Teams"}(s||(s={})),function(e){e.ErrorNone="ErrorNone",e.ErrorInvalidSubscriptionFromConfig="ErrorInvalidSubscriptionFromConfig",e.ErrorInvalidRegionFromConfig="ErrorInvalidRegionFromConfig",e.ErrorAddSessionFailure="ErrorAddSessionFailure",e.ErrorCreateSpeechSessionBadRequest="ErrorCreateSpeechSessionBadRequest",e.ErrorSpeechHandlerWebSocketFailure="ErrorSpeechHandlerWebSocketFailure",e.ErrorInvalidMessage="ErrorInvalidMessage",e.ErrorWaitAudioTimeout="ErrorWaitAudioTimeout",e.ErrorInitialSilenceTimeout="ErrorInitialSilenceTimeout",e.ErrorInitialBabbleTimeout="ErrorInitialBabbleTimeout",e.ErrorProtobufDeserializationFailure="ErrorProtobufDeserializationFailure",e.ErrorSpeechRecognitionFailure="ErrorSpeechRecognitionFailure",e.ErrorTranslationFailure="ErrorTranslationFailure",e.ErrorFailedToGetSupportedTextLanguages="ErrorFailedToGetSupportedTextLanguages",e.ErrorCustomEndpointTimeout="ErrorCustomEndpointTimeout",e.ErrorAudioAbortError="ErrorAudioAbortError",e.ErrorAudioNotAllowedError="ErrorAudioNotAllowedError",e.ErrorAudioNotFoundError="ErrorAudioNotFoundError",e.ErrorAudioNotReadableError="ErrorAudioNotReadableError",e.ErrorAudioOverconstrainedError="ErrorAudioOverconstrainedError",e.ErrorAudioSecurityError="ErrorAudioSecurityError",e.ErrorAudioTypeError="ErrorAudioTypeError",e.ErrorAudioSetupFailure="ErrorAudioSetupFailure",e.ErrorAudioCaptureStalePermission="ErrorAudioCaptureStalePermission",e.ErrorConnectionRetryFailure="ErrorConnectionRetryFailure",e.ErrorWebcamSamplingUnsupportedSpeechMode="ErrorWebcamSamplingUnsupportedSpeechMode",e.ErrorWebcamSetupFailure="ErrorWebcamSetupFailure",e.ErrorWebcamNotFoundError="ErrorWebcamNotFoundError",e.ErrorMultipleWebcamsFound="ErrorMultipleWebcamsFound",e.ErrorMaxConnectionRetryFailureInSession="ErrorMaxConnectionRetryFailureInSession",e.ErrorUnknown="ErrorUnknown"}(i||(i={})),function(e){e.RehearsalDashboardUpdate="RehearsalDashboardUpdate",e.MediaEvent="MediaEvent",e.QualityStatusUpdate="QualityStatusUpdate",e.ConnectionRetry="ConnectionRetry"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Listening=1]="Listening",e[e.Warning_CannotHearYou=2]="Warning_CannotHearYou",e[e.Warning_BackgroundNoise=3]="Warning_BackgroundNoise",e[e.Warning_TooLoud=4]="Warning_TooLoud",e[e.Warning_TooQuiet=5]="Warning_TooQuiet",e[e.Warning_WeakConnection=6]="Warning_WeakConnection",e[e.Warning_SlowConnection=7]="Warning_SlowConnection",e[e.Warning_UnstableConnection=8]="Warning_UnstableConnection",e[e.Warning_ServiceIssue=9]="Warning_ServiceIssue",e[e.Error_CannotHearYou=10]="Error_CannotHearYou",e[e.Error_BackgroundNoise=11]="Error_BackgroundNoise",e[e.Error_TooLoud=12]="Error_TooLoud",e[e.Error_TooQuiet=13]="Error_TooQuiet",e[e.Error_WeakConnection=14]="Error_WeakConnection",e[e.Error_SlowConnection=15]="Error_SlowConnection",e[e.Error_UnstableConnection=16]="Error_UnstableConnection",e[e.Error_ServiceIssue=17]="Error_ServiceIssue"}(l||(l={})),function(e){e.Closed="Closed",e.Closing="Closing",e.Connecting="Connecting",e.Open="Open"}(c||(c={}))},90913:(e,t,n)=>{"use strict";var o,r;n.d(t,{A:()=>o,y:()=>r}),function(e){e.Dictation="Dictation",e.Transcription="Transcription",e.ConversationTranscription="ConversationTranscription",e.Rehearsal="Rehearsal",e.Subtitle="Subtitle",e.AdHocRehearsal="AdHocRehearsal"}(o||(o={})),function(e){e.Ovfd="Ovfd",e.Cts="Cts",e.Fast="Fast"}(r||(r={}))},21965:(e,t,n)=>{"use strict";var o;n.d(t,{Ff:()=>i,P_:()=>s,XH:()=>a,n4:()=>r,oJ:()=>o}),function(e){e.Bold="Word.Editing.Bold",e.CenterJustify="Word.Editing.CenterJustify",e.CreateBulletList="Word.Editing.CreateBulletList",e.CreateNumberedList="Word.Editing.CreateNumberedList",e.Delete="Word.Editing.Delete",e.Deselect="Word.Editing.Deselect",e.Exit="Command.Exit",e.ExitList="Word.Editing.ExitList",e.FullJustify="Word.Editing.FullJustify",e.Highlight="Word.Editing.Highlight",e.SetFont="Word.Editing.SetFont",e.InsertText="Word.Editing.InsertText",e.InsertBullet="Word.Editing.InsertBullet",e.InsertComment="Word.Editing.InsertComment",e.InsertEmoji="Word.Editing.InsertEmoji",e.InsertTable="Word.Editing.Table.Insert",e.DeleteTable="Word.Editing.Table.Delete",e.NavigateTable="Word.Editing.Table.Navigate",e.Navigation="Word.Editing.Navigation",e.InsertSpace="Word.Editing.InsertSpace",e.Italics="Word.Editing.Italics",e.LeftJustify="Word.Editing.LeftJustify",e.NewLine="Word.Editing.NewLine",e.NextBullet="Word.Editing.NextBullet",e.NextLine="Word.Editing.NextLine",e.Pause="Command.Pause",e.Paste="Word.Editing.Paste",e.ReadBack="Word.Editing.ReadBack",e.Redo="Word.Editing.Redo",e.RightJustify="Word.Editing.RightJustify",e.RemoveBold="Word.Editing.RemoveBold",e.RemoveItalics="Word.Editing.RemoveItalics",e.RemoveUnderline="Word.Editing.RemoveUnderline",e.RemoveHighlight="Word.Editing.RemoveHighlight",e.RemoveSuperscript="Word.Editing.RemoveSuperscript",e.RemoveStrikeThrough="Word.Editing.RemoveStrikeThrough",e.RemoveSubscript="Word.Editing.RemoveSubscript",e.RemoveFormatting="Word.Editing.RemoveFormatting",e.Quote="Word.Editing.Quote",e.Select="Word.Editing.Select",e.Superscript="Word.Editing.Superscript",e.Subscript="Word.Editing.Subscript",e.StrikeThrough="Word.Editing.StrikeThrough",e.ShowHelp="Command.ShowHelp",e.ShowCommands="Command.ShowCommand",e.Undo="Word.Editing.Undo",e.Underline="Word.Editing.Underline",e.IncreaseIndent="Word.Editing.IncreaseIndent",e.DecreaseIndent="Word.Editing.DecreaseIndent",e.Backspace="Word.Editing.Backspace",e.VoiceCommand="Command.VoiceCommand",e.Type="Command.Type",e.ShrinkFont="Word.Editing.ShrinkFont",e.GrowFont="Word.Editing.GrowFont",e.AllCaps="Word.Editing.AllCaps",e.SentenceCase="Word.Editing.SentenceCase",e.LowerCase="Word.Editing.LowerCase",e.Tab="Word.Editing.Tab",e.ZoomOut="Word.View.ZoomOut",e.ZoomIn="Word.View.ZoomIn",e.ScrollUp="Word.View.ScrollUp",e.ScrollDown="Word.View.ScrollDown",e.ShowOutline="Word.View.ShowOutline",e.PageBreak="Word.Editing.PageBreak",e.ResumeDictation="Word.Editing.ResumeDictation",e.Correction="Word.Editing.Correction",e.Style="Word.Editing.Style",e.CorrectionOption="Word.Editing.CorrectionOption",e.SpellOut="Word.Editing.SpellOut",e.ShowSuggestions="Word.Editing.ShowSuggestions",e.Send="Outlook.Send",e.Cancel="Outlook.Cancel",e.Yes="Outlook.Yes",e.AddRecipient="Outlook.AddRecipient",e.AtMention="Outlook.AtMention",e.FieldEdit="Outlook.FieldEdit",e.MoonshotAbout="Annotation.Document.About",e.MoonshotReadFromBeginning="Annotation.Document.FromBeginning",e.MoonshotKeyPoints="Annotation.Document.KeyPoints",e.MoonshotOutline="Annotation.Document.Outline",e.MoonshotReadInFull="Annotation.Document.ReadInFull",e.MoonshotSummarize="Annotation.Document.Summary",e.MoonshotMicrophoneOff="Audio.MicrophoneOff",e.MoonshotPause="Audio.Pause",e.MoonshotPlay="Audio.Play",e.MoonshotReplay="Audio.Replay",e.MoonshotSlowDown="Audio.SlowDown",e.MoonshotSpeedUp="Audio.SpeedUp",e.MoonshotReadSection="Document.Action.ReadSection",e.MoonshotRepeat="Document.Action.Repeat",e.MoonshotReview="Document.Action.Review",e.MoonshotDocumentAge="Document.Metadata.Age",e.MoonshotDocumentAuthor="Document.Metadata.Author",e.MoonshotDocumentHits="Document.Metadata.Hits",e.MoonshotDocumentLength="Document.Metadata.Length",e.MoonshotDocumentPreview="Document.Metadata.Preview",e.MoonshotDocumentTitle="Document.Metadata.Title",e.MoonshotNo="General.No",e.MoonshotYes="General.Yes",e.MoonshotIntro="intro",e.MoonshotNextDocument="Navigate.Document.Next",e.MoonshotPreviousDocument="Navigate.Document.Previous",e.ExcelIntent="ExcelIntent",e.InternalReadBack="Internal.Word.Editing.ReadBack",e.NoOp="NoOp"}(o||(o={}));var r,s,i,a=new Set([o.InternalReadBack]);!function(e){e.TableColumns="Word.Editing.InsertTable.TableColumns",e.TableRows="Word.Editing.InsertTable.TableRows",e.SelectionType="Word.Editing.ActOnSelection.SelectionType"}(r||(r={})),function(e){e.SpeechRecognitionStarted="SpeechRecognitionStarted",e.SpeechRecognitionStopped="SpeechRecognitionStopped",e.SpeechSessionStarted="SpeechSessionStarted",e.SpeechSessionStopped="SpeechSessionStopped"}(s||(s={})),function(e){e.MicrophoneError="ErrorAudioCaptureAsync"}(i||(i={}))},14101:(e,t,n)=>{"use strict";n.d(t,{fi:()=>s,PS:()=>a,J4:()=>i,e7:()=>l,F4:()=>g,H$:()=>f,vk:()=>_,xe:()=>m,H7:()=>w,Om:()=>u,Jq:()=>c,Yz:()=>S,QW:()=>b,Ee:()=>v,tF:()=>h,QM:()=>d,yw:()=>y,ZJ:()=>p});var o=n(37135);const r={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,DaysInOneWeek:7,MonthInOneYear:12};function s(e,t){var n=new Date(e.getTime());return n.setDate(n.getDate()+t),n}function i(e,t){return s(e,t*r.DaysInOneWeek)}function a(e,t){var n=new Date(e.getTime()),o=n.getMonth()+t;return n.setMonth(o),n.getMonth()!==(o%r.MonthInOneYear+r.MonthInOneYear)%r.MonthInOneYear&&(n=s(n,-n.getDate())),n}function l(e,t){var n=new Date(e.getTime());return n.setFullYear(e.getFullYear()+t),n.getMonth()!==(e.getMonth()%r.MonthInOneYear+r.MonthInOneYear)%r.MonthInOneYear&&(n=s(n,-n.getDate())),n}function c(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)}function u(e){return new Date(e.getFullYear(),e.getMonth()+1,0,0,0,0,0)}function d(e){return new Date(e.getFullYear(),0,1,0,0,0,0)}function h(e){return new Date(e.getFullYear()+1,0,0,0,0,0,0)}function p(e,t){return a(e,t-e.getMonth())}function f(e,t){return!e&&!t||!(!e||!t)&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function g(e,t){return _(e)-_(t)}function m(e,t,n,i,l){void 0===l&&(l=1);var c,u=new Array,d=null;switch(i||(i=[o.ob.Monday,o.ob.Tuesday,o.ob.Wednesday,o.ob.Thursday,o.ob.Friday]),l=Math.max(l,1),t){case o.ci.Day:d=s(c=T(e),l);break;case o.ci.Week:case o.ci.WorkWeek:d=s(c=S(T(e),n),r.DaysInOneWeek);break;case o.ci.Month:d=a(c=new Date(e.getFullYear(),e.getMonth(),1),1);break;default:throw new Error("Unexpected object: "+t)}var h=c;do{(t!==o.ci.WorkWeek||-1!==i.indexOf(h.getDay()))&&u.push(h),h=s(h,1)}while(!f(h,d));return u}function y(e,t){for(var n=0,o=t;n<o.length;n++)if(f(e,o[n]))return!0;return!1}function v(e,t,n,s){var i=s.getFullYear(),a=s.getMonth(),l=1,c=new Date(i,a,l),u=l+(t+r.DaysInOneWeek-1)-function(e,t){return e!==o.ob.Sunday&&t<e?t+r.DaysInOneWeek:t}(t,c.getDay()),d=new Date(i,a,u);l=d.getDate();for(var h=[],p=0;p<e;p++)h.push(b(d,t,n)),l+=r.DaysInOneWeek,d=new Date(i,a,l);return h}function b(e,t,n){switch(n){case o.zX.FirstFullWeek:return C(e,t,r.DaysInOneWeek);case o.zX.FirstFourDayWeek:return C(e,t,4);default:return function(e,t){var n=k(e)-1,o=(e.getDay()-n%r.DaysInOneWeek-t+2*r.DaysInOneWeek)%r.DaysInOneWeek;return Math.floor((n+o)/r.DaysInOneWeek+1)}(e,t)}}function S(e,t){var n=t-e.getDay();return n>0&&(n-=r.DaysInOneWeek),s(e,n)}function w(e,t){var n=(t-1>=0?t-1:r.DaysInOneWeek-1)-e.getDay();return n<0&&(n+=r.DaysInOneWeek),s(e,n)}function T(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function _(e){return e.getDate()+(e.getMonth()<<5)+(e.getFullYear()<<9)}function C(e,t,n){var s=k(e)-1,i=e.getDay()-s%r.DaysInOneWeek,a=k(new Date(e.getFullYear()-1,o.Ph.December,31))-1,l=(t-i+2*r.DaysInOneWeek)%r.DaysInOneWeek;0!==l&&l>=n&&(l-=r.DaysInOneWeek);var c=s-l;return c<0&&(0!=(l=(t-(i-=a%r.DaysInOneWeek)+2*r.DaysInOneWeek)%r.DaysInOneWeek)&&l+1>=n&&(l-=r.DaysInOneWeek),c=a-l),Math.floor(c/r.DaysInOneWeek+1)}function k(e){for(var t=e.getMonth(),n=e.getFullYear(),o=0,r=0;r<t;r++)o+=E(r+1,n);return o+e.getDate()}function E(e,t){return new Date(t,e,0).getDate()}},37135:(e,t,n)=>{"use strict";var o,r,s,i;n.d(t,{Ph:()=>r,ci:()=>i,f9:()=>a,ob:()=>o,zX:()=>s}),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(o||(o={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(r||(r={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(s||(s={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(i||(i={}));var a=7},41602:(e,t,n)=>{"use strict";n.d(t,{s:()=>r});var o=n(93483);function r(e,t,n){void 0===n&&(n=!0);var r=!1;if(e&&t)if(n)if(e===t)r=!0;else for(r=!1;t;){var s=(0,o.P)(t);if(s===e){r=!0;break}t=s}else e.contains&&(r=e.contains(t));return r}},60552:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var o=n(88948);function r(e,t){var n=(0,o.w)(e,(function(e){return e.hasAttribute(t)}));return n&&n.getAttribute(t)}},88948:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var o=n(93483);function r(e,t){return e&&e!==document.body?t(e)?e:r((0,o.P)(e),t):null}},93483:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var o=n(72148);function r(e,t){return void 0===t&&(t=!0),e&&(t&&(0,o.c)(e)||e.parentNode&&e.parentNode)}},72148:(e,t,n)=>{"use strict";n.d(t,{c:()=>r});var o=n(80566);function r(e){var t;return e&&(0,o.q)(e)&&(t=e._virtual.parent),t}},80566:(e,t,n)=>{"use strict";function o(e){return e&&!!e._virtual}n.d(t,{q:()=>o})},15846:(e,t,n)=>{"use strict";n.d(t,{s:()=>s});var o=n(88948),r=n(7821);function s(e,t){var n=(0,o.w)(e,(function(e){return t===e||e.hasAttribute(r.r)}));return null!==n&&n.hasAttribute(r.r)}},7821:(e,t,n)=>{"use strict";n.d(t,{V:()=>r,r:()=>o});var o="data-portal-element";function r(e){e.setAttribute(o,"true")}},97672:(e,t,n)=>{"use strict";function o(e,t){var n=e,o=t;n._virtual||(n._virtual={children:[]});var r=n._virtual.parent;if(r&&r!==t){var s=r._virtual.children.indexOf(n);s>-1&&r._virtual.children.splice(s,1)}n._virtual.parent=o||void 0,o&&(o._virtual||(o._virtual={children:[]}),o._virtual.children.push(n))}n.d(t,{g:()=>o})},41622:(e,t,n)=>{"use strict";n.d(t,{R:()=>N});var o,r=n(98670),s=n(26166),i=n(16536),a=n(68761),l=n(60525),c=n(54212),u=n(93483),d=n(40245),h=n(87018),p=n(19328),f=n(6105),g=n(36151),m=n(76671),y=n(44395),v=n(41602),b=n(44591),S=n(15846),w=n(57622),T=n(68529),_="data-is-focusable",C="data-focuszone-id",k="tabindex",E="data-no-vertical-wrap",A="data-no-horizontal-wrap",I=999999999,P=-999999999;function M(e,t){var n,o,r,s,i,a,l;"function"==typeof MouseEvent?l=new MouseEvent("click",{ctrlKey:null===(n=t)||void 0===n?void 0:n.ctrlKey,metaKey:null===(o=t)||void 0===o?void 0:o.metaKey,shiftKey:null===(r=t)||void 0===r?void 0:r.shiftKey,altKey:null===(s=t)||void 0===s?void 0:s.altKey,bubbles:null===(i=t)||void 0===i?void 0:i.bubbles,cancelable:null===(a=t)||void 0===a?void 0:a.cancelable}):(l=document.createEvent("MouseEvents")).initMouseEvent("click",!!t&&t.bubbles,!!t&&t.cancelable,window,0,0,0,0,0,!!t&&t.ctrlKey,!!t&&t.altKey,!!t&&t.shiftKey,!!t&&t.metaKey,0,null),e.dispatchEvent(l)}var x={},R=new Set,D=["text","number","password","email","tel","url","search"],O=!1,N=function(e){function t(t){var n=e.call(this,t)||this;return n._root=s.createRef(),n._mergedRef=(0,l.K)(),n._onFocus=function(e){if(!n._portalContainsElement(e.target)){var t,o=n.props,r=o.onActiveElementChanged,s=o.doNotAllowFocusEventToPropagate,i=o.stopFocusPropagation,a=o.onFocusNotification,l=o.onFocus,d=o.shouldFocusInnerElementWhenReceivedFocus,h=o.defaultTabbableElement,p=n._isImmediateDescendantOfZone(e.target);if(p)t=e.target;else for(var f=e.target;f&&f!==n._root.current;){if((0,c.S0)(f)&&n._isImmediateDescendantOfZone(f)){t=f;break}f=(0,u.P)(f,O)}if(d&&e.target===n._root.current){var g=h&&"function"==typeof h&&h(n._root.current);g&&(0,c.S0)(g)?(t=g,g.focus()):(n.focus(!0),n._activeElement&&(t=null))}var m=!n._activeElement;t&&t!==n._activeElement&&((p||m)&&n._setFocusAlignment(t,!0,!0),n._activeElement=t,m&&n._updateTabIndexes()),r&&r(n._activeElement,e),(i||s)&&e.stopPropagation(),l?l(e):a&&a()}},n._onBlur=function(){n._setParkedFocus(!1)},n._onMouseDown=function(e){if(!n._portalContainsElement(e.target)&&!n.props.disabled){for(var t=e.target,o=[];t&&t!==n._root.current;)o.push(t),t=(0,u.P)(t,O);for(;o.length&&((t=o.pop())&&(0,c.S0)(t)&&n._setActiveElement(t,!0),!(0,c.HC)(t)););}},n._onKeyDown=function(e,t){if(!n._portalContainsElement(e.target)){var o=n.props,r=o.direction,s=o.disabled,i=o.isInnerZoneKeystroke,a=o.pagingSupportDisabled,l=o.shouldEnterInnerZone;if(!(s||(n.props.onKeyDown&&n.props.onKeyDown(e),e.isDefaultPrevented()||n._getDocument().activeElement===n._root.current&&n._isInnerZone))){if((l&&l(e)||i&&i(e))&&n._isImmediateDescendantOfZone(e.target)){var u=n._getFirstInnerZone();if(u){if(!u.focus(!0))return}else{if(!(0,c.Z5)(e.target))return;if(!n.focusElement((0,c.eX)(e.target,e.target.firstChild,!0)))return}}else{if(e.altKey)return;switch(e.which){case d.c.space:if(n._tryInvokeClickForFocusable(e.target,e))break;return;case d.c.left:if(r!==T.E.vertical&&(n._preventDefaultWhenHandled(e),n._moveFocusLeft(t)))break;return;case d.c.right:if(r!==T.E.vertical&&(n._preventDefaultWhenHandled(e),n._moveFocusRight(t)))break;return;case d.c.up:if(r!==T.E.horizontal&&(n._preventDefaultWhenHandled(e),n._moveFocusUp()))break;return;case d.c.down:if(r!==T.E.horizontal&&(n._preventDefaultWhenHandled(e),n._moveFocusDown()))break;return;case d.c.pageDown:if(!a&&n._moveFocusPaging(!0))break;return;case d.c.pageUp:if(!a&&n._moveFocusPaging(!1))break;return;case d.c.tab:if(n.props.allowTabKey||n.props.handleTabKey===T.l.all||n.props.handleTabKey===T.l.inputOnly&&n._isElementInput(e.target)){var p=!1;if(n._processingTabKey=!0,p=r!==T.E.vertical&&n._shouldWrapFocus(n._activeElement,A)?((0,h.jI)(t)?!e.shiftKey:e.shiftKey)?n._moveFocusLeft(t):n._moveFocusRight(t):e.shiftKey?n._moveFocusUp():n._moveFocusDown(),n._processingTabKey=!1,p)break;n.props.shouldResetActiveElementWhenTabFromZone&&(n._activeElement=null)}return;case d.c.home:if(n._isContentEditableElement(e.target)||n._isElementInput(e.target)&&!n._shouldInputLoseFocus(e.target,!1))return!1;var f=n._root.current&&n._root.current.firstChild;if(n._root.current&&f&&n.focusElement((0,c.eX)(n._root.current,f,!0)))break;return;case d.c.end:if(n._isContentEditableElement(e.target)||n._isElementInput(e.target)&&!n._shouldInputLoseFocus(e.target,!0))return!1;var g=n._root.current&&n._root.current.lastChild;if(n._root.current&&n.focusElement((0,c.yv)(n._root.current,g,!0,!0,!0)))break;return;case d.c.enter:if(n._tryInvokeClickForFocusable(e.target,e))break;return;default:return}}e.preventDefault(),e.stopPropagation()}}},n._getHorizontalDistanceFromCenter=function(e,t,o){var r=n._focusAlignment.left||n._focusAlignment.x||0,s=Math.floor(o.top),i=Math.floor(t.bottom),a=Math.floor(o.bottom),l=Math.floor(t.top);return e&&s>i||!e&&a<l?r>=o.left&&r<=o.left+o.width?0:Math.abs(o.left+o.width/2-r):n._shouldWrapFocus(n._activeElement,E)?I:P},(0,p.f)(n),n._id=(0,f.O)("FocusZone"),n._focusAlignment={left:0,top:0},n._processingTabKey=!1,n}return(0,r.C6)(t,e),t.getOuterZones=function(){return R.size},t._onKeyDownCapture=function(e){e.which===d.c.tab&&R.forEach((function(e){return e._updateTabIndexes()}))},t.prototype.componentDidMount=function(){var e=this._root.current;if(x[this._id]=this,e){this._windowElement=(0,g.z)(e);for(var n=(0,u.P)(e,O);n&&n!==this._getDocument().body&&1===n.nodeType;){if((0,c.HC)(n)){this._isInnerZone=!0;break}n=(0,u.P)(n,O)}this._isInnerZone||(R.add(this),this._windowElement&&1===R.size&&this._windowElement.addEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.addEventListener("blur",this._onBlur,!0),this._updateTabIndexes(),this.props.defaultTabbableElement&&"string"==typeof this.props.defaultTabbableElement?this._activeElement=this._getDocument().querySelector(this.props.defaultTabbableElement):this.props.defaultActiveElement&&(this._activeElement=this._getDocument().querySelector(this.props.defaultActiveElement)),this.props.shouldFocusOnMount&&this.focus()}},t.prototype.componentDidUpdate=function(){var e=this._root.current,t=this._getDocument();if(t&&this._lastIndexPath&&(t.activeElement===t.body||null===t.activeElement||!this.props.preventFocusRestoration&&t.activeElement===e)){var n=(0,c.nA)(e,this._lastIndexPath);n?(this._setActiveElement(n,!0),n.focus(),this._setParkedFocus(!1)):this._setParkedFocus(!0)}},t.prototype.componentWillUnmount=function(){delete x[this._id],this._isInnerZone||(R.delete(this),this._windowElement&&0===R.size&&this._windowElement.removeEventListener("keydown",t._onKeyDownCapture,!0)),this._root.current&&this._root.current.removeEventListener("blur",this._onBlur,!0),this._activeElement=null,this._defaultFocusElement=null},t.prototype.render=function(){var e=this,t=this.props,n=t.as,l=t.elementType,c=t.rootProps,u=t.ariaDescribedBy,d=t.ariaLabelledBy,h=t.className,p=(0,m.G1)(this.props,m.vt),f=n||l||"div";this._evaluateFocusBeforeRender();var g=(0,a.getTheme)();return s.createElement(f,(0,r.Cl)({"aria-labelledby":d,"aria-describedby":u},p,c,{className:(0,y.A)((o||(o=(0,i.Z)({selectors:{":focus":{outline:"none"}}},"ms-FocusZone")),o),h),ref:this._mergedRef(this.props.elementRef,this._root),"data-focuszone-id":this._id,onKeyDown:function(t){return e._onKeyDown(t,g)},onFocus:this._onFocus,onMouseDownCapture:this._onMouseDown}),this.props.children)},t.prototype.focus=function(e){if(void 0===e&&(e=!1),this._root.current){if(!e&&"true"===this._root.current.getAttribute(_)&&this._isInnerZone){var t=this._getOwnerZone(this._root.current);if(t!==this._root.current){var n=x[t.getAttribute(C)];return!!n&&n.focusElement(this._root.current)}return!1}if(!e&&this._activeElement&&(0,v.s)(this._root.current,this._activeElement)&&(0,c.S0)(this._activeElement))return this._activeElement.focus(),!0;var o=this._root.current.firstChild;return this.focusElement((0,c.eX)(this._root.current,o,!0))}return!1},t.prototype.focusLast=function(){if(this._root.current){var e=this._root.current&&this._root.current.lastChild;return this.focusElement((0,c.yv)(this._root.current,e,!0,!0,!0))}return!1},t.prototype.focusElement=function(e,t){var n=this.props,o=n.onBeforeFocus,r=n.shouldReceiveFocus;return!(r&&!r(e)||o&&!o(e)||!e||(this._setActiveElement(e,t),this._activeElement&&this._activeElement.focus(),0))},t.prototype.setFocusAlignment=function(e){this._focusAlignment=e},t.prototype._evaluateFocusBeforeRender=function(){var e=this._root.current,t=this._getDocument();if(t){var n=t.activeElement;if(n!==e){var o=(0,v.s)(e,n,!1);this._lastIndexPath=o?(0,c.Ep)(e,n):void 0}}},t.prototype._setParkedFocus=function(e){var t=this._root.current;t&&this._isParked!==e&&(this._isParked=e,e?(this.props.allowFocusRoot||(this._parkedTabIndex=t.getAttribute("tabindex"),t.setAttribute("tabindex","-1")),t.focus()):this.props.allowFocusRoot||(this._parkedTabIndex?(t.setAttribute("tabindex",this._parkedTabIndex),this._parkedTabIndex=void 0):t.removeAttribute("tabindex")))},t.prototype._setActiveElement=function(e,t){var n=this._activeElement;this._activeElement=e,n&&((0,c.HC)(n)&&this._updateTabIndexes(n),n.tabIndex=-1),this._activeElement&&(this._focusAlignment&&!t||this._setFocusAlignment(e,!0,!0),this._activeElement.tabIndex=0)},t.prototype._preventDefaultWhenHandled=function(e){this.props.preventDefaultWhenHandled&&e.preventDefault()},t.prototype._tryInvokeClickForFocusable=function(e,t){var n=e;if(n===this._root.current||!this.props.shouldRaiseClicks)return!1;do{if("BUTTON"===n.tagName||"A"===n.tagName||"INPUT"===n.tagName||"TEXTAREA"===n.tagName)return!1;if(this._isImmediateDescendantOfZone(n)&&"true"===n.getAttribute(_)&&"true"!==n.getAttribute("data-disable-click-on-enter"))return M(n,t),!0;n=(0,u.P)(n,O)}while(n!==this._root.current);return!1},t.prototype._getFirstInnerZone=function(e){if(!(e=e||this._activeElement||this._root.current))return null;if((0,c.HC)(e))return x[e.getAttribute(C)];for(var t=e.firstElementChild;t;){if((0,c.HC)(t))return x[t.getAttribute(C)];var n=this._getFirstInnerZone(t);if(n)return n;t=t.nextElementSibling}return null},t.prototype._moveFocus=function(e,t,n,o){void 0===o&&(o=!0);var r=this._activeElement,s=-1,i=void 0,a=!1,l=this.props.direction===T.E.bidirectional;if(!r||!this._root.current)return!1;if(this._isElementInput(r)&&!this._shouldInputLoseFocus(r,e))return!1;var u=l?r.getBoundingClientRect():null;do{if(r=e?(0,c.eX)(this._root.current,r):(0,c.yv)(this._root.current,r),!l){i=r;break}if(r){var d=t(u,r.getBoundingClientRect());if(-1===d&&-1===s){i=r;break}if(d>-1&&(-1===s||d<s)&&(s=d,i=r),s>=0&&d<0)break}}while(r);if(i&&i!==this._activeElement)a=!0,this.focusElement(i);else if(this.props.isCircularNavigation&&o)return e?this.focusElement((0,c.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,c.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return a},t.prototype._moveFocusDown=function(){var e=this,t=-1,n=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!0,(function(o,r){var s=-1,i=Math.floor(r.top),a=Math.floor(o.bottom);return i<a?e._shouldWrapFocus(e._activeElement,E)?I:P:((-1===t&&i>=a||i===t)&&(t=i,s=n>=r.left&&n<=r.left+r.width?0:Math.abs(r.left+r.width/2-n)),s)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusUp=function(){var e=this,t=-1,n=this._focusAlignment.left||this._focusAlignment.x||0;return!!this._moveFocus(!1,(function(o,r){var s=-1,i=Math.floor(r.bottom),a=Math.floor(r.top),l=Math.floor(o.top);return i>l?e._shouldWrapFocus(e._activeElement,E)?I:P:((-1===t&&i<=l||a===t)&&(t=a,s=n>=r.left&&n<=r.left+r.width?0:Math.abs(r.left+r.width/2-n)),s)}))&&(this._setFocusAlignment(this._activeElement,!1,!0),!0)},t.prototype._moveFocusLeft=function(e){var t=this,n=this._shouldWrapFocus(this._activeElement,A);return!!this._moveFocus((0,h.jI)(e),(function(o,r){var s=-1;return((0,h.jI)(e)?parseFloat(r.top.toFixed(3))<parseFloat(o.bottom.toFixed(3)):parseFloat(r.bottom.toFixed(3))>parseFloat(o.top.toFixed(3)))&&r.right<=o.right&&t.props.direction!==T.E.vertical?s=o.right-r.right:n||(s=P),s}),void 0,n)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusRight=function(e){var t=this,n=this._shouldWrapFocus(this._activeElement,A);return!!this._moveFocus(!(0,h.jI)(e),(function(o,r){var s=-1;return((0,h.jI)(e)?parseFloat(r.bottom.toFixed(3))>parseFloat(o.top.toFixed(3)):parseFloat(r.top.toFixed(3))<parseFloat(o.bottom.toFixed(3)))&&r.left>=o.left&&t.props.direction!==T.E.vertical?s=r.left-o.left:n||(s=P),s}),void 0,n)&&(this._setFocusAlignment(this._activeElement,!0,!1),!0)},t.prototype._moveFocusPaging=function(e,t){void 0===t&&(t=!0);var n=this._activeElement;if(!n||!this._root.current)return!1;if(this._isElementInput(n)&&!this._shouldInputLoseFocus(n,e))return!1;var o=(0,b.Hc)(n);if(!o)return!1;var r=-1,s=void 0,i=-1,a=-1,l=o.clientHeight,u=n.getBoundingClientRect();do{if(n=e?(0,c.eX)(this._root.current,n):(0,c.yv)(this._root.current,n)){var d=n.getBoundingClientRect(),h=Math.floor(d.top),p=Math.floor(u.bottom),f=Math.floor(d.bottom),g=Math.floor(u.top),m=this._getHorizontalDistanceFromCenter(e,u,d);if(e&&h>p+l||!e&&f<g-l)break;m>-1&&(e&&h>i?(i=h,r=m,s=n):!e&&f<a?(a=f,r=m,s=n):(-1===r||m<=r)&&(r=m,s=n))}}while(n);var y=!1;if(s&&s!==this._activeElement)y=!0,this.focusElement(s),this._setFocusAlignment(s,!1,!0);else if(this.props.isCircularNavigation&&t)return e?this.focusElement((0,c.eX)(this._root.current,this._root.current.firstElementChild,!0)):this.focusElement((0,c.yv)(this._root.current,this._root.current.lastElementChild,!0,!0,!0));return y},t.prototype._setFocusAlignment=function(e,t,n){if(this.props.direction===T.E.bidirectional&&(!this._focusAlignment||t||n)){var o=e.getBoundingClientRect(),r=o.left+o.width/2,s=o.top+o.height/2;this._focusAlignment||(this._focusAlignment={left:r,top:s}),t&&(this._focusAlignment.left=r),n&&(this._focusAlignment.top=s)}},t.prototype._isImmediateDescendantOfZone=function(e){return this._getOwnerZone(e)===this._root.current},t.prototype._getOwnerZone=function(e){for(var t=(0,u.P)(e,O);t&&t!==this._root.current&&t!==this._getDocument().body;){if((0,c.HC)(t))return t;t=(0,u.P)(t,O)}return t},t.prototype._updateTabIndexes=function(e){!this._activeElement&&this.props.defaultTabbableElement&&"function"==typeof this.props.defaultTabbableElement&&(this._activeElement=this.props.defaultTabbableElement(this._root.current)),!e&&this._root.current&&(this._defaultFocusElement=null,e=this._root.current,this._activeElement&&!(0,v.s)(e,this._activeElement)&&(this._activeElement=null)),this._activeElement&&!(0,c.S0)(this._activeElement)&&(this._activeElement=null);for(var t=e&&e.children,n=0;t&&n<t.length;n++){var o=t[n];(0,c.HC)(o)?"true"===o.getAttribute(_)&&(this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==o?"-1"!==o.getAttribute(k)&&o.setAttribute(k,"-1"):(this._defaultFocusElement=o,"0"!==o.getAttribute(k)&&o.setAttribute(k,"0"))):(o.getAttribute&&"false"===o.getAttribute(_)&&o.setAttribute(k,"-1"),(0,c.S0)(o)?this.props.disabled?o.setAttribute(k,"-1"):this._isInnerZone||(this._activeElement||this._defaultFocusElement)&&this._activeElement!==o?"-1"!==o.getAttribute(k)&&o.setAttribute(k,"-1"):(this._defaultFocusElement=o,"0"!==o.getAttribute(k)&&o.setAttribute(k,"0")):"svg"===o.tagName&&"false"!==o.getAttribute("focusable")&&o.setAttribute("focusable","false")),this._updateTabIndexes(o)}},t.prototype._isContentEditableElement=function(e){return e&&"true"===e.getAttribute("contenteditable")},t.prototype._isElementInput=function(e){return!(!e||!e.tagName||"input"!==e.tagName.toLowerCase()&&"textarea"!==e.tagName.toLowerCase())},t.prototype._shouldInputLoseFocus=function(e,t){if(!this._processingTabKey&&e&&e.type&&D.indexOf(e.type.toLowerCase())>-1){var n=e.selectionStart,o=n!==e.selectionEnd,r=e.value,s=e.readOnly;if(o||n>0&&!t&&!s||n!==r.length&&t&&!s||this.props.handleTabKey&&(!this.props.shouldInputLoseFocusOnArrowKey||!this.props.shouldInputLoseFocusOnArrowKey(e)))return!1}return!0},t.prototype._shouldWrapFocus=function(e,t){return!this.props.checkForNoWrap||(0,c._l)(e,t)},t.prototype._portalContainsElement=function(e){return e&&!!this._root.current&&(0,S.s)(e,this._root.current)},t.prototype._getDocument=function(){return(0,w.Y)(this._root.current)},t.defaultProps={isCircularNavigation:!1,direction:T.E.bidirectional,shouldRaiseClicks:!0},t}(s.Component)},68529:(e,t,n)=>{"use strict";n.d(t,{E:()=>o,l:()=>r});var o,r={none:0,all:1,inputOnly:2};!function(e){e[e.vertical=0]="vertical",e[e.horizontal=1]="horizontal",e[e.bidirectional=2]="bidirectional",e[e.domOrder=3]="domOrder"}(o||(o={}))},14170:(e,t,n)=>{"use strict";n.d(t,{R:()=>o.R,Es:()=>r.E,lT:()=>r.l}),(0,n(30620).v)("@fluentui/react-focus","7.18.16");var o=n(41622),r=n(68529)},60411:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var o=n(26166).createContext(void 0)},68344:(e,t,n)=>{"use strict";n.d(t,{N:()=>A});var o=n(26166),r=n(44395),s=n(10856),i=n(92147),a=function(e,t,n){void 0===n&&(n={});var o=!1;if(e)for(var r=0,s=Object.keys(e);r<s.length;r++){var i=s[r];if(!o){if(0===i.indexOf("--"))return e;o=!0}var l=t?t+("default"===i?"":"-"+i):"--"+i,c=e[i];c&&"object"==typeof c?a(c,l,n):n[l]=c}return n},l=(0,i.n)((function(e){var t,n,o,r,s,i,l,c,u,d,h,p,f,g,m,y,v=e.tokens;return{root:a(v),body:[{color:null===(o=null===(n=null===(t=v)||void 0===t?void 0:t.color)||void 0===n?void 0:n.body)||void 0===o?void 0:o.contentColor,background:null===(i=null===(s=null===(r=v)||void 0===r?void 0:r.color)||void 0===s?void 0:s.body)||void 0===i?void 0:i.background,fontFamily:null===(c=null===(l=v)||void 0===l?void 0:l.body)||void 0===c?void 0:c.fontFamily,fontWeight:null===(d=null===(u=v)||void 0===u?void 0:u.body)||void 0===d?void 0:d.fontWeight,fontSize:null===(p=null===(h=v)||void 0===h?void 0:h.body)||void 0===p?void 0:p.fontSize,MozOsxFontSmoothing:null===(g=null===(f=v)||void 0===f?void 0:f.body)||void 0===g?void 0:g.mozOsxFontSmoothing,WebkitFontSmoothing:null===(y=null===(m=v)||void 0===m?void 0:m.body)||void 0===y?void 0:y.webkitFontSmoothing}]}}));var c=n(98670),u=n(32305),d=n(65977),h=n(94857),p=n(60411),f=n(82144),g=function(e){var t=function(e){var t={root:e.as||"div"},n={root:"string"==typeof e.as?(0,u._)(e.as,e):(0,d.cJ)(e,["as"])};return{slots:t,slotProps:n}}(e),n=t.slots,r=t.slotProps,s=e.theme,i=e.customizerContext;return o.createElement(p.D.Provider,{value:s},o.createElement(f.E.Provider,{value:e.renderer},o.createElement(h.z.Provider,{value:i},o.createElement(n.root,(0,c.Cl)({},r.root)))))},m=n(1614),y=n(15603),v=n(6105),b=n(58624),S=new Map,w=function(e){void 0===e&&(e={});var t=(0,c.aN)(e.deepMerge||[],["style"]),n=function(e){for(var s=[],i=1;i<arguments.length;i++)s[i-1]=arguments[i];for(var a=0,l=s;a<l.length;a++){var c=l[a];if(c)for(var u=0,d=Object.keys(c);u<d.length;u++){var h=d[u],p=c[h];void 0!==p&&(p&&"object"==typeof p?Array.isArray(p)?e[h]=p:(e[h]=e[h]||{},"object"!=typeof e[h]||o.isValidElement(p)||p&&"object"==typeof p&&p.hasOwnProperty("current")||-1===t.indexOf(h)?e[h]=p:n(e[h],p)):"className"===h?p&&(e[h]=(0,r.A)(e[h],p)):e[h]=p)}}return e};return n}(),T=function(e,t,n){var r,s,i,a,l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=o.useCallback((function(t){n.current=t;for(var o=0,r=e;o<r.length;o++){var s=r[o];"function"==typeof s?s(t):s&&(s.current=t)}}),(0,c.aN)(e));return n}(t,o.useRef(null)),u=w({ref:l,as:"div"},n,e);return s=(r=u).theme,i=(0,y.D)(),a=r.theme=o.useMemo((function(){var e,t=(0,m.z)(i,s);return t.tokens=function(e,t){var n=e.fonts,o=e.palette,r=e.semanticColors;return(0,b.h)({color:{body:{background:r.bodyBackground,contentColor:r.bodyText},brand:{background:r.primaryButtonBackground,borderColor:r.primaryButtonBorder,contentColor:r.primaryButtonText,iconColor:o.white,dividerColor:o.white,secondaryContentColor:o.white,hovered:{background:r.primaryButtonBackgroundHovered,contentColor:r.primaryButtonTextHovered,secondaryContentColor:o.white,borderColor:"var(--color-brand-borderColor)"},pressed:{background:r.primaryButtonBackgroundPressed,contentColor:r.primaryButtonTextPressed,secondaryContentColor:r.primaryButtonTextPressed,borderColor:"var(--color-brand-borderColor)",iconColor:"var(--color-brand-iconColor)"},focused:{background:"var(--color-brand-background)",borderColor:"var(--color-brand-borderColor)",contentColor:"var(--color-brand-contentColor)",iconColor:"var(--color-brand-iconColor)",secondaryContentColor:"var(--color-brand-focused-contentColor)"},disabled:{background:r.primaryButtonBackgroundDisabled,contentColor:r.buttonTextDisabled,dividerColor:o.neutralTertiaryAlt,secondaryContentColor:"var(--color-brand-disabled-contentColor)",borderColor:"var(--color-brand-disabled-background)",iconColor:"var(--color-brand-disabled-contentColor)"},checked:{background:r.primaryButtonBackgroundPressed,contentColor:r.primaryButtonTextPressed,iconColor:r.primaryButtonTextPressed},checkedHovered:{background:r.primaryButtonBackgroundPressed,contentColor:r.primaryButtonTextPressed,iconColor:r.primaryButtonTextPressed}}},body:{fontFamily:n.medium.fontFamily,fontWeight:n.medium.fontWeight,fontSize:n.medium.fontSize,mozOsxFontSmoothing:n.medium.MozOsxFontSmoothing,webkitFontSmoothing:n.medium.WebkitFontSmoothing},text:{variant:{caption:{fontSize:"12px",fontWeight:"400",lineHeight:"14px"},body:{fontSize:"14px",fontWeight:"400",lineHeight:"20px"},subHeadline:{fontSize:"16px",fontWeight:"600",lineHeight:"22px"},headline:{fontSize:"20px",fontWeight:"600",lineHeight:"28px"},title3:{fontSize:"24px",fontWeight:"600",lineHeight:"32px"},title2:{fontSize:"28px",fontWeight:"600",lineHeight:"36px"},title1:{fontSize:"32px",fontWeight:"600",lineHeight:"40px"},largeTitle:{fontSize:"40px",fontWeight:"600",lineHeight:"52px"},display:{fontSize:"68px",fontWeight:"600",lineHeight:"92px"}}}},t)}(t,null===(e=s)||void 0===e?void 0:e.tokens),t.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],o=0,r=e;o<r.length;o++){var s=r[o];if(s){var i=s.id||S.get(s);i||(i=(0,v.O)(""),S.set(s,i)),n.push(i)}}return n.join("-")}(i,s),t}),[i,s]),r.customizerContext=o.useMemo((function(){return{customizations:{inCustomizerContext:!0,settings:{theme:a},scopedSettings:a.components||{}}}}),[a]),r.theme.rtl!==i.rtl&&(r.dir=r.theme.rtl?"rtl":"ltr"),{state:u,render:g}},_=n(99694),C={document:"document"},k=o.createContext({registerStyles:function(e,t){var n=t.styleCache,o=t.target;if(e&&!(e.length<1)){Array.isArray(e)||(e=[e]);var r=[],s=o||C,i=n.get(s);i||(i=new Map,n.set(s,i));for(var a=0,l=e;a<l.length;a++){var c=l[a];i.has(c)||(r.push(c),i.set(c,!0))}r.length&&t.renderStyles(r,t)}},renderStyles:function(e,t){var n=t.target;if(e.length&&n){var o=n.createElement("style");o.textContent=e.join(""),n.head.appendChild(o)}},target:"object"==typeof window?window.document:void 0,styleCache:new WeakMap}),E=n(82540),A=o.forwardRef((function(e,t){var n,i,a=T(e,t,{renderer:_.K,applyTo:"element"}),c=a.render,u=a.state;return n=u.theme.stylesheets,(i=o.useContext(k)).registerStyles(n,i),function(e){var t=l(e),n=e.className,i=e.applyTo;!function(e,t){var n,r="body"===e.applyTo,i=null===(n=(0,s.ZY)())||void 0===n?void 0:n.body;o.useEffect((function(){if(r&&i){for(var e=0,n=t;e<n.length;e++){var o=n[e];o&&i.classList.add(o)}return function(){if(r&&i)for(var e=0,n=t;e<n.length;e++){var o=n[e];o&&i.classList.remove(o)}}}}),[r,i,t])}(e,[t.root,t.body]),e.className=(0,r.A)(n,t.root,"element"===i&&t.body)}(u),(0,E.v)(u.ref),c(u)}));A.displayName="ThemeProvider"},92147:(e,t,n)=>{"use strict";n.d(t,{n:()=>l});var o=n(15603),r=n(10856),s=n(82144),i=function(e,t){for(var n=0,o=t;n<o.length;n++){var r=o[n];if(!(e=e.get(r)))return}return e},a=function(e,t,n){for(var o=0;o<t.length-1;o++){var r=t[o],s=e.get(r);s||(s=new Map,e.set(r,s)),e=s}e.set(t[t.length-1],n)};function l(e){var t=new Map;return function(n){void 0===n&&(n={});var l=n.theme,c=n.renderer,u=(0,r.ox)(),d=(0,o.D)(),h=(0,s.M)();l=l||d||{};var p=(c=c||h).getId(),f="function"==typeof e,g=f?[p,u,l]:[p,u],m=i(t,g);if(!m){var y=f?e(l):e;m=c.renderStyles(y,{targetWindow:u,rtl:!!l.rtl}),a(t,g,m)}return m}}},99694:(e,t,n)=>{"use strict";n.d(t,{K:()=>l}),n(26166);var o=n(95876),r=n(46208),s=n(3864),i=n(88063),a=0,l={reset:function(){o.n.getInstance().onReset((function(){return a++}))},getId:function(){return a},renderStyles:function(e,t){return(0,r.L)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return(0,s.n)(e)},renderKeyframes:function(e){return(0,i.i)(e)}}},82144:(e,t,n)=>{"use strict";n.d(t,{E:()=>s,M:()=>i});var o=n(26166),r=n(99694),s=o.createContext(r.K),i=function(){return o.useContext(s)}},15603:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var o=n(26166),r=n(24194),s=n(18817),i=n(60411),a=function(){var e=(0,o.useContext)(i.D),t=(0,r.m)(["theme"]).theme;return e||t||(0,s.a)({})}},10856:(e,t,n)=>{"use strict";n.d(t,{IF:()=>a,ZY:()=>i,_0:()=>r,ox:()=>s});var o=n(26166),r=o.createContext({window:"object"==typeof window?window:void 0}),s=function(){return o.useContext(r).window},i=function(){var e;return null===(e=o.useContext(r).window)||void 0===e?void 0:e.document},a=function(e){return o.createElement(r.Provider,{value:e},e.children)}},83345:(e,t,n)=>{"use strict";n.d(t,{IF:()=>o.IF,ZY:()=>o.ZY,_0:()=>o._0,ox:()=>o.ox});var o=n(10856)},60783:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});var o=(0,n(18817).a)({})},38445:(e,t,n)=>{"use strict";n.d(t,{b:()=>o});var o={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"}},3531:(e,t,n)=>{"use strict";var o,r,s;n.d(t,{$U:()=>o,kd:()=>r,u2:()=>s}),function(e){e.shade30="#004578",e.shade20="#005a9e",e.shade10="#106ebe",e.primary="#0078d4",e.tint10="#2b88d8",e.tint20="#c7e0f4",e.tint30="#deecf9",e.tint40="#eff6fc"}(o||(o={})),function(e){e.black="#000000",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(r||(r={})),function(e){e.pinkRed10="#750b1c",e.red20="#a4262c",e.red10="#d13438",e.redOrange20="#603d30",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan40="#005e50",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta40="#373277",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(s||(s={}))},18817:(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var o=n(38445),r=n(36544),s=n(11435),i=n(1614),a=n(11682),l=n(27145);function c(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var n=!!e.isInverted,c={palette:o.b,effects:r.W,fonts:s.d,spacing:a.N,isInverted:n,disableGlobalClassNames:!1,semanticColors:(0,l.b)(o.b,r.W,void 0,n,t),rtl:void 0};return(0,i.z)(c,e)}},36544:(e,t,n)=>{"use strict";n.d(t,{W:()=>r});var o=n(5409),r={elevation4:o.f.depth4,elevation8:o.f.depth8,elevation16:o.f.depth16,elevation64:o.f.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"}},5409:(e,t,n)=>{"use strict";var o;n.d(t,{f:()=>o}),function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(o||(o={}))},11435:(e,t,n)=>{"use strict";n.d(t,{a:()=>f,d:()=>d});var o,r,s,i=n(3864),a=n(99453),l=n(99230),c=n(54727),u=n(36151),d=(0,l.s)((0,c.Z)("sessionStorage"));function h(e,t,n,o){e="'"+e+"'";var r=void 0!==o?"local('"+o+"'),":"";(0,i.n)({fontFamily:e,src:r+"url('"+t+".woff2') format('woff2'),url('"+t+".woff') format('woff')",fontWeight:n,fontStyle:"normal",fontDisplay:"swap"})}function p(e,t,n,o,r){void 0===o&&(o="segoeui");var s=e+"/"+n+"/"+o;h(t,s+"-light",a.BO.light,r&&r+" Light"),h(t,s+"-semilight",a.BO.semilight,r&&r+" SemiLight"),h(t,s+"-regular",a.BO.regular,r),h(t,s+"-semibold",a.BO.semibold,r&&r+" SemiBold"),h(t,s+"-bold",a.BO.bold,r&&r+" Bold")}function f(e){if(e){var t=e+"/fonts";p(t,a.Dn.Thai,"leelawadeeui-thai","leelawadeeui"),p(t,a.Dn.Arabic,"segoeui-arabic"),p(t,a.Dn.Cyrillic,"segoeui-cyrillic"),p(t,a.Dn.EastEuropean,"segoeui-easteuropean"),p(t,a.Dn.Greek,"segoeui-greek"),p(t,a.Dn.Hebrew,"segoeui-hebrew"),p(t,a.Dn.Vietnamese,"segoeui-vietnamese"),p(t,a.Dn.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),p(t,a.bi.Selawik,"selawik","selawik"),p(t,a.Dn.Armenian,"segoeui-armenian"),p(t,a.Dn.Georgian,"segoeui-georgian"),h("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-semilight",a.BO.light),h("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-bold",a.BO.semibold)}}f(null!=(s=null===(r=null===(o=(0,u.z)())||void 0===o?void 0:o.FabricConfig)||void 0===r?void 0:r.fontBaseUrl)?s:"https://static2.sharepointonline.com/files/fabric/assets")},99453:(e,t,n)=>{"use strict";var o,r,s,i,a;n.d(t,{BO:()=>i,Dn:()=>o,bi:()=>r,fF:()=>a,s:()=>s}),function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(o||(o={})),function(e){e.Arabic="'"+o.Arabic+"'",e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'"+o.Cyrillic+"'",e.EastEuropean="'"+o.EastEuropean+"'",e.Greek="'"+o.Greek+"'",e.Hebrew="'"+o.Hebrew+"'",e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'"+o.Selawik+"'",e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'"+o.Vietnamese+"'",e.WestEuropean="'"+o.WestEuropean+"'",e.Armenian="'"+o.Armenian+"'",e.Georgian="'"+o.Georgian+"'"}(r||(r={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(s||(s={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(i||(i={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(a||(a={}))},99230:(e,t,n)=>{"use strict";n.d(t,{s:()=>l});var o=n(99453),r="'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif",s="'Segoe UI', '"+o.Dn.WestEuropean+"'",i={ar:o.bi.Arabic,bg:o.bi.Cyrillic,cs:o.bi.EastEuropean,el:o.bi.Greek,et:o.bi.EastEuropean,he:o.bi.Hebrew,hi:o.bi.Hindi,hr:o.bi.EastEuropean,hu:o.bi.EastEuropean,ja:o.bi.Japanese,kk:o.bi.EastEuropean,ko:o.bi.Korean,lt:o.bi.EastEuropean,lv:o.bi.EastEuropean,pl:o.bi.EastEuropean,ru:o.bi.Cyrillic,sk:o.bi.EastEuropean,"sr-latn":o.bi.EastEuropean,th:o.bi.Thai,tr:o.bi.EastEuropean,uk:o.bi.Cyrillic,vi:o.bi.Vietnamese,"zh-hans":o.bi.ChineseSimplified,"zh-hant":o.bi.ChineseTraditional,hy:o.bi.Armenian,ka:o.bi.Georgian};function a(e,t,n){return{fontFamily:n,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}function l(e){var t=function(e){for(var t in i)if(i.hasOwnProperty(t)&&e&&0===t.indexOf(e))return i[t];return s}(e)+", "+r;return{tiny:a(o.s.mini,o.BO.regular,t),xSmall:a(o.s.xSmall,o.BO.regular,t),small:a(o.s.small,o.BO.regular,t),smallPlus:a(o.s.smallPlus,o.BO.regular,t),medium:a(o.s.medium,o.BO.regular,t),mediumPlus:a(o.s.mediumPlus,o.BO.regular,t),large:a(o.s.large,o.BO.regular,t),xLarge:a(o.s.xLarge,o.BO.semibold,t),xLargePlus:a(o.s.xLargePlus,o.BO.semibold,t),xxLarge:a(o.s.xxLarge,o.BO.semibold,t),xxLargePlus:a(o.s.xxLargePlus,o.BO.semibold,t),superLarge:a(o.s.superLarge,o.BO.semibold,t),mega:a(o.s.mega,o.BO.semibold,t)}}},1614:(e,t,n)=>{"use strict";n.d(t,{z:()=>s});var o=n(58624),r=n(27145);function s(e,t){var n,s,i,a;void 0===t&&(t={});var l=(0,o.h)({},e,t,{semanticColors:(0,r.B)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(n=t.palette)||void 0===n?void 0:n.themePrimary)&&!(null===(s=t.palette)||void 0===s?void 0:s.accent)&&(l.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var c=0,u=Object.keys(l.fonts);c<u.length;c++){var d=u[c];l.fonts[d]=(0,o.h)(l.fonts[d],t.defaultFontStyle,null===(a=null===(i=t)||void 0===i?void 0:i.fonts)||void 0===a?void 0:a[d])}return t.stylesheets&&(l.stylesheets=(e.stylesheets||[]).concat(t.stylesheets)),l}},32163:(e,t,n)=>{"use strict";n.d(t,{Mz:()=>s,OV:()=>r,Sw:()=>o});var o,r,s,i=n(88063),a=(0,i.i)({from:{opacity:0},to:{opacity:1}}),l=(0,i.i)({from:{opacity:1},to:{opacity:0}}),c=(0,i.i)({from:{transform:"scale3d(1.15, 1.15, 1)"},to:{transform:"scale3d(1, 1, 1)"}}),u=(0,i.i)({from:{transform:"scale3d(1, 1, 1)"},to:{transform:"scale3d(0.9, 0.9, 1)"}}),d=(0,i.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(-48px, 0, 0)"}}),h=(0,i.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(48px, 0, 0)"}}),p=(0,i.i)({from:{transform:"translate3d(48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),f=(0,i.i)({from:{transform:"translate3d(-48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),g=(0,i.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, -48px, 0)"}}),m=(0,i.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, 48px, 0)"}}),y=(0,i.i)({from:{transform:"translate3d(0, 48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),v=(0,i.i)({from:{transform:"translate3d(0, -48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}});function b(e,t,n){return e+" "+t+" "+n}!function(e){e.duration1="100ms",e.duration2="200ms",e.duration3="300ms",e.duration4="400ms"}(o||(o={})),function(e){e.accelerate="cubic-bezier(0.9, 0.1, 1, 0.2)",e.decelerate="cubic-bezier(0.1, 0.9, 0.2, 1)",e.linear="cubic-bezier(0, 0, 1, 1)",e.standard="cubic-bezier(0.8, 0, 0.2, 1)"}(r||(r={})),function(e){e.fadeIn=b(a,o.duration1,r.linear),e.fadeOut=b(l,o.duration1,r.linear),e.scaleDownIn=b(c,o.duration3,r.decelerate),e.scaleDownOut=b(u,o.duration3,r.decelerate),e.slideLeftOut=b(d,o.duration1,r.accelerate),e.slideRightOut=b(h,o.duration1,r.accelerate),e.slideLeftIn=b(p,o.duration1,r.decelerate),e.slideRightIn=b(f,o.duration1,r.decelerate),e.slideUpOut=b(g,o.duration1,r.accelerate),e.slideDownOut=b(m,o.duration1,r.accelerate),e.slideUpIn=b(y,o.duration1,r.decelerate),e.slideDownIn=b(v,o.duration1,r.decelerate)}(s||(s={}))},11682:(e,t,n)=>{"use strict";n.d(t,{N:()=>o});var o={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"}},27145:(e,t,n)=>{"use strict";n.d(t,{B:()=>s,b:()=>r});var o=n(98670);function r(e,t,n,r,i){return void 0===i&&(i=!1),function(e,t){var n="";return!0===t&&(n=" /* @deprecated */"),e.listTextColor=e.listText+n,e.menuItemBackgroundChecked+=n,e.warningHighlight+=n,e.warningText=e.messageText+n,e.successText+=n,e}(s(e,t,(0,o.Cl)({primaryButtonBorder:"transparent",errorText:r?"#F1707B":"#a4262c",messageText:r?"#F3F2F1":"#323130",messageLink:r?"#6CB8F6":"#005A9E",messageLinkHovered:r?"#82C7FF":"#004578",infoIcon:r?"#C8C6C4":"#605e5c",errorIcon:r?"#F1707B":"#A80000",blockingIcon:r?"#442726":"#FDE7E9",warningIcon:r?"#C8C6C4":"#797775",severeWarningIcon:r?"#FCE100":"#D83B01",successIcon:r?"#92C353":"#107C10",infoBackground:r?"#323130":"#f3f2f1",errorBackground:r?"#442726":"#FDE7E9",blockingBackground:r?"#442726":"#FDE7E9",warningBackground:r?"#433519":"#FFF4CE",severeWarningBackground:r?"#4F2A0F":"#FED9CC",successBackground:r?"#393D1B":"#DFF6DD",warningHighlight:r?"#fff100":"#ffb900",successText:r?"#92c353":"#107C10"},n),r),i)}function s(e,t,n,r,s){var i,a,l;void 0===s&&(s=!1);var c={},u=e||{},d=u.white,h=u.black,p=u.themePrimary,f=u.themeDark,g=u.themeDarker,m=u.themeDarkAlt,y=u.themeLighter,v=u.neutralLight,b=u.neutralLighter,S=u.neutralDark,w=u.neutralQuaternary,T=u.neutralQuaternaryAlt,_=u.neutralPrimary,C=u.neutralSecondary,k=u.neutralSecondaryAlt,E=u.neutralTertiary,A=u.neutralTertiaryAlt,I=u.neutralLighterAlt,P=u.accent;return d&&(c.bodyBackground=d,c.bodyFrameBackground=d,c.accentButtonText=d,c.buttonBackground=d,c.primaryButtonText=d,c.primaryButtonTextHovered=d,c.primaryButtonTextPressed=d,c.inputBackground=d,c.inputForegroundChecked=d,c.listBackground=d,c.menuBackground=d,c.cardStandoutBackground=d),h&&(c.bodyTextChecked=h,c.buttonTextCheckedHovered=h),p&&(c.link=p,c.primaryButtonBackground=p,c.inputBackgroundChecked=p,c.inputIcon=p,c.inputFocusBorderAlt=p,c.menuIcon=p,c.menuHeader=p,c.accentButtonBackground=p),f&&(c.primaryButtonBackgroundPressed=f,c.inputBackgroundCheckedHovered=f,c.inputIconHovered=f),g&&(c.linkHovered=g),m&&(c.primaryButtonBackgroundHovered=m),y&&(c.inputPlaceholderBackgroundChecked=y),v&&(c.bodyBackgroundChecked=v,c.bodyFrameDivider=v,c.bodyDivider=v,c.variantBorder=v,c.buttonBackgroundCheckedHovered=v,c.buttonBackgroundPressed=v,c.listItemBackgroundChecked=v,c.listHeaderBackgroundPressed=v,c.menuItemBackgroundPressed=v,c.menuItemBackgroundChecked=v),b&&(c.bodyBackgroundHovered=b,c.buttonBackgroundHovered=b,c.buttonBackgroundDisabled=b,c.buttonBorderDisabled=b,c.primaryButtonBackgroundDisabled=b,c.disabledBackground=b,c.listItemBackgroundHovered=b,c.listHeaderBackgroundHovered=b,c.menuItemBackgroundHovered=b),w&&(c.primaryButtonTextDisabled=w,c.disabledSubtext=w),T&&(c.listItemBackgroundCheckedHovered=T),E&&(c.disabledBodyText=E,c.variantBorderHovered=(null===(i=n)||void 0===i?void 0:i.variantBorderHovered)||E,c.buttonTextDisabled=E,c.inputIconDisabled=E,c.disabledText=E),_&&(c.bodyText=_,c.actionLink=_,c.buttonText=_,c.inputBorderHovered=_,c.inputText=_,c.listText=_,c.menuItemText=_),I&&(c.bodyStandoutBackground=I,c.defaultStateBackground=I),S&&(c.actionLinkHovered=S,c.buttonTextHovered=S,c.buttonTextChecked=S,c.buttonTextPressed=S,c.inputTextHovered=S,c.menuItemTextHovered=S),C&&(c.bodySubtext=C,c.focusBorder=C,c.inputBorder=C,c.smallInputBorder=C,c.inputPlaceholderText=C),k&&(c.buttonBorder=k),A&&(c.disabledBodySubtext=A,c.disabledBorder=A,c.buttonBackgroundChecked=A,c.menuDivider=A),P&&(c.accentButtonBackground=P),(null===(a=t)||void 0===a?void 0:a.elevation4)&&(c.cardShadow=t.elevation4),!r&&(null===(l=t)||void 0===l?void 0:l.elevation8)?c.cardShadowHovered=t.elevation8:c.variantBorderHovered&&(c.cardShadowHovered="0 0 1px "+c.variantBorderHovered),(0,o.Cl)((0,o.Cl)({},c),n)}},92132:(e,t,n)=>{"use strict";n.d(t,{EQ:()=>p,hN:()=>d});var o,r=function(){return r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)},s="undefined"==typeof window?n.g:window,i=s&&s.CSPSettings&&s.CSPSettings.nonce,a=((o=s.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(o=r(r({},o),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),o.registeredThemableStyles||(o=r(r({},o),{registeredThemableStyles:[]})),s.__themeState__=o,o),l=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,c=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function u(e){var t=c();e();var n=c();a.perf.duration+=n-t}function d(e,t){void 0===t&&(t=!1),u((function(){var n=Array.isArray(e)?e:function(e){var t=[];if(e){for(var n=0,o=void 0;o=l.exec(e);){var r=o.index;r>n&&t.push({rawString:e.substring(n,r)}),t.push({theme:o[1],defaultValue:o[2]}),n=l.lastIndex}t.push({rawString:e.substring(n)})}return t}(e),o=a.runState,r=o.mode,s=o.buffer,i=o.flushTimer;t||1===r?(s.push(n),i||(a.runState.flushTimer=setTimeout((function(){a.runState.flushTimer=0,u((function(){var e=a.runState.buffer.slice();a.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&h(t)}))}),0))):h(n)}))}function h(e,t){a.loadStyles?a.loadStyles(g(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),o=g(e),r=o.styleString,s=o.themable;n.setAttribute("data-load-themed-styles","true"),i&&n.setAttribute("nonce",i),n.appendChild(document.createTextNode(r)),a.perf.count++,t.appendChild(n);var l=document.createEvent("HTMLEvents");l.initEvent("styleinsert",!0,!1),l.args={newStyle:n},document.dispatchEvent(l);var c={styleElement:n,themableStyle:e};s?a.registeredThemableStyles.push(c):a.registeredStyles.push(c)}}(e)}function p(e){a.theme=e,function(){if(a.theme){for(var e=[],t=0,n=a.registeredThemableStyles;t<n.length;t++){var o=n[t];e.push(o.themableStyle)}e.length>0&&(void 0===(r=1)&&(r=3),3!==r&&2!==r||(f(a.registeredStyles),a.registeredStyles=[]),3!==r&&1!==r||(f(a.registeredThemableStyles),a.registeredThemableStyles=[]),h([].concat.apply([],e)))}var r}()}function f(e){e.forEach((function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)}))}function g(e){var t=a.theme,n=!1;return{styleString:(e||[]).map((function(e){var o=e.theme;if(o){n=!0;var r=t?t[o]:void 0,s=e.defaultValue||"inherit";return t&&!r&&console&&!(o in t)&&"undefined"!=typeof DEBUG&&DEBUG&&console.warn('Theming value not provided for "'.concat(o,'". Falling back to "').concat(s,'".')),r||s}return e.rawString})).join(""),themable:n}}},31545:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AuthenticationHandler:()=>C,AuthenticationHandlerOptions:()=>S,BatchRequestContent:()=>s,BatchResponseContent:()=>i,ChaosHandler:()=>N,ChaosHandlerOptions:()=>R,ChaosStrategy:()=>T,Client:()=>te,CustomAuthenticationProvider:()=>J,FeatureUsageFlag:()=>w,FileUpload:()=>$,GraphClientError:()=>l,GraphError:()=>K,GraphRequest:()=>X,HTTPMessageHandler:()=>k,LargeFileUploadTask:()=>q,MiddlewareFactory:()=>x,OneDriveLargeFileUploadTask:()=>j,PageIterator:()=>Q,Range:()=>G,RedirectHandler:()=>P,RedirectHandlerOptions:()=>I,ResponseType:()=>L,RetryHandler:()=>A,RetryHandlerOptions:()=>E,StreamUpload:()=>z,TelemetryHandler:()=>M,TelemetryHandlerOptions:()=>_,UploadResult:()=>H,getValidRangeSize:()=>V});var o,r=n(67524);!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(o||(o={}));class s{static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let n=t.next();for(;!n.done;){const e=n.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const o=n.value[1];if(void 0!==o.dependsOn&&o.dependsOn.length>0)return!1;let r=n;for(n=t.next();!n.done;){const e=n.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==r.value[1].id)return!1;r=n,n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const o=n.value[1];let r;if(void 0===o.dependsOn||0===o.dependsOn.length)r=o.id;else{if(1!==o.dependsOn.length)return!1;{const t=o.dependsOn[0];if(t===o.id||!e.has(t))return!1;r=t}}for(n=t.next();!n.done;){const e=n.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&r!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===r||e.dependsOn[0]!==r))return!1;if(e.dependsOn.length>1)return!1}n=t.next()}return!0})(e)}static getRequestData(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t={url:""},n=new RegExp("^https?://");t.url=n.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const r={};return e.headers.forEach(((e,t)=>{r[t]=e})),Object.keys(r).length&&(t.headers=r),e.method!==o.PATCH&&e.method!==o.POST&&e.method!==o.PUT||(t.body=yield s.getRequestBody(e)),t}))}static getRequestBody(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){let t,n=!1;try{const o=e.clone();t=yield o.json(),n=!0}catch(e){}if(!n)try{if("undefined"!=typeof Blob){const n=yield e.blob(),o=new FileReader;t=yield new Promise((e=>{o.addEventListener("load",(()=>{const t=o.result,n=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(n[4])}),!1),o.readAsDataURL(n)}))}else"undefined"!=typeof Buffer&&(t=(yield e.buffer()).toString("base64"));n=!0}catch(e){}return t}))}constructor(e){if(this.requests=new Map,void 0!==e){const t=s.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}addRequest(e){const t=s.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),n=this.requests.entries();let o=n.next();for(;!o.done;){const t=o.value[1].dependsOn;if(void 0!==t){const n=t.indexOf(e);-1!==n&&t.splice(n,1),0===t.length&&delete o.value[1].dependsOn}o=n.next()}return t}getContent(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const e=[],t={requests:e},n=this.requests.entries();let o=n.next();if(o.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!s.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!o.done;){const t=o.value[1],r=yield s.getRequestData(t.request);if(void 0!==r.body&&(void 0===r.headers||void 0===r.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}r.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(r.dependsOn=t.dependsOn),e.push(r),o=n.next()}return t.requests=e,t}))}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const n=this.requests.get(e);if(void 0===n.dependsOn&&(n.dependsOn=[]),-1!==n.dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}n.dependsOn.push(t)}else{const n=this.requests.entries();let o,r=n.next();for(;!r.done&&r.value[1].id!==e;)o=r,r=n.next();if(void 0===o){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=o.value[0];if(void 0===r.value[1].dependsOn&&(r.value[1].dependsOn=[]),-1!==r.value[1].dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}r.value[1].dependsOn.push(t)}}}removeDependency(e,t){const n=this.requests.get(e);if(void 0===n||void 0===n.dependsOn||0===n.dependsOn.length)return!1;if(void 0!==t){const e=n.dependsOn.indexOf(t);return-1!==e&&(n.dependsOn.splice(e,1),!0)}return delete n.dependsOn,!0}}s.requestLimit=20;class i{constructor(e){this.responses=new Map,this.update(e)}createResponseObject(e){const t=e.body,n={};if(n.status=e.status,void 0!==e.statusText&&(n.statusText=e.statusText),n.headers=e.headers,void 0!==n.headers&&void 0!==n.headers["Content-Type"]&&"application/json"===n.headers["Content-Type"].split(";")[0]){const e=JSON.stringify(t);return new Response(e,n)}return new Response(t,n)}update(e){this.nextLink=e["@odata.nextLink"];const t=e.responses;for(let e=0,n=t.length;e<n;e++)this.responses.set(t[e].id,this.createResponseObject(t[e]))}getResponseById(e){return this.responses.get(e)}getResponses(){return this.responses}*getResponsesIterator(){const e=this.responses.entries();let t=e.next();for(;!t.done;)yield t.value,t=e.next()}}const a=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class l extends Error{static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new l,t.customError=e),t}constructor(e){super(e),Object.setPrototypeOf(this,l.prototype)}}const c=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],u=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e},d=e=>p(e),h=(e,t)=>(t.forEach((e=>f(e))),p(e,t)),p=(e,t=a)=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const n=(e=e.replace("https://","")).indexOf(":"),o=e.indexOf("/");let r="";if(-1!==o)return-1!==n&&n<o?(r=e.substring(0,n),t.has(r)):(r=e.substring(0,o),t.has(r))}return!1},f=e=>{if(-1!==e.indexOf("/"))throw new l("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class g{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const m=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},y=(e,t,n)=>{let o=null;if("undefined"!=typeof Request&&e instanceof Request)o=e.headers.get(n);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)o=t.headers.get(n);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,r=e.length;t<r;t++)if(e[t][0]===n){o=e[t][1];break}}else void 0!==t.headers[n]&&(o=t.headers[n]);return o},v=(e,t,n,o)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(n,o);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[n]:o});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(n,o);else if(t.headers instanceof Array){let e=0;const r=t.headers.length;for(;e<r;e++){const r=t.headers[e];if(r[0]===n){r[1]=o;break}}e===r&&t.headers.push([n,o])}else Object.assign(t.headers,{[n]:o})},b=(e,t,n,o)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(n,o):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[n]:o}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(n,o):t.headers instanceof Array?t.headers.push([n,o]):void 0===t.headers?t.headers={[n]:o}:void 0===t.headers[n]?t.headers[n]=o:t.headers[n]+=`, ${o}`)};class S{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var w,T;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(w||(w={}));class _{constructor(){this.featureUsage=w.NONE}static updateFeatureUsageFlag(e,t){let n;e.middlewareControl instanceof g?n=e.middlewareControl.getMiddlewareOptions(_):e.middlewareControl=new g,void 0===n&&(n=new _,e.middlewareControl.setMiddlewareOptions(_,n)),n.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class C{constructor(e){this.authenticationProvider=e}execute(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(d(t)||e.customHosts&&h(t,e.customHosts)){let t,n,o;e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(S)),t&&(n=t.authenticationProvider,o=t.authenticationProviderOptions),n||(n=this.authenticationProvider);const r=`Bearer ${yield n.getAccessToken(o)}`;b(e.request,e.options,C.AUTHORIZATION_HEADER,r),_.updateFeatureUsageFlag(e,w.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[C.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}C.AUTHORIZATION_HEADER="Authorization";class k{execute(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){e.response=yield fetch(e.request,e.options)}))}}class E{constructor(e=E.DEFAULT_DELAY,t=E.DEFAULT_MAX_RETRIES,n=E.defaultShouldRetry){if(e>E.MAX_DELAY&&t>E.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${E.MAX_DELAY} and ${E.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>E.MAX_DELAY){const e=new Error(`Delay should not be more than ${E.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>E.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${E.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,E.MAX_DELAY),this.maxRetries=Math.min(t,E.MAX_MAX_RETRIES),this.shouldRetry=n}getMaxDelay(){return E.MAX_DELAY}}E.DEFAULT_DELAY=3,E.DEFAULT_MAX_RETRIES=3,E.MAX_DELAY=180,E.MAX_MAX_RETRIES=10,E.defaultShouldRetry=()=>!0;class A{constructor(e=new E){this.options=e}isRetry(e){return-1!==A.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const n="string"==typeof e?t.method:e.method;return n!==o.PUT&&n!==o.PATCH&&n!==o.POST||"application/octet-stream"!==y(e,t,"Content-Type")}getDelay(e,t,n){const o=()=>Number(Math.random().toFixed(3)),r=void 0!==e.headers?e.headers.get(A.RETRY_AFTER_HEADER):null;let s;return s=null!==r?Number.isNaN(Number(r))?Math.round((new Date(r).getTime()-Date.now())/1e3):Number(r):t>=2?this.getExponentialBackOffTime(t)+n+o():n+o(),Math.min(s,this.options.getMaxDelay()+o())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t=1e3*e;return new Promise((e=>setTimeout(e,t)))}))}getOptions(e){let t;return e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new E,this.options)),t}executeWithRetry(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function*(){if(yield this.nextMiddleware.execute(e),t<n.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&n.shouldRetry(n.delay,t,e.request,e.options,e.response)){++t,v(e.request,e.options,A.RETRY_ATTEMPT_HEADER,t.toString());const o=this.getDelay(e.response,t,n.delay);return yield this.sleep(o),yield this.executeWithRetry(e,t,n)}}))}execute(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t=this.getOptions(e);return _.updateFeatureUsageFlag(e,w.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,t)}))}setNext(e){this.nextMiddleware=e}}A.RETRY_STATUS_CODES=[429,503,504],A.RETRY_ATTEMPT_HEADER="Retry-Attempt",A.RETRY_AFTER_HEADER="Retry-After";class I{constructor(e=I.DEFAULT_MAX_REDIRECTS,t=I.defaultShouldRedirect){if(e>I.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${I.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}I.DEFAULT_MAX_REDIRECTS=5,I.MAX_MAX_REDIRECTS=20,I.defaultShouldRedirect=()=>!0;class P{constructor(e=new I){this.options=e}isRedirect(e){return-1!==P.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(P.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(P.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const n=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,o=n.exec(e);let r,s;null!==o&&(r=o[0]);const i=n.exec(t);return null!==i&&(s=i[0]),void 0!==r&&void 0!==s&&r!==s}updateRequestUrl(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){var n,o;t.request="string"==typeof t.request?e:yield(n=e,o=t.request,(0,r.__awaiter)(void 0,void 0,void 0,(function*(){const e=o.headers.get("Content-Type")?yield o.blob():yield Promise.resolve(void 0),{method:t,headers:r,referrer:s,referrerPolicy:i,mode:a,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:p}=o;return new Request(n,{method:t,headers:r,body:e,referrer:s,referrerPolicy:i,mode:a,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:p})})))}))}getOptions(e){let t;return e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(I)),void 0===t&&(t=Object.assign(new I,this.options)),t}executeWithRedirect(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function*(){yield this.nextMiddleware.execute(e);const r=e.response;if(t<n.maxRedirects&&this.isRedirect(r)&&this.hasLocationHeader(r)&&n.shouldRedirect(r)){if(++t,r.status===P.STATUS_CODE_SEE_OTHER)e.options.method=o.GET,delete e.options.body;else{const t=this.getLocationHeader(r);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(r.url,t)&&delete e.options.headers[P.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,n)}}))}execute(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t=this.getOptions(e);return e.options.redirect=P.MANUAL_REDIRECT,_.updateFeatureUsageFlag(e,w.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,t)}))}setNext(e){this.nextMiddleware=e}}P.REDIRECT_STATUS_CODES=[301,302,303,307,308],P.STATUS_CODE_SEE_OTHER=303,P.LOCATION_HEADER="Location",P.AUTHORIZATION_HEADER="Authorization",P.MANUAL_REDIRECT="manual";class M{execute(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t="string"==typeof e.request?e.request:e.request.url;if(d(t)||e.customHosts&&h(t,e.customHosts)){let t=y(e.request,e.options,M.CLIENT_REQUEST_ID_HEADER);t||(t=m(),v(e.request,e.options,M.CLIENT_REQUEST_ID_HEADER,t));let n,o=`${M.PRODUCT_NAME}/3.0.7`;if(e.middlewareControl instanceof g&&(n=e.middlewareControl.getMiddlewareOptions(_)),n){const e=n.getFeatureUsage();o+=` (${M.FEATURE_USAGE_STRING}=${e})`}b(e.request,e.options,M.SDK_VERSION_HEADER,o)}else delete e.options.headers[M.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[M.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)}))}setNext(e){this.nextMiddleware=e}}M.CLIENT_REQUEST_ID_HEADER="client-request-id",M.SDK_VERSION_HEADER="SdkVersion",M.PRODUCT_NAME="graph-js",M.FEATURE_USAGE_STRING="featureUsage";class x{static getDefaultMiddlewareChain(e){const t=[],n=new C(e),o=new A(new E),r=new M,s=new k;if(t.push(n),t.push(o),"object"==typeof process){const e=new P(new I);t.push(e)}return t.push(r),t.push(s),t}}!function(e){e[e.MANUAL=0]="MANUAL",e[e.RANDOM=1]="RANDOM"}(T||(T={}));class R{constructor(e=T.RANDOM,t="Some error Happened",n,o,r,s){if(this.chaosStrategy=e,this.statusCode=n,this.statusMessage=t,this.chaosPercentage=void 0!==o?o:10,this.responseBody=r,this.headers=s,this.chaosPercentage>100)throw new Error("Error Pecentage can not be more than 100")}}const D={GET:[429,500,502,503,504],POST:[429,500,502,503,504,507],PUT:[429,500,502,503,504,507],PATCH:[429,500,502,503,504],DELETE:[429,500,502,503,504,507]},O={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};class N{constructor(e=new R,t){this.options=e,this.manualMap=t}createResponseHeaders(e,t,n){const o=e.headers?new Headers(e.headers):new Headers;return o.append("Cache-Control","no-store"),o.append("request-id",t),o.append("client-request-id",t),o.append("x-ms-ags-diagnostic",""),o.append("Date",n),o.append("Strict-Transport-Security",""),429===e.statusCode&&o.append("retry-after","3"),o}createResponseBody(e,t,n){if(e.responseBody)return e.responseBody;let o;return o=e.statusCode>=400?{error:{code:O[e.statusCode],message:e.statusMessage,innerError:{"request-id":t,date:n}}}:{},o}createResponse(e,t){const n=t.request,o=m(),r=new Date,s=this.createResponseHeaders(e,o,r.toString()),i=this.createResponseBody(e,o,r.toString()),a={url:n,status:e.statusCode,statusText:e.statusMessage,headers:s};t.response=new Response("string"==typeof i?i:JSON.stringify(i),a)}sendRequest(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){this.setStatusCode(e,t.request,t.options.method),e.chaosStrategy===T.MANUAL&&!this.nextMiddleware||Math.floor(100*Math.random())<e.chaosPercentage?this.createResponse(e,t):this.nextMiddleware&&(yield this.nextMiddleware.execute(t))}))}getRandomStatusCode(e){const t=D[e];return t[Math.floor(Math.random()*t.length)]}getRelativeURL(e){const t=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let n;return null!==t.exec(e)&&(n=t.exec(e)[1]),n}setStatusCode(e,t,n){if(e.chaosStrategy===T.MANUAL){if(void 0===e.statusCode){const o=this.getRelativeURL(t);void 0!==this.manualMap.get(o)?void 0!==this.manualMap.get(o).get(n)&&(e.statusCode=this.manualMap.get(o).get(n)):this.manualMap.forEach(((t,r)=>{new RegExp(r+"$").test(o)&&void 0!==this.manualMap.get(r).get(n)&&(e.statusCode=this.manualMap.get(r).get(n))}))}}else e.statusCode=this.getRandomStatusCode(n)}getOptions(e){let t;return e.middlewareControl instanceof g&&(t=e.middlewareControl.getMiddlewareOptions(R)),void 0===t&&(t=Object.assign(new R,this.options)),t}execute(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t=this.getOptions(e);return yield this.sendRequest(t,e)}))}setNext(e){this.nextMiddleware=e}}var L,F,B,W;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(L||(L={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(F||(F={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(B||(B={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(W||(W={}));class U{static parseDocumentResponse(e,t){return"undefined"!=typeof DOMParser?new Promise(((n,o)=>{e.text().then((e=>{try{const o=(new DOMParser).parseFromString(e,t);n(o)}catch(e){o(e)}}))})):Promise.resolve(e.body)}static convertResponse(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){if(204===e.status)return Promise.resolve();let n;const o=e.headers.get("Content-type");switch(t){case L.ARRAYBUFFER:n=yield e.arrayBuffer();break;case L.BLOB:n=yield e.blob();break;case L.DOCUMENT:n=yield U.parseDocumentResponse(e,F.TEXT_XML);break;case L.JSON:n=yield e.json();break;case L.STREAM:n=yield Promise.resolve(e.body);break;case L.TEXT:n=yield e.text();break;default:if(null!==o){const t=o.split(";")[0];n=new RegExp(W.DOCUMENT).test(t)?yield U.parseDocumentResponse(e,t):new RegExp(W.IMAGE).test(t)?e.blob():t===B.TEXT_PLAIN?yield e.text():t===B.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else n=Promise.resolve(e.body)}return n}))}static getResponse(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function*(){if(t===L.RAW)return Promise.resolve(e);{const o=yield U.convertResponse(e,t);if(!e.ok)throw o;if("function"!=typeof n)return o;n(null,o)}}))}}class G{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class H{get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}constructor(e,t){this._location=t,this._responseBody=e}static CreateUploadResult(e,t){return new H(e,t.get("location"))}}class q{static createUploadSession(e,t,n,o={}){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const r=yield e.api(t).headers(o).post(n);return{url:r.uploadUrl,expiry:new Date(r.expirationDateTime),isCancelled:!1}}))}constructor(e,t,n,o={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,!t.sliceFile)throw new l("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,this.file=t,o.rangeSize||(o.rangeSize=this.DEFAULT_FILE_SIZE),this.options=o,this.uploadSession=n,this.nextRange=new G(0,this.options.rangeSize-1)}parseRange(e){const t=e[0];if(void 0===t||""===t)return new G;const n=t.split("-"),o=parseInt(n[0],10);let r=parseInt(n[1],10);return Number.isNaN(r)&&(r=this.file.size-1),new G(o,r)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new G(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new l("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(-1===t.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const n=yield this.file.sliceFile(t),o=yield this.uploadSliceGetRawResponse(n,t,this.file.size);if(!o)throw new l("Something went wrong! Large file upload slice response is null.");const r=yield U.getResponse(o);if(201===o.status||200===o.status&&r.id)return this.reportProgress(e,t),H.CreateUploadResult(r,o.headers);const s={expirationDateTime:r.expirationDateTime||r.ExpirationDateTime,nextExpectedRanges:r.NextExpectedRanges||r.nextExpectedRanges};this.updateTaskStatus(s),this.reportProgress(e,t)}}))}reportProgress(e,t){e&&e.progress&&e.progress(t,e.extraCallbackParam)}uploadSlice(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${n}`,"Content-Type":"application/octet-stream"}).put(e)}))}uploadSliceGetRawResponse(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${n}`,"Content-Type":"application/octet-stream"}).responseType(L.RAW).put(e)}))}cancel(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).responseType(L.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e}))}getStatus(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}))}resume(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){return yield this.getStatus(),yield this.upload()}))}getUploadSession(){return this.uploadSession}}class ${constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new l("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}const V=(e=5242880)=>{const t=62914560;return e>t&&(e=t),(n=e)>327680&&(n=320*Math.floor(n/327680)*1024),n;var n};class j extends q{static constructCreateSessionUrl(e,t=j.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map((e=>encodeURIComponent(e))).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let n,o;if("undefined"!=typeof Blob&&e instanceof Blob)n=new File([e],t),o=n.size;else if("undefined"!=typeof File&&e instanceof File)n=e,o=n.size;else if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array){const t=e;o=t.byteLength,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:n,size:o}}static create(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t||!n)throw new l("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const o=n.fileName,r=j.getFileInfo(t,o),s=new $(r.content,o,r.size);return this.createTaskWithFileObject(e,s,n)}))}static createTaskWithFileObject(e,t,n){return(0,r.__awaiter)(this,void 0,void 0,(function*(){if(!e||!t||!n)throw new l("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const o=n.uploadSessionURL?n.uploadSessionURL:j.constructCreateSessionUrl(n.fileName,n.path),r={fileName:n.fileName,fileDescription:n.fileDescription,conflictBehavior:n.conflictBehavior},s=yield j.createUploadSession(e,o,r),i=V(n.rangeSize);return new j(e,t,s,{rangeSize:i,uploadEventHandlers:n.uploadEventHandlers})}))}static createUploadSession(e,t,n){const o=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return(0,r.__awaiter)(this,void 0,void 0,(function*(){const r={item:{"@microsoft.graph.conflictBehavior":(null==n?void 0:n.conflictBehavior)||"rename",name:null==n?void 0:n.fileName,description:null==n?void 0:n.fileDescription}};return o.createUploadSession.call(this,e,t,r)}))}constructor(e,t,n,o){super(e,t,n,o)}commit(e,t="rename"){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const n={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(n)}))}}j.DEFAULT_UPLOAD_PATH="/";class z{constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new l("Please provide the Readable Stream content, name of the file and size of the file")}sliceFile(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){let t=e.maxValue-e.minValue+1;const n=[];if(this.previousSlice){if(e.minValue<this.previousSlice.range.minValue)throw new l("An error occurred while uploading the stream. Please restart the stream upload from the first byte of the file.");if(e.minValue<this.previousSlice.range.maxValue){const o=this.previousSlice.range.minValue,r=this.previousSlice.range.maxValue;if(e.minValue===o&&e.maxValue===r)return this.previousSlice.fileSlice;if(e.maxValue===r)return this.previousSlice.fileSlice.slice(e.minValue,e.maxValue+1);n.push(this.previousSlice.fileSlice.slice(e.minValue,r+1)),t=e.maxValue-r}}if(!this.content||!this.content.readable)throw new l("Stream is not readable.");this.content.readableLength>=t?n.push(this.content.read(t)):n.push(yield this.readNBytesFromStream(t));const o=Buffer.concat(n);return this.previousSlice={fileSlice:o,range:e},o}))}readNBytesFromStream(e){return new Promise(((t,n)=>{const o=[];let r=e,s=0;this.content.on("end",(()=>{if(r>0)return n(new l("Stream ended before reading required range size"))})),this.content.on("readable",(()=>{let i;for(;s<e&&null!==(i=this.content.read(r));)s+=i.length,o.push(i),r>0&&(r=e-s);return s===e?t(Buffer.concat(o)):this.content&&this.content.readable?void 0:n(new l("Error encountered while reading the stream during the upload"))}))}))}}class Q{constructor(e,t,n,o){this.client=e,this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"],this.callback=n,this.cursor=0,this.complete=!1,this.requestOptions=o}iterationHelper(){if(void 0===this.collection)return!1;let e=!0;for(;e&&this.cursor<this.collection.length;){const t=this.collection[this.cursor];e=this.callback(t),this.cursor++}return e}fetchAndUpdateNextPageData(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){let e=this.client.api(this.nextLink);this.requestOptions&&(this.requestOptions.headers&&(e=e.headers(this.requestOptions.headers)),this.requestOptions.middlewareOptions&&(e=e.middlewareOptions(this.requestOptions.middlewareOptions)),this.requestOptions.options&&(e=e.options(this.requestOptions.options)));const t=yield e.get();this.collection=t.value,this.cursor=0,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"]}))}getDeltaLink(){return this.deltaLink}iterate(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){let e=this.iterationHelper();for(;e;)void 0!==this.nextLink?(yield this.fetchAndUpdateNextPageData(),e=this.iterationHelper()):e=!1;void 0===this.nextLink&&this.cursor>=this.collection.length&&(this.complete=!0)}))}resume(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){return this.iterate()}))}isComplete(){return this.complete}}class J{constructor(e){this.provider=e}getAccessToken(){return(0,r.__awaiter)(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.provider(((n,o)=>(0,r.__awaiter)(this,void 0,void 0,(function*(){if(o)e(o);else{n||(n=new l("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md"));const e=yield l.setGraphClientError(n);t(e)}}))))}))}))}}class K extends Error{constructor(e=-1,t,n){super(t||n&&n.message),Object.setPrototypeOf(this,K.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=n?n.stack:this.stack}}class Y{static constructError(e,t,n){const o=new K(t,"",e);return void 0!==e.name&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o.headers=null==n?void 0:n.headers,o}static constructErrorFromResponse(e,t,n){const o=e.error,r=new K(t,o.message);return r.code=o.code,void 0!==o.innerError&&(r.requestId=o.innerError["request-id"],r.date=new Date(o.innerError.date)),r.body=JSON.stringify(o),r.headers=null==n?void 0:n.headers,r}static getError(e=null,t=-1,n,o){return(0,r.__awaiter)(this,void 0,void 0,(function*(){let r;if(e&&e.error?r=Y.constructErrorFromResponse(e,t,o):e instanceof Error?r=Y.constructError(e,t,o):(r=new K(t),r.body=e),"function"!=typeof n)return r;n(r,null)}))}}class X{constructor(e,t,n){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const n=e.indexOf("/");-1!==n&&(this.urlComponents.version=e.substring(0,n),e=e.substring(n+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const n=e.substring(t+1,e.length).split("&");for(const e of n)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}addCsvQueryParameter(e,t,n){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let o=[];n.length>1&&"string"==typeof t?o=Array.prototype.slice.call(n):"string"==typeof t?o.push(t):o=o.concat(t),this.urlComponents.oDataQueryParams[e]+=o.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce(((e,n)=>{return[(o=e,o.replace(/\/+$/,"")),t(n)].join("/");var o}))})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const n in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,n)&&t.push(n+"="+e.oDataQueryParams[n]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const n in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,n)&&t.push(n+"="+e.otherURLQueryParams[n]);if(0!==e.otherURLQueryOptions.length)for(const n of e.otherURLQueryOptions)t.push(n);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),n=e.substring(0,t),o=e.substring(t+1);this.setURLComponentsQueryParamater(n,o)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==c.indexOf(e)){const n=this.urlComponents.oDataQueryParams[e],o=n&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=o?n+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,n){var o;return(0,r.__awaiter)(this,void 0,void 0,(function*(){let r;const s=new g(this._middlewareOptions);this.updateRequestOptions(t);const i=null===(o=this.config)||void 0===o?void 0:o.customHosts;try{return r=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:s,customHosts:i})).response,yield U.getResponse(r,this._responseType,n)}catch(e){if(e instanceof l)throw e;let t;throw r&&(t=r.status),yield Y.getError(e,t,n,r)}}))}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:o.GET};return yield this.send(t,n,e)}))}post(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),r={method:o.POST,body:u(e)};return"FormData"===(e&&e.constructor&&e.constructor.name)?r.headers={}:(this.setHeaderContentType(),r.headers=this._headers),yield this.send(n,r,t)}))}create(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){return yield this.post(e,t)}))}put(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const r={method:o.PUT,body:u(e)};return yield this.send(n,r,t)}))}patch(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const n=this.buildFullUrl();this.setHeaderContentType();const r={method:o.PATCH,body:u(e)};return yield this.send(n,r,t)}))}update(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){return yield this.patch(e,t)}))}delete(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:o.DELETE};return yield this.send(t,n,e)}))}del(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){return yield this.delete(e)}))}getStream(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const t=this.buildFullUrl(),n={method:o.GET};return this.responseType(L.STREAM),yield this.send(t,n,e)}))}putStream(e,t){return(0,r.__awaiter)(this,void 0,void 0,(function*(){const n=this.buildFullUrl(),r={method:o.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(n,r,t)}))}}class Z{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach(((t,n)=>{n<e.length-1&&t.setNext(e[n+1])})),this.middleware=e[0]}sendRequest(e){return(0,r.__awaiter)(this,void 0,void 0,(function*(){if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e}))}}class ee{static createWithAuthenticationProvider(e){const t=new C(e),n=new A(new E),o=new M,r=new k;if(t.setNext(n),"object"==typeof process){const e=new P(new I);n.setNext(e),e.setNext(o)}else n.setNext(o);return o.setNext(r),ee.createWithMiddleware(t)}static createWithMiddleware(...e){return new Z(...e)}}class te{static init(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="authProvider"===n?new J(e[n]):e[n]);return te.initWithMiddleware(t)}static initWithMiddleware(e){return new te(e)}constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})();for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=ee.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new Z(...[].concat(e.middleware))}this.httpClient=t}api(e){return new X(this.httpClient,this.config,e)}}},73172:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomAuthenticationProvider=void 0;var o=n(67524),r=n(63465),s=function(){function e(e){this.provider=e}return e.prototype.getAccessToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var e=this;return o.__generator(this,(function(t){return[2,new Promise((function(t,n){e.provider((function(s,i){return o.__awaiter(e,void 0,void 0,(function(){var e;return o.__generator(this,(function(o){switch(o.label){case 0:return i?(t(i),[3,3]):[3,1];case 1:return s||(s=new r.GraphClientError("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md")),[4,r.GraphClientError.setGraphClientError(s)];case 2:e=o.sent(),n(e),o.label=3;case 3:return[2]}}))}))}))}))]}))}))},e}();t.CustomAuthenticationProvider=s},63465:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GraphClientError=void 0;var o=n(67524),r=function(e){function t(n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o}return o.__extends(t,e),t.setGraphClientError=function(e){var n;return e instanceof Error?n=e:(n=new t).customError=e,n},t}(Error);t.GraphClientError=r},96675:(e,t,n)=>{"use strict";var o;n.d(t,{q:()=>l}),function(e){var t,n=0;e.getNext=function(){return void 0===t&&(t=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[],n=0;n<22;n++)t.push(e.charAt(Math.floor(64*Math.random())));return t.join("")}()),new o(t,++n)},e.getNextChild=function(e){return new o(e.getString(),++e.nextChild)};var o=function(){function e(e,t){this.base=e,this.id=t,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=o}(o||(o={}));var r=n(21681),s=function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))},i=function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},a=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(a=function(){return 1e3*Math.floor(window.performance.now())});var l=function(){function e(e,t,n){this._optionalEventFlags={},this._ended=!1,this._telemetryLogger=e,this._activityName=t,this._cv=n?o.getNextChild(n._cv):o.getNext(),this._dataFields=[],this._success=void 0,this._startTime=a()}return e.createNew=function(t,n){return new e(t,n)},e.prototype.createChildActivity=function(t){return new e(this._telemetryLogger,t,this)},e.prototype.setEventFlags=function(e){this._optionalEventFlags=e},e.prototype.addDataField=function(e){this._dataFields.push(e)},e.prototype.addDataFields=function(e){var t;(t=this._dataFields).push.apply(t,e)},e.prototype.setSuccess=function(e){this._success=e},e.prototype.setResult=function(e,t,n){this._result={code:e,type:t,tag:n}},e.prototype.endNow=function(){if(!this._ended){void 0===this._success&&void 0===this._result&&(0,r.wC)(r.$b.Warning,r.b7.Core,(function(){return"Activity does not have success or result set"}));var e=a()-this._startTime;this._ended=!0;var t={duration:e,count:1,aggMode:0,cV:this._cv.getString(),success:this._success,result:this._result};return this._telemetryLogger.sendActivity(this._activityName,t,this._dataFields,this._optionalEventFlags)}(0,r.wC)(r.$b.Error,r.b7.Core,(function(){return"Activity has already ended"}))},e.prototype.executeAsync=function(e){return s(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){return[2,e(this).then((function(e){return t.endNow(),e})).catch((function(e){throw t.endNow(),e}))]}))}))},e.prototype.executeSync=function(e){try{var t=e(this);return this.endNow(),t}catch(e){throw this.endNow(),e}},e.prototype.executeChildActivityAsync=function(e,t){return s(this,void 0,void 0,(function(){return i(this,(function(n){return[2,this.createChildActivity(e).executeAsync(t)]}))}))},e.prototype.executeChildActivitySync=function(e,t){return this.createChildActivity(e).executeSync(t)},e}()},82101:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var o=n(30227);function r(e,t,n){e.push((0,o.m9)("zC."+t,n))}},96550:(e,t,n)=>{"use strict";n.d(t,{P:()=>r});var o=n(82101);function r(e,t,n){var r=n.map((function(t){return{name:e+"."+t.name,value:t.value,dataType:t.dataType}}));return(0,o.w)(r,e,t),r}},9751:(e,t,n)=>{"use strict";var o;n.d(t,{p:()=>o}),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(o||(o={}))},54243:()=>{},30227:(e,t,n)=>{"use strict";n.d(t,{LK:()=>s,Ug:()=>i,ip:()=>a,k:()=>c,m9:()=>l});var o=n(37435),r=n(9751);function s(e,t){return{name:e,dataType:o.b.Boolean,value:t,classification:r.p.SystemMetadata}}function i(e,t){return{name:e,dataType:o.b.Int64,value:t,classification:r.p.SystemMetadata}}function a(e,t){return{name:e,dataType:o.b.Double,value:t,classification:r.p.SystemMetadata}}function l(e,t){return{name:e,dataType:o.b.String,value:t,classification:r.p.SystemMetadata}}function c(e,t){return{name:e,dataType:o.b.Guid,value:t,classification:r.p.SystemMetadata}}},37435:(e,t,n)=>{"use strict";var o;n.d(t,{b:()=>o}),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(o||(o={}))},75255:(e,t,n)=>{"use strict";n.d(t,{J:()=>o});var o=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}()},97131:(e,t,n)=>{"use strict";n.d(t,{H:()=>s});var o=n(81701),r=n(21681);function s(e){var t={costPriority:o.Mx.Normal,samplingPolicy:o.A2.Measure,persistencePriority:o.qu.Normal,dataCategories:o.b5.NotSet,diagnosticLevel:o.EP.FullEvent};return e.eventFlags&&e.eventFlags.dataCategories||(0,r.wC)(r.$b.Error,r.b7.Core,(function(){return"Event is missing DataCategories event flag"})),e.eventFlags?(e.eventFlags.costPriority&&(t.costPriority=e.eventFlags.costPriority),e.eventFlags.samplingPolicy&&(t.samplingPolicy=e.eventFlags.samplingPolicy),e.eventFlags.persistencePriority&&(t.persistencePriority=e.eventFlags.persistencePriority),e.eventFlags.dataCategories&&(t.dataCategories=e.eventFlags.dataCategories),e.eventFlags.diagnosticLevel&&(t.diagnosticLevel=e.eventFlags.diagnosticLevel),t):t}},81701:(e,t,n)=>{"use strict";var o,r,s,i,a;n.d(t,{A2:()=>o,EP:()=>a,Mx:()=>s,b5:()=>i,qu:()=>r}),function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(o||(o={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(r||(r={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(s||(s={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(i||(i={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(a||(a={}))},21681:(e,t,n)=>{"use strict";n.d(t,{$b:()=>o,b7:()=>r,d$:()=>i,vV:()=>l,wC:()=>a});var o,r,s=new(n(75255).J);function i(){return s}function a(e,t,n){s.fireEvent({level:e,category:t,message:n})}function l(e,t,n){a(o.Error,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(o||(o={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(r||(r={}))},49068:()=>{},80889:(e,t,n)=>{"use strict";n.d(t,{G:()=>p,d:()=>h});var o,r,s=n(57118),i=n(21681);!function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(o||(o={})),function(e){var t={},n={},r={};function s(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");r=u(r,e)}function a(e){if(t[e])return t[e];var n=c(e,o.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function l(e){if(n[e])return n[e];var t=c(e,o.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function c(e,t){var n=e.split("."),s=r,i=void 0;if(s){for(var a=0;a<n.length-1;a++)s[n[a]]&&(s=s[n[a]],t===o.Aria&&"string"==typeof s.ariaTenantToken?i=s.ariaTenantToken:t===o.Nexus&&"number"==typeof s.nexusTenantToken&&(i=s.nexusTenantToken));return i}}function u(e,t){if("object"!=typeof t)return t;for(var n=0,o=Object.keys(t);n<o.length;n++){var r=o[n];r in e&&(e[r],1)?e[r]=u(e[r],t[r]):e[r]=t[r]}return e}e.setTenantToken=function(e,t,n){var o=e.split(".");if(o.length<2||"Office"!==o[0])(0,i.wC)(i.$b.Error,i.b7.Core,(function(){return"Invalid namespace: "+e}));else{var r=Object.create(Object.prototype);t&&(r.ariaTenantToken=t),n&&(r.nexusTenantToken=n);var a,l=r;for(a=o.length-1;a>=0;--a){var c=Object.create(Object.prototype);c[o[a]]=l,l=c}s(l)}},e.setTenantTokens=s,e.getTenantTokens=function(e){var t=a(e),n=l(e);if(!n||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=a,e.getNexusTenantToken=l,e.clear=function(){t={},n={},r={}}}(r||(r={}));var a,l=n(37435);!function(e){var t=-9007199254740991,n=9007199254740991,o=/^[A-Z][a-zA-Z0-9]*$/,r=/^[a-zA-Z0-9_\.]*$/;function s(e){return void 0!==e&&r.test(e)}function i(e){if(!((t=e.name)&&s(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===l.b.Int64&&a(e.value)}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<t||e>n)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var t,n=e.split("."),r=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(void 0!==(t=r)&&o.test(t))}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!s(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var t=0;t<e.dataFields.length;t++)i(e.dataFields[t])},e.validateInt=a}(a||(a={}));var c=n(75255),u=n(30227),d=function(){return d=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},d.apply(this,arguments)},h=-1,p=function(){function e(e,t,n){var o,r;this.onSendEvent=new c.J,this.persistentDataFields=[],this.config=n||{},e&&(this.onSendEvent=e.onSendEvent,(o=this.persistentDataFields).push.apply(o,e.persistentDataFields),this.config=d(d({},e.getConfig()),this.config)),t&&(r=this.persistentDataFields).push.apply(r,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void(0,i.wC)(i.$b.Warning,i.b7.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(e){return void(0,i.vV)(i.b7.Core,"SendTelemetryEvent",e)}try{this.onSendEvent.fireEvent(t)}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=r.getTenantTokens(e.eventName)),e.dataFields&&(e.dataFields.unshift((0,u.m9)("OTelJS.Version","3.1.74")),this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields)),this.config.disableValidation||a.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){r.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){r.setTenantTokens(e)},e.prototype.cloneEvent=function(e){return(0,s.E)(e)},e.prototype.getConfig=function(){return this.config},e}()},57118:(e,t,n)=>{"use strict";function o(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t}n.d(t,{E:()=>o})},28932:(e,t,n)=>{"use strict";n.d(t,{M:()=>l});var o,r=n(80889),s=n(96675),i=n(26501),a=(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.executeActivityAsync=function(e,t){return n=this,o=void 0,s=function(){return function(e,t){var n,o,r,s,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return i.label++,{value:s[1],done:!1};case 5:i.label++,o=s[1],s=[0];continue;case 7:s=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){i=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){i.label=s[1];break}if(6===s[0]&&i.label<r[1]){i.label=r[1],r=s;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(s);break}r[2]&&i.ops.pop(),i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}(this,(function(n){return[2,this.createNewActivity(e).executeAsync(t)]}))},new((r=void 0)||(r=Promise))((function(e,t){function i(e){try{l(s.next(e))}catch(e){t(e)}}function a(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(i,a)}l((s=s.apply(n,o||[])).next())}));var n,o,r,s},t.prototype.executeActivitySync=function(e,t){return this.createNewActivity(e).executeSync(t)},t.prototype.createNewActivity=function(e){return s.q.createNew(this,e)},t.prototype.sendActivity=function(e,t,n,o){return this.sendTelemetryEvent({eventName:e,eventContract:{name:i.A.Office.System.Activity.contractName,dataFields:i.A.Office.System.Activity.getFields(t)},dataFields:n,eventFlags:o})},t.prototype.sendError=function(e){var t=i.A.Office.System.Error.getFields("Error",e.error);return null!=e.dataFields&&t.push.apply(t,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:t,eventFlags:e.eventFlags})},t}(r.G)},11761:()=>{},93815:()=>{},26501:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var o,r,s,i,a,l,c,u,d=n(30227),h=n(82101);!function(e){e.getFields=function(e,t){var n=[];return n.push((0,d.Ug)(e+".Code",t.code)),void 0!==t.type&&n.push((0,d.m9)(e+".Type",t.type)),void 0!==t.tag&&n.push((0,d.Ug)(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push((0,d.LK)(e+".IsExpected",t.isExpected)),(0,h.w)(n,e,"Office.System.Result"),n}}(o||(o={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var n="Activity",r=[];return void 0!==t.cV&&r.push((0,d.m9)(n+".CV",t.cV)),r.push((0,d.Ug)(n+".Duration",t.duration)),r.push((0,d.Ug)(n+".Count",t.count)),r.push((0,d.Ug)(n+".AggMode",t.aggMode)),void 0!==t.success&&r.push((0,d.LK)(n+".Success",t.success)),void 0!==t.result&&r.push.apply(r,o.getFields(n+".Result",t.result)),(0,h.w)(r,n,e.contractName),r}}(r||(r={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,d.m9)(e+".Id",t.id)),void 0!==t.version&&n.push((0,d.m9)(e+".Version",t.version)),void 0!==t.sessionId&&n.push((0,d.m9)(e+".SessionId",t.sessionId)),(0,h.w)(n,e,"Office.System.Host"),n}}(s||(s={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push((0,d.m9)(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push((0,d.m9)(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push((0,d.m9)(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push((0,d.m9)(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push((0,d.m9)(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push((0,d.LK)(e+".IsAnonymous",t.isAnonymous)),(0,h.w)(n,e,"Office.System.User"),n}}(i||(i={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,d.m9)(e+".Id",t.id)),void 0!==t.version&&n.push((0,d.m9)(e+".Version",t.version)),void 0!==t.instanceId&&n.push((0,d.m9)(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push((0,d.m9)(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push((0,d.m9)(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push((0,d.m9)(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push((0,d.m9)(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push((0,d.m9)(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push((0,d.m9)(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push((0,d.m9)(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push((0,d.m9)(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push((0,d.m9)(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push((0,d.m9)(e+".Type",t.type)),(0,h.w)(n,e,"Office.System.SDX"),n}}(a||(a={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.name&&n.push((0,d.m9)(e+".Name",t.name)),void 0!==t.state&&n.push((0,d.m9)(e+".State",t.state)),(0,h.w)(n,e,"Office.System.Funnel"),n}}(l||(l={})),function(e){e.getFields=function(e,t){var n=[];return void 0!==t.id&&n.push((0,d.Ug)(e+".Id",t.id)),void 0!==t.name&&n.push((0,d.m9)(e+".Name",t.name)),void 0!==t.commandSurface&&n.push((0,d.m9)(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push((0,d.m9)(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push((0,d.m9)(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push((0,d.Ug)(e+".TimeOffsetMs",t.timeOffsetMs)),(0,h.w)(n,e,"Office.System.UserAction"),n}}(c||(c={})),function(e){e.getFields=function(e,t){var n=[];return n.push((0,d.m9)(e+".ErrorGroup",t.errorGroup)),n.push((0,d.Ug)(e+".Tag",t.tag)),void 0!==t.code&&n.push((0,d.Ug)(e+".Code",t.code)),void 0!==t.id&&n.push((0,d.Ug)(e+".Id",t.id)),void 0!==t.count&&n.push((0,d.Ug)(e+".Count",t.count)),(0,h.w)(n,e,"Office.System.Error"),n}}(u||(u={}));var p,f=r,g=o,m=u,y=l,v=s,b=a,S=c,w=i;!function(e){var t,n;t=e.Office||(e.Office={}),(n=t.System||(t.System={})).Activity=f,n.Result=g,n.Error=m,n.Funnel=y,n.Host=v,n.SDX=b,n.User=w,n.UserAction=S}(p||(p={}))},1059:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ActivityScope:()=>r.q,Category:()=>g.b7,Contracts:()=>o.A,CostPriority:()=>p.Mx,DataCategories:()=>p.b5,DataClassification:()=>a.p,DataFieldType:()=>d.b,DiagnosticLevel:()=>p.EP,LogLevel:()=>g.$b,PersistencePriority:()=>p.qu,SamplingPolicy:()=>p.A2,SimpleTelemetryLogger:()=>m.G,SuppressNexus:()=>m.d,TelemetryLogger:()=>y.M,addContractField:()=>s.w,cloneEvent:()=>v.E,getEffectiveEventFlags:()=>h.H,getFieldsForContract:()=>i.P,logError:()=>g.vV,logNotification:()=>g.wC,makeBooleanDataField:()=>u.LK,makeDoubleDataField:()=>u.ip,makeGuidDataField:()=>u.k,makeInt64DataField:()=>u.Ug,makeStringDataField:()=>u.m9,onNotification:()=>g.d$});var o=n(26501),r=n(96675),s=n(82101),i=n(96550),a=n(9751),l=n(54243),c={};for(const e in l)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification"].indexOf(e)<0&&(c[e]=()=>l[e]);n.d(t,c);var u=n(30227),d=n(37435),h=n(97131),p=n(81701),f=n(49068);c={};for(const e in f)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy"].indexOf(e)<0&&(c[e]=()=>f[e]);n.d(t,c);var g=n(21681),m=n(80889),y=n(28932),v=n(57118),b=n(11761);c={};for(const e in b)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy","Category","LogLevel","logError","logNotification","onNotification","SimpleTelemetryLogger","SuppressNexus","TelemetryLogger","cloneEvent"].indexOf(e)<0&&(c[e]=()=>b[e]);n.d(t,c);var S=n(93815);c={};for(const e in S)["default","Contracts","ActivityScope","addContractField","getFieldsForContract","DataClassification","makeBooleanDataField","makeDoubleDataField","makeGuidDataField","makeInt64DataField","makeStringDataField","DataFieldType","getEffectiveEventFlags","CostPriority","DataCategories","DiagnosticLevel","PersistencePriority","SamplingPolicy","Category","LogLevel","logError","logNotification","onNotification","SimpleTelemetryLogger","SuppressNexus","TelemetryLogger","cloneEvent"].indexOf(e)<0&&(c[e]=()=>S[e]);n.d(t,c)},8436:(e,t,n)=>{"use strict";n.d(t,{a:()=>u});var o=n(98670),r=n(26166),s=n(68761),i=n(94857),a=n(14429),l=n(59658),c=n(87071);function u(e,t){void 0===t&&(t={});var n=t.factoryOptions,u=(void 0===n?{}:n).defaultProp,h=function(n){var l,c,u,h,p=(l=t.displayName,c=r.useContext(i.z),u=t.fields,h=["theme","styles","tokens"],a.X.getSettings(u||h,l,c.customizations)),f=t.state;f&&(n=(0,o.Cl)((0,o.Cl)({},n),f(n)));var g=n.theme||p.theme,m=d(n,g,t.tokens,p.tokens,n.tokens),y=function(e,t,n){for(var o=[],r=3;r<arguments.length;r++)o[r-3]=arguments[r];return s.concatStyleSets.apply(void 0,o.map((function(o){return"function"==typeof o?o(e,t,n):o})))}(n,g,m,t.styles,p.styles,n.styles),v=(0,o.Cl)((0,o.Cl)({},n),{styles:y,tokens:m,_defaultStyles:y,theme:g});return e(v)};return h.displayName=t.displayName||e.name,u&&(h.create=(0,l.Bw)(h,{defaultProp:u})),(0,c.k)(h,t.statics),h}function d(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];for(var s={},i=0,a=n;i<a.length;i++){var l=a[i];l&&(l="function"==typeof l?l(e,t):l,Array.isArray(l)&&(l=d.apply(void 0,(0,o.aN)([e,t],l))),(0,c.k)(s,l))}return s}},59658:(e,t,n)=>{"use strict";var o;n.d(t,{Bw:()=>d,Sk:()=>p,WL:()=>u});var r=n(98670),s=n(26166),i=n(16536),a=n(38044),l=n(87018),c=n(87071);function u(e,t){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var l=e;return l.isSlot?0===(i=s.Children.toArray(i)).length?l(t):l((0,r.Cl)((0,r.Cl)({},t),{children:i})):s.createElement.apply(o||(o=n.t(s,2)),(0,r.aN)([e,t],i))}function d(e,t){void 0===t&&(t={});var n=t.defaultProp,o=void 0===n?"children":n;return function(t,n,a,u,d){if(s.isValidElement(n))return n;var h=function(e,t){var n,o;return"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,o=n):o=t,o}(o,n),p=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];for(var r={},s=[],a=0,u=n;a<u.length;a++){var d=u[a];s.push(d&&d.className),(0,c.k)(r,d)}return r.className=(0,i.e)([e,s],{rtl:(0,l.jI)(t)}),r}(u,d,t,h);if(a){if(a.component){var f=a.component;return s.createElement(f,(0,r.Cl)({},p))}if(a.render)return a.render(p,e)}return s.createElement(e,(0,r.Cl)({},p))}}var h=(0,a.J9)((function(e){return d(e)}));function p(e,t){var n={},o=e,r=function(e){if(t.hasOwnProperty(e)){var r=function(n){for(var r=[],s=1;s<arguments.length;s++)r[s-1]=arguments[s];if(r.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return function(e,t,n,o,r,s){return void 0!==e.create?e.create(t,n,o,r):h(e)(t,n,o,r,s)}(t[e],n,o[e],o.slots&&o.slots[e],o._defaultStyles&&o._defaultStyles[e],o.theme)};r.isSlot=!0,n[e]=r}};for(var s in t)r(s);return n}},87071:(e,t,n)=>{"use strict";n.d(t,{k:()=>o});var o=n(98670).Cl},34375:(e,t,n)=>{"use strict";n.d(t,{v:()=>A});var o=n(68761);function r(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:"url('"+e+"fabric-icons-a13498cf.woff') format('woff')"},icons:{GlobalNavButton:"",ChevronDown:"",ChevronUp:"",Edit:"",Add:"",Cancel:"",More:"",Settings:"",Mail:"",Filter:"",Search:"",Share:"",BlockedSite:"",FavoriteStar:"",FavoriteStarFill:"",CheckMark:"",Delete:"",ChevronLeft:"",ChevronRight:"",Calendar:"",Megaphone:"",Undo:"",Flag:"",Page:"",Pinned:"",View:"",Clear:"",Download:"",Upload:"",Folder:"",Sort:"",AlignRight:"",AlignLeft:"",Tag:"",AddFriend:"",Info:"",SortLines:"",List:"",CircleRing:"",Heart:"",HeartFill:"",Tiles:"",Embed:"",Glimmer:"",Ascending:"",Descending:"",SortUp:"",SortDown:"",SyncToPC:"",LargeGrid:"",SkypeCheck:"",SkypeClock:"",SkypeMinus:"",ClearFilter:"",Flow:"",StatusCircleCheckmark:"",MoreVertical:""}};(0,o.registerIcons)(n,t)}function s(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-0"',src:"url('"+e+"fabric-icons-0-467ee27f.woff') format('woff')"},icons:{PageLink:"",CommentSolid:"",ChangeEntitlements:"",Installation:"",WebAppBuilderModule:"",WebAppBuilderFragment:"",WebAppBuilderSlot:"",BullseyeTargetEdit:"",WebAppBuilderFragmentCreate:"",PageData:"",PageHeaderEdit:"",ProductList:"",UnpublishContent:"",DependencyAdd:"",DependencyRemove:"",EntitlementPolicy:"",EntitlementRedemption:"",SchoolDataSyncLogo:"",PinSolid12:"",PinSolidOff12:"",AddLink:"",SharepointAppIcon16:"",DataflowsLink:"",TimePicker:"",UserWarning:"",ComplianceAudit:"",InternetSharing:"",Brightness:"",MapPin:"",Airplane:"",Tablet:"",QuickNote:"",Video:"",People:"",Phone:"",Pin:"",Shop:"",Stop:"",Link:"",AllApps:"",Zoom:"",ZoomOut:"",Microphone:"",Camera:"",Attach:"",Send:"",FavoriteList:"",PageSolid:"",Forward:"",Back:"",Refresh:"",Lock:"",ReportHacked:"",EMI:"",MiniLink:"",Blocked:"",ReadingMode:"",Favicon:"",Remove:"",Checkbox:"",CheckboxComposite:"",CheckboxFill:"",CheckboxIndeterminate:"",CheckboxCompositeReversed:"",BackToWindow:"",FullScreen:"",Print:"",Up:"",Down:"",OEM:"",Save:"",ReturnKey:"",Cloud:"",Flashlight:"",CommandPrompt:"",Sad:"",RealEstate:"",SIPMove:"",EraseTool:"",GripperTool:"",Dialpad:"",PageLeft:"",PageRight:"",MultiSelect:"",KeyboardClassic:"",Play:"",Pause:"",InkingTool:"",Emoji2:"",GripperBarHorizontal:"",System:"",Personalize:"",SearchAndApps:"",Globe:"",EaseOfAccess:"",ContactInfo:"",Unpin:"",Contact:"",Memo:"",IncomingCall:""}};(0,o.registerIcons)(n,t)}function i(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-1"',src:"url('"+e+"fabric-icons-1-4d521695.woff') format('woff')"},icons:{Paste:"",WindowsLogo:"",Error:"",GripperBarVertical:"",Unlock:"",Slideshow:"",Trim:"",AutoEnhanceOn:"",AutoEnhanceOff:"",Color:"",SaveAs:"",Light:"",Filters:"",AspectRatio:"",Contrast:"",Redo:"",Crop:"",PhotoCollection:"",Album:"",Rotate:"",PanoIndicator:"",Translate:"",RedEye:"",ViewOriginal:"",ThumbnailView:"",Package:"",Telemarketer:"",Warning:"",Financial:"",Education:"",ShoppingCart:"",Train:"",Move:"",TouchPointer:"",Merge:"",TurnRight:"",Ferry:"",Highlight:"",PowerButton:"",Tab:"",Admin:"",TVMonitor:"",Speakers:"",Game:"",HorizontalTabKey:"",UnstackSelected:"",StackIndicator:"",Nav2DMapView:"",StreetsideSplitMinimize:"",Car:"",Bus:"",EatDrink:"",SeeDo:"",LocationCircle:"",Home:"",SwitcherStartEnd:"",ParkingLocation:"",IncidentTriangle:"",Touch:"",MapDirections:"",CaretHollow:"",CaretSolid:"",History:"",Location:"",MapLayers:"",SearchNearby:"",Work:"",Recent:"",Hotel:"",Bank:"",LocationDot:"",Dictionary:"",ChromeBack:"",FolderOpen:"",PinnedFill:"",RevToggleKey:"",USB:"",Previous:"",Next:"",Sync:"",Help:"",Emoji:"",MailForward:"",ClosePane:"",OpenPane:"",PreviewLink:"",ZoomIn:"",Bookmarks:"",Document:"",ProtectedDocument:"",OpenInNewWindow:"",MailFill:"",ViewAll:"",Switch:"",Rename:"",Go:"",Remote:"",SelectAll:"",Orientation:"",Import:""}};(0,o.registerIcons)(n,t)}function a(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-2"',src:"url('"+e+"fabric-icons-2-63c99abf.woff') format('woff')"},icons:{Picture:"",ChromeClose:"",ShowResults:"",Message:"",CalendarDay:"",CalendarWeek:"",MailReplyAll:"",Read:"",Cut:"",PaymentCard:"",Copy:"",Important:"",MailReply:"",GotoToday:"",Font:"",FontColor:"",FolderFill:"",Permissions:"",DisableUpdates:"",Unfavorite:"",Italic:"",Underline:"",Bold:"",MoveToFolder:"",Dislike:"",Like:"",AlignCenter:"",OpenFile:"",ClearSelection:"",FontDecrease:"",FontIncrease:"",FontSize:"",CellPhone:"",RepeatOne:"",RepeatAll:"",Calculator:"",Library:"",PostUpdate:"",NewFolder:"",CalendarReply:"",UnsyncFolder:"",SyncFolder:"",BlockContact:"",Accept:"",BulletedList:"",Preview:"",News:"",Chat:"",Group:"",World:"",Comment:"",DockLeft:"",DockRight:"",Repair:"",Accounts:"",Street:"",RadioBullet:"",Stopwatch:"",Clock:"",WorldClock:"",AlarmClock:"",Photo:"",ActionCenter:"",Hospital:"",Timer:"",FullCircleMask:"",LocationFill:"",ChromeMinimize:"",ChromeRestore:"",Annotation:"",Fingerprint:"",Handwriting:"",ChromeFullScreen:"",Completed:"",Label:"",FlickDown:"",FlickUp:"",FlickLeft:"",FlickRight:"",MiniExpand:"",MiniContract:"",Streaming:"",MusicInCollection:"",OneDriveLogo:"",CompassNW:"",Code:"",LightningBolt:"",CalculatorMultiply:"",CalculatorAddition:"",CalculatorSubtract:"",CalculatorPercentage:"",CalculatorEqualTo:"",PrintfaxPrinterFile:"",StorageOptical:"",Communications:"",Headset:"",Health:"",Webcam2:"",FrontCamera:"",ChevronUpSmall:""}};(0,o.registerIcons)(n,t)}function l(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-3"',src:"url('"+e+"fabric-icons-3-089e217a.woff') format('woff')"},icons:{ChevronDownSmall:"",ChevronLeftSmall:"",ChevronRightSmall:"",ChevronUpMed:"",ChevronDownMed:"",ChevronLeftMed:"",ChevronRightMed:"",Devices2:"",PC1:"",PresenceChickletVideo:"",Reply:"",HalfAlpha:"",ConstructionCone:"",DoubleChevronLeftMed:"",Volume0:"",Volume1:"",Volume2:"",Volume3:"",Chart:"",Robot:"",Manufacturing:"",LockSolid:"",FitPage:"",FitWidth:"",BidiLtr:"",BidiRtl:"",RightDoubleQuote:"",Sunny:"",CloudWeather:"",Cloudy:"",PartlyCloudyDay:"",PartlyCloudyNight:"",ClearNight:"",RainShowersDay:"",Rain:"",Thunderstorms:"",RainSnow:"",Snow:"",BlowingSnow:"",Frigid:"",Fog:"",Squalls:"",Duststorm:"",Unknown:"",Precipitation:"",Ribbon:"",AreaChart:"",Assign:"",FlowChart:"",CheckList:"",Diagnostic:"",Generate:"",LineChart:"",Equalizer:"",BarChartHorizontal:"",BarChartVertical:"",Freezing:"",FunnelChart:"",Processing:"",Quantity:"",ReportDocument:"",StackColumnChart:"",SnowShowerDay:"",HailDay:"",WorkFlow:"",HourGlass:"",StoreLogoMed20:"",TimeSheet:"",TriangleSolid:"",UpgradeAnalysis:"",VideoSolid:"",RainShowersNight:"",SnowShowerNight:"",Teamwork:"",HailNight:"",PeopleAdd:"",Glasses:"",DateTime2:"",Shield:"",Header1:"",PageAdd:"",NumberedList:"",PowerBILogo:"",Info2:"",MusicInCollectionFill:"",Asterisk:"",ErrorBadge:"",CircleFill:"",Record2:"",AllAppsMirrored:"",BookmarksMirrored:"",BulletedListMirrored:"",CaretHollowMirrored:"",CaretSolidMirrored:"",ChromeBackMirrored:"",ClearSelectionMirrored:"",ClosePaneMirrored:"",DockLeftMirrored:"",DoubleChevronLeftMedMirrored:"",GoMirrored:""}};(0,o.registerIcons)(n,t)}function c(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-4"',src:"url('"+e+"fabric-icons-4-a656cc0a.woff') format('woff')"},icons:{HelpMirrored:"",ImportMirrored:"",ImportAllMirrored:"",ListMirrored:"",MailForwardMirrored:"",MailReplyMirrored:"",MailReplyAllMirrored:"",MiniContractMirrored:"",MiniExpandMirrored:"",OpenPaneMirrored:"",ParkingLocationMirrored:"",SendMirrored:"",ShowResultsMirrored:"",ThumbnailViewMirrored:"",Media:"",Devices3:"",Focus:"",VideoLightOff:"",Lightbulb:"",StatusTriangle:"",VolumeDisabled:"",Puzzle:"",EmojiNeutral:"",EmojiDisappointed:"",HomeSolid:"",Ringer:"",PDF:"",HeartBroken:"",StoreLogo16:"",MultiSelectMirrored:"",Broom:"",AddToShoppingList:"",Cocktails:"",Wines:"",Articles:"",Cycling:"",DietPlanNotebook:"",Pill:"",ExerciseTracker:"",HandsFree:"",Medical:"",Running:"",Weights:"",Trackers:"",AddNotes:"",AllCurrency:"",BarChart4:"",CirclePlus:"",Coffee:"",Cotton:"",Market:"",Money:"",PieDouble:"",PieSingle:"",RemoveFilter:"",Savings:"",Sell:"",StockDown:"",StockUp:"",Lamp:"",Source:"",MSNVideos:"",Cricket:"",Golf:"",Baseball:"",Soccer:"",MoreSports:"",AutoRacing:"",CollegeHoops:"",CollegeFootball:"",ProFootball:"",ProHockey:"",Rugby:"",SubstitutionsIn:"",Tennis:"",Arrivals:"",Design:"",Website:"",Drop:"",HistoricalWeather:"",SkiResorts:"",Snowflake:"",BusSolid:"",FerrySolid:"",AirplaneSolid:"",TrainSolid:"",Ticket:"",WifiWarning4:"",Devices4:"",AzureLogo:"",BingLogo:"",MSNLogo:"",OutlookLogoInverse:"",OfficeLogo:"",SkypeLogo:"",Door:"",EditMirrored:"",GiftCard:"",DoubleBookmark:"",StatusErrorFull:""}};(0,o.registerIcons)(n,t)}function u(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-5"',src:"url('"+e+"fabric-icons-5-f95ba260.woff') format('woff')"},icons:{Certificate:"",FastForward:"",Rewind:"",Photo2:"",OpenSource:"",Movers:"",CloudDownload:"",Family:"",WindDirection:"",Bug:"",SiteScan:"",BrowserScreenShot:"",F12DevTools:"",CSS:"",JS:"",DeliveryTruck:"",ReminderPerson:"",ReminderGroup:"",ReminderTime:"",TabletMode:"",Umbrella:"",NetworkTower:"",CityNext:"",CityNext2:"",Section:"",OneNoteLogoInverse:"",ToggleFilled:"",ToggleBorder:"",SliderThumb:"",ToggleThumb:"",Documentation:"",Badge:"",Giftbox:"",VisualStudioLogo:"",HomeGroup:"",ExcelLogoInverse:"",WordLogoInverse:"",PowerPointLogoInverse:"",Cafe:"",SpeedHigh:"",Commitments:"",ThisPC:"",MusicNote:"",MicOff:"",PlaybackRate1x:"",EdgeLogo:"",CompletedSolid:"",AlbumRemove:"",MessageFill:"",TabletSelected:"",MobileSelected:"",LaptopSelected:"",TVMonitorSelected:"",DeveloperTools:"",Shapes:"",InsertTextBox:"",LowerBrightness:"",WebComponents:"",OfflineStorage:"",DOM:"",CloudUpload:"",ScrollUpDown:"",DateTime:"",Event:"",Cake:"",Org:"",PartyLeader:"",DRM:"",CloudAdd:"",AppIconDefault:"",Photo2Add:"",Photo2Remove:"",Calories:"",POI:"",AddTo:"",RadioBtnOff:"",RadioBtnOn:"",ExploreContent:"",Product:"",ProgressLoopInner:"",ProgressLoopOuter:"",Blocked2:"",FangBody:"",Toolbox:"",PageHeader:"",ChatInviteFriend:"",Brush:"",Shirt:"",Crown:"",Diamond:"",ScaleUp:"",QRCode:"",Feedback:"",SharepointLogoInverse:"",YammerLogo:"",Hide:"",Uneditable:"",ReturnToSession:"",OpenFolderHorizontal:"",CalendarMirrored:""}};(0,o.registerIcons)(n,t)}function d(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-6"',src:"url('"+e+"fabric-icons-6-ef6fd590.woff') format('woff')"},icons:{SwayLogoInverse:"",OutOfOffice:"",Trophy:"",ReopenPages:"",EmojiTabSymbols:"",AADLogo:"",AccessLogo:"",AdminALogoInverse32:"",AdminCLogoInverse32:"",AdminDLogoInverse32:"",AdminELogoInverse32:"",AdminLLogoInverse32:"",AdminMLogoInverse32:"",AdminOLogoInverse32:"",AdminPLogoInverse32:"",AdminSLogoInverse32:"",AdminYLogoInverse32:"",DelveLogoInverse:"",ExchangeLogoInverse:"",LyncLogo:"",OfficeVideoLogoInverse:"",SocialListeningLogo:"",VisioLogoInverse:"",Balloons:"",Cat:"",MailAlert:"",MailCheck:"",MailLowImportance:"",MailPause:"",MailRepeat:"",SecurityGroup:"",Table:"",VoicemailForward:"",VoicemailReply:"",Waffle:"",RemoveEvent:"",EventInfo:"",ForwardEvent:"",WipePhone:"",AddOnlineMeeting:"",JoinOnlineMeeting:"",RemoveLink:"",PeopleBlock:"",PeopleRepeat:"",PeopleAlert:"",PeoplePause:"",TransferCall:"",AddPhone:"",UnknownCall:"",NoteReply:"",NoteForward:"",NotePinned:"",RemoveOccurrence:"",Timeline:"",EditNote:"",CircleHalfFull:"",Room:"",Unsubscribe:"",Subscribe:"",HardDrive:"",RecurringTask:"",TaskManager:"",TaskManagerMirrored:"",Combine:"",Split:"",DoubleChevronUp:"",DoubleChevronLeft:"",DoubleChevronRight:"",TextBox:"",TextField:"",NumberField:"",Dropdown:"",PenWorkspace:"",BookingsLogo:"",ClassNotebookLogoInverse:"",DelveAnalyticsLogo:"",DocsLogoInverse:"",Dynamics365Logo:"",DynamicSMBLogo:"",OfficeAssistantLogo:"",OfficeStoreLogo:"",OneNoteEduLogoInverse:"",PlannerLogo:"",PowerApps:"",Suitcase:"",ProjectLogoInverse:"",CaretLeft8:"",CaretRight8:"",CaretUp8:"",CaretDown8:"",CaretLeftSolid8:"",CaretRightSolid8:"",CaretUpSolid8:"",CaretDownSolid8:"",ClearFormatting:"",Superscript:"",Subscript:"",Strikethrough:"",Export:"",ExportMirrored:""}};(0,o.registerIcons)(n,t)}function h(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-7"',src:"url('"+e+"fabric-icons-7-2b97bb99.woff') format('woff')"},icons:{SingleBookmark:"",SingleBookmarkSolid:"",DoubleChevronDown:"",FollowUser:"",ReplyAll:"",WorkforceManagement:"",RecruitmentManagement:"",Questionnaire:"",ManagerSelfService:"",ProductionFloorManagement:"",ProductRelease:"",ProductVariant:"",ReplyMirrored:"",ReplyAllMirrored:"",Medal:"",AddGroup:"",QuestionnaireMirrored:"",CloudImportExport:"",TemporaryUser:"",CaretSolid16:"",GroupedDescending:"",GroupedAscending:"",AwayStatus:"",MyMoviesTV:"",GenericScan:"",AustralianRules:"",WifiEthernet:"",TrackersMirrored:"",DateTimeMirrored:"",StopSolid:"",DoubleChevronUp12:"",DoubleChevronDown12:"",DoubleChevronLeft12:"",DoubleChevronRight12:"",CalendarAgenda:"",ConnectVirtualMachine:"",AddEvent:"",AssetLibrary:"",DataConnectionLibrary:"",DocLibrary:"",FormLibrary:"",FormLibraryMirrored:"",ReportLibrary:"",ReportLibraryMirrored:"",ContactCard:"",CustomList:"",CustomListMirrored:"",IssueTracking:"",IssueTrackingMirrored:"",PictureLibrary:"",OfficeAddinsLogo:"",OfflineOneDriveParachute:"",OfflineOneDriveParachuteDisabled:"",TriangleSolidUp12:"",TriangleSolidDown12:"",TriangleSolidLeft12:"",TriangleSolidRight12:"",TriangleUp12:"",TriangleDown12:"",TriangleLeft12:"",TriangleRight12:"",ArrowUpRight8:"",ArrowDownRight8:"",DocumentSet:"",GoToDashboard:"",DelveAnalytics:"",ArrowUpRightMirrored8:"",ArrowDownRightMirrored8:"",CompanyDirectory:"",OpenEnrollment:"",CompanyDirectoryMirrored:"",OneDriveAdd:"",ProfileSearch:"",Header2:"",Header3:"",Header4:"",RingerSolid:"",Eyedropper:"",MarketDown:"",CalendarWorkWeek:"",SidePanel:"",GlobeFavorite:"",CaretTopLeftSolid8:"",CaretTopRightSolid8:"",ViewAll2:"",DocumentReply:"",PlayerSettings:"",ReceiptForward:"",ReceiptReply:"",ReceiptCheck:"",Fax:"",RecurringEvent:"",ReplyAlt:"",ReplyAllAlt:"",EditStyle:"",EditMail:"",Lifesaver:"",LifesaverLock:"",InboxCheck:"",FolderSearch:""}};(0,o.registerIcons)(n,t)}function p(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-8"',src:"url('"+e+"fabric-icons-8-6fdf1528.woff') format('woff')"},icons:{CollapseMenu:"",ExpandMenu:"",Boards:"",SunAdd:"",SunQuestionMark:"",LandscapeOrientation:"",DocumentSearch:"",PublicCalendar:"",PublicContactCard:"",PublicEmail:"",PublicFolder:"",WordDocument:"",PowerPointDocument:"",ExcelDocument:"",GroupedList:"",ClassroomLogo:"",Sections:"",EditPhoto:"",Starburst:"",ShareiOS:"",AirTickets:"",PencilReply:"",Tiles2:"",SkypeCircleCheck:"",SkypeCircleClock:"",SkypeCircleMinus:"",SkypeMessage:"",ClosedCaption:"",ATPLogo:"",OfficeFormsLogoInverse:"",RecycleBin:"",EmptyRecycleBin:"",Hide2:"",Breadcrumb:"",BirthdayCake:"",TimeEntry:"",CRMProcesses:"",PageEdit:"",PageArrowRight:"",PageRemove:"",Database:"",DataManagementSettings:"",CRMServices:"",EditContact:"",ConnectContacts:"",AppIconDefaultAdd:"",AppIconDefaultList:"",ActivateOrders:"",DeactivateOrders:"",ProductCatalog:"",ScatterChart:"",AccountActivity:"",DocumentManagement:"",CRMReport:"",KnowledgeArticle:"",Relationship:"",HomeVerify:"",ZipFolder:"",SurveyQuestions:"",TextDocument:"",TextDocumentShared:"",PageCheckedOut:"",PageShared:"",SaveAndClose:"",Script:"",Archive:"",ActivityFeed:"",Compare:"",EventDate:"",ArrowUpRight:"",CaretRight:"",SetAction:"",ChatBot:"",CaretSolidLeft:"",CaretSolidDown:"",CaretSolidRight:"",CaretSolidUp:"",PowerAppsLogo:"",PowerApps2Logo:"",SearchIssue:"",SearchIssueMirrored:"",FabricAssetLibrary:"",FabricDataConnectionLibrary:"",FabricDocLibrary:"",FabricFormLibrary:"",FabricFormLibraryMirrored:"",FabricReportLibrary:"",FabricReportLibraryMirrored:"",FabricPublicFolder:"",FabricFolderSearch:"",FabricMovetoFolder:"",FabricUnsyncFolder:"",FabricSyncFolder:"",FabricOpenFolderHorizontal:"",FabricFolder:"",FabricFolderFill:"",FabricNewFolder:"",FabricPictureLibrary:"",PhotoVideoMedia:"",AddFavorite:""}};(0,o.registerIcons)(n,t)}function f(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-9"',src:"url('"+e+"fabric-icons-9-c6162b42.woff') format('woff')"},icons:{AddFavoriteFill:"",BufferTimeBefore:"",BufferTimeAfter:"",BufferTimeBoth:"",PublishContent:"",ClipboardList:"",ClipboardListMirrored:"",CannedChat:"",SkypeForBusinessLogo:"",TabCenter:"",PageCheckedin:"",PageList:"",ReadOutLoud:"",CaretBottomLeftSolid8:"",CaretBottomRightSolid8:"",FolderHorizontal:"",MicrosoftStaffhubLogo:"",GiftboxOpen:"",StatusCircleOuter:"",StatusCircleInner:"",StatusCircleRing:"",StatusTriangleOuter:"",StatusTriangleInner:"",StatusTriangleExclamation:"",StatusCircleExclamation:"",StatusCircleErrorX:"",StatusCircleInfo:"",StatusCircleBlock:"",StatusCircleBlock2:"",StatusCircleQuestionMark:"",StatusCircleSync:"",Toll:"",ExploreContentSingle:"",CollapseContent:"",CollapseContentSingle:"",InfoSolid:"",GroupList:"",ProgressRingDots:"",CaloriesAdd:"",BranchFork:"",MuteChat:"",AddHome:"",AddWork:"",MobileReport:"",ScaleVolume:"",HardDriveGroup:"",FastMode:"",ToggleLeft:"",ToggleRight:"",TriangleShape:"",RectangleShape:"",CubeShape:"",Trophy2:"",BucketColor:"",BucketColorFill:"",Taskboard:"",SingleColumn:"",DoubleColumn:"",TripleColumn:"",ColumnLeftTwoThirds:"",ColumnRightTwoThirds:"",AccessLogoFill:"",AnalyticsLogo:"",AnalyticsQuery:"",NewAnalyticsQuery:"",AnalyticsReport:"",WordLogo:"",WordLogoFill:"",ExcelLogo:"",ExcelLogoFill:"",OneNoteLogo:"",OneNoteLogoFill:"",OutlookLogo:"",OutlookLogoFill:"",PowerPointLogo:"",PowerPointLogoFill:"",PublisherLogo:"",PublisherLogoFill:"",ScheduleEventAction:"",FlameSolid:"",ServerProcesses:"",Server:"",SaveAll:"",LinkedInLogo:"",Decimals:"",SidePanelMirrored:"",ProtectRestrict:"",Blog:"",UnknownMirrored:"",PublicContactCardMirrored:"",GridViewSmall:"",GridViewMedium:"",GridViewLarge:"",Step:"",StepInsert:"",StepShared:"",StepSharedAdd:"",StepSharedInsert:"",ViewDashboard:"",ViewList:""}};(0,o.registerIcons)(n,t)}function g(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-10"',src:"url('"+e+"fabric-icons-10-c4ded8e4.woff') format('woff')"},icons:{ViewListGroup:"",ViewListTree:"",TriggerAuto:"",TriggerUser:"",PivotChart:"",StackedBarChart:"",StackedLineChart:"",BuildQueue:"",BuildQueueNew:"",UserFollowed:"",ContactLink:"",Stack:"",Bullseye:"",VennDiagram:"",FiveTileGrid:"",FocalPoint:"",Insert:"",RingerRemove:"",TeamsLogoInverse:"",TeamsLogo:"",TeamsLogoFill:"",SkypeForBusinessLogoFill:"",SharepointLogo:"",SharepointLogoFill:"",DelveLogo:"",DelveLogoFill:"",OfficeVideoLogo:"",OfficeVideoLogoFill:"",ExchangeLogo:"",ExchangeLogoFill:"",Signin:"",DocumentApproval:"",CloneToDesktop:"",InstallToDrive:"",Blur:"",Build:"",ProcessMetaTask:"",BranchFork2:"",BranchLocked:"",BranchCommit:"",BranchCompare:"",BranchMerge:"",BranchPullRequest:"",BranchSearch:"",BranchShelveset:"",RawSource:"",MergeDuplicate:"",RowsGroup:"",RowsChild:"",Deploy:"",Redeploy:"",ServerEnviroment:"",VisioDiagram:"",HighlightMappedShapes:"",TextCallout:"",IconSetsFlag:"",VisioLogo:"",VisioLogoFill:"",VisioDocument:"",TimelineProgress:"",TimelineDelivery:"",Backlog:"",TeamFavorite:"",TaskGroup:"",TaskGroupMirrored:"",ScopeTemplate:"",AssessmentGroupTemplate:"",NewTeamProject:"",CommentAdd:"",CommentNext:"",CommentPrevious:"",ShopServer:"",LocaleLanguage:"",QueryList:"",UserSync:"",UserPause:"",StreamingOff:"",ArrowTallUpLeft:"",ArrowTallUpRight:"",ArrowTallDownLeft:"",ArrowTallDownRight:"",FieldEmpty:"",FieldFilled:"",FieldChanged:"",FieldNotChanged:"",RingerOff:"",PlayResume:"",BulletedList2:"",BulletedList2Mirrored:"",ImageCrosshair:"",GitGraph:"",Repo:"",RepoSolid:"",FolderQuery:"",FolderList:"",FolderListMirrored:"",LocationOutline:"",POISolid:"",CalculatorNotEqualTo:"",BoxSubtractSolid:""}};(0,o.registerIcons)(n,t)}function m(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-11"',src:"url('"+e+"fabric-icons-11-2a8393d6.woff') format('woff')"},icons:{BoxAdditionSolid:"",BoxMultiplySolid:"",BoxPlaySolid:"",BoxCheckmarkSolid:"",CirclePauseSolid:"",CirclePause:"",MSNVideosSolid:"",CircleStopSolid:"",CircleStop:"",NavigateBack:"",NavigateBackMirrored:"",NavigateForward:"",NavigateForwardMirrored:"",UnknownSolid:"",UnknownMirroredSolid:"",CircleAddition:"",CircleAdditionSolid:"",FilePDB:"",FileTemplate:"",FileSQL:"",FileJAVA:"",FileASPX:"",FileCSS:"",FileSass:"",FileLess:"",FileHTML:"",JavaScriptLanguage:"",CSharpLanguage:"",CSharp:"",VisualBasicLanguage:"",VB:"",CPlusPlusLanguage:"",CPlusPlus:"",FSharpLanguage:"",FSharp:"",TypeScriptLanguage:"",PythonLanguage:"",PY:"",CoffeeScript:"",MarkDownLanguage:"",FullWidth:"",FullWidthEdit:"",Plug:"",PlugSolid:"",PlugConnected:"",PlugDisconnected:"",UnlockSolid:"",Variable:"",Parameter:"",CommentUrgent:"",Storyboard:"",DiffInline:"",DiffSideBySide:"",ImageDiff:"",ImagePixel:"",FileBug:"",FileCode:"",FileComment:"",BusinessHoursSign:"",FileImage:"",FileSymlink:"",AutoFillTemplate:"",WorkItem:"",WorkItemBug:"",LogRemove:"",ColumnOptions:"",Packages:"",BuildIssue:"",AssessmentGroup:"",VariableGroup:"",FullHistory:"",Wheelchair:"",SingleColumnEdit:"",DoubleColumnEdit:"",TripleColumnEdit:"",ColumnLeftTwoThirdsEdit:"",ColumnRightTwoThirdsEdit:"",StreamLogo:"",PassiveAuthentication:"",AlertSolid:"",MegaphoneSolid:"",TaskSolid:"",ConfigurationSolid:"",BugSolid:"",CrownSolid:"",Trophy2Solid:"",QuickNoteSolid:"",ConstructionConeSolid:"",PageListSolid:"",PageListMirroredSolid:"",StarburstSolid:"",ReadingModeSolid:"",SadSolid:"",HealthSolid:"",ShieldSolid:"",GiftBoxSolid:"",ShoppingCartSolid:"",MailSolid:"",ChatSolid:"",RibbonSolid:""}};(0,o.registerIcons)(n,t)}function y(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-12"',src:"url('"+e+"fabric-icons-12-7e945a1e.woff') format('woff')"},icons:{FinancialSolid:"",FinancialMirroredSolid:"",HeadsetSolid:"",PermissionsSolid:"",ParkingSolid:"",ParkingMirroredSolid:"",DiamondSolid:"",AsteriskSolid:"",OfflineStorageSolid:"",BankSolid:"",DecisionSolid:"",Parachute:"",ParachuteSolid:"",FiltersSolid:"",ColorSolid:"",ReviewSolid:"",ReviewRequestSolid:"",ReviewRequestMirroredSolid:"",ReviewResponseSolid:"",FeedbackRequestSolid:"",FeedbackRequestMirroredSolid:"",FeedbackResponseSolid:"",WorkItemBar:"",WorkItemBarSolid:"",Separator:"",NavigateExternalInline:"",PlanView:"",TimelineMatrixView:"",EngineeringGroup:"",ProjectCollection:"",CaretBottomRightCenter8:"",CaretBottomLeftCenter8:"",CaretTopRightCenter8:"",CaretTopLeftCenter8:"",DonutChart:"",ChevronUnfold10:"",ChevronFold10:"",DoubleChevronDown8:"",DoubleChevronUp8:"",DoubleChevronLeft8:"",DoubleChevronRight8:"",ChevronDownEnd6:"",ChevronUpEnd6:"",ChevronLeftEnd6:"",ChevronRightEnd6:"",ContextMenu:"",AzureAPIManagement:"",AzureServiceEndpoint:"",VSTSLogo:"",VSTSAltLogo1:"",VSTSAltLogo2:"",FileTypeSolution:"",WordLogoInverse16:"",WordLogo16:"",WordLogoFill16:"",PowerPointLogoInverse16:"",PowerPointLogo16:"",PowerPointLogoFill16:"",ExcelLogoInverse16:"",ExcelLogo16:"",ExcelLogoFill16:"",OneNoteLogoInverse16:"",OneNoteLogo16:"",OneNoteLogoFill16:"",OutlookLogoInverse16:"",OutlookLogo16:"",OutlookLogoFill16:"",PublisherLogoInverse16:"",PublisherLogo16:"",PublisherLogoFill16:"",VisioLogoInverse16:"",VisioLogo16:"",VisioLogoFill16:"",TestBeaker:"",TestBeakerSolid:"",TestExploreSolid:"",TestAutoSolid:"",TestUserSolid:"",TestImpactSolid:"",TestPlan:"",TestStep:"",TestParameter:"",TestSuite:"",TestCase:"",Sprint:"",SignOut:"",TriggerApproval:"",Rocket:"",AzureKeyVault:"",Onboarding:"",Transition:"",LikeSolid:"",DislikeSolid:"",CRMCustomerInsightsApp:"",EditCreate:"",PlayReverseResume:"",PlayReverse:"",SearchData:"",UnSetColor:"",DeclineCall:""}};(0,o.registerIcons)(n,t)}function v(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-13"',src:"url('"+e+"fabric-icons-13-c3989a02.woff') format('woff')"},icons:{RectangularClipping:"",TeamsLogo16:"",TeamsLogoFill16:"",Spacer:"",SkypeLogo16:"",SkypeForBusinessLogo16:"",SkypeForBusinessLogoFill16:"",FilterSolid:"",MailUndelivered:"",MailTentative:"",MailTentativeMirrored:"",MailReminder:"",ReceiptUndelivered:"",ReceiptTentative:"",ReceiptTentativeMirrored:"",Inbox:"",IRMReply:"",IRMReplyMirrored:"",IRMForward:"",IRMForwardMirrored:"",VoicemailIRM:"",EventAccepted:"",EventTentative:"",EventTentativeMirrored:"",EventDeclined:"",IDBadge:"",BackgroundColor:"",OfficeFormsLogoInverse16:"",OfficeFormsLogo:"",OfficeFormsLogoFill:"",OfficeFormsLogo16:"",OfficeFormsLogoFill16:"",OfficeFormsLogoInverse24:"",OfficeFormsLogo24:"",OfficeFormsLogoFill24:"",PageLock:"",NotExecuted:"",NotImpactedSolid:"",FieldReadOnly:"",FieldRequired:"",BacklogBoard:"",ExternalBuild:"",ExternalTFVC:"",ExternalXAML:"",IssueSolid:"",DefectSolid:"",LadybugSolid:"",NugetLogo:"",TFVCLogo:"",ProjectLogo32:"",ProjectLogoFill32:"",ProjectLogo16:"",ProjectLogoFill16:"",SwayLogo32:"",SwayLogoFill32:"",SwayLogo16:"",SwayLogoFill16:"",ClassNotebookLogo32:"",ClassNotebookLogoFill32:"",ClassNotebookLogo16:"",ClassNotebookLogoFill16:"",ClassNotebookLogoInverse32:"",ClassNotebookLogoInverse16:"",StaffNotebookLogo32:"",StaffNotebookLogoFill32:"",StaffNotebookLogo16:"",StaffNotebookLogoFill16:"",StaffNotebookLogoInverted32:"",StaffNotebookLogoInverted16:"",KaizalaLogo:"",TaskLogo:"",ProtectionCenterLogo32:"",GallatinLogo:"",Globe2:"",Guitar:"",Breakfast:"",Brunch:"",BeerMug:"",Vacation:"",Teeth:"",Taxi:"",Chopsticks:"",SyncOccurence:"",UnsyncOccurence:"",GIF:"",PrimaryCalendar:"",SearchCalendar:"",VideoOff:"",MicrosoftFlowLogo:"",BusinessCenterLogo:"",ToDoLogoBottom:"",ToDoLogoTop:"",EditSolid12:"",EditSolidMirrored12:"",UneditableSolid12:"",UneditableSolidMirrored12:"",UneditableMirrored:"",AdminALogo32:"",AdminALogoFill32:"",ToDoLogoInverse:""}};(0,o.registerIcons)(n,t)}function b(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-14"',src:"url('"+e+"fabric-icons-14-5cf58db8.woff') format('woff')"},icons:{Snooze:"",WaffleOffice365:"",ImageSearch:"",NewsSearch:"",VideoSearch:"",R:"",FontColorA:"",FontColorSwatch:"",LightWeight:"",NormalWeight:"",SemiboldWeight:"",GroupObject:"",UngroupObject:"",AlignHorizontalLeft:"",AlignHorizontalCenter:"",AlignHorizontalRight:"",AlignVerticalTop:"",AlignVerticalCenter:"",AlignVerticalBottom:"",HorizontalDistributeCenter:"",VerticalDistributeCenter:"",Ellipse:"",Line:"",Octagon:"",Hexagon:"",Pentagon:"",RightTriangle:"",HalfCircle:"",QuarterCircle:"",ThreeQuarterCircle:"","6PointStar":"","12PointStar":"",ArrangeBringToFront:"",ArrangeSendToBack:"",ArrangeSendBackward:"",ArrangeBringForward:"",BorderDash:"",BorderDot:"",LineStyle:"",LineThickness:"",WindowEdit:"",HintText:"",MediaAdd:"",AnchorLock:"",AutoHeight:"",ChartSeries:"",ChartXAngle:"",ChartYAngle:"",Combobox:"",LineSpacing:"",Padding:"",PaddingTop:"",PaddingBottom:"",PaddingLeft:"",PaddingRight:"",NavigationFlipper:"",AlignJustify:"",TextOverflow:"",VisualsFolder:"",VisualsStore:"",PictureCenter:"",PictureFill:"",PicturePosition:"",PictureStretch:"",PictureTile:"",Slider:"",SliderHandleSize:"",DefaultRatio:"",NumberSequence:"",GUID:"",ReportAdd:"",DashboardAdd:"",MapPinSolid:"",WebPublish:"",PieSingleSolid:"",BlockedSolid:"",DrillDown:"",DrillDownSolid:"",DrillExpand:"",DrillShow:"",SpecialEvent:"",OneDriveFolder16:"",FunctionalManagerDashboard:"",BIDashboard:"",CodeEdit:"",RenewalCurrent:"",RenewalFuture:"",SplitObject:"",BulkUpload:"",DownloadDocument:"",GreetingCard:"",Flower:"",WaitlistConfirm:"",WaitlistConfirmMirrored:"",LaptopSecure:"",DragObject:"",EntryView:"",EntryDecline:"",ContactCardSettings:"",ContactCardSettingsMirrored:""}};(0,o.registerIcons)(n,t)}function S(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-15"',src:"url('"+e+"fabric-icons-15-3807251b.woff') format('woff')"},icons:{CalendarSettings:"",CalendarSettingsMirrored:"",HardDriveLock:"",HardDriveUnlock:"",AccountManagement:"",ReportWarning:"",TransitionPop:"",TransitionPush:"",TransitionEffect:"",LookupEntities:"",ExploreData:"",AddBookmark:"",SearchBookmark:"",DrillThrough:"",MasterDatabase:"",CertifiedDatabase:"",MaximumValue:"",MinimumValue:"",VisualStudioIDELogo32:"",PasteAsText:"",PasteAsCode:"",BrowserTab:"",BrowserTabScreenshot:"",DesktopScreenshot:"",FileYML:"",ClipboardSolid:"",FabricUserFolder:"",FabricNetworkFolder:"",BullseyeTarget:"",AnalyticsView:"",Video360Generic:"",Untag:"",Leave:"",Trending12:"",Blocked12:"",Warning12:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CircleShapeSolid:"",SquareShapeSolid:"",TriangleShapeSolid:"",DropShapeSolid:"",RectangleShapeSolid:"",ZoomToFit:"",InsertColumnsLeft:"",InsertColumnsRight:"",InsertRowsAbove:"",InsertRowsBelow:"",DeleteColumns:"",DeleteRows:"",DeleteRowsMirrored:"",DeleteTable:"",AccountBrowser:"",VersionControlPush:"",StackedColumnChart2:"",TripleColumnWide:"",QuadColumn:"",WhiteBoardApp16:"",WhiteBoardApp32:"",PinnedSolid:"",InsertSignatureLine:"",ArrangeByFrom:"",Phishing:"",CreateMailRule:"",PublishCourse:"",DictionaryRemove:"",UserRemove:"",UserEvent:"",Encryption:"",PasswordField:"",OpenInNewTab:"",Hide3:"",VerifiedBrandSolid:"",MarkAsProtected:"",AuthenticatorApp:"",WebTemplate:"",DefenderTVM:"",MedalSolid:"",D365TalentLearn:"",D365TalentInsight:"",D365TalentHRCore:"",BacklogList:"",ButtonControl:"",TableGroup:"",MountainClimbing:"",TagUnknown:"",TagUnknownMirror:"",TagUnknown12:"",TagUnknown12Mirror:"",Link12:"",Presentation:"",Presentation12:"",Lock12:"",BuildDefinition:"",ReleaseDefinition:"",SaveTemplate:"",UserGauge:"",BlockedSiteSolid12:"",TagSolid:"",OfficeChat:""}};(0,o.registerIcons)(n,t)}function w(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-16"',src:"url('"+e+"fabric-icons-16-9cf93f3b.woff') format('woff')"},icons:{OfficeChatSolid:"",MailSchedule:"",WarningSolid:"",Blocked2Solid:"",SkypeCircleArrow:"",SkypeArrow:"",SyncStatus:"",SyncStatusSolid:"",ProjectDocument:"",ToDoLogoOutline:"",VisioOnlineLogoFill32:"",VisioOnlineLogo32:"",VisioOnlineLogoCloud32:"",VisioDiagramSync:"",Event12:"",EventDateMissed12:"",UserOptional:"",ResponsesMenu:"",DoubleDownArrow:"",DistributeDown:"",BookmarkReport:"",FilterSettings:"",GripperDotsVertical:"",MailAttached:"",AddIn:"",LinkedDatabase:"",TableLink:"",PromotedDatabase:"",BarChartVerticalFilter:"",BarChartVerticalFilterSolid:"",MicOff2:"",MicrosoftTranslatorLogo:"",ShowTimeAs:"",FileRequest:"",WorkItemAlert:"",PowerBILogo16:"",PowerBILogoBackplate16:"",BulletedListText:"",BulletedListBullet:"",BulletedListTextMirrored:"",BulletedListBulletMirrored:"",NumberedListText:"",NumberedListNumber:"",NumberedListTextMirrored:"",NumberedListNumberMirrored:"",RemoveLinkChain:"",RemoveLinkX:"",FabricTextHighlight:"",ClearFormattingA:"",ClearFormattingEraser:"",Photo2Fill:"",IncreaseIndentText:"",IncreaseIndentArrow:"",DecreaseIndentText:"",DecreaseIndentArrow:"",IncreaseIndentTextMirrored:"",IncreaseIndentArrowMirrored:"",DecreaseIndentTextMirrored:"",DecreaseIndentArrowMirrored:"",CheckListText:"",CheckListCheck:"",CheckListTextMirrored:"",CheckListCheckMirrored:"",NumberSymbol:"",Coupon:"",VerifiedBrand:"",ReleaseGate:"",ReleaseGateCheck:"",ReleaseGateError:"",M365InvoicingLogo:"",RemoveFromShoppingList:"",ShieldAlert:"",FabricTextHighlightComposite:"",Dataflows:"",GenericScanFilled:"",DiagnosticDataBarTooltip:"",SaveToMobile:"",Orientation2:"",ScreenCast:"",ShowGrid:"",SnapToGrid:"",ContactList:"",NewMail:"",EyeShadow:"",FabricFolderConfirm:"",InformationBarriers:"",CommentActive:"",ColumnVerticalSectionEdit:"",WavingHand:"",ShakeDevice:"",SmartGlassRemote:"",Rotate90Clockwise:"",Rotate90CounterClockwise:"",CampaignTemplate:"",ChartTemplate:"",PageListFilter:"",SecondaryNav:"",ColumnVerticalSection:"",SkypeCircleSlash:"",SkypeSlash:""}};(0,o.registerIcons)(n,t)}function T(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-17"',src:"url('"+e+"fabric-icons-17-0c4ed701.woff') format('woff')"},icons:{CustomizeToolbar:"",DuplicateRow:"",RemoveFromTrash:"",MailOptions:"",Childof:"",Footer:"",Header:"",BarChartVerticalFill:"",StackedColumnChart2Fill:"",PlainText:"",AccessibiltyChecker:"",DatabaseSync:"",ReservationOrders:"",TabOneColumn:"",TabTwoColumn:"",TabThreeColumn:"",BulletedTreeList:"",MicrosoftTranslatorLogoGreen:"",MicrosoftTranslatorLogoBlue:"",InternalInvestigation:"",AddReaction:"",ContactHeart:"",VisuallyImpaired:"",EventToDoLogo:"",Variable2:"",ModelingView:"",DisconnectVirtualMachine:"",ReportLock:"",Uneditable2:"",Uneditable2Mirrored:"",BarChartVerticalEdit:"",GlobalNavButtonActive:"",PollResults:"",Rerun:"",QandA:"",QandAMirror:"",BookAnswers:"",AlertSettings:"",TrimStart:"",TrimEnd:"",TableComputed:"",DecreaseIndentLegacy:"",IncreaseIndentLegacy:"",SizeLegacy:""}};(0,o.registerIcons)(n,t)}var _=function(){(0,o.registerIconAlias)("trash","delete"),(0,o.registerIconAlias)("onedrive","onedrivelogo"),(0,o.registerIconAlias)("alertsolid12","eventdatemissed12"),(0,o.registerIconAlias)("sixpointstar","6pointstar"),(0,o.registerIconAlias)("twelvepointstar","12pointstar"),(0,o.registerIconAlias)("toggleon","toggleleft"),(0,o.registerIconAlias)("toggleoff","toggleright")},C=n(36151);(0,n(30620).v)("@uifabric/icons","7.9.4");var k="https://spoppe-b.azureedge.net/files/fabric-cdn-prod_20210407.001/assets/icons/",E=(0,C.z)();function A(e,t){var n,o,C,A;void 0===e&&(e=(null===(o=null===(n=E)||void 0===n?void 0:n.FabricConfig)||void 0===o?void 0:o.iconBaseUrl)||(null===(A=null===(C=E)||void 0===C?void 0:C.FabricConfig)||void 0===A?void 0:A.fontBaseUrl)||k),[r,s,i,a,l,c,u,d,h,p,f,g,m,y,v,b,S,w,T].forEach((function(n){return n(e,t)})),_()}},17060:(e,t,n)=>{"use strict";function o(e){s!==e&&(s=e)}function r(){return void 0===s&&(s="undefined"!=typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),s}var s;function i(){return{rtl:r()}}n.d(t,{DU:()=>o,Iy:()=>i}),s=r()},95876:(e,t,n)=>{"use strict";n.d(t,{b:()=>s,n:()=>c});var o,r=n(98670),s={none:0,insertNode:1,appendChild:2},i="__stylesheet__",a="undefined"!=typeof navigator&&/rv:11.0/.test(navigator.userAgent),l={};try{l=window}catch(e){}var c=function(){function e(e){this._rules=[],this._preservedRules=[],this._rulesToInsert=[],this._counter=0,this._keyToClassName={},this._onResetCallbacks=[],this._classNameToArgs={},this._config=(0,r.Cl)({injectionMode:s.insertNode,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._keyToClassName=this._config.classNameCache||{}}return e.getInstance=function(){var t;if(!(o=l[i])||o._lastStyleElement&&o._lastStyleElement.ownerDocument!==document){var n=(null===(t=l)||void 0===t?void 0:t.FabricConfig)||{};o=l[i]=new e(n.mergeStyles)}return o},e.prototype.setConfig=function(e){this._config=(0,r.Cl)((0,r.Cl)({},this._config),e)},e.prototype.onReset=function(e){this._onResetCallbacks.push(e)},e.prototype.getClassName=function(e){var t=this._config.namespace;return(t?t+"-":"")+(e||this._config.defaultPrefix)+"-"+this._counter++},e.prototype.cacheClassName=function(e,t,n,o){this._keyToClassName[t]=e,this._classNameToArgs[e]={args:n,rules:o}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[e]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t){var n=this._config.injectionMode!==s.none?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),n)switch(this._config.injectionMode){case s.insertNode:var o=n.sheet;try{o.insertRule(e,o.cssRules.length)}catch(e){}break;case s.appendChild:n.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e)},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")+this._rulesToInsert.join("")},e.prototype.reset=function(){this._rules=[],this._rulesToInsert=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach((function(e){return e()}))},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._getStyleElement=function(){var e=this;return this._styleElement||"undefined"==typeof document||(this._styleElement=this._createStyleElement(),a||window.requestAnimationFrame((function(){e._styleElement=void 0}))),this._styleElement},e.prototype._createStyleElement=function(){var e=document.head,t=document.createElement("style"),n=null;t.setAttribute("data-merge-styles","true");var o=this._config.cspSettings;if(o&&o.nonce&&t.setAttribute("nonce",o.nonce),this._lastStyleElement)n=this._lastStyleElement.nextElementSibling;else{var r=this._findPlaceholderStyleTag();n=r?r.nextElementSibling:e.childNodes[0]}return e.insertBefore(t,e.contains(n)?n:null),this._lastStyleElement=t,t},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}()},69646:(e,t,n)=>{"use strict";n.d(t,{T:()=>r});var o=n(98670);function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e&&1===e.length&&e[0]&&!e[0].subComponentStyles)return e[0];for(var n={},s={},i=0,a=e;i<a.length;i++){var l=a[i];if(l)for(var c in l)if(l.hasOwnProperty(c)){if("subComponentStyles"===c&&void 0!==l.subComponentStyles){var u=l.subComponentStyles;for(var d in u)u.hasOwnProperty(d)&&(s.hasOwnProperty(d)?s[d].push(u[d]):s[d]=[u[d]]);continue}var h=n[c],p=l[c];n[c]=void 0===h?p:(0,o.aN)(Array.isArray(h)?h:[h],Array.isArray(p)?p:[p])}}if(Object.keys(s).length>0){n.subComponentStyles={};var f=n.subComponentStyles,g=function(e){if(s.hasOwnProperty(e)){var t=s[e];f[e]=function(e){return r.apply(void 0,t.map((function(t){return"function"==typeof t?t(e):t})))}}};for(var d in s)g(d)}return n}},49742:(e,t,n)=>{"use strict";n.d(t,{p:()=>r});var o=n(69646);function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=[],s=0,i=t;s<i.length;s++){var a=i[s];a&&r.push("function"==typeof a?a(e):a)}return 1===r.length?r[0]:r.length?o.T.apply(void 0,r):{}}},39718:(e,t,n)=>{"use strict";n.d(t,{h:()=>r});var o=n(95876);function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=[],r=[],s=o.n.getInstance();return function e(t){for(var o=0,i=t;o<i.length;o++){var a=i[o];if(a)if("string"==typeof a)if(a.indexOf(" ")>=0)e(a.split(" "));else{var l=s.argsFromClassName(a);l?e(l):-1===n.indexOf(a)&&n.push(a)}else Array.isArray(a)?e(a):"object"==typeof a&&r.push(a)}}(e),{classes:n,objects:r}}},3864:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});var o=n(17060),r=n(95876),s=n(81992);function i(e){r.n.getInstance().insertRule("@font-face{"+(0,s.bz)((0,o.Iy)(),e)+"}",!0)}},88063:(e,t,n)=>{"use strict";n.d(t,{i:()=>i});var o=n(17060),r=n(95876),s=n(81992);function i(e){var t=r.n.getInstance(),n=t.getClassName(),i=[];for(var a in e)e.hasOwnProperty(a)&&i.push(a,"{",(0,s.bz)((0,o.Iy)(),e[a]),"}");var l=i.join("");return t.insertRule("@keyframes "+n+"{"+l+"}",!0),t.cacheClassName(n,l,[],["keyframes",l]),n}},46208:(e,t,n)=>{"use strict";n.d(t,{L:()=>l,l:()=>a});var o=n(69646),r=n(39718),s=n(17060),i=n(81992);function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return l(e,(0,s.Iy)())}function l(e,t){var n,s,a={subComponentStyles:{}};if(!e[0]&&e.length<=1)return{subComponentStyles:{}};var l=o.T.apply(void 0,e),c=[];for(var u in l)if(l.hasOwnProperty(u)){if("subComponentStyles"===u){a.subComponentStyles=l.subComponentStyles||{};continue}var d=l[u],h=(0,r.h)(d),p=h.classes,f=h.objects;(null===(n=f)||void 0===n?void 0:n.length)?(y=(0,i.GJ)(t||{},{displayName:u},f))&&(c.push(y),a[u]=p.concat([y.className]).join(" ")):a[u]=p.join(" ")}for(var g=0,m=c;g<m.length;g++){var y;(y=m[g])&&(0,i.Ae)(y,null===(s=t)||void 0===s?void 0:s.specificityMultiplier)}return a}},16536:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i,e:()=>a});var o=n(39718),r=n(17060),s=n(81992);function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a(e,(0,r.Iy)())}function a(e,t){var n=e instanceof Array?e:[e],r=(0,o.h)(n),i=r.classes,a=r.objects;return a.length&&i.push((0,s.kG)(t||{},a)),i.join(" ")}},81992:(e,t,n)=>{"use strict";n.d(t,{Ae:()=>A,bz:()=>k,kG:()=>I,GJ:()=>E});var o,r=n(98670),s=n(95876),i={},a={"user-select":1};function l(e,t){var n=function(){var e,t;if(!o){var n="undefined"!=typeof document?document:void 0,r="undefined"!=typeof navigator?navigator:void 0,s=null===(t=null===(e=r)||void 0===e?void 0:e.userAgent)||void 0===t?void 0:t.toLowerCase();o=n?{isWebkit:!(!n||!("WebkitAppearance"in n.documentElement.style)),isMoz:!!(s&&s.indexOf("firefox")>-1),isOpera:!!(s&&s.indexOf("opera")>-1),isMs:!(!r||!/rv:11.0/i.test(r.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return o}(),r=e[t];if(a[r]){var s=e[t+1];a[r]&&(n.isWebkit&&e.push("-webkit-"+r,s),n.isMoz&&e.push("-moz-"+r,s),n.isMs&&e.push("-ms-"+r,s),n.isOpera&&e.push("-o-"+r,s))}}var c,u=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function d(e,t){var n=e[t],o=e[t+1];if("number"==typeof o){var r=u.indexOf(n)>-1,s=n.indexOf("--")>-1,i=r||s?"":"px";e[t+1]=""+o+i}}var h="left",p="right",f="@noflip",g=((c={})[h]=p,c[p]=h,c),m={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function y(e,t,n){if(e.rtl){var o=t[n];if(!o)return;var r=t[n+1];if("string"==typeof r&&r.indexOf(f)>=0)t[n+1]=r.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(o.indexOf(h)>=0)t[n]=o.replace(h,p);else if(o.indexOf(p)>=0)t[n]=o.replace(p,h);else if(String(r).indexOf(h)>=0)t[n+1]=r.replace(h,p);else if(String(r).indexOf(p)>=0)t[n+1]=r.replace(p,h);else if(g[o])t[n]=g[o];else if(m[r])t[n+1]=m[r];else switch(o){case"margin":case"padding":t[n+1]=function(e){if("string"==typeof e){var t=e.split(" ");if(4===t.length)return t[0]+" "+t[3]+" "+t[2]+" "+t[1]}return e}(r);break;case"box-shadow":t[n+1]=function(e){var t=e.split(" "),n=parseInt(t[0],10);return t[0]=t[0].replace(String(n),String(-1*n)),t.join(" ")}(r)}}}var v="displayName",b=/\:global\((.+?)\)/g;function S(e,t){return e.indexOf(":global(")>=0?e.replace(b,"$1"):0===e.indexOf(":")?t+e:e.indexOf("&")<0?t+" "+e:e}function w(e,t,n,o){void 0===t&&(t={__order:[]}),0===n.indexOf("@")?T([o],t,n=n+"{"+e):n.indexOf(",")>-1?function(e){if(!b.test(e))return e;for(var t=[],n=/\:global\((.+?)\)/g,o=null;o=n.exec(e);)o[1].indexOf(",")>-1&&t.push([o.index,o.index+o[0].length,o[1].split(",").map((function(e){return":global("+e.trim()+")"})).join(", ")]);return t.reverse().reduce((function(e,t){var n=t[0],o=t[1],r=t[2];return e.slice(0,n)+r+e.slice(o)}),e)}(n).split(",").map((function(e){return e.trim()})).forEach((function(n){return T([o],t,S(n,e))})):T([o],t,S(n,e))}function T(e,t,n){void 0===t&&(t={__order:[]}),void 0===n&&(n="&");var o=s.n.getInstance(),r=t[n];r||(r={},t[n]=r,t.__order.push(n));for(var i=0,a=e;i<a.length;i++){var l=a[i];if("string"==typeof l){var c=o.argsFromClassName(l);c&&T(c,t,n)}else if(Array.isArray(l))T(l,t,n);else for(var u in l)if(l.hasOwnProperty(u)){var d=l[u];if("selectors"===u){var h=l.selectors;for(var p in h)h.hasOwnProperty(p)&&w(n,t,p,h[p])}else"object"==typeof d?null!==d&&w(n,t,u,d):void 0!==d&&("margin"===u||"padding"===u?_(r,u,d):r[u]=d)}}return t}function _(e,t,n){var o="string"==typeof n?n.split(" "):[n];e[t+"Top"]=o[0],e[t+"Right"]=o[1]||o[0],e[t+"Bottom"]=o[2]||o[0],e[t+"Left"]=o[3]||o[1]||o[0]}function C(e,t){return t<=0?"":1===t?e:e+C(e,t-1)}function k(e,t){if(!t)return"";var n,o,r,s=[];for(var a in t)t.hasOwnProperty(a)&&a!==v&&void 0!==t[a]&&s.push(a,t[a]);for(var c=0;c<s.length;c+=2)r=void 0,"-"!==(r=(n=s)[o=c]).charAt(0)&&(n[o]=i[r]=i[r]||r.replace(/([A-Z])/g,"-$1").toLowerCase()),d(s,c),y(e,s,c),l(s,c);for(c=1;c<s.length;c+=4)s.splice(c,1,":",s[c],";");return s.join("")}function E(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=T(t),r=function(e,t){for(var n=[e.rtl?"rtl":"ltr"],o=!1,r=0,s=t.__order;r<s.length;r++){var i=s[r];n.push(i);var a=t[i];for(var l in a)a.hasOwnProperty(l)&&void 0!==a[l]&&(o=!0,n.push(l,a[l]))}return o?n.join(""):void 0}(e,o);if(r){var i=s.n.getInstance(),a={className:i.classNameFromKey(r),key:r,args:t};if(!a.className){a.className=i.getClassName(function(e){var t=e&&e["&"];return t?t.displayName:void 0}(o));for(var l=[],c=0,u=o.__order;c<u.length;c++){var d=u[c];l.push(d,k(e,o[d]))}a.rulesToInsert=l}return a}}function A(e,t){void 0===t&&(t=1);var n=s.n.getInstance(),o=e.className,r=e.key,i=e.args,a=e.rulesToInsert;if(a){for(var l=0;l<a.length;l+=2){var c=a[l+1];if(c){var u=a[l],d=(u=u.replace(/&/g,C("."+e.className,t)))+"{"+c+"}"+(0===u.indexOf("@")?"}":"");n.insertRule(d)}}n.cacheClassName(o,r,i,a)}}function I(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=E.apply(void 0,(0,r.aN)([e],t));return o?(A(o,e.specificityMultiplier),o.className):""}},69442:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});var o=n(26166);function r(e){var t=o.useRef();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}},4802:(e,t,n)=>{"use strict";n.d(t,{x:()=>s});var o=n(69730),r=n(26166);function s(e,t,n,s){var i=r.useRef(n);i.current=n,r.useEffect((function(){var n=e&&"current"in e?e.current:e;if(n)return(0,o.on)(n,t,(function(e){return i.current(e)}),s)}),[e,t,s])}},98644:(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n(26166);function r(e){var t=(0,o.useRef)();return(0,o.useEffect)((function(){t.current=e})),t.current}},30620:(e,t,n)=>{"use strict";n.d(t,{v:()=>s});var o={},r=void 0;try{r=window}catch(e){}function s(e,t){if(void 0!==r){var n=r.__packages__=r.__packages__||{};n[e]&&o[e]||(o[e]=t,(n[e]=n[e]||[]).push(t))}}s("@uifabric/set-version","6.0.0")},68761:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AnimationClassNames:()=>Y,AnimationStyles:()=>V,AnimationVariables:()=>$,ColorClassNames:()=>fe,DefaultEffects:()=>ye.W,DefaultFontStyles:()=>X.d,DefaultPalette:()=>ee.b,EdgeChromiumHighContrastSelector:()=>_e,FontClassNames:()=>Z,FontSizes:()=>ve.s,FontWeights:()=>ve.BO,HighContrastSelector:()=>Se,HighContrastSelectorBlack:()=>Te,HighContrastSelectorWhite:()=>we,IconFontSizes:()=>ve.fF,InjectionMode:()=>Ye.b,PulsingBeaconAnimationStyles:()=>Ke,ScreenWidthMaxLarge:()=>Re,ScreenWidthMaxMedium:()=>xe,ScreenWidthMaxSmall:()=>Me,ScreenWidthMaxXLarge:()=>De,ScreenWidthMaxXXLarge:()=>Oe,ScreenWidthMinLarge:()=>Ee,ScreenWidthMinMedium:()=>ke,ScreenWidthMinSmall:()=>Ce,ScreenWidthMinUhfMobile:()=>Ne,ScreenWidthMinXLarge:()=>Ae,ScreenWidthMinXXLarge:()=>Ie,ScreenWidthMinXXXLarge:()=>Pe,Stylesheet:()=>Ye.n,ThemeSettingName:()=>le,ZIndexes:()=>We,buildClassMap:()=>r,concatStyleSets:()=>kt.T,concatStyleSetsWithProps:()=>Et.p,createFontStyles:()=>be.s,createTheme:()=>se.a,focusClear:()=>He,fontFace:()=>dt.n,getEdgeChromiumNoHighContrastAdjustSelector:()=>Be,getFadedOverflowStyle:()=>it,getFocusOutlineStyle:()=>qe,getFocusStyle:()=>Ge,getGlobalClassNames:()=>Ze,getHighContrastNoAdjustStyle:()=>Fe,getIcon:()=>vt,getIconClassName:()=>Ct,getInputFocusStyle:()=>$e,getPlaceholderStyles:()=>lt,getScreenSelector:()=>Le,getTheme:()=>ue,getThemedContext:()=>tt,hiddenContentStyle:()=>Ve,keyframes:()=>s.i,loadTheme:()=>pe,mergeStyleSets:()=>At.l,mergeStyles:()=>o.Z,noWrap:()=>ot,normalize:()=>nt,registerDefaultFontFaces:()=>X.a,registerIconAlias:()=>yt,registerIcons:()=>gt,registerOnThemeChangeCallback:()=>de,removeOnThemeChangeCallback:()=>he,setIconOptions:()=>bt,unregisterIcons:()=>mt});var o=n(16536);function r(e){var t={},n=function(n){var r;e.hasOwnProperty(n)&&Object.defineProperty(t,n,{get:function(){return void 0===r&&(r=(0,o.Z)(e[n]).toString()),r},enumerable:!0,configurable:!0})};for(var r in e)n(r);return t}var s=n(88063),i="cubic-bezier(.1,.9,.2,1)",a="cubic-bezier(.1,.25,.75,.9)",l="0.167s",c="0.267s",u="0.367s",d="0.467s",h=(0,s.i)({from:{opacity:0},to:{opacity:1}}),p=(0,s.i)({from:{opacity:1},to:{opacity:0,visibility:"hidden"}}),f=z(-10),g=z(-20),m=z(-40),y=z(-400),v=z(10),b=z(20),S=z(40),w=z(400),T=Q(10),_=Q(20),C=Q(-10),k=Q(-20),E=J(10),A=J(20),I=J(40),P=J(400),M=J(-10),x=J(-20),R=J(-40),D=J(-400),O=K(-10),N=K(-20),L=K(10),F=K(20),B=(0,s.i)({from:{transform:"scale3d(.98,.98,1)"},to:{transform:"scale3d(1,1,1)"}}),W=(0,s.i)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(.98,.98,1)"}}),U=(0,s.i)({from:{transform:"scale3d(1.03,1.03,1)"},to:{transform:"scale3d(1,1,1)"}}),G=(0,s.i)({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(1.03,1.03,1)"}}),H=(0,s.i)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(90deg)"}}),q=(0,s.i)({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(-90deg)"}}),$={easeFunction1:i,easeFunction2:a,durationValue1:l,durationValue2:c,durationValue3:u,durationValue4:d},V={slideRightIn10:j(h+","+f,u,i),slideRightIn20:j(h+","+g,u,i),slideRightIn40:j(h+","+m,u,i),slideRightIn400:j(h+","+y,u,i),slideLeftIn10:j(h+","+v,u,i),slideLeftIn20:j(h+","+b,u,i),slideLeftIn40:j(h+","+S,u,i),slideLeftIn400:j(h+","+w,u,i),slideUpIn10:j(h+","+T,u,i),slideUpIn20:j(h+","+_,u,i),slideDownIn10:j(h+","+C,u,i),slideDownIn20:j(h+","+k,u,i),slideRightOut10:j(p+","+E,u,i),slideRightOut20:j(p+","+A,u,i),slideRightOut40:j(p+","+I,u,i),slideRightOut400:j(p+","+P,u,i),slideLeftOut10:j(p+","+M,u,i),slideLeftOut20:j(p+","+x,u,i),slideLeftOut40:j(p+","+R,u,i),slideLeftOut400:j(p+","+D,u,i),slideUpOut10:j(p+","+O,u,i),slideUpOut20:j(p+","+N,u,i),slideDownOut10:j(p+","+L,u,i),slideDownOut20:j(p+","+F,u,i),scaleUpIn100:j(h+","+B,u,i),scaleDownIn100:j(h+","+U,u,i),scaleUpOut103:j(p+","+G,l,a),scaleDownOut98:j(p+","+W,l,a),fadeIn100:j(h,l,a),fadeIn200:j(h,c,a),fadeIn400:j(h,u,a),fadeIn500:j(h,d,a),fadeOut100:j(p,l,a),fadeOut200:j(p,c,a),fadeOut400:j(p,u,a),fadeOut500:j(p,d,a),rotate90deg:j(H,"0.1s",a),rotateN90deg:j(q,"0.1s",a)};function j(e,t,n){return{animationName:e,animationDuration:t,animationTimingFunction:n,animationFillMode:"both"}}function z(e){return(0,s.i)({from:{transform:"translate3d("+e+"px,0,0)",pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function Q(e){return(0,s.i)({from:{transform:"translate3d(0,"+e+"px,0)",pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function J(e){return(0,s.i)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d("+e+"px,0,0)"}})}function K(e){return(0,s.i)({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(0,"+e+"px,0)"}})}var Y=r(V),X=n(11435),Z=r(X.d),ee=n(38445),te=n(98670),ne=n(36151),oe=n(14429),re=n(92132),se=n(18817),ie=(0,se.a)({}),ae=[],le="theme";function ce(){var e,t,n,o,r,s=(0,ne.z)();(null===(n=null===(t=s)||void 0===t?void 0:t.FabricConfig)||void 0===n?void 0:n.legacyTheme)?pe(s.FabricConfig.legacyTheme):oe.X.getSettings([le]).theme||((null===(r=null===(o=s)||void 0===o?void 0:o.FabricConfig)||void 0===r?void 0:r.theme)&&(ie=(0,se.a)(s.FabricConfig.theme)),oe.X.applySettings(((e={})[le]=ie,e)))}function ue(e){return void 0===e&&(e=!1),!0===e&&(ie=(0,se.a)({},e)),ie}function de(e){-1===ae.indexOf(e)&&ae.push(e)}function he(e){var t=ae.indexOf(e);-1!==t&&ae.splice(t,1)}function pe(e,t){var n;return void 0===t&&(t=!1),ie=(0,se.a)(e,t),(0,re.EQ)((0,te.Cl)((0,te.Cl)((0,te.Cl)((0,te.Cl)({},ie.palette),ie.semanticColors),ie.effects),function(e){for(var t={},n=0,o=Object.keys(e.fonts);n<o.length;n++)for(var r=o[n],s=e.fonts[r],i=0,a=Object.keys(s);i<a.length;i++){var l=a[i],c=r+l.charAt(0).toUpperCase()+l.slice(1),u=s[l];"fontSize"===l&&"number"==typeof u&&(u+="px"),t[c]=u}return t}(ie))),oe.X.applySettings(((n={})[le]=ie,n)),ae.forEach((function(e){try{e(ie)}catch(e){}})),ie}ce();var fe={};for(var ge in ee.b)ee.b.hasOwnProperty(ge)&&(me(fe,ge,"",!1,"color"),me(fe,ge,"Hover",!0,"color"),me(fe,ge,"Background",!1,"background"),me(fe,ge,"BackgroundHover",!0,"background"),me(fe,ge,"Border",!1,"borderColor"),me(fe,ge,"BorderHover",!0,"borderColor"));function me(e,t,n,r,s){Object.defineProperty(e,t+n,{get:function(){var e,n=((e={})[s]=ue().palette[t],e);return(0,o.Z)(r?{selectors:{":hover":n}}:n).toString()},enumerable:!0,configurable:!0})}var ye=n(36544),ve=n(99453),be=n(99230),Se="@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)",we="@media screen and (-ms-high-contrast: black-on-white), screen and (forced-colors: active) and (prefers-color-scheme: light)",Te="@media screen and (-ms-high-contrast: white-on-black), screen and (forced-colors: active) and (prefers-color-scheme: dark)",_e="@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)",Ce=320,ke=480,Ee=640,Ae=1024,Ie=1366,Pe=1920,Me=ke-1,xe=Ee-1,Re=Ae-1,De=Ie-1,Oe=Pe-1,Ne=768;function Le(e,t){return"@media only screen"+("number"==typeof e?" and (min-width: "+e+"px)":"")+("number"==typeof t?" and (max-width: "+t+"px)":"")}function Fe(){return{forcedColorAdjust:"none",MsHighContrastAdjust:"none"}}function Be(){var e;return(e={})[_e]={forcedColorAdjust:"none",MsHighContrastAdjust:"none"},e}var We,Ue=n(82914);function Ge(e,t,n,o,r,s,i){return function(e,t){var n,o;void 0===t&&(t={});var r=t.inset,s=void 0===r?0:r,i=t.width,a=void 0===i?1:i,l=t.position,c=void 0===l?"relative":l,u=t.highContrastStyle,d=t.borderColor,h=void 0===d?e.palette.white:d,p=t.outlineColor,f=void 0===p?e.palette.neutralSecondary:p,g=t.isFocusedOnly,m=void 0===g||g;return{outline:"transparent",position:c,selectors:(n={"::-moz-focus-inner":{border:"0"}},n["."+Ue.Y2+" &"+(m?":focus":"")+":after"]={content:'""',position:"absolute",left:s+1,top:s+1,bottom:s+1,right:s+1,border:a+"px solid "+h,outline:a+"px solid "+f,zIndex:We.FocusStyle,selectors:(o={},o[Se]=u,o)},n)}}(e,"number"!=typeof t&&t?t:{inset:t,position:n,highContrastStyle:o,borderColor:r,outlineColor:s,isFocusedOnly:i})}function He(){return{selectors:{"&::-moz-focus-inner":{border:0},"&":{outline:"transparent"}}}}function qe(e,t,n,o){var r;return void 0===t&&(t=0),void 0===n&&(n=1),{selectors:(r={},r[":global("+Ue.Y2+") &:focus"]={outline:n+" solid "+(o||e.palette.neutralSecondary),outlineOffset:-t+"px"},r)}}!function(e){e.Nav=1,e.ScrollablePane=1,e.FocusStyle=1,e.Coachmark=1e3,e.Layer=1e6,e.KeytipLayer=1000001}(We||(We={}));var $e=function(e,t,n,o){var r,s,i;void 0===n&&(n="border"),void 0===o&&(o=-1);var a="borderBottom"===n;return{borderColor:e,selectors:{":after":(r={pointerEvents:"none",content:"''",position:"absolute",left:a?0:o,top:o,bottom:o,right:a?0:o},r[n]="2px solid "+e,r.borderRadius=t,r.width="borderBottom"===n?"100%":void 0,r.selectors=(s={},s[Se]=(i={},i["border"===n?"borderColor":"borderBottomColor"]="Highlight",i),s),r)}}},Ve={position:"absolute",width:1,height:1,margin:-1,padding:0,border:0,overflow:"hidden"};function je(e,t){return{borderColor:e,borderWidth:"0px",width:t,height:t}}function ze(e){return{opacity:1,borderWidth:e}}function Qe(e,t){return{borderWidth:"0",width:t,height:t,opacity:0,borderColor:e}}function Je(e,t){return(0,te.Cl)((0,te.Cl)({},je(e,t)),{opacity:0})}var Ke={continuousPulseAnimationDouble:function(e,t,n,o,r){return(0,s.i)({"0%":je(e,n),"1.42%":ze(r),"3.57%":{opacity:1},"7.14%":Qe(t,o),"8%":Je(e,n),"29.99%":Je(e,n),"30%":je(e,n),"31.42%":ze(r),"33.57%":{opacity:1},"37.14%":Qe(t,o),"38%":Je(e,n),"79.42%":Je(e,n),79.43:je(e,n),81.85:ze(r),83.42:{opacity:1},"87%":Qe(t,o),"100%":{}})},continuousPulseAnimationSingle:function(e,t,n,o,r){return(0,s.i)({"0%":je(e,n),"14.2%":ze(r),"35.7%":{opacity:1},"71.4%":Qe(t,o),"100%":{}})},createDefaultAnimation:function(e,t){return{animationName:e,animationIterationCount:"1",animationDuration:"14s",animationDelay:t||"2s"}}},Ye=n(95876),Xe=(0,n(38044).J9)((function(e,t){var n=Ye.n.getInstance();return t?Object.keys(e).reduce((function(t,o){return t[o]=n.getClassName(e[o]),t}),{}):e}));function Ze(e,t,n){return Xe(e,void 0!==n?n:t.disableGlobalClassNames)}var et=n(22406);function tt(e,t,n){var o,r=e,s=n||oe.X.getSettings(["theme"],void 0,e.customizations).theme;n&&(o={theme:n});var i=t&&s&&s.schemes&&s.schemes[t];return s&&i&&s!==i&&((o={theme:i}).theme.schemes=s.schemes),o&&(r={customizations:{settings:(0,et.s)(e.customizations.settings,o),scopedSettings:e.customizations.scopedSettings}}),r}var nt={boxShadow:"none",margin:0,padding:0,boxSizing:"border-box"},ot={overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},rt="50%",st=20;function it(e,t,n,o,r){void 0===t&&(t="bodyBackground"),void 0===n&&(n="horizontal"),void 0===o&&(o=at("width",n)),void 0===r&&(r=at("height",n));var s=e.semanticColors[t]||e.palette[t],i=function(e){if("#"===e[0])return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16)};if(0===e.indexOf("rgba(")){var t=(e=e.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2]}}return{r:255,g:255,b:255}}(s);return{content:'""',position:"absolute",right:0,bottom:0,width:o,height:r,pointerEvents:"none",backgroundImage:"linear-gradient("+("vertical"===n?"to bottom":"to right")+", rgba("+i.r+", "+i.g+", "+i.b+", 0) 0%, "+s+" 100%)"}}function at(e,t){return"width"===e?"horizontal"===t?st:"100%":"vertical"===t?rt:"100%"}function lt(e){return{selectors:{"::placeholder":e,":-ms-input-placeholder":e,"::-ms-input-placeholder":e}}}var ct=n(88012),ut=n(47897),dt=n(3864),ht=ct.h.getValue("icons",{__options:{disableWarnings:!1,warnOnMissingIcons:!0},__remapped:{}}),pt=Ye.n.getInstance();pt&&pt.onReset&&pt.onReset((function(){for(var e in ht)ht.hasOwnProperty(e)&&ht[e].subset&&(ht[e].subset.className=void 0)}));var ft=function(e){return e.toLowerCase()};function gt(e,t){var n=(0,te.Cl)((0,te.Cl)({},e),{isRegistered:!1,className:void 0}),o=e.icons;for(var r in t=t?(0,te.Cl)((0,te.Cl)({},ht.__options),t):ht.__options,o)if(o.hasOwnProperty(r)){var s=o[r],i=ft(r);ht[i]?Tt(r):ht[i]={code:s,subset:n}}}function mt(e){for(var t=ht.__options,n=function(e){var n=ft(e);ht[n]?delete ht[n]:t.disableWarnings||(0,ut.R)('The icon "'+e+'" tried to unregister but was not registered.'),ht.__remapped[n]&&delete ht.__remapped[n],Object.keys(ht.__remapped).forEach((function(e){ht.__remapped[e]===n&&delete ht.__remapped[e]}))},o=0,r=e;o<r.length;o++)n(r[o])}function yt(e,t){ht.__remapped[ft(e)]=ft(t)}function vt(e){var t=void 0,n=ht.__options;if(e=e?ft(e):"",e=ht.__remapped[e]||e)if(t=ht[e]){var r=t.subset;r&&r.fontFace&&(r.isRegistered||((0,dt.n)(r.fontFace),r.isRegistered=!0),r.className||(r.className=(0,o.Z)(r.style,{fontFamily:r.fontFace.fontFamily,fontWeight:r.fontFace.fontWeight||"normal",fontStyle:r.fontFace.fontStyle||"normal"})))}else!n.disableWarnings&&n.warnOnMissingIcons&&(0,ut.R)('The icon "'+e+'" was used but not registered. See https://github.com/microsoft/fluentui/wiki/Using-icons for more information.');return t}function bt(e){ht.__options=(0,te.Cl)((0,te.Cl)({},ht.__options),e)}var St=[],wt=void 0;function Tt(e){ht.__options.disableWarnings||(St.push(e),void 0===wt&&(wt=setTimeout((function(){(0,ut.R)("Some icons were re-registered. Applications should only call registerIcons for any given icon once. Redefining what an icon is may have unintended consequences. Duplicates include: \n"+St.slice(0,10).join(", ")+(St.length>10?" (+ "+(St.length-10)+" more)":"")),wt=void 0,St=[]}),2e3)))}var _t={display:"inline-block"};function Ct(e){var t="",n=vt(e);return n&&(t=(0,o.Z)(n.subset.className,_t,{selectors:{"::before":{content:'"'+n.code+'"'}}})),t}var kt=n(69646),Et=n(49742),At=n(46208);(0,n(30620).v)("@uifabric/styling","7.25.0"),ce()},16904:(e,t,n)=>{"use strict";n.d(t,{j:()=>r});var o=n(36151),r=function(){function e(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=function(){}}return e.prototype.dispose=function(){var e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}},e.prototype.setTimeout=function(e,t){var n=this,o=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),o=setTimeout((function(){try{n._timeoutIds&&delete n._timeoutIds[o],e.apply(n._parent)}catch(e){n._onErrorHandler&&n._onErrorHandler(e)}}),t),this._timeoutIds[o]=!0),o},e.prototype.clearTimeout=function(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])},e.prototype.setImmediate=function(e,t){var n=this,r=0,s=(0,o.z)(t);return this._isDisposed||(this._immediateIds||(this._immediateIds={}),r=s.setTimeout((function(){try{n._immediateIds&&delete n._immediateIds[r],e.apply(n._parent)}catch(e){n._logError(e)}}),0),this._immediateIds[r]=!0),r},e.prototype.clearImmediate=function(e,t){var n=(0,o.z)(t);this._immediateIds&&this._immediateIds[e]&&(n.clearTimeout(e),delete this._immediateIds[e])},e.prototype.setInterval=function(e,t){var n=this,o=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),o=setInterval((function(){try{e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._intervalIds[o]=!0),o},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var o=this;if(this._isDisposed)return this._noop;var r,s,i=t||0,a=!0,l=!0,c=0,u=null;n&&"boolean"==typeof n.leading&&(a=n.leading),n&&"boolean"==typeof n.trailing&&(l=n.trailing);var d=function(t){var n=Date.now(),h=n-c,p=a?i-h:i;return h>=i&&(!t||a)?(c=n,u&&(o.clearTimeout(u),u=null),r=e.apply(o._parent,s)):null===u&&l&&(u=o.setTimeout(d,p)),r};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s=e,d(!0)}},e.prototype.debounce=function(e,t,n){var o=this;if(this._isDisposed){var r=function(){};return r.cancel=function(){},r.flush=function(){return null},r.pending=function(){return!1},r}var s,i,a=t||0,l=!1,c=!0,u=null,d=0,h=Date.now(),p=null;n&&"boolean"==typeof n.leading&&(l=n.leading),n&&"boolean"==typeof n.trailing&&(c=n.trailing),n&&"number"==typeof n.maxWait&&!isNaN(n.maxWait)&&(u=n.maxWait);var f=function(e){p&&(o.clearTimeout(p),p=null),h=e},g=function(t){f(t),s=e.apply(o._parent,i)},m=function(e){var t=Date.now(),n=!1;e&&(l&&t-d>=a&&(n=!0),d=t);var r=t-d,i=a-r,f=t-h,y=!1;return null!==u&&(f>=u&&p?y=!0:i=Math.min(i,u-f)),r>=a||y||n?g(t):null!==p&&e||!c||(p=o.setTimeout(m,i)),s},y=function(){return!!p},v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i=e,m(!0)};return v.cancel=function(){y()&&f(Date.now())},v.flush=function(){return y()&&g(Date.now()),s},v.pending=y,v},e.prototype.requestAnimationFrame=function(e,t){var n=this,r=0,s=(0,o.z)(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var i=function(){try{n._animationFrameIds&&delete n._animationFrameIds[r],e.apply(n._parent)}catch(e){n._logError(e)}};r=s.requestAnimationFrame?s.requestAnimationFrame(i):s.setTimeout(i,0),this._animationFrameIds[r]=!0}return r},e.prototype.cancelAnimationFrame=function(e,t){var n=(0,o.z)(t);this._animationFrameIds&&this._animationFrameIds[e]&&(n.cancelAnimationFrame?n.cancelAnimationFrame(e):n.clearTimeout(e),delete this._animationFrameIds[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}()},55584:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var o=n(89709),r=n(44591),s=n(35853),i=100,a=function(){function e(e){this._events=new o.g(this),this._scrollableParent=(0,r.Hc)(e),this._incrementScroll=this._incrementScroll.bind(this),this._scrollRect=(0,s.l)(this._scrollableParent),this._scrollableParent===window&&(this._scrollableParent=document.body),this._scrollableParent&&(this._events.on(window,"mousemove",this._onMouseMove,!0),this._events.on(window,"touchmove",this._onTouchMove,!0))}return e.prototype.dispose=function(){this._events.dispose(),this._stopScroll()},e.prototype._onMouseMove=function(e){this._computeScrollVelocity(e)},e.prototype._onTouchMove=function(e){e.touches.length>0&&this._computeScrollVelocity(e)},e.prototype._computeScrollVelocity=function(e){if(this._scrollRect){var t,n;"clientX"in e?(t=e.clientX,n=e.clientY):(t=e.touches[0].clientX,n=e.touches[0].clientY);var o,r,s,a=this._scrollRect.top,l=this._scrollRect.left,c=a+this._scrollRect.height-i,u=l+this._scrollRect.width-i;n<a+i||n>c?(r=n,o=a,s=c,this._isVerticalScroll=!0):(r=t,o=l,s=u,this._isVerticalScroll=!1),this._scrollVelocity=r<o+i?Math.max(-15,(i-(r-o))/i*-15):r>s?Math.min(15,(r-s)/i*15):0,this._scrollVelocity?this._startScroll():this._stopScroll()}},e.prototype._startScroll=function(){this._timeoutId||this._incrementScroll()},e.prototype._incrementScroll=function(){this._scrollableParent&&(this._isVerticalScroll?this._scrollableParent.scrollTop+=Math.round(this._scrollVelocity):this._scrollableParent.scrollLeft+=Math.round(this._scrollVelocity)),this._timeoutId=setTimeout(this._incrementScroll,16)},e.prototype._stopScroll=function(){this._timeoutId&&(clearTimeout(this._timeoutId),delete this._timeoutId)},e}()},57504:(e,t,n)=>{"use strict";n.d(t,{$:()=>u,K:()=>h});var o=n(98670),r=n(26166),s=n(16904),i=n(89709),a=n(58473),l=n(7164),c=n(57194),u=function(e){function t(n,o){var r=e.call(this,n,o)||this;return function(e,t,n){for(var o=0,r=n.length;o<r;o++)d(e,t,n[o])}(r,t.prototype,["componentDidMount","shouldComponentUpdate","getSnapshotBeforeUpdate","render","componentDidUpdate","componentWillUnmount"]),r}return(0,o.C6)(t,e),t.prototype.componentDidUpdate=function(e,t){this._updateComponentRef(e,this.props)},t.prototype.componentDidMount=function(){this._setComponentRef(this.props.componentRef,this)},t.prototype.componentWillUnmount=function(){if(this._setComponentRef(this.props.componentRef,null),this.__disposables){for(var e=0,t=this._disposables.length;e<t;e++){var n=this.__disposables[e];n.dispose&&n.dispose()}this.__disposables=null}},Object.defineProperty(t.prototype,"className",{get:function(){if(!this.__className){var e=/function (.{1,})\(/.exec(this.constructor.toString());this.__className=e&&e.length>1?e[1]:""}return this.__className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_disposables",{get:function(){return this.__disposables||(this.__disposables=[]),this.__disposables},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_async",{get:function(){return this.__async||(this.__async=new s.j(this),this._disposables.push(this.__async)),this.__async},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"_events",{get:function(){return this.__events||(this.__events=new i.g(this),this._disposables.push(this.__events)),this.__events},enumerable:!0,configurable:!0}),t.prototype._resolveRef=function(e){var t=this;return this.__resolves||(this.__resolves={}),this.__resolves[e]||(this.__resolves[e]=function(n){return t[e]=n}),this.__resolves[e]},t.prototype._updateComponentRef=function(e,t){void 0===t&&(t={}),e&&t&&e.componentRef!==t.componentRef&&(this._setComponentRef(e.componentRef,null),this._setComponentRef(t.componentRef,this))},t.prototype._warnDeprecations=function(e){(0,c.A)(this.className,this.props,e)},t.prototype._warnMutuallyExclusive=function(e){(0,l.Y)(this.className,this.props,e)},t.prototype._warnConditionallyRequiredProps=function(e,t,n){(0,a.J)(this.className,this.props,e,t,n)},t.prototype._setComponentRef=function(e,t){!this._skipComponentRefResolution&&e&&("function"==typeof e&&e(t),"object"==typeof e&&(e.current=t))},t}(r.Component);function d(e,t,n){var o=e[n],r=t[n];(o||r)&&(e[n]=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r&&(e=r.apply(this,t)),o!==r&&(e=o.apply(this,t)),e})}function h(){return null}},56214:(e,t,n)=>{"use strict";n.d(t,{P:()=>s});var o=n(98670),r=n(26166),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRendered:!1},n}return(0,o.C6)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout((function(){e.setState({isRendered:!0})}),t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?r.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(r.Component)},89709:(e,t,n)=>{"use strict";n.d(t,{g:()=>r});var o=n(65977),r=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,n,r,s){var i;if(e._isElement(t)){if("undefined"!=typeof document&&document.createEvent){var a=document.createEvent("HTMLEvents");a.initEvent(n,s||!1,!0),(0,o.kp)(a,r),i=t.dispatchEvent(a)}else if("undefined"!=typeof document&&document.createEventObject){var l=document.createEventObject(r);t.fireEvent("on"+n,l)}}else for(;t&&!1!==i;){var c=t.__events__,u=c?c[n]:null;if(u)for(var d in u)if(u.hasOwnProperty(d))for(var h=u[d],p=0;!1!==i&&p<h.length;p++){var f=h[p];f.objectCallback&&(i=f.objectCallback.call(f.parent,r))}t=s?t.parent:null}return i},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var o in t)t.hasOwnProperty(o)&&this.on(e,o,t[o],n)},e.prototype.on=function(t,n,o,r){var s=this;if(n.indexOf(",")>-1)for(var i=n.split(/[ ,]+/),a=0;a<i.length;a++)this.on(t,i[a],o,r);else{var l=this._parent,c={target:t,eventName:n,parent:l,callback:o,options:r};if((i=t.__events__=t.__events__||{})[n]=i[n]||{count:0},i[n][this._id]=i[n][this._id]||[],i[n][this._id].push(c),i[n].count++,e._isElement(t)){var u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!s._isDisposed){var n;try{if(!1===(n=o.apply(l,e))&&e[0]){var r=e[0];r.preventDefault&&r.preventDefault(),r.stopPropagation&&r.stopPropagation(),r.cancelBubble=!0}}catch(r){}return n}};c.elementCallback=u,t.addEventListener?t.addEventListener(n,u,r):t.attachEvent&&t.attachEvent("on"+n,u)}else c.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!s._isDisposed)return o.apply(l,e)};this._eventRecords.push(c)}},e.prototype.off=function(e,t,n,o){for(var r=0;r<this._eventRecords.length;r++){var s=this._eventRecords[r];if(!(e&&e!==s.target||t&&t!==s.eventName||n&&n!==s.callback||"boolean"==typeof o&&o!==s.options)){var i=s.target.__events__,a=i[s.eventName],l=a?a[this._id]:null;l&&(1!==l.length&&n?(a.count--,l.splice(l.indexOf(s),1)):(a.count-=l.length,delete i[s.eventName][this._id]),a.count||delete i[s.eventName]),s.elementCallback&&(s.target.removeEventListener?s.target.removeEventListener(s.eventName,s.elementCallback,s.options):s.target.detachEvent&&s.target.detachEvent("on"+s.eventName,s.elementCallback)),this._eventRecords.splice(r--,1)}}},e.prototype.raise=function(t,n,o){return e.raise(this._parent,t,n,o)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}()},88012:(e,t,n)=>{"use strict";n.d(t,{h:()=>a});var o=n(36151),r="__globalSettings__",s="__callbacks__",i=0,a=function(){function e(){}return e.getValue=function(e,t){var n=l();return void 0===n[e]&&(n[e]="function"==typeof t?t():t),n[e]},e.setValue=function(e,t){var n=l(),o=n[s],r=n[e];if(t!==r){n[e]=t;var i={oldValue:r,value:t,key:e};for(var a in o)o.hasOwnProperty(a)&&o[a](i)}return t},e.addChangeListener=function(e){var t=e.__id__,n=c();t||(t=e.__id__=String(i++)),n[t]=e},e.removeChangeListener=function(e){delete c()[e.__id__]},e}();function l(){var e,t=(0,o.z)()||{};return t[r]||(t[r]=((e={})[s]={},e)),t[r]}function c(){return l()[s]}},40245:(e,t,n)=>{"use strict";n.d(t,{c:()=>o});var o={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pauseBreak:19,capslock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,del:46,zero:48,one:49,two:50,three:51,four:52,five:53,six:54,seven:55,eight:56,nine:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,leftWindow:91,rightWindow:92,select:93,zero_numpad:96,one_numpad:97,two_numpad:98,three_numpad:99,four_numpad:100,five_numpad:101,six_numpad:102,seven_numpad:103,eight_numpad:104,nine_numpad:105,multiply:106,add:107,subtract:109,decimalPoint:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrollLock:145,semicolon:186,equalSign:187,comma:188,dash:189,period:190,forwardSlash:191,graveAccent:192,openBracket:219,backSlash:220,closeBracket:221,singleQuote:222}},51189:(e,t,n)=>{"use strict";n.d(t,{M:()=>o});var o=function(){function e(e,t,n,o){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===o&&(o=0),this.top=n,this.bottom=o,this.left=e,this.right=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this.right-this.left},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!0,configurable:!0}),e.prototype.equals=function(e){return parseFloat(this.top.toFixed(4))===parseFloat(e.top.toFixed(4))&&parseFloat(this.bottom.toFixed(4))===parseFloat(e.bottom.toFixed(4))&&parseFloat(this.left.toFixed(4))===parseFloat(e.left.toFixed(4))&&parseFloat(this.right.toFixed(4))===parseFloat(e.right.toFixed(4))},e}()},62690:(e,t,n)=>{"use strict";function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.length<2?t[0]:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];t.forEach((function(t){return t&&t.apply(e,n)}))}}n.d(t,{$:()=>o})},49699:(e,t,n)=>{"use strict";function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.filter((function(e){return e})).join(" ").trim();return""===n?void 0:n}n.d(t,{_:()=>o})},56173:(e,t,n)=>{"use strict";function o(e,t,n){void 0===n&&(n=0);for(var o=-1,r=n;e&&r<e.length;r++)if(t(e[r],r)){o=r;break}return o}function r(e,t){var n=o(e,t);if(!(n<0))return e[n]}function s(e,t){for(var n=[],o=0;o<e;o++)n.push(t(o));return n}function i(e,t){return e.reduce((function(e,n,o){return o%t==0?e.push([n]):e[e.length-1].push(n),e}),[])}function a(e,t){return e.filter((function(e,n){return t!==n}))}function l(e,t,n){var o=e.slice();return o[n]=t,o}function c(e,t,n){var o=e.slice();return o.splice(t,0,n),o}function u(e){var t=[];return e.forEach((function(e){return t=t.concat(e)})),t}function d(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}n.d(t,{Bq:()=>u,D3:()=>i,I6:()=>r,Kz:()=>s,SL:()=>o,Ty:()=>c,fx:()=>l,r1:()=>d,xR:()=>a})},93462:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var o=n(95876),r=n(46208),s=n(87018),i=n(36151),a=50,l=5,c=0,u=o.n.getInstance();u&&u.onReset&&u.onReset((function(){return c++}));var d="__retval__";function h(e){void 0===e&&(e={});var t=new Map,n=0,o=0,u=c;return function(h,p){var g,m;if(void 0===p&&(p={}),e.useStaticStyles&&"function"==typeof h&&h.__noStyleOverride__)return h(p);o++;var y=t,v=p.theme,b=v&&void 0!==v.rtl?v.rtl:(0,s.jI)(),S=e.disableCaching;return u!==c&&(u=c,t=new Map,n=0),e.disableCaching||(y=f(t,h),y=f(y,p)),!S&&y[d]||(y[d]=void 0===h?{}:(0,r.L)(["function"==typeof h?h(p):h],{rtl:!!b,specificityMultiplier:e.useStaticStyles?l:void 0}),S||n++),n>(e.cacheSize||a)&&((null===(m=null===(g=(0,i.z)())||void 0===g?void 0:g.FabricConfig)||void 0===m?void 0:m.enableClassNameCacheFullWarning)&&(console.warn("Styles are being recalculated too frequently. Cache miss rate is "+n+"/"+o+"."),console.trace()),t.clear(),n=0,e.disableCaching=!0),y[d]}}function p(e,t){return t=function(e){switch(e){case void 0:return"__undefined__";case null:return"__null__";default:return e}}(t),e.has(t)||e.set(t,new Map),e.get(t)}function f(e,t){if("function"==typeof t)if(t.__cachedInputs__)for(var n=0,o=t.__cachedInputs__;n<o.length;n++)e=p(e,o[n]);else e=p(e,t);else if("object"==typeof t)for(var r in t)t.hasOwnProperty(r)&&(e=p(e,t[r]));return e}},71809:(e,t,n)=>{"use strict";n.d(t,{C:()=>a});var o=n(98670),r=n(26166),s=n(38044),i=(0,s.J5)((function(e){var t=e;return(0,s.J5)((function(n){if(e===n)throw new Error("Attempted to compose a component with itself.");var i=n,a=(0,s.J5)((function(e){return function(t){return r.createElement(i,(0,o.Cl)({},t,{defaultRender:e}))}}));return function(e){var n=e.defaultRender;return r.createElement(t,(0,o.Cl)({},e,{defaultRender:n?a(n):i}))}}))}));function a(e,t){return i(e)(t)}},70672:(e,t,n)=>{"use strict";function o(e,t){return void 0!==e[t]&&null!==e[t]}n.d(t,{R:()=>o})},60525:(e,t,n)=>{"use strict";n.d(t,{K:()=>r});var o=n(56173),r=function(e){var t={refs:[]};return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.resolver&&(0,o.r1)(t.refs,e)||(t.resolver=function(e){return function(t){for(var n=0,o=e.refs;n<o.length;n++){var r=o[n];"function"==typeof r?r(t):r&&(r.current=t)}}}(t)),t.refs=e,t.resolver}}},44395:(e,t,n)=>{"use strict";function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],o=0,r=e;o<r.length;o++){var s=r[o];if(s)if("string"==typeof s)n.push(s);else if(s.hasOwnProperty("toString")&&"function"==typeof s.toString)n.push(s.toString());else for(var i in s)s[i]&&n.push(i)}return n.join(" ")}n.d(t,{A:()=>o})},14429:(e,t,n)=>{"use strict";n.d(t,{X:()=>l});var o=n(98670),r=n(88012),s={settings:{},scopedSettings:{},inCustomizerContext:!1},i=r.h.getValue("customizations",{settings:{},scopedSettings:{},inCustomizerContext:!1}),a=[],l=function(){function e(){}return e.reset=function(){i.settings={},i.scopedSettings={}},e.applySettings=function(t){i.settings=(0,o.Cl)((0,o.Cl)({},i.settings),t),e._raiseChange()},e.applyScopedSettings=function(t,n){i.scopedSettings[t]=(0,o.Cl)((0,o.Cl)({},i.scopedSettings[t]),n),e._raiseChange()},e.getSettings=function(e,t,n){void 0===n&&(n=s);for(var o={},r=t&&n.scopedSettings[t]||{},a=t&&i.scopedSettings[t]||{},l=0,c=e;l<c.length;l++){var u=c[l];o[u]=r[u]||n.settings[u]||a[u]||i.settings[u]}return o},e.applyBatchedUpdates=function(t,n){e._suppressUpdates=!0;try{t()}catch(e){}e._suppressUpdates=!1,n||e._raiseChange()},e.observe=function(e){a.push(e)},e.unobserve=function(e){a=a.filter((function(t){return t!==e}))},e._raiseChange=function(){e._suppressUpdates||a.forEach((function(e){return e()}))},e}()},91348:(e,t,n)=>{"use strict";n.d(t,{K:()=>l});var o=n(98670),r=n(26166),s=n(14429),i=n(94857),a=n(38281),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onCustomizationChange=function(){return t.forceUpdate()},t}return(0,o.C6)(t,e),t.prototype.componentDidMount=function(){s.X.observe(this._onCustomizationChange)},t.prototype.componentWillUnmount=function(){s.X.unobserve(this._onCustomizationChange)},t.prototype.render=function(){var e=this,t=this.props.contextTransform;return r.createElement(i.z.Consumer,null,(function(n){var o=(0,a.N)(e.props,n);return t&&(o=t(o)),r.createElement(i.z.Provider,{value:o},e.props.children)}))},t}(r.Component)},94857:(e,t,n)=>{"use strict";n.d(t,{z:()=>o});var o=n(26166).createContext({customizations:{inCustomizerContext:!1,settings:{},scopedSettings:{}}})},16719:(e,t,n)=>{"use strict";n.d(t,{T:()=>c});var o=n(98670),r=n(26166),s=n(14429),i=n(79316),a=n(94857),l=n(69646);function c(e,t,n){return function(c){var u,d=((u=function(i){function u(e){var t=i.call(this,e)||this;return t._styleCache={},t._onSettingChanged=t._onSettingChanged.bind(t),t}return(0,o.C6)(u,i),u.prototype.componentDidMount=function(){s.X.observe(this._onSettingChanged)},u.prototype.componentWillUnmount=function(){s.X.unobserve(this._onSettingChanged)},u.prototype.render=function(){var i=this;return r.createElement(a.z.Consumer,null,(function(a){var u=s.X.getSettings(t,e,a.customizations),d=i.props;if(u.styles&&"function"==typeof u.styles&&(u.styles=u.styles((0,o.Cl)((0,o.Cl)({},u),d))),n&&u.styles){if(i._styleCache.default!==u.styles||i._styleCache.component!==d.styles){var h=(0,l.T)(u.styles,d.styles);i._styleCache.default=u.styles,i._styleCache.component=d.styles,i._styleCache.merged=h}return r.createElement(c,(0,o.Cl)({},u,d,{styles:i._styleCache.merged}))}return r.createElement(c,(0,o.Cl)({},u,d))}))},u.prototype._onSettingChanged=function(){this.forceUpdate()},u}(r.Component)).displayName="Customized"+e,u);return(0,i.D)(c,d)}}},38281:(e,t,n)=>{"use strict";n.d(t,{N:()=>r});var o=n(22406);function r(e,t){var n=(t||{}).customizations,r=void 0===n?{settings:{},scopedSettings:{}}:n;return{customizations:{settings:(0,o.s)(r.settings,e.settings),scopedSettings:(0,o.A)(r.scopedSettings,e.scopedSettings),inCustomizerContext:!0}}}},22406:(e,t,n)=>{"use strict";n.d(t,{A:()=>s,s:()=>r});var o=n(98670);function r(e,t){void 0===e&&(e={});var n=i(t)?t:function(e){return function(t){return e?(0,o.Cl)((0,o.Cl)({},t),e):t}}(t);return n(e)}function s(e,t){return void 0===e&&(e={}),(i(t)?t:(void 0===(n=t)&&(n={}),function(e){var t=(0,o.Cl)({},e);for(var r in n)n.hasOwnProperty(r)&&(t[r]=(0,o.Cl)((0,o.Cl)({},e[r]),n[r]));return t}))(e);var n}function i(e){return"function"==typeof e}},24194:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});var o=n(26166),r=n(14429),s=n(94857);function i(e,t){var n,i=(n=o.useState(0)[1],function(){return n((function(e){return++e}))}),a=o.useContext(s.z).customizations,l=a.inCustomizerContext;return o.useEffect((function(){return l||r.X.observe(i),function(){l||r.X.unobserve(i)}}),[l]),r.X.getSettings(e,t,a)}},57622:(e,t,n)=>{"use strict";n.d(t,{Y:()=>r});var o=n(15579);function r(e){if(!o.Q&&"undefined"!=typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}},35853:(e,t,n)=>{"use strict";function o(e){var t;return e&&(e===window?t={left:0,top:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:e.getBoundingClientRect&&(t=e.getBoundingClientRect())),t}n.d(t,{l:()=>o})},36151:(e,t,n)=>{"use strict";n.d(t,{z:()=>s});var o=n(15579),r=void 0;try{r=window}catch(e){}function s(e){if(!o.Q&&void 0!==r){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:r}}},69730:(e,t,n)=>{"use strict";function o(e,t,n,o){return e.addEventListener(t,n,o),function(){return e.removeEventListener(t,n,o)}}n.d(t,{on:()=>o})},15579:(e,t,n)=>{"use strict";n.d(t,{Q:()=>o,v:()=>r});var o=!1;function r(e){o=e}},10759:(e,t,n)=>{"use strict";n.d(t,{i:()=>r});var o=n(62690);function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=(0,o.$)(e,e[n],t[n]))}},54212:(e,t,n)=>{"use strict";n.d(t,{Cm:()=>g,Ep:()=>I,HC:()=>w,J9:()=>b,S0:()=>S,SE:()=>_,Z5:()=>T,_l:()=>C,dm:()=>p,eX:()=>v,j5:()=>h,lo:()=>E,nA:()=>A,oR:()=>f,vO:()=>m,yv:()=>y});var o=n(60552),r=n(41602),s=n(93483),i=n(36151),a=n(57622),l="data-is-focusable",c="data-is-visible",u="data-focuszone-id",d="data-is-sub-focuszone";function h(e,t,n){return v(e,t,!0,!1,!1,n)}function p(e,t,n){return y(e,t,!0,!1,!0,n)}function f(e,t,n,o){return void 0===o&&(o=!0),v(e,t,o,!1,!1,n,!1,!0)}function g(e,t,n,o){return void 0===o&&(o=!0),y(e,t,o,!1,!0,n,!1,!0)}function m(e){var t=v(e,e,!0,!1,!1,!0);return!!t&&(E(t),!0)}function y(e,t,n,o,r,s,i,a){if(!t||!i&&t===e)return null;var l=b(t);if(r&&l&&(s||!w(t)&&!T(t))){var c=y(e,t.lastElementChild,!0,!0,!0,s,i,a);if(c){if(a&&S(c,!0)||!a)return c;var u=y(e,c.previousElementSibling,!0,!0,!0,s,i,a);if(u)return u;for(var d=c.parentElement;d&&d!==t;){var h=y(e,d.previousElementSibling,!0,!0,!0,s,i,a);if(h)return h;d=d.parentElement}}}return n&&l&&S(t,a)?t:y(e,t.previousElementSibling,!0,!0,!0,s,i,a)||(o?null:y(e,t.parentElement,!0,!1,!1,s,i,a))}function v(e,t,n,o,r,s,i,a){if(!t||t===e&&r&&!i)return null;var l=b(t);if(n&&l&&S(t,a))return t;if(!r&&l&&(s||!w(t)&&!T(t))){var c=v(e,t.firstElementChild,!0,!0,!1,s,i,a);if(c)return c}return t===e?null:v(e,t.nextElementSibling,!0,!0,!1,s,i,a)||(o?null:v(e,t.parentElement,!1,!1,!0,s,i,a))}function b(e){if(!e||!e.getAttribute)return!1;var t=e.getAttribute(c);return null!=t?"true"===t:0!==e.offsetHeight||null!==e.offsetParent||!0===e.isVisible}function S(e,t){if(!e||e.disabled)return!1;var n=0,o=null;e&&e.getAttribute&&(o=e.getAttribute("tabIndex"))&&(n=parseInt(o,10));var r=e.getAttribute?e.getAttribute(l):null,s=null!==o&&n>=0,i=!!e&&"false"!==r&&("A"===e.tagName||"BUTTON"===e.tagName||"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||"true"===r||s);return t?-1!==n&&i:i}function w(e){return!!(e&&e.getAttribute&&e.getAttribute(u))}function T(e){return!(!e||!e.getAttribute||"true"!==e.getAttribute(d))}function _(e){var t=(0,a.Y)(e),n=t&&t.activeElement;return!(!n||!(0,r.s)(e,n))}function C(e,t){return"true"!==(0,o.m)(e,t)}var k=void 0;function E(e){if(e){if(k)return void(k=e);k=e;var t=(0,i.z)(e);t&&t.requestAnimationFrame((function(){var e=k;k=void 0,e&&(e.getAttribute&&"true"===e.getAttribute(l)&&(e.getAttribute("tabindex")||e.setAttribute("tabindex","0")),e.focus())}))}}function A(e,t){for(var n=e,o=0,r=t;o<r.length;o++){var s=r[o],i=n.children[Math.min(s,n.children.length-1)];if(!i)break;n=i}return S(n)&&b(n)?n:v(e,n,!0)||y(e,n)}function I(e,t){for(var n=[];t&&e&&t!==e;){var o=(0,s.P)(t,!0);if(null===o)return[];n.unshift(Array.prototype.indexOf.call(o.children,t)),t=o}return n}},6105:(e,t,n)=>{"use strict";n.d(t,{O:()=>c,q:()=>u});var o=n(36151),r=n(95876),s="__currentId__",i="id__",a=(0,o.z)()||{};void 0===a[s]&&(a[s]=0);var l=!1;function c(e){if(!l){var t=r.n.getInstance();t&&t.onReset&&t.onReset(u),l=!0}var n=a[s]++;return(void 0===e?i:e)+n}function u(e){void 0===e&&(e=0),a[s]=e}},32305:(e,t,n)=>{"use strict";n.d(t,{_:()=>s});var o=n(76671),r={label:o.q6,audio:o.Sg,video:o.Fo,ol:o.p3,li:o.P4,a:o.t0,button:o.uw,input:o.QQ,textarea:o.Sh,select:o.Cq,option:o.tK,table:o.al,tr:o.g0,th:o.cr,td:o.k3,colGroup:o.lA,col:o.Qf,form:o.Gp,iframe:o.Cs,img:o.xM};function s(e,t,n){var s=e&&r[e]||o.vt;return(0,o.G1)(t,s,n)}},54783:(e,t,n)=>{"use strict";n.d(t,{G:()=>r,P:()=>s});var o=["setState","render","componentWillMount","UNSAFE_componentWillMount","componentDidMount","componentWillReceiveProps","UNSAFE_componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","getSnapshotBeforeUpdate","UNSAFE_componentWillUpdate","componentDidUpdate","componentWillUnmount"];function r(e,t,n){void 0===n&&(n=o);var r=[],s=function(o){"function"!=typeof t[o]||void 0!==e[o]||n&&-1!==n.indexOf(o)||(r.push(o),e[o]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t[o].apply(t,e)})};for(var i in t)s(i);return r}function s(e,t){t.forEach((function(t){return delete e[t]}))}},79316:(e,t,n)=>{"use strict";function o(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}n.d(t,{D:()=>o})},40248:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});var o=n(36151),r=function(){var e,t,n=(0,o.z)();return!!(null===(t=null===(e=n)||void 0===e?void 0:e.navigator)||void 0===t?void 0:t.userAgent)&&n.navigator.userAgent.indexOf("rv:11.0")>-1}},3359:(e,t,n)=>{"use strict";n.d(t,{jg:()=>o.j,ZZ:()=>r.Z,$G:()=>s.$,XI:()=>k.X,KP:()=>E.K,zd:()=>A.z,xS:()=>ke.xS,rm:()=>V.r,Ph:()=>i.P,g6:()=>a.g,II:()=>c,MO:()=>ie.M,h$:()=>u.h,Y2:()=>te.Y2,cK:()=>d.c,M_:()=>h.M,Nx:()=>Ee.Nx,oA:()=>ee.o,Ty:()=>g.Ty,K0:()=>ke.K0,c8:()=>ke.c8,t0:()=>ye.t0,$N:()=>p.$,r1:()=>g.r1,x9:()=>b,xb:()=>S,kp:()=>fe.kp,Sg:()=>ye.Sg,$f:()=>ye.$f,TJ:()=>ye.TJ,uw:()=>ye.uw,lS:()=>ce.lS,ZO:()=>w.Z,lA:()=>ye.lA,Qf:()=>ye.Qf,CR:()=>T.C,jk:()=>ve.j,Kz:()=>g.Kz,J5:()=>ue.J5,KD:()=>Fe.K,AH:()=>C.A,Tx:()=>I.T,mh:()=>ke.mh,JM:()=>ye.JM,SE:()=>Q.SE,s8:()=>R.s,mB:()=>D.m,fY:()=>ke.fY,iU:()=>z.i,Xs:()=>fe.Xs,I6:()=>g.I6,wI:()=>O.w,SL:()=>g.SL,Hc:()=>ke.Hc,x2:()=>ce.x2,Bq:()=>g.Bq,lo:()=>Q.lo,vO:()=>Q.vO,Gp:()=>ye.Gp,GP:()=>Ae.G,i0:()=>L,JV:()=>ce.JV,YE:()=>F.Y,Ep:()=>Q.Ep,j5:()=>Q.j5,oR:()=>Q.oR,nA:()=>Q.nA,OX:()=>J.O,IM:()=>ae.I,Z0:()=>le.Z,dm:()=>Q.dm,Cm:()=>Q.Cm,_B:()=>K._,G1:()=>ye.G1,eX:()=>Q.eX,PA:()=>B.P,yv:()=>Q.yv,Nu:()=>Ne,jI:()=>Te.jI,SM:()=>Te.SM,l:()=>W.l,Al:()=>Se,XJ:()=>ke.XJ,cI:()=>U.c,zk:()=>G.z,D1:()=>me.D1,RK:()=>me.RK,Nh:()=>me.Nh,Gj:()=>Y.G,DI:()=>X.D,vt:()=>ye.vt,Cs:()=>ye.Cs,Ho:()=>ye.Ho,xM:()=>ye.xM,fi:()=>Z.f,as:()=>ne,QQ:()=>ye.QQ,RF:()=>_.R,nY:()=>ee.n,Z5:()=>Q.Z5,HC:()=>Q.HC,S0:()=>Q.S0,J9:()=>Q.J9,lw:()=>Oe.l,un:()=>he.u,cX:()=>ge.c,qQ:()=>N.q,q6:()=>ye.q6,P4:()=>ye.P4,cg:()=>fe.cg,Bj:()=>ue.Bj,av:()=>ue.J9,h1:()=>de.h,_A:()=>f._,NG:()=>M.N,A4:()=>x.A,ss:()=>x.s,qe:()=>pe.q,Ke:()=>s.K,p3:()=>ye.p3,cJ:()=>fe.cJ,on:()=>H.on,tK:()=>ye.tK,s6:()=>q.s,Pj:()=>ce.Pj,BM:()=>$,xR:()=>g.xR,fx:()=>g.fx,Bt:()=>xe.B,qD:()=>J.q,Tk:()=>ue.Tk,Qk:()=>_e.Q,vY:()=>Ce,Cq:()=>ye.Cq,pf:()=>we,Fy:()=>te.Fy,xC:()=>le.x,ET:()=>ue.lw,VR:()=>V.V,DU:()=>Te.DU,v9:()=>Le.v,gs:()=>j.g,K9:()=>Pe.K,ab:()=>fe.ab,_l:()=>Q._l,I4:()=>Ie.I,al:()=>ye.al,k3:()=>ye.k3,Sh:()=>ye.Sh,cr:()=>ye.cr,D3:()=>g.D3,g0:()=>ye.g0,PP:()=>Y.P,mk:()=>P.m,vk:()=>ie.v,zu:()=>fe.zu,Fo:()=>ye.Fo,R8:()=>Pe.R,Jc:()=>Me.J,Ac:()=>xe.A,AW:()=>Re.A,Y8:()=>De.Y});var o=n(16904),r=n(55584),s=n(57504),i=n(56214),a=n(89709),l=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()},c=function(){function e(){}return e.measure=function(t,n){e._timeoutId&&e.setPeriodicReset();var o=l();n();var r=l(),s=e.summary[t]||{totalDuration:0,count:0,all:[]},i=r-o;s.totalDuration+=i,s.count++,s.all.push({duration:i,timeStamp:r}),e.summary[t]=s},e.reset=function(){e.summary={},clearTimeout(e._timeoutId),e._timeoutId=NaN},e.setPeriodicReset=function(){e._timeoutId=setTimeout((function(){return e.reset()}),18e4)},e.summary={},e}(),u=n(88012),d=n(40245),h=n(51189),p=n(62690),f=n(49699),g=n(56173),m=n(98670),y=n(26166),v="undefined"!=typeof WeakMap?new WeakMap:void 0;function b(e){var t=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.state={Component:v?v.get(e.load):void 0},n}return(0,m.C6)(n,t),n.prototype.render=function(){var e=this.props,t=e.forwardedRef,n=e.asyncPlaceholder,o=(0,m.Tt)(e,["forwardedRef","asyncPlaceholder"]),r=this.state.Component;return r?y.createElement(r,(0,m.Cl)((0,m.Cl)({},o),{ref:t})):n?y.createElement(n,null):null},n.prototype.componentDidMount=function(){var t=this;this.state.Component||e.load().then((function(n){n&&(v&&v.set(e.load,n),t.setState({Component:n},e.onLoad))})).catch(e.onError)},n}(y.Component);return y.forwardRef((function(e,n){return y.createElement(t,(0,m.Cl)({},e,{forwardedRef:n}))}))}function S(e){throw new Error("Unexpected object: "+e)}var w=n(93462),T=n(71809),_=n(70672),C=n(44395),k=n(14429),E=n(91348),A=n(94857),I=n(16719),P=n(24194),M=n(38281),x=n(22406),R=n(41602),D=n(60552),O=n(88948),N=n(80566);function L(e,t){void 0===t&&(t=!0);var n=[];if(e){for(var o=0;o<e.children.length;o++)n.push(e.children.item(o));t&&(0,N.q)(e)&&n.push.apply(n,e._virtual.children)}return n}var F=n(57622),B=n(93483),W=n(35853),U=n(72148),G=n(36151),H=n(69730),q=n(15846);function $(e){var t=function(e){var t;return"function"==typeof Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),t}("MouseEvents");t.initEvent("click",!0,!0),e.dispatchEvent(t)}var V=n(7821),j=n(97672),z=n(10759),Q=n(54212),J=n(6105),K=n(32305),Y=n(54783),X=n(79316),Z=n(19328),ee=n(53655),te=n(82914);function ne(e){var t,n=e||(0,G.z)();n&&!0!==(null===(t=n.FabricConfig)||void 0===t?void 0:t.disableFocusRects)&&(n.__hasInitializeFocusRects__||(n.__hasInitializeFocusRects__=!0,n.addEventListener("mousedown",oe,!0),n.addEventListener("pointerdown",re,!0),n.addEventListener("keydown",se,!0)))}function oe(e){(0,te.Fy)(!1,e.target)}function re(e){"mouse"!==e.pointerType&&(0,te.Fy)(!1,e.target)}function se(e){(0,ee.n)(e.which)&&(0,te.Fy)(!0,e.target)}var ie=n(82540),ae=n(48315),le=n(54727),ce=n(20168),ue=n(38044),de=n(58624),he=n(61738),pe=n(41139),fe=n(65977),ge=n(26346),me=n(58652),ye=n(76671),ve=n(77273),be="";function Se(e){return be+e}function we(e){be=e}var Te=n(87018),_e=n(74577),Ce=function(e){var t;return function(n,o){t||(t=new Set,(0,z.i)(e,{componentWillUnmount:function(){t.forEach((function(e){return clearTimeout(e)}))}}));var r=setTimeout((function(){t.delete(r),n()}),o);t.add(r)}},ke=n(44591),Ee=n(79268),Ae=n(15235),Ie=n(20765),Pe=n(47897),Me=n(58473),xe=n(77856),Re=n(57194),De=n(7164),Oe=n(40248);function Ne(e,t){for(var n=(0,m.Cl)({},t),o=0,r=Object.keys(e);o<r.length;o++){var s=r[o];void 0===n[s]&&(n[s]=e[s])}return n}var Le=n(15579),Fe=n(60525);(0,n(30620).v)("@uifabric/utilities","7.38.1")},19328:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});var o=n(10759);function r(e){(0,o.i)(e,{componentDidMount:s,componentDidUpdate:i,componentWillUnmount:a})}function s(){l(this.props.componentRef,this)}function i(e){e.componentRef!==this.props.componentRef&&(l(e.componentRef,null),l(this.props.componentRef,this))}function a(){l(this.props.componentRef,null)}function l(e,t){e&&("object"==typeof e?e.current=t:"function"==typeof e&&e(t))}},48315:(e,t,n)=>{"use strict";n.d(t,{I:()=>l});var o=/[\(\[\{][^\)\]\}]*[\)\]\}]/g,r=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,s=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,i=/\s+/g,a=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function l(e,t,n){return e?(e=function(e){return(e=(e=(e=e.replace(o,"")).replace(r,"")).replace(i," ")).trim()}(e),a.test(e)||!n&&s.test(e)?"":function(e,t){var n="",o=e.split(" ");return 2===o.length?(n+=o[0].charAt(0).toUpperCase(),n+=o[1].charAt(0).toUpperCase()):3===o.length?(n+=o[0].charAt(0).toUpperCase(),n+=o[2].charAt(0).toUpperCase()):0!==o.length&&(n+=o[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},53655:(e,t,n)=>{"use strict";n.d(t,{n:()=>i,o:()=>a});var o,r=n(40245),s=((o={})[r.c.up]=1,o[r.c.down]=1,o[r.c.left]=1,o[r.c.right]=1,o[r.c.home]=1,o[r.c.end]=1,o[r.c.tab]=1,o[r.c.pageUp]=1,o[r.c.pageDown]=1,o);function i(e){return!!s[e]}function a(e){s[e]=1}},54727:(e,t,n)=>{"use strict";n.d(t,{Z:()=>l,x:()=>c});var o,r=n(57622),s=n(36151),i=n(15183),a="language";function l(e){if(void 0===e&&(e="localStorage"),void 0===o){var t=(0,r.Y)(),n="localStorage"===e?function(e){var t=null;try{var n=(0,s.z)();t=n?n.localStorage.getItem(e):null}catch(e){}return t}(a):"sessionStorage"===e?i.G(a):void 0;n&&(o=n),void 0===o&&t&&(o=t.documentElement.getAttribute("lang")),void 0===o&&(o="en")}return o}function c(e,t){var n=(0,r.Y)();n&&n.documentElement.setAttribute("lang",e);var l=!0===t?"none":t||"localStorage";"localStorage"===l?function(e,t){try{var n=(0,s.z)();n&&n.localStorage.setItem(e,t)}catch(e){}}(a,e):"sessionStorage"===l&&i.S(a,e),o=e}},20168:(e,t,n)=>{"use strict";function o(e,t){var n=e.left||e.x||0,o=e.top||e.y||0,r=t.left||t.x||0,s=t.top||t.y||0;return Math.sqrt(Math.pow(n-r,2)+Math.pow(o-s,2))}function r(e){var t,n=e.contentSize,o=e.boundsSize,r=e.mode,s=void 0===r?"contain":r,i=e.maxScale,a=void 0===i?1:i,l=n.width/n.height,c=o.width/o.height;t=("contain"===s?l>c:l<c)?o.width/n.width:o.height/n.height;var u=Math.min(a,t);return{width:n.width*u,height:n.height*u}}function s(e){var t=/[1-9]([0]+$)|\.([0-9]*)/.exec(String(e));return t?t[1]?-t[1].length:t[2]?t[2].length:0:0}function i(e,t,n){void 0===n&&(n=10);var o=Math.pow(n,t);return Math.round(e*o)/o}n.d(t,{JV:()=>o,Pj:()=>i,lS:()=>s,x2:()=>r})},38044:(e,t,n)=>{"use strict";n.d(t,{Bj:()=>d,J5:()=>p,J9:()=>h,Tk:()=>u,lw:()=>c});var o=n(95876),r=!1,s=0,i={empty:!0},a={},l="undefined"==typeof WeakMap?null:WeakMap;function c(e){l=e}function u(){s++}function d(e,t,n){var o=h(n.value&&n.value.bind(null));return{configurable:!0,get:function(){return o}}}function h(e,t,n){if(void 0===t&&(t=100),void 0===n&&(n=!1),!l)return e;if(!r){var c=o.n.getInstance();c&&c.onReset&&o.n.getInstance().onReset(u),r=!0}var d,h=0,p=s;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];var l,c=d;(void 0===d||p!==s||t>0&&h>t)&&(d=f(),h=0,p=s),c=d;for(var u=0;u<o.length;u++){var g=(l=o[u])?"object"==typeof l||"function"==typeof l?l:(a[l]||(a[l]={val:l}),a[l]):i;c.map.has(g)||c.map.set(g,f()),c=c.map.get(g)}return c.hasOwnProperty("value")||(c.value=e.apply(void 0,o),h++),!n||null!==c.value&&void 0!==c.value||(c.value=e.apply(void 0,o)),c.value}}function p(e){if(!l)return e;var t=new l;return function(n){if(!n||"function"!=typeof n&&"object"!=typeof n)return e(n);if(t.has(n))return t.get(n);var o=e(n);return t.set(n,o),o}}function f(){return{map:l?new l:null}}},58624:(e,t,n)=>{"use strict";function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=0,s=t;o<s.length;o++)r(e||{},s[o]);return e}function r(e,t,n){for(var o in void 0===n&&(n=[]),n.push(t),t)if(t.hasOwnProperty(o)&&"__proto__"!==o&&"constructor"!==o&&"prototype"!==o){var s=t[o];if("object"!=typeof s||null===s||Array.isArray(s))e[o]=s;else{var i=n.indexOf(s)>-1;e[o]=i?s:r(e[o]||{},s,n)}}return n.pop(),e}n.d(t,{h:()=>o})},61738:(e,t,n)=>{"use strict";n.d(t,{u:()=>o});var o=function(){return!!(window&&window.navigator&&window.navigator.userAgent)&&/iPad|iPhone|iPod/i.test(window.navigator.userAgent)}},41139:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});var o=n(57622);function r(e){for(var t,n=[],r=(0,o.Y)(e)||document;e!==r.body;){for(var s=0,i=e.parentElement.children;s<i.length;s++){var a=i[s];a!==e&&"true"!==(null===(t=a.getAttribute("aria-hidden"))||void 0===t?void 0:t.toLowerCase())&&n.push(a)}if(!e.parentElement)break;e=e.parentElement}return n.forEach((function(e){e.setAttribute("aria-hidden","true")})),function(){!function(e){e.forEach((function(e){e.setAttribute("aria-hidden","false")}))}(n),n=[]}}},65977:(e,t,n)=>{"use strict";function o(e,t){for(var n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||t[n]!==e[n]))return!1;for(var n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return s.apply(this,[null,e].concat(t))}function s(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];t=t||{};for(var r=0,s=n;r<s.length;r++){var i=s[r];if(i)for(var a in i)!i.hasOwnProperty(a)||e&&!e(a)||(t[a]=i[a])}return t}function i(e,t){return Object.keys(e).map((function(n){if(String(Number(n))!==n)return t(n,e[n])})).filter((function(e){return!!e}))}function a(e){return Object.keys(e).reduce((function(t,n){return t.push(e[n]),t}),[])}function l(e,t){var n={};for(var o in e)-1===t.indexOf(o)&&e.hasOwnProperty(o)&&(n[o]=e[o]);return n}n.d(t,{Xs:()=>s,ab:()=>o,cJ:()=>l,cg:()=>i,kp:()=>r,zu:()=>a})},26346:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});var o,r=n(36151);function s(e){if(void 0===o||e){var t=(0,r.z)(),n=t&&t.navigator.userAgent;o=!!n&&-1!==n.indexOf("Macintosh")}return!!o}},58652:(e,t,n)=>{"use strict";function o(e){return e.clientWidth<e.scrollWidth}function r(e){return e.clientHeight<e.scrollHeight}function s(e){return o(e)||r(e)}n.d(t,{D1:()=>o,Nh:()=>r,RK:()=>s})},76671:(e,t,n)=>{"use strict";n.d(t,{$f:()=>r,Cq:()=>m,Cs:()=>k,Fo:()=>c,G1:()=>P,Gp:()=>C,Ho:()=>A,JM:()=>I,P4:()=>d,QQ:()=>f,Qf:()=>_,Sg:()=>l,Sh:()=>g,TJ:()=>s,al:()=>v,cr:()=>S,g0:()=>b,k3:()=>w,lA:()=>T,p3:()=>u,q6:()=>a,t0:()=>h,tK:()=>y,uw:()=>p,vt:()=>i,xM:()=>E});var o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},o=0,r=e;o<r.length;o++)for(var s=r[o],i=0,a=Array.isArray(s)?s:Object.keys(s);i<a.length;i++)n[a[i]]=1;return n},r=o(["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),s=o(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),i=o(s,r),a=o(i,["form"]),l=o(i,["height","loop","muted","preload","src","width"]),c=o(l,["poster"]),u=o(i,["start"]),d=o(i,["value"]),h=o(i,["download","href","hrefLang","media","rel","target","type"]),p=o(i,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),f=o(p,["accept","alt","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),g=o(p,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),m=o(p,["form","multiple","required"]),y=o(i,["selected","value"]),v=o(i,["cellPadding","cellSpacing"]),b=i,S=o(i,["rowSpan","scope"]),w=o(i,["colSpan","headers","rowSpan","scope"]),T=o(i,["span"]),_=o(i,["span"]),C=o(i,["acceptCharset","action","encType","encType","method","noValidate","target"]),k=o(i,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),E=o(i,["alt","crossOrigin","height","src","srcSet","useMap","width"]),A=E,I=i;function P(e,t,n){for(var o,r=Array.isArray(t),s={},i=0,a=Object.keys(e);i<a.length;i++){var l=a[i];!(!r&&t[l]||r&&t.indexOf(l)>=0||0===l.indexOf("data-")||0===l.indexOf("aria-"))||n&&-1!==(null===(o=n)||void 0===o?void 0:o.indexOf(l))||(s[l]=e[l])}return s}},77273:(e,t,n)=>{"use strict";n.d(t,{j:()=>s});var o=n(38044),r=(0,o.J5)((function(e){return(0,o.J5)((function(t){var n=(0,o.J5)((function(e){return function(n){return t(n,e)}}));return function(o,r){return e(o,r?n(r):t)}}))}));function s(e,t){return r(e)(t)}},87018:(e,t,n)=>{"use strict";n.d(t,{DU:()=>u,SM:()=>d,jI:()=>c});var o,r=n(40245),s=n(57622),i=n(15183),a=n(17060),l="isRTL";function c(e){if(void 0===e&&(e={}),void 0!==e.rtl)return e.rtl;if(void 0===o){var t=(0,i.G)(l);null!==t&&u(o="1"===t);var n=(0,s.Y)();void 0===o&&n&&(o="rtl"===(n.body&&n.body.getAttribute("dir")||n.documentElement.getAttribute("dir")),(0,a.DU)(o))}return!!o}function u(e,t){void 0===t&&(t=!1);var n=(0,s.Y)();n&&n.documentElement.setAttribute("dir",e?"rtl":"ltr"),t&&(0,i.S)(l,e?"1":"0"),o=e,(0,a.DU)(o)}function d(e,t){return void 0===t&&(t={}),c(t)&&(e===r.c.left?e=r.c.right:e===r.c.right&&(e=r.c.left)),e}},74577:(e,t,n)=>{"use strict";n.d(t,{Q:()=>r});var o=n(10759),r=function(e){var t;return function(n){t||(t=new Set,(0,o.i)(e,{componentWillUnmount:function(){t.forEach((function(e){return cancelAnimationFrame(e)}))}}));var r=requestAnimationFrame((function(){t.delete(r),n()}));t.add(r)}}},44591:(e,t,n)=>{"use strict";n.d(t,{Hc:()=>m,K0:()=>d,XJ:()=>g,c8:()=>u,fY:()=>f,mh:()=>p,xS:()=>c});var o,r=n(57622),s=n(16536),i=n(36151),a=0,l=(0,s.Z)({overflow:"hidden !important"}),c="data-is-scrollable",u=function(e,t){if(e){var n=0,o=null;t.on(e,"touchstart",(function(e){1===e.targetTouches.length&&(n=e.targetTouches[0].clientY)}),{passive:!1}),t.on(e,"touchmove",(function(e){if(1===e.targetTouches.length&&(e.stopPropagation(),o)){var t=e.targetTouches[0].clientY-n,r=m(e.target);r&&(o=r),0===o.scrollTop&&t>0&&e.preventDefault(),o.scrollHeight-Math.ceil(o.scrollTop)<=o.clientHeight&&t<0&&e.preventDefault()}}),{passive:!1}),o=e}},d=function(e,t){e&&t.on(e,"touchmove",(function(e){e.stopPropagation()}),{passive:!1})},h=function(e){e.preventDefault()};function p(){var e=(0,r.Y)();e&&e.body&&!a&&(e.body.classList.add(l),e.body.addEventListener("touchmove",h,{passive:!1,capture:!1})),a++}function f(){if(a>0){var e=(0,r.Y)();e&&e.body&&1===a&&(e.body.classList.remove(l),e.body.removeEventListener("touchmove",h)),a--}}function g(){if(void 0===o){var e=document.createElement("div");e.style.setProperty("width","100px"),e.style.setProperty("height","100px"),e.style.setProperty("overflow","scroll"),e.style.setProperty("position","absolute"),e.style.setProperty("top","-9999px"),document.body.appendChild(e),o=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return o}function m(e){for(var t=e,n=(0,r.Y)(e);t&&t!==n.body;){if("true"===t.getAttribute(c))return t;t=t.parentElement}for(t=e;t&&t!==n.body;){if("false"!==t.getAttribute(c)){var o=getComputedStyle(t),s=o?o.getPropertyValue("overflow-y"):"";if(s&&("scroll"===s||"auto"===s))return t}t=t.parentElement}return t&&t!==n.body||(t=(0,i.z)(e)),t}},67139:(e,t,n)=>{"use strict";n.d(t,{L:()=>s});var o=n(79268),r=n(89709),s=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0]||{},r=n.onSelectionChanged,s=n.onItemsChanged,a=n.getKey,l=n.canSelectItem,c=void 0===l?function(){return!0}:l,u=n.items,d=n.selectionMode,h=void 0===d?o.Qc.multiple:d;this.mode=h,this._getKey=a||i,this._changeEventSuppressionCount=0,this._exemptedCount=0,this._anchoredIndex=0,this._unselectableCount=0,this._onSelectionChanged=r,this._onItemsChanged=s,this._canSelectItem=c,this._keyToIndexMap={},this._isModal=!1,this.setItems(u||[],!0),this.count=this.getSelectedCount()}return e.prototype.canSelectItem=function(e,t){return!("number"==typeof t&&t<0)&&this._canSelectItem(e,t)},e.prototype.getKey=function(e,t){var n=this._getKey(e,t);return"number"==typeof n||n?""+n:""},e.prototype.setChangeEvents=function(e,t){this._changeEventSuppressionCount+=e?-1:1,0===this._changeEventSuppressionCount&&this._hasChanged&&(this._hasChanged=!1,t||this._change())},e.prototype.isModal=function(){return this._isModal},e.prototype.setModal=function(e){this._isModal!==e&&(this.setChangeEvents(!1),this._isModal=e,e||this.setAllSelected(!1),this._change(),this.setChangeEvents(!0))},e.prototype.setItems=function(e,t){void 0===t&&(t=!0);var n={},s={},i=!1;this.setChangeEvents(!1),this._unselectableCount=0;for(var a=!1,l=0;l<e.length;l++)(h=e[l])&&(v=this.getKey(h,l))&&(a||v in this._keyToIndexMap&&this._keyToIndexMap[v]===l||(a=!0),n[v]=l),s[l]=h&&!this.canSelectItem(h),s[l]&&this._unselectableCount++;(t||0===e.length)&&this._setAllSelected(!1,!0);var c={},u=0;for(var d in this._exemptedIndices)if(this._exemptedIndices.hasOwnProperty(d)){var h,p=Number(d),f=(h=this._items[p])?this.getKey(h,Number(p)):void 0,g=f?n[f]:p;void 0===g?i=!0:(c[g]=!0,u++,i=i||g!==p)}if(this._items&&0===this._exemptedCount&&e.length!==this._items.length&&this._isAllSelected&&(i=!0),!a)for(var m=0,y=Object.keys(this._keyToIndexMap);m<y.length;m++){var v;if(!((v=y[m])in n)){a=!0;break}}this._exemptedIndices=c,this._exemptedCount=u,this._keyToIndexMap=n,this._unselectableIndices=s,this._items=e,this._selectedItems=null,i&&this._updateCount(),a&&(r.g.raise(this,o.Nx),this._onItemsChanged&&this._onItemsChanged()),i&&this._change(),this.setChangeEvents(!0)},e.prototype.getItems=function(){return this._items},e.prototype.getSelection=function(){if(!this._selectedItems){this._selectedItems=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedItems.push(e[t])}return this._selectedItems},e.prototype.getSelectedCount=function(){return this._isAllSelected?this._items.length-this._exemptedCount-this._unselectableCount:this._exemptedCount},e.prototype.getSelectedIndices=function(){if(!this._selectedIndices){this._selectedIndices=[];var e=this._items;if(e)for(var t=0;t<e.length;t++)this.isIndexSelected(t)&&this._selectedIndices.push(t)}return this._selectedIndices},e.prototype.getItemIndex=function(e){var t=this._keyToIndexMap[e];return null!=t?t:-1},e.prototype.isRangeSelected=function(e,t){if(0===t)return!1;for(var n=e+t,o=e;o<n;o++)if(!this.isIndexSelected(o))return!1;return!0},e.prototype.isAllSelected=function(){var e=this._items.length-this._unselectableCount;return this.mode===o.Qc.single&&(e=Math.min(e,1)),this.count>0&&this._isAllSelected&&0===this._exemptedCount||!this._isAllSelected&&this._exemptedCount===e&&e>0},e.prototype.isKeySelected=function(e){var t=this._keyToIndexMap[e];return this.isIndexSelected(t)},e.prototype.isIndexSelected=function(e){return!!(this.count>0&&this._isAllSelected&&!this._exemptedIndices[e]&&!this._unselectableIndices[e]||!this._isAllSelected&&this._exemptedIndices[e])},e.prototype.setAllSelected=function(e){if(!e||this.mode===o.Qc.multiple){var t=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),t>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount()),this.setChangeEvents(!0)}},e.prototype.setKeySelected=function(e,t,n){var o=this._keyToIndexMap[e];o>=0&&this.setIndexSelected(o,t,n)},e.prototype.setIndexSelected=function(e,t,n){if(this.mode!==o.Qc.none&&!((e=Math.min(Math.max(0,e),this._items.length-1))<0||e>=this._items.length)){this.setChangeEvents(!1);var r=this._exemptedIndices[e];!this._unselectableIndices[e]&&(t&&this.mode===o.Qc.single&&this._setAllSelected(!1,!0),r&&(t&&this._isAllSelected||!t&&!this._isAllSelected)&&(delete this._exemptedIndices[e],this._exemptedCount--),!r&&(t&&!this._isAllSelected||!t&&this._isAllSelected)&&(this._exemptedIndices[e]=!0,this._exemptedCount++),n&&(this._anchoredIndex=e)),this._updateCount(),this.setChangeEvents(!0)}},e.prototype.setRangeSelected=function(e,t,n,r){if(this.mode!==o.Qc.none&&(e=Math.min(Math.max(0,e),this._items.length-1),t=Math.min(Math.max(0,t),this._items.length-e),!(e<0||e>=this._items.length||0===t))){this.setChangeEvents(!1);for(var s=e,i=e+t-1,a=(this._anchoredIndex||0)>=i?s:i;s<=i;s++)this.setIndexSelected(s,n,!!r&&s===a);this.setChangeEvents(!0)}},e.prototype.selectToKey=function(e,t){this.selectToIndex(this._keyToIndexMap[e],t)},e.prototype.selectToRange=function(e,t,n){if(this.mode!==o.Qc.none)if(this.mode!==o.Qc.single){var r=this._anchoredIndex||0,s=Math.min(e,r),i=Math.max(e+t-1,r);for(this.setChangeEvents(!1),n&&this._setAllSelected(!1,!0);s<=i;s++)this.setIndexSelected(s,!0,!1);this.setChangeEvents(!0)}else 1===t&&this.setIndexSelected(e,!0,!0)},e.prototype.selectToIndex=function(e,t){if(this.mode!==o.Qc.none)if(this.mode!==o.Qc.single){var n=this._anchoredIndex||0,r=Math.min(e,n),s=Math.max(e,n);for(this.setChangeEvents(!1),t&&this._setAllSelected(!1,!0);r<=s;r++)this.setIndexSelected(r,!0,!1);this.setChangeEvents(!0)}else this.setIndexSelected(e,!0,!0)},e.prototype.toggleAllSelected=function(){this.setAllSelected(!this.isAllSelected())},e.prototype.toggleKeySelected=function(e){this.setKeySelected(e,!this.isKeySelected(e),!0)},e.prototype.toggleIndexSelected=function(e){this.setIndexSelected(e,!this.isIndexSelected(e),!0)},e.prototype.toggleRangeSelected=function(e,t){if(this.mode!==o.Qc.none){var n=this.isRangeSelected(e,t),r=e+t;if(!(this.mode===o.Qc.single&&t>1)){this.setChangeEvents(!1);for(var s=e;s<r;s++)this.setIndexSelected(s,!n,!1);this.setChangeEvents(!0)}}},e.prototype._updateCount=function(e){void 0===e&&(e=!1);var t=this.getSelectedCount();t!==this.count&&(this.count=t,this._change()),this.count||e||this.setModal(!1)},e.prototype._setAllSelected=function(e,t){if(void 0===t&&(t=!1),!e||this.mode===o.Qc.multiple){var n=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),n>0&&(this._exemptedCount>0||e!==this._isAllSelected)&&(this._exemptedIndices={},(e!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=e,this._change()),this._updateCount(t)),this.setChangeEvents(!0)}},e.prototype._change=function(){0===this._changeEventSuppressionCount?(this._selectedItems=null,this._selectedIndices=void 0,r.g.raise(this,o.ij),this._onSelectionChanged&&this._onSelectionChanged()):this._hasChanged=!0},e}();function i(e,t){var n=(e||{}).key;return void 0===n?""+t:n}},79268:(e,t,n)=>{"use strict";n.d(t,{Nx:()=>i,Qc:()=>o,SB:()=>r,ij:()=>s});var o,r,s="change",i="items-change";!function(e){e[e.none=0]="none",e[e.single=1]="single",e[e.multiple=2]="multiple"}(o||(o={})),function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(r||(r={}))},15183:(e,t,n)=>{"use strict";n.d(t,{G:()=>r,S:()=>s});var o=n(36151);function r(e){var t=null;try{var n=(0,o.z)();t=n?n.sessionStorage.getItem(e):null}catch(e){}return t}function s(e,t){var n;try{null===(n=(0,o.z)())||void 0===n||n.sessionStorage.setItem(e,t)}catch(e){}}},82914:(e,t,n)=>{"use strict";n.d(t,{Fy:()=>i,Y2:()=>r});var o=n(36151),r="ms-Fabric--isFocusVisible",s="ms-Fabric--isFocusHidden";function i(e,t){var n=t?(0,o.z)(t):(0,o.z)();if(n){var i=n.document.body.classList;i.add(e?r:s),i.remove(e?s:r)}}},15235:(e,t,n)=>{"use strict";n.d(t,{G:()=>s});var o=/[\{\}]/g,r=/\{\d+\}/g;function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var s=t;return e.replace(r,(function(e){var t=s[e.replace(o,"")];return null==t&&(t=""),t}))}},20765:(e,t,n)=>{"use strict";n.d(t,{I:()=>l});var o=n(98670),r=n(26166),s=n(49742),i=n(24194),a=["theme","styles"];function l(e,t,n,l,c){var u=(l=l||{scope:"",fields:void 0}).scope,d=l.fields,h=void 0===d?a:d,p=r.forwardRef((function(a,l){var c=r.useRef(),d=(0,i.m)(h,u),p=d.styles,f=(d.dir,(0,o.Tt)(d,["styles","dir"])),g=n?n(a):void 0,m=c.current&&c.current.__cachedInputs__||[];if(!c.current||p!==m[1]||a.styles!==m[2]){var y=function(e){return(0,s.p)(e,t,p,a.styles)};y.__cachedInputs__=[t,p,a.styles],y.__noStyleOverride__=!p&&!a.styles,c.current=y}return r.createElement(e,(0,o.Cl)({ref:l},f,g,a,{styles:c.current}))}));p.displayName="Styled"+(e.displayName||e.name);var f=c?r.memo(p):p;return p.displayName&&(f.displayName=p.displayName),f}},82540:(e,t,n)=>{"use strict";n.d(t,{M:()=>u,v:()=>c});var o=n(26166),r=n(36151),s=n(53655),i=n(82914),a=new WeakMap;function l(e,t){var n,o=a.get(e);return n=o?o+t:1,a.set(e,n),n}function c(e){o.useEffect((function(){var t,n,o=(0,r.z)(null===(t=e)||void 0===t?void 0:t.current);if(o&&!0!==(null===(n=o.FabricConfig)||void 0===n?void 0:n.disableFocusRects)){var s=l(o,1);return s<=1&&(o.addEventListener("mousedown",d,!0),o.addEventListener("pointerdown",h,!0),o.addEventListener("keydown",p,!0)),function(){var e;o&&!0!==(null===(e=o.FabricConfig)||void 0===e?void 0:e.disableFocusRects)&&0===(s=l(o,-1))&&(o.removeEventListener("mousedown",d,!0),o.removeEventListener("pointerdown",h,!0),o.removeEventListener("keydown",p,!0))}}}),[e])}var u=function(e){return c(e.rootRef),null};function d(e){(0,i.Fy)(!1,e.target)}function h(e){"mouse"!==e.pointerType&&(0,i.Fy)(!1,e.target)}function p(e){(0,s.n)(e.which)&&(0,i.Fy)(!0,e.target)}},47897:(e,t,n)=>{"use strict";function o(e){console&&console.warn&&console.warn(e)}function r(e){}n.d(t,{K:()=>r,R:()=>o})},58473:(e,t,n)=>{"use strict";function o(e,t,n,o,r){}n.d(t,{J:()=>o})},77856:(e,t,n)=>{"use strict";function o(){}function r(e){}n.d(t,{A:()=>r,B:()=>o})},57194:(e,t,n)=>{"use strict";function o(e,t,n){}n.d(t,{A:()=>o})},7164:(e,t,n)=>{"use strict";function o(e,t,n){}n.d(t,{Y:()=>o})},65618:function(e,t){var n="undefined"!=typeof self?self:this,o=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n="URLSearchParams"in e,o="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),s="FormData"in e,i="ArrayBuffer"in e;if(i)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function u(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return o&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function g(e){var t=new FileReader,n=f(t);return t.readAsArrayBuffer(e),n}function m(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:s&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():i&&r&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=m(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i&&(ArrayBuffer.prototype.isPrototypeOf(e)||l(e))?this._bodyArrayBuffer=m(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,n,o=p(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,n=f(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),o=0;o<t.length;o++)n[o]=String.fromCharCode(t[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=c(e),t=u(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},h.prototype.delete=function(e){delete this.map[c(e)]},h.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},h.prototype.set=function(e,t){this.map[c(e)]=u(t)},h.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},h.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),d(e)},h.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},h.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),d(e)},o&&(h.prototype[Symbol.iterator]=h.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var n,o,r=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new h(t.headers)),this.method=(o=(n=t.method||this.method||"GET").toUpperCase(),v.indexOf(o)>-1?o:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function S(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),o=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(r))}})),t}function w(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},y.call(b.prototype),y.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var T=[301,302,303,307,308];w.redirect=function(e,t){if(-1===T.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function _(e,n){return new Promise((function(o,s){var i=new b(e,n);if(i.signal&&i.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function l(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),o=n.shift().trim();if(o){var r=n.join(":").trim();t.append(o,r)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var r="response"in a?a.response:a.responseText;o(new w(r,n))},a.onerror=function(){s(new TypeError("Network request failed"))},a.ontimeout=function(){s(new TypeError("Network request failed"))},a.onabort=function(){s(new t.DOMException("Aborted","AbortError"))},a.open(i.method,i.url,!0),"include"===i.credentials?a.withCredentials=!0:"omit"===i.credentials&&(a.withCredentials=!1),"responseType"in a&&r&&(a.responseType="blob"),i.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),i.signal&&(i.signal.addEventListener("abort",l),a.onreadystatechange=function(){4===a.readyState&&i.signal.removeEventListener("abort",l)}),a.send(void 0===i._bodyInit?null:i._bodyInit)}))}_.polyfill=!0,e.fetch||(e.fetch=_,e.Headers=h,e.Request=b,e.Response=w),t.Headers=h,t.Request=b,t.Response=w,t.fetch=_,Object.defineProperty(t,"__esModule",{value:!0})}({})}(o),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var r=o;(t=r.fetch).default=r.fetch,t.fetch=r.fetch,t.Headers=r.Headers,t.Request=r.Request,t.Response=r.Response,e.exports=t},60221:e=>{"use strict";function t(e){if(this._capacity=o(e),this._length=0,this._front=0,n(e)){for(var t=e.length,r=0;r<t;++r)this[r]=e[r];this._length=t}}t.prototype.toArray=function(){for(var e=this._length,t=new Array(e),n=this._front,o=this._capacity,r=0;r<e;++r)t[r]=this[n+r&o-1];return t},t.prototype.push=function(e){var t=arguments.length,n=this._length;if(t>1){var o=this._capacity;if(n+t>o){for(var r=0;r<t;++r)this._checkCapacity(n+1),this[s=this._front+n&this._capacity-1]=arguments[r],n++,this._length=n;return n}var s=this._front;for(r=0;r<t;++r)this[s+n&o-1]=arguments[r],s++;return this._length=n+t,n+t}return 0===t?n:(this._checkCapacity(n+1),this[r=this._front+n&this._capacity-1]=e,this._length=n+1,n+1)},t.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,n=this[t];return this[t]=void 0,this._length=e-1,n}},t.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,n=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,n}},t.prototype.unshift=function(e){var t=this._length,n=arguments.length;if(n>1){if(t+n>(r=this._capacity)){for(var o=n-1;o>=0;o--){this._checkCapacity(t+1);var r=this._capacity;this[i=(this._front-1&r-1^r)-r]=arguments[o],t++,this._length=t,this._front=i}return t}var s=this._front;for(o=n-1;o>=0;o--){var i;this[i=(s-1&r-1^r)-r]=arguments[o],s=i}return this._front=s,this._length=t+n,t+n}return 0===n?t:(this._checkCapacity(t+1),r=this._capacity,this[o=(this._front-1&r-1^r)-r]=e,this._length=t+1,this._front=o,t+1)},t.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},t.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},t.prototype.get=function(e){var t=e;if(t===(0|t)){var n=this._length;if(t<0&&(t+=n),!(t<0||t>=n))return this[this._front+t&this._capacity-1]}},t.prototype.isEmpty=function(){return 0===this._length},t.prototype.clear=function(){for(var e=this._length,t=this._front,n=this._capacity,o=0;o<e;++o)this[t+o&n-1]=void 0;this._length=0,this._front=0},t.prototype.toString=function(){return this.toArray().toString()},t.prototype.valueOf=t.prototype.toString,t.prototype.removeFront=t.prototype.shift,t.prototype.removeBack=t.prototype.pop,t.prototype.insertFront=t.prototype.unshift,t.prototype.insertBack=t.prototype.push,t.prototype.enqueue=t.prototype.push,t.prototype.dequeue=t.prototype.shift,t.prototype.toJSON=t.prototype.toArray,Object.defineProperty(t.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),t.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(o(1.5*this._capacity+16))},t.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,o=this._length;n+o>t&&function(e,t,n,o,r){for(var s=0;s<r;++s)n[s+o]=e[s+0],e[s+0]=void 0}(this,0,this,t,n+o&t-1)};var n=Array.isArray;function o(e){if("number"!=typeof e){if(!n(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,1+((t|=t>>8)|t>>16);var t}e.exports=t},6731:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function o(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function s(e,t,o,s,i){if("function"!=typeof o)throw new TypeError("The listener must be a function");var a=new r(o,s||e,i),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function i(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function a(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,o,r=[];if(0===this._eventsCount)return r;for(o in e=this._events)t.call(e,o)&&r.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},a.prototype.listeners=function(e){var t=n?n+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var r=0,s=o.length,i=new Array(s);r<s;r++)i[r]=o[r].fn;return i},a.prototype.listenerCount=function(e){var t=n?n+e:e,o=this._events[t];return o?o.fn?1:o.length:0},a.prototype.emit=function(e,t,o,r,s,i){var a=n?n+e:e;if(!this._events[a])return!1;var l,c,u=this._events[a],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,o),!0;case 4:return u.fn.call(u.context,t,o,r),!0;case 5:return u.fn.call(u.context,t,o,r,s),!0;case 6:return u.fn.call(u.context,t,o,r,s,i),!0}for(c=1,l=new Array(d-1);c<d;c++)l[c-1]=arguments[c];u.fn.apply(u.context,l)}else{var h,p=u.length;for(c=0;c<p;c++)switch(u[c].once&&this.removeListener(e,u[c].fn,void 0,!0),d){case 1:u[c].fn.call(u[c].context);break;case 2:u[c].fn.call(u[c].context,t);break;case 3:u[c].fn.call(u[c].context,t,o);break;case 4:u[c].fn.call(u[c].context,t,o,r);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];u[c].fn.apply(u[c].context,l)}}return!0},a.prototype.on=function(e,t,n){return s(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return s(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,o,r){var s=n?n+e:e;if(!this._events[s])return this;if(!t)return i(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||r&&!a.once||o&&a.context!==o||i(this,s);else{for(var l=0,c=[],u=a.length;l<u;l++)(a[l].fn!==t||r&&!a[l].once||o&&a[l].context!==o)&&c.push(a[l]);c.length?this._events[s]=1===c.length?c[0]:c:i(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&i(this,t)):(this._events=new o,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a},18156:e=>{"use strict";var t,n="object"==typeof Reflect?Reflect:null,o=n&&"function"==typeof n.apply?n.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(n,o){function r(n){e.removeListener(t,s),o(n)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}g(e,t,s,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,r)}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var i=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,n,o){var r,s,i,c;if(a(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),i=s[t]),void 0===i)i=s[t]=n,++e._eventsCount;else if("function"==typeof i?i=s[t]=o?[n,i]:[i,n]:o?i.unshift(n):i.push(n),(r=l(e))>0&&i.length>r&&!i.warned){i.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=i.length,c=u,console&&console.warn&&console.warn(c)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=u.bind(o);return r.listener=n,o.wrapFn=r,r}function h(e,t,n){var o=e._events;if(void 0===o)return[];var r=o[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):f(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}function g(e,t,n,o){if("function"==typeof e.on)o.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(s){o.once&&e.removeEventListener(t,r),n(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var l=s[e];if(void 0===l)return!1;if("function"==typeof l)o(l,this,t);else{var c=l.length,u=f(l,c);for(n=0;n<c;++n)o(u[n],this,t)}return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,d(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,d(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,o,r,s,i;if(a(t),void 0===(o=this._events))return this;if(void 0===(n=o[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){i=n[s].listener,r=s;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(o[e]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",e,i||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,s=Object.keys(n);for(o=0;o<s.length;++o)"removeListener"!==(r=s[o])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(o=t.length-1;o>=0;o--)this.removeListener(e,t[o]);return this},s.prototype.listeners=function(e){return h(this,e,!0)},s.prototype.rawListeners=function(e){return h(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},92792:e=>{"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var o,r,s;if(Array.isArray(t)){if((o=t.length)!=n.length)return!1;for(r=o;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((o=(s=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(r=o;0!=r--;)if(!Object.prototype.hasOwnProperty.call(n,s[r]))return!1;for(r=o;0!=r--;){var i=s[r];if(!e(t[i],n[i]))return!1}return!0}return t!=t&&n!=n}},20731:function(e,t,n){!function(e){"use strict";function t(e){for(var t=0,n=Math.min(65536,e.length+1),o=new Uint16Array(n),r=[],s=0;;){var i=t<e.length;if(!i||s>=n-1){var a=o.subarray(0,s);if(r.push(String.fromCharCode.apply(null,a)),!i)return r.join("");e=e.subarray(t),t=0,s=0}var l=e[t++];if(128&l){if(192==(224&l)){var c=63&e[t++];o[s++]=(31&l)<<6|c}else if(224==(240&l)){c=63&e[t++];var u=63&e[t++];o[s++]=(31&l)<<12|c<<6|u}else if(240==(248&l)){var d=(7&l)<<18|(c=63&e[t++])<<12|(u=63&e[t++])<<6|63&e[t++];d>65535&&(d-=65536,o[s++]=d>>>10&1023|55296,d=56320|1023&d),o[s++]=d}}else o[s++]=l}}var n="Failed to ",o=function(e,t,o){if(e)throw new Error("".concat(n).concat(t,": the '").concat(o,"' option is unsupported."))},r="function"==typeof Buffer&&Buffer.from,s=r?function(e){return Buffer.from(e)}:function(e){for(var t=0,n=e.length,o=0,r=Math.max(32,n+(n>>>1)+7),s=new Uint8Array(r>>>3<<3);t<n;){var i=e.charCodeAt(t++);if(i>=55296&&i<=56319){if(t<n){var a=e.charCodeAt(t);56320==(64512&a)&&(++t,i=((1023&i)<<10)+(1023&a)+65536)}if(i>=55296&&i<=56319)continue}if(o+4>s.length){r+=8,r=(r*=1+t/e.length*2)>>>3<<3;var l=new Uint8Array(r);l.set(s),s=l}if(4294967168&i){if(4294965248&i)if(4294901760&i){if(4292870144&i)continue;s[o++]=i>>>18&7|240,s[o++]=i>>>12&63|128,s[o++]=i>>>6&63|128}else s[o++]=i>>>12&15|224,s[o++]=i>>>6&63|128;else s[o++]=i>>>6&31|192;s[o++]=63&i|128}else s[o++]=i}return s.slice?s.slice(0,o):s.subarray(0,o)};function i(){this.encoding="utf-8"}i.prototype.encode=function(e,t){return o(t&&t.stream,"encode","stream"),s(e)};var a=!r&&"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL,l=["utf-8","utf8","unicode-1-1-utf-8"],c=t;r?c=function(e,t){return(e instanceof Buffer?e:Buffer.from(e.buffer,e.byteOffset,e.byteLength)).toString(t)}:a&&(c=function(e){try{return function(e){var t;try{var n=new Blob([e],{type:"text/plain;charset=UTF-8"});t=URL.createObjectURL(n);var o=new XMLHttpRequest;return o.open("GET",t,!1),o.send(),o.responseText}finally{t&&URL.revokeObjectURL(t)}}(e)}catch(n){return t(e)}});var u="construct 'TextDecoder'",d="".concat(n," ").concat(u,": the ");function h(e,t){if(o(t&&t.fatal,u,"fatal"),e=e||"utf-8",!(r?Buffer.isEncoding(e):-1!==l.indexOf(e.toLowerCase())))throw new RangeError("".concat(d," encoding label provided ('").concat(e,"') is invalid."));this.encoding=e,this.fatal=!1,this.ignoreBOM=!1}h.prototype.decode=function(e,t){var n;return o(t&&t.stream,"decode","stream"),n=e instanceof Uint8Array?e:e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):new Uint8Array(e),c(n,this.encoding)},e.TextEncoder=e.TextEncoder||i,e.TextDecoder=e.TextDecoder||h}("undefined"!=typeof window?window:void 0!==n.g?n.g:this)},93710:e=>{"use strict";e.exports=function(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];if(function(e){if(void 0===e)throw new Error("invariant(...): Second argument must be a string.")}(t),!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var i=0;(s=new Error(t.replace(/%s/g,(function(){return String(o[i++])})))).name="Invariant Violation"}throw s.framesToPop=1,s}}},73275:(e,t,n)=>{e.exports.Dispatcher=n(98566)},98566:(e,t,n)=>{"use strict";t.__esModule=!0;var o=n(93710),r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return e.prototype.register=function(e){var t="ID_"+this._lastID++;return this._callbacks[t]=e,t},e.prototype.unregister=function(e){this._callbacks[e]||o(!1),delete this._callbacks[e]},e.prototype.waitFor=function(e){this._isDispatching||o(!1);for(var t=0;t<e.length;t++){var n=e[t];this._isPending[n]?this._isHandled[n]||o(!1):(this._callbacks[n]||o(!1),this._invokeCallback(n))}},e.prototype.dispatch=function(e){this._isDispatching&&o(!1),this._startDispatching(e);try{for(var t in this._callbacks)this._isPending[t]||this._invokeCallback(t)}finally{this._stopDispatching()}},e.prototype.isDispatching=function(){return this._isDispatching},e.prototype._invokeCallback=function(e){this._isPending[e]=!0,this._callbacks[e](this._pendingPayload),this._isHandled[e]=!0},e.prototype._startDispatching=function(e){for(var t in this._callbacks)this._isPending[t]=!1,this._isHandled[t]=!1;this._pendingPayload=e,this._isDispatching=!0},e.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},e}();e.exports=r},27331:(e,t,n)=>{"use strict";n.r(t),n.d(t,{createBrowserHistory:()=>C,createHashHistory:()=>M,createLocation:()=>m,createMemoryHistory:()=>R,createPath:()=>g,locationsAreEqual:()=>y,parsePath:()=>f});var o=n(26443);function r(e){return"/"===e.charAt(0)}function s(e,t){for(var n=t,o=n+1,r=e.length;o<r;n+=1,o+=1)e[n]=e[o];e.pop()}const i=function(e,t){void 0===t&&(t="");var n,o=e&&e.split("/")||[],i=t&&t.split("/")||[],a=e&&r(e),l=t&&r(t),c=a||l;if(e&&r(e)?i=o:o.length&&(i.pop(),i=i.concat(o)),!i.length)return"/";if(i.length){var u=i[i.length-1];n="."===u||".."===u||""===u}else n=!1;for(var d=0,h=i.length;h>=0;h--){var p=i[h];"."===p?s(i,h):".."===p?(s(i,h),d++):d&&(s(i,h),d--)}if(!c)for(;d--;d)i.unshift("..");!c||""===i[0]||i[0]&&r(i[0])||i.unshift("");var f=i.join("/");return n&&"/"!==f.substr(-1)&&(f+="/"),f};function a(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}const l=function e(t,n){if(t===n)return!0;if(null==t||null==n)return!1;if(Array.isArray(t))return Array.isArray(n)&&t.length===n.length&&t.every((function(t,o){return e(t,n[o])}));if("object"==typeof t||"object"==typeof n){var o=a(t),r=a(n);return o!==t||r!==n?e(o,r):Object.keys(Object.assign({},t,n)).every((function(o){return e(t[o],n[o])}))}return!1};var c=n(49481);function u(e){return"/"===e.charAt(0)?e:"/"+e}function d(e){return"/"===e.charAt(0)?e.substr(1):e}function h(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function p(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function f(e){var t=e||"/",n="",o="",r=t.indexOf("#");-1!==r&&(o=t.substr(r),t=t.substr(0,r));var s=t.indexOf("?");return-1!==s&&(n=t.substr(s),t=t.substr(0,s)),{pathname:t,search:"?"===n?"":n,hash:"#"===o?"":o}}function g(e){var t=e.pathname,n=e.search,o=e.hash,r=t||"/";return n&&"?"!==n&&(r+="?"===n.charAt(0)?n:"?"+n),o&&"#"!==o&&(r+="#"===o.charAt(0)?o:"#"+o),r}function m(e,t,n,r){var s;"string"==typeof e?(s=f(e)).state=t:(void 0===(s=(0,o.A)({},e)).pathname&&(s.pathname=""),s.search?"?"!==s.search.charAt(0)&&(s.search="?"+s.search):s.search="",s.hash?"#"!==s.hash.charAt(0)&&(s.hash="#"+s.hash):s.hash="",void 0!==t&&void 0===s.state&&(s.state=t));try{s.pathname=decodeURI(s.pathname)}catch(e){throw e instanceof URIError?new URIError('Pathname "'+s.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):e}return n&&(s.key=n),r?s.pathname?"/"!==s.pathname.charAt(0)&&(s.pathname=i(s.pathname,r.pathname)):s.pathname=r.pathname:s.pathname||(s.pathname="/"),s}function y(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&l(e.state,t.state)}function v(){var e=null,t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,o,r){if(null!=e){var s="function"==typeof e?e(t,n):e;"string"==typeof s?"function"==typeof o?o(s,r):r(!0):r(!1!==s)}else r(!0)},appendListener:function(e){var n=!0;function o(){n&&e.apply(void 0,arguments)}return t.push(o),function(){n=!1,t=t.filter((function(e){return e!==o}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];t.forEach((function(e){return e.apply(void 0,n)}))}}}var b=!("undefined"==typeof window||!window.document||!window.document.createElement);function S(e,t){t(window.confirm(e))}var w="popstate",T="hashchange";function _(){try{return window.history.state||{}}catch(e){return{}}}function C(e){void 0===e&&(e={}),b||(0,c.A)(!1);var t,n=window.history,r=(-1===(t=window.navigator.userAgent).indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history,s=!(-1===window.navigator.userAgent.indexOf("Trident")),i=e,a=i.forceRefresh,l=void 0!==a&&a,d=i.getUserConfirmation,f=void 0===d?S:d,y=i.keyLength,C=void 0===y?6:y,k=e.basename?p(u(e.basename)):"";function E(e){var t=e||{},n=t.key,o=t.state,r=window.location,s=r.pathname+r.search+r.hash;return k&&(s=h(s,k)),m(s,o,n)}function A(){return Math.random().toString(36).substr(2,C)}var I=v();function P(e){(0,o.A)(G,e),G.length=n.length,I.notifyListeners(G.location,G.action)}function M(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||D(E(e.state))}function x(){D(E(_()))}var R=!1;function D(e){R?(R=!1,P()):I.confirmTransitionTo(e,"POP",f,(function(t){t?P({action:"POP",location:e}):function(e){var t=G.location,n=N.indexOf(t.key);-1===n&&(n=0);var o=N.indexOf(e.key);-1===o&&(o=0);var r=n-o;r&&(R=!0,F(r))}(e)}))}var O=E(_()),N=[O.key];function L(e){return k+g(e)}function F(e){n.go(e)}var B=0;function W(e){1===(B+=e)&&1===e?(window.addEventListener(w,M),s&&window.addEventListener(T,x)):0===B&&(window.removeEventListener(w,M),s&&window.removeEventListener(T,x))}var U=!1,G={length:n.length,action:"POP",location:O,createHref:L,push:function(e,t){var o="PUSH",s=m(e,t,A(),G.location);I.confirmTransitionTo(s,o,f,(function(e){if(e){var t=L(s),i=s.key,a=s.state;if(r)if(n.pushState({key:i,state:a},null,t),l)window.location.href=t;else{var c=N.indexOf(G.location.key),u=N.slice(0,c+1);u.push(s.key),N=u,P({action:o,location:s})}else window.location.href=t}}))},replace:function(e,t){var o="REPLACE",s=m(e,t,A(),G.location);I.confirmTransitionTo(s,o,f,(function(e){if(e){var t=L(s),i=s.key,a=s.state;if(r)if(n.replaceState({key:i,state:a},null,t),l)window.location.replace(t);else{var c=N.indexOf(G.location.key);-1!==c&&(N[c]=s.key),P({action:o,location:s})}else window.location.replace(t)}}))},go:F,goBack:function(){F(-1)},goForward:function(){F(1)},block:function(e){void 0===e&&(e=!1);var t=I.setPrompt(e);return U||(W(1),U=!0),function(){return U&&(U=!1,W(-1)),t()}},listen:function(e){var t=I.appendListener(e);return W(1),function(){W(-1),t()}}};return G}var k="hashchange",E={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+d(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:d,decodePath:u},slash:{encodePath:u,decodePath:u}};function A(e){var t=e.indexOf("#");return-1===t?e:e.slice(0,t)}function I(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function P(e){window.location.replace(A(window.location.href)+"#"+e)}function M(e){void 0===e&&(e={}),b||(0,c.A)(!1);var t=window.history,n=(window.navigator.userAgent.indexOf("Firefox"),e),r=n.getUserConfirmation,s=void 0===r?S:r,i=n.hashType,a=void 0===i?"slash":i,l=e.basename?p(u(e.basename)):"",d=E[a],f=d.encodePath,y=d.decodePath;function w(){var e=y(I());return l&&(e=h(e,l)),m(e)}var T=v();function _(e){(0,o.A)(U,e),U.length=t.length,T.notifyListeners(U.location,U.action)}var C=!1,M=null;function x(){var e,t,n=I(),o=f(n);if(n!==o)P(o);else{var r=w(),i=U.location;if(!C&&(t=r,(e=i).pathname===t.pathname&&e.search===t.search&&e.hash===t.hash))return;if(M===g(r))return;M=null,function(e){if(C)C=!1,_();else{T.confirmTransitionTo(e,"POP",s,(function(t){t?_({action:"POP",location:e}):function(e){var t=U.location,n=N.lastIndexOf(g(t));-1===n&&(n=0);var o=N.lastIndexOf(g(e));-1===o&&(o=0);var r=n-o;r&&(C=!0,L(r))}(e)}))}}(r)}}var R=I(),D=f(R);R!==D&&P(D);var O=w(),N=[g(O)];function L(e){t.go(e)}var F=0;function B(e){1===(F+=e)&&1===e?window.addEventListener(k,x):0===F&&window.removeEventListener(k,x)}var W=!1,U={length:t.length,action:"POP",location:O,createHref:function(e){var t=document.querySelector("base"),n="";return t&&t.getAttribute("href")&&(n=A(window.location.href)),n+"#"+f(l+g(e))},push:function(e,t){var n="PUSH",o=m(e,void 0,void 0,U.location);T.confirmTransitionTo(o,n,s,(function(e){if(e){var t=g(o),r=f(l+t);if(I()!==r){M=t,function(e){window.location.hash=e}(r);var s=N.lastIndexOf(g(U.location)),i=N.slice(0,s+1);i.push(t),N=i,_({action:n,location:o})}else _()}}))},replace:function(e,t){var n="REPLACE",o=m(e,void 0,void 0,U.location);T.confirmTransitionTo(o,n,s,(function(e){if(e){var t=g(o),r=f(l+t);I()!==r&&(M=t,P(r));var s=N.indexOf(g(U.location));-1!==s&&(N[s]=t),_({action:n,location:o})}}))},go:L,goBack:function(){L(-1)},goForward:function(){L(1)},block:function(e){void 0===e&&(e=!1);var t=T.setPrompt(e);return W||(B(1),W=!0),function(){return W&&(W=!1,B(-1)),t()}},listen:function(e){var t=T.appendListener(e);return B(1),function(){B(-1),t()}}};return U}function x(e,t,n){return Math.min(Math.max(e,t),n)}function R(e){void 0===e&&(e={});var t=e,n=t.getUserConfirmation,r=t.initialEntries,s=void 0===r?["/"]:r,i=t.initialIndex,a=void 0===i?0:i,l=t.keyLength,c=void 0===l?6:l,u=v();function d(e){(0,o.A)(S,e),S.length=S.entries.length,u.notifyListeners(S.location,S.action)}function h(){return Math.random().toString(36).substr(2,c)}var p=x(a,0,s.length-1),f=s.map((function(e){return m(e,void 0,"string"==typeof e?h():e.key||h())})),y=g;function b(e){var t=x(S.index+e,0,S.entries.length-1),o=S.entries[t];u.confirmTransitionTo(o,"POP",n,(function(e){e?d({action:"POP",location:o,index:t}):d()}))}var S={length:f.length,action:"POP",location:f[p],index:p,entries:f,createHref:y,push:function(e,t){var o="PUSH",r=m(e,t,h(),S.location);u.confirmTransitionTo(r,o,n,(function(e){if(e){var t=S.index+1,n=S.entries.slice(0);n.length>t?n.splice(t,n.length-t,r):n.push(r),d({action:o,location:r,index:t,entries:n})}}))},replace:function(e,t){var o="REPLACE",r=m(e,t,h(),S.location);u.confirmTransitionTo(r,o,n,(function(e){e&&(S.entries[S.index]=r,d({action:o,location:r}))}))},go:b,goBack:function(){b(-1)},goForward:function(){b(1)},canGo:function(e){var t=S.index+e;return t>=0&&t<S.entries.length},block:function(e){return void 0===e&&(e=!1),u.setPrompt(e)},listen:function(e){return u.appendListener(e)}};return S}},78535:(e,t,n)=>{"use strict";var o=n(91272),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},s={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},i={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function l(e){return o.isMemo(e)?i:a[e.$$typeof]||r}a[o.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[o.Memo]=i;var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,o){if("string"!=typeof n){if(f){var r=p(n);r&&r!==f&&e(t,r,o)}var i=u(n);d&&(i=i.concat(d(n)));for(var a=l(t),g=l(n),m=0;m<i.length;++m){var y=i[m];if(!(s[y]||o&&o[y]||g&&g[y]||a&&a[y])){var v=h(n,y);try{c(t,y,v)}catch(e){}}}}return t}},76482:e=>{e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},80665:(e,t,n)=>{n(76442),e.exports=self.fetch.bind(self)},85085:(e,t,n)=>{var o=n(76482);e.exports=function e(t,n,r){return o(n)||(r=n||r,n=[]),r=r||{},t instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var o=0;o<n.length;o++)t.push({name:o,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return d(e,t)}(t,n):o(t)?function(t,n,o){for(var r=[],s=0;s<t.length;s++)r.push(e(t[s],n,o).source);return d(new RegExp("(?:"+r.join("|")+")",h(o)),n)}(t,n,r):function(e,t,n){return p(s(e,n),t,n)}(t,n,r)},e.exports.parse=s,e.exports.compile=function(e,t){return l(s(e,t),t)},e.exports.tokensToFunction=l,e.exports.tokensToRegExp=p;var r=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function s(e,t){for(var n,o=[],s=0,a=0,l="",c=t&&t.delimiter||"/";null!=(n=r.exec(e));){var d=n[0],h=n[1],p=n.index;if(l+=e.slice(a,p),a=p+d.length,h)l+=h[1];else{var f=e[a],g=n[2],m=n[3],y=n[4],v=n[5],b=n[6],S=n[7];l&&(o.push(l),l="");var w=null!=g&&null!=f&&f!==g,T="+"===b||"*"===b,_="?"===b||"*"===b,C=g||c,k=y||v,E=g||("string"==typeof o[o.length-1]?o[o.length-1]:"");o.push({name:m||s++,prefix:g||"",delimiter:C,optional:_,repeat:T,partial:w,asterisk:!!S,pattern:k?u(k):S?".*":i(C,E)})}}return a<e.length&&(l+=e.substr(a)),l&&o.push(l),o}function i(e,t){return!t||t.indexOf(e)>-1?"[^"+c(e)+"]+?":c(t)+"|(?:(?!"+c(t)+")[^"+c(e)+"])+?"}function a(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function l(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++)"object"==typeof e[r]&&(n[r]=new RegExp("^(?:"+e[r].pattern+")$",h(t)));return function(t,r){for(var s="",i=t||{},l=(r||{}).pretty?a:encodeURIComponent,c=0;c<e.length;c++){var u=e[c];if("string"!=typeof u){var d,h=i[u.name];if(null==h){if(u.optional){u.partial&&(s+=u.prefix);continue}throw new TypeError('Expected "'+u.name+'" to be defined')}if(o(h)){if(!u.repeat)throw new TypeError('Expected "'+u.name+'" to not repeat, but received `'+JSON.stringify(h)+"`");if(0===h.length){if(u.optional)continue;throw new TypeError('Expected "'+u.name+'" to not be empty')}for(var p=0;p<h.length;p++){if(d=l(h[p]),!n[c].test(d))throw new TypeError('Expected all "'+u.name+'" to match "'+u.pattern+'", but received `'+JSON.stringify(d)+"`");s+=(0===p?u.prefix:u.delimiter)+d}}else{if(d=u.asterisk?encodeURI(h).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):l(h),!n[c].test(d))throw new TypeError('Expected "'+u.name+'" to match "'+u.pattern+'", but received "'+d+'"');s+=u.prefix+d}}else s+=u}return s}}function c(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function u(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function d(e,t){return e.keys=t,e}function h(e){return e&&e.sensitive?"":"i"}function p(e,t,n){o(t)||(n=t||n,t=[]);for(var r=(n=n||{}).strict,s=!1!==n.end,i="",a=0;a<e.length;a++){var l=e[a];if("string"==typeof l)i+=c(l);else{var u=c(l.prefix),p="(?:"+l.pattern+")";t.push(l),l.repeat&&(p+="(?:"+u+p+")*"),i+=p=l.optional?l.partial?u+"("+p+")?":"(?:"+u+"("+p+"))?":u+"("+p+")"}}var f=c(n.delimiter||"/"),g=i.slice(-f.length)===f;return r||(i=(g?i.slice(0,-f.length):i)+"(?:"+f+"(?=$))?"),i+=s?"$":r&&g?"":"(?="+f+"|$)",d(new RegExp("^"+i,h(n)),t)}},97550:(e,t,n)=>{"use strict";var o=n(51605);function r(){}function s(){}s.resetWarningCache=r,e.exports=function(){function e(e,t,n,r,s,i){if(i!==o){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:s,resetWarningCache:r};return n.PropTypes=n,n}},87468:(e,t,n)=>{e.exports=n(97550)()},51605:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},76277:(e,t,n)=>{"use strict";var o=n(26166),r=n(82300);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)i.add(t[e])}var u=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},f={};function g(e,t,n,o,r,s,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=o,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,o){var r=m.hasOwnProperty(t)?m[t]:null;(null!==r?0!==r.type:o||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,o){if(null==t||function(e,t,n,o){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!o&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,o))return!0;if(o)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,r,o)&&(n=null),o||null===r?function(e){return!!d.call(f,e)||!d.call(p,e)&&(h.test(e)?f[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):r.mustUseProperty?e[r.propertyName]=null===n?3!==r.type&&"":n:(t=r.attributeName,o=r.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,o?e.setAttributeNS(o,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var S=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),T=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),A=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function N(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=O&&e[O]||e["@@iterator"])?e:null}var L,F=Object.assign;function B(e){if(void 0===L)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var W=!1;function U(e,t){if(!e||W)return"";W=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var o=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){o=e}e.call(t.prototype)}else{try{throw Error()}catch(e){o=e}e()}}catch(t){if(t&&o&&"string"==typeof t.stack){for(var r=t.stack.split("\n"),s=o.stack.split("\n"),i=r.length-1,a=s.length-1;1<=i&&0<=a&&r[i]!==s[a];)a--;for(;1<=i&&0<=a;i--,a--)if(r[i]!==s[a]){if(1!==i||1!==a)do{if(i--,0>--a||r[i]!==s[a]){var l="\n"+r[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=a);break}}}finally{W=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function G(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return U(e.type,!1);case 11:return U(e.type.render,!1);case 1:return U(e.type,!0);default:return""}}function H(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case _:return"Fragment";case T:return"Portal";case k:return"Profiler";case C:return"StrictMode";case P:return"Suspense";case M:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case x:return null!==(t=e.displayName||null)?t:H(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return H(e(t))}catch(e){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return H(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function $(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function j(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){o=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return o},setValue:function(e){o=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function z(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),o="";return e&&(o=V(e)?e.checked?"true":"false":e.value),(e=o)!==n&&(t.setValue(e),!0)}function Q(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,o=null!=t.checked?t.checked:t.defaultChecked;n=$(null!=t.value?t.value:n),e._wrapperState={initialChecked:o,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=$(t.value),o=t.type;if(null!=n)"number"===o?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===o||"reset"===o)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,$(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!("submit"!==o&&"reset"!==o||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,o){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&o&&(e[n].defaultSelected=!0)}else{for(n=""+$(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(o&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function re(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:$(n)}}function se(e,t){var n=$(t.value),o=$(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=o&&(e.defaultValue=""+o)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,o){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var o=0===n.indexOf("--"),r=ge(n,t[n],o);"float"===n&&(n="cssFloat"),o?e.setProperty(n,r):e[n]=r}}Object.keys(pe).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Se=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,_e=null,Ce=null;function ke(e){if(e=Sr(e)){if("function"!=typeof Te)throw Error(s(280));var t=e.stateNode;t&&(t=Tr(t),Te(e.stateNode,e.type,t))}}function Ee(e){_e?Ce?Ce.push(e):Ce=[e]:_e=e}function Ae(){if(_e){var e=_e,t=Ce;if(Ce=_e=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ie(e,t){return e(t)}function Pe(){}var Me=!1;function xe(e,t,n){if(Me)return e(t,n);Me=!0;try{return Ie(e,t,n)}finally{Me=!1,(null!==_e||null!==Ce)&&(Pe(),Ae())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var o=Tr(n);if(null===o)return null;n=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(o=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!o;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){De=!1}function Ne(e,t,n,o,r,s,i,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var Le=!1,Fe=null,Be=!1,We=null,Ue={onError:function(e){Le=!0,Fe=e}};function Ge(e,t,n,o,r,s,i,a,l){Le=!1,Fe=null,Ne.apply(Ue,arguments)}function He(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function $e(e){if(He(e)!==e)throw Error(s(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=He(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,o=t;;){var r=n.return;if(null===r)break;var i=r.alternate;if(null===i){if(null!==(o=r.return)){n=o;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return $e(r),e;if(i===o)return $e(r),t;i=i.sibling}throw Error(s(188))}if(n.return!==o.return)n=r,o=i;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,o=i;break}if(l===o){a=!0,o=r,n=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===n){a=!0,n=i,o=r;break}if(l===o){a=!0,o=i,n=r;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==o)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?je(e):null}function je(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=je(e);if(null!==t)return t;e=e.sibling}return null}var ze=r.unstable_scheduleCallback,Qe=r.unstable_cancelCallback,Je=r.unstable_shouldYield,Ke=r.unstable_requestPaint,Ye=r.unstable_now,Xe=r.unstable_getCurrentPriorityLevel,Ze=r.unstable_ImmediatePriority,et=r.unstable_UserBlockingPriority,tt=r.unstable_NormalPriority,nt=r.unstable_LowPriority,ot=r.unstable_IdlePriority,rt=null,st=null,it=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2,ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var o=0,r=e.suspendedLanes,s=e.pingedLanes,i=268435455&n;if(0!==i){var a=i&~r;0!==a?o=dt(a):0!=(s&=i)&&(o=dt(s))}else 0!=(i=n&~r)?o=dt(i):0!==s&&(o=dt(s));if(0===o)return 0;if(0!==t&&t!==o&&!(t&r)&&((r=o&-o)>=(s=t&-t)||16===r&&4194240&s))return t;if(4&o&&(o|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=o;0<t;)r=1<<(n=31-it(t)),o|=e[n],t&=~r;return o}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return!(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var o=31-it(n),r=1<<o;r&t|e[o]&t&&(e[o]|=t),n&=~r}}var bt=0;function St(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var wt,Tt,_t,Ct,kt,Et=!1,At=[],It=null,Pt=null,Mt=null,xt=new Map,Rt=new Map,Dt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Mt=null;break;case"pointerover":case"pointerout":xt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Lt(e,t,n,o,r,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:o,nativeEvent:s,targetContainers:[r]},null!==t&&null!==(t=Sr(t))&&Tt(t),e):(e.eventSystemFlags|=o,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Ft(e){var t=br(e.target);if(null!==t){var n=He(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void kt(e.priority,(function(){_t(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Sr(n))&&Tt(t),e.blockedOn=n,!1;var o=new(n=e.nativeEvent).constructor(n.type,n);Se=o,n.target.dispatchEvent(o),Se=null,t.shift()}return!0}function Wt(e,t,n){Bt(e)&&n.delete(t)}function Ut(){Et=!1,null!==It&&Bt(It)&&(It=null),null!==Pt&&Bt(Pt)&&(Pt=null),null!==Mt&&Bt(Mt)&&(Mt=null),xt.forEach(Wt),Rt.forEach(Wt)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ut)))}function Ht(e){function t(t){return Gt(t,e)}if(0<At.length){Gt(At[0],e);for(var n=1;n<At.length;n++){var o=At[n];o.blockedOn===e&&(o.blockedOn=null)}}for(null!==It&&Gt(It,e),null!==Pt&&Gt(Pt,e),null!==Mt&&Gt(Mt,e),xt.forEach(t),Rt.forEach(t),n=0;n<Dt.length;n++)(o=Dt[n]).blockedOn===e&&(o.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var qt=S.ReactCurrentBatchConfig,$t=!0;function Vt(e,t,n,o){var r=bt,s=qt.transition;qt.transition=null;try{bt=1,zt(e,t,n,o)}finally{bt=r,qt.transition=s}}function jt(e,t,n,o){var r=bt,s=qt.transition;qt.transition=null;try{bt=4,zt(e,t,n,o)}finally{bt=r,qt.transition=s}}function zt(e,t,n,o){if($t){var r=Jt(e,t,n,o);if(null===r)Vo(e,t,o,Qt,n),Nt(e,o);else if(function(e,t,n,o,r){switch(t){case"focusin":return It=Lt(It,e,t,n,o,r),!0;case"dragenter":return Pt=Lt(Pt,e,t,n,o,r),!0;case"mouseover":return Mt=Lt(Mt,e,t,n,o,r),!0;case"pointerover":var s=r.pointerId;return xt.set(s,Lt(xt.get(s)||null,e,t,n,o,r)),!0;case"gotpointercapture":return s=r.pointerId,Rt.set(s,Lt(Rt.get(s)||null,e,t,n,o,r)),!0}return!1}(r,e,t,n,o))o.stopPropagation();else if(Nt(e,o),4&t&&-1<Ot.indexOf(e)){for(;null!==r;){var s=Sr(r);if(null!==s&&wt(s),null===(s=Jt(e,t,n,o))&&Vo(e,t,o,Qt,n),s===r)break;r=s}null!==r&&o.stopPropagation()}else Vo(e,t,o,null,n)}}var Qt=null;function Jt(e,t,n,o){if(Qt=null,null!==(e=br(e=we(o))))if(null===(t=He(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case ot:return 536870912;default:return 16}default:return 16}}var Yt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,o=n.length,r="value"in Yt?Yt.value:Yt.textContent,s=r.length;for(e=0;e<o&&n[e]===r[e];e++);var i=o-e;for(t=1;t<=i&&n[o-t]===r[s-t];t++);return Zt=r.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function on(){return!1}function rn(e){function t(t,n,o,r,s){for(var i in this._reactName=t,this._targetInst=o,this.type=n,this.nativeEvent=r,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(r):r[i]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:on,this.isPropagationStopped=on,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=rn(cn),dn=F({},cn,{view:0,detail:0}),hn=rn(dn),pn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),fn=rn(pn),gn=rn(F({},pn,{dataTransfer:0})),mn=rn(F({},dn,{relatedTarget:0})),yn=rn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=rn(vn),Sn=rn(F({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function kn(){return Cn}var En=F({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Tn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=rn(En),In=rn(F({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=rn(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Mn=rn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),xn=F({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rn=rn(xn),Dn=[9,13,27,32],On=u&&"CompositionEvent"in window,Nn=null;u&&"documentMode"in document&&(Nn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Nn,Fn=u&&(!On||Nn&&8<Nn&&11>=Nn),Bn=String.fromCharCode(32),Wn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1,qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $n(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Vn(e,t,n,o){Ee(o),0<(t=zo(t,"onChange")).length&&(n=new un("onChange","change",null,n,o),e.push({event:n,listeners:t}))}var jn=null,zn=null;function Qn(e){Wo(e,0)}function Jn(e){if(z(wr(e)))return e}function Kn(e,t){if("change"===e)return t}var Yn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var eo=document.createElement("div");eo.setAttribute("oninput","return;"),Zn="function"==typeof eo.oninput}Xn=Zn}else Xn=!1;Yn=Xn&&(!document.documentMode||9<document.documentMode)}function to(){jn&&(jn.detachEvent("onpropertychange",no),zn=jn=null)}function no(e){if("value"===e.propertyName&&Jn(zn)){var t=[];Vn(t,zn,e,we(e)),xe(Qn,t)}}function oo(e,t,n){"focusin"===e?(to(),zn=n,(jn=t).attachEvent("onpropertychange",no)):"focusout"===e&&to()}function ro(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(zn)}function so(e,t){if("click"===e)return Jn(t)}function io(e,t){if("input"===e||"change"===e)return Jn(t)}var ao="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function lo(e,t){if(ao(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(o=0;o<n.length;o++){var r=n[o];if(!d.call(t,r)||!ao(e[r],t[r]))return!1}return!0}function co(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function uo(e,t){var n,o=co(e);for(e=0;o;){if(3===o.nodeType){if(n=e+o.textContent.length,e<=t&&n>=t)return{node:o,offset:t-e};e=n}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=co(o)}}function ho(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ho(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function po(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function go(e){var t=po(),n=e.focusedElem,o=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ho(n.ownerDocument.documentElement,n)){if(null!==o&&fo(n))if(t=o.start,void 0===(e=o.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var r=n.textContent.length,s=Math.min(o.start,r);o=void 0===o.end?s:Math.min(o.end,r),!e.extend&&s>o&&(r=o,o=s,s=r),r=uo(n,s);var i=uo(n,o);r&&i&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(r.node,r.offset),e.removeAllRanges(),s>o?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mo=u&&"documentMode"in document&&11>=document.documentMode,yo=null,vo=null,bo=null,So=!1;function wo(e,t,n){var o=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;So||null==yo||yo!==Q(o)||(o="selectionStart"in(o=yo)&&fo(o)?{start:o.selectionStart,end:o.selectionEnd}:{anchorNode:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset},bo&&lo(bo,o)||(bo=o,0<(o=zo(vo,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:o}),t.target=yo)))}function To(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _o={animationend:To("Animation","AnimationEnd"),animationiteration:To("Animation","AnimationIteration"),animationstart:To("Animation","AnimationStart"),transitionend:To("Transition","TransitionEnd")},Co={},ko={};function Eo(e){if(Co[e])return Co[e];if(!_o[e])return e;var t,n=_o[e];for(t in n)if(n.hasOwnProperty(t)&&t in ko)return Co[e]=n[t];return e}u&&(ko=document.createElement("div").style,"AnimationEvent"in window||(delete _o.animationend.animation,delete _o.animationiteration.animation,delete _o.animationstart.animation),"TransitionEvent"in window||delete _o.transitionend.transition);var Ao=Eo("animationend"),Io=Eo("animationiteration"),Po=Eo("animationstart"),Mo=Eo("transitionend"),xo=new Map,Ro="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Do(e,t){xo.set(e,t),l(t,[e])}for(var Oo=0;Oo<Ro.length;Oo++){var No=Ro[Oo];Do(No.toLowerCase(),"on"+(No[0].toUpperCase()+No.slice(1)))}Do(Ao,"onAnimationEnd"),Do(Io,"onAnimationIteration"),Do(Po,"onAnimationStart"),Do("dblclick","onDoubleClick"),Do("focusin","onFocus"),Do("focusout","onBlur"),Do(Mo,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fo=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lo));function Bo(e,t,n){var o=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,o,r,i,a,l,c){if(Ge.apply(this,arguments),Le){if(!Le)throw Error(s(198));var u=Fe;Le=!1,Fe=null,Be||(Be=!0,We=u)}}(o,t,void 0,e),e.currentTarget=null}function Wo(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var o=e[n],r=o.event;o=o.listeners;e:{var s=void 0;if(t)for(var i=o.length-1;0<=i;i--){var a=o[i],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Bo(r,a,c),s=l}else for(i=0;i<o.length;i++){if(l=(a=o[i]).instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Bo(r,a,c),s=l}}}if(Be)throw e=We,Be=!1,We=null,e}function Uo(e,t){var n=t[mr];void 0===n&&(n=t[mr]=new Set);var o=e+"__bubble";n.has(o)||($o(t,e,2,!1),n.add(o))}function Go(e,t,n){var o=0;t&&(o|=4),$o(n,e,o,t)}var Ho="_reactListening"+Math.random().toString(36).slice(2);function qo(e){if(!e[Ho]){e[Ho]=!0,i.forEach((function(t){"selectionchange"!==t&&(Fo.has(t)||Go(t,!1,e),Go(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ho]||(t[Ho]=!0,Go("selectionchange",!1,t))}}function $o(e,t,n,o){switch(Kt(t)){case 1:var r=Vt;break;case 4:r=jt;break;default:r=zt}n=r.bind(null,t,n,e),r=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),o?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Vo(e,t,n,o,r){var s=o;if(!(1&t||2&t||null===o))e:for(;;){if(null===o)return;var i=o.tag;if(3===i||4===i){var a=o.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===i)for(i=o.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;i=i.return}for(;null!==a;){if(null===(i=br(a)))return;if(5===(l=i.tag)||6===l){o=s=i;continue e}a=a.parentNode}}o=o.return}xe((function(){var o=s,r=we(n),i=[];e:{var a=xo.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=An;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Ao:case Io:case Po:l=yn;break;case Mo:l=Mn;break;case"scroll":l=hn;break;case"wheel":l=Rn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=In}var u=!!(4&t),d=!u&&"scroll"===e,h=u?null!==a?a+"Capture":null:a;u=[];for(var p,f=o;null!==f;){var g=(p=f).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==h&&null!=(g=Re(f,h))&&u.push(jo(f,g,p))),d)break;f=f.return}0<u.length&&(a=new l(a,c,null,n,r),i.push({event:a,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===Se||!(c=n.relatedTarget||n.fromElement)||!br(c)&&!c[gr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=o,null!==(c=(c=n.relatedTarget||n.toElement)?br(c):null)&&(c!==(d=He(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=o),l!==c)){if(u=fn,g="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=In,g="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?a:wr(l),p=null==c?a:wr(c),(a=new u(g,f+"leave",l,n,r)).target=d,a.relatedTarget=p,g=null,br(r)===o&&((u=new u(h,f+"enter",c,n,r)).target=p,u.relatedTarget=d,g=u),d=g,l&&c)e:{for(h=c,f=0,p=u=l;p;p=Qo(p))f++;for(p=0,g=h;g;g=Qo(g))p++;for(;0<f-p;)u=Qo(u),f--;for(;0<p-f;)h=Qo(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Qo(u),h=Qo(h)}u=null}else u=null;null!==l&&Jo(i,a,l,u,!1),null!==c&&null!==d&&Jo(i,d,c,u,!0)}if("select"===(l=(a=o?wr(o):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Kn;else if($n(a))if(Yn)m=io;else{m=ro;var y=oo}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=so);switch(m&&(m=m(e,o))?Vn(i,m,n,r):(y&&y(e,a,o),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=o?wr(o):window,e){case"focusin":($n(y)||"true"===y.contentEditable)&&(yo=y,vo=o,bo=null);break;case"focusout":bo=vo=yo=null;break;case"mousedown":So=!0;break;case"contextmenu":case"mouseup":case"dragend":So=!1,wo(i,n,r);break;case"selectionchange":if(mo)break;case"keydown":case"keyup":wo(i,n,r)}var v;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Hn?Un(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Fn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Hn&&(v=en()):(Xt="value"in(Yt=r)?Yt.value:Yt.textContent,Hn=!0)),0<(y=zo(o,b)).length&&(b=new Sn(b,e,null,n,r),i.push({event:b,listeners:y}),(v||null!==(v=Gn(n)))&&(b.data=v))),(v=Ln?function(e,t){switch(e){case"compositionend":return Gn(t);case"keypress":return 32!==t.which?null:(Wn=!0,Bn);case"textInput":return(e=t.data)===Bn&&Wn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!On&&Un(e,t)?(e=en(),Zt=Xt=Yt=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(o=zo(o,"onBeforeInput")).length&&(r=new Sn("onBeforeInput","beforeinput",null,n,r),i.push({event:r,listeners:o}),r.data=v)}Wo(i,t)}))}function jo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function zo(e,t){for(var n=t+"Capture",o=[];null!==e;){var r=e,s=r.stateNode;5===r.tag&&null!==s&&(r=s,null!=(s=Re(e,n))&&o.unshift(jo(e,s,r)),null!=(s=Re(e,t))&&o.push(jo(e,s,r))),e=e.return}return o}function Qo(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Jo(e,t,n,o,r){for(var s=t._reactName,i=[];null!==n&&n!==o;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===o)break;5===a.tag&&null!==c&&(a=c,r?null!=(l=Re(n,s))&&i.unshift(jo(n,l,a)):r||null!=(l=Re(n,s))&&i.push(jo(n,l,a))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Ko=/\r\n?/g,Yo=/\u0000|\uFFFD/g;function Xo(e){return("string"==typeof e?e:""+e).replace(Ko,"\n").replace(Yo,"")}function Zo(e,t,n){if(t=Xo(t),Xo(e)!==t&&n)throw Error(s(425))}function er(){}var tr=null,nr=null;function or(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rr="function"==typeof setTimeout?setTimeout:void 0,sr="function"==typeof clearTimeout?clearTimeout:void 0,ir="function"==typeof Promise?Promise:void 0,ar="function"==typeof queueMicrotask?queueMicrotask:void 0!==ir?function(e){return ir.resolve(null).then(e).catch(lr)}:rr;function lr(e){setTimeout((function(){throw e}))}function cr(e,t){var n=t,o=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===o)return e.removeChild(r),void Ht(t);o--}else"$"!==n&&"$?"!==n&&"$!"!==n||o++;n=r}while(n);Ht(t)}function ur(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hr=Math.random().toString(36).slice(2),pr="__reactFiber$"+hr,fr="__reactProps$"+hr,gr="__reactContainer$"+hr,mr="__reactEvents$"+hr,yr="__reactListeners$"+hr,vr="__reactHandles$"+hr;function br(e){var t=e[pr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gr]||n[pr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=dr(e);null!==e;){if(n=e[pr])return n;e=dr(e)}return t}n=(e=n).parentNode}return null}function Sr(e){return!(e=e[pr]||e[gr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Tr(e){return e[fr]||null}var _r=[],Cr=-1;function kr(e){return{current:e}}function Er(e){0>Cr||(e.current=_r[Cr],_r[Cr]=null,Cr--)}function Ar(e,t){Cr++,_r[Cr]=e.current,e.current=t}var Ir={},Pr=kr(Ir),Mr=kr(!1),xr=Ir;function Rr(e,t){var n=e.type.contextTypes;if(!n)return Ir;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Dr(e){return null!=e.childContextTypes}function Or(){Er(Mr),Er(Pr)}function Nr(e,t,n){if(Pr.current!==Ir)throw Error(s(168));Ar(Pr,t),Ar(Mr,n)}function Lr(e,t,n){var o=e.stateNode;if(t=t.childContextTypes,"function"!=typeof o.getChildContext)return n;for(var r in o=o.getChildContext())if(!(r in t))throw Error(s(108,q(e)||"Unknown",r));return F({},n,o)}function Fr(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ir,xr=Pr.current,Ar(Pr,e),Ar(Mr,Mr.current),!0}function Br(e,t,n){var o=e.stateNode;if(!o)throw Error(s(169));n?(e=Lr(e,t,xr),o.__reactInternalMemoizedMergedChildContext=e,Er(Mr),Er(Pr),Ar(Pr,e)):Er(Mr),Ar(Mr,n)}var Wr=null,Ur=!1,Gr=!1;function Hr(e){null===Wr?Wr=[e]:Wr.push(e)}function qr(){if(!Gr&&null!==Wr){Gr=!0;var e=0,t=bt;try{var n=Wr;for(bt=1;e<n.length;e++){var o=n[e];do{o=o(!0)}while(null!==o)}Wr=null,Ur=!1}catch(t){throw null!==Wr&&(Wr=Wr.slice(e+1)),ze(Ze,qr),t}finally{bt=t,Gr=!1}}return null}var $r=[],Vr=0,jr=null,zr=0,Qr=[],Jr=0,Kr=null,Yr=1,Xr="";function Zr(e,t){$r[Vr++]=zr,$r[Vr++]=jr,jr=e,zr=t}function es(e,t,n){Qr[Jr++]=Yr,Qr[Jr++]=Xr,Qr[Jr++]=Kr,Kr=e;var o=Yr;e=Xr;var r=32-it(o)-1;o&=~(1<<r),n+=1;var s=32-it(t)+r;if(30<s){var i=r-r%5;s=(o&(1<<i)-1).toString(32),o>>=i,r-=i,Yr=1<<32-it(t)+r|n<<r|o,Xr=s+e}else Yr=1<<s|n<<r|o,Xr=e}function ts(e){null!==e.return&&(Zr(e,1),es(e,1,0))}function ns(e){for(;e===jr;)jr=$r[--Vr],$r[Vr]=null,zr=$r[--Vr],$r[Vr]=null;for(;e===Kr;)Kr=Qr[--Jr],Qr[Jr]=null,Xr=Qr[--Jr],Qr[Jr]=null,Yr=Qr[--Jr],Qr[Jr]=null}var os=null,rs=null,ss=!1,is=null;function as(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ls(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,os=e,rs=ur(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,os=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Kr?{id:Yr,overflow:Xr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,os=e,rs=null,!0);default:return!1}}function cs(e){return!(!(1&e.mode)||128&e.flags)}function us(e){if(ss){var t=rs;if(t){var n=t;if(!ls(e,t)){if(cs(e))throw Error(s(418));t=ur(n.nextSibling);var o=os;t&&ls(e,t)?as(o,n):(e.flags=-4097&e.flags|2,ss=!1,os=e)}}else{if(cs(e))throw Error(s(418));e.flags=-4097&e.flags|2,ss=!1,os=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;os=e}function hs(e){if(e!==os)return!1;if(!ss)return ds(e),ss=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!or(e.type,e.memoizedProps)),t&&(t=rs)){if(cs(e))throw ps(),Error(s(418));for(;t;)as(e,t),t=ur(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ur(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=os?ur(e.stateNode.nextSibling):null;return!0}function ps(){for(var e=rs;e;)e=ur(e.nextSibling)}function fs(){rs=os=null,ss=!1}function gs(e){null===is?is=[e]:is.push(e)}var ms=S.ReactCurrentBatchConfig;function ys(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var vs=kr(null),bs=null,Ss=null,ws=null;function Ts(){ws=Ss=bs=null}function _s(e){var t=vs.current;Er(vs),e._currentValue=t}function Cs(e,t,n){for(;null!==e;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==o&&(o.childLanes|=t)):null!==o&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===n)break;e=e.return}}function ks(e,t){bs=e,ws=Ss=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(!!(e.lanes&t)&&(Sa=!0),e.firstContext=null)}function Es(e){var t=e._currentValue;if(ws!==e)if(e={context:e,memoizedValue:t,next:null},null===Ss){if(null===bs)throw Error(s(308));Ss=e,bs.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return t}var As=null;function Is(e){null===As?As=[e]:As.push(e)}function Ps(e,t,n,o){var r=t.interleaved;return null===r?(n.next=n,Is(t)):(n.next=r.next,r.next=n),t.interleaved=n,Ms(e,o)}function Ms(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var xs=!1;function Rs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ds(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Os(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ns(e,t,n){var o=e.updateQueue;if(null===o)return null;if(o=o.shared,2&Pl){var r=o.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),o.pending=t,Ms(e,n)}return null===(r=o.interleaved)?(t.next=t,Is(o)):(t.next=r.next,r.next=t),o.interleaved=t,Ms(e,n)}function Ls(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&n)){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Fs(e,t){var n=e.updateQueue,o=e.alternate;if(null!==o&&n===(o=o.updateQueue)){var r=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?r=s=i:s=s.next=i,n=n.next}while(null!==n);null===s?r=s=t:s=s.next=t}else r=s=t;return n={baseState:o.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:o.shared,effects:o.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bs(e,t,n,o){var r=e.updateQueue;xs=!1;var s=r.firstBaseUpdate,i=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var u=e.alternate;null!==u&&(a=(u=u.updateQueue).lastBaseUpdate)!==i&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l)}if(null!==s){var d=r.baseState;for(i=0,u=c=l=null,a=s;;){var h=a.lane,p=a.eventTime;if((o&h)===h){null!==u&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var f=e,g=a;switch(h=t,p=n,g.tag){case 1:if("function"==typeof(f=g.payload)){d=f.call(p,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(h="function"==typeof(f=g.payload)?f.call(p,d,h):f))break e;d=F({},d,h);break e;case 2:xs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(h=r.effects)?r.effects=[a]:h.push(a))}else p={eventTime:p,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=p,l=d):u=u.next=p,i|=h;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(h=a).next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}if(null===u&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,null!==(t=r.shared.interleaved)){r=t;do{i|=r.lane,r=r.next}while(r!==t)}else null===s&&(r.shared.lanes=0);Fl|=i,e.lanes=i,e.memoizedState=d}}function Ws(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var o=e[t],r=o.callback;if(null!==r){if(o.callback=null,o=n,"function"!=typeof r)throw Error(s(191,r));r.call(o)}}}var Us=(new o.Component).refs;function Gs(e,t,n,o){n=null==(n=n(o,t=e.memoizedState))?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Hs={isMounted:function(e){return!!(e=e._reactInternals)&&He(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var o=tc(),r=nc(e),s=Os(o,r);s.payload=t,null!=n&&(s.callback=n),null!==(t=Ns(e,s,r))&&(oc(t,e,r,o),Ls(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var o=tc(),r=nc(e),s=Os(o,r);s.tag=1,s.payload=t,null!=n&&(s.callback=n),null!==(t=Ns(e,s,r))&&(oc(t,e,r,o),Ls(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),o=nc(e),r=Os(n,o);r.tag=2,null!=t&&(r.callback=t),null!==(t=Ns(e,r,o))&&(oc(t,e,o,n),Ls(t,e,o))}};function qs(e,t,n,o,r,s,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(o,s,i):!(t.prototype&&t.prototype.isPureReactComponent&&lo(n,o)&&lo(r,s))}function $s(e,t,n){var o=!1,r=Ir,s=t.contextType;return"object"==typeof s&&null!==s?s=Es(s):(r=Dr(t)?xr:Pr.current,s=(o=null!=(o=t.contextTypes))?Rr(e,r):Ir),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Hs,e.stateNode=t,t._reactInternals=e,o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Vs(e,t,n,o){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,o),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,o),t.state!==e&&Hs.enqueueReplaceState(t,t.state,null)}function js(e,t,n,o){var r=e.stateNode;r.props=n,r.state=e.memoizedState,r.refs=Us,Rs(e);var s=t.contextType;"object"==typeof s&&null!==s?r.context=Es(s):(s=Dr(t)?xr:Pr.current,r.context=Rr(e,s)),r.state=e.memoizedState,"function"==typeof(s=t.getDerivedStateFromProps)&&(Gs(e,t,s,n),r.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(t=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&Hs.enqueueReplaceState(r,r.state,null),Bs(e,n,r,o),r.state=e.memoizedState),"function"==typeof r.componentDidMount&&(e.flags|=4194308)}function zs(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var o=n.stateNode}if(!o)throw Error(s(147,e));var r=o,i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===Us&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function Qs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Js(e){return(0,e._init)(e._payload)}function Ks(e){function t(t,n){if(e){var o=t.deletions;null===o?(t.deletions=[n],t.flags|=16):o.push(n)}}function n(n,o){if(!e)return null;for(;null!==o;)t(n,o),o=o.sibling;return null}function o(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function i(t,n,o){return t.index=o,e?null!==(o=t.alternate)?(o=o.index)<n?(t.flags|=2,n):o:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,o){return null===t||6!==t.tag?((t=Bc(n,e.mode,o)).return=e,t):((t=r(t,n)).return=e,t)}function c(e,t,n,o){var s=n.type;return s===_?d(e,t,n.props.children,o,n.key):null!==t&&(t.elementType===s||"object"==typeof s&&null!==s&&s.$$typeof===R&&Js(s)===t.type)?((o=r(t,n.props)).ref=zs(e,t,n),o.return=e,o):((o=Nc(n.type,n.key,n.props,null,e.mode,o)).ref=zs(e,t,n),o.return=e,o)}function u(e,t,n,o){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Wc(n,e.mode,o)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,o,s){return null===t||7!==t.tag?((t=Lc(n,e.mode,o,s)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Bc(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Nc(t.type,t.key,t.props,null,e.mode,n)).ref=zs(e,null,t),n.return=e,n;case T:return(t=Wc(t,e.mode,n)).return=e,t;case R:return h(e,(0,t._init)(t._payload),n)}if(te(t)||N(t))return(t=Lc(t,e.mode,n,null)).return=e,t;Qs(e,t)}return null}function p(e,t,n,o){var r=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==r?null:l(e,t,""+n,o);if("object"==typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===r?c(e,t,n,o):null;case T:return n.key===r?u(e,t,n,o):null;case R:return p(e,t,(r=n._init)(n._payload),o)}if(te(n)||N(n))return null!==r?null:d(e,t,n,o,null);Qs(e,n)}return null}function f(e,t,n,o,r){if("string"==typeof o&&""!==o||"number"==typeof o)return l(t,e=e.get(n)||null,""+o,r);if("object"==typeof o&&null!==o){switch(o.$$typeof){case w:return c(t,e=e.get(null===o.key?n:o.key)||null,o,r);case T:return u(t,e=e.get(null===o.key?n:o.key)||null,o,r);case R:return f(e,t,n,(0,o._init)(o._payload),r)}if(te(o)||N(o))return d(t,e=e.get(n)||null,o,r,null);Qs(t,o)}return null}function g(r,s,a,l){for(var c=null,u=null,d=s,g=s=0,m=null;null!==d&&g<a.length;g++){d.index>g?(m=d,d=null):m=d.sibling;var y=p(r,d,a[g],l);if(null===y){null===d&&(d=m);break}e&&d&&null===y.alternate&&t(r,d),s=i(y,s,g),null===u?c=y:u.sibling=y,u=y,d=m}if(g===a.length)return n(r,d),ss&&Zr(r,g),c;if(null===d){for(;g<a.length;g++)null!==(d=h(r,a[g],l))&&(s=i(d,s,g),null===u?c=d:u.sibling=d,u=d);return ss&&Zr(r,g),c}for(d=o(r,d);g<a.length;g++)null!==(m=f(d,r,g,a[g],l))&&(e&&null!==m.alternate&&d.delete(null===m.key?g:m.key),s=i(m,s,g),null===u?c=m:u.sibling=m,u=m);return e&&d.forEach((function(e){return t(r,e)})),ss&&Zr(r,g),c}function m(r,a,l,c){var u=N(l);if("function"!=typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,g=a,m=a=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var b=p(r,g,v.value,c);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(r,g),a=i(b,a,m),null===d?u=b:d.sibling=b,d=b,g=y}if(v.done)return n(r,g),ss&&Zr(r,m),u;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=h(r,v.value,c))&&(a=i(v,a,m),null===d?u=v:d.sibling=v,d=v);return ss&&Zr(r,m),u}for(g=o(r,g);!v.done;m++,v=l.next())null!==(v=f(g,r,m,v.value,c))&&(e&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=i(v,a,m),null===d?u=v:d.sibling=v,d=v);return e&&g.forEach((function(e){return t(r,e)})),ss&&Zr(r,m),u}return function e(o,s,i,l){if("object"==typeof i&&null!==i&&i.type===_&&null===i.key&&(i=i.props.children),"object"==typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,u=s;null!==u;){if(u.key===c){if((c=i.type)===_){if(7===u.tag){n(o,u.sibling),(s=r(u,i.props.children)).return=o,o=s;break e}}else if(u.elementType===c||"object"==typeof c&&null!==c&&c.$$typeof===R&&Js(c)===u.type){n(o,u.sibling),(s=r(u,i.props)).ref=zs(o,u,i),s.return=o,o=s;break e}n(o,u);break}t(o,u),u=u.sibling}i.type===_?((s=Lc(i.props.children,o.mode,l,i.key)).return=o,o=s):((l=Nc(i.type,i.key,i.props,null,o.mode,l)).ref=zs(o,s,i),l.return=o,o=l)}return a(o);case T:e:{for(u=i.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===i.containerInfo&&s.stateNode.implementation===i.implementation){n(o,s.sibling),(s=r(s,i.children||[])).return=o,o=s;break e}n(o,s);break}t(o,s),s=s.sibling}(s=Wc(i,o.mode,l)).return=o,o=s}return a(o);case R:return e(o,s,(u=i._init)(i._payload),l)}if(te(i))return g(o,s,i,l);if(N(i))return m(o,s,i,l);Qs(o,i)}return"string"==typeof i&&""!==i||"number"==typeof i?(i=""+i,null!==s&&6===s.tag?(n(o,s.sibling),(s=r(s,i)).return=o,o=s):(n(o,s),(s=Bc(i,o.mode,l)).return=o,o=s),a(o)):n(o,s)}}var Ys=Ks(!0),Xs=Ks(!1),Zs={},ei=kr(Zs),ti=kr(Zs),ni=kr(Zs);function oi(e){if(e===Zs)throw Error(s(174));return e}function ri(e,t){switch(Ar(ni,t),Ar(ti,e),Ar(ei,Zs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Er(ei),Ar(ei,t)}function si(){Er(ei),Er(ti),Er(ni)}function ii(e){oi(ni.current);var t=oi(ei.current),n=le(t,e.type);t!==n&&(Ar(ti,e),Ar(ei,n))}function ai(e){ti.current===e&&(Er(ei),Er(ti))}var li=kr(0);function ci(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ui=[];function di(){for(var e=0;e<ui.length;e++)ui[e]._workInProgressVersionPrimary=null;ui.length=0}var hi=S.ReactCurrentDispatcher,pi=S.ReactCurrentBatchConfig,fi=0,gi=null,mi=null,yi=null,vi=!1,bi=!1,Si=0,wi=0;function Ti(){throw Error(s(321))}function _i(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ao(e[n],t[n]))return!1;return!0}function Ci(e,t,n,o,r,i){if(fi=i,gi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hi.current=null===e||null===e.memoizedState?aa:la,e=n(o,r),bi){i=0;do{if(bi=!1,Si=0,25<=i)throw Error(s(301));i+=1,yi=mi=null,t.updateQueue=null,hi.current=ca,e=n(o,r)}while(bi)}if(hi.current=ia,t=null!==mi&&null!==mi.next,fi=0,yi=mi=gi=null,vi=!1,t)throw Error(s(300));return e}function ki(){var e=0!==Si;return Si=0,e}function Ei(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yi?gi.memoizedState=yi=e:yi=yi.next=e,yi}function Ai(){if(null===mi){var e=gi.alternate;e=null!==e?e.memoizedState:null}else e=mi.next;var t=null===yi?gi.memoizedState:yi.next;if(null!==t)yi=t,mi=e;else{if(null===e)throw Error(s(310));e={memoizedState:(mi=e).memoizedState,baseState:mi.baseState,baseQueue:mi.baseQueue,queue:mi.queue,next:null},null===yi?gi.memoizedState=yi=e:yi=yi.next=e}return yi}function Ii(e,t){return"function"==typeof t?t(e):t}function Pi(e){var t=Ai(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var o=mi,r=o.baseQueue,i=n.pending;if(null!==i){if(null!==r){var a=r.next;r.next=i.next,i.next=a}o.baseQueue=r=i,n.pending=null}if(null!==r){i=r.next,o=o.baseState;var l=a=null,c=null,u=i;do{var d=u.lane;if((fi&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),o=u.hasEagerState?u.eagerState:e(o,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,a=o):c=c.next=h,gi.lanes|=d,Fl|=d}u=u.next}while(null!==u&&u!==i);null===c?a=o:c.next=l,ao(o,t.memoizedState)||(Sa=!0),t.memoizedState=o,t.baseState=a,t.baseQueue=c,n.lastRenderedState=o}if(null!==(e=n.interleaved)){r=e;do{i=r.lane,gi.lanes|=i,Fl|=i,r=r.next}while(r!==e)}else null===r&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Mi(e){var t=Ai(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var o=n.dispatch,r=n.pending,i=t.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{i=e(i,a.action),a=a.next}while(a!==r);ao(i,t.memoizedState)||(Sa=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,o]}function xi(){}function Ri(e,t){var n=gi,o=Ai(),r=t(),i=!ao(o.memoizedState,r);if(i&&(o.memoizedState=r,Sa=!0),o=o.queue,$i(Ni.bind(null,n,o,e),[e]),o.getSnapshot!==t||i||null!==yi&&1&yi.memoizedState.tag){if(n.flags|=2048,Wi(9,Oi.bind(null,n,o,r,t),void 0,null),null===Ml)throw Error(s(349));30&fi||Di(n,t,r)}return r}function Di(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=gi.updateQueue)?(t={lastEffect:null,stores:null},gi.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Oi(e,t,n,o){t.value=n,t.getSnapshot=o,Li(t)&&Fi(e)}function Ni(e,t,n){return n((function(){Li(t)&&Fi(e)}))}function Li(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ao(e,n)}catch(e){return!0}}function Fi(e){var t=Ms(e,1);null!==t&&oc(t,e,1,-1)}function Bi(e){var t=Ei();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ii,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,gi,e),[t.memoizedState,e]}function Wi(e,t,n,o){return e={tag:e,create:t,destroy:n,deps:o,next:null},null===(t=gi.updateQueue)?(t={lastEffect:null,stores:null},gi.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(o=n.next,n.next=e,e.next=o,t.lastEffect=e),e}function Ui(){return Ai().memoizedState}function Gi(e,t,n,o){var r=Ei();gi.flags|=e,r.memoizedState=Wi(1|t,n,void 0,void 0===o?null:o)}function Hi(e,t,n,o){var r=Ai();o=void 0===o?null:o;var s=void 0;if(null!==mi){var i=mi.memoizedState;if(s=i.destroy,null!==o&&_i(o,i.deps))return void(r.memoizedState=Wi(t,n,s,o))}gi.flags|=e,r.memoizedState=Wi(1|t,n,s,o)}function qi(e,t){return Gi(8390656,8,e,t)}function $i(e,t){return Hi(2048,8,e,t)}function Vi(e,t){return Hi(4,2,e,t)}function ji(e,t){return Hi(4,4,e,t)}function zi(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Qi(e,t,n){return n=null!=n?n.concat([e]):null,Hi(4,4,zi.bind(null,t,e),n)}function Ji(){}function Ki(e,t){var n=Ai();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&_i(t,o[1])?o[0]:(n.memoizedState=[e,t],e)}function Yi(e,t){var n=Ai();t=void 0===t?null:t;var o=n.memoizedState;return null!==o&&null!==t&&_i(t,o[1])?o[0]:(e=e(),n.memoizedState=[e,t],e)}function Xi(e,t,n){return 21&fi?(ao(n,t)||(n=gt(),gi.lanes|=n,Fl|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Sa=!0),e.memoizedState=n)}function Zi(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var o=pi.transition;pi.transition={};try{e(!1),t()}finally{bt=n,pi.transition=o}}function ea(){return Ai().memoizedState}function ta(e,t,n){var o=nc(e);n={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null},oa(e)?ra(t,n):null!==(n=Ps(e,t,n,o))&&(oc(n,e,o,tc()),sa(n,t,o))}function na(e,t,n){var o=nc(e),r={lane:o,action:n,hasEagerState:!1,eagerState:null,next:null};if(oa(e))ra(t,r);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,a=s(i,n);if(r.hasEagerState=!0,r.eagerState=a,ao(a,i)){var l=t.interleaved;return null===l?(r.next=r,Is(t)):(r.next=l.next,l.next=r),void(t.interleaved=r)}}catch(e){}null!==(n=Ps(e,t,r,o))&&(oc(n,e,o,r=tc()),sa(n,t,o))}}function oa(e){var t=e.alternate;return e===gi||null!==t&&t===gi}function ra(e,t){bi=vi=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sa(e,t,n){if(4194240&n){var o=t.lanes;n|=o&=e.pendingLanes,t.lanes=n,vt(e,n)}}var ia={readContext:Es,useCallback:Ti,useContext:Ti,useEffect:Ti,useImperativeHandle:Ti,useInsertionEffect:Ti,useLayoutEffect:Ti,useMemo:Ti,useReducer:Ti,useRef:Ti,useState:Ti,useDebugValue:Ti,useDeferredValue:Ti,useTransition:Ti,useMutableSource:Ti,useSyncExternalStore:Ti,useId:Ti,unstable_isNewReconciler:!1},aa={readContext:Es,useCallback:function(e,t){return Ei().memoizedState=[e,void 0===t?null:t],e},useContext:Es,useEffect:qi,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Gi(4194308,4,zi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Gi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Gi(4,2,e,t)},useMemo:function(e,t){var n=Ei();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var o=Ei();return t=void 0!==n?n(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=ta.bind(null,gi,e),[o.memoizedState,e]},useRef:function(e){return e={current:e},Ei().memoizedState=e},useState:Bi,useDebugValue:Ji,useDeferredValue:function(e){return Ei().memoizedState=e},useTransition:function(){var e=Bi(!1),t=e[0];return e=Zi.bind(null,e[1]),Ei().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var o=gi,r=Ei();if(ss){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Ml)throw Error(s(349));30&fi||Di(o,t,n)}r.memoizedState=n;var i={value:n,getSnapshot:t};return r.queue=i,qi(Ni.bind(null,o,i,e),[e]),o.flags|=2048,Wi(9,Oi.bind(null,o,i,n,t),void 0,null),n},useId:function(){var e=Ei(),t=Ml.identifierPrefix;if(ss){var n=Xr;t=":"+t+"R"+(n=(Yr&~(1<<32-it(Yr)-1)).toString(32)+n),0<(n=Si++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},la={readContext:Es,useCallback:Ki,useContext:Es,useEffect:$i,useImperativeHandle:Qi,useInsertionEffect:Vi,useLayoutEffect:ji,useMemo:Yi,useReducer:Pi,useRef:Ui,useState:function(){return Pi(Ii)},useDebugValue:Ji,useDeferredValue:function(e){return Xi(Ai(),mi.memoizedState,e)},useTransition:function(){return[Pi(Ii)[0],Ai().memoizedState]},useMutableSource:xi,useSyncExternalStore:Ri,useId:ea,unstable_isNewReconciler:!1},ca={readContext:Es,useCallback:Ki,useContext:Es,useEffect:$i,useImperativeHandle:Qi,useInsertionEffect:Vi,useLayoutEffect:ji,useMemo:Yi,useReducer:Mi,useRef:Ui,useState:function(){return Mi(Ii)},useDebugValue:Ji,useDeferredValue:function(e){var t=Ai();return null===mi?t.memoizedState=e:Xi(t,mi.memoizedState,e)},useTransition:function(){return[Mi(Ii)[0],Ai().memoizedState]},useMutableSource:xi,useSyncExternalStore:Ri,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var n="",o=t;do{n+=G(o),o=o.return}while(o);var r=n}catch(e){r="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:r,digest:null}}function da(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ha(e,t){try{console.error(t.value)}catch(e){setTimeout((function(){throw e}))}}var pa="function"==typeof WeakMap?WeakMap:Map;function fa(e,t,n){(n=Os(-1,n)).tag=3,n.payload={element:null};var o=t.value;return n.callback=function(){Vl||(Vl=!0,jl=o),ha(0,t)},n}function ga(e,t,n){(n=Os(-1,n)).tag=3;var o=e.type.getDerivedStateFromError;if("function"==typeof o){var r=t.value;n.payload=function(){return o(r)},n.callback=function(){ha(0,t)}}var s=e.stateNode;return null!==s&&"function"==typeof s.componentDidCatch&&(n.callback=function(){ha(0,t),"function"!=typeof o&&(null===zl?zl=new Set([this]):zl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var o=e.pingCache;if(null===o){o=e.pingCache=new pa;var r=new Set;o.set(t,r)}else void 0===(r=o.get(t))&&(r=new Set,o.set(t,r));r.has(n)||(r.add(n),e=Ec.bind(null,e,t,n),t.then(e,e))}function ya(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function va(e,t,n,o,r){return 1&e.mode?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Os(-1,1)).tag=2,Ns(n,t,1))),n.lanes|=1),e)}var ba=S.ReactCurrentOwner,Sa=!1;function wa(e,t,n,o){t.child=null===e?Xs(t,null,n,o):Ys(t,e.child,n,o)}function Ta(e,t,n,o,r){n=n.render;var s=t.ref;return ks(t,r),o=Ci(e,t,n,o,s,r),n=ki(),null===e||Sa?(ss&&n&&ts(t),t.flags|=1,wa(e,t,o,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Va(e,t,r))}function _a(e,t,n,o,r){if(null===e){var s=n.type;return"function"!=typeof s||Dc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Nc(n.type,null,o,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ca(e,t,s,o,r))}if(s=e.child,!(e.lanes&r)){var i=s.memoizedProps;if((n=null!==(n=n.compare)?n:lo)(i,o)&&e.ref===t.ref)return Va(e,t,r)}return t.flags|=1,(e=Oc(s,o)).ref=t.ref,e.return=t,t.child=e}function Ca(e,t,n,o,r){if(null!==e){var s=e.memoizedProps;if(lo(s,o)&&e.ref===t.ref){if(Sa=!1,t.pendingProps=o=s,!(e.lanes&r))return t.lanes=e.lanes,Va(e,t,r);131072&e.flags&&(Sa=!0)}}return Aa(e,t,n,o,r)}function ka(e,t,n){var o=t.pendingProps,r=o.children,s=null!==e?e.memoizedState:null;if("hidden"===o.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ar(Ol,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=null!==s?s.baseLanes:n,Ar(Ol,Dl),Dl|=o}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ar(Ol,Dl),Dl|=n;else null!==s?(o=s.baseLanes|n,t.memoizedState=null):o=n,Ar(Ol,Dl),Dl|=o;return wa(e,t,r,n),t.child}function Ea(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Aa(e,t,n,o,r){var s=Dr(n)?xr:Pr.current;return s=Rr(t,s),ks(t,r),n=Ci(e,t,n,o,s,r),o=ki(),null===e||Sa?(ss&&o&&ts(t),t.flags|=1,wa(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Va(e,t,r))}function Ia(e,t,n,o,r){if(Dr(n)){var s=!0;Fr(t)}else s=!1;if(ks(t,r),null===t.stateNode)$a(e,t),$s(t,n,o),js(t,n,o,r),o=!0;else if(null===e){var i=t.stateNode,a=t.memoizedProps;i.props=a;var l=i.context,c=n.contextType;c="object"==typeof c&&null!==c?Es(c):Rr(t,c=Dr(n)?xr:Pr.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof i.getSnapshotBeforeUpdate;d||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(a!==o||l!==c)&&Vs(t,i,o,c),xs=!1;var h=t.memoizedState;i.state=h,Bs(t,o,i,r),l=t.memoizedState,a!==o||h!==l||Mr.current||xs?("function"==typeof u&&(Gs(t,n,u,o),l=t.memoizedState),(a=xs||qs(t,n,a,o,h,l,c))?(d||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=l),i.props=o,i.state=l,i.context=c,o=a):("function"==typeof i.componentDidMount&&(t.flags|=4194308),o=!1)}else{i=t.stateNode,Ds(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:ys(t.type,a),i.props=c,d=t.pendingProps,h=i.context,l="object"==typeof(l=n.contextType)&&null!==l?Es(l):Rr(t,l=Dr(n)?xr:Pr.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(a!==d||h!==l)&&Vs(t,i,o,l),xs=!1,h=t.memoizedState,i.state=h,Bs(t,o,i,r);var f=t.memoizedState;a!==d||h!==f||Mr.current||xs?("function"==typeof p&&(Gs(t,n,p,o),f=t.memoizedState),(c=xs||qs(t,n,c,o,h,f,l)||!1)?(u||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(o,f,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(o,f,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=f),i.props=o,i.state=f,i.context=l,o=c):("function"!=typeof i.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),o=!1)}return Pa(e,t,n,o,s,r)}function Pa(e,t,n,o,r,s){Ea(e,t);var i=!!(128&t.flags);if(!o&&!i)return r&&Br(t,n,!1),Va(e,t,s);o=t.stateNode,ba.current=t;var a=i&&"function"!=typeof n.getDerivedStateFromError?null:o.render();return t.flags|=1,null!==e&&i?(t.child=Ys(t,e.child,null,s),t.child=Ys(t,null,a,s)):wa(e,t,a,s),t.memoizedState=o.state,r&&Br(t,n,!0),t.child}function Ma(e){var t=e.stateNode;t.pendingContext?Nr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Nr(0,t.context,!1),ri(e,t.containerInfo)}function xa(e,t,n,o,r){return fs(),gs(r),t.flags|=256,wa(e,t,n,o),t.child}var Ra,Da,Oa,Na,La={dehydrated:null,treeContext:null,retryLane:0};function Fa(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ba(e,t,n){var o,r=t.pendingProps,i=li.current,a=!1,l=!!(128&t.flags);if((o=l)||(o=(null===e||null!==e.memoizedState)&&!!(2&i)),o?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ar(li,1&i),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,a?(r=t.mode,a=t.child,l={mode:"hidden",children:l},1&r||null===a?a=Fc(l,r,0,null):(a.childLanes=0,a.pendingProps=l),e=Lc(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Fa(n),t.memoizedState=La,e):Wa(t,l));if(null!==(i=e.memoizedState)&&null!==(o=i.dehydrated))return function(e,t,n,o,r,i,a){if(n)return 256&t.flags?(t.flags&=-257,Ua(e,t,a,o=da(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=o.fallback,r=t.mode,o=Fc({mode:"visible",children:o.children},r,0,null),(i=Lc(i,r,a,null)).flags|=2,o.return=t,i.return=t,o.sibling=i,t.child=o,1&t.mode&&Ys(t,e.child,null,a),t.child.memoizedState=Fa(a),t.memoizedState=La,i);if(!(1&t.mode))return Ua(e,t,a,null);if("$!"===r.data){if(o=r.nextSibling&&r.nextSibling.dataset)var l=o.dgst;return o=l,Ua(e,t,a,o=da(i=Error(s(419)),o,void 0))}if(l=!!(a&e.childLanes),Sa||l){if(null!==(o=Ml)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=r&(o.suspendedLanes|a)?0:r)&&r!==i.retryLane&&(i.retryLane=r,Ms(e,r),oc(o,e,r,-1))}return mc(),Ua(e,t,a,o=da(Error(s(421))))}return"$?"===r.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),r._reactRetry=t,null):(e=i.treeContext,rs=ur(r.nextSibling),os=t,ss=!0,is=null,null!==e&&(Qr[Jr++]=Yr,Qr[Jr++]=Xr,Qr[Jr++]=Kr,Yr=e.id,Xr=e.overflow,Kr=t),(t=Wa(t,o.children)).flags|=4096,t)}(e,t,l,r,o,i,n);if(a){a=r.fallback,l=t.mode,o=(i=e.child).sibling;var c={mode:"hidden",children:r.children};return 1&l||t.child===i?(r=Oc(i,c)).subtreeFlags=14680064&i.subtreeFlags:((r=t.child).childLanes=0,r.pendingProps=c,t.deletions=null),null!==o?a=Oc(o,a):(a=Lc(a,l,n,null)).flags|=2,a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,l=null===(l=e.child.memoizedState)?Fa(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=La,r}return e=(a=e.child).sibling,r=Oc(a,{mode:"visible",children:r.children}),!(1&t.mode)&&(r.lanes=n),r.return=t,r.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Wa(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ua(e,t,n,o){return null!==o&&gs(o),Ys(t,e.child,null,n),(e=Wa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ga(e,t,n){e.lanes|=t;var o=e.alternate;null!==o&&(o.lanes|=t),Cs(e.return,t,n)}function Ha(e,t,n,o,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:n,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=o,s.tail=n,s.tailMode=r)}function qa(e,t,n){var o=t.pendingProps,r=o.revealOrder,s=o.tail;if(wa(e,t,o.children,n),2&(o=li.current))o=1&o|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ga(e,n,t);else if(19===e.tag)Ga(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Ar(li,o),1&t.mode)switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===ci(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),Ha(t,!1,r,n,s);break;case"backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===ci(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}Ha(t,!0,n,null,s);break;case"together":Ha(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function $a(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Va(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ja(e,t){if(!ss)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var o=null;null!==n;)null!==n.alternate&&(o=n),n=n.sibling;null===o?t||null===e.tail?e.tail=null:e.tail.sibling=null:o.sibling=null}}function za(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,o=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,o|=14680064&r.subtreeFlags,o|=14680064&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,o|=r.subtreeFlags,o|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=o,e.childLanes=n,t}function Qa(e,t,n){var o=t.pendingProps;switch(ns(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return za(t),null;case 1:case 17:return Dr(t.type)&&Or(),za(t),null;case 3:return o=t.stateNode,si(),Er(Mr),Er(Pr),di(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==is&&(ac(is),is=null))),Da(e,t),za(t),null;case 5:ai(t);var r=oi(ni.current);if(n=t.type,null!==e&&null!=t.stateNode)Oa(e,t,n,o,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(null===t.stateNode)throw Error(s(166));return za(t),null}if(e=oi(ei.current),hs(t)){o=t.stateNode,n=t.type;var i=t.memoizedProps;switch(o[pr]=t,o[fr]=i,e=!!(1&t.mode),n){case"dialog":Uo("cancel",o),Uo("close",o);break;case"iframe":case"object":case"embed":Uo("load",o);break;case"video":case"audio":for(r=0;r<Lo.length;r++)Uo(Lo[r],o);break;case"source":Uo("error",o);break;case"img":case"image":case"link":Uo("error",o),Uo("load",o);break;case"details":Uo("toggle",o);break;case"input":K(o,i),Uo("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!i.multiple},Uo("invalid",o);break;case"textarea":re(o,i),Uo("invalid",o)}for(var l in ve(n,i),r=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"==typeof c?o.textContent!==c&&(!0!==i.suppressHydrationWarning&&Zo(o.textContent,c,e),r=["children",c]):"number"==typeof c&&o.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Zo(o.textContent,c,e),r=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Uo("scroll",o)}switch(n){case"input":j(o),Z(o,i,!0);break;case"textarea":j(o),ie(o);break;case"select":case"option":break;default:"function"==typeof i.onClick&&(o.onclick=er)}o=r,t.updateQueue=o,null!==o&&(t.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof o.is?e=l.createElement(n,{is:o.is}):(e=l.createElement(n),"select"===n&&(l=e,o.multiple?l.multiple=!0:o.size&&(l.size=o.size))):e=l.createElementNS(e,n),e[pr]=t,e[fr]=o,Ra(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,o),n){case"dialog":Uo("cancel",e),Uo("close",e),r=o;break;case"iframe":case"object":case"embed":Uo("load",e),r=o;break;case"video":case"audio":for(r=0;r<Lo.length;r++)Uo(Lo[r],e);r=o;break;case"source":Uo("error",e),r=o;break;case"img":case"image":case"link":Uo("error",e),Uo("load",e),r=o;break;case"details":Uo("toggle",e),r=o;break;case"input":K(e,o),r=J(e,o),Uo("invalid",e);break;case"option":default:r=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},r=F({},o,{value:void 0}),Uo("invalid",e);break;case"textarea":re(e,o),r=oe(e,o),Uo("invalid",e)}for(i in ve(n,r),c=r)if(c.hasOwnProperty(i)){var u=c[i];"style"===i?me(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===i?"string"==typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"==typeof u&&he(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(a.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Uo("scroll",e):null!=u&&b(e,i,u,l))}switch(n){case"input":j(e),Z(e,o,!1);break;case"textarea":j(e),ie(e);break;case"option":null!=o.value&&e.setAttribute("value",""+$(o.value));break;case"select":e.multiple=!!o.multiple,null!=(i=o.value)?ne(e,!!o.multiple,i,!1):null!=o.defaultValue&&ne(e,!!o.multiple,o.defaultValue,!0);break;default:"function"==typeof r.onClick&&(e.onclick=er)}switch(n){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return za(t),null;case 6:if(e&&null!=t.stateNode)Na(e,t,e.memoizedProps,o);else{if("string"!=typeof o&&null===t.stateNode)throw Error(s(166));if(n=oi(ni.current),oi(ei.current),hs(t)){if(o=t.stateNode,n=t.memoizedProps,o[pr]=t,(i=o.nodeValue!==n)&&null!==(e=os))switch(e.tag){case 3:Zo(o.nodeValue,n,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zo(o.nodeValue,n,!!(1&e.mode))}i&&(t.flags|=4)}else(o=(9===n.nodeType?n:n.ownerDocument).createTextNode(o))[pr]=t,t.stateNode=o}return za(t),null;case 13:if(Er(li),o=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ss&&null!==rs&&1&t.mode&&!(128&t.flags))ps(),fs(),t.flags|=98560,i=!1;else if(i=hs(t),null!==o&&null!==o.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[pr]=t}else fs(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;za(t),i=!1}else null!==is&&(ac(is),is=null),i=!0;if(!i)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((o=null!==o)!=(null!==e&&null!==e.memoizedState)&&o&&(t.child.flags|=8192,1&t.mode&&(null===e||1&li.current?0===Nl&&(Nl=3):mc())),null!==t.updateQueue&&(t.flags|=4),za(t),null);case 4:return si(),Da(e,t),null===e&&qo(t.stateNode.containerInfo),za(t),null;case 10:return _s(t.type._context),za(t),null;case 19:if(Er(li),null===(i=t.memoizedState))return za(t),null;if(o=!!(128&t.flags),null===(l=i.rendering))if(o)ja(i,!1);else{if(0!==Nl||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=ci(e))){for(t.flags|=128,ja(i,!1),null!==(o=l.updateQueue)&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=n,n=t.child;null!==n;)e=o,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ar(li,1&li.current|2),t.child}e=e.sibling}null!==i.tail&&Ye()>ql&&(t.flags|=128,o=!0,ja(i,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=ci(l))){if(t.flags|=128,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),ja(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!ss)return za(t),null}else 2*Ye()-i.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,o=!0,ja(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ye(),t.sibling=null,n=li.current,Ar(li,o?1&n|2:1&n),t):(za(t),null);case 22:case 23:return hc(),o=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==o&&(t.flags|=8192),o&&1&t.mode?!!(1073741824&Dl)&&(za(t),6&t.subtreeFlags&&(t.flags|=8192)):za(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ja(e,t){switch(ns(t),t.tag){case 1:return Dr(t.type)&&Or(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return si(),Er(Mr),Er(Pr),di(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return ai(t),null;case 13:if(Er(li),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Er(li),null;case 4:return si(),null;case 10:return _s(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ra=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Da=function(){},Oa=function(e,t,n,o){var r=e.memoizedProps;if(r!==o){e=t.stateNode,oi(ei.current);var s,i=null;switch(n){case"input":r=J(e,r),o=J(e,o),i=[];break;case"select":r=F({},r,{value:void 0}),o=F({},o,{value:void 0}),i=[];break;case"textarea":r=oe(e,r),o=oe(e,o),i=[];break;default:"function"!=typeof r.onClick&&"function"==typeof o.onClick&&(e.onclick=er)}for(u in ve(n,o),n=null,r)if(!o.hasOwnProperty(u)&&r.hasOwnProperty(u)&&null!=r[u])if("style"===u){var l=r[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in o){var c=o[u];if(l=null!=r?r[u]:void 0,o.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(i||(i=[]),i.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(u,c)):"children"===u?"string"!=typeof c&&"number"!=typeof c||(i=i||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Uo("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}},Na=function(e,t,n,o){n!==o&&(t.flags|=4)};var Ka=!1,Ya=!1,Xa="function"==typeof WeakSet?WeakSet:Set,Za=null;function el(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){kc(e,t,n)}else n.current=null}function tl(e,t,n){try{n()}catch(n){kc(e,t,n)}}var nl=!1;function ol(e,t,n){var o=t.updateQueue;if(null!==(o=null!==o?o.lastEffect:null)){var r=o=o.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,void 0!==s&&tl(t,n,s)}r=r.next}while(r!==o)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var o=n.create;n.destroy=o()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&(delete t[pr],delete t[fr],delete t[mr],delete t[yr],delete t[vr]),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=er));else if(4!==o&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==o&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var dl=null,hl=!1;function pl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"==typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(rt,n)}catch(e){}switch(n.tag){case 5:Ya||el(n,t);case 6:var o=dl,r=hl;dl=null,pl(e,t,n),hl=r,null!==(dl=o)&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(hl?(e=dl,n=n.stateNode,8===e.nodeType?cr(e.parentNode,n):1===e.nodeType&&cr(e,n),Ht(e)):cr(dl,n.stateNode));break;case 4:o=dl,r=hl,dl=n.stateNode.containerInfo,hl=!0,pl(e,t,n),dl=o,hl=r;break;case 0:case 11:case 14:case 15:if(!Ya&&null!==(o=n.updateQueue)&&null!==(o=o.lastEffect)){r=o=o.next;do{var s=r,i=s.destroy;s=s.tag,void 0!==i&&(2&s||4&s)&&tl(n,t,i),r=r.next}while(r!==o)}pl(e,t,n);break;case 1:if(!Ya&&(el(n,t),"function"==typeof(o=n.stateNode).componentWillUnmount))try{o.props=n.memoizedProps,o.state=n.memoizedState,o.componentWillUnmount()}catch(e){kc(n,t,e)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Ya=(o=Ya)||null!==n.memoizedState,pl(e,t,n),Ya=o):pl(e,t,n);break;default:pl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xa),t.forEach((function(t){var o=Pc.bind(null,e,t);n.has(t)||(n.add(t),t.then(o,o))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var o=0;o<n.length;o++){var r=n[o];try{var i=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,hl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===dl)throw Error(s(160));fl(i,a,r),dl=null,hl=!1;var c=r.alternate;null!==c&&(c.return=null),r.return=null}catch(e){kc(r,t,e)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yl(t,e),t=t.sibling}function yl(e,t){var n=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),vl(e),4&o){try{ol(3,e,e.return),rl(3,e)}catch(t){kc(e,e.return,t)}try{ol(5,e,e.return)}catch(t){kc(e,e.return,t)}}break;case 1:ml(t,e),vl(e),512&o&&null!==n&&el(n,n.return);break;case 5:if(ml(t,e),vl(e),512&o&&null!==n&&el(n,n.return),32&e.flags){var r=e.stateNode;try{he(r,"")}catch(t){kc(e,e.return,t)}}if(4&o&&null!=(r=e.stateNode)){var i=e.memoizedProps,a=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&Y(r,i),be(l,a);var u=be(l,i);for(a=0;a<c.length;a+=2){var d=c[a],h=c[a+1];"style"===d?me(r,h):"dangerouslySetInnerHTML"===d?de(r,h):"children"===d?he(r,h):b(r,d,h,u)}switch(l){case"input":X(r,i);break;case"textarea":se(r,i);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?ne(r,!!i.multiple,f,!1):p!==!!i.multiple&&(null!=i.defaultValue?ne(r,!!i.multiple,i.defaultValue,!0):ne(r,!!i.multiple,i.multiple?[]:"",!1))}r[fr]=i}catch(t){kc(e,e.return,t)}}break;case 6:if(ml(t,e),vl(e),4&o){if(null===e.stateNode)throw Error(s(162));r=e.stateNode,i=e.memoizedProps;try{r.nodeValue=i}catch(t){kc(e,e.return,t)}}break;case 3:if(ml(t,e),vl(e),4&o&&null!==n&&n.memoizedState.isDehydrated)try{Ht(t.containerInfo)}catch(t){kc(e,e.return,t)}break;case 4:default:ml(t,e),vl(e);break;case 13:ml(t,e),vl(e),8192&(r=e.child).flags&&(i=null!==r.memoizedState,r.stateNode.isHidden=i,!i||null!==r.alternate&&null!==r.alternate.memoizedState||(Hl=Ye())),4&o&&gl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(u=Ya)||d,ml(t,e),Ya=u):ml(t,e),vl(e),8192&o){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&1&e.mode)for(Za=e,d=e.child;null!==d;){for(h=Za=d;null!==Za;){switch(f=(p=Za).child,p.tag){case 0:case 11:case 14:case 15:ol(4,p,p.return);break;case 1:el(p,p.return);var g=p.stateNode;if("function"==typeof g.componentWillUnmount){o=p,n=p.return;try{t=o,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(e){kc(o,n,e)}}break;case 5:el(p,p.return);break;case 22:if(null!==p.memoizedState){Tl(h);continue}}null!==f?(f.return=p,Za=f):Tl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{r=h.stateNode,u?"function"==typeof(i=r.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,a=null!=(c=h.memoizedProps.style)&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",a))}catch(t){kc(e,e.return,t)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(t){kc(e,e.return,t)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),vl(e),4&o&&gl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var o=n;break e}n=n.return}throw Error(s(160))}switch(o.tag){case 5:var r=o.stateNode;32&o.flags&&(he(r,""),o.flags&=-33),ul(e,ll(e),r);break;case 3:case 4:var i=o.stateNode.containerInfo;cl(e,ll(e),i);break;default:throw Error(s(161))}}catch(t){kc(e,e.return,t)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Za=e,Sl(e,t,n)}function Sl(e,t,n){for(var o=!!(1&e.mode);null!==Za;){var r=Za,s=r.child;if(22===r.tag&&o){var i=null!==r.memoizedState||Ka;if(!i){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Ka;var c=Ya;if(Ka=i,(Ya=l)&&!c)for(Za=r;null!==Za;)l=(i=Za).child,22===i.tag&&null!==i.memoizedState?_l(r):null!==l?(l.return=i,Za=l):_l(r);for(;null!==s;)Za=s,Sl(s,t,n),s=s.sibling;Za=r,Ka=a,Ya=c}wl(e)}else 8772&r.subtreeFlags&&null!==s?(s.return=r,Za=s):wl(e)}}function wl(e){for(;null!==Za;){var t=Za;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Ya||rl(5,t);break;case 1:var o=t.stateNode;if(4&t.flags&&!Ya)if(null===n)o.componentDidMount();else{var r=t.elementType===t.type?n.memoizedProps:ys(t.type,n.memoizedProps);o.componentDidUpdate(r,n.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&Ws(t,i,o);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Ws(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Ht(h)}}}break;default:throw Error(s(163))}Ya||512&t.flags&&sl(t)}catch(e){kc(t,t.return,e)}}if(t===e){Za=null;break}if(null!==(n=t.sibling)){n.return=t.return,Za=n;break}Za=t.return}}function Tl(e){for(;null!==Za;){var t=Za;if(t===e){Za=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Za=n;break}Za=t.return}}function _l(e){for(;null!==Za;){var t=Za;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(e){kc(t,n,e)}break;case 1:var o=t.stateNode;if("function"==typeof o.componentDidMount){var r=t.return;try{o.componentDidMount()}catch(e){kc(t,r,e)}}var s=t.return;try{sl(t)}catch(e){kc(t,s,e)}break;case 5:var i=t.return;try{sl(t)}catch(e){kc(t,i,e)}}}catch(e){kc(t,t.return,e)}if(t===e){Za=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Za=a;break}Za=t.return}}var Cl,kl=Math.ceil,El=S.ReactCurrentDispatcher,Al=S.ReactCurrentOwner,Il=S.ReactCurrentBatchConfig,Pl=0,Ml=null,xl=null,Rl=0,Dl=0,Ol=kr(0),Nl=0,Ll=null,Fl=0,Bl=0,Wl=0,Ul=null,Gl=null,Hl=0,ql=1/0,$l=null,Vl=!1,jl=null,zl=null,Ql=!1,Jl=null,Kl=0,Yl=0,Xl=null,Zl=-1,ec=0;function tc(){return 6&Pl?Ye():-1!==Zl?Zl:Zl=Ye()}function nc(e){return 1&e.mode?2&Pl&&0!==Rl?Rl&-Rl:null!==ms.transition?(0===ec&&(ec=gt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Kt(e.type):1}function oc(e,t,n,o){if(50<Yl)throw Yl=0,Xl=null,Error(s(185));yt(e,n,o),2&Pl&&e===Ml||(e===Ml&&(!(2&Pl)&&(Bl|=n),4===Nl&&lc(e,Rl)),rc(e,o),1===n&&0===Pl&&!(1&t.mode)&&(ql=Ye()+500,Ur&&qr()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,o=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-it(s),a=1<<i,l=r[i];-1===l?a&n&&!(a&o)||(r[i]=pt(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var o=ht(e,e===Ml?Rl:0);if(0===o)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Ur=!0,Hr(e)}(cc.bind(null,e)):Hr(cc.bind(null,e)),ar((function(){!(6&Pl)&&qr()})),n=null;else{switch(St(o)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=ot}n=Mc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Zl=-1,ec=0,6&Pl)throw Error(s(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var o=ht(e,e===Ml?Rl:0);if(0===o)return null;if(30&o||o&e.expiredLanes||t)t=yc(e,o);else{t=o;var r=Pl;Pl|=2;var i=gc();for(Ml===e&&Rl===t||($l=null,ql=Ye()+500,pc(e,t));;)try{bc();break}catch(t){fc(e,t)}Ts(),El.current=i,Pl=r,null!==xl?t=0:(Ml=null,Rl=0,t=Nl)}if(0!==t){if(2===t&&0!==(r=ft(e))&&(o=r,t=ic(e,r)),1===t)throw n=Ll,pc(e,0),lc(e,o),rc(e,Ye()),n;if(6===t)lc(e,o);else{if(r=e.current.alternate,!(30&o||function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var o=0;o<n.length;o++){var r=n[o],s=r.getSnapshot;r=r.value;try{if(!ao(s(),r))return!1}catch(e){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(r)||(t=yc(e,o),2===t&&(i=ft(e),0!==i&&(o=i,t=ic(e,i))),1!==t)))throw n=Ll,pc(e,0),lc(e,o),rc(e,Ye()),n;switch(e.finishedWork=r,e.finishedLanes=o,t){case 0:case 1:throw Error(s(345));case 2:case 5:Tc(e,Gl,$l);break;case 3:if(lc(e,o),(130023424&o)===o&&10<(t=Hl+500-Ye())){if(0!==ht(e,0))break;if(((r=e.suspendedLanes)&o)!==o){tc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=rr(Tc.bind(null,e,Gl,$l),t);break}Tc(e,Gl,$l);break;case 4:if(lc(e,o),(4194240&o)===o)break;for(t=e.eventTimes,r=-1;0<o;){var a=31-it(o);i=1<<a,(a=t[a])>r&&(r=a),o&=~i}if(o=r,10<(o=(120>(o=Ye()-o)?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*kl(o/1960))-o)){e.timeoutHandle=rr(Tc.bind(null,e,Gl,$l),o);break}Tc(e,Gl,$l);break;default:throw Error(s(329))}}}return rc(e,Ye()),e.callbackNode===n?sc.bind(null,e):null}function ic(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=Gl,Gl=n,null!==t&&ac(t)),e}function ac(e){null===Gl?Gl=e:Gl.push.apply(Gl,e)}function lc(e,t){for(t&=~Wl,t&=~Bl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),o=1<<n;e[n]=-1,t&=~o}}function cc(e){if(6&Pl)throw Error(s(327));_c();var t=ht(e,0);if(!(1&t))return rc(e,Ye()),null;var n=yc(e,t);if(0!==e.tag&&2===n){var o=ft(e);0!==o&&(t=o,n=ic(e,o))}if(1===n)throw n=Ll,pc(e,0),lc(e,t),rc(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Tc(e,Gl,$l),rc(e,Ye()),null}function uc(e,t){var n=Pl;Pl|=1;try{return e(t)}finally{0===(Pl=n)&&(ql=Ye()+500,Ur&&qr())}}function dc(e){null!==Jl&&0===Jl.tag&&!(6&Pl)&&_c();var t=Pl;Pl|=1;var n=Il.transition,o=bt;try{if(Il.transition=null,bt=1,e)return e()}finally{bt=o,Il.transition=n,!(6&(Pl=t))&&qr()}}function hc(){Dl=Ol.current,Er(Ol)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,sr(n)),null!==xl)for(n=xl.return;null!==n;){var o=n;switch(ns(o),o.tag){case 1:null!=(o=o.type.childContextTypes)&&Or();break;case 3:si(),Er(Mr),Er(Pr),di();break;case 5:ai(o);break;case 4:si();break;case 13:case 19:Er(li);break;case 10:_s(o.type._context);break;case 22:case 23:hc()}n=n.return}if(Ml=e,xl=e=Oc(e.current,null),Rl=Dl=t,Nl=0,Ll=null,Wl=Bl=Fl=0,Gl=Ul=null,null!==As){for(t=0;t<As.length;t++)if(null!==(o=(n=As[t]).interleaved)){n.interleaved=null;var r=o.next,s=n.pending;if(null!==s){var i=s.next;s.next=r,o.next=i}n.pending=o}As=null}return e}function fc(e,t){for(;;){var n=xl;try{if(Ts(),hi.current=ia,vi){for(var o=gi.memoizedState;null!==o;){var r=o.queue;null!==r&&(r.pending=null),o=o.next}vi=!1}if(fi=0,yi=mi=gi=null,bi=!1,Si=0,Al.current=null,null===n||null===n.return){Nl=1,Ll=t,xl=null;break}e:{var i=e,a=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"==typeof c&&"function"==typeof c.then){var u=c,d=l,h=d.tag;if(!(1&d.mode||0!==h&&11!==h&&15!==h)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=ya(a);if(null!==f){f.flags&=-257,va(f,a,l,0,t),1&f.mode&&ma(i,u,t),c=u;var g=(t=f).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(!(1&t)){ma(i,u,t),mc();break e}c=Error(s(426))}else if(ss&&1&l.mode){var y=ya(a);if(null!==y){!(65536&y.flags)&&(y.flags|=256),va(y,a,l,0,t),gs(ua(c,l));break e}}i=c=ua(c,l),4!==Nl&&(Nl=2),null===Ul?Ul=[i]:Ul.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Fs(i,fa(0,c,t));break e;case 1:l=c;var v=i.type,b=i.stateNode;if(!(128&i.flags||"function"!=typeof v.getDerivedStateFromError&&(null===b||"function"!=typeof b.componentDidCatch||null!==zl&&zl.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t,Fs(i,ga(i,l,t));break e}}i=i.return}while(null!==i)}wc(n)}catch(e){t=e,xl===n&&null!==n&&(xl=n=n.return);continue}break}}function gc(){var e=El.current;return El.current=ia,null===e?ia:e}function mc(){0!==Nl&&3!==Nl&&2!==Nl||(Nl=4),null===Ml||!(268435455&Fl)&&!(268435455&Bl)||lc(Ml,Rl)}function yc(e,t){var n=Pl;Pl|=2;var o=gc();for(Ml===e&&Rl===t||($l=null,pc(e,t));;)try{vc();break}catch(t){fc(e,t)}if(Ts(),Pl=n,El.current=o,null!==xl)throw Error(s(261));return Ml=null,Rl=0,Nl}function vc(){for(;null!==xl;)Sc(xl)}function bc(){for(;null!==xl&&!Je();)Sc(xl)}function Sc(e){var t=Cl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?wc(e):xl=t,Al.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Ja(n,t)))return n.flags&=32767,void(xl=n);if(null===e)return Nl=6,void(xl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Qa(n,t,Dl)))return void(xl=n);if(null!==(t=t.sibling))return void(xl=t);xl=t=e}while(null!==t);0===Nl&&(Nl=5)}function Tc(e,t,n){var o=bt,r=Il.transition;try{Il.transition=null,bt=1,function(e,t,n,o){do{_c()}while(null!==Jl);if(6&Pl)throw Error(s(327));n=e.finishedWork;var r=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<n;){var r=31-it(n),s=1<<r;t[r]=0,o[r]=-1,e[r]=-1,n&=~s}}(e,i),e===Ml&&(xl=Ml=null,Rl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Ql||(Ql=!0,Mc(tt,(function(){return _c(),null}))),i=!!(15990&n.flags),15990&n.subtreeFlags||i){i=Il.transition,Il.transition=null;var a=bt;bt=1;var l=Pl;Pl|=4,Al.current=null,function(e,t){if(tr=$t,fo(e=po())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var o=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(o&&0!==o.rangeCount){n=o.anchorNode;var r=o.anchorOffset,i=o.focusNode;o=o.focusOffset;try{n.nodeType,i.nodeType}catch(e){n=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(l=a+r),h!==i||0!==o&&3!==h.nodeType||(c=a+o),3===h.nodeType&&(a+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===r&&(l=a),p===i&&++d===o&&(c=a),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nr={focusedElem:e,selectionRange:n},$t=!1,Za=t;null!==Za;)if(e=(t=Za).child,1028&t.subtreeFlags&&null!==e)e.return=t,Za=e;else for(;null!==Za;){t=Za;try{var g=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,y=g.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:ys(t.type,m),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=t.stateNode.containerInfo;1===S.nodeType?S.textContent="":9===S.nodeType&&S.documentElement&&S.removeChild(S.documentElement);break;default:throw Error(s(163))}}catch(e){kc(t,t.return,e)}if(null!==(e=t.sibling)){e.return=t.return,Za=e;break}Za=t.return}g=nl,nl=!1}(e,n),yl(n,e),go(nr),$t=!!tr,nr=tr=null,e.current=n,bl(n,e,r),Ke(),Pl=l,bt=a,Il.transition=i}else e.current=n;if(Ql&&(Ql=!1,Jl=e,Kl=r),0===(i=e.pendingLanes)&&(zl=null),function(e){if(st&&"function"==typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(rt,e,void 0,!(128&~e.current.flags))}catch(e){}}(n.stateNode),rc(e,Ye()),null!==t)for(o=e.onRecoverableError,n=0;n<t.length;n++)o((r=t[n]).value,{componentStack:r.stack,digest:r.digest});if(Vl)throw Vl=!1,e=jl,jl=null,e;!!(1&Kl)&&0!==e.tag&&_c(),1&(i=e.pendingLanes)?e===Xl?Yl++:(Yl=0,Xl=e):Yl=0,qr()}(e,t,n,o)}finally{Il.transition=r,bt=o}return null}function _c(){if(null!==Jl){var e=St(Kl),t=Il.transition,n=bt;try{if(Il.transition=null,bt=16>e?16:e,null===Jl)var o=!1;else{if(e=Jl,Jl=null,Kl=0,6&Pl)throw Error(s(331));var r=Pl;for(Pl|=4,Za=e.current;null!==Za;){var i=Za,a=i.child;if(16&Za.flags){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Za=u;null!==Za;){var d=Za;switch(d.tag){case 0:case 11:case 15:ol(8,d,i)}var h=d.child;if(null!==h)h.return=d,Za=h;else for(;null!==Za;){var p=(d=Za).sibling,f=d.return;if(il(d),d===u){Za=null;break}if(null!==p){p.return=f,Za=p;break}Za=f}}}var g=i.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Za=i}}if(2064&i.subtreeFlags&&null!==a)a.return=i,Za=a;else e:for(;null!==Za;){if(2048&(i=Za).flags)switch(i.tag){case 0:case 11:case 15:ol(9,i,i.return)}var v=i.sibling;if(null!==v){v.return=i.return,Za=v;break e}Za=i.return}}var b=e.current;for(Za=b;null!==Za;){var S=(a=Za).child;if(2064&a.subtreeFlags&&null!==S)S.return=a,Za=S;else e:for(a=b;null!==Za;){if(2048&(l=Za).flags)try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(e){kc(l,l.return,e)}if(l===a){Za=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Za=w;break e}Za=l.return}}if(Pl=r,qr(),st&&"function"==typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(rt,e)}catch(e){}o=!0}return o}finally{bt=n,Il.transition=t}}return!1}function Cc(e,t,n){e=Ns(e,t=fa(0,t=ua(n,t),1),1),t=tc(),null!==e&&(yt(e,1,t),rc(e,t))}function kc(e,t,n){if(3===e.tag)Cc(e,e,n);else for(;null!==t;){if(3===t.tag){Cc(t,e,n);break}if(1===t.tag){var o=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof o.componentDidCatch&&(null===zl||!zl.has(o))){t=Ns(t,e=ga(t,e=ua(n,e),1),1),e=tc(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function Ec(e,t,n){var o=e.pingCache;null!==o&&o.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Ml===e&&(Rl&n)===n&&(4===Nl||3===Nl&&(130023424&Rl)===Rl&&500>Ye()-Hl?pc(e,0):Wl|=n),rc(e,t)}function Ac(e,t){0===t&&(1&e.mode?(t=ut,!(130023424&(ut<<=1))&&(ut=4194304)):t=1);var n=tc();null!==(e=Ms(e,t))&&(yt(e,t,n),rc(e,n))}function Ic(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ac(e,n)}function Pc(e,t){var n=0;switch(e.tag){case 13:var o=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(s(314))}null!==o&&o.delete(t),Ac(e,n)}function Mc(e,t){return ze(e,t)}function xc(e,t,n,o){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,o){return new xc(e,t,n,o)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Nc(e,t,n,o,r,i){var a=2;if(o=e,"function"==typeof e)Dc(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case _:return Lc(n.children,r,i,t);case C:a=8,r|=8;break;case k:return(e=Rc(12,n,t,2|r)).elementType=k,e.lanes=i,e;case P:return(e=Rc(13,n,t,r)).elementType=P,e.lanes=i,e;case M:return(e=Rc(19,n,t,r)).elementType=M,e.lanes=i,e;case D:return Fc(n,r,i,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case E:a=10;break e;case A:a=9;break e;case I:a=11;break e;case x:a=14;break e;case R:a=16,o=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Rc(a,n,t,r)).elementType=e,t.type=o,t.lanes=i,t}function Lc(e,t,n,o){return(e=Rc(7,e,o,t)).lanes=n,e}function Fc(e,t,n,o){return(e=Rc(22,e,o,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Bc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function Wc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,o,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=o,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Gc(e,t,n,o,r,s,i,a,l){return e=new Uc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Rc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:o,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rs(s),e}function Hc(e){if(!e)return Ir;e:{if(He(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Dr(n))return Lr(e,n,t)}return t}function qc(e,t,n,o,r,s,i,a,l){return(e=Gc(n,o,!0,e,0,s,0,a,l)).context=Hc(null),n=e.current,(s=Os(o=tc(),r=nc(n))).callback=null!=t?t:null,Ns(n,s,r),e.current.lanes=r,yt(e,r,o),rc(e,o),e}function $c(e,t,n,o){var r=t.current,s=tc(),i=nc(r);return n=Hc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Os(s,i)).payload={element:e},null!==(o=void 0===o?null:o)&&(t.callback=o),null!==(e=Ns(r,t,i))&&(oc(e,r,i,s),Ls(e,r,i)),i}function Vc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function jc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function zc(e,t){jc(e,t),(e=e.alternate)&&jc(e,t)}Cl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Mr.current)Sa=!0;else{if(!(e.lanes&n||128&t.flags))return Sa=!1,function(e,t,n){switch(t.tag){case 3:Ma(t),fs();break;case 5:ii(t);break;case 1:Dr(t.type)&&Fr(t);break;case 4:ri(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,r=t.memoizedProps.value;Ar(vs,o._currentValue),o._currentValue=r;break;case 13:if(null!==(o=t.memoizedState))return null!==o.dehydrated?(Ar(li,1&li.current),t.flags|=128,null):n&t.child.childLanes?Ba(e,t,n):(Ar(li,1&li.current),null!==(e=Va(e,t,n))?e.sibling:null);Ar(li,1&li.current);break;case 19:if(o=!!(n&t.childLanes),128&e.flags){if(o)return qa(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Ar(li,li.current),o)break;return null;case 22:case 23:return t.lanes=0,ka(e,t,n)}return Va(e,t,n)}(e,t,n);Sa=!!(131072&e.flags)}else Sa=!1,ss&&1048576&t.flags&&es(t,zr,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;$a(e,t),e=t.pendingProps;var r=Rr(t,Pr.current);ks(t,n),r=Ci(null,t,o,e,r,n);var i=ki();return t.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dr(o)?(i=!0,Fr(t)):i=!1,t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Rs(t),r.updater=Hs,t.stateNode=r,r._reactInternals=t,js(t,o,e,n),t=Pa(null,t,o,!0,i,n)):(t.tag=0,ss&&i&&ts(t),wa(null,t,r,n),t=t.child),t;case 16:o=t.elementType;e:{switch($a(e,t),e=t.pendingProps,o=(r=o._init)(o._payload),t.type=o,r=t.tag=function(e){if("function"==typeof e)return Dc(e)?1:0;if(null!=e){if((e=e.$$typeof)===I)return 11;if(e===x)return 14}return 2}(o),e=ys(o,e),r){case 0:t=Aa(null,t,o,e,n);break e;case 1:t=Ia(null,t,o,e,n);break e;case 11:t=Ta(null,t,o,e,n);break e;case 14:t=_a(null,t,o,ys(o.type,e),n);break e}throw Error(s(306,o,""))}return t;case 0:return o=t.type,r=t.pendingProps,Aa(e,t,o,r=t.elementType===o?r:ys(o,r),n);case 1:return o=t.type,r=t.pendingProps,Ia(e,t,o,r=t.elementType===o?r:ys(o,r),n);case 3:e:{if(Ma(t),null===e)throw Error(s(387));o=t.pendingProps,r=(i=t.memoizedState).element,Ds(e,t),Bs(t,o,null,n);var a=t.memoizedState;if(o=a.element,i.isDehydrated){if(i={element:o,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=xa(e,t,o,n,r=ua(Error(s(423)),t));break e}if(o!==r){t=xa(e,t,o,n,r=ua(Error(s(424)),t));break e}for(rs=ur(t.stateNode.containerInfo.firstChild),os=t,ss=!0,is=null,n=Xs(t,null,o,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),o===r){t=Va(e,t,n);break e}wa(e,t,o,n)}t=t.child}return t;case 5:return ii(t),null===e&&us(t),o=t.type,r=t.pendingProps,i=null!==e?e.memoizedProps:null,a=r.children,or(o,r)?a=null:null!==i&&or(o,i)&&(t.flags|=32),Ea(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&us(t),null;case 13:return Ba(e,t,n);case 4:return ri(t,t.stateNode.containerInfo),o=t.pendingProps,null===e?t.child=Ys(t,null,o,n):wa(e,t,o,n),t.child;case 11:return o=t.type,r=t.pendingProps,Ta(e,t,o,r=t.elementType===o?r:ys(o,r),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(o=t.type._context,r=t.pendingProps,i=t.memoizedProps,a=r.value,Ar(vs,o._currentValue),o._currentValue=a,null!==i)if(ao(i.value,a)){if(i.children===r.children&&!Mr.current){t=Va(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){a=i.child;for(var c=l.firstContext;null!==c;){if(c.context===o){if(1===i.tag){(c=Os(-1,n&-n)).tag=2;var u=i.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Cs(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)a=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(a=i.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Cs(a,n,t),a=i.sibling}else a=i.child;if(null!==a)a.return=i;else for(a=i;null!==a;){if(a===t){a=null;break}if(null!==(i=a.sibling)){i.return=a.return,a=i;break}a=a.return}i=a}wa(e,t,r.children,n),t=t.child}return t;case 9:return r=t.type,o=t.pendingProps.children,ks(t,n),o=o(r=Es(r)),t.flags|=1,wa(e,t,o,n),t.child;case 14:return r=ys(o=t.type,t.pendingProps),_a(e,t,o,r=ys(o.type,r),n);case 15:return Ca(e,t,t.type,t.pendingProps,n);case 17:return o=t.type,r=t.pendingProps,r=t.elementType===o?r:ys(o,r),$a(e,t),t.tag=1,Dr(o)?(e=!0,Fr(t)):e=!1,ks(t,n),$s(t,o,r),js(t,o,r,n),Pa(null,t,o,!0,e,n);case 19:return qa(e,t,n);case 22:return ka(e,t,n)}throw Error(s(156,t.tag))};var Qc="function"==typeof reportError?reportError:function(e){console.error(e)};function Jc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,o,r){var s=n._reactRootContainer;if(s){var i=s;if("function"==typeof r){var a=r;r=function(){var e=Vc(i);a.call(e)}}$c(t,i,e,r)}else i=function(e,t,n,o,r){if(r){if("function"==typeof o){var s=o;o=function(){var e=Vc(i);s.call(e)}}var i=qc(t,o,e,0,null,!1,0,"",Zc);return e._reactRootContainer=i,e[gr]=i.current,qo(8===e.nodeType?e.parentNode:e),dc(),i}for(;r=e.lastChild;)e.removeChild(r);if("function"==typeof o){var a=o;o=function(){var e=Vc(l);a.call(e)}}var l=Gc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[gr]=l.current,qo(8===e.nodeType?e.parentNode:e),dc((function(){$c(t,l,n,o)})),l}(n,t,e,r,o);return Vc(i)}Kc.prototype.render=Jc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));$c(e,t,null,null)},Kc.prototype.unmount=Jc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){$c(null,e,null,null)})),t[gr]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,Ye()),!(6&Pl)&&(ql=Ye()+500,qr()))}break;case 13:dc((function(){var t=Ms(e,1);if(null!==t){var n=tc();oc(t,e,1,n)}})),zc(e,1)}},Tt=function(e){if(13===e.tag){var t=Ms(e,134217728);null!==t&&oc(t,e,134217728,tc()),zc(e,134217728)}},_t=function(e){if(13===e.tag){var t=nc(e),n=Ms(e,t);null!==n&&oc(n,e,t,tc()),zc(e,t)}},Ct=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},Te=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var o=n[t];if(o!==e&&o.form===e.form){var r=Tr(o);if(!r)throw Error(s(90));z(o),X(o,r)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=uc,Pe=dc;var tu={usingClientEntryPoint:!1,Events:[Sr,wr,Tr,Ee,Ae,uc]},nu={findFiberByHostInstance:br,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ou={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{rt=ru.inject(ou),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(s(200));return function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:T,key:null==o?null:""+o,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(s(299));var n=!1,o="",r=Qc;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(o=t.identifierPrefix),void 0!==t.onRecoverableError&&(r=t.onRecoverableError)),t=Gc(e,1,!1,null,0,n,0,o,r),e[gr]=t.current,qo(8===e.nodeType?e.parentNode:e),new Jc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(s(405));var o=null!=n&&n.hydratedSources||null,r=!1,i="",a=Qc;if(null!=n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,r,0,i,a),e[gr]=t.current,qo(e),o)for(e=0;e<o.length;e++)r=(r=(n=o[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,r]:t.mutableSourceEagerHydrationData.push(n,r);return new Kc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[gr]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,o){if(!Xc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,o)},t.version="18.2.0-next-9e3b772b8-20220608"},64787:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(76277)},86969:(e,t,n)=>{"use strict";var o,r=(o=n(26166))&&"object"==typeof o&&"default"in o?o.default:o;function s(e){return s.warnAboutHMRDisabled&&(s.warnAboutHMRDisabled=!0,console.error("React-Hot-Loader: misconfiguration detected, using production version in non-production environment."),console.error("React-Hot-Loader: Hot Module Replacement is not enabled.")),r.Children.only(e.children)}s.warnAboutHMRDisabled=!1},41716:(e,t,n)=>{"use strict";n(86969)},65860:(e,t)=>{"use strict";var n,o=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.server_context"),d=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.offscreen");function y(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case s:case a:case i:case h:case p:return e;default:switch(e=e&&e.$$typeof){case u:case c:case d:case g:case f:case l:return e;default:return t}}case r:return t}}}n=Symbol.for("react.module.reference"),t.ContextConsumer=c,t.ContextProvider=l,t.Element=o,t.ForwardRef=d,t.Fragment=s,t.Lazy=g,t.Memo=f,t.Portal=r,t.Profiler=a,t.StrictMode=i,t.Suspense=h,t.SuspenseList=p,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return y(e)===c},t.isContextProvider=function(e){return y(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return y(e)===d},t.isFragment=function(e){return y(e)===s},t.isLazy=function(e){return y(e)===g},t.isMemo=function(e){return y(e)===f},t.isPortal=function(e){return y(e)===r},t.isProfiler=function(e){return y(e)===a},t.isStrictMode=function(e){return y(e)===i},t.isSuspense=function(e){return y(e)===h},t.isSuspenseList=function(e){return y(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===a||e===i||e===h||e===p||e===m||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===f||e.$$typeof===l||e.$$typeof===c||e.$$typeof===d||e.$$typeof===n||void 0!==e.getModuleId)},t.typeOf=y},91272:(e,t,n)=>{"use strict";e.exports=n(65860)},61030:(e,t,n)=>{"use strict";function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}n.r(t),n.d(t,{BrowserRouter:()=>J,HashRouter:()=>K,Link:()=>ne,MemoryRouter:()=>_,NavLink:()=>se,Prompt:()=>k,Redirect:()=>M,Route:()=>N,Router:()=>T,StaticRouter:()=>G,Switch:()=>H,generatePath:()=>P,matchPath:()=>O,useHistory:()=>V,useLocation:()=>j,useParams:()=>z,useRouteMatch:()=>Q,withRouter:()=>q});var s=n(26166),i=n(87468),a=n.n(i),l=n(27331),c=n(49481),u=n(26443),d=n(85085),h=n.n(d);function p(e,t){if(null==e)return{};var n={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;n[o]=e[o]}return n}n(91272);var f=n(78535),g=n.n(f),m=1073741823,y="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:{},v=s.createContext||function(e,t){var n,o,i,l="__create-react-context-"+((y[i="__global_unique_id__"]=(y[i]||0)+1)+"__"),c=function(e){function n(){for(var t,n,o,r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return(t=e.call.apply(e,[this].concat(s))||this).emitter=(n=t.props.value,o=[],{on:function(e){o.push(e)},off:function(e){o=o.filter((function(t){return t!==e}))},get:function(){return n},set:function(e,t){n=e,o.forEach((function(e){return e(n,t)}))}}),t}r(n,e);var o=n.prototype;return o.getChildContext=function(){var e;return(e={})[l]=this.emitter,e},o.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var n,o=this.props.value,r=e.value;((s=o)===(i=r)?0!==s||1/s==1/i:s!=s&&i!=i)?n=0:(n="function"==typeof t?t(o,r):m,0!=(n|=0)&&this.emitter.set(e.value,n))}var s,i},o.render=function(){return this.props.children},n}(s.Component);c.childContextTypes=((n={})[l]=a().object.isRequired,n);var u=function(t){function n(){for(var e,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))||this).observedBits=void 0,e.state={value:e.getValue()},e.onUpdate=function(t,n){e.observedBits&n&&e.setState({value:e.getValue()})},e}r(n,t);var o=n.prototype;return o.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=null==t?m:t},o.componentDidMount=function(){this.context[l]&&this.context[l].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=null==e?m:e},o.componentWillUnmount=function(){this.context[l]&&this.context[l].off(this.onUpdate)},o.getValue=function(){return this.context[l]?this.context[l].get():e},o.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},n}(s.Component);return u.contextTypes=((o={})[l]=a().object,o),{Provider:c,Consumer:u}},b=function(e){var t=v();return t.displayName=e,t},S=b("Router-History"),w=b("Router"),T=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={location:t.history.location},n._isMounted=!1,n._pendingLocation=null,t.staticContext||(n.unlisten=t.history.listen((function(e){n._pendingLocation=e}))),n}r(t,e),t.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var n=t.prototype;return n.componentDidMount=function(){var e=this;this._isMounted=!0,this.unlisten&&this.unlisten(),this.props.staticContext||(this.unlisten=this.props.history.listen((function(t){e._isMounted&&e.setState({location:t})}))),this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&(this.unlisten(),this._isMounted=!1,this._pendingLocation=null)},n.render=function(){return s.createElement(w.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},s.createElement(S.Provider,{children:this.props.children||null,value:this.props.history}))},t}(s.Component),_=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).history=(0,l.createMemoryHistory)(t.props),t}return r(t,e),t.prototype.render=function(){return s.createElement(T,{history:this.history,children:this.props.children})},t}(s.Component),C=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.onMount&&this.props.onMount.call(this,this)},n.componentDidUpdate=function(e){this.props.onUpdate&&this.props.onUpdate.call(this,this,e)},n.componentWillUnmount=function(){this.props.onUnmount&&this.props.onUnmount.call(this,this)},n.render=function(){return null},t}(s.Component);function k(e){var t=e.message,n=e.when,o=void 0===n||n;return s.createElement(w.Consumer,null,(function(e){if(e||(0,c.A)(!1),!o||e.staticContext)return null;var n=e.history.block;return s.createElement(C,{onMount:function(e){e.release=n(t)},onUpdate:function(e,o){o.message!==t&&(e.release(),e.release=n(t))},onUnmount:function(e){e.release()},message:t})}))}var E={},A=1e4,I=0;function P(e,t){return void 0===e&&(e="/"),void 0===t&&(t={}),"/"===e?e:function(e){if(E[e])return E[e];var t=h().compile(e);return I<A&&(E[e]=t,I++),t}(e)(t,{pretty:!0})}function M(e){var t=e.computedMatch,n=e.to,o=e.push,r=void 0!==o&&o;return s.createElement(w.Consumer,null,(function(e){e||(0,c.A)(!1);var o=e.history,i=e.staticContext,a=r?o.push:o.replace,d=(0,l.createLocation)(t?"string"==typeof n?P(n,t.params):(0,u.A)({},n,{pathname:P(n.pathname,t.params)}):n);return i?(a(d),null):s.createElement(C,{onMount:function(){a(d)},onUpdate:function(e,t){var n=(0,l.createLocation)(t.to);(0,l.locationsAreEqual)(n,(0,u.A)({},d,{key:n.key}))||a(d)},to:n})}))}var x={},R=1e4,D=0;function O(e,t){void 0===t&&(t={}),("string"==typeof t||Array.isArray(t))&&(t={path:t});var n=t,o=n.path,r=n.exact,s=void 0!==r&&r,i=n.strict,a=void 0!==i&&i,l=n.sensitive,c=void 0!==l&&l;return[].concat(o).reduce((function(t,n){if(!n&&""!==n)return null;if(t)return t;var o=function(e,t){var n=""+t.end+t.strict+t.sensitive,o=x[n]||(x[n]={});if(o[e])return o[e];var r=[],s={regexp:h()(e,r,t),keys:r};return D<R&&(o[e]=s,D++),s}(n,{end:s,strict:a,sensitive:c}),r=o.regexp,i=o.keys,l=r.exec(e);if(!l)return null;var u=l[0],d=l.slice(1),p=e===u;return s&&!p?null:{path:n,url:"/"===n&&""===u?"/":u,isExact:p,params:i.reduce((function(e,t,n){return e[t.name]=d[n],e}),{})}}),null)}var N=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=this;return s.createElement(w.Consumer,null,(function(t){t||(0,c.A)(!1);var n=e.props.location||t.location,o=e.props.computedMatch?e.props.computedMatch:e.props.path?O(n.pathname,e.props):t.match,r=(0,u.A)({},t,{location:n,match:o}),i=e.props,a=i.children,l=i.component,d=i.render;return Array.isArray(a)&&function(e){return 0===s.Children.count(e)}(a)&&(a=null),s.createElement(w.Provider,{value:r},r.match?a?"function"==typeof a?a(r):a:l?s.createElement(l,r):d?d(r):null:"function"==typeof a?a(r):null)}))},t}(s.Component);function L(e){return"/"===e.charAt(0)?e:"/"+e}function F(e,t){if(!e)return t;var n=L(e);return 0!==t.pathname.indexOf(n)?t:(0,u.A)({},t,{pathname:t.pathname.substr(n.length)})}function B(e){return"string"==typeof e?e:(0,l.createPath)(e)}function W(e){return function(){(0,c.A)(!1)}}function U(){}var G=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).handlePush=function(e){return t.navigateTo(e,"PUSH")},t.handleReplace=function(e){return t.navigateTo(e,"REPLACE")},t.handleListen=function(){return U},t.handleBlock=function(){return U},t}r(t,e);var n=t.prototype;return n.navigateTo=function(e,t){var n=this.props,o=n.basename,r=void 0===o?"":o,s=n.context,i=void 0===s?{}:s;i.action=t,i.location=function(e,t){return e?(0,u.A)({},t,{pathname:L(e)+t.pathname}):t}(r,(0,l.createLocation)(e)),i.url=B(i.location)},n.render=function(){var e=this.props,t=e.basename,n=void 0===t?"":t,o=e.context,r=void 0===o?{}:o,i=e.location,a=void 0===i?"/":i,c=p(e,["basename","context","location"]),d={createHref:function(e){return L(n+B(e))},action:"POP",location:F(n,(0,l.createLocation)(a)),push:this.handlePush,replace:this.handleReplace,go:W(),goBack:W(),goForward:W(),listen:this.handleListen,block:this.handleBlock};return s.createElement(T,(0,u.A)({},c,{history:d,staticContext:r}))},t}(s.Component),H=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.render=function(){var e=this;return s.createElement(w.Consumer,null,(function(t){t||(0,c.A)(!1);var n,o,r=e.props.location||t.location;return s.Children.forEach(e.props.children,(function(e){if(null==o&&s.isValidElement(e)){n=e;var i=e.props.path||e.props.from;o=i?O(r.pathname,(0,u.A)({},e.props,{path:i})):t.match}})),o?s.cloneElement(n,{location:r,computedMatch:o}):null}))},t}(s.Component);function q(e){var t="withRouter("+(e.displayName||e.name)+")",n=function(t){var n=t.wrappedComponentRef,o=p(t,["wrappedComponentRef"]);return s.createElement(w.Consumer,null,(function(t){return t||(0,c.A)(!1),s.createElement(e,(0,u.A)({},o,t,{ref:n}))}))};return n.displayName=t,n.WrappedComponent=e,g()(n,e)}var $=s.useContext;function V(){return $(S)}function j(){return $(w).location}function z(){var e=$(w).match;return e?e.params:{}}function Q(e){var t=j(),n=$(w).match;return e?O(t.pathname,e):n}var J=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).history=(0,l.createBrowserHistory)(t.props),t}return r(t,e),t.prototype.render=function(){return s.createElement(T,{history:this.history,children:this.props.children})},t}(s.Component),K=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).history=(0,l.createHashHistory)(t.props),t}return r(t,e),t.prototype.render=function(){return s.createElement(T,{history:this.history,children:this.props.children})},t}(s.Component),Y=function(e,t){return"function"==typeof e?e(t):e},X=function(e,t){return"string"==typeof e?(0,l.createLocation)(e,null,null,t):e},Z=function(e){return e},ee=s.forwardRef;void 0===ee&&(ee=Z);var te=ee((function(e,t){var n=e.innerRef,o=e.navigate,r=e.onClick,i=p(e,["innerRef","navigate","onClick"]),a=i.target,l=(0,u.A)({},i,{onClick:function(e){try{r&&r(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||a&&"_self"!==a||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),o())}});return l.ref=Z!==ee&&t||n,s.createElement("a",l)})),ne=ee((function(e,t){var n=e.component,o=void 0===n?te:n,r=e.replace,i=e.to,a=e.innerRef,d=p(e,["component","replace","to","innerRef"]);return s.createElement(w.Consumer,null,(function(e){e||(0,c.A)(!1);var n=e.history,h=X(Y(i,e.location),e.location),p=h?n.createHref(h):"",f=(0,u.A)({},d,{href:p,navigate:function(){var t=Y(i,e.location),o=(0,l.createPath)(e.location)===(0,l.createPath)(X(t));(r||o?n.replace:n.push)(t)}});return Z!==ee?f.ref=t||a:f.innerRef=a,s.createElement(o,f)}))})),oe=function(e){return e},re=s.forwardRef;void 0===re&&(re=oe);var se=re((function(e,t){var n=e["aria-current"],o=void 0===n?"page":n,r=e.activeClassName,i=void 0===r?"active":r,a=e.activeStyle,l=e.className,d=e.exact,h=e.isActive,f=e.location,g=e.sensitive,m=e.strict,y=e.style,v=e.to,b=e.innerRef,S=p(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return s.createElement(w.Consumer,null,(function(e){e||(0,c.A)(!1);var n=f||e.location,r=X(Y(v,n),n),p=r.pathname,w=p&&p.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),T=w?O(n.pathname,{path:w,exact:d,sensitive:g,strict:m}):null,_=!!(h?h(T,n):T),C="function"==typeof l?l(_):l,k="function"==typeof y?y(_):y;_&&(C=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(C,i),k=(0,u.A)({},k,a));var E=(0,u.A)({"aria-current":_&&o||null,className:C,style:k,to:r},S);return oe!==re?E.ref=t||b:E.innerRef=b,s.createElement(ne,E)}))}))},43705:(e,t)=>{"use strict";var n=Symbol.for("react.element"),o=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var S=b.prototype=new v;S.constructor=b,g(S,y.prototype),S.isPureReactComponent=!0;var w=Array.isArray,T=Object.prototype.hasOwnProperty,_={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,o){var r,s={},i=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(i=""+t.key),t)T.call(t,r)&&!C.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(1===l)s.children=o;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===s[r]&&(s[r]=l[r]);return{$$typeof:n,type:e,key:i,ref:a,props:s,_owner:_.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(e,t,r,s,i){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case o:l=!0}}if(l)return i=i(l=e),e=""===s?"."+I(l,0):s,w(i)?(r="",null!=e&&(r=e.replace(A,"$&/")+"/"),P(i,t,r,"",(function(e){return e}))):null!=i&&(E(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,r+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(A,"$&/")+"/")+e)),t.push(i)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var u=s+I(a=e[c],c);l+=P(a,t,r,u,i)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=P(a=a.value,t,r,u=s+I(a,c++),i);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function M(e,t,n){if(null==e)return e;var o=[],r=0;return P(e,o,"","",(function(e){return t.call(n,e,r++)})),o}function x(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},D={transition:null},O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:D,ReactCurrentOwner:_};t.Children={map:M,forEach:function(e,t,n){M(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return M(e,(function(){t++})),t},toArray:function(e){return M(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=r,t.Profiler=i,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,o){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=g({},e.props),s=e.key,i=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,a=_.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)T.call(t,c)&&!C.hasOwnProperty(c)&&(r[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)r.children=o;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:n,type:e.type,key:s,ref:i,props:r,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:x}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.2.0"},26166:(e,t,n)=>{"use strict";e.exports=n(43705)},84577:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var o=n-1>>>1,r=e[o];if(!(0<s(r,t)))break e;e[o]=t,e[n]=r,n=o}}function o(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var o=0,r=e.length,i=r>>>1;o<i;){var a=2*(o+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<r&&0>s(u,l)?(e[o]=u,e[c]=n,o=c):(e[o]=l,e[a]=n,o=a);else{if(!(c<r&&0>s(u,n)))break e;e[o]=u,e[c]=n,o=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,p=3,f=!1,g=!1,m=!1,y="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function S(e){for(var t=o(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(c,t)}t=o(u)}}function w(e){if(m=!1,S(e),!g)if(null!==o(c))g=!0,D(T);else{var t=o(u);null!==t&&O(w,t.startTime-e)}}function T(e,n){g=!1,m&&(m=!1,v(E),E=-1),f=!0;var s=p;try{for(S(n),h=o(c);null!==h&&(!(h.expirationTime>n)||e&&!P());){var i=h.callback;if("function"==typeof i){h.callback=null,p=h.priorityLevel;var a=i(h.expirationTime<=n);n=t.unstable_now(),"function"==typeof a?h.callback=a:h===o(c)&&r(c),S(n)}else r(c);h=o(c)}if(null!==h)var l=!0;else{var d=o(u);null!==d&&O(w,d.startTime-n),l=!1}return l}finally{h=null,p=s,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,C=!1,k=null,E=-1,A=5,I=-1;function P(){return!(t.unstable_now()-I<A)}function M(){if(null!==k){var e=t.unstable_now();I=e;var n=!0;try{n=k(!0,e)}finally{n?_():(C=!1,k=null)}}else C=!1}if("function"==typeof b)_=function(){b(M)};else if("undefined"!=typeof MessageChannel){var x=new MessageChannel,R=x.port2;x.port1.onmessage=M,_=function(){R.postMessage(null)}}else _=function(){y(M,0)};function D(e){k=e,C||(C=!0,_())}function O(e,n){E=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,D(T))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return o(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,s){var i=t.unstable_now();switch(s="object"==typeof s&&null!==s&&"number"==typeof(s=s.delay)&&0<s?i+s:i,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>i?(e.sortIndex=s,n(u,e),null===o(c)&&e===o(u)&&(m?(v(E),E=-1):m=!0,O(w,s-i))):(e.sortIndex=a,n(c,e),g||f||(g=!0,D(T))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},82300:(e,t,n)=>{"use strict";e.exports=n(84577)},98670:(e,t,n)=>{"use strict";n.d(t,{C6:()=>r,Cg:()=>a,Cl:()=>s,Tt:()=>i,aN:()=>l});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},o(e,t)};function r(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s.apply(this,arguments)};function i(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function a(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i}function l(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var s=arguments[t],i=0,a=s.length;i<a;i++,r++)o[r]=s[i];return o}},7547:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return l.default}});var o=h(n(38066)),r=h(n(61832)),s=h(n(58397)),i=h(n(8830)),a=h(n(52892)),l=h(n(44179)),c=h(n(74353)),u=h(n(79418)),d=h(n(88132));function h(e){return e&&e.__esModule?e:{default:e}}},35155:(e,t)=>{"use strict";function n(e){return 14+(e+64>>>9<<4)+1}function o(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function r(e,t,n,r,s,i){return o((a=o(o(t,e),o(r,i)))<<(l=s)|a>>>32-l,n);var a,l}function s(e,t,n,o,s,i,a){return r(t&n|~t&o,e,t,s,i,a)}function i(e,t,n,o,s,i,a){return r(t&o|n&~o,e,t,s,i,a)}function a(e,t,n,o,s,i,a){return r(t^n^o,e,t,s,i,a)}function l(e,t,n,o,s,i,a){return r(n^(t|~o),e,t,s,i,a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){const t=[],n=32*e.length,o="0123456789abcdef";for(let r=0;r<n;r+=8){const n=e[r>>5]>>>r%32&255,s=parseInt(o.charAt(n>>>4&15)+o.charAt(15&n),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[n(t)-1]=t;let r=1732584193,c=-271733879,u=-1732584194,d=271733878;for(let t=0;t<e.length;t+=16){const n=r,h=c,p=u,f=d;r=s(r,c,u,d,e[t],7,-680876936),d=s(d,r,c,u,e[t+1],12,-389564586),u=s(u,d,r,c,e[t+2],17,606105819),c=s(c,u,d,r,e[t+3],22,-1044525330),r=s(r,c,u,d,e[t+4],7,-176418897),d=s(d,r,c,u,e[t+5],12,1200080426),u=s(u,d,r,c,e[t+6],17,-1473231341),c=s(c,u,d,r,e[t+7],22,-45705983),r=s(r,c,u,d,e[t+8],7,1770035416),d=s(d,r,c,u,e[t+9],12,-1958414417),u=s(u,d,r,c,e[t+10],17,-42063),c=s(c,u,d,r,e[t+11],22,-1990404162),r=s(r,c,u,d,e[t+12],7,1804603682),d=s(d,r,c,u,e[t+13],12,-40341101),u=s(u,d,r,c,e[t+14],17,-1502002290),c=s(c,u,d,r,e[t+15],22,1236535329),r=i(r,c,u,d,e[t+1],5,-165796510),d=i(d,r,c,u,e[t+6],9,-1069501632),u=i(u,d,r,c,e[t+11],14,643717713),c=i(c,u,d,r,e[t],20,-373897302),r=i(r,c,u,d,e[t+5],5,-701558691),d=i(d,r,c,u,e[t+10],9,38016083),u=i(u,d,r,c,e[t+15],14,-660478335),c=i(c,u,d,r,e[t+4],20,-405537848),r=i(r,c,u,d,e[t+9],5,568446438),d=i(d,r,c,u,e[t+14],9,-1019803690),u=i(u,d,r,c,e[t+3],14,-187363961),c=i(c,u,d,r,e[t+8],20,1163531501),r=i(r,c,u,d,e[t+13],5,-1444681467),d=i(d,r,c,u,e[t+2],9,-51403784),u=i(u,d,r,c,e[t+7],14,1735328473),c=i(c,u,d,r,e[t+12],20,-1926607734),r=a(r,c,u,d,e[t+5],4,-378558),d=a(d,r,c,u,e[t+8],11,-2022574463),u=a(u,d,r,c,e[t+11],16,1839030562),c=a(c,u,d,r,e[t+14],23,-35309556),r=a(r,c,u,d,e[t+1],4,-1530992060),d=a(d,r,c,u,e[t+4],11,1272893353),u=a(u,d,r,c,e[t+7],16,-155497632),c=a(c,u,d,r,e[t+10],23,-1094730640),r=a(r,c,u,d,e[t+13],4,681279174),d=a(d,r,c,u,e[t],11,-358537222),u=a(u,d,r,c,e[t+3],16,-722521979),c=a(c,u,d,r,e[t+6],23,76029189),r=a(r,c,u,d,e[t+9],4,-640364487),d=a(d,r,c,u,e[t+12],11,-421815835),u=a(u,d,r,c,e[t+15],16,530742520),c=a(c,u,d,r,e[t+2],23,-995338651),r=l(r,c,u,d,e[t],6,-198630844),d=l(d,r,c,u,e[t+7],10,1126891415),u=l(u,d,r,c,e[t+14],15,-1416354905),c=l(c,u,d,r,e[t+5],21,-57434055),r=l(r,c,u,d,e[t+12],6,1700485571),d=l(d,r,c,u,e[t+3],10,-1894986606),u=l(u,d,r,c,e[t+10],15,-1051523),c=l(c,u,d,r,e[t+1],21,-2054922799),r=l(r,c,u,d,e[t+8],6,1873313359),d=l(d,r,c,u,e[t+15],10,-30611744),u=l(u,d,r,c,e[t+6],15,-1560198380),c=l(c,u,d,r,e[t+13],21,1309151649),r=l(r,c,u,d,e[t+4],6,-145523070),d=l(d,r,c,u,e[t+11],10,-1120210379),u=l(u,d,r,c,e[t+2],15,718787259),c=l(c,u,d,r,e[t+9],21,-343485551),r=o(r,n),c=o(c,h),u=o(u,p),d=o(d,f)}return[r,c,u,d]}(function(e){if(0===e.length)return[];const t=8*e.length,o=new Uint32Array(n(t));for(let n=0;n<t;n+=8)o[n>>5]|=(255&e[n/8])<<n%32;return o}(e),8*e.length))}},99688:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};t.default=n},52892:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default="00000000-0000-0000-0000-000000000000"},88132:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(74353))&&o.__esModule?o:{default:o};t.default=function(e){if(!(0,r.default)(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}},48180:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},47454:(e,t)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)};const o=new Uint8Array(16)},73118:(e,t)=>{"use strict";function n(e,t,n,o){switch(e){case 0:return t&n^~t&o;case 1:case 3:return t^n^o;case 2:return t&n^t&o^n&o}}function o(e,t){return e<<t|e>>>32-t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default=function(e){const t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const s=e.length/4+2,i=Math.ceil(s/16),a=new Array(i);for(let t=0;t<i;++t){const n=new Uint32Array(16);for(let o=0;o<16;++o)n[o]=e[64*t+4*o]<<24|e[64*t+4*o+1]<<16|e[64*t+4*o+2]<<8|e[64*t+4*o+3];a[t]=n}a[i-1][14]=8*(e.length-1)/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<i;++e){const s=new Uint32Array(80);for(let t=0;t<16;++t)s[t]=a[e][t];for(let e=16;e<80;++e)s[e]=o(s[e-3]^s[e-8]^s[e-14]^s[e-16],1);let i=r[0],l=r[1],c=r[2],u=r[3],d=r[4];for(let e=0;e<80;++e){const r=Math.floor(e/20),a=o(i,5)+n(r,l,c,u)+d+t[r]+s[e]>>>0;d=u,u=c,c=o(l,30)>>>0,l=i,i=a}r[0]=r[0]+i>>>0,r[1]=r[1]+l>>>0,r[2]=r[2]+c>>>0,r[3]=r[3]+u>>>0,r[4]=r[4]+d>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}},79418:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.unsafeStringify=i;var o,r=(o=n(74353))&&o.__esModule?o:{default:o};const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));function i(e,t=0){return(s[e[t+0]]+s[e[t+1]]+s[e[t+2]]+s[e[t+3]]+"-"+s[e[t+4]]+s[e[t+5]]+"-"+s[e[t+6]]+s[e[t+7]]+"-"+s[e[t+8]]+s[e[t+9]]+"-"+s[e[t+10]]+s[e[t+11]]+s[e[t+12]]+s[e[t+13]]+s[e[t+14]]+s[e[t+15]]).toLowerCase()}t.default=function(e,t=0){const n=i(e,t);if(!(0,r.default)(n))throw TypeError("Stringified UUID is invalid");return n}},38066:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(47454))&&o.__esModule?o:{default:o},s=n(79418);let i,a,l=0,c=0;t.default=function(e,t,n){let o=t&&n||0;const u=t||new Array(16);let d=(e=e||{}).node||i,h=void 0!==e.clockseq?e.clockseq:a;if(null==d||null==h){const t=e.random||(e.rng||r.default)();null==d&&(d=i=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==h&&(h=a=16383&(t[6]<<8|t[7]))}let p=void 0!==e.msecs?e.msecs:Date.now(),f=void 0!==e.nsecs?e.nsecs:c+1;const g=p-l+(f-c)/1e4;if(g<0&&void 0===e.clockseq&&(h=h+1&16383),(g<0||p>l)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=p,c=f,a=h,p+=122192928e5;const m=(1e4*(268435455&p)+f)%4294967296;u[o++]=m>>>24&255,u[o++]=m>>>16&255,u[o++]=m>>>8&255,u[o++]=255&m;const y=p/4294967296*1e4&268435455;u[o++]=y>>>8&255,u[o++]=255&y,u[o++]=y>>>24&15|16,u[o++]=y>>>16&255,u[o++]=h>>>8|128,u[o++]=255&h;for(let e=0;e<6;++e)u[o+e]=d[e];return t||(0,s.unsafeStringify)(u)}},61832:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n(341)),r=s(n(35155));function s(e){return e&&e.__esModule?e:{default:e}}var i=(0,o.default)("v3",48,r.default);t.default=i},341:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.DNS=void 0,t.default=function(e,t,n){function o(e,o,i,a){var l;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof o&&(o=(0,s.default)(o)),16!==(null===(l=o)||void 0===l?void 0:l.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+e.length);if(c.set(o),c.set(e,o.length),c=n(c),c[6]=15&c[6]|t,c[8]=63&c[8]|128,i){a=a||0;for(let e=0;e<16;++e)i[a+e]=c[e];return i}return(0,r.unsafeStringify)(c)}try{o.name=e}catch(e){}return o.DNS=i,o.URL=a,o};var o,r=n(79418),s=(o=n(88132))&&o.__esModule?o:{default:o};const i="6ba7b810-9dad-11d1-80b4-00c04fd430c8";t.DNS=i;const a="6ba7b811-9dad-11d1-80b4-00c04fd430c8";t.URL=a},58397:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(99688)),r=i(n(47454)),s=n(79418);function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,n){if(o.default.randomUUID&&!t&&!e)return o.default.randomUUID();const i=(e=e||{}).random||(e.rng||r.default)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return(0,s.unsafeStringify)(i)}},8830:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n(341)),r=s(n(73118));function s(e){return e&&e.__esModule?e:{default:e}}var i=(0,o.default)("v5",80,r.default);t.default=i},74353:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(48180))&&o.__esModule?o:{default:o};t.default=function(e){return"string"==typeof e&&r.default.test(e)}},44179:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r=(o=n(74353))&&o.__esModule?o:{default:o};t.default=function(e){if(!(0,r.default)(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)}},76442:function(){!function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,o="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),r="FormData"in e,s="ArrayBuffer"in e;if(s)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},l=ArrayBuffer.isView||function(e){return e&&i.indexOf(Object.prototype.toString.call(e))>-1};f.prototype.append=function(e,t){e=d(e),t=h(t);var n=this.map[e];this.map[e]=n?n+","+t:t},f.prototype.delete=function(e){delete this.map[d(e)]},f.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},f.prototype.set=function(e,t){this.map[d(e)]=h(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),p(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),p(e)},n&&(f.prototype[Symbol.iterator]=f.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];S.prototype.clone=function(){return new S(this,{body:this._bodyInit})},b.call(S.prototype),b.call(T.prototype),T.prototype.clone=function(){return new T(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},T.error=function(){var e=new T(null,{status:0,statusText:""});return e.type="error",e};var u=[301,302,303,307,308];T.redirect=function(e,t){if(-1===u.indexOf(t))throw new RangeError("Invalid status code");return new T(null,{status:t,headers:{location:e}})},e.Headers=f,e.Request=S,e.Response=T,e.fetch=function(e,t){return new Promise((function(n,r){var s=new S(e,t),i=new XMLHttpRequest;i.onload=function(){var e,t,o={status:i.status,statusText:i.statusText,headers:(e=i.getAllResponseHeaders()||"",t=new f,e.split(/\r?\n/).forEach((function(e){var n=e.split(":"),o=n.shift().trim();if(o){var r=n.join(":").trim();t.append(o,r)}})),t)};o.url="responseURL"in i?i.responseURL:o.headers.get("X-Request-URL");var r="response"in i?i.response:i.responseText;n(new T(r,o))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.open(s.method,s.url,!0),"include"===s.credentials&&(i.withCredentials=!0),"responseType"in i&&o&&(i.responseType="blob"),s.headers.forEach((function(e,t){i.setRequestHeader(t,e)})),i.send(void 0===s._bodyInit?null:s._bodyInit)}))},e.fetch.polyfill=!0}function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function h(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function g(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function y(e){var t=new FileReader,n=m(t);return t.readAsArrayBuffer(e),n}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(o&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(r&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&o&&a(e))this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!l(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e,t,n,o=g(this);if(o)return o;if(this._bodyBlob)return e=this._bodyBlob,n=m(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),o=0;o<t.length;o++)n[o]=String.fromCharCode(t[o]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}function S(e,t){var n,o,r=(t=t||{}).body;if(e instanceof S){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(o=(n=t.method||this.method||"GET").toUpperCase(),c.indexOf(o)>-1?o:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),o=n.shift().replace(/\+/g," "),r=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(r))}})),t}function T(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},26443:(e,t,n)=>{"use strict";function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},o.apply(null,arguments)}n.d(t,{A:()=>o})},49481:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var o=!0,r="Invariant failed";function s(e,t){if(!e){if(o)throw new Error(r);var n="function"==typeof t?t():t,s=n?"".concat(r,": ").concat(n):r;throw new Error(s)}}},67524:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>O,__assign:()=>s,__asyncDelegator:()=>k,__asyncGenerator:()=>C,__asyncValues:()=>E,__await:()=>_,__awaiter:()=>f,__classPrivateFieldGet:()=>x,__classPrivateFieldIn:()=>D,__classPrivateFieldSet:()=>R,__createBinding:()=>m,__decorate:()=>a,__disposeResources:()=>L,__esDecorate:()=>c,__exportStar:()=>y,__extends:()=>r,__generator:()=>g,__importDefault:()=>M,__importStar:()=>P,__makeTemplateObject:()=>A,__metadata:()=>p,__param:()=>l,__propKey:()=>d,__read:()=>b,__rest:()=>i,__runInitializers:()=>u,__setFunctionName:()=>h,__spread:()=>S,__spreadArray:()=>T,__spreadArrays:()=>w,__values:()=>v,default:()=>F});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s.apply(this,arguments)};function i(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function a(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i}function l(e,t){return function(n,o){t(n,o,e)}}function c(e,t,n,o,r,s){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,l=o.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?o.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,o.name):{}),h=!1,p=n.length-1;p>=0;p--){var f={};for(var g in o)f[g]="access"===g?{}:o[g];for(var g in o.access)f.access[g]=o.access[g];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(i(e||null))};var m=(0,n[p])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=i(m.get))&&(d.get=a),(a=i(m.set))&&(d.set=a),(a=i(m.init))&&r.unshift(a)}else(a=i(m))&&("field"===l?r.unshift(a):d[c]=a)}u&&Object.defineProperty(u,o.name,d),h=!0}function u(e,t,n){for(var o=arguments.length>2,r=0;r<t.length;r++)n=o?t[r].call(e,n):t[r].call(e);return o?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))}function g(e,t){var n,o,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}var m=Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,s=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=s.next()).done;)i.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function w(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var s=arguments[t],i=0,a=s.length;i<a;i++,r++)o[r]=s[i];return o}function T(e,t,n){if(n||2===arguments.length)for(var o,r=0,s=t.length;r<s;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function C(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),s=[];return o=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),i("next"),i("throw"),i("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),o[Symbol.asyncIterator]=function(){return this},o;function i(e,t){r[e]&&(o[e]=function(t){return new Promise((function(n,o){s.push([e,t,n,o])>1||a(e,t)}))},t&&(o[e]=t(o[e])))}function a(e,t){try{(n=r[e](t)).value instanceof _?Promise.resolve(n.value.v).then(l,c):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function k(e){var t,n;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,r){t[o]=e[o]?function(t){return(n=!n)?{value:_(e[o](t)),done:!1}:r?r(t):t}:r}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=v(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var I=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&m(t,e,n);return I(t,e),t}function M(e){return e&&e.__esModule?e:{default:e}}function x(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)}function R(e,t,n,o,r){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?r.call(e,n):r?r.value=n:t.set(e,n),n}function D(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function O(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose],n&&(r=o)}if("function"!=typeof o)throw new TypeError("Object not disposable.");r&&(o=function(){try{r.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:o,async:n})}else n&&e.stack.push({async:!0});return t}var N="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var o=new Error(n);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function L(e){function t(t){e.error=e.hasError?new N(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var n,o=0;return function r(){for(;n=e.stack.pop();)try{if(!n.async&&1===o)return o=0,e.stack.push(n),Promise.resolve().then(r);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return o|=2,Promise.resolve(s).then(r,(function(e){return t(e),r()}))}else o|=1}catch(e){t(e)}if(1===o)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}const F={__extends:r,__assign:s,__rest:i,__decorate:a,__param:l,__metadata:p,__awaiter:f,__generator:g,__createBinding:m,__exportStar:y,__values:v,__read:b,__spread:S,__spreadArrays:w,__spreadArray:T,__await:_,__asyncGenerator:C,__asyncDelegator:k,__asyncValues:E,__makeTemplateObject:A,__importStar:P,__importDefault:M,__classPrivateFieldGet:x,__classPrivateFieldSet:R,__classPrivateFieldIn:D,__addDisposableResource:O,__disposeResources:L}},5866:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>N,__assign:()=>s,__asyncDelegator:()=>k,__asyncGenerator:()=>C,__asyncValues:()=>E,__await:()=>_,__awaiter:()=>f,__classPrivateFieldGet:()=>R,__classPrivateFieldIn:()=>O,__classPrivateFieldSet:()=>D,__createBinding:()=>m,__decorate:()=>a,__disposeResources:()=>F,__esDecorate:()=>c,__exportStar:()=>y,__extends:()=>r,__generator:()=>g,__importDefault:()=>x,__importStar:()=>M,__makeTemplateObject:()=>A,__metadata:()=>p,__param:()=>l,__propKey:()=>d,__read:()=>b,__rest:()=>i,__rewriteRelativeImportExtension:()=>B,__runInitializers:()=>u,__setFunctionName:()=>h,__spread:()=>S,__spreadArray:()=>T,__spreadArrays:()=>w,__values:()=>v,default:()=>W});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)};function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var s=function(){return s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s.apply(this,arguments)};function i(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}function a(e,t,n,o){var r,s=arguments.length,i=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,n,i):r(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i}function l(e,t){return function(n,o){t(n,o,e)}}function c(e,t,n,o,r,s){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,l=o.kind,c="getter"===l?"get":"setter"===l?"set":"value",u=!t&&e?o.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,o.name):{}),h=!1,p=n.length-1;p>=0;p--){var f={};for(var g in o)f[g]="access"===g?{}:o[g];for(var g in o.access)f.access[g]=o.access[g];f.addInitializer=function(e){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(i(e||null))};var m=(0,n[p])("accessor"===l?{get:d.get,set:d.set}:d[c],f);if("accessor"===l){if(void 0===m)continue;if(null===m||"object"!=typeof m)throw new TypeError("Object expected");(a=i(m.get))&&(d.get=a),(a=i(m.set))&&(d.set=a),(a=i(m.init))&&r.unshift(a)}else(a=i(m))&&("field"===l?r.unshift(a):d[c]=a)}u&&Object.defineProperty(u,o.name,d),h=!0}function u(e,t,n){for(var o=arguments.length>2,r=0;r<t.length;r++)n=o?t[r].call(e,n):t[r].call(e);return o?n:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,n,o){return new(n||(n=Promise))((function(r,s){function i(e){try{l(o.next(e))}catch(e){s(e)}}function a(e){try{l(o.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}l((o=o.apply(e,t||[])).next())}))}function g(e,t){var n,o,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=a(0),i.throw=a(1),i.return=a(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,o=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}var m=Object.create?function(e,t,n,o){void 0===o&&(o=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,o,r)}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]};function y(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||m(t,e,n)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,r,s=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(o=s.next()).done;)i.push(o.value)}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return i}function S(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function w(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var s=arguments[t],i=0,a=s.length;i<a;i++,r++)o[r]=s[i];return o}function T(e,t,n){if(n||2===arguments.length)for(var o,r=0,s=t.length;r<s;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}function _(e){return this instanceof _?(this.v=e,this):new _(e)}function C(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=n.apply(e,t||[]),s=[];return o=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),i("next"),i("throw"),i("return",(function(e){return function(t){return Promise.resolve(t).then(e,c)}})),o[Symbol.asyncIterator]=function(){return this},o;function i(e,t){r[e]&&(o[e]=function(t){return new Promise((function(n,o){s.push([e,t,n,o])>1||a(e,t)}))},t&&(o[e]=t(o[e])))}function a(e,t){try{(n=r[e](t)).value instanceof _?Promise.resolve(n.value.v).then(l,c):u(s[0][2],n)}catch(e){u(s[0][3],e)}var n}function l(e){a("next",e)}function c(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function k(e){var t,n;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,r){t[o]=e[o]?function(t){return(n=!n)?{value:_(e[o](t)),done:!1}:r?r(t):t}:r}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=v(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,r){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,r,(t=e[n](t)).done,t.value)}))}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var I=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},P=function(e){return P=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},P(e)};function M(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=P(e),o=0;o<n.length;o++)"default"!==n[o]&&m(t,e,n[o]);return I(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function R(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)}function D(e,t,n,o,r){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?r.call(e,n):r?r.value=n:t.set(e,n),n}function O(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function N(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var o,r;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");o=t[Symbol.asyncDispose]}if(void 0===o){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");o=t[Symbol.dispose],n&&(r=o)}if("function"!=typeof o)throw new TypeError("Object not disposable.");r&&(o=function(){try{r.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:o,async:n})}else n&&e.stack.push({async:!0});return t}var L="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var o=new Error(n);return o.name="SuppressedError",o.error=e,o.suppressed=t,o};function F(e){function t(t){e.error=e.hasError?new L(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var n,o=0;return function r(){for(;n=e.stack.pop();)try{if(!n.async&&1===o)return o=0,e.stack.push(n),Promise.resolve().then(r);if(n.dispose){var s=n.dispose.call(n.value);if(n.async)return o|=2,Promise.resolve(s).then(r,(function(e){return t(e),r()}))}else o|=1}catch(e){t(e)}if(1===o)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function B(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,(function(e,n,o,r,s){return n?t?".jsx":".js":!o||r&&s?o+r+"."+s.toLowerCase()+"js":e})):e}const W={__extends:r,__assign:s,__rest:i,__decorate:a,__param:l,__esDecorate:c,__runInitializers:u,__propKey:d,__setFunctionName:h,__metadata:p,__awaiter:f,__generator:g,__createBinding:m,__exportStar:y,__values:v,__read:b,__spread:S,__spreadArrays:w,__spreadArray:T,__await:_,__asyncGenerator:C,__asyncDelegator:k,__asyncValues:E,__makeTemplateObject:A,__importStar:M,__importDefault:x,__classPrivateFieldGet:R,__classPrivateFieldSet:D,__classPrivateFieldIn:O,__addDisposableResource:N,__disposeResources:F,__rewriteRelativeImportExtension:B}},60041:e=>{"use strict";e.exports={r:"2.35.2413"}}}]);
//# sourceMappingURL=vendor.js.map