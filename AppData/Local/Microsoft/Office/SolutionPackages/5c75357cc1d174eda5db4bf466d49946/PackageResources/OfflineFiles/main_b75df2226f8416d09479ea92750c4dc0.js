/*! For license information please see main.js.LICENSE.txt */
var TypeScriptModule;(()=>{var e,t,n={376:(e,t,n)=>{"use strict";e.exports=n(8365)},612:(e,t,n)=>{"use strict";const r=n(1949);e.exports=(e,t,n)=>r(e,t,"<",n)},670:e=>{"use strict";const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},677:(e,t,n)=>{"use strict";const r=n(883);e.exports=(e,t)=>e.sort((e,n)=>r(e,n,t))},690:(e,t,n)=>{"use strict";const r=n(6242);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},781:(e,t,n)=>{"use strict";const r=n(1949);e.exports=(e,t,n)=>r(e,t,">",n)},813:(e,t,n)=>{"use strict";const r=n(690);e.exports=(e,t,n)=>r(e,t,n)<0},883:(e,t,n)=>{"use strict";const r=n(6242);e.exports=(e,t,n)=>{const i=new r(e,n),o=new r(t,n);return i.compare(o)||i.compareBuild(o)}},926:(e,t,n)=>{"use strict";const r=n(690);e.exports=(e,t,n)=>r(e,t,n)<=0},979:(e,t,n)=>{"use strict";const r=n(1250),i=n(6031),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.hp=l,t.IS=50;const a=2147483647;function s(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|v(e,t);let r=s(n);const i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(X(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,ArrayBuffer)||e&&X(e.buffer,ArrayBuffer))return p(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(X(e,SharedArrayBuffer)||e&&X(e.buffer,SharedArrayBuffer)))return p(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return l.from(r,t,n);const i=function(e){if(l.isBuffer(e)){const t=0|h(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||Q(e.length)?s(0):f(e):"Buffer"===e.type&&Array.isArray(e.data)?f(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return u(e),s(e<0?0:0|h(e))}function f(e){const t=e.length<0?0:0|h(e.length),n=s(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function p(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,l.prototype),r}function h(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function v(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||X(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(e).length;default:if(i)return r?-1:V(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return O(this,t,n);case"utf8":case"utf-8":return I(this,t,n);case"ascii":return x(this,t,n);case"latin1":case"binary":return R(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Q(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:S(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):S(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function S(e,t,n,r,i){let o,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let r=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===l)return r*a}else-1!==r&&(o-=o-r),r=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){let n=!0;for(let r=0;r<l;r++)if(c(e,o+r)!==c(t,r)){n=!1;break}if(n)return o}return-1}function b(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let a;for(r>o/2&&(r=o/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(Q(r))return a;e[n+a]=r}return a}function w(e,t,n,r){return K(V(t,e.length-n),e,n,r)}function k(e,t,n,r){return K(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function E(e,t,n,r){return K(G(t),e,n,r)}function A(e,t,n,r){return K(function(e,t){let n,r,i;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function I(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=n){let n,r,s,l;switch(a){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(o=l));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(l=(15&t)<<12|(63&n)<<6|63&r,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:n=e[i+1],r=e[i+2],s=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(l=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=a}return function(e){const t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}l.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,n){return function(e,t,n){return u(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},l.allocUnsafe=function(e){return d(e)},l.allocUnsafeSlow=function(e){return d(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(X(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=l.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(X(t,Uint8Array))i+t.length>r.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!l.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},l.byteLength=v,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)m(this,t,t+1);return this},l.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},l.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},l.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?I(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="";const n=t.IS;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,n,r,i){if(X(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const s=Math.min(o,a),c=this.slice(r,i),u=e.slice(t,n);for(let e=0;e<s;++e)if(c[e]!==u[e]){o=c[e],a=u[e];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":case"latin1":case"binary":return k(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function x(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function R(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function O(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=J[e[r]];return i}function P(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function N(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function F(e,t,n,r,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function B(e,t,n,r,i){j(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function L(e,t,n,r,i){j(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function D(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function H(e,t,n,r,o){return t=+t,n>>>=0,o||D(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function _(e,t,n,r,o){return t=+t,n>>>=0,o||D(e,0,n,8),i.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||N(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||N(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=Y(function(e){$(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))}),l.prototype.readBigUInt64BE=Y(function(e){$(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)}),l.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||N(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||N(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||N(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){e>>>=0,t||N(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=Y(function(e){$(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),l.prototype.readBigInt64BE=Y(function(e){$(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||W(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)}),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||N(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||N(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||N(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||N(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||F(this,e,t,n,Math.pow(2,8*n)-1,0);let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||F(this,e,t,n,Math.pow(2,8*n)-1,0);let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=Y(function(e,t=0){return B(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=Y(function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);F(this,e,t,n,r-1,-r)}let i=0,o=1,a=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);F(this,e,t,n,r-1,-r)}let i=n-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o|0)-a&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||F(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=Y(function(e,t=0){return B(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=Y(function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeFloatLE=function(e,t,n){return H(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return H(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return _(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return _(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=l.isBuffer(e)?e:l.from(e,r),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%a]}return this};const M={};function U(e,t,n){M[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function z(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function j(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new M.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){$(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||W(t,e.length-(n+1))}(r,i,o)}function $(e,t){if("number"!=typeof e)throw new M.ERR_INVALID_ARG_TYPE(t,"number",e)}function W(e,t,n){if(Math.floor(e)!==e)throw $(e,n),new M.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new M.ERR_BUFFER_OUT_OF_BOUNDS;throw new M.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),U("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),U("ERR_OUT_OF_RANGE",function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=z(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=z(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r},RangeError);const q=/[^+/0-9A-Za-z-_]/g;function V(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function K(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Q(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function Y(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},1015:(e,t,n)=>{"use strict";e.exports=n(3894)},1250:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,o=s(e),a=o[0],l=o[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,a,l)),u=0,d=l>0?a-4:a;for(n=0;n<d;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;return 2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[u++]=255&t),1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t),c},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,o=[],a=16383,s=0,l=r-i;s<l;s+=a)o.push(c(e,s,s+a>l?l:s+a));return 1===i?(t=e[r-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=o[a],r[o.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function c(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(l(r));return i.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},1754:(e,t,n)=>{"use strict";var r=n(1015),i=n(4600),o=n(376);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));var s=new Set,l={};function c(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(l[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p=Object.prototype.hasOwnProperty,h={},v={};function g(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){m[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){m[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){m[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){m[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){m[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function S(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0===i.type:!r&&2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1]))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!p.call(v,e)||!p.call(h,e)&&(f.test(e)?v[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,S);m[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,S);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,S);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=60103,E=60106,A=60107,C=60108,I=60114,T=60109,x=60110,R=60112,O=60113,P=60120,N=60115,F=60116,B=60121,L=60128,D=60129,H=60130,_=60131;if("function"==typeof Symbol&&Symbol.for){var M=Symbol.for;k=M("react.element"),E=M("react.portal"),A=M("react.fragment"),C=M("react.strict_mode"),I=M("react.profiler"),T=M("react.provider"),x=M("react.context"),R=M("react.forward_ref"),O=M("react.suspense"),P=M("react.suspense_list"),N=M("react.memo"),F=M("react.lazy"),B=M("react.block"),M("react.scope"),L=M("react.opaque.id"),D=M("react.debug_trace_mode"),H=M("react.offscreen"),_=M("react.legacy_hidden")}var U,z="function"==typeof Symbol&&Symbol.iterator;function j(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=z&&e[z]||e["@@iterator"])?e:null}function $(e){if(void 0===U)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);U=t&&t[1]||""}return"\n"+U+e}var W=!1;function q(e,t){if(!e||W)return"";W=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}else{try{throw Error()}catch(e){r=e}e()}}catch(e){if(e&&r&&"string"==typeof e.stack){for(var i=e.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s])return"\n"+i[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{W=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?$(e):""}function V(e){switch(e.tag){case 5:return $(e.type);case 16:return $("Lazy");case 13:return $("Suspense");case 19:return $("SuspenseList");case 0:case 2:case 15:return q(e.type,!1);case 11:return q(e.type.render,!1);case 22:return q(e.type._render,!1);case 1:return q(e.type,!0);default:return""}}function G(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case A:return"Fragment";case E:return"Portal";case I:return"Profiler";case C:return"StrictMode";case O:return"Suspense";case P:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case x:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case R:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case N:return G(e.type);case B:return G(e._render);case F:t=e._payload,e=e._init;try{return G(e(t))}catch(e){}}return null}function K(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function X(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Q(e){e._valueTracker||(e._valueTracker=function(e){var t=X(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=X(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=K(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=K(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ie(e,t.type,n):t.hasOwnProperty("defaultValue")&&ie(e,t.type,K(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ie(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function oe(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,function(e){null!=e&&(t+=e)}),t}(t.children))&&(e.children=t),e}function ae(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+K(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function le(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:K(n)}}function ce(e,t){var n=K(t.value),r=K(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ue(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var de="http://www.w3.org/1999/xhtml";function fe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?fe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var he,ve,ge=(ve=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((he=he||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=he.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ve(e,t)})}:ve);function me(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ye={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Se=["Webkit","ms","Moz","O"];function be(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||ye.hasOwnProperty(e)&&ye[e]?(""+t).trim():t+"px"}function we(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=be(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(ye).forEach(function(e){Se.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ye[t]=ye[e]})});var ke=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ee(e,t){if(t){if(ke[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(a(62))}}function Ae(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Te=null,xe=null;function Re(e){if(e=ti(e)){if("function"!=typeof Ie)throw Error(a(280));var t=e.stateNode;t&&(t=ri(t),Ie(e.stateNode,e.type,t))}}function Oe(e){Te?xe?xe.push(e):xe=[e]:Te=e}function Pe(){if(Te){var e=Te,t=xe;if(xe=Te=null,Re(e),t)for(e=0;e<t.length;e++)Re(t[e])}}function Ne(e,t){return e(t)}function Fe(e,t,n,r,i){return e(t,n,r,i)}function Be(){}var Le=Ne,De=!1,He=!1;function _e(){null===Te&&null===xe||(Be(),Pe())}function Me(e,t){var n=e.stateNode;if(null===n)return null;var r=ri(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(a(231,t,typeof n));return n}var Ue=!1;if(d)try{var ze={};Object.defineProperty(ze,"passive",{get:function(){Ue=!0}}),window.addEventListener("test",ze,ze),window.removeEventListener("test",ze,ze)}catch(ve){Ue=!1}function je(e,t,n,r,i,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(e){this.onError(e)}}var $e=!1,We=null,qe=!1,Ve=null,Ge={onError:function(e){$e=!0,We=e}};function Ke(e,t,n,r,i,o,a,s,l){$e=!1,We=null,je.apply(Ge,arguments)}function Xe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function Je(e){if(Xe(e)!==e)throw Error(a(188))}function Ye(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var Ze,et,tt,nt,rt=!1,it=[],ot=null,at=null,st=null,lt=new Map,ct=new Map,ut=[],dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ft(e,t,n,r,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function pt(e,t){switch(e){case"focusin":case"focusout":ot=null;break;case"dragenter":case"dragleave":at=null;break;case"mouseover":case"mouseout":st=null;break;case"pointerover":case"pointerout":lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ct.delete(t.pointerId)}}function ht(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e=ft(t,n,r,i,o),null!==t&&null!==(t=ti(t))&&et(t),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function vt(e){var t=ei(e.target);if(null!==t){var n=Xe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Qe(n)))return e.blockedOn=t,void nt(e.lanePriority,function(){o.unstable_runWithPriority(e.priority,function(){tt(n)})})}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function gt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ti(n))&&et(t),e.blockedOn=n,!1;t.shift()}return!0}function mt(e,t,n){gt(e)&&n.delete(t)}function yt(){for(rt=!1;0<it.length;){var e=it[0];if(null!==e.blockedOn){null!==(e=ti(e.blockedOn))&&Ze(e);break}for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&it.shift()}null!==ot&&gt(ot)&&(ot=null),null!==at&&gt(at)&&(at=null),null!==st&&gt(st)&&(st=null),lt.forEach(mt),ct.forEach(mt)}function St(e,t){e.blockedOn===t&&(e.blockedOn=null,rt||(rt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,yt)))}function bt(e){function t(t){return St(t,e)}if(0<it.length){St(it[0],e);for(var n=1;n<it.length;n++){var r=it[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==ot&&St(ot,e),null!==at&&St(at,e),null!==st&&St(st,e),lt.forEach(t),ct.forEach(t),n=0;n<ut.length;n++)(r=ut[n]).blockedOn===e&&(r.blockedOn=null);for(;0<ut.length&&null===(n=ut[0]).blockedOn;)vt(n),null===n.blockedOn&&ut.shift()}function wt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kt={animationend:wt("Animation","AnimationEnd"),animationiteration:wt("Animation","AnimationIteration"),animationstart:wt("Animation","AnimationStart"),transitionend:wt("Transition","TransitionEnd")},Et={},At={};function Ct(e){if(Et[e])return Et[e];if(!kt[e])return e;var t,n=kt[e];for(t in n)if(n.hasOwnProperty(t)&&t in At)return Et[e]=n[t];return e}d&&(At=document.createElement("div").style,"AnimationEvent"in window||(delete kt.animationend.animation,delete kt.animationiteration.animation,delete kt.animationstart.animation),"TransitionEvent"in window||delete kt.transitionend.transition);var It=Ct("animationend"),Tt=Ct("animationiteration"),xt=Ct("animationstart"),Rt=Ct("transitionend"),Ot=new Map,Pt=new Map,Nt=["abort","abort",It,"animationEnd",Tt,"animationIteration",xt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Rt,"transitionEnd","waiting","waiting"];function Ft(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),Pt.set(r,t),Ot.set(r,i),c(i,[r])}}(0,o.unstable_now)();var Bt=8;function Lt(e){if(1&e)return Bt=15,1;if(2&e)return Bt=14,2;if(4&e)return Bt=13,4;var t=24&e;return 0!==t?(Bt=12,t):32&e?(Bt=11,32):0!=(t=192&e)?(Bt=10,t):256&e?(Bt=9,256):0!=(t=3584&e)?(Bt=8,t):4096&e?(Bt=7,4096):0!=(t=4186112&e)?(Bt=6,t):0!=(t=62914560&e)?(Bt=5,t):67108864&e?(Bt=4,67108864):134217728&e?(Bt=3,134217728):0!=(t=805306368&e)?(Bt=2,t):1073741824&e?(Bt=1,1073741824):(Bt=8,e)}function Dt(e,t){var n=e.pendingLanes;if(0===n)return Bt=0;var r=0,i=0,o=e.expiredLanes,a=e.suspendedLanes,s=e.pingedLanes;if(0!==o)r=o,i=Bt=15;else if(0!=(o=134217727&n)){var l=o&~a;0!==l?(r=Lt(l),i=Bt):0!==(s&=o)&&(r=Lt(s),i=Bt)}else 0!==(o=n&~a)?(r=Lt(o),i=Bt):0!==s&&(r=Lt(s),i=Bt);if(0===r)return 0;if(r=n&((0>(r=31-jt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&a)){if(Lt(t),i<=Bt)return t;Bt=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-jt(t)),r|=e[n],t&=~i;return r}function Ht(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function _t(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Mt(24&~t))?_t(10,t):e;case 10:return 0===(e=Mt(192&~t))?_t(8,t):e;case 8:return 0===(e=Mt(3584&~t))&&0===(e=Mt(4186112&~t))&&(e=512),e;case 2:return 0===(t=Mt(805306368&~t))&&(t=268435456),t}throw Error(a(358,e))}function Mt(e){return e&-e}function Ut(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function zt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-jt(t)]=n}var jt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-($t(e)/Wt|0)|0},$t=Math.log,Wt=Math.LN2,qt=o.unstable_UserBlockingPriority,Vt=o.unstable_runWithPriority,Gt=!0;function Kt(e,t,n,r){De||Be();var i=Qt,o=De;De=!0;try{Fe(i,e,t,n,r)}finally{(De=o)||_e()}}function Xt(e,t,n,r){Vt(qt,Qt.bind(null,e,t,n,r))}function Qt(e,t,n,r){var i;if(Gt)if((i=!(4&t))&&0<it.length&&-1<dt.indexOf(e))e=ft(null,e,t,n,r),it.push(e);else{var o=Jt(e,t,n,r);if(null===o)i&&pt(e,r);else{if(i){if(-1<dt.indexOf(e))return e=ft(o,e,t,n,r),void it.push(e);if(function(e,t,n,r,i){switch(t){case"focusin":return ot=ht(ot,e,t,n,r,i),!0;case"dragenter":return at=ht(at,e,t,n,r,i),!0;case"mouseover":return st=ht(st,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return lt.set(o,ht(lt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,ct.set(o,ht(ct.get(o)||null,e,t,n,r,i)),!0}return!1}(o,e,t,n,r))return;pt(e,r)}Fr(e,t,r,null,n)}}}function Jt(e,t,n,r){var i=Ce(r);if(null!==(i=ei(i))){var o=Xe(i);if(null===o)i=null;else{var a=o.tag;if(13===a){if(null!==(i=Qe(o)))return i;i=null}else if(3===a){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Fr(e,t,r,i,n),null}var Yt=null,Zt=null,en=null;function tn(){if(en)return en;var e,t,n=Zt,r=n.length,i="value"in Yt?Yt.value:Yt.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return en=i.slice(e,1<t?1-t:void 0)}function nn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rn(){return!0}function on(){return!1}function an(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rn:on,this.isPropagationStopped=on,this}return i(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rn)},persist:function(){},isPersistent:rn}),t}var sn,ln,cn,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=an(un),fn=i({},un,{view:0,detail:0}),pn=an(fn),hn=i({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:In,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(sn=e.screenX-cn.screenX,ln=e.screenY-cn.screenY):ln=sn=0,cn=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),vn=an(hn),gn=an(i({},hn,{dataTransfer:0})),mn=an(i({},fn,{relatedTarget:0})),yn=an(i({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),Sn=i({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(Sn),wn=an(i({},un,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},An={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=An[e])&&!!t[e]}function In(){return Cn}var Tn=i({},fn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=nn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:In,charCode:function(e){return"keypress"===e.type?nn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?nn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),xn=an(Tn),Rn=an(i({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=an(i({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:In})),Pn=an(i({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nn=i({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Fn=an(Nn),Bn=[9,13,27,32],Ln=d&&"CompositionEvent"in window,Dn=null;d&&"documentMode"in document&&(Dn=document.documentMode);var Hn=d&&"TextEvent"in window&&!Dn,_n=d&&(!Ln||Dn&&8<Dn&&11>=Dn),Mn=String.fromCharCode(32),Un=!1;function zn(e,t){switch(e){case"keyup":return-1!==Bn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var $n=!1,Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Vn(e,t,n,r){Oe(r),0<(t=Lr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Xn(e){Tr(e,0)}function Qn(e){if(J(ni(e)))return e}function Jn(e,t){if("change"===e)return t}var Yn=!1;if(d){var Zn;if(d){var er="oninput"in document;if(!er){var tr=document.createElement("div");tr.setAttribute("oninput","return;"),er="function"==typeof tr.oninput}Zn=er}else Zn=!1;Yn=Zn&&(!document.documentMode||9<document.documentMode)}function nr(){Gn&&(Gn.detachEvent("onpropertychange",rr),Kn=Gn=null)}function rr(e){if("value"===e.propertyName&&Qn(Kn)){var t=[];if(Vn(t,Kn,e,Ce(e)),e=Xn,De)e(t);else{De=!0;try{Ne(e,t)}finally{De=!1,_e()}}}}function ir(e,t,n){"focusin"===e?(nr(),Kn=n,(Gn=t).attachEvent("onpropertychange",rr)):"focusout"===e&&nr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(Kn)}function ar(e,t){if("click"===e)return Qn(t)}function sr(e,t){if("input"===e||"change"===e)return Qn(t)}var lr="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},cr=Object.prototype.hasOwnProperty;function ur(e,t){if(lr(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!cr.call(t,n[r])||!lr(e[n[r]],t[n[r]]))return!1;return!0}function dr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fr(e,t){var n,r=dr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dr(r)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function vr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var gr=d&&"documentMode"in document&&11>=document.documentMode,mr=null,yr=null,Sr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==Y(r)||(r="selectionStart"in(r=mr)&&vr(r)?{start:r.selectionStart,end:r.selectionEnd}:{anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},Sr&&ur(Sr,r)||(Sr=r,0<(r=Lr(yr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}Ft("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ft("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ft(Nt,2);for(var kr="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Er=0;Er<kr.length;Er++)Pt.set(kr[Er],0);u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ar="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ar));function Ir(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,s,l,c){if(Ke.apply(this,arguments),$e){if(!$e)throw Error(a(198));var u=We;$e=!1,We=null,qe||(qe=!0,Ve=u)}}(r,t,void 0,e),e.currentTarget=null}function Tr(e,t){t=!!(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;Ir(i,s,c),o=l}else for(a=0;a<r.length;a++){if(l=(s=r[a]).instance,c=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;Ir(i,s,c),o=l}}}if(qe)throw e=Ve,qe=!1,Ve=null,e}function xr(e,t){var n=ii(t),r=e+"__bubble";n.has(r)||(Nr(t,e,2,!1),n.add(r))}var Rr="_reactListening"+Math.random().toString(36).slice(2);function Or(e){e[Rr]||(e[Rr]=!0,s.forEach(function(t){Cr.has(t)||Pr(t,!1,e,null),Pr(t,!0,e,null)}))}function Pr(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===e&&9!==n.nodeType&&(o=n.ownerDocument),null!==r&&!t&&Cr.has(e)){if("scroll"!==e)return;i|=2,o=r}var a=ii(o),s=e+"__"+(t?"capture":"bubble");a.has(s)||(t&&(i|=4),Nr(o,e,i,t),a.add(s))}function Nr(e,t,n,r){var i=Pt.get(t);switch(void 0===i?2:i){case 0:i=Kt;break;case 1:i=Xt;break;default:i=Qt}n=i.bind(null,t,n,e),i=void 0,!Ue||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Fr(e,t,n,r,i){var o=r;if(!(1&t||2&t||null===r))e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=ei(s)))return;if(5===(l=a.tag)||6===l){r=o=a;continue e}s=s.parentNode}}r=r.return}!function(e,t,n){if(He)return e();He=!0;try{return Le(e,t,n)}finally{He=!1,_e()}}(function(){var r=o,i=Ce(n),a=[];e:{var s=Ot.get(e);if(void 0!==s){var l=dn,c=e;switch(e){case"keypress":if(0===nn(n))break e;case"keydown":case"keyup":l=xn;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=vn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=On;break;case It:case Tt:case xt:l=yn;break;case Rt:l=Pn;break;case"scroll":l=pn;break;case"wheel":l=Fn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Rn}var u=!!(4&t),d=!u&&"scroll"===e,f=u?null!==s?s+"Capture":null:s;u=[];for(var p,h=r;null!==h;){var v=(p=h).stateNode;if(5===p.tag&&null!==v&&(p=v,null!==f&&null!=(v=Me(h,f))&&u.push(Br(h,v,p))),d)break;h=h.return}0<u.length&&(s=new l(s,c,null,n,i),a.push({event:s,listeners:u}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||16&t||!(c=n.relatedTarget||n.fromElement)||!ei(c)&&!c[Yr])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?ei(c):null)&&(c!==(d=Xe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=vn,v="onMouseLeave",f="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(u=Rn,v="onPointerLeave",f="onPointerEnter",h="pointer"),d=null==l?s:ni(l),p=null==c?s:ni(c),(s=new u(v,h+"leave",l,n,i)).target=d,s.relatedTarget=p,v=null,ei(i)===r&&((u=new u(f,h+"enter",c,n,i)).target=p,u.relatedTarget=d,v=u),d=v,l&&c)e:{for(f=c,h=0,p=u=l;p;p=Dr(p))h++;for(p=0,v=f;v;v=Dr(v))p++;for(;0<h-p;)u=Dr(u),h--;for(;0<p-h;)f=Dr(f),p--;for(;h--;){if(u===f||null!==f&&u===f.alternate)break e;u=Dr(u),f=Dr(f)}u=null}else u=null;null!==l&&Hr(a,s,l,u,!1),null!==c&&null!==d&&Hr(a,d,c,u,!0)}if("select"===(l=(s=r?ni(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Jn;else if(qn(s))if(Yn)g=sr;else{g=or;var m=ir}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ar);switch(g&&(g=g(e,r))?Vn(a,g,n,i):(m&&m(e,s,r),"focusout"===e&&(m=s._wrapperState)&&m.controlled&&"number"===s.type&&ie(s,"number",s.value)),m=r?ni(r):window,e){case"focusin":(qn(m)||"true"===m.contentEditable)&&(mr=m,yr=r,Sr=null);break;case"focusout":Sr=yr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(a,n,i);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":wr(a,n,i)}var y;if(Ln)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else $n?zn(e,n)&&(S="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(S="onCompositionStart");S&&(_n&&"ko"!==n.locale&&($n||"onCompositionStart"!==S?"onCompositionEnd"===S&&$n&&(y=tn()):(Zt="value"in(Yt=i)?Yt.value:Yt.textContent,$n=!0)),0<(m=Lr(r,S)).length&&(S=new wn(S,e,null,n,i),a.push({event:S,listeners:m}),(y||null!==(y=jn(n)))&&(S.data=y))),(y=Hn?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(Un=!0,Mn);case"textInput":return(e=t.data)===Mn&&Un?null:e;default:return null}}(e,n):function(e,t){if($n)return"compositionend"===e||!Ln&&zn(e,t)?(e=tn(),en=Zt=Yt=null,$n=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _n&&"ko"!==t.locale?null:t.data}}(e,n))&&0<(r=Lr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y)}Tr(a,t)})}function Br(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Lr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Me(e,n))&&r.unshift(Br(e,o,i)),null!=(o=Me(e,t))&&r.push(Br(e,o,i))),e=e.return}return r}function Dr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Hr(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,l=s.alternate,c=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==c&&(s=c,i?null!=(l=Me(n,o))&&a.unshift(Br(n,l,s)):i||null!=(l=Me(n,o))&&a.push(Br(n,l,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}function _r(){}var Mr=null,Ur=null;function zr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function jr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var $r="function"==typeof setTimeout?setTimeout:void 0,Wr="function"==typeof clearTimeout?clearTimeout:void 0;function qr(e){(1===e.nodeType||9===e.nodeType&&null!=(e=e.body))&&(e.textContent="")}function Vr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Gr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Kr=0,Xr=Math.random().toString(36).slice(2),Qr="__reactFiber$"+Xr,Jr="__reactProps$"+Xr,Yr="__reactContainer$"+Xr,Zr="__reactEvents$"+Xr;function ei(e){var t=e[Qr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Yr]||n[Qr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Gr(e);null!==e;){if(n=e[Qr])return n;e=Gr(e)}return t}n=(e=n).parentNode}return null}function ti(e){return!(e=e[Qr]||e[Yr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ni(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function ri(e){return e[Jr]||null}function ii(e){var t=e[Zr];return void 0===t&&(t=e[Zr]=new Set),t}var oi=[],ai=-1;function si(e){return{current:e}}function li(e){0>ai||(e.current=oi[ai],oi[ai]=null,ai--)}function ci(e,t){ai++,oi[ai]=e.current,e.current=t}var ui={},di=si(ui),fi=si(!1),pi=ui;function hi(e,t){var n=e.type.contextTypes;if(!n)return ui;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function vi(e){return null!=e.childContextTypes}function gi(){li(fi),li(di)}function mi(e,t,n){if(di.current!==ui)throw Error(a(168));ci(di,t),ci(fi,n)}function yi(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(a(108,G(t)||"Unknown",o));return i({},n,r)}function Si(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ui,pi=di.current,ci(di,e),ci(fi,fi.current),!0}function bi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=yi(e,t,pi),r.__reactInternalMemoizedMergedChildContext=e,li(fi),li(di),ci(di,e)):li(fi),ci(fi,n)}var wi=null,ki=null,Ei=o.unstable_runWithPriority,Ai=o.unstable_scheduleCallback,Ci=o.unstable_cancelCallback,Ii=o.unstable_shouldYield,Ti=o.unstable_requestPaint,xi=o.unstable_now,Ri=o.unstable_getCurrentPriorityLevel,Oi=o.unstable_ImmediatePriority,Pi=o.unstable_UserBlockingPriority,Ni=o.unstable_NormalPriority,Fi=o.unstable_LowPriority,Bi=o.unstable_IdlePriority,Li={},Di=void 0!==Ti?Ti:function(){},Hi=null,_i=null,Mi=!1,Ui=xi(),zi=1e4>Ui?xi:function(){return xi()-Ui};function ji(){switch(Ri()){case Oi:return 99;case Pi:return 98;case Ni:return 97;case Fi:return 96;case Bi:return 95;default:throw Error(a(332))}}function $i(e){switch(e){case 99:return Oi;case 98:return Pi;case 97:return Ni;case 96:return Fi;case 95:return Bi;default:throw Error(a(332))}}function Wi(e,t){return e=$i(e),Ei(e,t)}function qi(e,t,n){return e=$i(e),Ai(e,t,n)}function Vi(){if(null!==_i){var e=_i;_i=null,Ci(e)}Gi()}function Gi(){if(!Mi&&null!==Hi){Mi=!0;var e=0;try{var t=Hi;Wi(99,function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}}),Hi=null}catch(t){throw null!==Hi&&(Hi=Hi.slice(e+1)),Ai(Oi,Vi),t}finally{Mi=!1}}}var Ki=w.ReactCurrentBatchConfig;function Xi(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Qi=si(null),Ji=null,Yi=null,Zi=null;function eo(){Zi=Yi=Ji=null}function to(e){var t=Qi.current;li(Qi),e.type._context._currentValue=t}function no(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function ro(e,t){Ji=e,Zi=Yi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(La=!0),e.firstContext=null)}function io(e,t){if(Zi!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(Zi=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Yi){if(null===Ji)throw Error(a(308));Yi=t,Ji.dependencies={lanes:0,firstContext:t,responders:null}}else Yi=Yi.next=t;return e._currentValue}var oo=!1;function ao(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function so(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function lo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function co(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function uo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function fo(e,t,n,r){var o=e.updateQueue;oo=!1;var a=o.firstBaseUpdate,s=o.lastBaseUpdate,l=o.shared.pending;if(null!==l){o.shared.pending=null;var c=l,u=c.next;c.next=null,null===s?a=u:s.next=u,s=c;var d=e.alternate;if(null!==d){var f=(d=d.updateQueue).lastBaseUpdate;f!==s&&(null===f?d.firstBaseUpdate=u:f.next=u,d.lastBaseUpdate=c)}}if(null!==a){for(f=o.baseState,s=0,d=u=c=null;;){l=a.lane;var p=a.eventTime;if((r&l)===l){null!==d&&(d=d.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var h=e,v=a;switch(l=t,p=n,v.tag){case 1:if("function"==typeof(h=v.payload)){f=h.call(p,f,l);break e}f=h;break e;case 3:h.flags=-4097&h.flags|64;case 0:if(null==(l="function"==typeof(h=v.payload)?h.call(p,f,l):h))break e;f=i({},f,l);break e;case 2:oo=!0}}null!==a.callback&&(e.flags|=32,null===(l=o.effects)?o.effects=[a]:l.push(a))}else p={eventTime:p,lane:l,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===d?(u=d=p,c=f):d=d.next=p,s|=l;if(null===(a=a.next)){if(null===(l=o.shared.pending))break;a=l.next,l.next=null,o.lastBaseUpdate=l,o.shared.pending=null}}null===d&&(c=f),o.baseState=c,o.firstBaseUpdate=u,o.lastBaseUpdate=d,_s|=s,e.lanes=s,e.memoizedState=f}}function po(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!=typeof i)throw Error(a(191,i));i.call(r)}}}var ho=(new r.Component).refs;function vo(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var go={isMounted:function(e){return!!(e=e._reactInternals)&&Xe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=cl(),i=ul(e),o=lo(r,i);o.payload=t,null!=n&&(o.callback=n),co(e,o),dl(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=cl(),i=ul(e),o=lo(r,i);o.tag=1,o.payload=t,null!=n&&(o.callback=n),co(e,o),dl(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=cl(),r=ul(e),i=lo(n,r);i.tag=2,null!=t&&(i.callback=t),co(e,i),dl(e,r,n)}};function mo(e,t,n,r,i,o,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!(t.prototype&&t.prototype.isPureReactComponent&&ur(n,r)&&ur(i,o))}function yo(e,t,n){var r=!1,i=ui,o=t.contextType;return"object"==typeof o&&null!==o?o=io(o):(i=vi(t)?pi:di.current,o=(r=null!=(r=t.contextTypes))?hi(e,i):ui),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=go,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function So(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&go.enqueueReplaceState(t,t.state,null)}function bo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=ho,ao(e);var o=t.contextType;"object"==typeof o&&null!==o?i.context=io(o):(o=vi(t)?pi:di.current,i.context=hi(e,o)),fo(e,n,i,r),i.state=e.memoizedState,"function"==typeof(o=t.getDerivedStateFromProps)&&(vo(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&go.enqueueReplaceState(i,i.state,null),fo(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4)}var wo=Array.isArray;function ko(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=r.refs;t===ho&&(t=r.refs={}),null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!=typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Eo(e,t){if("textarea"!==e.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Ao(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=$l(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function s(t){return e&&null===t.alternate&&(t.flags=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Gl(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=ko(e,t,n),r.return=e,r):((r=Wl(n.type,n.key,n.props,null,e.mode,r)).ref=ko(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Kl(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=ql(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Gl(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Wl(t.type,t.key,t.props,null,e.mode,n)).ref=ko(e,null,t),n.return=e,n;case E:return(t=Kl(t,e.mode,n)).return=e,t}if(wo(t)||j(t))return(t=ql(t,e.mode,n,null)).return=e,t;Eo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===i?n.type===A?d(e,t,n.props.children,r,i):c(e,t,n,r):null;case E:return n.key===i?u(e,t,n,r):null}if(wo(n)||j(n))return null!==i?null:d(e,t,n,r,null);Eo(e,n)}return null}function h(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case k:return e=e.get(null===r.key?n:r.key)||null,r.type===A?d(t,e,r.props.children,i,r.key):c(t,e,r,i);case E:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(wo(r)||j(r))return d(t,e=e.get(n)||null,r,i,null);Eo(t,r)}return null}function v(i,a,s,l){for(var c=null,u=null,d=a,v=a=0,g=null;null!==d&&v<s.length;v++){d.index>v?(g=d,d=null):g=d.sibling;var m=p(i,d,s[v],l);if(null===m){null===d&&(d=g);break}e&&d&&null===m.alternate&&t(i,d),a=o(m,a,v),null===u?c=m:u.sibling=m,u=m,d=g}if(v===s.length)return n(i,d),c;if(null===d){for(;v<s.length;v++)null!==(d=f(i,s[v],l))&&(a=o(d,a,v),null===u?c=d:u.sibling=d,u=d);return c}for(d=r(i,d);v<s.length;v++)null!==(g=h(d,i,v,s[v],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?v:g.key),a=o(g,a,v),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(i,e)}),c}function g(i,s,l,c){var u=j(l);if("function"!=typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var d=u=null,v=s,g=s=0,m=null,y=l.next();null!==v&&!y.done;g++,y=l.next()){v.index>g?(m=v,v=null):m=v.sibling;var S=p(i,v,y.value,c);if(null===S){null===v&&(v=m);break}e&&v&&null===S.alternate&&t(i,v),s=o(S,s,g),null===d?u=S:d.sibling=S,d=S,v=m}if(y.done)return n(i,v),u;if(null===v){for(;!y.done;g++,y=l.next())null!==(y=f(i,y.value,c))&&(s=o(y,s,g),null===d?u=y:d.sibling=y,d=y);return u}for(v=r(i,v);!y.done;g++,y=l.next())null!==(y=h(v,i,g,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?g:y.key),s=o(y,s,g),null===d?u=y:d.sibling=y,d=y);return e&&v.forEach(function(e){return t(i,e)}),u}return function(e,r,o,l){var c="object"==typeof o&&null!==o&&o.type===A&&null===o.key;c&&(o=o.props.children);var u="object"==typeof o&&null!==o;if(u)switch(o.$$typeof){case k:e:{for(u=o.key,c=r;null!==c;){if(c.key===u){if(7===c.tag){if(o.type===A){n(e,c.sibling),(r=i(c,o.props.children)).return=e,e=r;break e}}else if(c.elementType===o.type){n(e,c.sibling),(r=i(c,o.props)).ref=ko(e,c,o),r.return=e,e=r;break e}n(e,c);break}t(e,c),c=c.sibling}o.type===A?((r=ql(o.props.children,e.mode,l,o.key)).return=e,e=r):((l=Wl(o.type,o.key,o.props,null,e.mode,l)).ref=ko(e,r,o),l.return=e,e=l)}return s(e);case E:e:{for(c=o.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Kl(o,e.mode,l)).return=e,e=r}return s(e)}if("string"==typeof o||"number"==typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=Gl(o,e.mode,l)).return=e,e=r),s(e);if(wo(o))return v(e,r,o,l);if(j(o))return g(e,r,o,l);if(u&&Eo(e,o),void 0===o&&!c)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(a(152,G(e.type)||"Component"))}return n(e,r)}}var Co=Ao(!0),Io=Ao(!1),To={},xo=si(To),Ro=si(To),Oo=si(To);function Po(e){if(e===To)throw Error(a(174));return e}function No(e,t){switch(ci(Oo,t),ci(Ro,e),ci(xo,To),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:t=pe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}li(xo),ci(xo,t)}function Fo(){li(xo),li(Ro),li(Oo)}function Bo(e){Po(Oo.current);var t=Po(xo.current),n=pe(t,e.type);t!==n&&(ci(Ro,e),ci(xo,n))}function Lo(e){Ro.current===e&&(li(xo),li(Ro))}var Do=si(0);function Ho(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(64&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var _o=null,Mo=null,Uo=!1;function zo(e,t){var n=zl(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function jo(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function $o(e){if(Uo){var t=Mo;if(t){var n=t;if(!jo(e,t)){if(!(t=Vr(n.nextSibling))||!jo(e,t))return e.flags=-1025&e.flags|2,Uo=!1,void(_o=e);zo(_o,n)}_o=e,Mo=Vr(t.firstChild)}else e.flags=-1025&e.flags|2,Uo=!1,_o=e}}function Wo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;_o=e}function qo(e){if(e!==_o)return!1;if(!Uo)return Wo(e),Uo=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!jr(t,e.memoizedProps))for(t=Mo;t;)zo(e,t),t=Vr(t.nextSibling);if(Wo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Mo=Vr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Mo=null}}else Mo=_o?Vr(e.stateNode.nextSibling):null;return!0}function Vo(){Mo=_o=null,Uo=!1}var Go=[];function Ko(){for(var e=0;e<Go.length;e++)Go[e]._workInProgressVersionPrimary=null;Go.length=0}var Xo=w.ReactCurrentDispatcher,Qo=w.ReactCurrentBatchConfig,Jo=0,Yo=null,Zo=null,ea=null,ta=!1,na=!1;function ra(){throw Error(a(321))}function ia(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function oa(e,t,n,r,i,o){if(Jo=o,Yo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Xo.current=null===e||null===e.memoizedState?Pa:Na,e=n(r,i),na){o=0;do{if(na=!1,!(25>o))throw Error(a(301));o+=1,ea=Zo=null,t.updateQueue=null,Xo.current=Fa,e=n(r,i)}while(na)}if(Xo.current=Oa,t=null!==Zo&&null!==Zo.next,Jo=0,ea=Zo=Yo=null,ta=!1,t)throw Error(a(300));return e}function aa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ea?Yo.memoizedState=ea=e:ea=ea.next=e,ea}function sa(){if(null===Zo){var e=Yo.alternate;e=null!==e?e.memoizedState:null}else e=Zo.next;var t=null===ea?Yo.memoizedState:ea.next;if(null!==t)ea=t,Zo=e;else{if(null===e)throw Error(a(310));e={memoizedState:(Zo=e).memoizedState,baseState:Zo.baseState,baseQueue:Zo.baseQueue,queue:Zo.queue,next:null},null===ea?Yo.memoizedState=ea=e:ea=ea.next=e}return ea}function la(e,t){return"function"==typeof t?t(e):t}function ca(e){var t=sa(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=Zo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var l=s=o=null,c=i;do{var u=c.lane;if((Jo&u)===u)null!==l&&(l=l.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),r=c.eagerReducer===e?c.eagerState:e(r,c.action);else{var d={lane:u,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===l?(s=l=d,o=r):l=l.next=d,Yo.lanes|=u,_s|=u}c=c.next}while(null!==c&&c!==i);null===l?o=r:l.next=s,lr(r,t.memoizedState)||(La=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=l,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function ua(e){var t=sa(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);lr(o,t.memoizedState)||(La=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function da(e,t,n){var r=t._getVersion;r=r(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(Jo&e)===e)&&(t._workInProgressVersionPrimary=r,Go.push(t))),e)return n(t._source);throw Go.push(t),Error(a(350))}function fa(e,t,n,r){var i=Os;if(null===i)throw Error(a(349));var o=t._getVersion,s=o(t._source),l=Xo.current,c=l.useState(function(){return da(i,t,n)}),u=c[1],d=c[0];c=ea;var f=e.memoizedState,p=f.refs,h=p.getSnapshot,v=f.source;f=f.subscribe;var g=Yo;return e.memoizedState={refs:p,source:t,subscribe:r},l.useEffect(function(){p.getSnapshot=n,p.setSnapshot=u;var e=o(t._source);if(!lr(s,e)){e=n(t._source),lr(d,e)||(u(e),e=ul(g),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,a=e;0<a;){var l=31-jt(a),c=1<<l;r[l]|=e,a&=~c}}},[n,t,r]),l.useEffect(function(){return r(t._source,function(){var e=p.getSnapshot,n=p.setSnapshot;try{n(e(t._source));var r=ul(g);i.mutableReadLanes|=r&i.pendingLanes}catch(e){n(function(){throw e})}})},[t,r]),lr(h,n)&&lr(v,t)&&lr(f,r)||((e={pending:null,dispatch:null,lastRenderedReducer:la,lastRenderedState:d}).dispatch=u=Ra.bind(null,Yo,e),c.queue=e,c.baseQueue=null,d=da(i,t,n),c.memoizedState=c.baseState=d),d}function pa(e,t,n){return fa(sa(),e,t,n)}function ha(e){var t=aa();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:la,lastRenderedState:e}).dispatch=Ra.bind(null,Yo,e),[t.memoizedState,e]}function va(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Yo.updateQueue)?(t={lastEffect:null},Yo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ga(e){return e={current:e},aa().memoizedState=e}function ma(){return sa().memoizedState}function ya(e,t,n,r){var i=aa();Yo.flags|=e,i.memoizedState=va(1|t,n,void 0,void 0===r?null:r)}function Sa(e,t,n,r){var i=sa();r=void 0===r?null:r;var o=void 0;if(null!==Zo){var a=Zo.memoizedState;if(o=a.destroy,null!==r&&ia(r,a.deps))return void va(t,n,o,r)}Yo.flags|=e,i.memoizedState=va(1|t,n,o,r)}function ba(e,t){return ya(516,4,e,t)}function wa(e,t){return Sa(516,4,e,t)}function ka(e,t){return Sa(4,2,e,t)}function Ea(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Aa(e,t,n){return n=null!=n?n.concat([e]):null,Sa(4,2,Ea.bind(null,t,e),n)}function Ca(){}function Ia(e,t){var n=sa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ia(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ta(e,t){var n=sa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ia(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function xa(e,t){var n=ji();Wi(98>n?98:n,function(){e(!0)}),Wi(97<n?97:n,function(){var n=Qo.transition;Qo.transition=1;try{e(!1),t()}finally{Qo.transition=n}})}function Ra(e,t,n){var r=cl(),i=ul(e),o={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},a=t.pending;if(null===a?o.next=o:(o.next=a.next,a.next=o),t.pending=o,a=e.alternate,e===Yo||null!==a&&a===Yo)na=ta=!0;else{if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,l=a(s,n);if(o.eagerReducer=a,o.eagerState=l,lr(l,s))return}catch(e){}dl(e,i,r)}}var Oa={readContext:io,useCallback:ra,useContext:ra,useEffect:ra,useImperativeHandle:ra,useLayoutEffect:ra,useMemo:ra,useReducer:ra,useRef:ra,useState:ra,useDebugValue:ra,useDeferredValue:ra,useTransition:ra,useMutableSource:ra,useOpaqueIdentifier:ra,unstable_isNewReconciler:!1},Pa={readContext:io,useCallback:function(e,t){return aa().memoizedState=[e,void 0===t?null:t],e},useContext:io,useEffect:ba,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,ya(4,2,Ea.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ya(4,2,e,t)},useMemo:function(e,t){var n=aa();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=aa();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Ra.bind(null,Yo,e),[r.memoizedState,e]},useRef:ga,useState:ha,useDebugValue:Ca,useDeferredValue:function(e){var t=ha(e),n=t[0],r=t[1];return ba(function(){var t=Qo.transition;Qo.transition=1;try{r(e)}finally{Qo.transition=t}},[e]),n},useTransition:function(){var e=ha(!1),t=e[0];return ga(e=xa.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=aa();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},fa(r,e,t,n)},useOpaqueIdentifier:function(){if(Uo){var e=!1,t=function(e){return{$$typeof:L,toString:e,valueOf:e}}(function(){throw e||(e=!0,n("r:"+(Kr++).toString(36))),Error(a(355))}),n=ha(t)[1];return!(2&Yo.mode)&&(Yo.flags|=516,va(5,function(){n("r:"+(Kr++).toString(36))},void 0,null)),t}return ha(t="r:"+(Kr++).toString(36)),t},unstable_isNewReconciler:!1},Na={readContext:io,useCallback:Ia,useContext:io,useEffect:wa,useImperativeHandle:Aa,useLayoutEffect:ka,useMemo:Ta,useReducer:ca,useRef:ma,useState:function(){return ca(la)},useDebugValue:Ca,useDeferredValue:function(e){var t=ca(la),n=t[0],r=t[1];return wa(function(){var t=Qo.transition;Qo.transition=1;try{r(e)}finally{Qo.transition=t}},[e]),n},useTransition:function(){var e=ca(la)[0];return[ma().current,e]},useMutableSource:pa,useOpaqueIdentifier:function(){return ca(la)[0]},unstable_isNewReconciler:!1},Fa={readContext:io,useCallback:Ia,useContext:io,useEffect:wa,useImperativeHandle:Aa,useLayoutEffect:ka,useMemo:Ta,useReducer:ua,useRef:ma,useState:function(){return ua(la)},useDebugValue:Ca,useDeferredValue:function(e){var t=ua(la),n=t[0],r=t[1];return wa(function(){var t=Qo.transition;Qo.transition=1;try{r(e)}finally{Qo.transition=t}},[e]),n},useTransition:function(){var e=ua(la)[0];return[ma().current,e]},useMutableSource:pa,useOpaqueIdentifier:function(){return ua(la)[0]},unstable_isNewReconciler:!1},Ba=w.ReactCurrentOwner,La=!1;function Da(e,t,n,r){t.child=null===e?Io(t,null,n,r):Co(t,e.child,n,r)}function Ha(e,t,n,r,i){n=n.render;var o=t.ref;return ro(t,i),r=oa(e,t,n,r,o,i),null===e||La?(t.flags|=1,Da(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,ns(e,t,i))}function _a(e,t,n,r,i,o){if(null===e){var a=n.type;return"function"!=typeof a||jl(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Wl(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ma(e,t,a,r,i,o))}return a=e.child,0===(i&o)&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:ur)(i,r)&&e.ref===t.ref)?ns(e,t,o):(t.flags|=1,(e=$l(a,r)).ref=t.ref,e.return=t,t.child=e)}function Ma(e,t,n,r,i,o){if(null!==e&&ur(e.memoizedProps,r)&&e.ref===t.ref){if(La=!1,0===(o&i))return t.lanes=e.lanes,ns(e,t,o);16384&e.flags&&(La=!0)}return ja(e,t,n,r,o)}function Ua(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(4&t.mode){if(!(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},Sl(0,e),null;t.memoizedState={baseLanes:0},Sl(0,null!==o?o.baseLanes:n)}else t.memoizedState={baseLanes:0},Sl(0,n);else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,Sl(0,r);return Da(e,t,i,n),t.child}function za(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function ja(e,t,n,r,i){var o=vi(n)?pi:di.current;return o=hi(t,o),ro(t,i),n=oa(e,t,n,r,o,i),null===e||La?(t.flags|=1,Da(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,ns(e,t,i))}function $a(e,t,n,r,i){if(vi(n)){var o=!0;Si(t)}else o=!1;if(ro(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),yo(t,n,r),bo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=n.contextType;c="object"==typeof c&&null!==c?io(c):hi(t,c=vi(n)?pi:di.current);var u=n.getDerivedStateFromProps,d="function"==typeof u||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||l!==c)&&So(t,a,r,c),oo=!1;var f=t.memoizedState;a.state=f,fo(t,r,a,i),l=t.memoizedState,s!==r||f!==l||fi.current||oo?("function"==typeof u&&(vo(t,n,u,r),l=t.memoizedState),(s=oo||mo(t,n,s,r,f,l,c))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.flags|=4)):("function"==typeof a.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=s):("function"==typeof a.componentDidMount&&(t.flags|=4),r=!1)}else{a=t.stateNode,so(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:Xi(t.type,s),a.props=c,d=t.pendingProps,f=a.context,l="object"==typeof(l=n.contextType)&&null!==l?io(l):hi(t,l=vi(n)?pi:di.current);var p=n.getDerivedStateFromProps;(u="function"==typeof p||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==d||f!==l)&&So(t,a,r,l),oo=!1,f=t.memoizedState,a.state=f,fo(t,r,a,i);var h=t.memoizedState;s!==d||f!==h||fi.current||oo?("function"==typeof p&&(vo(t,n,p,r),h=t.memoizedState),(c=oo||mo(t,n,c,r,f,h,l))?(u||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,h,l),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,h,l)),"function"==typeof a.componentDidUpdate&&(t.flags|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=h),a.props=r,a.state=h,a.context=l,r=c):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=256),r=!1)}return Wa(e,t,n,r,o,i)}function Wa(e,t,n,r,i,o){za(e,t);var a=!!(64&t.flags);if(!r&&!a)return i&&bi(t,n,!1),ns(e,t,o);r=t.stateNode,Ba.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Co(t,e.child,null,o),t.child=Co(t,null,s,o)):Da(e,t,s,o),t.memoizedState=r.state,i&&bi(t,n,!0),t.child}function qa(e){var t=e.stateNode;t.pendingContext?mi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&mi(0,t.context,!1),No(e,t.containerInfo)}var Va,Ga,Ka,Xa,Qa={dehydrated:null,retryLane:0};function Ja(e,t,n){var r,i=t.pendingProps,o=Do.current,a=!1;return(r=!!(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&!!(2&o)),r?(a=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(o|=1),ci(Do,1&o),null===e?(void 0!==i.fallback&&$o(t),e=i.children,o=i.fallback,a?(e=Ya(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Qa,e):"number"==typeof i.unstable_expectedLoadTime?(e=Ya(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Qa,t.lanes=33554432,e):((n=Vl({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,a?(i=function(e,t,n,r,i){var o=t.mode,a=e.child;e=a.sibling;var s={mode:"hidden",children:n};return 2&o||t.child===a?n=$l(a,s):((n=t.child).childLanes=0,n.pendingProps=s,null!==(a=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=a,a.nextEffect=null):t.firstEffect=t.lastEffect=null),null!==e?r=$l(e,r):(r=ql(r,o,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}(e,t,i.children,i.fallback,n),a=t.child,o=e.child.memoizedState,a.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},a.childLanes=e.childLanes&~n,t.memoizedState=Qa,i):(n=function(e,t,n,r){var i=e.child;return e=i.sibling,n=$l(i,{mode:"visible",children:n}),!(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}(e,t,i.children,n),t.memoizedState=null,n))}function Ya(e,t,n,r){var i=e.mode,o=e.child;return t={mode:"hidden",children:t},2&i||null===o?o=Vl(t,i,0,null):(o.childLanes=0,o.pendingProps=t),n=ql(n,i,r,null),o.return=e,n.return=e,o.sibling=n,e.child=o,n}function Za(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),no(e.return,t)}function es(e,t,n,r,i,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i,a.lastEffect=o)}function ts(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Da(e,t,r.children,n),2&(r=Do.current))r=1&r|2,t.flags|=64;else{if(null!==e&&64&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Za(e,n);else if(19===e.tag)Za(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ci(Do,r),2&t.mode)switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Ho(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),es(t,!1,i,n,o,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Ho(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}es(t,!0,n,null,o,t.lastEffect);break;case"together":es(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function ns(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),_s|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=$l(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=$l(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function rs(e,t){if(!Uo)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function is(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return vi(t.type)&&gi(),null;case 3:return Fo(),li(fi),li(di),Ko(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(qo(t)?t.flags|=4:r.hydrate||(t.flags|=256)),Ga(t),null;case 5:Lo(t);var o=Po(Oo.current);if(n=t.type,null!==e&&null!=t.stateNode)Ka(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(a(166));return null}if(e=Po(xo.current),qo(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Qr]=t,r[Jr]=s,n){case"dialog":xr("cancel",r),xr("close",r);break;case"iframe":case"object":case"embed":xr("load",r);break;case"video":case"audio":for(e=0;e<Ar.length;e++)xr(Ar[e],r);break;case"source":xr("error",r);break;case"img":case"image":case"link":xr("error",r),xr("load",r);break;case"details":xr("toggle",r);break;case"input":ee(r,s),xr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},xr("invalid",r);break;case"textarea":le(r,s),xr("invalid",r)}for(var c in Ee(n,s),e=null,s)s.hasOwnProperty(c)&&(o=s[c],"children"===c?"string"==typeof o?r.textContent!==o&&(e=["children",o]):"number"==typeof o&&r.textContent!==""+o&&(e=["children",""+o]):l.hasOwnProperty(c)&&null!=o&&"onScroll"===c&&xr("scroll",r));switch(n){case"input":Q(r),re(r,s,!0);break;case"textarea":Q(r),ue(r);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(r.onclick=_r)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(c=9===o.nodeType?o:o.ownerDocument,e===de&&(e=fe(n)),e===de?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[Qr]=t,e[Jr]=r,Va(e,t,!1,!1),t.stateNode=e,c=Ae(n,r),n){case"dialog":xr("cancel",e),xr("close",e),o=r;break;case"iframe":case"object":case"embed":xr("load",e),o=r;break;case"video":case"audio":for(o=0;o<Ar.length;o++)xr(Ar[o],e);o=r;break;case"source":xr("error",e),o=r;break;case"img":case"image":case"link":xr("error",e),xr("load",e),o=r;break;case"details":xr("toggle",e),o=r;break;case"input":ee(e,r),o=Z(e,r),xr("invalid",e);break;case"option":o=oe(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=i({},r,{value:void 0}),xr("invalid",e);break;case"textarea":le(e,r),o=se(e,r),xr("invalid",e);break;default:o=r}Ee(n,o);var u=o;for(s in u)if(u.hasOwnProperty(s)){var d=u[s];"style"===s?we(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&ge(e,d):"children"===s?"string"==typeof d?("textarea"!==n||""!==d)&&me(e,d):"number"==typeof d&&me(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(l.hasOwnProperty(s)?null!=d&&"onScroll"===s&&xr("scroll",e):null!=d&&b(e,s,d,c))}switch(n){case"input":Q(e),re(e,r,!1);break;case"textarea":Q(e),ue(e);break;case"option":null!=r.value&&e.setAttribute("value",""+K(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ae(e,!!r.multiple,s,!1):null!=r.defaultValue&&ae(e,!!r.multiple,r.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=_r)}zr(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Xa(e,t,e.memoizedProps,r);else{if("string"!=typeof r&&null===t.stateNode)throw Error(a(166));n=Po(Oo.current),Po(xo.current),qo(t)?(r=t.stateNode,n=t.memoizedProps,r[Qr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Qr]=t,t.stateNode=r)}return null;case 13:return li(Do),r=t.memoizedState,64&t.flags?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&qo(t):n=null!==e.memoizedState,r&&!n&&2&t.mode&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||1&Do.current?0===Ls&&(Ls=3):(0!==Ls&&3!==Ls||(Ls=4),null===Os||!(134217727&_s)&&!(134217727&Ms)||vl(Os,Ns))),(r||n)&&(t.flags|=4),null);case 4:return Fo(),Ga(t),null===e&&Or(t.stateNode.containerInfo),null;case 10:return to(t),null;case 19:if(li(Do),null===(r=t.memoizedState))return null;if(s=!!(64&t.flags),null===(c=r.rendering))if(s)rs(r,!1);else{if(0!==Ls||null!==e&&64&e.flags)for(e=t.child;null!==e;){if(null!==(c=Ho(e))){for(t.flags|=64,rs(r,!1),null!==(s=c.updateQueue)&&(t.updateQueue=s,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ci(Do,1&Do.current|2),t.child}e=e.sibling}null!==r.tail&&zi()>$s&&(t.flags|=64,s=!0,rs(r,!1),t.lanes=33554432)}else{if(!s)if(null!==(e=Ho(c))){if(t.flags|=64,s=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),rs(r,!0),null===r.tail&&"hidden"===r.tailMode&&!c.alternate&&!Uo)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*zi()-r.renderingStartTime>$s&&1073741824!==n&&(t.flags|=64,s=!0,rs(r,!1),t.lanes=33554432);r.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=r.last)?n.sibling=c:t.child=c,r.last=c)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=zi(),n.sibling=null,t=Do.current,ci(Do,s?1&t|2:1&t),n):null;case 23:case 24:return bl(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(a(156,t.tag))}function os(e){switch(e.tag){case 1:vi(e.type)&&gi();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Fo(),li(fi),li(di),Ko(),64&(t=e.flags))throw Error(a(285));return e.flags=-4097&t|64,e;case 5:return Lo(e),null;case 13:return li(Do),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return li(Do),null;case 4:return Fo(),null;case 10:return to(e),null;case 23:case 24:return bl(),null;default:return null}}function as(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(e){i="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:i}}function ss(e,t){try{console.error(t.value)}catch(e){setTimeout(function(){throw e})}}Va=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ga=function(){},Ka=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Po(xo.current);var a,s=null;switch(n){case"input":o=Z(e,o),r=Z(e,r),s=[];break;case"option":o=oe(e,o),r=oe(e,r),s=[];break;case"select":o=i({},o,{value:void 0}),r=i({},r,{value:void 0}),s=[];break;case"textarea":o=se(e,o),r=se(e,r),s=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(e.onclick=_r)}for(d in Ee(n,r),n=null,o)if(!r.hasOwnProperty(d)&&o.hasOwnProperty(d)&&null!=o[d])if("style"===d){var c=o[d];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(l.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var u=r[d];if(c=null!=o?o[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(null!=u||null!=c))if("style"===d)if(c){for(a in c)!c.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&c[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(s||(s=[]),s.push(d,n)),n=u;else"dangerouslySetInnerHTML"===d?(u=u?u.__html:void 0,c=c?c.__html:void 0,null!=u&&c!==u&&(s=s||[]).push(d,u)):"children"===d?"string"!=typeof u&&"number"!=typeof u||(s=s||[]).push(d,""+u):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(l.hasOwnProperty(d)?(null!=u&&"onScroll"===d&&xr("scroll",e),s||c===u||(s=[])):"object"==typeof u&&null!==u&&u.$$typeof===L?u.toString():(s=s||[]).push(d,u))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},Xa=function(e,t,n,r){n!==r&&(t.flags|=4)};var ls="function"==typeof WeakMap?WeakMap:Map;function cs(e,t,n){(n=lo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gs||(Gs=!0,Ks=r),ss(0,t)},n}function us(e,t,n){(n=lo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return ss(0,t),r(i)}}var o=e.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){"function"!=typeof r&&(null===Xs?Xs=new Set([this]):Xs.add(this),ss(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var ds="function"==typeof WeakSet?WeakSet:Set;function fs(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){Hl(e,t)}else t.current=null}function ps(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Xi(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&qr(t.stateNode.containerInfo))}throw Error(a(163))}function hs(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(!(3&~e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,4&(i=i.tag)&&1&i&&(Bl(n,e),Fl(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Xi(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&po(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}po(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&zr(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&bt(n)))))}throw Error(a(163))}function vs(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"==typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=null!=i&&i.hasOwnProperty("display")?i.display:null,r.style.display=be("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function gs(e,t){if(ki&&"function"==typeof ki.onCommitFiberUnmount)try{ki.onCommitFiberUnmount(wi,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(4&r)Bl(t,n);else{r=t;try{i()}catch(e){Hl(r,e)}}n=n.next}while(n!==e)}break;case 1:if(fs(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Hl(t,e)}break;case 5:fs(t);break;case 4:ks(e,t)}}function ms(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function ys(e){return 5===e.tag||3===e.tag||4===e.tag}function Ss(e){e:{for(var t=e.return;null!==t;){if(ys(t))break e;t=t.return}throw Error(a(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.flags&&(me(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||ys(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?bs(e,n,t):ws(e,n,t)}function bs(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=_r));else if(4!==r&&null!==(e=e.child))for(bs(e,t,n),e=e.sibling;null!==e;)bs(e,t,n),e=e.sibling}function ws(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ws(e,t,n),e=e.sibling;null!==e;)ws(e,t,n),e=e.sibling}function ks(e,t){for(var n,r,i=t,o=!1;;){if(!o){o=i.return;e:for(;;){if(null===o)throw Error(a(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}o=o.return}o=!0}if(5===i.tag||6===i.tag){e:for(var s=e,l=i,c=l;;)if(gs(s,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===l)break e;for(;null===c.sibling;){if(null===c.return||c.return===l)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}r?(s=n,l=i.stateNode,8===s.nodeType?s.parentNode.removeChild(l):s.removeChild(l)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(gs(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(o=!1)}i.sibling.return=i.return,i=i.sibling}}function Es(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{!(3&~r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[Jr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),Ae(e,i),t=Ae(e,r),i=0;i<o.length;i+=2){var s=o[i],l=o[i+1];"style"===s?we(n,l):"dangerouslySetInnerHTML"===s?ge(n,l):"children"===s?me(n,l):b(n,s,l,t)}switch(e){case"input":ne(n,r);break;case"textarea":ce(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?ae(n,!!r.multiple,o,!1):e!==!!r.multiple&&(null!=r.defaultValue?ae(n,!!r.multiple,r.defaultValue,!0):ae(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(a(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,bt(n.containerInfo)));case 13:return null!==t.memoizedState&&(js=zi(),vs(t.child,!0)),void As(t);case 19:return void As(t);case 23:case 24:return void vs(t,null!==t.memoizedState)}throw Error(a(163))}function As(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ds),t.forEach(function(t){var r=Ml.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function Cs(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&null!==(t=t.memoizedState)&&null===t.dehydrated}var Is=Math.ceil,Ts=w.ReactCurrentDispatcher,xs=w.ReactCurrentOwner,Rs=0,Os=null,Ps=null,Ns=0,Fs=0,Bs=si(0),Ls=0,Ds=null,Hs=0,_s=0,Ms=0,Us=0,zs=null,js=0,$s=1/0;function Ws(){$s=zi()+500}var qs,Vs=null,Gs=!1,Ks=null,Xs=null,Qs=!1,Js=null,Ys=90,Zs=[],el=[],tl=null,nl=0,rl=null,il=-1,ol=0,al=0,sl=null,ll=!1;function cl(){return 48&Rs?zi():-1!==il?il:il=zi()}function ul(e){if(!(2&(e=e.mode)))return 1;if(!(4&e))return 99===ji()?1:2;if(0===ol&&(ol=Hs),0!==Ki.transition){0!==al&&(al=null!==zs?zs.pendingLanes:0),e=ol;var t=4186112&~al;return 0===(t&=-t)&&0==(t=(e=4186112&~e)&-e)&&(t=8192),t}return e=ji(),e=_t(4&Rs&&98===e?12:e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ol)}function dl(e,t,n){if(50<nl)throw nl=0,rl=null,Error(a(185));if(null===(e=fl(e,t)))return null;zt(e,t,n),e===Os&&(Ms|=t,4===Ls&&vl(e,Ns));var r=ji();1===t?8&Rs&&!(48&Rs)?gl(e):(pl(e,n),0===Rs&&(Ws(),Vi())):(!(4&Rs)||98!==r&&99!==r||(null===tl?tl=new Set([e]):tl.add(e)),pl(e,n)),zs=e}function fl(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function pl(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,s=e.pendingLanes;0<s;){var l=31-jt(s),c=1<<l,u=o[l];if(-1===u){if(0===(c&r)||0!==(c&i)){u=t,Lt(c);var d=Bt;o[l]=10<=d?u+250:6<=d?u+5e3:-1}}else u<=t&&(e.expiredLanes|=c);s&=~c}if(r=Dt(e,e===Os?Ns:0),t=Bt,0===r)null!==n&&(n!==Li&&Ci(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Li&&Ci(n)}15===t?(n=gl.bind(null,e),null===Hi?(Hi=[n],_i=Ai(Oi,Gi)):Hi.push(n),n=Li):14===t?n=qi(99,gl.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(a(358,e))}}(t),n=qi(n,hl.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function hl(e){if(il=-1,al=ol=0,48&Rs)throw Error(a(327));var t=e.callbackNode;if(Nl()&&e.callbackNode!==t)return null;var n=Dt(e,e===Os?Ns:0);if(0===n)return null;var r=n,i=Rs;Rs|=16;var o=El();for(Os===e&&Ns===r||(Ws(),wl(e,r));;)try{Il();break}catch(t){kl(e,t)}if(eo(),Ts.current=o,Rs=i,null!==Ps?r=0:(Os=null,Ns=0,r=Ls),0!==(Hs&Ms))wl(e,0);else if(0!==r){if(2===r&&(Rs|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(n=Ht(e))&&(r=Al(e,n))),1===r)throw t=Ds,wl(e,0),vl(e,n),pl(e,zi()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(a(345));case 2:case 5:Rl(e);break;case 3:if(vl(e,n),(62914560&n)===n&&10<(r=js+500-zi())){if(0!==Dt(e,0))break;if(((i=e.suspendedLanes)&n)!==n){cl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=$r(Rl.bind(null,e),r);break}Rl(e);break;case 4:if(vl(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var s=31-jt(n);o=1<<s,(s=r[s])>i&&(i=s),n&=~o}if(n=i,10<(n=(120>(n=zi()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Is(n/1960))-n)){e.timeoutHandle=$r(Rl.bind(null,e),n);break}Rl(e);break;default:throw Error(a(329))}}return pl(e,zi()),e.callbackNode===t?hl.bind(null,e):null}function vl(e,t){for(t&=~Us,t&=~Ms,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-jt(t),r=1<<n;e[n]=-1,t&=~r}}function gl(e){if(48&Rs)throw Error(a(327));if(Nl(),e===Os&&0!==(e.expiredLanes&Ns)){var t=Ns,n=Al(e,t);0!==(Hs&Ms)&&(n=Al(e,t=Dt(e,t)))}else n=Al(e,t=Dt(e,0));if(0!==e.tag&&2===n&&(Rs|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(t=Ht(e))&&(n=Al(e,t))),1===n)throw n=Ds,wl(e,0),vl(e,t),pl(e,zi()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Rl(e),pl(e,zi()),null}function ml(e,t){var n=Rs;Rs|=1;try{return e(t)}finally{0===(Rs=n)&&(Ws(),Vi())}}function yl(e,t){var n=Rs;Rs&=-2,Rs|=8;try{return e(t)}finally{0===(Rs=n)&&(Ws(),Vi())}}function Sl(e,t){ci(Bs,Fs),Fs|=t,Hs|=t}function bl(){Fs=Bs.current,li(Bs)}function wl(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Wr(n)),null!==Ps)for(n=Ps.return;null!==n;){var r=n;switch(r.tag){case 1:null!=(r=r.type.childContextTypes)&&gi();break;case 3:Fo(),li(fi),li(di),Ko();break;case 5:Lo(r);break;case 4:Fo();break;case 13:case 19:li(Do);break;case 10:to(r);break;case 23:case 24:bl()}n=n.return}Os=e,Ps=$l(e.current,null),Ns=Fs=Hs=t,Ls=0,Ds=null,Us=Ms=_s=0}function kl(e,t){for(;;){var n=Ps;try{if(eo(),Xo.current=Oa,ta){for(var r=Yo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ta=!1}if(Jo=0,ea=Zo=Yo=null,na=!1,xs.current=null,null===n||null===n.return){Ls=1,Ds=t,Ps=null;break}e:{var o=e,a=n.return,s=n,l=t;if(t=Ns,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l;if(!(2&s.mode)){var u=s.alternate;u?(s.updateQueue=u.updateQueue,s.memoizedState=u.memoizedState,s.lanes=u.lanes):(s.updateQueue=null,s.memoizedState=null)}var d=!!(1&Do.current),f=a;do{var p;if(p=13===f.tag){var h=f.memoizedState;if(null!==h)p=null!==h.dehydrated;else{var v=f.memoizedProps;p=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!d)}}if(p){var g=f.updateQueue;if(null===g){var m=new Set;m.add(c),f.updateQueue=m}else g.add(c);if(!(2&f.mode)){if(f.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=lo(-1,1);y.tag=2,co(s,y)}s.lanes|=1;break e}l=void 0,s=t;var S=o.pingCache;if(null===S?(S=o.pingCache=new ls,l=new Set,S.set(c,l)):void 0===(l=S.get(c))&&(l=new Set,S.set(c,l)),!l.has(s)){l.add(s);var b=_l.bind(null,o,c,s);c.then(b,b)}f.flags|=4096,f.lanes=t;break e}f=f.return}while(null!==f);l=Error((G(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Ls&&(Ls=2),l=as(l,s),f=a;do{switch(f.tag){case 3:o=l,f.flags|=4096,t&=-t,f.lanes|=t,uo(f,cs(0,o,t));break e;case 1:o=l;var w=f.type,k=f.stateNode;if(!(64&f.flags||"function"!=typeof w.getDerivedStateFromError&&(null===k||"function"!=typeof k.componentDidCatch||null!==Xs&&Xs.has(k)))){f.flags|=4096,t&=-t,f.lanes|=t,uo(f,us(f,o,t));break e}}f=f.return}while(null!==f)}xl(n)}catch(e){t=e,Ps===n&&null!==n&&(Ps=n=n.return);continue}break}}function El(){var e=Ts.current;return Ts.current=Oa,null===e?Oa:e}function Al(e,t){var n=Rs;Rs|=16;var r=El();for(Os===e&&Ns===t||wl(e,t);;)try{Cl();break}catch(t){kl(e,t)}if(eo(),Rs=n,Ts.current=r,null!==Ps)throw Error(a(261));return Os=null,Ns=0,Ls}function Cl(){for(;null!==Ps;)Tl(Ps)}function Il(){for(;null!==Ps&&!Ii();)Tl(Ps)}function Tl(e){var t=qs(e.alternate,e,Fs);e.memoizedProps=e.pendingProps,null===t?xl(e):Ps=t,xs.current=null}function xl(e){var t=e;do{var n=t.alternate;if(e=t.return,2048&t.flags){if(null!==(n=os(t)))return n.flags&=2047,void(Ps=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}else{if(null!==(n=is(n,t,Fs)))return void(Ps=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||1073741824&Fs||!(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&!(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}if(null!==(t=t.sibling))return void(Ps=t);Ps=t=e}while(null!==t);0===Ls&&(Ls=5)}function Rl(e){var t=ji();return Wi(99,Ol.bind(null,e,t)),null}function Ol(e,t){do{Nl()}while(null!==Js);if(48&Rs)throw Error(a(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,o=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var s=e.eventTimes,l=e.expirationTimes;0<o;){var c=31-jt(o),u=1<<c;i[c]=0,s[c]=-1,l[c]=-1,o&=~u}if(null!==tl&&!(24&r)&&tl.has(e)&&tl.delete(e),e===Os&&(Ps=Os=null,Ns=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=Rs,Rs|=32,xs.current=null,Mr=Gt,vr(s=hr())){if("selectionStart"in s)l={start:s.selectionStart,end:s.selectionEnd};else e:if(l=(l=s.ownerDocument)&&l.defaultView||window,(u=l.getSelection&&l.getSelection())&&0!==u.rangeCount){l=u.anchorNode,o=u.anchorOffset,c=u.focusNode,u=u.focusOffset;try{l.nodeType,c.nodeType}catch(e){l=null;break e}var d=0,f=-1,p=-1,h=0,v=0,g=s,m=null;t:for(;;){for(var y;g!==l||0!==o&&3!==g.nodeType||(f=d+o),g!==c||0!==u&&3!==g.nodeType||(p=d+u),3===g.nodeType&&(d+=g.nodeValue.length),null!==(y=g.firstChild);)m=g,g=y;for(;;){if(g===s)break t;if(m===l&&++h===o&&(f=d),m===c&&++v===u&&(p=d),null!==(y=g.nextSibling))break;m=(g=m).parentNode}g=y}l=-1===f||-1===p?null:{start:f,end:p}}else l=null;l=l||{start:0,end:0}}else l=null;Ur={focusedElem:s,selectionRange:l},Gt=!1,sl=null,ll=!1,Vs=r;do{try{Pl()}catch(e){if(null===Vs)throw Error(a(330));Hl(Vs,e),Vs=Vs.nextEffect}}while(null!==Vs);sl=null,Vs=r;do{try{for(s=e;null!==Vs;){var S=Vs.flags;if(16&S&&me(Vs.stateNode,""),128&S){var b=Vs.alternate;if(null!==b){var w=b.ref;null!==w&&("function"==typeof w?w(null):w.current=null)}}switch(1038&S){case 2:Ss(Vs),Vs.flags&=-3;break;case 6:Ss(Vs),Vs.flags&=-3,Es(Vs.alternate,Vs);break;case 1024:Vs.flags&=-1025;break;case 1028:Vs.flags&=-1025,Es(Vs.alternate,Vs);break;case 4:Es(Vs.alternate,Vs);break;case 8:ks(s,l=Vs);var k=l.alternate;ms(l),null!==k&&ms(k)}Vs=Vs.nextEffect}}catch(e){if(null===Vs)throw Error(a(330));Hl(Vs,e),Vs=Vs.nextEffect}}while(null!==Vs);if(w=Ur,b=hr(),S=w.focusedElem,s=w.selectionRange,b!==S&&S&&S.ownerDocument&&pr(S.ownerDocument.documentElement,S)){null!==s&&vr(S)&&(b=s.start,void 0===(w=s.end)&&(w=b),"selectionStart"in S?(S.selectionStart=b,S.selectionEnd=Math.min(w,S.value.length)):(w=(b=S.ownerDocument||document)&&b.defaultView||window).getSelection&&(w=w.getSelection(),l=S.textContent.length,k=Math.min(s.start,l),s=void 0===s.end?k:Math.min(s.end,l),!w.extend&&k>s&&(l=s,s=k,k=l),l=fr(S,k),o=fr(S,s),l&&o&&(1!==w.rangeCount||w.anchorNode!==l.node||w.anchorOffset!==l.offset||w.focusNode!==o.node||w.focusOffset!==o.offset)&&((b=b.createRange()).setStart(l.node,l.offset),w.removeAllRanges(),k>s?(w.addRange(b),w.extend(o.node,o.offset)):(b.setEnd(o.node,o.offset),w.addRange(b))))),b=[];for(w=S;w=w.parentNode;)1===w.nodeType&&b.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"==typeof S.focus&&S.focus(),S=0;S<b.length;S++)(w=b[S]).element.scrollLeft=w.left,w.element.scrollTop=w.top}Gt=!!Mr,Ur=Mr=null,e.current=n,Vs=r;do{try{for(S=e;null!==Vs;){var E=Vs.flags;if(36&E&&hs(S,Vs.alternate,Vs),128&E){b=void 0;var A=Vs.ref;if(null!==A){var C=Vs.stateNode;Vs.tag,b=C,"function"==typeof A?A(b):A.current=b}}Vs=Vs.nextEffect}}catch(e){if(null===Vs)throw Error(a(330));Hl(Vs,e),Vs=Vs.nextEffect}}while(null!==Vs);Vs=null,Di(),Rs=i}else e.current=n;if(Qs)Qs=!1,Js=e,Ys=t;else for(Vs=r;null!==Vs;)t=Vs.nextEffect,Vs.nextEffect=null,8&Vs.flags&&((E=Vs).sibling=null,E.stateNode=null),Vs=t;if(0===(r=e.pendingLanes)&&(Xs=null),1===r?e===rl?nl++:(nl=0,rl=e):nl=0,n=n.stateNode,ki&&"function"==typeof ki.onCommitFiberRoot)try{ki.onCommitFiberRoot(wi,n,void 0,!(64&~n.current.flags))}catch(e){}if(pl(e,zi()),Gs)throw Gs=!1,e=Ks,Ks=null,e;return 8&Rs||Vi(),null}function Pl(){for(;null!==Vs;){var e=Vs.alternate;ll||null===sl||(8&Vs.flags?Ye(Vs,sl)&&(ll=!0):13===Vs.tag&&Cs(e,Vs)&&Ye(Vs,sl)&&(ll=!0));var t=Vs.flags;256&t&&ps(e,Vs),!(512&t)||Qs||(Qs=!0,qi(97,function(){return Nl(),null})),Vs=Vs.nextEffect}}function Nl(){if(90!==Ys){var e=97<Ys?97:Ys;return Ys=90,Wi(e,Ll)}return!1}function Fl(e,t){Zs.push(t,e),Qs||(Qs=!0,qi(97,function(){return Nl(),null}))}function Bl(e,t){el.push(t,e),Qs||(Qs=!0,qi(97,function(){return Nl(),null}))}function Ll(){if(null===Js)return!1;var e=Js;if(Js=null,48&Rs)throw Error(a(331));var t=Rs;Rs|=32;var n=el;el=[];for(var r=0;r<n.length;r+=2){var i=n[r],o=n[r+1],s=i.destroy;if(i.destroy=void 0,"function"==typeof s)try{s()}catch(e){if(null===o)throw Error(a(330));Hl(o,e)}}for(n=Zs,Zs=[],r=0;r<n.length;r+=2){i=n[r],o=n[r+1];try{var l=i.create;i.destroy=l()}catch(e){if(null===o)throw Error(a(330));Hl(o,e)}}for(l=e.current.firstEffect;null!==l;)e=l.nextEffect,l.nextEffect=null,8&l.flags&&(l.sibling=null,l.stateNode=null),l=e;return Rs=t,Vi(),!0}function Dl(e,t,n){co(e,t=cs(0,t=as(n,t),1)),t=cl(),null!==(e=fl(e,1))&&(zt(e,1,t),pl(e,t))}function Hl(e,t){if(3===e.tag)Dl(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Dl(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Xs||!Xs.has(r))){var i=us(n,e=as(t,e),1);if(co(n,i),i=cl(),null!==(n=fl(n,1)))zt(n,1,i),pl(n,i);else if("function"==typeof r.componentDidCatch&&(null===Xs||!Xs.has(r)))try{r.componentDidCatch(t,e)}catch(e){}break}}n=n.return}}function _l(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=cl(),e.pingedLanes|=e.suspendedLanes&n,Os===e&&(Ns&n)===n&&(4===Ls||3===Ls&&(62914560&Ns)===Ns&&500>zi()-js?wl(e,0):Us|=n),pl(e,t)}function Ml(e,t){var n=e.stateNode;null!==n&&n.delete(t),0==(t=0)&&(2&(t=e.mode)?4&t?(0===ol&&(ol=Hs),0===(t=Mt(62914560&~ol))&&(t=4194304)):t=99===ji()?1:2:t=1),n=cl(),null!==(e=fl(e,t))&&(zt(e,t,n),pl(e,n))}function Ul(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function zl(e,t,n,r){return new Ul(e,t,n,r)}function jl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function $l(e,t){var n=e.alternate;return null===n?((n=zl(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Wl(e,t,n,r,i,o){var s=2;if(r=e,"function"==typeof e)jl(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case A:return ql(n.children,i,o,t);case D:s=8,i|=16;break;case C:s=8,i|=1;break;case I:return(e=zl(12,n,t,8|i)).elementType=I,e.type=I,e.lanes=o,e;case O:return(e=zl(13,n,t,i)).type=O,e.elementType=O,e.lanes=o,e;case P:return(e=zl(19,n,t,i)).elementType=P,e.lanes=o,e;case H:return Vl(n,i,o,t);case _:return(e=zl(24,n,t,i)).elementType=_,e.lanes=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case x:s=9;break e;case R:s=11;break e;case N:s=14;break e;case F:s=16,r=null;break e;case B:s=22;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=zl(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function ql(e,t,n,r){return(e=zl(7,e,r,t)).lanes=n,e}function Vl(e,t,n,r){return(e=zl(23,e,r,t)).elementType=H,e.lanes=n,e}function Gl(e,t,n){return(e=zl(6,e,null,t)).lanes=n,e}function Kl(e,t,n){return(t=zl(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Xl(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ut(0),this.expirationTimes=Ut(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ut(0),this.mutableSourceEagerHydrationData=null}function Ql(e,t,n,r){var i=t.current,o=cl(),s=ul(i);e:if(n){t:{if(Xe(n=n._reactInternals)!==n||1!==n.tag)throw Error(a(170));var l=n;do{switch(l.tag){case 3:l=l.stateNode.context;break t;case 1:if(vi(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}}l=l.return}while(null!==l);throw Error(a(171))}if(1===n.tag){var c=n.type;if(vi(c)){n=yi(n,c,l);break e}}n=l}else n=ui;return null===t.context?t.context=n:t.pendingContext=n,(t=lo(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),co(i,t),dl(i,s,o),s}function Jl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Yl(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Zl(e,t){Yl(e,t),(e=e.alternate)&&Yl(e,t)}function ec(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Xl(e,t,null!=n&&!0===n.hydrate),t=zl(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,ao(t),e[Yr]=n.current,Or(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var i=(t=r[e])._getVersion;i=i(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,i]:n.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=n}function tc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function nc(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"==typeof i){var s=i;i=function(){var e=Jl(a);s.call(e)}}Ql(t,a,e,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new ec(e,0,t?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"==typeof i){var l=i;i=function(){var e=Jl(a);l.call(e)}}yl(function(){Ql(t,a,e,i)})}return Jl(a)}qs=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||fi.current)La=!0;else{if(0===(n&r)){switch(La=!1,t.tag){case 3:qa(t),Vo();break;case 5:Bo(t);break;case 1:vi(t.type)&&Si(t);break;case 4:No(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var i=t.type._context;ci(Qi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?Ja(e,t,n):(ci(Do,1&Do.current),null!==(t=ns(e,t,n))?t.sibling:null);ci(Do,1&Do.current);break;case 19:if(r=0!==(n&t.childLanes),64&e.flags){if(r)return ts(e,t,n);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),ci(Do,Do.current),r)break;return null;case 23:case 24:return t.lanes=0,Ua(e,t,n)}return ns(e,t,n)}La=!!(16384&e.flags)}else La=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=hi(t,di.current),ro(t,n),i=oa(null,t,r,e,i,n),t.flags|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,vi(r)){var o=!0;Si(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ao(t);var s=r.getDerivedStateFromProps;"function"==typeof s&&vo(t,r,s,e),i.updater=go,t.stateNode=i,i._reactInternals=t,bo(t,r,e,n),t=Wa(null,t,r,!0,o,n)}else t.tag=0,Da(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(o=i._init)(i._payload),t.type=i,o=t.tag=function(e){if("function"==typeof e)return jl(e)?1:0;if(null!=e){if((e=e.$$typeof)===R)return 11;if(e===N)return 14}return 2}(i),e=Xi(i,e),o){case 0:t=ja(null,t,i,e,n);break e;case 1:t=$a(null,t,i,e,n);break e;case 11:t=Ha(null,t,i,e,n);break e;case 14:t=_a(null,t,i,Xi(i.type,e),r,n);break e}throw Error(a(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,ja(e,t,r,i=t.elementType===r?i:Xi(r,i),n);case 1:return r=t.type,i=t.pendingProps,$a(e,t,r,i=t.elementType===r?i:Xi(r,i),n);case 3:if(qa(t),r=t.updateQueue,null===e||null===r)throw Error(a(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,so(e,t),fo(t,r,null,n),(r=t.memoizedState.element)===i)Vo(),t=ns(e,t,n);else{if((o=(i=t.stateNode).hydrate)&&(Mo=Vr(t.stateNode.containerInfo.firstChild),_o=t,o=Uo=!0),o){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(o=e[i])._workInProgressVersionPrimary=e[i+1],Go.push(o);for(n=Io(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Da(e,t,r,n),Vo();t=t.child}return t;case 5:return Bo(t),null===e&&$o(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,jr(r,i)?s=null:null!==o&&jr(r,o)&&(t.flags|=16),za(e,t),Da(e,t,s,n),t.child;case 6:return null===e&&$o(t),null;case 13:return Ja(e,t,n);case 4:return No(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Co(t,null,r,n):Da(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ha(e,t,r,i=t.elementType===r?i:Xi(r,i),n);case 7:return Da(e,t,t.pendingProps,n),t.child;case 8:case 12:return Da(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value;var l=t.type._context;if(ci(Qi,l._currentValue),l._currentValue=o,null!==s)if(l=s.value,0==(o=lr(l,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(l,o):1073741823))){if(s.children===i.children&&!fi.current){t=ns(e,t,n);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var c=l.dependencies;if(null!==c){s=l.child;for(var u=c.firstContext;null!==u;){if(u.context===r&&0!==(u.observedBits&o)){1===l.tag&&((u=lo(-1,n&-n)).tag=2,co(l,u)),l.lanes|=n,null!==(u=l.alternate)&&(u.lanes|=n),no(l.return,n),c.lanes|=n;break}u=u.next}}else s=10===l.tag&&l.type===t.type?null:l.child;if(null!==s)s.return=l;else for(s=l;null!==s;){if(s===t){s=null;break}if(null!==(l=s.sibling)){l.return=s.return,s=l;break}s=s.return}l=s}Da(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,ro(t,n),r=r(i=io(i,o.unstable_observedBits)),t.flags|=1,Da(e,t,r,n),t.child;case 14:return o=Xi(i=t.type,t.pendingProps),_a(e,t,i,o=Xi(i.type,o),r,n);case 15:return Ma(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Xi(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,vi(r)?(e=!0,Si(t)):e=!1,ro(t,n),yo(t,r,i),bo(t,r,i,n),Wa(null,t,r,!0,e,n);case 19:return ts(e,t,n);case 23:case 24:return Ua(e,t,n)}throw Error(a(156,t.tag))},ec.prototype.render=function(e){Ql(e,this._internalRoot,null,null)},ec.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Ql(null,e,null,function(){t[Yr]=null})},Ze=function(e){13===e.tag&&(dl(e,4,cl()),Zl(e,4))},et=function(e){13===e.tag&&(dl(e,67108864,cl()),Zl(e,67108864))},tt=function(e){if(13===e.tag){var t=cl(),n=ul(e);dl(e,n,t),Zl(e,n)}},nt=function(e,t){return t()},Ie=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ri(r);if(!i)throw Error(a(90));J(r),ne(r,i)}}}break;case"textarea":ce(e,n);break;case"select":null!=(t=n.value)&&ae(e,!!n.multiple,t,!1)}},Ne=ml,Fe=function(e,t,n,r,i){var o=Rs;Rs|=4;try{return Wi(98,e.bind(null,t,n,r,i))}finally{0===(Rs=o)&&(Ws(),Vi())}},Be=function(){!(49&Rs)&&(function(){if(null!==tl){var e=tl;tl=null,e.forEach(function(e){e.expiredLanes|=24&e.pendingLanes,pl(e,zi())})}Vi()}(),Nl())},Le=function(e,t){var n=Rs;Rs|=2;try{return e(t)}finally{0===(Rs=n)&&(Ws(),Vi())}};var rc={findFiberByHostInstance:ei,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},ic={bundleType:rc.bundleType,version:rc.version,rendererPackageName:rc.rendererPackageName,rendererConfig:rc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=function(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Xe(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Je(i),e;if(o===r)return Je(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}(e))?null:e.stateNode},findFiberByHostInstance:rc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{wi=oc.inject(ic),ki=oc}catch(ve){}}t.render=function(e,t,n){if(!tc(t))throw Error(a(200));return nc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!tc(e))throw Error(a(40));return!!e._reactRootContainer&&(yl(function(){nc(null,null,e,!1,function(){e._reactRootContainer=null,e[Yr]=null})}),!0)},t.unstable_batchedUpdates=ml},1948:(e,t,n)=>{"use strict";const r=n(6242);e.exports=(e,t)=>new r(e,t).major},1949:(e,t,n)=>{"use strict";const r=n(6242),i=n(2966),{ANY:o}=i,a=n(8713),s=n(6476),l=n(3050),c=n(813),u=n(926),d=n(6179);e.exports=(e,t,n,f)=>{let p,h,v,g,m;switch(e=new r(e,f),t=new a(t,f),n){case">":p=l,h=u,v=c,g=">",m=">=";break;case"<":p=c,h=d,v=l,g="<",m="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,f))return!1;for(let n=0;n<t.set.length;++n){const r=t.set[n];let a=null,s=null;if(r.forEach(e=>{e.semver===o&&(e=new i(">=0.0.0")),a=a||e,s=s||e,p(e.semver,a.semver,f)?a=e:v(e.semver,s.semver,f)&&(s=e)}),a.operator===g||a.operator===m)return!1;if((!s.operator||s.operator===g)&&h(e,s.semver))return!1;if(s.operator===m&&v(e,s.semver))return!1}return!0}},2236:(e,t,n)=>{"use strict";const r=n(6242),i=n(8713);e.exports=(e,t,n)=>{let o=null,a=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(o&&1!==a.compare(e)||(o=e,a=new r(o,n)))}),o}},2295:(e,t,n)=>{"use strict";const r=n(6242);e.exports=(e,t)=>new r(e,t).patch},2966:(e,t,n)=>{"use strict";const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(e,t){if(t=o(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),c("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(e){const t=this.options.loose?a[s.COMPARATORLOOSE]:a[s.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new u(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(c("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new d(e.value,t).test(this.value):""===e.operator?""===e.value||new d(this.value,t).test(e.semver):!((t=o(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(l(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(l(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=i;const o=n(4633),{safeRe:a,t:s}=n(9348),l=n(4793),c=n(670),u=n(6242),d=n(8713)},3050:(e,t,n)=>{"use strict";const r=n(690);e.exports=(e,t,n)=>r(e,t,n)>0},3056:(e,t,n)=>{"use strict";const r=n(8713);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},3780:(e,t,n)=>{"use strict";const r=n(690);e.exports=(e,t,n)=>r(t,e,n)},3872:(e,t)=>{"use strict";if("function"==typeof Symbol&&Symbol.for){var n=Symbol.for;n("react.element"),n("react.portal"),n("react.fragment"),n("react.strict_mode"),n("react.profiler"),n("react.provider"),n("react.context"),n("react.forward_ref"),n("react.suspense"),n("react.suspense_list"),n("react.memo"),n("react.lazy"),n("react.block"),n("react.server.block"),n("react.fundamental"),n("react.debug_trace_mode"),n("react.legacy_hidden")}},3894:(e,t,n)=>{"use strict";var r=n(4600),i=60103,o=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var a=60109,s=60110,l=60112;t.Suspense=60113;var c=60115,u=60116;if("function"==typeof Symbol&&Symbol.for){var d=Symbol.for;i=d("react.element"),o=d("react.portal"),t.Fragment=d("react.fragment"),t.StrictMode=d("react.strict_mode"),t.Profiler=d("react.profiler"),a=d("react.provider"),s=d("react.context"),l=d("react.forward_ref"),t.Suspense=d("react.suspense"),c=d("react.memo"),u=d("react.lazy")}var f="function"==typeof Symbol&&Symbol.iterator;function p(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v={};function g(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||h}function m(){}function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||h}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(p(85));this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},m.prototype=g.prototype;var S=y.prototype=new m;S.constructor=y,r(S,g.prototype),S.isPureReactComponent=!0;var b={current:null},w=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,n){var r,o={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)w.call(t,r)&&!k.hasOwnProperty(r)&&(o[r]=t[r]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:i,type:e,key:a,ref:s,props:o,_owner:b.current}}function A(e){return"object"==typeof e&&null!==e&&e.$$typeof===i}var C=/\/+/g;function I(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function T(e,t,n,r,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case i:case o:l=!0}}if(l)return a=a(l=e),e=""===r?"."+I(l,0):r,Array.isArray(a)?(n="",null!=e&&(n=e.replace(C,"$&/")+"/"),T(a,t,n,"",function(e){return e})):null!=a&&(A(a)&&(a=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(C,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var u=r+I(s=e[c],c);l+=T(s,t,n,u,a)}else if(u=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"==typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=T(s=s.value,t,n,u=r+I(s,c++),a);else if("object"===s)throw t=""+e,Error(p(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return l}function x(e,t,n){if(null==e)return e;var r=[],i=0;return T(e,r,"","",function(e){return t.call(n,e,i++)}),r}function R(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then(function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)},function(t){0===e._status&&(e._status=2,e._result=t)})}if(1===e._status)return e._result;throw e._result}var O={current:null};function P(){var e=O.current;if(null===e)throw Error(p(321));return e}var N={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:x,forEach:function(e,t,n){x(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return x(e,function(){t++}),t},toArray:function(e){return x(e,function(e){return e})||[]},only:function(e){if(!A(e))throw Error(p(143));return e}},t.Component=g,t.PureComponent=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.cloneElement=function(e,t,n){if(null==e)throw Error(p(267,e));var o=r({},e.props),a=e.key,s=e.ref,l=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,l=b.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)w.call(t,u)&&!k.hasOwnProperty(u)&&(o[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)o.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];o.children=c}return{$$typeof:i,type:e.type,key:a,ref:s,props:o,_owner:l}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:R}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return P().useCallback(e,t)},t.useContext=function(e,t){return P().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return P().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return P().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return P().useLayoutEffect(e,t)},t.useMemo=function(e,t){return P().useMemo(e,t)},t.useReducer=function(e,t,n){return P().useReducer(e,t,n)},t.useRef=function(e){return P().useRef(e)},t.useState=function(e){return P().useState(e)},t.version="17.0.2"},3916:(e,t,n)=>{"use strict";n(3872)},3932:(e,t,n)=>{"use strict";const r=n(5702);e.exports=(e,t)=>{const n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},3947:(e,t,n)=>{"use strict";const r=n(883);e.exports=(e,t)=>e.sort((e,n)=>r(n,e,t))},3987:(e,t,n)=>{"use strict";const r=n(6476),i=n(690);e.exports=(e,t,n)=>{const o=[];let a=null,s=null;const l=e.sort((e,t)=>i(e,t,n));for(const e of l)r(e,t,n)?(s=e,a||(a=e)):(s&&o.push([a,s]),s=null,a=null);a&&o.push([a,null]);const c=[];for(const[e,t]of o)e===t?c.push(e):t||e!==l[0]?t?e===l[0]?c.push(`<=${t}`):c.push(`${e} - ${t}`):c.push(`>=${e}`):c.push("*");const u=c.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return u.length<d.length?u:t}},4415:(e,t,n)=>{"use strict";const r=n(5702);e.exports=(e,t)=>{const n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},4457:e=>{"use strict";const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},4577:e=>{"use strict";e.exports={rE:"5.4.0"}},4600:e=>{"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,i){for(var o,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))n.call(o,c)&&(s[c]=o[c]);if(t){a=t(o);for(var u=0;u<a.length;u++)r.call(o,a[u])&&(s[a[u]]=o[a[u]])}}return s}},4633:e=>{"use strict";const t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:n},4638:(e,t,n)=>{"use strict";!function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=n(1754)},4651:(e,t,n)=>{"use strict";const r=n(690);e.exports=(e,t,n)=>0===r(e,t,n)},4793:(e,t,n)=>{"use strict";const r=n(4651),i=n(7241),o=n(3050),a=n(6179),s=n(813),l=n(926);e.exports=(e,t,n,c)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,c);case"!=":return i(e,n,c);case">":return o(e,n,c);case">=":return a(e,n,c);case"<":return s(e,n,c);case"<=":return l(e,n,c);default:throw new TypeError(`Invalid operator: ${t}`)}}},5003:(e,t,n)=>{"use strict";const r=n(5702);e.exports=(e,t)=>{const n=r(e,t);return n?n.version:null}},5437:(e,t,n)=>{"use strict";const r=n(6242);e.exports=(e,t,n,i,o)=>{"string"==typeof n&&(o=i,i=n,n=void 0);try{return new r(e instanceof r?e.version:e,n).inc(t,i,o).version}catch(e){return null}}},5702:(e,t,n)=>{"use strict";const r=n(6242);e.exports=(e,t,n=!1)=>{if(e instanceof r)return e;try{return new r(e,t)}catch(e){if(!n)return null;throw e}}},6031:(e,t)=>{t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?i-1:0,f=n?-1:1,p=e[t+d];for(d+=f,o=p&(1<<-u)-1,p>>=-u,u+=s;u>0;o=256*o+e[t+d],d+=f,u-=8);for(a=o&(1<<-u)-1,o>>=-u,u+=r;u>0;a=256*a+e[t+d],d+=f,u-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,l,c=8*o-i-1,u=(1<<c)-1,d=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+d>=1?f/l:f*Math.pow(2,1-d))*l>=2&&(a++,l/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*l-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&s,p+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+p]=255&a,p+=h,a/=256,c-=8);e[n+p-h]|=128*v}},6179:(e,t,n)=>{"use strict";const r=n(690);e.exports=(e,t,n)=>r(e,t,n)>=0},6193:(e,t,n)=>{"use strict";const r=n(8713);e.exports=(e,t)=>new r(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},6242:(e,t,n)=>{"use strict";const r=n(670),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(6760),{safeRe:a,t:s}=n(9348),l=n(4633),{compareIdentifiers:c}=n(4457);class u{constructor(e,t){if(t=l(t),e instanceof u){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?a[s.LOOSE]:a[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof u)){if("string"==typeof e&&e===this.version)return 0;e=new u(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof u||(e=new u(e,this.options)),c(this.major,e.major)||c(this.minor,e.minor)||c(this.patch,e.patch)}comparePre(e){if(e instanceof u||(e=new u(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}compareBuild(e){e instanceof u||(e=new u(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(t){const e=`-${t}`.match(this.options.loose?a[s.PRERELEASELOOSE]:a[s.PRERELEASE]);if(!e||e[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===c(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=u},6476:(e,t,n)=>{"use strict";const r=n(8713);e.exports=(e,t,n)=>{try{t=new r(t,n)}catch(e){return!1}return t.test(e)}},6496:(e,t,n)=>{"use strict";const r=n(6242);e.exports=(e,t)=>new r(e,t).minor},6760:e=>{"use strict";const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},6996:(e,t,n)=>{"use strict";const r=n(6242),i=n(5702),{safeRe:o,t:a}=n(9348);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){const r=t.includePrerelease?o[a.COERCERTLFULL]:o[a.COERCERTL];let i;for(;(i=r.exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),r.lastIndex=i.index+i[1].length+i[2].length;r.lastIndex=-1}else n=e.match(t.includePrerelease?o[a.COERCEFULL]:o[a.COERCE]);if(null===n)return null;const s=n[2],l=n[3]||"0",c=n[4]||"0",u=t.includePrerelease&&n[5]?`-${n[5]}`:"",d=t.includePrerelease&&n[6]?`+${n[6]}`:"";return i(`${s}.${l}.${c}${u}${d}`,t)}},7010:(e,t,n)=>{"use strict";const r=n(8713),i=n(2966),{ANY:o}=i,a=n(6476),s=n(690),l=[new i(">=0.0.0-0")],c=[new i(">=0.0.0")],u=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=n.includePrerelease?l:c}if(1===t.length&&t[0].semver===o){if(n.includePrerelease)return!0;t=c}const r=new Set;let i,u,p,h,v,g,m;for(const t of e)">"===t.operator||">="===t.operator?i=d(i,t,n):"<"===t.operator||"<="===t.operator?u=f(u,t,n):r.add(t.semver);if(r.size>1)return null;if(i&&u){if(p=s(i.semver,u.semver,n),p>0)return null;if(0===p&&(">="!==i.operator||"<="!==u.operator))return null}for(const e of r){if(i&&!a(e,String(i),n))return null;if(u&&!a(e,String(u),n))return null;for(const r of t)if(!a(e,String(r),n))return!1;return!0}let y=!(!u||n.includePrerelease||!u.semver.prerelease.length)&&u.semver,S=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver;y&&1===y.prerelease.length&&"<"===u.operator&&0===y.prerelease[0]&&(y=!1);for(const e of t){if(m=m||">"===e.operator||">="===e.operator,g=g||"<"===e.operator||"<="===e.operator,i)if(S&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===S.major&&e.semver.minor===S.minor&&e.semver.patch===S.patch&&(S=!1),">"===e.operator||">="===e.operator){if(h=d(i,e,n),h===e&&h!==i)return!1}else if(">="===i.operator&&!a(i.semver,String(e),n))return!1;if(u)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),"<"===e.operator||"<="===e.operator){if(v=f(u,e,n),v===e&&v!==u)return!1}else if("<="===u.operator&&!a(u.semver,String(e),n))return!1;if(!e.operator&&(u||i)&&0!==p)return!1}return!(i&&g&&!u&&0!==p||u&&m&&!i&&0!==p||S||y)},d=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},f=(e,t,n)=>{if(!e)return t;const r=s(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new r(e,n),t=new r(t,n);let i=!1;e:for(const r of e.set){for(const e of t.set){const t=u(r,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},7217:(e,t,n)=>{"use strict";const r=n(690);e.exports=(e,t)=>r(e,t,!0)},7241:(e,t,n)=>{"use strict";const r=n(690);e.exports=(e,t,n)=>0!==r(e,t,n)},7503:(e,t,n)=>{"use strict";e.exports=n(9717)},7960:e=>{"use strict";e.exports=class{constructor(){this.max=1e3,this.map=new Map}get(e){const t=this.map.get(e);return void 0===t?void 0:(this.map.delete(e),this.map.set(e,t),t)}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&void 0!==t){if(this.map.size>=this.max){const e=this.map.keys().next().value;this.delete(e)}this.map.set(e,t)}return this}}},8234:(e,t,n)=>{"use strict";const r=n(5702);e.exports=(e,t)=>{const n=r(e,null,!0),i=r(t,null,!0),o=n.compare(i);if(0===o)return null;const a=o>0,s=a?n:i,l=a?i:n,c=!!s.prerelease.length;if(l.prerelease.length&&!c){if(!l.patch&&!l.minor)return"major";if(0===l.compareMain(s))return l.minor&&!l.patch?"minor":"patch"}const u=c?"pre":"";return n.major!==i.major?u+"major":n.minor!==i.minor?u+"minor":n.patch!==i.patch?u+"patch":"prerelease"}},8365:(e,t)=>{"use strict";var n,r,i,o;if("object"==typeof performance&&"function"==typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var c=null,u=null,d=function(){if(null!==c)try{var e=t.unstable_now();c(!0,e),c=null}catch(e){throw setTimeout(d,0),e}};n=function(e){null!==c?setTimeout(n,0,e):(c=e,setTimeout(d,0))},r=function(e,t){u=setTimeout(e,t)},i=function(){clearTimeout(u)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!=typeof console){var h=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof h&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var v=!1,g=null,m=-1,y=5,S=0;t.unstable_shouldYield=function(){return t.unstable_now()>=S},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<e?Math.floor(1e3/e):5};var b=new MessageChannel,w=b.port2;b.port1.onmessage=function(){if(null!==g){var e=t.unstable_now();S=e+y;try{g(!0,e)?w.postMessage(null):(v=!1,g=null)}catch(e){throw w.postMessage(null),e}}else v=!1},n=function(e){g=e,v||(v=!0,w.postMessage(null))},r=function(e,n){m=f(function(){e(t.unstable_now())},n)},i=function(){p(m),m=-1}}function k(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<C(i,t)))break e;e[r]=t,e[n]=i,n=r}}function E(e){return void 0===(e=e[0])?null:e}function A(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var o=2*(r+1)-1,a=e[o],s=o+1,l=e[s];if(void 0!==a&&0>C(a,n))void 0!==l&&0>C(l,a)?(e[r]=l,e[s]=n,r=s):(e[r]=a,e[o]=n,r=o);else{if(!(void 0!==l&&0>C(l,n)))break e;e[r]=l,e[s]=n,r=s}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var I=[],T=[],x=1,R=null,O=3,P=!1,N=!1,F=!1;function B(e){for(var t=E(T);null!==t;){if(null===t.callback)A(T);else{if(!(t.startTime<=e))break;A(T),t.sortIndex=t.expirationTime,k(I,t)}t=E(T)}}function L(e){if(F=!1,B(e),!N)if(null!==E(I))N=!0,n(D);else{var t=E(T);null!==t&&r(L,t.startTime-e)}}function D(e,n){N=!1,F&&(F=!1,i()),P=!0;var o=O;try{for(B(n),R=E(I);null!==R&&(!(R.expirationTime>n)||e&&!t.unstable_shouldYield());){var a=R.callback;if("function"==typeof a){R.callback=null,O=R.priorityLevel;var s=a(R.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?R.callback=s:R===E(I)&&A(I),B(n)}else A(I);R=E(I)}if(null!==R)var l=!0;else{var c=E(T);null!==c&&r(L,c.startTime-n),l=!1}return l}finally{R=null,O=o,P=!1}}var H=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){N||P||(N=!0,n(D))},t.unstable_getCurrentPriorityLevel=function(){return O},t.unstable_getFirstCallbackNode=function(){return E(I)},t.unstable_next=function(e){switch(O){case 1:case 2:case 3:var t=3;break;default:t=O}var n=O;O=t;try{return e()}finally{O=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=H,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=O;O=e;try{return t()}finally{O=n}},t.unstable_scheduleCallback=function(e,o,a){var s=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:x++,callback:o,priorityLevel:e,startTime:a,expirationTime:l=a+l,sortIndex:-1},a>s?(e.sortIndex=a,k(T,e),null===E(I)&&e===E(T)&&(F?i():F=!0,r(L,a-s))):(e.sortIndex=l,k(I,e),N||P||(N=!0,n(D))),e},t.unstable_wrapCallback=function(e){var t=O;return function(){var n=O;O=t;try{return e.apply(this,arguments)}finally{O=n}}}},8713:(e,t,n)=>{"use strict";const r=/\s+/g;class i{constructor(e,t){if(t=a(t),e instanceof i)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new i(e.raw,t);if(e instanceof s)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(r," "),this.set=this.raw.split("||").map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!m(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&y(e[0])){this.set=[e];break}}this.formatted=void 0}get range(){if(void 0===this.formatted){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");const t=this.set[e];for(let e=0;e<t.length;e++)e>0&&(this.formatted+=" "),this.formatted+=t[e].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&v)|(this.options.loose&&g))+":"+e,n=o.get(t);if(n)return n;const r=this.options.loose,i=r?u[d.HYPHENRANGELOOSE]:u[d.HYPHENRANGE];e=e.replace(i,O(this.options.includePrerelease)),l("hyphen replace",e),e=e.replace(u[d.COMPARATORTRIM],f),l("comparator trim",e),e=e.replace(u[d.TILDETRIM],p),l("tilde trim",e),e=e.replace(u[d.CARETTRIM],h),l("caret trim",e);let a=e.split(" ").map(e=>b(e,this.options)).join(" ").split(/\s+/).map(e=>R(e,this.options));r&&(a=a.filter(e=>(l("loose invalid filter",e,this.options),!!e.match(u[d.COMPARATORLOOSE])))),l("range list",a);const c=new Map,y=a.map(e=>new s(e,this.options));for(const e of y){if(m(e))return[e];c.set(e.value,e)}c.size>1&&c.has("")&&c.delete("");const S=[...c.values()];return o.set(t,S),S}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Range is required");return this.set.some(n=>S(n,t)&&e.set.some(e=>S(e,t)&&n.every(n=>e.every(e=>n.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(P(this.set[t],e,this.options))return!0;return!1}}e.exports=i;const o=new(n(7960)),a=n(4633),s=n(2966),l=n(670),c=n(6242),{safeRe:u,t:d,comparatorTrimReplace:f,tildeTrimReplace:p,caretTrimReplace:h}=n(9348),{FLAG_INCLUDE_PRERELEASE:v,FLAG_LOOSE:g}=n(6760),m=e=>"<0.0.0-0"===e.value,y=e=>""===e.value,S=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every(e=>i.intersects(e,t)),i=r.pop();return n},b=(e,t)=>(l("comp",e,t),e=A(e,t),l("caret",e),e=k(e,t),l("tildes",e),e=I(e,t),l("xrange",e),e=x(e,t),l("stars",e),e),w=e=>!e||"x"===e.toLowerCase()||"*"===e,k=(e,t)=>e.trim().split(/\s+/).map(e=>E(e,t)).join(" "),E=(e,t)=>{const n=t.loose?u[d.TILDELOOSE]:u[d.TILDE];return e.replace(n,(t,n,r,i,o)=>{let a;return l("tilde",e,t,n,r,i,o),w(n)?a="":w(r)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:w(i)?a=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:o?(l("replaceTilde pr",o),a=`>=${n}.${r}.${i}-${o} <${n}.${+r+1}.0-0`):a=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,l("tilde return",a),a})},A=(e,t)=>e.trim().split(/\s+/).map(e=>C(e,t)).join(" "),C=(e,t)=>{l("caret",e,t);const n=t.loose?u[d.CARETLOOSE]:u[d.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(t,n,i,o,a)=>{let s;return l("caret",e,t,n,i,o,a),w(n)?s="":w(i)?s=`>=${n}.0.0${r} <${+n+1}.0.0-0`:w(o)?s="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:a?(l("replaceCaret pr",a),s="0"===n?"0"===i?`>=${n}.${i}.${o}-${a} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}-${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o}-${a} <${+n+1}.0.0-0`):(l("no pr"),s="0"===n?"0"===i?`>=${n}.${i}.${o}${r} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o} <${+n+1}.0.0-0`),l("caret return",s),s})},I=(e,t)=>(l("replaceXRanges",e,t),e.split(/\s+/).map(e=>T(e,t)).join(" ")),T=(e,t)=>{e=e.trim();const n=t.loose?u[d.XRANGELOOSE]:u[d.XRANGE];return e.replace(n,(n,r,i,o,a,s)=>{l("xRange",e,n,r,i,o,a,s);const c=w(i),u=c||w(o),d=u||w(a),f=d;return"="===r&&f&&(r=""),s=t.includePrerelease?"-0":"",c?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&f?(u&&(o=0),a=0,">"===r?(r=">=",u?(i=+i+1,o=0,a=0):(o=+o+1,a=0)):"<="===r&&(r="<",u?i=+i+1:o=+o+1),"<"===r&&(s="-0"),n=`${r+i}.${o}.${a}${s}`):u?n=`>=${i}.0.0${s} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${o}.0${s} <${i}.${+o+1}.0-0`),l("xRange return",n),n})},x=(e,t)=>(l("replaceStars",e,t),e.trim().replace(u[d.STAR],"")),R=(e,t)=>(l("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?d.GTE0PRE:d.GTE0],"")),O=e=>(t,n,r,i,o,a,s,l,c,u,d,f)=>`${n=w(r)?"":w(i)?`>=${r}.0.0${e?"-0":""}`:w(o)?`>=${r}.${i}.0${e?"-0":""}`:a?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=w(c)?"":w(u)?`<${+c+1}.0.0-0`:w(d)?`<${c}.${+u+1}.0-0`:f?`<=${c}.${u}.${d}-${f}`:e?`<${c}.${u}.${+d+1}-0`:`<=${l}`}`.trim(),P=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(l(e[n].semver),e[n].semver!==s.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},9070:(e,t,n)=>{"use strict";const r=n(8713);e.exports=(e,t,n)=>(e=new r(e,n),t=new r(t,n),e.intersects(t,n))},9230:(e,t,n)=>{"use strict";const r=n(6242),i=n(8713);e.exports=(e,t,n)=>{let o=null,a=null,s=null;try{s=new i(t,n)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(o&&-1!==a.compare(e)||(o=e,a=new r(o,n)))}),o}},9348:(e,t,n)=>{"use strict";const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:o}=n(6760),a=n(670),s=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.safeSrc=[],d=t.t={};let f=0;const p="[a-zA-Z0-9-]",h=[["\\s",1],["\\d",o],[p,i]],v=(e,t,n)=>{const r=(e=>{for(const[t,n]of h)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=f++;a(e,i,t),d[e]=i,c[i]=t,u[i]=r,s[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(r,n?"g":void 0)};v("NUMERICIDENTIFIER","0|[1-9]\\d*"),v("NUMERICIDENTIFIERLOOSE","\\d+"),v("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),v("MAINVERSION",`(${c[d.NUMERICIDENTIFIER]})\\.(${c[d.NUMERICIDENTIFIER]})\\.(${c[d.NUMERICIDENTIFIER]})`),v("MAINVERSIONLOOSE",`(${c[d.NUMERICIDENTIFIERLOOSE]})\\.(${c[d.NUMERICIDENTIFIERLOOSE]})\\.(${c[d.NUMERICIDENTIFIERLOOSE]})`),v("PRERELEASEIDENTIFIER",`(?:${c[d.NONNUMERICIDENTIFIER]}|${c[d.NUMERICIDENTIFIER]})`),v("PRERELEASEIDENTIFIERLOOSE",`(?:${c[d.NONNUMERICIDENTIFIER]}|${c[d.NUMERICIDENTIFIERLOOSE]})`),v("PRERELEASE",`(?:-(${c[d.PRERELEASEIDENTIFIER]}(?:\\.${c[d.PRERELEASEIDENTIFIER]})*))`),v("PRERELEASELOOSE",`(?:-?(${c[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[d.PRERELEASEIDENTIFIERLOOSE]})*))`),v("BUILDIDENTIFIER",`${p}+`),v("BUILD",`(?:\\+(${c[d.BUILDIDENTIFIER]}(?:\\.${c[d.BUILDIDENTIFIER]})*))`),v("FULLPLAIN",`v?${c[d.MAINVERSION]}${c[d.PRERELEASE]}?${c[d.BUILD]}?`),v("FULL",`^${c[d.FULLPLAIN]}$`),v("LOOSEPLAIN",`[v=\\s]*${c[d.MAINVERSIONLOOSE]}${c[d.PRERELEASELOOSE]}?${c[d.BUILD]}?`),v("LOOSE",`^${c[d.LOOSEPLAIN]}$`),v("GTLT","((?:<|>)?=?)"),v("XRANGEIDENTIFIERLOOSE",`${c[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),v("XRANGEIDENTIFIER",`${c[d.NUMERICIDENTIFIER]}|x|X|\\*`),v("XRANGEPLAIN",`[v=\\s]*(${c[d.XRANGEIDENTIFIER]})(?:\\.(${c[d.XRANGEIDENTIFIER]})(?:\\.(${c[d.XRANGEIDENTIFIER]})(?:${c[d.PRERELEASE]})?${c[d.BUILD]}?)?)?`),v("XRANGEPLAINLOOSE",`[v=\\s]*(${c[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[d.XRANGEIDENTIFIERLOOSE]})(?:${c[d.PRERELEASELOOSE]})?${c[d.BUILD]}?)?)?`),v("XRANGE",`^${c[d.GTLT]}\\s*${c[d.XRANGEPLAIN]}$`),v("XRANGELOOSE",`^${c[d.GTLT]}\\s*${c[d.XRANGEPLAINLOOSE]}$`),v("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),v("COERCE",`${c[d.COERCEPLAIN]}(?:$|[^\\d])`),v("COERCEFULL",c[d.COERCEPLAIN]+`(?:${c[d.PRERELEASE]})?`+`(?:${c[d.BUILD]})?(?:$|[^\\d])`),v("COERCERTL",c[d.COERCE],!0),v("COERCERTLFULL",c[d.COERCEFULL],!0),v("LONETILDE","(?:~>?)"),v("TILDETRIM",`(\\s*)${c[d.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",v("TILDE",`^${c[d.LONETILDE]}${c[d.XRANGEPLAIN]}$`),v("TILDELOOSE",`^${c[d.LONETILDE]}${c[d.XRANGEPLAINLOOSE]}$`),v("LONECARET","(?:\\^)"),v("CARETTRIM",`(\\s*)${c[d.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",v("CARET",`^${c[d.LONECARET]}${c[d.XRANGEPLAIN]}$`),v("CARETLOOSE",`^${c[d.LONECARET]}${c[d.XRANGEPLAINLOOSE]}$`),v("COMPARATORLOOSE",`^${c[d.GTLT]}\\s*(${c[d.LOOSEPLAIN]})$|^$`),v("COMPARATOR",`^${c[d.GTLT]}\\s*(${c[d.FULLPLAIN]})$|^$`),v("COMPARATORTRIM",`(\\s*)${c[d.GTLT]}\\s*(${c[d.LOOSEPLAIN]}|${c[d.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",v("HYPHENRANGE",`^\\s*(${c[d.XRANGEPLAIN]})\\s+-\\s+(${c[d.XRANGEPLAIN]})\\s*$`),v("HYPHENRANGELOOSE",`^\\s*(${c[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[d.XRANGEPLAINLOOSE]})\\s*$`),v("STAR","(<|>)?=?\\s*\\*"),v("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),v("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},9354:e=>{var t={loading:"Loading",loadingPhase1:"Taking you to the store",loadingPhase2:"Just a moment longer",loadingPhase3:"Nearly there",authentication:"Authentication",authenticationContent:"We need a pop up to sign you back in",continue:"Continue"};e.exports={getString:function(e){return t[e]}}},9679:(e,t,n)=>{"use strict";const r=n(6242),i=n(8713),o=n(3050);e.exports=(e,t)=>{e=new i(e,t);let n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let a=null;i.forEach(e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":a&&!o(t,a)||(a=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}}),!a||n&&!o(n,a)||(n=a)}return n&&e.test(n)?n:null}},9717:(e,t,n)=>{"use strict";n(4600);var r=n(1015),i=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var o=Symbol.for;i=o("react.element"),t.Fragment=o("react.fragment")}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:o,_owner:a.current}}t.jsx=c,t.jsxs=c},9875:(e,t,n)=>{"use strict";const r=n(9348),i=n(6760),o=n(6242),a=n(4457),s=n(5702),l=n(5003),c=n(3932),u=n(5437),d=n(8234),f=n(1948),p=n(6496),h=n(2295),v=n(4415),g=n(690),m=n(3780),y=n(7217),S=n(883),b=n(677),w=n(3947),k=n(3050),E=n(813),A=n(4651),C=n(7241),I=n(6179),T=n(926),x=n(4793),R=n(6996),O=n(2966),P=n(8713),N=n(6476),F=n(6193),B=n(9230),L=n(2236),D=n(9679),H=n(3056),_=n(1949),M=n(781),U=n(612),z=n(9070),j=n(3987),$=n(7010);e.exports={parse:s,valid:l,clean:c,inc:u,diff:d,major:f,minor:p,patch:h,prerelease:v,compare:g,rcompare:m,compareLoose:y,compareBuild:S,sort:b,rsort:w,gt:k,lt:E,eq:A,neq:C,gte:I,lte:T,cmp:x,coerce:R,Comparator:O,Range:P,satisfies:N,toComparators:F,maxSatisfying:B,minSatisfying:L,minVersion:D,validRange:H,outside:_,gtr:M,ltr:U,intersects:z,simplifyRange:j,subset:$,SemVer:o,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:a.compareIdentifiers,rcompareIdentifiers:a.rcompareIdentifiers}}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,i),o.exports}t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var o=Object.create(null);i.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&r&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach(e=>a[e]=()=>n[e]);return a.default=()=>n,i.d(o,a),o},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{"use strict";function e(e,t,n){return r(e,1,t,n)}function t(e,t,n){return r(e,2,t,n)}function n(e,t,n){return r(e,0,t,n)}function r(e,t,n,r){return{name:e,dataType:t,value:n,classification:r||4}}i.r(o),i.d(o,{Action:()=>WE});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)};function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var l=function(){return l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},l.apply(this,arguments)};function c(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{l(r.next(e))}catch(e){o(e)}}function s(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}l((r=r.apply(e,t||[])).next())})}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var u,d=(u=[],{fireEvent:function(e){u.forEach(function(t){return t(e)})},addListener:function(e){e&&u.push(e)}});function f(e,t,n){d.fireEvent({level:e,category:t,message:n})}function p(e,t,n){f(0,e,function(){var e=n instanceof Error?n.message:"";return"".concat(t,": ").concat(e)})}var h={};function v(e,t){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?h[e]?(t.ariaTenantToken&&(h[e].ariaTenantToken=t.ariaTenantToken),t.dnmToken&&(h[e].dnmToken=t.dnmToken)):h[e]=t:f(0,0,function(){return"Namespace: ".concat(e)})}function g(e,t){for(var n=e.length;n>0;){var r=e.substr(0,n);if(h[r]){var i=h[r];return t.ariaTenantToken=i.ariaTenantToken,t.dnmToken=i.dnmToken,!0}n=e.lastIndexOf(".",n-1)}return!1}var m=9007199254740991,y=-m,S=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,b=/^[a-zA-Z0-9_\.]{1,95}$/;function w(e){return b.test(e)}function k(e){e&&e.forEach(function(e){"string"==typeof e.name&&w(e.name)||E("dataField name",e.name,b),2===e.dataType&&function(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<y||e>m)throw new Error("Invalid integer ".concat(JSON.stringify(e)))}(e.value)})}function E(e,t,n,r){throw new Error("Invalid ".concat(e," '").concat(t,"' as it does not match regex ").concat(n)+(r?" or exceeds ".concat(r," chars"):""))}function A(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?l({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var C=function(){function e(t,n,r){var i,o,a;this.telemetrySinks=[],this.persistentDataFields=[],this.partAFields=[],this.eventQueue=[],this.config=r||{},this.instanceId=++e.instanceCounter,t&&(this.telemetrySinks=t.telemetrySinks,(i=this.persistentDataFields).push.apply(i,t.persistentDataFields),this.config=l(l({},t.getConfig()),this.config),(o=this.partAFields).push.apply(o,t.partAFields)),n&&(a=this.persistentDataFields).push.apply(a,n)}return e.prototype.addEventContentType=function(e,n){e.push(t("EventContent.Type",n))},e.prototype.sendTelemetryEvent=function(e){var t=A(e),n=t.telemetryProperties;n.nexusTenantToken=-1;var r=n.ariaTenantToken;r||g(t.eventName,n)||r?this.sendTelemetryEventInternal(t,1):f(0,0,function(){return"No tenant token: "+e.eventName})},e.prototype.sendNonStandardEvent=function(e,t){var n=A(e);this.sendTelemetryEventInternal(n,t)},e.prototype.sendCustomerContent=function(e){var t=A(e),n=t.telemetryProperties,r=n.customerContentVersion;return(!r||r>2)&&(n.customerContentVersion=2),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,n.dnmToken=void 0,this.addEventContentType(t.dataFields,2),this.sendTelemetryEventInternal(t,2)},e.prototype.sendDirectNumericEvent=function(e){var t=A(e),n=t.telemetryProperties;n.dnmToken||g(t.eventName,n)||n.dnmToken?(this.addEventContentType(t.dataFields,1),this.sendTelemetryEventInternal(t,3)):f(0,0,function(){return"No dnm token: "+t.eventName})},e.prototype.sendTelemetryEventInternal=function(e,t){if(2===t||!e.telemetryProperties.customerContentVersion&&!e.telemetryProperties.customerContentType){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push([e,t]):f(1,0,function(){return"No telemetry sinks are attached."}));this.processTelemetryEvent(e,t)}catch(e){return void p(0,"SendTelemetryEvent",e)}this.telemetrySinks.forEach(function(n){try{3===t||2===t?n.sendNonStandardEvent&&n.sendNonStandardEvent(e,t):n.sendTelemetryEvent(e)}catch(e){}})}else f(0,0,function(){return"Customer content"})},e.prototype.processTelemetryEvent=function(e,t){var r,i,o;if(e.dataFields&&(null===(o=e.dataFields)||void 0===o||o.unshift(n("OTelJS.Version","4.23.1149")),3!==t&&this.persistentDataFields&&(r=e.dataFields).unshift.apply(r,this.persistentDataFields)),this.partAFields.length>0){var a=e.eventContract||{name:"",dataFields:[]};(i=a.dataFields).push.apply(i,this.partAFields),e.eventContract=a}this.config.disableValidation||function(e){var t;(t=e.eventName)&&!(t.length>98)&&S.test(t)||E("eventName",e.eventName,S,98);var n=e.eventContract;n&&(n.name&&!w(n.name)&&E("eventContract",n.name,b),k(n.dataFields)),k(e.dataFields)}(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e),this.flushQueue()},e.prototype.flushQueue=function(){var e=this.eventQueue;if(this.eventQueue=[],this.telemetrySinks.length>0)for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r[0],o=r[1];this.sendTelemetryEventInternal(i,o)}},e.prototype.setTenantToken=function(e,t,n){v(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.setDNMToken=function(e,t){v(e,{dnmToken:t})},e.prototype.cloneEvent=function(e){return A(e)},e.prototype.getConfig=function(){return this.config},e.instanceCounter=0,e}();function I(e,t){return e?e+"."+t:t}function T(e,t,r,i,o){void 0===o&&(o=4),i&&e.push(n("".concat(I(t,r)),i,o))}function x(t,n,r,i){"boolean"==typeof i&&t.push(e("".concat(I(n,r)),i))}function R(e,n,r,i){if("number"==typeof i){var o=Math.round(i);e.push(t("".concat(I(n,r)),o))}}var O,P={contractName:"Office.System.Activity",getFields:function(e){var t="Activity",r=[];return T(r,t,"CV",e.cV),R(r,t,"Duration",e.duration),R(r,t,"Count",e.count),R(r,t,"AggMode",e.aggMode),x(r,t,"Success",e.success),e.result&&r.push.apply(r,function(e){var t="Activity.Result",r=[];return R(r,t,"Code",e.code),T(r,t,"Type",e.type),R(r,t,"Tag",e.tag),x(r,t,"IsExpected",e.isExpected),r.push(n("zC.Activity.Result","Office.System.Result")),r}(e.result)),r.push(n("zC.Activity",this.contractName)),r}},N=function(e){var t="User",n=[];return T(n,t,"PrimaryIdentityHash",e.primaryIdentityHash),T(n,t,"PrimaryIdentitySpace",e.primaryIdentitySpace),T(n,t,"TenantId",e.tenantId,1),T(n,t,"TenantGroup",e.tenantGroup,1),x(n,t,"IsAnonymous",e.isAnonymous),x(n,t,"IsSignedIn",e.isSignedIn),T(n,t,"TelemetryRegion",e.telemetryRegion),n};!function(e){e.Web="Web",e.Desktop="Desktop",e.Universal="Universal",e.Mobile="Mobile",e.Win32="Win32",e.Mac="Mac",e.iOS="iOS",e.Android="Android"}(O||(O={}));var F,B=function(e){var t="App",n=[];return T(n,t,"Name",e.name,1),T(n,t,"Platform",e.platform,1),T(n,t,"Version",e.version,1),n},L=function(e){var t="Session",n=[];return T(n,t,"Id",e.id,1),T(n,t,"EcsETag",e.ecsETag,1),n};!function(e){e.Automation="Automation",e.Dogfood="Dogfood",e.Microsoft="Microsoft",e.Insiders="Insiders",e.Production="Production"}(F||(F={}));var D,H,_,M;!function(e){var t,r,i,o,a,s,l="Copilot";(s=e.FeatureActionType||(e.FeatureActionType={})).IsEnabled="IsEnabled",s.IsSeen="IsSeen",s.IsTried="IsTried",s.IsKept="IsKept",s.IsRejected="IsRejected",s.IsAutonomousRun="IsAutonomousRun",(a=e.Capability||(e.Capability={})).ContentGeneration="Content Generation",a.Commanding="Commanding",a.QAandSummaries="QA and Summaries",a.Collaboration="Collaboration",a.Suggestions="Suggestions",(o=e.EntryPoint||(e.EntryPoint={})).BizChat="BizChat",o.Chat="Chat",o.Canvas="Canvas",o.SuggestionsPane="Suggestions Pane",o.Backstage="Backstage",(i=e.Verb||(e.Verb={})).Create="Create",i.Command="Command",i.Ask="Ask",i.Summarize="Summarize",i.Share="Share",i.Analyze="Analyze",(r=e.ActionOrigin||(e.ActionOrigin={})).Ribbon="Ribbon",r.Skittle="Skittle",r.Handoffs="Handoffs",r.TopOfDoc="TopOfDoc",r.ContextMenu="ContextMenu",r.FirstRunExperience="FirstRunExperience",r.Nudges="Nudges",r.AIRibbon="AIRibbon",r.CopilotLab="CopilotLab",r.Formula="Formula",(t=e.FeatureClass||(e.FeatureClass={})).Reactive="Reactive",t.Proactive="Proactive",t.Autonomous="Autonomous",e.getFields=function(e){var t=[];return T(t,l,"FeatureActionType",e.featureActionType),x(t,l,"IsUserInitiated",e.isUserInitiated),T(t,l,"FeatureName",e.featureName),T(t,l,"SubFeatureName",e.subFeatureName),T(t,l,"Capability",e.capability),x(t,l,"IsThumbsUp",e.isThumbsUp),T(t,l,"EntryPoint",e.entryPoint),T(t,l,"Verb",e.verb),T(t,l,"InteractionId",e.interactionId),T(t,l,"ConversationId",e.conversationId),T(t,l,"ActionOrigin",e.actionOrigin),T(t,l,"FeatureClass",e.featureClass),t.push(n("zC.".concat(l),"Office.System.Copilot")),t}}(D||(D={})),function(e){var t,r="Asha";(t=e.EventType||(e.EventType={})).Pillar="Pillar",t.Error="Error",e.getFields=function(e){var t=[];return T(t,r,"EventType",e.eventType),T(t,r,"Pillar",e.pillar),T(t,r,"Scenario",e.scenario),T(t,r,"Veto",e.veto),T(t,r,"Error",e.error),x(t,r,"InStaging",e.inStaging),x(t,r,"IsSessionEndingError",e.isSessionEndingError),x(t,r,"IsIntentional",e.isIntentional),x(t,r,"IsInternal",e.isInternal),t.push(n("zC.".concat(r),"Office.System.Asha")),t}}(H||(H={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.name&&r.push(n("".concat(e,".Name"),t.name)),void 0!==t.platform&&r.push(n("".concat(e,".Platform"),t.platform)),void 0!==t.version&&r.push(n("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&r.push(n("".concat(e,".SessionId"),t.sessionId)),void 0!==t.immediateHost&&r.push(n("".concat(e,".ImmediateHost"),t.immediateHost)),void 0!==t.subModuleName&&r.push(n("".concat(e,".SubModuleName"),t.subModuleName)),void 0!==t.context&&r.push(n("".concat(e,".Context"),t.context)),void 0!==t.referrer&&r.push(n("".concat(e,".Referrer"),t.referrer)),r}}(_||(_={})),function(e){var t="ContentIdentifier";e.getFields=function(e){var r=[];return r.push(n("".concat(t,".ContentType"),e.contentType)),r.push(n("".concat(t,".ContentId"),e.contentId)),void 0!==e.subContentType&&r.push(n("".concat(t,".SubContentType"),e.subContentType)),void 0!==e.subContentId&&r.push(n("".concat(t,".SubContentId"),e.subContentId)),r.push(n("zC.".concat(t),"Office.System.ContentIdentifier")),r}}(M||(M={}));var U,z,j=function(){return(j="object"==typeof self&&"object"==typeof self.performance&&"function"==typeof self.performance.now?function(){return self.performance.now()}:function(){return Date.now()})()},$=function(e){var t,n=j(),r=A(e.telemetryEvent);return l(l({cv:e.parentCv.getNext()},r),{createChildActivity:function(t){return $({telemetryEvent:t,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,t,n){this.result={code:e,type:t,tag:n}},endNow:function(){var r,i,o=this;if(!t){void 0===this.success&&void 0===this.result&&f(1,0,function(){return"Activity does not have success or result set"});var a=j(),s=Math.floor(1e3*(a-n));t=!0;var l={duration:s,count:1,aggMode:0,cV:this.cv.value,success:this.success,result:this.result},c=null!==(i=null===(r=this.eventContract)||void 0===r?void 0:r.dataFields)&&void 0!==i?i:[];return c.push.apply(c,P.getFields(l)),this.eventContract={name:P.contractName,dataFields:c},e.sendTelemetryEvent(this)}f(0,0,function(){return"'".concat(o.eventName,"' already ended")})}})},W=function(){function e(e){this.value=e,this.nextChild=0}return e.prototype.getNext=function(){return new e("".concat(this.value,".").concat(++this.nextChild))},e}(),q=function(e){function r(t,n,r){var i=e.call(this,t,n,r)||this;return i.baseCv=function(){if(!U){for(var e=[],t=0;t<22;t++)e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(Math.floor(64*Math.random())));U=new W(e.join(""))}return U}(),i}return s(r,e),r.prototype.createActivity=function(e){return $({sendTelemetryEvent:this.sendTelemetryEvent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},r.prototype.sendActivity=function(e,t,n,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:P.contractName,dataFields:P.getFields(t)},dataFields:n,eventFlags:r})},r.prototype.sendError=function(e){var r=function(e){var r="Error",i=[];return i.push(n("".concat(r,".ErrorGroup"),e.errorGroup)),i.push(t("".concat(r,".Tag"),e.tag)),void 0!==e.code&&i.push(t("".concat(r,".Code"),e.code)),void 0!==e.id&&i.push(t("".concat(r,".Id"),e.id)),void 0!==e.count&&i.push(t("".concat(r,".Count"),e.count)),i}(e.error);return null!=e.dataFields&&r.push.apply(r,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:r,eventFlags:e.eventFlags})},r.prototype.createCustomerContentActivity=function(e){return $({sendTelemetryEvent:this.sendCustomerContent.bind(this),telemetryEvent:e,parentCv:this.baseCv})},r}(C),V=i(1015),G=i.t(V,2),K=i(4638);class X{constructor(e){this.listeners={},this.element=e}addListener(e,t){this.element&&(this.removeListener(e),this.element.addEventListener(e,t),this.listeners[e]=t)}removeListener(e){this.element&&this.listeners[e]&&(this.element.removeEventListener(e,this.listeners[e]),delete this.listeners[e])}removeAllListeners(){for(const e of Object.keys(this.listeners))this.removeListener(e)}}!function(e){e.Debug="Debug",e.Info="Info",e.Warn="Warn",e.Error="Error"}(z||(z={}));const Q=i(4577).rE,J="appInitialization.appLoaded",Y="appInitialization.expectedFailure",Z="appInitialization.failure",ee="appInitialization.success",te="appInstallDialog.openAppInstallDialog",ne="authentication.getAuthToken",re="authentication.getUser",ie="authentication.authenticate",oe="authentication.authenticate.success",ae="authentication.authenticate.failure",se="appEntity.selectAppEntity",le="media.scanBarCode",ce="calendar.composeMeeting",ue="calendar.openCalendarItem",de="call.startCall",fe="chat.openChat",pe="clipboard.writeToClipboard",he="clipboard.readFromClipboard",ve="conversations.openConversation",ge="conversations.closeConversation",me="getChatMembers",ye={getEligibilityInfo:"copilot.eligibility.getEligibilityInfo"},Se="tasks.startTask",be="tasks.completeTask",we={resize:"tasks.updateTask"},ke="externalAppCardActions.processActionOpenUrl",Ee="externalAppCardActions.processActionSubmit",Ae="externalAppCardActionsForCEA.processActionOpenUrl",Ce="externalAppCardActionsForCEA.processActionSubmit",Ie="externalAppCommands.processActionCommand",Te="externalAppAuthentication.authenticateAndResendRequest",xe="externalAppAuthentication.authenticateWithSSO",Re="externalAppAuthentication.authenticateWithSSOAndResendRequest",Oe="externalAppAuthentication.authenticateWithOauth2",Pe="externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",Ne="externalAppAuthenticationForCEA.authenticateWithSSO",Fe="externalAppAuthenticationForCEA.authenticateWithOauth",Be="externalAppAuthenticationForCEA.authenticateAndResendRequest",Le="externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest",De="files.addCloudStorageFolder",He="files.copyMoveFiles",_e="files.deleteCloudStorageFolder",Me="files.getCloudStorageFolders",Ue="openFilePreview",ze="files.getExternalProviders",je="files.openCloudStorageFile",$e="files.getCloudStorageFolderContents",We="getContext",qe="initialize",Ve={addAndConfigure:"hostEntity.tab.addAndConfigure",reconfigure:"hostEntity.tab.reconfigure",rename:"hostEntity.tab.rename",remove:"hostEntity.tab.remove",getAll:"hostEntity.tab.getAll"},Ge="location.getLocation",Ke={showLocation:"location.showLocation"},Xe="interactive.getFluidTenantInfo",Qe="interactive.getFluidToken",Je="interactive.getFluidContainerId",Ye="interactive.setFluidContainerId",Ze="interactive.getNtpTime",et="interactive.registerClientId",tt="interactive.getClientRoles",nt="interactive.getClientInfo",rt="executeDeepLink",it="log.receive",ot="mail.composeMail",at="mail.openMailItem",st="marketplace.getCart",lt="marketplace.addOrUpdateCartItems",ct="marketplace.removeCartItems",ut="marketplace.updateCartStatus",dt="captureImage",ft="getMedia",pt="selectMedia",ht="viewImages",vt="meeting.getAppContentStageSharingCapabilities",gt="meeting.getAppContentStageSharingState",mt="meeting.getAuthenticationTokenForAnonymousUser",yt="getIncomingClientAudioState",St="meeting.getLiveStreamState",bt="meeting.getMeetingDetails",wt={setOptions:"meeting.appShareButton.setOptions"},kt="meeting.requestStartLiveStreaming",Et="meeting.requestStopLiveStreaming",At="meeting.shareAppContentToStage",Ct="meeting.stopSharingAppContentToStage",It="toggleIncomingClientAudio",Tt="meeting.requestAppAudioHandling",xt="meeting.updateMicState",Rt="meeting.joinMeeting",Ot="meetingRoom.getPairedMeetingRoomInfo",Pt="meetingRoom.sendCommandToPairedMeetingRoom",Nt="monetization.openPurchaseExperience",Ft="nestedAppAuth.execute",Bt="notifications.showNotification",Lt="otherApp.unregisterInstall",Dt="otherApp.notifyInstallCompleted",Ht="settings.getSettings",_t="navigateCrossDomain",Mt="pages.navigateToApp",Ut="returnFocus",zt="setFrameContext",jt="shareDeepLink",$t={navigateBack:"navigateBack"},Wt={navigateTo:"pages.currentApp.navigateTo",navigateToDefaultPage:"pages.currentApp.navigateToDefaultPage"},qt={getTabInstances:"getTabInstances",getMruTabInstances:"getMruTabInstances",navigateToTab:"navigateToTab"},Vt={setConfig:"settings.setSettings",setValidityState:"settings.setValidityState",save:{success:"settings.save.success",failure:"settings.save.failure"},remove:{success:"settings.remove.success",failure:"settings.remove.failure"}},Gt={enterFullscreen:"enterFullscreen",exitFullscreen:"exitFullscreen"},Kt="people.selectPeople",Xt={getPermissionStatus:"permissions.has"},Qt="permissions.request",Jt="profile.showProfile",Yt="remoteCamera.getCapableParticipants",Zt="remoteCamera.requestControl",en="remoteCamera.sendControlCommand",tn="remoteCamera.terminateSession",nn="registerHandler",rn="search.unregister",on="search.closeSearch",an="sharing.shareWebContent",sn={getContent:"sharing.history.getContent"},ln="stageView.open",cn={close:"stageView.self.close"},un="store.open",dn="teams.getTeamChannels",fn="teams.refreshSiteUrl",pn={getConfigSetting:"getConfigSetting",joinedTeams:{getUserJoinedTeams:"getUserJoinedTeams"}},hn={getTelemetryPort:"messageChannels.telemetry.getTelemetryPort"},vn={getDataLayerPort:"messageChannels.dataLayer.getDataLayerPort"},gn="thirdPartyCloudStorage.getDragAndDropFiles",mn="video.effectParameterChange",yn={registerForVideoFrame:"video.mediaStream.registerForVideoFrame",audioInferenceDiscardStatusChange:"video.mediaStream.audioInferenceDiscardStatusChange"},Sn="video.notifyError",bn="video.personalizedEffectsChanged",wn="video.registerForVideoEffect",kn={registerForVideoFrame:"video.registerForVideoFrame"},En="video.startVideoExtensibilityVideoStream",An="video.videoEffectChanged",Cn="video.videoEffectReadiness",In="video.videoExtensibilityIpcChangedEvent",Tn={performanceDataGenerated:"video.performance.performanceDataGenerated",frameProcessingSlow:"video.performance.frameProcessingSlow",firstFrameProcessed:"video.performance.firstFrameProcessed",textureStreamAcquired:"video.performance.textureStreamAcquired"},xn="video.setFrameProcessTimeLimit",Rn="webStorage.isWebStorageClearedOnUserLogOut";var On,Pn,Nn,Fn;!function(e){e.ME="ME",e.CEA="CEA"}(On||(On={})),function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other",e.AppInitTimeout="AppInitTimeout",e.CachedAppLoadTimedOut="CachedAppLoadTimedOut",e.Validation="Validation",e.Validation_InvalidDomains="Validation_InvalidDomains"}(Pn||(Pn={})),function(e){e.AppExpiration="app expiration",e.AppNotifyFailure="app sent notify failure",e.AppUnloadTimeout="app unload timeout",e.FreeMemoryUnderMinimum="insufficient memory to retain the cached app",e.HostExplicitRemoval="host explicitly removed the app",e.HostMemoryLimitExceeded="host memory limit exceeded",e.AppDidNotRegisterForCaching="app did not register for caching",e.NumAppsExceeded="number of apps exceeded"}(Nn||(Nn={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(Fn||(Fn={}));const Bn={resourceDomainParameter:"{resourceDomain}",validResourcePattern:"^((https|api)://{resourceDomain}([:/].*)?)$"},Ln=/^(\*\.)*[^*]+$/i,Dn=new Set(["b5abf2ae-c16b-4310-8f8a-d3bcdb52f162","d870f6cd-4aa5-4d42-9626-ab690c041429"]),Hn=new Set(["f3a6e67f-850d-4dd9-960a-04c6638ded39","f3a6e67f-850d-4dd9-960a-04c6638ded36","b6b18421-3bba-40df-a983-05fbbc9e2d13","a9750531-44bc-4346-84a7-c4ceda140ef4"]),_n=["com.example.microsoftteamstabs.test","com.example.m365testapp.test"],Mn=new Set([...Dn,..._n]),Un="Url is invalid",zn="Invalid dialog URL",jn="There is at least one improperly formatted domain in the provided app definition's validDomains field",$n="Authorization code exceeds max length of 4096 characters",Wn="Authorization code contains unexpected characters. Allowed characters are a-z, A-Z, 0-9, ., _, +, /, =, ~, and -",qn="Desktop clients must provide implementation for externalAuthService on IAuthenticationService. External auth flows may not work as expected when externalAuthService is not provided.",Vn="App does not have the required permissions for this operation",Gn="RequestedForAppID",Kn="IsExternal",Xn=["www.microsoft365.com","bing.com","edgeservices.bing.com","www.bing.com","www.staging-bing-int.com","teams.cloud.microsoft","outlook.cloud.microsoft","m365.cloud.microsoft","copilot.microsoft.com","windows.msn.com"],Qn="2.19",Jn="The detected TeamsJS Version is < 2.19. App may not be able to run on this domain. Please update TeamsJS.";var Yn,Zn,er,tr,nr,rr,ir,or,ar,sr,lr,cr,ur,dr,fr;!function(e){e.Unknown="unknown",e.Loading="loading",e.WaitingForAppLoad="WaitingForAppLoad",e.Loaded="loaded",e.Failed="failed",e.Unloading="unloading",e.Unloaded="unloaded",e.Cached="cached"}(Yn||(Yn={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(Zn||(Zn={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(er||(er={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(tr||(tr={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(nr||(nr={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(rr||(rr={})),function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(ir||(ir={})),function(e){e.M365Content="m365content"}(or||(or={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(ar||(ar={})),function(e){e.Public="public",e.EUDB="eudb",e.DOD="dod",e.DOJ="doj"}(sr||(sr={})),function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(lr||(lr={})),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.Read=2]="Read",e[e.Compose=3]="Compose"}(cr||(cr={})),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.GoToActivityFeed=2]="GoToActivityFeed"}(ur||(ur={})),function(e){e.GeoLocation="geolocation",e.Media="media",e.Midi="midi",e.Notifications="notifications",e.OpenExternal="openExternal"}(dr||(dr={})),function(e){e.Consented="consented",e.Revoked="revoked",e.NeverAsked="neverAsked"}(fr||(fr={}));const pr="An internal error occurred",hr=new Set([Ft]),vr={errorCode:Zn.INTERNAL_ERROR,message:pr},gr={errorCode:er.INTERNAL_ERROR,message:pr};function mr(e,t,n,r,i,o){const a=function(e,t,n){return{errorCode:(null==e?void 0:e.errorCode)&&Object.values(t).includes(null==e?void 0:e.errorCode)?e.errorCode:n.errorCode,message:(Er(e)?e.message:"string"==typeof e?e:n.message)||n.message}}(t,n,r);return null==o||o.fail(`${e} Api failed ${a.message}`),i(a)}const yr=(e,t,n)=>c(void 0,void 0,void 0,function*(){return null==n||n.fail(`${e} Api failed ${Rr(t)}`),Er(t)?Ar(t):Ar(vr)}),Sr=(e,t,n)=>c(void 0,void 0,void 0,function*(){return null==n||n.fail(`${e} Api failed ${Rr(t)}`),Ar([!1,t])}),br=(e,t)=>({errorCode:e,message:t}),wr=e=>({errorCode:er.INTERNAL_ERROR,message:Er(e)?e.message||pr:"string"==typeof e?e:JSON.stringify(e)}),kr=(e,t,n,r=!1)=>c(void 0,void 0,void 0,function*(){const i=yield t(e);if(Er(i))return Promise.reject(i);{const e=n?n(i):i;return r&&Array.isArray(e)?Ar([null,...e]):Ar([null,e])}}),Er=e=>void 0!==(null==e?void 0:e.errorCode),Ar=e=>c(void 0,void 0,void 0,function*(){return null!=e?{kind:"appResponse",data:e}:{kind:"appResponse"}}),Cr=(e,...t)=>c(void 0,void 0,void 0,function*(){const n=yield e(...t);return Ar(n)}),Ir={kind:"logResponse"},Tr=(e,...t)=>c(void 0,void 0,void 0,function*(){return yield e(...t),Ir}),xr=(e,t)=>c(void 0,void 0,void 0,function*(){let n;if(!e)throw br(Zn.INTERNAL_ERROR,"PermissionService is not provided");try{n=yield e.storageService.getPermissionStatus(t)}catch(e){throw JSON.stringify(e)}if(n==fr.NeverAsked)throw br(Zn.INTERNAL_ERROR,"The app must specify "+t+" permission in its manifest and must be granted by the user. (the user has not been asked to grant permission).");if(n==fr.Revoked)throw br(Zn.PERMISSION_DENIED,"user has explicitly not consented for device permission");if(n!==fr.Consented)throw br(Zn.INTERNAL_ERROR,`Unrecognized device permission state: ${n}`)}),Rr=e=>{const t="An unknown error occurred that could not be converted into a string description.";return Er(e)||e instanceof Error?e.message||t:"string"==typeof e?e:"object"==typeof e&&JSON.stringify(e)||t};function Or(e,t){var n;return{data:e.data,isDeeplyNestedRequest:t,origin:e.origin,source:null!==(n=e.source)&&void 0!==n?n:void 0}}const Pr=e=>{var t;return e.uuid?e.uuid.toString():null===(t=e.id)||void 0===t?void 0:t.toString()};var Nr,Fr,Br,Lr,Dr,Hr,_r,Mr;(Nr||(Nr={})).getFields=function(r,i){var o=[];return o.push(t("".concat(r,".Code"),i.code)),void 0!==i.type&&o.push(n("".concat(r,".Type"),i.type)),void 0!==i.tag&&o.push(t("".concat(r,".Tag"),i.tag)),void 0!==i.isExpected&&o.push(e("".concat(r,".IsExpected"),i.isExpected)),o.push(n("zC.Activity.Result","Office.System.Result")),o},function(r){r.contractName="Office.System.Activity",r.getFields=function(i){var o="Activity",a=[];return void 0!==i.cV&&a.push(n("".concat(o,".CV"),i.cV)),a.push(t("".concat(o,".Duration"),i.duration)),a.push(t("".concat(o,".Count"),i.count)),a.push(t("".concat(o,".AggMode"),i.aggMode)),void 0!==i.success&&a.push(e("".concat(o,".Success"),i.success)),void 0!==i.result&&a.push.apply(a,Nr.getFields("".concat(o,".Result"),i.result)),a.push(n("zC.Activity",r.contractName)),a}}(Fr||(Fr={})),function(e){e.getFields=function(e,t){var r=[];return void 0!==t.id&&r.push(n("".concat(e,".Id"),t.id)),void 0!==t.version&&r.push(n("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&r.push(n("".concat(e,".SessionId"),t.sessionId)),r}}(Br||(Br={})),(Lr||(Lr={})).getFields=function(t,r){var i=[];return void 0!==r.alias&&i.push(n("".concat(t,".Alias"),r.alias)),void 0!==r.primaryIdentityHash&&i.push(n("".concat(t,".PrimaryIdentityHash"),r.primaryIdentityHash)),void 0!==r.primaryIdentitySpace&&i.push(n("".concat(t,".PrimaryIdentitySpace"),r.primaryIdentitySpace)),void 0!==r.tenantId&&i.push(n("".concat(t,".TenantId"),r.tenantId)),void 0!==r.tenantGroup&&i.push(n("".concat(t,".TenantGroup"),r.tenantGroup)),void 0!==r.isAnonymous&&i.push(e("".concat(t,".IsAnonymous"),r.isAnonymous)),void 0!==r.telemetryRegion&&i.push(n("".concat(t,".TelemetryRegion"),r.telemetryRegion)),i},(Dr||(Dr={})).getFields=function(e,t){var r=[];return void 0!==t.name&&r.push(n("".concat(e,".Name"),t.name)),void 0!==t.state&&r.push(n("".concat(e,".State"),t.state)),r},(Hr||(Hr={})).getFields=function(e,r){var i=[];return void 0!==r.id&&i.push(t("".concat(e,".Id"),r.id)),void 0!==r.name&&i.push(n("".concat(e,".Name"),r.name)),void 0!==r.commandSurface&&i.push(n("".concat(e,".CommandSurface"),r.commandSurface)),void 0!==r.parentName&&i.push(n("".concat(e,".ParentName"),r.parentName)),void 0!==r.triggerMethod&&i.push(n("".concat(e,".TriggerMethod"),r.triggerMethod)),void 0!==r.timeOffsetMs&&i.push(t("".concat(e,".TimeOffsetMs"),r.timeOffsetMs)),i},function(e){e.getFields=function(e,t){var r=[];return void 0!==t.name&&r.push(n("".concat(e,".Name"),t.name)),void 0!==t.platform&&r.push(n("".concat(e,".Platform"),t.platform)),void 0!==t.version&&r.push(n("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&r.push(n("".concat(e,".SessionId"),t.sessionId)),void 0!==t.immediateHost&&r.push(n("".concat(e,".ImmediateHost"),t.immediateHost)),r.push(n("zC.".concat(e),"Office.System.Module")),r}}(_r||(_r={})),function(e){e.getFields=function(e,r){var i=[];return i.push(n("".concat(e,".ErrorGroup"),r.errorGroup)),i.push(t("".concat(e,".Tag"),r.tag)),void 0!==r.code&&i.push(t("".concat(e,".Code"),r.code)),void 0!==r.id&&i.push(t("".concat(e,".Id"),r.id)),void 0!==r.count&&i.push(t("".concat(e,".Count"),r.count)),i}}(Mr||(Mr={}));var Ur,zr=Fr,jr=Nr,$r=Mr,Wr=Dr,qr=Br,Vr=Hr,Gr=Lr,Kr=_r;!function(e){!function(e){var t;(t=e.System||(e.System={})).Activity=zr,t.Result=jr,t.Error=$r,t.Funnel=Wr,t.Host=qr,t.User=Gr,t.UserAction=Vr,t.Module=Kr}(e.Office||(e.Office={}))}(Ur||(Ur={}));var Xr="function",Qr="object",Jr="undefined",Yr="prototype",Zr="hasOwnProperty",ei=Object,ti=ei[Yr],ni=ei.assign,ri=ei.create,ii=ei.defineProperty,oi=ti[Zr],ai=null;function si(e){void 0===e&&(e=!0);var t=!1===e?null:ai;return t||(typeof globalThis!==Jr&&(t=globalThis),t||typeof self===Jr||(t=self),t||typeof window===Jr||(t=window),t||typeof i.g===Jr||(t=i.g),ai=t),t}function li(e){throw new TypeError(e)}function ci(e){if(ri)return ri(e);if(null==e)return{};var t=typeof e;function n(){}return t!==Qr&&t!==Xr&&li("Object prototype may only be an Object:"+e),n[Yr]=e,new n}var ui="initialize",di="name",fi="getNotifyMgr",pi="identifier",hi="push",vi="isInitialized",gi="config",mi="instrumentationKey",yi="logger",Si="length",bi="time",wi="processNext",ki="getProcessTelContext",Ei="addNotificationListener",Ai="removeNotificationListener",Ci="stopPollingInternalLogs",Ii="onComplete",Ti="getPlugin",xi="flush",Ri="_extensions",Oi="splice",Pi="teardown",Ni="messageId",Fi="message",Bi="isAsync",Li="_doTeardown",Di="update",Hi="getNext",_i="diagLog",Mi="setNextPlugin",Ui="createNew",zi="cookieCfg",ji="indexOf",$i="substring",Wi="userAgent",qi="split",Vi="setEnabled",Gi="substr",Ki="nodeType",Xi="apply",Qi="replace",Ji="enableDebugExceptions",Yi="call",Zi="type",eo="handler",to="listeners",no="isChildEvt",ro="getCtx",io="setCtx",oo="complete",ao="traceId",so="spanId",lo="traceFlags",co="",uo="channels",fo="core",po="createPerfMgr",ho="disabled",vo="extensionConfig",go="processTelemetry",mo="priority",yo="eventsSent",So="eventsDiscarded",bo="eventsSendRequest",wo="perfEvent",ko="errorToConsole",Eo="warnToConsole",Ao="getPerfMgr",Co="toISOString",Io="endsWith",To="startsWith",xo="indexOf",Ro="trim",Oo="toString",Po="constructor",No=ii,Fo=ei.freeze,Bo=(ei.seal,ei.keys),Lo=String[Yr],Do=Lo[Ro],Ho=Lo[Io],_o=Lo[To],Mo=Date[Yr][Co],Uo=Array.isArray,zo=ti[Oo],jo=oi[Oo],$o=jo[Yi](ei),Wo=/-([a-z])/g,qo=/([^\w\d_$])/g,Vo=/^(\d+[\w\d_$])/,Go=Object.getPrototypeOf;function Ko(e){return void 0===e||typeof e===Jr}function Xo(e){return null===e||Ko(e)}function Qo(e){return!Xo(e)}function Jo(e,t){return!(!e||!oi[Yi](e,t))}function Yo(e){return!(!e||typeof e!==Qr)}function Zo(e){return!(!e||typeof e!==Xr)}function ea(e){var t=e;return t&&oa(t)&&(t=(t=(t=t[Qi](Wo,function(e,t){return t.toUpperCase()}))[Qi](qo,"_"))[Qi](Vo,function(e,t){return"_"+t})),t}function ta(e,t){if(e)for(var n in e)oi[Yi](e,n)&&t[Yi](e,n,e[n])}function na(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=_o?e[To](t):function(e,t){var n=!1,r=t?t[Si]:0;if(e&&r&&e[Si]>=r&&!(n=e===t)){for(var i=0;i<r;i++)if(e[i]!==t[i])return!1;n=!0}return n}(e,t)),n}function ra(e,t){return!(!e||!t)&&-1!==e[ji](t)}var ia=Uo||function(e){return!(!e||"[object Array]"!==zo[Yi](e))};function oa(e){return"string"==typeof e}function aa(e){return"number"==typeof e}function sa(e){return"boolean"==typeof e}function la(e){var t=!1;if(e&&"object"==typeof e){var n=Go?Go(e):function(e){if(e){if(Go)return Go(e);var t=e.__proto__||e[Yr]||e[Po];if(t)return t}return null}(e);n?(n[Po]&&oi[Yi](n,Po)&&(n=n[Po]),t=typeof n===Xr&&jo[Yi](n)===$o):t=!0}return t}function ca(e){if(e)return Mo?e[Co]():function(e){if(e&&e.getUTCFullYear){var t=function(e){var t=String(e);return 1===t[Si]&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(e)}function ua(e,t,n){var r=e[Si];try{for(var i=0;i<r&&(!(i in e)||-1!==t[Yi](n||e,e[i],i,e));i++);}catch(e){}}function da(e,t,n){if(e){if(e[xo])return e[xo](t,n);var r=e[Si],i=n||0;try{for(var o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===t)return o}catch(e){}}return-1}function fa(e){return e&&(e=Do&&e[Ro]?e[Ro]():e[Qi]?e[Qi](/^\s+|(?=\s)\s+$/g,co):e),e}var pa=!{toString:null}.propertyIsEnumerable("toString"),ha=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function va(e){var t=typeof e;if(t===Xr||t===Qr&&null!==e||li("objKeys called on non-object"),!pa&&Bo)return Bo(e);var n=[];for(var r in e)e&&oi[Yi](e,r)&&n[hi](r);if(pa)for(var i=ha[Si],o=0;o<i;o++)e&&oi[Yi](e,ha[o])&&n[hi](ha[o]);return n}function ga(e,t,n,r){if(No)try{var i={enumerable:!0,configurable:!0};return n&&(i.get=n),r&&(i.set=r),No(e,t,i),!0}catch(e){}return!1}var ma=Fo||function(e){return e};function ya(){var e=Date;return e.now?e.now():(new e).getTime()}function Sa(e){return function(e){return!(!e||"[object Error]"!==zo[Yi](e))}(e)?e[di]:co}function ba(e,t,n,r,i){var o=n;return e&&((o=e[t])===n||i&&!i(o)||r&&!r(n)||(o=n,e[t]=o)),o}function wa(e,t,n){var r;return e?!(r=e[t])&&Xo(r)&&(r=Ko(n)?{}:n,e[t]=r):r=Ko(n)?{}:n,r}function ka(e,t){return Xo(e)?t:e}function Ea(e){return!!e}function Aa(e){throw new Error(e)}function Ca(e,t,n,r,i){e&&t&&n&&(!1!==i||Ko(e[t]))&&(e[t]=function(e,t){var n=null,r=null;return Zo(e)?n=e:r=e,function(){var e=arguments;if(n&&(r=n()),r)return r[t][Xi](r,e)}}(n,r))}function Ia(e){return e&&ni&&(e=ei(ni({},e))),e}function Ta(e,t,n,r,i,o){var a=arguments,s=a[0]||{},l=a[Si],c=!1,u=1;for(l>0&&sa(s)&&(c=s,s=a[u]||{},u++),Yo(s)||(s={});u<l;u++){var d=a[u],f=ia(d),p=Yo(d);for(var h in d)if(f&&h in d||p&&oi[Yi](d,h)){var v=d[h],g=void 0;if(c&&v&&((g=ia(v))||la(v))){var m=s[h];g?ia(m)||(m=[]):la(m)||(m={}),v=Ta(c,m,v)}void 0!==v&&(s[h]=v)}}return s}var xa,Ra="Data.",Oa="User.PrimaryIdentityHash",Pa="User.PrimaryIdentitySpace",Na="User.TenantId",Fa="User.IsAnonymous",Ba="User.IsSignedIn",La="f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",Da=void 0;function Ha(e,t,n,r){var i=!0;if(t)for(var o=function(t){var o=t.classification,a=t.dataType,s=t.name;if(o&&!(4===o||1===o||2===r&&32===o||3===r&&2048===o))return i=!1,"break";if(3===r&&n&&3!==a&&1!==a&&2!==a&&"OTelJS.Version"!==s&&"OTelJS.Sink"!==s)return f(0,1,function(){return"DNM: Invalid field type "+s}),i=!1,"break";var l;l=n?"zC."===s.substr(0,3)?"zC."+Ra+s.substr(3):Ra+s:s;var c=void 0;switch(a){case 3:c=6;break;case 2:c=4;break;case 4:c=8;break;case 0:return e[l]="string"==typeof t.value?t.value.substr(0,25e3):t.value,"continue";default:return e[l]=t.value,"continue"}var u={value:t.value,propertyType:c};e[l]=u},a=0,s=t;a<s.length&&"break"!==o(s[a]);a++);return i}function _a(e,t){try{return e()}catch(e){return p(1,"1DS Sink",e),t}}function Ma(e){f(0,1,function(){return"Invalid "+e})}function Ua(e){return oa(e)&&""!==e}function za(e,t){return Object.values(t).includes(e)}function ja(e){return za(e,O)}function $a(e){return za(e,F)}function Wa(e){return["MSACID","MSAPUID","OrgIdCID","OrgIdPUID","UserObjectId","Other"].includes(e)}function qa(e){return!e||"Other"===e}function Va(e,t){var n=!0;function r(t,r){r(e[t])||(Ma(t),n=!1)}function i(e){return new RegExp("^[0-9a-f]{8}-([0-9a-f]{4}-){3}[0-9a-f]{12}$",t?"":"i").test(e)}return r("App.Name",Ua),r("App.Platform",t?ja:Ua),r("App.Version",Ua),r("Session.Id",i),t?(r("Release.AudienceGroup",$a),r(Ba,sa),e[Ba]?(r(Oa,Ua),r(Pa,Wa),["OrgIdCID","OrgIdPUID","UserObjectId"].includes(e[Pa])?r(Na,i):r(Na,Xo)):(r(Pa,qa),r(Na,Xo))):e[Fa]||!1===e[Ba]||(r(Oa,Ua),r(Pa,Ua),e[Na]&&r(Na,i)),Xo(e[Fa])||e[Ba]!==e[Fa]||(Ma(Fa),n=!1),n}var Ga,Ka="undefined",Xa="constructor",Qa="prototype",Ja="function",Ya="_dynInstFuncs",Za="_isDynProxy",es="_dynClass",ts="_dynInstChk",ns=ts,rs="_dfOpts",is="_unknown_",os="__proto__",as="_dyn"+os,ss="__dynProto$Gbl",ls="_dynInstProto",cs="useBaseInst",us="setInstFuncs",ds=Object,fs=ds.getPrototypeOf,ps=ds.getOwnPropertyNames,hs=(typeof globalThis!==Ka&&(Ga=globalThis),Ga||typeof self===Ka||(Ga=self),Ga||typeof window===Ka||(Ga=window),Ga||typeof i.g===Ka||(Ga=i.g),Ga||{}),vs=hs[ss]||(hs[ss]={o:(xa={},xa[us]=!0,xa[cs]=!0,xa),n:1e3});function gs(e,t){return e&&ds[Qa].hasOwnProperty.call(e,t)}function ms(e){return e&&(e===ds[Qa]||e===Array[Qa])}function ys(e){return ms(e)||e===Function[Qa]}function Ss(e){var t;if(e){if(fs)return fs(e);var n=e[os]||e[Qa]||(e[Xa]?e[Xa][Qa]:null);t=e[as]||n,gs(e,as)||(delete e[ls],t=e[as]=e[ls]||e[as],e[ls]=n)}return t}function bs(e,t){var n=[];if(ps)n=ps(e);else for(var r in e)"string"==typeof r&&gs(e,r)&&n.push(r);if(n&&n.length>0)for(var i=0;i<n.length;i++)t(n[i])}function ws(e,t,n){return t!==Xa&&typeof e[t]===Ja&&(n||gs(e,t))&&t!==os&&t!==Qa}function ks(e){throw new TypeError("DynamicProto: "+e)}function Es(){return Object.create?(e=Object.create)?e(null):{}:{};var e}function As(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function Cs(e,t,n,r,i){if(!ms(e)){var o=n[Ya]=n[Ya]||Es();if(!ms(o)){var a=o[t]=o[t]||Es();!1!==o[ns]&&(o[ns]=!!i),ms(a)||bs(n,function(t){ws(n,t,!1)&&n[t]!==r[t]&&(a[t]=n[t],delete n[t],(!gs(e,t)||e[t]&&!e[t][Za])&&(e[t]=function(e,t){var n=function(){var r=function(e,t,n,r){var i=null;if(e&&gs(n,es)){var o=e[Ya]||Es();if((i=(o[n[es]]||Es())[t])||ks("Missing ["+t+"] "+Ja),!i[ts]&&!1!==o[ns]){for(var a=!gs(e,t),s=Ss(e),l=[];a&&s&&!ys(s)&&!As(l,s);){var c=s[t];if(c){a=c===r;break}l.push(s),s=Ss(s)}try{a&&(e[t]=i),i[ts]=1}catch(e){o[ns]=!1}}}return i}(this,t,e,n)||function(e,t,n){var r=t[e];return r===n&&(r=Ss(t)[e]),typeof r!==Ja&&ks("["+e+"] is not a "+Ja),r}(t,e,n);return r.apply(this,arguments)};return n[Za]=1,n}(e,t)))})}}}function Is(e,t){return gs(e,Qa)?e.name||t||is:((e||{})[Xa]||{}).name||t||is}function Ts(e,t,n,r){gs(e,Qa)||ks("theClass is an invalid class definition.");var i=e[Qa];(function(e,t){if(fs){for(var n=[],r=Ss(t);r&&!ys(r)&&!As(n,r);){if(r===e)return!0;n.push(r),r=Ss(r)}return!1}return!0})(i,t)||ks("["+Is(e)+"] not in hierarchy of ["+Is(t)+"]");var o=null;gs(i,es)?o=i[es]:(o="_dynCls$"+Is(e,"_")+"$"+vs.n,vs.n++,i[es]=o);var a=Ts[rs],s=!!a[cs];s&&r&&void 0!==r[cs]&&(s=!!r[cs]);var l=function(e){var t=Es();return bs(e,function(n){!t[n]&&ws(e,n,!1)&&(t[n]=e[n])}),t}(t),c=function(e,t,n,r){function i(e,t,n){var i=t[n];if(i[Za]&&r){var o=e[Ya]||{};!1!==o[ns]&&(i=(o[t[es]]||{})[n]||i)}return function(){return i.apply(e,arguments)}}var o=Es();bs(n,function(e){o[e]=i(t,n,e)});for(var a=Ss(e),s=[];a&&!ys(a)&&!As(s,a);)bs(a,function(e){!o[e]&&ws(a,e,!fs)&&(o[e]=i(t,a,e))}),s.push(a),a=Ss(a);return o}(i,t,l,s);n(t,c);var u=!!fs&&!!a[us];u&&r&&(u=!!r[us]),Cs(i,o,t,l,!1!==u)}Ts[rs]=vs.o;var xs="window",Rs="JSON",Os="XMLHttpRequest",Ps=null,Ns=null,Fs=null,Bs=null;function Ls(e,t){var n=!1;if(e){try{if(!(n=t in e)){var r=e[Yr];r&&(n=t in r)}}catch(e){}if(!n)try{n=!Ko((new e)[t])}catch(e){}}return n}function Ds(e){var t=si();return t&&t[e]?t[e]:e===xs&&Hs()?window:null}function Hs(){return Boolean(typeof window===Qr&&window)}function _s(){return Hs()?window:Ds(xs)}function Ms(){return Boolean(typeof document===Qr&&document)?document:Ds("document")}function Us(){return Boolean(typeof navigator===Qr&&navigator)}function zs(){return Us()?navigator:Ds("navigator")}function js(e){return typeof location===Qr&&location?location:Ds("location")}function $s(){return Boolean(typeof JSON===Qr&&JSON||null!==Ds(Rs))}function Ws(){return $s()?JSON||Ds(Rs):null}function qs(){var e=zs();return!(!e||!e.product)&&"ReactNative"===e.product}function Vs(){var e=zs();if(e&&(e[Wi]!==Ns||null===Ps)){var t=((Ns=e[Wi])||co).toLowerCase();Ps=ra(t,"msie")||ra(t,"trident/")}return Ps}function Gs(e){var t=Object[Yr].toString[Yi](e),n=co;return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e[di]+"'":$s()&&(n=Ws().stringify(e)),t+n}function Ks(){return null===Bs&&(Bs=Us()&&Boolean(zs().sendBeacon)),Bs}function Xs(e){var t=!1;try{t=!!Ds("fetch");var n=Ds("Request");t&&e&&n&&(t=Ls(n,"keepalive"))}catch(e){}return t}function Qs(){return null===Fs&&(Fs=typeof XDomainRequest!==Jr)&&Js()&&(Fs=Fs&&!Ls(Ds(Os),"withCredentials")),Fs}function Js(){var e=!1;try{e=!!Ds(Os)}catch(e){}return e}var Ys,Zs=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],el=null;function tl(e,t){return function(){var n=arguments,r=nl(t);if(r){var i=r.listener;i&&i[e]&&i[e][Xi](i,n)}}}function nl(e){var t,n=el;return n||!0===e.disableDbgExt||(n=el||((t=Ds("Microsoft"))&&(el=t.ApplicationInsights),el)),n?n.ChromeDbgExt:null}function rl(e){if(!Ys){Ys={};for(var t=0;t<Zs[Si];t++)Ys[Zs[t]]=tl(Zs[t],e)}return Ys}function il(e){return e?'"'+e[Qi](/\"/g,co)+'"':co}function ol(e,t){var n=typeof console!==Jr?console:Ds("console");if(n){var r="log";n[e]&&(r=e),Zo(n[r])&&n[r](t)}}var al=function(){function e(e,t,n,r){void 0===n&&(n=!1);var i=this;i[Ni]=e,i[Fi]=(n?"AI: ":"AI (Internal): ")+e;var o=co;$s()&&(o=Ws().stringify(r));var a=(t?" message:"+il(t):co)+(r?" props:"+il(o):co);i[Fi]+=a}return e.dataType="MessageData",e}(),sl=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n,r,i,o,a=0,s={};Ts(e,this,function(e){function l(t,n){if(!(a>=i)){var o=!0,l="AITR_"+n[Ni];if(s[l]?o=!1:s[l]=!0,o&&(t<=r&&(e.queue[hi](n),a++,c(1===t?"error":"warn",n)),a===i)){var u="Internal events throttle limit per PageView reached for this app.",d=new al(23,u,!1);e.queue[hi](d),1===t?e[ko](u):e[Eo](u)}}}function c(e,n){var r=nl(t||{});r&&r[_i]&&r[_i](e,n)}!function(e){n=ka(e.loggingLevelConsole,0),r=ka(e.loggingLevelTelemetry,1),i=ka(e.maxMessageLimit,25),o=ka(e.enableDebug,ka(e[Ji],!1))}(t||{}),e.consoleLoggingLevel=function(){return n},e.telemetryLoggingLevel=function(){return r},e.maxInternalMessageLimit=function(){return i},e[Ji]=function(){return o},e.throwInternal=function(t,r,i,a,u){void 0===u&&(u=!1);var d=new al(r,i,u,a);if(o)throw Gs(d);var f=1===t?ko:Eo;if(Ko(d[Fi]))c("throw"+(1===t?"Critical":"Warning"),d);else{if(u){var p=+d[Ni];!s[p]&&n>=t&&(e[f](d[Fi]),s[p]=!0)}else n>=t&&e[f](d[Fi]);l(t,d)}},e[Eo]=function(e){ol("warn",e),c("warning",e)},e[ko]=function(e){ol("error",e),c("error",e)},e.resetInternalMessageCount=function(){a=0,s={}},e.logInternalMessage=l})}return e.__ieDyn=1,e}();function ll(e){return e||new sl}function cl(e,t,n,r,i,o){void 0===o&&(o=!1),ll(e).throwInternal(t,n,r,i,o)}function ul(e,t){ll(e)[Eo](t)}var dl="toGMTString",fl="toUTCString",pl="cookie",hl="expires",vl="enabled",gl="isCookieUseDisabled",ml="disableCookiesUsage",yl="_ckMgr",Sl=null,bl=null,wl=null,kl=Ms(),El={},Al={};function Cl(e){return!e||e.isEnabled()}function Il(e,t){return!!(t&&e&&ia(e.ignoreCookies))&&-1!==e.ignoreCookies[ji](t)}function Tl(e,t){var n,r=function(e){var t=e[zi]=e[zi]||{};if(ba(t,"domain",e.cookieDomain,Qo,Xo),ba(t,"path",e.cookiePath||"/",null,Xo),Xo(t[vl])){var n=void 0;Ko(e[gl])||(n=!e[gl]),Ko(e[ml])||(n=!e[ml]),t[vl]=n}return t}(e||Al),i=r.path||"/",o=r.domain,a=!1!==r[vl],s=((n={isEnabled:function(){var e=a&&xl(t),n=Al[yl];return e&&n&&s!==n&&(e=Cl(n)),e}})[Vi]=function(e){a=!1!==e},n.set=function(e,t,n,a,l){var c,u=!1;if(Cl(s)&&!function(e,t){return!!(t&&e&&ia(e.blockedCookies)&&-1!==e.blockedCookies[ji](t))||Il(e,t)}(r,e)){var d={},f=fa(t||co),p=f[ji](";");if(-1!==p&&(f=fa(t[$i](0,p)),d=Rl(t[$i](p+1))),ba(d,"domain",a||o,Ea,Ko),!Xo(n)){var h=Vs();if(Ko(d[hl])){var v=ya()+1e3*n;if(v>0){var g=new Date;g.setTime(v),ba(d,hl,Ol(g,h?dl:fl)||Ol(g,h?dl:fl)||co,Ea)}}h||ba(d,"max-age",co+n,null,Ko)}var m=js();m&&"https:"===m.protocol&&(ba(d,"secure",null,null,Ko),null===bl&&(c=(zs()||{})[Wi],bl=!(oa(c)&&(ra(c,"CPU iPhone OS 12")||ra(c,"iPad; CPU OS 12")||ra(c,"Macintosh; Intel Mac OS X 10_14")&&ra(c,"Version/")&&ra(c,"Safari")||ra(c,"Macintosh; Intel Mac OS X 10_14")&&function(e,t){var n=!1;return e&&t&&!(n=e===t)&&(n=Ho?e[Io](t):function(e,t){var n=!1,r=t?t[Si]:0,i=e?e[Si]:0;if(r&&i&&i>=r&&!(n=e===t)){for(var o=i-1,a=r-1;a>=0;a--){if(e[o]!=t[a])return!1;o--}n=!0}return n}(e,t)),n}(c,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||ra(c,"Chrome/5")||ra(c,"Chrome/6")||ra(c,"UnrealEngine")&&!ra(c,"Chrome")||ra(c,"UCBrowser/12")||ra(c,"UCBrowser/11")))),bl&&ba(d,"SameSite","None",null,Ko)),ba(d,"path",l||i,null,Ko),(r.setCookie||Fl)(e,Pl(f,d)),u=!0}return u},n.get=function(e){var t=co;return Cl(s)&&!Il(r,e)&&(t=(r.getCookie||Nl)(e)),t},n.del=function(e,t){var n=!1;return Cl(s)&&(n=s.purge(e,t)),n},n.purge=function(e,n){var i,o=!1;if(xl(t)){var a=((i={}).path=n||"/",i[hl]="Thu, 01 Jan 1970 00:00:01 GMT",i);Vs()||(a["max-age"]="0"),(r.delCookie||Fl)(e,Pl(co,a)),o=!0}return o},n);return s[yl]=s,s}function xl(e){if(null===Sl){Sl=!1;try{Sl=void 0!==(kl||{})[pl]}catch(t){cl(e,2,68,"Cannot access document.cookie - "+Sa(t),{exception:Gs(t)})}}return Sl}function Rl(e){var t={};return e&&e[Si]&&ua(fa(e)[qi](";"),function(e){if(e=fa(e||co)){var n=e[ji]("=");-1===n?t[e]=null:t[fa(e[$i](0,n))]=fa(e[$i](n+1))}}),t}function Ol(e,t){return Zo(e[t])?e[t]():null}function Pl(e,t){var n=e||co;return ta(t,function(e,t){n+="; "+e+(Xo(t)?co:"="+t)}),n}function Nl(e){var t=co;if(kl){var n=kl[pl]||co;wl!==n&&(El=Rl(n),wl=n),t=fa(El[e]||co)}return t}function Fl(e,t){kl&&(kl[pl]=e+"="+t)}var Bl=4294967296,Ll=4294967295,Dl=!1,Hl=123456789,_l=987654321;function Ml(){try{var e=2147483647&ya();(t=(Math.random()*Bl^e)+e)<0&&(t>>>=0),Hl=123456789+t&Ll,_l=987654321-t&Ll,Dl=!0}catch(e){}var t}function Ul(e){var t=0,n=Ds("crypto")||Ds("msCrypto");return n&&n.getRandomValues&&(t=n.getRandomValues(new Uint32Array(1))[0]&Ll),0===t&&Vs()&&(Dl||Ml(),t=function(e){var t=((_l=36969*(65535&_l)+(_l>>16)&Ll)<<16)+(65535&(Hl=18e3*(65535&Hl)+(Hl>>16)&Ll))>>>0&Ll;return e||(t>>>=0),t}()&Ll),0===t&&(t=Math.floor(Bl*Math.random()|0)),e||(t>>>=0),t}var zl=ii,jl="2.8.18",$l="."+function(e){void 0===e&&(e=22);for(var t=Ul()>>>0,n=0,r=co;r[Si]<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Ul()<<2&4294967295|3&t)>>>0,n=0);return r}(6),Wl=0;function ql(e){return 1===e[Ki]||9===e[Ki]||!+e[Ki]}function Vl(e,t){return void 0===t&&(t=!1),ea(e+Wl+++(t?"."+jl:co)+$l)}function Gl(e){var t={id:Vl("_aiData-"+(e||co)+"."+jl),accept:function(e){return ql(e)},get:function(e,n,r,i){var o=e[t.id];return o?o[ea(n)]:(i&&((o=function(e,t){var n=t[e.id];if(!n){n={};try{ql(t)&&(function(e,t,n){if(zl)try{return zl(e,t,{value:n,enumerable:!1,configurable:!0}),!0}catch(e){}return!1}(t,e.id,n)||(t[e.id]=n))}catch(e){}}return n}(t,e))[ea(n)]=r),r)},kill:function(e,t){if(e&&e[t])try{delete e[t]}catch(e){}}};return t}var Kl="attachEvent",Xl="addEventListener",Ql="detachEvent",Jl="removeEventListener",Yl="events",Zl="visibilitychange",ec="pagehide",tc="pageshow",nc="unload",rc="beforeunload",ic=Vl("aiEvtPageHide"),oc=Vl("aiEvtPageShow"),ac=/\.[\.]+/g,sc=/[\.]+$/,lc=1,cc=Gl("events"),uc=/^([^.]*)(?:\.(.+)|)/;function dc(e){return e&&e[Qi]?e[Qi](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,co):e}function fc(e,t){var n;if(t){var r=co;ia(t)?(r=co,ua(t,function(e){(e=dc(e))&&("."!==e[0]&&(e="."+e),r+=e)})):r=dc(t),r&&("."!==r[0]&&(r="."+r),e=(e||co)+r)}var i=uc.exec(e||co)||[];return(n={})[Zi]=i[1],n.ns=(i[2]||co).replace(ac,".").replace(sc,co)[qi](".").sort().join("."),n}function pc(e,t,n){void 0===n&&(n=!0);var r=cc.get(e,Yl,{},n),i=r[t];return i||(i=r[t]=[]),i}function hc(e,t,n,r){e&&t&&t[Zi]&&(e[Jl]?e[Jl](t[Zi],n,r):e[Ql]&&e[Ql]("on"+t[Zi],n))}function vc(e,t,n,r){for(var i=t[Si];i--;){var o=t[i];o&&(n.ns&&n.ns!==o.evtName.ns||r&&!r(o)||(hc(e,o.evtName,o[eo],o.capture),t[Oi](i,1)))}}function gc(e,t){return t?fc("xx",ia(t)?[e].concat(t):[e,t]).ns[qi]("."):e}function mc(e,t,n,r,i){var o;void 0===i&&(i=!1);var a=!1;if(e)try{var s=fc(t,r);if(a=function(e,t,n,r){var i=!1;return e&&t&&t[Zi]&&n&&(e[Xl]?(e[Xl](t[Zi],n,r),i=!0):e[Kl]&&(e[Kl]("on"+t[Zi],n),i=!0)),i}(e,s,n,i),a&&cc.accept(e)){var l=((o={guid:lc++,evtName:s})[eo]=n,o.capture=i,o);pc(e,s.type)[hi](l)}}catch(e){}return a}function yc(e,t,n,r,i){if(void 0===i&&(i=!1),e)try{var o=fc(t,r),a=!1;!function(e,t,n){if(t[Zi])vc(e,pc(e,t[Zi]),t,n);else{var r=cc.get(e,Yl,{});ta(r,function(r,i){vc(e,i,t,n)}),0===va(r)[Si]&&cc.kill(e,Yl)}}(e,o,function(e){return!((!o.ns||n)&&e[eo]!==n||(a=!0,0))}),a||hc(e,o,n,i)}catch(e){}}function Sc(e,t,n,r){var i=!1;return t&&e&&e[Si]>0&&ua(e,function(e){e&&(n&&-1!==da(n,e)||(i=function(e,t,n){var r=!1,i=_s();i&&(r=mc(i,e,t,n),r=mc(i.body,e,t,n)||r);var o=Ms();return o&&(r=mc(o,e,t,n)||r),r}(e,t,r)||i))}),i}function bc(e,t,n){e&&ia(e)&&ua(e,function(e){e&&function(e,t,n){var r=_s();r&&(yc(r,e,t,n),yc(r.body,e,t,n));var i=Ms();i&&yc(i,e,t,n)}(e,t,n)})}function wc(e,t,n){var r=gc(ic,n),i=Sc([ec],e,t,r);return t&&-1!==da(t,Zl)||(i=Sc([Zl],function(t){var n=Ms();e&&n&&"hidden"===n.visibilityState&&e(t)},t,r)||i),!i&&t&&(i=wc(e,null,n)),i}function kc(e,t,n){var r=gc(oc,n),i=Sc([tc],e,t,r);return!(i=Sc([Zl],function(t){var n=Ms();e&&n&&"visible"===n.visibilityState&&e(t)},t,r)||i)&&t&&(i=kc(e,null,n)),i}function Ec(){var e=function(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n=co,r=0;r<4;r++)n+=t[15&(e=Ul())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var i=t[8+(3&Ul())|0];return n[Gi](0,8)+n[Gi](9,4)+"4"+n[Gi](13,3)+i+n[Gi](16,3)+n[Gi](19,12)}();return e[$i](0,8)+"-"+e[$i](8,12)+"-"+e[$i](12,16)+"-"+e[$i](16,20)+"-"+e[$i](20)}var Ac,Cc,Ic=(Cc={},ta({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},function(e,t){Cc[e]=t,Cc[t]=e}),Ac=Cc,Fo&&ta(Ac,function(e,t){(ia(t)||Yo(t))&&Fo(t)}),ma(Ac)),Tc=((si()||{}).Symbol,(si()||{}).Reflect,function(e,t){return Tc=ei.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[Zr](n)&&(e[n]=t[n])},Tc(e,t)});function xc(e,t){function n(){this.constructor=e}typeof t!==Xr&&null!==t&&li("Class extends value "+String(t)+" is not a constructor or null"),Tc(e,t),e[Yr]=null===t?ci(t):(n[Yr]=t[Yr],new n)}function Rc(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}var Oc="ctx",Pc="ParentContextKey",Nc="ChildrenContextKey",Fc=function(){function e(t,n,r){var i,o=this,a=!1;o.start=ya(),o[di]=t,o[Bi]=r,o[no]=function(){return!1},Zo(n)&&(a=ga(o,"payload",function(){return!i&&Zo(n)&&(i=n(),n=null),i})),o[ro]=function(t){return t?t===e[Pc]||t===e[Nc]?o[t]:(o[Oc]||{})[t]:null},o[io]=function(t,n){t&&(t===e[Pc]?(o[t]||(o[no]=function(){return!0}),o[t]=n):t===e[Nc]?o[t]=n:(o[Oc]=o[Oc]||{})[t]=n)},o[oo]=function(){var t=0,r=o[ro](e[Nc]);if(ia(r))for(var i=0;i<r[Si];i++){var s=r[i];s&&(t+=s[bi])}o[bi]=ya()-o.start,o.exTime=o[bi]-t,o[oo]=function(){},!a&&Zo(n)&&(o.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Bc=function(){function e(t){this.ctx={},Ts(e,this,function(e){e.create=function(e,t,n){return new Fc(e,t,n)},e.fire=function(e){e&&(e[oo](),t&&Zo(t[wo])&&t[wo](e))},e[io]=function(t,n){t&&((e[Oc]=e[Oc]||{})[t]=n)},e[ro]=function(t){return(e[Oc]||{})[t]}})}return e.__ieDyn=1,e}(),Lc="CoreUtils.doPerf";function Dc(e,t,n,r,i){if(e){var o=e;if(o[Ao]&&(o=o[Ao]()),o){var a=void 0,s=o[ro](Lc);try{if(a=o.create(t(),r,i)){if(s&&a[io]&&(a[io](Fc[Pc],s),s[ro]&&s[io])){var l=s[ro](Fc[Nc]);l||(l=[],s[io](Fc[Nc],l)),l[hi](a)}return o[io](Lc,a),n(a)}}catch(e){a&&a[io]&&a[io]("exception",e)}finally{a&&o.fire(a),o[io](Lc,s)}}}return n()}function Hc(e,t,n){return!(!e||e[Si]!==t||e===n||!e.match(/^[\da-f]*$/i))}var _c=Gl("plugin");function Mc(e){return _c.get(e,"state",{},!0)}function Uc(e,t){for(var n,r=[],i=null,o=e[Hi]();o;){var a=o[Ti]();a&&(i&&Zo(i[Mi])&&Zo(a[go])&&i[Mi](a),(Zo(a[vi])?a[vi]():(n=Mc(a))[vi])||r[hi](a),i=a,o=o[Hi]())}ua(r,function(r){var i=e[fo]();r[ui](e.getCfg(),i,t,e[Hi]()),n=Mc(r),r[fo]||n[fo]||(n[fo]=i),n[vi]=!0,delete n[Pi]})}function zc(e){return e.sort(function(e,t){var n=0;if(t){var r=Zo(t[go]);Zo(e[go])?n=r?e[mo]-t[mo]:1:r&&(n=-1)}else n=e?1:-1;return n})}var jc="_hasRun",$c="_getTelCtx",Wc=0;function qc(e,t,n,r){var i=null,o=[];null!==r&&(i=r?function(e,t,n){for(;e;){if(e[Ti]()===n)return e;e=e[Hi]()}return Xc([n],t[gi]||{},t)}(e,n,r):e);var a={_next:function(){var e=i;if(i=e?e[Hi]():null,!e){var t=o;t&&t[Si]>0&&(ua(t,function(e){try{e.func[Yi](e.self,e.args)}catch(e){cl(n[yi],2,73,"Unexpected Exception during onComplete - "+Gs(e))}}),o=[])}return e},ctx:{core:function(){return n},diagLog:function(){return function(e,t){return(e||{})[yi]||new sl(t)}(n,t)},getCfg:function(){return t},getExtCfg:s,getConfig:function(e,n,r){void 0===r&&(r=!1);var i,o=s(e,null);return o&&!Xo(o[n])?i=o[n]:t&&!Xo(t[n])&&(i=t[n]),Xo(i)?r:i},hasNext:function(){return!!i},getNext:function(){return i},setNext:function(e){i=e},iterate:function(e){for(var t;t=a._next();){var n=t[Ti]();n&&e(n)}},onComplete:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];e&&o[hi]({func:e,self:Ko(t)?a.ctx:t,args:n})}}};function s(e,n,r){var i;if(void 0===n&&(n={}),void 0===r&&(r=0),t){var o=t[vo];o&&e&&(i=o[e])}if(i){if(Yo(n)&&0!==r){var a=Ta(!0,n,i);t&&2===r&&ta(n,function(e){if(Xo(a[e])){var n=t[e];Xo(n)||(a[e]=n)}}),i=a}}else i=n;return i}return a}function Vc(e,t,n,r){var i=qc(e,t,n,r),o=i.ctx;return o[wi]=function(e){var t=i._next();return t&&t[go](e,o),!t},o[Ui]=function(e,r){return void 0===e&&(e=null),ia(e)&&(e=Xc(e,t,n,r)),Vc(e||o[Hi](),t,n,r)},o}function Gc(e,t,n){var r=t[gi]||{},i=qc(e,r,t,n),o=i.ctx;return o[wi]=function(e){var t=i._next();return t&&t.unload(o,e),!t},o[Ui]=function(e,n){return void 0===e&&(e=null),ia(e)&&(e=Xc(e,r,t,n)),Gc(e||o[Hi](),t,n)},o}function Kc(e,t,n){var r=t[gi]||{},i=qc(e,r,t,n).ctx;return i[wi]=function(e){return i.iterate(function(t){Zo(t[Di])&&t[Di](i,e)})},i[Ui]=function(e,n){return void 0===e&&(e=null),ia(e)&&(e=Xc(e,r,t,n)),Kc(e||i[Hi](),t,n)},i}function Xc(e,t,n,r){var i=null,o=!r;if(ia(e)&&e[Si]>0){var a=null;ua(e,function(e){if(o||r!==e||(o=!0),o&&e&&Zo(e[go])){var s=function(e,t,n){var r,i=null,o=Zo(e[go]),a=Zo(e[Mi]),s={getPlugin:function(){return e},getNext:function(){return i},processTelemetry:function(r,c){l(c=c||function(){var r;return e&&Zo(e[$c])&&(r=e[$c]()),r||(r=Vc(s,t,n)),r}(),function(t){if(!e||!o)return!1;var n=Mc(e);return!n[Pi]&&!n[ho]&&(a&&e[Mi](i),e[go](r,t),!0)},"processTelemetry",function(){return{item:r}},!r.sync)||c[wi](r)},unload:function(t,n){l(t,function(){var r=!1;if(e){var i=Mc(e),o=e[fo]||i[fo];!e||o&&o!==t.core()||i[Pi]||(i[fo]=null,i[Pi]=!0,i[vi]=!1,e[Pi]&&!0===e[Pi](t,n)&&(r=!0))}return r},"unload",function(){},n[Bi])||t[wi](n)},update:function(t,n){l(t,function(){var r=!1;if(e){var i=Mc(e),o=e[fo]||i[fo];!e||o&&o!==t.core()||i[Pi]||e[Di]&&!0===e[Di](t,n)&&(r=!0)}return r},"update",function(){},!1)||t[wi](n)},_id:r=e?e[pi]+"-"+e[mo]+"-"+Wc++:"Unknown-0-"+Wc++,_setNext:function(e){i=e}};function l(t,n,o,a,s){var l=!1,c=e?e[pi]:"TelemetryPluginChain",u=t[jc];return u||(u=t[jc]={}),t.setNext(i),e&&Dc(t[fo](),function(){return c+":"+o},function(){u[r]=!0;try{var e=i?i._id:co;e&&(u[e]=!1),l=n(t)}catch(e){var a=!i||u[i._id];a&&(l=!0),i&&a||cl(t[_i](),1,73,"Plugin ["+c+"] failed during "+o+" - "+Gs(e)+", run flags: "+Gs(u))}},a,s),l}return ma(s)}(e,t,n);i||(i=s),a&&a._setNext(s),a=s}})}return r&&!i?Xc([r],t,n):i}var Qc=500;function Jc(e,t,n){t&&ia(t)&&t[Si]>0&&(ua(t=t.sort(function(e,t){return e[mo]-t[mo]}),function(e){e[mo]<Qc&&Aa("Channel has invalid priority - "+e[pi])}),e[hi]({queue:ma(t),chain:Xc(t,n[gi],n)}))}function Yc(){var e=[];return{add:function(t){t&&e[hi](t)},run:function(t,n){ua(e,function(e){try{e(t,n)}catch(e){cl(t[_i](),2,73,"Unexpected error calling unload handler - "+Gs(e))}}),e=[]}}}var Zc="getPlugin",eu=function(){function e(){var t,n,r,i,o,a=this;function s(e){void 0===e&&(e=null);var t=e;if(!t){var i=n||Vc(null,{},a[fo]);t=r&&r[Zc]?i[Ui](null,r[Zc]):i[Ui](null,r)}return t}function l(e,t,i){e&&ba(e,vo,[],null,Xo),!i&&t&&(i=t[ki]()[Hi]());var o=r;r&&r[Zc]&&(o=r[Zc]()),a[fo]=t,n=Vc(i,e,t,o)}function c(){t=!1,a[fo]=null,n=null,r=null,o=[],i=Yc()}c(),Ts(e,a,function(e){e[ui]=function(e,n,r,i){l(e,n,i),t=!0},e[Pi]=function(t,n){var a,s=e[fo];if(s&&(!t||s===t[fo]())){var l,u=!1,d=t||Gc(null,s,r&&r[Zc]?r[Zc]():r),f=n||((a={reason:0})[Bi]=!1,a);return e[Li]&&!0===e[Li](d,f,p)?l=!0:p(),l}function p(){if(!u){u=!0,i.run(d,n);var e=o;o=[],ua(e,function(e){e.rm()}),!0===l&&d[wi](f),c()}}},e[Di]=function(t,n){var i=e[fo];if(i&&(!t||i===t[fo]())){var o,a=!1,s=t||Kc(null,i,r&&r[Zc]?r[Zc]():r),c=n||{reason:0};return e._doUpdate&&!0===e._doUpdate(s,c,u)?o=!0:u(),o}function u(){a||(a=!0,l(s.getCfg(),s.core(),s[Hi]()))}},e._addHook=function(e){e&&(ia(e)?o=o.concat(e):o[hi](e))},Ca(e,"_addUnloadCb",function(){return i},"add")}),a[_i]=function(e){return s(e)[_i]()},a[vi]=function(){return t},a.setInitialized=function(e){t=e},a[Mi]=function(e){r=e},a[wi]=function(e,t){t?t[wi](e):r&&Zo(r[go])&&r[go](e,null)},a._getTelCtx=s}return e.__ieDyn=1,e}(),tu=function(e){function t(){var n,r,i=e.call(this)||this;function o(){n=0,r=[]}return i.identifier="TelemetryInitializerPlugin",i.priority=199,o(),Ts(t,i,function(e,t){e.addTelemetryInitializer=function(e){var t={id:n++,fn:e};return r[hi](t),{remove:function(){ua(r,function(e,n){if(e.id===t.id)return r[Oi](n,1),-1})}}},e[go]=function(t,n){for(var i=!1,o=r[Si],a=0;a<o;++a){var s=r[a];if(s)try{if(!1===s.fn[Xi](null,[t])){i=!0;break}}catch(e){cl(n[_i](),1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+Sa(e),{exception:Gs(e)},!0)}}i||e[wi](t,n)},e[Li]=function(){o()}}),i}return xc(t,e),t.__ieDyn=1,t}(eu),nu="Plugins must provide initialize method",ru="_notificationManager",iu="SDK is still unloading...",ou={loggingLevelConsole:1};function au(e,t){return new Bc(t)}function su(e,t){var n=!1;return ua(t,function(t){if(t===e)return n=!0,-1}),n}var lu=function(){function e(){var t,n,r,i,o,a,s,l,c,u,d,f,p,h,v,g,m,y,S,b,w=0,k=!1;Ts(e,this,function(e){function E(n){if(!w&&!k&&(n||e[yi]&&e[yi].queue[Si]>0)){var r=ka(t.diagnosticLogInterval);r&&r>0||(r=1e4),w=setInterval(function(){clearInterval(w),w=0,O()},r)}return w}function A(){n=!1,t=Ta(!0,{},ou),e[gi]=t,e[yi]=new sl(t),e[Ri]=[],v=new tu,r=[],i=null,o=null,a=null,s=null,l=null,u=null,c=[],d=null,f=null,p=null,h=!1,g=null,m=Vl("AIBaseCore",!0),y=Yc(),b=null}function C(){var n=Vc(x(),t,e);return n[Ii](E),n}function I(n){var r=function(e,t,n){var r,i=[],o={};return ua(n,function(t){(Xo(t)||Xo(t[ui]))&&Aa(nu);var n=t[mo],r=t[pi];t&&n&&(Xo(o[n])?o[n]=r:ul(e,"Two extensions have same priority #"+n+" - "+o[n]+", "+r)),(!n||n<500)&&i[hi](t)}),(r={all:n})[fo]=i,r}(e[yi],0,c);u=r[fo],l=null;var i=r.all;if(p=ma(function(e,t,n){var r=[];if(e&&ua(e,function(e){return Jc(r,e,n)}),t){var i=[];ua(t,function(e){e[mo]>Qc&&i[hi](e)}),Jc(r,i,n)}return r}(f,i,e)),d){var o=da(i,d);-1!==o&&i[Oi](o,1),-1!==(o=da(u,d))&&u[Oi](o,1),d._setQueue(p)}else d=function(e,t){function n(){return Vc(null,t[gi],t,null)}function r(e,t,n,r){var i=e?e[Si]+1:1;function o(){0===--i&&(r&&r(),r=null)}i>0&&ua(e,function(e){if(e&&e.queue[Si]>0){var r=e.chain,a=t[Ui](r);a[Ii](o),n(a)}else i--}),o()}var i=!1,o={identifier:"ChannelControllerPlugin",priority:Qc,initialize:function(t,n,r,o){i=!0,ua(e,function(e){e&&e.queue[Si]>0&&Uc(Vc(e.chain,t,n),r)})},isInitialized:function(){return i},processTelemetry:function(t,i){r(e,i||n(),function(e){e[wi](t)},function(){i[wi](t)})},update:function(t,n){var i=n||{reason:0};return r(e,t,function(e){e[wi](i)},function(){t[wi](i)}),!0},pause:function(){r(e,n(),function(e){e.iterate(function(e){e.pause&&e.pause()})},null)},resume:function(){r(e,n(),function(e){e.iterate(function(e){e.resume&&e.resume()})},null)},teardown:function(t,n){var o=n||{reason:0,isAsync:!1};return r(e,t,function(e){e[wi](o)},function(){t[wi](o),i=!1}),!0},getChannel:function(t){var n=null;return e&&e[Si]>0&&ua(e,function(e){if(e&&e.queue[Si]>0&&(ua(e.queue,function(e){if(e[pi]===t)return n=e,-1}),n))return-1}),n},flush:function(t,i,o,a){var s=1,l=!1,c=null;function u(){s--,l&&0===s&&(c&&(clearTimeout(c),c=null),i&&i(l),i=null)}return a=a||5e3,r(e,n(),function(e){e.iterate(function(e){if(e[xi]){s++;var n=!1;e[xi](t,function(){n=!0,u()},o)||n||(t&&null==c?c=setTimeout(function(){c=null,u()},a):u())}})},function(){l=!0,u()}),!0},_setQueue:function(t){e=t}};return o}(p,e);i[hi](d),u[hi](d),e[Ri]=zc(i),d[ui](t,e,i),Uc(C(),i),e[Ri]=ma(zc(u||[])).slice(),n&&function(t){var n=Kc(x(),e);n[Ii](E),e._updateHook&&!0===e._updateHook(n,t)||n[wi](t)}(n)}function T(t){var n,r=null,i=null;return ua(e[Ri],function(e){if(e[pi]===t&&e!==d&&e!==v)return i=e,-1}),!i&&d&&(i=d.getChannel(t)),i&&((n={plugin:i})[Vi]=function(e){Mc(i)[ho]=!e},n.isEnabled=function(){var e=Mc(i);return!e[Pi]&&!e[ho]},n.remove=function(e,t){var n;void 0===e&&(e=!0);var r=[i],o=((n={reason:1})[Bi]=e,n);R(r,o,function(e){e&&I({reason:32,removed:r}),t&&t(e)})},r=n),r}function x(){if(!l){var n=(u||[]).slice();-1===da(n,v)&&n[hi](v),l=Xc(zc(n),t,e)}return l}function R(n,r,i){if(n&&n[Si]>0){var o=Gc(Xc(n,t,e),e);o[Ii](function(){var e=!1,t=[];ua(c,function(r,i){su(r,n)?e=!0:t[hi](r)}),c=t;var r=[];f&&(ua(f,function(t,i){var o=[];ua(t,function(t){su(t,n)?e=!0:o[hi](t)}),r[hi](o)}),f=r),i&&i(e),E()}),o[wi](r)}else i(!1)}function O(){if(e[yi]&&e[yi].queue){var n=e[yi].queue.slice(0);e[yi].queue[Si]=0,ua(n,function(n){var r,i=((r={})[di]=g||"InternalMessageId: "+n[Ni],r.iKey=ka(t[mi]),r.time=ca(new Date),r.baseType=al.dataType,r.baseData={message:n[Fi]},r);e.track(i)})}}function P(e,t,n,r){return d?d[xi](e,t,n||6,r):(t&&t(!1),!0)}function N(t){var n=e[yi];n?(cl(n,2,73,t),E()):Aa(t)}var F,B,L,D;A(),e[vi]=function(){return n},e[ui]=function(r,o,s,l){var u,d;h&&Aa(iu),e[vi]()&&Aa("Core should not be initialized more than once"),t=r||{},e[gi]=t,Xo(r[mi])&&Aa("Please provide instrumentation key"),i=l,e[ru]=l,!0===(d=ka(t.disableDbgExt))&&S&&(i[Ai](S),S=null),i&&!S&&!0!==d&&(S=rl(t),i[Ei](S)),!(u=ka(t.enablePerfMgr))&&a&&(a=null),u&&wa(t,po,au),wa(t,vo,{}).NotificationManager=i,s&&(e[yi]=s);var v=wa(t,"extensions",[]);(c=[])[hi].apply(c,Rc(Rc([],o),v)),f=wa(t,uo,[]),I(null),p&&0!==p[Si]||Aa("No "+uo+" available"),n=!0,e.releaseQueue()},e.getTransmissionControls=function(){var e=[];return p&&ua(p,function(t){e[hi](t.queue)}),ma(e)},e.track=function(n){n.iKey=n.iKey||t[mi],n[bi]=n[bi]||ca(new Date),n.ver=n.ver||"4.0",!h&&e[vi]()?C()[wi](n):r[hi](n)},e[ki]=C,e[fi]=function(){return i||(i=function(){var e;return ci(((e={})[Ei]=function(e){},e[Ai]=function(e){},e[yo]=function(e){},e[So]=function(e,t){},e[bo]=function(e,t){},e))}(),e[ru]=i),i},e[Ei]=function(e){i&&i[Ei](e)},e[Ai]=function(e){i&&i[Ai](e)},e.getCookieMgr=function(){return s||(s=Tl(t,e[yi])),s},e.setCookieMgr=function(e){s=e},e[Ao]=function(){if(!o&&!a&&ka(t.enablePerfMgr)){var n=ka(t[po]);Zo(n)&&(a=n(e,e[fi]()))}return o||a||null},e.setPerfMgr=function(e){o=e},e.eventCnt=function(){return r[Si]},e.releaseQueue=function(){if(n&&r[Si]>0){var e=r;r=[],ua(e,function(e){C()[wi](e)})}},e.pollInternalLogs=function(e){return g=e||null,k=!1,w&&(clearInterval(w),w=null),E(!0)},e[Ci]=function(){k=!0,w&&(clearInterval(w),w=0,O())},B=function(){return v},L=["addTelemetryInitializer"],(F=e)&&B&&Yo(F)&&ia(L)&&ua(L,function(e){oa(e)&&Ca(F,e,B,e,D)}),e.unload=function(t,r,i){var o;void 0===t&&(t=!0),n||Aa("SDK is not initialized"),h&&Aa(iu);var a=((o={reason:50})[Bi]=t,o.flushComplete=!1,o),s=Gc(x(),e);function l(t){a.flushComplete=t,h=!0,y.run(s,a),e[Ci](),s[wi](a)}s[Ii](function(){A(),r&&r(a)},e),O(),P(t,l,6,i)||l(!1)},e[Ti]=T,e.addPlugin=function(e,t,n,r){if(!e)return r&&r(!1),void N(nu);var i=T(e[pi]);if(i&&!t)return r&&r(!1),void N("Plugin ["+e[pi]+"] is already loaded!");var o={reason:16};function a(t){c[hi](e),o.added=[e],I(o),r&&r(!0)}if(i){var s=[i.plugin];R(s,{reason:2,isAsync:!!n},function(e){e?(o.removed=s,o.reason|=32,a()):r&&r(!1)})}else a()},e.evtNamespace=function(){return m},e[xi]=P,e.getTraceCtx=function(e){var t;return b||(t={},b={getName:function(){return t[di]},setName:function(e){t[di]=e},getTraceId:function(){return t[ao]},setTraceId:function(e){Hc(e,32,"00000000000000000000000000000000")&&(t[ao]=e)},getSpanId:function(){return t[so]},setSpanId:function(e){Hc(e,16,"0000000000000000")&&(t[so]=e)},getTraceFlags:function(){return t[lo]},setTraceFlags:function(e){t[lo]=e}}),b},e.setTraceCtx=function(e){b=e||null},Ca(e,"addUnloadCb",function(){return y},"add")})}return e.__ieDyn=1,e}();function cu(e,t,n,r){ua(e,function(e){if(e&&e[t])if(n)setTimeout(function(){return r(e)},0);else try{r(e)}catch(e){}})}var uu,du=function(){function e(t){this.listeners=[];var n=!!(t||{}).perfEvtsSendAll;Ts(e,this,function(e){e[Ei]=function(t){e.listeners[hi](t)},e[Ai]=function(t){for(var n=da(e[to],t);n>-1;)e.listeners[Oi](n,1),n=da(e[to],t)},e[yo]=function(t){cu(e[to],yo,!0,function(e){e[yo](t)})},e[So]=function(t,n){cu(e[to],So,!0,function(e){e[So](t,n)})},e[bo]=function(t,n){cu(e[to],bo,n,function(e){e[bo](t,n)})},e[wo]=function(t){t&&(!n&&t[no]()||cu(e[to],wo,!1,function(e){t[Bi]?setTimeout(function(){return e[wo](t)},0):e[wo](t)}))}})}return e.__ieDyn=1,e}(),fu=function(e){function t(){var n=e.call(this)||this;return Ts(t,n,function(e,t){function n(t){var n=e[fi]();n&&n[So]([t],2)}e[ui]=function(e,n,r,i){t[ui](e,n,r||new sl(e),i||new du(e))},e.track=function(r){Dc(e[Ao](),function(){return"AppInsightsCore:track"},function(){null===r&&(n(r),Aa("Invalid telemetry item")),function(e){Xo(e[di])&&(n(e),Aa("telemetry name required"))}(r),t.track(r)},function(){return{item:r}},!r.sync)}}),n}return xc(t,e),t.__ieDyn=1,t}(lu),pu="version",hu="properties",vu="1DS-Web-JS-3.2.18",gu="withCredentials",mu=((uu={})[0]=0,uu[2]=6,uu[1]=1,uu[3]=7,uu[4098]=6,uu[4097]=1,uu[4099]=7,uu);function yu(e){return!(""===e||Xo(e))}function Su(e,t,n){var r=-1;if(!Ko(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){return e>=0&&e<=9}(n))-1===r&&(r=0),r|=n;else{var i=mu[Eu(e)]||-1;-1!==r&&-1!==i?r|=i:6===i&&(r=i)}return r}function bu(e,t,n,r,i){var o={},a=!1,s=0,l=arguments.length,c=arguments;for("[object Boolean]"===Object[Yr].toString.call(c[0])&&(a=c[0],s++);s<l;s++)ta(c[s],function(e,t){a&&t&&Yo(t)?ia(t)?(o[e]=o[e]||[],ua(t,function(t,n){t&&Yo(t)?o[e][n]=bu(!0,o[e][n],t):o[e][n]=t})):o[e]=bu(!0,o[e],t):o[e]=t});return o}Boolean(Ms()),Boolean(_s());var wu=function(){var e=Ds("performance");return e&&e.now?e.now():ya()};function ku(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=wu()}function Eu(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===Qr&&(t=4,ia(e)?(t=4096,e.length>0&&(t|=Eu(e[0]))):oi.call(e,"value")&&(t=8192|Eu(e.value)))}return t}var Au=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],Ts(t,n,function(e,t){e.logger&&e.logger.queue||(e.logger=new sl({loggingLevelConsole:1})),e.initialize=function(n,r,i,o){Dc(e,function(){return"AppInsightsCore.initialize"},function(){var a=e.pluginVersionStringArr;if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var s=n.propertyStorageOverride;!s||s.getProperty&&s.setProperty||Aa("Invalid property storage override passed."),n.channels&&ua(n.channels,function(e){e&&ua(e,function(e){if(e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}})})}e.getWParam=function(){return"undefined"!=typeof document||n.enableWParam?0:-1},r&&ua(r,function(e){if(e&&e.identifier&&e.version){var t=e.identifier+"="+e.version;a.push(t)}}),e.pluginVersionString=a.join(";"),e.pluginVersionStringArr=a;try{t.initialize(n,r,i,o),e.pollInternalLogs("InternalLog")}catch(t){var l=e.logger,c=Gs(t);-1!==c.indexOf("channels")&&(c+="\n - Channels must be provided through config.channels only!"),cl(l,1,514,"SDK Initialization Failed - no telemetry will be sent: "+c)}},function(){return{config:n,extensions:r,logger:i,notificationManager:o}})},e.track=function(n){Dc(e,function(){return"AppInsightsCore.track"},function(){var r,i=n;if(i){i.timings=i.timings||{},i.timings.trackStart=wu(),(r=i.latency)&&aa(r)&&r>=1&&r<=4||(i.latency=1);var o=i.ext=i.ext||{};o.sdk=o.sdk||{},o.sdk.ver=vu;var a=i.baseData=i.baseData||{};a[hu]=a[hu]||{};var s=a[hu];s[pu]=s[pu]||e.pluginVersionString||""}t.track(i)},function(){return{item:n}},!n.sync)}}),n}return xc(t,e),t.__ieDyn=1,t}(fu);const Cu=Au;var Iu="REAL_TIME",Tu="",xu="POST",Ru="drop",Ou="requeue",Pu="application/x-json-stream",Nu="cache-control",Fu="content-type",Bu="kill-duration",Lu="time-delta-millis",Du="client-version",Hu="client-id",_u="time-delta-to-apply-millis",Mu="upload-time",Uu="apikey",zu="AuthMsaDeviceTicket",ju="AuthXToken",$u="msfpc",Wu="trace",qu="user";function Vu(e){var t=(e.ext||{}).intweb;return t&&yu(t[$u])?t[$u]:null}function Gu(e){for(var t=null,n=0;null===t&&n<e.length;n++)t=Vu(e[n]);return t}var Ku=function(){function e(t,n){var r=n?[].concat(n):[],i=this,o=Gu(r);i.iKey=function(){return t},i.Msfpc=function(){return o||Tu},i.count=function(){return r.length},i.events=function(){return r},i.addEvent=function(e){return!!e&&(r.push(e),o||(o=Vu(e)),!0)},i.split=function(n,i){var a;if(n<r.length){var s=r.length-n;Xo(i)||(s=i<s?i:s),a=r.splice(n,s),o=Gu(r)}return new e(t,a)}}return e.create=function(t,n){return new e(t,n)},e}();const Xu=function(){function e(){var t=!0,n=!0,r=!0,i="use-collector-delta",o=!1;Ts(e,this,function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){r&&(r=!1,o||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,n=!0,o=!0):n=!1,t=!0)}})}return e.__ieDyn=1,e}();var Qu=function(){function e(){var t={};Ts(e,this,function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var r=function(e){var t=[];return e&&ua(e,function(e){t.push(fa(e))}),t}(e.split(","));if("this-request-only"===n)return r;for(var i=1e3*parseInt(n,10),o=0;o<r.length;++o)t[r[o]]=ya()+i}catch(e){return[]}return[]},e.isTenantKilled=function(e){var n=t,r=fa(e);return void 0!==n[r]&&n[r]>ya()||(delete n[r],!1)}})}return e.__ieDyn=1,e}();const Ju=Qu;function Yu(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)}var Zu,ed=2e6,td=Math.min(ed,65e3),nd="metadata",rd="f",id=/\./,od=function(){function e(t,n,r,i){var o="data",a="baseData",s=!!i,l=!0,c=n,u={};Ts(e,this,function(e){function n(e,t,i,o,a,l,d){ta(e,function(e,f){var p=null;if(f||yu(f)){var h=i,v=e,g=a,m=t;if(s&&!o&&id.test(e)){var y=e.split("."),S=y.length;if(S>1){g&&(g=g.slice());for(var b=0;b<S-1;b++){var w=y[b];m=m[w]=m[w]||{},h+="."+w,g&&g.push(w)}v=y[S-1]}}var k=o&&function(e){var t=u[e];return void 0===t&&(e.length>=7&&(t=na(e,"ext.metadata")||na(e,"ext.web")),u[e]=t),t}(h);if(p=!k&&c&&c.handleField(h,v)?c.value(h,v,f,r):function(e,t,n){if(!t&&!yu(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||ia(t))t={value:t};else if("object"!==r||oi.call(t,"value")){if(Xo(t.value)||""===t.value||!oa(t.value)&&!aa(t.value)&&!sa(t.value)&&!ia(t.value))return null}else t={value:n?JSON.stringify(t):t};if(ia(t.value)&&!(t.value.length>0))return null;if(!Xo(t.kind)){if(ia(t.value)||!(0===(i=t.kind)||i>0&&i<=13||32===i))return null;t.value=t.value.toString()}var i;return t}(v,f,r)){var E=p.value;if(m[v]=E,l&&l(g,v,p),d&&"object"==typeof E&&!ia(E)){var A=g;A&&(A=A.slice()).push(v),n(f,E,h+"."+v,o,A,l,d)}}}})}e.createPayload=function(e,t,n,r,i,o){return{apiKeys:[],payloadBlob:Tu,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(n,r,i){var o=n&&r&&!n.overflow;return o&&Dc(t,function(){return"Serializer:appendPayload"},function(){for(var t=r.events(),o=n.payloadBlob,a=n.numEvents,s=!1,l=[],c=[],u=n.isBeacon,d=u?65e3:3984588,f=u?td:ed,p=0,h=0;p<t.length;){var v=t[p];if(v){if(a>=i){n.overflow=r.split(p);break}var g=e.getEventBlob(v);if(g&&g.length<=f){var m=g.length;if(o.length+m>d){n.overflow=r.split(p);break}o&&(o+="\n"),o+=g,++h>20&&(o.substr(0,1),h=0),s=!0,a++}else g?l.push(v):c.push(v),t.splice(p,1),p--}p++}if(l&&l.length>0&&n.sizeExceed.push(Ku.create(r.iKey(),l)),c&&c.length>0&&n.failedEvts.push(Ku.create(r.iKey(),c)),s){n.batches.push(r),n.payloadBlob=o,n.numEvents=a;var y=r.iKey();-1===da(n.apiKeys,y)&&n.apiKeys.push(y)}},function(){return{payload:n,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}}),o},e.getEventBlob=function(e){try{return Dc(t,function(){return"Serializer.getEventBlob"},function(){var t={};t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}(e.iKey);var r={},i=e.ext;i&&(t.ext=r,ta(i,function(e,t){n(t,r[e]={},"ext."+e,!0,null,null,!0)}));var s=t[o]={};s.baseType=e.baseType;var c=s[a]={};return n(e.baseData,c,a,!1,[a],function(e,t,n){ad(r,e,t,n)},l),n(e.data,s,o,!1,[],function(e,t,n){ad(r,e,t,n)},l),JSON.stringify(t)},function(){return{item:e}})}catch(e){return null}}})}return e.__ieDyn=1,e}();function ad(e,t,n,r){if(r&&e){var i=Su(r.value,r.kind,r.propertyType);if(i>-1){var o=e[nd];o||(o=e[nd]={f:{}});var a=o[rd];if(a||(a=o[rd]={}),t)for(var s=0;s<t.length;s++){var l=t[s];a[l]||(a[l]={f:{}});var c=a[l][rd];c||(c=a[l][rd]={}),a=c}a=a[n]={},ia(r.value)?a.a={t:i}:a.t=i}}}var sd="sendAttempt",ld="&NoResponseBody=true",cd=((Zu={})[1]=Ou,Zu[100]=Ou,Zu[200]="sent",Zu[8004]=Ru,Zu[8003]=Ru,Zu),ud={},dd={};function fd(e,t,n){ud[e]=t,!1!==n&&(dd[t]=e)}function pd(e){try{return e.responseText}catch(e){}return Tu}function hd(e,t){var n=!1;if(e&&t){var r=va(e);if(r&&r.length>0)for(var i=t.toLowerCase(),o=0;o<r.length;o++){var a=r[o];if(a&&Jo(t,a)&&a.toLowerCase()===i){n=!0;break}}}return n}function vd(e,t,n,r){t&&n&&n.length>0&&(r&&ud[t]?(e.hdrs[ud[t]]=n,e.useHdrs=!0):e.url+="&"+t+"="+n)}function gd(e,t){return t&&(aa(t)?e=[t].concat(e):ia(t)&&(e=t.concat(e))),e}fd(zu,zu,!1),fd(Du,Du),fd(Hu,"Client-Id"),fd(Uu,Uu),fd(_u,_u),fd(Mu,Mu),fd(ju,ju);var md=function(){function e(t,n,r,i,o){this._responseHandlers=[];var a,s,l,c,u,d,f,p,h,v,g="?cors=true&"+Fu.toLowerCase()+"="+Pu,m=new Ju,y=!1,S=new Xu,b=!1,w=0,k=!0,E=[],A={},C=[],I=null,T=!1,x=!1,R=!1;Ts(e,this,function(e){var O=!0;function P(e,t){for(var n=0,r=null,i=0;null==r&&i<e.length;)1===(n=e[i])?Qs()?r=N:Js()&&(r=B):2===n&&Xs(t)&&(!t||t&&!p)?r=F:b&&3===n&&Ks()&&(r=D),i++;return r?{_transport:n,_isSync:t,sendPOST:r}:null}function N(e,t,n){var r=new XDomainRequest;r.open(xu,e.urlString),e.timeout&&(r.timeout=e.timeout),r.onload=function(){var e=pd(r);L(t,200,{},e),G(e)},r.onerror=function(){L(t,400,{})},r.ontimeout=function(){L(t,500,{})},r.onprogress=function(){},n?r.send(e.data):o.set(function(){r.send(e.data)},0)}function F(e,t,n){var r,i=e.urlString,a=!1,s=!1,l=((r={body:e.data,method:xu}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);n&&(l.keepalive=!0,2===e._sendReason&&(a=!0,v&&(i+=ld))),O&&(l.credentials="include"),e.headers&&va(e.headers).length>0&&(l.headers=e.headers),fetch(i,l).then(function(e){var n={},r=Tu,i=e.headers;i&&i.forEach(function(e,t){n[t]=e}),e.body&&e.text().then(function(e){r=e}),s||(s=!0,L(t,e.status,n,r),G(r))}).catch(function(e){s||(s=!0,L(t,0,{}))}),a&&!s&&(s=!0,L(t,200,{})),!s&&e.timeout>0&&o.set(function(){s||(s=!0,L(t,500,{}))},e.timeout)}function B(e,t,n){var r=e.urlString;function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var r=t.getResponseHeader(n);r&&(e[n]=fa(r))}return e}function o(e,n){L(t,e.status,function(e){var t,n,r={};return e.getAllResponseHeaders?(t=e.getAllResponseHeaders(),n={},oa(t)&&ua(fa(t).split(/[\r\n]+/),function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var r=fa(e.substring(0,t)).toLowerCase(),i=fa(e.substring(t+1));n[r]=i}else n[fa(e)]=1}}),r=n):(r=i(r,e,Lu),r=i(r,e,Bu),r=i(r,e,"kill-duration-seconds")),r}(e),n)}n&&e.disableXhrSync&&(n=!1);var a=function(e,t,n,r,i,o){function a(e,t,n){try{e[t]=n}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var s=new XMLHttpRequest;return r&&a(s,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),n&&a(s,gu,n),s.open(e,t,!i),n&&a(s,gu,n),!i&&o&&a(s,"timeout",o),s}(xu,r,O,!0,n,e.timeout);ta(e.headers,function(e,t){a.setRequestHeader(e,t)}),a.onload=function(){var e=pd(a);o(a,e),G(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function L(e,t,n,r){try{e(t,n,r)}catch(e){cl(s,2,518,Gs(e))}}function D(e,t,n){var r=200,i=e._thePayload,o=e.urlString+(v?ld:Tu);try{var a=zs();if(!a.sendBeacon(o,e.data))if(i){var l=[];ua(i.batches,function(e){if(l&&e&&e.count()>0){for(var t=e.events(),n=0;n<t.length;n++)if(!a.sendBeacon(o,I.getEventBlob(t[n]))){l.push(e.split(n));break}}else l.push(e.split(0))}),K(l,8003,i.sendType,!0)}else r=0}catch(e){ul(s,"Failed to send telemetry using sendBeacon API. Ex:"+Gs(e)),r=0}finally{L(t,r,{},Tu)}}function H(e){return 2===e||3===e}function _(e){return x&&H(e)&&(e=2),e}function M(){return!y&&w<n}function U(){var e=C;return C=[],e}function z(e,t,n){var r=!1;return e&&e.length>0&&!y&&l[t]&&I&&(r=0!==t||M()&&(n>0||S.allowRequestSending())),r}function j(e){var t={};return e&&ua(e,function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}}),t}function $(e,n,r,i,o){if(e&&0!==e.length)if(y)K(e,1,i);else{i=_(i);try{var a=e,u=0!==i;Dc(c,function(){return"HttpManager:_sendBatches"},function(a){a&&(e=e.slice(0));for(var s=[],c=null,d=wu(),f=l[i]||(u?l[1]:l[0]),p=f&&f._transport,v=h&&(x||H(i)||3===p||f._isSync&&2===p);z(e,i,n);){var g=e.shift();g&&g.count()>0&&(m.isTenantKilled(g.iKey())?s.push(g):(c=c||I.createPayload(n,r,u,v,o,i),I.appendPayload(c,g,t)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,q(c,d,wu(),o),d=wu(),c=null):(q(c,d,wu(),o),d=wu(),e=[g].concat(e),c=null)))}c&&q(c,d,wu(),o),e.length>0&&(C=e.concat(C)),K(s,8004,i)},function(){return{batches:j(a),retryCount:n,isTeardown:r,isSynchronous:u,sendReason:o,useSendBeacon:H(i),sendType:i}},!u)}catch(e){cl(s,2,48,"Unexpected Exception sending batch: "+Gs(e))}}}function W(e,t,n){e[t]=e[t]||{},e[t][a.identifier]=n}function q(t,n,i,o){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var u=!!e.sendHook,h=l[t.sendType];!H(t.sendType)&&t.isBeacon&&2===t.sendReason&&(h=l[2]||l[3]||h);var v=R;(t.isBeacon||3===h._transport)&&(v=!1);var y=function(e,t){var n={url:g,hdrs:{},useHdrs:!1};t?(n.hdrs=bu(n.hdrs,A),n.useHdrs=va(n.hdrs).length>0):ta(A,function(e,t){dd[e]?vd(n,dd[e],t,!1):(n.hdrs[e]=t,n.useHdrs=!0)}),vd(n,Hu,"NO_AUTH",t),vd(n,Du,vu,t);var r=Tu;ua(e.apiKeys,function(e){r.length>0&&(r+=","),r+=e}),vd(n,Uu,r,t),vd(n,Mu,ya().toString(),t);var i=function(e){for(var t=0;t<e.batches.length;t++){var n=e.batches[t].Msfpc();if(n)return encodeURIComponent(n)}return Tu}(e);if(yu(i)&&(n.url+="&ext.intweb.msfpc="+i),S.shouldAddClockSkewHeaders()&&vd(n,_u,S.getClockSkewHeaderValue(),t),c.getWParam){var o=c.getWParam();o>=0&&(n.url+="&w="+o)}for(var a=0;a<E.length;a++)n.url+="&"+E[a].name+"="+E[a].value;return n}(t,v);v=v||y.useHdrs;var b=wu();Dc(c,function(){return"HttpManager:_doPayloadSend"},function(){for(var l=0;l<t.batches.length;l++)for(var g=t.batches[l].events(),E=0;E<g.length;E++){var A=g[E];if(T){var C=A.timings=A.timings||{};W(C,"sendEventStart",b),W(C,"serializationStart",n),W(C,"serializationCompleted",i)}A[sd]>0?A[sd]++:A[sd]=1}K(t.batches,1e3+(o||0),t.sendType,!0);var I={data:t.payloadBlob,urlString:y.url,headers:y.hdrs,_thePayload:t,_sendReason:o,timeout:d,disableXhrSync:f,disableFetchKeepAlive:p};v&&(hd(I.headers,Nu)||(I.headers[Nu]="no-cache, no-store"),hd(I.headers,Fu)||(I.headers[Fu]=Pu));var R=null;h&&(R=function(n){S.firstRequestSent();var i=function(n,i){!function(t,n,i,o){var s,l=9e3,c=null,u=!1,d=!1;try{var f=!0;if(typeof t!==Jr){if(n){S.setClockSkew(n[Lu]);var p=n[Bu]||n["kill-duration-seconds"];ua(m.setKillSwitchTenants(n["kill-tokens"],p),function(e){ua(i.batches,function(t){if(t.iKey()===e){c=c||[];var n=t.split(0);i.numEvents-=n.count(),c.push(n)}})})}if(200==t||204==t)return void(l=200);((s=t)>=300&&s<500&&408!=s&&429!=s||501==s||505==s||i.numEvents<=0)&&(f=!1),l=9e3+t%1e3}if(f){l=100;var h=i.retryCnt;0===i.sendType&&(h<r?(u=!0,V(function(){0===i.sendType&&w--,$(i.batches,h+1,i.isTeardown,x?2:i.sendType,5)},x,Yu(h))):(d=!0,x&&(l=8001)))}}finally{u||(S.setClockSkew(),function(t,n,r,i){try{i&&a._backOffTransmission(),200===n&&(i||t.isSync||a._clearBackOff(),function(e){if(T){var t=wu();ua(e,function(e){e&&e.count()>0&&function(e,t){T&&ua(e,function(e){W(e.timings=e.timings||{},"sendEventCompleted",t)})}(e.events(),t)})}}(t.batches)),K(t.batches,n,t.sendType,!0)}finally{0===t.sendType&&(w--,5!==r&&e.sendQueuedRequests(t.sendType,r))}}(i,l,o,d)),K(c,8004,i.sendType)}}(n,i,t,o)},l=t.isTeardown||t.isSync;try{h.sendPOST(n,i,l),e.sendListener&&e.sendListener(I,n,l,t.isBeacon)}catch(e){ul(s,"Unexpected exception sending payload. Ex:"+Gs(e)),L(i,0,{})}}),Dc(c,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(R)if(0===t.sendType&&w++,u&&!t.isBeacon&&3!==h._transport){var n={data:I.data,urlString:I.urlString,headers:bu({},I.headers),timeout:I.timeout,disableXhrSync:I.disableXhrSync,disableFetchKeepAlive:I.disableFetchKeepAlive},r=!1;Dc(c,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{e.sendHook(n,function(e){r=!0,k||e._thePayload||(e._thePayload=e._thePayload||I._thePayload,e._sendReason=e._sendReason||I._sendReason),R(e)},t.isSync||t.isTeardown)}catch(e){r||R(I)}})}else R(I)})},function(){return{thePayload:t,serializationStart:n,serializationCompleted:i,sendReason:o}},t.isSync)}t.sizeExceed&&t.sizeExceed.length>0&&K(t.sizeExceed,8003,t.sendType),t.failedEvts&&t.failedEvts.length>0&&K(t.failedEvts,8002,t.sendType)}function V(e,t,n){t?e():o.set(e,n)}function G(t){var n=e._responseHandlers;try{for(var r=0;r<n.length;r++)try{n[r](t)}catch(e){cl(s,1,519,"Response handler failed: "+e)}if(t){var i=JSON.parse(t);yu(i.webResult)&&yu(i.webResult[$u])&&u.set("MSFPC",i.webResult[$u],31536e3)}}catch(e){}}function K(e,t,n,r){if(e&&e.length>0&&i){var o=i[(l=t,u=cd[l],yu(u)||(u="oth",l>=9e3&&l<=9999?u="rspFail":l>=8e3&&l<=8999?u=Ru:l>=1e3&&l<=1999&&(u="send")),u)];if(o){var a=0!==n;Dc(c,function(){return"HttpManager:_sendBatchesNotification"},function(){V(function(){try{o.call(i,e,t,a,n)}catch(e){cl(s,1,74,"send request notification failed: "+e)}},r||a,0)},function(){return{batches:j(e),reason:t,isSync:a,sendSync:r,sendType:n}},!a)}}var l,u}e.initialize=function(e,t,n,r,i){var o;i||(i={}),g=e+g,R=!!Ko(i.avoidOptions)||!i.avoidOptions,c=t,u=t.getCookieMgr(),T=!c.config.disableEventTimings;var m=!!c.config.enableCompoundKey;s=(a=n).diagLog();var y=i.valueSanitizer,S=i.stringifyObjects;Ko(i.enableCompoundKey)||(m=!!i.enableCompoundKey),d=i.xhrTimeout,f=!!i.disableXhrSync,p=!!i.disableFetchKeepAlive,v=!1!==i.addNoResponse,b=!qs(),I=new od(c,y,S,m),Xo(i.useSendBeacon)||(b=!!i.useSendBeacon);var w=r,E=i.alwaysUseXhrOverride?r:null,A=i.alwaysUseXhrOverride?r:null,C=[3,2];if(!r){k=!1;var x=js();x&&x.protocol&&"file:"===x.protocol.toLowerCase()&&(O=!1);var N=[];qs()?(N=[2,1],C=[2,1,3]):N=[1,2,3],(r=P(N=gd(N,i.transports),!1))||ul(s,"No available transport to send events"),w=P(N,!0)}E||(E=P(C=gd(C,i.unloadTransports),!0)),h=!k&&(b&&Ks()||!p&&Xs(!0)),(o={})[0]=r,o[1]=w||P([1,2,3],!0),o[2]=E||w||P([1],!0),o[3]=A||P([2,3],!0)||w||P([1],!0),l=o},e._getDbgPlgTargets=function(){return[l[0],m,I,l]},e.addQueryStringParameter=function(e,t){for(var n=0;n<E.length;n++)if(E[n].name===e)return void(E[n].value=t);E.push({name:e,value:t})},e.addHeader=function(e,t){A[e]=t},e.canSendRequest=function(){return M()&&S.allowRequestSending()},e.sendQueuedRequests=function(e,t){Ko(e)&&(e=0),x&&(e=_(e),t=2),z(C,e,0)&&$(U(),0,!1,e,t||0)},e.isCompletelyIdle=function(){return!y&&0===w&&0===C.length},e.setUnloading=function(e){x=e},e.addBatch=function(e){if(e&&e.count()>0){if(m.isTenantKilled(e.iKey()))return!1;C.push(e)}return!0},e.teardown=function(){C.length>0&&$(U(),0,!0,2,2)},e.pause=function(){y=!0},e.resume=function(){y=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&(Xo(t)&&(t=1),x&&(t=_(t),n=2),$([e],0,!1,t,n||0))}})}return e.__ieDyn=1,e}();function yd(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout(e,t,n)}function Sd(e){clearTimeout(e)}function bd(e,t){return{set:e||yd,clear:t||Sd}}var wd="eventsDiscarded",kd="overrideInstrumentationKey",Ed="maxEventRetryAttempts",Ad="maxUnloadEventRetryAttempts";const Cd=function(e){function t(){var n,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.2.18";var i,o,a,s,l,c,u,d=!1,f=[],p=null,h=!1,v=0,g=500,m=0,y=1e4,S={},b=Iu,w=null,k=null,E=0,A=0,C={},I=-1,T=!0,x=!1,R=6,O=2;return Ts(t,r,function(e,t){function r(e){"beforeunload"!==(e||_s().event).type&&(x=!0,o.setUnloading(x)),M(2,2)}function P(e){x=!1,o.setUnloading(x)}function N(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[Wu]&&delete e.ext[Wu],e.ext&&e.ext[qu]&&e.ext[qu].id&&delete e.ext[qu].id,T&&(e.ext=Ia(e.ext),e.baseData&&(e.baseData=Ia(e.baseData)),e.data&&(e.data=Ia(e.data))),e.sync)if(E||h)e.latency=3,e.sync=!1;else if(o)return T&&(e=Ia(e)),void o.sendSynchronousBatch(Ku.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var n=e.latency,r=m,i=y;4===n&&(r=v,i=g);var a=!1;if(r<i)a=!j(e,t);else{var s=1,l=20;4===n&&(s=4,l=1),a=!0,function(e,t,n,r){for(;n<=t;){var i=U(e,t,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return 4===n?v-=a:m-=a,J(wd,[o],Ic.QueueFull),!0}n++}return $(),!1}(e.iKey,e.latency,s,l)&&(a=!j(e,t))}a&&Q(wd,[e],Ic.QueueFull)}function F(e,t,n){var r=W(e,t,n);return o.sendQueuedRequests(t,n),r}function B(){return m>0}function L(){if(I>=0&&W(I,0,l)&&o.sendQueuedRequests(0,l),v>0&&!k&&!h){var e=S[b][2];e>=0&&(k=H(function(){k=null,F(4,0,1),L()},e))}var t=S[b][1];!w&&!p&&t>=0&&!h&&(B()?w=H(function(){w=null,F(0===A?3:1,0,1),A++,A%=2,L()},t):A=0)}function D(){n=null,d=!1,f=[],p=null,h=!1,v=0,g=500,m=0,y=1e4,S={},b=Iu,w=null,k=null,E=0,A=0,i=null,C={},a=void 0,s=0,I=-1,l=null,T=!0,x=!1,R=6,O=2,c=null,u=bd(),o=new md(500,2,1,{requeue:K,send:Y,sent:Z,drop:ee,rspFail:te,oth:ne},u),G(),C[4]={batches:[],iKeyMap:{}},C[3]={batches:[],iKeyMap:{}},C[2]={batches:[],iKeyMap:{}},C[1]={batches:[],iKeyMap:{}},re()}function H(e,t){0===t&&E&&(t=1);var n=1e3;return E&&(n=Yu(E-1)),u.set(e,t*n)}function _(){return null!==w&&(u.clear(w),w=null,A=0,!0)}function M(e,t){_(),p&&(u.clear(p),p=null),h||F(1,e,t)}function U(e,t,n){var r=C[t];r||(r=C[t=1]);var i=r.iKeyMap[e];return!i&&n&&(i=Ku.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function z(t,n){o.canSendRequest()&&!E&&(a>0&&m>a&&(n=!0),n&&null==p&&e.flush(t,null,20))}function j(e,t){T&&(e=Ia(e));var n=e.latency,r=U(e.iKey,n,!0);return!!r.addEvent(e)&&(4!==n?(m++,t&&0===e.sendAttempt&&z(!e.sync,s>0&&r.count()>=s)):v++,!0)}function $(){for(var e=0,t=0,n=function(n){var r=C[n];r&&r.batches&&ua(r.batches,function(r){4===n?e+=r.count():t+=r.count()})},r=1;r<=4;r++)n(r);m=t,v=e}function W(t,n,r){var i=!1,a=0===n;return!a||o.canSendRequest()?Dc(e.core,function(){return"PostChannel._queueBatches"},function(){for(var e=[],n=4;n>=t;){var r=C[n];r&&r.batches&&r.batches.length>0&&(ua(r.batches,function(t){o.addBatch(t)?i=i||t&&t.count()>0:e=e.concat(t.events()),4===n?v-=t.count():m-=t.count()}),r.batches=[],r.iKeyMap={}),n--}e.length>0&&Q(wd,e,Ic.KillSwitch),i&&I>=t&&(I=-1,l=0)},function(){return{latency:t,sendType:n,sendReason:r}},!a):(I=I>=0?Math.min(I,t):t,l=Math.max(l,r)),i}function q(e,t){F(1,0,t),$(),V(function(){e&&e(),f.length>0?p=H(function(){p=null,q(f.shift(),t)},0):(p=null,L())})}function V(e){o.isCompletelyIdle()?e():p=H(function(){p=null,V(e)},.25)}function G(){(S={})[Iu]=[2,1,0],S.NEAR_REAL_TIME=[6,3,0],S.BEST_EFFORT=[18,9,0]}function K(t,n){var r=[],i=R;x&&(i=O),ua(t,function(t){t&&t.count()>0&&ua(t.events(),function(t){t&&(t.sync&&(t.latency=4,t.sync=!1),t.sendAttempt<i?(ku(t,e.identifier),N(t,!1)):r.push(t))})}),r.length>0&&Q(wd,r,Ic.NonRetryableStatus),x&&M(2,2)}function X(t,n){var r=e._notificationManager||{},i=r[t];if(i)try{i.apply(r,n)}catch(n){cl(e.diagLog(),1,74,t+" notification failed: "+n)}}function Q(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&X(e,[t].concat(n))}function J(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];t&&t.length>0&&ua(t,function(t){t&&t.count()>0&&X(e,[t.events()].concat(n))})}function Y(e,t,n){e&&e.length>0&&X("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])}function Z(e,t){J("eventsSent",e,t),L()}function ee(e,t){J(wd,e,t>=8e3&&t<=8999?t-8e3:Ic.Unknown)}function te(e){J(wd,e,Ic.NonRetryableStatus),L()}function ne(e,t){J(wd,e,Ic.Unknown),L()}function re(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,y/6)}D(),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(s,l,d){Dc(l,function(){return"PostChannel:initialize"},function(){var f=l;t.initialize(s,l,d);try{l.addUnloadCb,c=gc(Vl(e.identifier),l.evtNamespace&&l.evtNamespace());var p=e._getTelCtx();s.extensionConfig[e.identifier]=s.extensionConfig[e.identifier]||{},n=p.getExtCfg(e.identifier),u=bd(n.setTimeoutOverride,n.clearTimeoutOverride),T=!n.disableOptimizeObj&&!!Ds("chrome"),function(e){var t=e.getWParam;e.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|t()}}(f),n.eventsLimitInMem>0&&(y=n.eventsLimitInMem),n.immediateEventLimit>0&&(g=n.immediateEventLimit),n.autoFlushEventsLimit>0&&(a=n.autoFlushEventsLimit),aa(n[Ed])&&(R=n[Ed]),aa(n[Ad])&&(O=n[Ad]),re(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(i=n.httpXHROverride),yu(s.anonCookieName)&&o.addQueryStringParameter("anoncknm",s.anonCookieName),o.sendHook=n.payloadPreprocessor,o.sendListener=n.payloadListener;var h=n.overrideEndpointUrl?n.overrideEndpointUrl:s.endpointUrl;e._notificationManager=l.getNotifyMgr(),o.initialize(h,e.core,e,i,n);var v=s.disablePageUnloadEvents||[];(function(e,t,n,r){var i=!1;t&&e&&ia(e)&&!(i=Sc(e,t,n,r))&&n&&n[Si]>0&&(i=Sc(e,t,null,r))})([rc,nc,ec],r,v,c),wc(r,v,c),kc(P,s.disablePageShowEvents,c)}catch(t){throw e.setInitialized(!1),t}},function(){return{coreConfig:s,core:l,extensions:d}})},e.processTelemetry=function(t,r){ku(t,e.identifier);var i=(r=e._getTelCtx(r)).getExtCfg(e.identifier),o=!!n.disableTelemetry;i&&(o=o||!!i.disableTelemetry);var a=t;o||d||(n[kd]&&(a.iKey=n[kd]),i&&i[kd]&&(a.iKey=i[kd]),N(a,!0),x?M(2,2):L()),e.processNext(a,r)},e._doTeardown=function(e,t){var n;M(2,2),d=!0,o.teardown(),bc([rc,nc,ec],null,c),n=gc(ic,c),bc([ec],null,n),bc([Zl],null,n),function(e,t){var n=gc(oc,t);bc([tc],null,n),bc([Zl],null,n)}(0,c),D()},e.setEventQueueLimits=function(e,t){y=e>0?e:1e4,a=t>0?t:0,re();var n=m>e;if(!n&&s>0)for(var r=1;!n&&r<=3;r++){var i=C[r];i&&i.batches&&ua(i.batches,function(e){e&&e.count()>=s&&(n=!0)})}z(!0,n)},e.pause=function(){_(),h=!0,o.pause()},e.resume=function(){h=!1,o.resume(),L()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){_(),G(),b=Iu,L(),ta(e,function(e,t){var n=t.length;if(n>=2){var r=n>2?t[2]:0;if(t.splice(0,n-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var i=t[0]/t[1];t[0]=Math.ceil(i)*t[1]}r>=0&&t[1]>=0&&r>t[1]&&(r=t[1]),t.push(r),S[e]=t}})},e.flush=function(e,t,n){if(void 0===e&&(e=!0),!h)if(n=n||1,e)null==p?(_(),W(1,0,n),p=H(function(){p=null,q(t,n)},0)):f.push(t);else{var r=_();F(1,1,n),null!=t&&t(),r&&L()}},e.setMsaAuthTicket=function(e){o.addHeader(zu,e)},e.hasEvents=B,e._setTransmitProfile=function(e){b!==e&&void 0!==S[e]&&(_(),b=e,L())},e._backOffTransmission=function(){E<4&&(E++,_(),L())},e._clearBackOff=function(){E&&(E=0,_(),L())},ga(e,"_setTimeoutOverride",function(){return u.set},function(e){u=bd(e,u.clear)}),ga(e,"_clearTimeoutOverride",function(){return u.clear},function(e){u=bd(u.set,e)})}),r}return xc(t,e),t.__ieDyn=1,t}(eu);var Id="HttpManager:_sendBatches",Td="PrivacyGuard:_processTelemetry",xd=function(){function e(e,t,n){this.start=j(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=j()-this.start,this.exTime=this.time},e}(),Rd=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return e===Id||e===Td?new xd(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case Id:this.handleSendBatches(e);break;case Td:this.handlePrivacyGuardNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){if(this._callbacks.requestProcessingStats){var t=0;if(e.payload){var n=e.payload();if(n.batches)for(var r in n.batches)t+=n.batches[r].evts.length}this._callbacks.requestProcessingStats(e.time||0,t)}},e.prototype.handlePrivacyGuardNotification=function(e){this._callbacks.privacyGuardStats&&e.time&&e.time>0&&this._callbacks.privacyGuardStats(e.time)},e}(),Od=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.initialize=function(t,n){this._postChannel=new Cd;var r=null!=n?n:[];t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=l(l({},t.channelConfiguration),t.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,t,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,r={};r.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(Cu),Pd=function(e){function t(n,r){var i,o=e.call(this,n,r)||this;o.instanceId=++t.instanceCounter,o.sendTelemetryEvent=function(e){return _a(function(){var t=o.getOneDSTelemetryEvent(e);t&&i&&i.track(t)},Da)},o.sendOneDSTelemetryEvent=function(e){return _a(function(){null==i||i.track(e)},Da)},o.sendCustomerContent=function(e){},o.sendNonStandardEvent=function(e,t){var n=!1;c.forEach(function(r){r.canHandle(t)&&(r.processEvent(e),n=!0)}),n||f(0,1,function(){return"Missing Handler for "+t+"to process"+e.eventName})},o.flush=function(e){null==i||i.flush(e),c.forEach(function(t){t.flush(e)})},o.shutdown=function(){try{null==i||i.shutdown(),c.forEach(function(e){e.shutdown()})}catch(e){f(0,2,function(){return"An error occurred on shutdown"})}};var a,s,c=r.nonStandardEventHandlers||[];if(i=function(e,t){var n=e.httpXHROverride,r={instrumentationKey:t,endpointUrl:e.endpointUrl,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:n,autoFlushEventsLimit:e.autoFlushEventsLimit,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},enableWParam:!n,disableCookiesUsage:!0,extensionConfig:l({},e.extensionConfig)};e.stats&&e.stats.networkStats&&r.channelConfiguration&&(r.channelConfiguration.payloadListener=function(t,n){var r,i=n||t;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var i=new Od;return i.initialize(r,e.plugins),i.setUploadFrequency(e.uploadFrequency),e.notificationListener&&i.addNotificationListener(e.notificationListener),e.stats&&i.setPerfMgr(new Rd(e.stats)),i}(r,La),c.forEach(function(e){e.initialize(o,r)}),!r.endpointUrl)throw new Error("Missing Endpoint Url");return r.disableStatsTracking||(a=o,(s=i)&&s.addNotificationListener({eventsSent:function(e){f(2,2,function(){return"Successfully sent ".concat(e.length," event(s)")}),f(3,2,function(){return"Sent event(s) details : ".concat(JSON.stringify(e,null,2))}),a.eventsSent+=e.length},eventsDiscarded:function(e,t){f(0,2,function(){return"Discarded ".concat(e.length," event(s) because ").concat(Ic[t]||t)}),f(3,2,function(){return"Discarded event(s) details : ".concat(JSON.stringify(e,null,2))}),a.eventsDiscarded+=e.length}})),o}return s(t,e),t.instanceCounter=0,t}(function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0;var r=[],i=!1,o=!0,a={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return i||10===t||110===t||120===t}},s={},l=Ec();this.init=function(e){return Va(s,!1)},this.begin=function(){return o=o&&Va(s,!0)},this.getOneDSTelemetryEvent=function(e){return c(e,{eventType:1})},this.getOneDSCustomerContent=function(e){var t=e.telemetryProperties.customerContentVersion;if(t&&Math.floor(t)<=2&&1===e.telemetryProperties.customerContentType)return c(e,{eventType:2})};var c=function(e,t){if(o){var i=A(e);if(function(e,t){for(var n=function(n){var r=t[n];if(!r.processEvent(e))return f(2,1,function(){return"".concat(e.eventName," suppressed by ").concat(r.name)}),{value:!1}},r=0;r<t.length;r++){var i=n(r);if("object"==typeof i)return i.value}return!0}(i,r)){var a=(h=i,h.timestamp?new Date(h.timestamp):new Date).toISOString(),c={"Event.Name":i.eventName,"Event.Source":"OTelJS","Event.Time":{value:a,propertyType:9}};for(var u in n.eventsProcessed++,c["Event.Sequence"]={value:n.eventsProcessed,propertyType:4},c["Event.Id"]=l+"."+n.eventsProcessed,s)c[u]=s[u];if(!Ha(c,i.dataFields,!0,t.eventType))return void f(0,1,function(){return"Dropping Event: "+i.eventName});var d="custom";i.eventContract&&(i.eventContract.name&&(c["Event.Contract"]=i.eventContract.name,d+="."+i.eventContract.name.toLowerCase().replace(/\./g,"_")),Ha(c,i.eventContract.dataFields,!1,t.eventType));var p=function(e,t){return 2===t?"b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121":e.telemetryProperties&&(1!==t||e.telemetryProperties.ariaTenantToken)?1===t?e.telemetryProperties.ariaTenantToken:void 0:void f(0,1,function(){return"Missing Aria Token"})}(i,t.eventType);if(!p)return;return{iKey:p,name:i.eventName,data:c,time:a,baseType:d,ext:{sdk:{seq:n.eventsProcessed}}}}}var h};this.addPreprocessor=function(e){r.push(e)},this.getOneDSPersistentDataFields=function(){return s},this.getPreprocessors=function(){return r};var u=function(e){Ha(s,e,!1,1)};this.addPersistentDataFields=u,this.setOptionalEventsEnabled=function(e){i=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(i=!0),u(e);var d,p=t.coreFields;if(p){u(B(p.app)),u(N(p.user)),u(L(p.session));var h=p.release;h&&u((T(d=[],"Release","AudienceGroup",h.audienceGroup,1),d))}this.addPreprocessor(a)}),Nd="Office.Telemetry.OTelJS.EventThrottled";function Fd(e){return"number"==typeof e}var Bd,Ld,Dd=function(){function e(e,t){this._sinkName=e,this._telemetrySink=t,this.name="EventThrottler",this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._eventThrottleReported={},this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={}}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=e.eventName;if(t===Nd)return!0;var n=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[t]=this._singleEventInLastInterval[t]+1||1,t in this._maxNamedEventsPerSecond?n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxNamedEventsPerSecond[t],"MaxNamedEventsPerSecond",t):Fd(this._maxSingleEventPerSecond)&&(n=this.applyThrottle(this._singleEventInLastInterval[t],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",t)),Fd(this._maxTotalEventsPerSecond)&&(this._totalEventsInLastInterval++,n&&(n=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",t))),n},e.prototype.applyThrottle=function(e,r,i,o){return!(e>r&&(e===r+1&&this._telemetrySink&&!this._eventThrottleReported[o]&&(this._eventThrottleReported[o]=!0,this._telemetrySink.sendTelemetryEvent({eventName:Nd,telemetryProperties:{ariaTenantToken:La,nexusTenantToken:1723},eventFlags:{diagnosticLevel:110},dataFields:[n("SinkName",this._sinkName||""),n("ThrottledEvent.Name",o),t(i,r)]})),f(2,1,function(){return"1DS Sink Event Throttle: Exceeded ".concat(r," ").concat(i,": ").concat(o)}),1))},e}();(Ld=Bd||(Bd={})).USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",Ld.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",Ld.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",Ld.CUSTOMER_CONTENT="",Ld.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/",Ld.EDPS="https://eu-r-office.events.data.microsoft.com/OneCollector/1.0/";var Hd=i(9875);const _d="api.appInitialization.sdkLoaded",Md={[qe]:"api.appInitialization.initialize",[J]:"api.appInitialization.appLoaded",[ee]:"api.appInitialization.success",[Z]:"api.appInitialization.failure",[Y]:"api.appInitialization.expectedFailure",[se]:"api.appEntity.selectAppEntity",[te]:"api.appInstallDialog.openAppInstallDialog",[ie]:"api.authentication.authenticate",[ne]:"api.getAuthToken",[re]:"api.getUser",[ae]:"api.authentication.notifyFailure",[oe]:"api.authentication.notifySuccess",[le]:"api.barCode.scanBarCode",[ce]:"api.calendar.composeMeeting",[ue]:"api.calendar.openCalendarItem",[de]:"api.call.startCall",[fe]:"api.chat.openChat",[he]:"api.clipboard.readFromClipboard",[pe]:"api.clipboard.writeToClipboard",[ge]:"api.conversations.closeConversation",[me]:"api.conversations.getChatMembers",[ve]:"api.conversations.openConversation",[ye.getEligibilityInfo]:"api.copilot.eligibility.getEligibilityInfo",[Se]:"api.dialogs.open",[be]:"api.dialogs.submit",[we.resize]:"api.dialogs.update.resize",[Te]:"api.externalAppAuthentication.authenticateAndResendRequest",[Oe]:"api.externalAppAuthentication.authenticateWithOauth2",[Pe]:"api.externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",[xe]:"api.externalAppAuthentication.authenticateWithSSO",[Re]:"api.externalAppAuthentication.authenticateWithSSOAndResendRequest",[Be]:"api.externalAppAuthenticationForCEA.authenticateAndResendRequest",[Le]:"api.externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest",[Fe]:"api.externalAppAuthenticationForCEA.authenticateWithOauth",[Ne]:"api.externalAppAuthenticationForCEA.authenticateWithSSO",[ke]:"api.externalAppCardActions.processActionOpenUrl",[Ee]:"api.externalAppCardActions.processActionSubmit",[Ae]:"api.externalAppCardActionsForCEA.processActionOpenUrl",[Ce]:"api.externalAppCardActionsForCEA.processActionSubmit",[Ie]:"api.externalAppCommands.processActionCommand",[De]:"api.files.addCloudStorageFolder",[He]:"api.files.copyMoveFiles",[_e]:"api.files.deleteCloudStorageFolder",[$e]:"api.files.getCloudStorageFolderContents",[Me]:"api.files.getCloudStorageFolders",[ze]:"api.files.getExternalProviders",[Ue]:"api.files.openFilePreview",[We]:"api.getContext",[Ve.addAndConfigure]:"api.hostEntity.tab.addAndConfigure",[Ve.reconfigure]:"api.hostEntity.tab.reconfigure",[Ve.rename]:"api.hostEntity.tab.rename",[Ve.remove]:"api.hostEntity.tab.remove",[Ve.getAll]:"api.hostEntity.tab.getAll",[nt]:"api.interactive.getClientInfo",[tt]:"api.interactive.getClientRoles",[Je]:"api.interactive.getFluidContainerId",[Xe]:"api.interactive.getFluidTenantInfo",[Qe]:"api.interactive.getFluidToken",[Ze]:"api.interactive.getNtpTime",[et]:"api.interactive.registerClientId",[Ye]:"api.interactive.setFluidContainerId",[rt]:"api.links.openLink",[Ge]:"api.location.getCurrentLocation",[Ke.showLocation]:"api.location.map.showLocation",[ot]:"api.mail.composeMail",[at]:"api.mail.openMailItem",[lt]:"api.marketplace.addOrUpdateCartItems",[st]:"api.marketplace.getCart",[ct]:"api.marketplace.removeCartItems",[ut]:"api.marketplace.updateCartStatus",[dt]:"api.media.captureImage",[ft]:"api.media.getMedia",[pt]:"api.media.selectMedia",[ht]:"api.media.viewImages",[wt.setOptions]:"api.meeting.appShareButton.setOptions",[vt]:"api.meeting.getAppContentStageSharingCapabilities",[gt]:"api.meeting.getAppContentStageSharingState",[mt]:"api.meeting.getAuthenticationTokenForAnonymousUser",[yt]:"api.meeting.getIncomingClientAudioState",[St]:"api.meeting.getLiveStreamState",[bt]:"api.meeting.getMeetingDetails",[Rt]:"api.meeting.joinMeeting",[Tt]:"api.meeting.requestAppAudioHandling",[kt]:"api.meeting.requestStartLiveStreaming",[Et]:"api.meeting.requestStopLiveStreaming",[At]:"api.meeting.shareAppContentToStage",[Ct]:"api.meeting.stopSharingAppContentToStage",[It]:"api.meeting.toggleIncomingClientAudio",[xt]:"api.meeting.updateMicState",[Ot]:"api.meetingRoom.getPairedMeetingRoomInfo",[Pt]:"api.meetingRoom.sendCommandToPairedMeetingRoom",[Nt]:"api.monetization.openPurchaseExperience",[Ft]:"api.nestedAppAuth.execute",[Bt]:"api.notifications.showNotification",[$t.navigateBack]:"api.pages.backStack.navigateBack",[Vt.remove.failure]:"api.pages.config.remove.failure",[Vt.remove.success]:"api.pages.config.remove.success",[Vt.save.failure]:"api.pages.config.save.failure",[Vt.save.success]:"api.pages.config.save.success",[Vt.setConfig]:"api.pages.config.setConfig",[Vt.setValidityState]:"api.pages.config.setValidityState",[Wt.navigateTo]:"api.pages.currentApp.navigateTo",[Wt.navigateToDefaultPage]:"api.pages.currentApp.navigateToDefaultPage",[Gt.enterFullscreen]:"api.pages.fullTrust.enterFullscreen",[Gt.exitFullscreen]:"api.pages.fullTrust.exitFullscreen",[Ht]:"api.pages.getConfig",[_t]:"api.pages.navigateCrossDomain",[Mt]:"api.pages.navigateToApp",[Ut]:"api.pages.returnFocus",[zt]:"api.pages.setCurrentFrame",[jt]:"api.pages.shareDeepLink",[qt.getMruTabInstances]:"api.pages.tabs.getMruTabInstances",[qt.getTabInstances]:"api.pages.tabs.getTabInstances",[qt.navigateToTab]:"api.pages.tabs.navigateToTab",[Kt]:"api.people.selectPeople",[Qt]:"api.permissions.requestUserConsentForPermission",[Xt.getPermissionStatus]:"api.permissions.storageService.getPermissionStatus",[Jt]:"api.profile.showProfile",[nn]:"api.registerHandler",[Yt]:"api.remoteCamera.getCapableParticipants",[Zt]:"api.remoteCamera.requestControl",[en]:"api.remoteCamera.sendControlCommand",[tn]:"api.remoteCamera.terminateSession",[on]:"api.search.closeSearch",[rn]:"api.search.unregister",[ln]:"api.stageView.open",[cn.close]:"api.stageView.self.close",[un]:"api.store.open",[pn.getConfigSetting]:"api.teams.fullTrust.getConfigSetting",[pn.joinedTeams.getUserJoinedTeams]:"api.teams.fullTrust.joinedTeams.getUserJoinedTeams",[dn]:"api.teams.getTeamChannels",[fn]:"api.teams.refreshSiteUrl",[Rn]:"api.webStorage.isWebStorageClearedOnUserLogOut"},Ud=new Map([[qe,"initialize"],[J,"appLoaded"],[ee,"success"],[Z,"failure"],[Y,"expectedFailure"]]);var zd,jd=new Uint8Array(16);function $d(){if(!zd&&!(zd="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return zd(jd)}const Wd=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,qd=function(e){return"string"==typeof e&&Wd.test(e)};for(var Vd=[],Gd=0;Gd<256;++Gd)Vd.push((Gd+256).toString(16).substr(1));const Kd=function(e,t,n){var r=(e=e||{}).random||(e.rng||$d)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(Vd[e[t+0]]+Vd[e[t+1]]+Vd[e[t+2]]+Vd[e[t+3]]+"-"+Vd[e[t+4]]+Vd[e[t+5]]+"-"+Vd[e[t+6]]+Vd[e[t+7]]+"-"+Vd[e[t+8]]+Vd[e[t+9]]+"-"+Vd[e[t+10]]+Vd[e[t+11]]+Vd[e[t+12]]+Vd[e[t+13]]+Vd[e[t+14]]+Vd[e[t+15]]).toLowerCase();if(!qd(n))throw TypeError("Stringified UUID is invalid");return n}(r)};class Xd{constructor(e){this.uuid=Kd(),this.uuid=e||Kd(),qd(this.uuid)}toString(){return this.uuid}}var Qd,Jd,Yd,Zd,ef,tf,nf;!function(e){e.bing="Bing",e.cmc="CMC",e.cmcMobile="CMCMobile",e.edge="Edge",e.edgeSidebar="EdgeSidebar",e.office="Office",e.orange="Orange",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.teams="Teams",e.teamsModern="TeamsModern",e.windowsCopilot="WindowsCopilot"}(Qd||(Qd={})),function(e){e.windows="windows",e.macOs="macos"}(Jd||(Jd={})),function(e){e.default="default",e.dark="dark",e.highContrast="contrast"}(Yd||(Yd={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(Zd||(Zd={})),function(e){e.web="web",e.desktop="desktop"}(ef||(ef={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(tf||(tf={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(nf||(nf={}));const rf=e=>{const{uuidAsString:t}=e,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:new Xd(t)})};class of{constructor(){this.items=new Map,this.add=e=>{if(e){const t=e.toLowerCase();if(!this.items.has(t))return this.items.set(t,e),!0}return!1},this.values=()=>Array.from(this.items.values())}}let af={wildcardValidDomainRuleDetection:!0,extendedAppLoadTimeoutInMillis:void 0,authExtensionContextForUrlValidation:!0,escapeRegExSpecialCharactersInValidDomains:!0,useUrlClassForValidDomains:!0,useStrictValidDomainRuleDetection:!0,resetTimerWhenInitCalledAndWaitForNotifySuccess:!1,createAndSendSignalsToSubstrate:!0,useGlobalMonotonicTimersForTelemetry:!1,shouldLazilyWriteDefaultDevicePermissions:!1,disableFirstPartyAppsAsMicrosoftOwned:!1,shouldCustomTelemetryScenarioReceiveAppInitTelemetry:!1,disableExtendedTelemetryForMetaOSStoreApps:!1,useStrictAppIdValidationInStorage:!1,recreateCommBridgeListenersBeforeLoadingApp:!1,overrideForEachInitStateChangeTimeoutsInMs:void 0};function sf(){return af}const lf=e=>e&&new URL(e).host,cf=/([\[\]\^\$\|\(\)\\\.\+\*\?\{\}\=\!\<\>\-])/gi,uf=(e,t,n,r)=>{try{return void 0!==n&&xf(new URL(e),pf(n,r),t)}catch(e){return t.log(z.Error,"isValidOriginForApp","Invalid origin",null),!1}},df=(e,t,n,r)=>{const i=Lf(n,r),o=Pf(e,n,i);if(void 0!==r&&xf(new URL(o),pf(r,n),t))return o;throw t.log(z.Error,"tryFormatAndGetValidUrl",Un,null),Un},ff=e=>{let t=[];for(const n of e)n.match(Ln)||t.push(n);return t},pf=(e,t)=>{var n,r,i;const o=new of;return e.validDomains&&e.validDomains.forEach(e=>o.add(Af(e,t))),null===(n=e.pages.configurable)||void 0===n||n.forEach(e=>o.add(lf(Ef(e.configurationUrl,t)))),null===(r=e.pages.static)||void 0===r||r.forEach(e=>{e.contentUrl&&o.add(lf(Ef(e.contentUrl,t)))}),(null===(i=null==e?void 0:e.connector)||void 0===i?void 0:i.configurationUrl)&&o.add(lf(e.connector.configurationUrl)),Array.from(o.values())},hf=e=>{return!!(t=null==e?void 0:e.id)&&Dn.has(t.toLowerCase());var t},vf=(e,t,n,r,i,o=!1,a=!1)=>{var s,l,c;const u=a&&r?gf(r):void 0;if((n.name===Qd.teams||n.name===Qd.teamsModern)&&t&&t.length>0&&(!r||r.isFullTrust||(d=r.id)&&-1!==_n.indexOf(d.toLowerCase()))){if(r){const n=sf().restrictedFullTrustOverrides;if(n){let o;if(n.forEach(e=>{e.appId===r.id&&(o=e)}),o)return a?kf(e,t,i,o,u):kf(e,t,i,o)}}return a&&u&&wf(t[0],u),Promise.resolve(t)}var d;if(null===(s=null==r?void 0:r.webApplicationInfo)||void 0===s?void 0:s.resource){let n;return n=1===(null==t?void 0:t.length)&&("api://{teamSiteDomain}"===t[0]&&"https://{teamSiteDomain}"===(null===(l=null==r?void 0:r.webApplicationInfo)||void 0===l?void 0:l.resource)||"api://{mySiteDomain}"===t[0]&&"https://{mySiteDomain}"===(null===(c=null==r?void 0:r.webApplicationInfo)||void 0===c?void 0:c.resource))?Ef(t[0],i):Cf(r,i),n&&(If(n,e)||o)?(a&&u&&wf(n,u),Promise.resolve([n])):Promise.reject("App resource defined in manifest and iframe origin do not match")}return Promise.reject("App webApplicationInfo or resource not defined in manifest")},gf=e=>Sf(e)||bf(e),mf=e=>{var t;return"BotBased"===(null===(t=e.composeExtension)||void 0===t?void 0:t.type)},yf=e=>{var t;return null===(t=null==e?void 0:e.copilotAgents)||void 0===t?void 0:t.customEngineAgents.length},Sf=e=>{if(mf(e)){const t=e.composeExtension.botId;if(!t)throw"botID cannot be undefined in BotBased composeExtension";return t}},bf=e=>{if(yf(e)){const t=e.copilotAgents.customEngineAgents.filter(e=>"bot"===e.type);if(!t.length)throw"The type bot is missing from the customEngineAgents";if(t.length>1)throw"There cannot be multiple bot types in the customEngineAgents";const n=t[0].id;if(!n)throw"bot id cannot be undefined in CEA";return n.toString()}},wf=(e,t)=>{let n;if(sf().useUrlClassForValidDomains)n=(e.startsWith("https://")||e.startsWith("api://"))&&qd(t)&&e.includes(`/botid-${t}`);else{const r="^((https|api):/(/.+)?/botid-{botId})".replace("{botId}",t);n=new RegExp(r,"i").test(e)}if(!n)throw"Resource is not valid"},kf=(e,t,n,r,i)=>{let o=!0;return r?t.forEach(t=>{var i;if(o){const a=Ef(t,n);let s=!1;null===(i=r.resources)||void 0===i||i.forEach(r=>{if(!s&&r){const i=Ef(r.resource,n);if(a===i)if(r.requireOriginMatch){try{const n=new URL(e),r=new URL(t);n.hostname===r.hostname&&(s=!0)}catch(e){}e===i&&(s=!0)}else s=!0}}),s||(o=!1)}}):o=!1,o?(i&&wf(t[0],i),Promise.resolve(t)):Promise.reject("App resource defined in manifest and iframe origin do not match")},Ef=(e,t)=>{var n,r,i,o,a,s,l,c,u,d,f,p;if(!t)return e;const h=void 0!==t.page?t:void 0,v={teamSiteDomain:(null===(n=null==h?void 0:h.sharePointSite)||void 0===n?void 0:n.teamSiteDomain)||"",teamSitePath:(null===(r=null==h?void 0:h.sharePointSite)||void 0===r?void 0:r.teamSitePath)||"",teamSiteUrl:(null===(i=null==h?void 0:h.sharePointSite)||void 0===i?void 0:i.teamSiteUrl)||"",mySiteDomain:(null===(o=null==h?void 0:h.sharePointSite)||void 0===o?void 0:o.mySiteDomain)||"",mySitePath:(null===(a=null==h?void 0:h.sharePointSite)||void 0===a?void 0:a.mySitePath)||"",channelRelativeUrl:(null===(s=null==h?void 0:h.channel)||void 0===s?void 0:s.relativeUrl)||"",sharePointSite:{teamSiteDomain:(null===(l=null==h?void 0:h.sharePointSite)||void 0===l?void 0:l.teamSiteDomain)||"",teamSitePath:(null===(c=null==h?void 0:h.sharePointSite)||void 0===c?void 0:c.teamSitePath)||"",teamSiteUrl:(null===(u=null==h?void 0:h.sharePointSite)||void 0===u?void 0:u.teamSiteUrl)||"",mySiteDomain:(null===(d=null==h?void 0:h.sharePointSite)||void 0===d?void 0:d.mySiteDomain)||"",mySitePath:(null===(f=null==h?void 0:h.sharePointSite)||void 0===f?void 0:f.mySitePath)||""},channel:{relativeUrl:(null===(p=null==h?void 0:h.channel)||void 0===p?void 0:p.relativeUrl)||""}};return Nf(e,v)},Af=(e,t)=>{var n,r,i,o;if(!t)return e;const a={teamSiteDomain:(null===(n=t.sharePointSite)||void 0===n?void 0:n.teamSiteDomain)||"",mySiteDomain:(null===(r=t.sharePointSite)||void 0===r?void 0:r.mySiteDomain)||"",sharePointSite:{teamSiteDomain:(null===(i=t.sharePointSite)||void 0===i?void 0:i.teamSiteDomain)||"",mySiteDomain:(null===(o=t.sharePointSite)||void 0===o?void 0:o.mySiteDomain)||""}};return Nf(e,a)},Cf=(e,t)=>{var n,r;return(null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource)&&Ef(null===(r=e.webApplicationInfo)||void 0===r?void 0:r.resource,t)},If=(e,t)=>{if(!e.startsWith("https:")&&!e.startsWith("api:"))return!1;if(!(e=e.replace("api://","https://"))||!t)return!1;if(e===t)return!0;if(sf().useStrictValidDomainRuleDetection)try{const n=new URL(t),r=new URL(e);return!(n.origin!==r.origin||!n.origin||!r.origin)}catch(e){return!1}else{if(!sf().useUrlClassForValidDomains){const r=sf().escapeRegExSpecialCharactersInValidDomains?(n=t)&&new URL(n).host.replace(cf,"\\$1"):lf(t),i=Bn.validResourcePattern.replace(Bn.resourceDomainParameter,r);return new RegExp(i,"i").test(e)}try{const n=new URL(t),r=new URL(e);return!(n.hostname!==r.hostname||!n.origin||!r.origin)}catch(e){return!1}}var n},Tf=e=>{try{const t=new URL(e);return"https:"===t.protocol||"api:"===t.protocol}catch(e){return!1}},xf=(e,t,n)=>{const r=Of(e),i=new of;let o=[...t];const a=ff([...t]);a.length>0&&(n.log(z.Debug,"isUrlInDomainList",`Invalid domain detected with ${a}}`),sf().wildcardValidDomainRuleDetection&&(o=o.filter(e=>!a.includes(e))));for(const e of o){if(!i.add(e))continue;const t=Rf(e),n=new RegExp(`^https://${t}((/|\\?).*)?$`,"i");if(r.match(n))return!0}return!1},Rf=e=>{if(!0===sf().wildcardValidDomainRuleDetection&&ff([e]).length>0)throw new Error("The wildcardValidDomainRuleDetection flag is enabled and an improper wildcard domain segment was detected: "+e);return e.replaceAll(".","[.]").replaceAll("*","[^/^.]+")},Of=e=>e.href,Pf=(e,t,n)=>{let r=Nf(e,Bf(t));return r=Nf(r,n),r},Nf=(e,t,n=[])=>{const r=e.indexOf("?");let i="",o="";return r>0?(i=e.substring(0,r),o=e.substring(r)):i=e,i&&(i=Ff(i,t,n,e=>encodeURI(e))),o&&(o=Ff(o,t,n,e=>encodeURIComponent(e))),i+o},Ff=(e,t,n=[],r)=>{if(void 0!==t)if("object"==typeof t)for(const i in t)e=Ff(e,t[i],n.concat(i),r);else if(sf().useUrlClassForValidDomains)e=e.replaceAll(`{${n.join(".")}}`,r(t));else{const i=n.join("."),o=new RegExp(`{${i.replace(".","\\.")}}`,"g");e=e.replace(o,r(t))}return e},Bf=e=>{var t,n,r,i,o;return{actionInfo:{actionId:(null===(t=e.actionInfo)||void 0===t?void 0:t.actionId)||"",actionObjects:(null===(n=e.actionInfo)||void 0===n?void 0:n.actionObjects)||[]},user:Object.assign(Object.assign({id:"",licenseType:""},e.user),{tenant:Object.assign({id:"",sku:""},null===(r=e.user)||void 0===r?void 0:r.tenant)}),app:Object.assign({iconPositionVertical:0,parentMessageId:"",userFileOpenPreference:ir.Inline,userClickTime:0,userClickTimeV2:0},e.app),page:Object.assign({isFullScreen:!1,subPageId:"",isMultiWindow:!1,sourceOrigin:""},e.page),meeting:{id:(null===(i=e.meeting)||void 0===i?void 0:i.id)||""},chat:{id:(null===(o=e.chat)||void 0===o?void 0:o.id)||""},channel:e.channel,sharePointSite:e.sharePointSite,sharepoint:e.sharepoint,team:e.team}};function Lf(e,t){var n,r,i;return{actionInfo:e.actionInfo,locale:e.app.locale,appSessionId:e.app.sessionId||"",appLaunchId:e.app.launchId||"",appId:null!==(n=null==t?void 0:t.id)&&void 0!==n?n:"",theme:e.app.theme,appIconPosition:e.app.iconPositionVertical||0,osLocaleInfo:e.app.osLocaleInfo,parentMessageId:e.app.parentMessageId||"",userClickTime:e.app.userClickTime||0,userClickTimeV2:e.app.userClickTimeV2||0,userFileOpenPreference:e.app.userFileOpenPreference||ir.Inline,hostName:e.app.host.name,hostClientType:e.app.host.clientType,sessionId:e.app.host.sessionId||"",ringId:e.app.host.ringId,entityId:e.page.id||"",frameContext:e.page.frameContext,subEntityId:e.page.subPageId||"",isFullScreen:e.page.isFullScreen||!1,isMultiWindow:e.page.isMultiWindow||!1,isBackgroundLoad:e.page.isBackgroundLoad,sourceOrigin:e.page.sourceOrigin||"",userObjectId:void 0!==e.user?e.user.id:void 0,isCallingAllowed:void 0!==e.user?e.user.isCallingAllowed:void 0,isPSTNCallingAllowed:void 0!==e.user?e.user.isPSTNCallingAllowed:void 0,userLicenseType:void 0!==e.user?e.user.licenseType:"",loginHint:void 0!==e.user?e.user.loginHint:void 0,userPrincipalName:void 0!==e.user?e.user.userPrincipalName:void 0,upn:void 0!==e.user?e.user.userPrincipalName:void 0,userDisplayName:void 0!==e.user?e.user.displayName:void 0,tid:void 0!==e.user&&void 0!==e.user.tenant?e.user.tenant.id:void 0,tenantSKU:(null===(i=null===(r=null==e?void 0:e.user)||void 0===r?void 0:r.tenant)||void 0===i?void 0:i.sku)||"",channelId:void 0!==e.channel?e.channel.id:void 0,channelName:void 0!==e.channel?e.channel.displayName:void 0,channelRelativeUrl:void 0!==e.channel?e.channel.relativeUrl:void 0,channelType:void 0!==e.channel?e.channel.membershipType:void 0,defaultOneNoteSectionId:void 0!==e.channel?e.channel.defaultOneNoteSectionId:void 0,hostTeamGroupId:void 0!==e.channel?e.channel.ownerGroupId:void 0,hostTeamTenantId:void 0!==e.channel?e.channel.ownerTenantId:void 0,chatId:void 0!==e.chat?e.chat.id:"",meetingId:void 0!==e.meeting?e.meeting.id:"",sharepoint:e.sharepoint,teamId:void 0!==e.team?e.team.internalId:void 0,teamName:void 0!==e.team?e.team.displayName:void 0,teamType:void 0!==e.team?e.team.type:void 0,groupId:void 0!==e.team?e.team.groupId:void 0,teamTemplateId:void 0!==e.team?e.team.templateId:void 0,isTeamArchived:void 0!==e.team?e.team.isArchived:void 0,userTeamRole:void 0!==e.team?e.team.userRole:void 0,teamSiteId:void 0!==e.sharePointSite?e.sharePointSite.teamSiteId:void 0,teamSiteUrl:void 0!==e.sharePointSite?e.sharePointSite.teamSiteUrl:void 0,teamSiteDomain:void 0!==e.sharePointSite?e.sharePointSite.teamSiteDomain:void 0,teamSitePath:void 0!==e.sharePointSite?e.sharePointSite.teamSitePath:void 0,mySiteDomain:void 0!==e.sharePointSite?e.sharePointSite.mySiteDomain:void 0,mySitePath:void 0!==e.sharePointSite?e.sharePointSite.mySitePath:void 0,dialogParameters:e.dialogParameters}}function Df(e){return void 0!==e&&Mn.has(e)}const Hf=new Map([["api.appInitialization.initialize",qe],["api.appInitialization.appLoaded",J],["api.appInitialization.success",ee],["api.appInitialization.failure",Z],["api.appInitialization.expectedFailure",Y]]);function _f(e){return sf().disableFirstPartyAppsAsMicrosoftOwned?!!(null==e?void 0:e.isFullTrust):!!(null==e?void 0:e.isMicrosoftOwned)||!!(null==e?void 0:e.isFullTrust)}class Mf{constructor(){this.logSubscribers=new Set}subscribeToLogs(e){if(this.logSubscribers.has(e)){const e="This logger has already been subscribed; duplicate subscriptions are not allowed.";throw console.log(e),new Error(e)}this.logSubscribers.add(e)}unsubscribeFromLogs(e){return this.logSubscribers.delete(e)}unsubscribeAll(){return this.logSubscribers.clear()}log(e,t,n,r){this.logSubscribers.forEach(i=>{i.log(e,t,n,r)})}}class Uf{constructor(){}static getInstance(){return Uf.instance||(Uf.instance=new Mf),Uf.instance}}const zf=new RegExp("[a-zA-Z0-9_\\-\\.]+(@|%40|%2540)[a-zA-Z0-9_\\-\\.]+\\.[a-zA-Z]{2,5}","g"),jf="https://teams.microsoft.com",$f=new URL(`${jf}/l/`),Wf=(e,t)=>{var n,r;const i=null===(r=null===(n=e.pages)||void 0===n?void 0:n.static)||void 0===r?void 0:r.find(e=>e.entityId===t);return null==i?void 0:i.name},qf=e=>"userSettingsChange"===e,Vf=e=>{let t;try{t=new URL(e).hostname}catch(t){return console.error("Invalid URL:",e),!1}return Xn.some(e=>t===e||t.endsWith("."+e))},Gf=(e,t)=>{var n,r;const i=e.split(".").map(Number),o=t.split(".").map(Number),a=Math.max(i.length,o.length);for(let e=0;e<a;e++){const t=null!==(n=i[e])&&void 0!==n?n:0,a=null!==(r=o[e])&&void 0!==r?r:0;if(t<a)return!0;if(t>a)return!1}return!1},Kf=(e,t)=>{const n=e.state===Yn.Loaded&&Vf(window.location.href)&&Gf(e.appSdkVersion||"0",Qn),r=e.state===Yn.Failed||n;return!t&&r},Xf=e=>!!e&&void 0!==e.user.id;function Qf(e){return e.majorVersion<1||1==e.majorVersion&&e.minorVersion<5}const Jf=e=>{let t;return t=e===sr.Public?lr.Public:e===sr.EUDB?lr.EUDB:lr.Other,t};function Yf(e){return e?((t=e)&&(t=t.replace(zf,"email_removed")),t):"";var t}const Zf=performance&&"object"==typeof performance&&["now","timeOrigin"].map(e=>e in performance).every(e=>e);function ep(e="monotonic"){return sf().useGlobalMonotonicTimersForTelemetry&&tp(e)||tp("date")}function tp(e){switch(e){case"date":return{type:"date",value:Date.now()};case"monotonic":if(!Zf)return;return{type:"monotonic",value:performance.now()+performance.timeOrigin};default:throw new Error(`Unsupported timestamp type: ${e}`)}}function np(){var e;return null===(e=tp("monotonic"))||void 0===e?void 0:e.value}function rp(e,t){return Zf&&e&&sf().useGlobalMonotonicTimersForTelemetry?{type:"monotonic",value:e}:t?{type:"date",value:t}:void 0}function ip(){return Zf?1e3*Math.floor(performance.now()):1e3*Date.now()}var op,ap;!function(e){e.Start="start",e.End="end"}(op||(op={})),function(e){e.MetaOsAppContainerInitiation="metaOsAppContainerInitiation_ms",e.GetPermissions="getPermissions_ms",e.IframeSetAndLoadOrigin="iframeSetAndLoadOrigin_ms",e.OverallAppLoadTimeBeforeInitialize="overallAppLoadTimeBeforeInitialize_ms",e.InitializeMessageDelay="initializeMessageDelay_ms",e.InitializeMessageProcessTime="initializeMessageProcessTime_ms",e.AppLoadedMessageDelay="appLoadedMessageDelay_ms",e.AppLoadedMessageProcessTime="appLoadedMessageProcessTime_ms",e.SuccessMessageDelay="successMessageDelay_ms",e.SuccessMessageProcessTime="successMessageProcessTime_ms",e.FailureMessageDelay="failureMessageDelay_ms",e.FailureMessageProcessTime="failureMessageProcessTime_ms",e.ExpectedFailureMessageDelay="expectedFailureMessageDelay_ms",e.ExpectedFailureMessageProcessTime="expectedFailureMessageProcessTime_ms"}(ap||(ap={}));const sp={[ap.MetaOsAppContainerInitiation]:0,[ap.GetPermissions]:0,[ap.IframeSetAndLoadOrigin]:0,[ap.OverallAppLoadTimeBeforeInitialize]:0,[ap.InitializeMessageDelay]:0,[ap.InitializeMessageProcessTime]:0,[ap.AppLoadedMessageDelay]:0,[ap.AppLoadedMessageProcessTime]:0,[ap.SuccessMessageDelay]:0,[ap.SuccessMessageProcessTime]:0,[ap.FailureMessageDelay]:0,[ap.FailureMessageProcessTime]:0,[ap.ExpectedFailureMessageDelay]:0,[ap.ExpectedFailureMessageProcessTime]:0};const lp={};let cp=!1;function up(e,t){var n;if(!cp&&(n=t,Object.values(ap).includes(n))&&"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance){const n=performance.now();if(e!==op.Start||lp.hasOwnProperty(t)){if(e===op.End){const e=lp[t];if(void 0!==e){const r=parseFloat((n-e).toFixed(2));sp[t]=Math.max(sp[t],r)}delete lp[t]}}else lp[t]=n}}class dp{constructor(e,t,r){var i,o;this.hubInfo=e,this.customTelemetryService=r,this.letterRegex=/[a-zA-Z]/,this.consumerTid="9188040d-6c67-4c5b-b112-36a304b66dad",this.telemetrySource="AppHostSdk",this.namespace="Office.AppHostingSdk",this.eventFieldPrefix="AppHost",this.ariaTenantToken="7ada8d16f9234e2093f080920f21dd7d-41cee27e-93c2-4a6b-a7aa-2001e852d387-7123",this.nexusTenantToken=-1,this.anonymousDataFields=[...Ur.Office.System.User.getFields("User",{isAnonymous:!0})];let a=[n(`${this.eventFieldPrefix}.HostName`,this.hubInfo.name),n(`${this.eventFieldPrefix}.HostVersion`,this.hubInfo.version),n(`${this.eventFieldPrefix}.HostSdkVersion`,Q),n(`${this.eventFieldPrefix}.HostSessionId`,this.hubInfo.sessionId),n(`${this.eventFieldPrefix}.TelemetrySource`,this.telemetrySource),n(`${this.eventFieldPrefix}.Platform`,t.app.host.clientType===ef.web?"Web":"Desktop"),n(`${this.eventFieldPrefix}.HostRingId`,null!==(i=null==t?void 0:t.app.host.ringId)&&void 0!==i?i:"")];this.telemetryLogger=new q,this.telemetryLogger.setTenantToken(this.namespace,this.ariaTenantToken,this.nexusTenantToken);const s=hp(t.user.dataResidency);if(s){this.oneDsSink=new Pd(a,{endpointUrl:s});const e=new Dd("HubSDKServiceEventThrottler",this.oneDsSink);e.setNamedEventThrottle(`${this.namespace}.${this.sanitizeScenarioName("api.getContext")}`,6),e.setNamedEventThrottle(`${this.namespace}.${this.sanitizeScenarioName("api.registerHandler")}`,5),e.setNamedEventThrottle(`${this.namespace}.${this.sanitizeScenarioName("api.getAuthToken")}`,4),this.oneDsSink.addPreprocessor(e),this.telemetryLogger.telemetrySinks=[this.oneDsSink]}let l=B({name:"OfficeAppHostingSdk"});null===(o=this.oneDsSink)||void 0===o||o.addPersistentDataFields(l),this.setAppContext(t),this.isTest=void 0!==window.Cypress||function(){var e;return"undefined"!=typeof process&&void 0!==(null===(e=null===process||void 0===process?void 0:process.env)||void 0===e?void 0:e.JEST_WORKER_ID)}(),this.enableExtendedInitializationTracking=(null==r?void 0:r.enableExtendedInitializationTracking)||!1}createScenario(e,t,n,r,i="monotonic"){var o,a;const s=n?{type:i,value:n}:ep();t=null!=t?t:null===(o=this.appDefinition)||void 0===o?void 0:o.id;const l=this.isTest?void 0:this.telemetryLogger.createActivity(this.createTelemetryEvent(e,s.value,t,r)),c=this.shouldCustomTelemetryScenarioReceiveAppInitTelemetry(e)?null===(a=this.customTelemetryService)||void 0===a?void 0:a.createScenario(e,t,n):void 0,u=this.shouldLogToAria(e,t);return"appInitialization"==e||"appInitializationExtended"==e?(this.addAppInitializationDataFields(),new pp(this,u,s,c,l,_f(this.appDefinition),e)):(this.addHubSdkTelemetryScenarioDataFields(s.value),new fp(this,u,s,c,l))}shouldCustomTelemetryScenarioReceiveAppInitTelemetry(e){var t,n;return e!==_d&&(!Hf.has(e)||!Df(null===(t=this.appDefinition)||void 0===t?void 0:t.id)||null!==(n=sf().shouldCustomTelemetryScenarioReceiveAppInitTelemetry)&&void 0!==n&&n)}addAppInitializationDataFields(){var r,i,o,a,s,l,c,u,d,f,p,h,v,g,m,y;let S=n(`${this.eventFieldPrefix}.ActionId`,null!==(o=null===(i=null===(r=this.appContext)||void 0===r?void 0:r.actionInfo)||void 0===i?void 0:i.actionId)&&void 0!==o?o:""),b=n("ManifestVersion",null!==(s=null===(a=this.appDefinition)||void 0===a?void 0:a.manifestVersion)&&void 0!==s?s:""),w=e("ShowLoadingIndicator",null!==(c=null===(l=this.appDefinition)||void 0===l?void 0:l.showLoadingIndicator)&&void 0!==c&&c),k=e(dp.CACHEDAPP_IND_FIELD_NAME,null!==(u=this.usingCachedApp)&&void 0!==u&&u),E=e(dp.BACKGROUND_LOAD_IND_FIELD_NAME,null!==(p=null===(f=null===(d=this.appContext)||void 0===d?void 0:d.page)||void 0===f?void 0:f.isBackgroundLoad)&&void 0!==p&&p);const A=n("InteractionContext",(Xf(this.appContext)&&this.appDefinition?function(e){if(e.frameContext===tf.sidePanel||e.frameContext===tf.meetingStage||e.frameContext===tf.content)return e.meetingId?"Meeting":e.chatId?"Chat":e.channelId?"Channel":"Personal"}(Lf(this.appContext,this.appDefinition)):void 0)||"");let C=t("UserClickTime",null!==(v=null===(h=this.appContext)||void 0===h?void 0:h.app.userClickTime)&&void 0!==v?v:0),I=t("UserClickTimeV2",null!==(m=null===(g=this.appContext)||void 0===g?void 0:g.app.userClickTimeV2)&&void 0!==m?m:0),T=n("FeatureFlags",JSON.stringify(sf()));null===(y=this.oneDsSink)||void 0===y||y.addPersistentDataFields([S,b,w,k,E,A,C,I,T])}addHubSdkTelemetryScenarioDataFields(e){var n;let r=t("AppSdkRequestCreationTimeStamp",e);null===(n=this.oneDsSink)||void 0===n||n.addPersistentDataFields([r])}static getApiVersionTagForTelemetry(e,t){if(null!=t){if(null==e&&(0,Hd.satisfies)(t,dp.TEAMS_JS_LIBRARY_V1))return"v1";if(null==e&&(0,Hd.satisfies)(t,`>${dp.TEAMS_JS_LIBRARY_V2_LOWEST_VERSION}`)&&(0,Hd.satisfies)(dp.TEAMS_JS_LIBRARY_VERSION_WITH_APIVERSIONTAG,`>${t}`))return"unknown";if(e&&(0,Hd.satisfies)(t,`>=${dp.TEAMS_JS_LIBRARY_VERSION_WITH_APIVERSIONTAG}`))return e}return null==e?"undefined_tag":e}setAppSdkVersion(e){this.appSdkVersion=e}getAppSdkVersion(){return this.appSdkVersion}setAppContext(e){var t,r,i,o,a,s,l;let c=this.appContext;if(this.appContext=e,this.oneDsSink){if(Xf(e)&&(!Xf(c)||e.user.id!==c.user.id)){let n,s=!e.user.id;if(s)n=this.anonymousDataFields;else{let l=(null===(r=null===(t=this.appContext.user)||void 0===t?void 0:t.tenant)||void 0===r?void 0:r.id)!==this.consumerTid;n=N({primaryIdentityHash:null===(i=e.user)||void 0===i?void 0:i.id,primaryIdentitySpace:l?"UserObjectId":"MSAPuid",tenantId:null===(a=null===(o=this.appContext.user)||void 0===o?void 0:o.tenant)||void 0===a?void 0:a.id,tenantGroup:l?"Commercial":"Consumer",isAnonymous:s})}this.oneDsSink.addPersistentDataFields(n)}if(this.appContext.app.sessionId!==(null==c?void 0:c.app.sessionId)){let e=L({id:null!==(s=this.appContext.app.sessionId)&&void 0!==s?s:""});this.oneDsSink.addPersistentDataFields(e)}if(this.appContext.app.locale!==(null==c?void 0:c.app.locale)){let e=n("Culture.UiLanguage",null!==(l=this.appContext.app.locale)&&void 0!==l?l:"");this.oneDsSink.addPersistentDataFields([e])}}}setAppDefinition(e){this.appDefinition=e}isSessionIdSet(){var e;return!!(null===(e=this.appContext)||void 0===e?void 0:e.app.sessionId)}setUsingCachedApp(e){this.usingCachedApp=e}createTelemetryEvent(e,t,r,i){var o,a,s,l,c,u,d,f,p;const h=[n("HostedAppId",null!=r?r:""),n("HostedAppEntityId",null!==(s=null===(a=null===(o=this.appContext)||void 0===o?void 0:o.page)||void 0===a?void 0:a.id)&&void 0!==s?s:""),n(dp.APPSDK_VERSION_FIELD_NAME,null!==(l=this.appSdkVersion)&&void 0!==l?l:""),n(dp.APPSDK_API_VERSION_TAG_FIELD_NAME,dp.getApiVersionTagForTelemetry(i,this.appSdkVersion)),n("HostedAppFrameContext",null!==(d=null===(u=null===(c=this.appContext)||void 0===c?void 0:c.page)||void 0===u?void 0:u.frameContext)&&void 0!==d?d:""),n("HostedAppSessionId",null!==(p=null===(f=this.appContext)||void 0===f?void 0:f.app.sessionId)&&void 0!==p?p:"")];return{eventName:`${this.namespace}.${this.sanitizeScenarioName(e)}`,eventFlags:{dataCategories:2,diagnosticLevel:110},dataFields:h,timestamp:t}}sanitizeScenarioName(e){let t="",n=!0;for(let r=0;r<e.length;r++){let i=e.charAt(r);"."===i&&0!==r&&"."!==t.charAt(t.length-1)?(t+=i,n=!0):this.letterRegex.test(i)?n?(n=!1,t+=i.toUpperCase()):t+=i:n=!0}return t}isAppStoreAppId(e){return!sf().disableExtendedTelemetryForMetaOSStoreApps&&!!e&&Hn.has(e)}shouldLogToAria(e,t){return!e.startsWith("eventDispatch")&&("appInitializationExtended"!==e||this.isAppStoreAppId(t))}}dp.TEAMS_JS_LIBRARY_V1="1.x",dp.TEAMS_JS_LIBRARY_V2_LOWEST_VERSION="2.0.0-beta.0",dp.TEAMS_JS_LIBRARY_VERSION_WITH_APIVERSIONTAG="2.21.0",dp.APPSDK_VERSION_FIELD_NAME="HostedAppSdkVersion",dp.APPSDK_API_VERSION_TAG_FIELD_NAME="HostedAppSdkApiVersionTag",dp.CACHEDAPP_IND_FIELD_NAME="UsingCachedApp",dp.APP_TERMINATE_REASON="HostedAppTerminateReason",dp.BACKGROUND_LOAD_IND_FIELD_NAME="IsBackgroundLoad",dp.WEB_CONTENT_SDK_ID="WebContentSdkId",dp.COMM_BRIDGE_ID="CommunicationBridgeId",dp.COMM_BRIDGE_LISTENERS_ADDED="CommunicationBridgeListenersAdded",dp.IFRAME_SRC="IFrameInfoSrc",dp.IFRAME_ORIGIN="IFrameOrigin",dp.APP_DEFINITION="AppDefinition",dp.USER_CLICK_TIME="UserClickTime",dp.USER_CLICK_TIME_V2="UserClickTimeV2",dp.APP_STATE_UPDATED="AppStateUpdated";class fp{constructor(e,t,n,r,i,o){var a;this.logger=e,this.shouldLogToAria=t,this.initialTimestamp=n,this.customScenario=r,this.activity=i,this.name=o,this.lastMark=sf().useGlobalMonotonicTimersForTelemetry?n:{type:(a=n).type,value:ip()-1e3*(Date.now()-a.value)}}addOrUpdateActivityDataField(r,i){var o,a,s,l,c,u,d;let f=null===(o=this.activity)||void 0===o?void 0:o.dataFields.find(e=>e.name==r);f?f.value=i:"string"==typeof i?null===(s=null===(a=this.activity)||void 0===a?void 0:a.dataFields)||void 0===s||s.push(n(r,i)):"boolean"==typeof i?null===(c=null===(l=this.activity)||void 0===l?void 0:l.dataFields)||void 0===c||c.push(e(r,i)):"number"==typeof i&&(null===(d=null===(u=this.activity)||void 0===u?void 0:u.dataFields)||void 0===d||d.push(t(r,i)))}oldMarkPhase(e,n){var r,i,o;const a=ip(),s=a-this.lastMark.value;n||(this.lastMark.value=a),null===(i=null===(r=this.activity)||void 0===r?void 0:r.dataFields)||void 0===i||i.push(t(`Activity.Phase.${e}`,s)),null===(o=this.customScenario)||void 0===o||o.markPhase(e)}markPhase(e,n=!1){var r,i,o;if(!sf().useGlobalMonotonicTimersForTelemetry)return this.oldMarkPhase(e,n);const a=ep(this.lastMark.type);if(this.lastMark.type!==a.type)return void Uf.getInstance().log(z.Warn,"telemetry","The last mark was set to be a monotonic timer without checking for support for the performance API.");const s=(l=a.value-this.lastMark.value,Math.floor(1e3*l));var l;n||(this.lastMark=a),null===(i=null===(r=this.activity)||void 0===r?void 0:r.dataFields)||void 0===i||i.push(t(`Activity.Phase.${e}`,s)),null===(o=this.customScenario)||void 0===o||o.markPhase(e)}trackMessageDelay(e,t,n){var r,i;null===(i=null===(r=this.customScenario)||void 0===r?void 0:r.trackMessageDelay)||void 0===i||i.call(r,e,t,n)}stop(){var e,t;void 0===(null===(e=this.activity)||void 0===e?void 0:e.success)&&(this.endActivity(!0),null===(t=this.customScenario)||void 0===t||t.stop())}fail(e){var t,r,i,o;void 0===(null===(t=this.activity)||void 0===t?void 0:t.success)&&(null===(i=null===(r=this.activity)||void 0===r?void 0:r.dataFields)||void 0===i||i.push(n("ErrorMessage",Yf(e))),this.endActivity(!1),null===(o=this.customScenario)||void 0===o||o.fail(e))}endActivity(e){var t,r;if("appInitialization"==this.name){const e=JSON.stringify(function(){const e=Object.assign({},sp);return function(){c(this,void 0,void 0,function*(){cp=!0;for(const e in sp)sp.hasOwnProperty(e)&&(sp[e]=0);for(const e in lp)lp.hasOwnProperty(e)&&delete lp[e];yield new Promise(e=>setTimeout(e,0)),cp=!1})}(),e}());null===(r=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===r||r.push(n("AppLoadingBreakdown",null!=e?e:""))}this.shouldLogToAria&&this.activity&&this.logger.isSessionIdSet()&&(this.activity.success=e,this.activity.endNow())}addDetails(e){var t,n;null===(n=null===(t=this.customScenario)||void 0===t?void 0:t.addDetails)||void 0===n||n.call(t,e)}}class pp extends fp{constructor(e,t,n,r,i,o,a){super(e,t,n,r,i,a),this.logger=e,this.shouldLogToAria=t,this.initialTimestamp=n,this.customScenario=r,this.activity=i,this.isFirstParty=o,this.name=a}fail(e,t){var r,i,o;null===(i=null===(r=this.activity)||void 0===r?void 0:r.dataFields)||void 0===i||i.push(n("ErrorMessage",Yf(e))),this.endActivity(!1),null===(o=this.customScenario)||void 0===o||o.fail(this.isFirstParty&&t?e.concat(":",t):e)}markWarnMessage(e){var t,r;null===(r=null===(t=this.activity)||void 0===t?void 0:t.dataFields)||void 0===r||r.push(n("WarnMessage",Yf(e)))}}const hp=e=>{switch(e){case sr.EUDB:return Bd.EUDB;case sr.DOD:return Bd.USGOV_DOD;case sr.DOJ:return Bd.USGOV_DOJ;case sr.Public:return Bd.PUBLIC;default:return}};class vp{constructor(e){this.logger=e,this.id=new Xd,this.MAX_DEPTH_OF_CHILD_IFRAME=6,this.getOrigin=()=>this.origin}setOrigin(e){this.origin=e}onSdkInitialized(e){this.hostEventListener&&this.dispose(),this.hostEventListener=new X(e),this.hostEventListener.addListener("message",this.onMessageReceived.bind(this))}onSetFrameAndLoadOrigin(e,t,n,r,i){this.frame=e,this.setOrigin(t),this.appDefinition=n,this.appContext=r,this.handleMessageCallbackIframe=i}postMessage(e,t){const n=this.getOrigin();n&&e.contentWindow&&e.contentWindow.postMessage(t,n)}postMessageWithTransferables(e,t,n){const r=this.getOrigin();r&&e.contentWindow&&e.contentWindow.postMessage(t,r,n)}postMessageToNestedIframe(e,t){const{func:n="null",source:r,origin:i}=null!=t?t:{};hr.has(n)&&(r&&i&&!r.closed?r.postMessage(e,i):this.logger.log(z.Error,"IframeCommunicationBridge","Error sending message to nested iframe"))}isEmbeddedRequest(e,t=0){var n;return e===(null===(n=this.frame)||void 0===n?void 0:n.contentWindow)||!(t>this.MAX_DEPTH_OF_CHILD_IFRAME||!(null==e?void 0:e.parent))&&this.isEmbeddedRequest(e.parent,t+1)}onMessageReceived(e){var t;if(!this.frame||this.frame.contentWindow!==e.source)return void(this.handleMessageCallbackIframe&&(null===(t=e.data)||void 0===t?void 0:t.func)&&hr.has(e.data.func)&&this.isEmbeddedRequest(e.source)&&this.handleMessageCallbackIframe(Or(e,!0)));const n=e.origin;n&&n!==this.getOrigin()&&uf(n,this.logger,this.appDefinition,this.appContext)&&this.setOrigin(n),this.getOrigin()===n&&this.handleMessageCallbackIframe&&this.handleMessageCallbackIframe(Or(e,!1))}dispose(){var e;null===(e=this.hostEventListener)||void 0===e||e.removeAllListeners(),this.hostEventListener=void 0}}function gp(e,t,n){var r;if(!e)return;const i=e.createScenario("commBridgeDisposed",n);null===(r=null==i?void 0:i.addOrUpdateActivityDataField)||void 0===r||r.call(i,dp.COMM_BRIDGE_ID,(null==t?void 0:t.toString())||"unknown"),null==i||i.stop()}const mp="allow-forms allow-popups allow-popups-to-escape-sandbox allow-pointer-lock allow-scripts allow-same-origin allow-modals allow-downloads allow-top-navigation-to-custom-protocols allow-storage-access-by-user-activation",yp=({sdkHost:e,contentUrl:t,frameContext:n,appDefinition:r,title:i,isLoading:o,userClickTime:a,userClickTimeV2:s,allowList:l})=>{const u=V.useRef(null);return V.useEffect(()=>(c(void 0,void 0,void 0,function*(){yield e.setFrameAndLoadOrigin(u.current,t,r,a,void 0,s)}),()=>{e.unloadApp(r,"host_cleanup")}),[r,t,n,u,e,a,s]),V.createElement("iframe",{key:`iframe-${t}`,id:`iframe:${r.id}`,"data-tid":"app-host-iframe",ref:u,style:o?Object.assign({},{display:"none"}):Object.assign({},{border:0,flex:1}),sandbox:mp,title:i,allow:l})},Sp=(e,t,n,r=window)=>{const i=(0,V.useCallback)(()=>{if(n.current&&t.current){const i=t.current.style,o=e?"none":"flex";if(e)return void(i.display=o);const a=n.current.getBoundingClientRect(),s=r.scrollX||r.pageXOffset,l=r.scrollY||r.pageYOffset;i.position="absolute",i.left=`${a.left+s}px`,i.top=`${a.top+l}px`,i.width=`${n.current.offsetWidth}px`,i.height=`${n.current.offsetHeight}px`,i.display="flex"}},[e,t,n,t.current,r]);(0,V.useEffect)(()=>{i();const e=function(e){let t=null;return function(...n){t||(t=setTimeout(()=>((n,r)=>{t=null,e.apply(n,r)})(this,n),100))}}(i);return r.addEventListener("resize",e),()=>{r.removeEventListener("resize",e)}},[i,r])},bp=({sdkHost:e,contentUrl:t,appDefinition:n,title:r,isLoading:i,userClickTime:o,userClickTimeV2:a,allowList:s,cacheManagementService:l,communicationBridge:u,setIsUnLoading:d})=>{const f=V.useRef(!1),p=V.useRef(null),h=V.useRef(null),v=V.useRef(!1),[g,m]=V.useState(!1),y=((e,t,n,r,i,o,a,s,l,u)=>V.useCallback(()=>c(void 0,void 0,void 0,function*(){e.current=document.createElement("iframe"),u(!0),e.current.setAttribute("id",`cacheable-iframe:${t.id}`),e.current.setAttribute("data-tid","app-host-iframe"),e.current.setAttribute("title",null!=n?n:""),e.current.setAttribute("sandbox",mp),e.current.setAttribute("style","border:0"),e.current.setAttribute("key",`iframe-${i}`),document.body.appendChild(e.current);const c={appId:t.id,contentUrl:i,displayName:n,frameContext:tf.content};l.addAppToCache(c,s,e.current),yield r.setFrameAndLoadOrigin(e.current,i.toString(),t,o,!1,a)}),[e,u,t,n,i,l,s,r,o,a]))(p,n,r,e,t,o,a,u,l,m),S=V.useCallback(e=>{const t=l.getCachedApp(e);return t&&t.currentAppState.state!==Yn.Cached?(d(!0),t.unloadingTimeoutDeferred||(t.unloadingTimeoutDeferred=function(){const e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e}()),t.unloadingTimeoutDeferred.promise):Promise.resolve(!0)},[l,d]);return V.useEffect(()=>{f.current=!1},[n,t]),V.useEffect(()=>()=>{p.current&&(p.current.style.display="none")},[n,t,p]),V.useEffect(()=>(v.current=!0,c(void 0,void 0,void 0,function*(){if(f.current)return;f.current=!0;const r={appId:n.id,frameContext:tf.content};let i=l.getCachedApp(r);const s=i=>c(void 0,void 0,void 0,function*(){if(!i)return;d(!1);const s=l.getCachedApp(r);s?e.setFrameAndLoadOrigin(s.frameInfo,t,n,o,!0,a):y()});if(i&&l.isAppRegisteredForCaching(i)){if(p.current=i.frameInfo,m(!0),!v.current)return;const e=yield S(r);yield s(e)}else{const e=yield S(r);yield s(e)}}),()=>{e.unloadApp(n,"host_cleanup"),v.current=!1,f.current=!1,p.current=null,m(!1)}),[l,n,e,t,o,a,v,S,d,y]),V.useEffect(()=>{p.current&&s&&p.current.setAttribute("allow",s)},[n,s,p,g]),Sp(i,p,h),V.createElement(()=>V.createElement("div",{ref:h,style:{border:0,flex:1},id:"cachable-div-container"}),null)},wp=({isolationProvider:e,hostProps:t,errorUI:n,appHostSdk:r})=>{const i=V.useRef(null);return V.useEffect(()=>()=>{r.unloadApp(t.appDefinition,"component_unmount")},[r,t.appDefinition,t.contentUrl]),V.createElement("div",{id:"isolation-provider-container",ref:i,style:{flex:1,display:"flex",flexDirection:"column"}},n(),e.renderHost(t))};var kp,Ep,Ap,Cp,Ip,Tp;!function(e){e.Unknown="Unknown",e.Windows="Windows",e.iOS="iOS",e.Android="Android",e.Linux="Linux",e.tvOS="tvOS",e.MacOS="MacOS"}(kp||(kp={})),function(e){e.Unknown="Unknown",e.EXO="EXO",e.SPO="SPO",e.OXO="OXO",e.MileIQ="MileIQ",e.AFS="AFS",e.Teams="Teams",e.Stream="Stream",e.ODB="ODB",e.MicrosoftPowerBI="MicrosoftPowerBI",e.Yammer="Yammer"}(Ep||(Ep={})),function(e){e.NotSpecified="NotSpecified",e.User="User",e.System="System"}(Ap||(Ap={})),function(e){e.Unknown="Unknown",e.Anonymous="Anonymous",e.AAD="AAD",e.MSA="MSA",e.Self="Self"}(Cp||(Cp={})),function(e){e.Unknown="Unknown",e.AccessControlData="AccessControlData",e.CustomerContent="CustomerContent",e.EUII="EUII",e.OII="OII",e.AccountData="OII",e.SystemMetaData="SystemMetaData"}(Ip||(Ip={})),function(e){e.ApplicationEngaged="ApplicationEngaged"}(Tp||(Tp={}));class xp{constructor(e,t,n){var r,i,o;this.appSdkHost=e,this.hubServices=t,this.appContext=n,this.getDefaultSignalAuthToken=()=>c(this,void 0,void 0,function*(){var e;if(!(null===(e=this.hubServices.authenticationService)||void 0===e?void 0:e.acquireToken))throw new Error("Cancelled since service is not available.");const t=yield this.hubServices.authenticationService.acquireToken(xp.DEFAULT_SIGS_RESOURCE_URL,void 0,!0);if(t&&t.token)return t.token;throw new Error("Empty token response.")}),this.delay=e=>new Promise(t=>{var n;setTimeout(t,Math.pow(null!==(n=this.jestDelay)&&void 0!==n?n:100,e))});const a=this.appSdkHost.getAppDefinition();this.actorInfo={ActorId:Cp.Self,ActorIdType:Cp.Self,ActorType:Ap.User,AadTenantId:Cp.Self},this.applicationInfo={AppName:"",AadAppId:null!==(r=null==a?void 0:a.id)&&void 0!==r?r:"",Workload:this.getWorkLoad(null===(i=this.appContext)||void 0===i?void 0:i.app.host.name)},this.deviceInfo={Os:this.getOs(),UserAgent:window.navigator.userAgent},this.commonCustomProperties={HubName:null===(o=this.appContext)||void 0===o?void 0:o.app.host.name,MetaOSHubSDKVersion:Q}}createSignal(e){return{SignalType:e.signalType,Compliance:Ip.CustomerContent,CV:this.appContext.app.sessionId,StartTime:this.getDateTime(e.startTime),EndTime:this.getDateTime(e.endTime),Application:Object.assign({},this.applicationInfo),Actor:Object.assign({},this.actorInfo),Device:Object.assign({},this.deviceInfo),CustomProperties:Object.assign(Object.assign({},this.commonCustomProperties),e.customProperties)}}getDateTime(e){return e&&e>0?new Date(e):new Date}getWorkLoad(e){switch(e){case Qd.office||Qd.outlookWin32||Qd.office:return Ep.OXO;case Qd.teams||Qd.teamsModern:return Ep.Teams;default:return Ep.Unknown}}getOs(){let e="Unknown";if(window&&window.navigator.userAgent){let t=window.navigator.userAgent;-1!=t.indexOf("Windows")?e="Windows":-1!=t.indexOf("Mac OS")?e="MacOS":-1!=t.indexOf("Android")?e="Android":-1!=t.indexOf("Linux")?e="Linux":/iPad|iPhone|iPod/.test(t)&&(e="iOS")}return e}sendSignal(e,t){return new Promise((n,r)=>c(this,void 0,void 0,function*(){if(t)n(this.postSignalWithRetry(e,t,1));else try{const t=yield this.getDefaultSignalAuthToken();n(this.postSignalWithRetry(e,t,1))}catch(e){r(e)}}))}postSignalWithRetry(e,t,n){return n>xp.RETRY_LIMIT?Promise.reject("Retry Limit reached. Unable to send Signal."):fetch(xp.SIGS_ENDPOINT,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json","X-SignalInstanceId":e.CV,Authorization:"Bearer "+t}}).catch(e=>Promise.reject(e)).then(r=>c(this,void 0,void 0,function*(){return r&&r.ok?Promise.resolve(e.CV):r&&xp.RETRY_CODES.has(r.status)?(yield this.delay(n),this.postSignalWithRetry(e,t,++n)):Promise.reject(r)}))}}function Rp(e,t,n){return c(this,void 0,void 0,function*(){try{let n=yield e.getAppContext();if(n.page.frameContext!=tf.authentication){const r=new xp(e,t,n),i=r.createSignal({signalType:Tp.ApplicationEngaged,startTime:e.getUserClickTime(),endTime:Date.now()});let o=yield r.sendSignal(i);e.getLogger().log(z.Debug,"sendAppEngageSignal","Successfully posted the signal",o)}}catch(t){let r=t;if("status"in t){r=t.status+"";const e=null==n?void 0:n.createScenario("sigsSendSignalFailure");null==e||e.fail(r)}e.getLogger().log(z.Error,"sendAppEngageSignal","Error occurred while sending substrate signal",r)}})}function Op(e,t){if(function(e){return/<script[^>]*>[\s\S]*?<\/script[^>]*>/gi.test(e)}(e)||!function(e){return e.length<256&&e.length>4}(e)||!function(e){for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n<32||n>126)return!1}return!0}(e))throw null!=t?t:br(Zn.INVALID_ARGUMENTS,"App ID is not valid.")}xp.SIGS_ENDPOINT="https://substrate.office.com/sigsapi/v1.0/Me/Signals",xp.RETRY_LIMIT=2,xp.RETRY_CODES=new Set([503]),xp.DEFAULT_SIGS_RESOURCE_URL="https://outlook.office.com";class Pp{constructor(e){this.appIdAsString=e,Op(e)}toString(){return this.appIdAsString}get id(){return this.appIdAsString}}class Np{constructor(e,t){this.appSdkHost=e,this.telemetryService=t,this.handlers={},this.appDefinition=this.appSdkHost.getAppDefinition(),this.isTelemetryHandledByExecutor=!1}registerHandler(e,t,n){var r;this.handlers[e]=function(e){return sf().disableFirstPartyAppsAsMicrosoftOwned?e:Object.assign(Object.assign({},e),{isRestrictedToFirstPartyOrLobApps:e.isRestrictedToFullTrustOrLobApps||e.isRestrictedToFirstPartyOrLobApps,isRestrictedToMicrosoftOwnedOrFullTrustApps:e.isRestrictedToMicrosoftOwnedOrFullTrustApps||e.isRestrictedToFullTrustApps,isRestrictedToFullTrustApps:!1,isRestrictedToFullTrustOrLobApps:!1})}({callback:t,scenarioName:null!==(r=null==n?void 0:n.scenarioName)&&void 0!==r?r:Md[e],errorCallback:null==n?void 0:n.errorCallback,callbackFixedArgsLength:null==n?void 0:n.callbackFixedArgsLength,isRestrictedToFirstPartyOrLobApps:null==n?void 0:n.isRestrictedToFirstPartyOrLobApps,isRestrictedToFullTrustApps:null==n?void 0:n.isRestrictedToFullTrustApps,isRestrictedToFullTrustOrLobApps:null==n?void 0:n.isRestrictedToFullTrustOrLobApps,isRestrictedToMicrosoftOwnedApps:null==n?void 0:n.isRestrictedToMicrosoftOwnedApps,isRestrictedToMicrosoftOwnedOrFullTrustApps:null==n?void 0:n.isRestrictedToMicrosoftOwnedOrFullTrustApps})}deleteMessageHandling(e){delete this.handlers[e]}canHandleMessage(e){return this.validateInitialization(e)&&void 0!==this.handlers[e]}isAnAuthUXScenario(e){return e===Md[ie]}canPassScenarioToHandler(e){return e===Md[ie]||e===Md[Te]||e===Md[xe]||e===Md[Re]||e===Md[Oe]||e===Md[Be]||e===Md[Ne]||e===Md[Fe]||e===Md[Le]||e===Md[ke]||e===Md[Ee]||e===Md[Ae]||e===Md[Ce]||e===Md[Ie]||e===Md[Ft]||e===Md[ne]}handleMessage(e,t,n,r){var i,o,a,s,l,u,d,f;return c(this,void 0,void 0,function*(){if(!this.validateInitialization(t))return Promise.reject("SDK context is not initialized");if(!this.canHandleMessage(t))return Promise.reject(`Handler cannot handle message: ${t}`);const c=null!==(i=this.handlers[t].callbackFixedArgsLength)&&void 0!==i?i:n.length;n.push(...Array(Math.max(0,c-n.length)).fill(void 0)),this.trackMessageDelayForAppInitAPIs(t,r);const p=this.handlers[t];let h=this.createTelemetryScenario(t,p,n,e,r);try{if(p.isRestrictedToFullTrustApps&&!(null===(o=this.appSdkHost.getAppDefinition())||void 0===o?void 0:o.isFullTrust))throw br(Zn.INTERNAL_ERROR,Vn);if(p.isRestrictedToMicrosoftOwnedApps&&!(null===(a=this.appSdkHost.getAppDefinition())||void 0===a?void 0:a.isMicrosoftOwned))throw br(Zn.INTERNAL_ERROR,Vn);if(p.isRestrictedToFullTrustOrLobApps&&!(null===(s=this.appSdkHost.getAppDefinition())||void 0===s?void 0:s.isFullTrust)&&!(null===(l=this.appSdkHost.getAppDefinition())||void 0===l?void 0:l.isLOB))throw br(Zn.INTERNAL_ERROR,Vn);if(p.isRestrictedToFirstPartyOrLobApps&&!_f(this.appSdkHost.getAppDefinition())&&!(null===(u=this.appSdkHost.getAppDefinition())||void 0===u?void 0:u.isLOB))throw br(Zn.INTERNAL_ERROR,Vn);if(p.isRestrictedToMicrosoftOwnedOrFullTrustApps&&!(null===(d=this.appSdkHost.getAppDefinition())||void 0===d?void 0:d.isFullTrust)&&!(null===(f=this.appSdkHost.getAppDefinition())||void 0===f?void 0:f.isMicrosoftOwned))throw br(Zn.INTERNAL_ERROR,Vn);if(!this.appSdkHost.checkIfCachedAndRequestAllowed(t))throw"Request not allowed when cached";this.validateDependencies(t);const e=yield p.callback.apply(this,n);return this.isAnAuthUXScenario(p.scenarioName)||null==h||h.stop(),e}catch(e){const t=Rr(e);return this.appSdkHost.getLogger().log(z.Error,"handleMessage","Error in handling message",t),p.errorCallback?p.errorCallback(e,h):(null==h||h.fail(t),Promise.reject(e))}})}createTelemetryScenario(e,t,n=[],r,i){var o,a;let s;if(!this.isTelemetryHandledByExecutor&&t.scenarioName){if(function(e,t){return Ud.has(e)&&!Df(t)}(e,null===(o=this.appDefinition)||void 0===o?void 0:o.id))return;s=this.telemetryService.createScenario(t.scenarioName,null===(a=this.appDefinition)||void 0===a?void 0:a.id,null==i?void 0:i.value,r,null==i?void 0:i.type),i&&s.markPhase("MessageDelay"),this.canPassScenarioToHandler(t.scenarioName)&&n.push(s)}return s}validateInitialization(e){return e===qe||this.appSdkHost.isInitialized()}trackMessageDelayForAppInitAPIs(e,t){}validateDependencies(e){}cleanup(){}}function Fp(e,t){const n=Object.assign({},e);return t.forEach(e=>delete n[e]),n}const Bp=[{versionToDowngradeFrom:4,downgradeToPreviousVersion:e=>{var t,n,r,i,o;return{apiVersion:3,hostVersionsInfo:e.hostVersionsInfo,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{url:(null===(t=e.supports)||void 0===t?void 0:t.dialog.url)?(null===(r=null===(n=e.supports)||void 0===n?void 0:n.dialog.url)||void 0===r?void 0:r.bot)?{bot:{}}:{}:void 0,card:null===(i=e.supports.dialog)||void 0===i?void 0:i.card,update:null===(o=e.supports.dialog)||void 0===o?void 0:o.update}:void 0})}}},{versionToDowngradeFrom:3,downgradeToPreviousVersion:e=>({apiVersion:2,hostVersionsInfo:e.hostVersionsInfo,supports:Fp(e.supports,["clipboard","webStorage"])})},{versionToDowngradeFrom:2,downgradeToPreviousVersion:e=>{var t,n,r,i,o;return{apiVersion:1,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{bot:null===(r=null===(n=null===(t=e.supports)||void 0===t?void 0:t.dialog)||void 0===n?void 0:n.url)||void 0===r?void 0:r.bot,card:null===(i=e.supports.dialog)||void 0===i?void 0:i.card,update:null===(o=e.supports.dialog)||void 0===o?void 0:o.update}:void 0})}}}],Lp="App failed to call notifySuccess(). Loading screen apps are required to call notifySuccess() when the app is loaded.",Dp="App failed to call initialize(). Check logs for CSP errors. Immediate apps may still be running properly; loading screen apps are required to call `app.initialize()`.",Hp="App Load timed out while waiting for app.initialize after Hub instance was created",_p="App Load timed out while waiting for app.notifySuccess after app.initialize was called";var Mp;!function(e){e[e.initialAppInitializationTimerExpiration=1]="initialAppInitializationTimerExpiration",e[e.extendedAppInitializationTimerExpiration=2]="extendedAppInitializationTimerExpiration"}(Mp||(Mp={}));class Up extends Np{constructor(e,t,n,r,i,o,a){var s,l,c,u,d,f,p;super(e,n),this.appSdkHost=e,this.hubServices=t,this.telemetryService=n,this.hostVersionsInfo=r,this.usingCachedApp=i,this.isNAAChannelRecommended=o,this.originsToBlock=a,this.initializationStatusReported=!1,this.appInitializationScenarioAlreadyStopped=!1,this.getOCDIWarning=()=>{var e;const t=null===(e=this.telemetryService)||void 0===e?void 0:e.getAppSdkVersion();return Vf(window.location.href)&&t&&Gf(t,Qn)?Jn:""},this.startTimerToWaitForInitializeCallFromApp=()=>this.usingCachedApp?window.setTimeout(()=>{var e,t,n;this.failAppInitializationScenario("Cached app load timed out"),null===(e=this.extendedAppInitializationScenario)||void 0===e||e.fail("Cached app load timed out"),this.appSdkHost.setAppInitInfo({state:Yn.Failed,reason:Pn.CachedAppLoadTimedOut,appSdkVersion:null===(t=this.telemetryService)||void 0===t?void 0:t.getAppSdkVersion()}),null===(n=this.hubServices.logger)||void 0===n||n.log(z.Error,"Error Screen Reason",Lp+this.getOCDIWarning())},this.timeToWaitForStateTransitionsInMs):this.isLoadingScreenApp()?window.setTimeout(()=>{this.onInitializeCallTimedOutForLoadingScreenApp()},this.timeToWaitForStateTransitionsInMs):window.setTimeout(()=>{this.onInitializeCallTimedOutForImmediateApp()},this.timeToWaitForStateTransitionsInMs),this.stopAppInitializationScenario=()=>{var e;this.stopInitializeStateTransitionTimer(),null===(e=this.appInitializationScenario)||void 0===e||e.stop(),this.appInitializationScenarioAlreadyStopped=!0},this.failAppInitializationScenario=(e,t)=>{var n;this.stopInitializeStateTransitionTimer(),null===(n=this.appInitializationScenario)||void 0===n||n.fail(e,t)},this.stopInitializeStateTransitionTimer=()=>{window.clearTimeout(this.initStateTransitionTimerId)},this.recordInitializationDoubleStopAttempt=e=>{const t=this.telemetryService.createScenario("initializationDoubleStopAttempt");t.addOrUpdateActivityDataField("doubleInitEndAttemptCodeLocation",e),t.stop()},this.appSdkHost.startAppInitializationScenario(),this.appInitializationScenario=null===(s=this.appSdkHost)||void 0===s?void 0:s.getAppInitializationScenario(),null===(l=this.appInitializationScenario)||void 0===l||l.markPhase("ClickToBeginLoad"),this.logTelemetryForAppSdkLoaded(),this.isShowLoadingIndicatorEnabled=(null===(c=e.getAppDefinition())||void 0===c?void 0:c.showLoadingIndicator)||!1,this.forceAppToBeLoadingScreenApp=null!==(u=sf().resetTimerWhenInitCalledAndWaitForNotifySuccess)&&void 0!==u&&u,null===(d=this.appInitializationScenario)||void 0===d||d.addOrUpdateActivityDataField("resetTimerFlag",this.forceAppToBeLoadingScreenApp),this.recordCachingServiceState();const h=null===(f=this.appSdkHost.getAppDefinition())||void 0===f?void 0:f.id,v=null===(p=this.telemetryService)||void 0===p?void 0:p.enableExtendedInitializationTracking,g=h&&Hn.has(h);(v||g)&&(this.extendedAppInitializationScenario=this.createExtendedAppInitTelemetry(h)),this.timeToWaitForStateTransitionsInMs=this.isLoadingScreenApp()?this.getTimeoutValueForLoadingScreenAppInMills():this.getTimeoutValueForImmediateAppInMills(),this.initStateTransitionTimerId=this.startTimerToWaitForInitializeCallFromApp()}recordCachingServiceState(){var e,t;null===(e=this.appInitializationScenario)||void 0===e||e.addOrUpdateActivityDataField("isLifecycleServiceProvided",!!this.hubServices.lifecycleService),null===(t=this.appInitializationScenario)||void 0===t||t.addOrUpdateActivityDataField("isCacheManagementServiceProvided",!!this.hubServices.cacheManagementService)}createExtendedAppInitTelemetry(e){var t;const n=null===(t=this.telemetryService)||void 0===t?void 0:t.createScenario("appInitializationExtended",e);return null==n||n.markPhase("ClickToBeginLoad"),null==n||n.addOrUpdateActivityDataField("resetTimerFlag",this.forceAppToBeLoadingScreenApp),n}initHandlers(){this.registerHandler(qe,this.onInitializeCalled),this.registerHandler(We,this.getContext,{errorCallback:this.onGetContextError}),this.registerHandler("readyToUnload",this.readyToUnload),this.registerHandler(J,this.onNotifyAppLoadedCalled),this.registerHandler(ee,this.onNotifySuccessCalled),this.registerHandler(Z,this.onNotifyFailureCalled),this.registerHandler(Y,this.onNotifyExpectedFailureCalled)}getTimeoutValueForImmediateAppInMills(){var e;const t=sf().overrideForEachInitStateChangeTimeoutsInMs;return null!=t?(null===(e=this.hubServices.logger)||void 0===e||e.log(z.Info,"Feature Flag overrideForEachInitStateChangeTimeoutsInMs",`Using feature flag overrideForEachInitStateChangeTimeoutsInMs for immediate app: ${t} milliseconds`),t):3e4}getTimeoutValueForLoadingScreenAppInMills(){var e,t;const n=sf().extendedAppLoadTimeoutInMillis,r=sf().overrideForEachInitStateChangeTimeoutsInMs;return null!=r?(null===(e=this.hubServices.logger)||void 0===e||e.log(z.Info,"Feature Flag overrideForEachInitStateChangeTimeoutsInMs",`Using feature flag overrideForEachInitStateChangeTimeoutsInMs for loading screen app: ${r} milliseconds`),r):null!=n?(null===(t=this.hubServices.logger)||void 0===t||t.log(z.Info,"Feature Flag extendedAppLoadTimeoutInMillis",`Using feature flag extendedAppLoadTimeoutInMillis: ${n} milliseconds`),n):45e3}isLoadingScreenApp(){return this.forceAppToBeLoadingScreenApp||this.isShowLoadingIndicatorEnabled}updateTelemetryDataFieldAppSdkVersion(e,t){t.forEach(t=>{null==t||t.addOrUpdateActivityDataField(dp.APPSDK_VERSION_FIELD_NAME,e)})}updateTelemetryDataFieldAppSdkApiVersionTag(e,t,n){const r=e.data.apiVersionTag;n.forEach(e=>{null==e||e.addOrUpdateActivityDataField(dp.APPSDK_API_VERSION_TAG_FIELD_NAME,dp.getApiVersionTagForTelemetry(r,t))})}updateTelemetryDataFieldUsingCachedApp(e){e.forEach(e=>{var t;null==e||e.addOrUpdateActivityDataField(dp.CACHEDAPP_IND_FIELD_NAME,null!==(t=this.usingCachedApp)&&void 0!==t&&t)})}updateAppInitializationScenarioFields(e,t){this.updateTelemetryDataFieldAppSdkVersion(e,[this.appInitializationScenario,this.extendedAppInitializationScenario]),this.updateTelemetryDataFieldAppSdkApiVersionTag(t,e,[this.appInitializationScenario,this.extendedAppInitializationScenario]),this.updateTelemetryDataFieldUsingCachedApp([this.appInitializationScenario,this.extendedAppInitializationScenario])}markTelemetryForAppInitializationPhases(e,t,n){var r,i;null===(r=this.appInitializationScenario)||void 0===r||r.markPhase(e),null===(i=this.extendedAppInitializationScenario)||void 0===i||i.markPhase(e),this.telemetryService.setAppSdkVersion(t),this.updateAppInitializationScenarioFields(t,n)}trackMessageDelayForAppInitAPIs(e,t){var n,r,i,o;if(Ud.has(e)&&t){const a=function(e,t){const n=function(e){return ep(e.type).value-e.value}(t);switch(e){case qe:sp.initializeMessageDelay_ms=n;break;case J:sp.appLoadedMessageDelay_ms=n;break;case ee:sp.successMessageDelay_ms=n;break;default:console.warn(e+" is not supported in this environment")}return n}(e,t),s=Ud.get(e);if(!s)return void console.warn(`${s} is undefined in applicationInitializationAPIs`);up(op.Start,`${s}MessageProcessTime_ms`),null===(r=null===(n=this.appInitializationScenario)||void 0===n?void 0:n.trackMessageDelay)||void 0===r||r.call(n,s,t,a),null===(o=null===(i=this.extendedAppInitializationScenario)||void 0===i?void 0:i.trackMessageDelay)||void 0===o||o.call(i,s,t,a)}}onInitializeCalled(e,t,n,r){var i,o,a,s,l,c;this.markTelemetryForAppInitializationPhases("BeginLoadToInitialized",t,e);const u=null===(i=this.originsToBlock)||void 0===i?void 0:i.isOriginBlocked(new Pp(null!==(a=null===(o=this.appDefinition)||void 0===o?void 0:o.id)&&void 0!==a?a:""),r||[]);if(this.originsToBlock&&!(null==u?void 0:u.isOriginValid))return this.onNotifyFailureCalled(new MessageEvent(""),Pn.Validation_InvalidDomains,null==u?void 0:u.message),Ar(null==u?void 0:u.message);n||(n=1),this.appSdkHost.setInitialized(!0);const d=this.appSdkHost.getHubInfo();let f=this.constructHubConfig(d);var p;(null===(s=f.hostVersionsInfo)||void 0===s?void 0:s.appEligibilityInformation)&&(null===(l=f.supports.copilot)||void 0===l?void 0:l.eligibility)&&(null===(c=this.hubServices.logger)||void 0===c||c.log(z.Warn,"AppEligibilityInformation from host","Host has provided appEligibilityInformation AND ICopilotEligibilityService. Only one of these should be provided.")),p=n<f.apiVersion?((e,t,n=Bp)=>{if(e.apiVersion<=t)return e;let r=e;for(let e of n)if(r.apiVersion===e.versionToDowngradeFrom&&(r=e.downgradeToPreviousVersion(r)),r.apiVersion<=t)break;return r})(f,n):f;const h=[this.appSdkHost.getFrameContext(),this.appSdkHost.getHubInfo().clientType,"2.0.0",JSON.stringify(p)];return up(op.End,ap.InitializeMessageProcessTime),this.isLoadingScreenApp()?(this.stopInitializeStateTransitionTimer(),this.initStateTransitionTimerId=window.setTimeout(()=>{var e,t,n,r;this.appInitializationScenarioAlreadyStopped?(this.recordInitializationDoubleStopAttempt(Mp.extendedAppInitializationTimerExpiration),this.appSdkHost.setAppInitInfo({state:Yn.Loaded,appSdkVersion:null===(e=this.telemetryService)||void 0===e?void 0:e.getAppSdkVersion()})):(this.failAppInitializationScenario(_p),null===(t=this.extendedAppInitializationScenario)||void 0===t||t.fail(_p),this.appSdkHost.setAppInitInfo({state:Yn.Failed,reason:Pn.AppInitTimeout,appSdkVersion:null===(n=this.telemetryService)||void 0===n?void 0:n.getAppSdkVersion()})),null===(r=this.hubServices.logger)||void 0===r||r.log(z.Error,"Error Screen Reason",Lp+this.getOCDIWarning())},this.timeToWaitForStateTransitionsInMs)):(this.appSdkHost.setAppInitInfo({state:Yn.Loaded,appSdkVersion:t}),this.stopAppInitializationScenario(),sf().createAndSendSignalsToSubstrate&&Rp(this.appSdkHost,this.hubServices,this.telemetryService)),Ar(h)}getUpdatedHostVersionsInfo(){var e,t,n,r;const i=null!==(t=null===(e=this.appDefinition)||void 0===e?void 0:e.appEligibilityInformation)&&void 0!==t?t:null===(n=this.hostVersionsInfo)||void 0===n?void 0:n.appEligibilityInformation;return!hf(this.appDefinition)&&i?(null===(r=this.hubServices.logger)||void 0===r||r.log(z.Warn,"AppEligibilityInformation from host","App is not a copilot app, so `hostVersionInfo.appEligibilityInformation` is removed before sending the object to teams-js."),Object.assign(Object.assign({},this.hostVersionsInfo),{appEligibilityInformation:void 0})):Object.assign(Object.assign({},this.hostVersionsInfo),{appEligibilityInformation:i})}getContext(){return c(this,void 0,void 0,function*(){const e=Lf(yield this.appSdkHost.getAppContext(),this.appDefinition);return Ar(e)})}onGetContextError(e,t){return null==t||t.fail(Rr(e)),Ar({})}onNotifyAppLoadedCalled(e,t){var n;return c(this,void 0,void 0,function*(){return this.markTelemetryForAppInitializationPhases("InitializedToAppLoadedInvoked",t,e),this.appSdkHost.setAppInitInfo({state:Yn.Loaded,appSdkVersion:null===(n=this.telemetryService)||void 0===n?void 0:n.getAppSdkVersion()}),up(op.End,ap.AppLoadedMessageProcessTime),Ir})}onNotifySuccessCalled(e,t){var n,r;return c(this,void 0,void 0,function*(){return this.markInitializationStatusAsReported()?(this.appSdkHost.setAppInitInfo({state:Yn.Loaded,appSdkVersion:null===(n=this.telemetryService)||void 0===n?void 0:n.getAppSdkVersion()}),(this.isLoadingScreenApp()||this.usingCachedApp)&&(sf().createAndSendSignalsToSubstrate&&Rp(this.appSdkHost,this.hubServices,this.telemetryService),this.telemetryService.setAppSdkVersion(t),this.updateAppInitializationScenarioFields(t,e),up(op.End,ap.SuccessMessageProcessTime),this.stopAppInitializationScenario()),null===(r=this.extendedAppInitializationScenario)||void 0===r||r.stop(),Ar([null])):Ar([null])})}onNotifyFailureCalled(e,t,n){var r,i;return c(this,void 0,void 0,function*(){return this.markInitializationStatusAsReported()?(this.isShowLoadingIndicatorEnabled&&(up(op.End,ap.FailureMessageProcessTime),this.failAppInitializationScenario(t,n)),this.appSdkHost.setAppInitInfo({state:Yn.Failed,reason:t,appSdkVersion:null===(r=this.telemetryService)||void 0===r?void 0:r.getAppSdkVersion()}),null===(i=this.extendedAppInitializationScenario)||void 0===i||i.fail(t,n),Ir):Ir})}onNotifyExpectedFailureCalled(e,t,n){var r,i;return c(this,void 0,void 0,function*(){if(!this.markInitializationStatusAsReported())return Ir;this.appSdkHost.setAppInitInfo({state:Yn.Loaded,appSdkVersion:null===(r=this.telemetryService)||void 0===r?void 0:r.getAppSdkVersion()});const e="Expected."+t;return this.isShowLoadingIndicatorEnabled&&(up(op.End,ap.ExpectedFailureMessageProcessTime),this.failAppInitializationScenario(e,n)),null===(i=this.extendedAppInitializationScenario)||void 0===i||i.fail(e,n),Ir})}markInitializationStatusAsReported(){return this.initializationStatusReported?(this.cleanup(),!1):(this.initializationStatusReported=!0,!0)}readyToUnload(){return c(this,void 0,void 0,function*(){return this.appSdkHost.setAppInitInfo({state:Yn.Unloaded}),Ir})}cleanup(){this.stopInitializeStateTransitionTimer()}isTeamsCoreSupported(e){return!!this.isTeamsHub(e)||this.isLifeCycleImplemented()&&hf(this.appDefinition)}constructHubConfig(e){var t,n,r,i,o,a,s,l,c,u;return{apiVersion:4,hostVersionsInfo:this.getUpdatedHostVersionsInfo(),isNAAChannelRecommended:null!==(t=this.isNAAChannelRecommended)&&void 0!==t&&t,supports:{app:{notifySuccessResponse:{}},appInstallDialog:this.hubServices.appInstallDialogService?{}:void 0,appEntity:this.hubServices.appEntityService?{}:void 0,barCode:this.hubServices.barCodeService?{}:void 0,calendar:this.hubServices.calendarService?{}:void 0,call:this.hubServices.callService?{}:void 0,chat:this.hubServices.chatService?{}:void 0,clipboard:navigator&&navigator.clipboard?{}:void 0,conversations:this.hubServices.conversationsService?{}:void 0,copilot:hf(this.appDefinition)&&this.hubServices.copilotService?{eligibility:this.hubServices.copilotService.eligibilityService?{}:void 0}:void 0,dialog:this.hubServices.dialogService?{url:this.hubServices.dialogService.urlService?{bot:this.hubServices.dialogService.urlService.urlBotService?{}:void 0,parentCommunication:this.hubServices.dialogService.urlService.parentCommunicationService?{}:void 0}:void 0,card:this.hubServices.dialogService.cardService&&this.hostVersionsInfo&&this.hostVersionsInfo.adaptiveCardSchemaVersion&&!Qf(this.hostVersionsInfo.adaptiveCardSchemaVersion)?{bot:this.hubServices.dialogService.cardService.cardBotService?{}:void 0}:void 0,update:this.hubServices.dialogService.updateService?{}:void 0}:void 0,externalAppAuthentication:this.hubServices.externalAppChannelService&&this.hubServices.externalAppInfoService?{}:void 0,externalAppAuthenticationForCEA:this.hubServices.externalAppChannelForCEAService&&this.hubServices.externalAppInfoService?{}:void 0,externalAppCardActions:this.hubServices.externalAppCardActionsService&&this.hubServices.externalAppInfoService?{}:void 0,externalAppCardActionsForCEA:this.hubServices.externalAppCardActionsForCEAService&&this.hubServices.externalAppInfoService?{}:void 0,externalAppCommands:this.hubServices.externalAppCommandsService&&this.hubServices.externalAppInfoService?{}:void 0,files:this.hubServices.filesService?{}:void 0,geoLocation:this.hubServices.locationService?{map:this.hubServices.locationService.mapService?{}:void 0}:void 0,hostEntity:{tab:(null===(n=this.hubServices.hostEntityService)||void 0===n?void 0:n.tabService)?{}:void 0},interactive:this.hubServices.interactiveService?{}:void 0,location:this.hubServices.locationService&&this.hubServices.locationService.mapService?{}:void 0,logs:this.hubServices.logService?{}:void 0,mail:this.hubServices.mailService?{}:void 0,marketplace:this.hubServices.marketplaceService?{}:void 0,media:this.hubServices.mediaService?{}:void 0,meeting:this.hubServices.meetingService?{appShareButton:this.hubServices.meetingService.appShareButton?{}:void 0}:void 0,meetingRoom:this.hubServices.meetingRoomService?{}:void 0,messageChannels:this.hubServices.messageChannelsService?{telemetry:this.hubServices.messageChannelsService.telemetry,dataLayer:this.hubServices.messageChannelsService.dataLayer}:void 0,monetization:this.hubServices.monetizationService?{}:void 0,nestedAppAuth:this.hubServices.nestedAppAuthService?{}:void 0,notifications:this.hubServices.notificationService?{}:void 0,otherAppStateChange:this.hubServices.otherAppStateChangeService?{}:void 0,pages:{appButton:(null===(r=this.hubServices.pageService)||void 0===r?void 0:r.appButtonService)?{}:void 0,backStack:(null===(i=this.hubServices.pageService)||void 0===i?void 0:i.backStackService)?{}:void 0,config:(null===(o=this.hubServices.pageService)||void 0===o?void 0:o.configService)?{}:void 0,fullTrust:(null===(a=this.hubServices.pageService)||void 0===a?void 0:a.fullTrustService)?{}:void 0,tabs:(null===(s=this.hubServices.pageService)||void 0===s?void 0:s.tabsService)?{}:void 0,currentApp:{}},people:this.hubServices.peopleService?{}:void 0,permissions:this.hubServices.devicePermissionService?{}:void 0,profile:this.hubServices.profileService?{}:void 0,remoteCamera:this.hubServices.remoteCameraService?{}:void 0,search:this.hubServices.searchService?{}:void 0,sharing:this.hubServices.sharingService?{history:this.hubServices.sharingService.historyService?{}:void 0}:void 0,stageView:this.hubServices.stageViewService?{self:this.hubServices.stageViewService.selfService?{}:void 0}:void 0,store:this.hubServices.storeService?{}:void 0,teams:this.hubServices.teamsService?{fullTrust:(null===(l=this.hubServices.teamsService)||void 0===l?void 0:l.fullTrustService)?{joinedTeams:(null===(u=null===(c=this.hubServices.teamsService)||void 0===c?void 0:c.fullTrustService)||void 0===u?void 0:u.joinedTeamsService)?{}:void 0}:void 0}:void 0,teamsCore:this.isTeamsCoreSupported(e.name)?{}:void 0,thirdPartyCloudStorage:this.hubServices.thirdPartyCloudStorageService?{}:void 0,video:this.hubServices.videoExtensibilityService&&(this.hubServices.videoExtensibilityService.mediaStreamService||this.hubServices.videoExtensibilityService.sharedFrameService)?{mediaStream:this.hubServices.videoExtensibilityService.mediaStreamService?{}:void 0,sharedFrame:this.hubServices.videoExtensibilityService.sharedFrameService?{}:void 0}:void 0,webStorage:this.hubServices.webStorageService?{}:void 0}}}onInitializeCallTimedOutForImmediateApp(){var e,t,n;this.failAppInitializationScenario("SDK initialization timed out"),null===(e=this.extendedAppInitializationScenario)||void 0===e||e.fail("SDK initialization timed out"),this.appSdkHost.setAppInitInfo({state:Yn.Failed,reason:Pn.AppInitTimeout,appSdkVersion:null===(t=this.telemetryService)||void 0===t?void 0:t.getAppSdkVersion()}),null===(n=this.hubServices.logger)||void 0===n||n.log(z.Error,"Error Bubble Reason",Dp+this.getOCDIWarning())}onInitializeCallTimedOutForLoadingScreenApp(){var e,t,n,r;this.appInitializationScenarioAlreadyStopped?(this.recordInitializationDoubleStopAttempt(Mp.initialAppInitializationTimerExpiration),this.appSdkHost.setAppInitInfo({state:Yn.Loaded,appSdkVersion:null===(e=this.telemetryService)||void 0===e?void 0:e.getAppSdkVersion()})):(this.failAppInitializationScenario(Hp),null===(t=this.extendedAppInitializationScenario)||void 0===t||t.fail(Hp),this.appSdkHost.setAppInitInfo({state:Yn.Failed,reason:Pn.AppInitTimeout,appSdkVersion:null===(n=this.telemetryService)||void 0===n?void 0:n.getAppSdkVersion()})),null===(r=this.hubServices.logger)||void 0===r||r.log(z.Error,"Error Screen Reason",Dp+this.getOCDIWarning())}isTeamsHub(e){return e===Qd.teams||e===Qd.teamsModern}isLifeCycleImplemented(){return!!this.hubServices.lifecycleService}logTelemetryForAppSdkLoaded(){var e,t,n;if(Df(null===(e=this.appDefinition)||void 0===e?void 0:e.id)){const e=null===(t=this.telemetryService)||void 0===t?void 0:t.createScenario(_d);null===(n=e.addOrUpdateActivityDataField)||void 0===n||n.call(e,dp.WEB_CONTENT_SDK_ID,this.appSdkHost.getWebContentSdkId()),e.stop()}}}const zp={dependentHubServiceSelector:e=>e.appEntityService,messageHandlerFactory:(e,t,n)=>new jp(e,n,t)};class jp extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.appEntityService=n}initHandlers(){this.registerHandler(se,(e,t,n,r)=>c(this,void 0,void 0,function*(){const e=yield this.appEntityService.selectAppEntity(t,n,r);return Ar([null,e])}),{errorCallback:(e,t)=>yr(se,e,t),isRestrictedToFullTrustApps:!0})}}const $p={dependentHubServiceSelector:e=>e.appInstallDialogService,messageHandlerFactory:(e,t,n)=>new Wp(e,n,t)};class Wp extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.appInstallDialogService=n}initHandlers(){this.registerHandler(te,(e,t)=>Tr(this.appInstallDialogService.openAppInstallDialog,t),{errorCallback:(e,t)=>yr(te,e,t)})}}class qp{constructor(e){this.appInstallDialogService=e}tryGetDataFromLink(e){if(!this.appInstallDialogService)return null;if(e.origin!=jf)return null;const t=e.pathname.match(qp.APP_INSTALL_DIALOG_URL_REGEX);return t?{appId:t[1]}:null}executeData(e){return this.appInstallDialogService.openAppInstallDialog(e)}}qp.APP_INSTALL_DIALOG_URL_REGEX=/^\/l\/app\/([^\/]+)\/?$/;const Vp="{authId}",Gp="authId",Kp="result",Xp=(()=>{const e={};return{startNewExternalAuthSession:(t,n,r)=>{const i=(e=>{const t=new URL(e).searchParams.get(Gp);return t&&t!==Vp?t:Kd()})(t);return t=t.replace("{oauthRedirectMethod}","deeplink").replace(Vp,i).replace("{hostRedirectUrl}",r?((e,t)=>{const n=new URL(e);n.searchParams.delete(Gp),n.searchParams.delete(Kp);const r=decodeURIComponent(n.searchParams.toString()),i=""===r.trim();n.search="";const o=`${r}${i?"":"&"}`;return encodeURIComponent(`${n.toString()}?${o}${Gp}=${t}&${Kp}={result}`)})(r,i):""),e[i]={handler:n,url:t,timeoutId:window.setTimeout(()=>{n(!1,"OAuth session timeout"),delete e[i]},12e4)},new URL(t)},completeAuth:(t,n)=>{if("string"==typeof t&&"string"==typeof n){const r=e[t];if(r){window.clearTimeout(r.timeoutId);const i=RegExp("^[-a-zA-Z0-9._~+/=]+$");n.length>4096?r.handler(!1,$n):i.test(n)?r.handler(!0,n):r.handler(!1,Wn),delete e[t]}}}}})();class Qp extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.authenticationService=n,this.TAG="BaseAuthenticationMessageHandler"}initHandlers(){this.registerHandler(re,this.handleGetUser,{errorCallback:this.onGetUserError,isRestrictedToMicrosoftOwnedOrFullTrustApps:!0}),this.registerHandler(ne,this.handleGetAuthToken,{callbackFixedArgsLength:5,errorCallback:this.onGetAuthTokenError})}validateDependencies(){this.appSdkHost.getContext().app.host.clientType!==ef.desktop||this.authenticationService.externalAuthService||this.appSdkHost.getLogger().log(z.Warn,this.TAG,qn)}handleGetUser(){return c(this,void 0,void 0,function*(){let e=yield this.authenticationService.getUser();if(e){let t=yield this.appSdkHost.getAppContext(),n=Object.assign(Object.assign({},e.profile),{dataResidency:Jf(t.user.dataResidency)});return Ar([!0,n])}return Promise.reject("Failed to fetch the user profile")})}onGetUserError(e,t){return null==t||t.fail(`GetUser failed ${Rr(e)}`),Ar([!1,e])}handleGetAuthToken(e,t,n,r,i,o){var a;return c(this,void 0,void 0,function*(){const s=yield this.appSdkHost.getAppContext();let l;try{l=yield vf(e.origin,t,this.appSdkHost.getHubInfo(),this.appDefinition,s)}catch(t){throw null===(a=null==o?void 0:o.addDetails)||void 0===a||a.call(o,{invalidResource:e.origin}),t}let c=yield this.authenticationService.acquireToken(l[0],n,r,i);return Ar([!0,c.token])})}onGetAuthTokenError(e,t){return null==t||t.fail(`GetAuthToken failed ${Rr(e)}`),Ar([!1,e])}}class Jp extends Qp{constructor(e,t,n){super(e,t,n),this.appAuthSdkHost=e,this.telemetryService=t,this.authenticationService=n}initHandlers(){super.initHandlers(),this.registerHandler(oe,this.handleNotifySuccess),this.registerHandler(ae,this.handleNotifyFailure)}handleNotifySuccess(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),Tr(this.authenticationService.notifySuccess,t)}handleNotifyFailure(e,t){return this.appAuthSdkHost.closeWindow(),this.appAuthSdkHost.stopAuthWindowMonitor(),Tr(this.authenticationService.notifyFailure,t,ih.Other)}}const Yp=e=>{if(null==e||null===typeof e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e)return e;if(Array.isArray(e))return e.map(e=>Yp(e));if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return"function"==typeof structuredClone?structuredClone(e):e.slice(0);if("object"==typeof e){const n={};for(var t of Object.getOwnPropertyNames(e)){const r=e[t];n[t]=Yp(r)}return n}throw Error("Provided type '"+typeof e+"' ("+Object.prototype.toString.call(e)+") can't be cloned using deepCopy.")};class Zp{constructor(e){this.appSdkHost=e,this.messageHandlers=[],this.TAG="BaseMessageProcessor",this.ValidCustomApiHubs=[Qd.teams,Qd.teamsModern,Qd.orange,Qd.edge]}process(e){var t,n;return c(this,void 0,void 0,function*(){try{if(e.isDeeplyNestedRequest)throw new Error("Access denied: Request from a nested iframe is not allowed");const{result:n,message:r}=yield this.callMessageHandlerHelper(e);if(n)return"appResponse"===n.kind&&this.processHandlerResultHelper(r,n,e),Promise.resolve(!0);if((null===(t=this.appSdkHost.getAppDefinition())||void 0===t?void 0:t.isMicrosoftOwned)&&this.ValidCustomApiHubs.includes(this.appSdkHost.getHubInfo().name)){const t=yield this.tryCustomProcessing(r);if(t.processed){const n=yield Ar(t.data);return"appResponse"===n.kind&&this.processHandlerResultHelper(r,n,e),Promise.resolve(!0)}}throw Error("Unhandled message")}catch(t){this.appSdkHost.getLogger().log(z.Error,this.TAG,`Error in processing request: ${null===(n=e.data)||void 0===n?void 0:n.func}`,t)}return Promise.resolve(!1)})}processForDeeplyNestedRequest(e){var t;return c(this,void 0,void 0,function*(){try{if(!e.isDeeplyNestedRequest)throw new Error("Access denied: Request from a main/top iframe is not allowed");if(!hr.has(e.data.func))throw new Error(`Access denied: message func "${e.data.func}" is not allowed for requests from a nested iframe.`);const{result:t,message:n}=yield this.callMessageHandlerHelper(e);if(t)return"appResponse"===t.kind&&this.processHandlerResultHelper(n,t,e,!0),Promise.resolve(!0);throw Error("Unhandled message")}catch(n){this.appSdkHost.getLogger().log(z.Error,this.TAG,`Error in processing deeply nested request: ${null===(t=e.data)||void 0===t?void 0:t.func}`,n)}return Promise.resolve(!1)})}callMessageHandlerHelper(e){return c(this,void 0,void 0,function*(){const t=uf(e.origin,this.appSdkHost.getLogger(),this.appSdkHost.getAppDefinition(),this.appSdkHost.getContext());e.isTrustedOrigin=t,this.appSdkHost.getLogger().log(z.Info,this.TAG,`Function name: ${e.data.func}, Args: ${e.data.args}, Version_APIName: ${e.data.apiVersionTag}`);const n=e.data,r=rf(n);let i=r.args,o=r.apiVersionTag;return i=r.args&&Array.isArray(r.args)?r.args.map(e=>{return t=e,"function"==typeof structuredClone?structuredClone(t):Yp(t);var t}):[],i.unshift(e),{result:yield this.callMessageHandler(o,r.func,i,rp(r.monotonicTimestamp,r.timestamp)),message:r}})}callMessageHandler(e,t,n,r){for(const i of this.messageHandlers)if(i.canHandleMessage(t))return i.handleMessage(e,t,n,r);return Promise.resolve(void 0)}tryCustomProcessing(e){return Promise.resolve({processed:!1,data:void 0})}processHandlerResultHelper(e,t,n,r=!1){let i=[];if(void 0!==t.data&&(i=Array.isArray(t.data)?t.data:[t.data]),r){const t={source:n.source,origin:n.origin,func:e.func};this.appSdkHost.postDeeplyNestedResponseToApp(e,t,i)}else this.appSdkHost.postResponseToApp(e,i)}cleanup(){this.messageHandlers.forEach(e=>e.cleanup())}}class eh extends Zp{constructor(e,t,n){super(e),this.appSdkHost=e,this.authService=t,this.telemetryService=n,this.messageHandlers.push(new Jp(e,n,t)),this.messageHandlers.push(new Up(e,{},n)),this.messageHandlers.forEach(e=>e.initHandlers())}}function th(e){let t="";return e.width&&e.height&&(t=`width=${e.width},height=${e.height}`,void 0!==e.left&&void 0!==e.top&&(t=`${t},left=${e.left},top=${e.top}`)),t}class nh{constructor(e,t,n,r,i,o){this.hostWindow=e,this.context=t,this.authenticationService=n,this.logger=r,this.customTelemetryService=i,this.onAppInitStateChanged=o,this.initialized=!1,this.webContentSdkId=(new Xd).toString(),this.initializeAuthenticationContext=e=>{var t;this.context=e,this.contextPromise=null===(t=this.authenticationService)||void 0===t?void 0:t.getUser().then(e=>{var t,n,r,i,o,a,s,l,c;const u=Object.assign(Object.assign({},null===(t=this.context)||void 0===t?void 0:t.user),{id:(null===(n=null==e?void 0:e.profile)||void 0===n?void 0:n.oid)||"",displayName:(null===(r=null==e?void 0:e.profile)||void 0===r?void 0:r.displayName)||"",loginHint:(null===(i=null==e?void 0:e.profile)||void 0===i?void 0:i.loginHint)||"",userPrincipalName:(null===(o=null==e?void 0:e.profile)||void 0===o?void 0:o.upn)||"",tenant:{id:(null===(a=null==e?void 0:e.profile)||void 0===a?void 0:a.tid)||"",sku:null===(c=null===(l=null===(s=this.context)||void 0===s?void 0:s.user)||void 0===l?void 0:l.tenant)||void 0===c?void 0:c.sku}}),d=Object.assign(Object.assign({},this.context.app),{userClickTime:this.getUserClickTime()}),f=Object.assign(Object.assign({},this.context),{app:d,user:u});return this.telemetryService.setAppContext(f),f})},this.getContext=()=>this.context,this.getAppContext=()=>this.contextPromise?this.contextPromise.then(e=>e).catch(()=>this.context):Promise.resolve(this.context),this.getAppDefinition=()=>this.appDefinition,this.checkIfCachedAndRequestAllowed=e=>!0,this.setAppInitInfo=e=>{this.onAppInitStateChanged&&this.onAppInitStateChanged(e)},this.getLogger=()=>this.logger,this.telemetryService=new dp(this.getHubInfo(),t,this.customTelemetryService),this.context.app.userClickTime&&(this.userClickTime=this.context.app.userClickTime),this.context.app.userClickTimeV2&&(this.userClickTimeV2=this.context.app.userClickTimeV2)}getTelemetryService(){return this.telemetryService}getWebContentSdkId(){return this.webContentSdkId}isInitialized(){return this.initialized}setInitialized(e){this.initialized=e}getHubInfo(){return{name:this.context.app.host.name,version:this.context.app.host.version,clientType:this.context.app.host.clientType,sessionId:this.context.app.host.sessionId}}createTelemetryScenarioForAppTermination(e,t){var n,r;const i=this.telemetryService.createScenario("appTermination",e.id);null===(n=i.addOrUpdateActivityDataField)||void 0===n||n.call(i,dp.APP_TERMINATE_REASON,t),null===(r=i.addOrUpdateActivityDataField)||void 0===r||r.call(i,dp.WEB_CONTENT_SDK_ID,this.webContentSdkId),i.stop()}createTelemetryScenarioForUnloadSdk(e){var t,n,r;const i=this.telemetryService.createScenario("sdkUnload",null===(t=this.appDefinition)||void 0===t?void 0:t.id);null===(n=i.addOrUpdateActivityDataField)||void 0===n||n.call(i,dp.WEB_CONTENT_SDK_ID,this.webContentSdkId),null===(r=i.addOrUpdateActivityDataField)||void 0===r||r.call(i,dp.COMM_BRIDGE_ID,(null==e?void 0:e.toString())||"unknown"),i.stop()}createTelemetryScenarioForWebContentSdkCreated(e,t){var n,r,i;const o=this.telemetryService.createScenario("webContentSdkCreated");null===(n=o.addOrUpdateActivityDataField)||void 0===n||n.call(o,dp.WEB_CONTENT_SDK_ID,this.webContentSdkId),null===(r=o.addOrUpdateActivityDataField)||void 0===r||r.call(o,dp.COMM_BRIDGE_ID,(null==t?void 0:t.toString())||"unknown"),null===(i=o.addOrUpdateActivityDataField)||void 0===i||i.call(o,dp.COMM_BRIDGE_LISTENERS_ADDED,e),o.stop()}createTelemetryScenarioForSetFrameAndLoadOrigin(e,t,n,r,i,o){var a,s,l,c,u,d,f,p;const h=null===(a=this.telemetryService)||void 0===a?void 0:a.createScenario("setFrameAndLoadOrigin");null===(s=h.addOrUpdateActivityDataField)||void 0===s||s.call(h,dp.WEB_CONTENT_SDK_ID,this.webContentSdkId),null===(l=h.addOrUpdateActivityDataField)||void 0===l||l.call(h,dp.COMM_BRIDGE_ID,(null==o?void 0:o.toString())||"unknown"),null===(c=h.addOrUpdateActivityDataField)||void 0===c||c.call(h,dp.COMM_BRIDGE_LISTENERS_ADDED,e),null===(u=h.addOrUpdateActivityDataField)||void 0===u||u.call(h,dp.APP_DEFINITION,JSON.stringify(t)),null===(d=h.addOrUpdateActivityDataField)||void 0===d||d.call(h,dp.CACHEDAPP_IND_FIELD_NAME,!!r),null===(f=h.addOrUpdateActivityDataField)||void 0===f||f.call(h,dp.USER_CLICK_TIME,n),i&&(null===(p=h.addOrUpdateActivityDataField)||void 0===p||p.call(h,dp.USER_CLICK_TIME_V2,i)),h.stop()}getHostWindow(){return this.hostWindow}getFrameContext(){return this.context.page.frameContext}getUserClickTime(){return this.userClickTime}setUserClickTime(e){this.userClickTime=e}getUserClickTimeV2(){return this.userClickTimeV2}setUserClickTimeV2(e){this.userClickTimeV2=e}startAppInitializationScenario(){var e,t,n;const r=rp(this.getUserClickTimeV2(),this.getUserClickTime());this.appInitializationScenario=null===(e=this.telemetryService)||void 0===e?void 0:e.createScenario("appInitialization",void 0,r.value,void 0,r.type),null===(n=(t=this.appInitializationScenario).addOrUpdateActivityDataField)||void 0===n||n.call(t,dp.WEB_CONTENT_SDK_ID,this.webContentSdkId)}getAppInitializationScenario(){return this.appInitializationScenario}}const rh="HostedWebContentAuthSdkService";var ih;!function(e){e.AppDefinitionUnavailable="AppDefinitionUnavailable",e.BlockedByBrowser="BlockedByBrowser",e.CancelledByUser="CancelledByUser",e.InvalidAuthUrl="InvalidAuthUrl",e.InvalidFrameContext="InvalidFrameContext",e.Other="Other"}(ih||(ih={}));class oh extends Error{constructor(e,t){super(e),this.failureReason=t,this.name="HostedWebContentAuthSdkServiceInternalError"}}class ah extends nh{constructor(e,t,n,r,i,o,a,s){super(e,i,r,o,a,void 0),this.hostWindow=e,this.openWindowInfo=t,this.appDefinition=n,this.authenticationService=r,this.context=i,this.logger=o,this.onExternalAuthenticationComplete=(e,t)=>{e?this.authenticationService.notifySuccess(t):(t!==$n&&t!==Wn||this.logger.log(z.Error,rh,t),this.authenticationService.notifyFailure(t))},this.onAuthMessageReceived=e=>c(this,void 0,void 0,function*(){if(!this.authWindow||this.authWindow!==e.source)return;const t=e.origin;t!==this.origin&&this.checkUrlIsValid(t)&&(this.origin=e.origin),this.origin===t&&this.messageProcessor&&(yield this.messageProcessor.process(Or(e,!1)))}),this.setupAuthMessageHandlers=()=>{this.authenticationService&&(this.messageProcessor=new eh(this,this.authenticationService,this.telemetryService))};try{this.passContextForUrlValidation=sf().authExtensionContextForUrlValidation,this.context.app.host.clientType!==ef.desktop||this.authenticationService.externalAuthService||this.logger.log(z.Warn,rh,qn),this.context.page.frameContext!==tf.authentication&&this.notifyAsFailureAndThrowError("Invalid frame context for scenario",ih.InvalidFrameContext),this.appDefinition||this.notifyAsFailureAndThrowError("App definition not available",ih.AppDefinitionUnavailable),this.telemetryService.setAppDefinition(this.appDefinition),this.checkUrlIsValid(t.url)||this.notifyAsFailureAndThrowError("Auth url is not valid",ih.InvalidAuthUrl),this.shouldUseExternalAuthenticationWorkflow(i.app.host.clientType,s)?this.launchExternalAuthenticationWorkflow(t.url):this.launchEmbeddedAuthenticationWorkflow(i,t)}catch(e){let t,n="",r=!1;if(e instanceof oh?(n=e.message,t=e.failureReason,r=!1):e instanceof Error?(n=e.message,t=ih.Other,r=!1):(n="Unknown error",t=ih.Other,r=!0),this.authenticationService&&this.authenticationService.notifyFailure(n,t),o.log(z.Error,rh,`Error in constructor: ${n}, failure reason: ${t}`),r)throw e}}launchEmbeddedAuthenticationWorkflow(e,t){const n=th(t);if(e.app.host.clientType===ef.desktop&&this.authenticationService.externalAuthService)try{this.authWindow=this.authenticationService.externalAuthService.openUrlInEmbeddedBrowser(new URL(t.url),n)}catch(e){null!==this.authWindow&&(this.logger.log(z.Error,rh,`openUrlInEmbeddedBrowser threw an error but still returned a non-null window object? Forcing window object to null. Error = ${e}`),this.authWindow=null)}else this.authWindow=this.hostWindow.open(t.url,"appAuthWindow",n);if(!this.authWindow)throw new oh("URL was unable to be opened in embedded browser",ih.BlockedByBrowser);this.setupEmbeddedAuthWindow(t.url,e,this.hostWindow)}launchExternalAuthenticationWorkflow(e){const t=Xp.startNewExternalAuthSession(e,this.onExternalAuthenticationComplete,this.authenticationService.externalAuthRedirectUrl);try{this.authenticationService.externalAuthService?this.authenticationService.externalAuthService.openUrlInExternalBrowser(t):this.hostWindow.open(t)}catch(e){throw new oh("Failed to open the URL in external browser",ih.Other)}}shouldUseExternalAuthenticationWorkflow(e,t){return e===ef.desktop&&!0===t}notifyAsFailureAndThrowError(e,t){throw this.authenticationService&&this.authenticationService.notifyFailure(e,t),new oh(`Failure message: ${e}, failure reason: ${t}`)}setupEmbeddedAuthWindow(e,t,n){var r;this.origin=e,this.setUserClickTime(null!==(r=t.app.userClickTime)&&void 0!==r?r:Date.now()),t.app.userClickTimeV2&&this.setUserClickTimeV2(t.app.userClickTimeV2),this.setupAuthMessageHandlers(),this.globalWindowEventListener=new X(n),this.globalWindowEventListener.addListener("message",this.onAuthMessageReceived),this.startAuthWindowMonitor(),this.initializeAuthenticationContext(t)}checkUrlIsValid(e){return this.passContextForUrlValidation?uf(e,this.logger,this.appDefinition,this.context):uf(e,this.logger,this.appDefinition)}getHostWindow(){return this.authWindow||null}postResponseToApp(e,t){this.sendResponseMessage(e,t)}postDeeplyNestedResponseToApp(){throw new Error("Auth window does not support nested request communication")}isWindowOpen(){return!!this.authWindow&&!this.authWindow.closed}closeWindow(){this.unloadApp(this.appDefinition)}sendResponseMessage(e,t){var n;if(this.origin){const r={id:e.id,uuidAsString:null===(n=e.uuid)||void 0===n?void 0:n.toString(),args:t,origin:this.origin,monotonicTimestamp:np()};this.postMessage(r)}}sendRequestMessage(e,t){if(this.origin){const n={func:e,args:t,monotonicTimestamp:np()};this.postMessage(n)}}startAuthWindowMonitor(){this.stopAuthWindowMonitor(),this.authWindowMonitor=this.hostWindow.setInterval(()=>{this.authWindowInterval()},100)}authWindowInterval(){this.isWindowOpen()?this.sendRequestMessage("ping"):(this.HandleError("CancelledByUser",ih.CancelledByUser),this.closeWindow(),this.stopAuthWindowMonitor())}stopAuthWindowMonitor(){this.authWindowMonitor&&(this.hostWindow.clearInterval(this.authWindowMonitor),this.authWindowMonitor=void 0)}unloadApp(e){var t;this.unloadSDK(),null===(t=this.authWindow)||void 0===t||t.close()}unloadSDK(){this.globalWindowEventListener&&this.globalWindowEventListener.removeListener("message")}postMessage(e){var t;this.origin&&(null===(t=this.authWindow)||void 0===t||t.postMessage(e,this.origin))}HandleError(e,t){this.authenticationService&&this.authenticationService.notifyFailure(e,t)}}const sh={dependentHubServiceSelector:e=>e.authenticationService,messageHandlerFactory:(e,t,n)=>new lh(e,t,n)};class lh extends Qp{constructor(e,t,n,r){super(e,n,t),this.appSdkHost=e,this.authenticationService=t,this.telemetryService=n,this.TAG="AuthenticationMessageHandler",this.hostedWebContentAuthSdkServiceFactory=null!=r?r:(e,t,n,r,i,o,a,s)=>new ah(e,t,n,r,i,o,a,s)}initHandlers(){super.initHandlers(),this.registerHandler(ie,this.handleAuthenticate,{callbackFixedArgsLength:5,errorCallback:this.onAuthenticateError}),this.authenticationService.addEventListener("onExternalAuthDeeplink",e=>Xp.completeAuth(e.data.authId,e.data.result))}handleAuthenticate(e,t,n,r,i,o){return c(this,void 0,void 0,function*(){if(null==o||o.addOrUpdateActivityDataField(Kn,i&&i?"true":"false"),this.appDefinition){const a=rf(e.data),s=Pr(a),l={getUser:()=>this.authenticationService.getUser(),acquireToken:(e,t,n,r)=>this.authenticationService.acquireToken(e,t,n,r),notifySuccess:e=>c(this,void 0,void 0,function*(){null==o||o.stop(),this.appSdkHost.postResponseToApp(a,[!0,e]),this.appSdkHost.getLogger().log(z.Debug,this.TAG,`notifySuccess func: ${s}`)}),notifyFailure:e=>c(this,void 0,void 0,function*(){null==o||o.fail(e),this.appSdkHost.postResponseToApp(a,[!1,e]),this.appSdkHost.getLogger().log(z.Debug,this.TAG,`notifyFailure func: ${s}`)}),externalAuthRedirectUrl:this.authenticationService.externalAuthRedirectUrl,addEventListener:()=>{},clearListeners:()=>{},externalAuthService:this.authenticationService.externalAuthService},u=Object.assign(Object.assign({},this.appSdkHost.getContext()),{app:Object.assign(Object.assign({},this.appSdkHost.getContext().app),{sessionId:Kd(),userClickTime:Date.now(),userClickTimeV2:np()}),page:Object.assign(Object.assign({},this.appSdkHost.getContext().page),{frameContext:tf.authentication})});this.hostedWebContentAuthSdkServiceFactory(this.appSdkHost.getHostWindow(),{url:t,width:n,height:r},this.appDefinition,l,u,this.appSdkHost.getLogger(),void 0,i)}return Ir})}onAuthenticateError(e,t){return null==t||t.fail(`Authenticate failed ${Rr(e)}`),Ar([!1,e])}}const ch={dependentHubServiceSelector:e=>e.barCodeService&&e.devicePermissionService?{barCodeService:e.barCodeService,permissionsService:e.devicePermissionService}:void 0,messageHandlerFactory:(e,t,n)=>new uh(e,n,t.permissionsService,t.barCodeService)};class uh extends Np{constructor(e,t,n,r){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.permissionsService=n,this.barCodeService=r}initHandlers(){this.registerHandler(le,(e,t)=>this.checkPermissionsAndCallScanBarCode(t),{errorCallback:(e,t)=>yr(le,e,t)})}checkPermissionsAndCallScanBarCode(e){return c(this,void 0,void 0,function*(){return yield xr(this.permissionsService,dr.Media),kr(e,this.barCodeService.scanBarCode)})}}const dh={dependentHubServiceSelector:e=>e.calendarService,messageHandlerFactory:(e,t,n)=>new fh(e,n,t)};class fh extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.calendarService=n}initHandlers(){this.registerHandler(ue,(e,t)=>c(this,void 0,void 0,function*(){return yield this.calendarService.openCalendarItem(t),Ar([!0])}),{errorCallback:(e,t)=>Sr(ue,e,t)}),this.registerHandler(ce,(e,t)=>c(this,void 0,void 0,function*(){return yield this.calendarService.composeMeeting(t),Ar([!0])}),{errorCallback:(e,t)=>Sr(ce,e,t)})}validateDependencies(){if(!this.calendarService)throw"No calendarService provided"}}class ph{constructor(e){this.calendarService=e}tryGetDataFromLink(e){var t;return this.calendarService?e.origin!=jf||"/l/meeting/new"!=e.pathname?null:{attendees:null===(t=e.searchParams.get("attendees"))||void 0===t?void 0:t.split(","),startTime:e.searchParams.get("startTime")||void 0,endTime:e.searchParams.get("endTime")||void 0,subject:e.searchParams.get("subject")||void 0,content:e.searchParams.get("content")||void 0}:null}executeData(e){return this.calendarService.composeMeeting(e)}}var hh;!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(hh||(hh={}));const vh={dependentHubServiceSelector:e=>e.callService,messageHandlerFactory:(e,t,n)=>new gh(e,n,t)};class gh extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.callService=n}initHandlers(){this.registerHandler(de,(e,t)=>Cr(this.callService.startCall,t),{errorCallback:(e,t)=>yr(de,e,t)})}}class mh{constructor(e){this.callService=e}tryGetDataFromLink(e){var t;if(!this.callService)return null;if(e.origin!=jf||"/l/call/0/0"!=e.pathname)return null;const n=null===(t=e.searchParams.get("users"))||void 0===t?void 0:t.split(","),r="true"==e.searchParams.get("withVideo"),i=e.searchParams.get("source")||void 0;return n?{targets:n,requestedModalities:r?[hh.Audio,hh.Video]:[hh.Audio],source:i}:null}executeData(e){return this.callService.startCall(e).then(()=>{})}}const yh={dependentHubServiceSelector:e=>e.chatService,messageHandlerFactory:(e,t,n)=>new Sh(e,n,t)};class Sh extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.chatService=n}initHandlers(){this.registerHandler(fe,(e,t)=>c(this,void 0,void 0,function*(){return yield this.chatService.openChat(t),Ar(!0)}),{errorCallback:(e,t)=>Sr(fe,e,t)})}}class bh{constructor(e){this.chatService=e}tryGetDataFromLink(e){var t;if(!this.chatService)return null;if(e.origin!=jf||"/l/chat/0/0"!=e.pathname)return null;const n=null===(t=e.searchParams.get("users"))||void 0===t?void 0:t.split(",");return n?{members:n,topic:e.searchParams.get("topicName")||void 0,message:e.searchParams.get("message")||void 0}:null}executeData(e){return this.chatService.openChat(e)}}var wh=i(979);const kh={messageHandlerFactory:(e,t)=>new Eh(e,t)};class Eh extends Np{constructor(e,t){super(e,t),this.appSdkHost=e,this.telemetryService=t}initHandlers(){this.registerHandler(pe,this.writeDataToClipboard,{errorCallback:(e,t)=>yr(pe,e,t)}),this.registerHandler(he,this.readDataFromClipboard,{errorCallback:(e,t)=>yr(he,e,t)})}validateDependencies(){if(!navigator||!navigator.clipboard)throw"Current browser does not support clipboard API."}acquireTemporaryFocus(){this.initiallyFocusedElement=document.activeElement,this.tempTextArea=document.createElement("textarea"),this.tempTextArea.readOnly=!0,this.tempTextArea.tabIndex=-1,this.tempTextArea.style.opacity="0",this.tempTextArea.style.position="fixed",this.tempTextArea.style.right="-9999px",this.tempTextArea.style.bottom="-9999px",document.body.appendChild(this.tempTextArea),this.tempTextArea.focus()}releaseTemporaryFocus(){this.initiallyFocusedElement&&this.initiallyFocusedElement.focus&&this.initiallyFocusedElement.focus(),this.tempTextArea&&document.body.removeChild(this.tempTextArea)}writeDataToClipboard(e,t){return c(this,void 0,void 0,function*(){if(!t.content||!t.mimeType)throw br(Zn.INVALID_ARGUMENTS,"Clipboard content or mime type cannot be empty.");if(!Object.values(nf).includes(t.mimeType))throw br(Zn.INVALID_ARGUMENTS,`Mime type ${t.mimeType} is not supported. Supported mime types are ${Object.values(nf)}`);try{let e=yield this.base64ToBlob(t.mimeType,t.content);this.acquireTemporaryFocus(),t.mimeType.startsWith("image/")&&(e=yield this.convertImageBlobToPngBlob(e)),yield navigator.clipboard.write([new ClipboardItem({[e.type]:e})])}catch(e){throw br(Zn.INTERNAL_ERROR,`Failed to copy to clipboard. ${e}`)}finally{this.releaseTemporaryFocus()}return Ar([null])})}readDataFromClipboard(){return c(this,void 0,void 0,function*(){try{let e;if(this.acquireTemporaryFocus(),"denied"===(yield navigator.permissions.query({name:"clipboard-read"})).state)throw br(Zn.PERMISSION_DENIED,"Not allowed to read clipboard.");const t=yield navigator.clipboard.read();if(e=yield t[0].getType(t[0].types[0]),(yield this.appSdkHost.getAppContext()).app.host.clientType===ef.desktop){const t={content:yield this.getBase64StringFromBlob(e),mimeType:e.type};return Ar([null,JSON.stringify(t)])}return Ar([null,e])}catch(e){throw Er(e)?e:br(Zn.INTERNAL_ERROR,e)}finally{this.releaseTemporaryFocus()}})}getBase64StringFromBlob(e){return new Promise((t,n)=>{0===e.size&&n(new Error("Blob cannot be empty."));const r=new FileReader;r.onloadend=()=>{r.result?t(r.result.toString().split(",")[1]):n(new Error("Failed to read the blob"))},r.onerror=()=>{n(r.error)},r.readAsDataURL(e)})}createImageElement(e){return c(this,void 0,void 0,function*(){return new Promise((t,n)=>{const r=document.createElement("img");r.crossOrigin="anonymous",r.src=e,r.onload=e=>{const n=e.target;n.focus(),t(n)},r.onabort=n,r.onerror=n})})}getBlobFromImageElement(e){return c(this,void 0,void 0,function*(){return new Promise((t,n)=>{const r=document.createElement("canvas"),i=r.getContext("2d");if(i){const{width:o,height:a}=e;r.width=o,r.height=a,i.drawImage(e,0,0,o,a),r.toBlob(e=>{e?t(e):n("Cannot get blob from image element")},"image/png",1)}})})}convertImageBlobToPngBlob(e){return c(this,void 0,void 0,function*(){const t=URL.createObjectURL(e),n=yield this.createImageElement(t);return yield this.getBlobFromImageElement(n)})}base64ToBlob(e,t){return new Promise((n,r)=>{if(e||r("MimeType cannot be null or empty."),t||r("Base64 string cannot be null or empty."),e.startsWith("image/")){const r=atob(t),i=new Uint8Array(r.length);for(let e=0;e<r.length;e++)i[e]=r.charCodeAt(e);n(new Blob([i],{type:e}))}else{const r=wh.hp.from(t,"base64").toString();n(new Blob([r],{type:e}))}})}}const Ah={dependentHubServiceSelector:e=>e.conversationsService,messageHandlerFactory:(e,t,n)=>new Ch(e,n,t)};class Ch extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.conversationsService=n}initHandlers(){this.registerHandler(ve,(e,t)=>(this.conversationsService.clearListeners(),this.conversationsService.addEventListener("startConversation",e=>this.appSdkHost.sendRequestMessage("startConversation",e.data?[e.data.subEntityId,e.data.conversationId,e.data.channelId,e.data.entityId]:[])),this.conversationsService.addEventListener("closeConversation",e=>this.appSdkHost.sendRequestMessage("closeConversation",e.data?[e.data.subEntityId,e.data.conversationId,e.data.channelId,e.data.entityId]:[])),Cr(this.conversationsService.openConversation,t)),{errorCallback:(e,t)=>Sr(rt,e,t)}),this.registerHandler(ge,e=>(this.conversationsService.clearListeners(),Tr(this.conversationsService.closeConversation)),{}),this.registerHandler(me,e=>Cr(this.conversationsService.getChatMembers),{isRestrictedToFullTrustApps:!0})}}class Ih extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.copilotEligibilityService=n,this.getEligibility=()=>c(this,void 0,void 0,function*(){const e=yield this.copilotEligibilityService.getEligibilityInformation();return Ar(e)})}initHandlers(){this.registerHandler(ye.getEligibilityInfo,this.getEligibility,{errorCallback:(e,t)=>yr(ye.getEligibilityInfo,e,t)})}canHandleMessage(e){return super.canHandleMessage(e)&&hf(this.appDefinition)}validateDependencies(e){if(!this.copilotEligibilityService)throw new Error("No copilotEligibilityService provided")}}var Th,xh;!function(e){e.Large="large",e.Medium="medium",e.Small="small"}(Th||(Th={})),function(e){e.Card="card",e.Url="url"}(xh||(xh={}));const Rh="User cancelled/closed the task module.";class Oh extends Np{constructor(e,t,n,r){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.dialogService=n,this.hostVersionsInfo=r}initHandlers(){if(this.appSdkHost.getFrameContext()===tf.task&&!this.dialogService)throw new Error("DialogService needs to be provided for FrameContexts.task");this.registerHandler(be,(e,t,n)=>Tr(this.dialogService.urlService.submit,t,n)),this.appSdkHost.getFrameContext()===tf.task&&this.dialogService.urlService.parentCommunicationService.addEventListener("onMessageForChild",e=>{var t;const n=null===(t=this.telemetryService)||void 0===t?void 0:t.createScenario("eventDispatch.onMessageForChild",void 0,void 0,"unknown");null==n||n.stop(),Array.isArray(e.data)||(e.data=[e.data]),this.appSdkHost.sendRequestMessage("messageForChild",e.data?e.data:[])}),this.registerHandler(Se,(e,t)=>c(this,void 0,void 0,function*(){if(t.card&&t.url)return Ar(["Values for both card and url were specified. One or the other, but not both, are allowed."]);let e;if(t.card)return e=Object.assign(Object.assign({},t),{card:t.card,type:xh.Card}),"completionBotId"in e?this.callDialogWithBotAndAdaptiveCard(e):this.callDialogWithCardService(e);if(t.url){const n=yield this.appSdkHost.getAppContext(),r=this.appSdkHost.getLogger();try{if(!df(t.url,r,n,this.appDefinition))throw zn}catch(e){return r.log(z.Error,"DialogsMessageHandler",zn,null),Ar([zn])}return e=Object.assign(Object.assign({},t),{url:t.url,type:xh.Url}),"completionBotId"in e?this.callDialogWithUrlAndBotService(e):this.callDialogWithJustUrlService(e)}return Ar(["You must specify a value for either card or url."])})),this.registerHandler("messageForParent",(e,t)=>Tr(this.dialogService.urlService.parentCommunicationService.messageForParent,t)),this.registerHandler("messageForChild",(e,t)=>Tr(this.dialogService.urlService.parentCommunicationService.messageForChild,t))}validateDependencies(){if(!this.dialogService)throw"No dialogService provided";if(this.dialogService.cardService&&(!this.hostVersionsInfo||!this.hostVersionsInfo.adaptiveCardSchemaVersion||Qf(this.hostVersionsInfo.adaptiveCardSchemaVersion)))throw"dialogService.cardService requires that the host specifies an adaptive card version of at least 1.5"}callDialogWithBotAndAdaptiveCard(e){return c(this,void 0,void 0,function*(){try{if(this.dialogService.cardService.cardBotService){const t=yield this.dialogService.cardService.cardBotService.open(e);return Ar([null,t])}return Ar(["Bot Adaptive Card based Dialogs are not supported"])}catch(e){return Ar([Rh])}})}callDialogWithCardService(e){return c(this,void 0,void 0,function*(){try{if(this.dialogService.cardService){const t=yield this.dialogService.cardService.open(e);return Ar([null,t])}return Ar(["Adaptive Card based Dialogs are not supported"])}catch(e){return Ar([Rh])}})}callDialogWithUrlAndBotService(e){return this.dialogService.urlService.urlBotService?this.addRemoveEventListenerAndCreateSDKResponse(this.dialogService.urlService.urlBotService.open,e):Ar(["Dialogs with completionBotId are not supported"])}callDialogWithJustUrlService(e){return this.addRemoveEventListenerAndCreateSDKResponse(this.dialogService.urlService.open,e)}addRemoveEventListenerAndCreateSDKResponse(e,t){return c(this,void 0,void 0,function*(){try{this.dialogService.urlService.parentCommunicationService.clearListeners(),this.dialogService.urlService.parentCommunicationService.addEventListener("onMessageForParent",e=>{var t;const n=null===(t=this.telemetryService)||void 0===t?void 0:t.createScenario("eventDispatch.onMessageForParent",void 0,void 0,"unknown");null==n||n.stop(),Array.isArray(e.data)||(e.data=[e.data]),this.appSdkHost.sendRequestMessage("messageForParent",e.data?e.data:[])});var n=yield e(t);return Ar([null,n])}catch(e){return Ar([Rh])}finally{this.dialogService.urlService.parentCommunicationService.clearListeners()}})}}class Ph extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.dialogUpdateService=n}initHandlers(){this.registerHandler(we.resize,(e,t)=>Tr(this.dialogUpdateService.resize,t))}validateDependencies(){if(!this.dialogUpdateService)throw"No dialogUpdateService provided"}}var Nh,Fh,Bh,Lh;!function(e){e.ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",e.QueryMessageExtensionRequest="QueryMessageExtensionRequest"}(Nh||(Nh={})),function(e){e.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",e.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(Fh||(Fh={})),function(e){e.SSOToken="ssoToken",e.OAuthCode="oauthCode"}(Bh||(Bh={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(Lh||(Lh={}));const Dh="Action.Execute";function Hh(e,t=0){return!(t>1e3)&&(void 0===e||"boolean"==typeof e||"number"==typeof e||"bigint"==typeof e||"string"==typeof e||null===e||(Array.isArray(e)?e.every(e=>Hh(e,t+1)):!("object"!=typeof e||"[object Object]"!==Object.prototype.toString.call(e)||Object.getPrototypeOf(e)!==Object.prototype&&null!==Object.getPrototypeOf(e))&&Object.keys(e).every(n=>Hh(e[n],t+1))))}var _h,Mh;!function(e){e.DeepLinkDialog="DeepLinkDialog",e.DeepLinkOther="DeepLinkOther",e.DeepLinkStageView="DeepLinkStageView",e.GenericUrl="GenericUrl"}(_h||(_h={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.INVALID_LINK="INVALID_LINK",e.NOT_SUPPORTED="NOT_SUPPORTED"}(Mh||(Mh={}));class Uh{constructor(e,t){this.telemetryService=e,this.logger=t}createTelemetryScenario(e){return this.telemetryService.createScenario(e)}executeCapabilityFunction(e,t){return c(this,void 0,void 0,function*(){const n=this.createTelemetryScenario(Md[e.sdkMessageName]);try{const r=yield e.execute(t,n);return n.stop(),r}catch(t){this.logger.log(z.Error,`Error executing ${e.sdkMessageName}`,t),e.errorHandler&&(t=yield e.errorHandler(t,n));const r=function(e){return!!(function(e){return(null==e?void 0:e.errorCode)in er}(e)||function(e){return(null==e?void 0:e.errorCode)in Mh}(e)||function(e){return(null==e?void 0:e.errorCode)in Zn}(e)||function(e){return(null==e?void 0:e.errorCode)in Lh}(e))}(t)?Rr(t):vr.message;return n.fail(`${e.sdkMessageName} Api failed ${r}`),Promise.reject(t)}})}}class zh extends Uh{constructor(e,t,n,r,i,o,a){super(i,o),this.appSdkHost=e,this.authenticationService=t,this.externalAppInfoService=n,this.externalAppChannelService=r,this.telemetryService=i,this.logger=o,this.TAG="ExternalAppAuthenticationBaseExecutor",this.externalAppAuthenticationOAuthExecutorHelper=(e,t,n,r)=>c(this,void 0,void 0,function*(){const i=n.appId.toString();this.updateTelemetryScenario(r,n,i),this.validateAuthHandlerInput(i,"conversationId"in n?n.conversationId:void 0,"originalRequestInfo"in n?n.originalRequestInfo:void 0);const o=yield this.fetchAndValidateAppDefinition(e,i),a=yield this.createAppSdkContext();return this.executeOAuthFlow(t,n,r,o,a)}),this.externalAppAuthenticationSSOExecutorHelper=(e,t,n,r)=>c(this,void 0,void 0,function*(){const i=t.appId.toString();r.addOrUpdateActivityDataField(Gn,i),this.validateAuthHandlerInput(i,"conversationId"in t?t.conversationId:void 0,"originalRequestInfo"in t?t.originalRequestInfo:void 0);const o=yield this.getSSOToken(e,i,n,origin,t.claims,t.silent);return r.markPhase("InvokeToExternalAppAuthTokenAcquired"),{type:Bh.SSOToken,token:o}}),this.getSSOToken=(e,t,n,r,i,o)=>c(this,void 0,void 0,function*(){const a=yield this.getAppDefinition(t);this.validateAppDefinition(a,e,n);const s=yield this.appSdkHost.getContext(),l=yield vf(r,void 0,this.appSdkHost.getHubInfo(),a,s,!0,n);if(!l||0===l.length)throw wr("Validated resources must contain at least one item.");const c=yield this.authenticationService.acquireToken(l[0],i,o);return this.appSdkHost.getLogger().log(z.Debug,this.TAG,`AcquireToken returned successfully, authToken is ${null!==c?"not ":""} null`),c}),this.getAppDefinition=e=>c(this,void 0,void 0,function*(){var t,n;if(!(yield null===(t=this.externalAppInfoService)||void 0===t?void 0:t.isAppAllowed(e)))throw wr(`App with ID: ${e} has been blocked`);const r=yield null===(n=this.externalAppInfoService)||void 0===n?void 0:n.getAppDefinition(e);if(!r)throw wr(`Unable to retrieve AppDefinition for ${e}`);return r}),this.validateAppDefinition=(e,t,n)=>{"ME"===t?this.validateAppDefinitionForME(e,n):"CEA"===t&&this.validateAppDefinitionForCEA(e)},this.validateAppDefinitionForCEA=e=>{if(!yf(e))throw wr("customEngineAgents field is not defined in external AppDefinition");try{bf(e)}catch(e){throw wr(e)}},this.validateAppDefinitionForME=(e,t)=>{if(!(null==(n=e)?void 0:n.composeExtension))throw wr("composeExtension field is not defined in external AppDefinition");var n;if(t){if(!mf(e))throw wr("AppDefinition composeExtension.type field must be bot-based");try{Sf(e)}catch(e){throw console.log("the thrown error is ",e),wr(e)}}},this.validateAuthHandlerInput=(e,t,n)=>{Op(e,wr("App ID is not valid.")),t&&Op(t,wr("Conversation ID is not valid.")),(null==n?void 0:n.requestType)===Nh.QueryMessageExtensionRequest?this.validateQueryMessageExtensionRequest(n):(null==n?void 0:n.requestType)===Nh.ActionExecuteInvokeRequest&&this.validateActionExecuteInvokeRequest(n)},this.validateInvokeResponse=e=>{e.responseType===Fh.QueryMessageExtensionResponse&&(this.validateSuggestedActionsForResultOrMessage(e),this.validateQueryMessageExtensionCard(e),this.validateSuggestedActionsForConfigOrAuth(e),this.validateTextForMessageType(e)),e.responseType===Fh.ActionExecuteInvokeResponse&&this.validateValue(e)},this.validateValue=e=>{if(!Hh(e.value))throw wr("ActionExecuteInvokeResponse.value should be a primitive or plain object")},this.validateQueryMessageExtensionCard=e=>{const{composeExtension:t}=e,n=null==t?void 0:t.attachments;n&&n.forEach(e=>{var t;if(!Hh(e.content))throw wr("QueryMessageExtensionCard.content should be a primitive or plain object");if(!Hh(null===(t=e.preview)||void 0===t?void 0:t.content))throw wr("QueryMessageExtensionCard.preview.content should be a primitive or plain object")})},this.validateSuggestedActionsForResultOrMessage=e=>{const{composeExtension:t}=e;if(("result"===(null==t?void 0:t.type)||"message"===(null==t?void 0:t.type))&&(null==t?void 0:t.suggestedActions))throw wr("ComposeExtensionResponse.SuggestedActions should be undefined when the composeExtension.type is 'result' or 'message'")},this.validateSuggestedActionsForConfigOrAuth=e=>{const{composeExtension:t}=e;if(("config"===(null==t?void 0:t.type)||"auth"===(null==t?void 0:t.type))&&!(null==t?void 0:t.suggestedActions))throw wr("ComposeExtensionResponse.SuggestedActions should be defined when the composeExtension.type is 'config' or 'auth'")},this.validateTextForMessageType=e=>{const{composeExtension:t}=e;if("message"===(null==t?void 0:t.type)&&!(null==t?void 0:t.text))throw wr("ComposeExtensionResponse.text should be defined when the composeExtension.type is 'message'")},this.hostedWebContentAuthSdkServiceFactory=null!=a?a:(e,t,n,r,i,o,a,s)=>new ah(e,t,n,r,i,o,a,s)}updateTelemetryScenario(e,t,n){e.addOrUpdateActivityDataField(Kn,t.isExternal?"true":"false"),e.addOrUpdateActivityDataField(Gn,n)}fetchAndValidateAppDefinition(e,t){return c(this,void 0,void 0,function*(){const n=yield this.getAppDefinition(t);return this.validateAppDefinition(n,e,!0),n})}createAppSdkContext(){return c(this,void 0,void 0,function*(){const e=yield this.appSdkHost.getContext();return{app:{locale:e.app.locale,theme:e.app.theme,launchId:Kd(),sessionId:Kd(),host:e.app.host,userClickTime:Date.now(),userClickTimeV2:np()},page:{id:Kd(),frameContext:tf.authentication},user:{dataResidency:e.user.dataResidency}}})}executeOAuthFlow(e,t,n,r,i){return new Promise((o,a)=>{const s={onSuccess:e=>o(e),onFailure:e=>a(e)},l=this.createWindowAuthenticationService(t,n,e,s);this.startOAuthHostedService(t,r,l,i)})}createWindowAuthenticationService(e,t,n,r){return{getUser:()=>this.authenticationService.getUser(),acquireToken:(e,t,n)=>this.authenticationService.acquireToken(e,t,n),notifySuccess:i=>c(this,void 0,void 0,function*(){yield n(i,e.appId,t,r,"originalRequestInfo"in e?e.originalRequestInfo:void 0,"conversationId"in e?e.conversationId:void 0)}),notifyFailure:e=>c(this,void 0,void 0,function*(){r.onFailure(e)}),externalAuthRedirectUrl:this.authenticationService.externalAuthRedirectUrl,externalAuthService:this.authenticationService.externalAuthService,addEventListener:()=>{},clearListeners:()=>{}}}startOAuthHostedService(e,t,n,r){const i="string"==typeof e.url?e.url:e.url.href;this.hostedWebContentAuthSdkServiceFactory(this.appSdkHost.getHostWindow(),{url:i,width:e.width,height:e.height},t,n,r,this.appSdkHost.getLogger(),void 0,e.isExternal)}validateQueryMessageExtensionRequest(e){this.validateQueryMECommandId(e),this.validateQueryMEParametersSize(e),this.validateQueryMEParametersContent(e)}validateQueryMECommandId(e){if(e.commandId.length>64)throw wr("originalRequestInfo.commandId has exceeded the character limit of 64")}validateQueryMEParametersSize(e){if(e.parameters.length>5)throw wr("originalRequestInfo.parameters have exceeded the size limit of 5")}validateQueryMEParametersContent(e){for(const t of e.parameters)this.validateParameterName(t.name),this.validateParameterValue(t.value)}validateParameterName(e){if(e.length>64)throw wr("originalRequestInfo.parameters.Name exceeds the maximum size of 64 characters")}validateParameterValue(e){if(e.length>512)throw wr("originalRequestInfo.parameters.Value exceeds the maximum size of 512 characters")}validateActionExecuteInvokeRequest(e){if(e.type!==Dh)throw wr(`originalRequestInfo.type can only be ${Dh}`)}}const jh=On.CEA;class $h extends zh{constructor(e,t,n,r,i,o,a){super(e,t,n,r,i,o,a),this.appSdkHost=e,this.authenticationService=t,this.externalAppInfoService=n,this.IExternalAppChannelForCEAService=r,this.telemetryService=i,this.logger=o,this.TAG="ExternalAppAuthenticationForCEAExecutor",this.notifySuccessHelper=(e,t,n,r,i,o)=>c(this,void 0,void 0,function*(){const a={type:Bh.OAuthCode,secret_code:e};this.appSdkHost.getLogger().log(z.Debug,this.TAG,"notifySuccess func"),n.markPhase("InvokeToExternalAppAuthTokenAcquired");try{if(i){const e=yield this.IExternalAppChannelForCEAService.sendAuthResultWithOriginalRequestToBot(t,o,i,a);this.appSdkHost.getLogger().log(z.Debug,this.TAG,"IExternalAppChannelForCEAService.sendAuthResultWithOriginalRequestToBot: sent authResult to bot"),this.validateInvokeResponse(e),r.onSuccess(e)}else yield this.IExternalAppChannelForCEAService.sendAuthResultToBot(t,o,a),this.appSdkHost.getLogger().log(z.Debug,this.TAG,"IExternalAppChannelForCEAService.sendAuthResultToBot: sent authResult to bot"),r.onSuccess()}catch(e){r.onFailure(e)}}),this.authenticateAndResendRequestExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){return yield this.externalAppAuthenticationOAuthExecutorHelper(jh,this.notifySuccessHelper,e,t)}),sdkMessageName:Be},this.authenticateWithOauthExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){return yield this.externalAppAuthenticationOAuthExecutorHelper(jh,this.notifySuccessHelper,e,t)}),sdkMessageName:Fe},this.authenticateWithSSOExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){const n=yield this.externalAppAuthenticationSSOExecutorHelper(jh,e,!0,t);yield this.IExternalAppChannelForCEAService.sendAuthResultToBot(e.appId,e.conversationId,n),this.appSdkHost.getLogger().log(z.Debug,this.TAG,"IExternalAppChannelForCEAService.sendAuthResultToBot: sent authResult to bot")}),sdkMessageName:Ne},this.authenticateWithSSOAndResendRequestExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){const n=yield this.externalAppAuthenticationSSOExecutorHelper(jh,e,!0,t),r=yield this.IExternalAppChannelForCEAService.sendAuthResultWithOriginalRequestToBot(e.appId,e.conversationId,e.originalRequestInfo,n);return this.appSdkHost.getLogger().log(z.Debug,this.TAG,"IExternalAppChannelForCEAService.sendAuthResultWithOriginalRequestToBot: sent authResult to bot"),this.validateInvokeResponse(r),r}),sdkMessageName:Le}}authenticateAndResendRequest(e,t,n,r,i,o,a){return this.executeCapabilityFunction(this.authenticateAndResendRequestExecutor,{appId:e,conversationId:t,originalRequestInfo:n,url:r,width:o,height:a,isExternal:i})}authenticateWithSSOInternal(e,t,n,r,i){return this.executeCapabilityFunction(this.authenticateWithSSOExecutor,{appId:e,conversationId:t,origin:n,claims:r,silent:i})}authenticateWithSSO(e,t,n,r){var i;return this.authenticateWithSSOInternal(e,t,(null===(i=this.appSdkHost.getHostWindow())||void 0===i?void 0:i.location.href)||"",n,r)}authenticateWithOauth(e,t,n,r,i,o){return this.executeCapabilityFunction(this.authenticateWithOauthExecutor,{appId:e,conversationId:t,url:n,width:i,height:o,isExternal:r})}authenticateWithSSOAndResendRequestInternal(e,t,n,r,i,o){return this.executeCapabilityFunction(this.authenticateWithSSOAndResendRequestExecutor,{appId:e,conversationId:t,originalRequestInfo:n,origin:r,claims:i,silent:o})}authenticateWithSSOAndResendRequest(e,t,n,r,i){var o;return this.authenticateWithSSOAndResendRequestInternal(e,t,n,(null===(o=this.appSdkHost.getHostWindow())||void 0===o?void 0:o.location.href)||"",r,i)}}const Wh={dependentHubServiceSelector:e=>e.authenticationService&&e.externalAppInfoService&&e.externalAppChannelForCEAService?{authenticationService:e.authenticationService,externalAppInfoService:e.externalAppInfoService,externalAppChannelForCEAService:e.externalAppChannelForCEAService}:void 0,messageHandlerFactory:(e,t,n)=>new qh(e,new $h(e,t.authenticationService,t.externalAppInfoService,t.externalAppChannelForCEAService,n,e.getLogger()),n)};class qh extends Np{constructor(e,t,n){super(e,n),this.appSdkHost=e,this.externalAppAuthenticationForCEAExecutor=t,this.TAG="ExternalAppAuthenticationForCEAMessageHandler",this.isTelemetryHandledByExecutor=!0}initHandlers(){this.registerHandler(Be,this.handleAuthenticateAndResendRequest,{errorCallback:e=>this.onAuthenticateError(e)}),this.registerHandler(Ne,this.handleCEAAuthenticateWithSSO,{errorCallback:e=>this.onAuthenticateError(e)}),this.registerHandler(Fe,this.handleCEAAuthenticateWithOauth,{errorCallback:e=>this.onAuthenticateError(e)}),this.registerHandler(Le,this.handleAuthenticateWithSSOAndResendRequest,{errorCallback:e=>this.onAuthenticateError(e)})}canHandleMessage(e){return super.canHandleMessage(e)&&hf(this.appDefinition)}handleAuthenticateAndResendRequest(e,t,n,r,i,o,a,s){return c(this,void 0,void 0,function*(){const l=rf(e.data);try{const e=yield this.externalAppAuthenticationForCEAExecutor.authenticateAndResendRequest(new Pp(t),n,r,new URL(i),null!=s&&s,o,a);this.postResponseToAppAndLog("notifySuccess func",l,[e])}catch(e){this.postResponseToAppAndLog("AuthenticateAndResendRequest",l,[wr(e)])}return Ir})}handleCEAAuthenticateWithSSO(e,t,n,r,i){return c(this,void 0,void 0,function*(){return yield this.externalAppAuthenticationForCEAExecutor.authenticateWithSSOInternal(new Pp(t),n,e.origin,r,i),Ar()})}handleCEAAuthenticateWithOauth(e,t,n,r,i,o,a){return c(this,void 0,void 0,function*(){return yield this.externalAppAuthenticationForCEAExecutor.authenticateWithOauth(new Pp(t),n,new URL(r),null!=a&&a,i,o),Ar()})}handleAuthenticateWithSSOAndResendRequest(e,t,n,r,i,o){return c(this,void 0,void 0,function*(){const a=yield this.externalAppAuthenticationForCEAExecutor.authenticateWithSSOAndResendRequestInternal(new Pp(t),n,r,e.origin,i,o);return Ar([a])})}postResponseToAppAndLog(e,t,n){return c(this,void 0,void 0,function*(){this.appSdkHost.postResponseToApp(t,n);const r=Pr(t);this.appSdkHost.getLogger().log(z.Debug,this.TAG,`${e}: ${r}`)})}onAuthenticateError(e){const t=wr(e);return Ar([t])}}class Vh{constructor(e,t){this.origin=e;const n="https://";if(ff([this.origin.substring(8)]).length>0)throw new Error(`Please make sure the origin: ${this.origin} is valid. For example: "https://*.*.example.com" is valid, but 'https://foo.*.example.com' is not valid.`);const r=this.origin.startsWith(n)?this.origin.replaceAll("*","x"):n+this.origin.replaceAll("*","x");try{const e=new URL(r);if(!this.origin.startsWith(n)){const n=`Please make sure the origin: ${e.hostname} has a valid https protocol.`;console.warn(n),null==t||t.markWarnMessage(`WARN: ${n}`)}}catch(e){throw new Error(`Please make sure the origin: ${this.origin} is a valid URL. Error: ${e}`)}}getOrigin(){return this.origin}}class Gh{constructor(e,t){this.blockedOrigins=[...e||[]],this.appInitScenario=t}isOriginBlockedImpl(e,t=[],n=!1){for(const r of t){try{new Vh(r,this.appInitScenario)}catch(e){return{isOriginValid:!1,message:e.message}}for(const t of this.blockedOrigins){if(!n&&e&&r===t[0].getOrigin()&&t[1]&&!Array.from(t[1]).find(t=>t.toString()===e.toString()))return{isOriginValid:!1,message:`Current app is not allowed to load the origin: ${r}.`};if(n&&r===t[0].getOrigin())return{isOriginValid:!1,message:`Current app is not allowed to load the origin: ${r}.`}}}return{isOriginValid:!0}}isOriginBlocked(e,t=[]){return this.isOriginBlockedImpl(e,t,!1)}isOriginBlockedExternal(e=[]){return this.isOriginBlockedImpl("",e,!0)}}function Kh(e){return e.uuid?e:rf(e)}class Xh{constructor(e,t,n,r){this.hostWindow=e,this.openWindowInfo=t,this.notificationService=n,this.context=r}isWindowOpen(){return!!this.authWindow&&!this.authWindow.closed}closeWindow(){var e;null===(e=this.authWindow)||void 0===e||e.close()}sendRequestMessage(e,t){if(this.origin){const n={func:e,args:t,monotonicTimestamp:np()};this.postMessage(n)}}launchAuthWindow(){var e,t;try{if(void 0===this.onAuthMessageReceived)throw Error("onAuthMessageReceived is undefined");const e=th(this.openWindowInfo);this.context.app.host.clientType===ef.desktop&&this.notificationService.externalAuthService?this.authWindow=this.notificationService.externalAuthService.openUrlInEmbeddedBrowser(new URL(this.openWindowInfo.url),e):this.authWindow=this.hostWindow.open(this.openWindowInfo.url,"appAuthWindow",e),this.authWindow?this.setupExternalAuthWindow(this.openWindowInfo.url,this.hostWindow):this.notificationService.notifyFailure("Auth window reference undefined")}catch(n){if(null!==this.authWindow)null===(e=this.notificationService)||void 0===e||e.notifyFailure(`openUrlInEmbeddedBrowser threw an error but still returned a non-null window object? Forcing window object to null. Error = ${n}`),this.authWindow=null;else{let e=n instanceof Error?`${n.message}`:"Error launching AuthWindow";null===(t=this.notificationService)||void 0===t||t.notifyFailure(e)}}}postResponseToApp(e,t){this.sendResponseMessage(e,t)}stopAuthWindowMonitor(){this.authWindowMonitor&&(this.hostWindow.clearInterval(this.authWindowMonitor),this.authWindowMonitor=void 0)}setupExternalAuthWindow(e,t){this.origin=e,this.globalWindowEventListener=new X(t),this.globalWindowEventListener.addListener("message",this.onAuthMessageReceived),this.startAuthWindowMonitor()}sendResponseMessage(e,t){var n;if(this.origin){const r=Kh(e),i={id:r.id,uuidAsString:null===(n=r.uuid)||void 0===n?void 0:n.toString(),args:t,origin:this.origin,monotonicTimestamp:np()};this.postMessage(i)}}startAuthWindowMonitor(){this.stopAuthWindowMonitor(),this.authWindowMonitor=this.hostWindow.setInterval(()=>{this.authWindowInterval()},2e3)}authWindowInterval(){this.isWindowOpen()?this.sendRequestMessage("ping"):(this.notificationService.notifyFailure("CancelledByUser",ih.CancelledByUser),this.closeWindow(),this.stopAuthWindowMonitor())}postMessage(e){var t;this.origin&&(null===(t=this.authWindow)||void 0===t||t.postMessage(e,this.origin))}isValidOriginBlocked(e){const t=new Gh([]),n=e.args&&e.args.length>2&&null!=e.args[2]?[e.args[2]]:[];return t.isOriginBlockedExternal(n)}}class Qh extends Xh{constructor(e,t,n,r,i,o){super(e,t,n,r),this.hostWindow=e,this.openWindowInfo=t,this.notificationService=n,this.context=r,this.logger=i,this.redirectOrigin=o,this.onAuthMessageReceived=e=>c(this,void 0,void 0,function*(){var t,n;if(!this.authWindow||this.authWindow!==e.source)return void this.logger.log(z.Error,"HostedWebContentExternalOauthService","Auth window is not valid");const r=e.origin;r!==this.origin&&r.toLocaleLowerCase()===this.redirectOrigin.toLocaleLowerCase()&&(this.origin=e.origin);const i=e.data,o=rf(i);if(this.origin===r&&this.notificationService)if(o.func===qe){const e=this.isValidOriginBlocked(o);if(e.isOriginValid)return this.postResponseToApp(o,[tf.authentication,ef]);this.notificationService.notifyFailure(e.message),this.stopAuthWindowMonitor(),this.closeWindow()}else if("authentication.authenticate.success"===o.func)this.notificationService.notifySuccess((null===(t=o.args)||void 0===t?void 0:t[0])?String(o.args[0]):""),this.stopAuthWindowMonitor(),this.closeWindow();else if("authentication.authenticate.failure"===o.func){const e=(null===(n=o.args)||void 0===n?void 0:n[0])?String(o.args[0]):"Token storage failed";this.notificationService.notifyFailure(e),this.stopAuthWindowMonitor(),this.closeWindow()}})}}const Jh="HostedWebContentPPCAuthService";class Yh extends Xh{constructor(e,t,n,r,i,o){super(e,t,n,r),this.hostWindow=e,this.openWindowInfo=t,this.notificationService=n,this.context=r,this.logger=i,this.validDomains=o,this.onAuthMessageReceived=e=>c(this,void 0,void 0,function*(){var t;if(this.authWindow&&this.authWindow===e.source)try{const n=e.origin;n!==this.origin&&xf(new URL(n),this.validDomains,this.logger)&&(this.origin=e.origin);const r=e.data;if(this.origin===n&&this.notificationService)if(r.func===qe){const e=this.isValidOriginBlocked(r);if(e.isOriginValid)return this.postResponseToApp(r,[tf.authentication,ef]);this.notificationService.notifyFailure(e.message),this.stopAuthWindowMonitor(),this.closeWindow()}else if("authentication.authenticate.success"===r.func)this.notificationService.notifySuccess(""),this.stopAuthWindowMonitor(),this.closeWindow();else if("authentication.authenticate.failure"===r.func){const e=(null===(t=r.args)||void 0===t?void 0:t[0])?String(r.args[0]):"Token storage failed";this.notificationService.notifyFailure(e),this.stopAuthWindowMonitor(),this.closeWindow()}}catch(e){this.logger.log(z.Error,Jh,"Error in onAuthMessageReceived",e),this.notificationService.notifyFailure(e.message)}else this.logger.log(z.Error,Jh,"Auth window is not valid")})}}class Zh{constructor(e){this.endpointUrl=e}static build(e,t){return c(this,void 0,void 0,function*(){Zh.mos3TokenGenerationService=e;let n=yield Zh.acquireToken(!0),r=yield Zh.getEndpointUrl(n);return Zh.jestDelay=t,new Zh(r)})}getSignInUrlInfo(e,t){var n;return c(this,void 0,void 0,function*(){const r=yield Zh.acquireToken(!0);let i=null!==(n=this.endpointUrl)&&void 0!==n?n:Zh.DEFAULT_ENDPOINT;i=`${i}/catalog/v1/users/titles/${e}/signInInfo`;const o=function(e,t){if(t&&t.size>0){let n=[];t.forEach((e,t)=>{t&&e&&n.push(`${t}=${e}`)}),e+="?"+n.join("&")}return e}(i,t);return yield this.getRequestWithRetry(r,o)})}activateOauth2Token(e,t,n){var r;return c(this,void 0,void 0,function*(){const i=yield Zh.acquireToken(!0);let o=null!==(r=this.endpointUrl)&&void 0!==r?r:Zh.DEFAULT_ENDPOINT;o=`${o}/catalog/v1/users/titles/${e}/signInCode`;const a={authConfigId:t,authCode:n};yield this.postRequestWithRetry(i,o,a)})}static requestMOS3ForEndpointURL(e,t){return c(this,void 0,void 0,function*(){const n=yield fetch(t,{headers:{Authorization:"Bearer "+e}});if(n.ok)return n.json();throw Error(`Request failed with status code: ${n.status}`)})}getRequestWithRetry(e,t){return c(this,void 0,void 0,function*(){const n=yield fetch(t,{headers:{Authorization:"Bearer "+e}});if(n.ok)return n.json();if(401===n.status){const e=yield this.handle401Error(n);return this.getRequestWithRetry(e,t)}throw Error(`Request failed with status code: ${n.status}`)})}postRequestWithRetry(e,t,n){return c(this,void 0,void 0,function*(){const r=yield fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+e},body:JSON.stringify(n)});if(r.ok)return r;if(401===r.status){const e=yield this.handle401Error(r);return this.postRequestWithRetry(e,t,n)}throw Error(`Request failed with status code: ${r.status}`)})}handle401Error(e){var t,n;return c(this,void 0,void 0,function*(){let r,i=!0;const o=null!==(n=null===(t=e.headers)||void 0===t?void 0:t.get("www-authenticate"))&&void 0!==n?n:void 0;return o&&(r=function(e){const t=e.trim(),n=t.indexOf(" ");if(-1!==n){const e=t.substring(n+1).split(",").filter(Boolean).map(e=>e.trim()),r=3,i={error:void 0,claims:void 0};if(e.forEach(e=>{const t=e.split('"');if(t.length===r)switch(t[0].toLocaleLowerCase()){case"error=":i.error=t[1];break;case"claims=":i.claims=t[1]}}),"insufficient_claims"===i.error)return i.claims}}(o),i=!1),yield Zh.acquireToken(i,r?[r]:void 0,o)})}}Zh.DEFAULT_ENDPOINT="https://titles.prod.mos.microsoft.com",Zh.getEndpointUrl=e=>c(void 0,void 0,void 0,function*(){let t=Zh.DEFAULT_ENDPOINT+"/config/v1/environment";const n=yield Zh.requestMOS3ForEndpointURL(e,t);if(Tf(n.titlesServiceUrl))return n.titlesServiceUrl;throw Error("Invalid endpoint URL")}),Zh.acquireToken=(e,t,n)=>c(void 0,void 0,void 0,function*(){const r=yield Zh.mos3TokenGenerationService.acquireToken(Zh.DEFAULT_ENDPOINT,t,n,e);if(r&&r.token)return r.token;throw Error("Empty token response.")});const ev=On.ME;class tv extends zh{constructor(e,t,n,r,i,o,a,s,l,u){super(e,t,n,r,o,a,s),this.appSdkHost=e,this.authenticationService=t,this.externalAppInfoService=n,this.externalAppChannelService=r,this.signInUrlInfoServiceProvider=i,this.telemetryService=o,this.logger=a,this.TAG="ExternalAppAuthenticationExecutor",this.notifySuccessHelper=(e,t,n,r,i)=>c(this,void 0,void 0,function*(){const o={type:Bh.OAuthCode,secret_code:e};this.appSdkHost.getLogger().log(z.Debug,this.TAG,"notifySuccess func"),n.markPhase("InvokeToExternalAppAuthTokenAcquired");try{const e=yield this.externalAppChannelService.sendRequestWithAuth(t,i,o);this.validateInvokeResponse(e),r.onSuccess(e)}catch(e){r.onFailure(e)}}),this.authenticateAndResendRequestExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){return yield this.externalAppAuthenticationOAuthExecutorHelper(ev,this.notifySuccessHelper,e,t)}),sdkMessageName:Te},this.authenticateWithSSOExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){yield this.externalAppAuthenticationSSOExecutorHelper(ev,e,!1,t)}),sdkMessageName:xe},this.authenticateWithSSOAndResendRequestExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){const n=yield this.externalAppAuthenticationSSOExecutorHelper(ev,e,!0,t),r=yield this.externalAppChannelService.sendRequestWithAuth(e.appId,e.originalRequestInfo,n);return this.appSdkHost.getLogger().log(z.Debug,this.TAG,"externalAppChannelService.sendRequestWithAuth: sent authResult to bot"),this.validateInvokeResponse(r),r}),sdkMessageName:Re},this.authenticateWithOauth2Executor={execute:(e,t)=>c(this,void 0,void 0,function*(){var n,r;t.addOrUpdateActivityDataField(Gn,e.titleId),t.addOrUpdateActivityDataField("OauthConfigID",e.oauthConfigId),Op(e.titleId,wr("titleId is not valid."));const i=null===(n=e.oauthConfigId)||void 0===n?void 0:n.trim();if(!i)throw wr("No oAuthConfigId is provided. Request cannot be completed");const o=new Map;o.set("authConfigId",i);const a=yield this.getSignInUrlInfoResponse(e.titleId,o);if(!a)throw wr("No response is provided by the service. Request cannot be completed");const s=null!==(r=a.signInUrl)&&void 0!==r?r:"",l=decodeURIComponent(s);if(!this.isValidOauthUrl(l))throw wr("Invalid signIn URL. Request cannot be completed");const u=new URL(this.getUrlParameters(new URL(l),"redirect_uri")).origin;return new Promise((n,r)=>{const o={onSuccess:()=>n(),onFailure:e=>r(e)},a={getUser:()=>Promise.reject(void 0),acquireToken:()=>Promise.reject(void 0),notifySuccess:n=>c(this,void 0,void 0,function*(){yield this.activateOauth2TokenAfterSuccessIsReceived(e.titleId,i,n,t,o)}),notifyFailure:e=>c(this,void 0,void 0,function*(){const t="Internal error occurred while acquiring or storing token";this.appSdkHost.getLogger().log(z.Debug,this.TAG,`Oauth notifyFailure func: ${null!=e?e:t}`),r(null!=e?e:t)}),externalAuthRedirectUrl:void 0,addEventListener:()=>{},clearListeners:()=>{},externalAuthService:this.authenticationService.externalAuthService},s={app:{locale:this.appSdkHost.getContext().app.locale,theme:this.appSdkHost.getContext().app.theme,launchId:Kd(),sessionId:Kd(),host:this.appSdkHost.getContext().app.host,userClickTime:Date.now(),userClickTimeV2:np()},page:{id:Kd(),frameContext:tf.authentication},user:{dataResidency:this.appSdkHost.getContext().user.dataResidency}};this.hostedWebContentExternalOauthServiceFactory(this.appSdkHost.getHostWindow(),{url:l,width:e.width,height:e.height},a,s,this.appSdkHost.getLogger(),u).launchAuthWindow()})}),sdkMessageName:Oe},this.authenticateWithPPCExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){var n,r;t.addOrUpdateActivityDataField(Gn,e.titleId),Op(e.titleId,wr("titleId is not valid."));const i=yield this.getSignInUrlInfoResponse(e.titleId);if(!i)throw wr("No response is provided by the service. Request cannot be completed");const o=null!==(r=null!==(n=e.signInUrl)&&void 0!==n?n:i.signInUrl)&&void 0!==r?r:"",a=null==i?void 0:i.validDomains;if(void 0===a||0===a.length)throw wr("No valid domains are provided by the service. Request cannot be completed");const s=a.map(e=>e.toLocaleLowerCase()),l=decodeURIComponent(o);if(!this.isValidPPCUrl(l,s))throw wr("Invalid authentication url. Request cannot be completed");return new Promise((t,n)=>{const r={getUser:()=>Promise.reject(void 0),acquireToken:()=>Promise.reject(void 0),notifySuccess:()=>c(this,void 0,void 0,function*(){this.appSdkHost.getLogger().log(z.Debug,this.TAG,"notifySuccess func"),t()}),notifyFailure:e=>c(this,void 0,void 0,function*(){const t="Internal error occurred while acquiring or storing token";this.appSdkHost.getLogger().log(z.Debug,this.TAG,`Oauth notifyFailure func: ${null!=e?e:t}`),n(null!=e?e:t)}),externalAuthRedirectUrl:void 0,externalAuthService:this.authenticationService.externalAuthService,addEventListener:()=>{},clearListeners:()=>{}},i={app:{locale:this.appSdkHost.getContext().app.locale,theme:this.appSdkHost.getContext().app.theme,launchId:Kd(),sessionId:Kd(),host:this.appSdkHost.getContext().app.host,userClickTime:Date.now(),userClickTimeV2:np()},page:{id:Kd(),frameContext:tf.authentication},user:{dataResidency:this.appSdkHost.getContext().user.dataResidency}};this.hostedWebContentPPCAuthServiceFactory(this.appSdkHost.getHostWindow(),{url:l,width:e.width,height:e.height},r,i,this.appSdkHost.getLogger(),s).launchAuthWindow()})}),sdkMessageName:Pe},this.getSignInUrlInfoResponse=(e,t)=>c(this,void 0,void 0,function*(){return this.oauth2Service||(yield this.constructOauth2Service()),this.oauth2Service?yield this.oauth2Service.getSignInUrlInfo(e,t):{}}),this.callActivateOauth2Token=(e,t,n)=>c(this,void 0,void 0,function*(){if(this.oauth2Service||(yield this.constructOauth2Service()),!this.oauth2Service)throw wr("No service is provided to activate Oauth2 token");yield this.oauth2Service.activateOauth2Token(e,t,n)}),this.activateOauth2TokenAfterSuccessIsReceived=(e,t,n,r,i)=>c(this,void 0,void 0,function*(){this.appSdkHost.getLogger().log(z.Debug,this.TAG,"activateOauth2TokenAfterSuccessIsReceived func"),r.markPhase("InvokeToActivateOauth2Token");try{if(!n)throw wr("No auth code is provided. Activate Oauth Token failed.");yield this.callActivateOauth2Token(e,t,n),this.appSdkHost.getLogger().log(z.Debug,this.TAG,"activateOauth2TokenAfterSuccessIsReceived func success"),i.onSuccess()}catch(e){this.appSdkHost.getLogger().log(z.Debug,this.TAG,"activateOauth2TokenAfterSuccessIsReceived func failed"),i.onFailure(e)}}),this.hostedWebContentExternalOauthServiceFactory=null!=l?l:(e,t,n,r,i,o)=>new Qh(e,t,n,r,i,o),this.hostedWebContentPPCAuthServiceFactory=null!=u?u:(e,t,n,r,i,o)=>new Yh(e,t,n,r,i,o)}authenticateAndResendRequest(e,t,n,r,i,o){const a="string"==typeof n?n:n.href;return this.executeCapabilityFunction(this.authenticateAndResendRequestExecutor,{appId:e,originalRequestInfo:t,url:a,width:i,height:o,isExternal:r})}authenticateWithSSOInternal(e,t,n,r){return this.executeCapabilityFunction(this.authenticateWithSSOExecutor,{appId:e,origin:t,claims:n,silent:r})}authenticateWithSSO(e,t,n){var r;return this.authenticateWithSSOInternal(e,(null===(r=this.appSdkHost.getHostWindow())||void 0===r?void 0:r.location.href)||"",t,n)}authenticateWithSSOAndResendRequestInternal(e,t,n,r,i){return this.executeCapabilityFunction(this.authenticateWithSSOAndResendRequestExecutor,{appId:e,originalRequestInfo:t,origin:n,claims:r,silent:i})}authenticateWithSSOAndResendRequest(e,t,n,r){var i;return this.authenticateWithSSOAndResendRequestInternal(e,t,(null===(i=this.appSdkHost.getHostWindow())||void 0===i?void 0:i.location.href)||"",n,r)}authenticateWithOauth2(e,t,n,r,i){return c(this,void 0,void 0,function*(){return this.executeCapabilityFunction(this.authenticateWithOauth2Executor,{titleId:e,oauthConfigId:t,width:n,height:r,_isExternal:i})})}authenticateWithPPC(e,t,n,r,i){return c(this,void 0,void 0,function*(){return this.executeCapabilityFunction(this.authenticateWithPPCExecutor,{titleId:e,signInUrl:t,width:n,height:r,_isExternal:i})})}constructOauth2Service(){return c(this,void 0,void 0,function*(){if(!this.signInUrlInfoServiceProvider)throw wr("No service is provided to retrieve signInUrl");this.isExternalAppOauth2Service(this.signInUrlInfoServiceProvider)?this.oauth2Service=this.signInUrlInfoServiceProvider:this.oauth2Service=yield Zh.build(this.signInUrlInfoServiceProvider)})}isValidOauthUrl(e){if(!e)return!1;try{const t=new URL(e),n=new URL(this.getUrlParameters(t,"redirect_uri"));return this.getUrlParameters(t,"client_id"),this.getUrlParameters(t,"response_type"),"https:"===t.protocol&&n&&"https:"===n.protocol}catch(e){return!1}}isValidPPCUrl(e,t){if(!e||!t)return!1;try{const n=new URL(e);return xf(n,t,this.logger)}catch(e){return!1}}getUrlParameters(e,t){const n=new URLSearchParams(e.search).get(t);if(n)return n;throw Error(`${t} is undefined or null`)}isExternalAppOauth2Service(e){return void 0!==e.getSignInUrlInfo}}const nv={dependentHubServiceSelector:e=>{var t;return e.authenticationService&&e.externalAppInfoService&&e.externalAppChannelService?{authenticationService:e.authenticationService,externalAppInfoService:e.externalAppInfoService,externalAppChannelService:e.externalAppChannelService,oauth2ServiceProvider:null!==(t=e.externalAppOauth2Service)&&void 0!==t?t:e.mos3TokenGenerationService}:void 0},messageHandlerFactory:(e,t,n)=>new rv(e,new tv(e,t.authenticationService,t.externalAppInfoService,t.externalAppChannelService,t.oauth2ServiceProvider,n,e.getLogger()),n)};class rv extends Np{constructor(e,t,n){super(e,n),this.appSdkHost=e,this.externalAppAuthExecutor=t,this.TAG="ExternalAppAuthenticationMessageHandler",this.isTelemetryHandledByExecutor=!0}initHandlers(){this.registerHandler(Te,this.handleAuthenticateAndResendRequest,{errorCallback:e=>this.onAuthenticateError(e)}),this.registerHandler(xe,this.handleAuthenticateWithSSO,{errorCallback:e=>this.onAuthenticateError(e)}),this.registerHandler(Re,this.handleAuthenticateWithSSOAndResendRequest,{errorCallback:e=>this.onAuthenticateError(e)}),this.registerHandler(Oe,this.handleAuthenticateWithOauth2,{errorCallback:e=>this.onAuthenticateError(e)}),this.registerHandler(Pe,this.authenticateWithPowerPlatformConnectorPlugins,{errorCallback:e=>this.onAuthenticateError(e)})}canHandleMessage(e){return super.canHandleMessage(e)&&hf(this.appDefinition)}handleAuthenticateAndResendRequest(e,t,n,r,i,o,a){return c(this,void 0,void 0,function*(){const s=rf(e.data);return this.externalAppAuthExecutor.authenticateAndResendRequest(t,n,r,null!=a&&a,i,o).then(e=>this.postResponseToAppAndLog("notifySuccess func",s,[!0,e]),e=>this.postResponseToAppAndLog("AuthenticateAndResendRequest",s,[!1,wr(e)])),Ir})}handleAuthenticateWithSSO(e,t,n,r){return c(this,void 0,void 0,function*(){return yield this.externalAppAuthExecutor.authenticateWithSSOInternal(t,e.origin,n,r),Ar([!0])})}handleAuthenticateWithSSOAndResendRequest(e,t,n,r,i){return c(this,void 0,void 0,function*(){const o=yield this.externalAppAuthExecutor.authenticateWithSSOAndResendRequestInternal(t,n,e.origin,r,i);return Ar([!0,o])})}authenticateWithPowerPlatformConnectorPlugins(e,t,n,r,i,o){return c(this,void 0,void 0,function*(){const o=rf(e.data),a=Pr(o);return this.externalAppAuthExecutor.authenticateWithPPC(t,n,r,i).then(()=>{this.appSdkHost.postResponseToApp(o,[!0,"success"]),this.appSdkHost.getLogger().log(z.Debug,this.TAG,`notifySuccess func: ${a}`)},e=>{this.appSdkHost.postResponseToApp(o,[!1,wr(e)]),this.appSdkHost.getLogger().log(z.Debug,this.TAG,`ppc notifyFailure func: ${a} : ${e}`)}),Ir})}handleAuthenticateWithOauth2(e,t,n,r,i,o){return c(this,void 0,void 0,function*(){const o=rf(e.data),a=Pr(o);return this.externalAppAuthExecutor.authenticateWithOauth2(t,n,r,i).then(()=>{this.appSdkHost.postResponseToApp(o,[!0,"success"]),this.appSdkHost.getLogger().log(z.Debug,this.TAG,`notifySuccess func: ${a}`)},e=>{this.appSdkHost.postResponseToApp(o,[!1,wr(e)]),this.appSdkHost.getLogger().log(z.Debug,this.TAG,`Oauth notifyFailure func: ${a} : ${e}`)}),Ir})}postResponseToAppAndLog(e,t,n){return c(this,void 0,void 0,function*(){this.appSdkHost.postResponseToApp(t,n);const r=Pr(t);this.appSdkHost.getLogger().log(z.Debug,this.TAG,`${e}: ${r}`)})}onAuthenticateError(e){const t=wr(e);return Ar([!1,t])}}class iv extends Uh{constructor(e,t,n){super(t,n),this.externalAppInfoService=e,this.telemetryService=t,this.logger=n,this.getValidatedUrl=e=>{try{return new URL(e)}catch(e){throw{errorCode:er.INTERNAL_ERROR,message:"Invalid URL"}}},this.isDeepLinkUrl=e=>e.hostname.toLowerCase()===$f.hostname&&e.pathname.toLowerCase().startsWith($f.pathname)}verifyAppIsAllowed(e){return c(this,void 0,void 0,function*(){if(!(yield this.externalAppInfoService.isAppAllowed(e)))throw{errorCode:er.INTERNAL_ERROR,message:Vn}})}doesAppContainME(e){return c(this,void 0,void 0,function*(){return!!(yield this.getAppDefinition(e)).composeExtension})}getAppDefinition(e){return c(this,void 0,void 0,function*(){const t=yield this.externalAppInfoService.getAppDefinition(e);if(!t)throw{errorCode:er.INTERNAL_ERROR,message:`Unable to retrieve AppDefinition for ${e}`};return t})}validateAppIdAndScenario(e,t){t.addOrUpdateActivityDataField("RequestedForAppID",e),Op(e,{errorCode:Mh.INTERNAL_ERROR,message:"App ID is not valid."})}}class ov extends iv{constructor(e,t,n,r){super(t,n,r),this.externalAppCardActionsForCEAService=e,this.externalAppInfoService=t,this.telemetryService=n,this.logger=r,this.actionOpenUrlExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){this.validateAppIdAndScenario(e.appId.toString(),t),yield this.verifyAppIsAllowed(e.appId.toString());const n=yield this.externalAppCardActionsForCEAService.handleActionOpenUrl(e.appId,e.conversationId,e.url);return t.addOrUpdateActivityDataField("ActionOpenUrlType",n),n}),sdkMessageName:Ae},this.actionSubmitExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){this.validateAppIdAndScenario(e.appId.toString(),t),yield this.verifyAppIsAllowed(e.appId.toString()),yield this.externalAppCardActionsForCEAService.handleActionSubmit(e.appId,e.conversationId,e.actionSubmitPayload)}),sdkMessageName:Ce}}actionOpenUrl(e,t,n){return this.executeCapabilityFunction(this.actionOpenUrlExecutor,{appId:e,conversationId:t,url:n})}actionSubmit(e,t,n){return this.executeCapabilityFunction(this.actionSubmitExecutor,{appId:e,conversationId:t,actionSubmitPayload:n})}}const av={dependentHubServiceSelector:e=>e.externalAppCardActionsForCEAService&&e.externalAppInfoService?{externalAppCardActionsForCEAService:e.externalAppCardActionsForCEAService,externalAppInfoService:e.externalAppInfoService}:void 0,messageHandlerFactory:(e,t,n)=>new sv(e,new ov(t.externalAppCardActionsForCEAService,t.externalAppInfoService,n,e.getLogger()),n)};class sv extends Np{constructor(e,t,n){super(e,n),this.appSdkHost=e,this.externalAppCardActionsForCEAExecutor=t,this.isTelemetryHandledByExecutor=!0}initHandlers(){this.registerHandler(Ae,this.handleActionOpenUrl,{errorCallback:e=>mr(Ae,e,Object.values(Mh),{errorCode:Mh.INTERNAL_ERROR,message:pr},e=>Ar([e,null]))}),this.registerHandler(Ce,this.handleActionSubmit,{errorCallback:e=>mr(Ce,e,Object.values(er),gr,e=>Ar(e))})}canHandleMessage(e){return super.canHandleMessage(e)&&hf(this.appDefinition)}handleActionOpenUrl(e,t,n,r){return c(this,void 0,void 0,function*(){const e=yield this.externalAppCardActionsForCEAExecutor.actionOpenUrl(new Pp(t),n,new URL(r));return Ar([null,e])})}handleActionSubmit(e,t,n,r){return c(this,void 0,void 0,function*(){return yield this.externalAppCardActionsForCEAExecutor.actionSubmit(new Pp(t),n,r),Ar(void 0)})}}class lv extends iv{constructor(e,t,n,r){super(t,n,r),this.externalAppCardActionsService=e,this.externalAppInfoService=t,this.telemetryService=n,this.logger=r,this.actionOpenUrlExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){var n;if(t.addOrUpdateActivityDataField("RequestedForAppID",e.appId),"string"==typeof e.url&&(e.url=this.getValidatedUrl(e.url)),Op(e.appId,{errorCode:Mh.INTERNAL_ERROR,message:"App ID is not valid."}),yield this.verifyAppIsAllowed(e.appId),this.isDeepLinkUrl(e.url)&&("plugins"===(null===(n=e.fromElement)||void 0===n?void 0:n.name)||!(yield this.doesAppContainME(e.appId))))throw{errorCode:er.INTERNAL_ERROR,message:"Deep links are only supported in Message Extensions"};const r=yield this.externalAppCardActionsService.handleActionOpenUrl(e.appId,e.url.href,e.fromElement);return t.addOrUpdateActivityDataField("ActionOpenUrlType",r),r}),sdkMessageName:ke},this.actionSubmitExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){if(t.addOrUpdateActivityDataField("RequestedForAppID",e.appId),Op(e.appId,{errorCode:er.INTERNAL_ERROR,message:"App ID is not valid."}),yield this.verifyAppIsAllowed(e.appId),!(yield this.doesAppContainME(e.appId)))throw{errorCode:er.INTERNAL_ERROR,message:"Action.Submit is only supported in Message Extensions"};yield this.externalAppCardActionsService.handleActionSubmit(e.appId,e.actionSubmitPayload)}),sdkMessageName:Ee}}actionOpenUrl(e,t,n){return this.executeCapabilityFunction(this.actionOpenUrlExecutor,{appId:e,url:t,fromElement:n})}actionSubmit(e,t){return this.executeCapabilityFunction(this.actionSubmitExecutor,{appId:e,actionSubmitPayload:t})}}const cv={dependentHubServiceSelector:e=>e.externalAppCardActionsService&&e.externalAppInfoService?{externalAppCardActionsService:e.externalAppCardActionsService,externalAppInfoService:e.externalAppInfoService}:void 0,messageHandlerFactory:(e,t,n)=>new uv(e,new lv(t.externalAppCardActionsService,t.externalAppInfoService,n,e.getLogger()),n)};class uv extends Np{constructor(e,t,n){super(e,n),this.appSdkHost=e,this.externalAppCardActionsExecutor=t,this.isTelemetryHandledByExecutor=!0}initHandlers(){this.registerHandler(ke,this.handleActionOpenUrl,{errorCallback:e=>mr(ke,e,Object.values(Mh),{errorCode:Mh.INTERNAL_ERROR,message:pr},e=>Ar([e,null]))}),this.registerHandler(Ee,this.handleActionSubmit,{errorCallback:e=>mr(Ee,e,Object.values(er),gr,e=>Ar([!1,e]))})}canHandleMessage(e){return super.canHandleMessage(e)&&hf(this.appDefinition)}handleActionOpenUrl(e,t,n,r){return c(this,void 0,void 0,function*(){const e=yield this.externalAppCardActionsExecutor.actionOpenUrl(t,n,r);return Ar([null,e])})}handleActionSubmit(e,t,n){return c(this,void 0,void 0,function*(){return yield this.externalAppCardActionsExecutor.actionSubmit(t,n),Ar([!0,null])})}}class dv extends Uh{constructor(e,t,n,r){super(n,r),this.externalAppCommandsService=e,this.externalAppInfoService=t,this.telemetryService=n,this.logger=r,this.actionCommandExecutor={execute:(e,t)=>c(this,void 0,void 0,function*(){t.addOrUpdateActivityDataField("RequestedForAppID",e.appId),Op(e.appId,{errorCode:er.INTERNAL_ERROR,message:"App ID is not valid."}),yield this.verifyAppIsAllowed(e.appId);const n=yield this.getAppDefinition(e.appId);if(!n.composeExtension)throw{errorCode:er.INTERNAL_ERROR,message:"Action Command is only supported in Message Extensions"};return this.validateActionCommandParameters(n,e.commandId,e.extractedParameters),yield this.externalAppCommandsService.handleActionCommand(e.appId,e.commandId,e.extractedParameters)}),sdkMessageName:Ie}}verifyAppIsAllowed(e){return c(this,void 0,void 0,function*(){if(!(yield this.externalAppInfoService.isAppAllowed(e)))throw{errorCode:er.INTERNAL_ERROR,message:Vn}})}validateActionCommandParameters(e,t,n){var r,i;const o=null===(i=null===(r=e.composeExtension)||void 0===r?void 0:r.commands)||void 0===i?void 0:i.find(e=>e.id===t);if(!o)throw{errorCode:er.INTERNAL_ERROR,message:"commandId does not exist in app manifest"};{const e=o.parameterNames||[];if(!Object.keys(n).every(t=>e.includes(t)))throw{errorCode:er.INTERNAL_ERROR,message:"One or more parameters in extractedParameters do not exist in app manifest"}}}getAppDefinition(e){return c(this,void 0,void 0,function*(){const t=yield this.externalAppInfoService.getAppDefinition(e);if(!t)throw{errorCode:er.INTERNAL_ERROR,message:`Unable to retrieve AppDefinition for ${e}`};return t})}actionCommand(e,t,n){return this.executeCapabilityFunction(this.actionCommandExecutor,{appId:e,commandId:t,extractedParameters:n})}}const fv={dependentHubServiceSelector:e=>e.externalAppCommandsService&&e.externalAppInfoService?{externalAppCommandsService:e.externalAppCommandsService,externalAppInfoService:e.externalAppInfoService}:void 0,messageHandlerFactory:(e,t,n)=>new pv(e,new dv(t.externalAppCommandsService,t.externalAppInfoService,n,e.getLogger()),n)};class pv extends Np{constructor(e,t,n){super(e,n),this.appSdkHost=e,this.externalAppCommandsExecutor=t,this.isTelemetryHandledByExecutor=!0}initHandlers(){this.registerHandler(Ie,this.handleActionCommand,{errorCallback:e=>mr(Ie,e,Object.values(er),gr,e=>Ar([e,null]))})}canHandleMessage(e){return super.canHandleMessage(e)&&hf(this.appDefinition)}handleActionCommand(e,t,n,r){return c(this,void 0,void 0,function*(){const e=yield this.externalAppCommandsExecutor.actionCommand(t,n,r);return Ar([null,e])})}}const hv={dependentHubServiceSelector:e=>e.filesService,messageHandlerFactory:(e,t,n)=>new vv(e,n,t)};class vv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.filesService=n}initHandlers(){this.registerHandler(Ue,(e,...t)=>{const n={entityId:t[0],title:t[1],description:t[2],type:t[3],objectUrl:t[4],downloadUrl:t[5],webPreviewUrl:t[6],webEditUrl:t[7],baseUrl:t[8],editFile:t[9],subEntityId:t[10],viewerAction:t[11],fileOpenPreference:t[12]};return n.type&&n.objectUrl?Tr(this.filesService.openFilePreview,n):Promise.reject("Invalid File Preview Parameters")},{isRestrictedToFullTrustOrLobApps:!0}),this.registerHandler(Me,(e,t)=>kr(t,this.filesService.getCloudStorageFolders),{errorCallback:(e,t)=>yr(Me,e,t),isRestrictedToFullTrustApps:!0}),this.registerHandler(De,(e,t)=>kr(t,this.filesService.addCloudStorageFolder,e=>[e.isFolderAdded,e.folders],!0),{errorCallback:(e,t)=>yr(De,e,t),isRestrictedToFullTrustApps:!0}),this.registerHandler(_e,(e,t,n)=>kr({channelId:t,folderToDelete:n},this.filesService.deleteCloudStorageFolder),{errorCallback:(e,t)=>yr(_e,e,t),isRestrictedToFullTrustApps:!0}),this.registerHandler(He,(e,t,n,r,i,o)=>kr({selectedFiles:t,providerCode:n,destinationFolder:r,destinationProviderCode:i,isMove:o},this.filesService.copyMoveFiles),{errorCallback:(e,t)=>yr(He,e,t),isRestrictedToFullTrustApps:!0}),this.registerHandler(ze,(e,t=!1)=>kr(t,this.filesService.getExternalProviders),{errorCallback:(e,t)=>yr(ze,e,t),isRestrictedToFullTrustApps:!0}),this.registerHandler($e,(e,t,n)=>kr({folder:t,providerCode:n},this.filesService.getCloudStorageFolderContents),{errorCallback:(e,t)=>yr($e,e,t),isRestrictedToFullTrustApps:!0}),this.registerHandler(je,(e,t,n,r)=>kr({file:t,providerCode:n,fileOpenPreference:r},this.filesService.openCloudStorageFile),{errorCallback:(e,t)=>yr(je,e,t),isRestrictedToFullTrustApps:!0})}}const gv={errorCode:Zn.INTERNAL_ERROR,message:"Internal error"};class mv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.hostEntityTabService=n}initHandlers(){this.registerHandler(Ve.addAndConfigure,(e,t,n)=>c(this,void 0,void 0,function*(){var e;const r=yield null===(e=this.hostEntityTabService)||void 0===e?void 0:e.addAndConfigure(t,n);return Ar([r])}),{isRestrictedToMicrosoftOwnedApps:!0,errorCallback:e=>mr(Ve.addAndConfigure,e,[gv.errorCode],gv,e=>Ar([e]))}),this.registerHandler(Ve.reconfigure,(e,t,n)=>c(this,void 0,void 0,function*(){var e;const r=yield null===(e=this.hostEntityTabService)||void 0===e?void 0:e.reconfigure(t,n);return Ar([r])}),{isRestrictedToMicrosoftOwnedApps:!0,errorCallback:e=>mr(Ve.reconfigure,e,[gv.errorCode],gv,e=>Ar([e]))}),this.registerHandler(Ve.rename,(e,t,n)=>c(this,void 0,void 0,function*(){var e;const r=yield null===(e=this.hostEntityTabService)||void 0===e?void 0:e.rename(t,n);return Ar([r])}),{isRestrictedToMicrosoftOwnedApps:!0,errorCallback:e=>mr(Ve.rename,e,[gv.errorCode],gv,e=>Ar([e]))}),this.registerHandler(Ve.remove,(e,t,n)=>c(this,void 0,void 0,function*(){var e;const r=yield null===(e=this.hostEntityTabService)||void 0===e?void 0:e.remove(t,n);return Ar([r])}),{isRestrictedToMicrosoftOwnedApps:!0,errorCallback:e=>mr(Ve.remove,e,[gv.errorCode],gv,e=>Ar([e]))}),this.registerHandler(Ve.getAll,(e,t)=>c(this,void 0,void 0,function*(){var e;const n=yield null===(e=this.hostEntityTabService)||void 0===e?void 0:e.getAll(t);return Ar([n])}),{isRestrictedToMicrosoftOwnedApps:!0,errorCallback:e=>mr(Ve.getAll,e,[gv.errorCode],gv,e=>Ar([e]))})}}function yv(e){return void 0!==e.dependentHubServiceSelector}const Sv={dependentHubServiceSelector:e=>e.interactiveService,messageHandlerFactory:(e,t,n)=>new bv(e,n,t)};class bv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.interactiveService=n}initHandlers(){this.registerHandler(Xe,()=>kr(this.getParamsWithOrigin({}),this.interactiveService.getFluidTenantInfo),{errorCallback:(e,t)=>yr(Xe,e,t)}),this.registerHandler(Qe,(e,t)=>kr(this.getParamsWithOrigin({containerId:t}),this.interactiveService.getFluidToken),{errorCallback:(e,t)=>yr(Qe,e,t)}),this.registerHandler(Je,()=>kr(this.getParamsWithOrigin({}),this.interactiveService.getFluidContainerId),{errorCallback:(e,t)=>yr(Je,e,t)}),this.registerHandler(Ye,(e,t)=>kr(this.getParamsWithOrigin({containerId:t}),this.interactiveService.setFluidContainerId),{errorCallback:(e,t)=>yr(Ye,e,t)}),this.registerHandler(Ze,()=>kr(this.getParamsWithOrigin({}),this.interactiveService.getNtpTime),{errorCallback:(e,t)=>yr(Ze,e,t)}),this.registerHandler(et,(e,t)=>kr(this.getParamsWithOrigin({clientId:t}),this.interactiveService.registerClientId),{errorCallback:(e,t)=>yr(et,e,t)}),this.registerHandler(tt,(e,t)=>kr(this.getParamsWithOrigin({clientId:t}),this.interactiveService.getClientRoles),{errorCallback:(e,t)=>yr(tt,e,t)}),this.registerHandler(nt,(e,t)=>kr(this.getParamsWithOrigin({clientId:t}),this.interactiveService.getClientInfo),{errorCallback:(e,t)=>yr(nt,e,t)})}getParamsWithOrigin(e){const t=this.appSdkHost.getOrigin();if(!t)throw"Origin not set of AppSdkHost";return Object.assign(Object.assign({},e),{origin:t})}}class wv{constructor(e){this.linkHandlers=e}tryGetDataFromLink(e){for(const t of this.linkHandlers){const n=t.tryGetDataFromLink(e);if(null!=n)return[t,n]}return null}executeData([e,t]){return e.executeData(t)}}class kv extends Np{constructor(e,t,n,r){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.linkService=n,this.linkHandler=r}initHandlers(){this.registerHandler(rt,(e,t)=>c(this,void 0,void 0,function*(){return yield this.executeLink(t),Ar(!0)}),{errorCallback:(e,t)=>Sr(rt,e,t)})}executeLink(e){try{const t=new URL(e);if(this.appSdkHost.getHubInfo().name!==Qd.teams&&this.appSdkHost.getHubInfo().name!==Qd.teamsModern&&this.linkHandler){const e=this.linkHandler.tryGetDataFromLink(t);if(null!=e)return this.linkHandler.executeData(e)}}catch(e){this.appSdkHost.getLogger().log(z.Error,"LinkMessageHandler","There is an error parsing the URL",e)}return this.linkService.openLink(e)}validateDependencies(){if(!this.linkService)throw"No linkService provided"}}class Ev{constructor(e){this.pageService=e}tryGetDataFromLink(e){if(!this.pageService)return null;if("https:"!==e.protocol)return null;if(e.origin!=jf)return null;if(!e.pathname.startsWith("/l/entity/"))return null;const t=e.pathname.substring(10).split("/");if(2!==t.length)return null;const n=t[0],r=t[1],i=e.searchParams.get("webUrl")||void 0,o=e.searchParams.get("context");let a,s,l;if(o)try{const e=JSON.parse(o);e&&"object"==typeof e&&(a=e.subEntityId,s=e.channelId,l=e.chatId)}catch(e){}return{appId:n,pageId:r,webUrl:i,subPageId:a,channelId:s,chatId:l}}executeData(e){return this.pageService.navigateToApp(e)}}const Av="location.map is not supported on this host.",Cv={dependentHubServiceSelector:e=>e.locationService&&e.devicePermissionService?{locationService:e.locationService,permissionsService:e.devicePermissionService}:void 0,messageHandlerFactory:(e,t,n)=>new Iv(e,n,t.permissionsService,t.locationService)};class Iv extends Np{constructor(e,t,n,r){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.permissionsService=n,this.locationService=r}initHandlers(){this.registerHandler(Ge,(e,t)=>this.handleGetCurrentLocation(t),{errorCallback:(e,t)=>yr(Ge,e,t)}),this.registerHandler(Ke.showLocation,(e,t)=>this.handleShowLocation(t),{errorCallback:(e,t)=>yr(Ke.showLocation,e,t)})}handleShowLocation(e){return c(this,void 0,void 0,function*(){if(this.locationService.mapService)return kr(e,this.locationService.mapService.showLocation);throw br(Zn.INTERNAL_ERROR,Av)})}handleGetCurrentLocation(e){return c(this,void 0,void 0,function*(){if(yield xr(this.permissionsService,dr.GeoLocation),!e.allowChooseLocation&&!e.showMap)return kr(e,this.locationService.getCurrentLocation);if(this.locationService.mapService)return this.handleGetLocationServiceInMap(e);throw br(Zn.INTERNAL_ERROR,Av)})}handleGetLocationServiceInMap(e){return c(this,void 0,void 0,function*(){return!e.allowChooseLocation&&e.showMap?kr(null,this.locationService.mapService.getCurrentLocationOnMap):kr(null,this.locationService.mapService.chooseLocation)})}}const Tv={dependentHubServiceSelector:e=>e.logService,messageHandlerFactory:(e,t,n)=>new xv(e,n,t)};class xv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.logService=n}initHandlers(){this.registerHandler(it,(e,t)=>Tr(this.logService.handleAppLog,t))}}const Rv={dependentHubServiceSelector:e=>e.mailService,messageHandlerFactory:(e,t,n)=>new Ov(e,n,t)};class Ov extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.mailService=n}initHandlers(){this.registerHandler(at,(e,t)=>c(this,void 0,void 0,function*(){return yield this.mailService.openMailItem(t),Ar([!0])}),{errorCallback:(e,t)=>Sr(at,e,t)}),this.registerHandler(ot,(e,t)=>c(this,void 0,void 0,function*(){return yield this.mailService.composeMail(t),Ar([!0])}),{errorCallback:(e,t)=>Sr(ot,e,t)})}}var Pv,Nv,Fv,Bv;!function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"}(Pv||(Pv={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(Nv||(Nv={})),function(e){e.GetCart="GetCart",e.AddOrUpdateCartItems="AddOrUpdateCartItems",e.RemoveCartItems="RemoveCartItems",e.UpdateCartStatus="UpdateCartStatus"}(Fv||(Fv={})),function(e){e[e.V1=1]="V1"}(Bv||(Bv={}));const Lv={dependentHubServiceSelector:e=>e.marketplaceService,messageHandlerFactory:(e,t,n)=>new Dv(e,n,t)};class Dv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.marketplaceService=n}initHandlers(){this.registerHandler(st,(e,t)=>this.dispatchMarketplaceHandlers(t,Fv.GetCart),{errorCallback:(e,t)=>yr(st,e,t)}),this.registerHandler(lt,(e,t)=>this.dispatchMarketplaceHandlers(t,Fv.AddOrUpdateCartItems),{errorCallback:(e,t)=>yr(lt,e,t)}),this.registerHandler(ct,(e,t)=>this.dispatchMarketplaceHandlers(t,Fv.RemoveCartItems),{errorCallback:(e,t)=>yr(ct,e,t)}),this.registerHandler(ut,(e,t)=>this.dispatchMarketplaceHandlers(t,Fv.UpdateCartStatus),{errorCallback:(e,t)=>yr(ut,e,t)})}dispatchMarketplaceHandlers(e,t){var n;let r;const i=t===Fv.GetCart?null==e?void 0:e.majorVersion:null===(n=null==e?void 0:e.cartVersion)||void 0===n?void 0:n.majorVersion;if(i!==Bv.V1)return Promise.reject({errorCode:Zn.NOT_SUPPORTED_ON_PLATFORM,message:`Cart version ${i} is not supported`});switch(r=this.marketplaceService,t){case Fv.GetCart:return kr(e,r.getCart);case Fv.AddOrUpdateCartItems:return kr(e,r.addOrUpdateCartItems);case Fv.RemoveCartItems:return kr(e,r.removeCartItems);case Fv.UpdateCartStatus:return kr(e,r.updateCartStatus);default:return Promise.reject({errorCode:Zn.NOT_SUPPORTED_ON_PLATFORM,message:`Marketplace method ${t} is not supported`})}}}const Hv={dependentHubServiceSelector:e=>e.mediaService,messageHandlerFactory:(e,t,n)=>new _v(e,n,t)};class _v extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.mediaService=n}initHandlers(){this.registerHandler(pt,(e,t)=>kr(t,this.mediaService.selectMedia),{errorCallback:(e,t)=>yr(pt,e,t)}),this.registerHandler(dt,e=>kr(Mv,this.mediaService.selectMedia),{errorCallback:(e,t)=>yr(pt,e,t)}),this.registerHandler(ft,(e,t)=>c(this,void 0,void 0,function*(){return yield this.mediaService.getMedia(t,t=>this.postMediaResult(rf(e.data),t)),Ir}),{errorCallback:this.onGetMediaError}),this.registerHandler(ht,(e,t)=>Cr(this.mediaService.viewImages,t),{errorCallback:(e,t)=>yr(ht,e,t)})}onGetMediaError(e,t){return null==t||t.fail(`GetMedia failed ${Rr(e)}`),Ar({error:vr})}postMediaResult(e,t){return t.mediaChunk?(t.mediaChunk.chunkSequence>0?this.appSdkHost.postResponseToApp(e,[t],!0):this.appSdkHost.postResponseToApp(e,[t],!1),Promise.resolve()):Promise.reject("empty media chunk")}}const Mv={mediaType:1,maxMediaCount:1,imageProps:{sources:[1,2],startMode:1,ink:!0,cameraSwitcher:!0,textSticker:!0,enableFilter:!1}},Uv={dependentHubServiceSelector:e=>e.meetingService,messageHandlerFactory:(e,t,n)=>new zv(e,n,t)};class zv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.meetingService=n}initHandlers(){this.registerHandler(yt,()=>kr(null,this.meetingService.getIncomingClientAudioState),{errorCallback:(e,t)=>yr(yt,e,t)}),this.registerHandler(It,()=>kr(null,this.meetingService.toggleIncomingClientAudio),{errorCallback:(e,t)=>yr(It,e,t)}),this.registerHandler(bt,(e,t)=>kr(t,this.meetingService.getMeetingDetails),{errorCallback:(e,t)=>yr(bt,e,t)}),this.registerHandler(mt,()=>kr(null,this.meetingService.getAuthenticationTokenForAnonymousUser),{errorCallback:(e,t)=>yr(mt,e,t),isRestrictedToFullTrustApps:!0}),this.registerHandler(St,()=>kr(null,this.meetingService.getLiveStreamState),{errorCallback:(e,t)=>yr(St,e,t)}),this.registerHandler(kt,(e,...t)=>Cr(this.meetingService.requestStartLiveStreaming,...t),{errorCallback:(e,t)=>yr(kt,e,t)}),this.registerHandler(Et,()=>kr(null,this.meetingService.requestStopLiveStreaming),{errorCallback:(e,t)=>yr(Et,e,t)}),this.registerHandler(At,(e,...t)=>c(this,void 0,void 0,function*(){const e=yield this.meetingService.shareAppContentToStage(...t);return Er(e)?Promise.reject(e):Ar([null,e])}),{errorCallback:(e,t)=>yr(At,e,t)}),this.registerHandler(wt.setOptions,(e,t)=>kr(t,this.meetingService.appShareButton.setOptions),{errorCallback:(e,t)=>yr(wt.setOptions,e,t)}),this.registerHandler(vt,()=>kr(null,this.meetingService.getAppContentStageSharingCapabilities),{errorCallback:(e,t)=>yr(vt,e,t)}),this.registerHandler(Ct,()=>kr(null,this.meetingService.stopSharingAppContentToStage),{errorCallback:(e,t)=>yr(Ct,e,t)}),this.registerHandler(gt,()=>kr(null,this.meetingService.getAppContentStageSharingState),{errorCallback:(e,t)=>yr(gt,e,t)}),this.registerHandler(Tt,(e,t)=>kr(t,this.meetingService.requestAppAudioHandling),{errorCallback:(e,t)=>yr(Tt,e,t)}),this.registerHandler(xt,(e,...t)=>Cr(this.meetingService.updateMicState,...t),{errorCallback:(e,t)=>yr(xt,e,t)}),this.registerHandler(Rt,(e,t)=>kr(Object.assign(Object.assign({},t),{joinWebUrl:new URL(t.joinWebUrl)}),this.meetingService.joinMeeting),{errorCallback:(e,t)=>yr(Rt,e,t)})}}const jv={dependentHubServiceSelector:e=>e.meetingRoomService,messageHandlerFactory:(e,t,n)=>new $v(e,n,t)};class $v extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.meetingRoomService=n}initHandlers(){this.registerHandler(Ot,()=>kr(null,this.meetingRoomService.getPairedMeetingRoomInfo),{errorCallback:(e,t)=>yr(Ot,e,t)}),this.registerHandler(Pt,(e,t)=>kr(t,this.meetingRoomService.sendCommandToPairedMeetingRoom),{errorCallback:(e,t)=>yr(Pt,e,t)})}}class Wv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.messageChannelsService=n}initHandlers(){this.registerHandler(vn.getDataLayerPort,e=>c(this,void 0,void 0,function*(){const t=yield this.messageChannelsService.dataLayer.getDataLayerPort();return this.appSdkHost.postResponseToApp(rf(e.data),void 0,void 0,[t]),Ir}),{isRestrictedToMicrosoftOwnedApps:!0,errorCallback:(e,t)=>yr(vn.getDataLayerPort,e,t)})}validateDependencies(){var e;if(!(null===(e=this.messageChannelsService)||void 0===e?void 0:e.dataLayer))throw"No data layer service for message channels provided"}}class qv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.messageChannelsService=n}initHandlers(){this.registerHandler(hn.getTelemetryPort,e=>c(this,void 0,void 0,function*(){const t=yield this.messageChannelsService.telemetry.getTelemetryPort();return this.appSdkHost.postResponseToApp(rf(e.data),void 0,void 0,[t]),Ir}),{isRestrictedToMicrosoftOwnedApps:!0,errorCallback:(e,t)=>yr(hn.getTelemetryPort,e,t)})}validateDependencies(){var e;if(!(null===(e=this.messageChannelsService)||void 0===e?void 0:e.telemetry))throw"No telemetry service provided for message channels"}}const Vv={dependentHubServiceSelector:e=>e.monetizationService,messageHandlerFactory:(e,t,n)=>new Gv(e,n,t)};class Gv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.monetizationService=n}initHandlers(){this.registerHandler(Nt,(e,t)=>Cr(this.monetizationService.openPurchaseExperience,t),{errorCallback:(e,t)=>yr(Nt,e,t)})}}const Kv={dependentHubServiceSelector:e=>e.nestedAppAuthService,messageHandlerFactory:(e,t,n)=>new Xv(e,n,t)};class Xv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.nestedAppAuthService=n,this.RESPONSE_STATUS_KEY="ResponseStatus",this.ERROR_CODE_KEY="ErrorCode",this.SUB_ERROR_KEY="SubError",this.MSAL_TIMESTAMP_KEY="MsalTimestamp",this.CORRELATION_ID_KEY="CorrelationId",this.IS_DEEPLY_NESTED_REQUEST_KEY="IsDeeplyNestedRequest",this.REQUEST_METHOD_NAME="MethodName"}initHandlers(){this.registerHandler(Ft,(e,t)=>{var n;let r=e;this.isValidRequest(r);const i=new URL(r.origin),o=null!==(n=r.isTrustedOrigin)&&void 0!==n&&n;return this.logRequestTelemetry(r,t),kr({payload:r.data.data,origin:i},e=>c(this,void 0,void 0,function*(){t.markPhase("MessagePreprocessing",!0);const n=yield this.nestedAppAuthService.execute(e.payload,e.origin,o);return t.markPhase("HubProcessing",!0),this.logResponseTelemetry(n,t),n}))},{errorCallback:(e,t)=>yr(Ft,e,t)})}logRequestTelemetry(e,t){var n;if(e.data&&"object"==typeof e.data&&"string"==typeof(null===(n=e.data)||void 0===n?void 0:n.data)){try{const n=JSON.parse(e.data.data),{sendTime:r,method:i,tokenParams:o}=n||{};t.addOrUpdateActivityDataField(this.MSAL_TIMESTAMP_KEY,r),t.addOrUpdateActivityDataField(this.REQUEST_METHOD_NAME,i);const a=null==o?void 0:o.correlationId;qd(a)&&t.addOrUpdateActivityDataField(this.CORRELATION_ID_KEY,a)}catch(e){const t="Unable to log NAA payload properties in telemetry due to unknown type";this.appSdkHost.getLogger().log(z.Warn,t,e)}t.addOrUpdateActivityDataField(this.IS_DEEPLY_NESTED_REQUEST_KEY,e.isDeeplyNestedRequest)}}logResponseTelemetry(e,t){try{const{success:n,error:r}=JSON.parse(e);if(!n){if(r){const{status:e,code:n}=r;t.addOrUpdateActivityDataField(this.RESPONSE_STATUS_KEY,e),t.addOrUpdateActivityDataField(this.ERROR_CODE_KEY,n)}t.fail(`Nested app auth request failed: ${(null==r?void 0:r.status)||"unknown status"}`)}}catch(e){}}isValidRequest(e){if(e.isDeeplyNestedRequest&&!this.nestedAppAuthService.isDeeplyNestedAuthSupported())throw br(Zn.NOT_SUPPORTED_ON_PLATFORM,"Deeply nested request is not supported");return!0}}const Qv={dependentHubServiceSelector:e=>e.notificationService,messageHandlerFactory:(e,t,n)=>new Jv(e,n,t)};class Jv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.notificationService=n}initHandlers(){this.registerHandler(Bt,(e,t)=>Tr(this.notificationService.showNotification,t),{isRestrictedToFullTrustApps:!0})}}const Yv={dependentHubServiceSelector:e=>e.otherAppStateChangeService,messageHandlerFactory:(e,t,n)=>new Zv(e,n,t)};class Zv extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.otherAppStateChangeService=n}initHandlers(){this.registerHandler(Lt,e=>(this.otherAppStateChangeService.clearListeners(),Promise.resolve(Ir)),{}),this.registerHandler(Dt,(e,t)=>(this.otherAppStateChangeService.notifyInstallCompleted(new Pp(t)),Promise.resolve(Ir)),{})}canHandleMessage(e){var t,n;if(!super.canHandleMessage(e))return!1;switch(e){case Lt:return hf(this.appDefinition);case Dt:return!!(n=null===(t=this.appDefinition)||void 0===t?void 0:t.id)&&Hn.has(n.toLowerCase());default:return!1}}}class eg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.configService=n}initHandlers(){if(this.appSdkHost.getFrameContext()===tf.settings&&!this.configService)throw new Error("Config Service needs to be implemented when in settings frame context");this.registerHandler(Vt.setConfig,(e,t)=>Cr(this.configService.setConfig,t),{errorCallback:(e,t)=>Sr(Vt.setConfig,e,t)}),this.registerHandler(Vt.setValidityState,(e,t)=>Tr(this.configService.setValidityState,t)),this.registerHandler(Vt.save.success,e=>Tr(this.configService.onSaveSuccess)),this.registerHandler(Vt.save.failure,(e,t)=>Tr(this.configService.onSaveFailure,t)),this.registerHandler(Vt.remove.success,e=>Tr(this.configService.onRemoveSuccess)),this.registerHandler(Vt.remove.failure,(e,t)=>Tr(this.configService.onRemoveFailure,t))}validateDependencies(){if(!this.configService)throw"No configService provided"}}const tg={dependentHubServiceSelector:e=>e.pageService,messageHandlerFactory:(e,t,n)=>new ng(e,n,t)};class ng extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.pageService=n,this.getConfig=()=>c(this,void 0,void 0,function*(){const e=this.pageService&&this.pageService.getConfig?yield this.pageService.getConfig():this.getDefaultConfig();return Ar(e)})}initHandlers(){this.registerHandler(Ht,this.getConfig),this.registerHandler(Ut,(e,t,n)=>Tr(this.pageService.returnFocus,t,n)),this.registerHandler(zt,this.handleSetCurrentFrame),this.registerHandler(_t,this.handleLoadCrossDomainUrl,{errorCallback:(e,t)=>Sr(_t,e,t)}),this.registerHandler(Mt,(e,t)=>c(this,void 0,void 0,function*(){return yield this.pageService.navigateToApp(t),Ar(!0)}),{errorCallback:(e,t)=>Sr(Mt,e,t)}),this.registerHandler(jt,(e,t,n,r)=>Tr(this.pageService.shareDeepLink,{subEntityId:t,subEntityLabel:n,subEntityWebUrl:r})),this.registerHandler(Wt.navigateTo,this.buildParamsAndCallNavigateToApp,{errorCallback:(e,t)=>yr(Wt.navigateTo,e,t)}),this.registerHandler(Wt.navigateToDefaultPage,this.buildParamsAndCallNavigateToApp,{errorCallback:(e,t)=>yr(Wt.navigateToDefaultPage,e,t)})}getDefaultConfig(){const e=this.appSdkHost.getOrigin();if(!e)throw new Error("Origin not set of AppSdkHost");const t=this.appSdkHost.getContext(),n=this.appSdkHost.getAppDefinition(),r=n&&Wf(n,t.page.id);return{contentUrl:e,entityId:t.page.id,suggestedDisplayName:r}}handleSetCurrentFrame(e,t){return c(this,void 0,void 0,function*(){const e=yield this.appSdkHost.getAppContext(),n=this.appSdkHost.getLogger();try{df(t.contentUrl,n,e,this.appDefinition)&&df(t.websiteUrl,n,e,this.appDefinition)&&this.pageService.setCurrentFrame(t)}catch(e){n.log(z.Error,"handleSetCurrentFrame",Un,null)}return Ir})}handleLoadCrossDomainUrl(e,t){return c(this,void 0,void 0,function*(){const e=this.appSdkHost.getLogger();try{if(df(t,e,yield this.appSdkHost.getAppContext(),this.appDefinition))return yield this.appSdkHost.load(t,yield this.appSdkHost.getAppContext()),Ar(!0)}catch(t){e.log(z.Error,"handleLoadCrossDomainUrl",Un,null)}throw Un})}buildParamsAndCallNavigateToApp(e,t){return c(this,void 0,void 0,function*(){let e;const n=this.appSdkHost.getAppDefinition();if(!(null==n?void 0:n.id))throw br(Zn.INTERNAL_ERROR,"An error ocurred while locating application ID");let r;e=t?{appId:null==n?void 0:n.id,pageId:t.pageId,subPageId:t.subPageId}:{appId:null==n?void 0:n.id,pageId:(null==n?void 0:n.pages.static[0].entityId)?n.pages.static[0].entityId:""};try{r=kr(e,this.pageService.navigateToApp)}catch(e){throw br(Zn.INTERNAL_ERROR,e)}return r})}}class rg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.pageTabsService=n}initHandlers(){this.registerHandler(qt.navigateToTab,(e,t)=>Cr(this.pageTabsService.navigateToTab,t),{errorCallback:(e,t)=>Sr(qt.navigateToTab,e,t)}),this.registerHandler(qt.getTabInstances,(e,t)=>Cr(this.pageTabsService.getTabInstances,t),{errorCallback:(e,t)=>this.onGetTabsError(qt.getTabInstances,e,t)}),this.registerHandler(qt.getMruTabInstances,(e,t)=>Cr(this.pageTabsService.getMruTabInstances,t),{errorCallback:(e,t)=>this.onGetTabsError(qt.getMruTabInstances,e,t)})}validateDependencies(){if(!this.pageTabsService)throw"No pageTabsService provided"}onGetTabsError(e,t,n){return null==n||n.fail(`${e} failed ${Rr(t)}`),Ar({teamTabs:[]})}}class ig extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.backStackService=n}initHandlers(){this.registerHandler($t.navigateBack,e=>Cr(this.backStackService.navigateBack),{errorCallback:(e,t)=>Sr($t.navigateBack,e,t)})}validateDependencies(){if(!this.backStackService)throw"No backStackService provided"}}class og extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.fullTrustService=n}initHandlers(){this.registerHandler(Gt.enterFullscreen,e=>Tr(this.fullTrustService.enterFullscreen),{isRestrictedToFullTrustApps:!0}),this.registerHandler(Gt.exitFullscreen,e=>Tr(this.fullTrustService.exitFullscreen),{isRestrictedToFullTrustApps:!0})}validateDependencies(){if(!this.fullTrustService)throw"No fullTrustService provided"}}const ag={dependentHubServiceSelector:e=>e.peopleService,messageHandlerFactory:(e,t,n)=>new sg(e,n,t)};class sg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.peopleService=n}initHandlers(){this.registerHandler(Kt,(e,t)=>kr(t,this.peopleService.selectPeople),{errorCallback:(e,t)=>yr(Kt,e,t)})}}const lg={dependentHubServiceSelector:e=>e.devicePermissionService,messageHandlerFactory:(e,t,n)=>new cg(e,n,t)};class cg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.permissionsService=n}initHandlers(){this.registerHandler(Qt,(e,t)=>this.handleRequestUserConsentAndStorePermissions(t),{errorCallback:(e,t)=>yr(Qt,e,t)}),this.registerHandler(Xt.getPermissionStatus,(e,t)=>kr(t,this.permissionsService.storageService.getPermissionStatus,e=>e==fr.Consented),{errorCallback:(e,t)=>yr(Xt.getPermissionStatus,e,t)})}handleRequestUserConsentAndStorePermissions(e){return c(this,void 0,void 0,function*(){this.verifyPermissionsInManifest(e);const t=yield this.checkPermissionsInStorage(e);if(t!==fr.NeverAsked)return Ar([null,t==fr.Consented]);const n=yield this.requestUserConsent(e);return yield this.storePermissions(n),Ar([null,n.status==fr.Consented])})}verifyPermissionsInManifest(e){if(!this.appDefinition.devicePermissions.some(t=>t.toLowerCase()===e.toString().toLowerCase()))throw br(Zn.INTERNAL_ERROR,"permission does not exist in the app manifest")}checkPermissionsInStorage(e){return c(this,void 0,void 0,function*(){return yield this.permissionsService.storageService.getPermissionStatus(e)})}requestUserConsent(e){return c(this,void 0,void 0,function*(){let t;try{t=yield this.permissionsService.requestUserConsentForPermission(e)}catch(e){throw br(Zn.INTERNAL_ERROR,"An error occurred while requesting the user consent for permissions")}return t})}storePermissions(e){return c(this,void 0,void 0,function*(){yield this.permissionsService.storageService.storePermissionConsent(e)})}}const ug={dependentHubServiceSelector:e=>e.profileService,messageHandlerFactory:(e,t,n)=>new dg(e,n,t)};class dg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.profileService=n}initHandlers(){this.registerHandler(Jt,(e,t)=>{const n=this.appSdkHost.getFrame(),{x:r,y:i}=n?n.getBoundingClientRect():{x:0,y:0},o=DOMRect.fromRect({x:t.targetRectangle.x+r,y:t.targetRectangle.y+i,width:t.targetRectangle.width,height:t.targetRectangle.height}),a={modality:t.modality,persona:t.persona,targetElementBoundingRect:o,triggerType:t.triggerType};return kr(a,this.profileService.showProfile)},{errorCallback:(e,t)=>yr(Jt,e,t)})}}class fg extends Np{constructor(e,t,n,r,i,o,a,s,l,c,u,d,f){if(super(e,t),this.appSdkHost=e,this.telemetryService=t,this.bootstrapRegistrationState=f,this.registeredHandlers=new Map,this.userSettings=[],this.cacheabilityDataService=n,this.registerHandlerImpl("themeChange",t=>e.onThemeChanged=e=>t({data:e}),"eventDispatch.themeChange"),this.registerHandlerImpl("userSettingsChange",t=>e.onUserSettingsChanged=(e,n)=>this.userSettings.includes(e)&&t({data:[e,n]}),"eventDispatch.userSettingsChange",!0),o&&(o.clearListeners(),this.registerHandlerImpl("log.request",e=>o.addEventListener("log.request",e),"eventDispatch.log.request",!1,{isRestrictedToFullTrustApps:!0})),s&&(s.clearListeners(),this.registerHandlerImpl("meeting.liveStreamChanged",e=>s.addEventListener("liveStreamChanged",e),"eventDispatch.meeting.liveStreamChanged"),this.registerHandlerImpl("meeting.raiseHandStateChanged",e=>s.addEventListener("raiseHandStateChanged",e),"eventDispatch.meeting.raiseHandStateChanged"),this.registerHandlerImpl("meeting.speakingStateChanged",e=>s.addEventListener("speakingStateChanged",e),"eventDispatch.meeting.speakingStateChanged"),this.registerHandlerImpl("meeting.meetingReactionReceived",e=>s.addEventListener("meetingReactionReceived",e),"eventDispatch.meeting.meetingReactionReceived"),this.registerHandlerImpl("meeting.micStateChanged",e=>s.addEventListener("micStateChanged",e),"eventDispatch.meeting.micStateChanged"),this.registerHandlerImpl("meeting.audioDeviceSelectionChanged",e=>s.addEventListener("audioDeviceSelectionChanged",e),"eventDispatch.meeting.audioDeviceSelectionChanged")),l&&(l.clearListeners(),this.registerHandlerImpl("meetingRoom.meetingRoomCapabilitiesUpdate",e=>l.addEventListener("meetingRoomCapabilitiesUpdate",e),"eventDispatch.meetingRoomCapabilitiesUpdate"),this.registerHandlerImpl("meetingRoom.meetingRoomStatesUpdate",e=>l.addEventListener("meetingRoomStatesUpdate",e),"eventDispatch.meetingRoomStatesUpdate")),u&&(u.clearListeners(),this.registerHandlerImpl("search.queryChange",e=>u.addEventListener("queryChange",e),"eventDispatch.search.queryChange"),this.registerHandlerImpl("search.queryClose",e=>u.addEventListener("queryClose",e),"eventDispatch.search.queryClose"),this.registerHandlerImpl("search.queryExecute",e=>u.addEventListener("queryExecute",e),"eventDispatch.search.queryExecute")),i){if(i.clearListeners(),this.registerHandlerImpl("fullScreenChange",e=>i.addEventListener("fullScreenChange",e),"eventDispatch.fullScreenChange"),this.registerHandlerImpl("focusEnter",e=>i.addEventListener("focusEnter",t=>{let n=t;n.data="boolean"!=typeof t.data?t.data:[t.data],e(n)}),"eventDispatch.focusEnter",!0),i.appButtonService){const e=i.appButtonService;e.clearListeners(),this.registerHandlerImpl("appButtonClick",t=>e.addEventListener("click",t),"eventDispatch.appButtonClick"),this.registerHandlerImpl("appButtonHoverEnter",t=>e.addEventListener("hoverEnter",t),"eventDispatch.appButtonHoverEnter"),this.registerHandlerImpl("appButtonHoverLeave",t=>e.addEventListener("hoverLeave",t),"eventDispatch.appButtonHoverLeave")}if(i.configService){const e=i.configService;e.clearListeners(),this.registerHandlerImpl("changeSettings",t=>e.addEventListener("changeSettings",t),"eventDispatch.changeSettings"),e.addEventListener("settings.save",e=>{this.logEventDispatchScenario("eventDispatch.settings.save"),this.appSdkHost.sendRequestMessage("settings.save",e.data?[e.data]:[])}),e.addEventListener("settings.remove",e=>{this.logEventDispatchScenario("eventDispatch.settings.remove"),this.appSdkHost.sendRequestMessage("settings.remove",e.data?[e.data]:[])})}if(i.backStackService){const e=i.backStackService;e.clearListeners(),this.registerHandlerImpl("backButton",t=>e.addEventListener("backButton",t),"eventDispatch.backButtonPress",!1,{eventRaiseType:"backButtonPress"})}}c&&(c.clearListeners(),this.registerHandlerImpl("remoteCamera.capableParticipantsChange",e=>c.addEventListener("capableParticipantsChange",e),"eventDispatch.remoteCamera.capableParticipantsChange"),this.registerHandlerImpl("remoteCamera.handlerError",e=>c.addEventListener("handlerError",e),"eventDispatch.remoteCamera.handlerError"),this.registerHandlerImpl("remoteCamera.deviceStateChange",e=>c.addEventListener("deviceStateChange",e),"eventDispatch.remoteCamera.deviceStateChange"),this.registerHandlerImpl("remoteCamera.sessionStatusChange",e=>c.addEventListener("sessionStatusChange",e),"eventDispatch.remoteCamera.sessionStatusChange")),a&&this.registerHandlerImpl("video.mediaStream.audioInferenceDiscardStatusChange",e=>a.addEventListener("audioInferenceDiscardStatusChange",e),"eventDispatch.video.mediaStream.audioInferenceDiscardStatusChange"),d&&hf(this.appSdkHost.getAppDefinition())&&this.registerHandlerImpl("otherApp.install",e=>d.addEventListener("install",e),"eventDispatch.otherApp.install"),this.registerHandlerImpl("load",e=>{},"eventDispatch.load"),this.registerHandlerImpl("beforeUnload",e=>{},"eventDispatch.beforeUnload"),this.registeredHandlers.set("currentFreeMemoryInMb",()=>{null==n||n.addEventListener("currentFreeMemoryInMb",e=>{var t;this.logEventDispatchScenario("eventDispatch.currentFreeMemoryInMb"),null===(t=null==r?void 0:r.auditAndRemoveCachedApps)||void 0===t||t.call(r,{currentFreeMemoryInMb:e.data,currentMemoryUsageInMb:void 0})})}),this.registeredHandlers.set("hostMemoryConsumptionInMb",()=>{null==n||n.addEventListener("hostMemoryConsumptionInMb",e=>{var t;this.logEventDispatchScenario("eventDispatch.hostMemoryConsumptionInMb"),null===(t=null==r?void 0:r.auditAndRemoveCachedApps)||void 0===t||t.call(r,{currentMemoryUsageInMb:e.data,currentFreeMemoryInMb:void 0})})}),this.registeredHandlers.set("removeAppFromCache",()=>{null==n||n.addEventListener("removeAppFromCache",()=>{var e;this.logEventDispatchScenario("eventDispatch.removeAppFromCache");try{const e=this.appSdkHost.getCacheablePageInfo();null==r||r.removeAppFromCache(e,Nn.HostExplicitRemoval)}catch(t){this.appSdkHost.getLogger().log(z.Error,"RegisterHandlerMessageHandler",t),console.error("failed to remove app from cache",null===(e=this.appDefinition)||void 0===e?void 0:e.id)}})})}initHandlers(){var e,t,n;this.registerHandler(nn,(e,t,n)=>c(this,void 0,void 0,function*(){return n&&(this.userSettings=n),this.isValidRegistrationType(t)&&(this.registeredHandlers.get(t)(),this.appSdkHost.saveCacheableRegistrationState(t,this.userSettings)),Ir})),this.cacheabilityDataService&&(null===(e=this.registeredHandlers.get("currentFreeMemoryInMb"))||void 0===e||e(),null===(t=this.registeredHandlers.get("hostMemoryConsumptionInMb"))||void 0===t||t(),null===(n=this.registeredHandlers.get("removeAppFromCache"))||void 0===n||n()),this.bootstrapRegistrationState&&this.runRegisteredHandlers(this.bootstrapRegistrationState)}isValidRegistrationType(e){return this.registeredHandlers.has(e)}runRegisteredHandlers(e){var t,n;let r;try{for(r in e)this.registeredHandlers.has(r)&&(qf(r)&&(null===(t=e.userSettingsChange)||void 0===t?void 0:t.userSettingTypes)&&(this.userSettings=e.userSettingsChange.userSettingTypes),null===(n=this.registeredHandlers.get(r))||void 0===n||n())}catch(e){this.appSdkHost.getLogger().log(z.Error,"RegisterHandlerMessageHandler","failed to run registered handlers")}}registerHandlerImpl(e,t,n,r=!1,i){if(this.registeredHandlers.has(e))throw new Error("handler already registered");this.registeredHandlers.set(e,()=>{var o;if((null==i?void 0:i.isRestrictedToFullTrustApps)&&!(null===(o=this.appSdkHost.getAppDefinition())||void 0===o?void 0:o.isFullTrust))throw br(Zn.INTERNAL_ERROR,Vn);t(t=>{var o;this.logEventDispatchScenario(n),r||null==t.data||(t.data=[t.data]),this.appSdkHost.sendRequestMessage(null!==(o=null==i?void 0:i.eventRaiseType)&&void 0!==o?o:e,t.data?t.data:[])})})}logEventDispatchScenario(e){var t;const n=null===(t=this.telemetryService)||void 0===t?void 0:t.createScenario(e,void 0,void 0,"unknown");null==n||n.stop()}}const pg={dependentHubServiceSelector:e=>e.remoteCameraService,messageHandlerFactory:(e,t,n)=>new hg(e,n,t)};class hg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.remoteCameraService=n}initHandlers(){this.registerHandler(Yt,()=>kr(null,this.remoteCameraService.getCapableParticipants),{errorCallback:(e,t)=>yr(Yt,e,t)}),this.registerHandler(Zt,(e,t)=>kr(t,this.remoteCameraService.requestControl),{errorCallback:(e,t)=>yr(Zt,e,t)}),this.registerHandler(en,(e,t)=>Cr(this.remoteCameraService.sendControlCommand,t),{errorCallback:(e,t)=>yr(en,e,t)}),this.registerHandler(tn,()=>Cr(this.remoteCameraService.terminateSession),{errorCallback:(e,t)=>yr(tn,e,t)})}}const vg={dependentHubServiceSelector:e=>e.searchService,messageHandlerFactory:(e,t,n)=>new gg(e,n,t)};class gg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.searchService=n}initHandlers(){this.registerHandler(rn,e=>(this.searchService.clearListeners(),Promise.resolve(Ir)),{}),this.registerHandler(on,e=>c(this,void 0,void 0,function*(){return yield this.searchService.closeSearch(),Ar([!0])}),{errorCallback:(e,t)=>Sr(on,e,t)})}}const mg={dependentHubServiceSelector:e=>e.sharingService,messageHandlerFactory:(e,t,n)=>new yg(e,n,t)};class yg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.sharingService=n}initHandlers(){this.registerHandler(an,(e,t)=>Cr(this.sharingService.shareWebContent,t),{errorCallback:(e,t)=>yr(an,e,t)}),this.registerHandler(sn.getContent,()=>c(this,void 0,void 0,function*(){const e=yield this.sharingService.historyService.getContent();return Ar([null,e])}),{errorCallback:(e,t)=>yr(sn.getContent,e,t)})}}var Sg;!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(Sg||(Sg={}));const bg={dependentHubServiceSelector:e=>e.stageViewService,messageHandlerFactory:(e,t,n)=>new wg(e,n,t)};class wg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.stageViewService=n}initHandlers(){this.registerHandler(ln,(e,t)=>kr(t,this.stageViewService.open),{errorCallback:(e,t)=>yr(ln,e,t)})}}class kg{constructor(e,t){this.stageViewService=e,this.logger=t}tryGetDataFromLink(e){var t;if(!this.stageViewService)return null;if(e.origin!=jf)return null;const n=e.pathname.match(kg.STAGE_VIEW_URL_REGEX);if(!n)return null;const r=n[1],i=e.searchParams.get("context");if(!i)return null;let o;try{o=JSON.parse(i)}catch(e){return null===(t=this.logger)||void 0===t||t.log(z.Error,"StageViewLegacyLinkHandler","There is an error parsing the URL",e),null}const a=o.contentUrl;if(!a)return null;const s=o.title||void 0;return{appId:r,contentUrl:a,threadId:o.threadId||void 0,title:s,websiteUrl:o.websiteUrl||void 0,entityId:o.entityId||void 0,openMode:o.openMode in Sg?o.openMode:void 0,messageId:o.messageId||void 0}}executeData(e){return this.stageViewService.open(e)}}kg.STAGE_VIEW_URL_REGEX=/^\/l\/stage\/([^\/]+)\/?0$/;class Eg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.stageViewSelfService=n}initHandlers(){this.registerHandler(cn.close,e=>kr(null,this.stageViewSelfService.close),{errorCallback:(e,t)=>yr(cn.close,e,t)})}}var Ag;!function(e){e.FullStore="fullstore",e.SpecificStore="specificstore",e.InContextStore="ics",e.AppDetail="appdetail"}(Ag||(Ag={}));const Cg=br(Zn.INTERNAL_ERROR,"Invalid store dialog size"),Ig={dependentHubServiceSelector:e=>e.storeService,messageHandlerFactory:(e,t,n)=>new Tg(e,n,t)};class Tg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.storeService=n}validateDependencies(){if(!this.storeService)throw"store service not supported"}initHandlers(){this.registerHandler(un,(e,t,n,r,i)=>c(this,void 0,void 0,function*(){let e;if(e=t===Ag.SpecificStore?{dialogType:t,collectionId:r}:t===Ag.AppDetail?{dialogType:t,appId:n}:{dialogType:t},void 0!==i){const t=JSON.parse(i),n=null==t?void 0:t.width,r=null==t?void 0:t.height;if(void 0!==n&&"number"==typeof n&&n<0)throw Cg;if(void 0!==r&&"number"==typeof r&&r<0)throw Cg;e=Object.assign(Object.assign({},e),{size:{width:n,height:r}})}return yield this.storeService.openStoreExperience(e),Ar()}),{isRestrictedToMicrosoftOwnedOrFullTrustApps:!0,errorCallback:(e,t)=>yr(un,e,t)})}}class xg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.joinedTeamsService=n}initHandlers(){this.registerHandler(pn.joinedTeams.getUserJoinedTeams,(e,t)=>Cr(this.joinedTeamsService.getUserJoinedTeams,t),{isRestrictedToFullTrustApps:!0})}validateDependencies(){if(!this.joinedTeamsService)throw"No joinedTeamsService provided"}}class Rg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.fullTrustService=n}initHandlers(){this.registerHandler(pn.getConfigSetting,(e,t)=>Cr(this.fullTrustService.getConfigSetting,t),{isRestrictedToFullTrustApps:!0})}validateDependencies(){if(!this.fullTrustService)throw"No fullTrustService provided"}}const Og={dependentHubServiceSelector:e=>e.teamsService,messageHandlerFactory:(e,t,n)=>new Pg(e,n,t)};class Pg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.teamsService=n}initHandlers(){this.registerHandler(dn,(e,t)=>kr(t,this.teamsService.getTeamChannels),{errorCallback:(e,t)=>yr(dn,e,t),isRestrictedToFullTrustApps:!1}),this.registerHandler(fn,(e,t)=>kr(t,this.teamsService.refreshSiteUrl),{errorCallback:(e,t)=>yr(fn,e,t),isRestrictedToFullTrustApps:!1})}}const Ng={dependentHubServiceSelector:e=>e.thirdPartyCloudStorageService,messageHandlerFactory:(e,t,n)=>new Fg(e,n,t)};class Fg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.thirdPartyCloudStorageService=n}initHandlers(){this.registerHandler(gn,(e,t)=>c(this,void 0,void 0,function*(){return yield this.thirdPartyCloudStorageService.getDragAndDropFiles(t,t=>this.callGetDragAndDropFiles(rf(e.data),t)),Ir}),{errorCallback:(e,t)=>yr(gn,e,t)})}callGetDragAndDropFiles(e,t){return t.fileChunk?(t.fileChunk.chunkSequence>0?this.appSdkHost.postResponseToApp(e,[t],!0):this.appSdkHost.postResponseToApp(e,[t],!1),Promise.resolve()):Promise.reject("Received an empty file chunk from the host")}}class Bg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.mediaStreamService=n}initHandlers(){this.registerHandler(yn.registerForVideoFrame,(e,t)=>c(this,void 0,void 0,function*(){return this.mediaStreamService.addEventListener("setFrameProcessTimeLimit",e=>{this.appSdkHost.sendRequestMessage(xn,[e.data])}),(yield this.mediaStreamService.registerForVideoFrame(t))&&this.mediaStreamService.addEventListener("mediaStreamChangedEvent",e=>{const{streamId:t,metadataInTexture:n}=e.data;t&&this.appSdkHost.sendRequestMessage(En,[{streamId:t,metadataInTexture:n}])}),Ir}))}validateDependencies(){if(!this.mediaStreamService)throw new Error("No mediaStreamService provided")}}var Lg,Dg,Hg;!function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(Lg||(Lg={})),function(e){e.Fatal="fatal",e.Warn="warn"}(Dg||(Dg={})),function(e){e.NV12="NV12"}(Hg||(Hg={}));const _g={dependentHubServiceSelector:e=>e.videoExtensibilityService,messageHandlerFactory:(e,t,n)=>new Mg(e,n,t)};class Mg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.videoExtensibilityService=n}initHandlers(){this.registerHandler(wn,e=>c(this,void 0,void 0,function*(){return this.videoExtensibilityService.addEventListener("videoEffectToApply",e=>{const t=[e.data.effectId];e.data.effectParameter&&t.push(e.data.effectParameter),this.appSdkHost.sendRequestMessage(mn,t)}),this.videoExtensibilityService.registerForVideoEffect(),Ir})),this.registerHandler(An,(e,t,n,r)=>c(this,void 0,void 0,function*(){return this.videoExtensibilityService.videoEffectPickedInVideoApp(t,n,r),Ir})),this.registerHandler(Cn,(e,t,n,r,i)=>c(this,void 0,void 0,function*(){return this.videoExtensibilityService.setVideoEffectAppliedResult(t,n,r,i),Ir})),this.registerHandler(bn,(e,t)=>c(this,void 0,void 0,function*(){return this.videoExtensibilityService.personalizedEffectsChanged(t),Ir})),this.registerHandler(Sn,(e,t,n)=>c(this,void 0,void 0,function*(){return this.videoExtensibilityService.notifyError(t,n||Dg.Warn),Ir})),this.registerHandler(Tn.firstFrameProcessed,(e,t,n,r)=>c(this,void 0,void 0,function*(){const e=parseInt(t);if(isNaN(e))throw new Error("Invalid firstFrameProcessed timestamp");return this.videoExtensibilityService.firstFrameProcessed(parseInt(t),n,r),Ir})),this.registerHandler(Tn.frameProcessingSlow,(e,t)=>c(this,void 0,void 0,function*(){return this.videoExtensibilityService.frameProcessingSlow(t),Ir})),this.registerHandler(Tn.performanceDataGenerated,(e,t)=>c(this,void 0,void 0,function*(){return this.videoExtensibilityService.performanceDataGenerated(t),Ir})),this.registerHandler(Tn.textureStreamAcquired,(e,t,n)=>c(this,void 0,void 0,function*(){return this.videoExtensibilityService.textureStreamAcquired(t,n),Ir}))}validateDependencies(){if(!this.videoExtensibilityService.mediaStreamService&&!this.videoExtensibilityService.sharedFrameService)throw new Error("Either mediaStreamService or sharedFrameService should be provided")}}class Ug extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.sharedFrameService=n}initHandlers(){this.registerHandler(kn.registerForVideoFrame,(e,t)=>c(this,void 0,void 0,function*(){return this.sharedFrameService.addEventListener("setFrameProcessTimeLimit",e=>{this.appSdkHost.sendRequestMessage(xn,[e.data])}),(yield this.sharedFrameService.registerForVideoFrame(t))&&this.sharedFrameService.addEventListener("ipcChangedEvent",e=>{const{frameProcessedEventName:t,frameReadyEventName:n,sharedMemoryName:r}=e.data;this.appSdkHost.sendRequestMessage(In,[{frameProcessedEventName:t,frameReadyEventName:n,sharedMemoryName:r}])}),Ir}))}validateDependencies(){if(!this.sharedFrameService)throw new Error("No sharedFrameService provided")}}const zg={dependentHubServiceSelector:e=>e.webStorageService,messageHandlerFactory:(e,t,n)=>new jg(e,n,t)};class jg extends Np{constructor(e,t,n){super(e,t),this.appSdkHost=e,this.telemetryService=t,this.webStorageService=n}initHandlers(){this.registerHandler(Rn,()=>c(this,void 0,void 0,function*(){return Ar(yield this.webStorageService.isWebStorageClearedOnUserLogOut())}),{errorCallback:(e,t)=>Sr(Rn,e,t)})}}const $g=[zp,$p,sh,ch,dh,vh,yh,kh,Ah,nv,Wh,cv,av,fv,hv,Sv,Cv,Tv,Rv,Lv,Hv,Uv,jv,Vv,Kv,Qv,Yv,tg,ag,lg,ug,pg,vg,mg,bg,Ig,Og,Ng,_g,zg];class Wg extends Zp{constructor(e,t,n,r,i,o,a,s){var l,c,u,d,f,p,h,v,g,m,y,S,b,w,k;super(e),this.appSdkHost=e,this.hubServices=t,this.telemetryService=n,this.messageHandlers=[];const E=new wv([new qp(t.appInstallDialogService),new Ev(t.pageService),new ph(t.calendarService),new mh(t.callService),new bh(t.chatService),new kg(t.stageViewService,e.getLogger())]);for(const r of $g)if(yv(r)){const i=r.dependentHubServiceSelector(t);void 0!==i&&this.messageHandlers.push(r.messageHandlerFactory(e,i,n))}else this.messageHandlers.push(r.messageHandlerFactory(e,n));this.messageHandlers.push(new kv(e,n,t.linkService,E)),this.messageHandlers.push(new Up(e,t,n,i,o,a,s)),this.messageHandlers.push(new fg(e,n,null===(l=t.lifecycleService)||void 0===l?void 0:l.cacheabilityDataService,t.cacheManagementService,t.pageService,t.logService,null===(c=t.videoExtensibilityService)||void 0===c?void 0:c.mediaStreamService,t.meetingService,t.meetingRoomService,t.remoteCameraService,t.searchService,t.otherAppStateChangeService,r)),this.messageHandlers.push(new Ih(e,n,null===(u=t.copilotService)||void 0===u?void 0:u.eligibilityService)),this.messageHandlers.push(new mv(e,n,null===(d=t.hostEntityService)||void 0===d?void 0:d.tabService)),this.messageHandlers.push(new Eg(e,n,null===(f=t.stageViewService)||void 0===f?void 0:f.selfService)),this.messageHandlers.push(new rg(e,n,null===(p=t.pageService)||void 0===p?void 0:p.tabsService)),this.messageHandlers.push(new eg(e,n,null===(h=t.pageService)||void 0===h?void 0:h.configService)),this.messageHandlers.push(new og(e,n,null===(v=t.pageService)||void 0===v?void 0:v.fullTrustService)),this.messageHandlers.push(new ig(e,n,null===(g=t.pageService)||void 0===g?void 0:g.backStackService)),this.messageHandlers.push(new Rg(e,n,null===(m=t.teamsService)||void 0===m?void 0:m.fullTrustService)),this.messageHandlers.push(new xg(e,n,null===(S=null===(y=t.teamsService)||void 0===y?void 0:y.fullTrustService)||void 0===S?void 0:S.joinedTeamsService)),this.messageHandlers.push(new Oh(e,n,t.dialogService,i)),this.messageHandlers.push(new Ph(e,n,null===(b=t.dialogService)||void 0===b?void 0:b.updateService)),this.messageHandlers.push(new Wv(e,n,t.messageChannelsService)),this.messageHandlers.push(new qv(e,n,t.messageChannelsService)),this.messageHandlers.push(new Bg(e,n,null===(w=t.videoExtensibilityService)||void 0===w?void 0:w.mediaStreamService)),this.messageHandlers.push(new Ug(e,n,null===(k=t.videoExtensibilityService)||void 0===k?void 0:k.sharedFrameService)),this.messageHandlers.forEach(e=>e.initHandlers())}tryCustomProcessing(e){return this.hubServices.customMessageService?this.hubServices.customMessageService.tryProcessMessage(e,this.appSdkHost.postMessageToFrame.bind(this.appSdkHost)):super.tryCustomProcessing(e)}}class qg extends nh{constructor(e,t,n,r,i,o,a,s,l=!1){super(e,n,r.authenticationService,r.logger,r.telemetryService,i),this.hostWindow=e,this.communicationBridge=t,this.context=n,this.hubServices=r,this.onAppInitStateChanged=i,this.hostVersionsInfo=o,this.isNAAChannelRecommended=a,this.hostInsecureOrigins=s,this.isCachedLaunch=l,this.isMetaOSMounted=!1,this.getIsCachedLaunch=()=>this.isCachedLaunch,this.getAppDefinition=()=>this.appDefinition,this.getOrigin=()=>this.communicationBridge.getOrigin(),this.getDisplayName=()=>{var e,t;return(null===(e=this.context.page.config)||void 0===e?void 0:e.instanceId)?null===(t=this.context.page.config)||void 0===t?void 0:t.displayName:this.appDefinition&&Wf(this.appDefinition,this.context.page.id)},this.prefetchAuthToken=(e,t)=>c(this,void 0,void 0,function*(){var n;const r=null===(n=this.telemetryService)||void 0===n?void 0:n.createScenario("preFetchAuthToken",null==t?void 0:t.id,void 0,"no_value");if(this.hubServices.authenticationService)try{const n=Cf(t,e);if(n&&Tf(n))return yield this.hubServices.authenticationService.acquireToken(n,void 0,!0),null==r||r.stop(),!0}catch(e){const t="Unable to prefetch token via authentication service: "+Rr(e);this.getLogger().log(z.Error,"prefetchAuthToken",t,e),null==r||r.fail(t)}else{const e="Cancelled since authenticationService is not available";this.getLogger().log(z.Error,"prefetchAuthToken",e),null==r||r.fail(e)}return!1}),this.urlToLoad=e=>e,this.setAppInitInfo=e=>{this.checkIfCacheableAndInvoke(t=>{var n;null===(n=this.hubServices.cacheManagementService)||void 0===n||n.setAppState(t,e)}),this.onAppInitStateChanged&&this.onAppInitStateChanged(e)},this.loadCacheableRegistrationState=()=>{if(!this.hubServices.cacheManagementService)return;const e=this.getCacheablePageInfo();return e&&this.hubServices.cacheManagementService.loadBootstrapRegistrationState(e)},this.saveCacheableRegistrationState=(e,t)=>{this.checkIfCacheableAndInvoke(n=>{var r;null===(r=this.hubServices.cacheManagementService)||void 0===r||r.saveBootstrapRegistrationState(n,((e,t)=>qf(e)?{userSettingsChange:{userSettingTypes:t}}:{[`${e}`]:!0})(e,t))})},this.checkIfCachedAndRequestAllowed=e=>{if(!this.hubServices.cacheManagementService||!this.hubServices.cacheManagementService.isCachedAndAllowRequest)return!0;const t=this.getCacheablePageInfo();return!t||this.hubServices.cacheManagementService.isCachedAndAllowRequest(t,e)},this.unloadCachedApp=e=>{const t=this.hubServices.cacheManagementService;(null==t?void 0:t.shouldTriggerUnload(e))?(null==t||t.setAppState(e,{state:Yn.Unloading}),this.sendRequestMessage("beforeUnload")):null==t||t.setAppState(e,{state:Yn.Unloaded})},this.disposeBridge=()=>{var e;gp(this.telemetryService,this.communicationBridge.id,null===(e=this.appDefinition)||void 0===e?void 0:e.id),this.communicationBridge.dispose()},this.checkIfCacheableAndInvoke=(e,t)=>{if(this.hubServices.cacheManagementService){const n=this.getCacheablePageInfo();n?e(n):null==t||t()}else null==t||t()},this.getCacheablePageInfo=()=>{var e;return this.appDefinition?{appId:this.appDefinition.id,entityId:this.context.page.id,displayName:this.getDisplayName(),instanceId:null===(e=this.context.page.config)||void 0===e?void 0:e.instanceId,contentUrl:this.getOrigin(),frameContext:this.getFrameContext()}:void 0},this.isMetaOSMounted=!0,this.initializeAuthenticationContext(n),t.onSdkInitialized&&t.onSdkInitialized(e),this.createTelemetryScenarioForWebContentSdkCreated(!!t.onSdkInitialized,this.communicationBridge.id)}setFrameAndLoadOrigin(e,t,n,r,i,o){var a,s;return c(this,void 0,void 0,function*(){try{let l,c=!1;sf().recreateCommBridgeListenersBeforeLoadingApp&&(null===(s=(a=this.communicationBridge).onSdkInitialized)||void 0===s||s.call(a,this.hostWindow),c=!0),up(op.Start,ap.IframeSetAndLoadOrigin),this.createTelemetryScenarioForSetFrameAndLoadOrigin(c,n,r,i,o,this.communicationBridge.id),this.isCachedLaunch=null!=i?i:this.isCachedLaunch,this.appDefinition=n,this.setAppInitInfo({state:Yn.Loading}),this.setInitialized(this.isCachedLaunch),this.telemetryService.setAppDefinition(n),this.telemetryService.setUsingCachedApp(this.isCachedLaunch),this.frame=e,this.setUserClickTime(r),o&&this.setUserClickTimeV2(o),this.messageProcessor&&this.messageProcessor.cleanup(),this.isCachedLaunch&&(l=this.loadCacheableRegistrationState(),this.communicationBridge.onSdkInitialized&&this.communicationBridge.onSdkInitialized(this.hostWindow));const u=yield this.getAppContext();this.prefetchAuthToken(u,n);const d=new Gh(this.hostInsecureOrigins,this.getAppInitializationScenario());this.messageProcessor=new Wg(this,this.hubServices,this.telemetryService,l,this.hostVersionsInfo,this.isCachedLaunch,this.isNAAChannelRecommended,d),this.load(t,u,this.isCachedLaunch)}catch(e){this.getLogger().log(z.Debug,"setFrameAndLoadOrigin",`Error occurred while loading origin: ${t}`),this.getLogger().log(z.Error,"setFrameAndLoadOrigin","An error occurred while loading URL",e),this.handleAppLoadFailure(e)}up(op.End,ap.IframeSetAndLoadOrigin),up(op.End,ap.OverallAppLoadTimeBeforeInitialize)})}handleAppLoadFailure(e){var t,n;let r,i;e===jn?(r=Pn.Validation_InvalidDomains,i=jn):(r=Pn.Validation,i=Un),null===(t=this.getAppInitializationScenario())||void 0===t||t.fail(r,i),this.setAppInitInfo({state:Yn.Failed,reason:r}),null===(n=this.messageProcessor)||void 0===n||n.cleanup()}sendRequestMessage(e,t){if(this.getOrigin()&&this.frame){const n={func:e,args:t,monotonicTimestamp:np()};this.communicationBridge.postMessage(this.frame,n)}}sendResponseMessage(e,t,n,r,i,o){if(this.getOrigin()){const a={id:t,uuidAsString:null==n?void 0:n.toString(),args:r,isPartialResponse:i,origin:this.getOrigin(),monotonicTimestamp:np()};o?this.communicationBridge.postMessageWithTransferables(e,a,o):this.communicationBridge.postMessage(e,a)}}sendResponseMessageToNestedIframe(e,t,n,r,i){const o={id:e,uuidAsString:null==n?void 0:n.toString(),args:r,isPartialResponse:i,origin:t.origin,monotonicTimestamp:np()};this.communicationBridge.postMessageToNestedIframe(o,t)}setOrigin(e,t){this.communicationBridge.setOrigin(e,t)}postResponseToApp(e,t,n,r){if(this.frame){const i=Kh(e);this.sendResponseMessage(this.frame,i.id,i.uuid,t,n,r)}}postDeeplyNestedResponseToApp(e,t,n,r){const i=Kh(e);this.sendResponseMessageToNestedIframe(i.id,t,i.uuid,n,r)}postMessageToFrame(e){this.frame&&this.communicationBridge.postMessage(this.frame,e)}handleMessage(e){if(!this.messageProcessor)throw new Error("Unable to handle message. Undefined message processor");e.isDeeplyNestedRequest?this.messageProcessor.processForDeeplyNestedRequest(e):this.messageProcessor.process(e)}load(e,t,n=!1){if(!this.isMetaOSMounted)return;let r;this.frame&&this.appDefinition&&this.communicationBridge.onSetFrameAndLoadOrigin(this.frame,e,this.appDefinition,t,this.handleMessage.bind(this),n);try{r=df(e,this.getLogger(),t,this.getAppDefinition())}catch(e){this.handleInvalidUrlError(t)}if(r&&this.frame)if(this.getLogger().log(z.Debug,"load",`origin: ${r}`),this.setOrigin(r,n),this.setAppInitInfo({state:Yn.WaitingForAppLoad}),n)this.sendRequestMessage("load",[{entityId:t.page.id,contentUrl:r}]);else{const e=new URL(r);this.frame.src=Of(this.urlToLoad(e))}else this.handleInvalidUrlError(t)}handleInvalidUrlError(e){throw sf().wildcardValidDomainRuleDetection&&this.getAppDefinition()&&ff(pf(this.getAppDefinition(),e)).length>0?jn:Un}unloadApp(e,t="unknown"){var n;if(null===(n=this.messageProcessor)||void 0===n||n.cleanup(),this.hubServices.cacheManagementService){const e=this.getCacheablePageInfo();e&&this.unloadCachedApp(e)}else super.createTelemetryScenarioForAppTermination(e,t)}unloadSDK(){var e;null===(e=this.messageProcessor)||void 0===e||e.cleanup(),this.isMetaOSMounted=!1,this.onAppInitStateChanged=void 0,this.hubServices.cacheManagementService||this.disposeBridge(),super.createTelemetryScenarioForUnloadSdk(this.communicationBridge.id)}getFrame(){return this.frame}}var Vg=function(e){var t=e.initValue,n=e.useHookBody,r=e.applyStateChange,i=(0,V.useRef)(t);if("function"!=typeof n)throw new Error("function expected as hook body parameter. got "+typeof n);var o=n();return(0,V.useLayoutEffect)(function(){i.current!==o&&(i.current=o,r(o))},[r,o]),null},Gg=function(e){console&&console.warn&&console.warn(e)},Kg="object"==typeof self&&self.self===self&&self||"object"==typeof i.g&&i.g.global===i.g&&i.g||void 0;function Xg(){return Xg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xg.apply(this,arguments)}var Qg=!1,Jg=!1,Yg=!1,Zg=[],em=function(e){return Zg.push(e),function(){throw new Error("Can not unmount container! It is like a bug in react-singleton-hook library, because of unmountIfNoConsumers: true")}},tm=function(){Jg=!0,(0,V.useEffect)(function(){Qg&&Gg("SingletonHooksContainer is mounted second time. You should mount SingletonHooksContainer before any other component and never unmount it.Alternatively, dont use SingletonHooksContainer it at all, we will handle that for you."),Qg=!0},[]);var e=(0,V.useState)([]),t=e[0],n=e[1];return(0,V.useEffect)(function(){em=function(e){return n(function(t){return[].concat(t,[e])}),function(){n(function(t){return t.filter(function(t){return t!==e})})}},n(Zg)},[]),V.createElement(V.Fragment,null,t.map(function(e,t){return V.createElement(Vg,Xg({},e,{key:t}))}))};class nm{constructor(e,t,n,r){this.pageInfo=e,this.communicationBridge=t,this.frameInfo=n,this.bootstrapRegistrationState=r,this.currentAppState={state:Yn.Loading},this.unloadingTimeoutId=0,this.unloadingTimeoutDeferred=null}loadBootstrapRegistrationState(){return this.bootstrapRegistrationState}saveBootstrapRegistrationState(e){this.bootstrapRegistrationState=Object.assign(Object.assign({},this.bootstrapRegistrationState),e)}isCached(){return this.currentAppState.state===Yn.Cached}}class rm{constructor(e){this.constraintsService=e,this.removeLeastRecentlyUsedAppIf=(e,t,n)=>{if(t){const t=e.shift();if(t&&t.currentAppState.state===Yn.Cached)return{app:t,reason:n}}}}determineAppsToRemoveBasedOnConstraints(e,t,n){const r=e.filter(e=>this.hasAppExceededMaxLifetime(e.pageInfo));if(r.length>0){const e=r.shift();return e?[{app:e,reason:Nn.AppExpiration}]:[]}const i=this.removeLeastRecentlyUsedAppIf(e,void 0!==t&&!this.isFreeMemoryAboveMinimum(t),Nn.FreeMemoryUnderMinimum)||this.removeLeastRecentlyUsedAppIf(e,void 0!==n&&!this.isMemoryUsageWithinLimit(n),Nn.HostMemoryLimitExceeded)||this.removeLeastRecentlyUsedAppIf(e,!!this.constraintsService.maxAppsAllowedInCache&&e.length>this.constraintsService.maxAppsAllowedInCache,Nn.NumAppsExceeded);return i?[i]:[]}isMemoryUsageWithinLimit(e){return e<this.constraintsService.maxHostMemoryAllowedInMb}isFreeMemoryAboveMinimum(e){return e>this.constraintsService.minFreeDeviceMemoryInMbToCache}hasAppExceededMaxLifetime(e){const t=60*this.constraintsService.appExpirationInMinutes*1e3;return Date.now()-(e.lastAccessedTimestampInMs||0)>t}}class im{constructor(e,t){this.isCached=e=>e.isCached(),this.cachedApps=[],e&&(this.cacheMonitoringService=new rm(e)),this.telemetryService=t}isAppRegisteredForCaching(e){return!!this.cacheMonitoringService&&!!e.loadBootstrapRegistrationState().load&&!!e.loadBootstrapRegistrationState().beforeUnload}getCachedCommunicationBridge(e){const t=this.getCachedApp(e);return t&&this.isAppRegisteredForCaching(t)?t.communicationBridge:void 0}updateServices(e,t){this.cacheMonitoringService=e?new rm(e):void 0,t&&(this.telemetryService=t)}runAppTerminateTelemetryScenario(e,t,n,r,i="monotonic"){var o;const a=null===(o=this.telemetryService)||void 0===o?void 0:o.createScenario("appTermination",e,t,void 0,i);a.addOrUpdateActivityDataField(dp.CACHEDAPP_IND_FIELD_NAME,r||!0),a.addOrUpdateActivityDataField(dp.APP_TERMINATE_REASON,n),a.stop()}auditAndRemoveCachedApps({currentFreeMemoryInMb:e,currentMemoryUsageInMb:t}){this.cacheMonitoringService&&this.cacheMonitoringService.determineAppsToRemoveBasedOnConstraints(this.getCachedApps(),e,t).forEach(e=>{const t=e.app.pageInfo;this.removeAppFromCache(t,e.reason)})}addAppToCache(e,t,n){const r=new nm(e,t,n,{});return this.cachedApps.push(r),r}removeAppFromCache(e,t){const n=this.getCachedApp(e);if(n){this.cachedApps.splice(this.cachedApps.indexOf(n),1);const r=ep("monotonic");this.runAppTerminateTelemetryScenario(e.appId,r.value,t,!0,r.type),this.disposeCachedApps([n])}}getCachedApps(){return this.cachedApps.filter(this.isCached)}getCachedApp(e){if(!e.frameContext||e.frameContext===tf.content)return this.cachedApps.find(t=>t.pageInfo.appId===e.appId)}shouldDisplayLoadingUI(e,t,n){if(!t&&!n)return!1;const r=e.state;return r===Yn.Loading||r===Yn.WaitingForAppLoad}disposeCachedApps(e){var t,n,r;for(const i of e)null===(t=i.communicationBridge)||void 0===t||t.dispose(),gp(this.telemetryService,null===(n=i.communicationBridge)||void 0===n?void 0:n.id,i.pageInfo.appId),null===(r=i.frameInfo)||void 0===r||r.remove(),i.unloadingTimeoutDeferred&&(i.unloadingTimeoutDeferred.reject(new Error("Unloading timeout")),i.unloadingTimeoutDeferred=null)}logTelemetryForAppStateChange(e,t){var n,r;const i=null===(n=this.telemetryService)||void 0===n?void 0:n.createScenario("appStateUpdated",e);null===(r=null==i?void 0:i.addOrUpdateActivityDataField)||void 0===r||r.call(i,dp.APP_STATE_UPDATED,t),null==i||i.stop()}handleUnloading(e,t){e.unloadingTimeoutId||(this.startAppSuspendScenario(t.appId),e.unloadingTimeoutId=window.setTimeout(()=>{this.failAppSuspendScenario(Nn.AppUnloadTimeout),this.removeAppFromCache(t,Nn.AppUnloadTimeout)},15e3))}setAppState(e,t){var n;const r=this.getCachedApp(e);if(r&&!(t.state===Yn.Loaded&&r.currentAppState.state!==Yn.WaitingForAppLoad||t.state===Yn.Unloaded&&(i=r.currentAppState.state)!==Yn.Unloading&&i!==Yn.Loaded&&i!==Yn.Loading&&i!==Yn.WaitingForAppLoad&&i!==Yn.Failed)){var i;switch(t.state){case Yn.Unloaded:r.unloadingTimeoutId&&window.clearTimeout(r.unloadingTimeoutId),r.unloadingTimeoutId=0,this.stopAppSuspendScenario(),(null==r?void 0:r.unloadingTimeoutDeferred)&&(r.unloadingTimeoutDeferred.resolve(!0),r.unloadingTimeoutDeferred=null),r.communicationBridge.dispose(),gp(this.telemetryService,null===(n=r.communicationBridge)||void 0===n?void 0:n.id,r.pageInfo.appId),this.isAppRegisteredForCaching(r)?(r.currentAppState.state=Yn.Cached,r.pageInfo.lastAccessedTimestampInMs=Date.now()):this.removeAppFromCache(e,Nn.AppDidNotRegisterForCaching),this.auditAndRemoveCachedApps({currentFreeMemoryInMb:void 0,currentMemoryUsageInMb:void 0});break;case Yn.Unloading:r.currentAppState=t,this.handleUnloading(r,e);break;case Yn.Failed:r.currentAppState.state===Yn.Cached||(r.currentAppState=t),this.removeAppFromCache(e,t.reason);break;case Yn.Loaded:r.currentAppState=t,this.updateAppRecency(e);break;default:r.currentAppState=t}this.logTelemetryForAppStateChange(r.pageInfo.appId,t.state)}}updateAppRecency(e){const t=this.cachedApps.findIndex(t=>t.pageInfo.appId===e.appId);if(-1!==t){const[e]=this.cachedApps.splice(t,1);this.cachedApps.push(e)}}isAppLoading(e){return e.currentAppState.state===Yn.Loading}shouldTriggerUnload(e){var t;const n=this.getCachedApp(e);return!!n&&(!this.isAppLoading(n)&&!!(null===(t=n.loadBootstrapRegistrationState())||void 0===t?void 0:t.beforeUnload))}loadBootstrapRegistrationState(e){const t=this.getCachedApp(e);return t?t.loadBootstrapRegistrationState():void 0}saveBootstrapRegistrationState(e,t){var n;null===(n=this.getCachedApp(e))||void 0===n||n.saveBootstrapRegistrationState(t)}startAppSuspendScenario(e){var t;this.appSuspendOrTerminateScenario=null===(t=this.telemetryService)||void 0===t?void 0:t.createScenario("appSuspend",e)}stopAppSuspendScenario(){var e;null===(e=this.appSuspendOrTerminateScenario)||void 0===e||e.stop(),this.appSuspendOrTerminateScenario=void 0}failAppSuspendScenario(e){var t;null===(t=this.appSuspendOrTerminateScenario)||void 0===t||t.fail(e),this.appSuspendOrTerminateScenario=void 0}}const om=function(e,t,n){void 0===n&&(n={});var r=!1,i=void 0,o=!1,a=void 0,s=[],l=n.unmountIfNoConsumers,c=void 0!==l&&l,u=function(e){var t;a=e,t=function(){return s.forEach(function(t){return t(e)})},(0,K.unstable_batchedUpdates)(t)},d=function(){return o||(a="function"==typeof e?e():e,o=!0),a};return function(){var n=(0,V.useState)(d),o=n[0],l=n[1];return(0,V.useEffect)(function(){return r||(r=!0,n={initValue:e,useHookBody:t,applyStateChange:u},Jg||Yg||(Yg=!0,d=tm,Kg.document&&Kg.document.createElement?(0,K.render)(V.createElement(d,null),Kg.document.createElement("div")):Gg("Can not mount SingletonHooksContainer on server side. Did you manage to run useEffect on server? Please mount SingletonHooksContainer into your components tree manually.")),i=em(n)),s.push(l),a!==o&&l(a),function(){s.splice(s.indexOf(l),1),0===s.length&&c&&(i(),r=!1)};var n,d},[]),o}}(void 0,()=>{const[e,t]=(0,V.useState)(),[n,r]=(0,V.useState)(void 0),[i,o]=(0,V.useState)(void 0);return(0,V.useEffect)(()=>{var r,o;if(!e&&n){const e=new im(null===(r=n.cacheabilityDataService)||void 0===r?void 0:r.constraints,i);t(e)}else e&&n&&e.updateServices(null===(o=n.cacheabilityDataService)||void 0===o?void 0:o.constraints,i)},[e,n,i]),{cacheManagementService:e,setLifecycleService:r,setTelemetryService:o}}),am={media:["camera","microphone"],geolocation:["geolocation"],midi:["midi"]},sm=Symbol.for("fui.slotRenderFunction"),lm=Symbol.for("fui.slotElementType"),cm=Symbol.for("fui.slotClassNameProp");function um(e){return Boolean(null==e?void 0:e.hasOwnProperty(lm))}function dm(e,t){return function(n,r,i,o,a){return um(r)?t(function(e,t){return{...t,[lm]:e}}(n,r),null,i,o,a):um(n)?t(n,r,i,o,a):e(n,r,i,o,a)}}function fm(e){const{as:t,[cm]:n,[lm]:r,[sm]:i,...o}=e,a=o,s="string"==typeof r&&null!=t?t:r;return"string"!=typeof s&&t&&(a.as=t),{elementType:s,props:a,renderFunction:i}}i(3916);var pm=i(7503);const hm=i.t(pm,2),vm=dm(hm.jsx,(e,t,n)=>{const{elementType:r,renderFunction:i,props:o}=fm(e),a={...o,...t};return i?hm.jsx(V.Fragment,{children:i(r,a)},n):hm.jsx(r,a,n)}),gm=dm(hm.jsxs,(e,t,n)=>{const{elementType:r,renderFunction:i,props:o}=fm(e),a={...o,...t};return i?hm.jsx(V.Fragment,{children:i(r,{...a,children:hm.jsxs(V.Fragment,{children:a.children},void 0)})},n):hm.jsxs(r,a,n)});function mm(){return"undefined"!=typeof window&&!(!window.document||!window.document.createElement)}const ym=V.createContext("ltr"),Sm=({children:e,dir:t})=>V.createElement(ym.Provider,{value:t},e);function bm(){return V.useContext(ym)}const wm=V.createContext(void 0),km={targetDocument:"object"==typeof document?document:void 0,dir:"ltr"},Em=wm.Provider;function Am(){var e;return null!==(e=V.useContext(wm))&&void 0!==e?e:km}const Cm=V.createContext(void 0),Im=Cm.Provider,Tm=V.createContext(void 0).Provider,xm=V.createContext(void 0),Rm=()=>{},Om=xm.Provider,Pm=e=>{var t,n;return null!==(n=null===(t=V.useContext(xm))||void 0===t?void 0:t[e])&&void 0!==n?n:Rm},Nm=V.createContext(void 0).Provider,Fm=V.createContext(void 0),Bm=Fm.Provider,Lm=V.createContext(void 0),Dm={},Hm=Lm.Provider;function _m(e){return Array.isArray(e)?e:[e]}const Mm="undefined"==typeof window?i.g:window,Um="@griffel/";function zm(e,t){return Mm[Symbol.for(Um+e)]||(Mm[Symbol.for(Um+e)]=t),Mm[Symbol.for(Um+e)]}const jm=zm("DEFINITION_LOOKUP_TABLE",{}),$m="data-make-styles-bucket",Wm={all:1,borderColor:1,borderStyle:1,borderWidth:1,borderBlock:1,borderBlockEnd:1,borderBlockStart:1,borderInline:1,borderInlineEnd:1,borderInlineStart:1},qm="DO_NOT_USE_DIRECTLY: @griffel/reset-value";const Vm=["r","d","l","v","w","f","i","h","a","s","k","t","m","c"].reduce((e,t,n)=>(e[t]=n,e),{});function Gm(e,t,n,r,i={}){var o,a;const s="m"===e,l=null!==(o=i.m)&&void 0!==o?o:"0",c=null!==(a=i.p)&&void 0!==a?a:0,u=function(e,t,n){return("m"===e?e+t:e)+n}(e,l,c);if(!r.stylesheets[u]){const o=t&&t.createElement("style"),a=function(e,t,n,r){const i=[];if(r[$m]=t,r["data-priority"]=String(n),e)for(const t in r)e.setAttribute(t,r[t]);return{elementAttributes:r,insertRule:function(t){return(null==e?void 0:e.sheet)?e.sheet.insertRule(t,e.sheet.cssRules.length):i.push(t)},element:e,bucketName:t,cssRules:()=>(null==e?void 0:e.sheet)?Array.from(e.sheet.cssRules).map(e=>e.cssText):i}}(o,e,c,Object.assign({},r.styleElementAttributes,s&&{media:l}));r.stylesheets[u]=a,(null==t?void 0:t.head)&&o&&t.head.insertBefore(o,function(e,t,n,r,i={}){var o,a;const s=Vm[n],l=null!==(o=i.m)&&void 0!==o?o:"",c=null!==(a=i.p)&&void 0!==a?a:0;let u=e=>s-Vm[e.getAttribute($m)],d=e.head.querySelectorAll(`[${$m}]`);if("m"===n){const t=e.head.querySelectorAll(`[${$m}="${n}"]`);t.length&&(d=t,u=e=>r.compareMediaQueries(l,e.media))}const f=e=>function(e,t,n){var r,i;return t+(null!==(r=n.m)&&void 0!==r?r:"")===e.getAttribute($m)+(null!==(i=e.media)&&void 0!==i?i:"")}(e,n,i)?c-Number(e.getAttribute("data-priority")):u(e),p=d.length;let h=p-1;for(;h>=0;){const e=d.item(h);if(f(e)>0)return e.nextSibling;h--}return p>0?d.item(0):t?t.nextSibling:null}(t,n,e,r,i))}return r.stylesheets[u]}function Km(e,t){try{e.insertRule(t)}catch(e){}}let Xm=0;const Qm=(e,t)=>e<t?-1:e>t?1:0;function Jm(e=("undefined"==typeof document?void 0:document),t={}){const{classNameHashSalt:n,unstable_filterCSSRule:r,insertionPoint:i,styleElementAttributes:o,compareMediaQueries:a=Qm}=t,s={classNameHashSalt:n,insertionCache:{},stylesheets:{},styleElementAttributes:Object.freeze(o),compareMediaQueries:a,id:"d"+Xm++,insertCSSRules(t){for(const n in t){const o=t[n];for(let t=0,a=o.length;t<a;t++){const[a,l]=_m(o[t]),c=Gm(n,e,i||null,s,l);s.insertionCache[a]||(s.insertionCache[a]=n,r?r(a)&&Km(c,a):Km(c,a))}}}};return s}const Ym=V.createContext(Jm());function Zm(){return V.useContext(Ym)}function ey(e,t){var n;const r=e;var i;return Boolean((null==r||null===(n=r.ownerDocument)||void 0===n?void 0:n.defaultView)&&r instanceof r.ownerDocument.defaultView[null!==(i=null==t?void 0:t.constructorName)&&void 0!==i?i:"HTMLElement"])}var ty="undefined"!=typeof WeakRef,ny=class{constructor(e){ty&&"object"==typeof e?this._weakRef=new WeakRef(e):this._instance=e}deref(){var e,t;let n;return this._weakRef?(n=null==(e=this._weakRef)?void 0:e.deref(),n||delete this._weakRef):(n=this._instance,(null==(t=null==n?void 0:n.isDisposed)?void 0:t.call(n))&&delete this._instance),n}},ry="keyborg:focusin",iy=!1,oy=0,ay=class{constructor(e,t){this._isNavigatingWithKeyboard_DO_NOT_USE=!1,this._onFocusIn=e=>{if(this._isMouseOrTouchUsedTimer)return;if(this.isNavigatingWithKeyboard)return;const t=e.detail;t.relatedTarget&&(t.isFocusedProgrammatically||void 0===t.isFocusedProgrammatically||(this.isNavigatingWithKeyboard=!0))},this._onMouseDown=e=>{0===e.buttons||0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY||this._onMouseOrTouch()},this._onMouseOrTouch=()=>{const e=this._win;e&&(this._isMouseOrTouchUsedTimer&&e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=e.setTimeout(()=>{delete this._isMouseOrTouchUsedTimer},1e3)),this.isNavigatingWithKeyboard=!1},this._onKeyDown=e=>{this.isNavigatingWithKeyboard?this._shouldDismissKeyboardNavigation(e)&&this._scheduleDismiss():this._shouldTriggerKeyboardNavigation(e)&&(this.isNavigatingWithKeyboard=!0)},this.id="c"+ ++oy,this._win=e;const n=e.document;if(t){const e=t.triggerKeys,n=t.dismissKeys;(null==e?void 0:e.length)&&(this._triggerKeys=new Set(e)),(null==n?void 0:n.length)&&(this._dismissKeys=new Set(n))}n.addEventListener(ry,this._onFocusIn,!0),n.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),n.addEventListener("touchstart",this._onMouseOrTouch,!0),n.addEventListener("touchend",this._onMouseOrTouch,!0),n.addEventListener("touchcancel",this._onMouseOrTouch,!0),function(e){const t=e;iy||(iy=function(e){const t=e.HTMLElement,n=t.prototype.focus;let r=!1;return t.prototype.focus=function(){r=!0},e.document.createElement("button").focus(),t.prototype.focus=n,r}(t));const n=t.HTMLElement.prototype.focus;if(n.__keyborgNativeFocus)return;t.HTMLElement.prototype.focus=l;const r=new Set,i=e=>{const t=e.target;if(!t)return;const n=new CustomEvent("keyborg:focusout",{cancelable:!0,bubbles:!0,composed:!0,detail:{originalEvent:e}});t.dispatchEvent(n)},o=e=>{const t=e.target;if(!t)return;let n=e.composedPath()[0];const s=new Set;for(;n;)n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?(s.add(n),n=n.host):n=n.parentNode;for(const e of r){const t=e.deref();t&&s.has(t)||(r.delete(e),t&&(t.removeEventListener("focusin",o,!0),t.removeEventListener("focusout",i,!0)))}a(t,e.relatedTarget||void 0)},a=(e,t,n)=>{var a;const l=e.shadowRoot;if(l){for(const e of r)if(e.deref()===l)return;return l.addEventListener("focusin",o,!0),l.addEventListener("focusout",i,!0),void r.add(new ny(l))}const c={relatedTarget:t,originalEvent:n},u=new CustomEvent(ry,{cancelable:!0,bubbles:!0,composed:!0,detail:c});u.details=c,(iy||s.lastFocusedProgrammatically)&&(c.isFocusedProgrammatically=e===(null==(a=s.lastFocusedProgrammatically)?void 0:a.deref()),s.lastFocusedProgrammatically=void 0),e.dispatchEvent(u)},s=t.__keyborgData={focusInHandler:o,focusOutHandler:i,shadowTargets:r};function l(){const e=t.__keyborgData;return e&&(e.lastFocusedProgrammatically=new ny(this)),n.apply(this,arguments)}t.document.addEventListener("focusin",t.__keyborgData.focusInHandler,!0),t.document.addEventListener("focusout",t.__keyborgData.focusOutHandler,!0);let c=t.document.activeElement;for(;c&&c.shadowRoot;)a(c),c=c.shadowRoot.activeElement;l.__keyborgNativeFocus=n}(e)}get isNavigatingWithKeyboard(){return this._isNavigatingWithKeyboard_DO_NOT_USE}set isNavigatingWithKeyboard(e){this._isNavigatingWithKeyboard_DO_NOT_USE!==e&&(this._isNavigatingWithKeyboard_DO_NOT_USE=e,this.update())}dispose(){const e=this._win;if(e){this._isMouseOrTouchUsedTimer&&(e.clearTimeout(this._isMouseOrTouchUsedTimer),this._isMouseOrTouchUsedTimer=void 0),this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0),function(e){const t=e,n=t.HTMLElement.prototype,r=n.focus.__keyborgNativeFocus,i=t.__keyborgData;if(i){t.document.removeEventListener("focusin",i.focusInHandler,!0),t.document.removeEventListener("focusout",i.focusOutHandler,!0);for(const e of i.shadowTargets){const t=e.deref();t&&(t.removeEventListener("focusin",i.focusInHandler,!0),t.removeEventListener("focusout",i.focusOutHandler,!0))}i.shadowTargets.clear(),delete t.__keyborgData}r&&(n.focus=r)}(e);const t=e.document;t.removeEventListener(ry,this._onFocusIn,!0),t.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener("touchstart",this._onMouseOrTouch,!0),t.removeEventListener("touchend",this._onMouseOrTouch,!0),t.removeEventListener("touchcancel",this._onMouseOrTouch,!0),delete this._win}}isDisposed(){return!!this._win}update(){var e,t;const n=null==(t=null==(e=this._win)?void 0:e.__keyborg)?void 0:t.refs;if(n)for(const e of Object.keys(n))sy.update(n[e],this.isNavigatingWithKeyboard)}_shouldTriggerKeyboardNavigation(e){var t;if("Tab"===e.key)return!0;const n=null==(t=this._win)?void 0:t.document.activeElement,r=!this._triggerKeys||this._triggerKeys.has(e.keyCode),i=n&&("INPUT"===n.tagName||"TEXTAREA"===n.tagName||n.isContentEditable);return r&&!i}_shouldDismissKeyboardNavigation(e){var t;return null==(t=this._dismissKeys)?void 0:t.has(e.keyCode)}_scheduleDismiss(){const e=this._win;if(e){this._dismissTimer&&(e.clearTimeout(this._dismissTimer),this._dismissTimer=void 0);const t=e.document.activeElement;this._dismissTimer=e.setTimeout(()=>{this._dismissTimer=void 0;const n=e.document.activeElement;t&&n&&t===n&&(this.isNavigatingWithKeyboard=!1)},500)}}},sy=class e{constructor(e,t){this._cb=[],this._id="k"+ ++oy,this._win=e;const n=e.__keyborg;n?(this._core=n.core,n.refs[this._id]=this):(this._core=new ay(e,t),e.__keyborg={core:this._core,refs:{[this._id]:this}})}static create(t,n){return new e(t,n)}static dispose(e){e.dispose()}static update(e,t){e._cb.forEach(e=>e(t))}dispose(){var e;const t=null==(e=this._win)?void 0:e.__keyborg;(null==t?void 0:t.refs[this._id])&&(delete t.refs[this._id],0===Object.keys(t.refs).length&&(t.core.dispose(),delete this._win.__keyborg)),this._cb=[],delete this._core,delete this._win}isNavigatingWithKeyboard(){var e;return!!(null==(e=this._core)?void 0:e.isNavigatingWithKeyboard)}subscribe(e){this._cb.push(e)}unsubscribe(e){const t=this._cb.indexOf(e);t>=0&&this._cb.splice(t,1)}setVal(e){this._core&&(this._core.isNavigatingWithKeyboard=e)}};const ly="data-fui-focus-visible";function cy(e,t){if(uy(e))return()=>{};const n={current:void 0},r=(i=t,sy.create(i,undefined));var i;function o(e){r.isNavigatingWithKeyboard()&&ey(e)&&(n.current=e,e.setAttribute(ly,""))}function a(){n.current&&(n.current.removeAttribute(ly),n.current=void 0)}r.subscribe(e=>{e?o(t.document.activeElement):a()});const s=e=>{a(),o(e.composedPath()[0])},l=t=>{(!t.relatedTarget||ey(t.relatedTarget)&&!e.contains(t.relatedTarget))&&a()};return e.addEventListener(ry,s),e.addEventListener("focusout",l),e.focusVisible=!0,e.contains(t.document.activeElement)&&o(t.document.activeElement),()=>{var t;a(),e.removeEventListener(ry,s),e.removeEventListener("focusout",l),e.focusVisible=void 0,t=r,sy.dispose(t)}}function uy(e){return!!e&&(!!e.focusVisible||uy(null==e?void 0:e.parentElement))}function dy(e={}){const t=Am(),n=V.useRef(null);var r;const i=null!==(r=e.targetDocument)&&void 0!==r?r:t.targetDocument;return V.useEffect(()=>{if((null==i?void 0:i.defaultView)&&n.current)return cy(n.current,i.defaultView)},[n,i]),n}function fy(e,t){const{defaultProps:n,elementType:r}=t,i=function(e){return"string"==typeof e||"number"==typeof e||hy(e)||V.isValidElement(e)?{children:e}:e}(e),o={...n,...i,[lm]:r,[cm]:null==i?void 0:i.className};return i&&"function"==typeof i.children&&(o[sm]=i.children,o.children=null==n?void 0:n.children),o}function py(e,t){if(null!==e&&(void 0!==e||t.renderByDefault))return fy(e,t)}const hy=e=>"object"==typeof e&&null!==e&&Symbol.iterator in e,vy=(...e)=>{const t={};for(const n of e){const e=Array.isArray(n)?n:Object.keys(n);for(const n of e)t[n]=1}return t},gy=vy(["onAuxClick","onAnimationEnd","onAnimationStart","onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),my=vy(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),yy=vy(["itemID","itemProp","itemRef","itemScope","itemType"]),Sy=vy(my,gy,yy),by=vy(Sy,["form"]),wy=vy(Sy,["height","loop","muted","preload","src","width"]),ky=vy(wy,["poster"]),Ey=vy(Sy,["start"]),Ay=vy(Sy,["value"]),Cy=vy(Sy,["download","href","hrefLang","media","rel","target","type"]),Iy=vy(Sy,["dateTime"]),Ty=vy(Sy,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"]),xy={label:by,audio:wy,video:ky,ol:Ey,li:Ay,a:Cy,button:Ty,input:vy(Ty,["accept","alt","autoCorrect","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","minLength","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),textarea:vy(Ty,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),select:vy(Ty,["form","multiple","required"]),option:vy(Sy,["selected","value"]),table:vy(Sy,["cellPadding","cellSpacing"]),tr:Sy,th:vy(Sy,["colSpan","rowSpan","scope"]),td:vy(Sy,["colSpan","headers","rowSpan","scope"]),colGroup:vy(Sy,["span"]),col:vy(Sy,["span"]),fieldset:vy(Sy,["disabled","form"]),form:vy(Sy,["acceptCharset","action","encType","encType","method","noValidate","target"]),iframe:vy(Sy,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),img:vy(Sy,["alt","crossOrigin","height","src","srcSet","useMap","width"]),time:Iy,dialog:vy(Sy,["open","onCancel","onClose"])};const Ry=(e,t,n)=>{var r;return function(e,t,n){const r=e&&xy[e]||Sy;return r.as=1,function(e,t,n){const r=Array.isArray(t),i={},o=Object.keys(e);for(const a of o)!(!r&&t[a]||r&&t.indexOf(a)>=0||0===a.indexOf("data-")||0===a.indexOf("aria-"))||n&&-1!==(null==n?void 0:n.indexOf(a))||(i[a]=e[a]);return i}(t,r,n)}(null!==(r=t.as)&&void 0!==r?r:e,t,n)};function Oy(...e){const t=V.useCallback(n=>{t.current=n;for(const t of e)"function"==typeof t?t(n):t&&(t.current=n)},[...e]);return t}const Py=mm()?V.useLayoutEffect:V.useEffect,Ny={current:0},Fy=V.createContext(void 0);const By=V.createContext(void 0);function Ly(e="fui-",t){const n=null!==(o=V.useContext(Fy))&&void 0!==o?o:Ny,r=V.useContext(By)||"",i=G.useId;var o;if(i){const n=i(),o=V.useMemo(()=>n.replace(/:/g,""),[n]);return t||`${r}${e}${o}`}return V.useMemo(()=>t||`${r}${e}${++n.current}`,[r,e,t,n])}By.Provider;const Dy=()=>{const e={};return function(t,n){void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}};function Hy(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}function _y(e,t,n=[]){return"___"+function(e){const t=e.length;if(7===t)return e;for(let n=t;n<7;n++)e+="0";return e}(Hy(e+t))}function My(e,t){let n="",r="";for(const i in e){const o=e[i];if(0===o){r+=i+" ";continue}const a=Array.isArray(o),s="rtl"===t?(a?o[1]:o)+" ":(a?o[0]:o)+" ";n+=s,r+=s}return[n.slice(0,-1),r.slice(0,-1)]}function Uy(e,t){const n={};for(const r in e){const[i,o]=My(e[r],t);if(""===o){n[r]="";continue}const a=_y(o,t),s=a+(""===i?"":" "+i);jm[a]=[e[r],t],n[r]=s}return n}function zy(e,t,n=Dy){const r=n();let i=null,o=null;return function(n){const{dir:a,renderer:s}=n,l="ltr"===a;return l?null===i&&(i=Uy(e,a)):null===o&&(o=Uy(e,a)),r(s,t),l?i:o}}const jy={};function $y(){let e=null,t="",n="";const r=new Array(arguments.length);for(let e=0;e<arguments.length;e++){const i=arguments[e];if("string"==typeof i&&""!==i){const o=i.indexOf("___");if(-1===o)t+=i+" ";else{const a=i.substr(o,10);o>0&&(t+=i.slice(0,o)),n+=a,r[e]=a}}}if(""===n)return t.slice(0,-1);const i=jy[n];if(void 0!==i)return t+i;const o=[];for(let t=0;t<arguments.length;t++){const n=r[t];if(n){const t=jm[n];t&&(o.push(t[0]),e=t[1])}}const a=Object.assign.apply(Object,[{}].concat(o)),[s,l]=My(a,e),c=_y(l,e,r),u=c+" "+s;return jy[n]=u,jm[c]=[a,e],t+u}const Wy="fui-FluentProvider",qy=zy({root:{sj55zd:"f19n0e5",De3pzq:"fxugw4r",fsow6f:["f1o700av","fes3tcz"],Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"}},{d:[".f19n0e5{color:var(--colorNeutralForeground1);}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1o700av{text-align:left;}",".fes3tcz{text-align:right;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}"]}),Vy=G.useInsertionEffect?G.useInsertionEffect:Py,Gy={},Ky={},Xy=(e,t)=>{const n=Am(),r=V.useContext(Cm),i=null!==(o=V.useContext(Fm))&&void 0!==o?o:{};var o;const a=V.useContext(xm)||Gy,{applyStylesToPortals:s=!0,customStyleHooks_unstable:l,dir:c=n.dir,targetDocument:u=n.targetDocument,theme:d,overrides_unstable:f={}}=e,p=Qy(r,d),h=Qy(i,f),v=Qy(a,l),g=Zm();var m;const{styleTagId:y,rule:S}=(e=>{const{targetDocument:t,theme:n,rendererAttributes:r}=e,i=V.useRef(),o=Ly(Wy),a=r,s=V.useMemo(()=>function(e,t){return t?`${e} { ${Object.keys(t).reduce((e,n)=>`${e}--${n}: ${t[n]}; `,"")} }`:`${e} {}`}(`.${o}`,n),[n,o]);return function(e,t){V.useState(()=>{if(!e)return;const n=e.getElementById(t);n&&e.head.append(n)})}(t,o),Vy(()=>{const e=null==t?void 0:t.getElementById(o);return e?i.current=e:(i.current=((e,t)=>{if(!(null==e?void 0:e.head))return;const n=e.createElement("style");return Object.keys(t).forEach(e=>{n.setAttribute(e,t[e])}),e.head.appendChild(n),n})(t,{...a,id:o}),i.current&&((e,t)=>{const n=e.sheet;n&&(n.cssRules.length>0&&n.deleteRule(0),n.insertRule(t,0))})(i.current,s)),()=>{var e;null===(e=i.current)||void 0===e||e.remove()}},[o,t,s,a]),{styleTagId:o,rule:s}})({theme:p,targetDocument:u,rendererAttributes:null!==(m=g.styleElementAttributes)&&void 0!==m?m:Ky});return{applyStylesToPortals:s,customStyleHooks_unstable:v,dir:c,targetDocument:u,theme:p,overrides_unstable:h,themeClassName:y,components:{root:"div"},root:fy(Ry("div",{...e,dir:c,ref:Oy(t,dy({targetDocument:u}))}),{elementType:"div"}),serverStyleProps:{cssRule:S,attributes:{...g.styleElementAttributes,id:y}}}};function Qy(e,t){return e&&t?{...e,...t}:e||t}const Jy=V.forwardRef((e,t)=>{const n=Xy(e,t);(e=>{const t=Zm(),n=qy({dir:e.dir,renderer:t});e.root.className=$y(Wy,e.themeClassName,n.root,e.root.className)})(n);const r=function(e){const{applyStylesToPortals:t,customStyleHooks_unstable:n,dir:r,root:i,targetDocument:o,theme:a,themeClassName:s,overrides_unstable:l}=e,c=V.useMemo(()=>({dir:r,targetDocument:o}),[r,o]),[u]=V.useState(()=>({})),d=V.useMemo(()=>({textDirection:r}),[r]);return{customStyleHooks_unstable:n,overrides_unstable:l,provider:c,textDirection:r,iconDirection:d,tooltip:u,theme:a,themeClassName:t?i.className:s}}(n);return((e,t)=>vm(Em,{value:t.provider,children:vm(Im,{value:t.theme,children:vm(Tm,{value:t.themeClassName,children:vm(Om,{value:t.customStyleHooks_unstable,children:vm(Nm,{value:t.tooltip,children:vm(Sm,{dir:t.textDirection,children:vm(Hm,{value:t.iconDirection,children:vm(Bm,{value:t.overrides_unstable,children:gm(e.root,{children:[mm()?null:vm("style",{dangerouslySetInnerHTML:{__html:e.serverStyleProps.cssRule},...e.serverStyleProps.attributes}),e.root.children]})})})})})})})})}))(n,r)});Jy.displayName="FluentProvider";const Yy=G.useInsertionEffect?G.useInsertionEffect:void 0,Zy=()=>{const e={};return function(t,n){Yy&&"undefined"!=typeof window&&window.document&&window.document.createElement?Yy(()=>{t.insertCSSRules(n)},[t,n]):void 0===e[t.id]&&(t.insertCSSRules(n),e[t.id]=!0)}};function eS(e,t){const n=zy(e,t,Zy);return function(){const e=bm(),t=Zm();return n({dir:e,renderer:t})}}const tS=eS({root:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi",Bhrd7zp:"figsok6",fsow6f:"fpgzoln",mc9l5x:"f1w7gpdv",Huce71:"f6juhto",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1gl81tg",ygn44y:"f2jf649"},nowrap:{Huce71:"fz5stix",B68tc82:0,Bmxbyg5:0,Bpg54ce:"f1a3p1vp"},truncate:{ygn44y:"f1cmbuwj"},block:{mc9l5x:"ftgm304"},italic:{B80ckks:"f1j4dglz"},underline:{w71qe1:"f13mvf36"},strikethrough:{w71qe1:"fv5q2k7"},strikethroughUnderline:{w71qe1:"f1drk4o6"},base100:{Be2twd7:"f13mqy1h",Bg96gwp:"fcpl73t"},base200:{Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm"},base400:{Be2twd7:"fod5ikn",Bg96gwp:"faaz57k"},base500:{Be2twd7:"f1pp30po",Bg96gwp:"f106mvju"},base600:{Be2twd7:"f1x0m3f5",Bg96gwp:"fb86gi6"},hero700:{Be2twd7:"fojgt09",Bg96gwp:"fcen8rp"},hero800:{Be2twd7:"fccw675",Bg96gwp:"f1ebx5kk"},hero900:{Be2twd7:"f15afnhw",Bg96gwp:"fr3w3wp"},hero1000:{Be2twd7:"fpyltcb",Bg96gwp:"f1ivgwrt"},monospace:{Bahqtrf:"f1fedwem"},numeric:{Bahqtrf:"f1uq0ln5"},weightMedium:{Bhrd7zp:"fdj6btp"},weightSemibold:{Bhrd7zp:"fl43uef"},weightBold:{Bhrd7zp:"flh3ekv"},alignCenter:{fsow6f:"f17mccla"},alignEnd:{fsow6f:"f12ymhq5"},alignJustify:{fsow6f:"f1j59e10"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fpgzoln{text-align:start;}",".f1w7gpdv{display:inline;}",".f6juhto{white-space:normal;}",[".f1gl81tg{overflow:visible;}",{p:-1}],".f2jf649{text-overflow:clip;}",".fz5stix{white-space:nowrap;}",[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f1cmbuwj{text-overflow:ellipsis;}",".ftgm304{display:block;}",".f1j4dglz{font-style:italic;}",".f13mvf36{text-decoration-line:underline;}",".fv5q2k7{text-decoration-line:line-through;}",".f1drk4o6{text-decoration-line:line-through underline;}",".f13mqy1h{font-size:var(--fontSizeBase100);}",".fcpl73t{line-height:var(--lineHeightBase100);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".f1pp30po{font-size:var(--fontSizeBase500);}",".f106mvju{line-height:var(--lineHeightBase500);}",".f1x0m3f5{font-size:var(--fontSizeBase600);}",".fb86gi6{line-height:var(--lineHeightBase600);}",".fojgt09{font-size:var(--fontSizeHero700);}",".fcen8rp{line-height:var(--lineHeightHero700);}",".fccw675{font-size:var(--fontSizeHero800);}",".f1ebx5kk{line-height:var(--lineHeightHero800);}",".f15afnhw{font-size:var(--fontSizeHero900);}",".fr3w3wp{line-height:var(--lineHeightHero900);}",".fpyltcb{font-size:var(--fontSizeHero1000);}",".f1ivgwrt{line-height:var(--lineHeightHero1000);}",".f1fedwem{font-family:var(--fontFamilyMonospace);}",".f1uq0ln5{font-family:var(--fontFamilyNumeric);}",".fdj6btp{font-weight:var(--fontWeightMedium);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".flh3ekv{font-weight:var(--fontWeightBold);}",".f17mccla{text-align:center;}",".f12ymhq5{text-align:end;}",".f1j59e10{text-align:justify;}"]});function nS(e){const{useStyles:t,className:n,displayName:r}=e,i=V.forwardRef((e,r)=>{const i=t(),o=((e,t)=>{const{wrap:n,truncate:r,block:i,italic:o,underline:a,strikethrough:s,size:l,font:c,weight:u,align:d}=e;return{align:null!=d?d:"start",block:null!=i&&i,font:null!=c?c:"base",italic:null!=o&&o,size:null!=l?l:300,strikethrough:null!=s&&s,truncate:null!=r&&r,underline:null!=a&&a,weight:null!=u?u:"regular",wrap:null==n||n,components:{root:"span"},root:fy(Ry("span",{ref:t,...e}),{elementType:"span"})}})(e,r);return(e=>{const t=tS();e.root.className=$y("fui-Text",t.root,!1===e.wrap&&t.nowrap,e.truncate&&t.truncate,e.block&&t.block,e.italic&&t.italic,e.underline&&t.underline,e.strikethrough&&t.strikethrough,e.underline&&e.strikethrough&&t.strikethroughUnderline,100===e.size&&t.base100,200===e.size&&t.base200,400===e.size&&t.base400,500===e.size&&t.base500,600===e.size&&t.base600,700===e.size&&t.hero700,800===e.size&&t.hero800,900===e.size&&t.hero900,1e3===e.size&&t.hero1000,"monospace"===e.font&&t.monospace,"numeric"===e.font&&t.numeric,"medium"===e.weight&&t.weightMedium,"semibold"===e.weight&&t.weightSemibold,"bold"===e.weight&&t.weightBold,"center"===e.align&&t.alignCenter,"end"===e.align&&t.alignEnd,"justify"===e.align&&t.alignJustify,e.root.className)})(o),o.root.className=$y(n,o.root.className,i.root,e.className),(e=>vm(e.root,{}))(o)});return i.displayName=r,i}const rS=nS({useStyles:eS({root:{Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"flh3ekv",Bg96gwp:"fwrc4pm"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".flh3ekv{font-weight:var(--fontWeightBold);}",".fwrc4pm{line-height:var(--lineHeightBase200);}"]}),className:"fui-Caption1Stronger",displayName:"Caption1Stronger"}),iS=nS({useStyles:eS({root:{Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}"]}),className:"fui-Caption1",displayName:"Caption1"}),oS="Enter",aS=" ",sS=e=>{const t=V.useRef(()=>{throw new Error("Cannot call an event handler while rendering")});return Py(()=>{t.current=e},[e]),V.useCallback((...e)=>(0,t.current)(...e),[t])};function lS(e,t){const{disabled:n,disabledFocusable:r=!1,"aria-disabled":i,onClick:o,onKeyDown:a,onKeyUp:s,...l}=null!=t?t:{},c="string"==typeof i?"true"===i:i,u=n||r||c,d=sS(e=>{u?(e.preventDefault(),e.stopPropagation()):null==o||o(e)}),f=sS(e=>{if(null==a||a(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===oS||t===aS))return e.preventDefault(),void e.stopPropagation();t!==aS?t===oS&&(e.preventDefault(),e.currentTarget.click()):e.preventDefault()}),p=sS(e=>{if(null==s||s(e),e.isDefaultPrevented())return;const t=e.key;if(u&&(t===oS||t===aS))return e.preventDefault(),void e.stopPropagation();t===aS&&(e.preventDefault(),e.currentTarget.click())});if("button"===e||void 0===e)return{...l,disabled:n&&!r,"aria-disabled":!!r||c,onClick:r?void 0:d,onKeyUp:r?void 0:s,onKeyDown:r?void 0:a};{const t=!!l.href;let i=t?void 0:"button";!i&&u&&(i="link");const o={role:i,tabIndex:r||!t&&!n?0:void 0,...l,onClick:d,onKeyUp:p,onKeyDown:f,"aria-disabled":u};return"a"===e&&u&&(o.href=void 0),o}}const cS=V.createContext(void 0),uS={},dS=(cS.Provider,(e,t)=>{const{size:n}=null!==(r=V.useContext(cS))&&void 0!==r?r:uS;var r;const{appearance:i="secondary",as:o="button",disabled:a=!1,disabledFocusable:s=!1,icon:l,iconPosition:c="before",shape:u="rounded",size:d=(null!=n?n:"medium")}=e,f=py(l,{elementType:"span"});return{appearance:i,disabled:a,disabledFocusable:s,iconPosition:c,shape:u,size:d,iconOnly:Boolean((null==f?void 0:f.children)&&!e.children),components:{root:"button",icon:"span"},root:fy(Ry(o,lS(e.as,e)),{elementType:"button",defaultProps:{ref:t,type:"button"===o?"button":void 0}}),icon:f}});function fS(e,t,n){const r=function(e,t,n,r=Dy){const i=r();return function(r){const{dir:o,renderer:a}=r,s="ltr"===o?e:t||e;return i(a,Array.isArray(n)?{r:n}:n),s}}(e,t,n,Zy);return function(){const e=bm(),t=Zm();return r({dir:e,renderer:t})}}const pS=fS("r1alrhcs",null,{r:[".r1alrhcs{align-items:center;box-sizing:border-box;display:inline-flex;justify-content:center;text-decoration-line:none;vertical-align:middle;margin:0;overflow:hidden;background-color:var(--colorNeutralBackground1);color:var(--colorNeutralForeground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);font-family:var(--fontFamilyBase);outline-style:none;padding:5px var(--spacingHorizontalM);min-width:96px;border-radius:var(--borderRadiusMedium);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightSemibold);line-height:var(--lineHeightBase300);transition-duration:var(--durationFaster);transition-property:background,border,color;transition-timing-function:var(--curveEasyEase);}",".r1alrhcs:hover{background-color:var(--colorNeutralBackground1Hover);border-color:var(--colorNeutralStroke1Hover);color:var(--colorNeutralForeground1Hover);cursor:pointer;}",".r1alrhcs:hover:active{background-color:var(--colorNeutralBackground1Pressed);border-color:var(--colorNeutralStroke1Pressed);color:var(--colorNeutralForeground1Pressed);outline-style:none;}",".r1alrhcs[data-fui-focus-visible]{border-color:var(--colorStrokeFocus2);border-radius:var(--borderRadiusMedium);border-width:1px;outline:var(--strokeWidthThick) solid var(--colorTransparentStroke);box-shadow:0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;z-index:1;}"],s:["@media screen and (prefers-reduced-motion: reduce){.r1alrhcs{transition-duration:0.01ms;}}","@media (forced-colors: active){.r1alrhcs:focus{border-color:ButtonText;}.r1alrhcs:hover{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}.r1alrhcs:hover:active{background-color:HighlightText;border-color:Highlight;color:Highlight;forced-color-adjust:none;}}","@supports (-moz-appearance:button){.r1alrhcs[data-fui-focus-visible]{box-shadow:0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),hS=fS("rywnvv2",null,[".rywnvv2{align-items:center;display:inline-flex;justify-content:center;font-size:20px;height:20px;width:20px;--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}"]),vS=eS({outline:{De3pzq:"f1c21dwh",Jwef8y:"fjxutwb",iro3zm:"fwiml72"},primary:{De3pzq:"ffp7eso",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"f1phragk",Jwef8y:"f15wkkf3",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f1rq72xc",iro3zm:"fnp9lpt",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1d6v5y2",Bsw6fvg:"f1rirnrt",Bjwas2f:"f1uu00uk",Bn1d65q:["fkvaka8","f9a0qzu"],Bxeuatn:"f1ux7til",n51gp8:["f9a0qzu","fkvaka8"],Bbusuzp:"f1lkg8j3",ycbfsm:"fkc42ay",Bqrx1nm:"fq7113v",pgvf35:"ff1wgvm",Bh7lczh:["fiob0tu","f1x4h75k"],dpv3f4:"f1j6scgf",Bpnjhaq:["f1x4h75k","fiob0tu"],ze5xyy:"f4xjyn1",g2kj27:"fbgcvur",Bf756sw:"f1ks1yx8",Bow2dr7:["f1o6qegi","fmxjhhp"],Bvhedfk:"fcnxywj",Gye4lf:["fmxjhhp","f1o6qegi"],pc6evw:"f9ddjv3"},secondary:{},subtle:{De3pzq:"fhovq9v",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"f1t94bn6",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"fnwyq0v",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",Bbdnnc7:"fy5bs14",iro3zm:"fsv2rcd",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1omzyqd",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",x3br3k:"fj8yq94",ze5xyy:"f4xjyn1",Bx3q9su:"f1et0tmh",pc6evw:"f9ddjv3",xd2cci:"f1wi8ngl"},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],sj55zd:"fkfq4zb",Jwef8y:"fjxutwb",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],Bi91k9c:"f139oj5f",Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",iro3zm:"fwiml72",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"],B2d53fq:"f1fg1p5m",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9",Bqrx1nm:"f1tme0vf",ze5xyy:"f4xjyn1",g2kj27:"f18onu3q",pc6evw:"f9ddjv3"},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{},square:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw"},small:{Bf4jedk:"fh7ncta",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fneth5b",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm"},smallWithIcon:{Byoj8tv:"f1brlhvm",z8tnut:"f1sl3k7w"},medium:{},large:{Bf4jedk:"f14es27b",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f4db1ww",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},largeWithIcon:{Byoj8tv:"fy7v416",z8tnut:"f1a1bwwz"}},{d:[".f1c21dwh{background-color:var(--colorTransparentBackground);}",".ffp7eso{background-color:var(--colorBrandBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}",".f1phragk{color:var(--colorNeutralForegroundOnBrand);}",".fhovq9v{background-color:var(--colorSubtleBackground);}",".fkfq4zb{color:var(--colorNeutralForeground2);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".fh7ncta{min-width:64px;}",[".fneth5b{padding:3px var(--spacingHorizontalS);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1brlhvm{padding-bottom:1px;}",".f1sl3k7w{padding-top:1px;}",".f14es27b{min-width:96px;}",[".f4db1ww{padding:8px var(--spacingHorizontalL);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fy7v416{padding-bottom:7px;}",".f1a1bwwz{padding-top:7px;}"],h:[".fjxutwb:hover{background-color:var(--colorTransparentBackgroundHover);}",".fwiml72:hover:active{background-color:var(--colorTransparentBackgroundPressed);}",".f15wkkf3:hover{background-color:var(--colorBrandBackgroundHover);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1rq72xc:hover{color:var(--colorNeutralForegroundOnBrand);}",".fnp9lpt:hover:active{background-color:var(--colorBrandBackgroundPressed);}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}",".f1d6v5y2:hover:active{color:var(--colorNeutralForegroundOnBrand);}",".f1t94bn6:hover{background-color:var(--colorSubtleBackgroundHover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}",".ft1hn21:hover .fui-Icon-filled{display:inline;}",".fuxngvv:hover .fui-Icon-regular{display:none;}",".fy5bs14:hover .fui-Button__icon{color:var(--colorNeutralForeground2BrandHover);}",".fsv2rcd:hover:active{background-color:var(--colorSubtleBackgroundPressed);}",".f1omzyqd:hover:active{color:var(--colorNeutralForeground2Pressed);}",".f1dfjoow:hover:active .fui-Icon-filled{display:inline;}",".f1j98vj9:hover:active .fui-Icon-regular{display:none;}",".fj8yq94:hover:active .fui-Button__icon{color:var(--colorNeutralForeground2BrandPressed);}",".f139oj5f:hover{color:var(--colorNeutralForeground2BrandHover);}",".f1fg1p5m:hover:active{color:var(--colorNeutralForeground2BrandPressed);}"],m:[["@media (forced-colors: active){.f1rirnrt{background-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1uu00uk{border-top-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9a0qzu{border-left-color:HighlightText;}.fkvaka8{border-right-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ux7til{border-bottom-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lkg8j3{color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fkc42ay{forced-color-adjust:none;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fq7113v:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.ff1wgvm:hover{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1x4h75k:hover{border-left-color:Highlight;}.fiob0tu:hover{border-right-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1j6scgf:hover{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4xjyn1:hover{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fbgcvur:hover:active{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1ks1yx8:hover:active{border-top-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1o6qegi:hover:active{border-right-color:Highlight;}.fmxjhhp:hover:active{border-left-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fcnxywj:hover:active{border-bottom-color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f9ddjv3:hover:active{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1et0tmh:hover .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1wi8ngl:hover:active .fui-Button__icon{color:Highlight;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1tme0vf:hover{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18onu3q:hover:active{background-color:var(--colorTransparentBackground);}}",{m:"(forced-colors: active)"}]]}),gS=eS({base:{De3pzq:"f1bg9a2p",g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],sj55zd:"f1s2aq7o",Bceei9c:"fdrzuqr",Bfinmwp:"f15x8b5r",Jwef8y:"f1falr9n",Bgoe8wy:"f12mpcsy",Bwzppfd:["f1gwvigk","f18rmfxp"],oetu4i:"f1jnshp0",gg5e9n:["f18rmfxp","f1gwvigk"],Bi91k9c:"fvgxktp",eoavqd:"fphbwmw",Bk3fhr4:"f19vpps7",Bmfj8id:"fv5swzo",Bbdnnc7:"f1al02dq",iro3zm:"f1t6o4dc",b661bw:"f10ztigi",Bk6r4ia:["f1ft5sdu","f1gzf82w"],B9zn80p:"f12zbtn2",Bpld233:["f1gzf82w","f1ft5sdu"],B2d53fq:"fcvwxyo",c3iz72:"f8w4c43",em6i61:"f1ol4fw6",vm6p8p:"f1q1lw4e",x3br3k:"f1dwjv2g"},highContrast:{Bsw6fvg:"f4lkoma",Bjwas2f:"fg455y9",Bn1d65q:["f1rvyvqg","f14g86mu"],Bxeuatn:"f1cwzwz",n51gp8:["f14g86mu","f1rvyvqg"],Bbusuzp:"f1dcs8yz",Bm2fdqk:"fuigjrg",G867l3:"fjwq6ea",gdbnj:["f1lr3nhc","f1mbxvi6"],mxns5l:"fn5gmvv",o3nasb:["f1mbxvi6","f1lr3nhc"],Bqrx1nm:"f1vmkb5g",pgvf35:"f53ppgq",Bh7lczh:["f1663y11","f80fkiy"],dpv3f4:"f18v5270",Bpnjhaq:["f80fkiy","f1663y11"],ze5xyy:"f1kc2mi9",Bx3q9su:"f4dhi0o",g2kj27:"f1y0svfh",Bf756sw:"fihuait",Bow2dr7:["fnxhupq","fyd6l6x"],Bvhedfk:"fx507ft",Gye4lf:["fyd6l6x","fnxhupq"],pc6evw:"fb3rf2x",xd2cci:"fequ9m0"},outline:{De3pzq:"f1c21dwh",Jwef8y:"f9ql6rf",iro3zm:"f3h1zc4"},primary:{g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},secondary:{},subtle:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]},transparent:{De3pzq:"f1c21dwh",g2u3we:"f1p3nwhy",h3c5rm:["f11589ue","f1pdflbu"],B9xav0g:"f1q5o8ev",zhjwy3:["f1pdflbu","f11589ue"],Jwef8y:"f9ql6rf",Bgoe8wy:"f1s2uweq",Bwzppfd:["fr80ssc","fecsdlb"],oetu4i:"f1ukrpxl",gg5e9n:["fecsdlb","fr80ssc"],iro3zm:"f3h1zc4",b661bw:"f1h0usnq",Bk6r4ia:["fs4ktlq","fx2bmrt"],B9zn80p:"f16h9ulv",Bpld233:["fx2bmrt","fs4ktlq"]}},{d:[".f1bg9a2p{background-color:var(--colorNeutralBackgroundDisabled);}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".fdrzuqr{cursor:not-allowed;}",".f15x8b5r .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1p3nwhy{border-top-color:transparent;}",".f11589ue{border-right-color:transparent;}",".f1pdflbu{border-left-color:transparent;}",".f1q5o8ev{border-bottom-color:transparent;}"],h:[".f1falr9n:hover{background-color:var(--colorNeutralBackgroundDisabled);}",".f12mpcsy:hover{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1gwvigk:hover{border-right-color:var(--colorNeutralStrokeDisabled);}",".f18rmfxp:hover{border-left-color:var(--colorNeutralStrokeDisabled);}",".f1jnshp0:hover{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fvgxktp:hover{color:var(--colorNeutralForegroundDisabled);}",".fphbwmw:hover{cursor:not-allowed;}",".f19vpps7:hover .fui-Icon-filled{display:none;}",".fv5swzo:hover .fui-Icon-regular{display:inline;}",".f1al02dq:hover .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f1t6o4dc:hover:active{background-color:var(--colorNeutralBackgroundDisabled);}",".f10ztigi:hover:active{border-top-color:var(--colorNeutralStrokeDisabled);}",".f1ft5sdu:hover:active{border-right-color:var(--colorNeutralStrokeDisabled);}",".f1gzf82w:hover:active{border-left-color:var(--colorNeutralStrokeDisabled);}",".f12zbtn2:hover:active{border-bottom-color:var(--colorNeutralStrokeDisabled);}",".fcvwxyo:hover:active{color:var(--colorNeutralForegroundDisabled);}",".f8w4c43:hover:active{cursor:not-allowed;}",".f1ol4fw6:hover:active .fui-Icon-filled{display:none;}",".f1q1lw4e:hover:active .fui-Icon-regular{display:inline;}",".f1dwjv2g:hover:active .fui-Button__icon{color:var(--colorNeutralForegroundDisabled);}",".f9ql6rf:hover{background-color:var(--colorTransparentBackground);}",".f3h1zc4:hover:active{background-color:var(--colorTransparentBackground);}",".f1s2uweq:hover{border-top-color:transparent;}",".fr80ssc:hover{border-right-color:transparent;}",".fecsdlb:hover{border-left-color:transparent;}",".f1ukrpxl:hover{border-bottom-color:transparent;}",".f1h0usnq:hover:active{border-top-color:transparent;}",".fs4ktlq:hover:active{border-right-color:transparent;}",".fx2bmrt:hover:active{border-left-color:transparent;}",".f16h9ulv:hover:active{border-bottom-color:transparent;}"],m:[["@media (forced-colors: active){.f4lkoma{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fg455y9{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f14g86mu{border-left-color:GrayText;}.f1rvyvqg{border-right-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1cwzwz{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fuigjrg .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fjwq6ea:focus{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1lr3nhc:focus{border-right-color:GrayText;}.f1mbxvi6:focus{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fn5gmvv:focus{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1vmkb5g:hover{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f53ppgq:hover{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1663y11:hover{border-right-color:GrayText;}.f80fkiy:hover{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f18v5270:hover{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1kc2mi9:hover{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f4dhi0o:hover .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f1y0svfh:hover:active{background-color:ButtonFace;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fihuait:hover:active{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fnxhupq:hover:active{border-right-color:GrayText;}.fyd6l6x:hover:active{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fx507ft:hover:active{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fb3rf2x:hover:active{color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fequ9m0:hover:active .fui-Button__icon{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),mS=eS({circular:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1062rbf"},rounded:{},square:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fj0ryk1"},primary:{B8q5s1w:"f17t0x8g",Bci5o5g:["f194v5ow","fk7jm04"],n8qw10:"f1qgg65p",Bdrgwmp:["fk7jm04","f194v5ow"],j6ew2k:["fhgccpy","fjo7pq6"],he4mth:"f32wu9k",Byr4aka:"fu5nqqq",lks7q5:["f13prjl2","f1nl83rv"],Bnan3qt:"f1czftr5",k1dn9:["f1nl83rv","f13prjl2"],Boium3a:["f12k37oa","fdnykm2"],tm8e47:"fr96u23"},small:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"fazmxh"},medium:{},large:{Bw81rd7:0,kdpuga:0,dm238s:0,B6xbmo0:0,B3whbx2:"f1b6alqh"}},{d:[[".f1062rbf[data-fui-focus-visible]{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".fj0ryk1[data-fui-focus-visible]{border-radius:var(--borderRadiusNone);}",{p:-1}],".f17t0x8g[data-fui-focus-visible]{border-top-color:var(--colorStrokeFocus2);}",".f194v5ow[data-fui-focus-visible]{border-right-color:var(--colorStrokeFocus2);}",".fk7jm04[data-fui-focus-visible]{border-left-color:var(--colorStrokeFocus2);}",".f1qgg65p[data-fui-focus-visible]{border-bottom-color:var(--colorStrokeFocus2);}",".fhgccpy[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".fjo7pq6[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}",".f32wu9k[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 var(--strokeWidthThin) var(--colorStrokeFocus2) inset;}",".fu5nqqq[data-fui-focus-visible]:hover{border-top-color:var(--colorStrokeFocus2);}",".f13prjl2[data-fui-focus-visible]:hover{border-right-color:var(--colorStrokeFocus2);}",".f1nl83rv[data-fui-focus-visible]:hover{border-left-color:var(--colorStrokeFocus2);}",".f1czftr5[data-fui-focus-visible]:hover{border-bottom-color:var(--colorStrokeFocus2);}",[".fazmxh[data-fui-focus-visible]{border-radius:var(--borderRadiusSmall);}",{p:-1}],[".f1b6alqh[data-fui-focus-visible]{border-radius:var(--borderRadiusLarge);}",{p:-1}]],t:["@supports (-moz-appearance:button){.f12k37oa[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}.fdnykm2[data-fui-focus-visible]{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset,0 0 0 var(--strokeWidthThick) var(--colorNeutralForegroundOnBrand) inset;}}","@supports (-moz-appearance:button){.fr96u23[data-fui-focus-visible]:hover{box-shadow:var(--shadow2),0 0 0 calc(var(--strokeWidthThin) + 0.25px) var(--colorStrokeFocus2) inset;}}"]}),yS=eS({small:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fu97m5z",Bf4jedk:"f17fgpbq",B2u0y6b:"f1jt17bm"},medium:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f18ktai2",Bf4jedk:"fwbmr0d",B2u0y6b:"f44c6la"},large:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1hbd1aw",Bf4jedk:"f12clzc2",B2u0y6b:"fjy1crr"}},{d:[[".fu97m5z{padding:1px;}",{p:-1}],".f17fgpbq{min-width:24px;}",".f1jt17bm{max-width:24px;}",[".f18ktai2{padding:5px;}",{p:-1}],".fwbmr0d{min-width:32px;}",".f44c6la{max-width:32px;}",[".f1hbd1aw{padding:7px;}",{p:-1}],".f12clzc2{min-width:40px;}",".fjy1crr{max-width:40px;}"]}),SS=eS({small:{Be2twd7:"fe5j1ua",Bqenvij:"fjamq6b",a9b677:"f64fuq3",Bqrlyyl:"fbaiahx"},medium:{},large:{Be2twd7:"f1rt2boy",Bqenvij:"frvgh55",a9b677:"fq4mcun",Bqrlyyl:"f1exjqw5"},before:{t21cq0:["f1nizpg2","f1a695kz"]},after:{Frg6f3:["f1a695kz","f1nizpg2"]}},{d:[".fe5j1ua{font-size:20px;}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".fbaiahx{--fui-Button__icon--spacing:var(--spacingHorizontalXS);}",".f1rt2boy{font-size:24px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".f1exjqw5{--fui-Button__icon--spacing:var(--spacingHorizontalSNudge);}",".f1nizpg2{margin-right:var(--fui-Button__icon--spacing);}",".f1a695kz{margin-left:var(--fui-Button__icon--spacing);}"]}),bS=V.forwardRef((e,t)=>{const n=dS(e,t);return(e=>{const t=pS(),n=hS(),r=vS(),i=gS(),o=mS(),a=yS(),s=SS(),{appearance:l,disabled:c,disabledFocusable:u,icon:d,iconOnly:f,iconPosition:p,shape:h,size:v}=e;e.root.className=$y("fui-Button",t,l&&r[l],r[v],d&&"small"===v&&r.smallWithIcon,d&&"large"===v&&r.largeWithIcon,r[h],(c||u)&&i.base,(c||u)&&i.highContrast,l&&(c||u)&&i[l],"primary"===l&&o.primary,o[v],o[h],f&&a[v],e.root.className),e.icon&&(e.icon.className=$y("fui-Button__icon",n,!!e.root.children&&s[p],s[v],e.icon.className))})(n),Pm("useButtonStyles_unstable")(n),(e=>{const{iconOnly:t,iconPosition:n}=e;return gm(e.root,{children:["after"!==n&&e.icon&&vm(e.icon,{}),!t&&e.root.children,"after"===n&&e.icon&&vm(e.icon,{})]})})(n)});function wS(e){return e.reduce(function(e,t){var n=t[0],r=t[1];return e[n]=r,e[r]=n,e},{})}function kS(e){return"number"==typeof e}function ES(e,t){return-1!==e.indexOf(t)}function AS(e,t,n,r){return t+(i=n,0===parseFloat(i)?i:"-"===i[0]?i.slice(1):"-"+i)+r;var i}function CS(e){return e.replace(/ +/g," ").split(" ").map(function(e){return e.trim()}).filter(Boolean).reduce(function(e,t){var n=e.list,r=e.state,i=(t.match(/\(/g)||[]).length,o=(t.match(/\)/g)||[]).length;return r.parensDepth>0?n[n.length-1]=n[n.length-1]+" "+t:n.push(t),r.parensDepth+=i-o,{list:n,state:r}},{list:[],state:{parensDepth:0}}).list}function IS(e){var t=CS(e);if(t.length<=3||t.length>4)return e;var n=t[0],r=t[1],i=t[2];return[n,t[3],i,r].join(" ")}bS.displayName="Button";var TS={padding:function(e){var t=e.value;return kS(t)?t:IS(t)},textShadow:function(e){return function(e){for(var t=[],n=0,r=0,i=!1;r<e.length;)i||","!==e[r]?"("===e[r]?(i=!0,r++):")"===e[r]?(i=!1,r++):r++:(t.push(e.substring(n,r).trim()),n=++r);return n!=r&&t.push(e.substring(n,r+1)),t}(e.value).map(function(e){return e.replace(/(^|\s)(-*)([.|\d]+)/,function(e,t,n,r){return"0"===r?e:t+(""===n?"-":"")+r})}).join(",")},borderColor:function(e){return IS(e.value)},borderRadius:function(e){var t=e.value;if(kS(t))return t;if(ES(t,"/")){var n=t.split("/"),r=n[0],i=n[1];return TS.borderRadius({value:r.trim()})+" / "+TS.borderRadius({value:i.trim()})}var o=CS(t);switch(o.length){case 2:return o.reverse().join(" ");case 4:var a=o[0],s=o[1],l=o[2];return[s,a,o[3],l].join(" ");default:return t}},background:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,i=e.bgImgDirectionRegex,o=e.bgPosDirectionRegex;if(kS(t))return t;var a=t.replace(/(url\(.*?\))|(rgba?\(.*?\))|(hsl\(.*?\))|(#[a-fA-F0-9]+)|((^| )(\D)+( |$))/g,"").trim();return t=t.replace(a,TS.backgroundPosition({value:a,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:o})),TS.backgroundImage({value:t,valuesToConvert:n,bgImgDirectionRegex:i})},backgroundImage:function(e){var t=e.value,n=e.valuesToConvert,r=e.bgImgDirectionRegex;return ES(t,"url(")||ES(t,"linear-gradient(")?t.replace(r,function(e,t,r){return e.replace(r,n[r])}):t},backgroundPosition:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,i=e.bgPosDirectionRegex;return t.replace(r?/^((-|\d|\.)+%)/:null,function(e,t){return function(e){var t=e.indexOf(".");if(-1===t)e=100-parseFloat(e)+"%";else{var n=e.length-t-2;e=(e=100-parseFloat(e)).toFixed(n)+"%"}return e}(t)}).replace(i,function(e){return n[e]})},backgroundPositionX:function(e){var t=e.value,n=e.valuesToConvert,r=e.isRtl,i=e.bgPosDirectionRegex;return kS(t)?t:TS.backgroundPosition({value:t,valuesToConvert:n,isRtl:r,bgPosDirectionRegex:i})},transition:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){var t=e.split(" ");return t[0]=n[t[0]]||t[0],t.join(" ")}).join(", ")},transitionProperty:function(e){var t=e.value,n=e.propertiesToConvert;return t.split(/,\s*/g).map(function(e){return n[e]||e}).join(", ")},transform:function(e){var t=e.value,n="[^\\u0020-\\u007e]",r="(?:(?:(?:\\[0-9a-f]{1,6})(?:\\r\\n|\\s)?)|\\\\[^\\r\\n\\f0-9a-f])",i="((?:-?(?:[0-9]*\\.[0-9]+|[0-9]+)(?:\\s*(?:em|ex|px|cm|mm|in|pt|pc|deg|rad|grad|ms|s|hz|khz|%)|-?(?:[_a-z]|"+n+"|"+r+")(?:[_a-z0-9-]|"+n+"|"+r+")*)?)|(?:inherit|auto))",o=new RegExp("(translateX\\s*\\(\\s*)"+i+"(\\s*\\))","gi"),a=new RegExp("(translate\\s*\\(\\s*)"+i+"((?:\\s*,\\s*"+i+"){0,1}\\s*\\))","gi"),s=new RegExp("(translate3d\\s*\\(\\s*)"+i+"((?:\\s*,\\s*"+i+"){0,2}\\s*\\))","gi"),l=new RegExp("(rotate[ZY]?\\s*\\(\\s*)"+i+"(\\s*\\))","gi");return t.replace(o,AS).replace(a,AS).replace(s,AS).replace(l,AS)}};TS.objectPosition=TS.backgroundPosition,TS.margin=TS.padding,TS.borderWidth=TS.padding,TS.boxShadow=TS.textShadow,TS.webkitBoxShadow=TS.boxShadow,TS.mozBoxShadow=TS.boxShadow,TS.WebkitBoxShadow=TS.boxShadow,TS.MozBoxShadow=TS.boxShadow,TS.borderStyle=TS.borderColor,TS.webkitTransform=TS.transform,TS.mozTransform=TS.transform,TS.WebkitTransform=TS.transform,TS.MozTransform=TS.transform,TS.transformOrigin=TS.backgroundPosition,TS.webkitTransformOrigin=TS.transformOrigin,TS.mozTransformOrigin=TS.transformOrigin,TS.WebkitTransformOrigin=TS.transformOrigin,TS.MozTransformOrigin=TS.transformOrigin,TS.webkitTransition=TS.transition,TS.mozTransition=TS.transition,TS.WebkitTransition=TS.transition,TS.MozTransition=TS.transition,TS.webkitTransitionProperty=TS.transitionProperty,TS.mozTransitionProperty=TS.transitionProperty,TS.WebkitTransitionProperty=TS.transitionProperty,TS.MozTransitionProperty=TS.transitionProperty,TS["text-shadow"]=TS.textShadow,TS["border-color"]=TS.borderColor,TS["border-radius"]=TS.borderRadius,TS["background-image"]=TS.backgroundImage,TS["background-position"]=TS.backgroundPosition,TS["background-position-x"]=TS.backgroundPositionX,TS["object-position"]=TS.objectPosition,TS["border-width"]=TS.padding,TS["box-shadow"]=TS.textShadow,TS["-webkit-box-shadow"]=TS.textShadow,TS["-moz-box-shadow"]=TS.textShadow,TS["border-style"]=TS.borderColor,TS["-webkit-transform"]=TS.transform,TS["-moz-transform"]=TS.transform,TS["transform-origin"]=TS.transformOrigin,TS["-webkit-transform-origin"]=TS.transformOrigin,TS["-moz-transform-origin"]=TS.transformOrigin,TS["-webkit-transition"]=TS.transition,TS["-moz-transition"]=TS.transition,TS["transition-property"]=TS.transitionProperty,TS["-webkit-transition-property"]=TS.transitionProperty,TS["-moz-transition-property"]=TS.transitionProperty;var xS=wS([["paddingLeft","paddingRight"],["marginLeft","marginRight"],["left","right"],["borderLeft","borderRight"],["borderLeftColor","borderRightColor"],["borderLeftStyle","borderRightStyle"],["borderLeftWidth","borderRightWidth"],["borderTopLeftRadius","borderTopRightRadius"],["borderBottomLeftRadius","borderBottomRightRadius"],["padding-left","padding-right"],["margin-left","margin-right"],["border-left","border-right"],["border-left-color","border-right-color"],["border-left-style","border-right-style"],["border-left-width","border-right-width"],["border-top-left-radius","border-top-right-radius"],["border-bottom-left-radius","border-bottom-right-radius"]]),RS=["content"],OS=wS([["ltr","rtl"],["left","right"],["w-resize","e-resize"],["sw-resize","se-resize"],["nw-resize","ne-resize"]]),PS=new RegExp("(^|\\W|_)((ltr)|(rtl)|(left)|(right))(\\W|_|$)","g"),NS=new RegExp("(left)|(right)");function FS(e){return Object.keys(e).reduce(function(t,n){var r=e[n];if("string"==typeof r&&(r=r.trim()),ES(RS,n))return t[n]=r,t;var i=BS(n,r),o=i.key,a=i.value;return t[o]=a,t},Array.isArray(e)?[]:{})}function BS(e,t){var n,r=/\/\*\s?@noflip\s?\*\//.test(t),i=r?e:xS[n=e]||n,o=r?t:function(e,t){if(!function(e){return!("boolean"==typeof e||function(e){return null==e}(e))}(t))return t;if((n=t)&&"object"==typeof n)return FS(t);var n,r,i=kS(t),o=function(e){return"function"==typeof e}(t),a=i||o?t:t.replace(/ !important.*?$/,""),s=!i&&a.length!==t.length,l=TS[e];return r=l?l({value:a,valuesToConvert:OS,propertiesToConvert:xS,isRtl:!0,bgImgDirectionRegex:PS,bgPosDirectionRegex:NS}):OS[a]||a,s?r+" !important":r}(i,t);return{key:i,value:o}}const LS=/[A-Z]/g,DS=/^ms-/,HS={};function _S(e){return"-"+e.toLowerCase()}function MS(e){if(Object.prototype.hasOwnProperty.call(HS,e))return HS[e];if("--"===e.substr(0,2))return e;const t=e.replace(LS,_S);return HS[e]=DS.test(t)?"-"+t:t}function US(e){return"&"===e.charAt(0)?e.slice(1):e}var zS="-moz-",jS="-webkit-",$S="comm",WS="rule",qS="decl",VS="@layer",GS=Math.abs,KS=String.fromCharCode,XS=Object.assign;function QS(e){return e.trim()}function JS(e,t){return(e=t.exec(e))?e[0]:e}function YS(e,t,n){return e.replace(t,n)}function ZS(e,t,n){return e.indexOf(t,n)}function eb(e,t){return 0|e.charCodeAt(t)}function tb(e,t,n){return e.slice(t,n)}function nb(e){return e.length}function rb(e){return e.length}function ib(e,t){return t.push(e),e}function ob(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function ab(e,t,n,r){switch(e.type){case VS:if(e.children.length)break;case"@import":case"@namespace":case qS:return e.return=e.return||e.value;case $S:return"";case"@keyframes":return e.return=e.value+"{"+ob(e.children,r)+"}";case WS:if(!nb(e.value=e.props.join(",")))return""}return nb(n=ob(e.children,r))?e.return=e.value+"{"+n+"}":""}var sb=1,lb=1,cb=0,ub=0,db=0,fb="";function pb(e,t,n,r,i,o,a,s){return{value:e,root:t,parent:n,type:r,props:i,children:o,line:sb,column:lb,length:a,return:"",siblings:s}}function hb(e,t){return XS(pb("",null,null,"",null,null,0,e.siblings),e,{length:-e.length},t)}function vb(){return db=ub>0?eb(fb,--ub):0,lb--,10===db&&(lb=1,sb--),db}function gb(){return db=ub<cb?eb(fb,ub++):0,lb++,10===db&&(lb=1,sb++),db}function mb(){return eb(fb,ub)}function yb(){return ub}function Sb(e,t){return tb(fb,e,t)}function bb(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function wb(e){return sb=lb=1,cb=nb(fb=e),ub=0,[]}function kb(e){return fb="",e}function Eb(e){return QS(Sb(ub-1,Ib(91===e?e+2:40===e?e+1:e)))}function Ab(e){for(;(db=mb())&&db<33;)gb();return bb(e)>2||bb(db)>3?"":" "}function Cb(e,t){for(;--t&&gb()&&!(db<48||db>102||db>57&&db<65||db>70&&db<97););return Sb(e,yb()+(t<6&&32==mb()&&32==gb()))}function Ib(e){for(;gb();)switch(db){case e:return ub;case 34:case 39:34!==e&&39!==e&&Ib(db);break;case 40:41===e&&Ib(e);break;case 92:gb()}return ub}function Tb(e,t){for(;gb()&&e+db!==57&&(e+db!==84||47!==mb()););return"/*"+Sb(t,ub-1)+"*"+KS(47===e?e:gb())}function xb(e){for(;!bb(mb());)gb();return Sb(e,ub)}function Rb(e){return kb(Ob("",null,null,null,[""],e=wb(e),0,[0],e))}function Ob(e,t,n,r,i,o,a,s,l){for(var c=0,u=0,d=a,f=0,p=0,h=0,v=1,g=1,m=1,y=0,S="",b=i,w=o,k=r,E=S;g;)switch(h=y,y=gb()){case 40:if(108!=h&&58==eb(E,d-1)){-1!=ZS(E+=YS(Eb(y),"&","&\f"),"&\f",GS(c?s[c-1]:0))&&(m=-1);break}case 34:case 39:case 91:E+=Eb(y);break;case 9:case 10:case 13:case 32:E+=Ab(h);break;case 92:E+=Cb(yb()-1,7);continue;case 47:switch(mb()){case 42:case 47:ib(Nb(Tb(gb(),yb()),t,n,l),l),5!=bb(h||1)&&5!=bb(mb()||1)||!nb(E)||" "===tb(E,-1,void 0)||(E+=" ");break;default:E+="/"}break;case 123*v:s[c++]=nb(E)*m;case 125*v:case 59:case 0:switch(y){case 0:case 125:g=0;case 59+u:-1==m&&(E=YS(E,/\f/g,"")),p>0&&(nb(E)-d||0===v&&47===h)&&ib(p>32?Fb(E+";",r,n,d-1,l):Fb(YS(E," ","")+";",r,n,d-2,l),l);break;case 59:E+=";";default:if(ib(k=Pb(E,t,n,c,u,i,s,S,b=[],w=[],d,o),o),123===y)if(0===u)Ob(E,t,k,k,b,o,d,s,w);else{switch(f){case 99:if(110===eb(E,3))break;case 108:if(97===eb(E,2))break;default:u=0;case 100:case 109:case 115:}u?Ob(e,k,k,r&&ib(Pb(e,k,k,0,0,i,s,S,i,b=[],d,w),w),i,w,d,s,r?b:w):Ob(E,k,k,k,[""],w,0,s,w)}}c=u=p=0,v=m=1,S=E="",d=a;break;case 58:d=1+nb(E),p=h;default:if(v<1)if(123==y)--v;else if(125==y&&0==v++&&125==vb())continue;switch(E+=KS(y),y*v){case 38:m=u>0?1:(E+="\f",-1);break;case 44:s[c++]=(nb(E)-1)*m,m=1;break;case 64:45===mb()&&(E+=Eb(gb())),f=mb(),u=d=nb(S=E+=xb(yb())),y++;break;case 45:45===h&&2==nb(E)&&(v=0)}}return o}function Pb(e,t,n,r,i,o,a,s,l,c,u,d){for(var f=i-1,p=0===i?o:[""],h=rb(p),v=0,g=0,m=0;v<r;++v)for(var y=0,S=tb(e,f+1,f=GS(g=a[v])),b=e;y<h;++y)(b=QS(g>0?p[y]+" "+S:YS(S,/&\f/g,p[y])))&&(l[m++]=b);return pb(e,t,n,0===i?WS:s,l,c,u,d)}function Nb(e,t,n,r){return pb(e,t,n,$S,KS(db),tb(e,2,-2),0,r)}function Fb(e,t,n,r,i){return pb(e,t,n,qS,tb(e,0,r),tb(e,r+1,-1),r,i)}function Bb(e){var t=rb(e);return function(n,r,i,o){for(var a="",s=0;s<t;s++)a+=e[s](n,r,i,o)||"";return a}}function Lb(e){return function(t){t.root||(t=t.return)&&e(t)}}const Db=e=>{if(e.type===WS){if("string"==typeof e.props)return;e.props=e.props.map(e=>-1===e.indexOf(":global(")?e:function(e){return kb(function(e){for(;gb();)switch(bb(db)){case 0:ib(xb(ub-1),e);break;case 2:ib(Eb(db),e);break;default:ib(KS(db),e)}return e}(wb(e)))}(e).reduce((e,t,n,r)=>{if(""===t)return e;if(":"===t&&"global"===r[n+1]){const t=r[n+2].slice(1,-1)+" ";return e.unshift(t),r[n+1]="",r[n+2]="",e}return e.push(t),e},[]).join(""))}};function Hb(e,t,n){switch(function(e,t){return 45^eb(e,0)?(((t<<2^eb(e,0))<<2^eb(e,1))<<2^eb(e,2))<<2^eb(e,3):0}(e,t)){case 5103:return jS+"print-"+e+e;case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:return jS+e+e;case 4215:if(102===eb(e,9))return jS+e+e;if(116===eb(e,t+1))return jS+e+e;break;case 4789:return zS+e+e;case 5349:case 4246:case 6968:return jS+e+zS+e+e;case 6187:if(!JS(e,/grab/))return YS(YS(YS(e,/(zoom-|grab)/,jS+"$1"),/(image-set)/,jS+"$1"),e,"")+e;case 5495:case 3959:return YS(e,/(image-set\([^]*)/,jS+"$1$`$1");case 4095:case 3583:case 4068:case 2532:return YS(e,/(.+)-inline(.+)/,jS+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(nb(e)-1-t>6)switch(eb(e,t+1)){case 102:if(108===eb(e,t+3))return YS(e,/(.+:)(.+)-([^]+)/,"$1"+jS+"$2-$3$1"+zS+(108==eb(e,t+3)?"$3":"$2-$3"))+e;case 115:return~ZS(e,"stretch")?Hb(YS(e,"stretch","fill-available"),t)+e:e}}return e}function _b(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case qS:return void(e.return=Hb(e.value,e.length));case WS:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,function(t){switch(JS(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return ob([hb(e,{props:[YS(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return ob([hb(e,{props:[YS(t,/:(plac\w+)/,":"+jS+"input-$1")]}),hb(e,{props:[YS(t,/:(plac\w+)/,":-moz-$1")]})],r)}return""})}}const Mb=e=>{(function(e){switch(e.type){case"@container":case"@media":case"@supports":case VS:return!0}return!1})(e)&&Array.isArray(e.children)&&e.children.sort((e,t)=>e.props[0]>t.props[0]?1:-1)};const Ub=/,( *[^ &])/g;function zb(e,t,n){let r=t;return n.length>0&&(r=n.reduceRight((e,t)=>{return`${n=t,"&"+US(n.replace(Ub,",&$1"))} { ${e} }`;var n},t)),`${e}{${r}}`}function jb(e,t){const{className:n,selectors:r,property:i,rtlClassName:o,rtlProperty:a,rtlValue:s,value:l}=e,{container:c,layer:u,media:d,supports:f}=t;let p=zb(`.${n}`,Array.isArray(l)?`${l.map(e=>`${MS(i)}: ${e}`).join(";")};`:`${MS(i)}: ${l};`,r);return a&&o&&(p+=zb(`.${o}`,Array.isArray(s)?`${s.map(e=>`${MS(a)}: ${e}`).join(";")};`:`${MS(a)}: ${s};`,r)),d&&(p=`@media ${d} { ${p} }`),u&&(p=`@layer ${u} { ${p} }`),f&&(p=`@supports ${f} { ${p} }`),c&&(p=`@container ${c} { ${p} }`),function(e){const t=[];return ob(Rb(e),Bb([Db,Mb,_b,ab,Lb(e=>t.push(e))])),t}(p)}function $b(e){let t="";for(const n in e){const r=e[n];if("string"!=typeof r&&"number"!=typeof r){if(Array.isArray(r))for(const e of r)t+=MS(n)+":"+e+";"}else t+=MS(n)+":"+r+";"}return t}function Wb(e){let t="";for(const n in e)t+=`${n}{${$b(e[n])}}`;return t}function qb(e,t){const n=[];return ob(Rb(`@keyframes ${e} {${t}}`),Bb([ab,_b,Lb(e=>n.push(e))])),n}const Vb={animation:[-1,["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimeline","animationTimingFunction"]],animationRange:[-1,["animationRangeEnd","animationRangeStart"]],background:[-2,["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPosition","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"]],backgroundPosition:[-1,["backgroundPositionX","backgroundPositionY"]],border:[-2,["borderBottom","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeft","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRight","borderRightColor","borderRightStyle","borderRightWidth","borderTop","borderTopColor","borderTopStyle","borderTopWidth"]],borderBottom:[-1,["borderBottomColor","borderBottomStyle","borderBottomWidth"]],borderImage:[-1,["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"]],borderLeft:[-1,["borderLeftColor","borderLeftStyle","borderLeftWidth"]],borderRadius:[-1,["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"]],borderRight:[-1,["borderRightColor","borderRightStyle","borderRightWidth"]],borderTop:[-1,["borderTopColor","borderTopStyle","borderTopWidth"]],caret:[-1,["caretColor","caretShape"]],columnRule:[-1,["columnRuleColor","columnRuleStyle","columnRuleWidth"]],columns:[-1,["columnCount","columnWidth"]],containIntrinsicSize:[-1,["containIntrinsicHeight","containIntrinsicWidth"]],container:[-1,["containerName","containerType"]],flex:[-1,["flexBasis","flexGrow","flexShrink"]],flexFlow:[-1,["flexDirection","flexWrap"]],font:[-1,["fontFamily","fontSize","fontStretch","fontStyle","fontVariant","fontWeight","lineHeight"]],gap:[-1,["columnGap","rowGap"]],grid:[-1,["columnGap","gridAutoColumns","gridAutoFlow","gridAutoRows","gridColumnGap","gridRowGap","gridTemplateAreas","gridTemplateColumns","gridTemplateRows","rowGap"]],gridArea:[-1,["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"]],gridColumn:[-1,["gridColumnEnd","gridColumnStart"]],gridRow:[-1,["gridRowEnd","gridRowStart"]],gridTemplate:[-1,["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"]],inset:[-1,["bottom","left","right","top"]],insetBlock:[-1,["insetBlockEnd","insetBlockStart"]],insetInline:[-1,["insetInlineEnd","insetInlineStart"]],listStyle:[-1,["listStyleImage","listStylePosition","listStyleType"]],margin:[-1,["marginBottom","marginLeft","marginRight","marginTop"]],marginBlock:[-1,["marginBlockEnd","marginBlockStart"]],marginInline:[-1,["marginInlineEnd","marginInlineStart"]],mask:[-1,["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPosition","maskRepeat","maskSize"]],maskBorder:[-1,["maskBorderMode","maskBorderOutset","maskBorderRepeat","maskBorderSlice","maskBorderSource","maskBorderWidth"]],offset:[-1,["offsetAnchor","offsetDistance","offsetPath","offsetPosition","offsetRotate"]],outline:[-1,["outlineColor","outlineStyle","outlineWidth"]],overflow:[-1,["overflowX","overflowY"]],overscrollBehavior:[-1,["overscrollBehaviorX","overscrollBehaviorY"]],padding:[-1,["paddingBottom","paddingLeft","paddingRight","paddingTop"]],paddingBlock:[-1,["paddingBlockEnd","paddingBlockStart"]],paddingInline:[-1,["paddingInlineEnd","paddingInlineStart"]],placeContent:[-1,["alignContent","justifyContent"]],placeItems:[-1,["alignItems","justifyItems"]],placeSelf:[-1,["alignSelf","justifySelf"]],scrollMargin:[-1,["scrollMarginBottom","scrollMarginLeft","scrollMarginRight","scrollMarginTop"]],scrollMarginBlock:[-1,["scrollMarginBlockEnd","scrollMarginBlockStart"]],scrollMarginInline:[-1,["scrollMarginInlineEnd","scrollMarginInlineStart"]],scrollPadding:[-1,["scrollPaddingBottom","scrollPaddingLeft","scrollPaddingRight","scrollPaddingTop"]],scrollPaddingBlock:[-1,["scrollPaddingBlockEnd","scrollPaddingBlockStart"]],scrollPaddingInline:[-1,["scrollPaddingInlineEnd","scrollPaddingInlineStart"]],scrollTimeline:[-1,["scrollTimelineAxis","scrollTimelineName"]],textDecoration:[-1,["textDecorationColor","textDecorationLine","textDecorationStyle","textDecorationThickness"]],textEmphasis:[-1,["textEmphasisColor","textEmphasisStyle"]],transition:[-1,["transitionBehavior","transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"]],viewTimeline:[-1,["viewTimelineAxis","viewTimelineName"]]};function Gb(e,t){return 0===e.length?t:`${e} and ${t}`}function Kb(e){return"@media"===e.substr(0,6)}function Xb(e){return"@layer"===e.substr(0,6)}const Qb=/^(:|\[|>|&)/;function Jb(e){return Qb.test(e)}function Yb(e){return"@supports"===e.substr(0,9)}function Zb(e){return"@container"===e.substring(0,10)}function ew(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}const tw={"us-w":"w","us-v":"i",nk:"l",si:"v",cu:"f",ve:"h",ti:"a"};function nw(e,t){if(t.media)return"m";if(t.layer||t.supports)return"t";if(t.container)return"c";if(e.length>0){const t=e[0].trim();if(58===t.charCodeAt(0))return tw[t.slice(4,8)]||tw[t.slice(3,5)]||"d"}return"d"}function rw(e,t){return e?t+e:e}function iw(e){return rw(e.container,"c")+rw(e.media,"m")+rw(e.layer,"l")+rw(e.supports,"s")}function ow(e,t,n){const r=Hy(e+iw(n)+t),i=r.charCodeAt(0);return i>=48&&i<=57?String.fromCharCode(i+17)+r.slice(1):r}function aw({property:e,selector:t,salt:n,value:r},i){return"f"+Hy(n+t+iw(i)+e+r.trim())}function sw(e){return e===qm}function lw(e){return e.replace(/>\s+/g,">")}function cw(e,t){}function uw(e,t){}function dw(e){return Vb[e]}function fw(e){var t;return null!==(t=null==e?void 0:e[0])&&void 0!==t?t:0}function pw(e,t,n,r){e[t]=r?[n,r]:n}function hw(e,t){return t.length>0?[e,Object.fromEntries(t)]:e}function vw(e,t,n,r,i,o){var a;const s=[];0!==o&&s.push(["p",o]),"m"===t&&i&&s.push(["m",i]),null!==(a=e[t])&&void 0!==a||(e[t]=[]),n&&e[t].push(hw(n,s)),r&&e[t].push(hw(r,s))}function gw(e,t="",n=[],r={container:"",layer:"",media:"",supports:""},i={},o={},a){for(const s in e){if(Wm.hasOwnProperty(s)){uw(0,e[s]);continue}const l=e[s];if(null!=l){if(sw(l)){pw(i,ow(lw(n.join("")),s,r),0,void 0);continue}if("string"==typeof l||"number"==typeof l){const e=lw(n.join("")),c=dw(s);if(c){const e=c[1],a=Object.fromEntries(e.map(e=>[e,qm]));gw(a,t,n,r,i,o)}const u=ow(e,s,r),d=aw({value:l.toString(),salt:t,selector:e,property:s},r),f=a&&{key:s,value:a}||BS(s,l),p=f.key!==s||f.value!==l,h=p?aw({value:f.value.toString(),property:f.key,salt:t,selector:e},r):void 0,v=p?{rtlClassName:h,rtlProperty:f.key,rtlValue:f.value}:void 0,g=nw(n,r),[m,y]=jb(Object.assign({className:d,selectors:n,property:s,value:l},v),r);pw(i,u,d,h),vw(o,g,m,y,r.media,fw(c))}else if("animationName"===s){const e=Array.isArray(l)?l:[l],a=[],s=[];for(const t of e){const e=Wb(t),n=Wb(FS(t)),i="f"+Hy(e);let l;const c=qb(i,e);let u=[];e===n?l=i:(l="f"+Hy(n),u=qb(l,n));for(let e=0;e<c.length;e++)vw(o,"k",c[e],u[e],r.media,0);a.push(i),s.push(l)}gw({animationName:a.join(", ")},t,n,r,i,o,s.join(", "))}else if(Array.isArray(l)){if(0===l.length)continue;const e=lw(n.join("")),a=dw(s);if(a){const e=a[1],s=Object.fromEntries(e.map(e=>[e,qm]));gw(s,t,n,r,i,o)}const c=ow(e,s,r),u=aw({value:l.map(e=>(null!=e?e:"").toString()).join(";"),salt:t,selector:e,property:s},r),d=l.map(e=>BS(s,e));if(d.some(e=>e.key!==d[0].key))continue;const f=d[0].key!==s||d.some((e,t)=>e.value!==l[t]),p=f?aw({value:d.map(e=>{var t;return(null!==(t=null==e?void 0:e.value)&&void 0!==t?t:"").toString()}).join(";"),salt:t,property:d[0].key,selector:e},r):void 0,h=f?{rtlClassName:p,rtlProperty:d[0].key,rtlValue:d.map(e=>e.value)}:void 0,v=nw(n,r),[g,m]=jb(Object.assign({className:u,selectors:n,property:s,value:l},h),r);pw(i,c,u,p),vw(o,v,g,m,r.media,fw(a))}else if(ew(l))if(Jb(s))gw(l,t,n.concat(US(s)),r,i,o);else if(Kb(s)){const e=Gb(r.media,s.slice(6).trim());gw(l,t,n,Object.assign({},r,{media:e}),i,o)}else if(Xb(s)){const e=(r.layer?`${r.layer}.`:"")+s.slice(6).trim();gw(l,t,n,Object.assign({},r,{layer:e}),i,o)}else if(Yb(s)){const e=Gb(r.supports,s.slice(9).trim());gw(l,t,n,Object.assign({},r,{supports:e}),i,o)}else if(Zb(s)){const e=s.slice(10).trim();gw(l,t,n,Object.assign({},r,{container:e}),i,o)}else cw()}}return[i,o]}function mw(e){const t=function(e,t=Dy){const n=t();let r=null,i=null,o=null,a=null;return function(t){const{dir:s,renderer:l}=t;null===r&&([r,i]=function(e,t=""){const n={},r={};for(const i in e){const o=e[i],[a,s]=gw(o,t);n[i]=a,Object.keys(s).forEach(e=>{r[e]=(r[e]||[]).concat(s[e])})}return[n,r]}(e,l.classNameHashSalt));const c="ltr"===s;return c?null===o&&(o=Uy(r,s)):null===a&&(a=Uy(r,s)),n(l,i),c?o:a}}(e,Zy);return function(){const e=bm(),n=Zm();return t({dir:e,renderer:n})}}const yw=["Top","Right","Bottom","Left"];function Sw(e,t,...n){const[r,i=r,o=r,a=i]=n,s=[r,i,o,a],l={};for(let n=0;n<s.length;n+=1)(s[n]||0===s[n])&&(l[e+yw[n]+t]=s[n]);return l}function bw(...e){return Sw("border","Width",...e)}function ww(...e){return Sw("border","Style",...e)}function kw(...e){return Sw("border","Color",...e)}const Ew=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function Aw(e){return Ew.includes(e)}const Cw=function(...e){return Aw(e[0])?Object.assign({},ww(e[0]),e[1]&&bw(e[1]),e[2]&&kw(e[2])):Object.assign({},bw(e[0]),e[1]&&ww(e[1]),e[2]&&kw(e[2]))},Iw=function(e,t=e,n=e,r=t){return{borderBottomRightRadius:n,borderBottomLeftRadius:r,borderTopRightRadius:t,borderTopLeftRadius:e}},Tw=function(e,t=e){return{columnGap:e,rowGap:t}},xw=function(...e){return Sw("margin","",...e)},Rw=function(...e){return Sw("padding","",...e)},Ow=eS({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in",ycbfsm:"fg4l7m0"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);transform:scaleX(-1);}"],t:["@media (forced-colors: active){.fg4l7m0{forced-color-adjust:auto;}}"]}),Pw=(e,t)=>{const{title:n,primaryFill:r="currentColor",...i}=e,o={...i,title:void 0,fill:r},a=Ow(),s=V.useContext(Lm)?V.useContext(Lm):Dm;return o.className=$y(a.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==s?void 0:s.textDirection)&&a.rtl,o.className),n&&(o["aria-label"]=n),o["aria-label"]||o["aria-labelledby"]?o.role="img":o["aria-hidden"]=!0,o},Nw=(e,t,n,r)=>{const i="1em"===t?"20":t,o=V.forwardRef((e,o)=>{const a={...Pw(e,{flipInRtl:null==r?void 0:r.flipInRtl}),ref:o,width:t,height:t,viewBox:`0 0 ${i} ${i}`,xmlns:"http://www.w3.org/2000/svg"};return"string"==typeof n?V.createElement("svg",{...a,dangerouslySetInnerHTML:{__html:n}}):V.createElement("svg",a,...n.map(e=>V.createElement("path",{d:e,fill:a.fill})))});return o.displayName=e,o},Fw=Nw("Warning20Filled","20",["M8.68 2.79a1.5 1.5 0 0 1 2.64 0l6.5 12A1.5 1.5 0 0 1 16.5 17h-13a1.5 1.5 0 0 1-1.32-2.21l6.5-12ZM10.5 7.5a.5.5 0 0 0-1 0v4a.5.5 0 0 0 1 0v-4Zm.25 6.25a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"]),Bw=Nw("Dismiss20Filled","20",["m3.9 4.05.07-.08a.75.75 0 0 1 .98-.07l.08.07L10 8.94l4.97-4.97a.75.75 0 0 1 .98-.07l.08.07c.27.27.3.68.07.98l-.07.08L11.06 10l4.97 4.97c.27.27.3.68.07.98l-.07.08a.75.75 0 0 1-.98.07l-.08-.07L10 11.06l-4.97 4.97a.75.75 0 0 1-.98.07l-.08-.07a.75.75 0 0 1-.07-.98l.07-.08L8.94 10 3.97 5.03a.75.75 0 0 1-.07-.98l.07-.08-.07.08Z"]),Lw=({reason:e,hubUiService:t})=>{const n=Dw(),r=t.getErrorUiData(e);console.log("failed reason:",e);const[i,o]=V.useState(!0);return V.createElement(Jy,null,V.createElement("div",{id:"hubBubbleErrorUI",style:{display:i?"flex":"none"},className:n.root},V.createElement("div",{className:n.contentContainer},V.createElement(Fw,{className:n.warning,color:"var(--colorStatusWarningBackground3)"}),V.createElement("div",{className:n.textContainer},V.createElement(rS,null,r.localizedErrorStrings.bubbleHeading),V.createElement(iS,null,r.localizedErrorStrings.bubbleSubtitle)),V.createElement(Bw,{className:n.dismiss,"aria-label":"Dismiss warning bubble",onClick:()=>{o(!1)}})),V.createElement("div",{className:n.buttonContainer},r.openDesktopApp&&V.createElement(bS,{"aria-label":r.localizedErrorStrings.openInDesktopAltText,onClick:()=>{var e;return null===(e=r.openDesktopApp)||void 0===e?void 0:e.call(r)}},r.localizedErrorStrings.openInDesktopButtonTitle),r.openBrowser&&V.createElement(bS,{"aria-label":r.localizedErrorStrings.openInWebBrowserAltText,onClick:()=>{var e;return null===(e=r.openBrowser)||void 0===e?void 0:e.call(r)}},r.localizedErrorStrings.openInWebBrowserButtonTitle),r.openLegacyUrl&&V.createElement(bS,{"aria-label":r.localizedErrorStrings.openInLegacyBrowserAltText,onClick:()=>{var e;return null===(e=r.openLegacyUrl)||void 0===e?void 0:e.call(r)}},r.localizedErrorStrings.openInLegacyBrowserButtonTitle))))},Dw=mw({root:Object.assign(Object.assign(Object.assign({flexDirection:"column",alignItems:"center",textAlign:"center",rowGap:"1em",backgroundColor:"var(--colorStatusWarningBackground1)"},Cw("1px","solid","var(--colorStatusWarningBorder1)")),Rw("1em")),Iw("var(--borderRadiusLarge)")),contentContainer:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"},textContainer:Object.assign(Object.assign(Object.assign({},xw("0","1em")),Tw("0.5em")),{display:"flex",textAlign:"start"}),buttonContainer:Object.assign({display:"flex",marginLeft:"auto"},Tw("1em")),warning:{minWidth:"2em"},dismiss:{minWidth:"2em",marginLeft:"auto"}}),Hw=eS({base:{g2u3we:"fj3muxo",h3c5rm:["f1akhkt","f1lxtadh"],B9xav0g:"f1aperda",zhjwy3:["f1lxtadh","f1akhkt"],Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1fabniw",B7ck84d:"f1ewtqcl",mc9l5x:"f14t3ns0"},bordered:{icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],B4j52fo:"f192inf7",Bekrc4i:["f5tn483","f1ojsxk5"],Bn0qgzm:"f1vxd6vx",ibv6hh:["f1ojsxk5","f5tn483"]},circular:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f44lkw9"},rounded:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5"},square:{},shadow:{E5pizo:"f1whvlc6"},center:{st4lth:"f1plgu50",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},contain:{st4lth:"f1kle4es",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},default:{},cover:{st4lth:"f1ps3kmd",Ermj5k:"f14xojzb",Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},none:{st4lth:"f1plgu50",Ermj5k:["f13uwng7","fjmyj0p"],Bqenvij:"f1l02sjl",a9b677:"fly5x3f"},block:{a9b677:"fly5x3f"}},{d:[".fj3muxo{border-top-color:var(--colorNeutralStroke1);}",".f1akhkt{border-right-color:var(--colorNeutralStroke1);}",".f1lxtadh{border-left-color:var(--colorNeutralStroke1);}",".f1aperda{border-bottom-color:var(--colorNeutralStroke1);}",[".f1fabniw{border-radius:var(--borderRadiusNone);}",{p:-1}],".f1ewtqcl{box-sizing:border-box;}",".f14t3ns0{display:inline-block;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".f192inf7{border-top-width:var(--strokeWidthThin);}",".f5tn483{border-right-width:var(--strokeWidthThin);}",".f1ojsxk5{border-left-width:var(--strokeWidthThin);}",".f1vxd6vx{border-bottom-width:var(--strokeWidthThin);}",[".f44lkw9{border-radius:var(--borderRadiusCircular);}",{p:-1}],[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],".f1whvlc6{box-shadow:var(--shadow4);}",".f1plgu50{object-fit:none;}",".f14xojzb{object-position:center;}",".f1l02sjl{height:100%;}",".fly5x3f{width:100%;}",".f1kle4es{object-fit:contain;}",".f1ps3kmd{object-fit:cover;}",".f13uwng7{object-position:left top;}",".fjmyj0p{object-position:right top;}"]}),_w=V.forwardRef((e,t)=>{const n=((e,t)=>{const{bordered:n=!1,fit:r="default",block:i=!1,shape:o="square",shadow:a=!1}=e;return{bordered:n,fit:r,block:i,shape:o,shadow:a,components:{root:"img"},root:fy(Ry("img",{ref:t,...e}),{elementType:"img"})}})(e,t);return(e=>{const t=Hw();e.root.className=$y("fui-Image",t.base,e.block&&t.block,e.bordered&&t.bordered,e.shadow&&t.shadow,t[e.fit],t[e.shape],e.root.className)})(n),Pm("useImageStyles_unstable")(n),(e=>vm(e.root,{}))(n)});_w.displayName="Image";const Mw=nS({useStyles:eS({root:{Bahqtrf:"fk6fouc",Be2twd7:"fccw675",Bhrd7zp:"fl43uef",Bg96gwp:"f1ebx5kk"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fccw675{font-size:var(--fontSizeHero800);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".f1ebx5kk{line-height:var(--lineHeightHero800);}"]}),className:"fui-Title1",displayName:"Title1"}),Uw=nS({useStyles:eS({root:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"figsok6",Bg96gwp:"faaz57k"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".figsok6{font-weight:var(--fontWeightRegular);}",".faaz57k{line-height:var(--lineHeightBase400);}"]}),className:"fui-Body2",displayName:"Body2"}),zw=Nw("ArrowClockwise20Regular","20",["M4 10a6 6 0 0 1 10.47-4H12.5a.5.5 0 0 0 0 1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-1 0v1.6a7 7 0 1 0 1.98 4.36.5.5 0 1 0-1 .08L16 10a6 6 0 0 1-12 0Z"]),jw=({reason:e,hubUiService:t})=>{var n,r,i,o,a;const s=$w(),l=t.getErrorUiData(e);return V.createElement(Jy,{id:"hubErrorUi",className:s.root},V.createElement("div",{className:s.imageContainer,"aria-label":null===(n=l.errorImage)||void 0===n?void 0:n.altText},"string"==typeof(null===(r=l.errorImage)||void 0===r?void 0:r.image)?V.createElement(_w,{src:null===(i=l.errorImage)||void 0===i?void 0:i.image,alt:null===(o=l.errorImage)||void 0===o?void 0:o.altText}):null===(a=l.errorImage)||void 0===a?void 0:a.image),V.createElement(Mw,null,l.localizedErrorStrings.errorHeading),V.createElement(Uw,null,l.localizedErrorStrings.errorSubtitle),V.createElement("div",{className:s.buttonContainer},l.openDesktopApp&&V.createElement(bS,{"aria-label":l.localizedErrorStrings.openInDesktopAltText||l.localizedErrorStrings.openInDesktopButtonTitle,appearance:"primary",onClick:()=>{var e;return null===(e=l.openDesktopApp)||void 0===e?void 0:e.call(l)}},l.localizedErrorStrings.openInDesktopButtonTitle||l.localizedErrorStrings.openInDesktopAltText),l.openBrowser&&V.createElement(bS,{"aria-label":l.localizedErrorStrings.openInWebBrowserAltText||l.localizedErrorStrings.openInWebBrowserButtonTitle,onClick:()=>{var e;return null===(e=l.openBrowser)||void 0===e?void 0:e.call(l)}},l.localizedErrorStrings.openInWebBrowserButtonTitle),l.openLegacyUrl&&V.createElement(bS,{"aria-label":l.localizedErrorStrings.openInLegacyBrowserAltText||l.localizedErrorStrings.openInLegacyBrowserButtonTitle,onClick:()=>{var e;return null===(e=l.openLegacyUrl)||void 0===e?void 0:e.call(l)}},l.localizedErrorStrings.openInLegacyBrowserButtonTitle),l.retry&&V.createElement(bS,{appearance:"transparent",icon:V.createElement(zw,null),"aria-label":l.localizedErrorStrings.retryButtonAltText||l.localizedErrorStrings.retryButtonTitle,onClick:l.retry},l.localizedErrorStrings.retryButtonTitle)))},$w=mw({root:{display:"flex",height:"100%",width:"100%",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",rowGap:"1em"},buttonContainer:{marginTop:"2em",display:"flex",rowGap:".5em",flexDirection:"column",alignItems:"center","> button":{width:"100%"}},imageContainer:{width:"auto",maxHeight:"33%"}});let Ww;const qw=Date.now(),Vw=e=>{var t;up(op.Start,ap.OverallAppLoadTimeBeforeInitialize),up(op.Start,ap.MetaOsAppContainerInitiation);const n=e.context.page.frameContext;if(e.context.dialogParameters&&"task"!==n)throw new Error('dialogParameters should be provided only in "task" frameContext');let r=e.hubServices;const i=om();V.useEffect(()=>{null==i||i.setLifecycleService(r.lifecycleService)},[i,r.lifecycleService]),Ww=null==i?void 0:i.cacheManagementService,r.lifecycleService&&(r=Object.assign(Object.assign({},e.hubServices),{cacheManagementService:e.hubServices.cacheManagementService||Ww}));const[o,a]=V.useState(!1),s=V.useMemo(()=>{var t,r;const i={appId:e.appDefinition.id,frameContext:n};return null!==(r=null===(t=e.isolationProvider)||void 0===t?void 0:t.communicationBridge)&&void 0!==r?r:Gw(i,e.hubServices.logger)},[null===(t=e.isolationProvider)||void 0===t?void 0:t.communicationBridge,e.contentUrl,e.appDefinition.id,e.hubServices.logger,Ww]),l=(()=>{const[t,n]=V.useState(void 0);return c(void 0,void 0,void 0,function*(){up(op.Start,ap.GetPermissions);const t=yield Xw(e.hubServices.devicePermissionService);up(op.End,ap.GetPermissions);const r=t.map(e=>am[e.permission]).flat(),i=r.concat(["autoplay; clipboard-write"]).join("; ");n(i)}),t})();if(e.hostVersionsInfo&&e.hostVersionsInfo.adaptiveCardSchemaVersion&&Qf(e.hostVersionsInfo.adaptiveCardSchemaVersion))throw new Error("dialogService.cardService requires that the host specifies an adaptive card version of at least 1.5");if((r.locationService||r.barCodeService)&&!r.devicePermissionService)throw new Error("devicePermissionService needs to be provided if any of following services is provided: locationService, barCodeService");var u,d;e.featureFlags&&(u=e.featureFlags,d=Object.assign(Object.assign({},af),u),af=d);const{appHostSdk:f,appInitInfo:p}=((e,t,n,r,i,o,a,s,l)=>{const[c,u]=V.useState({state:Yn.Unknown});return V.useEffect(()=>{c.state===Yn.Failed&&u({state:Yn.Unknown})},[r]),{appHostSdk:V.useMemo(()=>new qg(e,i,t,n,u,o,a,s,l),[e,t.page.frameContext,u,t.app.host.clientType,n.cacheManagementService,i,a,s]),appInitInfo:c}})(e.hostWindow,e.context,r,e.appDefinition,s,e.hostVersionsInfo,e.isNAAChannelRecommended,e.hostInsecureOrigins,e.isCachedLaunch);V.useEffect(()=>{null==i||i.setTelemetryService(f.getTelemetryService())},[f,i]);const h=e.context.app.theme;V.useEffect(()=>{h&&(f.onThemeChanged&&f.onThemeChanged(h),f.onUserSettingsChanged&&f.onUserSettingsChanged(Zd.theme,h))},[f,h]);const v=e.context.app.userFileOpenPreference;V.useEffect(()=>{v&&f.onUserSettingsChanged&&f.onUserSettingsChanged(Zd.fileOpenPreference,v)},[f,v]),V.useEffect(()=>{f.initializeAuthenticationContext(e.context)},[f,e.context]),V.useEffect(()=>function(){f.unloadSDK()},[f]);const[g,m]=V.useState(Kf(p,e.appDefinition.showLoadingIndicator));V.useEffect(()=>{m(Kf(p,e.appDefinition.showLoadingIndicator))},[p,e.appDefinition]),V.useEffect(()=>{g&&p.state===Yn.Loaded&&e.hubServices.logger.log(z.Warn,"Error Bubble Reason",Jn)},[p.state,e.hubServices.logger,g]);const y=Kw(e.appDefinition.showLoadingIndicator,r,p,f.getIsCachedLaunch(),f.getCacheablePageInfo()),S=V.useCallback(()=>Xw(e.hubServices.devicePermissionService),[e.hubServices.devicePermissionService]),b=V.useCallback(()=>g?V.createElement(Lw,{reason:p.reason,hubUiService:e.hubServices.hubUiService}):null,[g,p,e.hubServices.hubUiService]),w=V.useCallback(()=>{var t;if(!((e,t,n,r)=>!!t||void 0!==e&&!(n&&!r))(l,e.isolationProvider,r.lifecycleService,r.cacheManagementService))return null;const i=Object.assign(Object.assign({},e),{sdkHost:f,isLoading:y,frameContext:n,userClickTime:null!==(t=e.context.app.userClickTime)&&void 0!==t?t:qw,userClickTimeV2:e.context.app.userClickTimeV2,communicationBridge:s,getRequiredPermissions:S,allowList:l});return e.isolationProvider?V.createElement(wp,{isolationProvider:e.isolationProvider,hostProps:i,errorUI:b,appHostSdk:f}):V.createElement("div",{id:"default-app-host-container",style:{flex:1,display:"flex",flexDirection:"column"}},b(),r.cacheManagementService&&r.lifecycleService&&n===tf.content?V.createElement(bp,Object.assign({cacheManagementService:r.cacheManagementService},i,{allowList:l,setIsUnLoading:a})):V.createElement(yp,Object.assign({},i)))},[l,f,s,n,S,r.cacheManagementService,r.lifecycleService,y,e,b]),k=V.useMemo(()=>w(),[w]);if(((e,t)=>e.state===Yn.Failed&&t)(p,e.appDefinition.showLoadingIndicator)){const t=f.getTelemetryService().createScenario("errorScreenLoad"),n=p.reason;return t.fail(n),e.hubServices.logger.log(z.Error,"Show HubError UI",n),V.createElement(jw,{reason:n,hubUiService:e.hubServices.hubUiService})}return up(op.End,ap.MetaOsAppContainerInitiation),V.createElement(V.Fragment,null,(y||o)&&r.hubUiService.getLoadingUi(),k)},Gw=(e,t)=>{var n;return null!==(n=null==Ww?void 0:Ww.getCachedCommunicationBridge(e))&&void 0!==n?n:new vp(t)},Kw=(e,t,n,r,i)=>t.cacheManagementService?t.cacheManagementService.shouldDisplayLoadingUI(n,e,r,i):!(!e||n.state!==Yn.Loading&&n.state!==Yn.WaitingForAppLoad),Xw=e=>c(void 0,void 0,void 0,function*(){let t;return t=e?yield e.storageService.getPermissions():[],t.filter(e=>e.status==fr.Consented)});var Qw;function Jw({hubServices:e,user:t,storePageInfo:n,storeAppResource:r,storeTitle:i,theme:o}){const[a,s]=V.useState(n.storeContentUrl);OfficeFirstParty.PrivateApi.onPrivateEvent(e=>{const{type:t,titleId:r}=JSON.parse(e);"navigate"===t&&s(n.getHostClientType(r?Qw.addinDetail:Qw.default,r))});const l=OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.showingLoadingIndicatorFix",!1),c=OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.UnifiedStoreV2Enabled")?"storeV2":"storeV1",u=V.createElement(Vw,{hostWindow:window,hubServices:e,context:{app:{locale:n.locale,theme:o,sessionId:n.sessionId,host:{name:n.hostName,clientType:n.clientType,sessionId:n.sessionId,ringId:n.hostRingId,version:c}},page:{id:"browse",subPageId:JSON.stringify({sourceOrigin:"https://teams.microsoft.com",allowInstall:n.allowInstall,isUpgrade:n.isUpgrade,supportedElementInfo:n.getSupportedElementInfo(),hostName:n.hostName,userHasCopilotLicense:n.userHasCopilotLicense,userHasCopilotApp:n.userHasCopilotLicense,disableAgentsCollection:!n.userHasCopilotLicense}),frameContext:tf.content,isMultiWindow:!1},user:t},appDefinition:{devicePermissions:[],id:n.storeAppId,isFullTrust:!1,isLOB:!1,manifestVersion:"1.0",pages:{configurable:[],static:[{entityId:"browse",contentUrl:a,name:i}]},showLoadingIndicator:l,validDomains:["*.teams.microsoft.com","*.teams.office.com"],version:"0.0.0",webApplicationInfo:{id:n.storeAppId,resource:r}},contentUrl:a,title:i,featureFlags:{createAndSendSignalsToSubstrate:!1}});return OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.DelayLoadingIndicator",!1)?V.createElement("div",{id:"indicatorParent",style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"100%",width:"100%"}},V.createElement("div",{id:"indicator",style:{width:"100%",height:"100%"}},e.hubUiService.getLoadingUi()),V.createElement("div",{id:"containerParent",style:{display:"none",width:"100%",height:"100%"}},u)):u}!function(e){e.default="default",e.addinDetail="addinDetail"}(Qw||(Qw={}));class Yw{constructor(){this.registrations=new Map}addEventListener(e,t){this.registrations.set(e,t)}dispatchEvent(e,t){this.registrations.has(e)&&this.registrations.get(e)(t)}clearListeners(){this.registrations.clear()}}const Zw="#0a0a0a",ek="#141414",tk="#1f1f1f",nk="#242424",rk="#292929",ik="#2e2e2e",ok="#333333",ak="#383838",sk="#3d3d3d",lk="#424242",ck="#575757",uk="#616161",dk="#707070",fk="#adadad",pk="#b3b3b3",hk="#bdbdbd",vk="#d6d6d6",gk="#e0e0e0",mk="#e6e6e6",yk="#ebebeb",Sk="#f0f0f0",bk="#f5f5f5",wk="#fafafa",kk="rgba(255, 255, 255, 0.1)",Ek="rgba(255, 255, 255, 0.2)",Ak="rgba(255, 255, 255, 0.4)",Ck="rgba(255, 255, 255, 0.5)",Ik="rgba(0, 0, 0, 0.05)",Tk="rgba(0, 0, 0, 0.1)",xk="rgba(0, 0, 0, 0.2)",Rk="rgba(0, 0, 0, 0.3)",Ok="rgba(0, 0, 0, 0.5)",Pk="#ffffff",Nk="#000000",Fk={shade50:"#200205",shade40:"#3b0509",shade30:"#6e0811",shade20:"#960b18",shade10:"#b10e1c",primary:"#c50f1f",tint10:"#cc2635",tint20:"#d33f4c",tint30:"#dc626d",tint40:"#eeacb2",tint50:"#f6d1d5",tint60:"#fdf3f4"},Bk={shade50:"#031403",shade40:"#052505",shade30:"#094509",shade20:"#0c5e0c",shade10:"#0e700e",primary:"#107c10",tint10:"#218c21",tint20:"#359b35",tint30:"#54b054",tint40:"#9fd89f",tint50:"#c9eac9",tint60:"#f1faf1"},Lk={red:{shade50:"#210809",shade40:"#3f1011",shade30:"#751d1f",shade20:"#9f282b",shade10:"#bc2f32",primary:"#d13438",tint10:"#d7494c",tint20:"#dc5e62",tint30:"#e37d80",tint40:"#f1bbbc",tint50:"#f8dadb",tint60:"#fdf6f6"},green:Bk,darkOrange:{shade50:"#230900",shade40:"#411200",shade30:"#7a2101",shade20:"#a62d01",shade10:"#c43501",primary:"#da3b01",tint10:"#de501c",tint20:"#e36537",tint30:"#e9835e",tint40:"#f4bfab",tint50:"#f9dcd1",tint60:"#fdf6f3"},yellow:{shade50:"#282400",shade40:"#4c4400",shade30:"#817400",shade20:"#c0ad00",shade10:"#e4cc00",primary:"#fde300",tint10:"#fde61e",tint20:"#fdea3d",tint30:"#feee66",tint40:"#fef7b2",tint50:"#fffad6",tint60:"#fffef5"},berry:{shade50:"#1f091d",shade40:"#3a1136",shade30:"#6d2064",shade20:"#932b88",shade10:"#af33a1",primary:"#c239b3",tint10:"#c94cbc",tint20:"#d161c4",tint30:"#da7ed0",tint40:"#edbbe7",tint50:"#f5daf2",tint60:"#fdf5fc"},lightGreen:{shade50:"#031a02",shade40:"#063004",shade30:"#0b5a08",shade20:"#0e7a0b",shade10:"#11910d",primary:"#13a10e",tint10:"#27ac22",tint20:"#3db838",tint30:"#5ec75a",tint40:"#a7e3a5",tint50:"#cef0cd",tint60:"#f2fbf2"},marigold:{shade50:"#251a00",shade40:"#463100",shade30:"#835b00",shade20:"#b27c00",shade10:"#d39300",primary:"#eaa300",tint10:"#edad1c",tint20:"#efb839",tint30:"#f2c661",tint40:"#f9e2ae",tint50:"#fcefd3",tint60:"#fefbf4"}},Dk={darkRed:{shade50:"#130204",shade40:"#230308",shade30:"#420610",shade20:"#590815",shade10:"#690a19",primary:"#750b1c",tint10:"#861b2c",tint20:"#962f3f",tint30:"#ac4f5e",tint40:"#d69ca5",tint50:"#e9c7cd",tint60:"#f9f0f2"},cranberry:Fk,pumpkin:{shade50:"#200d03",shade40:"#3d1805",shade30:"#712d09",shade20:"#9a3d0c",shade10:"#b6480e",primary:"#ca5010",tint10:"#d06228",tint20:"#d77440",tint30:"#df8e64",tint40:"#efc4ad",tint50:"#f7dfd2",tint60:"#fdf7f4"},peach:{shade50:"#291600",shade40:"#4d2a00",shade30:"#8f4e00",shade20:"#c26a00",shade10:"#e67e00",primary:"#ff8c00",tint10:"#ff9a1f",tint20:"#ffa83d",tint30:"#ffba66",tint40:"#ffddb3",tint50:"#ffedd6",tint60:"#fffaf5"},gold:{shade50:"#1f1900",shade40:"#3a2f00",shade30:"#6c5700",shade20:"#937700",shade10:"#ae8c00",primary:"#c19c00",tint10:"#c8a718",tint20:"#d0b232",tint30:"#dac157",tint40:"#ecdfa5",tint50:"#f5eece",tint60:"#fdfbf2"},brass:{shade50:"#181202",shade40:"#2e2103",shade30:"#553e06",shade20:"#745408",shade10:"#89640a",primary:"#986f0b",tint10:"#a47d1e",tint20:"#b18c34",tint30:"#c1a256",tint40:"#e0cea2",tint50:"#efe4cb",tint60:"#fbf8f2"},brown:{shade50:"#170e07",shade40:"#2b1a0e",shade30:"#50301a",shade20:"#6c4123",shade10:"#804d29",primary:"#8e562e",tint10:"#9c663f",tint20:"#a97652",tint30:"#bb8f6f",tint40:"#ddc3b0",tint50:"#edded3",tint60:"#faf7f4"},forest:{shade50:"#0c1501",shade40:"#162702",shade30:"#294903",shade20:"#376304",shade10:"#427505",primary:"#498205",tint10:"#599116",tint20:"#6ba02b",tint30:"#85b44c",tint40:"#bdd99b",tint50:"#dbebc7",tint60:"#f6faf0"},seafoam:{shade50:"#002111",shade40:"#003d20",shade30:"#00723b",shade20:"#009b51",shade10:"#00b85f",primary:"#00cc6a",tint10:"#19d279",tint20:"#34d889",tint30:"#5ae0a0",tint40:"#a8f0cd",tint50:"#cff7e4",tint60:"#f3fdf8"},darkGreen:{shade50:"#021102",shade40:"#032003",shade30:"#063b06",shade20:"#085108",shade10:"#0a5f0a",primary:"#0b6a0b",tint10:"#1a7c1a",tint20:"#2d8e2d",tint30:"#4da64d",tint40:"#9ad29a",tint50:"#c6e7c6",tint60:"#f0f9f0"},lightTeal:{shade50:"#001d1f",shade40:"#00373a",shade30:"#00666d",shade20:"#008b94",shade10:"#00a5af",primary:"#00b7c3",tint10:"#18bfca",tint20:"#32c8d1",tint30:"#58d3db",tint40:"#a6e9ed",tint50:"#cef3f5",tint60:"#f2fcfd"},teal:{shade50:"#001516",shade40:"#012728",shade30:"#02494c",shade20:"#026467",shade10:"#037679",primary:"#038387",tint10:"#159195",tint20:"#2aa0a4",tint30:"#4cb4b7",tint40:"#9bd9db",tint50:"#c7ebec",tint60:"#f0fafa"},steel:{shade50:"#000f12",shade40:"#001b22",shade30:"#00333f",shade20:"#004555",shade10:"#005265",primary:"#005b70",tint10:"#0f6c81",tint20:"#237d92",tint30:"#4496a9",tint40:"#94c8d4",tint50:"#c3e1e8",tint60:"#eff7f9"},blue:{shade50:"#001322",shade40:"#002440",shade30:"#004377",shade20:"#005ba1",shade10:"#006cbf",primary:"#0078d4",tint10:"#1a86d9",tint20:"#3595de",tint30:"#5caae5",tint40:"#a9d3f2",tint50:"#d0e7f8",tint60:"#f3f9fd"},royalBlue:{shade50:"#000c16",shade40:"#00172a",shade30:"#002c4e",shade20:"#003b6a",shade10:"#00467e",primary:"#004e8c",tint10:"#125e9a",tint20:"#286fa8",tint30:"#4a89ba",tint40:"#9abfdc",tint50:"#c7dced",tint60:"#f0f6fa"},cornflower:{shade50:"#0d1126",shade40:"#182047",shade30:"#2c3c85",shade20:"#3c51b4",shade10:"#4760d5",primary:"#4f6bed",tint10:"#637cef",tint20:"#778df1",tint30:"#93a4f4",tint40:"#c8d1fa",tint50:"#e1e6fc",tint60:"#f7f9fe"},navy:{shade50:"#00061d",shade40:"#000c36",shade30:"#001665",shade20:"#001e89",shade10:"#0023a2",primary:"#0027b4",tint10:"#173bbd",tint20:"#3050c6",tint30:"#546fd2",tint40:"#a3b2e8",tint50:"#ccd5f3",tint60:"#f2f4fc"},lavender:{shade50:"#120f25",shade40:"#221d46",shade30:"#3f3682",shade20:"#5649b0",shade10:"#6656d1",primary:"#7160e8",tint10:"#8172eb",tint20:"#9184ee",tint30:"#a79cf1",tint40:"#d2ccf8",tint50:"#e7e4fb",tint60:"#f9f8fe"},purple:{shade50:"#0f0717",shade40:"#1c0e2b",shade30:"#341a51",shade20:"#46236e",shade10:"#532982",primary:"#5c2e91",tint10:"#6b3f9e",tint20:"#7c52ab",tint30:"#9470bd",tint40:"#c6b1de",tint50:"#e0d3ed",tint60:"#f7f4fb"},grape:{shade50:"#160418",shade40:"#29072e",shade30:"#4c0d55",shade20:"#671174",shade10:"#7a1589",primary:"#881798",tint10:"#952aa4",tint20:"#a33fb1",tint30:"#b55fc1",tint40:"#d9a7e0",tint50:"#eaceef",tint60:"#faf2fb"},lilac:{shade50:"#1c0b1f",shade40:"#35153a",shade30:"#63276d",shade20:"#863593",shade10:"#9f3faf",primary:"#b146c2",tint10:"#ba58c9",tint20:"#c36bd1",tint30:"#cf87da",tint40:"#e6bfed",tint50:"#f2dcf5",tint60:"#fcf6fd"},pink:{shade50:"#24091b",shade40:"#441232",shade30:"#80215d",shade20:"#ad2d7e",shade10:"#cd3595",primary:"#e43ba6",tint10:"#e750b0",tint20:"#ea66ba",tint30:"#ef85c8",tint40:"#f7c0e3",tint50:"#fbddf0",tint60:"#fef6fb"},magenta:{shade50:"#1f0013",shade40:"#390024",shade30:"#6b0043",shade20:"#91005a",shade10:"#ac006b",primary:"#bf0077",tint10:"#c71885",tint20:"#ce3293",tint30:"#d957a8",tint40:"#eca5d1",tint50:"#f5cee6",tint60:"#fcf2f9"},plum:{shade50:"#13000c",shade40:"#240017",shade30:"#43002b",shade20:"#5a003b",shade10:"#6b0045",primary:"#77004d",tint10:"#87105d",tint20:"#98246f",tint30:"#ad4589",tint40:"#d696c0",tint50:"#e9c4dc",tint60:"#faf0f6"},beige:{shade50:"#141313",shade40:"#252323",shade30:"#444241",shade20:"#5d5958",shade10:"#6e6968",primary:"#7a7574",tint10:"#8a8584",tint20:"#9a9594",tint30:"#afabaa",tint40:"#d7d4d4",tint50:"#eae8e8",tint60:"#faf9f9"},mink:{shade50:"#0f0e0e",shade40:"#1c1b1a",shade30:"#343231",shade20:"#474443",shade10:"#54514f",primary:"#5d5a58",tint10:"#706d6b",tint20:"#84817e",tint30:"#9e9b99",tint40:"#cecccb",tint50:"#e5e4e3",tint60:"#f8f8f8"},platinum:{shade50:"#111314",shade40:"#1f2426",shade30:"#3b4447",shade20:"#505c60",shade10:"#5f6d71",primary:"#69797e",tint10:"#79898d",tint20:"#89989d",tint30:"#a0adb2",tint40:"#cdd6d8",tint50:"#e4e9ea",tint60:"#f8f9fa"},anchor:{shade50:"#090a0b",shade40:"#111315",shade30:"#202427",shade20:"#2b3135",shade10:"#333a3f",primary:"#394146",tint10:"#4d565c",tint20:"#626c72",tint30:"#808a90",tint40:"#bcc3c7",tint50:"#dbdfe1",tint60:"#f6f7f8"}},Hk={cranberry:Fk,green:Bk,orange:{shade50:"#271002",shade40:"#4a1e04",shade30:"#8a3707",shade20:"#bc4b09",shade10:"#de590b",primary:"#f7630c",tint10:"#f87528",tint20:"#f98845",tint30:"#faa06b",tint40:"#fdcfb4",tint50:"#fee5d7",tint60:"#fff9f5"}},_k=["red","green","darkOrange","yellow","berry","lightGreen","marigold"],Mk=["darkRed","cranberry","pumpkin","peach","gold","brass","brown","forest","seafoam","darkGreen","lightTeal","teal","steel","blue","royalBlue","cornflower","navy","lavender","purple","grape","lilac","pink","magenta","plum","beige","mink","platinum","anchor"],Uk={success:"green",warning:"orange",danger:"cranberry"},zk=_k.reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background1`]:Lk[t].shade40,[`colorPalette${n}Background2`]:Lk[t].shade30,[`colorPalette${n}Background3`]:Lk[t].primary,[`colorPalette${n}Foreground1`]:Lk[t].tint30,[`colorPalette${n}Foreground2`]:Lk[t].tint40,[`colorPalette${n}Foreground3`]:Lk[t].tint20,[`colorPalette${n}BorderActive`]:Lk[t].tint30,[`colorPalette${n}Border1`]:Lk[t].primary,[`colorPalette${n}Border2`]:Lk[t].tint20};return Object.assign(e,r)},{});zk.colorPaletteRedForeground3=Lk.red.tint30,zk.colorPaletteRedBorder2=Lk.red.tint30,zk.colorPaletteGreenForeground3=Lk.green.tint40,zk.colorPaletteGreenBorder2=Lk.green.tint40,zk.colorPaletteDarkOrangeForeground3=Lk.darkOrange.tint30,zk.colorPaletteDarkOrangeBorder2=Lk.darkOrange.tint30,zk.colorPaletteRedForegroundInverted=Lk.red.primary,zk.colorPaletteGreenForegroundInverted=Lk.green.primary,zk.colorPaletteYellowForegroundInverted=Lk.yellow.shade30;const jk=Mk.reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background2`]:Dk[t].shade30,[`colorPalette${n}Foreground2`]:Dk[t].tint40,[`colorPalette${n}BorderActive`]:Dk[t].tint30};return Object.assign(e,r)},{});jk.colorPaletteDarkRedBackground2=Dk.darkRed.shade20,jk.colorPalettePlumBackground2=Dk.plum.shade20;const $k={...zk,...jk},Wk=Object.entries(Uk).reduce((e,[t,n])=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),i={[`colorStatus${r}Background1`]:Hk[n].shade40,[`colorStatus${r}Background2`]:Hk[n].shade30,[`colorStatus${r}Background3`]:Hk[n].primary,[`colorStatus${r}Foreground1`]:Hk[n].tint30,[`colorStatus${r}Foreground2`]:Hk[n].tint40,[`colorStatus${r}Foreground3`]:Hk[n].tint20,[`colorStatus${r}BorderActive`]:Hk[n].tint30,[`colorStatus${r}ForegroundInverted`]:Hk[n].shade10,[`colorStatus${r}Border1`]:Hk[n].primary,[`colorStatus${r}Border2`]:Hk[n].tint20};return Object.assign(e,i)},{});Wk.colorStatusDangerBackground3Hover=Hk[Uk.danger].shade10,Wk.colorStatusDangerBackground3Pressed=Hk[Uk.danger].shade20,Wk.colorStatusDangerForeground3=Hk[Uk.danger].tint40,Wk.colorStatusDangerBorder2=Hk[Uk.danger].tint30,Wk.colorStatusSuccessForeground3=Hk[Uk.success].tint40,Wk.colorStatusSuccessBorder2=Hk[Uk.success].tint40,Wk.colorStatusWarningForegroundInverted=Hk[Uk.warning].shade20;const qk={borderRadiusNone:"0",borderRadiusSmall:"2px",borderRadiusMedium:"4px",borderRadiusLarge:"6px",borderRadiusXLarge:"8px",borderRadiusCircular:"10000px"},Vk={fontSizeBase100:"10px",fontSizeBase200:"12px",fontSizeBase300:"14px",fontSizeBase400:"16px",fontSizeBase500:"20px",fontSizeBase600:"24px",fontSizeHero700:"28px",fontSizeHero800:"32px",fontSizeHero900:"40px",fontSizeHero1000:"68px"},Gk={lineHeightBase100:"14px",lineHeightBase200:"16px",lineHeightBase300:"20px",lineHeightBase400:"22px",lineHeightBase500:"28px",lineHeightBase600:"32px",lineHeightHero700:"36px",lineHeightHero800:"40px",lineHeightHero900:"52px",lineHeightHero1000:"92px"},Kk={fontWeightRegular:400,fontWeightMedium:500,fontWeightSemibold:600,fontWeightBold:700},Xk={fontFamilyBase:"'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif",fontFamilyMonospace:"Consolas, 'Courier New', Courier, monospace",fontFamilyNumeric:"Bahnschrift, 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif"},Qk={strokeWidthThin:"1px",strokeWidthThick:"2px",strokeWidthThicker:"3px",strokeWidthThickest:"4px"};function Jk(e,t,n=""){return{[`shadow2${n}`]:`0 0 2px ${e}, 0 1px 2px ${t}`,[`shadow4${n}`]:`0 0 2px ${e}, 0 2px 4px ${t}`,[`shadow8${n}`]:`0 0 2px ${e}, 0 4px 8px ${t}`,[`shadow16${n}`]:`0 0 2px ${e}, 0 8px 16px ${t}`,[`shadow28${n}`]:`0 0 8px ${e}, 0 14px 28px ${t}`,[`shadow64${n}`]:`0 0 8px ${e}, 0 32px 64px ${t}`}}const Yk={durationUltraFast:"50ms",durationFaster:"100ms",durationFast:"150ms",durationNormal:"200ms",durationGentle:"250ms",durationSlow:"300ms",durationSlower:"400ms",durationUltraSlow:"500ms"},Zk={curveAccelerateMax:"cubic-bezier(0.9,0.1,1,0.2)",curveAccelerateMid:"cubic-bezier(1,0,1,1)",curveAccelerateMin:"cubic-bezier(0.8,0,0.78,1)",curveDecelerateMax:"cubic-bezier(0.1,0.9,0.2,1)",curveDecelerateMid:"cubic-bezier(0,0,0,1)",curveDecelerateMin:"cubic-bezier(0.33,0,0.1,1)",curveEasyEaseMax:"cubic-bezier(0.8,0,0.2,1)",curveEasyEase:"cubic-bezier(0.33,0,0.67,1)",curveLinear:"cubic-bezier(0,0,1,1)"},eE="10px",tE="12px",nE="16px",rE="20px",iE="24px",oE="32px",aE={spacingHorizontalNone:"0",spacingHorizontalXXS:"2px",spacingHorizontalXS:"4px",spacingHorizontalSNudge:"6px",spacingHorizontalS:"8px",spacingHorizontalMNudge:eE,spacingHorizontalM:tE,spacingHorizontalL:nE,spacingHorizontalXL:rE,spacingHorizontalXXL:iE,spacingHorizontalXXXL:oE},sE={spacingVerticalNone:"0",spacingVerticalXXS:"2px",spacingVerticalXS:"4px",spacingVerticalSNudge:"6px",spacingVerticalS:"8px",spacingVerticalMNudge:eE,spacingVerticalM:tE,spacingVerticalL:nE,spacingVerticalXL:rE,spacingVerticalXXL:iE,spacingVerticalXXXL:oE},lE={10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"},cE=(e=>{const t=(e=>({colorNeutralForeground1:Pk,colorNeutralForeground1Hover:Pk,colorNeutralForeground1Pressed:Pk,colorNeutralForeground1Selected:Pk,colorNeutralForeground2:vk,colorNeutralForeground2Hover:Pk,colorNeutralForeground2Pressed:Pk,colorNeutralForeground2Selected:Pk,colorNeutralForeground2BrandHover:e[100],colorNeutralForeground2BrandPressed:e[90],colorNeutralForeground2BrandSelected:e[100],colorNeutralForeground3:fk,colorNeutralForeground3Hover:vk,colorNeutralForeground3Pressed:vk,colorNeutralForeground3Selected:vk,colorNeutralForeground3BrandHover:e[100],colorNeutralForeground3BrandPressed:e[90],colorNeutralForeground3BrandSelected:e[100],colorNeutralForeground4:"#999999",colorNeutralForegroundDisabled:"#5c5c5c",colorNeutralForegroundInvertedDisabled:Ak,colorBrandForegroundLink:e[100],colorBrandForegroundLinkHover:e[110],colorBrandForegroundLinkPressed:e[90],colorBrandForegroundLinkSelected:e[100],colorNeutralForeground2Link:vk,colorNeutralForeground2LinkHover:Pk,colorNeutralForeground2LinkPressed:Pk,colorNeutralForeground2LinkSelected:Pk,colorCompoundBrandForeground1:e[100],colorCompoundBrandForeground1Hover:e[110],colorCompoundBrandForeground1Pressed:e[90],colorBrandForeground1:e[100],colorBrandForeground2:e[110],colorBrandForeground2Hover:e[130],colorBrandForeground2Pressed:e[160],colorNeutralForeground1Static:nk,colorNeutralForegroundStaticInverted:Pk,colorNeutralForegroundInverted:nk,colorNeutralForegroundInvertedHover:nk,colorNeutralForegroundInvertedPressed:nk,colorNeutralForegroundInvertedSelected:nk,colorNeutralForegroundInverted2:nk,colorNeutralForegroundOnBrand:Pk,colorNeutralForegroundInvertedLink:Pk,colorNeutralForegroundInvertedLinkHover:Pk,colorNeutralForegroundInvertedLinkPressed:Pk,colorNeutralForegroundInvertedLinkSelected:Pk,colorBrandForegroundInverted:e[80],colorBrandForegroundInvertedHover:e[70],colorBrandForegroundInvertedPressed:e[60],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:rk,colorNeutralBackground1Hover:sk,colorNeutralBackground1Pressed:tk,colorNeutralBackground1Selected:ak,colorNeutralBackground2:tk,colorNeutralBackground2Hover:ok,colorNeutralBackground2Pressed:ek,colorNeutralBackground2Selected:ik,colorNeutralBackground3:ek,colorNeutralBackground3Hover:rk,colorNeutralBackground3Pressed:Zw,colorNeutralBackground3Selected:nk,colorNeutralBackground4:Zw,colorNeutralBackground4Hover:tk,colorNeutralBackground4Pressed:Nk,colorNeutralBackground4Selected:"#1a1a1a",colorNeutralBackground5:Nk,colorNeutralBackground5Hover:ek,colorNeutralBackground5Pressed:"#050505",colorNeutralBackground5Selected:"#0f0f0f",colorNeutralBackground6:ok,colorNeutralBackgroundInverted:Pk,colorNeutralBackgroundStatic:sk,colorNeutralBackgroundAlpha:"rgba(26, 26, 26, 0.5)",colorNeutralBackgroundAlpha2:"rgba(31, 31, 31, 0.7)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:ak,colorSubtleBackgroundPressed:ik,colorSubtleBackgroundSelected:ok,colorSubtleBackgroundLightAlphaHover:"rgba(36, 36, 36, 0.8)",colorSubtleBackgroundLightAlphaPressed:"rgba(36, 36, 36, 0.5)",colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:Tk,colorSubtleBackgroundInvertedPressed:Rk,colorSubtleBackgroundInvertedSelected:xk,colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:ek,colorNeutralBackgroundInvertedDisabled:kk,colorNeutralStencil1:ck,colorNeutralStencil2:ok,colorNeutralStencil1Alpha:kk,colorNeutralStencil2Alpha:"rgba(255, 255, 255, 0.05)",colorBackgroundOverlay:Ok,colorScrollbarOverlay:"rgba(255, 255, 255, 0.6)",colorBrandBackground:e[70],colorBrandBackgroundHover:e[80],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[100],colorCompoundBrandBackgroundHover:e[110],colorCompoundBrandBackgroundPressed:e[90],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[20],colorBrandBackground2Hover:e[40],colorBrandBackground2Pressed:e[10],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:Pk,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:ok,colorNeutralCardBackgroundHover:sk,colorNeutralCardBackgroundPressed:ik,colorNeutralCardBackgroundSelected:ak,colorNeutralCardBackgroundDisabled:ek,colorNeutralStrokeAccessible:fk,colorNeutralStrokeAccessibleHover:hk,colorNeutralStrokeAccessiblePressed:pk,colorNeutralStrokeAccessibleSelected:e[100],colorNeutralStroke1:"#666666",colorNeutralStroke1Hover:"#757575",colorNeutralStroke1Pressed:"#6b6b6b",colorNeutralStroke1Selected:dk,colorNeutralStroke2:"#525252",colorNeutralStroke3:sk,colorNeutralStrokeSubtle:Zw,colorNeutralStrokeOnBrand:rk,colorNeutralStrokeOnBrand2:Pk,colorNeutralStrokeOnBrand2Hover:Pk,colorNeutralStrokeOnBrand2Pressed:Pk,colorNeutralStrokeOnBrand2Selected:Pk,colorBrandStroke1:e[100],colorBrandStroke2:e[50],colorBrandStroke2Hover:e[50],colorBrandStroke2Pressed:e[30],colorBrandStroke2Contrast:e[50],colorCompoundBrandStroke:e[100],colorCompoundBrandStrokeHover:e[110],colorCompoundBrandStrokePressed:e[90],colorNeutralStrokeDisabled:lk,colorNeutralStrokeInvertedDisabled:Ak,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:kk,colorNeutralStrokeAlpha2:Ek,colorStrokeFocus1:Nk,colorStrokeFocus2:Pk,colorNeutralShadowAmbient:"rgba(0,0,0,0.24)",colorNeutralShadowKey:"rgba(0,0,0,0.28)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.12)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.40)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.48)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...qk,...Vk,...Gk,...Xk,...Kk,...Qk,...aE,...sE,...Yk,...Zk,...t,...$k,...Wk,...Jk(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...Jk(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})(lE),uE=_k.reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background1`]:Lk[t].tint60,[`colorPalette${n}Background2`]:Lk[t].tint40,[`colorPalette${n}Background3`]:Lk[t].primary,[`colorPalette${n}Foreground1`]:Lk[t].shade10,[`colorPalette${n}Foreground2`]:Lk[t].shade30,[`colorPalette${n}Foreground3`]:Lk[t].primary,[`colorPalette${n}BorderActive`]:Lk[t].primary,[`colorPalette${n}Border1`]:Lk[t].tint40,[`colorPalette${n}Border2`]:Lk[t].primary};return Object.assign(e,r)},{});uE.colorPaletteYellowForeground1=Lk.yellow.shade30,uE.colorPaletteRedForegroundInverted=Lk.red.tint20,uE.colorPaletteGreenForegroundInverted=Lk.green.tint20,uE.colorPaletteYellowForegroundInverted=Lk.yellow.tint40;const dE=Mk.reduce((e,t)=>{const n=t.slice(0,1).toUpperCase()+t.slice(1),r={[`colorPalette${n}Background2`]:Dk[t].tint40,[`colorPalette${n}Foreground2`]:Dk[t].shade30,[`colorPalette${n}BorderActive`]:Dk[t].primary};return Object.assign(e,r)},{}),fE={...uE,...dE},pE=Object.entries(Uk).reduce((e,[t,n])=>{const r=t.slice(0,1).toUpperCase()+t.slice(1),i={[`colorStatus${r}Background1`]:Hk[n].tint60,[`colorStatus${r}Background2`]:Hk[n].tint40,[`colorStatus${r}Background3`]:Hk[n].primary,[`colorStatus${r}Foreground1`]:Hk[n].shade10,[`colorStatus${r}Foreground2`]:Hk[n].shade30,[`colorStatus${r}Foreground3`]:Hk[n].primary,[`colorStatus${r}ForegroundInverted`]:Hk[n].tint30,[`colorStatus${r}BorderActive`]:Hk[n].primary,[`colorStatus${r}Border1`]:Hk[n].tint40,[`colorStatus${r}Border2`]:Hk[n].primary};return Object.assign(e,i)},{});pE.colorStatusDangerBackground3Hover=Hk[Uk.danger].shade10,pE.colorStatusDangerBackground3Pressed=Hk[Uk.danger].shade20,pE.colorStatusWarningForeground1=Hk[Uk.warning].shade20,pE.colorStatusWarningForeground3=Hk[Uk.warning].shade20,pE.colorStatusWarningBorder2=Hk[Uk.warning].shade20;const hE=(e=>{const t=(e=>({colorNeutralForeground1:nk,colorNeutralForeground1Hover:nk,colorNeutralForeground1Pressed:nk,colorNeutralForeground1Selected:nk,colorNeutralForeground2:lk,colorNeutralForeground2Hover:nk,colorNeutralForeground2Pressed:nk,colorNeutralForeground2Selected:nk,colorNeutralForeground2BrandHover:e[80],colorNeutralForeground2BrandPressed:e[70],colorNeutralForeground2BrandSelected:e[80],colorNeutralForeground3:uk,colorNeutralForeground3Hover:lk,colorNeutralForeground3Pressed:lk,colorNeutralForeground3Selected:lk,colorNeutralForeground3BrandHover:e[80],colorNeutralForeground3BrandPressed:e[70],colorNeutralForeground3BrandSelected:e[80],colorNeutralForeground4:dk,colorNeutralForegroundDisabled:hk,colorNeutralForegroundInvertedDisabled:Ak,colorBrandForegroundLink:e[70],colorBrandForegroundLinkHover:e[60],colorBrandForegroundLinkPressed:e[40],colorBrandForegroundLinkSelected:e[70],colorNeutralForeground2Link:lk,colorNeutralForeground2LinkHover:nk,colorNeutralForeground2LinkPressed:nk,colorNeutralForeground2LinkSelected:nk,colorCompoundBrandForeground1:e[80],colorCompoundBrandForeground1Hover:e[70],colorCompoundBrandForeground1Pressed:e[60],colorBrandForeground1:e[80],colorBrandForeground2:e[70],colorBrandForeground2Hover:e[60],colorBrandForeground2Pressed:e[30],colorNeutralForeground1Static:nk,colorNeutralForegroundStaticInverted:Pk,colorNeutralForegroundInverted:Pk,colorNeutralForegroundInvertedHover:Pk,colorNeutralForegroundInvertedPressed:Pk,colorNeutralForegroundInvertedSelected:Pk,colorNeutralForegroundInverted2:Pk,colorNeutralForegroundOnBrand:Pk,colorNeutralForegroundInvertedLink:Pk,colorNeutralForegroundInvertedLinkHover:Pk,colorNeutralForegroundInvertedLinkPressed:Pk,colorNeutralForegroundInvertedLinkSelected:Pk,colorBrandForegroundInverted:e[100],colorBrandForegroundInvertedHover:e[110],colorBrandForegroundInvertedPressed:e[100],colorBrandForegroundOnLight:e[80],colorBrandForegroundOnLightHover:e[70],colorBrandForegroundOnLightPressed:e[50],colorBrandForegroundOnLightSelected:e[60],colorNeutralBackground1:Pk,colorNeutralBackground1Hover:bk,colorNeutralBackground1Pressed:gk,colorNeutralBackground1Selected:yk,colorNeutralBackground2:wk,colorNeutralBackground2Hover:Sk,colorNeutralBackground2Pressed:"#dbdbdb",colorNeutralBackground2Selected:mk,colorNeutralBackground3:bk,colorNeutralBackground3Hover:yk,colorNeutralBackground3Pressed:vk,colorNeutralBackground3Selected:gk,colorNeutralBackground4:Sk,colorNeutralBackground4Hover:wk,colorNeutralBackground4Pressed:bk,colorNeutralBackground4Selected:Pk,colorNeutralBackground5:yk,colorNeutralBackground5Hover:bk,colorNeutralBackground5Pressed:Sk,colorNeutralBackground5Selected:wk,colorNeutralBackground6:mk,colorNeutralBackgroundInverted:rk,colorNeutralBackgroundStatic:ok,colorNeutralBackgroundAlpha:Ck,colorNeutralBackgroundAlpha2:"rgba(255, 255, 255, 0.8)",colorSubtleBackground:"transparent",colorSubtleBackgroundHover:bk,colorSubtleBackgroundPressed:gk,colorSubtleBackgroundSelected:yk,colorSubtleBackgroundLightAlphaHover:"rgba(255, 255, 255, 0.7)",colorSubtleBackgroundLightAlphaPressed:Ck,colorSubtleBackgroundLightAlphaSelected:"transparent",colorSubtleBackgroundInverted:"transparent",colorSubtleBackgroundInvertedHover:Tk,colorSubtleBackgroundInvertedPressed:Rk,colorSubtleBackgroundInvertedSelected:xk,colorTransparentBackground:"transparent",colorTransparentBackgroundHover:"transparent",colorTransparentBackgroundPressed:"transparent",colorTransparentBackgroundSelected:"transparent",colorNeutralBackgroundDisabled:Sk,colorNeutralBackgroundInvertedDisabled:kk,colorNeutralStencil1:mk,colorNeutralStencil2:wk,colorNeutralStencil1Alpha:Tk,colorNeutralStencil2Alpha:Ik,colorBackgroundOverlay:"rgba(0, 0, 0, 0.4)",colorScrollbarOverlay:Ok,colorBrandBackground:e[80],colorBrandBackgroundHover:e[70],colorBrandBackgroundPressed:e[40],colorBrandBackgroundSelected:e[60],colorCompoundBrandBackground:e[80],colorCompoundBrandBackgroundHover:e[70],colorCompoundBrandBackgroundPressed:e[60],colorBrandBackgroundStatic:e[80],colorBrandBackground2:e[160],colorBrandBackground2Hover:e[150],colorBrandBackground2Pressed:e[130],colorBrandBackground3Static:e[60],colorBrandBackground4Static:e[40],colorBrandBackgroundInverted:Pk,colorBrandBackgroundInvertedHover:e[160],colorBrandBackgroundInvertedPressed:e[140],colorBrandBackgroundInvertedSelected:e[150],colorNeutralCardBackground:wk,colorNeutralCardBackgroundHover:Pk,colorNeutralCardBackgroundPressed:bk,colorNeutralCardBackgroundSelected:yk,colorNeutralCardBackgroundDisabled:Sk,colorNeutralStrokeAccessible:uk,colorNeutralStrokeAccessibleHover:ck,colorNeutralStrokeAccessiblePressed:"#4d4d4d",colorNeutralStrokeAccessibleSelected:e[80],colorNeutralStroke1:"#d1d1d1",colorNeutralStroke1Hover:"#c7c7c7",colorNeutralStroke1Pressed:pk,colorNeutralStroke1Selected:hk,colorNeutralStroke2:gk,colorNeutralStroke3:Sk,colorNeutralStrokeSubtle:gk,colorNeutralStrokeOnBrand:Pk,colorNeutralStrokeOnBrand2:Pk,colorNeutralStrokeOnBrand2Hover:Pk,colorNeutralStrokeOnBrand2Pressed:Pk,colorNeutralStrokeOnBrand2Selected:Pk,colorBrandStroke1:e[80],colorBrandStroke2:e[140],colorBrandStroke2Hover:e[120],colorBrandStroke2Pressed:e[80],colorBrandStroke2Contrast:e[140],colorCompoundBrandStroke:e[80],colorCompoundBrandStrokeHover:e[70],colorCompoundBrandStrokePressed:e[60],colorNeutralStrokeDisabled:gk,colorNeutralStrokeInvertedDisabled:Ak,colorTransparentStroke:"transparent",colorTransparentStrokeInteractive:"transparent",colorTransparentStrokeDisabled:"transparent",colorNeutralStrokeAlpha:Ik,colorNeutralStrokeAlpha2:Ek,colorStrokeFocus1:Pk,colorStrokeFocus2:Nk,colorNeutralShadowAmbient:"rgba(0,0,0,0.12)",colorNeutralShadowKey:"rgba(0,0,0,0.14)",colorNeutralShadowAmbientLighter:"rgba(0,0,0,0.06)",colorNeutralShadowKeyLighter:"rgba(0,0,0,0.07)",colorNeutralShadowAmbientDarker:"rgba(0,0,0,0.20)",colorNeutralShadowKeyDarker:"rgba(0,0,0,0.24)",colorBrandShadowAmbient:"rgba(0,0,0,0.30)",colorBrandShadowKey:"rgba(0,0,0,0.25)"}))(e);return{...qk,...Vk,...Gk,...Xk,...Kk,...Qk,...aE,...sE,...Yk,...Zk,...t,...fE,...pE,...Jk(t.colorNeutralShadowAmbient,t.colorNeutralShadowKey),...Jk(t.colorBrandShadowAmbient,t.colorBrandShadowKey,"Brand")}})(lE),vE=e=>-1,gE=e=>{};const mE=eS({root:{Bahqtrf:"fk6fouc",sj55zd:"f19n0e5"},disabled:{sj55zd:"f1s2aq7o",Bbusuzp:"f1dcs8yz"},required:{sj55zd:"f1whyuy6",uwmqm3:["fruq291","f7x41pl"]},small:{Be2twd7:"fy9rknc",Bg96gwp:"fwrc4pm"},medium:{Be2twd7:"fkhj508",Bg96gwp:"f1i3iumi"},large:{Be2twd7:"fod5ikn",Bg96gwp:"faaz57k",Bhrd7zp:"fl43uef"},semibold:{Bhrd7zp:"fl43uef"}},{d:[".fk6fouc{font-family:var(--fontFamilyBase);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",".f1whyuy6{color:var(--colorPaletteRedForeground3);}",".fruq291{padding-left:var(--spacingHorizontalXS);}",".f7x41pl{padding-right:var(--spacingHorizontalXS);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".fkhj508{font-size:var(--fontSizeBase300);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".faaz57k{line-height:var(--lineHeightBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}"],m:[["@media (forced-colors: active){.f1dcs8yz{color:GrayText;}}",{m:"(forced-colors: active)"}]]}),yE=V.forwardRef((e,t)=>{const n=((e,t)=>{const{disabled:n=!1,required:r=!1,weight:i="regular",size:o="medium"}=e;return{disabled:n,required:py(!0===r?"*":r||void 0,{defaultProps:{"aria-hidden":"true"},elementType:"span"}),weight:i,size:o,components:{root:"label",required:"span"},root:fy(Ry("label",{ref:t,...e}),{elementType:"label"})}})(e,t);return(e=>{const t=mE();e.root.className=$y("fui-Label",t.root,e.disabled&&t.disabled,t[e.size],"semibold"===e.weight&&t.semibold,e.root.className),e.required&&(e.required.className=$y("fui-Label__required",t.required,e.disabled&&t.disabled,e.required.className))})(n),Pm("useLabelStyles_unstable")(n),(e=>gm(e.root,{children:[e.root.children,e.required&&vm(e.required,{})]}))(n)});yE.displayName="Label";const SE=V.createContext(void 0),bE={},wE=(SE.Provider,(e,t)=>{const{size:n}=null!==(r=V.useContext(SE))&&void 0!==r?r:bE;var r;const{appearance:i="primary",labelPosition:o="after",size:a=(null!=n?n:"medium"),delay:s=0}=e,l=Ly("spinner"),{role:c="progressbar",...u}=e,d=fy(Ry("div",{ref:t,role:c,...u},["size"]),{elementType:"div"}),[f,p]=V.useState(!1),[h,v]=function(){const{targetDocument:e}=Am(),t=null==e?void 0:e.defaultView;return function(e,t){const n=V.useRef(void 0),r=V.useCallback((r,i)=>(void 0!==n.current&&t(n.current),n.current=e(r,i),n.current),[t,e]),i=V.useCallback(()=>{void 0!==n.current&&(t(n.current),n.current=void 0)},[t]);return V.useEffect(()=>i,[i]),[r,i]}(t?t.setTimeout:vE,t?t.clearTimeout:gE)}();V.useEffect(()=>{if(!(s<=0))return h(()=>{p(!0)},s),()=>{v()}},[h,v,s]);const g=py(e.label,{defaultProps:{id:l},renderByDefault:!1,elementType:yE}),m=py(e.spinner,{renderByDefault:!0,elementType:"span"});return g&&d&&!d["aria-labelledby"]&&(d["aria-labelledby"]=g.id),{appearance:i,delay:s,labelPosition:o,size:a,shouldRenderSpinner:!s||f,components:{root:"div",spinner:"span",spinnerTail:"span",label:yE},root:d,spinner:m,spinnerTail:fy(e.spinnerTail,{elementType:"span"}),label:g}}),kE=fS("r82apo5",null,[".r82apo5{display:flex;align-items:center;justify-content:center;line-height:0;gap:8px;overflow:hidden;}"]),EE=eS({vertical:{Beiy3e4:"f1vx9l62"}},{d:[".f1vx9l62{flex-direction:column;}"]}),AE=fS("rvgcg50","r15nd2jo",{r:[".rvgcg50{position:relative;flex-shrink:0;-webkit-mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);background-color:var(--colorBrandStroke2Contrast);color:var(--colorBrandStroke1);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:linear;animation-name:rb7n1on;}","@keyframes rb7n1on{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}",".r15nd2jo{position:relative;flex-shrink:0;-webkit-mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);mask-image:radial-gradient(closest-side, transparent calc(100% - var(--fui-Spinner--strokeWidth) - 1px), white calc(100% - var(--fui-Spinner--strokeWidth)) calc(100% - 1px), transparent 100%);background-color:var(--colorBrandStroke2Contrast);color:var(--colorBrandStroke1);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:linear;animation-name:r1gx3jof;}","@keyframes r1gx3jof{0%{transform:rotate(0deg);}100%{transform:rotate(-360deg);}}"],s:["@media screen and (forced-colors: active){.rvgcg50{background-color:HighlightText;color:Highlight;forced-color-adjust:none;}}","@media screen and (prefers-reduced-motion: reduce){.rvgcg50{animation-duration:1.8s;}}","@media screen and (forced-colors: active){.r15nd2jo{background-color:HighlightText;color:Highlight;forced-color-adjust:none;}}","@media screen and (prefers-reduced-motion: reduce){.r15nd2jo{animation-duration:1.8s;}}"]}),CE=fS("rxov3xa","r1o544mv",{r:[".rxov3xa{position:absolute;display:block;width:100%;height:100%;-webkit-mask-image:conic-gradient(transparent 105deg, white 105deg);mask-image:conic-gradient(transparent 105deg, white 105deg);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:var(--curveEasyEase);animation-name:r15mim6k;}",'.rxov3xa::before,.rxov3xa::after{content:"";position:absolute;display:block;width:100%;height:100%;animation:inherit;background-image:conic-gradient(currentcolor 135deg, transparent 135deg);}',"@keyframes r15mim6k{0%{transform:rotate(-135deg);}50%{transform:rotate(0deg);}100%{transform:rotate(225deg);}}",".rxov3xa::before{animation-name:r18vhmn8;}","@keyframes r18vhmn8{0%{transform:rotate(0deg);}50%{transform:rotate(105deg);}100%{transform:rotate(0deg);}}",".rxov3xa::after{animation-name:rkgrvoi;}","@keyframes rkgrvoi{0%{transform:rotate(0deg);}50%{transform:rotate(225deg);}100%{transform:rotate(0deg);}}",".r1o544mv{position:absolute;display:block;width:100%;height:100%;-webkit-mask-image:conic-gradient(transparent 105deg, white 105deg);mask-image:conic-gradient(transparent 105deg, white 105deg);animation-duration:1.5s;animation-iteration-count:infinite;animation-timing-function:var(--curveEasyEase);animation-name:r109gmi5;}",'.r1o544mv::before,.r1o544mv::after{content:"";position:absolute;display:block;width:100%;height:100%;animation:inherit;background-image:conic-gradient(currentcolor 135deg, transparent 135deg);}',"@keyframes r109gmi5{0%{transform:rotate(135deg);}50%{transform:rotate(0deg);}100%{transform:rotate(-225deg);}}",".r1o544mv::before{animation-name:r17whflh;}","@keyframes r17whflh{0%{transform:rotate(0deg);}50%{transform:rotate(-105deg);}100%{transform:rotate(0deg);}}",".r1o544mv::after{animation-name:re4odhl;}","@keyframes re4odhl{0%{transform:rotate(0deg);}50%{transform:rotate(-225deg);}100%{transform:rotate(0deg);}}"],s:["@media screen and (prefers-reduced-motion: reduce){.rxov3xa{animation-iteration-count:0;background-image:conic-gradient(transparent 120deg, currentcolor 360deg);}.rxov3xa::before,.rxov3xa::after{content:none;}}","@media screen and (prefers-reduced-motion: reduce){.r1o544mv{animation-iteration-count:0;background-image:conic-gradient(transparent 120deg, currentcolor 360deg);}.r1o544mv::before,.r1o544mv::after{content:none;}}"]}),IE=eS({inverted:{De3pzq:"fr407j0",sj55zd:"f1f7voed"},rtlTail:{btxmck:"f179dep3",gb5jj2:"fbz9ihp",Br2kee7:"f1wkkxo7"},"extra-tiny":{Bqenvij:"fd461yt",a9b677:"fjw5fx7",qmp6fs:"f1v3ph3m"},tiny:{Bqenvij:"fjamq6b",a9b677:"f64fuq3",qmp6fs:"f1v3ph3m"},"extra-small":{Bqenvij:"frvgh55",a9b677:"fq4mcun",qmp6fs:"f1v3ph3m"},small:{Bqenvij:"fxldao9",a9b677:"f1w9dchk",qmp6fs:"f1v3ph3m"},medium:{Bqenvij:"f1d2rq10",a9b677:"f1szoe96",qmp6fs:"fb52u90"},large:{Bqenvij:"f8ljn23",a9b677:"fpdz1er",qmp6fs:"fb52u90"},"extra-large":{Bqenvij:"fbhnoac",a9b677:"feqmc2u",qmp6fs:"fb52u90"},huge:{Bqenvij:"f1ft4266",a9b677:"fksc0bp",qmp6fs:"fa3u9ii"}},{d:[".fr407j0{background-color:var(--colorNeutralStrokeAlpha2);}",".f1f7voed{color:var(--colorNeutralStrokeOnBrand2);}",".f179dep3{-webkit-mask-image:conic-gradient(white 255deg, transparent 255deg);mask-image:conic-gradient(white 255deg, transparent 255deg);}",".fbz9ihp::before,.fbz9ihp::after{background-image:conic-gradient(transparent 225deg, currentcolor 225deg);}",".fd461yt{height:16px;}",".fjw5fx7{width:16px;}",".f1v3ph3m{--fui-Spinner--strokeWidth:var(--strokeWidthThick);}",".fjamq6b{height:20px;}",".f64fuq3{width:20px;}",".frvgh55{height:24px;}",".fq4mcun{width:24px;}",".fxldao9{height:28px;}",".f1w9dchk{width:28px;}",".f1d2rq10{height:32px;}",".f1szoe96{width:32px;}",".fb52u90{--fui-Spinner--strokeWidth:var(--strokeWidthThicker);}",".f8ljn23{height:36px;}",".fpdz1er{width:36px;}",".fbhnoac{height:40px;}",".feqmc2u{width:40px;}",".f1ft4266{height:44px;}",".fksc0bp{width:44px;}",".fa3u9ii{--fui-Spinner--strokeWidth:var(--strokeWidthThickest);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f1wkkxo7{background-image:conic-gradient(currentcolor 0deg, transparent 240deg);}}",{m:"screen and (prefers-reduced-motion: reduce)"}]]}),TE=eS({inverted:{sj55zd:"fonrgv7"},"extra-tiny":{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},tiny:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},"extra-small":{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},small:{Bahqtrf:"fk6fouc",Be2twd7:"fkhj508",Bhrd7zp:"figsok6",Bg96gwp:"f1i3iumi"},medium:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},large:{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},"extra-large":{Bahqtrf:"fk6fouc",Be2twd7:"fod5ikn",Bhrd7zp:"fl43uef",Bg96gwp:"faaz57k"},huge:{Bahqtrf:"fk6fouc",Be2twd7:"f1pp30po",Bhrd7zp:"fl43uef",Bg96gwp:"f106mvju"}},{d:[".fonrgv7{color:var(--colorNeutralForegroundStaticInverted);}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fkhj508{font-size:var(--fontSizeBase300);}",".figsok6{font-weight:var(--fontWeightRegular);}",".f1i3iumi{line-height:var(--lineHeightBase300);}",".fod5ikn{font-size:var(--fontSizeBase400);}",".fl43uef{font-weight:var(--fontWeightSemibold);}",".faaz57k{line-height:var(--lineHeightBase400);}",".f1pp30po{font-size:var(--fontSizeBase500);}",".f106mvju{line-height:var(--lineHeightBase500);}"]}),xE=V.forwardRef((e,t)=>{const n=wE(e,t);return(e=>{const{labelPosition:t,size:n,appearance:r}=e,{dir:i}=Am(),o=kE(),a=EE(),s=AE(),l=IE(),c=CE(),u=TE();e.root.className=$y("fui-Spinner",o,("above"===t||"below"===t)&&a.vertical,e.root.className),e.spinner&&(e.spinner.className=$y("fui-Spinner__spinner",s,l[n],"inverted"===r&&l.inverted,e.spinner.className)),e.spinnerTail&&(e.spinnerTail.className=$y("fui-Spinner__spinnerTail",c,"rtl"===i&&l.rtlTail,e.spinnerTail.className)),e.label&&(e.label.className=$y("fui-Spinner__label",u[n],"inverted"===r&&u.inverted,e.label.className))})(n),Pm("useSpinnerStyles_unstable")(n),(e=>{const{labelPosition:t,shouldRenderSpinner:n}=e;return gm(e.root,{children:[e.label&&n&&("above"===t||"before"===t)&&vm(e.label,{}),e.spinner&&n&&vm(e.spinner,{children:e.spinnerTail&&vm(e.spinnerTail,{})}),e.label&&n&&("below"===t||"after"===t)&&vm(e.label,{})]})})(n)});xE.displayName="Spinner";const RE=i(9354),OE=["af-ZA","am-ET","ar-SA","as-IN","az-Latn-AZ","bg-BG","bn-IN","bs-Latn-BA","ca-ES","ca-Es-VALENCIA","cs-CZ","cy-GB","da-DK","de-DE","el-GR","en-GB","es-ES","es-MX","et-EE","eu-ES","fa-IR","fi-FI","fil-PH","fr-CA","fr-FR","ga-IE","gd-gb","gl-ES","gu-IN","he-IL","hi-IN","hr-HR","hu-HU","hy-AM","id-ID","is-IS","it-IT","ja-JP","ka-GE","kk-KZ","km-KH","kn-IN","ko-KR","kok-IN","lb-LU","lo-LA","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-MY","mt-MT","nb-NO","ne-NP","nl-NL","nn-NO","or-IN","pa-IN","pl-PL","pt-BR","pt-PT","quz-PE","ro-RO","ru-RU","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv-SE","ta-IN","te-IN","th-TH","tr-TR","tt-RU","ug-CN","uk-UA","ur-PK","uz-Latn-UZ","vi-VN","zh-CN","zh-TW"];let PE=()=>{};const NE=new Promise(e=>{PE=e});let FE=RE;const BE=e=>FE.getString(e),LE=({isDarkTheme:e})=>{const t=!OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.ShowLoadingText",!1),[n,r]=V.useState(0);V.useEffect(()=>{setTimeout(()=>r(1),2800),setTimeout(()=>r(2),5600),NE.then(()=>{s(!0)})},[]);const[i,o]=V.useState(""),[a,s]=V.useState(!1);return V.useEffect(()=>{if(a)switch(n){case 1:o(BE("loadingPhase2"));break;case 2:o(BE("loadingPhase3"));break;default:o(BE("loadingPhase1"))}},[n,a]),V.createElement(Jy,{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"},theme:e?cE:hE},V.createElement("picture",null,V.createElement("source",{srcSet:e?"assets/app-dark.webp":"assets/app.webp",type:"image/webp"}),V.createElement("img",{src:e?"assets/app-dark.png":"assets/app.png",alt:"Loading",width:256,height:256})),i&&t?V.createElement(xE,{size:"medium",label:i,labelPosition:"after"}):V.createElement(xE,{size:"medium"}))};class DE{otelLogger;isDarkTheme;constructor(e,t=!1){this.otelLogger=e,this.isDarkTheme=t}getErrorUiData(e){return this.otelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.UnifiedStore.UnifiedStoreErrorUiData",eventFlags:{dataCategories:2,diagnosticLevel:100},dataFields:[n("errorReason",e)]}),e===Pn.AuthFailed?{localizedErrorStrings:{errorHeading:"Authentication Failed",errorSubtitle:"User authentication failed. Please try again.",bubbleHeading:"",bubbleSubtitle:"",openInDesktopButtonTitle:"",openInWebBrowserButtonTitle:"",openInLegacyBrowserButtonTitle:"Open legacy store",retryButtonTitle:""},openLegacyUrl:()=>{}}:e===Pn.Timeout?{localizedErrorStrings:{errorHeading:"Timeout",errorSubtitle:"The request timed out. Please try again.",bubbleHeading:"",bubbleSubtitle:"",openInDesktopButtonTitle:"",openInWebBrowserButtonTitle:"",openInLegacyBrowserButtonTitle:"",retryButtonTitle:"Retry"},retry:()=>{}}:{localizedErrorStrings:{errorHeading:"Error",errorSubtitle:"An error occurred. Please try again.",bubbleHeading:"",bubbleSubtitle:"",openInDesktopButtonTitle:"",openInWebBrowserButtonTitle:"",openInLegacyBrowserButtonTitle:"",retryButtonTitle:"Retry"},retry:()=>{}}}getErrorUi(e){return this.otelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.UnifiedStore.UnifiedStoreErrorUi",eventFlags:{dataCategories:2,diagnosticLevel:100},dataFields:[n("errorReason",e)]}),V.createElement("div",null,"Error: ",e)}getLoadingUi(){return V.createElement(LE,{isDarkTheme:this.isDarkTheme})}}class HE{allowInstall;isUpgrade;clientDetails;clientType;hostName;locale;pageType;sessionId;storeAppId;storeContentUrl;supportedElementInfo;titleId;isFromAppChat;userHasCopilotLicense;hostRingId;isManageAppPage;constructor(e){const t=Office.context.platform===Office.PlatformType.PC&&OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.CombinePhase0API",!1),n=JSON.parse(e),r=t&&n.PageInfo?n.PageInfo:n;var i;this.allowInstall=r.allowInstall,this.isUpgrade=r.isUpgrade,this.clientDetails=r.clientDetails,this.clientType=ef[r.clientType],this.hostName=(i=r.hostName)?i.charAt(0).toUpperCase()+i.slice(1):i,this.locale=r.locale,this.pageType=Qw[r.pageType],this.sessionId=r.sessionId,this.titleId=r.titleId,this.supportedElementInfo=r.supportedElementInfo,this.isFromAppChat=!!r.isFromAppChat,this.userHasCopilotLicense=!!r.userHasCopilotLicense,this.storeAppId=r.storeAppId,this.hostRingId=r.hostRingId?r.hostRingId:"SDFV2",this.isManageAppPage=!!r.isManageAppPage,this.storeContentUrl=this.getHostClientType(this.pageType,this.titleId)}getHostClientType=(e,t)=>{const n="empty",r=OfficeRuntime.experimentation.getStringFeatureGate("Microsoft.Office.OEP.FA000000136.StoreUrlContainer",n),i=OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.UnifiedStoreV2Enabled")?"metaos-store":"extensibility-apps";let o;switch(e){case Qw.default:o=this.isFromAppChat?`https://teams.microsoft.com/${i}/store/app:co:copilotplugins/view?host=metaos&language=${this.locale}&metaoshost=${this.hostName}&clienttype=${this.clientType}`:this.isManageAppPage?`https://teams.microsoft.com/${i}/store/manage?host=metaos&language=${this.locale}&metaoshost=${this.hostName}&clienttype=${this.clientType}`:`https://teams.microsoft.com/${i}/store/view?host=metaos&language=${this.locale}&metaoshost=${this.hostName}&clienttype=${this.clientType}`;break;case Qw.addinDetail:o=`https://teams.microsoft.com/${i}/appdetails/${t}/create?language=${this.locale}&metaoshost=${this.hostName}&host=metaos&clienttype=${this.clientType}`;break;default:return}return r===n?o:`${o}&container=${r}`};getSupportedElementInfo=()=>{const e={},t=JSON.parse(this.supportedElementInfo);return e.supportedElementInfo={},t.supportedElementTypes.forEach(t=>{e.supportedElementInfo[t]=[]}),e.clientDetails=JSON.parse(this.clientDetails),e}}class _E{returnFocus(e,t){return Promise.resolve()}setCurrentFrame(e){return Promise.resolve()}navigateToApp(e){return Promise.resolve()}shareDeepLink(e){return Promise.resolve()}addEventListener(e,t){}clearListeners(){}}const ME=[];function UE(){if(OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.authenticationPromptEnhancement",!1)){if(ME.length>0)return new Promise(e=>{ME.push(e)});const t=(e=zE()===Yd.dark,V.createElement(Jy,{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",zIndex:10,position:"absolute",top:0,left:0},theme:e?cE:hE},V.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"48px 0px",gap:"20px",position:"fixed",width:"235px",height:"400px",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},V.createElement("img",{src:"assets/authentication.png",alt:"Authentication",style:{display:"flex",flexDirection:"row",alignItems:"center",padding:"0px",gap:"10px",width:"192px",height:"192px",flex:"none",order:0,flexGrow:0}}),V.createElement("div",{style:{width:"235px",height:"40px",fontFamily:"Segoe UI",fontStyle:"normal",fontSize:"14px",lineHeight:"20px",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",flex:"none",order:0,alignSelf:"stretch",flexGrow:0,display:"flex",flexDirection:"column",alignItems:"center"}},V.createElement("p",{style:{fontWeight:700,margin:0}},BE("authentication")),V.createElement("p",{style:{fontWeight:400,margin:0}},BE("authenticationContent"))),V.createElement("button",{id:"allowPrompt",style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",padding:"5px 12px",width:"82px",height:"32px",background:"#C43E1C",borderRadius:"4px",color:"#FFFFFF",border:"none",cursor:"pointer",fontFamily:"Segoe UI",fontStyle:"normal",fontWeight:600,fontSize:"14px",lineHeight:"20px"}},BE("continue"))))),n=document.createElement("div");n.id="promptContainer",document.body.insertBefore(n,document.body.firstChild);const r=({})=>(V.useEffect(()=>{const e=document.getElementById("allowPrompt");let t=()=>{n.style.visibility="hidden",document.body.removeChild(n);for(let e=ME.length-1;e>=0;e--)ME[e](!0),ME.pop()};return e.addEventListener("click",t,{capture:!0,once:!0}),()=>{e.removeEventListener("click",t)}},[]),t);return new Promise(function(e){ME.push(e),K.render(V.createElement(r,null),n)})}var e;return new Promise(function(e,t){let n=document.getElementById("allowPromptDiv");if(n)return void n.addEventListener("click",()=>{e(!0)},{capture:!0,once:!0});let r=document.createElement("button");r.innerText="Allow prompt",r.id="allowPrompt",r.style.visibility="visible";let i=document.createElement("div");i.id="allowPromptDiv",i.style.display="inline-block",i.appendChild(r),r.addEventListener("click",()=>{r.style.visibility="hidden",document.body.removeChild(i),e(!0)},{capture:!0,once:!0}),document.body.insertBefore(i,document.body.firstChild)})}function zE(){try{return Office.context.officeTheme.isDarkTheme?Yd.dark:Yd.default}catch{return Yd.default}}class jE extends Yw{clientType;sessionId;otelLogger;constructor(e,t,n){super(),this.clientType=e,this.sessionId=t,this.otelLogger=n}async acquireToken(e){if(this.clientType!==ef.web){const t={dispidMethod:2004,resourceUrl:e};return{token:await OfficeFirstParty.PrivateApi.execute(JSON.stringify(t))}}{const r="f9b22626-3389-4216-a173-f8141a3c1e23",i="https://fa000000136.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2406.5004/en-us_web/redirect.html";OfficeFirstPartyAuth.NestedAppAuth.load(r,i);try{return{token:(await OfficeFirstPartyAuth.NestedAppAuth.getAccessToken({clientId:r,scopes:[e+"/.default"],popup:OfficeFirstPartyAuth.NestedAppAuth.PopupOptions.Auto,correlationId:this.sessionId,directUserActionCallback:UE,redirectUri:i})).accessToken}}catch(e){let r=e.description?e.description:"unknown error";this.otelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.UnifiedStore.WebAuthError",eventFlags:{dataCategories:2,diagnosticLevel:100},dataFields:[n("errorMessage",r),t("errorCode",e.code)]})}}}async getUser(){if(Office.context.platform===Office.PlatformType.PC&&KE.length>0&&OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.CombinePhase0API",!1))try{const e=JSON.parse(KE).User;return{profile:{tid:e.HomeTenantId,upn:e.Email,oid:e.Id,displayName:e.FriendlyName,loginHint:e.Email}}}catch(e){let r=e.description?e.description:"Failed to parse Phase0 API JSON for getUser";this.otelLogger.sendTelemetryEvent({eventName:"Office.Extensibility.UnifiedStore.ParseJson",eventFlags:{dataCategories:2,diagnosticLevel:100},dataFields:[n("errorMessage",r),t("errorCode",e.code)]})}const e=await OfficeFirstParty.PrivateApi.execute(JSON.stringify({dispidMethod:2005}));let r=JSON.parse(e);return{profile:{tid:r.HomeTenantId,upn:r.Email,oid:r.Id,displayName:r.FriendlyName,loginHint:r.Email}}}}class $E{async openLink(e){let t=(e=>{WE.install;const t=e.includes("/delete/"),n=e.substring(e.lastIndexOf("/")+1);return{action:t?WE.uninstall:WE.install,appId:n,isCopilot:e.toLowerCase().includes("/copilotapps/")}})(e);switch(t.action){case WE.install:const e={titleId:t.appId,isCopilot:t.isCopilot};window.external.closeSdxDialog?window.external.closeSdxDialog(JSON.stringify(e)):Office.ExtensionLifeCycle.close(JSON.stringify(e));break;case WE.uninstall:const n={dispidMethod:2007,titleId:t.appId};await OfficeFirstParty.PrivateApi.execute(JSON.stringify(n))}}}var WE;!function(e){e.install="install",e.uninstall="uninstall"}(WE||(WE={}));class qE{logger;constructor(e){this.logger=e}createScenario(e,t,n){return"api.registerHandler"===e?{markPhase:()=>{},stop:()=>{if(OfficeFirstParty.PrivateApi.execute(JSON.stringify({dispidMethod:2011,duration:Math.floor(performance.now()),...GE})),OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.DelayLoadingIndicator",!1)){const e=document.getElementById("indicator");e?.remove();const t=document.getElementById("containerParent");t&&(t.style.display="flex")}else{const e=document.getElementById("indicator");K.unmountComponentAtNode(e),document.getElementById("indicatorParent")?.remove();const t=document.getElementById("container");t&&(t.style.display="flex")}},fail(){}}:"appInitializationExtended"===e?(OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.PreloadTelemetry",!1)&&Office.WebExtension?.Interactive?.(!0),{markPhase:()=>{},stop:()=>{OfficeFirstParty.PrivateApi.execute(JSON.stringify({dispidMethod:2012,duration:Math.floor(performance.now())}))},fail(){}}):{markPhase(){},stop(){},fail(){}}}}function VE(){const e={sendTelemetryEvent:e=>{Office.sendTelemetryEvent(e)}},t=new q;return t.setTenantToken("Office.Extensibility.UnifiedStore","db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",1755),t.addSink(e),t}const GE={officeReadyDuration:-1,getStorePageInfoDuration:-1,getUserInfoDuration:-1,getAllPhase0InfoDuration:-1};let KE="";Office.onReady(()=>{if(OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.PreloadTelemetry",!1)&&Office.WebExtension?.Interactive?.(!1),async function(){var e;GE.officeReadyDuration=performance.now(),await(e=Office.context.displayLanguage,new Promise(t=>{if("en-us"===e.toLowerCase())return void t();let n=null;for(let t=0;t<OE.length;t++)e.toLowerCase()===OE[t].toLowerCase()&&(n=OE[t]);if(null===n)return console.error("Language "+e+" is not available at this time."),void t();const r=new XMLHttpRequest,i="intl/"+n+"/strings.resjson";r.open("GET",i,!0),r.setRequestHeader("Content-Type","application/json"),r.timeout=6e4,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE)if(200===r.status){const e=JSON.parse(r.responseText);FE={getString:t=>e[t]?e[t]:RE.getString(t)},t()}else console.error("Failed to load "+e+" strings with status = "+r.status),t()},r.onerror=n=>{console.error("Failed to load "+e+" strings with error = "+n),t()},r.ontimeout=()=>{console.error("Failed to load "+e+" strings with timeout"),t()},r.send()}).finally(PE)),Office.context.platform===Office.PlatformType.PC&&OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.CombinePhase0API",!1)&&(KE=await async function(){return OfficeFirstParty.PrivateApi.execute(JSON.stringify({dispidMethod:2013}))}(),GE.getAllPhase0InfoDuration=performance.now());const r=await async function(){if(Office.context.platform===Office.PlatformType.PC&&KE.length>0&&OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.CombinePhase0API",!1))try{return new HE(KE)}catch(e){let r=e.description?e.description:"Failed to parse Phase0 API JSON for getStorePageInfo";VE().sendTelemetryEvent({eventName:"Office.Extensibility.UnifiedStore.ParseJson",eventFlags:{dataCategories:2,diagnosticLevel:100},dataFields:[n("errorMessage",r),t("errorCode",e.code)]})}const e=await OfficeFirstParty.PrivateApi.execute(JSON.stringify({dispidMethod:2009}));return new HE(e)}();GE.getStorePageInfoDuration=performance.now();const i=VE(),o=zE(),a={authenticationService:new jE(r.clientType,r.sessionId,i),linkService:new $E,hubUiService:new DE(i,o===Yd.dark),telemetryService:new qE(i),pageService:new _E,logger:{log:function(e,t,n,r){OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.showingLog",!1)&&console.log(` ${e} [${t}] ${n} ${r}`)}}},s=await a.authenticationService.getUser();GE.getUserInfoDuration=performance.now();const l={id:s.profile.oid,displayName:s.profile.displayName,userPrincipalName:s.profile.upn,tenant:{id:s.profile.tid},dataResidency:sr.Public};K.render(V.createElement(Jw,{hubServices:a,storePageInfo:r,user:l,storeAppResource:"https://teams.microsoft.com",storeTitle:"App Store",theme:o}),document.getElementById("container"))}(),OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.OEP.FA000000136.DelayLoadingIndicator",!1))document.getElementById("indicatorParent")?.remove(),document.getElementById("container").style.display="flex";else{const e=document.getElementById("indicator"),t=zE();K.render(V.createElement(LE,{isDarkTheme:"dark"===t}),e)}}),"OfficeOnline"===Office.context.platform&&window.self===window.top&&(window.addEventListener("beforeunload",e=>{OfficeFirstParty.PrivateApi.execute(JSON.stringify({dispidMethod:1001}))}),setInterval(()=>{window.opener&&!window.opener.closed||window.close()},500))})(),TypeScriptModule=o})();