(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[15456],{5062:(e,t,r)=>{"use strict";r.d(t,{f:()=>p});var n=r(75992),o=r(28673),i=r.n(o),s=r(42907),a=r.n(s),c=r(56707),l=r.n(c),u=r(91733),d=r.n(u);class p extends n.r{loggingData(){const e=i()(this.containerPlanMapping).length,t=d()(this.containerPlanMapping,e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.length)&&void 0!==t?t:0}),r=a()(l()(this.containerPlanMapping),"length");return{containerCount:String(e),planCountByContainer:JSON.stringify(t),totalPlanCount:String(r),containerType:String(this.containerType)}}constructor(e,t){super(p.actionType),this.containerPlanMapping=e,this.containerType=t}}p.actionType="PLW_RESOLVECONTAINERSTOPLANS_SUCCEEDED"},9614:(e,t,r)=>{"use strict";r.d(t,{H:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.unifiedGroupId=e}}o.actionType="PLW_DELETE_UNIFIEDGROUP"},13728:(e,t,r)=>{var n=r(78420),o=r(96614),i=r(84570),s=r(6571),a=r(36140),c=r(28673),l=Object.prototype.hasOwnProperty,u=i(function(e,t){if(a(t)||s(t))o(t,c(t),e);else for(var r in t)l.call(t,r)&&n(e,r,t[r])});e.exports=u},14740:e=>{e.exports=function(e){for(var t=-1,r=null==e?0:e.length,n=0,o=[];++t<r;){var i=e[t];i&&(o[n++]=i)}return o}},15434:(e,t,r)=>{"use strict";r.d(t,{x:()=>o});var n=r(32512);class o extends n.v{constructor(e,t,r,n){super(o.actionType,e,t,r),this.containerId=n}}o.actionType="PLW_GET_CONTAINER_FAIL"},19879:(e,t,r)=>{"use strict";r.d(t,{k:()=>o});var n=r(75992);class o extends n.r{constructor(e,t){super(o.actionType),this.groupId=e,this.sensitivityLabelId=t}}o.actionType="PLW_GET_UNIFIEDGROUPSENSITIVITYLABEL_SUCCEEDED"},29274:(e,t,r)=>{"use strict";r.d(t,{S:()=>i});var n=r(75992),o=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(r,n,o){var i=e.call(this,t.type)||this;return i.name=r,i.id=n,i.additionalData=o,i}return o(t,e),t.prototype.loggingData=function(){return{name:this.name,id:this.id}},t.type="BEGIN_TRANSACTION",t}(n.r)},39115:(e,t,r)=>{var n=r(45967),o=r(36311),i=r(50715);e.exports=function(e){return o(e)?i(e):n(e)}},40655:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var n=r(65818),o=r(75992);class i extends o.r{loggingData(){return{containerType:String(n.K),idCount:String(this.containers.length)}}constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(i.actionType),this.containerType=e,this.containers=t,this.isFirstPage=r}}i.actionType="PLW_GET_IDSFORCONTAINERTYPE_SUCCEEDED"},42907:(e,t,r)=>{var n=r(9096),o=r(99910);e.exports=function(e,t){return e&&e.length?o(e,n(t,2)):0}},44227:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.container=e}}o.actionType="PLW_CREATE_ROSTER_CONTAINER_SUCCESS"},45234:e=>{e.exports=function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}},45967:e=>{e.exports=function(e){return e.split("")}},47204:(e,t,r)=>{"use strict";r.d(t,{Y:()=>i});var n=r(75992),o=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(r,n,o){var i=e.call(this,t.type)||this;return i.id=r,i.errorMessage=n,i.additionalData=o,i}return o(t,e),t.prototype.loggingData=function(){return{errorMessage:this.errorMessage,id:this.id}},t.type="TRANSACTION_FAILED",t}(n.r)},50715:e=>{var t="\\ud800-\\udfff",r="["+t+"]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",i="[^"+t+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",c="(?:"+n+"|"+o+")"+"?",l="[\\ufe0e\\ufe0f]?",u=l+c+("(?:\\u200d(?:"+[i,s,a].join("|")+")"+l+c+")*"),d="(?:"+[i+n+"?",n,s,a,r].join("|")+")",p=RegExp(o+"(?="+o+")|"+d+u,"g");e.exports=function(e){return e.match(p)||[]}},54439:(e,t,r)=>{"use strict";r.d(t,{j:()=>l});var n=r(29274),o=r(74427),i=r(57860),s=r(47204),a=r(74568),c=r(79947);class l{static beginTransaction(e,t,r){let{transactionId:o,name:i,logQos:s,action:c,additionalData:u}=t;if(!0===s){const e=new a.W({name:"Tx:"+i},r);l.qosEventsInFlight[o]=e}e.batchDispatchActions(new n.S(i,o,u),c)}static cancelTransaction(e,t){let{transactionId:r,action:n,additionalData:i}=t;const s=l.qosEventsInFlight[r];s&&(s.end({resultType:c.f.ExpectedFailure,extraData:i}),delete l.qosEventsInFlight[r]),e.batchDispatchActions(n,new o.D(r,i))}static completeTransaction(e,t){let{transactionId:r,action:n,additionalData:o}=t;const s=l.qosEventsInFlight[r];s&&(s.end({resultType:c.f.Success,extraData:o}),delete l.qosEventsInFlight[r]),e.batchDispatchActions(n,new i.M(r,o))}static completeTransactionWithBatch(e,t){let{transactionId:r,actions:n,additionalData:o}=t;const s=l.qosEventsInFlight[r];s&&(s.end({resultType:c.f.Success,extraData:o}),delete l.qosEventsInFlight[r]),e.batchDispatchActions(...n,new i.M(r,o))}static completeTransactionWithError(e,t){let{transactionId:r,errorMessage:n,action:o,additionalData:i}=t;const a=l.qosEventsInFlight[r];a&&(a.end({resultType:c.f.Failure,error:n,extraData:i}),delete l.qosEventsInFlight[r]),e.batchDispatchActions(o,new s.Y(r,n,i))}}l.qosEventsInFlight={}},55637:(e,t,r)=>{"use strict";r.d(t,{G:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.container=e}}o.actionType="PLW_UPDATE_CONTAINER_SUCCESS"},56707:(e,t,r)=>{var n=r(9812),o=r(91980),i=r(26924),s=r(6571),a=r(90620),c=r(45234),l=r(54160),u=r(52074),d=r(39115),p=r(26727),g=n?n.iterator:void 0;e.exports=function(e){if(!e)return[];if(s(e))return a(e)?d(e):o(e);if(g&&e[g])return c(e[g]());var t=i(e);return("[object Map]"==t?l:"[object Set]"==t?u:p)(e)}},57860:(e,t,r)=>{"use strict";r.d(t,{M:()=>i});var n=r(75992),o=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(r,n){var o=e.call(this,t.type)||this;return o.id=r,o.additionalData=n,o}return o(t,e),t.prototype.loggingData=function(){return{id:this.id}},t.type="TRANSACTION_SUCEEDED",t}(n.r)},60878:(e,t,r)=>{"use strict";r.d(t,{L:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.container=e}}o.actionType="PLW_GET_CONTAINER_SUCCESS"},64805:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});class n{get clientSettings(){return this.clientSettingsProvider()}constructor(e,t,r){this.dispatcher=e,this.clientSettingsProvider=t,this.loggers=r}}class o extends n{getCurrentViewIds(){const e=this.stores.appContextStore.getCurrentViewId();return e?[e]:void 0}constructor(e,t,r,n,o){super(e,n,o),this.webApiProviders=t,this.stores=r}}},74427:(e,t,r)=>{"use strict";r.d(t,{D:()=>i});var n=r(75992),o=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},e(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){function t(r,n){var o=e.call(this,t.type)||this;return o.id=r,o.additionalData=n,o}return o(t,e),t.prototype.loggingData=function(){return{id:this.id}},t.type="CANCEL_TRANSACTION",t}(n.r)},78400:(e,t,r)=>{"use strict";r.r(t),r.d(t,{ContainerModule:()=>K,MAX_RETRIES_PER_GROUP:()=>M,POLL_INTERVAL:()=>B});var n=r(32512);class o extends n.v{constructor(e,t,r,n){super(o.actionType,e,t,r),this.groupId=n}}o.actionType="PLW_GET_UNIFIEDGROUP_FAILED";var i=r(94600);class s extends n.v{constructor(e,t,r,n){super(s.actionType,e,t,r),this.groupId=n}}s.actionType="PLW_GET_UNIFIEDGROUPDETAILS_FAILED";var a=r(19879),c=r(9614),l=r(87337),u=r(78751),d=r(85262),p=r(60166),g=r(65394),h=r(36131),v=r(68746),T=r(38110),y=r(40655),f=r(5062);class I extends n.v{constructor(e,t,r){super(I.actionType,e,t,r)}}I.actionType="PLW_RESOLVECONTAINERSTOPLANS_FAILED";var P=r(60878),C=r(15434),A=r(55637),E=r(44227),x=r(78332),S=r(64805),L=r(65818),w=r(64836);class G extends w.m{constructor(e){super({externalId:e,containerType:L.K.DriveItem})}}var m=r(88457);class _ extends w.m{constructor(e){super({externalId:e,containerType:L.K.User})}}var D=r(74844),F=r(14740),b=r.n(F),k=r(13728),R=r.n(k),U=r(98502),j=r(54439),N=r(38752),O=r(37084),W=r.n(O),V=r(82841);const M=20,B=3e4;class K extends S.J{get name(){return"ContainerModule"}async fetchContainer(e,t){const{containerType:r,externalId:n}=e;switch(r){case L.K.Group:try{const e=await this.fetchUnifiedGroupAsync(n);if(t){const t=await this.fetchUnifiedGroupDetailsAsync(n);return new m.Z(n,e,t)}return new m.Z(n,e,null)}catch(o){return Promise.reject(o)}case L.K.DriveItem:const e=new G(n);return this.dispatcher.dispatchAction(new P.L(e)),Promise.resolve(e);case L.K.User:const r=new _(N.B.currentUserId);return this.dispatcher.dispatchAction(new P.L(r)),Promise.resolve(r);case L.K.Roster:try{return await this.fetchRosterContainerAsync(n)}catch(o){return Promise.reject(o)}default:return Promise.reject(U.g.generateAjaxClientError(null,"Invalid container type"))}}async fetchContainers(e,t,r){if(e===L.K.User){const t=[{id:{externalId:N.B.currentUserId,containerType:L.K.User},externalId:N.B.currentUserId,containerType:L.K.User,displayName:""}];return this.dispatcher.dispatchAction(new y.A(e,t,!0)),{Results:t,NextContinuationToken:null}}this.loggers.traceLogger.logTrace(507897248,D.k.Verbose,"Fetch Containers [containerType=".concat(e,"]"));const n=e=>{if(e.nextContinuationToken)return null;const t=this.stores.containerStore.getContainersByContainerType(e.containerType);return null!=t?{data:{Results:t,NextContinuationToken:null}}:null};try{const o=await this.webApiProviders.taskService(),i=await o.getContainersAsync({containerType:e,nextContinuationToken:t},n,void 0,r);return this.loggers.traceLogger.logTrace(507897247,D.k.Verbose,"Fetch Containers Success [containerType=".concat(e,"]")),this.dispatcher.dispatchAction(new y.A(e,i.data.Results,null==t)),i.data}catch(o){const t=o;return this.loggers.traceLogger.logTrace(507897246,D.k.Warning,"Fetch Containers Failed [containerType=".concat(e,"]").concat((0,V.s8)(t))),Promise.reject(t)}}async resolveContainersToPlans(e,t,r){if(this.loggers.traceLogger.logTrace(507897245,D.k.Verbose,"Resolve Containers To Plans [containerType=".concat(e,"][containerExternalIds.length=").concat(t.length,"]")),0===t.length)return Promise.resolve({});const n=e=>{const t={};for(let r=0;r<e.containerIds.length;r++){const n=e.containerIds[r];if(!this.stores.containerMembershipStore.getContainerHasBeenResolved(n))return null;const o=this.stores.containerMembershipStore.getPlanIdsForContainer(n);if(null==o)return null;const i=o.map(e=>this.stores.planStore.getPlan(e));if(-1!==i.indexOf(null))return null;t[n]=b()(i)}return t},o=await this.webApiProviders.taskService(),i=this.stores.appContextStore.getApiBatchLimits().ResolveGroupsToPlansBatchedAsync,s=t.slice(),a=[];for(;s.length>0;){let t=[];t=s.length<=i?s.splice(0):s.splice(0,i),a.push(o.resolveContainerIdsToPlansBatchedAsync({containerType:e,containerIds:t},n,void 0,r).then(t=>(this.loggers.traceLogger.logTrace(507897244,D.k.Verbose,"Resolve Containers To Plans Batch Success [containerType=".concat(e,"]")),this.dispatcher.dispatchAction(new f.f(t,e)),Promise.resolve(t)),t=>{var r,n,o,i;return this.loggers.traceLogger.logTrace(507897243,D.k.Warning,"Resolve Containers to Plans Batch Failed [containerType=".concat(e,"]").concat((0,V.s8)(t))),this.dispatcher.dispatchAction(new I(t.response,null!==(r=null===(n=t.response)||void 0===n?void 0:n.statusText)&&void 0!==r?r:"",null!==(o=null===(i=t.error)||void 0===i?void 0:i.message)&&void 0!==o?o:"")),Promise.reject(t)}))}const c=await Promise.allSettled(a),l={};let u;if(c.forEach(e=>{if("fulfilled"===e.status)null!=e.value&&R()(l,e.value);else if("rejected"===e.status){var t,r,n,o;u=e;const i=null!==(t=null===(r=u.reason)||void 0===r||null===(r=r.response)||void 0===r?void 0:r.status)&&void 0!==t?t:0,s=null!==(n=null===(o=u.reason)||void 0===o||null===(o=o.response)||void 0===o?void 0:o.statusText)&&void 0!==n?n:"";this.loggers.traceLogger.logTrace(507897242,D.k.Warning,"Resolve Containers to Plans Failed [statusCode=".concat(i,"][statusText=").concat(s,"]"))}}),null==u)return this.loggers.traceLogger.logTrace(507897241,D.k.Verbose,"Resolve Containers To Plans Success [containerType=".concat(e,"][containerExternalIds.length=").concat(t.length,"]")),l;{const e=u.reason||U.g.generateAjaxClientError(null,"");return Promise.reject(e)}}async fetchUnifiedGroupAsync(e){if(this.loggers.traceLogger.logTrace(507897240,D.k.Verbose,"Ensure Group [groupId=".concat(e,"]")),!e)return this.loggers.traceLogger.logTrace(507897239,D.k.Warning,"Ensure Group Failed [groupId=".concat(e,"][Error=ArgumentNullException: groupId]")),Promise.reject(U.g.generateAjaxClientError(null,"ArgumentNullException: groupId"));const t=e=>{var t;const r=this.stores.containerStore.getContainer(e.groupId),n=(null===r||void 0===r?void 0:r.containerType)===L.K.Group?r:null;return null!==(t=null===n||void 0===n?void 0:n.unifiedGroup)&&void 0!==t?t:null},r=e+x.Ek.FetchGroup;j.j.beginTransaction(this.dispatcher,{name:"fetchGroup",transactionId:r},this.loggers.logHandler);try{const n=await this.webApiProviders.graph(),o=await n.getUnifiedGroupAsync({groupId:e},t);this.loggers.traceLogger.logTrace(507897238,D.k.Verbose,"Ensure Group Success [groupId=".concat(e,"]"));const i=new m.Z(o.id,o,null);return j.j.completeTransaction(this.dispatcher,{transactionId:r,action:new P.L(i)}),o}catch(u){var n,i,s,a,c,l;const t=u;this.loggers.traceLogger.logTrace(507897237,D.k.Warning,"Ensure Group Failed [groupId=".concat(e,"]").concat((0,V.s8)(t)));const d=null!==(n=null===(i=t.response)||void 0===i?void 0:i.status)&&void 0!==n?n:0;return j.j.completeTransactionWithError(this.dispatcher,{transactionId:r,action:new o(t.response,null!==(s=null===(a=t.response)||void 0===a?void 0:a.statusText)&&void 0!==s?s:"",null!==(c=null===(l=t.error)||void 0===l?void 0:l.message)&&void 0!==c?c:"",e),errorMessage:"",additionalData:{statusCode:d}}),Promise.reject(t)}}async fetchUnifiedGroupDetailsAsync(e){if(this.loggers.traceLogger.logTrace(507897236,D.k.Verbose,"Ensure Group Details [groupId=".concat(e,"]")),!e)return this.loggers.traceLogger.logTrace(507897235,D.k.Warning,"Ensure Group Details Failed [groupId=".concat(e,"][Error=ArgumentNullException: groupId]")),Promise.reject(U.g.generateAjaxClientError(null,"ArgumentNullException: groupId"));const t=this.stores.containerStore.getContainer(e);if(t&&t.containerType===L.K.Group){var r;const n=t;if(null!==(r=n.unifiedGroupDetails)&&void 0!==r&&r.isFullyProvisioned())return this.loggers.traceLogger.logTrace(507897234,D.k.Verbose,"Ensure Group Details Success - group details fully provisioned [groupId=".concat(e,"]")),Promise.resolve(n.unifiedGroupDetails)}const n=e=>{const t=this.stores.containerStore.getContainer(e.groupId);if(t&&t.containerType===L.K.Group){var r;const e=t;if(null!==(r=e.unifiedGroupDetails)&&void 0!==r&&r.isFullyProvisioned())return e.unifiedGroupDetails}return null},o=this.getCurrentViewIds();try{const t=await this.webApiProviders.taskService(),r=await t.getUnifiedGroupDetailsAsync({groupId:e},n,o);return this.loggers.traceLogger.logTrace(507897233,D.k.Verbose,"Ensure Group Details Success [groupId=".concat(e,"]")),this.dispatcher.dispatchAction(new i.P(r)),r}catch(d){var a,c,l,u;const t=d;return this.dispatcher.dispatchAction(new s(t.response,null!==(a=null===(c=t.response)||void 0===c?void 0:c.statusText)&&void 0!==a?a:"",null!==(l=null===(u=t.error)||void 0===u?void 0:u.message)&&void 0!==l?l:"",e)),this.loggers.traceLogger.logTrace(507897232,D.k.Warning,"Ensure Group Details Failed [groupId=".concat(e,"]").concat((0,V.s8)(t))),Promise.reject(t)}}async fetchGroupSensitivityLabelAsync(e){this.loggers.traceLogger.logTrace(507897231,D.k.Verbose,"Fetching Group Sensitivity Label [GroupId=".concat(e,"]"));try{const t=await this.webApiProviders.taskService(),r=await t.getUnifiedGroupSensitivityLabelAsync({groupId:e});return this.loggers.traceLogger.logTrace(507897230,D.k.Verbose,"Fetching Group Sensitivity Label - Success [GroupId=".concat(e,"]")),this.dispatcher.dispatchAction(new a.k(e,r)),r}catch(t){const r=t;return this.loggers.traceLogger.logTrace(507897229,D.k.Warning,"Fetching Group Sensitivity Label - Failure  [GroupId=".concat(e,"]").concat((0,V.s8)(r))),Promise.reject(r)}}async fetchRosterContainerAsync(e){if(this.loggers.traceLogger.logTrace(507897228,D.k.Verbose,"Fetching Roster Container [ContainerId=".concat(e,"]")),!e)return this.loggers.traceLogger.logTrace(507897227,D.k.Warning,"Fetching Roster Container Failed [ContainerId=".concat(e,"][Error=ArugumentNullException: containerId]")),Promise.reject(U.g.generateAjaxClientError(null,"ArgumentNullException: containerId"));const t=e=>{const t=this.stores.containerStore.getContainer(e.containerId);return(null===t||void 0===t?void 0:t.containerType)===L.K.Roster?t:null};try{const r=await this.webApiProviders.taskService(),n=await r.getRosterContainerAsync({containerId:e},t);return this.loggers.traceLogger.logTrace(507897226,D.k.Verbose,"Fetching Roster Container - Success [ContainerId=".concat(e,"]")),this.dispatcher.dispatchAction(new P.L(n)),n}catch(s){var r,n,o,i;const t=s;return this.loggers.traceLogger.logTrace(507897225,D.k.Warning,"Fetching Roster Container - Failure  [ContainerId=".concat(e,"]").concat((0,V.s8)(t))),this.dispatcher.dispatchAction(new C.x(t.response,null!==(r=null===(n=t.response)||void 0===n?void 0:n.statusText)&&void 0!==r?r:"",null!==(o=null===(i=t.error)||void 0===i?void 0:i.message)&&void 0!==o?o:"",e)),Promise.reject(t)}}pollForGroupFullyProvisioned(e){this.isPollingGroup[e.id]||(this.isPollingGroup[e.id]=!0,this.internalPollForGroupFullyProvisioned(e))}internalPollForGroupFullyProvisioned(e){if(e.isFullyProvisioned())return void delete this.isPollingGroup[e.id];const t=this.stores.appContextStore.getCurrentPlanId();(t?this.stores.planStore.getContainerIdForPlan(t):this.stores.appContextStore.getCurrentGroupId())===e.id?(this.retriesPerGroup[e.id]||(this.retriesPerGroup[e.id]=0),this.retriesPerGroup[e.id]<M?(this.retriesPerGroup[e.id]++,setTimeout(()=>{this.loggers.traceLogger.logTrace(507897224,D.k.Info,"Polling for group [Id=".concat(e.id,"][Retries=").concat(this.retriesPerGroup[e.id],"][IsProvisioned=").concat(e.isFullyProvisioned(),"][SPO=").concat(e.isSharePointProvisioned(),"]")),this.fetchUnifiedGroupDetailsAsync(e.id).then(e=>this.internalPollForGroupFullyProvisioned(e)).catch(()=>{delete this.isPollingGroup[e.id]})},B)):delete this.isPollingGroup[e.id]):delete this.isPollingGroup[e.id]}async createRosterContainerAsync(){this.loggers.traceLogger.logTrace(507897223,D.k.Verbose,"Create Roster Container");try{const e=await this.webApiProviders.taskService(),t=await e.createPlannerRosterAsync({});return this.loggers.traceLogger.logTrace(507897222,D.k.Verbose,"Create Roster Container - Success [ContainerId=".concat(t.externalId,"]")),this.dispatcher.dispatchAction(new E.A(t)),t}catch(e){throw this.loggers.traceLogger.logTrace(507897221,D.k.Warning,"Create Roster Container - Failure ".concat((0,V.s8)(e))),e}}async setRosterContainerSensitivityLabelAsync(e){this.loggers.traceLogger.logTrace(507897220,D.k.Verbose,"Set Roster Sensitivity Label [ContainerId=".concat(e.externalId,"]"));try{const t=await this.webApiProviders.taskService(),r=await t.setRosterSensitivityLabelAsync({rosterContainer:e});return this.loggers.traceLogger.logTrace(507897219,D.k.Verbose,"Set Roster Container Sensitivity Label - Success [ContainerId=".concat(e.externalId,"]")),this.dispatcher.dispatchAction(new A.G(r)),r}catch(t){const r=t;return this.loggers.traceLogger.logTrace(507897218,D.k.Warning,"Set Roster Container Sensitivity Label - Failure  [ContainerId=".concat(e.externalId,"]").concat((0,V.s8)(r))),Promise.reject(r)}}async addUsersToContainerAsync(e,t){this.loggers.traceLogger.logTrace(507897217,D.k.Verbose,"Batch Add Users To Container [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]")),this.dispatcher.dispatchAction(new d.V(t,e.externalId));const r=this.stores.appContextStore.getApiBatchLimits().AddUsersToGroupMaxBatchSize,n=await this.webApiProviders.taskService();return new Promise((o,i)=>{const s=[];for(const a of W()(t,r)){const t=[];for(const r of a)t.push(n.addUserToContainer({container:e,userId:r}).then(()=>(this.loggers.traceLogger.logTrace(507897216,D.k.Verbose,"Add User To Container Success [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]")),this.dispatcher.dispatchAction(new p.$(r,e.externalId)),Promise.resolve()),t=>{var n,o,i,s;return this.loggers.traceLogger.logTrace(507897187,D.k.Warning,"Add User To Container Failed [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]").concat((0,V.s8)(t))),this.dispatcher.dispatchAction(new g.d(r,e.externalId,t.response,null!==(n=null===(o=t.response)||void 0===o?void 0:o.statusText)&&void 0!==n?n:"",null!==(i=null===(s=t.error)||void 0===s?void 0:s.message)&&void 0!==i?i:"")),Promise.reject(t)}));s.push(Promise.allSettled(t).then(async e=>{let t;if(e.forEach(e=>{"rejected"===e.status&&(t=e)}),null!=t){const e=t.reason||U.g.generateAjaxClientError(null,"");return Promise.reject(e)}Promise.resolve()}))}Promise.allSettled(s).then(async e=>{let t;if(e.forEach(e=>{if("rejected"===e.status){var r,n,o,i;t=e;const s=null!==(r=null===(n=t.reason)||void 0===n||null===(n=n.response)||void 0===n?void 0:n.status)&&void 0!==r?r:0,a=null!==(o=null===(i=t.reason)||void 0===i||null===(i=i.response)||void 0===i?void 0:i.statusText)&&void 0!==o?o:"";this.loggers.traceLogger.logTrace(507897186,D.k.Warning,"Add Users To Container Failed [statusCode=".concat(s,"][statusText=").concat(a,"]"))}}),null==t)o();else{const e=t.reason||U.g.generateAjaxClientError(null,"");i(e)}})})}async removeUserFromContainerAsync(e,t){this.loggers.traceLogger.logTrace(507897185,D.k.Verbose,"Remove User From Container [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]")),this.dispatcher.dispatchAction(new h.C(t,e.externalId));try{const r=await this.webApiProviders.taskService();return await r.removeUserFromContainer({container:e,userId:t}),this.loggers.traceLogger.logTrace(507897184,D.k.Verbose,"Remove User From Container Success [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]")),this.dispatcher.dispatchAction(new v.f(t,e.externalId)),Promise.resolve()}catch(s){var r,n,o,i;const a=s;return this.loggers.traceLogger.logTrace(507897183,D.k.Warning,"Remove User From Container Failed [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]").concat((0,V.s8)(a))),this.dispatcher.dispatchAction(new T.R(t,e.externalId,a.response,null!==(r=null===(n=a.response)||void 0===n?void 0:n.statusText)&&void 0!==r?r:"",null!==(o=null===(i=a.error)||void 0===i?void 0:i.message)&&void 0!==o?o:"")),Promise.reject(a)}}deleteContainer(e){return e.containerType===L.K.Group?this.deleteGroupContainer(e):(this.loggers.traceLogger.logTrace(507897182,D.k.Warning,"Trying to delete non-group container [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]")),Promise.reject(U.g.generateAjaxClientError(null,"Trying to delete non-group container")))}async deleteGroupContainer(e){this.loggers.traceLogger.logTrace(507897181,D.k.Verbose,"Delete container [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]")),this.dispatcher.dispatchAction(new c.H(e.externalId));try{const t=await this.webApiProviders.taskService();return await t.deleteUnifiedGroupAsync({groupId:e.externalId}),this.loggers.traceLogger.logTrace(507897180,D.k.Verbose,"Delete container success [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]")),this.dispatcher.dispatchAction(new l.s(e)),Promise.resolve()}catch(s){var t,r,n,o,i;const a=s;return 404===(null===(t=a.response)||void 0===t?void 0:t.status)?(this.loggers.traceLogger.logTrace(507897179,D.k.Info,"Delete container failed - Not found [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]").concat((0,V.s8)(a))),this.dispatcher.dispatchAction(new l.s(e)),Promise.resolve()):(this.loggers.traceLogger.logTrace(507897178,D.k.Warning,"Delete container failed [containerId=".concat(e.externalId,"][containerType=").concat(e.containerType,"]").concat((0,V.s8)(a))),this.dispatcher.dispatchAction(new u.W(e.externalId,a.response,null!==(r=null===(n=a.response)||void 0===n?void 0:n.statusText)&&void 0!==r?r:"",null!==(o=null===(i=a.error)||void 0===i?void 0:i.message)&&void 0!==o?o:"")),Promise.reject(a))}}constructor(){super(...arguments),this.retriesPerGroup={},this.isPollingGroup={}}}},78751:(e,t,r)=>{"use strict";r.d(t,{W:()=>o});var n=r(32512);class o extends n.v{constructor(e,t,r,n){super(o.actionType,t,r,n),this.unifiedGroupId=e}}o.actionType="PLW_DELETE_UNIFIEDGROUP_FAILED"},87337:(e,t,r)=>{"use strict";r.d(t,{s:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.container=e}}o.actionType="PLW_DELETE_UNIFIEDGROUP_SUCCEEDED"},88457:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(65818),o=r(64836);class i extends o.m{constructor(e,t,r){super({externalId:e,containerType:n.K.Group},t.displayName),this.unifiedGroup=t,this.unifiedGroupDetails=r}}},94600:(e,t,r)=>{"use strict";r.d(t,{P:()=>o});var n=r(75992);class o extends n.r{constructor(e){super(o.actionType),this.unifiedGroupDetails=e}}o.actionType="PLW_GET_UNIFIEDGROUPDETAILS_SUCCEEDED"},99910:e=>{e.exports=function(e,t){for(var r,n=-1,o=e.length;++n<o;){var i=t(e[n]);void 0!==i&&(r=void 0===r?i:r+i)}return r}}}]);
//# sourceMappingURL=containermodule.b74bcd32.chunk.js.map