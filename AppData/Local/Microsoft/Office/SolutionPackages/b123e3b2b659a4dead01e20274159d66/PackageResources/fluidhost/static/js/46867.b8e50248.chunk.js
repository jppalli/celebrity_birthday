(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[46867],{12358:(e,t,n)=>{var r=n(95694),a=n(41069),o=/[&<>"']/g,l=RegExp(o.source);e.exports=function(e){return(e=a(e))&&l.test(e)?e.replace(o,r):e}},14983:(e,t,n)=>{"use strict";var r;n.d(t,{Er:()=>r,LP:()=>a,ig:()=>o}),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Project="Project",e.Visio="Visio",e.Pdf="Pdf",e.Loop="Loop",e.Other="Other"}(r||(r={}));r.OneNote,r.Project,r.Visio;var a,o=["jpg","jpeg","png","gif","bmp"];!function(e){e.Stream="stream-video",e.Youtube="yt-video",e.Vimeo="vimeo-video",e.DailyMotion="dm-video",e.Facebook="fb-video"}(a||(a={}))},18504:(e,t,n)=>{"use strict";n.d(t,{J:()=>l});const r={empty:!0},a={},o="undefined"===typeof WeakMap?null:WeakMap;function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!o)return e;let r=null,a=0;return function(){var o;let l=r;(null===r||t>0&&a>t)&&(r=s(),a=0),l=r;for(let e=0;e<arguments.length;e+=1){var c,d,p;const t=i(e<0||arguments.length<=e?void 0:arguments[e]);var u;if(null===(c=l)||void 0===c||null===(c=c.map)||void 0===c||!c.has(t))null===(u=l)||void 0===u||null===(u=u.map)||void 0===u||u.set(t,s());l=null!==(d=null===(p=l)||void 0===p||null===(p=p.map)||void 0===p?void 0:p.get(t))&&void 0!==d?d:null}return l&&!l.hasOwnProperty("value")&&(l.value=e(...arguments),a+=1),n&&l&&(null===l.value||void 0===l.value)&&(l.value=e(...arguments)),null===(o=l)||void 0===o?void 0:o.value}}function i(e){var t;return null===e||void 0===e?r:"object"===typeof e||"function"===typeof e?e:(a[e]||(a[e]={val:e}),null!==(t=a[e])&&void 0!==t?t:{val:e})}function s(){return{map:o?new o:null}}},28553:(e,t,n)=>{"use strict";n.d(t,{P:()=>l});var r=n(56851),a=n(65043),o=n(44828),l=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRendered:void 0===(0,o.z)()},n}return(0,r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout(function(){e.setState({isRendered:!0})},t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?a.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(a.Component)},33268:(e,t,n)=>{"use strict";n.d(t,{XY:()=>P,lo:()=>v,sN:()=>S,wS:()=>f});var r=n(38752),a=n(8453),o=n(72761),l=n(40468),i=n(12358),s=n.n(i),c=n(54320),d=n.n(c),p=n(74844),u=n(74065),m=n.n(u),h=n(85855),g=n.n(h);class f{static getFavIconUrl(e){return"https://"+f.extractHostname(e)+"/favicon.ico"}static generateEntityHyperlink(e,t,n,r){switch(e.entityType){case o.I.Task:return this.generateTaskHyperLink(e,t,n,r);case o.I.Plan:return this.generatePlanHyperLink(e,t,n,r);default:throw new Error("NotSupportedException: entity.type")}}static generateEntityLink(e,t,n,r){switch(e.entityType){case o.I.Task:return this.generateTaskLink(e,t,n,r);case o.I.Plan:return this.generatePlanLink(e,t,n,r);default:throw new Error("NotSupportedException: entity.type")}}static generateOWAGroupEmailSettingsLink(e,t,n){if(d()(e))return n.logTrace(508047762,p.k.Warning,"Empty owa host. Hiding the whole owa link."),"";if(d()(t)||t.indexOf("@")<0||t.indexOf("@")!==t.lastIndexOf("@"))return"https://".concat(e);{const n=t.split("@")[0],r=t.split("@")[1];return"https://".concat(e,"/mail/group/").concat(r,"/").concat(n,"/action/EmailSettings")}}static extractHostname(e){let t="";return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0],t=t.split("?")[0],t=t.split("#")[0],t}static getPlanExternalUrl(e,t){var n;const r=null===(n=l.T.builder.withPlan(e).withDetails(t).build().getCreationContextInfo())||void 0===n?void 0:n.key;let a=null;var o;r&&(a=null!==(o=t.contextDetails[r].url)&&void 0!==o?o:null);return a}static generateTaskHyperLink(e,t,n,r){return'<a href="'+this.generateTaskLink(e,t,n,r)+'" target="_blank" rel="noopener noreferrer">'+s()(e.title)+"</a>"}static generatePlanHyperLink(e,t,n,r){return'<a href="'+this.generatePlanLink(e,t,n,r)+'" target="_blank" rel="noopener noreferrer">'+s()(e.title)+"</a>"}static generateTaskLink(e,t,n,o){var l,i,s;return(null===(l=e.creationSource.external)||void 0===l?void 0:l.contextScenarioId)===a.z.project&&null!==(i=e.creationSource.external)&&void 0!==i&&i.webUrl?null===(s=e.creationSource.external)||void 0===s?void 0:s.webUrl:this.generatePlannerLink("".concat(r.B.absoluteRedirectRoot,"/Home/Task/").concat(e.id),t,n,o)}static generatePlanLink(e,t,n,a){return this.generatePlannerLink("".concat(r.B.absoluteRedirectRoot,"/Home/PlanViews/").concat(e.id),t,n,a)}static generatePlannerLink(e,t,n,r){const a=621355968e9+1e4*r.getTime();return"".concat(e,"?Type=").concat(t,"&Channel=").concat(n,"&CreatedTime=").concat(a)}static getValidUrl(e){const t=f.formatUrlWithHttpUrlScheme(e);return f.validateUrl(t)}static formatUrlWithHttpUrlScheme(e){return f.getUrlScheme(e).toLowerCase()===f.httpScheme?f.ensureUrlScheme(e,f.httpScheme):f.ensureUrlScheme(e,f.httpsScheme)}static validateUrl(e){try{const t=new URL(e);if(!t.host||!t.hostname||!t.origin||"null"===t.origin||"http:"!==t.protocol&&"https:"!==t.protocol)return;return t.toString()}catch(t){return}}static getUrlScheme(e){const t=new RegExp("(.*)://.*","i").exec(e)||[];return m()(t)||""}static ensureUrlScheme(e,t){const n=t&&g()(t.split("://"));return"".concat(n,"://").concat(f.removeUrlScheme(e))}static removeUrlScheme(e){const t=new RegExp("(http(s)?(:)?(//)?)*(.*)","i").exec(e)||[];return m()(t)||""}static getQueryParamValue(e,t){return new URLSearchParams(new URL(e).search).get(t)}}function v(e){return"".concat(b(),"hubnew?importPlanId=").concat(e)}function P(){return"".concat(r.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname,"trialFRE#templates")}function S(){return"".concat(r.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname,"trialFRE#templates/{0}")}function b(){return"".concat(r.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname).concat(r.B.tenantDomain,"/").concat(r.B.culture,"#/")}f.httpScheme="http",f.httpsScheme="https"},40488:(e,t,n)=>{"use strict";n.d(t,{y:()=>f});var r=n(65804),a=n(56851),o=n(65043),l=n(57433),i=n(89379),s=n(17066),c=n(28553),d=(0,i.Z)(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.type,n=e.size,r=e.ariaLabel,i=e.ariaLive,p=e.styles,u=e.label,m=e.theme,h=e.className,g=e.labelPosition,f=r,v=(0,s.G1)(this.props,s.JM,["size"]),P=n;void 0===P&&void 0!==t&&(P=t===l.Q.large?l.H.large:l.H.medium);var S=d(p,{theme:m,size:P,className:h,labelPosition:g});return o.createElement("div",(0,a.__assign)({},v,{className:S.root}),o.createElement("div",{className:S.circle}),u&&o.createElement("div",{className:S.label},u),f&&o.createElement("div",{role:"status","aria-live":i},o.createElement(c.P,null,o.createElement("div",{className:S.screenReaderText},f))))},t.defaultProps={size:l.H.medium,ariaLive:"polite",labelPosition:"bottom"},t}(o.Component),u=n(52195),m=n(66783),h={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},g=(0,m.J9)(function(){return(0,u.i7)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}})}),f=(0,r.I)(p,function(e){var t,n=e.theme,r=e.size,o=e.className,i=e.labelPosition,s=n.palette,c=(0,u.Km)(h,n);return{root:[c.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===i&&{flexDirection:"column-reverse"},"right"===i&&{flexDirection:"row"},"left"===i&&{flexDirection:"row-reverse"},o],circle:[c.circle,{boxSizing:"border-box",borderRadius:"50%",borderWidth:"1.5px",borderStyle:"solid",borderTopColor:s.themePrimary,borderRightColor:s.themeLight,borderBottomColor:s.themeLight,borderLeftColor:s.themeLight,animationName:g(),animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[u.up]=(0,a.__assign)({borderTopColor:"Highlight"},(0,u.Qg)()),t)},r===l.H.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],r===l.H.small&&["ms-Spinner--small",{width:16,height:16}],r===l.H.medium&&["ms-Spinner--medium",{width:20,height:20}],r===l.H.large&&["ms-Spinner--large",{width:28,height:28}]],label:[c.label,n.fonts.small,{color:s.themePrimary,margin:"8px 0 0",textAlign:"center"},"top"===i&&{margin:"0 0 8px"},"right"===i&&{margin:"0 0 0 8px"},"left"===i&&{margin:"0 8px 0 0"}],screenReaderText:u.dX}},void 0,{scope:"Spinner"})},57433:(e,t,n)=>{"use strict";var r,a;n.d(t,{H:()=>r,Q:()=>a}),function(e){e[e.xSmall=0]="xSmall",e[e.small=1]="small",e[e.medium=2]="medium",e[e.large=3]="large"}(r||(r={})),function(e){e[e.normal=0]="normal",e[e.large=1]="large"}(a||(a={}))},72037:e=>{e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},85855:(e,t,n)=>{e.exports=n(96483)},87070:(e,t,n)=>{"use strict";function r(e){this.message=e}n.d(t,{A:()=>i}),r.prototype=new Error,r.prototype.name="InvalidCharacterError";var a="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,a,o=0,l=0,i="";a=t.charAt(l++);~a&&(n=o%4?64*n+a:a,o++%4)?i+=String.fromCharCode(255&n>>(-2*o&6)):0)a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a);return i};function o(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(a(e).replace(/(.)/g,function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}(t)}catch(e){return a(t)}}function l(e){this.message=e}l.prototype=new Error,l.prototype.name="InvalidTokenError";const i=function(e,t){if("string"!=typeof e)throw new l("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(o(e.split(".")[n]))}catch(e){throw new l("Invalid token specified: "+e.message)}}},91900:(e,t,n)=>{"use strict";n.d(t,{n:()=>d});var r=n(65043),a=n(16112),o=n(22317),l=n(66783),i=n(52195);const s=(0,l.J9)(()=>({anchor:{minHeight:"1px"}})),c=(0,l.J9)(e=>({anchor:(0,i.Zq)("virtualContainer-anchor",e.anchor)}));class d extends a.${componentDidUpdate(e,t){e.containerId!==this.props.containerId&&this.setState({hasLoaded:!1})}renderComponent(){return r.createElement(r.Fragment,null,this.renderIntersectionObs(),this.props.children)}renderIntersectionObs(){const e=this.getClassNames();return r.createElement("div",{className:"virtualContainer-wrapper"},r.createElement(o.pL,{onChange:this.handleInView,triggerOnce:!0},r.createElement("div",{className:e.anchor})))}getClassNames(){return c(s())}constructor(e,t){super(e,t),this.name=()=>"VirtualContainer",this.handleInView=e=>{!this.state.hasLoaded&&e&&(this.props.onLoad(),this.setState({hasLoaded:!0}))},this.state={hasLoaded:!1}}}},95694:(e,t,n)=>{var r=n(72037)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=r},96483:e=>{e.exports=function(e){return e&&e.length?e[0]:void 0}},99788:(e,t,n)=>{"use strict";n.r(t),n.d(t,{PlannerInsertionComponent:()=>Me,loopExport:()=>_e});var r=n(38954),a=n(70579),o=n(97950),l=n(27051),i=n(65043),s=n(81540),c=n(28184),d=n(96623),p=n(67239),u=n(7509),m=n(3683),h=n(85849),g=n(44535),f=n(36060),v=n(27678);const P=e=>{const{getPlanImage:t,planName:n,className:r}=e,[a,o]=i.useState(null);let l;if(i.useEffect(()=>{t().then(e=>{o(e)})},[t]),null!=a)l=i.createElement("img",{src:a,alt:""});else{const e=g.$.parseInitialsFromName(n),t=(0,f.K)((0,v.wV)(n));l=i.createElement("span",{className:t},e)}return i.createElement("div",{className:r},l)};var S=n(91900),b=n(56415),k=n(93),y=n(66151),I=n(72943);var C=n(89379),w=n(65804);const E=(0,C.Z)(),x=(0,w.I)(e=>{let{fetchPlanData:t,getPlanImage:n,item:r,styles:a,theme:o}=e;const l=E(a,{theme:o}),[s,c]=i.useState(!1),d=i.useCallback(()=>{t(r.planId).then(()=>{c(!0)})},[r.planId,t]);return i.createElement(S.n,{containerId:r.planId,onLoad:d},s&&i.createElement("div",{className:l.root},i.createElement(P,{className:l.icon,getPlanImage:()=>n(r.planId),planName:r.planName}),i.createElement("span",null,r.planName)))},e=>{let{theme:t}=e;return{root:["planItem",(0,y.gS)(),(0,y.aS)(t),{display:"flex",alignItems:"center",cursor:"pointer"}],icon:["planIcon",(0,y.gS)(),{"> *":[{width:"20px",height:"20px",padding:"1px",borderRadius:"4px",textAlign:"center",color:b.z.White},(0,I.Al)({color:k.B.WindowText})],paddingRight:"10px"}]}});var L=n(50724),N=n(45099),U=n(77508),D=n(66783),R=n(52195);const T=(0,D.J9)(e=>({root:[(0,y.Ss)(e),{height:"200px"}],headerWrapper:{".ms-DetailsHeader":(0,y.fe)(e)}})),M=(0,D.J9)(e=>({root:{":hover":{background:"inherit"}},check:{display:"none"},title:[(0,y.aS)(e),{cursor:"auto"}],expand:[(0,y.aS)(e),{cursor:"pointer",":hover, :active, :focus":{background:"inherit"}}],headerCount:{display:"none"}})),_=(0,D.J9)(e=>({root:[{background:"inherit","&.is-selected":[H(e),(0,I.hS)(),{".is-row-header":{fontWeight:R.BO.regular},".planItem":(0,I.h8)(),":hover, :focus":[(0,I.hS)(),{".planItem":(0,I.h8)(),".planIcon > span":(0,I.kE)()}]}],":hover":{".planItem":(0,I.c3)(),".planIcon > span":(0,I.kE)()},".planIcon > span":(0,I.kE)()},W(e)]})),W=(0,D.J9)(e=>{let t;switch(e){case U.Sx.LoopLight:t={":hover, :focus":{backgroundColor:b.z.NeutralLighterAlt,color:b.z.NeutralPrimaryAlt}};break;case U.Sx.LoopDark:t={":hover, :focus":{backgroundColor:b.z.NeutralDarkGrey12,color:b.z.NeutralDarkGrey84}}}return t}),H=(0,D.J9)(e=>{let t;switch(e){case U.Sx.LoopLight:t={backgroundColor:b.z.LoopLightInsertPlanModalSelectedColor,color:b.z.NeutralPrimaryAlt,":focus, :hover":{backgroundColor:b.z.LoopLightInsertPlanModalSelectedColor,color:b.z.NeutralPrimaryAlt}};break;case U.Sx.LoopDark:t={backgroundColor:b.z.LoopDarkInsertPlanModalSelectedColor,color:b.z.NeutralPrimaryAlt,":focus, :hover":{backgroundColor:b.z.LoopDarkInsertPlanModalSelectedColor,color:b.z.NeutralPrimaryAlt}}}return t}),z=e=>{const{rowProps:t,onClickPlanItem:n,theme:r}=e,a=t.item,o=i.useCallback(e=>{e.keyCode!==L.D.ENTER&&e.keyCode!==L.D.SPACE||n(a.planId)},[n,a]);return i.createElement("div",{className:"planItemRow",onClick:()=>n(a.planId),onKeyDown:o},i.createElement(N.h,(0,l.A)((0,l.A)({},t),{},{styles:_(r)})))};var O=n(59846),A=n(35375),j=n(87797),B=n(86053);const Y=e=>({key:"plans",name:B.p.Strings.LoopInsertPlanModal_PlansListTitle,minWidth:200,maxWidth:200,isRowHeader:!0,isCollapsible:!1,onRender:e}),F=(e,t)=>{const n=e?Object.keys(e.references).length:0,r=t?Object.keys(t.references).length:0,a=[];if(n>0){const e={key:"pinnedGroup",name:B.p.Strings.LoopInsertPlanModal_PinnedPlansTitle,startIndex:0,count:n};a.push(e)}if(r>0){const e={key:"recentGroup",name:B.p.Strings.LoopInsertPlanModal_RecentPlansTitle,startIndex:n,count:r,isCollapsed:n>0};a.push(e)}return a};function V(e){let{onClickPlanItem:t,fetchPlanData:n,getPlanImage:r,pinnedPlans:a,recentPlans:o,theme:l}=e;const[s,c]=(0,i.useState)(F(a,o)),d=(0,i.useCallback)(e=>i.createElement(z,{rowProps:e,onClickPlanItem:t,theme:l}),[t,l]),p=(0,i.useCallback)(e=>e.planId,[]),g={headerProps:{styles:M(l),expandButtonIcon:O.rK.iconName}},f=i.useMemo(()=>((e,t)=>null==e&&null==t?[]:[...null==e?[]:Object.keys(e.references).map(t=>({planId:t,planName:e.references[t].title})).sort((t,n)=>A.j.CompareByAlpha(e.references[t.planId],e.references[n.planId])),...null==t?[]:Object.keys(t.references).filter(t=>!e||!(t in e.references)).map(e=>({planId:e,planName:t.references[e].title,lastAccessDate:t.references[e].lastAccess})).sort((e,n)=>j.S.CompareByDateAndAlpha(t.references[e.planId],t.references[n.planId]))])(a,o),[a,o]);return(0,i.useEffect)(()=>{c(e=>{const t=F(a,o);return t.forEach(t=>{const n=e.find(e=>e.key===t.key);n&&(t.isCollapsed=n.isCollapsed)}),t})},[a,o]),i.createElement(u.R,{viewport:{height:200,width:400},getKey:p,setKey:"set",items:f,groups:s,columns:[Y(e=>i.createElement(x,{item:e,fetchPlanData:n,getPlanImage:r,theme:l}))],groupProps:g,onRenderDetailsHeader:()=>null,onRenderRow:d,compact:!0,selectionMode:m.Qc.single,checkboxVisibility:h.GY.hidden,selectionPreservedOnEmptyClick:!0,styles:T(l)})}var J=n(9442);const G=(0,D.J9)(e=>{let{theme:t}=e;return{header:["loopInsertPlanHeader",(0,y.gS)(),(0,y.aS)(t),{justifyContent:"space-between"}],body:["loopInsertPlanBody",(0,y.gS)("column"),{padding:"2px"}],footer:["loopInsertPlanFooter",(0,y.gS)(),{justifyContent:"flex-end"}],titleSection:["titleSection",(0,y.gS)(),{".plannerLogo":{width:"25px",height:"25px",marginRight:"15px"},".title":{fontSize:"20px",fontWeight:"600",fontFamily:"Segoe UI"}}],infoSection:["infoSection",(0,y.gS)("column"),(0,y.Ml)(t)],planSecurityInfoSection:["planSecurityInfoSection",(0,y.gS)(),{padding:"20px 5px","> i":{paddingRight:"10px"}}],createNewPlanInfoSection:["createNewPlanInfoSection",{paddingBottom:"20px"}]}}),K=(0,D.J9)(e=>({main:[(0,y.Ph)(e),{height:"500px",width:"560px",borderRadius:"12px",padding:"30px",display:"flex"}],scrollableContent:[(0,y.gS)("column"),{justifyContent:"space-between"}]})),Z=(0,D.J9)(e=>({root:[(0,y._D)(e),(0,I.c3)(),{cursor:"pointer",textDecoration:"underline",":hover, :focus":[(0,y._D)(e),(0,I.c3)(),{textDecoration:"underline"}]}]})),Q={root:{width:140,borderRadius:6,paddingTop:10,paddingBottom:10,fontSize:14,fontWeight:600,cursor:"pointer"},rootHovered:[{backgroundColor:"inherit"},I.lZ],rootPressed:[{backgroundColor:"inherit"},I.lZ],labelHovered:(0,I.h8)()},$=(0,D.J9)(e=>{const t={root:[{margin:"0 15px",border:"none","&:not(.is-disabled)":[ee(e),(0,I.ji)(),(0,I.kE)(),{cursor:"pointer"}]},(0,I.kE)()],rootDisabled:[q(e),(0,I.kE)()],rootHovered:[ee(e),{border:"none"}],rootPressed:[ee(e),{border:"none"}]};return(0,R.TW)(Q,t)}),X=(0,D.J9)(e=>{const t={root:[(0,y.i9)(e),{marginRight:"16px",":hover":{span:(0,y.aS)(e)}}],rootHovered:{span:(0,y.aS)(e)}};return(0,R.TW)(Q,t)}),q=(0,D.J9)(e=>{let t;switch(e){case U.Sx.LoopLight:t={backgroundColor:b.z.NeutralLightGrey94,color:b.z.NeutralDarkGrey40};break;case U.Sx.LoopDark:t={backgroundColor:b.z.NeutralDarkGrey8,color:b.z.NeutralDarkGrey36}}return t}),ee=(0,D.J9)(e=>{let t;switch(e){case U.Sx.LoopLight:t={backgroundColor:b.z.LoopBrand80,color:b.z.White};break;case U.Sx.LoopDark:t={backgroundColor:b.z.LoopBrand70,color:b.z.White}}return t});var te=n(33268),ne=n(80493);const re=e=>{let{createNewPlanInfoString:t,plannerWebUrl:n,onClickPlannerWebUrlLink:r,className:a,theme:o}=e;const l=i.useCallback(()=>{r(),ne.b.safelyOpenExternalUrl(n)},[n,r]),s=t.split("{0}");return 2!==s.length?null:i.createElement("span",{className:a},s[0],i.createElement(J.N,{href:n,onClick:l,styles:Z(o),target:"_blank",rel:"noopener noreferrer"},te.wS.removeUrlScheme(n)||"tasks.office.com"),s[1])};const ae=n.p+"static/media/planner2.8e27f89bc2da530d3b02140677f5ae78.svg";var oe=n(20751),le=n(46441),ie=n(63485),se=n(11638);const ce=(0,C.Z)(),de=(0,w.I)(e=>{let{pinnedPlans:t,recentPlans:n,plannerWebUrl:r,onClickPlannerWebUrlLink:a,fetchPlanData:o,getPlanImage:s,handleInsertPlan:c,onDismiss:d,modalProps:u,styles:m,theme:h}=e;const g=ce(m,{theme:h}),[f,v]=i.useState(null),P=i.useCallback(()=>{null!=f&&c(f)},[c,f]),S=i.useCallback(e=>{v(e)},[]);return i.createElement(le.a,(0,l.A)((0,l.A)({},u),{},{styles:K(h)}),i.createElement("div",{className:g.header},i.createElement("div",{className:g.titleSection,role:"heading","aria-level":1},i.createElement("img",{className:"plannerLogo",src:ae,role:"presentation"}),i.createElement("div",{className:"title"},B.p.Strings.LoopInsertPlanModal_ModalTitle)),i.createElement(p.K,{iconProps:O.s5,onClick:d,plannerTheme:h,ariaLabel:B.p.Strings.LoopInsertPlanModal_CloseButtonAriaLabel})),i.createElement("div",{className:g.body},i.createElement(V,{pinnedPlans:t,recentPlans:n,onClickPlanItem:S,fetchPlanData:o,getPlanImage:s,theme:h})),i.createElement("div",{className:g.infoSection},i.createElement("div",{className:g.planSecurityInfoSection},i.createElement(oe.I,O.I6),B.p.Strings.LoopInsertPlanModal_PlanSecurityInfo),i.createElement(re,{createNewPlanInfoString:B.p.Strings.LoopInsertPlanModal_CreateNewPlanInfo,className:g.createNewPlanInfoSection,plannerWebUrl:r,onClickPlannerWebUrlLink:a,theme:h})),i.createElement("div",{className:g.footer},i.createElement(ie.j,{onClick:P,disabled:null==f,styles:$(h)},B.p.Strings.LoopInsertPlanModal_InsertButton),i.createElement(se.Y,{onClick:d,styles:X(h)},B.p.Strings.LoopInsertPlanModal_CancelButton)))},G);var pe=n(7811);const ue=n.p+"static/media/loop-insert-plan-error.ebfdd5c45a1eb6916c23.webp",me=n.p+"static/media/loop-insert-plan-no-plans.103217b5d81879ad1cfd.webp",he=(0,D.J9)(e=>{let{theme:t}=e;return{header:["header",(0,y.gS)(),(0,y.aS)(t),{justifyContent:"space-between"}],body:["loopInsertPlanBody",(0,y.gS)("column")],footer:["loopInsertPlanFooter",(0,y.gS)(),{justifyContent:"flex-end"}],title:["title",{fontSize:"20px",fontWeight:"600",fontFamily:"Segoe UI"}],message:["message",(0,y.Ml)(t),{textAlign:"center"}],image:["image",{width:"230px",height:"230px",alignSelf:"center",marginTop:"-20px",marginBottom:"20px"}]}}),ge=(0,C.Z)(),fe=(0,w.I)(e=>{let{error:t,plannerWebUrl:n,onClickPlannerWebUrlLink:r,onDismiss:a,onRetry:o,styles:s,theme:c,modalProps:d}=e;const u=ge(s,{theme:c}),m=be(t);return i.createElement(le.a,(0,l.A)((0,l.A)({},d),{},{styles:K(c)}),i.createElement("div",{className:u.header},i.createElement("div",{className:u.title},ve(t)),i.createElement(p.K,{iconProps:O.s5,onClick:a,plannerTheme:c,ariaLabel:B.p.Strings.LoopInsertPlanModal_CloseButtonAriaLabel})),i.createElement("div",{className:u.body},i.createElement("img",{className:u.image,src:Se(t),role:"presentation"}),(()=>{const e=Pe(t);return t===pe.Yh.NoPlans?i.createElement(re,{createNewPlanInfoString:e,className:u.message,plannerWebUrl:n,onClickPlannerWebUrlLink:r,theme:c}):i.createElement("div",{className:u.message},e)})()),i.createElement("div",{className:u.footer},m&&i.createElement(ie.j,{onClick:o,styles:$(c)},B.p.Strings.LoopInsertPlanErrorModal_RetryButton),i.createElement(se.Y,{onClick:a,styles:X(c)},m?B.p.Strings.LoopInsertPlanModal_CancelButton:B.p.Strings.LoopInsertPlanErrorModal_OkayButton)))},he),ve=e=>{switch(e){case pe.Yh.PlannerServiceDisabled:return B.p.Strings.LoopInsertPlanErrorModal_ErrorTitle_PlannerDisabled;case pe.Yh.NoPlans:return B.p.Strings.LoopInsertPlanErrorModal_ErrorTitle_NoPlans;case pe.Yh.Unknown:default:return B.p.Strings.LoopInsertPlanErrorModal_ErrorTitle_UnexpectedError}},Pe=e=>{switch(e){case pe.Yh.PlannerServiceDisabled:return B.p.Strings.LoopInsertPlanErrorModal_ErrorMessage_PlannerDisabled;case pe.Yh.NoPlans:return B.p.Strings.LoopInsertPlanErrorModal_ErrorMessage_NoPlans;case pe.Yh.Unknown:default:return B.p.Strings.LoopInsertPlanErrorModal_ErrorMessage_UnexpectedError}},Se=e=>{switch(e){case pe.Yh.NoPlans:return me;case pe.Yh.PlannerServiceDisabled:case pe.Yh.Unknown:default:return ue}},be=e=>{switch(e){case pe.Yh.PlannerServiceDisabled:case pe.Yh.NoPlans:return!1;case pe.Yh.Unknown:default:return!0}};var ke=n(52956),ye=n(59498),Ie=n(47373),Ce=n(59190),we=n(89404),Ee=n(16822);const xe=e=>{let{dependencies:t,resolvePlanUrl:n,theme:r,onModalInteractive:o}=e;const[p,u]=i.useState(!0),[m,h]=i.useState(null),[g,f]=i.useState(null),[v,P]=i.useState(null),{logger:S}=t,b=i.useRef(!1),k=i.useCallback(e=>{b.current||(b.current=!0,o(e))},[o]),y=i.useRef({}),I=i.useRef({}),C=i.useMemo(()=>{var e;return(0,d.Vf)(t.tokenProvider,t.userContext,null===(e=t.settingsProvider)||void 0===e?void 0:e.audience)},[t]),w=e=>{e.name===ye.Hg.PlannerServiceBlockedError?P(pe.Yh.PlannerServiceDisabled):P(pe.Yh.Unknown)},E=i.useCallback(()=>{(0,d.zI)(C,S).then(e=>{let[t,n]=e;0===Object.keys(t.references).length&&0===Object.keys(n.references).length&&((0,Ie.Ot)(S,{eventName:Ce.Fc.UsersHaveNoPlans}),P(pe.Yh.NoPlans)),h(t),f(n)}).catch(e=>{(0,Ie.hO)(S,{eventName:Ce.nb.GetPinnedAndRecentPlansFailed},e),w(e)})},[C,S]),x=i.useCallback(()=>{u(!1),n(void 0)},[n]),L=i.useMemo(()=>({isOpen:p}),[p]),N=i.useCallback(async e=>{try{let t=y.current[e];null==t&&(t=await(0,d.nT)(e,C,S),k(),((e,t)=>{y.current[e]=t})(e,t));const n=t.plan.container.externalId;let r=I.current[n];null==r&&(r=(0,ke.R)(t.plan,t.planDetails,C,S),((e,t)=>{I.current[e]=t})(n,r))}catch(v){const n=null!=(null===m||void 0===m?void 0:m.references[e]),r=null!=(null===g||void 0===g?void 0:g.references[e]);n&&h(t=>t?t.removePlanReference(e):t),r&&f(t=>t?t.removePlanReference(e):t);!(v instanceof we.p||v instanceof Ee.N)&&(0,Ie.hO)(S,{eventName:Ce.nb.FetchPlanDataFailed},v)}},[C,S,k,m,g]),U=i.useCallback(async e=>{var t;const n=y.current[e];if(null==n)return null;const r=n.plan.container.externalId;return null!==(t=I.current[r])&&void 0!==t?t:null},[]),D=i.useCallback(()=>{(0,Ie.Ot)(S,{eventName:Ce.Fc.PlannerWebUrlLinkClicked,eventSource:Ce.my.InsertionModal})},[S]),R=i.useCallback(()=>{(0,Ie.Ot)(S,{eventName:Ce.Fc.PlannerWebUrlLinkClicked,eventSource:Ce.my.ErrorModal})},[S]),T=i.useCallback(e=>{const t=t=>{const r=t.plan.container.externalId,a=C.tenantId,o=(0,c.TX)(r,e,a,C.audience);n(o),(0,Ie.Ot)(S,{eventName:Ce.Fc.PlanInserted})},r=y.current[e];null==r?(0,d.nT)(e,C,S).then(e=>{t(e)}).catch(e=>{w(e)}):t(r)},[n,C,S]),M=i.useCallback(()=>{P(null),E()},[E]),{modalAttributes:_}=(0,s.y)({trapFocus:!0});return i.useEffect(()=>{E()},[E]),i.useEffect(()=>{null!=v&&(v===pe.Yh.NoPlans||v===pe.Yh.PlannerServiceDisabled?k():k(new Error(v)))},[v,k]),i.useEffect(()=>{m&&g&&0===Object.keys(m.references).length&&0===Object.keys(g.references).length&&P(pe.Yh.NoPlans)},[m,g]),(0,a.jsx)("div",(0,l.A)((0,l.A)({},_),{},{children:v?(0,a.jsx)(fe,{error:v,plannerWebUrl:(0,c.P$)(C.audience),onClickPlannerWebUrlLink:R,onDismiss:x,onRetry:M,modalProps:L,theme:r}):(0,a.jsx)(de,{pinnedPlans:m,recentPlans:g,handleInsertPlan:T,fetchPlanData:N,getPlanImage:U,plannerWebUrl:(0,c.P$)(C.audience),onClickPlannerWebUrlLink:D,onDismiss:x,modalProps:L,theme:r})}))};var Le=n(52668);class Ne{constructor(e,t,n){this.dependencies=e,this.resolvePlanUrl=t,this.onViewRenderReady=n,this.getPlannerTheme=()=>{var e;return(null===(e=this.dependencies.stylingProvider.themeProperties)||void 0===e?void 0:e.get(Le.e))===Le.L?U.Sx.LoopDark:U.Sx.LoopLight}}get HTMLView(){return this}async dispose(){this.element&&(o.unmountComponentAtNode(this.element),delete this.element)}async render(e){this.element=e;const t=(0,a.jsx)(xe,{dependencies:this.dependencies,resolvePlanUrl:this.resolvePlanUrl,theme:this.getPlannerTheme(),onModalInteractive:this.onViewRenderReady});o.render(t,e)}}var Ue=n(33788),De=n(83125),Re=n(68639),Te=n(52059);class Me{constructor(e,t){this.providers=t,this.planUrlPromise=new Promise(e=>{this.resolvePlanUrl=e})}get ComponentInitializer(){return this}async initialize(){this.dependencies=await this.getDependenciesPromise()}get HTMLViewable(){return this}async getView(){if(!this.dependencies)throw new Error("Expected dependencies to be defined, got undefined");(0,Ie.Ot)(this.dependencies.logger,{eventName:Ce.Fc.DiscoveryMenuPlannerClicked});const e=Ue.m.start(Ce.Hl.RenderPlannerInsertionView,this.dependencies.logger,{isAPerformanceMetric:!0});return new Ne(this.dependencies,this.resolvePlanUrl,t=>{t?e.setResult(!1,{message:"ErrorInRenderPlannerInsertionView"},t):e.setResult(!0)})}get entityName(){return Ce.Dg}get ComponentTelemetryMetadata(){return this}get LoopComponentUrl(){return this}async getLoopComponentUrl(){return await this.planUrlPromise}async getDependenciesPromise(){var e;const t=this.providers;if(!t)throw new Error("Expected providers to be defined, got undefined");const[n,r,a,o,l]=await Promise.all([t.TokenProvider,t.UserContext,t.StylingProvider,t.SettingsProvider,t.NamespaceLogger]);if(!n)throw Error("Missing Token Providers");if(!a)throw Error("Missing Styling Provider");if(!l)throw Error("Missing Namespace Logger");const i=null!==(e=null===o||void 0===o?void 0:o.audience)&&void 0!==e?e:Te.CS;return{tokenProvider:n,userContext:{tenantId:await(0,Re.E)(n,r,i)},settingsProvider:o,stylingProvider:a,logger:new De.p(Ce.Dg,l)}}}const _e=new r.p(Me,{TokenProvider:"TokenProvider",UserContext:"UserContext",StylingProvider:"StylingProvider",SettingsProvider:"SettingsProvider",NamespaceLogger:"NamespaceLogger"})}}]);
//# sourceMappingURL=46867.b8e50248.chunk.js.map