"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[82368],{80730:(e,t,r)=>{r.r(t),r.d(t,{StreamEmbeddedRenderer:()=>lt});var n=r(27051),i=r(70579),o=r(65043);var a=r(91730),s=r(80194),l=r(12851),c=r(56090),d=r(58370),u=r(85540),p=r(80220),h=r(28679),m=r(12910);const f="playerInteractiveTimestamp";function v(){return{setIsReady(e,t,r){const n=t.playerInteractiveTimestamp;if(n){const t=n.timestamp,i=n.timeOrigin,o=performance.timeOrigin,a=Math.abs(r-o),s=Math.round(e.startTime-a),l=t+i-r;e.setResult(!0,{timeDrift:Math.round(a),hostTimeOrigin:o,hostVariableTimeOrigin:r,activityStartTimeWithDrift:s,[f]:Math.round(t),playerInteractiveTimestamp_timeOrigin:Math.round(i),playerInteractiveTimestamp_currentTimeScale:Math.round(l),activityStartTimeMs_performanceNow:Math.round(e.startTime),unfurlDurationMs_performanceNow:Math.round(l-e.startTime)})}}}}const y=[" ","Enter"],b=[...y,"Tab"];function g(e){return"warmData"in e}function _(e){return"simulateClick"in e}var w=r(82500);function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.z.VideoLoadFromUnfurl;return e.activities.get(t)}var P=r(73646),S=r(20723),T=r(27200),I=r(29018);var A=function(){function e(e,t,r,n,i,o,a,s){this.level=e,this.isExpected=t,this.scenario=r,this.knownError=n,this.originalError=i,this.message=o,this.playbackSessionId=a,this.hostSessionId=s}return e.createKnownError=function(t,r,n,i,o,a,s,l){return new e(t,r,n,i,o,a,s,l)},e.createGenericError=function(t,r,n,i,o,a,s){var l=!1;if(void 0!==(null===i||void 0===i?void 0:i.isExpected))l=i.isExpected,o=i.errorName;else if(i&&i.message){var c=function(e){return"'ResizeObserver' is undefined"===e||"'ResizeObserver' is not defined"===e||"ResizeObserver is not defined"===e||"Can't find variable: ResizeObserver"===e||"'IntersectionObserver' is undefined"===e||"IntersectionObserver is not defined"===e||"Can't find variable: IntersectionObserver"===e||"'PerformanceObserver' is undefined"===e||"'PerformanceObserver' is not defined"===e||"function is not a constructor (evaluating 'new EventTarget')"===e||"<safe>Unsupported browser</safe>"===e||!(!e||!e.includes("setstrings"))||!(!e||!e.includes("URL is not supported"))||"e.addEventListener is not a function. (In 'e.addEventListener(\"change\",m)', 'e.addEventListener' is undefined)"===e||"Object doesn't support property or method 'addEventListener'"===e||"Performance timeOrigin is not supported"===e}(i.message);c&&(l=!0)}return e.createKnownError(t,l,r,n,i,o,a,s)},e}(),E=r(56851),U=function(e){this.willBeUnregistered=!1,this.unregisterOnNextCall=!1,this.callback=e},C=function(){function e(e){this._observers=new Array,this.onCallbackError=e}return e.prototype.subscribe=function(e,t){if(void 0===t&&(t={}),!e)return function(){};var r=new U(e);return r.unregisterOnNextCall=!!t.unregisterOnFirstCall,this._observers.push(r),this.internalRemove.bind(this,r)},e.prototype.notify=function(e){for(var t=0,r=this._observers;t<r.length;t++){var n=r[t];if(!n.willBeUnregistered){try{n.callback(e)}catch(i){this.onCallbackError&&this.onCallbackError(i)}n.unregisterOnNextCall&&this.deferUnregister(n)}}},e.prototype.unsubscribeAll=function(){this._observers.length=0},e.prototype.deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e.willBeUnregistered=!0,setTimeout(function(){t.internalRemove(e)},0)},e.prototype.internalRemove=function(e){var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e}(),O=function(){function e(e,t){this._observable=new C(t),this._value=e,this.onCallbackError=t}return e.prototype.unsubscribeAll=function(){this._observable.unsubscribeAll()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){e!==this._value&&(this._value=e,this._observable.notify(e))},enumerable:!1,configurable:!0}),e.prototype.subscribe=function(e,t){var r=!(null===t||void 0===t?void 0:t.ignoreCurrentValue);if(r)try{e(this._value)}catch(n){this.onCallbackError&&this.onCallbackError(n)}return(null===t||void 0===t?void 0:t.unregisterOnFirstCall)&&r?function(){}:this._observable.subscribe(e,t)},e}(),R=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}();function M(e){return"function"===typeof e.dispose}function x(e,t){var r=e,n=r.dispose,i="function"===typeof n&&n.disposalChain||function(e){var t=new R(e),r=e.dispose,n=function(){t.dispose(),r&&(e.dispose=r,e.dispose())};return e.dispose=n,n.disposalChain=t,t}(r);return i.addCallback(t),r}var D=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,r="".concat(++this._lastDisposableId),n=x(e,function(){delete t._disposables[r]});return this._disposables[r]=n,n},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,r=Object.keys(e);t<r.length;t++){var n=r[t],i=e[n];i&&M(i)&&i.dispose(),delete e[n]}},e}(),N=function(){function e(e){this._scope=new D,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,r){var n;if(V(e))n=e;else{var i=this._targetMap.get(e);i?n=i:(n=new EventTarget,this._targetMap.set(e,n))}n.addEventListener(t,r);var o=this._disposableMap.get(e);o||(o=new Map,this._disposableMap.set(e,o));var a=this._scope.attach({dispose:function(){n.removeEventListener(t,r)}});o.set(t,a)},e.prototype.off=function(e,t,r){var n;if(V(e))n=e;else{var i=this._targetMap.get(e);i&&(n=i)}var o=this._disposableMap.get(e);if(o){var a=o.get(t);a&&(a.dispose(),o.delete(t)),0===o.size&&this._disposableMap.delete(e)}n&&n.removeEventListener(t,r)},e.prototype.dispose=function(){this._scope.dispose()},e}();function V(e){return!!e.addEventListener}var L=function(){function e(e){this._scope=new D,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var r=this,n=setTimeout(function(){r._timeoutMap.delete(n),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(n)}});return this._timeoutMap.set(n,i),n},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),F="unsupportedCommand",G="handlerError",W="handlerRejection",H="acknowledgeTimeout",j="resultTimeout",B="setupTimeout",z="canceled",K="disposed",Q=0,J=function(){function e(e,t){void 0===t&&(t={});var r=this,n=new Map,i={onCommand:e.onCommand,onNotification:e.onNotification},o=e.initResources,a=e.initTimeoutMs,s=void 0===a?1e4:a,l=e.ackTimeoutMs,c=void 0===l?1e3:l,d=e.resultTimeoutMs,u=void 0===d?1e4:d,p=t.asyncType,h=void 0===p?L:p,m=t.eventGroupType,f=void 0===m?N:m,v=this._scope=new D;v.attach(o);var y,b=this._async=v.attach(new h(this)),g=v.attach(new f(this));this._ackTimeoutMs=c,this._resultTimeoutMs=u,this._invokeCommandHandler=function(e){try{var t=i.onCommand&&i.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:W,isExpected:!1,message:"Unknown error"}).code||e.name||W,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:F,message:e.command},isExpected:!0})}catch(r){return Promise.resolve({result:"error",isExpected:!1,error:{code:G,message:r&&"Name: ".concat(r.name,"; Message: ").concat(r.message||r)}})}},this._invokeNotificationHandler=function(e){try{i.onNotification&&i.onNotification(e)}catch(a){}};var _=this._port=new Promise(function(t,n){v.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=z,n(e)}}),y=b.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(s,"ms"));e.code=B,n(e)},s),e.init(function(e){b.clearTimeout(y),v.attach({dispose:function(){e.close()}});g.on(e,"message",function(t){var n=t.data;if(n&&"object"===typeof n)return"acknowledge"===n.type?r._onAcknowledge(n):"command"===n.type?r._onCommand(e,n):"notification"===n.type?r._onNotification(n):"result"===n.type?r._onResult(n):void 0}),e.start(),t(e)},n)});this.ready=_.then(function(){},function(e){return r.dispose(),Promise.reject(e)}),this._signals=n}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:z,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var r=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:K,message:"disposed"}});var n=++Q,i=t.timeoutDelayMs,o=void 0===i?this._resultTimeoutMs:i,a=t.acknowledgeTimeoutMs,s=void 0===a?this._ackTimeoutMs:a,l=t.transfer;return this._port.then(function(t){var i=r._async,a=new Promise(function(e){r._signals.set(n,{acknowledgeTimeout:i.setTimeout(function(){r._onResult(X(n,H))},s),resultTimeout:i.setTimeout(function(){r._onResult(X(n,j))},o),resolve:e})});return t.postMessage({type:"command",id:n,data:e},l||[]),a})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var r=t.id;e.postMessage({type:"acknowledge",id:r}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:r})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,r=this._async,n=this._signals,i=n.get(t);i&&(r.clearTimeout(i.acknowledgeTimeout),r.clearTimeout(i.resultTimeout),i.resolve(e.data)),n.delete(t)},e}();function X(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}const q={randomUUID:"undefined"!==typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Y;const $=new Uint8Array(16);function Z(){if(!Y&&(Y="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Y))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Y($)}const ee=[];for(let ct=0;ct<256;++ct)ee.push((ct+256).toString(16).slice(1));function te(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return ee[e[t+0]]+ee[e[t+1]]+ee[e[t+2]]+ee[e[t+3]]+"-"+ee[e[t+4]]+ee[e[t+5]]+"-"+ee[e[t+6]]+ee[e[t+7]]+"-"+ee[e[t+8]]+ee[e[t+9]]+"-"+ee[e[t+10]]+ee[e[t+11]]+ee[e[t+12]]+ee[e[t+13]]+ee[e[t+14]]+ee[e[t+15]]}const re=function(e,t,r){if(q.randomUUID&&!t&&!e)return q.randomUUID();const n=(e=e||{}).random||(e.rng||Z)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return te(n)};var ne,ie=((ne={}).SHAREPOINT_TOKEN="SPO",ne.MS_GRAPH_TOKEN="GRAPH",ne.MS_SUBSTRATE_TOKEN="SUBSTRATE",ne.MS_SUBSTRATE_SEARCH_TOKEN="SUBSTRATE_SEARCH",ne.MS_LOKI_TOKEN="LOKI",ne);var oe=function(){function e(){this.playState=new O(void 0),this.isPlayerReady=new O(!1),this.lastUserAction=new C,this.currentTimeInSeconds=new O(void 0),this.muted=new O(void 0),this.volume=new O(void 0),this.mediaDurationInSeconds=new O(void 0),this.playbackSpeed=new O(void 0),this.title=new O(void 0),this.itemUrl=new O(void 0),this.playerBeforeUnload=new C}return e.prototype.dispose=function(){this.playState.unsubscribeAll(),this.isPlayerReady.unsubscribeAll(),this.lastUserAction.unsubscribeAll(),this.currentTimeInSeconds.unsubscribeAll(),this.muted.unsubscribeAll(),this.volume.unsubscribeAll(),this.mediaDurationInSeconds.unsubscribeAll(),this.playbackSpeed.unsubscribeAll(),this.title.unsubscribeAll(),this.itemUrl.unsubscribeAll(),this.playerBeforeUnload.unsubscribeAll()},e}(),ae=function(){function e(e,t,r,n,i){var o=this;this._ttlMs=new O(void 0),this._ttirMs=new O(void 0),this._playerInteractiveTimestamp=new O(void 0),this._pbsid=new O(void 0),this._latestValuesFromIframe={playState:void 0,currentTime:void 0,muted:void 0,volume:void 0,playbackSpeed:void 0},this.playerBeforeUnloadNotify=function(){o.externalPlayerApi.playerBeforeUnload.notify(!0)},this.crossWindow=e,this._tokenRetriever=t,this._embedUrl=r,this._onError=n,this._onTitleOrDisplayNameUpdate=i,this.externalPlayerApi=new oe,this.playerStats={ttlMs:this._ttlMs,ttirMs:this._ttirMs,playerInteractiveTimestamp:this._playerInteractiveTimestamp,playbackSessionId:this._pbsid},this.subscribeToApiEvents(),window.addEventListener("beforeunload",this.playerBeforeUnloadNotify)}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.playerBeforeUnloadNotify),this.externalPlayerApi.dispose()},e.prototype.warmData=function(){return this.crossWindow.sendCommand({command:"one-player-warm-data"}).then(function(){return Promise.resolve()}).catch(function(e){throw A.createGenericError("warning","warmData","warmDataUnknown",e)})},e.prototype.loadPlayer=function(e){return this.crossWindow.sendCommand({command:e?"one-player-load-player-auto-play":"one-player-load-player"}).then(function(){return Promise.resolve()}).catch(function(e){throw A.createGenericError("fatal","loadPlayer","loadPlayerUnknown",e)})},e.prototype.onCommand=function(e){if("getToken"===e.command)return function(e,t,r){return(0,E.__awaiter)(this,void 0,void 0,function(){var n,i,o,a,s;return(0,E.__generator)(this,function(l){switch(l.label){case 0:if(!Object.prototype.hasOwnProperty.call(ie,e.tokenType))return[3,4];n=e.tokenType,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,t.getTokenAsync(ie[n],r)];case 2:return[2,{result:"success",token:l.sent()}];case 3:return i=l.sent(),o="",a="","object"===typeof i&&null!==i&&(s=i,o=Object.prototype.hasOwnProperty.call(s,"code")&&"string"===typeof s.code?s.code:"",a=Object.prototype.hasOwnProperty.call(s,"message")&&"string"===typeof s.message?s.message:""),[2,{result:"error",isExpected:!1,error:{code:o,message:a}}];case 4:return[2,{result:"error",isExpected:!1,error:{code:"UnsupportedTokenType",message:"Unsupported token type"}}]}})})}(e,this._tokenRetriever,this._embedUrl)},e.prototype.onNotification=function(e){switch(void 0===this._pbsid.value&&void 0!==e.pbsid&&(this._pbsid.value=e.pbsid),e.notification){case"one-player-duration":this.externalPlayerApi.mediaDurationInSeconds.value=e.durationInSeconds;break;case"one-player-volume":this._latestValuesFromIframe.volume=e.volume,this.externalPlayerApi.volume.value=e.volume;break;case"one-player-muted":this._latestValuesFromIframe.muted=e.isMuted,this.externalPlayerApi.muted.value=e.isMuted;break;case"one-player-current-time":this._latestValuesFromIframe.currentTime=e.currentTime,this.externalPlayerApi.currentTimeInSeconds.value=e.currentTime;break;case"one-player-playback-speed":this._latestValuesFromIframe.playbackSpeed=e.playbackSpeed,this.externalPlayerApi.playbackSpeed.value=e.playbackSpeed;break;case"one-player-first-interactive":void 0!==e.timestamp&&void 0!==e.timestampTimeOrigin&&(this._playerInteractiveTimestamp.value={timestamp:e.timestamp,timeOrigin:e.timestampTimeOrigin});break;case"one-player-player-ready":this.externalPlayerApi.isPlayerReady.value=!0===e.isReady,void 0!==e.ttlMs&&(this._ttlMs.value=e.ttlMs);break;case"one-player-play-state":var t="Playing"===e.playState?"Playing":"Paused";this._latestValuesFromIframe.playState=t,this.externalPlayerApi.playState.value=t,void 0!==e.ttirMs&&(this._ttirMs.value=e.ttirMs);break;case"one-player-fatal-playback-error":this._onError(e.onePlayerError||A.createGenericError("fatal","playback","playbackUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-fatal-create-session-error":this._onError(e.onePlayerError||A.createGenericError("fatal","createSession","createSessionUnknown",e.error,void 0,e.pbsid,e.hsi));break;case"one-player-reconnect-host":this.loadAndConnectToOnePlayerCallback(this).catch(function(e){throw A.createGenericError("fatal","requestReconnect","errorReconnecting",e)});break;case"one-player-user-click-play":this.externalPlayerApi.lastUserAction.notify({action:"Play"});break;case"one-player-user-click-pause":this.externalPlayerApi.lastUserAction.notify({action:"Pause"});break;case"one-player-user-begin-seek":this.externalPlayerApi.lastUserAction.notify({action:"BeginSeek"});break;case"one-player-user-end-seek":if(void 0===e.targetTimeInSeconds)return void this._onError(A.createGenericError("warning","notification","targetTimeInSecondsUndefinedInEndSeekEvent",new Error("targetTimeInSeconds is undefined")));this.externalPlayerApi.lastUserAction.notify({action:"EndSeek",targetTimeInSeconds:e.targetTimeInSeconds});break;case"one-player-user-skip":if(void 0===e.targetTimeInSeconds)return void this._onError(A.createGenericError("warning","notification","targetTimeInSecondsUndefinedInSkipEvent",new Error("targetTimeInSeconds is undefined")));this.externalPlayerApi.lastUserAction.notify({action:"Skip",targetTimeInSeconds:e.targetTimeInSeconds});break;case"one-player-title-updated":this._onTitleOrDisplayNameUpdate(e.title),this.externalPlayerApi.title.value=e.title;break;case"one-player-item-url":this.externalPlayerApi.itemUrl.value=e.itemUrl;break;case"one-player-title-or-display-name-known":this._onTitleOrDisplayNameUpdate(e.value)}},e.prototype.subscribeToApiEvents=function(){var e=this;this.externalPlayerApi.playState.subscribe(function(t){t&&t!==e._latestValuesFromIframe.playState&&e.crossWindow.sendCommand({command:"Paused"===t?"one-player-pause":"one-player-play"}).catch(function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send play/pause command"))})}),this.externalPlayerApi.currentTimeInSeconds.subscribe(function(t){void 0!==t&&t!==e._latestValuesFromIframe.currentTime&&e.crossWindow.sendCommand({command:"one-player-seek",position:t}).catch(function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send seek command"))})}),this.externalPlayerApi.muted.subscribe(function(t){t!==e._latestValuesFromIframe.muted&&e.crossWindow.sendCommand({command:t?"one-player-mute":"one-player-unmute"}).catch(function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send mute/unmute command"))})}),this.externalPlayerApi.volume.subscribe(function(t){t!==e._latestValuesFromIframe.volume&&e.crossWindow.sendCommand({command:"one-player-set-volume",volumeLevel:t}).catch(function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send set-volume command"))})}),this.externalPlayerApi.playbackSpeed.subscribe(function(t){t!==e._latestValuesFromIframe.playbackSpeed&&e.crossWindow.sendCommand({command:"one-player-set-playback-speed",playbackSpeed:t}).catch(function(t){e._onError(A.createGenericError("warning","playback","enginePlayback",t,"could not send set-playback-speed command"))})})},e}(),se=function(){function e(e,t,r,n,i){var o=this;if(this._channelId=re(),this._onError=n,this._onTitleOrDisplayNameUpdate=i,null===t.contentWindow)throw new Error("The iframe's contentWindow is null");var a=window.location.origin&&"null"!==window.location.origin?window.location.origin:"*",s=new URL(e),l=new URLSearchParams(s.hash.slice(1));l.set("channelId",this._channelId),l.set("origin",a),s.hash=l.toString(),this._embedUrl=s.toString(),this._host=function(e,t){void 0===t&&(t={});var r=e.channelId,n=e.onReinitialize,i=e.origin,o=e.receiver,a=void 0===o?window:o,s=e.source,l=e.identifyParent,c=t.eventGroupType,d=void 0===c?N:c,u=t.messengerType,p=void 0===u?J:u,h=new D,m=h.attach(new d(null));return new p({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var o;if(l&&s){var c=setInterval(function(){var e={type:"identify-parent",channelId:r};s.postMessage(e,i)},100);o=h.attach({dispose:function(){clearInterval(c)}})}var d=!1;m.on(a,"message",function(t){var a,l,c=t.data;if(a=t.origin,l=i,(a&&l?a.toUpperCase()===l.toUpperCase():a===l)&&(!s||t.source===s)&&c&&"object"===typeof c&&"initialize"===c.type&&c.channelId===r){if(o&&o.dispose(),n){if(d)return n(),void m.dispose();d=!0}else m.dispose();var u=c.replyTo;u.postMessage({type:"activate"}),e(u)}})},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({identifyParent:!0,source:t.contentWindow,channelId:this._channelId.toString(),origin:new URL(e).origin,initTimeoutMs:4e4,onCommand:this.onCommand.bind(this),onNotification:this.onNotification.bind(this)}),this._host.ready.catch(function(e){n(A.createGenericError("fatal","createCrossWindowChannel","crossWindowChannelInitializationError",e,"could not initialize cross window channel")),o.dispose()}),this._tokenRetriever=r}return e.prototype.createIframeApi=function(){this.iFrameApi=new ae(this._host,this._tokenRetriever,this._embedUrl,this._onError,this._onTitleOrDisplayNameUpdate),this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)},e.prototype.reconnectHost=function(e){e.crossWindow=this._host,this.iFrameApi=e,this._onNotificationCallback=this.iFrameApi.onNotification.bind(this.iFrameApi),this._onCommandCallback=this.iFrameApi.onCommand.bind(this.iFrameApi)},e.prototype.getDecoratedEmbedUrl=function(){return this._embedUrl},e.prototype.dispose=function(){this.iFrameApi.dispose(),this._host.dispose()},e.prototype.onCommand=function(e){return this._onCommandCallback(e)},e.prototype.onNotification=function(e){this._onNotificationCallback(e)},e}();function le(e,t,r,n){return(0,E.__awaiter)(this,void 0,void 0,function(){return(0,E.__generator)(this,function(i){return[2,new Promise(function(i,o){var a=!1,s=0,l=function(){a=!0,clearTimeout(s)};e.onload=function(){l(),i()},e.onerror=function(e){l(),o(e)};var c=e.contentDocument;c.body||c.createElement("body");var d=c.createElement("form");d.action=t,d.method="POST",d.style.visibility="hidden",d.target="_self";var u=c.createElement("input");if(u.type="hidden",u.name="access_token",u.value=r.token,d.appendChild(u),n){var p=c.createElement("input");u.type="hidden",u.name="SPOPacToken",u.value=n.token,d.appendChild(p)}c.body.appendChild(d),d.submit(),s=setTimeout(function(){a||o(new Error("Timeout error in iframe loading"))},4e4)})]})})}var ce=function(){function e(e,t,r,n,i,o,a){void 0===a&&(a=le);var s=this;this.observer=void 0,this.isIframeConnected=new O(!1),this.defaultIframeTitle="Microsoft Stream video and audio player",this._hasNavigatedToAboutBlank=!1,this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",i&&(this._iframe.allowFullscreen=!0),this._iframe.allow="autoplay *;clipboard-write *;",this._iframe.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups allow-downloads"),this._iframe.setAttribute("title",this.defaultIframeTitle);var l=this.onLoad.bind(this);this._iframe.addEventListener("load",l),this._embedUrl=e,this._containerDiv=t,this._tokenRetriever=r,this._onError=n,this._pacToken=o,this._navigateIframeToEmbedAsync=a,this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe),this.observer=new MutationObserver(function(){var e,t,r;s.isIframeConnected.value=(null===(e=s._iframe)||void 0===e?void 0:e.isConnected)||!1,(null===(t=s._iframe)||void 0===t?void 0:t.isConnected)&&(null===(r=s.observer)||void 0===r||r.disconnect())}),this._disposeActions=[function(){var e;s._iframe&&(s._containerDiv.removeChild(s._iframe),s._iframe.removeEventListener("load",l),s._iframe=void 0),null===(e=s.observer)||void 0===e||e.disconnect()}]}return e.prototype.loadAndConnectToOnePlayer=function(e){return(0,E.__awaiter)(this,void 0,void 0,function(){var t,r,n=this;return(0,E.__generator)(this,function(i){switch(i.label){case 0:if(void 0===this._iframe)throw new Error("Cannot load and connect to OnePlayer because the iframe has been disposed.");return[4,this.getSpoTokenAsync(this._embedUrl,this._tokenRetriever)];case 1:return t=i.sent(),this._embedUrl=this.adjustEmbedUrlHash(this._embedUrl,t),e&&this.reCreateIframeElement(),[4,this.waitForIframeConnected()];case 2:i.sent(),this._crossWindowChannel=new se(this._embedUrl,this._iframe,this._tokenRetriever,this._onError,function(e){return n._onTitleOrDisplayNameUpdate(e)}),e?this._crossWindowChannel.reconnectHost(e):this._crossWindowChannel.createIframeApi(),this._disposeActions.push(function(){var e;return null===(e=n._crossWindowChannel)||void 0===e?void 0:e.dispose()}),this._embedUrl=this._crossWindowChannel.getDecoratedEmbedUrl(),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,this._navigateIframeToEmbedAsync(this._iframe,this._embedUrl,t,this._pacToken)];case 4:return i.sent(),[3,6];case 5:if(r=i.sent(),this._crossWindowChannel.dispose(),r instanceof A)throw r;throw A.createGenericError("fatal","loadIframe","navToEmbed",r);case 6:return[2,this._crossWindowChannel.iFrameApi]}})})},e.prototype.dispose=function(){for(var e=0,t=this._disposeActions;e<t.length;e++){(0,t[e])()}this._disposeActions.length=1},e.prototype.reCreateIframeElement=function(){this._iframe&&(this.dispose(),this._hasNavigatedToAboutBlank=!1),this._iframe=document.createElement("iframe"),this._iframe.style.flex="1",this._iframe.style.border="none",this._iframe.allow="autoplay *;clipboard-write *;",this._iframe.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-popups"),this._iframe.setAttribute("title",this.defaultIframeTitle);var e=this.onLoad.bind(this);this._iframe.addEventListener("load",e),this._containerDiv.style.display="flex",this._containerDiv.appendChild(this._iframe)},e.prototype.waitForIframeConnected=function(){return(0,E.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,E.__generator)(this,function(t){return[2,new Promise(function(t){var r;if(null===(r=e._iframe)||void 0===r?void 0:r.isConnected)t();else{var n=e.isIframeConnected.subscribe(function(e){e&&t()});e._disposeActions.push(function(){return n()})}})]})})},e.prototype.onLoad=function(){var e,t,r,n;try{"about:blank"!==(null===(t=null===(e=this._iframe)||void 0===e?void 0:e.contentWindow)||void 0===t?void 0:t.location.href)&&(null===(n=null===(r=this._iframe)||void 0===r?void 0:r.contentWindow)||void 0===n?void 0:n.location.href)||(this._hasNavigatedToAboutBlank&&this._onError(A.createGenericError("fatal","loadIframe","iframeForciblyUnloaded",void 0,void 0)),this._hasNavigatedToAboutBlank=!0)}catch(i){i instanceof DOMException&&(this._hasNavigatedToAboutBlank=!0)}},e.prototype._onTitleOrDisplayNameUpdate=function(e){var t;null===(t=this._iframe)||void 0===t||t.setAttribute("title",e||this.defaultIframeTitle)},e.prototype.getSpoTokenAsync=function(e,t){return(0,E.__awaiter)(this,void 0,void 0,function(){var r;return(0,E.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),t.getTokenWithAuthTypeAsync?[2,t.getTokenWithAuthTypeAsync("SPO",e)]:[3,1];case 1:return[4,t.getTokenAsync("SPO",e)];case 2:return[2,{token:n.sent()}];case 3:return[3,5];case 4:throw r=n.sent(),A.createGenericError("fatal","loadIframe","getTokenFailed",r);case 5:return[2]}})})},e.prototype.adjustEmbedUrlHash=function(e,t){var r=new URL(e),n=new URLSearchParams(r.hash.slice(1));return n.set("access_token",t.token),r.hash=n.toString(),r.toString()},e}(),de=function(){function e(e){this._loaderOptionsBase=e}return e.prototype.createPlaybackSession=function(e,t){return(0,E.__awaiter)(this,void 0,void 0,function(){var r,n,i,o;return(0,E.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal(e?"autoplayOn":"autoplayOff",t)];case 1:return r=a.sent(),n=r[0],i=r[1],[2,{playbackApi:n.externalPlayerApi,dispose:i,playerStats:n.playerStats}];case 2:throw(o=a.sent())instanceof A?o:A.createGenericError("fatal","loadIframe","iframeUnknown",o,void 0,t.hostSessionId);case 3:return[2]}})})},e.prototype.createThumbnailHyperlinkOnlySession=function(e){return(0,E.__awaiter)(this,void 0,void 0,function(){var t,r,n,i;return(0,E.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal("thumbnailHyperlinkOnly",e)];case 1:return t=o.sent(),r=t[0],n=t[1],[2,{playbackApi:r.externalPlayerApi,playerStats:r.playerStats,dispose:n,simulateClick:function(){return r.loadPlayer(!0)}}];case 2:return i=o.sent(),[2,Promise.reject(i)];case 3:return[2]}})})},e.prototype.createDeferredPlaybackSession=function(e){return(0,E.__awaiter)(this,void 0,void 0,function(){var t,r,n,i,o;return(0,E.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.createPlaybackSessionInternal("deferredLoad",e)];case 1:return t=a.sent(),r=t[0],n=t[1],i=new O(void 0),r.externalPlayerApi.isPlayerReady.subscribe(function(e){e&&(i.value=r.externalPlayerApi)}),[2,{playbackApi:i,loadPlayer:function(e){return r.loadPlayer(e)},warmData:function(){return r.warmData()},dispose:n,playerStats:r.playerStats}];case 2:throw(o=a.sent())instanceof A?(o.hostSessionId=e.hostSessionId,o):A.createGenericError("fatal","loadIframe","iframeUnknown",o,void 0,e.hostSessionId);case 3:return[2]}})})},e.prototype.createOnePlayerIframe=function(e,t,r,n,i,o){return new ce(e,t,r,n,i,o)},e.prototype.createPlaybackSessionInternal=function(e,t){return(0,E.__awaiter)(this,void 0,void 0,function(){var r,n,i,o,a,s,l;return(0,E.__generator)(this,function(c){switch(c.label){case 0:return r=performance.now(),n={timeOrigin:Date.now()-r,timestamp:r},[4,this.getEmbedUrlAsync(t.videoId.videoUrl)];case 1:return i=c.sent(),i=this.adjustEmbedUrlQueryString(e,i,t,n),o=void 0,a=function(){try{null===o||void 0===o||o.dispose()}catch(e){throw e instanceof A?e:A.createGenericError("fatal","dispose","disposeUnknown",e,void 0,t.hostSessionId)}},s=function(e){t.onError(a,e)},[4,(o=this.createOnePlayerIframe(i,t.containerDiv,this._loaderOptionsBase.tokenRetriever,s,t.allowFullscreen,this._loaderOptionsBase.pacToken)).loadAndConnectToOnePlayer()];case 2:return(l=c.sent()).loadAndConnectToOnePlayerCallback=o.loadAndConnectToOnePlayer.bind(o),[2,[l,a]]}})})},e}();const ue="13.27.4";var pe=function(e){function t(t){return e.call(this,t)||this}return(0,E.__extends)(t,e),t.prototype.adjustEmbedUrlQueryString=function(e,t,r,n){var i,o,a=new URL(t);a.searchParams.delete("access_token"),a.searchParams.set("auth","readwrite");var s=void 0,l=void 0,c=void 0;r.theme&&(s="light"===r.theme.name?1:0,l=r.theme.primaryColor,c=r.theme.fluentTheme);var d=JSON.stringify({ap:"autoplayOn"===e?1:0,dl:"deferredLoad"===e?1:void 0,ha:r.hostApp,hp:r.hostPlatform,hv:r.hostView,hc:r.hostComponent,hci:r.hostCorrelationId,het:r.hostExtraTelemetry,hra:r.hostReferrerApp,hrp:r.hostReferrerAppPlatform,hrv:r.hostReferrerView,hrm:r.hostReferrerMode,hrps:r.hostReferrerPlaybackSessionId,hvn:r.hostVersion,he:r.hostEnvironment,hm:r.hostMode,hsi:r.hostSessionId,hr:r.hostReferrer,hrs:r.hostReferrerScenario,lv:ue,t0:null!==(i=r.hostTimestamps.t0.timestamp)&&void 0!==i?i:0,t0to:null!==(o=r.hostTimestamps.t0.timeOrigin)&&void 0!==o?o:performance.timeOrigin,tcs:n.timestamp,tcsto:n.timeOrigin,ust:s,pc:l,theme:c,ol:r.overrideLanguage,hvm:r.hideVideoMetadata,itf:r.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe"});if(a.searchParams.set("embed",d),r.startTimeInSeconds||r.clipInformation){var u={playbackOptions:(0,E.__assign)((0,E.__assign)({},r.startTimeInSeconds?{startTimeInSeconds:r.startTimeInSeconds}:{}),r.clipInformation?{playbackModifier:{clipInformation:r.clipInformation}}:{})};a.searchParams.set("nav",JSON.stringify(u))}if(r.flightsUsed||r.flightsUnused){var p={flightsUsed:r.flightsUsed?r.flightsUsed.join(","):void 0,flightsUnused:r.flightsUnused?r.flightsUnused.join(","):void 0};a.searchParams.set("exp",JSON.stringify(p))}return a.toString()},t.prototype.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("embed.aspx"))return Promise.resolve(e);throw A.createGenericError("fatal","loadIframe","unrecognizedVideoUrlFormat",void 0)},t}(de);var he=function(e){function t(t){return e.call(this,t)||this}return(0,E.__extends)(t,e),t.prototype.adjustEmbedUrlQueryString=function(e,t,r,n){var i,o,a,s,l,c,d=new URL(t);d.searchParams.delete("access_token"),d.searchParams.set("auth","readwrite");var u=JSON.stringify({ha:r.hostApp,hp:r.hostPlatform,hv:r.hostView,hm:r.hostMode,hsi:r.hostSessionId,he:r.hostEnvironment,hc:r.hostComponent,hci:r.hostCorrelationId,het:r.hostExtraTelemetry,hra:r.hostReferrerApp,hrp:r.hostReferrerAppPlatform,hrv:r.hostReferrerView,hrm:r.hostReferrerMode,hrps:r.hostReferrerPlaybackSessionId,hr:r.hostReferrer,hrs:r.hostReferrerScenario,hvn:r.hostVersion,lv:ue,t0:null!==(i=r.hostTimestamps.t0.timestamp)&&void 0!==i?i:0,t0to:null!==(o=r.hostTimestamps.t0.timeOrigin)&&void 0!==o?o:performance.timeOrigin,tcs:n.timestamp,tcsto:n.timeOrigin,dl:"deferredLoad"===e?1:void 0,ap:"autoplayOn"===e?1:void 0,thl:"thumbnailHyperlinkOnly"===e?1:void 0,thm:null===(a=r.theme)||void 0===a?void 0:a.name,pc:null===(s=r.theme)||void 0===s?void 0:s.primaryColor,flthm:null===(l=r.theme)||void 0===l?void 0:l.fluentTheme,ol:r.overrideLanguage,hvm:r.hideVideoMetadata,itf:r.enableVideoPlayerTabstopDuringPlayback?"rc":"ffe",pso:"highlights"===(null===(c=r.playSegmentsOptions)||void 0===c?void 0:c.mode)?"hl":void 0,dm:r.defaultMuted});if(d.searchParams.set("embed",u),r.startTimeInSeconds||r.clipInformation){var p={playbackOptions:(0,E.__assign)((0,E.__assign)({},r.startTimeInSeconds?{startTimeInSeconds:r.startTimeInSeconds}:{}),r.clipInformation?{playbackModifier:{clipInformation:r.clipInformation}}:{})};d.searchParams.set("nav",JSON.stringify(p))}if(r.flightsUsed||r.flightsUnused){var h={flightsUsed:r.flightsUsed?r.flightsUsed.join(","):void 0,flightsUnused:r.flightsUnused?r.flightsUnused.join(","):void 0};d.searchParams.set("exp",JSON.stringify(h))}return d.toString()},t.prototype.getEmbedUrlAsync=function(e){if(-1!==e.indexOf("streamembed.aspx"))return Promise.resolve(e);throw A.createGenericError("fatal","loadIframe","unrecognizedVideoUrlFormat",void 0,void 0)},t}(de);var me=r(80789),fe=r(16775);const ve="MSIE",ye="Chrome",be="Firefox",ge="Safari",_e="Edge",we="Edge Chromium",ke="Electron",Pe="SkypeShell",Se="PhantomJS",Te="Opera",Ie="Windows",Ae="Mac OS X",Ee="Windows Phone",Ue="Windows RT",Ce="iOS",Oe="Android",Re="Linux",Me=/(windows|win32)/i,xe=/ arm;/i,De=/windows\sphone\s\d+\.\d+/i,Ne=/(macintosh|mac os x)/i,Ve=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,Le=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,Fe=/android/i,Ge={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},We="([\\d,.]+)",He="Unknown";function je(e,t){return t.indexOf(e)>-1}function Be(e,t){if(t===ve)return function(e){const t=e.match(new RegExp(ve+" "+We));if(t)return t[1];{const t=e.match(new RegExp("rv:"+We));if(t)return t[1]}return""}(e);return function(e,t){let r=e;r===ge&&(r="Version");const n=t.match(new RegExp(r+"/"+We));if(n)return n[1];return}(t===we?"Edg":t,e)}const ze=(e,t)=>{const r=e.match(new RegExp(t+" "+We));return r?Ge[r[1]]?Ge[r[1]]:r[1]:He},Ke=e=>{const t=e.match(new RegExp(Ae+" ([\\d,_,.]+)"));if(t){const e=t[1].replace(/_/g,".");if(e){const t=(e=>e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null)(e);if(t){return e.split(t)[0]}return e}}return He};let Qe;function Je(){if(!Qe){const e="undefined"!==typeof navigator?navigator.userAgent:"",t=function(e){return je("OPR/",e)?Te:je(Se,e)?Se:je(_e,e)?_e:je("Edg",e)?we:je(ke,e)?ke:je(ye,e)?ye:je("Trident",e)?ve:je(be,e)?be:je(ge,e)?ge:je(Pe,e)?Pe:void 0}(e),r=void 0!==t?Be(e,t):void 0,n=(e=>e.match(De)?Ee:e.match(xe)?Ue:e.match(Ve)?Ce:e.match(Fe)?Oe:e.match(Le)?Re:e.match(Ne)?Ae:e.match(Me)?Ie:He)(e),i=void 0!==n?((e,t)=>t===Ie?ze(e,"Windows NT"):t===Oe?ze(e,t):t===Ae?Ke(e):He)(e,n):void 0;Qe={browserName:t,browserVersion:r,osName:n,osVersion:i}}return Qe}var Xe=r(76528);function qe(){const{osName:e}=Je();return function(e){if((0,Xe.eP)()||(0,Xe._y)())switch(e){case"Android":return"Android";case"iOS":return"iOS";case"Linux":return"Linux";case"Mac OS X":return"Mac";case"Windows":return"Win32";default:return}return"Web"}(e)}function Ye(e){var t;const r=function(e){var t;let r,n=null!==(t=qe())&&void 0!==t?t:"Native";switch(e){case fe.C.ExchangeAppId:case fe.C.MonarchAppId:case fe.C.OwaAppId:r=fe.b.Outlook,(0,Xe._y)()&&(n="Desktop");break;case fe.C.OfficeAppId:r="Win32"===n?fe.b.Outlook:fe.b.LoopApp;break;case fe.C.LoopAppId:r=fe.b.LoopApp}return{hostApp:r,hostPlatform:n}}(e),n=r.hostPlatform||"";return r.hostApp===fe.b.LoopApp?{hostApp:"Loop",hostPlatform:n}:{hostApp:null!==(t=r.hostApp)&&void 0!==t?t:e,hostPlatform:n}}var $e=r(73540);function Ze(e){const t=e.searchParams.get("nav");if(t)try{const e=atob(t),{referralInfo:r}=JSON.parse(e);if(!r)return;return{hostReferrerApp:r.referralApp,hostReferrerAppPlatform:r.referralAppPlatform,hostReferrerView:r.referralView,hostReferrerMode:r.referralMode,hostReferrerPlaybackSessionId:r.referralPlaybackSessionId}}catch(r){return}}function et(e){return t=>{"Playing"===t?e.raiseIsPlaying():"Paused"===t&&e.raiseIsPaused()}}function tt(e,t){var r;if(null===(r=e.current)||void 0===r||r.dispose(),t.current){const e=t.current;for(;e.firstChild&&e.lastChild;)e.removeChild(e.lastChild)}}async function rt(e,t,r,n,i,o,a,s){var l,d,u,p,h,m,f,v,y,b,g,_,k,P,E,U,C,O;let R=arguments.length>8&&void 0!==arguments[8]&&arguments[8],M=arguments.length>9?arguments[9]:void 0,x=arguments.length>10?arguments[10]:void 0,D=arguments.length>11?arguments[11]:void 0,N=arguments.length>12?arguments[12]:void 0,V=arguments.length>13?arguments[13]:void 0,L=arguments.length>14?arguments[14]:void 0,F=arguments.length>15?arguments[15]:void 0;const G=(0,$e.AL)(i.settingsProvider),W=G?null!==(l=null===F||void 0===F||null===(d=F.hostInformation)||void 0===d?void 0:d.hostApp)&&void 0!==l?l:Ye(null!==(u=r.AppID)&&void 0!==u?u:"").hostApp:Ye(null!==(p=r.AppID)&&void 0!==p?p:"").hostApp,H=G?null!==(h=null===F||void 0===F||null===(m=F.hostInformation)||void 0===m?void 0:m.hostPlatform)&&void 0!==h?h:Ye(null!==(f=r.AppID)&&void 0!==f?f:"").hostPlatform:Ye(null!==(v=r.AppID)&&void 0!==v?v:"").hostPlatform,j=await async function(e,t){return{tokenRetriever:{beginSilentSignOn:()=>{},getTokenAsync:async(r,n)=>{let i=[];try{null===t||void 0===t||t.markSubActivityStart(w.n.OnePlayerTokenRetrieval);const r=S.P.SharePoint;i=(0,T.w)((0,I.$)(n),r);const o=await e.TokenProvider.getToken(i,{request:null});return null===t||void 0===t||t.markSubActivityEnd(w.n.OnePlayerTokenRetrieval),o.token}catch(o){throw null===t||void 0===t||t.markSubActivityEnd(w.n.OnePlayerTokenRetrieval,{[c.QK.OnePlayerTokenRetrieval]:"failed",tokenType:r}),o}}}}}(r,x),B=i.additionalTelemetryProperties.unfurlCorrelationId,z=i.additionalTelemetryProperties.variableTimeOrigin,K=(Q=i.settingsProvider,(0,$e.q_)(Q)?"P-X-1112345-4":(0,$e.pG)(Q)?"P-X-1112345-2":(0,$e.uc)(Q)?"P-X-1112345-1":"P-X-1112345-3");var Q;const J=null===(y=i.telemetryConfig)||void 0===y?void 0:y.scenarioStartTime,X=M&&(null===(b=M.PersistedProperties)||void 0===b||null===(g=b.getPersistedProperties)||void 0===g?void 0:g.call(b).hostScenarioStartTime),q=M&&(null===(_=M.PersistedProperties)||void 0===_||null===(k=_.getPersistedProperties)||void 0===k?void 0:k.call(_).codeVersion),Y=function(e,t,r,n,i){if(t)return performance.now();if(e){const e=null!==n&&void 0!==n?n:i;if(void 0!==e){const t=Date.now()-e;return performance.now()-t}}return null!==r&&void 0!==r?r:performance.now()}((0,$e.xn)(i.settingsProvider),R,null===x||void 0===x?void 0:x.startTime,"number"===typeof X?X:void 0,J),$=L?function(e,t){const r=e.searchParams.getAll("referrer"),n=e.searchParams.getAll("referrerScenario");if(0===r.length)return Ze(e);if(1===r.length&&r[r.length-1].split(".")[0]===t)return Ze(e);let i=r[r.length-1],o=n[n.length-1];i.split(".")[0]===t&&r.length>1&&(i=r[r.length-2],n.length>1&&(o=n[n.length-2]));const a=i.split(".")[0],s=i.split(".")[1];let l,c,d;return o&&(l=o.split(".")[0],c=o.split(".")[1],d=o.split(".")[2]),{hostReferrerApp:a,hostReferrerAppPlatform:s,hostReferrerView:l,hostReferrerMode:c,hostReferrerPlaybackSessionId:d}}(L,W):void 0,Z=G&&null!==(P=null===F||void 0===F||null===(E=F.hostInformation)||void 0===E?void 0:E.hostView)&&void 0!==P?P:N,ee=G?null===F||void 0===F||null===(U=F.hostInformation)||void 0===U?void 0:U.playSegmentsOptions:void 0,te=!!(0,$e.oT)(i.settingsProvider)&&!0!==(null===F||void 0===F?void 0:F.disableFullscreen),re=Boolean(n.hideVideoMetadata);null===x||void 0===x||x.addAdditionalProps({unfurlCorrelationId:B,isVideoHydratedInDetachedMode:R,t0TimeOrigin:z,t0:Y,telemetryConfigScenarioStartTime:J,loggerScenarioStartTime:X,usedOnePlayerIframeConfigId:K,playerReloads:D.current}),D.current+=1;const ne={videoId:{videoUrl:(0,$e.pG)(i.settingsProvider)?t:t.replace("embed.aspx","streamembed.aspx")},containerDiv:e,allowFullscreen:te,onError:(e,t)=>a(e,t,x),hostApp:W,hostPlatform:H,hostComponent:me.I,hostView:null!==Z&&void 0!==Z?Z:"",theme:o,hostSessionId:(null===(C=i.telemetryConfig)||void 0===C?void 0:C.hostSessionId)||"",hostCorrelationId:B||"",hostMode:G?null===F||void 0===F||null===(O=F.hostInformation)||void 0===O?void 0:O.hostMode:void 0,hostEnvironment:"Prod",hostTimestamps:{t0:{timestamp:Y,timeOrigin:z}},hostVersion:"string"===typeof q?q:"",hostReferrerApp:null===$||void 0===$?void 0:$.hostReferrerApp,hostReferrerAppPlatform:null===$||void 0===$?void 0:$.hostReferrerAppPlatform,hostReferrerView:null===$||void 0===$?void 0:$.hostReferrerView,hostReferrerMode:null===$||void 0===$?void 0:$.hostReferrerMode,hostReferrerPlaybackSessionId:null===$||void 0===$?void 0:$.hostReferrerPlaybackSessionId,hideVideoMetadata:re,overrideLanguage:s,enableVideoPlayerTabstopDuringPlayback:!1,flightsUsed:[K],startTimeInSeconds:V,playSegmentsOptions:ee};null===x||void 0===x||x.markSubActivityEnd(w.n.TimeInPlaybackLoopComponent);const ie=function(e,t){return(0,$e.pG)(t)?function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new pe(e)}catch(r){throw r instanceof A?r:A.createGenericError("fatal","loadIframe",t,r)}}(e):function(e){var t="beginSilentSignOn";try{return e.tokenRetriever.beginSilentSignOn(),t="iframeUnknown",new he(e)}catch(r){throw r instanceof A?r:A.createGenericError("fatal","loadIframe",t,r)}}(e)}(j,i.settingsProvider);return await((0,$e.RC)(i.settingsProvider)?function(e,t,r,n){const i="autoplayOn"===n,o="autoplayOff"===n,a="thumbnailHyperlinkOnly"===n;if("deferredLoad"===n)return(0,$e.pG)(r)?e.createPlaybackSession(!1,t):e.createDeferredPlaybackSession(t);return((0,$e.q_)(r)||(0,$e.pG)(r))&&(i||o)?e.createPlaybackSession(i||!1,t):(0,$e.uc)(r)||a?e.createThumbnailHyperlinkOnlySession(t):e.createDeferredPlaybackSession(t)}(ie,ne,i.settingsProvider,null===F||void 0===F?void 0:F.loadMode):function(e,t,r){return(0,$e.q_)(r)||(0,$e.pG)(r)?e.createPlaybackSession(!1,t):(0,$e.uc)(r)?e.createThumbnailHyperlinkOnlySession(t):e.createDeferredPlaybackSession(t)}(ie,ne,i.settingsProvider))}class nt{constructor(e){this.isPlayerReady=new O(!1),this.playState=new O("Paused"),this.lastUserAction=new O({action:"Pause"}),this.currentTimeInSeconds=new O(void 0),this.muted=new O(void 0),this.volume=new O(void 0),this.mediaDurationInSeconds=new O(void 0),this.playbackSpeed=new O(void 0),this.title=new O(void 0),this.itemUrl=new O(void 0),this.playerBeforeUnload=new O(!1),this.playState.subscribe(t=>{"Playing"===t&&e.loadPlayer(!0).catch(e=>{throw e})})}cleanUp(){this.playState.unsubscribeAll()}}const it={dark:"dark",light:"light",default:"light"};function ot(e){if(e.current){return getComputedStyle(e.current).getPropertyValue(P.Fj)||void 0}}var at=r(33788),st=r(93421);const lt=e=>{let{embeddableUrl:t,playbackStateSetter:r,parentRef:f,setViewRootElement:S,endRenderingActivity:T,onKeyDownHandler:I,setIsPlayerReady:A,setError:E,updateTitle:U,strings:C,hostView:O,startTimeInSeconds:R,playerLoads:M,videoUrl:x}=e;const D=(0,u.U)(),N=(0,p.i)(),V=(0,h.I)(),L=(0,m._)(),F=(0,st.W)(),G=o.useRef(null),W=o.useRef(!1),H=o.useRef(null),j=o.useRef(null),B=o.useRef(null),z=o.useRef(void 0),[K,Q]=o.useState(!1),J=(0,a.b)(),X=(0,$e.zG)(N.settingsProvider),q=function(e,t){const r=(0,a.b)(),[n,i]=o.useState();return o.useEffect(()=>{const o=it[(null===r||void 0===r?void 0:r.themeName)||"light"],a="high-contrast"===(null===r||void 0===r?void 0:r.themeName)?"teams-contrast":void 0,s=t&&void 0!==a;(e.current&&(null===n||void 0===n?void 0:n.name)!==o||s)&&i({name:o,primaryColor:ot(e),fluentTheme:a})},[r,e,null===n||void 0===n?void 0:n.name,t]),n}(G,X),Y=(0,s.Ym)(),$=o.useMemo(v,[]),Z=!(0,$e.pG)(N.settingsProvider)&&!(0,$e.q_)(N.settingsProvider)&&!(0,$e.uc)(N.settingsProvider),ee=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const[r,n]=o.useState(!1),i=o.useRef(),a=(0,u.U)();return o.useEffect(()=>{if(!t)return;const e=new IntersectionObserver(e=>{n(e[0].isIntersecting)});return i.current=e,()=>e.disconnect()},[t]),o.useEffect(()=>{if(!t)return;const r=e.current;if(r){if(i.current){const e=i.current;return e.observe(r),()=>e.unobserve(r)}return()=>{}}(0,l.H)(void 0,a,"useVisibilityObserver",c.QK.MissingVisibilityElement)},[e,a,t]),{observer:i,isVisible:r}}(f,Z),te=function(e){const[t,r]=o.useState(null),n=o.useRef(null),[i,a]=o.useState(void 0);o.useEffect(()=>{r(e.current)},[e]);const s=()=>{var e;null===(e=n.current)||void 0===e||e.disconnect()};return o.useEffect(()=>{if(t&&(s(),a(()=>t.isConnected),!t.isConnected))return n.current=new MutationObserver(()=>{a(()=>t.isConnected),t.isConnected&&s()}),n.current.observe(document.body,{subtree:!0,childList:!0}),()=>{s()}},[t]),i}(G),re=(0,$e.d5)(N.settingsProvider)&&te,ne=o.useCallback((e,t)=>{t&&e&&(null===A||void 0===A||A(!0),$.setIsReady(t,{playerInteractiveTimestamp:e},N.additionalTelemetryProperties.variableTimeOrigin))},[N,$,A]),ie=o.useCallback(e=>{if((e=>y.includes(e.key))(e)){e.preventDefault(),e.stopPropagation();const t=B.current;if(t&&_(t))return void(z.current?window.open(z.current,"_blank","noopener,noreferrer"):(j.current=(0,n.A)((0,n.A)({},j.current),{},{itemUrlUnsubscribe:t.playbackApi.itemUrl.subscribe(e=>{e&&(z.current=e,window.open(e,"_blank","noopener,noreferrer"))})}),t.simulateClick()));"Playing"===r.getPlaybackState()?r.pause():r.play()}else(e=>b.includes(e.key))(e)||I(e)},[r,I]),oe=o.useCallback(()=>{(0,P.hS)(f.current,(0,$e.vd)(N.settingsProvider))},[f,N]),ae=o.useCallback(()=>{(0,P.Ig)(f.current,(0,$e.vd)(N.settingsProvider))},[f,N]),se=o.useCallback((e,t)=>{r.initialize(e),j.current=(0,n.A)((0,n.A)({},j.current),{},{playStateUnsubscribe:e.playState.subscribe(et(r)),titleUnsubscribe:e.title.subscribe(U),playerBeforeUnloadUnsubscribe:e.playerBeforeUnload.subscribe(t)})},[r,U]);return o.useEffect(()=>{if(!B.current)return;const e=B.current;var t;g(e)&&ee.isVisible&&f.current&&(null===(t=ee.observer.current)||void 0===t||t.unobserve(f.current),e.warmData().catch(e=>{(0,l.H)(e,D,"warmData",c.QK.OnePlayerWarmup)}))},[ee,D,f,K]),o.useEffect(()=>{const e=(e,t,r)=>{null===A||void 0===A||A(!0);const{level:n,isExpected:i,scenario:a,knownError:s,playbackSessionId:l}=t;"iframeForciblyUnloaded"===s?(B.current=null,e(),null===r||void 0===r||r.markSubActivityStart(w.n.SetupIframeAfterIframeForciblyUnloaded),o(!1,r),null===r||void 0===r||r.markSubActivityEnd(w.n.SetupIframeAfterIframeForciblyUnloaded)):(T(d.G.Embedded),null===r||void 0===r||r.setResult(!1,{errorCode:c.QK.IframePlayerSetup,level:n,scenario:a,isExpected:i,playbackSessionId:l},s),"loadIframe"===a&&E&&E(new Error("loadIframe failed")))},i=e=>{if(e){const e=at.m.start(w.z.SetupIframeAfterBeforeUnload,D);N.activities.set(w.z.SetupIframeAfterBeforeUnload,e),tt(B,G),o(!1,e)}};function o(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1?arguments[1]:void 0;if(void 0!==re){if((0,$e.d5)(N.settingsProvider)){if(null===G.current||void 0===q||!re)return void(re||(W.current=!0,null===s||void 0===s||s.markSubActivityStart(w.n.VideoHydratedInDetachedMode)));W.current&&(W.current=!1,null===s||void 0===s||s.markSubActivityEnd(w.n.VideoHydratedInDetachedMode))}else{if(null===G.current||void 0===q)return;if(!G.current.isConnected)return void function(e,t,r){null===r||void 0===r||r.markSubActivityStart(w.n.VideoHydratedInDetachedMode);const n=document.createElement("iframe");n.height="0px",n.width="0px",n.style.visibility="hidden";const i=()=>{e.removeChild(n),null===r||void 0===r||r.markSubActivityEnd(w.n.VideoHydratedInDetachedMode),t(!0,r),document.removeEventListener("load",i),document.removeEventListener("error",i)};n.addEventListener("load",i),n.addEventListener("error",i),e.appendChild(n)}(G.current,o,s)}if(M.current>0){const e=at.m.start(w.z.VideoReloadFromUnfurl,D);N.activities.set(w.z.VideoReloadFromUnfurl,e)}rt(G.current,t,L,F,N,q,e,Y,a,D,M.current>0?k(N,w.z.VideoReloadFromUnfurl):s,M,O,R,x,V).then(e=>{if(T(d.G.Embedded),B.current=e,Q(!0),S(H.current),j.current={playerStatsPlayerInteractiveTimestampUnsubscribe:e.playerStats.playerInteractiveTimestamp.subscribe(e=>{const t=M.current>1?k(N,w.z.VideoReloadFromUnfurl):s;ne(e,t)})},g(e)){const t=new nt(e);r.initialize(t),j.current=(0,n.A)((0,n.A)({},j.current),{},{playbackApiUnsubscribe:e.playbackApi.subscribe(e=>{e&&(t.cleanUp(),se(e,i))})})}else _(e)||se(e.playbackApi,i)}).catch(e=>{null===A||void 0===A||A(!0),T(d.G.Embedded);const t=(e=>{const t=e=>"object"===typeof e&&null!==e;let r=e;if(t(e)&&"string"!==typeof e.message){const i=e.originalError;"string"===typeof i?r=(0,n.A)((0,n.A)({},e),{},{message:i}):t(i)&&"string"===typeof i.message&&(r=(0,n.A)((0,n.A)({},e),{},{message:i.message}))}return r})(e);var r;M.current>1&&(null===(r=k(N,w.z.VideoReloadFromUnfurl))||void 0===r||r.setResult(!1,{errorCode:c.QK.IframePlayerSetup},t));null===s||void 0===s||s.setResult(!1,{errorCode:c.QK.IframePlayerSetup},t),(0,l.H)(t,D,"setupIframePlayer",c.QK.IframePlayerSetup)})}}return o(!1,k(N,w.z.VideoLoadFromUnfurl)),()=>{var e;j.current&&(e=j.current,Object.values(e).forEach(e=>e())),tt(B,G)}},[re,t,L,D,N,r,T,q,S,ne,$,ie,Y,se,A,E,O,R,M,x,V,F]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{ref:H,role:"link",tabIndex:0,onFocus:oe,onBlur:ae,onKeyDown:ie,"aria-label":C.onePlayerIframeHostContainerAriaLabel}),(0,i.jsx)("div",{ref:G,className:(0,P.qo)(null===J||void 0===J?void 0:J.theme.palette.themePrimary),"aria-label":C.onePlayerIframeHostContainerAriaLabel})]})}}}]);
//# sourceMappingURL=StreamEmbeddedRenderer.82b05519.chunk.js.map