(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[7691],{219:(e,t,n)=>{"use strict";var r;n.d(t,{x:()=>r}),function(e){e[e.Pending=1]="Pending",e[e.Failed=2]="Failed",e[e.Cancelled=3]="Cancelled",e[e.Succeeded=4]="Succeeded"}(r||(r={}))},514:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,t,n,r),this.bucket=e}}i.actionType="PLW_CREATE_BUCKET_FAILED"},937:(e,t,n)=>{"use strict";n.d(t,{F:()=>l});var r=n(55491),i=n.n(r),s=n(16112),a=n(51171),o=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(e){function t(t,n){var r=e.call(this,t,n)||this;if(r.shouldRender=!1,!r.props.dispatcherEventManagement)throw new a.L("dispatcherEventManagement");return r.storesToSubscribeTo=[],i()(r.getAllStoresInProps(),function(e){r.addStoreToSubscribeTo(e)}),r.actionDispatchCompleteCallback=r.onActionDispatchComplete.bind(r),r}return o(t,e),t.prototype.componentDidMount=function(){i()(this.storesToSubscribeTo,function(e){e.store.subscribeToStore(e.callback)}),this.props.dispatcherEventManagement.addOnActionDispatchComplete(this.actionDispatchCompleteCallback)},t.prototype.componentWillUnmount=function(){i()(this.storesToSubscribeTo,function(e){e.store.unsubscribeFromStore(e.callback)}),this.props.dispatcherEventManagement.removeOnActionDispatchComplete(this.actionDispatchCompleteCallback)},t.prototype.logRender=function(e){},t.prototype.storeDidUpdate=function(){},t.prototype.addStoreToSubscribeTo=function(e){this.storesToSubscribeTo.push({store:e,callback:this.onStoreUpdate.bind(this)})},t.prototype.onStoreUpdate=function(){this.shouldRender=!0},t.prototype.onActionDispatchComplete=function(e){var t=this;this.shouldRender&&(this.forceUpdate(e&&e.length>0?function(){return t.logRender(e)}:void 0),this.storeDidUpdate(),this.shouldRender=!1)},t.prototype.getAllStoresInProps=function(){var e=[];return i()(this.props,function(t){t&&t.subscribeToStore&&t.unsubscribeFromStore&&e.push(t)}),e},t}(s.$)},1207:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{planId:this.planId,count:String(this.buckets.length)}}constructor(e,t){super(i.actionType),this.planId=e,this.buckets=t}}i.actionType="PLW_GET_BUCKETSFORPLAN_SUCCEEDED"},1623:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{localId:this.bucket.id}}constructor(e){super(i.actionType),this.bucket=e}}i.actionType="PLW_CREATE_BUCKET"},3756:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.entityId=e}}i.actionType="AUGLOOP_FETCH_IMG_RECS"},4398:(e,t,n)=>{"use strict";n.d(t,{D:()=>r});var r=n(65043).createContext(void 0)},4576:(e,t,n)=>{"use strict";n.d(t,{o:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.tenantFeedbackSettings=e}}i.actionType="PLW_GET_TENANTFEEDBACKSETTINGS_SUCCEEDED"},4757:(e,t,n)=>{var r=n(56552);e.exports=function(){return r.Date.now()}},5062:(e,t,n)=>{"use strict";n.d(t,{f:()=>h});var r=n(75992),i=n(28673),s=n.n(i),a=n(42907),o=n.n(a),l=n(56707),c=n.n(l),d=n(91733),u=n.n(d);class h extends r.r{loggingData(){const e=s()(this.containerPlanMapping).length,t=u()(this.containerPlanMapping,e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.length)&&void 0!==t?t:0}),n=o()(c()(this.containerPlanMapping),"length");return{containerCount:String(e),planCountByContainer:JSON.stringify(t),totalPlanCount:String(n),containerType:String(this.containerType)}}constructor(e,t){super(h.actionType),this.containerPlanMapping=e,this.containerType=t}}h.actionType="PLW_RESOLVECONTAINERSTOPLANS_SUCCEEDED"},6189:(e,t,n)=>{"use strict";n.d(t,{y:()=>m});var r=n(98990),i=n.n(r),s=n(84048),a=n.n(s),o=n(37535),l=n(33411),c=n.n(l),d=n(50204),u=n(44430),h=n(91246);class p{build(){return new m(this)}fromUnifiedGroupDetailsResource(e){const t=c()(e.Owners,e=>d.K.builder.fromUserResource(e).build()),n='"value":"';let r;if(null!=e.OneDriveUrl){const t=e.OneDriveUrl.indexOf(n);r=0===t?e.OneDriveUrl:e.OneDriveUrl.substring(t+9,e.OneDriveUrl.length-2)}return this.withPropertyBag({creationOptions:e.CreationOptions,currentUserRelationToGroup:e.CurrentUserRelationToGroup,endpoints:e.Endpoints,id:e.Id,owners:t,oneDriveUrl:r})}withPropertyBag(e){return this.currentUserRelationToGroup=e.currentUserRelationToGroup,this.creationOptions=e.creationOptions||[],this.owners=e.owners||[],this.endpoints=e.endpoints||[],this.id=e.id,this.oneDriveUrl=e.oneDriveUrl||null,this}withUserRelationToGroup(e){return this.currentUserRelationToGroup=e,this}withLocallyUniqueId(){return this.id=h.o.generate(),this}constructor(){this.currentUserRelationToGroup=u.N.NonMember,this.id=""}}var g=n(33268);class m{static get builder(){return new p}toWebSerializable(){const e=this.owners.map(e=>e.toWebSerializable());return{CreationOptions:this.creationOptions,CurrentUserRelationToGroup:this.currentUserRelationToGroup,Endpoints:this.endpoints,Id:this.id,Owners:e,OneDriveUrl:this.oneDriveUrl}}isFullyProvisioned(){return this.isSharePointProvisioned()}isSharePointProvisioned(){return!!this.oneDriveUrl}isYammerGroup(){return a()(this.creationOptions,"YammerProvisioning")}getSharepointDomainUrl(){const e=this.oneDriveUrl;return e?"https://"+g.wS.extractHostname(e):null}getWorkloadUrl(e){switch(o.P[e]){case o.P.Yammer:if(this.isYammerGroup()){var t;const e=i()(this.endpoints,e=>"Yammer"===e.ServiceName);return null!==(t=null===e||void 0===e?void 0:e.ServiceEndpointUri)&&void 0!==t?t:""}return"";case o.P.Documents:return this.oneDriveUrl;case o.P.Calendar:case o.P.Conversations:case o.P.Notebook:case o.P.People:default:return null}}constructor(e){this.creationOptions=e.creationOptions,this.currentUserRelationToGroup=e.currentUserRelationToGroup,this.endpoints=e.endpoints,this.id=e.id,this.owners=e.owners,this.oneDriveUrl=e.oneDriveUrl}}},6618:(e,t,n)=>{"use strict";n.d(t,{e:()=>h});var r=n(65804),i=n(56851),s=n(65043),a=n(89379),o=n(17066),l=n(28553),c=(0,a.Z)(),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.message,n=e.styles,r=e.as,a=void 0===r?"div":r,d=e.className,u=c(n,{className:d});return s.createElement(a,(0,i.__assign)({role:"status",className:u.root},(0,o.G1)(this.props,o.JM,["className"])),s.createElement(l.P,null,s.createElement("div",{className:u.screenReaderText},t)))},t.defaultProps={"aria-live":"polite"},t}(s.Component),u=n(52195),h=(0,r.I)(d,function(e){return{root:e.className,screenReaderText:u.dX}},void 0,{scope:"Announced"})},7304:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var r=n(75992);class i extends r.r{loggingData(){var e,t;return{sessionId:this.session.id,groupId:this.session.groupId,itemId:String(this.session.itemId),itemSize:String(this.session.itemSize),bytesSent:String(this.session.bytesSent),expirationTime:null!=this.session.expirationDateTime?this.session.expirationDateTime.toString():"null",hasWebUrl:String(!!this.session.webUrl),nextExpectedRanges:null!==(e=null===(t=this.session.nextExpectedRanges)||void 0===t?void 0:t.toString())&&void 0!==e?e:""}}constructor(e){super(i.actionType),this.session=e}}i.actionType="PLW_UPLOAD_BYTES_TO_SESSION_SUCCEEDED"},7691:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LoopPlanner:()=>oc,loopExport:()=>lc});var r=n(27051),i=n(40656),s=n(75368),a=n(38954),o=n(33788),l=n(83125),c=n(65317),d=n(52059);var u=n(42455),h=n(96623),p=n(70579),g=n(65043),m=n(97950),f=n(39888),v=n(21161),y=n(15507),k=n(77508),T=n(43746),S=n(81622);var b=n(52668),I=n(79889),C=n.n(I),D=n(91834),E=n(78332);class P{}P.LimitSecondsSinceLastTaskFetch=120,P.TaskAnimationDelay=5e3;var w=n(7811),x=n(42870),A=n(10912),F=n(98656),L=n(40488),_=n(57433),U=n(44388),O=n(70149);const B=()=>(0,O.L)(()=>Promise.all([n.e(26922),n.e(46441),n.e(57365),n.e(7670),n.e(76115),n.e(22514),n.e(12777),n.e(17323),n.e(93818)]).then(n.bind(n,16841))).then(e=>({default:e.PlanTaskBoardPage})),M=(0,g.lazy)(B);var N=n(64226),R=n(937);const G=()=>(0,O.L)(()=>n.e(83069).then(n.bind(n,56921))).then(e=>({default:e.NotificationBar})),W=(0,g.lazy)(G);var z=n(4648);class j extends R.F{name(){return"NotificationBarContainer"}renderComponent(){const e=this.props.notificationStore.getNotificationId();return g.createElement("div",{className:(0,z.A)("errorBar",{hidden:null==e})},null!=e&&g.createElement(g.Suspense,{fallback:g.createElement(g.Fragment,null)},g.createElement(W,{onDismiss:e===N.fc.GoneOffline?void 0:this.onDismiss,messageType:this.props.notificationStore.getMessageType(),notificationId:e,statusCode:this.props.notificationStore.getStatusCode(),statusText:this.props.notificationStore.getStatusText(),entityId:this.props.notificationStore.getEntityId(),stringParams:this.props.notificationStore.getStringParams(),correlationId:this.props.notificationStore.getCorrelationId(),timeStamp:this.props.notificationStore.getTimeStamp(),getBucket:this.props.bucketStore.getBucket.bind(this.props.bucketStore),getPlan:this.props.planStore.getPlan.bind(this.props.planStore),getTask:this.props.taskStore.getTask.bind(this.props.taskStore),getUser:this.props.userStore.getUserById.bind(this.props.userStore),theme:this.props.appContextStore.getCurrentTheme()})))}constructor(e,t){super(e,t),this.onDismiss=async()=>{const e=await this.props.notificationActionCreatorProvider();e.clearNotifications.bind(e)()},this.state={}}}const K=()=>(0,O.L)(()=>Promise.resolve().then(n.bind(n,75559))).then(e=>({default:e.ComponentErrorPage})),H=(0,g.lazy)(K),V=()=>(0,O.L)(()=>Promise.all([n.e(26922),n.e(92970),n.e(34167),n.e(46441),n.e(57365),n.e(76115),n.e(22514),n.e(40135),n.e(12777),n.e(7509),n.e(24901)]).then(n.bind(n,8007))).then(e=>({default:e.LoopAppDialog})),Z=(0,g.lazy)(V);var q=n(17920),Y=n(38752),J=n(96481),X=n(8122),$=n(75992),Q=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(e){function t(n,r){var i=e.call(this,t.type)||this;return i.pageName=n,i.appStartTime=r,i}return Q(t,e),t.prototype.loggingData=function(){return{pageName:this.pageName}},t.type="APP_START",t}($.r),te=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ne=function(e){function t(n,r,i,s,a){var o=e.call(this,t.type)||this;return o.dataFetchStartTime=n,o.dataFetchEndTime=r,o.exportName=i,o.metaTag=s,o.extraData=a,o}return te(t,e),t.prototype.getExportName=function(){return this.exportName},t.type="PAGE_READY",t}($.r),re=n(51171),ie=function(){function e(e){this.dispatcher=e}return e.prototype.appStart=function(e,t){if(null==e)throw new re.L("pageName");if(null==t)throw new re.L("appStartTime");this.dispatcher.dispatchAction(new ee(e,t))},e.prototype.pageReady=function(e,t,n,r,i){if(null==e)throw new re.L("dataFetchStart");if(null==t)throw new re.L("dataFetchEnd");this.dispatcher.dispatchAction(new ne(e,t,n,r,i))},e}(),se=n(95952),ae=n(91181),oe=n(87952),le=n(82025),ce=n(18647),de=n(32934),ue=n(51857),he=n(60653),pe=n(71964),ge=n(26260),me=n(97498),fe=n(29274),ve=n(74427),ye=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ke=function(e){function t(n){var r=e.call(this,t.type)||this;return r.id=n,r}return ye(t,e),t.prototype.loggingData=function(){return{id:this.id}},t.type="CLEAR_TRANSACTION",t}($.r),Te=n(57860),Se=n(47204),be=n(219),Ie=n(15806),Ce=n(33745),De=n(42105),Ee=n.n(De),Pe=n(17478),we=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xe=function(e){function t(t,n,r){void 0===t&&(t=32);var i=e.call(this)||this;return i.keyQueue=[],i.sizeLimit=Math.max(t,2),i.shouldLockItem=n,i.onRemoved=r,i}return we(t,e),t.prototype.set=function(t,n){e.prototype.set.call(this,t,n),this.maintainSize(t),this.shouldLockItem&&this.shouldLockItem(e.prototype.get.call(this,t))?this.lockItem(t):this.enqueueNewKey(t)},t.prototype.remove=function(t){Ee()(this.keyQueue,function(e){return e===t}),e.prototype.remove.call(this,t)},t.prototype.clear=function(){e.prototype.clear.call(this),this.keyQueue=[]},t.prototype.lockItem=function(e){Ee()(this.keyQueue,function(t){return t===e})},t.prototype.maintainSize=function(t){for(;this.count()>this.sizeLimit;){var n=this.keyQueue[0];if(!n||t===n)throw new Error("No suitable removal was found");var r=this.internalStorage[n];e.prototype.remove.call(this,n),this.onRemoved&&this.onRemoved(r)}},t.prototype.enqueueNewKey=function(e){Ee()(this.keyQueue,function(t){return t===e}),this.keyQueue.push(e)},t}(Pe.$),Ae=n(38921),Fe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Le=function(e){function t(t){void 0===t&&(t=100);var n=e.call(this)||this;return n.transactionContainer=new Ie.j(new xe(t,n.shouldLockItem)),n}return Fe(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"TransactionStore"},enumerable:!1,configurable:!0}),t.prototype.getTransaction=function(e){return this.transactionContainer.getItem(e)},t.prototype.handleAction=function(e){switch(e.type){case fe.S.type:this.handleBeginTransaction(e),this.publishStoreChangedEvent();break;case ve.D.type:this.handleCancelTransaction(e.id,e.additionalData),this.publishStoreChangedEvent();break;case ke.type:this.handleClearTransaction(e),this.publishStoreChangedEvent();break;case Te.M.type:this.handleTransactionSucceeded(e),this.publishStoreChangedEvent();break;case Se.Y.type:this.handleTransactionFailed(e),this.publishStoreChangedEvent()}},t.prototype.handleBeginTransaction=function(e){var t={name:e.name,id:e.id,additionalData:e.additionalData,status:be.x.Pending};this.transactionContainer.setItem(t.id,t)},t.prototype.handleCancelTransaction=function(e,t){var n=this.transactionContainer.getItem(e);if(!n)throw new Ae.v("TransactionStore: Tried to mark a transaction with id "+e+" as cancelled but the transaction did not exist.\n                Did you forget to fire the BeginTransactionAction?");n.additionalData=t,n.status=be.x.Cancelled,this.transactionContainer.setItem(n.id,n),this.transactionContainer.updateModifiedDate(n.id)},t.prototype.handleClearTransaction=function(e){this.transactionContainer.removeItem(e.id)},t.prototype.handleTransactionSucceeded=function(e){var t=this.transactionContainer.getItem(e.id);if(!t)throw new Ae.v("TransactionStore: Tried to mark a transaction with id "+e.id+" as succeeded but the transaction did not exist.\n                Did you forget to fire the BeginTransactionAction?");t.additionalData=e.additionalData,t.status=be.x.Succeeded,this.transactionContainer.setItem(t.id,t),this.transactionContainer.updateModifiedDate(t.id)},t.prototype.handleTransactionFailed=function(e){var t=this.transactionContainer.getItem(e.id);if(!t)throw new Ae.v("TransactionStore: Tried to mark a transaction with id "+e.id+" as failed but the transaction did not exist.\n                Did you forget to fire the BeginTransactionAction?");t.error=e.errorMessage,t.additionalData=e.additionalData,t.status=be.x.Failed,this.transactionContainer.setItem(t.id,t),this.transactionContainer.updateModifiedDate(t.id)},t.prototype.shouldLockItem=function(e){if(!e||!e.item)return!1;switch(e.item.status){case be.x.Pending:return!0;case be.x.Cancelled:case be.x.Failed:case be.x.Succeeded:return!1}return!1},t}(Ce.z),_e=n(13736),Ue=n(67578),Oe=n(13374),Be=n(23881),Me=n(70515),Ne=n(12396),Re=n(31415),Ge=n(95783),We=n(19853),ze=n.n(We),je=n(96891),Ke=n(45078);class He extends Ce.z{get name(){return"PlannerDiffSyncStore"}getDiffSyncToken(){return this.diffSyncToken}getLastDiffSyncFeed(){return this.lastDiffSyncFeed}getLastDiffSyncTimestamp(){return this.lastDiffSyncFeedFetchTimestamp}isDiffSyncDisabled(){return this.isDisabled}isDiffSyncRequestScheduled(){return this.isRequestScheduled}getNumDiffsInLastFetch(){return this.numDiffsInLastFetch}isInErrorState(){return this.inErrorState}handleAction(e){let t=!1;switch(e.type){case _e.K.actionType:t=this.handleDiffSyncFetchScheduledAction(e);break;case Ue.s.actionType:t=this.handleDiffSyncFeedFetchFailure(e);break;case Oe.Y.actionType:t=this.handleDiffSyncFeedFetchSuccess(e);break;case Be.h.actionType:t=this.handleDiffSyncTokenFetchSuccess(e);break;case Me.r.actionType:t=this.handleDisableDiffSync(e);break;case Ne.q.actionType:t=this.handleEnableDiffSync(e);break;case Re.c.actionType:t=this.resetDiffSyncBackoff();break;default:return}t&&this.publishStoreChangedEvent()}handleDiffSyncFetchScheduledAction(e){return!this.isRequestScheduled&&(this.isRequestScheduled=!0,!0)}handleDiffSyncFeedFetchFailure(e){var t;let n=!1;this.isRequestScheduled&&(this.isRequestScheduled=!1,n=!0);(null==this.lastDiffSyncFeedFetchTimestamp?null:this.lastDiffSyncFeedFetchTimestamp.valueOf())!==(null==e.timestamp?null:e.timestamp.valueOf())&&(this.lastDiffSyncFeedFetchTimestamp=e.timestamp,n=!0);const r=null===(t=e.response)||void 0===t?void 0:t.status;return r!==Ke.oT.SyncPointUnknown&&r!==Ge.t3.Gone||(this.loggers.usageLogger.logData(je.M.DiffSyncStore,je.M.DiffSyncCookieExpiredError),null!=this.diffSyncToken&&(this.diffSyncToken=null,n=!0)),r===Ge.t3.TooManyRequests||r===Ge.t3.BadGateway||r===Ge.t3.ServiceUnavailable||r===Ge.t3.GatewayTimeout?this.inErrorState||(this.inErrorState=!0,n=!0):this.inErrorState&&(this.inErrorState=!1,n=!0),n}handleDiffSyncFeedFetchSuccess(e){let t=!1;this.inErrorState&&(this.inErrorState=!1,t=!0),this.isRequestScheduled&&(this.isRequestScheduled=!1,t=!0);return(null==this.lastDiffSyncFeedFetchTimestamp?null:this.lastDiffSyncFeedFetchTimestamp.valueOf())!==(null==e.timestamp?null:e.timestamp.valueOf())&&(this.lastDiffSyncFeedFetchTimestamp=e.timestamp,t=!0),this.diffSyncToken!==e.diffSyncFeed.nextToken&&(this.diffSyncToken=e.diffSyncFeed.nextToken,t=!0),this.numDiffsInLastFetch!==e.diffSyncFeed.updates.length&&(this.numDiffsInLastFetch=e.diffSyncFeed.updates.length,t=!0),ze()(this.lastDiffSyncFeed,e.diffSyncFeed)||(this.lastDiffSyncFeed=e.diffSyncFeed,t=!0),t}handleDiffSyncTokenFetchSuccess(e){return this.diffSyncToken!==e.diffSyncToken&&(this.diffSyncToken=e.diffSyncToken,!0)}handleDisableDiffSync(e){return!this.isDisabled&&(this.isDisabled=!0,!0)}handleEnableDiffSync(e){return!!this.isDisabled&&(this.isDisabled=!1,!0)}resetDiffSyncBackoff(){return this.numDiffsInLastFetch=-1,!0}constructor(e,t){super(),this.loggers=t,this.diffSyncToken=e,this.isDisabled=!1,this.isRequestScheduled=!1,this.lastDiffSyncFeed=null,this.lastDiffSyncFeedFetchTimestamp=null,this.numDiffsInLastFetch=-1,this.inErrorState=!1}}var Ve=n(98899),Ze=n(2423),qe=n(58355);class Ye extends $.r{constructor(e){super(Ye.actionType),this.canConvert=e}}Ye.actionType="PLW_GET_PLAN_CONVERSION_PERMISSIONS_SUCCEEDED";var Je=n(93593),Xe=n(93407),$e=n(14070),Qe=n(54205),et=n(71794),tt=n(62076),nt=n(99244);class rt extends $.r{loggingData(){return{planId:this.plan.id,bucketCount:String(this.buckets.length),taskCount:String(this.tasks.length),isLastPage:String(this.isLastPage)}}constructor(e,t,n,r){super(rt.actionType),this.plan=e,this.buckets=t,this.tasks=n,this.tasksContinuationToken=r,this.isLastPage=null==r}}rt.actionType="PLW_PREFETCH_PLAN_DATA_SUCCEEDED";var it=n(97792),st=n(51522),at=n(81576),ot=n(69632),lt=n(43068),ct=n(45498),dt=n(87337),ut=n(94600),ht=n(27921),pt=n(32185),gt=n(77992),mt=n(5062);class ft extends $.r{loggingData(){return{roadmap:JSON.stringify(this.userFeatureEntitlements.roadmap),modernProject:JSON.stringify(this.userFeatureEntitlements.premiumPlan),projectOnline:JSON.stringify(this.userFeatureEntitlements.projectOnline),projectOperations:JSON.stringify(this.userFeatureEntitlements.projectOperations)}}constructor(e){super(ft.actionType),this.userFeatureEntitlements=e}}ft.actionType="PLW_GET_USER_FEATURE_ENTITLEMENTS_SUCCEEDED";var vt,yt,kt=n(60878),Tt=n(15434),St=n(54456),bt=n(73360),It=n(65818),Ct=n(75886),Dt=n(11079);!function(e){e.title="Title",e.percentComplete="PercentComplete",e.assignment="Assignment",e.dueDate="DueDate",e.priority="Priority",e.startDate="StartDate"}(vt||(vt={})),function(e){e.ToComplete="ToComplete",e.ToNotComplete="ToNotComplete"}(yt||(yt={}));function Et(e,t){for(const n of e)if(n.type===t)return 0===n.Modifiers.length;return!1}class Pt{build(){return new wt(this)}fromWebResource(e){return this.withPropertyBag({canComment:!0,canCopy:!0,canEdit:!0,canMove:!0,canUploadFiles:!0,canAssign:!Et(e.rules,vt.assignment),canDelete:!0,checklistPermissions:Ct.j.DisableNone,canEditDescription:!0,canEditTitle:!Et(e.rules,vt.title),canUpdateDueDate:!Et(e.rules,vt.dueDate),canUpdatePriority:!Et(e.rules,vt.priority),canUpdatePriorityToUrgent:!Et(e.rules,vt.priority),canUpdateProgress:!Et(e.rules,vt.percentComplete),canUpdateAppliedLabels:!0,canUpdateBucket:!0,canUpdateStartDate:!Et(e.rules,vt.startDate),canUpdateRecurrence:!0,canUpdatePreviewType:!0,attachmentPermissions:Dt.I.DisableNone})}fromGraphResource(e){return this.fromWebResource(e)}getDiffDataFromWebResource(e,t){throw new Error("Method not implemented.")}getDiffDataFromGraphResource(e,t){throw new Error("Method not implemented.")}withPropertyBag(e){var t,n,r,i,s,a;return this.canComment=null!=e.canComment?e.canComment:this.canComment,this.canCopy=null!=e.canCopy?e.canCopy:this.canCopy,this.canEdit=null!=e.canEdit?e.canEdit:this.canEdit,this.canMove=null!=e.canMove?e.canMove:this.canMove,this.canUploadFiles=null!=e.canUploadFiles?e.canUploadFiles:this.canUploadFiles,this.canAssign=null!=e.canAssign?e.canAssign:this.canAssign,this.canDelete=null!=e.canDelete?e.canDelete:this.canDelete,this.checklistPermissions=null!=e.checklistPermissions?e.checklistPermissions:this.checklistPermissions,this.canEditDescription=null!=e.canEditDescription?e.canEditDescription:this.canEditDescription,this.canEditTitle=null!=e.canEditTitle?e.canEditTitle:this.canEditTitle,this.canUpdateDueDate=null!=e.canUpdateDueDate?e.canUpdateDueDate:this.canUpdateDueDate,this.canUpdatePriority=null!=e.canUpdatePriority?e.canUpdatePriority:this.canUpdatePriority,this.canUpdatePriorityToUrgent=null!=e.canUpdatePriorityToUrgent?e.canUpdatePriorityToUrgent:this.canUpdatePriorityToUrgent,this.canUpdateProgress=null!==(t=e.canUpdateProgress)&&void 0!==t?t:this.canUpdateProgress,this.canUpdateAppliedLabels=null!==(n=e.canUpdateAppliedLabels)&&void 0!==n?n:this.canUpdateAppliedLabels,this.canUpdateBucket=null!==(r=e.canUpdateBucket)&&void 0!==r?r:this.canUpdateBucket,this.canUpdateStartDate=null!==(i=e.canUpdateStartDate)&&void 0!==i?i:this.canUpdateStartDate,this.canUpdateRecurrence=null!==(s=e.canUpdateRecurrence)&&void 0!==s?s:this.canUpdateRecurrence,this.canUpdatePreviewType=null!==(a=e.canUpdatePreviewType)&&void 0!==a?a:this.canUpdatePreviewType,this.attachmentPermissions=null!=e.attachmentPermissions?e.attachmentPermissions:this.attachmentPermissions,this}constructor(){this.canComment=!0,this.canCopy=!0,this.canEdit=!0,this.canMove=!0,this.canUploadFiles=!0,this.canAssign=!0,this.canDelete=!0,this.checklistPermissions=Ct.j.DisableNone,this.canEditDescription=!0,this.canEditTitle=!0,this.canUpdateDueDate=!0,this.canUpdatePriority=!0,this.canUpdatePriorityToUrgent=!0,this.canUpdateProgress=!0,this.canUpdateAppliedLabels=!0,this.canUpdateBucket=!0,this.canUpdateStartDate=!0,this.canUpdateRecurrence=!0,this.canUpdatePreviewType=!0,this.attachmentPermissions=Dt.I.DisableNone}}class wt{static get builder(){return new Pt}constructor(e){this.canComment=e.canComment,this.canCopy=e.canCopy,this.canEdit=e.canEdit,this.canMove=e.canMove,this.canUploadFiles=e.canUploadFiles,this.canAssign=e.canAssign,this.canDelete=e.canDelete,this.checklistPermissions=e.checklistPermissions,this.canEditDescription=e.canEditDescription,this.canEditTitle=e.canEditTitle,this.canUpdateDueDate=e.canUpdateDueDate,this.canUpdatePriority=e.canUpdatePriority,this.canUpdatePriorityToUrgent=e.canUpdatePriorityToUrgent,this.canUpdateProgress=e.canUpdateProgress,this.canUpdateAppliedLabels=e.canUpdateAppliedLabels,this.canUpdateBucket=e.canUpdateBucket,this.canUpdateStartDate=e.canUpdateStartDate,this.canUpdateRecurrence=e.canUpdateRecurrence,this.canUpdatePreviewType=e.canUpdatePreviewType,this.attachmentPermissions=e.attachmentPermissions}}var xt=n(44430),At=n(75252),Ft=n(76241),Lt=n(67188),_t=n(55491),Ut=n.n(_t),Ot=n(54320),Bt=n.n(Ot),Mt=n(86178),Nt=n.n(Mt);var Rt=n(74844),Gt=n(38989);class Wt extends Ce.z{get name(){return"PlannerPermissionsStore"}getTaskPermissions(e,t){var n;if(this.currentUsageMode===E.BH.Readonly||null!==t&&void 0!==t&&t.isArchived)return this.buildAndMemoizeTaskPermissionsObject(!1,!1,Ct.j.DisableAll,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,Dt.I.DisableAll);if(e.isProjectTask())return this.getProjectTaskPermissions(e);if(e.isAppPoweredTask())return this.getAppPoweredTaskPermissions();if(null==t)return this.buildAndMemoizeTaskPermissionsObject(!0,!0,Ct.j.DisableNone,!0,!0,!0,!0,!0,!0,!0,!0,!1,!1,!0,!0,!0,!0,!0,!0,Dt.I.DisableNone);if(e.planId!==t.id)throw new Error("ArgumentError: task planId does not match the given plan's id");let r=!0,i=!0,s=Ct.j.DisableNone,a=!0,o=!0,l=!0,c=!0,d=!0,u=!0,h=!0,p=!0,g=!0,m=!0,f=!0,v=!0,y=!0,k=!0,T=!0,S=!0,b=Dt.I.DisableNone;const I=this.canAccessPlan(t),C=null!=e.assignments[Y.B.currentUserId];I||(r=C,i=!1,s=C?Ct.j.DisableNone:Ct.j.DisableAll,a=C,o=C,l=C,c=C,d=C,u=C,h=C,f=C,v=C,y=C,k=C,T=C,S=C,b=C?Dt.I.DisableNone:Dt.I.DisableAll);const D=null===(n=e.creationSource)||void 0===n?void 0:n.publication;if(null!=D){var P;p=!1,g=!1,T=!1;const e=null===(P=this.containerPermissions[D.id])||void 0===P||null===(P=P[t.container.externalId])||void 0===P?void 0:P.containerPermissions;if(null!=e)r=r&&e.canAssign,i=i&&e.canDelete,s|=e.checklistPermissions,a=a&&e.canEditDescription,o=o&&e.canEditTitle,l=l&&e.canUpdateDueDate,c=c&&e.canUpdatePriority,d=d&&e.canUpdatePriorityToUrgent,f=f&&e.canUpdateProgress,v=v&&e.canUpdateAppliedLabels,y=y&&e.canUpdateBucket,k=k&&e.canUpdateStartDate,T=T&&e.canUpdateRecurrence,S=S&&e.canUpdatePreviewType,b|=e.attachmentPermissions;else{i=!1;s=Y.B.isUnoContext?Ct.j.DisableDelete|Ct.j.DisableEditTitle|Ct.j.DisablePromote|Ct.j.DisableReorder|Ct.j.DisableCreate:s}}const w=this.getContainerCapabilities(t.container.containerType);return u=u&&w.canEdit,m=m&&w.canUploadFiles,g=g&&w.canMoveTasks,h=h&&w.canComment,p=p&&w.canCopyTasks,this.userPolicies&At.x.CannotDeleteTasksNotCreatedBySelf&&(i=i&&e.createdBy===Y.B.currentUserId),this.buildAndMemoizeTaskPermissionsObject(r,i,s,a,o,l,c,d,u,h,p,g,m,f,v,y,k,T,S,b)}getDefaultPlanPermissions(){return this.currentUsageMode===E.BH.Readonly?this.buildAndMemoizePlanPermissionsObject(!1,!1,!1,!1,!1,!1,!1,!1):this.buildAndMemoizePlanPermissionsObject()}getPlanPermissions(e){if(this.currentUsageMode===E.BH.Readonly||e.isArchived)return this.buildAndMemoizePlanPermissionsObject(!1,!1,!1,!1,!1,!1,!1,!1);if(e.isProjectPlan())return this.buildAndMemoizePlanPermissionsObject(!1,!1,!1,!1,!0,!1,!1,!1);const t=this.getContainerCapabilities(e.container.containerType),n=this.canAccessPlan(e);return this.buildAndMemoizePlanPermissionsObject(t.canAcceptTasks&&n,t.canAddTasks&&n,t.canCopyPlan&&n,t.canDelete&&n,t.canEdit&&n,!0,!0,t.canEdit&&n)}getBucketPermissions(e){return this.currentUsageMode===E.BH.Readonly?this.buildAndMemoizeBucketPermissionsObject(!1,!1):this.buildAndMemoizeBucketPermissionsObject(!0,!0)}getUserPermissions(){return this.currentUsageMode===E.BH.Readonly?this.buildAndMemoizeUserPermissionsObject(!1,!1,!1):this.buildAndMemoizeUserPermissionsObject(!0,this.canAddGuests(),this.canCreateGroup())}getDefaultContainerPermissions(e){let t=!0;var n;(null===e||void 0===e?void 0:e.containerType)===It.K.Roster&&(t=null===(n=this.containerIdToIsMemberMapping[e.externalId])||void 0===n||n);return this.buildAndMemoizeContainerPermissionsObject(!1,!1,t)}getContainerPermissions(e){let t=!0,n=!0;var r,i;e.containerType===It.K.Roster&&(t=null===(r=this.containerIdToIsMemberMapping[e.externalId])||void 0===r||r,n=null===(i=this.containerIdToIsMemberMapping[e.externalId])||void 0===i||i);if(this.currentUsageMode===E.BH.Readonly)return this.buildAndMemoizeContainerPermissionsObject(!1,!1,t,!1);let s=!1,a=!1;if(this.getContainerCapabilities(e.containerType).canModifyMembership)if(e.containerType===It.K.Group){const t=e;null!=t.unifiedGroupDetails&&(a=t.unifiedGroupDetails.currentUserRelationToGroup===xt.N.Owner,s=Y.B.isGuestUser||t.unifiedGroup.visibility!==Ft.X.Public?t.unifiedGroupDetails.currentUserRelationToGroup===xt.N.Owner:t.unifiedGroupDetails.currentUserRelationToGroup===xt.N.Owner||t.unifiedGroupDetails.currentUserRelationToGroup===xt.N.Member)}else if(e.containerType===It.K.Roster){var o,l;s=null===(o=this.containerIdToIsMemberMapping[e.externalId])||void 0===o||o,a=null===(l=this.containerIdToIsMemberMapping[e.externalId])||void 0===l||l}else e.containerType===It.K.User?(s=!0,a=!1):(s=!0,a=!0);else e.containerType===It.K.User&&(s=!0,a=!1);return this.buildAndMemoizeContainerPermissionsObject(s,a,t,n)}getCurrentUsageMode(){return this.currentUsageMode}getExpiredPermissionsInfo(){const e=Nt()(),t=[];for(const n in this.containerPermissions)for(const r in this.containerPermissions[n]){this.containerPermissions[n][r].expiry.isBefore(e)&&t.push({containerId:r,publicationId:n})}return t}getExpiredTaskPermissionsInfo(){const e=Nt()(),t=[];for(const n in this.memoizedTaskPermissions){this.memoizedTaskPermissions[n].expiry.isBefore(e)&&t.push(n)}return t}getPremiumPlanFeatureEntitlements(){return this.userPremiumPlanFeatureEntitlements}arePermissionsMissingOrExpired(e,t){var n;const r=Nt()(),i=null===(n=this.containerPermissions[t])||void 0===n||null===(n=n[e])||void 0===n?void 0:n.expiry;return null==i||i.isBefore(r)}areTaskPermissionsMissingOrExpired(e){var t;const n=Nt()(),r=null===(t=this.memoizedTaskPermissions[e])||void 0===t?void 0:t.expiry;return null==r||r.isBefore(n)}canAccessICalendar(e){if(e.containerType===It.K.User)return!0;if(e.containerType===It.K.Group){var t;if((null===e||void 0===e||null===(t=e.unifiedGroupDetails)||void 0===t?void 0:t.currentUserRelationToGroup)===xt.N.Owner)return!0}return!1}handleAction(e){let t=!1;switch(e.type){case it.x.actionType:t=this.handleSetUsageModeAction(e);break;case ct.T.actionType:const n=e;t=this.handleGroupPlanResolutionSuccess(n);break;case mt.f.actionType:t=this.handleContainerPlanResolutionSuccess(e);break;case Je.Y.actionType:const r=e;t=this.handleDeletePlan(r.planId);break;case Ve.l.actionType:const i=e;t=this.handleDeletePlan(i.planId);break;case dt.s.actionType:t=this.handleDeleteUnifiedGroupSucceededAction(e);break;case Xe.A.actionType:const s=e;t=this.handleMultiplePlanFetch(s.plans);break;case $e.N.actionType:const a=e;t=this.handleMultiplePlanFetch(a.plans);break;case Qe.O.actionType:const o=e;t=this.ensureMappingInStore(o.planEntitySet.plan.container.externalId,o.planEntitySet.id);break;case et.$.actionType:const l=e;t=this.ensureMappingInStore(l.planEntitySet.plan.container.externalId,l.planEntitySet.id);break;case rt.actionType:const c=e;t=this.ensureMappingInStore(c.plan.plan.container.externalId,c.plan.id);break;case tt.V.actionType:const d=e;t=this.removeMappingInStore(d.planEntitySet.id);break;case nt.t.actionType:const u=e;t=this.updateMappingInStore(u.planEntitySet.plan.container.externalId,u.localId,u.planEntitySet.id);break;case ut.P.actionType:t=this.handleGetUnifiedGroupDetailsSucceededAction(e);break;case pt.w.actionType:t=this.handleJoinUnifiedGroupSucceededAction(e);break;case gt.v.actionType:t=this.handleLeaveUnifiedGroupSucceededAction(e);break;case st.D.actionType:t=this.handleToggleFlight(e);break;case lt.Q.actionType:t=this.handleGetTenantGroupSettings(e);break;case ht.M.actionType:t=this.handleCheckCurrentUserToGroupsMembershipsSucceededAction(e);break;case qe.D.actionType:t=this.handleBatchGetContainerPermissionsSucceededAction(e);break;case Ze.z.actionType:this.userPolicies=e.userDetails.userPolicies;break;case ot.f.actionType:t=this.handleBatchGetTaskPermissionsSucceededAction(e);break;case at.R.actionType:t=this.handleBatchGetTaskPermissionsFailedAction(e);break;case kt.L.actionType:t=this.handleGetContainerSucceededAction(e);break;case Tt.x.actionType:t=this.handleGetContainerFailedAction(e);break;case St.v.actionType:t=this.handleGetDriveItemSucceededAction(e);break;case bt.N.actionType:t=this.handleGetDriveItemFailedAction(e);break;case ft.actionType:t=this.handleGetUserFeatureEntitlementsSucceededAction(e);break;case Ye.actionType:t=this.handleGetPlanConversionPermissionsSucceededAction(e);break;default:return}t&&this.publishStoreChangedEvent()}canAccessPlanViaHostContainer(e){var t;const n=this.planToContainerMapping[e.id];return null==n||(null===(t=this.containerIdToIsMemberMapping[n])||void 0===t||t)}canConvertBasicToPremiumPlan(){return this.canConvertBasicPlanToPremiumPlan}hasWriteAccessToPremiumPlan(){var e;const t=null===(e=this.userPremiumPlanFeatureEntitlements)||void 0===e?void 0:e.premiumPlan;return(null===t||void 0===t?void 0:t.accessType)===Lt.HX.readWrite}canAccessPlan(e){const t=this.canAccessPlanViaHostContainer(e),n=this.canAccessPlanViaSharedContainers(e.sharedWithContainers);return t||n}handleBatchGetTaskPermissionsFailedAction(e){let t=!1;return e.rejectedEquivalenceSetIds.forEach(e=>{if(!this.memoizedTaskPermissions[e]){const n={equivalenceSetId:e,taskPermissions:wt.builder.withPropertyBag({canComment:!1,canCopy:!1,canEdit:!1,canMove:!1,canUploadFiles:!1,canAssign:!1,canDelete:!1,checklistPermissions:Ct.j.DisableAll,canEditDescription:!1,canEditTitle:!1,canUpdateDueDate:!1,canUpdatePriority:!1,canUpdatePriorityToUrgent:!1,canUpdateProgress:!0,canUpdateAppliedLabels:!1,canUpdateBucket:!1,canUpdateStartDate:!1,canUpdateRecurrence:!1,canUpdatePreviewType:!1,attachmentPermissions:Dt.I.DisableAll}).build(),expiry:Nt()(0)};this.storeTaskPermissionsInfo(n),t=!0}}),t}handleBatchGetTaskPermissionsSucceededAction(e){return e.taskPermissionsSets.forEach(e=>{this.storeTaskPermissionsInfo(e)}),!0}storeTaskPermissionsInfo(e){return this.memoizedTaskPermissions[e.equivalenceSetId]=e,!0}handleBatchGetContainerPermissionsSucceededAction(e){return e.permissionsSets.forEach(e=>{this.storeContainerPermissionsInfo(e)}),!0}storeContainerPermissionsInfo(e){return null==this.containerPermissions[e.publicationId]&&(this.containerPermissions[e.publicationId]={}),this.containerPermissions[e.publicationId][e.containerId]=e,!0}handleCheckCurrentUserToGroupsMembershipsSucceededAction(e){const{requestGroupIds:t,returnedGroupIds:n}=e;return null!=this.tenantGroupSettings&&t.indexOf(this.tenantGroupSettings.GroupIdForMembershipChecking)>-1&&(this.tenantGroupSettings.handleCheckMembershipResponse(n.indexOf(this.tenantGroupSettings.GroupIdForMembershipChecking)>-1),!0)}handleSetUsageModeAction(e){return this.currentUsageMode!==e.usageMode&&(this.currentUsageMode=e.usageMode,!0)}handleGroupPlanResolutionSuccess(e){let t=!1;for(const r in e.groupPlanMapping){var n;const i=null===(n=e.groupPlanMapping[r])||void 0===n?void 0:n.map(e=>e.id);i&&!Bt()(i)&&i.forEach(e=>{const n=this.planToContainerMapping[e];null!=n&&r===n||(this.planToContainerMapping[e]=r,t=!0)})}return t}handleContainerPlanResolutionSuccess(e){let t=!1;for(const r in e.containerPlanMapping){var n;const i=null===(n=e.containerPlanMapping[r])||void 0===n?void 0:n.map(e=>e.id);i&&!Bt()(i)&&i.forEach(e=>{const n=this.planToContainerMapping[e];null!=n&&r===n||(this.planToContainerMapping[e]=r,t=!0)})}return t}handleDeletePlan(e){return!!this.planToContainerMapping[e]&&(delete this.planToContainerMapping[e],!0)}handleMultiplePlanFetch(e){let t=!1;return Ut()(e,e=>{t=this.ensureMappingInStore(e.plan.container.externalId,e.id)||t}),t}ensureMappingInStore(e,t){let n=!1;return this.planToContainerMapping[t]!==e&&(this.planToContainerMapping[t]=e,n=!0),n}removeMappingInStore(e){return delete this.planToContainerMapping[e],!0}updateMappingInStore(e,t,n){return delete this.planToContainerMapping[t],this.planToContainerMapping[n]=e,!0}handleDeleteUnifiedGroupSucceededAction(e){let t=!1;for(const n in this.planToContainerMapping)this.planToContainerMapping[n]===e.container.externalId&&(delete this.planToContainerMapping[n],t=!0);return t}handleGetUnifiedGroupDetailsSucceededAction(e){const t=e.unifiedGroupDetails;if(null==t)return!1;const n=this.containerIdToIsMemberMapping[t.id],r=t.currentUserRelationToGroup!==xt.N.NonMember;return(null==n||n!==r)&&(this.containerIdToIsMemberMapping[t.id]=r,!0)}handleJoinUnifiedGroupSucceededAction(e){const t=this.containerIdToIsMemberMapping[e.containerId];return(null==t||!1===t)&&(this.containerIdToIsMemberMapping[e.containerId]=!0,!0)}handleLeaveUnifiedGroupSucceededAction(e){const t=this.containerIdToIsMemberMapping[e.containerId];return(null==t||!0===t)&&(this.containerIdToIsMemberMapping[e.containerId]=!1,!0)}handleToggleFlight(e){return null!=this.flights[e.flightKey]&&(this.flights[e.flightKey]=!this.flights[e.flightKey],!0)}handleGetTenantGroupSettings(e){return this.tenantGroupSettings=e.tenantGroupSettings,!0}handleGetContainerSucceededAction(e){const t=e.container;if(null==t)return!1;const n=this.containerIdToIsMemberMapping[t.externalId];return(null==n||!1===n)&&(this.containerIdToIsMemberMapping[t.externalId]=!0,!0)}handleGetContainerFailedAction(e){var t;if((null===(t=e.response)||void 0===t?void 0:t.status)===Ge.t3.Forbidden){const t=this.containerIdToIsMemberMapping[e.containerId];if(null==t||!0===t)return this.containerIdToIsMemberMapping[e.containerId]=!1,!0}return!1}handleGetDriveItemSucceededAction(e){return!0!==this.driveItemVroomIdToHasAccessMapping[e.vroomId]&&(this.driveItemVroomIdToHasAccessMapping[e.vroomId]=!0,!0)}handleGetDriveItemFailedAction(e){var t,n;if((null===(t=e.response)||void 0===t?void 0:t.status)===Ge.t3.Forbidden||(null===(n=e.response)||void 0===n?void 0:n.status)===Ge.t3.NotFound){if(!1!==this.driveItemVroomIdToHasAccessMapping[e.vroomId])return this.driveItemVroomIdToHasAccessMapping[e.vroomId]=!1,!0}return!1}handleGetUserFeatureEntitlementsSucceededAction(e){return this.userPremiumPlanFeatureEntitlements=e.userFeatureEntitlements,!0}handleGetPlanConversionPermissionsSucceededAction(e){return this.canConvertBasicPlanToPremiumPlan!==e.canConvert&&(this.canConvertBasicPlanToPremiumPlan=e.canConvert,!0)}canAddGuests(){return null!=this.tenantGroupSettings&&(this.tenantGroupSettings.allowToAddGuests&&!Y.B.isGuestUser)}canCreateGroup(){return!!Y.B.isTenantAdmin||(null!=this.tenantGroupSettings?Y.B.isGuestUser?this.tenantGroupSettings.allowGuestsToBeGroupOwner&&this.tenantGroupSettings.CanCurrentUserCreateGroup:this.tenantGroupSettings.CanCurrentUserCreateGroup:!Y.B.isGuestUser)}getProjectTaskPermissions(e){var t;const n=e.planId,r=null===(t=this.memoizedTaskPermissions[n])||void 0===t?void 0:t.taskPermissions;return this.buildAndMemoizeTaskPermissionsObject((null===r||void 0===r?void 0:r.canAssign)||!1,!1,Ct.j.DisableAll,!1,(null===r||void 0===r?void 0:r.canEditTitle)||!1,(null===r||void 0===r?void 0:r.canUpdateDueDate)||!1,(null===r||void 0===r?void 0:r.canUpdatePriority)||!1,(null===r||void 0===r?void 0:r.canUpdatePriorityToUrgent)||!1,!0,!1,!1,!1,!1,null===r||void 0===r?void 0:r.canUpdateProgress,!1,!1,(null===r||void 0===r?void 0:r.canUpdateStartDate)||!1,!1,!1,Dt.I.DisableAll)}getAppPoweredTaskPermissions(){return this.buildAndMemoizeTaskPermissionsObject(!1,!1,Ct.j.DisableAll,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,Dt.I.DisableAll)}canAccessPlanViaSharedContainers(e){return null!=e&&0!==e.length&&e.some(e=>e.containerType===It.K.DriveItem&&this.canAccessDriveItem(e.externalId))}canAccessDriveItem(e){var t;return null!=e&&0!==e.length&&(null===(t=this.driveItemVroomIdToHasAccessMapping[e])||void 0===t||t)}buildAndMemoizeUserPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=((e?1:0)|(t?1:0)<<1|(n?1:0)<<2).toString();if(null!=Wt.memoizedUserPermissions[r])return Wt.memoizedUserPermissions[r];const i={canEdit:e,canAddGuests:t,canCreateGroup:n};return Wt.memoizedUserPermissions[r]=i,i}buildAndMemoizeContainerPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=((e?1:0)|(t?1:0)<<1|(n?1:0)<<2|(r?1:0)<<3).toString();if(null!=Wt.memoizedContainerPermissions[i])return Wt.memoizedContainerPermissions[i];const s={canAddMembers:e,canRemoveMembers:t,canViewMembers:n,canChangeSensitivity:r};return Wt.memoizedContainerPermissions[i]=s,s}buildAndMemoizePlanPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];const l="".concat(((e?1:0)|(t?1:0)<<1|(n?1:0)<<2|(r?1:0)<<3|(i?1:0)<<4|(s?1:0)<<5|(a?1:0)<<6|(o?1:0)<<7).toString());if(null!=Wt.memoizedPlanPermissions[l])return Wt.memoizedPlanPermissions[l];const c={canAcceptTasks:e,canAddTasks:t,canCopy:n,canDelete:r,canEdit:i,canFavorite:s,canUpdateLabelDefinition:a,canAddBuckets:o};return Wt.memoizedPlanPermissions[l]=c,c}buildAndMemoizeBucketPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=((e?1:0)|(t?1:0)<<1).toString();if(null!=Wt.memoizedBucketPermissions[n])return Wt.memoizedBucketPermissions[n];const r={canEditTitle:e,canUpdateOrderHint:t};return Wt.memoizedBucketPermissions[n]=r,r}buildAndMemoizeTaskPermissionsObject(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ct.j.DisableNone,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],l=!(arguments.length>8&&void 0!==arguments[8])||arguments[8],c=!(arguments.length>9&&void 0!==arguments[9])||arguments[9],d=!(arguments.length>10&&void 0!==arguments[10])||arguments[10],u=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],h=!(arguments.length>12&&void 0!==arguments[12])||arguments[12],p=!(arguments.length>13&&void 0!==arguments[13])||arguments[13],g=!(arguments.length>14&&void 0!==arguments[14])||arguments[14],m=!(arguments.length>15&&void 0!==arguments[15])||arguments[15],f=!(arguments.length>16&&void 0!==arguments[16])||arguments[16],v=!(arguments.length>17&&void 0!==arguments[17])||arguments[17],y=!(arguments.length>18&&void 0!==arguments[18])||arguments[18],k=arguments.length>19&&void 0!==arguments[19]?arguments[19]:Dt.I.DisableNone;const T=((e?1:0)|(t?1:0)<<1|(r?1:0)<<2|(i?1:0)<<3|(s?1:0)<<4|(a?1:0)<<5|(o?1:0)<<6|(l?1:0)<<7|(c?1:0)<<8|(d?1:0)<<9|(u?1:0)<<10|(h?1:0)<<11|(p?1:0)<<12|(g?1:0)<<13|(m?1:0)<<14|(f?1:0)<<15|(v?1:0)<<16|(y?1:0)<<17).toString()+n.toString()+k.toString();if(null!=this.memoizedTaskPermissions[T])return this.memoizedTaskPermissions[T].taskPermissions;const S={canAssign:e,canDelete:t,checklistPermissions:n,canEditDescription:r,canEditTitle:i,canUpdateDueDate:s,canUpdatePriority:a,canUpdatePriorityToUrgent:o,canEdit:l,canComment:c,canCopy:d,canMove:u,canUploadFiles:h,canUpdateProgress:p,canUpdateAppliedLabels:g,canUpdateBucket:m,canUpdateStartDate:f,canUpdateRecurrence:v,canUpdatePreviewType:y,attachmentPermissions:k};return this.memoizedTaskPermissions[T]={equivalenceSetId:"default",taskPermissions:S,expiry:Nt()([2500])},S}getContainerCapabilities(e){try{return function(e){switch(e){case It.K.Group:return{canAcceptTasks:!0,canAddTasks:!0,canComment:!0,canCopyPlan:!0,canCopyTasks:!0,canDelete:!0,canEdit:!0,canMoveTasks:!0,canUploadFiles:!0,canModifyMembership:!0};case It.K.Roster:return{canAcceptTasks:!0,canAddTasks:!0,canComment:!1,canCopyPlan:!0,canCopyTasks:!0,canDelete:!0,canEdit:!0,canMoveTasks:!0,canUploadFiles:!1,canModifyMembership:!0};case It.K.Project:return{canAcceptTasks:!1,canAddTasks:!1,canComment:!1,canCopyPlan:!1,canCopyTasks:!1,canDelete:!1,canEdit:!1,canMoveTasks:!1,canUploadFiles:!1,canModifyMembership:!1};case It.K.User:return{canAcceptTasks:!0,canAddTasks:!0,canComment:!1,canCopyPlan:!1,canCopyTasks:!0,canDelete:!0,canEdit:!0,canMoveTasks:!0,canUploadFiles:!1,canModifyMembership:!1};case It.K.DriveItem:case It.K.TeamsConversation:case It.K.PlannerUser:case It.K.ToDo:case It.K.Invalid:return{canAcceptTasks:!1,canAddTasks:!1,canComment:!1,canCopyPlan:!1,canCopyTasks:!1,canDelete:!1,canEdit:!1,canMoveTasks:!1,canUploadFiles:!1,canModifyMembership:!1};default:throw new Error("Unknown container type: ".concat(e))}}(e)}catch(t){return this.loggers.traceLogger.logTrace(507639452,Rt.k.Error,"getContainerCapabilities failed [Error=".concat(Gt.f.getMessage(t),"]")),{canAcceptTasks:!1,canAddTasks:!1,canComment:!1,canCopyPlan:!1,canCopyTasks:!1,canDelete:!1,canEdit:!1,canMoveTasks:!1,canUploadFiles:!1,canModifyMembership:!1}}}constructor(e,t){super(),this.loggers=t,this.currentUsageMode=E.BH.Full,this.planToContainerMapping={},this.containerIdToIsMemberMapping={},this.driveItemVroomIdToHasAccessMapping={},this.containerPermissions={},this.memoizedTaskPermissions={},this.canConvertBasicPlanToPremiumPlan=!1,this.canAccessCopilot=()=>{var e;const t=null===(e=this.userPremiumPlanFeatureEntitlements)||void 0===e?void 0:e.premiumPlan;return(null===t||void 0===t?void 0:t.licenseLevel)===Lt.eN.professional||(null===t||void 0===t?void 0:t.licenseLevel)===Lt.eN.premium},this.userPolicies=e,this.flights=(0,r.A)({},Y.B.clientSettings.Flights)}}Wt.memoizedPlanPermissions={},Wt.memoizedUserPermissions={},Wt.memoizedContainerPermissions={},Wt.memoizedBucketPermissions={};var zt=n(8149),jt=n(70375),Kt=n(59640),Ht=n(93940),Vt=n(3756),Zt=n(48545),qt=n(30263);class Yt extends Ce.z{get name(){return"PlannerIntelligenceStore"}getFileSuggestions(e){var t;return null!==(t=this.fileSuggestions.getItem(e))&&void 0!==t?t:null}getFileSuggestionsMetadata(e){var t;return null!==(t=this.fileSuggestionsMetadata.getItem(e))&&void 0!==t?t:null}getFileSuggestionsSeenState(e){var t;return null!==(t=this.fileSuggestionsSeenStates[e])&&void 0!==t?t:null}getImageSuggestions(e){var t;return null!==(t=this.imageSuggestions.getItem(e))&&void 0!==t?t:null}handleAction(e){let t=!1;switch(e.type){case zt.C.actionType:t=this.handleFetchFileSuggestionsAction(e);break;case Ht.v.actionType:t=this.handleFetchFileSuggestionsSucceededAction(e);break;case jt.P.actionType:t=this.handleFetchFileSuggestionsFailedAction(e);break;case Kt.N.actionType:t=this.handleFileSuggestionsSeenAction(e);break;case Vt.A.actionType:t=this.handleFetchImageRecommendationsAction(e);break;case qt.T.actionType:t=this.handleFetchImageRecommendationsSucceededAction(e);break;case Zt.B.actionType:t=this.handleFetchImageRecommendationsFailedAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleFetchFileSuggestionsAction(e){return null!=this.fileSuggestions.getItem(e.entityId)&&(this.fileSuggestions.setItem(e.entityId,null),!0)}handleFetchFileSuggestionsSucceededAction(e){const t=this.fileSuggestions.getItem(e.entityId),n={traceId:e.fileSuggestions.fileResultReference.referenceId,cv:e.cv,logicalId:e.logicalId,resultSource:e.fileSuggestions.fileResultReference.resultSource};return this.fileSuggestionsMetadata.setItem(e.entityId,n),!ze()(e.fileSuggestions.fileRecommendations,t)&&(this.fileSuggestions.setItem(e.entityId,e.fileSuggestions.fileRecommendations),!0)}handleFetchFileSuggestionsFailedAction(e){return null==this.fileSuggestions.getItem(e.taskId)&&(this.fileSuggestions.setItem(e.taskId,[]),!0)}handleFileSuggestionsSeenAction(e){const t=this.fileSuggestionsSeenStates[e.entityId];return t!==e.seen&&!0!==t&&(this.fileSuggestionsSeenStates[e.entityId]=e.seen,!0)}handleFetchImageRecommendationsAction(e){return null!=this.imageSuggestions.getItem(e.entityId)&&(this.imageSuggestions.removeItem(e.entityId),!0)}handleFetchImageRecommendationsSucceededAction(e){const t=this.imageSuggestions.getItem(e.entityId);if(null!=t&&t.query===e.query&&ze()(e.results,t.results))return!1;const n={query:e.query,results:e.results};return this.imageSuggestions.setItem(e.entityId,n),!0}handleFetchImageRecommendationsFailedAction(e){const t=this.imageSuggestions.getItem(e.entityId);if((null===t||void 0===t?void 0:t.query)===e.query&&Bt()(t.results))return!1;const n={query:e.query,results:[]};return this.imageSuggestions.setItem(e.entityId,n),!0}constructor(){super(),this.fileSuggestionsSeenStates={},this.fileSuggestions=new Ie.j,this.fileSuggestionsMetadata=new Ie.j,this.imageSuggestions=new Ie.j}}var Jt=n(79799),Xt=n(41788),$t=n(98304),Qt=n(23359),en=n(99763),tn=n(27197),nn=n(33629),rn=function(){function e(e){this.array=null!==e&&void 0!==e?e:[]}return e.prototype.clone=function(){return new e(this.array.slice())},e.prototype.getCurrentLength=function(){return this.array.length},e.prototype.getValueAtIndex=function(e){var t;return null!==(t=this.array[e])&&void 0!==t?t:0},e.prototype.setValueAtIndex=function(e,t){this.array[e]=t},e}(),sn=n(94772),an=n(67271);class on{static BuildFromTaskSet(e,t){let n=0,r=0,i=0,s=0,a=0;for(const o of e)if(o.isLate())r++,a++;else switch((0,an.Fk)(o.percentComplete)){case sn.$.NotStarted:r++,n++;break;case sn.$.Complete:i++;break;default:case sn.$.InProgress:r++,s++}return new on(t,r,n,a,s,i)}handleTaskDeletion(e){let t=this.notStartedTasks,n=this.activeTasks,r=this.completedTasks,i=this.inProgressTasks,s=this.lateTasks;if(e.isLate())n--,s--;else switch((0,an.Fk)(e.percentComplete)){case sn.$.NotStarted:n--,t--;break;case sn.$.Complete:r--;break;default:case sn.$.InProgress:n--,i--}return new on(this.id,n,t,s,i,r)}handleTaskInsertion(e){let t=this.notStartedTasks,n=this.activeTasks,r=this.completedTasks,i=this.inProgressTasks,s=this.lateTasks;if(e.isLate())n++,s++;else switch((0,an.Fk)(e.percentComplete)){case sn.$.NotStarted:n++,t++;break;case sn.$.Complete:r++;break;default:case sn.$.InProgress:n++,i++}return new on(this.id,n,t,s,i,r)}handleTaskUpdate(e,t){return this.handleTaskDeletion(e).handleTaskInsertion(t)}handleAdditionalTaskData(e){let t=this.notStartedTasks,n=this.activeTasks,r=this.completedTasks,i=this.inProgressTasks,s=this.lateTasks;for(const a of e)if(a.isLate())n++,s++;else switch((0,an.Fk)(a.percentComplete)){case sn.$.NotStarted:n++,t++;break;case sn.$.Complete:r++;break;default:case sn.$.InProgress:n++,i++}return new on(this.id,n,t,s,i,r)}constructor(e,t,n,r,i,s){this.id=e,this.activeTasks=t,this.notStartedTasks=n,this.lateTasks=r,this.inProgressTasks=i,this.completedTasks=s}}var ln=n(50723),cn=n.n(ln);class dn extends Ce.z{get name(){return"PlannerAggregatesStore"}getPlanAggregates(e){var t;return null!==(t=this.planAggregates.getItem(e))&&void 0!==t?t:null}getLabelUsageCountsForPlan(e){var t;return null!==(t=this.labelCountsByPlan.getItem(e))&&void 0!==t?t:new rn}handleAction(e){let t=!1;switch(e.type){case nt.t.actionType:t=this.handlePlanCreation(e);break;case Je.Y.actionType:case Ve.l.actionType:t=this.handlePlanDeletion(e.planId);break;case Jt.a.actionType:t=this.handleTasksForPlanFetchSuccess(e);break;case Xt.r.actionType:case $t.r.actionType:t=this.handlePlanTaskCreation(e.taskEntitySet.task);break;case Qt.U.actionType:const n=e;t=this.handlePlanTaskUpdate(n.originalTaskEntitySet.task,n.updatedTaskEntitySet.task);break;case en.T.actionType:const r=e;t=this.handlePlanTaskUpdate(r.originalTaskEntitySet.task,r.taskEntitySet.task);break;case tn.o.actionType:case nn.D.actionType:t=this.handlePlanTaskDeletion(e.deletedTaskEntitySet.task);break;default:return}t&&this.publishStoreChangedEvent()}handlePlanCreation(e){const t=e.planEntitySet.plan;return this.planAggregates.setItem(t.id,new on(t.id,0,0,0,0,0)),this.labelCountsByPlan.setItem(t.id,new rn),!0}handlePlanDeletion(e){let t=!1;const n=this.planAggregates.getItem(e);null!==n&&void 0!==n&&(this.planAggregates.removeItem(e),t=!0);const r=this.labelCountsByPlan.getItem(e);return null!==r&&void 0!==r&&(this.labelCountsByPlan.removeItem(e),t=!0),t}handlePlanTaskCreation(e){if(null==e)return!1;let t=!1;const{planId:n}=e,r=this.planAggregates.getItem(n);if(null!==r&&void 0!==r){const n=r.handleTaskInsertion(e);this.planAggregates.setItem(e.planId,n),t=!0}const i=this.labelCountsByPlan.getItem(n);if(null!==i&&void 0!==i){const r=i.clone();e.appliedCategories.forEach(e=>{r.setValueAtIndex(e,r.getValueAtIndex(e)+1)}),this.labelCountsByPlan.setItem(n,r),t=!0}return t}handlePlanTaskDeletion(e){if(null==e)return!1;let t=!1;const{planId:n}=e,r=this.planAggregates.getItem(n);if(null!==r&&void 0!==r){const i=r.handleTaskDeletion(e);this.planAggregates.setItem(n,i),t=!0}const i=this.labelCountsByPlan.getItem(n);if(null!==i&&void 0!==i){const r=i.clone();e.appliedCategories.forEach(e=>{r.setValueAtIndex(e,r.getValueAtIndex(e)-1)}),this.labelCountsByPlan.setItem(n,r),t=!0}return t}handlePlanTaskUpdate(e,t){if(null==e||null==t)return!1;let n=!1;const{planId:r}=e,i=this.planAggregates.getItem(r);if(null!==i&&void 0!==i){const s=i.handleTaskUpdate(e,t);this.planAggregates.setItem(r,s),n=!0}const s=this.labelCountsByPlan.getItem(r);if(!ze()(e.appliedCategories,t.appliedCategories)&&null!==s&&void 0!==s){const i=s.clone(),a=cn()(t.appliedCategories,t=>e.appliedCategories.indexOf(t)<0),o=cn()(e.appliedCategories,e=>t.appliedCategories.indexOf(e)<0);Ut()(a,e=>{i.setValueAtIndex(e,i.getValueAtIndex(e)+1)}),Ut()(o,e=>{i.setValueAtIndex(e,i.getValueAtIndex(e)-1)}),this.labelCountsByPlan.setItem(r,i),n=!0}return n}handleTasksForPlanFetchSuccess(e){const{isFirstPage:t,planId:n}=e;if(Bt()(n))return!1;const r=this.getPlanAggregates(n);if(!t&&null===r)throw new Error("AggregateException: original planAggregates not found in the store while isFirstPage is false");let i=this.labelCountsByPlan.getItem(n);if(!t&&(null===i||void 0===i))throw new Error("AggregateException: original LabelCounts not found in the store while isFirstPage is false");let s=!1;const a=e.tasks.map(e=>e.task);if(t)this.planAggregates.setItem(n,on.BuildFromTaskSet(a,n)),s=!0;else{const e=r.handleAdditionalTaskData(a);ze()(r,e)||(this.planAggregates.setItem(n,e),s=!0)}i=this.getLabelUsageCountsForPlan(n);const o=i.clone();return a.forEach(e=>{e.appliedCategories.forEach(e=>{o.setValueAtIndex(e,o.getValueAtIndex(e)+1)})}),t?(this.labelCountsByPlan.setItem(n,o),s=!0):ze()(i,o)||(this.labelCountsByPlan.setItem(n,o),s=!0),s}constructor(){super(),this.planAggregates=new Ie.j,this.labelCountsByPlan=new Ie.j}}var un=n(1207),hn=n(53734),pn=n(1623),gn=n(514),mn=n(79670),fn=n(25744),vn=n(15765),yn=n(38227),kn=n(87450),Tn=n(46219),Sn=n(23821),bn=n(48148),In=n(45698),Cn=n(47572),Dn=n(21651),En=n(56434),Pn=n.n(En),wn=n(56641),xn=n.n(wn),An=n(56851);function Fn(e){return"function"===typeof e}function Ln(e){var t=e(function(e){Error.call(e),e.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var _n=Ln(function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}});function Un(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var On=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var e,t,n,r,i;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var a=(0,An.__values)(s),o=a.next();!o.done;o=a.next()){o.value.remove(this)}}catch(p){e={error:p}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else s.remove(this);var l=this.initialTeardown;if(Fn(l))try{l()}catch(g){i=g instanceof _n?g.errors:[g]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var d=(0,An.__values)(c),u=d.next();!u.done;u=d.next()){var h=u.value;try{Nn(h)}catch(m){i=null!==i&&void 0!==i?i:[],m instanceof _n?i=(0,An.__spreadArray)((0,An.__spreadArray)([],(0,An.__read)(i)),(0,An.__read)(m.errors)):i.push(m)}}}catch(f){n={error:f}}finally{try{u&&!u.done&&(r=d.return)&&r.call(d)}finally{if(n)throw n.error}}}if(i)throw new _n(i)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)Nn(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&Un(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&Un(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),Bn=On.EMPTY;function Mn(e){return e instanceof On||e&&"closed"in e&&Fn(e.remove)&&Fn(e.add)&&Fn(e.unsubscribe)}function Nn(e){Fn(e)?e():e.unsubscribe()}var Rn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Gn={setTimeout:function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i=Gn.delegate;return(null===i||void 0===i?void 0:i.setTimeout)?i.setTimeout.apply(i,(0,An.__spreadArray)([e,t],(0,An.__read)(n))):setTimeout.apply(void 0,(0,An.__spreadArray)([e,t],(0,An.__read)(n)))},clearTimeout:function(e){var t=Gn.delegate;return((null===t||void 0===t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function Wn(e){Gn.setTimeout(function(){var t=Rn.onUnhandledError;if(!t)throw e;t(e)})}function zn(){}var jn=Kn("C",void 0,void 0);function Kn(e,t,n){return{kind:e,value:t,error:n}}var Hn=null;function Vn(e){if(Rn.useDeprecatedSynchronousErrorHandling){var t=!Hn;if(t&&(Hn={errorThrown:!1,error:null}),e(),t){var n=Hn,r=n.errorThrown,i=n.error;if(Hn=null,r)throw i}}else e()}var Zn=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,Mn(t)&&t.add(n)):n.destination=er,n}return(0,An.__extends)(t,e),t.create=function(e,t,n){return new Xn(e,t,n)},t.prototype.next=function(e){this.isStopped?Qn(function(e){return Kn("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?Qn(Kn("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?Qn(jn,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(On),qn=Function.prototype.bind;function Yn(e,t){return qn.call(e,t)}var Jn=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){$n(n)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){$n(n)}else $n(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){$n(t)}},e}(),Xn=function(e){function t(t,n,r){var i,s,a=e.call(this)||this;Fn(t)||!t?i={next:null!==t&&void 0!==t?t:void 0,error:null!==n&&void 0!==n?n:void 0,complete:null!==r&&void 0!==r?r:void 0}:a&&Rn.useDeprecatedNextContext?((s=Object.create(t)).unsubscribe=function(){return a.unsubscribe()},i={next:t.next&&Yn(t.next,s),error:t.error&&Yn(t.error,s),complete:t.complete&&Yn(t.complete,s)}):i=t;return a.destination=new Jn(i),a}return(0,An.__extends)(t,e),t}(Zn);function $n(e){var t;Rn.useDeprecatedSynchronousErrorHandling?(t=e,Rn.useDeprecatedSynchronousErrorHandling&&Hn&&(Hn.errorThrown=!0,Hn.error=t)):Wn(e)}function Qn(e,t){var n=Rn.onStoppedNotification;n&&Gn.setTimeout(function(){return n(e,t)})}var er={closed:!0,next:zn,error:function(e){throw e},complete:zn},tr="function"===typeof Symbol&&Symbol.observable||"@@observable";function nr(e){return e}function rr(e){return 0===e.length?nr:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}}var ir=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,i=this,s=(r=e)&&r instanceof Zn||function(e){return e&&Fn(e.next)&&Fn(e.error)&&Fn(e.complete)}(r)&&Mn(r)?e:new Xn(e,t,n);return Vn(function(){var e=i,t=e.operator,n=e.source;s.add(t?t.call(s,n):n?i._subscribe(s):i._trySubscribe(s))}),s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=sr(t))(function(t,r){var i=new Xn({next:function(t){try{e(t)}catch(n){r(n),i.unsubscribe()}},error:r,complete:t});n.subscribe(i)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[tr]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return rr(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=sr(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();function sr(e){var t;return null!==(t=null!==e&&void 0!==e?e:Rn.Promise)&&void 0!==t?t:Promise}var ar=Ln(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),or=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,An.__extends)(t,e),t.prototype.lift=function(e){var t=new lr(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new ar},t.prototype.next=function(e){var t=this;Vn(function(){var n,r;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var i=(0,An.__values)(t.currentObservers),s=i.next();!s.done;s=i.next()){s.value.next(e)}}catch(a){n={error:a}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}})},t.prototype.error=function(e){var t=this;Vn(function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}})},t.prototype.complete=function(){var e=this;Vn(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,s=n.observers;return r||i?Bn:(this.currentObservers=null,s.push(e),new On(function(){t.currentObservers=null,Un(s,e)}))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new ir;return e.source=this,e},t.create=function(e,t){return new lr(e,t)},t}(ir),lr=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return(0,An.__extends)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:Bn},t}(or),cr=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return(0,An.__extends)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){var e=this,t=e.hasError,n=e.thrownError,r=e._value;if(t)throw n;return this._throwIfClosed(),r},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(or);function dr(e){return function(t){if(function(e){return Fn(null===e||void 0===e?void 0:e.lift)}(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function ur(e,t,n,r,i){return new hr(e,t,n,r,i)}var hr=function(e){function t(t,n,r,i,s,a){var o=e.call(this,t)||this;return o.onFinalize=s,o.shouldUnsubscribe=a,o._next=n?function(e){try{n(e)}catch(r){t.error(r)}}:e.prototype._next,o._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,o._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,o}return(0,An.__extends)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(Zn);function pr(e,t){return void 0===t&&(t=nr),e=null!==e&&void 0!==e?e:gr,dr(function(n,r){var i,s=!0;n.subscribe(ur(r,function(n){var a=t(n);!s&&e(i,a)||(s=!1,i=a,r.next(n))}))})}function gr(e,t){return e===t}class mr{get unwrap(){return this._subject.value}get listObservable(){return this._observable}update(e){this._itemIndex=this.createDictionaryIndexesFromArray(e),this.pushChange(Pn()(e))}upsert(e,t){if(!xn()(e,t,this.customComparator)){const n=this.getKey(e),r=Pn()(t),i=this._itemIndex[n];if(null!=i){const e=Pn()(this.unwrap),t=this.getKey(r),s=this._itemIndex[t];if(n===t)e[i]=r;else if(null==s)e[i]=r,delete this._itemIndex[n],this._itemIndex[t]=i;else{const s=e.pop(),a=this.getKey(s);delete this._itemIndex[n],n!==a&&(e[i]=s,this._itemIndex[a]=i),e[this._itemIndex[t]]=r}this.pushChange(e)}}}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!Bt()(t)){let e=!1;const n=Pn()(this.unwrap);for(const r of Pn()(t)){const t=this.getKey(r);if(null==this._itemIndex[t]){const i=n.push(r);this._itemIndex[t]=i-1,e=!0}}e&&this.pushChange(n)}}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!Bt()(t)){let e=!1;const n=Pn()(this.unwrap);for(const r of this.getKeys(t)){const t=this._itemIndex[r];if(null!=t){const i=n.pop(),s=this.getKey(i);r!==s&&(n[t]=i,this._itemIndex[s]=t),delete this._itemIndex[r],e=!0}}e&&this.pushChange(n)}}contains(e){return null!=this._itemIndex[this.getKey(e)]}pushChange(e){this._subject.next(e)}createDictionaryIndexesFromArray(e){return Dn.x.isCollectionOfIdentifiables(e)?e.filter(e=>null!=e.id).reduce((e,t,n)=>(0,r.A)((0,r.A)({},e),{},{[t.id]:n}),{}):e.filter(e=>null!=e).reduce((e,t,n)=>(0,r.A)((0,r.A)({},e),{},{[t]:n}),{})}getKey(e){return Dn.x.isIdentifiable(e)?e.id:e}getKeys(e){return Dn.x.isCollectionOfIdentifiables(e)?e.map(e=>e.id):e}constructor(e,t){this.customComparator=t,this._itemIndex=this.createDictionaryIndexesFromArray(e),this._subject=new cr(Pn()(e)),this._observable=this._subject.asObservable().pipe(pr((e,t)=>xn()(e,t,this.customComparator)))}}var fr=n(23096);class vr extends fr.w{get value(){return this._subject.value}get valueObservable(){return this._observable}pushDelta(e,t){super.pushDelta(e,t),this.pushChange()}revertDelta(e){super.revertDelta(e),this.pushChange()}commitDelta(e,t){super.commitDelta(e,t),this.pushChange()}updateBaseline(e){super.updateBaseline(e),this.pushChange()}restartStreams(){var e;null===(e=this._subject)||void 0===e||e.complete(),this._subject=new cr(Pn()(this.getValue())),this._observable=this._subject.asObservable().pipe(pr((e,t)=>xn()(e,t,this.customComparator)))}pushChange(){this._subject.next(Pn()(this.getValue()))}constructor(e,t){super(Pn()(e)),this.customComparator=t,this.restartStreams()}}var yr=n(80347),kr=n(91246),Tr=n(54052),Sr=n.n(Tr);class br{static tryAddIdToIndex(e,t,n,r){if(!Bt()(n)){let i=t.getItem(n);if(null==i&&r&&(i=[]),null!=i){if(i.indexOf(e)<0)return i.push(e),t.setItem(n,i),!0}}return!1}static addItemToOrInitializeObservableContainer(e,t,n,r){if(!Bt()(n)){const i=t[n],s=Sr()(e)?e:[e];null==i?t[n]=new mr(s,r):i.add(...s)}}static tryRemoveIdFromIndex(e,t,n){if(!Bt()(n)){const r=t.getItem(n);if(null!=r){const i=r.indexOf(e);if(i>=0)return r.splice(i,1),t.setItem(n,r),!0}}return!1}static tryUpdateIdInIndex(e,t,n,r){if(e===t)return!1;if(!Bt()(r)){const i=n.getItem(r);if(null!=i){const s=i.indexOf(e);if(s>=0)return i.splice(s,1),i.indexOf(t)<0&&i.push(t),n.setItem(r,i),!0}}return!1}static updateItemsInOrInitializeObservableContainer(e,t,n,r){if(!Bt()(n)){const i=t[n];null==i?t[n]=new mr(e,r):i.update(e)}}}var Ir=n(72749),Cr=n.n(Ir),Dr=n(33411),Er=n.n(Dr),Pr=n(9376),wr=n.n(Pr),xr=new ir(function(e){return e.complete()});var Ar=function(e){return e&&"number"===typeof e.length&&"function"!==typeof e};function Fr(e){return Fn(null===e||void 0===e?void 0:e.then)}function Lr(e){return Fn(e[tr])}function _r(e){return Symbol.asyncIterator&&Fn(null===e||void 0===e?void 0:e[Symbol.asyncIterator])}function Ur(e){return new TypeError("You provided "+(null!==e&&"object"===typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Or="function"===typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Br(e){return Fn(null===e||void 0===e?void 0:e[Or])}function Mr(e){return(0,An.__asyncGenerator)(this,arguments,function(){var t,n,r;return(0,An.__generator)(this,function(i){switch(i.label){case 0:t=e.getReader(),i.label=1;case 1:i.trys.push([1,,9,10]),i.label=2;case 2:return[4,(0,An.__await)(t.read())];case 3:return n=i.sent(),r=n.value,n.done?[4,(0,An.__await)(void 0)]:[3,5];case 4:return[2,i.sent()];case 5:return[4,(0,An.__await)(r)];case 6:return[4,i.sent()];case 7:return i.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Nr(e){return Fn(null===e||void 0===e?void 0:e.getReader)}function Rr(e){if(e instanceof ir)return e;if(null!=e){if(Lr(e))return i=e,new ir(function(e){var t=i[tr]();if(Fn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")});if(Ar(e))return r=e,new ir(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()});if(Fr(e))return n=e,new ir(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,Wn)});if(_r(e))return Gr(e);if(Br(e))return t=e,new ir(function(e){var n,r;try{for(var i=(0,An.__values)(t),s=i.next();!s.done;s=i.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(o){n={error:o}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.complete()});if(Nr(e))return Gr(Mr(e))}var t,n,r,i;throw Ur(e)}function Gr(e){return new ir(function(t){(function(e,t){var n,r,i,s;return(0,An.__awaiter)(this,void 0,void 0,function(){var a,o;return(0,An.__generator)(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=(0,An.__asyncValues)(e),l.label=1;case 1:return[4,n.next()];case 2:if((r=l.sent()).done)return[3,4];if(a=r.value,t.next(a),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),i={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),r&&!r.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}function Wr(e){return e[e.length-1]}function zr(e){return(t=Wr(e))&&Fn(t.schedule)?e.pop():void 0;var t}function jr(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var s=t.schedule(function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(s),!i)return s}function Kr(e,t){return void 0===t&&(t=0),dr(function(n,r){n.subscribe(ur(r,function(n){return jr(r,e,function(){return r.next(n)},t)},function(){return jr(r,e,function(){return r.complete()},t)},function(n){return jr(r,e,function(){return r.error(n)},t)}))})}function Hr(e,t){return void 0===t&&(t=0),dr(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Vr(e,t){if(!e)throw new Error("Iterable cannot be null");return new ir(function(n){jr(n,t,function(){var r=e[Symbol.asyncIterator]();jr(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function Zr(e,t){if(null!=e){if(Lr(e))return function(e,t){return Rr(e).pipe(Hr(t),Kr(t))}(e,t);if(Ar(e))return function(e,t){return new ir(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(Fr(e))return function(e,t){return Rr(e).pipe(Hr(t),Kr(t))}(e,t);if(_r(e))return Vr(e,t);if(Br(e))return function(e,t){return new ir(function(n){var r;return jr(n,t,function(){r=e[Or](),jr(n,t,function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(s){return void n.error(s)}i?n.complete():n.next(t)},0,!0)}),function(){return Fn(null===r||void 0===r?void 0:r.return)&&r.return()}})}(e,t);if(Nr(e))return function(e,t){return Vr(Mr(e),t)}(e,t)}throw Ur(e)}function qr(e,t){return t?Zr(e,t):Rr(e)}var Yr=Array.isArray,Jr=Object.getPrototypeOf,Xr=Object.prototype,$r=Object.keys;function Qr(e){if(1===e.length){var t=e[0];if(Yr(t))return{args:t,keys:null};if((r=t)&&"object"===typeof r&&Jr(r)===Xr){var n=$r(t);return{args:n.map(function(e){return t[e]}),keys:n}}}var r;return{args:e,keys:null}}var ei=Array.isArray;function ti(e){return t=function(t){return function(e,t){return ei(t)?e.apply(void 0,(0,An.__spreadArray)([],(0,An.__read)(t))):e(t)}(e,t)},dr(function(e,r){var i=0;e.subscribe(ur(r,function(e){r.next(t.call(n,e,i++))}))});var t,n}function ni(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=zr(e),r=function(e){return Fn(Wr(e))?e.pop():void 0}(e),i=Qr(e),s=i.args,a=i.keys;if(0===s.length)return qr([],n);var o=new ir(function(e,t,n){void 0===n&&(n=nr);return function(r){ri(t,function(){for(var i=e.length,s=new Array(i),a=i,o=i,l=function(i){ri(t,function(){var l=qr(e[i],t),c=!1;l.subscribe(ur(r,function(e){s[i]=e,c||(c=!0,o--),o||r.next(n(s.slice()))},function(){--a||r.complete()}))},r)},c=0;c<i;c++)l(c)},r)}}(s,n,a?function(e){return function(e,t){return e.reduce(function(e,n,r){return e[n]=t[r],e},{})}(a,e)}:nr));return r?o.pipe(ti(r)):o}function ri(e,t,n){e?jr(n,e,t):t()}class ii extends Ce.z{get name(){return"PlannerBucketStore"}getBucket(e){var t,n;return null!==(t=null===(n=this.buckets[e])||void 0===n?void 0:n.value)&&void 0!==t?t:null}getBucketObservable(e){var t,n;return null!==(t=null===(n=this.buckets[e])||void 0===n?void 0:n.valueObservable)&&void 0!==t?t:xr}getBucketWithoutPendingUpdates(e){var t,n;return null!==(t=null===(n=this.buckets[e])||void 0===n?void 0:n.baseline)&&void 0!==t?t:null}getBucketStatus(e){var t,n;return null!==(t=null===(n=this.buckets[e])||void 0===n?void 0:n.status)&&void 0!==t?t:null}getBucketsForPlan(e){var t;const n=null===(t=this.planBucketsIndex[e])||void 0===t?void 0:t.unwrap;return null==n?null:Er()(n,e=>{const t=this.getBucket(e);if(null==t)throw new Error("IndexCorruptionException: Indexed bucket not found in Bucket table");return t})}getBucketsForPlanObservable(e){return null==this.planBucketsIndex[e]&&(this.planBucketsIndex[e]=new mr([])),this.planBucketsIndex[e].listObservable.pipe((t=e=>Bt()(e)?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return qr(e,zr(e))}([]):ni(e.map(e=>this.getBucketObservable(e))),dr(function(e,r){var i=null,s=0,a=!1,o=function(){return a&&!i&&r.complete()};e.subscribe(ur(r,function(e){null===i||void 0===i||i.unsubscribe();var a=0,l=s++;Rr(t(e,l)).subscribe(i=ur(r,function(t){return r.next(n?n(e,t,l,a++):t)},function(){i=null,o()}))},function(){a=!0,o()}))})),pr(ze()));var t,n}handleAction(e){let t=!1;switch(e.type){case un.z.actionType:t=this.handleBucketsForPlansFetchSuccess(e);break;case hn.g.actionType:t=this.handleFetchBucketSuccess(e);break;case pn.t.actionType:t=this.handleBucketCreation(e);break;case gn.g.actionType:t=this.handleBucketCreationFailure(e);break;case mn.G.actionType:t=this.handleBucketCreationSuccess(e);break;case bn.e.actionType:t=this.handleDiffSyncInsertBucket(e);break;case fn.e.actionType:t=this.handleBucketDeletion(e);break;case vn.V.actionType:t=this.handleBucketDeletionFailure(e);break;case yn.R.actionType:t=this.handleBucketDeletionSuccess(e);break;case In.a.actionType:t=this.handleDiffSyncDeleteBucket(e);break;case kn.A.actionType:t=this.handleBucketUpdate(e);break;case Tn.T.actionType:t=this.handleBucketUpdateFailure(e);break;case Sn.z.actionType:t=this.handleBucketUpdateSuccess(e);break;case Cn.c.actionType:t=this.handleDiffSyncUpdateBucket(e);break;case rt.actionType:const n=e;t=this.handleBucketsForPlansFetchSuccess(new un.z(n.plan.id,n.buckets));break;default:return}t&&this.publishStoreChangedEvent()}handleBucketsForPlansFetchSuccess(e){var t,n;let r=!1,i=[];const s=null===(t=this.planBucketsIndex[e.planId])||void 0===t?void 0:t.unwrap;if(null!=s&&0!==s.length){const e=s.filter(e=>kr.o.isPlexTempId(e));i=Cr()(i,e)}Ut()(e.buckets,e=>{if(null!=e){i.push(e.id);const t=this.buckets[e.id];null==t?(r=!0,this.buckets[e.id]=new vr(e,(e,t)=>yr.lz.isEqualMomentCustomizer(e,t))):ze()(t.baseline,e)||(t.updateBaseline(e),r=!0)}});const a=wr()(i),o=null===(n=this.planBucketsIndex[e.planId])||void 0===n?void 0:n.unwrap;return ze()(o,a)||(br.updateItemsInOrInitializeObservableContainer(a,this.planBucketsIndex,e.planId),r=!0),r}handleFetchBucketSuccess(e){let t=!1;const n=e.bucket.id,r=e.bucket,i=this.buckets[n];return null==i?(t=!0,this.buckets[r.id]=new vr(r,(e,t)=>yr.lz.isEqualMomentCustomizer(e,t))):ze()(i.baseline,r)||(i.updateBaseline(r),t=!0),br.addItemToOrInitializeObservableContainer(n,this.planBucketsIndex,r.planId),t}handleBucketCreation(e){const t=e.bucket.id;if(null!=this.buckets[t])throw new Error("AggregateException: bucket already exists in store");return this.buckets[t]=new vr(e.bucket,(e,t)=>yr.lz.isEqualMomentCustomizer(e,t)),br.addItemToOrInitializeObservableContainer(t,this.planBucketsIndex,e.bucket.planId),!0}handleBucketCreationFailure(e){var t;const n=e.bucket.id,r=this.buckets[n];if(null==r)throw new Error("AggregateException: bucket not found in store");return null===(t=this.planBucketsIndex[e.bucket.planId])||void 0===t||t.remove(n),delete this.buckets[r.baseline.id],!0}handleBucketCreationSuccess(e){var t;const n=e.localId,r=e.bucket.id,i=this.buckets[n];if(null==i)throw new Error("AggregateException: bucket not found in store");return delete this.buckets[i.baseline.id],i.restartStreams(),i.updateBaseline(e.bucket),this.buckets[r]=i,null===(t=this.planBucketsIndex[e.bucket.planId])||void 0===t||t.upsert(n,r),!0}handleDiffSyncInsertBucket(e){const t=e.bucket,n=t.id;if(this.buckets[n])throw new Error("AggregateException: bucket already exists in store");return this.buckets[n]=new vr(t,(e,t)=>yr.lz.isEqualMomentCustomizer(e,t)),br.addItemToOrInitializeObservableContainer(n,this.planBucketsIndex,t.planId),!0}handleBucketDeletion(e){var t;const n=e.bucketId,r=this.buckets[n];if(null==r)throw new Error("AggregateException: bucket not found in store");return null===(t=this.planBucketsIndex[r.baseline.planId])||void 0===t||t.remove(r.baseline.id),r.softDelete(),!0}handleBucketDeletionFailure(e){const t=e.bucketId,n=this.buckets[t];if(null==n)throw new Error("AggregateException: bucket not found in store");return n.undelete(),br.addItemToOrInitializeObservableContainer(n.baseline.id,this.planBucketsIndex,n.baseline.planId),!0}handleBucketDeletionSuccess(e){const t=e.bucketId,n=this.buckets[t];if(null==n)throw new Error("AggregateException: bucket not found in store");return delete this.buckets[n.baseline.id],!0}handleDiffSyncDeleteBucket(e){var t;const n=e.bucketId,r=this.buckets[n];if(null==r)throw new Error("AggregateException: bucket not found in store");return null===(t=this.planBucketsIndex[r.baseline.planId])||void 0===t||t.remove(n),delete this.buckets[r.baseline.id],!0}handleBucketUpdate(e){let t=!1;const n=this.buckets[e.bucket.id];if(null==n)throw new Error("AggregateException: bucket not found in store");return ze()(n.value,e.bucket)||(n.pushDelta(e.bucket,e.updateKey),t=!0),t}handleBucketUpdateFailure(e){let t=!1;const n=this.buckets[e.bucket.id];if(null==n)throw new Error("AggregateException: bucket not found in store");return null!=n.getDelta(e.updateKey)&&(n.revertDelta(e.updateKey),t=!0),t}handleBucketUpdateSuccess(e){let t=!1;const n=this.buckets[e.bucket.id];if(null==n)throw new Error("AggregateException: bucket not found in store");return null!=n.getDelta(e.updateKey)&&(n.commitDelta(e.updateKey,e.bucket),t=!0),t}handleDiffSyncUpdateBucket(e){let t=!1;const n=this.buckets[e.bucket.id];if(null==n)throw new Error("AggregateException: bucket not found in store");return ze()(n.baseline,e.bucket)||(n.updateBaseline(e.bucket),t=!0),t}constructor(){super(),this.buckets={},this.planBucketsIndex={}}}var si=n(40655);class ai extends $.r{loggingData(){return{groupId:this.groupId,planCount:String(this.plans.length)}}constructor(e,t){super(ai.actionType),this.groupId=e,this.plans=t}}ai.actionType="PLW_GET_PLANSFORGROUP_SUCCEEDED";var oi=n(75913),li=n(4597),ci=n(9300),di=n(12756),ui=n(39894),hi=n(6775);class pi{get data(){return this._subject.value}get dataObservable(){return this._observable}update(e){this.pushChange(Pn()(e))}upsert(e,t){const n=Pn()(this.data);null!=n[e]&&xn()(n[e],t,this.customComparator)||(n[e]=Pn()(t),this.pushChange(n))}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!Bt()(t)){let e=!1;const n=Pn()(this.data);for(const r of t)n[r]&&(delete n[r],e=!0);e&&this.pushChange(n)}}pushChange(e){this._subject.next(e)}constructor(e,t){this.customComparator=t,this._subject=new cr(Pn()(null!==e&&void 0!==e?e:{})),this._observable=this._subject.asObservable().pipe(pr((e,t)=>xn()(e,t,this.customComparator)))}}var gi=n(98990),mi=n.n(gi);class fi extends Ce.z{get name(){return"PlannerContainerMembershipStore"}getPlanIds(e){const t=this.userContainerPlanIds[e],n=[];for(const r in null===t||void 0===t?void 0:t.data){const e=t.data[r].unwrap;null!=e&&n.push(...e.slice())}return n}getDocumentPlanIdsForUser(e){var t,n;const r=this.userContainerPlanIds[e],i=null===r||void 0===r||null===(t=r.data[It.K.DriveItem])||void 0===t?void 0:t.unwrap;return null!==(n=null===i||void 0===i?void 0:i.slice())&&void 0!==n?n:null}getPlanIdsForContainer(e){var t;const n=Pn()(null===(t=this.containerToPlansMapping[e])||void 0===t?void 0:t.unwrap);return null!=n?n:mi()(this.resolvedContainerIds,t=>t===e)?[]:null}getContainerHasBeenResolved(e){return-1!==this.resolvedContainerIds.indexOf(e)}getJoinedContainerIds(e){var t,n;return null!==(t=null===(n=this.userJoinedGroupContainerIds[e])||void 0===n?void 0:n.unwrap)&&void 0!==t?t:[]}isUserUsAndMsitTenantMember(){return this.isUSAndMsitTenantMember}handleAction(e){let t=!1;switch(e.type){case li.K.actionType:const n=e;t=this.handleOptimisticGroupCreation(n.unifiedGroup.id);break;case ci.b.actionType:const r=e;t=this.handleFailedGroupCreation(r.localId);break;case di.x.actionType:const i=e;t=this.handleSuccessfulGroupCreation(i.localId,i.unifiedGroup.id);break;case kt.L.actionType:t=this.handleGetContainerSucceededAction(e);break;case ut.P.actionType:t=this.handleGetUnifiedGroupDetailsSucceededAction(e);break;case ui.F.actionType:t=this.handleGetJoinedGroupsSucceededAction(e);break;case si.A.actionType:t=this.handleGetContainersSucceededAction(e);break;case dt.s.actionType:t=this.handleDeleteUnifiedGroupSucceededAction(e);break;case pt.w.actionType:const s=e;t=this.addMembershipInStore(s.containerId,s.containerType);break;case gt.v.actionType:const a=e;t=this.removeMembershipInStore(a.containerId,a.containerType);break;case ai.actionType:const o=e;t=this.addPlansToUser(o.plans);break;case et.$.actionType:const l=e;t=this.ensureContainerMappingInStore(l.planEntitySet.plan.container,l.planEntitySet.id);break;case Xe.A.actionType:const c=e;t=this.handleMultiplePlanFetch(c.plans);break;case $e.N.actionType:const d=e;t=this.handleMultiplePlanFetch(d.plans);break;case oi.C.actionType:const u=e;t=this.handleMultiplePlanFetch(u.plans);break;case Qe.O.actionType:const h=e;t=this.ensureContainerMappingInStore(h.planEntitySet.plan.container,h.planEntitySet.id);break;case tt.V.actionType:const p=e;t=this.removeMappingInStore(p.planEntitySet.plan.container.externalId,p.planEntitySet.id);break;case nt.t.actionType:const g=e;t=this.updateMappingInStore(g.planEntitySet.plan.container,g.localId,g.planEntitySet.id);break;case Je.Y.actionType:const m=e;t=this.handleDeletePlan(m.planId,m.planContainer);break;case Ve.l.actionType:const f=e;t=this.handleDeletePlan(f.planId,f.planContainer);break;case ct.T.actionType:const v=e;t=this.handleGroupPlanResolutionSuccess(v);break;case mt.f.actionType:const y=e;t=this.handleContainerPlanResolutionSuccess(y);break;case rt.actionType:const k=e;t=this.ensureContainerMappingInStore(k.plan.plan.container,k.plan.id);break;case hi.e.actionType:t=this.handleCheckCurrentUserToUSMsitTenantMemberSucceededAction(e);break;default:return}t&&this.publishStoreChangedEvent()}addPlansToUser(e){let t=!1;return Ut()(e,e=>{t=this.addPlanIdToUserPlans(e.id,e.container.containerType)||t}),t}addPlanIdToUserPlans(e,t){let n=!1,r=this.userContainerPlanIds[Y.B.currentUserId];return r||(r=new pi,this.userContainerPlanIds[Y.B.currentUserId]=r,n=!0),r.data[t]?r.data[t].contains(e)||(r.data[t].add(e),n=!0):(r.upsert(t,new mr([e])),n=!0),n}removePlanIdsFromStore(e,t){if(null==e||0===e.length)return!1;let n=!1;const r=this.userContainerPlanIds[Y.B.currentUserId];if(!r)return!1;const i=r.data[t];if(!i)return!1;for(const s of e)i.contains(s)&&(i.remove(s),n=!0);return n}handleCheckCurrentUserToUSMsitTenantMemberSucceededAction(e){return e.returnedGroupIds.indexOf(E.YR)>-1&&(this.isUSAndMsitTenantMember=!0,!0)}handleGroupPlanResolutionSuccess(e){let t=!1;for(const i in e.groupPlanMapping){var n,r;const s=null===(n=this.containerToPlansMapping[i])||void 0===n?void 0:n.unwrap;mi()(this.resolvedContainerIds,e=>e===i)||this.resolvedContainerIds.push(i);const a=null===(r=e.groupPlanMapping[i])||void 0===r?void 0:r.map(e=>e.id);null==a?(delete this.containerToPlansMapping[i],t=!0):Bt()(a)?null!=s&&ze()(s,[])||(br.updateItemsInOrInitializeObservableContainer([],this.containerToPlansMapping,i),t=!0):(null!=s&&ze()(s,a)||(br.updateItemsInOrInitializeObservableContainer(a,this.containerToPlansMapping,i),t=!0),a.forEach(e=>{t=this.addPlanIdToUserPlans(e,It.K.Group)||t;const n=this.planToContainerMapping[e];null!=n&&i===n||(this.planToContainerMapping[e]=i,t=!0)}))}return t}handleContainerPlanResolutionSuccess(e){let t=!1;for(const i in e.containerPlanMapping){var n,r;const s=null===(n=this.containerToPlansMapping[i])||void 0===n?void 0:n.unwrap;mi()(this.resolvedContainerIds,e=>e===i)||this.resolvedContainerIds.push(i);const a=null===(r=e.containerPlanMapping[i])||void 0===r?void 0:r.map(e=>e.id);null==a?(delete this.containerToPlansMapping[i],t=!0):Bt()(a)?null!=s&&ze()(s,[])||(br.updateItemsInOrInitializeObservableContainer([],this.containerToPlansMapping,i),t=!0):(null!=s&&ze()(s,a)||(br.updateItemsInOrInitializeObservableContainer(a,this.containerToPlansMapping,i),t=!0),a.forEach(n=>{t=this.addPlanIdToUserPlans(n,e.containerType)||t;const r=this.planToContainerMapping[n];null!=r&&i===r||(this.planToContainerMapping[n]=i,t=!0)}))}return t}handleDeletePlan(e,t){var n;const r=this.planToContainerMapping[e];return!!r&&(null===(n=this.containerToPlansMapping[r])||void 0===n||n.remove(e),delete this.planToContainerMapping[e],this.removePlanIdsFromStore([e],t.containerType),!0)}handleOptimisticGroupCreation(e){var t;const n=null===(t=this.containerToPlansMapping[e])||void 0===t?void 0:t.unwrap;if(null!=n&&ze()(n,[])||br.updateItemsInOrInitializeObservableContainer([],this.containerToPlansMapping,e),this.userJoinedGroupContainerIds[It.K.Group]||(this.userJoinedGroupContainerIds[It.K.Group]=new mr([])),this.userJoinedGroupContainerIds[It.K.Group].contains(e))throw new Error("InvalidOperationException: group membership already exists");return this.userJoinedGroupContainerIds[It.K.Group].add(e),!0}handleFailedGroupCreation(e){var t;if(null===(t=this.userJoinedGroupContainerIds[It.K.Group])||void 0===t||!t.contains(e))throw new Error("InvalidOperationException: groupId not found in store");return delete this.containerToPlansMapping[e],this.userJoinedGroupContainerIds[It.K.Group].remove(e),!0}handleSuccessfulGroupCreation(e,t){var n;if(e===t)return!1;if(null==this.containerToPlansMapping[e])throw new Error("InvalidOperationException: mapping not found in store");if(null===(n=this.userJoinedGroupContainerIds[It.K.Group])||void 0===n||!n.contains(e))throw new Error("InvalidOperationException: oldGroupId not found in store");const r=this.containerToPlansMapping[e];return delete this.containerToPlansMapping[e],this.containerToPlansMapping[t]=r,mi()(this.resolvedContainerIds,e=>e===t)||this.resolvedContainerIds.push(t),this.userJoinedGroupContainerIds[It.K.Group].upsert(e,t),!0}handleMultiplePlanFetch(e){let t=!1;return Ut()(e,e=>{t=this.ensureContainerMappingInStore(e.plan.container,e.id)||t}),t}ensureContainerMappingInStore(e,t){var n;const{externalId:r,containerType:i}=e;let s=!1;return i===It.K.Project||(null!==(n=this.containerToPlansMapping[r])&&void 0!==n&&n.contains(t)||(br.addItemToOrInitializeObservableContainer(t,this.containerToPlansMapping,r),kr.o.isPlexTempId(t)||this.addPlanIdToUserPlans(t,e.containerType),s=!0),null!=this.planToContainerMapping[t]&&this.planToContainerMapping[t]===r||(this.planToContainerMapping[t]=r,s=!0)),s}removeMappingInStore(e,t){if(null==this.containerToPlansMapping[e])throw new Error("UnexpectedException: relevant container's plan mapping list not found in mapping store");if(!this.containerToPlansMapping[e].contains(t))throw new Error("InvalidOperationException: plan not found in mapping list");return this.containerToPlansMapping[e].remove(t),delete this.planToContainerMapping[t],!0}updateMappingInStore(e,t,n){if(null==this.containerToPlansMapping[e.externalId])throw new Error("UnexpectedException: relevant container's plan mapping list not found in mapping store");if(!this.containerToPlansMapping[e.externalId].contains(t))throw new Error("InvalidOperationException: plan not found in mapping list");return t!==n&&(this.containerToPlansMapping[e.externalId].upsert(t,n),delete this.planToContainerMapping[t],this.planToContainerMapping[n]=e.externalId,this.addPlanIdToUserPlans(n,e.containerType),!0)}handleDeleteUnifiedGroupSucceededAction(e){var t;let n=!1;this.userJoinedGroupContainerIds[It.K.Group]?this.userJoinedGroupContainerIds[It.K.Group].contains(e.container.externalId)&&(this.userJoinedGroupContainerIds[It.K.Group].remove(e.container.externalId),n=!0):this.userJoinedGroupContainerIds[It.K.Group]=new mr([]);const r=null===(t=this.containerToPlansMapping[e.container.externalId])||void 0===t?void 0:t.unwrap;return null!=r&&(this.removePlanIdsFromStore(r,e.container.containerType),r.forEach(e=>{delete this.planToContainerMapping[e]}),delete this.containerToPlansMapping[e.container.externalId],n=!0),n}addMembershipInStore(e,t){var n;if(this.userJoinedGroupContainerIds[t]){if(this.userJoinedGroupContainerIds[t].contains(e))throw new Error("InvalidOperationException: group membership already exists")}else this.userJoinedGroupContainerIds[t]=new mr([]);return this.userJoinedGroupContainerIds[t].add(e),Ut()(null===(n=this.containerToPlansMapping[e])||void 0===n?void 0:n.unwrap,e=>{this.addPlanIdToUserPlans(e,t)}),!0}removeMembershipInStore(e,t){var n;if(this.userJoinedGroupContainerIds[t]||(this.userJoinedGroupContainerIds[t]=new mr([])),!this.userJoinedGroupContainerIds[t].contains(e))throw new Error("InvalidOperationException: groupId not found in store");this.userJoinedGroupContainerIds[t].remove(e);const r=null===(n=this.containerToPlansMapping[e])||void 0===n?void 0:n.unwrap;return r&&this.removePlanIdsFromStore(r,t),!0}handleGetJoinedGroupsSucceededAction(e){let t=!1;return e.isFirstPage?(this.userJoinedGroupContainerIds[It.K.Group]=new mr(e.joinedGroups.map(e=>e.id)),t=!0):Ut()(e.joinedGroups,e=>{null!=e&&(this.userJoinedGroupContainerIds[It.K.Group].contains(e.id)||(this.userJoinedGroupContainerIds[It.K.Group].add(e.id),t=!0))}),t}handleGetContainersSucceededAction(e){let t=!1;return e.isFirstPage?(this.userJoinedGroupContainerIds[e.containerType]=new mr(e.containers.map(e=>e.externalId)),t=!0):Ut()(e.containers,n=>{this.userJoinedGroupContainerIds[e.containerType].contains(n.externalId)||(this.userJoinedGroupContainerIds[e.containerType].add(n.externalId),t=!0)}),t}handleGetContainerSucceededAction(e){const{externalId:t,containerType:n}=e.container;if(n===It.K.Group){const t=e.container;if(null==t.unifiedGroupDetails||t.unifiedGroupDetails.currentUserRelationToGroup===xt.N.NonMember)return!1}return this.userJoinedGroupContainerIds[n]?!this.userJoinedGroupContainerIds[n].contains(t)&&(this.userJoinedGroupContainerIds[n].add(t),!0):(this.userJoinedGroupContainerIds[n]=new mr([t]),!0)}handleGetUnifiedGroupDetailsSucceededAction(e){return e.unifiedGroupDetails.currentUserRelationToGroup!==xt.N.NonMember&&(this.userJoinedGroupContainerIds[It.K.Group]?!this.userJoinedGroupContainerIds[It.K.Group].contains(e.unifiedGroupDetails.id)&&(this.userJoinedGroupContainerIds[It.K.Group].add(e.unifiedGroupDetails.id),!0):(this.userJoinedGroupContainerIds[It.K.Group]=new mr([e.unifiedGroupDetails.id]),!0))}constructor(){super(),this.userJoinedGroupContainerIds={},this.userContainerPlanIds={},this.containerToPlansMapping={},this.planToContainerMapping={},this.resolvedContainerIds=[],this.isUSAndMsitTenantMember=!1}}var vi=n(28673),yi=n.n(vi),ki=n(55637),Ti=n(88786),Si=n(32084),bi=n(58245),Ii=n(19879),Ci=n(72261),Di=n(77292),Ei=n(51873),Pi=n(95799),wi=n(9614),xi=n(78751),Ai=n(85224),Fi=n(8165),Li=n(24590),_i=n(3519),Ui=n(86697),Oi=n(65060),Bi=n(31364),Mi=n(44227),Ni=n(88457),Ri=n(6189);class Gi{get value(){return this._subject.value}get valueObservable(){return this._observable}update(e){this._subject.next(Pn()(e))}constructor(e,t){this.customComparator=t,this._subject=new cr(Pn()(e)),this._observable=this._subject.asObservable().pipe(pr((e,t)=>xn()(e,t,this.customComparator)))}}class Wi extends Ce.z{get name(){return"PlannerContainerStore"}getContainer(e){var t,n;return null!==(t=null===(n=this.containers[e])||void 0===n?void 0:n.value)&&void 0!==t?t:null}getContainers(e){return e.filter(e=>{var t;return null!=(null===(t=this.containers[e])||void 0===t?void 0:t.value)}).map(e=>this.containers[e].value)}getContainersByContainerType(e){const t=this.containerIdsByContainerType[e];return null==t?null:t.filter(e=>{var t;return null!=(null===(t=this.containers[e])||void 0===t?void 0:t.value)}).map(e=>this.containers[e].value)}getContainerConversationThread(e,t){const n=this.groupConversationThreads[e];var r,i;return null!=n&&null!==(r=null===(i=n[t])||void 0===i?void 0:i.unwrap)&&void 0!==r?r:null}isThreadNotFound(e,t){const n=this.notFoundThreads[e];if(null==n)return!1;const r=n[t];return null!=r&&r}getContainerPhotoById(e){var t,n;return null!==(t=null===(n=this.groupPhotosContainer[e])||void 0===n?void 0:n.value)&&void 0!==t?t:null}handleAction(e){let t=!1;switch(e.type){case Si.x.actionType:this.handleCleanConversationThreadAction(e);break;case Mi.A.actionType:t=this.handleCreateRosterContainerSucceededAction(e);break;case li.K.actionType:t=this.handleCreateUnifiedGroupAction(e);break;case ci.b.actionType:t=this.handleCreateUnifiedGroupFailedAction(e);break;case di.x.actionType:t=this.handleCreateUnifiedGroupSucceededAction(e);break;case ut.P.actionType:t=this.handleGetUnifiedGroupDetailsSucceededAction(e);break;case ui.F.actionType:t=this.handleGetJoinedGroupsSucceededAction(e);break;case bi.W.actionType:t=this.handleGetGroupPhotosSuccess(e);break;case Ii.k.actionType:t=this.handleGetUnifiedGroupSensitivityLabelSucceededAction(e);break;case Ci.c.actionType:t=!0;break;case Di.v.actionType:t=this.handleUpdateUnifiedGroup(e);break;case Ei.w.actionType:t=this.handleUpdateUnifiedGroupFailure(e);break;case Pi.U.actionType:t=this.handleUpdateUnifiedGroupSucceeded(e);break;case ki.G.actionType:t=this.handleUpdateContainerSucceededAction(e);break;case wi.H.actionType:t=this.handleDeleteUnifiedGroup(e);break;case xi.W.actionType:t=this.handleDeleteUnifiedGroupFailure(e);break;case dt.s.actionType:t=this.handleDeleteUnifiedGroupSucceeded(e);break;case Ti.D.actionType:t=this.handleGetConversationThreadPostSucceededAction(e);break;case Ai.f.actionType:t=this.handleGetConversationThreadSucceededAction(e);break;case Fi.q.actionType:t=this.handlePostConversationThreadReplyAction(e);break;case Li.B.actionType:t=this.handleCreateConversationThreadAction(e);break;case _i.M.actionType:t=this.handleCreateConversationThreadFailedAction(e);break;case Ui.E.actionType:t=this.handleCreateConversationThreadSucceededAction(e);break;case Oi.d.actionType:t=this.handlePostConversationThreadReplyFailedAction(e);break;case Bi.z.actionType:t=this.handlePostConversationThreadReplySucceededAction(e);break;case pt.w.actionType:t=this.handleJoinUnifiedGroupSucceededAction(e);break;case gt.v.actionType:t=this.handleLeaveUnifiedGroupSucceededAction(e);break;case kt.L.actionType:t=this.handleContainerSucceededAction(e);break;case si.A.actionType:t=this.handleGetContainersSucceededAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleJoinUnifiedGroupSucceededAction(e){var t;const n=this.getGroupStoreContainer(e.containerId),r=null!==(t=null===n||void 0===n?void 0:n.unifiedGroupDetails)&&void 0!==t?t:null;if(null==r)throw new Error("AggregateException: unifiedGroupDetails not found in store");let i=!1;if(r.currentUserRelationToGroup!==xt.N.Member){const e=r.toWebSerializable();e.CurrentUserRelationToGroup=xt.N.Member;const t=Ri.y.builder.fromUnifiedGroupDetailsResource(e).build(),s=new Ni.Z(r.id,n.unifiedGroup,t);this.containers[r.id].update(s),i=!0}return i}handleLeaveUnifiedGroupSucceededAction(e){var t;const n=this.getGroupStoreContainer(e.containerId),r=null!==(t=null===n||void 0===n?void 0:n.unifiedGroupDetails)&&void 0!==t?t:null;if(null==r)throw new Error("AggregateException: unifiedGroupDetails not found in store");let i=!1;if(r.currentUserRelationToGroup!==xt.N.NonMember){const e=r.toWebSerializable();e.CurrentUserRelationToGroup=xt.N.NonMember;const t=Ri.y.builder.fromUnifiedGroupDetailsResource(e).build(),s=new Ni.Z(r.id,n.unifiedGroup,t);this.containers[r.id].update(s),i=!0}return i}handleDeleteUnifiedGroup(e){var t;const n=this.getGroupStoreContainer(e.unifiedGroupId);if(null==(null!==(t=null===n||void 0===n?void 0:n.unifiedGroup)&&void 0!==t?t:null))throw new Error("AggregateException: unifiedGroup not found in store");return!0}handleDeleteUnifiedGroupFailure(e){var t;const n=this.getGroupStoreContainer(e.unifiedGroupId);if(null==(null!==(t=null===n||void 0===n?void 0:n.unifiedGroup)&&void 0!==t?t:null))throw new Error("AggregateException: unifiedGroup not found in store");return!0}handleDeleteUnifiedGroupSucceeded(e){var t;const n=this.getGroupStoreContainer(e.container.externalId),r=null!==(t=null===n||void 0===n?void 0:n.unifiedGroup)&&void 0!==t?t:null;if(null==r)throw new Error("AggregateException: unifiedGroup not found in store");return delete this.containers[r.id],!0}handleCreateRosterContainerSucceededAction(e){var t;return this.containers[e.container.externalId]=new Gi(e.container),this.containerIdsByContainerType[It.K.Roster]=[...null!==(t=this.containerIdsByContainerType[It.K.Roster])&&void 0!==t?t:[],e.container.externalId],!0}handleCreateUnifiedGroupAction(e){const t=kr.o.isPlexTempId(e.unifiedGroup.id),n=new Ni.Z(e.unifiedGroup.id,e.unifiedGroup,null);return t&&null!=this.containers[e.unifiedGroup.id]||(this.containers[e.unifiedGroup.id]=new Gi(n)),!0}handleCreateUnifiedGroupFailedAction(e){if(null==this.getGroupStoreContainer(e.localId))throw new Error("AggregateException: group not found in store");return delete this.containers[e.localId],!0}handleCreateUnifiedGroupSucceededAction(e){if(null==this.containers[e.localId])throw new Error("AggregateException: group not found in store");if(e.localId===e.unifiedGroup.id)return!1;delete this.containers[e.localId];const t=new Ni.Z(e.unifiedGroup.id,e.unifiedGroup,null);return this.containers[e.unifiedGroup.id]=new Gi(t),!0}handleContainerSucceededAction(e){const t=this.containers[e.container.externalId];return e.container.containerType===It.K.Group?this.handleGetUnifiedGroupContainer(e.container):e.container.containerType===It.K.Roster?this.handleGetRosterContainer(e.container):null==t&&(this.containers[e.container.externalId]=new Gi(e.container),!0)}handleGetUnifiedGroupContainer(e){let t=!1;const n=e.unifiedGroup;if(null!=n){var r;const e=this.getGroupStoreContainer(n.id),s=null!==(r=null===e||void 0===e?void 0:e.unifiedGroup)&&void 0!==r?r:null;var i;if(null==s||!ze()(s,n))this.containers[n.id]=new Gi(new Ni.Z(n.id,n,null!==(i=null===e||void 0===e?void 0:e.unifiedGroupDetails)&&void 0!==i?i:null)),t=!0;null==this.groupConversationThreads[n.id]&&(this.groupConversationThreads[n.id]={},t=!0)}return t}handleGetRosterContainer(e){const t=this.getRosterStoreContainer(e.externalId);let n=!1;return null!=t&&ze()(t,e)||(this.containers[e.externalId]=new Gi(e),n=!0),n}handleGetUnifiedGroupDetailsSucceededAction(e){let t=!1;const n=e.unifiedGroupDetails;if(null!=n){const e=this.getGroupStoreContainer(n.id);if(null==e)throw new Error("AggregateException: group not found in store");const r=e.unifiedGroupDetails;null!=r&&ze()(r,n)||(this.containers[n.id]=new Gi(new Ni.Z(n.id,e.unifiedGroup,n)),t=!0),null==this.groupConversationThreads[n.id]&&(this.groupConversationThreads[n.id]={},t=!0)}return t}handleGetJoinedGroupsSucceededAction(e){let t=!1;return Ut()(e.joinedGroups,e=>{if(null!=e){var n;const i=this.getGroupStoreContainer(e.id),s=null!==(n=null===i||void 0===i?void 0:i.unifiedGroup)&&void 0!==n?n:null;var r;if(null==s||!ze()(s,e))this.containers[e.id]=new Gi(new Ni.Z(e.id,e,null!==(r=null===i||void 0===i?void 0:i.unifiedGroupDetails)&&void 0!==r?r:null)),t=!0;null==this.groupConversationThreads[e.id]&&(this.groupConversationThreads[e.id]={},t=!0)}}),t}handleGetGroupPhotosSuccess(e){const t=yi()(e.groupPhotos);let n=!1;return Ut()(t,t=>{var r;const i=null===(r=this.groupPhotosContainer[t])||void 0===r?void 0:r.value;i!==e.groupPhotos[t]&&(null==i?this.groupPhotosContainer[t]=new Gi(e.groupPhotos[t]):this.groupPhotosContainer[t].update(e.groupPhotos[t]),n=!0)}),n}handleGetUnifiedGroupSensitivityLabelSucceededAction(e){var t;const n=this.getGroupStoreContainer(e.groupId);let r=null!==(t=null===n||void 0===n?void 0:n.unifiedGroup)&&void 0!==t?t:null;if(null==r||null==n)throw new Error("AggregateException: unifiedGroup not found in store");let i=!1;return ze()(r.assignedSensitivityLabelId,e.sensitivityLabelId)||(r=r.setProperty("assignedSensitivityLabelId",e.sensitivityLabelId),this.containers[r.id]=new Gi(new Ni.Z(r.id,r,n.unifiedGroupDetails)),i=!0),i}handleUpdateUnifiedGroup(e){var t;const n=this.getGroupStoreContainer(e.group.id),r=null!==(t=null===n||void 0===n?void 0:n.unifiedGroup)&&void 0!==t?t:null;if(null==r)throw new Error("AggregateException: unifiedGroup not found in store");let i=!1;return ze()(r,e.group)||(this.containers[r.id]=new Gi(new Ni.Z(r.id,e.group,n.unifiedGroupDetails)),i=!0),i}handleUpdateUnifiedGroupFailure(e){var t;const n=this.getGroupStoreContainer(e.originalGroup.id),r=null!==(t=null===n||void 0===n?void 0:n.unifiedGroup)&&void 0!==t?t:null;if(null==r)throw new Error("AggregateException: unifiedGroup not found in store");let i=!1;return ze()(r,e.originalGroup)||(this.containers[r.id]=new Gi(new Ni.Z(r.id,e.originalGroup,n.unifiedGroupDetails)),i=!0),i}handleUpdateUnifiedGroupSucceeded(e){var t;const n=this.getGroupStoreContainer(e.group.id),r=null!==(t=null===n||void 0===n?void 0:n.unifiedGroup)&&void 0!==t?t:null;if(null==r)throw new Error("AggregateException: unifiedGroup not found in store");let i=!1;return ze()(r,e.group)||(this.containers[r.id]=new Gi(new Ni.Z(r.id,e.group,n.unifiedGroupDetails)),i=!0),i}handleUpdateContainerSucceededAction(e){const t=this.getRosterStoreContainer(e.container.externalId);if(null==t)throw new Error("AggregateException: roster container not found in store");let n=!1;return ze()(t,e.container)||(this.containers[t.externalId]=new Gi(e.container),n=!0),n}handleGetConversationThreadSucceededAction(e){let t=!1,n=this.groupConversationThreads[e.groupId];return null==n&&(n={},t=!0),null!=n[e.threadId]&&ze()(n[e.threadId].unwrap,e.conversationThread)||(br.updateItemsInOrInitializeObservableContainer(e.conversationThread,n,e.threadId,yr.lz.isEqualMomentCustomizer),t=!0),t&&(this.groupConversationThreads[e.groupId]=n),t}handleCreateConversationThreadAction(e){const t=e.groupId,n=e.threadId;let r=this.groupConversationThreads[t];return null==r&&(r={}),br.addItemToOrInitializeObservableContainer(e.newPost,r,n,yr.lz.isEqualMomentCustomizer),this.groupConversationThreads[t]=r,!0}handleGetConversationThreadPostSucceededAction(e){let t=!1;const n=this.groupConversationThreads[e.groupId];if(null==n)return!1;const r=e.conversationThreadPost,i=n[e.threadId].unwrap,s=[];return null!==i&&(Ut()(i,e=>{e.id===r.id?s.push(r):s.push(e)}),br.updateItemsInOrInitializeObservableContainer(s,n,e.threadId,yr.lz.isEqualMomentCustomizer),t=!0),t&&(this.groupConversationThreads[e.groupId]=n),t}handleCreateConversationThreadFailedAction(e){let t=!1;const n=e.groupId,r=e.threadId,i=this.groupConversationThreads[n];if(null==i)return!1;return null!=i[r]&&(delete i[r],t=!0),t&&(this.groupConversationThreads[n]=i),t}handleCreateConversationThreadSucceededAction(e){const t=e.groupId,n=e.localThreadId,r=e.threadId,i=this.groupConversationThreads[t];if(null==i)throw new Error("NotFoundException: groupConversationThread");const s=i[n];return s.upsert(e.localPost,e.newPost),n!==r&&(delete i[n],i[r]=s),this.groupConversationThreads[t]=i,!0}handlePostConversationThreadReplyAction(e){const t=e.groupId,n=e.threadId,r=this.groupConversationThreads[t];return null==r||null==r[n]?(this.loggers.traceLogger.logTrace(507832320,Rt.k.Info,null==r?"PostConversationThreadReply groupThreads are null groupId=[".concat(t,"] threadId=[").concat(n,"]"):"PostConversationThreadReply thread is null groupId=[".concat(t,"] threadId=[").concat(n,"]")),!1):(r[n].add(e.newPost),this.groupConversationThreads[t]=r,!0)}handlePostConversationThreadReplyFailedAction(e){const t=e.groupId,n=e.threadId,r=this.groupConversationThreads[t];if(null==r)return this.loggers.traceLogger.logTrace(507832291,Rt.k.Warning,"PostConversationThreadReplyFailed groupThreads are null groupId=[".concat(t,"] threadId=[").concat(n,"]")),!1;const i=r[n];return null==i?(this.loggers.traceLogger.logTrace(507832290,Rt.k.Info,"PostConversationThreadReplyFailed thread is null groupId=[".concat(t,"] threadId=[").concat(n,"]")),!1):(i.remove(e.newPost),r[n]=i,this.groupConversationThreads[t]=r,!0)}handlePostConversationThreadReplySucceededAction(e){const t=e.groupId,n=e.threadId,r=this.groupConversationThreads[t];if(null==r||null==r[n])return this.loggers.traceLogger.logTrace(507832289,Rt.k.Warning,null==r?"PostConversationThreadReplySucceeded groupThreads are null groupId=[".concat(t,"] threadId=[").concat(n,"]"):"PostConversationThreadReplySucceeded thread is null groupId=[".concat(t,"] threadId=[").concat(n,"]")),!1;return r[n].upsert(e.localPost,e.newPost),this.groupConversationThreads[t]=r,!0}handleCleanConversationThreadAction(e){let t=this.groupConversationThreads[e.groupId];null==t&&(t={}),delete t[e.threadId],this.groupConversationThreads[e.groupId]=t;let n=this.notFoundThreads[e.groupId];n||(n={}),n[e.threadId]=!0,this.notFoundThreads[e.groupId]=n}handleGetContainersSucceededAction(e){let t=!1;e.isFirstPage&&(this.containerIdsByContainerType[e.containerType]=[],t=!0);const n=e.containers,r=n.map(e=>e.externalId),i=this.containerIdsByContainerType[e.containerType];return null==i?(this.containerIdsByContainerType[e.containerType]=r,t=!0):r.forEach(e=>{-1===i.indexOf(e)&&(i.push(e),t=!0)}),n.forEach(e=>{null==this.containers[e.externalId]&&(this.containers[e.externalId]=new Gi(e),t=!0)}),t}getGroupStoreContainer(e){var t;const n=null===(t=this.containers[e])||void 0===t?void 0:t.value;return(null===n||void 0===n?void 0:n.containerType)===It.K.Group?n:null}getRosterStoreContainer(e){var t;const n=null===(t=this.containers[e])||void 0===t?void 0:t.value;return(null===n||void 0===n?void 0:n.containerType)===It.K.Roster?n:null}constructor(e){super(),this.loggers=e,this.containers={},this.containerIdsByContainerType={},this.groupConversationThreads={},this.groupPhotosContainer={},this.notFoundThreads={}}}var zi=n(53211),ji=n(7574);class Ki extends $.r{constructor(e){super(Ki.actionType),this.planId=e}}Ki.actionType="PLW_REMOVE_PLAN_FROM_RECOMMENDED_LIST";class Hi extends $.r{loggingData(){return{recommendedPlanCount:String(this.planIds.length)}}constructor(e){super(Hi.actionType),this.planIds=e}}Hi.actionType="PLW_SET_RECOMMENDED_PLANS";var Vi=n(35879),Zi=n(89190),qi=n(28242),Yi=n(42045),Ji=n(79387),Xi=n(51710),$i=n(73615);class Qi extends $.r{constructor(e,t){super(Qi.actionType),this.updatedPlanEntitySet=e,this.updateKey=t}}Qi.actionType="PLW_MOVE_PLAN";class es extends $.r{constructor(e,t){super(es.actionType),this.movedPlanEntitySet=e,this.updateKey=t}}es.actionType="PLW_MOVE_PLAN_SUCCEEDED";class ts extends $.r{constructor(e,t){super(ts.actionType),this.planId=e,this.updateKey=t}}ts.actionType="PLW_MOVE_PLAN_FAILED";var ns=n(63148),rs=n(87920),is=n(24322),ss=n(40468),as=n(56707),os=n.n(as);class ls extends Ce.z{get name(){return"PlannerPlanStore"}resolveLocalPlanId(e){var t;return null!==(t=this.localIdToServiceIdMap[e])&&void 0!==t?t:null}deleteLocalPlanId(e){delete this.localIdToServiceIdMap[e]}getPlan(e){var t,n;return null!==(t=null===(n=this.plansByInternalId[e])||void 0===n?void 0:n.value)&&void 0!==t?t:null}getPlanStatus(e){var t;return null!==(t=this.planStatusesByInternalId[e])&&void 0!==t?t:null}getPlanByExternalId(e,t){const n=Dn.x.generateEntityExternalId(e,t),r=this.externalIdToIdMap[n];return null==r?null:this.getPlan(r)}getRecommendedPlanIds(){return this.recommendedPlanIds.filter(e=>this.favoritedRecommendedPlanIds.indexOf(e)<0)}getPlanWithoutPendingUpdates(e){var t,n;return null!==(t=null===(n=this.plansByInternalId[e])||void 0===n?void 0:n.baseline)&&void 0!==t?t:null}getPlanDetails(e){var t,n;return null!==(t=null===(n=this.planDetails[e])||void 0===n?void 0:n.value)&&void 0!==t?t:null}getPlanDetailsWithoutPendingUpdates(e){var t,n;return null!==(t=null===(n=this.planDetails[e])||void 0===n?void 0:n.baseline)&&void 0!==t?t:null}getContainerIdForPlan(e){var t,n;return null!==(t=null===(n=this.plansByInternalId[e])||void 0===n?void 0:n.baseline.container.externalId)&&void 0!==t?t:null}getContainerIdForMovePlan(e){var t,n;return null!==(t=null===(n=this.movePlanStatus[e])||void 0===n?void 0:n.containerId)&&void 0!==t?t:null}getMovePlanStatus(e){var t,n;return null!==(t=null===(n=this.movePlanStatus[e])||void 0===n?void 0:n.transactionStatus)&&void 0!==t?t:void 0}handleAction(e){let t=!1;switch(e.type){case Qe.O.actionType:const n=e;t=this.handleOptimisticPlanCreation(n);break;case tt.V.actionType:const r=e;t=this.handlePlanCreationFailure(r);break;case nt.t.actionType:const i=e;t=this.handlePlanCreationSuccess(i);break;case ai.actionType:const s=e;t=this.handlePlansFetch(s.plans);break;case zi.Q.actionType:const a=e;t=this.handleStartPlanFetch(a.planId);break;case et.$.actionType:const o=e;t=this.handlePlanFetch(o.planEntitySet);break;case ji.j.actionType:const l=e;t=this.handlePlanFetchFailure(l);break;case Xe.A.actionType:const c=e;t=this.handleMultiPlanFetch(c.plans);break;case $e.N.actionType:const d=e;t=this.handleMultiPlanFetch(d.plans);break;case oi.C.actionType:const u=e;t=this.handleMultiPlanFetch(u.plans);break;case Ki.actionType:const h=e;t=this.handleRecommendedPlanRemoval(h.planId);break;case Hi.actionType:const p=e;t=this.handleRecommendedPlansFetch(p.planIds);break;case ct.T.actionType:const g=e;os()(g.groupPlanMapping).forEach(e=>{null===e||void 0===e||e.forEach(e=>{t=this.handlePlanFetch(ss.T.builder.withPlan(e).build())||t})});break;case mt.f.actionType:const m=e;os()(m.containerPlanMapping).forEach(e=>{null===e||void 0===e||e.forEach(e=>{t=this.handlePlanFetch(ss.T.builder.withPlan(e).build())||t})});break;case Vi.U.actionType:const f=e;t=this.handleUpdatePlanEntityAction(f);break;case Zi.F.actionType:const v=e;t=this.handleUpdatePlanEntitySucceededAction(v);break;case qi.R.actionType:const y=e;t=this.handleUpdatePlanEntityFailedAction(y);break;case rs.w.actionType:const k=e;t=this.handleUpdateUserDetailsAction(k);break;case Yi.Z.actionType:const T=e;t=this.handleDiffSyncUpdatePlanEntity(T);break;case Ji.T.actionType:t=this.handleDiffSyncUpdatePlanDetails(e.details);break;case Ze.z.actionType:const S=e;t=this.handleUpdateUserDetailsAction(S);break;case Xi.H.actionType:t=this.handlePlanDeletion(e);break;case Je.Y.actionType:t=this.handlePlanDeletionSuccess(e);break;case $i.U.actionType:t=this.handlePlanDeletionFailure(e);break;case Ve.l.actionType:t=this.handleDiffSyncDeletePlan(e);break;case rt.actionType:const b=e;t=this.handlePlanFetch(b.plan);break;case is.T.actionType:e.plans.forEach(e=>{t=this.handlePlanFetch(ss.T.builder.withPlan(e).build())||t});break;case Qi.actionType:const I=e;t=this.handleMovePlanAction(I.updatedPlanEntitySet,I.updateKey);break;case es.actionType:const C=e;t=this.handleMovePlanSucceededAction(C.movedPlanEntitySet,C.updateKey);break;case ts.actionType:const D=e;t=this.handleMovePlanFailedAction(D);break;case ns.Z.actionType:const E=e;t=this.handleUpdateStatusForMovePlanAction(E);break;default:return}t&&this.publishStoreChangedEvent()}handlePlanDeletion(e){const t=e.planId,n=this.plansByInternalId[t];if(null==n)throw new Error("AggregateException: plan not found in store");return n.softDelete(),!0}handlePlanDeletionFailure(e){const t=e.planId,n=this.plansByInternalId[t];if(null==n)throw new Error("AggregateException: plan not found in store");return n.undelete(),!0}handlePlanDeletionSuccess(e){const t=e.planId,n=this.plansByInternalId[t];if(null==n)throw new Error("AggregateException: plan not found in store");return this.deletePlanFromStore(n.baseline.id),-1!==this.recommendedPlanIds.indexOf(n.baseline.id)&&this.removePlanFromRecommendedList(n.baseline.id),!0}handleDiffSyncDeletePlan(e){const t=e.planId;let n=!1;const r=this.plansByInternalId[t];return null!=r&&(this.deletePlanFromStore(e.planId),-1!==this.recommendedPlanIds.indexOf(r.baseline.id)&&this.removePlanFromRecommendedList(r.baseline.id),n=!0),n}handleUpdatePlanEntityAction(e){let t=!1;const n=e.updatedLocalPlanEntitySet,r=this.plansByInternalId[n.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");if(ze()(r.value,n.plan)||(r.pushDelta(n.plan,e.updateKey),t=!0),null!=n.planDetails){const r=this.planDetails[n.planDetails.id];if(null==r)throw new Error("AggregateException: plan details not found in store");ze()(r.value,n.planDetails)||(r.pushDelta(n.planDetails,e.updateKey),t=!0)}return t}handleUpdatePlanEntityFailedAction(e){let t=!1;const n=e.originalPlanEntitySet,r=this.plansByInternalId[n.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");if(r.getDelta(e.updateKey)&&(r.revertDelta(e.updateKey),t=!0),n.planDetails){const r=this.planDetails[n.planDetails.id];if(null==r)throw new Error("AggregateException: plan details not found in store");r.getDelta(e.updateKey)&&(r.revertDelta(e.updateKey),t=!0)}return t}handleUpdatePlanEntitySucceededAction(e){let t=!1;const n=e.updatedPlanEntitySet,r=this.plansByInternalId[n.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");if(r.getDelta(e.updateKey)&&(r.commitDelta(e.updateKey,n.plan),t=!0),n.planDetails){const r=this.planDetails[n.planDetails.id];if(null==r)throw new Error("AggregateException: plan details not found in store");r.getDelta(e.updateKey)&&(r.commitDelta(e.updateKey,n.planDetails),t=!0)}return t}handleMovePlanAction(e,t){let n=!1;const r=this.plansByInternalId[e.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");return ze()(r.value,e.plan)||(r.pushDelta(e.plan,t),this.movePlanStatus[e.plan.id]={containerId:e.plan.externalId,transactionStatus:be.x.Pending},n=!0),n}handleMovePlanSucceededAction(e,t){let n=!1;const r=this.plansByInternalId[e.plan.id];if(null==r)throw new Error("AggregateException: plan not found in store");return r.getDelta(t)&&(r.commitDelta(t,e.plan),this.movePlanStatus[e.plan.id]={containerId:e.plan.container.externalId,transactionStatus:be.x.Succeeded},n=!0),n}handleMovePlanFailedAction(e){const{planId:t,updateKey:n}=e,r=this.plansByInternalId[e.planId];if(null==r)throw new Error("AggregateException: plan not found in store");return!!r.getDelta(n)&&(r.revertDelta(n),this.movePlanStatus[t]={containerId:r.value.container.externalId,transactionStatus:be.x.Failed},!0)}handleUpdateStatusForMovePlanAction(e){return null===e.planMoveData.containerId&&void 0===e.planMoveData.transactionStatus?delete this.movePlanStatus[e.planId]:this.movePlanStatus[e.planId]=e.planMoveData,!0}handleDiffSyncUpdatePlanEntity(e){const t=e.planEntitySet;let n=!1;const r=this.plansByInternalId[t.plan.id];return ze()(null===r||void 0===r?void 0:r.baseline,t.plan)||(null==r?this.plansByInternalId[t.plan.id]=new fr.w(t.plan):r.updateBaseline(t.plan),n=!0),t.planDetails&&(n=this.handleDiffSyncUpdatePlanDetails(t.planDetails)||n),n}handleDiffSyncUpdatePlanDetails(e){const t=this.planDetails[e.id];return!ze()(null===t||void 0===t?void 0:t.baseline,e)&&(null==t?this.planDetails[e.id]=new fr.w(e):t.updateBaseline(e),!0)}handleUpdateUserDetailsAction(e){let t=!1;const n=e.userDetails.favoritePlans.references,r=this.favoritedRecommendedPlanIds;return Ut()(this.recommendedPlanIds,e=>{if(null!=n[e])this.favoritedRecommendedPlanIds.indexOf(e)<0&&this.favoritedRecommendedPlanIds.push(e);else{const t=this.favoritedRecommendedPlanIds.indexOf(e);t>-1&&this.favoritedRecommendedPlanIds.splice(t,1)}}),ze()(r,this.favoritedRecommendedPlanIds)||(t=!0),t}handlePlansFetch(e){let t=!1;return Ut()(e,e=>{if(null!=e){const n=this.plansByInternalId[e.id];null==n?(t=!0,this.addPlanToStoreIndexes(new fr.w(e))):ze()(n.baseline,e)||(n.updateBaseline(e),t=!0)}}),t}handleRecommendedPlansFetch(e){let t=!1;for(const n of e)-1===this.recommendedPlanIds.indexOf(n)&&(this.recommendedPlanIds.push(n),t=!0);return t}handleRecommendedPlanRemoval(e){let t=!1;return this.recommendedPlanIds.indexOf(e)>-1&&(this.removePlanFromRecommendedList(e),t=!0),t}handleStartPlanFetch(e){let t=!1;return null!=this.planStatusesByInternalId[e]&&(delete this.planStatusesByInternalId[e],t=!0),t}handlePlanFetch(e){let t=!1;const n=this.plansByInternalId[e.id];if(null==n?(t=!0,this.addPlanToStoreIndexes(new fr.w(e.plan))):ze()(n.baseline,e.plan)||(n.updateBaseline(e.plan),t=!0),null!=e.planDetails){const n=this.planDetails[e.id];null==n?(t=!0,this.planDetails[e.id]=new fr.w(e.planDetails)):ze()(n.baseline,e.planDetails)||(n.updateBaseline(e.planDetails),t=!0)}return t}handlePlanFetchFailure(e){var t,n;let r=!1;if(null==e.planId)return r;const i=this.planStatusesByInternalId[e.planId];return(null===(t=e.response)||void 0===t?void 0:t.status)===Ge.t3.Forbidden?i!==D.ZB.Inaccessible&&(this.planStatusesByInternalId[e.planId]=D.ZB.Inaccessible,r=!0):(null===(n=e.response)||void 0===n?void 0:n.status)===Ge.t3.NotFound?i!==D.ZB.NotFound&&(this.planStatusesByInternalId[e.planId]=D.ZB.NotFound,r=!0):i!==D.ZB.Failed&&(this.planStatusesByInternalId[e.planId]=D.ZB.Failed,r=!0),r}handleMultiPlanFetch(e){let t=!1;return e.forEach(e=>{t=this.handlePlanFetch(e)||t}),t}handleOptimisticPlanCreation(e){const t=e.planEntitySet;if(null!=this.plansByInternalId[t.id])throw new Error("AggregateException: plan already exists in store");return this.plansByInternalId[t.id]=new fr.w(t.plan),t.planDetails&&(this.planDetails[t.id]=new fr.w(t.planDetails)),!0}handlePlanCreationFailure(e){const t=e.planEntitySet,n=this.plansByInternalId[t.id];if(null==n)throw new Error("AggregateException: plan not found in store");return delete this.plansByInternalId[n.baseline.id],delete this.planDetails[n.baseline.id],!0}handlePlanCreationSuccess(e){const t=e.planEntitySet,n=e.localId,r=this.plansByInternalId[n];if(null==r)throw new Error("AggregateException: plan not found in store");this.deletePlanFromStore(n),r.updateBaseline(t.plan),this.addPlanToStoreIndexes(r);const i=this.planDetails[n];return delete this.planDetails[n],t.planDetails&&(null==i?this.planDetails[t.id]=new fr.w(t.planDetails):(i.updateBaseline(t.planDetails),this.planDetails[t.id]=i)),this.localIdToServiceIdMap[n]=t.plan.id,!0}addPlanToStoreIndexes(e){const t=e.value.id;this.plansByInternalId[t]=e,this.planStatusesByInternalId[t]=D.ZB.Stable;const n=e.value.externalId;null!=n&&(this.externalIdToIdMap[n]=t)}deletePlanFromStore(e){if(null==e)return;const t=this.plansByInternalId[e].value.externalId;delete this.planDetails[e],delete this.plansByInternalId[e],delete this.planStatusesByInternalId[e],null!=t&&delete this.externalIdToIdMap[t]}removePlanFromRecommendedList(e){const t=this.recommendedPlanIds.indexOf(e);-1!==t&&this.recommendedPlanIds.splice(t,1)}constructor(){super(),this.plansByInternalId={},this.planStatusesByInternalId={},this.planDetails={},this.localIdToServiceIdMap={},this.externalIdToIdMap={},this.recommendedPlanIds=[],this.favoritedRecommendedPlanIds=[],this.movePlanStatus={}}}var cs=n(74236),ds=n(79757),us=n(69292),hs=n(96693),ps=n(40164),gs=n(45721),ms=n(26715),fs=n(23614),vs=n(80837),ys=n(77910),ks=n(55694),Ts=n(45795),Ss=n(16701),bs=n(35525),Is=n(72866),Cs=n(62687);class Ds{get(e){const t=this.cache.get(e);return t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.max){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}dump(){return Array.from(this.cache.entries()).map(e=>{let[t,n]=e;return{k:t,v:n}})}keys(){return Array.from(this.cache.keys())}load(e){this.cache.clear(),e.forEach(e=>{let{k:t,v:n}=e;this.set(t,n)})}delete(e){return this.cache.delete(e)}constructor(e){if(this.cache=new Map,e<=0)throw new Error("Max should be a positive number");this.max=e}}class Es{get(e){return this.lruCache.get(e)}set(e,t){this.lruCache.set(e,t),this.persistCache()}load(e){this.lruCache.load(e)}keys(){return this.lruCache.keys()}delete(e){const t=this.lruCache.delete(e);return this.persistCache(),t}persistCache(){const e=this.lruCache.dump();this.persistedStorage.setItem(this.storageKey,JSON.stringify(e))}dump(){return this.lruCache.dump()}constructor(e,t,n){this.persistedStorage=e,this.storageKey=t,this.lruCache=new Ds(n)}}class Ps extends Ce.z{get name(){return"PlannerViewStore"}hydrateFromPersistentStorage(){if(!this.persistedStorage)return;if(Y.B.clientType===Ts.s.Plex&&!Y.B.isUnoContext&&Y.B.clientSettings.Flights.EnableViewPersistence){var e;const t=this.getStorageKey(Ps.TaskGroupingStateKey),n=null===(e=this.persistedStorage)||void 0===e?void 0:e.getItem(t);if(null!=n)try{this.currentTaskGroupingState=JSON.parse(n),this.loggers.traceLogger.logTrace(506549205,Rt.k.Info,"Hydrated task grouping state [Store=".concat(this.name,"][Key=").concat(t,"]"))}catch(l){this.loggers.traceLogger.logTrace(507832288,Rt.k.Warning,"Hydration error [Store=ViewStore][Context=TaskGroupingState][Value=".concat(n,"]"))}}const t=this.getStorageKey(Ps.TaskFiltersKey),n=this.persistedStorage.getItem(t);if(null!=n)try{const e=JSON.parse(n).map(e=>{const t=e.v.filters.map(e=>new Is.d(e.field,e.values));return(0,r.A)((0,r.A)({},e),{},{v:new Is.S(t)})});this.taskFilterLRUCache.load(e),this.loggers.traceLogger.logTrace(506549204,Rt.k.Info,"Hydrated task filters [Store=".concat(this.name,"][Key=").concat(t,"]"))}catch(l){this.loggers.traceLogger.logTrace(506848709,Rt.k.Warning,"Hydration error [Store=".concat(this.name,"][Key=").concat(t,"]"))}const i=this.getStorageKey(Ps.SortCriteriaKey),s=this.persistedStorage.getItem(i);if(null!=s)try{const e=JSON.parse(s).reduce((e,t)=>{const n=t.v.primary.field;return this.isValidTaskGridColumnId(n)&&e.push(t),e},[]);this.sortCriteriaLRUCache.load(e),this.loggers.traceLogger.logTrace(506549203,Rt.k.Info,"Hydrated sort criteria [Store=".concat(this.name,"][Key=").concat(i,"]"))}catch(l){this.loggers.traceLogger.logTrace(506835042,Rt.k.Warning,"Hydration error [Store=".concat(this.name,"][Key=").concat(i,"]"))}const a=this.getStorageKey(Ps.GridColumnWidthKey),o=this.persistedStorage.getItem(a);if(null!=o)try{const e=JSON.parse(o).reduce((e,t)=>{const n=t.v,i={};Object.keys(n).forEach(e=>{this.isValidTaskGridColumnId(e)&&(i[e]=n[e])});const s=(0,r.A)((0,r.A)({},t),{},{v:i});return e.push(s),e},[]);this.gridColumnWidthLRUCache.load(e),this.loggers.traceLogger.logTrace(506549202,Rt.k.Info,"Hydrated grid column widths [Store=".concat(this.name,"][Key=").concat(a,"]"))}catch(l){this.loggers.traceLogger.logTrace(506783873,Rt.k.Warning,"Hydration error [Store=".concat(this.name,"][Key=").concat(a,"]"))}}getViewContext(e,t){return null==this.viewContexts[e][t]&&(this.viewContexts[e][t]={isLabelCollapsed:!1}),this.viewContexts[e][t]}getCurrentTaskGroupingState(e){return this.currentTaskGroupingState[e]}getCurrentTaskFilter(e){const t=this.taskFilterLRUCache.get(e);if(null==t){if(Y.B.clientSettings.Flights.Uno_EnableIrisCampaignCallouts&&Y.B.clientSettings.Flights.Uno_EnableDefaultTaskFilterIrisCallout)return new Is.S([]);const e=Y.B.isUnoContext?[Ss._6]:[];return new Is.S(e)}return t}getFilterExceptions(){return this.filterExceptions}getSortCriteria(e){const t=this.sortCriteriaLRUCache.get(e);return null==t?null:t}getGridColumnWidths(e){const t=this.gridColumnWidthLRUCache.get(e);return t||null}handleAction(e){let t=!1;switch(e.type){case vs._.actionType:const n=e;t=this.handleSetCategoryLabelModeAction(n);break;case ys.O.actionType:t=this.handleSetTaskFilterAction(e);break;case ks.p.actionType:t=this.updateCurrentTaskGroupingState(e.accessContext,e.taskGrouping),t=this.clearFilterExceptions()||t;break;case cs.s.type:t=this.clearFilterExceptions();break;case ds.M.actionType:const r=e;t=this.addTaskIdToFilterExceptions(r.taskEntitySet.id);break;case us.N.actionType:const i=e;t=this.removeTaskIdFromFilterExceptions(i.taskEntitySet.id);break;case Xt.r.actionType:t=this.handleTaskCreationSuccess(e);break;case hs.G.actionType:const s=e;t=this.addTaskIdToFilterExceptions(s.taskEntitySet.id);break;case ps.f.actionType:const a=e;t=this.addTaskIdToFilterExceptions(a.updatedTaskEntitySet.task.id);break;case gs.K.actionType:const o=e;t=this.removeTaskIdFromFilterExceptions(o.originalTaskEntitySet.task.id);break;case Li.B.actionType:const l=e;t=this.addTaskIdToFilterExceptions(l.task.id);break;case _i.M.actionType:const c=e;t=this.removeTaskIdFromFilterExceptions(c.task.id);break;case yn.R.actionType:const d=e;t=this.removeDeletedBucketFromTaskFilter(d.bucketId);break;case In.a.actionType:const u=e;t=this.removeDeletedBucketFromTaskFilter(u.bucketId);break;case ms.m.actionType:const h=e;t=this.handleSetSortCriteriaAction(h);break;case fs.J.actionType:const p=e;t=this.handleSetGridColumnWidthAction(p);break;default:return}t&&this.publishStoreChangedEvent()}handleSetCategoryLabelModeAction(e){return null==this.viewContexts[e.accessContext]&&(this.viewContexts[e.accessContext]={}),null==this.viewContexts[e.accessContext][e.contextEntityId]&&(this.viewContexts[e.accessContext][e.contextEntityId]={isLabelCollapsed:!1}),this.viewContexts[e.accessContext][e.contextEntityId].isLabelCollapsed!==e.isCollapsed&&(this.viewContexts[e.accessContext][e.contextEntityId]=(0,r.A)((0,r.A)({},this.viewContexts[e.accessContext][e.contextEntityId]),{},{isLabelCollapsed:e.isCollapsed}),!0)}updateCurrentTaskGroupingState(e,t){let n=!1;if(this.currentTaskGroupingState[e]!==t){var r;if(this.currentTaskGroupingState[e]=t,Y.B.clientType===Ts.s.Plex&&!Y.B.isUnoContext&&Y.B.clientSettings.Flights.EnableViewPersistence)null===(r=this.persistedStorage)||void 0===r||r.setItem(this.getStorageKey(Ps.TaskGroupingStateKey),JSON.stringify(this.currentTaskGroupingState));n=!0}return n}handleSetTaskFilterAction(e){const{viewKey:t,filter:n}=e;return!ze()(n,this.taskFilterLRUCache.get(t))&&(this.taskFilterLRUCache.set(t,n),this.filterExceptions={},!0)}clearFilterExceptions(){return Object.keys(this.filterExceptions).length>0&&(this.filterExceptions={},!0)}handleTaskCreationSuccess(e){const t=e.localId,n=e.taskEntitySet.id,r=this.filterExceptions[t];return!!r&&(this.filterExceptions[n]=r,delete this.filterExceptions[t],!0)}addTaskIdToFilterExceptions(e){if(null==e)return!1;let t=!1;for(const n of this.taskFilterLRUCache.keys()){const e=this.taskFilterLRUCache.get(n);e&&e.filters.length>0&&(t=!0)}if(t){let t=this.filterExceptions[e];return this.filterExceptions[e]=t?++t:1,!0}return!1}removeTaskIdFromFilterExceptions(e){return null!=e&&(!!this.filterExceptions[e]&&(this.filterExceptions[e]--,0===this.filterExceptions[e]&&delete this.filterExceptions[e],!0))}removeDeletedBucketFromTaskFilter(e){let t=!1;for(const n of this.taskFilterLRUCache.keys()){const r=this.taskFilterLRUCache.get(n);if(null!==r&&void 0!==r&&r.doesFilterValueExist("bucketId",e)){const i=r.toggleFilterValue("bucketId",e);this.taskFilterLRUCache.set(n,i),t=!0}}return t}handleSetSortCriteriaAction(e){const{viewId:t,sortCriteria:n}=e;return null==n?(this.sortCriteriaLRUCache.delete(t),!0):!ze()(n,this.sortCriteriaLRUCache.get(t))&&(this.sortCriteriaLRUCache.set(t,n),!0)}handleSetGridColumnWidthAction(e){var t;const{viewId:n,columnId:r,columnWidth:i}=e,s=null!==(t=this.gridColumnWidthLRUCache.get(n))&&void 0!==t?t:{};return s[r]!==i&&(s[r]=i,this.gridColumnWidthLRUCache.set(n,s),!0)}isValidTaskGridColumnId(e){return Object.values(bs.xJ).includes(e)}getStorageKey(e){return"".concat(Ps.ViewStoreKey,"-").concat(e)}constructor(e,t){super(),this.persistedStorage=e,this.loggers=t,this.viewContexts={},this.viewContexts[Cs.t.Plan]={},this.viewContexts[Cs.t.User]={},this.viewContexts[Cs.t.Workspace]={},this.persistedStorage?this.taskFilterLRUCache=new Es(this.persistedStorage,this.getStorageKey(Ps.TaskFiltersKey),Y.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxTaskFilters):this.taskFilterLRUCache=new Ds(Y.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxTaskFilters),this.persistedStorage?this.sortCriteriaLRUCache=new Es(this.persistedStorage,this.getStorageKey(Ps.SortCriteriaKey),Y.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxSortCriteria):this.sortCriteriaLRUCache=new Ds(Y.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxSortCriteria),this.persistedStorage?this.gridColumnWidthLRUCache=new Es(this.persistedStorage,this.getStorageKey(Ps.GridColumnWidthKey),Y.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxGridColumnWidths):this.gridColumnWidthLRUCache=new Ds(Y.B.clientSettings.ECSSettings.PersistedStorage.Limits.MaxGridColumnWidths),this.filterExceptions={},this.currentTaskGroupingState={},this.currentTaskGroupingState[Cs.t.Plan]=E.Yc.Bucket,this.currentTaskGroupingState[Cs.t.User]=E.Yc.Progress,this.currentTaskGroupingState[Cs.t.Workspace]=E.Yc.Plan,this.hydrateFromPersistentStorage()}}Ps.ViewStoreKey="vstore",Ps.TaskGroupingStateKey="tgs",Ps.TaskFiltersKey="tf",Ps.SortCriteriaKey="sc",Ps.GridColumnWidthKey="gcw";var ws=n(88458),xs=n.n(ws),As=n(61460),Fs=n.n(As),Ls=n(92394),_s=n.n(Ls),Us=n(30450),Os=n.n(Us),Bs=n(713),Ms=n(59393),Ns=n(66061),Rs=n(40699),Gs=n(69252),Ws=n(449),zs=n(73322),js=n(48537),Ks=n(14e3),Hs=n(48475),Vs=n(90506),Zs=n(28571),qs=n(31316),Ys=n(96020),Js=n(91393),Xs=n(41927),$s=n(43841),Qs=n(34631),ea=n(10979),ta=n(85230);class na extends $.r{loggingData(){return{taskCount:String(this.tasks.length),isFirstPage:String(this.isFirstPage),isLastPage:String(this.isLastPage)}}constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(na.actionType),this.userId=e,this.tasks=t,this.continuationToken=n,this.isFirstPage=r,this.isLastPage=null==n}}na.actionType="PLW_PREFETCH_USER_TASKS_SUCCEEDED";var ra=n(34717),ia=n(32561),sa=n(80708),aa=n(64696),oa=n(39589),la=n(70252),ca=n(34677),da=n.n(ca),ua=n(36777),ha=n.n(ua),pa=n(84048),ga=n.n(pa),ma=n(26727),fa=n.n(ma),va=n(53988),ya=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ka=function(e){function t(t){var n=e.call(this,t)||this;return n.pendingUpdates=[],n}return ya(t,e),t.prototype.getUpdate=function(e){return mi()(this.pendingUpdates,function(t){return t.key===e})},t.prototype.removeUpdate=function(e){Ee()(this.pendingUpdates,function(t){return t.key===e})},t}(Ie.w),Ta=function(e){function t(){var t=e.call(this)||this;return t.entityData=t.data,t}return ya(t,e),t.prototype.getItem=function(e){return this.applyDeltas(this.entityData.get(e))},t.prototype.getItemExcludeStatuses=function(e,t){if(null==e)return null;var n=this.entityData.get(e);return!n||ga()(t,n.status)?null:this.applyDeltas(n)},t.prototype.getAllItems=function(){var e=this;return Er()(this.entityData.getAll(),function(t){return e.applyDeltas(t)})},t.prototype.getItemsWithFilter=function(e){var t=this;return fa()(this.data.getAll()).map(function(n){return t.applyDeltasWithFilter(n,e)}).filter(function(e){return void 0!==e})},t.prototype.getPendingUpdateCount=function(e){var t=this.entityData.get(e);return t?t.pendingUpdates.length:0},t.prototype.mergeItem=function(e,t){if(!e)throw new re.L("key");this.entityData.get(e)&&(da()(this.entityData.get(e).item,t),this.updateModifiedDate(e))},t.prototype.mergeItemIntoNewObject=function(e,t){if(!e)throw new re.L("key");if(this.entityData.get(e)){var n=this.entityData.get(e),r=da()({},n.item,t);n.item=r,this.updateModifiedDate(e)}},t.prototype.mergeClonedItemIntoNewObject=function(e,t){if(!e)throw new re.L("key");if(this.entityData.get(e)){var n=this.entityData.get(e),r=da()(Pn()(n.item),t);n.item=r,this.updateModifiedDate(e)}},t.prototype.removeAllItems=function(){e.prototype.removeAllItems.call(this),this.entityData=this.data},t.prototype.setItem=function(e,t){this.data.set(e,new ka(t))},t.prototype.pushUpdate=function(e,t,n){if(!t)throw new re.L("updatedObject");if(!e)throw new re.L("entityKey");if(!n)throw new re.L("updateKey");if(!this.entityData.get(e))throw new va.c("entityKey","Cannot add an update to entity with key "+e+", the key does not exist");if(this.entityData.get(e).getUpdate(n))throw new va.c("updateKey","An update with key "+n+" already exists on this entity with key "+e);var r=this.getItem(e);if(null==r)throw new Error("Can't get diff, item is null");var i=r.getDiff(t);i&&(this.entityData.get(e).pendingUpdates.push({diff:i,key:n,updateApplied:!1}),this.updateModifiedDate(e))},t.prototype.commitUpdate=function(e,t){if(!e)throw new re.L("entityKey");if(!t)throw new re.L("updateKey");if(!this.entityData.get(e))throw new va.c("entityKey","Cannot commit an update to entity with key "+e+", the key does not exist");var n=this.entityData.get(e).getUpdate(t);if(!n)throw new va.c("updateKey","Could not find an update with key "+t+" on entity with key "+e);this.updateModifiedDate(e),n.updateApplied=!0,this.safelyCommitDeltas(e,!0)},t.prototype.commitAndSetUpdate=function(e,t,n){if(!t)throw new re.L("updatedObject");if(!e)throw new re.L("entityKey");if(!n)throw new re.L("updateKey");if(!this.entityData.get(e))throw new va.c("entityKey","Cannot commit an update to entity with key "+e+", the key does not exist");var r=this.entityData.get(e).getUpdate(n);r&&(r.updateApplied=!0,this.safelyCommitDeltas(e,!1)),this.entityData.get(e).item=t,this.updateModifiedDate(e)},t.prototype.revertUpdate=function(e,t){if(!e)throw new re.L("entityKey");if(!t)throw new re.L("updateKey");if(!this.entityData.get(e))throw new va.c("entityKey","Cannot revert an update to entity with key "+e+", the key does not exist");this.entityData.get(e).removeUpdate(t),this.updateModifiedDate(e)},t.prototype.applyDeltas=function(e){if(e){if(e.pendingUpdates.length>0){var t=e.pendingUpdates.map(function(e){return e.diff});if(null==e.item)throw new Error("Can't apply diff, item is null");return e.item.applyDiffs.apply(e.item,t)}return e.item}},t.prototype.applyDeltasWithFilter=function(e,t){if(e){var n=e.item;if(e.pendingUpdates.length>0){var r=e.pendingUpdates.map(function(e){return e.diff});if(null==e.item)throw new Error("Can't apply diff, item is null");n=e.item.applyDiffs.apply(e.item,r)}if(t(n,e.status))return n}},t.prototype.safelyCommitDeltas=function(e,t){var n=this,r=[];Ut()(this.entityData.get(e).pendingUpdates,function(e){if(!e.updateApplied)return!1;r.push(e.key)}),Ut()(r,function(r){var i=n.entityData.get(e),s=i.getUpdate(r);if(s){if(t){if(null==i.item)throw new Error("Can't apply diff, item is null");i.item=i.item.applyDiffs(s.diff)}i.removeUpdate(r)}})},t}(Ie.j);class Sa extends Ta{mergeItem(e,t,n){if(this.entityData.get(e)){var r,i;const s=this.entityData.get(e),a=null!==(r=null===(i=s.item)||void 0===i?void 0:i.getClone())&&void 0!==r?r:null;null!=n?ha()(a,t,n):da()(a,t),s.item=a,this.updateModifiedDate(e)}}getItemWithoutDeltas(e){const t=this.entityData.get(e);return null!=t?t.item:null}updateExists(e,t){const n=this.entityData.get(e);if(null!=n){if(null!=n.getUpdate(t))return!0}return!1}constructor(){super()}}var ba,Ia=n(679),Ca=n(31158);!function(e){e.getSimilarTasks=function(e,t){const n=Nt()().subtract(1,"M"),r=t.filter(t=>{var r;return(null===(r=t.userContentLastModifiedDate)||void 0===r?void 0:r.isAfter(n))&&e.id!==t.id});if(0===r.length)return[];const i=[];for(let c=0;c<r.length;c++)i.push(r[c].title);const s=(0,Ca.findBestMatch)(e.title,i),a=[];for(let c=0;c<r.length;c++)a.push({task:r[c],rating:s.ratings[c].rating});a.sort((e,t)=>t.rating-e.rating);const o=[],l=a.length<4?a.length:a.length/4;for(let c=0;c<l;c++)a[c].rating>=.5&&o.push(a[c].task);return o}}(ba||(ba={}));var Da=n(73624),Ea=n(83574),Pa=n(89469);class wa extends Ce.z{get name(){return"PlannerTaskStore"}getTask(e){return this.tasks.getItem(e)||null}getSimilarTasks(e){const t=e.planId?this.getTasksForPlan(e.planId):[];return t&&0!==(null===t||void 0===t?void 0:t.length)?ba.getSimilarTasks(e,t):[]}getTaskWithoutPendingUpdates(e){return this.tasks.getItemWithoutDeltas(e)}getTasksForPlan(e){const t=this.planTasksIndex.getItem(e);return null==t?null:Er()(t,t=>{const n=this.tasks.getItem(t);if(null==n)throw new Error("IndexCorruptionException: Indexed task not found in Tasks table [TaskId=".concat(t,"][PlanId=").concat(e,"]"));return n})}getTasksForUser(e){return null==this.userTasksIndex.getItem(e)?null:Er()(this.userTasksIndex.getItem(e),t=>{const n=this.tasks.getItem(t);if(null==n)throw new Error("IndexCorruptionException: Indexed task not found in Tasks table [TaskId=".concat(t,"][UserId=").concat(e,"]"));return n})}getTasksForBucket(e){const t=this.bucketTasksIndex.getItem(e);return null==t?null:Er()(t,t=>{const n=this.tasks.getItem(t);if(null==n)throw new Error("IndexCorruptionException: Indexed task not found in Tasks table [TaskId=".concat(t,"][BucketId=").concat(e,"]"));return n})}getTaskDetails(e){return this.taskDetails.getItem(e)||null}getTaskDetailsWithoutPendingUpdates(e){return this.taskDetails.getItemWithoutDeltas(e)}getTaskboardTaskFormattingForPlan(e,t){if(null==this.planTasksIndex.getItem(e))return null;let n;switch(t){case la.s.Bucket:n=this.taskboardTaskFormatForBucket;break;case la.s.AssignedTo:n=this.taskboardTaskFormatForAssignedTo;break;case la.s.Progress:n=this.taskboardTaskFormatForProgress;break;default:throw new Error("NotImplemented: cannot handle taskboard type "+t)}const r=Er()(this.planTasksIndex.getItem(e),e=>e),i=Er()(r,e=>n.getItem(e));return _s()(i,void 0,null),r.length>0&&i.length<r.length?null:i}getTaskboardTaskFormatting(e){const t=this.taskboardTaskFormatForAssignedTo.getItem(e),n=this.taskboardTaskFormatForBucket.getItem(e),r=this.taskboardTaskFormatForProgress.getItem(e);return t||n||r?oa._.builder.withPropertyBag({assignedBoardFormat:t||void 0,bucketBoardFormat:n||void 0,progressBoardFormat:r||void 0}).build():null}getTaskboardTaskFormattingWithoutPendingUpdates(e){const t=this.taskboardTaskFormatForAssignedTo.getItemWithoutDeltas(e),n=this.taskboardTaskFormatForBucket.getItemWithoutDeltas(e),r=this.taskboardTaskFormatForProgress.getItemWithoutDeltas(e);return t||n||r?oa._.builder.withPropertyBag({assignedBoardFormat:t||void 0,bucketBoardFormat:n||void 0,progressBoardFormat:r||void 0}).build():null}getTaskApprovalDetails(e){var t;return{data:this.taskApprovalDetails.getItem(e)||null,status:null!==(t=this.taskApprovalDetails.getItemStatus(e))&&void 0!==t?t:D.ZB.Stable}}isTaskApprovalOperationInProgress(e){var t;return null!==(t=this.isApprovalOperationInProgress[e])&&void 0!==t&&t}handleAction(e){let t=!1;switch(e.type){case Bs.U.actionType:t=this.handleTaskEntitySetFetchSuccess(e);break;case Ms.q.actionType:t=this.handleTasksForPlanFetchFailure(e);break;case Jt.a.actionType:t=this.handleTasksForPlanFetchSuccess(e);break;case Ns.y.actionType:t=this.handleTasksForUserFetchFailure(e);break;case Rs.e.actionType:t=this.handleTasksForUserFetchSuccess(e);break;case Da.n.actionType:t=this.handleGetTaskApprovalDetails(e);break;case Ea.j.actionType:t=this.handleGetTaskApprovalDetailsSuccess(e);break;case Pa.E.actionType:t=this.handleGetTaskApprovalDetailsFailure(e);break;case Gs.x.actionType:t=this.handleCancelTaskApprovalDetails(e);break;case Ws.O.actionType:t=this.handleUpdateTaskApprovalDetails(e);break;case zs.Z.actionType:t=this.handleCreateTaskApprovalDetails(e);break;case js.W.actionType:t=this.handleCancelTaskApprovalDetailsFailure(e);break;case Ks.L.actionType:t=this.handleUpdateTaskApprovalDetailsFailure(e);break;case Hs.C.actionType:t=this.handleCreateTaskApprovalDetailsFailure(e);break;case ds.M.actionType:t=this.handleTaskCreation(e);break;case us.N.actionType:t=this.handleTaskCreationFailure(e);break;case Xt.r.actionType:t=this.handleTaskCreationSuccess(e);break;case $t.r.actionType:t=this.handleDiffSyncInsertTask(e);break;case Js.p.actionType:t=this.handleDiffSyncInsertTaskDetails(e.taskDetails);break;case Xs.F.actionType:t=this.handleDiffSyncInsertTaskFormats(e.taskFormats);break;case ps.f.actionType:const n=e;t=this.handleTaskUpdate(n.updatedTaskEntitySet.task,n.updatedTaskEntitySet.taskDetails,n.updatedTaskEntitySet.taskFormatData,n.updateKey);break;case gs.K.actionType:const r=e;t=this.handleTaskUpdateFailure(r.originalTaskEntitySet.task,r.originalTaskEntitySet.taskDetails,r.originalTaskEntitySet.taskFormatData,r.updateKey);break;case Qt.U.actionType:const i=e,s=sa.F.hasContentBeenModified(i.originalTaskEntitySet,i.updatedTaskEntitySet);t=this.handleTaskUpdateSuccess(i.updatedTaskEntitySet.task,i.updatedTaskEntitySet.taskDetails,i.updatedTaskEntitySet.taskFormatData,i.updateKey,s);break;case en.T.actionType:t=this.handleDiffSyncUpdateTask(e);break;case $s.V.actionType:t=this.handleDiffSyncUpdateTaskDetails(e.updatedTaskDetails);break;case Qs.V.actionType:t=this.handleDiffSyncUpdateTaskFormats(e.updatedFormats);break;case Vs.N.actionType:t=this.handleTaskDeletion(e);break;case Zs.a.actionType:t=this.handleTaskDeletionFailure(e);break;case tn.o.actionType:t=this.handleTaskDeletionSuccess(e);break;case hs.G.actionType:t=this.handleTaskUndeletion(e);break;case qs.f.actionType:t=this.handleTaskUndeletionFailure(e);break;case Ys.N.actionType:t=this.handleTaskUndeletionSuccess(e);break;case nn.D.actionType:t=this.handleDiffSyncDeleteTask(e);break;case yn.R.actionType:t=this.handleDeleteBucketSuccess(e);break;case nt.t.actionType:t=this.handlePlanCreationSuccess(e);break;case Li.B.actionType:const a=e;t=this.handleTaskUpdate(a.task,void 0,void 0,a.updateKey);break;case _i.M.actionType:const o=e;t=this.handleTaskUpdateFailure(o.task,void 0,void 0,o.updateKey);break;case Ui.E.actionType:const l=e;t=this.handleTaskUpdateSuccess(l.updatedTask,void 0,void 0,l.updateKey,!0);break;case ea.I.actionType:t=this.handleCreateUploadSession(e);break;case ta.t.actionType:const c=e;t=this.handleUploadSessionFailed(c);break;case rt.actionType:const d=e;t=this.handleTasksForPlanFetchSuccess(new Jt.a(d.plan.id,d.plan.plan.container.externalId,d.tasks,d.tasksContinuationToken,!0));break;case na.actionType:const u=e;t=this.handleTasksForUserFetchSuccess(new Rs.e(u.userId,u.tasks,u.continuationToken,u.isFirstPage));break;default:return}t&&this.publishStoreChangedEvent()}handleGetTaskApprovalDetails(e){const t=e.taskId;return null!=t&&""!==t&&(this.taskApprovalDetails.setItemStatus(t,D.ZB.Updating),!0)}handleGetTaskApprovalDetailsSuccess(e){const{taskId:t,taskApprovalDetails:n}=e;if(!t||!n)return!1;const r=this.taskApprovalDetails.getItem(t);return null!=r&&ze()(r,n)||this.taskApprovalDetails.setItem(t,n),this.taskApprovalDetails.setItemStatus(t,D.ZB.Stable),!0}handleGetTaskApprovalDetailsFailure(e){const{taskId:t}=e;return!!t&&(this.taskApprovalDetails.setItemStatus(t,D.ZB.Failed),!0)}handleCancelTaskApprovalDetails(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!0)}handleUpdateTaskApprovalDetails(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!0)}handleCreateTaskApprovalDetails(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!0)}handleCancelTaskApprovalDetailsFailure(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!1)}handleUpdateTaskApprovalDetailsFailure(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!1)}handleCreateTaskApprovalDetailsFailure(e){const t=e.taskId;return this.setIsApprovalOperationInProgress(t,!1)}setIsApprovalOperationInProgress(e,t){return null!=e&&""!==e&&(this.isApprovalOperationInProgress[e]=t,!0)}handleTasksForPlanFetchFailure(e){return null!=this.planTasksIndex.getItem(e.planId)&&(this.planTasksIndex.setItem(e.planId,null),!0)}handleTasksForPlanFetchSuccess(e){let t=!1;const n=[];t=this.tryUpdateTasks(e.tasks,n)||t;const r=this.planTasksIndex.getItem(e.planId);if(null==r)this.planTasksIndex.setItem(e.planId,n),t=!0;else if(n.length!==Fs()(r,n).length){const i=Os()(r,n);this.planTasksIndex.setItem(e.planId,i),t=!0}return null!=e.accumulatedTaskIds&&(t=this.removeTasksForPlanNotIn(e.accumulatedTaskIds,e.planId)||t),t}handlePlanCreationSuccess(e){return this.planTasksIndex.setItem(e.planEntitySet.id,[]),!0}tryUpdateTasks(e,t){let n=!1;return Ut()(e,e=>{if(null!=(null===e||void 0===e?void 0:e.id)&&null!=e.task){t.push(e.id);const r=this.tasks.getItem(e.id);null!=r&&r.isEqual(e.task)||(n=!0,this.tasks.setItem(e.id,e.task));this.tasks.getItemStatus(e.id)!==D.ZB.Stable&&(n=!0,this.tasks.setItemStatus(e.id,D.ZB.Stable));const i=br.tryAddIdToIndex(e.id,this.bucketTasksIndex,this.getBucketIndexKey(e.task),!0);n=n||i,null!=e.taskFormatData&&(n=this.setFormatData(e.taskFormatData)||n),null!=e.taskDetails&&(n=this.setTaskDetails(e.taskDetails)||n)}}),n}removeTasksForPlanNotIn(e,t){let n=!1;const r=this.planTasksIndex.getItem(t);if(null!=r){const t=r.filter(t=>{const n=e.indexOf(t)<0,r=kr.o.isPlexTempId(t)&&this.tasks.getItemStatus(t)===D.ZB.Creating;return n&&!r});Bt()(t)||(Ut()(t,e=>{const t=r.indexOf(e,0);r.splice(t,1)}),n=!0)}return n}handleTaskEntitySetFetchSuccess(e){let t=!1;const n=e.taskEntitySet.id,r=e.taskEntitySet.task;if(r&&null!=n){const e=this.tasks.getItem(n);null!=e&&xn()(e,r,yr.lz.isEqualMomentCustomizer)||(t=!0,this.tasks.setItem(n,r));this.tasks.getItemStatus(n)!==D.ZB.Stable&&(t=!0,this.tasks.setItemStatus(n,D.ZB.Stable));const i=br.tryAddIdToIndex(n,this.bucketTasksIndex,this.getBucketIndexKey(r),!0);if(t=t||i,Ut()(r.getAssigneeIds(),e=>{const r=br.tryAddIdToIndex(n,this.userTasksIndex,e,!1);t=t||r}),r.planId){const e=br.tryAddIdToIndex(n,this.planTasksIndex,r.planId,!1);t=t||e}}const i=e.taskEntitySet.taskDetails;if(i&&null!=n){const e=this.taskDetails.getItem(n);null!=e&&xn()(e,i,yr.lz.isEqualMomentCustomizer)||(t=this.setTaskDetails(i)||t)}const s=e.taskEntitySet.taskFormatData;return null!=s&&(t=this.setFormatData(s)||t),t}setFormatData(e){let t=!1;if(null!=e){const n=e.assignmentBoardFormat;if(n){const e=this.taskboardTaskFormatForAssignedTo.getItem(n.id);null!=e&&xn()(e,n,yr.lz.isEqualMomentCustomizer)||(t=!0,this.taskboardTaskFormatForAssignedTo.setItem(n.id,n));this.taskboardTaskFormatForAssignedTo.getItemStatus(n.id)!==D.ZB.Stable&&(t=!0,this.taskboardTaskFormatForAssignedTo.setItemStatus(n.id,D.ZB.Stable))}const r=e.bucketBoardFormat;if(r){const e=this.taskboardTaskFormatForBucket.getItem(r.id);null!=e&&xn()(e,r,yr.lz.isEqualMomentCustomizer)||(t=!0,this.taskboardTaskFormatForBucket.setItem(r.id,r));this.taskboardTaskFormatForBucket.getItemStatus(r.id)!==D.ZB.Stable&&(t=!0,this.taskboardTaskFormatForBucket.setItemStatus(r.id,D.ZB.Stable))}const i=e.progressBoardFormat;if(i){const e=this.taskboardTaskFormatForProgress.getItem(i.id);null!=e&&xn()(e,i,yr.lz.isEqualMomentCustomizer)||(t=!0,this.taskboardTaskFormatForProgress.setItem(i.id,i));this.taskboardTaskFormatForProgress.getItemStatus(i.id)!==D.ZB.Stable&&(t=!0,this.taskboardTaskFormatForProgress.setItemStatus(i.id,D.ZB.Stable))}}return t}handleTasksForUserFetchFailure(e){return null!=this.userTasksIndex.getItem(e.userId)&&(this.userTasksIndex.setItem(e.userId,null),!0)}handleTasksForUserFetchSuccess(e){let t=!1;!0===e.isFirstPage&&(this.userTasksIndex.setItem(e.userId,[]),t=!0);const n=[];Ut()(e.tasks,e=>{if(null!=(null===e||void 0===e?void 0:e.id)&&null!=e.task){n.push(e.id);const r=this.tasks.getItem(e.id);null!=r&&xn()(r,e.task,yr.lz.isEqualMomentCustomizer)||(t=!0,this.tasks.setItem(e.id,e.task));this.tasks.getItemStatus(e.id)!==D.ZB.Stable&&(t=!0,this.tasks.setItemStatus(e.id,D.ZB.Stable));const i=br.tryAddIdToIndex(e.id,this.bucketTasksIndex,this.getBucketIndexKey(e.task),!0);t=t||i;const s=e.taskDetails;s&&(t=this.setTaskDetails(s)||t),null!=e.taskFormatData&&(t=this.setFormatData(e.taskFormatData)||t)}});const r=this.userTasksIndex.getItem(e.userId);if(null!=r&&!ze()(r,n)){const i=Os()(r,n);this.userTasksIndex.setItem(e.userId,i),t=!0}return t}handleTaskCreation(e){const t=e.taskEntitySet.id;if(null==t)return!1;if(null!=this.tasks.getItem(t))throw new Error("AggregateException: task already exists in store");if(e.taskEntitySet.taskDetails){if(null!=this.taskDetails.getItem(t))throw new Error("AggregateException: task details already exists in store")}const n=kr.o.isPlexTempId(t);return e.taskEntitySet.task&&(br.tryAddIdToIndex(t,this.planTasksIndex,e.taskEntitySet.task.planId),Ut()(e.taskEntitySet.task.getAssigneeIds(),e=>{br.tryAddIdToIndex(t,this.userTasksIndex,e)}),br.tryAddIdToIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task),!0),this.tasks.setItem(t,e.taskEntitySet.task),this.tasks.setItemStatus(t,n?D.ZB.Creating:D.ZB.Stable)),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&(this.taskboardTaskFormatForAssignedTo.setItem(t,e.taskEntitySet.taskFormatData.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(t,n?D.ZB.Creating:D.ZB.Stable)),e.taskEntitySet.taskFormatData.bucketBoardFormat&&(this.taskboardTaskFormatForBucket.setItem(t,e.taskEntitySet.taskFormatData.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(t,n?D.ZB.Creating:D.ZB.Stable)),e.taskEntitySet.taskFormatData.progressBoardFormat&&(this.taskboardTaskFormatForProgress.setItem(t,e.taskEntitySet.taskFormatData.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(t,n?D.ZB.Creating:D.ZB.Stable))),e.taskEntitySet.taskDetails&&(this.taskDetails.setItem(t,e.taskEntitySet.taskDetails),this.taskDetails.setItemStatus(t,n?D.ZB.Creating:D.ZB.Stable)),!0}handleTaskCreationFailure(e){const t=e.taskEntitySet.id;if(null==this.tasks.getItem(t))throw new Error("AggregateException: task not found in store");if(e.taskEntitySet.taskDetails){if(null==this.taskDetails.getItem(t))throw new Error("AggregateException: task details not found in store")}return e.taskEntitySet.task&&(br.tryRemoveIdFromIndex(t,this.planTasksIndex,e.taskEntitySet.task.planId),Ut()(e.taskEntitySet.task.getAssigneeIds(),e=>{br.tryRemoveIdFromIndex(t,this.userTasksIndex,e)}),br.tryRemoveIdFromIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task))),this.tasks.removeItem(t),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&this.taskboardTaskFormatForAssignedTo.removeItem(t),e.taskEntitySet.taskFormatData.bucketBoardFormat&&this.taskboardTaskFormatForBucket.removeItem(t),e.taskEntitySet.taskFormatData.progressBoardFormat&&this.taskboardTaskFormatForProgress.removeItem(t)),e.taskEntitySet.taskDetails&&this.taskDetails.removeItem(t),!0}handleTaskCreationSuccess(e){const t=e.localId,n=e.taskEntitySet.id;if(null==this.tasks.getItem(t))throw new Error("AggregateException: task not found in store");return e.taskEntitySet.task&&(br.tryUpdateIdInIndex(t,n,this.planTasksIndex,e.taskEntitySet.task.planId),Ut()(e.taskEntitySet.task.getAssigneeIds(),e=>{br.tryUpdateIdInIndex(t,n,this.userTasksIndex,e)}),br.tryUpdateIdInIndex(t,n,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task)),this.tasks.removeItem(t),this.tasks.setItem(n,e.taskEntitySet.task),this.tasks.setItemStatus(n,D.ZB.Stable)),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&(this.taskboardTaskFormatForAssignedTo.getItem(t)&&this.taskboardTaskFormatForAssignedTo.removeItem(t),this.taskboardTaskFormatForAssignedTo.setItem(n,e.taskEntitySet.taskFormatData.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(n,D.ZB.Stable)),e.taskEntitySet.taskFormatData.bucketBoardFormat&&(this.taskboardTaskFormatForBucket.getItem(t)&&this.taskboardTaskFormatForBucket.removeItem(t),this.taskboardTaskFormatForBucket.setItem(n,e.taskEntitySet.taskFormatData.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(n,D.ZB.Stable)),e.taskEntitySet.taskFormatData.progressBoardFormat&&(this.taskboardTaskFormatForProgress.getItem(t)&&this.taskboardTaskFormatForProgress.removeItem(t),this.taskboardTaskFormatForProgress.setItem(n,e.taskEntitySet.taskFormatData.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(n,D.ZB.Stable))),e.taskEntitySet.taskDetails&&(null!=this.taskDetails.getItem(t)&&this.taskDetails.removeItem(t),this.taskDetails.setItem(n,e.taskEntitySet.taskDetails),this.taskDetails.setItemStatus(n,D.ZB.Stable)),!0}handleDiffSyncInsertTask(e){const t=e.taskEntitySet.id;if(e.taskEntitySet.task){const n=e.taskEntitySet.task;if(null!=this.tasks.getItem(t))throw new Error("AggregateException: task already exists in store");br.tryAddIdToIndex(t,this.planTasksIndex,n.planId),Ut()(n.getAssigneeIds(),e=>{br.tryAddIdToIndex(t,this.userTasksIndex,e)}),br.tryAddIdToIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(n),!0),this.tasks.setItem(t,n),this.tasks.setItemStatus(t,D.ZB.Stable)}return e.taskEntitySet.taskDetails&&this.handleDiffSyncInsertTaskDetails(e.taskEntitySet.taskDetails),e.taskEntitySet.taskFormatData&&this.handleDiffSyncInsertTaskFormats(e.taskEntitySet.taskFormatData),!0}handleDiffSyncInsertTaskDetails(e){if(null!=this.taskDetails.getItem(e.id))throw new Error("AggregateException: task details already exists in store");return this.taskDetails.setItem(e.id,e),this.taskDetails.setItemStatus(e.id,D.ZB.Stable),!0}handleDiffSyncInsertTaskFormats(e){var t,n,r,i,s,a;const o=null!==(t=null!==(n=null!==(r=null===(i=e.assignmentBoardFormat)||void 0===i?void 0:i.id)&&void 0!==r?r:null===(s=e.bucketBoardFormat)||void 0===s?void 0:s.id)&&void 0!==n?n:null===(a=e.progressBoardFormat)||void 0===a?void 0:a.id)&&void 0!==t?t:null;if(null==o)return!1;if(e.assignmentBoardFormat){if(null!=this.taskboardTaskFormatForAssignedTo.getItem(o))throw new Error("AggregateException: assign format already exists in store");this.taskboardTaskFormatForAssignedTo.setItem(o,e.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(o,D.ZB.Stable)}if(e.bucketBoardFormat){if(null!=this.taskboardTaskFormatForBucket.getItem(o))throw new Error("AggregateException: bucket format already exists in store");this.taskboardTaskFormatForBucket.setItem(o,e.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(o,D.ZB.Stable)}if(e.progressBoardFormat){if(null!=this.taskboardTaskFormatForProgress.getItem(o))throw new Error("AggregateException: progress format already exists in store");this.taskboardTaskFormatForProgress.setItem(o,e.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(o,D.ZB.Stable)}return!0}handleTaskDeletion(e){let t=!1;const n=e.deletedTaskEntitySet.id,r=this.tasks.getItem(n);if(null==r)throw new Error("AggregateException: task not found in store");const i=br.tryRemoveIdFromIndex(r.id,this.planTasksIndex,r.planId);t=i||t,Ut()(r.getAssigneeIds(),e=>{const n=br.tryRemoveIdFromIndex(r.id,this.userTasksIndex,e);t=n||t});const s=br.tryRemoveIdFromIndex(r.id,this.bucketTasksIndex,this.getBucketIndexKey(r));t=s||t;if(this.tasks.getItemStatus(r.id)!==D.ZB.Deleting&&(this.tasks.setItemStatus(r.id,D.ZB.Deleting),t=!0),this.taskboardTaskFormatForAssignedTo.getItem(r.id)){this.taskboardTaskFormatForAssignedTo.getItemStatus(r.id)!==D.ZB.Deleting&&(this.taskboardTaskFormatForAssignedTo.setItemStatus(r.id,D.ZB.Deleting),t=!0)}if(this.taskboardTaskFormatForBucket.getItem(r.id)){this.taskboardTaskFormatForBucket.getItemStatus(r.id)!==D.ZB.Deleting&&(this.taskboardTaskFormatForBucket.setItemStatus(r.id,D.ZB.Deleting),t=!0)}if(this.taskboardTaskFormatForProgress.getItem(r.id)){this.taskboardTaskFormatForProgress.getItemStatus(r.id)!==D.ZB.Deleting&&(this.taskboardTaskFormatForProgress.setItemStatus(r.id,D.ZB.Deleting),t=!0)}if(this.taskDetails.getItem(r.id)){this.taskDetails.getItemStatus(r.id)!==D.ZB.Deleting&&(this.taskDetails.setItemStatus(r.id,D.ZB.Deleting),t=!0)}return t}handleTaskDeletionFailure(e){let t=!1;const n=e.deletedTaskEntitySet.id,r=this.tasks.getItem(n);if(null==r)throw new Error("AggregateException: task not found in store");const i=br.tryAddIdToIndex(r.id,this.planTasksIndex,r.planId);t=t||i,Ut()(r.getAssigneeIds(),e=>{const n=br.tryAddIdToIndex(r.id,this.userTasksIndex,e);t=t||n});const s=br.tryAddIdToIndex(r.id,this.bucketTasksIndex,this.getBucketIndexKey(r));t=t||s;if(this.tasks.getItemStatus(r.id)!==D.ZB.Stable&&(this.tasks.setItemStatus(r.id,D.ZB.Stable),t=!0),this.taskboardTaskFormatForAssignedTo.getItem(r.id)){this.taskboardTaskFormatForAssignedTo.getItemStatus(r.id)!==D.ZB.Stable&&(this.taskboardTaskFormatForAssignedTo.setItemStatus(r.id,D.ZB.Stable),t=!0)}if(this.taskboardTaskFormatForBucket.getItem(r.id)){this.taskboardTaskFormatForBucket.getItemStatus(r.id)!==D.ZB.Stable&&(this.taskboardTaskFormatForBucket.setItemStatus(r.id,D.ZB.Stable),t=!0)}if(this.taskboardTaskFormatForProgress.getItem(r.id)){this.taskboardTaskFormatForProgress.getItemStatus(r.id)!==D.ZB.Stable&&(this.taskboardTaskFormatForProgress.setItemStatus(r.id,D.ZB.Stable),t=!0)}if(this.taskDetails.getItem(r.id)){this.taskDetails.getItemStatus(r.id)!==D.ZB.Stable&&(this.taskDetails.setItemStatus(r.id,D.ZB.Stable),t=!0)}return t}handleTaskDeletionSuccess(e){const t=e.deletedTaskEntitySet.id,n=this.tasks.getItem(t);if(null==n)throw new Error("AggregateException: task not found in store");return this.tasks.removeItem(n.id),this.taskboardTaskFormatForAssignedTo.getItem(n.id)&&this.taskboardTaskFormatForAssignedTo.removeItem(n.id),this.taskboardTaskFormatForBucket.getItem(n.id)&&this.taskboardTaskFormatForBucket.removeItem(n.id),this.taskboardTaskFormatForProgress.getItem(n.id)&&this.taskboardTaskFormatForProgress.removeItem(n.id),this.taskDetails.getItem(n.id)&&this.taskDetails.removeItem(n.id),br.tryRemoveIdFromIndex(n.id,this.planTasksIndex,n.planId),Ut()(n.getAssigneeIds(),e=>{br.tryRemoveIdFromIndex(n.id,this.userTasksIndex,e)}),br.tryRemoveIdFromIndex(n.id,this.bucketTasksIndex,this.getBucketIndexKey(n)),!0}handleTaskUndeletion(e){const t=e.taskEntitySet.id;if(null!=this.tasks.getItem(t))throw new Error("AggregateException: task already exists in store");if(e.taskEntitySet.taskDetails){if(null!=this.taskDetails.getItem(t))throw new Error("AggregateException: task details already exists in store")}return e.taskEntitySet.task&&(br.tryAddIdToIndex(t,this.planTasksIndex,e.taskEntitySet.task.planId),Ut()(e.taskEntitySet.task.getAssigneeIds(),e=>{br.tryAddIdToIndex(t,this.userTasksIndex,e)}),br.tryAddIdToIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task),!0),this.tasks.setItem(t,e.taskEntitySet.task),this.tasks.setItemStatus(t,D.ZB.Stable)),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&(this.taskboardTaskFormatForAssignedTo.setItem(t,e.taskEntitySet.taskFormatData.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(t,D.ZB.Stable)),e.taskEntitySet.taskFormatData.bucketBoardFormat&&(this.taskboardTaskFormatForBucket.setItem(t,e.taskEntitySet.taskFormatData.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(t,D.ZB.Stable)),e.taskEntitySet.taskFormatData.progressBoardFormat&&(this.taskboardTaskFormatForProgress.setItem(t,e.taskEntitySet.taskFormatData.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(t,D.ZB.Stable))),e.taskEntitySet.taskDetails&&(this.taskDetails.setItem(t,e.taskEntitySet.taskDetails),this.taskDetails.setItemStatus(t,D.ZB.Stable)),!0}handleTaskUndeletionFailure(e){const t=e.taskEntitySet.id,n=this.tasks.getItem(t);if(null==n)throw new Error("AggregateException: task not found in store");if(e.taskEntitySet.taskDetails){if(null==this.taskDetails.getItem(n.id))throw new Error("AggregateException: task details not found in store")}return br.tryRemoveIdFromIndex(n.id,this.planTasksIndex,e.taskEntitySet.task.planId),Ut()(e.taskEntitySet.task.getAssigneeIds(),e=>{br.tryRemoveIdFromIndex(n.id,this.userTasksIndex,e)}),br.tryRemoveIdFromIndex(n.id,this.bucketTasksIndex,this.getBucketIndexKey(e.taskEntitySet.task)),this.tasks.removeItem(n.id),this.taskboardTaskFormatForAssignedTo.getItem(n.id)&&this.taskboardTaskFormatForAssignedTo.removeItem(n.id),this.taskboardTaskFormatForBucket.getItem(n.id)&&this.taskboardTaskFormatForBucket.removeItem(n.id),this.taskboardTaskFormatForProgress.getItem(n.id)&&this.taskboardTaskFormatForProgress.removeItem(n.id),this.taskDetails.getItem(n.id)&&this.taskDetails.removeItem(n.id),!0}handleTaskUndeletionSuccess(e){const t=e.taskEntitySet.id;if(null==this.tasks.getItem(t))throw new Error("AggregateException: task not found in store");return this.tasks.removeItem(t),e.taskEntitySet.task&&(this.tasks.setItem(t,e.taskEntitySet.task),this.tasks.setItemStatus(t,D.ZB.Stable)),e.taskEntitySet.taskFormatData&&(e.taskEntitySet.taskFormatData.assignmentBoardFormat&&(this.taskboardTaskFormatForAssignedTo.getItem(t)&&this.taskboardTaskFormatForAssignedTo.removeItem(t),this.taskboardTaskFormatForAssignedTo.setItem(t,e.taskEntitySet.taskFormatData.assignmentBoardFormat),this.taskboardTaskFormatForAssignedTo.setItemStatus(t,D.ZB.Stable)),e.taskEntitySet.taskFormatData.bucketBoardFormat&&(this.taskboardTaskFormatForBucket.getItem(t)&&this.taskboardTaskFormatForBucket.removeItem(t),this.taskboardTaskFormatForBucket.setItem(t,e.taskEntitySet.taskFormatData.bucketBoardFormat),this.taskboardTaskFormatForBucket.setItemStatus(t,D.ZB.Stable)),e.taskEntitySet.taskFormatData.progressBoardFormat&&(this.taskboardTaskFormatForProgress.getItem(t)&&this.taskboardTaskFormatForProgress.removeItem(t),this.taskboardTaskFormatForProgress.setItem(t,e.taskEntitySet.taskFormatData.progressBoardFormat),this.taskboardTaskFormatForProgress.setItemStatus(t,D.ZB.Stable))),e.taskEntitySet.taskDetails&&(null!=this.taskDetails.getItem(t)&&this.taskDetails.removeItem(t),this.taskDetails.setItem(t,e.taskEntitySet.taskDetails),this.taskDetails.setItemStatus(t,D.ZB.Stable)),!0}handleDiffSyncDeleteTask(e){const t=e.deletedTaskEntitySet.id,n=this.tasks.getItem(t);if(null==n)throw new Error("AggregateException: task not found in store");return br.tryRemoveIdFromIndex(t,this.planTasksIndex,n.planId),Ut()(n.getAssigneeIds(),e=>{br.tryRemoveIdFromIndex(t,this.userTasksIndex,e)}),br.tryRemoveIdFromIndex(t,this.bucketTasksIndex,this.getBucketIndexKey(n)),this.tasks.removeItem(t),this.taskDetails.getItem(t)&&this.taskDetails.removeItem(t),this.taskboardTaskFormatForAssignedTo.getItem(t)&&this.taskboardTaskFormatForAssignedTo.removeItem(t),this.taskboardTaskFormatForBucket.getItem(t)&&this.taskboardTaskFormatForBucket.removeItem(t),this.taskboardTaskFormatForProgress.getItem(t)&&this.taskboardTaskFormatForProgress.removeItem(t),!0}handleTaskUpdate(e,t,n,r){let i=!1;if(null!=e){const n=this.tasks.getItem(e.id);if(null==n)throw new Error("AggregateException: task not found in store");if(null!=t){const n=t.getPromotedProperties();e=e.setPromotedProperties(n)}xn()(n,e,yr.lz.isEqualMomentCustomizer)||(this.tasks.pushUpdate(e.id,e,r),this.updateTaskIndexes(e.id,n,e),i=!0);this.tasks.getItemStatus(e.id)!==D.ZB.Updating&&(i=!0,this.tasks.setItemStatus(e.id,D.ZB.Updating))}if(null!=t){if(null==this.tasks.getItem(t.id))throw new Error("AggregateException: task not found in store");const e=this.taskDetails.getItem(t.id);if(null==e)throw new Error("AggregateException: task details not found in store");xn()(e,t,yr.lz.isEqualMomentCustomizer)||(i=!0,this.taskDetails.pushUpdate(t.id,t,r));this.taskDetails.getItemStatus(t.id)!==D.ZB.Updating&&(i=!0,this.taskDetails.setItemStatus(t.id,D.ZB.Updating))}if(null!=n){if(n.assignmentBoardFormat){if(null==this.tasks.getItem(n.assignmentBoardFormat.id))throw new Error("AggregateException: task not found in store");const e=this.taskboardTaskFormatForAssignedTo.getItem(n.assignmentBoardFormat.id);if(null==e)throw new Error("AggregateException: task assign fmt not found in store");xn()(e,n.assignmentBoardFormat,yr.lz.isEqualMomentCustomizer)||(this.taskboardTaskFormatForAssignedTo.pushUpdate(n.assignmentBoardFormat.id,n.assignmentBoardFormat,r),this.taskboardTaskFormatForAssignedTo.setItemStatus(n.assignmentBoardFormat.id,D.ZB.Updating),i=!0)}if(n.bucketBoardFormat){if(null==this.tasks.getItem(n.bucketBoardFormat.id))throw new Error("AggregateException: task not found in store");const e=this.taskboardTaskFormatForBucket.getItem(n.bucketBoardFormat.id);if(null==e)throw new Error("AggregateException: task bucket fmt not found in store");xn()(e,n.bucketBoardFormat,yr.lz.isEqualMomentCustomizer)||(this.taskboardTaskFormatForBucket.pushUpdate(n.bucketBoardFormat.id,n.bucketBoardFormat,r),this.taskboardTaskFormatForBucket.setItemStatus(n.bucketBoardFormat.id,D.ZB.Updating),i=!0)}if(n.progressBoardFormat){if(null==this.tasks.getItem(n.progressBoardFormat.id))throw new Error("AggregateException: task not found in store");const e=this.taskboardTaskFormatForProgress.getItem(n.progressBoardFormat.id);if(null==e)throw new Error("AggregateException: task progress fmt not found in store");xn()(e,n.progressBoardFormat,yr.lz.isEqualMomentCustomizer)||(this.taskboardTaskFormatForProgress.pushUpdate(n.progressBoardFormat.id,n.progressBoardFormat,r),this.taskboardTaskFormatForProgress.setItemStatus(n.progressBoardFormat.id,D.ZB.Updating),i=!0)}}return i}handleTaskUpdateFailure(e,t,n,r){let i=!1;if(null!=e){const t=this.tasks.getItem(e.id);if(null==t){if(kr.o.isPlexTempId(e.id))return!1;throw new Error("AggregateException: task not found in store")}this.tasks.updateExists(t.id,r)&&(this.tasks.revertUpdate(t.id,r),this.updateTaskIndexes(t.id,t,e),0===this.tasks.getPendingUpdateCount(t.id)&&this.tasks.setItemStatus(t.id,D.ZB.Stable),i=!0)}if(null!=t){if(null==this.taskDetails.getItem(t.id))throw new Error("AggregateException: task details not found in store");this.taskDetails.updateExists(t.id,r)&&(this.taskDetails.revertUpdate(t.id,r),0===this.taskDetails.getPendingUpdateCount(t.id)&&this.taskDetails.setItemStatus(t.id,D.ZB.Stable),i=!0)}if(null!=n){if(null!=n.assignmentBoardFormat){if(null==this.taskboardTaskFormatForAssignedTo.getItem(n.assignmentBoardFormat.id))throw new Error("AggregateException: assigned format not found in store");this.taskboardTaskFormatForAssignedTo.updateExists(n.assignmentBoardFormat.id,r)&&(this.taskboardTaskFormatForAssignedTo.revertUpdate(n.assignmentBoardFormat.id,r),0===this.taskboardTaskFormatForAssignedTo.getPendingUpdateCount(n.assignmentBoardFormat.id)&&this.taskboardTaskFormatForAssignedTo.setItemStatus(n.assignmentBoardFormat.id,D.ZB.Stable),i=!0)}if(null!=n.bucketBoardFormat){if(null==this.taskboardTaskFormatForBucket.getItem(n.bucketBoardFormat.id))throw new Error("AggregateException: bucket format not found in store");this.taskboardTaskFormatForBucket.updateExists(n.bucketBoardFormat.id,r)&&(this.taskboardTaskFormatForBucket.revertUpdate(n.bucketBoardFormat.id,r),0===this.taskboardTaskFormatForBucket.getPendingUpdateCount(n.bucketBoardFormat.id)&&this.taskboardTaskFormatForBucket.setItemStatus(n.bucketBoardFormat.id,D.ZB.Stable),i=!0)}if(null!=n.progressBoardFormat){if(null==this.taskboardTaskFormatForProgress.getItem(n.progressBoardFormat.id))throw new Error("AggregateException: progress format not found in store");this.taskboardTaskFormatForProgress.updateExists(n.progressBoardFormat.id,r)&&(this.taskboardTaskFormatForProgress.revertUpdate(n.progressBoardFormat.id,r),0===this.taskboardTaskFormatForProgress.getPendingUpdateCount(n.progressBoardFormat.id)&&this.taskboardTaskFormatForProgress.setItemStatus(n.progressBoardFormat.id,D.ZB.Stable),i=!0)}}return i}handleTaskUpdateSuccess(e,t,n,r,i){let s=!1;if(null!=e){let n=this.tasks.getItem(e.id);if(null==n)throw new Error("AggregateException: task not found in store");if(this.tasks.updateExists(n.id,r)&&(this.tasks.commitUpdate(n.id,r),n=this.tasks.getItem(e.id),s=!0),null==n)throw new Error("AggregateException: task not found in store");if(null!=t){const n=t.getPromotedProperties();e=e.setPromotedProperties(n)}if(!xn()(n,e,yr.lz.isEqualMomentCustomizer)){const t=i?e.setContentModifiedProperties():e;this.tasks.mergeItem(n.id,t,ra.Y.mergeCustomizer),this.updateTaskIndexes(e.id,n,e),s=!0}this.tasks.getItemStatus(n.id)!==D.ZB.Stable&&0===this.tasks.getPendingUpdateCount(n.id)&&(this.tasks.setItemStatus(n.id,D.ZB.Stable),s=!0)}if(null!=t){if(null==this.tasks.getItem(t.id))throw new Error("AggregateException: task not found in store");let e=this.taskDetails.getItem(t.id);this.taskDetails.updateExists(t.id,r)&&(this.taskDetails.commitUpdate(t.id,r),e=this.taskDetails.getItem(t.id),0===this.taskDetails.getPendingUpdateCount(t.id)&&this.taskDetails.setItemStatus(t.id,D.ZB.Stable),s=!0),ze()(e,t)||(null==e?this.taskDetails.setItem(t.id,t):this.taskDetails.mergeItem(e.id,t,ia.U.mergeCustomizer),s=!0)}if(null!=n){if(null!=n.assignmentBoardFormat){if(null==this.tasks.getItem(n.assignmentBoardFormat.id))throw new Error("AggregateException: task not found in store");let e=this.taskboardTaskFormatForAssignedTo.getItem(n.assignmentBoardFormat.id);this.taskboardTaskFormatForAssignedTo.updateExists(n.assignmentBoardFormat.id,r)&&(this.taskboardTaskFormatForAssignedTo.commitUpdate(n.assignmentBoardFormat.id,r),0===this.taskboardTaskFormatForAssignedTo.getPendingUpdateCount(n.assignmentBoardFormat.id)&&this.taskboardTaskFormatForAssignedTo.setItemStatus(n.assignmentBoardFormat.id,D.ZB.Stable),e=this.taskboardTaskFormatForAssignedTo.getItem(n.assignmentBoardFormat.id),s=!0),xn()(e,n.assignmentBoardFormat,yr.lz.isEqualMomentCustomizer)||(null==e?this.taskboardTaskFormatForAssignedTo.setItem(n.assignmentBoardFormat.id,n.assignmentBoardFormat):this.taskboardTaskFormatForAssignedTo.mergeItem(n.assignmentBoardFormat.id,n.assignmentBoardFormat,aa.x.mergeCustomizer),s=!0)}if(null!=n.bucketBoardFormat){if(null==this.tasks.getItem(n.bucketBoardFormat.id))throw new Error("AggregateException: task not found in store");let e=this.taskboardTaskFormatForBucket.getItem(n.bucketBoardFormat.id);this.taskboardTaskFormatForBucket.updateExists(n.bucketBoardFormat.id,r)&&(this.taskboardTaskFormatForBucket.commitUpdate(n.bucketBoardFormat.id,r),0===this.taskboardTaskFormatForBucket.getPendingUpdateCount(n.bucketBoardFormat.id)&&(this.taskboardTaskFormatForBucket.setItemStatus(n.bucketBoardFormat.id,D.ZB.Stable),s=!0),e=this.taskboardTaskFormatForBucket.getItem(n.bucketBoardFormat.id),s=!0),xn()(e,n.bucketBoardFormat,yr.lz.isEqualMomentCustomizer)||(null==e?this.taskboardTaskFormatForBucket.setItem(n.bucketBoardFormat.id,n.bucketBoardFormat):this.taskboardTaskFormatForBucket.mergeItem(n.bucketBoardFormat.id,n.bucketBoardFormat,Ia.B.applyDiffMomentCustomizer),s=!0)}if(null!=n.progressBoardFormat){if(null==this.tasks.getItem(n.progressBoardFormat.id))throw new Error("AggregateException: task not found in store");let e=this.taskboardTaskFormatForProgress.getItem(n.progressBoardFormat.id);this.taskboardTaskFormatForProgress.updateExists(n.progressBoardFormat.id,r)&&(this.taskboardTaskFormatForProgress.commitUpdate(n.progressBoardFormat.id,r),0===this.taskboardTaskFormatForProgress.getPendingUpdateCount(n.progressBoardFormat.id)&&this.taskboardTaskFormatForProgress.setItemStatus(n.progressBoardFormat.id,D.ZB.Stable),e=this.taskboardTaskFormatForProgress.getItem(n.progressBoardFormat.id),s=!0),xn()(e,n.progressBoardFormat,yr.lz.isEqualMomentCustomizer)||(null==e?this.taskboardTaskFormatForProgress.setItem(n.progressBoardFormat.id,n.progressBoardFormat):this.taskboardTaskFormatForProgress.mergeItem(n.progressBoardFormat.id,n.progressBoardFormat,Ia.B.applyDiffMomentCustomizer),s=!0)}}return s}handleDiffSyncUpdateTask(e){let t=!1;const n=e.taskEntitySet.task,r=e.taskEntitySet.taskDetails,i=e.taskEntitySet.taskFormatData,s=e.taskEntitySet.id;if(!s)throw new Error("ArgumentNullException: entitySetId");if(null!=n){const e=this.tasks.getItem(n.id);if(null==e)throw new Error("AggregateException: task not found in store");xn()(e,n,yr.lz.isEqualMomentCustomizer)||(this.updateTaskIndexes(s,e,n),this.tasks.mergeItem(s,n,ra.Y.mergeCustomizer),t=!0);this.tasks.getItemStatus(s)!==D.ZB.Stable&&(this.tasks.setItemStatus(s,D.ZB.Stable),t=!0)}return r&&(t=this.handleDiffSyncUpdateTaskDetails(r)||t),i&&(t=this.handleDiffSyncUpdateTaskFormats(i)||t),t}handleDiffSyncUpdateTaskDetails(e){let t=!1;const n=e.id;if(null==this.tasks.getItem(n))throw new Error("AggregateException: task not found in store");const r=this.taskDetails.getItem(e.id);if(null!=r){var i,s;if(!xn()(r,e,yr.lz.isEqualMomentCustomizer))(null===(i=r.approval)||void 0===i?void 0:i.approvalStatus)!==(null===(s=e.approval)||void 0===s?void 0:s.approvalStatus)&&!0===this.isApprovalOperationInProgress[n]&&this.setIsApprovalOperationInProgress(n,!1),this.taskDetails.mergeItem(n,e,ia.U.mergeCustomizer),t=!0;this.taskDetails.getItemStatus(n)!==D.ZB.Stable&&(this.taskDetails.setItemStatus(n,D.ZB.Stable),t=!0);const a=this.promoteTaskDetailsProperties(e);t=t||a}return t}handleDiffSyncUpdateTaskFormats(e){let t=!1;if(e.assignmentBoardFormat){const n=e.assignmentBoardFormat.id;if(null==this.tasks.getItem(n))throw new Error("AggregateException: task not found in store");xn()(this.taskboardTaskFormatForAssignedTo.getItem(n),e.assignmentBoardFormat,yr.lz.isEqualMomentCustomizer)||(null==this.taskboardTaskFormatForAssignedTo.getItem(n)?this.taskboardTaskFormatForAssignedTo.setItem(n,e.assignmentBoardFormat):this.taskboardTaskFormatForAssignedTo.mergeItem(n,e.assignmentBoardFormat,aa.x.mergeCustomizer),this.taskboardTaskFormatForAssignedTo.setItemStatus(n,D.ZB.Stable),t=!0)}if(e.bucketBoardFormat){const n=e.bucketBoardFormat.id;if(null==this.tasks.getItem(n))throw new Error("AggregateException: task not found in store");xn()(this.taskboardTaskFormatForBucket.getItem(n),e.bucketBoardFormat,yr.lz.isEqualMomentCustomizer)||(null==this.taskboardTaskFormatForBucket.getItem(n)?this.taskboardTaskFormatForBucket.setItem(n,e.bucketBoardFormat):this.taskboardTaskFormatForBucket.mergeItem(n,e.bucketBoardFormat,Ia.B.applyDiffMomentCustomizer),this.taskboardTaskFormatForBucket.setItemStatus(n,D.ZB.Stable),t=!0)}if(e.progressBoardFormat){const n=e.progressBoardFormat.id;if(null==this.tasks.getItem(n))throw new Error("AggregateException: task not found in store");xn()(this.taskboardTaskFormatForProgress.getItem(n),e.progressBoardFormat,yr.lz.isEqualMomentCustomizer)||(null==this.taskboardTaskFormatForProgress.getItem(n)?this.taskboardTaskFormatForProgress.setItem(n,e.progressBoardFormat):this.taskboardTaskFormatForProgress.mergeItem(n,e.progressBoardFormat,Ia.B.applyDiffMomentCustomizer),this.taskboardTaskFormatForProgress.setItemStatus(n,D.ZB.Stable),t=!0)}return t}handleDeleteBucketSuccess(e){return null!=this.bucketTasksIndex.getItem(e.bucketId)&&(this.bucketTasksIndex.removeItem(e.bucketId),!0)}handleCreateUploadSession(e){const t=e.updatedTaskDetails.id;return null!=this.taskDetails.getItem(t)&&this.handleTaskUpdate(void 0,e.updatedTaskDetails,void 0,e.updateKey)}handleUploadSessionFailed(e){const t=e.taskId,n=this.taskDetails.getItem(t);return!!n&&(null!=n.references[e.session.id]&&(delete n.references[e.session.id],this.handleTaskUpdateFailure(void 0,n,void 0,e.updateKey)))}setTaskDetails(e){let t=!1;const n=this.taskDetails.getItem(e.id);null!=n&&xn()(n,e,yr.lz.isEqualMomentCustomizer)||(t=!0,this.taskDetails.setItem(e.id,e),this.tasks.getItem(e.id)&&this.promoteTaskDetailsProperties(e));return this.taskDetails.getItemStatus(e.id)!==D.ZB.Stable&&(t=!0,this.taskDetails.setItemStatus(e.id,D.ZB.Stable)),t}updateTaskIndexes(e,t,n){let r=!1;t.planId!==n.planId&&(r=!0,br.tryRemoveIdFromIndex(e,this.planTasksIndex,t.planId),br.tryAddIdToIndex(e,this.planTasksIndex,n.planId));const i=xs()(t.getAssigneeIds(),n.getAssigneeIds());Ut()(i,t=>{const n=br.tryRemoveIdFromIndex(e,this.userTasksIndex,t);r=r||n});const s=xs()(n.getAssigneeIds(),t.getAssigneeIds());if(Ut()(s,t=>{const n=br.tryAddIdToIndex(e,this.userTasksIndex,t);r=r||n}),t.bucketId!==n.bucketId){const i=br.tryRemoveIdFromIndex(e,this.bucketTasksIndex,this.getBucketIndexKey(t));r=r||i;const s=br.tryAddIdToIndex(e,this.bucketTasksIndex,this.getBucketIndexKey(n),!0);r=r||s}if(t.planId!==n.planId){if(t.planId){const n=br.tryRemoveIdFromIndex(e,this.planTasksIndex,t.planId);r=r||n}if(n.planId){const t=br.tryAddIdToIndex(e,this.planTasksIndex,n.planId,!0);r=r||t}}return r}getBucketIndexKey(e){return e.bucketId||E.iR+e.planId}promoteTaskDetailsProperties(e){const t=this.tasks.getItem(e.id);if(null==t)throw new Error("AggregateException: task not found in store for task details");const n=e.getPromotedProperties(),r=t.setPromotedProperties(n);return!xn()(t,r,yr.lz.isEqualMomentCustomizer)&&(this.tasks.setItem(t.id,r),this.tasks.setItemStatus(t.id,D.ZB.Stable),!0)}constructor(){super(),this.tasks=new Sa,this.taskDetails=new Sa,this.taskApprovalDetails=new Ie.j,this.isApprovalOperationInProgress={},this.taskboardTaskFormatForAssignedTo=new Sa,this.taskboardTaskFormatForBucket=new Sa,this.taskboardTaskFormatForProgress=new Sa,this.planTasksIndex=new Ie.j,this.userTasksIndex=new Ie.j,this.bucketTasksIndex=new Ie.j}}var xa,Aa=n(92296),Fa=n(4576),La=n(80332),_a=n(39202),Ua=n(33414),Oa=n(48170),Ba=n(73438),Ma=n(33701),Na=n(5312);!function(e){e.Feedback="office16;L_SendFeedback",e.Survey="office16;L_SendSurvey",e.FollowUp="office16;L_EmailCollection",e.LogCollection="office16;L_LogCollection",e.Screenshot="office16;L_Screenshot"}(xa||(xa={}));class Ra{constructor(e,t){if(this.allowFeedback=!e,this.allowSurvey=!e,this.allowFollowUp=!1,this.allowLogCollection=!1,this.allowScreenshot=!1,t&&!Bt()(t)&&!Bt()(t.value))for(let n=0;n<t.value.length;n++){const e=t.value[n];if(!Bt()(e)&&!Bt()(e.policiesPayload))for(let t=0;t<e.policiesPayload.length;t++){const n=e.policiesPayload[t];switch(n.settingId){case"office16;L_SendFeedback":this.allowFeedback="1"===n.value;break;case"office16;L_SendSurvey":this.allowSurvey="1"===n.value;break;case"office16;L_EmailCollection":this.allowFollowUp="1"===n.value;break;case"office16;L_LogCollection":this.allowLogCollection="1"===n.value;break;case"office16;L_Screenshot":this.allowScreenshot="1"===n.value}}}}}var Ga=n(55337);class Wa extends Ce.z{get name(){return"PlannerTenantStore"}getCurrentTenantFeedbackSettings(){return this.currentTenantFeedbackSettings}getCurrentTenantGroupSettings(){return this.currentTenantGroupSettings}getCurrentSensitivityLabels(){return this.currentSensitivityLabels}getCurrentSensitivityPolicySettings(){return this.currentSensitivityPolicySettings}handleAction(e){let t=!1;switch(e.type){case ht.M.actionType:t=this.handleCheckCurrentUserToGroupsMembershipsSucceededAction(e);break;case Fa.o.actionType:t=this.handleGetTenantFeedbackSettingsSucceededAction(e);break;case Aa.E.actionType:t=this.handleGetTenantFeedbackSettingsFailedAction();break;case lt.Q.actionType:t=this.handleGetTenantGroupSettingsSucceededAction(e);break;case La.a.actionType:t=this.handleGetTenantGroupSettingsFailedAction();break;case Ma._.actionType:t=this.handleSetGroupNamePrefixSuffixAction(e);break;case _a.K.actionType:t=this.handleGetSensitivityLabelsSucceededAction(e);break;case Ua.e.actionType:t=this.handleGetSensitivityLabelsFailedAction(e);break;case Oa.Y.actionType:t=this.handleGetSensitivityPolicySettingsSucceededAction(e);break;case Ba.A.actionType:t=this.handleGetSensitivityPolicySettingsFailedAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleCheckCurrentUserToGroupsMembershipsSucceededAction(e){return null!=this.currentTenantGroupSettings&&e.requestGroupIds.indexOf(this.currentTenantGroupSettings.GroupIdForMembershipChecking)>-1&&(this.currentTenantGroupSettings.handleCheckMembershipResponse(e.returnedGroupIds.indexOf(this.currentTenantGroupSettings.GroupIdForMembershipChecking)>-1),!0)}handleGetTenantFeedbackSettingsSucceededAction(e){return!ze()(this.currentTenantFeedbackSettings,e.tenantFeedbackSettings)&&(this.currentTenantFeedbackSettings=e.tenantFeedbackSettings,!0)}handleGetTenantFeedbackSettingsFailedAction(){if(this.currentTenantFeedbackSettings)return!1;try{this.currentTenantFeedbackSettings=new Ra(!0)}catch(e){this.loggers.traceLogger.logTrace(507786915,Rt.k.Warning,"Failed to create restricted tenant feedback settings [Error=".concat(e,"]"))}return!0}handleGetTenantGroupSettingsSucceededAction(e){return!ze()(this.currentTenantGroupSettings,e.tenantGroupSettings)&&(this.currentTenantGroupSettings=e.tenantGroupSettings,!0)}handleGetTenantGroupSettingsFailedAction(){return!this.currentTenantGroupSettings&&(this.currentTenantGroupSettings=Ga.h.builder.withValidData().build(),!0)}handleSetGroupNamePrefixSuffixAction(e){let t=!1;return this.currentTenantGroupSettings&&(e.displayNamePrefix&&this.currentTenantGroupSettings.DisplayNamePrefix!==e.displayNamePrefix&&(this.currentTenantGroupSettings.DisplayNamePrefix=e.displayNamePrefix,t=!0),e.displayNameSuffix&&this.currentTenantGroupSettings.DisplayNameSuffix!==e.displayNameSuffix&&(this.currentTenantGroupSettings.DisplayNameSuffix=e.displayNameSuffix,t=!0),e.mailNicknamePrefix&&this.currentTenantGroupSettings.MailNicknamePrefix!==e.mailNicknamePrefix&&(this.currentTenantGroupSettings.MailNicknamePrefix=e.mailNicknamePrefix,t=!0),e.mailNicknameSuffix&&this.currentTenantGroupSettings.MailNicknameSuffix!==e.mailNicknameSuffix&&(this.currentTenantGroupSettings.MailNicknameSuffix=e.mailNicknameSuffix,t=!0)),t}handleGetSensitivityLabelsSucceededAction(e){return null==this.currentSensitivityLabels&&(this.currentSensitivityLabels=e.sensitivityLabels.sort((e,t)=>e.priority-t.priority),!0)}handleGetSensitivityLabelsFailedAction(e){return null==this.currentSensitivityLabels&&(this.currentSensitivityLabels=[],!0)}handleGetSensitivityPolicySettingsSucceededAction(e){return null==this.currentSensitivityPolicySettings&&(this.currentSensitivityPolicySettings=e.sensitivityPolicySettings,!0)}handleGetSensitivityPolicySettingsFailedAction(e){return null==this.currentSensitivityPolicySettings&&(this.currentSensitivityPolicySettings=new Na.H,!0)}constructor(e){super(),this.loggers=e,this.currentTenantFeedbackSettings=null,this.currentTenantGroupSettings=null,this.currentSensitivityLabels=null,this.currentSensitivityPolicySettings=null}}var za=n(72438),ja=n(49226),Ka=n(1414),Ha=n(85262);class Va extends $.r{loggingData(){return{walkthroughType:k.hs[this.walkthroughType]}}constructor(e){super(Va.actionType),this.walkthroughType=e}}Va.actionType="PLW_START_WALKTHROUGH";class Za extends $.r{loggingData(){return{walkthroughType:k.hs[this.walkthroughType]}}constructor(e){super(Za.actionType),this.walkthroughType=e}}Za.actionType="PLW_COMPLETE_WALKTHROUGH";var qa=n(65980);class Ya extends $.r{constructor(){super(Ya.actionType)}}Ya.actionType="PLW_SHOW_NEXTSTEP";class Ja extends $.r{constructor(){super(Ja.actionType)}}Ja.actionType="PLW_SHOW_PREVIOUSSTEP";class Xa extends $.r{loggingData(){return{type:k.Ox[this.teachingCalloutType]}}constructor(e,t,n){super(Xa.actionType),this.teachingCalloutType=e,this.targetElement=t,this.messageParams=n}}Xa.actionType="PLW_SET_TEACHINGCALLOUT";class $a extends $.r{loggingData(){return{teachingCalloutType:k.Ox[this.teachingCalloutType]}}constructor(e){super($a.actionType),this.teachingCalloutType=e}}$a.actionType="PLW_DISMISS_TEACHINGCALLOUT";var Qa=n(12324),eo=n(94078),to=n(57469);class no extends Ce.z{get name(){return"PlannerWalkthroughStore"}getCurrentTeachingCalloutMessageParams(){return this._currentMessageParams}getCurrentTeachingCalloutTargetElement(){return this._currentTeachingCalloutTargetElement}getCurrentTeachingCalloutType(){return this._currentTeachingCalloutType}getCurrentWalkthroughMode(){return this._currentWalkthroughMode}getCurrentWalkthroughStepIndex(){return this._currentStepIndex}getCurrentWalkthroughType(){return this._walkthroughType}getDismissedTeachingCallouts(){return this._dismissedTeachingCallouts}hasSeenAlternateCarousel(){return this._hasSeenAlternateCarousel}handleAction(e){let t=!1;switch(e.type){case Va.actionType:t=this.handleStartWalkthroughAction(e);break;case Za.actionType:this._walkthroughType===k.hs.Passive&&this.loggers.usageLogger.logData(je.M.PlannerWalkthrough,je.M.PassiveWalkthroughCompleted),t=this.finishWalkthrough();break;case qa.u.actionType:t=this.skipWalkthrough(e.type);break;case Ya.actionType:null!=this._currentStepIndex&&(this._currentStepIndex++,t=!0);break;case Ja.actionType:null!=this._currentStepIndex&&0<this._currentStepIndex&&(this._currentStepIndex--,t=!0);break;case ds.M.actionType:t=this.handleActiveWalkthroughCreateTask(e);break;case pn.t.actionType:t=this.handleActiveWalkthroughCreateBucket(e);break;case ps.f.actionType:t=this.handleWalkthroughUpdateTask(e);break;case Ha.V.actionType:t=this.handleActiveWalkthroughUpdateAddUser();break;case za.o.actionType:t=this.handleWalkthroughOpenModalDialog(e);break;case ja.u.actionType:t=this.handlePassiveWalkthroughCloseModalDialog(e);break;case Xa.actionType:t=this.handleSetTeachingCalloutAction(e);break;case $a.actionType:const n=e;t=this.handleDismissCallout(n.teachingCalloutType);break;case Ka.C.actionType:t=this.skipWalkthrough(e.type),this._currentTeachingCalloutType!==k.Ox.None&&(t=this.handleDismissCallout(this._currentTeachingCalloutType)||t);break;default:return}t&&this.publishStoreChangedEvent()}initialize(){this._hasSeenAlternateCarousel=!1,this._dismissedTeachingCallouts=[];try{const e=new to.V(Qa.t.ElementId).getSetting(Qa.t.CurrentUserDetails),t=eo.I.builder.fromWebResource(e).build();t.getHasSeenAssigneeReplaced()&&this._dismissedTeachingCallouts.push(k.Ox.AssigneeReplaced),t.getHasSeenTaskDetails()&&this._dismissedTeachingCallouts.push(k.Ox.TaskDetails)}catch(e){}}handleSetTeachingCalloutAction(e){let t=!1;return this._currentTeachingCalloutType!==e.teachingCalloutType&&(this._currentTeachingCalloutType=e.teachingCalloutType,t=!0),ze()(this._currentTeachingCalloutTargetElement,e.targetElement)||(this._currentTeachingCalloutTargetElement=e.targetElement,t=!0),ze()(this._currentMessageParams,e.messageParams)||(this._currentMessageParams=e.messageParams,t=!0),this._currentWalkthroughMode!==k._9.TeachingCallout&&(this._currentWalkthroughMode=k._9.TeachingCallout,null!=this._currentStepIndex&&this._walkthroughType===k.hs.Passive&&this._currentStepIndex++,t=!0),t}handleDismissCallout(e){let t=!1;return this._currentWalkthroughMode!==k._9.Walkthrough&&this._currentTeachingCalloutType!==k.Ox.TaskDetails&&(this._currentWalkthroughMode=k._9.Walkthrough,t=!0),this._currentTeachingCalloutType===e&&(this._currentTeachingCalloutType=k.Ox.None,t=!0),-1!==this._dismissedTeachingCallouts.indexOf(e)?t:(this._dismissedTeachingCallouts.push(e),!0)}handleStartWalkthroughAction(e){let t=!1;return e.walkthroughType===k.hs.None?null!=this._currentStepIndex&&(this._currentStepIndex=null,t=!0):(0!==this._currentStepIndex&&(this._currentStepIndex=0,e.walkthroughType===k.hs.Active?this.loggers.usageLogger.logData(je.M.PlannerWalkthrough,je.M.ActiveWalkthroughStep+(this._currentStepIndex+1)):this.loggers.usageLogger.logData(je.M.PlannerWalkthrough,je.M.PassiveWalkthroughStep+(this._currentStepIndex+1)),t=!0),this._currentWalkthroughMode!==k._9.Walkthrough&&(this._currentWalkthroughMode=k._9.Walkthrough,t=!0)),this._walkthroughType!==e.walkthroughType&&(this._walkthroughType=e.walkthroughType,t=!0),t}handleActiveWalkthroughCreateTask(e){return this._walkthroughType===k.hs.Active&&(0===this._currentStepIndex&&(this._currentStepIndex++,this.loggers.usageLogger.logData(je.M.PlannerWalkthrough,je.M.ActiveWalkthroughStep+(this._currentStepIndex+1)),!0))}handleActiveWalkthroughCreateBucket(e){return this._walkthroughType===k.hs.Active&&(1===this._currentStepIndex&&(this._currentStepIndex++,this.loggers.usageLogger.logData(je.M.PlannerWalkthrough,je.M.ActiveWalkthroughStep+(this._currentStepIndex+1)),!0))}handleWalkthroughUpdateTask(e){return this._currentWalkthroughMode===k._9.Walkthrough&&this._walkthroughType===k.hs.Active&&2===this._currentStepIndex?(this._currentStepIndex++,this.loggers.usageLogger.logData(je.M.PlannerWalkthrough,je.M.ActiveWalkthroughStep+(this._currentStepIndex+1)),!0):this._currentWalkthroughMode===k._9.TeachingCallout&&this._currentTeachingCalloutType===k.Ox.TaskDetails&&(this._currentTeachingCalloutType=k.Ox.None,-1===this._dismissedTeachingCallouts.indexOf(k.Ox.TaskDetails)&&this._dismissedTeachingCallouts.push(k.Ox.TaskDetails),!0)}handleActiveWalkthroughUpdateAddUser(){return this._walkthroughType===k.hs.Active&&(3===this._currentStepIndex&&(this.loggers.usageLogger.logData(je.M.PlannerWalkthrough,je.M.ActiveWalkthroughCompleted),this._currentStepIndex=null,this._walkthroughType=k.hs.None,!0))}handleWalkthroughOpenModalDialog(e){return e.dialogData.dialogType===me.h.OnboardingCarousel&&!0===e.dialogData.isAlternate&&(this._hasSeenAlternateCarousel=!0,!0)}handlePassiveWalkthroughCloseModalDialog(e){return this._currentWalkthroughMode===k._9.TeachingCallout&&(this._currentTeachingCalloutType===k.Ox.TaskDetails?(this.handleDismissCallout(this._currentTeachingCalloutType),!0):this._currentTeachingCalloutType===k.Ox.None&&(this._currentWalkthroughMode=k._9.Walkthrough,!0))}skipWalkthrough(e){if(null!=this._currentStepIndex&&this._walkthroughType===k.hs.Active){const t=e===qa.u.actionType?je.M.ActiveWalkthroughSkipped:je.M.ActiveWalkthroughSkippedOnNavigate;this.loggers.usageLogger.logData(je.M.PlannerWalkthrough,t+(this._currentStepIndex+1))}else if(null!=this._currentStepIndex&&this._walkthroughType===k.hs.Passive){const t=e===qa.u.actionType?je.M.PassiveWalkthroughSkipped:je.M.PassiveWalkthroughSkippedOnNavigate;this.loggers.usageLogger.logData(je.M.PlannerWalkthrough,t+(this._currentStepIndex+1))}return this.finishWalkthrough()}finishWalkthrough(){let e=!1;return null!=this._currentStepIndex&&(e=!0,this._currentStepIndex=null,this._currentWalkthroughMode=k._9.Walkthrough),this._walkthroughType!==k.hs.None&&(this._walkthroughType=k.hs.None,e=!0),e}constructor(e){super(),this.loggers=e,this._currentMessageParams=[],this._currentStepIndex=null,this._currentTeachingCalloutType=k.Ox.None,this._currentTeachingCalloutTargetElement=null,this._currentWalkthroughMode=k._9.Walkthrough,this._walkthroughType=k.hs.None,this.initialize()}}var ro=n(20977),io=n.n(ro),so=n(26410),ao=n(81376),oo=n(7304),lo=n(95201),co=n(48496),uo=n(84824),ho=n(49602),po=n(45100),go=n(51676),mo=n(90548),fo=n(65172),vo=n(21721);class yo extends Ce.z{get name(){return"PlannerGroupDocumentsStore"}getDocumentUploadSession(e){return this.groupDocumentUploadSessions.getItem(e)||null}getDriveItemsForGroup(e){return this.groupDocuments.getItem(e)||null}getDriveItemsForGroupFailureResult(e){return this.groupDocumentsFailures.getItem(e)||null}getDriveItemThumbnail(e,t){const n=this.driveItemsThumbnailList.getItem(e)||null;return null!=n?n[t]:null}getDriveItem(e){var t;return null!==(t=this.driveItems.getItem(e))&&void 0!==t?t:null}getDriveItemStatus(e){return this.driveItems.getItemStatus(e)}getGroupFormResponse(e,t){const n=this.formResponses.getItem(e);return n?n[t]:null}handleAction(e){let t=!1;switch(e.type){case ea.I.actionType:t=this.tryAddUploadSessionToStore(e.session,D.ZB.Creating);break;case ta.t.actionType:t=this.tryRemoveUploadSessionFromStore(e.session.id);break;case so.B.actionType:case ao.$.actionType:case oo.h.actionType:t=this.tryUpdateUploadSessionInStore(e.session,D.ZB.Stable);break;case lo.S.actionType:t=this.handleCancelUploadSessionAction(e);break;case co.R.actionType:return void(t=this.handleCancelUploadSessionFailedAction(e));case uo.J.actionType:t=this.tryRemoveUploadSessionFromStore(e.sessionId);break;case ho.W.actionType:t=this.handleGetGroupDocumentsSucceededAction(e);break;case vo.c.actionType:t=this.handleGetGroupDocumentsFailedAction(e);break;case St.v.actionType:t=this.handleGetDriveItemSucceededAction(e);break;case bt.N.actionType:t=this.handleGetDriveItemFailedAction(e);break;case po.d.actionType:t=this.handleGetDriveItemThumbnailSucceededAction(e);break;case go.z.actionType:t=this.handleGetDriveItemThumbnailFailedAction(e);break;case mo.h.actionType:t=this.handleGetFormResponseSucceededAction(e);break;case fo.f.actionType:t=this.handleGetFormResponseFailedAction(e);break;default:return}t&&this.publishStoreChangedEvent()}tryAddUploadSessionToStore(e,t){return null==this.groupDocumentUploadSessions.getItem(e.id)&&(this.groupDocumentUploadSessions.setItem(e.id,e),this.groupDocumentUploadSessions.setItemStatus(e.id,t),!0)}tryUpdateUploadSessionInStore(e,t){let n=!1;const r=this.groupDocumentUploadSessions.getItem(e.id);if(null!=r){ze()(r,e)||(this.groupDocumentUploadSessions.setItem(e.id,e),n=!0);this.groupDocumentUploadSessions.getItemStatus(e.id)!==t&&(this.groupDocumentUploadSessions.setItemStatus(e.id,t),n=!0)}return n}tryRemoveUploadSessionFromStore(e){return null!=this.groupDocumentUploadSessions.getItem(e)&&(this.groupDocumentUploadSessions.removeItem(e),!0)}handleGetGroupDocumentsSucceededAction(e){let t=!1;const n=e.driveItems||[],r=e.folderId||yo.rootFolderId;let i=this.groupDocuments.getItem(e.groupId);var s;(i||(i={},t=!0),ze()(i[r],n))||(i[r]=io()([...null!==(s=i[r])&&void 0!==s?s:[],...n],"id"),this.groupDocuments.setItem(e.groupId,i),t=!0);null!=this.groupDocumentsFailures.getItem(e.groupId)&&(this.groupDocumentsFailures.removeItem(e.groupId),t=!0);return this.groupDocuments.getItemStatus(e.groupId)!==D.ZB.Stable&&(this.groupDocuments.setItemStatus(e.groupId,D.ZB.Stable),t=!0),t}handleGetGroupDocumentsFailedAction(e){let t=!1;const{groupId:n,response:r}=e,i=null!=r?r.status:-1;return this.groupDocumentsFailures.getItem(n)!==i&&(this.groupDocumentsFailures.setItem(n,i),t=!0),t}handleGetDriveItemSucceededAction(e){let t=!1;const n=this.driveItems.getItem(e.vroomId);null!=n&&ze()(n,e.driveItem)||(this.driveItems.setItem(e.vroomId,e.driveItem),t=!0);return this.driveItems.getItemStatus(e.vroomId)!==D.ZB.Stable&&(this.driveItems.setItemStatus(e.vroomId,D.ZB.Stable),t=!0),t}handleGetDriveItemFailedAction(e){var t,n;let r=!1;if((null===(t=e.response)||void 0===t?void 0:t.status)===Ge.t3.Forbidden||(null===(n=e.response)||void 0===n?void 0:n.status)===Ge.t3.NotFound){null!=this.driveItems.getItem(e.vroomId)&&(this.driveItems.setItem(e.vroomId,null),r=!0);this.driveItems.getItemStatus(e.vroomId)!==D.ZB.Inaccessible&&(this.driveItems.setItemStatus(e.vroomId,D.ZB.Inaccessible),r=!0)}return r}handleGetDriveItemThumbnailSucceededAction(e){let t=!1,n=this.driveItemsThumbnailList.getItem(e.groupId)||null;null==n&&(n={},t=!0),n[e.itemUrl]!==e.thumbnail&&(n[e.itemUrl]=e.thumbnail,this.driveItemsThumbnailList.setItem(e.groupId,n),t=!0);return this.driveItemsThumbnailList.getItemStatus(e.groupId)!==D.ZB.Stable&&(this.driveItemsThumbnailList.setItemStatus(e.groupId,D.ZB.Stable),t=!0),t}handleGetDriveItemThumbnailFailedAction(e){let t=!1,n=this.driveItemsThumbnailList.getItem(e.groupId)||null;null==n&&(n={},t=!0),""!==n[e.itemUrl]&&(n[e.itemUrl]="",this.driveItemsThumbnailList.setItem(e.groupId,n),t=!0);return this.driveItemsThumbnailList.getItemStatus(e.groupId)!==D.ZB.Stable&&(this.driveItemsThumbnailList.setItemStatus(e.groupId,D.ZB.Stable),t=!0),t}handleCancelUploadSessionAction(e){return this.groupDocumentUploadSessions.getItemStatus(e.sessionId)!==D.ZB.Deleting&&(this.groupDocumentUploadSessions.setItemStatus(e.sessionId,D.ZB.Deleting),!0)}handleCancelUploadSessionFailedAction(e){return this.groupDocumentUploadSessions.getItemStatus(e.sessionId)!==D.ZB.DeleteFailed&&(this.groupDocumentUploadSessions.setItemStatus(e.sessionId,D.ZB.DeleteFailed),!0)}handleGetFormResponseSucceededAction(e){let t=!1,n=this.formResponses.getItem(e.taskId)||null;null==n&&(n={},t=!0),n[e.formId]!==e.formResponse&&(n[e.formId]=e.formResponse,this.formResponses.setItem(e.taskId,n),t=!0);return this.formResponses.getItemStatus(e.taskId)!==D.ZB.Stable&&(this.formResponses.setItemStatus(e.taskId,D.ZB.Stable),t=!0),t}handleGetFormResponseFailedAction(e){var t,n;let r=!1,i=this.formResponses.getItem(e.taskId)||null;null==i&&(i={},r=!0),null!=i[e.formId]&&(i[e.formId]=null,this.formResponses.setItem(e.taskId,i),r=!0);const s=this.formResponses.getItemStatus(e.taskId);return(null===(t=e.response)||void 0===t?void 0:t.status)===Ge.t3.Forbidden||(null===(n=e.response)||void 0===n?void 0:n.status)===Ge.t3.NotFound?s!==D.ZB.Inaccessible&&(this.driveItems.setItemStatus(e.taskId,D.ZB.Inaccessible),r=!0):s!==D.ZB.Stable&&(this.driveItemsThumbnailList.setItemStatus(e.taskId,D.ZB.Stable),r=!0),r}constructor(){super(),this.groupDocuments=new Ie.j,this.driveItemsThumbnailList=new Ie.j,this.driveItems=new Ie.j,this.groupDocumentUploadSessions=new Ie.j,this.groupDocumentsFailures=new Ie.j,this.formResponses=new Ie.j}}yo.rootFolderId="root";var ko=n(87424),To=n.n(ko),So=n(53672);class bo extends $.r{loggingData(){return{toastId:this.toast.id,type:String(this.toast.type)}}constructor(e){super(bo.actionType),this.toast=e}}bo.actionType="ENQUEUE_ACTIVITY_TOAST";class Io extends Ce.z{get name(){return"PlannerActivityNotificationStore"}getToasts(){let e=fa()(this.toastsContainer);return e=To()(e,e=>e.createdDate),e}getVisibleToasts(){const e=this.getToasts();return cn()(e,e=>e.type!==ue.Q.type)}handleAction(e){let t=!1;switch(e.type){case So.n.actionType:t=this.handleDismissToastNotificationAction(e);break;case bo.actionType:t=this.handleEnqueueActivityToastAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleDismissToastNotificationAction(e){let t=!1;return null!=this.toastsContainer[e.toastId]&&(t=!0,delete this.toastsContainer[e.toastId]),t}handleEnqueueActivityToastAction(e){return this.toastsContainer[e.toast.id]=e.toast,!0}constructor(){super(),this.toastsContainer={}}}var Co=n(14740),Do=n.n(Co),Eo=n(19285),Po=n(23835),wo=n(88080),xo=n(21845),Ao=n(45679),Fo=n(24367),Lo=n(42463),_o=n(98502);class Uo extends Ce.z{get name(){return"PlannerNotificationStore"}getMessageType(){return this.messageType}getNotificationId(){return this.notificationId}getEntityId(){return this.entityId}getStatusCode(){return this.statusCode}getStatusText(){return this.statusText}getStringParams(){return this.stringParams}getCorrelationId(){if(this.response){const e=this.response.headers.get(Ke.Yu.XCorrelationId);if(e)return e;const t=this.response.headers.get(Ke.Qu.RequestId);return t||this.response.headers.get(Ke.Yu.EdgeRef)}return null}getResponseText(){var e,t;return null!==(e=null===(t=this.response)||void 0===t?void 0:t.responseText)&&void 0!==e?e:null}getReasonPhrase(){var e,t;return null!==(e=null===(t=this.response)||void 0===t?void 0:t.headers.get(Ke.Yu.ReasonPhrase))&&void 0!==e?e:null}getAuthenticationChallengeResponse(){var e,t,n,r,i;const s=null!==(e=null===(t=this.response)||void 0===t?void 0:t.headers.get(Ke.Yu.AuthenticationChallenge))&&void 0!==e?e:"";return _o.g.tryParseAuthenticationChallengeResponse(null!==(n=this.getStatusCode())&&void 0!==n?n:-1,null!==(r=this.getReasonPhrase())&&void 0!==r?r:"",null!==(i=this.getResponseText())&&void 0!==i?i:"",s,this.loggers.traceLogger)}getTimeStamp(){return this.timestamp}getToasts(){let e=Do()(this.toastsContainer.getAllItems());return e=To()(e,e=>e.createdDate),e}getVisibleToasts(){const e=this.getToasts();return cn()(e,e=>e.type!==ue.Q.type)}handleAction(e){let t=!1;switch(e.type){case Eo.Q.actionType:t=this.handleNotificationBarAction(Lo.H.error,e);break;case Ao.e.actionType:t=this.handleNotificationBarAction(Lo.H.warning,e);break;case Po.i.actionType:t=this.handleNotificationBarAction(Lo.H.info,e);break;case wo.t.actionType:t=this.handleNotificationBarAction(Lo.H.success,e);break;case xo.Y.actionType:t=this.handleClearNotificationAction();break;case So.n.actionType:t=this.handleDismissToastNotificationAction(e);break;case Fo.Z.actionType:t=this.handleEnqueueToastNotificationAction(e);break;case za.o.actionType:t=this.handleOpenModalDialogAction(e);break;default:return}t&&this.publishStoreChangedEvent()}handleNotificationBarAction(e,t){let n=!1;var r;(this.messageType!==e&&(this.messageType=e,n=!0),this.notificationId!==t.notificationId&&(this.notificationId=t.notificationId,n=!0),this.entityId!==t.entityId&&(this.entityId=t.entityId||null,n=!0),this.statusCode!==t.statusCode)&&(this.statusCode=null!==(r=t.statusCode)&&void 0!==r?r:null,n=!0);return this.statusText!==t.statusText&&(this.statusText=t.statusText||null,n=!0),this.response!==t.response&&(this.response=t.response||null,n=!0),ze()(this.stringParams,t.stringParams)||(this.stringParams=t.stringParams||null,n=!0),this.timestamp!==t.timestamp&&(this.timestamp=t.timestamp,n=!0),n}handleClearNotificationAction(){let e=!1;return null!=this.notificationId&&(this.notificationId=null,e=!0),null!=this.entityId&&(this.entityId=null,e=!0),null!=this.statusCode&&(this.statusCode=null,e=!0),null!=this.statusText&&(this.statusText=null,e=!0),null!=this.stringParams&&(this.stringParams=null,e=!0),null!=this.response&&(this.response=null,e=!0),null!=this.timestamp&&(this.timestamp=null,e=!0),e}handleDismissToastNotificationAction(e){let t=!1;return null!=this.toastsContainer.getItem(e.toastId)&&(t=!0,this.toastsContainer.removeItem(e.toastId)),t}handleEnqueueToastNotificationAction(e){return this.toastsContainer.setItem(e.toast.id,e.toast),!0}handleOpenModalDialogAction(e){return e.dialogData.dialogType===me.h.TaskDetails&&this.toastsContainer.getAllItems().length>0&&this.toastsContainer.removeAllItems(),!0}constructor(e){super(),this.loggers=e,this.toastsContainer=new Ie.j,this.messageType=Lo.H.info,this.notificationId=null,this.entityId=null,this.statusCode=null,this.statusText=null,this.stringParams=null,this.response=null,this.timestamp=null}}var Oo=n(56956),Bo=n.n(Oo),Mo=n(92446),No=n(8842);class Ro extends Ce.z{get name(){return"PlannerSuiteNavStore"}getSuiteNavModel(){return this.suiteNavModel}handleAction(e){switch(e.type){case No.f.actionType:this.handleSuiteNavSuceeded(e.suiteNavModel),this.publishStoreChangedEvent();break;case Mo.f.actionType:this.handleSuiteNavFailed(),this.publishStoreChangedEvent()}}getUserCalendarWorkloadUrl(){var e;let t=null;return null!==(e=this.suiteNavModel)&&void 0!==e&&null!==(e=e.SuiteNavData)&&void 0!==e&&e.AppsLinks&&Ut()(this.suiteNavModel.SuiteNavData.AppsLinks,e=>{if(e&&"ShellCalendar"===e.Id){let n=e.Url;n&&n.indexOf("/owa/?")>-1&&(n=n.replace("/owa/?","/calendar/addfromweb?")),t=n}}),t}getSharepointDomainUrl(e){var t;if(null!==(t=this.suiteNavModel)&&void 0!==t&&t.SuiteNavData){const e=this.suiteNavModel.SuiteNavData;if(e.SPO_RootSiteUrl)return Bo()(e.SPO_RootSiteUrl,"/");if(e.WorkloadLinks)for(const t of e.WorkloadLinks)if(t&&"ShellSites"===t.Id)return t.Url.substring(0,t.Url.indexOf(E.Lf.SiteWorkloadUrlSuffix))}if(null!=e){const t=e.getSharepointDomainUrl();if(t)return t}return null}handleSuiteNavSuceeded(e){var t;null!==(t=e.SuiteNavData)&&void 0!==t&&t.HelpLink&&(e.SuiteNavData.HelpLink.Url=Y.B.clientSettings.SuiteNavHelpUrl+e.SuiteNavData.HelpLink.Url),this.suiteNavModel=e}handleSuiteNavFailed(){this.suiteNavModel=null}constructor(){super(),this.suiteNavModel=null}}class Go extends $.r{constructor(e){super(Go.actionType),this.navigateToDifferentPlan=e}}Go.actionType="SET_NAVIGATE_TO_DIFFERENT_PLAN";class Wo extends $.r{constructor(){super(Wo.actionType)}}Wo.actionType="SET_PLAN_LAST_ACCESS";class zo extends $.r{constructor(e){super(zo.actionType),this.animateModifiedTasks=e}}zo.actionType="SET_ANIMATE_MODIFIED_TASKS";class jo extends $.r{constructor(e){super(jo.actionType),this.modifiedTaskIds=e}}jo.actionType="SET_MODIFIED_TASKS";var Ko=n(5099),Ho=n(35640),Vo=n.n(Ho),Zo=n(47649);class qo extends Ce.z{get name(){return"PlannerWywaStore"}handleAction(e){let t=!1;switch(e.type){case Jt.a.actionType:t=this.handleTasksForPlanFetchSuccess(e);break;case Go.actionType:t=this.handleSetNavigateToDifferentPlanAction(e);break;case Wo.actionType:t=this.handleSetPlanLastAccessAction(e);break;case zo.actionType:t=this.handleSetAnimateModifiedTasksAction(e);break;case cs.s.type:t=this.handleRouteChangeAction(e);break;case Oe.Y.actionType:t=this.handleGetDiffSyncFeedSucceededAction(e);break;case jo.actionType:t=this.handleSetModifiedTasksAction(e);break;case za.o.actionType:t=this.handleOpenModalDialog(e);break;case ne.type:t=this.handlePageReady(e);break;default:return}t&&this.publishStoreChangedEvent()}getNavigateToDifferentPlan(){return this.navigateToDifferentPlan}getCurrentPlanLastAccess(){return this.plansLastAccessAndFetch[this.currentPlanId]?this.plansLastAccessAndFetch[this.currentPlanId].planLastAccess:null}getCurrentPlanLastFetch(){return this.plansLastAccessAndFetch[this.currentPlanId]?this.plansLastAccessAndFetch[this.currentPlanId].planLastFetch:null}getPlanLastAccess(e){return this.plansLastAccessAndFetch[e]?this.plansLastAccessAndFetch[e].planLastAccess:null}getModifiedTaskIds(){return this.modifiedTaskIds}getAnimatedModifiedTasks(){return this.animateModifiedTasks}isModifiedTask(e){return this.modifiedTaskIds.some(t=>t===e)}handleTasksForPlanFetchSuccess(e){if(this.plansLastAccessAndFetch[e.planId]){if(e.isLastPage)return this.plansLastAccessAndFetch[e.planId].planLastFetch=Nt()(),!0}else if(e.isLastPage){const t={planLastAccess:null,planLastFetch:Nt()()};return this.plansLastAccessAndFetch[e.planId]=t,!0}return!1}handleSetNavigateToDifferentPlanAction(e){return this.navigateToDifferentPlan=e.navigateToDifferentPlan,!0}handleSetPlanLastAccessAction(e){return this.navigateToDifferentPlan=!1,this.plansLastAccessAndFetch[this.currentPlanId]?this.plansLastAccessAndFetch[this.currentPlanId].planLastAccess=Nt()().seconds(0):this.plansLastAccessAndFetch[this.currentPlanId]={planLastAccess:Nt()().seconds(0),planLastFetch:null},!0}handleSetAnimateModifiedTasksAction(e){return this.animateModifiedTasks!==e.animateModifiedTasks&&(this.animateModifiedTasks=e.animateModifiedTasks,!0)}handleRouteChangeAction(e){const t=e.pageName,n=t===Ko.EC.PlanCharts||t===Ko.EC.PlanSchedule||t===Ko.EC.PlanTaskboard||t===Ko.EC.PlanGrid;if(null==e.queryParameters||0===Vo()(e.queryParameters)||!n)return""!==this.currentPlanId&&(this.currentPlanId="",this.animateModifiedTasks=!1,this.modifiedTaskIds=[],!0);const r=e.queryParameters[Ko.yx.PlanId];return this.currentPlanId!==r?(""!==r&&null==this.plansLastAccessAndFetch[r]&&(this.plansLastAccessAndFetch[r]={planLastAccess:null,planLastFetch:null}),this.currentPlanId=r,this.navigateToDifferentPlan=!0,this.modifiedTaskIds=[],this.animateModifiedTasks=!0,!0):!!this.animateModifiedTasks&&(this.animateModifiedTasks=!1,!0)}handleGetDiffSyncFeedSucceededAction(e){if(""!==this.currentPlanId){if(this.plansLastAccessAndFetch[this.currentPlanId])this.plansLastAccessAndFetch[this.currentPlanId].planLastAccess=Nt()().seconds(0);else{const e={planLastAccess:Nt()().seconds(0),planLastFetch:null};this.plansLastAccessAndFetch[this.currentPlanId]=e}return!0}return!1}handleSetModifiedTasksAction(e){return this.modifiedTaskIds=e.modifiedTaskIds,!0}handleOpenModalDialog(e){let t=!1;if(e.dialogData.dialogType===me.h.TaskDetails){var n;const i=e.dialogData.taskId;var r;if(this.isModifiedTask(i))this.loggers.usageLogger.logData(je.M.WywaStore,je.M.OpenTaskDetailsOfModifiedTask,{taskCreationSourceType:null!==(r=e.dialogData.taskCreationSource)&&void 0!==r?r:""}),Ee()(this.modifiedTaskIds,e=>(e===i&&(t=!0),e===i));this.loggers.usageLogger.logData(je.M.WywaStore,je.M.OpenTaskDetails,{taskCreationSourceType:null!==(n=e.dialogData.taskCreationSource)&&void 0!==n?n:""})}return t}handlePageReady(e){if(!this.animateModifiedTasks)return!1;return Zo.v.create().setTimeout(()=>{this.animateModifiedTasks=!1},this.taskAnimationDelay),!1}constructor(e,t,n,r){super(),this.loggers=r,this.plansLastAccessAndFetch={},this.navigateToDifferentPlan=null!=n,this.currentPlanId=null!==n&&void 0!==n?n:"",this.modifiedTaskIds=[],this.animateModifiedTasks=!1,this.taskAnimationDelay=t;for(const i in e){const t={planLastAccess:Nt()(e[i].lastAccess).seconds(0),planLastFetch:null};this.plansLastAccessAndFetch[i]=t}}}var Yo=n(94030),Jo=n(32520),Xo=n.n(Jo);class $o{get name(){return"PlannerAssigneeSuggestionStore"}getAssigneeSuggestions(e,t){const n=this.planAssigneeSuggestions[e];return null==n?[]:this.rankAssigneeSuggestions(this.addSimilarTaskAssignees(t,n))}handleAction(e){e.type===Jt.a.actionType&&this.flights.EnableSuggestedAssignee&&this.handleGetTasksForPlan(e)}handleGetTasksForPlan(e){this.planTasks=e.tasks.map(e=>e.task);const t=e.planId,n={};return this.planTasks.forEach(e=>{e.getAssigneeIds().forEach(t=>{if(t!==this.currentUserID){var r;const i=null!==(r=n[t])&&void 0!==r?r:{numActiveTasks:0,numTasksAssignedInPlan:0,numTasksAssignedByCurrentUser:0};i.numTasksAssignedInPlan++,(0,an.Fk)(e.percentComplete)===sn.$.InProgress&&i.numActiveTasks++,e.createdBy===this.currentUserID&&i.numTasksAssignedByCurrentUser++,n[t]=i}})}),this.planAssigneeSuggestionData[t]=n,this.populatePlanAssigneeSuggestions(t),!0}populatePlanAssigneeSuggestions(e){var t;let n=[],i=[],s=[];const a=[],o=null!==(t=this.planAssigneeSuggestionData[e])&&void 0!==t?t:{};for(const r in o){const e=o[r];if(null!=e){if(0!==e.numTasksAssignedByCurrentUser)if(0===n.length)n.push(r);else for(let t=0;t<=n.length;t++){const i=o[n[t]];if(0!==e.numTasksAssignedByCurrentUser){if(null!=i&&e.numTasksAssignedByCurrentUser>=i.numTasksAssignedByCurrentUser){n.splice(t,0,r);break}t===n.length-1&&n.push(r)}}if(0===i.length)i.push(r);else for(let t=0;t<=i.length;t++){const n=o[i[t]];if(null!=n&&e.numTasksAssignedInPlan>=n.numTasksAssignedInPlan){i.splice(t,0,r);break}t===i.length-1&&i.push(r)}if(0===s.length)s.push(r);else for(let t=0;t<=s.length;t++){const n=o[s[t]];if(null!=n&&e.numActiveTasks<=n.numActiveTasks){s.splice(t,0,r);break}t===s.length-1&&s.push(r)}}n.length>this.maxNumOfSuggestions&&(n=n.slice(0,this.maxNumOfSuggestions)),i.length>this.maxNumOfSuggestions&&(i=i.slice(0,this.maxNumOfSuggestions)),s.length>this.maxNumOfSuggestions&&(s=s.slice(0,this.maxNumOfSuggestions))}n.forEach(e=>{const t=Xo()(a,t=>t.userId===e);t>=0?a[t]=(0,r.A)((0,r.A)({},a[t]),{},{weight:a[t].weight+this.usersTopAssigneesWeight-this.rankingDownIncrement*n.indexOf(e)}):a.push({userId:e,weight:this.usersTopAssigneesWeight-this.rankingDownIncrement*n.indexOf(e),context:Yo.n.UserTopAssignee})}),s.forEach(e=>{const t=Xo()(a,t=>t.userId===e);t>=0?a[t]=(0,r.A)((0,r.A)({},a[t]),{},{weight:a[t].weight+this.mostAvailableAssigneesWeight-this.rankingDownIncrement*s.indexOf(e)}):a.push({userId:e,weight:this.mostAvailableAssigneesWeight-this.rankingDownIncrement*s.indexOf(e),context:Yo.n.MostAvailableUser})}),i.forEach(e=>{const t=Xo()(a,t=>t.userId===e);t>=0?a[t]=(0,r.A)((0,r.A)({},a[t]),{},{weight:a[t].weight+this.plansTopAssigneesWeight-this.rankingDownIncrement*i.indexOf(e)}):a.push({userId:e,weight:this.plansTopAssigneesWeight-this.rankingDownIncrement*i.indexOf(e),context:Yo.n.PlanTopAssignee})}),this.planAssigneeSuggestions[e]=a}addSimilarTaskAssignees(e,t){const n=t.map(e=>(0,r.A)({},e));for(const i of e)i.getAssigneeIds().forEach(e=>{const t=Xo()(n,t=>t.userId===e);t>=0?(n[t].context===Yo.n.UserTopAssignee?n[t]=(0,r.A)((0,r.A)({},n[t]),{},{weight:n[t].weight+this.similarTaskAssigneesWeight}):n[t]=(0,r.A)((0,r.A)({},n[t]),{},{weight:n[t].weight+this.similarTaskAssigneesWeight,context:Yo.n.SimilarTaskTitle}),n[t]=(0,r.A)((0,r.A)({},n[t]),{},{weight:n[t].weight+this.similarTaskAssigneesWeight})):n.push({userId:e,weight:this.similarTaskAssigneesWeight,context:Yo.n.SimilarTaskTitle})});return n}rankAssigneeSuggestions(e){return e.sort((e,t)=>t.weight-e.weight),e.length>this.maxNumOfSuggestions&&(e=e.slice(0,this.maxNumOfSuggestions)),e}constructor(e){this.usersTopAssigneesWeight=1,this.similarTaskAssigneesWeight=.8,this.mostAvailableAssigneesWeight=.6,this.plansTopAssigneesWeight=.4,this.rankingDownIncrement=.05,this.maxNumOfSuggestions=5,this.planAssigneeSuggestionData={},this.planAssigneeSuggestions={},this.planTasks=[],this.flights=(0,r.A)({},Y.B.clientSettings.Flights),this.currentUserID=e}}var Qo=n(13328),el=n(88028);function tl(e,t){if(null!=e){var n=[];Ut()(e,function(e,t){"extraData"===t?Ut()(e,function(e,t){n.push((0,el.by)(Qo.Bx.Eupl,t,String(e)))}):n.push((0,el.by)(Qo.Bx.Eupl,t,String(e)))}),t.log({type:Qo.Bx.Eupl,payload:n})}}function nl(e,t){if(null!=e){var n=[];Ut()(e,function(e,t){n.push((0,el.by)(Qo.Bx.PageInit,t,String(e)))}),t.log({type:Qo.Bx.PageInit,payload:n})}}var rl=function(){function e(){}return e.init=function(e){!function(e,t){(0,el.$s)(e,nl,t)}({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0},e)},e}();function il(e,t){if(null!=e){var n=[];Ut()(e,function(e,t){"extraData"===t?Ut()(Object(e),function(e,t){n.push((0,el.by)(Qo.Bx.Ptt,t,String(e)))}):n.push((0,el.by)(Qo.Bx.Ptt,t,String(e)))}),t.log({type:Qo.Bx.Ptt,payload:n})}}var sl,al=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ol=function(e){function t(t){var n=e.call(this)||this;return n.logHandler=t,n.startTime=0,n.pageName="",n.previousPageName="",n.initialHttpRequestCount=0,n.euplLogged=!1,n.pageInitLogged=!1,n.routeChangesSeen=0,n.lastLargestHttpRequestReponseEnd=-1,n}return al(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"PerformanceCollectionStore"},enumerable:!1,configurable:!0}),t.prototype.handleAction=function(e){switch(e.type){case ee.type:this.setAppStart(e);break;case ne.type:this.pageReady(e);break;case cs.s.type:this.handleRouteChange(e)}},t.prototype.setAppStart=function(e){if(this.pageInitLogged)throw new Error("setAppStart() method cannot be called more than once.");this.pageInitLogged=!0,this.pageName=e.pageName,this.startTime=e.appStartTime,this.initialHttpRequestCount=this.getHttpRequestsLength(),rl.init(this.logHandler),this.publishStoreChangedEvent()},t.prototype.handleRouteChange=function(e){this.startTime=e.timestamp,this.previousPageName=this.pageName,this.pageName=e.pageName,this.routeChangesSeen++,this.publishStoreChangedEvent()},t.prototype.pageReady=function(e){var t,n,r=this.calculatePageTransitionTimeData(e);if(t=r,n=this.logHandler,(0,el.$s)(t,il,n),this.shouldLogEupl()){var i=this.calculateMainPageRequestData();i.metaTag=e.metaTag||"",i.extraData=e.extraData||{},i.pageName=r.pageName,i.preDataFetch=r.preDataFetch,i.dataFetch=r.dataFetch,i.httpRequestCount=this.initialHttpRequestCount+r.httpRequestCount,i.euplFull=i.pltFull+i.appStart+r.pttFull,function(e,t){(0,el.$s)(e,tl,t)}(i,this.logHandler)}this.euplLogged=!0,this.publishStoreChangedEvent()},t.prototype.shouldLogEupl=function(){return!this.euplLogged&&!(this.routeChangesSeen>1)},t.prototype.calculateMainPageRequestData=function(){var e={};if(null!=window.performance&&null!=window.performance.timing){var t=window.performance.timing;e.navigationStart=t.navigationStart,e.unloadEventStart=t.unloadEventStart,e.unloadEventEnd=t.unloadEventEnd,e.redirectStart=t.redirectStart,e.redirectEnd=t.redirectEnd,e.fetchStart=t.fetchStart,e.domainLookupStart=t.domainLookupStart,e.domainLookupEnd=t.domainLookupEnd,e.connectStart=t.connectStart,null!=t.secureConnectionStart&&0!==t.secureConnectionStart&&(e.secureConnectionStart=t.secureConnectionStart),e.connectEnd=t.connectEnd,e.requestStart=t.requestStart,e.responseStart=t.responseStart,e.responseEnd=t.responseEnd,e.domLoading=t.domLoading,e.domInteractive=t.domInteractive,e.domContentLoadedEventStart=t.domContentLoadedEventStart,e.domContentLoadedEventEnd=t.domContentLoadedEventEnd,e.domComplete=t.domComplete,e.loadEventStart=t.loadEventStart,e.loadEventEnd=t.loadEventEnd;var n=e.loadEventEnd>0?e.loadEventEnd:e.domComplete;e.pltFull=n-e.navigationStart,e.pltRedir=e.fetchStart-e.navigationStart,e.pltNetwork=e.responseEnd-e.fetchStart,e.pltDom=n-e.domLoading,e.pltNetworkDomGap=e.domLoading=e.responseEnd,e.appStart=this.startTime-n}return null!=window.performance&&null!=window.performance.navigation&&(e.redirCount=window.performance.navigation.redirectCount||0,e.navType=window.performance.navigation.type||-1),e},t.prototype.calculatePageTransitionTimeData=function(e){return{pageName:this.pageName,previousPageName:this.previousPageName,pttFull:e.dataFetchEndTime-this.startTime,preDataFetch:e.dataFetchStartTime-this.startTime,dataFetch:e.dataFetchEndTime-e.dataFetchStartTime,httpRequestCount:this.getHttpRequestsLength(),extraData:e.extraData}},t.prototype.getHttpRequestsLength=function(){var e=this,t=this.lastLargestHttpRequestReponseEnd,n=0;if(null!=window.performance&&null!=window.performance.getEntriesByType){var r=performance.getEntriesByType("resource");Ut()(r,function(r){null!=r.responseEnd&&r.responseEnd>e.lastLargestHttpRequestReponseEnd&&(r.responseEnd>t&&(t=r.responseEnd),n++)})}return this.lastLargestHttpRequestReponseEnd=t,n},t}(Ce.z),ll=n(17942),cl=n(70596),dl=n(80493),ul=n(52195),hl=n(71484),pl="_png",gl="_svg",ml=[16,20,24,32,40,48,64,96];function fl(e,t){void 0===e&&(e="https://spoppe-b.azureedge.net/files/fabric-cdn-prod_20221015.001/assets/item-types/"),ml.forEach(function(n){!function(e,t,n){var r=Object.keys(hl.K),i={};r.forEach(function(n){var r=e+t+"/"+n;i[n+t+pl]=g.createElement("img",{src:r+".png",alt:""}),i[n+t+gl]=g.createElement("img",{src:r+".svg",alt:""}),i[n+t+"_1.5x"+pl]=g.createElement("img",{src:e+t+"_1.5x/"+n+".png",height:"100%",width:"100%",alt:""}),i[n+t+"_1.5x"+gl]=g.createElement("img",{src:e+t+"_1.5x/"+n+".svg",height:"100%",width:"100%",alt:""}),i[n+t+"_2x"+pl]=g.createElement("img",{src:e+t+"_2x/"+n+".png",height:"100%",width:"100%",alt:""}),i[n+t+"_3x"+pl]=g.createElement("img",{src:e+t+"_3x/"+n+".png",height:"100%",width:"100%",alt:""}),i[n+t+"_4x"+pl]=g.createElement("img",{src:e+t+"_4x/"+n+".png",height:"100%",width:"100%",alt:""})}),(0,ul.K1)({fontFace:{},style:{width:t,height:t,overflow:"hidden"},icons:i,mergeImageProps:!0},n)}(e,n,t)})}!function(e){e.isAuthenticationFailureNotification=function(e){const t=e.getNotificationId(),n=e.getStatusCode();return null!=t&&(t===N.fc.RefreshAuthTokenError||t===N.fc.RefreshAuthTokenIEError||t===N.fc.UnauthenticatedError||t===N.fc.UserInterationRequiredAuthError||401===n)}}(sl||(sl={}));class vl{getCurrentDelayInterval(){let e=Math.pow(this.baseInterval,this.exponentialBackOffFactor);return e>this.cutoff&&(e=this.cutoff),e}incrementThresholdCounter(){this.backoffCounter++,this.backoffCounter>=this.minThreshold&&this.exponentialBackOffFactor++}resetThresholdCounter(){this.backoffCounter=0,this.exponentialBackOffFactor=1}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;this.baseInterval=e,this.cutoff=t,this.minThreshold=n,this.backoffCounter=0,this.exponentialBackOffFactor=1}}class yl{isPageHidden(){return"hidden"===document.visibilityState}}var kl=n(40729),Tl=n(82841),Sl=n(48924),bl=n(86053),Il=n(79537);class Cl{getItem(e){const t=this.getPrefixedKey(e);return this.storage.getItem(t)}setItem(e,t){try{const n=this.getPrefixedKey(e);this.storage.setItem(n,t)}catch(n){this.traceLogger.logTrace(507778500,Rt.k.Warning,"Persisted storage failure [Error=".concat(Il.f.getMessage(n),"][StackTrace=").concat(Il.f.getStackTrace(n),"]"))}}removeItem(e){const t=this.getPrefixedKey(e);return this.storage.removeItem(t)}getPrefixedKey(e){return"".concat(Cl.AppStorageKeyPrefix,"-").concat(Y.B.clientType,"-").concat(Y.B.currentUserId,"-").concat(e)}constructor(e,t){this.storage=e,this.traceLogger=t}}Cl.AppStorageKeyPrefix="planner";var Dl,El=n(17090),Pl=n(46530),wl=n(11910),xl=n(24723),Al=n(12358),Fl=n.n(Al),Ll=n(88880),_l=n(33268);!function(e){e[e.Creation=0]="Creation",e[e.Assignment=1]="Assignment",e[e.Unassignment=2]="Unassignment",e[e.Completion=3]="Completion",e[e.Publication=4]="Publication"}(Dl||(Dl={}));class Ul{generateFakeCreationPost(e){var t,n;let r=this.getCurrentUser(),i=e.createdDate;const s=e.creationSource;if(s.publication){const e=this.getUser(s.publication.sourceTeamId);i=s.publication.lastModifiedTime,r=null!=e?e:Pl._.getUnknownUser(s.publication.sourceTeamId)}else if(null!=e.createdBy){const t=this.getUser(e.createdBy);r=null!=t?t:r=Pl._.getUnknownUser(e.createdBy)}const a=this.getCoreMessageTemplate(e.taskCreationSourceType===xl.w3.Regular?0:4),o=bl.p.Strings.TaskActivityFeed_TaskFeedPrincipal;let l=a.replace("{0}",o);return l=l.replace("{1}",Fl()(e.title)),l='<div><font size="2"> <span style="font-size:10pt;">'+l+"</span></font></div>",wl.L.builder.withPropertyBag({body:wl.L.generatePostBody(l),hasAttachments:!1,conversationId:null!==(t=e.conversationThreadId)&&void 0!==t?t:void 0,conversationThreadId:null!==(n=e.conversationThreadId)&&void 0!==n?n:void 0,id:e.id,fromField:{emailAddress:{address:r.mail,name:r.displayName}},sender:{emailAddress:{address:r.mail,name:r.displayName}},createdDateTime:i}).build()}getTaskActivityFeed(e,t,n,r,i,s){let a="";const o=bl.p.Strings.TaskActivityFeed_TaskFeedPrincipal;let l=null;if(null!=t.task){if(null==e){if(n===El.b.TaskAssignment||n===El.b.All){const e=t.task.getAssigneeIds();a=this.appendTaskAssignmentChangeMessage(a,t,o,e,!1)}n!==El.b.TaskCompleted&&n!==El.b.All||(a=this.appendTaskCompletionMessage(a,t,o))}else{if(n===El.b.TaskAssignment||n===El.b.All){const n=ra.Y.getAddedAssignees(e.task,t.task);a=this.appendTaskAssignmentChangeMessage(a,t,o,n,!1);const r=ra.Y.getRemovedAssignees(e.task,t.task);a=this.appendTaskAssignmentChangeMessage(a,t,o,r,!0)}n!==El.b.TaskCompleted&&n!==El.b.All||100!==e.task.percentComplete&&(a=this.appendTaskCompletionMessage(a,t,o))}if(a.length>0){a='<div><font size="2"><span style="font-size:10pt;">'+a+"</span></font></div>"+(null==t.task.conversationThreadId?Ll.i.getFirstCommentEmailContent(i,s,r.title):Ll.i.getCommentReplyEmailContent(i,t.task.title,s,r.title));const e=this.getCurrentUser();l=wl.L.builder.withPropertyBag({body:wl.L.generatePostBody(a),conversationId:void 0,conversationThreadId:void 0,hasAttachments:!1,fromField:{emailAddress:{address:e.mail,name:e.displayName}}}).withLocallyUniqueId().build()}}return null!=l&&this.traceLogger.logTrace(507778448,Rt.k.Info,"Generated task update activity feed"),l}getCoreMessageTemplate(e){let t="";switch(e){case 1:t=bl.p.Strings.TaskActivityFeed_AssignmentFeedTemplate;break;case 2:t=bl.p.Strings.TaskActivityFeed_UnassignmentFeedTemplate;break;case 3:t=bl.p.Strings.TaskActivityFeed_CompletionFeedTemplate;break;case 0:t=bl.p.Strings.TaskActivityFeed_CreationFeedTemplate;break;case 4:t=bl.p.Strings.TaskActivityFeed_PublicationFeedTemplate}return t}appendTaskAssignmentChangeMessage(e,t,n,r,i){if(r.length<=0)return e;let s="";return r.forEach(e=>{let t=this.getUser(e);t||(t=Pl._.getUnknownUser(e)),s=s.concat((s.length>0?", ":"")+t.displayName)}),e.length>0&&(e=e.concat("<br>")),e=(e=(e=e.concat(this.getCoreMessageTemplate(i?2:1).replace("{0}",n))).replace("{2}",s)).replace("{1}",_l.wS.generateEntityHyperlink(t.task,N._n.Comment,N.rl.GroupMailbox,new Date))}appendTaskCompletionMessage(e,t,n){var r;if(t.task.percentComplete<100||!t.task.completedBy)return e;e.length>0&&(e=e.concat("<br>"));const i=null!==(r=this.getUser(t.task.completedBy))&&void 0!==r?r:Pl._.getUnknownUser(t.task.completedBy);return e=(e=(e=e.concat(this.getCoreMessageTemplate(3).replace("{0}",n))).replace("{2}",i.displayName)).replace("{1}",_l.wS.generateEntityHyperlink(t.task,N._n.Comment,N.rl.GroupMailbox,new Date))}constructor(e,t,n){this.traceLogger=n,this.getUser=e,this.getCurrentUser=t}}class Ol{readAsDataURL(e){this.fileReader.readAsDataURL(e)}constructor(){this.fileReader=new FileReader,this.fileReader.onerror=e=>{this.onerror(e)},this.fileReader.onload=e=>{this.onload(e)}}}var Bl=n(19864),Ml=n(53175),Nl=n(8403),Rl=n(53443),Gl=n(72761),Wl=n(17776),zl=n(97139),jl=n(99463),Kl=n.n(jl);class Hl{onDiffSyncStoreUpdate(){const e=this.diffSyncStore.getLastDiffSyncFeed();if(null!=e&&e!==this.lastDiffSyncFeed){try{this.processFeedUpdates(e.updates)}catch(t){this.loggers.traceLogger.logTrace(507786944,Rt.k.Error,Gt.f.getMessage(t))}this.lastDiffSyncFeed=e}}async processFeedUpdates(e){const t=[];for(let n=0;n<e.length;n++)if(!t[n]){t[n]=!0;const r=e[n];switch(r.entityType){case Gl.I.Task:await this.processTaskUpdate(r,e,n,t);break;case Gl.I.TaskDetails:await this.processTaskDetailsUpdate(r,e,n,t);break;case Gl.I.Plan:await this.processPlanUpdate(r,e,n,t);break;case Gl.I.PlanDetails:await this.processPlanDetailsUpdate(r,e,n,t);break;case Gl.I.User:break;case Gl.I.UserDetails:await this.processUserDetailsUpdate(r,e,n,t);break;case Gl.I.TaskboardStatusFormatting:break;case Gl.I.TaskboardStatusTaskFormatting:await this.processTaskProgressFmtUpdate(r,e,n,t);break;case Gl.I.TaskboardAssignedToFormatting:break;case Gl.I.TaskboardAssignedToTaskFormatting:await this.processTaskAssignedToFmtUpdate(r,e,n,t);break;case Gl.I.Bucket:await this.processBucketUpdate(r,e,n,t);break;case Gl.I.TaskboardBucketFormatting:break;case Gl.I.TaskboardBucketTaskFormatting:await this.processTaskBucketFmtUpdate(r,e,n,t)}}this.shouldRecalculateRecommendedPlans&&this.recalculateRecommendedPlansOnAssignmentChanges(e)}async processTaskUpdate(e,t,n,r){const i=e.id,s=this.taskStore.getTask(i),a=this.taskStore.getTaskDetails(i),o=this.taskStore.getTaskboardTaskFormatting(i);if(e.updateType===Rl.U.Insert){if(s)return;const a=ra.Y.builder.newFromDifferentialUpdate(e).build();if(this.loadTaskMissingData(a))return;let o,l;const c=Xo()(t,e=>e&&e.entityType===Gl.I.TaskDetails&&e.id===i,n+1);let d,u,h;-1!==c?(o=ia.U.builder.newFromDifferentialUpdate(t[c]).build(),r[c]=!0):this.retrieveTaskDetails(i);const p=Xo()(t,e=>e&&e.entityType===Gl.I.TaskboardAssignedToTaskFormatting&&e.id===i,n+1);-1!==p?(d=aa.x.builder.newFromDifferentialUpdate(t[p]).build(),r[p]=!0):this.retrieveTaskFormatsForTask(a,i,la.s.AssignedTo);const g=Xo()(t,e=>e&&e.entityType===Gl.I.TaskboardBucketTaskFormatting&&e.id===i,n+1);-1!==g?(u=Wl.g.builder.newFromDifferentialUpdate(t[g]).build(),r[g]=!0):this.retrieveTaskFormatsForTask(a,i,la.s.Bucket);const m=Xo()(t,e=>e&&e.entityType===Gl.I.TaskboardStatusTaskFormatting&&e.id===i,n+1);-1!==m?(h=zl.j.builder.newFromDifferentialUpdate(t[m]).build(),r[m]=!0):this.retrieveTaskFormatsForTask(a,i,la.s.Progress),(d||u||h)&&(l=oa._.builder.withPropertyBag({assignedBoardFormat:d,bucketBoardFormat:u,progressBoardFormat:h}).build());const f=sa.F.builder.withTask(a).withDetails(o).withFormatData(l).build(),v=this.applyMultipleTaskUpdates(f,t,n,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTask(v)}else if(e.updateType===Rl.U.Delete){if(null==s)return;const t=s.applyDifferentialUpdate(e);(await this.actionCreatorProviders.diffSyncActionCreator()).applyDeleteTask(sa.F.builder.withTask(t).build())}else if(e.updateType===Rl.U.Update)if(null==s){(await this.actionCreatorProviders.taskActionCreator()).fetchTaskEntityGroup(i,!0,!0)}else{let l;if(1===this.compareItemVersions(e.itemVersion,s.itemVersion)&&(l=s.applyDifferentialUpdate(e),this.loadTaskMissingData(l)),null==a&&this.retrieveTaskDetails(i),null==o&&(this.retrieveTaskFormats(i,la.s.AssignedTo),this.retrieveTaskFormats(i,la.s.Bucket),this.retrieveTaskFormats(i,la.s.Progress)),l){const e=sa.F.builder.withTask(s).withDetails(a||void 0).withFormatData(o||void 0).build(),i=this.applyMultipleTaskUpdates(sa.F.builder.withTask(l).withDetails(a||void 0).withFormatData(o||void 0).build(),t,n,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTask(e,i)}}}applyMultipleTaskUpdates(e,t,n,r){let i=e.task;i&&(i=this.processMultipleUpdates(i,n+1,t,r));let s=e.taskDetails;s&&(s=this.processMultipleUpdates(s,n+1,t,r));let a=e.taskFormatData;if(a){let e=a.assignmentBoardFormat;e&&(e=this.processMultipleUpdates(e,n+1,t,r));let i=a.bucketBoardFormat;i&&(i=this.processMultipleUpdates(i,n+1,t,r));let s=a.progressBoardFormat;s&&(s=this.processMultipleUpdates(s,n+1,t,r)),a=oa._.builder.withPropertyBag({assignedBoardFormat:e,bucketBoardFormat:i,progressBoardFormat:s}).build()}return sa.F.builder.withTask(i).withDetails(s).withFormatData(a).build()}processMultipleUpdates(e,t,n,r){let i=!1,s=e;for(let a=t;!i&&a<n.length;a++){const t=n[a];r[a]||t.id!==e.id||t.entityType!==e.entityType||(t.updateType===Rl.U.Update?1===this.compareItemVersions(t.itemVersion,s.itemVersion)&&(s=s.applyDifferentialUpdate(t),r[a]=!0):i=!0)}return s}async processTaskDetailsUpdate(e,t,n,r){const i=e.id,s=this.taskStore.getTask(i),a=this.taskStore.getTaskDetails(i);if(e.updateType===Rl.U.Insert){if(a)return;if(!s)return void this.retrieveTaskEntitySet(i);const o=ia.U.builder.newFromDifferentialUpdate(e).build(),l=this.processMultipleUpdates(o,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTaskDetails(l)}else if(e.updateType===Rl.U.Update){if(!s||!a)return void this.retrieveTaskEntitySet(i);if(1!==this.compareItemVersions(e.itemVersion,a.itemVersion))return;const o=a.applyDifferentialUpdate(e),l=this.processMultipleUpdates(o,n+1,t,r);for(const e in l.references)if(!a.references[e]||a.references[e].previewPriority!==l.references[e].previewPriority){(await this.actionCreatorProviders.taskActionCreator()).fetchReferencePreviewForTask(i);break}if((await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTaskDetails(a,l),l.approval!==a.approval){(await this.actionCreatorProviders.taskActionCreator()).fetchApprovalDetailsForTask(i)}}}async processBucketUpdate(e,t,n,r){const i=e.id,s=this.bucketStore.getBucket(i);if(e.updateType===Rl.U.Insert){if(s)return;const i=Nl.f.builder.newFromDifferentialUpdate(e).build();if(this.loadBucketMissingData(i))return;const a=this.processMultipleUpdates(i,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertBucket(a)}else if(e.updateType===Rl.U.Delete){if(!s)return;(await this.actionCreatorProviders.diffSyncActionCreator()).applyDeleteBucket(i)}else if(e.updateType===Rl.U.Update){if(!s)return void this.retrieveBucket(i);if(1!==this.compareItemVersions(e.itemVersion,s.itemVersion))return;const a=s.applyDifferentialUpdate(e),o=this.processMultipleUpdates(a,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateBucket(o)}}async processPlanUpdate(e,t,n,r){const i=e.id,s=this.planStore.getPlan(i),a=this.planStore.getPlanDetails(i)||void 0;if(e.updateType===Rl.U.Delete){if(!s)return;const t=s.applyDifferentialUpdate(e);(await this.actionCreatorProviders.diffSyncActionCreator()).applyDeletePlan(t)}else if(e.updateType===Rl.U.Update){if(!s)return void this.retrievePlanEntitySet(i);let o=null;if(1===this.compareItemVersions(e.itemVersion,s.itemVersion)&&(o=s.applyDifferentialUpdate(e)),a||this.retrievePlanEntitySet(i),o){o=this.processMultipleUpdates(o,n+1,t,r),this.updateUserDetailsWithPlan(o,a);const e=a?this.processMultipleUpdates(a,n+1,t,r):void 0;(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdatePlan(ss.T.builder.withPlan(o).withDetails(e).build())}}}async processPlanDetailsUpdate(e,t,n,r){const i=e.id,s=this.planStore.getPlan(i),a=this.planStore.getPlanDetails(i);if(e.updateType===Rl.U.Update){if(!s||!a)return void this.retrievePlanEntitySet(i);if(1!==this.compareItemVersions(e.itemVersion,a.itemVersion))return;const o=a.applyDifferentialUpdate(e),l=this.processMultipleUpdates(o,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdatePlanDetails(l)}}async processUserDetailsUpdate(e,t,n,r){if(e.updateType!==Rl.U.Update)return;const i=e.id,s=this.userStore.getUserDetailsById(i);if(!s)return;if(1!==this.compareItemVersions(e.itemVersion,s.itemVersion))return;const a=s.applyDifferentialUpdate(e),o=this.processMultipleUpdates(a,n+1,t,r);(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateUserDetails(o)}async processTaskAssignedToFmtUpdate(e,t,n,r){const i=e.id,s=this.taskStore.getTask(i),a=this.taskStore.getTaskboardTaskFormatting(i);if(e.updateType===Rl.U.Insert){if(null!==a&&void 0!==a&&a.assignmentBoardFormat)return;if(!s)return void this.retrieveTaskFormats(i,la.s.AssignedTo);const o=aa.x.builder.newFromDifferentialUpdate(e).build(),l=this.processMultipleUpdates(o,n+1,t,r),c=oa._.builder.withPropertyBag({assignedBoardFormat:l}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTaskFormatData(c)}else if(e.updateType===Rl.U.Update){if(null===a||void 0===a||!a.assignmentBoardFormat)return void this.retrieveTaskFormats(i,la.s.AssignedTo);if(1!==this.compareItemVersions(e.itemVersion,a.assignmentBoardFormat.itemVersion))return;const s=a.assignmentBoardFormat.applyDifferentialUpdate(e),o=this.processMultipleUpdates(s,n+1,t,r),l=oa._.builder.withPropertyBag({assignedBoardFormat:o}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTaskFormatData(a,l)}}async processTaskBucketFmtUpdate(e,t,n,r){const i=e.id,s=this.taskStore.getTask(i),a=this.taskStore.getTaskboardTaskFormatting(i);if(e.updateType===Rl.U.Insert){if(null!==a&&void 0!==a&&a.bucketBoardFormat)return;if(!s)return void this.retrieveTaskFormats(i,la.s.Bucket);const o=Wl.g.builder.newFromDifferentialUpdate(e).build(),l=this.processMultipleUpdates(o,n+1,t,r),c=oa._.builder.withPropertyBag({bucketBoardFormat:l}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTaskFormatData(c)}else if(e.updateType===Rl.U.Update){if(null===a||void 0===a||!a.bucketBoardFormat)return void this.retrieveTaskFormats(i,la.s.Bucket);if(1!==this.compareItemVersions(e.itemVersion,a.bucketBoardFormat.itemVersion))return;const s=a.bucketBoardFormat.applyDifferentialUpdate(e),o=this.processMultipleUpdates(s,n+1,t,r),l=oa._.builder.withPropertyBag({bucketBoardFormat:o}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTaskFormatData(a,l)}}async processTaskProgressFmtUpdate(e,t,n,r){const i=e.id,s=this.taskStore.getTask(i),a=this.taskStore.getTaskboardTaskFormatting(i);if(e.updateType===Rl.U.Insert){if(null!==a&&void 0!==a&&a.progressBoardFormat)return;if(!s)return void this.retrieveTaskFormats(i,la.s.Progress);const o=zl.j.builder.newFromDifferentialUpdate(e).build(),l=this.processMultipleUpdates(o,n+1,t,r),c=oa._.builder.withPropertyBag({progressBoardFormat:l}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyInsertTaskFormatData(c)}else if(e.updateType===Rl.U.Update){if(null===a||void 0===a||!a.progressBoardFormat)return void this.retrieveTaskFormats(i,la.s.Progress);if(1!==this.compareItemVersions(e.itemVersion,a.progressBoardFormat.itemVersion))return;const s=a.progressBoardFormat.applyDifferentialUpdate(e),o=this.processMultipleUpdates(s,n+1,t,r),l=oa._.builder.withPropertyBag({progressBoardFormat:o}).build();(await this.actionCreatorProviders.diffSyncActionCreator()).applyUpdateTaskFormatData(a,l)}}async recalculateRecommendedPlansOnAssignmentChanges(e){const t=this.appContextStore.getCurrentUserId(),n=e.filter(e=>e.entityType===Gl.I.Task&&(e.updateType===Rl.U.Insert||e.updateType===Rl.U.Update));if(Kl()(n,e=>{const n=e.getCreateDiffData().assignments;return n&&-1!==Object.keys(n).indexOf(t)})>-1){(await this.actionCreatorProviders.recommendedPlansActionCreator()).calculateRecommendedPlansForUser(t)}}async retrieveTaskEntitySet(e){(await this.actionCreatorProviders.taskActionCreator()).fetchTaskEntityGroup(e,!0)}retrieveTaskDetails(e){this.retrieveTaskEntitySet(e)}retrieveTaskFormats(e,t){const n=this.taskStore.getTask(e);n?this.retrieveTaskFormatsForTask(n,e,t):this.retrieveTaskEntitySet(e)}async retrieveTaskFormatsForTask(e,t,n){const r=this.taskStore.getTaskboardTaskFormattingForPlan(e.planId,n),i=await this.actionCreatorProviders.taskActionCreator();r?i.fetchTaskEntityGroup(t,!0):i.fetchTasksForPlan(e.planId,!0,!1)}async retrieveBucket(e){(await this.actionCreatorProviders.bucketActionCreator()).fetchBucket(e,!0)}async retrievePlanEntitySet(e){(await this.actionCreatorProviders.planActionCreator()).fetchPlan(e,!0)}async retrieveTasksForPlan(e){(await this.actionCreatorProviders.taskActionCreator()).fetchTasksForPlan(e,!0,!1)}async retrieveBucketsForPlan(e){(await this.actionCreatorProviders.bucketActionCreator()).fetchBucketsForPlan(e,!0)}loadTaskMissingData(e){let t=!1;const n=null!=e.planId?this.planStore.getPlan(e.planId):null;if(n||(this.retrievePlanEntitySet(e.planId),t=!0),null!=e.bucketId){if(!this.bucketStore.getBucket(e.bucketId)){const n=null!=e.planId?this.bucketStore.getBucketsForPlan(e.planId):[];null==e.planId||n&&0!==n.length?this.retrieveBucket(e.bucketId):this.retrieveBucketsForPlan(e.planId),t=!0}}const r=[];Ut()(e.getAssigneeIds(),e=>{this.userStore.getUserById(e)||r.push(e)}),r.length>0&&this.actionCreatorProviders.userActionCreator().then(e=>{n&&e.fetchUsersForContainer(n.container,void 0,!0),e.fetchUsers(r,!0)});const i=null!=e.planId?this.taskStore.getTasksForPlan(e.planId):null;return null==e.planId||i&&0!==i.length||(this.retrieveTasksForPlan(e.planId),t=!0),t&&i&&i.length>0&&this.retrieveTaskEntitySet(e.id),t}loadBucketMissingData(e){if(!this.planStore.getPlan(e.planId))return this.retrievePlanEntitySet(e.planId),this.retrieveBucketsForPlan(e.planId),!0;const t=this.bucketStore.getBucketsForPlan(e.planId);return(!t||0===t.length)&&(this.retrieveBucketsForPlan(e.planId),!0)}compareItemVersions(e,t){if(null==e&&null==t)return 0;if(null==e)return-1;if(null==t)return 1;if(e===t)return 0;const n=Number(t),r=Number(e);return isNaN(n)||isNaN(r)?e<t?-1:1:r===n?0:r<n?-1:1}async updateUserDetailsWithPlan(e,t){(await this.actionCreatorProviders.planActionCreator()).updateUserDetailsWithPlan(ss.T.builder.withPlan(e).withDetails(t).build())}constructor(e,t,n,r,i,s,a,o,l){this.loggers=o,this.actionCreatorProviders=e,this.appContextStore=t,this.bucketStore=n,this.diffSyncStore=r,this.planStore=i,this.taskStore=s,this.userStore=a,this.shouldRecalculateRecommendedPlans=null!==l&&void 0!==l&&l,this.diffSyncStore.subscribeToStore(this.onDiffSyncStoreUpdate.bind(this))}}class Vl{async initializeDiffSyncLoop(){if(null==this.diffSyncStore.getDiffSyncToken()){(await this.diffSyncActionCreatorProvider()).fetchDiffSyncToken()}else this.onDiffSyncStoreUpdate()}async restartDiffSyncLoop(){if(this.backoffUtility.resetThresholdCounter(),this.tokenRetries=0,null==this.setTimeoutRef)return;this.async.clearTimeout(this.setTimeoutRef);const e=this.diffSyncStore.getDiffSyncToken(),t=await this.diffSyncActionCreatorProvider();null==e?t.fetchDiffSyncToken():(this.setTimeoutRef=this.async.setTimeout(()=>{this.setTimeoutRef=null,t.fetchDiffSyncFeed(e)},0),t.scheduleDiffSyncFetch())}getDelayInterval(){return this.diffSyncStore.isInErrorState()?this.postFailureRetryInterval:this.backoffUtility.getCurrentDelayInterval()}updateState(e){0===e?this.backoffUtility.incrementThresholdCounter():this.backoffUtility.resetThresholdCounter()}async scheduleDiffSyncFeedFetch(e){const t=this.diffSyncStore.getDiffSyncToken();if(null==t)return;const n=this.activityStore.getLastUserActivityTimestamp(),r=Nt()();if(n&&r.diff(n,"days")>k.c9.MaxDiffSyncInactiveDays){return void(await this.diffSyncStateActionCreatorProvider()).disableDiffSync(N.E$.Info)}if(!this.diffSyncStore.isDiffSyncRequestScheduled()&&!this.diffSyncStore.isDiffSyncDisabled()&&null==this.setTimeoutRef){const n=await this.diffSyncActionCreatorProvider();this.setTimeoutRef=this.async.setTimeout(()=>{this.setTimeoutRef=null,n.fetchDiffSyncFeed(t)},e),n.scheduleDiffSyncFetch()}}constructor(e,t,n,r,i,s,a,o,l){this.setTimeoutRef=null,this.maxTokenRetries=3,this.onDiffSyncStoreUpdate=async()=>{const e=this.diffSyncStore.getDiffSyncToken();if(this.updateState(this.diffSyncStore.getNumDiffsInLastFetch()),null!=e){this.tokenRetries=0;let e=this.diffSyncStore.getLastDiffSyncTimestamp();null==e&&(e=Nt()());const t=Nt().duration(Nt()().diff(e)).asSeconds();this.appContextStore.getFlights().EnableEnhancedPalauTelemetry&&this.loggers.traceLogger.logTrace(507838985,Rt.k.Info,"Time elapsed since last diff sync: [timeElapsed=".concat(t,"]"));const n=this.getDelayInterval(),r=t>n?0:1e3*n;!this.pageVisibilityStatusProvider.isPageHidden()||Nt().duration(Nt()().diff(e)).asHours()>Vl.INACTIVE_DIFFSYNC_FETCH_INTERVAL_IN_HOURS?this.scheduleDiffSyncFeedFetch(r):null==this.setTimeoutRef&&(this.setTimeoutRef=this.async.setTimeout(()=>{this.setTimeoutRef=null,this.onDiffSyncStoreUpdate()},1e3*n))}else if(this.tokenRetries++,this.tokenRetries<this.maxTokenRetries){(await this.diffSyncActionCreatorProvider()).fetchDiffSyncToken()}else{(await this.diffSyncStateActionCreatorProvider()).disableDiffSync(N.E$.Error)}},this.loggers=l,this.async=Zo.v.create(),this.diffSyncActionCreatorProvider=e,this.diffSyncStateActionCreatorProvider=t,this.diffSyncStore=n,this.appContextStore=r,this.backoffUtility=i,this.activityStore=s,this.tokenRetries=0,this.pageVisibilityStatusProvider=a;const{baseInterval:c,cutoff:d,backoffThreshold:u,retryInterval:h}=o,p=Math.random()*h*.1;this.postFailureRetryInterval=Math.ceil(h+p),this.diffSyncStore.subscribeToStore(this.onDiffSyncStoreUpdate),this.loggers.traceLogger.logTrace(507838986,Rt.k.Info,"Differential Sync Parameters: [BaseInterval=".concat(c,"][Cutoff=").concat(d,"][BackOffThreshold=").concat(u,"]"))}}Vl.INACTIVE_DIFFSYNC_FETCH_INTERVAL_IN_HOURS=1;class Zl{dispose(){this.planStore.unsubscribeFromStore(this.onStoreUpdateCallback)}async onPlanStoreUpdate(){var e;if(!this.planTitle)return void(this.planTitle=null===(e=this.planStore.getPlan(this.planId))||void 0===e?void 0:e.title);const t=this.planStore.getPlan(this.planId);(null===t||void 0===t?void 0:t.title)!==this.planTitle&&(this.planTitle=null===t||void 0===t?void 0:t.title,(null===t||void 0===t?void 0:t.title)&&this.planTitleUpdateCallback(t.title))}constructor(e,t,n){this.planId=e,this.planStore=t,this.planTitleUpdateCallback=n,this.onStoreUpdateCallback=()=>this.onPlanStoreUpdate(),this.planStore.subscribeToStore(this.onStoreUpdateCallback)}}class ql extends x.M{name(){return"LoopSinglePlanApp"}logUsage(e,t,n){this.props.loggers.usageLogger.logData(this.name(),e,t,n)}componentDidMount(){super.componentDidMount(),this.resizeEvent.on(window,"resize",C()(()=>{this.onAppResize()},100)),this.onAppResize(),null!=Y.B.clientSettings.OpenNotificationSettingsEventName&&this.openNotificationsEvent.on(window,Y.B.clientSettings.OpenNotificationSettingsEventName,()=>{this.actionCreatorProviders.dialogActionCreator().then(e=>e.openNotificationSettings())}),this.startUserActivityTracking(),this.diffSyncWorker&&this.diffSyncWorker.initializeDiffSyncLoop()}componentWillUnmount(){super.componentWillUnmount(),this.resizeEvent.off(),this.openNotificationsEvent.off(),this.planTitleRefreshEmitterWorker.dispose()}fetchCriticalData(e,t){}fetchNonCriticalData(e,t){}renderComponent(){const{appContextStore:e,routeStore:t}=this.props,n=this.getPlannerLoopContainerId(),r=this.getPlannerMainContentId();if(e.getAppErrorCode()===w.Hg.DynamicImportError)return this.renderErrorPage();const i=t.getCurrentPage(),s=this.getAppClassName(),a=this.getPageToRender(),o=this.getDialogJsx(n);kl.d.applyTheme(document.body,e.getCurrentTheme());const l=this.renderNotificationBar(),c=this.renderToastContainer();return g.createElement("div",{id:n},g.createElement(F.N,{className:"".concat(s," ").concat(i)},g.createElement(Ml.T,{value:this.props.loggers},g.createElement(X.P,{value:{appRootElementId:r}},l,g.createElement("div",{className:"appContent",ref:this.appElementRef},g.createElement("div",{className:"content",id:r},a),o,c)))))}getPageToRender(){const{appContextStore:e,routeStore:t,loggers:n}=this.props,r=t.getCurrentPage();return(0,Tl.F_)(r,n.logHandler),g.createElement(g.Suspense,{fallback:this.renderLoadingSpinner()},g.createElement(J.Pj,{value:this.state.attachmentBehaviorContext},g.createElement(M,{loggers:n,dispatcherEventManagement:this.props.dispatcherEventManagement,actionCreatorProviders:this.actionCreatorProviders,perfActionCreator:this.perfActionCreator,viewActionCreatorProvider:this.actionCreatorProviders.tasksByPlanViewActionCreator,appContextStore:e,aggregatesStore:this.aggregatesStore,bucketStore:this.bucketStore,containerMembershipStore:this.containerMembershipStore,permissionsStore:this.permissionsStore,planStore:this.planStore,taskStore:this.taskStore,containerStore:this.containerStore,userStore:this.props.userStore,viewStore:this.viewStore,walkthroughStore:this.walkthroughStore,groupDocumentsStore:this.groupDocumentsStore,wywaStore:this.wywaStore,tenantStore:this.tenantStore,assigneeSuggestionStore:this.assigneeSuggestionStore,viewPartitionKey:this.props.planId,showHeader:!0,showCopyLinkToTask:!0,isSlimView:this.isMobileView(),experimentAssignments:e.getExperiments(),flights:e.getFlights(),experiments:e.getExperiments(),onPageInteractive:this.props.onPageInteractive,isSessionFromTaskLink:e.isSessionFromTaskLink(),isFirstRunExperience:e.isFirstRunExperience(),onPlanLoaded:this.onPlanLoaded,showPlanViewNavLinks:!0,getSharepointDomainUrl:this.suiteNavStore.getSharepointDomainUrl.bind(this.suiteNavStore)})))}getAppClassName(){return(0,ll.x)(this.props.appContextStore.getCurrentTheme())}initialize(){const{loggers:e,dispatcher:t,serviceProviders:n,userStore:r,planId:i,appContextStore:s,activityStore:a,logicModuleFactory:o,actionCreatorFactory:l,planTitleUpdateCallback:c}=this.props,d=()=>Y.B.clientSettings,u=new Cl(window.localStorage,e.traceLogger);this.activityNotificationStore=new Io,this.aggregatesStore=new dn,this.bucketStore=new ii,this.containerMembershipStore=new fi,this.containerStore=new Wi(e),this.diffSyncStore=new He(Y.B.diffSyncToken,e),this.groupDocumentsStore=new yo,this.intelligenceStore=new Yt,this.notificationStore=new Uo(e),this.permissionsStore=new Wt(r.getCurrentUserDetails().userPolicies,e),this.planStore=new ls,this.suiteNavStore=new Ro,this.taskStore=new wa,this.tenantStore=new Wa(e),this.transactionStore=new Le(D.Jj),this.viewStore=new Ps(u,e),this.walkthroughStore=new no(e);const h=r.getUserDetailsById(Y.B.currentUserId),p=null!=h?h.recentPlans.references:{},g=i;this.wywaStore=new qo(p,P.TaskAnimationDelay,g,e),this.assigneeSuggestionStore=new $o(s.getCurrentUserId()),this.performanceCollectionStore=new ol(e.logHandler);const m={appContextStore:s,bucketStore:this.bucketStore,containerMembershipStore:this.containerMembershipStore,groupDocumentsStore:this.groupDocumentsStore,planStore:this.planStore,taskStore:this.taskStore,tenantStore:this.tenantStore,containerStore:this.containerStore,userStore:r,walkthroughStore:this.walkthroughStore,activityNotificationStore:this.activityNotificationStore,activityStore:a,notificationStore:this.notificationStore,permissionsStore:this.permissionsStore,suiteNavStore:this.suiteNavStore,viewStore:this.viewStore,wywaStore:this.wywaStore};this.activityFeedProvider=new Ul(r.getUserById.bind(r),r.getCurrentUser.bind(r),e.traceLogger),this.logicModuleProviders={bucketModule:o.getBucketModuleProvider(t,n,m,d),configurationModule:o.getConfigurationModuleProvider(t,n,m,d),containerModule:o.getContainerModuleProvider(t,n,m,d),diffSyncModule:o.getDiffSyncModuleProvider(t,n,m,d),driveItemModule:o.getDriveItemModuleProvider(t,n,m,d),experimentationModule:o.getExperimentationModuleProvider(t,n),exportToExcelModule:()=>{throw e.traceLogger.logTrace(508077446,Rt.k.Warning,"exportToExcelModule not available in LoopsinglePlanApp"),new Error("exportToExcelModule not available in LoopSinglePlanApp")},intelligenceModule:o.getIntelligenceModuleProvider(t,n),linksModule:o.getLinksModuleProvider(t,n,m,d),permissionsModule:o.getPermissionModuleProvider(t,n,m,d),notificationModule:o.getNotificationModuleProvider(t,n,m,d),operationTrackingModule:o.getOperationTrackingModuleProvider(t,n,m,d),planModule:o.getPlanModuleProvider(t,n,m,d),projectModule:o.getProjectModuleProvider(t,n,m,d),taskModule:o.getTaskModuleProvider(t,n,m,d),telemetryModule:o.getTelemetryModuleProvider(t,n,m,d),templateModule:o.getTemplateModuleProvider(t,n,m,d),tenantModule:o.getTenantModuleProvider(t,n,m,d),unifiedGroupModule:o.getUnifiedGroupModuleProvider(t,n,m,d),userModule:o.getUserModuleProvider(t,n,m,d),teamsTasksModule:()=>{throw e.traceLogger.logTrace(508077445,Rt.k.Warning,"TeamsTasksModule not available in Loop Planner"),new Error("TeamsTasksModule not available in Loop Planner")},campaignModule:o.getCampaignModuleProvider(t,n)},this.actionCreatorProviders={bucketActionCreator:l.getBucketActionCreator(t,this.logicModuleProviders,m),experimentationActionCreator:l.getExperimentationActionCreator(t,this.logicModuleProviders.experimentationModule),notificationActionCreator:l.getNotificationActionCreator(t,m.appContextStore),planActionCreator:l.getPlanActionCreator(t,this.logicModuleProviders,m),taskActionCreator:l.getTaskActionCreator(t,m,this.logicModuleProviders,this.activityFeedProvider,this.getShareDeepLinkCallback()),tasksByAssigneeViewActionCreator:()=>{throw e.traceLogger.logTrace(508077444,Rt.k.Warning,"tasksByAssigneeViewActionCreator is not available in Loop Planner."),new Error("tasksByAssigneeViewActionCreator not available in LoopSinglePlanApp")},tasksByPlanViewActionCreator:l.getTasksByPlanViewActionCreator(t,m,this.logicModuleProviders),tasksByWorkspaceViewActionCreator:()=>{throw e.traceLogger.logTrace(508077443,Rt.k.Warning,"tasksByWorkspaceViewActionCreator is not available in Loop Planner."),new Error("tasksByWorkspaceViewActionCreator not available in LoopSinglePlanApp")},viewTransformsActionCreator:l.getViewTransformsActionCreator(t,m,this.logicModuleProviders),unifiedGroupActionCreator:l.getUnifiedGroupActionCreator(t,this.logicModuleProviders,m),userActionCreator:l.getUserActionCreator(t,this.logicModuleProviders,m),userPlansRetrievalActionCreator:l.getUserPlansRetrievalActionCreator(t,this.logicModuleProviders,m),walkthroughActionCreator:l.getWalkthroughActionCreator(t,m,this.logicModuleProviders),wywaActionCreator:l.getWywaActionCreator(t,m,this.logicModuleProviders),dialogActionCreator:l.getDialogActionCreator(t,this.logicModuleProviders,m),diffSyncActionCreator:l.getDiffSyncActionCreator(t,this.logicModuleProviders,m),diffSyncStateActionCreator:l.getDiffSyncStateActionCreator(t),tenantActionCreator:()=>{throw e.traceLogger.logTrace(508077442,Rt.k.Warning,"TenantActionCreator is not supported in Loop Planner."),new Error("TenantActionCreator is not supported in Loop Planner.")},navigationActionCreator:this.props.navigationActionCreatorProvider,containerActionCreator:l.getContainerActionCreator(t,this.logicModuleProviders,m),uiLayoutActionCreator:l.getUILayoutActionCreator(t),linksActionCreator:l.getLinksActionCreator(t,this.logicModuleProviders),exportActionCreator:l.getExportActionCreator(t,this.logicModuleProviders,m),intelligenceActionCreator:l.getIntelligenceActionCreator(t,this.logicModuleProviders,m),groupDocumentsActionCreator:l.getGroupDocumentsActionCreator(t,this.logicModuleProviders,m,new Ol),activityActionCreator:l.getActivityActionCreator(t),operationsActionCreator:l.getOperationsActionCreator(t,this.logicModuleProviders,m),buildsActionCreator:l.getBuildsActionCreator(t,this.logicModuleProviders,m),settingsActionCreator:l.getSettingsActionCreator(t),prefetchActionCreator:l.getPrefetchActionCreator(t),templateActionCreator:l.getTemplateActionCreator(t,this.logicModuleProviders,m),teamsTasksActionCreator:()=>{throw e.traceLogger.logTrace(508077441,Rt.k.Warning,"TeamsTasksActionCreator not available in Loop Planner"),new Error("TeamsTasksActionCreator not available in Loop Planner")},suiteNavActionCreator:()=>{throw e.traceLogger.logTrace(508073246,Rt.k.Warning,"SuiteNavActionCreator not available in Loop Planner"),new Error("SuiteNavActionCreator not available in Loop Planner")},recommendedPlansActionCreator:()=>{throw e.traceLogger.logTrace(508070102,Rt.k.Warning,"RecommendedPlansActionCreator not available in Loop Planner"),new Error("RecommendedPlansActionCreator not available in Loop Planner")},irisActionCreator:()=>{throw e.traceLogger.logTrace(506545303,Rt.k.Warning,"IrisActionCreator not available in Loop Planner"),new Error("IrisActionCreator not available in Loop Planner")}},this.perfActionCreator=new ie(t),t.registerStore(this.aggregatesStore),t.registerStore(this.bucketStore),t.registerStore(this.containerMembershipStore),t.registerStore(this.groupDocumentsStore),t.registerStore(this.intelligenceStore),t.registerStore(this.notificationStore),t.registerStore(this.activityNotificationStore),t.registerStore(this.permissionsStore),t.registerStore(this.planStore),t.registerStore(this.suiteNavStore),t.registerStore(this.taskStore),t.registerStore(this.tenantStore),t.registerStore(this.transactionStore),t.registerStore(this.containerStore),t.registerStore(this.viewStore),t.registerStore(this.walkthroughStore),t.registerStore(this.diffSyncStore),t.registerStore(this.performanceCollectionStore);const f=Y.B.diffSyncParameters,v=new vl(f.baseInterval,f.cutoff,f.backoffThreshold);this.diffSyncWorker=new Vl(this.actionCreatorProviders.diffSyncActionCreator,this.actionCreatorProviders.diffSyncStateActionCreator,this.diffSyncStore,this.props.appContextStore,v,a,new yl,f,e),new Hl(this.actionCreatorProviders,s,this.bucketStore,this.diffSyncStore,this.planStore,this.taskStore,r,e),this.planTitleRefreshEmitterWorker=new Zl(g,this.planStore,c)}checkForCriticalDataReady(){return!0}onOpenLink(e){dl.b.safelyOpenExternalUrl(e.url,"_blank")}renderNotificationBar(){return g.createElement(j,{dispatcherEventManagement:this.props.dispatcherEventManagement,notificationActionCreatorProvider:this.actionCreatorProviders.notificationActionCreator,bucketStore:this.bucketStore,notificationStore:this.notificationStore,planStore:this.planStore,taskStore:this.taskStore,userStore:this.props.userStore,appContextStore:this.props.appContextStore})}renderToastContainer(){return g.createElement(A.N,{dispatcherEventManagement:this.props.dispatcherEventManagement,toastStore:this.notificationStore,toastActionCreatorProvider:this.actionCreatorProviders.notificationActionCreator,toastLocation:A.t.BottomLeft,disableAutoDismiss:this.props.appContextStore.getCurrentDialogData().dialogType===me.h.ToastManager,renderToastContent:(e,t,n,r)=>g.createElement(q.f,{toastType:t,onDismiss:n,data:r,theme:this.props.appContextStore.getCurrentTheme(),toastTypeWhitelist:this.toastTypeWhitelist}),layerProps:{className:"toast-layer",hostId:this.getPlannerMainContentId()}})}renderLoadingSpinner(){return g.createElement("div",{className:"page-spinner"},g.createElement(L.y,{size:_.H.large,className:"spinner",label:bl.p.Strings.SharedComponents_StandBySpinner,styles:(0,cl.Zz)(this.props.appContextStore.getCurrentTheme())}))}isMobileView(){return this.props.appContextStore.getCurrentPageFormFactorState()===E.qk.Mobile}getShareDeepLinkCallback(){}startUserActivityTracking(){const e=C()(async()=>{const e=Nt()();(await this.actionCreatorProviders.activityActionCreator()).updateUserActivityTimestamp(e)},k.c9.UserActivitySamplingResolution),t=["click","dblclick","mousemove","mouseup","mousedown","mouseenter","keyup","keydown","keypress","submit","change","scroll","resize"];for(const n of t)document.addEventListener(n,e,{capture:!0})}getDialogJsx(e){const{appContextStore:t}=this.props,n=t.getCurrentDialogData()||{dialogType:me.h.None},r=n.dialogType&&n.dialogType!==me.h.None,i=sl.isAuthenticationFailureNotification(this.notificationStore);return r||i?g.createElement(g.Suspense,{fallback:g.createElement(g.Fragment,null)},g.createElement(Z,{theme:t.getCurrentTheme(),dispatcherEventManagement:this.props.dispatcherEventManagement,experimentAssignments:this.props.appContextStore.getExperiments(),actionCreatorProviders:this.actionCreatorProviders,aggregatesStore:this.aggregatesStore,appContextStore:this.props.appContextStore,bucketStore:this.bucketStore,containerMembershipStore:this.containerMembershipStore,groupDocumentsStore:this.groupDocumentsStore,intelligenceStore:this.intelligenceStore,notificationStore:this.notificationStore,permissionsStore:this.permissionsStore,planStore:this.planStore,routeStore:this.props.routeStore,suiteNavStore:this.suiteNavStore,taskStore:this.taskStore,tenantStore:this.tenantStore,transactionStore:this.transactionStore,containerStore:this.containerStore,userStore:this.props.userStore,targetContainerElementId:e,activityFeedProvider:this.activityFeedProvider,toastTypeWhitelist:this.toastTypeWhitelist,openAppPoweredLinkCallBack:()=>{}})):null}renderErrorPage(){const e=this.props.appContextStore.getCurrentTheme(),t=this.props.reloadCallback||(()=>window.location.reload());return g.createElement(F.N,{className:(0,cl.Tk)(e)},g.createElement(g.Suspense,{fallback:this.renderLoadingSpinner()},g.createElement(H,{theme:e,ref:this.appElementRef,reloadCallback:t,errorMessageTitle:bl.p.Strings.Errors_SomethingWentWrongErrorTitle,errorMessageBody:bl.p.Strings.Errors_SomethingWentWrongErrorBody,reloadButtonText:bl.p.Strings.Errors_ReloadButtonText,isReloadButtonDisplayed:!0})))}getPlannerMainContentId(){return(0,Bl.cL)(this.props.appContextStore.getAppInstanceId())}getPlannerLoopContainerId(){return(0,Bl.xZ)(this.props.appContextStore.getAppInstanceId())}constructor(e,t){super(e,t),this.toastTypeWhitelist=[se.N.type,ae.g.type,oe.N.type,le.W.type,de.z.type,ce.e.type,ue.Q.type,he.c.type,ge.R.type,pe.f.type],this.appElementRef=g.createRef(),this.onAppResize=async()=>{const e=this.appElementRef.current;if(e){(await this.actionCreatorProviders.uiLayoutActionCreator()).windowResize(e.offsetHeight,e.offsetWidth)}},this.onPlanLoaded=e=>{this.actionCreatorProviders.planActionCreator().then(t=>{t.setPlanLastAccess(e,new Date)}).catch(()=>{})},fl(),this.initialize(),this.perfActionCreator.appStart(this.props.routeStore.getCurrentPage(),this.props.appStartTime),this.openNotificationsEvent=new U.g(this),this.resizeEvent=new U.g(this),this.state={attachmentBehaviorContext:{openLinkCallback:this.onOpenLink,openLinkInNewWindow:!1}}}}const Yl=(0,Sl.y)(ql);var Jl=n(89608),Xl=n(75559);const $l=e=>{const{loopAppProps:t,viewRef:n,theme:i,getAppErrorCode:s,initializeComponent:a,onKeyDownHandler:o}=e,[l,c]=g.useState(s()),d=async()=>{await a();const e=s();c(e)};let u;if(l){const e=(0,Jl.oK)(l,i,d);u=(0,p.jsx)(Xl.ComponentErrorPage,(0,r.A)({},e))}else u=(0,p.jsx)(Yl,(0,r.A)({},t));return(0,p.jsx)("div",{style:{position:"relative",height:l?"150px":"700px"},onKeyDown:o,role:"presentation",tabIndex:0,ref:n,children:u})};var Ql=n(27284),ec=n(47373),tc=n(59190);class nc extends Ql.EventEmitter{constructor(e,t,n,r,i,s){super(),this.loopAppProps=e,this.stylingProvider=t,this.onPlannerRendered=n,this.getAppErrorCode=r,this.initializeComponent=i,this.logger=s,this.viewRef=g.createRef(),this.keydownShortcuts=[],this.isFocused=!1,this.userActivityEventHandler=e=>{this.emit("userActivity"),this.removeHostingElementEventListeners()},this.removeHostingElementEventListeners=()=>{var e,t,n;null===(e=this.element)||void 0===e||e.removeEventListener("focus",this.userActivityEventHandler,{capture:!0}),null===(t=this.element)||void 0===t||t.removeEventListener("scroll",this.userActivityEventHandler,{capture:!0}),null===(n=this.element)||void 0===n||n.removeEventListener("click",this.userActivityEventHandler,{capture:!0})},this.moveFocusToHostingCanvas=()=>{var e;null===(e=this.hostComponent)||void 0===e||null===(e=e.ComponentFocusable)||void 0===e||e.giveFocus(),this.isFocused=!1},this.setFocus=()=>!!this.viewRef.current&&(this.isFocused=!0,this.viewRef.current.focus(),!0),this.moveSelectionToHost=e=>{var t;let n;n=this.previousLocation&&void 0!==this.previousLocation.x?{mode:v.Q.ip,direction:e,currentCoordinates:{x:this.previousLocation.x,y:void 0},currentSelection:this}:{mode:v.Q.ip,direction:e,currentSelection:this},null===(t=this.hostComponent)||void 0===t||null===(t=t.ComponentSelection)||void 0===t||t.setSelection(n),delete this.previousLocation,this.isFocused=!1},this.onKeyDownHandler=e=>{!function(e,t){const n=e.find(e=>function(e,t){const n=t.keyboardShortcutDescription;return n.type===e.type&&n.key===e.key&&!!n.altKey===e.altKey&&!!n.ctrlKey===e.ctrlKey&&!!n.metaKey===e.metaKey&&!!n.shiftKey===e.shiftKey}(t,e));if(void 0!==n)n.handler(t),t.stopPropagation(),t.preventDefault()}(this.keydownShortcuts,e)},this.onThemeChanged=()=>{const e=this.getPlannerTheme();this.loopAppProps.dispatcher.dispatchAction(new y.k(e))},this.getPlannerTheme=()=>{var e;return(null===(e=this.stylingProvider)||void 0===e||null===(e=e.themeProperties)||void 0===e?void 0:e.get(b.e))===b.L?k.Sx.LoopDark:k.Sx.LoopLight},this.stylingProvider&&(this.stylingProvider.on(f.j.themePropertiesChanged,this.onThemeChanged),this.onThemeChanged())}get UserActivityProvider(){return this}addUserActivityListener(){var e,t,n;null===(e=this.element)||void 0===e||e.addEventListener("focus",this.userActivityEventHandler,{capture:!0,once:!0}),null===(t=this.element)||void 0===t||t.addEventListener("scroll",this.userActivityEventHandler,{capture:!0,once:!0}),null===(n=this.element)||void 0===n||n.addEventListener("click",this.userActivityEventHandler,{capture:!0,once:!0})}get HTMLView(){return this}async dispose(){var e;this.element&&(null===(e=this.stylingProvider)||void 0===e||e.off(f.j.themePropertiesChanged,this.onThemeChanged),m.unmountComponentAtNode(this.element),delete this.element)}render(e){const t=o.m.start(tc.yz.ViewRenderReady,this.logger);if(this.element=e,this.logger){const e=this.logger;this.UserActivityProvider.once("userActivity",()=>{(0,ec.o4)(e,{eventName:"UserActiveInComponent"})}),this.addUserActivityListener()}const n=(0,r.A)((0,r.A)({},this.loopAppProps),{},{onPageInteractive:e=>{var n,r;null===(n=(r=this.loopAppProps).onPageInteractive)||void 0===n||n.call(r,e),t.setResult(!e)}}),i=(0,p.jsx)($l,{loopAppProps:n,getAppErrorCode:this.getAppErrorCode,initializeComponent:this.initializeComponent,onKeyDownHandler:this.onKeyDownHandler,viewRef:this.viewRef,theme:this.getPlannerTheme()});return new Promise(n=>{m.render(i,e,()=>{this.onPlannerRendered();const e=this.getAppErrorCode();e&&t.setResult(!0,{appErrorCode:e}),n()})})}get ComponentFocusable(){return this}giveFocus(){return this.setFocus()}isComponentFocused(){return this.isFocused}setHostComponentFocusable(e){this.hostComponent=(0,r.A)((0,r.A)({},this.hostComponent),{},{ComponentFocusable:e})}get ComponentSelection(){return this}clearSelection(){delete this.previousLocation}setSelection(e){return this.previousLocation=e.currentCoordinates,this.setFocus()}setHostComponentSelection(e){this.hostComponent=(0,r.A)((0,r.A)({},this.hostComponent),{},{ComponentSelection:e})}get KeyboardShortcutEmitter(){return this}setShortcuts(e){const t=(n=this.moveSelectionToHost,r=this.moveFocusToHostingCanvas,[{handler:()=>{n(v.S.left)},keyboardShortcutDescription:{key:"ArrowLeft",isOverride:!0,type:"keydown"}},{handler:()=>{n(v.S.up)},keyboardShortcutDescription:{key:"ArrowUp",isOverride:!0,type:"keydown"}},{handler:()=>{n(v.S.right)},keyboardShortcutDescription:{key:"ArrowRight",isOverride:!0,type:"keydown"}},{handler:()=>{n(v.S.down)},keyboardShortcutDescription:{key:"ArrowDown",isOverride:!0,type:"keydown"}},{keyboardShortcutDescription:{key:"Home",type:"keydown"},handler:()=>n(v.S.lineBegin)},{keyboardShortcutDescription:{key:"End",type:"keydown"},handler:()=>n(v.S.lineEnd)},{keyboardShortcutDescription:{key:"PageUp",type:"keydown"},handler:()=>n(v.S.pageUp)},{keyboardShortcutDescription:{key:"PageDown",type:"keydown"},handler:()=>n(v.S.pageDown)},{keyboardShortcutDescription:{key:"Escape",type:"keydown"},handler:()=>r()}]);var n,r;this.keydownShortcuts=function(e,t,n){const r={componentCriticalShortcuts:[],hostOverrideShortcuts:(0,T.D)(t,!0),componentNormalShortcuts:[...e],hostNormalShortcuts:(0,T.D)(t,!1),componentLowShortcuts:[]};return(0,S.V)(r,n)}(t,e,"keydown")}}const rc=n.p+"static/media/planner.513ec4dc85112d1c0cbc2ac68c7d01fe.svg";var ic=n(52956);var sc=n(28184),ac=n(68639);class oc extends Ql.EventEmitter{constructor(e,t){super(),this.initialConfig=e,this.providers=t,this.entityName=tc.AB,this.name=d.ZV,this.iconUrl=(0,ic.i)(rc).source,this.experienceType="Collaborative",this.planTitleUpdateCallback=e=>{this._title=e,this.emit("titleChanged",e)}}get ComponentInitializer(){return this}async initialize(){const e=o.m.start(tc.yz.LoadPlannerComponent,void 0,{isAPerformanceMetric:!0});try{this._plannerDependency=await this.getDependencyPromise(),this._componentInfo=await this.getInfoPromise(),this._title=this._componentInfo.planTitle,this.title&&this.appErrorCode&&(this.appErrorCode=void 0),e.setResult(!0)}catch(t){throw(0,tc.om)("LoopPlanner_initialize_error","Failed to initialize the component",Rt.k.Error,t),t}}get HTMLViewable(){return this}async getView(){const e=o.m.start(tc.yz.RenderPlannerView,this.plannerDependency.logger,{isAPerformanceMetric:!0}),t=o.m.start(tc.yz.GetPlannerView,this.plannerDependency.logger),n=t=>{e.setResult(!t)},i=()=>{(0,tc.om)("LoopPlanner_render_success","Render component successfully",Rt.k.Info)},s=(new Date).getTime();try{var a;const e=await(0,h.rQ)((0,h.Vf)(this.plannerDependency.tokenProvider,this.plannerDependency.userContext)),o=function(e){const t={hostname:"config.edge.skype.com",cloud:"Public",environment:"Prod"};switch(e){case"GCC-High":return{hostname:"config.ecs.gov.teams.microsoft.us",cloud:"GCCHigh",environment:"GCCH"};case"DoD":return{hostname:"config.ecs.dod.teams.microsoft.us",cloud:"DoD",environment:"DoD"};default:return t}}(null===(a=this.plannerDependency.settingsProvider)||void 0===a?void 0:a.audience),l=await async function(e){const t=e.hostname||"config.edge.skype.com",n=e.cloud||"Public",r=e.environment||"Prod";let i="https://".concat(t,"/config/v1/Planner/1.0.0.0?agents=").concat("PlannerWeb","&Cloud=").concat(n,"&Environment=").concat(r,"&Platform=").concat("Web");e.tenantId&&(i+="&tenantId=".concat(e.tenantId)),e.userId&&(i+="&userId=".concat(e.userId));try{const e=await fetch(i);if(!e.ok)throw new Error("Failed to fetch ECS settings: [Status: ".concat(e.status,", StatusText: ").concat(e.statusText));return(await e.clone().json()).PlannerWeb}catch(s){return(0,tc.om)("fetchPlannerECSSettings","Failed to fetch PlannerECSSettings",Rt.k.Warning,s),{}}}((0,r.A)((0,r.A)({},o),{},{tenantId:this.plannerDependency.userContext.tenantId,userId:e.id}));await(0,u.bg)(e,l,this.plannerDependency);const c=(0,u.nH)(s,e,this.componentInfo.planId,this.plannerDependency,this.planTitleUpdateCallback),d=()=>this.appErrorCode,p=async()=>{await this.initialize()},g=new nc((0,r.A)((0,r.A)({},c),{},{onPageInteractive:n}),this.plannerDependency.stylingProvider,i,d,p,this.plannerDependency.logger);return t.setResult(!0),g}catch(l){throw(0,tc.om)("LoopPlanner_getView_error","Failed to get view",Rt.k.Error,l),t.setResult(!1,void 0,l),l}}get ContentURL(){return this}async getContentURL(){return this.componentInfo.url}get LoopComponentUrl(){return this}async getLoopComponentUrl(){return this.componentInfo.url}get ComponentTelemetryMetadata(){return this}get ComponentProperties(){return this}get ComponentSerializable(){return this}async serialize(){throw Error("serialize is not implemented")}async rehydrate(e){throw Error("rehydrate is not implemented")}async getHtmlAsync(){var e;const t=document.createElement("a");return t.href=this.componentInfo.url.href,t.textContent=null!==(e=this.componentInfo.planTitle)&&void 0!==e?e:this.componentInfo.url.href,t.rel="noreferrer noopener",t.outerHTML}async getTextAsync(){return this.componentInfo.url.href}get ComponentTitle(){return this}get title(){return this._title}get LoopState(){return this}async isLoop(){return!0}async getDependencyPromise(){const e=this.providers;try{var t;if(!e)throw Error("Missing Providers");const[n,r,i,s,a,o,u,h]=await Promise.all([e.TokenProvider,e.SettingsProvider,e.StylingProvider,e.UserContext,e.InternationalizationContext,e.LoopTelemetrySink,e.TelemetryConfig,e.NamespaceLogger]),p=h?new l.p(tc.AB,h):void 0;if(!n)throw Error("Missing Token Providers");const g=null!==(t=null===r||void 0===r?void 0:r.audience)&&void 0!==t?t:d.CS,m={tenantId:await(0,ac.E)(n,s,g)};o&&!(0,tc.pk)(null===r||void 0===r?void 0:r.audience)&&(0,tc.$N)(o,(0,tc.eO)({userContext:m,settingsProvider:r,internationalizationContext:a,telemetryConfig:u})),Gt.f.setRedactionFunction(c.ku),Il.f.setRedactionFunction(c.ku);return{tokenProvider:n,settingsProvider:r,stylingProvider:i,userContext:m,internationalizationContext:a,loopTelemetrySink:o,telemetryConfig:u,logger:p}}catch(n){throw(0,tc.om)("getDependencyPromise","Failed to get Loop providers",Rt.k.Error,n),n}}get plannerDependency(){if(!this._plannerDependency)throw Error("Missing Planner Dependency");return this._plannerDependency}async getInfoPromise(){var e;let t;const n=(0,h.Vf)(this.plannerDependency.tokenProvider,this.plannerDependency.userContext,null===(e=this.plannerDependency.settingsProvider)||void 0===e?void 0:e.audience);if((0,i.I)(this.initialConfig,s.kW)){const e=this.initialConfig.creationData.data.url,r=(0,u.uD)(e);try{t={url:e,planId:r,planTitle:await(0,h.EW)(r,n)}}catch(a){this.appErrorCode=a.name,t={url:e,planId:r,planTitle:void 0}}}else{var r;t=await(0,sc.pL)(n,null===(r=this.plannerDependency.internationalizationContext)||void 0===r?void 0:r.uiLocale)}return t}get componentInfo(){if(!this._componentInfo)throw Error("Missing Component Info");return this._componentInfo}}const lc=new a.p(oc,{SettingsProvider:"SettingsProvider",StylingProvider:"StylingProvider",TokenProvider:"TokenProvider",UserContext:"UserContext",InternationalizationContext:"InternationalizationContext",LoopTelemetrySink:"LoopTelemetrySink",TelemetryConfig:"TelemetryConfig",NamespaceLogger:"NamespaceLogger"})},8122:(e,t,n)=>{"use strict";n.d(t,{P:()=>i,q:()=>r});const r=n(65043).createContext({appRootElementId:null}),i=r.Provider},8149:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.entityId=e}}i.actionType="AUGLOOP_FETCH_FILE_SUG"},8253:(e,t,n)=>{"use strict";function r(e){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=e.current;return null==t?null:t.decoratedRef?t.decoratedRef.current:t}function s(e){return(t=e)&&t.prototype&&"function"===typeof t.prototype.render||function(e){var t;return"Symbol(react.forward_ref)"===(null===e||void 0===e||null===(t=e.$$typeof)||void 0===t?void 0:t.toString())}(e);var t}function a(e,t){}function o(e){return"function"===typeof e}function l(){}function c(e){if(!function(e){return"object"===r(e)&&null!==e}(e))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function d(e,t){return"string"===typeof e||"symbol"===r(e)||!!t&&Array.isArray(e)&&e.every(function(e){return d(e,!1)})}n.d(t,{NE:()=>d,PQ:()=>i,Qd:()=>c,Tn:()=>o,Yy:()=>s,cl:()=>a,lQ:()=>l})},8820:(e,t,n)=>{var r=n(18902),i=n(75866),s=n(41558),a=n(50149),o=n(47574),l=n(58114),c=Math.min;e.exports=function(e,t,n){for(var d=n?s:i,u=e[0].length,h=e.length,p=h,g=Array(h),m=1/0,f=[];p--;){var v=e[p];p&&t&&(v=a(v,o(t))),m=c(v.length,m),g[p]=!n&&(t||u>=120&&v.length>=120)?new r(p&&v):void 0}v=e[0];var y=-1,k=g[0];e:for(;++y<u&&f.length<m;){var T=v[y],S=t?t(T):T;if(T=n||0!==T?T:0,!(k?l(k,S):d(f,S,n))){for(p=h;--p;){var b=g[p];if(!(b?l(b,S):d(e[p],S,n)))continue e}k&&k.push(S),f.push(T)}}return f}},8842:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{isFallBack:String(this.suiteNavModel.UseFallbackShell)}}constructor(e){super(i.actionType),this.suiteNavModel=e}}i.actionType="GET_SUITENAV_SUCCEEDED"},9614:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.unifiedGroupId=e}}i.actionType="PLW_DELETE_UNIFIEDGROUP"},10912:(e,t,n)=>{"use strict";n.d(t,{N:()=>R,t:()=>D});var r,i,s,a=n(65043),o=n(35363),l=n(937),c=n(66783),d=n(52195),u=n(68417),h=(0,u.i)({from:{opacity:0},to:{opacity:1}}),p=(0,u.i)({from:{opacity:1},to:{opacity:0}}),g=(0,u.i)({from:{transform:"scale3d(1.15, 1.15, 1)"},to:{transform:"scale3d(1, 1, 1)"}}),m=(0,u.i)({from:{transform:"scale3d(1, 1, 1)"},to:{transform:"scale3d(0.9, 0.9, 1)"}}),f=(0,u.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(-48px, 0, 0)"}}),v=(0,u.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(48px, 0, 0)"}}),y=(0,u.i)({from:{transform:"translate3d(48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),k=(0,u.i)({from:{transform:"translate3d(-48px, 0, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),T=(0,u.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, -48px, 0)"}}),S=(0,u.i)({from:{transform:"translate3d(0, 0, 0)"},to:{transform:"translate3d(0, 48px, 0)"}}),b=(0,u.i)({from:{transform:"translate3d(0, 48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}}),I=(0,u.i)({from:{transform:"translate3d(0, -48px, 0)"},to:{transform:"translate3d(0, 0, 0)"}});function C(e,t,n){return"".concat(e," ").concat(t," ").concat(n)}!function(e){e.duration1="100ms",e.duration2="200ms",e.duration3="300ms",e.duration4="400ms"}(r||(r={})),function(e){e.accelerate="cubic-bezier(0.9, 0.1, 1, 0.2)",e.decelerate="cubic-bezier(0.1, 0.9, 0.2, 1)",e.linear="cubic-bezier(0, 0, 1, 1)",e.standard="cubic-bezier(0.8, 0, 0.2, 1)"}(i||(i={})),function(e){e.fadeIn=C(h,r.duration1,i.linear),e.fadeOut=C(p,r.duration1,i.linear),e.scaleDownIn=C(g,r.duration3,i.decelerate),e.scaleDownOut=C(m,r.duration3,i.decelerate),e.slideLeftOut=C(f,r.duration1,i.accelerate),e.slideRightOut=C(v,r.duration1,i.accelerate),e.slideLeftIn=C(y,r.duration1,i.decelerate),e.slideRightIn=C(k,r.duration1,i.decelerate),e.slideUpOut=C(T,r.duration1,i.accelerate),e.slideDownOut=C(S,r.duration1,i.accelerate),e.slideUpIn=C(b,r.duration1,i.decelerate),e.slideDownIn=C(I,r.duration1,i.decelerate)}(s||(s={}));var D,E=n(25420),P="50px",w="20px",x=(0,c.J9)(function(e,t){var n={right:"0px",".base-toast":{marginRight:w}},r={left:"0px",".base-toast":{marginLeft:w}},i={top:P},a={bottom:P,flexDirection:"column-reverse"},o={root:[(0,E.gS)("column"),{position:"absolute",zIndex:"1",maxWidth:"100%"},e===D.BottomLeft&&[a,r],e===D.TopLeft&&[i,r],e===D.BottomRight&&[a,n],e===D.TopRight&&[i,n]],toast:{animation:s.fadeIn}};return(0,d.TW)(o,t)}),A=(0,c.J9)(function(e,t){var n=x(e,t);return{root:(0,d.Zq)("toast-container",n.root),toast:(0,d.Zq)("toast",n.toast)}}),F=n(33411),L=n.n(F),_=n(49874),U=n.n(_),O=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(){return B=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},B.apply(this,arguments)},M=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function a(e){try{l(r.next(e))}catch(t){s(t)}}function o(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,o)}l((r=r.apply(e,t||[])).next())})},N=function(e,t){var n,r,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(o){s=[6,o],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}};!function(e){e[e.TopLeft=0]="TopLeft",e[e.TopRight=1]="TopRight",e[e.BottomLeft=2]="BottomLeft",e[e.BottomRight=3]="BottomRight"}(D||(D={}));var R=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.state={},r.pendingTimeouts={},r}return O(t,e),t.prototype.name=function(){return"ToastContainer"},t.prototype.renderComponent=function(){var e=this,t=this.props,n=t.layerProps,r=t.toastStore,i=t.maxDisplayableToasts,s=void 0===i?8:i,l=r&&r.getToasts(),c=this.getClassNames();return l&&l.length>0?a.createElement(o.W,B({},n),a.createElement("div",{className:c.root},L()(U()(l,s),function(t){return e.renderToastWithTimeout(t)}))):null},t.prototype.renderToastWithTimeout=function(e){var t,n=this,r=this.props,i=r.timeout,s=void 0===i?1e4:i,o=r.disableAutoDismiss,l=r.renderToastContent,c=null!==(t=e.timeout)&&void 0!==t?t:s;!o&&c>0?this.pendingTimeouts[e.id]||(this.pendingTimeouts[e.id]=this.async.setTimeout(function(){delete n.pendingTimeouts[e.id],n.onToastDismiss(e.id,!1)},c)):this.pendingTimeouts[e.id]&&(this.async.clearTimeout(this.pendingTimeouts[e.id]),delete this.pendingTimeouts[e.id]);var d=this.getClassNames();return a.createElement("div",{className:d.toast,key:e.id},l&&l(e.id,e.type,function(){return n.onToastDismiss(e.id,!0)},e.data))},t.prototype.onToastDismiss=function(e,t){return M(this,void 0,void 0,function(){var n,r,i;return N(this,function(s){switch(s.label){case 0:return n=this.props.toastActionCreatorProvider,this.pendingTimeouts[e]&&(this.async.clearTimeout(this.pendingTimeouts[e]),delete this.pendingTimeouts[e]),t?this.logUsage("userDismissedToast",{errorId:e}):this.logUsage("timeoutDismissedToast",{errorId:e}),(i=n)?[4,n()]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return(r=i)&&r.dismissToast(e),[2]}})})},t.prototype.getClassNames=function(){return A(this.props.toastLocation,this.props.styles)},t}(l.F)},10979:(e,t,n)=>{"use strict";n.d(t,{I:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{sessionId:this.session.id,groupId:this.session.groupId,itemId:String(this.session.itemId),itemSize:String(this.session.itemSize),taskId:this.updatedTaskDetails.id,updateKey:this.updateKey}}constructor(e,t,n){super(i.actionType),this.session=e,this.updatedTaskDetails=t,this.updateKey=n}}i.actionType="PLW_CREATE_UPLOAD_SESSION"},11079:(e,t,n)=>{"use strict";var r;function i(e,t){return 0!==(e&t)}n.d(t,{I:()=>r,L:()=>i}),function(e){e[e.DisableNone=0]="DisableNone",e[e.DisableUpdateAttachments=1]="DisableUpdateAttachments",e[e.DisableEditPublishedAttachments=2]="DisableEditPublishedAttachments",e[e.DisableAddAttachment=4]="DisableAddAttachment",e[e.DisableAll=7]="DisableAll"}(r||(r={}))},12396:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});var r=n(75992);class i extends r.r{constructor(){super(i.actionType)}}i.actionType="PLW_ENABLE_DIFFSYNC"},13374:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});var r=n(75992);class i extends r.r{isLoggingEnabled(){return!1}constructor(e,t){super(i.actionType),this.diffSyncFeed=e,this.timestamp=t}}i.actionType="PLW_GET_DIFFSYNCFEED_SUCCEEDED"},13736:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});var r=n(75992);class i extends r.r{isLoggingEnabled(){return!1}constructor(){super(i.actionType)}}i.actionType="PLW_DIFFSYNCFETCH_SCHEDULED"},14070:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{recentPlanCount:String(this.plans.length)}}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(i.actionType),this.userId=e,this.plans=t,this.isFirstPage=n}}i.actionType="PLW_GET_RECENTPLANSFORUSER_SUCCEEDED"},15434:(e,t,n)=>{"use strict";n.d(t,{x:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,e,t,n),this.containerId=r}}i.actionType="PLW_GET_CONTAINER_FAIL"},15765:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,t,n,r),this.bucketId=e}}i.actionType="PLW_DELETE_BUCKET_FAILED"},17920:(e,t,n)=>{"use strict";n.d(t,{f:()=>w});var r=n(27051),i=n(65043),s=n(51948),a=n(17066),o=n(13706),l=n(6618),c=n(16112),d=n(70768),u=n(66783),h=n(52195),p=n(25420),g="#ffffff",m=(0,u.J9)(function(e){var t={root:{fontSize:h.s.medium,display:"inline-flex",marginTop:"16px",padding:"14px 16px",minHeight:"48px",minWidth:"292px",maxWidth:"876px",alignItems:"center",backgroundColor:"#323130",color:g,borderRadius:"4px",boxShadow:"0 1.2px 3.6px 0 rgba(0, 0, 0, 0.11), 0 6.4px 14.4px 0 rgba(0, 0, 0, 0.13)",boxSizing:"border-box",overflow:"hidden"},content:{marginRight:"32px",display:"inline-flex",wordWrap:"break-word",wordBreak:"break-all",fontWeight:"300"},action:[(0,p.$Z)(),{marginRight:"16px",marginLeft:"auto",color:g,fontWeight:"500","> .action-link":{wordBreak:"break-all","> a":{cursor:"pointer",textDecoration:"none"}}}]};return(0,h.TW)(t,e)}),f=(0,u.J9)(function(e){var t=m(e);return{root:(0,h.Zq)("base-toast",t.root),content:(0,h.Zq)("base-toast-content",t.content),action:(0,h.Zq)("base-toast-action",t.action)}}),v=(0,u.J9)(function(e){var t={color:g,backgroundColor:"transparent"},n={root:[(0,p.$Z)(),t,{width:"auto",height:"auto",padding:"0",i:{margin:"0"}}],rootHovered:t,rootFocused:t,rootPressed:t};return(0,h.TW)(n,e)}),y=n(4648),k=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),T=function(){return T=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},T.apply(this,arguments)},S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onActionClick=function(){var e=t.props,n=e.onActionClick,r=e.onDismiss;n&&n(),r()},t}return k(t,e),t.prototype.name=function(){return"Toast"},t.prototype.renderComponent=function(){var e=this.props,t=e.className,n=e.mainContent,r=e.ariaAlertMessage,c=e.actionText,u=e.dismissIconProps,h=e.onDismiss,p=this.getClassNames(),g=(0,a.G1)(this.props,a.JM),m=window.navigator.userAgent.indexOf("Edg/")>-1;return i.createElement("div",T({},g,{className:(0,y.A)(p.root,t)}),i.createElement("div",{className:p.content},n),i.createElement("div",{className:p.action,style:{visibility:c?"visible":"hidden"}},i.createElement("span",{className:"action-link"},i.createElement("a",{onClick:this.onActionClick},c))),i.createElement(o.K,{className:"base-toast-dismiss",styles:this.getbuttonStyles(),iconProps:null!==u&&void 0!==u?u:{iconName:s.F.Cancel},onClick:h}),i.createElement(d.E,null,i.createElement("div",{role:"alert","aria-live":"assertive"},r)),!m&&i.createElement(l.e,{message:r}))},t.prototype.getClassNames=function(){return f(this.props.styles)},t.prototype.getbuttonStyles=function(){return v(this.props.buttonStyles)},t}(c.$),b=n(56415),I=n(77508);const C=(0,u.J9)(e=>{let t=b.z.ThemeTertiary;switch(e){case I.Sx.Light:t=b.z.ThemeLighter;break;case I.Sx.Dark:t=b.z.ThemePrimary;break;case I.Sx.TeamsLight:t=b.z.TeamsDarkPurple;break;case I.Sx.TeamsDark:t=b.z.TeamsPurple;break;case I.Sx.TeamsContrast:t=b.z.TeamsContrastHyperlinkColor;break;case I.Sx.SharePoint:t=b.z.SharepointBackgroundColor()}return{color:t}}),D=(0,u.J9)(e=>({root:[{a:C(e)},(e===I.Sx.Dark||e===I.Sx.TeamsDark)&&{backgroundColor:b.z.White,color:b.z.Black},e===I.Sx.TeamsContrast&&{backgroundColor:b.z.Black,color:b.z.White,border:"1px solid ".concat(b.z.White)},e===I.Sx.SharePoint&&{backgroundColor:b.z.SharepointTitleFontColor(),color:b.z.SharepointBackgroundColor()}]})),E=(0,u.J9)(e=>({root:[(e===I.Sx.Dark||e===I.Sx.TeamsDark)&&{color:b.z.Black},e===I.Sx.TeamsContrast&&{color:b.z.White},e===I.Sx.SharePoint&&{color:b.z.SharepointBackgroundColor()}],rootHovered:[e===I.Sx.SharePoint&&{backgroundColor:b.z.SharepointTitleFontColor()}]}));var P=n(59846);const w=e=>{var t,n;const{toastType:s,onDismiss:a,data:o,theme:l,toastTypeWhitelist:c}=e;if(-1===c.indexOf(s))return null;const d=null!==(t=o.styles)&&void 0!==t?t:D(l),u=null!==(n=o.buttonStyles)&&void 0!==n?n:E(l);return i.createElement(S,(0,r.A)((0,r.A)({},o),{},{styles:d,buttonStyles:u,onDismiss:a,dismissIconProps:P.s5}))}},17942:(e,t,n)=>{"use strict";n.d(t,{V:()=>d,x:()=>c});var r=n(27051),i=n(66783),s=n(52195),a=n(66151),o=n(70596),l=n(65006);const c=(0,i.J9)(e=>(0,s.Zq)("loopApp",[(0,a.gS)("column"),o.gK,l.Lx,{border:"0",width:"100%",height:"100%",position:"absolute",lineHeight:"normal",a:(0,a.BP)(e),"> .errorBar":(0,r.A)({},(0,o.ZG)("& > .errorBar")),"> .appContent":[(0,a.gS)("row"),(0,a.GD)(),{"> *:nth-child(1)":[(0,a.gS)(),(0,a.GD)()]}],".plannerIcon":(0,a.gS)(),"*, :global(.plannerAppDialog *, .plannerAppCallout *)":(0,a.Ss)(e)}])),d={content:[l.Lx,{lineHeight:"normal",".plannerIcon":(0,a.gS)(),".editor-container i":{fontStyle:"italic"}}]}},19285:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});var r=n(25324);class i extends r.l{constructor(e,t,n,r,s,a,o){super(i.actionType,e,t,n,r,s,a,o)}}i.actionType="SHOW_ERROR_NOTIFICATION"},19864:(e,t,n)=>{"use strict";function r(e){return"planner-main-content-".concat(e)}function i(e){return"planner-loop-container-".concat(e)}n.d(t,{cL:()=>r,xZ:()=>i})},19879:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});var r=n(75992);class i extends r.r{constructor(e,t){super(i.actionType),this.groupId=e,this.sensitivityLabelId=t}}i.actionType="PLW_GET_UNIFIEDGROUPSENSITIVITYLABEL_SUCCEEDED"},20977:(e,t,n)=>{var r=n(9096),i=n(64416);e.exports=function(e,t){return e&&e.length?i(e,r(t,2)):[]}},21721:(e,t,n)=>{"use strict";n.d(t,{c:()=>s});var r=n(27051),i=n(32512);class s extends i.v{loggingData(){return(0,r.A)((0,r.A)({},super.loggingData()),{},{groupId:this.groupId})}constructor(e,t,n,r){super(s.actionType,t,n,r),this.groupId=e}}s.actionType="GET_GROUP_DOCUMENTS_IN_FOLDER_FAILURE"},21845:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});var r=n(75992);class i extends r.r{constructor(){super(i.actionType)}}i.actionType="CLEAR_NOTIFICATIONS"},23614:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});var r=n(75992);class i extends r.r{constructor(e,t,n){super(i.actionType),this.viewId=e,this.columnId=t,this.columnWidth=n}}i.actionType="PLW_SET_GRID_COLUMN_WIDTH"},23821:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.bucket.id,updateKey:this.updateKey}}constructor(e,t){super(i.actionType),this.bucket=e,this.updateKey=t}}i.actionType="PLW_UPDATE_BUCKET_SUCCEEDED"},23881:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var r=n(75992);class i extends r.r{isLoggingEnabled(){return!1}constructor(e){super(i.actionType),this.diffSyncToken=e}}i.actionType="PLW_GET_DIFFSYNCTOKEN_SUCCEEDED"},24322:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{planCount:String(this.plans.length)}}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(i.actionType),this.plans=e,this.isFirstPage=t}}i.actionType="PLW_GET_ROSTERPLANS_FOR_USER_SUCCEEDED"},25744:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.bucketId}}constructor(e){super(i.actionType),this.bucketId=e}}i.actionType="PLW_DELETE_BUCKET"},26260:(e,t,n)=>{"use strict";n.d(t,{R:()=>l});var r=n(33183),i=n(21382),s=n(54320),a=n.n(s),o=n(86053);class l extends r.M{name(){return"NotificationToast"}constructor(e,t,n){let s=o.p.Strings[e];a()(t)||(s=i.G(s,...t));const c=n?s+", "+n:s;super(l.type,{className:"",toastDataType:r.M.toastDataType,mainContent:c,ariaAlertMessage:c,onDismiss:()=>{}})}}l.type="NOTIFICATION_TOAST"},26410:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{sessionId:this.session.id,groupId:this.session.groupId,itemId:String(this.session.itemId),itemSize:String(this.session.itemSize),bytesSent:String(this.session.bytesSent),expirationTime:null!=this.session.expirationDateTime?this.session.expirationDateTime.toString():"null",updateKey:this.updateKey}}constructor(e,t){super(i.actionType),this.session=e,this.updateKey=t}}i.actionType="PLW_CREATE_UPLOAD_SESSION_SUCCEEDED"},26715:(e,t,n)=>{"use strict";n.d(t,{m:()=>i});var r=n(75992);class i extends r.r{constructor(e,t){super(i.actionType),this.viewId=e,this.sortCriteria=t}}i.actionType="PLW_SET_SORT_CRITERIA"},28242:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r,s){super(i.actionType,n,r,s),this.originalPlanEntitySet=e,this.updateKey=t}}i.actionType="PLW_UPDATE_PLANENTITYSET_FAILED"},30263:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});var r=n(75992);class i extends r.r{constructor(e,t,n){super(i.actionType),this.entityId=e,this.query=t,this.results=n}}i.actionType="AUGLOOP_FETCH_IMG_RECS_SUCCEEDED"},30450:(e,t,n)=>{var r=n(80755),i=n(55647),s=n(64416),a=n(76272),o=i(function(e){return s(r(e,1,a,!0))});e.exports=o},31158:e=>{function t(e,t){if((e=e.replace(/\s+/g,""))===(t=t.replace(/\s+/g,"")))return 1;if(e.length<2||t.length<2)return 0;let n=new Map;for(let i=0;i<e.length-1;i++){const t=e.substring(i,i+2),r=n.has(t)?n.get(t)+1:1;n.set(t,r)}let r=0;for(let i=0;i<t.length-1;i++){const e=t.substring(i,i+2),s=n.has(e)?n.get(e):0;s>0&&(n.set(e,s-1),r++)}return 2*r/(e.length+t.length-2)}e.exports={compareTwoStrings:t,findBestMatch:function(e,n){if(!function(e,t){return"string"===typeof e&&(!!Array.isArray(t)&&(!!t.length&&!t.find(function(e){return"string"!==typeof e})))}(e,n))throw new Error("Bad arguments: First argument should be a string, second should be an array of strings");const r=[];let i=0;for(let a=0;a<n.length;a++){const s=n[a],o=t(e,s);r.push({target:s,rating:o}),o>r[i].rating&&(i=a)}const s=r[i];return{ratings:r,bestMatch:s,bestMatchIndex:i}}}},31415:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{operationId:this.operationId,ownerId:this.planOwner,clientOperationId:this.clientOperationId}}constructor(e,t,n){super(i.actionType),this.operationId=e,this.planOwner=t,this.clientOperationId=n}}i.actionType="PLW_COPY_PLAN_SUCCEEDED"},33414:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n){super(i.actionType,e,t,n)}}i.actionType="PLW_GET_SENSITIVITYLABELS_FAILED"},34631:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});var r=n(75992);class i extends r.r{loggingData(){var e,t,n,r,i,s;return{id:null!==(e=null!==(t=null!==(n=null===(r=this.updatedFormats.assignmentBoardFormat)||void 0===r?void 0:r.id)&&void 0!==n?n:null===(i=this.updatedFormats.bucketBoardFormat)||void 0===i?void 0:i.id)&&void 0!==t?t:null===(s=this.updatedFormats.progressBoardFormat)||void 0===s?void 0:s.id)&&void 0!==e?e:""}}constructor(e,t){super(i.actionType),this.originalFormats=e,this.updatedFormats=t}}i.actionType="PLW_DIFFSYNC_UPDATE_TASK_FORMAT"},35525:(e,t,n)=>{"use strict";var r,i,s,a;n.d(t,{uU:()=>a,xJ:()=>r}),function(e){e.PercentComplete="percentComplete",e.Assignments="assignments",e.Title="title",e.Bucket="bucketId",e.StartDate="startDate",e.DueDate="dueDate",e.Priority="priority",e.MarkTaskAsCompleteColumnName="markTaskAsComplete",e.AddColumnColumnName="addColumn",e.Plan="plan",e.Labels="labels"}(r||(r={})),function(e){e.HeaderHeight=40,e.RowHeaderWidth=32,e.RowHeight=40,e.AddColumnWidth=164,e.MarkTaskAsCompleteColumnWidth=40,e.DefaultColumnWidth=144,e.AssignedToColumnWidth=180,e.PlanColumnWidth=180,e.TitleColumnWidth=378,e.UndefinedColumnWidth=0,e.LabelsColumnWidth=200}(i||(i={})),function(e){e.DefaultCellValue="",e.ToggleTaskCompletionColumnLeftPadding="0px",e.ToggleTaskCompletionColumnRightPadding="0px",e.ToggleTaskCompletionColumnTopPadding="13px",e.ToggleTaskCompletionColumnBottomPadding="11px"}(s||(s={})),function(e){e.AddToMyDay="addToMyDay",e.RemoveFromMyDay="removeFromMyDay",e.TaskDetails="taskDetails",e.CopyLinkToTask="copyLinkToTask",e.DeleteTask="deleteTask",e.MarkTaskAsComplete="markTaskAsComplete",e.ReactivateTask="markTaskAsIncomplete"}(a||(a={}))},35879:(e,t,n)=>{"use strict";n.d(t,{U:()=>i});var r=n(75992);class i extends r.r{constructor(e,t){super(i.actionType),this.updatedLocalPlanEntitySet=e,this.updateKey=t}}i.actionType="PLW_UPDATE_PLANENTITYSET"},37535:(e,t,n)=>{"use strict";var r;n.d(t,{P:()=>r}),function(e){e[e.Conversations=0]="Conversations",e[e.Calendar=1]="Calendar",e[e.People=2]="People",e[e.Documents=3]="Documents",e[e.Notebook=4]="Notebook",e[e.Yammer=5]="Yammer"}(r||(r={}))},38227:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.bucketId}}constructor(e){super(i.actionType),this.bucketId=e}}i.actionType="PLW_DELETE_BUCKET_SUCCEEDED"},39202:(e,t,n)=>{"use strict";n.d(t,{K:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.sensitivityLabels=e}}i.actionType="PLW_GET_SENSITIVITYLABELS_SUCCEEDED"},40655:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var r=n(65818),i=n(75992);class s extends i.r{loggingData(){return{containerType:String(r.K),idCount:String(this.containers.length)}}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(s.actionType),this.containerType=e,this.containers=t,this.isFirstPage=n}}s.actionType="PLW_GET_IDSFORCONTAINERTYPE_SUCCEEDED"},40729:(e,t,n)=>{"use strict";n.d(t,{d:()=>r});var r,i=n(74844),s=n(56415),a=n(77508),o=n(79537);!function(e){function t(e){let t="theme-";switch(e){case a.Sx.Dark:t+="dark";break;case a.Sx.TeamsDark:t+="teamsdark";break;case a.Sx.TeamsLight:t+="teamslight";break;case a.Sx.TeamsContrast:t+="teamscontrast";break;case a.Sx.SharePoint:t+="sharepoint";break;case a.Sx.LoopLight:t+="looplight";break;case a.Sx.LoopDark:t+="loopdark";break;default:case a.Sx.Light:t+="light"}return t}function n(e){Object.keys(a.Sx).map(e=>a.Sx[e]).forEach(n=>{const r=t(n);e.classList.remove(r)})}function r(){if(null!=window.matchMedia){return window.matchMedia("(-ms-high-contrast: white-on-black)").matches}return!1}e.parseThemeClassname=t,e.removeAllThemeClassNames=n,e.applyTheme=function(e,r){const i=t(r);e.classList.contains(i)||(n(e),e.classList.toggle(i,!0))},e.getChartBorderColorForTheme=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return s.z.White;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return s.z.TeamsDark_Background;case a.Sx.TeamsContrast:return s.z.Black;case a.Sx.SharePoint:return s.z.SharepointBGColorForNonProcessableStyles();default:return o.f.unreachableCase(e,e=>{t.logTrace(507778460,i.k.Warning,e)}),s.z.White}},e.getChartFontColorForTheme=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return r()?s.z.White:s.z.Black;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:case a.Sx.TeamsContrast:return s.z.White;case a.Sx.SharePoint:return r()?s.z.White:s.z.SharepointTextColorForNonProcessableStyles();default:return o.f.unreachableCase(e,e=>{t.logTrace(507778459,i.k.Warning,e)}),s.z.Black}},e.getChartGridColorForTheme=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return s.z.NeutralTertiaryAlt;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return s.z.TeamsDark_NeutralPrimary;case a.Sx.TeamsContrast:return s.z.White;case a.Sx.SharePoint:return s.z.SharepointTextColorForNonProcessableStyles();default:return o.f.unreachableCase(e,e=>{t.logTrace(507778458,i.k.Warning,e)}),s.z.NeutralTertiaryAlt}},e.getChartTooltipBgColorForTheme=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return r()?s.z.Black:"rgba(255, 255, 255, 0.8)";case a.Sx.SharePoint:return r()?s.z.Black:s.z.SharepointBGColorForNonProcessableStyles();case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return"rgba(0, 0, 0, 0.8)";case a.Sx.TeamsContrast:return s.z.Black;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778457,i.k.Warning,e)}),"rgba(255, 255, 255, 0.8)"}},e.getMeetingNotesColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return s.z.MeetingNotesColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return s.z.MeetingNotesColorDark;case a.Sx.TeamsContrast:return s.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778456,i.k.Warning,e)}),s.z.MeetingNotesColorLight}},e.getLoopColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:return s.z.NeutralLightGrey26;case a.Sx.Dark:case a.Sx.TeamsDark:return s.z.LoopBrand100;case a.Sx.TeamsContrast:return s.z.HighContrastYellow;case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return s.z.NeutralLightGrey14;case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return s.z.White;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778455,i.k.Warning,e)}),s.z.LoopLightP0}},e.getWordColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return s.z.WordColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return s.z.WordColorDark;case a.Sx.TeamsContrast:return s.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778454,i.k.Warning,e)}),s.z.WordColorLight}},e.getExcelColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return s.z.ExcelColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return s.z.ExcelColorDark;case a.Sx.TeamsContrast:return s.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778453,i.k.Warning,e)}),s.z.ExcelColorLight}},e.getPowerPointColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return s.z.PowerPointColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return s.z.PowerPointColorDark;case a.Sx.TeamsContrast:return s.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778452,i.k.Warning,e)}),s.z.PowerPointColorLight}},e.getProjectColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return s.z.ProjectColorLight;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return s.z.ProjectColorDark;case a.Sx.TeamsContrast:return s.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778451,i.k.Warning,e)}),s.z.ProjectColorLight}},e.getTeamsMessageColor=function(e,t){switch(e){case a.Sx.Light:case a.Sx.TeamsLight:case a.Sx.SharePoint:case a.Sx.LoopLight:case a.Sx.LoopWorkspaceLight:return s.z.TeamsAppBrand00;case a.Sx.Dark:case a.Sx.TeamsDark:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceDark:return s.z.TeamsMessageDarkColor;case a.Sx.TeamsContrast:return s.z.HighContrastYellow;default:return o.f.unreachableCase(e,e=>{t.logTrace(507778450,i.k.Warning,e)}),s.z.TeamsAppBrand00}},e.isWindowsHighContrastWhiteOnBlack=r,e.isWindowsHighContrast=function(){if(null!=window.matchMedia){return window.matchMedia("(-ms-high-contrast)").matches}return!1},e.isLoopTheme=function(e){switch(e){case a.Sx.LoopLight:case a.Sx.LoopDark:case a.Sx.LoopWorkspaceLight:case a.Sx.LoopWorkspaceDark:return!0;default:return!1}}}(r||(r={}))},41927:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});var r=n(75992);class i extends r.r{loggingData(){var e,t,n,r,i,s;return{id:null!==(e=null!==(t=null!==(n=null===(r=this.taskFormats.assignmentBoardFormat)||void 0===r?void 0:r.id)&&void 0!==n?n:null===(i=this.taskFormats.bucketBoardFormat)||void 0===i?void 0:i.id)&&void 0!==t?t:null===(s=this.taskFormats.progressBoardFormat)||void 0===s?void 0:s.id)&&void 0!==e?e:""}}constructor(e){super(i.actionType),this.taskFormats=e}}i.actionType="PLW_DIFFSYNC_INSERT_TASK_FORMAT"},42045:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.planEntitySet.id}}constructor(e){super(i.actionType),this.planEntitySet=e}}i.actionType="PLW_DIFFSYNC_UPDATE_PLAN"},42463:(e,t,n)=>{"use strict";var r;n.d(t,{H:()=>r}),function(e){e[e.info=0]="info",e[e.error=1]="error",e[e.blocked=2]="blocked",e[e.severeWarning=3]="severeWarning",e[e.success=4]="success",e[e.warning=5]="warning"}(r||(r={}))},42870:(e,t,n)=>{"use strict";n.d(t,{M:()=>s});var r=n(937),i=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.fetchCriticalData(this.props,this.state)},t.prototype.componentDidUpdate=function(e,t){this.fetchCriticalDataWhenComponentDidUpdate(e,t)&&this.fetchCriticalData(this.props,this.state),this.fetchNonCriticalDataWhenComponentDidUpdate(e,t)&&this.checkForCriticalDataReady()&&this.fetchNonCriticalData(this.props,this.state)},t.prototype.fetchCriticalDataWhenComponentDidUpdate=function(e,t){return!1},t.prototype.fetchNonCriticalDataWhenComponentDidUpdate=function(e,t){return!1},t}(r.F)},43068:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.tenantGroupSettings=e}}i.actionType="PLW_GET_TENANTGROUPSETTINGS_SUCCEEDED"},43841:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.updatedTaskDetails.id}}constructor(e,t){super(i.actionType),this.originalTaskDetails=e,this.updatedTaskDetails=t}}i.actionType="PLW_DIFFSYNC_UPDATE_TASK_DETAILS"},44227:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.container=e}}i.actionType="PLW_CREATE_ROSTER_CONTAINER_SUCCESS"},44430:(e,t,n)=>{"use strict";var r;n.d(t,{N:()=>r}),function(e){e[e.NonMember=0]="NonMember",e[e.Member=1]="Member",e[e.Owner=2]="Owner"}(r||(r={}))},45100:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{groupId:this.groupId}}constructor(e,t,n){super(i.actionType),this.groupId=e,this.itemUrl=t,this.thumbnail=n}}i.actionType="PLW_GET_DRIVE_ITEM_THUMBNAIL_SUCCEEDED"},45679:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});var r=n(25324);class i extends r.l{constructor(e,t,n,r,s,a,o){super(i.actionType,e,t,n,r,s,a,o)}}i.actionType="SHOW_WARNING_NOTIFICATION"},45698:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.bucketId}}constructor(e){super(i.actionType),this.bucketId=e}}i.actionType="PLW_DIFFSYNC_DELETE_BUCKET"},46219:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r,s){super(i.actionType,n,r,s),this.bucket=e,this.updateKey=t}}i.actionType="PLW_UPDATE_BUCKET_FAILED"},47572:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.bucket.id}}constructor(e){super(i.actionType),this.bucket=e}}i.actionType="PLW_DIFFSYNC_UPDATE_BUCKET"},47649:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var r=n(72799);class i{static create(){return new r.j(void 0,e=>{throw e})}}},48148:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.bucket.id}}constructor(e){super(i.actionType),this.bucket=e}}i.actionType="PLW_DIFFSYNC_INSERT_BUCKET"},48170:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.sensitivityPolicySettings=e}}i.actionType="PLW_GET_SENSITIVITYPOLICYSETTINGS_SUCCEEDED"},48496:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,e,t,n),this.sessionId=r}}i.actionType="PLW_CANCEL_UPLOAD_SESSION_FAILED"},48545:(e,t,n)=>{"use strict";n.d(t,{B:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r,s){super(i.actionType,n,r,s),this.entityId=e,this.query=t}}i.actionType="AUGLOOP_FETCH_IMG_RECS_FAILED"},48924:(e,t,n)=>{"use strict";n.d(t,{y:()=>Ln});var r={};n.r(r),n.d(r,{FILE:()=>tt,HTML:()=>it,TEXT:()=>rt,URL:()=>nt});var i={};n.r(i),n.d(i,{FILE:()=>nn,HTML:()=>an,TEXT:()=>sn,URL:()=>rn});var s=n(27051),a=n(65043),o=n(38752),l=n(45795),c=n(70579),d=n(84945),u="dnd-core/INIT_COORDS",h="dnd-core/BEGIN_DRAG",p="dnd-core/PUBLISH_DRAG_SOURCE",g="dnd-core/HOVER",m="dnd-core/DROP",f="dnd-core/END_DRAG";function v(e,t){return{type:u,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}function y(e){return y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function k(e){return"object"===y(e)}var T={type:u,payload:{clientOffset:null,sourceClientOffset:null}};function S(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{publishSource:!0},r=n.publishSource,i=void 0===r||r,s=n.clientOffset,a=n.getSourceClientOffset,o=e.getMonitor(),l=e.getRegistry();e.dispatch(v(s)),function(e,t,n){(0,d.V)(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(e){(0,d.V)(n.getSource(e),"Expected sourceIds to be registered.")})}(t,o,l);var c=function(e,t){for(var n=null,r=e.length-1;r>=0;r--)if(t.canDragSource(e[r])){n=e[r];break}return n}(t,o);if(null!==c){var u=null;if(s){if(!a)throw new Error("getSourceClientOffset must be defined");!function(e){(0,d.V)("function"===typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(a),u=a(c)}e.dispatch(v(s,u));var p=l.getSource(c).beginDrag(o,c);if(null!=p){!function(e){(0,d.V)(k(e),"Item must be an object.")}(p),l.pinSource(c);var g=l.getSourceType(c);return{type:h,payload:{itemType:g,item:p,sourceId:c,clientOffset:s||null,sourceClientOffset:u||null,isSourcePublic:!!i}}}}else e.dispatch(T)}}function b(e){return function(){if(e.getMonitor().isDragging())return{type:p}}}function I(e,t){return null===t?null===e:Array.isArray(e)?e.some(function(e){return e===t}):e===t}function C(e){return function(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).clientOffset;!function(e){(0,d.V)(Array.isArray(e),"Expected targetIds to be an array.")}(t);var r=t.slice(0),i=e.getMonitor(),s=e.getRegistry();return function(e,t,n){(0,d.V)(t.isDragging(),"Cannot call hover while not dragging."),(0,d.V)(!t.didDrop(),"Cannot call hover after drop.");for(var r=0;r<e.length;r++){var i=e[r];(0,d.V)(e.lastIndexOf(i)===r,"Expected targetIds to be unique in the passed array.");var s=n.getTarget(i);(0,d.V)(s,"Expected targetIds to be registered.")}}(r,i,s),function(e,t,n){for(var r=e.length-1;r>=0;r--){var i=e[r];I(t.getTargetType(i),n)||e.splice(r,1)}}(r,s,i.getItemType()),function(e,t,n){e.forEach(function(e){n.getTarget(e).hover(t,e)})}(r,i,s),{type:g,payload:{targetIds:r,clientOffset:n||null}}}}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(t){P(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.getMonitor(),r=e.getRegistry();!function(e){(0,d.V)(e.isDragging(),"Cannot call drop while not dragging."),(0,d.V)(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(n);var i=function(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(n);i.forEach(function(i,s){var a=function(e,t,n,r){var i=n.getTarget(e),s=i?i.drop(r,e):void 0;(function(e){(0,d.V)("undefined"===typeof e||k(e),"Drop result must either be an object or undefined.")})(s),"undefined"===typeof s&&(s=0===t?{}:r.getDropResult());return s}(i,s,r,n),o={type:m,payload:{dropResult:E(E({},t),a)}};e.dispatch(o)})}}function x(e){return function(){var t=e.getMonitor(),n=e.getRegistry();!function(e){(0,d.V)(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);var r=t.getSourceId();null!=r&&(n.getSource(r,!0).endDrag(t,r),n.unpinSource());return{type:f}}}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),F(this,"store",void 0),F(this,"monitor",void 0),F(this,"backend",void 0),F(this,"isSetUp",!1),F(this,"handleRefCountChange",function(){var e=r.store.getState().refCount>0;r.backend&&(e&&!r.isSetUp?(r.backend.setup(),r.isSetUp=!0):!e&&r.isSetUp&&(r.backend.teardown(),r.isSetUp=!1))}),this.store=t,this.monitor=n,t.subscribe(this.handleRefCountChange)}var t,n,r;return t=e,n=[{key:"receiveBackend",value:function(e){this.backend=e}},{key:"getMonitor",value:function(){return this.monitor}},{key:"getBackend",value:function(){return this.backend}},{key:"getRegistry",value:function(){return this.monitor.registry}},{key:"getActions",value:function(){var e=this,t=this.store.dispatch,n=function(e){return{beginDrag:S(e),publishDragSource:b(e),hover:C(e),drop:w(e),endDrag:x(e)}}(this);return Object.keys(n).reduce(function(r,i){var s,a=n[i];return r[i]=(s=a,function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=s.apply(e,r);"undefined"!==typeof a&&t(a)}),r},{})}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}],n&&A(t.prototype,n),r&&A(t,r),e}();function _(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var U="function"===typeof Symbol&&Symbol.observable||"@@observable",O=function(){return Math.random().toString(36).substring(7).split("").join(".")},B={INIT:"@@redux/INIT"+O(),REPLACE:"@@redux/REPLACE"+O(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+O()}};function M(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function N(e,t,n){var r;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(_(0));if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(_(1));return n(N)(e,t)}if("function"!==typeof e)throw new Error(_(2));var i=e,s=t,a=[],o=a,l=!1;function c(){o===a&&(o=a.slice())}function d(){if(l)throw new Error(_(3));return s}function u(e){if("function"!==typeof e)throw new Error(_(4));if(l)throw new Error(_(5));var t=!0;return c(),o.push(e),function(){if(t){if(l)throw new Error(_(6));t=!1,c();var n=o.indexOf(e);o.splice(n,1),a=null}}}function h(e){if(!M(e))throw new Error(_(7));if("undefined"===typeof e.type)throw new Error(_(8));if(l)throw new Error(_(9));try{l=!0,s=i(s,e)}finally{l=!1}for(var t=a=o,n=0;n<t.length;n++){(0,t[n])()}return e}return h({type:B.INIT}),(r={dispatch:h,subscribe:u,getState:d,replaceReducer:function(e){if("function"!==typeof e)throw new Error(_(10));i=e,h({type:B.REPLACE})}})[U]=function(){var e,t=u;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new Error(_(11));function n(){e.next&&e.next(d())}return n(),{unsubscribe:t(n)}}})[U]=function(){return this},e},r}var R=function(e,t){return e===t};function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach(function(t){z(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function K(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,r=arguments.length>1?arguments[1]:void 0,i=r.payload;switch(r.type){case u:case h:return{initialSourceClientOffset:i.sourceClientOffset,initialClientOffset:i.clientOffset,clientOffset:i.clientOffset};case g:return e=n.clientOffset,t=i.clientOffset,!e&&!t||e&&t&&e.x===t.x&&e.y===t.y?n:W(W({},n),{},{clientOffset:i.clientOffset});case f:case m:return j;default:return n}}var H="dnd-core/ADD_SOURCE",V="dnd-core/ADD_TARGET",Z="dnd-core/REMOVE_SOURCE",q="dnd-core/REMOVE_TARGET";function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach(function(t){X(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function X(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var $={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function Q(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,r=arguments.length>1?arguments[1]:void 0,i=r.payload;switch(r.type){case h:return J(J({},n),{},{itemType:i.itemType,item:i.item,sourceId:i.sourceId,isSourcePublic:i.isSourcePublic,dropResult:null,didDrop:!1});case p:return J(J({},n),{},{isSourcePublic:!0});case g:return J(J({},n),{},{targetIds:i.targetIds});case q:return-1===n.targetIds.indexOf(i.targetId)?n:J(J({},n),{},{targetIds:(e=n.targetIds,t=i.targetId,e.filter(function(e){return e!==t}))});case m:return J(J({},n),{},{dropResult:i.dropResult,didDrop:!0,targetIds:[]});case f:return J(J({},n),{},{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return n}}function ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;switch((arguments.length>1?arguments[1]:void 0).type){case H:case V:return e+1;case Z:case q:return e-1;default:return e}}var te=[],ne=[];function re(){var e=arguments.length>1?arguments[1]:void 0;switch(e.type){case g:break;case H:case V:case q:case Z:return te;default:return ne}var t=e.payload,n=t.targetIds,r=void 0===n?[]:n,i=t.prevTargetIds,s=void 0===i?[]:i,a=function(e,t){var n=new Map,r=function(e){n.set(e,n.has(e)?n.get(e)+1:1)};e.forEach(r),t.forEach(r);var i=[];return n.forEach(function(e,t){1===e&&i.push(t)}),i}(r,s),o=a.length>0||!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R;if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}(r,s);if(!o)return te;var l=s[s.length-1],c=r[r.length-1];return l!==c&&(l&&a.push(l),c&&a.push(c)),a}function ie(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0)+1}function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach(function(t){oe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function le(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;return{dirtyHandlerIds:re(r.dirtyHandlerIds,{type:i.type,payload:ae(ae({},i.payload),{},{prevTargetIds:(e=r,t="dragOperation.targetIds",n=[],t.split(".").reduce(function(e,t){return e&&e[t]?e[t]:n||null},e))})}),dragOffset:K(r.dragOffset,i),refCount:ee(r.refCount,i),dragOperation:Q(r.dragOperation,i),stateId:ie(r.stateId)}}function ce(e,t){return{x:e.x-t.x,y:e.y-t.y}}function de(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ue(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}te.__IS_NONE__=!0,ne.__IS_ALL__=!0;var he,pe=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ue(this,"store",void 0),ue(this,"registry",void 0),this.store=t,this.registry=n}var t,n,r;return t=e,n=[{key:"subscribeToStateChange",value:function(e){var t=this,n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{handlerIds:void 0}).handlerIds;(0,d.V)("function"===typeof e,"listener must be a function."),(0,d.V)("undefined"===typeof n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");var r=this.store.getState().stateId;return this.store.subscribe(function(){var i=t.store.getState(),s=i.stateId;try{var a=s===r||s===r+1&&!function(e,t){return e!==te&&(e===ne||"undefined"===typeof t||(n=e,t.filter(function(e){return n.indexOf(e)>-1})).length>0);var n}(i.dirtyHandlerIds,n);a||e()}finally{r=s}})}},{key:"subscribeToOffsetChange",value:function(e){var t=this;(0,d.V)("function"===typeof e,"listener must be a function.");var n=this.store.getState().dragOffset;return this.store.subscribe(function(){var r=t.store.getState().dragOffset;r!==n&&(n=r,e())})}},{key:"canDragSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e);return(0,d.V)(t,"Expected to find a valid source. sourceId=".concat(e)),!this.isDragging()&&t.canDrag(this,e)}},{key:"canDropOnTarget",value:function(e){if(!e)return!1;var t=this.registry.getTarget(e);return(0,d.V)(t,"Expected to find a valid target. targetId=".concat(e)),!(!this.isDragging()||this.didDrop())&&I(this.registry.getTargetType(e),this.getItemType())&&t.canDrop(this,e)}},{key:"isDragging",value:function(){return Boolean(this.getItemType())}},{key:"isDraggingSource",value:function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return(0,d.V)(t,"Expected to find a valid source. sourceId=".concat(e)),!(!this.isDragging()||!this.isSourcePublic())&&this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e)}},{key:"isOverTarget",value:function(e){if(!e)return!1;var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shallow:!1}).shallow;if(!this.isDragging())return!1;var n=this.registry.getTargetType(e),r=this.getItemType();if(r&&!I(n,r))return!1;var i=this.getTargetIds();if(!i.length)return!1;var s=i.indexOf(e);return t?s===i.length-1:s>-1}},{key:"getItemType",value:function(){return this.store.getState().dragOperation.itemType}},{key:"getItem",value:function(){return this.store.getState().dragOperation.item}},{key:"getSourceId",value:function(){return this.store.getState().dragOperation.sourceId}},{key:"getTargetIds",value:function(){return this.store.getState().dragOperation.targetIds}},{key:"getDropResult",value:function(){return this.store.getState().dragOperation.dropResult}},{key:"didDrop",value:function(){return this.store.getState().dragOperation.didDrop}},{key:"isSourcePublic",value:function(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}},{key:"getInitialClientOffset",value:function(){return this.store.getState().dragOffset.initialClientOffset}},{key:"getInitialSourceClientOffset",value:function(){return this.store.getState().dragOffset.initialSourceClientOffset}},{key:"getClientOffset",value:function(){return this.store.getState().dragOffset.clientOffset}},{key:"getSourceClientOffset",value:function(){return function(e){var t,n,r=e.clientOffset,i=e.initialClientOffset,s=e.initialSourceClientOffset;return r&&i&&s?ce((n=s,{x:(t=r).x+n.x,y:t.y+n.y}),i):null}(this.store.getState().dragOffset)}},{key:"getDifferenceFromInitialOffset",value:function(){return function(e){var t=e.clientOffset,n=e.initialClientOffset;return t&&n?ce(t,n):null}(this.store.getState().dragOffset)}}],n&&de(t.prototype,n),r&&de(t,r),e}(),ge=0;function me(e){return me="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function fe(e,t){t&&Array.isArray(e)?e.forEach(function(e){return fe(e,!1)}):(0,d.V)("string"===typeof e||"symbol"===me(e),t?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}!function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(he||(he={}));const ve="undefined"!==typeof n.g?n.g:self,ye=ve.MutationObserver||ve.WebKitMutationObserver;function ke(e){return function(){const t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}const Te="function"===typeof ye?function(e){let t=1;const n=new ye(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}}:ke;class Se{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,t){this.onError=e,this.release=t,this.task=null}}const be=new class{enqueueTask(e){const{queue:t,requestFlush:n}=this;t.length||(n(),this.flushing=!0),t[t.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const t=this.index;if(this.index++,e[t].call(),this.index>this.capacity){for(let t=0,n=e.length-this.index;t<n;t++)e[t]=e[t+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=Te(this.flush),this.requestErrorThrow=ke(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}},Ie=new class{create(e){const t=this.freeTasks,n=t.length?t.pop():new Se(this.onError,e=>t[t.length]=e);return n.task=e,n}constructor(e){this.onError=e,this.freeTasks=[]}}(be.registerPendingError);function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function De(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,s=[],a=!0,o=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(s.push(r.value),!t||s.length!==t);a=!0);}catch(l){o=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(o)throw i}}return s}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pe(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function we(e){var t=(ge++).toString();switch(e){case he.SOURCE:return"S".concat(t);case he.TARGET:return"T".concat(t);default:throw new Error("Unknown Handler Role: ".concat(e))}}function xe(e){switch(e[0]){case"S":return he.SOURCE;case"T":return he.TARGET;default:(0,d.V)(!1,"Cannot parse handler ID: ".concat(e))}}function Ae(e,t){var n=e.entries(),r=!1;do{var i=n.next(),s=i.done;if(Ee(i.value,2)[1]===t)return!0;r=!!s}while(!r);return!1}var Fe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),De(this,"types",new Map),De(this,"dragSources",new Map),De(this,"dropTargets",new Map),De(this,"pinnedSourceId",null),De(this,"pinnedSource",null),De(this,"store",void 0),this.store=t}var t,n,r;return t=e,n=[{key:"addSource",value:function(e,t){fe(e),function(e){(0,d.V)("function"===typeof e.canDrag,"Expected canDrag to be a function."),(0,d.V)("function"===typeof e.beginDrag,"Expected beginDrag to be a function."),(0,d.V)("function"===typeof e.endDrag,"Expected endDrag to be a function.")}(t);var n=this.addHandler(he.SOURCE,e,t);return this.store.dispatch(function(e){return{type:H,payload:{sourceId:e}}}(n)),n}},{key:"addTarget",value:function(e,t){fe(e,!0),function(e){(0,d.V)("function"===typeof e.canDrop,"Expected canDrop to be a function."),(0,d.V)("function"===typeof e.hover,"Expected hover to be a function."),(0,d.V)("function"===typeof e.drop,"Expected beginDrag to be a function.")}(t);var n=this.addHandler(he.TARGET,e,t);return this.store.dispatch(function(e){return{type:V,payload:{targetId:e}}}(n)),n}},{key:"containsHandler",value:function(e){return Ae(this.dragSources,e)||Ae(this.dropTargets,e)}},{key:"getSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,d.V)(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}},{key:"getTarget",value:function(e){return(0,d.V)(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}},{key:"getSourceType",value:function(e){return(0,d.V)(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}},{key:"getTargetType",value:function(e){return(0,d.V)(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}},{key:"isSourceId",value:function(e){return xe(e)===he.SOURCE}},{key:"isTargetId",value:function(e){return xe(e)===he.TARGET}},{key:"removeSource",value:function(e){var t,n=this;(0,d.V)(this.getSource(e),"Expected an existing source."),this.store.dispatch(function(e){return{type:Z,payload:{sourceId:e}}}(e)),t=function(){n.dragSources.delete(e),n.types.delete(e)},be.enqueueTask(Ie.create(t))}},{key:"removeTarget",value:function(e){(0,d.V)(this.getTarget(e),"Expected an existing target."),this.store.dispatch(function(e){return{type:q,payload:{targetId:e}}}(e)),this.dropTargets.delete(e),this.types.delete(e)}},{key:"pinSource",value:function(e){var t=this.getSource(e);(0,d.V)(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t}},{key:"unpinSource",value:function(){(0,d.V)(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}},{key:"addHandler",value:function(e,t,n){var r=we(e);return this.types.set(r,t),e===he.SOURCE?this.dragSources.set(r,n):e===he.TARGET&&this.dropTargets.set(r,n),r}}],n&&Ce(t.prototype,n),r&&Ce(t,r),e}();function Le(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(e){var t="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return N(le,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(arguments.length>3&&void 0!==arguments[3]&&arguments[3]),i=new pe(r,new Fe(r)),s=new L(r,i),a=e(s,t,n);return s.receiveBackend(a),s}var _e=n(61804),Ue=["children"];function Oe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,s=[],a=!0,o=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(s.push(r.value),!t||s.length!==t);a=!0);}catch(l){o=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(o)throw i}}return s}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Me(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var Ne=0,Re=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__"),Ge=(0,a.memo)(function(e){var t=e.children,n=function(e){if("manager"in e){return[{dragDropManager:e.manager},!1]}var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:We(),n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=t;i[Re]||(i[Re]={dragDropManager:Le(e,t,n,r)});return i[Re]}(e.backend,e.context,e.options,e.debugMode),n=!e.context;return[t,n]}(Me(e,Ue)),r=Oe(n,2),i=r[0],s=r[1];return(0,a.useEffect)(function(){if(s){var e=We();return++Ne,function(){0===--Ne&&(e[Re]=null)}}},[]),(0,c.jsx)(_e.M.Provider,Object.assign({value:i},{children:t}),void 0)});function We(){return"undefined"!==typeof n.g?n.g:window}function ze(e){var t=null;return function(){return null==t&&(t=e()),t}}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var He=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ke(this,"entered",[]),Ke(this,"isNodeInDocument",void 0),this.isNodeInDocument=t}var t,n,r;return t=e,(n=[{key:"enter",value:function(e){var t=this,n=this.entered.length;return this.entered=function(e,t){var n=new Set,r=function(e){return n.add(e)};e.forEach(r),t.forEach(r);var i=[];return n.forEach(function(e){return i.push(e)}),i}(this.entered.filter(function(n){return t.isNodeInDocument(n)&&(!n.contains||n.contains(e))}),[e]),0===n&&this.entered.length>0}},{key:"leave",value:function(e){var t,n,r=this.entered.length;return this.entered=(t=this.entered.filter(this.isNodeInDocument),n=e,t.filter(function(e){return e!==n})),r>0&&0===this.entered.length}},{key:"reset",value:function(){this.entered=[]}}])&&je(t.prototype,n),r&&je(t,r),e}(),Ve=ze(function(){return/firefox/i.test(navigator.userAgent)}),Ze=ze(function(){return Boolean(window.safari)});function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Je=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Ye(this,"xs",void 0),Ye(this,"ys",void 0),Ye(this,"c1s",void 0),Ye(this,"c2s",void 0),Ye(this,"c3s",void 0);for(var r=t.length,i=[],s=0;s<r;s++)i.push(s);i.sort(function(e,n){return t[e]<t[n]?-1:1});for(var a,o,l=[],c=[],d=[],u=0;u<r-1;u++)a=t[u+1]-t[u],o=n[u+1]-n[u],c.push(a),l.push(o),d.push(o/a);for(var h=[d[0]],p=0;p<c.length-1;p++){var g=d[p],m=d[p+1];if(g*m<=0)h.push(0);else{a=c[p];var f=c[p+1],v=a+f;h.push(3*v/((v+f)/g+(v+a)/m))}}h.push(d[d.length-1]);for(var y,k=[],T=[],S=0;S<h.length-1;S++){y=d[S];var b=h[S],I=1/c[S],C=b+h[S+1]-y-y;k.push((y-b-C)*I),T.push(C*I*I)}this.xs=t,this.ys=n,this.c1s=h,this.c2s=k,this.c3s=T}var t,n,r;return t=e,(n=[{key:"interpolate",value:function(e){var t=this.xs,n=this.ys,r=this.c1s,i=this.c2s,s=this.c3s,a=t.length-1;if(e===t[a])return n[a];for(var o,l=0,c=s.length-1;l<=c;){var d=t[o=Math.floor(.5*(l+c))];if(d<e)l=o+1;else{if(!(d>e))return n[o];c=o-1}}var u=e-t[a=Math.max(0,c)],h=u*u;return n[a]+r[a]*u+i[a]*h+s[a]*u*h}}])&&qe(t.prototype,n),r&&qe(t,r),e}();function Xe(e){var t=1===e.nodeType?e:e.parentElement;if(!t)return null;var n=t.getBoundingClientRect(),r=n.top;return{x:n.left,y:r}}function $e(e){return{x:e.clientX,y:e.clientY}}function Qe(e,t,n,r,i){var s=function(e){var t;return"IMG"===e.nodeName&&(Ve()||!(null!==(t=document.documentElement)&&void 0!==t&&t.contains(e)))}(t),a=Xe(s?e:t),o={x:n.x-a.x,y:n.y-a.y},l=e.offsetWidth,c=e.offsetHeight,d=r.anchorX,u=r.anchorY,h=function(e,t,n,r){var i=e?t.width:n,s=e?t.height:r;return Ze()&&e&&(s/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:s}}(s,t,l,c),p=h.dragPreviewWidth,g=h.dragPreviewHeight,m=i.offsetX,f=i.offsetY,v=0===f||f;return{x:0===m||m?m:new Je([0,.5,1],[o.x,o.x/l*p,o.x+p-l]).interpolate(d),y:v?f:function(){var e=new Je([0,.5,1],[o.y,o.y/c*g,o.y+g-c]).interpolate(u);return Ze()&&s&&(e+=(window.devicePixelRatio-1)*g),e}()}}var et,tt="__NATIVE_FILE__",nt="__NATIVE_URL__",rt="__NATIVE_TEXT__",it="__NATIVE_HTML__";function st(e,t,n){var r=t.reduce(function(t,n){return t||e.getData(n)},"");return null!=r?r:n}function at(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ot=(at(et={},tt,{exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items},dataTransfer:function(e){return e}},matchesTypes:["Files"]}),at(et,it,{exposeProperties:{html:function(e,t){return st(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Html","text/html"]}),at(et,nt,{exposeProperties:{urls:function(e,t){return st(e,t,"").split("\n")},dataTransfer:function(e){return e}},matchesTypes:["Url","text/uri-list"]}),at(et,rt,{exposeProperties:{text:function(e,t){return st(e,t,"")},dataTransfer:function(e){return e}},matchesTypes:["Text","text/plain"]}),et);function lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ct(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ct(this,"item",void 0),ct(this,"config",void 0),this.config=t,this.item={},this.initializeExposedProperties()}var t,n,r;return t=e,(n=[{key:"initializeExposedProperties",value:function(){var e=this;Object.keys(this.config.exposeProperties).forEach(function(t){Object.defineProperty(e.item,t,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \"".concat(t,'" until the drop event.')),null}})})}},{key:"loadDataTransfer",value:function(e){var t=this;if(e){var n={};Object.keys(this.config.exposeProperties).forEach(function(r){n[r]={value:t.config.exposeProperties[r](e,t.config.matchesTypes),configurable:!0,enumerable:!0}}),Object.defineProperties(this.item,n)}}},{key:"canDrag",value:function(){return!0}},{key:"beginDrag",value:function(){return this.item}},{key:"isDragging",value:function(e,t){return t===e.getSourceId()}},{key:"endDrag",value:function(){}}])&&lt(t.prototype,n),r&&lt(t,r),e}();function ut(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(ot).filter(function(e){return ot[e].matchesTypes.some(function(e){return t.indexOf(e)>-1})})[0]||null}function ht(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gt=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),pt(this,"ownerDocument",null),pt(this,"globalContext",void 0),pt(this,"optionsArgs",void 0),this.globalContext=t,this.optionsArgs=n}var t,n,r;return t=e,(n=[{key:"window",get:function(){return this.globalContext?this.globalContext:"undefined"!==typeof window?window:void 0}},{key:"document",get:function(){var e;return null!==(e=this.globalContext)&&void 0!==e&&e.document?this.globalContext.document:this.window?this.window.document:void 0}},{key:"rootElement",get:function(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}}])&&ht(t.prototype,n),r&&ht(t,r),e}();function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach(function(t){yt(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function vt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var kt=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),yt(this,"options",void 0),yt(this,"actions",void 0),yt(this,"monitor",void 0),yt(this,"registry",void 0),yt(this,"enterLeaveCounter",void 0),yt(this,"sourcePreviewNodes",new Map),yt(this,"sourcePreviewNodeOptions",new Map),yt(this,"sourceNodes",new Map),yt(this,"sourceNodeOptions",new Map),yt(this,"dragStartSourceIds",null),yt(this,"dropTargetIds",[]),yt(this,"dragEnterTargetIds",[]),yt(this,"currentNativeSource",null),yt(this,"currentNativeHandle",null),yt(this,"currentDragSourceNode",null),yt(this,"altKeyPressed",!1),yt(this,"mouseMoveTimeoutTimer",null),yt(this,"asyncEndDragFrameId",null),yt(this,"dragOverTargetIds",null),yt(this,"lastClientOffset",null),yt(this,"hoverRafId",null),yt(this,"getSourceClientOffset",function(e){var t=i.sourceNodes.get(e);return t&&Xe(t)||null}),yt(this,"endDragNativeItem",function(){i.isDraggingNativeItem()&&(i.actions.endDrag(),i.currentNativeHandle&&i.registry.removeSource(i.currentNativeHandle),i.currentNativeHandle=null,i.currentNativeSource=null)}),yt(this,"isNodeInDocument",function(e){return Boolean(e&&i.document&&i.document.body&&i.document.body.contains(e))}),yt(this,"endDragIfSourceWasRemovedFromDOM",function(){var e=i.currentDragSourceNode;null==e||i.isNodeInDocument(e)||i.clearCurrentDragSourceNode()&&i.monitor.isDragging()&&i.actions.endDrag()}),yt(this,"handleTopDragStartCapture",function(){i.clearCurrentDragSourceNode(),i.dragStartSourceIds=[]}),yt(this,"handleTopDragStart",function(e){if(!e.defaultPrevented){var t=i.dragStartSourceIds;i.dragStartSourceIds=null;var n=$e(e);i.monitor.isDragging()&&i.actions.endDrag(),i.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:i.getSourceClientOffset,clientOffset:n});var r=e.dataTransfer,s=ut(r);if(i.monitor.isDragging()){if(r&&"function"===typeof r.setDragImage){var a=i.monitor.getSourceId(),o=i.sourceNodes.get(a),l=i.sourcePreviewNodes.get(a)||o;if(l){var c=i.getCurrentSourcePreviewNodeOptions(),d=Qe(o,l,n,{anchorX:c.anchorX,anchorY:c.anchorY},{offsetX:c.offsetX,offsetY:c.offsetY});r.setDragImage(l,d.x,d.y)}}try{null===r||void 0===r||r.setData("application/json",{})}catch(u){}i.setCurrentDragSourceNode(e.target),i.getCurrentSourcePreviewNodeOptions().captureDraggingState?i.actions.publishDragSource():setTimeout(function(){return i.actions.publishDragSource()},0)}else if(s)i.beginDragNativeItem(s);else{if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}}),yt(this,"handleTopDragEndCapture",function(){i.clearCurrentDragSourceNode()&&i.monitor.isDragging()&&i.actions.endDrag()}),yt(this,"handleTopDragEnterCapture",function(e){if(i.dragEnterTargetIds=[],i.enterLeaveCounter.enter(e.target)&&!i.monitor.isDragging()){var t=e.dataTransfer,n=ut(t);n&&i.beginDragNativeItem(n,t)}}),yt(this,"handleTopDragEnter",function(e){var t=i.dragEnterTargetIds;(i.dragEnterTargetIds=[],i.monitor.isDragging())&&(i.altKeyPressed=e.altKey,t.length>0&&i.actions.hover(t,{clientOffset:$e(e)}),t.some(function(e){return i.monitor.canDropOnTarget(e)})&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=i.getCurrentDropEffect())))}),yt(this,"handleTopDragOverCapture",function(){i.dragOverTargetIds=[]}),yt(this,"handleTopDragOver",function(e){var t=i.dragOverTargetIds;if(i.dragOverTargetIds=[],!i.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));i.altKeyPressed=e.altKey,i.lastClientOffset=$e(e),null===i.hoverRafId&&"undefined"!==typeof requestAnimationFrame&&(i.hoverRafId=requestAnimationFrame(function(){i.monitor.isDragging()&&i.actions.hover(t||[],{clientOffset:i.lastClientOffset}),i.hoverRafId=null})),(t||[]).some(function(e){return i.monitor.canDropOnTarget(e)})?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=i.getCurrentDropEffect())):i.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))}),yt(this,"handleTopDragLeaveCapture",function(e){i.isDraggingNativeItem()&&e.preventDefault(),i.enterLeaveCounter.leave(e.target)&&i.isDraggingNativeItem()&&setTimeout(function(){return i.endDragNativeItem()},0)}),yt(this,"handleTopDropCapture",function(e){var t;(i.dropTargetIds=[],i.isDraggingNativeItem())?(e.preventDefault(),null===(t=i.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):ut(e.dataTransfer)&&e.preventDefault();i.enterLeaveCounter.reset()}),yt(this,"handleTopDrop",function(e){var t=i.dropTargetIds;i.dropTargetIds=[],i.actions.hover(t,{clientOffset:$e(e)}),i.actions.drop({dropEffect:i.getCurrentDropEffect()}),i.isDraggingNativeItem()?i.endDragNativeItem():i.monitor.isDragging()&&i.actions.endDrag()}),yt(this,"handleSelectStart",function(e){var t=e.target;"function"===typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))}),this.options=new gt(n,r),this.actions=t.getActions(),this.monitor=t.getMonitor(),this.registry=t.getRegistry(),this.enterLeaveCounter=new He(this.isNodeInDocument)}var t,n,i;return t=e,(n=[{key:"profile",value:function(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}},{key:"window",get:function(){return this.options.window}},{key:"document",get:function(){return this.options.document}},{key:"rootElement",get:function(){return this.options.rootElement}},{key:"setup",value:function(){var e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}},{key:"teardown",value:function(){var e,t=this.rootElement;void 0!==t&&(t.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(e=this.window)||void 0===e||e.cancelAnimationFrame(this.asyncEndDragFrameId)))}},{key:"connectDragPreview",value:function(e,t,n){var r=this;return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),function(){r.sourcePreviewNodes.delete(e),r.sourcePreviewNodeOptions.delete(e)}}},{key:"connectDragSource",value:function(e,t,n){var r=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);var i=function(t){return r.handleDragStart(t,e)},s=function(e){return r.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",i),t.addEventListener("selectstart",s),function(){r.sourceNodes.delete(e),r.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",i),t.removeEventListener("selectstart",s),t.setAttribute("draggable","false")}}},{key:"connectDropTarget",value:function(e,t){var n=this,r=function(t){return n.handleDragEnter(t,e)},i=function(t){return n.handleDragOver(t,e)},s=function(t){return n.handleDrop(t,e)};return t.addEventListener("dragenter",r),t.addEventListener("dragover",i),t.addEventListener("drop",s),function(){t.removeEventListener("dragenter",r),t.removeEventListener("dragover",i),t.removeEventListener("drop",s)}}},{key:"addEventListeners",value:function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}},{key:"removeEventListeners",value:function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}},{key:"getCurrentSourceNodeOptions",value:function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return ft({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}},{key:"getCurrentDropEffect",value:function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}},{key:"getCurrentSourcePreviewNodeOptions",value:function(){var e=this.monitor.getSourceId();return ft({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}},{key:"isDraggingNativeItem",value:function(){var e=this.monitor.getItemType();return Object.keys(r).some(function(t){return r[t]===e})}},{key:"beginDragNativeItem",value:function(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){var n=new dt(ot[e]);return n.loadDataTransfer(t),n}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}},{key:"setCurrentDragSourceNode",value:function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e,this.mouseMoveTimeoutTimer=setTimeout(function(){var e;return null===(e=t.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)},1e3)}},{key:"clearCurrentDragSourceNode",value:function(){var e;return!!this.currentDragSourceNode&&(this.currentDragSourceNode=null,this.rootElement&&(null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)),this.mouseMoveTimeoutTimer=null,!0)}},{key:"handleDragStart",value:function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}},{key:"handleDragEnter",value:function(e,t){this.dragEnterTargetIds.unshift(t)}},{key:"handleDragOver",value:function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}},{key:"handleDrop",value:function(e,t){this.dropTargetIds.unshift(t)}}])&&vt(t.prototype,n),i&&vt(t,i),e}(),Tt=function(e,t,n){return new kt(e,t,n)},St=n(8253);const bt=(e,t)=>({event:e,check:t});function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ct(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Dt(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Pt(e,t,"get"))}function Et(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Pt(e,t,"set"),n),n}function Pt(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var wt=new WeakMap;class xt{constructor(){Ct(this,wt,{writable:!0,value:void 0}),It(this,"register",e=>{Dt(this,wt).push(e)}),It(this,"unregister",e=>{let t;for(;-1!==(t=Dt(this,wt).indexOf(e));)Dt(this,wt).splice(t,1)}),It(this,"backendChanged",e=>{for(const t of Dt(this,wt))t.backendChanged(e)}),Et(this,wt,[])}}function At(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function Ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lt(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,Ut(e,t,"get"))}function _t(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}(e,Ut(e,t,"set"),n),n}function Ut(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}var Ot=new WeakMap,Bt=new WeakMap,Mt=new WeakMap,Nt=new WeakMap,Rt=new WeakMap,Gt=new WeakMap,Wt=new WeakMap,zt=new WeakMap,jt=new WeakMap,Kt=new WeakMap,Ht=new WeakMap;class Vt{constructor(e,t,n){if(At(this,Ot,{writable:!0,value:void 0}),At(this,Bt,{writable:!0,value:void 0}),At(this,Mt,{writable:!0,value:void 0}),At(this,Nt,{writable:!0,value:void 0}),At(this,Rt,{writable:!0,value:void 0}),At(this,Gt,{writable:!0,value:(e,t,n)=>{var r,i;if(!n.backend)throw new Error("You must specify a 'backend' property in your Backend entry: ".concat(JSON.stringify(n)));const s=n.backend(e,t,n.options);let a=n.id;const o=!n.id&&s&&s.constructor;if(o&&(a=s.constructor.name),!a)throw new Error("You must specify an 'id' property in your Backend entry: ".concat(JSON.stringify(n),"\n        see this guide: https://github.com/louisbrunner/dnd-multi-backend/tree/master/packages/react-dnd-multi-backend#migrating-from-5xx"));if(o&&console.warn("Deprecation notice: You are using a pipeline which doesn't include backends' 'id'.\n        This might be unsupported in the future, please specify 'id' explicitely for every backend."),Lt(this,Mt)[a])throw new Error("You must specify a unique 'id' property in your Backend entry:\n        ".concat(JSON.stringify(n)," (conflicts with: ").concat(JSON.stringify(Lt(this,Mt)[a]),")"));return{id:a,instance:s,preview:null!==(r=n.preview)&&void 0!==r&&r,transition:n.transition,skipDispatchOnTransition:null!==(i=n.skipDispatchOnTransition)&&void 0!==i&&i}}}),Ft(this,"setup",()=>{if("undefined"!==typeof window){if(Vt.isSetUp)throw new Error("Cannot have two MultiBackends at the same time.");Vt.isSetUp=!0,Lt(this,Wt).call(this,window),Lt(this,Mt)[Lt(this,Ot)].instance.setup()}}),Ft(this,"teardown",()=>{"undefined"!==typeof window&&(Vt.isSetUp=!1,Lt(this,zt).call(this,window),Lt(this,Mt)[Lt(this,Ot)].instance.teardown())}),Ft(this,"connectDragSource",(e,t,n)=>Lt(this,Ht).call(this,"connectDragSource",e,t,n)),Ft(this,"connectDragPreview",(e,t,n)=>Lt(this,Ht).call(this,"connectDragPreview",e,t,n)),Ft(this,"connectDropTarget",(e,t,n)=>Lt(this,Ht).call(this,"connectDropTarget",e,t,n)),Ft(this,"profile",()=>Lt(this,Mt)[Lt(this,Ot)].instance.profile()),Ft(this,"previewEnabled",()=>Lt(this,Mt)[Lt(this,Ot)].preview),Ft(this,"previewsList",()=>Lt(this,Bt)),Ft(this,"backendsList",()=>Lt(this,Nt)),At(this,Wt,{writable:!0,value:e=>{Lt(this,Nt).forEach(t=>{t.transition&&e.addEventListener(t.transition.event,Lt(this,jt))})}}),At(this,zt,{writable:!0,value:e=>{Lt(this,Nt).forEach(t=>{t.transition&&e.removeEventListener(t.transition.event,Lt(this,jt))})}}),At(this,jt,{writable:!0,value:e=>{const t=Lt(this,Ot);if(Lt(this,Nt).some(t=>!(t.id===Lt(this,Ot)||!t.transition||!t.transition.check(e))&&(_t(this,Ot,t.id),!0)),Lt(this,Ot)!==t){var n;Lt(this,Mt)[t].instance.teardown(),Object.keys(Lt(this,Rt)).forEach(e=>{const t=Lt(this,Rt)[e];t.unsubscribe(),t.unsubscribe=Lt(this,Kt).call(this,t.func,...t.args)}),Lt(this,Bt).backendChanged(this);const r=Lt(this,Mt)[Lt(this,Ot)];if(r.instance.setup(),r.skipDispatchOnTransition)return;const i=new(0,e.constructor)(e.type,e);null===(n=e.target)||void 0===n||n.dispatchEvent(i)}}}),At(this,Kt,{writable:!0,value:(e,t,n,r)=>Lt(this,Mt)[Lt(this,Ot)].instance[e](t,n,r)}),At(this,Ht,{writable:!0,value:(e,t,n,r)=>{const i="".concat(e,"_").concat(t),s=Lt(this,Kt).call(this,e,t,n,r);return Lt(this,Rt)[i]={func:e,args:[t,n,r],unsubscribe:s},()=>{Lt(this,Rt)[i].unsubscribe(),delete Lt(this,Rt)[i]}}}),!n||!n.backends||n.backends.length<1)throw new Error("You must specify at least one Backend, if you are coming from 2.x.x (or don't understand this error)\n        see this guide: https://github.com/louisbrunner/dnd-multi-backend/tree/master/packages/react-dnd-multi-backend#migrating-from-2xx");_t(this,Bt,new xt),_t(this,Mt,{}),_t(this,Nt,[]),n.backends.forEach(n=>{const r=Lt(this,Gt).call(this,e,t,n);Lt(this,Mt)[r.id]=r,Lt(this,Nt).push(r)}),_t(this,Ot,Lt(this,Nt)[0].id),_t(this,Rt,{})}}Ft(Vt,"isSetUp",!1);const Zt=(e,t,n)=>new Vt(e,t,n);function qt(e){let t=null;return()=>(null==t&&(t=e()),t)}class Yt{enter(e){const t=this.entered.length;return this.entered=function(e,t){const n=new Set,r=e=>n.add(e);e.forEach(r),t.forEach(r);const i=[];return n.forEach(e=>i.push(e)),i}(this.entered.filter(t=>this.isNodeInDocument(t)&&(!t.contains||t.contains(e))),[e]),0===t&&this.entered.length>0}leave(e){const t=this.entered.length;var n,r;return this.entered=(n=this.entered.filter(this.isNodeInDocument),r=e,n.filter(e=>e!==r)),t>0&&0===this.entered.length}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}const Jt=qt(()=>/firefox/i.test(navigator.userAgent)),Xt=qt(()=>Boolean(window.safari));class $t{interpolate(e){const{xs:t,ys:n,c1s:r,c2s:i,c3s:s}=this;let a=t.length-1;if(e===t[a])return n[a];let o,l=0,c=s.length-1;for(;l<=c;){o=Math.floor(.5*(l+c));const r=t[o];if(r<e)l=o+1;else{if(!(r>e))return n[o];c=o-1}}a=Math.max(0,c);const d=e-t[a],u=d*d;return n[a]+r[a]*d+i[a]*u+s[a]*d*u}constructor(e,t){const{length:n}=e,r=[];for(let p=0;p<n;p++)r.push(p);r.sort((t,n)=>e[t]<e[n]?-1:1);const i=[],s=[],a=[];let o,l;for(let p=0;p<n-1;p++)o=e[p+1]-e[p],l=t[p+1]-t[p],s.push(o),i.push(l),a.push(l/o);const c=[a[0]];for(let p=0;p<s.length-1;p++){const e=a[p],t=a[p+1];if(e*t<=0)c.push(0);else{o=s[p];const n=s[p+1],r=o+n;c.push(3*r/((r+n)/e+(r+o)/t))}}c.push(a[a.length-1]);const d=[],u=[];let h;for(let p=0;p<c.length-1;p++){h=a[p];const e=c[p],t=1/s[p],n=e+c[p+1]-h-h;d.push((h-e-n)*t),u.push(n*t*t)}this.xs=e,this.ys=t,this.c1s=c,this.c2s=d,this.c3s=u}}function Qt(e){const t=1===e.nodeType?e:e.parentElement;if(!t)return null;const{top:n,left:r}=t.getBoundingClientRect();return{x:r,y:n}}function en(e){return{x:e.clientX,y:e.clientY}}function tn(e,t,n,r,i){const s=function(e){var t;return"IMG"===e.nodeName&&(Jt()||!(null===(t=document.documentElement)||void 0===t?void 0:t.contains(e)))}(t),a=Qt(s?e:t),o={x:n.x-a.x,y:n.y-a.y},{offsetWidth:l,offsetHeight:c}=e,{anchorX:d,anchorY:u}=r,{dragPreviewWidth:h,dragPreviewHeight:p}=function(e,t,n,r){let i=e?t.width:n,s=e?t.height:r;return Xt()&&e&&(s/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:s}}(s,t,l,c),{offsetX:g,offsetY:m}=i,f=0===m||m;return{x:0===g||g?g:new $t([0,.5,1],[o.x,o.x/l*h,o.x+h-l]).interpolate(d),y:f?m:(()=>{let e=new $t([0,.5,1],[o.y,o.y/c*p,o.y+p-c]).interpolate(u);return Xt()&&s&&(e+=(window.devicePixelRatio-1)*p),e})()}}const nn="__NATIVE_FILE__",rn="__NATIVE_URL__",sn="__NATIVE_TEXT__",an="__NATIVE_HTML__";function on(e,t,n){const r=t.reduce((t,n)=>t||e.getData(n),"");return null!=r?r:n}const ln={[nn]:{exposeProperties:{files:e=>Array.prototype.slice.call(e.files),items:e=>e.items,dataTransfer:e=>e},matchesTypes:["Files"]},[an]:{exposeProperties:{html:(e,t)=>on(e,t,""),dataTransfer:e=>e},matchesTypes:["Html","text/html"]},[rn]:{exposeProperties:{urls:(e,t)=>on(e,t,"").split("\n"),dataTransfer:e=>e},matchesTypes:["Url","text/uri-list"]},[sn]:{exposeProperties:{text:(e,t)=>on(e,t,""),dataTransfer:e=>e},matchesTypes:["Text","text/plain"]}};class cn{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get:()=>(console.warn("Browser doesn't allow reading \"".concat(e,'" until the drop event.')),null)})})}loadDataTransfer(e){if(e){const t={};Object.keys(this.config.exposeProperties).forEach(n=>{const r=this.config.exposeProperties[n];null!=r&&(t[n]={value:r(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,t)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,t){return t===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}function dn(e){if(!e)return null;const t=Array.prototype.slice.call(e.types||[]);return Object.keys(ln).filter(e=>{const n=ln[e];return!!(null===n||void 0===n?void 0:n.matchesTypes)&&n.matchesTypes.some(e=>t.indexOf(e)>-1)})[0]||null}class un{get window(){return this.globalContext?this.globalContext:"undefined"!==typeof window?window:void 0}get document(){var e;return(null===(e=this.globalContext)||void 0===e?void 0:e.document)?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.optionsArgs)||void 0===e?void 0:e.rootElement)||this.window}constructor(e,t){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=t}}function hn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){hn(e,t,n[t])})}return e}class gn{profile(){var e,t;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:(null===(e=this.dragStartSourceIds)||void 0===e?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:(null===(t=this.dragOverTargetIds)||void 0===t?void 0:t.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(void 0!==e){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;var t;void 0!==e&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&(null===(t=this.window)||void 0===t||t.cancelAnimationFrame(this.asyncEndDragFrameId)))}connectDragPreview(e,t,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,t,n){this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,n);const r=t=>this.handleDragStart(t,e),i=e=>this.handleSelectStart(e);return t.setAttribute("draggable","true"),t.addEventListener("dragstart",r),t.addEventListener("selectstart",i),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",r),t.removeEventListener("selectstart",i),t.setAttribute("draggable","false")}}connectDropTarget(e,t){const n=t=>this.handleDragEnter(t,e),r=t=>this.handleDragOver(t,e),i=t=>this.handleDrop(t,e);return t.addEventListener("dragenter",n),t.addEventListener("dragover",r),t.addEventListener("drop",i),()=>{t.removeEventListener("dragenter",n),t.removeEventListener("dragover",r),t.removeEventListener("drop",i)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return pn({dropEffect:this.altKeyPressed?"copy":"move"},t||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId();return pn({anchorX:.5,anchorY:.5,captureDraggingState:!1},this.sourcePreviewNodeOptions.get(e)||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(i).some(t=>i[t]===e)}beginDragNativeItem(e,t){this.clearCurrentDragSourceNode(),this.currentNativeSource=function(e,t){const n=ln[e];if(!n)throw new Error("native type ".concat(e," has no configuration"));const r=new cn(n);return r.loadDataTransfer(t),r}(e,t),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;this.mouseMoveTimeoutTimer=setTimeout(()=>{var e;return null===(e=this.rootElement)||void 0===e?void 0:e.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},1e3)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){var e;if(this.currentDragSourceNode=null,this.rootElement)null===(e=this.window)||void 0===e||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0);return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))}handleDragEnter(e,t){this.dragEnterTargetIds.unshift(t)}handleDragOver(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)}handleDrop(e,t){this.dropTargetIds.unshift(t)}constructor(e,t,n){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=e=>{const t=this.sourceNodes.get(e);return t&&Qt(t)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=e=>Boolean(e&&this.document&&this.document.body&&this.document.body.contains(e)),this.endDragIfSourceWasRemovedFromDOM=()=>{const e=this.currentDragSourceNode;null==e||this.isNodeInDocument(e)||this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag()},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=e=>{if(e.defaultPrevented)return;const{dragStartSourceIds:t}=this;this.dragStartSourceIds=null;const n=en(e);this.monitor.isDragging()&&this.actions.endDrag(),this.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:n});const{dataTransfer:r}=e,i=dn(r);if(this.monitor.isDragging()){if(r&&"function"===typeof r.setDragImage){const e=this.monitor.getSourceId(),t=this.sourceNodes.get(e),i=this.sourcePreviewNodes.get(e)||t;if(i){const{anchorX:e,anchorY:s,offsetX:a,offsetY:o}=this.getCurrentSourcePreviewNodeOptions(),l=tn(t,i,n,{anchorX:e,anchorY:s},{offsetX:a,offsetY:o});r.setDragImage(i,l.x,l.y)}}try{null===r||void 0===r||r.setData("application/json",{})}catch(s){}this.setCurrentDragSourceNode(e.target);const{captureDraggingState:t}=this.getCurrentSourcePreviewNodeOptions();t?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(i)this.beginDragNativeItem(i);else{if(r&&!r.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag()},this.handleTopDragEnterCapture=e=>{var t;(this.dragEnterTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer));if(!this.enterLeaveCounter.enter(e.target)||this.monitor.isDragging())return;const{dataTransfer:n}=e,r=dn(n);r&&this.beginDragNativeItem(r,n)},this.handleTopDragEnter=e=>{const{dragEnterTargetIds:t}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=e.altKey,t.length>0&&this.actions.hover(t,{clientOffset:en(e)});t.some(e=>this.monitor.canDropOnTarget(e))&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=e=>{var t;(this.dragOverTargetIds=[],this.isDraggingNativeItem())&&(null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer))},this.handleTopDragOver=e=>{const{dragOverTargetIds:t}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));this.altKeyPressed=e.altKey,this.lastClientOffset=en(e),null===this.hoverRafId&&"undefined"!==typeof requestAnimationFrame&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(t||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}));(t||[]).some(e=>this.monitor.canDropOnTarget(e))?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=e=>{this.isDraggingNativeItem()&&e.preventDefault();this.enterLeaveCounter.leave(e.target)&&this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0)},this.handleTopDropCapture=e=>{var t;(this.dropTargetIds=[],this.isDraggingNativeItem())?(e.preventDefault(),null===(t=this.currentNativeSource)||void 0===t||t.loadDataTransfer(e.dataTransfer)):dn(e.dataTransfer)&&e.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=e=>{const{dropTargetIds:t}=this;this.dropTargetIds=[],this.actions.hover(t,{clientOffset:en(e)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag()},this.handleSelectStart=e=>{const t=e.target;"function"===typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new un(t,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new Yt(this.isNodeInDocument)}}function mn(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if("undefined"!==typeof process&&void 0===t)throw new Error("invariant requires an error message argument");if(!e){let e;if(void 0===t)e=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let n=0;e=new Error(t.replace(/%s/g,function(){return r[n++]})),e.name="Invariant Violation"}throw e.framesToPop=1,e}}var fn;!function(e){e.mouse="mouse",e.touch="touch",e.keyboard="keyboard"}(fn||(fn={}));const vn=1,yn=0;function kn(e){return void 0===e.button||e.button===yn}function Tn(e){return!!e.targetTouches}function Sn(e,t){return Tn(e)?function(e,t){return 1===e.targetTouches.length?Sn(e.targetTouches[0]):t&&1===e.touches.length&&e.touches[0].target===t.target?Sn(e.touches[0]):void 0}(e,t):{x:e.clientX,y:e.clientY}}const bn=(()=>{let e=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get:()=>(e=!0,!0)}))}catch(t){}return e})();class In{get delay(){var e;return null!==(e=this.args.delay)&&void 0!==e?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return null!==(e=this.args.ignoreContextMenu)&&void 0!==e&&e}get enableHoverOutsideTarget(){var e;return null!==(e=this.args.enableHoverOutsideTarget)&&void 0!==e&&e}get enableKeyboardEvents(){var e;return null!==(e=this.args.enableKeyboardEvents)&&void 0!==e&&e}get enableMouseEvents(){var e;return null!==(e=this.args.enableMouseEvents)&&void 0!==e&&e}get enableTouchEvents(){var e;return null===(e=this.args.enableTouchEvents)||void 0===e||e}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,t,n,r;return null!==(r=null!==(n=null===(e=this.args)||void 0===e?void 0:e.delayTouchStart)&&void 0!==n?n:null===(t=this.args)||void 0===t?void 0:t.delay)&&void 0!==r?r:0}get delayMouseStart(){var e,t,n,r;return null!==(r=null!==(n=null===(e=this.args)||void 0===e?void 0:e.delayMouseStart)&&void 0!==n?n:null===(t=this.args)||void 0===t?void 0:t.delay)&&void 0!==r?r:0}get window(){return this.context&&this.context.window?this.context.window:"undefined"!==typeof window?window:void 0}get document(){var e;return(null===(e=this.context)||void 0===e?void 0:e.document)?this.context.document:this.window?this.window.document:void 0}get rootElement(){var e;return(null===(e=this.args)||void 0===e?void 0:e.rootElement)||this.document}constructor(e,t){this.args=e,this.context=t}}const Cn={[fn.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[fn.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[fn.keyboard]:{keydown:"keydown"}};class Dn{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:(null===(e=this.dragOverTargetIds)||void 0===e?void 0:e.length)||0}}get document(){return this.options.document}setup(){const e=this.options.rootElement;e&&(mn(!Dn.isSetUp,"Cannot have two Touch backends at the same time."),Dn.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){const e=this.options.rootElement;e&&(Dn.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=bn?{capture:r,passive:!1}:r;this.listenerTypes.forEach(function(r){const s=Cn[r][t];s&&e.addEventListener(s,n,i)})}removeEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=bn?{capture:r,passive:!1}:r;this.listenerTypes.forEach(function(r){const s=Cn[r][t];s&&e.removeEventListener(s,n,i)})}connectDragSource(e,t){const n=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,t),this.addEventListener(t,"start",n),()=>{this.sourceNodes.delete(e),this.removeEventListener(t,"start",n)}}connectDragPreview(e,t,n){return this.sourcePreviewNodeOptions.set(e,n),this.sourcePreviewNodes.set(e,t),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,t){const n=this.options.rootElement;if(!this.document||!n)return()=>{};const r=r=>{if(!this.document||!n||!this.monitor.isDragging())return;let i;switch(r.type){case Cn.mouse.move:i={x:r.clientX,y:r.clientY};break;case Cn.touch.move:var s,a;i={x:(null===(s=r.touches[0])||void 0===s?void 0:s.clientX)||0,y:(null===(a=r.touches[0])||void 0===a?void 0:a.clientY)||0}}const o=null!=i?this.document.elementFromPoint(i.x,i.y):void 0,l=o&&t.contains(o);return o===t||l?this.handleMove(r,e):void 0};return this.addEventListener(this.document.body,"move",r),this.targetNodes.set(e,t),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",r))}}getTopMoveStartHandler(){return this.options.delayTouchStart||this.options.delayMouseStart?this.handleTopMoveStartDelay:this.handleTopMoveStart}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),e&&e.parentElement&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,t,n){this.getSourceClientOffset=e=>{const t=this.sourceNodes.get(e);return t&&function(e){const t=1===e.nodeType?e:e.parentElement;if(!t)return;const{top:n,left:r}=t.getBoundingClientRect();return{x:r,y:n}}(t)},this.handleTopMoveStartCapture=e=>{kn(e)&&(this.moveStartSourceIds=[])},this.handleMoveStart=e=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(e)},this.handleTopMoveStart=e=>{if(!kn(e))return;const t=Sn(e);t&&(Tn(e)&&(this.lastTargetTouchFallback=e.targetTouches[0]),this._mouseClientOffset=t),this.waitingForDelay=!1},this.handleTopMoveStartDelay=e=>{if(!kn(e))return;const t=e.type===Cn.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,e),t),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(e,t)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(t)},this.handleTopMove=e=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:t,dragOverTargetIds:n}=this,r=this.options.enableHoverOutsideTarget,i=Sn(e,this.lastTargetTouchFallback);if(!i)return;if(this._isScrolling||!this.monitor.isDragging()&&function(e,t,n,r,i){if(!i)return!1;const s=180*Math.atan2(r-t,n-e)/Math.PI+180;for(let a=0;a<i.length;++a){const e=i[a];if(e&&(null==e.start||s>=e.start)&&(null==e.end||s<=e.end))return!0}return!1}(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,i.x,i.y,this.options.scrollAngleRanges))return void(this._isScrolling=!0);var s,a,o,l;if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&t&&(s=this._mouseClientOffset.x||0,a=this._mouseClientOffset.y||0,o=i.x,l=i.y,Math.sqrt(Math.pow(Math.abs(o-s),2)+Math.pow(Math.abs(l-a),2))>(this.options.touchSlop?this.options.touchSlop:0))&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(t,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const c=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(c),this.actions.publishDragSource(),e.cancelable&&e.preventDefault();const d=(n||[]).map(e=>this.targetNodes.get(e)).filter(e=>!!e),u=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(i.x,i.y,d):this.document.elementsFromPoint(i.x,i.y),h=[];for(const g in u){if(!u.hasOwnProperty(g))continue;let e=u[g];for(null!=e&&h.push(e);e;)e=e.parentElement,e&&-1===h.indexOf(e)&&h.push(e)}const p=h.filter(e=>d.indexOf(e)>-1).map(e=>this._getDropTargetId(e)).filter(e=>!!e).filter((e,t,n)=>n.indexOf(e)===t);if(r)for(const g in this.targetNodes){const e=this.targetNodes.get(g);if(c&&e&&e.contains(c)&&-1===p.indexOf(g)){p.unshift(g);break}}p.reverse(),this.actions.hover(p,{clientOffset:i})},this._getDropTargetId=e=>{const t=this.targetNodes.keys();let n=t.next();for(;!1===n.done;){const r=n.value;if(e===this.targetNodes.get(r))return r;n=t.next()}},this.handleTopMoveEndCapture=e=>{this._isScrolling=!1,this.lastTargetTouchFallback=void 0,function(e){return void 0===e.buttons||0===(e.buttons&vn)}(e)&&(this.monitor.isDragging()&&!this.monitor.didDrop()?(e.cancelable&&e.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()):this.moveStartSourceIds=void 0)},this.handleCancelOnEscape=e=>{"Escape"===e.key&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new In(n,t),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(fn.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(fn.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(fn.keyboard)}}const En=bt("touchstart",e=>{const t=e;return null!==t.touches&&void 0!==t.touches}),Pn=(bt("dragstart",e=>-1!==e.type.indexOf("drag")||-1!==e.type.indexOf("drop")),bt("mousedown",e=>-1===e.type.indexOf("touch")&&-1!==e.type.indexOf("mouse")),{backends:[{id:"html5",backend:function(e,t,n){return new gn(e,t,n)},transition:bt("pointerdown",e=>"mouse"==e.pointerType)},{id:"touch",backend:function(e){return new Dn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})},options:{enableMouseEvents:!0},preview:!0,transition:En}]});var wn=n(66783),xn=n(52195);const An=(0,wn.J9)(()=>(0,xn.Zq)("dndRoot",{height:"100%"}));let Fn;function Ln(e){return class extends a.Component{componentDidMount(){if(this.dndRootElementRef.current){(function(e){var t,n;return null!==(t=null===(n=e.parentElement)||void 0===n?void 0:n.closest(".dndRoot"))&&void 0!==t?t:null})(this.dndRootElementRef.current)?this.setState({isSubDnDRootElement:!0}):this.setState({loopDndBackendOptions:{rootElement:this.dndRootElementRef.current}})}}render(){if(o.B.clientType===l.s.Loop||o.B.clientType===l.s.SharepointApp||o.B.clientType===l.s.Webpart){const{isSubDnDRootElement:t,loopDndBackendOptions:n}=this.state;return a.createElement("div",{className:An(),ref:this.dndRootElementRef},t?a.createElement(e,(0,s.A)((0,s.A)({},this.props),{},{ref:(0,St.Yy)(e)?this.ref:null})):n&&a.createElement(Ge,{backend:Tt,context:this.dndContext,options:n},a.createElement(e,(0,s.A)((0,s.A)({},this.props),{},{ref:(0,St.Yy)(e)?this.ref:null}))))}return a.createElement(Ge,{backend:Zt,options:(Fn||(Fn=Pn,Fn.backends[0].transition=bt("mousedown",e=>!(!e.type||-1!==e.type.indexOf("touch")||-1===e.type.indexOf("mouse"))&&(o.B.DndBackend="Html5",!0)),Fn.backends[1].transition=bt("touchstart",e=>null!=e.touches&&(o.B.DndBackend="Touch",!0))),Fn)},a.createElement(e,(0,s.A)((0,s.A)({},this.props),{},{ref:(0,St.Yy)(e)?this.ref:null})))}constructor(e){super(e),this.dndContext={clearTimeout:e=>window.clearTimeout(e)},this.ref=a.createRef(),this.dndRootElementRef=a.createRef(),this.state={}}}}},49602:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{groupId:this.groupId}}constructor(e,t,n){super(i.actionType),this.groupId=e,this.folderId=t,this.driveItems=n}}i.actionType="PLW_GET_GROUPDOCUMENTSINFOLDER_SUCCEEDED"},49634:(e,t,n)=>{"use strict";n.d(t,{D:()=>o});var r=n(65043),i=n(79969),s=n(22751),a=n(4398);var o=function(){var e=r.useContext(a.D),t=(0,i.m)(["theme"]).theme;return e||t||(0,s.a)({})}},49874:(e,t,n)=>{var r=n(53871),i=n(99140);e.exports=function(e,t,n){return e&&e.length?(t=n||void 0===t?1:i(t),r(e,0,t<0?0:t)):[]}},50046:(e,t,n)=>{var r=n(76272);e.exports=function(e){return r(e)?e:[]}},51676:(e,t,n)=>{"use strict";n.d(t,{z:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r,s){super(i.actionType,n,r,s),this.groupId=e,this.itemUrl=t}}i.actionType="PLW_GET_DRIVE_ITEM_THUMBNAIL_FAILED"},51710:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.planId=e}}i.actionType="PLW_DELETE_PLAN"},51948:(e,t,n)=>{"use strict";var r;n.d(t,{F:()=>r}),function(e){e.Accept="Accept",e.AddEvent="AddEvent",e.AddFriend="AddFriend",e.Attach="Attach",e.Blocked="Blocked",e.Camera="Camera",e.Cancel="Cancel",e.Check="CheckMark",e.ChevronDownMed="ChevronDownMed",e.ChevronDownSmall="ChevronDownSmall",e.ChevronLeftMed="ChevronLeftMed",e.ChevronLeftSmall="ChevronLeftSmall",e.ChevronRightMed="ChevronRightMed",e.ChevronRightSmall="ChevronRightSmall",e.ChevronUpMed="ChevronUpMed",e.ChevronUpSmall="ChevronUpSmall",e.ChromeClose="ChromeClose",e.Clear="Clear",e.ClearFilter="ClearFilter",e.Completed="Completed",e.Copy="Copy",e.Cut="Cut",e.DateTime2="DateTime2",e.Delete="Trash",e.Document="Document",e.Down="Down",e.Diamond="Diamond",e.Edit="Edit",e.Emoji2="Emoji2",e.Error="Error",e.ErrorBadge="ErrorBadge",e.ExcelLogo="ExcelLogo",e.FabricOpenFolderHorizontal="FabricOpenFolderHorizontal",e.FavoriteStar="FavoriteStar",e.Filter="Filter",e.Folder="FabricFolder",e.Group="Group",e.Important="Important",e.Indent="IncreaseIndentLegacy",e.Info="Info",e.InsertRowsAbove="InsertRowsAbove",e.Link="Link",e.LocationDot="LocationDot",e.OneNoteLogo="OneNoteLogo",e.OpenPane="OpenPane",e.OpenPaneMirrored="OpenPaneMirrored",e.Outdent="DecreaseIndentLegacy",e.PaddingLeft="PaddingLeft",e.PaddingRight="PaddingRight",e.Paste="Paste",e.PDF="pdf",e.People="People",e.PeopleAdd="PeopleAdd",e.Photo="Photo2",e.PlugConnected="PlugConnected",e.Plus="Add",e.PowerPointLogo="PowerPointLogo",e.ProgressLoopOuter="ProgressLoopOuter",e.ProjectLogo="ProjectLogo32",e.PublicCalendar="PublicCalendar",e.Refresh="Refresh",e.Remove="Remove",e.RemoveLink="RemoveLink",e.Rename="Rename",e.ReplyMirrored="ReplyMirrored",e.RevToggleKey="RevToggleKey",e.Ringer="Ringer",e.RingerSolid="RingerSolid",e.Search="Search",e.SeeAll="ShowResults",e.Settings="Settings",e.SharepointLogo="SharepointLogo",e.StatusCircleBlock2="StatusCircleBlock2",e.StatusCircleCheckmark="StatusCircleCheckmark",e.StatusCircleExclamation="StatusCircleExclamation",e.TimelineProgress="TimelineProgress",e.Unfavorite="Unfavorite",e.Up="Up",e.VisioLogo="VisioLogo",e.Warning="Warning",e.WordLogo="WordLogo",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut"}(r||(r={}))},53211:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.planId=e}}i.actionType="PLW_FETCH_PLAN"},53443:(e,t,n)=>{"use strict";var r;n.d(t,{U:()=>r}),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.Purge=3]="Purge",e[e.Undelete=4]="Undelete"}(r||(r={}))},53672:(e,t,n)=>{"use strict";n.d(t,{n:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{toastId:this.toastId}}constructor(e){super(i.actionType),this.toastId=e}}i.actionType="DISMISS_TOAST_NOTIFICATION"},53734:(e,t,n)=>{"use strict";n.d(t,{g:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.bucket.id}}constructor(e){super(i.actionType),this.bucket=e}}i.actionType="PLW_GET_BUCKET_SUCCEEDED"},54205:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.planEntitySet=e}}i.actionType="PLW_CREATE_PLAN"},54456:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{vroomId:this.vroomId}}constructor(e,t){super(i.actionType),this.vroomId=e,this.driveItem=t}}i.actionType="PLW_GET_DRIVE_ITEM_SUCCEEDED"},55637:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.container=e}}i.actionType="PLW_UPDATE_CONTAINER_SUCCESS"},55694:(e,t,n)=>{"use strict";n.d(t,{p:()=>a});var r=n(75992),i=n(78332),s=n(62687);class a extends r.r{loggingData(){return{accessContext:String(s.t[this.accessContext]),taskGrouping:String(i.Yc[this.taskGrouping]),currentPage:this.currentPage}}constructor(e,t,n){super(a.actionType),this.accessContext=e,this.taskGrouping=t,this.currentPage=n}}a.actionType="SET_TASK_GROUPING"},56956:(e,t,n)=>{var r=n(38541),i=n(28189),s=n(76372),a=n(39115),o=n(41069),l=n(10143);e.exports=function(e,t,n){if((e=o(e))&&(n||void 0===t))return e.slice(0,l(e)+1);if(!e||!(t=r(t)))return e;var c=a(e),d=s(c,a(t))+1;return i(c,0,d).join("")}},58355:(e,t,n)=>{"use strict";n.d(t,{D:()=>a});var r=n(75992),i=n(86178),s=n.n(i);class a extends r.r{loggingData(){let e=0;for(const t of this.permissionsSets)t.expiry.isBefore(s()())&&e++;return{numPermissionsFetched:this.permissionsSets.length.toString(),numExpiredPermissionsFetched:e.toString()}}constructor(e){if(super(a.actionType),this.permissionsSets=e,this.permissionsSets.length<1)throw new Error("Permissions set has less than 1 entry")}}a.actionType="PLW_BATCH_GET_CONTAINER_PERMISSIONS_SUCCEEDED"},59640:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(75992);class i extends r.r{constructor(e,t){super(i.actionType),this.entityId=e,this.seen=t}}i.actionType="AUGLOOP_FILE_SUG_SEEN"},60878:(e,t,n)=>{"use strict";n.d(t,{L:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.container=e}}i.actionType="PLW_GET_CONTAINER_SUCCESS"},61460:(e,t,n)=>{var r=n(50149),i=n(8820),s=n(55647),a=n(50046),o=s(function(e){var t=r(e,a);return t.length&&t[0]===e[0]?i(t):[]});e.exports=o},61804:(e,t,n)=>{"use strict";n.d(t,{M:()=>r});var r=(0,n(65043).createContext)({dragDropManager:void 0})},62076:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,t,n,r),this.planEntitySet=e}}i.actionType="PLW_CREATE_PLAN_FAILED"},63148:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(75992);class i extends r.r{constructor(e,t){super(i.actionType),this.planId=e,this.planMoveData=t}}i.actionType="PLW_MOVE_PLAN_STATUS_UPDATE"},65006:(e,t,n)=>{"use strict";n.d(t,{Lx:()=>s,cJ:()=>a});var r=n(97002),i=n(66151);const s={"h1, h2, h3, h4, h5, h6":{margin:"0",fontWeight:"normal",display:"inline"},ul:{margin:"0",padding:"0"},li:{listStyleType:"none"}},a=e=>(0,r.Z)({":global(.plannerApp, .teamsApp, .sharepointApp, .webpartApp, .noAccessErrorPage, .plannerAppDialog, .plannerAppCallout)":{a:[(0,i.BP)(e)]},":global(::-webkit-scrollbar-thumb)":[(0,i.IB)(e),{borderRadius:i.XR}]})},65060:(e,t,n)=>{"use strict";n.d(t,{d:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r,s,a){super(i.actionType,r,s,a),this.groupId=e,this.threadId=t,this.newPost=n}}i.actionType="PLW_POSTREPLY_CONVERSATIONTHREAD_FAILED"},65172:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r,s){super(i.actionType,e,t,n),this.taskId=r,this.formId=s}}i.actionType="PLW_GET_FORM_RESPONSE_FAILED"},65980:(e,t,n)=>{"use strict";n.d(t,{u:()=>s});var r=n(75992),i=n(77508);class s extends r.r{loggingData(){return{walkthroughType:i.hs[this.walkthroughType],stepNumber:String(this.stepNumber)}}constructor(e,t){super(s.actionType),this.walkthroughType=e,this.stepNumber=t}}s.actionType="PLW_SKIP_WALKTHROUGH"},67188:(e,t,n)=>{"use strict";var r,i,s,a;n.d(t,{HX:()=>r,eN:()=>s}),function(e){e.noAccess="noAccess",e.readOnly="readOnly",e.restrictedReadWrite="restrictedReadWrite",e.readWrite="readWrite"}(r||(r={})),function(e){e.none="none",e.noModProjLicenseInTenant="noModProjLicenseInTenant",e.noRoadmapLicenseInTenant="noRoadmapLicenseInTenant",e.p1ProjectOnlineEssentials="p1ProjectOnlineEssentials"}(i||(i={})),function(e){e.basic="basic",e.basicPlus="basicPlus",e.standard="standard",e.professional="professional",e.premium="premium"}(s||(s={})),function(e){e.commercial="Commercial",e.commercialEducation="Commercial Education"}(a||(a={}));var o;!function(e){e.roadmap="roadmap",e.premiumPlan="premiumPlan",e.projectOnline="projectOnline",e.projectOperations="projectOperations"}(o||(o={}))},67578:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,e,t,n),this.timestamp=r}}i.actionType="PLW_GET_DIFFSYNCFEED_FAILED"},69632:(e,t,n)=>{"use strict";n.d(t,{f:()=>a});var r=n(75992),i=n(86178),s=n.n(i);class a extends r.r{loggingData(){let e=0;for(const t of this.taskPermissionsSets)t.expiry.isBefore(s()())&&e++;return{numTaskPermissionsFetched:this.taskPermissionsSets.length.toString(),numTaskExpiredPermissionsFetched:e.toString()}}constructor(e){if(super(a.actionType),this.taskPermissionsSets=e,this.taskPermissionsSets.length<1)throw new Error("Task Permissions set has less than 1 entry")}}a.actionType="PLW_BATCH_GET_TASK_PERMISSIONS_SUCCEEDED"},70375:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,t,n,r),this.taskId=e}}i.actionType="AUGLOOP_FETCH_FILE_SUG_FAILED"},70515:(e,t,n)=>{"use strict";n.d(t,{r:()=>i});var r=n(75992);class i extends r.r{constructor(){super(i.actionType)}}i.actionType="PLW_DISABLE_DIFFSYNC"},70596:(e,t,n)=>{"use strict";n.d(t,{Tk:()=>m,ZG:()=>h,Zz:()=>p,gK:()=>u});var r=n(52195),i=n(8736),s=n(77508),a=n(56415),o=n(66151),l=n(66783),c=n(65006),d=n(25420);const u={top:"0px",bottom:"0px",right:"0px",left:"0px",fontSize:r.s.mediumPlus},h=e=>({bottom:"0px",width:"100%",zIndex:i.B.ErrorBarZIndex,["".concat(e,".hidden")]:{display:"none"}}),p=(0,l.J9)(e=>({root:{marginTop:"48px"},circle:(0,o.Z_)(e),label:(0,o.aS)(e)})),g=(0,l.J9)(e=>((0,c.cJ)(e),[(0,d.gS)("column"),e===s.Sx.Dark&&{backgroundColor:a.z.DarkThemeAppBackgroundColor},e===s.Sx.Light&&{backgroundColor:a.z.White},{position:"absolute",inset:0,"> .suiteNav":[(0,d.$Z)(i.B.SuiteNavHeight),{background:a.z.Black}],"> .suiteNav.hidden":{display:"none"}}])),m=(0,l.J9)(e=>(0,r.Zq)("globalErrorPage",[g(e),(0,o.NX)(e)]))},70768:(e,t,n)=>{"use strict";n.d(t,{E:()=>o});var r=n(65043),i=n(16112),s=n(9850),a=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.name=function(){return"ScreenReaderOnly"},t.prototype.renderComponent=function(){var e=this.getClassNames();return r.createElement("div",{className:e.root},this.props.children)},t.prototype.getClassNames=function(){return(0,s.Z)((0,s.$)(this.props.styles))},t}(i.$)},71484:(e,t,n)=>{"use strict";n.d(t,{K:()=>r});var r={accdb:{extensions:["accdb","mdb"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{extensions:["aif","aiff","aac","alac","amr","ape","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},calendar:{extensions:["ical","icalendar","ics","ifb","vcs"]},classifier:{extensions:["classifier"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","cbl","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hcp","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsproj","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},contact:{extensions:["vcf"]},csv:{extensions:["csv"]},desktopfolder:{},docset:{},documentsfolder:{},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","oft","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},favoritesfolder:{},folder:{},font:{extensions:["ttf","otf","woff"]},form:{},genericfile:{},html:{extensions:["htm","html","mht"]},ipynb:{extensions:["nnb","ipynb"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},listitem:{},loop:{extensions:["fluid","loop"]},officescript:{extensions:["osts"]},splist:{},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mcworld","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["note","one"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pbiapp:{},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dic","dicm","dcm","dcm30","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","jxr","kdc","mrw","nef","orf","pct","pict","png","pns","psb","psd","raw","tga","tif","tiff","wdp"]},photo360:{},picturesfolder:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbids","pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers","tsv"]},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},playlist:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","ait","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indl","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},whiteboard:{extensions:["whiteboard","wbtx"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx","xlw"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}}},71794:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.planEntitySet=e}}i.actionType="PLW_FETCH_PLAN_SUCCEEDED"},72261:(e,t,n)=>{"use strict";n.d(t,{c:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{groupNameValidationErrorCode:this.errorCode.toString()}}constructor(e){super(i.actionType),this.errorCode=e}}i.actionType="PLW_GROUPNAMESVALIDATION_SUCCEEDED"},72749:(e,t,n)=>{var r=n(48895),i=n(80755),s=n(91980),a=n(54052);e.exports=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],o=e;o--;)t[o-1]=arguments[o];return r(a(n)?s(n):[n],i(t,1))}},73360:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,e,t,n),this.vroomId=r}}i.actionType="PLW_GET_DRIVE_ITEM_FAILURE"},73438:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n){super(i.actionType,e,t,n)}}i.actionType="PLW_GET_SENSITIVITYPOLICYSETTINGS_FAILED"},73615:(e,t,n)=>{"use strict";n.d(t,{U:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,t,n,r),this.planId=e}}i.actionType="PLW_DELETE_PLAN_FAILED"},75559:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ComponentErrorPage:()=>T});var r=n(93589),i=n(42463),s=n(56415),a=n(77508),o=n(52195),l=n(66783),c=n(66151);const d=(0,l.J9)(e=>{let t;switch(e){case a.Sx.LoopLight:t={border:"1px solid ".concat(s.z.LoopLightErrorBannerBorder),backgroundColor:s.z.LoopLightErrorBannerBackground};break;case a.Sx.LoopDark:t={border:"1px solid ".concat(s.z.LoopDarkErrorBanner),backgroundColor:s.z.LoopDarkErrorBannerBackground}}return t}),u=(0,l.J9)((e,t)=>{const n=[d(e),{alignItems:"center",height:"40px",padding:"2px 4px"}],r=[h(e),{".errorMessageTitle":{fontSize:o.s.medium,fontWeight:o.BO.semibold}}],i={root:{marginTop:"20px"},content:n,icon:h(e),iconContainer:{"> .plannerIcon":{display:"flex"}},innerText:r};return(0,o.TW)(i,t)}),h=(0,l.J9)(e=>{let t="";switch(e){case a.Sx.LoopLight:t=s.z.LoopLightErrorBannerText;break;case a.Sx.LoopDark:t=s.z.LoopDarkErrorBanner}return{color:t}}),p=(0,l.J9)(e=>{let t;switch(e){case a.Sx.LoopLight:t={border:"1px solid ".concat(s.z.NeutralLightGrey82),backgroundColor:s.z.White,color:s.z.NeutralLightGrey14};break;case a.Sx.LoopDark:t={border:"1px solid ".concat(s.z.NeutralDarkGrey40),backgroundColor:s.z.NeutralDarkGrey16,color:s.z.White}}return t});var g=n(89379),m=n(65804),f=n(59846),v=n(65043);const y=(0,g.Z)(),k=v.forwardRef((e,t)=>{let{reloadCallback:n,styles:s,theme:a,errorMessageTitle:o,errorMessageBody:l,reloadButtonText:c,isReloadButtonDisplayed:d,customMessageBarStyles:h}=e;const p=y(s,{theme:a}),g=v.createElement("div",{className:p.errorMessageTitle},o),m=v.createElement("div",{className:p.errorMessageBody},l),k=v.createElement("button",{className:p.reloadButton,onClick:n},c);return v.createElement("div",{className:p.root,ref:t},v.createElement(r.n,{messageBarType:i.H.error,isMultiline:!1,messageBarIconProps:f.qq,actions:d?k:void 0,styles:u(a,h)},g),m)}),T=(0,m.I)(k,e=>{let{theme:t}=e;return{root:["loopErrorPageContent",(0,c.aS)(t),(0,c.NX)(t),{height:"100%"}],errorMessageTitle:["errorMessageTitle",{fontSize:o.s.xLarge,fontFamily:"Segoe UI"}],errorMessageBody:["errorMessageBody",(0,c.aS)(t),{margin:"24px",fontSize:o.s.medium,fontWeight:o.BO.regular,fontFamily:"Segoe UI"}],reloadButton:["reloadButton",p(t),{cursor:"pointer",borderRadius:"4px",padding:"5px 8px"}]}})},75886:(e,t,n)=>{"use strict";var r;function i(e,t){return 0!==(e&t)}n.d(t,{c:()=>i,j:()=>r}),function(e){e[e.DisableNone=0]="DisableNone",e[e.DisableCheckedStateToggling=1]="DisableCheckedStateToggling",e[e.DisableReorder=2]="DisableReorder",e[e.DisableEditTitle=4]="DisableEditTitle",e[e.DisablePromote=8]="DisablePromote",e[e.DisableDelete=16]="DisableDelete",e[e.DisableCreate=32]="DisableCreate",e[e.DisableAll=63]="DisableAll"}(r||(r={}))},75913:(e,t,n)=>{"use strict";n.d(t,{C:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{recommendedDocumentPlanCount:String(this.plans.length)}}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(i.actionType),this.userId=e,this.plans=t,this.isFirstPage=n}}i.actionType="PLW_GET_RECOMMENDEDOCUMENTPLANS_SUCCEEDED"},76241:(e,t,n)=>{"use strict";var r;n.d(t,{X:()=>r}),function(e){e[e.Public=0]="Public",e[e.Private=1]="Private",e[e.HiddenMembership=2]="HiddenMembership"}(r||(r={}))},77910:(e,t,n)=>{"use strict";n.d(t,{O:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{viewKey:this.viewKey,filterCount:String(this.filter.filterCount)}}constructor(e,t){super(i.actionType),this.viewKey=e,this.filter=t}}i.actionType="SET_TASK_FILTER"},78751:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,t,n,r),this.unifiedGroupId=e}}i.actionType="PLW_DELETE_UNIFIEDGROUP_FAILED"},79387:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.details.id}}constructor(e){super(i.actionType),this.details=e}}i.actionType="PLW_DIFFSYNC_UPDATE_PLAN_DETAILS"},79670:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{localId:this.localId,id:this.bucket.id}}constructor(e,t){super(i.actionType),this.bucket=e,this.localId=t}}i.actionType="PLW_CREATE_BUCKET_SUCCEEDED"},79889:(e,t,n)=>{var r=n(93950),i=n(46686);e.exports=function(e,t,n){var s=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(n)&&(s="leading"in n?!!n.leading:s,a="trailing"in n?!!n.trailing:a),r(e,t,{leading:s,maxWait:t,trailing:a})}},80332:(e,t,n)=>{"use strict";n.d(t,{a:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n){super(i.actionType,e,t,n)}}i.actionType="PLW_GET_TENANTGROUPSETTINGS_FAILED"},80837:(e,t,n)=>{"use strict";n.d(t,{_:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{isCollapsed:String(this.isCollapsed)}}constructor(e,t,n){super(i.actionType),this.accessContext=e,this.isCollapsed=t,this.contextEntityId=n}}i.actionType="PLW_SET_CATEGORYLABEL_MODE"},81376:(e,t,n)=>{"use strict";n.d(t,{$:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r){super(i.actionType,e,t,n),this.session=r}}i.actionType="PLW_UPLOAD_BYTES_TO_SESSION_FAILED"},81576:(e,t,n)=>{"use strict";n.d(t,{R:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.rejectedEquivalenceSetIds=e}}i.actionType="PLW_BATCH_GET_TASK_PERMISSIONS_FAILED"},84824:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{sessionId:this.sessionId}}constructor(e){super(i.actionType),this.sessionId=e}}i.actionType="PLW_CANCEL_UPLOAD_SESSION_SUCCEEDED"},84945:(e,t,n)=>{"use strict";function r(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var a=0;(s=new Error(t.replace(/%s/g,function(){return r[a++]}))).name="Invariant Violation"}throw s.framesToPop=1,s}}n.d(t,{V:()=>r})},85230:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n,r,s,a){super(i.actionType,e,t,n),this.session=r,this.taskId=s,this.updateKey=a}}i.actionType="PLW_UPLOAD_SESSION_FAILED"},87337:(e,t,n)=>{"use strict";n.d(t,{s:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.container=e}}i.actionType="PLW_DELETE_UNIFIEDGROUP_SUCCEEDED"},87450:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.bucket.id,updateKey:this.updateKey}}constructor(e,t){super(i.actionType),this.bucket=e,this.updateKey=t}}i.actionType="PLW_UPDATE_BUCKET"},88080:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(25324);class i extends r.l{constructor(e,t,n,r,s,a,o){super(i.actionType,e,t,n,r,a,s,o)}}i.actionType="SHOW_SUCCESS_NOTIFICATION"},88457:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(65818),i=n(64836);class s extends i.m{constructor(e,t,n){super({externalId:e,containerType:r.K.Group},t.displayName),this.unifiedGroup=t,this.unifiedGroupDetails=n}}},89190:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});var r=n(75992);class i extends r.r{constructor(e,t){super(i.actionType),this.updatedPlanEntitySet=e,this.updateKey=t}}i.actionType="PLW_UPDATE_PLANENTITYSET_SUCCEEDED"},90548:(e,t,n)=>{"use strict";n.d(t,{h:()=>i});var r=n(75992);class i extends r.r{constructor(e,t,n){super(i.actionType),this.taskId=e,this.formId=t,this.formResponse=n}}i.actionType="PLW_GET_FORM_RESPONSE_SUCCEEDED"},91393:(e,t,n)=>{"use strict";n.d(t,{p:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.taskDetails.id}}constructor(e){super(i.actionType),this.taskDetails=e}}i.actionType="PLW_DIFFSYNC_INSERT_TASK_DETAILS"},92296:(e,t,n)=>{"use strict";n.d(t,{E:()=>i});var r=n(32512);class i extends r.v{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";super(i.actionType,e,t,n)}}i.actionType="PLW_GET_TENANTFEEDBACKSETTINGS_FAILED"},92446:(e,t,n)=>{"use strict";n.d(t,{f:()=>i});var r=n(32512);class i extends r.v{constructor(e,t,n){super(i.actionType,e,t,n)}}i.actionType="GET_SUITENAV_FAILED"},93407:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{favoritePlanCount:String(this.plans.length)}}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];super(i.actionType),this.userId=e,this.plans=t,this.isFirstPage=n}}i.actionType="PLW_GET_FAVORITEPLANSFORUSER_SUCCEEDED"},93589:(e,t,n)=>{"use strict";n.d(t,{n:()=>F});var r,i=n(65804),s=n(56851),a=n(65043),o=n(89379),l=n(17066),c=n(4648),d=n(28553),u=n(13706),h=n(20751),p=n(42463),g=n(73172),m=n(15199),f=((r={})[p.H.info]="Info",r[p.H.warning]="Info",r[p.H.error]="ErrorBadge",r[p.H.blocked]="Blocked2",r[p.H.severeWarning]="Warning",r[p.H.success]="Completed",r),v=(0,o.Z)(),y=function(e){switch(e){case p.H.blocked:case p.H.error:case p.H.severeWarning:return"assertive"}return"polite"},k=function(e){switch(e){case p.H.blocked:case p.H.error:case p.H.severeWarning:return"alert"}return"status"},T=a.forwardRef(function(e,t){var n=(0,g.C)(!1),r=n[0],i=n[1].toggle,o=(0,m.B)("MessageBar"),T=e.actions,S=e.className,b=e.children,I=e.overflowButtonAriaLabel,C=e.dismissIconProps,D=e.styles,E=e.theme,P=e.messageBarType,w=void 0===P?p.H.info:P,x=e.onDismiss,A=void 0===x?void 0:x,F=e.isMultiline,L=void 0===F||F,_=e.truncated,U=e.dismissButtonAriaLabel,O=e.messageBarIconProps,B=e.role,M=e.delayedRender,N=void 0===M||M,R=e.expandButtonProps,G=e.onExpandButtonToggled,W=void 0===G?void 0:G,z=e.showExpandButton,j=a.useCallback(function(){i(),W&&W(!r)},[r,W,i]),K=(0,l.G1)(e,l.vt,["className","role"]),H=v(D,{theme:E,messageBarType:w||p.H.info,onDismiss:void 0!==A,actions:void 0!==T,truncated:_,isMultiline:L,expandSingleLine:r,className:S}),V={iconName:r?"DoubleChevronUp":"DoubleChevronDown"},Z=T||A?{"aria-describedby":o,role:"region"}:{},q=T?a.createElement("div",{className:H.actions},T):null,Y=A?a.createElement(u.K,{disabled:!1,className:H.dismissal,onClick:A,iconProps:C||{iconName:"Clear"},title:U,ariaLabel:U}):null;return a.createElement("div",(0,s.__assign)({ref:t,className:H.root},Z),a.createElement("div",{className:H.content},a.createElement("div",{className:H.iconContainer,"aria-hidden":!0},O?a.createElement(h.I,(0,s.__assign)({},O,{className:(0,c.A)(H.icon,O.className)})):a.createElement(h.I,{iconName:f[w],className:H.icon})),a.createElement("div",{className:H.text,id:o,role:B||k(w),"aria-live":y(w)},a.createElement("span",(0,s.__assign)({className:H.innerText},K),N?a.createElement(d.P,null,a.createElement("span",null,b)):a.createElement("span",null,b))),(z||!L&&!q&&_)&&a.createElement("div",{className:H.expandSingleLine},a.createElement(u.K,(0,s.__assign)({disabled:!1,className:H.expand,onClick:j,iconProps:V,ariaLabel:I,"aria-expanded":r},R))),!L&&q,!L&&Y&&a.createElement("div",{className:H.dismissSingleLine},Y),L&&Y),L&&q)});T.displayName="MessageBar";var S,b,I,C,D=n(52195),E={root:"ms-MessageBar",error:"ms-MessageBar--error",blocked:"ms-MessageBar--blocked",severeWarning:"ms-MessageBar--severeWarning",success:"ms-MessageBar--success",warning:"ms-MessageBar--warning",multiline:"ms-MessageBar-multiline",singleline:"ms-MessageBar-singleline",dismissalSingleLine:"ms-MessageBar-dismissalSingleLine",expandingSingleLine:"ms-MessageBar-expandingSingleLine",content:"ms-MessageBar-content",iconContainer:"ms-MessageBar-icon",text:"ms-MessageBar-text",innerText:"ms-MessageBar-innerText",dismissSingleLine:"ms-MessageBar-dismissSingleLine",expandSingleLine:"ms-MessageBar-expandSingleLine",dismissal:"ms-MessageBar-dismissal",expand:"ms-MessageBar-expand",actions:"ms-MessageBar-actions",actionsSingleline:"ms-MessageBar-actionsSingleLine"},P=((S={})[p.H.error]="errorBackground",S[p.H.blocked]="errorBackground",S[p.H.success]="successBackground",S[p.H.warning]="warningBackground",S[p.H.severeWarning]="severeWarningBackground",S[p.H.info]="infoBackground",S),w=((b={})[p.H.error]="errorIcon",b[p.H.blocked]="errorIcon",b[p.H.success]="successIcon",b[p.H.warning]="warningIcon",b[p.H.severeWarning]="severeWarningIcon",b[p.H.info]="infoIcon",b),x=((I={})[p.H.error]="#ff0000",I[p.H.blocked]="#ff0000",I[p.H.success]="#bad80a",I[p.H.warning]="#fff100",I[p.H.severeWarning]="#ff0000",I[p.H.info]="WindowText",I),A=((C={})[p.H.error]="#e81123",C[p.H.blocked]="#e81123",C[p.H.success]="#107c10",C[p.H.warning]="#966400",C[p.H.severeWarning]="#d83b01",C[p.H.info]="WindowText",C),F=(0,i.I)(T,function(e){var t,n,r,i,a,o,l,c,d,u,h,g=e.theme,m=e.className,f=e.onDismiss,v=e.truncated,y=e.isMultiline,k=e.expandSingleLine,T=e.messageBarType,S=void 0===T?p.H.info:T,b=g.semanticColors,I=g.fonts,C=(0,D.L6)(0,D.iD),F=(0,D.Km)(E,g),L={fontSize:D.fF.xSmall,height:10,lineHeight:"10px",color:b.messageText,selectors:(t={},t[D.up]=(0,s.__assign)((0,s.__assign)({},(0,D.Qg)()),{color:"WindowText"}),t)},_=[(0,D.gm)(g,{inset:1,highContrastStyle:{outlineOffset:"-6px",outline:"1px solid Highlight"},borderColor:"transparent"}),{flexShrink:0,width:32,height:32,padding:"8px 12px",selectors:{"& .ms-Button-icon":L,":hover":{backgroundColor:"transparent"},":active":{backgroundColor:"transparent"}}}];return{root:[F.root,I.medium,S===p.H.error&&F.error,S===p.H.blocked&&F.blocked,S===p.H.severeWarning&&F.severeWarning,S===p.H.success&&F.success,S===p.H.warning&&F.warning,y?F.multiline:F.singleline,!y&&f&&F.dismissalSingleLine,!y&&v&&F.expandingSingleLine,{background:b[P[S]],boxSizing:"border-box",color:b.messageText,minHeight:32,width:"100%",display:"flex",wordBreak:"break-word",selectors:(n={".ms-Link":{color:b.messageLink,selectors:{":hover":{color:b.messageLinkHovered}}}},n[D.up]=(0,s.__assign)((0,s.__assign)({},(0,D.Qg)()),{background:"transparent",border:"1px solid ".concat(x[S]),color:"WindowText"}),n[D.hT]={border:"1px solid ".concat(A[S])},n)},y&&{flexDirection:"column"},m],content:[F.content,(r={display:"flex",width:"100%",lineHeight:"normal"},r[C]={display:"grid",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto",gridTemplateAreas:'\n            "icon text close"\n            "action action action"\n          '},r)],iconContainer:[F.iconContainer,(i={fontSize:D.fF.medium,minWidth:16,minHeight:16,display:"flex",flexShrink:0,margin:"8px 0 8px 12px"},i[C]={gridArea:"icon"},i)],icon:{color:b[w[S]],selectors:(a={},a[D.up]=(0,s.__assign)((0,s.__assign)({},(0,D.Qg)()),{color:"WindowText"}),a)},text:[F.text,(0,s.__assign)((0,s.__assign)({minWidth:0,display:"flex",flexGrow:1,margin:8},I.small),(o={},o[C]={gridArea:"text"},o.selectors=(l={},l[D.up]=(0,s.__assign)({},(0,D.Qg)()),l),o)),!f&&{marginRight:12}],innerText:[F.innerText,{lineHeight:16,selectors:{"& span a:last-child":{paddingLeft:4}}},v&&{overflow:"visible",whiteSpace:"pre-wrap"},!y&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},!y&&!v&&{selectors:(c={},c[C]={overflow:"visible",whiteSpace:"pre-wrap"},c)},k&&{overflow:"visible",whiteSpace:"pre-wrap"}],dismissSingleLine:[F.dismissSingleLine,(d={},d[C]={gridArea:"close"},d)],expandSingleLine:F.expandSingleLine,dismissal:[F.dismissal,_],expand:[F.expand,_],actions:[y?F.actions:F.actionsSingleline,(u={display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row-reverse",alignItems:"center",margin:"0 12px 0 8px",forcedColorAdjust:"auto",MsHighContrastAdjust:"auto"},u[C]={gridArea:"action",marginRight:8,marginBottom:8},u.selectors={"& button:nth-child(n+2)":(h={marginLeft:8},h[C]={marginBottom:0},h)},u),y&&{marginBottom:8},f&&!y&&{marginRight:0}]}},void 0,{scope:"MessageBar"})},93593:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i});var r=n(75992);class i extends r.r{constructor(e,t){super(i.actionType),this.planId=e,this.planContainer=t}}i.actionType="PLW_DELETE_PLAN_SUCCEEDED"},93940:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{cv:this.cv,logicalId:this.logicalId,traceId:this.fileSuggestions.fileResultReference.referenceId}}constructor(e,t,n,r){super(i.actionType),this.entityId=e,this.cv=t,this.logicalId=n,this.fileSuggestions=r}}i.actionType="AUGLOOP_FETCH_FILE_SUG_SUCCEEDED"},93950:(e,t,n)=>{var r=n(46686),i=n(4757),s=n(40801),a=Math.max,o=Math.min;e.exports=function(e,t,n){var l,c,d,u,h,p,g=0,m=!1,f=!1,v=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function y(t){var n=l,r=c;return l=c=void 0,g=t,u=e.apply(r,n)}function k(e){var n=e-p;return void 0===p||n>=t||n<0||f&&e-g>=d}function T(){var e=i();if(k(e))return S(e);h=setTimeout(T,function(e){var n=t-(e-p);return f?o(n,d-(e-g)):n}(e))}function S(e){return h=void 0,v&&l?y(e):(l=c=void 0,u)}function b(){var e=i(),n=k(e);if(l=arguments,c=this,p=e,n){if(void 0===h)return function(e){return g=e,h=setTimeout(T,t),m?y(e):u}(p);if(f)return clearTimeout(h),h=setTimeout(T,t),y(p)}return void 0===h&&(h=setTimeout(T,t)),u}return t=s(t)||0,r(n)&&(m=!!n.leading,d=(f="maxWait"in n)?a(s(n.maxWait)||0,t):d,v="trailing"in n?!!n.trailing:v),b.cancel=function(){void 0!==h&&clearTimeout(h),g=0,l=p=c=h=void 0},b.flush=function(){return void 0===h?u:S(i())},b}},94030:(e,t,n)=>{"use strict";var r;n.d(t,{n:()=>r}),function(e){e[e.UserTopAssignee=0]="UserTopAssignee",e[e.SimilarTaskTitle=1]="SimilarTaskTitle",e[e.MostAvailableUser=2]="MostAvailableUser",e[e.PlanTopAssignee=3]="PlanTopAssignee"}(r||(r={}))},94600:(e,t,n)=>{"use strict";n.d(t,{P:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.unifiedGroupDetails=e}}i.actionType="PLW_GET_UNIFIEDGROUPDETAILS_SUCCEEDED"},95201:(e,t,n)=>{"use strict";n.d(t,{S:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{sessionId:this.sessionId}}constructor(e){super(i.actionType),this.sessionId=e}}i.actionType="PLW_CANCEL_UPLOAD_SESSION"},96481:(e,t,n)=>{"use strict";n.d(t,{Do:()=>r,Pj:()=>i});const r=n(65043).createContext({openLinkCallback:e=>{window.open(e.url)},openLinkInNewWindow:!1}),i=r.Provider;r.Consumer},97792:(e,t,n)=>{"use strict";n.d(t,{x:()=>i});var r=n(75992);class i extends r.r{constructor(e){super(i.actionType),this.usageMode=e}}i.actionType="PLW_SET_USAGE_MODE"},98656:(e,t,n)=>{"use strict";n.d(t,{N:()=>w});var r=n(65043),i=n(4648),s=n(82014),a=n(49634),o=n(24718),l=n(63722),c=n(7666),d=n(19466),u=n(68417),h=0,p={reset:function(){l.nr.getInstance().onReset(function(){return h++})},getId:function(){return h},renderStyles:function(e,t){return(0,c.L)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return(0,d.n)(e)},renderKeyframes:function(e){return(0,u.i)(e)}};var g=function(e){var t=new Map,n=new Set,i=function(e){var r=e.currentTarget,s=r.__id__;t.delete(s),r.removeEventListener("unload",i),n.delete(s)};return function(l){void 0===l&&(l={});var c,d=l.theme,u=(0,s.ox)();u&&(u.__id__=u.__id__||(0,o.O)(),c=u.__id__,n.has(c)||(n.add(c),u.addEventListener("unload",i)));var h=(0,a.D)();d=d||h;var g=p.getId(),m=[c,g,d],f=function(e,t){var n,r,i,s=t[0],a=t[1],o=t[2];return null===(i=null===(r=null===(n=e.get(s))||void 0===n?void 0:n.get(a))||void 0===r?void 0:r.get(o))||void 0===i?void 0:i.classMap}(t,m);if(r.useEffect(function(){return function(e,t){var n,r,i=t[0],s=t[1],a=t[2],o=null===(r=null===(n=e.get(i))||void 0===n?void 0:n.get(s))||void 0===r?void 0:r.get(a);o&&o.refCount++}(t,[c,g,d]),function(){return function(e,t){var n,r,i,s,a,o,l,c,d=t[0],u=t[1],h=t[2],p=null===(r=null===(n=e.get(d))||void 0===n?void 0:n.get(u))||void 0===r?void 0:r.get(h);p&&(p.refCount--,0===p.refCount&&(null===(s=null===(i=e.get(d))||void 0===i?void 0:i.get(u))||void 0===s||s.delete(h),0===(null===(o=null===(a=e.get(d))||void 0===a?void 0:a.get(u))||void 0===o?void 0:o.size)&&(null===(l=e.get(d))||void 0===l||l.delete(u),0===(null===(c=e.get(d))||void 0===c?void 0:c.size)&&e.delete(d))))}(t,[c,g,d])}},[c,g,d]),!f){var v=function(e){return"function"===typeof e}(e)?e(d):e;f=p.renderStyles(v,{targetWindow:u,rtl:!!d.rtl}),function(e,t,n){var r,i,s=t[0],a=t[1],o=t[2],l=null!==(r=e.get(s))&&void 0!==r?r:new Map;e.set(s,l);var c=null!==(i=l.get(a))&&void 0!==i?i:new Map;l.set(a,c),c.set(o,{classMap:n,refCount:0})}(t,m,f)}return f}}(function(e){var t=e.semanticColors,n=e.fonts;return{body:[{color:t.bodyText,background:t.bodyBackground,fontFamily:n.medium.fontFamily,fontWeight:n.medium.fontWeight,fontSize:n.medium.fontSize,MozOsxFontSmoothing:n.medium.MozOsxFontSmoothing,WebkitFontSmoothing:n.medium.WebkitFontSmoothing}]}});function m(e){var t=g(e),n=e.className,a=e.applyTo;!function(e,t){var n,i="body"===e.applyTo,a=null===(n=(0,s.ZY)())||void 0===n?void 0:n.body;r.useEffect(function(){if(i&&a){for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&a.classList.add(r)}return function(){if(i&&a)for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&a.classList.remove(r)}}}},[i,a,t])}(e,[t.root,t.body]),e.className=(0,i.A)(n,t.root,"element"===a&&t.body)}var f=n(56851),v=n(22090),y=n(32824),k=n(23956),T=n(80173),S=n(4398),b=function(e){var t=e.customizerContext,n=e.ref,i=e.theme,s=e.as||"div",a="string"===typeof e.as?(0,v._)(e.as,e):e.as===r.Fragment?{children:e.children}:(0,y.cJ)(e,["as"]);return r.createElement(S.D.Provider,{value:i},r.createElement(k.z.Provider,{value:t},r.createElement(T.N,{providerRef:n},r.createElement(s,(0,f.__assign)({},a)))))},I=n(4563),C=new Map,D=function(e){var t=e.theme,n=(0,a.D)(),i=e.theme=r.useMemo(function(){var e=(0,I.z)(n,t);return e.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r];if(s){var a=s.id||C.get(s);a||(a=(0,o.O)(""),C.set(s,a)),n.push(a)}}return n.join("-")}(n,t),e},[n,t]);e.customizerContext=r.useMemo(function(){return{customizations:{inCustomizerContext:!0,settings:{theme:i},scopedSettings:i.components||{}}}},[i]),e.theme.rtl!==n.rtl&&(e.dir=e.theme.rtl?"rtl":"ltr")},E=n(52787),P=n(56420),w=r.forwardRef(function(e,t){var n=function(e,t){var n=(0,E.N)(t,e);return D(n),{state:n,render:b}}(e,{ref:(0,P.a)(t,r.useRef(null)),as:"div",applyTo:"element"}),i=n.render,s=n.state;return m(s),i(s)});w.displayName="ThemeProvider"},99244:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(75992);class i extends r.r{constructor(e,t){super(i.actionType),this.planEntitySet=e,this.localId=t}}i.actionType="PLW_CREATE_PLAN_SUCCEEDED"},99763:(e,t,n)=>{"use strict";n.d(t,{T:()=>i});var r=n(75992);class i extends r.r{loggingData(){return{id:this.taskEntitySet.id}}constructor(e,t){super(i.actionType),this.originalTaskEntitySet=e,this.taskEntitySet=t}}i.actionType="PLW_DIFFSYNC_UPDATE_TASK"}}]);
//# sourceMappingURL=7691.6a94eb2a.chunk.js.map