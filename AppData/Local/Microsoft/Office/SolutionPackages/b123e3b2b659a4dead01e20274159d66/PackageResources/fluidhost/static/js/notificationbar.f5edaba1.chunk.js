"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[83069],{2880:(r,t,e)=>{e.d(t,{n:()=>c});var i=e(27051),o=e(65043),s=e(42463),n=e(93589),a=e(59846);const c=r=>{let t=a.UU;if(null!=r.messageBarType)switch(r.messageBarType){case s.H.success:t=a.p$;break;case s.H.error:t=a.mU;break;case s.H.blocked:t=a.Ex;break;case s.H.severeWarning:t=a.td;break;case s.H.info:case s.H.warning:default:t=a.UU}return o.createElement(n.n,(0,i.A)({dismissIconProps:a.s5,messageBarIconProps:t},r))}},9442:(r,t,e)=>{e.d(t,{N:()=>d});var i=e(65804),o=e(56851),s=e(65043),n=e(56420),a=e(89379),c=e(15535),l=(0,a.Z)(),p=function(r,t){s.useImperativeHandle(r.componentRef,function(){return{focus:function(){t.current&&t.current.focus()}}},[t])},u=function(r,t){t.as;var e=t.disabled,i=t.target,s=t.href,n=(t.theme,t.getStyles,t.styles,t.componentRef,t.underline,(0,o.__rest)(t,["as","disabled","target","href","theme","getStyles","styles","componentRef","underline"]));return"string"===typeof r?"a"===r?(0,o.__assign)({target:i,href:e?void 0:s},n):"button"===r?(0,o.__assign)({type:"button",disabled:e},n):(0,o.__assign)((0,o.__assign)({},n),{disabled:e}):(0,o.__assign)({target:i,href:s,disabled:e},n)},f=s.forwardRef(function(r,t){var e=function(r,t){var e=r.as,i=r.className,a=r.disabled,f=r.href,g=r.onClick,d=r.styles,h=r.theme,E=r.underline,k=s.useRef(null),S=(0,n.a)(k,t);p(r,k),(0,c.vk)(k);var B=l(d,{className:i,isButton:!f,isDisabled:a,isUnderlined:E,theme:h}),N=e||(f?"a":"button");return{state:{},slots:{root:N},slotProps:{root:(0,o.__assign)((0,o.__assign)({},u(N,r)),{"aria-disabled":a,className:B.root,onClick:function(r){a?r.preventDefault():g&&g(r)},ref:S})}}}(r,t),i=e.slots,a=e.slotProps;return s.createElement(i.root,(0,o.__assign)({},a.root))});f.displayName="LinkBase";var g=e(97758),d=(0,i.I)(f,g.$,void 0,{scope:"Link"})},56921:(r,t,e)=>{e.r(t),e.d(t,{NotificationBar:()=>y});var i=e(27051),o=e(16112),s=e(9442),n=e(2880),a=e(95783),c=e(7811),l=e(64226),p=e(96891),u=e(56415),f=e(77508),g=e(66783),d=e(52195),h=e(66151),E=e(72943);const k="8px",S="-4px",B=(0,g.J9)((r,t)=>{const e={messageLink:{color:u.z.ThemePrimary},technicalDetailsLink:[I(r),{marginLeft:"4px",cursor:"pointer"}],technicalDetailsSection:{marginTop:"16px"}};return(0,d.TW)(e,t)}),N=(0,g.J9)(r=>({messageLink:(0,d.Zq)("messageLink",r.messageLink),technicalDetailsSection:(0,d.Zq)("technicalDetailsSection",r.technicalDetailsSection),technicalDetailsLink:(0,d.Zq)("technicalDetailsLink",r.technicalDetailsLink)})),m=(0,g.J9)(r=>({content:[_(r),{alignItems:"center",width:"auto"}],innerText:[T(r),{"> span":(0,h.gS)("column","nowrap")}],icon:T(r),iconContainer:P(r),dismissal:{marginRight:k,".plannerIcon":T(r)},root:(0,E.lX)({backgroundColor:"#4D0000",color:"#FFFFFF"})})),_=(0,g.J9)(r=>{let t={margin:"".concat(k," 0")};switch(r){case f.Sx.LoopLight:t={border:"1px solid ".concat(u.z.LoopLightErrorYellowBannerBorder),backgroundColor:u.z.LoopLightErrorYellowBannerBackground,margin:"0 ".concat(S)};break;case f.Sx.LoopDark:t={border:"1px solid ".concat(u.z.LoopDarkErrorYellowBannerBorder),backgroundColor:u.z.LoopDarkErrorYellowBannerBackground,margin:"0 ".concat(S)}}return t}),T=(0,g.J9)(r=>{let t="";switch(r){case f.Sx.LoopLight:t=u.z.LoopLightErrorYellowBannerText;break;case f.Sx.LoopDark:t=u.z.LoopDarkErrorYellowBannerText}return{color:t}}),I=(0,g.J9)(r=>{let t=u.z.ThemePrimary;if(r===f.Sx.LoopDark)t=u.z.PlannerDarkDarker;return{color:t}}),P=(0,g.J9)(r=>{let t={marginLeft:k,marginRight:k};switch(r){case f.Sx.LoopLight:case f.Sx.LoopDark:t={marginLeft:"12px"}}return t});var U=e(65043),G=e(79537),x=e(74844),M=e(21382),D=e(86053);class y extends o.${name(){return p.M.NotificationBar}renderComponent(){const r=this.getClassNames(),t=this.getMessage();if(!t)return null;const e=this.getMessageHelpLink();let i=null,o=null;return this.props.correlationId&&(i=U.createElement("span",{className:r.technicalDetailsLink,onClick:this.toggleShowTechnicalDetails.bind(this),tabIndex:0},D.p.Strings.NotificationBar_TechnicalDetails),this.state.isExpandedViewVisible&&(o=U.createElement("div",{className:r.technicalDetailsSection},U.createElement("div",null,D.p.Strings.NotificationBar_CorrelationId," ",this.props.correlationId),U.createElement("div",null,D.p.Strings.NotificationBar_TimeStamp," ",this.props.timeStamp)))),U.createElement(n.n,{messageBarType:this.props.messageType,onDismiss:this.props.onDismiss,"aria-label":D.p.Strings.NotificationBar_NotificationBarAriaLabel,dismissButtonAriaLabel:D.p.Strings.NotificationBar_NotificationBarDismissAriaLabel,styles:m(this.props.theme)},U.createElement("span",null,t,e,i),o)}getMessage(){const r=this.getServerErrorMessage();if(r)return r;switch(this.props.notificationId){case l.fc.AddUsersToGroupError:return this.getUserMessage(D.p.Strings.NotificationBar_AddUsersToGroupError);case l.fc.CopyPlanError:return D.p.Strings.NotificationBar_CopyPlanError;case l.fc.CreateBucketError:return this.getStringParamMessage(D.p.Strings.NotificationBar_CreateBucketError);case l.fc.CreateGroupError:return this.getStringParamMessage(D.p.Strings.NotificationBar_CreateGroupError);case l.fc.CreatePlanError:return D.p.Strings.NotificationBar_CreatePlanError;case l.fc.CreateTaskError:return this.getStringParamMessage(D.p.Strings.NotificationBar_CreateTaskError);case l.fc.DeleteBucketError:return this.getBucketMessage(D.p.Strings.NotificationBar_DeleteBucketError);case l.fc.DeleteRecurringTaskSeriesDeleteError:return this.getTaskMessage(D.p.Strings.NotificationBar_DeleteRecurringTaskSeriesDeleteError);case l.fc.DeleteRecurringTaskSeriesUpdateError:return this.getTaskMessage(D.p.Strings.NotificationBar_DeleteRecurringTaskSeriesUpdateError);case l.fc.DeleteTaskError:return this.getTaskMessage(D.p.Strings.NotificationBar_DeleteTaskError);case l.fc.GetConversationThreadError:return D.p.Strings.NotificationBar_LoadConversationsError;case l.fc.GetDocumentPlansError:return D.p.Strings.NotificationBar_GetPlansError;case l.fc.GetGroupDocumentsError:return D.p.Strings.NotificationBar_GetGroupDocumentsError;case l.fc.GetGroupMembersError:return D.p.Strings.NotificationBar_GetPlanUsersError;case l.fc.GetJoinedGroupsError:return D.p.Strings.NotificationBar_GetPlansError;case l.fc.GetPlanError:return this.getEntityIdMessage(D.p.Strings.NotificationBar_LoadProjectError);case l.fc.GetPlansForGroupError:return D.p.Strings.NotificationBar_GetPlansError;case l.fc.GetTaskDetailsError:return this.getTaskMessage(D.p.Strings.NotificationBar_GetTaskDetailsError);case l.fc.GetTasksForPlanError:return this.getPlanMessage(D.p.Strings.NotificationBar_GetTasksForPlanError);case l.fc.GetTasksPageForPlanError:return D.p.Strings.NotificationBar_GetTasksPageForPlanError;case l.fc.GetTasksForUserError:return D.p.Strings.NotificationBar_GetTasksForUserError;case l.fc.GetUnifiedGroupError:return D.p.Strings.NotificationBar_GroupFetchError;case l.fc.LoadingPlanDataError:return D.p.Strings.NotificationBar_LoadingPlanDataError;case l.fc.RemoveUserFromGroupError:return this.getUserMessage(D.p.Strings.NotificationBar_RemoveUserFromGroupError);case l.fc.TaskNotFoundError:return this.getStringParamMessage(D.p.Strings.NotificationBar_TaskNotFoundError);case l.fc.UnknownTaskNotFoundError:return D.p.Strings.NotificationBar_UnknownTaskNotFoundError;case l.fc.UpdateBucketError:return this.getBucketMessage(D.p.Strings.NotificationBar_UpdateBucketError);case l.fc.UpdateTaskError:return this.getTaskMessage(D.p.Strings.NotificationBar_UpdateTaskError);case l.fc.UpdateUnifiedGroupError:case l.fc.UpdateUnifiedGroupSubscriptionError:return D.p.Strings.NotificationBar_UpdateGroupError;case l.fc.UpdatePlanEntitySetError:return this.getPlanMessage(D.p.Strings.NotificationBar_UpdatePlanEntitySetError);case l.fc.UploadFileError:return this.getStringParamMessage(D.p.Strings.NotificationBar_UploadFileError);case l.fc.FileReadError:return this.getStringParamMessage(D.p.Strings.NotificationBar_FileReadError);case l.fc.CancelFileUploadError:return this.getStringParamMessage(D.p.Strings.NotificationBar_CancelFileUploadError);case l.fc.DiffSyncDisabledError:return D.p.Strings.NotificationBar_DiffSyncDisabledError;case l.fc.NewBuildInfo:return D.p.Strings.NotificationBar_NewBuildAvailableInfo;case l.fc.RollbackBuildInfo:return D.p.Strings.NotificationBar_RollbackBuildInfo;case l.fc.AddToFavoritesError:return D.p.Strings.NotificationBar_AddToPinnedError;case l.fc.UndeleteTaskError:return this.getStringParamMessage(D.p.Strings.NotificationBar_UndeleteTaskError);case l.fc.SetReadonlyModeInfo:return D.p.Strings.NotificationBar_SetReadonlyModeInfo;case l.fc.NonMemberInfo:return D.p.Strings.NotificationBar_NonMemberInfo;case l.fc.GoneOffline:return D.p.Strings.NotificationBar_GoneOffline;case l.fc.MembersNotFoundInfo:return D.p.Strings.NotificationBar_MembersNotFoundInfo;case l.fc.TasksNotFoundInfo:return D.p.Strings.NotificationBar_TasksNotFoundInfo;case l.fc.GetBucketsForPlanError:return D.p.Strings.NotificationBar_GetBucketsForPlanError;case l.fc.GetUnifiedGroupDetailsError:return D.p.Strings.NotificationBar_GroupFetchError;case l.fc.UnifiedGroupNotFoundInfo:return D.p.Strings.NotificationBar_UnifiedGroupNotFoundInfo;case l.fc.UpdateDeletedTaskInfo:return this.getStringParamMessage(D.p.Strings.NotificationBar_UpdateDeletedTaskInfo);case l.fc.BucketsNotFoundInfo:return D.p.Strings.NotificationBar_BucketsNotFoundInfo;case l.fc.UnopenableAttachmentLinkInfo:return D.p.Strings.NotificationBar_UnopenableAttachmentLinkInfo;case l.fc.ExportPlanError:case l.fc.ExportPlanBucketFetchError:case l.fc.ExportPlanPlanFetchError:case l.fc.ExportPlanTaskFetchError:case l.fc.ExportPlanTaskDetailsFetchError:case l.fc.ExportPlanUserFetchError:return this.getPlanMessage(D.p.Strings.NotificationBar_ExportPlanError);case l.fc.ConvertSuggestionToAttachmentError:return D.p.Strings.NotificationBar_ConvertSuggestionToAttachmentError;case l.fc.DiffSyncMaxPlansSharedWithUserLimitError:return D.p.Strings.NotificationBar_DiffSyncMaxPlansSharedWithUserLimitError;case l.fc.DowngradePremiumPlanSuccess:return D.p.Strings.NotificationsBar_DowngradePremiumPlanSuccess;case l.fc.PlanConvertingInfo:return D.p.Strings.NotificationBar_PlanConvertingInfo;case l.fc.GetAggregateDataForPlanError:case l.fc.GetPlanDetailsError:case l.fc.GetTaskBoardTaskFormattingForPlanError:case l.fc.ResolveUsersError:case l.fc.UpdateUserError:case l.fc.DeletePlanError:case l.fc.DeleteUnifiedGroupError:case l.fc.JoinUnifiedGroupError:case l.fc.LeaveUnifiedGroupError:case l.fc.MoveTaskError:case l.fc.PopupWindowError:case l.fc.PostGroupConversationThreadReplyError:case l.fc.RefreshAuthTokenError:case l.fc.RefreshAuthTokenIEError:case l.fc.SetRosterSensitivityLabelError:case l.fc.UnauthenticatedError:case l.fc.UserInterationRequiredAuthError:case l.fc.ShareDriveItemError:return null;default:return G.f.unreachableCase(this.props.notificationId,r=>{this.context.traceLogger.logTrace(507877015,x.k.Warning,r)}),null}}getMessageHelpLink(){let r=null;const t=this.getClassNames();return this.props.notificationId!==l.fc.RefreshAuthTokenIEError?null:(r="https://go.microsoft.com/fwlink/?linkid=851765",r?U.createElement("span",null,U.createElement(s.N,{className:t.messageLink,href:r,target:"_blank",rel:"noopener noreferrer"},r)):null)}getServerErrorMessage(){if(null==this.props.statusCode)return null;switch(this.props.statusCode){case 0:return"timeout"===this.props.statusText?D.p.Strings.NotificationBar_TimeoutError:D.p.Strings.NotificationBar_NetworkError;case a.t3.Forbidden:if(this.props.notificationId===l.fc.DeleteTaskError)return D.p.Strings.NotificationBar_DeleteTaskInGroupError;if(this.props.notificationId===l.fc.CreatePlanError)return D.p.Strings.NotificationBar_CreatePlanError;if(this.props.notificationId===l.fc.GetGroupMembersError)return M.G(D.p.Strings.NotificationBar_MembersPermissionDeniedInfo,D.p.Strings.PlannerApp_UnknownUserName);if(this.props.entityId){const r=this.props.getBucket(this.props.entityId);if(r)return M.G(D.p.Strings.NotificationBar_UnauthorizedAction,r.title);const t=this.props.getPlan(this.props.entityId);if(t)return M.G(D.p.Strings.NotificationBar_UnauthorizedAction,t.title);const e=this.props.getTask(this.props.entityId);if(e)return M.G(D.p.Strings.NotificationBar_UnauthorizedAction,e.title);const i=this.props.getUser(this.props.entityId);return i?M.G(D.p.Strings.NotificationBar_UnauthorizedAction,i.displayName):M.G(D.p.Strings.NotificationBar_UnauthorizedAction,this.props.entityId)}return this.props.stringParams?M.G(D.p.Strings.NotificationBar_UnauthorizedAction,this.props.stringParams):M.G(D.p.Strings.NotificationBar_UnauthorizedActionGeneric);case 404:return this.props.notificationId===l.fc.GetBucketsForPlanError?D.p.Strings.NotificationBar_BucketsNotFoundInfo:this.props.notificationId===l.fc.GetTasksForPlanError?D.p.Strings.NotificationBar_TasksNotFoundInfo:this.props.notificationId===l.fc.GetGroupMembersError?D.p.Strings.NotificationBar_MembersNotFoundInfo:this.props.notificationId===l.fc.GetUnifiedGroupDetailsError?D.p.Strings.NotificationBar_UnifiedGroupNotFoundInfo:null;case 408:return D.p.Strings.NotificationBar_TimeoutError;case a.t3.Conflict:return this.getConflictMessage();case 429:return D.p.Strings.NotificationBar_ThrottlingError;case 433:return this.getLimitTypeMessage(this.props.statusText);case a.t3.ServiceUnavailable:return"InAFewMinutes"===this.props.statusText?D.p.Strings.NotificationBar_ServiceReadOnlyTryInAFewMinutes:"InAnHour"===this.props.statusText?D.p.Strings.NotificationBar_ServiceReadOnlyTryInAnHour:"InAFewHours"===this.props.statusText?D.p.Strings.NotificationBar_ServiceReadOnlyTryInAFewHours:null;case 504:return D.p.Strings.NotificationBar_TimeoutError;default:return null}}getConflictMessage(){switch(this.props.notificationId){case l.fc.DeleteBucketError:let r="";if(this.props.entityId){const t=this.props.getBucket(this.props.entityId);t&&(r=t.title)}return M.G(D.p.Strings.NotificationBar_DeleteBucketErrorWithUpdateConflict,r);case l.fc.DeleteTaskError:let t="";if(this.props.entityId){const r=this.props.getTask(this.props.entityId);r&&(t=r.title)}return M.G(D.p.Strings.NotificationBar_DeleteTaskErrorWithUpdateConflict,t)}let r="";switch(this.props.notificationId){case l.fc.UpdateBucketError:if(this.props.entityId){const t=this.props.getBucket(this.props.entityId);t&&(r=t.title)}break;case l.fc.UpdateTaskError:if(this.props.entityId){const t=this.props.getTask(this.props.entityId);t&&(r=t.title)}break;case l.fc.UpdateUserError:if(this.props.entityId){const t=this.props.getUser(this.props.entityId);t&&(r=t.displayName)}}return M.G(D.p.Strings.NotificationBar_UpdateConflictError,r)}getBucketMessage(r){if(!this.props.entityId)return null;const t=this.props.getBucket(this.props.entityId);return t?M.G(r,t.title):null}getEntityIdMessage(r){return M.G(r,this.props.entityId)}getStringParamMessage(r){return this.props.stringParams?M.G(r,...this.props.stringParams):r}getPlanMessage(r){if(!this.props.entityId)return null;const t=this.props.getPlan(this.props.entityId);return t?M.G(r,t.title):null}getTaskMessage(r){if(!this.props.entityId)return null;const t=this.props.getTask(this.props.entityId);return t?M.G(r,t.title):null}getUserMessage(r){if(!this.props.entityId)return null;const t=this.props.getUser(this.props.entityId);return t?M.G(r,t.displayName):null}getLimitTypeMessage(r){switch(r){case c.I3.MaxPlansOwnedByGroup:return D.p.Strings.NotificationBar_MaxPlansOwnedByGroupError;case c.I3.MaxFavoritePlansForUser:return D.p.Strings.NotificationBar_MaxFavoritePlansForUserError;case c.I3.MaxRecentPlansForUser:return D.p.Strings.NotificationBar_MaxRecentPlansForUserError;case c.I3.MaxTasksAssignedToUser:return D.p.Strings.NotificationBar_MaxTasksAssignedToUserError;case c.I3.MaxTasksCreatedByUser:return D.p.Strings.NotificationBar_MaxTasksCreatedByUserError;case c.I3.MaxAssigneesInTasks:return D.p.Strings.NotificationBar_MaxAssigneesInTasksError;case c.I3.MaxLinksOnTask:return D.p.Strings.NotificationBar_MaxLinksOnTaskError;case c.I3.MaxChecklistItemsOnTask:return D.p.Strings.NotificationBar_MaxChecklistItemsOnTaskError;case c.I3.MaxBucketsInPlan:return D.p.Strings.NotificationBar_MaxBucketsInPlanError;case c.I3.MaxContextsOnPlan:return D.p.Strings.NotificationBar_MaxContextsOnPlanError;case c.I3.MaxTasksInPlan:return D.p.Strings.NotificationBar_MaxTasksInPlanError;case c.I3.MaxActiveTasksInPlan:return D.p.Strings.NotificationBar_MaxActiveTasksInPlanError;default:return D.p.Strings.NotificationBar_BasicLimitsError}}toggleShowTechnicalDetails(){this.setState(r=>(0,i.A)((0,i.A)({},r),{},{isExpandedViewVisible:!r.isExpandedViewVisible}))}getClassNames(){const{theme:r,styles:t}=this.props;return N(B(r,t))}constructor(r,t){super(r,t),this.state={isExpandedViewVisible:!1}}}},97758:(r,t,e)=>{e.d(t,{$:()=>n,e:()=>s});var i=e(52195),o=e(42815),s={root:"ms-Link"},n=function(r){var t,e,n,a,c,l,p,u=r.className,f=r.isButton,g=r.isDisabled,d=r.isUnderlined,h=r.theme,E=h.semanticColors,k=E.link,S=E.linkHovered,B=E.disabledText,N=E.focusBorder,m=(0,i.Km)(s,h);return{root:[m.root,h.fonts.medium,{color:k,outline:"none",fontSize:"inherit",fontWeight:"inherit",textDecoration:d?"underline":"none",selectors:(t={},t[".".concat(o.Y2," &:focus, :host(.").concat(o.Y2,") &:focus")]={boxShadow:"0 0 0 1px ".concat(N," inset"),outline:"1px auto ".concat(N),selectors:(e={},e[i.up]={outline:"1px solid WindowText"},e)},t[i.up]={borderBottom:"none"},t)},f&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(n={},n[i.up]={color:"LinkText",forcedColorAdjust:"none"},n)},!f&&{selectors:(a={},a[i.up]={MsHighContrastAdjust:"auto",forcedColorAdjust:"auto"},a)},g&&["is-disabled",{color:B,cursor:"default"},{selectors:(c={"&:link, &:visited":{pointerEvents:"none"}},c[i.up]={color:"GrayText"},c)}],!g&&{selectors:{"&:active, &:hover, &:active:hover":{color:S,textDecoration:"underline",selectors:(l={},l[i.up]={color:"LinkText"},l)},"&:focus":{color:k,selectors:(p={},p[i.up]={color:"LinkText"},p)}}},m.root,u]}}}}]);
//# sourceMappingURL=notificationbar.f5edaba1.chunk.js.map