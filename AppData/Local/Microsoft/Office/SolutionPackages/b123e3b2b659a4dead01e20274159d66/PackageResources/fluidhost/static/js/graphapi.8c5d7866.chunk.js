"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[1303],{11755:(e,t,r)=>{r.d(t,{K:()=>i});class i{constructor(e,t){this.skipTokenKey="@odata.nextLink",this.betaBaseUrl="beta/",this.v1BaseUrl="v1.0/",this._baseUrl=e,this.ajaxClient=t}}},11910:(e,t,r)=>{r.d(t,{L:()=>l});var i,a=r(86178),n=r.n(a),s=r(38752),o=r(54276);!function(e){e[e.Text=0]="Text",e[e.HTML=1]="HTML"}(i||(i={}));var d=r(91246);class c{build(){return new l(this)}fromPostResource(e){return this.withPropertyBag({body:null!=e.Body?{content:e.Body.Content,contentType:e.Body.ContentType===i.HTML?o.c.HTML:o.c.Text}:void 0,categories:e.Categories||void 0,changeKey:null!=e.ChangeKey?e.ChangeKey:void 0,conversationId:e.ConversationId||void 0,conversationThreadId:e.ConversationThreadId||void 0,createdDateTime:null!=e.CreatedDateTime?n()(e.CreatedDateTime):void 0,fromField:null!=e.From?{emailAddress:{address:e.From.EmailAddress.Address,name:e.From.EmailAddress.Name}}:void 0,hasAttachments:e.HasAttachments,id:e.Id,lastModifiedDateTime:null!=e.LastModifiedDateTime?n()(e.LastModifiedDateTime):void 0,receivedDateTime:null!=e.ReceivedDateTime?n()(e.ReceivedDateTime):void 0,sender:null!=e.Sender?{emailAddress:{address:e.Sender.EmailAddress.Address,name:e.Sender.EmailAddress.Name}}:void 0})}fromGraphPostResource(e,t){return this.withPropertyBag({body:null!=e.body?{content:e.body.content,contentType:"html"===e.body.contentType?o.c.HTML:o.c.Text}:void 0,categories:e.categories,changeKey:null!=e.changeKey?e.changeKey:void 0,conversationId:void 0,conversationThreadId:t,createdDateTime:null!=e.createdDateTime?n()(e.createdDateTime):void 0,fromField:null!=e.from?{emailAddress:{address:e.from.emailAddress.address,name:e.from.emailAddress.name}}:void 0,hasAttachments:e.hasAttachments,id:e.id,lastModifiedDateTime:null!=e.lastModifiedDateTime?n()(e.lastModifiedDateTime):void 0,receivedDateTime:null!=e.receivedDateTime?n()(e.receivedDateTime):void 0,sender:null!=e.sender?{emailAddress:{address:e.sender.emailAddress.address,name:e.sender.emailAddress.name}}:void 0,nextLink:e["@odata.nextLink"]})}withPropertyBag(e){return this.body=e.body||this.body,this.categories=e.categories||this.categories,this.changeKey=null!=e.changeKey?e.changeKey:this.changeKey,this.conversationId=e.conversationId||this.conversationId,this.conversationThreadId=e.conversationThreadId||this.conversationThreadId,this.createdDateTime=e.createdDateTime||this.createdDateTime,this.fromField=e.fromField||this.fromField,this.hasAttachments=null!=e.hasAttachments?e.hasAttachments:this.hasAttachments,this.id=e.id||this.id,this.lastModifiedDateTime=e.lastModifiedDateTime||this.lastModifiedDateTime,this.receivedDateTime=e.receivedDateTime||this.receivedDateTime,this.sender=e.sender||this.sender,this.nextLink=e.nextLink||this.nextLink,this}withLocallyUniqueId(){return this.id=d.o.generate(),this}constructor(){this.body=null,this.categories=[],this.id=d.o.generate(),this.hasAttachments=!1,this.fromField={emailAddress:{address:s.B.currentUserEmail,name:"CurrentUser"}}}}class l{static get builder(){return new c}static generatePostBody(e){return{content:e,contentType:o.c.HTML}}toWebSerializable(){return{Body:null!=this.body?{Content:this.body.content,ContentType:this.body.contentType===o.c.HTML?i.HTML:i.Text}:null,Categories:this.categories,ChangeKey:this.changeKey,ConversationId:this.conversationId,ConversationThreadId:this.conversationThreadId,CreatedDateTime:null!=this.createdDateTime?this.createdDateTime.toISOString():null,From:{EmailAddress:{Address:this.fromField.emailAddress.address,Name:this.fromField.emailAddress.name}},HasAttachments:this.hasAttachments,Id:this.id,LastModifiedDateTime:null!=this.lastModifiedDateTime?this.lastModifiedDateTime.toISOString():null,ReceivedDateTime:null!=this.receivedDateTime?this.receivedDateTime.toISOString():null,Sender:null!=this.sender?{EmailAddress:{Address:this.sender.emailAddress.address,Name:this.sender.emailAddress.name}}:null}}toGraphSerializable(){return{body:null!=this.body?{content:this.body.content,contentType:this.body.contentType}:null,categories:null!=this.categories?this.categories:void 0,changeKey:this.changeKey,createdDateTime:null!=this.createdDateTime?this.createdDateTime.toISOString():void 0,from:null!=this.fromField?{emailAddress:{address:this.fromField.emailAddress.address,name:this.fromField.emailAddress.name}}:void 0,hasAttachments:this.hasAttachments,id:this.id,lastModifiedDateTime:null!=this.lastModifiedDateTime?this.lastModifiedDateTime.toISOString():void 0,receivedDateTime:null!=this.receivedDateTime?this.receivedDateTime.toISOString():void 0,sender:null!=this.sender?{emailAddress:{address:this.sender.emailAddress.address,name:this.sender.emailAddress.name}}:void 0,singleValueExtendedProperties:[{id:l.transportTrafficTypeName,value:l.transportTrafficType},{id:l.transportTrafficSubTypeName,value:l.transportTrafficSubType}]}}constructor(e){this.body=e.body,this.categories=e.categories,this.changeKey=e.changeKey,this.conversationId=e.conversationId,this.conversationThreadId=e.conversationThreadId,this.createdDateTime=e.createdDateTime,this.fromField=e.fromField,this.hasAttachments=e.hasAttachments,this.id=e.id,this.lastModifiedDateTime=e.lastModifiedDateTime,this.receivedDateTime=e.receivedDateTime,this.sender=e.sender}}l.transportTrafficTypeName="String {00020386-0000-0000-C000-000000000046} Name X-MS-Exchange-Organization-TransportTrafficType",l.transportTrafficSubTypeName="String {00020386-0000-0000-C000-000000000046} Name X-MS-Exchange-Organization-TransportTrafficSubType",l.transportTrafficType="Email",l.transportTrafficSubType="PlannerComment"},14983:(e,t,r)=>{var i;r.d(t,{Er:()=>i,LP:()=>a,ig:()=>n}),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Project="Project",e.Visio="Visio",e.Pdf="Pdf",e.Loop="Loop",e.Other="Other"}(i||(i={}));i.OneNote,i.Project,i.Visio;var a,n=["jpg","jpeg","png","gif","bmp"];!function(e){e.Stream="stream-video",e.Youtube="yt-video",e.Vimeo="vimeo-video",e.DailyMotion="dm-video",e.Facebook="fb-video"}(a||(a={}))},23918:(e,t,r)=>{r.d(t,{Y:()=>f});var i=r(91675),a=r(51171),n=r(57718),s=r(86178),o=r.n(s),d=r(14983),c=function(){function e(){this.id=n.cM(),this.name="",this.fileType=d.Er.Other,this.url="",this.modifiedDate=o()(),this.childCount=-1,this.itemPath="/drive/root:"}return e.prototype.build=function(){return new f(this)},e.prototype.withPropertyBag=function(e){return this.id=e.id||this.id,this.name=e.name||this.name,this.fileType=e.fileType||this.fileType,this.url=e.url||this.url,this.modifiedDate=e.modifiedDate||this.modifiedDate,this.childCount=void 0!==e.childCount?e.childCount:this.childCount,this.itemPath=e.itemPath||this.itemPath,this},e.prototype.withDefaultValues=function(){return this.withPropertyBag({id:"driveItemId",name:"Item1",fileType:d.Er.Other,url:"driveItemUrl",modifiedDate:o()(),itemPath:"/drive/root:",childCount:-1})},e.prototype.fromGraphDriveItemResource=function(e){return this.withPropertyBag({id:e.id,name:e.name,fileType:e.folder?d.Er.Other:e.package?f.GetType(e.package.type):f.GetFileType(e.name),url:e.webUrl,modifiedDate:o()(e.lastModifiedDateTime),childCount:e.folder?e.folder.childCount:-1,itemPath:e.parentReference.path})},e}(),l=r(98990),h=r.n(l),m=r(55491),u=r.n(m),p=r(54320),g=r.n(p),f=function(){function e(e){if(g()(e.id))throw new a.L("id");if(g()(e.name))throw new a.L("name");if(g()(e.url))throw new a.L("url");this.id=e.id,this.name=e.name,this.url=e.url,this.fileType=e.fileType,this.description=e.description,this.modifiedDate=e.modifiedDate,this.childCount=e.childCount,this.itemPath=e.itemPath}return Object.defineProperty(e,"builder",{get:function(){return new c},enumerable:!1,configurable:!0}),e.GetType=function(e){switch(e.toLowerCase()){case"excel":return d.Er.Excel;case"onenote":return d.Er.OneNote;case"pdf":return d.Er.Pdf;case"powerpoint":return d.Er.PowerPoint;case"project":return d.Er.Project;case"visio":return d.Er.Visio;case"word":return d.Er.Word;case"loop":return d.Er.Loop;default:return d.Er.Other}},e.GetFileType=function(t){var r=d.Er.Other,a=t.slice(t.lastIndexOf(".")+1);return u()(i.t,function(t,i){h()(t,function(e){return e.toLowerCase()===a.toLowerCase()})&&(r=e.GetType(i))}),r},e}()},54276:(e,t,r)=>{var i;r.d(t,{c:()=>i}),function(e){e.Text="text",e.HTML="html"}(i||(i={}))},57718:(e,t,r)=>{function i(e){for(var t="";t.length<e;){var r=16*Math.random();t+=(r|=0).toString(16)}return t}r.d(t,{cM:()=>a});function a(){var e=[];e.push(i(8)),e.push(i(4));var t="4"+i(3);e.push(t);var r=i(4),a=parseInt(r[0],16);return a&=3,r=(a|=8).toString(16)+r.substr(1),e.push(r),e.push(i(12)),e.join("-")}},61739:(e,t,r)=>{r.d(t,{Cx:()=>n,Ny:()=>s,n0:()=>o});var i=r(54320),a=r.n(i);function n(e){let t="";if(!a()(e))try{t=new URLSearchParams(new URL(e).search).get("$skiptoken")||""}catch(r){}return t}function s(e,t){return"startswith(".concat(e,", '").concat(encodeURIComponent(t).replace(/'/g,"''"),"')")}function o(e){const t="https://graph.microsoft.com/";return e&&0===e.indexOf(t)&&(e=e.substring(28)),e}},76241:(e,t,r)=>{var i;r.d(t,{X:()=>i}),function(e){e[e.Public=0]="Public",e[e.Private=1]="Private",e[e.HiddenMembership=2]="HiddenMembership"}(i||(i={}))},77014:(e,t,r)=>{r.r(t),r.d(t,{GraphApi:()=>v});var i=r(45078),a=r(95783),n=r(11755),s=r(23918),o=r(92970),d=r(65818),c=r(50204),l=r(11910),h=r(54320),m=r.n(h),u=r(33411),p=r.n(u),g=r(98502),f=r(81704),y=r(61739);class v extends n.K{async getUnifiedGroupAsync(e){const t="".concat(this._baseUrl,"groups/").concat(e.groupId,"?").concat("$select=assignedLabels,autoSubscribeNewMembers,classification,description,displayName,id,mail,mailNickname,visibility"),r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getUnifiedGroupAsync"}});try{const t=await r.clone().json();if(null==t)throw new Error("No unified group data returned");return t.id=e.groupId,o.E.builder.fromGraphResource(t).build()}catch(i){throw g.g.generateAjaxClientError(r,i)}}async getMembersOfContainerAsync(e){switch(e.container.containerType){case d.K.Group:return await this.getMembersOfGroupAsync(e);case d.K.Roster:return await this.getMembersOfPlannerRosterAsync(e);default:return Promise.reject(g.g.generateAjaxClientError(new Response(i.MR.NotImplemented,{status:a.t3.NotImplemented,statusText:i.MR.NotImplemented})))}}async getUserAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["userId"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"users/").concat(e.userId,"?$select=id,displayName,givenName,jobTitle,mail,preferredLanguage,surname,userPrincipalName,proxyAddresses,userType"),i=await this.ajaxClient.executeRequest(r,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getUserAsync"}});try{const e=await i.clone().json();if(null==e)throw new Error("No data returned");return c.K.builder.fromGraphUserResource(e).build()}catch(a){throw g.g.generateAjaxClientError(i,a)}}async resolveUsersAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["userIds"]);if(null!==t)return Promise.reject(t);const r=[];for(const i of e.userIds)r.push(this.getUserAsync({userId:i}));return await Promise.all(r)}async getConversationThreadAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["groupId","threadId"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"groups/").concat(e.groupId,"/threads/").concat(e.threadId,"/posts"),i=await this.ajaxClient.executeRequest(r,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getConversationThreadAsync"}});try{const t=await i.clone().json();if(null==t)throw new Error("No conversation thread data returned");const r=t.value;return p()(r,t=>l.L.builder.fromGraphPostResource(t,e.threadId).build())}catch(a){throw g.g.generateAjaxClientError(i,a)}}async getUserPhoto(e){const t="".concat(this._baseUrl,"users/").concat(e.user.id,"/photo/$value"),r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getUserPhoto"},retryConfig:(0,f.Vj)({maxRetryCount:0})});try{const e=await r.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(i){throw g.g.generateAjaxClientError(r,i)}}async getConversationThreadPostAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["groupId","threadId","postId"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"groups/").concat(e.groupId,"/threads/").concat(e.threadId,"/posts/").concat(e.postId),i=await this.ajaxClient.executeRequest(r,{telemetryConfig:{apiName:v.apiName,methodName:"getConversationThreadPostAsync"}});try{const t=await i.clone().json();if(null==t)throw new Error("No conversation thread post data returned");const r=t.value;return l.L.builder.fromGraphPostResource(r,e.threadId).build()}catch(a){throw g.g.generateAjaxClientError(i,a)}}async getGroupPhoto(e){const t="".concat(this._baseUrl,"groups/").concat(e.groupId,"/photo/$value"),r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getGroupPhoto"},retryConfig:(0,f.Vj)({maxRetryCount:0})});try{const e=await r.clone().blob();if(0===e.size)throw new Error("No photo returned");return URL.createObjectURL(e)}catch(i){throw g.g.generateAjaxClientError(r,i)}}async getDriveItem(e){const t=g.g.validateAjaxClientRequestParameters(e,["driveId","itemId"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"drives/").concat(e.driveId,"/items/").concat(e.itemId),i=await this.ajaxClient.executeRequest(r,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getDriveItem"},headers:new Headers(this.appendSharepointAuthenticationChallengeHeaders({}))});try{const e=await i.clone().json();if(null==e)throw new Error("No drive item returned");return s.Y.builder.fromGraphDriveItemResource(e).build()}catch(a){throw g.g.generateAjaxClientError(i,a)}}async getGroupDocumentsInFolderPaged(e,t){const r=g.g.validateAjaxClientRequestParameters(e,["groupId"]);if(null!==r)return Promise.reject(r);const i=e.folderId?"/items/".concat(e.folderId,"/children"):"/root/children",a=e.skipToken||"".concat(this._baseUrl,"groups/").concat(e.groupId,"/drive").concat(i),n=await this.ajaxClient.executeRequest(a,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getGroupDocumentsInFolderPaged"},headers:new Headers(this.appendSharepointAuthenticationChallengeHeaders({}))});try{const e=await n.clone().json();if(null==e)throw new Error("No group documents returned");const t=e.value;return{data:p()(t,e=>s.Y.builder.fromGraphDriveItemResource(e).build()),skipToken:(0,y.n0)(e[this.skipTokenKey])}}catch(o){throw g.g.generateAjaxClientError(n,o)}}async getDriveItemThumbnail(e){const t="".concat(this._baseUrl,"groups/").concat(e.groupId,"/drive/root:/").concat(e.itemPath,":/thumbnails/0/large/url"),r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getDriveItemThumbnail"},retryConfig:(0,f.Vj)({maxRetryCount:0})});try{const e=await r.clone().json(),t=e?e.value:null;if(!t)throw new Error("No item thumbnail url returned");return t}catch(i){throw g.g.generateAjaxClientError(r,i)}}async shareDriveItemAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["driveId","itemId","userIds"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"drives/").concat(e.driveId,"/items/").concat(e.itemId,"/invite"),n=[];for(const i of e.userIds){const e={objectId:i};n.push(e)}const s={recipients:n,requireSignIn:!0,sendInvitation:!1,roles:["write"]};await this.ajaxClient.executeRequest(r,{method:a.PJ.Post,mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"shareDriveItemAsync"},body:JSON.stringify(s),headers:{[i.Lr.ContentType]:i.Mq.Json}})}async checkCurrentUserToGroupsMembershipsAsync(e){const t=g.g.validateAjaxClientRequestParameters(e,["groupIds"]);if(null!==t)return Promise.reject(t);const r="".concat(this._baseUrl,"me/checkMemberGroups"),n={groupIds:e.groupIds},s=await this.ajaxClient.executeRequest(r,{method:a.PJ.Post,mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"checkCurrentUserToGroupsMembershipsAsync"},body:JSON.stringify(n),headers:{[i.Lr.ContentType]:i.Mq.Json}});try{const e=await s.clone().json();if(null==e)return Promise.reject(g.g.generateAjaxClientError(s,"No group ids returned"));let t=[];return e.value&&(t=e.value),t}catch(o){throw g.g.generateAjaxClientError(s,o)}}async getMembersOfGroupAsync(e){let t="".concat(this._baseUrl,"groups/").concat(e.container.externalId,"/members?$select=proxyAddresses,id,displayName,givenName,mail,preferredLanguage,surname,userPrincipalName,jobTitle,userType");m()(e.skipToken)||(t="".concat(t,"&$skiptoken=").concat(e.skipToken));const r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getMembersOfGroupContainerAsync"}});try{const e=await r.clone().json();if(null==e)throw new Error("No users data returned");const t=e.value,i=(0,y.Cx)(e[this.skipTokenKey]);return{data:p()(t,e=>c.K.builder.fromGraphUserResource(e).build()),skipToken:i}}catch(i){throw g.g.generateAjaxClientError(r,i)}}async getMembersOfPlannerRosterAsync(e){let t="".concat(this.betaBaseUrl,"planner/rosters/").concat(e.container.externalId,"/members?$select=userId");m()(e.skipToken)||(t="".concat(t,"&$skiptoken=").concat(e.skipToken));const r=await this.ajaxClient.executeRequest(t,{mode:"cors",telemetryConfig:{apiName:v.apiName,methodName:"getMembersOfRosterContainerAsync"}});try{const e=await r.clone().json();if(null==e)throw new Error("No users data returned");const t=e.value,i=(0,y.Cx)(e[this.skipTokenKey]),a=await Promise.all(p()(t,e=>this.getUserAsync({userId:e.userId})));return{data:a,skipToken:i}}catch(i){throw g.g.generateAjaxClientError(r,i)}}appendSharepointAuthenticationChallengeHeaders(e){return e[i.Er.AuthenticationChallengeHeaderName]=i.Er.AuthenticationChallengeHeaderValue,e}}v.apiName="GraphApi"},81704:(e,t,r)=>{r.d(t,{Vj:()=>d});var i=r(34677),a=r.n(i),n=r(38752),s=r(31028),o=r(98502);function d(e){return a()({maxRetryCount:n.B.clientSettings.RetrySettings.MaxRetryCount,maxRetryTimeoutInMiliseconds:n.B.clientSettings.RetrySettings.MaxRetryTimeout,delayOnRetryInMiliseconds:n.B.clientSettings.RetrySettings.RetryDelay,retryCheck:c},e)}async function c(e,t,r){return(0,s.g)(e)&&o.g.isRetryableResponse(t,r)}},91675:(e,t,r)=>{r.d(t,{t:()=>i});var i={Word:["docx","docm","doc","dotx","dotm"],Excel:["xlsx","xlsm","xlsb","xltx","xltm","xls","xlam","xla","xlw","xml"],PowerPoint:["pptx","pptm","ppt","potx","potm","pot","thmx","pps","ppsx","ppsm","ppsam","ppa"],OneNote:["one"],Project:["mpp","mpt","mpd"],Visio:["vsdx","vsd","vsdm","vssx","vssm","vstx","vstm"],Pdf:["pdf"],Loop:["loop","fluid"]}}}]);
//# sourceMappingURL=graphapi.8c5d7866.chunk.js.map