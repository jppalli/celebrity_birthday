"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[6363],{54555:(e,t,o)=>{o.d(t,{G:()=>N});var r=o(65804),n=o(56851),i=o(65043),a=o(89379),s=o(17066),l=o(27480),d=o(40440),c=o(56420),p=o(15199),u=o(13706),m=o(20751),h="SearchBox",g={root:{height:"auto"},icon:{fontSize:"12px"}},C={iconName:"Clear"},x={ariaLabel:"Clear text"},f=(0,a.Z)(),S=i.forwardRef(function(e,t){var o=e.ariaLabel,r=e.className,a=e.defaultValue,S=void 0===a?"":a,b=e.disabled,F=e.underlined,k=e.styles,N=e.labelText,v=e.placeholder,B=void 0===v?N:v,G=e.theme,E=e.clearButtonProps,y=void 0===E?x:E,D=e.disableAnimation,P=void 0!==D&&D,w=e.showIcon,I=void 0!==w&&w,L=e.onClear,A=e.onBlur,T=e.onEscape,R=e.onSearch,q=e.onKeyDown,z=e.iconProps,_=e.role,O=e.onChange,H=e.onChanged,W=i.useState(!1),Z=W[0],J=W[1],V=i.useRef(),j=(0,d.k)(e.value,S,function(e,t){e&&e.timeStamp===V.current||(V.current=null===e||void 0===e?void 0:e.timeStamp,null===O||void 0===O||O(e,t),null===H||void 0===H||H(t))}),$=j[0],K=j[1],M=String($),U=i.useRef(null),Y=i.useRef(null),Q=(0,c.a)(U,t),X=(0,p.B)(h,e.id),ee=y.onClick,te=f(k,{theme:G,className:r,underlined:F,hasFocus:Z,disabled:b,hasInput:M.length>0,disableAnimation:P,showIcon:I}),oe=(0,s.G1)(e,s.QQ,["className","placeholder","onFocus","onBlur","value","role"]),re=i.useCallback(function(e){var t;null===L||void 0===L||L(e),e.defaultPrevented||(K(""),null===(t=Y.current)||void 0===t||t.focus(),e.stopPropagation(),e.preventDefault())},[L,K]),ne=i.useCallback(function(e){null===ee||void 0===ee||ee(e),e.defaultPrevented||re(e)},[ee,re]),ie=i.useCallback(function(e){J(!1),null===A||void 0===A||A(e)},[A]),ae=function(e){K(e.target.value,e)};return function(e,t,o){i.useImperativeHandle(e,function(){return{focus:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.focus()},blur:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.blur()},hasFocus:function(){return o}}},[t,o])}(e.componentRef,Y,Z),i.createElement("div",{role:_,ref:Q,className:te.root,onFocusCapture:function(t){var o;J(!0),null===(o=e.onFocus)||void 0===o||o.call(e,t)}},i.createElement("div",{className:te.iconContainer,onClick:function(){Y.current&&(Y.current.focus(),Y.current.selectionStart=Y.current.selectionEnd=0)},"aria-hidden":!0},i.createElement(m.I,(0,n.__assign)({iconName:"Search"},z,{className:te.icon}))),i.createElement("input",(0,n.__assign)({},oe,{id:X,className:te.field,placeholder:B,onChange:ae,onInput:ae,onBlur:ie,onKeyDown:function(e){switch(e.which){case l.c.escape:null===T||void 0===T||T(e),M&&!e.defaultPrevented&&re(e);break;case l.c.enter:R&&(R(M),e.preventDefault(),e.stopPropagation());break;default:null===q||void 0===q||q(e),e.defaultPrevented&&e.stopPropagation()}},value:M,disabled:b,role:"searchbox","aria-label":o,ref:Y})),M.length>0&&i.createElement("div",{className:te.clearButton},i.createElement(u.K,(0,n.__assign)({onBlur:ie,styles:g,iconProps:C},y,{onClick:ne}))))});S.displayName=h;var b=o(52195),F=o(50605),k={root:"ms-SearchBox",iconContainer:"ms-SearchBox-iconContainer",icon:"ms-SearchBox-icon",clearButton:"ms-SearchBox-clearButton",field:"ms-SearchBox-field"};var N=(0,r.I)(S,function(e){var t,o,r,n,i,a=e.theme,s=e.underlined,l=e.disabled,d=e.hasFocus,c=e.className,p=e.hasInput,u=e.disableAnimation,m=e.showIcon,h=a.palette,g=a.fonts,C=a.semanticColors,x=a.effects,f=(0,b.Km)(k,a),S={color:C.inputPlaceholderText,opacity:1},N=h.neutralSecondary,v=h.neutralPrimary,B=h.neutralLighter,G=h.neutralLighter,E=h.neutralLighter;return{root:[f.root,g.medium,b.S8,{color:C.inputText,backgroundColor:C.inputBackground,display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"stretch",padding:"1px 0 1px 4px",borderRadius:x.roundedCorner2,border:"1px solid ".concat(C.inputBorder),height:32,selectors:(t={},t[b.up]={borderColor:"WindowText"},t[":hover"]={borderColor:C.inputBorderHovered,selectors:(o={},o[b.up]={borderColor:"Highlight"},o)},t[":hover .".concat(f.iconContainer)]={color:C.inputIconHovered},t)},!d&&p&&{selectors:(r={},r[":hover .".concat(f.iconContainer)]={width:4},r[":hover .".concat(f.icon)]={opacity:0,pointerEvents:"none"},r)},d&&["is-active",{position:"relative"},(0,b.Sq)(C.inputFocusBorderAlt,s?0:x.roundedCorner2,s?"borderBottom":"border")],m&&[{selectors:(n={},n[":hover .".concat(f.iconContainer)]={width:32},n[":hover .".concat(f.icon)]={opacity:1},n)}],l&&["is-disabled",{borderColor:B,backgroundColor:E,pointerEvents:"none",cursor:"default",selectors:(i={},i[b.up]={borderColor:"GrayText"},i)}],s&&["is-underlined",{borderWidth:"0 0 1px 0",borderRadius:0,padding:"1px 0 1px 8px"}],s&&l&&{backgroundColor:"transparent"},p&&"can-clear",c],iconContainer:[f.iconContainer,{display:"flex",flexDirection:"column",justifyContent:"center",flexShrink:0,fontSize:16,width:32,textAlign:"center",color:C.inputIcon,cursor:"text"},d&&{width:4},l&&{color:C.inputIconDisabled},!u&&{transition:"width ".concat(b.cs.durationValue1)},m&&d&&{width:32}],icon:[f.icon,{opacity:1},d&&{opacity:0,pointerEvents:"none"},!u&&{transition:"opacity ".concat(b.cs.durationValue1," 0s")},m&&d&&{opacity:1}],clearButton:[f.clearButton,{display:"flex",flexDirection:"row",alignItems:"stretch",cursor:"pointer",flexBasis:"32px",flexShrink:0,padding:0,margin:"-1px 0px",selectors:{"&:hover .ms-Button":{backgroundColor:G},"&:hover .ms-Button-icon":{color:v},".ms-Button":{borderRadius:(0,F.jI)(a)?"1px 0 0 1px":"0 1px 1px 0"},".ms-Button-icon":{color:N}}}],field:[f.field,b.S8,(0,b.CX)(S),{backgroundColor:"transparent",border:"none",outline:"none",fontWeight:"inherit",fontFamily:"inherit",fontSize:"inherit",color:C.inputText,flex:"1 1 0px",minWidth:"0px",overflow:"hidden",textOverflow:"ellipsis",paddingBottom:.5,selectors:{"::-ms-clear":{display:"none"}}},l&&{color:C.disabledText}]}},void 0,{scope:"SearchBox"})},67354:(e,t,o)=>{o.r(t),o.d(t,{AddFormRequirementDialog:()=>xe,DialogState:()=>Ce,FormOption:()=>ge});var r=o(27051),n=o(65043),i=o(96891),a=o(77508),s=o(16112),l=o(63485),d=o(66783),c=o(54845),p=o(31537),u=o(54555),m=o(58189),h=o(65337),g=o(94850),C=o(4648),x=o(20751),f=o(77711),S=o(36060),b=o(52195),F=o(72943),k=o(66151),N=o(56415),v=o(8736);const B=(0,d.J9)((e,t)=>{const o={groupListRoot:[{height:v.B.GroupListHeight,overflowY:"scroll"},e&&{maxHeight:v.B.CopyPlanPickerHeight,height:"auto"}],groupRow:[(0,k.gS)(),(0,F.kE)(),{justifyContent:"center",overflow:"hidden",position:"relative",alignItems:"center",cursor:"pointer",padding:"".concat(v.B.GroupListPaddingBetweenElements," 0px"),"> *":{margin:"0px ".concat(v.B.GroupListPaddingBetweenElements)},"> .newGroupIcon":{fontSize:v.B.GroupInfoNewGroupIconFontSize,color:N.z.ThemePrimary},"> .virtualContainer-wrapper":{margin:0},"&:hover, &.selected":{backgroundColor:N.z.NeutralLight}},e&&{maxWidth:"100%",margin:"0px 0px",padding:"".concat(v.B.SearchBarPadding," ").concat(v.B.SearchBarPadding)}],icon:[(0,k.gS)(),k.cc,(0,k.$Z)(v.B.GroupListIconPrimarySize),{color:N.z.White,fontSize:b.s.large,fontWeight:b.BO.regular,height:v.B.GroupListIconPrimarySize,width:v.B.GroupListIconPrimarySize}],groupContext:(0,k.GD)(),groupName:[(0,k.GD)(),(0,k.q0)("ellipsis"),{fontSize:b.s.medium,fontWeight:b.BO.semibold},e&&{lineHeight:v.B.GroupInfoLineHeight}],groupInfo:[(0,k.q0)("ellipsis"),{fontSize:b.s.small,color:N.z.NeutralSecondary}]};return(0,b.TW)(o,t)}),G=(0,d.J9)(e=>({groupListRoot:(0,b.Zq)("groupList",e.groupListRoot),groupRow:(0,b.Zq)("groupRow",e.groupRow),groupContext:(0,b.Zq)("groupContext",e.groupContext),icon:(0,b.Zq)("icon",e.icon),groupName:(0,b.Zq)("groupName",e.groupName),groupInfo:(0,b.Zq)("groupInfo",e.groupInfo)}));var E=o(54320),y=o.n(E),D=o(33411),P=o.n(D),w=o(44535),I=o(27678),L=o(86053),A=o(91246),T=o(59846);class R extends s.${name(){return"GroupList"}renderComponent(){const e=this.getClassNames();return n.createElement(h.R,{className:e.groupListRoot,direction:g.E.vertical},n.createElement("ul",{role:"listbox","aria-label":L.p.Strings.GroupList_GroupListAriaLabel},P()(this.props.groups,e=>{if(!y()(e.displayName))return this.renderGroupRow(e)})))}renderGroupRow(e){const{currentGroup:t,renderGroupContextInfo:o,sensitivityLabels:r,onClickGroupRow:i}=this.props,{groupRow:a,groupContext:s,groupName:l,groupInfo:d}=this.getClassNames(),c=this.renderGroupContainer(e),p=!!t&&e.id===t.id;return n.createElement("li",{className:(0,C.A)(a,p?"selected":""),key:e.id,"aria-label":e.displayName,"aria-selected":e===t,"tab-index":0,"data-is-focusable":!0,onClick:i.bind(this,e),role:"option"},c,n.createElement("div",{className:s},n.createElement("div",{className:l},e.displayName),o?n.createElement("div",{className:d},e.getDetailedInfo(r)):null))}renderGroupPhoto(e){const{icon:t}=this.getClassNames(),o=this.props.getGroupPhoto(e.id);if(o)return n.createElement("img",{src:o,className:t,alt:""});{const o=w.$.parseInitialsFromName(e.displayName),r=(0,S.K)((0,I.wV)(e.displayName));return n.createElement("span",{className:(0,C.A)(t,r)},o)}}renderGroupContainer(e){const{icon:t}=this.getClassNames();return A.o.isPlexTempId(e.id)?n.createElement("span",{className:(0,C.A)(t,"newGroupIcon")},n.createElement(x.I,T.D5)):n.createElement(f.$,{planContainerId:e.id,onRender:()=>this.props.onRenderGroup(e.id)},this.renderGroupPhoto(e))}getClassNames(){return G(B(this.props.isCopyPlanContext,this.props.styles))}constructor(e,t){super(e,t)}}var q=o(28680),z=o(75472);const _="".concat((0,z.jz)(v.B.GroupPickerTotalHorizontalPadding)-(0,z.jz)(v.B.fabricHorizontalPadding),"px"),O=(0,d.J9)((e,t)=>{const{isCopyPlanContext:o}=e,r={groupPickerRoot:{fontSize:b.s.small,padding:o?"0px":"0px ".concat(_," ").concat(_)},groupFilter:{padding:o?v.B.SearchBarPadding:"".concat(v.B.SearchBarPadding," 0")},subComponentStyles:{searchBar:Z(),groupList:B(o)}};return(0,q.p)(e,r,t)}),H={root:{"> h1":{fontSize:b.s.large,fontWeight:b.BO.bold}}},W={root:{fontSize:b.s.small,"> a":{textDecoration:"none",":hover":{textDecoration:"underline"}}}},Z=(0,d.J9)(()=>({root:{fontWeight:b.BO.semibold,borderColor:"transparent",backgroundColor:N.z.NeutralLight}})),J=(0,d.J9)(e=>({rootHovered:{backgroundColor:N.z.NeutralLight},root:[(0,k.aS)(e),{fontSize:b.s.medium,fontColor:N.z.NeutralPrimary,height:v.B.ButtonHeight,backgroundColor:N.z.NeutralLighter}]})),V=(0,d.J9)(e=>({groupPickerRoot:(0,b.Zq)("groupPickerDialog",e.groupPickerRoot),groupFilter:(0,b.Zq)("groupFilter",e.groupFilter)}));var j=o(21382);class $ extends s.${componentDidUpdate(e){const t=this.getTextToAnnounce();if(this.state.textToAnnounce!==t||e.groups.length!==this.props.groups.length){const e=this.props.groups.filter(e=>{if(e.displayName.toLowerCase().match(this.currentSearchText.toLowerCase()))return e});""!==t&&this.props.alertUser("SharedComponents_GroupSearchResultCountAriaLabel",[e.length.toString(),this.currentSearchText]),this.setState({textToAnnounce:t,filteredGroups:e})}}name(){return i.M.GroupPicker}renderComponent(){const{groupPickerRoot:e,groupFilter:t}=this.getClassNames(),o=this.getStyles();return n.createElement("div",{className:e},n.createElement(m.Y,{isClickableOutsideFocusTrap:!0},this.props.hideHeaderFooter?null:this.renderGroupPickerDialogHeader(),n.createElement("div",{className:t},n.createElement(u.G,{styles:o.subComponentStyles.searchBar,ariaLabel:L.p.Strings.GroupPicker_SearchBoxAriaLabel,onChange:this.onChangeSearch.bind(this),placeholder:L.p.Strings.GroupPicker_SearchBoxPlaceholder,underlined:this.props.underlinedSearchBar})),this.renderGroupList(),this.props.hideHeaderFooter?null:n.createElement(c.E,null,n.createElement(l.j,{styles:J(this.props.theme),className:"backButton",onClick:this.onClickBack.bind(this)},L.p.Strings.GroupPicker_BackButton))))}renderGroupPickerDialogHeader(){const e=n.createElement("a",{href:a.$j.m365Groups,target:"_blank",rel:"noopener noreferrer",onClick:this.onClickLink.bind(this)},L.p.Strings.GroupPicker_LearnMoreLinkText);return n.createElement("div",{className:"groupPickerDialogHeader"},n.createElement(p.J,{className:"groupPickerTitle",styles:H},n.createElement("h1",null,L.p.Strings.GroupPicker_DialogTitle)),n.createElement(p.J,{styles:W,className:"groupPickerSubtitle"},L.p.Strings.GroupPicker_DialogSubtitle," ",n.createElement("br",null)," ",e))}renderGroupList(){const{currentGroup:e,sensitivityLabels:t,renderGroupContextInfo:o,isCopyPlanContext:r,getGroupPhoto:i,onRenderGroup:a}=this.props,s=this.getStyles();return n.createElement(R,{styles:s.subComponentStyles.groupList,currentGroup:e,groups:this.state.filteredGroups,sensitivityLabels:t,onClickGroupRow:e=>this.onClickGroupRow(e),getGroupPhoto:e=>i(e),renderGroupContextInfo:o,isCopyPlanContext:r,onRenderGroup:a})}onClickGroupRow(e){this.props.setGroup(e),this.props.onDismiss&&this.props.onDismiss()}onClickBack(){this.props.setGroup(null),this.props.onDismiss&&this.props.onDismiss()}onClickLink(){this.context.usageLogger.logData(i.M.GroupPicker,i.M.GroupLinkClicked)}getTextToAnnounce(){return""===this.currentSearchText?"":j.G(L.p.Strings.SharedComponents_GroupSearchResultCountAriaLabel,this.state.filteredGroups.length,this.currentSearchText)}getStyles(){const{isCopyPlanContext:e,styles:t}=this.props,o=this.getStyleProps(e);return O(o,t)}getClassNames(){return V(this.getStyles())}constructor(e,t){super(e,t),this.currentSearchText="",this.onChangeSearch=(e,t)=>{this.currentSearchText=t||"";const o=this.props.groups.filter(e=>{if(e.displayName.toLowerCase().match(this.currentSearchText.toLowerCase()))return e});this.setState({filteredGroups:o})},this.getStyleProps=(0,d.J9)(e=>({isCopyPlanContext:e})),this.state={filteredGroups:this.props.groups,textToAnnounce:""}}}var K=o(40520),M=o(52342),U=o(40488),Y=o(57433),Q=o(11638),X=o(6017),ee=o(42283),te=o(46646),oe=o(11034),re=o(8480),ne=o(39410),ie=o(39946),ae=o(86634),se=o(48709);const le=(0,d.J9)((e,t,o)=>{const r=[(0,F.kE)({borderWidth:"1px"}),{fontSize:b.s.medium,border:"0px",borderBottom:"2px solid",width:"100%",height:"31px",":focus-visible":{outline:0,borderColor:(0,k.Nh)(e)},":disabled,:disabled:hover":{cursor:"default",opacity:"0.5",backgroundColor:N.z.NeutralLighter,borderColor:se.kd.gray110},paddingLeft:"12px"},(0,k.aS)(e),(0,k.nK)(e)],n={":hover":{".defaultContent":(0,k.aS)(e)}},i=[(0,F.kE)({borderWidth:"1px"}),{borderColor:(0,k.Nh)(e),borderBottom:"2px solid"}],s=[r,{marginBottom:"15px",".groupSelectionDropdownIcon":{float:"right",lineHeight:"14px"},".defaultContent":[{float:"left"}],".groupContent":{float:"left"}},t?i:n],l={":hover":{backgroundColor:"transparent"},":disabled":[(0,k.A9)(e)],"&.ms-Button--primary":[(0,k.jU)(e)],"&.ms-Button--default":[(0,k.i9)(e)]},d=[(0,k.aS)(e),(0,k.dg)(e),{boxShadow:"rgba(0, 0, 0, 0.4) 0px 0px 5px 0px",borderRadius:"3px","> div":{flexGrow:"1"},"@media (min-width: 480px)":{maxWidth:"600px",minWidth:"510px"}},e===a.Sx.TeamsContrast&&{border:"1px solid "+N.z.White}],c=[(0,k.aS)(e)],p=[(0,k.Ml)(e),{"::after":e===a.Sx.TeamsContrast&&{color:N.z.White}}],u=[(0,k.gS)("row"),{alignItems:"center"}],m={marginBottom:"15px"},h=[p,{fontSize:b.s.small,marginBottom:"5px"}],g=[m,{":hover":{".ms-Dropdown-titleIsPlaceHolder":[(0,k.aS)(e)]},".ms-Label":{"::after":e===a.Sx.TeamsContrast&&{color:N.z.White}}}],C=[(0,k.gS)("column"),(0,k.aS)(e),{justifyContent:"center",textAlign:"center",fontSize:b.s.large,height:"250px",fontWeight:b.BO.semibold}],x={".ms-Dialog-button":[(0,k.aS)(e),{":hover":[(0,k.aS)(e),{backgroundColor:"transparent"}]}]};return(0,b.TW)({groupPickerButton:s,dialogContainer:d,dialogFooterButtons:l,dialogFooter:{paddingTop:"15px"},dialogTitle:c,label:p,labelWithInfoIcon:u,infoIcon:{display:"inline-block",verticalAlign:"middle"},inputField:m,labelDescription:h,dropdown:g,loadingSpinner:C,dialogTopButton:x,tooltip:{maxWidth:"250px"}},o)}),de={circle:{borderColor:"".concat(N.z.TeamsAppBrand00," ").concat(N.z.TeamsDarkPurple," ").concat(N.z.TeamsDarkPurple),marginBottom:"10px"}},ce=(0,d.J9)(e=>{let t,o,r,n;switch(e){case a.Sx.TeamsDark:t=N.z.NeutralPrimaryAlt,o=N.z.TeamsHoverBackgroundColor,r=N.z.NeutralPrimaryAlt,n=N.z.TeamsHoverBackgroundColor;break;case a.Sx.TeamsContrast:t=N.z.HighContrastBlackSelectedTextBackground,o=N.z.Black,r=N.z.HighContrastYellow,n=N.z.Black;break;default:t=N.z.TeamsHoverBackgroundColor,o=N.z.NeutralDarkGrey24,r=N.z.TeamsHoverBackgroundColor,n=N.z.NeutralDarkGrey24}return{groupPickerRoot:{ul:{marginLeft:"0px",paddingLeft:"10px",marginTop:"0px",".selected":{backgroundColor:t,color:o}},li:{":hover":{backgroundColor:r,color:n}},img:{borderRadius:"5px"},padding:"0px"},groupFilter:{paddingTop:"15px",paddingBottom:"15px",paddingLeft:"25px",paddingRight:"25px"},subComponentStyles:{groupList:ue(e),searchBar:pe()}}}),pe=(0,d.J9)(()=>({root:{borderColor:"transparent",backgroundColor:"transparent"}})),ue=(0,d.J9)(e=>({groupListRoot:{maxHeight:"300px"},groupRow:[(0,k.gS)(),{backgroundColor:N.z.Black,maxWidth:"100%",margin:"0px 0px",padding:"10px 10px"}],icon:[(0,k.$Z)("52px"),{height:"52px",width:"52px"}],groupContext:{},groupInfo:{},groupName:{}})),me=(0,d.J9)(e=>({title:e.dialogTitle,topButton:e.dialogTopButton})),he=(0,d.J9)(e=>({dialogContainer:(0,b.Zq)("dialogContainer",e.dialogContainer),dialogFooterButtons:(0,b.Zq)("dialogFooterButtons",e.dialogFooterButtons),dialogFooter:(0,b.Zq)("dialogFooter",e.dialogFooter),groupPickerButton:(0,b.Zq)("groupPickerButton",e.groupPickerButton),label:(0,b.Zq)("labelStyles",e.label),labelWithInfoIcon:(0,b.Zq)("labelWithInfoIcon",e.labelWithInfoIcon),infoIcon:(0,b.Zq)("infoIcon",e.infoIcon),inputField:(0,b.Zq)("inputField",e.inputField),labelDescription:(0,b.Zq)("labelDescription",e.labelDescription),dropdown:(0,b.Zq)("dropdown",e.dropdown),loadingSpinner:(0,b.Zq)("loadingSpinner",e.loadingSpinner),dialogTitle:(0,b.Zq)("dialogTitle",e.dialogTitle),dialogTopButton:(0,b.Zq)("dialogTopButton",e.dialogTopButton),tooltip:(0,b.Zq)("tooltip",e.tooltip)}));var ge,Ce;!function(e){e.CreateNewForm="CreateNewForm",e.AddExistingForm="AddExistingForm"}(ge||(ge={})),function(e){e.Normal="Normal",e.Loading="Loading",e.Error="Error"}(Ce||(Ce={}));class xe extends s.${name(){return"AddFormRequirementDialog"}componentDidMount(){this.state.selectedGroup&&this.props.fetchFormsInGroup(this.state.selectedGroup.id)}componentDidUpdate(e,t){var o;("CreateNewForm"===t.selectedFormOption&&"AddExistingForm"===this.state.selectedFormOption&&null!==(o=this.state.selectedGroup)&&void 0!==o&&o.id||this.state.selectedGroup&&this.state.selectedGroup!==t.selectedGroup)&&this.props.fetchFormsInGroup(this.state.selectedGroup.id)}renderComponent(){const{dialogContainer:e}=this.getClassNames();let t,o,r=K.h.normal;switch(this.state.dialogState){case"Loading":o=void 0,t=this.renderLoading();break;case"Error":o=L.p.Strings.AddFormRequirementDialog_CreateFormErrorDialogTitle,t=this.renderError(),r=K.h.close;break;default:o=L.p.Strings.AddFormRequirementDialog_AddFormRequirementDialogTitle,t=this.renderDialogContent()}return n.createElement(M.l,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{className:this.props.dialogContentClassName,closeButtonAriaLabel:L.p.Strings.AddFormRequirementDialog_CloseDialogAriaLabel,title:o,styles:me(le(this.props.theme,this.state.showGroupPickerCallout,this.props.contentStyles)),type:r},modalProps:{className:this.props.dialogClassName,containerClassName:(0,C.A)(this.props.dialogContainerClassName,e),isBlocking:!1}},t)}renderDialogContent(){return n.createElement("div",null,this.renderGroupPickerButton(),this.state.showGroupPickerCallout&&this.renderGroupPickerCallout(),this.renderFormOptions(),this.isInitialInputValid()&&this.renderCreateNewFormInput(),this.isInitialInputValid()&&this.renderAddExistingFormInput(),this.renderFooter())}renderLoading(){const{loadingSpinner:e}=this.getClassNames(),t=L.p.Strings.AddFormRequirementDialog_CreateFormLoadingText;return n.createElement("div",{className:e},n.createElement(U.y,{size:Y.H.large,ariaLabel:t,styles:de}),t)}renderError(){const{dialogFooterButtons:e,dialogFooter:t}=this.getClassNames();return n.createElement("div",null,L.p.Strings.AddFormRequirementDialog_CreateFormErrorText,n.createElement(c.E,{className:t},n.createElement(l.j,{className:(0,C.A)("saveButton",e),onClick:this.onSubmit},L.p.Strings.AddFormRequirementDialog_TryAgainButtonText)))}renderFooter(){const{dialogFooterButtons:e,dialogFooter:t}=this.getClassNames(),o="CreateNewForm"===this.state.selectedFormOption?L.p.Strings.AddFormRequirementDialog_CreateNewFormButtonText:L.p.Strings.AddFormRequirementDialog_AddExistingFormButtonText;return n.createElement(c.E,{className:t},this.isInitialInputValid()&&n.createElement(l.j,{className:(0,C.A)("saveButton",e),disabled:!this.isRequiredInputValid(),onClick:this.onSubmit},o),n.createElement(Q.Y,{className:(0,C.A)("cancelButton",e),onClick:this.props.onDismiss},L.p.Strings.SharedComponents_CancelButtonText))}isRequiredInputValid(){if(!this.state.selectedGroup)return!1;switch(this.state.selectedFormOption){case"CreateNewForm":return!!this.state.formDisplayName;case"AddExistingForm":return!!this.state.selectedExistingForm&&!!this.state.formDisplayName;default:return!1}}isInitialInputValid(){return!(!this.state.selectedGroup||!this.state.selectedFormOption)}renderGroupPickerButton(){var e;const{groupPickerButton:t,labelWithInfoIcon:o,tooltip:i}=this.getClassNames(),a=n.createElement(n.Fragment,null,this.state.selectedGroup?n.createElement("div",{className:"groupContent"},null===(e=this.state.selectedGroup)||void 0===e?void 0:e.displayName):n.createElement(n.Fragment,null,n.createElement("div",{className:"defaultContent"},L.p.Strings.AddFormRequirementDialog_GroupPickerPlaceholder),n.createElement("div",{className:"groupSelectionDropdownIcon"},n.createElement(x.I,T.Ju))));return n.createElement(n.Fragment,null,n.createElement("div",{className:o},n.createElement(p.J,{required:!0},L.p.Strings.AddFormRequirementDialog_GroupPickerLabel),n.createElement(re.S,{plannerTheme:this.props.theme,directionalHint:X.A.rightCenter,content:L.p.Strings.AddFormRequirementDialog_GroupPickerTooltipText,className:i},n.createElement(x.I,(0,r.A)((0,r.A)({},T.h_),{},{tabIndex:0})))),n.createElement("button",{"aria-haspopup":!0,className:t,onClick:this.onGroupPickerButtonClicked,type:"button",ref:e=>this.groupPickerButton=e},a))}renderGroupPickerCallout(){const e={theme:this.props.theme,hideHeaderFooter:!0,renderGroupContextInfo:!1,currentGroup:this.state.selectedGroup,groups:this.props.groups,sensitivityLabels:null,getGroupPhoto:()=>null,setGroup:e=>{this.setState({selectedGroup:e})},onRenderGroup:()=>null,alertUser:()=>null,onDismiss:this.onGroupPickerCalloutDismiss};return n.createElement(ne.P,{calloutWidth:this.groupPickerButton.getBoundingClientRect().width,isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:this.groupPickerButton,onDismiss:this.onGroupPickerCalloutDismiss,setInitialFocus:!0,styles:(0,ae.df)(this.props.theme)},n.createElement($,(0,r.A)({styles:ce(this.props.theme)},e)))}renderFormOptions(){const{dropdown:e}=this.getClassNames(),t=[{key:"CreateNewForm",text:L.p.Strings.AddFormRequirementDialog_CreateNewFormOption},{key:"AddExistingForm",text:L.p.Strings.AddFormRequirementDialog_AddExistingFormOption}];return n.createElement(ee.t,{label:L.p.Strings.AddFormRequirementDialog_FormOptionsDropdownLabel,debounceInterval:200,appTheme:this.props.theme,options:t,placeholder:L.p.Strings.AddFormRequirementDialog_FormOptionsDropdownPlaceholder,required:!0,selectedKey:this.state.selectedFormOption,onChange:this.onFormOptionChanged,className:(0,C.A)(e,"formOptionsDropdown")})}renderCreateNewFormInput(){if("CreateNewForm"!==this.state.selectedFormOption)return null;const{labelWithInfoIcon:e,inputField:t,labelDescription:o}=this.getClassNames();return n.createElement("div",{className:"createNewFormInput"},n.createElement(p.J,{className:e,required:!0},L.p.Strings.AddFormRequirementDialog_FormDisplayNameInputLabel),n.createElement("div",{className:o},L.p.Strings.AddFormRequirementDialog_FormDisplayNameInputDescription),n.createElement(te.A,{appTheme:this.props.theme,placeholder:L.p.Strings.AddFormRequirementDialog_FormDisplayNameInputPlaceholder,styleType:oe.u.Dialog,className:t,onChange:(e,t)=>{this.setState({formDisplayName:t})},value:this.state.formDisplayName,maxLength:ie.l.TitleMaxLength}))}renderAddExistingFormInput(){var e;if("AddExistingForm"!==this.state.selectedFormOption||!this.state.selectedGroup)return null;const{label:t,inputField:o,dropdown:r}=this.getClassNames();let i=[];const a=this.props.getFormsInGroup(this.state.selectedGroup.id);return a&&(i=a.map(e=>({key:e.id,text:e.title,data:e}))),n.createElement("div",{className:"addExistingFormInput"},n.createElement(ee.t,{label:L.p.Strings.AddFormRequirementDialog_ExistingFormDropdownLabel,debounceInterval:200,appTheme:this.props.theme,placeholder:L.p.Strings.AddFormRequirementDialog_ExistingFormDropdownPlaceholder,options:i,required:!0,selectedKey:null===(e=this.state.selectedExistingForm)||void 0===e?void 0:e.id,onChange:this.onExistingFormChanged,className:(0,C.A)(r,"existingFormsDropdown")}),n.createElement(p.J,{className:t,required:!0},L.p.Strings.AddFormRequirementDialog_FormDisplayNameInputLabel),n.createElement(te.A,{appTheme:this.props.theme,placeholder:L.p.Strings.AddFormRequirementDialog_FormDisplayNameInputPlaceholder,styleType:oe.u.Dialog,className:o,onChange:(e,t)=>{this.setState({formDisplayName:t})},value:this.state.formDisplayName}))}getClassNames(){const{theme:e,contentStyles:t}=this.props;return he(le(e,this.state.showGroupPickerCallout,t))}constructor(e,t){var o;super(e,t),this.onSubmit=()=>{if(this.setState({dialogState:"Loading"}),"CreateNewForm"===this.state.selectedFormOption&&this.state.selectedGroup)this.props.onCreateForm(this.state.formDisplayName,this.state.selectedGroup.id).then(()=>{this.props.onDismiss(),this.setState({dialogState:"Normal"})}).catch(()=>{this.setState({dialogState:"Error"})});else if("AddExistingForm"===this.state.selectedFormOption&&this.state.selectedExistingForm){const e=(0,r.A)((0,r.A)({},this.state.selectedExistingForm),{},{title:this.state.formDisplayName});this.props.onAddExistingForm(e).then(()=>{this.props.onDismiss(),this.setState({dialogState:"Normal"})})}},this.onGroupPickerButtonClicked=()=>{this.setState(e=>({showGroupPickerCallout:!e.showGroupPickerCallout}))},this.onGroupPickerCalloutDismiss=()=>{this.setState({showGroupPickerCallout:!1})},this.onFormOptionChanged=(e,t)=>{this.setState({selectedFormOption:t.key})},this.onExistingFormChanged=(e,t)=>{this.setState({selectedExistingForm:t.data})},this.state={selectedFormOption:null,selectedExistingForm:null,selectedGroup:null!==(o=this.props.currentGroup)&&void 0!==o?o:null,showGroupPickerCallout:!1,existingForms:[],formDisplayName:"",dialogState:"Normal"}}}},77711:(e,t,o)=>{o.d(t,{$:()=>a});var r=o(65043),n=o(16112),i=o(91900);class a extends n.${renderComponent(){const{children:e,planContainerId:t,onRender:o}=this.props;return t?r.createElement(i.n,{containerId:t,onLoad:o},e):r.createElement(r.Fragment,null,e)}constructor(e,t){super(e,t),this.name=()=>"PlanPhotoContainer"}}},91900:(e,t,o)=>{o.d(t,{n:()=>c});var r=o(65043),n=o(16112),i=o(22317),a=o(66783),s=o(52195);const l=(0,a.J9)(()=>({anchor:{minHeight:"1px"}})),d=(0,a.J9)(e=>({anchor:(0,s.Zq)("virtualContainer-anchor",e.anchor)}));class c extends n.${componentDidUpdate(e,t){e.containerId!==this.props.containerId&&this.setState({hasLoaded:!1})}renderComponent(){return r.createElement(r.Fragment,null,this.renderIntersectionObs(),this.props.children)}renderIntersectionObs(){const e=this.getClassNames();return r.createElement("div",{className:"virtualContainer-wrapper"},r.createElement(i.pL,{onChange:this.handleInView,triggerOnce:!0},r.createElement("div",{className:e.anchor})))}getClassNames(){return d(l())}constructor(e,t){super(e,t),this.name=()=>"VirtualContainer",this.handleInView=e=>{!this.state.hasLoaded&&e&&(this.props.onLoad(),this.setState({hasLoaded:!0}))},this.state={hasLoaded:!1}}}}}]);
//# sourceMappingURL=addformrequirementdialog.508ab8c6.chunk.js.map