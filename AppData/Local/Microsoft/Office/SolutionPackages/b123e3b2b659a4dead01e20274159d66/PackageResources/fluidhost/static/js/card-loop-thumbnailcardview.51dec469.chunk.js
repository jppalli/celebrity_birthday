"use strict";(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[77738],{1720:(e,t,a)=>{a.d(t,{u:()=>i});var n=a(81536),r=a(28144),o=a(48612);const i=(e,t,a,i,l,s,c,d,u,p)=>m=>{switch((0,n.v)(e,t,i)){case"Full":"openUrl"===m.type&&(0,r.X)(a,m.value,l,s,u);break;case"None":case"Limited":(0,o.l)(a,e,i,s,c,d,p)}}},21916:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var n=a(41851),r=a(94308),o=a(24720),i=a(64867),l=a(92964),s=a(47137),c=a(13569),d=a(1720),u=a(25055),p=a(25526),m=a(15357),f=a(65043),v=(0,m.m)({lookupString:function(e){return function(){return e}}},"LocalizationComponentsStringProvider");v.Provider;var h,g=a(17122),k=a(96633),w=a(27663);!function(e){e.buttons="thumbnail-card-buttons",e.image="thumbnail-card-image",e.title="thumbnail-card-title",e.subtitle="thumbnail-card-subtitle"}(h||(h={}));const y=()=>{const{cardData:e,isVerificationRequired:t,appStatus:a}=(0,n.f)(),{baseCardPerfMarker:m,logger:y}=(0,r.g)(),{cardChannelProvider:E,metaOSProvider:b,urlHandlerProvider:C}=(0,o.g)(),{setAppStatus:S,setMessageData:P,setVerificationStatus:I}=(0,i.t)(),{theme:U}=(0,l.d)(),N=f.useContext(v),A=e.payload,O=A.tap,T=A.text||"",M=A.images,V=null===M||void 0===M?void 0:M[0],x=(0,c.O)(U),L=(0,d.u)(a,t,e.appId,e.verificationStatus,C,b,S,P,y,N);return f.useEffect(()=>{m.end(!0)},[m]),f.useEffect(()=>{(0,s.V)(a,t,e,E,b,y,I,P,S,N)},[a,E,e,t,b,S,P,I,N]),f.createElement(g.B,{key:"thumbnailCardView",tokens:{childrenGap:10},className:x.cardStack,onClick:O&&(e=>{try{e.stopPropagation(),L(O)}catch(t){}})},f.createElement(g.B,{horizontal:!0,tokens:{childrenGap:10}},V?f.createElement(k.a,null,f.createElement(w._,{"data-tid":h.image,src:V.url,alt:V.alt,className:x.thumbnailImage,height:100,width:100})):[],f.createElement(g.B,{tokens:{childrenGap:5}},f.createElement(u.F,{className:x.cardTitle,content:A.title,datatid:h.title}),f.createElement(u.F,{className:x.cardSubTitle,content:A.subtitle,datatid:h.subtitle}),T&&f.createElement(u.F,{className:x.cardText,content:T}))),f.createElement(p.w,{actions:A.buttons||[],buttonClassName:x.cardButton,containerClassName:x.buttonStack,onClick:L,payload:A,datatid:h.buttons}))}},25526:(e,t,a)=>{a.d(t,{w:()=>l});var n=a(50317),r=a(17122),o=a(65043),i=a(35427);const l=e=>{const{actions:t,buttonClassName:a,containerClassName:l,onClick:s,payload:c,datatid:d}=e,u=(0,n.u)(t)?t.slice(0,6):t;return o.createElement(r.B,{horizontal:!0,"data-tid":d,wrap:!0,tokens:{childrenGap:20},className:l},u.map((e,t)=>o.createElement(r.B.Item,{key:t},o.createElement(i.r,{key:t,className:a,action:e,onClick:s,payload:c}))))}},26901:(e,t,a)=>{a.d(t,{Al:()=>o,Iq:()=>l,Md:()=>d,WK:()=>i,gy:()=>s});var n=a(82381);const r="medium";function o(e,t){try{const a=/^\/l\/stage\/([^/]+)\/([^/]+)$/,n=e.pathname.match(a);if(3!==(null===n||void 0===n?void 0:n.length)||!n[1]||n[1]!==t){const e=new Error("Invalid StageView deep link");throw e.name="StageViewDeepLinkParseError",e}const r=t,o=e.searchParams.get("context"),i=decodeURIComponent(null!==o&&void 0!==o?o:"");return{appId:t,deepLinkAppId:r,stageInfo:JSON.parse(i)}}catch(a){const e=new Error((0,n.r)(a,"Unable to parse StageView deep link"));throw e.name="StageViewDeepLinkParseError",e}}function i(e,t){try{var a,o,i,l,s,d;const n=/^\/l\/task\/([^/]+)$/,u=e.pathname.match(n);if(2!==(null===u||void 0===u?void 0:u.length)||!u[1]||u[1]!==t){const e=new Error("Invalid TaskModule deep link");throw e.name="TaskModuleDeepLinkParseError",e}const p=e.searchParams.get("card");return{appId:t,taskInfo:{title:null!==(a=e.searchParams.get("title"))&&void 0!==a?a:void 0,width:c(null!==(o=e.searchParams.get("width"))&&void 0!==o?o:r),height:c(null!==(i=e.searchParams.get("width"))&&void 0!==i?i:r),url:null!==(l=e.searchParams.get("url"))&&void 0!==l?l:void 0,card:p?JSON.parse(p):void 0,fallbackUrl:null!==(s=e.searchParams.get("fallbackUrl"))&&void 0!==s?s:void 0,completionBotId:null!==(d=e.searchParams.get("completionBotId"))&&void 0!==d?d:void 0}}}catch(u){const e=new Error((0,n.r)(u,"Unable to parse TaskModule deep link"));throw e.name="TaskModuleDeepLinkParseError",e}}function l(e){return e.startsWith("https://teams.microsoft.com/l/stage")}function s(e){return e.startsWith("https://teams.microsoft.com/l/task")}function c(e){let t="medium";if("string"===typeof e)switch(e=e.toLowerCase()){case"small":case"medium":case"large":t=e;break;default:t=r}else"number"===typeof e&&(t=e);return t}function d(e,t){let a;var n;if("StageView"===t)a=null===e||void 0===e||null===(n=e.stageInfo)||void 0===n?void 0:n.websiteUrl;else if("TaskModule"===t){var r;a=null===e||void 0===e||null===(r=e.taskInfo)||void 0===r?void 0:r.fallbackUrl}if(!a){const e=new Error("Fallback url is empty");throw e.name="OpenUrlActionError",e}return new URL(a)}},28144:(e,t,a)=>{a.d(t,{X:()=>s});var n=a(82381),r=a(26901);const o="noopener noreferrer";function i(e){return"http:"===e.protocol.toLowerCase()||"https:"===e.protocol.toLowerCase()?(window.open(e,"_blank",o),Promise.resolve(!0)):Promise.resolve(!1)}var l=a(46675);function s(e,t,a,o,s,c,d){let u="OpenUrl";try{if(!t||!(0,l.A)(t)){const e=new Error("Action url is empty or invalid");throw e.name="OpenUrlActionError",e}let n=new URL(t);if((0,r.Iq)(t)){u="StageView",s.logEvent("info","OpenUrlActionClicked",{actionType:u});const t=null===c||void 0===c?void 0:c.getCustomProperty("deepLinkPayload"),a=null!==t&&void 0!==t?t:(0,r.Al)(n,e);if(!a){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}var p;if("function"===typeof o.openStageView)return a.onDismiss=()=>{null===d||void 0===d||d.refreshCard()},void(null===(p=o.openStageView)||void 0===p||p.call(o,a));s.logEvent("error","MetaOSHandlerNotImplemented",{message:"Handler: openStageView; OpenUrlActionType: ".concat(u)}),n=(0,r.Md)(a,u)}else if((0,r.gy)(t)){u="TaskModule",s.logEvent("info","OpenUrlActionClicked",{actionType:u});const t=null===c||void 0===c?void 0:c.getCustomProperty("deepLinkPayload"),a=null!==t&&void 0!==t?t:(0,r.WK)(n,e);if(!a){const e=new Error("Payload is empty");throw e.name="OpenUrlActionError",e}var m;if("function"===typeof o.launchTaskModule)return a.onDismiss=()=>{null===d||void 0===d||d.refreshCard()},void(null===(m=o.launchTaskModule)||void 0===m||m.call(o,a));s.logEvent("error","MetaOSHandlerNotImplemented",{message:"Handler: launchTaskModule; OpenUrlActionType: ".concat(u)}),n=(0,r.Md)(a,u)}s.logEvent("info","OpenUrlActionClicked",{actionType:u}),a?a.onClick(n).then(e=>{e||i(n)}):i(n)}catch(f){s.logEvent("error","OpenUrlActionExecutionError",{actionType:u,message:(0,n.r)(f,"Error while executing OpenUrl action")})}}},35427:(e,t,a)=>{a.d(t,{r:()=>o});var n=a(11638),r=a(65043);const o=r.memo(e=>{const t=r.useRef(!1),{action:a,className:o,onClick:i}=e,[l,s]=r.useState(!1),c=r.useCallback(e=>t.current&&s(e),[]);r.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]);const d=r.useCallback(e=>{try{e.stopPropagation(),c(!0),i(a)}catch(t){}finally{c(!1)}},[i,a,c]);return r.createElement(n.Y,{className:o,text:a.title,disabled:l,onClick:d})});o.displayName="CardButton"},46675:(e,t,a)=>{function n(e){try{const t=new URL(e);return[!!t.origin,"https:"===t.protocol].every(e=>e)}catch(t){return!1}}a.d(t,{A:()=>n})},47137:(e,t,a)=>{a.d(t,{V:()=>o});var n=a(27051),r=a(48612);const o=async(e,t,a,o,i,l,s,c,d,u)=>{const{verificationStatus:p}=a;if(t&&"Unknown"===p&&"Installed"===e&&a.signature)try{if(!a.updateExtension)throw l.logEvent("error","NoUpdateExtensionFound",{message:"No update extension found while verifying cards"}),new Error("No update extension found");const t={cardId:a.cardId,metaOSAppId:a.appId,signature:a.signature,content:JSON.stringify(a.payload),verificationStatus:a.verificationStatus,extension:{updateExtendedProps:{type:"updateExtendedProps",data:(0,n.A)((0,n.A)({},a.updateExtension.data),{},{contentType:a.cardType})}}};if("function"===typeof o.cardVerify){const n=function(e){return e.cards[0].verificationStatus}(await o.cardVerify(t));s(n),(0,r.l)(a.appId,e,n,i,d,c,u)}}catch(m){}}},50317:(e,t,a)=>{function n(e){return Array.isArray(e)&&(null===e||void 0===e?void 0:e.length)>0}a.d(t,{u:()=>n})},81536:(e,t,a)=>{a.d(t,{v:()=>n});const n=(e,t,a)=>t?"Installed"===e&&"Success"===a?"Full":"None":"Full"}}]);
//# sourceMappingURL=card-loop-thumbnailcardview.51dec469.chunk.js.map