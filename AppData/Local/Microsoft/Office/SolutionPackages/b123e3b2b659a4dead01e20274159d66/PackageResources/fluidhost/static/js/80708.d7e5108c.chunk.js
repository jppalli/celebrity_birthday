(self.webpackChunkfluidhost=self.webpackChunkfluidhost||[]).push([[80708],{10871:(e,t,r)=>{var i=r(71775),s=r(19449)(function(e,t,r){i(e,r,t)});e.exports=s},11569:(e,t,r)=>{"use strict";r.d(t,{L:()=>i});class i{toGraphSerializable(){return{isApprovalRequired:this.isApprovalRequired}}static fromResource(e){return new i(e.isApprovalRequired)}setProperty(e,t){const r=new i(this.isApprovalRequired);return r[e]=t,r}constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isApprovalRequired=e}}},12358:(e,t,r)=>{var i=r(95694),s=r(41069),n=/[&<>"']/g,o=RegExp(n.source);e.exports=function(e){return(e=s(e))&&o.test(e)?e.replace(n,i):e}},13378:(e,t,r)=>{"use strict";r.d(t,{e:()=>p});var i=r(14740),s=r.n(i),n=r(55491),o=r.n(n),a=r(40840),l=r.n(a),c=r(56707),d=r.n(c),u=r(98424);class p{static getClientDictionaryType(e){const t={};return l()(e,(e,r)=>{t[r]=new p(r,e.IsChecked,e.OrderHint,e.Title)}),t}static getGraphChecklistItem(e,t){return new p(e,t.isChecked,t.orderHint,t.title)}static getGraphClientDictionaryType(e){const t={};return l()(e,(e,r)=>{t[r]=p.getGraphChecklistItem(r,e)}),t}static getResourceDictionaryType(e){const t={};return l()(e,(e,r)=>{t[r]={IsChecked:e.isChecked,OrderHint:e.orderHint,Title:e.title}}),t}static getGraphResourceDictionaryType(e){const t={};return l()(e,(e,r)=>{t[r]={"@odata.type":"microsoft.graph.plannerChecklistItem",isChecked:e.isChecked,orderHint:e.orderHint,title:e.title},null!=e.lastModifiedBy&&(t[r].lastModifiedBy=e.lastModifiedBy),null!=e.lastModifiedDateTime&&(t[r].lastModifiedDateTime=e.lastModifiedDateTime)}),t}static getSortedChecklistItems(e){return s()(d()(e)).sort((e,t)=>-1*u.O.compareOrderHints(e.orderHint,t.orderHint))}static cloneChecklist(e){const t={};return o()(e,e=>{t[e.id]=e.getClone()}),t}static setChecklistProperty(e,t,r,i){if(null==e[t])throw new Error("ArgumentException: id not found in checklist");const s=p.cloneChecklist(e);return s[t]=s[t].setProperty(r,i),s}setProperty(e,t){if("isChecked"!==e&&"orderHint"!==e&&"title"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}toWebSerializable(){return{IsChecked:this.isChecked,OrderHint:this.orderHint,Title:this.title}}toGraphSerializable(){return{"@odata.type":"microsoft.graph.checklistItem",isChecked:this.isChecked,orderHint:this.orderHint,title:this.title}}getClone(){return new p(this.id,this.isChecked,this.orderHint,this.title)}constructor(e,t,r,i){this.id=e,this.isChecked=t,this.orderHint=r,this.title=i}}p.TitleMaxLength=100},14740:e=>{e.exports=function(e){for(var t=-1,r=null==e?0:e.length,i=0,s=[];++t<r;){var n=e[t];n&&(s[i++]=n)}return s}},14983:(e,t,r)=>{"use strict";var i;r.d(t,{Er:()=>i,LP:()=>s,ig:()=>n}),function(e){e.Word="Word",e.Excel="Excel",e.PowerPoint="PowerPoint",e.OneNote="OneNote",e.Project="Project",e.Visio="Visio",e.Pdf="Pdf",e.Loop="Loop",e.Other="Other"}(i||(i={}));i.OneNote,i.Project,i.Visio;var s,n=["jpg","jpeg","png","gif","bmp"];!function(e){e.Stream="stream-video",e.Youtube="yt-video",e.Vimeo="vimeo-video",e.DailyMotion="dm-video",e.Facebook="fb-video"}(s||(s={}))},16698:(e,t,r)=>{"use strict";r.d(t,{W:()=>l});var i,s,n,o,a=r(14983);!function(e){var t=/^(?:(?:https?):)?(?:\/\/)?(?:www\.)?(?:(?:dailymotion\.com(?:\/embed)?\/video)|dai\.ly)\/([a-zA-Z0-9]+)(?:_[\w_-]+)?$/;e.tryParseVideoUrl=function(e,r){var i=e.match(t);return null!=i&&(r.canPlay=!0,r.embedUrl="https://www.dailymotion.com/embed/video/"+i[1]+"?autoplay=0",r.provider=a.LP.DailyMotion,!0)}}(i||(i={})),function(e){var t=new RegExp("https://(.*).microsoftstream.com/(video/.*)");e.tryParseVideoUrl=function(e,r){var i=e.match(t);return null!=i&&(r.canPlay=!0,r.embedUrl="https://"+i[1]+".microsoftstream.com/embed/"+i[2]+"?autoplay=false",r.provider=a.LP.Stream,!0)}}(s||(s={})),function(e){var t=/vimeo\.com\/album\/.+\/video\/(.+)/,r=/vimeo\.com\/channels\/.+\/(.+)/,i=/vimeo\.com\/groups\/.+\/videos\/(.+)/,s=/vimeo\.com\/ondemand\/.+\/(.+)/,n=/vimeo\.com\/(.+)/;e.tryParseVideoUrl=function(e,o){var l=e.match(t)?e.match(t):e.match(r)?e.match(r):e.match(i)?e.match(i):e.match(s)?e.match(s):e.match(n);return null!=l&&(o.canPlay=!0,o.embedUrl="https://player.vimeo.com/video/"+l[1]+"?autoplay=0",o.provider=a.LP.Vimeo,!0)}}(n||(n={})),function(e){var t=/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})|youtube\.com\/playlist\?list=/;e.tryParseVideoUrl=function(e,r){var i=e.match(t);return null!=i&&(r.canPlay=!0,r.embedUrl="https://www.youtube.com/embed/"+i[1]+"?autoplay=0",r.provider=a.LP.Youtube,!0)}}(o||(o={}));var l=function(){function e(){}return e.TryParseVideoUrl=function(e){var t={canPlay:!1,embedUrl:"",provider:"Unknown"};return s.tryParseVideoUrl(e,t)||n.tryParseVideoUrl(e,t)||i.tryParseVideoUrl(e,t)||o.tryParseVideoUrl(e,t),t},e}()},17776:(e,t,r)=>{"use strict";r.d(t,{g:()=>v});var i=r(72761),s=r(70252),n=r(88908),o=r(55491),a=r.n(o),l=r(42410),c=r(91246);class d{build(){return new v(this)}fromGraphResource(e){return this.withPropertyBag({version:e["@odata.etag"],id:e.id,orderHint:e.orderHint})}fromWebResource(e){return this.withPropertyBag({id:e.Id,orderHint:e.OrderHint,version:null!=e.ItemVersion?e.ItemVersion.toString():void 0})}newFromDifferentialUpdate(e){if(e.entityType!==i.I.Task&&e.entityType!==i.I.TaskboardBucketTaskFormatting)throw new Error("ArgumentException: invalid entity");const t=v.builder.withPropertyBag({id:e.id,version:e.itemVersion}).build(),r=e.getCreateDiffData(i.I.TaskboardBucketTaskFormatting),s=t.applyDiffs(r);return this.forClone(s)}forClone(e){return this.withPropertyBag({id:e.id,orderHint:e.orderHint,version:e.itemVersion})}withPropertyBag(e){return this.id=e.id,this.orderHint=e.orderHint||this.orderHint,this.version=e.version||this.version,this}withDefaultValues(){return this.withPropertyBag({id:"TaskID",orderHint:"orderhint1",version:"1"})}getDiffDataFromWebResource(e,t){const r={};return a()(e.Changes,t=>{switch(t.FieldName){case"OrderHint":e.ItemType===i.I.TaskboardBucketTaskFormatting&&(r.orderHint=t.Value);break;case"TaskBoardBucketOrderHint":r.orderHint=t.Value}}),r}getDiffDataFromGraphResource(e,t){const r=new l.F;return r.addMapping("orderHint","orderHint"),r.translate(e)}withId(e){return this.id=e,this}constructor(){this.id=c.o.generate(),this.orderHint=" !",this.version=""}}var u=r(679),p=r(17002),h=r.n(p),m=r(54320),g=r.n(m),f=r(36777),y=r.n(f);class v extends n.W{static get builder(){return new d}get taskboardType(){return s.s.Bucket}get entityType(){return i.I.TaskboardBucketTaskFormatting}setProperty(e,t){if("orderHint"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}toWebSerializable(){return{Id:this.id,OrderHint:this.orderHint,TaskBoardType:this.taskboardType,ItemVersion:g()(this.itemVersion)?null:parseInt(this.itemVersion,10)}}toGraphSerializable(){return{"@odata.etag":g()(this.itemVersion)?void 0:this.itemVersion,id:this.id,orderHint:this.orderHint}}getDiff(e){return u.B.getDiff(this,e,u.B.getDiffMomentCustomizer)}applyDiffs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!h()(t,e=>null!=e))throw new Error("ArgumentException: diffs - Diffs array contains null elements");return t.length>0?y()(v.builder.build(),this,...t,u.B.applyDiffMomentCustomizer):this}applyDifferentialUpdate(e){if(e.id!==this.id)throw new Error("ArgumentException: update.id must match this.id");const t=e.getUpdateDiffData(this,this.entityType);return this.applyDiffs(t)}getClone(){return this.getCloneBuilder().build()}getCloneBuilder(){return v.builder.forClone(this)}constructor(e){super(e.id,e.version),this.orderHint=e.orderHint}}},19449:(e,t,r)=>{var i=r(94710),s=r(32952),n=r(9096),o=r(54052);e.exports=function(e,t){return function(r,a){var l=o(r)?i:s,c=t?t():{};return l(r,e,n(a,2),c)}}},20719:(e,t,r)=>{"use strict";r.d(t,{t:()=>i});const i={Word:["docx","docm","doc","dotx","dotm"],Excel:["xlsx","xlsm","xlsb","xltx","xltm","xls","xlam","xla","xlw","xml"],PowerPoint:["pptx","pptm","ppt","potx","potm","pot","thmx","pps","ppsx","ppsm","ppsam","ppa"],OneNote:["one"],Project:["mpp","mpt","mpd"],Visio:["vsdx","vsd","vsdm","vssx","vssm","vstx","vstm"],Pdf:["pdf"],Loop:["loop","fluid"]}},22717:(e,t,r)=>{var i=r(80726),s=r(21817),n=r(72283),o=r(9096),a=r(85990),l=r(54052),c=r(44543),d=r(11629),u=r(46686),p=r(51268);e.exports=function(e,t,r){var h=l(e),m=h||c(e)||p(e);if(t=o(t,4),null==r){var g=e&&e.constructor;r=m?h?new g:[]:u(e)&&d(g)?s(a(e)):{}}return(m?i:n)(e,function(e,i,s){return t(r,e,i,s)}),r}},22794:(e,t,r)=>{var i=r(79742),s=r(75117),n=r(9096);e.exports=function(e,t){return e&&e.length?i(e,n(t,2),s):void 0}},23312:(e,t,r)=>{"use strict";r.d(t,{o:()=>k});var i=r(94778),s=r(77138),n=r(36723),o=r(69491),a=r(47453);class l extends o._{build(){return new k(this)}fromAttachmentResource(e,t){var r;this.url=e,this.alias=t.Alias;const i=new a.d;return this.taskAttachmentType=i.fromAttachmentResource(e,t).build(),this.previewPriority=t.PreviewPriority,this.isProtected=null!==(r=t.isProtected)&&void 0!==r?r:this.isProtected,this}fromGraphAttachmentResource(e,t){this.url=e,this.alias=t.alias;const r=new a.d;return this.taskAttachmentType=r.fromGraphAttachmentResource(e,t).build(),this.previewPriority=t.previewPriority,this}attachmentFromDriveItem(e,t){return super.fromDriveItem(e,t),this.previewPriority="",this.isProtected=!1,this}attachmentFromForm(e,t){return super.fromForm(e,t),this.previewPriority="",this.isProtected=!1,this}fromRecentlyUploadedDriveItem(e,t,r,i,n){return this.url=e+"/"+encodeURIComponent(n)+"?web=1",this.alias=t.substring(0,k.AliasMaxLength),this.taskAttachmentType=s.Z.builder.withPropertyBag({url:this.url,taskAttachmentType:r.taskAttachmentType}).build(),this.previewPriority=i,this.isProtected=!1,this}withPropertyBag(e){return super.withPropertyBag({alias:e.alias,taskAttachmentType:e.taskAttachmentType,url:e.url}),this.previewPriority=e.previewPriority||this.previewPriority||"",this.isProtected=void 0!==e.isProtected?e.isProtected:this.isProtected,this}withExpectedData(e){return this.withPropertyBag({alias:"name/alias"+e,taskAttachmentType:s.Z.builder.withPropertyBag({taskAttachmentType:n.Er.Other,specificType:n.ig[2]}).build(),url:"https://microsoft.sharepoint.com/teams/plannerweb/Shared%20Documents/documents/"+e+".png?web=1",previewPriority:"1000"+e,isProtected:!1})}ofType(e,t,r){return this.withExpectedData(e).withPropertyBag({taskAttachmentType:s.Z.builder.withPropertyBag({taskAttachmentType:t,specificType:t===n.Er.Other?r?n.ig[0]:"unknown":null}).build()})}constructor(){super(...arguments),this.isProtected=!1}}var c=r(56434),d=r.n(c),u=r(14740),p=r.n(u),h=r(40840),m=r.n(h),g=r(56707),f=r.n(g),y=r(98424),v=r(91246);class k extends i.R{static get builder(){return new l}static getClientDictionaryType(e){const t={};return m()(e,(e,r)=>{t[r]=k.builder.fromAttachmentResource(r,e).build()}),t}static getGraphClientDictionaryType(e){const t={};return m()(e,(e,r)=>{r=decodeURIComponent(r),t[r]=k.builder.fromGraphAttachmentResource(r,e).build()}),t}static getResourceDictionaryType(e){const t={};return m()(e,(e,r)=>{t[r]=e.toWebSerializable()}),t}static getGraphResourceDictionaryType(e){const t={};return m()(e,(e,r)=>{t[k.encodeGraphReferenceKey(r)]=e.toGraphSerializable()}),t}static getSortedAttachments(e){return p()(f()(e)).sort((e,t)=>-1*y.O.compareOrderHints(e.previewPriority,t.previewPriority))}static encodeGraphReferenceKey(e){return e.replace(/%/g,"%25").replace(/\./g,"%2E").replace(/:/g,"%3A").replace(/@/g,"%40").replace(/#/g,"%23")}toWebSerializable(){return{Alias:this.alias,Type:this.taskAttachmentType?this.taskAttachmentType.taskAttachmentType:null,PreviewPriority:this.previewPriority}}toGraphSerializable(){return{"@odata.type":"#microsoft.graph.plannerExternalReference",alias:this.alias,type:this.taskAttachmentType?this.taskAttachmentType.taskAttachmentType:null,previewPriority:this.previewPriority}}getClone(){return k.builder.withPropertyBag({alias:this.alias,taskAttachmentType:this.taskAttachmentType?d()(this.taskAttachmentType):s.Z.builder.withPropertyBag({url:this.url}).build(),url:this.url,previewPriority:this.previewPriority,isProtected:this.isProtected}).build()}setProperty(e,t){if("taskAttachmentType"===e||"isProtected"===e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}getItemPath(e){if(v.o.isPlexTempId(this.url))return null;const t=decodeURIComponent(this.url);let r=decodeURIComponent(e);r.lastIndexOf("/")!==r.length-1&&(r+="/");const i=new RegExp(r,"ig");if(t.search(i)<0){let e="";const r=new RegExp("[?]sourcedoc={.*}&file=","ig");throw t.search(r)<0&&(e="OneDrive webUrl attachment url detected."),e+="Drive url different from attachment url",new Error(e)}return t.replace(i,"").replace("?web=1","")}constructor(e){super(e),this.previewPriority=e.previewPriority,this.isProtected=e.isProtected}}},27805:(e,t,r)=>{"use strict";var i;r.d(t,{u:()=>i}),function(e){e.CollectResponses="CollectResponses",e.EditForm="EditForm",e.ViewResponses="ViewResponses"}(i||(i={}))},32561:(e,t,r)=>{"use strict";r.d(t,{U:()=>ne});var i=r(27051),s=r(38752),n=r(45078),o=r(47453),a=r(72761),l=r(34648),c=r(23312),d=r(13378),u=r(54276),p=r(68501),h=r(39946),m=r(67875),g=r(48770);class f{build(){return new y(this)}fromApprovalResource(e){return this.approvalId=e.approvalId,this.approvalStatus=e.status,this}fromGraphApprovalResource(e){return this.approvalId=e.approvalId,this.approvalStatus=e.status,this}withPropertyBag(e){return this.approvalId=e.approvalId||this.approvalId||"",this.approvalStatus=void 0!==e.approvalStatus?e.approvalStatus:this.approvalStatus||g.q.UnknownFutureValue,this}}class y{static get builder(){return new f}toWebSerializable(){return{approvalId:this.approvalId,status:this.approvalStatus}}toGraphSerializable(){return{"@odata.type":"#microsoft.graph.plannerBasicApprovalAttachment",approvalId:this.approvalId,status:this.approvalStatus}}getClone(){return y.builder.withPropertyBag({approvalId:this.approvalId,approvalStatus:this.approvalStatus}).build()}setProperty(e,t){if("approvalStatus"===e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}constructor(e){this.approvalId=e.approvalId,this.approvalStatus=e.approvalStatus}}var v=r(56434),k=r.n(v),b=r(55491),T=r.n(b),w=r(22717),P=r.n(w),B=r(91246),F=r(42410);class R{build(){return new ne(this)}fromWebResource(e){const t=d.e.getClientDictionaryType(e.Checklist),r=c.o.getClientDictionaryType(e.References),i=s.B.clientSettings.Flights.TeamsTasksECS_richTextEditorEnabled&&!e.notes&&e.Description?{content:e.Description,contentType:u.c.HTML}:null,n=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,o=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,a=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,l=this.withPropertyBag({checklist:t,description:e.Description||void 0,notes:null!=e.notes?{content:e.notes.content,contentType:u.c.HTML}:i,id:e.Id,itemVersion:null!=e.ItemVersion?e.ItemVersion.toString():void 0,previewType:e.PreviewType,references:r});return(n||o||a)&&(l.completionRequirements=e.completionRequirements?p.h.builder.fromGraphResource(null===e||void 0===e?void 0:e.completionRequirements).build():null),o&&e.forms&&(l.forms=h.l.getClientDictionaryType(e.forms)),a&&e.approvalAttachment&&(l.approval=y.builder.fromApprovalResource(e.approvalAttachment).build()),l}fromGraphResource(e){const t=d.e.getGraphClientDictionaryType(e.checklist),r=c.o.getGraphClientDictionaryType(e.references),i=s.B.clientSettings.Flights.TeamsTasksECS_richTextEditorEnabled&&!e.notes&&e.description?{content:e.description,contentType:u.c.HTML}:void 0,n=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,o=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,a=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,m=this.withPropertyBag({checklist:t,description:e.description||void 0,notes:null!=e.notes?{content:e.notes.content,contentType:u.c.HTML}:i,id:e.id,itemVersion:e["@odata.etag"],previewType:l.N.getPreviewTypeFromGraph(e.previewType),references:r});return(n||o||a)&&(m.completionRequirements=e.completionRequirements?p.h.builder.fromGraphResource(null===e||void 0===e?void 0:e.completionRequirements).build():null),o&&e.forms&&(m.forms=h.l.getGraphClientDictionaryType(e.forms)),a&&e.approvalAttachment&&(m.approval=y.builder.fromGraphApprovalResource(e.approvalAttachment).build()),m}withPropertyBag(e){return this.completionRequirements=e.completionRequirements||this.completionRequirements,this.checklist=e.checklist||this.checklist,this.description=null!=e.description?e.description:this.description,this.notes=null!=e.notes?e.notes:this.notes,this.id=e.id,this.itemVersion=e.itemVersion||this.itemVersion,this.previewType=null!=e.previewType?e.previewType:this.previewType,this.references=e.references||this.references,this.forms=e.forms||this.forms,this.approval=e.approval||this.approval,this}withPreviewType(e,t){let r={};switch(e){case l.X.Description:r={description:"preview-type-description",notes:{content:"preview-type-description",contentType:u.c.HTML}};break;case l.X.CheckList:const e={},i="check list item Id",s=new d.e(i,!1,"abc a","cli title");e[s.id]=s,r={checklist:e};break;case l.X.Reference:r={references:t}}return this.withPropertyBag((0,i.A)((0,i.A)({},r),{},{previewType:e,id:this.id}))}withCompletionRequirements(e){return this.completionRequirements=e,this}withDefaultValues(){return this.withPropertyBag({checklist:{},completionRequirements:null,description:"task details description",notes:{content:"task details notes",contentType:u.c.HTML},id:"TaskDetailsId",itemVersion:"1",previewType:l.X.Automatic,references:{}})}withLocallyUniqueId(){return this.withPropertyBag({id:B.o.generate()})}withId(e){return this.id=e,this}newFromDifferentialUpdate(e){if(e.entityType!==a.I.TaskDetails&&e.entityType!==a.I.Task)throw new Error("ArgumentException: invalid entity");const t=ne.builder.withPropertyBag({id:e.id,itemVersion:e.itemVersion}).build(),r=e.getCreateDiffData(a.I.TaskDetails),i=t.applyDiffs(r);return this.forClone(i)}forClone(e){return this.withPropertyBag({checklist:k()(e.checklist),completionRequirements:k()(e.completionRequirements),description:e.description||void 0,notes:null!=e.notes?{content:e.notes.content,contentType:e.notes.contentType}:void 0,id:e.id,itemVersion:e.itemVersion,previewType:k()(e.previewType),references:k()(e.references),forms:k()(e.forms),approval:k()(e.approval)})}getDiffDataFromWebResource(e,t){const r={},i=new F.F;i.addMapping("Checklist","checklist"),i.addMapping("Description","description"),i.addMapping("notes","notes"),i.addMapping("PreviewType","previewType"),i.addMapping("References","references"),i.addMapping("forms","forms"),i.addMapping("approval","approval");const s=new F.F;s.addMapping("Title","title"),s.addMapping("IsChecked","isChecked"),s.addMapping("OrderHint","orderHint");const a=new F.F;a.addMapping("Alias","alias"),a.addMapping("PreviewPriority","previewPriority"),a.addMapping("Type","taskAttachmentType"),a.addMapping("isProtected","isProtected");const l=new F.F;l.addMapping("displayName","displayName"),l.addMapping("formResponse","formResponse"),l.addMapping("formWebUrl","collectResponsesUrl");const u=new F.F;u.addMapping("approvalId","approvalId"),u.addMapping("status","approvalStatus");let p=!1,h=!1,g=!1,f=!1,y=!1;return T()(e.Changes,e=>{const v=e.FieldName;switch(v){case"Checklist":const b=i.getMappedClientKey(v);if(1===e.PathSegments.length&&null==e.Value)r[b]=n.Wh.CollectionCleanupValue,p=!0;else if(e.PathSegments.length>=2){r[b]||(r[b]=null!==t&&void 0!==t&&t.checklist?k()(t.checklist):{});const i=e.PathSegments[1];if(2===e.PathSegments.length&&null==e.Value)delete r[b][i],p=!0;else if(3===e.PathSegments.length){const t=e.PathSegments[2];if(s.hasMapping(t)){const n=s.getMappedClientKey(t);r[b][i]||(r[b][i]=new d.e(i,!1,"","")),r[b][i][n]=s.translateValue(t,n,e.Value),p=!0}}}break;case"forms":const T=i.getMappedClientKey(v);if(1===e.PathSegments.length&&null==e.Value)r[T]=n.Wh.CollectionCleanupValue,f=!0;else if(e.PathSegments.length>=2){r[T]||(r[T]=null!==t&&void 0!==t&&t.forms?k()(t.forms):{});const i=e.PathSegments[1];if(2===e.PathSegments.length&&null==e.Value)delete r[T][i],f=!0;else if(3===e.PathSegments.length){const t="formResponseId"===e.PathSegments[2]?"formResponse":e.PathSegments[2];if(l.hasMapping(t)){const s=l.getMappedClientKey(t);if(!r[T][i]){const e=(new m.o).withPropertyBag({formId:i}).build();r[T][i]=e}r[T][i][s]=l.translateValue(t,s,e.Value),f=!0}}}break;case"approval":const w=i.getMappedClientKey(v);if(1!==e.PathSegments.length&&2!==e.PathSegments.length||null!=e.Value){if(e.PathSegments.length>=3){r[w]||(r[w]=null!==t&&void 0!==t&&t.approval?k()(t.approval):{});const i=e.PathSegments[2];if(u.hasMapping(i)){const t="status"===i?e.Value.toLowerCase():e.Value,s=u.getMappedClientKey(i);r[w][s]=u.translateValue(i,s,t),y=!0}}}else r[w]=n.Wh.CollectionCleanupValue,y=!0;break;case"notes":const P=i.getMappedClientKey(v);if(1===e.PathSegments.length&&null==e.Value)r[P]=n.Wh.CollectionCleanupValue,g=!0;else if(e.PathSegments.length>=2){r[P]||(r[P]=null!==t&&void 0!==t&&t.notes?k()(t.notes):{});const s=e.PathSegments[0],n=e.PathSegments[1],o="contentType";2===e.PathSegments.length&&i.hasMapping(s)&&(r[P][n]=i.translateValue(s,P,e.Value),r[P][o]="html",g=!0)}break;case"Description":case"PreviewType":const B=i.getMappedClientKey(v);r[B]=i.translateValue(v,B,e.Value);break;case"References":const F=i.getMappedClientKey(v);if(1===e.PathSegments.length&&null==e.Value)r[F]=n.Wh.CollectionCleanupValue,h=!0;else if(e.PathSegments.length>=2){r[F]||(r[F]=null!==t&&void 0!==t&&t.references?k()(t.references):{});const i=e.PathSegments[1];if(2===e.PathSegments.length&&null==e.Value)delete r[F][i],h=!0;else if(3===e.PathSegments.length){const t=e.PathSegments[2];if(a.hasMapping(t)){const s=a.getMappedClientKey(t);switch(r[F][i]||(r[F][i]=c.o.builder.withPropertyBag({url:i}).build()),t){case"Alias":case"PreviewPriority":case"isProtected":r[F][i][s]=a.translateValue(t,s,e.Value),h=!0;break;case"Type":const n=(new o.d).fromAttachmentResource(i,{Alias:"",PreviewPriority:"",Type:e.Value,isProtected:!1}).build();r[F][i][s]=n,h=!0}}}}}}),!h&&"references"in r&&delete r.references,!g&&"notes"in r&&delete r.notes,!p&&"checklist"in r&&delete r.checklist,!f&&"forms"in r&&delete r.forms,!y&&"approval"in r&&delete r.approval,r}getDiffDataFromGraphResource(e,t){const r=new F.F;return r.addMapping("checklist","checklist",e=>{if(null==e)return n.Wh.CollectionCleanupValue;const r=null!==t&&void 0!==t&&t.checklist?k()(t.checklist):{};for(const t in e)null==e[t]?delete r[t]:t in r?("title"in e[t]&&(r[t]=r[t].setProperty("title",e[t].title)),"isChecked"in e[t]&&(r[t]=r[t].setProperty("isChecked",e[t].isChecked)),"orderHint"in e[t]&&(r[t]=r[t].setProperty("orderHint",e[t].orderHint))):r[t]=d.e.getGraphChecklistItem(t,e[t]);return r}),r.addMapping("forms","forms",e=>{if(null==e)return n.Wh.CollectionCleanupValue;const r=null!==t&&void 0!==t&&t.forms?k()(t.forms):{};for(const t in e)if(null==e[t])delete r[t];else if(t in r)"displayName"in e[t]&&(r[t]=r[t].setProperty("displayName",e[t].displayName)),"formResponse"in e[t]&&(r[t]=r[t].setProperty("formResponse",e[t].formResponse)),"formWebUrl"in e[t]&&(r[t]=r[t].setProperty("collectResponsesUrl",e[t].formWebUrl));else{const i=(new m.o).fromGraphFormResource(t,e[t]).build();r[t]=i}return r}),r.addMapping("approvalAttachment","approval",e=>{if(null==e)return null;const r=null!==t&&void 0!==t&&t.approval?k()(t.approval):{};return"approvalId"in e&&(r.approvalId=e.approvalId),"status"in e&&(r.approvalStatus=e.status),r}),r.addMapping("description","description"),r.addMapping("notes","notes"),r.addMapping("previewType","previewType",e=>l.N.getPreviewTypeFromGraph(e)),r.addMapping("references","references",e=>{if(null==e)return n.Wh.CollectionCleanupValue;e=P()(e,(e,t,r)=>e[decodeURIComponent(r)]=t);const r=null!==t&&void 0!==t&&t.references?k()(t.references):{};for(const t in e)if(null==e[t])delete r[t];else if(t in r){if("alias"in e[t]&&(r[t]=r[t].setProperty("alias",e[t].alias)),"previewPriority"in e[t]&&(r[t]=r[t].setProperty("previewPriority",e[t].previewPriority)),"type"in e[t]){const i=(new o.d).fromGraphAttachmentResource(t,e[t]).build();r[t].taskAttachmentType=i}}else r[t]=c.o.builder.fromGraphAttachmentResource(t,e[t]).build();return r}),r.translate(e)}constructor(){this.id=B.o.generate(),this.completionRequirements=null,this.checklist={},this.references={},this.description=null,this.notes=null,this.previewType=l.X.Automatic,this.forms={},this.approval=null}}var C=r(88908),A=r(38621),D=r(11569),S=r(14740),I=r.n(S),E=r(17002),H=r.n(E),x=r(50723),U=r.n(x),V=r(85855),M=r.n(V),O=r(40840),q=r.n(O),W=r(19853),G=r.n(W),L=r(10871),N=r.n(L),z=r(28673),_=r.n(z),j=r(22794),K=r.n(j),X=r(36777),Z=r.n(X),Y=r(59364),Q=r.n(Y),$=r(35640),J=r.n($),ee=r(26727),te=r.n(ee),re=r(679),ie=r(98424),se=r(36723);class ne extends C.W{static get builder(){return new R}static mergeCustomizer(e,t,r){return"checklist"===r||"references"===r||"forms"===r?G()(t,n.Wh.CollectionCleanupValue)?{}:t:"completionRequirements"!==r||G()(e,t)?re.B.applyDiffMomentCustomizer(e,t,r):t}get entityType(){return a.I.TaskDetails}get hasThumbnail(){return(this.previewType===l.X.Reference||this.previewType===l.X.Automatic)&&null!=this.getReferenceWithLowestPriority()}toWebSerializable(){var e;const t=this.removeTemporaryAttachments(),r=d.e.getResourceDictionaryType(t.checklist),i=c.o.getResourceDictionaryType(t.references),n=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,o=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,a=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,l={References:i,Checklist:r,Id:t.id,Description:t.description,notes:null!==(e=t.notes)&&void 0!==e&&e.content?{content:t.notes.content,contentType:t.notes.contentType}:null,PreviewType:t.previewType,ItemVersion:null!=t.itemVersion?parseInt(t.itemVersion,10):null};var u,p,m;(n||o||a)&&(l.completionRequirements=null===(u=t.completionRequirements)||void 0===u?void 0:u.toGraphSerializable());(o&&(l.forms=h.l.getResourceDictionaryType(t.forms)),a)&&(l.approvalAttachment=null!==(p=null===(m=t.approval)||void 0===m?void 0:m.toWebSerializable())&&void 0!==p?p:null);return l}toGraphSerializable(){var e;const t=this.removeTemporaryAttachments(),r=d.e.getGraphResourceDictionaryType(t.checklist),i=c.o.getGraphResourceDictionaryType(t.references),n=s.B.clientSettings.Flights.TeamsTasksECS_richTextEditorEnabled,o=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,a=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,u=s.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,p=n&&null!==(e=t.notes)&&void 0!==e&&e.content?{content:t.notes.content,contentType:t.notes.contentType}:void 0,m=n?void 0:t.description,g={references:i,checklist:r,id:t.id,description:m,notes:p,previewType:l.N.getGraphPreviewType(t.previewType),"@odata.etag":null!=t.itemVersion?t.itemVersion:void 0};var f,y,v;(o||a||u)&&(g.completionRequirements=null===(f=t.completionRequirements)||void 0===f?void 0:f.toGraphSerializable());(a&&(g.forms=h.l.getGraphResourceDictionaryType(t.forms)),u)&&(g.approvalAttachment=null!==(y=null===(v=t.approval)||void 0===v?void 0:v.toGraphSerializable())&&void 0!==y?y:null);return g}setProperty(e,t){if("id"===e||"itemVersion"===e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}getDiff(e){return re.B.getDiff(this,e,(e,t,r)=>"checklist"===r||"references"===r||"forms"===r?G()(e,t)?{}:G()(t,{})?n.Wh.CollectionCleanupValue:t:"completionRequirements"!==r||G()(e,t)?re.B.getDiffMomentCustomizer(e,t,r):t)}applyDiffs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!H()(t,e=>null!=e))throw new Error("ArgumentException: diffs - Diffs array contains null elements");return t.length>0?Z()(ne.builder.build(),this,...t,ne.mergeCustomizer):this}applyDifferentialUpdate(e){if(e.id!==this.id)throw new Error("ArgumentException: update.id must match this.id");const t=e.getUpdateDiffData(this,this.entityType);return this.applyDiffs(t)}getReferenceWithHighestPriority(){const e=K()(_()(this.references),e=>this.references[e].previewPriority);return null==e?null:this.references[e]}getReferenceWithLowestPriority(){const e=Q()(_()(this.references),e=>this.references[e].previewPriority);return null==e?null:this.references[e]}getTaskPreviewReference(){return this.getReferenceWithLowestPriority()}getAttachmentsSortedByAlias(){const e=[];return q()(this.references,(t,r)=>{t.taskAttachmentType.taskAttachmentType!==se.Er.TeamsHostedApp&&e.push(t)}),e.sort((e,t)=>c.o.aliasCompare(e,t)),e}attachmentExists(e){return null!=this.references[e.url]}doesUrlExistAsAttachment(e){return null!=this.references[e]}addAttachment(e){if(null!=this.references[e.url])throw new Error("AggregateException: attachment already exists");const t=k()(this.references);return t[e.url]=e,this.setProperty("references",t)}removeAttachment(e){if(null==this.references[e])throw new Error("NotFoundException: attachment not found on task details");const t=N()(U()(this.references,t=>t.url!==e),e=>e.url);return this.setProperty("references",t)}removeTemporaryAttachments(){const e=N()(U()(this.references,e=>!B.o.isPlexTempId(e.url)),e=>e.url);return this.setProperty("references",e)}replaceAttachment(e,t){if(null==this.references[e.url])throw new Error("NotFoundException: oldAttachment not found on task details");const r=N()(U()(this.references,t=>t.url!==e.url),e=>e.url);return r[t.url]=t,this.setProperty("references",r)}checkChecklistItem(e,t){const r=d.e.setChecklistProperty(this.checklist,e,"isChecked",t);return this.setProperty("checklist",r)}getPromotedProperties(){const e=null==this.references?0:J()(this.references),t=this.getChecklistStats();return{hasDescription:!!this.description||!!this.notes,numberOfAttachments:e,numberOfActiveChecklistItems:t.numActiveItems,numberOfChecklistItems:t.numItems,previewType:this.previewType}}hasMandatoryChecklist(){var e;return null!=this.checklist&&null!=(null===(e=this.completionRequirements)||void 0===e?void 0:e.checklistRequirement)}getCopy(){const e=this.getClone();if(null!=e.checklist){const t=d.e.getSortedChecklistItems(e.checklist);T()(t,(r,i)=>{let s;s=r===M()(t)?ie.O.generateOrderHintBetween(t[i].orderHint,null):ie.O.generateOrderHintBetween(t[i].orderHint,t[i-1].orderHint),e.checklist[t[i].id]=e.checklist[t[i].id].setProperty("orderHint",s)})}if(null!=e.references){const t=c.o.getSortedAttachments(e.references);T()(t,(r,i)=>{let s;s=r===M()(t)?ie.O.generateOrderHintBetween(t[i].previewPriority,null):ie.O.generateOrderHintBetween(t[i].previewPriority,t[i-1].previewPriority),e.references[t[i].url]=e.references[t[i].url].setProperty("previewPriority",s)})}return e}getCloneBuilder(){return ne.builder.forClone(this)}getClone(){return this.getCloneBuilder().build()}getChecklistStats(){const e=null==this.checklist?{}:this.checklist,t=I()(te()(e));return{numItems:t.length,numActiveItems:t.filter(e=>!e.isChecked).length}}getFormsSortedByAlias(){const e=[];return q()(this.forms,(t,r)=>{e.push(t)}),e.sort((e,t)=>h.l.displayNameCompare(e,t)),e}addForm(e){if(null!=this.forms[e.formId])throw new Error("AggregateException: form already exists");const t=k()(this.forms);t[e.formId]=e;const r=this.setProperty("forms",t),i=_()(t);return this.updateFormsRequirement(i,r)}replaceForm(e,t){if(null==this.forms[e.formId])throw new Error("NotFoundException: oldForm not found on task details");const r=N()(U()(this.forms,t=>t.formId!==e.formId),e=>e.formId);r[t.formId]=t;const i=this.setProperty("forms",r),s=_()(r);return this.updateFormsRequirement(s,i)}removeForm(e){if(null==this.forms[e.formId])throw new Error("NotFoundException: form not found on task details");const t=N()(U()(this.forms,t=>t.formId!==e.formId),e=>e.formId),r=this.setProperty("forms",t),i=_()(t);return this.updateFormsRequirement(i,r)}updateFormsRequirement(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,i=null!==(t=r.completionRequirements)&&void 0!==t?t:p.h.builder.build();const s=0===e.length?null:new A.T(e);return i=i.setProperty("formsRequirement",s),r.setProperty("completionRequirements",i)}updateApprovalRequirement(e){const t=new D.L(e);if(this.completionRequirements){const e=this.completionRequirements.setProperty("approvalRequirement",t);return this.setProperty("completionRequirements",e)}return this.setProperty("completionRequirements",p.h.builder.withApprovalRequirement(t).build())}constructor(e){super(e.id,e.itemVersion),this.notes=e.notes?e.notes:null,this.description=e.description?e.description:null,this.checklist=e.checklist,this.previewType=e.previewType,this.references=e.references,this.completionRequirements=e.completionRequirements,this.forms=e.forms,this.approval=e.approval?e.approval:null}}ne.DescriptionMaxLength=32768,ne.MaxChecklistItemsPerTask=20},32952:(e,t,r)=>{var i=r(45652);e.exports=function(e,t,r,s){return i(e,function(e,i,n){t(s,e,r(e),n)}),s}},33268:(e,t,r)=>{"use strict";r.d(t,{XY:()=>v,lo:()=>y,sN:()=>k,wS:()=>f});var i=r(38752),s=r(8453),n=r(72761),o=r(40468),a=r(12358),l=r.n(a),c=r(54320),d=r.n(c),u=r(74844),p=r(74065),h=r.n(p),m=r(85855),g=r.n(m);class f{static getFavIconUrl(e){return"https://"+f.extractHostname(e)+"/favicon.ico"}static generateEntityHyperlink(e,t,r,i){switch(e.entityType){case n.I.Task:return this.generateTaskHyperLink(e,t,r,i);case n.I.Plan:return this.generatePlanHyperLink(e,t,r,i);default:throw new Error("NotSupportedException: entity.type")}}static generateEntityLink(e,t,r,i){switch(e.entityType){case n.I.Task:return this.generateTaskLink(e,t,r,i);case n.I.Plan:return this.generatePlanLink(e,t,r,i);default:throw new Error("NotSupportedException: entity.type")}}static generateOWAGroupEmailSettingsLink(e,t,r){if(d()(e))return r.logTrace(508047762,u.k.Warning,"Empty owa host. Hiding the whole owa link."),"";if(d()(t)||t.indexOf("@")<0||t.indexOf("@")!==t.lastIndexOf("@"))return"https://".concat(e);{const r=t.split("@")[0],i=t.split("@")[1];return"https://".concat(e,"/mail/group/").concat(i,"/").concat(r,"/action/EmailSettings")}}static extractHostname(e){let t="";return t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0],t=t.split("?")[0],t=t.split("#")[0],t}static getPlanExternalUrl(e,t){var r;const i=null===(r=o.T.builder.withPlan(e).withDetails(t).build().getCreationContextInfo())||void 0===r?void 0:r.key;let s=null;var n;i&&(s=null!==(n=t.contextDetails[i].url)&&void 0!==n?n:null);return s}static generateTaskHyperLink(e,t,r,i){return'<a href="'+this.generateTaskLink(e,t,r,i)+'" target="_blank" rel="noopener noreferrer">'+l()(e.title)+"</a>"}static generatePlanHyperLink(e,t,r,i){return'<a href="'+this.generatePlanLink(e,t,r,i)+'" target="_blank" rel="noopener noreferrer">'+l()(e.title)+"</a>"}static generateTaskLink(e,t,r,n){var o,a,l;return(null===(o=e.creationSource.external)||void 0===o?void 0:o.contextScenarioId)===s.z.project&&null!==(a=e.creationSource.external)&&void 0!==a&&a.webUrl?null===(l=e.creationSource.external)||void 0===l?void 0:l.webUrl:this.generatePlannerLink("".concat(i.B.absoluteRedirectRoot,"/Home/Task/").concat(e.id),t,r,n)}static generatePlanLink(e,t,r,s){return this.generatePlannerLink("".concat(i.B.absoluteRedirectRoot,"/Home/PlanViews/").concat(e.id),t,r,s)}static generatePlannerLink(e,t,r,i){const s=621355968e9+1e4*i.getTime();return"".concat(e,"?Type=").concat(t,"&Channel=").concat(r,"&CreatedTime=").concat(s)}static getValidUrl(e){const t=f.formatUrlWithHttpUrlScheme(e);return f.validateUrl(t)}static formatUrlWithHttpUrlScheme(e){return f.getUrlScheme(e).toLowerCase()===f.httpScheme?f.ensureUrlScheme(e,f.httpScheme):f.ensureUrlScheme(e,f.httpsScheme)}static validateUrl(e){try{const t=new URL(e);if(!t.host||!t.hostname||!t.origin||"null"===t.origin||"http:"!==t.protocol&&"https:"!==t.protocol)return;return t.toString()}catch(t){return}}static getUrlScheme(e){const t=new RegExp("(.*)://.*","i").exec(e)||[];return h()(t)||""}static ensureUrlScheme(e,t){const r=t&&g()(t.split("://"));return"".concat(r,"://").concat(f.removeUrlScheme(e))}static removeUrlScheme(e){const t=new RegExp("(http(s)?(:)?(//)?)*(.*)","i").exec(e)||[];return h()(t)||""}static getQueryParamValue(e,t){return new URLSearchParams(new URL(e).search).get(t)}}function y(e){return"".concat(b(),"hubnew?importPlanId=").concat(e)}function v(){return"".concat(i.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname,"trialFRE#templates")}function k(){return"".concat(i.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname,"trialFRE#templates/{0}")}function b(){return"".concat(i.B.clientSettings.ECSSettings.ProjectServiceConfig.Hostname).concat(i.B.tenantDomain,"/").concat(i.B.culture,"#/")}f.httpScheme="http",f.httpsScheme="https"},38621:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});class i{toGraphSerializable(){return{requiredForms:this.requiredForms}}static fromResource(e){return new i(e.requiredForms)}setProperty(e,t){const r=new i([...this.requiredForms]);return r[e]=t,r}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.requiredForms=e}}},39115:(e,t,r)=>{var i=r(45967),s=r(36311),n=r(50715);e.exports=function(e){return s(e)?n(e):i(e)}},39589:(e,t,r)=>{"use strict";r.d(t,{_:()=>c});var i=r(54320),s=r.n(i),n=r(64696),o=r(17776),a=r(97139);class l{build(){return new c(this)}fromTaskBoardTaskFormattingCollectionResource(e){return this.withPropertyBag({assignedBoardFormat:null==e.AssignmentBoardFormat?void 0:n.x.builder.fromWebResource(e.AssignmentBoardFormat).build(),bucketBoardFormat:null==e.BucketBoardFormat?void 0:o.g.builder.fromWebResource(e.BucketBoardFormat).build(),progressBoardFormat:null==e.ProgressBoardFormat?void 0:a.j.builder.fromWebResource(e.ProgressBoardFormat).build()})}fromGraphTaskBoardTaskFormattingCollectionResource(e){return this.withPropertyBag({assignedBoardFormat:null==e.assignmentBoardFormat?void 0:n.x.builder.fromGraphResource(e.assignmentBoardFormat).build(),bucketBoardFormat:null==e.bucketBoardFormat?void 0:o.g.builder.fromGraphResource(e.bucketBoardFormat).build(),progressBoardFormat:null==e.progressBoardFormat?void 0:a.j.builder.fromGraphResource(e.progressBoardFormat).build()})}withPropertyBag(e){return this.assignedBoardFormat=e.assignedBoardFormat||this.assignedBoardFormat,this.bucketBoardFormat=e.bucketBoardFormat||this.bucketBoardFormat,this.progressBoardFormat=e.progressBoardFormat||this.progressBoardFormat,this}withDefaultValues(){return this.withPropertyBag({assignedBoardFormat:void 0,bucketBoardFormat:void 0,progressBoardFormat:void 0})}constructor(){}}class c{static getAssignedToOrderHint(e,t){return null==e.assignmentBoardFormat?null:null==t||s()(t)?e.assignmentBoardFormat.unassignedOrderHint:e.assignmentBoardFormat.orderHintsByAssignee[t]}static setAssignedToOrderHint(e,t,r){if(null==e.assignmentBoardFormat)return e;let i=e.assignmentBoardFormat.getClone();if(s()(r))i=i.setProperty("unassignedOrderHint",t);else{const e=i.orderHintsByAssignee;null==t?delete e[r]:e[r]=t,i=i.setProperty("orderHintsByAssignee",e)}return e.setProperty("assignmentBoardFormat",i)}static getBucketOrderHint(e,t){return null==e.bucketBoardFormat?null:e.bucketBoardFormat.orderHint}static setBucketOrderHint(e,t,r){if(null==e.bucketBoardFormat)return e;const i=e.bucketBoardFormat.setProperty("orderHint",t);return e.setProperty("bucketBoardFormat",i)}static getProgressOrderHint(e,t){return null==e.progressBoardFormat?null:e.progressBoardFormat.orderHint}static setProgressOrderHint(e,t,r){if(null==e.progressBoardFormat)return e;const i=e.progressBoardFormat.setProperty("orderHint",t);return e.setProperty("progressBoardFormat",i)}setProperty(e,t){if("assignmentBoardFormat"!==e&&"bucketBoardFormat"!==e&&"progressBoardFormat"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}static get builder(){return new l}toWebSerializable(){return{AssignmentBoardFormat:null!=this.assignmentBoardFormat?this.assignmentBoardFormat.toWebSerializable():void 0,BucketBoardFormat:null!=this.bucketBoardFormat?this.bucketBoardFormat.toWebSerializable():void 0,ProgressBoardFormat:null!=this.progressBoardFormat?this.progressBoardFormat.toWebSerializable():void 0}}toGraphSerializable(){return{assignmentBoardFormat:null!=this.assignmentBoardFormat?this.assignmentBoardFormat.toGraphSerializable():void 0,bucketBoardFormat:null!=this.bucketBoardFormat?this.bucketBoardFormat.toGraphSerializable():void 0,progressBoardFormat:null!=this.progressBoardFormat?this.progressBoardFormat.toGraphSerializable():void 0}}getClone(){const e=this.toWebSerializable();return c.builder.fromTaskBoardTaskFormattingCollectionResource(e).build()}constructor(e){this.assignmentBoardFormat=e.assignedBoardFormat,this.bucketBoardFormat=e.bucketBoardFormat,this.progressBoardFormat=e.progressBoardFormat}}},39946:(e,t,r)=>{"use strict";r.d(t,{l:()=>u});var i=r(40840),s=r.n(i),n=r(67875),o=r(28730),a=r(61086),l=r.n(a),c=r(33268),d=r(27805);class u{static get builder(){return new n.o}static displayNameCompare(e,t){var r,i;return o.l.compareStringForDisplay(null===e||void 0===e||null===(r=e.displayName)||void 0===r?void 0:r.toUpperCase(),null===t||void 0===t||null===(i=t.displayName)||void 0===i?void 0:i.toUpperCase())}static generateFormUniqueId(e){let t="";do{t=l()(1e4,99999,!1).toString()}while(null!=e[t]);return t}static parseFormIdFromUrl(e){return c.wS.getQueryParamValue(e,"id")}static getFormUrl(e,t,r){var i;if(!e)return"";switch(t){case d.u.EditForm:return"https://forms.office.com/Pages/DesignPageV2.aspx?origin=NeoPortalPage&subpage=design&id=".concat(e);case d.u.ViewResponses:return"https://forms.office.com/Pages/DesignPageV2.aspx?origin=NeoPortalPage&subpage=design&id=".concat(e,"&analysis=true");case d.u.CollectResponses:default:return null!==(i=null===r||void 0===r?void 0:r.collectResponsesUrl)&&void 0!==i?i:"https://forms.office.com/Pages/ResponsePage.aspx?id=".concat(e)}}static getClientDictionaryType(e){const t={};return s()(e,(e,r)=>{t[r]=u.builder.fromFormResource(r,e).build()}),t}static getGraphClientDictionaryType(e){const t={};return s()(e,(e,r)=>{r=decodeURIComponent(r),t[r]=u.builder.fromGraphFormResource(r,e).build()}),t}static getResourceDictionaryType(e){const t={};return s()(e,(e,r)=>{t[r]=e.toWebSerializable()}),t}static getGraphResourceDictionaryType(e){const t={};return s()(e,(e,r)=>{t[r]=e.toGraphSerializable()}),t}toWebSerializable(){return{displayName:this.displayName,formWebUrl:this.collectResponsesUrl,formResponse:this.formResponse}}toGraphSerializable(){return{"@odata.type":"#microsoft.taskServices.form",displayName:this.displayName,formWebUrl:this.collectResponsesUrl,formResponse:this.formResponse}}getClone(){return u.builder.withPropertyBag({displayName:this.displayName,formResponse:this.formResponse,formId:this.formId,formWebUrl:this.collectResponsesUrl}).build()}setProperty(e,t){const r=this.getClone();return r[e]=t,r}constructor(e){this.displayName=e.displayName,this.formResponse=e.formResponse,this.formId=e.formId,this.collectResponsesUrl=e.collectResponsesUrl,this.urlFormId=e.urlFormId}}u.TitleMaxLength=90},45234:e=>{e.exports=function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}},45967:e=>{e.exports=function(e){return e.split("")}},47451:(e,t,r)=>{"use strict";r.d(t,{A:()=>h});var i=r(20719),s=r(36723),n=r(77138),o=r(16698),a=r(98990),l=r.n(a),c=r(55491),d=r.n(c),u=r(69108),p=r.n(u);class h{build(){return new n.Z(this)}fromDriveItem(e,t){return this.taskAttachmentType=t.fileType,this.taskAttachmentType===s.Er.Other&&e&&(this.specificType=this.getSpecificType(e),this.videoUrlParseResult=o.W.TryParseVideoUrl(e)),this}fromFileName(e){let t=s.Er.Other,r=null;const o=e.lastIndexOf(".");if(o>-1){const a=e.slice(o+1).toLowerCase();d()(i.t,(e,r)=>{l()(e,e=>e.toLowerCase()===a)&&(t=n.Z.getTaskAttachmentTypeFromString(r))}),p()(s.ig,a)>=0&&(r=a)}return this.specificType=r,this.taskAttachmentType=t,this}withPropertyBag(e){return this.taskAttachmentType=e.taskAttachmentType||this.taskAttachmentType,this.specificType=e.specificType||this.specificType,this.taskAttachmentType===s.Er.Other&&e.url&&(null==this.specificType&&(this.specificType=this.getSpecificType(e.url)),this.videoUrlParseResult=o.W.TryParseVideoUrl(e.url)),this}ofDriveItemType(e){return this.taskAttachmentType=e,this}getSpecificType(e){const t=e.slice((e.lastIndexOf(".")-1>>>0)+2).split(/\#|\?|\&|\s/g);return t.length>0&&p()(s.ig,t[0].toLowerCase())>=0?t[0]:null}constructor(){this.taskAttachmentType=s.Er.Other,this.specificType=null,this.videoUrlParseResult={canPlay:!1,embedUrl:"",provider:"Unknown"}}}},47453:(e,t,r)=>{"use strict";r.d(t,{d:()=>a});var i=r(36723),s=r(77138),n=r(47451),o=r(16698);class a extends n.A{fromAttachmentResource(e,t){return this.taskAttachmentType=s.Z.getTaskAttachmentTypeFromString(t.Type),this.taskAttachmentType===i.Er.Other&&e&&(this.specificType=this.getSpecificType(e),this.videoUrlParseResult=o.W.TryParseVideoUrl(e)),this}fromGraphAttachmentResource(e,t){return this.taskAttachmentType=s.Z.getTaskAttachmentTypeFromString(t.type),this.taskAttachmentType===i.Er.Other&&e&&(this.specificType=this.getSpecificType(e),this.videoUrlParseResult=o.W.TryParseVideoUrl(e)),this}fromFormResource(e){return e&&(this.taskAttachmentType=i.Er.Form),this}fromGraphFormResource(e){return e&&(this.taskAttachmentType=i.Er.Form),this}}},50061:e=>{e.exports=function(e,t){return e<t}},50715:e=>{var t="\\ud800-\\udfff",r="["+t+"]",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",s="\\ud83c[\\udffb-\\udfff]",n="[^"+t+"]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+i+"|"+s+")"+"?",c="[\\ufe0e\\ufe0f]?",d=c+l+("(?:\\u200d(?:"+[n,o,a].join("|")+")"+c+l+")*"),u="(?:"+[n+i+"?",i,o,a,r].join("|")+")",p=RegExp(s+"(?="+s+")|"+u+d,"g");e.exports=function(e){return e.match(p)||[]}},54276:(e,t,r)=>{"use strict";var i;r.d(t,{c:()=>i}),function(e){e.Text="text",e.HTML="html"}(i||(i={}))},56707:(e,t,r)=>{var i=r(9812),s=r(91980),n=r(26924),o=r(6571),a=r(90620),l=r(45234),c=r(54160),d=r(52074),u=r(39115),p=r(26727),h=i?i.iterator:void 0;e.exports=function(e){if(!e)return[];if(o(e))return a(e)?u(e):s(e);if(h&&e[h])return l(e[h]());var t=n(e);return("[object Map]"==t?c:"[object Set]"==t?d:p)(e)}},59364:(e,t,r)=>{var i=r(79742),s=r(9096),n=r(50061);e.exports=function(e,t){return e&&e.length?i(e,s(t,2),n):void 0}},61086:(e,t,r)=>{var i=r(83518),s=r(60929),n=r(37303),o=parseFloat,a=Math.min,l=Math.random;e.exports=function(e,t,r){if(r&&"boolean"!=typeof r&&s(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=n(e),void 0===t?(t=e,e=0):t=n(t)),e>t){var c=e;e=t,t=c}if(r||e%1||t%1){var d=l();return a(e+d*(t-e+o("1e-"+((d+"").length-1))),t)}return i(e,t)}},64696:(e,t,r)=>{"use strict";r.d(t,{x:()=>F});var i=r(41740),s=r.n(i),n=r(17002),o=r.n(n),a=r(54320),l=r.n(a),c=r(19853),d=r.n(c),u=r(36777),p=r.n(u),h=r(45078),m=r(72761),g=r(70252),f=r(88908),y=r(56434),v=r.n(y),k=r(55491),b=r.n(k),T=r(42410),w=r(91246);class P{build(){return new F(this)}fromWebResource(e){return this.withPropertyBag({id:e.Id,version:null!=e.ItemVersion?e.ItemVersion.toString():void 0,orderHintsByAssignee:e.OrderHintsByAssignee,unassignedOrderHint:e.UnassignedOrderHint})}fromGraphResource(e){return this.withPropertyBag({version:e["@odata.etag"],id:e.id,orderHintsByAssignee:e.orderHintsByAssignee||void 0,unassignedOrderHint:e.unassignedOrderHint})}newFromDifferentialUpdate(e){if(e.entityType!==m.I.Task&&e.entityType!==m.I.TaskboardAssignedToTaskFormatting)throw new Error("ArgumentException: invalid entity");const t=F.builder.withPropertyBag({id:e.id,version:e.itemVersion}).build(),r=e.getCreateDiffData(m.I.TaskboardAssignedToTaskFormatting),i=t.applyDiffs(r);return this.forClone(i)}forClone(e){return this.withPropertyBag({id:e.id,orderHintsByAssignee:v()(e.orderHintsByAssignee),unassignedOrderHint:e.unassignedOrderHint,version:e.itemVersion})}withPropertyBag(e){return this.id=e.id,this.version=e.version||this.version,this.orderHintsByAssignee=e.orderHintsByAssignee||this.orderHintsByAssignee,this.unassignedOrderHint=e.unassignedOrderHint||this.unassignedOrderHint,this}getDiffDataFromWebResource(e,t){const r={},i=new T.F;return i.addMapping("UnassignedOrderHint","unassignedOrderHint"),i.addMapping("OrderHintsByAssignee","orderHintsByAssignee"),b()(e.Changes,e=>{const s=e.FieldName;switch(s){case"OrderHintsByAssignee":const n=i.getMappedClientKey(s);if(1===e.PathSegments.length&&null==e.Value)r[n]=h.Wh.CollectionCleanupValue;else if(2===e.PathSegments.length){r[n]||(r[n]=null!==t&&void 0!==t&&t.orderHintsByAssignee?v()(t.orderHintsByAssignee):{});const i=e.PathSegments[1];null==e.Value?delete r[n][i]:r[n][i]=e.Value}break;case"UnassignedOrderHint":const o=i.getMappedClientKey(s);r[o]=i.translateValue(s,o,e.Value)}}),r}getDiffDataFromGraphResource(e,t){const r=new T.F;return r.addMapping("unassignedOrderHint","unassignedOrderHint"),r.addMapping("orderHintsByAssignee","orderHintsByAssignee",e=>{if(null==e)return h.Wh.CollectionCleanupValue;const r=null!==t&&void 0!==t&&t.orderHintsByAssignee?v()(t.orderHintsByAssignee):{};for(const t in e)null==e[t]?delete r[t]:r[t]=e[t];return r}),r.translate(e)}withDefaultValues(){return this.withPropertyBag({id:"TaskID",version:"1",unassignedOrderHint:"orderHint",orderHintsByAssignee:{}})}withId(e){return this.id=e,this}constructor(){this.id=w.o.generate(),this.version="",this.orderHintsByAssignee={},this.unassignedOrderHint=" !"}}var B=r(679);class F extends f.W{static get builder(){return new P}static mergeCustomizer(e,t,r){return"orderHintsByAssignee"===r?d()(t,h.Wh.CollectionCleanupValue)?{}:t:B.B.applyDiffMomentCustomizer(e,t,r)}get taskboardType(){return g.s.AssignedTo}get entityType(){return m.I.TaskboardAssignedToTaskFormatting}setProperty(e,t){if("orderHintsByAssignee"!==e&&"unassignedOrderHint"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}getClone(){return this.getCloneBuilder().build()}getCloneBuilder(){return F.builder.forClone(this)}toWebSerializable(){return{Id:this.id,TaskBoardType:this.taskboardType,ItemVersion:l()(this.itemVersion)?null:parseInt(this.itemVersion,10),OrderHintsByAssignee:s()(this.orderHintsByAssignee||{}),UnassignedOrderHint:this.unassignedOrderHint}}toGraphSerializable(){return{id:this.id,"@odata.etag":l()(this.itemVersion)?null:this.itemVersion,orderHintsByAssignee:s()(this.orderHintsByAssignee||{}),unassignedOrderHint:this.unassignedOrderHint}}getDiff(e){return B.B.getDiff(this,e,(e,t,r)=>"orderHintsByAssignee"===r?d()(e,t)?{}:d()(t,{})?h.Wh.CollectionCleanupValue:t:B.B.getDiffMomentCustomizer(e,t,r))}applyDiffs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!o()(t,e=>null!=e))throw new Error("ArgumentException: diffs - Diffs array contains null elements");return t.length>0?p()(F.builder.build(),this,...t,F.mergeCustomizer):this}applyDifferentialUpdate(e){if(e.id!==this.id)throw new Error("ArgumentException: update.id must match this.id");const t=e.getUpdateDiffData(this,this.entityType);return this.applyDiffs(t)}constructor(e){super(e.id,e.version),this.orderHintsByAssignee=e.orderHintsByAssignee,this.unassignedOrderHint=e.unassignedOrderHint}}},67868:(e,t,r)=>{"use strict";r.d(t,{u:()=>i});class i{toGraphSerializable(){return{requiredChecklistItemIds:this.requiredChecklistItemIds}}static fromResource(e){return new i(e.requiredChecklistItemIds)}setProperty(e,t){const r=new i([...this.requiredChecklistItemIds]);return r[e]=t,r}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.requiredChecklistItemIds=e}}},67875:(e,t,r)=>{"use strict";r.d(t,{o:()=>n});var i=r(39946),s=r(27805);class n{build(){return new i.l(this)}fromFormResource(e,t){var r;return this.displayName=t.displayName,this.formResponse=t.formResponse,this.formId=e,this.urlFormId=null!==(r=i.l.parseFormIdFromUrl(t.formWebUrl))&&void 0!==r?r:"",this.collectResponsesUrl=t.formWebUrl,this}fromGraphFormResource(e,t){var r;return this.displayName=t.displayName,this.formResponse=t.formResponse,this.formId=e,this.urlFormId=null!==(r=i.l.parseFormIdFromUrl(t.formWebUrl))&&void 0!==r?r:"",this.collectResponsesUrl=t.formWebUrl,this}fromOfficeForm(e,t){return this.displayName=e.title,this.formResponse=null,this.formId=t,this.urlFormId=e.id,this.collectResponsesUrl=i.l.getFormUrl(e.id,s.u.CollectResponses),this}withPropertyBag(e){return this.displayName=e.displayName||this.displayName||"",this.formResponse=e.formResponse||this.formResponse||null,this.formId=e.formId||this.formId||"",this.urlFormId=e.formWebUrl&&i.l.parseFormIdFromUrl(e.formWebUrl)||this.urlFormId||"",this.collectResponsesUrl=e.formWebUrl||this.collectResponsesUrl||"",this}}},68501:(e,t,r)=>{"use strict";r.d(t,{h:()=>d});var i=r(67868),s=r(38621),n=r(11569),o=r(56434),a=r.n(o),l=r(38752);class c{build(){return new d(this)}withPropertyBag(e){var t,r,i;return this.checklistRequirement=null!==(t=e.checklistRequirement)&&void 0!==t?t:this.checklistRequirement,this.formsRequirement=null!==(r=e.formsRequirement)&&void 0!==r?r:this.formsRequirement,this.approvalRequirement=null!==(i=e.approvalRequirement)&&void 0!==i?i:this.approvalRequirement,this}forClone(e){return this.withPropertyBag(a()(e))}getDiffDataFromWebResource(e){return{}}fromGraphResource(e){const t=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,r=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,o=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals;return this.withPropertyBag({checklistRequirement:e.checklistRequirement&&t?i.u.fromResource(e.checklistRequirement):null,formsRequirement:e.formsRequirement&&r?s.T.fromResource(e.formsRequirement):null,approvalRequirement:e.approvalRequirement&&o?n.L.fromResource(e.approvalRequirement):null})}getDiffDataFromGraphResource(e){return{}}withChecklistRequirement(e){return this.checklistRequirement=e,this}withFormsRequirement(e){return this.formsRequirement=e,this}withApprovalRequirement(e){return this.approvalRequirement=e,this}constructor(){this.checklistRequirement=null,this.formsRequirement=null,this.approvalRequirement=null}}class d{static get builder(){return new c}toGraphSerializable(){const e=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryForms,t=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryChecklist,r=l.B.clientSettings.Flights.TeamsTasksECS_enableMandatoryApprovals,i={checklistRequirement:null};return t&&(i.checklistRequirement=this.checklistRequirement),e&&(i.formsRequirement=this.formsRequirement),r&&(i.approvalRequirement=this.approvalRequirement),i}setProperty(e,t){const r=this.getClone();return r[e]=t,r}getClone(){return d.builder.forClone(this).build()}constructor(e){this.checklistRequirement=e.checklistRequirement,this.formsRequirement=e.formsRequirement,this.approvalRequirement=e.approvalRequirement}}},69108:(e,t,r)=>{var i=r(88468),s=r(99140),n=Math.max;e.exports=function(e,t,r){var o=null==e?0:e.length;if(!o)return-1;var a=null==r?0:s(r);return a<0&&(a=n(o+a,0)),i(e,t,a)}},69491:(e,t,r)=>{"use strict";r.d(t,{_:()=>a});var i=r(36723),s=r(94778),n=r(77138),o=r(39946);class a{build(){return new s.R(this)}fromDriveItem(e,t){return this.url=e+t.itemPath.replace("/drive/root:","")+"/"+encodeURIComponent(t.name)+"?web=1",this.alias=t.name.substring(0,s.R.AliasMaxLength),this.taskAttachmentType=n.Z.builder.fromDriveItem(this.url,t).build(),this}fromForm(e,t){return this.url=o.l.getFormUrl(e.urlFormId,t,e),this.alias=e.displayName,this.taskAttachmentType=n.Z.builder.withPropertyBag({taskAttachmentType:i.Er.Form}).build(),this}withPropertyBag(e){return this.alias=e.alias||this.alias||"",this.taskAttachmentType=e.taskAttachmentType||this.taskAttachmentType||n.Z.builder.withPropertyBag({url:e.url}).build(),this.url=e.url||this.url||"",this.isShownInTaskCard=!!e.isShownInTaskCard,this}constructor(){this.isShownInTaskCard=!1}}},70252:(e,t,r)=>{"use strict";var i;r.d(t,{s:()=>i}),function(e){e[e.Progress=0]="Progress",e[e.AssignedTo=1]="AssignedTo",e[e.Bucket=2]="Bucket"}(i||(i={}))},72037:e=>{e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},75117:e=>{e.exports=function(e,t){return e>t}},77138:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var i=r(36723),s=r(47451);class n{static get builder(){return new s.A}static getTaskAttachmentTypeFromString(e){return i.Er[e]?i.Er[e]:i.Er.Other}constructor(e){this.taskAttachmentType=e.taskAttachmentType,this.specificType=e.specificType,this.videoUrlParseResult=e.videoUrlParseResult}}},79742:(e,t,r)=>{var i=r(19841);e.exports=function(e,t,r){for(var s=-1,n=e.length;++s<n;){var o=e[s],a=t(o);if(null!=a&&(void 0===l?a===a&&!i(a):r(a,l)))var l=a,c=o}return c}},80708:(e,t,r)=>{"use strict";var i,s;r.d(t,{F:()=>B}),function(e){e[e.Automatic=0]="Automatic",e[e.NoPreview=1]="NoPreview",e[e.Checklist=2]="Checklist",e[e.Description=3]="Description",e[e.Reference=4]="Reference"}(i||(i={})),function(e){e[e.Shared=1]="Shared",e[e.Personal=2]="Personal",e[e.Template=3]="Template"}(s||(s={}));var n=r(34648),o=r(34717),a=r(32561),l=r(64696),c=r(17776),d=r(97139),u=r(39589);class p{build(){return new B(this)}fromWebResource(e){return this.withPropertyBag({task:o.Y.builder.fromWebResource(e.Task).build(),taskDetails:null==e.Details?void 0:a.U.builder.fromWebResource(e.Details).build(),taskFormatData:e&&(e.AssignedToTaskBoardFormat||e.BucketTaskBoardFormat||e.ProgressTaskBoardFormat)?u._.builder.withPropertyBag({assignedBoardFormat:e.AssignedToTaskBoardFormat?l.x.builder.fromWebResource(e.AssignedToTaskBoardFormat).build():void 0,bucketBoardFormat:e.BucketTaskBoardFormat?c.g.builder.fromWebResource(e.BucketTaskBoardFormat).build():void 0,progressBoardFormat:e.ProgressTaskBoardFormat?d.j.builder.fromWebResource(e.ProgressTaskBoardFormat).build():void 0}).build():void 0})}fromGraphResource(e){return this.withPropertyBag({task:o.Y.builder.fromGraphResource(e).build(),taskDetails:null!==e&&void 0!==e&&e.details?a.U.builder.fromGraphResource(e.details).build():void 0,taskFormatData:e&&(e.assignedToTaskBoardFormat||e.bucketTaskBoardFormat||e.progressTaskBoardFormat)?u._.builder.withPropertyBag({assignedBoardFormat:e.assignedToTaskBoardFormat?l.x.builder.fromGraphResource(e.assignedToTaskBoardFormat).build():void 0,bucketBoardFormat:e.bucketTaskBoardFormat?c.g.builder.fromGraphResource(e.bucketTaskBoardFormat).build():void 0,progressBoardFormat:e.progressTaskBoardFormat?d.j.builder.fromGraphResource(e.progressTaskBoardFormat).build():void 0}).build():void 0})}withPropertyBag(e){return this.task=e.task,this.taskDetails=e.taskDetails||this.taskDetails,this.taskFormatData=e.taskFormatData||this.taskFormatData,this}withTask(e){return this.task=e,this}withDetails(e){return this.taskDetails=e,this}withFormatData(e){return this.taskFormatData=e,this}withId(e){if(!this.task)throw new Error("task must be specified before calling withId");if(this.task=o.Y.builder.forClone(this.task).withId(e).build(),this.taskDetails&&(this.taskDetails=a.U.builder.forClone(this.taskDetails).withId(e).build()),this.taskFormatData){const t=u._.builder;this.taskFormatData.bucketBoardFormat&&(t.bucketBoardFormat=c.g.builder.forClone(this.taskFormatData.bucketBoardFormat).withId(e).build()),this.taskFormatData.assignmentBoardFormat&&(t.assignedBoardFormat=l.x.builder.forClone(this.taskFormatData.assignmentBoardFormat).withId(e).build()),this.taskFormatData.progressBoardFormat&&(t.progressBoardFormat=d.j.builder.forClone(this.taskFormatData.progressBoardFormat).withId(e).build()),this.taskFormatData=t.build()}return this}forClone(e){return this.withPropertyBag({task:e.task,taskDetails:e.taskDetails,taskFormatData:e.taskFormatData})}}var h=r(51171),m=r(14740),g=r.n(m),f=r(98990),y=r.n(f),v=r(55491),k=r.n(v),b=r(28673),T=r.n(b),w=r(91246),P=r(25290);class B{static get builder(){return new p}static toAugmentationLoopTaskModel(e,t,r,s,o){var a,l,c,d,u,p,h,m,f,v,k,b,w,B,F,R;let C;switch(e.task.previewType){case n.X.CheckList:C=i.Checklist;break;case n.X.Description:C=i.Description;break;case n.X.NoPreview:C=i.NoPreview;break;case n.X.Reference:C=i.Reference;break;case n.X.Automatic:default:C=i.Automatic}const A=null!==(a=null===(l=y()(s,{id:e.task.createdBy}))||void 0===l?void 0:l.userPrincipalName)&&void 0!==a?a:"",D=null!==(c=null===(d=y()(s,{id:e.task.userContentLastModifiedBy}))||void 0===d?void 0:d.userPrincipalName)&&void 0!==c?c:"",S=e.task.completedBy?null===(u=y()(s,{id:e.task.completedBy}))||void 0===u?void 0:u.userPrincipalName:void 0,I=e.task.deletedBy?null===(p=y()(s,{id:e.task.deletedBy}))||void 0===p?void 0:p.userPrincipalName:void 0,E=g()(T()(e.task.assignments).map(e=>{var t;return null===(t=y()(s,{id:e}))||void 0===t?void 0:t.userPrincipalName}));return{id:e.id,appliedCategories:r,bucketTitle:o,completedBy:S,completedDate:null!==(h=null===(m=e.task.completedDate)||void 0===m?void 0:m.toISOString())&&void 0!==h?h:void 0,createdBy:A,createdDate:e.task.createdDate.toISOString(),deletedBy:I,dueDate:null!==(f=null===(v=e.task.dueDate)||void 0===v?void 0:v.toISOString())&&void 0!==f?f:void 0,hasDescription:e.task.hasDescription,numberOfActiveChecklistItems:e.task.numberOfActiveChecklistItems,numberOfChecklistItems:e.task.numberOfChecklistItems,numberOfReferences:e.task.numberOfReferences,orderHint:e.task.orderHint,percentComplete:e.task.percentComplete,planTitle:t,previewType:C,priority:e.task.priority,startDate:null!==(k=null===(b=e.task.startDate)||void 0===b?void 0:b.toISOString())&&void 0!==k?k:void 0,title:e.task.title,userContentLastModifiedBy:D,userContentLastModifiedDate:null!==(w=null===(B=e.task.userContentLastModifiedDate)||void 0===B?void 0:B.toISOString())&&void 0!==w?w:void 0,kind:1,assigneeIds:E,plannerTaskDetails:{id:e.id,description:null!==(F=null===(R=e.taskDetails)||void 0===R?void 0:R.description)&&void 0!==F?F:"",previewType:C},logicalId:(0,P.DA)()}}static hasContentBeenModified(e,t){let r=!1;if(e.id===t.id||w.o.isPlexTempId(e.id)&&!w.o.isPlexTempId(t.id)){const n=T()(t.task.getDiff(e.task)),o=["title","bucketId","percentComplete","startDate","dueDate","conversationThreadId","appliedCategories"];if(r=n.some(e=>o.indexOf(e)>=0),r||T()(t.task.assignments).forEach(t=>{if(null==e.task.assignments[t])return r=!0,!1}),!r&&null!=e.taskDetails&&null!=t.taskDetails){var i,s;let n=!1;const o=e.taskDetails.references;k()(t.taskDetails.references,e=>{if(null==o[e.url]||e.alias!==o[e.url].alias)return n=!0,!1});let a=!1;const l=e.taskDetails.checklist;n||k()(t.taskDetails.checklist,e=>{if(null==l[e.id]||e.title!==l[e.id].title||e.isChecked!==l[e.id].isChecked)return a=!0,!1}),r=t.taskDetails.description!==e.taskDetails.description||(null===(i=t.taskDetails.notes)||void 0===i?void 0:i.content)!==(null===(s=e.taskDetails.notes)||void 0===s?void 0:s.content)||n||a}return r}throw new Error("Task ids doesn't match")}get id(){return this.task.id}toWebSerializable(){var e,t,r,i;return{Task:this.task.toWebSerializable(),Details:null===(e=this.taskDetails)||void 0===e?void 0:e.toWebSerializable(),AssignedToTaskBoardFormat:null===(t=this.taskFormatData)||void 0===t||null===(t=t.assignmentBoardFormat)||void 0===t?void 0:t.toWebSerializable(),BucketTaskBoardFormat:null===(r=this.taskFormatData)||void 0===r||null===(r=r.bucketBoardFormat)||void 0===r?void 0:r.toWebSerializable(),ProgressTaskBoardFormat:null===(i=this.taskFormatData)||void 0===i||null===(i=i.progressBoardFormat)||void 0===i?void 0:i.toWebSerializable()}}getClone(){return this.getCloneBuilder().build()}getCloneForMove(e,t){return B.builder.withTask(this.task.getCloneForMove(e)).withFormatData(t).build()}getCloneBuilder(){return B.builder.forClone(this)}constructor(e){var t,r,i;if(null==e.task)throw new h.L("builder.task");if(e.taskDetails&&e.task&&e.taskDetails.id!==e.task.id)throw new Error("ArgumentException: Mismatch between task.id and taskDetails.id");if(null!==(t=e.taskFormatData)&&void 0!==t&&t.assignmentBoardFormat&&e.taskFormatData.assignmentBoardFormat.id!==e.task.id)throw new Error("ArgumentException: Mismatch between task.id and taskFormatData.assignmentBoardFormat.id");if(null!==(r=e.taskFormatData)&&void 0!==r&&r.bucketBoardFormat&&e.taskFormatData.bucketBoardFormat.id!==e.task.id)throw new Error("ArgumentException: Mismatch between task.id and taskFormatData.bucketBoardFormat.id");if(null!==(i=e.taskFormatData)&&void 0!==i&&i.progressBoardFormat&&e.taskFormatData.progressBoardFormat.id!==e.task.id)throw new Error("ArgumentException: Mismatch between task.id and taskFormatData.progressBoardFormat.id");this.task=e.task,this.taskDetails=e.taskDetails,this.taskFormatData=e.taskFormatData}}},83518:e=>{var t=Math.floor,r=Math.random;e.exports=function(e,i){return e+t(r()*(i-e+1))}},85855:(e,t,r)=>{e.exports=r(96483)},94710:e=>{e.exports=function(e,t,r,i){for(var s=-1,n=null==e?0:e.length;++s<n;){var o=e[s];t(i,o,r(o),e)}return i}},94778:(e,t,r)=>{"use strict";r.d(t,{R:()=>h});var i=r(20719),s=r(36723),n=r(69491),o=r(28730),a=r(36475),l=r.n(a),c=r(55491),d=r.n(c),u=r(69108),p=r.n(u);class h{static get builder(){return new n._}static aliasCompare(e,t){var r,i;return o.l.compareStringForDisplay(null===e||void 0===e||null===(r=e.alias)||void 0===r?void 0:r.toUpperCase(),null===t||void 0===t||null===(i=t.alias)||void 0===i?void 0:i.toUpperCase())}isExternalLinkAttachment(e){if(this.taskAttachmentType.taskAttachmentType!==s.Er.Other)return!1;const t=decodeURIComponent(this.url);let r=decodeURIComponent(e);l()(r,"/")||(r+="/");const i=new RegExp(r,"ig");return t.search(i)<0}getFileExtension(){if(this.taskAttachmentType.specificType)return this.taskAttachmentType.specificType;let e=null;if(this.taskAttachmentType.taskAttachmentType!==s.Er.Other)switch(this.taskAttachmentType.taskAttachmentType){case s.Er.Excel:e=this.getExtensionFromUrl(this.url,s.Er.Excel);break;case s.Er.OneNote:e=this.getExtensionFromUrl(this.url,s.Er.OneNote);break;case s.Er.Pdf:e=this.getExtensionFromUrl(this.url,s.Er.Pdf);break;case s.Er.PowerPoint:e=this.getExtensionFromUrl(this.url,s.Er.PowerPoint);break;case s.Er.Project:e=this.getExtensionFromUrl(this.url,s.Er.Project);break;case s.Er.Visio:e=this.getExtensionFromUrl(this.url,s.Er.Visio);break;case s.Er.Word:e=this.getExtensionFromUrl(this.url,s.Er.Word)}if(null==e){const t=this.alias.split(".");if(t.length>1){const r=t[t.length-1];3!==r.length&&4!==r.length||(e=r)}}return e}hasKnownExtension(){return this.taskAttachmentType.taskAttachmentType!==s.Er.Other||!!this.taskAttachmentType.specificType&&p()(s.ig,this.taskAttachmentType.specificType.toLowerCase())>=0}isAttachmentPreviewable(){return this.taskAttachmentType.taskAttachmentType!==s.Er.Other?p()(s.Tj,this.taskAttachmentType.taskAttachmentType)<0:!!this.taskAttachmentType.specificType&&p()(s.ig,this.taskAttachmentType.specificType.toLowerCase())>=0}isGifAttachment(){return this.taskAttachmentType.taskAttachmentType===s.Er.Other&&"gif"===this.taskAttachmentType.specificType}getExtensionFromUrl(e,t){let r=null;return d()(i.t[t],t=>{if(e.indexOf("."+t)>-1)return r=t.toLowerCase(),!1}),r}constructor(e){this.alias=e.alias,this.taskAttachmentType=e.taskAttachmentType,this.url=e.url,this.isShownInTaskCard=e.isShownInTaskCard}}h.AliasMaxLength=100,h.UrlMaxLength=2e3},95694:(e,t,r)=>{var i=r(72037)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=i},96483:e=>{e.exports=function(e){return e&&e.length?e[0]:void 0}},97139:(e,t,r)=>{"use strict";r.d(t,{j:()=>v});var i=r(17002),s=r.n(i),n=r(54320),o=r.n(n),a=r(36777),l=r.n(a),c=r(72761),d=r(70252),u=r(88908),p=r(55491),h=r.n(p),m=r(42410),g=r(91246);class f{build(){return new v(this)}fromWebResource(e){return this.withPropertyBag({id:e.Id,orderHint:e.OrderHint,version:null!=e.ItemVersion?e.ItemVersion.toString():void 0})}fromGraphResource(e){return this.withPropertyBag({version:e["@odata.etag"],id:e.id,orderHint:e.orderHint})}newFromDifferentialUpdate(e){if(e.entityType!==c.I.Task&&e.entityType!==c.I.TaskboardStatusTaskFormatting)throw new Error("ArgumentException: invalid entity");const t=v.builder.withPropertyBag({id:e.id,version:e.itemVersion}).build(),r=e.getCreateDiffData(c.I.TaskboardStatusTaskFormatting),i=t.applyDiffs(r);return this.forClone(i)}forClone(e){return this.withPropertyBag({id:e.id,orderHint:e.orderHint,version:e.itemVersion})}withPropertyBag(e){return this.id=e.id,this.orderHint=e.orderHint||this.orderHint,this.version=e.version||this.version,this}withDefaultValues(){return this.withPropertyBag({id:"TaskID",orderHint:"orderhint1",version:"1"})}getDiffDataFromWebResource(e,t){const r={};return h()(e.Changes,t=>{switch(t.FieldName){case"OrderHint":e.ItemType===c.I.TaskboardStatusTaskFormatting&&(r.orderHint=t.Value);break;case"TaskBoardStatusOrderHint":r.orderHint=t.Value}}),r}getDiffDataFromGraphResource(e,t){if(null==e)throw new Error("ArgumentNullException: update");const r=new m.F;return r.addMapping("orderHint","orderHint"),r.translate(e)}withId(e){return this.id=e,this}constructor(){this.id=g.o.generate(),this.orderHint=" !",this.version=""}}var y=r(679);class v extends u.W{static get builder(){return new f}get taskboardType(){return d.s.Progress}get entityType(){return c.I.TaskboardStatusTaskFormatting}setProperty(e,t){if("orderHint"!==e)throw new Error("ReadOnlyException: "+e);const r=this.getClone();return r[e]=t,r}toWebSerializable(){return{Id:this.id,OrderHint:this.orderHint,TaskBoardType:this.taskboardType,ItemVersion:o()(this.itemVersion)?null:parseInt(this.itemVersion,10)}}toGraphSerializable(){return{"@odata.etag":o()(this.itemVersion)?void 0:this.itemVersion,id:this.id,orderHint:this.orderHint}}getDiff(e){return y.B.getDiff(this,e,y.B.getDiffMomentCustomizer)}applyDiffs(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!s()(t,e=>null!=e))throw new Error("ArgumentException: diffs - Diffs array contains null elements");return t.length>0?l()(v.builder.build(),this,...t,y.B.applyDiffMomentCustomizer):this}applyDifferentialUpdate(e){if(e.id!==this.id)throw new Error("ArgumentException: update.id must match this.id");const t=e.getUpdateDiffData(this,this.entityType);return this.applyDiffs(t)}getClone(){return this.getCloneBuilder().build()}getCloneBuilder(){return v.builder.forClone(this)}constructor(e){super(e.id,e.version),this.orderHint=e.orderHint}}}}]);
//# sourceMappingURL=80708.d7e5108c.chunk.js.map